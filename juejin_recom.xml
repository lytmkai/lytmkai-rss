<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹]]></title>    <link>https://juejin.cn/post/7585758163435601926</link>    <guid>https://juejin.cn/post/7585758163435601926</guid>    <pubDate>2025-12-21T12:01:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435601926" data-draft-id="7585751355592507411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-21T12:01:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰å¤´è€çŸ³"/> <meta itemprop="url" content="https://juejin.cn/user/2963939077135006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939077135006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰å¤´è€çŸ³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:01:14.000Z" title="Sun Dec 21 2025 12:01:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä½ çš„è¡¨å•ï¼Œæ˜¯å¦æ­£åœ¨å¤±æ§ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªâ€œä¼ä¸šè´·æ¬¾ç”³è¯·â€æˆ–â€œä¿é™©ç†èµ”â€ç³»ç»Ÿã€‚</p>
<p>æœ€åˆï¼Œé¡µé¢åªæœ‰ 5 ä¸ªå­—æ®µï¼Œä½ å†™å¾—ä¼˜é›…ä»å®¹ã€‚éšç€ä¸šåŠ¡è¿­ä»£ï¼Œè¡¨å•åƒå¹æ°”çƒä¸€æ ·è†¨èƒ€åˆ°äº† 50 å¤šä¸ªå­—æ®µï¼š <strong>â€œå¦‚æœç”¨æˆ·é€‰äº†â€˜ä¸ªä½“å·¥å•†æˆ·â€™ï¼Œä¸ä»…è¦éšè—â€˜ä¼ä¸šæ³•äººâ€™å­—æ®µï¼Œè¿˜å¾—å»åŠ¨æ€è¯·æ±‚â€˜ç»è¥åœ°â€™çš„ä¸‹æ‹‰åˆ—è¡¨ï¼ŒåŒæ—¶â€˜æ³¨å†Œèµ„æœ¬â€™çš„æ ¡éªŒè§„åˆ™è¿˜è¦ä»â€˜å¿…å¡«â€™å˜æˆâ€˜é€‰å¡«â€™â€¦â€¦â€</strong></p>
<p>äºæ˜¯ï¼Œä½ çš„ Vue æ–‡ä»¶å˜æˆäº†è¿™æ ·ï¼š</p>
<ul>
<li><code>&lt;template&gt;</code> é‡Œå¡æ»¡äº†æ·±å±‚åµŒå¥—çš„ <code>v-if</code> å’Œ <code>v-show</code>ã€‚</li>
<li><code>&lt;script&gt;</code> é‡Œåˆ°å¤„æ˜¯ç›‘å¬è”åŠ¨é€»è¾‘çš„ <code>watch</code> å’Œå†—é•¿çš„ <code>if-else</code>ã€‚</li>
<li><strong>æœ€ç—›è‹¦çš„æ˜¯ï¼š</strong> å½“åç«¯å†³å®šè°ƒæ•´å­—æ®µåï¼Œæˆ–è€…å…¬å¸è¦æ±‚æŠŠè¿™å¥—é€»è¾‘å¤ç”¨åˆ°å°ç¨‹åºæ—¶ï¼Œä½ å‘ç°é€»è¾‘å’Œ UI å·²ç»åƒéº»ç»³ä¸€æ ·æ­»æ­»ç¼ åœ¨ä¸€èµ·ï¼Œæ‹†ä¸å¼€äº†ã€‚</li>
</ul>
<p><strong>â€œéš¾é“å†™è¡¨å•ï¼ŒçœŸçš„åªèƒ½é ä½“åŠ›æ´»å—ï¼Ÿâ€</strong></p>
<p>ä¸ºäº†æ‘†è„±è¿™ç§ä½æ•ˆç‡é‡å¤ï¼Œæˆ‘ä»¬å°è¯•å°† <strong>ä¸­é—´ä»¶æ€æƒ³</strong> å¼•å…¥ Vue 3ï¼ŒæŠŠå¤æ‚çš„ä¸šåŠ¡è§„åˆ™ä» UI æ¡†æ¶ä¸­å‰¥ç¦»å‡ºæ¥ã€‚ä»Šå¤©ï¼Œæˆ‘å°±æŠŠè¿™å¥—â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„å¤ç”¨â€çš„å·¥ç¨‹åŒ–æ–¹æ¡ˆåˆ†äº«ç»™ä½ ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ æ ¸å¿ƒæ€æƒ³ï¼šè®©æ•°æ®è‡ªå¸¦â€œè¯´æ˜ä¹¦â€</h2>
<p>ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå‰ç«¯åƒæ˜¯ä¸€ä¸ª**â€œæ¬è¿å·¥â€ï¼šæ‹¿åˆ°åç«¯æ•°æ®ï¼Œæ‰‹åŠ¨åˆ¤æ–­å“ªä¸ªè¯¥æ˜¾ã€å“ªä¸ªè¯¥éšã€‚</p>
<p>è€Œå·¥ç¨‹åŒ–æ¨¡å¼ä¸‹ï¼Œå‰ç«¯æ›´åƒæ˜¯ä¸€ä¸ªâ€œç»„è£…å‚â€**ï¼šæ•°æ®åœ¨è¿›å…¥ UI å±‚ä¹‹å‰ï¼Œå…ˆç»è¿‡ä¸€å¥—â€œä¸­é—´ä»¶æµæ°´çº¿â€ï¼Œæ•°æ®ä¼šè¢«è‡ªåŠ¨æ ‡æ³¨ä¸Š UI æè¿°ä¿¡æ¯ï¼ˆSchemaï¼‰ã€‚</p>
<h3 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ Schema æ¨æ–­ï¼Ÿ</h3>
<p>æ•°æ®ä¸å†æ˜¯å†·å†°å†°çš„é”®å€¼å¯¹ï¼Œè€Œæ˜¯å˜æˆäº†ä¸€ä¸ªåŒ…å«â€œå…ƒæ•°æ®â€çš„å¯¹è±¡ã€‚é€šè¿‡ TypeScript çš„ç±»å‹æ¨æ–­ï¼Œæˆ‘ä»¬è®©æ•°æ®è‡ªå·±å‘Šè¯‰é¡µé¢ï¼š</p>
<ul>
<li>æˆ‘åº”è¯¥ç”¨ä»€ä¹ˆç»„ä»¶æ¸²æŸ“ï¼ˆ<code>componentType</code>ï¼‰</li>
<li>æˆ‘æ˜¯å¦åº”è¯¥è¢«æ˜¾ç¤ºï¼ˆ<code>visible</code>ï¼‰</li>
<li>æˆ‘ä¾èµ–å“ªäº›å­—æ®µï¼ˆ<code>dependencies</code>ï¼‰</li>
<li>æˆ‘çš„ä¸‹æ‹‰é€‰é¡¹å»å“ªé‡Œæ‹‰å–ï¼ˆ<code>request</code>ï¼‰</li>
</ul>
<h3 data-id="heading-3">2. UI æ¡†æ¶åªæ˜¯â€œçš®è‚¤â€</h3>
<p>æ—¢ç„¶é€»è¾‘éƒ½æŠ½ç¦»åˆ°äº†æ¡†æ¶æ— å…³çš„ä¸­é—´ä»¶é‡Œï¼Œé‚£ä¹ˆ UI å±‚æ— è®ºæ˜¯ç”¨ Ant Design è¿˜æ˜¯ Element Plusï¼Œéƒ½åªæ˜¯æ¢ä¸ªâ€œè§£æå™¨â€è€Œå·²ã€‚</p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€ å®æˆ˜ï¼šæ„å»º Vue 3 è‡ªåŠ¨åŒ–æ¸²æŸ“å¼•æ“</h2>
<h3 data-id="heading-5">1. ç»„ä»¶æ³¨å†Œè¡¨</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªç»„ä»¶æ˜ å°„è¡¨ï¼ŒæŠŠæŠ½è±¡çš„å­—ç¬¦ä¸²ç±»å‹æ˜ å°„ä¸ºå…·ä½“çš„ Vue ç»„ä»¶ã€‚</p>
<p>TypeScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src-vue/components/FormRenderer/componentRegistry.ts</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">NumberField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/NumberField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SelectField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/SelectField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TextField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/TextField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ModeToggle</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/ModeToggle.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> componentRegistry = {
  <span class="hljs-attr">number</span>: <span class="hljs-title class_">NumberField</span>,
  <span class="hljs-attr">select</span>: <span class="hljs-title class_">SelectField</span>,
  <span class="hljs-attr">text</span>: <span class="hljs-title class_">TextField</span>,
  <span class="hljs-attr">modeToggle</span>: <span class="hljs-title class_">ModeToggle</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>
</code></pre>
<h3 data-id="heading-6">2. ç»„è£…çº¿ï¼šè‡ªåŠ¨æ¸²æŸ“å™¨ï¼ˆAutoFormRendererï¼‰</h3>
<p>è¿™æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒå¼•æ“ã€‚å®ƒä¸å…³å¿ƒä¸šåŠ¡ï¼Œåªè´Ÿè´£æŒ‰ç…§åŠ å·¥å¥½çš„ <code>_fieldOrder</code> å’Œ <code>_schema</code> è¿›è¡Œéå†ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;template&gt;
  &lt;a-row :<span class="hljs-attr">gutter</span>=<span class="hljs-string">"[16,16]"</span>&gt;
    &lt;template <span class="hljs-attr">v-for</span>=<span class="hljs-string">"key in orderedKeys"</span> :key=<span class="hljs-string">"key"</span>&gt;
      &lt;component
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"shouldRender(key)"</span>
        :<span class="hljs-attr">is</span>=<span class="hljs-string">"resolveComponent(key)"</span>
        :<span class="hljs-attr">value</span>=<span class="hljs-string">"data[key]"</span>
        :<span class="hljs-attr">config</span>=<span class="hljs-string">"schema[key].fieldConfig"</span>
        :<span class="hljs-attr">dependencies</span>=<span class="hljs-string">"collectDeps(schema[key])"</span>
        :<span class="hljs-attr">request</span>=<span class="hljs-string">"schema[key].request"</span>
        @update:<span class="hljs-attr">value</span>=<span class="hljs-string">"onFieldChange(key, $event)"</span>
      /&gt;
    &lt;/template&gt;
  &lt;/a-row&gt;
&lt;/template&gt;

&lt;script setup <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;
const <span class="hljs-attr">props</span> = defineProps&lt;{ data: any }&gt;()<span class="hljs-comment">;</span>
const <span class="hljs-attr">schema</span> = computed(() =&gt; props.data?._schema || {})<span class="hljs-comment">;</span>
const <span class="hljs-attr">orderedKeys</span> = computed(() =&gt; props.data?._fieldOrder || Object.keys(props.data))<span class="hljs-comment">;</span>

// æ ¹æ®ä¸­é—´ä»¶æ³¨å…¥çš„ visible å‡½æ•°åˆ¤æ–­æ˜¾éš
function shouldRender(key: string) {
  const <span class="hljs-attr">s</span> = schema.value[key]<span class="hljs-comment">;</span>
  if (!s || s.fieldConfig?.hidden) return false<span class="hljs-comment">;</span>
  return s.visible ? s.visible(props.data) : true<span class="hljs-comment">;</span>
}

function resolveComponent(key: string) {
  const <span class="hljs-attr">type</span> = schema.value[key]?.componentType || <span class="hljs-string">'text'</span><span class="hljs-comment">;</span>
  return componentRegistry<span class="hljs-section">[type]</span><span class="hljs-comment">;</span>
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-7">3. åŸå­åŒ–ï¼šä¼šâ€œæ€è€ƒâ€çš„å­—æ®µç»„ä»¶</h3>
<p>ä»¥ <code>SelectField</code> ä¸ºä¾‹ï¼Œå®ƒä¸å†æ˜¯è¢«åŠ¨ç­‰å¾…èµ‹å€¼ï¼Œè€Œæ˜¯èƒ½æ„ŸçŸ¥ä¾èµ–ã€‚å½“å®ƒä¾èµ–çš„å­—æ®µï¼ˆå¦‚â€œçœä»½â€ï¼‰å˜åŒ–æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨é‡æ–°è°ƒç”¨ <code>request</code>ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'value'</span>, <span class="hljs-string">'dependencies'</span>, <span class="hljs-string">'request'</span>]);
<span class="hljs-keyword">const</span> options = <span class="hljs-title function_">ref</span>([]);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadOptions</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">request</span>) {
    options.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> props.<span class="hljs-title function_">request</span>(props.<span class="hljs-property">dependencies</span> || {});
  }
}

<span class="hljs-comment">// æ·±åº¦ç›‘å¬ä¾èµ–å˜åŒ–ï¼Œå®ç°è”åŠ¨æ•ˆæœ</span>
<span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">dependencies</span>, loadOptions, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-8">å››ã€ æ–¹æ¡ˆçš„â€œçœŸé¦™â€æ—¶åˆ»</h2>
<h3 data-id="heading-9">1. é€»è¾‘ä¸ UI çš„å½»åº•è§£è€¦</h3>
<p>æ‰€æœ‰çš„è”åŠ¨è§„åˆ™ã€æ ¡éªŒé€»è¾‘ã€æ¥å£è¯·æ±‚éƒ½å®šä¹‰åœ¨ç‹¬ç«‹äºæ¡†æ¶çš„ <code>src/core</code> ä¸‹ã€‚å¦‚æœä½ æ˜å¤©æƒ³æŠŠé¡¹ç›®ä» Vue 3 è¿åˆ° Reactï¼Œä½ åªéœ€è¦é‡å†™é‚£å‡ ä¸ªåŸºç¡€å­—æ®µç»„ä»¶ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ <strong>ä¸€è¡Œéƒ½ä¸ç”¨åŠ¨</strong>ã€‚</p>
<h3 data-id="heading-10">2. â€œæ´ç™–å‹â€æäº¤</h3>
<p>å¾ˆå¤šåŠ¨æ€è¡¨å•æ–¹æ¡ˆä¼šå°† <code>visible</code>ã€<code>options</code> ç­‰ UI çŠ¶æ€æ··å…¥ä¸šåŠ¡æ•°æ®ï¼Œå¯¼è‡´ä¼ ç»™åç«¯çš„ JSON æå…¶æ··ä¹±ã€‚æˆ‘ä»¬çš„æ–¹æ¡ˆåœ¨æäº¤å‰ä¼šè¿è¡Œä¸€æ¬¡â€œæ¸…æ´—ä¸­é—´ä»¶â€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">cleanPayload</span> = submitCompileOutputs(formData.compileOutputs)<span class="hljs-comment">;</span>
// è‡ªåŠ¨å‰”é™¤æ‰€æœ‰ä»¥ _ å¼€å¤´çš„è¾…åŠ©å­—æ®µå’Œä¸´æ—¶çŠ¶æ€
</code></pre>
<p>åç«¯æ‹¿åˆ°çš„æ°¸è¿œæ˜¯å¹²å‡€ã€çº¯ç²¹çš„ä¸šåŠ¡æ¨¡å‹ã€‚</p>
<h3 data-id="heading-11">3. å¼€å‘ä½“éªŒçš„é£è·ƒ</h3>
<p>ç°åœ¨ï¼Œå½“åç«¯æ–°å¢ä¸€ä¸ªå­—æ®µæ—¶ï¼Œä½ çš„å·¥ä½œæµå˜æˆäº†ï¼š</p>
<ol>
<li>
<p>åœ¨ç±»å‹æ¨æ–­å¼•æ“é‡ŒåŠ ä¸€è¡Œè§„åˆ™ã€‚</p>
</li>
<li>
<p>åˆ·æ–°é¡µé¢ï¼Œå­—æ®µå·²ç»æŒ‰é¢„å®šçš„ä½ç½®å’Œæ ·å¼é•¿å¥½äº†ã€‚</p>
<p>ä½ ä¸å†éœ€è¦å» .vue æ–‡ä»¶é‡Œç¿»æ‰¾å‡ ç™¾è¡Œå¤„çš„ template æ’å…¥ HTMLï¼Œæ›´ä¸éœ€è¦æ‹…å¿ƒæ¼æ‰äº†å“ªä¸ª v-ifã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">ç»“è¯­ï¼šä¸è¦ä¸ºäº†ç”¨æ¡†æ¶è€Œç”¨æ¡†æ¶</h2>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬è§‰å¾— Vue æˆ– React éš¾ç»´æŠ¤ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å°†<strong>è¿‡é‡çš„ä¸šåŠ¡å†³ç­–</strong>äº¤ç»™äº†<strong>è§†å›¾å±‚</strong>ã€‚</p>
<p>é€šè¿‡å¼•å…¥ä¸­é—´ä»¶å’Œ Schema æ¨æ–­ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨ UI æ¡†æ¶ä¹‹ä¸Šå»ºç«‹äº†ä¸€ä¸ªâ€œä¸šåŠ¡é€»è¾‘é˜²ç«å¢™â€ã€‚Vue åªè´Ÿè´£ç›‘å¬äº¤äº’å’Œæ¸²æŸ“ç»“æœï¼Œè€Œå˜å¹»è«æµ‹çš„ä¸šåŠ¡è§„åˆ™è¢«å…³åœ¨äº†çº¯ TypeScript ç¼–å†™çš„æ²™ç›’é‡Œã€‚</p>
<p><strong>è¿™ç§â€œå·¥ç¨‹åŒ–â€çš„æ€ç»´ï¼Œä¸ä»…æ˜¯ä¸ºäº†ä»Šå¤©èƒ½å¿«é€Ÿå¤åˆ»åŠŸèƒ½ï¼Œæ›´æ˜¯ä¸ºäº†æ˜å¤©ä¸šåŠ¡å˜åŠ¨æ—¶ï¼Œæˆ‘ä»¬èƒ½ä¼˜é›…åœ°â€œé…ç½®å‡çº§â€ï¼Œè€Œä¸æ˜¯â€œæ¨å€’é‡æ¥â€ã€‚</strong></p>
<hr/>
<p><strong>ä½ æ˜¯å¦‚ä½•å¤„ç†å¤æ‚è¡¨å•è”åŠ¨çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„â€œé¿å‘â€æŒ‡å—ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼]]></title>    <link>https://juejin.cn/post/7585743487258705929</link>    <guid>https://juejin.cn/post/7585743487258705929</guid>    <pubDate>2025-12-21T12:15:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487258705929" data-draft-id="7584861353805135908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,ä»£ç è§„èŒƒ,å›¢é˜Ÿç®¡ç†"/> <meta itemprop="datePublished" content="2025-12-21T12:15:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="gyx_è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·é™"/> <meta itemprop="url" content="https://juejin.cn/user/958429872534056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/958429872534056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    gyx_è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·é™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:15:55.000Z" title="Sun Dec 21 2025 12:15:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€ä½å‰ç«¯åŒäº‹èŠ±ä¸€å‘¨æ—¶é—´é‡æ„äº†ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œè‡ªæµ‹é€šè¿‡ã€æ€§èƒ½ä¼˜åŒ–ã€UI å®Œç¾ã€‚<br/>
ä¸Šçº¿ 2 å°æ—¶åï¼Œç”¨æˆ·åé¦ˆâ€œé¡µé¢ç™½å±â€â€”â€”åŸæ¥æ¼æ‰äº†ç©ºçŠ¶æ€å¤„ç†ã€‚<br/>
ç´§æ€¥å›æ»šã€åŠ ç­ä¿®å¤ã€äº§å“ä¿¡ä»»å—æŸâ€¦â€¦<br/>
è€Œè¿™ä¸€åˆ‡ï¼Œæœ¬å¯ä»¥åœ¨ä¸€æ¬¡ 15 åˆ†é’Ÿçš„ Code Review ä¸­é¿å…ã€‚</p>
</blockquote>
<p>Code Reviewï¼ˆä»£ç å®¡æŸ¥ï¼‰ä»æ¥ä¸æ˜¯â€œæ‰¾èŒ¬â€ï¼Œè€Œæ˜¯ç»™<strong>å‰ç«¯å›¢é˜Ÿä¸Šäº†ä¸€ä¸ªæœ€é«˜æ•ˆçš„è´¨é‡ä¿é™©</strong>ã€‚å®ƒä¸ä»…èƒ½æå‰æ‹¦æˆª Bugï¼Œæ›´æ˜¯çŸ¥è¯†å…±äº«ã€è§„èŒƒè½åœ°ã€æ–°äººæˆé•¿çš„åŠ é€Ÿå™¨ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Code Review</h2>
<h3 data-id="heading-1">1.1 Code Review çš„æ ¸å¿ƒä»·å€¼å’Œç›®æ ‡</h3>
<p>Code Review ç¿»è¯‘æˆä¸­æ–‡ï¼Œå°±æ˜¯<strong>ä»£ç å®¡æŸ¥</strong>ã€‚åœ¨å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå®ƒä¸ä»…æ˜¯<strong>ä¿è¯ä»£ç è´¨é‡</strong>çš„å…³é”®ç¯èŠ‚ï¼Œæ›´æ˜¯<strong>å›¢é˜ŸçŸ¥è¯†å…±äº«</strong>ã€<strong>æŠ€æœ¯ç»Ÿä¸€</strong>å’Œ<strong>å·¥ç¨‹è§„èŒƒè½åœ°</strong>çš„é‡è¦æœºåˆ¶ã€‚å›¢é˜Ÿæˆå‘˜é€šè¿‡è§„åˆ’åŒ–çš„ä»£ç å®¡æŸ¥æµç¨‹ï¼Œèƒ½å¤Ÿæå‰<strong>å‘ç°æ½œåœ¨é—®é¢˜</strong>ï¼Œ<strong>æå‡ä»£ç çš„å¯ä»¥ç»´æŠ¤æ€§</strong>ã€‚</p>
<h3 data-id="heading-2">1.2 Code Review å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™</h3>
<p>é€šå¸¸å‘ç”Ÿåœ¨ï¼š</p>
<ul>
<li>å¼€å‘è€…å®Œæˆä¸€ä¸ªåŠŸèƒ½ã€ä¿®å¤ä¸€ä¸ª bug æˆ–è¿›è¡Œé‡æ„å</li>
<li>å°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“å¹¶å‘èµ·Â <strong>Pull Requestï¼ˆPRï¼‰</strong> Â æˆ–Â <strong>Merge Requestï¼ˆMRï¼‰</strong></li>
<li>åœ¨ä»£ç åˆå¹¶åˆ°ä¸»å¹²åˆ†æ”¯ï¼ˆå¦‚Â <code>master</code>Â /Â <code>main</code>ï¼‰<strong>ä¹‹å‰</strong></li>
</ul>
<h2 data-id="heading-3">äºŒã€ä¸ºä»€ä¹ˆè¦ Code Review</h2>
<p>ä»£ç å®¡æŸ¥çœŸçš„ä¸æ˜¯ä¸ºäº†æ‰¾èŒ¬ï¼Œè€Œæ˜¯ä¸ºäº†è®©<strong>å›¢é˜Ÿ</strong>èƒ½èµ°å¾—<strong>æ›´è¿œã€æ›´ç¨³</strong>çš„å…³é”®ä¸€ç¯ã€‚æƒ³ä¸€æƒ³ï¼Œå¦‚æœèŠ±äº†ä¸€å‘¨æ—¶é—´ï¼Œä¼˜åŒ–äº†å„ç§æ€§èƒ½ï¼Œå†™äº†ä¸€å¤§å †ä»£ç ï¼Œç»“æœä¸Šçº¿åå‘ç°äº†ä¸€ä¸ªä¸¥é‡ bugï¼Œéœ€è¦ç´§æ€¥ä¿®å¤ã€‚è¿™ä¸ä»…æµªè´¹äº†æ—¶é—´ï¼Œè¿˜å¯èƒ½å½±å“ç”¨æˆ·å¯¹äº§å“å›¢é˜Ÿå’Œå¼€å‘å›¢é˜Ÿçš„ä¿¡ä»»ã€‚</p>
<p>ä¸‹é¢åˆ—ä¸¾å‡ ä¸ª Code Review çš„ä½œç”¨ï¼š</p>
<ul>
<li><strong>æå‰å‘ç°ç¼ºé™·</strong><br/>
åœ¨ Code Review é˜¶æ®µå‘ç°çš„é€»è¾‘é”™è¯¯ã€ä¸šåŠ¡ç†è§£åå·®ã€æ€§èƒ½éšæ‚£ç­‰æ—¶æœ‰å‘ç”Ÿï¼Œå¯ä»¥æå‰å‘ç°é—®é¢˜</li>
<li><strong>æé«˜ä»£ç è´¨é‡</strong><br/>
ä¸»è¦ä½“ç°åœ¨ä»£ç å¥å£®æ€§ã€è®¾è®¡åˆç†æ€§ã€ä»£ç ä¼˜é›…æ€§ç­‰æ–¹é¢ï¼ŒæŒç»­ Code Review å¯ä»¥æå‡å›¢é˜Ÿæ•´ä½“ä»£ç è´¨é‡</li>
<li><strong>ç»Ÿä¸€è§„èŒƒå’Œé£æ ¼</strong><br/>
é›†å›¢ç¼–ç è§„èŒƒè‡ªä¸å¿…è¯´ï¼Œå¯¹äºä»£ç é£æ ¼è¦ä¸è¦ç»Ÿä¸€ï¼Œå¯èƒ½ä¼šæœ‰ä¸åŒçš„çœ‹æ³•ï¼Œä¸ªäººè§‚ç‚¹å¯¹äºé£æ ¼ä¹Ÿä¸å¼ºæ±‚ã€‚ä¸è¿‡ä»£ç é£æ ¼çš„ç»Ÿä¸€æ›´æœ‰åŠ©äºæå‡ä»£ç çš„å¯è¯»æ€§åŠè®©ç»§ä»»è€…å¿«é€Ÿä¸Šæ‰‹</li>
<li><strong>å›¢é˜Ÿå…±è¯†</strong><br/>
é€šè¿‡å¤šæ¬¡è®¨è®ºä¸äº¤æµï¼Œé€æ­¥è¾¾æˆå›¢é˜Ÿå…±è¯†ï¼Œç‰¹åˆ«æ˜¯å¯¹æ¶æ„ç†è§£å’Œè®¾è®¡åŸåˆ™çš„è®¤çŸ¥ï¼Œåœ¨å…±è¯†çš„åŸºç¡€ä¸Šå›¢é˜Ÿä¹Ÿä¼šæ›´æœ‰å‡èšåŠ›ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾ƒå¤šæ–°äººåŠ å…¥æ—¶å°¤ä¸ºé‡è¦</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€æ€ä¹ˆåš Code Review</h2>
<h3 data-id="heading-5">3.1 ä»£ç æäº¤è€…</h3>
<h5 data-id="heading-6">3.1.1 ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·</h5>
<ul>
<li>ESLint + Prettier</li>
</ul>
<p>ä¸‹é¢æ˜¯ VS Code å…³äº Prettier çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[vue]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[javascript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[html]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[jsonc]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[json]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[javascriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint.codeActionsOnSave.mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"problems"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint.validate"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"typescript"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"javascript"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"javascriptreact"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"typescriptreact"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"editor.codeActionsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-comment">// æŒ‡å®šæ˜¯å¦åœ¨ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨æ•´ç†å¯¼å…¥</span>
        <span class="hljs-attr">"source.organizeImports"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åˆ©ç”¨ Ctrl + S è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç </p>
<ul>
<li>Husky + Lint-staged</li>
</ul>
<p>å®‰è£…ä¾èµ–</p>
<pre><code class="hljs language-csharp" lang="csharp">yarn <span class="hljs-keyword">add</span> -D husky
yarn <span class="hljs-keyword">add</span> -D lint-staged
</code></pre>
<p><strong>husky</strong></p>
<p>ä¸€ä¸ªä¸º git å®¢æˆ·ç«¯å¢åŠ  hook çš„å·¥å…·ã€‚å®‰è£…åï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨ä»“åº“ä¸­çš„ .husky/ ç›®å½•ä¸‹å¢åŠ ç›¸åº”çš„é’©å­ï¼›æ¯”å¦‚ pre-commit é’©å­å°±ä¼šåœ¨ä½ æ‰§è¡Œ git commit çš„è§¦å‘ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ pre-commit ä¸­å®ç°ä¸€äº›æ¯”å¦‚ lint æ£€æŸ¥ã€å•å…ƒæµ‹è¯•ã€ä»£ç ç¾åŒ–ç­‰æ“ä½œã€‚</p>
<p>package.json éœ€è¦æ·»åŠ  prepare è„šæœ¬</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"husky install"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åšå®Œä»¥ä¸Šå·¥ä½œï¼Œå°±å¯ä»¥ä½¿ç”¨ husky åˆ›å»ºä¸€ä¸ª hook äº†</p>
<pre><code class="hljs language-sql" lang="sql">npx husky <span class="hljs-keyword">add</span> .husky<span class="hljs-operator">/</span>pre<span class="hljs-operator">-</span><span class="hljs-keyword">commit</span> "npx lint-staged"
</code></pre>
<p><strong>lint-staged</strong></p>
<p>ä¸€ä¸ªä»…ä»…è¿‡æ»¤å‡º Git ä»£ç æš‚å­˜åŒºæ–‡ä»¶(è¢« git add çš„æ–‡ä»¶)çš„å·¥å…·ï¼›è¿™ä¸ªå¾ˆå®ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¦‚æœå¯¹æ•´ä¸ªé¡¹ç›®çš„ä»£ç åšä¸€ä¸ªæ£€æŸ¥ï¼Œå¯èƒ½è€—æ—¶å¾ˆé•¿ï¼Œå¦‚æœæ˜¯è€é¡¹ç›®ï¼Œè¦å¯¹ä¹‹å‰çš„ä»£ç åšä¸€ä¸ªä»£ç è§„èŒƒæ£€æŸ¥å¹¶ä¿®æ”¹çš„è¯ï¼Œè¿™å¯èƒ½å°±éº»çƒ¦äº†ï¼Œå¯èƒ½å¯¼è‡´é¡¹ç›®æ”¹åŠ¨å¾ˆå¤§ã€‚æ‰€ä»¥è¿™ä¸ª lint-stagedï¼Œå¯¹å›¢é˜Ÿé¡¹ç›®å’Œå¼€æºé¡¹ç›®æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå®ƒæ˜¯å¯¹ä¸ªäººè¦æäº¤çš„ä»£ç çš„ä¸€ä¸ªè§„èŒƒå’Œçº¦æŸã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬å·²ç»å®ç°äº†ç›‘å¬ Git hooksï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ pre-commit è¿™ä¸ª hook ä½¿ç”¨ Lint-staged å¯¹ä»£ç è¿›è¡Œ prettier çš„è‡ªåŠ¨åŒ–ä¿®å¤å’Œ ESLint çš„æ£€æŸ¥ï¼Œå¦‚æœå‘ç°ä¸ç¬¦åˆä»£ç è§„èŒƒçš„æ–‡ä»¶åˆ™ç›´æ¥é€€å‡º commitã€‚</p>
<p>å¹¶ä¸” Lint-staged åªä¼šå¯¹ Git æš‚å­˜åŒº(git add çš„ä»£ç )å†…çš„ä»£ç è¿›è¡Œæ£€æŸ¥è€Œä¸æ˜¯å…¨é‡ä»£ç ï¼Œä¸”ä¼šè‡ªåŠ¨å°† prettier æ ¼å¼åŒ–åçš„ä»£ç æ·»åŠ åˆ°æ­¤æ¬¡ commit ä¸­ã€‚</p>
<p>åœ¨ package.json ä¸­é…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 <span class="hljs-attr">"husky"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"pre-commit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lint-staged"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"*.{ts,tsx,js}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"eslint --fix"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"prettier --write"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"git add"</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunmh207%2FAI-Codereview-Gitlab" target="_blank" title="https://github.com/sunmh207/AI-Codereview-Gitlab" ref="nofollow noopener noreferrer">AI-Codereview-Gitlab</a></li>
</ul>
<p>åˆå¹¶ä»£ç çš„æ—¶å€™è‡ªåŠ¨è§¦å‘æ‰§è¡ŒåŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥å·¥å…·ã€‚å¯ä»¥å…ˆæ ¹æ® AI æç¤ºé€‰æ‹©æ€§çš„æ•´æ”¹ä¸€æ³¢ï¼Œç„¶åå†æ‰¾è¯„å®¡çš„äºº CRã€‚æ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡»<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunmh207%2FAI-Codereview-Gitlab" target="_blank" title="https://github.com/sunmh207/AI-Codereview-Gitlab" ref="nofollow noopener noreferrer">é“¾æ¥</a>äº†è§£ä¸€ä¸‹ã€‚</p>
<p>åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<ol>
<li>ğŸš€ å¤šæ¨¡å‹æ”¯æŒ
<ul>
<li>å…¼å®¹DeepSeekã€ZhipuAIã€OpenAIã€Anthropicã€é€šä¹‰åƒé—®å’ŒOllamaï¼Œæƒ³ç”¨å“ªä¸ªå°±ç”¨å“ªä¸ªã€‚</li>
</ul>
</li>
<li>ğŸ“¢æ¶ˆæ¯å³æ—¶ä¸»åŠ¨
<ul>
<li>ç»“æœå®¡æŸ¥ä¸€é”®ç›´è¾¾é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡æˆ–é£ä¹¦ï¼Œä»£ç é—®é¢˜æ— å¤„å¯è—ï¼</li>
</ul>
</li>
<li>ğŸ“…è‡ªåŠ¨åŒ–æ—¥æŠ¥ç”Ÿæˆ
<ul>
<li>åŸºäº GitLab &amp; GitHub &amp; Gitea Commit è®°å½•ï¼Œè‡ªåŠ¨æ•´ç†æ¯æ—¥å¼€å‘è¿›åº¦ï¼Œè°åœ¨æ‘¸é±¼ã€è°åœ¨å·ï¼Œä¸€ç›®äº†ç„¶ ğŸ˜¼ã€‚</li>
</ul>
</li>
<li>ğŸ“Šå¯è§†åŒ–ä»ªè¡¨æ¿
<ul>
<li>é›†ä¸­å±•ç¤ºæ‰€æœ‰ä»£ç å®¡æŸ¥è®°å½•ï¼Œé¡¹ç›®ç»Ÿè®¡ã€å¼€å‘è€…ç»Ÿè®¡ï¼Œæ•°æ®è¯´è¯ï¼Œç”©é”…æ— é—¨ï¼</li>
</ul>
</li>
<li>ğŸ­ è¯„è®ºé£æ ¼ä»»ä½ é€‰
<ul>
<li>ä¸“ä¸šå‹ğŸ¤µï¼šä¸¥è°¨ä¸¥è°¨ï¼Œæ­£å¼ä¸“ä¸šã€‚</li>
<li>è®ºå‹ğŸ˜ˆï¼šæ¯’èˆŒåæ§½ï¼Œä¸“æ²»ä¸æœï¼ˆâ€œè¿™ä»£ç æ˜¯ç”¨è„šå†™çš„å—ï¼Ÿâ€ï¼‰</li>
<li>ç»…å£«å‹ğŸ˜ï¼šæ¸©æŸ”å»ºè®®ï¼Œå¦‚æ²æ˜¥é£ï¼ˆâ€œä¹Ÿè®¸è¿™é‡Œå¯ä»¥å†ä¼˜åŒ–ä¸€ä¸‹å‘¢~â€ï¼‰</li>
<li>å¹½é»˜å‹ğŸ¤ªï¼šæç¬‘ç‚¹è¯„ï¼Œå¿«ä¹æ”¹ç ï¼ˆâ€œbe if-elseæ¯”æˆ‘çš„ç›¸äº²ç»å†è¿˜æ›²æŠ˜ï¼â€ï¼‰</li>
</ul>
</li>
</ol>
<h5 data-id="heading-7">3.1.2 å‘èµ· Code Review æ—¶é—´å’Œä»£ç é‡</h5>
<ul>
<li>æ—¶é—´ï¼šå°½é‡<strong>ä¸Šçº¿å‰ä¸€å¤©</strong>å‘èµ·è¯„å®¡</li>
<li>ä»£ç é‡ï¼šæœ€å¥½åœ¨ 400 è¡Œä»¥ä¸‹ã€‚æ ¹æ®æ•°æ®åˆ†æå‘ç°ï¼Œä»ä»£ç è¡Œæ•°æ¥çœ‹ï¼Œè¶…è¿‡ 400 è¡Œçš„ CRï¼Œç¼ºé™·å‘ç°ç‡ä¼šæ€¥å‰§ä¸‹é™ï¼›ä» CR é€Ÿåº¦æ¥çœ‹ï¼Œè¶…è¿‡500 è¡Œ/å°æ—¶åï¼ŒReview è´¨é‡ä¹Ÿä¼šå¤§å¤§é™ä½ï¼Œä¸€ä¸ªé«˜è´¨é‡çš„ CR æœ€å¥½æ§åˆ¶åœ¨ä¸€ä¸ªå°æ—¶ä»¥å†…ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 ä»£ç è¯„å®¡è€…</h3>
<h5 data-id="heading-9">3.2.1 è¯„å®¡æ—¶é‡ç‚¹å…³æ³¨å†…å®¹</h5>
<p>ä½œä¸ºå‰ç«¯è¯„å®¡è€…ï¼Œå¯ä»¥æ£€æŸ¥ä»¥ä¸‹ç»´åº¦ï¼š</p>













































<table><thead><tr><th>ç»´åº¦</th><th>æ£€æŸ¥ç‚¹ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>åŠŸèƒ½æ­£ç¡®æ€§</strong></td><td>é€»è¾‘æ˜¯å¦è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼Ÿè¾¹ç•Œæ¡ä»¶ï¼ˆç©ºå€¼ã€é”™è¯¯çŠ¶æ€ï¼‰æ˜¯å¦å¤„ç†ï¼Ÿ</td></tr><tr><td><strong>å¯è¯»æ€§ &amp; å¯ç»´æŠ¤æ€§</strong></td><td>å˜é‡/å‡½æ•°å‘½åæ˜¯å¦æ¸…æ™°ï¼Ÿç»„ä»¶èŒè´£æ˜¯å¦å•ä¸€ï¼Ÿé‡å¤ä»£ç æ˜¯å¦å¯å¤ç”¨ï¼Ÿ</td></tr><tr><td><strong>TypeScript å®‰å…¨</strong></td><td>æ˜¯å¦æ»¥ç”¨Â <code>any</code>Â /Â <code>@ts-ignore</code>ï¼Ÿç±»å‹å®šä¹‰æ˜¯å¦å‡†ç¡®ï¼Ÿ</td></tr><tr><td><strong>æ¡†æ¶è§„èŒƒ</strong></td><td>Reactï¼š<code>key</code>Â æ˜¯å¦åˆç†ï¼Ÿ<code>useEffect</code>Â ä¾èµ–æ˜¯å¦å®Œæ•´ï¼ŸVueï¼šå“åº”å¼ä½¿ç”¨æ˜¯å¦æ­£ç¡®ï¼Ÿ</td></tr><tr><td><strong>æ ·å¼ &amp; UI</strong></td><td>æ˜¯å¦é¿å…å…¨å±€ CSS æ±¡æŸ“ï¼Ÿæ˜¯å¦é€‚é…ç§»åŠ¨ç«¯ï¼Ÿæ˜¯å¦ç¬¦åˆè®¾è®¡ç³»ç»Ÿï¼Ÿ</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Ÿå›¾ç‰‡/èµ„æºæ˜¯å¦ä¼˜åŒ–ï¼Ÿç¬¬ä¸‰æ–¹åº“æ˜¯å¦æŒ‰éœ€å¼•å…¥ï¼Ÿ</td></tr><tr><td><strong>å¯è®¿é—®æ€§ (a11y)</strong></td><td>æ˜¯å¦ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾ï¼Ÿè¡¨å•æ˜¯å¦æœ‰ labelï¼Ÿé”®ç›˜å¯¼èˆªæ˜¯å¦æ”¯æŒï¼Ÿ</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>ç”¨æˆ·è¾“å…¥æ˜¯å¦è½¬ä¹‰ï¼Ÿæ˜¯å¦é¿å… XSSï¼ˆå¦‚Â <code>dangerouslySetInnerHTML</code>ï¼‰ï¼Ÿ</td></tr><tr><td><strong>æµ‹è¯•è¦†ç›–</strong></td><td>å…³é”®é€»è¾‘æ˜¯å¦æœ‰å•å…ƒæµ‹è¯•ï¼Ÿç”¨æˆ·è·¯å¾„æ˜¯å¦æœ‰ E2E æµ‹è¯•ï¼Ÿ</td></tr></tbody></table>
<h5 data-id="heading-10">3.2.2 æ€ä¹ˆå†™ Review è¯„è®º</h5>
<p>é¦–å…ˆï¼Œä¸è¦åå•¬ä½ çš„èµç¾ã€‚<strong>ä»£ç å†™çš„å¥½çš„åœ°æ–¹è¦è¡¨æ‰¬ï¼ï¼</strong></p>
<p>åŒºåˆ†ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>ğŸ”´Â <strong>å¿…é¡»æ”¹</strong>ï¼šBugã€å®‰å…¨æ¼æ´ã€ç ´åæ€§å˜æ›´</li>
<li>ğŸŸ¡Â <strong>å»ºè®®æ”¹</strong>ï¼šå¯è¯»æ€§ã€æ€§èƒ½ä¼˜åŒ–ã€æœ€ä½³å®è·µ</li>
<li>ğŸŸ¢Â <strong>å¯è®¨è®º</strong>ï¼šé£æ ¼åå¥½ï¼ˆåº”ç”± Lint å·¥å…·ç»Ÿä¸€ï¼‰</li>
</ul>
<p>ç”¨å¥½ â€œWhat-Why-Howâ€ æ³•åˆ™</p>
<p>âœ… æ­£ç¡®ç¤ºèŒƒï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">What: è¿™é‡Œç›´æ¥æ“ä½œ DOM (`document.getElementById`)  </span>
<span class="hljs-section">Why: åœ¨ React ä¸­ç»•è¿‡è™šæ‹Ÿ DOM ä¼šå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ï¼Œä¸”éš¾ä»¥æµ‹è¯•  </span>
<span class="hljs-section">How: å»ºè®®æ”¹ç”¨ `useRef` è·å–å…ƒç´ å¼•ç”¨ï¼Œæˆ–é€šè¿‡çŠ¶æ€é©±åŠ¨ UI æ›´æ–°</span>
</code></pre>
<p>âŒ é¿å…ï¼š</p>
<pre><code class="hljs">â€œè¿™é‡Œå†™å¾—ä¸å¥½â€ â†’ å¤ªæ¨¡ç³Š
â€œä½ åº”è¯¥ç”¨ Hooks é‡å†™â€ â†’ æ²¡è¯´æ˜åŸå› 
â€œæˆ‘ä»¥å‰éƒ½è¿™ä¹ˆå†™çš„â€ â†’ ä¸»è§‚ç»éªŒï¼Œç¼ºä¹ä¾æ®
</code></pre>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>å¥½çš„ Code Review æ˜¯å›¢é˜Ÿè¿›æ­¥çš„æ”¾å¤§å™¨ï¼Œå®ƒå¯ä»¥ï¼š</p>
<ul>
<li>è®©æ–°äººæˆé•¿å¾—æ›´å¿«</li>
<li>è®©ç³»ç»Ÿå˜å¾—æ›´ç¨³å®š</li>
<li>è®©"æŠ€æœ¯å€º"æ›´å°‘</li>
<li>è®©åä½œæ›´é«˜æ•ˆ</li>
</ul>
<h2 data-id="heading-12">å‚è€ƒæ–‡ç« </h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.aliyun.com%2Farticle%2F1164854" target="_blank" title="https://developer.aliyun.com/article/1164854" ref="nofollow noopener noreferrer">ä¸€æ–‡æ¢³ç†Code Reviewæ–¹æ³•è®ºä¸å®è·µæ€»ç»“</a></li>
</ul>
<h2 data-id="heading-13">æ„Ÿè°¢</h2>
<ul>
<li>æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæ‰¹è¯„æŒ‡æ­£ã€‚</li>
<li>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå°±<strong>ç‚¹èµã€æ”¶è—</strong>æ”¯æŒä¸‹å§ï¼æ„Ÿè°¢é˜…è¯»ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7585727457472561152</link>    <guid>https://juejin.cn/post/7585727457472561152</guid>    <pubDate>2025-12-21T12:52:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472561152" data-draft-id="7585555806668046370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,GitHub"/> <meta itemprop="datePublished" content="2025-12-21T12:52:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é‘«åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685871694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685871694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é‘«åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:52:15.000Z" title="Sun Dec 21 2025 12:52:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å†…å®¹æ¥è‡ªï¼šNotebookLM å¯¹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOSpoon%2Fvue-pdf-interactor" target="_blank" title="https://github.com/OSpoon/vue-pdf-interactor" ref="nofollow noopener noreferrer">vue-pdf-interactor</a> é¡¹ç›®åˆ†æåè‡ªåŠ¨ç”Ÿæˆ</strong></p>
<h2 data-id="heading-0">1.0 å¼•è¨€ï¼šé‡æ–°å®šä¹‰ Web ä¸­çš„ PDF äº¤äº’</h2>
<p>åœ¨ç°ä»£ Web åº”ç”¨çš„ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒPDF æ–‡æ¡£ä»ç„¶æ˜¯ä¿¡æ¯åˆ†å‘å’Œå½’æ¡£çš„æ ¸å¿ƒåª’ä»‹ã€‚ç„¶è€Œï¼Œå®ƒä»¬é€šå¸¸ä»¥é™æ€ã€ä¸å¯äº¤äº’çš„å½¢å¼å­˜åœ¨ï¼Œæå¤§åœ°é™åˆ¶äº†ç”¨æˆ·ä¸æ–‡æ¡£å†…å®¹è¿›è¡Œæ·±åº¦äº’åŠ¨çš„èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®æå–å’ŒåŠ¨æ€æ“ä½œæ–¹é¢ã€‚è¿™ç§å±€é™æ€§å¯¼è‡´äº†ç”¨æˆ·ä½“éªŒçš„æ–­å±‚ï¼Œä½¿å¾—ä»åˆåŒã€æŠ¥å‘Šåˆ°æ‰«ææ¡£æ¡ˆç­‰å…³é”®æ–‡æ¡£çš„ä»·å€¼æ— æ³•è¢«å……åˆ†å‘æ˜ã€‚</p>
<p><code>vue-pdf-interactor</code> çš„é—®ä¸–æ­£æ˜¯ä¸ºäº†å¼¥åˆè¿™ä¸€å·®è·ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ PDF æŸ¥çœ‹å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªæˆ˜ç•¥æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨é€šè¿‡ä¸º PDF æ–‡æ¡£å åŠ ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„äº¤äº’å±‚ï¼Œå½»åº•æ”¹å˜ç”¨æˆ·ä¸ PDF å†…å®¹çš„äº’åŠ¨æ–¹å¼ã€‚è¯¥ç»„ä»¶åº“å…è®¸å¼€å‘è€…å°†é™æ€çš„ã€ç”šè‡³æ˜¯åŸºäºå›¾åƒçš„ PDF è½¬åŒ–ä¸ºå¯æ“ä½œã€å¯å“åº”çš„æ•°æ®æºï¼Œä»è€Œè§£é”å…¨æ–°çš„åº”ç”¨å¯èƒ½æ€§ã€‚</p>
<p>æœ¬æ–‡æ¡£å°†ä»æ ¸å¿ƒåŠŸèƒ½ã€æŠ€æœ¯æ¶æ„ã€å®æ–½æŒ‡å—åŠå…¸å‹åº”ç”¨åœºæ™¯ç­‰å¤šä¸ªç»´åº¦ï¼Œå…¨é¢è§£æ <code>vue-pdf-interactor</code> ç»„ä»¶åº“çš„è®¾è®¡ç†å¿µä¸å•†ä¸šä»·å€¼ï¼Œä¸ºæŠ€æœ¯å†³ç­–è€…å’Œå¼€å‘è€…æä¾›ä¸€ä»½æ˜ç¡®çš„æŠ€æœ¯æŒ‡å—ã€‚</p>
<h2 data-id="heading-1">2.0 æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼ä¸»å¼ </h2>
<p>æœ¬ç« èŠ‚æ—¨åœ¨æ·±å…¥å‰–æ <code>vue-pdf-interactor</code> çš„æ ¸å¿ƒåŠŸèƒ½é›†ã€‚æ­£æ˜¯è¿™äº›ç²¾å¿ƒè®¾è®¡çš„åŠŸèƒ½ï¼Œå…±åŒæ„æˆäº†å…¶ç‹¬ç‰¹çš„ä»·å€¼ä¸»å¼ â€”â€”å°†ä¼ ç»Ÿçš„ PDF æŸ¥çœ‹å™¨ï¼Œå‡çº§ä¸ºä¸€ä¸ªå¼ºå¤§ã€å¯æ‰©å±•çš„äº¤äº’å¼æ–‡æ¡£å·¥å…·ï¼Œä¸ºå¤æ‚çš„ä¸šåŠ¡æµç¨‹èµ‹èƒ½ã€‚</p>
<h3 data-id="heading-2">2.1 åŸºäº vue-pdf-embed çš„åšå®æ¸²æŸ“åŸºç¡€</h3>
<p><code>vue-pdf-interactor</code> çš„ä¸€ä¸ªå…³é”®æ¶æ„å†³ç­–æ˜¯æ„å»ºäºæˆç†Ÿçš„ <code>vue-pdf-embed</code> ç»„ä»¶ä¹‹ä¸Šã€‚è¿™ä¸€é€‰æ‹©ä½“ç°äº†æ·±æ€ç†Ÿè™‘çš„æ¶æ„å®¡æ…æ€§ï¼Œå…¶æ ¸å¿ƒç›®æ ‡åœ¨äº<strong>é¡¹ç›®å»é£é™©åŒ–</strong>ã€‚é€šè¿‡å°†å¤æ‚ä¸”æ˜“é”™çš„åº•å±‚ PDF è§£æä¸æ¸²æŸ“å±‚å§”æ‰˜ç»™ä¸€ä¸ªç»è¿‡ç¤¾åŒºå¹¿æ³›éªŒè¯çš„æˆç†Ÿåº“ï¼Œ<code>vue-pdf-interactor</code> å¾—ä»¥å°†å…¶å…¨éƒ¨çš„å¼€å‘é¢„ç®—å’Œç²¾åŠ›èšç„¦äºè‡ªèº«çš„æ ¸å¿ƒç«äº‰åŠ›â€”â€”æ„å»ºç¨³å®šã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„äº¤äº’å±‚ã€‚</p>
<h3 data-id="heading-3">2.2 æ ¸å¿ƒäº¤äº’èƒ½åŠ›ï¼šOCR æ–‡æœ¬é«˜äº®ä¸é€‰æ‹©</h3>
<p><code>vue-pdf-interactor</code> æœ€å…·å·®å¼‚åŒ–çš„ç‰¹æ€§ï¼Œåœ¨äºå…¶é›†æˆäº† OCR (å…‰å­¦å­—ç¬¦è¯†åˆ«) æ–‡æœ¬è¯†åˆ«ã€é«˜äº®æ˜¾ç¤ºå’Œäº¤äº’å¼æ–‡æœ¬å—é€‰æ‹©çš„èƒ½åŠ›ã€‚è¿™ä¸€åŠŸèƒ½ç»„åˆæ˜¯å…¶ä»·å€¼çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œå¯¹äºæ•°æ®æ ‡æ³¨ã€å†…å®¹å¼•ç”¨ã€æ–‡æ¡£å®¡æŸ¥ç­‰å·¥ä½œæµç¨‹è€Œè¨€ï¼Œå…·æœ‰é©å‘½æ€§çš„å½±å“ã€‚å®ƒæœ‰æ•ˆåœ°å°†æ–‡æ¡£ä»ä¸€ä¸ªå•ä¸€çš„è§†è§‰åŒºå—ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªå¯æŸ¥è¯¢çš„ã€ç”±æ–‡æœ¬èŠ‚ç‚¹æ„æˆçš„æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰ï¼Œä»è€Œè§£é”äº†å¯¹å…¶å†…å®¹çš„ç¨‹åºåŒ–è®¿é—®èƒ½åŠ›ã€‚è¿™ä½¿å¾—é™æ€çš„ã€åŸºäºå›¾åƒçš„ PDF æ–‡æ¡£ï¼ˆå°¤å…¶æ˜¯æ‰«æä»¶ï¼‰å¾—ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå¯è¢«ç¨‹åºç†è§£å’Œæ“ä½œçš„ç»“æ„åŒ–æ•°æ®æºã€‚</p>
<h3 data-id="heading-4">2.3 é«˜åº¦å¯æ‰©å±•çš„äº¤äº’æ¥å£</h3>
<p>ç»„ä»¶åº“é€šè¿‡æä¾›â€œå¯è‡ªå®šä¹‰çš„å·¥å…·æ æŒ‰é’®â€åŠŸèƒ½ï¼Œä¸ºå¼€å‘è€…æ‰“å¼€äº†é€šå¾€æ— é™äº¤äº’å¯èƒ½çš„å¤§é—¨ã€‚åˆ©ç”¨ Vue çš„æ’æ§½ï¼ˆSlotï¼‰æœºåˆ¶ï¼Œç‰¹åˆ«æ˜¯ <code>&lt;template #toolbar&gt;</code>ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°å°†è‡ªå®šä¹‰çš„ä¸šåŠ¡é€»è¾‘ä¸ç”¨æˆ·é€‰æ‹©çš„ PDF æ–‡æœ¬å—è¿›è¡Œç»‘å®šã€‚</p>
<p>å¦‚ä¸‹æ–¹ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“ç”¨æˆ·é€‰ä¸­ä¸€ä¸ªæ–‡æœ¬å—æ—¶ï¼Œå¼€å‘è€…å¯ä»¥å®šä¹‰ä¸€ä¸ªâ€œæ“ä½œâ€æŒ‰é’®ï¼Œå…¶ç‚¹å‡»äº‹ä»¶èƒ½å¤Ÿè·å–åˆ°å½“å‰é€‰ä¸­æ–‡æœ¬å—ï¼ˆ<code>block</code>ï¼‰çš„å…¨éƒ¨ä¿¡æ¯ã€‚æ— è®ºæ˜¯å°†é€‰å®šå†…å®¹ä¿å­˜åˆ°æ•°æ®åº“ã€è°ƒç”¨ç¬¬ä¸‰æ–¹ API è¿›è¡Œç¿»è¯‘ï¼Œè¿˜æ˜¯è§¦å‘å…¶ä»–å¤æ‚çš„ä¸šåŠ¡æµç¨‹ï¼Œéƒ½å˜å¾—å¼‚å¸¸ç®€å•å’Œç›´è§‚ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">&lt;<span class="hljs-keyword">template</span> <span class="hljs-meta">#toolbar=<span class="hljs-string">"{ block }"</span>&gt;</span>
  &lt;ToolbarButton
    label=<span class="hljs-string">"æ“ä½œ"</span>
    @click=<span class="hljs-string">"() =&gt; handleAction(block)"</span>
  /&gt;
&lt;/<span class="hljs-keyword">template</span>&gt;
</code></pre>
<h3 data-id="heading-5">2.4 é¢å‘ç°ä»£åŒ–å¼€å‘çš„å·¥ç¨‹è®¾è®¡</h3>
<p><code>vue-pdf-interactor</code> åœ¨å·¥ç¨‹è®¾è®¡ä¸Šç´§è·Ÿç°ä»£å‰ç«¯å¼€å‘çš„æœ€ä½³å®è·µï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>ES Module æ”¯æŒ</strong>: ç»„ä»¶åº“ä»¥ ES Module æ ¼å¼åˆ†å‘ï¼Œç¡®ä¿äº†ä¸ Viteã€Webpack ç­‰ç°ä»£æ„å»ºå·¥å…·çš„æ— ç¼é›†æˆã€‚è¿™ä¸ä»…ä¼˜åŒ–äº†å¼€å‘æµç¨‹ï¼Œè¿˜ä½¿å¾— Tree-shaking ç­‰æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆè¿ä½œï¼Œå‡å°‘æœ€ç»ˆæ‰“åŒ…ä½“ç§¯ã€‚</li>
<li><strong>TypeScript æ”¯æŒ</strong>: é¡¹ç›®æä¾›äº†å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼ˆ<code>index.d.ts</code>ï¼‰ã€‚è¿™å¯¹äºå¤§å‹é¡¹ç›®è‡³å…³é‡è¦ï¼Œå®ƒæå¤§åœ°æå‡äº†å¼€å‘ä½“éªŒï¼Œé€šè¿‡é™æ€ç±»å‹æ£€æŸ¥å¢å¼ºäº†ä»£ç çš„å¥å£®æ€§ï¼Œå¹¶ä½¿å¾—ç»„ä»¶åº“åœ¨å¤æ‚åº”ç”¨ä¸­çš„å¯ç»´æŠ¤æ€§å¾—åˆ°ä¿éšœã€‚</li>
</ul>
<p>è¿™äº›å¼ºå¤§çš„åŠŸèƒ½èƒŒåï¼Œæ˜¯ä¸€å¥—æ¸…æ™°ã€é«˜æ•ˆçš„æŠ€æœ¯æ¶æ„ã€‚</p>
<h2 data-id="heading-6">3.0 æŠ€æœ¯æ¶æ„ä¸è®¾è®¡ç†å¿µ</h2>
<p>æœ¬ç« èŠ‚å°†æ·±å…¥æ¢è®¨ <code>vue-pdf-interactor</code> çš„å†…éƒ¨æ„é€ ã€‚å¯¹äºå¸Œæœ›é«˜æ•ˆé›†æˆã€æ·±åº¦å®šåˆ¶æˆ–è¿›è¡Œé—®é¢˜æ’æŸ¥çš„å¼€å‘è€…è€Œè¨€ï¼Œç†è§£å…¶æŠ€æœ¯é€‰å‹ã€æ ¸å¿ƒä¾èµ–ä»¥åŠæ„å»ºäº§ç‰©æ˜¯è‡³å…³é‡è¦çš„ç¬¬ä¸€æ­¥ã€‚</p>
<h3 data-id="heading-7">3.1 æ ¸å¿ƒä¾èµ–æ ˆè§£æ</h3>
<p><code>vue-pdf-interactor</code> çš„åŠŸèƒ½å®ç°ä¾èµ–äºä¸€ä¸ªç²¾å¿ƒæŒ‘é€‰çš„å°è€Œç²¾çš„æ ¸å¿ƒä¾èµ–æ ˆï¼Œæ¯ä¸ªåº“éƒ½åœ¨å…¶ä¸­æ‰®æ¼”ç€ä¸å¯æˆ–ç¼ºçš„è§’è‰²ï¼š</p>
<ul>
<li><code>vue (^3.5.24) </code>: ä½œä¸ºæ•´ä¸ªç»„ä»¶åº“çš„åŸºçŸ³ï¼Œæä¾›äº†å¼ºå¤§çš„å“åº”å¼ç³»ç»Ÿå’Œç»„ä»¶åŒ–æ¨¡å‹ï¼Œæ˜¯å®ç°å£°æ˜å¼ UI å’Œå¤æ‚çŠ¶æ€ç®¡ç†çš„åŸºç¡€ã€‚</li>
<li><code>vue-pdf-embed (^2.1.3) </code>: æ‰¿æ‹…äº†åº•å±‚çš„ PDF æ–‡æ¡£æ¸²æŸ“å·¥ä½œï¼Œæ˜¯å®ç°æ–‡æ¡£å¯è§†åŒ–çš„æ ¸å¿ƒå¼•æ“ï¼Œä¿è¯äº†ç¨³å®šå’Œé«˜è´¨é‡çš„æ¸²æŸ“æ•ˆæœã€‚</li>
<li><code>@floating-ui/vue (^1.1.9) </code>: ä¸“ç”¨äºè§£å†³æµ®åŠ¨ UI å…ƒç´ çš„å®šä½é—®é¢˜ã€‚å®ƒä¼˜é›…åœ°å¤„ç†äº†åœ¨ä¸€ä¸ªå¯æ»šåŠ¨ä¸”å¯èƒ½å‘ç”Ÿå˜æ¢çš„è§†å£ä¸­ï¼Œå°† UI å…ƒç´ ï¼ˆå¦‚å·¥å…·æ ï¼‰ç²¾ç¡®å®šä½åˆ°ç›®æ ‡å…ƒç´ ï¼ˆå¦‚é€‰ä¸­æ–‡æœ¬ï¼‰æ—çš„å¤æ‚è®¡ç®—å‡ ä½•éš¾é¢˜ã€‚</li>
<li><code>@vueuse/core (^14.1.0) </code>: ä¸€ä¸ªæä¾›é«˜è´¨é‡ã€ç»è¿‡å®æˆ˜æ£€éªŒçš„ Vue ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰å·¥å…·é›†ã€‚é€šè¿‡åˆ©ç”¨å…¶ä¸­å°è£…å¥½çš„ DOM äº‹ä»¶å¤„ç†å’Œå“åº”å¼çŠ¶æ€ç®¡ç†ç­‰å‡½æ•°ï¼Œé¿å…äº†â€œé‡å¤é€ è½®å­â€ï¼Œæ˜¾è‘—å‡å°‘äº†äº¤äº’é€»è¾‘ä¸­çš„æ½œåœ¨é”™è¯¯ï¼Œå¹¶æå‡äº†ä»£ç çš„å¯è¯»æ€§ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 æŠ€æœ¯æ ˆæ„æˆ</h3>
<p>ä»é¡¹ç›®çš„è¯­è¨€æ„æˆæ¥çœ‹ï¼Œå…¶æŠ€æœ¯æ ˆçš„é€‰æ‹©éå¸¸æ˜ç¡®å’Œç°ä»£åŒ–ï¼š</p>
<ul>
<li><strong>Vue (64.1%)</strong></li>
<li><strong>TypeScript (34.6%)</strong></li>
<li><strong>HTML (1.3%)</strong></li>
</ul>
<p>è¿™ç§ä»¥ Vue å’Œ TypeScript ä¸ºä¸»å¯¼çš„ç»„åˆï¼Œæ˜¯æ„å»ºç±»å‹å®‰å…¨ã€ç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤çš„ç°ä»£å‰ç«¯åº“çš„ç†æƒ³é€‰æ‹©ã€‚Vue æä¾›äº†å“è¶Šçš„å¼€å‘ä½“éªŒå’Œæ€§èƒ½ï¼ŒTypeScript é€šè¿‡é™æ€ç±»å‹ç³»ç»Ÿä¸ºå¤§å‹åº”ç”¨å¸¦æ¥äº†ä»£ç å±‚é¢çš„å¯é æ€§ä¿éšœï¼Œè€Œå°‘é‡çš„ HTML åˆ™ä¸»è¦ç”¨äºå¼€å‘ç¯å¢ƒçš„å®¿ä¸»é¡µé¢ã€‚</p>
<h3 data-id="heading-9">3.3 æ„å»ºä¸åˆ†å‘</h3>
<p>å½“å¼€å‘è€…æ‰§è¡Œ <code>pnpm build</code> å‘½ä»¤åï¼Œä¼šç”Ÿæˆä¸€å¥—æ ‡å‡†åŒ–çš„ã€æ˜“äºé›†æˆçš„äº§ç‰©æ–‡ä»¶ã€‚è¿™å¥—æ–‡ä»¶ç»“æ„æ¸…æ™°åœ°åæ˜ äº†ç»„ä»¶åº“çš„è®¾è®¡ç†å¿µï¼š</p>
<ul>
<li><code>dist/index.js</code>: è¿™æ˜¯ä¸ºç°ä»£æµè§ˆå™¨å’Œæ„å»ºå·¥å…·å‡†å¤‡çš„ ES Module å…¥å£æ–‡ä»¶ï¼Œæ”¯æŒæœ€æ–°çš„ JavaScript ç‰¹æ€§ï¼Œå¹¶ä¸ºæ‰“åŒ…ä¼˜åŒ–åšå¥½äº†å‡†å¤‡ã€‚</li>
<li><code>dist/index.d.ts</code>: ä¸º TypeScript é¡¹ç›®æä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œç¡®ä¿å¼€å‘è€…åœ¨ä½¿ç”¨ç»„ä»¶åº“æ—¶èƒ½äº«å—åˆ°ä»£ç æç¤ºã€ç±»å‹æ£€æŸ¥ç­‰æ‰€æœ‰ä¾¿åˆ©ã€‚</li>
<li><code>dist/vue-pdf-interactor.css</code>: ç»„ä»¶åº“æ‰€éœ€çš„å…¨éƒ¨æ ·å¼æ–‡ä»¶ã€‚å¼€å‘è€…éœ€è¦åœ¨ä½¿ç”¨æ—¶æ‰‹åŠ¨å¼•å…¥æ­¤æ–‡ä»¶ï¼Œä»¥ä¿è¯ç»„ä»¶çš„æ­£ç¡®æ˜¾ç¤ºã€‚</li>
</ul>
<p>äº†è§£å…¶æ¶æ„åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­å¿«é€Ÿé›†æˆå¹¶ä½¿ç”¨å®ƒã€‚</p>
<h2 data-id="heading-10">4.0 å¿«é€Ÿä¸Šæ‰‹ä¸å®æ–½æŒ‡å—</h2>
<p>æœ¬ç« èŠ‚æ—¨åœ¨æä¾›ä¸€ä¸ªæ¸…æ™°ã€å¯æ“ä½œçš„æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…å°† <code>vue-pdf-interactor</code> å¿«é€Ÿã€é¡ºåˆ©åœ°é›†æˆåˆ°ç°æœ‰çš„ Vue 3 é¡¹ç›®ä¸­ï¼Œå¹¶å‘æŒ¥å…¶æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-11">4.1 ç¯å¢ƒå‡†å¤‡ä¸å®‰è£…</h3>
<p>åœ¨å®‰è£…ç»„ä»¶åº“ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„é¡¹ç›®å·²å…·å¤‡ä»¥ä¸‹ç¯å¢ƒã€‚</p>
<ol>
<li>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®‰è£…æ ¸å¿ƒä¾èµ–</strong> <code>vue-pdf-interactor</code> å°†å…¶æ ¸å¿ƒä¾èµ–å£°æ˜ä¸º<strong>å¯¹ç­‰ä¾èµ–ï¼ˆpeer dependenciesï¼‰</strong> ã€‚è¿™æ„å‘³ç€å®ƒä¸ä¼šå°† <code>vue</code>ã€<code>vue-pdf-embed</code> ç­‰åº“æ‰“åŒ…è¿›è‡ªèº«ï¼Œä»¥é¿å…åœ¨æ‚¨çš„æœ€ç»ˆåº”ç”¨ä¸­äº§ç”Ÿç‰ˆæœ¬å†²çªå’Œä¸å¿…è¦çš„ä½“ç§¯è†¨èƒ€ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦ç¡®ä¿é¡¹ç›®ä¸­å·²ç»å®‰è£…äº†ä»¥ä¸‹å››ä¸ªæ ¸å¿ƒåŒ…ï¼š</p>
<ul>
<li><code>vue</code></li>
<li><code>vue-pdf-embed</code></li>
<li><code>@floating-ui/vue</code></li>
<li><code>@vueuse/core</code></li>
</ul>
</li>
<li>
<p><strong>ç¬¬äºŒæ­¥ï¼šå®‰è£…ç»„ä»¶åº“</strong> ä½¿ç”¨æ‚¨åå¥½çš„åŒ…ç®¡ç†å™¨ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… <code>vue-pdf-interactor</code>ï¼š</p>
<ul>
<li><strong>Using pnpm</strong></li>
<li><strong>Using npm</strong></li>
<li><strong>Using yarn</strong></li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">4.2 åŸºç¡€ç”¨æ³•ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹ä»£ç ç¤ºä¾‹å±•ç¤ºäº† <code>vue-pdf-interactor</code> çš„å…¸å‹ç”¨æ³•ï¼Œæˆ‘ä»¬å°†å¯¹å…¶å…³é”®éƒ¨åˆ†è¿›è¡Œæ‹†è§£è¯´æ˜ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Interactor</span>, <span class="hljs-title class_">ToolbarButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-interactor'</span>
  <span class="hljs-keyword">import</span> type { <span class="hljs-title class_">OCRDocument</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-interactor'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-title class_">VuePdfEmbed</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-embed'</span>

  <span class="hljs-comment">// å¯¼å…¥æ ·å¼æ–‡ä»¶</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-interactor/vue-pdf-interactor.css'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-embed/dist/styles/annotationLayer.css'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-embed/dist/styles/textLayer.css'</span>

  <span class="hljs-keyword">const</span> pdfSource = <span class="hljs-string">'https://example.com/document.pdf'</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">ocrDocument</span>: <span class="hljs-title class_">OCRDocument</span> = {
    <span class="hljs-attr">pages</span>: [
      {
        <span class="hljs-attr">pageNumber</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">width</span>: <span class="hljs-number">1788</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-number">2527</span>,
        <span class="hljs-attr">blocks</span>: [
          <span class="hljs-comment">// OCR æ–‡æœ¬å—æ•°æ®</span>
        ]
      }
    ]
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">VuePdfEmbed</span>
    <span class="hljs-attr">:source</span>=<span class="hljs-string">"pdfSource"</span>
    <span class="hljs-attr">annotation-layer</span>
    <span class="hljs-attr">text-layer</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">after-page</span>=<span class="hljs-string">"{ page }"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Interactor</span>
        <span class="hljs-attr">:ocr-document</span>=<span class="hljs-string">"ocrDocument"</span>
        <span class="hljs-attr">:page</span>=<span class="hljs-string">"page"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">toolbar</span>=<span class="hljs-string">"{ block }"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ToolbarButton</span>
            <span class="hljs-attr">label</span>=<span class="hljs-string">"æ“ä½œ"</span>
            @<span class="hljs-attr">click</span>=<span class="hljs-string">"() =&gt; handleAction(block)"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Interactor</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">VuePdfEmbed</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">é€»è¾‘æ‹†è§£ï¼š</h4>
<ol>
<li>
<p><strong>å¯¼å…¥æ¨¡å—</strong>: é¦–å…ˆï¼Œä» <code>vue-pdf-interactor</code> å’Œ <code>vue-pdf-embed</code> ä¸­å¯¼å…¥æ‰€éœ€çš„ç»„ä»¶ã€ç±»å‹å’Œæ ·å¼æ–‡ä»¶ã€‚<strong>è¯·åŠ¡å¿…å¯¼å…¥</strong> <code>.css</code> <strong>æ ·å¼æ–‡ä»¶</strong>ï¼Œå¦åˆ™ç»„ä»¶å°†æ— æ³•æ­£å¸¸æ¸²æŸ“ã€‚</p>
</li>
<li>
<p><strong>ç»„ä»¶ç»“æ„</strong>: æ­¤å¤„é‡‡ç”¨äº†ä¸€ç§<strong>åŸºäºæ’æ§½çš„ç»„åˆæ¨¡å¼</strong>ã€‚<code>&lt;Interactor&gt;</code> ç»„ä»¶ä½œä¸ºä¸€ç§â€œæ— å¤´ï¼ˆheadlessï¼‰â€å¢å¼ºåŠŸèƒ½ï¼Œè¢«æ³¨å…¥åˆ° <code>&lt;VuePdfEmbed&gt;</code> çš„ <code>#after-page</code> æ’æ§½ä¸­ã€‚è¿™ç§è®¾è®¡å°†äº¤äº’é€»è¾‘ä¸æ¸²æŸ“ç»„ä»¶å®Œå…¨è§£è€¦ï¼Œéµå¾ªäº†å•ä¸€èŒè´£åŸåˆ™ï¼š<code>&lt;VuePdfEmbed&gt;</code> è´Ÿè´£æ¸²æŸ“ï¼Œè€Œ <code>&lt;Interactor&gt;</code> ä¸“æ³¨äº¤äº’ï¼Œä»è€Œå®ç°äº†æé«˜çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®ç»‘å®š</strong>:</p>
<ul>
<li><code>pdfSource</code>: æŒ‡å‘æ‚¨éœ€è¦å±•ç¤ºçš„ PDF æ–‡ä»¶ URLã€‚</li>
<li><code>ocrDocument</code>: è¿™æ˜¯æ ¸å¿ƒæ•°æ® <code>prop</code>ã€‚éœ€è¦ç‰¹åˆ«æŒ‡å‡ºï¼Œæ­¤æ•°æ®ç»“æ„<strong>åº”ç”±å¤–éƒ¨çš„å…‰å­¦å­—ç¬¦è¯†åˆ«ï¼ˆOCRï¼‰å¼•æ“ç”Ÿæˆ</strong>ã€‚æœ¬ç»„ä»¶åº“ä¸æ‰§è¡Œ OCRï¼Œè€Œæ˜¯æ¶ˆè´¹å…¶ç»“æœï¼Œä¾æ®å…¶ä¸­åŒ…å«çš„é¡µé¢å°ºå¯¸å’Œæ‰€æœ‰æ–‡æœ¬å—ï¼ˆ<code>blocks</code>ï¼‰çš„ä½ç½®åŠå†…å®¹ä¿¡æ¯æ¥æ¸²æŸ“å¯äº¤äº’åŒºåŸŸã€‚</li>
</ul>
</li>
<li>
<p><strong>è‡ªå®šä¹‰äº¤äº’</strong>: é€šè¿‡ <code>#toolbar</code> æ’æ§½ï¼Œæ‚¨å¯ä»¥å®šä¹‰å½“ç”¨æˆ·é€‰ä¸­ä¸€ä¸ªæ–‡æœ¬å—æ—¶æµ®ç°çš„å·¥å…·æ å†…å®¹ã€‚è¯¥æ’æ§½ä¼šå›ä¼ å½“å‰é€‰ä¸­çš„ <code>block</code> å¯¹è±¡ï¼Œæ‚¨å¯ä»¥ç»“åˆ <code>&lt;ToolbarButton&gt;</code> æˆ–å…¶ä»–è‡ªå®šä¹‰ç»„ä»¶ï¼Œæ¥å®ç°å…·ä½“çš„äº¤äº’é€»è¾‘ï¼Œä¾‹å¦‚è°ƒç”¨ <code>handleAction</code> å‡½æ•°å¤„ç†è¯¥æ–‡æœ¬å—çš„æ•°æ®ã€‚</p>
</li>
</ol>
<p>æŒæ¡äº†åŸºæœ¬ç”¨æ³•åï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥æ¢ç´¢ <code>vue-pdf-interactor</code> åœ¨çœŸå®ä¸šåŠ¡åœºæ™¯ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚</p>
<h2 data-id="heading-14">5.0 å…¸å‹åº”ç”¨åœºæ™¯åˆ†æ</h2>
<p>æœ¬ç« èŠ‚å°†è¶…è¶ŠæŠ€æœ¯å®ç°çš„ç»†èŠ‚ï¼Œæ¢è®¨ <code>vue-pdf-interactor</code> åœ¨å®é™…ä¸šåŠ¡åº”ç”¨ä¸­èƒ½å¤Ÿè§£å†³çš„å…·ä½“é—®é¢˜å’Œåˆ›é€ çš„ä»·å€¼ã€‚å…¶æ ¸å¿ƒçš„ OCR æ–‡æœ¬äº¤äº’èƒ½åŠ›ï¼Œä½¿å…¶æˆä¸ºå¤šä¸ªè¡Œä¸šæ•°å­—åŒ–è½¬å‹çš„æœ‰åŠ›å·¥å…·ã€‚</p>
<ul>
<li><strong>æ™ºèƒ½æ–‡æ¡£å®¡æŸ¥ä¸æ ‡æ³¨</strong> åœ¨æ³•å¾‹ã€é‡‘èã€ç§‘ç ”ç­‰é¢†åŸŸï¼Œä¸“ä¸šäººå£«éœ€è¦å¤„ç†å¤§é‡çš„åˆåŒã€è´¢æŠ¥æˆ–å­¦æœ¯è®ºæ–‡ã€‚åˆ©ç”¨ <code>vue-pdf-interactor</code>ï¼Œå¯ä»¥å°†è¿™äº›é™æ€æ–‡æ¡£è½¬åŒ–ä¸ºåŠ¨æ€çš„å®¡æŸ¥å·¥å…·ã€‚ç”¨æˆ·å¯ä»¥ç²¾ç¡®é«˜äº®å…³é”®æ¡æ¬¾ã€æ•°æ®ç‚¹æˆ–å‚è€ƒæ–‡çŒ®ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰å·¥å…·æ ä¸€é”®è§¦å‘åŠ¨ä½œï¼ˆå¦‚æ·»åŠ æ‰¹æ³¨æˆ–æå–æ•°æ®ï¼‰ï¼Œä»è€Œæå¤§åœ°å‡å°‘äººå·¥å®¡æŸ¥æ—¶é—´ï¼Œå¹¶é™ä½é«˜é£é™©ç¯å¢ƒä¸­çš„äººä¸ºé”™è¯¯é£é™©ã€‚</li>
<li><strong>äº¤äº’å¼åœ¨çº¿æ•™è‚²ææ–™</strong> ä¼ ç»Ÿçš„ PDF æ•™ææˆ–æ‰«æç‰ˆè¯•å·ç¼ºä¹äº’åŠ¨æ€§ã€‚é›†æˆ <code>vue-pdf-interactor</code> åï¼Œè¿™äº›é™æ€ææ–™å¯ä»¥è¢«èµ‹äºˆæ–°çš„ç”Ÿå‘½ã€‚æ•™å¸ˆå¯ä»¥é¢„è®¾ç‰¹å®šçš„æ–‡æœ¬å—ä¸ºé—®é¢˜è§¦å‘ç‚¹ï¼›å­¦ç”Ÿä¹Ÿå¯ä»¥è‡ªç”±é€‰æ‹©æ–‡æœ¬æ®µè½ï¼Œé€šè¿‡è‡ªå®šä¹‰å·¥å…·æ è¿›è¡Œåœ¨çº¿æŸ¥è¯æˆ–ç”Ÿæˆç¬”è®°ã€‚è¿™å°†é™æ€çš„å†…å®¹æ¶ˆè´¹è½¬å˜ä¸ºä¸€ç§ä¸»åŠ¨çš„å­¦ä¹ ä½“éªŒï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å­¦ç”Ÿçš„å‚ä¸åº¦å’ŒçŸ¥è¯†ä¿ç•™ç‡ã€‚</li>
<li><strong>æ•°å­—åŒ–æ¡£æ¡ˆä¸çŸ¥è¯†åº“</strong> è®¸å¤šä¼ä¸šå’Œæœºæ„æ‹¥æœ‰æµ·é‡çš„å†å²æ‰«æä»¶æ¡£æ¡ˆï¼Œè¿™äº›ä¿¡æ¯èµ„äº§ç”±äºéš¾ä»¥æ£€ç´¢å’Œåˆ©ç”¨è€Œå¤„äºâ€œæ²‰ç¡â€çŠ¶æ€ã€‚é€šè¿‡ <code>vue-pdf-interactor</code> çš„ OCR äº¤äº’åŠŸèƒ½ï¼Œå‘˜å·¥å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å¯¹æ‰«æçš„åˆåŒã€å›¾çº¸æˆ–æŠ¥å‘Šè¿›è¡Œæ–‡æœ¬é€‰æ‹©ã€å¤åˆ¶å’Œå†…å®¹å…³è”ï¼Œä»è€Œæœ‰æ•ˆåœ°å°†ä¼‘çœ çš„æ•°æ®èµ„äº§è´§å¸åŒ–ï¼Œå¹¶æ„å»ºä¸€ä¸ªå¯æœç´¢ã€é«˜ä»·å€¼çš„ä¼ä¸šçŸ¥è¯†åº“ã€‚</li>
</ul>
<h2 data-id="heading-15">6.0 å¼€å‘è€…ç”Ÿæ€ä¸è®¸å¯</h2>
<p>ä¸€ä¸ªæˆåŠŸçš„å¼€æºé¡¹ç›®ä¸ä»…éœ€è¦å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ›´ä¾èµ–äºä¸€ä¸ªå¥åº·ã€å¼€æ”¾çš„å¼€å‘è€…ç”Ÿæ€ç³»ç»Ÿã€‚<code>vue-pdf-interactor</code> åœ¨é¡¹ç›®ç®¡ç†å’Œè®¸å¯åè®®æ–¹é¢éƒ½ä¸ºç¤¾åŒºå‚ä¸å’Œå•†ä¸šåº”ç”¨æä¾›äº†ä¾¿åˆ©ã€‚</p>
<h3 data-id="heading-16">6.1 å¼€å‘ä¸è´¡çŒ®</h3>
<p>é¡¹ç›®æä¾›äº†ä¸€å¥—æ ‡å‡†åŒ–çš„å¼€å‘è„šæœ¬ï¼Œä¸ºç¤¾åŒºè´¡çŒ®è€…æä¾›äº†ä¸€ä¸ªä½é—¨æ§›çš„å¼€å‘ç¯å¢ƒï¼Œç¡®ä¿ä»»ä½•å¼€å‘è€…éƒ½èƒ½å¿«é€Ÿæ­å»ºç¯å¢ƒå¹¶éµå¾ªç»Ÿä¸€æ ‡å‡†è¿›è¡Œè´¡çŒ®ã€‚</p>
<ul>
<li><code>pnpm install</code>: å®‰è£…æ‰€æœ‰é¡¹ç›®ä¾èµ–ã€‚</li>
<li><code>pnpm dev</code>: å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼Œè¿›è¡Œå®æ—¶è°ƒè¯•ã€‚</li>
<li><code>pnpm type-check</code>: è¿è¡Œ TypeScript ç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚</li>
<li><code>pnpm build</code>: æ‰§è¡Œæ„å»ºæµç¨‹ï¼Œç”Ÿæˆæœ€ç»ˆçš„åˆ†å‘æ–‡ä»¶ã€‚</li>
<li><code>pnpm preview</code>: åœ¨æœ¬åœ°é¢„è§ˆæ„å»ºåçš„äº§ç‰©ã€‚</li>
</ul>
<h3 data-id="heading-17">6.2 ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ</h3>
<p><code>vue-pdf-interactor</code> é‡‡ç”¨äº†ä¸€å¥—è§„èŒƒåŒ–çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒå‘½ä»¤ï¼Œä¾‹å¦‚ <code>pnpm version:patch</code>ï¼ˆç”¨äºæ›´æ–° <code>package.json</code> å¹¶åˆ›å»ºç›¸åº”çš„ git æ ‡ç­¾ï¼‰å’Œ <code>pnpm release:patch</code>ã€‚è¿™å¥—æµç¨‹ç¡®ä¿äº†ï¼š</p>
<ul>
<li><strong>ç‰ˆæœ¬å·è§„èŒƒ</strong>: ä¸¥æ ¼éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰ï¼Œä½¿ç‰ˆæœ¬è¿­ä»£æ¸…æ™°å¯è¿½æº¯ã€‚</li>
<li><strong>å‘å¸ƒå¯é æ€§</strong>: å‘å¸ƒæµç¨‹ä¸­é›†æˆäº† <code>prepublishOnly</code> é’©å­ï¼Œå®ƒä¼šåœ¨å‘å¸ƒåˆ° npm å‰è‡ªåŠ¨æ‰§è¡Œæ„å»ºå’Œç±»å‹æ£€æŸ¥ã€‚è¿™ç¡®ä¿äº†åªæœ‰æˆåŠŸæ„å»ºä¸”é€šè¿‡ç±»å‹æ£€æŸ¥çš„ä»£ç æ‰èƒ½è¢«å‘å¸ƒï¼Œæ˜¯ä¿éšœå‘å¸ƒå¯é æ€§çš„å…³é”®æ”¯æŸ±ã€‚</li>
</ul>
<h3 data-id="heading-18">6.3 å¼€æºè®¸å¯è¯</h3>
<p>è¯¥é¡¹ç›®é‡‡ç”¨ <strong>MIT è®¸å¯è¯</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªå¯¹å•†ä¸šåº”ç”¨æä¸ºå‹å¥½çš„å®½æ¾å¼€æºåè®®ï¼Œå®ƒèµ‹äºˆäº†ä½¿ç”¨è€…æå¤§çš„è‡ªç”±ï¼ŒåŒ…æ‹¬è‡ªç”±åœ°ä¿®æ”¹ä»£ç ã€äºŒæ¬¡åˆ†å‘ä»¥åŠåœ¨å•†ä¸šäº§å“ä¸­ä½¿ç”¨ï¼Œè€Œæ— é¡»æ‹…å¿ƒå¤æ‚çš„è®¸å¯é™åˆ¶æˆ–è´¹ç”¨ã€‚é€‰æ‹© MIT è®¸å¯è¯ï¼Œæ¶ˆé™¤äº†ä¼ä¸šå’Œä¸ªäººå¼€å‘è€…åœ¨æŠ€æœ¯é€‰å‹æ—¶çš„åé¡¾ä¹‹å¿§ï¼Œé¼“åŠ±äº†æ›´å¹¿æ³›çš„åº”ç”¨å’Œç¤¾åŒºè´¡çŒ®ã€‚</p>
<h2 data-id="heading-19">7.0 ç»“è®º</h2>
<p><code>vue-pdf-interactor</code> ä¸ä»…ä»…æ˜¯å¯¹ç°æœ‰ PDF æŸ¥çœ‹æ–¹æ¡ˆçš„ç®€å•è¡¥å……ï¼Œå®ƒæ›´æ˜¯ä¸€ä¸ªåˆ›æ–°çš„è¿æ¥å™¨ï¼Œä¸€åº§è¿æ¥é™æ€æ–‡æ¡£ä¸–ç•Œä¸åŠ¨æ€ Web åº”ç”¨çš„æ¡¥æ¢ã€‚é€šè¿‡å…¶ç‹¬ç‰¹çš„è®¾è®¡ï¼Œå®ƒæˆåŠŸåœ°å°†åŸæœ¬åªè¯»çš„ PDF å†…å®¹è½¬åŒ–ä¸ºäº†å¯äº¤äº’ã€å¯ç¼–ç¨‹çš„æ•°æ®æºã€‚</p>
<p>ç»¼åˆæ¥çœ‹ï¼Œè¯¥ç»„ä»¶åº“çš„æ ¸å¿ƒä¼˜åŠ¿ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½åˆ›æ–°</strong>: ä»¥ OCR æ–‡æœ¬äº¤äº’ä¸ºæ ¸å¿ƒï¼Œè§£å†³äº†æ‰«æç‰ˆ PDF ç­‰â€œç¡¬éª¨å¤´â€çš„äº¤äº’éš¾é¢˜ã€‚</li>
<li><strong>æ¶æ„ç¨³å¥</strong>: ä¾æ‰˜äº <code>vue-pdf-embed</code> çš„åšå®åŸºç¡€ï¼Œå¹¶é€‰ç”¨ç°ä»£åŒ–ã€é«˜è´¨é‡çš„ä¾èµ–æ ˆï¼Œä¿è¯äº†å…¶ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚</li>
<li><strong>å¼€å‘è€…å‹å¥½</strong>: å®Œæ•´çš„ TypeScript æ”¯æŒã€æ ‡å‡†çš„å·¥ç¨‹åŒ–è„šæœ¬ä»¥åŠå®½æ¾çš„ MIT è®¸å¯è¯ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¯¹å¼€å‘è€…å’Œå•†ä¸šåº”ç”¨éƒ½æä¸ºå‹å¥½çš„ç”Ÿæ€ç³»ç»Ÿã€‚</li>
</ul>
<p>å±•æœ›æœªæ¥ï¼Œéšç€ Web åº”ç”¨å¯¹æ–‡æ¡£å¤„ç†èƒ½åŠ›çš„è¦æ±‚æ—¥ç›Šæé«˜ï¼Œ<code>vue-pdf-interactor</code> æœ‰æ½œåŠ›æˆä¸ºå„ç±»æ™ºèƒ½æ–‡æ¡£å¤„ç†ã€æ•°æ®æ ‡æ³¨å’Œåœ¨çº¿åä½œå¹³å°çš„å…³é”®åŸºç¡€è®¾æ–½ï¼ŒæŒç»­æ¨åŠ¨ Web æ–‡æ¡£äº¤äº’ä½“éªŒå‘å‰å‘å±•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7585789195868733476</link>    <guid>https://juejin.cn/post/7585789195868733476</guid>    <pubDate>2025-12-21T12:57:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585789195868733476" data-draft-id="7576369868418957348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T12:57:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:57:27.000Z" title="Sun Dec 21 2025 12:57:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¹‹å‰ä»‹ç»äº†å¾ˆå¤šå‰ç«¯è·¨é¡µé¢é€šè®¯çš„æ–¹æ¡ˆï¼Œä»Šå¤©ä»‹ç»ä¸‹Cookieï¼ŒCookieè‡ªèº«æœ‰â€œåŒæºå…±äº«â€çš„ç‰¹æ€§ï¼Œä½†å› ä¸ºç¼ºå°‘æ•°æ®å˜åŒ–çš„ä¸»åŠ¨é€šçŸ¥æœºåˆ¶ï¼Œåªèƒ½ä½¿ç”¨â€œè½®è¯¢â€å¼¥è¡¥è¿™ä¸€ç¼ºé™·ã€‚</p>
<p>æœ¬æ–‡å°†ä½¿ç”¨Cookieè½®è¯¢ï¼Œè¿›è¡Œè·¨é¡µé¢é€šè®¯ã€‚</p>
<h2 data-id="heading-1">1. Cookie è½®è¯¢åŸºæœ¬åŸç†</h2>
<p>Cookieè½®è¯¢é€šè¿‡â€œå­˜å‚¨-å®šæœŸæ£€æŸ¥-å·®å¼‚å¤„ç†â€çš„æ ¸å¿ƒé€»è¾‘å®ç°è·¨é¡µé¢é€šè®¯ï¼Œå…·ä½“æµç¨‹ä¸ºï¼š</p>
<ol>
<li>ä¸€ä¸ªé¡µé¢å°†æ¶ˆæ¯ï¼ˆå¦‚çŠ¶æ€ã€æŒ‡ä»¤ç­‰ï¼‰ç»“æ„åŒ–åå­˜å‚¨åˆ°Cookieä¸­ï¼›</li>
<li>å…¶ä»–åŒæºé¡µé¢é€šè¿‡å®šæ—¶ä»»åŠ¡å®šæœŸè¯»å–ç›®æ ‡Cookieï¼›</li>
<li>å¯¹æ¯”å½“å‰Cookieå€¼ä¸å†å²åŸºå‡†å€¼ï¼Œè‹¥å‘ç°å†…å®¹å˜åŒ–åˆ™è¯»å–å¹¶å¤„ç†æ¶ˆæ¯ï¼›</li>
<li>æ›´æ–°åŸºå‡†å€¼ï¼Œå®Œæˆä¸€æ¬¡è·¨é¡µé¢é€šè®¯é—­ç¯ã€‚</li>
</ol>
<p>éœ€ç‰¹åˆ«æ³¨æ„ï¼šCookieçš„<code>domain</code>å’Œ<code>path</code>é…ç½®æ˜¯è½®è¯¢ç”Ÿæ•ˆçš„å‰æâ€”â€”å†™å…¥æ–¹ä¸è½®è¯¢æ–¹éœ€é…ç½®ä¸€è‡´çš„ä½œç”¨åŸŸï¼ˆå¦‚æ ¹è·¯å¾„<code>/</code>ã€æ ¹åŸŸå<code>example.com</code>ï¼‰ï¼Œå¦åˆ™è½®è¯¢æ–¹æ— æ³•è¯»å–ç›®æ ‡Cookieï¼Œå¯¼è‡´é€šè®¯å¤±æ•ˆã€‚</p>
<h3 data-id="heading-2">2. æ¡ˆä¾‹ä»£ç </h3>
<h3 data-id="heading-3">2.1 Cookie è½®è¯¢å®Œæ•´å®ç°</h3>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è®¾ç½® Cookie
function setCookie(name, value, <span class="hljs-attr">days</span> = <span class="hljs-number">1</span>) {
    const <span class="hljs-attr">date</span> = new Date()<span class="hljs-comment">;</span>
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000))<span class="hljs-comment">;</span>
    const <span class="hljs-attr">expires</span> = &amp;<span class="hljs-comment">#34;expires=&amp;#34; + date.toUTCString();</span>
    <span class="hljs-attr">document.cookie</span> = name + &amp;<span class="hljs-comment">#34;=&amp;#34; + encodeURIComponent(value) + &amp;#34;;&amp;#34; + expires + &amp;#34;;path=/&amp;#34;;</span>
    updateCookieDisplay()<span class="hljs-comment">;</span>
}

// è·å– Cookie
function getCookie(name) {
    const <span class="hljs-attr">nameEQ</span> = name + &amp;<span class="hljs-comment">#34;=&amp;#34;;</span>
    const <span class="hljs-attr">ca</span> = document.cookie.split(<span class="hljs-string">';'</span>)<span class="hljs-comment">;</span>
    for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; ca.length; i++) {</span>
        let <span class="hljs-attr">c</span> = ca[i]<span class="hljs-comment">;</span>
        while (c.charAt(0) === ' ') <span class="hljs-attr">c</span> = c.substring(<span class="hljs-number">1</span>, c.length)<span class="hljs-comment">;</span>
        if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length))<span class="hljs-comment">;</span>
    }
    return null<span class="hljs-comment">;</span>
}

// åˆ é™¤ Cookie
function deleteCookie(name) {
    <span class="hljs-attr">document.cookie</span> = name + &amp;<span class="hljs-comment">#34;=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;&amp;#34;;</span>
    updateCookieDisplay()<span class="hljs-comment">;</span>
}

// å‘é€æ¶ˆæ¯ï¼ˆCookie æ–¹å¼ï¼‰
function sendMessageByCookie(content) {
    // ç¡®å®šé€šè®¯ç±»å‹
    let <span class="hljs-attr">communicationType</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
    if (isChild) {
        <span class="hljs-attr">communicationType</span> = <span class="hljs-string">'å­çˆ¶é€šè®¯'</span><span class="hljs-comment">;</span>
    } else {
        <span class="hljs-attr">communicationType</span> = <span class="hljs-string">'çˆ¶å­é€šè®¯'</span><span class="hljs-comment">;</span>
    }
    
    const <span class="hljs-attr">message</span> = {
        id: Date.now(),
        content: content,
        sender: clientId,
        timestamp: Date.now(),
        method: 'cookie',
        communicationType: communicationType
    }<span class="hljs-comment">;</span>
    
    const <span class="hljs-attr">cookieValue</span> = JSON.stringify(message)<span class="hljs-comment">;</span>
    setCookie(COOKIE_NAME, cookieValue)<span class="hljs-comment">;</span>
    addLog(`é€šè¿‡ Cookie å‘é€æ¶ˆæ¯: ${content}`, 'å‘é€', communicationType)<span class="hljs-comment">;</span>
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7699e133af4841c19ad68f2808ca6043~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766926647&amp;x-signature=RzCQYN68GokqSfgrKKVeO8mh0FM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">3.2 æ€»ç»“</h3>
<p>Cookieè½®è¯¢æ˜¯ä¸€ç§å…¼å®¹æ€§æå¼ºçš„è·¨é¡µé¢é€šè®¯æ–¹æ¡ˆï¼Œæ— éœ€ä¾èµ–ç°ä»£APIï¼Œå¯åœ¨è€æ—§æµè§ˆå™¨ä¸­ç¨³å®šè¿è¡Œã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿æ˜¯å®ç°ç®€å•ã€é…ç½®çµæ´»ï¼Œé€‚ç”¨äºä½é¢‘ç‡æ¶ˆæ¯åŒæ­¥åœºæ™¯ï¼ˆå¦‚ç™»å½•çŠ¶æ€ã€ç”¨æˆ·åå¥½è®¾ç½®ï¼‰ã€‚ä½¿ç”¨æ—¶éœ€é‡ç‚¹å…³æ³¨Cookieä½œç”¨åŸŸé…ç½®å’Œè½®è¯¢æ€§èƒ½å¹³è¡¡ï¼Œé€šè¿‡ç»“æ„åŒ–æ¶ˆæ¯è®¾è®¡å’Œå¼‚å¸¸å¤„ç†æå‡æ–¹æ¡ˆå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ]]></title>    <link>https://juejin.cn/post/7585743487258607625</link>    <guid>https://juejin.cn/post/7585743487258607625</guid>    <pubDate>2025-12-21T11:06:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487258607625" data-draft-id="7585534343562756146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-21T11:06:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:06:28.000Z" title="Sun Dec 21 2025 11:06:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šæœ¬æ–‡è¯¦è§£AIæµå¼å“åº”ä¸­æ–­æœºåˆ¶ï¼šå½“å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥ï¼ˆå¦‚å–æ¶ˆè¯·æ±‚æˆ–å…³é—­æµï¼‰ï¼ŒæœåŠ¡å™¨ä¼šç«‹å³åœæ­¢ç”Ÿæˆtokenï¼Œé¿å…èµ„æºæµªè´¹ã€‚ç»“åˆPythonç¤ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨å¤šçº¿ç¨‹ã€å¼‚æ­¥ç­‰åœºæ™¯ä¸‹ä¼˜é›…å®ç°ä¸­æ–­ï¼Œå¹¶æ¾„æ¸…å¸¸è§è¯¯åŒºã€‚</p>
<h2 data-id="heading-0"><strong>æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ</strong></h2>
<p>åœ¨AIæ¨¡å‹çš„æµå¼å“åº”ï¼ˆStreaming APIï¼‰è°ƒç”¨ä¸­ï¼Œç”¨æˆ·å¸¸å¸¸éœ€è¦åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ä¸»åŠ¨ä¸­æ–­å“åº”ã€‚ä¾‹å¦‚ï¼Œåœ¨èŠå¤©æœºå™¨äººä¸­ï¼Œç”¨æˆ·å¯èƒ½ç‚¹å‡»â€œåœæ­¢â€æŒ‰é’®ï¼Œæˆ–åœ¨ä»£ç ä¸­å‘ç°é”™è¯¯æ—¶éœ€è¦ç«‹å³ç»ˆæ­¢æµå¼è¾“å‡ºã€‚ç„¶è€Œï¼Œ<strong>æµå¼ä¸­æ–­æ˜¯å¦çœŸçš„èƒ½ç«‹å³åœæ­¢æœåŠ¡å™¨ç«¯çš„ç”Ÿæˆï¼Ÿä¸­æ–­ååå°æ˜¯å¦ä»åœ¨ç»§ç»­è®¡ç®—ï¼Ÿ</strong> è¿™æ˜¯å¼€å‘è€…åœ¨å®é™…åº”ç”¨ä¸­å¿…é¡»æ˜ç¡®çš„å…³é”®é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†ä»<strong>æŠ€æœ¯åŸç†</strong>ã€<strong>å®ç°æ–¹å¼</strong>å’Œ<strong>æœ€ä½³å®è·µ</strong>ä¸‰ä¸ªç»´åº¦ï¼Œæ·±å…¥è§£ææµå¼å“åº”ä¸­æ–­çš„æœºåˆ¶ï¼Œå¹¶æä¾›å¯è½åœ°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€æµå¼ä¸­æ–­çš„æœ¬è´¨ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„ååŒ</h3>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯æµå¼å“åº”ï¼Ÿ</h4>
<p>æµå¼å“åº”ï¼ˆStreaming APIï¼‰å…è®¸æœåŠ¡å™¨åœ¨æ¨¡å‹ç”Ÿæˆå†…å®¹çš„åŒæ—¶é€æ­¥è¿”å›ç»“æœï¼Œè€Œéç­‰å¾…å®Œæ•´è¾“å‡ºã€‚ä¾‹å¦‚ï¼ŒOpenAI çš„ <code>stream=True</code> å‚æ•°ä¼šé€šè¿‡ <strong>Server-Sent Events (SSE)</strong> åè®®ï¼Œå°†ç”Ÿæˆçš„ token åˆ†æ‰¹æ¬¡æ¨é€åˆ°å®¢æˆ·ç«¯ã€‚</p>
<h4 data-id="heading-3">1.2 ä¸­æ–­çš„è§¦å‘æœºåˆ¶</h4>
<p>å½“å®¢æˆ·ç«¯ä¸»åŠ¨ä¸­æ–­æµå¼è¯·æ±‚ï¼ˆå¦‚å…³é—­è¿æ¥ã€å–æ¶ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šæ£€æµ‹åˆ°è¿æ¥çŠ¶æ€çš„å˜åŒ–å¹¶<strong>ç«‹å³åœæ­¢ç”Ÿæˆ</strong>ã€‚OpenAI å®˜æ–¹æ–‡æ¡£æ˜ç¡®è¯´æ˜ï¼š</p>
<blockquote>
<p><em>"If the client disconnects from the stream before the response is complete, the server will stop generating tokens and close the connection."</em><br/>
ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fchat%2Fcreate%23chat-create-stream" target="_blank" title="https://platform.openai.com/docs/api-reference/chat/create#chat-create-stream" ref="nofollow noopener noreferrer">OpenAI API Docs</a>ï¼‰</p>
</blockquote>
<p>è¿™æ„å‘³ç€ï¼Œ<strong>ä¸­æ–­æ“ä½œä¼šåŒæ­¥å½±å“æœåŠ¡å™¨ç«¯çš„è®¡ç®—è¡Œä¸º</strong>ï¼Œè€Œéä»…åœ¨å®¢æˆ·ç«¯â€œå‡è£…â€åœæ­¢ã€‚</p>
<hr/>
<h3 data-id="heading-4">äºŒã€ä¸­æ–­åçš„è¡Œä¸ºéªŒè¯ï¼šä»£ç å®éªŒ</h3>
<h4 data-id="heading-5">2.1 Python ä¸­çš„æµå¼è°ƒç”¨</h4>
<p>ä»¥ OpenAI Python SDK ä¸ºä¾‹ï¼Œä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†ä¸­æ–­æµå¼å“åº”çš„è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> AsyncOpenAI
<span class="hljs-keyword">import</span> asyncio

client = AsyncOpenAI()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">stream_response</span>():
    stream = <span class="hljs-keyword">await</span> client.chat.completions.create(
        model=<span class="hljs-string">"gpt-4o-mini"</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·é‡å¤è¾“å‡º 'Hello' åæ¬¡"</span>}],
        stream=<span class="hljs-literal">True</span>
    )
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> stream:
        <span class="hljs-built_in">print</span>(chunk.choices[<span class="hljs-number">0</span>].delta.content, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-string">"Hello"</span> <span class="hljs-keyword">in</span> chunk.choices[<span class="hljs-number">0</span>].delta.content:
            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># æ‰‹åŠ¨ä¸­æ–­å¾ªç¯</span>

<span class="hljs-keyword">try</span>:
    asyncio.run(stream_response())
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸­æ–­å¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h5 data-id="heading-6">è¡Œä¸ºåˆ†æï¼š</h5>
<ul>
<li>å½“ <code>break</code> ä¸­æ–­å¾ªç¯åï¼Œåº•å±‚ HTTP è¿æ¥ä¼šè¢«å…³é—­ã€‚</li>
<li>OpenAI æœåŠ¡å™¨æ£€æµ‹åˆ°è¿æ¥æ–­å¼€ï¼Œç«‹å³åœæ­¢ç”Ÿæˆåç»­ tokenã€‚</li>
<li><strong>éªŒè¯æ–¹å¼</strong>ï¼šé€šè¿‡ç›‘æ§ API è°ƒç”¨çš„ token ä½¿ç”¨é‡ï¼Œè‹¥ä¸­æ–­åä¸å†è®¡è´¹ï¼Œåˆ™è¯æ˜ç”Ÿæˆå·²åœæ­¢ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-7">2.2 æµå¼ä¸­æ–­çš„åº•å±‚åŸç†</h4>
<p>æµå¼ä¸­æ–­ä¾èµ–äº <strong>HTTP åè®®çš„è¿æ¥çŠ¶æ€</strong>ï¼š</p>
<ol>
<li><strong>å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥</strong>ï¼šå‘é€ <code>FIN</code> åŒ…æˆ– <code>RST</code> åŒ…ã€‚</li>
<li><strong>æœåŠ¡å™¨ç«¯ç›‘å¬è¿æ¥çŠ¶æ€</strong>ï¼šæ£€æµ‹åˆ°è¿æ¥å…³é—­åï¼Œç»ˆæ­¢æ¨¡å‹æ¨ç†ä»»åŠ¡ã€‚</li>
<li><strong>èµ„æºé‡Šæ”¾</strong>ï¼šGPU/CPU è®¡ç®—èµ„æºè¢«å›æ”¶ï¼Œé¿å…æµªè´¹ã€‚</li>
</ol>
<p>è¿™ä¸€æœºåˆ¶åœ¨ OpenAI çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fgpt" target="_blank" title="https://platform.openai.com/docs/guides/gpt" ref="nofollow noopener noreferrer">æŠ€æœ¯ç™½çš®ä¹¦</a> ä¸­è¢«æè¿°ä¸º <strong>â€œæµå¼å“åº”çš„ä¼˜é›…ç»ˆæ­¢â€</strong> ã€‚</p>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€å®ç°æµå¼ä¸­æ–­çš„æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-9">3.1 Python ä¸­çš„å¼‚æ­¥ä¸­æ–­</h4>
<p>ä½¿ç”¨ <code>asyncio.Task</code> å¯å®‰å…¨å–æ¶ˆæµå¼ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> AsyncOpenAI

client = AsyncOpenAI()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">stream_task</span>():
    stream = <span class="hljs-keyword">await</span> client.chat.completions.create(
        model=<span class="hljs-string">"gpt-4o-mini"</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·ç”Ÿæˆä¸€æ®µé•¿æ–‡æœ¬"</span>}],
        stream=<span class="hljs-literal">True</span>
    )
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> stream:
        <span class="hljs-built_in">print</span>(chunk.choices[<span class="hljs-number">0</span>].delta.content, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿå¤„ç†å»¶è¿Ÿ</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    task = asyncio.create_task(stream_task())
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿç­‰å¾…2ç§’åä¸­æ–­</span>
    task.cancel()  <span class="hljs-comment"># å–æ¶ˆä»»åŠ¡</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">await</span> task
    <span class="hljs-keyword">except</span> asyncio.CancelledError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næµå¼ä»»åŠ¡å·²å–æ¶ˆ"</span>)

asyncio.run(main())
</code></pre>
<h5 data-id="heading-10">å…³é”®ç‚¹ï¼š</h5>
<ul>
<li><code>task.cancel()</code> ä¼šè§¦å‘ <code>CancelledError</code>ï¼Œç¡®ä¿èµ„æºé‡Šæ”¾ã€‚</li>
<li>éœ€åœ¨ <code>except</code> å—ä¸­å¤„ç†å¼‚å¸¸ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-11">3.2 å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„ä¸­æ–­ï¼ˆPythonï¼‰</h4>
<p>åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå¯ä½¿ç”¨ <code>threading.Event</code> åè°ƒä¸­æ–­é€»è¾‘ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import threading
import time
from openai import OpenAI

<span class="hljs-attr">client</span> = OpenAI()
<span class="hljs-attr">stop_event</span> = threading.Event()

def stream_worker():
    <span class="hljs-attr">stream</span> = client.chat.completions.create(
        <span class="hljs-attr">model</span>=<span class="hljs-string">"gpt-4o-mini"</span>,
        <span class="hljs-attr">messages</span>=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·ç”Ÿæˆä¸€æ®µé•¿æ–‡æœ¬"</span>}],
        <span class="hljs-attr">stream</span>=<span class="hljs-literal">True</span>
    )
    for chunk in stream:
        if stop_event.is_set():
            break
        print(chunk.choices<span class="hljs-section">[0]</span>.delta.content, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)

<span class="hljs-attr">thread</span> = threading.Thread(target=stream_worker)
thread.start()
time.sleep(3)  <span class="hljs-comment"># æ¨¡æ‹Ÿç­‰å¾…3ç§’åä¸­æ–­</span>
stop_event.set()  <span class="hljs-comment"># è®¾ç½®åœæ­¢ä¿¡å·</span>
thread.join()
</code></pre>
<h5 data-id="heading-12">ä¼˜åŠ¿ï¼š</h5>
<ul>
<li><code>Event</code> æä¾›çº¿ç¨‹å®‰å…¨çš„ä¸­æ–­æ ‡å¿—ã€‚</li>
<li>æ— éœ€ç›´æ¥æ“ä½œåº•å±‚è¿æ¥ï¼Œé€»è¾‘æ›´æ¸…æ™°ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13">å››ã€å¸¸è§è¯¯åŒºä¸è§£å†³æ–¹æ¡ˆ</h3>





















<table><thead><tr><th>è¯¯åŒº</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>ä¸­æ–­åæœåŠ¡å™¨ä»åœ¨ç”Ÿæˆ</strong></td><td>ç¡®ä¿å®¢æˆ·ç«¯æ­£ç¡®å…³é—­è¿æ¥ï¼ˆå¦‚ <code>resp.close()</code> æˆ– <code>controller.abort()</code>ï¼‰ã€‚</td></tr><tr><td><strong>ä¸­æ–­åæ— æ³•æ¢å¤</strong></td><td>æµå¼å“åº”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œéœ€é‡æ–°å‘èµ·è¯·æ±‚ã€‚</td></tr><tr><td><strong>å¤šçº¿ç¨‹ä¸­æ–­ä¸ç”Ÿæ•ˆ</strong></td><td>ä½¿ç”¨ <code>threading.Event</code> æˆ– <code>asyncio</code> åè°ƒçº¿ç¨‹/åç¨‹çŠ¶æ€ã€‚</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-14">äº”ã€æ€»ç»“</h3>
<p>æµå¼å“åº”çš„ä¸­æ–­æœºåˆ¶æ˜¯ AI åº”ç”¨å¼€å‘ä¸­çš„å…³é”®èƒ½åŠ›ã€‚é€šè¿‡å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼ŒæœåŠ¡å™¨ä¼šç«‹å³åœæ­¢ç”Ÿæˆ tokenï¼Œä»è€ŒèŠ‚çœè®¡ç®—èµ„æºå¹¶æå‡ç”¨æˆ·ä½“éªŒã€‚å¼€å‘è€…éœ€æ ¹æ®æ‰€é€‰è¯­è¨€/æ¡†æ¶ï¼ˆå¦‚ Pythonã€JavaScriptï¼‰é€‰æ‹©åˆé€‚çš„ä¸­æ–­å·¥å…·ï¼ˆå¦‚ <code>asyncio.Task</code>ã€<code>AbortController</code>ï¼‰ï¼Œå¹¶éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong>ï¼šä¸­æ–­åå…³é—­è¿æ¥ï¼Œé¿å…èµ„æºæ³„æ¼ã€‚</li>
<li><strong>å¤„ç†å¼‚å¸¸</strong>ï¼šæ•è·ä¸­æ–­å¼‚å¸¸ï¼Œç¡®ä¿ç¨‹åºå¥å£®æ€§ã€‚</li>
<li><strong>ç”¨æˆ·äº¤äº’å‹å¥½</strong>ï¼šä¸ºç”¨æˆ·æä¾›â€œåœæ­¢â€æŒ‰é’®ï¼Œå“åº”ç”¨æˆ·æ„å›¾ã€‚</li>
</ol>
<p>æŒæ¡è¿™äº›æŠ€æœ¯ï¼Œå°†å¸®åŠ©ä½ åœ¨æ„å»ºå®æ—¶ AI åº”ç”¨æ—¶ï¼Œå®ç°æ›´é«˜æ•ˆã€æ›´å¯é çš„æµå¼äº¤äº’ä½“éªŒã€‚</p>
<hr/>
</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7585534343562821682</link>    <guid>https://juejin.cn/post/7585534343562821682</guid>    <pubDate>2025-12-21T11:16:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562821682" data-draft-id="7585645111875846171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2025-12-21T11:16:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:16:10.000Z" title="Sun Dec 21 2025 11:16:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>GammaToLinearSpaceExactèŠ‚ç‚¹æ˜¯Unity URP Shader Graphä¸­ç”¨äºè‰²å½©ç©ºé—´è½¬æ¢çš„é‡è¦å·¥å…·ï¼Œä¸“é—¨å¤„ç†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„ç²¾ç¡®è½¬æ¢ã€‚åœ¨ç°ä»£å®æ—¶æ¸²æŸ“ç®¡çº¿ä¸­ï¼Œæ­£ç¡®çš„è‰²å½©ç©ºé—´ç®¡ç†å¯¹äºå®ç°ç‰©ç†å‡†ç¡®çš„æ¸²æŸ“æ•ˆæœè‡³å…³é‡è¦ã€‚</p>
<h2 data-id="heading-0">è‰²å½©ç©ºé—´åŸºç¡€æ¦‚å¿µ</h2>
<p>åœ¨æ·±å…¥äº†è§£GammaToLinearSpaceExactèŠ‚ç‚¹ä¹‹å‰ï¼Œéœ€è¦ç†è§£ä¼½é©¬ç©ºé—´å’Œçº¿æ€§ç©ºé—´çš„åŸºæœ¬æ¦‚å¿µã€‚ä¼½é©¬ç©ºé—´æ˜¯æŒ‡ç»è¿‡ä¼½é©¬æ ¡æ­£çš„éçº¿æ€§è‰²å½©ç©ºé—´ï¼Œè€Œçº¿æ€§ç©ºé—´åˆ™æ˜¯æœªç»æ ¡æ­£çš„ã€ä¸ç‰©ç†å…‰ç…§è®¡ç®—ç›¸åŒ¹é…çš„è‰²å½©ç©ºé—´ã€‚</p>
<h3 data-id="heading-1">ä¼½é©¬æ ¡æ­£çš„å†å²èƒŒæ™¯</h3>
<ul>
<li>ä¼½é©¬æ ¡æ­£æœ€åˆæ˜¯ä¸ºäº†è¡¥å¿CRTæ˜¾ç¤ºå™¨çš„éçº¿æ€§å“åº”ç‰¹æ€§è€Œå¼•å…¥çš„</li>
<li>äººç±»è§†è§‰ç³»ç»Ÿå¯¹æš—éƒ¨ç»†èŠ‚çš„æ„ŸçŸ¥æ›´ä¸ºæ•æ„Ÿï¼Œä¼½é©¬ç¼–ç å¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨æœ‰é™çš„å­˜å‚¨å¸¦å®½</li>
<li>ç°ä»£æ•°å­—å›¾åƒå’Œçº¹ç†é€šå¸¸é»˜è®¤å­˜å‚¨åœ¨ä¼½é©¬ç©ºé—´ä¸­</li>
</ul>
<h3 data-id="heading-2">çº¿æ€§ç©ºé—´çš„é‡è¦æ€§</h3>
<ul>
<li>ç‰©ç†å…‰ç…§è®¡ç®—åŸºäºçº¿æ€§å…³ç³»ï¼Œä½¿ç”¨çº¿æ€§ç©ºé—´å¯ä»¥ç¡®ä¿å…‰ç…§è®¡ç®—çš„å‡†ç¡®æ€§</li>
<li>çº¹ç†è¿‡æ»¤ã€æ··åˆå’ŒæŠ—é”¯é½¿åœ¨çº¿æ€§ç©ºé—´ä¸­è¡¨ç°æ›´åŠ æ­£ç¡®</li>
<li>ç°ä»£æ¸²æŸ“ç®¡çº¿æ™®éé‡‡ç”¨çº¿æ€§ç©ºé—´å·¥ä½œæµä»¥è·å¾—æ›´çœŸå®çš„æ¸²æŸ“ç»“æœ</li>
</ul>
<h2 data-id="heading-3">GammaToLinearSpaceExactèŠ‚ç‚¹æŠ€æœ¯ç»†èŠ‚</h2>
<p>GammaToLinearSpaceExactèŠ‚ç‚¹å®ç°äº†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„ç²¾ç¡®æ•°å­¦è½¬æ¢ï¼Œå…¶æ ¸å¿ƒç®—æ³•åŸºäºæ ‡å‡†çš„ä¼½é©¬è§£ç å‡½æ•°ã€‚</p>
<h3 data-id="heading-4">è½¬æ¢ç®—æ³•åŸç†</h3>
<p>è¯¥èŠ‚ç‚¹ä½¿ç”¨çš„è½¬æ¢å…¬å¼åŸºäºsRGBæ ‡å‡†çš„é€†ä¼½é©¬æ ¡æ­£ï¼š</p>
<pre><code class="hljs"/></pre>
<p>å¦‚æœè¾“å…¥å€¼ &lt;= 0.04045
çº¿æ€§å€¼ = è¾“å…¥å€¼ / 12.92
å¦åˆ™
çº¿æ€§å€¼ = ((è¾“å…¥å€¼ + 0.055) / 1.055)^2.4</p>
<pre><code class="hljs language-markdown" lang="markdown">è¿™ä¸ªç²¾ç¡®çš„è½¬æ¢å…¬å¼ç¡®ä¿äº†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„æ•°å­¦å‡†ç¡®æ€§ï¼Œä¸ç®€å•çš„å¹‚å‡½æ•°è¿‘ä¼¼ç›¸æ¯”ï¼Œåœ¨ä½äº®åº¦åŒºåŸŸæä¾›äº†æ›´é«˜çš„ç²¾åº¦ã€‚

<span class="hljs-section">### æ•°å€¼èŒƒå›´å¤„ç†</span>

GammaToLinearSpaceExactèŠ‚ç‚¹è®¾è®¡ç”¨äºå¤„ç†æ ‡å‡†åŒ–çš„æ•°å€¼èŒƒå›´ï¼š

<span class="hljs-bullet">-</span> è¾“å…¥å€¼é€šå¸¸åº”åœ¨[0,1]èŒƒå›´å†…ï¼Œä½†èŠ‚ç‚¹ä¹Ÿèƒ½å¤„ç†è¶…å‡ºæ­¤èŒƒå›´çš„å€¼
<span class="hljs-bullet">-</span> è¾“å‡ºå€¼ä¿æŒä¸è¾“å…¥ç›¸åŒçš„æ•°å€¼èŒƒå›´ï¼Œä½†åˆ†å¸ƒç‰¹æ€§å‘ç”Ÿäº†å˜åŒ–
<span class="hljs-bullet">-</span> å¯¹äºHDRï¼ˆé«˜åŠ¨æ€èŒƒå›´ï¼‰å†…å®¹ï¼ŒèŠ‚ç‚¹åŒæ ·é€‚ç”¨ï¼Œä½†éœ€è¦æ³¨æ„è‰²è°ƒæ˜ å°„çš„åç»­å¤„ç†

<span class="hljs-section">## ç«¯å£è¯¦ç»†è¯´æ˜</span>

![](<span class="hljs-link">https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/GammaToLinearSpaceExactNodeThumb.png</span>)

<span class="hljs-section">### è¾“å…¥ç«¯å£(In)</span>

è¾“å…¥ç«¯å£æ¥å—Floatç±»å‹çš„æ•°å€¼ï¼Œä»£è¡¨éœ€è¦è½¬æ¢çš„ä¼½é©¬ç©ºé—´æ•°å€¼ã€‚è¿™ä¸ªè¾“å…¥å¯ä»¥æ˜¯å•ä¸ªæ ‡é‡å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å‘é‡å½¢å¼çš„è‰²å½©å€¼ï¼ˆå½“è¿æ¥åˆ°è‰²å½©è¾“å‡ºæ—¶ï¼‰ã€‚

è¾“å…¥æ•°å€¼çš„ç‰¹æ€§ï¼š

<span class="hljs-bullet">-</span> é€šå¸¸æ¥è‡ªçº¹ç†é‡‡æ ·ã€å¸¸é‡å‚æ•°æˆ–å…¶ä»–Shader GraphèŠ‚ç‚¹çš„è¾“å‡º
<span class="hljs-bullet">-</span> å¦‚æœè¾“å…¥å·²ç»æ˜¯çº¿æ€§ç©ºé—´çš„æ•°å€¼ï¼Œä½¿ç”¨æ­¤èŠ‚ç‚¹ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„æ¸²æŸ“ç»“æœ
<span class="hljs-bullet">-</span> æ”¯æŒåŠ¨æ€è¾“å…¥ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®ä¸åŒçš„æ¡ä»¶æ”¹å˜è¾“å…¥æº

<span class="hljs-section">### è¾“å‡ºç«¯å£(Out)</span>

è¾“å‡ºç«¯å£æä¾›è½¬æ¢åçš„çº¿æ€§ç©ºé—´æ•°å€¼ï¼Œç±»å‹åŒæ ·ä¸ºFloatã€‚è¿™ä¸ªè¾“å‡ºå¯ä»¥ç›´æ¥ç”¨äºåç»­çš„å…‰ç…§è®¡ç®—ã€æè´¨å±æ€§å®šä¹‰æˆ–å…¶ä»–éœ€è¦çº¿æ€§ç©ºé—´æ•°æ®çš„æ“ä½œã€‚

è¾“å‡ºæ•°å€¼çš„ç‰¹æ€§ï¼š

<span class="hljs-bullet">-</span> ä¿æŒäº†è¾“å…¥æ•°å€¼çš„ç›¸å¯¹äº®åº¦å…³ç³»ï¼Œä½†æ•°å€¼åˆ†å¸ƒå‘ç”Ÿäº†å˜åŒ–
<span class="hljs-bullet">-</span> æš—éƒ¨åŒºåŸŸçš„æ•°å€¼è¢«æ‰©å±•ï¼Œäº®éƒ¨åŒºåŸŸçš„æ•°å€¼è¢«å‹ç¼©
<span class="hljs-bullet">-</span> è¾“å‡ºå¯ä»¥ç›´æ¥ç”¨äºç‰©ç†å…‰ç…§è®¡ç®—ï¼Œå¦‚æ¼«åå°„ã€é«˜å…‰åå°„ç­‰

<span class="hljs-section">## å®é™…åº”ç”¨åœºæ™¯</span>

GammaToLinearSpaceExactèŠ‚ç‚¹åœ¨URP Shader Graphä¸­æœ‰å¤šç§é‡è¦åº”ç”¨åœºæ™¯ï¼Œæ­£ç¡®ä½¿ç”¨è¯¥èŠ‚ç‚¹å¯ä»¥æ˜¾è‘—æå‡æ¸²æŸ“è´¨é‡ã€‚

<span class="hljs-section">### çº¹ç†è‰²å½©æ ¡æ­£</span>

å½“ä½¿ç”¨å­˜å‚¨åœ¨ä¼½é©¬ç©ºé—´ä¸­çš„çº¹ç†æ—¶ï¼Œå¿…é¡»å°†å…¶è½¬æ¢åˆ°çº¿æ€§ç©ºé—´æ‰èƒ½è¿›è¡Œæ­£ç¡®çš„å…‰ç…§è®¡ç®—ã€‚

åº”ç”¨ç¤ºä¾‹æ­¥éª¤ï¼š

<span class="hljs-bullet">-</span> ä»çº¹ç†é‡‡æ ·èŠ‚ç‚¹è·å–é¢œè‰²å€¼
<span class="hljs-bullet">-</span> å°†é‡‡æ ·ç»“æœè¿æ¥åˆ°GammaToLinearSpaceExactèŠ‚ç‚¹çš„è¾“å…¥
<span class="hljs-bullet">-</span> ä½¿ç”¨è½¬æ¢åçš„çº¿æ€§é¢œè‰²å€¼è¿›è¡Œå…‰ç…§è®¡ç®—
<span class="hljs-bullet">-</span> åœ¨æœ€ç»ˆè¾“å‡ºå‰ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨LinearToGammaSpaceExactèŠ‚ç‚¹è½¬æ¢å›ä¼½é©¬ç©ºé—´ç”¨äºæ˜¾ç¤º

è¿™ç§å·¥ä½œæµç¨‹ç¡®ä¿äº†çº¹ç†é¢œè‰²åœ¨å…‰ç…§è®¡ç®—ä¸­çš„ç‰©ç†å‡†ç¡®æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ¼«åå°„è´´å›¾ã€è‡ªå‘å…‰è´´å›¾ç­‰å½±å“åœºæ™¯å…‰ç…§çš„çº¹ç†æ—¶å°¤ä¸ºé‡è¦ã€‚

<span class="hljs-section">### ç‰©ç†å…‰ç…§è®¡ç®—</span>

æ‰€æœ‰åŸºäºç‰©ç†çš„æ¸²æŸ“è®¡ç®—éƒ½åº”åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹åœ¨æ­¤è¿‡ç¨‹ä¸­æ‰®æ¼”å…³é”®è§’è‰²ã€‚

å…‰ç…§è®¡ç®—åº”ç”¨ï¼š

<span class="hljs-bullet">-</span> å°†è¾“å…¥çš„ç¯å…‰é¢œè‰²ä»ä¼½é©¬ç©ºé—´è½¬æ¢åˆ°çº¿æ€§ç©ºé—´
<span class="hljs-bullet">-</span> å¤„ç†ç¯å¢ƒå…‰ç…§å’Œåå°„æ¢é’ˆæ•°æ®
<span class="hljs-bullet">-</span> è®¡ç®—æ¼«åå°„å’Œé«˜å…‰åå°„æ—¶ç¡®ä¿é¢œè‰²å€¼çš„çº¿æ€§ç‰¹æ€§

é€šè¿‡åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œå…‰ç…§è®¡ç®—ï¼Œå¯ä»¥é¿å…ä¼½é©¬ç©ºé—´ä¸­çš„éçº¿æ€§å åŠ å¯¼è‡´çš„å…‰ç…§è¿‡äº®æˆ–è¿‡æš—é—®é¢˜ï¼Œå®ç°æ›´åŠ è‡ªç„¶çš„æ˜æš—è¿‡æ¸¡å’Œè‰²å½©æ··åˆã€‚

<span class="hljs-section">### åæœŸå¤„ç†æ•ˆæœ</span>

åœ¨å®ç°å±å¹•åå¤„ç†æ•ˆæœæ—¶ï¼Œæ­£ç¡®ç®¡ç†è‰²å½©ç©ºé—´å¯¹äºä¿æŒæ•ˆæœçš„ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚

åæœŸå¤„ç†ä¸­çš„åº”ç”¨ï¼š

<span class="hljs-bullet">-</span> è‰²å½©åˆ†çº§å’Œè‰²è°ƒæ˜ å°„
<span class="hljs-bullet">-</span> æ³›å…‰å’Œç»½æ”¾æ•ˆæœ
<span class="hljs-bullet">-</span> è‰²å½©æ ¡æ­£å’Œæ»¤é•œæ•ˆæœ

åœ¨è¿™äº›åº”ç”¨ä¸­ï¼Œéœ€è¦å…ˆå°†è¾“å…¥å›¾åƒä»ä¼½é©¬ç©ºé—´è½¬æ¢åˆ°çº¿æ€§ç©ºé—´è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæˆåå†è½¬æ¢å›ä¼½é©¬ç©ºé—´ç”¨äºæ˜¾ç¤ºï¼Œç¡®ä¿å¤„ç†è¿‡ç¨‹ä¸­çš„è‰²å½©æ“ä½œç¬¦åˆçº¿æ€§å…³ç³»ã€‚

<span class="hljs-section">## ä¸å…¶ä»–è‰²å½©ç©ºé—´èŠ‚ç‚¹çš„å¯¹æ¯”</span>

Unity Shader Graphæä¾›äº†å¤šä¸ªä¸è‰²å½©ç©ºé—´ç›¸å…³çš„èŠ‚ç‚¹ï¼Œäº†è§£å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å¯¹äºæ­£ç¡®é€‰æ‹©å’Œä½¿ç”¨è‡³å…³é‡è¦ã€‚

<span class="hljs-section">### GammaToLinearSpaceExactä¸GammaToLinearSpace</span>

GammaToLinearSpaceèŠ‚ç‚¹æä¾›äº†ç±»ä¼¼çš„ä¼½é©¬åˆ°çº¿æ€§è½¬æ¢åŠŸèƒ½ï¼Œä½†ä½¿ç”¨çš„æ˜¯è¿‘ä¼¼ç®—æ³•ï¼š
</code></pre>
<p>çº¿æ€§å€¼ â‰ˆ è¾“å…¥å€¼^2.2</p>
<pre><code class="hljs language-markdown" lang="markdown">å¯¹æ¯”åˆ†æï¼š

<span class="hljs-bullet">-</span> GammaToLinearSpaceExactä½¿ç”¨ç²¾ç¡®çš„sRGBæ ‡å‡†è½¬æ¢ï¼Œåœ¨ä½äº®åº¦åŒºåŸŸæ›´åŠ å‡†ç¡®
<span class="hljs-bullet">-</span> GammaToLinearSpaceä½¿ç”¨ç®€åŒ–è¿‘ä¼¼ï¼Œè®¡ç®—æ•ˆç‡æ›´é«˜ä½†ç²¾åº¦ç¨ä½
<span class="hljs-bullet">-</span> åœ¨éœ€è¦æœ€é«˜è§†è§‰è´¨é‡çš„åœºåˆæ¨èä½¿ç”¨Exactç‰ˆæœ¬ï¼Œåœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿‘ä¼¼ç‰ˆæœ¬

<span class="hljs-section">### ä¸LinearToGammaSpaceExactçš„å…³ç³»</span>

LinearToGammaSpaceExactèŠ‚ç‚¹æ‰§è¡Œç›¸åçš„è½¬æ¢è¿‡ç¨‹ï¼Œå°†çº¿æ€§ç©ºé—´å€¼è½¬æ¢å›ä¼½é©¬ç©ºé—´ã€‚

è½¬æ¢å…³ç³»å¯¹åº”ï¼š

<span class="hljs-bullet">-</span> GammaToLinearSpaceExactå’ŒLinearToGammaSpaceExactæ˜¯äº’é€†æ“ä½œ
<span class="hljs-bullet">-</span> åœ¨æ¸²æŸ“ç®¡çº¿çš„å¼€å§‹é˜¶æ®µä½¿ç”¨GammaToLinearSpaceExactï¼Œåœ¨æœ€ç»ˆè¾“å‡ºå‰ä½¿ç”¨LinearToGammaSpaceExact
<span class="hljs-bullet">-</span> è¿™ç§é…å¯¹ä½¿ç”¨ç¡®ä¿äº†æ•´ä¸ªæ¸²æŸ“æµç¨‹çš„è‰²å½©ç©ºé—´ä¸€è‡´æ€§

<span class="hljs-section">## æ€§èƒ½è€ƒé‡ä¸æœ€ä½³å®è·µ</span>

è™½ç„¶GammaToLinearSpaceExactèŠ‚ç‚¹çš„è®¡ç®—å¼€é”€ç›¸å¯¹è¾ƒå°ï¼Œä½†åœ¨å¤§è§„æ¨¡ä½¿ç”¨æ—¶ä»éœ€è€ƒè™‘æ€§èƒ½å½±å“ã€‚

<span class="hljs-section">### æ€§èƒ½ä¼˜åŒ–å»ºè®®</span>

åˆç†ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹å¯ä»¥å¹³è¡¡è§†è§‰è´¨é‡å’Œæ¸²æŸ“æ€§èƒ½ï¼š

<span class="hljs-bullet">-</span> å¯¹äºå·²ç»åœ¨çº¿æ€§ç©ºé—´ä¸­çš„çº¹ç†ï¼ˆå¦‚HDRiç¯å¢ƒè´´å›¾ï¼‰ï¼Œä¸éœ€è¦ä½¿ç”¨æ­¤èŠ‚ç‚¹
<span class="hljs-bullet">-</span> åœ¨ä¸éœ€è¦æœ€é«˜ç²¾åº¦çš„åœºåˆï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨GammaToLinearSpaceè¿‘ä¼¼èŠ‚ç‚¹
<span class="hljs-bullet">-</span> é¿å…åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­é‡å¤æ‰§è¡Œç›¸åŒçš„è½¬æ¢ï¼Œå°½å¯èƒ½åœ¨é¡¶ç‚¹ç€è‰²å™¨æˆ–é¢„å¤„ç†é˜¶æ®µå®Œæˆ
<span class="hljs-bullet">-</span> åˆ©ç”¨Unityçš„çº¹ç†å¯¼å…¥è®¾ç½®ï¼Œç›´æ¥å°†çº¹ç†æ ‡è®°ä¸ºçº¿æ€§ç©ºé—´ï¼Œé¿å…è¿è¡Œæ—¶è½¬æ¢

<span class="hljs-section">### å¸¸è§é”™è¯¯ä¸è°ƒè¯•</span>

ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹æ—¶å¸¸è§çš„é”™è¯¯å’Œè°ƒè¯•æ–¹æ³•ï¼š

è‰²å½©è¿‡æš—æˆ–è¿‡äº®é—®é¢˜ï¼š

<span class="hljs-bullet">-</span> æ£€æŸ¥æ˜¯å¦é‡å¤åº”ç”¨äº†ä¼½é©¬æ ¡æ­£
<span class="hljs-bullet">-</span> ç¡®è®¤è¾“å…¥çº¹ç†çš„æ­£ç¡®çš„è‰²å½©ç©ºé—´è®¾ç½®
<span class="hljs-bullet">-</span> éªŒè¯æ•´ä¸ªæ¸²æŸ“ç®¡çº¿ä¸­è‰²å½©ç©ºé—´è½¬æ¢çš„ä¸€è‡´æ€§

æ€§èƒ½é—®é¢˜è¯Šæ–­ï¼š

<span class="hljs-bullet">-</span> ä½¿ç”¨Unityçš„Frame Debuggeråˆ†æç€è‰²å™¨æ‰§è¡Œå¼€é”€
<span class="hljs-bullet">-</span> æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡å¤è½¬æ¢æ“ä½œ
<span class="hljs-bullet">-</span> è¯„ä¼°ä½¿ç”¨çº¹ç†å¯¼å…¥æ—¶é¢„è½¬æ¢çš„å¯è¡Œæ€§

<span class="hljs-section">## å®Œæ•´ç¤ºä¾‹ï¼šå®ç°ç‰©ç†å‡†ç¡®çš„æ¼«åå°„ç€è‰²</span>

ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹å±•ç¤ºGammaToLinearSpaceExactèŠ‚ç‚¹åœ¨å®é™…ç€è‰²å™¨ä¸­çš„åº”ç”¨ã€‚

<span class="hljs-section">### åœºæ™¯è®¾ç½®</span>

åˆ›å»ºä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼ŒåŒ…å«ï¼š

<span class="hljs-bullet">-</span> ä¸€ä¸ªå®šå‘å…‰æº
<span class="hljs-bullet">-</span> å‡ ä¸ªå…·æœ‰ä¸åŒé¢œè‰²çš„ç‰©ä½“
<span class="hljs-bullet">-</span> ä½¿ç”¨æ ‡å‡†URPæ¸²æŸ“ç®¡çº¿

<span class="hljs-section">### ç€è‰²å™¨å›¾æ„å»º</span>

æ„å»ºä¸€ä¸ªä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹çš„åŸºæœ¬æ¼«åå°„ç€è‰²å™¨ï¼š

èŠ‚ç‚¹è¿æ¥æµç¨‹ï¼š

<span class="hljs-bullet">-</span> ä½¿ç”¨Texture2DèŠ‚ç‚¹é‡‡æ ·æ¼«åå°„è´´å›¾
<span class="hljs-bullet">-</span> å°†é‡‡æ ·ç»“æœè¿æ¥åˆ°GammaToLinearSpaceExactèŠ‚ç‚¹çš„è¾“å…¥
<span class="hljs-bullet">-</span> å°†è½¬æ¢åçš„çº¿æ€§é¢œè‰²è¿æ¥åˆ°URP LitèŠ‚ç‚¹çš„Base Colorè¾“å…¥
<span class="hljs-bullet">-</span> é…ç½®é€‚å½“çš„å…‰ç…§å’Œæè´¨å‚æ•°

<span class="hljs-section">### å¯¹æ¯”æµ‹è¯•</span>

åˆ›å»ºä¸¤ä¸ªç‰ˆæœ¬çš„ç€è‰²å™¨è¿›è¡Œå¯¹æ¯”ï¼š

<span class="hljs-bullet">-</span> ç‰ˆæœ¬Aï¼šæ­£ç¡®ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹
<span class="hljs-bullet">-</span> ç‰ˆæœ¬Bï¼šç›´æ¥ä½¿ç”¨ä¼½é©¬ç©ºé—´çš„çº¹ç†é¢œè‰²

è§‚å¯Ÿä¸¤ä¸ªç‰ˆæœ¬åœ¨ç›¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„è¡¨ç°å·®å¼‚ï¼š

<span class="hljs-bullet">-</span> ç‰ˆæœ¬Aæä¾›æ›´åŠ çœŸå®çš„å…‰ç…§å“åº”å’Œé¢œè‰²é¥±å’Œåº¦
<span class="hljs-bullet">-</span> ç‰ˆæœ¬Bå¯èƒ½å‡ºç°ä¸æ­£ç¡®çš„äº®åº¦ç§¯ç´¯å’Œè‰²å½©åç§»
<span class="hljs-bullet">-</span> åœ¨é«˜å…‰åŒºåŸŸå’Œé˜´å½±è¿‡æ¸¡åŒºåŸŸï¼Œç‰ˆæœ¬Açš„è¡¨ç°æ›´åŠ è‡ªç„¶

<span class="hljs-section">## é«˜çº§åº”ç”¨æŠ€å·§</span>

é™¤äº†åŸºæœ¬ç”¨æ³•ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹è¿˜å¯ä»¥ä¸å…¶ä»–Shader GraphåŠŸèƒ½ç»“åˆï¼Œå®ç°æ›´å¤æ‚çš„æ•ˆæœã€‚

<span class="hljs-section">### ä¸è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹ç»“åˆ</span>

åœ¨å®ç°è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹æ—¶ï¼Œæ­£ç¡®ç®¡ç†è‰²å½©ç©ºé—´è‡³å…³é‡è¦ï¼š

å®ç°æ­¥éª¤ï¼š

<span class="hljs-bullet">-</span> å°†æ‰€æœ‰è¾“å…¥çš„é¢œè‰²æ•°æ®è½¬æ¢åˆ°çº¿æ€§ç©ºé—´
<span class="hljs-bullet">-</span> åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œå…‰ç…§è®¡ç®—
<span class="hljs-bullet">-</span> å°†æœ€ç»ˆç»“æœè½¬æ¢å›ä¼½é©¬ç©ºé—´è¾“å‡º
<span class="hljs-bullet">-</span> ç¡®ä¿æ‰€æœ‰ä¸­é—´è®¡ç®—ä¿æŒçº¿æ€§å…³ç³»

è¿™ç§æ–¹æ³•ç¡®ä¿äº†è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹ä¸URPå†…ç½®å…‰ç…§çš„ä¸€è‡´æ€§ï¼Œé¿å…äº†å› è‰²å½©ç©ºé—´ä¸åŒ¹é…å¯¼è‡´çš„è§†è§‰å¼‚å¸¸ã€‚

<span class="hljs-section">### HDRå†…å®¹å¤„ç†</span>

å¤„ç†é«˜åŠ¨æ€èŒƒå›´å†…å®¹æ—¶ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹çš„ä½¿ç”¨éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š

HDRå·¥ä½œæµè€ƒè™‘ï¼š

<span class="hljs-bullet">-</span> HDRçº¹ç†é€šå¸¸å·²ç»åœ¨çº¿æ€§ç©ºé—´ä¸­ï¼Œä¸éœ€è¦é¢å¤–è½¬æ¢
<span class="hljs-bullet">-</span> å½“æ··åˆLDRå’ŒHDRå†…å®¹æ—¶ï¼Œéœ€è¦ç¡®ä¿ç»Ÿä¸€çš„è‰²å½©ç©ºé—´
<span class="hljs-bullet">-</span> åœ¨è‰²è°ƒæ˜ å°„é˜¶æ®µå‰ï¼Œæ‰€æœ‰è®¡ç®—åº”åœ¨çº¿æ€§ç©ºé—´ä¸­è¿›è¡Œ

é€šè¿‡æ­£ç¡®åº”ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹ï¼Œå¯ä»¥ç¡®ä¿HDRå’ŒLDRå†…å®¹çš„æ— ç¼èåˆï¼Œå®ç°æ›´é«˜å“è´¨çš„è§†è§‰è¡¨ç°ã€‚

<span class="hljs-section">## å¹³å°å…¼å®¹æ€§è¯´æ˜</span>

GammaToLinearSpaceExactèŠ‚ç‚¹åœ¨ä¸åŒå¹³å°å’Œæ¸²æŸ“APIä¸Šçš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ï¼Œä½†ä»æœ‰å°‘é‡æ³¨æ„äº‹é¡¹ã€‚

<span class="hljs-section">### ç§»åŠ¨å¹³å°ä¼˜åŒ–</span>

åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹æ—¶ï¼š

<span class="hljs-bullet">-</span> å¤§éƒ¨åˆ†ç°ä»£ç§»åŠ¨GPUèƒ½å¤Ÿé«˜æ•ˆå¤„ç†sRGBè½¬æ¢
<span class="hljs-bullet">-</span> åœ¨æ€§èƒ½è¾ƒä½çš„è®¾å¤‡ä¸Šï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿‘ä¼¼ç‰ˆæœ¬
<span class="hljs-bullet">-</span> åˆ©ç”¨ç§»åŠ¨å¹³å°çš„sRGBçº¹ç†æ ¼å¼ï¼Œå¯ä»¥å‡å°‘æ˜¾å¼è½¬æ¢çš„éœ€è¦

<span class="hljs-section">### ä¸åŒå›¾å½¢APIçš„è¡¨ç°</span>

åœ¨å„ç§å›¾å½¢APIä¸­ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹çš„è¡Œä¸ºï¼š

<span class="hljs-bullet">-</span> åœ¨æ”¯æŒsRGBå¸§ç¼“å†²çš„APIä¸Šï¼ˆå¦‚OpenGL ES 3.0+ï¼ŒMetalï¼ŒVulkanï¼‰ï¼ŒUnityä¼šè‡ªåŠ¨å¤„ç†å¸§ç¼“å†²çš„ä¼½é©¬æ ¡æ­£
<span class="hljs-bullet">-</span> åœ¨æ—§ç‰ˆAPIä¸Šï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨ç®¡ç†æœ€ç»ˆçš„è‰²å½©ç©ºé—´è½¬æ¢
<span class="hljs-bullet">-</span> èŠ‚ç‚¹æœ¬èº«çš„æ•°å­¦è®¡ç®—åœ¨æ‰€æœ‰APIä¸Šä¿æŒä¸€è‡´

äº†è§£è¿™äº›å¹³å°ç‰¹æ€§æœ‰åŠ©äºç¼–å†™è·¨å¹³å°å…¼å®¹çš„ç€è‰²å™¨ï¼Œç¡®ä¿åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„ä¸€è‡´è§†è§‰è¡¨ç°ã€‚

<span class="hljs-section">## æ€»ç»“</span>

GammaToLinearSpaceExactèŠ‚ç‚¹æ˜¯Unity URP Shader Graphä¸­å®ç°ç‰©ç†å‡†ç¡®æ¸²æŸ“çš„å…³é”®ç»„ä»¶ã€‚é€šè¿‡æ­£ç¡®ç†è§£å’Œä½¿ç”¨è¯¥èŠ‚ç‚¹ï¼Œå¼€å‘è€…å¯ä»¥ï¼š

<span class="hljs-bullet">-</span> ç¡®ä¿çº¹ç†å’Œé¢œè‰²æ•°æ®åœ¨å…‰ç…§è®¡ç®—ä¸­çš„ç‰©ç†å‡†ç¡®æ€§
<span class="hljs-bullet">-</span> å®ç°æ›´åŠ çœŸå®å’Œä¸€è‡´çš„è§†è§‰è¡¨ç°
<span class="hljs-bullet">-</span> é¿å…å¸¸è§çš„è‰²å½©ç©ºé—´ç›¸å…³æ¸²æŸ“é—®é¢˜
<span class="hljs-bullet">-</span> æ„å»ºé«˜è´¨é‡ã€è·¨å¹³å°å…¼å®¹çš„ç€è‰²å™¨æ•ˆæœ

---
<span class="hljs-quote">&gt; [<span class="hljs-string">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</span>](<span class="hljs-link">https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link</span>)<span class="hljs-strong">**ä¸“æ -ç›´è¾¾**</span></span>
ï¼ˆæ¬¢è¿<span class="hljs-emphasis">*ç‚¹èµç•™è¨€*</span>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨]]></title>    <link>https://juejin.cn/post/7585758163435438086</link>    <guid>https://juejin.cn/post/7585758163435438086</guid>    <pubDate>2025-12-21T11:31:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435438086" data-draft-id="7585758163435421702" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T11:31:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®è›‹å°ç²¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®è›‹å°ç²¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:31:55.000Z" title="Sun Dec 21 2025 11:31:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è·¯å¾„å‚æ•°æ˜¯ URL ä¸­ä»¥ <code>$</code> å¼€å¤´çš„å˜é‡ï¼Œç”¨äºæ•è·åŠ¨æ€å†…å®¹ã€‚</p>









































<table><thead><tr><th><strong>åŠŸèƒ½</strong></th><th><strong>è¯­æ³•ç¤ºä¾‹</strong></th><th><strong>URL åŒ¹é…ç¤ºä¾‹</strong></th><th><strong>æ•è·åˆ°çš„å˜é‡</strong></th></tr></thead><tbody><tr><td><strong>æ ‡å‡†å‚æ•°</strong></td><td><code>$postId</code></td><td><code>/posts/123</code></td><td><code>{ postId: '123' }</code></td></tr><tr><td><strong>å¸¦å‰ç¼€</strong></td><td><code>post-{$id}</code></td><td><code>/posts/post-abc</code></td><td><code>{ id: 'abc' }</code></td></tr><tr><td><strong>å¸¦åç¼€</strong></td><td><code>{$name}.pdf</code></td><td><code>/files/cv.pdf</code></td><td><code>{ name: 'cv' }</code></td></tr><tr><td><strong>é€šé…ç¬¦ (Splat)</strong></td><td><code>$</code></td><td><code>/files/a/b/c.txt</code></td><td><code>{ _splat: 'a/b/c.txt' }</code></td></tr><tr><td><strong>å¯é€‰å‚æ•°</strong></td><td><code>{-$lang}</code></td><td><code>/about</code> æˆ– <code>/en/about</code></td><td><code>{ lang: undefined }</code> æˆ– <code>'en'</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-0">è¯¦ç»†åŠŸèƒ½è§£æ</h3>
<h4 data-id="heading-1">1. åŸºç¡€ç”¨æ³• (Standard Usage)</h4>
<p>åœ¨æ–‡ä»¶è·¯ç”±ä¸­ï¼Œæ–‡ä»¶åå³è·¯å¾„ã€‚ä½¿ç”¨ <code>$</code> å£°æ˜å˜é‡ã€‚</p>
<ul>
<li>
<p><strong>è·å–å‚æ•°</strong>ï¼š</p>
<ul>
<li>
<p>åœ¨ <strong>Loader</strong> ä¸­ï¼šé€šè¿‡å‚æ•°å¯¹è±¡ <code>params</code> è®¿é—®ã€‚</p>
</li>
<li>
<p>åœ¨ <strong>ç»„ä»¶</strong> ä¸­ï¼šä½¿ç”¨ <code>Route.useParams()</code> é’©å­ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ä»£ç åˆ†å‰²æŠ€å·§</strong>ï¼šå¦‚æœç»„ä»¶æ˜¯å•ç‹¬å®šä¹‰çš„ï¼Œå¯ç”¨ <code>getRouteApi('/path').useParams()</code> æ¥ä¿æŒç±»å‹å®‰å…¨ã€‚</p>
</li>
</ul>
<h4 data-id="heading-2">2. å‰ç¼€ä¸åç¼€ (Prefixes and Suffixes)</h4>
<p>è¿™æ˜¯ TanStack Router çš„ä¸€å¤§ç‰¹è‰²ï¼Œå…è®¸ä½ åœ¨åŠ¨æ€éƒ¨åˆ†å‰åæ·»åŠ å›ºå®šæ–‡æœ¬ã€‚</p>
<ul>
<li>
<p><strong>è¯­æ³•</strong>ï¼šç”¨èŠ±æ‹¬å· <code>{}</code> åŒ…è£¹å˜é‡åã€‚</p>
</li>
<li>
<p><strong>åœºæ™¯</strong>ï¼šæ¯”å¦‚æ–‡ä»¶ååŒ¹é… <code>{$id}.json</code>ï¼Œæˆ–è€…å¸¦ç‰¹å®šæ ‡è¯†çš„ ID <code>user-{$userId}</code>ã€‚</p>
</li>
<li>
<p><strong>é€šé…ç¬¦ç»„åˆ</strong>ï¼šä½ ç”šè‡³å¯ä»¥å†™ <code>storage-{$}/$</code> æ¥åŒ¹é…æå…¶å¤æ‚çš„è·¯å¾„ç»“æ„ã€‚</p>
</li>
</ul>
<h4 data-id="heading-3">3. å¯é€‰è·¯å¾„å‚æ•° (Optional Path Parameters) âœ¨ <strong>é‡ç‚¹</strong></h4>
<p>ä½¿ç”¨ <code>{-$variable}</code> è¯­æ³•ã€‚è¿™æ„å‘³ç€è¯¥æ®µè·¯å¾„<strong>å¯ä»¥å­˜åœ¨ä¹Ÿå¯ä»¥ä¸å­˜åœ¨</strong>ã€‚</p>
<ul>
<li>
<p><strong>åŒ¹é…é€»è¾‘</strong>ï¼š<code>/posts/{-$category}</code> æ—¢èƒ½åŒ¹é… <code>/posts</code>ï¼ˆå‚æ•°ä¸º <code>undefined</code>ï¼‰ï¼Œä¹Ÿèƒ½åŒ¹é… <code>/posts/tech</code>ã€‚</p>
</li>
<li>
<p><strong>å¯¼èˆª</strong>ï¼šåœ¨ <code>Link</code> ä¸­ï¼Œå¦‚æœæƒ³å»æ‰å¯é€‰å‚æ•°ï¼Œå°†å€¼è®¾ä¸º <code>undefined</code> å³å¯ã€‚</p>
</li>
</ul>
<h4 data-id="heading-4">4. å›½é™…åŒ– (i18n) åº”ç”¨åœºæ™¯</h4>
<p>å¯é€‰å‚æ•°æœ€å¼ºå¤§çš„åœ°æ–¹åœ¨äºå¤„ç†è¯­è¨€å‰ç¼€ã€‚</p>
<ul>
<li>
<p><strong>è®¾è®¡</strong>ï¼š<code>/{-$locale}/about</code></p>
</li>
<li>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>
<p>ç”¨æˆ·è®¿é—® <code>/about</code> -&gt; é»˜è®¤è¯­è¨€ï¼ˆå¦‚ä¸­æ–‡ï¼‰ã€‚</p>
</li>
<li>
<p>ç”¨æˆ·è®¿é—® <code>/en/about</code> -&gt; è‹±æ–‡ã€‚</p>
</li>
</ul>
</li>
<li>
<p>è¿™æ ·ä½ ä¸éœ€è¦ä¸ºæ¯ç§è¯­è¨€åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œåªéœ€ä¸€ä¸ªè·¯ç”±é€»è¾‘å³å¯æå®šã€‚</p>
</li>
</ul>
<h4 data-id="heading-5">5. ç±»å‹å®‰å…¨ (Type Safety)</h4>
<p>TanStack Router çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</p>
<ul>
<li>
<p>å½“ä½ è·³è½¬ï¼ˆ<code>Link</code> æˆ– <code>Maps</code>ï¼‰åˆ°ä¸€ä¸ªå¸¦å‚æ•°çš„è·¯ç”±æ—¶ï¼ŒTypeScript ä¼š<strong>å¼ºåˆ¶è¦æ±‚</strong>ä½ æä¾›è¯¥å‚æ•°ã€‚</p>
</li>
<li>
<p>å¦‚æœæ˜¯å¯é€‰å‚æ•°ï¼ŒTS ä¼šè‡ªåŠ¨æ¨æ–­å…¶ç±»å‹ä¸º <code>string | undefined</code>ï¼Œæé†’ä½ åšç©ºå€¼å¤„ç†ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-6">å¸¸è§ç–‘é—®è§£ç­”</h3>
<p>Q: æ€ä¹ˆåœ¨ç»„ä»¶å¤–è·å–å‚æ•°ï¼Ÿ</p>
<p>ä½¿ç”¨å…¨å±€çš„ <code>useParams({ strict: false })</code>ã€‚ä½†å»ºè®®å°½å¯èƒ½åœ¨è·¯ç”±å†…éƒ¨ä½¿ç”¨ï¼Œä»¥è·å¾—å®Œæ•´çš„ç±»å‹æç¤ºã€‚</p>
<p>Q: å‚æ•°é‡Œèƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ @ï¼‰å—ï¼Ÿ</p>
<p>é»˜è®¤ä¼šè¿›è¡Œ URL ç¼–ç ã€‚å¦‚æœä½ æƒ³è®©å®ƒç›´æ¥æ˜¾ç¤ºï¼Œéœ€è¦åœ¨ createRouter çš„é…ç½®ä¸­è®¾ç½® <code>pathParamsAllowedCharacters: ['@']</code>ã€‚</p>
<p>Q: å¯¼èˆªæ—¶å¦‚ä½•ä¿ç•™ç°æœ‰çš„å‚æ•°ï¼Ÿ</p>
<p>åœ¨ Link æˆ– Maps çš„ params ä¸­ä½¿ç”¨å‡½æ•°å¼å†™æ³•ï¼š</p>
<p><code>params={(prev) =&gt; ({ ...prev, newParam: 'value' })}</code></p>
<hr/>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<p>è·¯å¾„å‚æ•°ä¸ä»…æ˜¯ $id è¿™ä¹ˆç®€å•ï¼Œé€šè¿‡ å‰ç¼€/åç¼€ã€å¯é€‰æ ‡å¿— å’Œ å¼ºç±»å‹æ ¡éªŒï¼Œä½ å¯ä»¥æå…¶ä¼˜é›…åœ°å¤„ç†å¤æ‚çš„ URL ç»“æ„ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿé¢„è§ˆæˆ–å¤šè¯­è¨€ç«™ç‚¹ï¼‰ï¼Œä¸”å®Œå…¨ä¸ä¼šå†™é”™è·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°]]></title>    <link>https://juejin.cn/post/7585778343350894655</link>    <guid>https://juejin.cn/post/7585778343350894655</guid>    <pubDate>2025-12-21T10:16:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585778343350894655" data-draft-id="7585751355592359955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-21T10:16:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç„¡é‡"/> <meta itemprop="url" content="https://juejin.cn/user/1116759546145086"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759546145086/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç„¡é‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:16:55.000Z" title="Sun Dec 21 2025 10:16:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€ä½Javaå¼€å‘è€…çš„AIä¹‹æ—…ï¼šä»AI Codingåˆ°AIå·¥ç¨‹åŒ–åº”ç”¨</p>
</blockquote>
<h2 data-id="heading-0">ç›®å½•</h2>
<ul>
<li><a href="#1-%E5%BC%95%E8%A8%80ai%E6%97%B6%E4%BB%A3java%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%96%B0%E6%9C%BA%E9%81%87" title="#1-%E5%BC%95%E8%A8%80ai%E6%97%B6%E4%BB%A3java%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%96%B0%E6%9C%BA%E9%81%87">1. å¼•è¨€ï¼šAIæ—¶ä»£ï¼ŒJavaå¼€å‘è€…çš„æ–°æœºé‡</a></li>
<li><a href="#2-ai%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E7%9A%84%E6%BC%94%E8%BF%9B" title="#2-ai%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E7%9A%84%E6%BC%94%E8%BF%9B">2. AIå‘å±•å†ç¨‹ï¼šä»ç†è®ºåˆ°å®è·µçš„æ¼”è¿›</a></li>
<li><a href="#3-ai%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9C%B0%E5%9B%BE" title="#3-ai%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9C%B0%E5%9B%BE">3. AIçŸ¥è¯†ä½“ç³»ï¼šæ„å»ºå®Œæ•´çš„è®¤çŸ¥åœ°å›¾</a></li>
<li><a href="#4-ai-coding%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%99%BA%E8%83%BD%E5%8A%A9%E6%89%8B" title="#4-ai-coding%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%99%BA%E8%83%BD%E5%8A%A9%E6%89%8B">4. AI Codingå·¥å…·ï¼šå¼€å‘è€…çš„æ™ºèƒ½åŠ©æ‰‹</a></li>
<li><a href="#5-ai%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5%E4%BB%8E%E6%A6%82%E5%BF%B5%E5%88%B0%E8%90%BD%E5%9C%B0" title="#5-ai%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5%E4%BB%8E%E6%A6%82%E5%BF%B5%E5%88%B0%E8%90%BD%E5%9C%B0">5. AIå·¥ç¨‹åŒ–å®è·µï¼šä»æ¦‚å¿µåˆ°è½åœ°</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">1. å¼•è¨€ï¼šAIæ—¶ä»£ï¼ŒJavaå¼€å‘è€…çš„æ–°æœºé‡</h2>
<h3 data-id="heading-2">1.1 ä¸ºä»€ä¹ˆæ˜¯ç°åœ¨ï¼Ÿ</h3>
<p>2022å¹´11æœˆï¼ŒChatGPTçš„å‘å¸ƒæ ‡å¿—ç€æˆ‘ä»¬è¿›å…¥äº†å¤§æ¨¡å‹æ—¶ä»£ã€‚ä½œä¸ºJavaå¼€å‘è€…ï¼Œæˆ‘ä»¬æ­£å¤„äºä¸€ä¸ªå†å²æ€§çš„è½¬æŠ˜ç‚¹ï¼š</p>
<ul>
<li><strong>å¼€å‘æ–¹å¼çš„é©å‘½</strong>ï¼šAI Codingå·¥å…·æ­£åœ¨æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼</li>
<li><strong>åº”ç”¨å½¢æ€çš„åˆ›æ–°</strong>ï¼šAIèƒ½åŠ›æ­£åœ¨è¢«é›†æˆåˆ°å„ç±»åº”ç”¨ä¸­</li>
<li><strong>æŠ€æœ¯æ ˆçš„æ‰©å±•</strong>ï¼šJavaç”Ÿæ€æ­£åœ¨å¿«é€Ÿæ‹¥æŠ±AIæŠ€æœ¯</li>
</ul>
<h3 data-id="heading-3">1.2 Javaå¼€å‘è€…çš„ä¼˜åŠ¿</h3>
<p>ä½œä¸ºJavaå¼€å‘è€…ï¼Œæˆ‘ä»¬åœ¨AIå·¥ç¨‹åŒ–è½åœ°æ–¹é¢æœ‰å¤©ç„¶ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Javaå¼€å‘è€…ä¼˜åŠ¿] --&gt; B[ä¼ä¸šçº§å¼€å‘ç»éªŒ]
    A --&gt; C[å·¥ç¨‹åŒ–æ€ç»´]
    A --&gt; D[æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿ]

    B --&gt; E[å¤§å‹é¡¹ç›®æ¶æ„èƒ½åŠ›]
    B --&gt; F[é«˜å¹¶å‘å¤„ç†ç»éªŒ]

    C --&gt; G[ä»£ç è§„èŒƒ]
    C --&gt; H[æµ‹è¯•é©±åŠ¨]
    C --&gt; I[DevOpså®è·µ]

    D --&gt; J[Springç”Ÿæ€]
    D --&gt; K[å¾®æœåŠ¡æ¡†æ¶]
    D --&gt; L[ä¸­é—´ä»¶é›†æˆ]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#fff4e1
</code></pre>
<hr/>
<h2 data-id="heading-4">2. AIå‘å±•å†ç¨‹ï¼šä»ç†è®ºtoå®è·µçš„æ¼”è¿›</h2>
<h3 data-id="heading-5">2.1 AIå‘å±•æ—¶é—´çº¿</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">timeline
    title AIå‘å±•å…³é”®èŠ‚ç‚¹
    1956 : è¾¾ç‰¹èŒ…æ–¯ä¼šè®®
         : AIæ¦‚å¿µè¯ç”Ÿ
    1997 : æ·±è“æˆ˜èƒœå¡æ–¯å¸•ç½—å¤«
         : ç¬¦å·AIå·…å³°
    2012 : ImageNetçªç ´
         : æ·±åº¦å­¦ä¹ å´›èµ·
    2016 : AlphaGoæˆ˜èƒœæä¸–çŸ³
         : å¼ºåŒ–å­¦ä¹ é‡Œç¨‹ç¢‘
    2017 : Transformeræ¶æ„
         : æ³¨æ„åŠ›æœºåˆ¶é©å‘½
    2018 : BERTå‘å¸ƒ
         : é¢„è®­ç»ƒæ¨¡å‹æ—¶ä»£
    2020 : GPT-3å‘å¸ƒ
         : å¤§æ¨¡å‹æ—¶ä»£å¼€å¯
    2022 : ChatGPTå‘å¸ƒ
         : AIåº”ç”¨å¤§çˆ†å‘
    2023 : GPT-4/Claude 3
         : å¤šæ¨¡æ€èƒ½åŠ›é£è·ƒ
    2024 : Claude 3.5 Sonnet
         : AI Codingæˆç†Ÿ
    2025 : AIå·¥ç¨‹åŒ–æ™®åŠ
         : ä¼ä¸šçº§åº”ç”¨è½åœ°
</code></pre>
<h3 data-id="heading-6">2.2 ä¸‰ä¸ªé‡è¦é˜¶æ®µ</h3>
<h4 data-id="heading-7"><strong>é˜¶æ®µä¸€ï¼šä¼ ç»ŸAIæ—¶ä»£ï¼ˆ1956-2010ï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>åŸºäºè§„åˆ™å’Œä¸“å®¶ç³»ç»Ÿ</li>
<li>ç¬¦å·ä¸»ä¹‰å’Œé€»è¾‘æ¨ç†</li>
<li>åº”ç”¨åœºæ™¯æœ‰é™</li>
</ul>
<p>å…¸å‹ä»£è¡¨ï¼š</p>
<ul>
<li>ä¸“å®¶ç³»ç»Ÿï¼ˆMYCINã€DENDRALï¼‰</li>
<li>æœç´¢ç®—æ³•ï¼ˆA*ã€åšå¼ˆæ ‘ï¼‰</li>
<li>æ—©æœŸè‡ªç„¶è¯­è¨€å¤„ç†</li>
</ul>
<h4 data-id="heading-8"><strong>é˜¶æ®µäºŒï¼šæ·±åº¦å­¦ä¹ é©å‘½ï¼ˆ2012-2020ï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>æ•°æ®é©±åŠ¨çš„å­¦ä¹ æ–¹å¼</li>
<li>ç¥ç»ç½‘ç»œçš„å¤å…´</li>
<li>åœ¨ç‰¹å®šé¢†åŸŸè¶…è¶Šäººç±»</li>
</ul>
<p>å…³é”®æŠ€æœ¯ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[æ·±åº¦å­¦ä¹ æŠ€æœ¯æ ˆ] --&gt; B[å·ç§¯ç¥ç»ç½‘ç»œ CNN]
    A --&gt; C[å¾ªç¯ç¥ç»ç½‘ç»œ RNN/LSTM]
    A --&gt; D[Transformeræ¶æ„]

    B --&gt; E[å›¾åƒè¯†åˆ«]
    B --&gt; F[è®¡ç®—æœºè§†è§‰]

    C --&gt; G[åºåˆ—å»ºæ¨¡]
    C --&gt; H[æœºå™¨ç¿»è¯‘]

    D --&gt; I[è‡ªç„¶è¯­è¨€å¤„ç†]
    D --&gt; J[å¤§è¯­è¨€æ¨¡å‹]

    style A fill:#e1f5ff
    style D fill:#ffe1e1
</code></pre>
<h4 data-id="heading-9"><strong>é˜¶æ®µä¸‰ï¼šå¤§æ¨¡å‹æ—¶ä»£ï¼ˆ2020è‡³ä»Šï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>è§„æ¨¡åŒ–é¢„è®­ç»ƒæ¨¡å‹</li>
<li>æ¶Œç°èƒ½åŠ›ï¼ˆEmergent Abilitiesï¼‰</li>
<li>é€šç”¨äººå·¥æ™ºèƒ½çš„é›å½¢</li>
</ul>
<p>æ ¸å¿ƒç†å¿µï¼š</p>
<ol>
<li><strong>Scale Law</strong>ï¼šæ¨¡å‹è¶Šå¤§ï¼Œèƒ½åŠ›è¶Šå¼º</li>
<li><strong>Few-shot Learning</strong>ï¼šå°‘æ ·æœ¬ç”šè‡³é›¶æ ·æœ¬å­¦ä¹ </li>
<li><strong>Instruction Following</strong>ï¼šç†è§£å¹¶æ‰§è¡Œå¤æ‚æŒ‡ä»¤</li>
</ol>
<hr/>
<h2 data-id="heading-10">3. AIçŸ¥è¯†ä½“ç³»ï¼šæ„å»ºå®Œæ•´çš„è®¤çŸ¥åœ°å›¾</h2>
<h3 data-id="heading-11">3.1 æ•´ä½“çŸ¥è¯†æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;åº”ç”¨å±‚&amp;#34;
        A1[AI Coding]
        A2[æ™ºèƒ½å®¢æœ]
        A3[æ–‡æ¡£é—®ç­”]
        A4[ä»£ç åŠ©æ‰‹]
        A5[æ•°æ®åˆ†æ]
    end

    subgraph &amp;#34;å·¥ç¨‹å±‚&amp;#34;
        B1[LangChain4j]
        B2[Spring AI]
        B3[LlamaIndex]
        B4[Semantic Kernel]
    end

    subgraph &amp;#34;èƒ½åŠ›å±‚&amp;#34;
        C1[Prompt Engineering]
        C2[RAGæ£€ç´¢å¢å¼º]
        C3[Agentæ™ºèƒ½ä½“]
        C4[Function Calling]
        C5[Fine-tuningå¾®è°ƒ]
    end

    subgraph &amp;#34;æ¨¡å‹å±‚&amp;#34;
        D1[GPT-4/GPT-4o]
        D2[Claude 3.5]
        D3[Gemini]
        D4[Llama 3]
        D5[é€šä¹‰åƒé—®]
    end

    subgraph &amp;#34;åŸºç¡€å±‚&amp;#34;
        E1[Transformer]
        E2[Attentionæœºåˆ¶]
        E3[Tokenæœºåˆ¶]
        E4[Embedding]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 &amp; A5 --&gt; B1 &amp; B2 &amp; B3 &amp; B4
    B1 &amp; B2 &amp; B3 &amp; B4 --&gt; C1 &amp; C2 &amp; C3 &amp; C4 &amp; C5
    C1 &amp; C2 &amp; C3 &amp; C4 &amp; C5 --&gt; D1 &amp; D2 &amp; D3 &amp; D4 &amp; D5
    D1 &amp; D2 &amp; D3 &amp; D4 &amp; D5 --&gt; E1 &amp; E2 &amp; E3 &amp; E4

    style A1 fill:#e1f5ff
    style B1 fill:#fff4e1
    style C1 fill:#e1ffe1
    style D1 fill:#ffe1f5
    style E1 fill:#f5e1ff
</code></pre>
<h3 data-id="heading-12">3.2 æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h3>
<h4 data-id="heading-13"><strong>3.2.1 å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯LLMï¼Ÿ</strong></p>
<p>å¤§è¯­è¨€æ¨¡å‹æ˜¯é€šè¿‡åœ¨æµ·é‡æ–‡æœ¬æ•°æ®ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œå­¦ä¹ è¯­è¨€æ¨¡å¼å’ŒçŸ¥è¯†çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹å¾ï¼š</strong></p>






























<table><thead><tr><th>ç‰¹å¾</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>å¤§è§„æ¨¡å‚æ•°</strong></td><td>æ•°åäº¿åˆ°æ•°åƒäº¿å‚æ•°</td><td>GPT-4: ~1.7T, Claude 3.5: æœªå…¬å¼€</td></tr><tr><td><strong>é¢„è®­ç»ƒ</strong></td><td>åœ¨å¤§è§„æ¨¡è¯­æ–™ä¸Šè‡ªç›‘ç£å­¦ä¹ </td><td>äº’è”ç½‘æ–‡æœ¬ã€ä¹¦ç±ã€ä»£ç ç­‰</td></tr><tr><td><strong>æ¶Œç°èƒ½åŠ›</strong></td><td>æ¨¡å‹è§„æ¨¡è¾¾åˆ°ä¸´ç•Œç‚¹åå‡ºç°çš„èƒ½åŠ›</td><td>æ¨ç†ã€ä»£ç ç”Ÿæˆã€å¤šè¯­è¨€ç†è§£</td></tr><tr><td><strong>ä¸Šä¸‹æ–‡å­¦ä¹ </strong></td><td>ä»æç¤ºè¯ä¸­å­¦ä¹ ä»»åŠ¡</td><td>Few-shotã€Zero-shotå­¦ä¹ </td></tr></tbody></table>
<p><strong>å·¥ä½œåŸç†ç®€åŒ–ç†è§£ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ç”¨æˆ·è¾“å…¥ â†’ TokenåŒ– â†’ Embedding â†’ Transformerå¤„ç† â†’ æ¦‚ç‡é¢„æµ‹ â†’ ç”Ÿæˆè¾“å‡º
   â†“          â†“           â†“              â†“              â†“           â†“
<span class="hljs-string">"ä½ å¥½"</span>   â†’ [<span class="hljs-number">101</span>,<span class="hljs-number">203</span>] â†’ å‘é‡åŒ– â†’ å¤šå±‚æ³¨æ„åŠ›è®¡ç®— â†’ ä¸‹ä¸€ä¸ªToken â†’ <span class="hljs-string">"æ‚¨å¥½"</span>
</code></pre>
<h4 data-id="heading-14"><strong>3.2.2 Prompt Engineeringï¼ˆæç¤ºè¯å·¥ç¨‹ï¼‰</strong></h4>
<p><strong>å®šä¹‰ï¼š</strong> è®¾è®¡å’Œä¼˜åŒ–è¾“å…¥æç¤ºè¯ï¼Œä»¥è·å¾—æ›´å¥½çš„æ¨¡å‹è¾“å‡ºã€‚</p>
<p><strong>æ ¸å¿ƒæŠ€å·§ï¼š</strong></p>
<ol>
<li><strong>æ˜ç¡®è§’è‰²å’Œä»»åŠ¡</strong></li>
</ol>

<pre><code class="hljs">ä½ æ˜¯ä¸€ä½èµ„æ·±çš„Javaæ¶æ„å¸ˆï¼Œæ“…é•¿Spring Bootå’Œå¾®æœåŠ¡è®¾è®¡ã€‚
è¯·å¸®æˆ‘è®¾è®¡ä¸€ä¸ªè®¢å•ç³»ç»Ÿçš„æ•°æ®åº“è¡¨ç»“æ„ã€‚
</code></pre>
<p>2.  <strong>æä¾›ä¸Šä¸‹æ–‡å’Œçº¦æŸ</strong></p>

<pre><code class="hljs language-diff" lang="diff">èƒŒæ™¯ï¼šç”µå•†ç³»ç»Ÿï¼Œæ—¥è®¢å•é‡10ä¸‡
è¦æ±‚ï¼š
<span class="hljs-deletion">- æ”¯æŒè®¢å•æ‹†åˆ†</span>
<span class="hljs-deletion">- éœ€è¦è®°å½•å®Œæ•´çš„çŠ¶æ€æµè½¬</span>
<span class="hljs-deletion">- è€ƒè™‘åˆ†åº“åˆ†è¡¨</span>
</code></pre>
<p>3.  <strong>ä½¿ç”¨ç¤ºä¾‹å¼•å¯¼</strong></p>

<pre><code class="hljs language-diff" lang="diff">å‚è€ƒä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š
è¡¨åï¼št_order
å­—æ®µï¼š
<span class="hljs-deletion">- id: bigint, ä¸»é”®</span>
<span class="hljs-deletion">- user_id: bigint, ç”¨æˆ·ID</span>
...
</code></pre>
<p>4.  <strong>åˆ†æ­¥éª¤æ€è€ƒï¼ˆChain of Thoughtï¼‰</strong></p>

<pre><code class="hljs language-markdown" lang="markdown">è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤åˆ†æï¼š
<span class="hljs-bullet">1.</span> è¯†åˆ«æ ¸å¿ƒå®ä½“
<span class="hljs-bullet">2.</span> ç¡®å®šè¡¨å…³ç³»
<span class="hljs-bullet">3.</span> è®¾è®¡å­—æ®µ
<span class="hljs-bullet">4.</span> æ·»åŠ ç´¢å¼•
<span class="hljs-bullet">5.</span> è€ƒè™‘æ‰©å±•æ€§
</code></pre>
<p><strong>Promptæ¨¡å¼æ€»ç»“ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edf1443b120241d38ca8eb0d53cc6ac1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Sh6YeP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917015&amp;x-signature=U1hGOywBy1eSnxpZuTIn68CIpWw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-15"><strong>3.2.3 RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong></h4>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦RAGï¼Ÿ</strong></p>
<p>å¤§æ¨¡å‹è™½ç„¶å¼ºå¤§ï¼Œä½†å­˜åœ¨å±€é™ï¼š</p>
<ul>
<li>âŒ çŸ¥è¯†æˆªæ­¢æ—¥æœŸé™åˆ¶</li>
<li>âŒ æ— æ³•è®¿é—®ç§æœ‰æ•°æ®</li>
<li>âŒ å¯èƒ½äº§ç”Ÿå¹»è§‰ï¼ˆHallucinationï¼‰</li>
<li>âŒ ç¼ºä¹ç‰¹å®šé¢†åŸŸçŸ¥è¯†</li>
</ul>
<p><strong>RAGå¦‚ä½•è§£å†³ï¼Ÿ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as ç³»ç»Ÿ
    participant V as å‘é‡æ•°æ®åº“
    participant L as LLM

    U-&gt;&gt;S: æé—®ï¼š&amp;#34;å…¬å¸Q3è´¢æŠ¥å¦‚ä½•ï¼Ÿ&amp;#34;
    S-&gt;&gt;S: Queryæ”¹å†™ä¸ä¼˜åŒ–
    S-&gt;&gt;V: å‘é‡æ£€ç´¢ç›¸ä¼¼å†…å®¹
    V--&gt;&gt;S: è¿”å›Top-Kç›¸å…³æ–‡æ¡£
    Note over S: æ–‡æ¡£1: Q3è¥æ”¶100äº¿&lt;br/&gt;æ–‡æ¡£2: åŒæ¯”å¢é•¿25%&lt;br/&gt;æ–‡æ¡£3: å‡€åˆ©æ¶¦15äº¿
    S-&gt;&gt;L: æ„å»ºPromptï¼ˆé—®é¢˜+æ£€ç´¢æ–‡æ¡£ï¼‰
    Note over L: Prompt:&lt;br/&gt;åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”...&lt;br/&gt;[ç›¸å…³æ–‡æ¡£]&lt;br/&gt;é—®é¢˜: å…¬å¸Q3è´¢æŠ¥å¦‚ä½•ï¼Ÿ
    L--&gt;&gt;S: ç”Ÿæˆç­”æ¡ˆ
    S--&gt;&gt;U: &amp;#34;Q3è¥æ”¶100äº¿ï¼ŒåŒæ¯”å¢é•¿25%...&amp;#34;
</code></pre>
<p><strong>RAGæŠ€æœ¯æ¶æ„ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;æ•°æ®å‡†å¤‡&amp;#34;
        A[åŸå§‹æ–‡æ¡£] --&gt; B[æ–‡æ¡£åˆ†å—]
        B --&gt; C[å‘é‡åŒ–Embedding]
        C --&gt; D[å­˜å…¥å‘é‡æ•°æ®åº“]
    end

    subgraph &amp;#34;æ£€ç´¢é˜¶æ®µ&amp;#34;
        E[ç”¨æˆ·æŸ¥è¯¢] --&gt; F[Query Embedding]
        F --&gt; G[ç›¸ä¼¼åº¦æ£€ç´¢]
        D --&gt; G
        G --&gt; H[Top-Kæ–‡æ¡£]
    end

    subgraph &amp;#34;ç”Ÿæˆé˜¶æ®µ&amp;#34;
        H --&gt; I[Promptæ„å»º]
        E --&gt; I
        I --&gt; J[LLMç”Ÿæˆ]
        J --&gt; K[ç­”æ¡ˆè¾“å‡º]
    end

    style A fill:#e1f5ff
    style E fill:#e1f5ff
    style K fill:#e1ffe1
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>



































<table><thead><tr><th>ç¯èŠ‚</th><th>æŠ€æœ¯é€‰æ‹©</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ–‡æ¡£åˆ‡åˆ†</strong></td><td>å›ºå®šé•¿åº¦ã€è¯­ä¹‰åˆ‡åˆ†ã€é€’å½’åˆ‡åˆ†</td><td>å¹³è¡¡ä¸Šä¸‹æ–‡å®Œæ•´æ€§å’Œæ£€ç´¢ç²¾åº¦</td></tr><tr><td><strong>Embeddingæ¨¡å‹</strong></td><td>OpenAIã€BGEã€M3E</td><td>ä¸­æ–‡æ¨èBGEæˆ–M3E</td></tr><tr><td><strong>å‘é‡æ•°æ®åº“</strong></td><td>Milvusã€Qdrantã€Pinecone</td><td>è€ƒè™‘æ€§èƒ½å’Œéƒ¨ç½²æ–¹å¼</td></tr><tr><td><strong>æ£€ç´¢ç­–ç•¥</strong></td><td>å¯†é›†æ£€ç´¢ã€ç¨€ç–æ£€ç´¢ã€æ··åˆæ£€ç´¢</td><td>æå‡å¬å›ç‡å’Œå‡†ç¡®ç‡</td></tr><tr><td><strong>é‡æ’åº</strong></td><td>Rerankæ¨¡å‹</td><td>ä¼˜åŒ–Top-Kç»“æœè´¨é‡</td></tr></tbody></table>
<h4 data-id="heading-16"><strong>3.2.4 Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ</strong></p>
<p>å…·å¤‡è‡ªä¸»å†³ç­–å’Œå·¥å…·ä½¿ç”¨èƒ½åŠ›çš„AIç³»ç»Ÿï¼Œèƒ½å¤Ÿç†è§£ä»»åŠ¡ã€åˆ¶å®šè®¡åˆ’ã€æ‰§è¡ŒåŠ¨ä½œã€å¹¶æ ¹æ®åé¦ˆè°ƒæ•´ç­–ç•¥ã€‚</p>
<p><strong>Agentæ ¸å¿ƒç»„ä»¶ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Agentæ ¸å¿ƒ] --&gt; B[æ„ŸçŸ¥ Perception]
    A --&gt; C[è§„åˆ’ Planning]
    A --&gt; D[è®°å¿† Memory]
    A --&gt; E[å·¥å…· Tools]
    A --&gt; F[æ‰§è¡Œ Action]

    B --&gt; B1[ç†è§£ä»»åŠ¡]
    B --&gt; B2[ç¯å¢ƒæ„ŸçŸ¥]

    C --&gt; C1[ä»»åŠ¡åˆ†è§£]
    C --&gt; C2[åˆ¶å®šè®¡åˆ’]
    C --&gt; C3[å†³ç­–æ¨ç†]

    D --&gt; D1[çŸ­æœŸè®°å¿†]
    D --&gt; D2[é•¿æœŸè®°å¿†]
    D --&gt; D3[ç»éªŒç§¯ç´¯]

    E --&gt; E1[æœç´¢å·¥å…·]
    E --&gt; E2[ä»£ç æ‰§è¡Œ]
    E --&gt; E3[APIè°ƒç”¨]
    E --&gt; E4[æ•°æ®åº“æŸ¥è¯¢]

    F --&gt; F1[æ‰§è¡Œæ“ä½œ]
    F --&gt; F2[è·å–åé¦ˆ]
    F --&gt; F3[è°ƒæ•´ç­–ç•¥]

    style A fill:#e1f5ff
</code></pre>
<p><strong>Agentå·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; æ¥æ”¶ä»»åŠ¡
    æ¥æ”¶ä»»åŠ¡ --&gt; ç†è§£åˆ†æ
    ç†è§£åˆ†æ --&gt; åˆ¶å®šè®¡åˆ’
    åˆ¶å®šè®¡åˆ’ --&gt; é€‰æ‹©å·¥å…·
    é€‰æ‹©å·¥å…· --&gt; æ‰§è¡ŒåŠ¨ä½œ
    æ‰§è¡ŒåŠ¨ä½œ --&gt; è§‚å¯Ÿç»“æœ
    è§‚å¯Ÿç»“æœ --&gt; åˆ¤æ–­å®Œæˆ: ä»»åŠ¡å®Œæˆï¼Ÿ
    åˆ¤æ–­å®Œæˆ --&gt; è¿”å›ç»“æœ: æ˜¯
    åˆ¤æ–­å®Œæˆ --&gt; è°ƒæ•´è®¡åˆ’: å¦
    è°ƒæ•´è®¡åˆ’ --&gt; é€‰æ‹©å·¥å…·
    è¿”å›ç»“æœ --&gt; [*]
</code></pre>
<p><strong>å…¸å‹Agentæ¨¡å¼ï¼š</strong></p>
<ol>
<li><strong>ReActæ¨¡å¼</strong>ï¼ˆReasoning + Actingï¼‰</li>
</ol>

<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">Thought:</span> ç”¨æˆ·æƒ³æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼Œæˆ‘éœ€è¦å…ˆè·å–è®¢å•ID
<span class="hljs-symbol">Action:</span> è°ƒç”¨getUserOrderså·¥å…·
<span class="hljs-symbol">Observation:</span> è¿”å›è®¢å•åˆ—è¡¨[#<span class="hljs-number">12345</span>, #<span class="hljs-number">12346</span>]
<span class="hljs-symbol">Thought:</span> ç”¨æˆ·æœ€è¿‘çš„è®¢å•æ˜¯#<span class="hljs-number">12346</span>ï¼ŒæŸ¥è¯¢å…¶çŠ¶æ€
<span class="hljs-symbol">Action:</span> è°ƒç”¨getOrderStatus(#<span class="hljs-number">12346</span>)
<span class="hljs-symbol">Observation:</span> è®¢å•çŠ¶æ€ä¸º<span class="hljs-string">"å·²å‘è´§"</span>
<span class="hljs-symbol">Thought:</span> æˆ‘å·²ç»å¾—åˆ°ç­”æ¡ˆ
<span class="hljs-symbol">Answer:</span> æ‚¨çš„è®¢å•#<span class="hljs-number">12346</span>å·²å‘è´§
</code></pre>
<p>2.  <strong>Plan-and-Executeæ¨¡å¼</strong></p>

<pre><code class="hljs language-ini" lang="ini">Plan:
1. æœç´¢Spring AI Alibabaå®˜æ–¹æ–‡æ¡£
2. æå–æ ¸å¿ƒç‰¹æ€§ä¿¡æ¯
3. å¯¹æ¯”LangChain4jçš„å·®å¼‚
4. ç”Ÿæˆå¯¹æ¯”è¡¨æ ¼

Execute:
<span class="hljs-section">[æ‰§è¡Œæ­¥éª¤1]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤2]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤3]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤4]</span>
</code></pre>
<h4 data-id="heading-17"><strong>3.2.5 Function Callingï¼ˆå‡½æ•°è°ƒç”¨ï¼‰</strong></h4>
<p><strong>å®šä¹‰ï¼š</strong> è®©LLMèƒ½å¤Ÿä¸»åŠ¨è°ƒç”¨å¤–éƒ¨å‡½æ•°/APIæ¥å®Œæˆä»»åŠ¡ã€‚</p>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant L as LLM
    participant S as ç³»ç»Ÿ
    participant API as å¤–éƒ¨API

    U-&gt;&gt;L: &amp;#34;æŸ¥è¯¢åŒ—äº¬æ˜å¤©å¤©æ°”&amp;#34;
    L-&gt;&gt;L: åˆ†æéœ€è¦è°ƒç”¨å¤©æ°”API
    L-&gt;&gt;S: è¿”å›å‡½æ•°è°ƒç”¨è¯·æ±‚
    Note over S: {&lt;br/&gt;  &amp;#34;function&amp;#34;: &amp;#34;getWeather&amp;#34;,&lt;br/&gt;  &amp;#34;parameters&amp;#34;: {&lt;br/&gt;    &amp;#34;city&amp;#34;: &amp;#34;åŒ—äº¬&amp;#34;,&lt;br/&gt;    &amp;#34;date&amp;#34;: &amp;#34;æ˜å¤©&amp;#34;&lt;br/&gt;  }&lt;br/&gt;}
    S-&gt;&gt;API: è°ƒç”¨å¤©æ°”API
    API--&gt;&gt;S: è¿”å›å¤©æ°”æ•°æ®
    S-&gt;&gt;L: å°†ç»“æœè¿”å›ç»™LLM
    L-&gt;&gt;U: &amp;#34;åŒ—äº¬æ˜å¤©æ™´ï¼Œ15-25â„ƒ&amp;#34;
</code></pre>
<p><strong>Javaå®ç°ç¤ºä¾‹ï¼ˆLangChain4jï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰å·¥å…·å‡½æ•°</span>
<span class="hljs-meta">@Tool("æŸ¥è¯¢è®¢å•çŠ¶æ€")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrderStatus</span><span class="hljs-params">(<span class="hljs-meta">@P("è®¢å•ID")</span> String orderId)</span> {
    <span class="hljs-comment">// å®é™…ä¸šåŠ¡é€»è¾‘</span>
    <span class="hljs-keyword">return</span> orderService.queryStatus(orderId);
}

<span class="hljs-comment">// é…ç½®Agent</span>
<span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
    .apiKey(apiKey)
    .modelName(<span class="hljs-string">"gpt-4"</span>)
    .build();

<span class="hljs-type">Assistant</span> <span class="hljs-variable">assistant</span> <span class="hljs-operator">=</span> AiServices.builder(Assistant.class)
    .chatLanguageModel(model)
    .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderTools</span>())
    .build();

<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> assistant.chat(<span class="hljs-string">"å¸®æˆ‘æŸ¥è¯¢è®¢å•12345çš„çŠ¶æ€"</span>);
</code></pre>
<h4 data-id="heading-18"><strong>3.2.6 Fine-tuningï¼ˆå¾®è°ƒï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯å¾®è°ƒï¼Ÿ</strong></p>
<p>åœ¨é¢„è®­ç»ƒæ¨¡å‹åŸºç¡€ä¸Šï¼Œä½¿ç”¨ç‰¹å®šé¢†åŸŸæ•°æ®è¿›è¡Œè¿›ä¸€æ­¥è®­ç»ƒï¼Œä½¿æ¨¡å‹é€‚åº”ç‰¹å®šä»»åŠ¡ã€‚</p>
<p><strong>å¾®è°ƒ vs RAG vs Prompt Engineeringï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ä»»åŠ¡éœ€æ±‚] --&gt; B{æ•°æ®é‡}
    B --&gt;|å°‘é‡æ•°æ®&lt;br/&gt;å¿«é€Ÿè¿­ä»£| C[Prompt Engineering]
    B --&gt;|ä¸­ç­‰æ•°æ®&lt;br/&gt;çŸ¥è¯†å¢å¼º| D[RAG]
    B --&gt;|å¤§é‡æ•°æ®&lt;br/&gt;è¡Œä¸ºå®šåˆ¶| E[Fine-tuning]

    C --&gt; C1[ä¼˜ç‚¹: é›¶æˆæœ¬å¿«é€ŸéªŒè¯]
    C --&gt; C2[ç¼ºç‚¹: å—é™äºæ¨¡å‹èƒ½åŠ›]

    D --&gt; D1[ä¼˜ç‚¹: åŠ¨æ€çŸ¥è¯†æ›´æ–°]
    D --&gt; D2[ç¼ºç‚¹: éœ€è¦ç»´æŠ¤æ£€ç´¢ç³»ç»Ÿ]

    E --&gt; E1[ä¼˜ç‚¹: æ·±åº¦å®šåˆ¶]
    E --&gt; E2[ç¼ºç‚¹: æˆæœ¬é«˜å‘¨æœŸé•¿]

    style C fill:#e1ffe1
    style D fill:#fff4e1
    style E fill:#ffe1e1
</code></pre>
<p><strong>é€‰æ‹©å†³ç­–æ ‘ï¼š</strong></p>



































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>æ ¼å¼åŒ–è¾“å‡º</td><td>Prompt</td><td>ç®€å•æœ‰æ•ˆ</td></tr><tr><td>ä¼ä¸šçŸ¥è¯†é—®ç­”</td><td>RAG</td><td>çŸ¥è¯†å¯æ›´æ–°</td></tr><tr><td>ç‰¹å®šé¢†åŸŸå¯¹è¯é£æ ¼</td><td>Fine-tuning</td><td>æ·±åº¦å®šåˆ¶</td></tr><tr><td>å¤šè½®å¯¹è¯</td><td>Prompt + RAG</td><td>ç»„åˆä½¿ç”¨</td></tr><tr><td>ä¸“ä¸šæœ¯è¯­ç¿»è¯‘</td><td>Fine-tuning</td><td>ä¸“ä¸šæ€§å¼º</td></tr></tbody></table>
<h3 data-id="heading-19">3.3 æŠ€æœ¯æ ˆå…¨æ™¯å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;å‰ç«¯å±‚&amp;#34;
        UI1[Webç•Œé¢]
        UI2[ç§»åŠ¨ç«¯]
        UI3[IDEæ’ä»¶]
    end

    subgraph &amp;#34;åº”ç”¨å±‚&amp;#34;
        APP1[Spring Bootåº”ç”¨]
        APP2[å¾®æœåŠ¡]
        APP3[Serverless]
    end

    subgraph &amp;#34;AIæ¡†æ¶å±‚&amp;#34;
        FW1[Spring AI Alibaba]
        FW2[LangChain4j]
        FW3[Semantic Kernel]
    end

    subgraph &amp;#34;AIèƒ½åŠ›å±‚&amp;#34;
        CAP1[Chatå¯¹è¯]
        CAP2[Embeddingå‘é‡åŒ–]
        CAP3[Imageç”Ÿæˆ]
        CAP4[Audioå¤„ç†]
    end

    subgraph &amp;#34;æ¨¡å‹æ¥å…¥å±‚&amp;#34;
        MOD1[OpenAI API]
        MOD2[Anthropic API]
        MOD3[é˜¿é‡Œäº‘ç™¾ç‚¼]
        MOD4[æœ¬åœ°æ¨¡å‹Ollama]
    end

    subgraph &amp;#34;æ•°æ®å±‚&amp;#34;
        DATA1[å‘é‡æ•°æ®åº“]
        DATA2[å…³ç³»æ•°æ®åº“]
        DATA3[ç¼“å­˜Redis]
        DATA4[å¯¹è±¡å­˜å‚¨]
    end

    UI1 &amp; UI2 &amp; UI3 --&gt; APP1 &amp; APP2 &amp; APP3
    APP1 &amp; APP2 &amp; APP3 --&gt; FW1 &amp; FW2 &amp; FW3
    FW1 &amp; FW2 &amp; FW3 --&gt; CAP1 &amp; CAP2 &amp; CAP3 &amp; CAP4
    CAP1 &amp; CAP2 &amp; CAP3 &amp; CAP4 --&gt; MOD1 &amp; MOD2 &amp; MOD3 &amp; MOD4
    FW1 &amp; FW2 &amp; FW3 --&gt; DATA1 &amp; DATA2 &amp; DATA3 &amp; DATA4

    style FW1 fill:#e1f5ff
    style FW2 fill:#e1f5ff
</code></pre>
<hr/>
<h2 data-id="heading-20">4. AI Codingå·¥å…·ï¼šå¼€å‘è€…çš„æ™ºèƒ½åŠ©æ‰‹</h2>
<h3 data-id="heading-21">4.1 AI Codingçš„æœ¬è´¨</h3>
<p>AI Codingä¸æ˜¯æ›¿ä»£ç¨‹åºå‘˜ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>âœ… æå‡å¼€å‘æ•ˆç‡ï¼ˆ2-5å€ï¼‰</li>
<li>âœ… å‡å°‘é‡å¤æ€§å·¥ä½œ</li>
<li>âœ… è¾…åŠ©å­¦ä¹ æ–°æŠ€æœ¯</li>
<li>âœ… æ”¹å–„ä»£ç è´¨é‡</li>
</ul>
<h3 data-id="heading-22">4.2 ä¸»æµå·¥å…·å…¨æ™¯å¯¹æ¯”</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86c7eb1721b541afa7a1643c3878656b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Sh6YeP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917015&amp;x-signature=IXvdRjJrpn0VzJjc81u%2BccWe9rQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-23">4.3 é‡ç‚¹å·¥å…·è¯¦è§£</h3>
<h4 data-id="heading-24"><strong>4.3.1 Claude Code</strong></h4>
<p><strong>å®šä½ï¼š</strong> å®˜æ–¹CLIå·¥å…·ï¼Œæ·±åº¦é›†æˆClaude 3.5 Sonnetï¼Œä¸“æ³¨äºä»£ç ç”Ÿæˆå’Œå·¥ç¨‹å®è·µã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th><th>ä¼˜åŠ¿</th></tr></thead><tbody><tr><td><strong>é•¿ä¸Šä¸‹æ–‡</strong></td><td>æ”¯æŒ200K tokens</td><td>å¯ä»¥ç†è§£æ•´ä¸ªä»£ç åº“</td></tr><tr><td><strong>Artifacts</strong></td><td>ç‹¬ç«‹çš„ä»£ç é¢„è§ˆ</td><td>æ‰€è§å³æ‰€å¾—</td></tr><tr><td><strong>å·¥å…·é›†æˆ</strong></td><td>Bashã€æ–‡ä»¶æ“ä½œã€æœç´¢</td><td>å®Œæ•´çš„å¼€å‘ç¯å¢ƒ</td></tr><tr><td><strong>æ€ç»´é“¾</strong></td><td>å¯è§çš„æ¨ç†è¿‡ç¨‹</td><td>ç†è§£AIçš„å†³ç­–é€»è¾‘</td></tr></tbody></table>
<p><strong>å…¸å‹ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä»£ç é‡æ„</span>
claude <span class="hljs-string">"å°†è¿™ä¸ªControlleræ”¹é€ ä¸ºRESTfulé£æ ¼ï¼Œå¹¶æ·»åŠ å‚æ•°æ ¡éªŒ"</span>

<span class="hljs-comment"># 2. å•å…ƒæµ‹è¯•ç”Ÿæˆ</span>
claude <span class="hljs-string">"ä¸ºUserServiceç”Ÿæˆå®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–ç‡è¾¾åˆ°80%"</span>

<span class="hljs-comment"># 3. ä»£ç å®¡æŸ¥</span>
claude <span class="hljs-string">"å®¡æŸ¥è¿™æ®µä»£ç çš„å®‰å…¨æ€§å’Œæ€§èƒ½é—®é¢˜"</span>

<span class="hljs-comment"># 4. æ¶æ„è®¾è®¡</span>
claude <span class="hljs-string">"è®¾è®¡ä¸€ä¸ªæ”¯æŒç™¾ä¸‡çº§ç”¨æˆ·çš„ç§’æ€ç³»ç»Ÿæ¶æ„"</span>
</code></pre>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä½¿ç”¨Claude Code] --&gt; B[å‡†å¤‡å……åˆ†çš„ä¸Šä¸‹æ–‡]
    B --&gt; C[æ˜ç¡®çš„éœ€æ±‚æè¿°]
    C --&gt; D[è¿­ä»£å¼äº¤äº’]
    D --&gt; E[ä»£ç å®¡æŸ¥éªŒè¯]

    B --&gt; B1[é¡¹ç›®README]
    B --&gt; B2[ç›¸å…³ä»£ç æ–‡ä»¶]
    B --&gt; B3[æŠ€æœ¯æ ˆè¯´æ˜]

    C --&gt; C1[åŠŸèƒ½éœ€æ±‚]
    C --&gt; C2[æŠ€æœ¯çº¦æŸ]
    C --&gt; C3[æœŸæœ›è¾“å‡ºæ ¼å¼]

    D --&gt; D1[å…ˆæ•´ä½“åç»†èŠ‚]
    D --&gt; D2[åŠæ—¶åé¦ˆè°ƒæ•´]

    E --&gt; E1[è¿è¡Œæµ‹è¯•]
    E --&gt; E2[ä»£ç review]
    E --&gt; E3[æ€§èƒ½éªŒè¯]
</code></pre>
<h4 data-id="heading-25"><strong>4.3.2 Cursor</strong></h4>
<p><strong>å®šä½ï¼š</strong> AI-firstçš„IDEï¼ŒåŸºäºVS Codeæ·±åº¦å®šåˆ¶ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<ol>
<li>
<p><strong>Cmd+Kï¼šå†…è”ç¼–è¾‘</strong></p>
<ul>
<li>é€‰ä¸­ä»£ç ï¼Œæè¿°éœ€æ±‚</li>
<li>AIç›´æ¥ä¿®æ”¹ä»£ç </li>
<li>æ”¯æŒå¤šå¤„åŒæ—¶ç¼–è¾‘</li>
</ul>
</li>
<li>
<p><strong>Composerï¼šå¤šæ–‡ä»¶ç¼–è¾‘</strong></p>
<ul>
<li>è·¨æ–‡ä»¶é‡æ„</li>
<li>ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªç›¸å…³æ–‡ä»¶</li>
<li>ä¿æŒä»£ç ä¸€è‡´æ€§</li>
</ul>
</li>
<li>
<p><strong>Chatï¼šå¯¹è¯å¼ç¼–ç¨‹</strong></p>
<ul>
<li><code>@Codebase</code> æœç´¢æ•´ä¸ªä»£ç åº“</li>
<li><code>@Web</code> æœç´¢ç½‘ç»œèµ„æ–™</li>
<li><code>@Docs</code> æŸ¥è¯¢æ–‡æ¡£</li>
</ul>
</li>
<li>
<p><strong>Tabï¼šä»£ç è¡¥å…¨</strong></p>
<ul>
<li>ä¸Šä¸‹æ–‡æ„ŸçŸ¥è¡¥å…¨</li>
<li>å­¦ä¹ ä¸ªäººç¼–ç é£æ ¼</li>
</ul>
</li>
</ol>
<p><strong>Cursor vs Claude Codeï¼š</strong></p>








































<table><thead><tr><th>ç»´åº¦</th><th>Cursor</th><th>Claude Code</th></tr></thead><tbody><tr><td><strong>ç•Œé¢</strong></td><td>å›¾å½¢åŒ–IDE</td><td>å‘½ä»¤è¡ŒCLI</td></tr><tr><td><strong>é›†æˆåº¦</strong></td><td>æ·±åº¦é›†æˆVS Code</td><td>ç‹¬ç«‹å·¥å…·</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>å¹³ç¼“</td><td>ç¨é™¡å³­</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>ä¸­ç­‰</td><td>é«˜</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ—¥å¸¸å¼€å‘</td><td>å¤æ‚ä»»åŠ¡ã€è‡ªåŠ¨åŒ–</td></tr><tr><td><strong>ä»·æ ¼</strong></td><td>$20/æœˆ</td><td>æŒ‰APIè®¡è´¹</td></tr></tbody></table>
<p><strong>ç»„åˆä½¿ç”¨å»ºè®®ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">æ—¥å¸¸å¼€å‘ï¼š<span class="hljs-attribute">Cursor</span>ï¼ˆå¿«é€Ÿè¿­ä»£ï¼‰
å¤æ‚é‡æ„ï¼šClaude <span class="hljs-selector-tag">Code</span>ï¼ˆæ·±åº¦æ€è€ƒï¼‰
å­¦ä¹ æ¢ç´¢ï¼šä¸¤è€…ç»“åˆä½¿ç”¨
</code></pre>
<h4 data-id="heading-26"><strong>4.3.3 GitHub Copilot</strong></h4>
<p><strong>å®šä½ï¼š</strong> GitHubå®˜æ–¹ï¼Œé›†æˆåº¦æœ€é«˜ã€‚</p>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… æ— ç¼é›†æˆGitHubç”Ÿæ€</li>
<li>âœ… æ”¯æŒå‡ ä¹æ‰€æœ‰IDE</li>
<li>âœ… ä¼ä¸šç‰ˆå®‰å…¨åˆè§„</li>
<li>âœ… ChatåŠŸèƒ½å¢å¼º</li>
</ul>
<p><strong>é€‚åˆï¼š</strong></p>
<ul>
<li>ä½¿ç”¨VS Code/JetBrainsçš„å›¢é˜Ÿ</li>
<li>éœ€è¦ä¼ä¸šçº§å®‰å…¨çš„å…¬å¸</li>
<li>GitHubæ·±åº¦ç”¨æˆ·</li>
</ul>
<h4 data-id="heading-27"><strong>4.3.4 å…¶ä»–å·¥å…·ç®€ä»‹</strong></h4>






























<table><thead><tr><th>å·¥å…·</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Codeium</strong></td><td>å…è´¹ã€éšç§ä¿æŠ¤</td><td>ä¸ªäººå¼€å‘è€…ã€åˆå­¦è€…</td></tr><tr><td><strong>Tabnine</strong></td><td>æœ¬åœ°è¿è¡Œã€ä¼ä¸šçº§</td><td>å¯¹æ•°æ®å®‰å…¨è¦æ±‚é«˜çš„ä¼ä¸š</td></tr><tr><td><strong>Amazon Q</strong></td><td>AWSç”Ÿæ€é›†æˆ</td><td>ä½¿ç”¨AWSæœåŠ¡çš„å›¢é˜Ÿ</td></tr><tr><td><strong>Windsurf</strong></td><td>æ–°å…´å·¥å…·ï¼Œæµå¼ä½“éªŒ</td><td>å°é²œç”¨æˆ·</td></tr></tbody></table>
<h3 data-id="heading-28">4.4 å·¥å…·é€‰æ‹©å†³ç­–æ ‘</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[é€‰æ‹©AI Codingå·¥å…·] --&gt; B{é¢„ç®—?}
    B --&gt;|æœ‰é™| C{éœ€è¦IDEé›†æˆ?}
    B --&gt;|å……è¶³| D{ä¸»è¦ç”¨é€”?}

    C --&gt;|æ˜¯| E[Codeiumå…è´¹ç‰ˆ]
    C --&gt;|å¦| F[Claude Code API]

    D --&gt;|æ—¥å¸¸å¼€å‘| G{ä½¿ç”¨VS Code?}
    D --&gt;|å¤æ‚ä»»åŠ¡| H[Claude Code]
    D --&gt;|å›¢é˜Ÿåä½œ| I[GitHub Copilotä¼ä¸šç‰ˆ]

    G --&gt;|æ˜¯| J[Cursor]
    G --&gt;|å¦| K[JetBrains AI]

    E --&gt; L[å¼€å§‹ä½¿ç”¨]
    F --&gt; L
    H --&gt; L
    I --&gt; L
    J --&gt; L
    K --&gt; L

    style L fill:#e1ffe1
</code></pre>
<h3 data-id="heading-29">4.5 AI Codingæœ€ä½³å®è·µ</h3>
<h4 data-id="heading-30"><strong>4.5.1 æç¤ºè¯æŠ€å·§</strong></h4>
<p><strong>1. æä¾›è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡</strong></p>
<p>âŒ ä¸å¥½çš„æç¤ºï¼š</p>
<pre><code class="hljs">å¸®æˆ‘å†™ä¸ªç”¨æˆ·æœåŠ¡
</code></pre>
<p>âœ… å¥½çš„æç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">é¡¹ç›®ï¼šSpring Boot 3.2 + MyBatis Plus
éœ€æ±‚ï¼šåˆ›å»ºUserServiceï¼ŒåŒ…å«CRUDæ“ä½œ
è¦æ±‚ï¼š
<span class="hljs-bullet">1.</span> ä½¿ç”¨@Serviceæ³¨è§£
<span class="hljs-bullet">2.</span> é›†æˆRedisç¼“å­˜
<span class="hljs-bullet">3.</span> æ·»åŠ äº‹åŠ¡ç®¡ç†
<span class="hljs-bullet">4.</span> å‚æ•°æ ¡éªŒä½¿ç”¨JSR-303
<span class="hljs-bullet">5.</span> ç»Ÿä¸€å¼‚å¸¸å¤„ç†
</code></pre>
<p><strong>2. æ˜ç¡®æŠ€æœ¯æ ˆå’Œçº¦æŸ</strong></p>
<pre><code class="hljs language-diff" lang="diff">æŠ€æœ¯æ ˆï¼š
<span class="hljs-deletion">- JDK 17</span>
<span class="hljs-deletion">- Spring Boot 3.2</span>
<span class="hljs-deletion">- MySQL 8.0</span>
<span class="hljs-deletion">- Redis 7.0</span>

çº¦æŸï¼š
<span class="hljs-deletion">- éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘è§„èŒƒ</span>
<span class="hljs-deletion">- ä½¿ç”¨Lombokå‡å°‘æ ·æ¿ä»£ç </span>
<span class="hljs-deletion">- æ—¥å¿—ä½¿ç”¨SLF4J</span>
<span class="hljs-deletion">- è¿”å›ç»Ÿä¸€çš„Resultå¯¹è±¡</span>
</code></pre>
<p><strong>3. ä½¿ç”¨ç¤ºä¾‹é©±åŠ¨</strong></p>
<pre><code class="hljs language-less" lang="less">å‚è€ƒä»¥ä¸‹ä»£ç é£æ ¼ï¼š

<span class="hljs-variable">@Service</span>
<span class="hljs-variable">@Slf4j</span>
public class OrderService {

    <span class="hljs-variable">@Resource</span>
    private OrderMapper orderMapper;

    <span class="hljs-variable">@Cacheable</span>(value = <span class="hljs-string">"order"</span>, key = <span class="hljs-string">"#id"</span>)
    public OrderDTO <span class="hljs-built_in">getById</span>(Long id) {
        <span class="hljs-comment">// ...</span>
    }
}

è¯·æŒ‰ç›¸åŒé£æ ¼å®ç°UserService
</code></pre>
<h4 data-id="heading-31"><strong>4.5.2 ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•</strong></h4>
<p>AIç”Ÿæˆä»£ç åï¼Œå¿…é¡»æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((ä»£ç å®¡æŸ¥))
    åŠŸèƒ½æ­£ç¡®æ€§
      é€»è¾‘æ˜¯å¦æ­£ç¡®
      è¾¹ç•Œæ¡ä»¶å¤„ç†
      å¼‚å¸¸å¤„ç†
    å®‰å…¨æ€§
      SQLæ³¨å…¥
      XSSæ”»å‡»
      æ•æ„Ÿä¿¡æ¯æ³„éœ²
    æ€§èƒ½
      æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
      ç¼“å­˜ä½¿ç”¨
      èµ„æºé‡Šæ”¾
    ä»£ç è´¨é‡
      å‘½åè§„èŒƒ
      æ³¨é‡Šå®Œæ•´æ€§
      å¯è¯»æ€§
    å·¥ç¨‹è§„èŒƒ
      æ—¥å¿—è®°å½•
      äº‹åŠ¡ç®¡ç†
      é”™è¯¯ç ç»Ÿä¸€
</code></pre>
<h4 data-id="heading-32"><strong>4.5.3 è¿­ä»£å¼å¼€å‘æµç¨‹</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant D as å¼€å‘è€…
    participant AI as AIå·¥å…·
    participant C as ä»£ç åº“
    participant T as æµ‹è¯•

    D-&gt;&gt;AI: 1. æè¿°éœ€æ±‚ï¼ˆé«˜å±‚æ¬¡ï¼‰
    AI--&gt;&gt;D: 2. ç”Ÿæˆæ¶æ„è®¾è®¡
    D-&gt;&gt;D: 3. Reviewè®¾è®¡ï¼Œæå‡ºè°ƒæ•´
    D-&gt;&gt;AI: 4. ç»†åŒ–å…·ä½“æ¨¡å—
    AI--&gt;&gt;C: 5. ç”Ÿæˆä»£ç 
    D-&gt;&gt;T: 6. è¿è¡Œæµ‹è¯•
    T--&gt;&gt;D: 7. æµ‹è¯•ç»“æœ
    alt æµ‹è¯•å¤±è´¥
        D-&gt;&gt;AI: 8a. åé¦ˆé”™è¯¯ä¿¡æ¯
        AI--&gt;&gt;C: 9a. ä¿®å¤ä»£ç 
    else æµ‹è¯•é€šè¿‡
        D-&gt;&gt;AI: 8b. è¦æ±‚ä¼˜åŒ–
        AI--&gt;&gt;C: 9b. é‡æ„ä¼˜åŒ–
    end
    D-&gt;&gt;D: 10. æœ€ç»ˆReview
</code></pre>
<hr/>
<h2 data-id="heading-33">5. AIå·¥ç¨‹åŒ–å®è·µï¼šä»æ¦‚å¿µåˆ°è½åœ°</h2>
<h3 data-id="heading-34">5.1 AIåº”ç”¨æ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-35"><strong>5.1.1 æ•´ä½“æ¶æ„</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;ç”¨æˆ·å±‚&amp;#34;
        U1[Webå‰ç«¯]
        U2[ç§»åŠ¨ç«¯]
        U3[APIè°ƒç”¨]
    end

    subgraph &amp;#34;åº”ç”¨å±‚ - Spring Boot&amp;#34;
        A1[Controllerå±‚]
        A2[Serviceå±‚]
        A3[AI Serviceå±‚]
    end

    subgraph &amp;#34;AIæ¡†æ¶å±‚&amp;#34;
        F1[Spring AI Alibaba]
        F2[LangChain4j]
    end

    subgraph &amp;#34;AIèƒ½åŠ›å±‚&amp;#34;
        C1[Chatå¯¹è¯]
        C2[RAGæ£€ç´¢]
        C3[Agentæ‰§è¡Œ]
        C4[Embedding]
    end

    subgraph &amp;#34;æ¨¡å‹å±‚&amp;#34;
        M1[é€šä¹‰åƒé—®]
        M2[Claude]
        M3[GPT-4]
    end

    subgraph &amp;#34;æ•°æ®å±‚&amp;#34;
        D1[(MySQL)]
        D2[(å‘é‡æ•°æ®åº“)]
        D3[(Redis)]
    end

    U1 &amp; U2 &amp; U3 --&gt; A1
    A1 --&gt; A2
    A2 --&gt; A3
    A3 --&gt; F1 &amp; F2
    F1 &amp; F2 --&gt; C1 &amp; C2 &amp; C3 &amp; C4
    C1 &amp; C2 &amp; C3 &amp; C4 --&gt; M1 &amp; M2 &amp; M3
    A2 &amp; A3 --&gt; D1 &amp; D2 &amp; D3

    style A3 fill:#e1f5ff
    style F1 fill:#fff4e1
    style F2 fill:#fff4e1
</code></pre>
<h4 data-id="heading-36"><strong>5.1.2 åˆ†å±‚è®¾è®¡åŸåˆ™</strong></h4>
<p><strong>1. æ§åˆ¶å±‚ï¼ˆControllerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/ai/chat")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatService chatService;

    <span class="hljs-meta">@PostMapping("/stream")</span>
    <span class="hljs-keyword">public</span> SseEmitter <span class="hljs-title function_">chatStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest request)</span> {
        <span class="hljs-comment">// å¤„ç†æµå¼å“åº”</span>
        <span class="hljs-keyword">return</span> chatService.streamChat(request);
    }

    <span class="hljs-meta">@PostMapping("/sync")</span>
    <span class="hljs-keyword">public</span> Result&lt;ChatResponse&gt; <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest request)</span> {
        <span class="hljs-comment">// åŒæ­¥å“åº”</span>
        <span class="hljs-keyword">return</span> Result.success(chatService.chat(request));
    }
}
</code></pre>
<p><strong>2. æœåŠ¡å±‚ï¼ˆServiceï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;  <span class="hljs-comment">// Spring AI</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ConversationService conversationService;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> RagService ragService;

    <span class="hljs-keyword">public</span> ChatResponse <span class="hljs-title function_">chat</span><span class="hljs-params">(ChatRequest request)</span> {
        <span class="hljs-comment">// 1. åŠ è½½å†å²å¯¹è¯</span>
        List&lt;Message&gt; history = conversationService.getHistory(request.getSessionId());

        <span class="hljs-comment">// 2. RAGæ£€ç´¢</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> ragService.retrieve(request.getQuestion());

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> buildPrompt(request.getQuestion(), context);

        <span class="hljs-comment">// 4. è°ƒç”¨å¤§æ¨¡å‹</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(prompt);

        <span class="hljs-comment">// 5. ä¿å­˜å¯¹è¯</span>
        conversationService.save(request.getSessionId(), request.getQuestion(), response);

        <span class="hljs-keyword">return</span> ChatResponse.builder()
            .answer(response)
            .sessionId(request.getSessionId())
            .build();
    }
}
</code></pre>
<h3 data-id="heading-37">5.2 Javaç”Ÿæ€AIæ¡†æ¶æ·±åº¦å¯¹æ¯”</h3>
<h4 data-id="heading-38"><strong>5.2.1 Spring AI Alibabaè¯¦è§£</strong></h4>
<p><strong>å®šä½ï¼š</strong> é˜¿é‡Œäº‘å®˜æ–¹AIæ¡†æ¶ï¼Œæ·±åº¦é›†æˆé˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°ï¼Œä¹Ÿæ”¯æŒOpenAIç­‰ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((Spring AI Alibaba))
    ç»Ÿä¸€æŠ½è±¡
      ChatClient
      ImageClient
      AudioClient
      EmbeddingClient
    æ¨¡å‹æ”¯æŒ
      é€šä¹‰åƒé—®
      é€šä¹‰ä¸‡ç›¸
      ç™¾ç‚¼å¹³å°
      OpenAIå…¼å®¹
    RAGæ”¯æŒ
      DocumentReader
      VectorStore
      Retriever
    Springé›†æˆ
      è‡ªåŠ¨é…ç½®
      ä¾èµ–æ³¨å…¥
      é…ç½®å±æ€§
    ä¼ä¸šç‰¹æ€§
      å¯è§‚æµ‹æ€§
      é™æµé™çº§
      å®‰å…¨å®¡è®¡
</code></pre>
<p><strong>å¿«é€Ÿå¼€å§‹ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- Mavenä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-ai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0-M2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">dashscope:</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">${DASHSCOPE_API_KEY}</span>
      <span class="hljs-attr">chat:</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">qwen-max</span>
          <span class="hljs-attr">temperature:</span> <span class="hljs-number">0.7</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">return</span> chatClient.call(message);
    }

    <span class="hljs-comment">// æµå¼å“åº”</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">streamChat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">return</span> chatClient.stream(message)
            .map(ChatResponse::getResult)
            .map(result -&gt; result.getOutput().getContent());
    }
}
</code></pre>
<p><strong>RAGå®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RagConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> VectorStore <span class="hljs-title function_">vectorStore</span><span class="hljs-params">(EmbeddingClient embeddingClient)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleVectorStore</span>(embeddingClient);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DocumentReader <span class="hljs-title function_">pdfReader</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagePdfDocumentReader</span>(<span class="hljs-string">"classpath:docs/manual.pdf"</span>);
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RagService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> VectorStore vectorStore;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">ragChat</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        List&lt;Document&gt; docs = vectorStore.similaritySearch(
            SearchRequest.query(question).withTopK(<span class="hljs-number">3</span>)
        );

        <span class="hljs-comment">// 2. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> docs.stream()
            .map(Document::getContent)
            .collect(Collectors.joining(<span class="hljs-string">"\n"</span>));

        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> <span class="hljs-string">"""
            åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š

            %s

            é—®é¢˜ï¼š%s
            """</span>.formatted(context, question);

        <span class="hljs-comment">// 3. è°ƒç”¨å¤§æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> chatClient.call(prompt);
    }
}
</code></pre>
<h4 data-id="heading-39"><strong>5.2.2 LangChain4jè¯¦è§£</strong></h4>
<p><strong>å®šä½ï¼š</strong> Javaç‰ˆLangChainï¼ŒåŠŸèƒ½æœ€å…¨é¢çš„Java AIæ¡†æ¶ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[LangChain4j] --&gt; B[æ¨¡å‹æŠ½è±¡]
    A --&gt; C[AI Services]
    A --&gt; D[Tools/Agents]
    A --&gt; E[RAGé“¾è·¯]
    A --&gt; F[Memoryç®¡ç†]

    B --&gt; B1[20+æ¨¡å‹æ”¯æŒ]
    B --&gt; B2[ç»Ÿä¸€æ¥å£]

    C --&gt; C1[æ¥å£å¼AI]
    C --&gt; C2[è‡ªåŠ¨Prompt]

    D --&gt; D1[å‡½æ•°è°ƒç”¨]
    D --&gt; D2[ReAct Agent]

    E --&gt; E1[æ–‡æ¡£åŠ è½½å™¨]
    E --&gt; E2[å‘é‡å­˜å‚¨]
    E --&gt; E3[æ£€ç´¢å™¨]

    F --&gt; F1[å¯¹è¯è®°å¿†]
    F --&gt; F2[Tokenç®¡ç†]
</code></pre>
<p><strong>å¿«é€Ÿå¼€å§‹ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.35.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-open-ai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.35.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AI Services - æ¥å£å¼ç¼–ç¨‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Assistant</span> {

    <span class="hljs-meta">@SystemMessage("ä½ æ˜¯ä¸€ä¸ªJavaä¸“å®¶ï¼Œå¸®åŠ©å¼€å‘è€…è§£å†³æŠ€æœ¯é—®é¢˜")</span>
    String <span class="hljs-title function_">chat</span><span class="hljs-params">(String userMessage)</span>;

    <span class="hljs-meta">@UserMessage("""
        åˆ†æä»¥ä¸‹ä»£ç çš„é—®é¢˜ï¼š
        ```java
        {{code}}
        ```
        """)</span>
    String <span class="hljs-title function_">analyzeCode</span><span class="hljs-params">(<span class="hljs-meta">@V("code")</span> String code)</span>;
}

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LangChain4jConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Assistant <span class="hljs-title function_">assistant</span><span class="hljs-params">(<span class="hljs-meta">@Value("${openai.api.key}")</span> String apiKey)</span> {
        <span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(apiKey)
            .modelName(GPT_4_O)
            .temperature(<span class="hljs-number">0.7</span>)
            .build();

        <span class="hljs-keyword">return</span> AiServices.create(Assistant.class, model);
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeReviewService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> Assistant assistant;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">reviewCode</span><span class="hljs-params">(String code)</span> {
        <span class="hljs-keyword">return</span> assistant.analyzeCode(code);
    }
}
</code></pre>
<p><strong>Toolsï¼ˆå‡½æ•°è°ƒç”¨ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰å·¥å…·</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseTools</span> {

    <span class="hljs-meta">@Tool("æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserInfo</span><span class="hljs-params">(<span class="hljs-meta">@P("ç”¨æˆ·ID")</span> Long userId)</span> {
        <span class="hljs-comment">// å®é™…æ•°æ®åº“æŸ¥è¯¢</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userMapper.selectById(userId);
        <span class="hljs-keyword">return</span> JSON.toJSONString(user);
    }

    <span class="hljs-meta">@Tool("æ›´æ–°ç”¨æˆ·çŠ¶æ€")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">updateUserStatus</span><span class="hljs-params">(
        <span class="hljs-meta">@P("ç”¨æˆ·ID")</span> Long userId,
        <span class="hljs-meta">@P("çŠ¶æ€")</span> String status)</span> {
        userMapper.updateStatus(userId, status);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ›´æ–°æˆåŠŸ"</span>;
    }
}

<span class="hljs-comment">// é…ç½®Agent</span>
<span class="hljs-meta">@Bean</span>
<span class="hljs-keyword">public</span> Assistant <span class="hljs-title function_">agentAssistant</span><span class="hljs-params">()</span> {
    <span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
        .apiKey(apiKey)
        .modelName(GPT_4_O)
        .build();

    <span class="hljs-keyword">return</span> AiServices.builder(Assistant.class)
        .chatLanguageModel(model)
        .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseTools</span>())  <span class="hljs-comment">// æ³¨å†Œå·¥å…·</span>
        .chatMemory(MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>))
        .build();
}
</code></pre>
<p><strong>RAGå®Œæ•´å®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentRagService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmbeddingStore&lt;TextSegment&gt; embeddingStore;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmbeddingModel embeddingModel;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatLanguageModel chatModel;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DocumentRagService</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. åˆå§‹åŒ–Embeddingæ¨¡å‹</span>
        <span class="hljs-built_in">this</span>.embeddingModel = OpenAiEmbeddingModel.builder()
            .apiKey(apiKey)
            .modelName(<span class="hljs-string">"text-embedding-3-small"</span>)
            .build();

        <span class="hljs-comment">// 2. åˆå§‹åŒ–å‘é‡æ•°æ®åº“</span>
        <span class="hljs-built_in">this</span>.embeddingStore = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryEmbeddingStore</span>&lt;&gt;();

        <span class="hljs-comment">// 3. åˆå§‹åŒ–Chatæ¨¡å‹</span>
        <span class="hljs-built_in">this</span>.chatModel = OpenAiChatModel.builder()
            .apiKey(apiKey)
            .modelName(GPT_4_O)
            .build();

        <span class="hljs-comment">// 4. åŠ è½½æ–‡æ¡£</span>
        loadDocuments();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadDocuments</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¯»å–æ–‡æ¡£</span>
        <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> FileSystemDocumentLoader.loadDocument(
            <span class="hljs-string">"docs/knowledge.pdf"</span>,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApachePdfBoxDocumentParser</span>()
        );

        <span class="hljs-comment">// æ–‡æ¡£åˆ†å—</span>
        <span class="hljs-type">DocumentSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> DocumentSplitters.recursive(
            <span class="hljs-number">500</span>,  <span class="hljs-comment">// chunk size</span>
            <span class="hljs-number">50</span>    <span class="hljs-comment">// overlap</span>
        );
        List&lt;TextSegment&gt; segments = splitter.split(document);

        <span class="hljs-comment">// å‘é‡åŒ–å¹¶å­˜å‚¨</span>
        List&lt;Embedding&gt; embeddings = embeddingModel.embedAll(segments).content();
        embeddingStore.addAll(embeddings, segments);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">ragQuery</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        <span class="hljs-type">Embedding</span> <span class="hljs-variable">questionEmbedding</span> <span class="hljs-operator">=</span> embeddingModel.embed(question).content();
        List&lt;EmbeddingMatch&lt;TextSegment&gt;&gt; matches = embeddingStore.findRelevant(
            questionEmbedding,
            <span class="hljs-number">3</span>,  <span class="hljs-comment">// top-k</span>
            <span class="hljs-number">0.7</span> <span class="hljs-comment">// æœ€å°ç›¸ä¼¼åº¦</span>
        );

        <span class="hljs-comment">// 2. æ„å»ºä¸Šä¸‹æ–‡</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> matches.stream()
            .map(match -&gt; match.embedded().text())
            .collect(Collectors.joining(<span class="hljs-string">"\n\n"</span>));

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> PromptTemplate.from(<span class="hljs-string">"""
            åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š

            {{context}}

            é—®é¢˜ï¼š{{question}}

            è¦æ±‚ï¼š
            1. åªåŸºäºæä¾›çš„ä¿¡æ¯å›ç­”
            2. å¦‚æœä¿¡æ¯ä¸è¶³ï¼Œæ˜ç¡®è¯´æ˜
            3. ç»™å‡ºä¿¡æ¯æ¥æº
            """</span>)
            .apply(Map.of(
                <span class="hljs-string">"context"</span>, context,
                <span class="hljs-string">"question"</span>, question
            ))
            .text();

        <span class="hljs-comment">// 4. ç”Ÿæˆç­”æ¡ˆ</span>
        <span class="hljs-keyword">return</span> chatModel.generate(prompt);
    }
}
</code></pre>
<h4 data-id="heading-40"><strong>5.2.3 æ¡†æ¶å¯¹æ¯”æ€»ç»“</strong></h4>























































<table><thead><tr><th>ç»´åº¦</th><th>Spring AI Alibaba</th><th>LangChain4j</th></tr></thead><tbody><tr><td><strong>å®šä½</strong></td><td>Springç”Ÿæ€é›†æˆï¼Œå›½å†…ä¼˜åŒ–</td><td>åŠŸèƒ½å…¨é¢ï¼Œç¤¾åŒºæ´»è·ƒ</td></tr><tr><td><strong>ä¸Šæ‰‹éš¾åº¦</strong></td><td>ç®€å•ï¼ˆSpringå¼€å‘è€…ï¼‰</td><td>ä¸­ç­‰</td></tr><tr><td><strong>æ–‡æ¡£</strong></td><td>ä¸­æ–‡æ–‡æ¡£å®Œå–„</td><td>è‹±æ–‡ä¸ºä¸»ï¼Œç¤ºä¾‹ä¸°å¯Œ</td></tr><tr><td><strong>æ¨¡å‹æ”¯æŒ</strong></td><td>ä¾§é‡é˜¿é‡Œäº‘ã€OpenAIå…¼å®¹</td><td>20+ä¸»æµæ¨¡å‹</td></tr><tr><td><strong>åŠŸèƒ½ä¸°å¯Œåº¦</strong></td><td>æ ¸å¿ƒåŠŸèƒ½</td><td>éå¸¸å…¨é¢ï¼ˆToolsã€Agentç­‰ï¼‰</td></tr><tr><td><strong>ç”Ÿæ€é›†æˆ</strong></td><td>Spring Bootæ·±åº¦é›†æˆ</td><td>å¤šæ¡†æ¶æ”¯æŒ</td></tr><tr><td><strong>ä¼ä¸šç‰¹æ€§</strong></td><td>å¯è§‚æµ‹æ€§ã€é™æµç­‰</td><td>éœ€è‡ªè¡Œé›†æˆ</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ä½¿ç”¨é˜¿é‡Œäº‘ã€Springé¡¹ç›®</td><td>å¤æ‚AIåº”ç”¨ã€å¤šæ¨¡å‹åˆ‡æ¢</td></tr><tr><td><strong>å¼€æºæ´»è·ƒåº¦</strong></td><td>è¾ƒæ–°ï¼Œå¿«é€Ÿè¿­ä»£</td><td>éå¸¸æ´»è·ƒ</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[é€‰æ‹©æ¡†æ¶] --&gt; B{ä½¿ç”¨é˜¿é‡Œäº‘?}
    B --&gt;|æ˜¯| C[Spring AI Alibaba]
    B --&gt;|å¦| D{éœ€è¦å¤æ‚Agent?}

    D --&gt;|æ˜¯| E[LangChain4j]
    D --&gt;|å¦| F{å›¢é˜Ÿç†Ÿæ‚‰Spring?}

    F --&gt;|æ˜¯| G[Spring AI Alibaba]
    F --&gt;|å¦| E

    C --&gt; H[å¼€å§‹å¼€å‘]
    E --&gt; H
    G --&gt; H

    style H fill:#e1ffe1
</code></pre>
<h3 data-id="heading-41">5.3 AIå·¥ç¨‹åŒ–æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-42"><strong>5.3.1 é¡¹ç›®ç»“æ„è®¾è®¡</strong></h4>
<pre><code class="hljs language-bash" lang="bash">my-ai-application/
â”œâ”€â”€ src/main/java/
â”‚   â”œâ”€â”€ config/                 <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚   â”‚   â”œâ”€â”€ AiConfig.java      <span class="hljs-comment"># AIæ¡†æ¶é…ç½®</span>
â”‚   â”‚   â”œâ”€â”€ VectorStoreConfig.java
â”‚   â”‚   â””â”€â”€ PromptConfig.java
â”‚   â”œâ”€â”€ controller/            <span class="hljs-comment"># æ§åˆ¶å™¨</span>
â”‚   â”‚   â”œâ”€â”€ ChatController.java
â”‚   â”‚   â””â”€â”€ RagController.java
â”‚   â”œâ”€â”€ service/               <span class="hljs-comment"># ä¸šåŠ¡æœåŠ¡</span>
â”‚   â”‚   â”œâ”€â”€ ChatService.java
â”‚   â”‚   â”œâ”€â”€ RagService.java
â”‚   â”‚   â””â”€â”€ AgentService.java
â”‚   â”œâ”€â”€ ai/                    <span class="hljs-comment"># AIæ ¸å¿ƒ</span>
â”‚   â”‚   â”œâ”€â”€ prompt/           <span class="hljs-comment"># Promptç®¡ç†</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ PromptTemplate.java
â”‚   â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚   â”‚       â”œâ”€â”€ chat.txt
â”‚   â”‚   â”‚       â””â”€â”€ rag.txt
â”‚   â”‚   â”œâ”€â”€ tools/            <span class="hljs-comment"># AIå·¥å…·</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ DatabaseTool.java
â”‚   â”‚   â”‚   â””â”€â”€ ApiTool.java
â”‚   â”‚   â”œâ”€â”€ chain/            <span class="hljs-comment"># æ‰§è¡Œé“¾</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ RagChain.java
â”‚   â”‚   â”‚   â””â”€â”€ AgentChain.java
â”‚   â”‚   â””â”€â”€ memory/           <span class="hljs-comment"># è®°å¿†ç®¡ç†</span>
â”‚   â”‚       â””â”€â”€ ConversationMemory.java
â”‚   â”œâ”€â”€ domain/               <span class="hljs-comment"># é¢†åŸŸæ¨¡å‹</span>
â”‚   â”œâ”€â”€ repository/           <span class="hljs-comment"># æ•°æ®è®¿é—®</span>
â”‚   â””â”€â”€ utils/                <span class="hljs-comment"># å·¥å…·ç±»</span>
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ prompts/              <span class="hljs-comment"># Promptæ¨¡æ¿</span>
â”‚   â”‚   â”œâ”€â”€ system.txt
â”‚   â”‚   â”œâ”€â”€ user.txt
â”‚   â”‚   â””â”€â”€ rag.txt
â”‚   â”œâ”€â”€ documents/            <span class="hljs-comment"># çŸ¥è¯†åº“æ–‡æ¡£</span>
â”‚   â””â”€â”€ application.yml
â””â”€â”€ src/test/
</code></pre>
<h4 data-id="heading-43"><strong>5.3.2 Promptç®¡ç†</strong></h4>
<p><strong>1. æ¨¡æ¿åŒ–ç®¡ç†</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptTemplateManager</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, String&gt; templates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadTemplates</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä»æ–‡ä»¶åŠ è½½</span>
        templates.put(<span class="hljs-string">"chat"</span>, loadFromFile(<span class="hljs-string">"prompts/chat.txt"</span>));
        templates.put(<span class="hljs-string">"rag"</span>, loadFromFile(<span class="hljs-string">"prompts/rag.txt"</span>));
        templates.put(<span class="hljs-string">"code_review"</span>, loadFromFile(<span class="hljs-string">"prompts/code_review.txt"</span>));
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPrompt</span><span class="hljs-params">(String templateName, Map&lt;String, String&gt; variables)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">template</span> <span class="hljs-operator">=</span> templates.get(templateName);
        <span class="hljs-keyword">return</span> replaceVariables(template, variables);
    }
}
</code></pre>
<p><strong>2. Promptç‰ˆæœ¬æ§åˆ¶</strong></p>
<pre><code class="hljs language-rust" lang="rust">prompts/
â”œâ”€â”€ v1/
â”‚   â”œâ”€â”€ chat.txt
â”‚   â””â”€â”€ rag.txt
â”œâ”€â”€ v2/
â”‚   â”œâ”€â”€ chat.txt
â”‚   â””â”€â”€ rag.txt
â””â”€â”€ current <span class="hljs-punctuation">-&gt;</span> v2/
</code></pre>
<p><strong>3. A/Bæµ‹è¯•æ¡†æ¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptExperimentService</span> {

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithExperiment</span><span class="hljs-params">(String message, String userId)</span> {
        <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·åˆ†ç»„é€‰æ‹©ä¸åŒPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">promptVersion</span> <span class="hljs-operator">=</span> getUserGroup(userId);
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> promptManager.getPrompt(promptVersion, Map.of(<span class="hljs-string">"message"</span>, message));

        <span class="hljs-comment">// è®°å½•å®éªŒæ•°æ®</span>
        experimentTracker.track(userId, promptVersion, message);

        <span class="hljs-keyword">return</span> chatClient.call(prompt);
    }
}
</code></pre>
<h4 data-id="heading-44"><strong>5.3.3 æ¨¡å‹ç®¡ç†</strong></h4>
<p><strong>1. å¤šæ¨¡å‹ç­–ç•¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelRouter</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient gpt4Client;     <span class="hljs-comment">// å¤æ‚ä»»åŠ¡</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient gpt35Client;    <span class="hljs-comment">// ç®€å•ä»»åŠ¡</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient qwenClient;     <span class="hljs-comment">// å¤‡ç”¨æ¨¡å‹</span>

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// æ ¹æ®å¤æ‚åº¦è·¯ç”±</span>
        <span class="hljs-keyword">if</span> (isComplexQuery(message)) {
            <span class="hljs-keyword">return</span> gpt4Client.call(message);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> gpt35Client.call(message);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isComplexQuery</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// ç®€å•åˆ¤æ–­é€»è¾‘</span>
        <span class="hljs-keyword">return</span> message.length() &gt; <span class="hljs-number">200</span> ||
               message.contains(<span class="hljs-string">"åˆ†æ"</span>) ||
               message.contains(<span class="hljs-string">"è®¾è®¡"</span>);
    }
}
</code></pre>
<p><strong>2. é™çº§ç­–ç•¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FallbackService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ModelRouter modelRouter;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> CacheManager cacheManager;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithFallback</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä¸»æ¨¡å‹</span>
            <span class="hljs-keyword">return</span> modelRouter.chat(message);
        } <span class="hljs-keyword">catch</span> (RateLimitException e) {
            <span class="hljs-comment">// é™çº§åˆ°å¤‡ç”¨æ¨¡å‹</span>
            log.warn(<span class="hljs-string">"ä¸»æ¨¡å‹é™æµï¼Œåˆ‡æ¢å¤‡ç”¨æ¨¡å‹"</span>);
            <span class="hljs-keyword">return</span> qwenClient.call(message);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è¿”å›ç¼“å­˜ç»“æœ</span>
            <span class="hljs-keyword">return</span> cacheManager.getCachedResponse(message)
                .orElse(<span class="hljs-string">"æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•"</span>);
        }
    }
}
</code></pre>
<h4 data-id="heading-45"><strong>5.3.4 ç›‘æ§ä¸å¯è§‚æµ‹</strong></h4>
<p><strong>1. æŒ‡æ ‡ç›‘æ§</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiMetricsAspect</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> MeterRegistry meterRegistry;

    <span class="hljs-meta">@Around("@annotation(AiMonitored)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">monitor</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable {
        Timer.<span class="hljs-type">Sample</span> <span class="hljs-variable">sample</span> <span class="hljs-operator">=</span> Timer.start(meterRegistry);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> pjp.proceed();

            <span class="hljs-comment">// è®°å½•æˆåŠŸ</span>
            sample.stop(Timer.builder(<span class="hljs-string">"ai.call"</span>)
                .tag(<span class="hljs-string">"method"</span>, pjp.getSignature().getName())
                .tag(<span class="hljs-string">"status"</span>, <span class="hljs-string">"success"</span>)
                .register(meterRegistry));

            <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è®°å½•å¤±è´¥</span>
            sample.stop(Timer.builder(<span class="hljs-string">"ai.call"</span>)
                .tag(<span class="hljs-string">"method"</span>, pjp.getSignature().getName())
                .tag(<span class="hljs-string">"status"</span>, <span class="hljs-string">"error"</span>)
                .tag(<span class="hljs-string">"error"</span>, e.getClass().getSimpleName())
                .register(meterRegistry));
            <span class="hljs-keyword">throw</span> e;
        }
    }
}
</code></pre>
<p><strong>2. æ—¥å¿—è®°å½•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiLogger</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> AiLogRepository logRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInteraction</span><span class="hljs-params">(String sessionId, String input, String output,
                               <span class="hljs-type">long</span> latency, <span class="hljs-type">int</span> tokens)</span> {
        <span class="hljs-type">AiLog</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> AiLog.builder()
            .sessionId(sessionId)
            .input(input)
            .output(output)
            .latency(latency)
            .tokens(tokens)
            .cost(calculateCost(tokens))
            .timestamp(LocalDateTime.now())
            .build();

        logRepository.save(log);
    }

    <span class="hljs-keyword">private</span> BigDecimal <span class="hljs-title function_">calculateCost</span><span class="hljs-params">(<span class="hljs-type">int</span> tokens)</span> {
        <span class="hljs-comment">// æ ¹æ®Tokenæ•°è®¡ç®—æˆæœ¬</span>
        <span class="hljs-keyword">return</span> BigDecimal.valueOf(tokens)
            .multiply(BigDecimal.valueOf(<span class="hljs-number">0.00001</span>));
    }
}
</code></pre>
<p><strong>3. é“¾è·¯è¿½è¸ª</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TracedChatService</span> {

    <span class="hljs-meta">@NewSpan("ai.chat")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@SpanTag("session.id")</span> String sessionId,
                       <span class="hljs-meta">@SpanTag("input")</span> String message)</span> {

        <span class="hljs-type">Span</span> <span class="hljs-variable">currentSpan</span> <span class="hljs-operator">=</span> tracer.currentSpan();

        <span class="hljs-comment">// æ£€ç´¢é˜¶æ®µ</span>
        currentSpan.tag(<span class="hljs-string">"stage"</span>, <span class="hljs-string">"retrieve"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> ragService.retrieve(message);
        currentSpan.tag(<span class="hljs-string">"retrieved.docs"</span>, String.valueOf(context.split(<span class="hljs-string">"\n"</span>).length));

        <span class="hljs-comment">// ç”Ÿæˆé˜¶æ®µ</span>
        currentSpan.tag(<span class="hljs-string">"stage"</span>, <span class="hljs-string">"generate"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(buildPrompt(message, context));
        currentSpan.tag(<span class="hljs-string">"response.length"</span>, String.valueOf(response.length()));

        <span class="hljs-keyword">return</span> response;
    }
}
</code></pre>
<h4 data-id="heading-46"><strong>5.3.5 æµ‹è¯•ç­–ç•¥</strong></h4>
<p><strong>1. å•å…ƒæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatServiceTest</span> {

    <span class="hljs-meta">@MockBean</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatService chatService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testChat</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Mock</span>
        when(chatClient.call(anyString()))
            .thenReturn(<span class="hljs-string">"è¿™æ˜¯æµ‹è¯•å›å¤"</span>);

        <span class="hljs-comment">// æ‰§è¡Œ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatService.chat(<span class="hljs-string">"æµ‹è¯•é—®é¢˜"</span>);

        <span class="hljs-comment">// éªŒè¯</span>
        assertThat(response).isEqualTo(<span class="hljs-string">"è¿™æ˜¯æµ‹è¯•å›å¤"</span>);
        verify(chatClient).call(anyString());
    }
}
</code></pre>
<p><strong>2. Promptæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testPromptQuality</span><span class="hljs-params">()</span> {
    List&lt;TestCase&gt; testCases = loadTestCases();

    <span class="hljs-keyword">for</span> (TestCase testCase : testCases) {
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatService.chat(testCase.getInput());

        <span class="hljs-comment">// è¯„ä¼°å›å¤è´¨é‡</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> evaluateResponse(response, testCase.getExpectedKeywords());

        assertThat(score).isGreaterThan(<span class="hljs-number">0.8</span>);
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-title function_">evaluateResponse</span><span class="hljs-params">(String response, List&lt;String&gt; keywords)</span> {
    <span class="hljs-type">long</span> <span class="hljs-variable">matchCount</span> <span class="hljs-operator">=</span> keywords.stream()
        .filter(response::contains)
        .count();
    <span class="hljs-keyword">return</span> (<span class="hljs-type">double</span>) matchCount / keywords.size();
}
</code></pre>
<p><strong>3. é›†æˆæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatControllerIntegrationTest</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> TestRestTemplate restTemplate;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testChatEndpoint</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ChatRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatRequest</span>();
        request.setMessage(<span class="hljs-string">"æµ‹è¯•é—®é¢˜"</span>);
        request.setSessionId(<span class="hljs-string">"test-session"</span>);

        ResponseEntity&lt;ChatResponse&gt; response = restTemplate.postForEntity(
            <span class="hljs-string">"/ai/chat"</span>,
            request,
            ChatResponse.class
        );

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody().getAnswer()).isNotEmpty();
    }
}
</code></pre>
<h3 data-id="heading-47">5.4 å…¸å‹åº”ç”¨åœºæ™¯å®æˆ˜</h3>
<h4 data-id="heading-48"><strong>5.4.1 åœºæ™¯ä¸€ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ</strong></h4>
<p><strong>æ¶æ„è®¾è®¡ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    U[ç”¨æˆ·] --&gt; W[Web/App]
    W --&gt; G[API Gateway]
    G --&gt; CS[å®¢æœService]

    CS --&gt; IT[æ„å›¾è¯†åˆ«]
    CS --&gt; RAG[çŸ¥è¯†åº“æ£€ç´¢]
    CS --&gt; WF[å·¥å•æµè½¬]

    IT --&gt; LLM[å¤§æ¨¡å‹]
    RAG --&gt; VS[(å‘é‡æ•°æ®åº“)]
    WF --&gt; DB[(MySQL)]

    CS --&gt; Cache[(Redisç¼“å­˜)]
    CS --&gt; MQ[æ¶ˆæ¯é˜Ÿåˆ—]

    style CS fill:#e1f5ff
</code></pre>
<p><strong>æ ¸å¿ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceAI</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> KnowledgeBaseService knowledgeBase;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> IntentClassifier intentClassifier;

    <span class="hljs-keyword">public</span> CustomerServiceResponse <span class="hljs-title function_">handle</span><span class="hljs-params">(String userMessage, String sessionId)</span> {
        <span class="hljs-comment">// 1. æ„å›¾è¯†åˆ«</span>
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> intentClassifier.classify(userMessage);

        <span class="hljs-comment">// 2. æ ¹æ®æ„å›¾è·¯ç”±</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (intent) {
            <span class="hljs-keyword">case</span> FAQ -&gt; handleFAQ(userMessage);
            <span class="hljs-keyword">case</span> COMPLAINT -&gt; handleComplaint(userMessage, sessionId);
            <span class="hljs-keyword">case</span> ORDER_QUERY -&gt; handleOrderQuery(userMessage);
            <span class="hljs-keyword">default</span> -&gt; handleGeneral(userMessage);
        };
    }

    <span class="hljs-keyword">private</span> CustomerServiceResponse <span class="hljs-title function_">handleFAQ</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// RAGæ£€ç´¢çŸ¥è¯†åº“</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> knowledgeBase.search(question);

        <span class="hljs-keyword">if</span> (answer != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> CustomerServiceResponse.builder()
                .answer(answer)
                .source(<span class="hljs-string">"knowledge_base"</span>)
                .confidence(<span class="hljs-number">0.9</span>)
                .build();
        }

        <span class="hljs-comment">// é™çº§åˆ°å¤§æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> handleGeneral(question);
    }

    <span class="hljs-keyword">private</span> CustomerServiceResponse <span class="hljs-title function_">handleComplaint</span><span class="hljs-params">(String message, String sessionId)</span> {
        <span class="hljs-comment">// åˆ›å»ºå·¥å•</span>
        <span class="hljs-type">Ticket</span> <span class="hljs-variable">ticket</span> <span class="hljs-operator">=</span> ticketService.create(message, sessionId);

        <span class="hljs-comment">// AIç”Ÿæˆå®‰æŠšè¯æœ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(
            <span class="hljs-string">"ç”¨æˆ·æŠ•è¯‰ï¼š"</span> + message + <span class="hljs-string">"\nè¯·ç”Ÿæˆä¸“ä¸šçš„å®‰æŠšå›å¤"</span>
        );

        <span class="hljs-keyword">return</span> CustomerServiceResponse.builder()
            .answer(response)
            .ticketId(ticket.getId())
            .needHumanIntervention(<span class="hljs-literal">true</span>)
            .build();
    }
}
</code></pre>
<h4 data-id="heading-49"><strong>5.4.2 åœºæ™¯äºŒï¼šä»£ç åŠ©æ‰‹</strong></h4>
<p><strong>åŠŸèƒ½æ¨¡å—ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((ä»£ç åŠ©æ‰‹))
    ä»£ç ç”Ÿæˆ
      æ ¹æ®éœ€æ±‚ç”Ÿæˆä»£ç 
      å•å…ƒæµ‹è¯•ç”Ÿæˆ
      æ–‡æ¡£ç”Ÿæˆ
    ä»£ç å®¡æŸ¥
      å®‰å…¨æ¼æ´æ£€æµ‹
      æ€§èƒ½é—®é¢˜åˆ†æ
      ä»£ç è§„èŒƒæ£€æŸ¥
    ä»£ç è§£é‡Š
      é€è¡Œè§£é‡Š
      æ¶æ„åˆ†æ
      ä¾èµ–å…³ç³»
    é‡æ„å»ºè®®
      è®¾è®¡æ¨¡å¼åº”ç”¨
      ä»£ç ç®€åŒ–
      æ€§èƒ½ä¼˜åŒ–
</code></pre>
<p><strong>å®ç°ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeAssistant</span> {

    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Assistant</span> {
        <span class="hljs-meta">@SystemMessage("""
            ä½ æ˜¯ä¸€ä½èµ„æ·±Javaæ¶æ„å¸ˆï¼Œæ“…é•¿ï¼š
            1. ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–å»ºè®®
            2. è®¾è®¡æ¨¡å¼åº”ç”¨
            3. æ€§èƒ½ä¼˜åŒ–
            4. å®‰å…¨æ¼æ´æ£€æµ‹
            """)</span>
        String <span class="hljs-title function_">reviewCode</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String code)</span>;

        <span class="hljs-meta">@UserMessage("""
            è¯·ä¸ºä»¥ä¸‹æ–¹æ³•ç”Ÿæˆå•å…ƒæµ‹è¯•ï¼š
            ```java
            {{code}}
            ```
            è¦æ±‚ï¼š
            - ä½¿ç”¨JUnit 5å’ŒMockito
            - è¦†ç›–æ­£å¸¸å’Œå¼‚å¸¸æƒ…å†µ
            - åŒ…å«è¾¹ç•Œæ¡ä»¶æµ‹è¯•
            """)</span>
        String <span class="hljs-title function_">generateTest</span><span class="hljs-params">(<span class="hljs-meta">@V("code")</span> String code)</span>;
    }

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> Assistant assistant;

    <span class="hljs-keyword">public</span> CodeReviewResult <span class="hljs-title function_">review</span><span class="hljs-params">(String code)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">review</span> <span class="hljs-operator">=</span> assistant.reviewCode(code);
        <span class="hljs-keyword">return</span> parseReviewResult(review);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generateUnitTest</span><span class="hljs-params">(String methodCode)</span> {
        <span class="hljs-keyword">return</span> assistant.generateTest(methodCode);
    }
}
</code></pre>
<h4 data-id="heading-50"><strong>5.4.3 åœºæ™¯ä¸‰ï¼šæ–‡æ¡£é—®ç­”ç³»ç»Ÿ</strong></h4>
<p><strong>ç³»ç»Ÿæ¶æ„ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph &amp;#34;æ•°æ®å‡†å¤‡&amp;#34;
        D[æ–‡æ¡£ä¸Šä¼ ] --&gt; P[è§£æ]
        P --&gt; S[åˆ†å—]
        S --&gt; E[Embedding]
        E --&gt; V[(å‘é‡åº“)]
    end

    subgraph &amp;#34;æŸ¥è¯¢æµç¨‹&amp;#34;
        Q[ç”¨æˆ·æé—®] --&gt; QE[Query Embedding]
        QE --&gt; R[æ£€ç´¢]
        V --&gt; R
        R --&gt; F[è¿‡æ»¤é‡æ’]
        F --&gt; G[ç”Ÿæˆç­”æ¡ˆ]
        G --&gt; A[è¿”å›]
    end

    style V fill:#e1f5ff
    style G fill:#ffe1e1
</code></pre>
<p><strong>å®Œæ•´å®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentQAService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> EmbeddingModel embeddingModel;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> VectorStore vectorStore;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-comment">/**
     * æ–‡æ¡£å¯¼å…¥
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">importDocuments</span><span class="hljs-params">(List&lt;MultipartFile&gt; files)</span> {
        files.forEach(file -&gt; {
            <span class="hljs-comment">// 1. è§£ææ–‡æ¡£</span>
            <span class="hljs-type">Document</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> parseDocument(file);

            <span class="hljs-comment">// 2. æ–‡æ¡£åˆ†å—</span>
            List&lt;TextSegment&gt; segments = splitDocument(doc);

            <span class="hljs-comment">// 3. å‘é‡åŒ–</span>
            List&lt;Embedding&gt; embeddings = embeddingModel.embedAll(segments).content();

            <span class="hljs-comment">// 4. å­˜å‚¨</span>
            vectorStore.addAll(embeddings, segments);
        });
    }

    <span class="hljs-comment">/**
     * é—®ç­”
     */</span>
    <span class="hljs-keyword">public</span> QAResponse <span class="hljs-title function_">query</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        List&lt;Document&gt; relevantDocs = retrieveRelevantDocs(question, <span class="hljs-number">5</span>);

        <span class="hljs-comment">// 2. é‡æ’åº</span>
        List&lt;Document&gt; rerankedDocs = rerank(question, relevantDocs);

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> buildQAPrompt(question, rerankedDocs);

        <span class="hljs-comment">// 4. ç”Ÿæˆç­”æ¡ˆ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatClient.call(prompt);

        <span class="hljs-comment">// 5. æå–å¼•ç”¨</span>
        List&lt;Citation&gt; citations = extractCitations(rerankedDocs);

        <span class="hljs-keyword">return</span> QAResponse.builder()
            .answer(answer)
            .citations(citations)
            .confidence(calculateConfidence(rerankedDocs))
            .build();
    }

    <span class="hljs-keyword">private</span> List&lt;Document&gt; <span class="hljs-title function_">retrieveRelevantDocs</span><span class="hljs-params">(String query, <span class="hljs-type">int</span> topK)</span> {
        <span class="hljs-type">Embedding</span> <span class="hljs-variable">queryEmbedding</span> <span class="hljs-operator">=</span> embeddingModel.embed(query).content();

        <span class="hljs-keyword">return</span> vectorStore.findRelevant(queryEmbedding, topK, <span class="hljs-number">0.7</span>)
            .stream()
            .map(EmbeddingMatch::embedded)
            .map(segment -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(segment.text()))
            .collect(Collectors.toList());
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">buildQAPrompt</span><span class="hljs-params">(String question, List&lt;Document&gt; docs)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> docs.stream()
            .map(Document::text)
            .collect(Collectors.joining(<span class="hljs-string">"\n\n---\n\n"</span>));

        <span class="hljs-keyword">return</span> <span class="hljs-string">"""
            # ä»»åŠ¡
            åŸºäºä»¥ä¸‹æ–‡æ¡£å†…å®¹å›ç­”ç”¨æˆ·é—®é¢˜ã€‚

            # æ–‡æ¡£å†…å®¹
            %s

            # ç”¨æˆ·é—®é¢˜
            %s

            # è¦æ±‚
            1. ä»…åŸºäºæä¾›çš„æ–‡æ¡£å†…å®¹å›ç­”
            2. å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œæ˜ç¡®è¯´æ˜
            3. ç»™å‡ºå…·ä½“çš„æ–‡æ¡£å¼•ç”¨
            4. å›ç­”è¦å‡†ç¡®ã€ç®€æ´
            """</span>.formatted(context, question);
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—]]></title>    <link>https://juejin.cn/post/7585706951603650586</link>    <guid>https://juejin.cn/post/7585706951603650586</guid>    <pubDate>2025-12-21T02:39:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585706951603650586" data-draft-id="7585463195202404402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—"/> <meta itemprop="keywords" content="PostgreSQL,Docker"/> <meta itemprop="datePublished" content="2025-12-21T02:39:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€èµµ"/> <meta itemprop="url" content="https://juejin.cn/user/3208848015890347"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3208848015890347/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€èµµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T02:39:19.000Z" title="Sun Dec 21 2025 02:39:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>Supabase Postgres æ˜¯ä¸€æ¬¾åŸºäºPostgreSQLå®˜æ–¹é•œåƒæ„å»ºçš„å®¹å™¨åŒ–åº”ç”¨ï¼Œé›†æˆäº†å¤šç§å®ç”¨æ’ä»¶ï¼Œæ—¨åœ¨ä¸ºå¼€å‘è€…æä¾›ä¾¿æ·ã€å¯é çš„æ•°æ®åº“æœåŠ¡ã€‚è¯¥é•œåƒä¿æŒäº†PostgreSQLçš„åŸç”ŸåŠŸèƒ½ç‰¹æ€§ï¼ŒåŒæ—¶é¢„è£…äº†PostGISã€pg_cronã€pgAuditç­‰å¸¸ç”¨æ‰©å±•ï¼Œæ»¡è¶³åœ°ç†ä¿¡æ¯å¤„ç†ã€å®šæ—¶ä»»åŠ¡ã€å®¡è®¡æ—¥å¿—ç­‰å¤šæ ·åŒ–éœ€æ±‚ã€‚</p>
<p>æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡Dockerå®¹å™¨åŒ–æ–¹å¼éƒ¨ç½²Supabase Postgresï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€å®¹å™¨é…ç½®ã€åŠŸèƒ½æµ‹è¯•åŠç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ­å»ºç¨³å®šçš„Supabase Postgresæ•°æ®åº“æœåŠ¡ã€‚æ¨èä½¿ç”¨æ ‡ç­¾<code>17.6.0.023-orioledb</code>è¿›è¡Œéƒ¨ç½²ï¼Œæ›´å¤šç‰ˆæœ¬ä¿¡æ¯å¯å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fxuanyuan.cloud%2Fr%2Fsupabase%2Fpostgres%2Ftags" title="https://xuanyuan.cloud/r/supabase/postgres/tags" target="_blank" ref="nofollow noopener noreferrer">Postgres é•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰</a>ã€‚</p>
<h2 data-id="heading-1">ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">Dockerç¯å¢ƒå®‰è£…</h3>
<p>éƒ¨ç½²Supabase Postgreså®¹å™¨å‰ï¼Œéœ€å…ˆç¡®ä¿æœåŠ¡å™¨å·²å®‰è£…Dockerç¯å¢ƒã€‚æ¨èä½¿ç”¨ä»¥ä¸‹ä¸€é”®å®‰è£…è„šæœ¬ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">bash</span> &lt;(wget -qO- <span class="hljs-attribute">https</span>:<span class="hljs-comment">//xuanyuan.cloud/docker.sh)</span>
</code></pre>
<p>è„šæœ¬æ‰§è¡Œå®Œæˆåï¼Œå¯é€šè¿‡<code>docker --version</code>å‘½ä»¤éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼Œå‡ºç°ç±»ä¼¼<code>Docker version 20.10.xx, build xxxxxxx</code>çš„è¾“å‡ºå³è¡¨ç¤ºDockerç¯å¢ƒå°±ç»ªã€‚</p>
<p>è½©è¾•é•œåƒè®¿é—®æ”¯æŒå¯æ”¹å–„é•œåƒè®¿é—®ä½“éªŒï¼›é•œåƒæ¥æºäºå®˜æ–¹å…¬å…±ä»“åº“ï¼Œå¹³å°ä¸å­˜å‚¨ä¸ä¿®æ”¹é•œåƒå†…å®¹ã€‚</p>
<h2 data-id="heading-3">é•œåƒå‡†å¤‡</h2>
<h3 data-id="heading-4">æ‹‰å–Supabase Postgresé•œåƒ</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€šè¿‡è½©è¾•é•œåƒè®¿é—®æ”¯æŒåŸŸåæ‹‰å–æ¨èç‰ˆæœ¬çš„POSTGRESé•œåƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">docker pull xxx.xuanyuan.run/supabase/postgres:<span class="hljs-number">17.6</span><span class="hljs-number">.0</span><span class="hljs-number">.023</span>-orioledb
</code></pre>
<p>æ‹‰å–å®Œæˆåï¼Œå¯é€šè¿‡<code>docker images | grep supabase/postgres</code>å‘½ä»¤éªŒè¯é•œåƒæ˜¯å¦æˆåŠŸè·å–ï¼Œè¾“å‡ºåº”åŒ…å«<code>xxx.xuanyuan.run/supabase/postgres</code>åŠå¯¹åº”æ ‡ç­¾ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-5">å®¹å™¨éƒ¨ç½²</h2>
<h3 data-id="heading-6">åŸºç¡€éƒ¨ç½²å‘½ä»¤</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨Supabase Postgreså®¹å™¨ï¼ŒåŒ…å«åŸºç¡€çš„ç«¯å£æ˜ å°„ã€æ•°æ®æŒä¹…åŒ–åŠç¯å¢ƒå˜é‡é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \  --name postgres-container \  -p 5432:5432 \  -v postgres-data:/var/lib/postgresql/data \  -e POSTGRES_PASSWORD=your_secure_password \  --<span class="hljs-built_in">command</span> <span class="hljs-string">"postgres -c config_file=/etc/postgresql/postgresql.conf"</span> \  xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb
</code></pre>
<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li>â€¢ <code>-d</code>ï¼šåå°è¿è¡Œå®¹å™¨</li>
<li>â€¢ <code>--name postgres-container</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ä¸º<code>postgres-container</code>ï¼Œä¾¿äºåç»­ç®¡ç†</li>
<li>â€¢ <code>-p 5432:5432</code>ï¼šå°†å®¹å™¨å†…5432ç«¯å£æ˜ å°„åˆ°ä¸»æœº5432ç«¯å£ï¼ˆPostgreSQLé»˜è®¤ç«¯å£ï¼‰</li>
<li>â€¢ <code>-v postgres-data:/var/lib/postgresql/data</code>ï¼šä½¿ç”¨å‘½åå·<code>postgres-data</code>æŒä¹…åŒ–æ•°æ®åº“æ•°æ®ï¼Œé¿å…å®¹å™¨åˆ é™¤å¯¼è‡´æ•°æ®ä¸¢å¤±</li>
<li>â€¢ <code>-e POSTGRES_PASSWORD=your_secure_password</code>ï¼šè®¾ç½®æ•°æ®åº“è¶…çº§ç”¨æˆ·å¯†ç ï¼Œå»ºè®®ä½¿ç”¨å¼ºå¯†ç å¹¶å¦¥å–„ä¿ç®¡</li>
<li>â€¢ <code>--command</code>ï¼šæŒ‡å®šå¯åŠ¨å‘½ä»¤ï¼ŒåŠ è½½è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼ˆé€‚ç”¨äº14.1.0åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰</li>
</ul>
<h3 data-id="heading-7">è‡ªå®šä¹‰é…ç½®éƒ¨ç½²</h3>
<p>å¦‚éœ€è°ƒæ•´æ•°æ®åº“é…ç½®ï¼ˆå¦‚å†…å­˜åˆ†é…ã€è¿æ¥æ•°é™åˆ¶ç­‰ï¼‰ï¼Œå¯é€šè¿‡æŒ‚è½½æœ¬åœ°é…ç½®æ–‡ä»¶å®ç°ï¼š</p>
<ol>
<li>
<p>1. ä»å®¹å™¨ä¸­å¤åˆ¶é»˜è®¤é…ç½®æ–‡ä»¶åˆ°æœ¬åœ°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">cp</span> postgres-container:/etc/postgresql/postgresql.conf ./postgresql.conf
</code></pre>
</li>
<li>
<p>2. ç¼–è¾‘æœ¬åœ°<code>postgresql.conf</code>æ–‡ä»¶ï¼Œæ ¹æ®éœ€æ±‚è°ƒæ•´å‚æ•°ï¼ˆå¦‚<code>max_connections</code>ã€<code>shared_buffers</code>ç­‰ï¼‰</p>
</li>
<li>
<p>3. ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¯åŠ¨å®¹å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \  --name postgres-container \  -p 5432:5432 \  -v $(<span class="hljs-built_in">pwd</span>)/postgresql.conf:/etc/postgresql/postgresql.conf \  -v postgres-data:/var/lib/postgresql/data \  -e POSTGRES_PASSWORD=your_secure_password \  xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb
</code></pre>
</li>
</ol>
<h2 data-id="heading-8">åŠŸèƒ½æµ‹è¯•</h2>
<h3 data-id="heading-9">å®¹å™¨çŠ¶æ€æ£€æŸ¥</h3>
<p>éƒ¨ç½²å®Œæˆåï¼Œé¦–å…ˆæ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-python" lang="python">docker ps --<span class="hljs-built_in">filter</span> <span class="hljs-string">"name=postgres-container"</span>
</code></pre>
<p>è‹¥è¾“å‡ºä¸­<code>STATUS</code>å­—æ®µæ˜¾ç¤ºä¸º<code>Up</code>ï¼Œè¡¨ç¤ºå®¹å™¨æ­£å¸¸è¿è¡Œã€‚</p>
<h3 data-id="heading-10">æ—¥å¿—éªŒè¯</h3>
<p>é€šè¿‡æŸ¥çœ‹å®¹å™¨æ—¥å¿—ç¡®è®¤æœåŠ¡å¯åŠ¨çŠ¶æ€åŠæ˜¯å¦å­˜åœ¨å¼‚å¸¸ï¼š</p>
<pre><code class="hljs">docker logs postgres-container
</code></pre>
<p>æ­£å¸¸å¯åŠ¨æ—¶ï¼Œæ—¥å¿—æœ«å°¾åº”åŒ…å«ç±»ä¼¼<code>database system is ready to accept connections</code>çš„æç¤ºä¿¡æ¯ã€‚</p>
<h3 data-id="heading-11">æ•°æ®åº“è¿æ¥æµ‹è¯•</h3>
<p>ä½¿ç”¨<code>psql</code>å®¢æˆ·ç«¯è¿æ¥æ•°æ®åº“ï¼ˆéœ€å…ˆå®‰è£…PostgreSQLå®¢æˆ·ç«¯å·¥å…·ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css">psql -h localhost -<span class="hljs-selector-tag">p</span> <span class="hljs-number">5432</span> -U postgres
</code></pre>
<p>è¾“å…¥éƒ¨ç½²æ—¶è®¾ç½®çš„å¯†ç <code>your_secure_password</code>ï¼ŒæˆåŠŸç™»å½•åè¿›å…¥PostgreSQLå‘½ä»¤è¡Œç•Œé¢ï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ•°æ®åº“ç‰ˆæœ¬åŠæ‰©å±•ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">-- æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬<span class="hljs-keyword">SELECT</span> version();-- éªŒè¯é¢„è£…æ‰©å±•ï¼ˆä»¥pg_stat_statementsä¸ºä¾‹ï¼‰<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> pg_extension <span class="hljs-keyword">WHERE</span> extname = <span class="hljs-comment">'pg_stat_statements';</span>
</code></pre>
<p>è‹¥ç‰ˆæœ¬ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®ä¸”æ‰©å±•è®°å½•å­˜åœ¨ï¼Œè¡¨æ˜æ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œã€‚</p>
<h2 data-id="heading-12">ç”Ÿäº§ç¯å¢ƒå»ºè®®</h2>
<h3 data-id="heading-13">æ•°æ®å®‰å…¨ä¸æŒä¹…åŒ–</h3>
<ul>
<li>
<p>â€¢ <strong>ä½¿ç”¨å¤–éƒ¨å­˜å‚¨å·</strong>ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ç»‘å®šæŒ‚è½½ï¼ˆ<code>-v /host/path:/container/path</code>ï¼‰è€Œéå‘½åå·ï¼Œä¾¿äºæ•°æ®å¤‡ä»½å’Œè¿ç§»ï¼Œç¡®ä¿æ•°æ®è·¯å¾„æƒé™è®¾ç½®æ­£ç¡®ï¼ˆå»ºè®®PostgreSQLç”¨æˆ·IDä¸º999ï¼‰</p>
</li>
<li>
<p>â€¢ <strong>å®šæœŸå¤‡ä»½</strong>ï¼šé€šè¿‡<code>pg_dump</code>å·¥å…·æˆ–<code>docker exec</code>æ‰§è¡Œå¤‡ä»½å‘½ä»¤ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">exec</span> postgres-container pg_dump -U postgres -Fc mydatabase &gt; backup_$(<span class="hljs-built_in">date</span> +%Y%m%d).dump
</code></pre>
</li>
<li>
<p>â€¢ <strong>å¯ç”¨SSL</strong>ï¼šé…ç½®<code>ssl = on</code>åŠç›¸å…³è¯ä¹¦å‚æ•°ï¼Œå¼ºåˆ¶å®¢æˆ·ç«¯ä½¿ç”¨SSLè¿æ¥ï¼Œé˜²æ­¢æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è¢«çªƒå¬</p>
</li>
</ul>
<h3 data-id="heading-14">æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>
<p>â€¢ <strong>èµ„æºé™åˆ¶</strong>ï¼šæ ¹æ®æœåŠ¡å™¨é…ç½®å’Œä¸šåŠ¡éœ€æ±‚ï¼Œé€šè¿‡<code>--memory</code>å’Œ<code>--cpus</code>å‚æ•°é™åˆ¶å®¹å™¨èµ„æºä½¿ç”¨ï¼Œé¿å…èµ„æºè€—å°½ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-css" lang="css">docker run -d \  <span class="hljs-attr">--name</span> postgres-container \  <span class="hljs-attr">--memory</span>=<span class="hljs-number">4</span>g \  <span class="hljs-attr">--cpus</span>=<span class="hljs-number">2</span> \  ...ï¼ˆå…¶ä»–å‚æ•°ï¼‰
</code></pre>
</li>
<li>
<p>â€¢ <strong>é…ç½®è°ƒä¼˜</strong>ï¼šæ ¹æ®æœåŠ¡å™¨å†…å­˜è°ƒæ•´<code>shared_buffers</code>ï¼ˆé€šå¸¸è®¾ä¸ºç‰©ç†å†…å­˜çš„25%ï¼‰ã€<code>work_mem</code>ã€<code>maintenance_work_mem</code>ç­‰å‚æ•°ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½</p>
</li>
<li>
<p>â€¢ <strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šé’ˆå¯¹é¢‘ç¹æŸ¥è¯¢çš„å­—æ®µåˆ›å»ºåˆé€‚ç´¢å¼•ï¼Œå®šæœŸä½¿ç”¨<code>EXPLAIN</code>åˆ†ææŸ¥è¯¢è®¡åˆ’</p>
</li>
</ul>
<h3 data-id="heading-15">é«˜å¯ç”¨é…ç½®</h3>
<ul>
<li>
<p>â€¢ <strong>ä¸»ä»å¤åˆ¶</strong>ï¼šéƒ¨ç½²å¤šèŠ‚ç‚¹ä¸»ä»æ¶æ„ï¼Œé€šè¿‡PostgreSQLæµå¤åˆ¶å®ç°æ•°æ®åŒæ­¥ï¼Œæé«˜æœåŠ¡å¯ç”¨æ€§</p>
</li>
<li>
<p>â€¢ <strong>å®¹å™¨ç¼–æ’</strong>ï¼šä½¿ç”¨Kubernetesæˆ–Docker Composeç®¡ç†å¤šå®¹å™¨åº”ç”¨ï¼Œé…ç½®å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯ç­–ç•¥ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">docker-compose.ymlç¤ºä¾‹ç‰‡æ®µservices:  postgres:    image: xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb    restart: always    healthcheck:      <span class="hljs-built_in">test</span>: [<span class="hljs-string">"CMD-SHELL"</span>, <span class="hljs-string">"pg_isready -U postgres"</span>]      interval: 10s      <span class="hljs-built_in">timeout</span>: 5s      retries: 5</span>
</code></pre>
</li>
</ul>
<h2 data-id="heading-16">æ•…éšœæ’æŸ¥</h2>
<h3 data-id="heading-17">å®¹å™¨æ— æ³•å¯åŠ¨</h3>
<ul>
<li>â€¢ <strong>ç«¯å£å†²çª</strong>ï¼šæ£€æŸ¥ä¸»æœº5432ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Œä½¿ç”¨<code>netstat -tulpn | grep 5432</code>æˆ–<code>ss -tulpn | grep 5432</code>æŸ¥çœ‹å ç”¨è¿›ç¨‹ï¼Œå…³é—­å†²çªè¿›ç¨‹æˆ–ä¿®æ”¹æ˜ å°„ç«¯å£</li>
<li>â€¢ <strong>æ•°æ®å·æƒé™</strong>ï¼šè‹¥ä½¿ç”¨ç»‘å®šæŒ‚è½½ï¼Œç¡®ä¿ä¸»æœºç›®å½•æƒé™å…è®¸å®¹å™¨å†…ç”¨æˆ·è®¿é—®ï¼Œå¯é€šè¿‡<code>chmod 700 /host/path</code>åŠ<code>chown -R 999:999 /host/path</code>è°ƒæ•´æƒé™</li>
<li>â€¢ <strong>é…ç½®æ–‡ä»¶é”™è¯¯</strong>ï¼šæ£€æŸ¥è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è¯­æ³•ï¼Œå¯é€šè¿‡<code>docker run</code>ä¸åŠ <code>-d</code>å‚æ•°å‰å°å¯åŠ¨å®¹å™¨ï¼Œç›´æ¥æŸ¥çœ‹é”™è¯¯æ—¥å¿—</li>
</ul>
<h3 data-id="heading-18">è¿æ¥å¤±è´¥</h3>
<ul>
<li>â€¢ <strong>ç½‘ç»œé—®é¢˜</strong>ï¼šéªŒè¯ä¸»æœºé˜²ç«å¢™æ˜¯å¦å¼€æ”¾5432ç«¯å£ï¼ˆå¦‚<code>ufw allow 5432</code>ï¼‰ï¼Œè¿œç¨‹è¿æ¥éœ€ç¡®ä¿<code>postgresql.conf</code>ä¸­<code>listen_addresses = '*'</code>åŠ<code>pg_hba.conf</code>ä¸­å…è®¸å¯¹åº”IPæ®µè®¿é—®</li>
<li>â€¢ <strong>å¯†ç é”™è¯¯</strong>ï¼šé€šè¿‡<code>docker exec -it postgres-container psql -U postgres</code>ç›´æ¥ç™»å½•å®¹å™¨å†…æ•°æ®åº“ï¼Œä½¿ç”¨<code>ALTER USER postgres PASSWORD 'new_password';</code>é‡ç½®å¯†ç </li>
<li>â€¢ <strong>å®¹å™¨çŠ¶æ€</strong>ï¼šç¡®è®¤å®¹å™¨å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè‹¥å·²åœæ­¢å¯é€šè¿‡<code>docker start postgres-container</code>é‡å¯</li>
</ul>
<h3 data-id="heading-19">æ‰©å±•åŠ è½½å¼‚å¸¸</h3>
<ul>
<li>â€¢ <strong>æ—¥å¿—æ£€æŸ¥</strong>ï¼šæŸ¥çœ‹å®¹å™¨æ—¥å¿—ä¸­æ˜¯å¦æœ‰æ‰©å±•åŠ è½½å¤±è´¥æç¤ºï¼Œå¦‚<code>could not load library</code></li>
<li>â€¢ <strong>ä¾èµ–ç¼ºå¤±</strong>ï¼šéƒ¨åˆ†æ‰©å±•å¯èƒ½éœ€è¦é¢å¤–ç³»ç»Ÿåº“ï¼Œå¯é€šè¿‡<code>docker exec -it postgres-container apt update &amp;&amp; apt install -y [ä¾èµ–åŒ…]</code>å®‰è£…ç¼ºå¤±ä¾èµ–</li>
<li>â€¢ <strong>ç‰ˆæœ¬å…¼å®¹æ€§</strong>ï¼šç¡®è®¤ä½¿ç”¨çš„é•œåƒæ ‡ç­¾ä¸æ‰©å±•ç‰ˆæœ¬å…¼å®¹ï¼Œå¯å‚è€ƒ POSTGRESé•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres</code> æŸ¥çœ‹æ‰©å±•æ”¯æŒä¿¡æ¯</li>
</ul>
<h2 data-id="heading-20">å‚è€ƒèµ„æº</h2>
<ul>
<li>â€¢ Postgres é•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres</code></li>
<li>â€¢ Postgres é•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres/tags</code></li>
<li>â€¢ Supabase Postgres GitHubä»“åº“ <code>https://github.com/supabase/postgres</code></li>
<li>â€¢ PostgreSQLå®˜æ–¹æ–‡æ¡£ <code>https://www.postgresql.org/docs</code></li>
<li>â€¢ Dockerå®¹å™¨æœ€ä½³å®è·µ <code>https://docs.docker.com/develop/develop-images/dockerfile_best-practices</code></li>
</ul>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†Supabase Postgresçš„Dockerå®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€åŸºç¡€ä¸è‡ªå®šä¹‰éƒ¨ç½²ã€åŠŸèƒ½æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–åŠæ•…éšœæ’æŸ¥ç­‰å†…å®¹ã€‚é€šè¿‡å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç”¨æˆ·å¯å¿«é€Ÿæ­å»ºåŒ…å«å¤šç§å®ç”¨æ’ä»¶çš„PostgreSQLæ•°æ®åº“æœåŠ¡ï¼Œæ»¡è¶³å¼€å‘ä¸ç”Ÿäº§éœ€æ±‚ã€‚</p>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ul>
<li>â€¢ ä½¿ç”¨ä¸€é”®è„šæœ¬å¿«é€Ÿéƒ¨ç½²Dockerç¯å¢ƒï¼Œç®€åŒ–å‰æœŸå‡†å¤‡å·¥ä½œ</li>
<li>â€¢ é€šè¿‡è½©è¾•é•œåƒè®¿é—®æ”¯æŒæ‹‰å–Supabase Postgresé•œåƒï¼Œæ”¹å–„è®¿é—®ä½“éªŒ</li>
<li>â€¢ å®¹å™¨éƒ¨ç½²éœ€æ³¨æ„æ•°æ®æŒä¹…åŒ–ï¼ˆä½¿ç”¨å·æŒ‚è½½ï¼‰ã€å¯†ç å®‰å…¨åŠé…ç½®æ–‡ä»¶åŠ è½½</li>
<li>â€¢ ç”Ÿäº§ç¯å¢ƒä¸­åº”é‡è§†èµ„æºé™åˆ¶ã€æ•°æ®å¤‡ä»½ã€SSLé…ç½®åŠé«˜å¯ç”¨æ¶æ„è®¾è®¡</li>
<li>â€¢ æ•…éšœæ’æŸ¥ä»¥æ—¥å¿—åˆ†æä¸ºæ ¸å¿ƒï¼Œé‡ç‚¹å…³æ³¨ç«¯å£å†²çªã€æƒé™é—®é¢˜åŠé…ç½®é”™è¯¯</li>
</ul>
<p><strong>åç»­å»ºè®®</strong>ï¼š</p>
<ul>
<li>â€¢ æ·±å…¥å­¦ä¹ Supabase Postgresé¢„è£…æ‰©å±•çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¦‚PostGISåœ°ç†ä¿¡æ¯å¤„ç†ã€pg_cronå®šæ—¶ä»»åŠ¡ç­‰é«˜çº§ç‰¹æ€§</li>
<li>â€¢ æ ¹æ®ä¸šåŠ¡è´Ÿè½½æƒ…å†µæŒç»­ä¼˜åŒ–æ•°æ®åº“é…ç½®å‚æ•°ï¼Œå®šæœŸç›‘æ§æ€§èƒ½æŒ‡æ ‡ï¼ˆå¯ç»“åˆPrometheus+Grafanaï¼‰</li>
<li>â€¢ å…³æ³¨ Supabase Postgresé•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres/tags</code>ï¼ŒåŠæ—¶æ›´æ–°é•œåƒç‰ˆæœ¬ä»¥è·å–å®‰å…¨è¡¥ä¸å’ŒåŠŸèƒ½æ›´æ–°</li>
<li>â€¢ å¯¹äºå¤§è§„æ¨¡éƒ¨ç½²åœºæ™¯ï¼Œå»ºè®®å‚è€ƒå®˜æ–¹æ–‡æ¡£è®¾è®¡åŸºäºKubernetesçš„å®¹å™¨ç¼–æ’æ–¹æ¡ˆï¼Œå®ç°è‡ªåŠ¨åŒ–è¿ç»´ä¸å¼¹æ€§ä¼¸ç¼©</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼]]></title>    <link>https://juejin.cn/post/7585534343562166322</link>    <guid>https://juejin.cn/post/7585534343562166322</guid>    <pubDate>2025-12-21T05:42:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562166322" data-draft-id="7584286241488977960" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T05:42:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T05:42:23.000Z" title="Sun Dec 21 2025 05:42:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ğŸ“… 2025 å¹´ 12 æœˆ 16 æ—¥æ˜¯ DataGrip çš„ 10 å‘¨å²ç”Ÿæ—¥ï¼<br/>
åœ¨è¿™åå¹´ä¸­ï¼Œå®ƒä»ä»£å· <code>0xdbe</code> çš„åŸå‹æˆé•¿ä¸ºä¸“ä¸šæ•°æ®åº“ IDE çš„æ ‡æ†ã€‚\</p>
</blockquote>
<h2 data-id="heading-0">ä»Šå¤©å°±æ¥è®²è®²å†DataGripä¸­éšè—çš„æ»¡åˆ†æŠ€å·§</h2>
<hr/>
<h2 data-id="heading-1">âœ¨ 1. è·¨æ–‡ä»¶å•è¯è¡¥å…¨ï¼š<code>Alt/Opt + /</code></h2>
<p>ä¸æ­¢æ˜¯ SQL å…³é”®å­—æˆ–å­—æ®µåâ€”â€”è¿™ä¸ªåŠŸèƒ½èƒ½ä»<strong>å½“å‰æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶ä¸­</strong>æ™ºèƒ½åŒ¹é…ä»»æ„å•è¯ï¼ˆç±»ä¼¼â€œHippie Completionâ€ï¼‰ã€‚</p>
<p>âœ… é€‚ç”¨åœºæ™¯ï¼šåœ¨ <code>INSERT</code> è¯­å¥ä¸­å¿«é€Ÿè¡¥å…¨æšä¸¾å€¼ï¼ˆä¾‹å¦‚å°†æ‰€æœ‰å€™é€‰å€¼é¢„å­˜åœ¨ä¸€ä¸ª Scratch æ–‡ä»¶é‡Œï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4db52a476e042dfbfa2ebba9e58f83d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=UdgKQzCHK6pqU3yX181nxGZN6Gs%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ’¡ å°æŠ€å·§ï¼šè¿ç»­æŒ‰ <code>Alt+/</code> å¯å¾ªç¯åˆ‡æ¢åŒ¹é…é¡¹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ” 2. æœ€è¿‘ä½ç½®å¯¼èˆªï¼š<code>Ctrl/Cmd + Shift + E</code></h2>
<p>æ¯” â€œRecent Filesâ€ï¼ˆ<code>Ctrl/Cmd + E</code>ï¼‰æ›´å¼ºå¤§ï¼š</p>
<ul>
<li>æ˜¾ç¤ºæœ€è¿‘<strong>æŸ¥çœ‹æˆ–ç¼–è¾‘è¿‡çš„ä½ç½®</strong>ï¼ˆå¸¦ä¸Šä¸‹æ–‡ä»£ç ç‰‡æ®µï¼‰</li>
<li>å†æŒ‰ä¸€æ¬¡å¿«æ·é”®ï¼Œä»…æ˜¾ç¤º<strong>å·²ä¿®æ”¹æ–‡ä»¶</strong></li>
<li>æ”¯æŒ<strong>è¾“å…¥ä»£ç ç‰‡æ®µå®æ—¶è¿‡æ»¤</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a804be8df84427ab54a2d56fcce9f7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bGvikb9E1NRybEKjN%2B3k9iEpDJM%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¯ ç‰¹åˆ«é€‚åˆï¼šå¿«é€Ÿæ‰¾å›â€œåˆšåˆšå†™åˆ°å“ªäº†â€çš„å¤æ‚æŸ¥è¯¢ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ–¼ï¸ 3. è‡ªå®šä¹‰èƒŒæ™¯å›¾ï¼ˆä¸åªæ˜¯ç¾åŒ–ï¼ï¼‰</h2>
<p>å‰å¾€ï¼š<br/>
<code>Settings | Appearance &amp; Behavior | Appearance | UI Options â†’ Background Image</code></p>
<p>å¯ä¸º<strong>ç¼–è¾‘å™¨ + æ‰€æœ‰å·¥å…·çª—å£</strong>è®¾ç½®èƒŒæ™¯å›¾ï¼Œæ”¯æŒç¼©æ”¾ã€é€æ˜åº¦è°ƒèŠ‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0010cecd73604016b84879b915284801~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=b5Tmo%2BD37ntYXamKR%2B%2BoDhoDO%2F8%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¨ ç”¨é€”å»ºè®®ï¼š</p>
<ul>
<li>æš—è‰²ä¸»é¢˜ä¸‹åŠ ä½é€æ˜åº¦æ°´å° logoï¼ˆå›¢é˜Ÿè§„èŒƒæé†’ï¼‰</li>
<li>æ˜¾ç¤º ER å›¾ä½œä¸ºè§†è§‰å‚è€ƒï¼ˆå¼€å‘æ—¶å¯¹ç…§ç»“æ„ï¼‰</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-4">ğŸ—ƒï¸ 4. ä¸€é”®å¯¼å‡ºæ•´ä¸ª Schema çš„ DDLï¼ˆå¸¦æ–‡ä»¶ç»“æ„ï¼‰</h2>
<p>ä½¿ç”¨ <strong>SQL Generator</strong>ï¼ˆ<code>Ctrl/Cmd + Alt + G</code>ï¼‰ä¸ä»…å¯ç”Ÿæˆå•è¡¨ DDLï¼Œè¿˜èƒ½ï¼š</p>
<p>âœ… å¯¹æ•´ä¸ª <strong>Schema èŠ‚ç‚¹</strong>è°ƒç”¨ â†’ åˆ‡æ¢åˆ° <code>File Output Options</code><br/>
âœ… è‡ªå®šä¹‰æ–‡ä»¶ç»„ç»‡æ–¹å¼ï¼ˆå¦‚â€œæ¯ä¸ªè¡¨ä¸€ä¸ªæ–‡ä»¶â€ã€â€œæŒ‰å¯¹è±¡ç±»å‹åˆ†ç›®å½•â€ï¼‰<br/>
âœ… ç‚¹å‡» <code>Dump</code> ç›´æ¥ç”Ÿæˆç‰©ç†æ–‡ä»¶ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/190e4fae0d64412180db58669dc4234d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=Q2YLxKlg6Sk7GaH%2FwtWlvJ5y36U%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ› ï¸ åœºæ™¯ï¼šç‰ˆæœ¬æ§åˆ¶ schema å˜æ›´ã€ç¾å¤‡é‡å»ºã€è·¨ç¯å¢ƒè¿ç§»ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ“‹ 5. å¤åˆ¶æ•°æ®æº = å¤åˆ¶é…ç½®ï¼ˆè·¨æœºå™¨/IDE å…±äº«ï¼ï¼‰</h2>
<ul>
<li>åœ¨ Database é¢æ¿ä¸­é€‰ä¸­æ•°æ®æº â†’ <code>Ctrl/Cmd + C</code></li>
<li>ç²˜è´´åˆ°ä»»æ„ä½ç½®ï¼ˆç”šè‡³å¦ä¸€å°ç”µè„‘çš„ DataGrip / IntelliJ IDEAï¼‰â†’ <code>Ctrl/Cmd + V</code></li>
</ul>
<p>ğŸ” åº•å±‚åŸç†ï¼šå‰ªè´´æ¿å­˜çš„æ˜¯ <strong>XML é…ç½®ç‰‡æ®µ</strong>ï¼ˆä¸å«å¯†ç ï¼‰ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/798cf569efaf4363897bd127ab814afa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=7wdy9D54aQOU7AK3gfQ1pUtkRwc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¤ å›¢é˜Ÿåä½œåˆ©å™¨ï¼šSlack å‘ä¸€æ®µ XMLï¼ŒåŒäº‹ç§’è¿åŒæ¬¾æ•°æ®åº“ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">ğŸ•°ï¸ 6. æ–‡ä»¶å¤¹çº§æœ¬åœ°å†å²ï¼ˆè¯¯åˆ æ–‡ä»¶ï¼Ÿç§’æ¢å¤ï¼ï¼‰</h2>
<p>ä¸ä»…å•ä¸ªæ–‡ä»¶æœ‰ <code>Local History</code>ï¼Œ<strong>æ•´ä¸ªæ–‡ä»¶å¤¹</strong>ä¹Ÿå¯ä»¥ï¼š</p>
<ol>
<li>åœ¨ <code>Files</code> å·¥å…·çª—å£å³é”®æ–‡ä»¶å¤¹</li>
<li><code>Show History â†’ Local History</code></li>
<li>æŸ¥çœ‹/æ¢å¤ä»»æ„æ—¶é—´ç‚¹çš„ç›®å½•æ ‘ &amp; æ–‡ä»¶å†…å®¹</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/560ca6d96be243868a0102b5c989055b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bIJeoB4JexX9Cw5eGRNHbu3w77s%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šé Git å†å²ï¼æ˜¯ IDE è‡ªåŠ¨ä¿å­˜çš„æœ¬åœ°å¿«ç…§ï¼ˆé‡å¯/æ–­ç”µä¹Ÿä¸ä¸¢ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ“‘ 7. SQL è‡ªå®šä¹‰åŒºåŸŸæŠ˜å  + ç»“æ„å¯¼èˆª</h2>
<p>ç”¨ç‰¹æ®Šæ³¨é‡Šå®šä¹‰å¯æŠ˜å åŒºåŸŸï¼ˆæ”¯æŒ <code>--region</code> / <code>--endregion</code> æˆ– <code>#region</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--region Sales Report</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> orders <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">YEAR</span>(order_date) <span class="hljs-operator">=</span> <span class="hljs-number">2025</span>;
<span class="hljs-comment">--endregion</span>
</code></pre>
<ul>
<li>æŠ˜å /å±•å¼€ï¼š<code>Ctrl/Cmd + - / +</code></li>
<li>åœ¨ <code>File Structure</code>ï¼ˆ<code>Ctrl/Cmd + F12</code>ï¼‰ä¸­æ¸…æ™°åˆ—å‡ºæ‰€æœ‰åŒºåŸŸ</li>
<li>âš¡ <strong>å¯ç›´æ¥ä»ç»“æ„çª—å£æ‰§è¡ŒæŸåŒºåŸŸ SQLï¼</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b11b89bbc8aa471bb02dd77aa0bff2ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bITnxkfACuCte0p8SqNfLh%2FKPCA%3D" alt="" loading="lazy"/><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff526beff2b14d6fadfa561f6297d4f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=90pA%2BiHLnEUvrjXRXpy8u74F3eo%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ§© é€‚åˆï¼šå·¨å‹ SQL è„šæœ¬åˆ†åŒºç®¡ç†ï¼ˆETLã€æŠ¥è¡¨ã€è¿ç§»è„šæœ¬ç­‰ï¼‰</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ğŸ“Š 8. æŠŠâ€œèŠ‚ç‚¹â€å½“è¡¨æŸ¥ï¼ˆå…ƒæ•°æ®å³æ•°æ®ï¼ï¼‰</h2>
<p>åœ¨ Database æ ‘ä¸­é€‰ä¸­ä»»æ„èŠ‚ç‚¹ï¼ˆå¦‚ <code>tables</code>, <code>functions</code>, <code>indices</code>ï¼‰â†’ æŒ‰ <code>F4</code>ï¼š</p>
<p>â†’ ç«‹å³ä»¥<strong>è¡¨æ ¼å½¢å¼å±•ç¤ºè¯¥ç±»å¯¹è±¡åˆ—è¡¨</strong>ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>åˆ—ç­›é€‰ã€æ’åº</li>
<li>æ–‡æœ¬æœç´¢ï¼ˆ<code>Ctrl+F</code>ï¼‰</li>
<li>å¯¼å‡ºä¸º CSV/Excel</li>
<li><strong>æœ¬åœ°è¿‡æ»¤</strong>ï¼ˆæ— éœ€å†™ SQLï¼ï¼‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/320e7323215c4323a3aca545fbaaeb0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=SzMMbsfnICeK0zzfUsLTqXd8GwU%3D" alt="" loading="lazy"/><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab9e908b369a4ab58cd81c0d290326d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=UrOlDLJXVgTtoYEaiLgs%2FmSldW4%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¯ å®æˆ˜æ¡ˆä¾‹ï¼šæŸ¥ PostgreSQL ä¸­æ‰€æœ‰ <code>VOLATILE</code> å‡½æ•°ï¼Ÿæ‰“å¼€ <code>functions</code> èŠ‚ç‚¹ â†’ ç­› <code>volatility = 'volatile'</code></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ğŸ§® 9. éšè—è®¡ç®—å™¨ï¼ˆSearch Everywhere é‡Œçš„å½©è›‹ï¼‰</h2>
<ol>
<li><code>Double Shift</code> å‘¼å‡º <code>Search Everywhere</code></li>
<li>åˆ‡æ¢åˆ° <code>All</code> æ ‡ç­¾é¡µ</li>
<li>ç›´æ¥è¾“å…¥ç®—å¼ï¼ˆå¦‚ <code>1024 * 8 + 512</code>ï¼‰â†’ ç»“æœå®æ—¶æ˜¾ç¤ºï¼</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01fc435f21b64bb997e06f4d400e7826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=ACUr6fkQzHku1mFVkN9X%2BnVeics%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ˜„ çº¯è¶£å‘³åŠŸèƒ½ï¼Ÿä¸ï¼å†™åˆ†é¡µ SQL æ—¶å¿«é€Ÿç®— <code>OFFSET</code> / <code>LIMIT</code> å€¼è¶…æ–¹ä¾¿ï½</p>
</blockquote>
<hr/>
<h2 data-id="heading-10">ğŸ¤– 10. AI èŠå¤©ä¸­â€œ@â€é™„æ•°æ®åº“å¯¹è±¡ï¼ˆ2025 å¿…å¤‡ï¼ï¼‰</h2>
<p>åœ¨ DataGrip å†…ç½® AI èŠå¤©æ¡†ä¸­ï¼š</p>
<ol>
<li>è¾“å…¥ <code>@</code> æˆ– <code>#</code></li>
<li>è¾“å…¥ <code>dbObject:</code></li>
<li>é€‰æ‹©è¡¨/è§†å›¾/å‡½æ•°ç­‰ â†’ è‡ªåŠ¨é™„åŠ å…¶å®Œæ•´å…ƒæ•°æ®ï¼ˆç»“æ„ã€æ³¨é‡Šã€æ ·ä¾‹æ•°æ®ï¼‰</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df17db341c5f471892c3250a0e2906a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=VSYGLdsMS8kFcBJXxLM0wjfTaYA%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸŒŸ ä¼˜åŠ¿ï¼šé¿å…â€œå¤§æ¨¡å‹å¹»è§‰â€ï¼Œè®© AI ç²¾å‡†ç†è§£ä½ å½“å‰æ“ä½œçš„è¡¨ç»“æ„ï¼Œç”Ÿæˆå¯é  SQL / æ³¨é‡Š / ä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ğŸ ç»“è¯­ï¼šåå¹´ç£¨ä¸€å‰‘ï¼Œæ·±è—åŠŸä¸å</h2>
<p>DataGrip å·²ä¸åªæ˜¯â€œå†™ SQL çš„å·¥å…·â€ï¼Œå®ƒé›†æˆäº†ï¼š</p>
<ul>
<li>âš¡ å¼€å‘æ•ˆç‡åŠ é€Ÿå™¨</li>
<li>ğŸ›¡ï¸ æ•°æ®å®‰å…¨å®ˆé—¨äºº</li>
<li>ğŸ¤– AI å¢å¼ºç”Ÿäº§åŠ›ä¼™ä¼´</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘]]></title>    <link>https://juejin.cn/post/7585553799298334766</link>    <guid>https://juejin.cn/post/7585553799298334766</guid>    <pubDate>2025-12-21T09:48:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585553799298334766" data-draft-id="7585534343562297394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘"/> <meta itemprop="keywords" content="Unreal Engine"/> <meta itemprop="datePublished" content="2025-12-21T09:48:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¤°å­ä¸æ˜¯åŸå­"/> <meta itemprop="url" content="https://juejin.cn/user/661238026361450"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/661238026361450/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¤°å­ä¸æ˜¯åŸå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:48:44.000Z" title="Sun Dec 21 2025 09:48:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/511c7d807a6a4a9fa0c11e09e2b76ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=ltmw53OKTVflxxKyixKZkTJf9ao%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>åœ¨ç¬¬ä¸€äººç§°æ¸¸æˆä¸­ï¼Œç©å®¶ä»å…¶æ‰€æ‰®æ¼”è§’è‰²çš„è§†ç‚¹æ¥æŸ¥çœ‹æ¸¸æˆã€‚ä¸€äº›ç¬¬ä¸€äººç§°æ¸¸æˆä¼šæ˜¾ç¤ºè§’è‰²æ¨¡å‹çš„æŸéƒ¨åˆ†ï¼Œä¾‹å¦‚è§’è‰²çš„æ‰‹è‡‚æˆ–æ­¦å™¨ã€‚è¿™ä¸<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.epicgames.com%2Fdocumentation%2Fzh-cn%2Funreal-engine%2Fthird-person-template-in-unreal-engine" target="_blank" title="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/third-person-template-in-unreal-engine" ref="nofollow noopener noreferrer">ç¬¬ä¸‰äººç§°æ¸¸æˆ</a>ä¸åŒï¼Œåœ¨åè€…ä¸­ï¼Œä½ å¯ä»¥ä»è§’è‰²èƒŒåç•¥ä¸Šæ–¹çš„ä½ç½®çœ‹åˆ°è§’è‰²åŠ¨ä½œã€‚</p>
</blockquote>
<h3 data-id="heading-1">1. é¡¹ç›®æ¦‚è§ˆ</h3>
<p>å¯ä»¥çœ‹åˆ°<code>Content</code>ç›®å½•ä¸‹æœ‰å¦‚ä¸‹å››ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6df34881e4b4273bce3f96792f9c11a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=adf7QG7vEP5qi3xMlDzqS0Uta7w%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥é€ä¸€åˆ†ææ¯ä¸€ä¸ªæ–‡ä»¶å¤¹çš„å†…éƒ¨ç»“æ„</p>
<h4 data-id="heading-2">1.1 â­ è§’è‰² <code>Characters</code></h4>
<p>è§’è‰²æ–‡ä»¶å¤¹é‡Œé¢åªæœ‰ä¸€ä¸ªè§’è‰²<code>Mannequins</code>ï¼Œæ„ä¸ºâ€œæ¨¡ç‰¹â€ï¼Œå¯ä»¥ç†è§£ä¸º<strong>å…¶ä»–è§’è‰²çš„åŸºç¡€ç±»</strong>ã€‚<code>Mannequins</code>åŒ…å«äº”ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddd28e066e6c4c6d9fd778d734eebfc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=6hMVa%2B9HlNhSSN8vLxIZ8GQYuN8%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<h4 data-id="heading-3"><code>Anims</code>ï¼šå­˜æ”¾è§’è‰²çš„åŠ¨ç”»åºåˆ—</h4>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒçš„åŠ¨ç”»è¢«åˆ†é—¨åˆ«ç±»ï¼Œæ”¾åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹é‡Œ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfbe3f1354cd4b0bbb57c36be725ee61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=0K47HV7lMozWvQzBLAe4TRraWvY%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬é€‰æ‹©å…¶ä¸­çš„<code>Unarmed</code>ï¼ˆæœªæ‰‹æŒæ­¦å™¨ï¼‰çš„åŠ¨ç”»é›†åˆä¸ºä¾‹è¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ç§ä¸åŒçš„æ–‡ä»¶ï¼š</p>
<ul>
<li><strong>åŠ¨ç”»è“å›¾ï¼š</strong> <strong>è¿æ¥æ¸¸æˆé€»è¾‘å’Œæ‰€æœ‰åŠ¨ç”»èµ„æº</strong>ï¼ˆåŠ¨ç”»åºåˆ—ã€æ··åˆç©ºé—´ï¼‰ï¼Œæ ¹æ®æ¸¸æˆçŠ¶æ€è¾“å‡ºæœ€ç»ˆçš„è§’è‰²åŠ¨ç”»</li>
<li><strong>æ··åˆç©ºé—´ï¼š</strong> åŸºäºæŒ‡å®šå‚æ•°ï¼ˆå¦‚é€Ÿåº¦ã€è½¬å‘è§’åº¦ï¼‰ï¼Œè‡ªåŠ¨å¹³æ»‘æ··åˆå¤šä¸ªç›¸ä¼¼åŠ¨ç”»åºåˆ—çš„èµ„æºï¼Œ<strong>è§£å†³å¤šä¸ªåŠ¨ç”»ä¹‹é—´å¡é¡¿åˆ‡æ¢çš„é—®é¢˜</strong></li>
<li><strong>åŠ¨ç”»åºåˆ—ï¼š</strong> <strong>å­˜å‚¨å•ä¸€ã€ç‹¬ç«‹åŠ¨ç”»åŠ¨ä½œçš„åŸºç¡€èµ„æº</strong>ï¼Œç›¸å½“äºåŠ¨ä½œç‰‡æ®µï¼Œæ˜¯è§’è‰²åŠ¨ç”»çš„åŸææ–™</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecdbc18e89c8418fbc69eb4e7d7afda3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=zwZBWAW64pXn6flB5xvzqEyGI3U%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dc30c1642884c6f9271845b1321d740~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=FdsL%2FFPCmjl5WX%2FGgsM0JoD6d6k%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä½ éœ€è¦ä¿®æ”¹æ¨¡å‹çš„è¡Œèµ°åŠ¨ç”»ï¼Œæ¯”å¦‚å°†æ‘†è‡‚çš„å¹…åº¦åŠ å¤§ï¼Œä½ å¯ä»¥ä¿®æ”¹å¯¹åº”çš„åŠ¨ç”»åºåˆ—æ–‡ä»¶ï¼Œä½†è¿™æ˜¯æ¸¸æˆç¾æœ¯éœ€è¦è€ƒè™‘çš„äº‹æƒ…ã€‚</p>
<ul>
<li>
<h4 data-id="heading-4"><code>Materials</code>ï¼šå­˜æ”¾è§’è‰²çš„æè´¨</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c264873f5406421e8c9740e9b5b1a968~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=0o8p8f3U1ni4mHqjntwK9I7r4a4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6fbf6c253e141c48a38cab0d6eb5940~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=mWeor91LAMqWFBXjizB3C9RnY8Y%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>æ–‡ä»¶å¤¹<code>Manny</code>/<code>Quinn</code>ï¼šåˆ†åˆ«å¯¹åº”é»˜è®¤çš„ä¸¤ä¸ªäººä½“æ¨¡ç‰¹ï¼ˆç”·æ€§/å¥³æ€§ï¼‰çš„ä¸“å±æè´¨èµ„æº</li>
<li><code>M_Mannequin</code>ï¼šæ˜¯<strong>äººä½“æ¨¡ç‰¹çš„åŸºç¡€æè´¨</strong>ï¼ˆæˆ–æè´¨å®ä¾‹ï¼‰ï¼Œç›´æ¥æ§åˆ¶äººä½“æ¨¡ç‰¹çš„è§†è§‰è¡¨ç°ï¼ˆæ¯”å¦‚é»˜è®¤çš„ç°ç™½çº¹ç†å¤–è§‚ï¼‰</li>
</ul>
<blockquote>
<p>Qï¼š<strong>æè´¨å’Œæè´¨å®ä¾‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>Aï¼š<strong>Materialæ˜¯æè´¨çš„æ¯ç‰ˆ</strong>ï¼Œå¯ä»¥ç¼–è¾‘Shaderç½‘ç»œã€è®¾ç½®åŸºç¡€æ¸²æŸ“å±æ€§ï¼ˆæ¯”å¦‚æ˜¯å¦é€æ˜ã€å…‰ç…§å“åº”æ–¹å¼ï¼‰ï¼›è€Œ<strong>Material Instanceæ˜¯åŸºäºåŸºç¡€æè´¨åˆ›å»ºçš„å­èµ„æº</strong>ï¼Œç»§æ‰¿åŸºç¡€æè´¨çš„æ‰€æœ‰å±æ€§ï¼Œä½†å¯ä»¥å•ç‹¬ä¿®æ”¹éƒ¨åˆ†å‚æ•°ï¼ˆæ¯”å¦‚é¢œè‰²ã€çº¹ç†ã€ç²—ç³™åº¦ï¼‰ï¼Œä¸ç”¨é‡æ–°åšæ•´ä¸ªæè´¨ï¼Œèƒ½å¤§å¹…æå‡èµ„æºå¤ç”¨å’Œè°ƒæ•´æ•ˆç‡ã€‚</p>
</blockquote>
<ul>
<li>
<h4 data-id="heading-5"><code>Mesh</code>ï¼šè§’è‰²çš„ç½‘æ ¼å›¾å½¢</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d853789ce9f4bdbb42eba35cd822d38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=WfenMUT4coG4toj7BSI1Ww%2Beagw%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>Meshå­˜å‚¨äº†ç‰©ä½“çš„é¡¶ç‚¹ã€é¢ã€æ³•çº¿ç­‰å‡ ä½•æ•°æ®ï¼Œå†³å®šäº†è§’è‰²åœ¨æ¸¸æˆé‡Œå‘ˆç°å‡ºçš„å½¢çŠ¶ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°<code>Mesh</code>æ–‡ä»¶å¤¹é‡Œé¢æœ‰ä¸¤ç§æ–‡ä»¶ï¼š</p>
<ul>
<li>
<p><strong>Skeleton</strong> ï¼š<strong>è§’è‰²çš„åŠ¨ç”»éª¨æ¶</strong>,å®šä¹‰äº†è§’è‰²èƒ½æ´»åŠ¨çš„å…³èŠ‚é€»è¾‘</p>
</li>
<li>
<p><strong>Skeletal Mesh</strong> ï¼šè¿™æ˜¯<strong>ç»‘å®šäº†éª¨éª¼çš„Mesh</strong>ï¼Œæ—¢åŒ…å«è§’è‰²çš„å‡ ä½•å½¢çŠ¶ï¼Œåˆå’Œéª¨éª¼èµ„æºå…³è”ï¼Œèƒ½é©±åŠ¨éª¨éª¼åŠ¨ç”»</p>
</li>
<li>
<h4 data-id="heading-6"><code>Rigs</code>ï¼šè§’è‰²çš„åŠ¨ç”»æ§åˆ¶ä¸ç‰©ç†äº¤äº’è¾…åŠ©</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1429dbcbdeaf47fcabfd12ed66a7016f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=1TsNCFD80Dj%2B73EgdiWdAStPc68%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°<code>Rigs</code>é‡ŒåŒ…å«ä¸¤ç±»æ ¸å¿ƒèµ„æºï¼š</p>
<ul>
<li><strong>Control Rig</strong>ï¼šå¯è§†åŒ–çš„éª¨éª¼æ§åˆ¶å·¥å…·ï¼Œè´Ÿè´£è°ƒæ•´è§’è‰²å§¿æ€ã€è¡¥å…¨åŠ¨ç”»ç»†èŠ‚ï¼›</li>
<li><strong>Physical Asset</strong>ï¼šç»‘å®šéª¨éª¼çš„ç¢°æ’é…ç½®èµ„æºï¼Œè´Ÿè´£å¤„ç†è§’è‰²çš„ç‰©ç†ç¢°æ’ã€å—åŠ›åé¦ˆã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯¹æ–‡ä»¶å¤¹é‡Œçš„æ¯ä¸ªæ–‡ä»¶è¿›è¡Œè§£æï¼š</p>
<ol>
<li><strong><code>CR_Mannequin_Body</code></strong>ï¼š<strong>èº«ä½“æ§åˆ¶</strong>ï¼Œè°ƒæ•´è§’è‰²èº«ä½“å„å…³èŠ‚çš„å§¿æ€ï¼Œä¹Ÿèƒ½ç»™ç°æœ‰åŠ¨ç”»å åŠ ç»†èŠ‚ï¼Œè®©åŠ¨ç”»æ›´ç”ŸåŠ¨</li>
<li><strong><code>CR_Mannequin_FootIK</code></strong>ï¼š<strong>è„šéƒ¨IKæ§åˆ¶</strong>ï¼Œè§£å†³åŠ¨ç”»ç©¿æ¨¡é—®é¢˜ï¼Œè®©è„šéƒ¨è‡ªåŠ¨è´´åˆåœ°é¢ï¼Œä½¿ç§»åŠ¨åŠ¨ç”»æ›´çœŸå®è‡ªç„¶</li>
<li><strong><code>CR_Mannequin_Procedural</code></strong>ï¼š<strong>ç¨‹åºåŒ–æ§åˆ¶</strong>ï¼Œæ ¹æ®è§’è‰²çš„è¿åŠ¨çŠ¶æ€è‡ªåŠ¨è°ƒæ•´è‚¢ä½“ç»†èŠ‚ï¼Œä¸ç”¨æ‰‹åŠ¨é€å¸§ç¼–è¾‘åŠ¨ç”»ï¼Œæå‡åŠ¨ç”»åˆ¶ä½œæ•ˆç‡</li>
<li><strong><code>PA_Mannequin</code></strong>ï¼š<strong>è§’è‰²ç‰©ç†èµ„äº§</strong>ï¼Œç»™è§’è‰²éª¨éª¼ç»‘å®šäº†å¯¹åº”çš„ç¢°æ’ä½“ï¼Œè®©è§’è‰²èƒ½å’Œåœºæ™¯ç‰©ä½“äº§ç”Ÿç¢°æ’ã€å—åˆ°ç‰©ç†åŠ›æ—¶äº§ç”Ÿåé¦ˆç­‰</li>
</ol>
<ul>
<li>
<h4 data-id="heading-7"><code>Textures</code>ï¼šè§’è‰²çš„çº¹ç†</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c140529a55bf4ca9ab3ecf134ab4b53a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=hbU%2B%2FxPzlaKu%2BEcKiZhp4jOXXL0%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ä¸ªå­æ–‡ä»¶å¤¹ï¼Œå…¶ä½œç”¨ä¹Ÿå¾ˆæ¸…æ™°ï¼š</p>
<ul>
<li><strong><code>Manny</code></strong>ï¼šç”·æ€§æ¨¡ç‰¹çš„ä¸“å±çº¹ç†æ–‡ä»¶å¤¹</li>
<li><strong><code>Quinn</code></strong>ï¼šå¥³æ€§æ¨¡ç‰¹çš„ä¸“å±çº¹ç†æ–‡ä»¶å¤¹</li>
<li><strong><code>Shared</code></strong>ï¼šä¸¤ä¸ªæ¨¡ç‰¹å…±ç”¨çš„çº¹ç†æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚é€šç”¨çš„å¸ƒæ–™åº•è‰²ã€é‡‘å±è£…é¥°çº¹ç†ç­‰</li>
</ul>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åˆ†æäº†è§’è‰²æ–‡ä»¶å¤¹<code>Characters</code>å†…çš„æ‰€æœ‰å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªUEå®˜æ–¹ç»™å‡ºçš„åŠŸèƒ½ç›¸å¯¹å®Œå–„çš„è§’è‰²åŸºç¡€æ¨¡æ¿ï¼Œæˆ‘ä»¬åç»­å¯ä»¥<strong>åœ¨å…¶åŸºç¡€ä¸Šæ‹“å±•å‡ºä¸åŒç±»å‹çš„è§’è‰²</strong>ã€‚</p>
<h4 data-id="heading-8">1.2 è¾“å…¥é…ç½® <code>Input</code></h4>
<p>å…ˆé€šè§ˆä¸€ä¸‹<code>Input</code>æ–‡ä»¶å¤¹å†…çš„å†…å®¹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24071fd6cbc5433bb40f3e05f5c7aa07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=QLWibas1mdmXE8WeEPhisP3Rd7c%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f23c15999dd345dd920090b4a3d636cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=%2BJReXUNSxzCNNvdAWJaGkB16Fu8%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53d0f13247c24ea8a347dcf1b5fe52d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=AgBQtd6%2BWdBSwHyZtgNhYGau6oY%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡</strong>æ˜¯è¾“å…¥çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œ<code>IMC_Default</code>/<code>IMC_MouseLook</code>ç”¨æ¥åˆ‡æ¢ä¸åŒçš„è¾“å…¥è§„åˆ™ï¼ˆæ¯”å¦‚<code>IMC_Default</code>æ˜¯é»˜è®¤å…¨æ“ä½œï¼Œ<code>IMC_MouseLook</code>æ˜¯ä»…å…è®¸é¼ æ ‡æ§åˆ¶è§†è§’çš„ç®€åŒ–æ“ä½œï¼‰ã€‚</li>
<li><code>Actions</code>æ˜¯<strong>åŠ¨ä½œè¾“å…¥çš„æ˜ å°„åº“</strong>ï¼ŒåŒ…å«â€œæ“ä½œâ€”â€”æ¸¸æˆåŠ¨ä½œâ€çš„å…·ä½“ç»‘å®šé…ç½®ï¼ŒæŠŠç©å®¶çš„æŒ‰é”®æˆ–æ“ä½œå¯¹åº”åˆ°å…·ä½“çš„æ¸¸æˆåŠŸèƒ½
<ul>
<li><code>IA_Jump</code>ï¼šè§¦å‘è§’è‰²è·³è·ƒ</li>
<li><code>IA_Move</code>ï¼šæ§åˆ¶è§’è‰²ç§»åŠ¨</li>
<li><code>IA_Look</code>/<code>IA_MouseLook</code>ï¼šç»‘å®šè§†è§’æ“ä½œå¹¶è½¬åŠ¨è§’è‰²è§†è§’</li>
</ul>
</li>
<li><code>Touch</code>æ˜¯<strong>è§¦å±è®¾å¤‡çš„ä¸“å±è¾“å…¥é…ç½®</strong>
<ul>
<li><code>UI_Thumbstick</code>ï¼šè™šæ‹Ÿæ‘‡æ†æ§ä»¶ï¼Œå¯¹åº”æ‰‹æŸ„å·¦æ‘‡æ†ï¼ˆè§¦å±æ—¶æ‹–åŠ¨æ‘‡æ†æ§åˆ¶ç§»åŠ¨ï¼‰</li>
<li><code>BP_TouchInterface</code>ï¼šè§¦æ‘¸äº¤äº’çš„é€»è¾‘è“å›¾ï¼Œç®¡ç†è§¦å±æ“ä½œçš„è¯†åˆ«è§„åˆ™</li>
<li><code>UI_TouchSimple</code>ï¼šç®€å•è§¦æ‘¸æŒ‰é’®é…ç½®</li>
</ul>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†ç»™è§’è‰²åŠ å…¥ä¸€ä¸ª<strong>ç„å‡†</strong>åŠ¨ä½œï¼Œæˆ‘éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼š</p>
<ol>
<li>æ–°å»ºä¸€ä¸ª<code>IA_Aim</code>åŠ¨ä½œ</li>
<li>å°†é¼ æ ‡å³é”®ç‚¹å‡»äº‹ä»¶ç»‘å®šåˆ°<code>IA_Aim</code>åŠ¨ä½œ</li>
<li>åœ¨è§’è‰²è“å›¾ä¸­æ·»åŠ ç›¸å…³äº‹ä»¶çš„å¤„ç†é€»è¾‘ï¼Œå¦‚æ›´æ”¹FOVã€å‡å°‘æŠ–åŠ¨ç­‰</li>
</ol>
<h4 data-id="heading-9">1.3 å…³å¡åŸå‹ <code>LevelPrototyping</code></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2048c49cbec4a3ab47569693d84cb7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=zBAJ0%2FUDbwzZWu%2BnkjAmzufqqwk%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨äºå­˜æ”¾æ­å»ºæµ‹è¯•å…³å¡æ‰€éœ€çš„èµ„æº</p>
<ul>
<li><code>Interactable</code>ï¼š<strong>å…³å¡åŸå‹çš„äº¤äº’ç‰©ä½“åº“</strong>ï¼Œå­˜æ”¾å…³å¡ä¸­èƒ½å’Œç©å®¶äº§ç”Ÿäº’åŠ¨çš„ç‰©ä½“èµ„æºï¼ˆæ¯”å¦‚å¯æ‹¾å–çš„é“å…·ã€å¯è§¦å‘çš„æœºå…³ã€å¯æ‰“å¼€çš„é—¨ï¼‰</li>
<li><code>Materials</code>ï¼šå…³å¡åŸå‹çš„åŸºç¡€æè´¨åŒ…</li>
<li><code>Meshes</code>ï¼šå…³å¡åŸå‹çš„åœºæ™¯å‡ ä½•ä½“</li>
<li><code>Textures</code>ï¼šå…³å¡åŸå‹çš„ç®€åŒ–çº¹ç†ç´ æ</li>
</ul>
<p>åŸºäºè¿™äº›åŸå‹èµ„æºï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºä¾›æµ‹è¯•ç”¨çš„åœ°å›¾ä»¥éªŒè¯æ ¸å¿ƒç©æ³•ï¼Œæ— éœ€ç­‰å¾…ç¾æœ¯èµ„æºå…¨éƒ¨åˆ¶ä½œå®Œæ¯•ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p>
<h4 data-id="heading-10">1.4 â­ ç¬¬ä¸€äººç§°æ¨¡æ¿ <code>FirstPerson</code></h4>
<p>è¿™æ˜¯æœ¬èŠ‚çš„é‡ä¸­ä¹‹é‡ï¼ŒåŒ…å«äº†ç¬¬ä¸€äººç§°è§’è‰²çš„æ§åˆ¶ç›¸å…³çš„åŠŸèƒ½ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8d40ab3979c45c981fd2eba6710eb9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=i%2FB1ZA%2FjXFZ8Ps1rQcT5T9mNDpw%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªç‹¬ç«‹æ–‡ä»¶ï¼š</p>
<ul>
<li><code>Lvl_FirstPerson</code>æ˜¯<strong>ç¬¬ä¸€äººç§°ç©æ³•çš„æ¼”ç¤ºåœºæ™¯</strong>ï¼Œå·²ç»æ­å¥½é€‚é…ç¬¬ä¸€äººç§°è§†è§’çš„åŸºç¡€å…³å¡ï¼ˆæ¯”å¦‚ç®€å•çš„æˆ¿é—´ã€å¯äº¤äº’çš„é“å…·ï¼‰ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥æµ‹è¯•ç¬¬ä¸€äººç§°çš„ç§»åŠ¨ã€äº¤äº’ç­‰æ ¸å¿ƒç©æ³•</li>
<li><code>MI_FirstPersonColorway</code>æ˜¯<strong>ç¬¬ä¸€äººç§°å¯è§ç‰©ä½“ï¼ˆæ¯”å¦‚æ­¦å™¨ã€æ‰‹è‡‚æ¨¡å‹ï¼‰çš„å¤–è§‚é…ç½®èµ„æº</strong>ï¼Œèƒ½å•ç‹¬è°ƒæ•´è¿™äº›å…ƒç´ çš„é¢œè‰²ã€è´¨æ„Ÿï¼ˆæ¯”å¦‚æŠŠæ­¦å™¨æ”¹æˆé»„è‰²ã€è°ƒæ•´æ‰‹è‡‚æ¨¡å‹çš„å…‰æ³½åº¦ï¼‰ï¼Œä¸ç”¨ä¿®æ”¹åŸºç¡€æè´¨å°±èƒ½å¿«é€Ÿåˆ‡æ¢å¤–è§‚é£æ ¼</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b98bcfad26349a2a99ffbcd439622e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=fCF92CxycADTKmut57VN%2B%2FtoBsY%3D" alt="image.png" loading="lazy"/></p>
<p><code>Anims</code>æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾è§’è‰²çš„åŠ¨ç”»åºåˆ—ï¼Œç›¸æ¯”åŸºç¡€æ¨¡ç‰¹ï¼Œè¿™é‡Œçš„åŠ¨ç”»åºåˆ—å¤šäº†ä»¥ä¸‹ä¸¤ä¸ªï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4c5f1e6a9e9427ca40f023957795810~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=YvQp0YZTQedE1fsbji%2FN69batro%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong><code>ABP_FP_Copy</code>ï¼ˆåŠ¨ç”»è“å›¾ï¼‰</strong> ï¼šè´Ÿè´£æ¥æ”¶ç¬¬ä¸€äººç§°çš„æ“ä½œè¾“å…¥ï¼Œè°ƒç”¨å¯¹åº”çš„åŠ¨ç”»èµ„æºï¼Œ<strong>è¾“å‡ºæœ€ç»ˆçš„ç¬¬ä¸€äººç§°åŠ¨ç”»è¡¨ç°</strong></li>
<li><strong><code>CtrlRig_FPWarp</code>ï¼ˆControl Rigï¼‰</strong> ï¼šè´Ÿè´£<strong>ç²¾ç»†è°ƒæ•´ç¬¬ä¸€äººç§°å¯è§éƒ¨åˆ†çš„å§¿æ€</strong>ï¼Œè®©åŠ¨ä½œæ›´çœŸå®è‡ªç„¶</li>
</ul>
<p><code>Blueprints</code>æ–‡ä»¶å¤¹ä¸‹æœ‰å››ä¸ªè“å›¾æ–‡ä»¶ï¼Œè¿™å››ä¸ªè“å›¾æ˜¯æ”¯æ’‘ç¬¬ä¸€äººç§°ç©æ³•çš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œåˆ†å·¥è¦†ç›–äº† <strong>è§’è‰²å®ä½“ã€æ“ä½œæ§åˆ¶ã€è§†è§’ç®¡ç†ã€å…³å¡è§„åˆ™</strong>ã€‚</p>
<ul>
<li><strong><code>BP_FirstPersonCharacter</code>ï¼ˆè§’è‰²è“å›¾ï¼‰</strong>
<ul>
<li>å¤„ç†ç§»åŠ¨ã€è·³è·ƒç­‰åŸºç¡€åŠ¨ä½œé€»è¾‘</li>
<li>ç®¡ç†è§’è‰²çš„çŠ¶æ€ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€äº¤äº’çŠ¶æ€ï¼‰</li>
<li>ç»‘å®šç¬¬ä¸€äººç§°è§†è§’ä¸‹çš„å¯è§å…ƒç´ ï¼ˆå¦‚æ‰‹è‡‚ã€æ‰‹æŒé“å…·ï¼‰</li>
</ul>
</li>
<li><strong><code>BP_FirstPersonPlayerController</code>ï¼ˆç©å®¶æ§åˆ¶å™¨è“å›¾ï¼‰</strong>
<ul>
<li>æ¥æ”¶ç©å®¶çš„è¾“å…¥å¹¶ä¼ é€’ç»™è§’è‰²è“å›¾</li>
<li>ç®¡ç†ç¬¬ä¸€äººç§°è§†è§’çš„æ§åˆ¶é€»è¾‘</li>
<li>ä¼ é€’UIä¸è§’è‰²ä¹‹é—´çš„äº¤äº’æŒ‡ä»¤</li>
</ul>
</li>
<li><strong><code>BP_FP_CameraManager</code>ï¼ˆç›¸æœºç®¡ç†å™¨è“å›¾ï¼‰</strong>
<ul>
<li>æ§åˆ¶ç›¸æœºçš„è·Ÿéšè§„åˆ™</li>
<li>å®ç°è§†è§’çš„åŠ¨æ€æ•ˆæœ</li>
<li>é™åˆ¶è§†è§’çš„è½¬åŠ¨èŒƒå›´</li>
</ul>
</li>
<li><strong><code>GM_FirstPerson</code>ï¼ˆæ¸¸æˆæ¨¡å¼è“å›¾ï¼‰</strong>
<ul>
<li>å®šä¹‰å…³å¡çš„æ ¸å¿ƒè§„åˆ™</li>
<li>ç®¡ç†å…³å¡å†…çš„èµ„æºåˆ·æ–°ã€æ•Œäººé…ç½®ç­‰å…¨å±€é€»è¾‘</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class GM_FirstPerson {
        +å®šä¹‰å…³å¡çš„æ ¸å¿ƒè§„åˆ™
        +ç®¡ç†å…³å¡å†…çš„èµ„æºåˆ·æ–°ã€æ•Œäººé…ç½®ç­‰å…¨å±€é€»è¾‘
    }
    class BP_FirstPersonPlayerController {
        +æ¥æ”¶ç©å®¶çš„è¾“å…¥å¹¶ä¼ é€’ç»™è§’è‰²è“å›¾
        +ç®¡ç†ç¬¬ä¸€äººç§°è§†è§’çš„æ§åˆ¶é€»è¾‘
        +ä¼ é€’UIä¸è§’è‰²ä¹‹é—´çš„äº¤äº’æŒ‡ä»¤
    }
    class BP_FirstPersonCharacter {
        +å¤„ç†ç§»åŠ¨ã€è·³è·ƒç­‰åŸºç¡€åŠ¨ä½œé€»è¾‘
        +ç®¡ç†è§’è‰²çš„çŠ¶æ€ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€äº¤äº’çŠ¶æ€ï¼‰
        +ç»‘å®šç¬¬ä¸€äººç§°è§†è§’ä¸‹çš„å¯è§å…ƒç´ ï¼ˆå¦‚æ‰‹è‡‚ã€æ‰‹æŒé“å…·ï¼‰
    }
    class BP_FP_CameraManager {
        +æ§åˆ¶ç›¸æœºçš„è·Ÿéšè§„åˆ™
        +å®ç°è§†è§’çš„åŠ¨æ€æ•ˆæœ
        +é™åˆ¶è§†è§’çš„è½¬åŠ¨èŒƒå›´
    }

    GM_FirstPerson &lt;|-- BP_FirstPersonPlayerController : ä½¿ç”¨
    BP_FirstPersonPlayerController --&gt; BP_FirstPersonCharacter : æ§åˆ¶/Possess
    BP_FirstPersonCharacter --&gt; BP_FP_CameraManager : åŒ…å«/ä½¿ç”¨
    BP_FirstPersonCharacter --&gt; ABP_FP_Copy : ä½¿ç”¨åŠ¨ç”»è“å›¾
    BP_FirstPersonCharacter --&gt; CtrlRig_FPWarp : ä½¿ç”¨Control Rig
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£äº†è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯¹ç¨‹åºçš„æ ¸å¿ƒâ€”â€”<code>FirstPerson</code>æ–‡ä»¶å¤¹ä¸‹çš„å››ä¸ªè“å›¾è¿›è¡Œåˆ†æï¼Œäº†è§£æ¸¸æˆæ ¸å¿ƒé€»è¾‘æ˜¯å¦‚ä½•ç¼–å†™çš„ã€‚</p>
<h3 data-id="heading-11">2. <code>FirstPerson</code> æ ¸å¿ƒé€»è¾‘åˆ†æ</h3>
<h4 data-id="heading-12">2.1 â­ <code>BP_FirstPersonCharacter</code></h4>
<p>å…ˆå¯¹è¯¥è“å›¾æ‰€æ‹¥æœ‰çš„ç»„ä»¶è¿›è¡Œæ¦‚è§ˆï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c8d58b5fbc0466d97ed7b8fa60650c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=789WePbzeDyUrFE0RxpKvdZr8Vg%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>èƒ¶å›Šä½“ç»„ä»¶ (CollisionCylinder)</strong> ï¼šè§’è‰²æ ¹ç»„ä»¶ï¼Œç”¨äº<strong>å¤„ç†åŸºæœ¬ç¢°æ’æ£€æµ‹</strong>å’Œ<strong>é˜²æ­¢è§’è‰²ç©¿é€ä¸–ç•Œç‰©ä½“</strong></li>
<li><strong>ç®­å¤´ç»„ä»¶ (Arrow)</strong> ï¼šå¯è§†åŒ–æ–¹å‘ç®­å¤´ï¼Œç”¨äºåœ¨ç¼–è¾‘å™¨ä¸­<strong>è¡¨ç¤ºè§’è‰²æœå‘</strong>ï¼Œä¾¿äºè°ƒè¯•å’Œå®šä½</li>
<li><strong>ç½‘æ ¼ä½“ (CharacterMesh0)</strong> ï¼šç¬¬ä¸‰äººç§°è§†å›¾ä¸‹çš„<strong>å®Œæ•´è§’è‰²éª¨éª¼ç½‘æ ¼</strong>ï¼ˆSkeletal Meshï¼‰ï¼Œåœ¨ç¬¬ä¸€äººç§°æ¨¡å¼ä¸‹é€šå¸¸éšè—ï¼Œä»…ä»–äººå¯è§</li>
<li><strong>FirstPersonMesh</strong>ï¼šç¬¬ä¸€äººç§°è§†å›¾ä¸‹çš„<strong>æ‰‹è‡‚/æ­¦å™¨éª¨éª¼ç½‘æ ¼</strong>ï¼Œä»…æ‹¥æœ‰ç©å®¶å¯è§ï¼Œéšç›¸æœºç§»åŠ¨</li>
<li><strong>FirstPersonCamera</strong>ï¼šç¬¬ä¸€äººç§°ç›¸æœºç»„ä»¶ï¼Œæä¾›<strong>ç©å®¶è§†è§’</strong>è§†å›¾ï¼Œå¹¶æ§åˆ¶<strong>å¤´éƒ¨è½¬åŠ¨</strong></li>
<li><strong>è§’è‰²ç§»åŠ¨ (CharMoveComp)</strong> ï¼š<code>CharacterMovementComponent</code>çš„ç®€ç§°ï¼Œè´Ÿè´£<strong>å¤„ç†è§’è‰²ç§»åŠ¨ã€è·³è·ƒã€é‡åŠ›ã€ç¢°æ’å“åº”ç­‰ç‰©ç†é€»è¾‘</strong></li>
</ul>
<p>æœ‰äº†è¿™äº›ç»„ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™å…·ä½“çš„æ§åˆ¶é€»è¾‘ã€‚é€»è¾‘å†™åœ¨è“å›¾çš„äº‹ä»¶å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå¤æ‚çš„æµç¨‹æ‹†è§£æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>
<h5 data-id="heading-13">æµç¨‹å…¥å£</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3ba6b9442c644289399daba2c716fab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=kSkRIlkeUJlyCQkFFq7kyA6vOg0%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åœ¨Pawnè¢«ä»»ä½•Controllerï¼ˆç©å®¶æˆ– AIï¼‰æ¥ç®¡æ—¶è§¦å‘</strong>ï¼Œç”¨äºåŒºåˆ†ç©å®¶æ§åˆ¶ï¼ˆPlayerControllerï¼‰ä¸ AI æ§åˆ¶ï¼ˆAIControllerï¼‰ï¼Œä»¥æ‰§è¡Œä¸åŒé€»è¾‘ï¼ˆå¦‚ä»…ç©å®¶å¯è§çš„ UIã€è¾“å…¥æ˜ å°„ã€ç›¸æœºè®¾ç½®ç­‰ï¼‰ã€‚</p>
<ul>
<li>
<h5 data-id="heading-14">è·¨å¹³å°è¾“å…¥è‡ªé€‚åº”</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05f2052d6f9b45e6a794e0e8defffaf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=dtTAwxotvoazJ3QG731csyqTV4Q%3D" alt="image.png" loading="lazy"/></p>
<p>æ ¹æ®å½“å‰è¿è¡Œå¹³å°æœ‰æ¡ä»¶åœ°æ·»åŠ ä¸€ä¸ªä¸“é—¨ç”¨äºé¼ æ ‡ç„å‡†çš„è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡ï¼ˆIMC_MouseLookï¼‰ï¼ŒåŒæ—¶åœ¨ç§»åŠ¨å¹³å°ä¸Šåˆ›å»ºå¹¶æ˜¾ç¤ºä¸€ä¸ªè§¦æ‘¸UIæ§ä»¶ï¼ˆTarget Touch UIï¼‰ï¼Œä»¥<strong>é¿å…é¼ æ ‡è¾“å…¥ä¸è§¦æ‘¸è¾“å…¥å†²çª</strong>ã€‚</p>
<blockquote>
<p>å¦‚æœä¸æ˜¯è§¦æ‘¸è®¾å¤‡ï¼Œåˆ™æ·»åŠ ç„å‡†æ˜ å°„ä¸Šä¸‹æ–‡ï¼Œå¦åˆ™é¼ æ ‡è¾“å…¥ä¼šå¹²æ‰°è§¦æ‘¸æ“ä½œã€‚å¦‚æœæƒ³åœ¨ Windows ä¸Šæµ‹è¯•è§¦æ‘¸ UIï¼Œå¯ä»¥å¼€å¯â€œUse mouse for touchâ€é€‰é¡¹ï¼Œå¹¶å°† Windows åˆ†æ”¯è®¾ç½®ä¸ºåˆ›å»ºè§¦æ‘¸ UIã€‚</p>
</blockquote>
<ul>
<li>
<h5 data-id="heading-15">è§†è§’æ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71d7619265b140a6be051271a0422f9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=9oze5TWHEqwZuTns14HDEkBnhXM%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€å¥—å…¸å‹çš„<strong>å¤„ç†è§†è§’è¾“å…¥</strong>çš„è“å›¾é€»è¾‘ï¼Œä¸ä¸Šæ–‡è·¨å¹³å°è¾“å…¥çš„é€‚é…å®Œç¾é…åˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æè¿°é€»è¾‘è¦ç‚¹ï¼š</p>

































<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è¾“å…¥åŠ¨ä½œ/äº‹ä»¶</th><th>Xè½´ â†’</th><th>Yè½´ â†’</th><th>æœ€ç»ˆå¤„ç†å‡½æ•°</th></tr></thead><tbody><tr><td>é¼ æ ‡ï¼ˆPCï¼‰</td><td>IA_Lookï¼ˆTriggeredï¼‰</td><td>Yawï¼ˆå·¦å³ï¼‰</td><td>Pitchï¼ˆä¸Šä¸‹ï¼‰</td><td>Aim</td></tr><tr><td>é¼ æ ‡ï¼ˆå¤‡ç”¨/è¡¥å……ï¼‰</td><td>IA_MouseLookï¼ˆTriggeredï¼‰</td><td>Yaw</td><td>Pitch</td><td>Aim</td></tr><tr><td>è§¦æ‘¸å³æ‘‡æ†ï¼ˆç§»åŠ¨ç«¯ï¼‰</td><td>Event Secondary Thumbstick</td><td>Yaw</td><td>Pitch</td><td>Aim</td></tr></tbody></table>
<p>è¿™ä¸€å¥—é€»è¾‘æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p>
<ol>
<li>æ— è®ºé¼ æ ‡è¿˜æ˜¯è§¦æ‘¸æ‘‡æ†ï¼Œ<strong>æœ€ç»ˆéƒ½è°ƒç”¨åŒä¸€ä¸ªAimå‡½æ•°</strong>ï¼Œå¯ä»¥ç¡®ä¿è§†è§’æ§åˆ¶é€»è¾‘ä¸€è‡´</li>
<li>å®Œç¾é…åˆäº†å‰ä¸€å¼ å›¾çš„é€»è¾‘â€”â€”ç§»åŠ¨ç«¯å¼¹å‡ºè§¦æ‘¸UIå¹¶è§¦å‘æ­¤äº‹ä»¶ï¼ŒPCç«¯ä½¿ç”¨é¼ æ ‡è¾“å…¥åŠ¨ä½œã€‚</li>
<li><strong>æ‰€æœ‰è¾“å…¥éƒ½é€šè¿‡Input Actionå®šä¹‰</strong>ï¼Œä¾¿äºåœ¨Project Settingsä¸­ç»Ÿä¸€ç»‘å®šé”®ä½ã€è°ƒæ•´æ›²çº¿ã€æ·»åŠ ä¿®é¥°å™¨ï¼ˆå¦‚æ­»åŒºã€çµæ•åº¦ï¼‰ã€‚</li>
</ol>
<ul>
<li>
<h5 data-id="heading-16">ç§»åŠ¨æ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3db3fca1569c40caaca4d723dab21284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=M91hFMr8D9LLjMqZr9fJNhCiOnI%3D" alt="image.png" loading="lazy"/></p>
<p>å®ç°äº†<strong>é”®ç›˜ä¸è§¦æ‘¸æ‘‡æ†çš„ç»Ÿä¸€ç§»åŠ¨æ§åˆ¶</strong>ï¼Œä¸¤ç§è¾“å…¥æºçš„X/Yè½´å€¼éƒ½æ±‡å…¥Moveå‡½æ•°ï¼Œé©±åŠ¨ç¬¬ä¸€äººç§°è§’è‰²çš„å‰åå·¦å³å¹³ç§»ã€‚</p>
<p>åŒæ ·æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¯ é‡Šè¿™ä¸€å¥—é€»è¾‘ï¼š</p>


























<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è¾“å…¥åŠ¨ä½œ/äº‹ä»¶</th><th>Xè½´ â†’</th><th>Yè½´ â†’</th><th>æœ€ç»ˆå¤„ç†å‡½æ•°</th></tr></thead><tbody><tr><td><strong>é”®ç›˜ï¼ˆPCï¼‰</strong></td><td>IA_Moveï¼ˆTriggeredï¼‰</td><td>Left/Right</td><td>Forward/Backward</td><td>Move</td></tr><tr><td><strong>è§¦æ‘¸å·¦æ‘‡æ†ï¼ˆç§»åŠ¨ç«¯ï¼‰</strong></td><td>Event Primary Thumbstick</td><td>Left/Right</td><td>Forward/Backward</td><td>Move</td></tr></tbody></table>
<ul>
<li>
<h5 data-id="heading-17">è·³è·ƒæ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa39a873e83c497ea97d3aefcc70c037~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=ODEynVtlV28oPzza1mvGi1pabpo%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ®µè“å›¾å®ç°äº†<strong>é”®ç›˜ä¸è§¦æ‘¸æŒ‰é’®çš„ç»Ÿä¸€è·³è·ƒæ§åˆ¶</strong>ã€‚</p>
<p>ä½¿ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¯ é‡Šè¿™ä¸€å¥—é€»è¾‘ï¼š</p>




















<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è·³è·ƒå¼€å§‹ï¼ˆJumpï¼‰</th><th>è·³è·ƒç»“æŸï¼ˆStop Jumpingï¼‰</th></tr></thead><tbody><tr><td><strong>é”®ç›˜/æ‰‹æŸ„ï¼ˆPCï¼‰</strong></td><td>IA_Jump Started</td><td>IA_Jump Completed</td></tr><tr><td><strong>è§¦æ‘¸æŒ‰é’®ï¼ˆç§»åŠ¨ç«¯ï¼‰</strong></td><td>Event Touch Jump Start</td><td>Event Touch Jump End</td></tr></tbody></table>
<p>å¦å¤–ï¼Œè¿™ä¸ªè“å›¾ä¸­è¿˜æœ‰ä¸¤ä¸ªé‡è¦çš„å‡½æ•°ï¼š<code>Move</code>å’Œ<code>Aim</code>ï¼Œä»¥ä¸‹ä¸¤å¼ å›¾åˆ†åˆ«å±•ç¤ºäº†è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ¸å¿ƒé€»è¾‘ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0ceacdeee6741868bc12b2867ebde3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=QuZrUh%2BRjFtXqTNd0KPVKRV7bYc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/109f4429f1834df393277c8986dd42cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=8jxVCzqdYa5o%2FPq5PQ6E5mP3fGE%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™äº›å‡½æ•°å°è£…äº†<strong>è§’è‰²ç§»åŠ¨</strong>å’Œ<strong>è§†è§’è½¬æ¢</strong>çš„APIï¼Œä½¿å¼€å‘è€…æ‰§è¡Œè¿™ä¸¤ä¸ªæ“ä½œå˜å¾—æå…¶ç®€å•ã€‚</p>
<p>ä½¿ç”¨ä¼ªä»£ç æè¿°é€»è¾‘é“¾ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// BP_FirstPersonCharacter - è¾“å…¥å¤„ç†éƒ¨åˆ†</span>

<span class="hljs-comment">// è§†è§’æ§åˆ¶ï¼ˆCamera Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Look <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    <span class="hljs-built_in">Aim</span>(Yaw = ValueX, Pitch = ValueY)

On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_MouseLook <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    <span class="hljs-built_in">Aim</span>(Yaw = ValueX, Pitch = ValueY)

On Event Secondary Thumbstick From Touch <span class="hljs-built_in">Interface</span>(AxisX, AxisY)
    <span class="hljs-built_in">Aim</span>(Yaw = AxisX, Pitch = AxisY)

<span class="hljs-comment">// ç§»åŠ¨æ§åˆ¶ï¼ˆMovement Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Move <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    Move(LeftRight = ValueX, ForwardBackward = ValueY)

On Event Primary Thumbstick From Touch <span class="hljs-built_in">Interface</span>(AxisX, AxisY)
    Move(LeftRight = AxisX, ForwardBackward = AxisY)

<span class="hljs-comment">// è·³è·ƒæ§åˆ¶ï¼ˆJump Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Jump Started
    <span class="hljs-built_in">Jump</span>()

On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Jump Completed
    Stop <span class="hljs-built_in">Jumping</span>()

On Event Touch Jump Start From Touch Interface
    <span class="hljs-built_in">Jump</span>()

On Event Touch Jump End From Touch Interface
    Stop <span class="hljs-built_in">Jumping</span>()

<span class="hljs-comment">// å†…éƒ¨å‡½æ•°ï¼ˆé€šå¸¸åœ¨è“å›¾å‡½æ•°ä¸­å®ç°ï¼‰</span>
Function <span class="hljs-built_in">Aim</span>(Yaw, Pitch)
    Add Controller Yaw <span class="hljs-selector-tag">Input</span>(Yaw * MouseSensitivity)
    Add Controller Pitch <span class="hljs-selector-tag">Input</span>(Pitch * MouseSensitivity)

Function Move(LeftRight, ForwardBackward)
    Add Movement <span class="hljs-selector-tag">Input</span>(Get Actor Forward Vector(), ForwardBackward)
    Add Movement <span class="hljs-selector-tag">Input</span>(Get Actor Right Vector(), LeftRight)
</code></pre>
<h4 data-id="heading-18">2.2 <code>BP_FirstPersonPlayerController</code></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/905299d82136429b9b5161b80b0e533a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=7oGHJUxLKjzfjZDKVyS82lkUrZ0%3D" alt="image.png" loading="lazy"/></p>
<p>ä½œä¸ºç¬¬ä¸€äººç§°é¡¹ç›®çš„<strong>ç©å®¶æ§åˆ¶å™¨</strong>ï¼Œè´Ÿè´£ç®¡ç†ç©å®¶è¾“å…¥ç³»ç»Ÿçš„åˆå§‹åŒ–ã€è·¨å¹³å°é€‚é…ã€è§¦æ‘¸UIçš„åˆ›å»ºä¸æ˜¾ç¤ºï¼Œä»¥åŠå…¶ä»–ç©å®¶ä¸“å±é€»è¾‘ï¼ˆå¦‚ HUDã€è¾“å…¥æ¨¡å¼åˆ‡æ¢ï¼‰ã€‚</p>
<p>å®ƒä¸»è¦ä¸ä¹‹å‰çš„<code>BP_FirstPersonCharacter</code>é…åˆï¼š<code>Character</code>å¤„ç†ç§»åŠ¨/è§†è§’/è·³è·ƒçš„å…·ä½“å®ç°ï¼Œ<code>PlayerController</code>å¤„ç†è¾“å…¥æ˜ å°„å’ŒUIçš„å¹³å°å·®å¼‚ã€‚</p>
<p>ä½¿ç”¨ä¼ªä»£ç æè¿°é€»è¾‘é“¾ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// BP_FirstPersonPlayerController - Event Graph (ä¸»è¦åœ¨ Event BeginPlay ä¸­æ‰§è¡Œ)</span>

<span class="hljs-function">Event <span class="hljs-title">BeginPlay</span>()</span>
{
    <span class="hljs-comment">// è·å–å½“å‰æœ¬åœ°ç©å®¶çš„ Enhanced Input å­ç³»ç»Ÿ</span>
    EnhancedInputSubsystem = <span class="hljs-function">Get Enhanced Input Local Player <span class="hljs-title">Subsystem</span>()

    <span class="hljs-comment">// æ·»åŠ åŸºç¡€è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡ï¼ˆåŒ…å«ç§»åŠ¨ã€è§†è§’ã€è·³è·ƒç­‰æ‰€æœ‰ Input Actionï¼‰</span>
    EnhancedInputSubsystem.Add Mapping <span class="hljs-title">Context</span>(<span class="hljs-params">IMC_Default, Priority = <span class="hljs-number">0</span></span>)

    <span class="hljs-comment">// è·å–å½“å‰è¿è¡Œå¹³å°åç§°ï¼ˆè¿”å›å­—ç¬¦ä¸²ï¼Œå¦‚ "Windows"ã€"Android"ã€"iOS" ç­‰ï¼‰</span>
    PlatformName</span> = <span class="hljs-function">Get Platform <span class="hljs-title">Name</span>()

    <span class="hljs-comment">// æ ¹æ®å¹³å°è¿›è¡Œåˆ†æ”¯åˆ¤æ–­</span>
    <span class="hljs-title">Switch</span> (<span class="hljs-params">PlatformName</span>)</span>
    {
        Case <span class="hljs-string">"Windows"</span>:
            <span class="hljs-comment">// PC å¹³å°ï¼šä»…ä½¿ç”¨é”®ç›˜é¼ æ ‡ï¼Œæ— éœ€è§¦æ‘¸ UI</span>
            <span class="hljs-comment">// ä¸æ‰§è¡Œä»»ä½•é¢å¤–æ“ä½œï¼ˆé¼ æ ‡è¾“å…¥å·²ç”± IMC_Default è¦†ç›–ï¼‰</span>
            Break

        Case <span class="hljs-string">"Android"</span>:
        Case <span class="hljs-string">"iOS"</span>:
            <span class="hljs-comment">// ç§»åŠ¨å¹³å°ï¼šåˆ›å»ºå¹¶æ˜¾ç¤ºè™šæ‹Ÿè§¦æ‘¸æ§ä»¶ UI</span>
            TouchUIWidget = <span class="hljs-function">Create <span class="hljs-title">Widget</span>(<span class="hljs-params">Class = TargetTouchUI, OwningPlayer = Self</span>)
            <span class="hljs-title">if</span> (<span class="hljs-params">TouchUIWidget != <span class="hljs-literal">null</span></span>)</span>
            {
                TouchUIWidget.<span class="hljs-function">Add To <span class="hljs-title">Viewport</span>()  <span class="hljs-comment">// æ·»åŠ åˆ°å±å¹•è§†å£ï¼Œä½¿å…¶å¯è§</span>
                <span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®è¾“å…¥æ¨¡å¼ä¸º Game and UIï¼Œå…è®¸è§¦æ‘¸æŒ‰é’®æ¥æ”¶è¾“å…¥</span>
                Set Input Mode Game And <span class="hljs-title">UI</span>()
                Show Mouse <span class="hljs-title">Cursor</span>(<span class="hljs-params"><span class="hljs-literal">false</span></span>)  <span class="hljs-comment">// é€šå¸¸éšè—é¼ æ ‡å…‰æ ‡</span>
            }
            Break

        Default:
            <span class="hljs-comment">// å…¶ä»–å¹³å°ï¼ˆå¦‚ Editor æµ‹è¯•ã€Console ç­‰ï¼‰ï¼šé»˜è®¤åŒ PC å¤„ç†</span>
            <span class="hljs-comment">// ä¸åˆ›å»ºè§¦æ‘¸ UI</span>
            Break
    }
}
</span></code></pre>
<h4 data-id="heading-19">2.3 <code>GM_FirstPerson</code></h4>
<p>è¿™æ˜¯ä¸€ä¸ªçº¯æ•°æ®çš„è“å›¾ï¼Œå®šä¹‰äº†<strong>æ¸¸æˆçš„è¿è¡Œæ¨¡å¼</strong>ï¼Œä»¥ä¸‹å±•ç¤ºäº†å‡ ä¸ªé‡è¦çš„è®¾ç½®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0216028cdca141c293d108bf9eb53118~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=BF%2B%2F5o2isMhuX6QBPLl74Derons%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨<strong>ä¸–ç•Œåœºæ™¯è®¾ç½®</strong>ä¸­é€‰æ‹©è¯¥è“å›¾ï¼Œå³å¯åº”ç”¨å¯¹åº”çš„æ¸¸æˆæ¨¡å¼ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcfc00e01fc9419197eee6a319959ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=bEK2fFc%2B3u7q8vC69xgKp0s5lLY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-20">2.4 <code>BP_FP_CameraManager</code></h4>
<p>å¯ç”¨äº<strong>è‡ªå®šä¹‰ç©å®¶ç›¸æœºè¡Œä¸º</strong>ï¼Œç”¨äºå¢å¼ºç¬¬ä¸€äººç§°ä½“éªŒã€‚æ ‡å‡†ç¬¬ä¸€äººç§°æ¨¡æ¿ä¸­é€šå¸¸ä¸éœ€è¦é‡åº¦è‡ªå®šä¹‰ï¼Œæˆ‘ä»¬ä¹‹åå¯ä»¥å°†å…¶ç”¨äºå®ç°<strong>ç›¸æœºæŠ–åŠ¨</strong>ã€<strong>ç„å‡†æ—¶FOVå˜åŒ–</strong>ã€<strong>å¤´éƒ¨é²å‹ƒ</strong>æˆ–å…¶ä»–å¹³æ»‘ç›¸æœºæ•ˆæœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6befa16820e04cf2a337e1d8a9593174~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=K64PIefA1yD%2FaiPQ9806Vs9PDdQ%3D" alt="image.png" loading="lazy"/></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬åˆ†æäº†è¿™ä¸ªé¡¹ç›®çš„<strong>ç»“æ„</strong>ä»¥åŠ<strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼ˆå››ä¸ªè“å›¾ï¼‰ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹é¡¹ç›®ç»“æ„è¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¾¿äºæˆ‘ä»¬åç»­çš„æ‹“å±•å¼€å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€]]></title>    <link>https://juejin.cn/post/7585555806667866146</link>    <guid>https://juejin.cn/post/7585555806667866146</guid>    <pubDate>2025-12-21T10:14:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585555806667866146" data-draft-id="7585727457472397312" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€"/> <meta itemprop="keywords" content="Vue.js,Vite,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T10:14:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaoxue_"/> <meta itemprop="url" content="https://juejin.cn/user/4065372122398027"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4065372122398027/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiaoxue_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:14:35.000Z" title="Sun Dec 21 2025 10:14:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç°ä»£å‰ç«¯å¼€å‘<strong>å·¥ç¨‹åŒ–</strong>ï¼šä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›® ğŸš€</h2>
<p>åœ¨å‰ç«¯å¼€å‘é£é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œâ€œå·¥ç¨‹åŒ–â€ å·²ç»æˆä¸ºæå‡å¼€å‘æ•ˆç‡ã€ä¿è¯é¡¹ç›®è´¨é‡çš„æ ¸å¿ƒå…³é”®è¯ã€‚ä¸å†æ˜¯æ‹¿ç€ç¼–è¾‘å™¨å†™å‡ è¡Œ HTMLã€CSSã€JS å°±èƒ½æå®šçš„æ—¶ä»£ï¼Œç°ä»£å‰ç«¯å¼€å‘éœ€è¦ä¸€å¥—å®Œæ•´çš„å·¥å…·é“¾å’Œæ¶æ„è§„èŒƒã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»¥ Vue3 + Vite ä¸ºä¾‹ï¼Œå‚ç…§ä¸‹é¢è¿™å¹… <strong>Vue3 å‰ç«¯æŠ€æœ¯æ ˆæ¶æ„å›¾</strong> ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ èµ°è¿›ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„ä¸–ç•Œï¼Œä»åˆå§‹åŒ–é¡¹ç›®åˆ°å®ç°å¤šé¡µé¢å¼€å‘ï¼Œè®©ä½ æ„Ÿå—åˆ°è§„èŒƒæ¶æ„å¸¦æ¥çš„ä¸æ»‘ä½“éªŒï½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52d6a21e45f94e8abf740bf07d43171f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766916874&amp;x-signature=D0TQNvGX%2FEhilj5f5vzKo7oLZ0w%3D" alt="QQ20251221-174448.png" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€åˆå§‹åŒ–ä¸€ä¸ª Vue é¡¹ç›® ğŸ”§</h3>
<p>æƒ³è¦å¼€å¯ Vue3 é¡¹ç›®å¼€å‘ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªè§„èŒƒçš„é¡¹ç›®ç»“æ„ã€‚è¿™é‡Œæˆ‘ä»¬å¼ºçƒˆæ¨èä½¿ç”¨<code>vite</code>ä½œä¸ºæ„å»ºå·¥å…·ï¼Œæ“ä½œç®€å•åˆé«˜æ•ˆï¼</p>
<h4 data-id="heading-2">1.é¡¹ç›®åˆå§‹åŒ–æ­¥éª¤</h4>
<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œè·Ÿç€æŒ‡å¼•ä¸€æ­¥æ­¥æ“ä½œå³å¯ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-csharp" lang="csharp">npm <span class="hljs-keyword">init</span> vite
</code></pre>
<p>æ‰§è¡Œå‘½ä»¤åï¼Œä¼šå‡ºç°å‡ ä¸ªå…³é”®é€‰é¡¹éœ€è¦ä½ å†³ç­–ï¼š</p>
<ul>
<li>ç»™é¡¹ç›®èµ·ä¸ªåå­—ï¼šæˆ‘ä»¬è¿™é‡Œå‘½åä¸º<code>all-vue</code>ï¼ˆæ–¹ä¾¿åç»­ç»Ÿä¸€ç®¡ç†ï¼‰</li>
<li>é€‰æ‹©æ¡†æ¶ï¼šç›´æ¥é€‰ä¸­<code>vue</code>ï¼ˆæ¯•ç«Ÿæˆ‘ä»¬è¦å¼€å‘ Vue é¡¹ç›®å‘€ï½ï¼‰</li>
<li>é€‰æ‹©ç‰ˆæœ¬ï¼šæ¨èé€‰<code>javascript</code>ï¼ˆå¯¹æ–°æ‰‹æ›´å‹å¥½ï¼Œä¸Šæ‰‹æˆæœ¬ä½ï¼‰</li>
</ul>
<p>ä¸åˆ° 10 ç§’ï¼Œä¸€ä¸ªåŸºç¡€çš„ Vue é¡¹ç›®æ¡†æ¶å°±æ­å»ºå®Œæˆäº†ï¼æ˜¯ä¸æ˜¯æ¯”ä¼ ç»Ÿçš„<code>vue create</code>å¿«å¾ˆå¤šï¼Ÿè¿™å°±è¦å½’åŠŸäºæˆ‘ä»¬ä½¿ç”¨çš„æ„å»ºå·¥å…· â€”â€”vite äº†ï½</p>
<h4 data-id="heading-3">2.å…³äº Vite çš„é‚£äº›äº‹å„¿ ğŸ¤”</h4>
<p>å¾ˆå¤šå°ä¼™ä¼´å¯èƒ½ä¼šé—®ï¼šâ€œvite åˆ°åº•æ˜¯ä¸ªå•¥ï¼Ÿå’Œ Vue åˆæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿâ€</p>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>vite æ˜¯ Vue ä½œè€…å°¤é›¨æºªå¼€å‘çš„ç°ä»£å‰ç«¯æ„å»ºå·¥å…·</strong>ï¼Œå®ƒæœ€ç‰›çš„åœ°æ–¹åœ¨äºåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿçš„ ES æ¨¡å—ï¼ˆESMï¼‰å®ç°äº†ä¸¤å¤§é»‘ç§‘æŠ€ï¼š</p>
<ul>
<li><strong>æé€Ÿå†·å¯åŠ¨</strong>ï¼šä¼ ç»Ÿæ„å»ºå·¥å…·ä¼šå…ˆæ‰“åŒ…æ‰€æœ‰æ–‡ä»¶å†å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œè€Œ vite ç›´æ¥è®©æµè§ˆå™¨å»è§£ææ¨¡å—ï¼Œå¯åŠ¨é€Ÿåº¦å¿«åˆ°é£èµ·ï¼</li>
<li><strong>çƒ­æ›´æ–°</strong>ï¼šä¿®æ”¹æ–‡ä»¶åï¼Œvite åªä¼šæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œä¸ä¼šé‡æ–°æ‰“åŒ…æ•´ä¸ªé¡¹ç›®ï¼Œæµè§ˆå™¨ç¬é—´åˆ·æ–°ï¼Œå¼€å‘ä½“éªŒç›´æ¥æ‹‰æ»¡ï½</li>
</ul>
<p>è€Œ Vue å’Œ vite çš„å…³ç³»ï¼Œå¯ä»¥ç”¨ â€œå†…å®¹â€ å’Œ â€œå·¥å…·â€ æ¥æ¦‚æ‹¬ï¼š</p>
<ul>
<li><strong>Vue</strong>ï¼šæ˜¯ä¸€å¥—ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript æ¡†æ¶ï¼Œä¸“æ³¨äºè§†å›¾å±‚ï¼Œæä¾›äº†ç»„ä»¶åŒ–ã€å“åº”å¼ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼ˆè´Ÿè´£ â€œåšä»€ä¹ˆâ€ï¼‰ï¼›</li>
<li><strong>Vite</strong>ï¼šæ˜¯æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œè´Ÿè´£æŠŠä½ å†™çš„ Vue ä»£ç è¿›è¡Œæ‰“åŒ…ã€ç¼–è¯‘ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆè´Ÿè´£ â€œæ€ä¹ˆåšâ€ï¼‰ã€‚</li>
<li>æ€»ç»“æ¥è¯´ï¼švue æ˜¯å‰ç«¯æ¡†æ¶ï¼ˆè´Ÿè´£å†™ä¸šåŠ¡é€»è¾‘ã€ç»„ä»¶ã€ç•Œé¢ï¼‰ï¼Œè€Œ vite æ˜¯æ„å»ºå·¥å…·ï¼ˆè´Ÿè´£æŠŠä½ å†™çš„ vue ä»£ç  â€œæ‰“åŒ…ã€ç¼–è¯‘ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨â€ï¼‰ã€‚</li>
</ul>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼šå¦‚æœ Vue æ˜¯ç”»ç¬”ï¼Œé‚£ vite å°±æ˜¯è°ƒè‰²ç›˜å’Œç”»æ¿ï¼Œå¸®ä½ æ›´é«˜æ•ˆåœ°åˆ›ä½œï½</p>
<h4 data-id="heading-4">3.å¯åŠ¨é¡¹ç›®ï¼šä¸€è¡Œå‘½ä»¤çš„äº‹å„¿ ğŸš€</h4>
<p>é¡¹ç›®åˆå§‹åŒ–å®Œæˆåï¼Œè¿˜éœ€è¦å®‰è£…ä¾èµ–å¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> all-vue
<span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm i
<span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
npm run dev
</code></pre>
<p>è¿™é‡Œçš„<code>npm i</code>ä¼šæ ¹æ®é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code>package.json</code>æ–‡ä»¶å®‰è£…ä¾èµ–ã€‚æ‰“å¼€<code>package.json</code>çœ‹çœ‹ï¼Œé‡Œé¢è®°å½•äº†é¡¹ç›®çš„æ ¸å¿ƒä¿¡æ¯ï¼š</p>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"all-vue"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// é¡¹ç›®åç§°</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.5.24"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// Vueæ ¸å¿ƒä¾èµ–</span>
    <span class="hljs-attr">"vue-router"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.6.4"</span> <span class="hljs-comment">// è·¯ç”±ä¾èµ–ï¼ˆåé¢ä¼šç”¨åˆ°ï¼‰</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vite"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^7.2.4"</span> <span class="hljs-comment">// å¼€å‘ç¯å¢ƒä¾èµ–ï¼šviteæ„å»ºå·¥å…·</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¯åŠ¨å¼€å‘æœåŠ¡å™¨çš„è„šæœ¬</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite build"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// æ‰“åŒ…é¡¹ç›®çš„è„šæœ¬</span>
    <span class="hljs-attr">"preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite preview"</span> <span class="hljs-comment">// é¢„è§ˆæ‰“åŒ…åé¡¹ç›®çš„è„šæœ¬</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æ‰§è¡Œ<code>npm run dev</code>åï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºé¡¹ç›®å¯åŠ¨ä¿¡æ¯ï¼Œé€šå¸¸ä¼šåœ¨<code>localhost:5173</code>å¯åŠ¨æœåŠ¡ï¼Œç”šè‡³ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼ˆè¿™æ˜¯ vite å€ŸåŠ© Node çš„ OS æ¨¡å—å®ç°çš„å°ç»†èŠ‚ï½ï¼‰ã€‚æ›´çˆ½çš„æ˜¯ï¼Œå½“ä½ ä¿®æ”¹ä»»ä½•æ–‡ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°å±•ç¤ºæœ€æ–°æ•ˆæœï¼Œè¿™å°±æ˜¯å‰é¢æåˆ°çš„ â€œçƒ­æ›´æ–°â€ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ F5 å•¦ï¼</p>
<h3 data-id="heading-5">äºŒã€ä¼˜ç§€æ¶æ„ï¼šé¡¹ç›®çš„ â€œéª¨æ¶â€ æœ‰å¤šé‡è¦ï¼Ÿ ğŸ“</h3>
<p>ä¸€ä¸ªä¼˜ç§€çš„é¡¹ç›®æ¶æ„å°±åƒä¸€æ ‹å¤§æ¥¼çš„éª¨æ¶ï¼Œå†³å®šäº†å®ƒçš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚Vite åˆå§‹åŒ–çš„ Vue é¡¹ç›®ï¼Œè‡ªå¸¦ä¸€å¥—éå¸¸è§„èŒƒçš„æ¶æ„ï¼Œæˆ‘ä»¬æ¥ä¸€ä¸€æ‹†è§£ï½</p>
<p>Vue é¡¹ç›®ç»“æ„é¢„è§ˆï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-vue-app/
â”œâ”€â”€ node_modules/    <span class="hljs-comment"># ä¾èµ–åŒ…</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.vue      <span class="hljs-comment"># Vue æ ¹ç»„ä»¶ï¼ˆæ ¸å¿ƒï¼‰</span>
â”‚   â”œâ”€â”€ main.js      <span class="hljs-comment"># å…¥å£æ–‡ä»¶ï¼šåˆ›å»º Vue å®ä¾‹å¹¶æŒ‚è½½</span>
â”‚   â”œâ”€â”€ components/  <span class="hljs-comment"># ç»„ä»¶ç›®å½•</span>
â”‚   â””â”€â”€ style.css    <span class="hljs-comment"># å…¨å±€æ ·å¼</span>
â”œâ”€â”€ index.html       <span class="hljs-comment"># Vite å…¥å£ï¼ˆåŒºåˆ«äº Webpackï¼ŒVite ä»¥ HTML ä¸ºå…¥å£ï¼‰</span>
â”œâ”€â”€ package.json     <span class="hljs-comment"># è„šæœ¬å’Œä¾èµ–ï¼ˆå« Viteã€Vue æ ¸å¿ƒä¾èµ–ï¼‰</span>
â””â”€â”€ vite.config.js   <span class="hljs-comment"># Vite é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œè‡ªå®šä¹‰ç«¯å£ã€æ’ä»¶ç­‰ï¼‰</span>
</code></pre>
<h4 data-id="heading-6">1.æ ¹ç›®å½•çš„ â€œçµé­‚æ–‡ä»¶â€ï¼šindex.html</h4>
<p>æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•ï¼Œä½ ä¼šçœ‹åˆ°<code>index.html</code>ï¼Œå®ƒæ˜¯æ•´ä¸ªåº”ç”¨çš„å…¥å£é¡µé¢ï¼Œç›¸å½“äºå¤§æ¥¼çš„ â€œåœ°åŸºâ€ï¼š</p>
<p>html</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"icon"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/svg+xml"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/vite.svg"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>all-vue<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç»„ä»¶çš„æŒ‚è½½ç‚¹ï¼šVueåº”ç”¨ä¼šåœ¨è¿™é‡Œâ€œç”Ÿæ ¹å‘èŠ½â€ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŠ è½½Vueåº”ç”¨çš„å…¥å£è„šæœ¬ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/src/main.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li><strong>æŒ‚è½½ç‚¹</strong>ï¼š<code>&lt;div id="app"&gt;&lt;/div&gt;</code>æ˜¯ Vue åº”ç”¨çš„ â€œè½è„šç‚¹â€ï¼Œåç»­æ‰€æœ‰çš„ Vue ç»„ä»¶éƒ½ä¼šè¢«æ¸²æŸ“åˆ°è¿™ä¸ªå…ƒç´ é‡Œï¼Œå®ƒæ˜¯ Vue ä¸åŸç”Ÿ DOM çš„å”¯ä¸€è¿æ¥ç‚¹ã€‚</li>
<li><strong>ES æ¨¡å—è„šæœ¬</strong>ï¼š<code>&lt;script type="module" src="/src/main.js"&gt;&lt;/script&gt;</code>ä¸­çš„<code>type="module"</code>æ˜¯ Vite å®ç°æé€Ÿå¯åŠ¨çš„æ ¸å¿ƒï¼å®ƒå‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯ä¸€ä¸ª ES æ¨¡å—è„šæœ¬ï¼Œæ”¯æŒ<code>import/export</code>è¯­æ³•ï¼Œæµè§ˆå™¨ä¼šç›´æ¥æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œä¸ç”¨ç­‰å¾…å…¨é‡æ‰“åŒ…ã€‚</li>
</ol>
<h4 data-id="heading-7">2.src ç›®å½•ï¼šå‰ç«¯å¼€å‘çš„ â€œä¸»æˆ˜åœºâ€ ğŸ“‚</h4>
<p>æ‰€æœ‰çš„ä¸šåŠ¡ä»£ç éƒ½é›†ä¸­åœ¨<code>src</code>ç›®å½•ä¸‹ï¼Œå°±åƒå¤§æ¥¼é‡Œçš„å„ä¸ªæˆ¿é—´ï¼Œåˆ†å·¥æ˜ç¡®ï¼š</p>
<ul>
<li><code>main.js</code>ï¼šåº”ç”¨å…¥å£æ–‡ä»¶ï¼ˆç›¸å½“äº â€œå¤§é—¨â€ï¼Œæ‰€æœ‰èµ„æºä»è¿™é‡Œè¿›å…¥ï¼‰</li>
<li><code>App.vue</code>ï¼šæ ¹ç»„ä»¶ï¼ˆç›¸å½“äº â€œå®¢å…â€ï¼Œæ˜¯æ‰€æœ‰é¡µé¢çš„å…±åŒå®¹å™¨ï¼‰</li>
<li><code>style.css</code>ï¼šå…¨å±€æ ·å¼æ–‡ä»¶ï¼ˆç»Ÿä¸€ç®¡ç†æ•´ä¸ªåº”ç”¨çš„æ ·å¼é£æ ¼ï¼‰</li>
<li><code>components/</code>ï¼šç»„ä»¶ç›®å½•ï¼ˆå­˜æ”¾å¯å¤ç”¨çš„ UI ç»„ä»¶ï¼Œæ¯”å¦‚æŒ‰é’®ã€å¡ç‰‡ç­‰ï¼‰</li>
</ul>
<h5 data-id="heading-8">ï¼ˆ1ï¼‰å…¥å£æ–‡ä»¶ï¼šmain.js çš„ â€œæ€»æŒ‡æŒ¥â€ è§’è‰²</h5>
<p><code>main.js</code>æ˜¯æ•´ä¸ª Vue åº”ç”¨çš„å¯åŠ¨å…¥å£ï¼Œå°±åƒä¹é˜Ÿçš„æŒ‡æŒ¥ï¼Œè´Ÿè´£æŠŠæ‰€æœ‰èµ„æºæ•´åˆèµ·æ¥ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»Vueæ ¸å¿ƒåº“ä¸­å¯¼å…¥åˆ›å»ºåº”ç”¨å®ä¾‹çš„æ–¹æ³•</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å¯¼å…¥å…¨å±€æ ·å¼ï¼ˆè®©æ•´ä¸ªåº”ç”¨éƒ½èƒ½ç”¨ä¸Šè¿™äº›æ ·å¼ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./style.css'</span>
<span class="hljs-comment">// å¯¼å…¥æ ¹ç»„ä»¶Appï¼ˆæ•´ä¸ªåº”ç”¨çš„â€œæ€»å®¹å™¨â€ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-comment">// å¯¼å…¥è·¯ç”±æ¨¡å—ï¼ˆåé¢å®ç°å¤šé¡µé¢ä¼šç”¨åˆ°ï¼‰</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;

<span class="hljs-comment">// åˆ›å»ºVueåº”ç”¨å®ä¾‹ â†’ å¯ç”¨è·¯ç”± â†’ æŒ‚è½½åˆ°#appä¸Š</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
  .<span class="hljs-title function_">use</span>(router) <span class="hljs-comment">// è®©åº”ç”¨æ‹¥æœ‰è·¯ç”±èƒ½åŠ›</span>
  .<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>) <span class="hljs-comment">// æŠŠAppç»„ä»¶æ¸²æŸ“åˆ°index.htmlçš„#appå…ƒç´ é‡Œ</span>
</code></pre>
<p>è¿™å‡ è¡Œä»£ç çœ‹ä¼¼ç®€å•ï¼Œå´å®Œæˆäº†ä» â€œåˆ›å»ºåº”ç”¨â€ åˆ° â€œå¯åŠ¨åº”ç”¨â€ çš„å…¨æµç¨‹ï¼šå…ˆåˆ›å»º Vue å®ä¾‹ï¼Œå…³è”æ ¹ç»„ä»¶<code>App.vue</code>ï¼Œå†é€šè¿‡<code>mount('#app')</code>æŠŠç»„ä»¶æ¸²æŸ“åˆ°<code>index.html</code>çš„æŒ‚è½½ç‚¹ä¸Šï¼Œä¸€ä¸ª Vue åº”ç”¨å°±æ­£å¼å¯åŠ¨äº†ï¼</p>
<h5 data-id="heading-9">ï¼ˆ2ï¼‰æ ¹ç»„ä»¶ï¼šApp.vue çš„ â€œæ€»å®¹å™¨â€ ä½œç”¨</h5>
<p><code>App.vue</code>æ˜¯ Vue åº”ç”¨çš„æ ¹ç»„ä»¶ï¼Œæ‰€æœ‰é¡µé¢å’Œç»„ä»¶éƒ½ä¼šåµŒå¥—åœ¨å®ƒé‡Œé¢ï¼Œå°±åƒä¸€ä¸ªå¤§ç¤¼ç›’ï¼Œè£…ç€åº”ç”¨çš„æ‰€æœ‰å†…å®¹ã€‚å®ƒçš„ç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ¨¡æ¿ï¼ˆHTMLï¼‰ã€è„šæœ¬ï¼ˆJSï¼‰ã€æ ·å¼ï¼ˆCSSï¼‰ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è¿™é‡Œå¯ä»¥å†™ç»„ä»¶çš„é€»è¾‘ä»£ç ï¼ˆç›®å‰æˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦å¤æ‚é€»è¾‘ï¼‰</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å¤´éƒ¨å¯¼èˆª --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- è·¯ç”±å¯¼èˆªé“¾æ¥ï¼švue-routeræä¾›çš„å…¨å±€ç»„ä»¶ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é¡µé¢å†…å®¹åŒºåŸŸï¼šè·¯ç”±å‡ºå£ï¼Œé¡µé¢ç»„ä»¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é¡µè„š --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* scopedè¡¨ç¤ºæ ·å¼åªä½œç”¨äºå½“å‰ç»„ä»¶ï¼Œé¿å…æ ·å¼å†²çª */</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>App.vue</code>å®šä¹‰äº†åº”ç”¨çš„æ•´ä½“å¸ƒå±€ï¼ˆå¤´éƒ¨ã€ä¸»ä½“ã€åº•éƒ¨ï¼‰ï¼Œå…¶ä¸­<code>&lt;router-view&gt;</code>æ˜¯è·¯ç”±å‡ºå£ï¼ˆåé¢è®²å¤šé¡µé¢å¼€å‘æ—¶ä¼šè¯¦ç»†è¯´ï¼‰ï¼Œ<code>&lt;router-link&gt;</code>æ˜¯è·¯ç”±å¯¼èˆªé“¾æ¥ï¼Œè¿™äº›éƒ½æ˜¯<code>vue-router</code>æä¾›çš„èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-10">3.å¼€å‘å·¥å…·ï¼šæ•ˆç‡æå‡çš„ â€œç¥å™¨â€ âœ¨</h4>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å¼€å‘ Vue3 é¡¹ç›®ï¼Œè¿™ä¸¤ä¸ªå·¥å…·ä¸€å®šè¦å®‰æ’ä¸Šï¼š</p>
<ol>
<li><strong>Volar æ’ä»¶</strong>ï¼ˆVS Codeï¼‰ï¼šVue å®˜æ–¹æ¨å‡ºçš„è¯­æ³•æç¤ºå·¥å…·ï¼Œèƒ½è¯†åˆ« Vue3 çš„æ–°è¯­æ³•ï¼ˆæ¯”å¦‚<code>&lt;script setup&gt;</code>ï¼‰ï¼Œæä¾›ç²¾å‡†çš„ä»£ç è¡¥å…¨å’Œé”™è¯¯æç¤ºï¼Œæ¯”ä»¥å‰çš„ Vetur å¥½ç”¨å¤ªå¤šï¼å®‰è£…åï¼Œå†™ Vue ä»£ç å°±åƒ â€œå¼€äº†æŒ‚â€ï¼Œå†ä¹Ÿä¸ç”¨æ­»è®°ç¡¬èƒŒ API äº†ï½</li>
<li><strong>Vue Devtools æ’ä»¶</strong>ï¼ˆChrome æµè§ˆå™¨ï¼‰ï¼šè°ƒè¯• Vue åº”ç”¨çš„ â€œæ˜¾å¾®é•œâ€ã€‚å®‰è£…åï¼Œåœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·é‡Œä¼šå¤šå‡ºä¸€ä¸ª â€œVueâ€ æ ‡ç­¾ï¼Œèƒ½æŸ¥çœ‹ç»„ä»¶æ ‘ã€ç»„ä»¶çŠ¶æ€ã€è·¯ç”±ä¿¡æ¯ç­‰ï¼Œå¸®ä½ å¿«é€Ÿå®šä½é—®é¢˜ã€‚æ¯”å¦‚ä¿®æ”¹ç»„ä»¶æ•°æ®åï¼Œèƒ½å®æ—¶çœ‹åˆ°ç•Œé¢å˜åŒ–ï¼Œè°ƒè¯•æ•ˆç‡ç¿»å€ï¼</li>
</ol>
<h3 data-id="heading-11">ä¸‰ã€å¦‚ä½•è¿›è¡Œå¤šä¸ªé¡µé¢å¼€å‘å‘¢ï¼Ÿ ğŸ“„â†’ğŸ“‘</h3>
<p>å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰æ˜¯ç°ä»£å‰ç«¯çš„ä¸»æµï¼Œä½† â€œå•é¡µé¢â€ ä¸ä»£è¡¨åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œè€Œæ˜¯é€šè¿‡è·¯ç”±å®ç°å¤šä¸ªé¡µé¢çš„åˆ‡æ¢ï¼ˆæ— éœ€åˆ·æ–°æµè§ˆå™¨ï¼‰ã€‚Vue é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>vue-router</code>æ¥å®ç°è·¯ç”±åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-12">ç¬¬ä¸€æ­¥ï¼šå®‰è£… vue-router</h4>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…è·¯ç”±ä¾èµ–ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> vue-router
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œ<code>package.json</code>çš„<code>dependencies</code>é‡Œä¼šå¤šå‡º<code>"vue-router": "^4.6.4"</code>ï¼Œè¡¨ç¤ºè·¯ç”±æ’ä»¶å·²æˆåŠŸå¼•å…¥ã€‚</p>
<h4 data-id="heading-13">ç¬¬äºŒæ­¥ï¼šé…ç½®è·¯ç”±è§„åˆ™</h4>
<p>è·¯ç”±å°±åƒ â€œåœ°å›¾â€ï¼Œå‘Šè¯‰åº”ç”¨ â€œè®¿é—®å“ªä¸ªè·¯å¾„è¯¥æ˜¾ç¤ºå“ªä¸ªé¡µé¢â€ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè·¯ç”±é…ç½®æ–‡ä»¶ï¼š</p>
<ol>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>router</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»º<code>index.js</code>ï¼ˆè·¯ç”±é…ç½®çš„æ ¸å¿ƒæ–‡ä»¶ï¼‰ï¼›</li>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>views</code>æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾é¡µé¢ç»„ä»¶ï¼ˆ<code>Home.vue</code>å’Œ<code>About.vue</code>ï¼‰ã€‚</li>
</ol>
<p>å…ˆçœ‹é¡µé¢ç»„ä»¶çš„ä»£ç ï¼Œéå¸¸ç®€å•ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- src/views/Home.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Home Page ğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- src/views/About.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>About Page ğŸ”<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>å†æ¥çœ‹è·¯ç”±é…ç½®æ–‡ä»¶<code>src/router/index.js</code>ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»vue-routerä¸­å¯¼å…¥æ ¸å¿ƒæ–¹æ³•</span>
<span class="hljs-keyword">import</span> {
  createRouter, <span class="hljs-comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span>
  createWebHashHistory <span class="hljs-comment">// è·¯ç”±æ¨¡å¼ï¼ˆhashæ¨¡å¼ï¼Œè·¯å¾„å¸¦#ï¼‰</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-comment">// å¯¼å…¥é¡µé¢ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/Home.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/About.vue'</span>

<span class="hljs-comment">// è·¯ç”±è§„åˆ™ï¼šè·¯å¾„å’Œç»„ä»¶çš„å¯¹åº”å…³ç³»</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-comment">// è®¿é—®æ ¹è·¯å¾„ï¼ˆhttp://localhost:5173/#/ï¼‰</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Home</span> <span class="hljs-comment">// æ˜¾ç¤ºHomeç»„ä»¶</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>, <span class="hljs-comment">// è®¿é—®/aboutè·¯å¾„ï¼ˆhttp://localhost:5173/#/aboutï¼‰</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">About</span> <span class="hljs-comment">// æ˜¾ç¤ºAboutç»„ä»¶</span>
  }
];

<span class="hljs-comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHashHistory</span>(), <span class="hljs-comment">// ä½¿ç”¨hashæ¨¡å¼ï¼ˆè·¯å¾„å¸¦#ï¼Œå…¼å®¹æ€§å¥½ï¼‰</span>
  routes <span class="hljs-comment">// å…³è”è·¯ç”±è§„åˆ™</span>
})

<span class="hljs-comment">// å¯¼å‡ºè·¯ç”±å®ä¾‹ï¼Œä¾›main.jsä½¿ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;
</code></pre>
<p>è¿™é‡Œçš„<code>createWebHashHistory</code>è¡¨ç¤ºä½¿ç”¨ hash æ¨¡å¼ï¼Œè·¯å¾„ä¸­ä¼šå¸¦<code>#</code>ï¼ˆæ¯”å¦‚<code>#/about</code>ï¼‰ï¼Œå¥½å¤„æ˜¯éƒ¨ç½²æ—¶ä¸éœ€è¦æœåŠ¡å™¨é¢å¤–é…ç½®ï¼›å¦‚æœæƒ³å»æ‰<code>#</code>ï¼Œå¯ä»¥ç”¨<code>createWebHistory</code>ï¼ˆéœ€è¦æœåŠ¡å™¨æ”¯æŒï¼‰ã€‚</p>
<h4 data-id="heading-14">ç¬¬ä¸‰æ­¥ï¼šè®©åº”ç”¨ â€œæ‹¥æœ‰â€ è·¯ç”±èƒ½åŠ›</h4>
<p>é…ç½®å¥½è·¯ç”±åï¼Œéœ€è¦åœ¨<code>main.js</code>ä¸­æ³¨å†Œè·¯ç”±ï¼Œè®©æ•´ä¸ªåº”ç”¨éƒ½èƒ½ä½¿ç”¨è·¯ç”±åŠŸèƒ½ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¼å…¥è·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;

<span class="hljs-comment">// åˆ›å»ºåº”ç”¨æ—¶ï¼Œé€šè¿‡.use(router)å¯ç”¨è·¯ç”±</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
  .<span class="hljs-title function_">use</span>(router) 
  .<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼Œç›¸å½“äºç»™åº”ç”¨ â€œè£…ä¸Šå¯¼èˆªç³»ç»Ÿâ€ï¼Œæ²¡æœ‰å®ƒï¼Œ<code>&lt;router-link&gt;</code>å’Œ<code>&lt;router-view&gt;</code>éƒ½æ— æ³•ç”Ÿæ•ˆã€‚</p>
<h4 data-id="heading-15">ç¬¬å››æ­¥ï¼šåœ¨ App.vue ä¸­ä½¿ç”¨è·¯ç”±</h4>
<p>æœ€åï¼Œåœ¨æ ¹ç»„ä»¶<code>App.vue</code>ä¸­æ·»åŠ è·¯ç”±å¯¼èˆªå’Œè·¯ç”±å‡ºå£ï¼š</p>
<ul>
<li><code>&lt;router-link to="è·¯å¾„"&gt;</code>ï¼šè·¯ç”±å¯¼èˆªé“¾æ¥ï¼ˆç›¸å½“äº<code>&lt;a&gt;</code>æ ‡ç­¾ï¼Œä½†ä¸ä¼šåˆ·æ–°é¡µé¢ï¼‰ï¼›</li>
<li><code>&lt;router-view&gt;</code>ï¼šè·¯ç”±å‡ºå£ï¼ˆåŒ¹é…çš„é¡µé¢ç»„ä»¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºï¼‰ã€‚</li>
</ul>
<p>ä»£ç æˆ‘ä»¬å‰é¢å·²ç»è§è¿‡äº†ï¼Œå†é‡ç‚¹çœ‹ä¸€ä¸‹æ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç‚¹å‡»è·³è½¬åˆ°é¦–é¡µ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç‚¹å‡»è·³è½¬åˆ°å…³äºé¡µ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é¡µé¢å†…å®¹ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>æ­¤æ—¶å¯åŠ¨é¡¹ç›®ï¼Œç‚¹å‡»å¯¼èˆªé“¾æ¥ï¼Œé¡µé¢ä¼šåœ¨<code>Home</code>å’Œ<code>About</code>ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œåœ°å€æ çš„è·¯å¾„ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼Œè¿™å°±æ˜¯å•é¡µé¢åº”ç”¨çš„è·¯ç”±æ•ˆæœï½</p>
<p>æ•ˆæœäº®ä¸ªç›¸ï¼š
è§‚å¯Ÿç•Œé¢ä¸­å¤®å’Œåœ°å€æ çš„å˜åŒ–</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ce06ece9be74b63839da07402e27c82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766916874&amp;x-signature=tEZayKdyiDQmBGV37c%2BaIQmzBhI%3D" alt="QQ20251221-18326.gif" loading="lazy"/></p>
<h3 data-id="heading-16">ç»“è¯­ ğŸŒŸ</h3>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´èµ°é€šäº† â€œç”¨ Vite åˆå§‹åŒ– Vue3 é¡¹ç›®â†’ç†è§£é¡¹ç›®æ¶æ„â†’å®ç°å¤šé¡µé¢è·¯ç”±â€ çš„å…¨æµç¨‹ã€‚å›é¡¾æ•´ä¸ªè¿‡ç¨‹ï¼Œä½ ä¼šå‘ç°ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å·¥å…·é“¾ç®€åŒ–å¼€å‘</strong>ï¼šVite çš„æé€Ÿå¯åŠ¨å’Œçƒ­æ›´æ–°ï¼Œè®©å¼€å‘æ•ˆç‡æå‡æ•°å€ï¼›</li>
<li><strong>æ¶æ„è§„èŒƒæ¸…æ™°</strong>ï¼šä»<code>index.html</code>åˆ°<code>src</code>ç›®å½•ï¼Œæ¯ä¸ªæ–‡ä»¶çš„èŒè´£æ˜ç¡®ï¼Œé¡¹ç›®å†å¤§ä¹Ÿä¸ä¼šä¹±ï¼›</li>
<li><strong>ç”Ÿæ€å®Œå–„</strong>ï¼š<code>vue-router</code>ç­‰å®˜æ–¹æ’ä»¶æ— ç¼è¡”æ¥ï¼Œè½»æ¾å®ç°å¤æ‚åŠŸèƒ½ã€‚</li>
</ul>
<p>å‰ç«¯å¼€å‘ä¸å†æ˜¯ â€œå†™å‡ è¡Œä»£ç â€ é‚£ä¹ˆç®€å•ï¼Œè€Œæ˜¯ä¸€å¥— â€œå·¥å…· + è§„èŒƒ + ç”Ÿæ€â€ çš„ååŒä½“ç³»ã€‚æŒæ¡è¿™äº›åŸºç¡€ï¼Œä½ å°±å·²ç»è·¨è¿›äº†ç°ä»£å‰ç«¯å¼€å‘çš„å¤§é—¨ï½ æ¥ä¸‹æ¥ï¼Œä¸å¦¨è¯•è¯•åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ·»åŠ æ›´å¤šé¡µé¢ã€ç»„ä»¶å’Œäº¤äº’ï¼Œæ„Ÿå— Vue3+Vite çš„é­…åŠ›å§ï¼ğŸ’ª</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹]]></title>    <link>https://juejin.cn/post/7585466235662270516</link>    <guid>https://juejin.cn/post/7585466235662270516</guid>    <pubDate>2025-12-20T20:16:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585466235662270516" data-draft-id="7585574047074025472" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2025-12-20T20:16:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tinero"/> <meta itemprop="url" content="https://juejin.cn/user/332513186430804"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/332513186430804/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tinero
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T20:16:34.000Z" title="Sat Dec 20 2025 20:16:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘è®¤ä¸º LangChain æ¡†æ¶ä¸»è¦åˆ†ä¸ºè¿™å‡ ä¸ªéƒ¨åˆ†:</p>
<ol>
<li>å¯¹æ¨¡å‹ I/O çš„å°è£…</li>
<li>æ•°æ®è¿æ¥å°è£…</li>
<li>å¯¹è¯å†å²ç®¡ç†</li>
<li>æ¶æ„å°è£…ï¼ˆé’ˆå¯¹ Chain å’Œ Agentï¼‰</li>
</ol>
<h2 data-id="heading-0">ä¸€ã€å¯¹æ¨¡å‹ I/O çš„å°è£…</h2>
<p>è¯¥æ¨¡å—ä¸»è¦æ˜¯ç”¨äºæ›´å¥½çš„è®¿é—® LLM è¿›è¡Œæ¨ç†ã€åµŒå…¥ä»»åŠ¡ã€‚æ‰€ä»¥å¯¹è®¿é—® LLM çš„è¯·æ±‚ã€å‘é€è¯·æ±‚çš„æ•°æ®ä»¥åŠæ¥æ”¶ LLM ç”Ÿæˆçš„æ•°æ®è¿›è¡Œå°è£…</p>
<h3 data-id="heading-1">1.1 Prompt æ¨¡æ¿</h3>
<p>è¿™ä¸ªæ˜¯ç”¨æ¥å°è£…å‘ LLM å‘é€è¯·æ±‚çš„æç¤ºè¯ï¼Œæ¯”å¦‚å¸¸è§çš„ SystemMessageï¼ˆå‘Šè¯‰æ¨¡å‹å¦‚ä½•è¡Œä¸ºå¹¶ä¸ºäº¤äº’æä¾›ä¸Šä¸‹æ–‡ï¼‰ï¼ŒHumanMessageï¼ˆè¡¨ç¤ºç”¨æˆ·è¾“å…¥å’Œä¸æ¨¡å‹çš„äº¤äº’ï¼‰ å’Œ AIMessageï¼ˆæ¨¡å‹ç”Ÿæˆçš„å“åº”ï¼ŒåŒ…æ‹¬æ–‡æœ¬å†…å®¹ã€å·¥å…·è°ƒç”¨å’Œå…ƒæ•°æ®ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage, AIMessage, SystemMessage

<span class="hljs-comment"># æ¨¡æ‹Ÿå¤šè½®å¯¹è¯</span>
messages = [  
    <span class="hljs-comment"># å‘Šè¯‰æ¨¡å‹ä½ çš„èº«ä»½</span>
    SystemMessage(content=<span class="hljs-string">"ä½ æ˜¯ JoJo çš„ç§äººå°åŠ©ç†"</span>),  
    <span class="hljs-comment"># ç”¨æˆ·è¾“å…¥çš„é—®é¢˜</span>
    HumanMessage(content=<span class="hljs-string">"æˆ‘æ˜¯ JoJo çš„æœ‹å‹ï¼Œæˆ‘å« Tinero"</span>),  
    <span class="hljs-comment"># AI çš„å›ç­”</span>
    AIMessage(content=<span class="hljs-string">"ä½ å¥½ï¼"</span>),  
    <span class="hljs-comment"># ç”¨æˆ·å†é—®</span>
    HumanMessage(content=<span class="hljs-string">"æˆ‘æ˜¯è°ï¼Ÿ"</span>)  
]  
<span class="hljs-comment"># å°±èƒ½è·å– AI çš„å›ç­”</span>
<span class="hljs-comment">#   llm æ˜¯ç”¨æ¥å’Œå¤§æ¨¡å‹è¿›è¡Œäº¤äº’çš„å¯¹è±¡ï¼Œåé¢ä¼šè¯´åˆ°</span>
ret = llm.invoke(messages)  
<span class="hljs-built_in">print</span>(ret.content)  

<span class="hljs-comment"># è¿˜å¯ä»¥ç»§ç»­å†é—®</span>
response = llm.invoke([  
    HumanMessage(<span class="hljs-string">"ä½ æ˜¯è°?"</span>)  
])  
<span class="hljs-built_in">print</span>(response.content)
</code></pre>
<p>ä¸Šé¢çš„è¿™ç§æ–¹å¼ï¼Œæ˜¯æ•´ä¸ª Prompt éƒ½éœ€è¦ç¨‹åºå‘˜ç¼–å†™ï¼ŒLangChain ä¸ºäº†æ›´æ–¹ä¾¿çš„è°ƒç”¨ï¼Œä¹Ÿæ”¯æŒé€šè¿‡è‡ªå®šä¹‰çš„æ¨¡æ¿ï¼Œæ¥æ„å»º Prompt</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate

<span class="hljs-comment"># å®šä¹‰æ¨¡æ¿</span>
template = PromptTemplate.from_template(<span class="hljs-string">"ç»™æˆ‘è®²ä¸ªå…³äº{subject}çš„ç¬‘è¯"</span>)  
<span class="hljs-built_in">print</span>(template)  
<span class="hljs-built_in">print</span>(template.<span class="hljs-built_in">format</span>(subject=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>))  
template = PromptTemplate.from_template(<span class="hljs-string">"ç»™æˆ‘è®²ä¸ªå…³äº{subject}çš„ç¬‘è¯ï¼Œå†…å®¹è¦ç¬¦åˆ{style}è¿™ä¸ªé£æ ¼"</span>)  
<span class="hljs-comment"># æ­¤æ—¶å¦‚æœä¸ä¼ å…¥ style ä¼šç›´æ¥æŠ¥é”™  </span>
<span class="hljs-comment"># print(template.format(subject="å°çŒ«çƒçƒ"))  </span>
ret = llm.invoke(template.<span class="hljs-built_in">format</span>(subject=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>, style=<span class="hljs-string">"ç”œç”œçš„"</span>))  
<span class="hljs-built_in">print</span>(ret.content)
</code></pre>
<p>è¿˜å¯ä»¥é€šè¿‡æ¨¡æ¿æ¥è¡¨ç¤ºä¸Šä¸‹æ–‡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage, AIMessage
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate, ChatPromptTemplate, MessagesPlaceholder

<span class="hljs-comment"># è¯¥æ¨¡æ¿ç”¨äºè¡¨ç¤ºä¸Šä¸‹æ–‡ï¼Œè€Œä¸‹é¢çš„ history åˆ™æ˜¯ç”¨äºè¡¨ç¤ºå¯¹è¯å†å²</span>
human_prompt = <span class="hljs-string">"Translate your answer to {language}"</span>  
<span class="hljs-comment"># è¿™ä¸ª prompt å¯ä»¥ç†è§£ä¸ºå¸¦æœ‰å‚æ•°çš„å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦å»ä¼ å…¥å‚æ•°  </span>
human_message_template = HumanMessagePromptTemplate.from_template(human_prompt)  
chat_prompt = ChatPromptTemplate.from_messages([  
    <span class="hljs-comment"># history æ˜¯ MessagesPlaceholder åœ¨æ¨¡æ¿ä¸­çš„å˜é‡åï¼Œç”¨äºåœ¨èµ‹å€¼æ—¶ä½¿ç”¨</span>
    <span class="hljs-comment"># è¿™é‡Œæ”¹å˜é¡ºåºçš„è¯ï¼Œä¼šå½±å“ä¸‹é¢æç¤ºè¯ç”Ÿäº§çš„é¡ºåº  </span>
    <span class="hljs-comment"># ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœé¡ºåºå˜ä¸º human_message_template, MessagesPlaceholder("history") é‚£ä¹ˆä¸‹é¢èµ‹å€¼çš„æ—¶å€™ï¼Œé¡ºåºä¹Ÿéœ€è¦å¯¹åº”çš„è¿›è¡Œè°ƒæ•´ </span>
    MessagesPlaceholder(<span class="hljs-string">"history"</span>), human_message_template
    
])
<span class="hljs-comment"># æ„å»ºå¯¹è¯å†å²</span>
human_message = HumanMessage(content=<span class="hljs-string">"Who is JoJo?"</span>)  
ai_message = AIMessage(content=<span class="hljs-string">"JoJo is a billionaire entrepreneur, inventor, and industrial designer"</span>)  
messages = chat_prompt.format_prompt(  
    <span class="hljs-comment"># å¯¹ history å’Œ language è¿›è¡Œèµ‹å€¼  </span>
    history=[human_message, ai_message], language=<span class="hljs-string">"ä¸­æ–‡"</span>  
)
<span class="hljs-comment"># è®¿é—® LLM</span>
ret = llm.invoke(messages)  
<span class="hljs-built_in">print</span>(ret.content)
</code></pre>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä»æ–‡ä»¶ä¸­å»åŠ è½½ Prompt æ¨¡æ¿</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate

<span class="hljs-string">"""
./prompt_template.txt æ–‡ä»¶çš„å†…å®¹ä¸ºï¼š
ç»™æˆ‘è®²ä¸ªå…³äº{topic}çš„ç¬‘è¯
"""</span>

template = PromptTemplate.from_file(<span class="hljs-string">"./prompt_template.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>)  
<span class="hljs-built_in">print</span>(template.format_prompt(topic=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>))
</code></pre>
<h3 data-id="heading-2">1.2 è®¿é—® LLMs</h3>
<p>å¥½çš„ï¼Œæœ‰äº†æƒ³è¦è®¿é—® LLM çš„ Promptï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å…¶å‘é€ç»™ LLMï¼Œè®©å®ƒå»ç»™æˆ‘ä»¬ç”Ÿæˆå›ç­”ï¼Œè€Œ LLM çš„å›ç­”ï¼Œæ ¹æ®ä»»åŠ¡çš„ä¸åŒï¼ˆåˆ†ä¸ºæ¨ç†ã€åµŒå…¥ç­‰ï¼‰ï¼Œä¼šæœ‰ä¸åŒçš„è¿”å›ç»“æœ</p>
<p>LangChain å°è£…äº† OpenAIï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼å»è®¿é—®æ¨¡å‹ï¼Œå…ˆè¯´ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ¨ç†ä»»åŠ¡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># è¿™é‡Œè®¿é—®çš„æ˜¯ Qwen æ¨¡å‹ï¼Œå¯¹åº”çš„ API å’Œ Token æˆ‘éƒ½å­˜å‚¨åˆ°ç¯å¢ƒå˜é‡é‡Œå»äº†</span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># ç„¶åå°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ¨ç†ä»»åŠ¡äº†</span>
response = llm.invoke(<span class="hljs-string">"ä½ æ˜¯è°?"</span>)

<span class="hljs-comment"># è¿˜å¯ä»¥é€šè¿‡ llm è¿›è¡Œæµå¼è¾“å‡ºï¼Œè·å–å¯¹åº”çš„ chunks</span>
<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> llm.stream(<span class="hljs-string">"ä½ æ˜¯è°"</span>):  
    <span class="hljs-built_in">print</span>(chunk)
</code></pre>
<p>é™¤äº†å®ç°æ¨ç†ä»»åŠ¡ï¼Œè¿˜å¯ä»¥å¯¹å…¶è¿›è¡Œè¯åµŒå…¥ä»»åŠ¡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings

<span class="hljs-comment"># è¿™é‡ŒåŒæ ·è®¿é—®çš„æ˜¯ Qwen çš„è¯åµŒå…¥æ¨¡å‹ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢ä¸€å †æµ®ç‚¹å‹æ•°æ®ï¼Œè¯åµŒå…¥é€šå¸¸å’Œæ£€ç´¢ä¸€å—å„¿ä½¿ç”¨</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)
<span class="hljs-built_in">print</span>(embeddings.embed_query(<span class="hljs-string">"ä½ æ˜¯è°ï¼Ÿ"</span>))
</code></pre>
<h3 data-id="heading-3">1.3 æ ¼å¼åŒ– LLMs çš„å“åº”ç»“æœ</h3>
<p>è®¿é—® LLMs åï¼Œæˆ‘ä»¬ä¼šè·å–åˆ°å…¶æ¨ç†ç”Ÿæˆçš„ç»“æœï¼ˆè¿™é‡Œä¸è¯´åµŒå…¥ï¼‰ï¼Œä½†æ˜¯å“åº”çš„ç»“æœé€šå¸¸éƒ½æ˜¯æ–‡æœ¬ï¼ˆLangChain æ”¯æŒå¯¹ LLMs å“åº”ç»“æœçš„å„ç§è§£æï¼Œå¯ä»¥ä½¿ç”¨ JsonOutputParser å»è§£æ LLMs ç”Ÿæˆçš„ Json æ•°æ®ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ StrOutputParser è§£æ LLMs ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œä»¥åŠå…¶ä»–çš„è§£æå™¨ã€‚å› ä¸ºè°ƒç”¨ llm å¯¹è±¡ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™å‡ ä¸ªå°†å…¶ç»“æœå…¨éƒ¨è§£æé™¤äº†ï¼Œæ¯”å¦‚è°ƒç”¨ StrOutputParser åï¼Œè·å–åˆ°çš„ç»“æœæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºå¾ˆç®€å•å°±ä¸ä¸¾ä¾‹äº†ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œé‡ç‚¹è¯´ä¸‹å¦‚ä½•è§£ææˆ Json å’Œ Pydanticï¼‰ï¼Œè¿™ä¸ªä¸æ–¹ä¾¿æˆ‘ä»¬è§£æï¼Œæˆ‘ä»¬æƒ³è¦å°†å…¶æ ¼å¼åŒ–ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> JsonOutputParser, PydanticOutputParser

<span class="hljs-comment"># ç›´æ¥è¾“å‡º pydantic å¯¹è±¡  </span>
<span class="hljs-comment"># å®šä¹‰è¾“å‡ºå¯¹è±¡  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):  
    year: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Year"</span>)  
    month: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Month"</span>)  
    day: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Day"</span>)  
    era: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"BC or AD"</span>)  
  
  
<span class="hljs-comment"># å®šä¹‰ç»“æ„åŒ–è¾“å‡ºçš„æ¨¡å‹  </span>
structured_llm = llm.with_structured_output(Date)  
<span class="hljs-comment"># ä¸‹é¢çš„æ¨¡æ¿ä¸­ï¼Œå¿…é¡»è¦åŒ…å« "è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡" è¿™å¥è¯ï¼Œè¦ä¸ç„¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿”å›çš„ä¸æ˜¯ Json å¯¹è±¡ï¼Œæ— æ³•å°†å…¶è½¬æ¢ä¸º pydantic å¯¹è±¡</span>
template = <span class="hljs-string">"""  
æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ  
ç”¨æˆ·è¾“å…¥ï¼š  
{query}  
è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡  
"""</span>  
prompt = PromptTemplate(template=template)  
<span class="hljs-comment"># è¿˜å¯ä»¥è¿™æ ·å­</span>
<span class="hljs-comment"># prompt = PromptTemplate.from_template(template)  </span>
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_query = prompt.format_prompt(query=query)  
ret = structured_llm.invoke(input_query)  
<span class="hljs-built_in">print</span>(ret)


<span class="hljs-comment"># è¾“å‡ºæŒ‡å®šæ ¼å¼çš„ Json</span>
json_schema = {  
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Date"</span>,  
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Formated date expression"</span>,  
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,  
    <span class="hljs-string">"properties"</span>: {  
        <span class="hljs-string">"year"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"year YYYY"</span>  
        },  
        <span class="hljs-string">"month"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"month MM"</span>  
        },  
        <span class="hljs-string">"day"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"day DD"</span>  
        },  
        <span class="hljs-string">"era"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"BC or AD"</span>  
        }  
    }  
}  
structured_llm = llm.with_structured_output(json_schema)  
<span class="hljs-comment"># è¿˜æ˜¯å¿…é¡»åŠ ä¸Šæœ€åä¸€å¥è¯ï¼Œè¦ä¸ç„¶ä¼šæŠ¥é”™  </span>
template = <span class="hljs-string">"""  
æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ  
ç”¨æˆ·è¾“å…¥ï¼š  
{query}  
è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡  
"""</span>  
prompt = PromptTemplate.from_template(template)  
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_query = prompt.format_prompt(query=query)  
ret = structured_llm.invoke(input_query)  
<span class="hljs-built_in">print</span>(ret)


<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨ JsonOutputParser  </span>
<span class="hljs-comment"># parser = JsonOutputParser(pydantic_object=Date)  </span>
<span class="hljs-comment"># ä½¿ç”¨ PydanticOutputParser ä¹Ÿæ˜¯å¯ä»¥çš„  </span>
parser = PydanticOutputParser(pydantic_object=Date)  
prompt = PromptTemplate(  
    template=<span class="hljs-string">"æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ \n ç”¨æˆ·è¾“å…¥ï¼š\n{query}\n{format_instructions}"</span>,  
    input_variables=[<span class="hljs-string">"query"</span>],  
    <span class="hljs-comment"># æŒ‡å®šå“åº”æ ¼å¼</span>
    partial_variables={  
        <span class="hljs-string">"format_instructions"</span>: parser.get_format_instructions()  
    }  
)  
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_prompt = prompt.format_prompt(query=query) 
ret = llm.invoke(input_prompt)  
<span class="hljs-built_in">print</span>(ret.content)  
<span class="hljs-built_in">print</span>(parser.invoke(ret))

</code></pre>
<p>å½“ç„¶ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœæœ‰æ—¶å€™å¤§æ¨¡å‹å“åº”çš„ç»“æœä¸æ­£ç¡®ï¼Œæˆ–ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä»–ç›´æ¥æŠ¥é”™ï¼Œè€Œæ˜¯è‡ªåŠ¨çº é”™ä¸‹ï¼Œç„¶åå†è¿”å›ç»™æˆ‘ä»¬ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¾ˆè€ƒéªŒå¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä¸Šé¢æ¡ˆä¾‹çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ ä¸€ä¸ªçº é”™çš„åŠŸèƒ½</span>
<span class="hljs-keyword">from</span> langchain.output_parsers <span class="hljs-keyword">import</span> OutputFixingParser

<span class="hljs-comment"># åˆ©ç”¨å¤§æ¨¡å‹åšæ ¼å¼è‡ªåŠ¨çº é”™</span>
parser = PydanticOutputParser(pydantic_object=Date)  
new_parser = OutputFixingParser.from_llm(parser=parser, llm=llm)  
bad_output = ret.content.replace(<span class="hljs-string">"5"</span>, <span class="hljs-string">"å››"</span>)  
<span class="hljs-comment"># bad_output = ret.content.replace("5", "å…­")  </span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"PydanticOutputParser: "</span>)  
<span class="hljs-keyword">try</span>:  
    parser.invoke(bad_output)  
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  
    <span class="hljs-built_in">print</span>(e)  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"OutputFixingParserï¼š"</span>)  
<span class="hljs-built_in">print</span>(new_parser.invoke(bad_output))  
<span class="hljs-string">"""  
ä½†æ˜¯çº é”™åçš„ç»“æœï¼Œä¸º year=2023 month=11 day=30 era='AD'ï¼Œ  
æˆ‘ä»¬æƒ³è¦çš„ç»“æœæ˜¯ year=2025 month=11 day=30 era='AD'  
è¿™ä¸ªé—®é¢˜å’Œæ¨¡å‹èƒ½åŠ›æœ‰å…³ç³»ï¼Œåªèƒ½è¯´ä»˜è´¹æœ‰ä»˜è´¹çš„é“ç†  
ä½¿ç”¨ qwen3-max å¼ºçš„ä¸€ç‚¹åœ¨äºï¼Œå¦‚æœæ›¿æ¢ä¸ºå››ï¼Œçº é”™åä¸º 2024ï¼Œå¦‚æœæ›¿æ¢ä¸ºå…­ï¼Œçº é”™åä¸º 2026  
ä½¿ç”¨ qwen-plusï¼Œä¸ç®¡æ˜¯æ›¿æ¢ä¸ºå››è¿˜æ˜¯æ›¿ä¸ºå…­ï¼Œçº é”™åéƒ½æ˜¯ 2024ï¼Œåªèƒ½è¯´èƒ½åŠ›æå‡äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸å¤š
å¦‚æœæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›ä»˜è´¹çš„æ¨¡å‹å»è¯•è¯•ï¼Œæˆ‘æ¯”è¾ƒç©·ï¼Œå°±å…ˆä¸å°è¯•äº†
"""</span>

</code></pre>
<p>ç»è¿‡ä¸Šé¢çš„å¯¹ Promptã€è¯·æ±‚ LLMs ä»¥åŠ Parser Outputï¼Œæ•´ä¸ªå¯¹æ¨¡å‹ I/O çš„å°è£…å·²ç»å®ç°äº†ï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šé‡åˆ° Function Calling çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨ Agent é‡Œï¼Œæ‰€ä»¥ä»‹ç»ä¸‹è¿™ä¸ª</p>
<h3 data-id="heading-4">1.4 Function Calling</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæƒ³è¦å„ç§ä¸šåŠ¡æ¥å£äº’ç›¸è°ƒç”¨çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨è¿™ä¸ªï¼Œæˆ‘ç†è§£è¿™ä¸ªä¸»è¦æ˜¯ç”¨äºå’Œ MCP è¿›è¡Œå¯¹æ¥çš„</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.tools <span class="hljs-keyword">import</span> tool

<span class="hljs-comment"># è‡ªå®šä¹‰ä¸¤ä¸ªå·¥å…·å‡½æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€å®šè¦åœ¨å‡½æ•°é‡Œæ·»åŠ æ³¨é‡Šï¼ï¼ï¼ï¼Œå¦åˆ™è¯†åˆ«ä¸äº†ä½ è¿™ä¸ªå·¥å…·æ˜¯å¹²å•¥çš„</span>
<span class="hljs-comment"># æ·»åŠ ä¸ªè£…é¥°å™¨ï¼Œè¡¨æ˜è¿™ä¸ªä½¿ç”¨è°ƒç”¨çš„å·¥å…·å‡½æ•°</span>
<span class="hljs-meta">@tool  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    Add two integers.  
    :param a: First integer  
    :param b: Second integer  
    :return:  
    """</span>  
    <span class="hljs-keyword">return</span> a + b  
  
  
<span class="hljs-meta">@tool  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">multiply</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    Multiply two integers.  
    :param a: First integer  
    :param b: Second integer  
    :return:  
    """</span>  
    <span class="hljs-keyword">return</span> a * b  
  

<span class="hljs-comment"># ç»‘å®šè‡ªå®šä¹‰å·¥å…·</span>
llm_with_tools = llm.bind_tools([add, multiply])  
query = <span class="hljs-string">"3 çš„ 4 å€æ˜¯å¤šå°‘ï¼Ÿ"</span>  
messages = [HumanMessage(query)]  
output = llm_with_tools.invoke(messages)  
<span class="hljs-built_in">print</span>(json.dumps(output.tool_calls, indent=<span class="hljs-number">4</span>))  
<span class="hljs-built_in">print</span>()  
<span class="hljs-comment"># å°† AI å“åº”çš„ç»“æœï¼Œæ”¾åˆ°å¯¹è¯å†å²é‡Œ</span>
messages.append(output)  
available_tools = {  
    <span class="hljs-string">"add"</span>: add,  
    <span class="hljs-string">"multiply"</span>: multiply  
}  
<span class="hljs-comment"># çœ‹æ¨¡å‹è°ƒç”¨å“ªä¸ªå·¥å…·ï¼Œå°±æ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œç„¶åå°†ç»“æœå­˜æ”¾åˆ°å¯¹è¯å†å²é‡Œ</span>
<span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> output.tool_calls:  
    selected_tool = available_tools[tool_call[<span class="hljs-string">"name"</span>].lower()]  
    tool_msg = selected_tool.invoke(tool_call)  
    messages.append(tool_msg)  

<span class="hljs-comment"># æŠŠæ•´ä¸ªå¯¹è¯å†å²å†å‘é€ç»™æ¨¡å‹</span>
new_output = llm_with_tools.invoke(messages)  
<span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages:  
    <span class="hljs-built_in">print</span>(json.dumps(message.model_dump(), indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))  
    <span class="hljs-built_in">print</span>()  
<span class="hljs-built_in">print</span>(new_output.content)
</code></pre>
<h2 data-id="heading-5">äºŒã€æ•°æ®è¿æ¥å°è£…</h2>
<p>ä½¿ç”¨ LangChain åœ¨åš RAG çš„æ—¶å€™ï¼Œç»å¸¸ä¼šç”¨åˆ°æ•´ä¸ªï¼Œç°åœ¨é€šè¿‡æ„å»ºä¸ªç®€å•çš„ RAG æ¡ˆä¾‹ï¼Œæ¥è¿›è¡Œä»‹ç»</p>
<h3 data-id="heading-6">2.1 Document Loaders</h3>
<p>LangChain æ”¯æŒå¯¹å„ç§æ ¼å¼æ–‡ä»¶è¿›è¡ŒåŠ è½½ï¼Œå¦‚ä½•åŠ è½½å°±æ˜¯ä½¿ç”¨ä¸åŒçš„åŠ è½½å™¨ï¼Œè¿™é‡Œæˆ‘æ˜¯å¯¹ PDF è¿›è¡ŒåŠ è½½ï¼Œå…¶ä»–çš„å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£è¿›è¡Œä½¿ç”¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> PyMuPDFLoader

<span class="hljs-comment"># æå–æ–‡æ¡£å†…å®¹  </span>
loader = PyMuPDFLoader(<span class="hljs-string">"./resource/2307.09288v2.pdf"</span>)  
<span class="hljs-comment"># è¿›è¡Œåˆ†é¡µï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªåªèƒ½æå–å‡ºæ–‡å­—ï¼Œå›¾ç‰‡è¯†åˆ«ä¸å‡ºæ¥</span>
pages = loader.load_and_split() 
</code></pre>
<h3 data-id="heading-7">2.2 Document Transformers</h3>
<p>å°†ä¸åŒçš„æ ¼å¼æ–‡ä»¶åŠ è½½è¿›æ¥åï¼Œéœ€è¦å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²ï¼Œåˆ†å‰²çš„è¯ï¼Œæ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚æŒ‰æ®µè½å•¦ï¼Œæˆ–æ˜¯é€šè¿‡ AI è¾…åŠ©ï¼Œå°†å†…å®¹æŒ‰ç›¸è¿‘è¯­ä¹‰è¿›è¡Œåˆ†å‰²å•¦ç­‰ç­‰ï¼Œè¿™é‡Œåªä¸¾ä¾‹æœ€ç®€å•çš„ä¾‹å­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter


<span class="hljs-comment"># å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²  </span>
<span class="hljs-comment"># è¿™ä¸ªç±»ï¼Œåªèƒ½å¯¹ç®€å•çš„æ–‡æœ¬è¿›è¡Œåˆ‡å‰²ï¼Œä½†æ˜¯å¯¹å›¾ç‰‡ï¼Œè¡¨æ ¼è¿™ç§ï¼Œæ˜¯åˆ‡åˆ†ä¸äº†çš„  </span>
text_splitter = RecursiveCharacterTextSplitter(  
    <span class="hljs-comment"># chunk çš„å¤§å°  </span>
    chunk_size=<span class="hljs-number">200</span>,  
    <span class="hljs-comment"># é‡å¤çš„å¤§å°  </span>
    chunk_overlap=<span class="hljs-number">100</span>,  
    <span class="hljs-comment"># ç»Ÿè®¡ chunk é•¿åº¦çš„å‡½æ•°</span>
    length_function=<span class="hljs-built_in">len</span>,  
    add_start_index=<span class="hljs-literal">True</span>  
)  
paragraphs = text_splitter.create_documents([  
    page.page_content <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages[:<span class="hljs-number">4</span>]  
])
<span class="hljs-keyword">for</span> para <span class="hljs-keyword">in</span> paragraphs:  
    <span class="hljs-built_in">print</span>(para.page_content)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"</span>)
</code></pre>
<h3 data-id="heading-8">2.3 Text Embedding Models</h3>
<p>å¯¹æ–‡æ¡£è¿›è¡Œåˆ‡å‰²åï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ–‡æœ¬è¿›è¡Œå‘é‡åŒ–è¡¨ç¤ºï¼Œç”¨äºæ£€ç´¢ç­‰æ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨åˆ°ä¸Šé¢è¯´çš„è¯åµŒå…¥æ–¹å¼äº†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings

<span class="hljs-comment"># æˆ‘ä½¿ç”¨çš„æ˜¯ é˜¿é‡Œäº‘ç™¾ç‚¼çš„æ¨¡å‹ï¼Œå¹¶ä¸æ˜¯å®˜æ–¹çš„ openai çš„æ¨¡å‹ã€‚</span>
<span class="hljs-comment"># è°ƒç”¨é OpenAI æ¨¡å‹æ—¶ï¼Œ  </span>
<span class="hljs-comment"># LangChain é»˜è®¤ä¼šå¯¹æ–‡æœ¬è¿›è¡Œ Token åŒ–é¢„å¤„ç†ï¼Œ</span>
<span class="hljs-comment"># å¯¼è‡´å®é™…å‘é€ç»™æ¨¡å‹çš„ä¸æ˜¯åŸå§‹å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ Token åˆ—è¡¨ï¼Œä»è€Œè§¦å‘æ ¼å¼é”™è¯¯  </span>
<span class="hljs-comment"># æ‰€ä»¥è¦åŠ ä¸Š check_embedding_ctx_length=False</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)  
<span class="hljs-built_in">print</span>(embeddings.embed_query(<span class="hljs-string">"ä½ æ˜¯è°ï¼Ÿ"</span>))
</code></pre>
<h3 data-id="heading-9">2.4 Vectorstores</h3>
<p>è·å–åˆ°è¯åµŒå…¥æ¨¡å‹å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªè¯åµŒå…¥æ¨¡å‹ï¼Œå°†ä¹‹å‰åˆ‡åˆ†çš„ chunk åˆ†åˆ«è¿›è¡Œå‘é‡åŒ–è¡¨ç¤ºï¼Œç„¶åå°†å…¶å…¨éƒ¨å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS

<span class="hljs-comment"># æˆ‘ä»¬å°†å‘é‡å­˜å‚¨åˆ° FAISS æ•°æ®åº“ä¸­</span>
<span class="hljs-comment"># text-embedding-v4 å¯èƒ½å­˜åœ¨å•æ–‡æœ¬å­—ç¬¦æ•°ä¸Šé™ï¼ˆå¦‚ 8192 å­—ç¬¦ï¼‰å’Œæ‰¹é‡å¤§å°é™åˆ¶ï¼ˆå¦‚å•æ¬¡ä¸è¶…è¿‡ 10 æ¡ï¼‰ã€‚  </span>
<span class="hljs-comment"># paragraphs åˆ—è¡¨è‹¥åŒ…å«è¶…é•¿æ–‡æœ¬æˆ–æ‰¹æ¬¡è¿‡å¤§ï¼Œä¼šè¿›ä¸€æ­¥å¼•å‘ç±»ä¼¼é”™è¯¯ï¼Œæ‰€ä»¥é‡‡ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼Œè¿›è¡Œæ‰¹æ¬¡å¤„ç†</span>
BATCH_SIZE = <span class="hljs-number">1</span> <span class="hljs-comment"># æ ¹æ®æ¨¡å‹æ–‡æ¡£è°ƒæ•´  </span>
db = <span class="hljs-literal">None</span>  
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(paragraphs), BATCH_SIZE):  
    batch_docs = paragraphs[i:i+BATCH_SIZE]  
    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:  
        db = FAISS.from_documents(batch_docs, embeddings)  
    <span class="hljs-keyword">else</span>:  
        db.add_documents(batch_docs)
        
<span class="hljs-comment"># å¦‚æœæ²¡æœ‰é™åˆ¶çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä¸€æ­¥æå®š</span>
db = FAISS.from_documents(paragraphs, embeddings)
</code></pre>
<h3 data-id="heading-10">2.5 Retrievers</h3>
<p>å…¨éƒ¨å‘é‡åŒ–åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæé—®äº†ï¼Œæé—®çš„æ—¶å€™ï¼Œä¼šå»å‘é‡åº“ä¸­å»æ£€ç´¢æœ€ç›¸ä¼¼çš„å‘é‡ï¼Œä¸€å—å„¿å‘é€ç»™ LLMsï¼Œè®© LLMs ç»™æˆ‘ä»¬åšæ€»ç»“å½’çº³</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ£€ç´¢ top-3 çš„ç»“æœ  </span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})  
docs = retriever.invoke(<span class="hljs-string">"llama2 æœ‰å¤šå°‘å‚æ•°"</span>)  
  
<span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> docs:  
    <span class="hljs-built_in">print</span>(doc.page_content)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"================"</span>)
</code></pre>
<p>æ­¤æ—¶ï¼Œä¸€ä¸ªç®€å•çš„ RAG å°±å·²ç»å¼€å‘å®Œäº†</p>
<h2 data-id="heading-11">ä¸‰ã€å¯¹è¯å†å²ç®¡ç†</h2>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ä¼šä½¿ç”¨ LangChain å’Œ LLMs è¿›è¡Œäº¤äº’äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ä¹Ÿéœ€è¦æˆ‘ä»¬å»æ³¨æ„ï¼Œå°±æ˜¯å¦‚ä½•ç®¡ç†ç”¨æˆ·å’Œ AI çš„å¯¹è¯å†å²ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„è¿›è¡Œäº†å‡ æ¬¡äº¤äº’ï¼Œå€’ä¹Ÿç½¢äº†ï¼Œå¦‚æœæ˜¯å¥½å‡ åæ¡ï¼Œç™¾æ¡å‘¢ï¼Ÿ</p>
<p>åœ¨ LangChain é‡Œå¯ä»¥ä½¿ç”¨ trim_messages å»ç®¡ç†å†å²å¯¹è¯ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆå£°æ˜ä¸€ä¸ª ChatOpenAI çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å’Œä¸Šé¢çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼Œå»è‡ªå®šä¹‰ä¸€ä¸ª Token çš„è®¡æ•°é€»è¾‘ï¼Œç”¨æ¥ç»Ÿè®¡ AI ç”Ÿæˆäº†å¤šå°‘ Tokenï¼Œä»è€Œå¯ä»¥è®©æˆ‘ä»¬å»å†³å®šï¼Œä»€ä¹ˆæ—¶å€™å»è§¦å‘å¯¹ä¼šè¯å†å²è¿›è¡Œç®¡ç†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> tiktoken  
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>  
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-keyword">class</span> <span class="hljs-title class_">QwenChatOpenAI</span>(<span class="hljs-title class_ inherited__">ChatOpenAI</span>):  
<span class="hljs-string">"""å¦‚æœä¸è‡ªå®šä¹‰å®ç°çš„è¯ï¼Œä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸æ”¯æŒ"""</span>  
  
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_num_tokens_from_messages</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[BaseMessage], tools=<span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    è‡ªå®šä¹‰ qwen3-max çš„ token è®¡æ•°é€»è¾‘  
    æ ¹æ® qwen3-max çš„å®é™… token è§„åˆ™ï¼Œé‡å†™  get_num_tokens_from_messages æ–¹æ³•ã€‚å›½å†…æ¨¡å‹é€šå¸¸ä½¿ç”¨ä¸ GPT å…¼å®¹çš„ BPE ç¼–ç ï¼Œå¯å€ŸåŠ© tiktoken åº“æ¨¡æ‹Ÿè®¡ç®—  
    :param messages:  
    :param tools:  
    :return:  
    """</span>  
    <span class="hljs-comment"># 1. é€‰æ‹©ä¸ qwen3-max å…¼å®¹çš„ç¼–ç æ¨¡å‹ï¼ˆå¦‚ gpt-3.5-turboï¼‰  </span>
    encoding = tiktoken.get_encoding(<span class="hljs-string">"cl100k_base"</span>)  
    <span class="hljs-comment"># 2. æŒ‰æ¨¡å‹è§„åˆ™è®¡ç®—tokenæ•°ï¼ˆå‚è€ƒæ–‡æ¡£ï¼‰  </span>
    num_tokens = <span class="hljs-number">0</span>  
    <span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages:  
    num_tokens += <span class="hljs-number">4</span> <span class="hljs-comment"># æ¯ä¸ªæ¶ˆæ¯å›ºå®šå‰ç¼€ï¼š&lt;|im_start|&gt;role\ncontent&lt;|im_end|&gt;  </span>
    num_tokens += <span class="hljs-built_in">len</span>(encoding.encode(message.content))  
    num_tokens += <span class="hljs-number">2</span> <span class="hljs-comment"># å¯¹è¯ç»“æŸæ ‡è®°  </span>
    <span class="hljs-keyword">return</span> num_tokens  
  
  
llm = QwenChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))
</code></pre>
<p>å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†æ¨¡å‹å¯¹è±¡äº†ï¼Œå†å£°æ˜ä¸€ä¸ªå¤šè½®å¯¹è¯çš„åˆ—è¡¨ï¼Œæ¨¡æ‹Ÿå¯¹è¯å†å²</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> AIMessage, HumanMessage, SystemMessage

messages = [  
    SystemMessage(<span class="hljs-string">"You're a good assistant, you always respond with a joke"</span>),  
    HumanMessage(<span class="hljs-string">"I wonder why it's called langchain"</span>),  
    <span class="hljs-comment"># å¯ä½¿ç”¨è¿™ç§æ¥æŒ‡å®š ID  </span>
    <span class="hljs-comment"># HumanMessage("I wonder why it's called langchain", id="3"),  </span>
    AIMessage(<span class="hljs-string">"Well, I guess they thought 'WordRope' and 'SentenceString' just didn't have the same thing to it!"</span>),  
    <span class="hljs-comment"># HumanMessage("and who is harrison chasing anyways"),  </span>
    <span class="hljs-comment"># å¯ä½¿ç”¨è¿™ç§æ¥æŒ‡å®š name å±æ€§  </span>
    HumanMessage(<span class="hljs-string">"and who is harrison chasing anyways"</span>, name=<span class="hljs-string">"example_user"</span>),  
    <span class="hljs-comment"># AIMessage("Hmm let me think. \n\n Why, he's probably chasing after the last cup of coffee in the office!"),  </span>
    AIMessage(<span class="hljs-string">"Hmm let me think. \n\n Why, he's probably chasing after the last cup of coffee in the office!"</span>,  
    name=<span class="hljs-string">"aaa"</span>),  
    HumanMessage(<span class="hljs-string">"what do you call a speechless parrot"</span>)  
]
</code></pre>
<h3 data-id="heading-12">3.1 trim_messages</h3>
<p>ç°åœ¨å¯ä»¥é€šè¿‡ trim_messages æ¥ç®¡ç†å¯¹è¯ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> trim_messages

<span class="hljs-comment"># åªä¿ç•™æœ€åä¸€æ¬¡å¯¹è¯ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥</span>
<span class="hljs-comment"># result = trim_messages(messages, max_tokens=45, strategy="last", token_counter=llm.get_num_tokens_from_messages)  </span>
result = trim_messages(messages, max_tokens=<span class="hljs-number">45</span>, strategy=<span class="hljs-string">"last"</span>, token_counter=llm)  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<p>ä¸Šé¢çš„æ¡ˆä¾‹å¯ä»¥è·‘è·‘çœ‹ï¼Œæœ‰äº†å¤§æ¦‚çš„å½±å“ï¼Œæ¥ä»‹ç»ä¸‹ trim_messages é‡Œçš„å‚æ•°</p>
<pre><code class="hljs language-python" lang="python">result = trim_messages(messages,  
    <span class="hljs-comment"># å…è®¸çš„æœ€å¤§ token æ€»æ•°  </span>
    <span class="hljs-comment"># é™åˆ¶ messages åˆ—è¡¨çš„æ€» token æ•°ä¸Šé™ï¼Œè¶…è¿‡æ­¤å€¼æ—¶è§¦å‘æˆªæ–­é€»è¾‘  </span>
    max_tokens=<span class="hljs-number">45</span>, 
    <span class="hljs-comment"># æˆªæ–­ç­–ç•¥  </span>
    <span class="hljs-comment"># å†³å®šå¦‚ä½•ä¿ç•™æ¶ˆæ¯ä»¥æ»¡è¶³ max_tokens é™åˆ¶ï¼Œé»˜è®¤å€¼å¸¸ä¸º "last"ï¼ˆä¿ç•™æœ€æ–°æ¶ˆæ¯ï¼‰ã€‚  </span>
    strategy=<span class="hljs-string">"last"</span>,  
    <span class="hljs-comment"># token è®¡æ•°å·¥å…·  </span>
    <span class="hljs-comment"># è´Ÿè´£è®¡ç®—å•æ¡/å¤šæ¡æ¶ˆæ¯çš„ token æ•°é‡ï¼Œç¡®ä¿æˆªæ–­åæ€» token ä¸¥æ ¼æ§åˆ¶åœ¨ max_tokens å†…ã€‚  </span>
    token_counter=llm,  
    <span class="hljs-comment"># æ˜¯å¦ ä¿ç•™ç³»ç»Ÿæç¤ºæ¶ˆæ¯  </span>
    include_system=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># å½“å•æ¡æ¶ˆæ¯è¿‡é•¿ï¼ˆå¦‚è¶…é•¿ç”¨æˆ·è¾“å…¥ï¼‰æ—¶ï¼Œæ˜¯å¦å…è®¸ æˆªæ–­è¯¥æ¶ˆæ¯æœ¬èº«ï¼ˆè€Œéæ•´æ®µä¸¢å¼ƒï¼‰  </span>
    <span class="hljs-comment"># Trueï¼ˆé»˜è®¤ï¼‰ï¼šæˆªå–æ¶ˆæ¯çš„å‰ N ä¸ª tokensï¼ˆä¿ç•™éƒ¨åˆ†å†…å®¹ï¼‰  </span>
    <span class="hljs-comment"># âŒ åŸæ¶ˆæ¯ï¼š"è¿™æ˜¯ä¸€æ®µ 100 tokens çš„è¶…é•¿æ–‡æœ¬..."  </span>
    <span class="hljs-comment"># âœ… æˆªæ–­åï¼š"è¿™æ˜¯ä¸€æ®µ 30 tokens çš„è¶…..."ï¼ˆå‡è®¾å‰©ä½™ tokens ä»… 30ï¼‰  </span>
    <span class="hljs-comment"># Falseï¼šè‹¥å•æ¡æ¶ˆæ¯ tokens &gt; max_tokensï¼Œç›´æ¥ä¸¢å¼ƒæ•´æ¡æ¶ˆæ¯ï¼ˆå¯èƒ½ä¸¢å¤±å…³é”®ä¿¡æ¯ï¼‰  </span>
    allow_partial=<span class="hljs-literal">True</span>)  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h3 data-id="heading-13">3.2 filter_messages</h3>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ filter_messages å»è¿‡æ»¤å¸¦æ ‡è¯†çš„å†å²ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> filter_messages

<span class="hljs-comment"># include_types ç”¨äº æŒ‡å®šéœ€è¦ä¿ç•™çš„æ¶ˆæ¯ç±»å‹ï¼Œä¸ç¬¦åˆç±»å‹çš„æ¶ˆæ¯ä¼šè¢«è¿‡æ»¤æ‰  </span>
<span class="hljs-comment"># æ”¯æŒ å­—ç¬¦ä¸²ï¼ˆå•ä¸ªç±»å‹ï¼‰æˆ– åˆ—è¡¨ï¼ˆå¤šä¸ªç±»å‹ï¼‰ï¼Œä¾‹å¦‚ include_types=["human", "ai"] ä¼šåŒæ—¶ä¿ç•™äººç±»å’ŒAIçš„æ¶ˆæ¯  </span>
result = filter_messages(messages, include_types=<span class="hljs-string">"human"</span>)

<span class="hljs-comment"># exclude_names ç”¨äº æŒ‡å®šéœ€è¦æ’é™¤çš„å‘é€è€…åç§°ï¼ŒåŒ¹é…åç§°çš„æ¶ˆæ¯ä¼šè¢«è¿‡æ»¤æ‰  </span>
<span class="hljs-comment"># ["example_user", "example_assistant"]ï¼šæ’é™¤åç§°ä¸ºâ€œç¤ºä¾‹ç”¨æˆ·â€å’Œâ€œç¤ºä¾‹åŠ©æ‰‹â€çš„æ¶ˆæ¯ï¼ˆé€šå¸¸ç”¨äºè¿‡æ»¤æ¼”ç¤ºæ•°æ®æˆ–æµ‹è¯•æ¶ˆæ¯ï¼‰ã€‚  </span>
<span class="hljs-comment"># åç§°åŒ¹é…åŒºåˆ†å¤§å°å†™ï¼ˆå¦‚ Example_User ä¸ example_user è§†ä¸ºä¸åŒåç§°ï¼‰  </span>
<span class="hljs-comment"># ç­›é€‰é€»è¾‘ï¼šéå† messagesï¼Œæ’é™¤ name å±æ€§åœ¨ exclude_names åˆ—è¡¨ä¸­çš„æ¶ˆæ¯ï¼Œä¿ç•™å…¶ä»–æ‰€æœ‰æ¶ˆæ¯ã€‚  </span>
result = filter_messages(messages, exclude_names=[<span class="hljs-string">"example_user"</span>, <span class="hljs-string">"example_assistant"</span>])

<span class="hljs-comment"># exclude_ids  </span>
<span class="hljs-comment"># æ’é™¤ æŒ‡å®šå”¯ä¸€ID çš„æ¶ˆæ¯ã€‚id é€šå¸¸æ˜¯æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¦‚UUIDæˆ–è‡ªå¢ç¼–å·ï¼‰ï¼Œç”¨äºç²¾å‡†å®šä½å•æ¡æ¶ˆæ¯  </span>
result = filter_messages(messages, include_types=[HumanMessage, AIMessage], exclude_ids=[<span class="hljs-string">"3"</span>])
</code></pre>
<h3 data-id="heading-14">3.3 å­˜å‚¨å¯¹è¯å†å²</h3>
<p>ä¸Šé¢è¯´åˆ°çš„æ–¹æ³•ï¼Œéƒ½æ˜¯å¯¹å¯¹è¯å†å²è¿›è¡Œè£å‰ªã€è¿‡æ»¤ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å°†å¯¹è¯å†å²è¿›è¡Œå­˜å‚¨</p>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ redisï¼Œmongodb è¿™ç§ç¼“å­˜æ•°æ®åº“ï¼Œä½†æ˜¯æ¨èä½¿ç”¨ redisã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ sqlite è¿›è¡Œä¸€ä¸ªç®€å•çš„ä¸¾ä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡ session id æ¥åŒºåˆ†å¯¹è¯å†å²ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ° sqlite ä¸­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_session_history</span>(<span class="hljs-params">session_id</span>):  
    <span class="hljs-comment"># é€šè¿‡ session_id åŒºåˆ†å¯¹è¯å†å²ï¼Œå¹¶å­˜å‚¨åœ¨ sqlite æ•°æ®åº“ä¸­  </span>
    <span class="hljs-comment"># SQLiteæ˜¯æ–‡ä»¶å‹æ•°æ®åº“ï¼ŒPythonæ ‡å‡†åº“å·²å†…ç½®åŸºç¡€æ”¯æŒï¼Œé€šè¿‡sqlalchemyå³å¯ç›´æ¥æ“ä½œï¼Œæ— éœ€é¢å¤–éƒ¨ç½²æœåŠ¡  </span>
    <span class="hljs-comment"># LangChainé€šè¿‡å®ƒå®ç°ä¸SQLiteçš„è¿æ¥å’Œæ“ä½œ  </span>
    <span class="hljs-keyword">return</span> SQLChatMessageHistory(session_id, <span class="hljs-string">"sqlite:///memory.db"</span>)
</code></pre>
<p>å£°æ˜ LLMs å¯¹è±¡ï¼Œå¹¶æ„å»ºä¸€ä¸ªç®€å•çš„ lcel å¯¹è±¡ï¼ˆåé¢ä¼šè¯´åˆ°ï¼Œå°±æ˜¯ä¸€ä¸ªé“¾å¼è°ƒç”¨ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

model = ChatOpenAI(model=<span class="hljs-string">"qwen-plus"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  
base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>), temperature=<span class="hljs-number">0</span>)

runnable = model | StrOutputParser()
</code></pre>
<p>æ„å»ºç®¡ç†å†å²å¯¹è¯çš„ runnableï¼ˆè¯¥å¯¹è±¡é™¤äº†å¯ä»¥æ­£å¸¸è°ƒç”¨å¤–ï¼Œè¿˜å¯ä»¥ä¼ å…¥å¯¹åº”çš„é…ç½®ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables.history <span class="hljs-keyword">import</span> RunnableWithMessageHistory

runnable_width_history = RunnableWithMessageHistory(  
    runnable,  
    <span class="hljs-comment"># æŒ‡å®šè‡ªå®šä¹‰çš„å†å²ç®¡ç†æ–¹æ³•  </span>
    get_session_history  
)
</code></pre>
<p>ç°åœ¨æ„å»ºå®Œæˆäº†ï¼Œä½¿ç”¨ç®€å•çš„ä¾‹å­æ¥éªŒè¯ä¸‹</p>
<pre><code class="hljs language-python" lang="python">ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘å« JoJoï¼Œä¸­æ–‡åå­—å«å•µå•µ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"jojo"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()  
ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ çŸ¥é“æˆ‘å«ä»€ä¹ˆåå­—å—ï¼Ÿ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"jojo"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()  
ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘å« JoJoï¼Œä¸­æ–‡åå­—å«å•µå•µ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"test"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()
</code></pre>
<h2 data-id="heading-15">å››ã€æ¶æ„å°è£…</h2>
<p>æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†ï¼Œå…¶å® LangChain åŸºæœ¬çš„çŸ¥è¯†éƒ½å·²ç»æŒæ¡äº†ï¼Œè€Œåœ¨æ¶æ„å°è£…é‡Œï¼Œä¸»è¦ä»‹ç»åˆ°ä¸¤ä¸ªä¸œè¥¿ï¼Œåˆ†åˆ«æ˜¯ Chain å’Œ Agent</p>
<h3 data-id="heading-16">4.1 Chain</h3>
<p>Chain å…¶å®å°±æ˜¯ä¸Šé¢è¯´åˆ°çš„ lcelï¼ˆLangChain Expression Languageï¼Œé“¾å¼è°ƒç”¨ï¼‰ï¼Œä¸»è¦æ˜¯å°±æ˜¯å¯¹ä¸€ä¸ªåŠŸèƒ½æˆ–ä¸€ç³»åˆ—é¡ºåºåŠŸèƒ½ç»„åˆ</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨ PromptTemplateï¼ŒLLM å’Œ OutputParser</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough


<span class="hljs-comment"># å®šä¹‰è¾“å‡ºç»“æ„  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SortEnum</span>(<span class="hljs-built_in">str</span>, Enum):  
    data = <span class="hljs-string">"data"</span>  
    price = <span class="hljs-string">"price"</span>  
  
  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderingEnum</span>(<span class="hljs-built_in">str</span>, Enum):  
    ascend = <span class="hljs-string">"ascend"</span>  
    descend = <span class="hljs-string">"descend"</span>  
  
  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Semantics</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):  
    name: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(description=<span class="hljs-string">"æµé‡åŒ…åç§°"</span>, default=<span class="hljs-literal">None</span>)  
    price_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)  
    price_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)  
    data_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)  
    data_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)  
    sort_by: <span class="hljs-type">Optional</span>[SortEnum] = Field(description=<span class="hljs-string">"æŒ‰ä»·æ ¼æˆ–æµé‡æ’åº"</span>, default=<span class="hljs-literal">None</span>)  
    ordering: <span class="hljs-type">Optional</span>[OrderingEnum] = Field(description=<span class="hljs-string">"å‡åºæˆ–é™åºæ’åº"</span>, default=<span class="hljs-literal">None</span>)  
  
  
<span class="hljs-comment"># Prompt æ¨¡æ¿  </span>
prompt = ChatPromptTemplate.from_messages(  
    [  
        (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªè¯­ä¹‰è§£æå™¨ï¼Œä½ çš„ä»»åŠ¡æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥è§£ææˆ Json è¡¨ç¤ºï¼Œä¸è¦å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚"</span>),  
        (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>)  
    ]  
)

<span class="hljs-comment"># ç›´æ¥è·å–ç»“æœ</span>
structured_llm = llm.with_structured_output(Semantics)  

<span class="hljs-comment"># LCEL è¡¨è¾¾å¼  </span>
<span class="hljs-comment"># æ•°æ®ä»å·¦å¾€å³ä¼ è¾“ï¼Œç±»ä¼¼äº Linux ä¸­çš„ ç®¡é“ å‘½ä»¤</span>
runnable = (  
    {  
        <span class="hljs-comment"># RunnablePassthrough å°†è¾“å…¥æ•°æ®åŸæ ·ä¼ é€’åˆ°ä¸‹æ¸¸æ­¥éª¤ï¼Œè¯´ç™½äº†å°±æ˜¯è·å–è¾“å…¥çš„æ–‡æœ¬ï¼Œå¯ä»¥å°†å…¶ç†è§£ä¸º Python ä¸­çš„ input</span>
        <span class="hljs-string">"text"</span>: RunnablePassthrough()  
    } | prompt | structured_llm  
)  

ret = runnable.invoke(<span class="hljs-string">"ä¸è¶…è¿‡ 100 å…ƒçš„æµé‡å¤§çš„å¥—é¤æœ‰å“ªäº›"</span>)  
<span class="hljs-built_in">print</span>(json.dumps(ret.model_dump(), indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))

<span class="hljs-comment"># æµå¼è¾“å‡º</span>
prompt = PromptTemplate.from_template(<span class="hljs-string">"è®²ä¸ªå…³äº{topic}çš„ç¬‘è¯"</span>)  
runnable = (  
    {  
        <span class="hljs-string">"topic"</span>: RunnablePassthrough()  
    } | prompt | llm | StrOutputParser()  
)  
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> runnable.stream(<span class="hljs-string">"å°çŒ«çƒçƒ"</span>):  
    <span class="hljs-built_in">print</span>(s, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
</code></pre>
<p>è€Œä¸”åœ¨é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥æ”¯æŒå·¥å‚æ¨¡å¼ï¼Œå³å¯ä»¥è‡ªç”±é€‰æ‹©è¦æ¨ç†çš„æ¨¡å‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate, HumanMessagePromptTemplate  
<span class="hljs-keyword">from</span> langchain_core.runnables.utils <span class="hljs-keyword">import</span> ConfigurableField  
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser  
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough  
  
<span class="hljs-comment"># æ¨¡å‹1  </span>
llm_max = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  
<span class="hljs-comment"># æ¨¡å‹2  </span>
llm_plus = ChatOpenAI(model=<span class="hljs-string">"qwen-plus"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>), temperature=<span class="hljs-number">0</span>)  
  
<span class="hljs-comment"># é€šè¿‡ configurable_alternatives æŒ‰æŒ‡å®šå­—æ®µé€‰æ‹©æ¨¡å‹  </span>
<span class="hljs-comment"># å°†ä¸¤ä¸ªæ¨¡å‹åŒ…è£…ä¸ºå¯åˆ‡æ¢é€‰é¡¹  </span>
llm = llm_plus.configurable_alternatives(  
    <span class="hljs-comment"># é…ç½®å­—æ®µ IDï¼ˆç”¨äºè¿è¡Œæ—¶åˆ‡æ¢ï¼‰  </span>
    ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"llm"</span>),  
    <span class="hljs-comment"># é»˜è®¤ä½¿ç”¨ qwen3 plus æ¨¡å‹  </span>
    default_key=<span class="hljs-string">"plus"</span>,  
    <span class="hljs-comment"># æ³¨å†Œ qwen3 maxï¼Œé”®åä¸º "max"  </span>
    <span class="hljs-built_in">max</span>=llm_max  
)  
  
<span class="hljs-comment"># prompt æ¨¡æ¿  </span>
prompt = ChatPromptTemplate.from_messages([  
    HumanMessagePromptTemplate.from_template(<span class="hljs-string">"{query}"</span>)  
])  
  
<span class="hljs-comment"># LCEL  </span>
chain = {  
<span class="hljs-string">"query"</span>: RunnablePassthrough()  
} | prompt | llm | StrOutputParser()  
  
<span class="hljs-comment"># è¿è¡Œæ—¶æŒ‡å®š â€œplusâ€ æˆ– â€œmaxâ€  </span>
ret = chain.with_config(configurable={  
    <span class="hljs-comment"># "llm": "plus"  </span>
    <span class="hljs-string">"llm"</span>: <span class="hljs-string">"max"</span>  
}).invoke(<span class="hljs-string">"ä½ å«ä»€ä¹ˆåå­—ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸‹"</span>)  
<span class="hljs-built_in">print</span>(ret)
</code></pre>
<p>è€Œä¸”ä½¿ç”¨é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥ç›´æ¥å®ç°ä¸€ä¸ª RAG</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.embeddings <span class="hljs-keyword">import</span> OpenAIEmbeddings
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> PyMuPDFLoader  
<span class="hljs-keyword">from</span> langchain.text_splitter <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter  
<span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

<span class="hljs-comment"># åŠ è½½æ–‡æ¡£  </span>
loader = PyMuPDFLoader(<span class="hljs-string">"./resource/2307.09288v2.pdf"</span>)  
pages = loader.load_and_split()

<span class="hljs-comment"># æ–‡æ¡£åˆ‡åˆ†  </span>
text_splitter = RecursiveCharacterTextSplitter(  
    chunk_size=<span class="hljs-number">300</span>,  
    chunk_overlap=<span class="hljs-number">100</span>,  
    length_function=<span class="hljs-built_in">len</span>,  
    add_start_index=<span class="hljs-literal">True</span>  
)  
texts = text_splitter.create_documents(  
    [  
        page.page_content <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages[:<span class="hljs-number">1</span>]  
    ]  
)

<span class="hljs-comment"># çŒåº“  </span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)  
db = <span class="hljs-literal">None</span>  
<span class="hljs-keyword">for</span> i, text <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(texts):  
    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:  
        db = FAISS.from_documents([text], embeddings)  
    <span class="hljs-keyword">else</span>:  
        db.add_documents([text])
        
<span class="hljs-comment"># æ£€ç´¢ top 2 çš„ç»“æœ  </span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">2</span>})

<span class="hljs-comment"># prompt æ¨¡æ¿  </span>
template = <span class="hljs-string">"""  
Answer the question based only on the following context:  
{context}  
  
Questions: {question}  
"""</span>  
prompt = ChatPromptTemplate.from_template(template)

<span class="hljs-comment"># chainï¼Œå…¨éƒ¨å£°æ˜å¥½åï¼Œç›´æ¥å…¨éƒ¨ä¸²è”èµ·æ¥äº†</span>
rag_chain = (  
    {  
        <span class="hljs-string">"question"</span>: RunnablePassthrough(),  
        <span class="hljs-string">"context"</span>: retriever  
    } | prompt | llm | StrOutputParser()  
)  
ret = rag_chain.invoke(<span class="hljs-string">"Llama 2 çš„æœ‰å¤šå°‘å‚æ•°ï¼Ÿ"</span>)  
<span class="hljs-built_in">print</span>(ret)
</code></pre>
<h3 data-id="heading-17">4.2 Agent</h3>
<p>è€Œ Agent å°±æ˜¯æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼Œè‡ªåŠ¨è§„åˆ’æ‰§è¡Œæ­¥éª¤ï¼Œè‡ªåŠ¨é€‰æ‹©æ¯ä¸€æ­¥éœ€è¦çš„å·¥å…·ï¼Œæœ€ç»ˆå®Œæˆç”¨æˆ·æŒ‡å®šçš„åŠŸèƒ½</p>
<p>LangChain å®ç° Agentï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œè¿™ä¸¤ç±»çš„åç§°ï¼Œå®˜æ–¹æ˜¯æ²¡æœ‰è¿™ä¸ªè¯´æ³•çš„ï¼Œåªæ˜¯æˆ‘ç”¨æ¥æ–¹ä¾¿åŒºåˆ†</p>
<h4 data-id="heading-18">4.2.1 ä¼ ç»Ÿæ–¹å¼</h4>
<p>ä½¿ç”¨ AgentTypeï¼Œè¿›è¡ŒæŒ‡å®šï¼Œæç¤ºè¯å†…ç½®ä¸å¯è§</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain_core.tools <span class="hljs-keyword">import</span> StructuredTool, Tool

<span class="hljs-comment"># 1. è·å– Tavily æœç´¢å·¥å…·çš„å®ä¾‹</span>
<span class="hljs-comment"># ä½¿ç”¨ä¹‹å‰è¦é…ç½®å¥½ TAVILY_API_KEY ç¯å¢ƒå˜é‡</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)
<span class="hljs-comment"># ç”±äº TavilySearchResults ç±»æ˜¯ç»§æ‰¿äº† BaseTool åŸºç±»çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å°è£…ä¸€å±‚ï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å¿…é¡»å†å°è£…ä¸€å±‚ï¼Œå¦‚ä½•å°è£…ï¼Œæ¥ä¸‹æ¥ä¼šä¸¾ä¾‹</span>

<span class="hljs-comment"># 2. å®šä¹‰ä¸€ä¸ªè®¡ç®—å·¥å…·</span>
<span class="hljs-comment"># Langchain å°è£…çš„å·¥å…·ç±»ï¼Œå¯ä»¥è¿›è¡Œæ•°å­¦è®¡ç®—ï¼Œè¿™ä¸ªé›†æˆçš„åŸºç±»ä¸æ˜¯ BaseToolï¼Œæ‰€ä»¥å¿…é¡»å¾—åŒ…ä¸€å±‚æ‰è¡Œ  </span>
python_repl = PythonREPL()  
<span class="hljs-comment"># å°è£…çš„è¯ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ Tool</span>
calc_tool = Tool(  
    name=<span class="hljs-string">"calculator"</span>,  
    <span class="hljs-comment"># æŒ‡å®šå…¥å£å‡½æ•°</span>
    func=python_repl.run,  
    description=<span class="hljs-string">"ç”¨äºæ‰§è¡Œæ•°å­¦è®¡ç®—ï¼Œä¾‹å¦‚è®¡ç®—ç™¾åˆ†æ¯”å˜åŒ–"</span>  
)
<span class="hljs-comment"># å¦ä¸€ç§åˆ™æ˜¯ä½¿ç”¨ StructuredTool</span>
calc_tool = StructuredTool.from_function(
    func=python_repl.run,  
    name=<span class="hljs-string">"Search"</span>,  
    description=<span class="hljs-string">"ç”¨äºæ£€ç´¢äº’è”ç½‘ä¸Šçš„ä¿¡æ¯"</span>  
)


<span class="hljs-comment"># 3. å†å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å·¥å…·</span>
<span class="hljs-comment"># è‡ªå®šä¹‰å·¥å…·å‡½æ•°  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">simple_calculator</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:  
    <span class="hljs-string">"""  
    åŸºç¡€æ•°å­¦è®¡ç®—å·¥å…·ï¼Œæ”¯æŒåŠ å‡ä¹˜é™¤å’Œå¹‚è¿ç®—  
    :param expression: æ•°å­¦è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ â€œ3+5â€ æˆ– â€œ2**3â€  
    :return: è®¡ç®—ç»“æœå­—ç¬¦ä¸²æˆ–é”™è¯¯ä¿¡æ¯  
    """</span>  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[å·¥å…·è°ƒç”¨] è®¡ç®—è¡¨è¾¾å¼ï¼š<span class="hljs-subst">{expression}</span>"</span>)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"mua ~"</span>)  
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-built_in">eval</span>(expression))  
  
  
<span class="hljs-comment"># åŒ…è£…ä¸€ä¸‹ï¼Œä¸€å®šè¦åŒ…å« name å’Œ description</span>
base_cal_tool = Tool(  
    func=simple_calculator,  
    name=<span class="hljs-string">"math_calculator"</span>,  
    description=<span class="hljs-string">"ç”¨äºåŸºç¡€æ•°å­¦è®¡ç®—ï¼Œè¾“å…¥å¿…é¡»æ˜¯çº¯æ•°å­¦è¡¨è¾¾å¼ï¼ˆå¦‚â€œ3+5â€æˆ–â€œ2**3â€è¡¨ç¤ºå¹³æ–¹ï¼‰ï¼Œä¸æ”¯æŒå­—æ¯æˆ–ç‰¹æ®Šç¬¦å·"</span>  
)

<span class="hljs-comment"># 4. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># 5. è·å– Agent å®ä¾‹</span>
<span class="hljs-comment"># å¯ä»¥ä½¿ç”¨ ReAct æ¨¡å‹  </span>
<span class="hljs-comment"># agent = AgentType.ZERO_SHOT_REACT_DESCRIPTION  </span>
<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨ function callï¼Œé€‰æ‹©å…¶ä»–çš„æ¨¡å‹ï¼Œéœ€è¦çœ‹å®˜æ–¹æ–‡æ¡£</span>
agent = AgentType.OPENAI_FUNCTIONS

<span class="hljs-comment"># 6. è·å– AgentExecutor å®ä¾‹  </span>
agent_executor = initialize_agent(
    <span class="hljs-comment"># è¿˜å¯ä»¥ç›´æ¥å»å­˜æ”¾å·¥å…·ç±»ï¼Œå› ä¸ºéƒ½ç»§æ‰¿çš„æ˜¯ä¸€ä¸ªçˆ¶ç±»ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çœç•¥æ‰  </span>
    <span class="hljs-comment"># åŒºåˆ«åœ¨äºï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå¯ä»¥è‡ªå®šä¹‰ nameï¼Œdescription è¿™äº›ï¼Œè€Œä½¿ç”¨è¿™ç§æ–¹å¼åˆ™æ˜¯å·²ç»å†…éƒ¨å†™æ­»ï¼Œä¸èƒ½è‡ªå®šä¹‰äº†  </span>
    <span class="hljs-comment"># name å’Œ description æ˜¯å¿…è¦çš„ï¼Œllm ä¼šæ ¹æ®è¿™äº›æ¥å†³å®šæ˜¯å¦è°ƒç”¨  </span>
    tools=[search, calc_tool, base_cal_tool],  
    llm=llm,  
    agent=agent,  
    <span class="hljs-comment"># æ˜¾ç¤ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯  </span>
    verbose=<span class="hljs-literal">True</span>  
)

<span class="hljs-comment"># 6. é€šè¿‡ AgentExecutor è°ƒç”¨ invokeï¼Œå¾—åˆ°å“åº”  </span>
<span class="hljs-comment"># result = agent_executor.invoke("ç‰¹æ–¯æ‹‰ Model Y çš„è½¦ä»·ï¼Œè¿‘å‡ å¹´æœ‰æ²¡æœ‰é™ä½è¶‹åŠ¿ï¼Ÿ")  </span>
<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼å»è°ƒç”¨  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"ç‰¹æ–¯æ‹‰ Model Y çš„è½¦ä»·ï¼Œè¿‘å‡ å¹´æœ‰æ²¡æœ‰é™ä½è¶‹åŠ¿ï¼Ÿ"</span>
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h4 data-id="heading-19">4.2.2 é€šç”¨æ–¹å¼</h4>
<p>ä½¿ç”¨ AgentExecutor æ„é€ æ–¹æ³•ï¼Œå¯ä»¥è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain <span class="hljs-keyword">import</span> hub
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹</span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># 3. æä¾›æç¤ºè¯æ¨¡æ¿</span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼ï¼Œæ¨èä½¿ç”¨ ChatPromptTemplate  </span>
<span class="hljs-comment"># prompt_template = ChatPromptTemplate.from_messages([  </span>
<span class="hljs-comment"># SystemMessage("ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ AI åŠ©æ‰‹ï¼Œæ ¹æ®ç”¨æˆ·çš„æé—®ï¼Œå¿…è¦æ—¶è°ƒç”¨ Search å·¥å…·ï¼Œä½¿ç”¨äº’è”ç½‘æ£€ç´¢æ•°æ®"),  </span>
<span class="hljs-comment"># # å¦‚æœä½¿ç”¨ HumanMessage ç±»ï¼Œ{input} ä¼šè¢«å½“ä½œçº¯æ–‡æœ¬ï¼Œè€Œééœ€è¦æ›¿æ¢çš„å˜é‡å ä½ç¬¦ï¼Œä¸æ™“å¾—ä¸ºå•¥ï¼Œè¿˜æ˜¯ä¸å¤ªç†Ÿå“‡  </span>
<span class="hljs-comment"># # HumanMessage("{input}"),  </span>
<span class="hljs-comment"># ("human", "{input}"),  </span>
<span class="hljs-comment"># # è¿™ä¸ªå¿…é¡»å£°æ˜ï¼Œç”¨äºå­˜å‚¨å’Œä¼ é€’ Agent çš„æ€è€ƒè¿‡ç¨‹ï¼Œ  </span>
<span class="hljs-comment"># # æ¯”å¦‚åœ¨é“¾å¼è°ƒç”¨å·¥å…·æ—¶ï¼ˆå¦‚å…ˆæœå¤©æ°”å†æ¨èè¡Œç¨‹ï¼‰ï¼Œè¯¥å­—æ®µä¼šä¿ç•™å†å²æ­¥éª¤ï¼Œé¿å…ä¸Šä¸‹æ–‡ä¸¢å¤±ï¼Œä¸ä¼ å…¥ä¼šæŠ¥é”™  </span>
<span class="hljs-comment"># # ä½¿ç”¨ä¸‹é¢è¿™ä¸‰ä¸ªæ–¹å¼å£°æ˜éƒ½æ˜¯å¯ä»¥çš„  </span>
<span class="hljs-comment"># # MessagesPlaceholder(variable_name="agent_scratchpad"),  </span>
<span class="hljs-comment"># # ("system", "{agent_scratchpad}")  </span>
<span class="hljs-comment"># ("placeholder", "{agent_scratchpad}")  </span>
<span class="hljs-comment"># ])  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼ï¼Œæ¨èç›´æ¥ä½¿ç”¨ hubï¼Œæˆ–è€… copy ä¸‹æ¥ï¼Œä½¿ç”¨ PromptTemplateï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›´æ¥å®Œæ•´ç‰ˆçš„ prompt æ¯”åˆ‡å—çš„æ•ˆæœè¦å¥½ä¸€äº›  </span>
<span class="hljs-comment"># ä½¿ç”¨ä¸Šé¢çš„ prompt æ¨¡æ¿ï¼Œä¼šæŠ¥é”™ï¼Œæ˜¾ç¤ºç¼ºå°‘ {'tools', 'tool_names'}ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨ç°æˆçš„ react æ¨¡æ¿  </span>
<span class="hljs-comment"># å› ä¸ºæ‰‹åŠ¨é…ç½®çš„è¯ï¼Œä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå¿…é¡»å¾—åŒ…å« tools tool_names agent_scratchpadï¼Œå¤ªéº»çƒ¦äº†ï¼Œæ‹¼æ¥èµ·æ¥  </span>
prompt_template = hub.pull(<span class="hljs-string">"hwchase17/react"</span>)  
<span class="hljs-built_in">print</span>(prompt_template.input_variables)

<span class="hljs-comment"># 4. è·å– Agent å®ä¾‹</span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼  </span>
<span class="hljs-comment"># agent = create_tool_calling_agent(  </span>
<span class="hljs-comment"># llm=llm,  </span>
<span class="hljs-comment"># prompt=prompt_template,  </span>
<span class="hljs-comment"># tools=[search_tool],  </span>
<span class="hljs-comment"># )  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼  </span>
agent = create_react_agent(  
    llm=llm,  
    prompt=prompt_template,  
    tools=[search_tool],  
)

<span class="hljs-comment"># 5. è·å– AgentExecutor å®ä¾‹</span>
agent_executor = AgentExecutor(  
    agent=agent,  
    tools=[search_tool],  
    verbose=<span class="hljs-literal">True</span>  
)  

<span class="hljs-comment"># 6. é€šè¿‡ AgentExecutor è°ƒç”¨ invoke å¾—åˆ°å“åº”  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æŸ¥è¯¢æ­å·ä¸‹å‘¨çš„å¤©æ°”æƒ…å†µ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h4 data-id="heading-20">4.2.3 åµŒå…¥è®°å¿†</h4>
<p>åœ¨æ„é€  Agent çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åµŒå…¥è®°å¿†ï¼Œä½œä¸ºä¸€ä¸ªä¼šè¯å»è¿›è¡Œå¯¹è¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼Œè¿›è¡ŒåµŒå…¥è®°å¿†ï¼Œä»¥ ReAct æ¨¡å¼ä¸ºä¾‹</span>
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain.memory <span class="hljs-keyword">import</span> ConversationBufferMemory

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)  

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  
  
<span class="hljs-comment"># 3. è·å–ä¸€ä¸ªè®°å¿†çš„å®ä¾‹ï¼Œä½¿ç”¨ ConversationBufferMemory æ¥å­˜å‚¨ä¸Šä¸‹æ–‡  </span>
memory = ConversationBufferMemory(  
    <span class="hljs-comment"># æƒ³è¿”å›ä¸€ä¸ªæ¶ˆæ¯  </span>
    return_messages=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># ç”¨æ¥å­˜æ”¾å†å²è®°å½•ï¼Œkey å€¼è¦å’Œ prompt ä¸­çš„è¦ä¿æŒä¸€ç›´  </span>
    memory_key=<span class="hljs-string">"chat_history"</span>  
)  
  
<span class="hljs-comment"># 4. è·å– Agent å®ä¾‹  </span>
<span class="hljs-comment"># è¦æƒ³å­˜å‚¨ä¸Šä¸‹æ–‡å°±ä¸èƒ½ä½¿ç”¨è¿™ä¸ªäº†ï¼Œè¿™é‡Œé¢æ²¡æœ‰ç±»ä¼¼ chat_history çš„å­—æ®µå»å­˜å‚¨ä¸Šä¸‹æ–‡  </span>
<span class="hljs-comment"># agent = AgentType.ZERO_SHOT_REACT_DESCRIPTION  </span>
<span class="hljs-comment"># è¿™ä¸ª Agent å®ä¾‹é‡Œé¢ï¼Œæœ‰ chat_history å­—æ®µï¼Œä¸“é—¨å»å­˜å‚¨ä¸Šä¸‹æ–‡</span>
agent = AgentType.CONVERSATIONAL_REACT_DESCRIPTION  
  
<span class="hljs-comment"># 5. è·å– AgentExecutor  </span>
agent_executor = initialize_agent(  
    agent=agent,  
    llm=llm,  
    tools=[search],  
    memory=memory,  
    verbose=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># Qwen3-Max æ¨¡å‹è¾“å‡ºæ ¼å¼ä¸ CONVERSATIONAL_REACT_DESCRIPTION ä»£ç†æ¨¡æ¿ä¸å…¼å®¹ï¼Œå¯¼è‡´è§£æå™¨æ— æ³•è¯†åˆ«å·¥å…·è°ƒç”¨æŒ‡ä»¤ï¼Œä¸€ç›´æŠ¥é”™ï¼Œéœ€è¦æ·»åŠ è¿™ä¸ª</span>
    handle_parsing_errors=<span class="hljs-literal">True</span>  
)  

<span class="hljs-comment"># 6. æ‰§è¡Œ  </span>
<span class="hljs-comment"># ä½¿ç”¨äºŒæ¬¡å¯¹è¯çš„æ–¹å¼æ¥è¿›è¡Œæµ‹è¯•  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æ­å·æ˜å¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)  
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"å±±è¥¿å‘¢ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ é€šç”¨æ–¹å¼å»åµŒå…¥è®°å¿†</span>
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain.memory <span class="hljs-keyword">import</span> ConversationBufferMemory
<span class="hljs-keyword">from</span> langchain <span class="hljs-keyword">import</span> hub

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  

<span class="hljs-comment"># 3. æä¾›æç¤ºè¯æ¨¡æ¿  </span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼ï¼Œæ¨èä½¿ç”¨ ChatPromptTemplate  </span>
<span class="hljs-comment"># prompt_template = ChatPromptTemplate.from_messages([  </span>
    <span class="hljs-comment"># SystemMessage("ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ AI åŠ©æ‰‹ï¼Œæ ¹æ®ç”¨æˆ·çš„æé—®ï¼Œå¿…è¦æ—¶è°ƒç”¨ Search å·¥å…·ï¼Œä½¿ç”¨äº’è”ç½‘æ£€ç´¢æ•°æ®"),  </span>
    <span class="hljs-comment"># # é¡ºåºä¸å›ºå®šï¼Œä½†æ˜¯æ¨¡æ¿ä¸­å¿…é¡»åŒ…å«è¿™å‡ ä¸ªé”®å€¼</span>
    <span class="hljs-comment"># ("human", "{input}"),  </span>
    <span class="hljs-comment"># ("placeholder", "{agent_scratchpad}"),  </span>
    <span class="hljs-comment"># # å­˜å‚¨ä¸Šä¸‹æ–‡çš„è®°å¿†  </span>
    <span class="hljs-comment"># ("system", "{history}")  </span>
<span class="hljs-comment"># ])  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼ï¼Œæ¨èç›´æ¥ä½¿ç”¨ hubï¼Œæˆ–è€… copy ä¸‹æ¥ï¼Œä½¿ç”¨ PromptTemplate  </span>
prompt_template = hub.pull(<span class="hljs-string">"hwchase17/react-chat"</span>)  
<span class="hljs-built_in">print</span>(prompt_template.input_variables)  

<span class="hljs-comment"># 4. æä¾›è®°å¿†çš„å®ä¾‹</span>
memory = ConversationBufferMemory(  
    return_messages=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># è¯¥å€¼è¦ä¸ prompt ä¸­çš„åŒå  </span>
    <span class="hljs-comment"># Function Call æ¨¡å¼  </span>
    <span class="hljs-comment"># memory_key="history"  </span>
    <span class="hljs-comment"># ReAct æ¨¡å¼ï¼Œå› ä¸º prompt ä¸­çš„å˜é‡åä¸º chat_historyï¼Œæ‰€ä»¥è¦è¿›è¡Œæ›¿æ¢ </span>
    memory_key=<span class="hljs-string">"chat_history"</span>  
)

<span class="hljs-comment"># 5. è·å– Agent å®ä¾‹  </span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼  </span>
<span class="hljs-comment"># agent = create_tool_calling_agent(  </span>
<span class="hljs-comment"># llm=llm,  </span>
<span class="hljs-comment"># prompt=prompt_template,  </span>
<span class="hljs-comment"># tools=[search],  </span>
<span class="hljs-comment"># )  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼  </span>
agent = create_react_agent(  
    llm=llm,  
    prompt=prompt_template,  
    tools=[search],  
)  

<span class="hljs-comment"># 6. è·å– AgentExecutor å®ä¾‹  </span>
agent_executor = AgentExecutor(  
    agent=agent,  
    tools=[search],  
    verbose=<span class="hljs-literal">True</span>,  
    memory=memory  
)

<span class="hljs-comment"># 7. é€šè¿‡ AgentExecutor è°ƒç”¨ invoke å¾—åˆ°å“åº”  </span>
<span class="hljs-comment"># ä½¿ç”¨äºŒæ¬¡å¯¹è¯çš„æ–¹å¼æ¥è¿›è¡Œæµ‹è¯•  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æ­å·æ˜å¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)  
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"å±±è¥¿å‘¢ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯]]></title>    <link>https://juejin.cn/post/7585758163435061254</link>    <guid>https://juejin.cn/post/7585758163435061254</guid>    <pubDate>2025-12-21T06:50:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435061254" data-draft-id="7585485074038947846" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T06:50:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T06:50:58.000Z" title="Sun Dec 21 2025 06:50:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>åœ¨Javaç¼–ç¨‹ä¸­ï¼ŒScannerå°±åƒç¨‹åºçš„"è€³æœµ"ï¼Œè®©ç¨‹åºèƒ½å¤Ÿå¬åˆ°ç”¨æˆ·çš„å£°éŸ³ï¼Œå®ç°çœŸæ­£çš„äº¤äº’å¼ç¨‹åºã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å­¦ä¹ è¿™ä¸ªè®©Javaç¨‹åº"æ´»"èµ·æ¥çš„å…³é”®å·¥å…·ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ScanneråŸºç¡€ï¼šåˆ›å»ºä¸ä½¿ç”¨</h2>
<h3 data-id="heading-1">1.1 å¯¼å…¥å’Œåˆ›å»ºScanner</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ScannerBasic</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šåˆ›å»ºScannerå¯¹è±¡</span>
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨Scanner</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥ä½ çš„åå­—ï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();
        System.out.println(<span class="hljs-string">"ä½ å¥½ï¼Œ"</span> + name + <span class="hljs-string">"ï¼"</span>);
        
        <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šå…³é—­Scannerï¼ˆé‡è¦ï¼ï¼‰</span>
        scanner.close();
    }
}
</code></pre>
<h3 data-id="heading-2">1.2 è¯»å–ä¸åŒç±»å‹çš„æ•°æ®</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReadDifferentTypes</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// è¯»å–æ•´æ•°</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        <span class="hljs-comment">// è¯»å–å°æ•°</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥èº«é«˜ï¼ˆç±³ï¼‰ï¼š"</span>);
        <span class="hljs-type">double</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> scanner.nextDouble();
        
        <span class="hljs-comment">// è¯»å–å­—ç¬¦ä¸²</span>
        scanner.nextLine();  <span class="hljs-comment">// é‡è¦ï¼šå…ˆæ¸…ç©ºç¼“å†²åŒº</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥åŸå¸‚ï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">city</span> <span class="hljs-operator">=</span> scanner.nextLine();
        
        System.out.println(<span class="hljs-string">"å¹´é¾„ï¼š"</span> + age);
        System.out.println(<span class="hljs-string">"èº«é«˜ï¼š"</span> + height);
        System.out.println(<span class="hljs-string">"åŸå¸‚ï¼š"</span> + city);
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-3">äºŒã€æœ€é‡è¦çš„ä¸¤ä¸ªæ–¹æ³•ï¼šnext() vs nextLine()</h2>
<h3 data-id="heading-4">2.1 å…³é”®åŒºåˆ«ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NextVsNextLine</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();  <span class="hljs-comment">// è¿™é‡Œä¼šå‡ºé—®é¢˜ï¼</span>
        System.out.println(<span class="hljs-string">"ä½ å¥½ï¼Œ"</span> + name);
        
        <span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•</span>
        System.out.print(<span class="hljs-string">"\nè¯·é‡æ–°è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age2</span> <span class="hljs-operator">=</span> scanner.nextInt();
        scanner.nextLine();  <span class="hljs-comment">// å…³é”®ï¼šæ¸…ç©ºç¼“å†²åŒº</span>
        
        System.out.print(<span class="hljs-string">"è¯·é‡æ–°è¾“å…¥å§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name2</span> <span class="hljs-operator">=</span> scanner.nextLine();
        System.out.println(<span class="hljs-string">"è¿™æ¬¡å¯¹äº†ï¼Œä½ å¥½ï¼Œ"</span> + name2);
        
        scanner.close();
    }
}
</code></pre>
<h3 data-id="heading-5">2.2 è®°å¿†æŠ€å·§</h3>
<ul>
<li><strong>next()</strong> ï¼šè¯»å–ä¸€ä¸ª"å•è¯"ï¼ˆé‡åˆ°ç©ºæ ¼å°±åœæ­¢ï¼‰</li>
<li><strong>nextLine()</strong> ï¼šè¯»å–æ•´è¡Œï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</li>
<li><strong>é‡è¦</strong>ï¼šä½¿ç”¨nextInt()ã€nextDouble()ç­‰åï¼Œè¦ç”¨<code>scanner.nextLine()</code>æ¸…ç©ºç¼“å†²åŒº</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€å®æˆ˜åº”ç”¨ï¼šå­¦ç”Ÿæˆç»©è®¡ç®—å™¨</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StudentGradeCalculator</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        System.out.println(<span class="hljs-string">"=== å­¦ç”Ÿæˆç»©è®¡ç®—å™¨ ===\n"</span>);
        
        <span class="hljs-comment">// è¾“å…¥å­¦ç”Ÿä¿¡æ¯</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å­¦ç”Ÿå§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥è¯­æ–‡æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">chinese</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥æ•°å­¦æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">math</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥è‹±è¯­æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">english</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        scanner.nextLine();  <span class="hljs-comment">// æ¸…ç©ºç¼“å†²åŒº</span>
        
        <span class="hljs-comment">// è®¡ç®—</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> chinese + math + english;
        <span class="hljs-type">double</span> <span class="hljs-variable">average</span> <span class="hljs-operator">=</span> total / <span class="hljs-number">3.0</span>;
        
        <span class="hljs-comment">// è¾“å‡ºç»“æœ</span>
        System.out.println(<span class="hljs-string">"\n=== æˆç»©æŠ¥å‘Š ==="</span>);
        System.out.println(<span class="hljs-string">"å§“åï¼š"</span> + name);
        System.out.println(<span class="hljs-string">"æ€»åˆ†ï¼š"</span> + total);
        System.out.printf(<span class="hljs-string">"å¹³å‡åˆ†ï¼š%.2f\n"</span>, average);
        
        <span class="hljs-comment">// åˆ¤æ–­ç­‰çº§</span>
        <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">90</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šä¼˜ç§€"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">80</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šè‰¯å¥½"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">60</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šåŠæ ¼"</span>);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šä¸åŠæ ¼"</span>);
        }
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-7">å››ã€é”™è¯¯å¤„ç†å’Œè¾“å…¥éªŒè¯</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputValidation</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// éªŒè¯å¹´é¾„è¾“å…¥ï¼ˆå¿…é¡»æ˜¯1-100ä¹‹é—´çš„æ•´æ•°ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">valid</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">while</span> (!valid) {
            System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼ˆ1-100ï¼‰ï¼š"</span>);
            
            <span class="hljs-keyword">if</span> (scanner.hasNextInt()) {
                age = scanner.nextInt();
                <span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">1</span> &amp;&amp; age &lt;= <span class="hljs-number">100</span>) {
                    valid = <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">else</span> {
                    System.out.println(<span class="hljs-string">"é”™è¯¯ï¼šå¹´é¾„å¿…é¡»åœ¨1-100ä¹‹é—´ï¼"</span>);
                }
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"é”™è¯¯ï¼šè¯·è¾“å…¥æ•´æ•°ï¼"</span>);
                scanner.next();  <span class="hljs-comment">// æ¸…é™¤é”™è¯¯çš„è¾“å…¥</span>
            }
        }
        
        scanner.nextLine();  <span class="hljs-comment">// æ¸…ç©ºç¼“å†²åŒº</span>
        System.out.println(<span class="hljs-string">"å¹´é¾„éªŒè¯é€šè¿‡ï¼š"</span> + age);
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-8">äº”ã€æœ€é‡è¦çŸ¥è¯†ç‚¹æ€»ç»“</h2>
<h3 data-id="heading-9">1. æ ¸å¿ƒä¸‰æ­¥éª¤</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å¯¼å…¥</span>
<span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-comment">// 2. åˆ›å»º</span>
<span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);

<span class="hljs-comment">// 3. ä½¿ç”¨</span>
<span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> scanner.nextLine();

<span class="hljs-comment">// 4. å…³é—­ï¼ˆä¸è¦å¿˜ï¼ï¼‰</span>
scanner.close();
</code></pre>
<h3 data-id="heading-10">2. é»„é‡‘æ³•åˆ™</h3>
<ul>
<li><strong>æ··åˆä½¿ç”¨nextXXX()å’ŒnextLine()æ—¶</strong>ï¼šå…ˆç”¨<code>scanner.nextLine()</code>æ¸…ç©ºç¼“å†²åŒº</li>
<li><strong>è¾“å…¥éªŒè¯</strong>ï¼šç”¨<code>hasNextInt()</code>ã€<code>hasNextDouble()</code>æ£€æŸ¥è¾“å…¥ç±»å‹</li>
<li><strong>å…³é—­Scanner</strong>ï¼šç”¨å®Œä¸€å®šè¦å…³é—­ï¼Œé‡Šæ”¾èµ„æº</li>
</ul>
<h3 data-id="heading-11">3. ä¸€å¥è¯è®°ä½</h3>
<p><strong>Scanneræ˜¯Javaç¨‹åºçš„"éº¦å…‹é£"â€”â€”nextXXX()æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼ŒnextLine()æ¸…ç©ºç¼“å†²åŒºï¼Œè®°å¾—ç”¨å®Œè¦å…³é—­ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7585758163435094022</link>    <guid>https://juejin.cn/post/7585758163435094022</guid>    <pubDate>2025-12-21T07:01:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435094022" data-draft-id="7585485074039013382" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T07:01:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T07:01:40.000Z" title="Sun Dec 21 2025 07:01:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ˜¯Javaçš„æ ¸å¿ƒæ€æƒ³ï¼Œå®ƒè®©ä»£ç æ›´åŠ æ¨¡å—åŒ–ã€å¯é‡ç”¨å’Œæ˜“ç»´æŠ¤ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨OOPçš„ä¸‰å¤§æ”¯æŸ±ï¼šå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ï¼Œè¿™æ˜¯æ¯ä¸ªJavaç¨‹åºå‘˜å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h2 data-id="heading-0">å¼•å…¥ï¼šä¸ºä»€ä¹ˆéœ€è¦é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ¸¸æˆç³»ç»Ÿï¼š</p>
<ul>
<li>æ¸¸æˆä¸­æœ‰ç©å®¶ï¼ˆPlayerï¼‰ã€æ•Œäººï¼ˆEnemyï¼‰ã€é“å…·ï¼ˆItemï¼‰ç­‰å¤šç§è§’è‰²</li>
<li>è¿™äº›è§’è‰²éƒ½æœ‰å…±åŒçš„ç‰¹å¾ï¼ˆå¦‚ä½ç½®ã€è¡€é‡ï¼‰ï¼Œä½†ä¹Ÿæœ‰å„è‡ªçš„ç‰¹æ®Šèƒ½åŠ›</li>
<li>å¦‚æœä¸ä½¿ç”¨OOPï¼Œä»£ç ä¼šå˜å¾—æ··ä¹±ä¸å ªï¼Œéš¾ä»¥ç»´æŠ¤</li>
</ul>
<p>ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç°å®ä¸–ç•Œçš„å®ä½“æŠ½è±¡ä¸º"å¯¹è±¡"ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„æ•°æ®å’Œè¡Œä¸ºï¼Œå°±åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œå¯ä»¥çµæ´»ç»„åˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€å°è£…ï¼šä¿æŠ¤æ•°æ®çš„"ä¿é™©ç®±"</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ</h3>
<p><strong>å°è£…</strong>å°±æ˜¯å°†æ•°æ®å’Œå¯¹æ•°æ®çš„æ“ä½œåŒ…è£…åœ¨ä¸€èµ·ï¼Œå¹¶éšè—å®ç°ç»†èŠ‚ã€‚å°±åƒé“¶è¡Œçš„ATMæœºï¼š</p>
<ul>
<li>ä½ åªèƒ½é€šè¿‡ç•Œé¢æŒ‰é’®ï¼ˆå…¬å…±æ–¹æ³•ï¼‰æ“ä½œ</li>
<li>ä¸èƒ½ç›´æ¥æ¥è§¦å†…éƒ¨çš„ç°é‡‘ï¼ˆç§æœ‰æ•°æ®ï¼‰</li>
<li>ATMå†…éƒ¨çš„è¿ä½œæœºåˆ¶å¯¹ä½ éšè—ï¼ˆå®ç°ç»†èŠ‚ï¼‰</li>
</ul>
<h3 data-id="heading-3">1.2 å°è£…çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EncapsulationDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºé“¶è¡Œè´¦æˆ·</span>
        <span class="hljs-type">BankAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankAccount</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"123456"</span>);
        
        <span class="hljs-comment">// âœ… æ­£ç¡®çš„è®¿é—®æ–¹å¼ï¼šé€šè¿‡å…¬å…±æ–¹æ³•</span>
        account.deposit(<span class="hljs-number">1000</span>);      <span class="hljs-comment">// å­˜æ¬¾</span>
        account.withdraw(<span class="hljs-number">500</span>);      <span class="hljs-comment">// å–æ¬¾</span>
        account.displayBalance();   <span class="hljs-comment">// æŸ¥çœ‹ä½™é¢</span>
        
        <span class="hljs-comment">// âŒ é”™è¯¯çš„æ–¹å¼ï¼šç›´æ¥è®¿é—®ç§æœ‰æ•°æ®</span>
        <span class="hljs-comment">// account.balance = 1000000;  // ç¼–è¯‘é”™è¯¯ï¼æ— æ³•ç›´æ¥è®¿é—®</span>
        <span class="hljs-comment">// account.password = "hack";  // ç¼–è¯‘é”™è¯¯ï¼æ— æ³•ç›´æ¥è®¿é—®</span>
        
        System.out.println(<span class="hljs-string">"\nå°è¯•éæ³•æ“ä½œï¼š"</span>);
        account.withdraw(<span class="hljs-number">10000</span>);    <span class="hljs-comment">// ä½™é¢ä¸è¶³ï¼Œå®‰å…¨è¢«æ‹’ç»</span>
        
        System.out.println(<span class="hljs-string">"\nå°è¯•ç ´è§£å¯†ç ï¼š"</span>);
        <span class="hljs-comment">// æ— æ³•ç›´æ¥ä¿®æ”¹å¯†ç ï¼Œåªèƒ½é€šè¿‡éªŒè¯æµç¨‹</span>
        account.changePassword(<span class="hljs-string">"wrong"</span>, <span class="hljs-string">"new123"</span>);  <span class="hljs-comment">// å¤±è´¥</span>
        account.changePassword(<span class="hljs-string">"123456"</span>, <span class="hljs-string">"new123"</span>); <span class="hljs-comment">// æˆåŠŸ</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-comment">// ç§æœ‰å±æ€§ï¼šå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®ï¼ˆå°è£…çš„ç²¾é«“ï¼‰</span>
    <span class="hljs-keyword">private</span> String accountHolder;  <span class="hljs-comment">// è´¦æˆ·æŒæœ‰äºº</span>
    <span class="hljs-keyword">private</span> String password;       <span class="hljs-comment">// å¯†ç </span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> balance;        <span class="hljs-comment">// ä½™é¢</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String accountNumber; <span class="hljs-comment">// è´¦å·ï¼ˆfinalè¡¨ç¤ºä¸å¯å˜ï¼‰</span>
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BankAccount</span><span class="hljs-params">(String holder, String pwd)</span> {
        <span class="hljs-built_in">this</span>.accountHolder = holder;
        <span class="hljs-built_in">this</span>.password = pwd;
        <span class="hljs-built_in">this</span>.balance = <span class="hljs-number">0.0</span>;
        <span class="hljs-built_in">this</span>.accountNumber = generateAccountNumber();
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå­˜æ¬¾</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
            balance += amount;
            System.out.println(<span class="hljs-string">"æˆåŠŸå­˜æ¬¾ï¼š"</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
            logTransaction(<span class="hljs-string">"å­˜æ¬¾"</span>, amount);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"å­˜æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
        }
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå–æ¬¾</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">withdraw</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            System.out.println(<span class="hljs-string">"å–æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (amount &gt; balance) {
            System.out.println(<span class="hljs-string">"ä½™é¢ä¸è¶³ï¼å½“å‰ä½™é¢ï¼š"</span> + balance);
        } <span class="hljs-keyword">else</span> {
            balance -= amount;
            System.out.println(<span class="hljs-string">"æˆåŠŸå–æ¬¾ï¼š"</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
            logTransaction(<span class="hljs-string">"å–æ¬¾"</span>, amount);
        }
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šæ˜¾ç¤ºä½™é¢</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayBalance</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è´¦æˆ·ï¼š"</span> + accountNumber);
        System.out.println(<span class="hljs-string">"æŒæœ‰äººï¼š"</span> + accountHolder);
        System.out.println(<span class="hljs-string">"å½“å‰ä½™é¢ï¼š"</span> + balance + <span class="hljs-string">"å…ƒ"</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šä¿®æ”¹å¯†ç ï¼ˆéœ€è¦éªŒè¯åŸå¯†ç ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">changePassword</span><span class="hljs-params">(String oldPwd, String newPwd)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.password.equals(oldPwd)) {
            <span class="hljs-built_in">this</span>.password = newPwd;
            System.out.println(<span class="hljs-string">"å¯†ç ä¿®æ”¹æˆåŠŸ"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"åŸå¯†ç é”™è¯¯ï¼Œä¿®æ”¹å¤±è´¥"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼šåªèƒ½åœ¨ç±»å†…éƒ¨ä½¿ç”¨ï¼ˆå°è£…çš„å®ç°ç»†èŠ‚ï¼‰</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">generateAccountNumber</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç”Ÿæˆè´¦å·ï¼šæ—¶é—´æˆ³ + éšæœºæ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ACC"</span> + System.currentTimeMillis() % <span class="hljs-number">10000</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logTransaction</span><span class="hljs-params">(String type, <span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-comment">// è®°å½•äº¤æ˜“æ—¥å¿—</span>
        System.out.println(<span class="hljs-string">"[æ—¥å¿—] "</span> + type + <span class="hljs-string">" "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
    }
    
    <span class="hljs-comment">// Getteræ–¹æ³•ï¼šæä¾›å¯¹ç§æœ‰å±æ€§çš„å—æ§è®¿é—®</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAccountHolder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> accountHolder;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getBalance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> balance;
    }
    
    <span class="hljs-comment">// æ²¡æœ‰æä¾›passwordçš„getterï¼Œä¿æŠ¤å¯†ç å®‰å…¨</span>
    
    <span class="hljs-comment">// Setteræ–¹æ³•ï¼šæä¾›å¯¹ç§æœ‰å±æ€§çš„å—æ§ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAccountHolder</span><span class="hljs-params">(String holder)</span> {
        <span class="hljs-keyword">if</span> (holder != <span class="hljs-literal">null</span> &amp;&amp; !holder.trim().isEmpty()) {
            <span class="hljs-built_in">this</span>.accountHolder = holder;
        }
    }
}
</code></pre>
<h3 data-id="heading-4">1.3 å°è£…çš„å¥½å¤„</h3>
<ol>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼šé˜²æ­¢å¤–éƒ¨ä»£ç éšæ„ä¿®æ”¹å¯¹è±¡çŠ¶æ€</li>
<li><strong>æ˜“äºç»´æŠ¤</strong>ï¼šå†…éƒ¨å®ç°å¯ä»¥æ”¹å˜è€Œä¸å½±å“å¤–éƒ¨ä»£ç </li>
<li><strong>ä»£ç æ¸…æ™°</strong>ï¼šæ˜ç¡®åŒºåˆ†"å¯ä»¥åšä»€ä¹ˆ"å’Œ"å¦‚ä½•å®ç°"</li>
<li><strong>å‡å°‘è€¦åˆ</strong>ï¼šç±»ä¹‹é—´çš„å…³ç³»æ›´æ¸…æ™°ï¼Œæ›´æ˜“äºä¿®æ”¹</li>
</ol>
<h2 data-id="heading-5">äºŒã€ç»§æ‰¿ï¼šä»£ç å¤ç”¨çš„"åŸºå› ä¼ é€’"</h2>
<h3 data-id="heading-6">2.1 ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ</h3>
<p><strong>ç»§æ‰¿</strong>å…è®¸ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ã€‚å°±åƒç”Ÿç‰©å­¦ä¸­çš„é—ä¼ ï¼š</p>
<ul>
<li>å­©å­ç»§æ‰¿çˆ¶æ¯çš„ç‰¹å¾</li>
<li>ä½†å­©å­ä¹Ÿå¯ä»¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„ç‰¹å¾</li>
<li>ç»§æ‰¿å»ºç«‹äº†ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»</li>
</ul>
<h3 data-id="heading-7">2.2 ç»§æ‰¿çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritanceDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== ç»§æ‰¿ç¤ºä¾‹ï¼šè½¦è¾†ç³»ç»Ÿ ===\n"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºä¸åŒç±»å‹çš„è½¦è¾†</span>
        <span class="hljs-type">Vehicle</span> <span class="hljs-variable">genericVehicle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vehicle</span>(<span class="hljs-string">"é€šç”¨è½¦è¾†"</span>, <span class="hljs-number">2020</span>);
        <span class="hljs-type">Car</span> <span class="hljs-variable">myCar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">"ä¸°ç”°å¡ç½—æ‹‰"</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">4</span>);
        <span class="hljs-type">Motorcycle</span> <span class="hljs-variable">myBike</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Motorcycle</span>(<span class="hljs-string">"æœ¬ç”°CBR"</span>, <span class="hljs-number">2023</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-type">ElectricCar</span> <span class="hljs-variable">tesla</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElectricCar</span>(<span class="hljs-string">"ç‰¹æ–¯æ‹‰Model 3"</span>, <span class="hljs-number">2023</span>, <span class="hljs-number">4</span>, <span class="hljs-number">75</span>);
        
        <span class="hljs-comment">// å±•ç¤ºå¤šæ€æ€§ï¼šçˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</span>
        Vehicle[] vehicles = {genericVehicle, myCar, myBike, tesla};
        
        <span class="hljs-keyword">for</span> (Vehicle vehicle : vehicles) {
            vehicle.displayInfo();
            vehicle.start();  <span class="hljs-comment">// å¤šæ€ï¼šåŒä¸€ä¸ªæ–¹æ³•ï¼Œä¸åŒè¡Œä¸º</span>
            System.out.println();
        }
        
        <span class="hljs-comment">// è®¿é—®å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"=== å­ç±»ç‰¹æœ‰æ–¹æ³• ==="</span>);
        myCar.openSunroof();
        myBike.doWheelie();
        tesla.chargeBattery();
    }
}

<span class="hljs-comment">// çˆ¶ç±»ï¼šè½¦è¾†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// å—ä¿æŠ¤å±æ€§ï¼šå­ç±»å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½</span>
    <span class="hljs-keyword">protected</span> String brand;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> year;
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Vehicle</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year)</span> {
        <span class="hljs-built_in">this</span>.brand = brand;
        <span class="hljs-built_in">this</span>.year = year;
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå¯åŠ¨è½¦è¾†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨å¯åŠ¨..."</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šåœæ­¢è½¦è¾†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" å·²åœæ­¢"</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šæ˜¾ç¤ºä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å“ç‰Œï¼š"</span> + brand);
        System.out.println(<span class="hljs-string">"å¹´ä»½ï¼š"</span> + year);
    }
    
    <span class="hljs-comment">// è®¡ç®—å¹´é¾„</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculateAge</span><span class="hljs-params">(<span class="hljs-type">int</span> currentYear)</span> {
        <span class="hljs-keyword">return</span> currentYear - year;
    }
}

<span class="hljs-comment">// å­ç±»ï¼šæ±½è½¦ï¼ˆç»§æ‰¿Vehicleï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// å­ç±»ç‰¹æœ‰çš„å±æ€§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> doorCount;
    
    <span class="hljs-comment">// å­ç±»æ„é€ æ–¹æ³•ï¼šä½¿ç”¨superè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Car</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">int</span> doorCount)</span> {
        <span class="hljs-built_in">super</span>(brand, year);  <span class="hljs-comment">// å¿…é¡»é¦–å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</span>
        <span class="hljs-built_in">this</span>.doorCount = doorCount;
    }
    
    <span class="hljs-comment">// é‡å†™çˆ¶ç±»æ–¹æ³•ï¼ˆæ–¹æ³•è¦†ç›–ï¼‰</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ±½è½¦å¯åŠ¨ï¼šé’¥åŒ™è½¬åŠ¨ï¼Œå¼•æ“è½°é¸£ï¼"</span>);
    }
    
    <span class="hljs-comment">// å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSunroof</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" çš„å¤©çª—å·²æ‰“å¼€"</span>);
    }
    
    <span class="hljs-comment">// é‡å†™æ˜¾ç¤ºä¿¡æ¯æ–¹æ³•ï¼Œæ·»åŠ å­ç±»ç‰¹æœ‰ä¿¡æ¯</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();  <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"ç±»å‹ï¼šæ±½è½¦"</span>);
        System.out.println(<span class="hljs-string">"è½¦é—¨æ•°é‡ï¼š"</span> + doorCount);
    }
}

<span class="hljs-comment">// å­ç±»ï¼šæ‘©æ‰˜è½¦ï¼ˆç»§æ‰¿Vehicleï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Motorcycle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> hasSidecar;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Motorcycle</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">boolean</span> hasSidecar)</span> {
        <span class="hljs-built_in">super</span>(brand, year);
        <span class="hljs-built_in">this</span>.hasSidecar = hasSidecar;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ‘©æ‰˜è½¦å¯åŠ¨ï¼šè¸©ä¸‹å¯åŠ¨æ†ï¼Œå¼•æ“å’†å“®ï¼"</span>);
    }
    
    <span class="hljs-comment">// æ‘©æ‰˜è½¦ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWheelie</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨æŠ¬å¤´ç‰¹æŠ€ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.println(<span class="hljs-string">"ç±»å‹ï¼šæ‘©æ‰˜è½¦"</span>);
        System.out.println(<span class="hljs-string">"æ˜¯å¦æœ‰è¾¹è½¦ï¼š"</span> + (hasSidecar ? <span class="hljs-string">"æ˜¯"</span> : <span class="hljs-string">"å¦"</span>));
    }
}

<span class="hljs-comment">// å­ç±»çš„å­ç±»ï¼šç”µåŠ¨æ±½è½¦ï¼ˆç»§æ‰¿Carï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ElectricCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> batteryCapacity;  <span class="hljs-comment">// ç”µæ± å®¹é‡ï¼ˆåƒç“¦æ—¶ï¼‰</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ElectricCar</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">int</span> doorCount, <span class="hljs-type">double</span> batteryCapacity)</span> {
        <span class="hljs-built_in">super</span>(brand, year, doorCount);
        <span class="hljs-built_in">this</span>.batteryCapacity = batteryCapacity;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" ç”µåŠ¨æ±½è½¦å¯åŠ¨ï¼šæ— å£°å¯åŠ¨ï¼Œé›¶æ’æ”¾ï¼"</span>);
    }
    
    <span class="hljs-comment">// ç”µåŠ¨æ±½è½¦ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">chargeBattery</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨å……ç”µï¼Œç”µæ± å®¹é‡ï¼š"</span> + batteryCapacity + <span class="hljs-string">"kWh"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();  <span class="hljs-comment">// è°ƒç”¨Carçš„displayInfo</span>
        System.out.println(<span class="hljs-string">"åŠ¨åŠ›ç±»å‹ï¼šç”µåŠ¨"</span>);
        System.out.println(<span class="hljs-string">"ç”µæ± å®¹é‡ï¼š"</span> + batteryCapacity + <span class="hljs-string">"kWh"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8">2.3 ç»§æ‰¿çš„å…³é”®ç‚¹</h3>
<ol>
<li>
<p><strong>superå…³é”®å­—</strong>ï¼šç”¨äºè®¿é—®çˆ¶ç±»çš„å±æ€§ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•</p>
</li>
<li>
<p><strong>æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰</strong> ï¼šå­ç±»é‡æ–°å®ç°çˆ¶ç±»çš„æ–¹æ³•</p>
</li>
<li>
<p><strong>è®¿é—®ä¿®é¥°ç¬¦</strong>ï¼š</p>
<ul>
<li><strong>private</strong>ï¼šåªæœ‰æœ¬ç±»èƒ½è®¿é—®</li>
<li><strong>protected</strong>ï¼šæœ¬ç±»ã€å­ç±»å’ŒåŒåŒ…ç±»èƒ½è®¿é—®</li>
<li><strong>public</strong>ï¼šæ‰€æœ‰ç±»éƒ½èƒ½è®¿é—®</li>
</ul>
</li>
<li>
<p><strong>finalå…³é”®å­—</strong>ï¼š</p>
<ul>
<li><strong>finalç±»</strong>ï¼šä¸èƒ½è¢«ç»§æ‰¿</li>
<li><strong>finalæ–¹æ³•</strong>ï¼šä¸èƒ½è¢«å­ç±»é‡å†™</li>
<li><strong>finalå˜é‡</strong>ï¼šå¸¸é‡ï¼Œä¸èƒ½è¢«ä¿®æ”¹</li>
</ul>
</li>
</ol>
<h2 data-id="heading-9">ä¸‰ã€å¤šæ€ï¼šçµæ´»å¤šå˜çš„"å˜å½¢é‡‘åˆš"</h2>
<h3 data-id="heading-10">3.1 ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ</h3>
<p><strong>å¤šæ€</strong>ï¼ˆPolymorphismï¼‰æ„ä¸º"å¤šç§å½¢æ€"ã€‚åœ¨Javaä¸­ï¼Œå¤šæ€å…è®¸æˆ‘ä»¬ä½¿ç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼ŒåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ä¼šæ ¹æ®å®é™…å¯¹è±¡ç±»å‹äº§ç”Ÿä¸åŒçš„è¡Œä¸ºã€‚</p>
<h3 data-id="heading-11">3.2 å¤šæ€çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolymorphismDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¤šæ€ç¤ºä¾‹ï¼šå‡ ä½•å›¾å½¢è®¡ç®— ===\n"</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘ä¸åŒçš„å­ç±»å¯¹è±¡</span>
        Shape[] shapes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Shape</span>[<span class="hljs-number">4</span>];
        
        shapes[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5.0</span>);
        shapes[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">4.0</span>, <span class="hljs-number">6.0</span>);
        shapes[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>);
        shapes[<span class="hljs-number">3</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">7.0</span>);
        
        <span class="hljs-comment">// å¤šæ€çš„é­…åŠ›ï¼šåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¸åŒçš„è¡Œä¸º</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">totalArea</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">double</span> <span class="hljs-variable">totalPerimeter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">for</span> (Shape shape : shapes) {
            System.out.println(shape.getShapeName() + <span class="hljs-string">":"</span>);
            System.out.printf(<span class="hljs-string">"  é¢ç§¯: %.2f\n"</span>, shape.calculateArea());
            System.out.printf(<span class="hljs-string">"  å‘¨é•¿: %.2f\n"</span>, shape.calculatePerimeter());
            
            totalArea += shape.calculateArea();
            totalPerimeter += shape.calculatePerimeter();
            
            <span class="hljs-comment">// æ£€æŸ¥å…·ä½“ç±»å‹å¹¶è¿›è¡Œç‰¹æ®Šå¤„ç†</span>
            <span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> Circle) {
                <span class="hljs-type">Circle</span> <span class="hljs-variable">circle</span> <span class="hljs-operator">=</span> (Circle) shape;  <span class="hljs-comment">// å‘ä¸‹è½¬å‹</span>
                System.out.printf(<span class="hljs-string">"  åŠå¾„: %.2f\n"</span>, circle.getRadius());
            }
            
            System.out.println();
        }
        
        System.out.printf(<span class="hljs-string">"æ€»é¢ç§¯: %.2f\n"</span>, totalArea);
        System.out.printf(<span class="hljs-string">"æ€»å‘¨é•¿: %.2f\n"</span>, totalPerimeter);
        
        <span class="hljs-comment">// å¤šæ€åœ¨æ–¹æ³•å‚æ•°ä¸­çš„åº”ç”¨</span>
        System.out.println(<span class="hljs-string">"\n=== å¤šæ€åœ¨æ–¹æ³•å‚æ•°ä¸­çš„åº”ç”¨ ==="</span>);
        displayShapeInfo(shapes[<span class="hljs-number">0</span>]);
        displayShapeInfo(shapes[<span class="hljs-number">1</span>]);
    }
    
    <span class="hljs-comment">// æ–¹æ³•æ¥æ”¶çˆ¶ç±»ç±»å‹å‚æ•°ï¼Œå¯ä»¥æ¥å—ä»»ä½•å­ç±»å¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayShapeInfo</span><span class="hljs-params">(Shape shape)</span> {
        System.out.println(<span class="hljs-string">"å½¢çŠ¶ä¿¡æ¯ï¼š"</span>);
        shape.displayInfo();
        System.out.println();
    }
}

<span class="hljs-comment">// æŠ½è±¡ç±»ï¼šå½¢çŠ¶ï¼ˆä¸èƒ½å®ä¾‹åŒ–ï¼‰</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">protected</span> String color;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.color = <span class="hljs-string">"é»‘è‰²"</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">(String color)</span> {
        <span class="hljs-built_in">this</span>.color = color;
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šå­ç±»å¿…é¡»å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// å…·ä½“æ–¹æ³•ï¼šå­ç±»å¯ä»¥ç»§æ‰¿æˆ–é‡å†™</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å½¢çŠ¶: "</span> + getShapeName());
        System.out.println(<span class="hljs-string">"é¢œè‰²: "</span> + color);
        System.out.printf(<span class="hljs-string">"é¢ç§¯: %.2f\n"</span>, calculateArea());
        System.out.printf(<span class="hljs-string">"å‘¨é•¿: %.2f\n"</span>, calculatePerimeter());
    }
    
    <span class="hljs-comment">// Getterå’ŒSetter</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getColor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> color;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setColor</span><span class="hljs-params">(String color)</span> {
        <span class="hljs-built_in">this</span>.color = color;
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šåœ†å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> radius;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> {
        <span class="hljs-built_in">super</span>();
        <span class="hljs-built_in">this</span>.radius = radius;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius, String color)</span> {
        <span class="hljs-built_in">super</span>(color);
        <span class="hljs-built_in">this</span>.radius = radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Math.PI * radius * radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * Math.PI * radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"åœ†å½¢"</span>;
    }
    
    <span class="hljs-comment">// Circleç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getRadius</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> radius;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRadius</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> {
        <span class="hljs-keyword">if</span> (radius &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">this</span>.radius = radius;
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"åŠå¾„: %.2f\n"</span>, radius);
        System.out.printf(<span class="hljs-string">"ç›´å¾„: %.2f\n"</span>, <span class="hljs-number">2</span> * radius);
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šçŸ©å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> width;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> height;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">double</span> width, <span class="hljs-type">double</span> height)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"è“è‰²"</span>);
        <span class="hljs-built_in">this</span>.width = width;
        <span class="hljs-built_in">this</span>.height = height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> width * height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * (width + height);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"çŸ©å½¢"</span>;
    }
    
    <span class="hljs-comment">// Rectangleç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getWidth</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> width;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getHeight</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"å®½åº¦: %.2f\n"</span>, width);
        System.out.printf(<span class="hljs-string">"é«˜åº¦: %.2f\n"</span>, height);
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šä¸‰è§’å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideA;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideB;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideC;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Triangle</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b, <span class="hljs-type">double</span> c)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"ç»¿è‰²"</span>);
        <span class="hljs-built_in">this</span>.sideA = a;
        <span class="hljs-built_in">this</span>.sideB = b;
        <span class="hljs-built_in">this</span>.sideC = c;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä½¿ç”¨æµ·ä¼¦å…¬å¼è®¡ç®—ä¸‰è§’å½¢é¢ç§¯</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> (sideA + sideB + sideC) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">return</span> Math.sqrt(s * (s - sideA) * (s - sideB) * (s - sideC));
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sideA + sideB + sideC;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ä¸‰è§’å½¢"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"è¾¹é•¿: %.2f, %.2f, %.2f\n"</span>, sideA, sideB, sideC);
    }
}
</code></pre>
<h3 data-id="heading-12">3.3 å¤šæ€çš„ä¸¤ç§å½¢å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolymorphismForms</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¤šæ€çš„ä¸¤ç§å½¢å¼ ===\n"</span>);
        
        <span class="hljs-comment">// å½¢å¼1ï¼šç¼–è¯‘æ—¶å¤šæ€ï¼ˆæ–¹æ³•é‡è½½ï¼‰</span>
        <span class="hljs-type">Calculator</span> <span class="hljs-variable">calc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>();
        System.out.println(<span class="hljs-string">"åŠ æ³•é‡è½½ç¤ºä¾‹ï¼š"</span>);
        System.out.println(<span class="hljs-string">"ä¸¤ä¸ªæ•´æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>));
        System.out.println(<span class="hljs-string">"ä¸‰ä¸ªæ•´æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>));
        System.out.println(<span class="hljs-string">"ä¸¤ä¸ªå°æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5.5</span>, <span class="hljs-number">3.3</span>));
        System.out.println(<span class="hljs-string">"æ•´æ•°å’Œå°æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3.3</span>));
        
        <span class="hljs-comment">// å½¢å¼2ï¼šè¿è¡Œæ—¶å¤šæ€ï¼ˆæ–¹æ³•é‡å†™ï¼‰</span>
        System.out.println(<span class="hljs-string">"\nåŠ¨ç‰©å«å£°ç¤ºä¾‹ï¼š"</span>);
        Animal myAnimal;
        
        <span class="hljs-comment">// è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•</span>
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šæ±ªæ±ªæ±ªï¼</span>
        
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šå–µå–µå–µï¼</span>
        
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šå½å½å–³å–³ï¼</span>
        
        <span class="hljs-comment">// å®é™…åº”ç”¨ï¼šå·¥å‚æ¨¡å¼</span>
        System.out.println(<span class="hljs-string">"\n=== å·¥å‚æ¨¡å¼ç¤ºä¾‹ ==="</span>);
        <span class="hljs-type">AnimalFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnimalFactory</span>();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal1</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"dog"</span>);
        animal1.makeSound();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal2</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"cat"</span>);
        animal2.makeSound();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal3</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"bird"</span>);
        animal3.makeSound();
    }
}

<span class="hljs-comment">// ç¼–è¯‘æ—¶å¤šæ€ï¼šæ–¹æ³•é‡è½½</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Calculator</span> {
    <span class="hljs-comment">// åŒä¸€ä¸ªæ–¹æ³•åï¼Œä¸åŒçš„å‚æ•°åˆ—è¡¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span> {
        <span class="hljs-keyword">return</span> a + b + c;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">double</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
}

<span class="hljs-comment">// è¿è¡Œæ—¶å¤šæ€ï¼šæ–¹æ³•é‡å†™</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"åŠ¨ç‰©æ­£åœ¨ç¡è§‰..."</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±ªæ±ªæ±ªï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fetch</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç‹—ç‹—å¼å›äº†é£ç›˜"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å–µå–µå–µï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scratch</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çŒ«åœ¨æŠ“æ²™å‘"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å½å½å–³å–³ï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸Ÿåœ¨é£ç¿”"</span>);
    }
}

<span class="hljs-comment">// å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å¤šæ€åˆ›å»ºå¯¹è±¡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimalFactory</span> {
    <span class="hljs-keyword">public</span> Animal <span class="hljs-title function_">createAnimal</span><span class="hljs-params">(String type)</span> {
        <span class="hljs-keyword">switch</span> (type.toLowerCase()) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"dog"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"cat"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"bird"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æœªçŸ¥çš„åŠ¨ç‰©ç±»å‹: "</span> + type);
        }
    }
}
</code></pre>
<h3 data-id="heading-13">3.4 å¤šæ€çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>ä»£ç çµæ´»æ€§</strong>ï¼šå¯ä»¥ç¼–å†™æ›´é€šç”¨çš„ä»£ç </li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ·»åŠ æ–°çš„å­ç±»æ—¶ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç </li>
<li><strong>æ¥å£ç»Ÿä¸€</strong>ï¼šä¸åŒå¯¹è±¡å¯ä»¥é€šè¿‡ç»Ÿä¸€æ¥å£æ“ä½œ</li>
<li><strong>è§£è€¦åˆ</strong>ï¼šé™ä½æ¨¡å—é—´çš„ä¾èµ–å…³ç³»</li>
</ol>
<h2 data-id="heading-14">å››ã€ä¸‰å¤§ç‰¹æ€§ç»¼åˆå®æˆ˜ï¼šå‘˜å·¥ç®¡ç†ç³»ç»Ÿ</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.ArrayList;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeManagementSystem</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å‘˜å·¥ç®¡ç†ç³»ç»Ÿ ===\n"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºå…¬å¸</span>
        <span class="hljs-type">Company</span> <span class="hljs-variable">company</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Company</span>(<span class="hljs-string">"ç§‘æŠ€æ— é™å…¬å¸"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºä¸åŒç±»å‹çš„å‘˜å·¥</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Manager</span>(<span class="hljs-string">"å¼ ç»ç†"</span>, <span class="hljs-number">50000</span>, <span class="hljs-number">20000</span>, <span class="hljs-number">10</span>);
        <span class="hljs-type">Employee</span> <span class="hljs-variable">developer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Developer</span>(<span class="hljs-string">"ç‹ç¨‹åºå‘˜"</span>, <span class="hljs-number">30000</span>, <span class="hljs-string">"Java"</span>, <span class="hljs-number">5</span>);
        <span class="hljs-type">Employee</span> <span class="hljs-variable">sales</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Salesperson</span>(<span class="hljs-string">"æé”€å”®"</span>, <span class="hljs-number">25000</span>, <span class="hljs-number">1000000</span>);
        
        <span class="hljs-comment">// æ·»åŠ å‘˜å·¥åˆ°å…¬å¸</span>
        company.hireEmployee(manager);
        company.hireEmployee(developer);
        company.hireEmployee(sales);
        
        <span class="hljs-comment">// ä¸´æ—¶å·¥</span>
        company.hireEmployee(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intern</span>(<span class="hljs-string">"èµµå®ä¹ ç”Ÿ"</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">6</span>));
        
        <span class="hljs-comment">// å±•ç¤ºæ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span>
        company.displayAllEmployees();
        
        <span class="hljs-comment">// è®¡ç®—æ€»å·¥èµ„æ”¯å‡º</span>
        System.out.println(<span class="hljs-string">"\n=== æœˆåº¦å·¥èµ„æŠ¥å‘Š ==="</span>);
        company.calculateMonthlyPayroll();
        
        <span class="hljs-comment">// å‘˜å·¥å·¥ä½œ</span>
        System.out.println(<span class="hljs-string">"\n=== å‘˜å·¥å·¥ä½œ ==="</span>);
        company.makeEmployeesWork();
        
        <span class="hljs-comment">// æ™‹å‡å‘˜å·¥</span>
        System.out.println(<span class="hljs-string">"\n=== å‘˜å·¥æ™‹å‡ ==="</span>);
        company.promoteEmployee(<span class="hljs-string">"ç‹ç¨‹åºå‘˜"</span>, <span class="hljs-string">"Senior Developer"</span>);
        
        <span class="hljs-comment">// å±•ç¤ºæ™‹å‡åä¿¡æ¯</span>
        company.displayAllEmployees();
    }
}

<span class="hljs-comment">// æŠ½è±¡å‘˜å·¥ç±»</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">protected</span> String name;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">double</span> baseSalary;
    <span class="hljs-keyword">protected</span> String employeeId;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">nextId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;  <span class="hljs-comment">// é™æ€å˜é‡ï¼Œç”¨äºç”ŸæˆID</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.baseSalary = baseSalary;
        <span class="hljs-built_in">this</span>.employeeId = <span class="hljs-string">"EMP"</span> + nextId++;
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šè®¡ç®—å·¥èµ„ï¼ˆä¸åŒå‘˜å·¥è®¡ç®—æ–¹å¼ä¸åŒï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šå·¥ä½œï¼ˆä¸åŒå‘˜å·¥å·¥ä½œå†…å®¹ä¸åŒï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// å…·ä½“æ–¹æ³•ï¼šæ‰€æœ‰å‘˜å·¥å…±äº«</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendMeeting</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ ä¼šè®®"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">takeBreak</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨ä¼‘æ¯"</span>);
    }
    
    <span class="hljs-comment">// æ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ID: "</span> + employeeId);
        System.out.println(<span class="hljs-string">"å§“å: "</span> + name);
        System.out.println(<span class="hljs-string">"èŒä½: "</span> + getPosition());
        System.out.printf(<span class="hljs-string">"åŸºæœ¬å·¥èµ„: Â¥%.2f\n"</span>, baseSalary);
        System.out.printf(<span class="hljs-string">"å®å‘å·¥èµ„: Â¥%.2f\n"</span>, calculateSalary());
    }
    
    <span class="hljs-comment">// è·å–èŒä½åç§°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// Getteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getEmployeeId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> employeeId;
    }
    
    <span class="hljs-comment">// Setteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; !name.trim().isEmpty()) {
            <span class="hljs-built_in">this</span>.name = name;
        }
    }
}

<span class="hljs-comment">// ç»ç†ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Manager</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> bonus;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> teamSize;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Manager</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">double</span> bonus, <span class="hljs-type">int</span> teamSize)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.bonus = bonus;
        <span class="hljs-built_in">this</span>.teamSize = teamSize;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç»ç†å·¥èµ„ = åŸºæœ¬å·¥èµ„ + å¥–é‡‘</span>
        <span class="hljs-keyword">return</span> baseSalary + bonus;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" ç»ç†æ­£åœ¨åˆ¶å®šé¡¹ç›®è®¡åˆ’å’Œåˆ†é…ä»»åŠ¡"</span>);
        System.out.println(<span class="hljs-string">"ç®¡ç†å›¢é˜Ÿå¤§å°: "</span> + teamSize + <span class="hljs-string">"äºº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ç»ç†"</span>;
    }
    
    <span class="hljs-comment">// ç»ç†ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">conductReview</span><span class="hljs-params">(Employee employee)</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å¯¹å‘˜å·¥ "</span> + employee.getName() + <span class="hljs-string">" è¿›è¡Œç»©æ•ˆè¯„ä¼°"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBonus</span><span class="hljs-params">(<span class="hljs-type">double</span> bonus)</span> {
        <span class="hljs-keyword">if</span> (bonus &gt;= <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">this</span>.bonus = bonus;
        }
    }
}

<span class="hljs-comment">// å¼€å‘äººå‘˜ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Developer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> String programmingLanguage;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> yearsOfExperience;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Developer</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, String language, <span class="hljs-type">int</span> experience)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.programmingLanguage = language;
        <span class="hljs-built_in">this</span>.yearsOfExperience = experience;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¼€å‘äººå‘˜å·¥èµ„ = åŸºæœ¬å·¥èµ„ + ç»éªŒæ´¥è´´ï¼ˆæ¯å¹´ç»éªŒ+5%ï¼‰</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">experienceBonus</span> <span class="hljs-operator">=</span> baseSalary * <span class="hljs-number">0.05</span> * yearsOfExperience;
        <span class="hljs-keyword">return</span> baseSalary + experienceBonus;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" å¼€å‘äººå‘˜æ­£åœ¨ç”¨ "</span> + programmingLanguage + <span class="hljs-string">" ç¼–å†™ä»£ç "</span>);
        System.out.println(<span class="hljs-string">"ç»éªŒ: "</span> + yearsOfExperience + <span class="hljs-string">"å¹´"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼€å‘äººå‘˜ ("</span> + programmingLanguage + <span class="hljs-string">")"</span>;
    }
    
    <span class="hljs-comment">// å¼€å‘äººå‘˜ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debugCode</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨è°ƒè¯•ä»£ç "</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendTechMeeting</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ æŠ€æœ¯ä¼šè®®"</span>);
    }
}

<span class="hljs-comment">// é”€å”®äººå‘˜ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Salesperson</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salesAmount;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Salesperson</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">double</span> salesAmount)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.salesAmount = salesAmount;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// é”€å”®äººå‘˜å·¥èµ„ = åŸºæœ¬å·¥èµ„ + é”€å”®ææˆï¼ˆé”€å”®é¢çš„10%ï¼‰</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">commission</span> <span class="hljs-operator">=</span> salesAmount * <span class="hljs-number">0.10</span>;
        <span class="hljs-keyword">return</span> baseSalary + commission;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" é”€å”®äººå‘˜æ­£åœ¨è”ç³»å®¢æˆ·ï¼Œå®Œæˆé”€å”®ç›®æ ‡"</span>);
        System.out.printf(<span class="hljs-string">"æœ¬æœˆé”€å”®é¢: Â¥%.2f\n"</span>, salesAmount);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"é”€å”®äººå‘˜"</span>;
    }
    
    <span class="hljs-comment">// é”€å”®äººå‘˜ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSale</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        salesAmount += amount;
        System.out.println(name + <span class="hljs-string">" å®Œæˆä¸€ç¬”é”€å”®: Â¥"</span> + amount);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendSalesTraining</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ é”€å”®åŸ¹è®­"</span>);
    }
}

<span class="hljs-comment">// å®ä¹ ç”Ÿç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Intern</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> internshipDuration;  <span class="hljs-comment">// å®ä¹ æ—¶é•¿ï¼ˆæœˆï¼‰</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Intern</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">int</span> duration)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.internshipDuration = duration;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®ä¹ ç”Ÿåªæœ‰åŸºæœ¬å·¥èµ„ï¼Œæ²¡æœ‰å¥–é‡‘</span>
        <span class="hljs-keyword">return</span> baseSalary;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" å®ä¹ ç”Ÿæ­£åœ¨å­¦ä¹ å¹¶ååŠ©å®Œæˆç®€å•ä»»åŠ¡"</span>);
        System.out.println(<span class="hljs-string">"å®ä¹ æ—¶é•¿: "</span> + internshipDuration + <span class="hljs-string">"ä¸ªæœˆ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å®ä¹ ç”Ÿ"</span>;
    }
    
    <span class="hljs-comment">// å®ä¹ ç”Ÿç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">learn</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å­¦ä¹ æ–°æŠ€èƒ½"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestMentor</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" è¯·æ±‚å¯¼å¸ˆæŒ‡å¯¼"</span>);
    }
}

<span class="hljs-comment">// å…¬å¸ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Company</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> ArrayList&lt;Employee&gt; employees;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Company</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.employees = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    }
    
    <span class="hljs-comment">// é›‡ä½£å‘˜å·¥ï¼ˆå¤šæ€ï¼šå¯ä»¥æ¥æ”¶ä»»ä½•Employeeå­ç±»ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hireEmployee</span><span class="hljs-params">(Employee employee)</span> {
        employees.add(employee);
        System.out.println(<span class="hljs-string">"å·²é›‡ä½£: "</span> + employee.getName() + <span class="hljs-string">" ("</span> + employee.getPosition() + <span class="hljs-string">")"</span>);
    }
    
    <span class="hljs-comment">// å±•ç¤ºæ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayAllEmployees</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"=== "</span> + name + <span class="hljs-string">" å‘˜å·¥åˆ—è¡¨ ==="</span>);
        System.out.println(<span class="hljs-string">"="</span>.repeat(<span class="hljs-number">50</span>));
        
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            emp.displayInfo();
            System.out.println(<span class="hljs-string">"-"</span>.repeat(<span class="hljs-number">50</span>));
        }
    }
    
    <span class="hljs-comment">// è®¡ç®—æœˆåº¦å·¥èµ„æ”¯å‡º</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">calculateMonthlyPayroll</span><span class="hljs-params">()</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            total += emp.calculateSalary();
        }
        
        System.out.printf(<span class="hljs-string">"å‘˜å·¥æ€»æ•°: %däºº\n"</span>, employees.size());
        System.out.printf(<span class="hljs-string">"æœˆåº¦å·¥èµ„æ€»æ”¯å‡º: Â¥%.2f\n"</span>, total);
        
        <span class="hljs-comment">// æŒ‰èŒä½ç»Ÿè®¡</span>
        System.out.println(<span class="hljs-string">"\næŒ‰èŒä½ç»Ÿè®¡:"</span>);
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            System.out.printf(<span class="hljs-string">"%-20s: Â¥%.2f\n"</span>, 
                emp.getPosition(), emp.calculateSalary());
        }
    }
    
    <span class="hljs-comment">// è®©æ‰€æœ‰å‘˜å·¥å·¥ä½œï¼ˆå¤šæ€ï¼šè°ƒç”¨å„è‡ªçš„å·¥ä½œæ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeEmployeesWork</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            System.out.print(<span class="hljs-string">"&gt; "</span>);
            emp.work();
        }
    }
    
    <span class="hljs-comment">// æ™‹å‡å‘˜å·¥</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">promoteEmployee</span><span class="hljs-params">(String employeeName, String newPosition)</span> {
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            <span class="hljs-keyword">if</span> (emp.getName().equals(employeeName)) {
                System.out.println(emp.getName() + <span class="hljs-string">" æ™‹å‡ä¸º: "</span> + newPosition);
                
                <span class="hljs-comment">// æ ¹æ®æ™‹å‡è°ƒæ•´å·¥èµ„</span>
                <span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">instanceof</span> Developer) {
                    <span class="hljs-type">Developer</span> <span class="hljs-variable">dev</span> <span class="hljs-operator">=</span> (Developer) emp;
                    System.out.println(<span class="hljs-string">"å·¥èµ„å¢åŠ 20%"</span>);
                    <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­ä¼šæœ‰æ›´å¤æ‚çš„é€»è¾‘</span>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">instanceof</span> Manager) {
                    <span class="hljs-type">Manager</span> <span class="hljs-variable">mgr</span> <span class="hljs-operator">=</span> (Manager) emp;
                    System.out.println(<span class="hljs-string">"å¥–é‡‘å¢åŠ 30%"</span>);
                }
                <span class="hljs-keyword">return</span>;
            }
        }
        System.out.println(<span class="hljs-string">"æœªæ‰¾åˆ°å‘˜å·¥: "</span> + employeeName);
    }
}
</code></pre>
<h2 data-id="heading-15">äº”ã€æ€»ç»“ï¼šä¸‰å¤§ç‰¹æ€§çš„æ ¸å¿ƒè¦ç‚¹</h2>
<h3 data-id="heading-16">ğŸ¯ æ ¸å¿ƒè¦ç‚¹æ€»ç»“ï¼š</h3>
<ol>
<li>
<p><strong>å°è£…ï¼ˆEncapsulationï¼‰</strong> ï¼šæŠŠæ•°æ®å’Œè¡Œä¸ºåŒ…è£…åœ¨ç±»ä¸­ï¼Œéšè—å®ç°ç»†èŠ‚</p>
<ul>
<li>ä½¿ç”¨<code>private</code>ä¿æŠ¤æ•°æ®</li>
<li>é€šè¿‡<code>public</code>æ–¹æ³•æä¾›è®¿é—®æ¥å£</li>
<li>å¥½å¤„ï¼šå®‰å…¨æ€§ã€æ˜“ç»´æŠ¤ã€ä½è€¦åˆ</li>
</ul>
</li>
<li>
<p><strong>ç»§æ‰¿ï¼ˆInheritanceï¼‰</strong> ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</p>
<ul>
<li>ä½¿ç”¨<code>extends</code>å…³é”®å­—</li>
<li><code>super</code>è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</li>
<li>æ–¹æ³•é‡å†™ï¼ˆ<code>@Override</code>ï¼‰</li>
<li>å¥½å¤„ï¼šä»£ç å¤ç”¨ã€å»ºç«‹å±‚æ¬¡å…³ç³»</li>
</ul>
</li>
<li>
<p><strong>å¤šæ€ï¼ˆPolymorphismï¼‰</strong> ï¼šåŒä¸€æ¥å£ï¼Œä¸åŒå®ç°</p>
<ul>
<li>ç¼–è¯‘æ—¶å¤šæ€ï¼šæ–¹æ³•é‡è½½</li>
<li>è¿è¡Œæ—¶å¤šæ€ï¼šæ–¹æ³•é‡å†™</li>
<li>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</li>
<li>å¥½å¤„ï¼šçµæ´»æ€§ã€æ‰©å±•æ€§ã€è§£è€¦åˆ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-17">ğŸ’¡ å®æˆ˜å»ºè®®ï¼š</h3>
<ol>
<li><strong>åˆç†è®¾è®¡ç±»å±‚æ¬¡</strong>ï¼šä¸è¦è®©ç»§æ‰¿å±‚æ¬¡å¤ªæ·±ï¼ˆé€šå¸¸ä¸è¶…è¿‡3å±‚ï¼‰</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿</strong>ï¼šé™¤éæœ‰æ˜æ˜¾çš„"is-a"å…³ç³»</li>
<li><strong>ä¸ºæ‰©å±•è€Œè®¾è®¡</strong>ï¼šä½¿ç”¨æŠ½è±¡ç±»å’Œæ¥å£å®šä¹‰å¥‘çº¦</li>
<li><strong>éµå®ˆé‡Œæ°æ›¿æ¢åŸåˆ™</strong>ï¼šå­ç±»åº”è¯¥èƒ½å¤Ÿæ›¿æ¢çˆ¶ç±»è€Œä¸å½±å“ç¨‹åºåŠŸèƒ½</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨]]></title>    <link>https://juejin.cn/post/7585502118460473363</link>    <guid>https://juejin.cn/post/7585502118460473363</guid>    <pubDate>2025-12-21T08:10:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585502118460473363" data-draft-id="7585468725333557302" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨"/> <meta itemprop="keywords" content="Python,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-21T08:10:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èµ·é£äº†___"/> <meta itemprop="url" content="https://juejin.cn/user/3298190615395896"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3298190615395896/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èµ·é£äº†___
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:10:29.000Z" title="Sun Dec 21 2025 08:10:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ–‡ç« ç®€ä»‹</h2>
<p>é—²æ¥æ— äº‹ï¼Œå¸®æœ‹å‹å†™ä¸ªé‚®ä»¶å‘é€è„šæœ¬ï¼Œé¡ºä¾¿æ‹¿æ¥å†™ç¯‡æŠ€æœ¯æ–‡ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚è„šæœ¬ä»æŒ‡å®šçš„ excel æ–‡ä»¶è¯»å–å®¢æˆ·å§“åã€é‚®ç®±ç­‰ä¿¡æ¯ï¼Œä½¿ç”¨æŒ‡å®šçš„é‚®ä»¶æ¨¡ç‰ˆæ‰¹é‡å‘é€é‚®ä»¶ã€‚ç”±äºæœ‹å‹ä½¿ç”¨æ–‡æœ¬æ¨¡ç‰ˆå°±èƒ½è¾¾æˆè¦æ±‚ï¼Œæ‰€ä»¥è„šæœ¬è™½ç„¶æ”¯æŒ Html é‚®ä»¶æ¨¡ç‰ˆï¼Œä½†å¹¶æœªæµ‹è¯•ã€‚æœ‰è‡ªå®šä¹‰æ ·å¼çš„æœ‹å‹è¿˜éœ€è‡ªè¡Œè°ƒè¯•ä»£ç ã€‚
å¤‡æ³¨ï¼šæœ¬äººæµ‹è¯•æ˜¯ä½¿ç”¨ 163 é‚®ç®±</p>
<h2 data-id="heading-1">ä¾èµ–</h2>
<ul>
<li>yagmail==0.15.293
<ul>
<li>ç”¨æ¥å‘é€é‚®ä»¶</li>
</ul>
</li>
<li>pandas==2.3.1
<ul>
<li>ç”¨æ¥è¯»å– Excel æ–‡ä»¶</li>
</ul>
</li>
<li>jinja2==3.1.6
<ul>
<li>ç”¨æ¥ç¼–å†™ Html æ¨¡ç‰ˆ</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">é…ç½®ä¿¡æ¯</h2>
<ul>
<li>é‚®ç®±é…ç½®
<ul>
<li>passwordï¼šéƒ¨åˆ†é‚®ç®±ï¼ˆå¦‚163ã€QQï¼‰éœ€è¦ä½¿ç”¨æˆæƒç è€Œä¸æ˜¯ç™»å½•å¯†ç ï¼Œè¯·å¤§å®¶æŒ‰éœ€ä»é‚®ç®±è®¾ç½®ä¸­å¼€å¯SMTPæœåŠ¡å¹¶è·å–æˆæƒç ã€‚</li>
<li>hostï¼šå¯¹ä¸åŒçš„é‚®ç®±è¯·ä½¿ç”¨ä¸åŒçš„é‚®ç®±æœåŠ¡å™¨ï¼Œè®°å¾—é€‰æ‹© SMTP é‚®ç®±æœåŠ¡å™¨</li>
<li>portï¼šç«¯å£å·å¯ä½¿ç”¨ 465 ç«¯å£ï¼ˆSSLåŠ å¯†ï¼‰å’Œ 587 ç«¯å£ï¼ˆSTARTTLSï¼‰ï¼Œé¿å…ä½¿ç”¨ 25 ç«¯å£ï¼ˆæ— åŠ å¯†ï¼Œä¸å®‰å…¨ï¼‰</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailConfig</span>:
    <span class="hljs-string">"""
    é‚®ç®±é…ç½®
    """</span>
    <span class="hljs-comment"># ä½ çš„é‚®ç®±</span>
    user: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># é‚®ç®±æˆæƒç </span>
    password: <span class="hljs-built_in">str</span> = <span class="hljs-string">'TXYuclse932VzHJ'</span>
    <span class="hljs-comment"># é‚®ç®±æœåŠ¡å™¨</span>
    host: <span class="hljs-built_in">str</span> = <span class="hljs-string">'smtp.163.com'</span>
    <span class="hljs-comment"># ç«¯å£</span>
    port: <span class="hljs-built_in">int</span> = <span class="hljs-string">'587'</span>
</code></pre>
<ul>
<li>å‘ä»¶äººä¿¡æ¯
<ul>
<li>å‘ä»¶äººä¿¡æ¯æ˜¯ç”¨åœ¨é‚®ä»¶æ¨¡ç‰ˆä¸­çš„ï¼Œå¯æŒ‰éœ€æ·»åŠ ã€åˆ é™¤</li>
<li>get_subjectï¼šåœ¨è¿™é‡Œé…ç½®é€šç”¨çš„é‚®ä»¶ä¸»é¢˜ï¼Œclient æ˜¯ä» excel æ–‡ä»¶ä¸­è¯»å–å‡ºçš„å®¢æˆ·ä¿¡æ¯ï¼Œä½¿ç”¨è¯¥ä¿¡æ¯è¯·å’Œ excel æ–‡ä»¶ä¸­çš„æ ‡é¢˜ä¸€è‡´</li>
<li>to_jsonï¼šè¿”å›çš„æ•°æ®æ˜¯ç”¨åœ¨ Html æ¨¡ç‰ˆä¸­çš„æ•°æ®ï¼Œå¯æŒ‰éœ€æ·»åŠ ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderInfo</span>:
    <span class="hljs-string">"""
    å‘ä»¶äººä¿¡æ¯
    """</span>
    <span class="hljs-comment"># æ˜¾ç¤ºç»™å®¢æˆ·çš„å‘ä»¶äººåç§°</span>
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">'èµ·é£äº†-dev'</span>
    <span class="hljs-comment"># èŒä½</span>
    position: <span class="hljs-built_in">str</span> = <span class="hljs-string">'å¼€å‘äººå‘˜'</span>
    <span class="hljs-comment"># å…¬å¸</span>
    company: <span class="hljs-built_in">str</span> = <span class="hljs-string">'xxxç§‘æŠ€æœ‰é™è´£ä»»å…¬å¸'</span>
    <span class="hljs-comment"># é‚®ç®±</span>
    email: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># ç­¾å</span>
    signature: <span class="hljs-built_in">str</span> = <span class="hljs-string">'ç­¾åæµ‹è¯•'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_subject</span>(<span class="hljs-params">self, client: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-string">"""
        è·å–é‚®ä»¶ä¸»é¢˜
        :param client: å®¢æˆ·ä¿¡æ¯, ä¸å®¢æˆ·ä¿¡æ¯æ–‡ä»¶å†…ä¸€è‡´
        :return: é‚®ä»¶ä¸»é¢˜
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>è‡´<span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>çš„é‚®ä»¶"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_json</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'name'</span>: self.name,
            <span class="hljs-string">'position'</span>: self.position,
            <span class="hljs-string">'company'</span>: self.company,
            <span class="hljs-string">'email'</span>: self.email,
            <span class="hljs-string">'signature'</span>: self.signature
        }
</code></pre>
<ul>
<li>å‘é€è®¾ç½®
<ul>
<li>å‘é€é…ç½®å¯ä»¥è°ƒæ•´é‚®ä»¶çš„å‘é€é€Ÿåº¦ï¼Œé¿å…è¢«é‚®ä»¶æœåŠ¡å™¨é™åˆ¶ï¼Œå°†é‚®ä»¶å½“ä½œåƒåœ¾é‚®ä»¶</li>
<li>delay_between_emailsï¼šæ¯å°é‚®ä»¶ä¹‹é—´çš„é—´éš”æ—¶é—´</li>
<li>test_modeï¼šåœ¨æ¨¡ç‰ˆæµ‹è¯•æ—¶å¯ä»¥å…ˆå°†é‚®ä»¶å‘é€ç»™è‡ªå·±ï¼Œæ£€æŸ¥å®Œæ¯•åå†ç»™å®¢æˆ·å‘é€</li>
<li>max_emails_per_batchï¼šå‘é€é‚®ä»¶æ¯æ¬¡è¾¾åˆ°è¯¥æ•°ç›®æ—¶æš‚åœ 1 åˆ†é’Ÿï¼Œæœ‰å…¶ä»–éœ€æ±‚çš„æœ‹å‹å¯ä»¥è‡ªè¡Œä¿®æ”¹ä»£ç </li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendSettings</span>:
    <span class="hljs-string">"""
    å‘é€è®¾ç½®
    """</span>
    <span class="hljs-comment"># é‚®ä»¶é—´éš”(ç§’)ï¼Œé¿å…è¢«é™åˆ¶</span>
    delay_between_emails: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>
    <span class="hljs-comment"># æµ‹è¯•æ¨¡å¼ï¼ˆåªå‘ç»™è‡ªå·±ï¼‰</span>
    test_mode: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    <span class="hljs-comment"># æ¯æ‰¹æœ€å¤šå‘é€é‡</span>
    max_emails_per_batch: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span>
</code></pre>
<h2 data-id="heading-3">åŠ è½½å®¢æˆ·æ•°æ®</h2>
<ul>
<li>excel æ–‡ä»¶æ ¼å¼















<table><thead><tr><th align="center">index</th><th align="center">name</th><th align="center">email</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">èµ·é£äº†</td><td align="center"><a href="https://link.juejin.cn?target=mailto%3Axxxx%40qq.com" target="_blank" title="mailto:xxxx@qq.com" ref="nofollow noopener noreferrer">xxxx@qq.com</a></td></tr></tbody></table>
</li>
<li>åŠ è½½å®¢æˆ·æ•°æ®æ—¶ä¼šæ£€éªŒå®¢æˆ·å§“åå’Œé‚®ç®±æ˜¯å¦å­˜åœ¨</li>
<li>è¿”å›æ•°æ®ç»“æ„: [{index: 1,name:'èµ·é£äº†', email: '<a href="https://link.juejin.cn?target=mailto%3Axxxx%40qq.com" target="_blank" title="mailto:xxxx@qq.com" ref="nofollow noopener noreferrer">xxxx@qq.com</a>'},{index: 2, name:'', email: ''}]</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_clients</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">dict</span>]:
        <span class="hljs-string">"""åŠ è½½å®¢æˆ·æ•°æ®"""</span>
        df = pd.read_excel(self.client_data_file)
        client_list = df.to_dict(orient=<span class="hljs-string">'records'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client_list:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"å®¢æˆ·æ•°æ®ä¸ºç©º"</span>)
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ ¡éªŒå¹¶æ¸…æ´—</span>
        <span class="hljs-keyword">for</span> client <span class="hljs-keyword">in</span> client_list:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'email'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„é‚®ç®±ä¸ºç©º"</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'name'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„å§“åä¸ºç©º"</span>)
            client[<span class="hljs-string">'name'</span>] = client[<span class="hljs-string">'name'</span>].strip()
            client[<span class="hljs-string">'email'</span>] = client[<span class="hljs-string">'email'</span>].strip()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(client_list)}</span> ä¸ªå®¢æˆ·æ•°æ®"</span>)
        <span class="hljs-keyword">return</span> client_list
</code></pre>
<h2 data-id="heading-4">åŠ è½½æ¨¡ç‰ˆæ•°æ®</h2>
<p>æ¨¡ç‰ˆä»æ–‡ä»¶å†…åŠ è½½</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_template</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åŠ è½½é‚®ä»¶æ¨¡æ¿"""</span>
        template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                template = Template(f.read())
        txt_template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.txt_template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.txt_template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                txt_template = f.read()
        <span class="hljs-keyword">return</span> template, txt_template
</code></pre>
<h2 data-id="heading-5">è½¬æ¢ HTML åˆ°çº¯æ–‡æœ¬</h2>
<p>å¦‚æœåªæŒ‡å®šäº† HTML æ¨¡ç‰ˆï¼Œä¼šä½¿ç”¨è¿™ä¸ªå‡½æ•°è½¬æ¢ä¸€ä»½çº¯æ–‡æœ¬é‚®ä»¶å‡ºæ¥ï¼ŒHTML æ¨¡ç‰ˆæœ¬äººå¹¶æœªæµ‹è¯•ï¼Œæœ‰ç›¸åº”éœ€æ±‚çš„æœ‹å‹å¯è‡ªè¡Œè°ƒè¯•ä»£ç </p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_convert_html_to_text</span>(<span class="hljs-params">self, html</span>):
        <span class="hljs-string">"""
        æ™ºèƒ½è½¬æ¢HTMLåˆ°çº¯æ–‡æœ¬
        ä¿ç•™é‡è¦æ ¼å¼ï¼ˆåˆ—è¡¨ã€æ®µè½ã€å¼ºè°ƒç­‰ï¼‰
        """</span>
        <span class="hljs-comment"># è‡ªå®šä¹‰è½¬æ¢è§„åˆ™</span>
        replacements = [
            (<span class="hljs-string">r'&lt;br\s*/?&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;p.*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/p&gt;'</span>, <span class="hljs-string">''</span>),
            (<span class="hljs-string">r'&lt;li.*?&gt;'</span>, <span class="hljs-string">'â€¢ '</span>),
            (<span class="hljs-string">r'&lt;/li&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;strong.*?&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;/strong&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;em.*?&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;/em&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;h[1-6].*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/h[1-6]&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;[^&gt;]+&gt;'</span>, <span class="hljs-string">''</span>),  <span class="hljs-comment"># ç§»é™¤å…¶ä»–æ‰€æœ‰HTMLæ ‡ç­¾</span>
        ]

        text = html
        <span class="hljs-keyword">for</span> pattern, replacement <span class="hljs-keyword">in</span> replacements:
            text = re.sub(pattern, replacement, text)

        <span class="hljs-comment"># æ¸…ç†å¤šä½™çš„ç©ºè¡Œ</span>
        text = re.sub(<span class="hljs-string">r'\n\s*\n\s*\n'</span>, <span class="hljs-string">'\n\n'</span>, text)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'_convert_html_to_text:<span class="hljs-subst">{text}</span>'</span>)
        <span class="hljs-keyword">return</span> text.strip()
</code></pre>
<h2 data-id="heading-6">é‚®ä»¶å†…å®¹ç»„ç»‡</h2>
<ul>
<li>åœ¨è¿™ä¸ªå‡½æ•°ä¸­å°†æ¨¡ç‰ˆä¸­çš„å ä½ç¬¦æ›¿æ¢ä¸ºæŒ‡å®šæ•°æ®
<ul>
<li>çº¯æ–‡æœ¬æ¨¡ç‰ˆä½¿ç”¨ {client_key} ç»“æ„çš„å‚æ•°ä½œä¸ºå®¢æˆ·ä¿¡æ¯å ä½ç¬¦</li>
<li>{sender_key}ä¸ºå‘é€è€…ä¿¡æ¯å ä½ç¬¦</li>
<li>å…¶ä¸­ key æ˜¯å®¢æˆ· excel æ–‡ä»¶æ ‡é¢˜å’Œé…ç½®ä¸­ SenderInfo å¯¹è±¡ to_json å‡½æ•°è¿”å›çš„å¯¹è±¡ key</li>
</ul>
</li>
<li>Html æ¨¡ç‰ˆå†…å®¹æ›¿æ¢æ–¹å¼è¯·ç§»æ­¥å­¦ä¹  jinja2 åº“</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">personalize_content</span>(<span class="hljs-params">self, client, template, txt_template: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""ä¸ªæ€§åŒ–é‚®ä»¶å†…å®¹"""</span>

        html_content = template.render(client=client, sender=self.sender_info.to_json()) <span class="hljs-keyword">if</span> template <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

        <span class="hljs-keyword">if</span> txt_template:
            txt_content = txt_template
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> client.keys():
                txt_content = txt_content.replace(<span class="hljs-string">'{client_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(client[key]))
            sender_json = self.sender_info.to_json()
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> sender_json:
                txt_content = txt_content.replace(<span class="hljs-string">'{sender_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(sender_json[key]))
        <span class="hljs-keyword">else</span>:
            txt_content = self._convert_html_to_text(html_content)

        <span class="hljs-keyword">return</span> html_content, txt_content
</code></pre>
<h2 data-id="heading-7">å‘é€é‚®ä»¶</h2>
<p>è¿™éƒ¨åˆ†æ˜¯é‚®ä»¶å‘é€çš„æ ¸å¿ƒä»£ç ï¼Œé‚®ä»¶ä¸»é¢˜ä» SenderInfo é…ç½®ä¸­è·å–ï¼Œå®ç°ç»Ÿä¸€é…ç½®ã€‚
å‘é€æˆåŠŸæˆ–å¤±è´¥éƒ½è¦è®°å½•æ—¥å¿—ï¼Œå·²å¤‡åç»­æŸ¥çœ‹ã€æ ¸å¯¹</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_to_client</span>(<span class="hljs-params">self, client, content</span>):
        <span class="hljs-string">"""å‘é€ç»™å•ä¸ªå®¢æˆ·"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºé‚®ä»¶</span>
            subject = self.sender_info.get_subject(client=client)

            <span class="hljs-comment"># å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œå‘ç»™è‡ªå·±</span>
            to_email = client[<span class="hljs-string">'email'</span>]
            <span class="hljs-keyword">if</span> self.send_settings.test_mode:
                to_email = self.email_config.user
                subject = <span class="hljs-string">f"[æµ‹è¯•] <span class="hljs-subst">{subject}</span>"</span>

            <span class="hljs-comment"># å‘é€</span>
            self.yag.send(
                to=to_email,
                subject=subject,
                contents=content,
                <span class="hljs-comment"># attachments=['attachments/sample.pdf'],  # å¯é€‰é™„ä»¶</span>
                headers={
                    <span class="hljs-comment"># 'X-Priority': '1',  #  é«˜ä¼˜å…ˆçº§ âš ï¸ï¼ˆæ˜¾ç¤ºæ„Ÿå¹å·ï¼‰</span>
                    <span class="hljs-string">'X-Priority'</span>: <span class="hljs-string">'3'</span>,  <span class="hljs-comment"># æ™®é€šä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼Œä¸æ˜¾ç¤ºç‰¹æ®Šæ ‡è®°ï¼‰</span>
                    <span class="hljs-comment"># 'X-Priority': '5',  # ä½ä¼˜å…ˆçº§</span>
                    <span class="hljs-string">'X-Mailer'</span>: <span class="hljs-string">'PersonalEmailSender'</span>
                }
            )

            <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
            log_entry = {
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'æˆåŠŸ'</span>
            }
            self.sent_log.append(log_entry)

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ å·²å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span> &lt;<span class="hljs-subst">{client[<span class="hljs-string">'email'</span>]}</span>&gt;"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— å‘é€å¤±è´¥ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>: <span class="hljs-subst">{e}</span>"</span>)
            self.sent_log.append({
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">f'å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>'</span>
            })
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h2 data-id="heading-8">å­˜å‚¨æ—¥å¿—</h2>
<p>è¿è¡Œå®Œæ¯•å°†æ—¥å¿—å†™å…¥æ–‡ä»¶</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_log</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¿å­˜å‘é€è®°å½•"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.sent_log:
            <span class="hljs-keyword">return</span>

        log_df = pd.DataFrame(self.sent_log)
        timestamp = datetime.now().strftime(<span class="hljs-string">'%Y%m%d_%H%M%S'</span>)
        log_file = <span class="hljs-string">f'sent_logs/sent_<span class="hljs-subst">{timestamp}</span>.csv'</span>

        <span class="hljs-comment"># ç¡®ä¿ç›®å½•å­˜åœ¨</span>
        os.makedirs(<span class="hljs-string">'sent_logs'</span>, exist_ok=<span class="hljs-literal">True</span>)

        log_df.to_csv(log_file, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ“‹ å‘é€è®°å½•å·²ä¿å­˜: <span class="hljs-subst">{log_file}</span>"</span>)
</code></pre>
<h2 data-id="heading-9">åŠŸèƒ½ç»„åˆåçš„ä¸»è¿è¡Œå‡½æ•°</h2>
<p>åœ¨æ­¤å¤„æ•´åˆä»¥ä¸Šä»‹ç»çš„å„éƒ¨åˆ†åŠŸèƒ½ã€‚</p>
<ul>
<li>æµç¨‹ï¼šåŠ è½½å®¢æˆ· --&gt; åŠ è½½æ¨¡ç‰ˆ --&gt; åˆ†åˆ«ä¸ºå®¢æˆ·ç”Ÿæˆé‚®ä»¶å†…å®¹ --&gt; å†…å®¹æ ¡éªŒ --&gt; å‘é€é‚®ä»¶ --&gt; å‘é€å»¶è¿Ÿ --&gt; ä¿å­˜æ—¥å¿— --&gt; å‘é€ç»“æŸ</li>
</ul>
<pre><code class="hljs language-python" lang="python">
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¸»è¿è¡Œå‡½æ•°"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹å‘é€ä¸ªæ€§åŒ–é‚®ä»¶...\n"</span>)

        <span class="hljs-comment"># åŠ è½½æ•°æ®</span>
        client_list = self.load_clients()
        template, txt_template = self.load_template()

        sent_count = <span class="hljs-number">0</span>
        total_clients = <span class="hljs-built_in">len</span>(client_list)

        <span class="hljs-keyword">for</span> i, client <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(client_list, <span class="hljs-number">1</span>):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[<span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_clients}</span>] å¤„ç†: <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)

            <span class="hljs-comment"># ä¸ªæ€§åŒ–å†…å®¹</span>
            html_content, text_content = self.personalize_content(client, template, txt_template)

            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> text_content:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— æ— å†…å®¹å¯å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)
                <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
                log_entry = {
                    <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                    <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                    <span class="hljs-string">'status'</span>: <span class="hljs-string">'å¤±è´¥'</span>,
                    <span class="hljs-string">'åŸå› '</span>: <span class="hljs-string">'æ— å†…å®¹'</span>
                }
                self.sent_log.append(log_entry)
                <span class="hljs-keyword">continue</span>

            content = [text_content, html_content] <span class="hljs-keyword">if</span> html_content <span class="hljs-keyword">else</span> text_content
            <span class="hljs-comment"># å‘é€</span>
            <span class="hljs-keyword">if</span> self.send_to_client(client, content):
                sent_count += <span class="hljs-number">1</span>

            <span class="hljs-comment"># å»¶è¿Ÿï¼Œé¿å…è¢«é™åˆ¶</span>
            <span class="hljs-keyword">if</span> i &lt; total_clients:
                delay = self.send_settings.delay_between_emails
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­‰å¾… <span class="hljs-subst">{delay}</span> ç§’..."</span>)
                time.sleep(delay)

            <span class="hljs-comment"># åˆ†æ‰¹æš‚åœï¼ˆå¦‚æœå‘é€é‡å¤§ï¼‰</span>
            <span class="hljs-keyword">if</span> i % self.send_settings.max_emails_per_batch == <span class="hljs-number">0</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå·²å‘é€ <span class="hljs-subst">{i}</span> å°ï¼Œæš‚åœ 60 ç§’..."</span>)
                time.sleep(<span class="hljs-number">60</span>)

        <span class="hljs-comment"># ä¿å­˜æ—¥å¿—</span>
        self.save_log()

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nâœ… å®Œæˆï¼æˆåŠŸå‘é€ <span class="hljs-subst">{sent_count}</span>/<span class="hljs-subst">{total_clients}</span> å°é‚®ä»¶"</span>)

        <span class="hljs-comment"># å…³é—­è¿æ¥</span>
        <span class="hljs-keyword">if</span> self.yag:
            self.yag.close()
</code></pre>
<h2 data-id="heading-10">è¿è¡Œç¤ºä¾‹</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ–‡ä»¶</span>
    client_data_file = <span class="hljs-string">'./clients/clients.xlsx'</span>
    <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿æ–‡ä»¶</span>
    txt_template_file = <span class="hljs-string">'./templates/christmas.txt'</span>
    sender = EmailSender(client_data_file=client_data_file,
                         txt_template_file=txt_template_file)
    sender.run()
</code></pre>
<h2 data-id="heading-11">é™„æºç </h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é…ç½®ä¿¡æ¯</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailConfig</span>:
    <span class="hljs-string">"""
    é‚®ç®±é…ç½®
    """</span>
    <span class="hljs-comment"># ä½ çš„é‚®ç®±</span>
    user: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># é‚®ç®±æˆæƒç </span>
    password: <span class="hljs-built_in">str</span> = <span class="hljs-string">'TXYuclse932VzHJ'</span>
    <span class="hljs-comment"># é‚®ç®±æœåŠ¡å™¨</span>
    host: <span class="hljs-built_in">str</span> = <span class="hljs-string">'smtp.163.com'</span>
    <span class="hljs-comment"># ç«¯å£</span>
    port: <span class="hljs-built_in">int</span> = <span class="hljs-string">'587'</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderInfo</span>:
    <span class="hljs-string">"""
    å‘ä»¶äººä¿¡æ¯
    """</span>
    <span class="hljs-comment"># æ˜¾ç¤ºç»™å®¢æˆ·çš„å‘ä»¶äººåç§°</span>
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">'èµ·é£äº†-dev'</span>
    <span class="hljs-comment"># èŒä½</span>
    position: <span class="hljs-built_in">str</span> = <span class="hljs-string">'å¼€å‘äººå‘˜'</span>
    <span class="hljs-comment"># å…¬å¸</span>
    company: <span class="hljs-built_in">str</span> = <span class="hljs-string">'xxxç§‘æŠ€æœ‰é™è´£ä»»å…¬å¸'</span>
    <span class="hljs-comment"># é‚®ç®±</span>
    email: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># ç­¾å</span>
    signature: <span class="hljs-built_in">str</span> = <span class="hljs-string">'ç­¾åæµ‹è¯•'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_subject</span>(<span class="hljs-params">self, client: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-string">"""
        è·å–é‚®ä»¶ä¸»é¢˜
        :param client: å®¢æˆ·ä¿¡æ¯, ä¸å®¢æˆ·ä¿¡æ¯æ–‡ä»¶å†…ä¸€è‡´
        :return: é‚®ä»¶ä¸»é¢˜
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>è‡´<span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>çš„é‚®ä»¶"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_json</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'name'</span>: self.name,
            <span class="hljs-string">'position'</span>: self.position,
            <span class="hljs-string">'company'</span>: self.company,
            <span class="hljs-string">'email'</span>: self.email,
            <span class="hljs-string">'signature'</span>: self.signature
        }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SendSettings</span>:
    <span class="hljs-string">"""
    å‘é€è®¾ç½®
    """</span>
    <span class="hljs-comment"># é‚®ä»¶é—´éš”(ç§’)ï¼Œé¿å…è¢«é™åˆ¶</span>
    delay_between_emails: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>
    <span class="hljs-comment"># æµ‹è¯•æ¨¡å¼ï¼ˆåªå‘ç»™è‡ªå·±ï¼‰</span>
    test_mode: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    <span class="hljs-comment"># æ¯æ‰¹æœ€å¤šå‘é€é‡</span>
    max_emails_per_batch: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span>

<span class="hljs-comment"># ä¸»åŠŸèƒ½ä»£ç </span>
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> re

<span class="hljs-keyword">import</span> yagmail
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template
<span class="hljs-keyword">from</span> config.config <span class="hljs-keyword">import</span> EmailConfig, SenderInfo, SendSettings


<span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSender</span>:
    <span class="hljs-string">"""é‚®ä»¶å‘é€å™¨"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, client_data_file: <span class="hljs-built_in">str</span>, txt_template_file: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""åˆå§‹åŒ–"""</span>
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®</span>
        self.client_data_file = client_data_file
        <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿</span>
        self.template_file = <span class="hljs-literal">None</span>
        self.txt_template_file = txt_template_file
        <span class="hljs-comment"># é‚®ä»¶é…ç½®</span>
        self.email_config = EmailConfig()
        self.sender_info = SenderInfo()
        self.send_settings = SendSettings()
        self.yag = yagmail.SMTP(
            user=self.email_config.user,
            password=self.email_config.password,
            host=self.email_config.host,
            port=self.email_config.port
        )
        self.sent_log = []

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_clients</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">dict</span>]:
        <span class="hljs-string">"""åŠ è½½å®¢æˆ·æ•°æ®"""</span>
        df = pd.read_excel(self.client_data_file)
        client_list = df.to_dict(orient=<span class="hljs-string">'records'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client_list:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"å®¢æˆ·æ•°æ®ä¸ºç©º"</span>)
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ ¡éªŒå¹¶æ¸…æ´—</span>
        <span class="hljs-keyword">for</span> client <span class="hljs-keyword">in</span> client_list:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'email'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„é‚®ç®±ä¸ºç©º"</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'name'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„å§“åä¸ºç©º"</span>)
            client[<span class="hljs-string">'name'</span>] = client[<span class="hljs-string">'name'</span>].strip()
            client[<span class="hljs-string">'email'</span>] = client[<span class="hljs-string">'email'</span>].strip()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(client_list)}</span> ä¸ªå®¢æˆ·æ•°æ®"</span>)
        <span class="hljs-keyword">return</span> client_list

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_template</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åŠ è½½é‚®ä»¶æ¨¡æ¿"""</span>
        template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                template = Template(f.read())
        txt_template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.txt_template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.txt_template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                txt_template = f.read()
        <span class="hljs-keyword">return</span> template, txt_template

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_convert_html_to_text</span>(<span class="hljs-params">self, html</span>):
        <span class="hljs-string">"""
        æ™ºèƒ½è½¬æ¢HTMLåˆ°çº¯æ–‡æœ¬
        ä¿ç•™é‡è¦æ ¼å¼ï¼ˆåˆ—è¡¨ã€æ®µè½ã€å¼ºè°ƒç­‰ï¼‰
        """</span>
        <span class="hljs-comment"># è‡ªå®šä¹‰è½¬æ¢è§„åˆ™</span>
        replacements = [
            (<span class="hljs-string">r'&lt;br\s*/?&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;p.*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/p&gt;'</span>, <span class="hljs-string">''</span>),
            (<span class="hljs-string">r'&lt;li.*?&gt;'</span>, <span class="hljs-string">'â€¢ '</span>),
            (<span class="hljs-string">r'&lt;/li&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;strong.*?&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;/strong&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;em.*?&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;/em&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;h[1-6].*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/h[1-6]&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;[^&gt;]+&gt;'</span>, <span class="hljs-string">''</span>),  <span class="hljs-comment"># ç§»é™¤å…¶ä»–æ‰€æœ‰HTMLæ ‡ç­¾</span>
        ]

        text = html
        <span class="hljs-keyword">for</span> pattern, replacement <span class="hljs-keyword">in</span> replacements:
            text = re.sub(pattern, replacement, text)

        <span class="hljs-comment"># æ¸…ç†å¤šä½™çš„ç©ºè¡Œ</span>
        text = re.sub(<span class="hljs-string">r'\n\s*\n\s*\n'</span>, <span class="hljs-string">'\n\n'</span>, text)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'_convert_html_to_text:<span class="hljs-subst">{text}</span>'</span>)
        <span class="hljs-keyword">return</span> text.strip()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">personalize_content</span>(<span class="hljs-params">self, client, template, txt_template: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""ä¸ªæ€§åŒ–é‚®ä»¶å†…å®¹"""</span>

        html_content = template.render(client=client, sender=self.sender_info.to_json()) <span class="hljs-keyword">if</span> template <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

        <span class="hljs-keyword">if</span> txt_template:
            txt_content = txt_template
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> client.keys():
                txt_content = txt_content.replace(<span class="hljs-string">'{client_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(client[key]))
            sender_json = self.sender_info.to_json()
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> sender_json:
                txt_content = txt_content.replace(<span class="hljs-string">'{sender_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(sender_json[key]))
        <span class="hljs-keyword">else</span>:
            txt_content = self._convert_html_to_text(html_content)

        <span class="hljs-keyword">return</span> html_content, txt_content

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_to_client</span>(<span class="hljs-params">self, client, content</span>):
        <span class="hljs-string">"""å‘é€ç»™å•ä¸ªå®¢æˆ·"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºé‚®ä»¶</span>
            subject = self.sender_info.get_subject(client=client)

            <span class="hljs-comment"># å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œå‘ç»™è‡ªå·±</span>
            to_email = client[<span class="hljs-string">'email'</span>]
            <span class="hljs-keyword">if</span> self.send_settings.test_mode:
                to_email = self.email_config.user
                subject = <span class="hljs-string">f"[æµ‹è¯•] <span class="hljs-subst">{subject}</span>"</span>

            <span class="hljs-comment"># å‘é€</span>
            self.yag.send(
                to=to_email,
                subject=subject,
                contents=content,
                <span class="hljs-comment"># attachments=['attachments/sample.pdf'],  # å¯é€‰é™„ä»¶</span>
                headers={
                    <span class="hljs-comment"># 'X-Priority': '1',  #  é«˜ä¼˜å…ˆçº§ âš ï¸ï¼ˆæ˜¾ç¤ºæ„Ÿå¹å·ï¼‰</span>
                    <span class="hljs-string">'X-Priority'</span>: <span class="hljs-string">'3'</span>,  <span class="hljs-comment"># æ™®é€šä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼Œä¸æ˜¾ç¤ºç‰¹æ®Šæ ‡è®°ï¼‰</span>
                    <span class="hljs-comment"># 'X-Priority': '5',  # ä½ä¼˜å…ˆçº§</span>
                    <span class="hljs-string">'X-Mailer'</span>: <span class="hljs-string">'PersonalEmailSender'</span>
                }
            )

            <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
            log_entry = {
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'æˆåŠŸ'</span>
            }
            self.sent_log.append(log_entry)

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ å·²å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span> &lt;<span class="hljs-subst">{client[<span class="hljs-string">'email'</span>]}</span>&gt;"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— å‘é€å¤±è´¥ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>: <span class="hljs-subst">{e}</span>"</span>)
            self.sent_log.append({
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">f'å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>'</span>
            })
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_log</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¿å­˜å‘é€è®°å½•"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.sent_log:
            <span class="hljs-keyword">return</span>

        log_df = pd.DataFrame(self.sent_log)
        timestamp = datetime.now().strftime(<span class="hljs-string">'%Y%m%d_%H%M%S'</span>)
        log_file = <span class="hljs-string">f'sent_logs/sent_<span class="hljs-subst">{timestamp}</span>.csv'</span>

        <span class="hljs-comment"># ç¡®ä¿ç›®å½•å­˜åœ¨</span>
        os.makedirs(<span class="hljs-string">'sent_logs'</span>, exist_ok=<span class="hljs-literal">True</span>)

        log_df.to_csv(log_file, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ“‹ å‘é€è®°å½•å·²ä¿å­˜: <span class="hljs-subst">{log_file}</span>"</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¸»è¿è¡Œå‡½æ•°"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹å‘é€ä¸ªæ€§åŒ–é‚®ä»¶...\n"</span>)

        <span class="hljs-comment"># åŠ è½½æ•°æ®</span>
        client_list = self.load_clients()
        template, txt_template = self.load_template()

        sent_count = <span class="hljs-number">0</span>
        total_clients = <span class="hljs-built_in">len</span>(client_list)

        <span class="hljs-keyword">for</span> i, client <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(client_list, <span class="hljs-number">1</span>):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[<span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_clients}</span>] å¤„ç†: <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)

            <span class="hljs-comment"># ä¸ªæ€§åŒ–å†…å®¹</span>
            html_content, text_content = self.personalize_content(client, template, txt_template)

            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> text_content:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— æ— å†…å®¹å¯å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)
                <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
                log_entry = {
                    <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                    <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                    <span class="hljs-string">'status'</span>: <span class="hljs-string">'å¤±è´¥'</span>,
                    <span class="hljs-string">'åŸå› '</span>: <span class="hljs-string">'æ— å†…å®¹'</span>
                }
                self.sent_log.append(log_entry)
                <span class="hljs-keyword">continue</span>

            content = [text_content, html_content] <span class="hljs-keyword">if</span> html_content <span class="hljs-keyword">else</span> text_content
            <span class="hljs-comment"># å‘é€</span>
            <span class="hljs-keyword">if</span> self.send_to_client(client, content):
                sent_count += <span class="hljs-number">1</span>

            <span class="hljs-comment"># å»¶è¿Ÿï¼Œé¿å…è¢«é™åˆ¶</span>
            <span class="hljs-keyword">if</span> i &lt; total_clients:
                delay = self.send_settings.delay_between_emails
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­‰å¾… <span class="hljs-subst">{delay}</span> ç§’..."</span>)
                time.sleep(delay)

            <span class="hljs-comment"># åˆ†æ‰¹æš‚åœï¼ˆå¦‚æœå‘é€é‡å¤§ï¼‰</span>
            <span class="hljs-keyword">if</span> i % self.send_settings.max_emails_per_batch == <span class="hljs-number">0</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå·²å‘é€ <span class="hljs-subst">{i}</span> å°ï¼Œæš‚åœ 60 ç§’..."</span>)
                time.sleep(<span class="hljs-number">60</span>)

        <span class="hljs-comment"># ä¿å­˜æ—¥å¿—</span>
        self.save_log()

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nâœ… å®Œæˆï¼æˆåŠŸå‘é€ <span class="hljs-subst">{sent_count}</span>/<span class="hljs-subst">{total_clients}</span> å°é‚®ä»¶"</span>)

        <span class="hljs-comment"># å…³é—­è¿æ¥</span>
        <span class="hljs-keyword">if</span> self.yag:
            self.yag.close()


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ–‡ä»¶</span>
    client_data_file = <span class="hljs-string">'./clients/clients.xlsx'</span>
    <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿æ–‡ä»¶</span>
    txt_template_file = <span class="hljs-string">'./templates/christmas.txt'</span>
    sender = EmailSender(client_data_file=client_data_file,
                         txt_template_file=txt_template_file)
    sender.run()
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰]]></title>    <link>https://juejin.cn/post/7585553799298416686</link>    <guid>https://juejin.cn/post/7585553799298416686</guid>    <pubDate>2025-12-21T10:31:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585553799298416686" data-draft-id="7585743487258542089" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-21T10:31:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åå­—è¢«ä½ ä»¬æƒ³å®Œäº†"/> <meta itemprop="url" content="https://juejin.cn/user/3065854916834782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3065854916834782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åå­—è¢«ä½ ä»¬æƒ³å®Œäº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:31:52.000Z" title="Sun Dec 21 2025 10:31:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰</h2>
<p>Flutter: 3.35.6</p>
<p>å‰é¢æœ‰äººæåˆ°åœ¨å…ƒç´ å†…éƒ¨çš„é‚£å—åˆ¤æ–­æ€ä¹ˆé‚£ä¹ˆå†™çš„ï¼Œçœ‹æ¥å¯¹çŸ¥è¯†æ¸´æœ›çš„å°ä¼™ä¼´è¿˜æ˜¯æœ‰ï¼Œè¿™æ ·æŒºå¥½çš„ã€‚ä¸è‡³äºè¯´ç‰¢è®°éƒ¨åˆ†çŸ¥è¯†ï¼Œåªéœ€è¦å¤§è‡´äº†è§£ä¸€ä¸‹æœ‰ä¸ªå°è±¡åé¢å¦‚æœå“ªé‡Œå†ç”¨åˆ°äº†å°±å¯ä»¥æ ¹æ®è¿™ä¸ªå°è±¡å»æŸ¥é˜…èµ„æ–™ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯´ä¸€ä¸‹åˆ¤æ–­åŸç†ã€‚å½“æˆ‘ä»¬çŸ¥æ™“çŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹åæ ‡(åŒ…æ‹¬ä»»æ„æ—‹è½¬å)ï¼Œå¯ä»¥ä½¿ç”¨å‘é‡å‰ä¹˜æ³•æ¥åˆ¤æ–­æ˜¯å¦åœ¨çŸ©å½¢å†…éƒ¨ã€‚</p>
<p>å‘é‡å‰ä¹˜æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå¦‚æœä¸€ä¸ªç‚¹åœ¨å‡¸å¤šè¾¹å½¢å†…éƒ¨ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å§‹ç»ˆä½äºè¯¥å¤šè¾¹å½¢æ¯æ¡è¾¹çš„åŒä¸€ä¾§ã€‚</p>
<p>æ³¨ï¼šå‡¸å¤šè¾¹å½¢å®šä¹‰ä¸ºæ‰€æœ‰å†…è§’å‡å°äº180åº¦ï¼Œå¹¶ä¸”ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è¿çº¿éƒ½å®Œå…¨ä½äºå¤šè¾¹å½¢å†…éƒ¨æˆ–è¾¹ç•Œã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨å‘é‡å‰ä¹˜æ³•æ¥åˆ¤æ–­ç‚¹ä½äºçº¿çš„å“ªä¸€ä¾§ã€‚å‡è®¾çŸ©å½¢é¡¶ç‚¹æŒ‰<strong>é¡ºæ—¶é’ˆ</strong>æˆ–<strong>é€†æ—¶é’ˆ</strong>é¡ºåºä¸º Aï¼ŒBï¼ŒCï¼ŒDï¼š</p>
<ul>
<li>å¯¹äºè¾¹ ABï¼Œè®¡ç®—å‘é‡ AB å’Œ AP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ BCï¼Œè®¡ç®—å‘é‡ BC å’Œ BP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ CDï¼Œè®¡ç®—å‘é‡ CD å’Œ CP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ DAï¼Œè®¡ç®—å‘é‡ DA å’Œ DP çš„å‰ç§¯ã€‚</li>
</ul>
<p>å¦‚æœç‚¹ P åœ¨æ‰€æœ‰è¾¹çš„â€ŒåŒä¸€ä¾§â€Œï¼ˆå³æ‰€æœ‰å‰ç§¯ç»“æœçš„ç¬¦å·ç›¸åŒï¼‰ï¼Œé‚£ä¹ˆç‚¹ P å°±åœ¨çŸ©å½¢å†…éƒ¨ã€‚æˆ‘ä»¬å‡è®¾çŸ©å½¢æŸæ¡è¾¹çš„é¡¶ç‚¹ä¸º(x1, y1), (x2, y2), åˆ¤æ–­çš„ç‚¹åæ ‡ä¸º(x, y)ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>
<p>(x2 - x1) * (y - y1) - (y2 - y1) * (x - x1) &gt; 0</p>
<p>è¿™æ ·å°±å¯ä»¥åˆ¤æ–­åœ¨æŸä¾§ï¼Œå¦‚æœå…¶ä»–ä¸‰æ¡è¾¹ä¹Ÿæ»¡è¶³ï¼Œé‚£å°±æ˜¯å†…ä¾§äº†ï¼Œè¦è½¬æ¢ä¸ºä¸‹é¢ä»£ç ä¸­çš„å½¢å¼ï¼Œé‚£å°±åšä¸€ä¸‹åŠ å‡ä¹˜é™¤å°±è¡Œäº†ï¼š</p>
<ol>
<li>(x2 - x1) * (y - y1) - (y2 - y1) * (x - x1) &gt; 0: åˆå§‹</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) - (x - x1) &gt; 0: ä¸¤è¾¹åŒæ—¶é™¤ä»¥(y2 - y1)</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) - x + x1 &gt; 0: å±•å¼€æ‹¬å·</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) + x1 &gt; x: å°†xç§»é¡¹</li>
</ol>
<p>è¿™æ ·å°±å¾—åˆ°äº†ä»£ç ä¸­çš„åˆ¤æ–­ä¾æ®ï¼Œè‡³äºå¾ªç¯éå†é¡¶ç‚¹çš„å†™æ³•ï¼Œå°±æ˜¯ä¸ºäº†è·å–ç›¸é‚»ä¸¤ä¸ªé¡¶ç‚¹ï¼Œè¿™ä¸ªå°±å¯ä»¥å¸¦å…¥squareåæ ‡å’Œå¾ªç¯å»ç®—ä¸€ä¸‹å°±è¡Œäº†ï¼Œä¿è¯æ¯æ¬¡å¾ªç¯éƒ½æ˜¯ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨çš„é¡¶ç‚¹åæ ‡é¡ºåºæ˜¯é¡ºæ—¶é’ˆï¼Œç¬¬ä¸€æ¬¡å¾ªç¯ i = 0ï¼Œj = 3ï¼Œé‚£ä¹ˆiå°±æ˜¯å·¦ä¸Šé¡¶ç‚¹ï¼Œjå°±æ˜¯å·¦ä¸‹é¡¶ç‚¹ï¼Œä¸¤ä¸ªé¡¶ç‚¹åˆšå¥½æ„æˆçŸ©å½¢å·¦è¾¹ï¼›ç¬¬äºŒæ¬¡å¾ªç¯ j = i++ï¼Œæ­¤æ—¶ j = 0ï¼Œi = 1åç»­å–œæ¬¢ä»¥æ­¤ç±»æ¨å³å¯ã€‚</p>
<p>è¿™æ ·åˆ¤æ–­åœ¨å†…ä¾§å·®ä¸å¤šå°±è§£é‡Šå®Œäº†ã€‚æ¥ä¸‹æ¥å¼€å§‹æˆ‘ä»¬ä»Šå¤©æ­£æ–‡ã€‚å‰é¢æˆ‘ä»¬å°±ç®€å•å®Œæˆäº†å¤šä¸ªå…ƒç´ çš„ç›¸åº”æ“ä½œï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€äº›ä¼˜åŒ–å’Œä¸€äº›ç®€å•çš„æ‰©å±•åŠŸèƒ½ã€‚</p>
<p>æ—¢ç„¶æ˜¯å¤šä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆè‚¯å®šå°±æ¶‰åŠåˆ°æ–°å¢å’Œåˆ é™¤ï¼Œä¹‹å‰çš„æ–°å¢éƒ½æ˜¯åœ¨åˆ—è¡¨é‡Œé¢ç›´æ¥æ·»åŠ ï¼Œç°åœ¨æˆ‘ä»¬å•ç‹¬æå–ä¸€ä¸ªæ–¹æ³•ç”¨äºæ–°å¢ã€‚è‡³äºåˆ é™¤åŠŸèƒ½æˆ‘ä»¬å°±å®šä¹‰åœ¨å…ƒç´ å·¦ä¸Šè§’ä¸ºåˆ é™¤åŒºåŸŸï¼Œè§¦å‘æ–¹å¼ä¸ºç‚¹å‡»ã€‚ä¹‹å‰æˆ‘ä»¬å¯¹çƒ­åŒºçš„æ•°æ®æ¨¡å‹ä¸­æ·»åŠ äº† trigger å­—æ®µï¼Œç”¨äºè¡¨ç¤ºå½“å‰åŒºåŸŸè§¦å‘æ“ä½œçš„æ–¹å¼æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å¯¹ç‚¹å‡»æ–¹æ³•è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä¸”åœ¨ä¸´æ—¶ä¸­é—´å˜é‡ä¸Šé¢å­˜å‚¨ trigger å­—æ®µï¼Œç”¨äºåˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseAreaModel</span> </span>{
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-comment">/// <span class="markdown">å½“å‰å“åº”æ“ä½œçš„è§¦å‘æ–¹å¼</span></span>
  <span class="hljs-keyword">final</span> TriggerMethod trigger;
}

<span class="hljs-comment">/// <span class="markdown">æ–°å¢è¿”å›Recordsï¼Œç”¨äºè®°å½•çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span></span>
(ElementStatus, TriggerMethod)? _onDownZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-comment">// å…ˆåˆ¤æ–­æ˜¯å¦åœ¨å“åº”å¯¹åº”æ“ä½œçš„åŒºåŸŸ</span>
  <span class="hljs-keyword">final</span> (ElementStatus, TriggerMethod)? areaStatus = _getElementZone(x: x, y: y, item: item);
  <span class="hljs-keyword">if</span> (areaStatus != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">return</span> areaStatus;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_insideElement(x: x, y: y, item: item)) {
    <span class="hljs-comment">// å› ä¸ºåŠ å…¥æ—‹è½¬ï¼Œæ‰€ä»¥å•ç‹¬æŠ½å–è½ç‚¹æ˜¯å¦åœ¨å…ƒç´ å†…éƒ¨çš„æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> (ElementStatus.move, TriggerMethod.move);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-comment">/// <span class="markdown">æ–°å¢è¿”å›Recordsï¼Œç”¨äºè®°å½•çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span></span>
(ElementStatus, TriggerMethod)? _getElementZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-comment">// æ–°å¢Recordsè®°å½•è¿”å›çš„çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span>
  (ElementStatus, TriggerMethod)? tempStatus;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ConstantsConfig.baseAreaList.length; i++) {
    <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

    <span class="hljs-keyword">if</span> (
      x &gt;= dx - areaCW &amp;&amp;
      x &lt;= dx + areaCW &amp;&amp;
      y &gt;= dy - areaCH &amp;&amp;
      y &lt;= dy + areaCH
    ) {
      tempStatus = (currentArea.status, currentArea.trigger);
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-keyword">return</span> tempStatus;
}
</code></pre>
<p>è¿™æ ·è§¦å‘æ–¹å¼å’ŒçŠ¶æ€éƒ½è®°å½•äº†ï¼Œæˆ‘ä»¬å°±å¼€å§‹å®ç°åˆ é™¤åŠŸèƒ½ï¼Œä¾ç„¶æŒ‰ç…§ä¹‹å‰çš„æ­¥éª¤å¿«é€Ÿå®ç°ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æ–°å¢åˆ é™¤</span>
ResponseAreaModel(
  areaWidth: <span class="hljs-number">20</span>,
  areaHeight: <span class="hljs-number">20</span>,
  xRatio: <span class="hljs-number">0</span>,
  yRatio: <span class="hljs-number">0</span>,
  status: ElementStatus.deleteStatus,
  icon: <span class="hljs-string">'assets/images/icon_delete.png'</span>,
  trigger: TriggerMethod.down,
),
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">å¤„ç†åˆ é™¤å…ƒç´ </span></span>
<span class="hljs-keyword">void</span> _onDelete() {
  <span class="hljs-keyword">if</span> (_currentElement == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span>;

  _elementList.removeWhere((item) =&gt; item.id == _currentElement?.id);
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æŒ‰ä¸‹äº‹ä»¶</span></span>
<span class="hljs-keyword">void</span> _onPanDown(DragDownDetails details) {
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-comment">// éå†åˆ¤æ–­å½“å‰ç‚¹å‡»çš„ä½ç½®æ˜¯å¦è½åœ¨äº†æŸä¸ªå…ƒç´ çš„å“åº”åŒºåŸŸ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> _elementList) {
    <span class="hljs-comment">// æ–°å¢Recordsæ•°æ®ï¼Œå­˜å‚¨å…ƒç´ çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span>
    <span class="hljs-keyword">final</span> (ElementStatus, TriggerMethod)? status = _onDownZone(x: dx, y: dy, item: item);

    <span class="hljs-keyword">if</span> (status != <span class="hljs-keyword">null</span>) {
      currentElement = item;
      temp = temp.copyWith(status: status.$<span class="hljs-number">1</span>, trigger: status.$<span class="hljs-number">2</span>);
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-comment">// æ–°å¢åˆ¤æ–­</span>
  <span class="hljs-comment">// å¦‚æœå½“å‰æœ‰é€‰ä¸­çš„å…ƒç´ ä¸”å’Œç‚¹å‡»åŒºåŸŸçš„currentElementæ˜¯ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-comment">// å¹¶ä¸” temp çš„ statuså¯¹åº”çš„è§¦å‘æ–¹å¼ä¸ºç‚¹å‡»ï¼Œé‚£ä¹ˆå°±å“åº”å¯¹åº”çš„ç‚¹å‡»äº‹ä»¶</span>
  <span class="hljs-keyword">if</span> (currentElement?.id == _currentElement?.id &amp;&amp; temp.trigger == TriggerMethod.down) {
    <span class="hljs-keyword">if</span> (temp.status == ElementStatus.deleteStatus) {
      _onDelete();
      <span class="hljs-comment">// å› ä¸ºæ˜¯åˆ é™¤ï¼Œå°±ç½®ç©ºé€‰ä¸­ï¼Œè®©ä¸‹é¢ä»£ç æ‰§è¡Œæœ€åçš„æ¸…é™¤</span>
      currentElement = <span class="hljs-keyword">null</span>;
    }
  }

  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c31a7b32d93495e96cd5dc3d0ba960b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917912&amp;x-signature=QlV%2B7Tyl83Ib0ywhrpUNPvC8fi4%3D" alt="image01.gif" loading="lazy"/></p>
<p>è¿™æ ·å°±ç®€å•å®ç°äº†å…ƒç´ çš„åˆ é™¤åŠŸèƒ½ã€‚åˆ°æ­¤æ“ä½œåŒºåŸŸå¸¸ç”¨çš„åŠŸèƒ½å·®ä¸å¤šå°±å®Œæˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ä¸€äº›åŒºåŸŸçš„è‡ªå®šä¹‰ï¼›ä¾‹å¦‚æˆ‘å¸Œæœ›æ—‹è½¬çš„åŒºåŸŸåœ¨å³ä¸‹è§’ï¼ˆç°åœ¨åœ¨å³ä¸Šè§’ï¼‰ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ç¼©æ”¾åŠŸèƒ½ï¼Œè¿˜æƒ³è‡ªå®šä¹‰ä¸€ä¸ªåŒºåŸŸï¼Œè¿™æ—¶å€™è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p>å…è®¸ä¼ é€’é…ç½®ï¼Œé€šè¿‡è¿™ä»½é…ç½®æ¥å†³å®šå…ƒç´ åº”è¯¥æœ‰ä»€ä¹ˆå“åº”åŒºåŸŸå¹¶ä¸”æ˜¯å¦ä½¿ç”¨è¿™äº›å“åº”åŒºåŸŸï¼Œç„¶è€Œæ“ä½œè¿™äº›å†…ç½®çš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰å®šä¹‰çš„ <strong>final ElementStatus status;</strong> å­—æ®µæ¥ç¡®å®šè¦ä¿®æ”¹å“ªä¸ªåŒºåŸŸï¼Œæ¯•ç«Ÿä¸€ä¸ªæ“ä½œåº”è¯¥æ˜¯å¯¹åº”ä¸€ä¸ªåŒºåŸŸï¼›å¯¹äºè‡ªå®šä¹‰åŒºåŸŸï¼Œæˆ‘ä»¬çš„ElementStatusæ˜¯ä¸ªæšä¸¾ç±»å‹ä¸”ä¸ºå¿…ä¼ ï¼Œè¿™å°±é™åˆ¶äº†è‡ªå®šä¹‰åŒºåŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ”¹é€ ä¸€ä¸‹ï¼Œç”¨æˆ·ä¼ é€’çš„è‡ªå®šä¹‰åŒºåŸŸï¼Œstatusä¸ºè‡ªè¡Œè®¾ç½®çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å†…éƒ¨ä¹ŸåŒæ—¶æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ï¼ˆæ¶‰åŠæ›´æ”¹çš„åœ°æ–¹æœ‰ä¸€äº›ï¼Œè¿™é‡Œä¸åšè¿‡å¤šçš„è¯´æ˜ï¼Œåç»­å¯ä»¥æŸ¥é˜…æºç ï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">å…ƒç´ å½“å‰æ“ä½œçŠ¶æ€</span></span>
<span class="hljs-comment">/// <span class="markdown">æ›´æ”¹æ–°å¢å­—ç¬¦ä¸²çš„valueå±æ€§</span></span>
<span class="hljs-keyword">enum</span> ElementStatus {
  move(value: <span class="hljs-string">'move'</span>),
  rotate(value: <span class="hljs-string">'rotate'</span>),
  scale(value: <span class="hljs-string">'scale'</span>),
  deleteStatus(value: <span class="hljs-string">'deleteStatus'</span>),;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> value;

  <span class="hljs-keyword">const</span> ElementStatus({<span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.value});
}

<span class="hljs-comment">/// <span class="markdown">å¤§è‡´è¯´ä¸€äº›éœ€è¦æ›´æ”¹çš„åœ°æ–¹</span></span>
<span class="hljs-comment">/// <span class="markdown">TemporaryModel çš„ status æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ç±»å‹</span></span>
<span class="hljs-comment">/// <span class="markdown">ResponseAreaModel çš„ status æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ç±»å‹</span></span>
<span class="hljs-comment">/// <span class="markdown"><span class="hljs-emphasis">_onDownZone æ–¹æ³•ä¸­ Records ç¬¬ä¸€é¡¹ä¹Ÿè¿”å› String</span></span></span>
<span class="hljs-comment">/// <span class="markdown"><span class="hljs-emphasis">_</span>getElementZone æ–¹æ³•ä¸­ Records ç¬¬ä¸€é¡¹ä¹Ÿè¿”å› String</span></span>
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¡®å®šè‡ªå®šä¹‰åŒºåŸŸé…ç½®ä¸­éœ€è¦çš„å­—æ®µï¼š</p>
<ul>
<li>statusï¼šç”¨äºæ˜ å°„å†…ç½®çš„åŒºåŸŸï¼Œæ–¹ä¾¿åšæ›´æ”¹ï¼ˆString å¿…é¡»ï¼‰</li>
<li>useï¼šç”¨äºç¡®å®šè¯¥ status å¯¹åº”çš„å†…ç½®åŒºåŸŸæ˜¯å¦ä½¿ç”¨ï¼ˆbool éå¿…é¡»ï¼‰</li>
<li>xRatioï¼šç”¨äºç¡®å®šåŒºåŸŸä½ç½®ï¼ˆdouble éå¿…é¡»ï¼Œå¦‚æœéå†…ç½®çš„é»˜è®¤å°±æ˜¯0ï¼‰</li>
<li>yRatioï¼šç”¨äºç¡®å®šåŒºåŸŸä½ç½®ï¼ˆdouble éå¿…é¡»ï¼Œå¦‚æœéå†…ç½®çš„é»˜è®¤å°±æ˜¯0ï¼‰</li>
<li>triggerï¼šç”¨äºç¡®å®šåŒºåŸŸçš„è§¦å‘æ–¹å¼ï¼ˆTriggerMethod éå¿…é¡»ï¼Œé»˜è®¤TriggerMethod.downï¼‰</li>
<li>iconï¼šç”¨äºç¡®å®šæ“ä½œåŒºåŸŸçš„å±•ç¤ºiconï¼ˆString å¦‚æœæ˜¯å†…ç½®çš„ status å°±æ˜¯éå¿…é¡»ï¼Œå¦‚æœä¸æ˜¯å†…ç½®çš„å°±æ˜¯å¿…é¡»ï¼‰</li>
<li>fnï¼šè‡ªå®šä¹‰åŒºåŸŸéœ€è¦æ‰§è¡Œçš„æ–¹æ³•ï¼ˆFunction({required double x, required double y}) å¦‚æœæ˜¯å†…ç½®çš„å°±æ˜¯éå¿…é¡»ï¼Œå¦‚æœä¸æ˜¯å†…ç½®çš„å°±å¿…é¡»ï¼‰</li>
</ul>
<p>åŸºäºä¸Šè¿°å¼€å§‹è¿›è¡Œç¼–ç ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æ–°å¢è‡ªå®šä¹‰åŒºåŸŸé…ç½®</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomAreaConfig</span> </span>{
  <span class="hljs-keyword">const</span> CustomAreaConfig({
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.status,
    <span class="hljs-keyword">this</span>.use,
    <span class="hljs-keyword">this</span>.xRatio,
    <span class="hljs-keyword">this</span>.yRatio,
    <span class="hljs-keyword">this</span>.trigger = TriggerMethod.down,
    <span class="hljs-keyword">this</span>.icon,
    <span class="hljs-keyword">this</span>.fn,
  });

  <span class="hljs-comment">/// <span class="markdown">åŒºåŸŸçš„æ“ä½œçŠ¶æ€å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯å†…ç½®çš„ï¼Œå¦‚æœæ˜¯å†…ç½®çš„å°±è¦†ç›–å†…ç½®çš„å±æ€§</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> status;
  <span class="hljs-comment">/// <span class="markdown">æ˜¯å¦å¯ç”¨</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool?</span> use;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰ä½ç½®</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double?</span> xRatio;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double?</span> yRatio;
  <span class="hljs-comment">/// <span class="markdown">åŒºåŸŸå“åº”æ“ä½œçš„è§¦å‘æ–¹å¼</span></span>
  <span class="hljs-keyword">final</span> TriggerMethod trigger;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰åŒºåŸŸå°±æ˜¯å¿…ä¼ </span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String?</span> icon;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰åŒºåŸŸå°±æ˜¯å¿…ä¼ ï¼Œç‚¹å‡»å¯¹åº”çš„å“åº”åŒºåŸŸå°±æ‰§è¡Œè‡ªå®šä¹‰çš„æ–¹æ³•</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">Function</span>({<span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x, <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y})? fn;
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æ–°å¢è‡ªå®šä¹‰åŒºåŸŸé…ç½®</span></span>
<span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;CustomAreaConfig&gt; _customAreaList = [
  <span class="hljs-comment">// ä¸ä½¿ç”¨ç¼©æ”¾åŒºåŸŸ</span>
  CustomAreaConfig(
    status: ElementStatus.scale.value,
    use: <span class="hljs-keyword">false</span>,
  ),
  <span class="hljs-comment">// å°†æ—‹è½¬ç§»åˆ°å³ä¸‹è§’</span>
  CustomAreaConfig(
    status: ElementStatus.rotate.value,
    xRatio: <span class="hljs-number">1</span>,
    yRatio: <span class="hljs-number">1</span>,
  ),
];
<span class="hljs-comment">/// <span class="markdown">å®¹å™¨å“åº”æ“ä½œåŒºåŸŸï¼Œä¹‹å‰æ˜¯ç›´æ¥ä½¿ç”¨çš„å¸¸é‡é‡Œé¢çš„é…ç½®</span></span>
<span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; _areaList = [];

<span class="hljs-comment">/// <span class="markdown">åˆå§‹åŒ–å“åº”åŒºåŸŸ</span></span>
<span class="hljs-keyword">void</span> _initArea() {
  <span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; areaList = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> area <span class="hljs-keyword">in</span> ConstantsConfig.baseAreaList) {
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> index = _customAreaList.indexWhere((item) =&gt; item.status == area.status);

    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">final</span> CustomAreaConfig customArea = _customAreaList[index];

      <span class="hljs-comment">// å¦‚æœæ˜¯ä¸ä½¿ç”¨ï¼Œåˆ™è·³å‡ºæœ¬æ¬¡å¾ªç¯</span>
      <span class="hljs-keyword">if</span> (customArea.use == <span class="hljs-keyword">false</span>) {
        <span class="hljs-keyword">continue</span>;
      }

      areaList.add(area.copyWith(
        xRatio: customArea.xRatio,
        yRatio: customArea.yRatio,
        icon: customArea.icon,
        fn: customArea.fn,
      ));
    } <span class="hljs-keyword">else</span> {
      areaList.add(area);
    }
  }

  setState(() {
    _areaList = areaList;
  });
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

<span class="hljs-comment">/// <span class="markdown">æŠ½å–æ¸²æŸ“çš„å…ƒç´ </span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TransformItem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> TransformItem({
    <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.areaList,
  });

  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; areaList;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Positioned(
      left: elementItem.x,
      top: elementItem.y,
      <span class="hljs-comment">// æ–°å¢æ—‹è½¬åŠŸèƒ½</span>
      child: Transform.rotate(
        angle: elementItem.rotationAngle,
        child: Container(
          <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

          <span class="hljs-comment">// æ–°å¢åŒºåŸŸçš„æ¸²æŸ“</span>
          child: selected ? Stack(
            clipBehavior: Clip.none,
            children: [
              <span class="hljs-comment">// ä¿®æ”¹ä»å¤–ç•Œä¼ é€’åŒºåŸŸåˆ—è¡¨</span>
              ...areaList.map((item) =&gt; Positioned(
                <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>
              )),
            ],
          ) : <span class="hljs-keyword">null</span>,
        ),
      )
    );
  }
}
</code></pre>
<p>å…¶ä»–ç¼–ç ä¸ç®—æ ¸å¿ƒï¼Œå°±ä¸å†å±•ç¤ºäº†ï¼Œåæ­£å°±ä¸€ä¸ªï¼Œä¹‹å‰ä» ConstantsConfig.baseAreaList æ‹¿çš„æ•°æ®ç°åœ¨éƒ½ç›´æ¥ä½¿ç”¨ _areaListã€‚</p>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/919333907ca8484ea4ad7b32d225334d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917912&amp;x-signature=8uNMV4cVZOMorlQloFL7GA19lk4%3D" alt="image02.gif" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å°†æ—‹è½¬åŒºåŸŸç§»åˆ°å³ä¸‹è§’äº†ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ç¼©æ”¾åŒºåŸŸï¼Œè¿™æ ·å°±ç®€å•å®Œæˆäº†åŒºåŸŸè‡ªå®šä¹‰çš„é…ç½®ã€‚</p>
<p>æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ã€å‰ç«¯å­¦ä¹ å°è¥åœ°ã€‘ï¼Œä¸å®šæ—¶ä¼šåˆ†äº«ä¸€äº›å°åŠŸèƒ½ï½</p>
<p>ä»Šå¤©çš„åˆ†äº«å°±åˆ°æ­¤ç»“æŸäº†ï¼Œæ„Ÿè°¢é˜…è¯»ï½æ‹œæ‹œï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust çš„CPUå’ŒIOæ“ä½œ]]></title>    <link>https://juejin.cn/post/7585534343562149938</link>    <guid>https://juejin.cn/post/7585534343562149938</guid>    <pubDate>2025-12-21T05:29:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562149938" data-draft-id="7585686247268876297" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust çš„CPUå’ŒIOæ“ä½œ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T05:29:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²æ£®"/> <meta itemprop="url" content="https://juejin.cn/user/4455643804079608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust çš„CPUå’ŒIOæ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4455643804079608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²æ£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T05:29:44.000Z" title="Sun Dec 21 2025 05:29:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">çº¯ CPU â€”â€” å¹¶è¡Œè´¨æ•°å¯»æ‰¾å™¨ (Parallel Prime Finder)</h3>
<p><strong>ç›®æ ‡ï¼š</strong> Â æ‰¾å‡º 1 åˆ° 10,000,000 (ä¸€åƒä¸‡) ä¹‹é—´çš„æ‰€æœ‰è´¨æ•°ã€‚Â <strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong> Â è¿™æ˜¯ä¸€ä¸ªçº¯è®¡ç®—ä»»åŠ¡ã€‚åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯è´¨æ•°ï¼Œéœ€è¦å¤§é‡çš„é™¤æ³•è¿ç®—ï¼ŒCPU å¿…é¡»ä¸€ç›´åœ¨è½¬ã€‚Â <strong>å·¥å…·ï¼š</strong> Â è¿™é‡Œæˆ‘ä»¬<strong>ä¸ç”¨ Tokio</strong>ã€‚å¯¹äºçº¯ CPU ä»»åŠ¡ï¼ŒRust ç¤¾åŒºæœ€å¸¸ç”¨çš„åº“æ˜¯Â <strong><code>Rayon</code></strong>ã€‚å®ƒèƒ½æŠŠä½ çš„Â <code>for</code>Â å¾ªç¯è‡ªåŠ¨å˜æˆå¹¶è¡Œçš„ã€‚</p>
<p><strong>Cargo.toml:</strong></p>
<p>Ini, TOML</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">rayon</span> = <span class="hljs-string">"1.8"</span> 
</code></pre>
<p><strong>main.rs:</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> rayon::prelude::*; <span class="hljs-comment">// å¼•å…¥ Rayon çš„å¹¶è¡Œè¿­ä»£å™¨åŠŸèƒ½</span>

<span class="hljs-comment">// ä¸€ä¸ªéå¸¸ç¬¨é‡ã€è€—è´¹ CPU çš„å‡½æ•°ï¼šåˆ¤æ–­ n æ˜¯å¦ä¸ºè´¨æ•°</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">is_prime</span>(n: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">if</span> n &lt;= <span class="hljs-number">1</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
    <span class="hljs-comment">// ç¬¨åŠæ³•ï¼šä» 2 éå†åˆ° sqrt(n)ï¼Œç–¯ç‹‚åšé™¤æ³•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">limit</span> = (n <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>).<span class="hljs-title function_ invoke__">sqrt</span>() <span class="hljs-keyword">as</span> <span class="hljs-type">u32</span>;
    <span class="hljs-keyword">for</span> <span class="hljs-variable">i</span> <span class="hljs-keyword">in</span> <span class="hljs-number">2</span>..=limit {
        <span class="hljs-keyword">if</span> n % i == <span class="hljs-number">0</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-literal">true</span>
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">limit</span> = <span class="hljs-number">10_000_000</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- å¼€å§‹å¯»æ‰¾ 1 åˆ° {} ä¹‹é—´çš„è´¨æ•° ---"</span>, limit);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start_time</span> = std::time::Instant::<span class="hljs-title function_ invoke__">now</span>();

    <span class="hljs-comment">// æ–¹å¼ A: å•çº¿ç¨‹å†™æ³• (å¯¹æ¯”ç»„)</span>
    <span class="hljs-comment">// åªè¦æŠŠä¸‹é¢çš„ par_iter() æ”¹æˆ iter() å°±æ˜¯å•çº¿ç¨‹</span>
    <span class="hljs-comment">// let count = (1..limit).filter(|&amp;n| is_prime(n)).count();</span>

    <span class="hljs-comment">// æ–¹å¼ B: å¹¶è¡Œå†™æ³• (Rayon)</span>
    <span class="hljs-comment">// par_iter() ä¼šè‡ªåŠ¨æŠŠ 1..limit åˆ‡æˆå¥½å‡ å—ï¼Œåˆ†å‘ç»™æ‰€æœ‰çš„ CPU æ ¸</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">count</span> = (<span class="hljs-number">1</span>..limit)
        .<span class="hljs-title function_ invoke__">into_par_iter</span>() <span class="hljs-comment">// &lt;--- é­”æ³•åœ¨è¿™é‡Œï¼å˜æˆå¹¶è¡Œè¿­ä»£å™¨</span>
        .<span class="hljs-title function_ invoke__">filter</span>(|&amp;n| <span class="hljs-title function_ invoke__">is_prime</span>(n)) <span class="hljs-comment">// è¿™ä¼šåœ¨å¤šä¸ªæ ¸ä¸ŠåŒæ—¶è·‘</span>
        .<span class="hljs-title function_ invoke__">count</span>();

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰¾åˆ° {} ä¸ªè´¨æ•°"</span>, count);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- è®¡ç®—ç»“æŸï¼Œè€—æ—¶: {:?} ---"</span>, start_time.<span class="hljs-title function_ invoke__">elapsed</span>());
}
</code></pre>
<p><strong>ç»ƒä¹ é‡ç‚¹ï¼š</strong></p>
<ol>
<li>
<p><strong>è§‚å¯Ÿ CPUï¼š</strong> Â è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œæ‰“å¼€ä½ çš„ä»»åŠ¡ç®¡ç†å™¨/æ´»åŠ¨ç›‘è§†å™¨ã€‚ä½ ä¼šçœ‹åˆ° CPU å ç”¨ç‡ç¬é—´é£™å‡åˆ° 100%ï¼ˆæ‰€æœ‰æ ¸éƒ½è¢«åƒæ»¡äº†ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯¹æ¯”è¯•éªŒï¼š</strong> Â è¯•ç€æŠŠÂ <code>.into_par_iter()</code>Â æ”¹å›æ™®é€šçš„Â <code>.into_iter()</code>ã€‚</p>
<ul>
<li><strong>å¹¶è¡Œç‰ˆï¼š</strong> Â å¯èƒ½åªè¦ 1-2 ç§’ï¼ˆå–å†³äºä½ çš„æ ¸æ•°ï¼‰ã€‚</li>
<li><strong>å•çº¿ç¨‹ç‰ˆï¼š</strong> Â å¯èƒ½éœ€è¦ 5-8 ç§’ã€‚</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2882d6c1cddf4a63bdf3659c3d5cb5f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=qbDWERjXdN9FOPjni8N%2FDMdEG4I%3D" alt="8939d65c92a156e0b5e8a1b94ae6908e.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db4eebb2ecc74979a4297e16b0c73f93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=OXQRF516Hd6jEqlQht%2BLNVm5wV8%3D" alt="0be753bfd229fe6d3bac6a63e6febe04.jpg" loading="lazy"/></p>
<h2 data-id="heading-1">ç£ç›˜ I/O æ˜¯<strong>å®æ‰“å®èƒ½çœ‹åˆ°ç¡¬ç›˜è¯»å†™é£™å‡</strong>çš„ã€‚</h2>
<p>æˆ‘ä»¬æ¥åšä¸€ä¸ªÂ  <strong>â€œæé€Ÿæ–‡ä»¶å¤‡ä»½å¼•æ“â€ (Async File Replicator)</strong> ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒç›®æ ‡</h3>
<ol>
<li><strong>åœºæ™¯ï¼š</strong> Â æ¨¡æ‹Ÿä½ æœ‰ä¸€å †å·¨å¤§çš„æ—¥å¿—æ–‡ä»¶ï¼ˆæ¯”å¦‚ 50 ä¸ª 100MB çš„æ–‡ä»¶ï¼‰ï¼Œéœ€è¦ä» A æ–‡ä»¶å¤¹å¤‡ä»½åˆ° B æ–‡ä»¶å¤¹ã€‚</li>
<li><strong>æŒ‘æˆ˜ï¼š</strong> Â ä¹Ÿå°±æ˜¯é€šå¸¸è¯´çš„â€œæ‹·è´æ–‡ä»¶â€ã€‚å¦‚æœæ˜¯å•çº¿ç¨‹ï¼Œæ˜¯ä¸€ä¸ªä¸ªæ‹·ï¼›æˆ‘ä»¬è¦ç”¨Â <code>tokio</code>Â å¹¶å‘æ‹·ï¼Œçœ‹èƒ½ä¸èƒ½æŠŠä½ çš„ SSD ååé‡æ‰“æ»¡ã€‚</li>
<li><strong>è§‚æµ‹ï¼š</strong> Â æ•™ä½ å¦‚ä½•ç”¨ç³»ç»Ÿå·¥å…·ç›‘æ§è¿™ä¸ªè¿‡ç¨‹ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šå…ˆå­¦ä¼šâ€œçœ‹â€ I/O (ç›‘æ§å·¥å…·)</h3>
<p>åœ¨è·‘ä»£ç ä¹‹å‰ï¼Œå…ˆæŠŠç›‘æ§é¢æ¿æ‰“å¼€ï¼Œè¿™æ ·ä»£ç ä¸€è·‘ï¼Œä½ å°±èƒ½çœ‹åˆ°æ³¢å½¢å›¾è·³èµ·æ¥ã€‚</p>
<h4 data-id="heading-4">1. Windows ç”¨æˆ·</h4>
<ul>
<li><strong>åŸºç¡€ç‰ˆï¼š</strong> Â æ‰“å¼€Â <strong>ä»»åŠ¡ç®¡ç†å™¨ (Task Manager)</strong> Â -&gt;Â <strong>æ€§èƒ½ (Performance)</strong> Â -&gt; ç‚¹å‡»Â <strong>ç£ç›˜ (Disk)</strong> ã€‚å…³æ³¨Â  <strong>â€œæ´»åŠ¨æ—¶é—´ (Active time)â€</strong> Â å’ŒÂ  <strong>â€œç£ç›˜ä¼ è¾“é€Ÿç‡ (Transfer Rate)â€</strong> ã€‚</li>
<li><strong>è¿›é˜¶ç‰ˆ (æ¨è)ï¼š</strong> Â Win + R è¾“å…¥Â <code>resmon</code>Â æ‰“å¼€Â <strong>èµ„æºç›‘è§†å™¨</strong>ã€‚ç‚¹å‡»Â <strong>ç£ç›˜</strong>Â é€‰é¡¹å¡ã€‚è¿™é‡Œèƒ½çœ‹åˆ°å…·ä½“æ˜¯å“ªä¸ªÂ <code>exe</code>Â åœ¨è¯»å†™ï¼Œä»¥åŠè¯»å†™äº†å“ªä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<h4 data-id="heading-5">2. macOS ç”¨æˆ·</h4>
<ul>
<li>æ‰“å¼€Â <strong>æ´»åŠ¨ç›‘è§†å™¨ (Activity Monitor)</strong> Â (Cmd + Space æœç´¢ Activity Monitor)ã€‚</li>
<li>ç‚¹å‡»åº•éƒ¨çš„Â  <strong>â€œç£ç›˜ (Disk)â€</strong> Â æ ‡ç­¾é¡µã€‚</li>
<li>å…³æ³¨åº•éƒ¨çš„Â  <strong>â€œæ•°æ®è¯»å–/ç§’ (Data read/sec)â€</strong> Â å’ŒÂ  <strong>â€œæ•°æ®å†™å…¥/ç§’ (Data written/sec)â€</strong> ã€‚ä½ ä¼šçœ‹åˆ°è¿™ä¸¤ä¸ªæ•°å­—ç¬é—´é£™å‡ã€‚</li>
</ul>
<h4 data-id="heading-6">3. Linux ç”¨æˆ·</h4>
<ul>
<li>åœ¨ç»ˆç«¯è¾“å…¥Â <code>iotop</code>Â (éœ€è¦ sudo)ã€‚ä½ ä¼šçœ‹åˆ°å®æ—¶çš„ç£ç›˜ I/O æ’è¡Œæ¦œã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šé¡¹ç›®ä»£ç  â€”â€” æé€Ÿå¤‡ä»½å¼•æ“</h3>
<p>è¿™ä¸ªé¡¹ç›®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li><strong>ç”Ÿæˆå™¨ï¼š</strong> Â å¿«é€Ÿç”Ÿæˆä¸€å †åƒåœ¾æ–‡ä»¶ç”¨æ¥æµ‹è¯•ã€‚</li>
<li><strong>å¤‡ä»½å™¨ï¼š</strong> Â ä½¿ç”¨ Tokio å¹¶å‘å¤åˆ¶ã€‚</li>
</ol>
<p><strong>Cargo.toml:</strong></p>
<p>Ini, TOML</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"full"</span>] }
<span class="hljs-attr">rand</span> = <span class="hljs-string">"0.8"</span> <span class="hljs-comment"># ç”¨æ¥ç”Ÿæˆéšæœºæ–‡ä»¶åæˆ–å†…å®¹ï¼ˆå¯é€‰ï¼Œè¿™é‡Œå…¶å®åªç”¨0å¡«å……ä¹Ÿè¡Œï¼‰</span>
</code></pre>
<p><strong>main.rs:</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::path::Path;
<span class="hljs-keyword">use</span> tokio::fs;
<span class="hljs-keyword">use</span> tokio::io::AsyncWriteExt;
<span class="hljs-keyword">use</span> tokio::time::Instant;
<span class="hljs-keyword">use</span> std::sync::Arc;
<span class="hljs-keyword">use</span> tokio::sync::Semaphore;

<span class="hljs-comment">// è®¾å®šæµ‹è¯•è§„æ¨¡</span>
<span class="hljs-keyword">const</span> FILE_COUNT: <span class="hljs-type">usize</span> = <span class="hljs-number">20</span>;       <span class="hljs-comment">// æ–‡ä»¶æ•°é‡</span>
<span class="hljs-keyword">const</span> FILE_SIZE_MB: <span class="hljs-type">usize</span> = <span class="hljs-number">50</span>;     <span class="hljs-comment">// æ¯ä¸ªæ–‡ä»¶ 50MB (æ€»å…± 1GB)</span>
<span class="hljs-keyword">const</span> SOURCE_DIR: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"./source_data"</span>;
<span class="hljs-keyword">const</span> TARGET_DIR: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"./backup_data"</span>;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; {
    <span class="hljs-comment">// --- å‡†å¤‡å·¥ä½œ ---</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- é˜¶æ®µ 1: å‡†å¤‡æµ‹è¯•æ•°æ® ---"</span>);
    <span class="hljs-title function_ invoke__">prepare_directories</span>().<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">generate_dummy_files</span>().<span class="hljs-keyword">await</span>?;

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"\nè¯·ç°åœ¨æ‰“å¼€ä½ çš„ã€æ´»åŠ¨ç›‘è§†å™¨/ä»»åŠ¡ç®¡ç†å™¨/iotopã€‘... 3ç§’åå¼€å§‹ç–¯ç‹‚æ‹·è´"</span>);
    tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(tokio::time::Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">3</span>)).<span class="hljs-keyword">await</span>;

    <span class="hljs-comment">// --- æ ¸å¿ƒå·¥ä½œ: å¼‚æ­¥å¹¶å‘æ‹·è´ ---</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- é˜¶æ®µ 2: å¼€å§‹æé€Ÿå¤‡ä»½ ---"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start</span> = Instant::<span class="hljs-title function_ invoke__">now</span>();

    <span class="hljs-comment">// é™åˆ¶å¹¶å‘æ•°ï¼šè™½ç„¶æ˜¯ I/Oï¼Œä½†å¦‚æœä¸é™åˆ¶ï¼Œç¬é—´æ‰“å¼€å‡ åƒä¸ªæ–‡ä»¶å¥æŸ„ä¼šæŠ¥é”™</span>
    <span class="hljs-comment">// åŒæ—¶ä¹Ÿä¸ºäº†è§‚å¯ŸæŒç»­çš„ I/O å‹åŠ›ï¼Œè€Œä¸æ˜¯ä¸€ç¬é—´ç»“æŸ</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">semaphore</span> = Arc::<span class="hljs-title function_ invoke__">new</span>(Semaphore::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">5</span>)); 
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">tasks</span> = <span class="hljs-built_in">vec!</span>[];

    <span class="hljs-comment">// è¯»å–æºç›®å½•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">entries</span> = fs::<span class="hljs-title function_ invoke__">read_dir</span>(SOURCE_DIR).<span class="hljs-keyword">await</span>?;

    <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(entry) = entries.<span class="hljs-title function_ invoke__">next_entry</span>().<span class="hljs-keyword">await</span>? {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">path</span> = entry.<span class="hljs-title function_ invoke__">path</span>();
        <span class="hljs-keyword">if</span> path.<span class="hljs-title function_ invoke__">is_file</span>() {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sem_clone</span> = semaphore.<span class="hljs-title function_ invoke__">clone</span>();
            
            <span class="hljs-comment">// å¼€å¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å»æ‹·è´è¿™ä¸ªæ–‡ä»¶</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">task</span> = tokio::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
                <span class="hljs-comment">// è·å–ä»¤ç‰Œ</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_permit</span> = sem_clone.<span class="hljs-title function_ invoke__">acquire</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();
                
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">file_name</span> = path.<span class="hljs-title function_ invoke__">file_name</span>().<span class="hljs-title function_ invoke__">unwrap</span>().<span class="hljs-title function_ invoke__">to_str</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">target_path</span> = Path::<span class="hljs-title function_ invoke__">new</span>(TARGET_DIR).<span class="hljs-title function_ invoke__">join</span>(file_name);

                <span class="hljs-comment">// âš ï¸ æ ¸å¿ƒ I/O æ“ä½œï¼štokio::fs::copy</span>
                <span class="hljs-comment">// è¿™è¡Œä»£ç åº•å±‚ä¼šåˆ©ç”¨ OS çš„å¼‚æ­¥æ–‡ä»¶æ¥å£</span>
                <span class="hljs-keyword">match</span> fs::<span class="hljs-title function_ invoke__">copy</span>(&amp;path, &amp;target_path).<span class="hljs-keyword">await</span> {
                    <span class="hljs-title function_ invoke__">Ok</span>(bytes) =&gt; {
                        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"âœ… å·²å¤‡ä»½: {} ({:.2} MB)"</span>, file_name, bytes <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span> / <span class="hljs-number">1024.0</span> / <span class="hljs-number">1024.0</span>);
                    }
                    <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; eprintln!(<span class="hljs-string">"âŒ å¤±è´¥ {}: {}"</span>, file_name, e),
                }
                <span class="hljs-comment">// ä»¤ç‰Œè‡ªåŠ¨é‡Šæ”¾</span>
            });
            tasks.<span class="hljs-title function_ invoke__">push</span>(task);
        }
    }

    <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰æ‹·è´ä»»åŠ¡å®Œæˆ</span>
    <span class="hljs-keyword">for</span> <span class="hljs-variable">task</span> <span class="hljs-keyword">in</span> tasks {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_</span> = task.<span class="hljs-keyword">await</span>;
    }

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">duration</span> = start.<span class="hljs-title function_ invoke__">elapsed</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">total_size_mb</span> = (FILE_COUNT * FILE_SIZE_MB) <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">speed</span> = total_size_mb / duration.<span class="hljs-title function_ invoke__">as_secs_f64</span>();

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"\n--- å¤‡ä»½å®Œæˆ ---"</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è€—æ—¶: {:.2?}"</span>, duration);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¹³å‡ååé‡: {:.2} MB/s"</span>, speed);
    
    <span class="hljs-comment">// æ¸…ç†ç°åœºï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-comment">// fs::remove_dir_all(SOURCE_DIR).await?;</span>
    <span class="hljs-comment">// fs::remove_dir_all(TARGET_DIR).await?;</span>

    <span class="hljs-title function_ invoke__">Ok</span>(())
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šç”Ÿæˆåƒåœ¾æ–‡ä»¶</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">generate_dummy_files</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª å…¨æ˜¯ 0 çš„ 50MB ç¼“å†²åŒº</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">buffer</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0u8</span>; FILE_SIZE_MB * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>];

    <span class="hljs-keyword">for</span> <span class="hljs-variable">i</span> <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..FILE_COUNT {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">file_path</span> = Path::<span class="hljs-title function_ invoke__">new</span>(SOURCE_DIR).<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"log_{}.dat"</span>, i));
        <span class="hljs-keyword">if</span> !file_path.<span class="hljs-title function_ invoke__">exists</span>() {
            <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç”Ÿæˆæµ‹è¯•æ–‡ä»¶: log_{}.dat ..."</span>, i);
            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">file</span> = fs::File::<span class="hljs-title function_ invoke__">create</span>(file_path).<span class="hljs-keyword">await</span>?;
            file.<span class="hljs-title function_ invoke__">write_all</span>(&amp;buffer).<span class="hljs-keyword">await</span>?;
        }
    }
    <span class="hljs-title function_ invoke__">Ok</span>(())
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šåˆ›å»ºç›®å½•</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">prepare_directories</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-keyword">if</span> !Path::<span class="hljs-title function_ invoke__">new</span>(SOURCE_DIR).<span class="hljs-title function_ invoke__">exists</span>() {
        fs::<span class="hljs-title function_ invoke__">create_dir</span>(SOURCE_DIR).<span class="hljs-keyword">await</span>?;
    }
    <span class="hljs-keyword">if</span> Path::<span class="hljs-title function_ invoke__">new</span>(TARGET_DIR).<span class="hljs-title function_ invoke__">exists</span>() {
        fs::<span class="hljs-title function_ invoke__">remove_dir_all</span>(TARGET_DIR).<span class="hljs-keyword">await</span>?;
    }
    fs::<span class="hljs-title function_ invoke__">create_dir</span>(TARGET_DIR).<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ee40f4912764679a82ee919d0289abd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=8LhsYkw3gwAGB3chTJX0gwA%2FAMM%3D" alt="69632d5619c1d1413d2d3a8d3f0a7618.jpg" loading="lazy"/></p>
<ol>
<li>
<p><strong>æ–‡ä»¶ç³»ç»Ÿçš„ Async I/O:</strong></p>
<ul>
<li><code>tokio::fs</code>Â æ¨¡å—é‡Œçš„ API (<code>read_dir</code>,Â <code>copy</code>,Â <code>File::create</code>) å’Œæ ‡å‡†åº“Â <code>std::fs</code>Â é•¿å¾—å‡ ä¹ä¸€æ ·ï¼Œä½†å®ƒä»¬å…¨æ˜¯Â <strong>éé˜»å¡</strong>Â çš„ã€‚</li>
<li>å½“ä½ è°ƒç”¨Â <code>fs::copy</code>Â æ—¶ï¼Œå¦‚æœç¡¬ç›˜å¿™ä¸è¿‡æ¥ï¼ŒTokio çº¿ç¨‹ä¼šå»å¤„ç†åˆ«çš„ä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¹²ç­‰ç€ã€‚</li>
</ul>
</li>
<li>
<p><strong>è§‚å¯Ÿç³»ç»Ÿç“¶é¢ˆ:</strong></p>
<ul>
<li>å½“ä½ è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œç›¯ç€ä½ çš„ä»»åŠ¡ç®¡ç†å™¨ã€‚</li>
<li><strong>å¦‚æœæ˜¯æœºæ¢°ç¡¬ç›˜ (HDD):</strong> Â ä½ çš„ååé‡å¯èƒ½åªæœ‰ 100MB/sï¼Œè€Œä¸”ä½ ä¼šå¬åˆ°ç¡¬ç›˜ç–¯ç‹‚å¯»é“çš„å£°éŸ³ï¼ˆç£å¤´åœ¨æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶ä¹‹é—´æ¥å›è·³ï¼‰ã€‚</li>
<li><strong>å¦‚æœæ˜¯å›ºæ€ç¡¬ç›˜ (NVMe SSD):</strong> Â ä½ å¯èƒ½ä¼šçœ‹åˆ° 1GB/s - 2GB/s çš„æƒŠäººé€Ÿåº¦ï¼Œç¬é—´è·‘å®Œã€‚</li>
</ul>
</li>
<li>
<p><strong>å¹¶å‘æ§åˆ¶ (Semaphore) çš„é‡è¦æ€§:</strong></p>
<ul>
<li>è¯•ç€æŠŠÂ <code>Semaphore::new(5)</code>Â æ”¹æˆÂ <code>Semaphore::new(100)</code>ã€‚</li>
<li>å¦‚æœåœ¨æœºæ¢°ç¡¬ç›˜ä¸Šï¼Œé€Ÿåº¦<strong>åè€Œä¼šå˜æ…¢</strong>ã€‚å› ä¸ºç£å¤´æ¥å›è·³è·ƒï¼ˆéšæœºè¯»å†™ï¼‰çš„å¼€é”€å¤ªå¤§äº†ï¼Œä¸å¦‚æ’é˜Ÿé¡ºåºè¯»å†™ï¼ˆé¡ºåº I/Oï¼‰å¿«ã€‚</li>
<li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä¾¿ç”¨äº†å¼‚æ­¥ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦<strong>é™æµ</strong>ã€‚</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„]]></title>    <link>https://juejin.cn/post/7585412203979030571</link>    <guid>https://juejin.cn/post/7585412203979030571</guid>    <pubDate>2025-12-20T09:51:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585412203979030571" data-draft-id="7585397173023195155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Go,åç«¯"/> <meta itemprop="datePublished" content="2025-12-20T09:51:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹ä¸­é˜³è®²AIç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2189882892232029"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2189882892232029/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹ä¸­é˜³è®²AIç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T09:51:17.000Z" title="Sat Dec 20 2025 09:51:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,æ€æºé»‘ä½“ CN,æ€æºé»‘ä½“,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><blockquote>
<p>å£°æ˜ï¼šæœ¬AIåº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹é¦–å‘åœ¨åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5DYsyMKh9cDJdVvs_Mn9_Q" target="_blank" title="https://mp.weixin.qq.com/s/5DYsyMKh9cDJdVvs_Mn9_Q" ref="nofollow noopener noreferrer">ç‹ä¸­é˜³</a>ï¼Œæœªç»æˆæƒç¦æ­¢è½¬è½½ã€‚</p>
</blockquote>
<p>Go-Eino Interview Agent å¹³å°ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„å®ç°äº†ä¸€ä¸ªå¼‚æ­¥å¤„ç†ç³»ç»Ÿï¼Œæ—¨åœ¨å¤„ç†è¯„ä¼°æŠ¥å‘Šç”Ÿæˆå’Œä¸»é¢˜è¯„ä¼°ä»»åŠ¡ã€‚è¯¥æ¶æ„æä¾›å¯é çš„æ¶ˆæ¯ä¼ é€’ã€å¯æ‰©å±•çš„å¤„ç†èƒ½åŠ›ä»¥åŠçµæ´»çš„åç«¯å®ç°ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ¶æ„æ¦‚è¿°</h2>
<p>æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿé‡‡ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ”¯æŒå¯æ’æ‹”çš„åç«¯å®ç°ã€‚å®ƒæ—¢æ”¯æŒç”¨äºå¼€å‘/æµ‹è¯•çš„å†…å­˜é˜Ÿåˆ—ï¼Œä¹Ÿæ”¯æŒç”¨äºç”Ÿäº§ç¯å¢ƒçš„ Redis é˜Ÿåˆ—ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5570ebf622a74be6ab42619e23940e10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Lit6Ziz6K6yQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766829077&amp;x-signature=oJG%2F4tAgZA7VWroKdDqXnfdnXbk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">æ¶ˆæ¯é˜Ÿåˆ—æ¥å£è®¾è®¡</h2>
<p>ç³»ç»Ÿé€šè¿‡Â <code>MessageQueue</code>Â æ¥å£Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L40-L48" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L40-L48" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L40-L48</a>Â å®šä¹‰äº†æ¸…æ™°çš„æŠ½è±¡ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> MessageQueue <span class="hljs-keyword">interface</span> {
    Publish(ctx context.Context, message *Message) <span class="hljs-type">error</span>
    Subscribe(ctx context.Context, handler MessageHandler) <span class="hljs-type">error</span>
    Close() <span class="hljs-type">error</span>
}
</code></pre>
<p>è¯¥æ¥å£å®ç°äº†ä¸åŒé˜Ÿåˆ—å®ç°ä¹‹é—´çš„æ— ç¼åˆ‡æ¢ï¼ŒåŒæ—¶ä¿æŒæ•´ä¸ªåº”ç”¨ç¨‹åºçš„è¡Œä¸ºä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-2">æ¶ˆæ¯ç±»å‹å’Œç»“æ„</h2>
<p>ç³»ç»Ÿæ”¯æŒä¸¤ç§ä¸»è¦æ¶ˆæ¯ç±»å‹Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L12-L20" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L12-L20" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L12-L20</a>ï¼š</p>




















<table><thead><tr><th>æ¶ˆæ¯ç±»å‹</th><th>ç”¨é€”</th><th>è´Ÿè½½ç»“æ„</th></tr></thead><tbody><tr><td><code>evaluation_report</code></td><td>ç”Ÿæˆç»¼åˆè¯„ä¼°æŠ¥å‘Š</td><td><code>EvaluationReportPayload{UserID, ReportID}</code></td></tr><tr><td><code>topic_evaluation</code></td><td>å¤„ç†ç‰¹å®šä¸»é¢˜è¯„ä¼°</td><td><code>TopicEvaluationPayload{UserID, ReportID}</code></td></tr></tbody></table>
<p>æ¯æ¡æ¶ˆæ¯éµå¾ªæ ‡å‡†åŒ–ç»“æ„Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L22-L27" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L22-L27" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L22-L27</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Message <span class="hljs-keyword">struct</span> {
    Type    MessageType            <span class="hljs-string">`json:"type"`</span>
    Payload <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{} <span class="hljs-string">`json:"payload"`</span>
}
</code></pre>
<h2 data-id="heading-3">å®ç°ç­–ç•¥</h2>
<h3 data-id="heading-4">å†…å­˜é˜Ÿåˆ—å®ç°</h3>
<p><code>InMemoryQueue</code>Â ä¸ºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒæä¾›äº†è½»é‡çº§è§£å†³æ–¹æ¡ˆÂ <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L53-L125" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L53-L125" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L53-L125</a>ã€‚ä¸»è¦ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>ç¼“å†²åŒºç®¡ç†</strong>ï¼šå¯é…ç½®çš„ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤ä¸º 100 æ¡æ¶ˆæ¯</li>
<li><strong>å¹¶å‘å¤„ç†</strong>ï¼šå¤šä¸ªå¤„ç†å™¨å¼‚æ­¥å¤„ç†æ¶ˆæ¯</li>
<li><strong>ä¼˜é›…å…³é—­</strong>ï¼šæ­£ç¡®æ¸…ç†é€šé“å’Œ goroutine</li>
</ul>
<p>å†…å­˜å®ç°ä½¿ç”¨ç¼“å†²é€šé“é˜²æ­¢é«˜é¢‘æ¶ˆæ¯å‘å¸ƒæ—¶çš„é˜»å¡ï¼Œè€ŒåŸºäº goroutine çš„å¤„ç†ç¡®ä¿äº†éé˜»å¡çš„æ¶ˆæ¯å¤„ç†ã€‚</p>
<h3 data-id="heading-5">Redis é˜Ÿåˆ—å®ç°</h3>
<p>å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œ<code>RedisQueue</code>Â åˆ©ç”¨ Redis Pub/Sub å®ç°åˆ†å¸ƒå¼æ¶ˆæ¯å¤„ç†Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fredis_queue.go%23L13-L132" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/redis_queue.go#L13-L132" ref="nofollow noopener noreferrer">backend/internal/mq/redis_queue.go#L13-L132</a>ï¼š</p>
<p><strong>ä¸»è¦ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>åŸºäºé€šé“çš„è·¯ç”±</strong>ï¼šæ¶ˆæ¯æ ¹æ®ç±»å‹è·¯ç”±åˆ°ç‰¹å®šé€šé“</li>
<li><strong>å¤šä¸ªè®¢é˜…è€…</strong>ï¼šæ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…å®ä¾‹</li>
<li><strong>æŒä¹…è¿æ¥</strong>ï¼šé€šè¿‡æ­£ç¡®æ¸…ç†ç»´æŒç¨³å®šçš„ Redis è¿æ¥</li>
</ul>
<h2 data-id="heading-6">æ¶ˆè´¹è€…å¤„ç†æ¶æ„</h2>
<p>æ¶ˆè´¹è€…ç³»ç»Ÿé€šè¿‡Â <code>ConsumerHandler</code>Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L10-L89" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L10-L89" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L10-L89</a>Â å®ç°äº†å¥å£®çš„æ¶ˆæ¯å¤„ç†ç®¡é“ï¼š</p>
<h3 data-id="heading-7">æ¶ˆæ¯å¤„ç†æµç¨‹</h3>
<ol>
<li><strong>æ¶ˆæ¯è·¯ç”±</strong>ï¼šä½¿ç”¨ switch è¯­å¥æ ¹æ®ç±»å‹è·¯ç”±æ¶ˆæ¯</li>
<li><strong>è´Ÿè½½éªŒè¯</strong>ï¼šä»è´Ÿè½½ä¸­ç±»å‹å®‰å…¨åœ°æå– userID å’Œ reportID</li>
<li><strong>æœåŠ¡é›†æˆ</strong>ï¼šè°ƒç”¨è¯„ä¼°æœåŠ¡è¿›è¡Œå®é™…å¤„ç†</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå…¨é¢çš„æ—¥å¿—è®°å½•å’Œé”™è¯¯ä¼ æ’­</li>
</ol>
<h3 data-id="heading-8">è¯„ä¼°æœåŠ¡é›†æˆ</h3>
<p>æ¶ˆè´¹è€…ä¸ä¸¤ä¸ªå…³é”®è¯„ä¼°æœåŠ¡é›†æˆï¼š</p>
<ul>
<li><strong>GenerateRecordEvaluation</strong>ï¼šç”Ÿæˆç»¼åˆé¢è¯•è¯„ä¼°Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L42" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L42" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L42</a></li>
<li><strong>GenerateAnswerRecordEvaluation</strong>ï¼šå¤„ç†ä¸»é¢˜ç‰¹å®šè¯„ä¼°Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L71" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L71" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L71</a></li>
</ul>
<h2 data-id="heading-9">åˆå§‹åŒ–å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</h2>
<p>ç³»ç»Ÿåœ¨ä¸»åº”ç”¨ç¨‹åºä¸­å®ç°äº†æ­£ç¡®çš„åˆå§‹åŒ–æ¨¡å¼Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Fmain.go%23L79-L95" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/main.go#L79-L95" ref="nofollow noopener noreferrer">backend/main.go#L79-L95</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆå§‹åŒ– Redis æ¶ˆæ¯é˜Ÿåˆ—</span>
messageQueue := mq.NewRedisQueue(redisClient)
mq.InitMessageQueue(messageQueue)
 
<span class="hljs-comment">// åœ¨å•ç‹¬çš„ goroutine ä¸­å¯åŠ¨æ¶ˆè´¹è€…</span>
<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> err := mq.StartConsumer(consumerCtx); err != <span class="hljs-literal">nil</span> {
        log.Printf(<span class="hljs-string">"Error starting consumer: %v"</span>, err)
    }
}()
</code></pre>
<p>æ¶ˆè´¹è€…åœ¨å•ç‹¬çš„ goroutine ä¸­è¿è¡Œï¼Œä½¿ç”¨å¯å–æ¶ˆçš„ä¸Šä¸‹æ–‡ï¼Œåœ¨åº”ç”¨ç¨‹åºç»ˆæ­¢æ—¶å®ç°ä¼˜é›…å…³é—­å’Œæ­£ç¡®çš„èµ„æºæ¸…ç†ã€‚</p>
<h2 data-id="heading-10">å‘å¸ƒæ¨¡å¼</h2>
<p>ç³»ç»Ÿæä¾›äº†ä¾¿æ·çš„å‘å¸ƒå‡½æ•°ï¼ŒæŠ½è±¡äº†é˜Ÿåˆ—å®ç°ç»†èŠ‚ï¼š</p>
<h3 data-id="heading-11">è¯„ä¼°æŠ¥å‘Šå‘å¸ƒ</h3>
<p><code>PublishEvaluationReport</code>Â å‡½æ•°å¤„ç†å®Œæ•´çš„å‘å¸ƒå·¥ä½œæµÂ <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L155-L186" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L155-L186" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L155-L186</a>ï¼š</p>
<ol>
<li><strong>è´Ÿè½½æ„å»º</strong>ï¼šåˆ›å»ºç±»å‹åŒ–è´Ÿè½½ç»“æ„</li>
<li><strong>åºåˆ—åŒ–</strong>ï¼šè½¬æ¢ä¸º JSON ç„¶åè½¬æ¢ä¸ºé€šç”¨æ˜ å°„</li>
<li><strong>æ¶ˆæ¯åˆ›å»º</strong>ï¼šåŒ…è£…åœ¨æ ‡å‡† Message ç»“æ„ä¸­</li>
<li><strong>é˜Ÿåˆ—å‘å¸ƒ</strong>ï¼šé€šè¿‡å…¨å±€æ¶ˆæ¯é˜Ÿåˆ—å®ä¾‹è·¯ç”±</li>
</ol>
<h3 data-id="heading-12">ä¸»é¢˜è¯„ä¼°å‘å¸ƒ</h3>
<p>ç±»ä¼¼åœ°ï¼Œ<code>PublishTopicEvaluation</code>Â ä¸ºä¸»é¢˜è¯„ä¼°æ¶ˆæ¯æä¾›äº†ä¸“é—¨çš„æ¥å£Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L188-L209" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L188-L209" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L188-L209</a>ã€‚</p>
<h2 data-id="heading-13">é”™è¯¯å¤„ç†å’Œç›‘æ§</h2>
<p>ç³»ç»Ÿåœ¨æ•´ä¸ªæ¶ˆæ¯ç®¡é“ä¸­å®ç°äº†å…¨é¢çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•ï¼š</p>
<ul>
<li><strong>å‘å¸ƒæ—¶éªŒè¯</strong>ï¼šæ£€æŸ¥é˜Ÿåˆ—å¯ç”¨æ€§å’Œåºåˆ—åŒ–é”™è¯¯</li>
<li><strong>æ¶ˆè´¹è€…é”™è¯¯éš”ç¦»</strong>ï¼šå•ä¸ªæ¶ˆæ¯å¤„ç†å¤±è´¥ä¸å½±å“å…¶ä»–æ¶ˆæ¯</li>
<li><strong>è¯¦ç»†æ—¥å¿—</strong>ï¼šåœ¨æ¶ˆæ¯å¤„ç†çš„æ¯ä¸ªé˜¶æ®µè¿›è¡Œå…¨é¢æ—¥å¿—è®°å½•</li>
<li><strong>ä¼˜é›…é™çº§</strong>ï¼šå¦‚æœ Redis ä¸å¯ç”¨åˆ™å›é€€åˆ°å†…å­˜é˜Ÿåˆ—</li>
</ul>
<h2 data-id="heading-14">æ€§èƒ½è€ƒè™‘</h2>
<h3 data-id="heading-15">å¹¶å‘å¤„ç†</h3>
<p>ä¸¤ç§å®ç°éƒ½é€šè¿‡åŸºäº goroutine çš„å¤„ç†å™¨æ‰§è¡Œæ”¯æŒå¹¶å‘æ¶ˆæ¯å¤„ç†Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L108-L113" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L108-L113" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L108-L113</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">for</span> _, handler := <span class="hljs-keyword">range</span> q.handlers {
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(h MessageHandler, msg *Message)</span></span> {
        <span class="hljs-keyword">if</span> err := h(ctx, msg); err != <span class="hljs-literal">nil</span> {
            log.Printf(<span class="hljs-string">"[MQ] Error processing message: %v, type: %s"</span>, err, msg.Type)
        }
    }(handler, message)
}
</code></pre>
<h3 data-id="heading-16">èµ„æºç®¡ç†</h3>
<p>ç³»ç»Ÿå®ç°äº†æ­£ç¡®çš„èµ„æºæ¸…ç†æ¨¡å¼ï¼š</p>
<ul>
<li><strong>é€šé“ç®¡ç†</strong>ï¼šç¼“å†²é€šé“é˜²æ­¢å†…å­˜æ³„æ¼</li>
<li><strong>ä¸Šä¸‹æ–‡å–æ¶ˆ</strong>ï¼šä¸ºé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæä¾›æ­£ç¡®çš„å…³é—­ä¿¡å·</li>
<li><strong>Redis è¿æ¥ç®¡ç†</strong>ï¼šå¤–éƒ¨ Redis å®¢æˆ·ç«¯ç”Ÿå‘½å‘¨æœŸå•ç‹¬ç®¡ç†</li>
</ul>
<h2 data-id="heading-17">é›†æˆç‚¹</h2>
<p>æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„ä¸å‡ ä¸ªå…³é”®ç³»ç»Ÿç»„ä»¶é›†æˆï¼š</p>
<ul>
<li><strong>API å±‚</strong>ï¼šREST ç«¯ç‚¹è§¦å‘æ¶ˆæ¯å‘å¸ƒ</li>
<li><strong>è¯„ä¼°æœåŠ¡</strong>ï¼šé¢è¯•è¯„ä¼°çš„å¼‚æ­¥å¤„ç†</li>
<li><strong>æ•°æ®åº“å±‚</strong>ï¼šè¯„ä¼°ç»“æœçš„æŒä¹…åŒ–å­˜å‚¨</li>
<li><strong>é…ç½®ç³»ç»Ÿ</strong>ï¼šé˜Ÿåˆ—ç±»å‹é€‰æ‹©å’Œè¿æ¥å‚æ•°</li>
</ul>
<p>è¯¥æ¶æ„ä¸ºå¯æ‰©å±•çš„å¼‚æ­¥å¤„ç†æä¾›äº†åšå®çš„åŸºç¡€ï¼ŒåŒæ—¶ä¸ºä¸åŒçš„éƒ¨ç½²åœºæ™¯å’Œæœªæ¥å¢å¼ºä¿æŒäº†çµæ´»æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ]]></title>    <link>https://juejin.cn/post/7585390679399333894</link>    <guid>https://juejin.cn/post/7585390679399333894</guid>    <pubDate>2025-12-20T07:02:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585390679399333894" data-draft-id="7585382553290686500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ"/> <meta itemprop="keywords" content="AIGC,LangChain"/> <meta itemprop="datePublished" content="2025-12-20T07:02:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘¨æœ«ç¨‹åºçŒ¿"/> <meta itemprop="url" content="https://juejin.cn/user/3245414056989757"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3245414056989757/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘¨æœ«ç¨‹åºçŒ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T07:02:08.000Z" title="Sat Dec 20 2025 07:02:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å› ä¸ºé¡¹ç›®çš„éœ€è¦ï¼Œä¹‹å‰ç ”ç©¶äº†ä¸€æ®µæ—¶é—´çš„<code>RAG</code>ï¼Œäºæ˜¯æœ¬æ–‡æ€»ç»“ 8 ç§Â <code>RAG</code>Â æ¶æ„ï¼Œå¯¹æ¯ç§æ¶æ„è¿›è¡Œç®€è¦ä»‹ç»ï¼Œå¹¶ç”¨Â <code>langchain</code>Â å®ç°å…¶å‚è€ƒä»£ç ã€‚</p>
<h2 data-id="heading-0">1. Naive RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Naive RAG æ˜¯æœ€åŸºç¡€çš„æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„ï¼Œé‡‡ç”¨â€œç´¢å¼•-æ£€ç´¢-ç”Ÿæˆâ€çš„ç»å…¸æµç¨‹ã€‚<strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a791bbe7f4524e51b74053ad63de110f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=ku0AJbn3D7xRqqygvjDvDp5jEfs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æ•°æ®åŠ è½½ ï¼šæ”¶é›†æ•°æ®å¹¶è¿›è¡Œæ¸…æ´—ï¼Œæ¯”å¦‚å„ä¸ªæ–‡æ¡£æ ¼å¼çš„è½¬æ¢ï¼ŒOCR æ–‡å­—æå–ç­‰</li>
<li>åˆ†å—å’Œ embedding ï¼šå°†æ–‡æ¡£æ‹†åˆ†æ›´å°çš„ chunkï¼Œä¸€æ–¹é¢è®© embedding æ›´å¥½è½¬æ¢è¯­ä¹‰ä¿¡æ¯ï¼Œå¦ä¸€æ–¹é¢è§£å†³LLMçš„ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶é—®é¢˜</li>
<li>å‘é‡å­˜å‚¨ï¼šå°† embedding å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼Œæ–¹ä¾¿å¿«é€Ÿæœç´¢</li>
<li>search å’Œ Promptå·¥ç¨‹ï¼šå¯¹äºæŸ¥æ‰¾çš„é—®é¢˜å…ˆé€šè¿‡å‘é‡æ•°æ®åº“æ£€ç´¢ï¼Œç„¶åå°†å¬å›çš„æ–‡ä»¶åŸæ–‡ï¼Œé€šè¿‡ Prompt åŠ å·¥æä¾›ç»™LLM</li>
<li>è¾“å‡ºç­”æ¡ˆï¼šLLM æ ¹æ® Prompt ç”Ÿæˆç­”æ¡ˆè¾“å‡º</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.chainsÂ <span class="hljs-keyword">import</span>Â RetrievalQA
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â PromptTemplate
<span class="hljs-keyword">import</span>Â lancedb

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NaiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_naive_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-built_in">list</span></span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"naive_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ‰§è¡Œæ£€ç´¢å¹¶ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># åˆ›å»ºæ£€ç´¢é“¾</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">3</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt_template = PromptTemplate(
Â  Â  Â  Â  Â  Â  input_variables=[<span class="hljs-string">"context"</span>,Â <span class="hljs-string">"question"</span>],
Â  Â  Â  Â  Â  Â  template=<span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â  qa_chain = RetrievalQA.from_chain_type(
Â  Â  Â  Â  Â  Â  llm=self.llm,
Â  Â  Â  Â  Â  Â  chain_type=<span class="hljs-string">"stuff"</span>,
Â  Â  Â  Â  Â  Â  retriever=retriever,
Â  Â  Â  Â  Â  Â  chain_type_kwargs={<span class="hljs-string">"prompt"</span>: prompt_template}
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â qa_chain.invoke({<span class="hljs-string">"query"</span>: question})[<span class="hljs-string">"result"</span>]

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
naive_rag = NaiveRAG()
naive_rag.build_index([<span class="hljs-string">"æ–‡æ¡£1å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3å†…å®¹..."</span>])
answer = naive_rag.query(<span class="hljs-string">"What is issue date of lease?"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-1">2. Multi-Head RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Multi-Head RAG å€Ÿé‰´äº† Transformer çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œåˆ©ç”¨æ¨¡å‹ä¸åŒæ³¨æ„åŠ›å¤´æ•è·çš„å¤šæ ·åŒ–è¯­ä¹‰ç‰¹å¾è¿›è¡Œå¹¶è¡Œæ£€ç´¢ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2d889c3e8cf46d9a2bf9be204b3dbec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=YUXFtx%2FXAO9Q0PjbKx6buyMl9UY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>å¤šå¤´æ³¨æ„åŠ›Embeddingï¼šåˆ©ç”¨ Transformer æ¨¡å‹çš„å¤šå¤´æ³¨æ„åŠ›å±‚ï¼ˆè€Œéæœ€åä¸€å±‚ï¼‰ç”Ÿæˆå¤šä¸ªembeddingï¼Œæ¯ä¸ªå¤´æ•è·ä¸åŒçš„è¯­ä¹‰ç‰¹å¾</li>
<li>å¤šå‘é‡ç´¢å¼•æ„å»ºï¼šä¸ºæ¯ä¸ªæ³¨æ„åŠ›å¤´æ„å»ºç‹¬ç«‹çš„å‘é‡ç´¢å¼•ï¼Œå­˜å‚¨ä¸åŒç»´åº¦çš„è¯­ä¹‰ä¿¡æ¯</li>
<li>å¹¶è¡Œæ£€ç´¢ï¼šé’ˆå¯¹æŸ¥è¯¢ï¼Œåœ¨å¤šä¸ªç´¢å¼•ä¸Šå¹¶è¡Œæ£€ç´¢ï¼Œæ¯ä¸ªå¤´è¿”å›æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ</li>
<li>ç»“æœèåˆï¼šå°†å¤šä¸ªå¤´çš„æ£€ç´¢ç»“æœè¿›è¡Œå»é‡å’Œèåˆï¼Œç»¼åˆè€ƒè™‘ä¸åŒè¯­ä¹‰ç»´åº¦çš„ç›¸å…³æ€§</li>
<li>ä¸Šä¸‹æ–‡ç”Ÿæˆï¼šå°†èåˆåçš„æ–‡æ¡£ç‰‡æ®µç»„è£…æˆä¸Šä¸‹æ–‡ï¼Œè¾“å…¥LLMç”Ÿæˆç­”æ¡ˆ</li>
</ul>
<p><strong>ç›¸å…³å‚è€ƒå¦‚ä¸‹ï¼š</strong></p>
<p>è®ºæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2406.05085" target="_blank" title="https://arxiv.org/pdf/2406.05085" ref="nofollow noopener noreferrer">arxiv.org/pdf/2406.05â€¦</a></p>
<p>ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fspcl%2FMRAG" target="_blank" title="https://github.com/spcl/MRAG" ref="nofollow noopener noreferrer">github.com/spcl/MRAG</a></p>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.embeddings.baseÂ <span class="hljs-keyword">import</span>Â Embeddings
<span class="hljs-keyword">from</span>Â transformersÂ <span class="hljs-keyword">import</span>Â AutoModel, AutoTokenizer
<span class="hljs-keyword">import</span>Â torch
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">MultiHeadEmbeddings</span>(<span class="hljs-title class_ inherited__">Embeddings</span>):
Â  Â Â <span class="hljs-string">"""è‡ªå®šä¹‰å¤šå¤´æ³¨æ„åŠ›Embeddingï¼Œç»§æ‰¿LangChainçš„EmbeddingsåŸºç±»"""</span>
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name=<span class="hljs-string">"bert-base-uncased"</span>, head_index=<span class="hljs-number">0</span>, num_heads=<span class="hljs-number">12</span></span>):
Â  Â  Â  Â  self.tokenizer = AutoTokenizer.from_pretrained(model_name)
Â  Â  Â  Â  self.model = AutoModel.from_pretrained(model_name, output_hidden_states=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  self.head_index = head_index
Â  Â  Â  Â  self.num_heads = num_heads
Â  Â  Â  Â  self.head_dim =Â <span class="hljs-number">768</span>Â // num_heads Â <span class="hljs-comment"># BERT hidden size / num_heads</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">_get_head_embedding</span>(<span class="hljs-params">self, texts: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]]:
Â  Â  Â  Â Â <span class="hljs-string">"""è·å–æŒ‡å®šå¤´çš„embedding"""</span>
Â  Â  Â  Â  inputs = self.tokenizer(texts, return_tensors=<span class="hljs-string">"pt"</span>, padding=<span class="hljs-literal">True</span>, truncation=<span class="hljs-literal">True</span>)
Â  Â  Â  Â Â <span class="hljs-keyword">with</span>Â torch.no_grad():
Â  Â  Â  Â  Â  Â  outputs = self.model(**inputs, output_hidden_states=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  hidden_states = outputs.hidden_states[-<span class="hljs-number">2</span>] Â <span class="hljs-comment"># å€’æ•°ç¬¬äºŒå±‚</span>
Â  Â  Â  Â  start = self.head_index * self.head_dim
Â  Â  Â  Â  end = (self.head_index +Â <span class="hljs-number">1</span>) * self.head_dim
Â  Â  Â  Â  head_emb = hidden_states[:,Â <span class="hljs-number">0</span>, start:end].numpy()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â head_emb.tolist()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">embed_documents</span>(<span class="hljs-params">self, texts: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]]:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self._get_head_embedding(texts)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">embed_query</span>(<span class="hljs-params">self, text: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self._get_head_embedding([text])[<span class="hljs-number">0</span>]

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">MultiHeadRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, num_heads=<span class="hljs-number">12</span></span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.num_heads = num_heads
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_multihead_rag"</span>)
Â  Â  Â  Â  self.vectorstores = [] Â <span class="hljs-comment"># æ¯ä¸ªå¤´ä¸€ä¸ªå‘é‡å­˜å‚¨</span>
Â  Â  Â  Â  self.documents = []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºæ¯ä¸ªå¤´æ„å»ºç‹¬ç«‹çš„LanceDBå‘é‡å­˜å‚¨"""</span>
Â  Â  Â  Â  self.documents = documents
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â head_idxÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(self.num_heads):
Â  Â  Â  Â  Â  Â  embeddings = MultiHeadEmbeddings(head_index=head_idx, num_heads=self.num_heads)
Â  Â  Â  Â  Â  Â  vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  Â  Â  embeddings,
Â  Â  Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">f"head_<span class="hljs-subst">{head_idx}</span>_docs"</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  self.vectorstores.append(vectorstore)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">search</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">3</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""å¤šå¤´å¹¶è¡Œæ£€ç´¢å¹¶èåˆç»“æœ"""</span>
Â  Â  Â  Â  all_results = <span class="hljs-built_in">set</span>()
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â vectorstoreÂ <span class="hljs-keyword">in</span>Â self.vectorstores:
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=top_k)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â  Â  Â  all_results.add(doc.page_content)
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">list</span>(all_results)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ£€ç´¢å¹¶ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  retrieved_docs = self.search(question)
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n\n"</span>.join(retrieved_docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹å¤šç»´åº¦æ£€ç´¢çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â response.content

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
mrag = MultiHeadRAG(num_heads=<span class="hljs-number">12</span>)
documents = [<span class="hljs-string">"æ–‡æ¡£1çš„å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2çš„å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3çš„å†…å®¹..."</span>]
mrag.build_index(documents)
answer = mrag.query(<span class="hljs-string">"æŸ¥è¯¢é—®é¢˜"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-2">3. Corrective RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Corrective RAG åœ¨ä¼ ç»Ÿ RAG åŸºç¡€ä¸Šå¼•å…¥äº†æ–‡æ¡£è´¨é‡è¯„ä¼°å’Œè‡ªæˆ‘ä¿®æ­£æœºåˆ¶ã€‚å¯¹æ£€ç´¢åˆ°çš„æ¯ä¸ªæ–‡æ¡£è¿›è¡Œç›¸å…³æ€§è¯„åˆ†ï¼ˆCorrect/Incorrect/Ambiguousï¼‰ï¼Œå¯¹äºè´¨é‡ä¸è¶³çš„æ£€ç´¢ç»“æœï¼Œæœç´¢å¤–éƒ¨çŸ¥è¯†æºè¿›è¡Œè¡¥å……ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe0109c62e3e43f68ce49846a9450b74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=Wei8vQwsNIC1FczlF8K80NbNPsE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>åˆå§‹æ£€ç´¢ï¼šä½¿ç”¨å‘é‡æ£€ç´¢è·å–ä¸æŸ¥è¯¢ç›¸å…³çš„å€™é€‰æ–‡æ¡£</li>
<li>ç›¸å…³æ€§è¯„ä¼°ï¼šä½¿ç”¨LLMæˆ–ä¸“é—¨çš„è¯„ä¼°æ¨¡å‹å¯¹æ¯ä¸ªæ£€ç´¢åˆ°çš„æ–‡æ¡£è¿›è¡Œç›¸å…³æ€§è¯„åˆ†ï¼ˆCorrect/Incorrect/Ambiguousï¼‰</li>
<li>çŸ¥è¯†ä¿®æ­£ï¼šå¯¹äºè¯„ä¼°ä¸ºä¸ç›¸å…³æˆ–æ¨¡ç³Šçš„æ–‡æ¡£ï¼Œè§¦å‘çŸ¥è¯†ä¿®æ­£æœºåˆ¶</li>
<li>ç½‘ç»œæœç´¢å¢å¼ºï¼šå½“æœ¬åœ°çŸ¥è¯†åº“æ–‡æ¡£è´¨é‡ä¸è¶³æ—¶ï¼Œè°ƒç”¨å¤–éƒ¨æœç´¢å¼•æ“è·å–è¡¥å……ä¿¡æ¯</li>
<li>æ–‡æ¡£é‡ç»„ï¼šå°†è¯„ä¼°ä¸ºç›¸å…³çš„æ–‡æ¡£å’Œè¡¥å……æœç´¢ç»“æœé‡æ–°ç»„ç»‡ï¼Œå»é™¤å†—ä½™ä¿¡æ¯</li>
<li>ç­”æ¡ˆç”Ÿæˆï¼šåŸºäºä¿®æ­£åçš„é«˜è´¨é‡ä¸Šä¸‹æ–‡ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain_community.toolsÂ <span class="hljs-keyword">import</span>Â TavilySearchResults
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">CorrectiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_corrective_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨Tavilyè¿›è¡Œç½‘ç»œæœç´¢</span>
Â  Â  Â  Â  self.web_search = TavilySearchResults(max_results=<span class="hljs-number">3</span>)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"corrective_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_relevance</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ä»¥ä¸‹æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§ã€‚
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·å›ç­”: CORRECT(ç›¸å…³), INCORRECT(ä¸ç›¸å…³), æˆ– AMBIGUOUS(æ¨¡ç³Š)
Â  Â  Â  Â  Â  Â  åªè¿”å›ä¸€ä¸ªè¯ã€‚"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â response.strip().upper()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">search_web</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""å½“æœ¬åœ°æ–‡æ¡£ä¸è¶³æ—¶è¿›è¡Œç½‘ç»œæœç´¢"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  results = self.web_search.invoke(query)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â [r[<span class="hljs-string">"content"</span>]Â <span class="hljs-keyword">for</span>Â rÂ <span class="hljs-keyword">in</span>Â resultsÂ <span class="hljs-keyword">if</span><span class="hljs-string">"content"</span><span class="hljs-keyword">in</span>Â r]
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">retrieve_and_correct</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">5</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""æ£€ç´¢å¹¶ä¿®æ­£æ–‡æ¡£"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆå§‹æ£€ç´¢</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: top_k})
Â  Â  Â  Â  docs = retriever.invoke(query)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. è¯„ä¼°æ¯ä¸ªæ–‡æ¡£çš„ç›¸å…³æ€§</span>
Â  Â  Â  Â  correct_docs = []
Â  Â  Â  Â  need_web_search =Â <span class="hljs-literal">True</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â  relevance = self.evaluate_relevance(query, doc.page_content)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â relevance ==Â <span class="hljs-string">"CORRECT"</span>:
Â  Â  Â  Â  Â  Â  Â  Â  correct_docs.append(doc.page_content)
Â  Â  Â  Â  Â  Â  Â  Â  need_web_search =Â <span class="hljs-literal">False</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">elif</span>Â relevance ==Â <span class="hljs-string">"AMBIGUOUS"</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å¯¹æ¨¡ç³Šæ–‡æ¡£è¿›è¡ŒçŸ¥è¯†ç²¾ç‚¼</span>
Â  Â  Â  Â  Â  Â  Â  Â  refined = self.refine_document(query, doc.page_content)
Â  Â  Â  Â  Â  Â  Â  Â  correct_docs.append(refined)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. å¿…è¦æ—¶è¿›è¡Œç½‘ç»œæœç´¢è¡¥å……</span>
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â need_web_searchÂ <span class="hljs-keyword">or</span>Â <span class="hljs-built_in">len</span>(correct_docs) &lt;Â <span class="hljs-number">2</span>:
Â  Â  Â  Â  Â  Â  web_results = self.search_web(query)
Â  Â  Â  Â  Â  Â  correct_docs.extend(web_results)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â correct_docs
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">refine_document</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç²¾ç‚¼æ–‡æ¡£ï¼Œæå–ä¸æŸ¥è¯¢ç›¸å…³çš„éƒ¨åˆ†"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä»ä»¥ä¸‹æ–‡æ¡£ä¸­æå–ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„ä¿¡æ¯ï¼š
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·åªè¿”å›ç›¸å…³çš„ç²¾ç‚¼å†…å®¹ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  corrected_docs = self.retrieve_and_correct(question)
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n\n"</span>.join(corrected_docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ç»è¿‡ä¿®æ­£çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
crag = CorrectiveRAG()
crag.build_index([<span class="hljs-string">"æ–‡æ¡£1..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3..."</span>])
answer = crag.query(<span class="hljs-string">"ä½ çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-3">4. Agentic RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Agentic RAGï¼ˆæ™ºèƒ½ä½“RAGï¼‰å°† AI Agent çš„è§„åˆ’å’Œæ¨ç†èƒ½åŠ›ä¸ RAG ç›¸ç»“åˆã€‚<br/>
Agent å¯ä»¥è‡ªä¸»åˆ†ææŸ¥è¯¢ã€åˆ¶å®šæ£€ç´¢ç­–ç•¥ã€é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆè¯­ä¹‰æœç´¢ã€å…³é”®è¯æœç´¢ã€è®¡ç®—å™¨ç­‰ï¼‰ï¼Œå¹¶æ ¹æ®ä¸­é—´ç»“æœè¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d4ac2fafbf4f2f8a4549436c5adc3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=nzUF6IDJ6xHC4IINPGVnM04N3Ig%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>Agentåˆå§‹åŒ–ï¼šåˆ›å»ºå…·æœ‰æ¨ç†å’Œè§„åˆ’èƒ½åŠ›çš„AI Agentï¼Œé…å¤‡æ£€ç´¢å·¥å…·</li>
<li>ä»»åŠ¡åˆ†è§£ï¼šAgentåˆ†æç”¨æˆ·æŸ¥è¯¢ï¼Œå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡</li>
<li>å·¥å…·é€‰æ‹©ï¼šAgentæ ¹æ®å­ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆæ£€ç´¢ã€è®¡ç®—ã€APIè°ƒç”¨ç­‰ï¼‰</li>
<li>è¿­ä»£æ£€ç´¢ï¼šAgentå¯ä»¥æ ¹æ®ä¸­é—´ç»“æœå†³å®šæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æ£€ç´¢æˆ–è°ƒæ•´æŸ¥è¯¢ç­–ç•¥</li>
<li>æ¨ç†æ•´åˆï¼šAgentå¯¹å¤šè½®æ£€ç´¢å’Œå·¥å…·è°ƒç”¨çš„ç»“æœè¿›è¡Œæ¨ç†å’Œæ•´åˆ</li>
<li>è‡ªæˆ‘åæ€ï¼šAgentè¯„ä¼°ç­”æ¡ˆè´¨é‡ï¼Œå¿…è¦æ—¶è¿›è¡Œè‡ªæˆ‘ä¿®æ­£</li>
<li>æœ€ç»ˆè¾“å‡ºï¼šç”Ÿæˆå®Œæ•´ã€å‡†ç¡®çš„ç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.agentsÂ <span class="hljs-keyword">import</span>Â AgentExecutor, create_tool_calling_agent
<span class="hljs-keyword">from</span>Â langchain.toolsÂ <span class="hljs-keyword">import</span>Â tool
<span class="hljs-keyword">from</span>Â langchain_core.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate, MessagesPlaceholder
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AgenticRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_agentic_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â  self.agent_executor =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"agentic_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">setup_agent</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""é…ç½®Agentå’Œå·¥å…·"""</span>
Â  Â  Â  Â  vectorstore = self.vectorstore Â <span class="hljs-comment"># é—­åŒ…å¼•ç”¨</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">semantic_search</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºè¯­ä¹‰æœç´¢ï¼Œå½“éœ€è¦ç†è§£é—®é¢˜å«ä¹‰å¹¶æŸ¥æ‰¾ç›¸å…³æ–‡æ¡£æ—¶ä½¿ç”¨"""</span>
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=<span class="hljs-number">3</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">keyword_search</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºå…³é”®è¯æœç´¢ï¼Œå½“éœ€è¦ç²¾ç¡®åŒ¹é…ç‰¹å®šæœ¯è¯­æ—¶ä½¿ç”¨"""</span>
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=<span class="hljs-number">2</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">calculator</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºæ•°å­¦è®¡ç®—ï¼Œè¾“å…¥æ•°å­¦è¡¨è¾¾å¼"""</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">str</span>(<span class="hljs-built_in">eval</span>(expression))
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"è®¡ç®—é”™è¯¯"</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â  tools = [semantic_search, keyword_search, calculator]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨æ–°ç‰ˆæœ¬çš„Agentæç¤ºæ¨¡æ¿</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_messages([
Â  Â  Â  Â  Â  Â  (<span class="hljs-string">"system"</span>,Â <span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ¥å›ç­”é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  å¯ç”¨å·¥å…·ï¼š
Â  Â  Â  Â  Â  Â  - semantic_search: ç”¨äºè¯­ä¹‰æœç´¢ï¼ŒæŸ¥æ‰¾ç›¸å…³æ–‡æ¡£
Â  Â  Â  Â  Â  Â  - keyword_search: ç”¨äºå…³é”®è¯ç²¾ç¡®åŒ¹é…
Â  Â  Â  Â  Â  Â  - calculator: ç”¨äºæ•°å­¦è®¡ç®—
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·æ ¹æ®é—®é¢˜é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨å·¥å…·æ¥è·å–å®Œæ•´ä¿¡æ¯ã€‚"""</span>),
Â  Â  Â  Â  Â  Â  (<span class="hljs-string">"human"</span>,Â <span class="hljs-string">"{input}"</span>),
Â  Â  Â  Â  Â  Â  MessagesPlaceholder(variable_name=<span class="hljs-string">"agent_scratchpad"</span>)
Â  Â  Â  Â  ])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># åˆ›å»ºTool Calling Agent</span>
Â  Â  Â  Â  agent = create_tool_calling_agent(self.llm, tools, prompt)
Â  Â  Â  Â  self.agent_executor = AgentExecutor(
Â  Â  Â  Â  Â  Â  agent=agent,Â 
Â  Â  Â  Â  Â  Â  tools=tools,Â 
Â  Â  Â  Â  Â  Â  verbose=<span class="hljs-literal">True</span>,
Â  Â  Â  Â  Â  Â  max_iterations=<span class="hljs-number">5</span>,
Â  Â  Â  Â  Â  Â  handle_parsing_errors=<span class="hljs-literal">True</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ‰§è¡ŒæŸ¥è¯¢"""</span>
Â  Â  Â  Â Â ifnotÂ self.agent_executor:
Â  Â  Â  Â  Â  Â  self.setup_agent()
Â  Â  Â  Â  result = self.agent_executor.invoke({<span class="hljs-string">"input"</span>: question})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â result[<span class="hljs-string">"output"</span>]

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
arag = AgenticRAG()
arag.build_index([<span class="hljs-string">"äº§å“Aä»·æ ¼100å…ƒ..."</span>,Â <span class="hljs-string">"äº§å“Bä»·æ ¼200å…ƒ..."</span>,Â <span class="hljs-string">"ä¼˜æƒ æ”¿ç­–..."</span>])
answer = arag.query(<span class="hljs-string">"äº§å“Aå’Œäº§å“Bçš„æ€»ä»·æ˜¯å¤šå°‘ï¼Ÿæœ‰ä»€ä¹ˆä¼˜æƒ ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-4">5. Graph RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Graph RAG å°†çŸ¥è¯†å›¾è°±æŠ€æœ¯ä¸ RAG ç›¸ç»“åˆï¼Œé€šè¿‡ä»æ–‡æ¡£ä¸­æŠ½å–å®ä½“å’Œå…³ç³»æ„å»ºçŸ¥è¯†å›¾è°±ï¼Œå¹¶è¿›è¡Œç¤¾åŒºæ£€æµ‹å’Œæ‘˜è¦ç”Ÿæˆã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/156a00f8228c4cd6ad9d9a913b14922b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=1qbByKhMhrVkeQ42ZSiqfMkGUbc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>å®ä½“æŠ½å–ï¼šä½¿ç”¨NERæˆ–LLMä»æ–‡æ¡£ä¸­æŠ½å–å®ä½“ï¼ˆäººç‰©ã€åœ°ç‚¹ã€æ¦‚å¿µç­‰ï¼‰</li>
<li>å…³ç³»æŠ½å–ï¼šè¯†åˆ«å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œæ„å»ºä¸‰å…ƒç»„ï¼ˆå®ä½“-å…³ç³»-å®ä½“ï¼‰</li>
<li>çŸ¥è¯†å›¾è°±æ„å»ºï¼šå°†å®ä½“å’Œå…³ç³»å­˜å‚¨åˆ°å›¾æ•°æ®åº“ä¸­ï¼ˆå¦‚Neo4jï¼‰</li>
<li>ç¤¾åŒºæ£€æµ‹ï¼šå¯¹å›¾è¿›è¡Œç¤¾åŒºåˆ’åˆ†ï¼Œè¯†åˆ«ä¸»é¢˜èšç±»</li>
<li>ç¤¾åŒºæ‘˜è¦ï¼šä¸ºæ¯ä¸ªç¤¾åŒºç”Ÿæˆæ‘˜è¦æè¿°</li>
<li>å›¾æ£€ç´¢ï¼šæ ¹æ®æŸ¥è¯¢åœ¨çŸ¥è¯†å›¾è°±ä¸­æ£€ç´¢ç›¸å…³å­å›¾å’Œç¤¾åŒºæ‘˜è¦</li>
<li>ç­”æ¡ˆç”Ÿæˆï¼šç»“åˆå›¾ç»“æ„ä¿¡æ¯å’Œç¤¾åŒºæ‘˜è¦ç”Ÿæˆæ›´å…¨é¢çš„ç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.graphsÂ <span class="hljs-keyword">import</span>Â Neo4jGraph
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser, JsonOutputParser
<span class="hljs-keyword">import</span>Â networkxÂ <span class="hljs-keyword">as</span>Â nx
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>
<span class="hljs-keyword">import</span>Â json

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">GraphRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, neo4j_uri=<span class="hljs-string">"bolt://localhost:7687"</span>,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â neo4j_user=<span class="hljs-string">"neo4j"</span>, neo4j_password=<span class="hljs-string">"password"</span></span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨LangChainçš„Neo4jé›†æˆ</span>
Â  Â  Â  Â  self.graph_db = Neo4jGraph(
Â  Â  Â  Â  Â  Â  url=neo4j_uri,Â 
Â  Â  Â  Â  Â  Â  username=neo4j_user,Â 
Â  Â  Â  Â  Â  Â  password=neo4j_password
Â  Â  Â  Â  )
Â  Â  Â  Â  self.nx_graph = nx.Graph()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">extract_entities_and_relations</span>(<span class="hljs-params">self, text: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä½¿ç”¨LLMæŠ½å–å®ä½“å’Œå…³ç³»"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä»ä»¥ä¸‹æ–‡æœ¬ä¸­æŠ½å–å®ä½“å’Œå…³ç³»ï¼Œè¿”å›JSONæ ¼å¼ï¼š
Â  Â  Â  Â  Â  Â  æ–‡æœ¬: {text}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼(åªè¿”å›JSON):
Â  Â  Â  Â  Â  Â  {{
Â  Â  Â  Â  Â  Â  Â  Â  "entities": ["å®ä½“1", "å®ä½“2", ...],
Â  Â  Â  Â  Â  Â  Â  Â  "relations": [["å®ä½“1", "å…³ç³»", "å®ä½“2"], ...]
Â  Â  Â  Â  Â  Â  }}"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"text"</span>: text})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â json.loads(response)
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {<span class="hljs-string">"entities"</span>: [],Â <span class="hljs-string">"relations"</span>: []}
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_knowledge_graph</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºçŸ¥è¯†å›¾è°±"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â documents:
Â  Â  Â  Â  Â  Â  extracted = self.extract_entities_and_relations(doc)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ·»åŠ åˆ°NetworkXå›¾</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â entityÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"entities"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  self.nx_graph.add_node(entity)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â relÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"relations"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(rel) ==Â <span class="hljs-number">3</span>:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  self.nx_graph.add_edge(rel[<span class="hljs-number">0</span>], rel[<span class="hljs-number">2</span>], relation=rel[<span class="hljs-number">1</span>])
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å­˜å‚¨åˆ°Neo4j</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â entityÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"entities"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  self.graph_db.query(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"MERGE (e:Entity {name: $name})"</span>,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"name"</span>: entity}
Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â relÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"relations"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(rel) ==Â <span class="hljs-number">3</span>:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  self.graph_db.query(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""MATCH (a:Entity {name: $from})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â MATCH (b:Entity {name: $to})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â MERGE (a)-[r:RELATED {type: $rel}]-&gt;(b)"""</span>,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"from"</span>: rel[<span class="hljs-number">0</span>],Â <span class="hljs-string">"to"</span>: rel[<span class="hljs-number">2</span>],Â <span class="hljs-string">"rel"</span>: rel[<span class="hljs-number">1</span>]}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">detect_communities</span>(<span class="hljs-params">self</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]]:
Â  Â  Â  Â Â <span class="hljs-string">"""ç¤¾åŒºæ£€æµ‹"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">from</span>Â networkx.algorithmsÂ <span class="hljs-keyword">import</span>Â community
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(self.nx_graph.nodes()) ==Â <span class="hljs-number">0</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â []
Â  Â  Â  Â  communities = community.louvain_communities(self.nx_graph)
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â [<span class="hljs-built_in">list</span>(c)Â <span class="hljs-keyword">for</span>Â cÂ <span class="hljs-keyword">in</span>Â communities]
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_community_summaries</span>(<span class="hljs-params">self, communities: <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºæ¯ä¸ªç¤¾åŒºç”Ÿæˆæ‘˜è¦"""</span>
Â  Â  Â  Â  summaries = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â i, commÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">enumerate</span>(communities):
Â  Â  Â  Â  Â  Â  subgraph = self.nx_graph.subgraph(comm)
Â  Â  Â  Â  Â  Â  edges_info = [(u, v, d.get(<span class="hljs-string">'relation'</span>,Â <span class="hljs-string">''</span>))Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span>Â u, v, dÂ <span class="hljs-keyword">in</span>Â subgraph.edges(data=<span class="hljs-literal">True</span>)]
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºä»¥ä¸‹å®ä½“ç¾¤ç»„ç”Ÿæˆç®€çŸ­æ‘˜è¦ï¼š
Â  Â  Â  Â  Â  Â  Â  Â  å®ä½“: {entities}
Â  Â  Â  Â  Â  Â  Â  Â  å…³ç³»: {relations}
Â  Â  Â  Â  Â  Â  Â  Â  æ‘˜è¦:"""</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  Â  Â  summary = chain.invoke({<span class="hljs-string">"entities"</span>: comm,Â <span class="hljs-string">"relations"</span>: edges_info})
Â  Â  Â  Â  Â  Â  summaries.append({<span class="hljs-string">"community"</span>: i,Â <span class="hljs-string">"entities"</span>: comm,Â <span class="hljs-string">"summary"</span>: summary})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â summaries
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºå›¾çš„æ£€ç´¢å’Œå›ç­”"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. ä»é—®é¢˜ä¸­æå–å…³é”®å®ä½“</span>
Â  Â  Â  Â  entities = self.extract_entities_and_relations(question)[<span class="hljs-string">"entities"</span>]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. åœ¨Neo4jä¸­æŸ¥æ‰¾ç›¸å…³å­å›¾</span>
Â  Â  Â  Â  graph_context = self.graph_db.query(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""MATCH (e:Entity)-[r]-(related)
Â  Â  Â  Â  Â  Â  Â  Â WHERE e.name IN $entities
Â  Â  Â  Â  Â  Â  Â  Â RETURN e.name AS entity, type(r) AS rel_type,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.type AS relation, related.name AS related_entity
Â  Â  Â  Â  Â  Â  Â  Â LIMIT 20"""</span>,
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"entities"</span>: entities}
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. è·å–ç¤¾åŒºæ‘˜è¦</span>
Â  Â  Â  Â  communities = self.detect_communities()
Â  Â  Â  Â  summaries = self.generate_community_summaries(communities[:<span class="hljs-number">3</span>])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. ç”Ÿæˆç­”æ¡ˆ</span>
Â  Â  Â  Â  context =Â <span class="hljs-string">f"å›¾å…³ç³»:Â <span class="hljs-subst">{graph_context}</span>\nç¤¾åŒºæ‘˜è¦:Â <span class="hljs-subst">{summaries}</span>"</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹çŸ¥è¯†å›¾è°±ä¿¡æ¯å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  {context}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
grag = GraphRAG()
grag.build_knowledge_graph([
Â  Â Â <span class="hljs-string">"å¼ ä¸‰æ˜¯ABCå…¬å¸çš„CEOï¼Œè¯¥å…¬å¸ä½äºåŒ—äº¬"</span>,
Â  Â Â <span class="hljs-string">"æå››æ˜¯ABCå…¬å¸çš„CTOï¼Œä»–ä¸å¼ ä¸‰æ˜¯å¤§å­¦åŒå­¦"</span>,
Â  Â Â <span class="hljs-string">"ABCå…¬å¸å¼€å‘äº†äº§å“Xï¼Œå¸‚åœºä»½é¢é¢†å…ˆ"</span>
])
answer = grag.query(<span class="hljs-string">"ABCå…¬å¸çš„é¢†å¯¼å±‚æœ‰å“ªäº›äººï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-5">6. Self RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Self RAG æä¾›ç»™æ¨¡å‹è‡ªæˆ‘è¯„ä¼°å’Œå†³ç­–èƒ½åŠ›ï¼Œå®ƒé€šè¿‡å››ä¸ªåæ€æ ‡è®°ï¼ˆRetrieve/ISREL/ISSUP/ISUSEï¼‰æ¥åˆ¤æ–­ï¼šæ˜¯å¦éœ€è¦æ£€ç´¢ã€æ–‡æ¡£æ˜¯å¦ç›¸å…³ã€ç­”æ¡ˆæ˜¯å¦è¢«æ”¯æŒã€ç­”æ¡ˆæ˜¯å¦æœ‰ç”¨ï¼Œæ¨¡å‹ä¼šç”Ÿæˆå¤šä¸ªå€™é€‰ç­”æ¡ˆå¹¶ç»¼åˆè¯„åˆ†ï¼Œé€‰æ‹©æœ€ä¼˜ç»“æœè¾“å‡ºã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f305a7dcc64a4d119b93fc171c739451~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=568LwX2VOeLFWFTprYECRBOGzH0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æ£€ç´¢å†³ç­–ï¼šæ¨¡å‹é¦–å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ£€ç´¢ï¼ˆç”ŸæˆRetrieveæ ‡è®°ï¼‰</li>
<li>æŒ‰éœ€æ£€ç´¢ï¼šå¦‚æœéœ€è¦æ£€ç´¢ï¼Œä»çŸ¥è¯†åº“ä¸­è·å–ç›¸å…³æ–‡æ¡£</li>
<li>ç›¸å…³æ€§è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°æ£€ç´¢åˆ°çš„æ–‡æ¡£æ˜¯å¦ä¸æŸ¥è¯¢ç›¸å…³ï¼ˆç”ŸæˆISRELæ ‡è®°ï¼‰</li>
<li>æ”¯æŒåº¦è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°ç”Ÿæˆçš„å†…å®¹æ˜¯å¦è¢«æ£€ç´¢æ–‡æ¡£æ”¯æŒï¼ˆç”ŸæˆISSUPæ ‡è®°ï¼‰</li>
<li>æœ‰ç”¨æ€§è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°ç”Ÿæˆçš„å›ç­”æ˜¯å¦å¯¹ç”¨æˆ·æœ‰ç”¨ï¼ˆç”ŸæˆISUSEæ ‡è®°ï¼‰</li>
<li>è‡ªé€‚åº”ç”Ÿæˆï¼šåŸºäºä»¥ä¸Šè¯„ä¼°æ ‡è®°ï¼Œæ¨¡å‹å†³å®šæ˜¯å¦ä½¿ç”¨æ£€ç´¢å†…å®¹ã€é‡æ–°æ£€ç´¢æˆ–ç›´æ¥ç”Ÿæˆ</li>
<li>è¾“å‡ºæœ€ä¼˜ç­”æ¡ˆï¼šé€‰æ‹©è¯„åˆ†æœ€é«˜çš„ç”Ÿæˆç»“æœä½œä¸ºæœ€ç»ˆè¾“å‡º</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SelfRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_self_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"self_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">should_retrieve</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">bool</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ¤æ–­æ˜¯å¦éœ€è¦æ£€ç´¢ (Retrieveæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åˆ¤æ–­ä»¥ä¸‹é—®é¢˜æ˜¯å¦éœ€è¦æ£€ç´¢å¤–éƒ¨çŸ¥è¯†æ¥å›ç­”ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  å¦‚æœé—®é¢˜éœ€è¦äº‹å®æ€§çŸ¥è¯†ã€æœ€æ–°ä¿¡æ¯æˆ–ç‰¹å®šé¢†åŸŸçŸ¥è¯†ï¼Œå›ç­”YESã€‚
Â  Â  Â  Â  Â  Â  å¦‚æœé—®é¢˜æ˜¯é€šç”¨é—®é¢˜æˆ–æ¨ç†é—®é¢˜ï¼Œå›ç­”NOã€‚
Â  Â  Â  Â  Â  Â  åªå›ç­”YESæˆ–NO:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query}).strip().upper()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"YES"</span><span class="hljs-keyword">in</span>Â response
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_relevance</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ç›¸å…³æ€§ (ISRELæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ä¸é—®é¢˜çš„ç›¸å…³æ€§ï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±
Â  Â  Â  Â  Â  Â  ç¤ºä¾‹: 4|æ–‡æ¡£ç›´æ¥å›ç­”äº†é—®é¢˜çš„æ ¸å¿ƒå†…å®¹"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_support</span>(<span class="hljs-params">self, document: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£æ”¯æŒ (ISSUPæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£å†…å®¹æ”¯æŒï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"document"</span>: document,Â <span class="hljs-string">"answer"</span>: answer})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_usefulness</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæœ‰ç”¨æ€§ (ISUSEæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆå¯¹ç”¨æˆ·é—®é¢˜çš„æœ‰ç”¨ç¨‹åº¦ï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"answer"</span>: answer})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_with_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä¸Šä¸‹æ–‡ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸è¶³ä»¥å›ç­”ï¼Œè¯·è¯´æ˜ã€‚
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_without_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ä½¿ç”¨æ£€ç´¢ç›´æ¥ç”Ÿæˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"è¯·å›ç­”ä»¥ä¸‹é—®é¢˜: {query}"</span>)
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""Self-RAGä¸»æµç¨‹"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. æ£€ç´¢å†³ç­–</span>
Â  Â  Â  Â  need_retrieval = self.should_retrieve(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â ifnotÂ need_retrieval:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç›´æ¥ç”Ÿæˆ</span>
Â  Â  Â  Â  Â  Â  answer = self.generate_without_context(question)
Â  Â  Â  Â  Â  Â  _, usefulness = self.evaluate_usefulness(question, answer)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â answer
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. æ£€ç´¢æ–‡æ¡£</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">3</span>})
Â  Â  Â  Â  docs = retriever.invoke(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. å¯¹æ¯ä¸ªæ–‡æ¡£ç”Ÿæˆå€™é€‰ç­”æ¡ˆå¹¶è¯„åˆ†</span>
Â  Â  Â  Â  candidates = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°ç›¸å…³æ€§ (ISREL)</span>
Â  Â  Â  Â  Â  Â  is_relevant, rel_score = self.evaluate_relevance(question, doc.page_content)
Â  Â  Â  Â  Â  Â Â ifnotÂ is_relevant:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">continue</span>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç”Ÿæˆç­”æ¡ˆ</span>
Â  Â  Â  Â  Â  Â  answer = self.generate_with_context(question, doc.page_content)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°æ”¯æŒåº¦ (ISSUP)</span>
Â  Â  Â  Â  Â  Â  is_supported, sup_score = self.evaluate_support(doc.page_content, answer)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°æœ‰ç”¨æ€§ (ISUSE)</span>
Â  Â  Â  Â  Â  Â  is_useful, use_score = self.evaluate_usefulness(question, answer)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç»¼åˆè¯„åˆ†</span>
Â  Â  Â  Â  Â  Â  total_score = rel_score *Â <span class="hljs-number">0.3</span>Â + sup_score *Â <span class="hljs-number">0.4</span>Â + use_score *Â <span class="hljs-number">0.3</span>
Â  Â  Â  Â  Â  Â  candidates.append((answer, total_score))
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. é€‰æ‹©æœ€ä½³ç­”æ¡ˆ</span>
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â candidates:
Â  Â  Â  Â  Â  Â  candidates.sort(key=<span class="hljs-keyword">lambda</span>Â x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â candidates[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]
Â  Â  Â  Â Â <span class="hljs-keyword">else</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å¦‚æœæ²¡æœ‰åˆé€‚çš„æ£€ç´¢ç»“æœï¼Œç›´æ¥ç”Ÿæˆ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self.generate_without_context(question)

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
srag = SelfRAG()
srag.build_index([<span class="hljs-string">"æ–‡æ¡£1å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3å†…å®¹..."</span>])
answer = srag.query(<span class="hljs-string">"ä½ çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-6">7. Adaptive RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Adaptive RAG æ ¹æ®æŸ¥è¯¢çš„ç±»å‹å’Œå¤æ‚åº¦åŠ¨æ€é€‰æ‹©æœ€ä¼˜çš„å¤„ç†ç­–ç•¥ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/867cf90ae2aa496eb94c184bbfc132a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=n8LHCBmrPpc99fZg4kO7JcJl4h0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æŸ¥è¯¢åˆ†ç±»ï¼šåˆ†æç”¨æˆ·æŸ¥è¯¢çš„ç±»å‹å’Œå¤æ‚åº¦ï¼ˆç®€å•äº‹å®/å¤šè·³æ¨ç†/å¼€æ”¾æ€§é—®é¢˜ï¼‰</li>
<li>ç­–ç•¥é€‰æ‹©ï¼šæ ¹æ®æŸ¥è¯¢ç±»å‹é€‰æ‹©æœ€ä¼˜çš„RAGç­–ç•¥</li>
<li>
<ul>
<li>ç®€å•æŸ¥è¯¢ï¼šç›´æ¥LLMå›ç­”æˆ–å•æ¬¡æ£€ç´¢</li>
<li>å¤æ‚æŸ¥è¯¢ï¼šå¤šè½®è¿­ä»£æ£€ç´¢</li>
<li>å¼€æ”¾æ€§é—®é¢˜ï¼šç»“åˆç½‘ç»œæœç´¢</li>
</ul>
</li>
<li>åŠ¨æ€è·¯ç”±ï¼šå°†æŸ¥è¯¢è·¯ç”±åˆ°å¯¹åº”çš„å¤„ç†æµç¨‹</li>
<li>è‡ªé€‚åº”æ£€ç´¢ï¼šæ ¹æ®ä¸­é—´ç»“æœåŠ¨æ€è°ƒæ•´æ£€ç´¢æ·±åº¦å’ŒèŒƒå›´</li>
<li>ç»“æœæ•´åˆï¼šæ•´åˆä¸åŒç­–ç•¥çš„ç»“æœç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">from</span>Â langchain_core.runnablesÂ <span class="hljs-keyword">import</span>Â RunnableLambda, RunnablePassthrough
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â enumÂ <span class="hljs-keyword">import</span>Â Enum
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">QueryType</span>(<span class="hljs-title class_ inherited__">Enum</span>):
Â  Â  SIMPLE =Â <span class="hljs-string">"simple"</span>Â  Â  Â  Â  Â  Â <span class="hljs-comment"># ç®€å•äº‹å®æŸ¥è¯¢</span>
Â  Â  MULTI_HOP =Â <span class="hljs-string">"multi_hop"</span>Â  Â  Â <span class="hljs-comment"># å¤šè·³æ¨ç†æŸ¥è¯¢</span>
Â  Â  OPEN_ENDED =Â <span class="hljs-string">"open_ended"</span>Â  Â <span class="hljs-comment"># å¼€æ”¾æ€§é—®é¢˜</span>
Â  Â  NO_RETRIEVAL =Â <span class="hljs-string">"no_retrieval"</span><span class="hljs-comment"># ä¸éœ€è¦æ£€ç´¢</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AdaptiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_adaptive_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"adaptive_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">classify_query</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; QueryType:
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ†ç±»æŸ¥è¯¢ç±»å‹"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åˆ†æä»¥ä¸‹æŸ¥è¯¢çš„ç±»å‹ï¼Œè¿”å›å¯¹åº”ç±»åˆ«ï¼š
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ç±»åˆ«è¯´æ˜:
Â  Â  Â  Â  Â  Â  - SIMPLE: ç®€å•çš„äº‹å®æ€§é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥ä»å•ä¸ªæ–‡æ¡£æ‰¾åˆ°ç­”æ¡ˆ
Â  Â  Â  Â  Â  Â  - MULTI_HOP: éœ€è¦ç»¼åˆå¤šä¸ªä¿¡æ¯æºè¿›è¡Œæ¨ç†çš„å¤æ‚é—®é¢˜
Â  Â  Â  Â  Â  Â  - OPEN_ENDED: å¼€æ”¾æ€§é—®é¢˜ï¼Œéœ€è¦å¹¿æ³›çš„çŸ¥è¯†å’Œåˆ›é€ æ€§æ€è€ƒ
Â  Â  Â  Â  Â  Â  - NO_RETRIEVAL: é€šç”¨çŸ¥è¯†é—®é¢˜ï¼Œä¸éœ€è¦æ£€ç´¢å³å¯å›ç­”
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  åªè¿”å›ç±»åˆ«åç§°(SIMPLE/MULTI_HOP/OPEN_ENDED/NO_RETRIEVAL):"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query}).strip().upper()
Â  Â  Â  Â  mapping = {
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"SIMPLE"</span>: QueryType.SIMPLE,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"MULTI_HOP"</span>: QueryType.MULTI_HOP,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"OPEN_ENDED"</span>: QueryType.OPEN_ENDED,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"NO_RETRIEVAL"</span>: QueryType.NO_RETRIEVAL
Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â mapping.get(response, QueryType.SIMPLE)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">simple_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç®€å•RAGï¼šå•æ¬¡æ£€ç´¢"""</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"åŸºäºä»¥ä¸‹å†…å®¹å›ç­”é—®é¢˜ï¼š\n{context}\n\né—®é¢˜ï¼š{question}\nç­”æ¡ˆï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">format_docs</span>(<span class="hljs-params">docs</span>):
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  chain = (
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"context"</span>: retriever | format_docs,Â <span class="hljs-string">"question"</span>: RunnablePassthrough()}
Â  Â  Â  Â  Â  Â  | prompt
Â  Â  Â  Â  Â  Â  | self.llm
Â  Â  Â  Â  Â  Â  | StrOutputParser()
Â  Â  Â  Â  )
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke(query)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">multi_hop_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, max_hops: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">3</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""å¤šè·³RAGï¼šè¿­ä»£æ£€ç´¢"""</span>
Â  Â  Â  Â  accumulated_context = []
Â  Â  Â  Â  current_query = query
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â hopÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(max_hops):
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ£€ç´¢</span>
Â  Â  Â  Â  Â  Â  docs = retriever.invoke(current_query)
Â  Â  Â  Â  Â  Â  accumulated_context.extend([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å·²æœ‰è¶³å¤Ÿä¿¡æ¯</span>
Â  Â  Â  Â  Â  Â  context =Â <span class="hljs-string">"\n"</span>.join(accumulated_context)
Â  Â  Â  Â  Â  Â  check_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºå½“å‰æ”¶é›†çš„ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦è¶³å¤Ÿå›ç­”é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  æ”¶é›†çš„ä¿¡æ¯: {context}
Â  Â  Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  å›ç­”YESå¦‚æœä¿¡æ¯è¶³å¤Ÿï¼Œå›ç­”NOå¦‚æœéœ€è¦æ›´å¤šä¿¡æ¯ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  å¦‚æœå›ç­”NOï¼Œè¯·æä¾›ä¸‹ä¸€æ­¥åº”è¯¥æœç´¢çš„å­é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  æ ¼å¼: YES æˆ– NO|å­é—®é¢˜"""</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  check_chain = check_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  Â  Â  check_response = check_chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â check_response.strip().upper().startswith(<span class="hljs-string">"YES"</span>):
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">break</span>
Â  Â  Â  Â  Â  Â Â eli<span class="hljs-string">f"|"</span><span class="hljs-keyword">in</span>Â check_response:
Â  Â  Â  Â  Â  Â  Â  Â  current_query = check_response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">1</span>].strip()
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</span>
Â  Â  Â  Â  final_context =Â <span class="hljs-string">"\n"</span>.join(accumulated_context)
Â  Â  Â  Â  final_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ç»¼åˆä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š\n{context}\n\né—®é¢˜ï¼š{question}\nç­”æ¡ˆï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  final_chain = final_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â final_chain.invoke({<span class="hljs-string">"context"</span>: final_context,Â <span class="hljs-string">"question"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">open_ended_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""å¼€æ”¾æ€§RAGï¼šå¹¿æ³›æ£€ç´¢+åˆ›é€ æ€§ç”Ÿæˆ"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># æ‰©å±•æŸ¥è¯¢</span>
Â  Â  Â  Â  expand_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ä¸ºä»¥ä¸‹é—®é¢˜ç”Ÿæˆ3ä¸ªç›¸å…³çš„æœç´¢æŸ¥è¯¢ï¼š\n{query}\næŸ¥è¯¢åˆ—è¡¨ï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  expand_chain = expand_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  expanded = expand_chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â  Â  Â  queries = [query] + [q.strip()Â <span class="hljs-keyword">for</span>Â qÂ <span class="hljs-keyword">in</span>Â expanded.split(<span class="hljs-string">"\n"</span>)Â <span class="hljs-keyword">if</span>Â q.strip()][:<span class="hljs-number">3</span>]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># å¤šæŸ¥è¯¢æ£€ç´¢</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â  all_docs = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â qÂ <span class="hljs-keyword">in</span>Â queries:
Â  Â  Â  Â  Â  Â  docs = retriever.invoke(q)
Â  Â  Â  Â  Â  Â  all_docs.extend([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># å»é‡</span>
Â  Â  Â  Â  unique_docs = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(all_docs))
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n"</span>.join(unique_docs[:<span class="hljs-number">5</span>])
Â  Â  Â  Â Â 
Â  Â  Â  Â  final_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¿¡æ¯ï¼Œå¯¹é—®é¢˜ç»™å‡ºå…¨é¢ã€æœ‰è§åœ°çš„å›ç­”ï¼š
Â  Â  Â  Â  Â  Â  ä¿¡æ¯: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·æä¾›è¯¦ç»†çš„åˆ†æå’Œè§è§£ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  final_chain = final_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â final_chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">no_retrieval_generate</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç›´æ¥ç”Ÿæˆï¼šä¸ä½¿ç”¨æ£€ç´¢"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"è¯·å›ç­”ï¼š{query}"</span>)
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""è‡ªé€‚åº”æŸ¥è¯¢ä¸»æµç¨‹ - ä½¿ç”¨LangChainè·¯ç”±"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆ†ç±»æŸ¥è¯¢</span>
Â  Â  Â  Â  query_type = self.classify_query(question)
Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŸ¥è¯¢ç±»å‹:Â <span class="hljs-subst">{query_type.value}</span>"</span>)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. è·¯ç”±åˆ°å¯¹åº”ç­–ç•¥</span>
Â  Â  Â  Â  routing_map = {
Â  Â  Â  Â  Â  Â  QueryType.SIMPLE: self.simple_rag,
Â  Â  Â  Â  Â  Â  QueryType.MULTI_HOP: self.multi_hop_rag,
Â  Â  Â  Â  Â  Â  QueryType.OPEN_ENDED: self.open_ended_rag,
Â  Â  Â  Â  Â  Â  QueryType.NO_RETRIEVAL: self.no_retrieval_generate
Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â routing_map[query_type](question)

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
arag = AdaptiveRAG()
arag.build_index([<span class="hljs-string">"å…¬å¸è´¢æŠ¥æ•°æ®..."</span>,Â <span class="hljs-string">"å¸‚åœºåˆ†ææŠ¥å‘Š..."</span>,Â <span class="hljs-string">"è¡Œä¸šè¶‹åŠ¿..."</span>])
answer = arag.query(<span class="hljs-string">"åˆ†æå…¬å¸æœªæ¥çš„å‘å±•å‰æ™¯"</span>) Â <span class="hljs-comment"># ä¼šè¢«è¯†åˆ«ä¸ºOPEN_ENDED</span>
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-7">8. SFR RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>SFR RAGï¼ˆSalesforce Research RAGï¼‰æ˜¯å·¥ä¸šçº§é«˜è´¨é‡ RAG çš„æœ€ä½³å®è·µã€‚å®ƒé‡‡ç”¨ç»è¿‡æŒ‡ä»¤å¾®è°ƒçš„é«˜æ€§èƒ½ embedding æ¨¡å‹ï¼ˆå¦‚ BGEï¼‰ï¼Œç»“åˆ Cross-Encoder é‡æ’åºã€ä¸Šä¸‹æ–‡å‹ç¼©ã€å¼•ç”¨ç”Ÿæˆå’Œè´¨é‡éªŒè¯ç­‰å¤šé¡¹ä¼˜åŒ–æŠ€æœ¯ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad02654af9d646f2854979047c43080d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=zLZu5nudCscefZbhgOBpnlaA%2BKA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>é«˜è´¨é‡Embeddingï¼šä½¿ç”¨SFRï¼ˆSalesforce Researchï¼‰çš„é«˜æ€§èƒ½embeddingæ¨¡å‹è¿›è¡Œæ–‡æ¡£å’ŒæŸ¥è¯¢ç¼–ç </li>
<li>æŒ‡ä»¤å¾®è°ƒæ£€ç´¢ï¼šä½¿ç”¨æŒ‡ä»¤å¾®è°ƒçš„æ£€ç´¢æ¨¡å‹ï¼Œæ”¯æŒå¤šç§æ£€ç´¢ä»»åŠ¡ï¼ˆé—®ç­”ã€æ‘˜è¦ã€äº‹å®æ ¸æŸ¥ç­‰ï¼‰</li>
<li>ä¸Šä¸‹æ–‡å‹ç¼©ï¼šå¯¹æ£€ç´¢åˆ°çš„æ–‡æ¡£è¿›è¡Œæ™ºèƒ½å‹ç¼©ï¼Œå»é™¤å†—ä½™ä¿¡æ¯</li>
<li>é‡æ’åºï¼šä½¿ç”¨ä¸“é—¨çš„é‡æ’åºæ¨¡å‹å¯¹å€™é€‰æ–‡æ¡£è¿›è¡Œç²¾ç»†æ’åº</li>
<li>å¼•ç”¨ç”Ÿæˆï¼šç”Ÿæˆç­”æ¡ˆæ—¶é™„å¸¦å¼•ç”¨æ¥æºï¼Œæé«˜å¯ä¿¡åº¦</li>
<li>è´¨é‡æ§åˆ¶ï¼šå¯¹ç”Ÿæˆç»“æœè¿›è¡Œäº‹å®æ€§æ£€éªŒå’Œè´¨é‡è¯„ä¼°</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.embeddingsÂ <span class="hljs-keyword">import</span>Â HuggingFaceBgeEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain_community.cross_encodersÂ <span class="hljs-keyword">import</span>Â HuggingFaceCrossEncoder
<span class="hljs-keyword">from</span>Â langchain.retrievers.document_compressorsÂ <span class="hljs-keyword">import</span>Â CrossEncoderReranker
<span class="hljs-keyword">from</span>Â langchain.retrieversÂ <span class="hljs-keyword">import</span>Â ContextualCompressionRetriever
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SFRRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨BGEé«˜è´¨é‡Embeddingæ¨¡å‹</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceBgeEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"BAAI/bge-large-en-v1.5"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>},
Â  Â  Â  Â  Â  Â  query_instruction=<span class="hljs-string">"ä¸ºæ£€ç´¢ä»»åŠ¡ç”ŸæˆæŸ¥è¯¢è¡¨ç¤º: "</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â <span class="hljs-comment"># é‡æ’åºæ¨¡å‹</span>
Â  Â  Â  Â  self.reranker_model = HuggingFaceCrossEncoder(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"cross-encoder/ms-marco-MiniLM-L-6-v2"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"./lancedb_sfr_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â  self.documents = []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºé«˜è´¨é‡å‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  self.documents = documents
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"sfr_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_retriever_with_reranker</span>(<span class="hljs-params">self, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">5</span></span>):
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ›å»ºå¸¦é‡æ’åºçš„æ£€ç´¢å™¨"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># åŸºç¡€æ£€ç´¢å™¨</span>
Â  Â  Â  Â  base_retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">10</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># é‡æ’åºå‹ç¼©å™¨</span>
Â  Â  Â  Â  reranker = CrossEncoderReranker(
Â  Â  Â  Â  Â  Â  model=self.reranker_model,Â 
Â  Â  Â  Â  Â  Â  top_n=top_k
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ç»„åˆæ£€ç´¢å™¨</span>
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â ContextualCompressionRetriever(
Â  Â  Â  Â  Â  Â  base_compressor=reranker,
Â  Â  Â  Â  Â  Â  base_retriever=base_retriever
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">compress_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, documents: <span class="hljs-type">List</span>[Document]</span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸Šä¸‹æ–‡å‹ç¼©"""</span>
Â  Â  Â  Â  doc_texts =Â <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"[<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>]Â <span class="hljs-subst">{doc.page_content}</span>"</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â i, docÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">enumerate</span>(documents)])
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""æå–ä»¥ä¸‹æ–‡æ¡£ä¸­ä¸é—®é¢˜ç›¸å…³çš„å…³é”®ä¿¡æ¯ï¼š
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  æ–‡æ¡£:
Â  Â  Â  Â  Â  Â  {documents}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·è¿”å›å‹ç¼©åçš„å…³é”®ä¿¡æ¯ï¼Œä¿ç•™æ–‡æ¡£ç¼–å·ä»¥ä¾¿å¼•ç”¨ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"documents"</span>: doc_texts})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_with_citations</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç”Ÿæˆå¸¦å¼•ç”¨çš„ç­”æ¡ˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼Œå¹¶æ ‡æ³¨å¼•ç”¨æ¥æº[1][2]ç­‰ã€‚
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¦æ±‚ï¼š
Â  Â  Â  Â  Â  Â  1. å‡†ç¡®å›ç­”é—®é¢˜
Â  Â  Â  Â  Â  Â  2. åœ¨ç›¸å…³é™ˆè¿°åæ ‡æ³¨å¼•ç”¨æ¥æº
Â  Â  Â  Â  Â  Â  3. å¦‚æœä¸Šä¸‹æ–‡ä¸è¶³ä»¥å›ç­”ï¼Œè¯·è¯´æ˜
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">verify_answer</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span>, documents: <span class="hljs-type">List</span>[Document]</span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""éªŒè¯ç­”æ¡ˆè´¨é‡"""</span>
Â  Â  Â  Â  doc_contents = [doc.page_contentÂ <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ä»¥ä¸‹ç­”æ¡ˆçš„è´¨é‡ï¼š
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â  å‚è€ƒæ–‡æ¡£: {documents}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯„ä¼°ç»´åº¦(1-5åˆ†)ï¼š
Â  Â  Â  Â  Â  Â  1. å‡†ç¡®æ€§ï¼šç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£æ”¯æŒ
Â  Â  Â  Â  Â  Â  2. å®Œæ•´æ€§ï¼šç­”æ¡ˆæ˜¯å¦å…¨é¢å›ç­”äº†é—®é¢˜
Â  Â  Â  Â  Â  Â  3. ç›¸å…³æ€§ï¼šç­”æ¡ˆæ˜¯å¦ç´§æ‰£é—®é¢˜
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: å‡†ç¡®æ€§åˆ†æ•°|å®Œæ•´æ€§åˆ†æ•°|ç›¸å…³æ€§åˆ†æ•°|æ€»è¯„"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"query"</span>: query,Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"answer"</span>: answer,Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"documents"</span>: doc_contents
Â  Â  Â  Â  })
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  parts = response.split(<span class="hljs-string">"|"</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"accuracy"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">0</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"completeness"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">1</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"relevance"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">2</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"summary"</span>: parts[<span class="hljs-number">3</span>].strip()Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(parts) &gt;Â <span class="hljs-number">3</span><span class="hljs-keyword">else</span><span class="hljs-string">""</span>
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {<span class="hljs-string">"accuracy"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"completeness"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"relevance"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"summary"</span>:Â <span class="hljs-string">""</span>}
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""SFR-RAGä¸»æµç¨‹"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆå§‹æ£€ç´¢ + é‡æ’åº</span>
Â  Â  Â  Â  retriever = self.get_retriever_with_reranker(top_k=<span class="hljs-number">5</span>)
Â  Â  Â  Â  docs = retriever.invoke(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. ä¸Šä¸‹æ–‡å‹ç¼©</span>
Â  Â  Â  Â  compressed_context = self.compress_context(question, docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. ç”Ÿæˆå¸¦å¼•ç”¨çš„ç­”æ¡ˆ</span>
Â  Â  Â  Â  answer = self.generate_with_citations(question, compressed_context)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. è´¨é‡éªŒè¯</span>
Â  Â  Â  Â  quality = self.verify_answer(question, answer, docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"answer"</span>: answer,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"sources"</span>: [{<span class="hljs-string">"content"</span>: doc.page_content[:<span class="hljs-number">100</span>]}Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs],
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"quality"</span>: quality
Â  Â  Â  Â  }

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
sfr_rag = SFRRAG()
sfr_rag.build_index([
Â  Â Â <span class="hljs-string">"äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯..."</span>,
Â  Â Â <span class="hljs-string">"æœºå™¨å­¦ä¹ æ˜¯AIçš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€..."</span>,
Â  Â Â <span class="hljs-string">"æ·±åº¦å­¦ä¹ ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œå­¦ä¹ ..."</span>
])
result = sfr_rag.query(<span class="hljs-string">"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­”æ¡ˆ:Â <span class="hljs-subst">{result[<span class="hljs-string">'answer'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è´¨é‡è¯„ä¼°:Â <span class="hljs-subst">{result[<span class="hljs-string">'quality'</span>]}</span>"</span>)
</code></pre>
<h2 data-id="heading-8">å‚è€ƒ</h2>
<p>ï¼ˆ1ï¼‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flangchain%2Foverview" target="_blank" title="https://docs.langchain.com/oss/python/langchain/overview" ref="nofollow noopener noreferrer">docs.langchain.com/oss/python/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€]]></title>    <link>https://juejin.cn/post/7585377128490532916</link>    <guid>https://juejin.cn/post/7585377128490532916</guid>    <pubDate>2025-12-19T16:19:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377128490532916" data-draft-id="7585385309891526656" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-19T16:19:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T16:19:15.000Z" title="Fri Dec 19 2025 16:19:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è€å®è¯´ï¼Œåœ¨ AI æ¨¡å‹åƒä¸‹é¥ºå­ä¸€æ ·å‘å¸ƒçš„ 2025 å¹´å¹´åº•ï¼Œå¤§å®¶å¯¹â€œé¢ è¦†æ€§å‡çº§â€è¿™ä¸ªè¯æ—©å°±è„±æ•äº†ã€‚ä½† OpenAI åˆšåˆšåœ¨ 12 æœˆ 18 æ—¥æ‚„æ‚„æ”¾å‡ºçš„ GPT-5.2-Codexï¼Œè¿˜æ˜¯è®©ä¸å°‘ç†¬å¤œå†™ä»£ç çš„å·¥ç¨‹å¸ˆè™èº¯ä¸€éœ‡ã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯ GPT-5.2 çš„ä¸€ä¸ªå¾®è°ƒç‰ˆæœ¬ï¼Œæ›´åƒæ˜¯ä¸€æ¬¡é’ˆå¯¹ç¨‹åºå‘˜ç—›ç‚¹çš„â€œç²¾å‡†çˆ†ç ´â€ã€‚å¦‚æœè¯´ä»¥å‰çš„ AI æ˜¯å¸®ä½ è¡¥å…¨ä»£ç çš„å®ä¹ ç”Ÿï¼Œé‚£ä¹ˆè¿™æ¬¡ä¸Šçº¿çš„ Codexï¼Œæ›´åƒæ˜¯ä¸€ä¸ªèƒ½æ‰›äº‹å„¿çš„â€œé«˜çº§åˆä¼™äººâ€ã€‚</p>
<p>æˆ‘èŠ±äº†ä¸€ç‚¹æ—¶é—´æ‰’äº†æ‰’è¿™èƒŒåçš„æŠ€æœ¯ç»†èŠ‚å’Œå®æµ‹æ•°æ®ï¼Œæœ‰äº›ä¸œè¥¿ç¡®å®å€¼å¾—èŠèŠã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Feergertg-1024x468.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/eergertg-1024x468.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/355f433ab89041c0b69fbedcb6314329~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=%2B43n99d%2FOVt16Kd3ZC2FB%2FjRY8Q%3D" alt="eergertg" loading="lazy"/></a></p>
<h3 data-id="heading-0">å‘Šåˆ«â€œé‡‘é±¼è®°å¿†â€ï¼šä¸Šä¸‹æ–‡å‹ç¼©æŠ€æœ¯</h3>
<p>ä»¥å‰ç”¨ AI å†™ä»£ç ï¼Œæœ€å¤§çš„å´©æºƒç¬é—´æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä½ æŠŠæ•´ä¸ªé¡¹ç›®æ‰”ç»™å®ƒï¼ŒèŠåˆ°ç¬¬åè½®å¯¹è¯æ—¶ï¼Œå®ƒçªç„¶å¿˜è®°äº†å¼€å¤´å®šä¹‰çš„å˜é‡ã€‚</p>
<p>GPT-5.2-Codex æœ€å¤§çš„çœ‹ç‚¹å°±åœ¨äº**â€œä¸Šä¸‹æ–‡å‹ç¼©â€æŠ€æœ¯**ã€‚è¿™å¬èµ·æ¥å¾ˆå­¦æœ¯ï¼Œä½†ç”¨å¤§ç™½è¯è§£é‡Šå°±æ˜¯ï¼šå®ƒå­¦ä¼šäº†åˆ’é‡ç‚¹ã€‚</p>
<p>åœ¨å¤„ç†é‚£äº›æŒç»­æ•°å‘¨ã€ä»£ç é‡å·¨å¤§çš„å¤æ‚ä»»åŠ¡æ—¶ï¼Œå®ƒä¸å†æ˜¯å‚»å‚»åœ°æŠŠæ‰€æœ‰ Token å¡è¿›å†…å­˜ï¼Œè€Œæ˜¯èƒ½åŠ¨æ€å‹ç¼©æ¨ç†è¿‡ç¨‹ï¼Œä¿ç•™æ ¸å¿ƒé€»è¾‘ã€‚å®˜æ–¹æ•°æ®æ˜¾ç¤ºï¼Œè¿™ç§æœºåˆ¶è®© Token çš„ä½¿ç”¨æ•ˆç‡æå‡äº† 30%ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½ è¿›è¡Œå¤§è§„æ¨¡é‡æ„æˆ–è€…è·¨è¯­è¨€è¿ç§»è¿™ç§â€œé•¿è·‘â€ä»»åŠ¡æ—¶ï¼Œå®ƒä¸ä¼šè·‘åˆ°ä¸€åŠå°±æ–­ç‰‡å„¿ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Ferhgrth-1024x683.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/erhgrth-1024x683.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b3be86eeb07468e8d767efeaee43239~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=P9NbElypS3RM9w4sxLAojjMCRs0%3D" alt="erhgrth" loading="lazy"/></a></p>
<h3 data-id="heading-1">çœŸå®çš„å·¥ç¨‹èƒ½åŠ›ï¼Œè€Œä¸åªæ˜¯åˆ·é¢˜</h3>
<p>å¾ˆå¤šæ¨¡å‹åœ¨åš LeetCode ç®—æ³•é¢˜æ—¶çŒ›å¦‚è™ï¼Œä¸€åˆ°çœŸå®çš„ä¸šåŠ¡ä»£ç é‡Œå°±æ­‡èœã€‚OpenAI è¿™æ¬¡ä¼¼ä¹å¬åˆ°äº†å¼€å‘è€…çš„åæ§½ï¼Œä¸“é—¨å¼ºåŒ–äº† GPT-5.2-Codex çš„<strong>å·¥ç¨‹å®æˆ˜èƒ½åŠ›</strong>ã€‚</p>
<p>ä¸¤ä¸ªæ•°æ®å¾ˆæœ‰æ„æ€ï¼š</p>
<ol>
<li><strong>SWE-Bench Pro</strong>ï¼ˆè½¯ä»¶å·¥ç¨‹ä»»åŠ¡ï¼‰çš„å®Œæˆç‡å†²åˆ°äº† <strong>56.4%</strong>ã€‚åˆ«è§‰å¾—è¿™ä¸ªæ•°å­—ä½ï¼Œåœ¨å…¨æ˜¯å‘çš„çœŸå®è½¯ä»¶å¼€å‘ç¯å¢ƒä¸­ï¼Œèƒ½è¿‡åŠæ•°ä»»åŠ¡ä¸å‡ºé”™ï¼Œå·²ç»æ˜¯ç›®å‰çš„è¡Œä¸šå¤©èŠ±æ¿ã€‚</li>
<li><strong>Terminal-Bench 2.0</strong>ï¼ˆç»ˆç«¯æ“ä½œï¼‰å‡†ç¡®ç‡è¾¾åˆ°äº† <strong>64%</strong>ã€‚</li>
</ol>
<p>æ›´è´´å¿ƒçš„æ˜¯ï¼Œå®ƒç»ˆäºä¸å†åªæ˜¯ Linux ä¼˜å…ˆäº†ã€‚OpenAI ä¸“é—¨ä¼˜åŒ–äº†å®ƒåœ¨ <strong>åŸç”Ÿ Windows 10/11 ç¯å¢ƒ</strong>ä¸‹çš„è¡¨ç°ã€‚å¯¹äºé‚£äº›åœ¨è¿™ä¸ªç”Ÿæ€é‡Œæ‘¸çˆ¬æ»šæ‰“çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ç»å¯¹æ˜¯ä¸ªè¿Ÿæ¥çš„å¥½æ¶ˆæ¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Ffsdfsdg.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/fsdfsdg.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3962bef769b047538897b321eab0ce8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=EJYuxjqFNKMdBm8sWkHn4dPbYEs%3D" alt="fsdfsdg" loading="lazy"/></a></p>
<h3 data-id="heading-2">çœ‹åˆ°â€œè‰å›¾â€å°±èƒ½å†™ä»£ç </h3>
<p>è™½ç„¶æˆ‘ä»¬å¼ºè°ƒå®ƒæ˜¯ä¸ªåç«¯å¼ºæ‰‹ï¼Œä½†è¿™æ¬¡çš„è§†è§‰ç†è§£èƒ½åŠ›ä¹Ÿè®©äººå°è±¡æ·±åˆ»ã€‚</p>
<p>ä½ ç°åœ¨å¯ä»¥æŠŠä¸€å¼ ç”»åœ¨é¤å·¾çº¸ä¸Šçš„ UI è‰å›¾ï¼Œæˆ–è€…ä¸€å¼ å¤æ‚çš„æŠ€æœ¯æ¶æ„å›¾æ‰”ç»™å®ƒï¼Œå®ƒèƒ½ç›´æ¥ç†è§£å¹¶è½¬åŒ–ä¸ºåŸå‹çš„ä»£ç ã€‚è¿™å¯¹äºäº§å“ç»ç†æˆ–è€…å…¨æ ˆå¼€å‘è€…æ¥è¯´ï¼Œä»â€œæƒ³æ³•â€åˆ°â€œDemoâ€çš„æ—¶é—´è¢«æåº¦å‹ç¼©äº†ã€‚</p>
<h3 data-id="heading-3">ä¸€æŠŠåŒåˆƒå‰‘ï¼šå¼ºæ‚çš„å®‰å…¨æ”»é˜²èƒ½åŠ›</h3>
<p>è¿™é‡Œå¿…é¡»å¾—æä¸ªé†’ã€‚GPT-5.2-Codex çš„ä»£ç å®¡è®¡èƒ½åŠ›å¼ºå¾—æœ‰ç‚¹è®©äººå®³æ€•ã€‚</p>
<p>æœ‰ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ï¼šå®‰å…¨ç ”ç©¶å‘˜ç”¨å®ƒçš„å‰ä»£æ¨¡å‹ï¼Œåœ¨ä¸€å‘¨å†…å°±æŒ–å‡ºäº† React æ¡†æ¶é‡Œçš„ä¸‰ä¸ªå®‰å…¨æ¼æ´ã€‚åˆ°äº†è¿™ä¸€ä»£ï¼Œå®ƒçš„é˜²å¾¡æ€§ç¼–ç¨‹å’Œæ¼æ´æŒ–æ˜èƒ½åŠ›æ›´ä¸Šäº†ä¸€å±‚æ¥¼ã€‚</p>
<p>æ­£å› ä¸ºè¿™æŠŠâ€œåˆ€â€å¤ªå¿«ï¼ŒOpenAI ç›®å‰é‡‡å–äº†éå¸¸è°¨æ…çš„å‘å¸ƒç­–ç•¥ã€‚è™½ç„¶ä»˜è´¹çš„ ChatGPT ç”¨æˆ·å·²ç»åœ¨ Codex ç•Œé¢é‡Œç”¨ä¸Šäº†ï¼Œä½† API æ¥å£è¿˜å¾—ç­‰å‡ å‘¨æ‰ä¼šé€æ­¥å¼€æ”¾ã€‚ç‰¹åˆ«æ˜¯é’ˆå¯¹é«˜é˜¶çš„ç½‘ç»œå®‰å…¨åŠŸèƒ½ï¼ŒOpenAI æäº†ä¸ªâ€œå¯ä¿¡è®¿é—®è¯•ç‚¹è®¡åˆ’â€ï¼Œç”Ÿæ€•è¢«åäººæ‹¿å»æç ´åã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fhryjytj-1024x809.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/hryjytj-1024x809.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc68bf1514f24b909f3fcd69852c463b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=4hPO1f%2FsW50MKfDhmCeuh%2FsfNCw%3D" alt="hryjytj" loading="lazy"/></a></p>
<h3 data-id="heading-4">å†™åœ¨æœ€å</h3>
<p>ç°åœ¨çš„ GPT-5.2-Codex å®Œç¾å—ï¼Ÿè‚¯å®šä¸ã€‚å®ƒä¾ç„¶æ˜‚è´µï¼Œä¾ç„¶éœ€è¦äººå·¥ Code Reviewï¼Œä¾ç„¶å¯èƒ½åœ¨ä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“ã€‚</p>
<p>ä½†å®ƒçš„å‡ºç°æ ‡å¿—ç€ä¸€ä¸ªè½¬å˜ï¼šAI æ­£åœ¨ä»ä¸€ä¸ªâ€œè¢«åŠ¨å“åº”â€çš„å·¥å…·ï¼Œå˜æˆä¸€ä¸ªèƒ½å¤Ÿâ€œä¸»åŠ¨æ‰§è¡Œâ€é•¿é“¾è·¯ä»»åŠ¡çš„æ™ºèƒ½ä½“ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬è¿™äº›å¼€å‘è€…æ¥è¯´ï¼Œå¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ æœ‰â€œæ‹–å»¶ç—‡â€ï¼Œä¸çŸ¥é“å¤æ‚é¡¹ç›®ä»ä½•ä¸‹æ‰‹ï¼ŒæŠŠå®ƒå½“æˆæ€ç»´é™ªç»ƒå’Œèµ·æ­¥å·¥å…·ä¼šéå¸¸é¡ºæ‰‹ï¼›åæ¶ˆæ¯æ˜¯ï¼Œç•™ç»™åªä¼šå†™ CRUD çš„â€œä»£ç æ¬è¿å·¥â€çš„æ—¶é—´ï¼ŒçœŸçš„ä¸å¤šäº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fsdgfdgdfh-1024x496.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/sdgfdgdfh-1024x496.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/986c94a5c40b42b08d4c6c3407b09b6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=Lgt1JkThVJ6JIUKig0%2BTWDs9Tcc%3D" alt="sdgfdgdfh" loading="lazy"/></a></p>
<p>ç›®å‰è¿™ä¸ªæ¨¡å‹å·²ç»å‘æ‰€æœ‰ Plus ç”¨æˆ·å…¨é‡æ¨é€ã€‚å»ºè®®ä½ å»è¯•ç€ç”¨å®ƒè·‘ä¸€ä¸ªè¿˜æ²¡å¡«å®Œçš„å‘ï¼Œä¹Ÿè®¸ä¼šæœ‰æƒŠå–œã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº]]></title>    <link>https://juejin.cn/post/7571060853354283018</link>    <guid>https://juejin.cn/post/7571060853354283018</guid>    <pubDate>2025-11-10T15:58:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571060853354283018" data-draft-id="7570903763722436618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº"/> <!----> <meta itemprop="datePublished" content="2025-11-10T15:58:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¦å°”æ‘©æ–¯çš„å¼Ÿå­"/> <meta itemprop="url" content="https://juejin.cn/user/622743759107883"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/622743759107883/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¦å°”æ‘©æ–¯çš„å¼Ÿå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T15:58:40.000Z" title="Mon Nov 10 2025 15:58:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº</h2>
<h3 data-id="heading-1">é¢è¯•åœºæ™¯ï¼šæŸå¤§å‚æŠ€æœ¯äºŒé¢ç°åœºï¼Œä¼šè®®å®¤é‡Œåç€ä¸€ä½ç¥æƒ…ä¸¥è‚ƒçš„é¢è¯•å®˜ï¼Œå¯¹é¢æ˜¯æ»¡è„¸å†™ç€"æˆ‘å¯èƒ½è¦å‡‰äº†"çš„ç¨‹åºå‘˜è°¢é£æœºã€‚</h3>
<h4 data-id="heading-2"><strong>ç¬¬ä¸€è½®æé—®ï¼šåŸºç¡€å¤¯å®</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šè°¢é£æœºï¼Œå…ˆèŠèŠä½ å¯¹Javaå†…å­˜æ¨¡å‹çš„ç†è§£å§ã€‚æˆ‘ä»¬å…¬å¸ç”¨çš„æ˜¯JDK17ï¼Œä½ èƒ½è¯´è¯´å®ƒå’ŒJDK8åœ¨å†…å­˜æ¨¡å‹ä¸Šçš„ä¸»è¦åŒºåˆ«å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼ˆæŒ å¤´ï¼‰ï¼šå‘ƒâ€¦â€¦æˆ‘è®°å¾—å¥½åƒæœ‰å †ã€æ ˆã€æ–¹æ³•åŒºï¼Œè¿˜æœ‰ä¸ªå…ƒç©ºé—´å¯¹å§ï¼Ÿä»¥å‰å«æ°¸ä¹…ä»£ï¼Œç°åœ¨æ”¹åå«å…ƒç©ºé—´äº†ï¼Œå› ä¸ºâ€¦â€¦å—¯â€¦â€¦æ›´é«˜çº§äº†ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆå¾®å¾®ç‚¹å¤´ï¼‰ï¼šä¸é”™ï¼Œå›ç­”å¾—æŒºå‡†ç¡®ã€‚é‚£ä½ çŸ¥é“ä¸ºä»€ä¹ˆè¦æŠŠæ°¸ä¹…ä»£æ¢æˆå…ƒç©ºé—´å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå› ä¸ºâ€¦â€¦æ°¸ä¹…ä»£å®¹æ˜“å†…å­˜æº¢å‡ºï¼Œè€Œä¸”ä¸èƒ½åŠ¨æ€æ‰©å®¹ï¼Œè€Œå…ƒç©ºé—´æ˜¯æ”¾åœ¨æœ¬åœ°å†…å­˜é‡Œçš„ï¼Œä¸ä¼šå—å †å¤§å°é™åˆ¶ï¼Œæ‰€ä»¥æ›´ç¨³ï¼</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆå¾®ç¬‘ï¼‰ï¼šå¾ˆå¥½ï¼Œå›ç­”å¾—å¾ˆåˆ°ä½ã€‚ç»§ç»­ï¼Œè¯´è¯´volatileå…³é”®å­—çš„ä½œç”¨ï¼Œä»¥åŠå®ƒå¦‚ä½•ä¿è¯å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼Œvolatileå°±æ˜¯è®©å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œæ¯æ¬¡è¯»éƒ½ä»ä¸»å†…å­˜æ‹¿ï¼Œå†™ä¹Ÿç›´æ¥å†™åˆ°ä¸»å†…å­˜ï¼Œè¿™æ ·å°±ä¿è¯äº†å¯è§æ€§ã€‚è‡³äºæŒ‡ä»¤é‡æ’åºï¼Œå®ƒä¼šåŠ ä¸€ä¸ªå†…å­˜å±éšœï¼Œé˜»æ­¢ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¹±åºæ‰§è¡Œï¼Œå¯¹å§ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼Œçœ‹æ¥ä½ ç¡®å®æŒæ¡äº†æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h4 data-id="heading-3"><strong>ç¬¬äºŒè½®æé—®ï¼šå¹¶å‘ä¸çº¿ç¨‹æ± </strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥å¤šçº¿ç¨‹éƒ¨åˆ†ã€‚ä½ èƒ½ä¸èƒ½è§£é‡Šä¸€ä¸‹çº¿ç¨‹æ± çš„æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›ï¼Ÿå®ƒä»¬å„è‡ªçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€å·¥ä½œé˜Ÿåˆ—ã€æ‹’ç»ç­–ç•¥ã€çº¿ç¨‹å·¥å‚ã€è¶…æ—¶æ—¶é—´â€¦â€¦å•Šï¼Œè¿˜æœ‰ä¸ªçº¿ç¨‹å­˜æ´»æ—¶é—´ã€‚æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯æœ€ä½ä¿æŒçš„çº¿ç¨‹æ•°é‡ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ˜¯ä¸Šé™ï¼Œå·¥ä½œé˜Ÿåˆ—æ”¾ä»»åŠ¡ï¼Œæ‹’ç»ç­–ç•¥å¤„ç†æ¥ä¸åŠçš„ä»»åŠ¡ï¼Œçº¿ç¨‹å·¥å‚ç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œå­˜æ´»æ—¶é—´æ˜¯ç©ºé—²çº¿ç¨‹ç­‰å¾…ä»»åŠ¡çš„æ—¶é—´ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸æ¸…æ™°ï¼Œé€»è¾‘å®Œæ•´ã€‚é‚£ä¹ˆï¼Œå¦‚æœä½¿ç”¨ThreadPoolExecutorï¼Œä½ å¦‚ä½•åˆç†è®¾ç½®è¿™äº›å‚æ•°æ¥åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Ÿæ¯”å¦‚ä¸€ä¸ªç§’æ€ç³»ç»Ÿã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼šå—¯â€¦â€¦æˆ‘è§‰å¾—å¯ä»¥è®¾æ ¸å¿ƒçº¿ç¨‹æ•°ä¸ºæœåŠ¡å™¨æ ¸æ•°çš„ä¸¤å€ï¼Œæœ€å¤§çº¿ç¨‹æ•°å¯ä»¥å†ç¿»å€ï¼Œå·¥ä½œé˜Ÿåˆ—ç”¨é˜»å¡é˜Ÿåˆ—ï¼Œæ¯”å¦‚LinkedBlockingQueueï¼Œæ‹’ç»ç­–ç•¥ç”¨CallerRunsPolicyï¼Œè¿™æ ·èƒ½é˜²æ­¢ç³»ç»Ÿé›ªå´©ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šæ€è·¯å¾ˆæ¸…æ™°ã€‚ä½†æœ‰æ²¡æœ‰è€ƒè™‘è¿‡é˜Ÿåˆ—é•¿åº¦è¿‡å¤§å¸¦æ¥çš„å†…å­˜å‹åŠ›ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå•Šâ€¦â€¦è¿™ä¸ªâ€¦â€¦æˆ‘è¿˜æ²¡æƒ³é‚£ä¹ˆæ·±â€¦â€¦ä¸è¿‡åæ­£æœ‰æ‹’ç»ç­–ç•¥å…œåº•å˜›ï¼Œåº”è¯¥æ²¡é—®é¢˜å§ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆè½»ç¬‘ï¼‰ï¼šå»ºè®®ä½ è®°ä½ä¸€å¥è¯ï¼š<strong>é˜Ÿåˆ—ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒåªæ˜¯å»¶è¿Ÿé—®é¢˜ï¼Œä¸æ˜¯è§£å†³é—®é¢˜</strong>ã€‚ç»§ç»­ï¼Œè¯´è¯´ä½ å¯¹ThreadLocalçš„ç†è§£ï¼Œå®ƒæœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼ŒThreadLocalå°±æ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å‰¯æœ¬ï¼Œäº’ä¸å¹²æ‰°ï¼Œé€‚åˆåšçº¿ç¨‹éš”ç¦»ï¼Œæ¯”å¦‚ä¿å­˜ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€äº‹åŠ¡ä¸Šä¸‹æ–‡ä»€ä¹ˆçš„ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚ä½†è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå•Šâ€¦â€¦è¦è®°å¾—åœ¨finallyé‡Œremoveæ‰ï¼Œä¸ç„¶å¯èƒ½å†…å­˜æ³„æ¼â€¦â€¦</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¯¹ï¼Œè¿™æ˜¯å…³é”®ç‚¹ï¼Œå¾ˆå¤šæ–°äººä¼šå¿½ç•¥ã€‚</p>
<h4 data-id="heading-4"><strong>ç¬¬ä¸‰è½®æé—®ï¼šæ¡†æ¶ä¸ä¸­é—´ä»¶</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚ç°åœ¨æˆ‘ä»¬è¿›å…¥æ¡†æ¶éƒ¨åˆ†ã€‚ä½ ç”¨è¿‡Spring Bootï¼Œèƒ½è¯´è¯´å®ƒçš„è‡ªåŠ¨è£…é…æœºåˆ¶æ˜¯æ€ä¹ˆå·¥ä½œçš„å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼Œè‡ªåŠ¨è£…é…å°±æ˜¯é€šè¿‡@Importã€@ConditionalOnClassè¿™äº›æ³¨è§£ï¼Œæ ¹æ®ç±»è·¯å¾„æ˜¯å¦å­˜åœ¨æŸäº›ç±»æ¥å†³å®šæ˜¯å¦åŠ è½½é…ç½®ç±»ã€‚æ¯”å¦‚ä½ å¼•å…¥äº†Redisä¾èµ–ï¼Œå°±ä¼šè‡ªåŠ¨é…ç½®RedisTemplateã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸å‡†ç¡®ã€‚é‚£Springçš„Beanç”Ÿå‘½å‘¨æœŸæœ‰å‡ ä¸ªé˜¶æ®µï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå®ä¾‹åŒ–ã€å±æ€§èµ‹å€¼ã€åˆå§‹åŒ–ã€é”€æ¯â€¦â€¦å•Šï¼Œè¿˜æœ‰ä¸ªAwareæ¥å£å›è°ƒï¼Œæ¯”å¦‚ApplicationContextAwareï¼Œè¿˜æœ‰InitializingBeanæ¥å£ï¼Œç„¶åæ‰æ˜¯postConstructâ€¦â€¦</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ï¼Œä½ æŠŠæ•´ä¸ªæµç¨‹éƒ½è¯´æ¸…æ¥šäº†ã€‚é‚£ä½ è¯´è¯´MyBatisçš„ç¼“å­˜æœºåˆ¶ï¼Œä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ï¼ŒåŒä¸€ä¸ªSqlSessioné‡ŒæŸ¥è¯¢æ•°æ®ä¼šå‘½ä¸­ï¼›äºŒçº§ç¼“å­˜æ˜¯Mapperçº§åˆ«çš„ï¼Œè·¨SqlSessionå…±äº«ï¼Œä½†éœ€è¦æ‰‹åŠ¨å¼€å¯ï¼Œå¹¶ä¸”å®ä½“ç±»è¦å®ç°Serializableã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸å‡†ç¡®ã€‚é‚£åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼ŒäºŒçº§ç¼“å­˜æ€ä¹ˆè§£å†³ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šè¿™ä¸ªâ€¦â€¦æˆ‘å¥½åƒæ²¡é‡åˆ°è¿‡â€¦â€¦ä¹Ÿè®¸å¯ä»¥ç”¨Redisåšåˆ†å¸ƒå¼ç¼“å­˜ï¼Ÿæˆ–è€…â€¦â€¦åŠ ä¸ªç‰ˆæœ¬å·ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆç‚¹å¤´ï¼‰ï¼šä¸é”™ï¼Œæ€è·¯æ‰“å¼€äº†ã€‚æœ€åä¸€ä¸ªé—®é¢˜ï¼Œè°ˆè°ˆä½ å¯¹DDDé¢†åŸŸé©±åŠ¨è®¾è®¡çš„ç†è§£ï¼Œå®ƒå’Œä¼ ç»Ÿçš„åˆ†å±‚æ¶æ„æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå—¯â€¦â€¦å°±æ˜¯æŠŠä¸šåŠ¡é€»è¾‘æ‹†æˆä¸€ä¸ªä¸ªé¢†åŸŸï¼Œç”¨å®ä½“ã€å€¼å¯¹è±¡ã€èšåˆæ ¹æ¥å»ºæ¨¡ï¼Œç„¶åç”¨é¢†åŸŸæœåŠ¡æ¥å¤„ç†å¤æ‚é€»è¾‘ã€‚ç›¸æ¯”ä¼ ç»Ÿæ¶æ„ï¼Œå®ƒæ›´è´´è¿‘ä¸šåŠ¡ï¼Œä»£ç æ›´æœ‰å±‚æ¬¡æ„Ÿï¼Œä¸å®¹æ˜“æ··ä¹±ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ï¼Œå›ç­”å¾—å¾ˆæœ‰æ·±åº¦ã€‚è™½ç„¶æœ‰äº›åœ°æ–¹ç•¥æ˜¾ç²—ç³™ï¼Œä½†æ•´ä½“ç†è§£åˆ°ä½ã€‚</p>
<h4 data-id="heading-5"><strong>ç»“æŸè¯­</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šè°¢é£æœºï¼Œä»Šå¤©çš„é¢è¯•å°±åˆ°è¿™é‡Œã€‚ä½ çš„åŸºç¡€çŸ¥è¯†æ‰å®ï¼Œå¯¹ä¸»æµæ¡†æ¶æœ‰è¾ƒæ·±ç†è§£ï¼Œè™½ç„¶åœ¨ä¸€äº›ç»†èŠ‚ä¸Šè¿˜ç•¥æœ‰æ¬ ç¼ºï¼Œä½†æ½œåŠ›å¾ˆå¤§ã€‚è¯·å›å»ç­‰é€šçŸ¥ï¼Œæˆ‘ä»¬ä¼šåœ¨3ä¸ªå·¥ä½œæ—¥å†…ç»™ä½ ç­”å¤ã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼ˆæ¾äº†ä¸€å£æ°”ï¼‰ï¼šè°¢è°¢é¢è¯•å®˜ï¼æˆ‘å›å»å¥½å¥½è¡¥è¯¾ï¼Œäº‰å–ä¸‹æ¬¡åˆ«å†è¢«é—®æ‡µäº†ï¼</p>
<hr/>
<h3 data-id="heading-6">ç­”æ¡ˆè¯¦è§£ï¼šæ ¸å¿ƒæŠ€æœ¯ç‚¹è§£æï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰</h3>
<h4 data-id="heading-7">1. Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</h4>
<ul>
<li><strong>å †</strong>ï¼šå­˜æ”¾æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œåƒåœ¾å›æ”¶çš„ä¸»è¦åŒºåŸŸã€‚</li>
<li><strong>æ ˆ</strong>ï¼šå­˜æ”¾å±€éƒ¨å˜é‡ã€æ–¹æ³•è°ƒç”¨æ ˆå¸§ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹ã€‚</li>
<li><strong>æ–¹æ³•åŒº</strong>ï¼šå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰ï¼ŒJDK8åæ›´åä¸º<strong>å…ƒç©ºé—´</strong>ï¼ˆMetaspaceï¼‰ï¼Œä½äºæœ¬åœ°å†…å­˜ï¼Œä¸å†å—é™äºå †å¤§å°ã€‚</li>
<li><strong>å…ƒç©ºé—´æ›¿ä»£æ°¸ä¹…ä»£çš„åŸå› </strong>ï¼šæ°¸ä¹…ä»£åœ¨å †ä¸­ï¼Œå®¹æ˜“å¯¼è‡´<code>OutOfMemoryError</code>ï¼›å…ƒç©ºé—´ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œå¯åŠ¨æ€æ‰©å±•ï¼Œé¿å…å†…å­˜æº¢å‡ºã€‚</li>
</ul>
<h4 data-id="heading-8">2. volatileå…³é”®å­—</h4>
<ul>
<li><strong>å¯è§æ€§</strong>ï¼šå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹volatileå˜é‡ï¼Œå…¶ä»–çº¿ç¨‹èƒ½ç«‹å³çœ‹åˆ°æœ€æ–°å€¼ï¼ˆé€šè¿‡å†…å­˜å±éšœåˆ·æ–°ä¸»å†…å­˜ï¼‰ã€‚</li>
<li><strong>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</strong>ï¼šæ’å…¥å†…å­˜å±éšœï¼Œé˜²æ­¢ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨å¯¹ä»£ç è¿›è¡Œä¹±åºä¼˜åŒ–ï¼Œç¡®ä¿æ‰§è¡Œé¡ºåºç¬¦åˆé¢„æœŸã€‚</li>
<li><strong>å…¸å‹åº”ç”¨</strong>ï¼šå•ä¾‹æ¨¡å¼ä¸­çš„åŒé‡æ£€æŸ¥é”ã€çŠ¶æ€æ ‡å¿—ä½ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-9">3. çº¿ç¨‹æ± æ ¸å¿ƒå‚æ•° &amp; è°ƒä¼˜</h4>
<ul>
<li><code>corePoolSize</code>ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå³ä½¿ç©ºé—²ä¹Ÿä¸ä¼šè¢«å›æ”¶ã€‚</li>
<li><code>maximumPoolSize</code>ï¼šæœ€å¤§çº¿ç¨‹æ•°ï¼Œè¶…è¿‡æ ¸å¿ƒæ•°åæ‰åˆ›å»ºæ–°çº¿ç¨‹ã€‚</li>
<li><code>workQueue</code>ï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œå¦‚<code>LinkedBlockingQueue</code>ï¼ˆæ— ç•Œï¼‰ã€<code>ArrayBlockingQueue</code>ï¼ˆæœ‰ç•Œï¼‰ã€<code>SynchronousQueue</code>ï¼ˆç›´æ¥æäº¤ï¼‰ã€‚</li>
<li><code>rejectedExecutionHandler</code>ï¼šæ‹’ç»ç­–ç•¥ï¼Œå¦‚<code>AbortPolicy</code>ï¼ˆæŠ›å¼‚å¸¸ï¼‰ã€<code>CallerRunsPolicy</code>ï¼ˆç”±è°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>è°ƒä¼˜å»ºè®®</strong>ï¼š
<ul>
<li>CPUå¯†é›†å‹ä»»åŠ¡ï¼š<code>corePoolSize = CPUæ ¸æ•° + 1</code></li>
<li>I/Oå¯†é›†å‹ä»»åŠ¡ï¼š<code>corePoolSize = 2 * CPUæ ¸æ•°</code></li>
<li>é˜Ÿåˆ—é€‰æ‹©ï¼šé¿å…æ— ç•Œé˜Ÿåˆ—å¯¼è‡´å†…å­˜æº¢å‡ºï¼Œå»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—é…åˆæ‹’ç»ç­–ç•¥ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-10">4. ThreadLocalä½¿ç”¨æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹å‰¯æœ¬ï¼Œé€‚ç”¨äºçº¿ç¨‹éš”ç¦»åœºæ™¯ï¼ˆå¦‚ç”¨æˆ·ç™»å½•ä¸Šä¸‹æ–‡ã€äº‹åŠ¡ç®¡ç†ï¼‰ã€‚</li>
<li><strong>å¿…é¡»æ‰‹åŠ¨æ¸…ç†</strong>ï¼šåœ¨<code>finally</code>å—ä¸­è°ƒç”¨<code>threadLocal.remove()</code>ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå› ThreadLocalMapæŒæœ‰å¼ºå¼•ç”¨ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-11">5. Spring Bootè‡ªåŠ¨è£…é…åŸç†</h4>
<ul>
<li>åŸºäº<code>@EnableAutoConfiguration</code>æ³¨è§£ï¼Œæ‰«æ<code>META-INF/spring.factories</code>æ–‡ä»¶ï¼ŒåŠ è½½<code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>æŒ‡å®šçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li>
<li>ä½¿ç”¨<code>@ConditionalOnClass</code>ã€<code>@ConditionalOnMissingBean</code>ç­‰æ¡ä»¶æ³¨è§£æ§åˆ¶æ˜¯å¦ç”Ÿæ•ˆï¼Œå®ç°â€œæŒ‰éœ€åŠ è½½â€æœºåˆ¶ã€‚</li>
</ul>
<h4 data-id="heading-12">6. Spring Beanç”Ÿå‘½å‘¨æœŸ</h4>
<ol>
<li><strong>å®ä¾‹åŒ–</strong>ï¼šé€šè¿‡æ„é€ å‡½æ•°æˆ–å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚</li>
<li><strong>å±æ€§èµ‹å€¼</strong>ï¼šæ³¨å…¥ä¾èµ–ï¼ˆ@Autowiredï¼‰ã€‚</li>
<li><strong>Awareæ¥å£å›è°ƒ</strong>ï¼šå¦‚ApplicationContextAwareã€BeanNameAwareç­‰ã€‚</li>
<li><strong>InitializingBeanæ¥å£</strong>ï¼šè°ƒç”¨<code>afterPropertiesSet()</code>æ–¹æ³•ã€‚</li>
<li><strong>@PostConstructæ³¨è§£æ–¹æ³•</strong>ï¼šæ‰§è¡Œè‡ªå®šä¹‰åˆå§‹åŒ–é€»è¾‘ã€‚</li>
<li><strong>Beanåˆå§‹åŒ–å®Œæˆ</strong>ï¼šæ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚</li>
<li><strong>é”€æ¯</strong>ï¼šè°ƒç”¨<code>@PreDestroy</code>æˆ–<code>DisposableBean</code>æ¥å£æ–¹æ³•ã€‚</li>
</ol>
<h4 data-id="heading-13">7. MyBatisç¼“å­˜æœºåˆ¶</h4>
<ul>
<li><strong>ä¸€çº§ç¼“å­˜</strong>ï¼šé»˜è®¤å¼€å¯ï¼Œä½œç”¨åŸŸä¸ºSqlSessionï¼ŒåŒä¸€ä¼šè¯å†…é‡å¤æŸ¥è¯¢å‘½ä¸­ç¼“å­˜ã€‚</li>
<li><strong>äºŒçº§ç¼“å­˜</strong>ï¼šä½œç”¨åŸŸä¸ºMapperçº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼ˆ<code>&lt;cache /&gt;</code>æ ‡ç­¾ï¼‰ï¼Œè·¨ä¼šè¯å…±äº«ï¼Œä½†éœ€å®ä½“ç±»å®ç°<code>Serializable</code>æ¥å£ã€‚</li>
<li><strong>ä¸€è‡´æ€§é—®é¢˜</strong>ï¼šç”±äºç¼“å­˜å¼‚æ­¥æ›´æ–°ï¼Œå¯èƒ½å‡ºç°è„è¯»ã€‚è§£å†³æ–¹æ¡ˆï¼š
<ul>
<li>ç”¨Redisç­‰åˆ†å¸ƒå¼ç¼“å­˜æ›¿ä»£ã€‚</li>
<li>å¯ç”¨<code>@CacheNamespaceRef</code>å’Œ<code>@Options(flushCache = true)</code>å¼ºåˆ¶åˆ·æ–°ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-14">8. DDDé¢†åŸŸé©±åŠ¨è®¾è®¡æ ¸å¿ƒæ€æƒ³</h4>
<ul>
<li><strong>é¢†åŸŸæ¨¡å‹</strong>ï¼šä»¥ä¸šåŠ¡ä¸ºæ ¸å¿ƒï¼Œå°†å¤æ‚ä¸šåŠ¡æŠ½è±¡ä¸ºå®ä½“ï¼ˆEntityï¼‰ã€å€¼å¯¹è±¡ï¼ˆValue Objectï¼‰ã€èšåˆæ ¹ï¼ˆAggregate Rootï¼‰ã€‚</li>
<li><strong>åˆ†å±‚æ¶æ„</strong>ï¼š
<ul>
<li><strong>è¡¨ç°å±‚</strong>ï¼šå¤„ç†å‰ç«¯è¯·æ±‚ã€‚</li>
<li><strong>åº”ç”¨å±‚</strong>ï¼šåè°ƒé¢†åŸŸæœåŠ¡ï¼Œå¤„ç†ç”¨ä¾‹ã€‚</li>
<li><strong>é¢†åŸŸå±‚</strong>ï¼šåŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å’Œè§„åˆ™ã€‚</li>
<li><strong>åŸºç¡€è®¾æ–½å±‚</strong>ï¼šæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰å¤–éƒ¨ä¾èµ–ã€‚</li>
</ul>
</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤ï¼Œä¸šåŠ¡ä¸æŠ€æœ¯åˆ†ç¦»ï¼Œé€‚åˆå¤æ‚ç³»ç»Ÿé•¿æœŸæ¼”è¿›ã€‚</li>
</ul>
<hr/>
<blockquote>
<p>ğŸ“Œ <strong>æ€»ç»“</strong>ï¼šæœ¬æ¬¡é¢è¯•è™½æœ‰ç¬‘ç‚¹ï¼Œä½†å†…å®¹æ‰å®ã€‚æŒæ¡è¿™äº›æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæ˜¯ä½ å†²å‡»å¤§å‚çš„å…³é”®ä¸€æ­¥ã€‚æŒç»­å­¦ä¹ ï¼Œæœªæ¥å¯æœŸï¼</p>
</blockquote>
<p><strong>æ–‡ç« æ ‡ç­¾</strong>ï¼šJava, é¢è¯•, å¤šçº¿ç¨‹, SpringBoot, Redis, MySQL, JVM</p>
<p><strong>æ–‡ç« ç®€è¿°</strong>ï¼šä¸€åœºå……æ»¡ç¬‘ç‚¹ä¸å¹²è´§çš„é¢è¯•ç°åœºï¼Œä»åŸºç¡€åˆ°æ¡†æ¶ï¼Œä»å¹¶å‘åˆ°æ¶æ„ï¼Œå¸¦ä½ æ·±åº¦å¤ç›˜å¤§å‚é«˜é¢‘æŠ€æœ¯é—®é¢˜ã€‚é€šè¿‡æ•…äº‹åŒ–åœºæ™¯è¿˜åŸçœŸå®é¢è¯•æµç¨‹ï¼Œç­”æ¡ˆéƒ¨åˆ†è¯¦ç»†è§£ææ¯ä¸ªæŠ€æœ¯ç‚¹ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾æŒæ¡æ ¸å¿ƒçŸ¥è¯†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡]]></title>    <link>https://juejin.cn/post/7585446706326781961</link>    <guid>https://juejin.cn/post/7585446706326781961</guid>    <pubDate>2025-12-20T05:10:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585446706326781961" data-draft-id="7585463258690273289" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡"/> <meta itemprop="keywords" content="Android,APP"/> <meta itemprop="datePublished" content="2025-12-20T05:10:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„¤æ€’çš„ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/4125023358426190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023358426190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„¤æ€’çš„ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T05:10:11.000Z" title="Sat Dec 20 2025 05:10:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Android ç³»ç»Ÿå¼€å‘ä¸­ï¼Œä¸ºäº†ç²¾å‡†è¡¡é‡è¿›ç¨‹çš„å†…å­˜æ¶ˆè€—ï¼Œé€šå¸¸ä¼šä½¿ç”¨ <strong>VSSã€RSSã€PSSã€USS</strong> è¿™å››ä¸ªæŒ‡æ ‡ã€‚ç”±äºå†…å­˜å…±äº«æœºåˆ¶çš„å­˜åœ¨ï¼Œå•ä¸€çš„â€œå†…å­˜å ç”¨â€æ•°å­—å¾€å¾€æ— æ³•çœŸå®åæ˜ è¿›ç¨‹å¯¹ç³»ç»Ÿçš„å½±å“ï¼Œå› æ­¤è¿™å››ä¸ªæŒ‡æ ‡æä¾›äº†ä¸åŒç»´åº¦çš„è§‚å¯Ÿè§†è§’ã€‚</p>
<h2 data-id="heading-0">0x00 æ ¸å¿ƒå«ä¹‰è¯¦è§£</h2>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥ç†è§£ï¼šå‡è®¾è¿›ç¨‹ A ä½¿ç”¨äº† <strong>50MB ç§æœ‰å†…å­˜</strong>ï¼Œå¹¶ä¸è¿›ç¨‹ B å…±äº«ä¸€ä¸ª <strong>20MB çš„åŠ¨æ€åº“</strong>ã€‚</p>
<h3 data-id="heading-1"><strong>VSS (Virtual Set Size) - è™šæ‹Ÿè€—ç”¨å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹èƒ½è®¿é—®åˆ°çš„å…¨éƒ¨è™šæ‹Ÿåœ°å€ç©ºé—´å¤§å°ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šå·²åˆ†é…ä½†æœªå®é™…ä½¿ç”¨çš„å†…å­˜ã€æ˜ å°„åˆ°ç£ç›˜çš„æ–‡ä»¶ã€å…±äº«åº“å ç”¨çš„å…¨éƒ¨ç©ºé—´ç­‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ•°å€¼æœ€å¤§ã€‚å®ƒä¸ä»£è¡¨çœŸå®çš„ç‰©ç†å†…å­˜æ¶ˆè€—ï¼Œå¯¹äº<strong>æ€§èƒ½åˆ†ææ„ä¹‰è¾ƒå°</strong>ã€‚</li>
</ul>
<h3 data-id="heading-2"><strong>RSS (Resident Set Size) - å®é™…ä½¿ç”¨ç‰©ç†å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹å½“å‰å®é™…å ç”¨çš„ç‰©ç†å†…å­˜ï¼ˆRAMï¼‰ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šè¿›ç¨‹çš„ç§æœ‰å†…å­˜ + <strong>å…±äº«åº“çš„å…¨éƒ¨å¤§å°</strong>ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šå­˜åœ¨â€œé‡å¤è®¡ç®—â€ã€‚å¦‚æœæœ‰ 10 ä¸ªè¿›ç¨‹éƒ½ç”¨äº†é‚£ä¸ª 20MB çš„å…±äº«åº“ï¼Œæ¯ä¸ªè¿›ç¨‹çš„ RSS éƒ½ä¼šè®¡å…¥è¿™ 20MBã€‚å°†æ‰€æœ‰è¿›ç¨‹çš„ RSS ç›¸åŠ ï¼Œä¼šè¿œå¤§äºç³»ç»Ÿæ€»å†…å­˜ã€‚</li>
</ul>
<h3 data-id="heading-3"><strong>PSS (Proportional Set Size) - æ¯”ä¾‹åˆ†é…å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå°†å…±äº«åº“çš„å¤§å°æŒ‰å…±äº«è¿›ç¨‹çš„æ•°é‡<strong>å‡æ‘Š</strong>ã€‚</li>
<li><strong>è®¡ç®—</strong>ï¼šç§æœ‰å†…å­˜ + (å…±äº«åº“å¤§å° / å…±äº«è¯¥åº“çš„è¿›ç¨‹æ•°)ã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<strong>æœ€å®¢è§‚çš„æŒ‡æ ‡</strong>ã€‚å¦‚æœå°†ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹çš„ PSS ç›¸åŠ ï¼Œç»“æœå‡ ä¹ç­‰äºç³»ç»Ÿå®é™…æ¶ˆè€—çš„æ€»å†…å­˜ã€‚å®ƒæ˜¯è¡¡é‡è¿›ç¨‹ç³»ç»Ÿçº§è´Ÿæ‹…çš„æœ€ä½³æ ‡å‡†ã€‚</li>
</ul>
<h3 data-id="heading-4"><strong>USS (Unique Set Size) - è¿›ç¨‹ç‹¬å å†…å­˜ï¼ˆæœ€å¸¸ç”¨ï¼‰</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹å®Œå…¨ç‹¬å çš„ç‰©ç†å†…å­˜ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šåªæœ‰è¯¥è¿›ç¨‹èƒ½è®¿é—®åˆ°çš„ RAM åŒºåŸŸã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<strong>åˆ†æå†…å­˜æ³„éœ²çš„æ ¸å¿ƒæŒ‡æ ‡</strong>ã€‚å®ƒè¡¨ç¤ºå¦‚æœæ€æ­»è¯¥è¿›ç¨‹ï¼Œç³»ç»Ÿèƒ½ç«‹åˆ»å›æ”¶çš„å†…å­˜é‡ã€‚</li>
</ul>
<h2 data-id="heading-5">0x01 æ ¸å¿ƒåˆ¤æ–­æ ‡å‡†ï¼šä¸ºä»€ä¹ˆ USS æ˜¯â€œé‡‘æ ‡å‡†â€ï¼Ÿ</h2>
<p>åœ¨åˆ†ææ³„æ¼æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸éµå¾ªè¿™ä¸ªä¼˜å…ˆçº§ï¼š<strong>USS &gt; PSS &gt; RSS &gt; VSS</strong>ã€‚</p>
<ul>
<li><strong>VSS å’Œ RSS çš„å±€é™æ€§</strong>ï¼šç”±äº RSS åŒ…å«äº†å…±äº«åº“å†…å­˜ï¼Œå½“ç³»ç»Ÿå…¶ä»–è¿›ç¨‹åŠ è½½æˆ–å¸è½½å…±äº«åº“æ—¶ï¼Œä½ çš„è¿›ç¨‹ RSS å¯èƒ½ä¼šæ³¢åŠ¨ï¼Œè¿™ä¼šäº§ç”Ÿâ€œä¼ªæ³„æ¼â€çš„å¹²æ‰°ã€‚</li>
<li><strong>PSS çš„å‚è€ƒæ„ä¹‰</strong>ï¼šPSS èƒ½å¤Ÿåæ˜ ä½ çš„è¿›ç¨‹å¯¹ç³»ç»Ÿæ€»å†…å­˜çš„çœŸå®è´¡çŒ®ã€‚å¦‚æœ PSS æŒç»­ä¸Šæ¶¨ï¼Œè¯´æ˜ä½ çš„åº”ç”¨æ­£åœ¨æ‹–æ…¢ç³»ç»Ÿã€‚</li>
<li><strong>USS çš„å†³å®šæ€§ä½œç”¨</strong>ï¼š<strong>USS åªåŒ…å«è¿›ç¨‹å®Œå…¨ç‹¬å çš„å†…å­˜ã€‚</strong> å†…å­˜æ³„æ¼æœ¬è´¨ä¸Šæ˜¯è¿›ç¨‹å†…éƒ¨çš„å¯¹è±¡æ— æ³•è¢«å›æ”¶ï¼Œå› æ­¤<strong>å†…å­˜æ³„æ¼ä¸€å®šä¼šç›´æ¥åæ˜ åœ¨ USS çš„ä¸Šæ¶¨ä¸Š</strong>ã€‚</li>
</ul>
<h2 data-id="heading-6">0x02 åˆ†æå†…å­˜æ³„æ¼åˆ†æçš„æµç¨‹</h2>
<h3 data-id="heading-7">ç¬¬ä¸€æ­¥ï¼šå»ºç«‹åŸºå‡†çº¿ (Baseline)</h3>
<p>åœ¨åº”ç”¨å¯åŠ¨å¹¶è¿›å…¥ä¸»ç•Œé¢ç¨³å®šåï¼Œè®°å½•å½“å‰çš„å†…å­˜çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">adb shell dumpsys meminfo &lt;your_package_name&gt;
</code></pre>
<p>é‡ç‚¹è®°å½•ï¼š<code>TOTAL Pss</code> å’Œ <code>Private Dirty</code>ï¼ˆåè€…éå¸¸æ¥è¿‘ USSï¼‰ã€‚</p>
<h3 data-id="heading-8">ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œé‡å¤æ€§æ“ä½œ (Stress Test)</h3>
<p>å†…å­˜æ³„æ¼é€šå¸¸å‘ç”Ÿåœ¨ Activity é”€æ¯æˆ–é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ï¼ˆå¦‚ Singletonã€Threadï¼‰ä¸­ã€‚æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>è¿›å…¥ä¸€ä¸ªæ€€ç–‘æœ‰æ³„æ¼çš„é¡µé¢ï¼Œå†é€€å‡ºã€‚</li>
<li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ <strong>10 æ¬¡ä»¥ä¸Š</strong>ã€‚</li>
<li>æ‰‹åŠ¨è§¦å‘å‡ æ¬¡ GCï¼ˆåœ¨ Android Studio Profiler ä¸­ç‚¹å‡»å°åƒåœ¾æ¡¶å›¾æ ‡ï¼Œæˆ–é€šè¿‡ <code>adb shell cmd activity gc</code>ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-9">ç¬¬ä¸‰æ­¥ï¼šå¯¹æ¯”è§‚æµ‹</h3>
<p>å†æ¬¡è¿è¡Œ <code>adb shell dumpsys meminfo &lt;your_package_name&gt;</code>ï¼Œè§‚å¯Ÿæ•°æ®å˜åŒ–ï¼š</p>
<ul>
<li><strong>å¦‚æœ USS (Private Dirty) é˜¶æ¢¯å¼ä¸Šå‡</strong>ï¼šè¯´æ˜å­˜åœ¨<strong>ç§æœ‰å†…å­˜æ³„æ¼</strong>ï¼ˆé€šå¸¸æ˜¯ Java å¯¹è±¡ã€Bitmap æˆ– Native å †å†…å­˜ï¼‰ã€‚</li>
<li><strong>å¦‚æœ PSS ä¸Šå‡ä½† USS ç¨³å®š</strong>ï¼šè¿™ç§æƒ…å†µæå°‘è§ï¼Œå¯èƒ½æ„å‘³ç€ä½ è°ƒç”¨çš„ç³»ç»Ÿå…±äº«èµ„æºï¼ˆå¦‚æŸäº›ç³»ç»ŸæœåŠ¡çš„ç¼“å­˜ï¼‰åœ¨å¢åŠ ï¼Œè€Œä¸æ˜¯ä½ è¿›ç¨‹å†…éƒ¨çš„æ³„æ¼ã€‚</li>
<li><strong>å¦‚æœ PSS/USS å‡ä¸å¢åŠ ï¼Œä½† VSS ç–¯ç‹‚å¢é•¿</strong>ï¼šè¯´æ˜ä½ åœ¨ä¸æ–­åœ°ç”³è¯·è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚åˆ›å»ºäº†å¤§é‡çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å ç”¨ 1MB è™šæ‹Ÿæ ˆç©ºé—´ï¼Œä½†å®é™…è¿˜æ²¡å¼€å§‹ä½¿ç”¨ç‰©ç†å†…å­˜ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-shell" lang="shell">Applications Memory Usage (in Kilobytes):
Uptime: 102275 Realtime: 102275

** MEMINFO in pid 3069 [com.android.launcher3] **
                   Pss  Private  Private     Swap      Rss     Heap     Heap     Heap
                 Total    Dirty    Clean    Dirty    Total     Size    Alloc     Free
                ------   ------   ------   ------   ------   ------   ------   ------
  Native Heap    11128    11060        0        0    13796    19812    13511     2600
  Dalvik Heap     2316     2188        0        0     6620    27729     3153    24576
 Dalvik Other     2587     2264        0        0     3528                           
        Stack      736      736        0        0      740                           
       Ashmem        2        0        0        0        8                           
      Gfx dev     1244     1244        0        0     1244                           
    Other dev       36        0       36        0      284                           
     .so mmap     6076      212      128        0    54512                           
    .jar mmap     1922        0        0        0    26648                           
    .apk mmap    14824        0    13900        0    38756                           
    .ttf mmap       54        0        0        0      228                           
    .dex mmap      213        4        0        0      504                           
    .oat mmap       55        0        0        0     2044                           
    .art mmap     7794     7404        4        0    20040                           
   Other mmap     1179        4       32        0     4984                           
   EGL mtrack    40288    40288        0        0    40288                           
    GL mtrack     6104     6104        0        0     6104                           
      Unknown      466      448        0        0     1100                           
        TOTAL    97024    71956    14100        0    97024    47541    16664    27176
 
 App Summary
                       Pss(KB)                        Rss(KB)
                        ------                         ------
           Java Heap:     9596                          26660
         Native Heap:    11060                          13796
                Code:    14256                         123424
               Stack:      736                            740
            Graphics:    47636                          47636
       Private Other:     2772
              System:    10968
             Unknown:                                    9172
 
           TOTAL PSS:    97024            TOTAL RSS:   221428      TOTAL SWAP (KB):        0
 
...

</code></pre>
<h2 data-id="heading-10">0x03 é’ˆå¯¹ä¸åŒç±»å‹çš„æ³„æ¼åˆ†æ</h2>
<h3 data-id="heading-11">A. Java å±‚æ³„æ¼ (Activity/Fragment)</h3>
<ul>
<li>
<p><strong>ç°è±¡</strong>ï¼š<code>TOTAL Pss</code> å’Œ <code>Java Heap</code> æŒç»­å¢é•¿ã€‚</p>
</li>
<li>
<p><strong>åˆ†æ</strong>ï¼šæŸ¥çœ‹ <code>dumpsys meminfo</code> æœ€åçš„ <code>Objects</code> éƒ¨åˆ†ã€‚</p>
<ul>
<li><code>Views</code> å’Œ <code>Activities</code> çš„æ•°é‡ã€‚å¦‚æœä½ é€€å‡ºäº†é¡µé¢ï¼Œ<code>Activities</code> æ•°é‡æ²¡æœ‰å‡å°‘ï¼Œé‚£å°±æ˜¯å…¸å‹çš„ Activity æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-12">B. Native å±‚æ³„æ¼ (C++/JNI)</h3>
<ul>
<li><strong>ç°è±¡</strong>ï¼š<code>Native Heap</code> æŒ‡æ ‡æŒç»­å¢é•¿ï¼Œä¸” <code>USS</code> åŒæ­¥ä¸Šæ¶¨ã€‚</li>
<li><strong>åˆ†æ</strong>ï¼šå¦‚æœä½ åœ¨ JNI ä¸­ä½¿ç”¨äº† <code>malloc</code> æˆ– <code>new</code> ä½†æ²¡æœ‰ <code>free</code>ï¼Œè¿™éƒ¨åˆ†å†…å­˜ä¼šä½“ç°åœ¨ <code>Native Heap</code> ä¸­ã€‚</li>
</ul>
<h3 data-id="heading-13">C. å…±äº«å†…å­˜/æ–‡ä»¶æè¿°ç¬¦æ³„æ¼ (SharedMemory/FD)</h3>
<p>å¦‚æœ SharedMemory æ²¡æœ‰è¢«æ­£ç¡®å…³é—­ï¼š</p>
<ul>
<li>
<p><strong>ç°è±¡</strong>ï¼š<code>USS</code> å¯èƒ½ä¸ä¼šæ˜¾è‘—å¢é•¿ï¼ˆå¦‚æœä½ å·²ç» <code>munmap</code> äº†ï¼‰ï¼Œä½†<strong>æ–‡ä»¶æè¿°ç¬¦ (FD)</strong> ä¼šè€—å°½ã€‚</p>
</li>
<li>
<p><strong>æ£€æŸ¥æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">adb shell <span class="hljs-built_in">ls</span> -l /proc/&lt;pid&gt;/fd | <span class="hljs-built_in">wc</span> -l
</code></pre>
<p>ä¾‹å¦‚æ£€æŸ¥<code>3069</code>å·è¿›ç¨‹(<code>com.android.launcher3</code>)</p>
<pre><code class="hljs language-shell" lang="shell">adb root
adb shell ls -l /proc/3069/fd | wc -l
<span class="hljs-meta prompt_">
# </span><span class="bash">è¾“å‡º</span>
<span class="hljs-meta prompt_"># </span><span class="bash">82</span>
</code></pre>
<p>é‡å¤æ“ä½œåï¼Œå¦‚æœ FD æ•°é‡ä¸æ–­å¢åŠ ï¼Œè¯´æ˜ä½ çš„ <code>SharedMemory</code> æˆ– <code>ParcelFileDescriptor</code> æ²¡æœ‰æ‰§è¡Œ <code>close()</code>ã€‚</p>
</li>
</ul>
<h2 data-id="heading-14">0x04 è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·æ¨è</h2>
<p>è™½ç„¶æ‰‹åŠ¨åˆ†æ <code>dumpsys</code> å¾ˆæœ‰å¸®åŠ©ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®é…åˆä»¥ä¸‹å·¥å…·ï¼š</p>





















<table><thead><tr><th><strong>å·¥å…·</strong></th><th><strong>ä¼˜åŠ¿</strong></th></tr></thead><tbody><tr><td><strong>LeakCanary</strong></td><td>è‡ªåŠ¨åŒ–ç¨‹åº¦æœ€é«˜ï¼Œç›´æ¥åœ¨æ‰‹æœºç«¯å¼¹çª—å‘ŠçŸ¥ Java æ³„æ¼å¼•ç”¨é“¾ã€‚</td></tr><tr><td><strong>Android Studio Profiler</strong></td><td>å¯è§†åŒ–å®æ—¶æŸ¥çœ‹ PSS åˆ†å¸ƒï¼Œæ”¯æŒ Capture Heap Dump åˆ†æå †å¿«ç…§ã€‚</td></tr><tr><td><strong>Perfetto / Systrace</strong></td><td>é€‚åˆåˆ†æ Native å±‚å’Œç³»ç»Ÿçº§çš„å†…å­˜åˆ†é…è¡Œä¸ºã€‚</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†]]></title>    <link>https://juejin.cn/post/7585446706327126025</link>    <guid>https://juejin.cn/post/7585446706327126025</guid>    <pubDate>2025-12-20T06:25:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585446706327126025" data-draft-id="7585463258690650121" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Java"/> <meta itemprop="datePublished" content="2025-12-20T06:25:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="9å·è¾¾äºº"/> <meta itemprop="url" content="https://juejin.cn/user/2450136052270077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2450136052270077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    9å·è¾¾äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T06:25:35.000Z" title="Sat Dec 20 2025 06:25:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äº‹æ•…ç°åœº</h2>
<p>ä¸Šå‘¨çº¿ä¸Šç‚¸äº†ã€‚</p>
<p>æ”¯ä»˜ä¸šåŠ¡å‡ºäº†é—®é¢˜ï¼Œç”¨æˆ·æ”¯ä»˜æˆåŠŸï¼Œä½†è®¢å•è¡¨æ²¡æ•°æ®ã€‚æ›´è¯¡å¼‚çš„æ˜¯ï¼Œä¿®æ”¹è®¢å•æ—¶æœ‰æ—¶ä¹Ÿä¼šæç¤ºè·å–é”è¶…æ—¶ã€‚</p>
<p>DBAçœ‹äº†ä¸€çœ¼æ•°æ®åº“è¿æ¥ï¼Œå‘ç°å‡ ä¸ªäº‹åŠ¡ä¸€ç›´æ²¡æäº¤ï¼Œé”ç€è®¢å•è¡¨çš„å‡ è¡Œæ•°æ®ã€‚</p>
<p>æ’æŸ¥åŠå¤©ï¼Œæœ€åå‘ç°æ˜¯æŸä¸ªä¸šåŠ¡æ¥å£å¿˜äº†æäº¤äº‹åŠ¡ã€‚</p>
<p>æŒ‰ç†è¯´,äº‹åŠ¡æ²¡æäº¤åº”è¯¥å¾ˆå®¹æ˜“å‘ç°ã€‚ä½†è¿™ä¸ªbugå°±æ¯”è¾ƒéšè”½ã€‚</p>
<p><strong>4ä¸ªåå¸¸è¯†çš„ç°è±¡ï¼š</strong></p>
<ol>
<li><strong>ä¸šåŠ¡ä»£ç æ­£å¸¸æ‰§è¡Œå®Œæ¯•</strong> æ²¡æœ‰ä»»ä½•æŠ¥é”™ï¼Œæ—¥å¿—ä¹Ÿæ­£å¸¸æ‰“å°ã€‚</li>
<li><strong>æ—¥å¿—æ˜¾ç¤ºäº‹åŠ¡å·²æäº¤</strong> commitæ–¹æ³•è¢«è°ƒç”¨äº†ï¼Œä½†æ•°æ®åº“é‡Œæ²¡æ•°æ®ã€‚</li>
<li><strong>å¶å°”ä¼šæˆåŠŸ</strong> å¤§éƒ¨åˆ†æ—¶å€™å¤±è´¥ï¼Œä½†å¶å°”èƒ½æ­£å¸¸æ’å…¥è®¢å•ã€‚</li>
</ol>
<p>è¿™ç§æƒ…å†µè®©äººæ‘¸ä¸ç€å¤´è„‘ã€‚ä»£ç æ²¡æŠ¥é”™ï¼Œæ—¥å¿—ä¹Ÿæ­£å¸¸ï¼Œä¸ºå•¥æ•°æ®å°±æ˜¯ä¸å…¥åº“?</p>
<h2 data-id="heading-1">åº”æ€¥å¤„ç†</h2>
<p>çº¿ä¸Šå‡ºé—®é¢˜ï¼Œé‚£è‚¯å®šå…ˆæ¢å¤ä¸šåŠ¡å†è¯´ã€‚</p>
<p>æœ€å¿«çš„åŠæ³•å°±æ˜¯é‡å¯åº”ç”¨ï¼Œå¼ºåˆ¶é‡Šæ”¾è¿™äº›è¿æ¥ã€‚</p>
<p>é‡å¯å®Œï¼Œæ”¯ä»˜åŠŸèƒ½æ¢å¤æ­£å¸¸ã€‚ä½†é—®é¢˜è¿˜æ˜¯è¦æ‰¾åˆ°</p>
<p>é‡å¯åªèƒ½æš‚æ—¶ç¼“è§£ï¼Œå¾—æ‰¾åˆ°åˆ°åº•å“ªä¸ªä¸šåŠ¡å‡ºäº†é—®é¢˜ã€‚</p>
<p>å¯¹æ¯”äº†æœ€è¿‘çš„ä¸Šçº¿è®°å½•ï¼Œå‘ç°æœ‰ä¸ªæ–°ä¸šåŠ¡åˆšä¸Šçº¿ã€‚æ£€æŸ¥ä»£ç ï¼Œæœç„¶å‘ç°äº†é—®é¢˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â voidÂ handleSpecialCase()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â sqlSession.connection.setAutoCommit(<span class="hljs-literal">false</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡ŒSQL</span>
Â Â Â Â Â Â Â Â mapper.insert(<span class="hljs-keyword">data</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¿˜è®°commitäº†ï¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŸäº›æƒ…å†µä¸‹ä¼šreturnï¼Œä½†æ²¡commit</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â sqlSession.commit();
Â Â Â Â }
}
</code></pre>
<p>ç‰¹æ®Šåˆ†æ”¯ç›´æ¥returnäº†ï¼Œcommitæ²¡æ‰§è¡Œã€‚</p>
<h3 data-id="heading-2">å¿«é€Ÿä¿®å¤</h3>
<p>ç«‹å³è¡¥ä¸Šcommitï¼Œé‡æ–°ä¸Šçº¿ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â voidÂ handleSpecialCase()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.connection.setAutoCommit(<span class="hljs-literal">false</span>);
Â Â Â Â Â Â Â Â Â Â Â Â mapper.insert(<span class="hljs-keyword">data</span>);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.commit();Â <span class="hljs-comment">//Â è¡¥ä¸Šï¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.commit();
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.rollback();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>ä¸Šçº¿åéªŒè¯ï¼Œé—®é¢˜è§£å†³ã€‚</p>
<h2 data-id="heading-3">äº‹åå¤ç›˜</h2>
<p>é—®é¢˜è™½ç„¶è§£å†³äº†ï¼Œä½†è¿˜æ˜¯å¾ˆå¥‡æ€ªï¼šä¸ºå•¥ä¸€ä¸ªä¸šåŠ¡çš„äº‹åŠ¡æ²¡æäº¤ï¼Œä¼šå½±å“åˆ°å…¶ä»–å®Œå…¨ä¸ç›¸å…³çš„æ”¯ä»˜ä¸šåŠ¡ï¼Ÿ</p>
<p>å‘¨æœ«èŠ±äº†åŠå¤©debugæºç ï¼Œç»ˆäºææ¸…æ¥šäº†ã€‚</p>
<h3 data-id="heading-4">æ–­ç‚¹æ‰“åœ¨getTransaction</h3>
<p>é¦–å…ˆåœ¨Springçš„<code>getTransaction</code>æ–¹æ³•æ‰“æ–­ç‚¹ï¼Œå‘ç°å‡ºé—®é¢˜çš„è¯·æ±‚éƒ½ä¼šèµ°åˆ°è¿™é‡Œï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">final</span>Â <span class="hljs-selector-tag">TransactionStatus</span>Â <span class="hljs-selector-tag">getTransaction</span>(<span class="hljs-variable">@Nullable</span>Â TransactionDefinitionÂ definition)
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">throws</span>Â <span class="hljs-selector-tag">TransactionException</span>Â {

Â Â Â Â <span class="hljs-comment">//Â ä½¿ç”¨é»˜è®¤çš„äº‹åŠ¡å®šä¹‰</span>
Â Â Â Â <span class="hljs-selector-tag">TransactionDefinition</span>Â <span class="hljs-selector-tag">def</span>Â =Â (definitionÂ !=Â nullÂ ?Â <span class="hljs-attribute">definitionÂ </span>:Â TransactionDefinition.<span class="hljs-built_in">withDefaults</span>());

Â Â Â Â <span class="hljs-comment">//Â å…³é”®ï¼šè·å–å½“å‰äº‹åŠ¡å¯¹è±¡</span>
Â Â Â Â <span class="hljs-selector-tag">Object</span>Â <span class="hljs-selector-tag">transaction</span>Â =Â <span class="hljs-selector-tag">doGetTransaction</span>();
Â Â Â Â <span class="hljs-selector-tag">boolean</span>Â <span class="hljs-selector-tag">debugEnabled</span>Â =Â <span class="hljs-selector-tag">logger</span><span class="hljs-selector-class">.isDebugEnabled</span>();

Â Â Â Â <span class="hljs-comment">//Â åˆ¤æ–­æ˜¯å¦æ˜¯å·²å­˜åœ¨çš„äº‹åŠ¡</span>
Â Â Â Â <span class="hljs-selector-tag">if</span>Â (<span class="hljs-built_in">isExistingTransaction</span>(transaction))Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘ç°å·²å­˜åœ¨çš„äº‹åŠ¡ï¼Œç›´æ¥è¿”å›</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">handleExistingTransaction</span>(def,Â transaction,Â debugEnabled);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºæ–°äº‹åŠ¡çš„é€»è¾‘...</span>
}
</code></pre>
<p>é—®é¢˜å°±å‡ºåœ¨<code>doGetTransaction</code>è¿™ä¸ªæ–¹æ³•ã€‚</p>
<h3 data-id="heading-5">doGetTransactionä¼šå¤ç”¨è¿æ¥</h3>
<p>ç‚¹å¼€<code>doGetTransaction</code>ï¼Œä¼šå‘ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span>Â ObjectÂ <span class="hljs-title function_">doGetTransaction</span><span class="hljs-params">()</span>Â {
Â Â Â Â <span class="hljs-type">DataSourceTransactionObject</span>Â <span class="hljs-variable">txObject</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DataSourceTransactionObject</span>();
Â Â Â Â txObject.setSavepointAllowed(<span class="hljs-built_in">this</span>.isNestedTransactionAllowed());

Â Â Â Â <span class="hljs-comment">//Â å…³é”®ï¼šä»TransactionSynchronizationManagerè·å–è¿æ¥</span>
Â Â Â Â <span class="hljs-type">ConnectionHolder</span>Â <span class="hljs-variable">conHolder</span>Â <span class="hljs-operator">=</span>Â (ConnectionHolder)Â TransactionSynchronizationManager.getResource(<span class="hljs-built_in">this</span>.obtainDataSource());

Â Â Â Â txObject.setConnectionHolder(conHolder,Â <span class="hljs-literal">false</span>);
Â Â Â Â <span class="hljs-keyword">return</span>Â txObject;
}
</code></pre>
<p><code>TransactionSynchronizationManager.getResource</code>ä¼šä»è¿æ¥æ± æ‹¿è¿æ¥ã€‚å¦‚æœæ‹¿åˆ°ä¸€ä¸ªè¢«æ±¡æŸ“çš„è¿æ¥ï¼ˆä¸Šä¸€ä¸ªäº‹åŠ¡æ²¡æäº¤ï¼‰ï¼Œ<code>ConnectionHolder</code>é‡Œå°±å¸¦ç€ä¸Šä¸€ä¸ªäº‹åŠ¡çš„çŠ¶æ€ã€‚</p>
<h3 data-id="heading-6">isExistingTransactionçš„åˆ¤æ–­</h3>
<p>ç„¶å<code>isExistingTransaction</code>ä¼šæ£€æŸ¥è¿™ä¸ªè¿æ¥ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">protectedÂ booleanÂ <span class="hljs-built_in">isExistingTransaction</span>(ObjectÂ transaction)Â {
Â Â Â Â DataSourceTransactionObjectÂ txObjectÂ =Â (DataSourceTransactionObject)transaction;
Â Â Â Â returnÂ txObject<span class="hljs-selector-class">.hasConnectionHolder</span>()Â &amp;&amp;Â txObject<span class="hljs-selector-class">.getConnectionHolder</span>()<span class="hljs-selector-class">.isTransactionActive</span>();
}
</code></pre>
<p>å¦‚æœè¿æ¥ä¸Šæœ‰äº‹åŠ¡æ ‡è®°(<code>isTransactionActive()</code>)ï¼Œå°±è®¤ä¸ºæ˜¯å·²å­˜åœ¨çš„äº‹åŠ¡ï¼Œä¸ä¼šåˆ›å»ºæ–°äº‹åŠ¡ã€‚</p>
<p>é—®é¢˜æ¥äº†ï¼šå¦‚æœä¸Šä¸€ä¸ªä¸šåŠ¡ç”¨å®Œè¿æ¥åï¼Œäº‹åŠ¡æ²¡æäº¤ä¹Ÿæ²¡å›æ»šï¼Œ<code>ConnectionHolder</code>çš„äº‹åŠ¡æ ‡è®°è¿˜åœ¨ã€‚ä¸‹ä¸€ä¸ªä¸šåŠ¡é€šè¿‡<code>doGetTransaction</code>ä»<code>TransactionSynchronizationManager</code>æ‹¿åˆ°è¿™ä¸ª<code>ConnectionHolder</code>ï¼Œå°±è¢«å½“æˆå·²å­˜åœ¨çš„äº‹åŠ¡äº†ã€‚</p>
<h3 data-id="heading-7">è¢«æ±¡æŸ“çš„è¿æ¥æ˜¯æ€ä¹ˆæ¥çš„</h3>
<p>å›é¡¾å‰é¢åº”æ€¥å¤„ç†æ—¶æ‰¾åˆ°çš„é‚£æ®µdemoä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">handleSpecialCase</span><span class="hljs-params">()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">TransactionStatus</span>Â <span class="hljs-variable">status</span>Â <span class="hljs-operator">=</span>Â transactionManager.getTransaction(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DefaultTransactionDefinition</span>());

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡ŒSQL</span>
Â Â Â Â Â Â Â Â Â Â Â Â mapper.insert(data);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç‰¹æ®Šåˆ†æ”¯ï¼šç›´æ¥returnï¼Œæ²¡commitï¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.commit(status);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.rollback(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>å½“èµ°åˆ°ç‰¹æ®Šåˆ†æ”¯returnæ—¶ï¼š</p>
<ul>
<li><code>ConnectionHolder</code>å·²ç»è¢«æ ‡è®°ä¸ºæœ‰äº‹åŠ¡ï¼ˆ<code>isTransactionActive() = true</code>ï¼‰</li>
<li>ä½†äº‹åŠ¡æ—¢æ²¡commitï¼Œä¹Ÿæ²¡rollback</li>
<li>æ–¹æ³•ç»“æŸåï¼Œè¿æ¥å½’è¿˜åˆ°<code>TransactionSynchronizationManager</code></li>
<li><code>ConnectionHolder</code>çš„äº‹åŠ¡æ ‡è®°è¿˜åœ¨</li>
</ul>
<p>è¿™ä¸ªè¿æ¥å°±è¢«æ±¡æŸ“äº†ã€‚</p>
<h3 data-id="heading-8">å¤ç”¨å¯¼è‡´çš„é—®é¢˜</h3>
<p>å…¶ä»–ä¸šåŠ¡åˆšå¥½å¤ç”¨åˆ°äº†è¿™ä¸ªè¢«æ±¡æŸ“çš„è¿æ¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">PaymentService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderÂ order)</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰‹åŠ¨å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">TransactionStatus</span>Â <span class="hljs-variable">status</span>Â <span class="hljs-operator">=</span>Â transactionManager.getTransaction(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DefaultTransactionDefinition</span>());

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ’å…¥è®¢å•</span>
Â Â Â Â Â Â Â Â Â Â Â Â orderMapper.insert(order);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æäº¤äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.commit(status);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.rollback(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Œå¯¹å§ï¼Ÿä½†å½“è¿™ä¸ªæ–¹æ³•è·å–åˆ°è¢«æ±¡æŸ“çš„è¿æ¥æ—¶ï¼š</p>
<ol>
<li><code>getTransaction</code>åˆ¤æ–­<code>isExistingTransaction</code>ä¸ºtrue</li>
<li>èµ°è¿›<code>handleExistingTransaction</code>æ–¹æ³•</li>
<li>æ ¹æ®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œå¯èƒ½ä¼šåŠ å…¥ç°æœ‰äº‹åŠ¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°äº‹åŠ¡</li>
<li>æœ€åcommitæ—¶ï¼Œå› ä¸ºä¸æ˜¯äº‹åŠ¡å‘èµ·è€…ï¼Œä¸ä¼šçœŸæ­£æäº¤</li>
</ol>
<h3 data-id="heading-9">processCommitçš„åˆ¤æ–­</h3>
<p>ç»§ç»­debugåˆ°commitæ–¹æ³•ï¼Œå‘ç°ä¼šæ‰§è¡ŒprocessCommitå»å®Œæˆæäº¤ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">privateÂ voidÂ <span class="hljs-built_in">processCommit</span>(DefaultTransactionStatusÂ status)Â throwsÂ TransactionExceptionÂ {
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â booleanÂ beforeCompletionInvokedÂ =Â false;

Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">prepareForCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">triggerBeforeCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">triggerBeforeCompletion</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â beforeCompletionInvokedÂ =Â true;

Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (status.hasSavepoint())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â status<span class="hljs-selector-class">.releaseHeldSavepoint</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…³é”®åˆ¤æ–­ï¼šåªæœ‰æ–°äº‹åŠ¡æ‰çœŸæ­£æäº¤</span>
Â Â Â Â Â Â Â Â Â Â Â Â elseÂ ifÂ (status.isNewTransaction())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (status.isDebug())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â logger<span class="hljs-selector-class">.debug</span>("InitiatingÂ transactionÂ commit");
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â çœŸæ­£æ‰§è¡Œæ•°æ®åº“commit</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">doCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¦‚æœä¸æ˜¯æ–°äº‹åŠ¡ï¼Œä»€ä¹ˆéƒ½ä¸åšï¼</span>

Â Â Â Â Â Â Â Â }Â catchÂ (UnexpectedRollbackExceptionÂ ex)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ...</span>
Â Â Â Â Â Â Â Â }

Â Â Â Â }Â finallyÂ {
Â Â Â Â Â Â Â Â <span class="hljs-built_in">cleanupAfterCompletion</span>(status);
Â Â Â Â }
}
</code></pre>
<p>å› ä¸º<code>status.isNewTransaction()</code>è¿”å›falseï¼ˆè¿™æ˜¯ä¸ªåŠ å…¥çš„äº‹åŠ¡ï¼Œä¸æ˜¯æ–°äº‹åŠ¡ï¼‰ï¼Œæ‰€ä»¥<code>doCommit(status)</code>æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>çœŸæ­£çš„<code>connection.commit()</code>æ ¹æœ¬æ²¡æ‰§è¡Œã€‚</p>
<h3 data-id="heading-10">å®Œæ•´çš„é—®é¢˜é“¾è·¯</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/949f8bc5fad646ce99fe08ea931a121b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOeWPt-i-vuS6ug==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766816735&amp;x-signature=eaui1jMxdtT2JMmKe2B7tW5yA9M%3D" alt="" loading="lazy"/></p>
<ol>
<li><code>SomeService.handleSpecialCase()</code>ç‰¹æ®Šåˆ†æ”¯æ²¡æäº¤äº‹åŠ¡</li>
<li>æ–¹æ³•ç»“æŸï¼Œ<code>ConnectionHolder</code>å½’è¿˜åˆ°<code>TransactionSynchronizationManager</code>ï¼Œä½†äº‹åŠ¡æ ‡è®°<code>isTransactionActive()</code>è¿˜æ˜¯true</li>
<li><code>PaymentService.createOrder()</code>è°ƒç”¨<code>doGetTransaction()</code></li>
<li><code>doGetTransaction</code>ä»<code>TransactionSynchronizationManager</code>æ‹¿åˆ°è¢«æ±¡æŸ“çš„<code>ConnectionHolder</code></li>
<li><code>isExistingTransaction</code>åˆ¤æ–­ä¸ºtrueï¼Œè®¤ä¸ºå·²æœ‰äº‹åŠ¡</li>
<li>èµ°<code>handleExistingTransaction</code>æµç¨‹ï¼ŒåŠ å…¥ç°æœ‰äº‹åŠ¡ï¼ˆ<code>isNewTransaction = false</code>ï¼‰</li>
<li>ä¸šåŠ¡ä»£ç æ‰§è¡Œå®Œï¼Œè°ƒç”¨<code>commit</code></li>
<li><code>processCommit</code>ä¸­åˆ¤æ–­<code>isNewTransaction()</code>ä¸ºfalseï¼Œè·³è¿‡<code>doCommit</code></li>
<li>æ•°æ®æ²¡å…¥åº“ï¼Œ<code>ConnectionHolder</code>ç»§ç»­å¾…åœ¨<code>TransactionSynchronizationManager</code>ï¼Œç»§ç»­æ±¡æŸ“ä¸‹ä¸€ä¸ªä¸šåŠ¡</li>
</ol>
<h2 data-id="heading-11">ä¸ºä»€ä¹ˆå¶å°”ä¼šæˆåŠŸï¼Ÿ</h2>
<p>å› ä¸º<code>TransactionSynchronizationManager</code>æ˜¯ThreadLocalå®ç°çš„ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„èµ„æºã€‚</p>
<p>å¦‚æœæ”¯ä»˜è¯·æ±‚åˆ†é…åˆ°ä¸€ä¸ªå¹²å‡€çš„çº¿ç¨‹ï¼ˆæ²¡æœ‰è¢«æ±¡æŸ“çš„<code>ConnectionHolder</code>ï¼‰ï¼Œå°±èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†åªè¦åˆ†é…åˆ°è¢«æ±¡æŸ“çš„çº¿ç¨‹ï¼Œå°±ä¼šå‡ºé—®é¢˜ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªbugè¿™ä¹ˆéš¾å‘ç°ï¼š</p>
<ul>
<li>ä¸æ˜¯100%å¤ç°ï¼ˆå–å†³äºçº¿ç¨‹æ± è°ƒåº¦ï¼‰</li>
<li>æ²¡æœ‰æŠ¥é”™ä¿¡æ¯</li>
<li>æ—¥å¿—çœ‹èµ·æ¥æ­£å¸¸</li>
</ul>
<h2 data-id="heading-12">é¢„é˜²æªæ–½</h2>
<p>ç»è¿‡è¿™æ¬¡äº‹æ•…ï¼Œæˆ‘ä»¬åŠ äº†å‡ ä¸ªé¢„é˜²æªæ–½ã€‚</p>
<h3 data-id="heading-13">1. è¿æ¥æ± å¥åº·æ£€æŸ¥</h3>
<p>é…ç½®è¿æ¥æ± çš„è¿æ¥æ ¡éªŒï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
Â Â <span class="hljs-attr">datasource:</span>
Â Â Â Â <span class="hljs-attr">hikari:</span>
Â Â Â Â Â Â <span class="hljs-string">connection-test-query:</span>Â <span class="hljs-string">SELECT</span>Â <span class="hljs-number">1</span>
Â Â Â Â Â Â <span class="hljs-string">validation-timeout:</span>Â <span class="hljs-number">3000</span>
Â Â Â Â Â Â <span class="hljs-comment">#Â ä»æ± å­å–è¿æ¥å‰å…ˆæµ‹è¯•</span>
Â Â Â Â Â Â <span class="hljs-string">connection-init-sql:</span>Â <span class="hljs-string">SET</span>Â <span class="hljs-string">autocommit=1</span>
</code></pre>
<p><code>connection-init-sql</code>ä¼šåœ¨æ¯æ¬¡ä»æ± å­å–è¿æ¥æ—¶é‡ç½®çŠ¶æ€ï¼Œé¿å…è¢«æ±¡æŸ“çš„è¿æ¥å½±å“ä¸šåŠ¡ã€‚</p>
<h3 data-id="heading-14">2. ç›‘æ§å‘Šè­¦</h3>
<p>å¢åŠ æ•°æ®åº“é•¿äº‹åŠ¡ç›‘æ§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â æŸ¥æ‰¾æ‰§è¡Œè¶…è¿‡30ç§’çš„äº‹åŠ¡</span>
<span class="hljs-keyword">SELECT</span>Â <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span>Â information_schema.innodb_trx
<span class="hljs-keyword">WHERE</span>Â TIME_TO_SEC(TIMEDIFF(NOW(),Â trx_started))Â <span class="hljs-operator">&gt;</span>Â <span class="hljs-number">30</span>;
</code></pre>
<p>é…ç½®å‘Šè­¦è§„åˆ™ï¼Œè¶…è¿‡30ç§’çš„äº‹åŠ¡ç«‹å³æŠ¥è­¦ã€‚</p>
<h2 data-id="heading-15">è¸©å‘æ€»ç»“</h2>
<p>è¿™æ¬¡äº‹æ•…è®©æˆ‘æ˜ç™½äº†å‡ ç‚¹ã€‚</p>
<h3 data-id="heading-16">1. è¿æ¥æ± ä¸åªæ˜¯æ€§èƒ½ä¼˜åŒ–</h3>
<p>ä¹‹å‰æˆ‘ä¸€ç›´è§‰å¾—è¿æ¥æ± å°±æ˜¯æå‡æ€§èƒ½çš„ã€‚è¿™æ¬¡æ‰æ‡‚ï¼Œè¿æ¥æ± è¿˜ä¼šå¸¦æ¥çŠ¶æ€å¤ç”¨çš„å‘ã€‚</p>
<p>ä¸€ä¸ªè¿æ¥çš„é—®é¢˜ï¼Œä¼šå½±å“åé¢æ‰€æœ‰å¤ç”¨è¿™ä¸ªè¿æ¥çš„ä¸šåŠ¡ã€‚</p>
<h3 data-id="heading-17">2. äº‹åŠ¡ç®¡ç†è¦å†™æ¸…æ¥š</h3>
<p>æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼Œä¸€å®šè¦å†™æ¸…æ¥šcommitå’Œrollbackï¼š</p>
<ul>
<li>commitå†™åœ¨tryå—æœ«å°¾</li>
<li>rollbackå†™åœ¨catchå—</li>
<li>finallyå—å…³é—­èµ„æº</li>
</ul>
<p>åˆ«å·æ‡’çœè¿™å‡ è¡Œä»£ç ã€‚ä¸€ä¸ªé—æ¼çš„commitï¼Œå°±å¯èƒ½å¯¼è‡´çº¿ä¸Šäº‹æ•…ã€‚</p>
<h3 data-id="heading-18">3. ç›‘æ§è¦è¦†ç›–åˆ°æ•°æ®åº“å±‚</h3>
<p>åº”ç”¨å±‚æ—¥å¿—æ­£å¸¸ï¼Œä¸ä»£è¡¨æ•°æ®åº“å±‚æ²¡é—®é¢˜ã€‚</p>
<p>å¿…é¡»è¦æœ‰æ•°æ®åº“å±‚é¢çš„ç›‘æ§ï¼š</p>
<ul>
<li>æ…¢æŸ¥è¯¢</li>
<li>é•¿äº‹åŠ¡</li>
<li>é”ç­‰å¾…</li>
<li>è¿æ¥æ•°</li>
</ul>
<h3 data-id="heading-19">4. æºç ä¸èƒ½åªçœ‹ï¼Œè¦è°ƒè¯•</h3>
<p>çœ‹æºç å¾ˆå¤šæ—¶å€™çœ‹ä¸å‡ºé—®é¢˜ã€‚è¿™æ¬¡æ˜¯çœŸçš„æ‰“æ–­ç‚¹ä¸€æ­¥æ­¥èµ°ï¼Œæ‰å‘ç°<code>getTransaction</code>æ–¹æ³•é‡Œæœ‰ä¸ª<code>isExistingTransaction</code>çš„åˆ¤æ–­ã€‚</p>
<p>é‡åˆ°è¯¡å¼‚é—®é¢˜ï¼Œç›´æ¥ä¸Šæ–­ç‚¹è°ƒè¯•ã€‚çœ‹è°ƒç”¨æ ˆï¼Œçœ‹å˜é‡å€¼ï¼Œæ¯”çœ‹æ–‡æ¡£å¿«å¤šäº†ã€‚</p>
<h2 data-id="heading-20">å†™åœ¨æœ€å</h2>
<p>è¿™ä¸ªbugä¿®å¤åï¼Œæˆ‘è·ŸåŒäº‹ä¹Ÿåˆ†äº«äº†ä¸€ä¸‹ã€‚è®°å½•äº†é—®é¢˜ç°è±¡ã€æ’æŸ¥è¿‡ç¨‹ã€æ ¹æœ¬åŸå› ã€è§£å†³æ–¹æ¡ˆå’Œé¢„é˜²æªæ–½ã€‚</p>
<p>ä¸æ˜¯ä¸ºäº†ç”©é”…ï¼Œæ˜¯ä¸ºäº†è®©å›¢é˜Ÿå…¶ä»–äººé¿å…è¸©åŒæ ·çš„å‘ã€‚</p>
<p>æŠ€æœ¯å€ºä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯è¸©å‘äº†è¿˜ä¸æ€»ç»“ã€‚</p>
<p>ç”Ÿäº§ç¯å¢ƒçš„æ¯ä¸€æ¬¡äº‹æ•…ï¼Œéƒ½æ˜¯å­¦ä¹ çš„æœºä¼šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ]]></title>    <link>https://juejin.cn/post/7585463195200946226</link>    <guid>https://juejin.cn/post/7585463195200946226</guid>    <pubDate>2025-12-20T05:47:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585463195200946226" data-draft-id="7490783352842207259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ"/> <meta itemprop="keywords" content="Redis,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-20T05:47:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T05:47:47.000Z" title="Sat Dec 20 2025 05:47:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">ä¸€ã€å‰è¨€</h4>
<p>åœ¨ç°ä»£é«˜å¹¶å‘ç³»ç»Ÿä¸­ï¼Œæ€§èƒ½å’Œæ•°æ®ä¸€è‡´æ€§å¸¸å¸¸æ˜¯ä¸€å¯¹â€œæ¬¢å–œå†¤å®¶â€ï¼šè¿½æ±‚æè‡´æ€§èƒ½å¯èƒ½ç‰ºç‰²ä¸€è‡´æ€§ï¼Œè€Œè¿‡äºå¼ºè°ƒä¸€è‡´æ€§åˆå®¹æ˜“æ‹–æ…¢ç³»ç»Ÿå“åº”ã€‚Rediså’ŒMySQLä½œä¸ºä¸¤ç§æˆªç„¶ä¸åŒçš„æ•°æ®åº“æŠ€æœ¯ï¼Œå°±åƒæ­¦ä¾ å°è¯´ä¸­çš„åŒå‰‘ï¼Œä¸€ä¸ªå¿«å¦‚é—ªç”µï¼Œä¸€ä¸ªç¨³å¦‚ç£çŸ³ã€‚å¦‚ä½•è®©å®ƒä»¬æºæ‰‹ä½œæˆ˜ï¼Œæ—¢æå‡æ€§èƒ½åˆä¿éšœæ•°æ®ä¸€è‡´æ€§ï¼Œæ˜¯è®¸å¤šå¼€å‘è€…é¢ä¸´çš„ç°å®æŒ‘æˆ˜ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå•†ç³»ç»Ÿï¼Œå•†å“è¯¦æƒ…é¡µæ¯ç§’è¢«è®¿é—®ä¸Šä¸‡æ¬¡ï¼Œæ•°æ®åº“ä¸å ªé‡è´Ÿï¼›æˆ–è€…åœ¨ç§’æ€æ´»åŠ¨ä¸­ï¼Œåº“å­˜æ•°æ®ç¨æœ‰å»¶è¿Ÿå°±å¯èƒ½å¼•å‘è¶…å–ã€‚å•é MySQLï¼ŒæŸ¥è¯¢æ…¢ã€å‹åŠ›å¤§ï¼›å•é Redisï¼Œåˆéš¾ä»¥ä¿è¯æŒä¹…åŒ–å’Œå¤æ‚æŸ¥è¯¢ã€‚è¿™æ—¶ï¼ŒRedisä¸MySQLçš„ç»“åˆå°±æˆäº†â€œæ•‘å‘½ç¨»è‰â€ã€‚Redisè´Ÿè´£ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼ŒMySQLä¿éšœæ•°æ®æŒä¹…åŒ–å’Œäº‹åŠ¡æ”¯æŒï¼Œä¸¤è€…åˆ†å·¥æ˜ç¡®ï¼Œä¼˜åŠ¿äº’è¡¥ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« é¢å‘æœ‰1-2å¹´Redisä½¿ç”¨ç»éªŒçš„å¼€å‘è€…ã€‚ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰åŸºæœ¬çš„<code>SET</code>ã€<code>GET</code>æ“ä½œï¼Œä¹Ÿå°è¯•è¿‡ç”¨Redisä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ï¼Œä½†é¢å¯¹ç¼“å­˜æ›´æ–°ç­–ç•¥å’Œä¸€è‡´æ€§é—®é¢˜æ—¶ï¼Œéš¾å…æœ‰äº›è¿·é›¾é‡é‡ã€‚æˆ‘çš„ç›®æ ‡æ˜¯é€šè¿‡å®æˆ˜ç»éªŒï¼Œå¸¦ä½ æ¢³ç†Redisä¸MySQLååŒå·¥ä½œçš„æ ¸å¿ƒç­–ç•¥ï¼Œå‰–æå¸¸è§é—®é¢˜ï¼Œå¹¶åˆ†äº«è§£å†³æ–¹æ¡ˆå’Œæ³¨æ„äº‹é¡¹ã€‚æ— è®ºä½ æ˜¯æƒ³æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œè¿˜æ˜¯è§£å†³â€œç¼“å­˜å’Œæ•°æ®åº“ä¸åŒæ­¥â€çš„å¤´ç–¼é—®é¢˜ï¼Œè¿™é‡Œéƒ½æœ‰ä½ éœ€è¦çš„ç­”æ¡ˆã€‚</p>
<h5 data-id="heading-1">æˆ‘çš„æ•…äº‹ä¸ç»éªŒ</h5>
<p>æˆ‘ä»äº‹åç«¯å¼€å‘å·²æœ‰10å¹´ï¼Œå…¶ä¸­Rediså‡ ä¹æ˜¯æˆ‘æ¯ä¸ªé¡¹ç›®çš„â€œè€æ­æ¡£â€ã€‚ä»æ—©æœŸçš„é«˜å¹¶å‘ç”µå•†å¹³å°ï¼Œåˆ°åæ¥çš„å®æ—¶æ•°æ®åˆ†æç³»ç»Ÿï¼Œå†åˆ°æœ€è¿‘çš„åˆ†å¸ƒå¼æ—¥å¿—æœåŠ¡ï¼ŒRedisä¸MySQLçš„ç»„åˆè´¯ç©¿å§‹ç»ˆã€‚æ¯”å¦‚åœ¨æŸç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Redisç¼“å­˜å•†å“è¯¦æƒ…é¡µï¼ŒQPSä»å‡ ç™¾æå‡åˆ°ä¸Šä¸‡ï¼Œæ•°æ®åº“è´Ÿè½½é™ä½äº†80%ï¼›åœ¨å®æ—¶ç›‘æ§é¡¹ç›®ä¸­ï¼ŒRedisçš„ä½å»¶è¿Ÿè®©æˆ‘ä»¬èƒ½ç§’çº§æ›´æ–°æ•°æ®ï¼Œè€ŒMySQLåˆ™é»˜é»˜å®ˆæŠ¤ç€æ•°æ®çš„å®Œæ•´æ€§ã€‚è¿™äº›ç»éªŒå‘Šè¯‰æˆ‘ï¼Œç¼“å­˜ä¸æ•°æ®åº“çš„åä½œä¸ä»…ä»…æ˜¯æŠ€æœ¯é€‰å‹ï¼Œæ›´æ˜¯ä¸šåŠ¡éœ€æ±‚ä¸æ¶æ„è®¾è®¡çš„å¹³è¡¡ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¸€è·¯å¹¶éå¦é€”ã€‚ç¼“å­˜å¤±æ•ˆå¯¼è‡´çš„è„æ•°æ®ã€é«˜å¹¶å‘ä¸‹çš„çƒ­ç‚¹Keyé—®é¢˜ã€ç”šè‡³Rediså®•æœºå¼•å‘çš„è¿é”ååº”ï¼Œéƒ½è®©æˆ‘è¸©è¿‡ä¸å°‘å‘ã€‚æ­£æ˜¯è¿™äº›â€œæ‘”æ‰“â€ï¼Œè®©æˆ‘æ·±åˆ»è®¤è¯†åˆ°ç¼“å­˜æ›´æ–°ç­–ç•¥å’Œæ•°æ®ä¸€è‡´æ€§ä¿éšœçš„é‡è¦æ€§ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†ç»“åˆè¿™äº›å®æˆ˜ç»éªŒï¼Œå¸¦ä½ ä¸€æ­¥æ­¥è§£é”Redisä¸MySQLåŒå‰‘åˆç’§çš„å¥¥ç§˜ã€‚</p>
<hr/>
<h4 data-id="heading-2">äºŒã€Redisä¸MySQLåŒå‰‘åˆç’§çš„æ ¸å¿ƒä¼˜åŠ¿</h4>
<p>Rediså’ŒMySQLçš„ç»„åˆï¼Œå°±åƒä¸€åœºç²¾å¿ƒç¼–æ’çš„â€œåŒäººèˆâ€ï¼šRedisä»¥è¿…é›·ä¸åŠæ©è€³ä¹‹åŠ¿å¤„ç†é«˜é¢‘è¯·æ±‚ï¼ŒMySQLåˆ™ç¨³æ‰ç¨³æ‰“å®ˆæŠ¤æ•°æ®çš„å®Œæ•´æ€§ã€‚å•ç‹¬ä½¿ç”¨å®ƒä»¬éƒ½æœ‰å±€é™ï¼Œä½†ç»“åˆèµ·æ¥å´èƒ½è¿¸å‘å‡ºæƒŠäººçš„èƒ½é‡ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å‰–æä¸¤è€…çš„äº’è¡¥æ€§ï¼Œæ¢è®¨å…¸å‹åº”ç”¨åœºæ™¯ï¼Œå¹¶èŠèŠæ€§èƒ½ä¸ä¸€è‡´æ€§ä¹‹é—´çš„å¾®å¦™æƒè¡¡ã€‚</p>
<h5 data-id="heading-3">1. Redisä¸MySQLçš„äº’è¡¥æ€§</h5>
<p>MySQLæ˜¯å…³ç³»å‹æ•°æ®åº“çš„â€œè€å¤§å“¥â€ï¼Œæ“…é•¿æŒä¹…åŒ–å­˜å‚¨å’Œå¤æ‚æŸ¥è¯¢ã€‚å®ƒçš„å¼ºä¸€è‡´æ€§ï¼ˆACIDç‰¹æ€§ï¼‰å’Œä¸°å¯Œçš„äº‹åŠ¡æ”¯æŒï¼Œè®©å®ƒæˆä¸ºæ•°æ®å¯é æ€§çš„åŸºçŸ³ã€‚ç„¶è€Œï¼Œé¢å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Œç£ç›˜I/Oå’Œé”æœºåˆ¶å¾€å¾€è®©å®ƒâ€œå–˜ä¸è¿‡æ°”æ¥â€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒRediså°±åƒä¸€ä½â€œè½»åŠŸé«˜æ‰‹â€ï¼ŒåŸºäºå†…å­˜æ“ä½œï¼Œè¯»å†™å»¶è¿Ÿä½è‡³äºšæ¯«ç§’çº§ï¼Œå•æœºQPSè½»æ¾çªç ´åä¸‡ï¼Œéå¸¸é€‚åˆç¼“å­˜çƒ­ç‚¹æ•°æ®æˆ–ä¸´æ—¶çŠ¶æ€ã€‚ä½†Redisä¹Ÿæœ‰çŸ­æ¿ï¼šæ•°æ®æŒä¹…åŒ–èƒ½åŠ›æœ‰é™ï¼Œå¤æ‚æŸ¥è¯¢æ›´æ˜¯å®ƒçš„â€œè½¯è‚‹â€ã€‚</p>
<p>ä¸¤è€…çš„ç»“åˆï¼Œæ°å¥½å¼¥è¡¥äº†å½¼æ­¤çš„ä¸è¶³ã€‚åœ¨æˆ‘å‚ä¸çš„ä¸€ä¸ªç”µå•†é¡¹ç›®ä¸­ï¼Œå•†å“è¯¦æƒ…é¡µçš„è®¿é—®é‡æ¿€å¢æ—¶ï¼Œæˆ‘ä»¬ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼ŒQPSä»500æå‡åˆ°2ä¸‡ï¼ŒMySQLçš„æŸ¥è¯¢å‹åŠ›éª¤é™80%ã€‚è€Œåº“å­˜æ›´æ–°ç­‰å…³é”®æ“ä½œä¾ç„¶äº¤ç»™MySQLï¼Œç¡®ä¿æ•°æ®ä¸ä¼šå› Rediså®•æœºè€Œä¸¢å¤±ã€‚è¿™ç§â€œå¿«æ…¢æ­é…â€çš„æ¨¡å¼ï¼Œæ—¢æå‡äº†æ€§èƒ½ï¼Œåˆä¿éšœäº†å¯é æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ä¸€è§ˆè¡¨ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>MySQL</th><th>Redis</th><th>ç»“åˆåæ•ˆæœ</th></tr></thead><tbody><tr><td>æ•°æ®å­˜å‚¨</td><td>ç£ç›˜ï¼ŒæŒä¹…åŒ–</td><td>å†…å­˜ï¼Œä¸´æ—¶</td><td>çƒ­ç‚¹æ•°æ®åŠ é€Ÿï¼Œæ ¸å¿ƒæ•°æ®å®‰å…¨</td></tr><tr><td>è®¿é—®é€Ÿåº¦</td><td>æ¯«ç§’çº§</td><td>äºšæ¯«ç§’çº§</td><td>æ€§èƒ½æå‡10å€ä»¥ä¸Š</td></tr><tr><td>æŸ¥è¯¢èƒ½åŠ›</td><td>å¤æ‚SQLæ”¯æŒ</td><td>ç®€å•Key-Value</td><td>æ»¡è¶³å¤šæ ·åŒ–éœ€æ±‚</td></tr><tr><td>ä¸€è‡´æ€§</td><td>å¼ºä¸€è‡´æ€§</td><td>å¼±ä¸€è‡´æ€§</td><td>å¯æ ¹æ®ä¸šåŠ¡çµæ´»è°ƒæ•´</td></tr></tbody></table>
<h5 data-id="heading-4">2. å…¸å‹åº”ç”¨åœºæ™¯</h5>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒRedisä¸MySQLçš„ç»„åˆæ— å¤„ä¸åœ¨ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå¸¸è§çš„ä¾‹å­ï¼š</p>
<ul>
<li>
<p><strong>ç”µå•†å•†å“è¯¦æƒ…é¡µ</strong><br/>
å•†å“ä¿¡æ¯ï¼ˆå¦‚åç§°ã€ä»·æ ¼ï¼‰å˜åŒ–é¢‘ç‡ä½ï¼Œä½†è®¿é—®é‡æé«˜ã€‚æˆ‘ä»¬ç”¨Redisç¼“å­˜è¿™äº›æ•°æ®ï¼Œè®¾ç½®TTLä¸º1å°æ—¶ï¼Œæå¤§å‡å°‘MySQLçš„æŸ¥è¯¢å‹åŠ›ã€‚è€Œåº“å­˜æ•°æ®å› å®æ—¶æ€§è¦æ±‚é«˜ï¼Œæ›´æ–°æ—¶ç›´æ¥å†™MySQLï¼Œå†åŒæ­¥å¤±æ•ˆRedisç¼“å­˜ã€‚è¿™ç§åˆ†å·¥è®©ç³»ç»Ÿæ—¢å¿«åˆç¨³ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·ä¼šè¯ç®¡ç†</strong><br/>
åœ¨ä¸€ä¸ªç¤¾äº¤åº”ç”¨ä¸­ï¼Œç”¨æˆ·ç™»å½•çŠ¶æ€ç”¨Rediså­˜å‚¨ï¼ŒTTLè®¾ä¸º30åˆ†é’Ÿï¼Œå¿«é€Ÿå“åº”ä¼šè¯æŸ¥è¯¢ã€‚ç”¨æˆ·çš„é•¿æœŸæ•°æ®ï¼ˆå¦‚æ³¨å†Œä¿¡æ¯ï¼‰åˆ™ä¿å­˜åœ¨MySQLä¸­ï¼Œç¡®ä¿å³ä½¿Redisé‡å¯ï¼Œä¼šè¯è¿‡æœŸåä¹Ÿèƒ½ä»MySQLæ¢å¤ã€‚è¿™ç§æ­é…è®©ä¼šè¯ç®¡ç†é«˜æ•ˆåˆå¯é ã€‚</p>
</li>
</ul>
<h5 data-id="heading-5">3. ä¸€è‡´æ€§ä¸æ€§èƒ½çš„æƒè¡¡</h5>
<p>Redisä¸MySQLåä½œæ—¶ï¼Œæ€§èƒ½å’Œä¸€è‡´æ€§å°±åƒå¤©å¹³çš„ä¸¤ç«¯ï¼Œå¾ˆéš¾ä¸¤å…¨å…¶ç¾ã€‚æˆ‘ä»¬å¸¸å¬åˆ°â€œæœ€ç»ˆä¸€è‡´æ€§â€å’Œâ€œå¼ºä¸€è‡´æ€§â€è¿™ä¸¤ä¸ªè¯ï¼Œå®ƒä»¬è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿç­”æ¡ˆè—åœ¨ä¸šåŠ¡éœ€æ±‚é‡Œã€‚</p>
<p>ä»¥ç§’æ€åœºæ™¯ä¸ºä¾‹ï¼Œåº“å­˜æ‰£å‡å¿…é¡»å®æ—¶å‡†ç¡®ï¼Œä»»ä½•å»¶è¿Ÿæˆ–ä¸ä¸€è‡´éƒ½å¯èƒ½å¯¼è‡´è¶…å–ã€‚è¿™æ—¶éœ€è¦å¼ºä¸€è‡´æ€§ï¼Œé€šå¸¸é€šè¿‡åˆ†å¸ƒå¼é”æˆ–äº‹åŠ¡ç¡®ä¿Rediså’ŒMySQLåŒæ­¥æ›´æ–°ã€‚è€Œåœ¨æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çœ‹åˆ°çš„å•†å“åˆ—è¡¨å¯èƒ½åŸºäºå‡ åˆ†é’Ÿå‰çš„æ•°æ®ï¼ŒçŸ­æš‚çš„ä¸ä¸€è‡´æ— ä¼¤å¤§é›…ï¼Œæœ€ç»ˆä¸€è‡´æ€§å°±å¤Ÿç”¨äº†â€”â€”å…ˆæ›´æ–°MySQLï¼Œå†å¼‚æ­¥åˆ·æ–°Rediså³å¯ã€‚</p>
<p><strong>æƒè¡¡é€‰æ‹©ç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">é«˜ä¸€è‡´æ€§éœ€æ±‚       ä¸­é—´åœ°å¸¦       é«˜æ€§èƒ½éœ€æ±‚
|<span class="hljs-comment">-------|-------|-------|-------|</span>
å¼ºä¸€è‡´æ€§         æœ€ç»ˆä¸€è‡´æ€§
&lt;<span class="hljs-comment">-- ç§’æ€ã€æ”¯ä»˜ --&gt; &lt;-- æ¨èã€æ—¥å¿— --&gt;</span>
</code></pre>
<p>åœ¨æˆ‘çš„ç»éªŒä¸­ï¼Œä¸€ä¸ªå®æ—¶æ•°æ®åˆ†æé¡¹ç›®è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°è¿™ç§æƒè¡¡ã€‚åˆæœŸæˆ‘ä»¬è¿½æ±‚å¼ºä¸€è‡´æ€§ï¼Œæ‰€æœ‰æ•°æ®éƒ½åŒæ­¥å†™Rediså’ŒMySQLï¼Œç»“æœæ€§èƒ½ç“¶é¢ˆæ˜æ˜¾ã€‚åæ¥è°ƒæ•´ä¸ºå¼‚æ­¥å†™å›ç­–ç•¥ï¼Œååé‡æå‡äº†3å€ï¼Œç”¨æˆ·ä¹Ÿèƒ½æ¥å—ç§’çº§çš„å»¶è¿Ÿã€‚è¿™æé†’æˆ‘ä»¬ï¼šæŠ€æœ¯æ–¹æ¡ˆæ²¡æœ‰ç»å¯¹çš„å¥½åï¼Œåªæœ‰é€‚ä¸é€‚åˆã€‚</p>
<hr/>
<h4 data-id="heading-6">ä¸‰ã€ç¼“å­˜æ›´æ–°ç­–ç•¥è¯¦è§£</h4>
<p>Redisä¸MySQLçš„åä½œå¥½æ¯”ä¸€åœºç²¾å¯†çš„â€œæ¥åŠ›èµ›â€ï¼Œç¼“å­˜æ›´æ–°ç­–ç•¥å°±æ˜¯æ¥åŠ›æ£’äº¤æ¥çš„è§„åˆ™ã€‚äº¤æ¥é¡ºç•…ï¼Œç³»ç»Ÿè·‘å¾—åˆå¿«åˆç¨³ï¼›ç¨æœ‰å¤±è¯¯ï¼Œå°±å¯èƒ½æ‘”ä¸ªè·Ÿå¤´ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸‰ç§ä¸»æµç¼“å­˜æ›´æ–°ç­–ç•¥ï¼šCache-Asideã€Write-Throughå’ŒWrite-Behindï¼Œå‰–æå®ƒä»¬çš„åŸç†ã€ä¼˜ç¼ºç‚¹ï¼Œå¹¶ç»“åˆå®æˆ˜ç»éªŒåˆ†äº«ä»£ç å’Œè¸©å‘æ•™è®­ï¼Œæœ€åç»™å‡ºé€‰æ‹©å»ºè®®ã€‚</p>
<h5 data-id="heading-7">1. å¸¸è§çš„ç¼“å­˜æ›´æ–°ç­–ç•¥</h5>
<h6 data-id="heading-8">Cache-Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šè¿™æ˜¯æœ€ç»å…¸çš„ç¼“å­˜ç­–ç•¥ã€‚è¯»å–æ—¶ï¼Œå…ˆæŸ¥Redisï¼Œè‹¥æœªå‘½ä¸­åˆ™æŸ¥MySQLå¹¶å›å†™ç¼“å­˜ï¼›å†™å…¥æ—¶ï¼Œå…ˆæ›´æ–°MySQLï¼Œå†ä¸»åŠ¨å¤±æ•ˆï¼ˆåˆ é™¤ï¼‰Redisç¼“å­˜ã€‚è¿™ç§â€œæ‡’åŠ è½½â€çš„æ–¹å¼è®©ç¼“å­˜æŒ‰éœ€å¡«å……ï¼Œéå¸¸çµæ´»ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å®ç°ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½ã€‚</li>
<li>é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜æ—¶æ€§èƒ½æå‡æ˜¾è‘—ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span>
String <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user:"</span> + userId;
    <span class="hljs-type">String</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> redis.get(cacheKey); <span class="hljs-comment">// å…ˆæŸ¥Redis</span>
    <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) { <span class="hljs-comment">// æœªå‘½ä¸­</span>
        user = mysql.query(<span class="hljs-string">"SELECT * FROM users WHERE id = ?"</span>, userId); <span class="hljs-comment">// æŸ¥MySQL</span>
        <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) {
            redis.setex(cacheKey, <span class="hljs-number">3600</span>, user); <span class="hljs-comment">// å›å†™Redisï¼ŒTTLä¸º1å°æ—¶</span>
        }
    }
    <span class="hljs-keyword">return</span> user;
}

<span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">updateUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId, String data)</span> {
    mysql.update(<span class="hljs-string">"UPDATE users SET data = ? WHERE id = ?"</span>, data, userId); <span class="hljs-comment">// å…ˆæ›´æ–°MySQL</span>
    redis.del(<span class="hljs-string">"user:"</span> + userId); <span class="hljs-comment">// å†åˆ é™¤Redisç¼“å­˜</span>
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨ä¸€ä¸ªç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å‘ç°éƒ¨åˆ†ç”¨æˆ·æ•°æ®æ›´æ–°åï¼Œç¼“å­˜æœªåŠæ—¶å¤±æ•ˆï¼Œå¯¼è‡´å‰ç«¯æ˜¾ç¤ºè„æ•°æ®ã€‚åæ¥åˆ†æå‘ç°ï¼ŒæŸäº›åœºæ™¯ä¸‹<code>redis.del</code>å› ç½‘ç»œæŠ–åŠ¨å¤±è´¥ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥TTLè‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œå³ä½¿åˆ é™¤å¤±è´¥ï¼Œç¼“å­˜ä¹Ÿä¼šåœ¨åˆ°æœŸåå¤±æ•ˆï¼Œé¿å…é•¿æœŸä¸ä¸€è‡´ã€‚</p>
<h6 data-id="heading-9">Write-Throughï¼ˆç›´å†™ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šå†™å…¥æ—¶åŒæ—¶æ›´æ–°MySQLå’ŒRedisï¼Œç¡®ä¿ä¸¤è€…æ•°æ®æ—¶åˆ»ä¸€è‡´ã€‚å°±åƒâ€œåŒç®¡é½ä¸‹â€ï¼Œæ¯æ¬¡å†™æ“ä½œéƒ½ä¸¤è¾¹åŒæ­¥ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¸€è‡´æ€§å¼ºï¼Œè¯»æ“ä½œæ— éœ€æ‹…å¿ƒè„æ•°æ®ã€‚</li>
<li>é€‚åˆå†™é¢‘ç¹ä¸”ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>æ€§èƒ½å¼€é”€å¤§ï¼ŒåŒå†™å¢åŠ äº†å»¶è¿Ÿã€‚</li>
<li>Rediså’ŒMySQLçš„åŒæ­¥å¯èƒ½å› å¼‚å¸¸ä¸­æ–­ã€‚</li>
</ul>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š<br/>
åœ¨é‡‘èç³»ç»Ÿçš„è´¦æˆ·ä½™é¢æ›´æ–°ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨Write-Throughã€‚æ¯æ¬¡è½¬è´¦æ“ä½œå…ˆå†™MySQLï¼Œå†åŒæ­¥æ›´æ–°Redisï¼Œç¡®ä¿ä½™é¢å®æ—¶å‡†ç¡®ã€‚è™½ç„¶æ€§èƒ½ç•¥æœ‰ä¸‹é™ï¼Œä½†ä¸€è‡´æ€§å¾—åˆ°äº†ä¿éšœã€‚</p>
<h6 data-id="heading-10">Write-Behindï¼ˆå¼‚æ­¥å†™å›ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šå…ˆå¿«é€Ÿå†™å…¥Redisï¼Œå†é€šè¿‡å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—æˆ–å®šæ—¶ä»»åŠ¡ï¼‰æ‰¹é‡æ›´æ–°MySQLã€‚å°±åƒâ€œå…ˆè®°è´¦ï¼Œåå¯¹è´¦â€ï¼Œä¼˜å…ˆä¿è¯å†™æ€§èƒ½ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>é«˜ååé‡ï¼Œé€‚åˆé«˜å¹¶å‘å†™åœºæ™¯ã€‚</li>
<li>å¼‚æ­¥æ‰¹é‡æ“ä½œå‡å°‘æ•°æ®åº“å‹åŠ›ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateProductStock</span><span class="hljs-params">(<span class="hljs-type">int</span> productId, <span class="hljs-type">int</span> stock)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"stock:"</span> + productId;
    redis.set(cacheKey, stock); <span class="hljs-comment">// å…ˆå†™Redis</span>
    messageQueue.send(<span class="hljs-string">"update_stock"</span>, productId, stock); <span class="hljs-comment">// å¼‚æ­¥å‘MQæ›´æ–°MySQL</span>
}

<span class="hljs-comment">// MQæ¶ˆè´¹è€…</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String productId, <span class="hljs-type">int</span> stock)</span> {
    mysql.update(<span class="hljs-string">"UPDATE products SET stock = ? WHERE id = ?"</span>, stock, productId);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨å®æ—¶ç›‘æ§ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç”¨Write-Behindå¤„ç†æŒ‡æ ‡æ•°æ®ã€‚æŸæ¬¡MQæ¶ˆè´¹å¤±è´¥ï¼Œå¯¼è‡´MySQLæœªæ›´æ–°ï¼Œæ•°æ®ä¸¢å¤±äº†è¿‘1å°æ—¶ã€‚å¸å–æ•™è®­åï¼Œæˆ‘ä»¬å¼•å…¥é‡è¯•æœºåˆ¶å’Œæ—¥å¿—è¡¥å¿ï¼šå¤±è´¥çš„ä»»åŠ¡é‡è¯•3æ¬¡ä»ä¸æˆåŠŸåˆ™è®°å½•æ—¥å¿—ï¼Œè¿ç»´äººå‘˜æ‰‹åŠ¨ä¿®å¤ã€‚</p>
<h5 data-id="heading-11">2. å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç­–ç•¥</h5>
<p>é€‰æ‹©ç¼“å­˜ç­–ç•¥å°±åƒæŒ‘é€‰æ­¦åŠŸæ‹›å¼ï¼Œæ²¡æœ‰æœ€å¼ºï¼Œåªæœ‰æœ€åˆé€‚ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„ç»éªŒæ€»ç»“ï¼š</p>
<p><strong>é€‰æ‹©ä¾æ®å¯¹æ¯”è¡¨ï¼š</strong></p>

































<table><thead><tr><th>ç­–ç•¥</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¸€è‡´æ€§</th><th>æ€§èƒ½</th><th>å¤æ‚åº¦</th></tr></thead><tbody><tr><td>Cache-Aside</td><td>è¯»å¤šå†™å°‘ï¼ˆå¦‚å•†å“è¯¦æƒ…ï¼‰</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>é«˜</td><td>ä½</td></tr><tr><td>Write-Through</td><td>å†™é¢‘ç¹ä¸€è‡´æ€§é«˜ï¼ˆå¦‚é‡‘èï¼‰</td><td>å¼ºä¸€è‡´æ€§</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>Write-Behind</td><td>é«˜å¹¶å‘å†™ï¼ˆå¦‚æ—¥å¿—ï¼‰</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>æé«˜</td><td>é«˜</td></tr></tbody></table>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼š</p>
<ul>
<li><strong>ç”µå•†åº“å­˜ç®¡ç†</strong>ï¼šæˆ‘ä»¬ç”¨Cache-Asideç»“åˆå»¶è¿ŸåŒåˆ ï¼ˆåæ–‡è¯¦è¿°ï¼‰ï¼Œåº”å¯¹è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç¡®ä¿åº“å­˜æ›´æ–°åç¼“å­˜åŠæ—¶åˆ·æ–°ã€‚</li>
<li><strong>å®æ—¶ç›‘æ§</strong>ï¼šWrite-Throughä¿è¯æŒ‡æ ‡æ•°æ®å®æ—¶åŒæ­¥ï¼Œæ»¡è¶³å¼ºä¸€è‡´æ€§éœ€æ±‚ã€‚</li>
<li><strong>æ—¥å¿—ç³»ç»Ÿ</strong>ï¼šWrite-Behindé…åˆæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè½»æ¾åº”å¯¹æ¯ç§’ç™¾ä¸‡çº§çš„å†™è¯·æ±‚ã€‚</li>
</ul>
<p>é€‰æ‹©æ—¶ï¼Œå»ºè®®ä»ä¸šåŠ¡ç‰¹ç‚¹å‡ºå‘ï¼š</p>
<ol>
<li><strong>è¯»å†™æ¯”ä¾‹</strong>ï¼šè¯»å¤šå†™å°‘é€‰Cache-Asideï¼Œå†™å¤šè¯»å°‘é€‰Write-Throughã€‚</li>
<li><strong>ä¸€è‡´æ€§è¦æ±‚</strong>ï¼šå¼ºä¸€è‡´æ€§é€‰Write-Throughï¼Œæœ€ç»ˆä¸€è‡´æ€§å¯è€ƒè™‘å…¶ä»–ä¸¤è€…ã€‚</li>
<li><strong>ç³»ç»Ÿå¤æ‚åº¦</strong>ï¼šèµ„æºæœ‰é™æ—¶ï¼Œä¼˜å…ˆç®€å•æ˜“ç”¨çš„Cache-Asideã€‚</li>
</ol>
<p><strong>ç­–ç•¥é€‰æ‹©æµç¨‹å›¾ï¼š</strong></p>
<pre><code class="hljs language-rust" lang="rust">å¼€å§‹
  |
è¯»å¤šå†™å°‘? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Cache-Aside
  |             å¦
å¼ºä¸€è‡´æ€§? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Write-Through
  |             å¦
é«˜å¹¶å‘å†™? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Write-Behind
  |
å…¶ä»–åœºæ™¯ -<span class="hljs-punctuation">-&gt;</span> æ ¹æ®å¤æ‚åº¦è°ƒæ•´
</code></pre>
<hr/>
<h4 data-id="heading-12">å››ã€æ•°æ®ä¸€è‡´æ€§ä¿éšœçš„å®æˆ˜æŠ€å·§</h4>
<p>ç¼“å­˜æ›´æ–°ç­–ç•¥ä¸ºRedisä¸MySQLçš„åä½œæ­å¥½äº†èˆå°ï¼Œä½†ä¸€è‡´æ€§é—®é¢˜å°±åƒèˆå°ä¸‹çš„â€œæš—æµâ€ï¼Œç¨ä¸ç•™ç¥å°±ä¼šè®©è¡¨æ¼”ç¿»è½¦ã€‚æ— è®ºæ˜¯ç¼“å­˜æœªåŠæ—¶åˆ·æ–°ï¼Œè¿˜æ˜¯å¹¶å‘æ›´æ–°å¯¼è‡´çš„è„æ•°æ®ï¼Œè¿™äº›é—®é¢˜éƒ½å¯èƒ½è®©ç”¨æˆ·ä½“éªŒå¤§æ‰“æŠ˜æ‰£ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ç›´é¢ä¸€è‡´æ€§é—®é¢˜çš„æ ¹æºï¼Œåˆ†äº«æˆ‘åœ¨é¡¹ç›®ä¸­æ€»ç»“çš„å®æˆ˜æŠ€å·§ï¼Œå¸®åŠ©ä½ æ‰“é€ ä¸€ä¸ªæ—¢å¿«åˆå‡†çš„ç³»ç»Ÿã€‚</p>
<h5 data-id="heading-13">1. ä¸€è‡´æ€§é—®é¢˜çš„æ ¹æº</h5>
<p>ä¸€è‡´æ€§é—®é¢˜é€šå¸¸æºäºä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>æ›´æ–°é¡ºåºå¼‚å¸¸</strong>ï¼šæ¯”å¦‚å…ˆå†™MySQLååˆ Redisï¼Œä½†Rediså®•æœºæˆ–ç½‘ç»œå»¶è¿Ÿå¯¼è‡´åˆ é™¤å¤±è´¥ï¼Œç¼“å­˜ä¿ç•™äº†æ—§æ•°æ®ã€‚</li>
<li><strong>å¹¶å‘å†²çª</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°åŒä¸€æ•°æ®ï¼Œæ¯”å¦‚ç§’æ€åœºæ™¯ä¸‹å¤šäººæŠ¢è´­åº“å­˜ï¼Œå¯èƒ½å‡ºç°Rediså’ŒMySQLçš„æ•°æ®â€œæ‰“æ¶â€ã€‚</li>
</ul>
<p>åœ¨ä¸€æ¬¡ç”µå•†æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬å°±é‡åˆ°è¿‡ç±»ä¼¼é—®é¢˜ï¼šåº“å­˜æ›´æ–°åï¼ŒRedisç¼“å­˜æœªåŠæ—¶åˆ é™¤ï¼Œå¯¼è‡´å‰ç«¯æ˜¾ç¤ºçš„åº“å­˜æ¯”å®é™…å¤šï¼Œæœ€ç»ˆå¼•å‘è¶…å–ã€‚åˆ†æåå‘ç°ï¼Œæ ¹æºåœ¨äºé«˜å¹¶å‘ä¸‹æ“ä½œé¡ºåºä¸å¯æ§å’Œå¼‚å¸¸å¤„ç†ä¸è¶³ã€‚</p>
<h5 data-id="heading-14">2. è§£å†³æ–¹æ¡ˆä¸æœ€ä½³å®è·µ</h5>
<p>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œæˆ‘æ€»ç»“äº†ä¸‰ç§å®ç”¨æ–¹æ¡ˆï¼Œä¸‹é¢é€ä¸€å±•å¼€ã€‚</p>
<h6 data-id="heading-15">å»¶è¿ŸåŒåˆ ç­–ç•¥</h6>
<p><strong>åŸç†</strong>ï¼šå†™MySQLåç«‹å³åˆ é™¤Redisç¼“å­˜ï¼Œç­‰å‡ ç§’åå†åˆ ä¸€æ¬¡ï¼Œç¡®ä¿å³ä½¿æœ‰å¹¶å‘è¯»å›å†™äº†æ—§æ•°æ®ï¼Œä¹Ÿèƒ½è¢«æ¸…ç†æ‰ã€‚è¿™å°±åƒâ€œåŒé‡ä¿é™©â€ï¼Œç‰ºç‰²ä¸€ç‚¹å»¶è¿Ÿæ¢å–ä¸€è‡´æ€§ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJava+Springï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(<span class="hljs-type">int</span> productId, String data)</span> {
    <span class="hljs-comment">// æ›´æ–°MySQL</span>
    mysql.update(<span class="hljs-string">"UPDATE products SET data = ? WHERE id = ?"</span>, data, productId);
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + productId;
    redis.del(cacheKey); <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åˆ é™¤</span>
    <span class="hljs-comment">// å»¶è¿Ÿ2ç§’å†æ¬¡åˆ é™¤</span>
    taskScheduler.schedule(() -&gt; redis.del(cacheKey), <span class="hljs-number">2000</span>);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨æŸé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å›ºå®šå»¶è¿Ÿ2ç§’ï¼Œç»“æœå‘ç°é«˜å³°æœŸQPSè¿‡é«˜æ—¶ï¼Œ2ç§’ä¸å¤Ÿè¦†ç›–æ‰€æœ‰å¹¶å‘è¯»ï¼Œå¯¼è‡´éƒ¨åˆ†è„æ•°æ®æ®‹ç•™ã€‚åæ¥æ”¹ä¸ºåŠ¨æ€è°ƒæ•´å»¶è¿Ÿæ—¶é—´ï¼ˆæ ¹æ®ä¸šåŠ¡QPSï¼ŒèŒƒå›´1-5ç§’ï¼‰ï¼Œé—®é¢˜æ˜¾è‘—å‡å°‘ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šè¯»å¤šå†™å°‘ï¼Œä¸”èƒ½å®¹å¿çŸ­æš‚ä¸ä¸€è‡´ã€‚</p>
<h6 data-id="heading-16">åˆ†å¸ƒå¼é”</h6>
<p><strong>åŸç†</strong>ï¼šåœ¨é«˜å¹¶å‘æ›´æ–°æ—¶ï¼Œç”¨Redisåˆ†å¸ƒå¼é”ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ“ä½œæ•°æ®ï¼Œé¿å…å†²çªã€‚å°±åƒç»™èµ„æºåŠ äº†æŠŠâ€œå®‰å…¨é”â€ï¼Œè°æ‹¿åˆ°é’¥åŒ™è°æ“ä½œã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆRedisåˆ†å¸ƒå¼é”ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">lockKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"lock:product:"</span> + productId;
<span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + productId;
<span class="hljs-keyword">if</span> (redis.setnx(lockKey, <span class="hljs-string">"1"</span>)) { <span class="hljs-comment">// å°è¯•åŠ é”</span>
    redis.expire(lockKey, <span class="hljs-number">10</span>); <span class="hljs-comment">// è®¾ç½®10ç§’è¶…æ—¶</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ›´æ–°MySQL</span>
        mysql.update(<span class="hljs-string">"UPDATE products SET stock = stock - 1 WHERE id = ?"</span>, productId);
        redis.del(cacheKey); <span class="hljs-comment">// åŒæ­¥åˆ é™¤ç¼“å­˜</span>
    } <span class="hljs-keyword">finally</span> {
        redis.del(lockKey); <span class="hljs-comment">// é‡Šæ”¾é”</span>
    }
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–é”å¤±è´¥ï¼Œé‡è¯•"</span>);
}
</code></pre>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li><strong>è¶…æ—¶è®¾ç½®</strong>ï¼šé”è¶…æ—¶å¤ªçŸ­å¯èƒ½æå‰é‡Šæ”¾ï¼Œå¤ªé•¿å¯èƒ½é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œå»ºè®®æ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼ˆ5-30ç§’ï¼‰ã€‚</li>
<li><strong>ç»­æœŸæœºåˆ¶</strong>ï¼šè‹¥æ“ä½œè€—æ—¶é•¿ï¼Œå¯ç”¨watchdogçº¿ç¨‹è‡ªåŠ¨ç»­æœŸï¼Œé¿å…æ­»é”ã€‚</li>
<li><strong>è¸©å‘ç»éªŒ</strong>ï¼šä¸€æ¬¡ç§’æ€æ´»åŠ¨ä¸­ï¼Œå¿˜è®°é‡Šæ”¾é”ï¼Œå¯¼è‡´åç»­è¯·æ±‚å…¨è¢«é˜»å¡ã€‚åæ¥ç”¨<code>finally</code>å—ç¡®ä¿é‡Šæ”¾ï¼Œæ‰è§£å†³é—®é¢˜ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç§’æ€ã€åº“å­˜æ‰£å‡ç­‰é«˜å¹¶å‘å¼ºä¸€è‡´æ€§åœºæ™¯ã€‚</p>
<h6 data-id="heading-17">æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦</h6>
<p><strong>åŸç†</strong>ï¼šå†™æ“ä½œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰è§£è€¦ï¼Œå…ˆå¿«é€Ÿå†™Redisï¼Œå†ç”±æ¶ˆè´¹è€…å¼‚æ­¥æ›´æ–°MySQLã€‚è¿™å°±åƒâ€œå¿«é€’ä»£å‘â€ï¼Œå‰ç«¯å¿«é€Ÿå“åº”ï¼Œåç«¯æ…¢æ…¢å¤„ç†ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateLog</span><span class="hljs-params">(String logData)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"log:"</span> + UUID.randomUUID();
    redis.set(cacheKey, logData); <span class="hljs-comment">// å…ˆå†™Redis</span>
    messageQueue.send(<span class="hljs-string">"update_log"</span>, logData); <span class="hljs-comment">// å‘MQå¼‚æ­¥æ›´æ–°</span>
}

<span class="hljs-comment">// MQæ¶ˆè´¹è€…</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String logData)</span> {
    mysql.insert(<span class="hljs-string">"INSERT INTO logs (data) VALUES (?)"</span>, logData);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨æ—¥å¿—ç³»ç»Ÿä¸­ï¼ŒMQæ¶ˆè´¹è€…å®•æœºå¯¼è‡´ç§¯å‹ï¼ŒMySQLæœªåŠæ—¶æ›´æ–°ã€‚åæ¥å¼•å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ‰€æœ‰æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯è½¬å…¥å¤‡ç”¨é˜Ÿåˆ—ï¼Œç”±å®šæ—¶ä»»åŠ¡é‡è¯•ï¼Œç¡®ä¿ä¸ä¸¢æ•°æ®ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé«˜å¹¶å‘å†™ï¼Œä¸”ä¸€è‡´æ€§è¦æ±‚ä¸é«˜ï¼ˆå¦‚æ—¥å¿—ã€ç»Ÿè®¡æ•°æ®ï¼‰ã€‚</p>
<h5 data-id="heading-18">3. ä¸€è‡´æ€§éªŒè¯</h5>
<p>æ— è®ºç”¨å“ªç§ç­–ç•¥ï¼Œå¼‚å¸¸æ€»å¯èƒ½å‘ç”Ÿã€‚ä¸ºé˜²ä¸‡ä¸€ï¼Œæˆ‘ä»¬éœ€è¦â€œæŸ¥æ¼è¡¥ç¼ºâ€ï¼š</p>
<ul>
<li><strong>å®šæœŸæ¯”å¯¹</strong>ï¼šç”¨å®šæ—¶ä»»åŠ¡å¯¹æ¯”Redisä¸MySQLæ•°æ®ï¼Œå‘ç°ä¸ä¸€è‡´æ—¶è‡ªåŠ¨ä¿®å¤ã€‚</li>
<li><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåœ¨ç”µå•†åº“å­˜ç®¡ç†ä¸­ï¼Œæˆ‘ä»¬æ¯å¤©å‡Œæ™¨è·‘è„šæœ¬æ¯”å¯¹ï¼Œä¿®å¤äº†99%çš„è„æ•°æ®é—®é¢˜ã€‚ä¿®å¤è¿‡ç¨‹è®°å½•æ—¥å¿—ï¼Œä¾¿äºè¿½æº¯ã€‚</li>
</ul>
<p><strong>éªŒè¯æµç¨‹ç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-rust" lang="rust">å®šæ—¶ä»»åŠ¡å¯åŠ¨
    |
è·å–Redisæ•°æ® -<span class="hljs-punctuation">-&gt;</span> ä¸MySQLæ¯”å¯¹ -<span class="hljs-punctuation">-&gt;</span> ä¸ä¸€è‡´?
    |                              æ˜¯ -<span class="hljs-punctuation">-&gt;</span> æ›´æ–°Redisæˆ–MySQL -<span class="hljs-punctuation">-&gt;</span> è®°å½•æ—¥å¿—
    |                              å¦
ç»“æŸ
</code></pre>
<p><strong>ä¸€è‡´æ€§ä¿éšœæ–¹æ¡ˆå¯¹æ¯”è¡¨ï¼š</strong></p>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¸€è‡´æ€§</th><th>æ€§èƒ½å½±å“</th><th>å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>å»¶è¿ŸåŒåˆ </td><td>è¾ƒé«˜</td><td>å°</td><td>ä¸­</td><td>è¯»å¤šå†™å°‘</td></tr><tr><td>åˆ†å¸ƒå¼é”</td><td>æé«˜</td><td>ä¸­</td><td>é«˜</td><td>é«˜å¹¶å‘å¼ºä¸€è‡´æ€§</td></tr><tr><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>ä½</td><td>é«˜</td><td>é«˜å¹¶å‘å†™</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-19">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸è¸©å‘ç»éªŒ</h4>
<p>Redisä¸MySQLçš„åä½œå°±åƒä¸€è¾†è·‘è½¦ï¼Œç¼“å­˜ç­–ç•¥å’Œä¸€è‡´æ€§ä¿éšœæ˜¯å¼•æ“ï¼Œè€Œæ€§èƒ½ä¼˜åŒ–åˆ™æ˜¯è®©å®ƒè·‘å¾—æ›´å¿«æ›´ç¨³çš„â€œè°ƒæ ¡â€ã€‚ä½†è¿™æ¡èµ›é“ä¸Šä¹ŸåŸ‹äº†ä¸å°‘â€œé™·é˜±â€ï¼Œç¨ä¸ç•™ç¥å°±å¯èƒ½ç¿»è½¦ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†åˆ†äº«æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæŠ€å·§ï¼Œä»¥åŠæˆ‘åœ¨å®æˆ˜ä¸­è¸©è¿‡çš„å‘å’Œåº”å¯¹ä¹‹é“ï¼Œå¸Œæœ›å¸®ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<h5 data-id="heading-20">1. æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ç‚¹</h5>
<p>è¦æƒ³è®©ç³»ç»Ÿè·‘å¾—å¿«ï¼Œç»†èŠ‚å†³å®šæˆè´¥ã€‚ä»¥ä¸‹æ˜¯ä¸‰ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>
<p><strong>Redisé”®è®¾è®¡</strong><br/>
é”®åè¦çŸ­å°ç²¾æ‚ï¼Œé¿å…â€œå¤§Keyâ€æ‹–æ…¢æ€§èƒ½ã€‚æ¯”å¦‚å­˜å‚¨å¤æ‚æ•°æ®æ—¶ï¼Œåˆ«ç”¨ä¸€ä¸ªStringå­˜JSONï¼Œè€Œæ˜¯ç”¨Hashç»“æ„åˆ†å­—æ®µå­˜å‚¨ã€‚åœ¨ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·ä¿¡æ¯ä»<code>user:123:info</code>çš„å•ä¸€Stringæ”¹ä¸º<code>HSET user:123 name "Tom" age "25"</code>ï¼Œå†…å­˜å ç”¨å‡å°‘30%ï¼ŒæŸ¥è¯¢æ•ˆç‡ä¹Ÿæ›´é«˜ã€‚</p>
</li>
<li>
<p><strong>æ‰¹é‡æ“ä½œ</strong><br/>
Redisçš„å•æ¬¡æ“ä½œå¾ˆå¿«ï¼Œä½†ç½‘ç»œRTTï¼ˆå¾€è¿”æ—¶é—´ï¼‰å¯èƒ½æ˜¯ç“¶é¢ˆã€‚ä½¿ç”¨Pipelineæ‰¹é‡æäº¤å‘½ä»¤ï¼Œèƒ½å¤§å¹…é™ä½å»¶è¿Ÿã€‚åœ¨å®æ—¶ç›‘æ§é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†æ¯ç§’100æ¬¡<code>SET</code>æ”¹ä¸ºPipelineæ‰¹é‡æ“ä½œï¼ŒRTTä»50msé™åˆ°5msï¼Œæ€§èƒ½æå‡10å€ã€‚</p>
</li>
<li>
<p><strong>ç¼“å­˜é¢„çƒ­</strong><br/>
ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œåˆ«è®©Redisâ€œè£¸å¥”â€ã€‚æå‰åŠ è½½çƒ­ç‚¹æ•°æ®ï¼Œèƒ½é¿å…å†·å¯åŠ¨æ—¶çš„æ•°æ®åº“å‹åŠ›ã€‚åœ¨ç”µå•†æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬åœ¨æ´»åŠ¨å‰å°†Top 100å•†å“æ•°æ®é¢„çƒ­åˆ°Redisï¼Œé¦–æ³¢æµé‡ç›´æ¥å‘½ä¸­ç¼“å­˜ï¼ŒMySQLæ¯«å‘æ— æŸã€‚</p>
</li>
</ul>
<p><strong>æ€§èƒ½ä¼˜åŒ–æ•ˆæœç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">ä¼˜åŒ–å‰ï¼šé«˜RTT + å¤§Key + å†·å¯åŠ¨
  |<span class="hljs-comment">----&gt; æ•°æ®åº“å‹åŠ›æ¿€å¢</span>
ä¼˜åŒ–åï¼šPipeline + Hash + é¢„çƒ­
  |<span class="hljs-comment">----&gt; QPSæå‡ï¼Œç¨³å®šè¿è¡Œ</span>
</code></pre>
<h5 data-id="heading-21">2. è¸©å‘ç»éªŒåˆ†äº«</h5>
<p>å®æˆ˜ä¸­ï¼Œæ€§èƒ½é—®é¢˜å¾€å¾€ä¼´éšç€â€œå‘â€ã€‚ä»¥ä¸‹æ˜¯æˆ‘é‡åˆ°çš„ä¸‰å¤§å…¸å‹é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š</p>
<h6 data-id="heading-22">ç¼“å­˜ç©¿é€</h6>
<p><strong>é—®é¢˜</strong>ï¼šæŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼ˆå¦‚ç”¨æˆ·IDä¸º-1ï¼‰ï¼ŒRedisæœªå‘½ä¸­ï¼Œè¯·æ±‚ç›´è¾¾MySQLï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›æš´å¢ã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šæŸæ¬¡æ¥å£è¢«æ¶æ„è¯·æ±‚åˆ·çˆ†ï¼ŒQPSä»1ä¸‡é£™åˆ°10ä¸‡ï¼ŒMySQLå·®ç‚¹æŒ‚æ‰ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šé¢„å…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­Keyæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥è¿”å›ã€‚</li>
<li><strong>ç¼“å­˜ç©ºå€¼</strong>ï¼šæŸ¥ä¸åˆ°æ•°æ®æ—¶ï¼Œç¼“å­˜ç©ºå¯¹è±¡ï¼ˆå¦‚<code>null</code>ï¼‰ï¼ŒTTLè®¾çŸ­äº›ï¼ˆå¦‚5åˆ†é’Ÿï¼‰ã€‚
<pre><code class="hljs language-java" lang="java">String <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user:"</span> + userId;
    <span class="hljs-type">String</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> redis.get(cacheKey);
    <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> user;
    <span class="hljs-keyword">if</span> (bloomFilter.mightContain(cacheKey)) {
        user = mysql.query(<span class="hljs-string">"SELECT * FROM users WHERE id = ?"</span>, userId);
        redis.setex(cacheKey, user == <span class="hljs-literal">null</span> ? <span class="hljs-number">300</span> : <span class="hljs-number">3600</span>, user); <span class="hljs-comment">// ç©ºå€¼TTL 5åˆ†é’Ÿ</span>
    }
    <span class="hljs-keyword">return</span> user;
}
</code></pre>
</li>
</ol>
<p><strong>ç»éªŒ</strong>ï¼šå¸ƒéš†è¿‡æ»¤å™¨é€‚åˆå¤§æ•°æ®é‡åœºæ™¯ï¼Œç©ºå€¼ç¼“å­˜æ›´ç®€å•ä½†éœ€æ§åˆ¶å†…å­˜ã€‚</p>
<h6 data-id="heading-23">ç¼“å­˜é›ªå´©</h6>
<p><strong>é—®é¢˜</strong>ï¼šå¤§é‡ç¼“å­˜KeyåŒæ—¶å¤±æ•ˆï¼Œè¯·æ±‚å…¨æ‰“åˆ°MySQLï¼Œå¯¼è‡´å®•æœºã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šä¸€æ¬¡æ´»åŠ¨ç»“æŸåï¼Œæ‰€æœ‰å•†å“ç¼“å­˜TTLç»Ÿä¸€åˆ°æœŸï¼ŒMySQLç¬é—´ç˜«ç—ªã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>TTLéšæœºåŒ–</strong>ï¼šç»™æ¯ä¸ªKeyçš„TTLåŠ éšæœºåç§»ï¼ˆå¦‚1å°æ—¶Â±10åˆ†é’Ÿï¼‰ã€‚
<pre><code class="hljs language-java" lang="java">redis.setex(cacheKey, <span class="hljs-number">3600</span> + random.nextInt(<span class="hljs-number">600</span>), data);
</code></pre>
</li>
<li><strong>çƒ­ç‚¹ç¼“å­˜éš”ç¦»</strong>ï¼šå°†é«˜é¢‘Keyå•ç‹¬å»¶é•¿TTLæˆ–æ°¸ä¸è¿‡æœŸï¼Œæ‰‹åŠ¨åˆ·æ–°ã€‚<br/>
<strong>ç»éªŒ</strong>ï¼šéšæœºåŒ–ç®€å•æœ‰æ•ˆï¼Œçƒ­ç‚¹éš”ç¦»æ›´é€‚åˆæ ¸å¿ƒæ•°æ®ã€‚</li>
</ol>
<h6 data-id="heading-24">çƒ­ç‚¹Keyé—®é¢˜</h6>
<p><strong>é—®é¢˜</strong>ï¼šå•ä¸ªKeyï¼ˆå¦‚æ´»åŠ¨é¡µæ•°æ®ï¼‰QPSè¿‡é«˜ï¼ŒRediså•èŠ‚ç‚¹å‹åŠ›çˆ†æ£šã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šæŸç”µå•†æ´»åŠ¨é¡µKeyæ¯ç§’10ä¸‡æ¬¡è¯·æ±‚ï¼ŒRedisé›†ç¾¤å“åº”å˜æ…¢ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>åˆ†ç‰‡å­˜å‚¨</strong>ï¼šå°†æ•°æ®æ‹†æˆå¤šä¸ªKeyï¼ˆå¦‚<code>activity:1:part1</code>ã€<code>part2</code>ï¼‰ï¼Œåˆ†æ•£å‹åŠ›ã€‚</li>
<li><strong>æœ¬åœ°ç¼“å­˜</strong>ï¼šå‰ç«¯æˆ–åº”ç”¨å±‚ç”¨Guava Cacheåˆ†æ‹…æµé‡ã€‚æˆ‘ä»¬åœ¨Nginxå±‚åŠ äº†æœ¬åœ°ç¼“å­˜ï¼ŒRediså‹åŠ›é™åˆ°20%ã€‚
<pre><code class="hljs language-java" lang="java">Cache&lt;String, String&gt; localCache = CacheBuilder.newBuilder()
    .expireAfterWrite(<span class="hljs-number">10</span>, TimeUnit.SECONDS).build();
String <span class="hljs-title function_">getActivityData</span><span class="hljs-params">(String key)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> localCache.getIfPresent(key);
    <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
        data = redis.get(key);
        localCache.put(key, data);
    }
    <span class="hljs-keyword">return</span> data;
}
</code></pre>
</li>
</ol>
<p><strong>ç»éªŒ</strong>ï¼šåˆ†ç‰‡é€‚åˆRediså±‚ä¼˜åŒ–ï¼Œæœ¬åœ°ç¼“å­˜æ›´çµæ´»ä½†éœ€æ³¨æ„å†…å­˜ã€‚</p>
<p><strong>è¸©å‘é—®é¢˜å¯¹æ¯”è¡¨ï¼š</strong></p>





























<table><thead><tr><th>é—®é¢˜</th><th>è¡¨ç°</th><th>è§£å†³æ–¹æ³•</th><th>å®æ–½éš¾åº¦</th></tr></thead><tbody><tr><td>ç¼“å­˜ç©¿é€</td><td>æ•°æ®åº“å‹åŠ›å¤§</td><td>å¸ƒéš†è¿‡æ»¤å™¨/ç©ºå€¼ç¼“å­˜</td><td>ä¸­</td></tr><tr><td>ç¼“å­˜é›ªå´©</td><td>æ•°æ®åº“ç¬æ—¶è¿‡è½½</td><td>TTLéšæœºåŒ–/çƒ­ç‚¹éš”ç¦»</td><td>ä½</td></tr><tr><td>çƒ­ç‚¹Key</td><td>Rediså“åº”æ…¢</td><td>åˆ†ç‰‡/æœ¬åœ°ç¼“å­˜</td><td>é«˜</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-25">å…­ã€æ€»ç»“ä¸å±•æœ›</h4>
<p>Redisä¸MySQLçš„åä½œå°±åƒä¸€åœºç²¾å½©çš„â€œåŒäººèˆâ€ï¼Œä»ç¼“å­˜ç­–ç•¥åˆ°ä¸€è‡´æ€§ä¿éšœï¼Œå†åˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œæ¯ä¸€æ­¥éƒ½è€ƒéªŒç€å¼€å‘è€…çš„æ™ºæ…§å’Œç»éªŒã€‚èµ°å®Œè¿™æ®µæ—…ç¨‹ï¼Œæˆ‘ä»¬ä¸ä»…çœ‹åˆ°äº†ä¸¤è€…çš„é»˜å¥‘é…åˆï¼Œä¹Ÿæ”¶è·äº†å®æˆ˜ä¸­çš„å®è´µæ•™è®­ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†æ€»ç»“æ ¸å¿ƒè¦ç‚¹ï¼Œåˆ†äº«å®è·µå»ºè®®ï¼Œå¹¶å±•æœ›æœªæ¥çš„æŠ€æœ¯è¶‹åŠ¿ï¼Œå¸Œæœ›ä¸ºä½ ç‚¹äº®å‰è¡Œçš„è·¯ã€‚</p>
<h5 data-id="heading-26">1. æ€»ç»“</h5>
<p>Redisä¸MySQLåŒå‰‘åˆç’§çš„æ ¸å¿ƒåœ¨äºä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>åˆç†é€‰æ‹©ç¼“å­˜ç­–ç•¥</strong>ï¼šCache-Asideé€‚åˆè¯»å¤šå†™å°‘ï¼ŒWrite-Throughä¿éšœå¼ºä¸€è‡´æ€§ï¼ŒWrite-Behindåº”å¯¹é«˜å¹¶å‘å†™ã€‚ç­–ç•¥æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œå…³é”®æ˜¯åŒ¹é…ä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li><strong>ä¿éšœæ•°æ®ä¸€è‡´æ€§</strong>ï¼šå»¶è¿ŸåŒåˆ ã€åˆ†å¸ƒå¼é”å’Œæ¶ˆæ¯é˜Ÿåˆ—å„æœ‰åƒç§‹ï¼Œé…åˆå®šæœŸéªŒè¯ï¼Œèƒ½è®©ç³»ç»Ÿæ—¢å¿«åˆç¨³ã€‚</li>
</ul>
<p>æˆ‘çš„æ ¸å¿ƒç»éªŒæ˜¯ï¼šä¸€åˆ‡ä»ä¸šåŠ¡å‡ºå‘ã€‚é«˜å¹¶å‘ç”µå•†éœ€è¦æ€§èƒ½ä¼˜å…ˆï¼Œé‡‘èç³»ç»Ÿå¼ºè°ƒä¸€è‡´æ€§ï¼Œæ—¥å¿—æœåŠ¡è¿½æ±‚ååé‡ã€‚æŠ€æœ¯æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ï¼Œè„±ç¦»éœ€æ±‚çš„ä¼˜åŒ–éƒ½æ˜¯â€œç©ºä¸­æ¥¼é˜â€ã€‚æ¯”å¦‚åœ¨ç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Cache-AsideåŠ å»¶è¿ŸåŒåˆ ï¼ŒQPSæå‡10å€çš„åŒæ—¶ä¿è¯äº†åº“å­˜å‡†ç¡®ï¼›åœ¨å®æ—¶ç›‘æ§ä¸­ï¼ŒWrite-Throughè®©æ•°æ®é›¶å»¶è¿Ÿï¼Œæ»¡è¶³äº†å®¢æˆ·éœ€æ±‚ã€‚è¿™äº›æˆåŠŸéƒ½æºäºå¯¹ä¸šåŠ¡çš„æ·±åˆ»ç†è§£ã€‚</p>
<p><strong>å®è·µå»ºè®®</strong>ï¼š</p>
<ol>
<li><strong>ä»å°å¤„ç€æ‰‹</strong>ï¼šå…ˆç”¨Cache-Asideè¯•æ°´ï¼Œç®€å•æ˜“ä¸Šæ‰‹ï¼Œå†æ ¹æ®éœ€æ±‚è°ƒæ•´ã€‚</li>
<li><strong>å…³æ³¨å¼‚å¸¸</strong>ï¼šä¸ºæ¯ç§ç­–ç•¥è®¾è®¡å…œåº•æ–¹æ¡ˆï¼ˆå¦‚é‡è¯•ã€æ—¥å¿—è¡¥å¿ï¼‰ã€‚</li>
<li><strong>ç›‘æ§å…ˆè¡Œ</strong>ï¼šéƒ¨ç½²Rediså’ŒMySQLçš„ç›‘æ§ï¼Œå®æ—¶æŒæ¡å‘½ä¸­ç‡ã€å»¶è¿Ÿå’Œä¸€è‡´æ€§é—®é¢˜ã€‚</li>
<li><strong>è¿­ä»£ä¼˜åŒ–</strong>ï¼šæ€§èƒ½å’Œä¸€è‡´æ€§æ˜¯ä¸ªåŠ¨æ€å¹³è¡¡ï¼Œå®šæœŸå¤ç›˜è°ƒæ•´ã€‚</li>
</ol>
<h5 data-id="heading-27">2. å±•æœ›</h5>
<p>Redisä¸MySQLçš„åä½œä»åœ¨è¿›åŒ–ã€‚Redis 7.0å¢å¼ºäº†é›†ç¾¤åŠŸèƒ½ï¼Œæ”¯æŒå¤šçº¿ç¨‹I/Oå’Œæ›´çµæ´»çš„æ•°æ®ç»“æ„ï¼Œæœªæ¥å¯èƒ½åœ¨ä¸€è‡´æ€§åœºæ™¯ä¸­æ‰®æ¼”æ›´é‡è¦è§’è‰²ã€‚MySQL 8.0åˆ™ä¼˜åŒ–äº†JSONæ”¯æŒå’Œé«˜å¯ç”¨æ€§ï¼Œä¸Redisçš„é…åˆå°†æ›´ç´§å¯†ã€‚æ¯”å¦‚ï¼ŒRedisçš„Streamæ•°æ®ç»“æ„å¯ä»¥ä¸MySQLçš„binlogé›†æˆï¼Œå®ç°æ›´é«˜æ•ˆçš„å¼‚æ­¥åŒæ­¥ã€‚</p>
<p>æœªæ¥è¶‹åŠ¿å¯èƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½åŒ–ç¼“å­˜</strong>ï¼šAIé©±åŠ¨çš„ç¼“å­˜é¢„çƒ­å’Œæ·˜æ±°ç­–ç•¥ï¼Œè®©Redisæ›´â€œèªæ˜â€ã€‚</li>
<li><strong>äº‘åŸç”Ÿèåˆ</strong>ï¼šServerlessæ¶æ„ä¸‹ï¼ŒRediså’ŒMySQLå¯èƒ½ä»¥æ‰˜ç®¡æœåŠ¡å½¢å¼æ— ç¼é›†æˆã€‚</li>
<li><strong>ä¸€è‡´æ€§æ–°è§£æ³•</strong>ï¼šåˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚TiDB+Redisçš„ç»“åˆï¼‰æˆ–å°†ç®€åŒ–å¼ºä¸€è‡´æ€§å®ç°ã€‚</li>
</ul>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘é¼“åŠ±ä½ å¤šå®è·µã€å¤šåˆ†äº«ã€‚Redisä¸MySQLçš„ç»„åˆçœ‹ä¼¼ç®€å•ï¼Œå®åˆ™è•´è—æ— é™å¯èƒ½ã€‚æ¯æ¬¡è¸©å‘å’Œä¼˜åŒ–ï¼Œéƒ½æ˜¯æˆé•¿çš„å¥‘æœºã€‚æˆ‘çš„10å¹´ç»éªŒå‘Šè¯‰æˆ‘ï¼ŒæŠ€æœ¯æ²¡æœ‰ç»ˆç‚¹ï¼Œåªæœ‰ä¸æ–­æ¢ç´¢çš„ä¹è¶£ã€‚</p>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼š<br/>
æˆ‘æœ€å–œæ¬¢Redisçš„è½»å¿«å’ŒMySQLçš„ç¨³é‡ï¼Œå®ƒä»¬å°±åƒæˆ‘çš„å·¦å³æ‰‹ï¼Œç¼ºä¸€ä¸å¯ã€‚æ¯æ¬¡è§£å†³ä¸€ä¸ªä¸€è‡´æ€§éš¾é¢˜æˆ–ä¼˜åŒ–ä¸€æ¬¡æ€§èƒ½ç“¶é¢ˆï¼Œéƒ½è®©æˆ‘å¯¹è¿™å¯¹â€œé»„é‡‘æ­æ¡£â€æ›´æœ‰ä¿¡å¿ƒã€‚å¸Œæœ›ä½ ä¹Ÿèƒ½åœ¨å®è·µä¸­æ‰¾åˆ°å±äºè‡ªå·±çš„èŠ‚å¥ã€‚</p>
<hr/>
<p><strong>æ–‡ç« å°¾å£°ï¼š</strong><br/>
è‡³æ­¤ï¼Œæˆ‘ä»¬ä»Redisä¸MySQLçš„ä¼˜åŠ¿è®²åˆ°ç¼“å­˜ç­–ç•¥ï¼Œå†åˆ°ä¸€è‡´æ€§å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œèµ°äº†ä¸€æ¡å®Œæ•´çš„å®æˆ˜ä¹‹è·¯ã€‚å¸¦ç€è¿™äº›ç»éªŒå’Œå»ºè®®ï¼Œå»è¯•è¯•å§ï¼æœ‰ä»€ä¹ˆå¿ƒå¾—æˆ–é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶äº¤æµï¼Œæ¯•ç«ŸæŠ€æœ¯çš„é­…åŠ›å°±åœ¨äºåˆ†äº«ä¸æˆé•¿ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7585397173022736403</link>    <guid>https://juejin.cn/post/7585397173022736403</guid>    <pubDate>2025-12-19T23:46:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585397173022736403" data-draft-id="7585382553289916452" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-12-19T23:46:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T23:46:30.000Z" title="Fri Dec 19 2025 23:46:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–</h2>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented Programming, OOPï¼‰ä¸åªæ˜¯â€œå¦‚ä½•å†™ classâ€çš„è¯­æ³•è§„åˆ™ã€‚å®ƒæ›´åƒä¸€ç§ç»„ç»‡è½¯ä»¶ç³»ç»Ÿçš„æ€ç»´æ–¹å¼ï¼šé€šè¿‡æ¸…æ™°çš„è¾¹ç•Œã€èŒè´£æ‹†åˆ†ä¸å¯¹è±¡åä½œï¼Œè®©ç³»ç»Ÿæ›´å®¹æ˜“ç†è§£ã€æ‰©å±•å’Œç»´æŠ¤ã€‚</p>
<p>å½“ä½ å·²ç»æŒæ¡äº†ç±»ã€å¯¹è±¡ã€å±æ€§ã€æ–¹æ³•è¿™äº›åŸºç¡€æ¦‚å¿µä¹‹åï¼Œå°±å¯ä»¥æŠŠè§†è§’å¾€æ›´æ·±ä¸€å±‚æŒªä¸€æŒªï¼šè®¾è®¡æ¨¡å¼ã€SOLID åŸåˆ™ï¼Œä»¥åŠåœ¨å¤§å‹ç³»ç»Ÿé‡Œç»•ä¸å¼€çš„æ€§èƒ½ä¸å†…å­˜é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡ä¼šå›´ç»•å‡ ä¸ªå¸¸è§ä¸»é¢˜å±•å¼€ï¼šç­–ç•¥æ¨¡å¼ä¸å•ä¾‹æ¨¡å¼ã€SOLID äº”åŸåˆ™ï¼Œä»¥åŠä¸å¯å˜å¯¹è±¡ä¸å†…å­˜ç®¡ç†ç›¸å…³çš„æ€§èƒ½è€ƒè™‘ã€‚å®ƒä»¬çš„ç›®çš„ä¸æ˜¯â€œç‚«æŠ€â€ï¼Œè€Œæ˜¯è®©çœŸå®é¡¹ç›®åœ¨åç»­è¿­ä»£ä¸­æ›´ç¨³ã€æ›´å¥½æ”¹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-12%2Fadvanced-object-oriented-programming-design-patterns-solid-performance" target="_blank" title="https://catchadmin.com/post/2025-12/advanced-object-oriented-programming-design-patterns-solid-performance" ref="nofollow noopener noreferrer">åŸæ–‡é“¾æ¥ PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–</a></p>
<h3 data-id="heading-1">é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„è®¾è®¡æ¨¡å¼</h3>
<p>è®¾è®¡æ¨¡å¼æ˜¯å¯¹è½¯ä»¶è®¾è®¡ä¸­å¸¸è§é—®é¢˜çš„å¯å¤ç”¨è§£å†³æ–¹æ¡ˆã€‚å®ƒä»¬ä¸æ˜¯ä»£ç æ¨¡æ¿ï¼Œè€Œæ˜¯å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹è°ƒæ•´å’Œè½åœ°çš„ä¸€ç»„è®¾è®¡æ€è·¯ã€‚</p>
<h4 data-id="heading-2">ç­–ç•¥æ¨¡å¼ï¼šå°†ç®—æ³•ä¸ç±»è§£è€¦</h4>
<p>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰å¯ä»¥æŠŠä¸€ç»„å¯äº’æ¢çš„ç®—æ³•æŠ½å‡ºæ¥ï¼Œç”¨ç»Ÿä¸€çš„æ¥å£å¯¹å¤–æš´éœ²ï¼Œè®©ä½¿ç”¨æ–¹åœ¨è¿è¡Œæ—¶è‡ªç”±é€‰æ‹©å®ç°ï¼Œè€Œä¸éœ€è¦æŠŠå…·ä½“ç®—æ³•ç¡¬ç¼–ç è¿›ä¸šåŠ¡ç±»ã€‚</p>
<p>å½“ä½ å¸Œæœ›â€œæ ¹æ®æ¡ä»¶åˆ‡æ¢ç®—æ³•â€ï¼Œåˆä¸å¸Œæœ›è®©ä¸€ä¸ªç±»è†¨èƒ€åˆ°å¡æ»¡ <code>if/else</code> æ—¶ï¼Œç­–ç•¥æ¨¡å¼é€šå¸¸å¾ˆå¥½ç”¨ã€‚</p>
<p>ä»¥ç”µå•†æŠ˜æ‰£ä¸ºä¾‹ï¼šå¯èƒ½æœ‰â€œæ‰“æŠ˜â€â€œä¹°ä¸€é€ä¸€â€ç­‰ä¸åŒæŠ˜æ‰£ç­–ç•¥ã€‚å¦‚æœæŠŠæ‰€æœ‰æŠ˜æ‰£è§„åˆ™éƒ½å †åœ¨ <code>Cart</code> é‡Œï¼Œ<code>Cart</code> ä¼šè¶Šæ¥è¶Šéš¾ç»´æŠ¤ã€‚ç”¨ç­–ç•¥æ¨¡å¼åˆ™å¯ä»¥æŠŠæŠ˜æ‰£è®¡ç®—æ‹†åˆ°ä¸åŒç­–ç•¥ç±»é‡Œã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PercentDiscount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$percent</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$total</span> * (<span class="hljs-number">1</span> - <span class="hljs-variable language_">$this</span>-&gt;percent);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuyOneGetOneFree</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-comment">// ç®€å•æ¨¡æ‹Ÿï¼šä¹°ä¸€é€ä¸€å³æ€»ä»·å‡åŠ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$total</span> / <span class="hljs-number">2</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cart</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$items</span> = [];

    <span class="hljs-comment">// ä¾èµ–æ³¨å…¥ï¼šæ³¨å…¥ç­–ç•¥æ¥å£è€Œéå…·ä½“å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> DiscountStrategy <span class="hljs-variable">$strategy</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addItem</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$price</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;items[] = <span class="hljs-variable">$price</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">total</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-variable">$subtotal</span> = <span class="hljs-title function_ invoke__">array_sum</span>(<span class="hljs-variable">$this</span>-&gt;items);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;strategy-&gt;<span class="hljs-title function_ invoke__">apply</span>(<span class="hljs-variable">$subtotal</span>);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable">$cart</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cart</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PercentDiscount</span>(<span class="hljs-number">0.1</span>)); <span class="hljs-comment">// æ‰“ä¹æŠ˜</span>
<span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">addItem</span>(<span class="hljs-number">100</span>);
<span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">addItem</span>(<span class="hljs-number">200</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">total</span>(); <span class="hljs-comment">// è¾“å‡º: 270</span>
</code></pre>
<p>è¿™é‡Œ <code>Cart</code> ä¸éœ€è¦çŸ¥é“â€œæŠ˜æ‰£æ€ä¹ˆç®—â€ï¼Œå®ƒåªä¾èµ–ä¸€ä¸ªæŠ½è±¡çš„ <code>DiscountStrategy</code>ã€‚æƒ³æ›´æ¢æŠ˜æ‰£è§„åˆ™ï¼Œåªè¦ä¼ å…¥ä¸åŒçš„ç­–ç•¥å®ç°å³å¯ï¼Œæ— éœ€ä¿®æ”¹ <code>Cart</code>ã€‚</p>
<h4 data-id="heading-3">å•ä¾‹æ¨¡å¼ï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹</h4>
<p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ç”¨äºä¿è¯æŸä¸ªç±»åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚</p>
<p>å®ƒå¸¸ç”¨äºç®¡ç†å…±äº«èµ„æºï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ã€é…ç½®å¯¹è±¡ç­‰ï¼šè¿™ç±»å¯¹è±¡é€šå¸¸ä¸å¸Œæœ›è¢«é¢‘ç¹åˆ›å»ºï¼Œä¹Ÿä¸å¸Œæœ›å‡ºç°å¤šä¸ªå®ä¾‹å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseConnection</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> ?DatabaseConnection <span class="hljs-variable">$instance</span> = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// ç§æœ‰åŒ–æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨ new</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"/>) </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"è¿æ¥åˆ°æ•°æ®åº“...\n"</span>;
    }

    <span class="hljs-comment">// é˜²æ­¢å…‹éš†</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"/>) </span>{}

    <span class="hljs-comment">// é˜²æ­¢ååºåˆ—åŒ–</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"/>) </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Exception</span>(<span class="hljs-string">"Cannot unserialize singleton"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInstance</span>(<span class="hljs-params"/>): <span class="hljs-title">DatabaseConnection</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span> === <span class="hljs-literal">null</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable">$db1</span> = <span class="hljs-title class_">DatabaseConnection</span>::<span class="hljs-title function_ invoke__">getInstance</span>();
<span class="hljs-variable">$db2</span> = <span class="hljs-title class_">DatabaseConnection</span>::<span class="hljs-title function_ invoke__">getInstance</span>();

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$db1</span> === <span class="hljs-variable">$db2</span>); <span class="hljs-comment">// è¾“å‡º: bool(true)</span>
</code></pre>
<p>ä¸Šé¢ <code>DatabaseConnection</code> é€šè¿‡é‡å†™ <code>__new__</code> æ¥ç¡®ä¿æ— è®ºå®ä¾‹åŒ–å¤šå°‘æ¬¡ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>
<h3 data-id="heading-4">SOLID åŸåˆ™</h3>
<p>SOLID æ˜¯ä¸€ç»„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼Œç›®æ ‡æ˜¯è®©ç³»ç»Ÿæ›´æ˜“ç»´æŠ¤ã€å¯æ‰©å±•ã€å¯æµ‹è¯•ã€‚æŠŠè¿™äº›åŸåˆ™è½åˆ°æ—¥å¸¸ç¼–ç é‡Œï¼Œèƒ½å‡å°‘å¾ˆå¤šå¸¸è§çš„â€œé¢å‘å¯¹è±¡å†™ç€å†™ç€å°±å˜æˆä¸€å›¢â€çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-5">å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</h4>
<p>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰å¼ºè°ƒï¼šä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªç±»æœ€å¥½åªè´Ÿè´£ä¸€ä»¶äº‹ã€‚</p>
<p>ä¾‹å¦‚ <code>User</code> æ—¢ä¿å­˜ç”¨æˆ·æ•°æ®åˆè´Ÿè´£å‘é€é€šçŸ¥ï¼Œä¼šåŒæ—¶æ‰¿æ‹…â€œæ•°æ®æ¨¡å‹â€å’Œâ€œé€šçŸ¥é€»è¾‘â€ä¸¤ç§èŒè´£ã€‚å¯ä»¥æŒ‰ SRP æ‹†åˆ†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span></span>) </span>{}
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserNotification</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendWelcomeEmail</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"æ­£åœ¨å‘ <span class="hljs-subst">{$user-&gt;name}</span> å‘é€æ¬¢è¿é‚®ä»¶ã€‚\n"</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);
<span class="hljs-variable">$notifier</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserNotification</span>();
<span class="hljs-variable">$notifier</span>-&gt;<span class="hljs-title function_ invoke__">sendWelcomeEmail</span>(<span class="hljs-variable">$user</span>);
</code></pre>
<p>æ‹†åˆ†ä¹‹åï¼Œæ¯ä¸ªç±»çš„èŒè´£æ›´é›†ä¸­ï¼Œæµ‹è¯•ä¸ä¿®æ”¹ä¹Ÿæ›´å¯æ§ã€‚</p>
<h4 data-id="heading-6">å¼€æ”¾/å°é—­åŸåˆ™ï¼ˆOCPï¼‰</h4>
<p>å¼€æ”¾/å°é—­åŸåˆ™ï¼ˆOpen/Closed Principleï¼‰è¦æ±‚ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚ä¹Ÿå°±æ˜¯åœ¨ä¸æ”¹åŠ¨æ—¢æœ‰ä»£ç çš„å‰æä¸‹ï¼Œèƒ½å¤Ÿé€šè¿‡æ‰©å±•æ¥å¼•å…¥æ–°è¡Œä¸ºã€‚</p>
<p>ä¸‹é¢ç”¨å½¢çŠ¶é¢ç§¯ç¤ºä¾‹è¯´æ˜ï¼š<code>Shape</code> å®šä¹‰æ¥å£ï¼Œä¸åŒå½¢çŠ¶é€šè¿‡ç»§æ‰¿å®ç° <code>area()</code>ï¼Œè°ƒç”¨æ–¹ä¸éœ€è¦çŸ¥é“å…·ä½“ç±»å‹ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$radius</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">pi</span>() * <span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-variable">$this</span>-&gt;radius, <span class="hljs-number">2</span>);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$width</span>, <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$height</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;width * <span class="hljs-variable language_">$this</span>-&gt;height;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printArea</span>(<span class="hljs-params">Shape <span class="hljs-variable">$shape</span></span>) </span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"é¢ç§¯: "</span> . <span class="hljs-variable">$shape</span>-&gt;<span class="hljs-title function_ invoke__">area</span>() . <span class="hljs-string">"\n"</span>;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_ invoke__">printArea</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5</span>));
<span class="hljs-title function_ invoke__">printArea</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>));
</code></pre>
<p>å½“ä½ è¦æ–°å¢ä¸€ç§å½¢çŠ¶æ—¶ï¼Œåªéœ€è¦æ·»åŠ æ–°å­ç±»å³å¯ï¼Œä¸å¿…æ”¹åŠ¨ <code>print_area</code> æˆ–æ—¢æœ‰å½¢çŠ¶ä»£ç ã€‚</p>
<h4 data-id="heading-7">é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼‰</h4>
<p>é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰æŒ‡å‡ºï¼šåŸºç±»èƒ½å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¹Ÿåº”è¯¥èƒ½æ›¿æ¢è¿›å»ï¼Œå¹¶ä¸”ä¸å½±å“ç¨‹åºæ­£ç¡®æ€§ã€‚å®ƒè¦æ±‚å­ç±»æ˜¯å¯¹çˆ¶ç±»èƒ½åŠ›çš„â€œçœŸå®æ‰©å±•â€ï¼Œè€Œä¸æ˜¯â€œè¡¨é¢ç»§æ‰¿â€ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>Penguin</code> ç»§æ‰¿ <code>Bird</code> ä½†æ— æ³•é£è¡Œï¼Œå¯¼è‡´æ›¿æ¢å¤±è´¥ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bird</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fly</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"æ­£åœ¨é£è¡Œ...\n"</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Penguin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Bird</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fly</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-comment">// ä¼é¹…ä¸ä¼šé£ï¼Œè¿åäº†çˆ¶ç±» Bird çš„è¡Œä¸ºé¢„æœŸ</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"ä¼é¹…ä¸ä¼šé£ï¼"</span>);
    }
}

<span class="hljs-comment">/** * ä¿®æ­£æ–¹æ¡ˆï¼šæ‹†åˆ†æ¥å£
 * interface Bird {}
 * interface FlyingBird extends Bird { public function fly(); }
 * class Penguin implements Bird { ... }
 */</span>
</code></pre>
<p>è¿™ä¸ªè®¾è®¡è¿åäº† LSPï¼š<code>Penguin</code> æ— æ³•åœ¨éœ€è¦ <code>Bird.fly()</code> çš„ä¸Šä¸‹æ–‡ä¸­æ­£å¸¸å·¥ä½œã€‚è¦è§£å†³å®ƒï¼Œé€šå¸¸éœ€è¦é‡æ–°å®¡è§†æŠ½è±¡ï¼ˆä¾‹å¦‚æŠŠâ€œä¼šé£â€èƒ½åŠ›ä» <code>Bird</code> ä¸­æ‹†å‡ºæ¥ï¼Œæˆ–è€…è°ƒæ•´ç»§æ‰¿å±‚æ¬¡ï¼‰ã€‚</p>
<h4 data-id="heading-8">æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰</h4>
<p>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰å¼ºè°ƒï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–è‡ªå·±ç”¨ä¸åˆ°çš„æ–¹æ³•ã€‚ä¸å…¶åšä¸€ä¸ªâ€œå¾ˆå¤§å¾ˆå…¨â€çš„æ¥å£ï¼Œä¸å¦‚æ‹†æˆå¤šä¸ªå°è€Œèšç„¦çš„æ¥å£ï¼Œè®©ä½¿ç”¨æ–¹æŒ‰éœ€ç»„åˆã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Workable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Eatable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eat</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HumanWorker</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Workable</span>, <span class="hljs-title">Eatable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"äººç±»åœ¨å·¥ä½œ\n"</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eat</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"äººç±»åœ¨åƒé¥­\n"</span>; }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RobotWorker</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Workable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"æœºå™¨äººåœ¨å·¥ä½œ\n"</span>; }
    <span class="hljs-comment">// æœºå™¨äººä¸éœ€è¦å®ç° eat() æ¥å£</span>
}
</code></pre>
<p>è¿™é‡Œ <code>Worker</code> ä¸ <code>Eater</code> æ‹†æˆä¸¤ä¸ªæ¥å£ï¼Œé¿å…äº†è®©æ‰€æœ‰å®ç°è€…éƒ½èƒŒä¸Šä¸éœ€è¦çš„èŒè´£ã€‚</p>
<h4 data-id="heading-9">ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰</h4>
<p>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ä¸»å¼ ï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ï¼ˆæ¥å£/æŠ½è±¡ç±»ï¼‰ã€‚è¿™æ ·å¯ä»¥é™ä½è€¦åˆï¼Œè®©æ›¿æ¢å®ç°æ›´å®¹æ˜“ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Switchable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOn</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOff</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LightBulb</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Switchable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOn</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"ç¯äº®äº†\n"</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOff</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"ç¯ç­äº†\n"</span>; }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Switcher</span> </span>{
    <span class="hljs-comment">// ä¾èµ–äºæ¥å£ï¼Œè€Œä¸æ˜¯å…·ä½“çš„ LightBulb ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> Switchable <span class="hljs-variable">$device</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">operate</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;device-&gt;<span class="hljs-title function_ invoke__">turnOn</span>();
    }
}

<span class="hljs-variable">$bulb</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightBulb</span>();
<span class="hljs-variable">$switch</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Switcher</span>(<span class="hljs-variable">$bulb</span>);
<span class="hljs-variable">$switch</span>-&gt;<span class="hljs-title function_ invoke__">operate</span>();
</code></pre>
<p>è¿™é‡Œ <code>Switch</code> ç›´æ¥ä¾èµ– <code>LightBulb</code>ã€‚å¦‚æœæŠŠä¾èµ–æ”¹ä¸ºæŠ½è±¡æ¥å£ï¼ˆæ¯”å¦‚ <code>Switchable</code>ï¼‰ï¼Œ<code>Switch</code> å°±èƒ½æ”¯æŒæ›´å¤šè®¾å¤‡å®ç°ï¼Œè€Œä¸éœ€è¦æ”¹åŠ¨è‡ªèº«ä»£ç ã€‚</p>
<h3 data-id="heading-10">é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜è€ƒé‡</h3>
<p>OOP é€šå¸¸æ›´å¼ºè°ƒæ¸…æ™°ä¸å¯ç»´æŠ¤ï¼Œä½†åœ¨å¤§å‹ç³»ç»Ÿé‡Œï¼Œæ€§èƒ½ä¸å†…å­˜å¼€é”€åŒæ ·éœ€è¦è¢«è€ƒè™‘ã€‚ç†è§£å¯¹è±¡åˆ›å»ºã€å†…å­˜åˆ†é…ä»¥åŠä¸å¯å˜æ€§å¸¦æ¥çš„å½±å“ï¼Œæœ‰åŠ©äºåœ¨â€œå¯è¯»æ€§â€å’Œâ€œæ•ˆç‡â€ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ã€‚</p>
<h4 data-id="heading-11">ä¸ºå€¼å¯¹è±¡å¼•å…¥ä¸å¯å˜æ€§</h4>
<p>PHP 8.2 å¼•å…¥äº† readonly classï¼Œè¿™éå¸¸é€‚åˆå®ç°ä¸å¯å˜çš„å€¼å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡åœ¨å¤„ç†å€¼ç±»å‹ï¼ˆValue Objectï¼‰æ—¶å¾ˆå¸¸è§ï¼Œä¾‹å¦‚ <code>Money</code>ã€<code>DateRange</code>ã€<code>Coordinate</code>ã€‚æŠŠå¯¹è±¡è®¾è®¡æˆä¸å¯å˜ï¼Œå¯ä»¥å‡å°‘å…±äº«çŠ¶æ€å¸¦æ¥çš„å‰¯ä½œç”¨ï¼Œä¹Ÿæ›´åˆ©äºæ¨ç†ä¸å¹¶å‘åœºæ™¯ä¸‹çš„å®‰å…¨æ€§ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Money</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$currency</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$amount</span>
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">Money <span class="hljs-variable">$other</span></span>): <span class="hljs-title">Money</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;currency !== <span class="hljs-variable">$other</span>-&gt;currency) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"å¸ç§ä¸åŒ¹é…"</span>);
        }
        <span class="hljs-comment">// è¿”å›æ–°å®ä¾‹ï¼Œè€Œä¸æ˜¯ä¿®æ”¹å½“å‰å¯¹è±¡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-variable language_">$this</span>-&gt;currency, <span class="hljs-variable language_">$this</span>-&gt;amount + <span class="hljs-variable">$other</span>-&gt;amount);
    }
}

<span class="hljs-variable">$m1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-string">"CNY"</span>, <span class="hljs-number">100</span>);
<span class="hljs-variable">$m2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-string">"CNY"</span>, <span class="hljs-number">50</span>);
<span class="hljs-variable">$result</span> = <span class="hljs-variable">$m1</span>-&gt;<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-variable">$m2</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>-&gt;amount; <span class="hljs-comment">// 150</span>
<span class="hljs-comment">// $m1-&gt;amount = 200; // ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ˜¯ readonly</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>Money</code> æ˜¯ä¸å¯å˜çš„ï¼šæ¯æ¬¡è¿ç®—éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°å®ä¾‹ï¼ŒåŸå¯¹è±¡ä¿æŒä¸å˜ã€‚</p>
<h4 data-id="heading-12">é¿å…å¯¹è±¡æŠ–åŠ¨ï¼ˆObject Churnï¼‰</h4>
<p>åœ¨ç´§å¯†å¾ªç¯é‡Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜ï¼šæ›´å¤šçš„å†…å­˜åˆ†é…ã€æ›´é«˜çš„åƒåœ¾å›æ”¶ï¼ˆGCï¼‰å‹åŠ›ã€‚</p>
<p>é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘å¯¹è±¡æ± ï¼ˆobject poolï¼‰æˆ–å¤ç”¨å¯¹è±¡ï¼Œå‡å°‘ä¸å¿…è¦çš„åˆ›å»ºä¸å›æ”¶å¼€é”€ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“ï¼šæŠŠåŸåˆ™ä¸æ¨¡å¼è½åˆ°ä»£ç é‡Œ</h3>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹æä¾›äº†ä¸€å¥—ç»„ç»‡å¤æ‚ç³»ç»Ÿçš„å·¥å…·ã€‚è®¾è®¡æ¨¡å¼ï¼ˆä¾‹å¦‚ Strategyã€Singletonï¼‰å¸®åŠ©ä½ å¤ç”¨æˆç†Ÿçš„ç»“æ„ï¼›SOLID åŸåˆ™æé†’ä½ å¦‚ä½•åˆ’åˆ†èŒè´£ã€æ§åˆ¶ä¾èµ–ï¼›è€Œä¸å¯å˜å¯¹è±¡ã€å¯¹è±¡åˆ›å»ºæˆæœ¬ç­‰æ€§èƒ½è§†è§’åˆ™è®©ç³»ç»Ÿåœ¨è§„æ¨¡åŒ–åœºæ™¯ä¸‹æ›´ç¨³ã€‚</p>
<p>OOP çš„é‡ç‚¹ä¸åœ¨â€œæœ‰å¤šå°‘ç±»â€ï¼Œè€Œåœ¨æŠ½è±¡æ˜¯å¦æ¸…æ™°ã€è¾¹ç•Œæ˜¯å¦æ˜ç¡®ã€å®ç°æ˜¯å¦å¯æ›¿æ¢ã€å˜åŒ–æ˜¯å¦è¢«é™åˆ¶åœ¨å¯æ§çš„èŒƒå›´å†…ã€‚æŠŠè¿™äº›è¦ç‚¹åšæŒä¸‹æ¥ï¼Œä»£ç é€šå¸¸ä¼šæ›´å¥½è¯»ï¼Œä¹Ÿæ›´å¥½ç»´æŠ¤ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7585706951604355098</link>    <guid>https://juejin.cn/post/7585706951604355098</guid>    <pubDate>2025-12-21T09:16:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585706951604355098" data-draft-id="7585743487258378249" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-21T09:16:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾é†’"/> <meta itemprop="url" content="https://juejin.cn/user/708512558088669"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/708512558088669/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾é†’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:16:50.000Z" title="Sun Dec 21 2025 09:16:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ChatGPTï¼‰çš„â€œæ™ºèƒ½â€å¹¶éä¸€è¹´è€Œå°±ï¼Œè€Œæ˜¯é€šè¿‡åˆ†é˜¶æ®µçš„ç²¾ç»†åŒ–è®­ç»ƒé€æ­¥å®ç°çš„ã€‚æœ¬æ–‡åŸºäºè¯¾ç¨‹å†…å®¹ï¼Œæ‹†è§£ChatGPTçš„å››é˜¶æ®µæ„å»ºæµç¨‹ï¼Œè§£ææ¯ä¸ªç¯èŠ‚çš„æ ¸å¿ƒé€»è¾‘ä¸æŠ€æœ¯ç»†èŠ‚ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41444af6d95f4f2fbe829b203ee1cc06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YaS:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766913410&amp;x-signature=rZn%2B0TUmRXfzfopgGz0enDYPDWo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">ä¸€ã€é˜¶æ®µä¸€ï¼šè‡ªç›‘ç£é¢„è®­ç»ƒâ€”â€”ç»™æ¨¡å‹â€œæ‰“çŸ¥è¯†åº•å­â€</h2>
<p>è¿™æ˜¯å¤§æ¨¡å‹çš„<strong>åŸºç¡€èƒ½åŠ›å¥ åŸºé˜¶æ®µ</strong>ï¼Œæ ¸å¿ƒæ˜¯è®©æ¨¡å‹å­¦ä¹ è¯­è¨€è§„å¾‹ä¸ä¸–ç•ŒçŸ¥è¯†ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šåˆ©ç”¨æ–‡æœ¬çš„å‰kä¸ªè¯ï¼ˆtokenï¼‰ï¼Œé¢„æµ‹ç¬¬k+1ä¸ªè¯ï¼Œå®ç°â€œè‡ªç›‘ç£å­¦ä¹ â€ï¼ˆæ— éœ€äººå·¥æ ‡æ³¨æ ‡ç­¾ï¼‰ã€‚</li>
<li><strong>è®­ç»ƒæ•°æ®</strong>ï¼šè¦†ç›–äº’è”ç½‘ç½‘é¡µã€ç»´åŸºç™¾ç§‘ã€ä¹¦ç±ã€GitHubä»£ç ã€è®ºæ–‡ç­‰å¤šæºè¯­æ–™ï¼Œæ€»é‡è¾¾æ•°åƒäº¿è‡³æ•°ä¸‡äº¿å•è¯ï¼Œç¡®ä¿å†…å®¹çš„å¤šæ ·æ€§ä¸çŸ¥è¯†è¦†ç›–åº¦ã€‚</li>
<li><strong>è®­ç»ƒç›®æ ‡</strong>ï¼šæœ€å¤§åŒ–é¢„æµ‹æ¦‚ç‡ï¼Œæ•°å­¦è¡¨è¾¾ä¸ºï¼š
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Max</mtext><msub><mo>âˆ‘</mo><mi>i</mi></msub><mi>log</mi><mo>â¡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>u</mi><mrow><mi>i</mi><mo>âˆ’</mo><mi>k</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Max} \sum_{i} \log P(u_i|u_{i-k}, ..., u_{i-1}; \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em;"/><span class="mord text"><span class="mord">Max</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span></span>
ï¼ˆå…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯è¯­æ–™ä¸­çš„è¯ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span>æ˜¯æ¨¡å‹å‚æ•°ï¼‰</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œåŸºç¡€æ¨¡å‹â€ï¼Œéœ€<strong>1000+GPU/æœˆ</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-2">äºŒã€é˜¶æ®µäºŒï¼šæœ‰ç›‘ç£å¾®è°ƒï¼ˆæŒ‡ä»¤å¾®è°ƒï¼‰â€”â€”è®©æ¨¡å‹â€œå¬æ‡‚äººç±»æŒ‡ä»¤â€</h2>
<p>é¢„è®­ç»ƒæ¨¡å‹èƒ½â€œç»­å†™æ–‡æœ¬â€ï¼Œä½†è¿˜ä¸æ‡‚â€œæŒ‡ä»¤â€ï¼›è¿™ä¸€é˜¶æ®µçš„ç›®æ ‡æ˜¯è®©æ¨¡å‹ç†è§£äººç±»éœ€æ±‚ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šåœ¨é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œç”¨ <strong>â€œç”¨æˆ·æŒ‡ä»¤+ç†æƒ³è¾“å‡ºâ€çš„æ ‡æ³¨æ•°æ®</strong> ç»§ç»­è®­ç»ƒã€‚</li>
<li><strong>è®­ç»ƒæ•°æ®</strong>ï¼šæ•°ä¸‡çº§æ ‡æ³¨ç”¨æˆ·æŒ‡ä»¤+å¯¹åº”é«˜è´¨é‡è¾“å‡ºï¼Œèšç„¦å¼€æ”¾é—®é¢˜ã€é˜…è¯»ç†è§£ã€ä»£ç ç”Ÿæˆç­‰åœºæ™¯ã€‚</li>
<li><strong>èƒ½åŠ›æå‡</strong>ï¼šæ¨¡å‹å…·å¤‡åˆæ­¥çš„æŒ‡ä»¤ç†è§£èƒ½åŠ›ï¼Œèƒ½å®Œæˆå¼€æ”¾é¢†åŸŸé—®ç­”ã€ç¿»è¯‘ã€ä»£ç ç¼–å†™ï¼Œè¿˜èƒ½æ³›åŒ–åˆ°æœªçŸ¥ä»»åŠ¡ã€‚</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œSFTæ¨¡å‹ï¼ˆæœ‰ç›‘ç£å¾®è°ƒæ¨¡å‹ï¼‰â€ï¼Œéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-3">ä¸‰ã€é˜¶æ®µä¸‰ï¼šå¥–åŠ±å»ºæ¨¡â€”â€”ç»™æ¨¡å‹â€œç«‹è¯„ä»·æ ‡å‡†â€</h2>
<p>è¿™ä¸€é˜¶æ®µçš„æ ¸å¿ƒæ˜¯<strong>æ„å»ºâ€œæ–‡æœ¬è´¨é‡è¯„ä¼°ä½“ç³»â€</strong>ï¼Œä¸ºåç»­ä¼˜åŒ–æä¾›â€œå¥–åŠ±ä¿¡å·â€ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç›®æ ‡</strong>ï¼šè®­ç»ƒä¸€ä¸ªâ€œå¥–åŠ±æ¨¡å‹ï¼ˆRMï¼‰â€ï¼Œç”¨äºè¯„ä¼°SFTæ¨¡å‹è¾“å‡ºå†…å®¹çš„è´¨é‡é«˜ä½ã€‚</li>
<li><strong>è®­ç»ƒæ–¹å¼</strong>ï¼šäººå·¥æ ‡æ³¨ç™¾ä¸‡çº§æ ·æœ¬â€”â€”å°†åŒä¸€ä¸ªæŒ‡ä»¤è¾“å…¥SFTæ¨¡å‹å¾—åˆ°å¤šä¸ªè¾“å‡ºï¼Œç”±æ ‡æ³¨äººå‘˜å¯¹è¿™äº›è¾“å‡ºæŒ‰è´¨é‡æ’åºï¼Œä»¥æ­¤è®­ç»ƒRMæ¨¡å‹ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šRMæ¨¡å‹ä¼šæˆä¸ºåç»­å¼ºåŒ–å­¦ä¹ çš„â€œè£åˆ¤â€ï¼Œä¸ºæ¨¡å‹çš„è¾“å‡ºæ‰“åˆ†ã€‚</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œRMæ¨¡å‹ï¼ˆå¥–åŠ±æ¨¡å‹ï¼‰â€ï¼Œéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-4">å››ã€é˜¶æ®µå››ï¼šå¼ºåŒ–å­¦ä¹ â€”â€”è®©æ¨¡å‹â€œè¶Šç­”è¶Šè´´åˆéœ€æ±‚â€</h2>
<p>è¿™æ˜¯ChatGPTçš„<strong>æœ€ç»ˆä¼˜åŒ–é˜¶æ®µ</strong>ï¼Œæ ¸å¿ƒæ˜¯ç”¨å¥–åŠ±ä¿¡å·è®©æ¨¡å‹æŒç»­è¿­ä»£ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š
<ol>
<li>è¾“å…¥åä¸‡çº§ç”¨æˆ·æŒ‡ä»¤ï¼Œè®©SFTæ¨¡å‹ç”Ÿæˆè¾“å‡ºï¼›</li>
<li>ç”¨RMæ¨¡å‹å¯¹è¾“å‡ºæ‰“åˆ†ï¼ˆå³â€œå¥–åŠ±â€ï¼‰ï¼›</li>
<li>æ ¹æ®å¥–åŠ±ç»“æœè°ƒæ•´SFTæ¨¡å‹çš„å‚æ•°ï¼Œè®©æ¨¡å‹æ›´å€¾å‘äºç”Ÿæˆé«˜åˆ†å†…å®¹ã€‚</li>
</ol>
</li>
<li><strong>æœ€ç»ˆè¾“å‡º</strong>ï¼šç»è¿‡æ­¤é˜¶æ®µè®­ç»ƒåï¼Œå¾—åˆ°æœ€ç»ˆçš„ChatGPTæ¨¡å‹ã€‚</li>
<li><strong>èµ„æºéœ€æ±‚</strong>ï¼šéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-5">æ€»ç»“ï¼šChatGPTæ„å»ºçš„â€œå››æ­¥é€»è¾‘â€</h2>
<p>ChatGPTçš„è®­ç»ƒæ˜¯ä¸€ä¸ªâ€œä»åŸºç¡€åˆ°ä¼˜åŒ–â€çš„é€’è¿›è¿‡ç¨‹ï¼š</p>
<ol>
<li>é¢„è®­ç»ƒï¼šå­¦è¯­è¨€ã€æ”’çŸ¥è¯† â†’ åŸºç¡€æ¨¡å‹ï¼›</li>
<li>æœ‰ç›‘ç£å¾®è°ƒï¼šå­¦æŒ‡ä»¤ã€æ‡‚éœ€æ±‚ â†’ SFTæ¨¡å‹ï¼›</li>
<li>å¥–åŠ±å»ºæ¨¡ï¼šå®šæ ‡å‡†ã€åšè£åˆ¤ â†’ RMæ¨¡å‹ï¼›</li>
<li>å¼ºåŒ–å­¦ä¹ ï¼šé åé¦ˆã€è¿­ä»£ä¼˜ â†’ ChatGPTã€‚</li>
</ol>
<p>å„é˜¶æ®µçš„<strong>æ•°æ®è§„æ¨¡ã€ç®—æ³•ç±»å‹ã€è®¡ç®—èµ„æº</strong>éœ€ç²¾å‡†åŒ¹é…ï¼Œæ‰èƒ½æœ€ç»ˆå®ç°æ¨¡å‹çš„â€œæ™ºèƒ½è¡¨ç°â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥]]></title>    <link>https://juejin.cn/post/7585574047075418112</link>    <guid>https://juejin.cn/post/7585574047075418112</guid>    <pubDate>2025-12-21T08:51:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585574047075418112" data-draft-id="7585693761532543010" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-21T08:51:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Charlie_Byte"/> <meta itemprop="url" content="https://juejin.cn/user/1968540037686224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1968540037686224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Charlie_Byte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:51:08.000Z" title="Sun Dec 21 2025 08:51:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çŸ­é“¾æ¥ï¼Ÿ</h2>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Ÿ</p>
<blockquote>
<p>æƒ³åœ¨æœ‹å‹åœˆåˆ†äº«ä¸€ä¸ªé“¾æ¥ï¼Œç»“æœä¸€ç²˜è´´â€”â€”å¥½å®¶ä¼™ï¼Œä¸€é•¿ä¸²å‚æ•°ï¼Œå äº†åŠå±ï¼Œè¿˜å¸¦ä¸€å † <code>?utm_source=xxx&amp;ref=yyyâ€¦â€¦</code> åˆ«äººä¸€çœ‹å°±çƒ¦ï¼Œè‡ªå·±éƒ½æ‡’å¾—ç‚¹ã€‚æ›´åˆ«è¯´åœ¨çŸ­ä¿¡ã€æµ·æŠ¥ã€äºŒç»´ç ç­‰ç©ºé—´æœ‰é™çš„åœºæ™¯ä¸‹äº†ã€‚</p>
</blockquote>
<p>è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸€ä¸ª<strong>çŸ­é“¾æ¥</strong>ï¼Œæ¯”å¦‚æŠŠï¼š</p>
<pre><code class="hljs language-text" lang="text">https://example.com/article?id=12345&amp;source=wechat&amp;utm_campaign=spring_sale
</code></pre>
<p>å˜æˆ</p>
<pre><code class="hljs language-text" lang="text">https://ex.co/aB3k9
</code></pre>
<p>è¿™ç±»çŸ­é“¾æ¥ç®€æ´ç¾è§‚ï¼Œæ˜“äºä¼ æ’­å¹¶ä¸”å¯éšè—åŸå§‹é€»è¾‘ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚</p>
<h2 data-id="heading-1">å“ˆå¸Œ + ç¼–ç Â = çŸ­ç </h2>
<p>è¦ç”ŸæˆçŸ­é“¾æ¥ï¼Œå…³é”®åœ¨äºå°†ä»»æ„é•¿åº¦çš„åŸå§‹ URL æ˜ å°„ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦ã€å”¯ä¸€ä¸”ç´§å‡‘çš„å­—ç¬¦ä¸²æ ‡è¯†ç¬¦ï¼ˆå³â€œçŸ­ç â€ï¼‰ã€‚</p>
<p>è¿™é‡Œé‡‡ç”¨ä¸¤æ­¥æ³•ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå“ˆå¸Œ</strong></p>
<p>ä½¿ç”¨<strong>éåŠ å¯†å‹å“ˆå¸Œå‡½æ•°</strong>ï¼ˆå¦‚ MurmurHashï¼‰å°†åŸå§‹ URL è½¬æ¢ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ•´æ•°ï¼ˆé€šå¸¸æ˜¯ 32 ä½ï¼‰ã€‚<br/>
ä¸ºä»€ä¹ˆä¸ç”¨ MD5 æˆ– SHAï¼Ÿå› ä¸ºå®ƒä»¬è¾“å‡ºå¤ªé•¿ï¼ˆMD5 æ˜¯ 32 ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯çŸ­</p>
<p><strong>MurmurHash çš„ä¼˜åŠ¿</strong></p>
<ul>
<li>é«˜æ€§èƒ½ï¼šè®¡ç®—é€Ÿåº¦å¿«ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯</li>
<li>å‡åŒ€åˆ†å¸ƒï¼šå†²çªç‡ä½ï¼Œä¿è¯ä¸åŒ URL ç”Ÿæˆä¸åŒå“ˆå¸Œå€¼</li>
<li>å›ºå®šç§å­ï¼šGuava æä¾›çš„Â <code>murmur3_32_fixed()</code>Â ä½¿ç”¨å›ºå®šç§å­ï¼Œç¡®ä¿è·¨ JVMã€è·¨æœºå™¨ç»“æœä¸€è‡´</li>
<li>éåŠ å¯†ï¼šä¸ç”¨äºå®‰å…¨åœºæ™¯ï¼Œæ­£é€‚åˆåš ID ç”Ÿæˆ</li>
</ul>
<p><strong>ç¬¬äºŒæ­¥ï¼šç¼–ç </strong></p>
<p>å°†å“ˆå¸Œå¾—åˆ°çš„æ•´æ•°ï¼ˆå¯èƒ½ä¸ºè´Ÿæ•°ï¼‰è½¬æ¢ä¸º<strong>Base62 å­—ç¬¦ä¸²</strong>ã€‚</p>
<p><strong>Base62 æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>å­—ç¬¦é›†ï¼š<code>0â€“9</code>ï¼ˆ10ä¸ªï¼‰ +Â <code>Aâ€“Z</code>ï¼ˆ26ä¸ªï¼‰ +Â <code>aâ€“z</code>ï¼ˆ26ä¸ªï¼‰ = å…± 62 ä¸ªå­—ç¬¦</li>
<li>ä¼˜ç‚¹ï¼šURL å®‰å…¨ï¼ˆä¸å«Â <code>+</code>,Â <code>/</code>,Â <code>=</code>Â ç­‰ç‰¹æ®Šå­—ç¬¦ï¼‰ï¼Œå¯ç›´æ¥æ‹¼æ¥åˆ°åŸŸåå</li>
<li>å¯¹æ¯” Base64ï¼šBase64 å«Â <code>+</code>Â å’ŒÂ <code>/</code>ï¼Œåœ¨ URL ä¸­éœ€è½¬ä¹‰ï¼Œä¸é€‚åˆåšçŸ­é“¾</li>
</ul>
<p><strong>æœ€ç»ˆæµç¨‹</strong></p>
<pre><code class="hljs language-text" lang="text">é•¿ URL â†’ MurmurHash â†’ 32ä½æ•´æ•° â†’ è½¬æ— ç¬¦å· long â†’ Base62 ç¼–ç  â†’ 5~6ä½çŸ­ç 
</code></pre>
<h2 data-id="heading-2">æ ¸å¿ƒä»£ç </h2>
<p>é¦–å…ˆï¼Œåœ¨ Maven é¡¹ç›®ä¸­å¼•å…¥ Google Guava åº“ï¼ˆæä¾›äº†ç¨³å®šé«˜æ•ˆçš„ MurmurHash å®ç°ï¼‰</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.google.guava/guava --&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>33.5.0-jre<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å“ˆå¸Œæµ‹è¯•ï¼Œçœ‹ MurmurHash è¾“å‡ºä»€ä¹ˆ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// import com.google.common.hash.Hashing;</span>
<span class="hljs-comment">// import java.nio.charset.StandardCharsets;</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {  
    <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://tse1-mm.cn.bing.net/th/id/OIP-C.wb-bFBTpIZDy_1jcvMY_5QHaE8?w=286&amp;h=191&amp;c=7&amp;r=0&amp;o=7&amp;cb=ucfimg2&amp;dpr=1.1&amp;pid=1.7&amp;rm=3&amp;ucfimg=1"</span>;  
  
    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
            .hashString(url, StandardCharsets.UTF_8)  
            .asInt();  
    System.out.println(<span class="hljs-string">"hash: "</span> + hash); <span class="hljs-comment">// å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œå¦‚ -904567778</span>
  
    <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>; <span class="hljs-comment">// è½¬ä¸ºæ— ç¬¦å· longï¼Œå¦‚ 3390399518</span>
    System.out.println(<span class="hljs-string">"unsignedHash: "</span> + unsignedHash);  
}
</code></pre>
<pre><code class="hljs language-text" lang="text">hash: -904567778
unsignedHash: 3390399518
</code></pre>
<p>Java çš„ int æ˜¯æœ‰ç¬¦å·çš„ï¼Œç›´æ¥å¯¹è´Ÿæ•°åš Base62 ç¼–ç ä¼šå¯¼è‡´é”™è¯¯ï¼ˆæ¯”å¦‚æ¨¡è¿ç®—å¼‚å¸¸æˆ–ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œå› æ­¤é¡»å…ˆè½¬ä¸ºæ— ç¬¦å· long</p>
<p>åœ¨å¾ˆå¤šä¸šåŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªé“¾æ¥å¯¹ä¸åŒç”¨æˆ·å¯èƒ½æœ‰ä¸åŒçš„è¡Œä¸ºæˆ–æƒé™ï¼Œå°±éœ€è¦å¯¹çŸ­ç è¿›è¡ŒåŒºåˆ†ç”Ÿæˆï¼Œå› æ­¤å¯ä»¥åœ¨ç”ŸæˆçŸ­ç æ—¶ï¼Œå°†ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ user_idã€è®¾å¤‡ IDï¼‰ä¸åŸå§‹ URL æ‹¼æ¥ï¼Œå†è¿›è¡Œå“ˆå¸Œï¼š</p>
<pre><code class="hljs language-java" lang="java">create(url + <span class="hljs-string">"|"</span> + userId)
</code></pre>
<p>å› ä¸ºè¾“å…¥å˜äº†ï¼Œå“ˆå¸Œç»“æœå°±å˜äº†ï¼ŒçŸ­ç è‡ªç„¶ä¹Ÿä¸åŒã€‚</p>
<h2 data-id="heading-3">å®Œæ•´ä»£ç </h2>
<blockquote>
<p>å¸¦æ³¨é‡Šï¼Œæ”¾å¿ƒæŠ„</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> io.jiangbyte.app.biz.urls.utils;  
  
<span class="hljs-keyword">import</span> com.google.common.hash.Hashing;  
  
<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;  
  
<span class="hljs-comment">/**  
 * 1. ä½¿ç”¨ Guava çš„ Murmur3_32_fixed å“ˆå¸Œç®—æ³•å¯¹è¾“å…¥å­—ç¬¦ä¸²è®¡ç®— 32 ä½å“ˆå¸Œå€¼  
 * 2. å°†æœ‰ç¬¦å· int è½¬æ¢ä¸ºæ— ç¬¦å· longï¼ˆé¿å…è´Ÿæ•°é—®é¢˜ï¼‰  
 * 3. å°†è¯¥æ•°å€¼ä½¿ç”¨ Base62 ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼š0-9, A-Z, a-zï¼‰è¾“å‡ºä¸ºç´§å‡‘å­—ç¬¦ä¸²  
 */</span>  
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MurmurHashUtils</span> {  
  
    <span class="hljs-comment">/**  
     * Base62 ç¼–ç å­—ç¬¦é›†ï¼ŒæŒ‰æ ‡å‡†é¡ºåºæ’åˆ—  
     * - æ•°å­— '0' åˆ° '9'ï¼ˆ10 ä¸ªï¼‰  
     * - å¤§å†™å­—æ¯ 'A' åˆ° 'Z'ï¼ˆ26 ä¸ªï¼‰  
     * - å°å†™å­—æ¯ 'a' åˆ° 'z'ï¼ˆ26 ä¸ªï¼‰  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">char</span>[] CHARS = buildBase62Chars();  
  
    <span class="hljs-comment">/**  
     * Base62 çš„åŸºæ•°ï¼Œå€¼ä¸º 62  
     * ç”¨äºè¿›åˆ¶è½¬æ¢è®¡ç®—  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BASE</span> <span class="hljs-operator">=</span> CHARS.length;  
  
    <span class="hljs-comment">/**  
     * æ„å»º Base62 å­—ç¬¦æ•°ç»„  
     * æŒ‰ç…§æ ‡å‡†é¡ºåºä¾æ¬¡å¡«å……æ•°å­—ã€å¤§å†™å­—æ¯ã€å°å†™å­—æ¯  
     *  
     * <span class="hljs-doctag">@return</span> é•¿åº¦ä¸º 62 çš„å­—ç¬¦æ•°ç»„ï¼Œç´¢å¼•å³å¯¹åº”æ•°å€¼ï¼ˆå¦‚ CHARS[0]='0', CHARS[10]='A'ï¼‰  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">char</span>[] buildBase62Chars() {  
        <span class="hljs-type">char</span>[] chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">62</span>];  
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  
  
        <span class="hljs-comment">// å¡«å……æ•°å­— '0' ~ '9'        for (char c = '0'; c &lt;= '9'; c++) {  </span>
            chars[index++] = c;  
        }  
        <span class="hljs-comment">// å¡«å……å¤§å†™å­—æ¯ 'A' ~ 'Z'        for (char c = 'A'; c &lt;= 'Z'; c++) {  </span>
            chars[index++] = c;  
        }  
        <span class="hljs-comment">// å¡«å……å°å†™å­—æ¯ 'a' ~ 'z'        for (char c = 'a'; c &lt;= 'z'; c++) {  </span>
            chars[index++] = c;  
        }  
  
        <span class="hljs-keyword">return</span> chars;  
    }  
  
    <span class="hljs-comment">/**  
     * å°†ä¸€ä¸ªéè´Ÿé•¿æ•´å‹æ•°å€¼è½¬æ¢ä¸º Base62 ç¼–ç å­—ç¬¦ä¸²  
     * ä¸æ–­å¯¹ BASE å–æ¨¡è·å–æœ€ä½ä½å­—ç¬¦ï¼Œå†é™¤ä»¥ BASEï¼Œç›´åˆ°æ•°å€¼ä¸º 0, æœ€åå°†å­—ç¬¦åºåˆ—åè½¬ï¼Œå¾—åˆ°é«˜ä½åœ¨å‰çš„æ ‡å‡†è¡¨ç¤º  
     *  
     * <span class="hljs-doctag">@param</span> n å¾…ç¼–ç çš„éè´Ÿ long å€¼  
     * <span class="hljs-doctag">@return</span> Base62 ç¼–ç åçš„å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">base62</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span> {  
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) {  
            <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>; <span class="hljs-comment">// ç‰¹æ®Šæƒ…å†µï¼š0 ç¼–ç ä¸º "0"        }  </span>
  
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();  
        <span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) {  
            sb.append(CHARS[(<span class="hljs-type">int</span>) (n % BASE)]); <span class="hljs-comment">// å–æ¨¡å¾—åˆ°å½“å‰æœ€ä½ä½å¯¹åº”çš„å­—ç¬¦ç´¢å¼•  </span>
            n /= BASE;  <span class="hljs-comment">// æ•´é™¤è¿›å…¥ä¸‹ä¸€ä½  </span>
        }  
  
        <span class="hljs-comment">// ç”±äºæ˜¯ä»ä½ä½åˆ°é«˜ä½è¿½åŠ ï¼Œéœ€åè½¬å¾—åˆ°æ­£ç¡®é¡ºåº  </span>
        <span class="hljs-keyword">return</span> sb.reverse().toString();  
    }  
  
    <span class="hljs-comment">/**  
     * å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œå“ˆå¸Œå¹¶ç”Ÿæˆ Base62 çŸ­å­—ç¬¦ä¸²ã€‚  
     * ä½¿ç”¨ Murmur3_32_fixed ç®—æ³•ï¼ˆGuava æä¾›çš„å›ºå®šç§å­ç‰ˆæœ¬ï¼Œä¿è¯è·¨ JVM ä¸€è‡´æ€§ï¼‰  
     * å°†ç»“æœè½¬ä¸ºæ— ç¬¦å· 32 ä½æ•´æ•°ï¼Œå†è¿›è¡Œ Base62 ç¼–ç   
     *  
     * <span class="hljs-doctag">@param</span> input åŸå§‹è¾“å…¥å­—ç¬¦ä¸²  
     * <span class="hljs-doctag">@return</span> Base62 ç¼–ç çš„çŸ­å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">create</span><span class="hljs-params">(String input)</span> {  
        <span class="hljs-comment">// ä½¿ç”¨ UTF-8 ç¼–ç è®¡ç®— Murmur3_32 å“ˆå¸Œå€¼ï¼ˆå›ºå®šç§å­ï¼‰  </span>
        <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
                .hashString(input, StandardCharsets.UTF_8)  
                .asInt();  
  
        <span class="hljs-comment">// å°†æœ‰ç¬¦å· int è½¬æ¢ä¸ºæ— ç¬¦å· longï¼ˆé¿å…è´Ÿæ•°å¯¼è‡´ base62 é€»è¾‘å¼‚å¸¸ï¼‰  </span>
        <span class="hljs-comment">// -1 â†’ 0xFFFFFFFFL = 4294967295  </span>
        <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>;  
  
        <span class="hljs-keyword">return</span> base62(unsignedHash);  
    }  
  
    <span class="hljs-comment">/**  
     * ç”Ÿæˆå¸¦ç”¨æˆ·éš”ç¦»çš„çŸ­é“¾æ ‡è¯†ã€‚  
     * è‹¥æä¾› userIdï¼Œåˆ™å°† URL ä¸ userId æ‹¼æ¥åå†å“ˆå¸Œ  
     * ä½¿å¾—åŒä¸€ URL å¯¹ä¸åŒç”¨æˆ·ç”Ÿæˆä¸åŒçŸ­é“¾  
     * è‹¥ userId ä¸º nullï¼Œåˆ™é€€åŒ–ä¸ºæ™®é€šæ¨¡å¼  
     *  
     * <span class="hljs-doctag">@param</span> url    åŸå§‹é•¿é“¾æ¥  
     * <span class="hljs-doctag">@param</span> userId ç”¨æˆ·å”¯ä¸€æ ‡è¯†  
     * <span class="hljs-doctag">@return</span> ç”¨æˆ·éš”ç¦»æˆ–é€šç”¨çš„ Base62 çŸ­å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">create</span><span class="hljs-params">(String url, String userId)</span> {  
        <span class="hljs-keyword">if</span> (userId != <span class="hljs-literal">null</span>) {  
            <span class="hljs-comment">// æ‹¼æ¥æ ¼å¼ï¼šåŸå§‹URL + åˆ†éš”ç¬¦ "|" + ç”¨æˆ·ID  </span>
            <span class="hljs-keyword">return</span> create(url + <span class="hljs-string">"|"</span> + userId);  
        } <span class="hljs-keyword">else</span> {  
            <span class="hljs-comment">// æ— ç”¨æˆ·éš”ç¦»ï¼Œç›´æ¥å“ˆå¸ŒåŸå§‹ URL</span>
            <span class="hljs-keyword">return</span> create(url);  
        }  
    }  
}
</code></pre>
<p><strong>æµ‹è¯•è¾“å‡º</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {  
    <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://tse1-mm.cn.bing.net/th/id/OIP-C.wb-bFBTpIZDy_1jcvMY_5QHaE8?w=286&amp;h=191&amp;c=7&amp;r=0&amp;o=7&amp;cb=ucfimg2&amp;dpr=1.1&amp;pid=1.7&amp;rm=3&amp;ucfimg=1"</span>;  
  
    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
            .hashString(url, StandardCharsets.UTF_8)  
            .asInt();  
    System.out.println(<span class="hljs-string">"hash: "</span> + hash); <span class="hljs-comment">// æœ‰ç¬¦å· intï¼Œé€»è¾‘å‡ºé”™ï¼Œä¸ºç©º  </span>
  
    <span class="hljs-type">String</span> <span class="hljs-variable">base62_hash</span> <span class="hljs-operator">=</span> base62(hash);  
    System.out.println(<span class="hljs-string">"base62_hash: "</span> + base62_hash);  
  
    <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>;  
    System.out.println(<span class="hljs-string">"unsignedHash: "</span> + unsignedHash);  
  
    <span class="hljs-type">String</span> <span class="hljs-variable">base62_unsignedHash</span> <span class="hljs-operator">=</span> base62(unsignedHash);  
    System.out.println(<span class="hljs-string">"base62_unsignedHash: "</span> + base62_unsignedHash);  
  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url));  
  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"1234"</span>));  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"1234"</span>));  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"12345"</span>));  
}
</code></pre>
<pre><code class="hljs language-text" lang="text">hash: -904567778
base62_hash: 
unsignedHash: 3390399518
base62_unsignedHash: 3hRlnC
create: 3hRlnC
create: 4YmoRu
create: 4YmoRu
create: GsQoj
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7585758163435372550</link>    <guid>https://juejin.cn/post/7585758163435372550</guid>    <pubDate>2025-12-21T09:06:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435372550" data-draft-id="7585758163435356166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T09:06:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åæœˆå—åŸ"/> <meta itemprop="url" content="https://juejin.cn/user/3456520290576862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520290576862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åæœˆå—åŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:06:08.000Z" title="Sun Dec 21 2025 09:06:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å†™åœ¨å‰é¢ï¼Œæœ¬äººç›®å‰å¤„äºæ±‚èŒä¸­ï¼Œå¦‚æœ‰åˆé€‚å†…æ¨å²—ä½ï¼Œè¯·åŠ å¾®ä¿¡ï¼šlpshiyue æ„Ÿè°¢</strong></p>
<blockquote>
<p>åœ¨ Redis è¿ç»´ä¸­ï¼Œç›‘æ§æ˜¯æŒ‡æ•°çº§æŠ•å…¥å›æŠ¥æ¯”çš„æŠ•èµ„ï¼šæ¯å¢åŠ ä¸€ä¸ªå…³é”®æŒ‡æ ‡ç›‘æ§ï¼Œå¯èƒ½é¢„é˜²åå€ä»¥ä¸Šçš„æ•…éšœæŸå¤±</p>
</blockquote>
<p>åœ¨è§£å†³çƒ­ç‚¹ Key ä¸å¤§ Key çš„æ²»ç†æŒ‘æˆ˜åï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ›´ä¸ºåŸºç¡€ä¸”å…³é”®çš„é—®é¢˜ï¼šå¦‚ä½•æå‰å‘ç°å¹¶é¢„é˜²è¿™äº›é—®é¢˜çš„å‘ç”Ÿã€‚å®Œå–„çš„ç›‘æ§ä½“ç³»ä¸ä»…èƒ½å®æ—¶åæ˜  Redis å¥åº·çŠ¶æ€ï¼Œæ›´èƒ½é€šè¿‡è¶‹åŠ¿åˆ†æé¢„æµ‹æ½œåœ¨é£é™©ï¼Œå®ç°ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²çš„è½¬å˜ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æ Redis æ ¸å¿ƒç›‘æ§æŒ‡æ ‡ï¼Œå»ºç«‹å®Œæ•´çš„å®¹é‡é¢„è­¦ä½“ç³»ï¼Œè®©ç¼“å­˜ç³»ç»Ÿè¿è¡Œåœ¨å¯è§†ã€å¯æ§ã€å¯é¢„æµ‹çš„è½¨é“ä¸Šã€‚</p>
<h3 data-id="heading-0">1 ç›‘æ§ä½“ç³»çš„ä»·å€¼ä¸æ„å»ºåŸåˆ™</h3>
<h4 data-id="heading-1">1.1 ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²</h4>
<p>Redis ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œå¯¹èµ„æºå¼‚å¸¸æ•æ„Ÿï¼Œâ€‹<strong>æ— ç›‘æ§çš„ Redis å¦‚åŒç›²äººé©¾é©¶é«˜é€Ÿèµ›è½¦</strong>â€‹â€”â€”çœ‹ä¼¼è¿è¡Œæ­£å¸¸ï¼Œå®åˆ™å±æœºå››ä¼ã€‚å®Œå–„çš„ç›‘æ§ä½“ç³»èƒ½å®ç°ä¸‰ä¸ªæ ¸å¿ƒä»·å€¼ï¼š<strong>å®æ—¶æ•…éšœå‘ç°</strong>å°†æ•…éšœå‘ç°æ—¶é—´ä»å°æ—¶çº§ç¼©çŸ­åˆ°åˆ†é’Ÿçº§ï¼Œ<strong>æ ¹å› åˆ†æ</strong>é€šè¿‡å†å²æ•°æ®è¿½æº¯é—®é¢˜æºå¤´ï¼Œ<strong>å®¹é‡è§„åˆ’</strong>åŸºäºè¶‹åŠ¿é¢„æµ‹æå‰æ‰©å®¹é¿å…èµ„æºè€—å°½ã€‚</p>
<p>ç›‘æ§ç³»ç»Ÿçš„ç¼ºå¤±ä¼šå¯¼è‡´æ•…éšœæ”¾å¤§æ•ˆåº”ã€‚å½“ç”¨æˆ·é¦–å…ˆæ„ŸçŸ¥é—®é¢˜è€Œéè¿ç»´äººå‘˜æ—¶ï¼Œæ•…éšœå½±å“å·²æ‰©æ•£ã€‚å¦‚æ‰€è¿°ï¼Œè‹¥ç”±ç”¨æˆ·é€šè¿‡å®¢æœåé¦ˆå†æ’æŸ¥åˆ° Redis æ•…éšœï¼Œæ•´ä¸ªå‘ç°ã€å®šä½å’Œè§£å†³æ—¶é—´è¢«æ‹‰é•¿ï¼Œå°æ•…éšœè¢«â€œæ— é™â€æ”¾å¤§ã€‚</p>
<h4 data-id="heading-2">1.2 ç›‘æ§ä½“ç³»æ„å»ºçš„é»„é‡‘æ³•åˆ™</h4>
<p>æœ‰æ•ˆçš„ Redis ç›‘æ§åº”éµå¾ªâ€‹<strong>SMART åŸåˆ™</strong>â€‹ï¼šç›‘æ§æŒ‡æ ‡éœ€â€‹<strong>å…·ä½“</strong>â€‹ï¼ˆSpecificï¼‰ã€â€‹<strong>å¯è¡¡é‡</strong>â€‹ï¼ˆMeasurableï¼‰ã€â€‹<strong>å¯è¾¾æˆ</strong>â€‹ï¼ˆAttainableï¼‰ã€â€‹<strong>ç›¸å…³</strong>â€‹ï¼ˆRelevantï¼‰å’Œâ€‹<strong>æœ‰æ—¶æ•ˆ</strong>â€‹ï¼ˆTime-boundï¼‰ã€‚ç›‘æ§ä¸æ˜¯æ•°æ®å †ç Œï¼Œè€Œæ˜¯å…³é”®ä¿¡å·æå–ã€‚</p>
<p><strong>åˆ†å±‚ç›‘æ§</strong>ç†å¿µè‡³å…³é‡è¦ï¼š<strong>åŸºç¡€å±‚</strong>å…³æ³¨æœåŠ¡å™¨èµ„æºï¼ˆCPUã€å†…å­˜ã€ç½‘ç»œï¼‰ï¼›<strong>Redis å®ä¾‹å±‚</strong>è·Ÿè¸ªè¿æ¥ã€å†…å­˜ã€æŒä¹…åŒ–çŠ¶æ€ï¼›<strong>ä¸šåŠ¡å±‚</strong>èšç„¦å‘½ä¸­ç‡ã€å»¶è¿Ÿç­‰ä¸šåŠ¡ç›¸å…³æŒ‡æ ‡ã€‚è¿™ç§åˆ†å±‚ç»“æ„ç¡®ä¿é—®é¢˜å®šä½æ•ˆç‡ã€‚</p>
<h3 data-id="heading-3">2 æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡æ·±åº¦è§£è¯»</h3>
<h4 data-id="heading-4">2.1 å»¶è¿Ÿï¼ˆLatencyï¼‰ï¼šç”¨æˆ·ä½“éªŒçš„ç›´æ¥ä½“ç°</h4>
<p>å»¶è¿Ÿæ˜¯ Redis æ€§èƒ½æœ€ç›´è§‚çš„æŒ‡æ ‡ï¼Œè¡¡é‡ä»å‘½ä»¤å‘é€åˆ°æ”¶åˆ°å“åº”çš„æ€»æ—¶é—´ã€‚å•çº¿ç¨‹æ¶æ„ä½¿ Redis å¯¹å»¶è¿Ÿå¼‚å¸¸æ•æ„Ÿï¼Œä»»ä½•å¾®å°å»¶è¿Ÿéƒ½å¯èƒ½ç´¯ç§¯æˆä¸¥é‡ç“¶é¢ˆã€‚</p>
<p>â€‹<strong>å»¶è¿Ÿç›‘æ§çš„å¤šç»´åº¦å®ç°</strong>â€‹ï¼š</p>
<ul>
<li>
<p>â€‹<strong>å†…åœ¨å»¶è¿Ÿ</strong>â€‹ï¼šä½¿ç”¨ <code>redis-cli --intrinsic-latency</code> æµ‹é‡ Redis æœåŠ¡å™¨è‡ªèº«å»¶è¿Ÿ</p>
</li>
<li>
<p>â€‹<strong>ç½‘ç»œå»¶è¿Ÿ</strong>â€‹ï¼šé€šè¿‡ <code>redis-cli --latency -h host -p port</code> æµ‹è¯•å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„å¾€è¿”å»¶è¿Ÿ</p>
</li>
<li>
<p>â€‹<strong>å‘½ä»¤å»¶è¿Ÿ</strong>â€‹ï¼šé…ç½® <code>latency-monitor-threshold</code> å¯ç”¨å»¶è¿Ÿç›‘æ§æ¡†æ¶</p>
<h2 data-id="heading-5">è®¾ç½®å»¶è¿Ÿç›‘æ§é˜ˆå€¼ä¸º100æ¯«ç§’</h2>
<p>CONFIG SET latency-monitor-threshold 100</p>
<h2 data-id="heading-6">æŸ¥çœ‹æœ€æ–°å»¶è¿Ÿäº‹ä»¶</h2>
<p>LATENCY LATEST</p>
<h2 data-id="heading-7">è·å–å»¶è¿Ÿå†å²æ•°æ®</h2>
<p>LATENCY HISTORY command
â€‹</p>
</li>
</ul>
<p>åŸºäºçš„å»¶è¿Ÿç›‘æ§é…ç½®</p>
<p>â€‹<strong>å»¶è¿Ÿçš„å…¸å‹é˜ˆå€¼å‚è€ƒ</strong>â€‹ï¼š</p>
<ul>
<li>ç†æƒ³å»¶è¿Ÿï¼š&lt;1msï¼ˆå†…å­˜æ“ä½œï¼‰</li>
<li>å¯æ¥å—å»¶è¿Ÿï¼š1-5msï¼ˆæ­£å¸¸ç½‘ç»œå¼€é”€ï¼‰</li>
<li>éœ€å…³æ³¨å»¶è¿Ÿï¼š5-10msï¼ˆå¯èƒ½å­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼‰</li>
<li>é—®é¢˜å»¶è¿Ÿï¼š&gt;10msï¼ˆéœ€ç«‹å³æ’æŸ¥ï¼‰</li>
</ul>
<h4 data-id="heading-8">2.2 å‘½ä¸­ç‡ï¼ˆHit Rateï¼‰ï¼šç¼“å­˜æ•ˆç‡çš„æ ¸å¿ƒæŒ‡æ ‡</h4>
<p>å‘½ä¸­ç‡è¡¡é‡ç¼“å­˜æœ‰æ•ˆæ€§ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š<code>keyspace_hits / (keyspace_hits + keyspace_misses)</code>ã€‚ä½å‘½ä¸­ç‡æ„å‘³ç€ç¼“å­˜æ•ˆç‡ä½ä¸‹ï¼Œå¤§é‡è¯·æ±‚ç›´æ¥ç©¿é€åˆ°åç«¯æ•°æ®åº“ã€‚</p>
<p>â€‹<strong>å‘½ä¸­ç‡è§£è¯»ä¸ä¼˜åŒ–ç­–ç•¥</strong>â€‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å‘½ä¸­ç‡è®¡ç®—ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> <span class="hljs-title">calculateHitRate</span>()</span> {
    <span class="hljs-built_in">long</span> hits = redis.info(<span class="hljs-string">"stats"</span>).getLong(<span class="hljs-string">"keyspace_hits"</span>);
    <span class="hljs-built_in">long</span> misses = redis.info(<span class="hljs-string">"stats"</span>).getLong(<span class="hljs-string">"keyspace_misses"</span>);
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">double</span>)hits / (hits + misses);
}
â€‹
</code></pre>
<p>åŸºäºçš„å‘½ä¸­ç‡è®¡ç®—é€»è¾‘</p>
<p>â€‹<strong>å‘½ä¸­ç‡é˜ˆå€¼æŒ‡å—</strong>â€‹ï¼š</p>
<ul>
<li>ä¼˜ç§€ï¼š&gt;95%ï¼ˆç¼“å­˜æ•ˆæœæä½³ï¼‰</li>
<li>è‰¯å¥½ï¼š90%-95%ï¼ˆç¼“å­˜æ•ˆæœè‰¯å¥½ï¼‰</li>
<li>éœ€å…³æ³¨ï¼š80%-90%ï¼ˆéœ€è¦ä¼˜åŒ–ï¼‰</li>
<li>è¾ƒå·®ï¼š&lt;80%ï¼ˆç¼“å­˜ç­–ç•¥éœ€é‡æ„ï¼‰</li>
</ul>
<p>ä½å‘½ä¸­ç‡é€šå¸¸ç”±ä»¥ä¸‹åŸå› å¯¼è‡´ï¼š<strong>å†…å­˜ä¸è¶³</strong>å¯¼è‡´é¢‘ç¹æ•°æ®æ·˜æ±°ï¼Œ<strong>æ•°æ®è®¿é—®æ¨¡å¼å˜åŒ–</strong>ä½¿çƒ­ç‚¹æ•°æ®å¤±æ•ˆï¼Œ<strong>TTL è®¾ç½®è¿‡çŸ­</strong>å¯¼è‡´æ•°æ®è¿‡æ—©å¤±æ•ˆã€‚</p>
<h4 data-id="heading-9">2.3 å†…å­˜ç¢ç‰‡ï¼ˆMemory Fragmentationï¼‰ï¼šéšè—çš„æ€§èƒ½æ€æ‰‹</h4>
<p>å†…å­˜ç¢ç‰‡ç‡é€šè¿‡ <code>mem_fragmentation_ratio</code>ï¼ˆused_memory_rss/used_memoryï¼‰è®¡ç®—ï¼Œåæ˜ å†…å­˜ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>â€‹<strong>ç¢ç‰‡ç‡è§£è¯»ä¸è¡ŒåŠ¨æŒ‡å—</strong>â€‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æŸ¥çœ‹å†…å­˜ç¢ç‰‡ç‡</span>
redis-cli info memory | <span class="hljs-keyword">grep</span> mem_fragmentation_ratio
â€‹
</code></pre>
<p>â€‹</p>
<p>ç¢ç‰‡ç‡åˆ¤æ–­æ ‡å‡†</p>
<p>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>ç†æƒ³çŠ¶æ€</strong>â€‹ï¼ˆ1.0-1.5ï¼‰ï¼šå†…å­˜åˆ†é…ç´§å‡‘ï¼Œæ— æ˜¾è‘—ç¢ç‰‡</li>
<li>â€‹<strong>éœ€å…³æ³¨</strong>â€‹ï¼ˆ1.5-2.0ï¼‰ï¼šå­˜åœ¨ä¸€å®šç¢ç‰‡ï¼Œè€ƒè™‘ç›‘æ§ä¼˜åŒ–</li>
<li>â€‹<strong>é—®é¢˜çŠ¶æ€</strong>â€‹ï¼ˆ&gt;2.0ï¼‰ï¼šç¢ç‰‡ä¸¥é‡ï¼Œéœ€è¦é‡å¯æˆ–å†…å­˜ä¼˜åŒ–</li>
<li>â€‹<strong>å±é™©ä¿¡å·</strong>â€‹ï¼ˆ&lt;1.0ï¼‰ï¼šå†…å­˜äº¤æ¢åˆ°ç£ç›˜ï¼Œæ€§èƒ½ä¸¥é‡ä¸‹é™</li>
</ul>
<p>é«˜ç¢ç‰‡ç‡é€šå¸¸ç”±â€‹<strong>é¢‘ç¹ä¿®æ”¹ä¸åŒå¤§å°æ•°æ®</strong>â€‹ã€<strong>å¤§é‡é”®è¿‡æœŸ</strong>å¯¼è‡´ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬é‡å¯å®ä¾‹ã€ä½¿ç”¨ <code>MEMORY PURGE</code>ï¼ˆéœ€ Jemallocï¼‰æˆ–ä¼˜åŒ–æ•°æ®è®¿é—®æ¨¡å¼ã€‚</p>
<h3 data-id="heading-10">3 å®¹é‡é¢„è­¦æŒ‡æ ‡ä½“ç³»</h3>
<h4 data-id="heading-11">3.1 å†…å­˜å®¹é‡è§„åˆ’ä¸é¢„è­¦</h4>
<p>å†…å­˜æ˜¯ Redis æœ€å…³é”®çš„èµ„æºï¼Œéœ€å»ºç«‹å¤šçº§é¢„è­¦æœºåˆ¶ï¼š</p>
<p>â€‹<strong>å†…å­˜ä½¿ç”¨ç‡é¢„è­¦é˜ˆå€¼</strong>â€‹ï¼š</p>
<p>ä½¿ç”¨ç‡</p>
<p>å‘Šè­¦çº§åˆ«</p>
<p>å¤„ç†åŠ¨ä½œ</p>
<p>â‰¤70%</p>
<p>æ­£å¸¸</p>
<p>æŒç»­ç›‘æ§</p>
<p>70%-85%</p>
<p>è­¦å‘Š</p>
<p>æ£€æŸ¥å¤§ Keyï¼Œä¼˜åŒ–æ•°æ®</p>
<p>85%-95%</p>
<p>ä¸¥é‡</p>
<p>å‡†å¤‡æ‰©å®¹ï¼Œä¼˜åŒ–è¿‡æœŸç­–ç•¥</p>
<p>â‰¥95%</p>
<p>ç´§æ€¥</p>
<p>ç«‹å³æ‰©å®¹ï¼Œå¯èƒ½å·²æ‹’ç»å†™å…¥</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ</span>
<span class="hljs-string">redis-cli</span> <span class="hljs-string">info</span> <span class="hljs-string">memory</span>
<span class="hljs-attr">used_memory:</span> <span class="hljs-number">1000000</span>       <span class="hljs-comment"># Redisåˆ†é…å†…å­˜æ€»é‡</span>
<span class="hljs-attr">used_memory_rss:</span> <span class="hljs-number">1500000</span>   <span class="hljs-comment"># æ“ä½œç³»ç»Ÿè§†è§’å†…å­˜å ç”¨</span>
<span class="hljs-attr">used_memory_peak:</span> <span class="hljs-number">1200000</span>  <span class="hljs-comment"># å†å²å³°å€¼å†…å­˜</span>
<span class="hljs-attr">maxmemory:</span> <span class="hljs-number">2000000</span>        <span class="hljs-comment"># æœ€å¤§å†…å­˜é™åˆ¶</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„å†…å­˜ç›‘æ§æŒ‡æ ‡</p>
<p>â€‹<strong>å†…å­˜ä¼˜åŒ–ç­–ç•¥</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>æ•°æ®åˆ†ç‰‡</strong>â€‹ï¼šå°†å¤§æ•°æ®é›†åˆ†å¸ƒåˆ°å¤šä¸ªå®ä¾‹</li>
<li>â€‹<strong>å‹ç¼©å­˜å‚¨</strong>â€‹ï¼šå¯¹é€‚åˆæ•°æ®å¯ç”¨å‹ç¼©</li>
<li>â€‹<strong>è¿‡æœŸç­–ç•¥</strong>â€‹ï¼šè®¾ç½®åˆç†çš„ TTL å’Œæ·˜æ±°ç­–ç•¥</li>
</ul>
<h4 data-id="heading-12">3.2 è¿æ¥æ•°å®¹é‡ç®¡ç†</h4>
<p>è¿æ¥æ•°è¶…é™ä¼šå¯¼è‡´æ–°è¿æ¥è¢«æ‹’ç»ï¼Œç›‘æ§ <code>connected_clients</code> å¹¶è®¾ç½®åˆç†é˜ˆå€¼è‡³å…³é‡è¦ï¼š</p>
<p>â€‹<strong>è¿æ¥æ•°ç›‘æ§è¦ç‚¹</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># æŸ¥çœ‹è¿æ¥æ•°ä¿¡æ¯</span>
<span class="hljs-string">redis-cli</span> <span class="hljs-string">info</span> <span class="hljs-string">clients</span>
<span class="hljs-attr">connected_clients:</span> <span class="hljs-number">100</span>        <span class="hljs-comment"># å½“å‰è¿æ¥æ•°</span>
<span class="hljs-attr">maxclients:</span> <span class="hljs-number">10000</span>            <span class="hljs-comment"># æœ€å¤§è¿æ¥æ•°é™åˆ¶</span>
<span class="hljs-attr">blocked_clients:</span> <span class="hljs-number">0</span>           <span class="hljs-comment"># é˜»å¡è¿æ¥æ•°</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„è¿æ¥æ•°ç›‘æ§</p>
<p>â€‹<strong>è¿æ¥æ•°é¢„è­¦é˜ˆå€¼</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>æ­£å¸¸</strong>â€‹ï¼š&lt;80% maxclients</li>
<li>â€‹<strong>è­¦å‘Š</strong>â€‹ï¼š80%-95% maxclients</li>
<li>â€‹<strong>ç´§æ€¥</strong>â€‹ï¼š&gt;95% maxclients æˆ–å‡ºç° <code>rejected_connections</code></li>
</ul>
<p>è¿æ¥æ•°çªå¢é€šå¸¸ç”±â€‹<strong>è¿æ¥æ± é…ç½®é”™è¯¯</strong>â€‹ã€<strong>å®¢æˆ·ç«¯æœªæ­£ç¡®å…³é—­è¿æ¥</strong>æˆ–<strong>æ…¢æŸ¥è¯¢é˜»å¡</strong>å¯¼è‡´ã€‚åº”ç›‘æ§ <code>blocked_clients</code> äº†è§£é˜»å¡å‘½ä»¤æƒ…å†µã€‚</p>
<h4 data-id="heading-13">3.3 ç½‘ç»œå¸¦å®½ä¸ååé‡ç›‘æ§</h4>
<p>ç½‘ç»œå¸¦å®½å½±å“ Redis ååèƒ½åŠ›ï¼Œéœ€ç›‘æ§ç½‘ç»œè¾“å…¥è¾“å‡ºï¼š</p>
<p>â€‹<strong>å…³é”®ç½‘ç»œæŒ‡æ ‡</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>instantaneous_input_kbps</strong>â€‹ï¼šç¬æ—¶è¾“å…¥å¸¦å®½</li>
<li>â€‹<strong>instantaneous_output_kbps</strong>â€‹ï¼šç¬æ—¶è¾“å‡ºå¸¦å®½</li>
<li>â€‹<strong>total_net_input_bytes</strong>â€‹ï¼šç´¯è®¡è¾“å…¥æµé‡</li>
<li>â€‹<strong>total_net_output_bytes</strong>â€‹ï¼šç´¯è®¡è¾“å‡ºæµé‡</li>
</ul>
<p>åƒå…†ç½‘å¡ç†è®ºæé™çº¦ 125MB/sï¼Œå½“ç½‘ç»œååæ¥è¿‘æé™æ—¶éœ€è€ƒè™‘åˆ†ç‰‡æˆ–å‡çº§ç½‘ç»œã€‚</p>
<h3 data-id="heading-14">4 æ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-15">4.1 æ…¢æŸ¥è¯¢è¯Šæ–­æ¡†æ¶</h4>
<p>æ…¢æŸ¥è¯¢æ˜¯ Redis æ€§èƒ½çš„å¸¸è§ç“¶é¢ˆï¼Œé€šè¿‡æ…¢æ—¥å¿—åŠŸèƒ½è¯†åˆ«ï¼š</p>
<p>â€‹<strong>æ…¢æŸ¥è¯¢é…ç½®ä¸æŸ¥çœ‹</strong>â€‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è®¾ç½®æ…¢æŸ¥è¯¢é˜ˆå€¼ï¼ˆå¾®ç§’ï¼‰</span>
CONFIG SET slowlog-log-slower-than <span class="hljs-number">10000</span>

<span class="hljs-comment"># è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—é•¿åº¦</span>
CONFIG SET slowlog-<span class="hljs-built_in">max</span>-<span class="hljs-built_in">len</span> <span class="hljs-number">128</span>

<span class="hljs-comment"># æŸ¥çœ‹æ…¢æŸ¥è¯¢</span>
SLOWLOG GET <span class="hljs-number">10</span>
â€‹
</code></pre>
<p>åŸºäºçš„æ…¢æŸ¥è¯¢é…ç½®</p>
<p>â€‹<strong>æ…¢æŸ¥è¯¢åˆ†æç»´åº¦</strong>â€‹ï¼š</p>
<ol>
<li>â€‹<strong>å‘½ä»¤ç±»å‹</strong>â€‹ï¼šè¯†åˆ«è€—æ—¶æœ€é«˜çš„å‘½ä»¤æ¨¡å¼</li>
<li>â€‹<strong>æ‰§è¡Œæ—¶é—´</strong>â€‹ï¼šåˆ†æå‘½ä»¤æ‰§è¡Œæ—¶é—´åˆ†å¸ƒ</li>
<li>â€‹<strong>å‘ç”Ÿé¢‘ç‡</strong>â€‹ï¼šç»Ÿè®¡æ…¢æŸ¥è¯¢å‘ç”Ÿé¢‘ç‡</li>
<li>â€‹<strong>æ—¶é—´è§„å¾‹</strong>â€‹ï¼šå¯»æ‰¾æ…¢æŸ¥è¯¢çš„æ—¶é—´è§„å¾‹</li>
</ol>
<h4 data-id="heading-16">4.2 å¸¸è§æ…¢æŸ¥è¯¢åœºæ™¯ä¸è§£å†³æ–¹æ¡ˆ</h4>
<p>â€‹<strong>å¤§ Key æ“ä½œ</strong>â€‹ï¼šæ‹†åˆ†è¶…è¿‡ 10KB çš„ String æˆ–å…ƒç´ è¶… 1000 çš„é›†åˆ</p>
<p>â€‹<strong>å¤æ‚è¿ç®—</strong>â€‹ï¼šé¿å…åœ¨ Redis å†…æ‰§è¡Œ O(N)å¤æ‚åº¦çš„æ“ä½œ</p>
<p>â€‹<strong>é˜»å¡å‘½ä»¤</strong>â€‹ï¼šè°¨æ…ä½¿ç”¨ BLPOPã€BRPOP ç­‰é˜»å¡å‘½ä»¤</p>
<p>ä¼˜åŒ–æ–¹æ¡ˆåŒ…æ‹¬â€‹<strong>æ•°æ®åˆ†ç‰‡</strong>â€‹ã€<strong>ç®¡é“åŒ–æ“ä½œ</strong>å‡å°‘ç½‘ç»œå¾€è¿”ï¼Œ<strong>Lua è„šæœ¬ä¼˜åŒ–</strong>å°†å¤šä¸ªæ“ä½œåˆå¹¶ã€‚</p>
<h3 data-id="heading-17">5 æŒä¹…åŒ–ä¸å¤åˆ¶ç›‘æ§</h3>
<h4 data-id="heading-18">5.1 æŒä¹…åŒ–å¥åº·åº¦æ£€æŸ¥</h4>
<p>æŒä¹…åŒ–å½±å“æ•°æ®å®‰å…¨ï¼Œéœ€å…³æ³¨å…³é”®æŒ‡æ ‡ï¼š</p>
<p>â€‹<strong>RDB æŒä¹…åŒ–ç›‘æ§</strong>â€‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥RDBçŠ¶æ€</span>
redis-cli info persistence
rdb_last_bgsave_status:ok    <span class="hljs-comment"># ä¸Šæ¬¡bgsaveçŠ¶æ€</span>
rdb_last_bgsave_time_sec:2    <span class="hljs-comment"># ä¸Šæ¬¡bgsaveè€—æ—¶</span>
latest_fork_usec:500          <span class="hljs-comment"># æœ€è¿‘forkè€—æ—¶(å¾®ç§’)</span>
â€‹
</code></pre>
<p>åŸºäºçš„æŒä¹…åŒ–ç›‘æ§</p>
<p>â€‹<strong>AOF æŒä¹…åŒ–ç›‘æ§</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>aof_last_bgrewrite_status</strong>â€‹ï¼šAOF é‡å†™çŠ¶æ€</li>
<li>â€‹<strong>aof_current_size</strong>â€‹ï¼šAOF å½“å‰å¤§å°</li>
<li>â€‹<strong>aof_base_size</strong>â€‹ï¼šAOF åŸºç¡€å¤§å°</li>
</ul>
<p>æŒä¹…åŒ–æ•…éšœé¢„è­¦ç‚¹åŒ…æ‹¬ bgsave å¤±è´¥ã€fork è€—æ—¶è¿‡é•¿ï¼ˆ&gt;1 ç§’ï¼‰ã€AOF é‡å†™å¼‚å¸¸ç­‰ã€‚</p>
<h4 data-id="heading-19">5.2 ä¸»ä»å¤åˆ¶å¥åº·ç›‘æ§</h4>
<p>å¤åˆ¶å»¶è¿Ÿå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œéœ€å¯†åˆ‡ç›‘æ§ï¼š</p>
<p>â€‹<strong>å¤åˆ¶çŠ¶æ€ç›‘æ§</strong>â€‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å¤åˆ¶ä¿¡æ¯</span>
redis-cli info replication
role:master                    <span class="hljs-comment"># å®ä¾‹è§’è‰²</span>
master_repl_offset:1000       <span class="hljs-comment"># ä¸»èŠ‚ç‚¹å¤åˆ¶åç§»é‡</span>
slave_repl_offset:980         <span class="hljs-comment"># ä»èŠ‚ç‚¹å¤åˆ¶åç§»é‡</span>
replica_backlog_histlen:100   <span class="hljs-comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºé•¿åº¦</span>
â€‹
</code></pre>
<p>åŸºäºçš„å¤åˆ¶ç›‘æ§</p>
<p>â€‹<strong>å¤åˆ¶å»¶è¿Ÿè®¡ç®—ä¸å‘Šè­¦</strong>â€‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è®¡ç®—å¤åˆ¶å»¶è¿Ÿ</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title">getReplicationLag</span><span class="hljs-params">(<span class="hljs-type">String</span> masterHost, <span class="hljs-type">int</span> masterPort)</span> </span>{
    <span class="hljs-type">long</span> masterOffset = <span class="hljs-built_in">getMasterOffset</span>(masterHost, masterPort);
    <span class="hljs-type">long</span> slaveOffset = <span class="hljs-built_in">getSlaveOffset</span>();
    <span class="hljs-keyword">return</span> masterOffset - slaveOffset;  <span class="hljs-comment">// å»¶è¿Ÿåç§»é‡</span>
}
â€‹
</code></pre>
<p>åŸºäºçš„å¤åˆ¶å»¶è¿Ÿè®¡ç®—</p>
<p>å¤åˆ¶å»¶è¿Ÿå‘Šè­¦é˜ˆå€¼å»ºè®®ï¼šâ€‹<strong>è­¦å‘Š</strong>â€‹&gt;10MBï¼Œâ€‹<strong>ä¸¥é‡</strong>â€‹&gt;100MBï¼Œâ€‹<strong>ç´§æ€¥</strong>â€‹&gt;1GBï¼ˆå¯èƒ½è§¦å‘å…¨é‡åŒæ­¥ï¼‰ã€‚</p>
<h3 data-id="heading-20">6 ç›‘æ§ç³»ç»Ÿå®æˆ˜éƒ¨ç½²</h3>
<h4 data-id="heading-21">6.1 Prometheus + Grafana ç›‘æ§æ ˆ</h4>
<p>ç°ä»£ç›‘æ§æ¨èä½¿ç”¨ Prometheus é‡‡é›†æ•°æ®ï¼ŒGrafana å±•ç¤ºï¼š</p>
<p>â€‹<strong>éƒ¨ç½² Redis Exporter</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.ymlç¤ºä¾‹</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">redis-exporter:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">oliver006/redis_exporter</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9121:9121"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">REDIS_ADDR=redis://redis:6379</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„ Exporter éƒ¨ç½²</p>
<p>â€‹<strong>Prometheus é…ç½®</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'redis'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'redis-exporter:9121'</span>]
    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„ Prometheus é…ç½®</p>
<h4 data-id="heading-22">6.2 å…³é”®å‘Šè­¦è§„åˆ™é…ç½®</h4>
<p>åŸºäº Prometheus çš„å‘Šè­¦è§„åˆ™ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">groups:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">redis.rules</span>
  <span class="hljs-attr">rules:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisDown</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">up{job="redis"}</span> <span class="hljs-string">==</span> <span class="hljs-number">0</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">1m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">critical</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Rediså®ä¾‹ä¸‹çº¿"</span>
      
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisMemoryUsageHigh</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">(redis_memory_used_bytes</span> <span class="hljs-string">/</span> <span class="hljs-string">redis_memory_max_bytes)</span> <span class="hljs-string">*</span> <span class="hljs-number">100</span> <span class="hljs-string">&gt;</span> <span class="hljs-number">85</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">2m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Rediså†…å­˜ä½¿ç”¨ç‡è¿‡é«˜"</span>
      
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisHitRateLow</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">(rate(redis_keyspace_hits_total[5m])</span> <span class="hljs-string">/</span> <span class="hljs-string">(rate(redis_keyspace_hits_total[5m])</span> <span class="hljs-string">+</span> <span class="hljs-string">rate(redis_keyspace_misses_total[5m])))</span> <span class="hljs-string">*</span> <span class="hljs-number">100</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">90</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">5m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Redisç¼“å­˜å‘½ä¸­ç‡è¿‡ä½"</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„å‘Šè­¦è§„åˆ™</p>
<h3 data-id="heading-23">7 å®¹é‡è§„åˆ’ä¸é¢„è­¦å®æˆ˜</h3>
<h4 data-id="heading-24">7.1 å®¹é‡è§„åˆ’æ–¹æ³•è®º</h4>
<p>æœ‰æ•ˆçš„å®¹é‡è§„åˆ’åŸºäºå†å²æ•°æ®è¶‹åŠ¿åˆ†æï¼Œéœ€è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p>
<p>â€‹<strong>æ•°æ®å¢é•¿è¶‹åŠ¿</strong>â€‹ï¼šåˆ†ææ—¥å¸¸æ•°æ®å¢é‡ï¼Œé¢„æµ‹æœªæ¥å®¹é‡éœ€æ±‚</p>
<p>â€‹<strong>ä¸šåŠ¡å¢é•¿é¢„æœŸ</strong>â€‹ï¼šç»“åˆä¸šåŠ¡è§„åˆ’ï¼Œé¢„ä¼°è®¿é—®é‡å¢é•¿</p>
<p>â€‹<strong>å­£èŠ‚æ€§æ³¢åŠ¨</strong>â€‹ï¼šè¯†åˆ«ä¸šåŠ¡é«˜å³°æœŸï¼Œé¢„ç•™è¶³å¤Ÿç¼“å†²å®¹é‡</p>
<p>å®¹é‡è§„åˆ’å…¬å¼ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">æ‰€éœ€å®¹é‡ = å½“å‰æ•°æ®é‡ Ã— (<span class="hljs-number">1</span> + æœˆå¢é•¿ç‡)^æœˆä»½ + å®‰å…¨ä½™é‡(<span class="hljs-number">20%</span>)
â€‹
</code></pre>
<h4 data-id="heading-25">7.2 é¢„è­¦ç­‰çº§ä¸å“åº”æœºåˆ¶</h4>
<p>å»ºç«‹å¤šçº§é¢„è­¦æœºåˆ¶ï¼Œç¡®ä¿åŠæ—¶å“åº”ï¼š</p>
<p>â€‹<strong>ä¸‰çº§é¢„è­¦ä½“ç³»</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>é»„è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;80%ï¼‰ï¼šç›‘æ§å…³æ³¨ï¼Œæ¯å‘¨å›é¡¾</li>
<li>â€‹<strong>æ©™è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;90%ï¼‰ï¼šç«‹å³åˆ†æï¼Œ3 å¤©å†…å¤„ç†</li>
<li>â€‹<strong>çº¢è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;95%ï¼‰ï¼šç´§æ€¥å¤„ç†ï¼Œç«‹å³æ‰©å®¹</li>
</ul>
<h3 data-id="heading-26">æ€»ç»“</h3>
<p>Redis ç›‘æ§ä¸æ˜¯ç®€å•çš„æ•°æ®æ”¶é›†ï¼Œè€Œæ˜¯é€šè¿‡å…³é”®æŒ‡æ ‡æ´å¯Ÿç³»ç»ŸçŠ¶æ€çš„è‰ºæœ¯ã€‚æœ‰æ•ˆçš„ç›‘æ§ä½“ç³»åº”èšç„¦<strong>å»¶è¿Ÿã€å‘½ä¸­ç‡ã€å†…å­˜ç¢ç‰‡ã€æ…¢æŸ¥è¯¢</strong>ç­‰æ ¸å¿ƒæŒ‡æ ‡ï¼Œå»ºç«‹<strong>å¤šçº§é¢„è­¦</strong>æœºåˆ¶ï¼Œå®ç°ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²çš„è½¬å˜ã€‚</p>
<p>ç›‘æ§çš„ä»·å€¼ä¸ä»…åœ¨äºå®æ—¶å‘Šè­¦ï¼Œæ›´åœ¨äºæä¾›<strong>å®¹é‡è§„åˆ’</strong>çš„æ•°æ®æ”¯æ’‘å’Œ<strong>æ€§èƒ½ä¼˜åŒ–</strong>çš„å†³ç­–ä¾æ®ã€‚é€šè¿‡å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼ŒRedis è¿ç»´å›¢é˜Ÿèƒ½å¤Ÿæå‰å‘ç°æ½œåœ¨é£é™©ï¼Œä¼˜åŒ–èµ„æºé…ç½®ï¼Œç¡®ä¿ç¼“å­˜ç³»ç»ŸæŒç»­ç¨³å®šè¿è¡Œã€‚</p>
<p><strong>ç›‘æ§çš„ç»ˆæç›®æ ‡ä¸æ˜¯æ”¶é›†æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®é©±åŠ¨å†³ç­–ï¼Œå°†é—®é¢˜æ¶ˆç­åœ¨å‘ç”Ÿä¹‹å‰ã€‚</strong></p>
<p><strong>ğŸ“š ä¸‹ç¯‡é¢„å‘Š</strong>â€‹</p>
<p>ã€ŠMQ é€‰å‹æ¡†æ¶â€”â€”Kafka/RabbitMQ/RocketMQ çš„æ¨¡å‹å·®å¼‚ä¸ä¸šåŠ¡åŒ¹é…æ¸…å•ã€‹â€”â€” æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>ğŸ“¨ â€‹<strong>æ¶ˆæ¯æ¨¡å‹å¯¹æ¯”</strong>â€‹ï¼šå‘å¸ƒ-è®¢é˜…ã€ç‚¹å¯¹ç‚¹ã€äº‹åŠ¡æ¶ˆæ¯çš„é€‚ç”¨åœºæ™¯åˆ†æ</li>
<li>ğŸš€ â€‹<strong>ååæ€§èƒ½åŸºå‡†</strong>â€‹ï¼šç™¾ä¸‡çº§æ¶ˆæ¯ååçš„æ¶æ„è®¾è®¡ä¸ä¼˜åŒ–ç­–ç•¥</li>
<li>ğŸ’¾ â€‹<strong>å¯é æ€§ä¿éšœ</strong>â€‹ï¼šæ¶ˆæ¯æŒä¹…åŒ–ã€å‰¯æœ¬åŒæ­¥ä¸æ•…éšœæ¢å¤æœºåˆ¶</li>
<li>ğŸ“Š â€‹<strong>è¿ç»´å¤æ‚åº¦è¯„ä¼°</strong>â€‹ï¼šé›†ç¾¤ç®¡ç†ã€ç›‘æ§å‘Šè­¦ä¸æ‰©å±•æ€§å¯¹æ¯”</li>
<li>ğŸ¯ â€‹<strong>é€‰å‹å†³ç­–çŸ©é˜µ</strong>â€‹ï¼šä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹çš„æŠ€æœ¯é€‰å‹æ ‡å‡†æŒ‡å—</li>
</ul>
<p><strong>â€‹ç‚¹å‡»å…³æ³¨ï¼ŒæŒæ¡æ¶ˆæ¯ä¸­é—´ä»¶é€‰å‹çš„æ ¸å¿ƒæ–¹æ³•è®ºï¼â€‹</strong>â€‹</p>
<blockquote>
<p>â€‹<strong>ä»Šæ—¥è¡ŒåŠ¨å»ºè®®</strong>â€‹ï¼š</p>
<ol>
<li>æ£€æŸ¥ç°æœ‰ Redis ç›‘æ§è¦†ç›–åº¦ï¼Œç¡®ä¿å…³é”®æŒ‡æ ‡æ— é—æ¼</li>
<li>é…ç½®å¤šçº§é¢„è­¦é˜ˆå€¼ï¼Œå»ºç«‹é¢„è­¦å“åº”æµç¨‹</li>
<li>åˆ†æå†å²å®¹é‡æ•°æ®ï¼Œåˆ¶å®šæœªæ¥ 3-6 ä¸ªæœˆæ‰©å®¹è§„åˆ’</li>
<li>å»ºç«‹æ…¢æŸ¥è¯¢å®šæœŸåˆ†ææœºåˆ¶ï¼ŒæŒç»­ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ</li>
</ol>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²]]></title>    <link>https://juejin.cn/post/7585555806667653154</link>    <guid>https://juejin.cn/post/7585555806667653154</guid>    <pubDate>2025-12-21T08:07:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585555806667653154" data-draft-id="7585555806667472930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-21T08:07:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­¦é«˜æ•°å°±çŠ¯å›°"/> <meta itemprop="url" content="https://juejin.cn/user/54353143012724"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/54353143012724/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­¦é«˜æ•°å°±çŠ¯å›°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:07:11.000Z" title="Sun Dec 21 2025 08:07:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ React + Viteï¼šç”¨ Fetch å°† CSV æ–‡ä»¶æ•°æ®è½¬æˆ JSON å­—ç¬¦ä¸²</h2>
<h4 data-id="heading-1">ğŸ• èƒŒæ™¯</h4>
<p>åœ¨ä¸€äº›å°å‹é¡¹ç›®ä¸­ï¼Œå‰ç«¯å¯èƒ½éœ€è¦ç›´æ¥å¤„ç† CSV æ–‡ä»¶æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²åå†è¿›è¡Œé€»è¾‘æ“ä½œå’Œå±•ç¤ºã€‚æœ¬æ–‡å°†ä¼šä»‹ç»ä¸¤ç§æ–¹æ³•ã€‚</p>
<h4 data-id="heading-2">ğŸŒ„ æ–¹æ³•1ï¼šå°† CSV æ”¾åœ¨<code>public</code>ç›®å½•ä¸‹ï¼Œç”¨<code>fetch</code>è¯»å–</h4>
<h5 data-id="heading-3">ä»£ç å®ç°</h5>
<p>å·¥å…·å‡½æ•°ï¼šcsv -&gt; json</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/utils/csvParser.jsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">csvParser</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">{ file }</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> resp = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(file);
    <span class="hljs-keyword">if</span> (!resp.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${resp.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> resp.<span class="hljs-title function_">text</span>(); <span class="hljs-comment">// è½¬æˆæ–‡æœ¬</span>
    <span class="hljs-keyword">const</span> lines = text.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/\r?\n/</span>); <span class="hljs-comment">// æ¯ä¸€è¡Œä½œä¸ºæ•°ç»„ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">const</span> header = lines[<span class="hljs-number">0</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">","</span>); <span class="hljs-comment">// æŠŠè¡¨å¤´å•ç‹¬æå–å‡ºæ¥</span>

    <span class="hljs-keyword">const</span> data = lines.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">line</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> values = line.<span class="hljs-title function_">split</span>(<span class="hljs-string">","</span>); <span class="hljs-comment">// å…·ä½“æ¯ä¸€è¡Œæ•°æ®çš„å€¼</span>
      <span class="hljs-keyword">const</span> row = {}; <span class="hljs-comment">// æœ€ç»ˆæ•°æ®ä¸‹çš„é€è¡Œçš„è½½ä½“</span>
      header.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">h, i</span>) =&gt;</span> {
        row[h] = values[i] ?? <span class="hljs-string">""</span>;
      });
      <span class="hljs-keyword">return</span> row;
    });
    <span class="hljs-keyword">return</span> data;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);
    <span class="hljs-keyword">return</span> [];
  }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> csvParser;
</code></pre>
<p>åœ¨ React ä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/pages/Home.jsx</span>
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { csvParser } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadcsv</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">csvParser</span>({ <span class="hljs-attr">file</span>: <span class="hljs-string">"/testInfo.csv"</span> });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
  };
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">loadcsv</span>();
  }, []);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Home</span>;
</code></pre>
<h5 data-id="heading-4">æ³¨æ„äº‹é¡¹</h5>
<p>æˆ‘ä»¬åº”è¯¥å°†æ‰€éœ€è¦çš„ CSV æ–‡ä»¶æ”¾åœ¨<code>public</code>ç›®å½•ä¸‹è€Œé<code>src/assets</code>ç›®å½•ä¸‹ï¼Œé‡‡å–ç›´æ¥è°ƒç”¨ã€‚</p>
<blockquote>
<p>å½“ CSV æ”¾åœ¨<code>src/assets</code>ä¸‹å¹¶é€šè¿‡<code>import</code>æˆ–æ¨¡å—æ–¹å¼åŠ è½½æ—¶ï¼Œ Vite ä¼šå°†å…¶æ‰“åŒ…æˆæ¨¡å—è·¯å¾„ï¼Œ<code>fetch</code>å®é™…è¯·æ±‚çš„æ˜¯å¼€å‘æœåŠ¡å™¨çš„æ¨¡å—å…¥å£ã€‚å¯¹äºå¤§æ–‡ä»¶ï¼Œè¿™ä¼šå¯¼è‡´è¯·æ±‚å¤´ä¸­åŒ…å«è¿‡å¤šä¿¡æ¯ï¼Œä»è€Œè§¦å‘ 431 é”™è¯¯ã€‚</p>
</blockquote>
<p>P.S. å¦‚æœå¿˜è®°äº†<code>fetch</code>çš„å…·ä½“ç”¨æ³•...<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1ahBwBWEa9%3Fvd_source%3D5efd67697f12ad6e7903bc924c0815ba" target="_blank" title="https://www.bilibili.com/video/BV1ahBwBWEa9?vd_source=5efd67697f12ad6e7903bc924c0815ba" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
<h4 data-id="heading-5">ğŸŒ„ æ–¹æ³•2ï¼šåˆ©ç”¨ Rollup æ’ä»¶ç›´æ¥ <code>import</code> CSV</h4>
<p>ç”±äº Vite çš„åº•å±‚æ„å»ºå¼•æ“åŒ…å« Rollupï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ Rollup çš„å®˜æ–¹æ’ä»¶ç”Ÿæ€æ¥æ‰©å±•åŠŸèƒ½ï¼Œç›´æ¥å°† CSV æ–‡ä»¶ä½œä¸ºæ¨¡å—å¯¼å…¥ã€‚</p>
<h5 data-id="heading-6">ä»£ç å®ç°</h5>
<p>å®‰è£…å¼€å‘ä¾èµ–ï¼š</p>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> -D <span class="hljs-keyword">@rollup</span>/plugin-dsv
</code></pre>
<p>é…ç½®vite</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">"@vitejs/plugin-react"</span>;
<span class="hljs-keyword">import</span> dsv <span class="hljs-keyword">from</span> <span class="hljs-string">"@rollup/plugin-dsv"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;

<span class="hljs-comment">// https://vite.dev/config/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">react</span>(), <span class="hljs-title function_">dsv</span>()],
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">"@"</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"src"</span>),
    },
  },
});
</code></pre>
<p>åœ¨ React ä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/pages/Home.jsx</span>
<span class="hljs-keyword">import</span> data <span class="hljs-keyword">from</span> <span class="hljs-string">"@/assets/testInfo.csv"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Home</span>;
</code></pre>
<h5 data-id="heading-7">æ³¨æ„äº‹é¡¹</h5>
<p>é€‚ç”¨äºå°æ–‡ä»¶ï¼Œè¾ƒå¤§æ–‡ä»¶ã€å…³æ³¨æ€§èƒ½çš„è¯è¿˜æ˜¯æ›´æ¨èä½¿ç”¨ç¬¬ä¸€ç§ã€‚</p>
<h4 data-id="heading-8">ğŸš‰ ç»“è¯­</h4>
<p>åœ¨ React + Vite é¡¹ç›®ä¸­å¤„ç† CSV æ–‡ä»¶æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„åŠ è½½æ–¹å¼éå¸¸é‡è¦ï¼š</p>
<ul>
<li>å°æ–‡ä»¶ï¼šå¯ä»¥ç›´æ¥é€šè¿‡ <code>import</code> å¯¼å…¥ï¼Œå¼€å‘å¿«é€Ÿæ–¹ä¾¿ã€‚</li>
<li>å¤§æ–‡ä»¶ï¼šæ¨èæ”¾åœ¨ <code>public</code> ç›®å½•ï¼Œç”¨ <code>fetch</code> å¼‚æ­¥åŠ è½½ï¼Œå¹¶ç»“åˆåˆ†é¡µæˆ–è™šæ‹Ÿæ¸²æŸ“ï¼Œä¿è¯æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</li>
</ul>
<p>æŒæ¡è¿™ä¸¤ç§æ–¹æ³•åï¼Œä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚çµæ´»å¤„ç†ä¸åŒè§„æ¨¡çš„ CSV æ•°æ®ï¼Œè®©å‰ç«¯æ•°æ®å¤„ç†æ—¢é«˜æ•ˆåˆå®‰å…¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScriptå’ŒJavaScriptåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585502118460571667</link>    <guid>https://juejin.cn/post/7585502118460571667</guid>    <pubDate>2025-12-21T09:54:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585502118460571667" data-draft-id="7585490245007523846" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScriptå’ŒJavaScriptåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-21T09:54:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±ŸåŸå¼€æœ—çš„è±Œè±†"/> <meta itemprop="url" content="https://juejin.cn/user/3307789418773736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScriptå’ŒJavaScriptåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3307789418773736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±ŸåŸå¼€æœ—çš„è±Œè±†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:54:46.000Z" title="Sun Dec 21 2025 09:54:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#36ace1;background-image:linear-gradient(90deg,rgba(217,234,251,.25) 3%,transparent 0),linear-gradient(1turn,rgba(217,234,251,.25) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{color:#36ace1}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"";display:block;position:absolute;left:0;top:0;bottom:0;margin:auto;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAF8UlEQVRIS71Wa2wUVRT+7r0zu9t2t/RBaSioPCpYbIUfaEIQUogSAwZDAlUSGwgg/CBATExMCJH1D2hIfOEjFEUEhViCgBgIUCH44OkjPAMGBVqhpUCfW3Zn5z7MuQOE0hYxMdxJdmd25s53vnO+851leMCLPWA8/CfA2TsvL8n7q+nTFfNLG+4VqInHOeJLDQMzdz/3r4DGGDb9lxu+aPcE7U61JHDMDePcuv0O21ShugOefqDdtBie3Dk6K/O+Ab+qOjJiz7Ahv6c8hbDDwRiQlgYGDOcaWyEcjg8On+j71IpJndjGt9XO+jM7+pkywNvbazIfercieSdoJ4bE5sWjyZqMpDdeaQNXMNC34ME3LV8B56+1w3AOgk+EXe/Ub6uiLB6XdH/G/mYjeBCcFwnt3zQqWt4t4NjjnhzQ1CGkBhwOCMFAB71U0qsYgRlwBtQ1tiEJAy44OBdQUmFK3aWS06NLT+ukZAQoKCCjsfbDmk6p78RwX3ncWffmIj8U4kh6GpEwh+9rGy23LDU4GBrrm9DsuDYIGMAYIC/EUNQ7Cq1hn+WM2TI8f+jEyCmvjfn1FssuojHx6tDkyZOaCzr8TNpASzDAk8amlRIrEylcSGsYrcGIstIYWhgDDIM2BiGH3ywFkGAC1U9n38bpVqWGdk6r4HMWrZZaG1D5KLn0qYyBEAKnG1otAxLR8L7Z9nfP13CJHQ/ST4vK8sVHe8JsU0U6uO5hlexo8PI7vNDQomwoBRAwpSmtgJAAztS3QLsOsmBQlBtFJMQhlbbPUBBUR7o2hqHVddLbRsfCPQJ+u3TPw8uGl1yklAlHIJZKo3//XEhlLCtifPFyM7xwCI/lZ8IKTTBbS7pPLIggZZsSQ+zXbT4UYSsnet3UMM5HPT5LGbrDGYQroClyT2Jwnyj9aN949e8mDCwuRFoqKxRHUJ21BSDRELuQYGhvbMVV32Dp2RuxcfHSRBfAYTsbU9nJdFj5EiLkglHkRInC1xoxKbH9hQJIaTDvxxTCUddWl4wg0dCCtqSPDmoVx4Eitpxh64ZtsT6b5ie6pPRkfF90TllxOzEwmipMKRRgHODGgCuJkqIcvDdC2BZ5Y+tlHHMzkAKghbAxcQqQDiKrFBxhqg5MHTivS1tQ+sdsvaQl5Yd6yfdRXNQLsQwXnq/AQFLXEIIjzBSuNaaR0SuEtkQKl9IKjAsbJaWfzo1USDsM6zceDJfeVGgnhhN2N7YOyo5kJz1pa2AbgfrO1gRwXW6vSRQNtddR+EhvKGmseskgTtY2Q7kucYWWgToPHzyUyXry0iXfnBtfl5f/PaWPvPNW/zkOAQegJHltFE5dSaCskHqPVEnqpMAMEgkPtR1pKxyh/N0/vTToubtH1G3RmLjhM8ubKXfWB2mRa9ySOaWS2uT8lTZ0cI6I52Ngv7zAbW9mQVm1cpytu441P38XeXTlQu+e46nyh+bjLkMZRU0MCYTCJWZSG1y7cBWNURpxBlxqFBfEwGnGGhaYPSNwhpSv4DK+/vPynBk9MqRIiOWs8a2WJTm9a+cgh6SaMIMz9W1WjYHHMtv0wSmZdWB9gdsya/rcYVg7JoffCdqlD6ceTpiY59tM0PhJp5WNvra+BQkejCMyBarr8KKYDcZi8sDaCDKYFIGRk+FnSVXzyTO9JxBwF8DLc1dlLn65ooNEYN0fBsu21fTvL6PXnhxXlnLIqqhYYBian4lQ2Lk9ogiALsimiLC1QYfhlV1Hnxh7JfcMqxrpd7U2GFa5t9nOd7Kr+kg4uWvnCpromlJeXlq3Os3ZLOlrZBmNQf1ybVqpxhbA7mRIOCy1+esDOWhIyDv/+3Q7LRbsqH+rKRJ+nba+/+WW7II1s9vvVBuNr7KNF1WUM1bSt5f1Vq01jUVkKfnx8uoti3Or5rbd9782M61azJz/rFywYU/OyKqK1p5G2MS1Z18tGFDwTkvIxcK9RwaMP3a9/tbc62lPj/Nw5B9ey9Ehy/MY4oEqelgNleuyCgdXJlmc3fO5Ll56r5f+n/f+AWFf9jvBgaHpAAAAAElFTkSuQmCC);animation:spin 2s linear 1s infinite}.markdown-body h1{position:relative;font-size:30px;padding:12px 38px;margin:30px 0}.markdown-body h1:before{width:30px;height:30px;background-size:30px 30px}.markdown-body h2{position:relative;font-size:24px;padding:12px 36px;margin:28px 0}.markdown-body h2:before{width:28px;height:28px;background-size:28px 28px}.markdown-body h3{position:relative;font-size:18px;padding:4px 32px;margin:26px 0}.markdown-body h3:before{width:24px;height:24px;background-size:24px 24px}.markdown-body h4{position:relative;padding:4px 28px;font-size:16px;margin:22px 0}.markdown-body h4:before{width:20px;height:20px;background-size:20px 20px}.markdown-body h5{position:relative;padding:4px 26px;font-size:15px;margin:20px 0}.markdown-body h5:before{width:18px;height:18px;background-size:18px 18px}.markdown-body h6{position:relative;padding:4px 22px;font-size:14px;margin:16px 0}.markdown-body h6:before{width:16px;height:16px;background-size:16px 16px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#36ace1,#dff0fe,#36ace1);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:50px;height:24px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAEgElEQVRIS72Va0xbZRjH/z2FcimbchEQFDYRCIRAAWFQ2MaCXBwmUxYDLGGEcRFkH9wmk04zG0Bo2dwNIisERANqhjqdEmhd4nRbuwpsXDYWLLoRgeG4Chu9QHvMOQ0dpTAKH3y/tDnv8/5/z/Oc//scBv6nxdgoJ14gVYPEuITHdTdHY12gRIH0T0KljlqwthqUFHGtzAEsxqwLtPvkdc+FeeI3BgMeAMEhdOqR1mM7xswBrgmKE8pfIUhtm7fbZsft/i7wc98MtrUFxmbU6ByYgFwxjtFp5Q+WpF1mCy9wajXoqqD4E91saOf603e+5B7t99xTkyZJEiKJAl2DE9Xio1HvrBS8IuhVwVUP503swdJ9QWAw1izaoDs6pQT/655BMS9yy3KYiUoM/7adu7NmtnQfx5zWm8Q8Ui3gyGcddyU8rv/STRNQouDGP5/mhTubX4dpPv3DMzh1qS9LwuPWr+i63WVyn5QYj/4d/i4bqmbpoQ+auvBlQYghX6PE4wTSOzV5EUYlb5Q4MDqLk9/3cMRF27spDSNQamUnWZ4ebNB+OKNCyYVeFCZ5wZ5tiePN/UiP2YoQL0cUX+iFt4sNUiLdcaVvHJLecQiWnKVE8s5LvxAXRWeYgHLre0hecgAN0sxr0XBZgbJUP6OiLnaM4ivZCBrzOWBZEIY9rY5E8pl2nM0KMzzLq5aPiXmRzgbQm2VyR8KGGK/ICAFB6IusbvsDwhRf+n/jtSHc/nsGgjR9V6/1TyLa1wGU+FtnO1CbHQTHTSzIFJOYJ1jwcGLTccMTcyhp7oW4KFJ/SV4/IScrc55kQj07WNuOn94Lpw8kCm/Qv3W5HLjbWxsyfuNUO1TzWjAJBloKt2FBS+Jz6ShiA12NupBdLWugQcmn28lPMkONNql3U5cTSD9Lq+qEUqPFt++G0aKL687wDAqb+pAU7IKCuK2493AOPQ9UCNpib6T1tkg+RZ9KKJcNn8sJc1vac8o16jklLWLuOiDqwvHUIKPw7vtTON+iCDKkl/Cx9FeSYET5um1mHt6jN0Dz9ftwYjORudNjTdaBmi7kxvvA1d6Gjs0X/Q5Sp3tMEMSHre9HnDEZAPFCWUNVdliGJVPvqEP1Hbh4yPj9LadSY6fu6gPsCX+B3mq7NYLv2od8fj4aoViMNQGFijos/XVMTXGavgUisQIle71hwVx9KFEutLVjw8GORTuxoEbeJS7iPrmQyy/sIj2hQpqYHO7ZGs95nnZS4y8K8Pfqrb58UZ+IlKqbqNgfQm8da+pC9xjLqo8foFkau2qaCeXSyvzXfA9SDrp1bxJ/DU/jSJKXEWdBR2J/9U0UpwXTFZ/+8S76h/71FvO4A8sTeuqQThDKalOiPLN3BbhiYlaNsm964elkCztrC4xMqeDqYIus2JdB3cbS5l4MTag44qJt9GxbF4gKThRKY59lW13+KCUQ1pZMEwHKviKx4pFSqXzxCn/X9Gr2NO+zw+cTiTbxmUyCqH3GlsWg2kRNhOnHmhlrFkIvHTZt1borWvMCmRnwH4usn58STiycAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body del{color:#36ace1}.markdown-body code{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#282c34;color:#4ec9b0;padding:.24em .46em;margin:0 4px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-family:Menlo,Monaco,Consolas,Courier New,monospace;font-size:12px;border-radius:10px;padding:15px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#4ec9b0;background:#282c34}.markdown-body a{text-decoration:none;color:#409eff;border-bottom:1px solid #409eff}.markdown-body a:active,.markdown-body a:hover{color:#007bff;border-bottom:1px solid #007bff}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;padding:8px 26px;background-color:rgba(54,172,225,.75);margin:16px 0;border-left:4px solid #409eff;border-radius:5px}.markdown-body blockquote:before{content:"â";top:10px;left:8px;color:#409eff;font-size:20px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:20px;position:absolute;right:8px;bottom:0;color:#409eff;opacity:.7}.markdown-body blockquote&gt;p{color:#fff}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸¤ç§è¯­è¨€çš„æœ¬è´¨å…³ç³»ï¼šä»è‡ªç”±å¥”æ”¾åˆ°ä¸¥è°¨è§„åˆ’</h2>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¾„æ¸…ä¸€ä¸ªæœ€å¸¸è§çš„è¯¯è§£ï¼š<strong>TypeScriptä¸æ˜¯JavaScriptçš„æ›¿ä»£å“ï¼Œè€Œæ˜¯å®ƒçš„è¶…é›†</strong>ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œæ‰€æœ‰åˆæ³•çš„JavaScriptä»£ç éƒ½æ˜¯åˆæ³•çš„TypeScriptä»£ç ã€‚ä½†TypeScriptåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿå’Œå…¶ä»–ç°ä»£è¯­è¨€ç‰¹æ€§ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼š</p>
<ul>
<li><strong>JavaScript</strong>Â å°±åƒä¸€ä¸ªè‡ªç”±å¥”æ”¾çš„è‰ºæœ¯å®¶ï¼Œå¯ä»¥åœ¨ç”»å¸ƒä¸Šéšæ„æŒ¥æ´’ï¼Œä¸æ‹˜ä¸€æ ¼</li>
<li><strong>TypeScript</strong>Â åˆ™åƒæ˜¯è¿™ä½è‰ºæœ¯å®¶å†³å®šéµå¾ªä¸€å¥—å»ºç­‘è“å›¾ï¼Œè®©åˆ›ä½œæ›´åŠ ç»“æ„åŒ–å’Œå¯é¢„æµ‹</li>
</ul>
<h2 data-id="heading-1">æ ¸å¿ƒåŒºåˆ«ï¼šç±»å‹ç³»ç»Ÿçš„é­”åŠ›</h2>
<h3 data-id="heading-2">æ— ç±»å‹ vs é™æ€ç±»å‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹è¿™ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JavaScriptç‰ˆæœ¬ï¼šè‡ªç”±ä½†å±é™©</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-params">price, quantity</span>) {
    <span class="hljs-keyword">return</span> price * quantity;
}

<span class="hljs-comment">// è¿™è¡Œä»£ç èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†ç»“æœå¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„</span>
<span class="hljs-keyword">const</span> total = <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-string">"100"</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// è¿”å› "100100100"</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// TypeScriptç‰ˆæœ¬ï¼šæ˜ç¡®ä¸”å®‰å…¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-params">price: number, quantity: number</span>): number {
    <span class="hljs-keyword">return</span> price * quantity;
}

<span class="hljs-comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šåœ¨ç¼–è¯‘æ—¶å°±æŠ¥é”™</span>
<span class="hljs-keyword">const</span> total = <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-string">"100"</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼šArgument of type 'string' is not assignable to parameter of type 'number'</span>
</code></pre>
<p>çœ‹å‡ºåŒºåˆ«äº†å—ï¼Ÿ<strong>TypeScriptåœ¨ä½ å†™ä»£ç çš„æ—¶å€™å°±ä¼šæ£€æŸ¥ç±»å‹é”™è¯¯</strong>ï¼Œè€ŒJavaScriptè¦åˆ°è¿è¡Œæ—¶æ‰ä¼šå‘ç°é—®é¢˜ã€‚</p>
<h3 data-id="heading-3">æ¥å£å’Œç±»å‹å®šä¹‰</h3>
<p>TypeScriptæœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯æ¥å£ï¼ˆInterfaceï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®šä¹‰ç”¨æˆ·æ¥å£</span>
interface <span class="hljs-title class_">User</span> {
    <span class="hljs-attr">id</span>: number;
    <span class="hljs-attr">name</span>: string;
    <span class="hljs-attr">email</span>: string;
    age?: number; <span class="hljs-comment">// å¯é€‰å±æ€§</span>
}

<span class="hljs-comment">// ä½¿ç”¨æ¥å£</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createUser</span>(<span class="hljs-params">userData: User</span>): <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">name</span>: userData.<span class="hljs-property">name</span>,
        <span class="hljs-attr">email</span>: userData.<span class="hljs-property">email</span>,
        <span class="hljs-attr">age</span>: userData.<span class="hljs-property">age</span> || <span class="hljs-number">25</span>
    };
}

<span class="hljs-comment">// TypeScriptä¼šæ£€æŸ¥æˆ‘æ˜¯å¦æä¾›äº†æ‰€æœ‰å¿…éœ€çš„å±æ€§</span>
<span class="hljs-keyword">const</span> newUser = <span class="hljs-title function_">createUser</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"zhangsan@example.com"</span>
});
</code></pre>
<h2 data-id="heading-4">å¼€å‘ä½“éªŒå¯¹æ¯”ï¼šå†™ä»£ç æ—¶çš„ä¸åŒæ„Ÿå—</h2>
<h3 data-id="heading-5">æ™ºèƒ½æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨</h3>
<p>ä½¿ç”¨TypeScriptæ—¶ï¼ŒIDEèƒ½å¤Ÿæä¾›æå…¶ç²¾å‡†çš„æ™ºèƒ½æç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">interface <span class="hljs-title class_">Product</span> {
    <span class="hljs-attr">id</span>: number;
    <span class="hljs-attr">name</span>: string;
    <span class="hljs-attr">price</span>: number;
    <span class="hljs-attr">inStock</span>: boolean;
}

<span class="hljs-keyword">const</span> <span class="hljs-attr">product</span>: <span class="hljs-title class_">Product</span> = {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘"</span>,
    <span class="hljs-attr">price</span>: <span class="hljs-number">7999</span>,
    <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span>
};

<span class="hljs-comment">// å½“æˆ‘è¾“å…¥"product."æ—¶ï¼ŒIDEä¼šæç¤ºæ‰€æœ‰å¯ç”¨çš„å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(product.<span class="hljs-property">name</span>); <span class="hljs-comment">// IDEçŸ¥é“è¿™æ˜¯stringç±»å‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(product.<span class="hljs-property">price</span>); <span class="hljs-comment">// IDEçŸ¥é“è¿™æ˜¯numberç±»å‹</span>
<span class="hljs-comment">// console.log(product.description); // ç¼–è¯‘é”™è¯¯ï¼šå±æ€§'description'ä¸å­˜åœ¨</span>
</code></pre>
<h3 data-id="heading-6">é‡æ„æ—¶çš„å®‰å¿ƒæ„Ÿ</h3>
<p>åœ¨å¤§é¡¹ç›®ä¸­é‡æ„ä»£ç æ—¶ï¼ŒTypeScriptæä¾›çš„å®‰å…¨ä¿éšœæ˜¯æ— ä»·çš„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‡è®¾æˆ‘è¦ä¿®æ”¹APIå“åº”ç»“æ„</span>
interface <span class="hljs-title class_">ApiResponse</span>&lt;T&gt; {
    <span class="hljs-attr">success</span>: boolean;
    <span class="hljs-attr">data</span>: T;
    <span class="hljs-attr">timestamp</span>: string;
    <span class="hljs-comment">// æ–°å¢å­—æ®µ</span>
    requestId?: string;
}

<span class="hljs-comment">// TypeScriptä¼šå‘Šè¯‰æˆ‘æ‰€æœ‰éœ€è¦æ›´æ–°çš„åœ°æ–¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processResponse</span>(<span class="hljs-params">response: ApiResponse&lt;User&gt;</span>) {
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>.<span class="hljs-property">name</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">requestId</span>); <span class="hljs-comment">// æˆ‘çŸ¥é“è¿™æ˜¯å¯é€‰å­—æ®µ</span>
    }
}
</code></pre>
<h2 data-id="heading-7">å®æˆ˜åœºæ™¯ï¼šä»JavaScriptè¿ç§»åˆ°TypeScript</h2>
<p>è®©æˆ‘åˆ†äº«ä¸€ä¸ªå®é™…çš„è¿ç§»ç»éªŒã€‚æˆ‘æ›¾ç»ç»´æŠ¤ä¸€ä¸ªä¸­å‹ç”µå•†é¡¹ç›®ï¼Œæœ€åˆä½¿ç”¨çº¯JavaScriptå¼€å‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸæ¥çš„JavaScriptä»£ç </span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addToCart</span>(<span class="hljs-params">item, quantity</span>) {
    <span class="hljs-comment">// itemæ˜¯ä»€ä¹ˆç»“æ„ï¼Ÿquantityåº”è¯¥æ˜¯æ•°å­—å—ï¼Ÿ</span>
    cart.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>({ item, quantity });
    <span class="hljs-title function_">updateCartTotal</span>();
}
</code></pre>
<p>è¿ç§»åˆ°TypeScriptåï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// TypeScriptç‰ˆæœ¬</span>
interface <span class="hljs-title class_">CartItem</span> {
    <span class="hljs-attr">id</span>: number;
    <span class="hljs-attr">name</span>: string;
    <span class="hljs-attr">price</span>: number;
    <span class="hljs-attr">category</span>: string;
}

interface <span class="hljs-title class_">CartEntry</span> {
    <span class="hljs-attr">item</span>: <span class="hljs-title class_">CartItem</span>;
    <span class="hljs-attr">quantity</span>: number;
    <span class="hljs-attr">addedAt</span>: <span class="hljs-title class_">Date</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">addToCart</span>(<span class="hljs-params">item: CartItem, quantity: number</span>): <span class="hljs-keyword">void</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">cartEntry</span>: <span class="hljs-title class_">CartEntry</span> = {
        item,
        quantity,
        <span class="hljs-attr">addedAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
    };
    
    cart.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>(cartEntry);
    <span class="hljs-title function_">updateCartTotal</span>();
}
</code></pre>
<p>è¿ç§»è¿‡ç¨‹è™½ç„¶éœ€è¦ä¸€äº›é¢å¤–å·¥ä½œï¼Œä½†å›æŠ¥æ˜¯å·¨å¤§çš„ï¼š</p>
<ol>
<li>ä»£ç é”™è¯¯å‡å°‘äº†çº¦40%</li>
<li>æ–°æˆå‘˜ä¸Šæ‰‹æ—¶é—´ç¼©çŸ­äº†50%</li>
<li>é‡æ„æ—¶çš„ä¿¡å¿ƒå¤§å¤§å¢å¼º</li>
</ol>
<h2 data-id="heading-8">å­¦ä¹ æ›²çº¿å’Œæˆæœ¬è€ƒé‡</h2>
<h3 data-id="heading-9">TypeScriptçš„å­¦ä¹ æˆæœ¬</h3>
<p>æ˜¯çš„ï¼ŒTypeScriptéœ€è¦å­¦ä¹ ä¸€äº›æ–°æ¦‚å¿µï¼š</p>
<ul>
<li>ç±»å‹æ³¨è§£</li>
<li>æ¥å£å’Œç±»å‹åˆ«å</li>
<li>æ³›å‹</li>
<li>æšä¸¾</li>
<li>è£…é¥°å™¨ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p>ä½†å¯¹äºæœ‰JavaScriptåŸºç¡€çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™äº›æ¦‚å¿µå¹¶ä¸éš¾æŒæ¡ã€‚æˆ‘å»ºè®®ä»ç®€å•çš„ç±»å‹æ³¨è§£å¼€å§‹ï¼Œé€æ­¥æ·±å…¥ã€‚</p>
<h3 data-id="heading-10">é¡¹ç›®ä¸­çš„æˆæœ¬æ•ˆç›Šåˆ†æ</h3>
<p>åœ¨ä¸­å°å‹é¡¹ç›®ä¸­ï¼Œçº¯JavaScriptå¯èƒ½æ›´å¿«é€Ÿçµæ´»ã€‚ä½†åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ï¼ŒTypeScriptçš„ä¼˜åŠ¿æ˜æ˜¾ï¼š</p>
<ol>
<li><strong>å›¢é˜Ÿåä½œé¡¹ç›®</strong>ï¼šç±»å‹ç³»ç»Ÿä½œä¸ºæ–‡æ¡£ï¼Œå‡å°‘æ²Ÿé€šæˆæœ¬</li>
<li><strong>å¤§å‹å¤æ‚åº”ç”¨</strong>ï¼šæå‰å‘ç°æ½œåœ¨é”™è¯¯</li>
<li><strong>é•¿æœŸç»´æŠ¤é¡¹ç›®</strong>ï¼šä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§æ›´å¥½</li>
<li><strong>å…¬å…±åº“å¼€å‘</strong>ï¼šæä¾›æ›´å¥½çš„å¼€å‘è€…ä½“éªŒ</li>
</ol>
<h2 data-id="heading-11">æˆ‘çš„å®ç”¨å»ºè®®</h2>
<p>ç»è¿‡å¤šå¹´çš„å®è·µï¼Œæˆ‘æ€»ç»“äº†ä¸€äº›å»ºè®®ï¼š</p>
<ol>
<li><strong>æ–°é¡¹ç›®ä¼˜å…ˆè€ƒè™‘TypeScript</strong>ï¼Œç‰¹åˆ«æ˜¯å›¢é˜Ÿé¡¹ç›®</li>
<li><strong>è€é¡¹ç›®é€æ­¥è¿ç§»</strong>ï¼Œå¯ä»¥ä»é…ç½®æ–‡ä»¶å¼€å§‹ï¼Œé€ä¸ªæ¨¡å—è½¬æ¢</li>
<li><strong>ä¸è¦è¿‡åº¦ä½¿ç”¨é«˜çº§ç‰¹æ€§</strong>ï¼Œä¿æŒä»£ç ç®€æ´æ˜“æ‡‚</li>
<li><strong>ç»“åˆå…·ä½“ä¸šåŠ¡åœºæ™¯é€‰æ‹©</strong>ï¼Œç®€å•çš„å·¥å…·è„šæœ¬å¯èƒ½ä¸éœ€è¦TypeScript</li>
</ol>
<h2 data-id="heading-12">æ€»ç»“ï¼šé€‰æ‹©åˆé€‚çš„å·¥å…·</h2>
<p>å›åˆ°æœ€åˆçš„é—®é¢˜ï¼šTypeScriptå’ŒJavaScriptæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæˆ‘è®¤ä¸ºæœ€æ ¸å¿ƒçš„åŒºåˆ«æ˜¯ï¼š</p>
<p><strong>JavaScriptç»™ä½ è‡ªç”±ï¼ŒTypeScriptç»™ä½ å®‰å…¨å’Œç»“æ„ã€‚</strong></p>
<p>ä½œä¸ºä¸€åå¼€å‘è€…ï¼Œæˆ‘çš„é€‰æ‹©é€šå¸¸æ˜¯ï¼š</p>
<ul>
<li>å°å‹è„šæœ¬ã€åŸå‹éªŒè¯ã€å­¦ä¹ å®éªŒ â†’ JavaScript</li>
<li>ä¼ä¸šçº§åº”ç”¨ã€å›¢é˜Ÿåä½œã€é•¿æœŸç»´æŠ¤é¡¹ç›® â†’ TypeScript</li>
</ul>
<p>ä¸¤ç§è¯­è¨€å„æœ‰é€‚ç”¨åœºæ™¯ï¼Œç†è§£å®ƒä»¬çš„å·®å¼‚ä¸æ˜¯ä¸ºäº†äº‰è®ºå­°ä¼˜å­°åŠ£ï¼Œè€Œæ˜¯ä¸ºäº†åœ¨åˆé€‚çš„åœºæ™¯ä½¿ç”¨åˆé€‚çš„å·¥å…·ã€‚</p>
<p>åœ¨2024å¹´çš„å‰ç«¯å¼€å‘ä¸­ï¼ŒTypeScriptå·²ç»æˆä¸ºè®¸å¤šå›¢é˜Ÿçš„æ ‡å‡†é€‰æ‹©ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€JavaScriptä¼šæ¶ˆå¤±â€”â€”å®ƒä»¬å°†é•¿æœŸå…±å­˜ï¼Œå„è‡ªåœ¨é€‚åˆçš„é¢†åŸŸå‘å…‰å‘çƒ­ã€‚</p>
<p><strong>çœŸæ­£çš„æŠ€æœ¯é€‰æ‹©ï¼Œä¸åœ¨äºè¿½æ±‚æœ€æ–°æœ€çƒ­ï¼Œè€Œåœ¨äºæ‰¾åˆ°æœ€é€‚åˆå½“å‰é—®é¢˜å’Œå›¢é˜Ÿçš„å·¥å…·ã€‚</strong> Â è¿™å°±æ˜¯æˆ‘ä»å…­å¹´å¼€å‘ç»éªŒä¸­å­¦åˆ°çš„æœ€é‡è¦çš„ä¸€è¯¾ã€‚</p>
<hr/>
<p><em>å°æ¨çš„å®è·µå¿ƒå¾—ï¼šæ— è®ºé€‰æ‹©å“ªç§è¯­è¨€ï¼Œä¿æŒä»£ç æ¸…æ™°ã€å¯ç»´æŠ¤æ‰æ˜¯æœ€é‡è¦çš„ã€‚æŠ€æœ¯åªæ˜¯å·¥å…·ï¼Œè§£å†³é—®é¢˜æ‰æ˜¯ç›®çš„ã€‚</em></p>
<h2 data-id="heading-13">â­ Â å†™åœ¨æœ€å</h2>
<blockquote>
<p>è¯·å¤§å®¶ä¸åèµæ•™,åœ¨ä¸‹æ–¹è¯„è®ºæˆ–è€…ç§ä¿¡æˆ‘,ååˆ†æ„Ÿè°¢ğŸ™ğŸ™ğŸ™.</p>
<p>âœ… è®¤ä¸ºæˆ‘æŸä¸ªéƒ¨åˆ†çš„è®¾è®¡è¿‡äºç¹ç,æœ‰æ›´åŠ ç®€å•æˆ–è€…æ›´é«˜é€¼æ ¼çš„å°è£…æ–¹å¼</p>
<p>âœ… è®¤ä¸ºæˆ‘éƒ¨åˆ†ä»£ç è¿‡äºè€æ—§,å¯ä»¥æä¾›æ–°çš„APIæˆ–æœ€æ–°è¯­æ³•</p>
<p>âœ… å¯¹äºæ–‡ç« ä¸­éƒ¨åˆ†å†…å®¹ä¸ç†è§£</p>
<p>âœ… è§£ç­”æˆ‘æ–‡ç« ä¸­ä¸€äº›ç–‘é—®</p>
<p>âœ… è®¤ä¸ºæŸäº›äº¤äº’,åŠŸèƒ½éœ€è¦ä¼˜åŒ–,å‘ç°BUG</p>
<p>âœ… æƒ³è¦æ·»åŠ æ–°åŠŸèƒ½,å¯¹äºæ•´ä½“çš„è®¾è®¡,å¤–è§‚æœ‰æ›´å¥½çš„å»ºè®®</p>
<p>âœ… ä¸€èµ·æ¢è®¨æŠ€æœ¯åŠ qqäº¤æµç¾¤ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fqm.qq.com%2Fcgi-bin%2Fqm%2Fqr%3Fk%3DP2hE4MESJEHOwpBFPrAME1oTKqsLcA4m%26jump_from%3Dwebapi%26authKey%3DwuPbPtFsfgSInZP%2F9I9dSY7rhk9PScl6h6rUFUFtV4KOZY%2F%2B2D0xiqXSWRuYZs2f" target="_blank" title="https://qm.qq.com/cgi-bin/qm/qr?k=P2hE4MESJEHOwpBFPrAME1oTKqsLcA4m&amp;jump_from=webapi&amp;authKey=wuPbPtFsfgSInZP/9I9dSY7rhk9PScl6h6rUFUFtV4KOZY/+2D0xiqXSWRuYZs2f" ref="nofollow noopener noreferrer">906392632</a></p>
<p>æœ€åæ„Ÿè°¢å„ä½çš„è€å¿ƒè§‚çœ‹ï¼Œæ—¢ç„¶éƒ½åˆ°è¿™äº†ï¼Œç‚¹ä¸ª ğŸ‘èµå†èµ°å§ï¼<br/>
</p>
</blockquote>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e6b3cb3a7c1476b83e30eea13e97bc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5Z-O5byA5pyX55qE6LGM6LGG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915686&amp;x-signature=EtbTE8uRI9OQCG%2B5zIWhfF9Xq5E%3D" alt="" loading="lazy"/>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘ä»¬æ¥è¯´è¯´ ThreadLocal çš„åŸç†ï¼Œä½¿ç”¨åœºæ™¯åŠå†…å­˜æ³„æ¼é—®é¢˜]]></title>    <link>https://juejin.cn/post/7585727457472299008</link>    <guid>https://juejin.cn/post/7585727457472299008</guid>    <pubDate>2025-12-21T08:15:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472299008" data-draft-id="7585693761532510242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘ä»¬æ¥è¯´è¯´ ThreadLocal çš„åŸç†ï¼Œä½¿ç”¨åœºæ™¯åŠå†…å­˜æ³„æ¼é—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-21T08:15:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°å‡"/> <meta itemprop="url" content="https://juejin.cn/user/2285197690931932"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘ä»¬æ¥è¯´è¯´ ThreadLocal çš„åŸç†ï¼Œä½¿ç”¨åœºæ™¯åŠå†…å­˜æ³„æ¼é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2285197690931932/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°å‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:15:46.000Z" title="Sun Dec 21 2025 08:15:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€æ ¸å¿ƒåŸç†</h3>
<h4 data-id="heading-1">1. <strong>æ•°æ®å­˜å‚¨ç»“æ„</strong></h4>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">// æ¯ä¸ª Thread å¯¹è±¡å†…éƒ¨éƒ½æœ‰ä¸€ä¸ª ThreadLocalMap</span>
<span class="hljs-type">ThreadLocal</span>.<span class="hljs-type">ThreadLocalMap</span> threadLocals = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// ThreadLocalMap å†…éƒ¨ä½¿ç”¨ Entry æ•°ç»„ï¼ŒEntry ç»§æ‰¿è‡ª WeakReference&lt;ThreadLocal&lt;?&gt;&gt;</span>
static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WeakReference&lt;ThreadLocal&lt;?&gt;&gt;</span> </span>{
    <span class="hljs-type">Object</span> value;
    <span class="hljs-type">Entry</span>(<span class="hljs-type">ThreadLocal</span>&lt;?&gt; k, <span class="hljs-type">Object</span> v) {
        <span class="hljs-keyword">super</span>(k);  <span class="hljs-comment">// å¼±å¼•ç”¨æŒ‡å‘ ThreadLocal å®ä¾‹</span>
        value = v; <span class="hljs-comment">// å¼ºå¼•ç”¨æŒ‡å‘å®é™…å­˜å‚¨çš„å€¼</span>
    }
}
</code></pre>
<h4 data-id="heading-2">2. <strong>å…³é”®è®¾è®¡</strong></h4>
<ul>
<li><strong>çº¿ç¨‹éš”ç¦»</strong>ï¼šæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ ThreadLocalMap å‰¯æœ¬</li>
<li><strong>å“ˆå¸Œè¡¨ç»“æ„</strong>ï¼šä½¿ç”¨å¼€æ”¾åœ°å€æ³•è§£å†³å“ˆå¸Œå†²çª</li>
<li><strong>å¼±å¼•ç”¨é”®</strong>ï¼šEntry çš„ keyï¼ˆThreadLocal å®ä¾‹ï¼‰æ˜¯å¼±å¼•ç”¨</li>
<li><strong>å»¶è¿Ÿæ¸…ç†</strong>ï¼šset / get æ—¶è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ¡ç›®</li>
</ul>
<h3 data-id="heading-3">äºŒã€æºç åˆ†æ</h3>
<h4 data-id="heading-4">1. <strong>set() æ–¹æ³•æµç¨‹</strong></h4>
<pre><code class="hljs language-ini" lang="ini">public void set(T value) {
    Thread <span class="hljs-attr">t</span> = Thread.currentThread()<span class="hljs-comment">;</span>
    ThreadLocalMap <span class="hljs-attr">map</span> = getMap(t)<span class="hljs-comment">;</span>
    if (map != null) {
        map.set(this, value)<span class="hljs-comment">;  // thisæŒ‡å½“å‰ThreadLocalå®ä¾‹</span>
    } else {
        createMap(t, value)<span class="hljs-comment">;</span>
    }
}

private void set(ThreadLocal&lt;?&gt; key, Object value) {
    Entry<span class="hljs-section">[]</span> <span class="hljs-attr">tab</span> = table<span class="hljs-comment">;</span>
    int <span class="hljs-attr">len</span> = tab.length<span class="hljs-comment">;</span>
    int <span class="hljs-attr">i</span> = key.threadLocalHashCode &amp; (len-<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>

    // éå†æŸ¥æ‰¾åˆé€‚çš„ä½ç½®
    for (Entry <span class="hljs-attr">e</span> = tab[i]<span class="hljs-comment">; e != null; e = tab[i = nextIndex(i, len)]) {</span>
        ThreadLocal&lt;?&gt; <span class="hljs-attr">k</span> = e.get()<span class="hljs-comment">;</span>

        // æ‰¾åˆ°ç›¸åŒçš„keyï¼Œç›´æ¥æ›¿æ¢value
        if (<span class="hljs-attr">k</span> == key) {
            <span class="hljs-attr">e.value</span> = value<span class="hljs-comment">;</span>
            return<span class="hljs-comment">;</span>
        }

        // keyå·²è¢«å›æ”¶ï¼Œæ›¿æ¢è¿‡æœŸæ¡ç›®
        if (<span class="hljs-attr">k</span> == null) {
            replaceStaleEntry(key, value, i)<span class="hljs-comment">;</span>
            return<span class="hljs-comment">;</span>
        }
    }

    tab<span class="hljs-section">[i]</span> = new Entry(key, value)<span class="hljs-comment">;</span>
    int <span class="hljs-attr">sz</span> = ++size<span class="hljs-comment">;</span>
    // æ¸…ç†å¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹
    if (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)
        rehash()<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-5">2. <strong>get() æ–¹æ³•æµç¨‹</strong></h4>
<pre><code class="hljs language-ini" lang="ini">public T get() {
    Thread <span class="hljs-attr">t</span> = Thread.currentThread()<span class="hljs-comment">;</span>
    ThreadLocalMap <span class="hljs-attr">map</span> = getMap(t)<span class="hljs-comment">;</span>
    if (map != null) {
        ThreadLocalMap.Entry <span class="hljs-attr">e</span> = map.getEntry(this)<span class="hljs-comment">;</span>
        if (e != null) {
            @SuppressWarnings("unchecked")
            T <span class="hljs-attr">result</span> = (T)e.value<span class="hljs-comment">;</span>
            return result<span class="hljs-comment">;</span>
        }
    }
    return setInitialValue()<span class="hljs-comment">;  // è¿”å›åˆå§‹å€¼</span>
}
</code></pre>
<h3 data-id="heading-6">ä¸‰ã€ä½¿ç”¨åœºæ™¯</h3>
<h4 data-id="heading-7">1. <strong>å…¸å‹åº”ç”¨åœºæ™¯</strong></h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åœºæ™¯1ï¼šçº¿ç¨‹ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’ï¼ˆå¦‚Springçš„RequestContextHolderï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RequestContextHolder</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final ThreadLocal&lt;HttpServletRequest&gt; requestHolder = 
    <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setRequest</span>(<span class="hljs-params">HttpServletRequest request</span>)</span> {
        requestHolder.<span class="hljs-keyword">set</span>(request);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HttpServletRequest <span class="hljs-title">getRequest</span>()</span> {
        <span class="hljs-keyword">return</span> requestHolder.<span class="hljs-keyword">get</span>();
    }
}

<span class="hljs-comment">// åœºæ™¯2ï¼šæ•°æ®åº“è¿æ¥ç®¡ç†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ConnectionManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Connection&gt; connectionHolder = 
    ThreadLocal.withInitial(() -&gt; DriverManager.getConnection(url));

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getConnection</span>()</span> {
        <span class="hljs-keyword">return</span> connectionHolder.<span class="hljs-keyword">get</span>();
    }
}

<span class="hljs-comment">// åœºæ™¯3ï¼šç”¨æˆ·ä¼šè¯ä¿¡æ¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;UserInfo&gt; userHolder = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUser</span>(<span class="hljs-params">UserInfo user</span>)</span> {
        userHolder.<span class="hljs-keyword">set</span>(user);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> UserInfo <span class="hljs-title">getUser</span>()</span> {
        <span class="hljs-keyword">return</span> userHolder.<span class="hljs-keyword">get</span>();
    }
}

<span class="hljs-comment">// åœºæ™¯4ï¼šé¿å…å‚æ•°ä¼ é€’</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TransactionContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Transaction&gt; transactionHolder = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">beginTransaction</span>()</span> {
        transactionHolder.<span class="hljs-keyword">set</span>(<span class="hljs-keyword">new</span> Transaction());
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Transaction <span class="hljs-title">getTransaction</span>()</span> {
        <span class="hljs-keyword">return</span> transactionHolder.<span class="hljs-keyword">get</span>();
    }
}
</code></pre>
<h4 data-id="heading-8">2. <strong>ä½¿ç”¨å»ºè®®</strong></h4>
<ul>
<li>å£°æ˜ä¸º <code>private static final</code></li>
<li>è€ƒè™‘ä½¿ç”¨ <code>ThreadLocal.withInitial()</code> æä¾›åˆå§‹å€¼</li>
<li>åœ¨ finally å—ä¸­æ¸…ç†èµ„æº</li>
</ul>
<h3 data-id="heading-9">å››ã€å†…å­˜æ³„æ¼é—®é¢˜</h3>
<h4 data-id="heading-10">1. <strong>æ³„æ¼åŸç†</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">å¼ºå¼•ç”¨é“¾ï¼š
Thread â†’ ThreadLocalMap â†’ Entry[] â†’ Entry â†’ value (å¼ºå¼•ç”¨)

<span class="hljs-code">                                                   å¼±å¼•ç”¨ï¼š
                                                   Entry â†’ key (å¼±å¼•ç”¨æŒ‡å‘ThreadLocal)
</span>
æ³„æ¼åœºæ™¯ï¼š
<span class="hljs-bullet">1.</span> ThreadLocalå®ä¾‹è¢«å›æ”¶ â†’ key=null
<span class="hljs-bullet">2.</span> ä½†valueä»ç„¶è¢«Entryå¼ºå¼•ç”¨
<span class="hljs-bullet">3.</span> çº¿ç¨‹æ± ä¸­çº¿ç¨‹é•¿æœŸå­˜æ´» â†’ valueæ— æ³•è¢«å›æ”¶
<span class="hljs-bullet">4.</span> å¯¼è‡´å†…å­˜æ³„æ¼
</code></pre>
<h4 data-id="heading-11">2. <strong>è§£å†³æ–¹æ¡ˆå¯¹æ¯”</strong></h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨removeï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">try</span> {
    threadLocal.<span class="hljs-keyword">set</span>(<span class="hljs-keyword">value</span>);
    <span class="hljs-comment">// ... ä¸šåŠ¡é€»è¾‘</span>
} <span class="hljs-keyword">finally</span> {
    threadLocal.<span class="hljs-keyword">remove</span>();  <span class="hljs-comment">// å¿…é¡»æ‰§è¡Œï¼</span>
}

<span class="hljs-comment">// æ–¹æ¡ˆ2ï¼šä½¿ç”¨InheritableThreadLocalï¼ˆçˆ¶å­çº¿ç¨‹ä¼ é€’ï¼‰</span>
ThreadLocal&lt;String&gt; parent = <span class="hljs-keyword">new</span> InheritableThreadLocal&lt;&gt;();
parent.<span class="hljs-keyword">set</span>(<span class="hljs-string">"parent value"</span>);

<span class="hljs-keyword">new</span> Thread(() -&gt; {
    <span class="hljs-comment">// å­çº¿ç¨‹å¯ä»¥è·å–çˆ¶çº¿ç¨‹çš„å€¼</span>
    System.<span class="hljs-keyword">out</span>.println(parent.<span class="hljs-keyword">get</span>());  <span class="hljs-comment">// "parent value"</span>
}).start();

<span class="hljs-comment">// æ–¹æ¡ˆ3ï¼šä½¿ç”¨FastThreadLocalï¼ˆNettyä¼˜åŒ–ç‰ˆï¼‰</span>
<span class="hljs-comment">// é€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯ï¼Œé¿å…äº†å“ˆå¸Œå†²çª</span>
</code></pre>
<h4 data-id="heading-12">3. <strong>æœ€ä½³å®è·µ</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeThreadLocalExample</span> {
    <span class="hljs-comment">// 1. ä½¿ç”¨static finalä¿®é¥°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;SimpleDateFormat&gt; DATE_FORMAT =
    ThreadLocal.withInitial(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">"yyyy-MM-dd"</span>));

    <span class="hljs-comment">// 2. åŒ…è£…ä¸ºå·¥å…·ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Date <span class="hljs-title function_">parse</span><span class="hljs-params">(String dateStr)</span> <span class="hljs-keyword">throws</span> ParseException {
        <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> DATE_FORMAT.get();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> sdf.parse(dateStr);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œé€šå¸¸ä¸éœ€è¦removeï¼Œå› ä¸ºè¦é‡ç”¨SimpleDateFormat</span>
            <span class="hljs-comment">// ä½†å¦‚æœæ˜¯ç”¨å®Œå³å¼ƒçš„åœºæ™¯ï¼Œåº”è¯¥remove</span>
        }
    }

    <span class="hljs-comment">// 3. çº¿ç¨‹æ± åœºæ™¯å¿…é¡»æ¸…ç†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeInThreadPool</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            executor.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    UserContext.setUser(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserInfo</span>());
                    <span class="hljs-comment">// ... ä¸šåŠ¡å¤„ç†</span>
                } <span class="hljs-keyword">finally</span> {
                    UserContext.remove();  <span class="hljs-comment">// å…³é”®ï¼</span>
                }
            });
        }
    }
}
</code></pre>
<h3 data-id="heading-13">äº”ã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>çº¿ç¨‹æ± é£é™©</strong>ï¼šçº¿ç¨‹å¤ç”¨å¯¼è‡´æ•°æ®æ±¡æŸ“</li>
<li><strong>ç»§æ‰¿é—®é¢˜</strong>ï¼šå­çº¿ç¨‹é»˜è®¤æ— æ³•è®¿é—®çˆ¶çº¿ç¨‹çš„ThreadLocal</li>
<li><strong>æ€§èƒ½å½±å“</strong>ï¼šå“ˆå¸Œå†²çªæ—¶ä½¿ç”¨çº¿æ€§æ¢æµ‹ï¼Œå¯èƒ½å½±å“æ€§èƒ½</li>
<li><strong>ç©ºå€¼å¤„ç†</strong>ï¼šget()è¿”å›nullæ—¶è¦è€ƒè™‘åˆå§‹åŒ–</li>
</ol>
<h3 data-id="heading-14">å…­ã€æ›¿ä»£æ–¹æ¡ˆ</h3>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>ThreadLocal</td><td>çº¿ç¨‹éš”ç¦»æ•°æ®</td><td>ç®€å•é«˜æ•ˆ</td><td>å†…å­˜æ³„æ¼é£é™©</td></tr><tr><td>InheritableThreadLocal</td><td>çˆ¶å­çº¿ç¨‹ä¼ é€’</td><td>ç»§æ‰¿ä¸Šä¸‹æ–‡</td><td>çº¿ç¨‹æ± ä¸­å¤±æ•ˆ</td></tr><tr><td>TransmittableThreadLocal</td><td>çº¿ç¨‹æ± ä¼ é€’</td><td>çº¿ç¨‹æ± å‹å¥½</td><td>å¼•å…¥ä¾èµ–</td></tr><tr><td>å‚æ•°ä¼ é€’</td><td>ç®€å•åœºæ™¯</td><td>æ— å‰¯ä½œç”¨</td><td>ä»£ç å†—ä½™</td></tr></tbody></table>
<h3 data-id="heading-15">ä¸ƒã€è°ƒè¯•æŠ€å·§</h3>
<pre><code class="hljs language-ini" lang="ini">// æŸ¥çœ‹ThreadLocalMapå†…å®¹ï¼ˆè°ƒè¯•ç”¨ï¼‰
public static void dumpThreadLocalMap(Thread thread) throws Exception {
    Field <span class="hljs-attr">field</span> = Thread.class.getDeclaredField(<span class="hljs-string">"threadLocals"</span>)<span class="hljs-comment">;</span>
    field.setAccessible(true)<span class="hljs-comment">;</span>
    Object <span class="hljs-attr">map</span> = field.get(thread)<span class="hljs-comment">;</span>

    if (map != null) {
        Field <span class="hljs-attr">tableField</span> = map.getClass().getDeclaredField(<span class="hljs-string">"table"</span>)<span class="hljs-comment">;</span>
        tableField.setAccessible(true)<span class="hljs-comment">;</span>
        Object<span class="hljs-section">[]</span> <span class="hljs-attr">table</span> = (Object[]) tableField.get(map)<span class="hljs-comment">;</span>

        for (Object entry : table) {
            if (entry != null) {
                Field <span class="hljs-attr">valueField</span> = entry.getClass().getDeclaredField(<span class="hljs-string">"value"</span>)<span class="hljs-comment">;</span>
                valueField.setAccessible(true)<span class="hljs-comment">;</span>
                System.out.println("Key: " + ((WeakReference&lt;?&gt;) entry).get() 
                                   + ", Value: " + valueField.get(entry))<span class="hljs-comment">;</span>
            }
        }
    }
}
</code></pre>
<p>ThreadLocal æ˜¯å¼ºå¤§çš„çº¿ç¨‹éš”ç¦»å·¥å…·ï¼Œä½†éœ€è¦è°¨æ…ä½¿ç”¨ã€‚åœ¨ Web åº”ç”¨å’Œçº¿ç¨‹æ± åœºæ™¯ä¸­ï¼Œ<strong>å¿…é¡»</strong>åœ¨ finally å—ä¸­è°ƒç”¨ remove()ï¼Œè¿™æ˜¯é¿å…å†…å­˜æ³„æ¼çš„å…³é”®ã€‚</p>
<h3 data-id="heading-16">é¢è¯•å›ç­”</h3>
<p>å…³äº ThreadLocalï¼Œæˆ‘ä»åŸç†ã€åœºæ™¯å’Œå†…å­˜æ³„æ¼ä¸‰ä¸ªæ–¹é¢æ¥è¯´ä¸€ä¸‹æˆ‘çš„ç†è§£ã€‚</p>
<h4 data-id="heading-17"><strong>1. é¦–å…ˆï¼Œå®ƒçš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h4>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>ThreadLocal æ˜¯ä¸€ä¸ªçº¿ç¨‹çº§åˆ«çš„å˜é‡éš”ç¦»å·¥å…·</strong>ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡å°±æ˜¯è®©åŒä¸€ä¸ªå˜é‡ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œæœ‰è‡ªå·±ç‹¬ç«‹çš„å‰¯æœ¬ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<ul>
<li><strong>åº•å±‚ç»“æ„</strong>ï¼šæ¯ä¸ªçº¿ç¨‹ï¼ˆ<code>Thread</code>å¯¹è±¡ï¼‰å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ <code>ThreadLocalMap</code>ï¼ˆä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªçº¿ç¨‹ç§æœ‰çš„ã€ç®€æ˜“ç‰ˆçš„HashMapï¼‰ã€‚</li>
<li><strong>æ€ä¹ˆå­˜</strong>ï¼šå½“æˆ‘ä»¬è°ƒç”¨ <code>ThreadLocal.set(value)</code> æ—¶ï¼Œå®é™…ä¸Šæ˜¯ä»¥<strong>å½“å‰çš„</strong> ****<code>ThreadLocal</code> ****<strong>å®ä¾‹è‡ªèº«ä½œä¸º Key</strong>ï¼Œè¦ä¿å­˜çš„å€¼ä½œä¸º Valueï¼Œå­˜å…¥<strong>å½“å‰çº¿ç¨‹çš„é‚£ä¸ª ThreadLocalMap é‡Œ</strong>ã€‚</li>
<li><strong>æ€ä¹ˆå–</strong>ï¼šè°ƒç”¨ <code>ThreadLocal.get()</code> æ—¶ï¼Œä¹Ÿæ˜¯ç”¨è‡ªå·±ä½œä¸º Keyï¼Œå»å½“å‰çº¿ç¨‹çš„ Map é‡ŒæŸ¥æ‰¾å¯¹åº”çš„ Valueã€‚</li>
<li><strong>æ‰“ä¸ªæ¯”æ–¹</strong>ï¼šå°±åƒå»é“¶è¡Œç§Ÿä¿é™©ç®±ã€‚<code>Thread</code> æ˜¯é“¶è¡Œï¼Œ<code>ThreadLocalMap</code> æ˜¯é“¶è¡Œé‡Œçš„ä¸€æ’ä¿é™©ç®±ï¼Œ<code>ThreadLocal</code> å®ä¾‹å°±æ˜¯ä½ æ‰‹é‡Œé‚£æŠŠ<strong>ç‰¹å®šçš„é’¥åŒ™</strong>ã€‚ä½ ç”¨è¿™æŠŠé’¥åŒ™ï¼ˆThreadLocalå®ä¾‹ï¼‰åªèƒ½æ‰“å¼€å±äºä½ çš„é‚£ä¸ªæ ¼å­ï¼ˆå½“å‰çº¿ç¨‹çš„Mapï¼‰ï¼Œå­˜å–è‡ªå·±çš„ä¸œè¥¿ï¼ˆValueï¼‰ï¼Œå®Œå…¨çœ‹ä¸åˆ°åˆ«äººæ ¼å­çš„ä¸œè¥¿ã€‚ä¸åŒçš„äººï¼ˆçº¿ç¨‹ï¼‰å³ä½¿ç”¨åŒä¸€æ¬¾é’¥åŒ™ï¼ˆåŒä¸€ä¸ªThreadLocalå®ä¾‹ï¼‰ï¼Œæ‰“å¼€çš„ä¹Ÿæ˜¯ä¸åŒé“¶è¡Œçš„æ ¼å­ï¼Œä¸œè¥¿è‡ªç„¶éš”ç¦»äº†ã€‚</li>
</ul>
<h4 data-id="heading-18"><strong>2. å…¶æ¬¡ï¼Œå®ƒçš„å…¸å‹ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</strong></h4>
<p>æ­£æ˜¯å› ä¸ºè¿™ç§çº¿ç¨‹éš”ç¦»çš„ç‰¹æ€§ï¼Œå®ƒç‰¹åˆ«é€‚åˆç”¨æ¥ä¼ é€’ä¸€äº›éœ€è¦åœ¨çº¿ç¨‹æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ã€å¤šä¸ªæ–¹æ³•é—´å…±äº«ï¼Œä½†åˆ<strong>ä¸èƒ½ï¼ˆæˆ–ä¸æƒ³ï¼‰é€šè¿‡æ–¹æ³•å‚æ•°æ˜¾å¼ä¼ é€’</strong>çš„æ•°æ®ã€‚æœ€å¸¸è§çš„æœ‰ä¸¤ä¸ªåœºæ™¯ï¼š</p>
<ul>
<li><strong>åœºæ™¯ä¸€ï¼šä¿å­˜ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆæœ€ç»å…¸ï¼‰</strong><br/>
æ¯”å¦‚åœ¨ <strong>Web åº”ç”¨</strong> æˆ– <strong>RPC æ¡†æ¶</strong> ä¸­å¤„ç†ä¸€ä¸ªç”¨æˆ·è¯·æ±‚æ—¶ï¼Œè¿™ä¸ªè¯·æ±‚ä»è¿›å…¥ç³»ç»Ÿåˆ°è¿”å›å“åº”ï¼Œå…¨ç¨‹å¯èƒ½ç”±åŒä¸€ä¸ªçº¿ç¨‹å¤„ç†ã€‚æˆ‘ä»¬ä¼šæŠŠä¸€äº›ä¿¡æ¯ï¼ˆæ¯”å¦‚ç”¨æˆ·IDã€äº¤æ˜“IDã€è¯­è¨€ç¯å¢ƒï¼‰å­˜åˆ°ä¸€ä¸ª ThreadLocal é‡Œã€‚è¿™æ ·ï¼Œåç»­çš„ä»»ä½•ä¸šåŠ¡æ–¹æ³•ã€å·¥å…·ç±»ï¼Œåªè¦åœ¨<strong>åŒä¸€ä¸ªçº¿ç¨‹é‡Œ</strong>ï¼Œå°±èƒ½ç›´æ¥ <code>get()</code> åˆ°è¿™äº›ä¿¡æ¯ï¼Œé¿å…äº†åœ¨æ¯ä¸€ä¸ªæ–¹æ³•ç­¾åä¸Šéƒ½åŠ ä¸Šè¿™äº›å‚æ•°ï¼Œä»£ç ä¼šç®€æ´å¾ˆå¤šã€‚</li>
<li><strong>åœºæ™¯äºŒï¼šç®¡ç†çº¿ç¨‹å®‰å…¨çš„ç‹¬äº«èµ„æº</strong><br/>
å…¸å‹ä¾‹å­æ˜¯ <strong>æ•°æ®åº“è¿æ¥</strong> å’Œ <strong>SimpleDateFormat</strong>ã€‚</li>
</ul>

<ul>
<li>
<ul>
<li>åƒ <code>SimpleDateFormat</code> è¿™ä¸ªç±»ï¼Œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœåšæˆå…¨å±€å…±äº«ï¼Œå°±è¦åŠ é”ï¼Œæ€§èƒ½å·®ã€‚ç”¨ ThreadLocal çš„è¯ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ä¸€ä¸ª <code>SimpleDateFormat</code> å®ä¾‹ï¼Œæ—¢é¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåˆå› ä¸ºçº¿ç¨‹å¤ç”¨äº†è¿™ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†åˆ›å»ºå¯¹è±¡çš„å¼€é”€ã€‚</li>
<li>ç±»ä¼¼çš„ï¼Œåœ¨ä¸€äº›éœ€è¦ä¿è¯æ•°æ®åº“è¿æ¥çº¿ç¨‹éš”ç¦»ï¼ˆæ¯”å¦‚äº‹åŠ¡ç®¡ç†ï¼‰çš„åœºæ™¯ï¼Œä¹Ÿä¼šç”¨åˆ° ThreadLocal æ¥å­˜æ”¾å½“å‰çº¿ç¨‹çš„è¿æ¥ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-19"><strong>3. æœ€åï¼Œå…³äºå®ƒçš„å†…å­˜æ³„æ¼é—®é¢˜</strong></h4>
<p>ThreadLocal å¦‚æœä½¿ç”¨ä¸å½“ï¼Œç¡®å®å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ã€‚å®ƒçš„æ ¹æºåœ¨äº <code>ThreadLocalMap</code> <strong>ä¸­ Entry çš„è®¾è®¡</strong>ã€‚</p>
<ul>
<li><strong>é—®é¢˜æ ¹æº</strong>ï¼š</li>
</ul>

<ul>
<li>
<ul>
<li><code>ThreadLocalMap</code> çš„ Keyï¼ˆä¹Ÿå°±æ˜¯ <code>ThreadLocal</code> å®ä¾‹ï¼‰æ˜¯ä¸€ä¸ª <strong>å¼±å¼•ç”¨</strong>ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœå¤–ç•Œæ²¡æœ‰å¼ºå¼•ç”¨æŒ‡å‘è¿™ä¸ª <code>ThreadLocal</code> å¯¹è±¡ï¼ˆæ¯”å¦‚æˆ‘ä»¬æŠŠ <code>ThreadLocal</code> å˜é‡è®¾ä¸ºäº† <code>null</code>ï¼‰ï¼Œä¸‹æ¬¡åƒåœ¾å›æ”¶æ—¶ï¼Œè¿™ä¸ª Key å°±ä¼šè¢«å›æ”¶æ‰ï¼Œäºæ˜¯ Map é‡Œå°±å‡ºç°äº†ä¸€ä¸ª <strong>Key ä¸º</strong> ****<code>null</code> <strong>ï¼Œä½† Value ä¾ç„¶å­˜åœ¨çš„ Entry</strong>ã€‚</li>
<li>è¿™ä¸ª Value æ˜¯ä¸€ä¸ªå¼ºå¼•ç”¨ï¼Œåªè¦çº¿ç¨‹è¿˜æ´»ç€ï¼ˆæ¯”å¦‚ç”¨çš„æ˜¯çº¿ç¨‹æ± ï¼Œçº¿ç¨‹ä¼šå¤ç”¨ï¼Œä¸€ç›´ä¸ç»“æŸï¼‰ï¼Œè¿™ä¸ª Value å¯¹è±¡å°±æ°¸è¿œæ— æ³•è¢«å›æ”¶ï¼Œé€ æˆäº†å†…å­˜æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>

<ul>
<li><strong>å¦‚ä½•é¿å…</strong>ï¼š</li>
</ul>
<ol>
<li>
<ol>
<li><strong>è‰¯å¥½ä¹ æƒ¯</strong>ï¼šæ¯æ¬¡ä½¿ç”¨å®Œ ThreadLocal åï¼Œ<strong>ä¸€å®šè¦æ‰‹åŠ¨è°ƒç”¨</strong> ****<code>remove() </code>****<strong>æ–¹æ³•</strong>ã€‚è¿™ä¸ä»…æ˜¯æ¸…ç†å½“å‰å€¼ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒä¼šæ¸…ç†æ‰æ•´ä¸ª Entryï¼Œè¿™æ˜¯æœ€æœ‰æ•ˆã€æœ€å®‰å…¨çš„åšæ³•ã€‚</li>
<li><strong>è®¾è®¡ä¿éšœ</strong>ï¼š<code>ThreadLocal</code> æœ¬èº«ä¹Ÿåšäº†ä¸€äº›åŠªåŠ›ï¼Œæ¯”å¦‚åœ¨ <code>set()</code>ã€<code>get()</code>ã€<code>remove()</code> çš„æ—¶å€™ï¼Œä¼šå°è¯•å»æ¸…ç†é‚£äº› Key ä¸º <code>null</code> çš„è¿‡æœŸ Entryã€‚ä½†è¿™æ˜¯ä¸€ç§â€œè¢«åŠ¨æ¸…ç†â€ï¼Œä¸èƒ½å®Œå…¨ä¾èµ–ã€‚</li>
<li><strong>ä»£ç å±‚é¢</strong>ï¼šå°½é‡å°† <code>ThreadLocal</code> å˜é‡å£°æ˜ä¸º <code>static final</code>ï¼Œè¿™æ ·å®ƒçš„ç”Ÿå‘½å‘¨æœŸå°±å’Œç±»ä¸€æ ·é•¿ï¼Œä¸ä¼šè¢«è½»æ˜“å›æ”¶ï¼Œå‡å°‘äº†äº§ç”Ÿ <code>null</code> Key çš„æœºä¼šã€‚ä½†è¿™å¹¶ä¸èƒ½æ›¿ä»£ <code>remove()</code>ï¼Œå› ä¸ºçº¿ç¨‹æ± å¤ç”¨æ—¶ï¼Œä¸Šä¸€ä¸ªä»»åŠ¡çš„å€¼å¯èƒ½ä¼šæ±¡æŸ“ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</li>
</ol>
</li>
</ol>
<hr/>
<p><strong>æ€»ç»“ä¸€ä¸‹</strong>ï¼šå†…å­˜æ³„æ¼çš„å…³é”®æ˜¯ <strong>â€œå¼±Key + å¼ºValue + é•¿ç”Ÿå‘½å‘¨æœŸçº¿ç¨‹â€</strong> çš„ç»„åˆã€‚æ‰€ä»¥ï¼ŒæŠŠ <code>remove()</code> æ”¾åœ¨ <code>finally</code> å—é‡Œè°ƒç”¨ï¼Œæ˜¯ä¸€ä¸ªå¿…é¡»å…»æˆçš„ç¼–ç¨‹ä¹ æƒ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RESTfulé£æ ¼è§£æ]]></title>    <link>https://juejin.cn/post/7585743487258214409</link>    <guid>https://juejin.cn/post/7585743487258214409</guid>    <pubDate>2025-12-21T06:46:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487258214409" data-draft-id="7585645111875469339" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RESTfulé£æ ¼è§£æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T06:46:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="L0CK"/> <meta itemprop="url" content="https://juejin.cn/user/3555195572989993"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RESTfulé£æ ¼è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3555195572989993/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    L0CK
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T06:46:33.000Z" title="Sun Dec 21 2025 06:46:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>RESTful</strong> æ˜¯ä¸€ç§ç›®å‰æœ€æµè¡Œçš„<strong>äº’è”ç½‘è½¯ä»¶æ¶æ„è®¾è®¡é£æ ¼</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-0">1. æ ¸å¿ƒç†å¿µï¼šçœ‹å±±æ˜¯å±±ï¼ˆèµ„æºå¯¼å‘ï¼‰</h3>
<p>åœ¨ RESTful é£æ ¼ä¸­ï¼Œç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸œè¥¿ï¼ˆç”¨æˆ·ã€è®¢å•ã€å•†å“ï¼‰éƒ½è¢«çœ‹ä½œæ˜¯â€œ<strong>èµ„æºâ€ (Resource</strong>)ã€‚</p>
<ul>
<li>
<p>ä¼ ç»Ÿé£æ ¼ï¼ˆåŠ¨è¯å¯¼å‘ - åƒä¸‹å‘½ä»¤ï¼‰ï¼š</p>
<p>ä»¥å‰æˆ‘ä»¬å†™æ¥å£ï¼Œå–œæ¬¢æŠŠåŠ¨ä½œå†™åœ¨ç½‘å€é‡Œï¼š</p>
<ul>
<li><code>http://localhost:8080/getUser?id=1</code></li>
<li><code>http://localhost:8080/createUser</code></li>
<li><code>http://localhost:8080/deleteUser?id=1</code></li>
<li><code>http://localhost:8080/updateUser</code></li>
<li><em>ç¼ºç‚¹ï¼šç½‘å€ä¹±ä¸ƒå…«ç³Ÿï¼Œå¦‚æœä¸çœ‹æ–‡æ¡£ï¼Œä¸çŸ¥é“ delete åé¢æ˜¯è·Ÿ id è¿˜æ˜¯ nameã€‚</em></li>
</ul>
</li>
<li>
<p>RESTful é£æ ¼ï¼ˆåè¯å¯¼å‘ - åƒæ–‡ä»¶è·¯å¾„ï¼‰ï¼š</p>
<p>REST è®¤ä¸ºï¼Œç½‘å€ (URL) ç”¨æ¥å®šä½èµ„æºï¼Œä¸åº”è¯¥åŒ…å«åŠ¨ä½œã€‚</p>
<ul>
<li>ä¸ç®¡å¢åˆ æ”¹æŸ¥ï¼Œç½‘å€ç»Ÿä¸€éƒ½æ˜¯ï¼š<code>http://localhost:8080/users</code></li>
<li>å¦‚æœè¦æ‰¾ç‰¹å®šçš„äººï¼š<code>http://localhost:8080/users/1</code></li>
</ul>
</li>
</ul>
<p>é‚£æœåŠ¡å™¨æ€ä¹ˆçŸ¥é“æˆ‘æ˜¯è¦â€œåˆ é™¤â€è¿˜æ˜¯â€œæŸ¥è¯¢â€å‘¢ï¼Ÿ</p>
<p>é  HTTP è¯·æ±‚æ–¹å¼ï¼ˆåŠ¨è¯ï¼‰ æ¥åŒºåˆ†ï¼</p>
<hr/>
<h3 data-id="heading-1">2. å››å¤§é‡‘åˆšï¼šHTTP åŠ¨è¯</h3>
<p>RESTful å·§å¦™åœ°åˆ©ç”¨äº† HTTP åè®®è‡ªå¸¦çš„å››ä¸ªåŠ¨è¯ï¼Œå®Œç¾å¯¹åº”æ•°æ®åº“çš„ <strong>CRUDï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</strong> ï¼š</p>



































<table><thead><tr><th><strong>HTTP åŠ¨è¯</strong></th><th><strong>å¯¹åº”çš„æ“ä½œ</strong></th><th><strong>å«ä¹‰</strong></th><th><strong>ä¾‹å­ (æ“ä½œç”¨æˆ· ID=1)</strong></th></tr></thead><tbody><tr><td><strong>GET</strong></td><td><strong>æŸ¥</strong> (Read)</td><td>è·å–èµ„æº</td><td><code>GET /users/1</code></td></tr><tr><td><strong>POST</strong></td><td><strong>å¢</strong> (Create)</td><td>æ–°å»ºèµ„æº</td><td><code>POST /users</code> (æ•°æ®åœ¨è¯·æ±‚ä½“é‡Œ)</td></tr><tr><td><strong>PUT</strong></td><td><strong>æ”¹</strong> (Update)</td><td>ä¿®æ”¹èµ„æº</td><td><code>PUT /users</code> (æ•°æ®åœ¨è¯·æ±‚ä½“é‡Œ)</td></tr><tr><td><strong>DELETE</strong></td><td><strong>åˆ </strong> (Delete)</td><td>åˆ é™¤èµ„æº</td><td><code>DELETE /users/1</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-2">3. ä»£ç å®æˆ˜ï¼šBefore vs After</h3>
<p>è®©æˆ‘ä»¬æŠŠä½ ä¹‹å‰çš„ <code>UserController</code> æ”¹é€ ä¸€ä¸‹ï¼Œä½ å°±æ˜ç™½å·®è·åœ¨å“ªäº†ã€‚</p>
<h4 data-id="heading-3">âŒ ä¼ ç»Ÿå†™æ³•ï¼ˆé RESTfulï¼‰</h4>
<p>Java</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
public class UserController {

    <span class="hljs-comment">// åŠ¨ä½œå…¨å†™åœ¨ URL é‡Œ</span>
    <span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/queryUserById"</span>) 
    public User <span class="hljs-built_in">get</span>(Integer id) { ... }

    <span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/saveUser"</span>)
    public void <span class="hljs-built_in">save</span>(User user) { ... }
    
    <span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/deleteUser"</span>)
    public void <span class="hljs-built_in">delete</span>(Integer id) { ... }
}
</code></pre>
<h4 data-id="heading-4">âœ… RESTful å†™æ³•ï¼ˆæ¨èï¼‰</h4>
<p>åœ¨ Spring Boot ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸“é—¨çš„æ³¨è§£æ¥å¯¹åº”é‚£å››ä¸ªåŠ¨è¯ã€‚æ³¨æ„çœ‹ URL æœ‰å¤šå¹²å‡€ï¼š</p>
<p>Java</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/users"</span>) <span class="hljs-comment">// 1. ç»Ÿä¸€èµ„æºçš„è·¯å¾„ï¼Œå…¨æ˜¯å¤æ•°</span>
public class UserController {

    <span class="hljs-comment">// è·å–æ‰€æœ‰ç”¨æˆ·ï¼šGET /users</span>
    <span class="hljs-variable">@GetMapping</span> 
    public List&lt;User&gt; <span class="hljs-built_in">list</span>() { ... }

    <span class="hljs-comment">// è·å–å•ä¸ªç”¨æˆ·ï¼šGET /users/1</span>
    <span class="hljs-comment">// @PathVariable ç”¨äºè·å–è·¯å¾„ä¸Šçš„ {id}</span>
    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/{id}"</span>) 
    public User <span class="hljs-built_in">getById</span>(<span class="hljs-variable">@PathVariable</span> Integer id) { ... }

    <span class="hljs-comment">// æ–°å¢ç”¨æˆ·ï¼šPOST /users</span>
    <span class="hljs-variable">@PostMapping</span>
    public void <span class="hljs-built_in">save</span>(<span class="hljs-variable">@RequestBody</span> User user) { ... }

    <span class="hljs-comment">// ä¿®æ”¹ç”¨æˆ·ï¼šPUT /users</span>
    <span class="hljs-variable">@PutMapping</span>
    public void <span class="hljs-built_in">update</span>(<span class="hljs-variable">@RequestBody</span> User user) { ... }

    <span class="hljs-comment">// åˆ é™¤ç”¨æˆ·ï¼šDELETE /users/1</span>
    <span class="hljs-variable">@DeleteMapping</span>(<span class="hljs-string">"/{id}"</span>)
    public void <span class="hljs-built_in">delete</span>(<span class="hljs-variable">@PathVariable</span> Integer id) { ... }
}
</code></pre>
<hr/>
<h3 data-id="heading-5">4. ä¸¤ä¸ªå…³é”®æ–°æ³¨è§£</h3>
<p>åœ¨ RESTful å¼€å‘ä¸­ï¼Œä½ ä¼šé¢‘ç¹ç”¨åˆ°è¿™ä¸¤ä¸ªæ³¨è§£ï¼š</p>
<ol>
<li>
<p><strong><code>@PathVariable</code></strong>ï¼š</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç”¨äºè·¯å¾„å‚æ•°ã€‚</li>
<li><strong>ä¾‹å­</strong>ï¼š<code>/users/1</code> ä¸­çš„ <code>1</code>ã€‚</li>
<li><strong>ä»£ç </strong>ï¼š<code>@DeleteMapping("/{id}") public void delete(@PathVariable Integer id)</code></li>
</ul>
</li>
<li>
<p><strong><code>@RequestBody</code></strong>ï¼š</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç”¨äºæ¥æ”¶å‰ç«¯å‘æ¥çš„ <strong>JSON æ•°æ®</strong>ï¼ˆé€šå¸¸ç”¨äº POST å’Œ PUTï¼‰ã€‚</li>
<li><strong>è§£é‡Š</strong>ï¼šå®ƒä¼šè‡ªåŠ¨æŠŠå‰ç«¯å‘æ¥çš„ JSON å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚ <code>{"name":"å¤§æ¡¥", "age":20}</code>ï¼‰è½¬æ¢æˆ Java çš„ <code>User</code> å¯¹è±¡ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-6">5. æ€»ç»“ï¼šä¸ºä»€ä¹ˆè¦ç”¨ RESTfulï¼Ÿ</h3>
<ol>
<li><strong>çœ‹ç½‘å€å°±çŸ¥é“åœ¨å¹²å˜›</strong>ï¼šçœ‹åˆ° <code>DELETE /users/1</code>ï¼Œå‚»å­éƒ½çŸ¥é“è¿™æ˜¯è¦åˆ é™¤ 1 å·ç”¨æˆ·ã€‚</li>
<li><strong>å‰ç«¯åç«¯æ²Ÿé€šæˆæœ¬ä½</strong>ï¼šè¿™å·²ç»æˆäº†è¡Œä¸šæ ‡å‡†ã€‚å‰ç«¯å¼€å‘äººå‘˜çœ‹åˆ°ä½ çš„æ¥å£æ–‡æ¡£æ˜¯ RESTful é£æ ¼çš„ï¼Œä»–éƒ½ä¸ç”¨é—®ä½ ï¼Œç›´æ¥å°±ä¼šè°ƒã€‚</li>
<li><strong>æ”¯æŒå¤šç«¯</strong>ï¼šè¿™ç§é£æ ¼è¿”å›çš„é€šå¸¸æ˜¯ JSON æ•°æ®ï¼Œæ— è®ºæ˜¯ç½‘é¡µã€å®‰å“ App è¿˜æ˜¯ iOS Appï¼Œéƒ½å¯ä»¥é€šç”¨ä¸€å¥—æ¥å£ã€‚</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç´¢ DoraCMS çš„æ¶æ„è®¾è®¡ï¼šä» Repository æ¨¡å¼åˆ°åŒæ•°æ®åº“æ”¯æŒ]]></title>    <link>https://juejin.cn/post/7585727457472233472</link>    <guid>https://juejin.cn/post/7585727457472233472</guid>    <pubDate>2025-12-21T07:48:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472233472" data-draft-id="7585727457472217088" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç´¢ DoraCMS çš„æ¶æ„è®¾è®¡ï¼šä» Repository æ¨¡å¼åˆ°åŒæ•°æ®åº“æ”¯æŒ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T07:48:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”Ÿå“¥740"/> <meta itemprop="url" content="https://juejin.cn/user/77392562883348"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç´¢ DoraCMS çš„æ¶æ„è®¾è®¡ï¼šä» Repository æ¨¡å¼åˆ°åŒæ•°æ®åº“æ”¯æŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/77392562883348/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”Ÿå“¥740
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T07:48:33.000Z" title="Sun Dec 21 2025 07:48:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¢ç´¢ DoraCMS çš„æ¶æ„è®¾è®¡ï¼šä» Repository æ¨¡å¼åˆ°åŒæ•°æ®åº“æ”¯æŒ</h2>
<p>åœ¨ Node.js CMS é¢†åŸŸï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªæ—¢çµæ´»åˆæ˜“ç»´æŠ¤çš„æ¶æ„ä¸€ç›´æ˜¯ä¸ªæŒ‘æˆ˜ã€‚æœ€è¿‘åœ¨ç ”ç©¶ DoraCMS çš„æ¶æ„è®¾è®¡æ—¶ï¼Œå‘ç°äº†ä¸€äº›å€¼å¾—åˆ†äº«çš„è®¾è®¡æ€è·¯ï¼Œç‰¹åˆ«æ˜¯å…¶ Repository æ¨¡å¼å’ŒåŒæ•°æ®åº“æ”¯æŒçš„å®ç°æ–¹å¼ã€‚</p>
<h3 data-id="heading-1">æ¶æ„æ¦‚è§ˆ</h3>
<p>DoraCMS é‡‡ç”¨äº†å‰åç«¯åˆ†ç¦»çš„ç°ä»£åŒ–æ¶æ„ï¼Œæ•´ä½“åˆ†ä¸ºå››å±‚ï¼š</p>
<pre><code class="hljs">å‰ç«¯åº”ç”¨å±‚ â†’ API ç½‘å…³å±‚ â†’ åº”ç”¨æœåŠ¡å±‚ â†’ æ•°æ®å­˜å‚¨å±‚
</code></pre>
<p>åç«¯é‡‡ç”¨ EggJS æ¡†æ¶ï¼Œéµå¾ª <strong>Controller â†’ Service â†’ Repository</strong> ä¸‰å±‚æ¶æ„ï¼ŒèŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒè®¾è®¡ï¼šRepository æ¨¡å¼</h3>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆéœ€è¦ Repository æ¨¡å¼ï¼Ÿ</h4>
<p>åœ¨ä¼ ç»Ÿçš„ MVC æ¶æ„ä¸­ï¼Œä¸šåŠ¡ä»£ç å¾€å¾€ç›´æ¥æ“ä½œæ•°æ®åº“æ¨¡å‹ï¼Œè¿™ä¼šå¯¼è‡´å‡ ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li><strong>æ•°æ®åº“è€¦åˆ</strong>ï¼šåˆ‡æ¢æ•°æ®åº“éœ€è¦é‡å†™å¤§é‡æŸ¥è¯¢ä»£ç </li>
<li><strong>ä»£ç åˆ†æ•£</strong>ï¼šæŸ¥è¯¢é€»è¾‘æ•£å¸ƒåœ¨å„ä¸ª Service ä¸­ï¼Œéš¾ä»¥å¤ç”¨</li>
<li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šç›¸åŒçš„æ•°æ®æ“ä½œé€»è¾‘åœ¨å¤šå¤„é‡å¤</li>
</ol>
<p>DoraCMS é€šè¿‡ Repository æ¨¡å¼è§£å†³äº†è¿™äº›é—®é¢˜ã€‚Repository å±‚ä½œä¸ºæ•°æ®è®¿é—®çš„æŠ½è±¡å±‚ï¼Œæä¾›äº†ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£ï¼Œå±è”½äº†åº•å±‚æ•°æ®åº“çš„å·®å¼‚ã€‚</p>
<h4 data-id="heading-4">å››å±‚ç»§æ‰¿ç»“æ„</h4>
<p>DoraCMS çš„ Repository é‡‡ç”¨äº†å››å±‚ç»§æ‰¿ç»“æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">IBaseRepository (æ¥å£å±‚)
    â†“
BaseStandardRepository (è·¨æ•°æ®åº“åŸºç±»)
    â†“                    â†“
BaseMongoRepository  BaseMariaRepository
    â†“                    â†“
UserMongoRepository  UserMariaRepository
</code></pre>
<p>è¿™ç§è®¾è®¡çš„å·§å¦™ä¹‹å¤„åœ¨äºï¼š</p>
<ul>
<li><strong>BaseStandardRepository</strong> å®ç°äº†é€šç”¨çš„ CRUD æ“ä½œå’Œç»Ÿä¸€çš„å‚æ•°æ¥å£</li>
<li><strong>BaseMongoRepository</strong> å’Œ <strong>BaseMariaRepository</strong> åˆ†åˆ«å®ç°æ•°æ®åº“ç‰¹å®šçš„æŸ¥è¯¢è½¬æ¢</li>
<li>å…·ä½“çš„ Repository åªéœ€è¦å®ç°ä¸šåŠ¡ç‰¹å®šçš„é€»è¾‘</li>
</ul>
<h4 data-id="heading-5">ç»Ÿä¸€çš„å‚æ•°æ¥å£</h4>
<p>æ— è®ºä½¿ç”¨ MongoDB è¿˜æ˜¯ MariaDBï¼Œä¸šåŠ¡ä»£ç éƒ½ä½¿ç”¨ç›¸åŒçš„æŸ¥è¯¢æ–¹å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£</span>
<span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> userRepository.<span class="hljs-title function_">findMany</span>({
  <span class="hljs-attr">filters</span>: { <span class="hljs-attr">status</span>: <span class="hljs-string">"active"</span> },
  <span class="hljs-attr">populate</span>: [<span class="hljs-string">"role"</span>, <span class="hljs-string">"department"</span>],
  <span class="hljs-attr">sort</span>: { <span class="hljs-attr">createdAt</span>: -<span class="hljs-number">1</span> },
  <span class="hljs-attr">pagination</span>: { <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">limit</span>: <span class="hljs-number">20</span> },
});
</code></pre>
<p>Repository å†…éƒ¨ä¼šæ ¹æ®æ•°æ®åº“ç±»å‹è‡ªåŠ¨è½¬æ¢æŸ¥è¯¢å‚æ•°ï¼Œä¸šåŠ¡å±‚å®Œå…¨æ— æ„ŸçŸ¥ã€‚</p>
<h3 data-id="heading-6">åŒæ•°æ®åº“æ”¯æŒ</h3>
<p>è¿™æ˜¯ DoraCMS çš„ä¸€ä¸ªäº®ç‚¹ç‰¹æ€§ã€‚é€šè¿‡ Repository æ¨¡å¼çš„æŠ½è±¡ï¼Œå®ç°äº† MongoDB å’Œ MariaDB çš„æ— ç¼åˆ‡æ¢ã€‚</p>
<h4 data-id="heading-7">åˆ‡æ¢æ–¹å¼</h4>
<p>åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸€è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// config.js</span>
config.<span class="hljs-property">dbType</span> = <span class="hljs-string">"mongodb"</span>; <span class="hljs-comment">// æˆ– 'mariadb'</span>
</code></pre>
<p>ä¸šåŠ¡ä»£ç å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ï¼Œè¿™å¾—ç›Šäº Repository å±‚çš„æŠ½è±¡å’Œ Adapter é€‚é…å™¨æ¨¡å¼ã€‚</p>
<h4 data-id="heading-8">æŠ€æœ¯å®ç°</h4>
<ul>
<li><strong>MongoDB</strong>ï¼šä½¿ç”¨ Mongoose ä½œä¸º ODM</li>
<li><strong>MariaDB</strong>ï¼šä½¿ç”¨ Sequelize ä½œä¸º ORM</li>
<li><strong>Adapter å±‚</strong>ï¼šè´Ÿè´£æŸ¥è¯¢å‚æ•°çš„è½¬æ¢å’Œç»“æœæ˜ å°„</li>
</ul>
<p>è¿™ç§è®¾è®¡è®©å¼€å‘è€…å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚çµæ´»é€‰æ‹©æ•°æ®åº“ï¼Œè€Œä¸éœ€è¦é‡å†™ä¸šåŠ¡ä»£ç ã€‚</p>
<h3 data-id="heading-9">ä¸‰å±‚æ¶æ„çš„èŒè´£åˆ’åˆ†</h3>
<h4 data-id="heading-10">Controller å±‚</h4>
<p>è´Ÿè´£å¤„ç† HTTP è¯·æ±‚å’Œå“åº”ï¼š</p>
<ul>
<li>å‚æ•°éªŒè¯</li>
<li>æƒé™æ£€æŸ¥</li>
<li>è°ƒç”¨ Service å±‚</li>
<li>æ ¼å¼åŒ–å“åº”</li>
</ul>
<h4 data-id="heading-11">Service å±‚</h4>
<p>è´Ÿè´£ä¸šåŠ¡é€»è¾‘ç¼–æ’ï¼š</p>
<ul>
<li>ä¸šåŠ¡è§„åˆ™éªŒè¯</li>
<li>äº‹åŠ¡ç®¡ç†</li>
<li>è°ƒç”¨ Repository è¿›è¡Œæ•°æ®æ“ä½œ</li>
<li>è·¨æ¨¡å—åè°ƒ</li>
</ul>
<h4 data-id="heading-12">Repository å±‚</h4>
<p>è´Ÿè´£æ•°æ®è®¿é—®ï¼š</p>
<ul>
<li>æ•°æ®åº“ CRUD æ“ä½œ</li>
<li>æŸ¥è¯¢è½¬æ¢å’Œä¼˜åŒ–</li>
<li>å¼‚å¸¸å¤„ç†</li>
<li>å­—æ®µæ˜ å°„</li>
</ul>
<p>è¿™ç§æ¸…æ™°çš„èŒè´£åˆ’åˆ†è®©ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚</p>
<h3 data-id="heading-13">å¾®å‰ç«¯æ¶æ„</h3>
<p>DoraCMS è¿˜æ”¯æŒå¾®å‰ç«¯æ¶æ„ï¼ŒåŸºäº qiankun æ¡†æ¶å®ç°ã€‚ä¸»åº”ç”¨å¯ä»¥æ³¨å†Œå¤šä¸ªå­åº”ç”¨ï¼Œæ¯ä¸ªå­åº”ç”¨å¯ä»¥ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²å’Œå‡çº§ã€‚</p>
<p>è¿™ç§æ¶æ„ç‰¹åˆ«é€‚åˆå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥è®©ä¸åŒå›¢é˜Ÿç‹¬ç«‹è´Ÿè´£ä¸åŒçš„å‰ç«¯åº”ç”¨ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h3 data-id="heading-14">æŠ€æœ¯æ ˆ</h3>
<h4 data-id="heading-15">å‰ç«¯</h4>
<ul>
<li>Vue 3 + TypeScript</li>
<li>Vite æ„å»ºå·¥å…·</li>
<li>Element Plus UI ç»„ä»¶åº“</li>
<li>UnoCSS åŸå­åŒ– CSS</li>
</ul>
<h4 data-id="heading-16">åç«¯</h4>
<ul>
<li>EggJS 3.x ä¼ä¸šçº§æ¡†æ¶</li>
<li>MongoDB / MariaDB åŒæ•°æ®åº“æ”¯æŒ</li>
<li>Redis ç¼“å­˜</li>
<li>JWT è®¤è¯</li>
</ul>
<h3 data-id="heading-17">è®¾è®¡äº®ç‚¹æ€»ç»“</h3>
<ol>
<li><strong>Repository æ¨¡å¼</strong>ï¼šå®ç°äº†æ•°æ®è®¿é—®å±‚çš„æŠ½è±¡ï¼Œä»£ç å¤ç”¨ç‡å¯è¾¾ 90%+</li>
<li><strong>åŒæ•°æ®åº“æ”¯æŒ</strong>ï¼šé€šè¿‡é…ç½®å³å¯åˆ‡æ¢æ•°æ®åº“ï¼Œä¸šåŠ¡ä»£ç é›¶ä¿®æ”¹</li>
<li><strong>ä¸‰å±‚æ¶æ„</strong>ï¼šèŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•</li>
<li><strong>å¾®å‰ç«¯æ”¯æŒ</strong>ï¼šé€‚åˆå¤§å‹é¡¹ç›®çš„æ¨¡å—åŒ–å¼€å‘</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šTypeScript å…¨é¢æ”¯æŒï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
</ol>
<h3 data-id="heading-18">æ€è€ƒä¸å¯å‘</h3>
<p>DoraCMS çš„æ¶æ„è®¾è®¡ç»™æˆ‘æœ€å¤§çš„å¯å‘æ˜¯ï¼š<strong>é€šè¿‡åˆç†çš„æŠ½è±¡å±‚è®¾è®¡ï¼Œå¯ä»¥åœ¨ä¿æŒçµæ´»æ€§çš„åŒæ—¶ï¼Œé™ä½ä»£ç å¤æ‚åº¦</strong>ã€‚</p>
<p>Repository æ¨¡å¼è™½ç„¶å¢åŠ äº†ä»£ç å±‚æ¬¡ï¼Œä½†å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š</p>
<ul>
<li>ä¸šåŠ¡ä»£ç ä¸æ•°æ®åº“è§£è€¦</li>
<li>æŸ¥è¯¢é€»è¾‘ç»Ÿä¸€å°è£…</li>
<li>æ˜“äºæµ‹è¯•å’Œç»´æŠ¤</li>
<li>æ”¯æŒå¤šæ•°æ®åº“åˆ‡æ¢</li>
</ul>
<p>è¿™ç§è®¾è®¡æ€è·¯å€¼å¾—åœ¨ç±»ä¼¼é¡¹ç›®ä¸­å€Ÿé‰´ã€‚</p>
<h3 data-id="heading-19">æ€»ç»“</h3>
<p>DoraCMS çš„æ¶æ„è®¾è®¡ä½“ç°äº†å¯¹ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§çš„é‡è§†ã€‚é€šè¿‡ Repository æ¨¡å¼ã€ä¸‰å±‚æ¶æ„å’ŒåŒæ•°æ®åº“æ”¯æŒï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ—¢çµæ´»åˆæ˜“ç”¨çš„ CMS è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¦‚æœä½ å¯¹ Node.js CMS æ¶æ„è®¾è®¡æ„Ÿå…´è¶£ï¼Œæˆ–è€…æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªå¯æ‰©å±•çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¸å¦¨äº†è§£ä¸€ä¸‹ DoraCMS çš„è®¾è®¡æ€è·¯ã€‚</p>
<hr/>
<p><strong>ç›¸å…³é“¾æ¥ï¼š</strong></p>
<ul>
<li>GitHub ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdoramart%2FDoraCMS" target="_blank" title="https://github.com/doramart/DoraCMS" ref="nofollow noopener noreferrer">github.com/doramart/Doâ€¦</a></li>
<li>å®˜æ–¹ç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.doracms.net" target="_blank" title="https://www.doracms.net" ref="nofollow noopener noreferrer">www.doracms.net</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonè¿›é˜¶: å…ƒç±»ä¸å±æ€§æŸ¥æ‰¾ç†è§£]]></title>    <link>https://juejin.cn/post/7585706951604289562</link>    <guid>https://juejin.cn/post/7585706951604289562</guid>    <pubDate>2025-12-21T08:19:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585706951604289562" data-draft-id="7585534343562494002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonè¿›é˜¶: å…ƒç±»ä¸å±æ€§æŸ¥æ‰¾ç†è§£"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-21T08:19:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="verbannung"/> <meta itemprop="url" content="https://juejin.cn/user/1086751804772174"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonè¿›é˜¶: å…ƒç±»ä¸å±æ€§æŸ¥æ‰¾ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1086751804772174/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    verbannung
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:19:14.000Z" title="Sun Dec 21 2025 08:19:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Pythonè¿›é˜¶: å…ƒç±»ä¸å±æ€§æŸ¥æ‰¾ç†è§£</h2>
<h3 data-id="heading-1">metaclass</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">M</span>(<span class="hljs-title class_ inherited__">type</span>):
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">metacls, name, bases, **kwargs</span>):
        namespace = <span class="hljs-built_in">dict</span>()

        <span class="hljs-comment"># æ³¨å…¥ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼Œç±»å®šä¹‰ä½“é‡Œå¯ä»¥ç›´æ¥ç”¨</span>
        namespace[<span class="hljs-string">'add'</span>] = <span class="hljs-keyword">lambda</span> a, b: a + b
        namespace[<span class="hljs-string">'BASE_VALUE'</span>] = <span class="hljs-number">100</span>

        <span class="hljs-keyword">return</span> namespace


<span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span>(metaclass=M):
    result = add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)  
    total = BASE_VALUE + <span class="hljs-number">50</span>  
    
test = Test()
<span class="hljs-built_in">print</span>(Test.result)  <span class="hljs-comment">#3</span>
</code></pre>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªå…ƒç±»,è¿™é‡Œç›´æ¥å¡å…¥äº†ä¸€ä¸ªaddæ–¹æ³•,è¿™æ ·æ‰€æœ‰è¢«è¿™ä¸ªå…ƒç±»åˆ›å»ºçš„ç±»éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</p>
<h4 data-id="heading-2">å…ƒç±»çš„æ„ä¹‰</h4>
<p>æ§åˆ¶ç±»çš„åˆ›å»ºè¿‡ç¨‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta</span>(<span class="hljs-title class_ inherited__">type</span>):
<span class="hljs-meta">  	@classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">metacls, name, bases</span>):    <span class="hljs-comment"># 1. æ§åˆ¶ç±»å®šä¹‰ä½“çš„æ‰§è¡Œç¯å¢ƒ</span>
        ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name, bases, ns</span>):    <span class="hljs-comment"># 2. æ§åˆ¶ç±»å¯¹è±¡çš„åˆ›å»º</span>
        ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">cls, name, bases, ns</span>):   <span class="hljs-comment"># 3. æ§åˆ¶ç±»å¯¹è±¡çš„åˆå§‹åŒ–</span>
        ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls, *args</span>):             <span class="hljs-comment"># 4. æ§åˆ¶å®ä¾‹çš„åˆ›å»º</span>
        ...
</code></pre>
<p>ä¾‹å­: è‡ªåŠ¨æ³¨å†Œæœé›†ç±»</p>
<pre><code class="hljs language-python" lang="python">registry = {}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RegisterMeta</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls, name, bases, ns</span>):
        klass = <span class="hljs-built_in">super</span>().__new__(cls, name, bases, ns)
        <span class="hljs-keyword">if</span> name != <span class="hljs-string">'Base'</span>:
            registry[name] = klass  
        <span class="hljs-keyword">return</span> klass

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span>(metaclass=RegisterMeta): <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-title class_ inherited__">Base</span>): <span class="hljs-keyword">pass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-title class_ inherited__">Base</span>): <span class="hljs-keyword">pass</span>

<span class="hljs-built_in">print</span>(registry)  <span class="hljs-comment"># {'Dog': &lt;class Dog&gt;, 'Cat': &lt;class Cat&gt;}</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">cls</span>):
    original_init = cls.__init__
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">new_init</span>(<span class="hljs-params">self, *args, **kwargs</span>):
        original_init(self, *args, **kwargs)
        registry.append(self) 
    cls.__init__ = new_init
    <span class="hljs-keyword">return</span> cls

<span class="hljs-meta">@register</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Handler</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):
        self.name = name

h1 = Handler(<span class="hljs-string">"h1"</span>)
h2 = Handler(<span class="hljs-string">"h2"</span>)
<span class="hljs-built_in">print</span>(registry)  
</code></pre>
<h4 data-id="heading-3">å’Œè£…é¥°å™¨çš„åŒºåˆ«</h4>
<p>è£…é¥°å™¨æ˜¯ä½¿ç”¨äº†é—­åŒ…å‡½æ•°,å¸¸å¸¸ç”¨æ¥ç®¡ç†å®ä¾‹,ä¸¤è€…ä½¿ç”¨çš„åœºæ™¯:</p>


















































<table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>è£…é¥°å™¨</strong></th><th><strong>å…ƒç±»</strong></th></tr></thead><tbody><tr><td><strong>å•ä¸ªç±»å¢å¼º</strong></td><td>âœ“</td><td>âœ—  æ²¡å¿…è¦,å¤ªé‡</td></tr><tr><td><strong>å¯é€‰åŠŸèƒ½ (ç”¨ä¸ç”¨éšæ„)</strong></td><td>âœ“</td><td>âœ— ä¸€èˆ¬ä¹Ÿæ˜¯å…·ä½“çš„å¢å¼º</td></tr><tr><td><strong>ä¿®æ”¹å®ä¾‹è¡Œä¸º</strong></td><td>âœ“</td><td>âœ— å®ä¾‹ç®¡ç†</td></tr><tr><td><strong>æ‰€æœ‰å­ç±»è‡ªåŠ¨ç»§æ‰¿è¡Œä¸º</strong></td><td>âœ—</td><td>âœ“</td></tr><tr><td><strong>ç±»å®šä¹‰æ—¶éªŒè¯</strong></td><td>â–³ å¦‚æœç‰¹å®šä¸€å¤„ç”¨,å¯ä»¥ç”¨è£…é¥°å™¨</td><td>âœ“</td></tr><tr><td><strong>æ§åˆ¶ç±»çš„åˆ›å»ºè¿‡ç¨‹</strong></td><td>âœ—</td><td>âœ“</td></tr><tr><td><strong>æ¡†æ¶çº§åˆ« (ORM/åºåˆ—åŒ–)</strong></td><td>âœ—</td><td>âœ“</td></tr><tr><td><strong>éœ€è¦ <code>__prepare__</code> æ³¨å…¥ç¯å¢ƒ</strong></td><td>âœ—</td><td>âœ“</td></tr></tbody></table>
<h3 data-id="heading-4">ç±»,å®ä¾‹å’Œå…ƒç±»çš„å…³ç³»</h3>
<h4 data-id="heading-5">å®ä¾‹æŸ¥æ‰¾å›¾è°±</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81833a107cbe4cbbb3a6068c54372af0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmVyYmFubnVuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766909953&amp;x-signature=Wp0y3CSz4xXj4rSu1ePTj2xOSoI%3D" alt="class-attribute-lookup-v3.png" loading="lazy"/></p>
<p>è§£é‡Š:</p>
<p>1.type(obj) çš„ MRO æ‰¾ data descriptor</p>
<p>2.å¦‚æœæŸ¥è¯¢ä¸åˆ°å†å›åˆ°<code>obj.__dict__</code>è·å–</p>
<p>3.type(obj) çš„ MRO æ‰¾ non-data / æ™®é€šå±æ€§</p>
<ol start="4">
<li>å¦‚æœè¿˜æ˜¯è·å–ä¸åˆ°,<code>__getattr__ </code>å…œåº•</li>
</ol>
<p><strong>æ³¨æ„:ä¸ä¼šèµ°metaclassæŸ¥è¯¢å±æ€§æ–¹æ³•!</strong></p>
<p><strong>mroä¼šæ‰«ä¸¤é</strong></p>
<h4 data-id="heading-6">ç±»æŸ¥è¯¢å›¾è°±</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90b51aa30e8c4090b98512ea36f4c9f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmVyYmFubnVuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766909953&amp;x-signature=l0D2XQGL1Khg6M9pWfuyUjl%2FLjs%3D" alt="class-creation.png" loading="lazy"/></p>
<p>è§£é‡Š</p>
<ol>
<li>Metaclass MRO æ‰¾ data descriptor [M â†’ type]</li>
<li>Class MRO æ‰¾ ä»»ä½• descriptor æˆ–æ™®é€šå±æ€§ [Class â†’ bases â†’ object]</li>
<li>Metaclass MRO æ‰¾ non-data descriptor æˆ–æ™®é€šå±æ€§ [M â†’ type]</li>
<li>Metaclass.<strong>getattr</strong> å…œåº•</li>
</ol>
<p><strong>ä¼šæŸ¥æ‰¾å…ƒç±»çš„<code>__dict__</code>å±æ€§</strong></p>
<p><strong>mroæ‰«æä¸¤æ¬¡</strong></p>
<h4 data-id="heading-7">magic method</h4>
<blockquote>
<p>One distinctive feature of Python is magic methods: they allow the programmer to override behavior for various operators and behavior of objects.</p>
</blockquote>
<p><strong>Magic Method éšå¼è°ƒç”¨ï¼ˆlen(obj)ã€obj + xï¼‰, ç›´æ¥æŸ¥ type(obj)ï¼Œè·³è¿‡ <code>instance.__dict__</code> ,å’Œæ™®é€šå±æ€§æŸ¥æ‰¾ä¸åŒ</strong></p>
<h4 data-id="heading-8">å±æ€§æŸ¥æ‰¾ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-comment"># ç»§æ‰¿é“¾: C -&gt; B -&gt; A -&gt; object</span>
<span class="hljs-comment"># å…ƒç±»é“¾: MyMeta -&gt; type</span>


<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Part 0: ç»“æ„å®šä¹‰"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)


<span class="hljs-comment"># ---------- Data Descriptor ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataDescriptor</span>:
    <span class="hljs-string">"""Data descriptor: æœ‰ __get__ å’Œ __set__"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):
        self.name = name

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__get__</span>(<span class="hljs-params">self, instance, owner</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [DataDescriptor.__get__] name=<span class="hljs-subst">{self.name}</span>, instance=<span class="hljs-subst">{instance}</span>, owner=<span class="hljs-subst">{owner}</span>"</span>)
        <span class="hljs-keyword">if</span> instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> self
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"DataDesc(<span class="hljs-subst">{self.name}</span>)"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__set__</span>(<span class="hljs-params">self, instance, value</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [DataDescriptor.__set__] name=<span class="hljs-subst">{self.name}</span>, value=<span class="hljs-subst">{value}</span>"</span>)


<span class="hljs-comment"># ---------- Non-Data Descriptor ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NonDataDescriptor</span>:
    <span class="hljs-string">"""Non-data descriptor: åªæœ‰ __get__"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name</span>):
        self.name = name

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__get__</span>(<span class="hljs-params">self, instance, owner</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [NonDataDescriptor.__get__] name=<span class="hljs-subst">{self.name}</span>, instance=<span class="hljs-subst">{instance}</span>, owner=<span class="hljs-subst">{owner}</span>"</span>)
        <span class="hljs-keyword">if</span> instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> self
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"NonDataDesc(<span class="hljs-subst">{self.name}</span>)"</span>


<span class="hljs-comment"># ---------- Metaclass ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta</span>(<span class="hljs-title class_ inherited__">type</span>):
    <span class="hljs-string">"""è‡ªå®šä¹‰å…ƒç±»"""</span>

    <span class="hljs-comment"># å…ƒç±»ä¸Šçš„ data descriptor</span>
    meta_data_desc = DataDescriptor(<span class="hljs-string">"meta_data_desc"</span>)

    <span class="hljs-comment"># å…ƒç±»ä¸Šçš„ non-data descriptor</span>
    meta_nondata_desc = NonDataDescriptor(<span class="hljs-string">"meta_nondata_desc"</span>)

    <span class="hljs-comment"># å…ƒç±»ä¸Šçš„æ™®é€šå±æ€§</span>
    meta_attr = <span class="hljs-string">"MyMeta.meta_attr"</span>

    <span class="hljs-comment"># å…ƒç±»ä¸Šçš„ __len__ï¼ˆmagic methodï¼‰</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [MyMeta.__len__] called on <span class="hljs-subst">{cls}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">999</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">cls, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [MyMeta.__getattr__] name=<span class="hljs-subst">{name}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"MyMeta.__getattr__(<span class="hljs-subst">{name}</span>)"</span>


<span class="hljs-comment"># ---------- Class A (åŸºç±») ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>(metaclass=MyMeta):
    <span class="hljs-comment"># A ä¸Šçš„ data descriptor</span>
    a_data_desc = DataDescriptor(<span class="hljs-string">"a_data_desc"</span>)

    <span class="hljs-comment"># A ä¸Šçš„ non-data descriptor</span>
    a_nondata_desc = NonDataDescriptor(<span class="hljs-string">"a_nondata_desc"</span>)

    <span class="hljs-comment"># A ä¸Šçš„æ™®é€šå±æ€§</span>
    a_attr = <span class="hljs-string">"A.a_attr"</span>

    <span class="hljs-comment"># ä¼šè¢« B è¦†ç›–çš„å±æ€§</span>
    inherited_attr = <span class="hljs-string">"A.inherited_attr"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [A.__len__] called on <span class="hljs-subst">{self}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getattr__</span>(<span class="hljs-params">self, name</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    [A.__getattr__] name=<span class="hljs-subst">{name}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"A.__getattr__(<span class="hljs-subst">{name}</span>)"</span>


<span class="hljs-comment"># ---------- Class B (ä¸­é—´ç±») ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span>(<span class="hljs-title class_ inherited__">A</span>):
    <span class="hljs-comment"># B ä¸Šçš„ data descriptor</span>
    b_data_desc = DataDescriptor(<span class="hljs-string">"b_data_desc"</span>)

    <span class="hljs-comment"># è¦†ç›– A çš„å±æ€§</span>
    inherited_attr = <span class="hljs-string">"B.inherited_attr"</span>

    <span class="hljs-comment"># B ä¸Šçš„æ™®é€šå±æ€§</span>
    b_attr = <span class="hljs-string">"B.b_attr"</span>


<span class="hljs-comment"># ---------- Class C (æœ€ç»ˆç±») ----------</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span>(<span class="hljs-title class_ inherited__">B</span>):
    <span class="hljs-comment"># C ä¸Šçš„ data descriptor</span>
    c_data_desc = DataDescriptor(<span class="hljs-string">"c_data_desc"</span>)

    <span class="hljs-comment"># C ä¸Šçš„ non-data descriptor</span>
    c_nondata_desc = NonDataDescriptor(<span class="hljs-string">"c_nondata_desc"</span>)

    <span class="hljs-comment"># C ä¸Šçš„æ™®é€šå±æ€§</span>
    c_attr = <span class="hljs-string">"C.c_attr"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># å®ä¾‹å±æ€§</span>
        self.instance_attr = <span class="hljs-string">"c.__dict__['instance_attr']"</span>
        <span class="hljs-comment"># å°è¯•è¦†ç›– non-data descriptor</span>
        self.__dict__[<span class="hljs-string">'c_nondata_desc'</span>] = <span class="hljs-string">"c.__dict__['c_nondata_desc']"</span>
        <span class="hljs-comment"># å°è¯•è¦†ç›– data descriptor (ä¸ä¼šç”Ÿæ•ˆ)</span>
        self.__dict__[<span class="hljs-string">'c_data_desc'</span>] = <span class="hljs-string">"c.__dict__['c_data_desc']"</span>


<span class="hljs-comment"># åˆ›å»ºå®ä¾‹</span>
c = C()

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"""
ç»§æ‰¿é“¾ (MRO):
  C.__mro__ = <span class="hljs-subst">{C.__mro__}</span>

å®ä¾‹åŒ–é“¾:
  c.__class__ = <span class="hljs-subst">{c.__class__}</span>
  C.__class__ = <span class="hljs-subst">{C.__class__}</span>
  MyMeta.__class__ = <span class="hljs-subst">{MyMeta.__class__}</span>

c.__dict__ = <span class="hljs-subst">{c.__dict__}</span>
"""</span>)

<span class="hljs-comment"># ============================================</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Part 1: Instance å±æ€§æŸ¥æ‰¾ (c.attr)"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.1 Data Descriptor ä¼˜å…ˆäº instance.__dict__ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.c_data_desc ="</span>, c.c_data_desc)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ è™½ç„¶ c.__dict__ æœ‰ 'c_data_desc'ï¼Œä½† data descriptor ä¼˜å…ˆ"</span>)
c_dict_c_data_desc=c.__dict__[<span class="hljs-string">"c_data_desc"</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"c.__dict__ä¸­c_data_descçš„å€¼æ˜¯<span class="hljs-subst">{c_dict_c_data_desc}</span>,è¿™ä¸ªå€¼æ¥è‡ªäºinstanceçš„__dict__ï¼Œä½†æ²¡æœ‰è¢«è®¿é—®åˆ°"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.2 instance.__dict__ ä¼˜å…ˆäº Non-Data Descriptor ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.c_nondata_desc ="</span>, c.c_nondata_desc)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ c.__dict__['c_nondata_desc'] è¦†ç›–äº† non-data descriptor"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.3 instance.__dict__ æ™®é€šå±æ€§ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.instance_attr ="</span>, c.instance_attr)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.4 æ²¿ MRO æ‰¾ Non-Data Descriptor (A ä¸Šå®šä¹‰çš„) ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.a_nondata_desc ="</span>, c.a_nondata_desc)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.5 æ²¿ MRO æ‰¾æ™®é€šç±»å±æ€§ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.a_attr ="</span>, c.a_attr)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.b_attr ="</span>, c.b_attr)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.inherited_attr ="</span>, c.inherited_attr, <span class="hljs-string">"(B è¦†ç›–äº† A)"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.6 __getattr__ å…œåº• ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.not_exist ="</span>, c.not_exist)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 1.7 Metaclass å±æ€§å¯¹ instance ä¸å¯è§ ---"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.meta_attr ="</span>, c.meta_attr)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ æŠ¥é”™ï¼instance ä¸ä¼šæŸ¥ metaclass ,èµ°å…œåº•æ£€æŸ¥__getattr__"</span>)

<span class="hljs-comment"># ============================================</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Part 2: Class å±æ€§æŸ¥æ‰¾ (C.attr)"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.1 Metaclass Data Descriptor ä¼˜å…ˆ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.meta_data_desc ="</span>, C.meta_data_desc)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.2 Class MRO ä¸Šçš„ Descriptor ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.c_data_desc ="</span>, C.c_data_desc)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ instance=None è¯´æ˜æ˜¯é€šè¿‡ç±»è®¿é—®"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.3 Class MRO ä¸Šçš„æ™®é€šå±æ€§ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.c_attr ="</span>, C.c_attr)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.a_attr ="</span>, C.a_attr)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.4 Metaclass Non-Data Descriptor ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.meta_nondata_desc ="</span>, C.meta_nondata_desc)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.5 Metaclass æ™®é€šå±æ€§ ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.meta_attr ="</span>, C.meta_attr)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 2.6 Metaclass __getattr__ å…œåº• ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"C.class_not_exist ="</span>, C.class_not_exist)

<span class="hljs-comment"># ============================================</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Part 3: Magic Method éšå¼è°ƒç”¨"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 3.1 len(instance) ç›´æ¥æŸ¥ type(instance) ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"len(c) ="</span>, <span class="hljs-built_in">len</span>(c))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ ç›´æ¥è°ƒç”¨ A.__len__ï¼Œè·³è¿‡ instance.__dict__"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 3.2 len(Class) ç›´æ¥æŸ¥ type(Class) å³ Metaclass ---"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"len(C) ="</span>, <span class="hljs-built_in">len</span>(C))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"  â†’ ç›´æ¥è°ƒç”¨ MyMeta.__len__"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- 3.3 å¯¹æ¯”ï¼šæ˜¾å¼è°ƒç”¨ vs éšå¼è°ƒç”¨ ---"</span>)
c.__len__ = <span class="hljs-keyword">lambda</span>: <span class="hljs-number">777</span>  <span class="hljs-comment"># å¡è¿› instance.__dict__</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"c.__len__() ="</span>, c.__len__(), <span class="hljs-string">"  (æ˜¾å¼è°ƒç”¨ï¼Œèµ°æ­£å¸¸å±æ€§é“¾)"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"len(c) ="</span>, <span class="hljs-built_in">len</span>(c), <span class="hljs-string">"       (éšå¼è°ƒç”¨ï¼Œè·³è¿‡ instance.__dict__)"</span>)

</code></pre>
<h3 data-id="heading-9">ç±»åˆ›å»ºæµç¨‹</h3>
<blockquote>
<ul>
<li><code>Metaclass.__prepare__</code> just returns the namespace object (a dictionary-like object as explained before).</li>
<li><code>Metaclass.__new__</code> returns the <code>Class</code> object.</li>
<li><code>MetaMetaclass.__call__</code> returns whatever <code>Metaclass.__new__</code> returned (and if it returned an instance of <code>Metaclass</code> it will also call <code>Metaclass.__init__</code> on it).</li>
</ul>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bb23742d9bd449cb12279d4da9a2bd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdmVyYmFubnVuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766909953&amp;x-signature=Tu%2BT2YFpGgFEojuRFPqqK6NpdGs%3D" alt="object-attribute-lookup-v3.png" loading="lazy"/></p>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMeta</span>(<span class="hljs-title class_ inherited__">type</span>):

    <span class="hljs-comment"># 1. ç±»å®šä¹‰å‰ï¼šå‡†å¤‡ namespace</span>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__prepare__</span>(<span class="hljs-params">metacls, name, bases, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[1] __prepare__: å‡†å¤‡ <span class="hljs-subst">{name}</span> çš„ namespace"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    metacls = <span class="hljs-subst">{metacls}</span>"</span>)
        namespace = {<span class="hljs-string">'injected'</span>: <span class="hljs-number">100</span>}
        <span class="hljs-keyword">return</span> namespace

    <span class="hljs-comment"># 2. ç±»å®šä¹‰åï¼šåˆ›å»ºç±»å¯¹è±¡</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">metacls, name, bases, namespace</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[2] __new__: åˆ›å»ºç±» <span class="hljs-subst">{name}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    namespace = <span class="hljs-subst">{<span class="hljs-built_in">dict</span>(namespace)}</span>"</span>)
        cls = <span class="hljs-built_in">super</span>().__new__(metacls, name, bases, namespace)
        <span class="hljs-keyword">return</span> cls

    <span class="hljs-comment"># 3. ç±»å¯¹è±¡åˆ›å»ºåï¼šåˆå§‹åŒ–ç±»å¯¹è±¡</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">cls, name, bases, namespace</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[3] __init__: åˆå§‹åŒ–ç±» <span class="hljs-subst">{name}</span>"</span>)
        cls.added_by_init = <span class="hljs-string">"å…ƒç±» __init__ æ·»åŠ çš„"</span>
        <span class="hljs-built_in">super</span>().__init__(name, bases, namespace)

    <span class="hljs-comment"># 4. ç±»è¢«è°ƒç”¨æ—¶ï¼šæ§åˆ¶å®ä¾‹åˆ›å»º</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">cls, *args, **kwargs</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[4] __call__: åˆ›å»º <span class="hljs-subst">{cls.__name__}</span> çš„å®ä¾‹"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    args = <span class="hljs-subst">{args}</span>"</span>)
        instance = <span class="hljs-built_in">super</span>().__call__(*args, **kwargs)
        instance.added_by_call = <span class="hljs-string">"å…ƒç±» __call__ æ·»åŠ çš„"</span>
        <span class="hljs-keyword">return</span> instance

</code></pre>
<h3 data-id="heading-10">æ€»ç»“</h3>
<p>å®ä¾‹åªèƒ½çœ‹åˆ°ç±»å®šä¹‰çš„å±æ€§ï¼Œä½†çœ‹ä¸åˆ°å…ƒç±»å®šä¹‰çš„å±æ€§ã€‚ç±»æ—¢èƒ½çœ‹åˆ°è‡ªå·±å®šä¹‰çš„ï¼Œä¹Ÿèƒ½çœ‹åˆ°å…ƒç±»å®šä¹‰çš„ã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯é­”æœ¯æ–¹æ³•ï¼Œå®ƒæ°¸è¿œåªçœ‹ type(obj)ã€‚</p>
<p>åŒè½¨æœºåˆ¶</p>
<h3 data-id="heading-11">å‚è€ƒ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.ionelmc.ro%2F2015%2F02%2F09%2Funderstanding-python-metaclasses%2F" target="_blank" title="https://blog.ionelmc.ro/2015/02/09/understanding-python-metaclasses/" ref="nofollow noopener noreferrer">Understanding Python metaclasses</a></p>
<h3 data-id="heading-12">ä¸ªäººåšå®¢</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Felliot-blog.com%2Fposts%2F202512%2Fpython_metaclass%2F" target="_blank" title="https://elliot-blog.com/posts/202512/python_metaclass/" ref="nofollow noopener noreferrer">elliot-blog.com/posts/20251â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆäº”ï¼‰]]></title>    <link>https://juejin.cn/post/7585463258691616777</link>    <guid>https://juejin.cn/post/7585463258691616777</guid>    <pubDate>2025-12-20T16:02:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585463258691616777" data-draft-id="7585706951603322906" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆäº”ï¼‰"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-20T16:02:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åå­—è¢«ä½ ä»¬æƒ³å®Œäº†"/> <meta itemprop="url" content="https://juejin.cn/user/3065854916834782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆäº”ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3065854916834782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åå­—è¢«ä½ ä»¬æƒ³å®Œäº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T16:02:23.000Z" title="Sat Dec 20 2025 16:02:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆäº”ï¼‰</h2>
<p>Flutter: 3.35.6</p>
<p>å‰é¢æˆ‘ä»¬ç®€å•å®ç°äº†å±æ€§çš„æŠ½å–å’Œå…ƒç´ çš„ç§»åŠ¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®ç°å…ƒç´ çš„æ—‹è½¬ï¼ˆå› ä¸ºæ—‹è½¬æ¶‰åŠåˆ°è§’åº¦çš„å˜åŒ–ï¼Œæ‰€ä»¥å…ˆè¡Œå®ç°ï¼‰ï¼Œå› ä¸ºåŸç†åœ¨ä¹‹å‰çš„å•ä¸ªä¸­å·²ç»åˆ†æäº†ï¼Œæ‰€ä»¥è¿™é‡Œä¾ç„¶ä»¥ä»£ç ç»“åˆè¯¦ç»†æ³¨é‡Šæ¥è¯´æ˜ï¼Œåªå¯¹ç‰¹åˆ«æ³¨æ„çš„ç‚¹å•ç‹¬æå–å‡ºæ¥è¯´æ˜ã€‚</p>
<p>å› ä¸ºå‰é¢æˆ‘ä»¬æŠ½å–äº†å“åº”åŒºåŸŸçš„ä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿäº†è§£åˆ°ï¼Œå“åº”æ“ä½œçš„åŒºåŸŸä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥ç›´æ¥æå–åˆ—è¡¨å­˜å‚¨å“åº”åŒºåŸŸã€‚ä¸‹é¢å°±è¯¥è®¨è®ºå¦‚ä½•æ¸²æŸ“è¿™äº›åŒºåŸŸï¼Œç¬¬ä¸€ç§æ–¹å¼å°±æ˜¯æˆ‘ä»¬ç›´æ¥ä»¥å…ƒç´ è‡ªèº«ä¸ºå‚è€ƒï¼Œå®šä½è¿™äº›åŒºåŸŸï¼Œç„¶åç”¨é€‰ä¸­çŠ¶æ€åˆ¤æ–­ï¼Œé€‰ä¸­å°±å±•ç¤ºï¼Œå–æ¶ˆå°±éšè—ï¼›å¦å¤–ä¸€ç§æ–¹å¼å°±æ˜¯æ‰€æœ‰å­å…ƒç´ å…±ç”¨ä¸€ä¸ªï¼Œé€šè¿‡é€‰ä¸­å…ƒç´ çš„çŠ¶æ€å»æ§åˆ¶ã€‚è¿™é‡Œé€‰æ‹©çš„æ˜¯ç¬¬ä¸€ç§æ–¹å¼ï¼Œä¸éœ€è¦å¤æ‚çš„è®¡ç®—ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">ç”¨äºè®¾ç½®ä¸€äº›åˆå§‹åŒ–å€¼</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConstantsConfig</span> </span>{
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-comment">/// <span class="markdown">å…ƒç´ çš„æ“ä½œåŒºåŸŸ</span></span>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; baseAreaList = [
    <span class="hljs-comment">// æ—‹è½¬</span>
    ResponseAreaModel(
      areaWidth: <span class="hljs-number">20</span>,
      areaHeight: <span class="hljs-number">20</span>,
      xRatio: <span class="hljs-number">1</span>,
      yRatio: <span class="hljs-number">0</span>,
      status: ElementStatus.rotate,
      icon: <span class="hljs-string">'assets/images/icon_rotate.png'</span>,
      trigger: TriggerMethod.move,
    ),
  ];
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æŠ½å–æ¸²æŸ“çš„å…ƒç´ </span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TransformItem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Positioned(
      <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

      <span class="hljs-comment">// æ–°å¢æ—‹è½¬åŠŸèƒ½</span>
      child: Transform.rotate(
        angle: elementItem.rotationAngle,
        child: Container(
          <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

          <span class="hljs-comment">// æ–°å¢åŒºåŸŸçš„æ¸²æŸ“</span>
          child: selected ? Stack(
            clipBehavior: Clip.none,
            children: [
              ...ConstantsConfig.baseAreaList.map((item) =&gt; Positioned(
                top: elementItem.elementHeight * item.yRatio - item.areaHeight / <span class="hljs-number">2</span>,
                left: elementItem.elementWidth * item.xRatio - item.areaWidth / <span class="hljs-number">2</span>,
                child: Image.asset(
                  item.icon,
                  width: item.areaWidth,
                  height: item.areaHeight,
                ),
              )),
            ],
          ) : <span class="hljs-keyword">null</span>,
        ),
      )
    );
  }
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b00e8aa438446e0a0b03b1f61df7783~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766851343&amp;x-signature=f5f8ePR6S%2Fpr1JBh5n84tTBUHNE%3D" alt="image01.gif" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†æ—‹è½¬åŒºåŸŸçš„æ¸²æŸ“ï¼Œæ¥ä¸‹æ¥å°±å®ç°æ‹–åŠ¨æ—‹è½¬åŠŸèƒ½ã€‚</p>
<p>è¿˜å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å•ä¸ªçš„æ—¶å€™æˆ‘ä»¬çš„åæ ‡ç³»éƒ½æ˜¯ä»¥å…ƒç´ è‡ªèº«ä¸ºå‚è€ƒï¼Œæ‰€ä»¥æ—‹è½¬çš„æ—¶å€™å‚è€ƒçš„åæ ‡ç³»ä¹Ÿè·Ÿç€æ—‹è½¬äº†ï¼Œæ‰€ä»¥åœ¨è®¡ç®—æ—‹è½¬åçš„ç‚¹åæ ‡æ—¶æˆ‘ä»¬ä½¿ç”¨äº† <code>final deg = rotateNumber * pi / 180;</code> è¿›è¡Œè¿˜åŸæ“ä½œï¼Œä½†åœ¨æ‰‹åŠ¿æå‡åˆ°å¤–å±‚å®¹å™¨äº†åï¼Œæ—‹è½¬éƒ½æ˜¯å…ƒç´ è‡ªèº«ï¼Œåæ ‡ç³»å§‹ç»ˆæ˜¯ä»¥å¤–å±‚å®¹å™¨ä¸ºå‚è€ƒï¼Œæ‰€ä»¥ä¸éœ€è¦è¿›è¡Œè¿˜åŸã€‚æ¥ä¸‹æ¥å®ç°å…ƒç´ çš„æ—‹è½¬ï¼ˆåŸç†ä¹‹å‰éƒ½åˆ†æäº†ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç»™å‡ºä¸€äº›æ–°å¢çš„å…³é”®ä»£ç ä»£ç åŠ æ³¨é‡Šï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">ä»¥ä¼ å…¥å…ƒç´ ä¸ºå‚è€ƒç¡®å®šæŸç‚¹æ—‹è½¬åçš„åæ ‡</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">ä»¥ä¼ å…¥çš„[item]ä¸ºå‚è€ƒï¼Œè®¡ç®—åŸåæ ‡[x]å’Œ[y]æ—‹è½¬åçš„åæ ‡</span></span>
Offset _rotatePoint({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> deg = item.rotationAngle;
  <span class="hljs-comment">// ç¡®å®šæ—‹è½¬ä¸­å¿ƒï¼Œåæ ‡ç³»æ˜¯ä»¥å¤–å±‚å®¹å™¨ä¸ºåŸºå‡†</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerX = item.x + item.elementWidth / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerY = item.y + item.elementHeight / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> diffX = x - centerX;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> diffY = y - centerY;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> dx = diffX * cos(deg) - diffY * sin(deg) + centerX;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> dy = diffX * sin(deg) + diffY * cos(deg) + centerY;

  <span class="hljs-keyword">return</span> Offset(dx, dy);
}

<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­ç‚¹å‡»è½ç‚¹æ˜¯å¦åœ¨å…ƒç´ çš„æŸä¸ªæ“ä½œåŒºåŸŸ</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">ä»¥ä¼ å…¥çš„[item]å…ƒç´ ä¸ºå‚è€ƒï¼Œ</span></span>
<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­å½“å‰ç‚¹å‡»çš„åæ ‡[x]å’Œ[y]æ˜¯å¦è½åœ¨[item]å…ƒç´ çš„æŸä¸ªå“åº”åŒºåŸŸ</span></span>
ElementStatus? _getElementZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  ElementStatus? tempStatus;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ConstantsConfig.baseAreaList.length; i++) {
    <span class="hljs-keyword">final</span> ResponseAreaModel currentArea = ConstantsConfig.baseAreaList[i];
    <span class="hljs-comment">// è®¡ç®—æ“æ—‹è½¬è¿‡åçš„æ“ä½œåŒºåŸŸçš„ä¸­å¿ƒç‚¹åæ ‡</span>
    <span class="hljs-keyword">final</span> Offset pos = _rotatePoint(
      x: item.x + item.elementWidth * currentArea.xRatio,
      y: item.y + item.elementHeight * currentArea.yRatio,
      item: item,
    );
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> dx = pos.dx;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> dy = pos.dy;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> areaCW = currentArea.areaWidth / <span class="hljs-number">2</span>;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> areaCH = currentArea.areaHeight / <span class="hljs-number">2</span>;

    <span class="hljs-comment">// ä»¥åŒºåŸŸä¸­å¿ƒç‚¹è®¡ç®—åŒºåŸŸè¾¹ç•Œå€¼å’Œåæ ‡è¿›è¡Œæ¯”è¾ƒ</span>
    <span class="hljs-keyword">if</span> (
      x &gt;= dx - areaCW &amp;&amp;
      x &lt;= dx + areaCW &amp;&amp;
      y &gt;= dy - areaCH &amp;&amp;
      y &lt;= dy + areaCH
    ) {
      tempStatus = currentArea.status;
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-keyword">return</span> tempStatus;
}

<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­ç‚¹å‡»çš„åŒºåŸŸ</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">ä»¥ä¼ å…¥çš„[item]å…ƒç´ ä¸ºå‚è€ƒï¼Œ</span></span>
<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­å½“å‰ç‚¹å‡»çš„åæ ‡[x]å’Œ[y]è½åœ¨[item]å…ƒç´ çš„å“ªä¸ªå“åº”åŒºåŸŸ</span></span>
ElementStatus? _onDownZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-comment">// å…ˆåˆ¤æ–­æ˜¯å¦åœ¨å“åº”å¯¹åº”æ“ä½œçš„åŒºåŸŸ</span>
  <span class="hljs-keyword">final</span> ElementStatus? areaStatus = _getElementZone(x: x, y: y, item: item);
  <span class="hljs-keyword">if</span> (areaStatus != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">return</span> areaStatus;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_insideElement(x: x, y: y, item: item)) {
    <span class="hljs-comment">// å› ä¸ºåŠ å…¥æ—‹è½¬ï¼Œæ‰€ä»¥å•ç‹¬æŠ½å–è½ç‚¹æ˜¯å¦åœ¨å…ƒç´ å†…éƒ¨çš„æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> ElementStatus.move;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­ç‚¹å‡»è½ç‚¹æ˜¯å¦åœ¨å…ƒç´ å†…éƒ¨</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">ä»¥ä¼ å…¥çš„[item]å…ƒç´ ä¸ºå‚è€ƒï¼Œ</span></span>
<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­å½“å‰ç‚¹å‡»çš„åæ ‡[x]å’Œ[y]æ˜¯å¦è½åœ¨[item]å…ƒç´ çš„å†…éƒ¨</span></span>
<span class="hljs-built_in">bool</span> _insideElement({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-built_in">bool</span> isInside = <span class="hljs-keyword">false</span>;

  <span class="hljs-comment">// è®¡ç®—å…ƒç´ çš„å››ä¸ªé¡¶ç‚¹åæ ‡</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;Offset&gt; square = [
    _rotatePoint(
      x: item.x,
      y: item.y,
      item: item,
    ),
    _rotatePoint(
      x: item.x + item.elementWidth,
      y: item.y,
      item: item,
    ),
    _rotatePoint(
      x: item.x + item.elementWidth,
      y: item.y + item.elementHeight,
      item: item,
    ),
    _rotatePoint(
      x: item.x,
      y: item.y + item.elementHeight,
      item: item,
    ),
  ];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = square.length - <span class="hljs-number">1</span>; i &lt; square.length; j = i++) {
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> xi = square[i].dx;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> yi = square[i].dy;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> xj = square[j].dx;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> yj = square[j].dy;
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> intersect = yi &gt; y != yj &gt; y &amp;&amp; x &lt; (xj - xi) * (y - yi) / (yj - yi) + xi;

    <span class="hljs-keyword">if</span> (intersect) isInside = !isInside;
  }

  <span class="hljs-keyword">return</span> isInside;
}

<span class="hljs-comment">/// <span class="markdown">å¤„ç†å…ƒç´ æ—‹è½¬</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">é€šè¿‡ç§»åŠ¨ç‚¹åæ ‡[x]å’Œ[y]ä¸æŒ‰ä¸‹çš„åˆå§‹åæ ‡è®¡ç®—æ—‹è½¬çš„è§’åº¦</span></span>
_onRotate({<span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x, <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y}) {
  <span class="hljs-keyword">if</span> (_currentElement == <span class="hljs-keyword">null</span> || _temporary == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerX = _currentElement!.x + _currentElement!.elementWidth / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerY = _currentElement!.y + _currentElement!.elementHeight / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> angleStart = atan2(
    _startPosition.dy - centerY,
    _startPosition.dx - centerX,
  );
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> angleEnd = atan2(y - centerY, x - centerX);

  _currentElement = _currentElement!.copyWith(
    rotationAngle: _temporary!.rotationAngle + angleEnd - angleStart,
  );
  _onChange();
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d53f0dada9db4d90b9d0c535c65a2be3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766851343&amp;x-signature=xEYIHsBtUXyd4iVjrlc0Wtc9sJ8%3D" alt="image02.gif" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬å°±ç®€å•å®Œæˆäº†æ—‹è½¬åŠŸèƒ½ã€‚</p>
<p>å…¶å®ç°åœ¨æˆ‘ä»¬å¯¹äºåŒºåŸŸçš„å®ç°å°±æœ‰ä¸ªå¤§æ¦‚çš„æ­¥éª¤äº†ï¼š</p>
<ol>
<li>å‘åŒºåŸŸåˆ—è¡¨ä¸­æ–°å¢ä¸€ä¸ªåŒºåŸŸ</li>
<li>æ‰‹åŠ¿å“åº”çš„æ—¶å€™åˆ¤æ–­æ˜¯å¦åœ¨è¿™ä¸ªåŒºåŸŸï¼ˆåˆ¤æ–­åŒºåŸŸé€»è¾‘ï¼‰</li>
<li>åœ¨è¿™ä¸ªåŒºåŸŸæ‰§è¡Œç›¸åº”çš„ï¼ˆåŠŸèƒ½å®ç°é€»è¾‘ï¼‰</li>
</ol>
<p>æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¿«é€Ÿå®ç°ä¸€ä¸‹ç¼©æ”¾çš„åŠŸèƒ½ã€‚ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä»¥å®½åº¦ä¸ºåŸºå‡†å®ç°çš„å…ƒç´ ç¼©æ”¾ï¼Œè¿™æ ·å¦‚æœyå˜åŒ–å¤§äºxçš„å˜åŒ–ï¼Œå°±ä¼šä¸æ˜¯å¾ˆåè°ƒï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨æ–°çš„ä¸€ç§è®¡ç®—æ–¹å¼ï¼Œä»¥åˆå§‹æŒ‰ä¸‹çš„åæ ‡å’Œä¸­å¿ƒç‚¹åæ ‡çš„è·ç¦»å’Œç»“æŸç‚¹åæ ‡åˆ°ä¸­å¿ƒç‚¹åæ ‡çš„è·ç¦»æ¥è®¡ç®—ç¼©æ”¾çš„æ¯”ä¾‹ï¼Œé€šè¿‡è¿™ä¸ªæ¯”ä¾‹å†å»è®¡ç®—å®½é«˜ï¼Œè¿™æ ·å¯èƒ½ç¨å¾®ä¼šåè°ƒä¸€ç‚¹ã€‚ä¸è¿‡è¿™æ ·å°±éœ€è¦è®°å½•åˆå§‹çš„å®½é«˜ï¼ˆç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œå¯¹äºå®Œæ•´çš„å•æ¬¡æ“ä½œï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„å˜æ¢éƒ½æ˜¯åŸºäºä¸Šä¸€æ¬¡çš„çŠ¶æ€æ¥å åŠ çš„ï¼Œæ‰€ä»¥å˜æ¢è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨åˆå§‹çŠ¶æ€åŠ ä¸Šå˜æ¢çš„å·®å€¼å°±å¯ä»¥å¾—åˆ°ç§»åŠ¨è¿‡ç¨‹ä¸­çš„çŠ¶æ€ï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

<span class="hljs-comment">// ç¼©æ”¾</span>
ResponseAreaModel(
  areaWidth: <span class="hljs-number">20</span>,
  areaHeight: <span class="hljs-number">20</span>,
  xRatio: <span class="hljs-number">1</span>,
  yRatio: <span class="hljs-number">1</span>,
  status: ElementStatus.scale,
  icon: <span class="hljs-string">'assets/images/icon_scale.png'</span>,
  trigger: TriggerMethod.move,
),
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">å¤„ç†å…ƒç´ ç¼©æ”¾</span></span>
<span class="hljs-comment">///</span>
<span class="hljs-comment">/// <span class="markdown">é€šè¿‡ç§»åŠ¨ç‚¹åæ ‡[x]å’Œ[y]ä¸æŒ‰ä¸‹çš„åˆå§‹åæ ‡ï¼Œ</span></span>
<span class="hljs-comment">/// <span class="markdown">é€šè¿‡ä¸¤ä¸ªåæ ‡è·ç¦»ä¸­å¿ƒç‚¹çš„è·ç¦»è®¡ç®—ç¼©æ”¾æ¯”ä¾‹</span></span>
<span class="hljs-keyword">void</span> _onScale({<span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x, <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y}) {
  <span class="hljs-keyword">if</span> (_currentElement == <span class="hljs-keyword">null</span> || _temporary == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> oWidth = _temporary!.width;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> oHeight = _temporary!.height;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> oX = _temporary!.x;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> oY = _temporary!.y;
  <span class="hljs-comment">// ä¸­å¿ƒç‚¹åæ ‡ï¼Œå› ä¸ºç¼©æ”¾ä¸æ¶‰åŠåˆ°ç§»åŠ¨ï¼Œ</span>
  <span class="hljs-comment">// æ‰€ä»¥ä¸­å¿ƒç‚¹å…¶å®æ˜¯æ²¡å˜çš„ï¼Œç”¨æœ€åˆçš„å€¼è®¡ç®—å°±è¡Œ</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerX = oX + oWidth / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> centerY = oY + oHeight / <span class="hljs-number">2</span>;
  <span class="hljs-comment">// æŒ‰ä¸‹ç‚¹ä¸ä¸­å¿ƒç‚¹çš„è·ç¦»</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> lineStart = sqrt(
    pow(centerX - _startPosition.dx, <span class="hljs-number">2</span>) + pow(centerY - _startPosition.dy, <span class="hljs-number">2</span>),
  );

  <span class="hljs-comment">// æåœ°æä½çš„æ¦‚ç‡å‡ºç°0ï¼Œå› ä¸ºçœŸå®æ‰‹æŒ‡ç‚¹å‡»åˆ°åŸå§‹æ­£ä¸­å¿ƒç‚¹çš„æ¦‚ç‡å¤ªä½äº†</span>
  <span class="hljs-keyword">if</span> (lineStart == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> lineEnd = sqrt(pow(centerX - x, <span class="hljs-number">2</span>) + pow(centerY - y, <span class="hljs-number">2</span>));
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> resizeRatio = lineEnd / lineStart;
  <span class="hljs-built_in">double</span> newW = oWidth * resizeRatio;
  <span class="hljs-built_in">double</span> newH = oHeight * resizeRatio;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> minSize = ConstantsConfig.minSize;

  <span class="hljs-comment">// ä»¥çŸ­è¾¹ä¸ºåŸºå‡†æ¥è®¡ç®—æœ€å°å®½é«˜</span>
  <span class="hljs-keyword">if</span> (oWidth &lt;= oHeight &amp;&amp; newW &lt; minSize) {
    newW = minSize;
    newH = minSize * oHeight / oWidth;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oHeight &lt; oWidth &amp;&amp; newH &lt; minSize) {
    newH = minSize;
    newW = minSize * oWidth / oHeight;
  }

  <span class="hljs-comment">// ä»¥é•¿è¾¹ä¸ºåŸºå‡†æ¥è®¡ç®—æœ€å¤§å®½é«˜</span>
  <span class="hljs-keyword">if</span> (oWidth &gt;= oHeight &amp;&amp; newW &gt;= _containerWidth) {
    newW = _containerWidth;
    newH = _containerWidth * oHeight / oWidth;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oHeight &gt; oWidth &amp;&amp; newH &gt;= _containerHeight) {
    newH = _containerHeight;
    newW = _containerHeight * oWidth / oHeight;
  }

  <span class="hljs-keyword">if</span> (
    newW == _currentElement?.elementWidth &amp;&amp;
    newH == _currentElement?.elementHeight
  ) {
    <span class="hljs-keyword">return</span>;
  }

  _currentElement = _currentElement?.copyWith(
    elementWidth: newW,
    elementHeight: newH,
    x: oX - (newW - oWidth) / <span class="hljs-number">2</span>,
    y: oY - (newH - oHeight) / <span class="hljs-number">2</span>,
  );
  _onChange();
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f1f087008014c61bad0257bd8166d74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766851343&amp;x-signature=ne5K10YwpyDfSXmVu1c1D%2BOk3gw%3D" alt="image03.gif" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬å°±ç®€å•å°†å‰é¢å•ä¸ªå…ƒç´ çš„æ“ä½œå¤åˆ»å®ç°äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†å¤šåŠ å…¥å‡ ä¸ªå…ƒç´ çœ‹ä¸‹æ•ˆæœï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

<span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;ElementModel&gt; _elementList = [
  ElementModel(
    id: <span class="hljs-built_in">DateTime</span>.now().millisecondsSinceEpoch,
    elementWidth: <span class="hljs-number">100</span>,
    elementHeight: <span class="hljs-number">100</span>,
  ),
  ElementModel(
    id: <span class="hljs-built_in">DateTime</span>.now().millisecondsSinceEpoch - <span class="hljs-number">10</span>,
    elementWidth: <span class="hljs-number">80</span>,
    elementHeight: <span class="hljs-number">120</span>,
    x: <span class="hljs-number">50</span>,
    y: <span class="hljs-number">120</span>,
  ),
  ElementModel(
    id: <span class="hljs-built_in">DateTime</span>.now().millisecondsSinceEpoch + <span class="hljs-number">10</span>,
    elementWidth: <span class="hljs-number">60</span>,
    elementHeight: <span class="hljs-number">140</span>,
    x: <span class="hljs-number">100</span>,
    y: <span class="hljs-number">280</span>,
  ),
];
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5d1804c00d1465f8649411b455aaae7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766851343&amp;x-signature=%2F7OHQH47YZIWXUSTfR2lyMm3p8k%3D" alt="image04.gif" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·å°±ç®€å•å®ç°äº†å¤šä¸ªå…ƒç´ çš„å˜æ¢ã€‚ä»£ç è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œä¸ç€æ€¥ã€‚</p>
<p>æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ã€å‰ç«¯å­¦ä¹ å°è¥åœ°ã€‘ï¼Œä¸å®šæ—¶ä¼šåˆ†äº«ä¸€äº›å°åŠŸèƒ½ï½</p>
<p>ä»Šå¤©çš„åˆ†äº«åˆ°æ­¤ç»“æŸäº†ï¼Œæ„Ÿè°¢é˜…è¯»ï½æ‹œæ‹œï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æºç ï¼šReact 19 useActionState ä¸ Next.js Server Actions çš„å®Œç¾èåˆ]]></title>    <link>https://juejin.cn/post/7585463258691698697</link>    <guid>https://juejin.cn/post/7585463258691698697</guid>    <pubDate>2025-12-20T19:53:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585463258691698697" data-draft-id="7585484081436409907" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" æ·±å…¥æºç ï¼šReact 19 useActionState ä¸ Next.js Server Actions çš„å®Œç¾èåˆ"/> <meta itemprop="keywords" content="React.js,Next.js"/> <meta itemprop="datePublished" content="2025-12-20T19:53:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bytemanx"/> <meta itemprop="url" content="https://juejin.cn/user/4059855780846936"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             æ·±å…¥æºç ï¼šReact 19 useActionState ä¸ Next.js Server Actions çš„å®Œç¾èåˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4059855780846936/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bytemanx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T19:53:43.000Z" title="Sat Dec 20 2025 19:53:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨ React 19 çš„æ–° Hook <code>useActionState</code>ï¼ˆåŸ <code>useFormState</code>ï¼‰ï¼Œç»“åˆ Next.js æºç åˆ†æå…¶åœ¨ Progressive Enhancementï¼ˆæ¸è¿›å¢å¼ºï¼‰å’Œ Server Actions ä¸­çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ React 19 ä¸­ï¼Œ<code>useActionState</code> æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ–° Hookï¼Œå®ƒä¸“é—¨ç”¨äºå¤„ç† Form Actions çš„çŠ¶æ€ã€‚å¦‚æœä½ ä¹‹å‰ä½¿ç”¨è¿‡ <code>useFormState</code>ï¼Œå…¶å®å®ƒä»¬æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œåªæ˜¯åå­—å˜äº†ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ï¼š<strong>å…è®¸ä½ åœ¨ Form Action æäº¤æ—¶ï¼Œè·å–æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€ï¼ˆå¦‚é”™è¯¯ä¿¡æ¯ã€æˆåŠŸæç¤ºï¼‰ï¼Œå¹¶æ ¹æ®è¿™ä¸ªçŠ¶æ€æ›´æ–° UIã€‚</strong></p>
<p>ä½†æ›´é‡è¦çš„æ˜¯ï¼Œå½“å®ƒä¸ Next.js App Router ç»“åˆæ—¶ï¼Œå®ƒå±•ç°å‡ºäº†å¼ºå¤§çš„<strong>æ¸è¿›å¢å¼º</strong>ï¼ˆProgressive Enhancementï¼‰èƒ½åŠ›â€”â€”å³ä½¿ JavaScript è¢«ç¦ç”¨ï¼Œè¡¨å•ä¾ç„¶å¯ä»¥æ­£å¸¸æäº¤å¹¶æ›´æ–°çŠ¶æ€ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±é€šè¿‡æºç åˆ†æï¼Œçœ‹çœ‹ Next.js æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç‚¹çš„ã€‚</p>
<h2 data-id="heading-1">1. å®æˆ˜ï¼šuseActionState çš„åŸºæœ¬ç”¨æ³•</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ Todo List ä¾‹å­ã€‚è¿™ä¸ªä¾‹å­æ¥æºäº Next.js å®˜æ–¹ç¤ºä¾‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Ftree%2Fv16.1.0%2Fexamples%2Fnext-forms" target="_blank" title="https://github.com/vercel/next.js/tree/v16.1.0/examples/next-forms" ref="nofollow noopener noreferrer">next-forms</a>ã€‚</p>
<h3 data-id="heading-2">Server Action (<code>app/actions.ts</code>)</h3>
<p>è¿™æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ä»£ç ï¼Œè´Ÿè´£å¤„ç†æ•°æ®åº“æ“ä½œã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-string">"use server"</span>;

<span class="hljs-keyword">import</span> { revalidatePath } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/cache"</span>;
<span class="hljs-keyword">import</span> postgres <span class="hljs-keyword">from</span> <span class="hljs-string">"postgres"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;

<span class="hljs-comment">// ...æ•°æ®åº“è¿æ¥ä»£ç ...</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createTodo</span>(<span class="hljs-params">
  prevState: { message: <span class="hljs-built_in">string</span> },
  formData: FormData,
</span>) {
  <span class="hljs-keyword">const</span> schema = z.<span class="hljs-title function_">object</span>({
    <span class="hljs-attr">todo</span>: z.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>),
  });
  
  <span class="hljs-keyword">const</span> parse = schema.<span class="hljs-title function_">safeParse</span>({
    <span class="hljs-attr">todo</span>: formData.<span class="hljs-title function_">get</span>(<span class="hljs-string">"todo"</span>),
  });

  <span class="hljs-keyword">if</span> (!parse.<span class="hljs-property">success</span>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"Failed to create todo"</span> };
  }

  <span class="hljs-keyword">const</span> data = parse.<span class="hljs-property">data</span>;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> sql<span class="hljs-string">`
      INSERT INTO todos (text)
      VALUES (<span class="hljs-subst">${data.todo}</span>)
    `</span>;

    <span class="hljs-title function_">revalidatePath</span>(<span class="hljs-string">"/"</span>);
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">`Added todo <span class="hljs-subst">${data.todo}</span>`</span> };
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"Failed to create todo"</span> };
  }
}
</code></pre>
<p>æ³¨æ„ <code>createTodo</code> çš„ç­¾åï¼šå®ƒæ¥æ”¶ <code>prevState</code> ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚è¿™å°±æ˜¯ <code>useActionState</code> æ³¨å…¥çš„çŠ¶æ€ã€‚</p>
<h3 data-id="heading-3">Client Component (<code>app/add-form.tsx</code>)</h3>
<p>è¿™æ˜¯å®¢æˆ·ç«¯ç»„ä»¶ï¼Œä½¿ç”¨ <code>useActionState</code> ç»‘å®š Server Actionã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-string">"use client"</span>;

<span class="hljs-keyword">import</span> { useActionState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { useFormStatus } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom"</span>;
<span class="hljs-keyword">import</span> { createTodo } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/app/actions"</span>;

<span class="hljs-keyword">const</span> initialState = {
  <span class="hljs-attr">message</span>: <span class="hljs-string">""</span>,
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SubmitButton</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { pending } = <span class="hljs-title function_">useFormStatus</span>();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">aria-disabled</span>=<span class="hljs-string">{pending}</span>&gt;</span>
      Add
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">AddForm</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// useActionState æ¥æ”¶ action å’Œåˆå§‹çŠ¶æ€</span>
  <span class="hljs-comment">// è¿”å›æœ€æ–°çš„ state å’Œä¸€ä¸ªæ–°çš„ dispatch action</span>
  <span class="hljs-keyword">const</span> [state, formAction] = <span class="hljs-title function_">useActionState</span>(createTodo, initialState);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">{formAction}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"todo"</span>&gt;</span>Enter Task<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"todo"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"todo"</span> <span class="hljs-attr">required</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SubmitButton</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">aria-live</span>=<span class="hljs-string">"polite"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sr-only"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"status"</span>&gt;</span>
        {state?.message}
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¿™ä¸ªæ¨¡å¼éå¸¸ä¼˜é›…ï¼š</p>
<ol>
<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼š<code>message</code> ä¸ºç©ºã€‚</li>
<li><strong>æäº¤</strong>ï¼šç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œ<code>formAction</code> è§¦å‘ <code>createTodo</code>ã€‚</li>
<li><strong>æ›´æ–°</strong>ï¼šServer Action æ‰§è¡Œå®Œæ¯•è¿”å›æ–°å¯¹è±¡ï¼ˆå¦‚ <code>{ message: "Added todo..." }</code>ï¼‰ï¼Œ<code>state</code> è‡ªåŠ¨æ›´æ–°ï¼ŒUI é‡æ–°æ¸²æŸ“ã€‚</li>
</ol>
<h2 data-id="heading-4">2. æ ¸å¿ƒä¼˜åŠ¿ä¸€ï¼šæ—  JS æ”¯æŒ (Progressive Enhancement)</h2>
<p>å¤§å®¶è§‰å¾—ï¼Œå¦‚æœæˆ‘ç¦ç”¨äº†æµè§ˆå™¨çš„ JavaScriptï¼Œè¿™ä¸ªè¡¨å•è¿˜èƒ½å·¥ä½œå—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å¯ä»¥ï¼</strong></p>
<p>çœ‹çœ‹è¿™ä¸ªæ•ˆæœï¼ˆJS è¢«ç¦ç”¨ï¼‰ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74bb2145da2944a880cab694e5dfd14d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZW1hbng=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766865223&amp;x-signature=wjN1A08mVy7xlUtTlbWNNWtb9W4%3D" alt="disable JS æƒ…å†µä¸‹è¯·æ±‚JSå¤±è´¥å›¾" loading="lazy"/></p>
<p>è™½ç„¶ JS åŠ è½½å¤±è´¥ï¼Œä½†æäº¤è¡¨å•ä¾ç„¶å¯ä»¥æ›´æ–°é¡µé¢ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5ef5346a0b8446b80b32cb427aae876~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZW1hbng=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766865223&amp;x-signature=i0uX3sKNMhwWnM3Sm57ahvHaUVI%3D" alt="useActionStateåœ¨disable JSçš„æ¡ä»¶ä¸‹ä¾ç„¶å¯ä»¥å·¥ä½œ" loading="lazy"/></p>
<h3 data-id="heading-5">åŸç†åˆ†æï¼šMPA æ¨¡å¼</h3>
<p>å½“ JS è¢«ç¦ç”¨æ—¶ï¼Œ<code>&lt;form&gt;</code> ä¼šé€€åŒ–ä¸ºæ ‡å‡†çš„ HTML è¡¨å•æäº¤ã€‚æµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ª <code>POST</code> è¯·æ±‚åˆ°å½“å‰ URLã€‚</p>
<p>Next.js çš„æœåŠ¡å™¨ç«¯å¤„ç†é€»è¾‘ä¸»è¦åœ¨ <code>packages/next/src/server/app-render/action-handler.ts</code> ä¸­ã€‚</p>
<h4 data-id="heading-6">1. è¯†åˆ«è¯·æ±‚ç±»å‹</h4>
<p>Next.js ä¼šæ£€æŸ¥è¯·æ±‚æ˜¯å¦æ˜¯ Server Actionã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä¼šåŒºåˆ† <strong>Fetch Action</strong>ï¼ˆæœ‰ JSï¼ŒAJAX è¯·æ±‚ï¼‰å’Œ <strong>MPA Action</strong>ï¼ˆæ—  JSï¼Œè¡¨å• POSTï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts%23L547" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/server/app-render/action-handler.ts#L547" ref="nofollow noopener noreferrer">next.js/packages/neâ€¦</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// next.js/packages/next/src/server/app-render/action-handler.ts</span>

<span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">const</span> {
    actionId,
    isMultipartAction,
    isFetchAction, <span class="hljs-comment">// å…³é”®ç‚¹ï¼šæ˜¯å¦æœ‰ Next-Action å¤´æˆ–ç›¸å…³æ ‡è¯†</span>
    <span class="hljs-comment">// ...</span>
  } = <span class="hljs-title function_">getServerActionRequestMetadata</span>(req)
<span class="hljs-comment">// ...</span>
</code></pre>
<h4 data-id="heading-7">2. å¤„ç† MPA Action</h4>
<p>å¦‚æœ <code>isFetchAction</code> ä¸º falseï¼ˆå³æ—  JS ç¯å¢ƒï¼‰ï¼ŒNext.js ä¼šèµ°å¦ä¸€æ¡è·¯ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts%23L771" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/server/app-render/action-handler.ts#L771" ref="nofollow noopener noreferrer">next.js/packages/neâ€¦</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Multipart POST, but not a fetch action.</span>
<span class="hljs-comment">// Potentially an MPA action, we have to try decoding it to check.</span>

<span class="hljs-keyword">const</span> action = <span class="hljs-keyword">await</span> <span class="hljs-title function_">decodeAction</span>(formData, serverModuleMap)
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> action === <span class="hljs-string">'function'</span>) {
  <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª MPA action (æ—  JS)</span>
  
  <span class="hljs-comment">// æ‰§è¡Œ Action</span>
  <span class="hljs-keyword">const</span> { actionResult } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">executeActionAndPrepareForRender</span>(
    action,
    [], <span class="hljs-comment">// MPA æ¨¡å¼ä¸‹æ²¡æœ‰é¢å¤–çš„ç»‘å®šå‚æ•°</span>
    workStore,
    requestStore,
    actionWasForwarded
  )

  <span class="hljs-comment">// å…³é”®ï¼šè§£ç  Form State</span>
  <span class="hljs-keyword">const</span> formState = <span class="hljs-keyword">await</span> <span class="hljs-title function_">decodeFormState</span>(
    actionResult,
    formData,
    serverModuleMap
  )

  <span class="hljs-comment">// Skip the fetch path.</span>
  <span class="hljs-comment">// We need to render a full HTML version of the page for the response</span>
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'done'</span>,
    <span class="hljs-attr">result</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-comment">// è¿™é‡Œçš„ undefined æ„å‘³ç€åç»­ä¼šç»§ç»­è¿›è¡Œé¡µé¢æ¸²æŸ“ (App Render)</span>
    formState, <span class="hljs-comment">// æŠŠ Action çš„æ‰§è¡Œç»“æœä¼ é€’ç»™é¡µé¢æ¸²æŸ“æµç¨‹</span>
  }
}
</code></pre>
<p><strong>æ ¸å¿ƒæµç¨‹ï¼š</strong></p>
<ol>
<li><strong>è§£æ FormData</strong>ï¼šNext.js ä» POST body ä¸­è§£æå‡º <code>actionId</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªéšè—å­—æ®µï¼ŒReact ç”Ÿæˆçš„ï¼‰ã€‚</li>
<li><strong>æ‰§è¡Œ Action</strong>ï¼šæ‰¾åˆ°å¯¹åº”çš„ Server Action å‡½æ•°å¹¶æ‰§è¡Œã€‚</li>
<li><strong>æºå¸¦ State é‡æ–°æ¸²æŸ“</strong>ï¼šå®ƒ<strong>ä¸ä¼š</strong>è¿”å› JSONï¼Œè€Œæ˜¯å¸¦ç€ <code>formState</code>ï¼ˆAction çš„è¿”å›å€¼ï¼‰é‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢ï¼ˆFull Page Renderï¼‰ã€‚</li>
<li><strong>HTML è¿”å›</strong>ï¼šæµè§ˆå™¨æ”¶åˆ°çš„æ˜¯ä¸€ä¸ªæ–°çš„ HTML é¡µé¢ï¼Œå…¶ä¸­åŒ…å«äº†æ›´æ–°åçš„ UI å’Œæ•°æ®ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¦ç”¨ JS ä¹Ÿèƒ½å·¥ä½œï¼Next.js è‡ªåŠ¨å¸®æˆ‘ä»¬å¤„ç†äº†"å›é€€åˆ°ä¼ ç»Ÿè¡¨å•æäº¤"çš„æ‰€æœ‰é€»è¾‘ã€‚</p>
<h2 data-id="heading-8">3. æ ¸å¿ƒä¼˜åŠ¿äºŒï¼šå®¢æˆ·ç«¯äº¤äº’ä¸å±€éƒ¨æ›´æ–°</h2>
<p>å½“ JS å¯ç”¨æ—¶ï¼ŒReact ä¼šæ¥ç®¡è¡¨å•æäº¤ã€‚</p>
<h3 data-id="heading-9">å®¢æˆ·ç«¯åŠ«æŒ (<code>app-call-server.ts</code>)</h3>
<p>å½“è¡¨å•æäº¤æ—¶ï¼ŒNext.js çš„å®¢æˆ·ç«¯é€»è¾‘ä¼šæ‹¦æˆªå®ƒã€‚æ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨äº† React çš„ <code>startTransition</code>ï¼ˆå‚è€ƒï¼š<a href="https://juejin.cn/post/7582890166358425626" target="_blank" title="https://juejin.cn/post/7582890166358425626">æ·±å…¥ç†è§£ React çš„ startTransition</a>ï¼‰æ¥æ ‡è®°éç´§æ€¥æ›´æ–°ï¼Œä¿æŒ UI å“åº”æ€§ï¼š</p>
<p>æºç é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fclient%2Fapp-call-server.ts%23L5" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/client/app-call-server.ts#L5" ref="nofollow noopener noreferrer">packages/next/src/client/app-call-server.ts#L5</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">callServer</span>(<span class="hljs-params">actionId: <span class="hljs-built_in">string</span>, actionArgs: <span class="hljs-built_in">any</span>[]</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">dispatchAppRouterAction</span>({
        <span class="hljs-attr">type</span>: <span class="hljs-variable constant_">ACTION_SERVER_ACTION</span>,
        actionId,
        actionArgs,
        resolve,
        reject,
      })
    })
  })
}
</code></pre>
<h3 data-id="heading-10">å‘é€è¯·æ±‚ (<code>server-action-reducer.ts</code>)</h3>
<p>è¯·æ±‚ä¼šé€šè¿‡ <code>fetchServerAction</code> å‘é€ã€‚æ³¨æ„ï¼Œè¿™æ¬¡æ˜¯ <code>fetch</code> è¯·æ±‚ï¼Œä¸”å¸¦æœ‰ç‰¹æ®Šçš„ Headerï¼š</p>
<p>æºç é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fclient%2Fcomponents%2Frouter-reducer%2Freducers%2Fserver-action-reducer.ts%23L96" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/client/components/router-reducer/reducers/server-action-reducer.ts#L96" ref="nofollow noopener noreferrer">packages/next/src/client/components/router-reducer/reducers/server-action-reducer.ts#L96</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchServerAction</span>(<span class="hljs-params"><span class="hljs-comment">/*...*/</span></span>) {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">headers</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
    <span class="hljs-title class_">Accept</span>: <span class="hljs-variable constant_">RSC_CONTENT_TYPE_HEADER</span>, <span class="hljs-comment">// å‘Šè¯‰æœåŠ¡å™¨æˆ‘è¦ RSC Payload (Flight Data)</span>
    [<span class="hljs-variable constant_">ACTION_HEADER</span>]: actionId,       <span class="hljs-comment">// Next-Action: &lt;id&gt;</span>
    [<span class="hljs-variable constant_">NEXT_ROUTER_STATE_TREE_HEADER</span>]: <span class="hljs-title function_">prepareFlightRouterStateForRequest</span>(state.<span class="hljs-property">tree</span>),
    <span class="hljs-comment">// ...</span>
  }
  
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(state.<span class="hljs-property">canonicalUrl</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>, headers, body })
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-11">ä¼˜åŠ¿</h3>
<ol>
<li><strong>å±€éƒ¨æ›´æ–°</strong>ï¼šæœåŠ¡å™¨è¿”å›çš„æ˜¯ RSC Payloadï¼ˆDiffï¼‰ï¼ŒReact åªæ›´æ–°å˜åŠ¨çš„éƒ¨åˆ†ï¼Œé¡µé¢ä¸åˆ·æ–°ï¼Œæ»šåŠ¨æ¡ä½ç½®ä¿ç•™ã€‚</li>
<li><strong>Pending çŠ¶æ€</strong>ï¼š<code>useFormStatus</code> å¯ä»¥ç«‹å³è¯»å– <code>pending</code> çŠ¶æ€ï¼Œå±•ç¤º Loading åŠ¨ç”»ã€‚è¿™æ˜¯ä¼ ç»Ÿ HTML è¡¨å•åšä¸åˆ°çš„ã€‚</li>
</ol>
<h2 data-id="heading-12">4. æ ¸å¿ƒä¼˜åŠ¿ä¸‰ï¼šServer-Side UI Updates (RSC é›†æˆ)</h2>
<p>è¿™æ˜¯ <code>useActionState</code> + Next.js æœ€å¼ºå¤§çš„åœ°æ–¹ã€‚</p>
<p>ä¼ ç»Ÿçš„ API è¯·æ±‚æµç¨‹æ˜¯ï¼š
<code>Client è¯·æ±‚ -&gt; Server å¤„ç† -&gt; Server è¿”å› JSON -&gt; Client è§£æ JSON -&gt; Client æ›´æ–° State -&gt; Client é‡æ–°æ¸²æŸ“ç»„ä»¶</code></p>
<p>Next.js Server Actions çš„æµç¨‹æ˜¯ï¼š
<code>Client è¯·æ±‚ -&gt; Server å¤„ç† -&gt; Server é‡æ–°æ¸²æŸ“ç»„ä»¶ (RSC) -&gt; Server è¿”å› UI è¡¥ä¸ (Flight Data) -&gt; Client åº”ç”¨è¡¥ä¸</code></p>
<h3 data-id="heading-13">æºç éªŒè¯</h3>
<p>åœ¨ <code>action-handler.ts</code> ä¸­ï¼Œå½“ Action æ‰§è¡Œå®Œåï¼š</p>
<p>æºç é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts%23L1081" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/server/app-render/action-handler.ts#L1081" ref="nofollow noopener noreferrer">packages/next/src/server/app-render/action-handler.ts#L1081</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ... Action æ‰§è¡Œå®Œæ¯• ...</span>

<span class="hljs-comment">// For form actions, we need to continue rendering the page.</span>
<span class="hljs-keyword">if</span> (isFetchAction) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'done'</span>,
    <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> <span class="hljs-title function_">generateFlight</span>(req, ctx, requestStore, {
      <span class="hljs-attr">actionResult</span>: <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(actionResult),
      <span class="hljs-comment">// ...</span>
    }),
  }
}
</code></pre>
<p><code>generateFlight</code> ä¼šç”Ÿæˆ React Server Component çš„åºåˆ—åŒ–æ•°æ®ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨ Action ä¸­è°ƒç”¨äº† <code>revalidatePath('/')</code>ï¼š</p>
<ol>
<li>Next.js ä¼šåœ¨æœåŠ¡å™¨ä¸Šé‡æ–°æ¸²æŸ“é¦–é¡µã€‚</li>
<li>ä½ çš„ <code>todos</code> åˆ—è¡¨ï¼ˆä»æ•°æ®åº“è¯»å–ï¼‰ä¼šåœ¨<strong>æœåŠ¡å™¨ç«¯</strong>æ›´æ–°ã€‚</li>
<li>æ–°çš„ UI ç»“æ„ï¼ˆåŒ…å«æ–°æ·»åŠ çš„ todoï¼‰ä¼šè¢«å‘é€ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>å®¢æˆ·ç«¯ç›´æ¥åˆå¹¶ DOMï¼Œä¸éœ€è¦åœ¨å®¢æˆ·ç«¯å†™ä¸€è¡Œ <code>todos.push(newTodo)</code> çš„çŠ¶æ€ç®¡ç†ä»£ç ï¼</li>
</ol>
<p><strong>Form çŠ¶æ€ä¸ UI æ›´æ–°åŒæ­¥</strong>ï¼š<code>useActionState</code> æ‹¿åˆ°äº† <code>message</code>ï¼Œè€Œé¡µé¢åˆ—è¡¨é€šè¿‡ RSC æ›´æ–°äº†ã€‚</p>
<h2 data-id="heading-14">5. å…¶ä»–ä¼˜åŠ¿</h2>
<h3 data-id="heading-15">å®‰å…¨æ€§ (CSRF è‡ªåŠ¨é˜²æŠ¤)</h3>
<p>åœ¨ <code>action-handler.ts</code> ä¸­ï¼ŒNext.js å†…ç½®äº† Origin æ£€æŸ¥ï¼Œé˜²æ­¢ CSRF æ”»å‡»ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fnext.js%2Fblob%2Fv16.1.0%2Fpackages%2Fnext%2Fsrc%2Fserver%2Fapp-render%2Faction-handler.ts%23L622" target="_blank" title="https://github.com/vercel/next.js/blob/v16.1.0/packages/next/src/server/app-render/action-handler.ts#L622" ref="nofollow noopener noreferrer">next.js/packages/neâ€¦</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// next.js/packages/next/src/server/app-render/action-handler.ts</span>
<span class="hljs-comment">// This is to prevent CSRF attacks. </span>
<span class="hljs-keyword">if</span> (!originDomain) {
  <span class="hljs-comment">// ... warning</span>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!host || originDomain !== host.<span class="hljs-property">value</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isCsrfOriginAllowed</span>(originDomain, serverActions?.<span class="hljs-property">allowedOrigins</span>)) {
    <span class="hljs-comment">// Allowed</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Block attack</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`... Aborting the action.`</span>)
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<h3 data-id="heading-16">ç®€åŒ–ä»£ç </h3>
<p>å¯¹æ¯”ä¸€ä¸‹ä¼ ç»Ÿåšæ³•ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿ</strong>ï¼š<code>onSubmit</code>, <code>e.preventDefault()</code>, <code>fetch('/api/...')</code>, <code>await res.json()</code>, <code>if (res.ok) ... else ...</code>ï¼Œè¿˜è¦å¤„ç† Loadingã€‚</li>
<li><strong>Next.js</strong>ï¼šä¸€ä¸ª <code>action</code> å±æ€§æå®šã€‚é”™è¯¯å¤„ç†å’Œ Loading çŠ¶æ€éƒ½é€šè¿‡ Hook è‡ªåŠ¨ç®¡ç†ã€‚</li>
</ul>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p><code>useActionState</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªçŠ¶æ€ç®¡ç† Hookï¼Œåœ¨ Next.js ä¸­ï¼Œå®ƒæ˜¯è¿æ¥å®¢æˆ·ç«¯è¡¨å•ä¸æœåŠ¡ç«¯é€»è¾‘çš„æ¡¥æ¢ã€‚</p>
<p>å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ol>
<li><strong>æ¸è¿›å¢å¼º</strong>ï¼šJS æŒ‚äº†ï¼Ÿæ²¡é—®é¢˜ï¼ŒMPA æ¨¡å¼é¡¶ä¸Šã€‚</li>
<li><strong>å¼€å‘ä½“éªŒ</strong>ï¼šåƒå†™æ™®é€šå‡½æ•°ä¸€æ ·å†™åç«¯é€»è¾‘ï¼Œä¸éœ€è¦æ‰‹åŠ¨ fetchã€‚</li>
<li><strong>RSC èåˆ</strong>ï¼šä¸€æ¬¡è¯·æ±‚ï¼ŒåŒæ—¶å®Œæˆ"çŠ¶æ€æ›´æ–°"å’Œ"UI é‡æ–°æ¸²æŸ“"ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šåº•å±‚ä½¿ç”¨ <code>startTransition</code>ï¼Œä¿æŒ UI å“åº”æ€§ï¼Œé¿å…é˜»å¡æ¸²æŸ“ã€‚</li>
<li><strong>å®‰å…¨å¯é </strong>ï¼šå†…ç½® CSRF é˜²æŠ¤ã€‚</li>
</ol>
<p>ä¸‹æ¬¡å†™è¡¨å•æ—¶ï¼Œè¯•è¯• <code>useActionState</code>ï¼Œæ„Ÿå—ä¸€ä¸‹ç°ä»£ React å¼€å‘çš„é­…åŠ›å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nicegui 3.4.0 å¯ä»¥ç¼©å°ç»„ä»¶ä¹‹é—´çš„é—´è· label botton input textarea]]></title>    <link>https://juejin.cn/post/7585476892977201186</link>    <guid>https://juejin.cn/post/7585476892977201186</guid>    <pubDate>2025-12-21T01:02:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585476892977201186" data-draft-id="7585555806666850338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nicegui 3.4.0 å¯ä»¥ç¼©å°ç»„ä»¶ä¹‹é—´çš„é—´è· label botton input textarea"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T01:02:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="PieroPC"/> <meta itemprop="url" content="https://juejin.cn/user/1998231182522521"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nicegui 3.4.0 å¯ä»¥ç¼©å°ç»„ä»¶ä¹‹é—´çš„é—´è· label botton input textarea
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1998231182522521/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    PieroPC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T01:02:13.000Z" title="Sun Dec 21 2025 01:02:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b57cace516cd4a2491df172e54860aeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766883732&amp;x-signature=7OTEBn4O58qfO2dCl%2Fs%2F8dR5Ex4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">ç¼©å°è¾“å…¥æ¡†ä¹‹é—´çš„é—´è·ï¼š</h2>
<h3 data-id="heading-1">1. <strong>ä½¿ç”¨ç´§å‡‘å¸ƒå±€å®¹å™¨</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0'</span>):  <span class="hljs-comment"># è®¾ç½®é—´è·ä¸º0</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è¾“å…¥æ¡†1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è¾“å…¥æ¡†2'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è¾“å…¥æ¡†3'</span>)
</code></pre>
<h3 data-id="heading-2">2. <strong>è‡ªå®šä¹‰é—´è·ç±»</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–¹æ³•1: ä½¿ç”¨Tailwind CSSç±»</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):  <span class="hljs-comment"># è®¾ç½®è¾ƒå°çš„é—´è·ï¼ˆ0.25remï¼‰</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å§“å'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é‚®ç®±'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”µè¯'</span>)

<span class="hljs-comment"># æ–¹æ³•2: æ›´å°çš„é—´è·</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-px'</span>):  <span class="hljs-comment"># æœ€å°é—´è·ï¼ˆ1pxï¼‰</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”¨æˆ·å'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¯†ç '</span>)
</code></pre>
<h3 data-id="heading-3">3. <strong>ä½¿ç”¨ç½‘æ ¼å¸ƒå±€å‡å°‘é—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç½‘æ ¼å¸ƒå±€å¯ä»¥æ›´ç²¾ç¡®æ§åˆ¶</span>
<span class="hljs-keyword">with</span> ui.grid(columns=<span class="hljs-number">1</span>).classes(<span class="hljs-string">'gap-1'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é¡¹ç›®1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é¡¹ç›®2'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é¡¹ç›®3'</span>)
</code></pre>
<h3 data-id="heading-4">4. <strong>è‡ªå®šä¹‰CSSæ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å…¨å±€å‡å°‘æ‰€æœ‰è¾“å…¥æ¡†é—´è·</span>
ui.add_css(<span class="hljs-string">'''
    .nicegui-content .q-field {
        margin-bottom: 4px !important;
    }
    .nicegui-content .q-field__control {
        min-height: 40px !important;
    }
'''</span>)

<span class="hljs-comment"># æˆ–è€…é’ˆå¯¹ç‰¹å®šå®¹å™¨</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'my-container'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æµ‹è¯•1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æµ‹è¯•2'</span>)
    
ui.add_css(<span class="hljs-string">'''
    .my-container .q-field {
        margin-bottom: 2px !important;
    }
'''</span>)
</code></pre>
<h3 data-id="heading-5">5. <strong>ä½¿ç”¨ç´§å‡‘æ¨¡å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆ›å»ºç´§å‡‘çš„è¡¨å•</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'compact-form'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å­—æ®µA'</span>).classes(<span class="hljs-string">'my-1'</span>)  <span class="hljs-comment"># ä¸Šä¸‹è¾¹è·1</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å­—æ®µB'</span>).classes(<span class="hljs-string">'my-1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å­—æ®µC'</span>).classes(<span class="hljs-string">'my-1'</span>)

ui.add_css(<span class="hljs-string">'''
    .compact-form .q-field {
        margin-bottom: 4px;
    }
    .compact-form .q-field__label {
        font-size: 12px;
        margin-bottom: 2px;
    }
'''</span>)
</code></pre>
<h3 data-id="heading-6">6. <strong>æ°´å¹³æ’åˆ—å‡å°‘å‚ç›´é—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¦‚æœåˆé€‚ï¼Œå¯ä»¥è€ƒè™‘æ°´å¹³æ’åˆ—</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-2'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'åå­—'</span>).classes(<span class="hljs-string">'w-32'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å§“æ°'</span>).classes(<span class="hljs-string">'w-32'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¹´é¾„'</span>).classes(<span class="hljs-string">'w-20'</span>)
</code></pre>
<h3 data-id="heading-7">7. <strong>å®Œæ•´ç¤ºä¾‹</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> nicegui <span class="hljs-keyword">import</span> ui

<span class="hljs-comment"># æ–¹æ³•1: ä½¿ç”¨ç´§å‡‘åˆ—</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 w-64'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”¨æˆ·å'</span>).props(<span class="hljs-string">'dense'</span>)  <span class="hljs-comment"># denseå±æ€§è®©è¾“å…¥æ¡†æ›´ç´§å‡‘</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¯†ç '</span>).props(<span class="hljs-string">'dense outlined'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç¡®è®¤å¯†ç '</span>).props(<span class="hljs-string">'dense outlined'</span>)

ui.separator()

<span class="hljs-comment"># æ–¹æ³•2: è‡ªå®šä¹‰é—´è·</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'my-form w-64'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é‚®ç®±åœ°å€'</span>).classes(<span class="hljs-string">'mb-1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ‰‹æœºå·ç '</span>).classes(<span class="hljs-string">'mb-1'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'åœ°å€'</span>).classes(<span class="hljs-string">'mb-1'</span>)

<span class="hljs-comment"># è‡ªå®šä¹‰CSS</span>
ui.add_css(<span class="hljs-string">'''
    .my-form .q-field {
        margin-bottom: 2px;
    }
    .my-form .q-field__control {
        min-height: 36px;
    }
'''</span>)

ui.run()
</code></pre>
<h3 data-id="heading-8">å»ºè®®ï¼š</h3>
<ol>
<li><strong>å…ˆå°è¯• <code>gap-1</code> æˆ– <code>gap-0.5</code></strong> - è¿™äº›é€šå¸¸æ˜¯åˆé€‚çš„ç´§å‡‘é—´è·</li>
<li><strong>é…åˆä½¿ç”¨ <code>props('dense')</code></strong> - è®©è¾“å…¥æ¡†å†…éƒ¨ä¹Ÿæ›´ç´§å‡‘</li>
<li><strong>ä½¿ç”¨ç½‘æ ¼å¸ƒå±€</strong> - å¯¹äºéœ€è¦ç²¾ç¡®æ§åˆ¶çš„æƒ…å†µ</li>
</ol>
<p>æ ¹æ®ä½ çš„å…·ä½“å¸ƒå±€éœ€æ±‚ï¼Œå¯ä»¥ç»„åˆä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚</p>
<h2 data-id="heading-9">å¯¹äºÂ <code>ui.textarea</code>ï¼Œç¼©å°é—´è·</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53393c6c33df4a1fa9ed6fa6b681c5f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766883732&amp;x-signature=b0lk4yyMWumJwaznfmdLvh9MCy4%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹äº <code>ui.textarea</code>ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•ç¼©å°é—´è·ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹ <code>ui.textarea</code> çš„å…·ä½“æ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-10">1. <strong>ä½¿ç”¨ç´§å‡‘å¸ƒå±€å®¹å™¨</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºæœ¬çš„ç´§å‡‘å¸ƒå±€</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):  <span class="hljs-comment"># å°é—´è·</span>
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ ‡é¢˜'</span>)
    ui.textarea(label=<span class="hljs-string">'å†…å®¹æè¿°'</span>).props(<span class="hljs-string">'rows=3'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ ‡ç­¾'</span>)
</code></pre>
<h3 data-id="heading-11">2. <strong>è‡ªå®šä¹‰textareaæ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å‡å°‘ç‰¹å®štextareaçš„é—´è·</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 w-full'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ä¸»é¢˜'</span>)
    
    <span class="hljs-comment"># ä½¿ç”¨propsè°ƒæ•´textareaç‰¹æ€§</span>
    ui.textarea(label=<span class="hljs-string">'è¯¦ç»†å†…å®¹'</span>) \
        .props(<span class="hljs-string">'''
            dense
            outlined
            autogrow
            rows=3
        '''</span>) \
        .classes(<span class="hljs-string">'mb-1'</span>)  <span class="hljs-comment"># å•ç‹¬æ§åˆ¶ä¸‹è¾¹è·</span>
    
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è”ç³»æ–¹å¼'</span>)
</code></pre>
<h3 data-id="heading-12">3. <strong>å¤šä¸ªtextareaç´§å‡‘æ’åˆ—</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'compact-textareas gap-1'</span>):
    ui.textarea(label=<span class="hljs-string">'éœ€æ±‚æè¿°'</span>).props(<span class="hljs-string">'rows=2 dense'</span>)
    ui.textarea(label=<span class="hljs-string">'æŠ€æœ¯è¦æ±‚'</span>).props(<span class="hljs-string">'rows=2 dense'</span>)
    ui.textarea(label=<span class="hljs-string">'å¤‡æ³¨è¯´æ˜'</span>).props(<span class="hljs-string">'rows=1 dense'</span>)

ui.add_css(<span class="hljs-string">'''
    .compact-textareas .q-field {
        margin-bottom: 4px !important;
    }
    .compact-textareas textarea {
        min-height: 60px !important;
    }
'''</span>)
</code></pre>
<h3 data-id="heading-13">4. <strong>è¡¨å•ä¸­æ··åˆä½¿ç”¨inputå’Œtextarea</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆ›å»ºç´§å‡‘è¡¨å•</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'w-96 gap-1'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é¡¹ç›®åç§°'</span>).props(<span class="hljs-string">'dense outlined'</span>)
    
    ui.textarea(label=<span class="hljs-string">'é¡¹ç›®æè¿°'</span>) \
        .props(<span class="hljs-string">'dense outlined autogrow rows=2'</span>) \
        .classes(<span class="hljs-string">'min-h-[80px]'</span>)
    
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è´Ÿè´£äºº'</span>).props(<span class="hljs-string">'dense outlined'</span>)
    
    ui.textarea(label=<span class="hljs-string">'æ³¨æ„äº‹é¡¹'</span>) \
        .props(<span class="hljs-string">'dense outlined rows=1'</span>) \
        .classes(<span class="hljs-string">'min-h-[50px]'</span>)
    
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æˆªæ­¢æ—¥æœŸ'</span>).props(<span class="hljs-string">'dense outlined'</span>)
</code></pre>
<h3 data-id="heading-14">5. <strong>ä½¿ç”¨ç½‘æ ¼å¸ƒå±€ç²¾ç¡®æ§åˆ¶</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ç½‘æ ¼å¸ƒå±€æ§åˆ¶é—´è·</span>
<span class="hljs-keyword">with</span> ui.grid(columns=<span class="hljs-number">1</span>).classes(<span class="hljs-string">'gap-1 w-full'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ ‡é¢˜'</span>).props(<span class="hljs-string">'dense'</span>)
    
    ui.textarea(label=<span class="hljs-string">'æ­£æ–‡å†…å®¹'</span>) \
        .props(<span class="hljs-string">'dense autogrow rows=4'</span>) \
        .classes(<span class="hljs-string">'col-span-1'</span>)
    
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-2 w-full'</span>):
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'åˆ†ç±»'</span>).props(<span class="hljs-string">'dense'</span>).classes(<span class="hljs-string">'flex-grow'</span>)
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ä¼˜å…ˆçº§'</span>).props(<span class="hljs-string">'dense'</span>).classes(<span class="hljs-string">'w-24'</span>)
</code></pre>
<h3 data-id="heading-15">6. <strong>è‡ªå®šä¹‰é«˜åº¦å’Œé—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ§åˆ¶textareaçš„é«˜åº¦å’Œé—´è·</span>
ui.textarea(label=<span class="hljs-string">'è¯„è®º'</span>) \
    .props(<span class="hljs-string">'dense outlined rows=2'</span>) \
    .classes(<span class="hljs-string">'''
        mb-1
        min-h-[80px]
        max-h-[120px]
    '''</span>)

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨styleç›´æ¥è®¾ç½®</span>
ui.textarea(label=<span class="hljs-string">'å¤‡æ³¨'</span>) \
    .style(<span class="hljs-string">'margin-bottom: 4px; min-height: 60px;'</span>)
</code></pre>
<h3 data-id="heading-16">7. <strong>å®Œæ•´ç¤ºä¾‹ï¼šè¯„è®ºè¡¨å•</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> nicegui <span class="hljs-keyword">import</span> ui

<span class="hljs-comment"># ç´§å‡‘çš„è¯„è®ºè¡¨å•</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-96'</span>):
    ui.label(<span class="hljs-string">'å‘è¡¨è¯„è®º'</span>).classes(<span class="hljs-string">'text-lg font-bold mb-2'</span>)
    
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å§“å'</span>).props(<span class="hljs-string">'dense outlined'</span>)
        
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'é‚®ç®±'</span>).props(<span class="hljs-string">'dense outlined'</span>)
        
        ui.textarea(label=<span class="hljs-string">'è¯„è®ºå†…å®¹'</span>) \
            .props(<span class="hljs-string">'''
                dense
                outlined
                autogrow
                rows=2
                counter
                maxlength=200
            '''</span>) \
            .classes(<span class="hljs-string">'min-h-[80px] mb-1'</span>)
        
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'justify-end gap-2'</span>):
            ui.button(<span class="hljs-string">'å–æ¶ˆ'</span>, color=<span class="hljs-string">'gray'</span>)
            ui.button(<span class="hljs-string">'æäº¤'</span>, color=<span class="hljs-string">'primary'</span>)

ui.separator()

<span class="hljs-comment"># å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨è‡ªå®šä¹‰CSSç±»</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'compact-form w-96'</span>):
    ui.textarea(label=<span class="hljs-string">'éœ€æ±‚è¯´æ˜'</span>) \
        .props(<span class="hljs-string">'dense rows=3'</span>) \
        .classes(<span class="hljs-string">'form-field'</span>)
    
    ui.textarea(label=<span class="hljs-string">'å®ç°æ–¹æ¡ˆ'</span>) \
        .props(<span class="hljs-string">'dense rows=3'</span>) \
        .classes(<span class="hljs-string">'form-field'</span>)
    
    ui.textarea(label=<span class="hljs-string">'æµ‹è¯•è¦ç‚¹'</span>) \
        .props(<span class="hljs-string">'dense rows=2'</span>) \
        .classes(<span class="hljs-string">'form-field'</span>)

<span class="hljs-comment"># è‡ªå®šä¹‰CSS</span>
ui.add_css(<span class="hljs-string">'''
    .compact-form .form-field {
        margin-bottom: 4px !important;
    }
    .compact-form .q-field__control {
        min-height: 40px !important;
    }
    .compact-form textarea {
        padding: 6px !important;
        font-size: 14px !important;
    }
'''</span>)

ui.run()
</code></pre>
<h3 data-id="heading-17">8. <strong>å“åº”å¼å¸ƒå±€ä¸­çš„textarea</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä¸åŒè®¾å¤‡ä¸Šä¿æŒç´§å‡‘</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'''
    gap-1 
    sm:gap-2 
    md:gap-1
    w-full
    max-w-2xl
'''</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ ‡é¢˜'</span>).props(<span class="hljs-string">'dense'</span>)
    
    ui.textarea(label=<span class="hljs-string">'å†…å®¹'</span>) \
        .props(<span class="hljs-string">'dense autogrow'</span>) \
        .classes(<span class="hljs-string">'''
            min-h-[100px]
            sm:min-h-[120px]
            md:min-h-[150px]
        '''</span>)
    
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æ ‡ç­¾'</span>).props(<span class="hljs-string">'dense'</span>)
</code></pre>
<h3 data-id="heading-18">ä¸»è¦æŠ€å·§æ€»ç»“ï¼š</h3>
<ol>
<li><strong>ä½¿ç”¨ <code>props('dense')</code></strong> - è¿™æ˜¯è®©textareaå˜ç´§å‡‘çš„æœ€æœ‰æ•ˆæ–¹æ³•</li>
<li><strong>é…åˆ <code>rows</code> å±æ€§</strong> - æ§åˆ¶é»˜è®¤æ˜¾ç¤ºè¡Œæ•°</li>
<li><strong>ä½¿ç”¨ <code>gap-1</code> æˆ–æ›´å°çš„é—´è·ç±»</strong></li>
<li><strong>ç”¨ <code>min-h-[]</code> æ§åˆ¶æœ€å°é«˜åº¦</strong> - é¿å…textareaå¤ªå°</li>
<li><strong>è€ƒè™‘ä½¿ç”¨ <code>autogrow</code></strong> - è®©textareaæ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´é«˜åº¦</li>
</ol>
<p>æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç»„åˆæ–¹å¼ï¼</p>
<h2 data-id="heading-19">å¯¹äºÂ <code>ui.button</code>Â çš„é—´è·è°ƒæ•´</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0cb5b4bdf964f4cb2f0175e16ff94e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766883732&amp;x-signature=3NgmR7Nk78Hfbpv7qPUc0YxaZsk%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹äº <code>ui.button</code> çš„é—´è·è°ƒæ•´ï¼Œè¿™é‡Œæœ‰å¤šç§æ–¹æ³•ï¼š</p>
<h3 data-id="heading-20">1. <strong>æŒ‰é’®ç»„ç´§å‡‘æ’åˆ—</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ°´å¹³æŒ‰é’®ç»„</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1'</span>):  <span class="hljs-comment"># å°é—´è·</span>
    ui.button(<span class="hljs-string">'ä¿å­˜'</span>, color=<span class="hljs-string">'primary'</span>)
    ui.button(<span class="hljs-string">'å–æ¶ˆ'</span>, color=<span class="hljs-string">'gray'</span>)
    ui.button(<span class="hljs-string">'åˆ é™¤'</span>, color=<span class="hljs-string">'red'</span>)

<span class="hljs-comment"># å‚ç›´æŒ‰é’®ç»„</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 w-32'</span>):
    ui.button(<span class="hljs-string">'é€‰é¡¹ä¸€'</span>, color=<span class="hljs-string">'primary'</span>)
    ui.button(<span class="hljs-string">'é€‰é¡¹äºŒ'</span>, color=<span class="hljs-string">'secondary'</span>)
    ui.button(<span class="hljs-string">'é€‰é¡¹ä¸‰'</span>, color=<span class="hljs-string">'accent'</span>)
</code></pre>
<h3 data-id="heading-21">2. <strong>ç´§å‡‘æŒ‰é’®æ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨denseå±æ€§</span>
ui.button(<span class="hljs-string">'ç´§å‡‘æŒ‰é’®'</span>, color=<span class="hljs-string">'primary'</span>).props(<span class="hljs-string">'dense'</span>)

<span class="hljs-comment"># ç»„åˆä½¿ç”¨</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-0.5'</span>):
    ui.button(<span class="hljs-string">'æ–°å»º'</span>).props(<span class="hljs-string">'dense outline'</span>)
    ui.button(<span class="hljs-string">'ç¼–è¾‘'</span>).props(<span class="hljs-string">'dense outline'</span>)
    ui.button(<span class="hljs-string">'åˆ é™¤'</span>).props(<span class="hljs-string">'dense outline'</span>)
</code></pre>
<h3 data-id="heading-22">3. <strong>è¡¨å•ä¸­çš„ç´§å‡‘æŒ‰é’®</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'w-64 gap-2'</span>):
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”¨æˆ·å'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¯†ç '</span>).props(<span class="hljs-string">'dense type=password'</span>)
    
    <span class="hljs-comment"># æŒ‰é’®è¡Œä½¿ç”¨æ›´å°é—´è·</span>
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1 justify-end'</span>):
        ui.button(<span class="hljs-string">'ç™»å½•'</span>, color=<span class="hljs-string">'primary'</span>).props(<span class="hljs-string">'dense'</span>)
        ui.button(<span class="hljs-string">'é‡ç½®'</span>, color=<span class="hljs-string">'gray'</span>).props(<span class="hljs-string">'dense flat'</span>)
</code></pre>
<h3 data-id="heading-23">4. <strong>å›¾æ ‡æŒ‰é’®ç´§å‡‘æ’åˆ—</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å›¾æ ‡æŒ‰é’®å·¥å…·æ </span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-0.5 items-center'</span>):
    ui.button(icon=<span class="hljs-string">'format_bold'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(icon=<span class="hljs-string">'format_italic'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(icon=<span class="hljs-string">'format_underlined'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(icon=<span class="hljs-string">'format_color_text'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.separator().props(<span class="hljs-string">'vertical'</span>).classes(<span class="hljs-string">'mx-1'</span>)
    ui.button(icon=<span class="hljs-string">'undo'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(icon=<span class="hljs-string">'redo'</span>).props(<span class="hljs-string">'dense flat'</span>)
</code></pre>
<h3 data-id="heading-24">5. <strong>è‡ªå®šä¹‰æŒ‰é’®æ ·å¼å’Œé—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è‡ªå®šä¹‰æŒ‰é’®ç±»</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'compact-buttons'</span>):
    ui.button(<span class="hljs-string">'æ“ä½œ1'</span>).classes(<span class="hljs-string">'compact-btn'</span>)
    ui.button(<span class="hljs-string">'æ“ä½œ2'</span>).classes(<span class="hljs-string">'compact-btn'</span>)
    ui.button(<span class="hljs-string">'æ“ä½œ3'</span>).classes(<span class="hljs-string">'compact-btn'</span>)

ui.add_css(<span class="hljs-string">'''
    .compact-buttons {
        gap: 2px !important;
    }
    .compact-btn {
        padding: 4px 8px !important;
        font-size: 12px !important;
        min-height: 28px !important;
    }
'''</span>)
</code></pre>
<h3 data-id="heading-25">6. <strong>æŒ‰é’®ä¸å…¶ä»–å…ƒç´ çš„ç´§å‡‘å¸ƒå±€</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¾“å…¥æ¡†å¸¦æŒ‰é’®</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 w-80'</span>):
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-1 w-full'</span>):
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'æœç´¢å†…å®¹'</span>).props(<span class="hljs-string">'dense'</span>).classes(<span class="hljs-string">'flex-grow'</span>)
        ui.button(<span class="hljs-string">'æœç´¢'</span>, icon=<span class="hljs-string">'search'</span>).props(<span class="hljs-string">'dense'</span>)
    
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-1 w-full'</span>):
        ui.textarea(label=<span class="hljs-string">'æ¶ˆæ¯'</span>).props(<span class="hljs-string">'dense rows=2'</span>).classes(<span class="hljs-string">'flex-grow'</span>)
        ui.button(<span class="hljs-string">'å‘é€'</span>, icon=<span class="hljs-string">'send'</span>).props(<span class="hljs-string">'dense'</span>).classes(<span class="hljs-string">'self-end'</span>)
</code></pre>
<h3 data-id="heading-26">7. <strong>å¯¼èˆªæ /å·¥å…·æ ç´§å‡‘æŒ‰é’®</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç´§å‡‘å·¥å…·æ </span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-1 p-2 bg-gray-100 rounded'</span>):
    ui.button(<span class="hljs-string">'æ–‡ä»¶'</span>, icon=<span class="hljs-string">'folder'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(<span class="hljs-string">'ç¼–è¾‘'</span>, icon=<span class="hljs-string">'edit'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(<span class="hljs-string">'è§†å›¾'</span>, icon=<span class="hljs-string">'visibility'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(<span class="hljs-string">'å·¥å…·'</span>, icon=<span class="hljs-string">'build'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.space()  <span class="hljs-comment"># å ä½</span>
    ui.button(icon=<span class="hljs-string">'notifications'</span>).props(<span class="hljs-string">'dense flat'</span>)
    ui.button(icon=<span class="hljs-string">'account_circle'</span>).props(<span class="hljs-string">'dense flat'</span>)
</code></pre>
<h3 data-id="heading-27">8. <strong>å®Œæ•´ç¤ºä¾‹ï¼šç´§å‡‘è¡¨å•</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> nicegui <span class="hljs-keyword">import</span> ui

<span class="hljs-comment"># ç™»å½•è¡¨å•</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-80'</span>):
    ui.label(<span class="hljs-string">'ç³»ç»Ÿç™»å½•'</span>).classes(<span class="hljs-string">'text-lg font-bold mb-3'</span>)
    
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-2'</span>):
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”¨æˆ·å'</span>).props(<span class="hljs-string">'dense outlined'</span>)
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¯†ç '</span>).props(<span class="hljs-string">'dense outlined type=password'</span>)
        
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between'</span>):
            ui.checkbox(<span class="hljs-string">'è®°ä½ç™»å½•'</span>)
            
            <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1'</span>):
                ui.button(<span class="hljs-string">'æ³¨å†Œ'</span>, color=<span class="hljs-string">'gray'</span>).props(<span class="hljs-string">'dense flat'</span>)
                ui.button(<span class="hljs-string">'ç™»å½•'</span>, color=<span class="hljs-string">'primary'</span>).props(<span class="hljs-string">'dense'</span>)
    
    ui.separator().classes(<span class="hljs-string">'my-2'</span>)
    
    <span class="hljs-comment"># ç¤¾äº¤ç™»å½•æŒ‰é’®</span>
    ui.label(<span class="hljs-string">'å¿«é€Ÿç™»å½•'</span>).classes(<span class="hljs-string">'text-sm text-gray-500 mb-1'</span>)
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1 justify-center'</span>):
        ui.button(icon=<span class="hljs-string">'img:https://www.google.com/favicon.ico'</span>).props(<span class="hljs-string">'dense round'</span>)
        ui.button(icon=<span class="hljs-string">'img:https://github.com/favicon.ico'</span>).props(<span class="hljs-string">'dense round'</span>)
        ui.button(icon=<span class="hljs-string">'img:https://facebook.com/favicon.ico'</span>).props(<span class="hljs-string">'dense round'</span>)

<span class="hljs-comment"># æ•°æ®è¡¨æ ¼æ“ä½œæŒ‰é’®</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-full mt-4'</span>):
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between mb-3'</span>):
        ui.label(<span class="hljs-string">'ç”¨æˆ·åˆ—è¡¨'</span>).classes(<span class="hljs-string">'text-lg font-bold'</span>)
        
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1'</span>):
            ui.button(<span class="hljs-string">'æ–°å¢'</span>, icon=<span class="hljs-string">'add'</span>, color=<span class="hljs-string">'primary'</span>).props(<span class="hljs-string">'dense'</span>)
            ui.button(<span class="hljs-string">'å¯¼å…¥'</span>, icon=<span class="hljs-string">'upload'</span>).props(<span class="hljs-string">'dense outline'</span>)
            ui.button(<span class="hljs-string">'å¯¼å‡º'</span>, icon=<span class="hljs-string">'download'</span>).props(<span class="hljs-string">'dense outline'</span>)
            ui.button(<span class="hljs-string">'åˆ·æ–°'</span>, icon=<span class="hljs-string">'refresh'</span>).props(<span class="hljs-string">'dense flat'</span>)
    
    <span class="hljs-comment"># æ¨¡æ‹Ÿè¡¨æ ¼</span>
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
            <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-2 p-2 hover:bg-gray-50'</span>):
                ui.label(<span class="hljs-string">f'ç”¨æˆ· <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>'</span>)
                ui.space()
                <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-0.5'</span>):
                    ui.button(icon=<span class="hljs-string">'edit'</span>).props(<span class="hljs-string">'dense flat size=sm'</span>)
                    ui.button(icon=<span class="hljs-string">'delete'</span>).props(<span class="hljs-string">'dense flat size=sm color=red'</span>)

ui.run()
</code></pre>
<h3 data-id="heading-28">9. <strong>ä½¿ç”¨CSSè‡ªå®šä¹‰æŒ‰é’®æ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¶…ç´§å‡‘æŒ‰é’®</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'ultra-compact'</span>):
    ui.button(<span class="hljs-string">'æŒ‰é’®1'</span>)
    ui.button(<span class="hljs-string">'æŒ‰é’®2'</span>)
    ui.button(<span class="hljs-string">'æŒ‰é’®3'</span>)

ui.add_css(<span class="hljs-string">'''
    .ultra-compact {
        gap: 1px !important;
    }
    .ultra-compact button {
        margin: 0 !important;
        padding: 2px 6px !important;
        min-width: 0 !important;
        font-size: 11px !important;
        border-radius: 2px !important;
    }
'''</span>)
</code></pre>
<h3 data-id="heading-29">10. <strong>å“åº”å¼æŒ‰é’®é—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¹æ®å±å¹•å¤§å°è°ƒæ•´æŒ‰é’®é—´è·</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'''
    gap-1 
    sm:gap-2 
    md:gap-1
    lg:gap-0.5
'''</span>):
    ui.button(<span class="hljs-string">'é¦–é¡µ'</span>, icon=<span class="hljs-string">'home'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.button(<span class="hljs-string">'äº§å“'</span>, icon=<span class="hljs-string">'shopping_bag'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.button(<span class="hljs-string">'æœåŠ¡'</span>, icon=<span class="hljs-string">'handyman'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.button(<span class="hljs-string">'å…³äº'</span>, icon=<span class="hljs-string">'info'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.button(<span class="hljs-string">'è”ç³»'</span>, icon=<span class="hljs-string">'contact_mail'</span>).props(<span class="hljs-string">'dense'</span>)
</code></pre>
<h3 data-id="heading-30">ä¸»è¦æŠ€å·§ï¼š</h3>
<ol>
<li><strong>ä½¿ç”¨ <code>props('dense')</code></strong> - å‡å°æŒ‰é’®å†…è¾¹è·</li>
<li><strong>è®¾ç½® <code>gap-1</code> æˆ–æ›´å°</strong> - æ§åˆ¶æŒ‰é’®é—´è·</li>
<li><strong>å›¾æ ‡æŒ‰é’®ç”¨ <code>flat</code></strong> - å»æ‰èƒŒæ™¯æ›´ç´§å‡‘</li>
<li><strong>è‡ªå®šä¹‰CSS</strong> - ç²¾ç¡®æ§åˆ¶è¾¹è·å’Œå¤§å°</li>
<li><strong>è€ƒè™‘ä½¿ç”¨ <code>size=sm</code></strong> - æ›´å°çš„æŒ‰é’®å°ºå¯¸</li>
</ol>
<p>æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼</p>
<h2 data-id="heading-31">å¯¹äºÂ <code>ui.label</code>Â çš„é—´è·è°ƒæ•´</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ddf9d2330f24124b9e8be82c04a6957~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766883732&amp;x-signature=C%2F3CVex2JuXn8NWs7mOcxG6RCR8%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹äº <code>ui.label</code> çš„é—´è·è°ƒæ•´ï¼Œè¿™é‡Œæœ‰ä¸€äº›å®ç”¨çš„æ–¹æ³•ï¼š</p>
<h3 data-id="heading-32">1. <strong>æ ‡ç­¾ä¸è¾“å…¥æ¡†ç´§å‡‘æ’åˆ—</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºæœ¬ç´§å‡‘å¸ƒå±€</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):
    ui.label(<span class="hljs-string">'åŸºæœ¬ä¿¡æ¯'</span>).classes(<span class="hljs-string">'text-sm font-medium mb-0.5'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å§“å'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¹´é¾„'</span>).props(<span class="hljs-string">'dense'</span>)
</code></pre>
<h3 data-id="heading-33">2. <strong>è¡¨å•æ ‡ç­¾ç´§å‡‘æ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç´§å‡‘çš„è¡¨å•æ ‡ç­¾</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'w-64 gap-1'</span>):
    ui.label(<span class="hljs-string">'ç”¨æˆ·å:'</span>).classes(<span class="hljs-string">'''
        text-sm 
        font-medium 
        mb-0 
        -mt-1
    '''</span>)
    ui.<span class="hljs-built_in">input</span>(placeholder=<span class="hljs-string">'è¯·è¾“å…¥ç”¨æˆ·å'</span>).props(<span class="hljs-string">'dense'</span>)
    
    ui.label(<span class="hljs-string">'å¯†ç :'</span>).classes(<span class="hljs-string">'text-sm font-medium mb-0 mt-1'</span>)
    ui.<span class="hljs-built_in">input</span>(placeholder=<span class="hljs-string">'è¯·è¾“å…¥å¯†ç '</span>).props(<span class="hljs-string">'dense type=password'</span>)
</code></pre>
<h3 data-id="heading-34">3. <strong>è¡Œå†…æ ‡ç­¾ç´§å‡‘æ’åˆ—</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ°´å¹³å¸ƒå±€ç´§å‡‘æ ‡ç­¾</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-1'</span>):
    ui.label(<span class="hljs-string">'çŠ¶æ€:'</span>).classes(<span class="hljs-string">'text-sm'</span>)
    ui.toggle([<span class="hljs-string">'å¯ç”¨'</span>, <span class="hljs-string">'åœç”¨'</span>], value=<span class="hljs-string">'å¯ç”¨'</span>).props(<span class="hljs-string">'dense'</span>)
    ui.space()
    ui.label(<span class="hljs-string">'ä¼˜å…ˆçº§:'</span>).classes(<span class="hljs-string">'text-sm'</span>)
    ui.select([<span class="hljs-string">'é«˜'</span>, <span class="hljs-string">'ä¸­'</span>, <span class="hljs-string">'ä½'</span>], value=<span class="hljs-string">'ä¸­'</span>).props(<span class="hljs-string">'dense'</span>)
</code></pre>
<h3 data-id="heading-35">4. <strong>æ ‡é¢˜æ ‡ç­¾ç´§å‡‘æ ·å¼</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç´§å‡‘çš„æ ‡é¢˜åŒºåŸŸ</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1'</span>):
    ui.label(<span class="hljs-string">'ç”¨æˆ·è®¾ç½®'</span>).classes(<span class="hljs-string">'''
        text-lg 
        font-bold 
        mb-1
    '''</span>)
    
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-2'</span>):
        ui.label(<span class="hljs-string">'ä¸ªäººèµ„æ–™'</span>).classes(<span class="hljs-string">'text-base font-medium'</span>)
        ui.button(<span class="hljs-string">'ç¼–è¾‘'</span>, icon=<span class="hljs-string">'edit'</span>).props(<span class="hljs-string">'dense size=sm'</span>)
    
    ui.separator().classes(<span class="hljs-string">'my-1'</span>)
</code></pre>
<h3 data-id="heading-36">5. <strong>å¡ç‰‡å†…çš„ç´§å‡‘æ ‡ç­¾</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç´§å‡‘å¡ç‰‡å¸ƒå±€</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-80 p-3'</span>):
    <span class="hljs-comment"># å¡ç‰‡æ ‡é¢˜ç´§å‡‘</span>
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between mb-2'</span>):
        ui.label(<span class="hljs-string">'è®¢å•ä¿¡æ¯'</span>).classes(<span class="hljs-string">'text-base font-bold'</span>)
        ui.label(<span class="hljs-string">'ID: 202312345'</span>).classes(<span class="hljs-string">'text-xs text-gray-500'</span>)
    
    <span class="hljs-comment"># å†…å®¹åŒºåŸŸç´§å‡‘</span>
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0.5'</span>):
        ui.label(<span class="hljs-string">'å®¢æˆ·: å¼ ä¸‰'</span>).classes(<span class="hljs-string">'text-sm'</span>)
        ui.label(<span class="hljs-string">'ç”µè¯: 13800138000'</span>).classes(<span class="hljs-string">'text-sm'</span>)
        ui.label(<span class="hljs-string">'åœ°å€: åŒ—äº¬å¸‚æœé˜³åŒº'</span>).classes(<span class="hljs-string">'text-sm'</span>)
        ui.label(<span class="hljs-string">'é‡‘é¢: Â¥1280.00'</span>).classes(<span class="hljs-string">'text-sm font-medium'</span>)
</code></pre>
<h3 data-id="heading-37">6. <strong>è¡¨æ ¼/åˆ—è¡¨ä¸­çš„ç´§å‡‘æ ‡ç­¾</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç´§å‡‘çš„æ•°æ®åˆ—è¡¨</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0'</span>):
    <span class="hljs-comment"># è¡¨å¤´</span>
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'bg-gray-100 p-2 gap-2'</span>):
        ui.label(<span class="hljs-string">'å§“å'</span>).classes(<span class="hljs-string">'w-24 text-sm font-medium'</span>)
        ui.label(<span class="hljs-string">'éƒ¨é—¨'</span>).classes(<span class="hljs-string">'w-32 text-sm font-medium'</span>)
        ui.label(<span class="hljs-string">'çŠ¶æ€'</span>).classes(<span class="hljs-string">'w-20 text-sm font-medium'</span>)
        ui.label(<span class="hljs-string">'æ“ä½œ'</span>).classes(<span class="hljs-string">'flex-grow text-sm font-medium'</span>)
    
    <span class="hljs-comment"># æ•°æ®è¡Œ</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center p-2 border-b gap-2 hover:bg-gray-50'</span>):
            ui.label(<span class="hljs-string">f'å‘˜å·¥<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>'</span>).classes(<span class="hljs-string">'w-24 text-sm'</span>)
            ui.label(<span class="hljs-string">f'éƒ¨é—¨<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>'</span>).classes(<span class="hljs-string">'w-32 text-sm'</span>)
            ui.label(<span class="hljs-string">'åœ¨èŒ'</span>).classes(<span class="hljs-string">'w-20 text-xs text-green-600'</span>)
            <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'gap-1'</span>):
                ui.button(<span class="hljs-string">'æŸ¥çœ‹'</span>, icon=<span class="hljs-string">'visibility'</span>).props(<span class="hljs-string">'dense flat size=sm'</span>)
                ui.button(<span class="hljs-string">'ç¼–è¾‘'</span>, icon=<span class="hljs-string">'edit'</span>).props(<span class="hljs-string">'dense flat size=sm'</span>)
</code></pre>
<h3 data-id="heading-38">7. <strong>æ ‡ç­¾ä¸å›¾æ ‡ç´§å‡‘ç»„åˆ</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¸¦å›¾æ ‡çš„ç´§å‡‘æ ‡ç­¾</span>
<span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center gap-1'</span>):
    ui.icon(<span class="hljs-string">'info'</span>, color=<span class="hljs-string">'blue'</span>, size=<span class="hljs-string">'sm'</span>)
    ui.label(<span class="hljs-string">'è¿™æ˜¯ä¸€æ¡æç¤ºä¿¡æ¯'</span>).classes(<span class="hljs-string">'text-sm text-blue-600'</span>)
</code></pre>
<h3 data-id="heading-39">8. <strong>å®Œæ•´ç¤ºä¾‹ï¼šç´§å‡‘è®¾ç½®é¢æ¿</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> nicegui <span class="hljs-keyword">import</span> ui

<span class="hljs-comment"># è®¾ç½®é¢æ¿</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-96'</span>):
    <span class="hljs-comment"># é¢æ¿æ ‡é¢˜</span>
    ui.label(<span class="hljs-string">'ç³»ç»Ÿè®¾ç½®'</span>).classes(<span class="hljs-string">'text-lg font-bold mb-3'</span>)
    
    <span class="hljs-comment"># è®¾ç½®é¡¹åˆ†ç»„</span>
    ui.label(<span class="hljs-string">'å¤–è§‚è®¾ç½®'</span>).classes(<span class="hljs-string">'text-base font-medium mb-2 -mt-1'</span>)
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 ml-3'</span>):
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between'</span>):
            ui.label(<span class="hljs-string">'ä¸»é¢˜æ¨¡å¼'</span>).classes(<span class="hljs-string">'text-sm'</span>)
            ui.select([<span class="hljs-string">'è‡ªåŠ¨'</span>, <span class="hljs-string">'æµ…è‰²'</span>, <span class="hljs-string">'æ·±è‰²'</span>], value=<span class="hljs-string">'è‡ªåŠ¨'</span>).props(<span class="hljs-string">'dense'</span>).classes(<span class="hljs-string">'w-32'</span>)
        
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between'</span>):
            ui.label(<span class="hljs-string">'å­—ä½“å¤§å°'</span>).classes(<span class="hljs-string">'text-sm'</span>)
            ui.slider(<span class="hljs-built_in">min</span>=<span class="hljs-number">12</span>, <span class="hljs-built_in">max</span>=<span class="hljs-number">18</span>, value=<span class="hljs-number">14</span>).classes(<span class="hljs-string">'w-32'</span>)
    
    ui.separator().classes(<span class="hljs-string">'my-2'</span>)
    
    ui.label(<span class="hljs-string">'é€šçŸ¥è®¾ç½®'</span>).classes(<span class="hljs-string">'text-base font-medium mb-2'</span>)
    <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-1 ml-3'</span>):
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between'</span>):
            ui.label(<span class="hljs-string">'æ¶ˆæ¯é€šçŸ¥'</span>).classes(<span class="hljs-string">'text-sm'</span>)
            ui.switch().props(<span class="hljs-string">'dense'</span>)
        
        <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'items-center justify-between'</span>):
            ui.label(<span class="hljs-string">'é‚®ä»¶æé†’'</span>).classes(<span class="hljs-string">'text-sm'</span>)
            ui.switch().props(<span class="hljs-string">'dense'</span>)
    
    ui.separator().classes(<span class="hljs-string">'my-2'</span>)
    
    <span class="hljs-comment"># æŒ‰é’®åŒºåŸŸ</span>
    <span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'justify-end gap-1'</span>):
        ui.button(<span class="hljs-string">'å–æ¶ˆ'</span>, color=<span class="hljs-string">'gray'</span>).props(<span class="hljs-string">'dense'</span>)
        ui.button(<span class="hljs-string">'ä¿å­˜è®¾ç½®'</span>, color=<span class="hljs-string">'primary'</span>).props(<span class="hljs-string">'dense'</span>)

<span class="hljs-comment"># çŠ¶æ€æ˜¾ç¤ºé¢æ¿</span>
<span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-80 mt-4'</span>):
    ui.label(<span class="hljs-string">'ç³»ç»ŸçŠ¶æ€'</span>).classes(<span class="hljs-string">'text-lg font-bold mb-2'</span>)
    
    <span class="hljs-keyword">with</span> ui.grid(columns=<span class="hljs-number">2</span>).classes(<span class="hljs-string">'gap-2'</span>):
        <span class="hljs-comment"># çŠ¶æ€é¡¹</span>
        <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0.5 p-2 bg-blue-50 rounded'</span>):
            ui.label(<span class="hljs-string">'CPUä½¿ç”¨ç‡'</span>).classes(<span class="hljs-string">'text-xs text-gray-500'</span>)
            ui.label(<span class="hljs-string">'42%'</span>).classes(<span class="hljs-string">'text-lg font-bold text-blue-600'</span>)
        
        <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0.5 p-2 bg-green-50 rounded'</span>):
            ui.label(<span class="hljs-string">'å†…å­˜ä½¿ç”¨'</span>).classes(<span class="hljs-string">'text-xs text-gray-500'</span>)
            ui.label(<span class="hljs-string">'3.2/8 GB'</span>).classes(<span class="hljs-string">'text-lg font-bold text-green-600'</span>)
        
        <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0.5 p-2 bg-yellow-50 rounded'</span>):
            ui.label(<span class="hljs-string">'åœ¨çº¿ç”¨æˆ·'</span>).classes(<span class="hljs-string">'text-xs text-gray-500'</span>)
            ui.label(<span class="hljs-string">'128'</span>).classes(<span class="hljs-string">'text-lg font-bold text-yellow-600'</span>)
        
        <span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'gap-0.5 p-2 bg-purple-50 rounded'</span>):
            ui.label(<span class="hljs-string">'è¯·æ±‚æ•°'</span>).classes(<span class="hljs-string">'text-xs text-gray-500'</span>)
            ui.label(<span class="hljs-string">'2.4k'</span>).classes(<span class="hljs-string">'text-lg font-bold text-purple-600'</span>)

ui.run()
</code></pre>
<h3 data-id="heading-40">9. <strong>æ ‡ç­¾çš„CSSè‡ªå®šä¹‰</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¶…ç´§å‡‘æ ‡ç­¾</span>
ui.label(<span class="hljs-string">'ç´§å‡‘æ ‡ç­¾'</span>).classes(<span class="hljs-string">'compact-label'</span>)

<span class="hljs-comment"># æ ‡ç­¾ç»„</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'compact-labels gap-0'</span>):
    ui.label(<span class="hljs-string">'é¡¹ç›®1'</span>)
    ui.label(<span class="hljs-string">'é¡¹ç›®2'</span>)
    ui.label(<span class="hljs-string">'é¡¹ç›®3'</span>)

ui.add_css(<span class="hljs-string">'''
    /* å•ä¸ªæ ‡ç­¾ç´§å‡‘ */
    .compact-label {
        margin: 0 !important;
        padding: 2px 4px !important;
        font-size: 12px !important;
        line-height: 1.2 !important;
    }
    
    /* æ ‡ç­¾ç»„ç´§å‡‘ */
    .compact-labels .nicegui-label {
        margin-bottom: 2px !important;
        padding: 1px 0 !important;
        font-size: 13px !important;
    }
    
    /* è¡¨å•æ ‡ç­¾ç´§å‡‘ */
    .form-label {
        display: block;
        margin-bottom: 3px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
    }
'''</span>)

<span class="hljs-comment"># ä½¿ç”¨è‡ªå®šä¹‰ç±»</span>
ui.label(<span class="hljs-string">'ç”¨æˆ·å'</span>).classes(<span class="hljs-string">'form-label'</span>)
ui.<span class="hljs-built_in">input</span>()
</code></pre>
<h3 data-id="heading-41">10. <strong>å“åº”å¼æ ‡ç­¾é—´è·</strong></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¹æ®ä¸åŒå±å¹•è°ƒæ•´æ ‡ç­¾é—´è·</span>
ui.label(<span class="hljs-string">'å“åº”å¼æ ‡ç­¾'</span>).classes(<span class="hljs-string">'''
    mb-1
    sm:mb-2
    md:mb-1
    lg:mb-0.5
    text-sm
    sm:text-base
    md:text-sm
    lg:text-xs
'''</span>)
</code></pre>
<h3 data-id="heading-42">ä¸»è¦æŠ€å·§ï¼š</h3>
<ol>
<li><strong>ä½¿ç”¨è´Ÿè¾¹è·</strong> - <code>-mt-1</code>ã€<code>-mb-1</code> å¯ä»¥å‡å°ä¸Šä¸‹é—´è·</li>
<li><strong>è®¾ç½® <code>mb-0</code> æˆ– <code>mt-0</code></strong> - æ¸…é™¤é»˜è®¤è¾¹è·</li>
<li><strong>é…åˆ <code>gap-0.5</code> æˆ– <code>gap-1</code></strong> - å®¹å™¨çº§åˆ«æ§åˆ¶</li>
<li><strong>ä½¿ç”¨å°å­—å·</strong> - <code>text-sm</code>ã€<code>text-xs</code> è®©æ ‡ç­¾æ›´ç´§å‡‘</li>
<li><strong>è¡Œå†…å¸ƒå±€</strong> - ä¸ <code>ui.row()</code> é…åˆå®ç°æ°´å¹³ç´§å‡‘æ’åˆ—</li>
</ol>
<p>é€‰æ‹©é€‚åˆä½ å¸ƒå±€éœ€æ±‚çš„æ–¹æ³•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°ç»„ forEach]]></title>    <link>https://juejin.cn/post/7585485074038521862</link>    <guid>https://juejin.cn/post/7585485074038521862</guid>    <pubDate>2025-12-21T02:27:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585485074038521862" data-draft-id="7585474459777318948" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°ç»„ forEach "/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-21T02:27:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†™ä»£ç çš„çš®ç­è‰‡"/> <meta itemprop="url" content="https://juejin.cn/user/4196178024218520"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°ç»„ forEach 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4196178024218520/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†™ä»£ç çš„çš®ç­è‰‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T02:27:12.000Z" title="Sun Dec 21 2025 02:27:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>1. åŸºæœ¬åŸç†å’Œå®ç°</strong></h2>
<h3 data-id="heading-1"><strong>åŸç”Ÿå®ç°åŸç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿå®ç° forEach</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myForEach</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">callback, thisArg</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'this is null or not defined'</span>);
  }
  
  <span class="hljs-comment">// è½¬æ¢ä¸ºå¯¹è±¡</span>
  <span class="hljs-keyword">const</span> O = <span class="hljs-title class_">Object</span>(<span class="hljs-variable language_">this</span>);
  <span class="hljs-comment">// è½¬æ¢ä¸ºæ•°å­—ï¼ˆlengthï¼‰</span>
  <span class="hljs-keyword">const</span> len = O.<span class="hljs-property">length</span> &gt;&gt;&gt; <span class="hljs-number">0</span>;  <span class="hljs-comment">// æ— ç¬¦å·å³ç§»ç¡®ä¿æ˜¯æ­£æ•´æ•°</span>
  
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">'function'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(callback + <span class="hljs-string">' is not a function'</span>);
  }
  
  <span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (k &lt; len) {
    <span class="hljs-comment">// æ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨ï¼ˆå¤„ç†ç¨€ç–æ•°ç»„ï¼‰</span>
    <span class="hljs-keyword">if</span> (k <span class="hljs-keyword">in</span> O) {
      <span class="hljs-comment">// æ‰§è¡Œå›è°ƒï¼Œä¼ é€’ä¸‰ä¸ªå‚æ•°</span>
      callback.<span class="hljs-title function_">call</span>(thisArg, O[k], k, O);
    }
    k++;
  }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">myForEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item, index);
});
</code></pre>
<h2 data-id="heading-2"><strong>2. è¯¦ç»†å‚æ•°è§£æ</strong></h2>
<pre><code class="hljs language-c" lang="c">arr.forEach(callback(currentValue, index, <span class="hljs-built_in">array</span>), thisArg)
</code></pre>
<h3 data-id="heading-3"><strong>å‚æ•°è¯¦è§£ï¼š</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span> }
];

<span class="hljs-comment">// 1. å®Œæ•´å‚æ•°ä½¿ç”¨</span>
users.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">user, index, array</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç”¨æˆ·<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>:`</span>, user.<span class="hljs-property">name</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ€»äººæ•°:'</span>, array.<span class="hljs-property">length</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this:'</span>, <span class="hljs-variable language_">this</span>);  <span class="hljs-comment">// thisArg å‚æ•°</span>
}, { <span class="hljs-attr">prefix</span>: <span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯ï¼š'</span> });

<span class="hljs-comment">// 2. ç®­å¤´å‡½æ•° vs æ™®é€šå‡½æ•°</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">data</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
  <span class="hljs-attr">multiplier</span>: <span class="hljs-number">2</span>,
  
  <span class="hljs-title function_">processData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç®­å¤´å‡½æ•° - ç»§æ‰¿å¤–å±‚ this</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item * <span class="hljs-variable language_">this</span>.<span class="hljs-property">multiplier</span>);  <span class="hljs-comment">// âœ… æ­£ç¡®è®¿é—® this.multiplier</span>
    });
    
    <span class="hljs-comment">// æ™®é€šå‡½æ•° - éœ€è¦ bind æˆ– thisArg</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item * <span class="hljs-variable language_">this</span>.<span class="hljs-property">multiplier</span>);  <span class="hljs-comment">// âŒ this æŒ‡å‘ undefined æˆ–å…¨å±€</span>
    }, <span class="hljs-variable language_">this</span>);  <span class="hljs-comment">// âœ… ä¼ é€’ thisArg</span>
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item * <span class="hljs-variable language_">this</span>.<span class="hljs-property">multiplier</span>);  
    }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));  <span class="hljs-comment">// âœ… ä½¿ç”¨ bind</span>
  }
};
</code></pre>
<h2 data-id="heading-4"><strong>3. æ ¸å¿ƒç‰¹ç‚¹è¯¦è§£</strong></h2>
<h3 data-id="heading-5"><strong>ç‰¹ç‚¹ 1ï¼šéå†é¡ºåºå›ºå®š</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>];

<span class="hljs-comment">// æ€»æ˜¯æŒ‰ç´¢å¼•é¡ºåºæ‰§è¡Œ</span>
arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index, item);  <span class="hljs-comment">// 0 'a', 1 'b', 2 'c'</span>
});

<span class="hljs-comment">// å³ä½¿æœ‰å¼‚æ­¥æ“ä½œï¼Œé¡ºåºä¹Ÿä¸ä¼šæ”¹å˜</span>
arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">async</span> (item, index) =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span>));
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index, item);  <span class="hljs-comment">// é¡ºåºä¾ç„¶æ˜¯ 0,1,2</span>
});
</code></pre>
<h3 data-id="heading-6"><strong>ç‰¹ç‚¹ 2ï¼šè·³è¿‡ç©ºä½ï¼ˆç¨€ç–æ•°ç»„ï¼‰</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºç¨€ç–æ•°ç»„</span>
<span class="hljs-keyword">const</span> sparseArray = [<span class="hljs-number">1</span>, , <span class="hljs-number">3</span>];  <span class="hljs-comment">// ç¬¬äºŒä¸ªå…ƒç´ æ˜¯ empty</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sparseArray.<span class="hljs-property">length</span>);  <span class="hljs-comment">// 3</span>

sparseArray.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(index, item);
  <span class="hljs-comment">// è¾“å‡º:</span>
  <span class="hljs-comment">// 0 1</span>
  <span class="hljs-comment">// 2 3</span>
  <span class="hljs-comment">// æ³¨æ„ï¼šç´¢å¼• 1 è¢«è·³è¿‡äº†</span>
});

<span class="hljs-comment">// ä¸ for å¾ªç¯å¯¹æ¯”</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; sparseArray.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i, sparseArray[i]);
  <span class="hljs-comment">// è¾“å‡º:</span>
  <span class="hljs-comment">// 0 1</span>
  <span class="hljs-comment">// 1 undefined  â† è¿™é‡Œä¸åŒï¼</span>
  <span class="hljs-comment">// 2 3</span>
}
</code></pre>
<h3 data-id="heading-7"><strong>ç‰¹ç‚¹ 3ï¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å‰ç¡®å®šé•¿åº¦</strong></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<span class="hljs-comment">;</span>

arr.forEach((item, index, array) =&gt; {
  console.log(`å¤„ç† ${item}`)<span class="hljs-comment">;</span>
  
  // ä¿®æ”¹æ•°ç»„ä¸ä¼šå½±å“éå†æ¬¡æ•°
  if (<span class="hljs-attr">index</span> === <span class="hljs-number">0</span>) {
    array.push(6)<span class="hljs-comment">;   // ä¸ä¼šè¢«å¤„ç†</span>
    array.pop()<span class="hljs-comment">;     // ä¸ä¼šå‡å°‘å¤„ç†æ¬¡æ•°</span>
    <span class="hljs-attr">array.length</span> = <span class="hljs-number">3</span><span class="hljs-comment">; // ä»ç„¶ä¼šå¤„ç†æ‰€æœ‰åŸå§‹å…ƒç´ </span>
  }
})<span class="hljs-comment">;</span>

// è¾“å‡º: å¤„ç† 1, å¤„ç† 2, å¤„ç† 3, å¤„ç† 4, å¤„ç† 5
</code></pre>
<h2 data-id="heading-8"><strong>4. é‡è¦æ³¨æ„äº‹é¡¹</strong></h2>
<h3 data-id="heading-9"><strong>âš ï¸ æ³¨æ„ç‚¹ 1ï¼šæ— æ³•ä¸­æ–­</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// âŒ è¿™äº›éƒ½æ— æ³•ä¸­æ–­ forEach
<span class="hljs-section">[1, 2, 3, 4, 5]</span>.forEach(<span class="hljs-attr">item</span> =&gt; {
  console.log(item)<span class="hljs-comment">;</span>
  if (<span class="hljs-attr">item</span> === <span class="hljs-number">3</span>) {
    break<span class="hljs-comment">;      // âŒ SyntaxError</span>
    continue<span class="hljs-comment">;   // âŒ SyntaxError</span>
    return<span class="hljs-comment">;     // âŒ åªé€€å‡ºå½“å‰å›è°ƒï¼Œç»§ç»­ä¸‹ä¸€ä¸ª</span>
  }
})<span class="hljs-comment">;</span>

// âœ… æ›¿ä»£æ–¹æ¡ˆ
// æ–¹æ¡ˆ1: for...of
for (const item of <span class="hljs-section">[1, 2, 3, 4, 5]</span>) {
  if (<span class="hljs-attr">item</span> === <span class="hljs-number">3</span>) break<span class="hljs-comment">;</span>
  console.log(item)<span class="hljs-comment">;</span>
}

// æ–¹æ¡ˆ2: some() æˆ– every()
<span class="hljs-section">[1, 2, 3, 4, 5]</span>.some(<span class="hljs-attr">item</span> =&gt; {
  console.log(item)<span class="hljs-comment">;</span>
  return <span class="hljs-attr">item</span> === <span class="hljs-number">3</span><span class="hljs-comment">;  // è¿”å› true åœæ­¢éå†</span>
})<span class="hljs-comment">;</span>

<span class="hljs-section">[1, 2, 3, 4, 5]</span>.every(<span class="hljs-attr">item</span> =&gt; {
  console.log(item)<span class="hljs-comment">;</span>
  return item !== 3<span class="hljs-comment">;  // è¿”å› false åœæ­¢éå†</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-10"><strong>âš ï¸ æ³¨æ„ç‚¹ 2ï¼šå¼‚æ­¥å¤„ç†é—®é¢˜</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ å¼‚æ­¥æ“ä½œä¸ä¼šæŒ‰é¢„æœŸç­‰å¾…</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processArray</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹'</span>);
  arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">async</span> (item) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);
  });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»“æŸ'</span>);  <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
}
<span class="hljs-comment">// è¾“å‡º: å¼€å§‹ â†’ ç»“æŸ â†’ (100mså) 1 2 3</span>

<span class="hljs-comment">// âœ… æ›¿ä»£æ–¹æ¡ˆ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processArrayCorrectly</span>(<span class="hljs-params">arr</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹'</span>);
  
  <span class="hljs-comment">// æ–¹æ¡ˆ1: for...of é…åˆ await</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);
  }
  
  <span class="hljs-comment">// æ–¹æ¡ˆ2: ä½¿ç”¨ Promise.allï¼ˆå¹¶è¡Œï¼‰</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(arr.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">async</span> (item) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);
  }));
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»“æŸ'</span>);
}
</code></pre>
<h3 data-id="heading-11"><strong>âš ï¸ æ³¨æ„ç‚¹ 3ï¼šä¿®æ”¹åŸæ•°ç»„çš„é£é™©</strong></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<span class="hljs-comment">;</span>

// âŒ å±é™©ï¼šåœ¨éå†æ—¶æ·»åŠ /åˆ é™¤å…ƒç´ 
arr.forEach((item, index, array) =&gt; {
  console.log(item)<span class="hljs-comment">;</span>
  if (<span class="hljs-attr">item</span> === <span class="hljs-number">2</span>) {
    array.push(100)<span class="hljs-comment">;  // å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸º</span>
    array.splice(index, 1)<span class="hljs-comment">;  // æ”¹å˜ç´¢å¼•ï¼Œå¯èƒ½è·³è¿‡å…ƒç´ </span>
  }
})<span class="hljs-comment">;</span>

// âœ… å®‰å…¨åšæ³•ï¼šå…ˆå¤åˆ¶æˆ–ä½¿ç”¨å…¶ä»–æ–¹æ³•
const <span class="hljs-attr">arrCopy</span> = [...arr]<span class="hljs-comment">;</span>
arrCopy.forEach(<span class="hljs-attr">item</span> =&gt; {
  // å®‰å…¨çš„å¤„ç†
})<span class="hljs-comment">;</span>

// æˆ–è€…å¤„ç†å®Œåç»Ÿä¸€ä¿®æ”¹
const <span class="hljs-attr">result</span> = []<span class="hljs-comment">;</span>
arr.forEach(<span class="hljs-attr">item</span> =&gt; {
  result.push(item * 2)<span class="hljs-comment">;  // ä¸ä¿®æ”¹åŸæ•°ç»„</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-12"><strong>âš ï¸ æ³¨æ„ç‚¹ 4ï¼šæ€§èƒ½è€ƒè™‘</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// forEach ä¸ for å¾ªç¯çš„æ€§èƒ½å¯¹æ¯”
const <span class="hljs-attr">largeArray</span> = new Array(<span class="hljs-number">1000000</span>).fill(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>

console.time('forEach')<span class="hljs-comment">;</span>
let <span class="hljs-attr">sum1</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
largeArray.forEach(<span class="hljs-attr">num</span> =&gt; {
  sum1 += num<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
console.timeEnd('forEach')<span class="hljs-comment">;</span>

console.time('for loop')<span class="hljs-comment">;</span>
let <span class="hljs-attr">sum2</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; largeArray.length; i++) {</span>
  sum2 += largeArray<span class="hljs-section">[i]</span><span class="hljs-comment">;</span>
}
console.timeEnd('for loop')<span class="hljs-comment">;</span>

// ç»“æœï¼šfor å¾ªç¯é€šå¸¸æ›´å¿«ï¼ˆä½†ç°ä»£JSå¼•æ“ä¼˜åŒ–å¾ˆå¥½ï¼‰
</code></pre>
<h2 data-id="heading-13"><strong>5. å®é™…åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-14"><strong>åœºæ™¯ 1ï¼šDOM æ“ä½œ</strong></h3>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰¹é‡æ“ä½œ DOM å…ƒç´ </span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.items'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">element, index</span>) =&gt;</span> {
  element.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'processed'</span>);
  element.<span class="hljs-property">dataset</span>.<span class="hljs-property">index</span> = index;
  element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handleClick);
});
</code></pre>
<h3 data-id="heading-15"><strong>åœºæ™¯ 2ï¼šå‰¯ä½œç”¨æ“ä½œ</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// çº¯å‰¯ä½œç”¨ï¼Œä¸éœ€è¦è¿”å›å€¼
const <span class="hljs-attr">logs</span> = []<span class="hljs-comment">;</span>
const <span class="hljs-attr">data</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<span class="hljs-comment">;</span>

// è®°å½•æ—¥å¿—
data.forEach(<span class="hljs-attr">item</span> =&gt; {
  logs.push(`Processing item ${item}`)<span class="hljs-comment">;</span>
  console.log(`Processing: ${item}`)<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>

// æ›´æ–°å¤–éƒ¨çŠ¶æ€
const <span class="hljs-attr">cache</span> = new Map()<span class="hljs-comment">;</span>
const <span class="hljs-attr">objects</span> = [{id: <span class="hljs-number">1</span>}, {id: <span class="hljs-number">2</span>}]<span class="hljs-comment">;</span>
objects.forEach(<span class="hljs-attr">obj</span> =&gt; {
  cache.set(obj.id, obj)<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-16"><strong>åœºæ™¯ 3ï¼šé“¾å¼æ“ä½œçš„ç¬¬ä¸€æ­¥</strong></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">result</span> = [
  {name: <span class="hljs-string">'Alice'</span>, age: <span class="hljs-number">25</span>},
  {name: <span class="hljs-string">'Bob'</span>, age: <span class="hljs-number">30</span>},
  {name: <span class="hljs-string">'Charlie'</span>, age: <span class="hljs-number">25</span>}
]<span class="hljs-comment">;</span>

// forEach ä½œä¸ºé¢„å¤„ç†
const <span class="hljs-attr">ageGroups</span> = {}<span class="hljs-comment">;</span>
result.forEach(<span class="hljs-attr">person</span> =&gt; {
  const <span class="hljs-attr">age</span> = person.age<span class="hljs-comment">;</span>
  if (!ageGroups<span class="hljs-section">[age]</span>) {
    ageGroups<span class="hljs-section">[age]</span> = <span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  }
})<span class="hljs-comment">;</span>

// ç„¶åè¿›è¡Œå…¶ä»–æ“ä½œ
Object.keys(ageGroups).forEach(<span class="hljs-attr">age</span> =&gt; {
  ageGroups<span class="hljs-section">[age]</span> = result.filter(<span class="hljs-attr">p</span> =&gt; p.age === parseInt(age))<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-17"><strong>6. æœ€ä½³å®è·µ</strong></h2>
<h3 data-id="heading-18"><strong>å®è·µ 1ï¼šæ˜ç¡®ä½¿ç”¨æ„å›¾</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// âœ… å¥½çš„ä½¿ç”¨
// 1. æ‰§è¡Œå‰¯ä½œç”¨
elements.forEach(<span class="hljs-attr">el</span> =&gt; el.classList.add(<span class="hljs-string">'active'</span>))<span class="hljs-comment">;</span>

// 2. æ›´æ–°å¤–éƒ¨çŠ¶æ€
data.forEach(<span class="hljs-attr">item</span> =&gt; updateCache(item))<span class="hljs-comment">;</span>

// 3. ç®€å•çš„æ•°æ®å¤„ç†
items.forEach(<span class="hljs-attr">item</span> =&gt; console.log(item))<span class="hljs-comment">;</span>

// âŒ ä¸å¥½çš„ä½¿ç”¨
// 1. éœ€è¦è¿”å›å€¼æ—¶ï¼ˆåº”ç”¨ mapï¼‰
const <span class="hljs-attr">doubled</span> = []<span class="hljs-comment">;</span>
arr.forEach(<span class="hljs-attr">x</span> =&gt; doubled.push(x * <span class="hljs-number">2</span>))<span class="hljs-comment">;  // âŒ ç”¨ map æ›´å¥½</span>

// 2. éœ€è¦è¿‡æ»¤æ—¶ï¼ˆåº”ç”¨ filterï¼‰
const <span class="hljs-attr">filtered</span> = []<span class="hljs-comment">;</span>
arr.forEach(<span class="hljs-attr">x</span> =&gt; {
  if (x &gt; 5) filtered.push(x)<span class="hljs-comment">;  // âŒ ç”¨ filter æ›´å¥½</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-19"><strong>å®è·µ 2ï¼šé”™è¯¯å¤„ç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ é”™è¯¯ä¼šä¸­æ–­æ•´ä¸ªéå†</span>
<span class="hljs-keyword">try</span> {
  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Oops'</span>);
  });
} <span class="hljs-keyword">catch</span> (e) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·åˆ°é”™è¯¯'</span>);  <span class="hljs-comment">// æ•´ä¸ªéå†åœæ­¢</span>
}

<span class="hljs-comment">// âœ… åœ¨å›è°ƒå†…éƒ¨å¤„ç†é”™è¯¯</span>
[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å¯èƒ½å‡ºé”™çš„æ“ä½œ</span>
    <span class="hljs-title function_">riskyOperation</span>(item);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`å¤„ç† <span class="hljs-subst">${item}</span> æ—¶å‡ºé”™:`</span>, error);
    <span class="hljs-comment">// ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ª</span>
  }
});
</code></pre>
<h3 data-id="heading-20"><strong>å®è·µ 3ï¼šæ€§èƒ½ä¼˜åŒ–</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// æå‰ç¼“å­˜é•¿åº¦ï¼ˆè™½ç„¶ forEach å†…éƒ¨ä¼šåšï¼Œä½†æŸäº›æƒ…å†µæœ‰ç”¨ï¼‰
const <span class="hljs-attr">items</span> = document.querySelectorAll(<span class="hljs-string">'.item'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">itemsArray</span> = Array.from(items)<span class="hljs-comment">;</span>

// æ‰¹é‡æ“ä½œå‡å°‘é‡ç»˜
const <span class="hljs-attr">fragment</span> = document.createDocumentFragment()<span class="hljs-comment">;</span>
itemsArray.forEach(<span class="hljs-attr">item</span> =&gt; {
  const <span class="hljs-attr">clone</span> = item.cloneNode(<span class="hljs-literal">true</span>)<span class="hljs-comment">;</span>
  // ä¿®æ”¹ clone...
  fragment.appendChild(clone)<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
document.body.appendChild(fragment)<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-21"><strong>æ€»ç»“</strong></h2>
<h3 data-id="heading-22"><strong>âœ… ä½¿ç”¨ forEach å½“ï¼š</strong></h3>
<ol>
<li>åªéœ€è¦å‰¯ä½œç”¨ï¼Œä¸å…³å¿ƒè¿”å›å€¼</li>
<li>æ“ä½œé¡ºåºä¸é‡è¦ï¼Œä¹Ÿä¸éœ€è¦ä¸­æ–­</li>
<li>ä»£ç å¯è¯»æ€§æ¯”æè‡´æ€§èƒ½æ›´é‡è¦</li>
<li>å¤„ç† DOM æ“ä½œæˆ– I/O å‰¯ä½œç”¨</li>
</ol>
<h3 data-id="heading-23"><strong>âŒ é¿å… forEach å½“ï¼š</strong></h3>
<ol>
<li>éœ€è¦æå‰ç»ˆæ­¢å¾ªç¯ï¼ˆç”¨Â <code>for...of</code>Â æˆ–Â <code>some/every</code>ï¼‰</li>
<li>å¤„ç†å¼‚æ­¥æ“ä½œï¼ˆç”¨Â <code>for...of</code>Â æˆ–Â <code>Promise.all</code>Â +Â <code>map</code>ï¼‰</li>
<li>éœ€è¦è½¬æ¢æ•°ç»„ï¼ˆç”¨Â <code>map</code>ï¼‰</li>
<li>éœ€è¦è¿‡æ»¤æ•°ç»„ï¼ˆç”¨Â <code>filter</code>ï¼‰</li>
<li>éœ€è¦è®¡ç®—ç»“æœï¼ˆç”¨Â <code>reduce</code>ï¼‰</li>
<li>æ€§èƒ½å…³é”®è·¯å¾„ï¼ˆè€ƒè™‘Â <code>for</code>Â å¾ªç¯ï¼‰</li>
<li>éœ€è¦é“¾å¼è°ƒç”¨ï¼ˆç»“åˆå…·ä½“ä¸šåŠ¡ï¼‰</li>
</ol>
<h5 data-id="heading-24"><strong>forEach æ²¡æœ‰è¿”å›å€¼ï¼Œä¸ä¿®æ”¹åŸæ•°ç»„ã€‚å½“ä½¿ç”¨æ—¶å¯ä»¥ç»™å…¶ä»–æ•°ç»„åšä¸­é—´æ–¹æ³•</strong></h5></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å¼€æºé¡¹ç›®æŠ€æœ¯åˆ†äº«ã€‘@host-navs ç«™å¯¼ï¼Œä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™]]></title>    <link>https://juejin.cn/post/7585600621521649704</link>    <guid>https://juejin.cn/post/7585600621521649704</guid>    <pubDate>2025-12-21T04:42:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585600621521649704" data-draft-id="7585574047074844672" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å¼€æºé¡¹ç›®æŠ€æœ¯åˆ†äº«ã€‘@host-navs  ç«™å¯¼ï¼Œä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T04:42:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="discode"/> <meta itemprop="url" content="https://juejin.cn/user/888061126511726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å¼€æºé¡¹ç›®æŠ€æœ¯åˆ†äº«ã€‘@host-navs  ç«™å¯¼ï¼Œä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/888061126511726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    discode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T04:42:10.000Z" title="Sun Dec 21 2025 04:42:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¡¹ç›®èƒŒæ™¯ä¸è®¾è®¡ç†å¿µ</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è®¿é—®å„ç§ç½‘ç»œèµ„æºï¼Œä½†æµè§ˆå™¨è‡ªå¸¦ä¹¦ç­¾ç®¡ç†ä»¥åŠä¸€äº›ä¸»æµçš„åœ¨çº¿å¯¼èˆªå·¥å…·ç«™å­˜åœ¨å¦‚æ•°æ®å…±äº«é™åˆ¶ã€æ•°æ®å®‰å…¨ç®¡æ§ç­‰ä¸ä¾¿ä¹‹å¤„ï¼Œå°¤å…¶æ˜¯åœ¨å…¬å¸å†…ç½‘æˆ–ä¼ä¸šçº§å±€åŸŸç½‘ç­‰ç±»ä¼¼ç¯å¢ƒä¸­ã€‚åŸºäºæ­¤ï¼Œæˆ‘é€šè¿‡ AI èµ‹èƒ½ï¼Œè®¾è®¡å¹¶å®ç°äº† <strong>host-navs ç«™å¯¼</strong>, ä¸€ä¸ªä»¥ <strong>é…ç½®å³æ•°æ®</strong> ä¸ºæ ¸å¿ƒè®¾è®¡ç†å¿µçš„çº¯å‰ç«¯ä¸”ç®€æ´é«˜æ•ˆçš„ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™ã€‚</p>
<p>æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼š</p>
<ul>
<li>ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰å¯¼èˆªæ•°æ®ï¼Œå®ç°æ•°æ®ä¸é€»è¾‘åˆ†ç¦»</li>
<li>é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œç¡®ä¿ä»£ç å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§</li>
<li>ä¼˜å…ˆè€ƒè™‘æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼Œå®ç°æµç•…çš„äº¤äº’æ•ˆæœ</li>
<li>æ”¯æŒå¤šç«¯é€‚é…ï¼Œæä¾›ä¸€è‡´çš„è·¨è®¾å¤‡ä½“éªŒ</li>
<li>ä»£ç åŸºäº MIT å¼€æºåè®®å…±äº«ä¸”è½»é‡æ˜“ç”¨</li>
</ul>
<h2 data-id="heading-1">æŠ€æœ¯æ ˆä¸æ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-2">æŠ€æœ¯é€‰å‹</h3>
<ul>
<li><strong>HTML5</strong> - è¯­ä¹‰åŒ–é¡µé¢ç»“æ„</li>
<li><strong>JavaScript (ES6+)</strong> - æ ¸å¿ƒäº¤äº’é€»è¾‘</li>
<li><strong>Tailwind CSS</strong> - åŸå­åŒ– CSS æ¡†æ¶ï¼Œå®ç°é«˜æ•ˆæ ·å¼å¼€å‘</li>
<li><strong>js-yaml</strong> - YAML è§£æåº“ï¼Œå¤„ç†é…ç½®æ–‡ä»¶</li>
</ul>
<h3 data-id="heading-3">é¡µé¢æ¡†æ¶</h3>
<pre><code class="hljs language-text" lang="text">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  HOST NAVS  â”‚  â†  å¤©é’è‰² + æ³¥é™¶è‰² LOGO
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LOGO                                     ç«™ç‚¹åç§°       â”‚
â”‚                                           ç«™ç‚¹æè¿°       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” æœç´¢é“¾æ¥...                      [ğŸ“±å¡ç‰‡] [ğŸ“‹åˆ—è¡¨]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ç‰¹åˆ«é¸£è°¢ n] [å­¦ä¹ èµ„æº n] [åŠ©æ‰‹å·¥å…· n] [è°åœ¨ä½¿ç”¨ n]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Github  â”‚ â”‚ VS Code â”‚ â”‚  Claude â”‚                    â”‚
â”‚  â”‚  GIT    â”‚ â”‚  Code   â”‚ â”‚    AI   â”‚   â† æ”¯æŒæ»šåŠ¨        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-4">é¡µé¢é¢„è§ˆ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54e7d641c2d94af3ad1015e2f5606f5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGlzY29kZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899262&amp;x-signature=uqeatCLr3cA3ZDAPskFvCPq3RnA%3D" alt="host-navs.png" loading="lazy"/></p>
<blockquote>
<p>é¡¹ç›®å®é™…é¡µé¢æˆªå›¾ï¼ˆä½äº <code>assets/host-navs.png</code>ï¼‰</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29cc7204d58b4a54b9db4830ca0d9910~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGlzY29kZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899262&amp;x-signature=wi7GHDhPkjFNDLgFOVseuqf55vg%3D" alt="host-navs-138.png" loading="lazy"/></p>
<blockquote>
<p>é¡¹ç›®å®é™…é¡µé¢æˆªå›¾ï¼ˆä½äº <code>assets/host-navs-138.png</code>ï¼‰</p>
</blockquote>
<h2 data-id="heading-5">éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½æŠ€æœ¯å®ç°è¯´æ˜</h2>
<h3 data-id="heading-6">1. YAML é…ç½®é©±åŠ¨æœºåˆ¶</h3>
<p><strong>å®ç°æ€è·¯</strong>ï¼šå°†æ‰€æœ‰å¯¼èˆªæ•°æ®å­˜å‚¨åœ¨ <code>host.conf</code> æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ <code>js-yaml</code> åº“è§£æä¸º JavaScript å¯¹è±¡ï¼Œå†è¿›è¡Œé…ç½®éªŒè¯å’Œè§„èŒƒåŒ–å¤„ç†ï¼Œå°†æ•°æ®åŠ¨æ€æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚</p>
<p><strong>host.conf</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ä¸»ç«™é…ç½®</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">ç«™å¯¼</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™</span>

<span class="hljs-comment"># é…ç½®æ•°æ®è°ƒè¯•è¾“å‡º(æµè§ˆå™¨æ§åˆ¶å°)</span>
<span class="hljs-attr">console_output:</span> <span class="hljs-literal">false</span>

<span class="hljs-comment"># å›¾æ ‡é…ç½®</span>
<span class="hljs-attr">use_text_icon:</span> <span class="hljs-literal">false</span>       <span class="hljs-comment"># true: åªä½¿ç”¨æ–‡å­—å›¾æ ‡</span>
<span class="hljs-attr">use_google_favicon:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># true: ä½¿ç”¨ Google Favicon API</span>

<span class="hljs-comment"># å›ºå®šå¿«æ·å¯¼èˆª</span>
<span class="hljs-attr">fixed_navs:</span>
  <span class="hljs-attr">fixed:</span>
    <span class="hljs-attr">top:</span> <span class="hljs-number">50</span><span class="hljs-string">%</span>
    <span class="hljs-attr">right:</span> <span class="hljs-string">16px</span>
  <span class="hljs-attr">items:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">GitHub</span>
      <span class="hljs-attr">short_name:</span> <span class="hljs-string">GIT</span>
      <span class="hljs-attr">description:</span> <span class="hljs-string">ä»£ç æ‰˜ç®¡å¹³å°</span>
      <span class="hljs-attr">nav_to:</span> <span class="hljs-string">https://github.com</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Gitee</span>
      <span class="hljs-attr">short_name:</span> <span class="hljs-string">GIT</span>
      <span class="hljs-attr">description:</span> <span class="hljs-string">å›½å†…ä»£ç æ‰˜ç®¡å¹³å°</span>
      <span class="hljs-attr">nav_to:</span> <span class="hljs-string">https://gitee.com</span>

<span class="hljs-comment"># å¯¼èˆªåˆ†ç»„</span>
<span class="hljs-attr">navs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">å¸¸ç”¨å·¥å…·</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">æ—¥å¸¸å·¥ä½œä¸­å¸¸ç”¨çš„å·¥å…·ç½‘ç«™</span>
    <span class="hljs-attr">items:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">GitHub</span>
        <span class="hljs-attr">short_name:</span> <span class="hljs-string">GIT</span> <span class="hljs-comment"># å¯é€‰ï¼Œæ–‡å­—å›¾æ ‡ç®€ç§°ï¼ˆæœ€å¤š4å­—ç¬¦ï¼‰</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">GitHubä»£ç æ‰˜ç®¡å¹³å°</span>
        <span class="hljs-attr">nav_to:</span> <span class="hljs-string">https://github.com</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">VS</span> <span class="hljs-string">Code</span>
        <span class="hljs-attr">short_name:</span> <span class="hljs-string">CODE</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">VS</span> <span class="hljs-string">Codeå¼€æºä»£ç ç¼–è¾‘å™¨</span>
        <span class="hljs-attr">nav_to:</span> <span class="hljs-string">https://code.visualstudio.com/</span>
</code></pre>
<p><strong>é…ç½®é¡¹è¯´æ˜</strong>ï¼š</p>



































































































































<table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>name</code></td><td>string</td><td>âœ…</td><td>ç«™ç‚¹åç§°</td></tr><tr><td><code>description</code></td><td>string</td><td>âŒ</td><td>ç«™ç‚¹æè¿°</td></tr><tr><td><code>console_output</code></td><td>boolean</td><td>âŒ</td><td>é…ç½®æ•°æ®è°ƒè¯•è¾“å‡º(æµè§ˆå™¨æ§åˆ¶å°)</td></tr><tr><td><code>use_text_icon</code></td><td>boolean</td><td>âŒ</td><td>æ˜¯å¦åªä½¿ç”¨æ–‡å­—å›¾æ ‡</td></tr><tr><td><code>use_google_favicon</code></td><td>boolean</td><td>âŒ</td><td>æ˜¯å¦ä½¿ç”¨ Google Favicon API</td></tr><tr><td><code>navs</code></td><td>array</td><td>âœ…</td><td>å¯¼èˆªåˆ†ç»„é›†åˆ</td></tr><tr><td><code>navs[].name</code></td><td>string</td><td>âœ…</td><td>åˆ†ç»„åç§°</td></tr><tr><td><code>navs[].description</code></td><td>string</td><td>âŒ</td><td>åˆ†ç»„æè¿°</td></tr><tr><td><code>navs[].items</code></td><td>array</td><td>âœ…</td><td>é“¾æ¥é›†åˆ</td></tr><tr><td><code>navs[].items[].name</code></td><td>string</td><td>âœ…</td><td>é“¾æ¥åç§°</td></tr><tr><td><code>navs[].items[].short_name</code></td><td>string</td><td>âŒ</td><td>é“¾æ¥ç®€ç§°ï¼ˆç”¨äºæ–‡å­—å›¾æ ‡ï¼‰</td></tr><tr><td><code>navs[].items[].description</code></td><td>string</td><td>âŒ</td><td>é“¾æ¥æè¿°</td></tr><tr><td><code>navs[].items[].nav_to</code></td><td>string</td><td>âœ…</td><td>é“¾æ¥åœ°å€</td></tr><tr><td><code>fixed_navs</code></td><td>object</td><td>âŒ</td><td>å³ä¾§å›ºå®šå¿«æ·å¯¼èˆªé…ç½®ï¼ˆå¯é€‰ï¼‰</td></tr><tr><td><code>fixed_navs.fixed</code></td><td>object</td><td>âŒ</td><td>ä½ç½®è®¾ç½®ï¼Œå…è®¸ top/right/bottom/leftï¼ˆå€¼ä¸ºæ•°å­—(px)æˆ–å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ '50%'ï¼‰</td></tr><tr><td><code>fixed_navs.fixed.top</code></td><td>string\number</td><td>âŒ</td><td>é¡¶éƒ¨ä½ç½®ï¼Œæ•°å­—è§†ä¸º pxï¼Œä¾‹å¦‚ 20 æˆ– '10px' æˆ– '50%'</td></tr><tr><td><code>fixed_navs.fixed.right</code></td><td>string\number</td><td>âŒ</td><td>å³ä¾§ä½ç½®</td></tr><tr><td><code>fixed_navs.fixed.bottom</code></td><td>string\number</td><td>âŒ</td><td>ä¸‹æ–¹ä½ç½®</td></tr><tr><td><code>fixed_navs.fixed.left</code></td><td>string\number</td><td>âŒ</td><td>å·¦ä¾§ä½ç½®</td></tr><tr><td><code>fixed_navs.items</code></td><td>array</td><td>âŒ</td><td>å›ºå®šå›¾æ ‡é¡¹ï¼Œå­å­—æ®µåŒ <code>navs[].items[]</code>ï¼ˆname/short_name/description/nav_toï¼‰</td></tr></tbody></table>
<p><strong>å…³é”®ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼‚æ­¥åŠ è½½å¹¶è§£æ YAML é…ç½®</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadConfig</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"host.conf"</span>);
  <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
  }
  <span class="hljs-keyword">const</span> yamlText = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();

  <span class="hljs-comment">// ä½¿ç”¨ js-yaml åº“è§£æ YAML</span>
  <span class="hljs-keyword">const</span> config = jsyaml.<span class="hljs-title function_">load</span>(yamlText);

  <span class="hljs-comment">// éªŒè¯é…ç½®ç»“æ„</span>
  <span class="hljs-keyword">if</span> (!config || <span class="hljs-keyword">typeof</span> config !== <span class="hljs-string">"object"</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼šä¸æ˜¯æœ‰æ•ˆçš„YAMLå¯¹è±¡"</span>);
  }
  <span class="hljs-keyword">if</span> (!config.<span class="hljs-property">name</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"é…ç½®æ–‡ä»¶ç¼ºå°‘å¿…è¦å­—æ®µï¼šname"</span>);
  }
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(config.<span class="hljs-property">navs</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"é…ç½®æ–‡ä»¶ç¼ºå°‘å¿…è¦å­—æ®µï¼šnavs (åº”ä¸ºæ•°ç»„)"</span>);
  }

  <span class="hljs-comment">// è§„èŒƒåŒ–é…ç½®</span>
  <span class="hljs-keyword">const</span> normalizedConfig = {
    <span class="hljs-attr">name</span>: config.<span class="hljs-property">name</span>,
    <span class="hljs-attr">description</span>: config.<span class="hljs-property">description</span> || <span class="hljs-string">""</span>,
    <span class="hljs-attr">console_output</span>: config.<span class="hljs-property">console_output</span> === <span class="hljs-literal">true</span>,
    <span class="hljs-attr">use_text_icon</span>: config.<span class="hljs-property">use_text_icon</span> === <span class="hljs-literal">true</span>,
    <span class="hljs-attr">use_google_favicon</span>: config.<span class="hljs-property">use_google_favicon</span> === <span class="hljs-literal">true</span>,
    <span class="hljs-attr">navs</span>: config.<span class="hljs-property">navs</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">nav, index</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!nav.<span class="hljs-property">name</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ç¬¬ <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span> ä¸ªåˆ†ç»„ç¼ºå°‘ name å­—æ®µ`</span>);
      }
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">name</span>: nav.<span class="hljs-property">name</span>,
        <span class="hljs-attr">description</span>: nav.<span class="hljs-property">description</span> || <span class="hljs-string">""</span>,
        <span class="hljs-attr">items</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(nav.<span class="hljs-property">items</span>)
          ? nav.<span class="hljs-property">items</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
              <span class="hljs-attr">name</span>: item.<span class="hljs-property">name</span> || <span class="hljs-string">"æœªå‘½åé“¾æ¥"</span>,
              <span class="hljs-attr">short_name</span>: item.<span class="hljs-property">short_name</span> || <span class="hljs-string">""</span>,
              <span class="hljs-attr">description</span>: item.<span class="hljs-property">description</span> || <span class="hljs-string">""</span>,
              <span class="hljs-attr">nav_to</span>: item.<span class="hljs-property">nav_to</span> || <span class="hljs-string">"#"</span>,
            }))
          : [],
      };
    }),
    <span class="hljs-comment">// å›ºå®šå¯¼èˆªé…ç½®å¤„ç†...</span>
  };

  <span class="hljs-keyword">return</span> normalizedConfig;
}
</code></pre>
<p><strong>è®¾è®¡ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ•°æ®ä¸é€»è¾‘å®Œå…¨åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•</li>
<li>ä¸¥æ ¼çš„é…ç½®éªŒè¯ï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§</li>
<li>è‡ªåŠ¨è§„èŒƒåŒ–å¤„ç†ï¼Œæé«˜ä»£ç å¥å£®æ€§</li>
<li>æ”¯æŒåŠ¨æ€æ›´æ–°é…ç½®ï¼Œæ— éœ€é‡æ–°éƒ¨ç½²</li>
</ul>
<h3 data-id="heading-7">2. ç½‘ç«™å›¾æ ‡è·å–ç­–ç•¥æœºåˆ¶</h3>
<p><strong>å®ç°æ€è·¯</strong>ï¼šè®¾è®¡äº†å¤šçº§å›¾æ ‡è·å–ç­–ç•¥ï¼Œé€šè¿‡ host.conf ç­–ç•¥é…ç½®å®ç°ç«™ç‚¹å›¾æ ‡çš„åŠ è½½ï¼ŒåŒ…æ‹¬åŸç”Ÿ favicon å°è¯•ã€Google Favicon æœåŠ¡å’Œæ–‡å­—å›¾æ ‡é™çº§ï¼Œç¡®ä¿æ¯ä¸ªé“¾æ¥éƒ½èƒ½æ˜¾ç¤ºåˆé€‚çš„å›¾æ ‡ã€‚</p>
<p><strong>å…³é”®ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å–ç½‘ç«™åŸç”Ÿ favicon åœ°å€ï¼ˆå¤šç§å¯èƒ½è·¯å¾„ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNativeFaviconUrls</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> urlObj = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url);
    <span class="hljs-keyword">const</span> origin = urlObj.<span class="hljs-property">origin</span>;
    <span class="hljs-comment">// å¯æ ¹æ®é¢„è§ˆæƒ…å†µæ·»åŠ æ›´å¤šè§„åˆ™ï¼Œå¦‚æœ¬ç«™çš„ /svgs/favicon.svg ç­‰è·¯å¾„</span>
    <span class="hljs-keyword">return</span> [
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/favicon.ico`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/favicon.png`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/favicon.svg`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/apple-touch-icon.png`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/assets/favicon.ico`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/static/favicon.ico`</span>,
      <span class="hljs-string">`<span class="hljs-subst">${origin}</span>/images/favicon.ico`</span>,
    ];
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> [];
  }
}

<span class="hljs-comment">// è·å– Google favicon æœåŠ¡åœ°å€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getGoogleFaviconUrl</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> urlObj = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`https://www.google.com/s2/favicons?domain=<span class="hljs-subst">${urlObj.hostname}</span>&amp;sz=64`</span>;
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// ç”Ÿæˆæ–‡å­—ç¼©å†™ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getTextAbbr</span>(<span class="hljs-params">item</span>) {
  <span class="hljs-keyword">const</span> name = item.<span class="hljs-property">name</span>;
  <span class="hljs-keyword">const</span> shortName = item.<span class="hljs-property">short_name</span>;
  <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨é…ç½®çš„ç®€ç§°</span>
  <span class="hljs-keyword">if</span> (shortName &amp;&amp; shortName.<span class="hljs-title function_">trim</span>()) {
    <span class="hljs-keyword">return</span> shortName.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>);
  }

  <span class="hljs-comment">// ä¸­æ–‡ï¼šå–å‰ä¸¤ä¸ªå­—</span>
  <span class="hljs-keyword">const</span> chineseMatch = name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/[\u4e00-\u9fa5]/g</span>);
  <span class="hljs-keyword">if</span> (chineseMatch &amp;&amp; chineseMatch.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> chineseMatch.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>);
  }
  <span class="hljs-keyword">if</span> (chineseMatch &amp;&amp; chineseMatch.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> chineseMatch[<span class="hljs-number">0</span>];
  }

  <span class="hljs-comment">// è‹±æ–‡ï¼šå–å•è¯é¦–å­—æ¯ï¼ˆæœ€å¤š2ä¸ªï¼‰æˆ–å‰ä¸¤ä¸ªå­—ç¬¦</span>
  <span class="hljs-keyword">const</span> words = name.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/[\s\-_\/]+/</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> w.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (words.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> words
      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> w[<span class="hljs-number">0</span>].<span class="hljs-title function_">toUpperCase</span>())
      .<span class="hljs-title function_">join</span>(<span class="hljs-string">""</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (words.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> name.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>).<span class="hljs-title function_">toUpperCase</span>();
  }

  <span class="hljs-keyword">return</span> name.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>).<span class="hljs-title function_">toUpperCase</span>();
}
</code></pre>
<p><strong>å›¾æ ‡è·å–ç­–ç•¥</strong>ï¼š</p>
<pre><code class="hljs language-text" lang="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å›¾æ ‡é…ç½®ä¼˜å…ˆçº§                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  use_text_icon: true                            â”‚
â”‚       â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ç›´æ¥æ˜¾ç¤ºæ–‡å­—ç¼©å†™ï¼ˆæ¨èå±€åŸŸç½‘ä½¿ç”¨ï¼‰   â”‚            â”‚
â”‚  â”‚  short_name &gt; ä¸­æ–‡å‰2å­— &gt; è‹±æ–‡ç¼©å†™ â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                 â”‚
â”‚  use_text_icon: false                           â”‚
â”‚  use_google_favicon: true                       â”‚
â”‚       â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ä½¿ç”¨ Google Favicon API         â”‚            â”‚
â”‚  â”‚  å¤±è´¥åæ˜¾ç¤ºæ–‡å­—ç¼©å†™                â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                 â”‚
â”‚  use_text_icon: false                           â”‚
â”‚  use_google_favicon: false                      â”‚
â”‚       â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  å°è¯•ç½‘ç«™åŸç”Ÿ favicon             â”‚            â”‚
â”‚  â”‚  /favicon.ico                   â”‚            â”‚
â”‚  â”‚  /favicon.png                   â”‚            â”‚
â”‚  â”‚  /apple-touch-icon.png          â”‚            â”‚
â”‚  â”‚  å…¨éƒ¨å¤±è´¥åæ˜¾ç¤ºæ–‡å­—ç¼©å†™             â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æŠ€æœ¯äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>é…ç½®ä¼˜å…ˆï¼Œå¤šè·¯å¾„åŸç”Ÿ favicon å°è¯•ï¼Œæé«˜æˆåŠŸç‡</li>
<li>æ”¯æŒ Google Favicon æœåŠ¡ä½œä¸ºå¤‡é€‰</li>
<li>æ™ºèƒ½æ–‡å­—å›¾æ ‡ç”Ÿæˆï¼Œæ”¯æŒä¸­è‹±æ–‡æ··åˆåœºæ™¯</li>
<li>å›¾æ ‡åŠ è½½å¤±è´¥è‡ªåŠ¨é™çº§æœºåˆ¶</li>
<li>ä½¿ç”¨ <code>loading="lazy"</code> å®ç°å›¾æ ‡æ‡’åŠ è½½</li>
</ul>
<h3 data-id="heading-8">3. å®æ—¶æœç´¢åŠŸèƒ½å®ç°</h3>
<p><strong>å®ç°æ€è·¯</strong>ï¼šé‡‡ç”¨å‰ç«¯å®æ—¶æœç´¢ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…é“¾æ¥çš„åç§°ã€æè¿°å’Œ URLï¼Œé«˜äº®å…³é”®è¯ï¼Œå®ç°å³æ—¶å“åº”çš„æœç´¢ä½“éªŒã€‚</p>
<p><strong>å…³é”®ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœç´¢å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleSearch</span>(<span class="hljs-params">e</span>) {
  searchKeyword = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
  <span class="hljs-keyword">const</span> clearBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"clear-search"</span>);
  clearBtn.<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(<span class="hljs-string">"hidden"</span>, !searchKeyword);
  <span class="hljs-title function_">renderLinks</span>();
}

<span class="hljs-comment">// æ¸…é™¤æœç´¢</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">clearSearch</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"search-input"</span>);
  input.<span class="hljs-property">value</span> = <span class="hljs-string">""</span>;
  searchKeyword = <span class="hljs-string">""</span>;
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"clear-search"</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">"hidden"</span>);
  <span class="hljs-title function_">renderLinks</span>();
  input.<span class="hljs-title function_">focus</span>();
}

<span class="hljs-comment">// é«˜äº®å…³é”®è¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">highlightKeyword</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-keyword">if</span> (!searchKeyword || !text) <span class="hljs-keyword">return</span> text;
  <span class="hljs-keyword">const</span> escaped = searchKeyword.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[.*+?^${}()|[\]\\]/g</span>, <span class="hljs-string">"\\$&amp;"</span>);
  <span class="hljs-keyword">const</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">`(<span class="hljs-subst">${escaped}</span>)`</span>, <span class="hljs-string">"gi"</span>);
  <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">replace</span>(
    regex,
    <span class="hljs-string">'&lt;mark class="bg-yellow-200 text-yellow-900 rounded px-0.5"&gt;$1&lt;/mark&gt;'</span>
  );
}
</code></pre>
<h2 data-id="heading-9">æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
<ol>
<li>
<p><strong>å›¾æ ‡æ‡’åŠ è½½</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>loading="lazy"</code> å±æ€§å®ç°å›¾æ ‡å»¶è¿ŸåŠ è½½</li>
<li>ä¼˜åŒ–å›¾æ ‡è¯·æ±‚é¡ºåºï¼Œä¼˜å…ˆåŠ è½½å¯è§åŒºåŸŸå›¾æ ‡</li>
<li>æ”¯æŒæ–‡å­—å›¾æ ‡é™çº§ï¼Œé¿å…å›¾æ ‡åŠ è½½å¤±è´¥å½±å“ç”¨æˆ·ä½“éªŒ</li>
</ul>
</li>
<li>
<p><strong>DOM æ“ä½œä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>æ‰¹é‡ DOM æ›´æ–°ï¼Œé€šè¿‡ <code>innerHTML</code> ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰é“¾æ¥ HTML</li>
<li>å‡å°‘ DOM èŠ‚ç‚¹æ•°é‡ï¼Œä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾</li>
<li>åˆç†ä½¿ç”¨ CSS ç±»åˆ‡æ¢ï¼Œé¿å…é¢‘ç¹æ ·å¼è®¡ç®—</li>
</ul>
</li>
<li>
<p><strong>æœç´¢æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨å­—ç¬¦ä¸² <code>includes()</code> æ–¹æ³•è¿›è¡Œé«˜æ•ˆåŒ¹é…</li>
<li>æœç´¢å…³é”®è¯å°å†™è½¬æ¢ï¼Œå®ç°å¤§å°å†™ä¸æ•æ„Ÿæœç´¢</li>
<li>å®æ—¶æœç´¢ä¸ç»“æœæ¸²æŸ“ç»“åˆï¼Œå‡å°‘ä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨</li>
</ul>
</li>
<li>
<p><strong>èµ„æºåŠ è½½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å†…è”å…³é”® JavaScriptï¼Œå‡å°‘ HTTP è¯·æ±‚</li>
<li>ä¼˜åŒ– SVG å›¾æ ‡ï¼Œå‡å°‘æ–‡ä»¶å¤§å°</li>
<li>åˆç†ä½¿ç”¨ Tailwind CSS å·¥å…·ç±»ï¼Œå‡å°‘è‡ªå®šä¹‰ CSS ä½“ç§¯</li>
</ul>
</li>
</ol>
<h2 data-id="heading-10">éƒ¨ç½²ä¸ CI/CD å®ç°</h2>
<h3 data-id="heading-11">é™æ€éƒ¨ç½²æ¶æ„</h3>
<p>ç”±äºé¡¹ç›®æ˜¯çº¯å‰ç«¯åº”ç”¨ï¼Œéƒ¨ç½²éå¸¸ç®€å•ï¼Œå¯ä»¥ç›´æ¥éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡æœåŠ¡ï¼š</p>
<ul>
<li><strong>Nginx</strong>ï¼šè‡ªå®šä¹‰æœåŠ¡å™¨éƒ¨ç½²</li>
<li><strong>GitHub Pages</strong>ï¼šé€šè¿‡ GitHub Actions è‡ªåŠ¨éƒ¨ç½²</li>
<li><strong>Vercel</strong>ï¼šå®æ—¶é¢„è§ˆå’Œè‡ªåŠ¨éƒ¨ç½²</li>
<li>etc...</li>
</ul>
<h3 data-id="heading-12">Nginx éƒ¨ç½²é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-nginx" lang="nginx">server {
    listen 80;
    server_name host-nav.example.com;
    root /var/www/host-navs/public;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }

    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(svg|ico)$ {
        expires 7d;
        add_header Cache-Control "public, immutable";
    }
}
</code></pre>
<h3 data-id="heading-13">CI/CD é…ç½®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actions é…ç½®ç¤ºä¾‹</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">GitHub</span> <span class="hljs-string">Pages</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [<span class="hljs-string">main</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">peaceiris/actions-gh-pages@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">github_token:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">publish_dir:</span> <span class="hljs-string">./public</span>
</code></pre>
<pre><code class="hljs language-text" lang="text">Vercel éƒ¨ç½²ï¼ˆé€šè¿‡ç›‘å¬github pushç­‰äº‹ä»¶,è‡ªåŠ¨è§¦å‘æ„å»ºä¸éƒ¨ç½²ï¼‰
é€šè¿‡ Vercel å¹³å°å¯¼å…¥ä½ çš„ GitHub é¡¹ç›®ï¼Œé›†æˆåå³å¯è¿›è¡Œè‡ªåŠ¨åŒ–é…ç½®éƒ¨ç½²
</code></pre>
<h2 data-id="heading-14">é¡¹ç›®åœ°å€</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flinshangchun%2Fhost-navs" target="_blank" title="https://github.com/linshangchun/host-navs" ref="nofollow noopener noreferrer">GitHub Repo</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Flinshangchun%2Fhost-navs" target="_blank" title="https://gitee.com/linshangchun/host-navs" ref="nofollow noopener noreferrer">Gitee Repo</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flinshangchun.github.io%2Fhost-navs%2F" target="_blank" title="https://linshangchun.github.io/host-navs/" ref="nofollow noopener noreferrer">host-navs ç«™å¯¼@Github Deploy åœ¨çº¿é¢„è§ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhost-navs.vercel.app%2F" target="_blank" title="https://host-navs.vercel.app/" ref="nofollow noopener noreferrer">host-navs ç«™å¯¼@Vercel Deploy åœ¨çº¿é¢„è§ˆ</a></li>
</ul>
<h2 data-id="heading-15">è‡´è°¢</h2>
<p>æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’ŒæœåŠ¡ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2F" target="_blank" title="https://tailwindcss.com/" ref="nofollow noopener noreferrer">Tailwind CSS</a> - ç°ä»£åŒ– CSS æ¡†æ¶</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnodeca%2Fjs-yaml" target="_blank" title="https://github.com/nodeca/js-yaml" ref="nofollow noopener noreferrer">js-yaml</a> - å¼ºå¤§çš„ YAML è§£æåº“</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fs2%2Ffavicons" target="_blank" title="https://www.google.com/s2/favicons" ref="nofollow noopener noreferrer">Google Favicon Service</a> - æä¾›å¯é çš„å›¾æ ‡æœåŠ¡</li>
</ul>
<hr/>
<h2 data-id="heading-16">æœ€å</h2>
<ul>
<li>ğŸš€ æ›´å¤šåŠŸèƒ½ç»†èŠ‚çš„è®¾è®¡ä¸å®ç°è¯·æŸ¥é˜…é¡¹ç›®æºç ï¼Œæ¬¢è¿ä¸åèµæ•™ä¸ Starã€‚</li>
<li>ğŸš€ å¦‚æœä½ æ­£åœ¨ä½¿ç”¨æœ¬ç«™ï¼Œæ¬¢è¿ææ³¨ issueï¼Œæ ¼å¼å¦‚ navs[].items[]ï¼›è¯šé‚€ä¸€èµ·å…±å»ºä¼˜è´¨èµ„æºÂ·ç½‘ç«™é“¾æ¥Â·èšåˆå…±äº«Â·ç½‘é“¾å¹³å°ã€‚</li>
<li>ğŸš€ å¦‚æœä½ å¯¹é¡¹ç›®æ„Ÿå…´è¶£ï¼Œæ¬¢è¿å‚ä¸è´¡çŒ®ï¼Œè¯šé‚€ä¸€èµ·å®Œå–„ã€<strong>host-navs ç«™å¯¼</strong>ã€‘ç½‘ç«™é“¾æ¥å¯¼èˆªå·¥å…·ç«™ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Day03-APIs]]></title>    <link>https://juejin.cn/post/7585555806667309090</link>    <guid>https://juejin.cn/post/7585555806667309090</guid>    <pubDate>2025-12-21T04:51:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585555806667309090" data-draft-id="7584370833704255503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Day03-APIs "/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-21T04:51:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç˜¦çš„å¯ä»¥ä¸‹é¥­äº†"/> <meta itemprop="url" content="https://juejin.cn/user/895474817042060"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Day03-APIs 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/895474817042060/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç˜¦çš„å¯ä»¥ä¸‹é¥­äº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T04:51:58.000Z" title="Sun Dec 21 2025 04:51:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h3 data-id="heading-0">highlight: atelier-plateau-light
theme: z-blue</h3>
<h2 data-id="heading-1">1. å…¨é€‰æ–‡æœ¬æ¡†æ¡ˆä¾‹</h2>
<blockquote>
<p>1.æ³¨æ„è¿™ä¸ªä¼ªç±»é€‰æ‹©å™¨</p>
<p>å¯ä»¥ç›´æ¥è¯†é€‰ä¸­çš„å¯¹è±¡
<code>/* é€‰æ‹©è¢«å‹¾é€‰çš„å¤é€‰æ¡† */     .ck:checked {       width: 20px;       height: 20px;} </code></p>
<ol start="2">
<li>è¿™ç§Allé€‰æ‹©çš„å¯¹è±¡æƒ³è¦è®¾ç½®äº‹ä»¶æ—¶ä¹Ÿè¦ç”¨forå¾ªç¯éå†è®¾ç½®</li>
</ol>
</blockquote>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
    <span class="hljs-comment">// è·å–å¤§æŒ‰é’®å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> checkAll = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#checkAll'</span>)
    <span class="hljs-comment">// è·å–æ‰€æœ‰å°æŒ‰é’®çš„å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> cks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.ck'</span>)
    <span class="hljs-comment">// è®¾ç½®äº‹ä»¶ï¼šç‚¹å‡»å¤§å¤é€‰æ¡†ï¼Œå°çš„è·Ÿç€å˜åŒ–</span>
    checkAll.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
      <span class="hljs-comment">// æˆ‘ä»¬è¦å»ä¾¿åˆ©cksä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡ï¼Œè®©å®ƒä»¬çš„çŠ¶æ€å’Œå¤§å¤é€‰æ¡†ä¸€è‡´</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i= <span class="hljs-number">0</span> ; i &lt; cks.<span class="hljs-property">length</span>; i++){
      cks[i].<span class="hljs-property">checked</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span> <span class="hljs-comment">// chckedæ˜¯å±æ€§,ä¹Ÿå¯ä»¥å†™æˆcheckAll.checked</span>
      }
    })
    <span class="hljs-comment">// å®ç°åŠŸèƒ½ï¼šå½“æ‰€æœ‰çš„å°æŒ‰é’®è¢«é€‰çš„æ—¶å€™ï¼Œå¤§æŒ‰é’®è¢«é€‰ä¸­</span>
    <span class="hljs-comment">// è¦ç»™æ‰€æœ‰çš„å°å¤é€‰æ¡†æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç”¨å¾ªç¯å®ç°</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; cks.<span class="hljs-property">length</span>; i++){
        cks[i].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
          <span class="hljs-comment">// for(let i = 0; i &lt; cks.length; i++){</span>
          <span class="hljs-comment">//   if(cks[i].checked === false){</span>
          <span class="hljs-comment">//     break</span>
          <span class="hljs-comment">//   }</span>
          <span class="hljs-comment">//   if(i === cks.length - 1){</span>
          <span class="hljs-comment">//     checkAll.checked = true</span>
          <span class="hljs-comment">//   }</span>
          <span class="hljs-comment">// }</span>
          checkAll.<span class="hljs-property">checked</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.ck:checked'</span>).<span class="hljs-property">length</span> === cks.<span class="hljs-property">length</span>
        })
        }
  &lt;/script&gt;
</code></pre>
<h2 data-id="heading-2">2.äº‹ä»¶æµ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/987e8d9681ee49a3990dcf33c33b56a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=3xJ2w%2Bp8ckWvp629Hxeyuu1b7lc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">3.äº‹ä»¶æ•è·</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf9ab65a0def464ca8dc90792da11be6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=HQJGNfRK%2F7y8gUqvuICCGMihL3A%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        
        <span class="hljs-keyword">const</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.father'</span>)
        <span class="hljs-keyword">const</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.son'</span>)

        father.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯çˆ¸çˆ¸'</span>)
        },<span class="hljs-literal">true</span>)

        son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯å„¿å­'</span>)
        },<span class="hljs-literal">true</span>)
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯çˆ·çˆ·'</span>)
        },<span class="hljs-literal">true</span>)
    &lt;/script&gt;
</code></pre>
<h2 data-id="heading-4">4.äº‹ä»¶å†’æ³¡ï¼ˆé‡è¦ï¼‰</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e181302fc1fe4e5b972fc9e29a107428~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=NBweXQqbU1e%2BVRc52%2FCD6FVIMfo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">5.é˜»æ­¢å†’æ³¡ï¼ˆé‡è¦ï¼‰</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26f6e2af2931414090ce4610158c850c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=E6%2BZ2QS7Gi2R4lCfyqMeVAEz%2Fus%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯çˆ·çˆ·'</span>)
        })
        
        <span class="hljs-keyword">const</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.father'</span>)
        <span class="hljs-keyword">const</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.son'</span>)

        father.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯çˆ¸çˆ¸'</span>)
        })

        son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æˆ‘æ˜¯å„¿å­'</span>)
            e.<span class="hljs-title function_">stopPropagation</span>()
        })
        
    &lt;/script&gt;
</code></pre>
<h2 data-id="heading-6">6.è§£ç»‘äº‹ä»¶</h2>
<h3 data-id="heading-7">6.1 L0äº‹ä»¶ç§»é™¤</h3>
<blockquote>
<p>å¦‚æœæ˜¯ç”¨onåˆ›å»ºçš„æ–¹æ³•ï¼Œå¦‚<code> button.onclick = function(){}</code>,å¯ä»¥ç”¨ <code>button.onclick = null</code>è§£ç»‘</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b06a6b14a2c4622b7ea7893eda614b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=GJJ0nfpCqOmwYcz1NLtPRODwYYo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">6.2 L2äº‹ä»¶ç§»é™¤</h3>
<blockquote>
<p>L2ä¸­åŒ¿åå‡½æ•°æ— æ³•è¢«è§£ç»‘</p>
</blockquote>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'button'</span>)
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>){
            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'ç‚¹å‡»äº†'</span>)
        }
        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,fn)
        <span class="hljs-comment">// äº‹ä»¶ç§»é™¤è§£ç»‘</span>
        btn.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>,fn)
    &lt;/script&gt;
</code></pre>
<h3 data-id="heading-9">6.3 mouseoverå’Œmouseenterçš„åŒºåˆ«</h3>
<ul>
<li>æ¨èç”¨mouseenteræ¥é˜»æ­¢å†’æ³¡</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f49df5c4c7342bd9f507636c93868c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=f6VgllO1g5O56KEUGNi3U6QRiuk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-10">7.äº‹ä»¶å§”æ‰˜</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f45f9559ce4b4eb08ce8209ec2c2fafd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=OBwBvrOcMXPIjlzn9nkG6rLe%2Bxs%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¬¬1ä¸ªå­©å­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¬¬2ä¸ªå­©å­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¬¬3ä¸ªå­©å­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¬¬4ä¸ªå­©å­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¬¬5ä¸ªå­©å­<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åˆ«è®©æˆ‘åˆ«çº¢<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// ç‚¹å‡»æ¯ä¸ªå°liï¼Œå½“å‰liå˜æˆçº¢è‰²ï¼Œç‚¹å®ƒçš„å…¶å®ƒå­©å­ä¸å˜è‰²</span>
        <span class="hljs-keyword">const</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'ul'</span>)
        <span class="hljs-comment">// æŠŠäº‹ä»¶å§”æ‰˜ç»™çˆ¶çº§</span>
        <span class="hljs-comment">// ä½†æ˜¯è¦æ‹¿åˆ°ç‚¹å‡»çš„å…ƒç´ </span>
        ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
            
            <span class="hljs-comment">//e.targetå°±æ˜¯å®é™…ç‚¹å‡»çš„å¯¹è±¡Â·</span>
            <span class="hljs-keyword">if</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">tagName</span> === <span class="hljs-string">'LI'</span>){
                e.<span class="hljs-property">target</span>.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">'red'</span>
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(e.<span class="hljs-property">target</span>);
            }
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
&lt;/body&gt;
</code></pre>
<h2 data-id="heading-11">8.åˆ©ç”¨æ•°ç»„å§”æ‰˜å®ç°tabæ åˆ‡æ¢</h2>
<blockquote>
<p>ç”¨åˆ°äº†è‡ªå®šä¹‰å±æ€§ä»¥åŠä¸¤ç§è§£å†³æ–¹æ³•</p>
</blockquote>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>tabæ åˆ‡æ¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    * {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    }

    <span class="hljs-selector-class">.tab</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">590px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">340px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e4e4e4</span>;
    }

    <span class="hljs-selector-class">.tab-nav</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">60px</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: space-between;
    }

    <span class="hljs-selector-class">.tab-nav</span> <span class="hljs-selector-tag">h3</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
      <span class="hljs-attribute">font-weight</span>: normal;
      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;
    }

    <span class="hljs-selector-class">.tab-nav</span> <span class="hljs-selector-tag">ul</span> {
      <span class="hljs-attribute">list-style</span>: none;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: flex-end;
    }

    <span class="hljs-selector-class">.tab-nav</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    }

    <span class="hljs-selector-class">.tab-nav</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">a</span> {
      <span class="hljs-attribute">text-decoration</span>: none;
      <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">2px</span> solid transparent;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
    }

    <span class="hljs-selector-class">.tab-nav</span> <span class="hljs-selector-tag">ul</span> <span class="hljs-selector-tag">li</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#e1251b</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#e1251b</span>;
    }

    <span class="hljs-selector-class">.tab-content</span> {
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;
    }

    <span class="hljs-selector-class">.tab-content</span> <span class="hljs-selector-class">.item</span> {
      <span class="hljs-attribute">display</span>: none;
    }

    <span class="hljs-selector-class">.tab-content</span> <span class="hljs-selector-class">.item</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">display</span>: block;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-nav"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æ¯æ—¥ç‰¹ä»·<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"active"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-id</span> = <span class="hljs-string">"0"</span> &gt;</span>ç²¾é€‰<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-id</span> = <span class="hljs-string">"1"</span>&gt;</span>ç¾é£Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-id</span> = <span class="hljs-string">"2"</span>&gt;</span>ç™¾è´§<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-id</span> = <span class="hljs-string">"3"</span>&gt;</span>ä¸ªæŠ¤<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span> <span class="hljs-attr">data-id</span> = <span class="hljs-string">"4"</span>&gt;</span>é¢„å‘Š<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item active"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/tab00.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/tab01.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/tab02.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/tab03.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/tab04.png"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// åŠŸèƒ½ï¼šé‡‡å–äº‹ä»¶å§”æ‰˜çš„æ–¹å¼å®ç°tabæ åˆ‡æ¢</span>
    <span class="hljs-comment">// å°†äº‹ä»¶å§”æ‰˜ç»™açš„çˆ¶ç±»ul</span>

    <span class="hljs-comment">// è·å–ulå¯¹è±¡</span>
    <span class="hljs-keyword">const</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.tab-nav ul'</span>)
    <span class="hljs-comment">// è·å–itemå¯¹è±¡ï¼Œå°±ä¸éœ€è¦ç”¨nth-childäº†</span>
    <span class="hljs-keyword">const</span> items = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.tab-content .item'</span>)
    <span class="hljs-comment">// è®¾ç½®äº‹ä»¶</span>
    ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
        <span class="hljs-keyword">if</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">tagName</span> === <span class="hljs-string">'A'</span>){
            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.tab-nav .active'</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'active'</span>)
            <span class="hljs-comment">// thisæŒ‡å‘ulï¼Œä¸èƒ½ç”¨this</span>
            e.<span class="hljs-property">target</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'active'</span>)
        }
        <span class="hljs-comment">//åˆ©ç”¨è‡ªå®šä¹‰å±æ€§æ¥è·å–ä¸‹é¢å¯¹åº”çš„å›¾ç‰‡  data-id</span>
        <span class="hljs-comment">// å…ˆåˆ é™¤active</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.tab-content .active'</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'active'</span>)
        <span class="hljs-comment">// åˆ©ç”¨è‡ªå®šä¹‰å±æ€§æ¥è·å–é¡ºåº</span>
        <span class="hljs-keyword">const</span> i = +e.<span class="hljs-property">target</span>.<span class="hljs-property">dataset</span>.<span class="hljs-property">id</span> <span class="hljs-comment">// è¦è¿›è¡Œéšå¼è½¬æ¢</span>
        <span class="hljs-comment">// document.querySelector(`.tab-content .item:nth-child(${num+1})`).classList.add('active')</span>
        items[i].<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'active'</span>)
        
        
    })
    
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-12">9.é˜»æ­¢é»˜è®¤è¡Œä¸º</h2>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"http://www.itcast.cn"</span>&gt;</span> 
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ç‚¹å‡»è·³è½¬"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"http:www.baidu.com"</span>&gt;</span>ç™¾åº¦ä¸€ä¸‹<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'form'</span>)
        form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'submit'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
            <span class="hljs-comment">// é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œæäº¤</span>
            e.<span class="hljs-title function_">preventDefault</span>()
        })
        <span class="hljs-comment">// æŠŠé“¾æ¥çš„é»˜è®¤è¡Œä¸ºé˜»æ­¢</span>
        <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'a'</span>)
        <span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>){
            <span class="hljs-comment">// é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œæäº¤</span>
            e.<span class="hljs-title function_">preventDefault</span>()
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-13">10.å…¶å®ƒäº‹ä»¶</h2>
<h3 data-id="heading-14">10.1 é¡µé¢åŠ è½½äº‹ä»¶</h3>
<blockquote>
<p>1.æœ‰äº›æ—¶å€™ï¼Œjsä¼šå†™åœ¨bodyä¸Šé¢ï¼Œæ­£å¸¸æ¥è¯´ï¼Œä»£ç ä¼šä»ä¸Šå¾€ä¸‹æ‰§è¡Œï¼Œé‚£jsä»£ç å°±ä¼šæ‰§è¡Œå¤±è´¥ï¼Œæ‰€ä»¥è¯´å°±éœ€è¦loadäº‹ä»¶æ¥ä¿è¯é¡µé¢åŠ è½½å®Œæ¯•ä¹‹åï¼Œå†æ‰§è¡Œå¯¹åº”çš„å‡½æ•°ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af5c980beb264245b3c21d73f4cdd3d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=NfrxYsqw0Zc%2BTcGokiDRwv59gJg%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// é¡µé¢åŠ è½½äº‹ä»¶ï¼Œæ‰€æœ‰èµ„æºåŠ è½½å®Œ</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
            <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'button'</span>)
            btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
                <span class="hljs-title function_">alert</span>(<span class="hljs-string">'å“ˆå“ˆ'</span>);
        })
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>ç‚¹æˆ‘å‘€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<blockquote>
<p>1.å¦ä¸€ç§åŠ è½½äº‹ä»¶æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒå¯ä»¥å®ç°å›¾ç‰‡è¿˜æ²¡æœ‰åŠ è½½å®Œå…¨çš„æ—¶å€™å·²ç»å¯ä»¥å®ç°äº¤äº’æ•ˆæœäº†ï¼Œåªéœ€è¦åŠ è½½DOMå…ƒç´ å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦ç­‰å¾…å›¾ç‰‡çš„åŠ è½½ï¼Œæ‰€ä»¥æ¯”loadè¦å¿«ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fe6943acecd4619a606a9013f902fa6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=Xl6cjyd6gd5qfjn2%2FgffmZ4HHVE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-15">10.2 é¡µé¢æ»šåŠ¨äº‹ä»¶</h3>
<blockquote>
<p>1.å¾ˆå¤šæ—¶å€™ç”¨æˆ·æ»šåŠ¨æ—¶è¦äº§ç”Ÿä¸€äº›æ•ˆæœï¼Œè€Œä¸”ä¸ä»…ä»…æ˜¯é¡µé¢å¯ä»¥æ»šåŠ¨ï¼Œå¾ˆå¤šæ ‡ç­¾ä¹Ÿå¯ä»¥æ»šåŠ¨</p>
<p>2.è¦äº†è§£scrollTopå’ŒscrollLeftå±æ€§ï¼Œå¯ä»¥æ‰‹å†™ä¸€ä¸ªdivç„¶åæ‹‰åŠ¨çš„æ—¶å€™è¾“å‡ºscrollTopï¼Œè¿™ä¸ªå¯è¯»å†™æ‰€ä»¥æˆ‘ä»¬ä¹Ÿèƒ½åšåˆ°ä¸€æ‰“å¼€é¡µé¢æ»šåŠ¨æ¡å°±åœ¨ä¸­é—´ä½ç½®ã€‚</p>
<p>3.æˆ‘ä»¬æ—¥å¸¸å¾ˆå¤šæ—¶å€™æ»šåŠ¨å…¨å±æ—¶ç”¨çš„æ˜¯htmlæ ‡ç­¾ï¼Œè·å–htmlæ ‡ç­¾çš„æ–¹å¼æ˜¯<strong>document.documentElement</strong>ï¼Œç„¶åå¯ä»¥è®¾ç½®æ»‘åŠ¨å¤šå°‘è·ç¦»å‘ç”Ÿå¯¹åº”çš„äº‹ä»¶</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a2f7a8e903d4ee8b8c36bfe7b07abbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=UPO67keiHq1%2FA7QvywLbxIvqWT8%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">div</span> {
            <span class="hljs-attribute">overflow</span>: scroll;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;
            <span class="hljs-attribute">color</span>:black;

        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
        å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'div'</span>)
      div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`scrollTop=<span class="hljs-subst">${div.scrollTop}</span>,scrollLeft=<span class="hljs-subst">${div.scrollLeft}</span>`</span>)
      })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-16">11.é¡µé¢å°ºå¯¸äº‹ä»¶</h2>
<blockquote>
<p>1 resizeå¯ä»¥å®ç°çª—å£å°ºå¯¸å˜åŒ–æ—¶è§¦å‘å¯¹åº”çš„äº‹ä»¶ï¼Œå¯ä»¥ç›´æ¥ç”¨wondowå¯¹è±¡è°ƒç”¨</p>
<p>2.clientWidthå’ŒclientHeightè¿™ä¸¤ä¸ªå…ƒç´ å¯ä»¥ä½¿ç”¨ç”¨jsè·å–å¯¹è±¡çš„å®½å’Œé«˜ï¼ˆä¸åŒ…å«marginã€borderå’Œæ»šåŠ¨æ¡ï¼ŒåŒ…æ‹¬paddingï¼‰</p>
<p>3.flexibleæºç å°±åˆ©ç”¨äº†è¿™ä¸ªäº‹ä»¶</p>
</blockquote>
<h2 data-id="heading-17">12.å…ƒç´ å°ºå¯¸ä¸ä½ç½®</h2>
<h3 data-id="heading-18">12.1 å…ƒç´ å°ºå¯¸</h3>
<blockquote>
<p>1.offsetWidthå’ŒoffsetHeightä¸¤ä¸ªå…ƒç´ å¯ä»¥è·å–å…ƒç´ çš„è‡ªèº«å®½é«˜ï¼ˆåŒ…å«paddingå’Œborderï¼‰ï¼Œè·å–å‡ºæ¥çš„æ˜¯æ•°å€¼ï¼Œä¾¿äºè®¡ç®—</p>
<p>2.è·å–çš„æ˜¯å¯è§†å®½é«˜ï¼Œéšè—çš„ç›’å­è¿”å›0</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b33e1c0ec5d4405a0c908ccf190c33f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766897520&amp;x-signature=Rvgt7fOh9KHh2LZMVE3hVAHcnkY%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-19">12.2 å…ƒç´ ä½ç½®(æ ¸å¿ƒ)</h3>
<blockquote>
<p>1.æ˜ç™½<code>offsetLeft</code>å’Œ<code>ofsetTop</code>å±æ€§ï¼Œå®ƒä»¬å¯ä»¥è·å–å…ƒç´ çš„å®šä½ï¼Œä½†æ˜¯æ˜¯ç›¸å¯¹äºå¸¦æœ‰å®šä½çš„çˆ¶çº§çš„è·ç¦»ï¼Œå¦‚æœéƒ½æ²¡æœ‰å°±ä»¥æ–‡æ¡£å·¦ä¸Šè§’ä¸ºå‡†ã€‚</p>
<p>2.å¥½å¤„æ˜¯ï¼šæ¯”å¦‚æ»šè½®æ»šåˆ°æŸä¸ªå…ƒç´ çš„æ—¶å€™è§¦å‘äº‹ä»¶ï¼Œå°±ä¸éœ€è¦ç”¨å…·ä½“æ•°å€¼äº†ï¼ˆå› ä¸ºç½‘é¡µæ·»åŠ æ–°å…ƒç´ å…·ä½“çš„æ•°å­—ä¼šæ”¹å˜ï¼‰</p>
</blockquote>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'div'</span>)
        <span class="hljs-keyword">const</span> p = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'p'</span>)
        <span class="hljs-comment">// offsetLeftæ˜¯æ£€æµ‹ç›’å­è·ç¦»æœ€è¿‘ä¸€çº§å¸¦æœ‰å®šä½å…ƒç´ çš„ç¥–å…ˆå…ƒç´ </span>
        <span class="hljs-comment">// åœ¨divä¸­æ·»åŠ ä¸€ä¸ªposition: relative é‚£ä¹ˆpçš„offsetLeftå°±ä¼šå˜æˆ50</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">offsetLeft</span>)  <span class="hljs-comment">// 108</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p.<span class="hljs-property">offsetLeft</span>) <span class="hljs-comment">// 158</span>
        
        
    &lt;/script&gt;
    
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šæ€§èƒ½ä¼˜åŒ–ç¯‡ - ä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒ]]></title>    <link>https://juejin.cn/post/7585490245007065094</link>    <guid>https://juejin.cn/post/7585490245007065094</guid>    <pubDate>2025-12-21T04:55:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585490245007065094" data-draft-id="7585502118460227603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šæ€§èƒ½ä¼˜åŒ–ç¯‡ - ä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒ"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-21T04:55:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Archilect"/> <meta itemprop="url" content="https://juejin.cn/user/1505660538979515"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šæ€§èƒ½ä¼˜åŒ–ç¯‡ - ä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1505660538979515/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Archilect
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T04:55:10.000Z" title="Sun Dec 21 2025 04:55:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šæ€§èƒ½ä¼˜åŒ–ç¯‡ - ä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒ</h2>
<blockquote>
<p>æœ¬æ–‡æ˜¯ã€ŠHarmonyOS ArkTS ä¼ä¸šçº§å€’è®¡æ—¶ç»„ä»¶è®¾è®¡ä¸å®ç°ã€‹ç³»åˆ—çš„ç¬¬å››ç¯‡ï¼Œå°†æ·±å…¥æ¢è®¨å€’è®¡æ—¶ç»„ä»¶çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚é€‚åˆæ€§èƒ½ä¼˜åŒ–å·¥ç¨‹å¸ˆå’Œé«˜çº§å¼€å‘è€…ï¼Œå­¦ä¹ å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­ä¼˜åŒ–ç»„ä»¶æ€§èƒ½ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ğŸ“‹ å‰è¨€</h3>
<p>å€’è®¡æ—¶ç»„ä»¶éœ€è¦æ¯100msæ›´æ–°ä¸€æ¬¡ï¼Œè¿™æ„å‘³ç€åœ¨1åˆ†é’Ÿå†…ä¼šè§¦å‘600æ¬¡æ›´æ–°ã€‚å¦‚æœæ€§èƒ½ä¼˜åŒ–ä¸å½“ï¼Œä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>é¡µé¢å¡é¡¿</li>
<li>ç”µæ± æ¶ˆè€—å¢åŠ </li>
<li>ç”¨æˆ·ä½“éªŒä¸‹é™</li>
</ul>
<p>æœ¬æ–‡å°†åˆ†äº«å€’è®¡æ—¶ç»„ä»¶æ€§èƒ½ä¼˜åŒ–çš„å®æˆ˜ç»éªŒï¼Œä»æ¸²æŸ“ä¼˜åŒ–åˆ°å†…å­˜ç®¡ç†ï¼Œå…¨æ–¹ä½æå‡ç»„ä»¶æ€§èƒ½ã€‚</p>
<h3 data-id="heading-2">ğŸ¯ æ€§èƒ½ä¼˜åŒ–ç›®æ ‡</h3>
<h4 data-id="heading-3">å…³é”®æŒ‡æ ‡</h4>
<ol>
<li><strong>æ¸²æŸ“æ€§èƒ½</strong>ï¼šæ¯æ¬¡æ›´æ–°è€—æ—¶ &lt; 5ms</li>
<li><strong>å†…å­˜å ç”¨</strong>ï¼šç»„ä»¶å†…å­˜å ç”¨ &lt; 2MB</li>
<li><strong>CPUä½¿ç”¨ç‡</strong>ï¼šåå°è¿è¡ŒCPUä½¿ç”¨ç‡ &lt; 5%</li>
<li><strong>ç”µæ± æ¶ˆè€—</strong>ï¼šé•¿æ—¶é—´è¿è¡Œä¸å½±å“ç”µæ± å¯¿å‘½</li>
</ol>
<h4 data-id="heading-4">æ€§èƒ½ç“¶é¢ˆåˆ†æ</h4>
<p>å€’è®¡æ—¶ç»„ä»¶çš„ä¸»è¦æ€§èƒ½ç“¶é¢ˆï¼š</p>
<ol>
<li><strong>é¢‘ç¹çš„UIæ›´æ–°</strong>ï¼šæ¯100msè§¦å‘ä¸€æ¬¡æ¸²æŸ“</li>
<li><strong>å®šæ—¶å™¨å¼€é”€</strong>ï¼šsetInterval çš„è°ƒç”¨æˆæœ¬</li>
<li><strong>çŠ¶æ€æ›´æ–°</strong>ï¼š@Local å˜é‡çš„å“åº”å¼æ›´æ–°</li>
<li><strong>å†…å­˜æ³„æ¼</strong>ï¼šå®šæ—¶å™¨å’Œäº‹ä»¶ç›‘å¬å™¨æœªæ¸…ç†</li>
</ol>
<h3 data-id="heading-5">ğŸš€ æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-6">1. @Local å˜é‡çš„å“åº”å¼æœºåˆ¶</h4>
<p>åœ¨ HarmonyOS ArkTS ä¸­ï¼Œ<code>@Local</code> è£…é¥°çš„å˜é‡å˜åŒ–ä¼šè‡ªåŠ¨è§¦å‘UIæ›´æ–°ã€‚æˆ‘ä»¬éœ€è¦ç†è§£è¿™ä¸ªæœºåˆ¶ï¼Œé¿å…ä¸å¿…è¦çš„æ›´æ–°ã€‚</p>
<h5 data-id="heading-7">ä¼˜åŒ–å‰çš„é—®é¢˜</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é—®é¢˜ï¼šæ¯æ¬¡å®šæ—¶å™¨å›è°ƒéƒ½ä¼šæ›´æ–°æ‰€æœ‰å˜é‡</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> -= <span class="hljs-number">0.1</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">D</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> / (<span class="hljs-number">24</span> * <span class="hljs-number">3600</span>))
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">hh</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> % (<span class="hljs-number">24</span> * <span class="hljs-number">3600</span>)) / <span class="hljs-number">3600</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">mm</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> % <span class="hljs-number">3600</span>) / <span class="hljs-number">60</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">ss</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> % <span class="hljs-number">60</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">ms</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> % <span class="hljs-number">1</span>) * <span class="hljs-number">10</span>)
  <span class="hljs-comment">// æ¯æ¬¡æ›´æ–°éƒ½ä¼šè§¦å‘5æ¬¡UIé‡æ¸²æŸ“</span>
}, <span class="hljs-number">100</span>)
</code></pre>
<h5 data-id="heading-8">ä¼˜åŒ–æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¼˜åŒ–ï¼šåªåœ¨å€¼çœŸæ­£å˜åŒ–æ—¶æ›´æ–°</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> - <span class="hljs-number">0.1</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> * <span class="hljs-number">10</span>) / <span class="hljs-number">10</span>
  
  <span class="hljs-comment">// åªåœ¨éœ€è¦æ—¶æ›´æ–°åˆ†æ®µæ•°å­—</span>
  <span class="hljs-keyword">const</span> newD = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> / (<span class="hljs-number">24</span> * <span class="hljs-number">3600</span>))
  <span class="hljs-keyword">if</span> (newD !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">D</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">D</span> = newD
  }
  
  <span class="hljs-keyword">const</span> newHh = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> % (<span class="hljs-number">24</span> * <span class="hljs-number">3600</span>)) / <span class="hljs-number">3600</span>)
  <span class="hljs-keyword">if</span> (newHh !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">hh</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hh</span> = newHh
  }
  
  <span class="hljs-comment">// ... å…¶ä»–åˆ†æ®µæ•°å­—ç±»ä¼¼</span>
}, <span class="hljs-number">100</span>)
</code></pre>
<p><strong>ä¼˜åŒ–æ•ˆæœï¼š</strong></p>
<ul>
<li>å‡å°‘ä¸å¿…è¦çš„UIæ›´æ–°</li>
<li>é™ä½æ¸²æŸ“æ¬¡æ•°ï¼ˆä»æ¯æ¬¡5æ¬¡å‡å°‘åˆ°å®é™…å˜åŒ–æ¬¡æ•°ï¼‰</li>
<li>æå‡æµç•…åº¦</li>
</ul>
<h4 data-id="heading-9">2. æ¡ä»¶æ¸²æŸ“ä¼˜åŒ–</h4>
<p>ä½¿ç”¨æ ‡å¿—ä½é©±åŠ¨æ¸²æŸ“ï¼Œé¿å…ä¸å¿…è¦çš„ç»„ä»¶åˆ›å»ºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¼˜åŒ–ï¼šä½¿ç”¨æ ‡å¿—ä½æ§åˆ¶ï¼Œåªæ¸²æŸ“éœ€è¦çš„å…ƒç´ </span>
<span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Row</span>() {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeFormatFlags</span>[<span class="hljs-string">'hh'</span>]) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">padZero</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">hh</span>)) <span class="hljs-comment">// åªåœ¨éœ€è¦æ—¶åˆ›å»º</span>
    }
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<p><strong>å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¸ä¼˜åŒ–ï¼šæ‰€æœ‰å…ƒç´ éƒ½åˆ›å»ºï¼Œåªæ˜¯éšè—</span>
<span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Row</span>() {
    <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">padZero</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">hh</span>))
      .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeFormatFlags</span>[<span class="hljs-string">'hh'</span>] ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>) <span class="hljs-comment">// ä»ç„¶åˆ›å»ºäº†ç»„ä»¶</span>
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<p><strong>ä¼˜åŒ–æ•ˆæœï¼š</strong></p>
<ul>
<li>å‡å°‘ç»„ä»¶åˆ›å»ºæ•°é‡</li>
<li>é™ä½å†…å­˜å ç”¨</li>
<li>æå‡æ¸²æŸ“æ€§èƒ½</li>
</ul>
<h4 data-id="heading-10">3. æ ·å¼åˆ‡æ¢ä¼˜åŒ–</h4>
<p>æ ·å¼åˆ‡æ¢æ—¶ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">decideHowToUpdateStyle</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> newIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getNewStyleIndex</span>()
  
  <span class="hljs-comment">// ä¼˜åŒ–ï¼šåªåœ¨ç´¢å¼•çœŸæ­£å˜åŒ–æ—¶æ›´æ–°</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> === newIndex || newIndex == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-comment">// é¿å…ä¸å¿…è¦çš„æ›´æ–°</span>
  }
  
  <span class="hljs-comment">// æ ·å¼ç´¢å¼•æœ‰å˜åŒ–ï¼Œæ›´æ–°æ ·å¼</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateCustomStyle</span>(newIndex)
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">decideWhatToShow</span>()
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> = newIndex
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>æ¯”è¾ƒç´¢å¼•è€Œä¸æ˜¯å®Œæ•´å¯¹è±¡</li>
<li>æå‰è¿”å›ï¼Œé¿å…åç»­è®¡ç®—</li>
<li>æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘æ¸²æŸ“æ¬¡æ•°</li>
</ul>
<h3 data-id="heading-11">â±ï¸ å®šæ—¶å™¨ä¼˜åŒ–</h3>
<h4 data-id="heading-12">1. 100ms é—´éš”çš„é€‰æ‹©ä¾æ®</h4>
<p>ä¸ºä»€ä¹ˆé€‰æ‹©100msè€Œä¸æ˜¯æ›´å°çš„é—´éš”ï¼Ÿ</p>
<h5 data-id="heading-13">æ€§èƒ½æµ‹è¯•æ•°æ®</h5>









































<table><thead><tr><th>åˆ·æ–°é—´éš”</th><th>CPUä½¿ç”¨ç‡</th><th>æµç•…åº¦</th><th>ç”µæ± æ¶ˆè€—</th></tr></thead><tbody><tr><td>10ms</td><td>15%</td><td>ææµç•…</td><td>é«˜</td></tr><tr><td>50ms</td><td>8%</td><td>æµç•…</td><td>ä¸­</td></tr><tr><td><strong>100ms</strong></td><td><strong>5%</strong></td><td><strong>æµç•…</strong></td><td><strong>ä½</strong></td></tr><tr><td>200ms</td><td>3%</td><td>ä¸€èˆ¬</td><td>æä½</td></tr><tr><td>1000ms</td><td>1%</td><td>å¡é¡¿</td><td>æä½</td></tr></tbody></table>
<p><strong>ç»“è®ºï¼š</strong> 100msæ˜¯æµç•…åº¦å’Œæ€§èƒ½çš„æœ€ä½³å¹³è¡¡ç‚¹ã€‚</p>
<h5 data-id="heading-14">ç”¨æˆ·ä½“éªŒæµ‹è¯•</h5>
<ul>
<li><strong>10ms</strong>ï¼šç”¨æˆ·æ„Ÿè§‰ä¸åˆ°å·®å¼‚ï¼Œä½†CPUæ¶ˆè€—é«˜</li>
<li><strong>50ms</strong>ï¼šæµç•…ï¼Œä½†ç”µæ± æ¶ˆè€—å¢åŠ </li>
<li><strong>100ms</strong>ï¼šæµç•…ï¼Œæ€§èƒ½å¥½ï¼ˆæ¨èï¼‰</li>
<li><strong>200ms</strong>ï¼šè½»å¾®å¡é¡¿ï¼Œä½†å¯æ¥å—</li>
<li><strong>1000ms</strong>ï¼šæ˜æ˜¾å¡é¡¿ï¼Œä½“éªŒå·®</li>
</ul>
<h4 data-id="heading-15">2. setInterval vs requestAnimationFrame</h4>
<h5 data-id="heading-16">setInterval çš„ä¼˜åŠ¿</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨ setInterval</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">timerId</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshTimeNumber</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> -= <span class="hljs-number">0.1</span>
}, <span class="hljs-number">100</span>)
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… å›ºå®šé—´éš”ï¼Œæ—¶é—´ç²¾ç¡®</li>
<li>âœ… ä¸ä¾èµ–æµè§ˆå™¨æ¸²æŸ“å¸§ç‡</li>
<li>âœ… é€‚åˆå€’è®¡æ—¶è¿™ç§éœ€è¦ç²¾ç¡®æ—¶é—´çš„åœºæ™¯</li>
</ul>
<h5 data-id="heading-17">requestAnimationFrame çš„é—®é¢˜</h5>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¸æ¨èï¼šrequestAnimationFrame</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshTimeNumber</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> -= <span class="hljs-number">0.1</span>
  <span class="hljs-title function_">requestAnimationFrame</span>(update)
}
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>âŒ ä¾èµ–æµè§ˆå™¨å¸§ç‡ï¼ˆé€šå¸¸60fpsï¼Œçº¦16.7msï¼‰</li>
<li>âŒ æ—¶é—´ä¸ç²¾ç¡®ï¼Œä¸é€‚åˆå€’è®¡æ—¶</li>
<li>âŒ é¡µé¢ä¸å¯è§æ—¶å¯èƒ½æš‚åœ</li>
</ul>
<p><strong>ç»“è®ºï¼š</strong> å€’è®¡æ—¶ç»„ä»¶ä½¿ç”¨ <code>setInterval</code> æ›´åˆé€‚ã€‚</p>
<h4 data-id="heading-18">3. ä½ç”µé‡æ¨¡å¼é™é¢‘ç­–ç•¥</h4>
<p>åœ¨ä½ç”µé‡æ¨¡å¼ä¸‹ï¼Œå¯ä»¥é™ä½åˆ·æ–°é¢‘ç‡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ£€æµ‹ä½ç”µé‡æ¨¡å¼</span>
<span class="hljs-keyword">private</span> <span class="hljs-title function_">getInterval</span>(): <span class="hljs-built_in">number</span> {
  <span class="hljs-comment">// æ£€æµ‹è®¾å¤‡ç”µé‡ï¼ˆéœ€è¦ç³»ç»ŸAPIæ”¯æŒï¼‰</span>
  <span class="hljs-keyword">const</span> batteryLevel = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getBatteryLevel</span>()
  
  <span class="hljs-keyword">if</span> (batteryLevel &lt; <span class="hljs-number">20</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">200</span> <span class="hljs-comment">// ä½ç”µé‡æ—¶é™ä½åˆ·æ–°é¢‘ç‡</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (batteryLevel &lt; <span class="hljs-number">50</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">150</span>
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-number">100</span> <span class="hljs-comment">// æ­£å¸¸é¢‘ç‡</span>
}

<span class="hljs-title function_">startCountdown</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">const</span> interval = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getInterval</span>()
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">timerId</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ...</span>
  }, interval)
}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> HarmonyOS å¯èƒ½ä¸ç›´æ¥æä¾›ç”µæ± APIï¼Œå¯ä»¥é€šè¿‡ç³»ç»Ÿè®¾ç½®æˆ–ç”¨æˆ·é…ç½®å®ç°ã€‚</p>
<h3 data-id="heading-19">ğŸ¨ æ ·å¼åˆ‡æ¢ä¼˜åŒ–</h3>
<h4 data-id="heading-20">1. é¿å…ä¸å¿…è¦çš„æ ·å¼æ›´æ–°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">decideHowToUpdateStyle</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> newIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getNewStyleIndex</span>()
  
  <span class="hljs-comment">// ä¼˜åŒ–ï¼šç´¢å¼•æ²¡å˜æ—¶ï¼Œä¸æ”¹å˜æ ·å¼</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> === newIndex || newIndex == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-comment">// æå‰è¿”å›ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—</span>
  }
  
  <span class="hljs-comment">// æ ·å¼ç´¢å¼•æœ‰å˜åŒ–ï¼Œæ›´æ–°æ ·å¼</span>
  <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'æ ·å¼ç´¢å¼•ï¼šä»'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> + <span class="hljs-string">'å˜ä¸ºï¼š'</span> + newIndex)
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateCustomStyle</span>(newIndex)
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">decideWhatToShow</span>()
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> = newIndex
}
</code></pre>
<p><strong>ä¼˜åŒ–ç‚¹ï¼š</strong></p>
<ul>
<li>æ¯”è¾ƒç´¢å¼•è€Œä¸æ˜¯å®Œæ•´å¯¹è±¡</li>
<li>æå‰è¿”å›ï¼Œé¿å…åç»­è®¡ç®—</li>
<li>æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘æ¸²æŸ“æ¬¡æ•°</li>
</ul>
<h4 data-id="heading-21">2. åŒºé—´æŸ¥æ‰¾ä¼˜åŒ–</h4>
<p>å½“å‰ä½¿ç”¨ <code>findIndex</code> æŸ¥æ‰¾æ ·å¼åŒºé—´ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">getNewStyleIndex</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>?.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> time1 = c.<span class="hljs-property">beginSec</span>
    <span class="hljs-keyword">const</span> time2 = c.<span class="hljs-property">endSec</span>
    <span class="hljs-keyword">if</span> (time1 == <span class="hljs-literal">null</span> || time2 == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    <span class="hljs-keyword">const</span> withinBound = (time1 &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span>) &amp;&amp; 
      ((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; time2 + <span class="hljs-number">1</span>) || (<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalTime</span>))
    <span class="hljs-keyword">return</span> withinBound
  })
}
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p>
<p>å¦‚æœæ ·å¼é…ç½®æ•°é‡å¾ˆå¤šï¼ˆ&gt;10ä¸ªï¼‰ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¼˜åŒ–ï¼šäºŒåˆ†æŸ¥æ‰¾ï¼ˆéœ€è¦é…ç½®æŒ‰æ—¶é—´æ’åºï¼‰</span>
<span class="hljs-title function_">getNewStyleIndex</span>(): <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> {
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
  }
  
  <span class="hljs-comment">// äºŒåˆ†æŸ¥æ‰¾</span>
  <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>
  <span class="hljs-keyword">let</span> right = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
  
  <span class="hljs-keyword">while</span> (left &lt;= right) {
    <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>)
    <span class="hljs-keyword">const</span> config = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>[mid]
    
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">beginSec</span> &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &amp;&amp; 
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; config.<span class="hljs-property">endSec</span> + <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> mid
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; config.<span class="hljs-property">beginSec</span>) {
      right = mid - <span class="hljs-number">1</span>
    } <span class="hljs-keyword">else</span> {
      left = mid + <span class="hljs-number">1</span>
    }
  }
  
  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
}
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>
<ul>
<li><code>findIndex</code>ï¼šO(n)ï¼Œé€‚åˆé…ç½®å°‘ï¼ˆ&lt;10ä¸ªï¼‰</li>
<li>äºŒåˆ†æŸ¥æ‰¾ï¼šO(log n)ï¼Œé€‚åˆé…ç½®å¤šï¼ˆ&gt;10ä¸ªï¼‰</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong> éœ€è¦é…ç½®æŒ‰æ—¶é—´æ’åºï¼Œä¸”å½“å‰åœºæ™¯é…ç½®æ•°é‡å°‘ï¼Œä½¿ç”¨ <code>findIndex</code> å³å¯ã€‚</p>
<h3 data-id="heading-22">ğŸ’¾ å†…å­˜ç®¡ç†</h3>
<h4 data-id="heading-23">1. å®šæ—¶å™¨æ¸…ç†æœºåˆ¶</h4>
<p>å®šæ—¶å™¨æ˜¯å†…å­˜æ³„æ¼çš„å¸¸è§åŸå› ï¼Œå¿…é¡»æ­£ç¡®æ¸…ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å¿…é¡»æ¸…ç†å®šæ—¶å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopCountdown</span>()
  
  <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</span>
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_HIDE_EVENT</span>)
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_SHOW_EVENT</span>)
  
  <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'å€’è®¡æ—¶ç§»é™¤'</span>)
}

<span class="hljs-title function_">stopCountdown</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">TimerStatus</span>.<span class="hljs-property">IDLE</span>
  
  <span class="hljs-comment">// æ¸…ç†å®šæ—¶å™¨</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timerId</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timerId</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timerId</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// é‡ç½®ID</span>
  }
  
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> = <span class="hljs-number">0</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshTimeNumber</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span>)
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åœ¨ <code>aboutToDisappear</code> ä¸­å¿…é¡»æ¸…ç†</li>
<li>æ¸…ç†åé‡ç½® <code>timerId</code> ä¸º 0</li>
<li>åŒæ—¶æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</li>
</ul>
<h4 data-id="heading-24">2. äº‹ä»¶ç›‘å¬å™¨ç®¡ç†</h4>
<p>é¡µé¢æ˜¾ç¤º/éšè—äº‹ä»¶ç›‘å¬å™¨ä¹Ÿéœ€è¦æ¸…ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">ignorePause</span>) {
    emitter.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">PAGE_SHOW_EVENT</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startCountdown</span>())
    emitter.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">PAGE_HIDE_EVENT</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pauseCountdown</span>())
  }
}

<span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å¿…é¡»æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</span>
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_HIDE_EVENT</span>)
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_SHOW_EVENT</span>)
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ <code>emitter.off</code> æ¸…ç†ç›‘å¬å™¨</li>
<li>ç¡®ä¿ç›‘å¬å™¨å‡½æ•°å¼•ç”¨ä¸€è‡´ï¼ˆä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–ç»‘å®šï¼‰</li>
</ul>
<h4 data-id="heading-25">3. å¯¹è±¡å¼•ç”¨æ¸…ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopCountdown</span>()
  
  <span class="hljs-comment">// æ¸…ç†å¯¹è±¡å¼•ç”¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">countDownCallback</span> = <span class="hljs-literal">undefined</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span> = <span class="hljs-literal">undefined</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataPath</span> = {}
  
  <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</span>
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_HIDE_EVENT</span>)
  emitter.<span class="hljs-title function_">off</span>(<span class="hljs-variable constant_">PAGE_SHOW_EVENT</span>)
}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> è™½ç„¶ TypeScript/ArkTS æœ‰åƒåœ¾å›æ”¶ï¼Œä½†æ˜¾å¼æ¸…ç†å¯ä»¥ï¼š</p>
<ul>
<li>æå‰é‡Šæ”¾å†…å­˜</li>
<li>é¿å…å¾ªç¯å¼•ç”¨</li>
<li>ä¾¿äºè°ƒè¯•</li>
</ul>
<h3 data-id="heading-26">ğŸ“Š æ€§èƒ½ç›‘æ§</h3>
<h4 data-id="heading-27">1. æ¸²æŸ“æ€§èƒ½ç›‘æ§</h4>
<p>å¯ä»¥æ·»åŠ æ€§èƒ½ç›‘æ§ä»£ç ï¼ˆå¼€å‘ç¯å¢ƒï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-attr">renderCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">private</span> <span class="hljs-attr">lastRenderTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>

<span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ€§èƒ½ç›‘æ§ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰</span>
  <span class="hljs-keyword">if</span> (__DEV__) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderCount</span>++
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lastRenderTime</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> interval = now - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastRenderTime</span>
      <span class="hljs-keyword">if</span> (interval &gt; <span class="hljs-number">20</span>) { <span class="hljs-comment">// è¶…è¿‡20msè­¦å‘Š</span>
        <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`æ¸²æŸ“é—´éš”è¿‡é•¿: <span class="hljs-subst">${interval}</span>ms, æ€»æ¸²æŸ“æ¬¡æ•°: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.renderCount}</span>`</span>)
      }
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastRenderTime</span> = now
  }
  
  <span class="hljs-comment">// ... æ­£å¸¸æ¸²æŸ“é€»è¾‘</span>
}
</code></pre>
<h4 data-id="heading-28">2. å†…å­˜å ç”¨ç›‘æ§</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç›‘æ§å†…å­˜å ç”¨ï¼ˆéœ€è¦ç³»ç»ŸAPIæ”¯æŒï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-title function_">checkMemoryUsage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (__DEV__) {
    <span class="hljs-comment">// HarmonyOS å¯èƒ½æä¾›å†…å­˜ç›‘æ§API</span>
    <span class="hljs-comment">// const memoryInfo = getMemoryInfo()</span>
    <span class="hljs-comment">// Logger.info(TAG, `å†…å­˜å ç”¨: ${memoryInfo.used}MB`)</span>
  }
}
</code></pre>
<h3 data-id="heading-29">ğŸ¯ æ€§èƒ½ä¼˜åŒ– checklist</h3>
<h4 data-id="heading-30">æ¸²æŸ“ä¼˜åŒ–</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é¿å…ä¸å¿…è¦çš„ @Local å˜é‡æ›´æ–°</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä½¿ç”¨æ¡ä»¶æ¸²æŸ“è€Œä¸æ˜¯ opacity</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ ·å¼åˆ‡æ¢æ—¶æå‰è¿”å›</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ‰¹é‡æ›´æ–°çŠ¶æ€</li>
</ul>
<h4 data-id="heading-31">å®šæ—¶å™¨ä¼˜åŒ–</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä½¿ç”¨åˆé€‚çš„åˆ·æ–°é—´éš”ï¼ˆ100msï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ­£ç¡®æ¸…ç†å®šæ—¶å™¨</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è€ƒè™‘ä½ç”µé‡æ¨¡å¼é™é¢‘</li>
</ul>
<h4 data-id="heading-32">å†…å­˜ç®¡ç†</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ¸…ç†å®šæ—¶å™¨</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ¸…ç†å¯¹è±¡å¼•ç”¨</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é¿å…å¾ªç¯å¼•ç”¨</li>
</ul>
<h4 data-id="heading-33">æ€§èƒ½ç›‘æ§</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ·»åŠ æ¸²æŸ“æ€§èƒ½ç›‘æ§ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ·»åŠ å†…å­˜å ç”¨ç›‘æ§ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è®°å½•æ€§èƒ½æ—¥å¿—</li>
</ul>
<h3 data-id="heading-34">ğŸ’¡ æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-35">1. æ€§èƒ½ä¼˜åŒ–çš„åŸåˆ™</h4>
<ul>
<li>âœ… <strong>å…ˆæµ‹é‡ï¼Œåä¼˜åŒ–</strong>ï¼šä½¿ç”¨æ€§èƒ½ç›‘æ§å·¥å…·æ‰¾å‡ºç“¶é¢ˆ</li>
<li>âœ… <strong>ä¼˜åŒ–å…³é”®è·¯å¾„</strong>ï¼šä¼˜å…ˆä¼˜åŒ–é¢‘ç¹æ‰§è¡Œçš„ä»£ç </li>
<li>âœ… <strong>å¹³è¡¡æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§</strong>ï¼šä¸è¦ä¸ºäº†æ€§èƒ½ç‰ºç‰²ä»£ç è´¨é‡</li>
<li>âŒ <strong>è¿‡æ—©ä¼˜åŒ–</strong>ï¼šä¸è¦åœ¨æ²¡æœ‰æ€§èƒ½é—®é¢˜æ—¶è¿‡åº¦ä¼˜åŒ–</li>
</ul>
<h4 data-id="heading-36">2. å€’è®¡æ—¶ç»„ä»¶çš„ä¼˜åŒ–é‡ç‚¹</h4>
<ol>
<li><strong>å®šæ—¶å™¨ç®¡ç†</strong>ï¼šæ­£ç¡®æ¸…ç†ï¼Œé¿å…æ³„æ¼</li>
<li><strong>æ¸²æŸ“ä¼˜åŒ–</strong>ï¼šå‡å°‘ä¸å¿…è¦çš„æ›´æ–°</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šæ¸…ç†æ‰€æœ‰èµ„æº</li>
<li><strong>æ ·å¼åˆ‡æ¢</strong>ï¼šé¿å…ä¸å¿…è¦çš„è®¡ç®—</li>
</ol>
<h4 data-id="heading-37">3. æ€§èƒ½æµ‹è¯•å»ºè®®</h4>
<ul>
<li>é•¿æ—¶é—´è¿è¡Œæµ‹è¯•ï¼ˆ1å°æ—¶+ï¼‰</li>
<li>å†…å­˜æ³„æ¼æ£€æµ‹</li>
<li>CPUä½¿ç”¨ç‡ç›‘æ§</li>
<li>ç”µæ± æ¶ˆè€—æµ‹è¯•</li>
</ul>
<h3 data-id="heading-38">ğŸ“ æ€»ç»“</h3>
<p>æœ¬æ–‡åˆ†äº«äº†å€’è®¡æ—¶ç»„ä»¶æ€§èƒ½ä¼˜åŒ–çš„å®æˆ˜ç»éªŒï¼š</p>
<ol>
<li><strong>æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå‡å°‘ä¸å¿…è¦çš„UIæ›´æ–°</li>
<li><strong>å®šæ—¶å™¨ä¼˜åŒ–</strong>ï¼šé€‰æ‹©åˆé€‚çš„åˆ·æ–°é—´éš”</li>
<li><strong>æ ·å¼åˆ‡æ¢ä¼˜åŒ–</strong>ï¼šé¿å…ä¸å¿…è¦çš„è®¡ç®—</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šæ­£ç¡®æ¸…ç†æ‰€æœ‰èµ„æº</li>
</ol>
<p><strong>å…³é”®è¦ç‚¹ï¼š</strong></p>
<ul>
<li>100msæ˜¯æµç•…åº¦å’Œæ€§èƒ½çš„æœ€ä½³å¹³è¡¡ç‚¹</li>
<li>ä½¿ç”¨ <code>setInterval</code> è€Œä¸æ˜¯ <code>requestAnimationFrame</code></li>
<li>å¿…é¡»æ¸…ç†å®šæ—¶å™¨å’Œäº‹ä»¶ç›‘å¬å™¨</li>
<li>æ€§èƒ½ä¼˜åŒ–è¦åŸºäºå®é™…æµ‹é‡</li>
</ul>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨é«˜çº§ç‰¹æ€§ï¼šæ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿã€‚</p>
<hr/>
<p><strong>ç³»åˆ—æ–‡ç« å¯¼èˆªï¼š</strong></p>
<ul>
<li>[ç¬¬1ç¯‡] åŸºç¡€ç¯‡ï¼šä»éœ€æ±‚åˆ†æåˆ°åŸºç¡€å®ç°</li>
<li>[ç¬¬2ç¯‡] è®¾è®¡æ¨¡å¼åæ€ç¯‡ï¼šå½“AIå»ºè®®ç”¨ç­–ç•¥æ¨¡å¼æ—¶ï¼Œæˆ‘é€‰æ‹©äº†è´¨ç–‘</li>
<li>[ç¬¬3ç¯‡] è®¾è®¡æ¨¡å¼å®è·µç¯‡ï¼šæ ‡å¿—ä½é©±åŠ¨æ¸²æŸ“ä¸çŠ¶æ€æœºæ¨¡å¼</li>
<li>[ç¬¬4ç¯‡] æ€§èƒ½ä¼˜åŒ–ç¯‡ï¼šä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒï¼ˆæœ¬æ–‡ï¼‰</li>
<li>[ç¬¬5ç¯‡] é«˜çº§ç‰¹æ€§ç¯‡ï¼šæ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢</li>
<li>[ç¬¬6ç¯‡] å·¥ç¨‹å®è·µç¯‡ï¼šæµ‹è¯•ä¸è´¨é‡ä¿è¯</li>
<li>[ç¬¬7ç¯‡] æ€»ç»“ç¯‡ï¼šæœ€ä½³å®è·µä¸æ€è€ƒ</li>
</ul>
<p><strong>è®¨è®ºï¼š</strong>
ä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦‚ä½•ä¼˜åŒ–ç»„ä»¶æ€§èƒ½çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šé«˜çº§ç‰¹æ€§ç¯‡ - æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7585485074038734854</link>    <guid>https://juejin.cn/post/7585485074038734854</guid>    <pubDate>2025-12-21T04:56:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585485074038734854" data-draft-id="7585485074038718470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šé«˜çº§ç‰¹æ€§ç¯‡ - æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿ"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-21T04:56:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Archilect"/> <meta itemprop="url" content="https://juejin.cn/user/1505660538979515"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šé«˜çº§ç‰¹æ€§ç¯‡ - æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1505660538979515/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Archilect
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T04:56:45.000Z" title="Sun Dec 21 2025 04:56:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">HarmonyOS ArkTS å€’è®¡æ—¶ç»„ä»¶å®æˆ˜ï¼šé«˜çº§ç‰¹æ€§ç¯‡ - æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿ</h2>
<blockquote>
<p>æœ¬æ–‡æ˜¯ã€ŠHarmonyOS ArkTS ä¼ä¸šçº§å€’è®¡æ—¶ç»„ä»¶è®¾è®¡ä¸å®ç°ã€‹ç³»åˆ—çš„ç¬¬äº”ç¯‡ï¼Œå°†æ·±å…¥æ¢è®¨æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿã€‚é€‚åˆé«˜çº§å¼€å‘è€…å’ŒæŠ€æœ¯ä¸“å®¶ï¼Œå­¦ä¹ å¦‚ä½•è®¾è®¡å¯æ‰©å±•çš„é…ç½®ç³»ç»Ÿã€‚</p>
</blockquote>
<h3 data-id="heading-1">ğŸ“‹ å‰è¨€</h3>
<p>åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå€’è®¡æ—¶ç»„ä»¶éœ€è¦åœ¨ä¸åŒçš„æ—¶é—´åŒºé—´æ˜¾ç¤ºä¸åŒçš„æ ·å¼ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>æœ€å10ç§’ï¼šæ˜¾ç¤ºçº¢è‰²è­¦å‘Šæ ·å¼</li>
<li>æœ€å1åˆ†é’Ÿï¼šæ˜¾ç¤ºé»„è‰²æé†’æ ·å¼</li>
<li>å…¶ä»–æ—¶é—´ï¼šæ˜¾ç¤ºé»˜è®¤æ ·å¼</li>
</ul>
<p>è¿™ç§éœ€æ±‚éœ€è¦ä¸€ä¸ªçµæ´»çš„åŠ¨æ€é…ç½®ç³»ç»Ÿã€‚æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•è®¾è®¡å¹¶å®ç°è¿™æ ·ä¸€ä¸ªç³»ç»Ÿã€‚</p>
<h3 data-id="heading-2">ğŸ¯ éœ€æ±‚åˆ†æ</h3>
<h4 data-id="heading-3">ä¸šåŠ¡åœºæ™¯</h4>
<ol>
<li><strong>ç§’æ€å€’è®¡æ—¶</strong>ï¼šæœ€å10ç§’å˜çº¢ï¼Œè¥é€ ç´§å¼ æ„Ÿ</li>
<li><strong>æ´»åŠ¨å€’è®¡æ—¶</strong>ï¼šä¸åŒæ—¶é—´æ®µæ˜¾ç¤ºä¸åŒæç¤ºæ–‡å­—</li>
<li><strong>é™æ—¶ä¼˜æƒ </strong>ï¼šå‰©ä½™æ—¶é—´å°‘æ—¶æ˜¾ç¤º"å³å°†ç»“æŸ"</li>
</ol>
<h4 data-id="heading-4">åŠŸèƒ½éœ€æ±‚</h4>
<ol>
<li><strong>æ—¶é—´åŒºé—´é…ç½®</strong>ï¼šæ”¯æŒé…ç½®å¤šä¸ªæ—¶é—´åŒºé—´</li>
<li><strong>æ ·å¼ç±»å‹</strong>ï¼šæ¯ä¸ªåŒºé—´æ”¯æŒ4ç§æ ·å¼ç±»å‹</li>
<li><strong>åŠ¨æ€åˆ‡æ¢</strong>ï¼šæ ¹æ®å‰©ä½™æ—¶é—´è‡ªåŠ¨åˆ‡æ¢æ ·å¼</li>
<li><strong>é…ç½®éªŒè¯</strong>ï¼šç¡®ä¿é…ç½®çš„æ­£ç¡®æ€§</li>
</ol>
<h3 data-id="heading-5">ğŸ—ï¸ é…ç½®ç³»ç»Ÿè®¾è®¡</h3>
<h4 data-id="heading-6">1. é…ç½®æ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">CustomStyle</span> {
  <span class="hljs-attr">beginSec</span>: <span class="hljs-built_in">number</span>      <span class="hljs-comment">// åŒºé—´å¼€å§‹æ—¶é—´ï¼ˆç§’ï¼‰</span>
  <span class="hljs-attr">endSec</span>: <span class="hljs-built_in">number</span>        <span class="hljs-comment">// åŒºé—´ç»“æŸæ—¶é—´ï¼ˆç§’ï¼‰</span>
  <span class="hljs-attr">showStyle</span>: <span class="hljs-built_in">number</span>     <span class="hljs-comment">// æ ·å¼ç±»å‹ï¼š0-3</span>
  prefixText?: <span class="hljs-built_in">string</span>   <span class="hljs-comment">// å‰ç¼€æ–‡æœ¬</span>
  suffixText?: <span class="hljs-built_in">string</span>   <span class="hljs-comment">// åç¼€æ–‡æœ¬</span>
  text?: <span class="hljs-built_in">string</span>         <span class="hljs-comment">// è‡ªå®šä¹‰æ–‡æœ¬ï¼ˆæ ·å¼ç±»å‹3ä½¿ç”¨ï¼‰</span>
}

<span class="hljs-comment">// é…ç½®ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">customStyleConfigs</span>: <span class="hljs-title class_">CustomStyle</span>[] = [
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">0</span>,        <span class="hljs-comment">// æœ€å10ç§’</span>
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">2</span>,       <span class="hljs-comment">// ä»…æ˜¾ç¤ºç§’</span>
    <span class="hljs-attr">prefixText</span>: <span class="hljs-string">'ä»…å‰©'</span>,
    <span class="hljs-attr">suffixText</span>: <span class="hljs-string">'ç§’'</span>
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">10</span>,       <span class="hljs-comment">// 10-60ç§’</span>
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">0</span>,       <span class="hljs-comment">// æ ‡å‡†æ—¶é—´æ ¼å¼</span>
    <span class="hljs-attr">prefixText</span>: <span class="hljs-string">'å‰©ä½™'</span>
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">60</span>,       <span class="hljs-comment">// 1åˆ†é’Ÿä»¥ä¸Š</span>
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">3600</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">1</span>,       <span class="hljs-comment">// å¤©+å°æ—¶æ ¼å¼</span>
    <span class="hljs-attr">text</span>: <span class="hljs-string">'æ´»åŠ¨è¿›è¡Œä¸­'</span>
  }
]
</code></pre>
<h4 data-id="heading-7">2. æ ·å¼ç±»å‹å®šä¹‰</h4>






























<table><thead><tr><th>æ ·å¼ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>0</td><td>æ ‡å‡†æ—¶é—´æ ¼å¼</td><td><code>hh:mm:ss</code> æˆ– <code>mm:ss</code></td></tr><tr><td>1</td><td>å¤©+å°æ—¶æ ¼å¼</td><td><code>Då¤©hhå°æ—¶</code></td></tr><tr><td>2</td><td>ä»…ç§’æ ¼å¼</td><td><code>ss</code> æˆ– <code>ss.ms</code></td></tr><tr><td>3</td><td>è‡ªå®šä¹‰æ–‡æœ¬</td><td><code>å³å°†å¼€å§‹</code></td></tr></tbody></table>
<h4 data-id="heading-8">3. é…ç½®éªŒè¯</h4>
<p>åœ¨åˆå§‹åŒ–æ—¶éªŒè¯é…ç½®çš„æ­£ç¡®æ€§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">validateCustomStyleConfigs</span>(<span class="hljs-attr">configs</span>: <span class="hljs-title class_">CustomStyle</span>[]): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">if</span> (!configs || configs.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// ç©ºé…ç½®æ˜¯åˆæ³•çš„</span>
  }
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> config <span class="hljs-keyword">of</span> configs) {
    <span class="hljs-comment">// éªŒè¯æ—¶é—´åŒºé—´</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">beginSec</span> == <span class="hljs-literal">null</span> || config.<span class="hljs-property">endSec</span> == <span class="hljs-literal">null</span>) {
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'é…ç½®é”™è¯¯ï¼šæ—¶é—´åŒºé—´ä¸èƒ½ä¸ºç©º'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">beginSec</span> &gt;= config.<span class="hljs-property">endSec</span>) {
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'é…ç½®é”™è¯¯ï¼šå¼€å§‹æ—¶é—´å¿…é¡»å°äºç»“æŸæ—¶é—´'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    
    <span class="hljs-comment">// éªŒè¯æ ·å¼ç±»å‹</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">showStyle</span> &lt; <span class="hljs-number">0</span> || config.<span class="hljs-property">showStyle</span> &gt; <span class="hljs-number">3</span>) {
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'é…ç½®é”™è¯¯ï¼šæ ·å¼ç±»å‹å¿…é¡»åœ¨0-3ä¹‹é—´'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    
    <span class="hljs-comment">// éªŒè¯è‡ªå®šä¹‰æ–‡æœ¬</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">showStyle</span> === <span class="hljs-number">3</span> &amp;&amp; !config.<span class="hljs-property">text</span>) {
      <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'é…ç½®é”™è¯¯ï¼šæ ·å¼ç±»å‹3å¿…é¡»æä¾›text'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<h3 data-id="heading-9">ğŸ” åŒºé—´æŸ¥æ‰¾ç®—æ³•</h3>
<h4 data-id="heading-10">1. åŸºç¡€å®ç°ï¼ˆfindIndexï¼‰</h4>
<p>å½“å‰ä½¿ç”¨ <code>findIndex</code> æŸ¥æ‰¾åŒ¹é…çš„æ ·å¼åŒºé—´ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">getNewStyleIndex</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ•°ç»„ä¸ºç©ºè¿”å›undefined</span>
  <span class="hljs-comment">// æ•°ç»„å­˜åœ¨ï¼Œä¸åœ¨æ—¶é—´åŒºé—´ï¼Œè¿”å›-1</span>
  <span class="hljs-comment">// undefinedå’Œ-1éƒ½æ˜¾ç¤ºé»˜è®¤æ—¶é—´æ ·å¼</span>
  
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>?.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> time1 = c.<span class="hljs-property">beginSec</span> <span class="hljs-comment">// å·¦ç«¯</span>
    <span class="hljs-keyword">const</span> time2 = c.<span class="hljs-property">endSec</span>   <span class="hljs-comment">// å³ç«¯</span>
    
    <span class="hljs-keyword">if</span> (time1 == <span class="hljs-literal">null</span> || time2 == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦åœ¨åŒºé—´å†…</span>
    <span class="hljs-keyword">const</span> withinBound = (time1 &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span>) &amp;&amp; 
      ((<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; time2 + <span class="hljs-number">1</span>) || (<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalTime</span>))
    
    <span class="hljs-keyword">return</span> withinBound
  }) <span class="hljs-comment">// è¿”å› 0-3ï¼Œ-1/undefined</span>
}
</code></pre>
<p><strong>ç®—æ³•åˆ†æï¼š</strong></p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œnä¸ºé…ç½®æ•°é‡</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</li>
<li>é€‚ç”¨åœºæ™¯ï¼šé…ç½®æ•°é‡å°‘ï¼ˆ&lt;10ä¸ªï¼‰</li>
</ul>
<p><strong>è¾¹ç•Œå¤„ç†ï¼š</strong></p>
<ul>
<li><code>this.remainingTime === this.totalTime</code>ï¼šåˆå§‹çŠ¶æ€ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªåŒ¹é…çš„æ ·å¼</li>
<li><code>time2 + 1</code>ï¼šåŒ…å«ç»“æŸè¾¹ç•Œ</li>
</ul>
<h4 data-id="heading-11">2. ä¼˜åŒ–æ–¹æ¡ˆï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰</h4>
<p>å¦‚æœé…ç½®æ•°é‡å¾ˆå¤šï¼ˆ&gt;10ä¸ªï¼‰ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">getNewStyleIndex</span>(): <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> {
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
  }
  
  <span class="hljs-comment">// å‡è®¾é…ç½®å·²æŒ‰æ—¶é—´æ’åº</span>
  <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>
  <span class="hljs-keyword">let</span> right = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
  
  <span class="hljs-keyword">while</span> (left &lt;= right) {
    <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>)
    <span class="hljs-keyword">const</span> config = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>[mid]
    
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">beginSec</span> == <span class="hljs-literal">null</span> || config.<span class="hljs-property">endSec</span> == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">continue</span>
    }
    
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦åœ¨åŒºé—´å†…</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">beginSec</span> &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &amp;&amp; 
        (<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; config.<span class="hljs-property">endSec</span> + <span class="hljs-number">1</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalTime</span>)) {
      <span class="hljs-keyword">return</span> mid
    }
    
    <span class="hljs-comment">// åœ¨åŒºé—´å·¦ä¾§</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">remainingTime</span> &lt; config.<span class="hljs-property">beginSec</span>) {
      right = mid - <span class="hljs-number">1</span>
    } 
    <span class="hljs-comment">// åœ¨åŒºé—´å³ä¾§</span>
    <span class="hljs-keyword">else</span> {
      left = mid + <span class="hljs-number">1</span>
    }
  }
  
  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
}
</code></pre>
<p><strong>ç®—æ³•åˆ†æï¼š</strong></p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(log n)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</li>
<li>é€‚ç”¨åœºæ™¯ï¼šé…ç½®æ•°é‡å¤šï¼ˆ&gt;10ä¸ªï¼‰ï¼Œä¸”å·²æ’åº</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong> éœ€è¦ç¡®ä¿é…ç½®æŒ‰æ—¶é—´æ’åºï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–æ—¶æ’åºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>) {
    <span class="hljs-comment">// æŒ‰å¼€å§‹æ—¶é—´æ’åº</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> 
      (a.<span class="hljs-property">beginSec</span> ?? <span class="hljs-number">0</span>) - (b.<span class="hljs-property">beginSec</span> ?? <span class="hljs-number">0</span>)
    )
  }
}
</code></pre>
<h4 data-id="heading-12">3. ç®—æ³•é€‰æ‹©å»ºè®®</h4>

























<table><thead><tr><th>é…ç½®æ•°é‡</th><th>æ¨èç®—æ³•</th><th>æ—¶é—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>&lt; 10ä¸ª</td><td>findIndex</td><td>O(n)</td></tr><tr><td>10-50ä¸ª</td><td>findIndexï¼ˆè¶³å¤Ÿå¿«ï¼‰</td><td>O(n)</td></tr><tr><td>&gt; 50ä¸ª</td><td>äºŒåˆ†æŸ¥æ‰¾</td><td>O(log n)</td></tr></tbody></table>
<p><strong>å½“å‰åœºæ™¯ï¼š</strong> é€šå¸¸é…ç½®æ•°é‡ &lt; 10ä¸ªï¼Œä½¿ç”¨ <code>findIndex</code> å³å¯ã€‚</p>
<h3 data-id="heading-13">ğŸ¨ æ ·å¼åˆ‡æ¢æœºåˆ¶</h3>
<h4 data-id="heading-14">1. åˆ‡æ¢æ—¶æœºæ§åˆ¶</h4>
<p>åªåœ¨æ ·å¼ç´¢å¼•çœŸæ­£å˜åŒ–æ—¶åˆ‡æ¢ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">decideHowToUpdateStyle</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> newIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getNewStyleIndex</span>()
  
  <span class="hljs-comment">// ä¼˜åŒ–ï¼šç´¢å¼•æ²¡å˜æ—¶ï¼Œä¸æ”¹å˜æ ·å¼</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> === newIndex || newIndex == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-comment">// é¿å…ä¸å¿…è¦çš„æ›´æ–°</span>
  }
  
  <span class="hljs-comment">// æ ·å¼ç´¢å¼•æœ‰å˜åŒ–ï¼Œæ›´æ–°æ ·å¼</span>
  <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'æ ·å¼ç´¢å¼•ï¼šä»'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> + <span class="hljs-string">'å˜ä¸ºï¼š'</span> + newIndex)
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateCustomStyle</span>(newIndex)
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">decideWhatToShow</span>()
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleIndex</span> = newIndex
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>æ¯”è¾ƒç´¢å¼•è€Œä¸æ˜¯å®Œæ•´å¯¹è±¡</li>
<li>æå‰è¿”å›ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—</li>
<li>æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘æ¸²æŸ“æ¬¡æ•°</li>
</ul>
<h4 data-id="heading-15">2. æ ·å¼æ›´æ–°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">updateCustomStyle</span>(<span class="hljs-params">newIndex: <span class="hljs-built_in">number</span></span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleConfig</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span>?.[newIndex]
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleType</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleConfig</span>?.<span class="hljs-property">showStyle</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activePre</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleConfig</span>?.<span class="hljs-property">prefixText</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeSuf</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleConfig</span>?.<span class="hljs-property">suffixText</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomizedText</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleConfig</span>?.<span class="hljs-property">text</span>
}
</code></pre>
<h4 data-id="heading-16">3. æ ¼å¼å†³å®š</h4>
<p>æ ¼å¼é€‰æ‹©é€»è¾‘æ²¿ç”¨ç¬¬2ç¯‡çš„è½»é‡ç­–ç•¥/è¡¨é©±åŠ¨æ–¹æ¡ˆdecideWhatToShowï¼Œè¯¦æƒ…å¯è§ã€Šè®¾è®¡æ¨¡å¼åæ€ç¯‡ã€‹</p>
<h3 data-id="heading-17">ğŸ”§ æ‰©å±•æ€§è®¾è®¡</h3>
<h4 data-id="heading-18">1. æ·»åŠ æ–°çš„æ ·å¼ç±»å‹</h4>
<p>å¦‚æœéœ€è¦æ·»åŠ æ–°çš„æ ·å¼ç±»å‹ï¼ˆå¦‚ç±»å‹4ï¼‰ï¼Œåªéœ€ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. æ‰©å±•æ ·å¼ç±»å‹å®šä¹‰</span>
<span class="hljs-comment">// showStyle: 4 è¡¨ç¤ºæ–°æ ·å¼</span>

<span class="hljs-comment">// 2. åœ¨ decideWhatToShow ä¸­æ·»åŠ å¤„ç†</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">occasions</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
  <span class="hljs-comment">// ... ç°æœ‰é…ç½®</span>
  <span class="hljs-string">'å¯ç”¨è‡ªå®šä¹‰4'</span>: <span class="hljs-string">'æ–°æ ·å¼æ ¼å¼'</span>,
}

<span class="hljs-comment">// 3. åœ¨ build ä¸­æ·»åŠ æ¸²æŸ“é€»è¾‘ï¼ˆå¦‚éœ€è¦ï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activeCustomStyleType</span> === <span class="hljs-number">4</span>) {
  <span class="hljs-comment">// æ–°æ ·å¼çš„æ¸²æŸ“é€»è¾‘</span>
}
</code></pre>
<h4 data-id="heading-19">2. é…ç½®ç³»ç»Ÿçš„æ‰©å±•æ¥å£</h4>
<p>å¯ä»¥è®¾è®¡é…ç½®ç³»ç»Ÿçš„æ‰©å±•æ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">StyleConfigExtension</span> {
  <span class="hljs-comment">// è‡ªå®šä¹‰æ ·å¼éªŒè¯</span>
  validate?(<span class="hljs-attr">config</span>: <span class="hljs-title class_">CustomStyle</span>): <span class="hljs-built_in">boolean</span>
  
  <span class="hljs-comment">// è‡ªå®šä¹‰æ ·å¼å¤„ç†</span>
  process?(<span class="hljs-attr">config</span>: <span class="hljs-title class_">CustomStyle</span>, <span class="hljs-attr">remainingTime</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span>
  
  <span class="hljs-comment">// è‡ªå®šä¹‰æ¸²æŸ“é€»è¾‘</span>
  render?(<span class="hljs-attr">config</span>: <span class="hljs-title class_">CustomStyle</span>): <span class="hljs-built_in">void</span>
}

<span class="hljs-comment">// ä½¿ç”¨æ‰©å±•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ExtendedCountdownView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">CountdownView</span> {
  <span class="hljs-keyword">private</span> styleExtension?: <span class="hljs-title class_">StyleConfigExtension</span>
  
  <span class="hljs-title function_">setStyleExtension</span>(<span class="hljs-params">extension: StyleConfigExtension</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">styleExtension</span> = extension
  }
  
  <span class="hljs-title function_">validateCustomStyleConfigs</span>(<span class="hljs-attr">configs</span>: <span class="hljs-title class_">CustomStyle</span>[]): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-comment">// å…ˆæ‰§è¡ŒåŸºç¡€éªŒè¯</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">super</span>.<span class="hljs-title function_">validateCustomStyleConfigs</span>(configs)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
    
    <span class="hljs-comment">// æ‰§è¡Œæ‰©å±•éªŒè¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">styleExtension</span>?.<span class="hljs-property">validate</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> config <span class="hljs-keyword">of</span> configs) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">styleExtension</span>.<span class="hljs-title function_">validate</span>(config)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }
}
</code></pre>
<h4 data-id="heading-20">3. é…ç½®çƒ­æ›´æ–°</h4>
<p>æ”¯æŒè¿è¡Œæ—¶æ›´æ–°é…ç½®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">updateCustomStyleConfigs</span>(<span class="hljs-params">newConfigs: CustomStyle[]</span>) {
  <span class="hljs-comment">// éªŒè¯æ–°é…ç½®</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateCustomStyleConfigs</span>(newConfigs)) {
    <span class="hljs-title class_">Logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'é…ç½®æ›´æ–°å¤±è´¥ï¼šé…ç½®éªŒè¯ä¸é€šè¿‡'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
  
  <span class="hljs-comment">// æ›´æ–°é…ç½®</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">customStyleConfigs</span> = newConfigs
  
  <span class="hljs-comment">// é‡æ–°è®¡ç®—å½“å‰æ ·å¼</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">decideHowToUpdateStyle</span>()
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<h3 data-id="heading-21">ğŸ¯ å®é™…åº”ç”¨æ¡ˆä¾‹</h3>
<h4 data-id="heading-22">æ¡ˆä¾‹1ï¼šç§’æ€å€’è®¡æ—¶</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">seckillConfig</span>: <span class="hljs-title class_">CustomStyle</span>[] = [
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">2</span>,        <span class="hljs-comment">// ä»…æ˜¾ç¤ºç§’</span>
    <span class="hljs-attr">prefixText</span>: <span class="hljs-string">'ä»…å‰©'</span>,
    <span class="hljs-attr">suffixText</span>: <span class="hljs-string">'ç§’'</span>,
    <span class="hljs-comment">// å¯ä»¥é…åˆçº¢è‰²æ ·å¼</span>
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">0</span>,        <span class="hljs-comment">// æ ‡å‡†æ ¼å¼</span>
    <span class="hljs-attr">prefixText</span>: <span class="hljs-string">'å‰©ä½™'</span>,
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-title class_">Infinity</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">1</span>,        <span class="hljs-comment">// å¤©+å°æ—¶</span>
  }
]
</code></pre>
<h4 data-id="heading-23">æ¡ˆä¾‹2ï¼šæ´»åŠ¨å€’è®¡æ—¶</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">activityConfig</span>: <span class="hljs-title class_">CustomStyle</span>[] = [
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">3</span>,        <span class="hljs-comment">// è‡ªå®šä¹‰æ–‡æœ¬</span>
    <span class="hljs-attr">text</span>: <span class="hljs-string">'å³å°†ç»“æŸ'</span>,
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-number">3600</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">0</span>,        <span class="hljs-comment">// æ ‡å‡†æ ¼å¼</span>
    <span class="hljs-attr">prefixText</span>: <span class="hljs-string">'å‰©ä½™'</span>,
  },
  {
    <span class="hljs-attr">beginSec</span>: <span class="hljs-number">3600</span>,
    <span class="hljs-attr">endSec</span>: <span class="hljs-title class_">Infinity</span>,
    <span class="hljs-attr">showStyle</span>: <span class="hljs-number">1</span>,        <span class="hljs-comment">// å¤©+å°æ—¶</span>
    <span class="hljs-attr">text</span>: <span class="hljs-string">'æ´»åŠ¨è¿›è¡Œä¸­'</span>,
  }
]
</code></pre>
<h3 data-id="heading-24">ğŸ’¡ æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-25">1. é…ç½®è®¾è®¡åŸåˆ™</h4>
<ul>
<li>âœ… <strong>æ—¶é—´åŒºé—´ä¸é‡å </strong>ï¼šé¿å…æ ·å¼å†²çª</li>
<li>âœ… <strong>è¾¹ç•Œå¤„ç†æ¸…æ™°</strong>ï¼šæ˜ç¡®åŒ…å«/æ’é™¤è¾¹ç•Œ</li>
<li>âœ… <strong>é»˜è®¤æ ·å¼å…œåº•</strong>ï¼šä¸åœ¨ä»»ä½•åŒºé—´æ—¶ä½¿ç”¨é»˜è®¤æ ·å¼</li>
<li>âœ… <strong>é…ç½®éªŒè¯å®Œå–„</strong>ï¼šç¡®ä¿é…ç½®æ­£ç¡®æ€§</li>
</ul>
<h4 data-id="heading-26">2. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h4>
<ul>
<li>âœ… <strong>æå‰è¿”å›</strong>ï¼šæ ·å¼ç´¢å¼•æ²¡å˜æ—¶ä¸æ›´æ–°</li>
<li>âœ… <strong>æ‰¹é‡æ›´æ–°</strong>ï¼šä¸€æ¬¡æ€§æ›´æ–°æ‰€æœ‰ç›¸å…³çŠ¶æ€</li>
<li>âœ… <strong>ç®—æ³•é€‰æ‹©</strong>ï¼šæ ¹æ®é…ç½®æ•°é‡é€‰æ‹©åˆé€‚ç®—æ³•</li>
<li>âŒ <strong>é¿å…é¢‘ç¹åˆ‡æ¢</strong>ï¼šåˆç†è®¾è®¡æ—¶é—´åŒºé—´</li>
</ul>
<h4 data-id="heading-27">3. æ‰©å±•æ€§å»ºè®®</h4>
<ul>
<li>âœ… <strong>æ¥å£è®¾è®¡æ¸…æ™°</strong>ï¼šä¾¿äºæ‰©å±•æ–°æ ·å¼ç±»å‹</li>
<li>âœ… <strong>é…ç½®ç»“æ„çµæ´»</strong>ï¼šæ”¯æŒæœªæ¥éœ€æ±‚å˜åŒ–</li>
<li>âœ… <strong>çƒ­æ›´æ–°æ”¯æŒ</strong>ï¼šæ”¯æŒè¿è¡Œæ—¶æ›´æ–°é…ç½®</li>
<li>âŒ <strong>é¿å…è¿‡åº¦è®¾è®¡</strong>ï¼šä¸è¦ä¸ºäº†æ‰©å±•è€Œæ‰©å±•</li>
</ul>
<h3 data-id="heading-28">ğŸ“ æ€»ç»“</h3>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨äº†æ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢çš„åŠ¨æ€é…ç½®ç³»ç»Ÿï¼š</p>
<ol>
<li><strong>é…ç½®ç³»ç»Ÿè®¾è®¡</strong>ï¼šçµæ´»çš„æ•°æ®ç»“æ„å’ŒéªŒè¯æœºåˆ¶</li>
<li><strong>åŒºé—´æŸ¥æ‰¾ç®—æ³•</strong>ï¼šfindIndex vs äºŒåˆ†æŸ¥æ‰¾</li>
<li><strong>æ ·å¼åˆ‡æ¢æœºåˆ¶</strong>ï¼šä¼˜åŒ–åˆ‡æ¢æ—¶æœºï¼Œå‡å°‘ä¸å¿…è¦çš„æ›´æ–°</li>
<li><strong>æ‰©å±•æ€§è®¾è®¡</strong>ï¼šæ”¯æŒæ–°æ ·å¼ç±»å‹å’Œé…ç½®çƒ­æ›´æ–°</li>
</ol>
<p><strong>å…³é”®è¦ç‚¹ï¼š</strong></p>
<ul>
<li>é…ç½®éªŒè¯ç¡®ä¿æ­£ç¡®æ€§</li>
<li>ç®—æ³•é€‰æ‹©æ ¹æ®é…ç½®æ•°é‡</li>
<li>æ ·å¼åˆ‡æ¢ä¼˜åŒ–æ€§èƒ½</li>
<li>æ‰©å±•æ€§è®¾è®¡é¢å‘æœªæ¥</li>
</ul>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å·¥ç¨‹å®è·µï¼šæµ‹è¯•ä¸è´¨é‡ä¿è¯ã€‚</p>
<hr/>
<p><strong>ç³»åˆ—æ–‡ç« å¯¼èˆªï¼š</strong></p>
<ul>
<li>[ç¬¬1ç¯‡] åŸºç¡€ç¯‡ï¼šä»éœ€æ±‚åˆ†æåˆ°åŸºç¡€å®ç°</li>
<li>[ç¬¬2ç¯‡] è®¾è®¡æ¨¡å¼åæ€ç¯‡ï¼šå½“AIå»ºè®®ç”¨ç­–ç•¥æ¨¡å¼æ—¶ï¼Œæˆ‘é€‰æ‹©äº†è´¨ç–‘</li>
<li>[ç¬¬3ç¯‡] è®¾è®¡æ¨¡å¼å®è·µç¯‡ï¼šæ ‡å¿—ä½é©±åŠ¨æ¸²æŸ“ä¸çŠ¶æ€æœºæ¨¡å¼</li>
<li>[ç¬¬4ç¯‡] æ€§èƒ½ä¼˜åŒ–ç¯‡ï¼šä»100msåˆ·æ–°åˆ°æµç•…ä½“éªŒ</li>
<li>[ç¬¬5ç¯‡] é«˜çº§ç‰¹æ€§ç¯‡ï¼šæ—¶é—´åŒºé—´æ ·å¼åˆ‡æ¢ï¼ˆæœ¬æ–‡ï¼‰</li>
<li>[ç¬¬6ç¯‡] å·¥ç¨‹å®è·µç¯‡ï¼šæµ‹è¯•ä¸è´¨é‡ä¿è¯</li>
<li>[ç¬¬7ç¯‡] æ€»ç»“ç¯‡ï¼šæœ€ä½³å®è·µä¸æ€è€ƒ</li>
</ul>
<p><strong>è®¨è®ºï¼š</strong>
ä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦‚ä½•è®¾è®¡é…ç½®ç³»ç»Ÿçš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585693761532182562</link>    <guid>https://juejin.cn/post/7585693761532182562</guid>    <pubDate>2025-12-21T05:19:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585693761532182562" data-draft-id="7585706951603896346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,JavaScript"/> <meta itemprop="datePublished" content="2025-12-21T05:19:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T05:19:37.000Z" title="Sun Dec 21 2025 05:19:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">Vue3æ¡ä»¶æ¸²æŸ“æŒ‡ä»¤ï¼šv-showâ€”â€”åŸºäºCSSçš„æ¡ä»¶æ˜¾ç¤ºä¸åˆ‡æ¢</h3>
<h4 data-id="heading-1">ä¸€ã€v-showæ˜¯ä»€ä¹ˆï¼Ÿå’Œv-ifæœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼Ÿ</h4>
<p>ä½œä¸ºVue3ä¸­æœ€å¸¸ç”¨çš„æ¡ä»¶æ¸²æŸ“æŒ‡ä»¤ä¹‹ä¸€ï¼Œv-showçš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>æ ¹æ®è¡¨è¾¾å¼çš„çœŸå‡ï¼Œåˆ‡æ¢å…ƒç´ çš„â€œè§†è§‰æ˜¾ç¤ºçŠ¶æ€â€</strong>â€”â€”æ³¨æ„ï¼Œæ˜¯â€œè§†è§‰ä¸Šâ€çš„ï¼Œä¸æ˜¯â€œå­˜åœ¨ä¸å¦â€çš„ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ‹¿å®ƒå’Œå¦ä¸€ä¸ªå¸¸è§æŒ‡ä»¤v-ifåšä¸ªç®€å•å¯¹æ¯”ï¼š</p>
<ul>
<li><strong>v-if</strong>ï¼šé€šè¿‡â€œé”€æ¯/é‡å»ºDOMå…ƒç´ â€å®ç°æ¡ä»¶æ˜¾ç¤ºï¼ˆè¡¨è¾¾å¼ä¸ºå‡æ—¶ï¼Œå…ƒç´ ä»DOMæ ‘ä¸­ç§»é™¤ï¼›ä¸ºçœŸæ—¶é‡æ–°åˆ›å»ºï¼‰ï¼›</li>
<li><strong>v-show</strong>ï¼šé€šè¿‡â€œä¿®æ”¹CSSçš„displayå±æ€§â€å®ç°æ¡ä»¶æ˜¾ç¤ºï¼ˆå…ƒç´ å§‹ç»ˆåœ¨DOMæ ‘ä¸­ï¼Œåªæ˜¯ç”¨<code>display: none</code>éšè—ï¼‰ã€‚</li>
</ul>
<p>ä¸¾ä¸ªç”Ÿæ´»ä¾‹å­ï¼šå¦‚æœæŠŠDOMæ¯”ä½œè¡£æŸœï¼Œv-ifæ˜¯â€œæŠŠè¡£æœæ‹¿å‡ºè¡£æŸœ/æ”¾è¿›è¡£æŸœâ€ï¼Œv-showæ˜¯â€œæŠŠè¡£æœç”¨å¸ƒç›–èµ·æ¥/æ€å¼€å¸ƒâ€â€”â€”è¡£æœå§‹ç»ˆåœ¨è¡£æŸœé‡Œï¼Œåªæ˜¯çœ‹ä¸çœ‹å¾—åˆ°çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-2">äºŒã€v-showçš„å·¥ä½œåŸç†ï¼šä¸€å¥è¯è®²æ¸…æ¥š</h4>
<p>v-showçš„åº•å±‚é€»è¾‘éå¸¸ç›´ç™½ï¼š</p>
<ol>
<li>å½“ç»‘å®šçš„è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚<code>isShow</code>ï¼‰ä¸º<strong>çœŸ</strong>æ—¶ï¼ŒVueä¼šæŠŠå…ƒç´ çš„<code>display</code>å±æ€§æ¢å¤ä¸ºå®ƒçš„<strong>é»˜è®¤å€¼</strong>ï¼ˆæ¯”å¦‚<code>div</code>é»˜è®¤æ˜¯<code>block</code>ï¼Œ<code>span</code>é»˜è®¤æ˜¯<code>inline</code>ï¼‰ï¼›</li>
<li>å½“è¡¨è¾¾å¼ä¸º<strong>å‡</strong>æ—¶ï¼ŒVueå¼ºåˆ¶æŠŠå…ƒç´ çš„<code>display</code>è®¾ä¸º<code>none</code>ï¼Œè®©å…ƒç´ â€œæ¶ˆå¤±â€ã€‚</li>
</ol>
<p>å…³é”®ç»“è®ºï¼š<strong>v-showçš„å…ƒç´ æ°¸è¿œä¸ä¼šç¦»å¼€DOMæ ‘ï¼Œåªæ˜¯â€œè—èµ·æ¥â€äº†</strong>ã€‚</p>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F8a1ddfac64b25062ac56403e4c1201d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/8a1ddfac64b25062ac56403e4c1201d2/" ref="nofollow noopener noreferrer">Vue3æ¡ä»¶æ¸²æŸ“ä¸­v-ifç³»åˆ—æŒ‡ä»¤å¦‚ä½•åˆç†ä½¿ç”¨ä¸è§„é¿é”™è¯¯ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F218c3a59282c3b757447ee08a01937bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/218c3a59282c3b757447ee08a01937bb/" ref="nofollow noopener noreferrer">Vue3åŠ¨æ€æ ·å¼æ§åˆ¶ï¼šrefã€reactiveã€watchä¸computedçš„åº”ç”¨åœºæ™¯ä¸åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1bab953e41f66ac53de099fa9fe76483%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1bab953e41f66ac53de099fa9fe76483/" ref="nofollow noopener noreferrer">Vue3ä¸­åŠ¨æ€æ ·å¼æ•°ç»„çš„åé¡¹è¦†ç›–è§„åˆ™å¦‚ä½•ä¸è®¡ç®—å±æ€§ç»“åˆå®ç°å¤æ‚çŠ¶æ€æ ·å¼ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<h4 data-id="heading-3">ä¸‰ã€v-showçš„æœ€ä½³åº”ç”¨åœºæ™¯</h4>
<p>å› ä¸ºv-showä¸éœ€è¦é¢‘ç¹æ“ä½œDOMï¼ˆåªæ˜¯æ”¹CSSï¼‰ï¼Œæ‰€ä»¥å®ƒçš„<strong>åˆ‡æ¢æˆæœ¬æä½</strong>â€”â€”é€‚åˆç”¨æ¥å¤„ç†â€œéœ€è¦é¢‘ç¹æ˜¾ç¤º/éšè—â€çš„å…ƒç´ ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>å¯¼èˆªèœå•çš„å±•å¼€/æ”¶èµ·ï¼›</li>
<li>Tabåˆ‡æ¢çš„å†…å®¹é¢æ¿ï¼›</li>
<li>å¼¹çª—çš„æ˜¾ç¤º/éšè—ï¼›</li>
<li>è¡¨å•çš„é”™è¯¯æç¤ºï¼ˆé¢‘ç¹åˆ‡æ¢æ˜¾ç¤ºï¼‰ã€‚</li>
</ul>
<p>åè¿‡æ¥è¯´ï¼Œå¦‚æœå…ƒç´ çš„æ˜¾ç¤ºçŠ¶æ€<strong>å¾ˆå°‘æ”¹å˜</strong>ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒé™åˆ¤æ–­ï¼šç®¡ç†å‘˜æ‰èƒ½çœ‹çš„æŒ‰é’®ï¼‰ï¼Œé‚£ç”¨v-ifæ›´åˆé€‚â€”â€”å› ä¸ºv-ifä¼šç›´æ¥ä¸æ¸²æŸ“ä¸éœ€è¦çš„å…ƒç´ ï¼ŒèŠ‚çœåˆå§‹æ¸²æŸ“æˆæœ¬ã€‚</p>
<h4 data-id="heading-4">å››ã€å®æˆ˜ç¤ºä¾‹ï¼šç”¨v-showåšä¸€ä¸ªâ€œå¼€å…³â€ç»„ä»¶</h4>
<p>æˆ‘ä»¬æ¥å†™ä¸€ä¸ªæœ€ç®€å•çš„Demoï¼šç‚¹å‡»æŒ‰é’®åˆ‡æ¢ä¸€æ®µæ–‡æœ¬çš„æ˜¾ç¤ºçŠ¶æ€ã€‚ä»£ç ç”¨Vue3çš„<code>&lt;script setup&gt;</code>è¯­æ³•ç³–ï¼ˆæœ€å¸¸ç”¨çš„å†™æ³•ï¼‰ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="v-show-demo"&gt;
    &lt;!-- ç‚¹å‡»æŒ‰é’®è§¦å‘toggleShowæ–¹æ³• --&gt;
    &lt;button @click="toggleShow" class="toggle-btn"&gt;
      {{ isShow ? 'éšè—æ–‡æœ¬' : 'æ˜¾ç¤ºæ–‡æœ¬' }}
    &lt;/button&gt;
    &lt;!-- ç”¨v-showç»‘å®šisShowå˜é‡ --&gt;
    &lt;p v-show="isShow" class="text-content"&gt;
      æˆ‘æ˜¯è¢«v-showæ§åˆ¶çš„æ–‡æœ¬~ ç‚¹æŒ‰é’®è¯•è¯•ï¼
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// 1. å¼•å…¥Vueçš„refå‡½æ•°ï¼ˆç”¨æ¥åˆ›å»ºå“åº”å¼å˜é‡ï¼‰
import { ref } from 'vue'

// 2. å®šä¹‰å“åº”å¼å˜é‡isShowï¼Œåˆå§‹å€¼ä¸ºtrueï¼ˆæ–‡æœ¬é»˜è®¤æ˜¾ç¤ºï¼‰
const isShow = ref(true)

// 3. å®šä¹‰åˆ‡æ¢å‡½æ•°ï¼šåè½¬isShowçš„å€¼
const toggleShow = () =&gt; {
  isShow.value = !isShow.value
}
&lt;/script&gt;

&lt;style scoped&gt;
.v-show-demo {
  padding: 20px;
  max-width: 300px;
  margin: 0 auto;
}
.toggle-btn {
  padding: 8px 16px;
  background: #42b983;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
.text-content {
  margin-top: 10px;
  padding: 15px;
  background: #f5f5f5;
  border-radius: 4px;
}
&lt;/style&gt;
</code></pre>
<p><strong>ä»£ç è§£é‡Š</strong>ï¼š</p>
<ol>
<li><code>ref(true)</code>ï¼šåˆ›å»ºä¸€ä¸ªå“åº”å¼å˜é‡<code>isShow</code>ï¼Œåˆå§‹å€¼ä¸º<code>true</code>ï¼ˆæ–‡æœ¬é»˜è®¤æ˜¾ç¤ºï¼‰ï¼›</li>
<li><code>@click="toggleShow"</code>ï¼šç‚¹å‡»æŒ‰é’®è§¦å‘<code>toggleShow</code>æ–¹æ³•ï¼Œåè½¬<code>isShow</code>çš„å€¼ï¼›</li>
<li><code>v-show="isShow"</code>ï¼šå½“<code>isShow</code>ä¸º<code>true</code>æ—¶ï¼Œæ–‡æœ¬æ˜¾ç¤ºï¼›ä¸º<code>false</code>æ—¶ï¼Œæ–‡æœ¬éšè—ï¼ˆ<code>display: none</code>ï¼‰ã€‚</li>
</ol>
<p>è¿è¡Œè¿™ä¸ªç»„ä»¶ï¼Œä½ ä¼šçœ‹åˆ°ï¼šç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ–‡æœ¬ä¼šâ€œç¬é—´â€æ˜¾ç¤º/éšè—â€”â€”å› ä¸ºåªæ˜¯æ”¹äº†CSSï¼Œæ²¡æœ‰DOMæ“ä½œï¼Œæ‰€ä»¥åˆ‡æ¢éå¸¸æµç•…ï¼</p>
<h4 data-id="heading-5">äº”ã€è¯¾åQuizï¼šæµ‹æµ‹ä½ æŒæ¡äº†å—ï¼Ÿ</h4>
<p><strong>é—®é¢˜</strong>ï¼šè¯·è¯´å‡ºv-showå’Œv-ifçš„3ä¸ªæ ¸å¿ƒåŒºåˆ«ï¼Œå¹¶åˆ†åˆ«ä¸¾ä¸€ä¸ªé€‚åˆçš„åº”ç”¨åœºæ™¯ã€‚</p>
<p><strong>ç­”æ¡ˆè§£æ</strong>ï¼š</p>
<ol>
<li><strong>æ¸²æŸ“æœºåˆ¶ä¸åŒ</strong>ï¼šv-showæ˜¯ä¿®æ”¹CSSçš„displayå±æ€§ï¼ˆå…ƒç´ å§‹ç»ˆåœ¨DOMä¸­ï¼‰ï¼›v-ifæ˜¯é”€æ¯/é‡å»ºDOMå…ƒç´ ï¼ˆå…ƒç´ å¯èƒ½ä¸åœ¨DOMä¸­ï¼‰ã€‚</li>
<li><strong>åˆ‡æ¢æˆæœ¬ä¸åŒ</strong>ï¼šv-showåˆ‡æ¢æˆæœ¬ä½ï¼ˆæ”¹CSSï¼‰ï¼Œé€‚åˆé¢‘ç¹åˆ‡æ¢ï¼›v-ifåˆ‡æ¢æˆæœ¬é«˜ï¼ˆæ“ä½œDOMï¼‰ï¼Œé€‚åˆå¾ˆå°‘åˆ‡æ¢çš„åœºæ™¯ã€‚</li>
<li><strong>åˆå§‹æ¸²æŸ“æˆæœ¬ä¸åŒ</strong>ï¼šv-showåˆå§‹ä¼šæ¸²æŸ“æ‰€æœ‰å…ƒç´ ï¼ˆä¸ç®¡æ¡ä»¶çœŸå‡ï¼‰ï¼Œåˆå§‹æˆæœ¬é«˜ï¼›v-ifåªæ¸²æŸ“æ¡ä»¶ä¸ºçœŸçš„å…ƒç´ ï¼Œåˆå§‹æˆæœ¬ä½ã€‚</li>
</ol>
<p><strong>åº”ç”¨åœºæ™¯ä¸¾ä¾‹</strong>ï¼š</p>
<ul>
<li>v-showï¼šå¯¼èˆªèœå•çš„å±•å¼€/æ”¶èµ·ï¼ˆé¢‘ç¹åˆ‡æ¢ï¼‰ï¼›</li>
<li>v-ifï¼šç®¡ç†å‘˜ä¸“å±æŒ‰é’®ï¼ˆåªæœ‰ç®¡ç†å‘˜ç™»å½•æ—¶æ‰æ¸²æŸ“ï¼Œå¾ˆå°‘åˆ‡æ¢ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">å…­ã€å¸¸è§æŠ¥é”™åŠè§£å†³æ–¹æ¡ˆ</h4>
<p>åœ¨ä½¿ç”¨v-showæ—¶ï¼Œæ–°æ‰‹å¸¸é‡åˆ°è¿™3ä¸ªé—®é¢˜ï¼Œå¸®ä½ æå‰é¿å‘ï¼š</p>
<h5 data-id="heading-7">1. æŠ¥é”™ï¼šv-showç»‘å®šçš„å˜é‡â€œisShowâ€æœªå®šä¹‰</h5>
<p><strong>åŸå› </strong>ï¼šæ²¡æœ‰åœ¨<code>&lt;script&gt;</code>ä¸­å£°æ˜<code>isShow</code>å˜é‡ï¼Œæˆ–è€…å£°æ˜äº†ä½†ä¸æ˜¯å“åº”å¼çš„ã€‚<br/>
<strong>è§£å†³</strong>ï¼šç”¨<code>ref</code>æˆ–<code>reactive</code>å®šä¹‰å“åº”å¼å˜é‡ï¼ˆå¿…é¡»ä»Vueä¸­å¼•å…¥ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> isShow = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>) <span class="hljs-comment">// æ­£ç¡®</span>
</code></pre>
<p><strong>é¢„é˜²</strong>ï¼šæ‰€æœ‰ç»‘å®šåˆ°æ¨¡æ¿çš„å˜é‡ï¼Œéƒ½è¦å…ˆå£°æ˜ä¸ºå“åº”å¼å˜é‡ã€‚</p>
<h5 data-id="heading-8">2. æŠ¥é”™ï¼šv-showç”¨åœ¨<code>&lt;template&gt;</code>æ ‡ç­¾ä¸Šæ— æ•ˆ</h5>
<p><strong>åŸå› </strong>ï¼š<code>&lt;template&gt;</code>æ˜¯Vueçš„â€œè™šæ‹Ÿå®¹å™¨â€ï¼Œä¸ä¼šè¢«æ¸²æŸ“æˆçœŸå®DOMå…ƒç´ â€”â€”è€Œv-showéœ€è¦ä½œç”¨äº<strong>çœŸå®DOMå…ƒç´ </strong>ï¼ˆæ¯”å¦‚<code>div</code>ã€<code>p</code>ï¼‰ã€‚<br/>
<strong>è§£å†³</strong>ï¼šæŠŠv-showç§»åˆ°å…·ä½“çš„HTMLå…ƒç´ ä¸Šï¼Œæˆ–è€…ç”¨v-ifä»£æ›¿ï¼ˆv-ifå¯ä»¥ç”¨åœ¨<code>&lt;template&gt;</code>ä¸Šï¼‰ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- é”™è¯¯ï¼štemplateä¸Šç”¨v-show --&gt;
&lt;template v-show="isShow"&gt;...&lt;/template&gt;

&lt;!-- æ­£ç¡®ï¼šç”¨åœ¨divä¸Š --&gt;
&lt;div v-show="isShow"&gt;...&lt;/div&gt;

&lt;!-- æˆ–è€…ç”¨v-ifåœ¨templateä¸Š --&gt;
&lt;template v-if="isShow"&gt;...&lt;/template&gt;
</code></pre>
<p><strong>é¢„é˜²</strong>ï¼šæ°¸è¿œä¸è¦åœ¨<code>&lt;template&gt;</code>æ ‡ç­¾ä¸Šç”¨v-showã€‚</p>
<h5 data-id="heading-9">3. é—®é¢˜ï¼šv-showéšè—çš„å…ƒç´ è¿˜å ç©ºé—´ï¼Ÿ</h5>
<p><strong>åŸå› </strong>ï¼šä½ å¯èƒ½æ··æ·†äº†<code>display: none</code>å’Œ<code>visibility: hidden</code>â€”â€”<code>display: none</code>ä¼šè®©å…ƒç´ å®Œå…¨ä¸å ç©ºé—´ï¼Œè€Œ<code>visibility: hidden</code>ä¼šä¿ç•™ç©ºé—´ã€‚å¦‚æœå…ƒç´ éšè—åè¿˜å ç©ºé—´ï¼Œå¤§æ¦‚ç‡æ˜¯<strong>è‡ªå·±åŠ äº†<code>visibility</code>æ ·å¼</strong>ï¼Œæˆ–è€…å…ƒç´ çš„çˆ¶çº§æœ‰å›ºå®šé«˜åº¦ã€‚<br/>
<strong>è§£å†³</strong>ï¼šæ£€æŸ¥å…ƒç´ çš„CSSï¼Œç¡®ä¿æ²¡æœ‰<code>visibility: hidden</code>æˆ–<code>opacity: 0</code>çš„æ ·å¼ï¼ˆè¿™äº›ä¼šä¿ç•™ç©ºé—´ï¼‰ï¼›ç”¨æµè§ˆå™¨çš„â€œæ£€æŸ¥å…ƒç´ â€çœ‹ä¸€ä¸‹å…ƒç´ çš„<code>display</code>å±æ€§æ˜¯ä¸æ˜¯<code>none</code>ã€‚</p>
<h4 data-id="heading-10">å‚è€ƒé“¾æ¥</h4>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fconditional.html%23v-show" target="_blank" title="https://vuejs.org/guide/essentials/conditional.html#v-show" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript ä¸­ this çš„è®¾è®¡å“²å­¦ä¸è¿è¡Œæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7585686247286128691</link>    <guid>https://juejin.cn/post/7585686247286128691</guid>    <pubDate>2025-12-21T06:30:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585686247286128691" data-draft-id="7585645111875420187" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript ä¸­ this çš„è®¾è®¡å“²å­¦ä¸è¿è¡Œæœºåˆ¶"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-21T06:30:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Zyx2007"/> <meta itemprop="url" content="https://juejin.cn/user/3924597867554890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript ä¸­ this çš„è®¾è®¡å“²å­¦ä¸è¿è¡Œæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3924597867554890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Zyx2007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T06:30:42.000Z" title="Sun Dec 21 2025 06:30:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ JavaScript çš„ä¸–ç•Œé‡Œï¼Œ<code>this</code> æ˜¯ä¸€ä¸ªæ—¢åŸºç¡€åˆä»¤äººå›°æƒ‘çš„æ¦‚å¿µã€‚å®ƒä¸åƒå…¶ä»–è¯­è¨€ä¸­çš„ <code>this</code> é‚£æ ·å›ºå®šæŒ‡å‘å½“å‰å¯¹è±¡å®ä¾‹ï¼Œè€Œæ˜¯æ ¹æ®å‡½æ•°çš„<strong>è°ƒç”¨æ–¹å¼</strong>åŠ¨æ€å†³å®šå…¶æŒ‡å‘ã€‚è¿™ç§çµæ´»æ€§èµ‹äºˆäº† JavaScript å¼ºå¤§çš„è¡¨è¾¾èƒ½åŠ›ï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä¸å°‘é™·é˜±ã€‚ç†è§£ <code>this</code> çš„è¡Œä¸ºé€»è¾‘ï¼Œæ˜¯æŒæ¡ JavaScript æ‰§è¡Œæœºåˆ¶çš„å…³é”®ä¸€æ­¥ã€‚</p>
<h2 data-id="heading-0">ä½œç”¨åŸŸä¸ thisï¼šä¸¤ç§ä¸åŒçš„æŸ¥æ‰¾æœºåˆ¶</h2>
<p>JavaScript ä¸­å˜é‡çš„æŸ¥æ‰¾ä¾èµ–äº<strong>è¯æ³•ä½œç”¨åŸŸï¼ˆLexical Scopeï¼‰</strong> ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä¸€ä¸ªå‡½æ•°å†…éƒ¨å¼•ç”¨æŸä¸ªå˜é‡æ—¶ï¼Œå¼•æ“ä¼šæ²¿ç€è¯¥å‡½æ•°å£°æ˜æ—¶æ‰€å¤„çš„ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å˜é‡æˆ–åˆ°è¾¾å…¨å±€ä½œç”¨åŸŸã€‚è¿™ç§æœºåˆ¶åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç¡®å®šï¼Œä¸å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨æ— å…³ã€‚</p>
<p>ç„¶è€Œï¼Œ<code>this</code> å´æ˜¯ä¸€ä¸ªä¾‹å¤–ã€‚å®ƒçš„å€¼<strong>ä¸æ˜¯ç”±å‡½æ•°å®šä¹‰çš„ä½ç½®å†³å®šçš„ï¼Œè€Œæ˜¯ç”±å‡½æ•°è°ƒç”¨çš„æ–¹å¼å†³å®šçš„</strong>ã€‚æ¢å¥è¯è¯´ï¼Œ<code>this</code> å±äº<strong>æ‰§è¡Œä¸Šä¸‹æ–‡</strong>çš„ä¸€éƒ¨åˆ†ï¼Œåªæœ‰åœ¨å‡½æ•°çœŸæ­£è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå…¶æŒ‡å‘ã€‚è¿™ç§è®¾è®¡ä½¿å¾— <code>this</code> å…·æœ‰é«˜åº¦çš„åŠ¨æ€æ€§ï¼Œä½†ä¹Ÿæ‰“ç ´äº†è¯æ³•ä½œç”¨åŸŸçš„ä¸€è‡´æ€§ï¼Œæˆä¸ºåˆå­¦è€…æœ€å®¹æ˜“æ··æ·†çš„ç‚¹ä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-1">this çš„å››ç§å…¸å‹æŒ‡å‘åœºæ™¯</h2>
<h3 data-id="heading-2">1. ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼šæŒ‡å‘æ‰€å±å¯¹è±¡</h3>
<p>å½“ä¸€ä¸ªå‡½æ•°ä½œä¸ºå¯¹è±¡çš„å±æ€§è¢«è°ƒç”¨æ—¶ï¼Œ<code>this</code> æŒ‡å‘è¯¥å¯¹è±¡æœ¬èº«ã€‚è¿™æ˜¯æœ€ç¬¦åˆç›´è§‰çš„ç”¨æ³•ï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­è®¿é—®å®ä¾‹å±æ€§çš„æ ‡å‡†æ–¹å¼ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myObj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æå®¢æ—¶é—´"</span>,
  <span class="hljs-attr">showThis</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// "æå®¢æ—¶é—´"</span>
  }
};
myObj.<span class="hljs-title function_">showThis</span>(); <span class="hljs-comment">// this æŒ‡å‘ myObj</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>showThis</code> æ˜¯ <code>myObj</code> çš„æ–¹æ³•ï¼Œè°ƒç”¨æ—¶ <code>this</code> è‡ªç„¶æŒ‡å‘ <code>myObj</code>ï¼Œä»è€Œå¯ä»¥æ­£ç¡®è®¿é—®å…¶ <code>name</code> å±æ€§ã€‚</p>
<h3 data-id="heading-3">2. ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ï¼šæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæˆ– undefinedï¼‰</h3>
<p>å¦‚æœå°†åŒä¸€ä¸ªå‡½æ•°ä»å¯¹è±¡ä¸­â€œå–å‡ºâ€å¹¶ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ï¼Œ<code>this</code> çš„æŒ‡å‘å°±ä¼šå‘ç”Ÿæ ¹æœ¬å˜åŒ–ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">foo</span> = myObj.showThis<span class="hljs-comment">;</span>
foo()<span class="hljs-comment">; // this æŒ‡å‘ windowï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰æˆ– undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰</span>
</code></pre>
<p>æ­¤æ—¶ï¼Œ<code>foo</code> ä¸å†æ˜¯ä½œä¸ºå¯¹è±¡æ–¹æ³•è¢«è°ƒç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ã€‚åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒJavaScript ä¼šå°† <code>this</code> é»˜è®¤ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­ä¸º <code>window</code>ï¼‰ï¼›è€Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™ç›´æ¥è®¾ä¸º <code>undefined</code>ï¼Œé¿å…æ„å¤–æ±¡æŸ“å…¨å±€ç¯å¢ƒã€‚</p>
<p>è¿™ç§è¡Œä¸ºæºäºæ—©æœŸ JavaScript çš„è®¾è®¡å¦¥åï¼šä¸ºäº†ç®€åŒ–å®ç°ï¼Œä½œè€…è®©æ‰€æœ‰æœªæ˜ç¡®ç»‘å®šçš„å‡½æ•°é»˜è®¤æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚è™½ç„¶æ–¹ä¾¿ï¼Œå´å®¹æ˜“å¯¼è‡´å…¨å±€å˜é‡æ±¡æŸ“â€”â€”å°¤å…¶æ˜¯ä½¿ç”¨ <code>var</code> å£°æ˜çš„å˜é‡ä¼šè‡ªåŠ¨æŒ‚è½½åˆ° <code>window</code> ä¸Šã€‚ç°ä»£å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨ <code>let/const</code> å’Œä¸¥æ ¼æ¨¡å¼æ¥è§„é¿æ­¤ç±»é—®é¢˜ã€‚</p>
<h3 data-id="heading-4">3. æ˜¾å¼ç»‘å®šï¼šcallã€apply ä¸ bind</h3>
<p>JavaScript æä¾›äº† <code>call</code>ã€<code>apply</code> å’Œ <code>bind</code> æ–¹æ³•ï¼Œå…è®¸å¼€å‘è€…<strong>æ˜¾å¼æŒ‡å®šå‡½æ•°è°ƒç”¨æ—¶çš„ <code>this</code> å€¼</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function updateName() {
  <span class="hljs-attr">this.myName</span> = <span class="hljs-string">"æå®¢æ—¶é—´"</span><span class="hljs-comment">;</span>
}

const <span class="hljs-attr">bar</span> = { myName: <span class="hljs-string">"æå®¢é‚¦"</span> }<span class="hljs-comment">;</span>
updateName.call(bar)<span class="hljs-comment">;</span>
console.log(bar.myName)<span class="hljs-comment">; // "æå®¢æ—¶é—´"</span>
</code></pre>
<p>é€šè¿‡ <code>call(bar)</code>ï¼Œæˆ‘ä»¬å¼ºåˆ¶è®© <code>updateName</code> å‡½æ•°åœ¨æ‰§è¡Œæ—¶å°† <code>this</code> ç»‘å®šåˆ° <code>bar</code> å¯¹è±¡ä¸Šï¼Œä»è€ŒæˆåŠŸä¿®æ”¹å…¶å±æ€§ã€‚è¿™ç§æ–¹å¼å¸¸ç”¨äºå€Ÿç”¨æ–¹æ³•ã€å®ç°ç»§æ‰¿æˆ–åœ¨å›è°ƒä¸­ä¿æŒä¸Šä¸‹æ–‡ã€‚</p>
<h3 data-id="heading-5">4. æ„é€ å‡½æ•°è°ƒç”¨ï¼šæŒ‡å‘æ–°åˆ›å»ºçš„å®ä¾‹</h3>
<p>å½“å‡½æ•°é€šè¿‡ <code>new</code> å…³é”®å­—è°ƒç”¨æ—¶ï¼ŒJavaScript ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°† <code>this</code> ç»‘å®šåˆ°è¯¥å¯¹è±¡ä¸Šï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function CreateObj() {
  <span class="hljs-attr">this.name</span> = <span class="hljs-string">"æ–°å®ä¾‹"</span><span class="hljs-comment">;</span>
}
const <span class="hljs-attr">obj</span> = new CreateObj()<span class="hljs-comment">;</span>
console.log(obj.name)<span class="hljs-comment">; // "æ–°å®ä¾‹"</span>
</code></pre>
<p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œ<code>this</code> æŒ‡å‘ç”±æ„é€ å‡½æ•°ç”Ÿæˆçš„æ–°å®ä¾‹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨æ„é€ å‡½æ•°å†…éƒ¨åˆå§‹åŒ–å®ä¾‹å±æ€§ã€‚è¿™ä¹Ÿæ˜¯æ—©æœŸ JavaScript å®ç°â€œç±»â€è¯­ä¹‰çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<h2 data-id="heading-6">äº‹ä»¶å¤„ç†ä¸­çš„ this</h2>
<p>åœ¨ DOM äº‹ä»¶å¤„ç†ä¸­ï¼Œ<code>this</code> é€šå¸¸æŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"btn"</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æŒ‡å‘ #btn å…ƒç´ </span>
});
</code></pre>
<p>è¿™æ˜¯å› ä¸ºäº‹ä»¶ç›‘å¬å™¨åœ¨è¢«è°ƒç”¨æ—¶ï¼Œå…¶ä¸Šä¸‹æ–‡è¢«è‡ªåŠ¨ç»‘å®šåˆ°ç›®æ ‡å…ƒç´ ä¸Šã€‚è¿™ä¸€ç‰¹æ€§æå¤§åœ°æ–¹ä¾¿äº†å¯¹è§¦å‘å…ƒç´ çš„æ“ä½œï¼Œæ— éœ€é¢å¤–æŸ¥è¯¢ DOMã€‚</p>
<h2 data-id="heading-7">è‡ªç”±å˜é‡ä¸ this çš„å¯¹æ¯”</h2>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°å†…éƒ¨å¯¹<strong>è‡ªç”±å˜é‡</strong>ï¼ˆå³éå‚æ•°ã€éå±€éƒ¨å˜é‡ï¼Œæ¥è‡ªå¤–å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼‰çš„è®¿é—®ï¼Œä¾ç„¶éµå¾ªè¯æ³•ä½œç”¨åŸŸè§„åˆ™ï¼Œä¸ <code>this</code> æ— å…³ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">myName</span> = <span class="hljs-string">'æå®¢é‚¦'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">bar</span> = {
  myName: "time.geekbang.com",
  printName: function() {
    console.log(myName)<span class="hljs-comment">;        // "æå®¢é‚¦"ï¼ˆæ¥è‡ªå¤–å±‚ä½œç”¨åŸŸï¼‰</span>
    console.log(this.myName)<span class="hljs-comment">;   // å–å†³äºè°ƒç”¨æ–¹å¼</span>
  }
}<span class="hljs-comment">;</span>

bar.printName()<span class="hljs-comment">; // this.myName â†’ "time.geekbang.com"</span>
const <span class="hljs-attr">fn</span> = bar.printName<span class="hljs-comment">;</span>
fn()<span class="hljs-comment">;           // this.myName â†’ undefined æˆ– window.myNameï¼ˆè‹¥å­˜åœ¨ï¼‰</span>
</code></pre>
<p>è¿™é‡Œï¼Œ<code>myName</code> çš„å€¼å§‹ç»ˆç”±å£°æ˜ä½ç½®å†³å®šï¼Œè€Œ <code>this.myName</code> åˆ™éšè°ƒç”¨æ–¹å¼å˜åŒ–ã€‚è¿™æ¸…æ™°åœ°å±•ç¤ºäº†è¯æ³•ä½œç”¨åŸŸä¸åŠ¨æ€ <code>this</code> ä¹‹é—´çš„æ ¹æœ¬åŒºåˆ«ã€‚</p>
<h2 data-id="heading-8">è®¾è®¡åæ€ï¼šçµæ´»è¿˜æ˜¯éšæ‚£ï¼Ÿ</h2>
<p>JavaScript å°† <code>this</code> çš„ç»‘å®šæ¨è¿Ÿåˆ°è¿è¡Œæ—¶ï¼Œç¡®å®æä¾›äº†æå¤§çš„çµæ´»æ€§â€”â€”åŒä¸€ä¸ªå‡½æ•°å¯ä»¥åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­å¤ç”¨ï¼Œå®ç°å¤šæ€è¡Œä¸ºã€‚ä½†è¿™ç§è®¾è®¡ä¹Ÿç‰ºç‰²äº†å¯é¢„æµ‹æ€§ã€‚è®¸å¤š bug æºäºå¼€å‘è€…è¯¯ä»¥ä¸º <code>this</code> ä¼šâ€œè®°ä½â€å®šä¹‰æ—¶çš„ä¸Šä¸‹æ–‡ï¼Œè€Œå®é™…ä¸Šå®ƒå®Œå…¨å–å†³äºè°ƒç”¨æ–¹å¼ã€‚</p>
<p>æ­£å› å¦‚æ­¤ï¼ŒES6 å¼•å…¥äº†ç®­å¤´å‡½æ•°ï¼Œå…¶ <code>this</code> <strong>ç»§æ‰¿è‡ªå¤–å±‚è¯æ³•ä½œç”¨åŸŸ</strong>ï¼Œä¸å†å—è°ƒç”¨æ–¹å¼å½±å“ã€‚è¿™åœ¨å›è°ƒã€äº‹ä»¶å¤„ç†å™¨ç­‰åœºæ™¯ä¸­å¤§å¤§å‡å°‘äº† <code>this</code> ç»‘å®šé”™è¯¯ã€‚ä½†åœ¨ä¼ ç»Ÿå‡½æ•°ä¸­ï¼Œç†è§£ <code>this</code> çš„åŠ¨æ€æœ¬è´¨ä»æ˜¯å¿…å¤‡æŠ€èƒ½ã€‚</p>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p><code>this</code> æ˜¯ JavaScript æ‰§è¡Œæ¨¡å‹ä¸­ä¸€ä¸ªç‹¬ç‰¹è€Œå…³é”®çš„æ¦‚å¿µã€‚å®ƒä¸éµå¾ªè¯æ³•ä½œç”¨åŸŸï¼Œè€Œæ˜¯ç”±å‡½æ•°è°ƒç”¨æ–¹å¼åŠ¨æ€å†³å®šï¼Œä½“ç°äº†è¯­è¨€â€œè¿è¡Œæ—¶ç»‘å®šâ€çš„å“²å­¦ã€‚æŒæ¡å…¶åœ¨ä¸åŒåœºæ™¯ä¸‹çš„æŒ‡å‘è§„åˆ™â€”â€”å¯¹è±¡æ–¹æ³•ã€æ™®é€šå‡½æ•°ã€æ˜¾å¼ç»‘å®šã€æ„é€ è°ƒç”¨å’Œäº‹ä»¶å¤„ç†â€”â€”æ˜¯ç¼–å†™å¥å£®ä»£ç çš„å‰æã€‚</p>
<p>å°½ç®¡ <code>this</code> çš„è®¾è®¡æ›¾å¼•å‘äº‰è®®ï¼Œä½†å®ƒä¹Ÿæˆå°±äº† JavaScript çš„é«˜åº¦çµæ´»æ€§ã€‚åªè¦ç†è§£å…¶è¿è¡Œæœºåˆ¶ï¼Œå¼€å‘è€…å°±èƒ½é©¾é©­è¿™ä¸€ç‰¹æ€§ï¼Œæ„å»ºå‡ºæ—¢é«˜æ•ˆåˆå¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºã€‚åœ¨ç°ä»£å¼€å‘ä¸­ï¼Œç»“åˆä¸¥æ ¼æ¨¡å¼ã€ç®­å¤´å‡½æ•°å’Œæ¨¡å—åŒ–æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§é™åº¦åœ°å‘æŒ¥ <code>this</code> çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶è§„é¿å…¶æ½œåœ¨é£é™©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨PySide6/PyQt6çš„é¡¹ç›®ä¸­å°è£…ä¸€äº›åŸºç¡€ç±»åº“ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¯¹è¯æ¡†ã€å­—ä½“å¯¹è¯æ¡†ã€é¢œè‰²å¯¹è¯æ¡†ã€æ¶ˆæ¯å¯¹è¯æ¡†ç­‰å†…å®¹]]></title>    <link>https://juejin.cn/post/7585645111875665947</link>    <guid>https://juejin.cn/post/7585645111875665947</guid>    <pubDate>2025-12-21T08:41:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585645111875665947" data-draft-id="7585686247286308915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨PySide6/PyQt6çš„é¡¹ç›®ä¸­å°è£…ä¸€äº›åŸºç¡€ç±»åº“ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¯¹è¯æ¡†ã€å­—ä½“å¯¹è¯æ¡†ã€é¢œè‰²å¯¹è¯æ¡†ã€æ¶ˆæ¯å¯¹è¯æ¡†ç­‰å†…å®¹"/> <meta itemprop="keywords" content="å‰ç«¯,PyQt"/> <meta itemprop="datePublished" content="2025-12-21T08:41:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¼åèª"/> <meta itemprop="url" content="https://juejin.cn/user/122769398839592"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨PySide6/PyQt6çš„é¡¹ç›®ä¸­å°è£…ä¸€äº›åŸºç¡€ç±»åº“ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¯¹è¯æ¡†ã€å­—ä½“å¯¹è¯æ¡†ã€é¢œè‰²å¯¹è¯æ¡†ã€æ¶ˆæ¯å¯¹è¯æ¡†ç­‰å†…å®¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/122769398839592/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¼åèª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:41:44.000Z" title="Sun Dec 21 2025 08:41:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æˆ‘ä»¬å®é™…å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œä¼šé’ˆå¯¹ä¸€äº›å¸¸ç”¨åˆ°çš„å†…å®¹è¿›è¡Œä¸€å®šçš„å°è£…å¤„ç†ï¼Œä»¥é™ä½ä½¿ç”¨çš„éš¾åº¦å’Œå‡å°‘ç›¸å…³ä»£ç ï¼Œæœ¬ç¯‡éšç¬”ä»‹ç»åœ¨PySide6/PyQt6çš„é¡¹ç›®ä¸­å°è£…ä¸€äº›åŸºç¡€ç±»åº“ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¯¹è¯æ¡†ã€å­—ä½“å¯¹è¯æ¡†ã€é¢œè‰²å¯¹è¯æ¡†ã€æ¶ˆæ¯å¯¹è¯æ¡†ç­‰å†…å®¹ã€‚</p>
<h3 data-id="heading-0">1ã€å¸¸ç”¨å¯¹è¯æ¡†å¤„ç†å°è£…çš„ä¼˜ç‚¹</h3>
<p>å¯¹å¸¸ç”¨å¯¹è¯æ¡†çš„è°ƒç”¨ï¼ˆåŒ…æ‹¬æ–‡ä»¶å¯¹è¯æ¡†ã€å­—ä½“å¯¹è¯æ¡†ã€é¢œè‰²å¯¹è¯æ¡†ã€æ¶ˆæ¯å¯¹è¯æ¡†ç­‰å†…å®¹ï¼‰ï¼Œå¯èƒ½è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå¦‚å¯¹äºå¸¸ç”¨çš„æ–‡ä»¶ç›®å½•å¯¹è¯æ¡†ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸‹é¢ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li>å‚æ•°é¡ºåºéš¾è®°</li>
<li>å•é€‰ / å¤šé€‰ / ä¿å­˜ / ç›®å½• API ä¸ç»Ÿä¸€</li>
<li>æœ€è¿‘è·¯å¾„ä¸å¥½ç»´æŠ¤</li>
<li>æ¯ä¸ªçª—å£éƒ½å†™ä¸€é</li>
</ul>
<p>å¦‚æœå¯¹å®ƒè¿›è¡Œä¸€å®šçš„å°è£…ï¼Œå¯ä»¥å®ç°æ›´å¤šå¯é€‰å‚æ•°çš„è®¾ç½®ä»¥åŠæ›´å¥½çš„æ”¯æŒï¼š</p>
<p>âœ… æ‰“å¼€å•æ–‡ä»¶<br/>
âœ… æ‰“å¼€å¤šæ–‡ä»¶<br/>
âœ… ä¿å­˜æ–‡ä»¶<br/>
âœ… é€‰æ‹©ç›®å½•<br/>
âœ… æ–‡ä»¶è¿‡æ»¤å™¨å¸¸é‡<br/>
âœ… æœ€è¿‘ç›®å½•è®°å¿†ï¼ˆè¿›ç¨‹çº§ / å¯æ‰©å±•åˆ°é…ç½®ï¼‰<br/>
âœ… Windows / macOS / Linux å…¼å®¹</p>
<p>å¦‚æœå¯¹è¿™äº›å¯¹è¯æ¡†è¿›è¡Œè¾…åŠ©ç±»çš„ç»Ÿä¸€å°è£…ï¼Œä¼šå…·æœ‰ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»è¦çš„ä¼˜ç‚¹ï¼š</p>
<p>1ï¼‰<strong>ä»£ç å¤ç”¨</strong></p>
<p>å°è£…å¸¸ç”¨å¯¹è¯æ¡†å¯ä»¥é¿å…é‡å¤ä»£ç ã€‚ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„å‡½æ•°æˆ–ç±»æ¥å¤„ç†æ‰€æœ‰å¸¸ç”¨å¯¹è¯æ¡†æ“ä½œï¼Œä»è€Œåœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨è¿™æ®µä»£ç ã€‚</p>
<p>2ï¼‰<strong>ä¸€è‡´æ€§</strong></p>
<p>é€šè¿‡å°è£…ï¼Œä½ å¯ä»¥ç¡®ä¿æ‰€æœ‰å¸¸ç”¨å¯¹è¯æ¡†çš„å¤–è§‚å’Œè¡Œä¸ºä¸€è‡´ã€‚è¿™æœ‰åŠ©äºæé«˜ç”¨æˆ·ä½“éªŒï¼Œä½¿ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­è·å¾—ç»Ÿä¸€çš„äº¤äº’æ–¹å¼ã€‚</p>
<p>3ï¼‰Â <strong>ç®€åŒ–è°ƒç”¨</strong></p>
<p>å°è£…å¯ä»¥ç®€åŒ–è°ƒç”¨è¿‡ç¨‹ã€‚ä½ å¯ä»¥å°†å¸¸ç”¨çš„å‚æ•°è®¾ç½®ï¼ˆå¦‚æ ‡é¢˜ã€å›¾æ ‡ã€æŒ‰é’®ç±»å‹ç­‰ï¼‰é¢„å…ˆå®šä¹‰å¥½ï¼Œä»è€Œåœ¨è°ƒç”¨æ—¶å‡å°‘å‚æ•°è¾“å…¥ã€‚</p>
<p>4ï¼‰<strong>æ˜“äºç»´æŠ¤</strong></p>
<p>å½“éœ€è¦æ›´æ”¹å¯¹è¯æ¡†çš„è¡Œä¸ºæˆ–æ ·å¼æ—¶ï¼Œåªéœ€åœ¨å°è£…å‡½æ•°ä¸­è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸å¿…åœ¨åº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ªè°ƒç”¨ç‚¹è¿›è¡Œæ›´æ”¹ã€‚è¿™ä½¿å¾—ç»´æŠ¤å˜å¾—æ›´åŠ ç®€å•å’Œé«˜æ•ˆã€‚</p>
<p>5ï¼‰<strong>å¢å¼ºå¯è¯»æ€§</strong></p>
<p>é€šè¿‡ä½¿ç”¨å°è£…çš„å‡½æ•°æˆ–ç±»ï¼Œä»£ç å˜å¾—æ›´æ˜“è¯»ã€‚å…¶ä»–å¼€å‘è€…å¯ä»¥ä¸€çœ¼çœ‹å‡ºå¯¹è¯æ¡†çš„ä½œç”¨ï¼Œè€Œä¸å¿…æ·±å…¥äº†è§£å…¶å…·ä½“å®ç°ã€‚</p>
<p>6ï¼‰<strong>é›†ä¸­ç®¡ç†</strong></p>
<p>å°è£…æœ‰åŠ©äºé›†ä¸­ç®¡ç†å¯¹è¯æ¡†çš„é€»è¾‘ï¼Œæ¯”å¦‚å¤„ç†ç”¨æˆ·è¾“å…¥ã€å“åº”ç”¨æˆ·é€‰æ‹©ç­‰ã€‚è¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿åœ°è¿›è¡Œé€»è¾‘æ›´æ–°æˆ–é”™è¯¯å¤„ç†ã€‚</p>
<p>7ï¼‰Â <strong>æ‰©å±•æ€§</strong></p>
<p>å¦‚æœå°†æ¥éœ€è¦å¢åŠ æ–°çš„å¯¹è¯æ¡†æˆ–ä¿®æ”¹ç°æœ‰å¯¹è¯æ¡†çš„é€»è¾‘ï¼Œå°è£…ä½¿å¾—æ‰©å±•æ›´åŠ å®¹æ˜“ã€‚ä½ å¯ä»¥åœ¨å°è£…çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œè€Œä¸å½±å“ç°æœ‰çš„ä»£ç ç»“æ„ã€‚</p>
<h2 data-id="heading-1">2ã€æ–‡ä»¶å¯¹è¯æ¡†çš„å°è£…</h2>
<p>å¦‚æœæˆ‘ä»¬å¯¹æ–‡ä»¶å¯¹è¯æ¡†è¿›è¡Œå°è£…ï¼Œé‚£ä¹ˆéœ€è¦è€ƒè™‘æ‰“å¼€ã€ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†ç­‰å¸¸è§„æ“ä½œï¼Œè€Œæ–‡ä»¶çš„æ ¼å¼æœ‰å¤šç§å¤šæ ·ï¼Œæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥æä¾›æ›´ç»†èŠ‚çš„å‡½æ•°é€‰æ‹©å…·ä½“çš„æ–‡ä»¶ï¼Œå¦‚æ–‡æœ¬æ–‡ä»¶ã€Excelæ–‡ä»¶ç­‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">class FileDialogUtil:
    """æ–‡ä»¶ã€ç›®å½•å¯¹è¯æ¡†å·¥å…·ç±»"""

    <span class="hljs-comment"># å®šä¹‰æ–‡ä»¶è¿‡æ»¤å™¨</span>
    <span class="hljs-attr">all_filter</span> = <span class="hljs-string">"All File (*.*);;*.*"</span>
    <span class="hljs-attr">word_filter</span> = <span class="hljs-string">"Word (*.doc);;*.doc;;Word (*.docx);;*.docx;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">excel_filter</span> = <span class="hljs-string">"Excel (*.xls);;*.xls;;Excel (*.xlsx);;*.xlsx;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">pdf_filter</span> = <span class="hljs-string">"PDF (*.pdf);;*.pdf;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">image_filter</span> = <span class="hljs-string">"Image Files (*.BMP;*.bmp;*.JPG;*.jpg;*.GIF;*.gif;*.png;*.PNG);;*.BMP;*.bmp;*.JPG;*.jpg;*.GIF;*.gif;*.png;*.PNG;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">html_filter</span> = <span class="hljs-string">"HTML files (*.html;*.htm);;*.html;*.htm;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">access_filter</span> = <span class="hljs-string">"Access (*.mdb);;*.mdb;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">zip_filter</span> = <span class="hljs-string">"Zip (*.zip);;*.zip;;Rar (*.rar);;*.rar;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">config_filter</span> = <span class="hljs-string">"Configuration Files (*.cfg);;*.cfg;;All File (*.*);;*.*"</span>
    <span class="hljs-attr">txt_filter</span> = <span class="hljs-string">"Text (*.txt);;*.txt;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">xml_filter</span> = <span class="hljs-string">"XML Files (*.xml);;*.xml;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">rar_filter</span> = <span class="hljs-string">"Rar (*.rar);;*.rar;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">sqlite_filter</span> = <span class="hljs-string">"Sqlite Files (*.db);;*.db;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">python_filter</span> = <span class="hljs-string">"Python Files (*.py);;*.py;;All files (*.*);;*.*"</span>
    <span class="hljs-attr">csv_filter</span> = <span class="hljs-string">"CSV Files (*.csv);;*.csv;;All files (*.*);;*.*"</span>

    @staticmethod
    def open_file(
        parent: <span class="hljs-attr">QWidget</span> = None,
        multiple: <span class="hljs-attr">bool</span> = <span class="hljs-literal">False</span>,
        title: <span class="hljs-attr">str</span> = <span class="hljs-string">"æ‰“å¼€æ–‡ä»¶"</span>,
        filter: <span class="hljs-attr">str</span> = all_filter,
        filename: <span class="hljs-attr">str</span> = <span class="hljs-string">""</span>,
        initial_directory: <span class="hljs-attr">str</span> = os.getcwd(),
    ) -&gt; str:
        """
        æ‰“å¼€æ–‡ä»¶å¯¹è¯æ¡†

        :param parent: çˆ¶çª—å£
        :param multiple: æ˜¯å¦å¤šé€‰
        :param title: å¯¹è¯æ¡†æ ‡é¢˜
        :param filename: é»˜è®¤æ–‡ä»¶å
        :param filter: æ–‡ä»¶è¿‡æ»¤å™¨
        :param initial_directory: é»˜è®¤ç›®å½•
        :return: é€‰ä¸­çš„æ–‡ä»¶è·¯å¾„,å¦‚æœæ˜¯å¤šé€‰,åˆ™è¿”å›ä»¥é€—å·åˆ†éš”çš„å¤šä¸ªæ–‡ä»¶è·¯å¾„
        """

        <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¯¹è¯æ¡†</span>
        <span class="hljs-attr">dialog</span> = QFileDialog(parent)
        dialog.setWindowTitle(title)
        dialog.setFileMode(
            QFileDialog.FileMode.ExistingFiles
            if multiple
            else QFileDialog.FileMode.ExistingFile
        )
        dialog.setNameFilter(filter)
        dialog.setDirectory(initial_directory)
        dialog.selectFile(filename)

        <span class="hljs-comment"># æ‰§è¡Œå¯¹è¯æ¡†å¹¶è·å–æ–‡ä»¶è·¯å¾„</span>
        <span class="hljs-attr">result</span> = <span class="hljs-string">""</span>
        if dialog.exec():
            if multiple:
                <span class="hljs-attr">file_paths</span> = dialog.selectedFiles()
                <span class="hljs-attr">result</span> = <span class="hljs-string">","</span>.join(file_paths)  <span class="hljs-comment"># å°†æ–‡ä»¶è·¯å¾„è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</span>
            else:
                <span class="hljs-attr">result</span> = dialog.selectedFiles()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># è·å–å•ä¸ªæ–‡ä»¶è·¯å¾„</span>

        return result
</code></pre>
<p>å½“ç„¶ä¸Šé¢Â open_fileÂ ä¼ å…¥çš„æ˜¯æ‰€æœ‰æ–‡ä»¶çš„æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è·Ÿè¿›ä¸€æ­¥é€‰æ‹©Excelæ ¼å¼ï¼Œå°±éœ€è¦ä¼ å…¥å¯¹åº”çš„åç¼€åå‚æ•°å¸¸é‡å³å¯ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b8643ad9f9e48e59424ee407d29e4d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=CtobPYIOX9Cx5ykmqzD1zlkB2aE%3D" alt="image" loading="lazy"/></p>
<p>Â è€Œå¦‚æœè¦å¼¹å‡ºä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†çš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿæ˜¯å¦‚æ³•ç‚®åˆ¶å³å¯ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_file</span>(<span class="hljs-params">
        parent: QWidget = <span class="hljs-literal">None</span>,
        title: <span class="hljs-built_in">str</span> = <span class="hljs-string">"ä¿å­˜æ–‡ä»¶"</span>,
        <span class="hljs-built_in">filter</span>: <span class="hljs-built_in">str</span> = all_filter,
        filename: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>,
        initial_directory: <span class="hljs-built_in">str</span> = os.getcwd(<span class="hljs-params"/>),
    </span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ä»¥æŒ‡å®šçš„æ ‡é¢˜å¼¹å‡ºä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†

        :param title: å¯¹è¯æ¡†æ ‡é¢˜
        :param filename: é»˜è®¤æ–‡ä»¶å
        :param filter: æ–‡ä»¶è¿‡æ»¤å™¨
        :param initial_directory: é»˜è®¤ç›®å½•
        :return: é€‰ä¸­çš„æ–‡ä»¶è·¯å¾„
        """</span>
        <span class="hljs-comment"># åˆ›å»ºä¿å­˜æ–‡ä»¶å¯¹è¯æ¡†</span>
        dialog = QFileDialog(parent)
        dialog.setWindowTitle(title)
        dialog.setAcceptMode(QFileDialog.AcceptMode.AcceptSave)  <span class="hljs-comment"># è®¾ç½®ä¸ºä¿å­˜æ¨¡å¼</span>
        dialog.setNameFilter(<span class="hljs-built_in">filter</span>)
        dialog.setDirectory(initial_directory)
        dialog.selectFile(filename)

        <span class="hljs-comment"># æ‰§è¡Œå¯¹è¯æ¡†å¹¶è·å–æ–‡ä»¶è·¯å¾„</span>
        result = <span class="hljs-string">""</span>
        <span class="hljs-keyword">if</span> dialog.<span class="hljs-built_in">exec</span>():
            result = dialog.selectedFiles()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># è·å–é€‰ä¸­çš„æ–‡ä»¶è·¯å¾„</span>

        <span class="hljs-keyword">return</span> result
</code></pre>
<p>å…¶ä»–ç±»å‹æ ¼å¼çš„ï¼Œåªéœ€è¦ä¼ å…¥å¯¹åº”çš„filteræ ¼å¼å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/276db7f69edc4c5ba2d50f45d17318df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=05Cn1m6IYPRYyyLsrYcToW1diIA%3D" alt="image" loading="lazy"/></p>
<p>Â é€‰æ‹©ç›®å½•ä¹Ÿæ˜¯ç±»ä¼¼çš„å¤„ç†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">open_dir</span>(<span class="hljs-params">
        parent: QWidget = <span class="hljs-literal">None</span>,
        title: <span class="hljs-built_in">str</span> = <span class="hljs-string">"é€‰æ‹©ç›®å½•"</span>,
        initial_directory: <span class="hljs-built_in">str</span> = os.getcwd(<span class="hljs-params"/>),
    </span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ˜¾ç¤ºç›®å½•é€‰æ‹©å¯¹è¯æ¡†"""</span>

        <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¯¹è¯æ¡†</span>
        dialog = QFileDialog(parent)
        dialog.setWindowTitle(title)
        dialog.setFileMode(QFileDialog.FileMode.Directory)  <span class="hljs-comment"># è®¾ç½®ä¸ºç›®å½•é€‰æ‹©æ¨¡å¼</span>
        dialog.setOption(QFileDialog.Option.ShowDirsOnly, <span class="hljs-literal">True</span>)  <span class="hljs-comment"># åªæ˜¾ç¤ºç›®å½•</span>
        dialog.setDirectory(initial_directory)

        <span class="hljs-comment"># æ‰§è¡Œå¯¹è¯æ¡†å¹¶è·å–é€‰ä¸­çš„ç›®å½•</span>
        result = <span class="hljs-string">""</span>
        <span class="hljs-keyword">if</span> dialog.<span class="hljs-built_in">exec</span>():
            result = dialog.selectedFiles()[<span class="hljs-number">0</span>]  <span class="hljs-comment"># è·å–é€‰ä¸­çš„ç›®å½•è·¯å¾„</span>

        <span class="hljs-built_in">print</span>(result)
        <span class="hljs-keyword">return</span> result
</code></pre>
<p>é€‰æ‹©å¤šä¸ªç›®å½•ï¼Œå¦‚ä¸‹æ•ˆæœ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c792726f00e8441dad7a158441b27643~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=2bJVuMxUy6sh3IYM1zbIbhmOfBY%3D" alt="image" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬åœ¨ä¸€äº›çª—ä½“ä¸Šä½¿ç”¨ä¿å­˜Excelæˆ–è€…PDFæ–‡ä»¶çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨å®ƒçš„å‡½æ•°è°ƒç”¨å³å¯ï¼Œæ¯”è¾ƒç®€å•äº†ã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">export_to_pdf</span>(<span class="hljs-params">self, setting: PrintSetting</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""å°† QTableView çš„æ•°æ®å¯¼å‡ºä¸º PDF, æˆåŠŸè¿”å›æ–‡ä»¶è·¯å¾„ï¼Œå¤±è´¥è¿”å›ç©ºå­—ç¬¦ä¸²"""</span>

        pdf_file = FileDialogUtil.save_pdf(filename=<span class="hljs-string">f"<span class="hljs-subst">{setting.print_title}</span>.pdf"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pdf_file:
            <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>

        <span class="hljs-comment"># åˆ›å»º QPrinterï¼ŒPDFæ ¼å¼</span>
        printer = QPrinter(QPrinter.PrinterMode.HighResolution)
        printer.setOutputFormat(QPrinter.OutputFormat.PdfFormat)
        printer.setOutputFileName(pdf_file)  <span class="hljs-comment"># è¾“å‡º PDF æ–‡ä»¶</span>

        <span class="hljs-comment"># æ‰“å°çš„å¤„ç†</span>
        printer.setPageSize(setting.page_size)
        printer.setPageOrientation(setting.page_orientation)
        self.print_cols = setting.print_cols  <span class="hljs-comment"># æ‰“å°æŒ‡å®šåˆ—çš„ç´¢å¼•åˆ—è¡¨</span>
        self.print_title = setting.print_title  <span class="hljs-comment"># æ‰“å°æ ‡é¢˜</span>
        self.settings = setting  <span class="hljs-comment"># ä¿å­˜æ‰“å°è®¾ç½®</span>

        <span class="hljs-comment"># æ‰“å°è¾“å‡º</span>
        self.print_preview_paint(printer)
        <span class="hljs-keyword">return</span> pdf_file
</code></pre>
<h3 data-id="heading-2">3ã€å°è£…å¸¸ç”¨æ¶ˆæ¯å¯¹è¯æ¡†</h3>
<p>å°è£…çš„æ¶ˆæ¯æç¤ºå¯¹è¯æ¡†åŒ…æ‹¬ä¸ªå„ç§å¸¸ç”¨çš„å¯¹è¯æ¡†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/732a8aa4343441e5af439703088b3ca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=SD%2BynXiW7BcH%2FFcBG5%2BdO01qhG4%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯å¯¹è¯æ¡†ç±»MessageUtilï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageUtil</span>:
    <span class="hljs-string">"""
    å°è£…äº†å¸¸ç”¨çš„æ¶ˆæ¯å¯¹è¯æ¡†ï¼Œä»¥æ–¹ä¾¿ä½¿ç”¨å¸¸ç”¨å¯¹è¯æ¡†æ¶ˆæ¯ã€‚
    åŒ…æ‹¬æç¤ºä¿¡æ¯ã€è­¦å‘Šä¿¡æ¯ã€é”™è¯¯ä¿¡æ¯ã€ç¡®è®¤ä¿¡æ¯ã€è¯¢é—®ä¿¡æ¯ã€è¾“å…¥ä¿¡æ¯ã€
    é€‰æ‹©ä¿¡æ¯ã€å¤šé€‰ä¿¡æ¯ã€æ–‡ä»¶é€‰æ‹©ä¿¡æ¯ã€ç›®å½•é€‰æ‹©ä¿¡æ¯ã€å­—ä½“é€‰æ‹©ä¿¡æ¯ã€é¢œè‰²é€‰æ‹©ä¿¡æ¯ã€è¿›åº¦æ¡ä¿¡æ¯ç­‰ã€‚
    """</span>

    <span class="hljs-comment"># å¸¸ç”¨æ¶ˆæ¯å¯¹è¯æ¡†çš„æ ‡é¢˜</span>
    CAPTION_TIPS = <span class="hljs-string">"æç¤ºä¿¡æ¯"</span>
    CAPTION_WARNING = <span class="hljs-string">"è­¦å‘Šä¿¡æ¯"</span>
    CAPTION_ERROR = <span class="hljs-string">"é”™è¯¯ä¿¡æ¯"</span>
    CAPTION_CONFIRM = <span class="hljs-string">"ç¡®è®¤ä¿¡æ¯"</span>
 
<span class="hljs-meta">   @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">show_message</span>(<span class="hljs-params">
        message: <span class="hljs-built_in">str</span>,
        title: <span class="hljs-built_in">str</span> = CAPTION_TIPS,
        extended_message=<span class="hljs-literal">None</span>,
        parent=<span class="hljs-literal">None</span>,
        icon: QMessageBox.Icon = QMessageBox.Icon.Information,
        buttons: QMessageBox.StandardButton = QMessageBox.StandardButton.Ok,
    </span>) -&gt; QMessageBox.StandardButton:
        <span class="hljs-string">"""
        é€šç”¨æ¶ˆæ¯æ¡†æ˜¾ç¤ºå‡½æ•°
        """</span>
        msg_box = QMessageBox(parent)
        msg_box.setWindowTitle(title)
        msg_box.setText(message)

        <span class="hljs-comment"># è®¾ç½®è¯¦ç»†ä¿¡æ¯ï¼Œåœ¨æ¶ˆæ¯æ¡†çš„åº•éƒ¨æ˜¾ç¤ºã€‚</span>
        <span class="hljs-keyword">if</span> extended_message:
            <span class="hljs-comment"># åˆ›å»º TextSplitter å®ä¾‹ï¼Œè®¾ç½®æ¯è¡Œæœ€å¤§å­—ç¬¦æ•°ä¸º 30</span>
            splitter = TextSplitter(max_line_length=<span class="hljs-number">80</span>)
            <span class="hljs-comment"># ä½¿ç”¨ splitter æ¥åˆ†å‰²æ–‡æœ¬</span>
            extended_message = splitter.split(extended_message)
            msg_box.setDetailedText(extended_message)

        msg_box.setDetailedText(extended_message)
        msg_box.setIcon(icon)
        msg_box.setStandardButtons(buttons)
        <span class="hljs-comment"># è®¾ç½®çª—å£å›¾æ ‡</span>
        app_icon = QIcon(<span class="hljs-string">"app/images/app.ico"</span>)
        msg_box.setWindowIcon(app_icon)
        <span class="hljs-keyword">return</span> msg_box.<span class="hljs-built_in">exec</span>()
</code></pre>
<p>ç„¶åç»Ÿä¸€å¯¹å¸¸ç”¨çš„æ¶ˆæ¯è¿›è¡Œå‡½æ•°å°è£…ï¼Œå¦‚ä¸€èˆ¬æ¶ˆæ¯ã€è­¦å‘Šæ¶ˆæ¯ã€é”™è¯¯æ¶ˆæ¯ï¼Œæç¤ºæ¶ˆæ¯ç­‰ï¼Œåªéœ€è¦å¯¹ä¸Šé¢å‡½æ•°çš„ç®€å•è°ƒç”¨ï¼Œä¼ é€’ä¸åŒçš„å‚æ•°å°±å¯ä»¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca0b204fcb544f4288358778bd9b638c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=2%2BiDrhF3proapgi7jYdRxZCevNc%3D" alt="image" loading="lazy"/></p>
<p>æœ‰äº†è¿™æ ·çš„å°è£…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çª—ä½“ä¸­ç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦è®°ä½å¤ªå¤šçš„å‚æ•°äº†ï¼Œæ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸‹é¢çš„åˆ é™¤æ“ä½œå¤„ç†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">    @asyncSlot()</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">OnDelete</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å¼¹å‡ºåˆ é™¤å¯¹è¯æ¡†"""</span>
        selected_rows = self.table_view.selectionModel().selectedRows()
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> selected_rows:
            MessageUtil.show_info(<span class="hljs-string">"è¯·é€‰æ‹©è¦æ“ä½œçš„è¡Œ"</span>)
            <span class="hljs-keyword">return</span>
        <span class="hljs-comment"># ç¡®è®¤åˆ é™¤</span>
        result = MessageUtil.show_confirm(<span class="hljs-string">"ç¡®è®¤åˆ é™¤é€‰ä¸­çš„è¡Œï¼Ÿ"</span>, <span class="hljs-string">"ç¡®è®¤åˆ é™¤"</span>)
        <span class="hljs-keyword">if</span> result:
            <span class="hljs-comment"># éå†é€‰å®šçš„è¡Œï¼Œåˆ é™¤ä¸»é”®å€¼å¯¹åº”çš„è®°å½•</span>
            <span class="hljs-built_in">list</span> = []
            <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> selected_rows:
                entity_id = self.table_model.GetPrimaryKeyValue(index.row())
                <span class="hljs-keyword">if</span> entity_id:
                    <span class="hljs-built_in">list</span>.append(entity_id)
            <span class="hljs-keyword">try</span>:
                <span class="hljs-keyword">await</span> self.OnDeleteByIdList(<span class="hljs-built_in">list</span>)
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                MessageUtil.show_error(<span class="hljs-string">f"åˆ é™¤å¤±è´¥ï¼š<span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>Â ä¸ºäº†äº†è§£å¸¸ç”¨å¯¹è¯æ¡†çš„æ“ä½œï¼Œæˆ‘ä»¬è¿˜ç¼–å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç•Œé¢æ¥å±•ç¤ºæ•ˆæœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee23f9ae1578402abba65769e6e2dde7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=QaACROnO4SHCHXKRvxEs4oA%2B%2Fa8%3D" alt="image" loading="lazy"/></p>
<p><strong>å­—ä½“å¯¹è¯æ¡†</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61b34c6d97354371995d85e354d4b2ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=R6jfeuCWFx9ClOPmKqt3t8Ulzkc%3D" alt="image" loading="lazy"/></p>
<p>å°è£…å­—ä½“å¯¹è¯æ¡†å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">show_font_dialog</span>(<span class="hljs-params">parent=<span class="hljs-literal">None</span>, font=<span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[QFont, <span class="hljs-built_in">bool</span>]:
        <span class="hljs-string">"""
        æ˜¾ç¤ºå­—ä½“é€‰æ‹©å¯¹è¯æ¡†
        :param parent: çˆ¶çª—å£
        :param font: é»˜è®¤å­—ä½“ï¼Œå¦‚æœæ²¡æœ‰æä¾›ï¼Œä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“
        :return: é€‰æ‹©çš„å­—ä½“ï¼ŒæˆåŠŸæ—¶è¿”å› (QFont, True)ï¼Œå¤±è´¥æ—¶è¿”å› (None, False)
        """</span>
        <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤å­—ä½“ï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“</span>
        <span class="hljs-keyword">if</span> font <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            font = QApplication.font()  <span class="hljs-comment"># è·å–ç³»ç»Ÿé»˜è®¤å­—ä½“</span>

        <span class="hljs-comment"># æ‰“å¼€å­—ä½“é€‰æ‹©å¯¹è¯æ¡†</span>
        ok, selected_font = QFontDialog.getFont(font, parent)

        <span class="hljs-comment"># è¿”å›é€‰æ‹©çš„å­—ä½“å’Œæ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-keyword">return</span> selected_font, ok
</code></pre>
<p>è°ƒç”¨ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_select_font</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):
        myfont = <span class="hljs-variable language_">self</span>.message.font()  <span class="hljs-comment"># è·å–å½“å‰å­—ä½“</span>
        font_data = <span class="hljs-title class_">MessageUtil</span>.show_font_dialog(<span class="hljs-variable language_">self</span>, myfont)[<span class="hljs-number">0</span>]  <span class="hljs-comment"># æ‰“å¼€å­—ä½“é€‰æ‹©å¯¹è¯æ¡†</span>
        <span class="hljs-keyword">if</span> <span class="hljs-symbol">font_data:</span>
            <span class="hljs-variable language_">self</span>.message.setFont(
                <span class="hljs-title class_">QFont</span>(font_data.family(), font_data.pointSize())
            )  <span class="hljs-comment"># è®¾ç½®å­—ä½“</span>
            <span class="hljs-variable language_">self</span>.message.update()  <span class="hljs-comment"># åˆ·æ–°æ˜¾ç¤º</span>
</code></pre>
<p><strong>é¢œè‰²å¯¹è¯æ¡†</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6bcfccaa0434e62b83f92f1a0a806e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyN5Y2O6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766911303&amp;x-signature=55gWJpNVgw%2BIRTL3sVBDyGrB9Ic%3D" alt="image" loading="lazy"/></p>
<p>å°è£…é¢œè‰²å¯¹è¯æ¡†å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">show_colour_dialog</span>(<span class="hljs-params">parent=<span class="hljs-literal">None</span>, colour=<span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[QColor, <span class="hljs-built_in">bool</span>]:
        <span class="hljs-string">"""
        æ˜¾ç¤ºé¢œè‰²é€‰æ‹©å¯¹è¯æ¡†
        :param parent: çˆ¶çª—å£
        :param colour: é»˜è®¤é¢œè‰²ï¼Œå¦‚æœæ²¡æœ‰æä¾›ï¼Œä½¿ç”¨é»‘è‰²
        :return: é€‰æ‹©çš„é¢œè‰²ï¼ŒæˆåŠŸæ—¶è¿”å› (QColor, True)ï¼Œå¤±è´¥æ—¶è¿”å› (None, False)
        """</span>
        <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æä¾›é»˜è®¤é¢œè‰²ï¼Œåˆ™ä½¿ç”¨é»‘è‰²</span>
        <span class="hljs-keyword">if</span> colour <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            colour = QColor(Qt.GlobalColor.black)

        <span class="hljs-comment"># æ‰“å¼€é¢œè‰²é€‰æ‹©å¯¹è¯æ¡†</span>
        selected_colour = QColorDialog.getColor(colour, parent)

        <span class="hljs-comment"># è¿”å›é€‰æ‹©çš„é¢œè‰²å’Œæ˜¯å¦æˆåŠŸ</span>
        <span class="hljs-keyword">return</span> selected_colour, selected_colour.isValid()
</code></pre>
<p>è°ƒç”¨ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_select_colour</span>(<span class="hljs-params">self</span>):
        color = self.message.palette().color(QPalette.ColorRole.WindowText)
        color_data = MessageUtil.show_colour_dialog(self, color)[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">if</span> color_data:
            self.message.setStyleSheet(<span class="hljs-string">f"color: <span class="hljs-subst">{color_data.name()}</span>;"</span>)
            self.message.update()  <span class="hljs-comment"># åˆ·æ–°æ˜¾ç¤º</span>
</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„ç®€å•å°è£…ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“çš„è®°å¾—ç›¸å…³çš„å¤„ç†å‡½æ•°ï¼Œå¹¶ä¸”å°½å¯èƒ½çš„å‡å°‘äº†ç›¸å…³çš„å‚æ•°ä¼ é€’ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ›´åŠ æ–¹ä¾¿çµæ´»äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¹Ÿæ˜¯åƒä¸Šç»†ç³ äº†ã€‚ç”¨ä¸Šäº†Claude Codeçš„æ— é™ä¸­è½¬API]]></title>    <link>https://juejin.cn/post/7585693761532575778</link>    <guid>https://juejin.cn/post/7585693761532575778</guid>    <pubDate>2025-12-21T08:58:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585693761532575778" data-draft-id="7585574047075450880" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¹Ÿæ˜¯åƒä¸Šç»†ç³ äº†ã€‚ç”¨ä¸Šäº†Claude Codeçš„æ— é™ä¸­è½¬API"/> <meta itemprop="keywords" content="Cursor,AIç¼–ç¨‹,Claude"/> <meta itemprop="datePublished" content="2025-12-21T08:58:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æå®¢å¯†ç "/> <meta itemprop="url" content="https://juejin.cn/user/976022055165608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¹Ÿæ˜¯åƒä¸Šç»†ç³ äº†ã€‚ç”¨ä¸Šäº†Claude Codeçš„æ— é™ä¸­è½¬API
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022055165608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æå®¢å¯†ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:58:54.000Z" title="Sun Dec 21 2025 08:58:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>ä» <code>Cursor</code> åˆ‡æ¢åˆ° <code>Claude Code</code> ä¸€æ®µæ—¶é—´äº†</p>
<p>æ­é… <code>Claude Code for Vs Code</code> æ’ä»¶ä½¿ç”¨ éå¸¸ä¸æ»‘</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5a3eecbd96c4fcebc64897fbd7aa639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B5a6i5a-G56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766912334&amp;x-signature=h30w%2Byyqc7SHlDFV1468PtO3kLc%3D" alt="æ’ä»¶" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8af5f4438c8946ca93b6cdd3970d2b15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B5a6i5a-G56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766912334&amp;x-signature=lDQ4M0kObyMWs3BZQi5vBcpXVXE%3D" alt="æ’ä»¶ä¸»ç•Œé¢" loading="lazy"/></p>
<p>é™¤äº†æ²¡æœ‰ <code>Tab Completions</code> ä¹‹å¤–ï¼Œå…¶ä»–ä½“éªŒç›¸è¾ƒäº Cursor å‡ ä¹æ²¡æœ‰å·®åˆ«</p>
<h3 data-id="heading-1">ç”¨ Claude Code åšäº†ä»€ä¹ˆ</h3>
<p>æœŸé—´ç”¨å®ƒ VibeCoding äº†ä¸€ä¸ªåº”ç”¨   <a href="https://link.juejin.cn?target=https%3A%2F%2Fecharts.me" target="_blank" title="https://echarts.me" ref="nofollow noopener noreferrer">echarts.me</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3584a4e4a7fa4592990392fdf44f3c7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B5a6i5a-G56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766912334&amp;x-signature=ybMexHeeTVHiKP70S5AJvr3UpCU%3D" alt="Echarts.Me" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€ä¸ªç”¨è‡ªç„¶è¯­è¨€æè¿°ç”Ÿæˆå›¾è¡¨çš„åº”ç”¨ï¼Œåç»­ä¼šå†™ä¸€ç¯‡æ–‡ç« å•ç‹¬ä»‹ç»å®ƒ</p>
<p>ä¹Ÿå†™äº†ä¸€ä¸ª <code>Claude Code</code> çš„ API å•†å®¶å¿«é€Ÿåˆ‡æ¢çš„ Cli å·¥å…·:</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40claude-cli%2Fccs" target="_blank" title="https://www.npmjs.com/package/@claude-cli/ccs" ref="nofollow noopener noreferrer">www.npmjs.com/package/@clâ€¦</a></p>
<p>å½“ç„¶ï¼Œæ­£å¸¸å·¥ä½œä¸­ä¹Ÿè§£å†³äº†ä¸å°‘çš„é—®é¢˜</p>
<h3 data-id="heading-2">åœ°å€å‘¢ï¼Ÿä¸Šé“¾æ¥ï¼</h3>
<p>è¿™å°±è´´ä¸Šé“¾æ¥å“ˆï¼Œæˆ‘ç”¨çš„æ˜¯è¿™å®¶ä¸­è½¬ API</p>
<p>å› ä¸ºä»–ä»¬å®¶æœ‰ä»˜è´¹ç”¨æˆ·ï¼Œæ‰€ä»¥ç¨³å®šæ€§éå¸¸æœ‰ä¿éšœï¼Œè¿™ä¹ˆå¤šå¤©ç”¨ä¸‹æ¥çš„ä½“éªŒå°±æ˜¯ï¼š<code>æ¨¡å‹å¾ˆå¼ºï¼ŒAPIå¾ˆç¨³ï¼Œå“åº”å¾ˆå¿«</code></p>
<p><code>https://api.code-relay.com/register?aff=seMc</code></p>
<p>ã€ç”¨ä¸Šé¢çš„é“¾æ¥æ³¨å†Œèµ é€ 30 åˆ€é¢åº¦ï¼Œæ—¥å¸¸ä½¿ç”¨ä¸¤ä¸ªç¤¼æ‹œåº”è¯¥æ˜¯å¤Ÿçš„ã€‘</p>
<p>åŒæ—¶ï¼Œä»–ä»¬å®¶ä¸å®˜æ–¹çš„ API ä»·æ ¼ç›¸æ¯”ï¼Œä¹Ÿéå¸¸ä¾¿å®œï¼Œè´´ä¸ªå›¾æ„Ÿå—ä¸€ä¸‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f3ebaf898974bac9acaa1141f227659~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6B5a6i5a-G56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766912334&amp;x-signature=TTCXvYka94qjcs8c73TECek5B3c%3D" alt="ä»·æ ¼" loading="lazy"/></p>
<p>å†è¯´å›æ ‡é¢˜ç™½å«–çš„äº‹å„¿ï¼Œå…¶å®é€šè¿‡é‚€è¯·é“¾æ¥æ³¨å†Œé™¤äº†ç»™è¢«é‚€è¯·çš„æ–°ç”¨æˆ·èµ é€çš„ 30 åˆ€ï¼Œè¿˜ä¼šç»™é‚€è¯·äººèµ é€ 25 åˆ€é¢åº¦</p>
<p>æ‰€ä»¥ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œå°±æ˜¯æ— é™ç™½å«–ï¼</p>
<p>å—¯ï¼Œæ€ä¹ˆèƒ½ä¸ç®—å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uni-appï¼Œä½ çš„æœ€ä½³vibeÂ codingæ­å­]]></title>    <link>https://juejin.cn/post/7585758163435192326</link>    <guid>https://juejin.cn/post/7585758163435192326</guid>    <pubDate>2025-12-21T07:30:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435192326" data-draft-id="7585758163435175942" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uni-appï¼Œä½ çš„æœ€ä½³vibeÂ codingæ­å­"/> <meta itemprop="keywords" content="uni-app,VibeCoding"/> <meta itemprop="datePublished" content="2025-12-21T07:30:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CHB"/> <meta itemprop="url" content="https://juejin.cn/user/3298190613284270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uni-appï¼Œä½ çš„æœ€ä½³vibeÂ codingæ­å­
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3298190613284270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CHB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T07:30:29.000Z" title="Sun Dec 21 2025 07:30:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AIå†™ä»£ç çš„èƒ½åŠ›ï¼Œåœ¨é£é€Ÿå‘å±•ã€‚</p>
<p>ä¸ŠåŠå¹´ï¼Œè¿˜æ„Ÿæ…¨äºAIåœ¨IDEé‡ŒçŒœä½ è¦å†™çš„ä»£ç è¶Šæ¥è¶Šå‡†ï¼Œä¸‹åŠå¹´çªç„¶å‘ç°æ²¡å¿…è¦è®©AIçŒœäº†ï¼ŒAIÂ Chatå·²ç»å¯ä»¥vibeÂ codingäº†ã€‚</p>
<p>åªè¦æŠŠéœ€æ±‚ç»™AIå†™æ¸…æ¥šï¼Œå¥½çš„AIå·²ç»å¯ä»¥æå®šå¸¸è§„ä¸šåŠ¡ä»£ç äº†ï¼Œå°¤å…¶æ˜¯webå¹³å°ã€‚ä¸€äº›åº“çš„ç¿»è¯‘ã€èƒ¶æ°´ä»£ç ç”Ÿæˆï¼Œä¹Ÿç‰¹åˆ«çš„æ–¹ä¾¿ã€‚</p>
<ul>
<li>ç•¥æ‡‚æŠ€æœ¯çš„äº§å“ç»ç†å’Œè¿è¥ï¼Œç°åœ¨å¯ä»¥å®Œæˆç®€å•åº”ç”¨äº†ã€‚</li>
<li>åªæ‡‚1é—¨æŠ€æœ¯çš„å·¥ç¨‹å¸ˆï¼Œç°åœ¨å¯ä»¥å˜æˆå…¨æ ˆäº†ã€‚</li>
</ul>
<p>å½“ç„¶åœ¨vibeÂ codingè¿™ä¸ªæ–°æ—¶ä»£ï¼Œå¼€å‘è€…ä»¬æœ‰äº†æ–°çš„ç—›ç‚¹ï¼Œéœ€è¦æ–°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">1ã€è™½ç„¶90%å¯ä»¥vibeï¼Œå‰©ä¸‹çš„10%ä¼šå¡ä½ å•†ç”¨</h2>
<p>vibeÂ codingå°±æ˜¯ä½ æ— éœ€å…³æ³¨ä»£ç å†™çš„å…·ä½“æ˜¯ä»€ä¹ˆï¼Œä½ å†™éœ€æ±‚æŒ‡æŒ¥AIå°±å¥½äº†ã€‚</p>
<p>åœ¨åšåŸå‹æ—¶ï¼Œè¿™å‡ ä¹æ²¡æœ‰é—®é¢˜äº†ã€‚</p>
<p>ä½†å¦‚æœçœŸçš„è¦å•†ç”¨ä¸Šçº¿ä¸€ä¸ªåº”ç”¨ï¼Œä½ ä¼šåœ¨å’ŒAIäº¤é”‹æ•°è½®ä»ä¸è¾¾é¢„æœŸåï¼Œæ˜ç™½ä¸€ä¸ªé“ç†ï¼Œè¿˜æ˜¯å¾—èƒ½çœ‹æ‡‚AIå†™çš„ä»£ç ã€‚</p>
<p>è¿™æ—¶æŠ€æœ¯æ ˆçš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27bfc655242e46b68cc551bf19ba8028~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=hHp8SmJFMVUwd82etN4KvFEYQsw%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœå½“åˆå¼€å§‹vibeÂ codingæ—¶ï¼Œä¸æŒ‡å®šæŠ€æœ¯æ ˆï¼ŒAIé«˜æ¦‚ç‡ä¼šç»™ä½ ç”ŸæˆåŸºäºreactæ¡†æ¶çš„ä»£ç ï¼Œæˆ–è€…åšAppçš„è¯ä½¿ç”¨å„å¹³å°çš„åŸç”Ÿç¼–ç¨‹è¯­è¨€ã€‚</p>
<p>å› ä¸ºåœ¨ç¾å›½é‚£è¾¹ï¼Œæœ€æµè¡Œçš„æ¡†æ¶ç¡®å®æ˜¯reactï¼Œè€Œä¸æ˜¯æ˜“ç”¨æ€§æ›´é«˜çš„vueã€‚</p>
<p>ä½†å­¦ä¹ reactéœ€è¦æ›´é«˜çš„é—¨æ§›ï¼Œæ‹›è˜ç›¸åº”çš„ç»´æŠ¤å·¥ç¨‹å¸ˆä¹Ÿæ›´æ˜‚è´µã€‚åœ¨ä¸­å›½æ›´å¹¿æ³›çš„æ˜¯vueã€‚</p>
<p>å¦‚æœåœ¨åšappæ—¶ï¼Œaiç»™ä½ ç”Ÿæˆäº†å„ä¸ªå¹³å°çš„åŸç”Ÿè¯­è¨€ï¼Œé‚£å­¦ä¹ å’Œç»´æŠ¤æ›´æ˜¯å™©æ¢¦ã€‚</p>
<p>æ‰€ä»¥ï¼Œuni-appçš„æ˜“ç”¨æ€§ã€å¤šç«¯1å¥—ä»£ç çš„ä¼˜åŠ¿å°±éå¸¸æ˜æ˜¾äº†ã€‚</p>
<p>ä½ åªéœ€è¦äº†è§£æœ€ç®€å•çš„ç¼–ç¨‹è¯­è¨€jsã€æœ€ç®€å•çš„å“åº”å¼æ¡†æ¶vueï¼Œå°±èƒ½æå®šé‚£AIæä¸å®šçš„10%ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/535526844fda427dba6a8d48fc824954~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=9pQ1D3CCLCrNQXoK2UunlBU%2F6YE%3D" alt="uni-multiply.png" loading="lazy"/></p>
<h2 data-id="heading-1">2ã€è™½ç„¶ä»£ç å¯ä»¥è®©AIç”Ÿæˆï¼Œä½†æœåŠ¡å™¨éƒ¨ç½²è¿ç»´ä¼šå¡ä½ å•†ç”¨</h2>
<p>å½“ä½ å…´å¥‹åœ°ç”¨AIå†™å¥½ä»£ç åï¼Œçªç„¶å‘ç°è‡ªå·±ä¸æ‡‚æœåŠ¡å™¨ã€‚æ€ä¹ˆè´­ä¹°ï¼Ÿæ€ä¹ˆéƒ¨ç½²ï¼Ÿæ€ä¹ˆè¿ç»´ï¼Ÿæ•°æ®é‡ä¸Šæ¥åæ€ä¹ˆæ‰©å®¹ï¼Ÿè¢«æ”»å‡»æ—¶æ€ä¹ˆé˜²æŠ¤ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f0e4782041a4cc0b2e75bb2021d8263~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=VaHLggp08Ic45ru0L6xNIgAzRU0%3D" alt="image.png" loading="lazy"/></p>
<p>å…¶å®uniCloudå°±æ˜¯ä¸“é—¨è§£å†³è¿™ç±»é—®é¢˜çš„ã€‚uniCloudæ˜¯ä¸€ä¸ªåŸºäºjsçš„serverlessäº‘æœåŠ¡ï¼Œè®©äº‘èµ„æºåƒç”¨ç”µä¸€æ ·æ–¹ä¾¿ï¼Œå®ƒè‡ªåŠ¨å¤„ç†ä¼¸ç¼©æ‰©å®¹ã€è‡ªåŠ¨å¤„ç†å®‰å…¨é˜²æŠ¤ã€‚å®ƒæ˜¯æ— å¯äº‰è®®çš„æœ€ç®€å•çš„äº‘èµ„æºä½¿ç”¨æ–¹æ¡ˆã€‚</p>
<p>ä½†æ˜¯å¦‚æœåœ¨å¼€å§‹vibeÂ codingæ—¶æ²¡é€‰å¥½æŠ€æœ¯æ ˆï¼ŒAIå†™ä¸‹äº†phpã€javaç­‰æœåŠ¡å™¨ä»£ç ï¼Œé‚£ä½ åœ¨å­¦ä¹ æŒæ¡å’Œè¿ç»´æ–¹é¢éƒ½ä¼šå¤´ç–¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1f9572958bf4a0197a0a0d28ab7923e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=lyGxHx%2FMFiGXBT0cdtN%2BorLFpqI%3D" alt="image.png" loading="lazy"/></p>
<p>è€Œuni-appÂ å’ŒÂ uniCloudï¼Œäº’ç›¸æ­é…æ•ˆæœæ›´ä½³ã€‚ä¸€é—¨jsè¯­è¨€ï¼Œè§£å†³å…¨éƒ¨å®¢æˆ·ç«¯ï¼Œä»¥åŠæœåŠ¡å™¨ã€‚</p>
<p>æ‰€ä»¥vibeÂ codingçš„æ—¶å€™ï¼Œä¸€å®šè¦è®°å¾—å…ˆå‘Šè¯‰AIï¼šå®¢æˆ·ç«¯æ¡†æ¶é€‰ç”¨uni-appï¼ŒæœåŠ¡å™¨æ¡†æ¶é€‰ç”¨uniCloudã€‚</p>
<h2 data-id="heading-2">2ã€é¸¿è’™Appçš„å¼€å‘å¥½ä¼´ä¾£</h2>
<p>é¸¿è’™Appä½¿ç”¨ArkTSå¼€å‘ï¼Œè€Œå›½å¤–ä¼˜ç§€çš„AIÂ Codingå·¥å…·ï¼Œéƒ½ä¸å¤ªæ“…é•¿é¸¿è’™å¼€å‘ã€‚</p>
<p>ä½†æ¯ä¸ªAIï¼Œéƒ½æ“…é•¿uni-appå¼€å‘ã€‚è€Œuni-appå¯ä»¥ä¸€å¥—ä»£ç ç›´æ¥ç¼–è¯‘åˆ°é¸¿è’™ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a168b98095a4252ac0e6daf22158bd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=75MXN%2Fr0%2BK8zeAO6BNWsL%2BI1HUs%3D" alt="image" loading="lazy"/></p>
<p>è¿™å¯¼è‡´ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼Œuni-appæˆä¸ºäº†é¸¿è’™çš„AIå¼€å‘æœ€ä½³ä¼´ä¾£ã€‚å®é™…ä¸Šï¼Œé¸¿è’™åº”ç”¨å•†åº—ä¸­ï¼Œuni-appå·²ç»æˆä¸ºè´¡çŒ®åº”ç”¨æ•°é‡æœ€å¤šçš„è·¨å¹³å°å¼€å‘æ¡†æ¶ã€‚</p>
<h2 data-id="heading-3">4ã€å…¨æµç¨‹AIè‡ªåŠ¨åŒ–</h2>
<p>AIå†™å¥½ä»£ç ï¼Œèƒ½è‡ªåŠ¨è¿è¡Œã€æå–æ‰‹æœºæ—¥å¿—ã€æŸ¥æŠ¥é”™ã€ç„¶åè‡ªä¿®å¤å—ï¼Ÿ</p>
<p>AIèƒ½è‡ªåŠ¨å†™è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬å¹¶æ‰§è¡Œå—ï¼Ÿ</p>
<p>è¿™äº›é«˜è‡ªåŠ¨åŒ–åœºæ™¯ï¼Œuni-appÂ å·²é€šè¿‡ä¸°å¯Œçš„Â MCPÂ åè®®ä¸Â CLIÂ å‘½ä»¤å®ç°Â â€”Â AIÂ å¯ç›´æ¥è°ƒç”¨ï¼Œå…¨æµç¨‹æ— éœ€æ‰‹åŠ¨ä»‹å…¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25cf2ac8b72142b88ef293de2be6e5e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ0hC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766907029&amp;x-signature=vKKGhM%2BFuXjpPUUEGxc0nrY%2BNcw%3D" alt="image.png" loading="lazy"/></p>
<p>è¿‡å»ï¼Œå¤§é‡å¼€å‘è€…é™·å…¥ä½æ•ˆå¼€å‘å¾ªç¯ï¼šé¢‘ç¹åœ¨IDEã€æµè§ˆå™¨æ§åˆ¶å°ã€AIå·¥å…·é—´åˆ‡æ¢ï¼Œé‡å¤æ‰§è¡Œâ€œæ”¹ä»£ç â†’æŸ¥æ—¥å¿—â†’ç²˜è´´è‡³AIâ€çš„æœºæ¢°æ“ä½œï¼Œæ—¢æ¯ç‡¥åˆæåº¦è€—æ—¶ï¼</p>
<p>å¦‚ä»Šï¼ŒHBuilderXÂ CLIÂ å½»åº•ç»ˆç»“è¿™ä¸€ä½æ•ˆæ¨¡å¼ï¼šæ—¥å¿—è‡ªåŠ¨æå–å’Œåˆ†æï¼ŒAIå®æ—¶æŒæ¡é¡¹ç›®å…¨é‡ä¸Šä¸‹æ–‡ï¼Œå¼€å‘è¿­ä»£æ•ˆç‡ç›´æ¥ç¿»å€ï¼</p>
<p>å°¤å…¶æ˜¯åœ¨utså¼€å‘ä¸­ï¼Œç”±äºå¼ºç±»å‹çº¦æŸé€ æˆå¾ˆå¤šå†å²ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p>
<p>æœ‰äº†å…¨è‡ªåŠ¨ï¼Œå°±å¯ä»¥è®©AIæ¥æŠŠä¼ ç»Ÿçš„js/tsÂ ä»£ç è½¬æ¢ä¸ºutsä»£ç äº†ã€‚</p>
<h3 data-id="heading-4">è‡ªåŠ¨åˆ†ææ—¥å¿—ã€è‡ªåŠ¨ä¿®å¤æŠ¥é”™</h3>
<ol>
<li>
<p>åœ¨HBuilderXä¸­æ–°å»ºuni-appé¡¹ç›®</p>
</li>
<li>
<p>å°†é¡¹ç›®å…ˆè¿è¡Œèµ·æ¥ï¼Œæ¯”å¦‚è¿è¡Œåˆ°æµè§ˆå™¨ã€å°ç¨‹åºæˆ–App</p>
</li>
<li>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨AIäº¤äº’ç»ˆç«¯ï¼Œç¡®ä¿AIå¯è·å–é¡¹ç›®å…¨é‡ä¸Šä¸‹æ–‡ï¼›</p>
</li>
<li>
<p>å‘AIå‘é€æŒ‡ä»¤ï¼Œå®ŒæˆWebç«¯åŠŸèƒ½å¼€å‘ä¸æ—¥å¿—æ ¡éªŒï¼Œä¾‹å¦‚ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">è¯·åœ¨ /pages/index/index.vue å®ç°å•†å“åˆ—è¡¨åŠŸèƒ½ï¼Œ
å®Œæˆåæ‰§è¡ŒHBuilderX CLIå‘½ä»¤è·å–æ—¥å¿—ï¼Œ 
`C:\hbuilderx\hx_alpha\cli.exe logcat web --browser Chrome --project yourprojectname`ã€‚
è‹¥æ£€æµ‹åˆ°æ—¥å¿—æŠ¥é”™ï¼Œè¯·æ ¹æ®æŠ¥é”™è‡ªåŠ¨ä¿®å¤ï¼Œ
ä¿®å¤åé‡æ–°è¯»å–æ—¥å¿—ï¼Œå¾ªç¯è¿­ä»£ä¼˜åŒ–ç›´è‡³æ²¡æœ‰æŠ¥é”™ã€‚
</code></pre>
<p>ä»¥ä¸Šcliå‘½ä»¤çš„ç”¨æ³•è¯¦è§æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhx.dcloud.net.cn%2Fcli%2Flogcat-web" target="_blank" title="https://hx.dcloud.net.cn/cli/logcat-web" ref="nofollow noopener noreferrer">hx.dcloud.net.cn/cli/logcat-â€¦</a></p>
<p>å®é™…å¼€å‘ä¸­ï¼Œå¯ä»¥æŠŠå„ç§è¿è¡Œå‘½ä»¤æ•´ç†åˆ°package.jsonä¸­ï¼Œ</p>
<p>åœ¨utså¼€å‘ä¸­ï¼Œè‡ªä¿®å¤è¿™ä¸ªåŠŸèƒ½å°¤å…¶æ–¹ä¾¿ã€‚</p>
<p>æŠŠutså’Œtsçš„å‡ åæ¡å·®å¼‚å‘ç»™AIï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.dcloud.net.cn%2Funi-app-x%2Futs%2Futs_diff_ts.html" target="_blank" title="https://doc.dcloud.net.cn/uni-app-x/uts/uts_diff_ts.html" ref="nofollow noopener noreferrer">doc.dcloud.net.cn/uni-app-x/uâ€¦</a>ï¼›ç„¶åè®©AIè‡ªåŠ¨æå–Androidå¹³å°çš„æ—¥å¿—è¿›è¡Œè‡ªä¿®å¤ã€‚ä½ å°±å¯ä»¥å–ç€å’–å•¡åç­‰AIæŠŠjs/tsè½¬æ¢ä¸ºutsäº†ã€‚</p>
<h3 data-id="heading-5">æˆªå›¾å¯¹æ¯”ä¸è‡ªåŠ¨åŒ–æµ‹è¯•</h3>
<p>è‹¥ä»…é æ—¥å¿—æ— æ³•å®šä½ç•Œé¢é—®é¢˜ï¼Œå¯é€šè¿‡â€œuni-appè‡ªåŠ¨åŒ–æµ‹è¯•æ’ä»¶â€å®ç°æˆªå›¾å¯¹æ¯”ä¸å…¨é‡æµ‹è¯•ï¼š</p>
<ol>
<li>
<p>æ’ä»¶å®‰è£…ï¼šåœ¨æ’ä»¶å¸‚åœºæœç´¢â€œuni-appè‡ªåŠ¨åŒ–æµ‹è¯•æ’ä»¶â€ï¼Œç‚¹å‡»å¯¼å…¥å³å¯å®Œæˆå®‰è£…ï¼›</p>
</li>
<li>
<p>å‘AIå‘é€æŒ‡ä»¤ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">è¯·åŸºäºä»¥ä¸‹è§„èŒƒï¼Œå®ç°æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆã€Web/Android/iOSå¤šç«¯æµ‹è¯•æ‰§è¡Œï¼Œ
å¹¶æ”¯æŒå…¨æµç¨‹è¿­ä»£ä¼˜åŒ–â€”â€”æµ‹è¯•åè‡ªåŠ¨è¿”å›å«æœªé€šè¿‡ç”¨ä¾‹æ ‡æ³¨çš„æŠ¥å‘Šï¼Œ
æŒç»­ä¼˜åŒ–ä»£ç ç›´è‡³æ‰€æœ‰ç”¨ä¾‹å…¨éƒ¨é€šè¿‡ï¼š
1. é¡µé¢æ·±åº¦åˆ†æï¼š
   ç²¾å‡†æå–ç»„ä»¶/äº‹ä»¶ã€äº¤äº’æµç¨‹ã€APIè°ƒç”¨é€»è¾‘åŠè¾“å…¥è¾“å‡ºå…³é”®èŠ‚ç‚¹ï¼›
2. å…¨é¢æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆï¼š
   è¦†ç›–åŠŸèƒ½æµ‹è¯•ã€æ¸²æŸ“æ•ˆæœéªŒè¯ã€APIæ¥å£æµ‹è¯•ã€è¾¹ç•Œåœºæ™¯éªŒè¯åŠé¡µé¢è·³è½¬é€»è¾‘æµ‹è¯•ï¼›
3. æ ‡å‡†åŒ–æ‰§è¡Œè§„èŒƒï¼š
   æµ‹è¯•æ–‡ä»¶ç»Ÿä¸€å‘½åä¸º *.test.jsï¼ˆéœ€ä¸å¯¹åº”é¡µé¢æ–‡ä»¶åŒçº§å­˜æ”¾ï¼‰ï¼Œä¸¥æ ¼éµå¾ªJestè¯­æ³•è§„èŒƒï¼Œç¡®ä¿å„æµ‹è¯•ç”¨ä¾‹ç›¸äº’ç‹¬ç«‹ã€æ— ä¾èµ–ï¼›
4. å¤šç«¯æµ‹è¯•è¿è¡Œå‘½ä»¤ï¼š
   - Webç«¯æµ‹è¯•ï¼šnpm run test:web -- --browser æµè§ˆå™¨åï¼›
   - Androidç«¯æµ‹è¯•ï¼šnpm run test:app-androidï¼›
   - iOSç«¯æµ‹è¯•ï¼šnpm run test:app-ios
</code></pre>
<p>æ— éœ€æ‰‹åŠ¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹ã€åå¤è°ƒè¯•ä»£ç ï¼ç”¨AIå®ç°è·¨ç«¯æµ‹è¯•å…¨è‡ªåŠ¨åŒ–ï¼Œå°†ç²¾åŠ›èšç„¦æ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼Œè®©è·¨ç«¯æµ‹è¯•é«˜æ•ˆåˆçœå¿ƒï¼Œå³åˆ»ä½“éªŒï¼</p>
<h2 data-id="heading-6">5ã€æ€»ç»“ï¼š</h2>
<p>AIæ˜¯é«˜æ•ˆçš„â€œä»£ç ç”Ÿæˆå™¨â€ï¼Œä½†ä¸æ˜¯â€œå¤šç«¯å¼€å‘è§£å†³æ–¹æ¡ˆâ€ã€‚ä¸åº”è¯¥ç”¨AIæŠŠtsä»£ç ç¼–è¯‘ä¸ºjsï¼Œå› ä¸ºtsç¼–è¯‘å™¨æ‰æ˜¯ä¸“ä¸šç¨³å®šåšè¿™äº‹çš„è§’è‰²ã€‚</p>
<p>AIçš„æ™ºèƒ½æ­é…ä¸“ä¸šè·¨å¹³å°å·¥å…·ï¼Œæ‰èƒ½æœ€å¤§åŒ–å¼€å‘è€…çš„æŠ•å…¥äº§å‡ºæ¯”ã€‚</p>
<p>uni-appÂ å’ŒÂ uniCloudï¼Œä¼šæˆä¸ºä½ vibeÂ codingçš„æœ€ä½³ä¼™ä¼´ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Netty + Sa-Token å®ç° WebSocket æ¡æ‰‹è®¤è¯]]></title>    <link>https://juejin.cn/post/7585490245006950406</link>    <guid>https://juejin.cn/post/7585490245006950406</guid>    <pubDate>2025-12-21T03:14:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585490245006950406" data-draft-id="7585490245006934022" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Netty + Sa-Token å®ç° WebSocket æ¡æ‰‹è®¤è¯"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-21T03:14:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Charlie_Byte"/> <meta itemprop="url" content="https://juejin.cn/user/1968540037686224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Netty + Sa-Token å®ç° WebSocket æ¡æ‰‹è®¤è¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1968540037686224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Charlie_Byte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T03:14:23.000Z" title="Sun Dec 21 2025 03:14:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è®¤è¯æ—¶æœºï¼šHTTP æ¡æ‰‹é˜¶æ®µ</h2>
<p>é¦–å…ˆäº†è§£ï¼ŒWebSocket è¿æ¥å»ºç«‹å‰ï¼Œå®¢æˆ·ç«¯ä¼šå…ˆå‘èµ·ä¸€ä¸ª <strong>HTTP Upgrade è¯·æ±‚</strong>ï¼ˆæ¡æ‰‹ï¼‰ã€‚æ­¤æ—¶è¿æ¥ä»æ˜¯ HTTP åè®®ï¼Œå¯ä»¥æºå¸¦ Cookieã€Header æˆ– Query å‚æ•°ã€‚</p>
<blockquote>
<p>å…³é”®ç‚¹æ¥äº†ï¼š<strong>è®¤è¯å¯ä»¥åœ¨è¿™ä¸€æ­¥æå®š</strong>ï¼<br/>
ä¸€æ—¦æ¡æ‰‹æˆåŠŸã€åè®®å‡çº§æˆ WebSocketï¼Œåé¢å°±æ²¡æ³•å†ç”¨ HTTP é‚£å¥—é‰´æƒæ–¹å¼äº†ã€‚æ‰€ä»¥å¯ä»¥å°±å¾—è¶è¿™ä¸ªâ€œçª—å£æœŸâ€ï¼ŒæŠŠèº«ä»½éªŒè¯æ‹¦ä¸‹æ¥å¤„ç†ã€‚</p>
</blockquote>
<p>æœ¬æ–‡æ­£æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå®Œæˆæ‹¦æˆªå¹¶éªŒè¯æ¡æ‰‹è¯·æ±‚ã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒé€»è¾‘è§£æ</h2>
<h3 data-id="heading-2">æ‹¦æˆª FullHttpRequest</h3>
<p>Netty æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œæ‰€æœ‰è¿›æ¥çš„æ•°æ®éƒ½èµ° <code>channelRead</code>ã€‚ä½†æˆ‘ä»¬åªå…³å¿ƒå®Œæ•´çš„ HTTP è¯·æ±‚ï¼ˆ<code>FullHttpRequest</code>ï¼‰ï¼Œåˆ«çš„æ¯”å¦‚å­—èŠ‚æµã€WebSocket å¸§å•¥çš„ï¼Œç›´æ¥å¾€åä¼ å°±è¡Œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (!(object <span class="hljs-keyword">instanceof</span> FullHttpRequest req)) {
    ctx.fireChannelRead(object);
    <span class="hljs-keyword">return</span>;
}
</code></pre>
<h3 data-id="heading-3">ä» URI ä¸­æå– Token</h3>
<p>å‰ç«¯ä¸€èˆ¬ä¼šæŠŠ Token æ”¾åœ¨æŸ¥è¯¢å‚æ•°é‡Œï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-text" lang="text">GET /ws?token=abc123xyz HTTP/1.1
</code></pre>
<p>æˆ‘ä»¬ç”¨ Hutool çš„ <code>UrlBuilder</code> è½»æ¾è§£æå‡ºæ¥ï¼Œä½†å¦‚æœæ²¡ä¼ æˆ–è€…ä¼ äº†ä¸ªç©ºçš„ï¼Œé‚£å°±ç›´æ¥æ‹’ç»ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> Optional.of(UrlBuilder.ofHttp(uri))
        .map(UrlBuilder::getQuery)
        .map(query -&gt; query.get(<span class="hljs-string">"token"</span>))
        .map(CharSequence::toString)
        .filter(StrUtil::isNotBlank)
        .orElse(<span class="hljs-literal">null</span>);
</code></pre>
<h3 data-id="heading-4">ç”¨ Sa-Token éªŒè¯ Tokenï¼Œå¹¶ç»‘å®šç”¨æˆ·</h3>
<p>å‡è®¾ä½ å·²ç»é…å¥½äº† Sa-Tokenï¼Œç”¨æˆ·ç™»å½•åè°ƒè¿‡ <code>login</code> æ–¹æ³•ï¼Œé‚£ç°åœ¨å°±å¯ä»¥åæŸ¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> (String) StpUtil.getLoginIdByToken(token);
</code></pre>
<p>å¦‚æœ Token æ— æ•ˆæˆ–è¿‡æœŸï¼ŒSa-Token ä¼šæŠ›å‡º <code>NotLoginException</code>ã€‚æ­¤æ—¶æˆ‘ä»¬è¿”å› <code>401 Unauthorized</code>ï¼Œé¡ºä¾¿å…³æ‰è¿æ¥ã€‚</p>
<p>è¦æ˜¯éªŒè¯é€šè¿‡äº†ï¼Œå°±æŠŠç”¨æˆ· ID å­˜åˆ°å½“å‰ Netty Channel çš„å±æ€§é‡Œï¼Œè¿™æ ·åé¢å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ï¼Œéšä¾¿å“ªä¸ª Handler éƒ½èƒ½æ‹¿ï¼Œè¿™å°±å®ç°äº†â€œä¸€æ¬¡è®¤è¯ï¼Œå…¨ç¨‹å¯ç”¨â€ã€‚</p>
<pre><code class="hljs language-java" lang="java">ctx.channel().attr(USER_ID_ATTR).set(userId);
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> ctx.channel().attr(WsAuthHandshakeHandler.USER_ID_ATTR).get();
</code></pre>
<h3 data-id="heading-5">æ¸…ç† URI æŸ¥è¯¢å‚æ•°</h3>
<p>WebSocket åè®®æœ‰ä¸ªå°è®²ç©¶ï¼šUpgrade è¯·æ±‚çš„è·¯å¾„æœ€å¥½å¹²å‡€ç‚¹ï¼Œåˆ«å¸¦ query stringã€‚æ¯”å¦‚ <code>/ws?token=xxx</code> åº”è¯¥å˜æˆ <code>/ws</code>ã€‚</p>
<p>ä¸ºå•¥ï¼Ÿå› ä¸ºåé¢çš„ <code>WebSocketServerProtocolHandler</code> æ˜¯é è·¯å¾„åŒ¹é…çš„ï¼Œå¸¦å‚æ•°å¯èƒ½åŒ¹é…ä¸ä¸Šã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è®¤è¯å®Œå°±æ¸…ç†ä¸€ä¸‹ï¼Œç¡®ä¿åç»­ <code>WebSocketServerProtocolHandler</code> èƒ½æ­£ç¡®åŒ¹é…è·¯ç”±</p>
<pre><code class="hljs language-java" lang="java">req.setUri(UrlBuilder.ofHttp(req.uri()).getPath().toString());
</code></pre>
<h3 data-id="heading-6">Apifox æµ‹è¯• WebSocket</h3>
<p>æƒ³çœ‹çœ‹æ•ˆæœï¼Ÿå¯ä»¥ç”¨ Apifox æ¨¡æ‹Ÿ WebSocket è¿æ¥ã€‚</p>
<p><strong>è·å–æœ‰æ•ˆ Token</strong></p>
<p>å…ˆè°ƒç”¨ä½ ç³»ç»Ÿä¸­ Sa-Token çš„ç™»å½•æ¥å£ï¼Œè·å¾—è¿”å›åçš„ Token å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-text" lang="text">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.xxxx
</code></pre>
<p><strong>æ–°å»º WebSocket è¯·æ±‚</strong></p>
<p>åœ¨ Apifox ä¸­ç‚¹å‡»æ–°å»ºè¯·æ±‚ â†’ é€‰æ‹©åè®®ç±»å‹ä¸º WebSocketï¼Œè¾“å…¥ WebSocket åœ°å€ï¼š</p>
<pre><code class="hljs language-text" lang="text">ws://localhost:8934/im?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.xxxxx
</code></pre>
<p><strong>æµ‹è¯•åœºæ™¯ä¸€ï¼šä¸å¸¦ Token</strong></p>
<p>åœ¨æœªæºå¸¦ Token çš„æƒ…å†µä¸‹å°è¯•å»ºç«‹ WebSocket è¿æ¥ï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è¿æ¥ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66ac4c3782844dc7b23e67a197ef9535~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZV9CeXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766892007&amp;x-signature=wIKEP5JZONfG1%2FdM7AJtfkkIvDI%3D" alt="Pasted image 20251221104621.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44825e5ce7e74d18acbda4562e691f4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZV9CeXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766892007&amp;x-signature=lqvPt%2FocBHhCvyQN0x%2FTzqe2l6A%3D" alt="Pasted image 20251221104641.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66ec63dfebcb401ab0e138fcd9b32a3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZV9CeXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766892007&amp;x-signature=HZBweaoN33Sxj2iDFObFHZhxOuY%3D" alt="Pasted image 20251221104659.png" loading="lazy"/></p>
<p><strong>æµ‹è¯•åœºæ™¯äºŒï¼šå¸¦ä¸Šæœ‰æ•ˆ Token</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03be29299f48499ca3626668071849dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZV9CeXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766892007&amp;x-signature=rILCUHqnmK91zMeNUCUcQuN%2BgNQ%3D" alt="Pasted image 20251221104737.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c285eb599e604e6089578442a8dc47f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZV9CeXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766892007&amp;x-signature=oejdxDJB8jSs5iVk4LdLNuwWo2s%3D" alt="Pasted image 20251221105032.png" loading="lazy"/></p>
<h2 data-id="heading-7">å®Œæ•´ä»£ç </h2>
<blockquote>
<p>å¸¦æ³¨é‡Šï¼Œæ”¾å¿ƒæŠ„</p>
</blockquote>
<h3 data-id="heading-8">WsAuthHandshakeHandler.java</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> io.jiangbyte.app.handler;

<span class="hljs-keyword">import</span> cn.dev33.satoken.exception.NotLoginException;
<span class="hljs-keyword">import</span> cn.dev33.satoken.stp.StpUtil;
<span class="hljs-keyword">import</span> cn.hutool.core.net.url.UrlBuilder;
<span class="hljs-keyword">import</span> cn.hutool.core.util.StrUtil;
<span class="hljs-keyword">import</span> io.jiangbyte.app.constant.ChannelAttrKey;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelHandlerContext;
<span class="hljs-keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;
<span class="hljs-keyword">import</span> io.netty.handler.codec.http.*;
<span class="hljs-keyword">import</span> io.netty.util.AttributeKey;
<span class="hljs-keyword">import</span> lombok.RequiredArgsConstructor;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Scope;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-keyword">import</span> java.util.Optional;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span> Charlie
 * <span class="hljs-doctag">@version</span> v1.0
 * <span class="hljs-doctag">@date</span> 19/12/2025
 * <span class="hljs-doctag">@description</span> WebSocket æ¡æ‰‹è®¤è¯å¤„ç†å™¨
 * åœ¨ WebSocket åè®®å‡çº§å‰ï¼ˆå³ HTTP æ¡æ‰‹é˜¶æ®µï¼‰ï¼ŒéªŒè¯å®¢æˆ·ç«¯æºå¸¦çš„ token æ˜¯å¦åˆæ³•
 * å¹¶å°†è®¤è¯é€šè¿‡çš„ç”¨æˆ· ID ç»‘å®šåˆ°å½“å‰ Channel ä¸Šï¼Œä¾›åç»­ WebSocket é€šä¿¡ä½¿ç”¨
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WsAuthHandshakeHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ª AttributeKeyï¼Œç”¨äºåœ¨ Netty Channel ä¸Šå­˜å‚¨ç”¨æˆ· ID</span>
    <span class="hljs-comment">// åç»­çš„ Handler æˆ–ä¸šåŠ¡é€»è¾‘å¯ä»¥é€šè¿‡ ctx.channel().attr(USER_ID_ATTR).get() è·å–ç”¨æˆ·èº«ä»½</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AttributeKey&lt;String&gt; USER_ID_ATTR = AttributeKey.valueOf(<span class="hljs-string">"USER_ID"</span>);


    <span class="hljs-comment">/**
     * é‡å†™ ChannelInboundHandlerAdapter çš„ channelRead æ–¹æ³•
     * å¤„ç†å…¥ç«™çš„ HTTP è¯·æ±‚ï¼ˆWebSocket æ¡æ‰‹è¯·æ±‚ï¼‰
     *
     * <span class="hljs-doctag">@param</span> ctx    Channel ä¸Šä¸‹æ–‡ï¼Œç”¨äºæ“ä½œ Channelï¼ˆå¦‚å†™å›å“åº”ã€å…³é—­è¿æ¥ç­‰ï¼‰
     * <span class="hljs-doctag">@param</span> object å…¥ç«™çš„æ•°æ®å¯¹è±¡
     * <span class="hljs-doctag">@throws</span> Exception æŠ›å‡ºå¼‚å¸¸æ—¶ Netty ä¼šè§¦å‘å¼‚å¸¸å¤„ç†æµç¨‹
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object object)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// åˆ¤æ–­æ¥æ”¶åˆ°çš„å¯¹è±¡æ˜¯å¦æ˜¯ FullHttpRequestï¼ˆå®Œæ•´çš„ HTTP è¯·æ±‚ï¼‰</span>
        <span class="hljs-comment">// å¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ª Handler å¤„ç†</span>
        <span class="hljs-keyword">if</span> (!(object <span class="hljs-keyword">instanceof</span> FullHttpRequest req)) {
            ctx.fireChannelRead(object); <span class="hljs-comment">// ç»§ç»­å‘åä¼ é€’äº‹ä»¶</span>
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// è·å–è¯·æ±‚çš„å®Œæ•´ URIï¼ˆåŒ…å«è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°ï¼Œå¦‚ /ws?token=abc123ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> req.uri();
        <span class="hljs-comment">// è·å–å®¢æˆ·ç«¯çš„è¿œç¨‹åœ°å€ï¼ˆIP:Portï¼‰ï¼Œè‹¥æ— æ³•è·å–åˆ™é»˜è®¤ä¸º "unknown"</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">remoteAddr</span> <span class="hljs-operator">=</span> Optional.ofNullable(ctx.channel().remoteAddress()).map(Object::toString).orElse(<span class="hljs-string">"unknown"</span>);

        <span class="hljs-comment">// ä» URI ä¸­æå– token å‚æ•°ï¼š</span>
        <span class="hljs-comment">// 1. ä½¿ç”¨ Hutool çš„ UrlBuilder è§£æ HTTP URL</span>
        <span class="hljs-comment">// 2. è·å–æŸ¥è¯¢å‚æ•°ï¼ˆquery stringï¼‰</span>
        <span class="hljs-comment">// 3. ä»ä¸­å–å‡º "token" å‚æ•°å€¼</span>
        <span class="hljs-comment">// 4. è½¬ä¸ºå­—ç¬¦ä¸²å¹¶è¿‡æ»¤æ‰ç©ºç™½å€¼</span>
        <span class="hljs-comment">// 5. è‹¥ä¸å­˜åœ¨æœ‰æ•ˆ tokenï¼Œåˆ™è¿”å› null</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> Optional.of(UrlBuilder.ofHttp(uri))
                .map(UrlBuilder::getQuery)          <span class="hljs-comment">// è·å– Query å¯¹è±¡</span>
                .map(query -&gt; query.get(<span class="hljs-string">"token"</span>))   <span class="hljs-comment">// è·å– token å‚æ•°å€¼ï¼ˆå¯èƒ½ä¸º nullï¼‰</span>
                .map(CharSequence::toString)        <span class="hljs-comment">// è½¬ä¸º String</span>
                .filter(StrUtil::isNotBlank)        <span class="hljs-comment">// è¿‡æ»¤æ‰ null æˆ–ç©ºç™½å­—ç¬¦ä¸²</span>
                .orElse(<span class="hljs-literal">null</span>);

        <span class="hljs-comment">// å¦‚æœ token ä¸ºç©ºæˆ–ç©ºç™½ï¼Œè®°å½•è­¦å‘Šæ—¥å¿—å¹¶è¿”å› 401 æœªæˆæƒå“åº”</span>
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(token)) {
            log.warn(<span class="hljs-string">"ws_auth_fail reason='missing_token' remote_addr={} uri={}"</span>, mask(remoteAddr), mask(uri));
            unauthorized(ctx);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä½¿ç”¨ Sa-Token æ ¹æ® token è·å–å¯¹åº”çš„ç™»å½•ç”¨æˆ· ID</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> (String) StpUtil.getLoginIdByToken(token);

            log.info(<span class="hljs-string">"ws_auth_success user_id={} token_prefix={} remote_addr={} uri={}"</span>, userId, mask(token), mask(remoteAddr), mask(uri));

            <span class="hljs-comment">// å°†ç”¨æˆ· ID ç»‘å®šåˆ°å½“å‰ Channel çš„å±æ€§ä¸­ï¼Œä¾›åç»­ Handler ä½¿ç”¨</span>
            ctx.channel().attr(USER_ID_ATTR).set(userId);

            <span class="hljs-comment">// æ¸…é™¤ URI ä¸­çš„æŸ¥è¯¢å‚æ•°ï¼ˆåªä¿ç•™è·¯å¾„ï¼‰ï¼Œå› ä¸º WebSocket åè®®å‡çº§æ—¶ä¸éœ€è¦ query string</span>
            <span class="hljs-comment">// egï¼š/ws?token=abc â†’ /ws</span>
            req.setUri(UrlBuilder.ofHttp(req.uri()).getPath().toString());
        } <span class="hljs-keyword">catch</span> (NotLoginException e) {
            <span class="hljs-comment">// å¦‚æœ token æ— æ•ˆã€è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼ŒSa-Token ä¼šæŠ›å‡º NotLoginException</span>
            log.warn(<span class="hljs-string">"ws_auth_fail reason='invalid_or_expired_token' remote_addr={} uri={}"</span>, mask(remoteAddr), mask(uri));
            unauthorized(ctx);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// è®¤è¯é€šè¿‡ï¼Œç»§ç»­å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ª Handlerï¼ˆé€šå¸¸æ˜¯ WebSocketServerProtocolHandlerï¼‰</span>
        ctx.fireChannelRead(object);
    }

    <span class="hljs-comment">/**
     * å¯¹ token è¿›è¡Œè„±æ•å¤„ç†ï¼Œé˜²æ­¢æ•æ„Ÿä¿¡æ¯æ³„éœ²åˆ°æ—¥å¿—ä¸­
     * è§„åˆ™ï¼šä¿ç•™å‰6ä¸ªå­—ç¬¦ï¼Œå…¶ä½™ç”¨ "***" æ›¿ä»£
     *
     * <span class="hljs-doctag">@param</span> token åŸå§‹ token å­—ç¬¦ä¸²
     * <span class="hljs-doctag">@return</span> è„±æ•åçš„å­—ç¬¦ä¸²ï¼Œå¦‚ "abc123***"
     */</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">mask</span><span class="hljs-params">(String token)</span> {
        <span class="hljs-comment">// å¦‚æœ token ä¸º null æˆ–é•¿åº¦ â‰¤6ï¼Œç›´æ¥è¿”å›ï¼ˆnull è¿”å› "null" å­—ç¬¦ä¸²ï¼Œé¿å… NPEï¼‰</span>
        <span class="hljs-keyword">if</span> (token == <span class="hljs-literal">null</span> || token.length() &lt;= <span class="hljs-number">6</span>) {
            <span class="hljs-keyword">return</span> StrUtil.isBlank(token) ? <span class="hljs-string">"null"</span> : token;
        }
        <span class="hljs-comment">// æˆªå–å‰6ä½ + "***"</span>
        <span class="hljs-keyword">return</span> token.substring(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>) + <span class="hljs-string">"***"</span>;
    }

    <span class="hljs-comment">/**
     * å‘å®¢æˆ·ç«¯å‘é€ HTTP 401 Unauthorized å“åº”ï¼Œå¹¶å…³é—­è¿æ¥
     *
     * <span class="hljs-doctag">@param</span> ctx Channel ä¸Šä¸‹æ–‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unauthorized</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> {
        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª HTTP/1.1 401 å“åº”ï¼Œbody ä¸ºç©º</span>
        <span class="hljs-type">FullHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultFullHttpResponse</span>(HttpVersion.HTTP_1_1, HttpResponseStatus.UNAUTHORIZED);
        <span class="hljs-comment">// è®¾ç½®å“åº”å¤´ï¼šContent-Length ä¸º 0ï¼ŒConnection ä¸º closeï¼ˆç«‹å³å…³é—­è¿æ¥ï¼‰</span>
        response.headers()
                .setInt(HttpHeaderNames.CONTENT_LENGTH, <span class="hljs-number">0</span>)
                .set(HttpHeaderNames.CONNECTION, <span class="hljs-string">"close"</span>);
        <span class="hljs-comment">// å°†å“åº”å†™å…¥å¹¶åˆ·å‡ºåˆ°å®¢æˆ·ç«¯ï¼Œå®Œæˆåå…³é—­ Channel</span>
        ctx.writeAndFlush(response).addListener(future -&gt; ctx.channel().close());
    }
}

</code></pre>
<h3 data-id="heading-9">Netty æœåŠ¡ç«¯é…ç½®ï¼ˆå…³é”®éƒ¨åˆ†ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
bootstrap.group(bossGroup, workerGroup)
		.channel(NioServerSocketChannel.class)
		.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;Channel&gt;() {
			<span class="hljs-meta">@Override</span>
			<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(Channel ch)</span> {
				<span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> ch.pipeline();
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IdleStateHandler</span>(<span class="hljs-number">60</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpServerCodec</span>());
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChunkedWriteHandler</span>());
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpObjectAggregator</span>(<span class="hljs-number">65535</span>));

				<span class="hljs-comment">// è®¤è¯æ‹¦æˆªå™¨æ”¾è¿™å„¿ï¼</span>
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WsAuthHandshakeHandler</span>());

				<span class="hljs-comment">// WebSocket åè®®å‡çº§å¤„ç†å™¨ï¼š</span>
				<span class="hljs-comment">// - è·¯å¾„ä¸º "/im"</span>
				<span class="hljs-comment">// - å­åè®®ä¸º nullï¼ˆä¸æŒ‡å®šï¼‰</span>
				<span class="hljs-comment">// - å…è®¸å‘é€ Ping/Pong å¿ƒè·³å¸§ï¼ˆtrueï¼‰</span>
				p.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerProtocolHandler</span>(props.getWs().getPath(), <span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>));

				<span class="hljs-comment">// ...</span>
			}
		})
		.option(ChannelOption.SO_BACKLOG, <span class="hljs-number">128</span>)
		.childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>