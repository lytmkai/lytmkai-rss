<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä¸æ‡‚æ±‡ç¼–çš„åç«¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„å¼€å‘]]></title>    <link>https://juejin.cn/post/7575162322240274432</link>    <guid>https://juejin.cn/post/7575162322240274432</guid>    <pubDate>2025-11-23T11:10:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575162322240274432" data-draft-id="7575112613778161698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸æ‡‚æ±‡ç¼–çš„åç«¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„å¼€å‘"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-23T11:10:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸æ‡‚æ±‡ç¼–çš„åç«¯ä¸æ˜¯ä¸€ä¸ªå¥½çš„å¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:10:30.000Z" title="Sun Nov 23 2025 11:10:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨é«˜çº§è¯­è¨€ç”šè‡³AIç”Ÿæˆä»£ç æ¨ªè¡Œçš„æ—¶ä»£ï¼Œä¸ºä½•è¿˜è¦å…³æ³¨æœ€åº•å±‚çš„æ±‡ç¼–ï¼Ÿ</p>
</blockquote>
<p>ä½œä¸ºä¸€ååç«¯å¼€å‘è€…ï¼Œæˆ‘åšå®šåœ°è®¤ä¸ºï¼š<strong>ä¸æ‡‚æ±‡ç¼–çš„ä¼˜åŒ–å°±æ˜¯çå­æ‘¸çŸ³å¤´è¿‡æ²³ï¼Œä¸ç†è§£ç³»ç»Ÿåº•å±‚æœºåˆ¶çš„å¼€å‘è€…åœ¨é¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œå°±åƒåœ¨è¿·é›¾ä¸­æ‘¸ç´¢å‰è¡Œçš„ç›²äºº</strong>ã€‚</p>
<p>è¿™ä¸ªè§‚ç‚¹æˆ–è®¸å¬èµ·æ¥æœ‰äº›æç«¯ï¼Œä½†è¯·å…è®¸æˆ‘ç”¨æ¥ä¸‹æ¥çš„å†…å®¹è¯´æœä½ ã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆæˆ‘åšæŒæ±‡ç¼–çš„é‡è¦æ€§ï¼Ÿ</h2>
<p>åœ¨æˆ‘å¤šå¹´çš„åç«¯å¼€å‘ç»å†ä¸­ï¼Œå‘ç°ä¸€ä¸ªä»¤äººæ·±æ€çš„ç°è±¡ï¼šé‚£äº›èƒ½å¤Ÿæ·±å…¥ç†è§£ç³»ç»Ÿåº•å±‚æœºåˆ¶çš„å¼€å‘è€…ï¼Œåœ¨é—®é¢˜å®šä½ã€æ€§èƒ½ä¼˜åŒ–å’Œç³»ç»Ÿè®¾è®¡æ–¹é¢å¾€å¾€æœ‰ç€<strong>é™ç»´æ‰“å‡»</strong>çš„ä¼˜åŠ¿ã€‚ä»–ä»¬ä¸ä»…çŸ¥é“é—®é¢˜æ˜¯ä»€ä¹ˆï¼Œæ›´ç†è§£<strong>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜</strong>ã€‚</p>
<p>æ±‡ç¼–è¯­è¨€ä½œä¸ºæœ€æ¥è¿‘æœºå™¨åº•å±‚çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸ºæˆ‘ä»¬æ‰“å¼€äº†ä¸€æ‰‡ç†è§£è®¡ç®—æœºæœ¬è´¨çš„çª—å£ã€‚å½“ä½ çœŸæ­£ç†è§£æ±‡ç¼–ï¼Œä½ å°±ä¼šå‘ç°ï¼š</p>
<ul>
<li><strong>é«˜çº§è¯­è¨€çš„æ‰€æœ‰é­”æ³•éƒ½æ¶ˆå¤±äº†</strong>ï¼Œå‰©ä¸‹çš„åªæœ‰å†°å†·çš„æœºå™¨æŒ‡ä»¤</li>
<li><strong>æ¯ä¸ªæŠ½è±¡èƒŒåéƒ½æœ‰å…¶ä»£ä»·</strong>ï¼Œç†è§£è¿™äº›ä»£ä»·æ‰èƒ½åšå‡ºæ˜æ™ºçš„æƒè¡¡</li>
<li><strong>æ€§èƒ½é—®é¢˜çš„æ ¹æºå¾€å¾€è—åœ¨ä½ çœ‹ä¸åˆ°çš„åº•å±‚</strong></li>
</ul>
<h2 data-id="heading-1">æ±‡ç¼–ï¼šç†è§£è®¡ç®—æœºç³»ç»Ÿçš„ç½—å¡å¡”çŸ³ç¢‘</h2>
<h3 data-id="heading-2">ä»æŠ½è±¡åˆ°ç°å®ï¼šæ­å¼€é«˜çº§è¯­è¨€çš„é¢çº±</h3>
<p>ç°ä»£åç«¯å¼€å‘å……æ–¥ç€å„ç§é«˜çº§æŠ½è±¡ï¼šJavaçš„è™šæ‹Ÿæœºã€Goçš„goroutineã€Pythonçš„è§£é‡Šå™¨ã€‚è¿™äº›æŠ½è±¡æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œä½†ä¹Ÿéšè—äº†åº•å±‚çœŸç›¸ã€‚</p>
<p><strong>ä¸ç†è§£æ±‡ç¼–çš„å¼€å‘è€…</strong>çœ‹åˆ°çš„æ˜¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åªæ˜¯ä¸€è¡Œç®€å•çš„åŠ æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p><strong>æ‡‚æ±‡ç¼–çš„å¼€å‘è€…</strong>çœ‹åˆ°çš„æ˜¯ï¼š</p>
<pre><code class="hljs language-assembly" lang="assembly">; å®é™…çš„CPUå·¥ä½œ
mov    eax, edi     ; å°†å‚æ•°aæ”¾å…¥eaxå¯„å­˜å™¨
add    eax, esi     ; å°†å‚æ•°båŠ åˆ°eax
ret                 ; è¿”å›ç»“æœ
</code></pre>
<p>è¿™ç§åº•å±‚ç†è§£è®©ä½ èƒ½å¤Ÿ<strong>é¢„æµ‹æ€§èƒ½ç‰¹å¾</strong>ã€<strong>è¯Šæ–­è¯¡å¼‚bug</strong>ã€<strong>åšå‡ºæ›´ä¼˜çš„è®¾è®¡å†³ç­–</strong>ã€‚</p>
<h2 data-id="heading-3">å®æˆ˜æ¡ˆä¾‹ï¼šæ±‡ç¼–çŸ¥è¯†å¦‚ä½•è§£å†³å®é™…é—®é¢˜</h2>
<h3 data-id="heading-4">æ¡ˆä¾‹1ï¼šé‚£ä¸ªè®©æˆ‘ä»¬åŠ ç­ä¸‰å¤©çš„æ€§èƒ½é—®é¢˜</h3>
<p>æ›¾ç»é‡åˆ°ä¸€ä¸ªGoæœåŠ¡ï¼Œåœ¨é«˜å³°æœŸCPUä½¿ç”¨ç‡å¼‚å¸¸é£™å‡ã€‚å¸¸è§„ profiling æ˜¾ç¤ºçƒ­ç‚¹åœ¨ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¸­ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ProcessBatch</span><span class="hljs-params">(items []Item)</span></span> {
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(items); i++ {
        items[i].Value = items[i].Value * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>
    }
}
</code></pre>
<p>è¡¨é¢çœ‹èµ·æ¥æ¯«æ— é—®é¢˜ã€‚ä½†é€šè¿‡æŸ¥çœ‹æ±‡ç¼–è¾“å‡ºï¼Œæˆ‘ä»¬å‘ç°å¾ªç¯ä¸­æ’å…¥äº†<strong>å¤§é‡çš„è¾¹ç•Œæ£€æŸ¥æŒ‡ä»¤</strong>ï¼Œè¿™äº›æ£€æŸ¥åœ¨å¯†é›†å¾ªç¯ä¸­ç´¯ç§¯æˆä¸ºæ˜¾è‘—å¼€é”€ã€‚è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼šä½¿ç”¨æ›´å¯é¢„æµ‹çš„è®¿é—®æ¨¡å¼ï¼Œè®©ç¼–è¯‘å™¨èƒ½å¤Ÿä¼˜åŒ–æ‰è¿™äº›æ£€æŸ¥ã€‚</p>
<p><strong>ä¸æ‡‚æ±‡ç¼–çš„å›¢é˜Ÿ</strong>å¯èƒ½ä¼šï¼šå°è¯•å„ç§ç®—æ³•ä¼˜åŒ–ï¼Œç”šè‡³è€ƒè™‘é‡å†™æœåŠ¡ã€‚
<strong>æ‡‚æ±‡ç¼–çš„å›¢é˜Ÿ</strong>ï¼šåŠå°æ—¶å®šä½é—®é¢˜ï¼Œååˆ†é’Ÿä¿®å¤ã€‚</p>
<h3 data-id="heading-5">æ¡ˆä¾‹2ï¼šç¥ç§˜çš„å†…å­˜æŸå</h3>
<p>ä¸€ä¸ªJavaæœåŠ¡å¶å°”åœ¨ç”Ÿäº§ç¯å¢ƒå´©æºƒï¼Œæ—¥å¿—åªæœ‰æ¨¡ç³Šçš„segmentation faultä¿¡æ¯ã€‚é€šè¿‡åˆ†æcore dumpçš„æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å‘ç°åœ¨æŸä¸ªJNIè°ƒç”¨ä¸­ï¼Œæ ˆæŒ‡é’ˆè¢«é”™è¯¯åœ°ä¿®æ”¹ï¼Œå¯¼è‡´å‡½æ•°è¿”å›æ—¶è·³è½¬åˆ°éæ³•åœ°å€ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// æœ‰é—®é¢˜çš„JNIä»£ç </span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL <span class="hljs-title function_">Java_MyClass_nativeMethod</span>
  <span class="hljs-params">(JNIEnv *env, jobject obj)</span> {
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">64</span>];
    <span class="hljs-comment">// æ ˆæº¢å‡ºå‘ç”Ÿåœ¨è¿™é‡Œ</span>
    some_function(buffer); 
}
</code></pre>
<p>å¯¹åº”çš„æ±‡ç¼–æ˜¾ç¤ºæ ˆå¸§åˆ†é…ä¸è¶³ï¼Œå¯¼è‡´å†…å­˜è¶Šç•Œã€‚è¿™ç§é—®é¢˜ä»Javaå±‚é¢å‡ ä¹æ— æ³•è¯Šæ–­ã€‚</p>
<h3 data-id="heading-6">æ¡ˆä¾‹3ï¼šç†è§£å¹¶å‘æˆæœ¬</h3>
<p>å½“æˆ‘ä»¬è®¨è®ºGoçš„goroutineæ¯”çº¿ç¨‹æ›´è½»é‡æ—¶ï¼Œä½ çŸ¥é“"è½»é‡"å…·ä½“ä½“ç°åœ¨å“ªé‡Œå—ï¼Ÿ</p>
<p>æ±‡ç¼–å±‚é¢å‘Šè¯‰æˆ‘ä»¬ç­”æ¡ˆï¼š</p>
<ul>
<li><strong>goroutineåˆ‡æ¢</strong>ï¼šä¸»è¦åœ¨ç”¨æˆ·æ€å®Œæˆï¼Œä¸æ¶‰åŠå†…æ ¸è°ƒåº¦</li>
<li><strong>çº¿ç¨‹åˆ‡æ¢</strong>ï¼šéœ€è¦é™·å…¥å†…æ ¸ï¼Œå®Œæ•´çš„ä¸Šä¸‹æ–‡ä¿å­˜å’Œæ¢å¤</li>
</ul>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// è¿™ä¸ªgoroutineçš„åˆ›å»ºå’Œè°ƒåº¦æˆæœ¬</span>
<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å·¥ä½œä»£ç </span>
}()
</code></pre>
<p>åœ¨æ±‡ç¼–å±‚é¢ï¼Œä½ ä¼šçœ‹åˆ°ç¼–è¯‘å™¨å¦‚ä½•ç”Ÿæˆä»£ç æ¥ç®¡ç†goroutineçš„æ ˆå’Œè°ƒåº¦ï¼Œè¿™ç§ç†è§£è®©ä½ èƒ½å¤Ÿåšå‡ºæ›´æ˜æ™ºçš„å¹¶å‘è®¾è®¡å†³ç­–ã€‚</p>
<h2 data-id="heading-7">æ±‡ç¼–æ€ç»´ï¼šå³ä½¿ä¸å†™æ±‡ç¼–ä»£ç ä¹Ÿèƒ½å—ç›Š</h2>
<p>å­¦ä¹ æ±‡ç¼–æœ€é‡è¦çš„ä¸æ˜¯å­¦ä¼š<strong>ç¼–å†™</strong>æ±‡ç¼–ç¨‹åºï¼Œè€Œæ˜¯åŸ¹å…»<strong>æ±‡ç¼–æ€ç»´</strong>â€”â€”ç†è§£ä»£ç åœ¨æœºå™¨å±‚é¢çš„æ‰§è¡Œæ–¹å¼ã€‚</p>
<h3 data-id="heading-8">1. å†…å­˜è®¿é—®æ¨¡å¼ä¼˜åŒ–</h3>
<p>ç†è§£CPUç¼“å­˜è¡Œã€é¢„å–æœºåˆ¶åï¼Œä½ ä¼šè‡ªç„¶åœ°ä¼˜åŒ–æ•°æ®ç»“æ„ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä¼˜åŒ–å‰ï¼šéšæœºè®¿é—®ï¼Œç¼“å­˜ä¸å‹å¥½</span>
<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    ID      <span class="hljs-type">int</span>
    Name    <span class="hljs-type">string</span>
    Email   <span class="hljs-type">string</span>
    Status  <span class="hljs-type">bool</span> <span class="hljs-comment">// ç»å¸¸è®¿é—®çš„å­—æ®µ</span>
}

<span class="hljs-comment">// ä¼˜åŒ–åï¼šçƒ­ç‚¹æ•°æ®é›†ä¸­ï¼Œç¼“å­˜å‹å¥½</span>
<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    Status  <span class="hljs-type">bool</span> <span class="hljs-comment">// ç»å¸¸è®¿é—®çš„å­—æ®µæ”¾åœ¨å‰é¢</span>
    ID      <span class="hljs-type">int</span>
    Name    <span class="hljs-type">string</span>
    Email   <span class="hljs-type">string</span>
}
</code></pre>
<h3 data-id="heading-9">2. å‡½æ•°è°ƒç”¨å¼€é”€æ„è¯†</h3>
<p>ç†è§£è°ƒç”¨æ ˆå’Œå¯„å­˜å™¨ä½¿ç”¨åï¼Œä½ ä¼šï¼š</p>
<ul>
<li>é¿å…è¿‡åº¦åˆ†å±‚å’Œå°å‡½æ•°æ»¥ç”¨</li>
<li>ç†è§£å†…è”ä¼˜åŒ–çš„ä»·å€¼å’Œé™åˆ¶</li>
<li>åˆç†ä½¿ç”¨å‡½æ•°æŒ‡é’ˆå’Œæ¥å£</li>
</ul>
<h3 data-id="heading-10">3. ç³»ç»Ÿè°ƒç”¨æˆæœ¬è®¤çŸ¥</h3>
<p>é€šè¿‡ç†è§£ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢æˆæœ¬ï¼Œä½ ä¼šï¼š</p>
<ul>
<li>æ‰¹é‡å¤„ç†ç³»ç»Ÿè°ƒç”¨</li>
<li>åˆç†ä½¿ç”¨ç¼“å†²å’Œç¼“å­˜</li>
<li>é€‰æ‹©é€‚å½“çš„I/Oæ¨¡å‹</li>
</ul>
<h2 data-id="heading-11">ç°ä»£åç«¯å¼€å‘ä¸­æ±‡ç¼–çš„å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-12">å¾®æœåŠ¡æ¶æ„ä¸‹çš„ä»·å€¼</h3>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ±‡ç¼–çŸ¥è¯†å¸®åŠ©ä½ ï¼š</p>
<ul>
<li><strong>ç²¾å‡†å®šä½ç½‘ç»œè¶…æ—¶é—®é¢˜</strong>ï¼šåŒºåˆ†æ˜¯ç½‘ç»œå»¶è¿Ÿè¿˜æ˜¯å¤„ç†å»¶è¿Ÿ</li>
<li><strong>ä¼˜åŒ–åºåˆ—åŒ–/ååºåˆ—åŒ–</strong>ï¼šç†è§£å†…å­˜æ‹·è´å’Œç¼–ç è§£ç çš„æˆæœ¬</li>
<li><strong>è¯Šæ–­å®¹å™¨ç¯å¢ƒæ€§èƒ½é—®é¢˜</strong>ï¼šç†è§£cgroupså’Œnamespacesçš„åº•å±‚å½±å“</li>
</ul>
<h3 data-id="heading-13">äº‘åŸç”Ÿæ—¶ä»£çš„æ±‡ç¼–ä»·å€¼</h3>
<p>åœ¨Kuberneteså’Œäº‘ç¯å¢ƒä¸­ï¼š</p>
<ul>
<li><strong>èµ„æºé™åˆ¶çš„çœŸå®å½±å“</strong>ï¼šç†è§£CPUé™é…é¢åœ¨è°ƒåº¦å™¨å±‚é¢çš„å®ç°</li>
<li><strong>ç½‘ç»œæ€§èƒ½åˆ†æ</strong>ï¼šä»ç³»ç»Ÿè°ƒç”¨çœ‹åˆ°ç½‘ç»œåŒ…å¤„ç†</li>
<li><strong>å­˜å‚¨I/Oä¼˜åŒ–</strong>ï¼šç†è§£page cacheå’Œç›´æ¥I/Oçš„é€‰æ‹©</li>
</ul>
<h2 data-id="heading-14">å¦‚ä½•å¼€å§‹ä½ çš„æ±‡ç¼–å­¦ä¹ ä¹‹æ—…</h2>
<h3 data-id="heading-15">ç¬¬ä¸€æ­¥ï¼šå»ºç«‹åŸºç¡€è®¤çŸ¥</h3>
<ol>
<li><strong>å­¦ä¹ åŸºæœ¬æ¦‚å¿µ</strong>ï¼šå¯„å­˜å™¨ã€å†…å­˜åœ°å€ã€æŒ‡ä»¤å‘¨æœŸ</li>
<li><strong>ç†è§£CPUå·¥ä½œæ¨¡å¼</strong>ï¼šä¿æŠ¤æ¨¡å¼ã€è™šæ‹Ÿå†…å­˜ã€ä¸­æ–­å¤„ç†</li>
<li><strong>æŒæ¡å¸¸ç”¨æŒ‡ä»¤</strong>ï¼šmovã€addã€callã€jmpç­‰æ ¸å¿ƒæŒ‡ä»¤</li>
</ol>
<h3 data-id="heading-16">ç¬¬äºŒæ­¥ï¼šå®è·µç»“åˆç†è®º</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ä½ ä»£ç çš„æ±‡ç¼–è¾“å‡º</span>
go tool compile -S main.go
gcc -S -O2 example.c
javap -c MyClass.class
</code></pre>
<h3 data-id="heading-17">ç¬¬ä¸‰æ­¥ï¼šèå…¥æ—¥å¸¸å·¥ä½œ</h3>
<ul>
<li>åœ¨æ€§èƒ½åˆ†ææ—¶å¤šé—®ä¸€å¥"ä¸ºä»€ä¹ˆ"</li>
<li>é‡åˆ°è¯¡å¼‚bugæ—¶è€ƒè™‘åº•å±‚å¯èƒ½æ€§</li>
<li>è®¾è®¡ç³»ç»Ÿæ—¶æ€è€ƒåº•å±‚ä»£ä»·</li>
</ul>
<h2 data-id="heading-18">æœ€å</h2>
<p>åœ¨AIèƒ½å¤Ÿç”Ÿæˆä»£ç çš„ä»Šå¤©ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé—®ï¼šè¿˜æœ‰å¿…è¦å­¦ä¹ è¿™ç§åº•å±‚çŸ¥è¯†å—ï¼Ÿ</p>
<p>æˆ‘çš„å›ç­”æ˜¯ï¼š<strong>æ­£å› ä¸ºAIæ“…é•¿ç”Ÿæˆé«˜çº§ä»£ç ï¼Œç†è§£åº•å±‚çš„å¼€å‘è€…æ‰æ›´åŠ çè´µ</strong>ã€‚</p>
<p>AIå¯ä»¥å¸®ä½ å†™ä¸šåŠ¡é€»è¾‘ï¼Œä½†å¾ˆéš¾å¸®ä½ ï¼š</p>
<ul>
<li>è¯Šæ–­ä¸€ä¸ªåªæœ‰åœ¨ç”Ÿäº§ç¯å¢ƒå‡ºç°çš„æ€§èƒ½é—®é¢˜</li>
<li>ä¼˜åŒ–ä¸€ä¸ªå·²ç»é«˜åº¦ä¼˜åŒ–çš„å…³é”®è·¯å¾„</li>
<li>è®¾è®¡ä¸€ä¸ªæ—¢ä¼˜é›…åˆé«˜æ•ˆçš„ç³»ç»Ÿæ¶æ„</li>
</ul>
<p><strong>æ±‡ç¼–çŸ¥è¯†æ˜¯ä½ çš„è¶…èƒ½åŠ›</strong>ï¼Œå®ƒè®©ä½ ï¼š</p>
<ul>
<li>åœ¨åˆ«äººçœ‹åˆ°é­”æ³•çš„åœ°æ–¹çœ‹åˆ°æœºåˆ¶</li>
<li>åœ¨åˆ«äººæ»¡è¶³äºè¡¨è±¡çš„åœ°æ–¹æ¢ç©¶æœ¬è´¨</li>
<li>åœ¨åˆ«äººæŸæ‰‹æ— ç­–çš„åœ°æ–¹æ‰¾åˆ°å‡ºè·¯</li>
</ul>
<p>åç«¯å¼€å‘çš„çœŸæ­£é«˜æ‰‹ï¼Œæ—¢èƒ½åœ¨æ¶æ„å±‚é¢é©¾é©­åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œåˆèƒ½åœ¨åº•å±‚ç†è§£æ¯ä¸ªæŒ‡ä»¤ã€æ¯ä¸ªå­—èŠ‚çš„ä»£ä»·ã€‚è¿™ç§å…¨æ ˆçš„æ·±åº¦ç†è§£ï¼Œè®©ä½ åœ¨æŠ€æœ¯é¢†åŸŸä¸­ç«‹äºä¸è´¥ä¹‹åœ°ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸è¦å†æŠŠæ±‡ç¼–çœ‹ä½œå¤è€çš„é—è¿¹ï¼Œè€Œåº”æŠŠå®ƒå½“ä½œ<strong>æ‰“å¼€è®¡ç®—æœºç³»ç»ŸçœŸç›¸çš„é’¥åŒ™</strong>ã€‚æŒæ¡è¿™æŠŠé’¥åŒ™ï¼Œä½ å°†åœ¨æŠ€æœ¯çš„é“è·¯ä¸Šèµ°å¾—æ›´è¿œã€æ›´ç¨³ã€æ›´è‡ªä¿¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šéƒ¨ç½² DevStack åå¦‚ä½•è®¿é—® Horizon Dashboardï¼Ÿ]]></title>    <link>https://juejin.cn/post/7575182522411450406</link>    <guid>https://juejin.cn/post/7575182522411450406</guid>    <pubDate>2025-11-23T11:11:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575182522411450406" data-draft-id="7575367791272886310" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šéƒ¨ç½² DevStack åå¦‚ä½•è®¿é—® Horizon Dashboardï¼Ÿ"/> <meta itemprop="keywords" content="OpenStack"/> <meta itemprop="datePublished" content="2025-11-23T11:11:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šéƒ¨ç½² DevStack åå¦‚ä½•è®¿é—® Horizon Dashboardï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:11:31.000Z" title="Sun Nov 23 2025 11:11:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¯å¢ƒ</strong>ï¼šUbuntu 22.04 + KVM/libvirt + DevStack (2024.2)<br/>
<strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€šè¿‡ SSH è¿œç¨‹ç™»å½•åˆ°ä¸€å°ç‰©ç†æœºï¼Œåœ¨å…¶ä¸Šç”¨ KVM å¯åŠ¨äº† Ubuntu è™šæ‹Ÿæœºï¼Œå¹¶æˆåŠŸå®‰è£…äº† OpenStack DevStackï¼Œä½†æ— æ³•ä»æœ¬åœ°æµè§ˆå™¨è®¿é—® Web æ§åˆ¶å°ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ§© åœºæ™¯æè¿°</h2>
<p>æˆ‘çš„ç½‘ç»œæ‹“æ‰‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-attr">[æœ¬åœ°ç”µè„‘]</span>
        â”‚
        â””â”€â”€ <span class="hljs-selector-tag">SSH</span> â†’ <span class="hljs-selector-attr">[è·³æ¿æœº/ç‰©ç†ä¸»æœº: 192.168.18.133]</span>
                      â”‚
                      â””â”€â”€ <span class="hljs-selector-tag">KVM</span> è™šæ‹Ÿæœº (libvirt NAT ç½‘ç»œ)
                              â”‚
                              â””â”€â”€ <span class="hljs-selector-tag">IP</span>: <span class="hljs-number">192.168</span><span class="hljs-selector-class">.122</span><span class="hljs-selector-class">.30</span>
                                      â””â”€â”€ <span class="hljs-selector-tag">DevStack</span> å·²æˆåŠŸå®‰è£…
                                          <span class="hljs-selector-tag">Horizon</span> åœ°å€: <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//192.168.122.30/dashboard</span>
</code></pre>
<p>é—®é¢˜æ¥äº†ï¼š<strong>åœ¨æœ¬åœ°ç”µè„‘çš„æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://192.168.122.30/dashboard</code>ï¼Œé¡µé¢æ— æ³•æ‰“å¼€</strong>ã€‚</p>
<p>åŸå› å¾ˆç®€å•ï¼š<code>192.168.122.30</code> æ˜¯ libvirt åˆ›å»ºçš„ <strong>NAT è™šæ‹Ÿç½‘ç»œ</strong>ï¼Œåªæœ‰å®¿ä¸»æœºï¼ˆ192.168.18.133ï¼‰èƒ½è®¿é—®å®ƒï¼Œè€Œæœ¬åœ°ç”µè„‘æ ¹æœ¬â€œçœ‹ä¸è§â€è¿™ä¸ª IPã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ” æ ¸å¿ƒæ€è·¯ï¼šSSH ç«¯å£è½¬å‘ï¼ˆéš§é“ï¼‰</h2>
<p>æˆ‘ä»¬è¦åšçš„ï¼Œæ˜¯å»ºç«‹ä¸€æ¡å®‰å…¨éš§é“ï¼š</p>
<blockquote>
<p><strong>æœ¬åœ°ç”µè„‘ â†’ è·³æ¿æœºï¼ˆ192.168.18.133ï¼‰â†’ è™šæ‹Ÿæœºï¼ˆ192.168.122.30:80ï¼‰</strong></p>
</blockquote>
<p>æœ€ç»ˆæ•ˆæœï¼šåœ¨æœ¬åœ°è®¿é—® <code>http://localhost:8080/dashboard</code>ï¼Œæµé‡è‡ªåŠ¨ç©¿é€ä¸¤å±‚ç½‘ç»œåˆ°è¾¾ DevStack çš„ Horizonã€‚</p>
<hr/>
<h2 data-id="heading-2">âœ… æ¨èæ–¹æ¡ˆï¼šä½¿ç”¨ SSH ProxyJumpï¼ˆOpenSSH 7.3+ï¼‰</h2>
<p>ç°ä»£ OpenSSH æ”¯æŒ <code>-J</code> å‚æ•°ï¼ˆå³ <code>ProxyJump</code>ï¼‰ï¼Œå¯ä¸€é”®å®Œæˆè·³è½¬å’Œç«¯å£è½¬å‘ã€‚</p>
<h3 data-id="heading-3">æ­¥éª¤ 1ï¼šåœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œ</h3>
<pre><code class="hljs language-ruby" lang="ruby">ssh -L <span class="hljs-number">8080</span><span class="hljs-symbol">:localhost</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span> -J hanwang<span class="hljs-variable">@192</span>.<span class="hljs-number">168.18</span>.<span class="hljs-number">133</span> stack<span class="hljs-variable">@192</span>.<span class="hljs-number">168.122</span>.<span class="hljs-number">30</span>
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>-L 8080:localhost:80</code>ï¼šå°†æœ¬åœ° 8080 ç«¯å£æ˜ å°„åˆ°ç›®æ ‡ä¸»æœºçš„ 80 ç«¯å£</li>
<li><code>-J hanwang@192.168.18.133</code>ï¼šå…ˆé€šè¿‡è·³æ¿æœºè¿æ¥</li>
<li><code>stack@192.168.122.30</code>ï¼šæœ€ç»ˆç›®æ ‡è™šæ‹Ÿæœº</li>
</ul>
<blockquote>
<p>ğŸ’¡ æç¤ºï¼šç¡®ä¿ä½ å·²å°†å…¬é’¥éƒ¨ç½²åˆ°è·³æ¿æœºå’Œ VMï¼Œé¿å…é‡å¤è¾“å¯†ç ã€‚</p>
</blockquote>
<h3 data-id="heading-4">æ­¥éª¤ 2ï¼šä¿æŒ SSH ä¼šè¯è¿è¡Œ</h3>
<p>ä¸è¦å…³é—­ç»ˆç«¯ï¼åªè¦è¿™ä¸ª SSH è¿æ¥å­˜åœ¨ï¼Œéš§é“å°±æœ‰æ•ˆã€‚</p>
<h3 data-id="heading-5">æ­¥éª¤ 3ï¼šåœ¨æœ¬åœ°æµè§ˆå™¨è®¿é—®</h3>
<p>æ‰“å¼€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">http://localhost:8080/dashboard
</code></pre>
<p>ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼š</p>
<ul>
<li>ç”¨æˆ·åï¼š<code>admin</code> æˆ– <code>demo</code></li>
<li>å¯†ç ï¼š<code>secret</code></li>
</ul>
<p>âœ… æˆåŠŸè¿›å…¥ OpenStack Horizonï¼</p>
<hr/>
<h2 data-id="heading-6">ğŸ› ï¸ å¤‡é€‰æ–¹æ¡ˆï¼šåˆ†æ­¥æ‰‹åŠ¨è½¬å‘ï¼ˆå…¼å®¹æ—§ç‰ˆ SSHï¼‰</h2>
<p>å¦‚æœä½ çš„æœ¬åœ° SSH ç‰ˆæœ¬è¾ƒè€ï¼ˆ&lt;7.3ï¼‰ï¼Œä¸æ”¯æŒ <code>-J</code>ï¼Œå¯ä»¥ç”¨ä¸¤æ­¥æ³•ï¼š</p>
<h3 data-id="heading-7">åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œï¼š</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">ssh -L <span class="hljs-number">8080</span>:<span class="hljs-number">192.168</span><span class="hljs-number">.122</span><span class="hljs-number">.30</span>:<span class="hljs-number">80</span> <span class="hljs-symbol">hanwang@</span><span class="hljs-number">192.168</span><span class="hljs-number">.18</span><span class="hljs-number">.133</span>
</code></pre>
<p>è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯ï¼š</p>
<blockquote>
<p>â€œåœ¨æˆ‘æœ¬åœ°å¼€ä¸€ä¸ª 8080 ç«¯å£ï¼Œæ‰€æœ‰æµé‡é€šè¿‡ 192.168.18.133 è½¬å‘åˆ° 192.168.122.30:80â€</p>
</blockquote>
<p>ç„¶ååŒæ ·è®¿é—® <code>http://localhost:8080/dashboard</code> å³å¯ã€‚</p>
<hr/>
<h2 data-id="heading-8">ğŸ“ é•¿æœŸä½¿ç”¨å»ºè®®ï¼šé…ç½® SSH config</h2>
<p>åœ¨ä½ æœ¬åœ°ç”µè„‘çš„ <code>~/.ssh/config</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-css" lang="css">Host devstack-vm
  HostName <span class="hljs-number">192.168</span>.<span class="hljs-number">122.30</span>
  User stack
  ProxyJump hanwang<span class="hljs-keyword">@192</span>.168.18.133
  LocalForward <span class="hljs-number">8080</span> <span class="hljs-attribute">localhost</span>:<span class="hljs-number">80</span>
</code></pre>
<p>ä¹‹ååªéœ€è¿è¡Œï¼š</p>
<pre><code class="hljs">ssh devstack-vm
</code></pre>
<p>å³å¯è‡ªåŠ¨å»ºç«‹éš§é“ï¼Œç®€æ´é«˜æ•ˆï¼</p>
<hr/>
<h2 data-id="heading-9">â“ å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<h3 data-id="heading-10">Q1ï¼šè®¿é—® localhost:8080 æ˜¾ç¤ºç©ºç™½æˆ–è¿æ¥æ‹’ç»ï¼Ÿ</h3>
<ul>
<li>æ£€æŸ¥ SSH éš§é“æ˜¯å¦ä»åœ¨è¿è¡Œ</li>
<li>åœ¨ VM ä¸­ç¡®è®¤æœåŠ¡æ­£å¸¸ï¼š<code>curl -I http://localhost/dashboard</code></li>
<li>ç¡®ä¿ DevStack å®‰è£…æˆåŠŸï¼ˆæ— æŠ¥é”™é€€å‡ºï¼‰</li>
</ul>
<h3 data-id="heading-11">Q2ï¼šèƒ½å¦è®©å…¶ä»–äººä¹Ÿè®¿é—®ï¼Ÿ</h3>
<p>å¯ä»¥ï¼Œä½†éœ€è°¨æ…ã€‚ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">ssh -o <span class="hljs-attr">GatewayPorts</span>=<span class="hljs-literal">yes</span> -L <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">8080</span>:localhost:<span class="hljs-number">80</span> -J ... 
</code></pre>
<p>ç„¶ååˆ«äººå¯é€šè¿‡ <code>http://192.168.18.133:8080/dashboard</code> è®¿é—®ã€‚<br/>
âš ï¸ æ³¨æ„ï¼šè¿™ä¼šæš´éœ² OpenStack åˆ°å±€åŸŸç½‘ï¼Œè¯·ç¡®ä¿ç½‘ç»œå®‰å…¨ï¼</p>
<h3 data-id="heading-12">Q3ï¼šä¸ºä»€ä¹ˆä¸ç”¨ç›´æ¥æ¡¥æ¥ç½‘ç»œï¼Ÿ</h3>
<p>æ¡¥æ¥ç¡®å®èƒ½è®© VM è·å¾—å±€åŸŸç½‘ IPï¼Œä½†é…ç½®å¤æ‚ï¼Œä¸”å¯èƒ½å½±å“ç”Ÿäº§ç½‘ç»œã€‚å¯¹äºå¼€å‘æµ‹è¯•ï¼ŒSSH éš§é“æ›´å®‰å…¨ã€è½»é‡ã€æ— éœ€æ”¹ç½‘ç»œã€‚</p>
<hr/>
<h2 data-id="heading-13">ğŸ‰ æ€»ç»“</h2>





















<table><thead><tr><th>é—®é¢˜</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ— æ³•è®¿é—® NAT ç½‘ç»œä¸­çš„ DevStack Dashboard</td><td>ä½¿ç”¨ SSH ç«¯å£è½¬å‘</td></tr><tr><td>éœ€è¦ç»è¿‡è·³æ¿æœº</td><td>ä½¿ç”¨ <code>-J</code> æˆ– <code>ProxyJump</code></td></tr><tr><td>æƒ³é•¿æœŸä½¿ç”¨</td><td>é…ç½® <code>~/.ssh/config</code></td></tr></tbody></table>
<p>é€šè¿‡ä¸€æ¡ç®€å•çš„ SSH å‘½ä»¤ï¼Œæˆ‘ä»¬è½»æ¾æ‰“é€šäº†ä¸‰å±‚ç½‘ç»œï¼Œå®‰å…¨åœ°è®¿é—®åˆ°äº† OpenStack æ§åˆ¶å°ã€‚è¿™ä¹Ÿæ˜¯äº‘åŸç”Ÿæ—¶ä»£å¼€å‘è€…å¿…å¤‡çš„ç½‘ç»œè°ƒè¯•æŠ€èƒ½ä¹‹ä¸€ã€‚</p>
<hr/>
<blockquote>
<p><strong>é™„ï¼šDevStack é»˜è®¤å‡­è¯</strong></p>
<ul>
<li>URL: <code>http://localhost:8080/dashboard</code></li>
<li>Admin ç”¨æˆ·: <code>admin / secret</code></li>
<li>Demo ç”¨æˆ·: <code>demo / secret</code></li>
</ul>
</blockquote>
<p>Happy Hacking with OpenStack! â˜ï¸</p>
<hr/>
<p><strong>æ ‡ç­¾</strong>ï¼š#OpenStack #DevStack #KVM #SSHéš§é“ #Horizon #äº‘è®¡ç®— #Linuxè¿ç»´</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIæ—¶ä»£ï¼Œæ±‡ç¼–è¯­è¨€è¿˜æœ‰å¿…è¦å­¦å—ï¼Ÿæˆ‘çš„æƒ¨ç—›æ•™è®­ä¸æ€è€ƒ]]></title>    <link>https://juejin.cn/post/7575162322240290816</link>    <guid>https://juejin.cn/post/7575162322240290816</guid>    <pubDate>2025-11-23T11:12:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575162322240290816" data-draft-id="7575112613778178082" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIæ—¶ä»£ï¼Œæ±‡ç¼–è¯­è¨€è¿˜æœ‰å¿…è¦å­¦å—ï¼Ÿæˆ‘çš„æƒ¨ç—›æ•™è®­ä¸æ€è€ƒ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-23T11:12:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIæ—¶ä»£ï¼Œæ±‡ç¼–è¯­è¨€è¿˜æœ‰å¿…è¦å­¦å—ï¼Ÿæˆ‘çš„æƒ¨ç—›æ•™è®­ä¸æ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:12:03.000Z" title="Sun Nov 23 2025 11:12:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å½“AIå¯ä»¥è‡ªåŠ¨ç”Ÿæˆä»£ç ã€ä¼˜åŒ–æ€§èƒ½ç”šè‡³è°ƒè¯•ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬æ˜¯å¦è¿˜éœ€è¦äº†è§£é‚£äº›æ™¦æ¶©éš¾æ‡‚çš„æ±‡ç¼–æŒ‡ä»¤ï¼Ÿè®©æˆ‘ç”¨äº²èº«ç»å†å‘Šè¯‰ä½ ç­”æ¡ˆã€‚</p>
</blockquote>
<p>ä¸Šå‘¨ï¼Œæˆ‘è´Ÿè´£çš„æ ¸å¿ƒæœåŠ¡çªç„¶å‡ºç°è¯¡å¼‚å´©æºƒâ€”â€”åœ¨æ¯ç§’å¤„ç†æ•°åä¸‡è¯·æ±‚çš„é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒæœåŠ¡ä¼šéšæœºå´©æºƒï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•æ˜ç¡®çš„é”™è¯¯æ—¥å¿—ã€‚å›¢é˜ŸèŠ±äº†ä¸‰å¤©æ—¶é—´æ¯«æ— å¤´ç»ªï¼Œç›´åˆ°æˆ‘è¿«ä¸å¾—å·²æ‰“å¼€äº†GDBï¼Œåœ¨æ±‡ç¼–å±‚é¢è¿½è¸ªé‚£ä¸ªè¯¥æ­»çš„bugã€‚</p>
<p>æœ€ç»ˆå‘ç°ï¼Œé—®é¢˜å‡ºåœ¨ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“åœ¨ç‰¹å®šCPUæ¶æ„ä¸‹çš„å†…å­˜å¯¹é½é—®é¢˜ã€‚è¿™ä¸ªç»å†è®©æˆ‘é‡æ–°æ€è€ƒï¼šåœ¨AIå¯ä»¥ç¼–å†™ä»£ç çš„ä»Šå¤©ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä»ç„¶éœ€è¦ç†è§£è®¡ç®—æœºæœ€åº•å±‚çš„è¯­è¨€ï¼Ÿ</p>
<h2 data-id="heading-0">ä¸€æ¬¡è®©æˆ‘"åˆ»éª¨é“­å¿ƒ"çš„è°ƒè¯•ç»å†</h2>
<p>é‚£æ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯æ—©æœŸå‚ä¸çš„ä¸€ä¸ªé‡‘èäº¤æ˜“ç³»ç»Ÿé¡¹ç›®ã€‚ç³»ç»Ÿåœ¨æµ‹è¯•ç¯å¢ƒå®Œç¾è¿è¡Œï¼Œä½†åœ¨å®¢æˆ·çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ¯éš”å‡ å¤©å°±ä¼šç¥ç§˜å´©æºƒã€‚æˆ‘ä»¬æ£€æŸ¥äº†æ‰€æœ‰å¯èƒ½çš„åœ°æ–¹ï¼šå†…å­˜æ³„æ¼ã€çº¿ç¨‹å®‰å…¨ã€ç½‘ç»œè¶…æ—¶â€¦â€¦ä¸€æ— æ‰€è·ã€‚</p>
<p>åœ¨è¿ç»­åŠ ç­ä¸¤å‘¨åï¼Œæˆ‘çš„å¯¼å¸ˆå»ºè®®ï¼š"æˆ‘ä»¬çœ‹çœ‹æ±‡ç¼–å§ã€‚"</p>
<p>å½“æ—¶æˆ‘å¿ƒé‡Œå˜€å’•ï¼š"è¿™éƒ½ä»€ä¹ˆå¹´ä»£äº†ï¼Œè¿˜è¦çœ‹æ±‡ç¼–ï¼Ÿ"</p>
<p>ä½†å½“æˆ‘ä»¬é€šè¿‡GDBåæ±‡ç¼–æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶æ—¶ï¼ŒçœŸç›¸å¤§ç™½ï¼šä¸€ä¸ªå†…è”å‡½æ•°åœ¨ç‰¹å®šç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«ä¸‹ï¼Œäº§ç”Ÿäº†é”™è¯¯çš„å¯„å­˜å™¨ä½¿ç”¨ï¼Œå¯¼è‡´å¶å°”ä¼šè¦†ç›–è¿”å›åœ°å€ã€‚</p>
<p>é‚£ä¸€åˆ»æˆ‘æç„¶å¤§æ‚Ÿâ€”â€”æ²¡æœ‰æ±‡ç¼–çŸ¥è¯†ï¼Œæˆ‘ä»¬å°±åƒåœ¨é»‘æš—ä¸­æ‘¸ç´¢ã€‚è€ŒAIåŠ©æ‰‹ï¼Œå°½ç®¡èƒ½å†™å‡ºä¼˜é›…çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œå´æ— æ³•æ›¿ä»£è¿™ç§åº•å±‚çš„è°ƒè¯•èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆåœ¨AIæ—¶ä»£ï¼Œæ±‡ç¼–åè€Œæ›´çè´µï¼Ÿ</h2>
<p><strong>ç†è§£AIæ— æ³•æ•™ç»™ä½ çš„ç›´è§‰</strong></p>
<p>AIå¯ä»¥ç”Ÿæˆé«˜æ•ˆçš„ä»£ç ï¼Œç”šè‡³å¯ä»¥è§£é‡Šä»£ç çš„åŠŸèƒ½ã€‚ä½†å®ƒæ— æ³•ç»™ä½ é‚£ç§å¯¹è®¡ç®—æœºå·¥ä½œåŸç†çš„"ç›´è§‰ç†è§£"ã€‚å½“ä½ é€šè¿‡æ±‡ç¼–ç†è§£äº†å‡½æ•°è°ƒç”¨æ ˆã€å†…å­˜ç®¡ç†å’ŒæŒ‡ä»¤æµæ°´çº¿ï¼Œä½ ä¼šè·å¾—ä¸€ç§éš¾ä»¥è¨€ä¼ çš„æ´å¯ŸåŠ›ã€‚</p>
<p>å°±åƒå­¦ä¹ éŸ³ä¹ç†è®ºâ€”â€”AIå¯ä»¥ç”Ÿæˆæ‚¦è€³çš„æ—‹å¾‹ï¼Œä½†ç†è§£ä¹ç†çš„éŸ³ä¹å®¶æ‰çŸ¥é“ä¸ºä»€ä¹ˆè¿™äº›éŸ³ç¬¦å¦‚æ­¤ç»„åˆï¼Œä»¥åŠå¦‚ä½•åˆ›é€ æ–°çš„å¯èƒ½æ€§ã€‚</p>
<p><strong>æ€§èƒ½ä¼˜åŒ–çš„"æœ€åæ­¦å™¨"</strong></p>
<p>ç°ä»£ç¼–è¯‘å™¨ç¡®å®å¼ºå¤§ï¼Œä½†åœ¨æç«¯æ€§èƒ½è¦æ±‚çš„åœºæ™¯ä¸‹ï¼ˆé«˜é¢‘äº¤æ˜“ã€æ¸¸æˆå¼•æ“ã€æ•°æ®åº“å†…æ ¸ï¼‰ï¼Œæ±‡ç¼–çŸ¥è¯†ä»ç„¶æ˜¯ç»ˆææ­¦å™¨ã€‚</p>
<p>æˆ‘æ›¾åœ¨ä¼˜åŒ–ä¸€ä¸ªå›¾åƒå¤„ç†ç®—æ³•æ—¶ï¼Œå‘ç°ç¼–è¯‘å™¨ç”Ÿæˆçš„SSEæŒ‡ä»¤å¹¶éæœ€ä¼˜ã€‚æ‰‹åŠ¨è°ƒæ•´æ±‡ç¼–åï¼Œæ€§èƒ½æå‡äº†3å€â€”â€”è¿™åœ¨å®æ—¶å¤„ç†åœºæ™¯ä¸­æ˜¯å†³å®šæ€§çš„ä¼˜åŠ¿ã€‚</p>
<p><strong>å®‰å…¨é¢†åŸŸçš„å¿…å¤‡æŠ€èƒ½</strong></p>
<p>åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œç†è§£æ±‡ç¼–æ˜¯åˆ†ææ¼æ´ã€é€†å‘å·¥ç¨‹çš„åŸºç¡€ã€‚æ— è®ºAIå¤šä¹ˆå¼ºå¤§ï¼Œç†è§£æ¶æ„ä»£ç å¦‚ä½•åœ¨åº•å±‚æ‰§è¡Œçš„èƒ½åŠ›ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥éƒ½æ— æ³•è¢«æ›¿ä»£ã€‚</p>
<h2 data-id="heading-2">æˆ‘çš„æ±‡ç¼–å­¦ä¹ å»ºè®®</h2>
<p>å¦‚æœä½ å†³å®šå­¦ä¹ æ±‡ç¼–ï¼Œæˆ‘æ¨èè¿™æ ·çš„è·¯å¾„ï¼š</p>
<ol>
<li>
<p><strong>ä»ç®€å•çš„å¼€å§‹</strong>ï¼šä¸è¦ä¸€ä¸Šæ¥å°±å°è¯•x86-64ï¼Œä»ç»å…¸çš„ARMæˆ–RISC-Væ¶æ„å¼€å§‹ä¼šæ›´å‹å¥½</p>
</li>
<li>
<p><strong>ç†è®ºä¸å®è·µç»“åˆ</strong>ï¼šä½¿ç”¨åœ¨çº¿æ¨¡æ‹Ÿå™¨å®é™…ç¼–å†™å’Œè¿è¡Œä»£ç ï¼Œè§‚å¯Ÿæ¯æ¡æŒ‡ä»¤çš„æ•ˆæœ</p>
</li>
<li>
<p><strong>ä¸é«˜çº§è¯­è¨€å¯¹ç…§</strong>ï¼šå†™ä¸€æ®µç®€å•çš„Cä»£ç ï¼ŒæŸ¥çœ‹ç”Ÿæˆçš„æ±‡ç¼–ï¼Œç†è§£ä¸¤è€…çš„å¯¹åº”å…³ç³»</p>
</li>
<li>
<p><strong>å…³æ³¨æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼šé™¤éä½ è¦åšä¸“é—¨çš„åº•å±‚å¼€å‘ï¼Œå¦åˆ™é‡ç‚¹æ˜¯ç†è§£åŸç†è€Œéè®°å¿†æŒ‡ä»¤</p>
</li>
</ol>
<h2 data-id="heading-3">é‡æ–°æ€è€ƒé—®é¢˜çš„ç­”æ¡ˆ</h2>
<p>å›åˆ°æˆ‘ä»¬çš„æ ¸å¿ƒé—®é¢˜ï¼šAIæ—¶ä»£è¿˜æœ‰å¿…è¦å­¦æ±‡ç¼–å—ï¼Ÿ</p>
<p>æˆ‘çš„ç­”æ¡ˆæ˜¯ï¼š<strong>å­¦ä¹ æ±‡ç¼–çš„ç›®çš„å·²ç»æ”¹å˜ï¼Œä½†å…¶ä»·å€¼åè€Œæå‡äº†ã€‚</strong></p>
<p>æˆ‘ä»¬ä¸å†æ˜¯ä¸ºäº†æˆä¸ºæ±‡ç¼–ç¨‹åºå‘˜è€Œå­¦ä¹ å®ƒï¼Œè€Œæ˜¯ä¸ºäº†ï¼š</p>
<ul>
<li>åœ¨AIç”Ÿæˆçš„ä»£ç å‡ºç°è¯¡å¼‚é—®é¢˜æ—¶ï¼Œæœ‰èƒ½åŠ›æ·±å…¥åº•å±‚æ’æŸ¥</li>
<li>åœ¨æ€§èƒ½ä¼˜åŒ–é‡åˆ°ç“¶é¢ˆæ—¶ï¼Œèƒ½å¤Ÿè¿›è¡Œæœ€ç»ˆçš„è°ƒä¼˜</li>
<li>æ›´å¥½åœ°ç†è§£AIåŠ é€Ÿå™¨ï¼ˆGPU/TPUï¼‰çš„å·¥ä½œåŸç†</li>
<li>åœ¨ç³»ç»Ÿè®¾è®¡æ—¶åšå‡ºæ›´ç¬¦åˆç¡¬ä»¶ç‰¹æ€§çš„å†³ç­–</li>
</ul>
<p>åœ¨è¿™ä¸ªAIçœ‹ä¼¼èƒ½è§£å†³ä¸€åˆ‡é—®é¢˜çš„æ—¶ä»£ï¼ŒçœŸæ­£åŒºåˆ†ä¼˜ç§€å·¥ç¨‹å¸ˆçš„ï¼Œå¾€å¾€æ˜¯å¯¹è®¡ç®—æœ¬è´¨çš„æ·±åˆ»ç†è§£ã€‚æ±‡ç¼–è¯­è¨€æ­£æ˜¯é€šå¾€è¿™ç§ç†è§£çš„é‡è¦æ¡¥æ¢ã€‚</p>
<p>æ¯•ç«Ÿï¼Œå³ä½¿æœ‰äº†æœ€å…ˆè¿›çš„è‡ªåŠ¨é©¾é©¶æŠ€æœ¯ï¼Œç†è§£åŸºæœ¬çš„æœºæ¢°åŸç†ä»ç„¶èƒ½è®©å¸æœºåœ¨å…³é”®æ—¶åˆ»åŒ–é™©ä¸ºå¤·ã€‚æ±‡ç¼–è¯­è¨€ï¼Œå°±æ˜¯ç¨‹åºå‘˜çš„"æœºæ¢°åŸç†"ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å†æ¥èŠèŠï¼ŒVue3 é¡¹ç›®ä¸­ Pinia çš„æ›¿ä»£æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7575458028254674987</link>    <guid>https://juejin.cn/post/7575458028254674987</guid>    <pubDate>2025-11-23T11:23:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575458028254674987" data-draft-id="7575655132755394579" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å†æ¥èŠèŠï¼ŒVue3 é¡¹ç›®ä¸­ Pinia çš„æ›¿ä»£æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-23T11:23:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯å¸ƒé²ä¼Š"/> <meta itemprop="url" content="https://juejin.cn/user/4431511346492554"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å†æ¥èŠèŠï¼ŒVue3 é¡¹ç›®ä¸­ Pinia çš„æ›¿ä»£æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4431511346492554/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯å¸ƒé²ä¼Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:23:24.000Z" title="Sun Nov 23 2025 11:23:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p><strong>æƒ³è·å–æ›´å¤š2025å¹´æœ€æ–°å‰ç«¯åœºæ™¯é¢˜å¯ä»¥çœ‹è¿™é‡Œ</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffe.ecool.fun%2Ftopic-list%3Fic%3DKIQC2F%26from%3Djuejin_article" target="_blank" title="https://fe.ecool.fun/topic-list?ic=KIQC2F&amp;from=juejin_article" ref="nofollow noopener noreferrer">fe.ecool.fun</a></p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åˆ˜å¸ƒæ–¯ã€‚</p>
<p>ä¹‹å‰è½¬è½½äº†ä¸€ç¯‡æ–‡ç« <strong>Vue é¡¹ç›®ä¸è¦å†ç”¨ Pinia äº†</strong>ï¼Œå…ˆä¸å¯å¦è®¤ï¼Œè¿™æ–‡ç« æœ‰ç‚¹æ ‡é¢˜å…šçš„æ„æ€ã€‚ä½†è¿™ç¯‡æ–‡ç« çš„ä¸»è¦è§‚ç‚¹æ˜¯è¯´ï¼Œåœ¨ä¸­å°é¡¹ç›®é‡Œï¼Œç”¨ Vue 3 è‡ªå¸¦çš„ç»„åˆå¼ APIï¼ˆ<code>reactive</code>Â /Â <code>ref</code>ï¼‰æ¥ç®¡çŠ¶æ€ï¼Œå¾ˆå¤šæ—¶å€™æ¯”ç¡¬ä¸Š Pinia è¦é¦™ã€‚</p>
<p>å¥½å®¶ä¼™ï¼Œè¯„è®ºåŒºä¸€ä¸‹å°±çƒ­é—¹äº†ï¼Œæ€»ç»“èµ·æ¥æ˜¯ï¼šâ€œPinia å¤šå¥½ç”¨ï¼Œä½ è‚¯å®šæ˜¯æ²¡ç”¨æ˜ç™½ Piniaâ€</p>
<p>è¯´å®è¯ï¼Œæˆ‘ç¡®å®æœ‰ç‚¹æ„å¤–ã€‚</p>
<p><strong>æˆ‘å…ˆæ‘†æ˜æ€åº¦ï¼šPinia æ˜¯ä¸ªéå¸¸ä¼˜ç§€çš„çŠ¶æ€ç®¡ç†åº“ã€‚</strong>Â å°¤é›¨æºªå›¢é˜Ÿäº²è‡ªæ“åˆ€ï¼ŒAPI è®¾è®¡ç®€æ´ï¼ŒTS æ”¯æŒå®Œç¾ï¼Œæ’ä»¶ç³»ç»Ÿçµæ´»ï¼ŒDevtools ä½“éªŒä¸æ»‘ã€‚è¿™ä¸€ç‚¹ï¼Œæ²¡äººèƒ½å¦è®¤ã€‚</p>
<p>ä½†æˆ‘çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼š<strong>ä¼˜ç§€ï¼Œä¸ä»£è¡¨â€œæ‰€æœ‰åœºæ™¯éƒ½å¿…é¡»ä¸Šâ€ã€‚</strong></p>
<p>æˆ‘å‘ç°ç°åœ¨å¾ˆå¤šå›¢é˜Ÿï¼Œå°¤å…¶æ˜¯ä» Vue 2 åˆšè¿åˆ° Vue 3 ä¸ä¹…çš„ï¼Œå­˜åœ¨ä¸€ç§å¾ˆå¼ºçš„Â <strong>â€œçŠ¶æ€ç®¡ç†æƒ¯æ€§â€</strong> ã€‚</p>
<p>ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<p>åœ¨ Vue 2 + Options API çš„æ—¶ä»£ï¼Œç»„ä»¶ï¼ˆComponentï¼‰å’ŒçŠ¶æ€ï¼ˆStateï¼‰æ˜¯â€œéš”ç¦»â€çš„ã€‚<code>data</code>Â é‡Œçš„çŠ¶æ€å¤©ç”Ÿå°±æ˜¯â€œå†…å‘â€çš„ï¼Œç»„ä»¶ä¸€é”€æ¯ï¼ŒçŠ¶æ€å°±æ²¡äº†ã€‚è·¨ç»„ä»¶é€šä¿¡ã€å…¨å±€çŠ¶æ€å…±äº«ï¼Œä½ æ€ä¹ˆåŠï¼Ÿä½ æ²¡å¾—é€‰ï¼Œä½ å¿…é¡»ä¸Š Vuexã€‚Vuex å°±åƒä¸€ä¸ªâ€œä¸­å¤®ç©ºè°ƒâ€ï¼Œä½ ä¸ç”¨å®ƒï¼Œåˆ«çš„æˆ¿é—´ï¼ˆç»„ä»¶ï¼‰å°±äº«å—ä¸åˆ°å†·æ°”ï¼ˆçŠ¶æ€ï¼‰ã€‚</p>
<p>æ‰€ä»¥ï¼ŒVue 2 æ—¶ä»£å…»æˆäº†æˆ‘ä»¬çš„æ€ç»´å®šå¼ï¼š<strong>åšé¡¹ç›® = Vue å…¨å®¶æ¡¶ = Vue + Vue Router + Vuexã€‚</strong></p>
<p>åˆ°äº† Vue 3ï¼ŒVuex é€€ä½ï¼ŒPinia ç»§ä»»ã€‚äºæ˜¯å¤§å®¶ç†æ‰€å½“ç„¶åœ°æŠŠå…¬å¼æ¢æˆäº†ï¼š<strong>åšé¡¹ç›® = Vue 3 + Vue Router + Piniaã€‚</strong></p>
<p>å¯åŠ¨ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œ<code>npm create vue@latest</code>ï¼Œä¸€è·¯Â <code>yes</code>Â ä¸‹æ¥ï¼ŒPinia å°±è£…å¥½äº†ã€‚ç„¶åå°±å¼€å§‹Â <code>defineStore</code>ã€‚</p>
<p>ä½†å¤§å®¶å¥½åƒéƒ½å¿½ç•¥äº† Vue 3 æœ€å¤§çš„é©å‘½æ€§å˜åŒ–â€”â€”<strong>ç»„åˆå¼ API (Composition API)</strong>Â æœ¬èº«ï¼Œå°±å·²ç»æ˜¯ä¸€ç§å¼ºå¤§çš„çŠ¶æ€ç®¡ç†æ¨¡å¼äº†ã€‚</p>
<h4 data-id="heading-0"><code>defineStore</code>Â å¸®æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</h4>
<p>è¿˜æ˜¯ç”¨é‚£ç¯‡æ–‡ç« ä¸­çš„ä¾‹å­ï¼Œåšä¸€ä¸ªæœ€ç®€å•çš„â€œç”¨æˆ·çŠ¶æ€ç®¡ç†â€ï¼Œä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<p><strong>1. Pinia çš„æ–¹å¼ï¼š</strong> ä½ å¾—å…ˆåœ¨Â <code>stores/user.ts</code>Â é‡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â { defineStore }Â <span class="hljs-keyword">from</span><span class="hljs-string">'pinia'</span>
<span class="hljs-keyword">import</span>Â { ref, computed }Â <span class="hljs-keyword">from</span><span class="hljs-string">'vue'</span>

exportconstÂ useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'user'</span>,Â <span class="hljs-function">()Â =&gt;</span>Â {
<span class="hljs-comment">// State</span>
<span class="hljs-keyword">const</span>Â token = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span>Â userProfile = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-comment">// Getters</span>
<span class="hljs-keyword">const</span>Â isLoggedIn = <span class="hljs-title function_">computed</span>(<span class="hljs-function">()Â =&gt;</span>Â !!token.<span class="hljs-property">value</span>)

<span class="hljs-comment">// Actions</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">login</span>(<span class="hljs-params">data</span>)Â {
Â  Â  token.<span class="hljs-property">value</span> = data.<span class="hljs-property">token</span>
Â  Â  userProfile.<span class="hljs-property">value</span> = data.<span class="hljs-property">profile</span>
Â  Â Â <span class="hljs-comment">// ... å­˜ localstorage</span>
Â  }

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>)Â {
Â  Â  token.<span class="hljs-property">value</span> =Â <span class="hljs-literal">null</span>
Â  Â  userProfile.<span class="hljs-property">value</span> =Â <span class="hljs-literal">null</span>
Â  Â Â <span class="hljs-comment">// ... æ¸… localstorage</span>
Â  }

<span class="hljs-keyword">return</span>Â { token, userProfile, isLoggedIn, login, logout }
})
</code></pre>
<p>ç„¶ååœ¨ç»„ä»¶é‡ŒÂ <code>useUserStore()</code>ã€‚</p>
<p><strong>2. ç»„åˆå¼ API çš„æ–¹å¼ï¼š</strong> ä½ åœ¨Â <code>stores/user.ts</code>Â (å¯¹ï¼Œä½ ä¹Ÿå¯ä»¥å«Â <code>stores</code>Â ç›®å½•ï¼Œè¿™åªæ˜¯ä¸ªæ–‡ä»¶å¤¹)ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â { ref, computed, reactive }Â <span class="hljs-keyword">from</span><span class="hljs-string">'vue'</span>

<span class="hljs-comment">// ä»¥å‰æˆ‘ä»¬ç”¨ reactiveï¼Œè¿™é‡Œç”¨ ref/computed æ¨¡æ‹Ÿ Pinia çš„ç»“æ„</span>
<span class="hljs-keyword">const</span>Â token = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span>Â userProfile = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-keyword">const</span>Â isLoggedIn = <span class="hljs-title function_">computed</span>(<span class="hljs-function">()Â =&gt;</span>Â !!token.<span class="hljs-property">value</span>)

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">login</span>(<span class="hljs-params">data</span>)Â {
Â  token.<span class="hljs-property">value</span> = data.<span class="hljs-property">token</span>
Â  userProfile.<span class="hljs-property">value</span> = data.<span class="hljs-property">profile</span>
<span class="hljs-comment">// ... å­˜ localstorage</span>
}

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>)Â {
Â  token.<span class="hljs-property">value</span> =Â <span class="hljs-literal">null</span>
Â  userProfile.<span class="hljs-property">value</span> =Â <span class="hljs-literal">null</span>
<span class="hljs-comment">// ... æ¸… localstorage</span>
}

<span class="hljs-comment">// å¯¼å‡ºä¸€ä¸ª hook</span>
<span class="hljs-keyword">export</span><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">useUser</span>(<span class="hljs-params"/>)Â {
<span class="hljs-keyword">return</span>Â { token, userProfile, isLoggedIn, login, logout }
}
</code></pre>
<p>ç„¶ååœ¨ç»„ä»¶é‡ŒÂ <code>useUser()</code>ã€‚</p>
<hr/>
<p>å¥½äº†ï¼Œä½ å¯¹æ¯”ä¸‹è¿™ä¸¤æ®µä»£ç ã€‚</p>
<p><strong>ä½ å‘ç°äº†ä»€ä¹ˆï¼Ÿ</strong></p>
<p>åœ¨ç¬¬äºŒç§æ–¹å¼é‡Œï¼Œæˆ‘åªæ˜¯åˆ æ‰äº†Â <code>defineStore('user', ...)</code>Â é‚£å±‚â€œå£³â€ï¼Œç„¶åæŠŠå¯¼å‡ºçš„Â <code>useUserStore</code>Â æ”¹æˆäº†Â <code>useUser</code>Â (å«ä»€ä¹ˆéƒ½è¡Œ)ã€‚</p>
<p><strong>å…¶ä»–çš„é€»è¾‘ï¼Œä¸€æ¨¡ä¸€æ ·ï¼</strong>Â éƒ½æ˜¯åœ¨ç”¨Â <code>ref</code>Â å’ŒÂ <code>computed</code>ã€‚</p>
<p>Pinia çš„Â <code>defineStore</code>Â åœ¨è¿™ä¸ªåœºæ™¯é‡Œï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å¸®ä½ åšäº†ä¸€ä»¶äº‹ï¼š<strong>åˆ›å»ºäº†ä¸€ä¸ªè·¨ç»„ä»¶å…±äº«çš„ã€å“åº”å¼çš„å•ä¾‹ã€‚</strong></p>
<p>ä½†åœ¨ Vue 3 é‡Œï¼Œ<code>import</code>Â ä¸€ä¸ªåœ¨æ¨¡å—é¡¶å±‚ï¼ˆmodule scopeï¼‰å®šä¹‰çš„Â <code>ref</code>Â æˆ–Â <code>reactive</code>Â å¯¹è±¡ï¼Œå®ƒ<strong>å¤©ç”Ÿå°±æ˜¯å•ä¾‹</strong>ï¼å®ƒå¤©ç”Ÿå°±æ˜¯è·¨ç»„ä»¶å…±äº«çš„ï¼</p>
<p>é‚£ä½ å¯èƒ½ä¼šåé—®äº†ï¼šâ€œé‚£ Pinia å²‚ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Ÿâ€</p>
<p>ä¸ï¼Œå®ƒå½“ç„¶ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ã€‚å®ƒæä¾›äº†Â <code>defineStore</code>Â è¿™ä¸ªâ€œå£³â€ï¼Œæ˜¯ä¸ºäº†ç»™ä½ å¸¦æ¥é¢å¤–çš„å¥½å¤„ï¼Œæœ€æ ¸å¿ƒçš„å°±æ˜¯ï¼š</p>
<ol>
<li><strong>Devtools é›†æˆ</strong>ï¼šè¿™æ˜¯ Pinia æœ€å¤§çš„æ€æ‰‹é”ã€‚ä½ å¯ä»¥åœ¨æ—¶é—´è½´ä¸Šçœ‹åˆ°Â <code>action</code>Â çš„è°ƒç”¨ã€<code>state</code>Â çš„å˜æ›´ã€‚</li>
<li><strong>æ’ä»¶ç³»ç»Ÿ</strong>ï¼šæ¯”å¦‚å®ç°æ•°æ®æŒä¹…åŒ–ï¼ŒPinia æœ‰ç°æˆçš„æ’ä»¶ï¼Œ<code>defineStore</code>Â çš„æ—¶å€™é…ç½®ä¸€ä¸‹å°±è¡Œã€‚</li>
<li><strong>SSR æ”¯æŒ</strong>ï¼šåœ¨æœåŠ¡ç«¯æ¸²æŸ“æ—¶ï¼ŒPinia èƒ½å¸®ä½ å¤„ç†å¥½çŠ¶æ€çš„åºåˆ—åŒ–å’Œâ€œæ³¨æ°´â€(hydration)ã€‚</li>
<li><strong>æ›´ä¸¥æ ¼çš„â€œå¿ƒæ™ºæ¨¡å‹â€</strong> ï¼šå®ƒå¼ºåˆ¶ä½ åŒºåˆ†Â <code>state</code>ã€<code>getters</code>ã€<code>actions</code>ï¼Œè®©å›¢é˜Ÿåä½œæ›´è§„èŒƒã€‚</li>
</ol>
<h4 data-id="heading-1">Piniaçš„ä¼˜åŠ¿ï¼Œä½ çš„é¡¹ç›®çœŸçš„éœ€è¦å—ï¼Ÿ</h4>
<p>æˆ‘ä»¬å†å›åˆ°ä¸Šç¯‡æ–‡ç« çš„æ ¸å¿ƒè§‚ç‚¹ï¼š</p>
<p><strong>åœ¨ä¸€ä¸ªä¸­å°å‹é¡¹ç›®ã€ç‹¬ç«‹å¼€å‘ã€æˆ–è€…å›¢é˜Ÿæˆå‘˜å¯¹ç»„åˆå¼ API éƒ½å¾ˆç†Ÿç»ƒçš„åœºæ™¯ä¸‹ï¼Œä¸Šé¢ Pinia æä¾›çš„ 4 ä¸ªå¥½å¤„ï¼Œä½ çœŸçš„éƒ½éœ€è¦å—ï¼Ÿ</strong></p>
<ul>
<li><strong>Devtools</strong>ï¼šè¯´å®è¯ï¼Œåœ¨æˆ‘åå¤šå¹´çš„ç”Ÿæ¶¯é‡Œï¼Œé™¤äº†åœ¨ Redux/Vuex åˆšå‡ºæ¥é‚£ä¼šå„¿ï¼Œä¸ºäº†è°ƒè¯•å¤æ‚çš„å¼‚æ­¥æµå’Œä¸­é—´ä»¶ï¼Œä¼šå»ç”¨æ—¶é—´æ—…è¡Œã€‚åœ¨ç»å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯é‡Œï¼Œ<code>console.log</code>Â å’Œ Vue Devtools é‡Œè‡ªå¸¦çš„ç»„ä»¶çŠ¶æ€æ£€æŸ¥ï¼Œå·²ç»è§£å†³äº† 99% çš„é—®é¢˜ã€‚ä¸ºäº†é‚£ 1% çš„â€œå¯èƒ½â€ï¼Œå»å¼•å…¥ä¸€ä¸ªåº“ï¼Œåˆ’ç®—å—ï¼Ÿ</li>
<li><strong>æ’ä»¶ç³»ç»Ÿï¼ˆå¦‚æŒä¹…åŒ–ï¼‰</strong> ï¼šç”¨ç»„åˆå¼ API æ€ä¹ˆåšæŒä¹…åŒ–ï¼Ÿå¤ªç®€å•äº†ã€‚ä½ å°è£…çš„Â <code>useUser</code>Â hook é‡Œé¢ï¼Œ<code>login</code>Â çš„æ—¶å€™åŠ ä¸€è¡ŒÂ <code>localStorage.setItem</code>ï¼Œåˆå§‹åŒ–Â <code>token</code>Â çš„æ—¶å€™åŠ ä¸€è¡ŒÂ <code>localStorage.getItem</code>ã€‚è¿™ä¸å°±æ˜¯æœ€åŸå§‹ã€æœ€å¯æ§çš„æŒä¹…åŒ–å—ï¼Ÿä½ éœ€è¦ä¸ºè¿™ä¹ˆç‚¹åŠŸèƒ½ï¼Œå»å­¦ä¸€ä¸ª Pinia æ’ä»¶çš„ API å—ï¼Ÿ</li>
<li><strong>SSR</strong>ï¼šå¦‚æœä½ çš„é¡¹ç›®å‹æ ¹å°±ä¸æ˜¯ SSRï¼Œé‚£è¿™æ¡å¯¹ä½ æ— æ•ˆã€‚</li>
<li><strong>ä¸¥æ ¼çš„å¿ƒæ™ºæ¨¡å‹</strong>ï¼šè¿™æ˜¯æœ€å¤§çš„â€œé™·é˜±â€ã€‚ç»„åˆå¼ API çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯â€œè‡ªç”±â€ã€‚å®ƒå…è®¸ä½ æŠŠÂ <code>state</code>Â å’ŒÂ <code>action</code>Â æ”¾åœ¨ä¸€èµ·ï¼ŒæŒ‰â€œåŠŸèƒ½â€å»ç»„ç»‡ä»£ç ï¼Œè€Œä¸æ˜¯æŒ‰â€œç±»å‹â€ï¼ˆstate/getter/actionï¼‰å»ç»„ç»‡ã€‚<code>defineStore</code>Â æŸç§ç¨‹åº¦ä¸Šï¼Œæ˜¯åˆæŠŠæˆ‘ä»¬æ‹‰å›äº† Vuex çš„é‚£ç§â€œåˆ†é—¨åˆ«ç±»â€çš„æ€ç»´é‡Œã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œâ€œä½ ä¼šå¾—åˆ°æ›´å°‘çš„å¿ƒæ™ºè´Ÿæ‹…â€æŒ‡çš„å°±æ˜¯è¿™ä¸ªã€‚</p>
<p>ä½ ä¸éœ€è¦å»è®°Â <code>defineStore</code>Â çš„ APIï¼Œä¸éœ€è¦å»æƒ³â€œæˆ‘è¿™ä¸ªé€»è¾‘æ˜¯ç®—Â <code>getter</code>Â è¿˜æ˜¯Â <code>action</code>â€ï¼Œä½ å°±æ˜¯åœ¨å†™ JS/TSï¼Œä½ å°±æ˜¯åœ¨å†™Â <code>function</code>ã€‚<strong>è¿™éš¾é“ä¸æ˜¯ä¸€ç§è§£æ”¾å—ï¼Ÿ</strong></p>
<h4 data-id="heading-2"><strong>ä»€ä¹ˆå«â€œæ²¡ç”¨æ˜ç™½ Piniaâ€ï¼Ÿ</strong></h4>
<p>åœ¨æˆ‘çœ‹æ¥ï¼Œæ°æ°ç›¸åã€‚</p>
<p><strong>æŠŠ Pinia å½“æˆæ–°æ—¶ä»£çš„ Vuexï¼Œä¸åˆ†åœºæ™¯ã€å¯åŠ¨é¡¹ç›®å°±å…ˆè£…ä¸Šï¼Œè¿™æ‰æ˜¯â€œæ²¡ç”¨æ˜ç™½ Vue 3â€ã€‚</strong></p>
<p>å¦‚æœæ²¡æœ‰æ˜ç™½ Vue 3 ç»„åˆå¼ API åˆ°åº•ç»™äº†ä½ å¤šå¤§çš„â€œè‡ªç”±â€å’Œâ€œèƒ½åŠ›â€ï¼Œå°±å¯èƒ½ç»§ç»­ç”¨ Vue 2 çš„â€œä¿å§†å¼â€æ€ç»´åœ¨å†™ Vue 3ã€‚</p>
<p>æˆ‘æƒ³äº†å‡ ä¸ªåœºæ™¯ï¼Œå¤§å®¶å‚è€ƒä¸‹ï¼š</p>
<ol>
<li><strong>åœºæ™¯ä¸€ï¼šä¸ªäººé¡¹ç›®ã€å°å›¢é˜Ÿæ•æ·å¼€å‘ã€å†…éƒ¨å·¥å…·</strong></li>
</ol>
<ul>
<li><strong>æˆ‘çš„é€‰æ‹©ï¼š100% ä½¿ç”¨ç»„åˆå¼ APIã€‚</strong></li>
<li><strong>ç†ç”±ï¼š</strong>Â é€Ÿåº¦å¿«ï¼Œçµæ´»ï¼Œé›¶ä¾èµ–ã€‚æˆ‘å¯ä»¥æŒ‰åŠŸèƒ½æ‹†åˆ†Â <code>useCounter.ts</code>,Â <code>useUser.ts</code>,Â <code>useCart.ts</code>... å®ƒä»¬å°±æ˜¯ä¸€å † TS æ¨¡å—ï¼Œéœ€è¦å…±äº«å°±åœ¨é¡¶å±‚å®šä¹‰Â <code>reactive</code>ï¼Œä¸éœ€è¦å°±åªå¯¼å‡ºå‡½æ•°ã€‚æ‰“åŒ…ä½“ç§¯æ›´å°ï¼Œå¿ƒæ™ºè´Ÿæ‹…ä¸ºé›¶ã€‚</li>
</ul>
<ol start="3">
<li><strong>åœºæ™¯äºŒï¼šå¤§å‹ä¼ä¸šçº§åº”ç”¨ã€å¤šå›¢é˜Ÿåä½œã€éœ€è¦å¼ºè§„èŒƒ</strong></li>
</ol>
<ul>
<li><strong>æˆ‘çš„é€‰æ‹©ï¼šæˆ‘ä¼šå€¾å‘äºä½¿ç”¨ Piniaã€‚</strong></li>
<li><strong>ç†ç”±ï¼š</strong>Â è¿™ç§é¡¹ç›®ï¼Œâ€œè§„èŒƒâ€å¤§äºâ€œçµæ´»â€ã€‚<code>defineStore</code>Â æä¾›çš„ç»Ÿä¸€èŒƒå¼ï¼Œèƒ½è®©ä¸åŒæ°´å¹³çš„å¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯æ–°äººï¼‰å†™å‡ºé£æ ¼æ›´ä¸€è‡´çš„ä»£ç ã€‚è€Œä¸”åœ¨è¿™ç§å¤æ‚é¡¹ç›®é‡Œï¼ŒDevtools çš„æ—¶é—´æ—…è¡Œå’ŒçŠ¶æ€å¿«ç…§ï¼Œåœ¨æ’æŸ¥æ·±å±‚ Bug æ—¶ï¼Œç¡®å®èƒ½æ´¾ä¸Šç”¨åœºã€‚</li>
</ul>
<ol start="5">
<li><strong>åœºæ™¯ä¸‰ï¼šéœ€è¦ SSR çš„é¡¹ç›®</strong></li>
</ol>
<ul>
<li><strong>æˆ‘çš„é€‰æ‹©ï¼šç”¨ Piniaã€‚</strong></li>
<li><strong>ç†ç”±ï¼š</strong>Â åˆ«é‡å¤é€ è½®å­ã€‚Pinia å¯¹ SSR çŠ¶æ€å¤„ç†å¾—å¾ˆå¥½ï¼Œè‡ªå·±æä¸€å¥—ç»„åˆå¼ API çš„ SSR çŠ¶æ€åŒæ­¥ï¼Œè´¹æ—¶è´¹åŠ›ï¼Œä¸å€¼å¾—ã€‚</li>
</ul>
<p>æ‰€ä»¥ä½ çœ‹ï¼Œå¹¶ä¸æ˜¯åœ¨å…¨ç›˜å¦å®š Piniaï¼Œè€Œæ˜¯åœ¨å‘¼åå¤§å®¶Â <strong>â€œæŒ‰éœ€é€‰æ‹©â€</strong> ã€‚</p>
<p>ä¸è¦å› ä¸ºâ€œå¤§å®¶éƒ½ç”¨â€æˆ–è€…â€œå®˜æ–¹æ¨èâ€å°±å»ç”¨ã€‚å·¥å…·æ˜¯æ­»çš„ï¼Œäººæ˜¯æ´»çš„ã€‚Vue 3 ç»™äº†æˆ‘ä»¬ä¸€æŠŠæ›´è½»ã€æ›´å¿«çš„åŒ•é¦–ï¼ˆç»„åˆå¼ APIï¼‰ï¼Œä½ ä¸ºä»€ä¹ˆéè¦æŠ±ç€é‚£æŠŠå¾ˆç‰›ã€ä½†ä¹Ÿå¾ˆé‡çš„å¼€å±±åˆ€ï¼ˆPiniaï¼‰ä¸æ”¾ï¼Œè¿åˆ‡ä¸ªæ°´æœéƒ½è¦ç”¨å®ƒå‘¢ï¼Ÿ</p>
<p>ä¸‹æ¬¡åœ¨é¡¹ç›®é‡ŒÂ <code>npm install pinia</code>Â ä¹‹å‰ï¼Œå…ˆåœ 5 ç§’é’Ÿï¼Œé—®é—®è‡ªå·±ï¼š<strong>æˆ‘è¿™æ¬¡ï¼ŒçœŸçš„éœ€è¦å®ƒå—ï¼Ÿè¿˜æ˜¯è¯´ï¼Œå‡ ä¸ªÂ <code>ref</code>Â å’ŒÂ <code>reactive</code>Â å°±èƒ½æå®šäº†ï¼Ÿ</strong></p>
<p>æƒ³æ˜ç™½è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½æ¯”ä½ å¤šåˆ· 10 ç¯‡ Pinia çš„æ•™ç¨‹éƒ½æœ‰ç”¨ã€‚</p>
<p>è¡Œäº†ï¼Œä»Šå¤©å°±èŠåˆ°è¿™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[~/.ssh/config ä½œç”¨è¯¦è§£]]></title>    <link>https://juejin.cn/post/7575119254314057754</link>    <guid>https://juejin.cn/post/7575119254314057754</guid>    <pubDate>2025-11-23T11:31:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575119254314057754" data-draft-id="7575438636330909747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="~/.ssh/config ä½œç”¨è¯¦è§£"/> <meta itemprop="keywords" content="SSH"/> <meta itemprop="datePublished" content="2025-11-23T11:31:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ~/.ssh/config ä½œç”¨è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:31:49.000Z" title="Sun Nov 23 2025 11:31:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼æˆ‘ä»¬æ¥æ·±å…¥è§£é‡Š <code>~/.ssh/config</code> çš„ä½œç”¨ï¼Œä»¥åŠä½ å†™çš„è¿™æ®µé…ç½®ä¸ºä»€ä¹ˆèƒ½è®© <code>ssh devstack-vm</code> ä¸€é”®å®Œæˆå¤æ‚è¿æ¥ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ“ ä¸€ã€<code>~/.ssh/config</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><code>~/.ssh/config</code> æ˜¯ <strong>OpenSSH å®¢æˆ·ç«¯çš„ç”¨æˆ·çº§é…ç½®æ–‡ä»¶</strong>ï¼Œç”¨äºä¸ºä¸åŒçš„ SSH è¿æ¥å®šä¹‰åˆ«åã€ä¸»æœºåœ°å€ã€ç”¨æˆ·åã€å¯†é’¥ã€ä»£ç†è·³è½¬ã€ç«¯å£è½¬å‘ç­‰å‚æ•°ã€‚</p>
<blockquote>
<p>âœ… å®ƒçš„ä½œç”¨ç±»ä¼¼äºâ€œSSH è¿æ¥çš„å¿«æ·æ–¹å¼ + è‡ªåŠ¨åŒ–è„šæœ¬â€ã€‚</p>
</blockquote>
<p>å½“ä½ æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-sql" lang="sql">ssh <span class="hljs-keyword">some</span><span class="hljs-operator">-</span>host
</code></pre>
<p>SSH å®¢æˆ·ç«¯ä¼šï¼š</p>
<ol>
<li>æŸ¥çœ‹ <code>~/.ssh/config</code> ä¸­æ˜¯å¦æœ‰åä¸º <code>some-host</code> çš„ <code>Host</code> å—</li>
<li>å¦‚æœæœ‰ï¼Œå°±<strong>è‡ªåŠ¨åº”ç”¨å…¶ä¸­çš„æ‰€æœ‰é…ç½®</strong></li>
<li>å¦‚æœæ²¡æœ‰ï¼Œåˆ™æŒ‰é»˜è®¤è¡Œä¸ºï¼ˆç›´è¿ã€å½“å‰ç”¨æˆ·åã€æ— ä»£ç†ç­‰ï¼‰å¤„ç†</li>
</ol>
<hr/>
<h2 data-id="heading-1">ğŸ”§ äºŒã€ä½ çš„é…ç½®é€è¡Œè§£æ</h2>
<pre><code class="hljs language-css" lang="css">Host devstack-vm
  HostName <span class="hljs-number">192.168</span>.<span class="hljs-number">122.30</span>
  User stack
  ProxyJump hanwang<span class="hljs-keyword">@192</span>.168.18.133
  LocalForward <span class="hljs-number">8080</span> <span class="hljs-attribute">localhost</span>:<span class="hljs-number">80</span>
</code></pre>





























<table><thead><tr><th>é…ç½®é¡¹</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>Host devstack-vm</code></td><td>å®šä¹‰ä¸€ä¸ª<strong>åˆ«å</strong>ï¼ˆnicknameï¼‰ï¼Œä»¥åå¯ä»¥ç”¨ <code>ssh devstack-vm</code> ä»£æ›¿å®Œæ•´å‘½ä»¤</td></tr><tr><td><code>HostName 192.168.122.30</code></td><td>çœŸæ­£è¦è¿æ¥çš„ç›®æ ‡ IPï¼ˆå³ä½ çš„ DevStack è™šæ‹Ÿæœºï¼‰</td></tr><tr><td><code>User stack</code></td><td>ç™»å½•è¯¥ VM æ—¶ä½¿ç”¨çš„ç”¨æˆ·åæ˜¯ <code>stack</code></td></tr><tr><td><code>ProxyJump hanwang@192.168.18.133</code></td><td>å…ˆé€šè¿‡è·³æ¿æœº <code>hanwang@192.168.18.133</code> ä¸­è½¬ï¼ˆç›¸å½“äºè‡ªåŠ¨åš SSH è·³è½¬ï¼‰</td></tr><tr><td><code>LocalForward 8080 localhost:80</code></td><td>åœ¨æœ¬åœ°ï¼ˆä½ çš„ç”µè„‘ï¼‰ç›‘å¬ 8080 ç«¯å£ï¼Œå¹¶å°†æµé‡é€šè¿‡éš§é“è½¬å‘åˆ° VM çš„ <code>localhost:80</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ğŸ”„ ä¸‰ã€æ‰§è¡Œ <code>ssh devstack-vm</code> æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2>
<p>åŸæœ¬ä½ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œä¸¤æ­¥ï¼š</p>
<h3 data-id="heading-3">âŒ æ‰‹åŠ¨æ–¹å¼ï¼ˆç¹çï¼‰ï¼š</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># ç¬¬ä¸€æ­¥ï¼šç™»å½•è·³æ¿æœº</span>
ssh hanwang@192.<span class="hljs-number">168.18</span>.<span class="hljs-number">133</span>

<span class="hljs-comment"># ç¬¬äºŒæ­¥ï¼ˆåœ¨è·³æ¿æœºä¸Šï¼‰ï¼šå†ç™»å½• VM</span>
ssh stack@192.<span class="hljs-number">168.122</span>.<span class="hljs-number">30</span>
</code></pre>
<p>æˆ–è€…ç”¨æ—§å¼å‘½ä»¤ï¼ˆåµŒå¥— SSHï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">ssh -t <span class="hljs-symbol">hanwang@</span><span class="hljs-number">192.168</span><span class="hljs-number">.18</span><span class="hljs-number">.133</span> ssh <span class="hljs-symbol">stack@</span><span class="hljs-number">192.168</span><span class="hljs-number">.122</span><span class="hljs-number">.30</span>
</code></pre>
<p>è¿˜è¦é¢å¤–å¼€ä¸€ä¸ªç»ˆç«¯åšç«¯å£è½¬å‘ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">ssh -L <span class="hljs-number">8080</span><span class="hljs-symbol">:localhost</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span> -J hanwang<span class="hljs-variable">@192</span>.<span class="hljs-number">168.18</span>.<span class="hljs-number">133</span> stack<span class="hljs-variable">@192</span>.<span class="hljs-number">168.122</span>.<span class="hljs-number">30</span>
</code></pre>
<h3 data-id="heading-4">âœ… ä½¿ç”¨ config åï¼š</h3>
<p>ä½ åªéœ€è¾“å…¥ï¼š</p>
<pre><code class="hljs">ssh devstack-vm
</code></pre>
<p>SSH è‡ªåŠ¨å¸®ä½ å®Œæˆï¼š</p>
<ol>
<li>ä»¥ç”¨æˆ· <code>hanwang</code> ç™»å½•è·³æ¿æœº <code>192.168.18.133</code></li>
<li>ä»è·³æ¿æœºå†ä»¥ç”¨æˆ· <code>stack</code> ç™»å½• <code>192.168.122.30</code></li>
<li>åŒæ—¶åœ¨æœ¬åœ°å¼€å¯ç«¯å£è½¬å‘ï¼š<code>localhost:8080 â†’ VM:80</code></li>
</ol>
<blockquote>
<p>ğŸ’¡ è¿™å°±åƒç»™å¤æ‚çš„å‘½ä»¤èµ·äº†ä¸ªâ€œå¿«æ·æ–¹å¼â€ï¼Œè¿˜é™„å¸¦è‡ªåŠ¨åŒ–åŠŸèƒ½ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸŒŸ å››ã€å¥½å¤„æ€»ç»“</h2>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç®€åŒ–å‘½ä»¤</strong></td><td><code>ssh devstack-vm</code> ä»£æ›¿ä¸€é•¿ä¸²å‚æ•°</td></tr><tr><td><strong>é¿å…é‡å¤è¾“å…¥</strong></td><td>ç”¨æˆ·åã€IPã€è·³æ¿æœºç­‰ä¸ç”¨æ¯æ¬¡å†™</td></tr><tr><td><strong>è‡ªåŠ¨ç«¯å£è½¬å‘</strong></td><td>æ¯æ¬¡è¿æ¥è‡ªåŠ¨å»ºç«‹éš§é“ï¼Œæ— éœ€é¢å¤–å‘½ä»¤</td></tr><tr><td><strong>æ”¯æŒå¯†é’¥ç®¡ç†</strong></td><td>å¯æŒ‡å®š <code>IdentityFile</code> ä½¿ç”¨ç‰¹å®šç§é’¥</td></tr><tr><td><strong>æé«˜å®‰å…¨æ€§</strong></td><td>å‡å°‘æ‰‹åŠ¨è¾“å…¥é”™è¯¯ï¼Œé¿å…å¯†ç æ³„éœ²</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">ğŸ› ï¸ äº”ã€æ‰©å±•ç¤ºä¾‹</h2>
<p>ä½ è¿˜å¯ä»¥æ·»åŠ æ›´å¤šåŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">Host</span> <span class="hljs-string">devstack-vm</span>
  <span class="hljs-string">HostName</span> <span class="hljs-number">192.168</span><span class="hljs-number">.122</span><span class="hljs-number">.30</span>
  <span class="hljs-string">User</span> <span class="hljs-string">stack</span>
  <span class="hljs-string">ProxyJump</span> <span class="hljs-string">hanwang@192.168.18.133</span>
  <span class="hljs-string">LocalForward</span> <span class="hljs-number">8080 </span><span class="hljs-string">localhost:80</span>
  <span class="hljs-string">LocalForward</span> <span class="hljs-number">8774 </span><span class="hljs-string">localhost:8774</span>   <span class="hljs-comment"># Nova API</span>
  <span class="hljs-string">LocalForward</span> <span class="hljs-number">9696 </span><span class="hljs-string">localhost:9696</span>   <span class="hljs-comment"># Neutron API</span>
  <span class="hljs-string">IdentityFile</span> <span class="hljs-string">~/.ssh/id_rsa</span>         <span class="hljs-comment"># æŒ‡å®šç§é’¥</span>
  <span class="hljs-string">IdentitiesOnly</span> <span class="hljs-literal">yes</span>                 <span class="hljs-comment"># åªç”¨æŒ‡å®šå¯†é’¥</span>
  <span class="hljs-string">ServerAliveInterval</span> <span class="hljs-number">60</span>             <span class="hljs-comment"># é˜²æ­¢æ–­è¿</span>
</code></pre>
<p>è¿™æ ·ä¸€æ¬¡è¿æ¥ï¼Œå°±èƒ½è®¿é—®å¤šä¸ª OpenStack æœåŠ¡ï¼</p>
<hr/>
<h2 data-id="heading-7">âœ… å…­ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>æ–‡ä»¶æƒé™å¿…é¡»ä¸¥æ ¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">chmod</span> 600 ~/.ssh/config
<span class="hljs-built_in">chmod</span> 700 ~/.ssh
</code></pre>
<p>å¦åˆ™ SSH ä¼šå¿½ç•¥è¯¥æ–‡ä»¶ï¼ˆå‡ºäºå®‰å…¨è€ƒè™‘ï¼‰ã€‚</p>
</li>
<li>
<p><strong>Host åç§°åŒºåˆ†å¤§å°å†™</strong>ï¼Œå»ºè®®å…¨å°å†™ã€‚</p>
</li>
<li>
<p><strong>ç¼©è¿›ä¸æ˜¯å¿…é¡»çš„</strong>ï¼Œä½†ä¸ºäº†å¯è¯»æ€§å»ºè®®ç”¨ç©ºæ ¼å¯¹é½ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-8">ğŸ¯ æ€»ç»“ä¸€å¥è¯ï¼š</h2>
<blockquote>
<p><code>~/.ssh/config</code> è®©ä½ èƒ½ç”¨ <strong>ç®€å•åˆ«å</strong>ï¼ˆå¦‚ <code>devstack-vm</code>ï¼‰<br/>
è‡ªåŠ¨å®Œæˆ <strong>å¤æ‚è¿æ¥é€»è¾‘</strong>ï¼ˆè·³æ¿æœº + ç”¨æˆ·å + ç«¯å£è½¬å‘ï¼‰ï¼Œ<br/>
æå¤§æå‡å¼€å‘å’Œè¿ç»´æ•ˆç‡ï¼</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œ<code>ssh devstack-vm</code> èƒ½å·¥ä½œï¼Œä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ä½ æå‰å†™å¥½çš„â€œSSH è‡ªåŠ¨åŒ–å‰§æœ¬â€åœ¨å¹•åé»˜é»˜æ‰§è¡Œ ğŸ˜Š</p>
<p>å¦‚æœä½ ç»å¸¸è¿æ¥å¤šå°æœåŠ¡å™¨ï¼Œå¼ºçƒˆå»ºè®®å–„ç”¨è¿™ä¸ªæ–‡ä»¶ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯é€†è®¡ç®—çš„æ–¹æ³•è®ºæ¥æº]]></title>    <link>https://juejin.cn/post/7575119254314090522</link>    <guid>https://juejin.cn/post/7575119254314090522</guid>    <pubDate>2025-11-23T11:50:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575119254314090522" data-draft-id="7575182522411515942" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯é€†è®¡ç®—çš„æ–¹æ³•è®ºæ¥æº"/> <meta itemprop="keywords" content="åç«¯,ä½ä»£ç "/> <meta itemprop="datePublished" content="2025-11-23T11:50:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="canonical_entropy"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289694429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯é€†è®¡ç®—çš„æ–¹æ³•è®ºæ¥æº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289694429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    canonical_entropy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T11:50:19.000Z" title="Sun Nov 23 2025 11:50:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯¹äºè½¯ä»¶é¢†åŸŸçš„å¤§é‡è®¾è®¡åŸåˆ™å’Œæ‰€è°“çš„æ–¹æ³•è®ºï¼Œæˆ‘ä¸€ç›´æŒæœ‰å¾ˆæ·±çš„æ€€ç–‘æ€åº¦ã€‚ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™äº›åŸåˆ™ï¼Œèƒ½å¦ä»ç§‘å­¦çš„å±‚é¢è¯æ˜å®ƒä»¬çš„æœ‰æ•ˆæ€§ï¼Ÿå¯é€†è®¡ç®—ç†è®ºè¯•å›¾ä¸ºè½¯ä»¶æ„é€ æä¾›ä¸€ä¸ªæ›´åŠ åšå®çš„ç†è®ºåŸºç¡€ï¼Œå®ƒæ˜ç¡®æå‡ºåº”è¯¥å°†â€œå·®é‡â€æå‡ä¸ºç¬¬ä¸€æ€§çš„æ¦‚å¿µï¼Œå°†å…¨é‡çœ‹ä½œæ˜¯å·®é‡çš„ä¸€ç§ç‰¹ä¾‹ï¼ˆå…¨é‡=å•ä½å…ƒ+å·®é‡ï¼‰ï¼Œå›´ç»•å·®é‡æ¦‚å¿µå»é‡å»ºæ•´ä¸ªé¢†åŸŸæ¦‚å¿µä½“ç³»ã€‚å¯é€†è®¡ç®—çš„æ€æƒ³æ¥æºä¸æ˜¯è®¡ç®—æœºç§‘å­¦æœ¬èº«ï¼Œè€Œæ˜¯ç†è®ºç‰©ç†å­¦ï¼Œå®ƒå°†è½¯ä»¶çœ‹ä½œæ˜¯å¤„äºä¸æ–­æ¼”åŒ–è¿‡ç¨‹ä¸­çš„æŠ½è±¡å®ä½“ï¼Œåœ¨ä¸åŒçš„å¤æ‚æ€§å±‚æ¬¡ä¸Šç”±ä¸åŒçš„è¿ç®—è§„åˆ™æ‰€æè¿°ï¼Œå®ƒæ‰€å…³æ³¨çš„æ˜¯æ¼”åŒ–è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¾®å°å·®é‡å¦‚ä½•åœ¨ç³»ç»Ÿå†…æœ‰åºçš„ä¼ æ’­å¹¶å‘ç”Ÿç›¸äº’ä½œç”¨ã€‚æœ¬æ–‡å°†ä»‹ç»å¯é€†è®¡ç®—ä»ä½œä¸ºå…¶æ€æƒ³æ¥æºçš„ç»Ÿè®¡ç‰©ç†å­¦å’Œé‡å­åŠ›å­¦æ‰€è·å¾—çš„å¯å‘ã€‚</p>
<h2 data-id="heading-0">ï¼ˆä¸€ï¼‰ç†µå¢åŸç†</h2>
<p>åœ¨é¦™å†œçš„åŸå§‹å®šä¹‰ä¸­ï¼Œä¿¡æ¯æ˜¯èƒ½å¤Ÿç”¨æ¥æ¶ˆé™¤ä¸ç¡®å®šæ€§çš„ä¸œè¥¿ã€‚è€Œåœ¨ç‰©ç†å­¦ä¸­ï¼Œæ‰€è°“çš„ä¸ç¡®å®šæ€§å°±æ˜¯ç³»ç»Ÿçš„æ··ä¹±ç¨‹åº¦ï¼Œè€Œç”¨äºåº¦é‡ç³»ç»Ÿæ··ä¹±ç¨‹åº¦çš„ç‰©ç†é‡å°±æ˜¯ç†µï¼ˆEntropyï¼‰ã€‚æ¥æ”¶åˆ°ä¿¡æ¯åï¼Œä¸ç¡®å®šæ€§é™ä½ï¼Œä¹Ÿå°±æ„å‘³ç€æ··ä¹±ç¨‹åº¦çš„å‡å°‘ï¼Œå› æ­¤ä¿¡æ¯ä¹Ÿå°±è¢«è®¤ä¸ºæ˜¯è´Ÿç†µã€‚</p>
<p>ç†µæ˜¯ç‰©ç†å­¦ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒç”šè‡³æ¯”èƒ½é‡æ¦‚å¿µè¿˜è¦é‡è¦ã€‚çƒ­åŠ›å­¦ç¬¬ä¸€å®šå¾‹å°±æ˜¯èƒ½é‡å®ˆæ’å®šå¾‹ï¼Œå®ƒæŒ‡å‡ºèƒ½é‡åªèƒ½è¢«è½¬åŒ–ï¼Œè€Œä¸å¯èƒ½è¢«åˆ›é€ æˆ–è€…æ¶ˆç­ã€‚è€Œçƒ­åŠ›å­¦ç¬¬äºŒå®šå¾‹æŒ‡å‡ºï¼Œå³ä½¿æœ‰äº†èƒ½é‡ï¼Œä¹Ÿä¸ä¸€å®šèƒ½å¤Ÿå¯¹å¤–åšåŠŸï¼Œå¿…é¡»è€ƒè™‘åˆ°çƒ­åŠ›å­¦è¿‡ç¨‹å†…åœ¨çš„ä¸å¯é€†æ€§ï¼šçƒ­åŠ›å­¦ç³»ç»Ÿä»ä¸€ä¸ªå¹³è¡¡æ€æ¼”åŒ–åˆ°å¦ä¸€å¹³è¡¡æ€çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ç†µæ°¸ä¸å‡å°‘ï¼Œè‹¥è¿‡ç¨‹å¯é€†ï¼Œåˆ™ç†µä¸å˜ï¼Œè‹¥ä¸å¯é€†ï¼Œåˆ™ç†µå¢åŠ ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€è°“ç†µå¢åŸç†ã€‚</p>
<p>ç†µå¢åŸç†æ§åˆ¶äº†æ‰€æœ‰è‡ªç„¶å‘ç”Ÿçš„è¿‡ç¨‹ï¼Œé©±åŠ¨æ‰€æœ‰äº‹ç‰©è‡ªå‘çš„å‘ç€æ··ä¹±æœ€å¤§åŒ–çš„æ–¹å‘å‘å±•ã€‚å› æ­¤ï¼Œåœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥è§‚å¯Ÿåˆ°å¤§å‹è½¯ä»¶äº§å“æ™®éå­˜åœ¨ç€ä»æœ‰åºåˆ°æ··ä¹±çš„å‘å±•å†ç¨‹ã€‚ä¼´éšç€äººå‘˜çš„æ›´æ›¿ã€éœ€æ±‚çš„å˜è¿ï¼Œåœ¨è½¯ä»¶ä¸­å¢åŠ æ–°çš„åŠŸèƒ½å˜å¾—è¶Šæ¥è¶Šå›°éš¾ï¼Œä¿®æ”¹bugç»å¸¸å¼•å…¥æ–°çš„bugï¼Œæ²¡äººèƒ½å¤Ÿè¯´æ¸…æ¥šå¦‚ä½•æ‰èƒ½æŠ½å–ç³»ç»Ÿä¸­çš„ä¸€å°éƒ¨åˆ†è¿›è¡Œå¤ç”¨ï¼Œæœ€ç»ˆåªèƒ½æ¨ç¿»é‡å»ºã€‚</p>
<p>å¯é€†è®¡ç®—çš„æ ¸å¿ƒæ˜¯å¯é€†æ€§ï¼Œè€Œå¯é€†æ€§ä¹‹æ‰€ä»¥é‡è¦ï¼Œä¸ä»…ä»…åœ¨äºå®ƒæ–¹ä¾¿äº†è½¯ä»¶å…ƒç´ çš„çµæ´»å¤ç”¨ï¼Œæ·±å±‚æ¬¡çš„åŸå› æ˜¯å®ƒä½“ç°äº†æˆ‘ä»¬è¿™ä¸ªä¸–ç•Œæœ¬è´¨çš„è¿ä½œè§„å¾‹ã€‚é€šè¿‡éµå¾ªå¯é€†è®¡ç®—åŸåˆ™ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæœ‰æ•ˆçš„æ§åˆ¶è½¯ä»¶æ¼”è¿›è¿‡ç¨‹ä¸­çš„ç†µå¢é€Ÿåº¦ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¦‚æœç³»ç»Ÿèƒ½å¤Ÿåšåˆ°å®Œå…¨å¯é€†ï¼Œåˆ™ç†µæ˜¯ä¿æŒä¸å˜çš„ã€‚</p>
<p>åœ¨è½¯ä»¶æ¶æ„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯è¯´è¦é«˜å†…èšã€ä½è€¦åˆã€å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œä½†æ˜¯ä»€ä¹ˆæ˜¯é«˜ã€ä»€ä¹ˆæ˜¯ä½ã€éœ€è¦åˆ†ç¦»åˆ°ä»€ä¹ˆæ ·çš„ç¨‹åº¦ï¼Ÿå¯é€†è®¡ç®—ç»™å‡ºäº†ä¸€ä¸ªå¯æ“ä½œæ€§æ›´å¼ºçš„æ ‡å‡†ï¼šåˆ†ç¦»åˆ°å¯é€†çš„ç¨‹åº¦å°±å¥½äº†ã€‚å¯¹äºå…·ä½“çš„è½¯ä»¶å¼€å‘ï¼Œå¯é€†è®¡ç®—æ‰€æå‡ºçš„è¦æ±‚æ˜¯ï¼Œä»»ä½•å¢åŠ çš„åŠŸèƒ½éƒ½åº”è¯¥æœ‰é…å¯¹çš„é€†å‘å–æ¶ˆæœºåˆ¶ï¼Œä»»ä½•è¾“å…¥åˆ°ç³»ç»Ÿä¸­çš„ä¿¡æ¯éƒ½åº”è¯¥å­˜åœ¨ä¸€ç§è‡ªåŠ¨åå‘æå–å‡ºæ¥çš„æ–¹æ³•ã€‚</p>
<p>å¯é€†æ€§æ˜¯å¯ä»¥å¤åˆçš„ï¼Œå³å¦‚æœæ¯ä¸ªéƒ¨åˆ†éƒ½å¯é€†ï¼Œä¸”éƒ¨åˆ†ä¹‹é—´çš„ç»“åˆå…³ç³»ä¹Ÿå¯é€†ï¼Œåˆ™ç³»ç»Ÿæ•´ä½“å¯é€†ã€‚è¿™ä¸€ç‰¹ç‚¹ä½¿å¾—é€æ­¥æ„å»ºå¤§å‹çš„å¯é€†ç³»ç»Ÿæˆä¸ºå¯èƒ½ã€‚å…·ä½“æ–¹å¼å¯ä»¥å‚è€ƒè®¾è®¡æ¨¡å¼ä¸­çš„Commandæ¨¡å¼ï¼šæ¯ä¸ªCommandéƒ½åŒ…å«ä¸€ç»„é…å¯¹çš„executeå’Œundoæ“ä½œï¼Œåˆ™ä¸€ç³»åˆ—æŒ‰é¡ºåºæ‰§è¡Œçš„Commandå¯ä»¥è¢«å°è£…æˆä¸€ä¸ªBatchCommandï¼Œå®ƒçš„executeå’Œundoæ“ä½œå¯ä»¥ç”±å­å‘½ä»¤å¤åˆå¾—åˆ°ã€‚</p>
<p>ç°å®ä¸–ç•Œä¸­ï¼Œç†µå¢æ˜¯æ— æ³•é€ƒé¿çš„å®¿å‘½ã€‚ä½†æ˜¯å³ä½¿æ— æ³•å®Œå…¨æ¶ˆé™¤ç†µå¢ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€‰æ‹©ç†µå¢å‘ç”Ÿçš„åœ°æ–¹ï¼Œä¾‹å¦‚å°†ç†µå¢é›†ä¸­åœ¨å·®é‡â–³ä¸­ã€‚ç‰¹å®šå®¢æˆ·çš„éœ€æ±‚æ€»æ˜¯åŒ…å«ç€å¤§é‡éšæœºçš„ã€å¶ç„¶çš„å› ç´ ï¼ŒæŠŠå®ƒä»¬çº³å…¥ç³»ç»Ÿä¸å¯é¿å…çš„ä¼šç ´ååŸå…ˆç»Ÿä¸€å‡è¡¡çš„ç³»ç»Ÿç»“æ„ï¼Œå¦‚æœèƒ½å¤ŸæŠŠè¿™äº›å¶ç„¶å› ç´ é›†ä¸­åœ¨ä¸€ä¸ªå¯æŠ›å¼ƒçš„å·®é‡â–³ä¸­ï¼Œåˆ™å¯ä»¥ä¿æŠ¤æ ¸å¿ƒæ¶æ„ä¸ä¼šå—åˆ°ä¾µèš€ã€‚å½“ç³»ç»Ÿäº¤ä»˜ç»™æ–°çš„å®¢æˆ·æ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æºå¸¦ä¸Šä¸€ä¸ªå®¢æˆ·çš„ä¸ªæ€§åŒ–éœ€æ±‚ï¼Œå¯ä»¥å§‹ç»ˆä»ä¸€ä¸ªä½ç†µçš„çŠ¶æ€å¼€å§‹ã€‚</p>
<h2 data-id="heading-1">ï¼ˆäºŒï¼‰é‡å­åŠ›å­¦ä¸­çš„ä¸–ç•Œå›¾æ™¯</h2>
<p>é‡å­åŠ›å­¦æ˜¯æè¿°å®‡å®™çš„åŸºæœ¬ç†è®ºï¼Œå®ƒæ‰€ç ”ç©¶çš„é—®é¢˜å¯ä»¥å½’ç»“ä¸ºç®—ç¬¦ï¼ˆOperatorï¼‰ä½œç”¨åˆ°æ‰€è°“çš„æ€å‡½æ•°ï¼ˆState Vectorï¼‰ä¸Šï¼Œå¦‚ä½•é©±åŠ¨ç³»ç»Ÿå‘ç”Ÿæ¼”åŒ–çš„é—®é¢˜ã€‚</p>
<p>1925å¹´æµ·æ£®å ¡æå‡ºäº†é‡å­åŠ›å­¦çš„ç¬¬ä¸€ç§è¡¨è¿°å½¢å¼ï¼šçŸ©é˜µåŠ›å­¦ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºæµ·æ£®å ¡å›¾æ™¯ã€‚åœ¨è¿™ä¸€å›¾æ™¯ä¸­ï¼Œæ€å‡½æ•°Ïˆä¸ºå›ºå®šçš„å¯¹è±¡ï¼Œä¸éšæ—¶é—´æ¼”åŒ–ï¼Œè€Œå¯è§‚æµ‹ç®—ç¬¦Açš„æ¼”åŒ–æ»¡è¶³æ–¹ç¨‹</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>A</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mi>i</mi><mi mathvariant="normal">â„</mi></mfrac><mo stretchy="false">[</mo><mi>H</mi><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">]</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi>A</mi></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{dA}{dt} = \frac{i}{\hbar}[H, A] + \frac{\partial A}{\partial t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0225em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord">â„</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">A</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>1926å¹´è–›å®šè°”æå‡ºäº†é‡å­åŠ›å­¦çš„ç¬¬äºŒç§è¡¨è¿°å½¢å¼ï¼šæ³¢åŠ¨åŠ›å­¦ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºè–›å®šè°”å›¾æ™¯ã€‚åœ¨è¿™ä¸€å›¾æ™¯ä¸­ï¼Œç®—ç¬¦ä¸ºå›ºå®šçš„å¯¹è±¡ï¼Œä¸éšæ—¶é—´æ¼”åŒ–ï¼Œè€Œæ€å‡½æ•°çš„æ¼”åŒ–æ»¡è¶³å¤§åé¼é¼çš„è–›å®šè°”æ–¹ç¨‹</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mi mathvariant="normal">â„</mi><mfrac><mi mathvariant="normal">âˆ‚</mi><mrow><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></mrow></mfrac><mi>Ïˆ</mi><mo>=</mo><mi>H</mi><mi>Ïˆ</mi></mrow><annotation encoding="application/x-tex">i\hbar\frac{\partial}{\partial t}\psi = H\psi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mord mathnormal">i</span><span class="mord">â„</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord" style="margin-right:0.05556em;">âˆ‚</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span></span></span></span></span></div>
<p>å…¶åä¸ä¹…ï¼Œè–›å®šè°”è¯æ˜äº†çŸ©é˜µåŠ›å­¦å’Œæ³¢åŠ¨åŠ›å­¦çš„ç­‰ä»·æ€§ã€‚</p>
<p>1927å¹´ç‹„æ‹‰å…‹æå‡ºæ‰€è°“çš„â€œå˜æ¢ç†è®ºâ€ï¼Œå¼•å‡ºäº†é‡å­åŠ›å­¦çš„ç¬¬ä¸‰ç§è¡¨è¿°å½¢å¼ï¼šç›¸äº’ä½œç”¨å›¾æ™¯ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºç‹„æ‹‰å…‹å›¾æ™¯ã€‚åœ¨è¿™ä¸€å›¾æ™¯ä¸­ï¼Œé¦–å…ˆå°†ç³»ç»Ÿçš„Hamiltoné‡æ‹†åˆ†ä¸ºå·²çŸ¥çš„éƒ¨åˆ†å’Œå¾…ç ”ç©¶çš„å¾®å°æ‰°åŠ¨</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo>=</mo><msub><mi>H</mi><mn>0</mn></msub><mo>+</mo><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">H = H_0 + H_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></div>
<p>ç„¶åç ”ç©¶ç³»ç»Ÿå¦‚ä½•åç¦»å·²çŸ¥æ¨¡å‹è¿›è¡Œæ¼”åŒ–ï¼Œå³æˆ‘ä»¬æ‰€å…³å¿ƒçš„æ˜¯å·®é‡æè¿°çš„æ¼”åŒ–æƒ…å†µã€‚åœ¨ç›¸äº’ä½œç”¨å›¾æ™¯ä¸‹ï¼Œæ€å‡½æ•°å’Œç®—ç¬¦éƒ½éšæ—¶é—´æ¼”åŒ–</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mi mathvariant="normal">â„</mi><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>Ïˆ</mi><mi>I</mi></msub><mo>=</mo><msub><mi>H</mi><mrow><mn>1</mn><mo separator="true">,</mo><mi>I</mi></mrow></msub><msub><mi>Ïˆ</mi><mi>I</mi></msub><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mi mathvariant="normal">â„</mi><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi>A</mi><mi>I</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>A</mi><mi>I</mi></msub><mo separator="true">,</mo><msub><mi>H</mi><mrow><mn>0</mn><mo separator="true">,</mo><mi>I</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">i\hbar\frac{d}{dt}\psi_I = H_{1,I}\psi_I, \quad i\hbar\frac{d}{dt}A_I = [A_I, H_{0,I}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mord mathnormal">i</span><span class="mord">â„</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"/><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">i</span><span class="mord">â„</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></div>
<p>æ ¹æ®è¿™ä¸‰ç§å›¾æ™¯éƒ½å¯ä»¥å¾—åˆ°å®Œå…¨ä¸€è‡´çš„ç‰©ç†æµ‹é‡ç»“æœ</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">âŸ¨</mo><mi>A</mi><mo stretchy="false">âŸ©</mo><mo>=</mo><mo stretchy="false">âŸ¨</mo><msub><mi>Ïˆ</mi><mi>S</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>A</mi><mi>S</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>Ïˆ</mi><mi>S</mi></msub><mo stretchy="false">âŸ©</mo><mo>=</mo><mo stretchy="false">âŸ¨</mo><msub><mi>Ïˆ</mi><mi>H</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>A</mi><mi>H</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>Ïˆ</mi><mi>H</mi></msub><mo stretchy="false">âŸ©</mo><mo>=</mo><mo stretchy="false">âŸ¨</mo><msub><mi>Ïˆ</mi><mi>I</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>A</mi><mi>I</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>Ïˆ</mi><mi>I</mi></msub><mo stretchy="false">âŸ©</mo></mrow><annotation encoding="application/x-tex">\langle A \rangle = \langle \psi_S | A_S | \psi_S \rangle = \langle \psi_H | A_H | \psi_H \rangle = \langle \psi_I | A_I | \psi_I \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">âŸ¨</span><span class="mord mathnormal">A</span><span class="mclose">âŸ©</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">âŸ©</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">âŸ¨</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">âŸ©</span></span></span></span></span></div>
<p>ç›¸äº’ä½œç”¨å›¾æ™¯æ˜¯ç‰©ç†å­¦å®¶åœ¨å®é™…å·¥ä½œä¸­ä½¿ç”¨æœ€å¤šçš„å›¾æ™¯ã€‚äº‹å®ä¸Šï¼Œæ•°å­¦ç‰©ç†ä¸­å­˜åœ¨ä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯ï¼šå¾®æ‰°è®ºï¼ˆPerturbation Theoryï¼‰ï¼Œå®ƒç³»ç»ŸåŒ–çš„ç ”ç©¶åœ¨å·²çŸ¥æ¨¡å‹çš„åŸºç¡€ä¸Šæ·»åŠ å¾®å°çš„æ‰°åŠ¨é‡ï¼Œæ–°çš„æ¨¡å‹å¦‚ä½•æ¼”åŒ–çš„é—®é¢˜ã€‚è€Œç†è®ºç‰©ç†ä¸­ç»å¤§å¤šæ•°æœ‰ä»·å€¼çš„è®¡ç®—éƒ½æ˜¯åœ¨å¾®æ‰°è®ºçš„æ¡†æ¶ä¸‹è¿›è¡Œã€‚</p>
<p>å¦‚æœæŠŠé‡å­åŠ›å­¦å’Œè®¡ç®—æœºç†è®ºåšä¸ªå¯¹æ¯”ï¼Œæˆ‘ä»¬ä¼šå‘ç°é‡å­åŠ›å­¦ä¸­çš„ä¸–ç•Œå›¾æ™¯å’Œè®¡ç®—æœºç†è®ºçš„ä¸–ç•Œè§‚ä¹‹é—´å­˜åœ¨ä¸€ä¸ªæœ‰è¶£çš„å¯¹åº”å…³ç³»ï¼š</p>
<ul>
<li>è–›å®šè°”å›¾æ™¯ &lt;--&gt; å›¾çµæœº</li>
<li>æµ·æ£®å ¡å›¾æ™¯ &lt;--&gt; lambdaæ¼”ç®—</li>
<li>ç‹„æ‹‰å…‹å›¾æ™¯ &lt;--&gt; å¯é€†è®¡ç®—</li>
</ul>
<p>å›¾çµæœºå’Œlambdaæ¼”ç®—å»ºç«‹äº†é€šç”¨è®¡ç®—æœºçš„æ¦‚å¿µåŸºç¡€ï¼Œåœ¨ç†è®ºä¸Šè§£å†³äº†è®¡ç®—çš„å¯è¡Œæ€§é—®é¢˜ï¼Œå³ä¸ºä»€ä¹ˆå¯ä»¥å­˜åœ¨ä¸€ç§é€šç”¨çš„æœºå™¨æ‰§è¡Œæœºæ¢°åŒ–çš„åŠ¨ä½œï¼Œä½¿ç”¨æœ‰é™èµ„æºæ¥å®Œæˆæ‰€æœ‰æˆ‘ä»¬èƒ½å¤Ÿæƒ³è§çš„è®¡ç®—ã€‚åœ¨é€šç”¨è®¡ç®—æœºå·²ç»æ™®åŠçš„ä»Šå¤©ï¼Œæˆ‘ä»¬æ‰€é¢ä¸´çš„æœ€å¤§çš„å®é™…é—®é¢˜æ˜¯å¦‚ä½•æœ‰æ•ˆçš„è¿›è¡Œè®¡ç®—çš„é—®é¢˜ã€‚è®¡ç®—æ•ˆç‡çš„æé«˜ä¾èµ–äºæˆ‘ä»¬å‘ç°è®¡ç®—ä¸­çš„"æ·å¾„"ï¼Œè€Œè¿™ä¾èµ–äºæˆ‘ä»¬å¯¹é—®é¢˜æœ¬è´¨çš„æ´å¯Ÿï¼Œè€Œæ´å¯Ÿçš„äº§ç”Ÿä¸é—®é¢˜çš„è¡¨è¿°å½¢å¼æ¯æ¯ç›¸å…³ã€‚è¡¨è±¡ï¼ˆrepresentationï¼‰å˜æ¢æœ¬èº«ç”šè‡³å°±æ˜¯è§£å†³é—®é¢˜çš„ä¸€ç§æ–¹å¼ï¼Œå› ä¸ºå˜æ¢åçš„é—®é¢˜è¡¨è±¡æœ‰å¯èƒ½ä½¿å¾—è§£å†³æ–¹æ¡ˆå˜å¾—æ¸…æ™°å¯è§ã€‚å¯é€†è®¡ç®—å€ŸåŠ©äºé¢†åŸŸæ¨¡å‹å’Œå·®é‡æè¿°ï¼Œä½¿æˆ‘ä»¬çš„æ³¨æ„åŠ›å¾—ä»¥èšç„¦åœ¨å¾…è§£å†³çš„æ–°é—®é¢˜ä¸Šã€‚</p>
<h2 data-id="heading-2">ï¼ˆä¸‰ï¼‰ç¾¤å’Œç»“æ„ä¸»ä¹‰</h2>
<p>è‡ªä»çˆ±å› æ–¯å¦å‘ç°ç›¸å¯¹è®ºä»¥æ¥ï¼Œç°ä»£ç‰©ç†å­¦çš„å¤§å¤šæ•°åŸºæœ¬åŸç†éƒ½å»ºç­‘åœ¨ç¾¤æ¦‚å¿µçš„åŸºç¡€ä¹‹ä¸Šã€‚ä¾‹å¦‚ï¼Œç‹­ä¹‰ç›¸å¯¹è®ºå¯¹åº”äºLorentzç¾¤ï¼Œé‡å­ç”µåŠ¨åŠ›å­¦å¯¹åº”äºU(1)è§„èŒƒç¾¤ç­‰ã€‚</p>
<p>æ‰€è°“ç¾¤ï¼ˆGroupï¼‰ï¼Œå°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªäºŒå…ƒè¿ç®—ï¼ˆä¸å¦¨è®°ä¸ºç¬¦å·+ï¼‰ï¼Œå¹¶æ»¡è¶³å¦‚ä¸‹å››æ¡ç¾¤å…¬ç†çš„éç©ºé›†åˆGï¼š</p>
<ol>
<li><strong>å°é—­å¾‹</strong>ã€‚é›†åˆä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ çš„è¿ç®—ç»“æœä»å±äºè¯¥é›†åˆã€‚</li>
<li><strong>ç»“åˆå¾‹</strong>ã€‚è¿ç®—å¯ä»¥å±€éƒ¨è¿›è¡Œï¼Œè¿ç®—çš„æœ€ç»ˆç»“æœä¸è¿ç®—çš„ç»“åˆé¡ºåºæ— å…³ã€‚</li>
<li><strong>å¹ºå…ƒå¾‹</strong>ã€‚é›†åˆä¸­å­˜åœ¨å•ä½å…ƒ0ï¼Œå®ƒå¯¹ä»»ä½•å…ƒç´ çš„ä½œç”¨ç»“æœéƒ½æ˜¯æ— ä½œç”¨ã€‚</li>
<li><strong>é€†å…ƒå¾‹</strong>ã€‚é›†åˆä¸­å¯¹æ¯ä¸€ä¸ªå…ƒç´ aï¼Œå­˜åœ¨å¯¹åº”çš„é€†å…ƒç´ -aï¼Œå®ƒå¯ä»¥å®Œå…¨å–æ¶ˆaçš„ä½œç”¨ã€‚</li>
</ol>
<p>è¿™å››æ¡å…¬ç†çœ‹ä¼¼éå¸¸ç®€å•ï¼Œå´è•´å«ç€éå¸¸æ·±åˆ»çš„æ•°å­¦å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåªè€ƒè™‘å…ƒç´ ä¸ªæ•°æœ‰é™çš„æ‰€è°“æœ‰é™ç¾¤ï¼Œä¸ç”¨å¢åŠ ä»»ä½•å…¶ä»–å‡å®šï¼Œä»…ä¾èµ–è¿™å››æ¡å…¬ç†ï¼Œå³å¯æ¨å¯¼å‡ºå¤§é‡æ•°å­¦å®šç†ã€‚åœ¨1955å¹´è‡³2004å¹´é—´å…±100å¤šä½æ•°å­¦å®¶åœ¨500å¤šç¯‡æœŸåˆŠæ–‡ç« ä¸­å†™ä¸‹äº†ä¸Šä¸‡é¡µçš„è¯æ˜ï¼Œæ‰å®Œæˆäº†å¯¹æœ‰é™ç¾¤åˆ†ç±»çš„å·¥ä½œã€‚</p>
<p>å°é—­å¾‹æ˜¯ä¸ºäº†ç¡®ä¿æ‰€æœ‰çš„è¿ç®—ç»“æœéƒ½ä»ç„¶åœ¨å®šä¹‰èŒƒå›´ä¹‹å†…ï¼Œä¸ä¼šå‡ºç°è¿ç®—ç»“æœæ— æ³•æè¿°çš„æƒ…å†µï¼Œè¿™æ ·è¿ç®—å°±å¯ä»¥ä¸€ç›´æŒç»­ä¸‹å»ï¼Œæ„æˆå¾ˆé•¿çš„æ¨ç†é“¾æ¡ã€‚ä¾‹å¦‚ï¼ŒLispè¯­è¨€å…·æœ‰æ‰€è°“çš„åŒåƒæ€§ï¼ˆhomoiconicityï¼‰ï¼ŒLispå®çš„è¾“å‡ºä»ç„¶æ˜¯åˆæ³•çš„Lispè¯­è¨€ï¼Œè¿™æ­£æ˜¯å°é—­å¾‹çš„ä¸€ç§ä½“ç°ã€‚</p>
<p>ç»“åˆå¾‹æ„å‘³ç€å¯ä»¥è¿›è¡Œå±€éƒ¨è¿ç®—ï¼Œè€Œä¸ç”¨ä¾èµ–äºå…¨å±€ç»“æ„ï¼Œè¿™æ ·æ‰å¯èƒ½å®ç°å­ç»“æ„çš„äºŒæ¬¡å°è£…ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ»¡è¶³ç»“åˆå¾‹çš„è¿ç®—ï¼Œå¯ä»¥å°†Bå’ŒCæŠ½è±¡ä¸ºä¸€ä¸ªæ–°çš„ç»“æ„Xï¼Œè€Œå°†Då’ŒEæŠ½è±¡ä¸ºä¸€ä¸ªæ–°çš„ç»“æ„Yï¼ŒXå’ŒYçš„ç»„åˆå¯ä»¥è¢«å†æ¬¡æŠ½è±¡ä¸ºç»“æ„Zã€‚</p>
<p>æ»¡è¶³ç»“åˆå¾‹çš„è¿ç®—å¯ä»¥å®ç°å±€éƒ¨ä¼˜åŒ–ï¼Œå³æˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨åˆé€‚çš„åœ°æ–¹åŠ ä¸Šæ‹¬å·ï¼Œå®ç°å±€éƒ¨çš„é¢„è®¡ç®—ã€‚ä¾‹å¦‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>â‹…</mo><mo stretchy="false">(</mo><mi>B</mi><mo>â‹…</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mo>â‹…</mo><mi>B</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A \cdot (B \cdot C) = (A \cdot B) \cdot C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span></div>
<p>æ‰€è°“çš„åˆ†è€Œæ²»ä¹‹ï¼ˆDivide And Conquerï¼‰æŠ€æœ¯ï¼Œä¹‹æ‰€ä»¥èƒ½å¤ŸåŠ é€Ÿè®¡ç®—ï¼Œå¾ˆå¤šæ—¶å€™æ‰€åˆ©ç”¨çš„ä¹Ÿå°±æ˜¯ç»“åˆå¾‹ï¼Œæ¯”å¦‚è¯´å½’å¹¶æ’åºã€‚</p>
<p>å¹ºå…ƒå¾‹çš„ä½œç”¨åœ¨äºå®ƒä½¿å¾—å·®é‡æˆä¸ºç¬¬ä¸€æ€§çš„æ¦‚å¿µã€‚åœ¨å…·æœ‰å•ä½å…ƒçš„ç³»ç»Ÿä¸­ï¼Œä»»ä½•é‡éƒ½å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸å•ä½å…ƒä¹‹é—´çš„å·®é‡ã€‚ä¾‹å¦‚</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mn>0</mn><mo>+</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A = 0 + A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">A</span></span></span></span></span></div>
<p>ä»å“²å­¦ä¸Šè¯´ï¼Œç‰©ç†å­¦æ ¼ç‰©ä»¥è‡´çŸ¥ï¼Œæˆ‘ä»¬æ‰€çŸ¥çš„ä¸€åˆ‡éƒ½åªæ˜¯ä¸–ç•Œçš„å˜åŒ–ï¼Œä¸–ç•Œçš„æœ¬ä½“æ˜¯ä¸å¯è§‚æµ‹çš„ã€‚æ‰€è°“çš„å·®é‡ï¼ˆæœ‰æ­£æœ‰è´Ÿï¼‰å®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬çŸ¥è¯†çš„å…¨éƒ¨ã€‚</p>
<p>å¦‚æœæ»¡è¶³å°é—­å¾‹ï¼Œç»“åˆå¾‹å’Œå¹ºå…ƒå¾‹ï¼Œåœ¨æ•°å­¦ä¸Šå°±å¯ä»¥ç§°ä¹‹ä¸º"å¹ºåŠç¾¤"ã€‚å‡½æ•°å¼ç¼–ç¨‹ä¸­è‘—åçš„Monadï¼Œåªä¸è¿‡æ˜¯è‡ªå‡½å­èŒƒç•´ä¸Šçš„å¹ºåŠç¾¤è€Œå·²ã€‚</p>
<p>Monadåªæ˜¯å¹ºåŠç¾¤ï¼Œå®ƒä¸æ»¡è¶³é€†å…ƒå¾‹ã€‚åœ¨ç¾¤çš„å››æ¡å…¬ç†ä¸­ï¼Œæœ€éš¾è¢«äººä»¬æ‰€è®¤è¯†çš„ä¹Ÿæ˜¯é€†å…ƒå¾‹ã€‚ä»è‡ªç„¶æ•°å‘å±•çš„å†å²æ¥çœ‹ï¼Œæ¬§æ´²æ•°å­¦å®¶ç›´åˆ°17ä¸–çºªæ‰æ¥å—è´Ÿæ•°çš„æ¦‚å¿µï¼Œè¿™åæ˜ å‡ºæœ¬è´¨ä¸Šé€†å…ƒçš„æ¦‚å¿µå­˜åœ¨ä»¤äººå›°æƒ‘ä¹‹å¤„ã€‚åœ¨å½“æ—¶çš„äººä»¬çœ‹æ¥ï¼Œè´Ÿæ•°å¯¹åº”äºä¸å­˜åœ¨çš„äº‹ç‰©ï¼Œæ—¢ç„¶å¯¹åº”çš„å¯¹è±¡ä¸å­˜åœ¨ï¼Œè´Ÿæ•°æœ¬èº«æ€ä¹ˆèƒ½å¤Ÿå­˜åœ¨å‘¢ï¼Ÿ</p>
<p>é€†è¿ç®—å¯¹äºå¾ˆå¤šæ•°å­¦æ¨å¯¼æ¥è¯´éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä¾‹å¦‚åœ¨å¼•å…¥è´Ÿæ•°ä¹‹å‰ï¼Œ</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mo>+</mo><mn>5</mn><mo>=</mo><mn>3</mn><mspace width="1em"/><mtext>å’Œ</mtext><mspace width="1em"/><mi>x</mi><mo>+</mo><mn>3</mn><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">x + 5 = 3 \quad \text{å’Œ} \quad x + 3 = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord">3</span><span class="mspace" style="margin-right:1em;"/><span class="mord text"><span class="mord cjk_fallback">å’Œ</span></span><span class="mspace" style="margin-right:1em;"/><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5</span></span></span></span></span></div>
<p>è¿™ä¸¤ä¸ªæ–¹ç¨‹çš„ç»“æ„æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œå®ƒä»¬éœ€è¦ä¸åŒçš„æ±‚è§£æŠ€æœ¯ï¼Œå› æ­¤ä¹Ÿå°±ä¸å¯èƒ½åˆ©ç”¨ç¬¦å·æŠ½è±¡å‡ºäºŒæ¬¡æ–¹ç¨‹çš„æ ‡å‡†å½¢å¼</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>+</mo><mi>c</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">ax^2 + bx + c = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"/><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"/><span class="mord mathnormal">b</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span></div>
<p>å¼•å…¥è´Ÿæ•°æ‰ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„æ–¹å¼æå‡ºé—®é¢˜ï¼Œå¹¶ç ”ç©¶é€šç”¨çš„æ±‚è§£æŠ€æœ¯ã€‚</p>
<p>åŸºäºé€†å…ƒå¯ä»¥åœ¨ä»»æ„å…ƒç´ ä¹‹é—´å»ºç«‹å…³è”ï¼Œä»è€Œå®ç°ä»»æ„å…ƒç´ ä¹‹é—´çš„è½¬åŒ–ã€‚è¿™æ ·å…ƒç´ ä¹‹é—´çš„å…³ç³»å°±çªç ´äº†ç®€å•çš„æ•´ä½“-éƒ¨åˆ†æˆ–è€…ä¸€èˆ¬-ç‰¹æ®Šç­‰å…³ç³»çš„èŒƒç•´ï¼Œè¿›å…¥æ›´åŠ æŠ½è±¡çš„ç»“æ„è¿ç®—èŒƒç•´ã€‚è¿™ç§æ€æƒ³ä¸Šçš„å˜é©å¯å‘äº†å“²å­¦ä¸­çš„ç»“æ„ä¸»ä¹‰æ€æ½®ã€‚</p>
<p>åœ¨å“²å­¦ä¸Šï¼Œç»“æ„ä¸»ä¹‰æå‡ºç»“æ„å…·æœ‰ä¸‰ä¸ªè¦ç´ ï¼šæ•´ä½“æ€§ï¼Œè½¬æ¢æ€§ï¼ˆå…·æœ‰è½¬æ¢è§„å¾‹æˆ–æ³•åˆ™ï¼‰ï¼Œè‡ªå¾‹æ€§ï¼ˆè‡ªèº«è°ƒæ•´æ€§ï¼‰ã€‚æ•´ä½“æ€§æ„å‘³ç€ç»“æ„ä¸èƒ½è¢«ç®€å•çš„åˆ‡åˆ†ï¼Œå…¶æ„æˆè¦ç´ é€šè¿‡å†…åœ¨çš„å…³ç³»è¿ç®—å®ç°å¤§èŒƒå›´çš„å…³è”ä¸è½¬æ¢ï¼Œæ•´ä½“ä¹‹æ‰€ä»¥æˆä¸ºæ•´ä½“æ­£æ˜¯ä»¥è½¬æ¢/è¿ç®—çš„ç¬¬ä¸€æ€§ä¸ºä¿è¯çš„ã€‚è¿™ç§è½¬æ¢å¯ä»¥æ˜¯å…±æ—¶çš„ï¼ˆåŒæ—¶å­˜åœ¨çš„å„å…ƒç´ ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å†æ—¶çš„ï¼ˆå†å²çš„è½¬æ¢æ„é€ è¿‡ç¨‹ï¼‰ï¼Œè¿™æ„å‘³ç€ç»“æ„æ€»è¦æ±‚ä¸€ä¸ªå†…åœ¨çš„æ„é€ è¿‡ç¨‹ï¼Œåœ¨ç‹¬ç«‹äºå¤–éƒ¨ç¯å¢ƒçš„æƒ…å†µä¸‹ç»“æ„å…·æœ‰æŸç§è‡ªç»™è‡ªè¶³çš„ç‰¹æ€§ï¼Œä¸ä¾èµ–äºå¤–éƒ¨æ¡ä»¶å³å¯ç‹¬ç«‹çš„å­˜åœ¨å¹¶ä¿æŒå†…åœ¨çš„æ´»åŠ¨ã€‚è‡ªå¾‹æ€§æ„å‘³ç€ç»“æ„å†…åœ¨çš„è½¬æ¢æ€»æ˜¯ç»´æŒç€æŸç§å°é—­æ€§å’Œå®ˆæ’æ€§ï¼Œç¡®ä¿æ–°çš„æˆåˆ†åœ¨æ— é™åœ°æ„æˆè€Œç»“æ„è¾¹ç•Œå´ä¿æŒç¨³å®šã€‚æ³¨æ„åˆ°è¿™é‡Œå¯¹ç»“æ„çš„è¯„åˆ¤å¹¶ä¸æ˜¯æ¥è‡ªå¤–åœ¨è§„èŒƒå’Œçº¦æŸï¼Œè€Œæ˜¯åŸºäºç»“æ„å†…åœ¨çš„è§„å¾‹æ€§ï¼Œæ‰€å¼ºè°ƒçš„ä¸æ˜¯ç»“æ„å¯¹å¤–éƒ¨æ¡ä»¶çš„é€‚åº”æ€§ï¼Œè€Œæ˜¯è‡ªèº«æ¦‚å¿µä½“ç³»çš„å®Œå¤‡æ€§ã€‚å®é™…ä¸Šï¼Œä¸€ä¸ªæ— æ³•ç›´æ¥å¯¹åº”äºå½“å‰å®é™…ç¯å¢ƒçš„ç»“æ„ä»ç„¶å¯èƒ½å…·æœ‰é‡è¦çš„ä»·å€¼ï¼Œå¹¶åœ¨è§£å†³é—®é¢˜çš„è¿‡ç¨‹ä¸­æ‰®æ¼”ä¸å¯æˆ–ç¼ºçš„è§’è‰²ã€‚åœ¨åˆç†æ€§è¿™ä¸ªè§†è§’ä¸‹ï¼Œæˆ‘ä»¬æ‰€å…³æ³¨çš„ä¸ä»…ä»…æ˜¯å½“å‰çš„ç°å®ä¸–ç•Œï¼Œè€Œæ˜¯æ‰€æœ‰å¯èƒ½çš„ä¸–ç•Œã€‚ç»“æ„ç‹¬ç«‹äºå†…å®¹å­˜åœ¨äºæŠ½è±¡çš„æ•°å­¦ä¸–ç•Œä¸­ï¼Œä¸€ä¸ª"åˆç†"çš„ç»“æ„çš„ä»·å€¼å¿…èƒ½åœ¨å®ƒæ‰€é€‚åº”çš„å…·ä½“ä¸–ç•Œä¸­å‡¸æ˜¾å‡ºæ¥ã€‚</p>
<p>åœ¨å»ºç«‹é¢†åŸŸæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ç»å¸¸ä¼šé—®è¿™ä¸ªæ¨¡å‹æ˜¯å¦æ˜¯å¯¹ä¸šåŠ¡çš„å‡†ç¡®æè¿°ï¼Œæ˜¯å¦å¯ä»¥é€‚åº”éœ€æ±‚çš„å˜æ›´ï¼Œæ˜¯å¦å…è®¸æœªæ¥çš„å„ç§æ‰©å±•ç­‰ç­‰ã€‚ä½†æ˜¯å¦‚æœæ¢ä¸€ä¸ªæ€ç»´æ–¹å‘ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™äº›é—®é¢˜éƒ½å‡å®šäº†å­˜åœ¨æœ€é€‚åˆä¸šåŠ¡é¢†åŸŸçš„å”¯ä¸€ç†æƒ³çš„æ¨¡å‹ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å½“å‰æ¨¡å‹å’Œç†æƒ³çš„æ¨¡å‹ä¹‹é—´ç›¸å·®å¤šè¿œã€‚è¿™äº›é—®é¢˜éƒ½æ˜¯é’ˆå¯¹æœ€ç»ˆç¡®ç«‹çš„æ¨¡å‹è€Œå‘é—®çš„ï¼Œè€Œåœ¨æ¨¡å‹æ„å»ºçš„è¿‡ç¨‹ä¸­ï¼Œé‚£äº›å¯è¢«åˆ©ç”¨çš„ï¼Œå·²å­˜åœ¨çš„æˆ–è€…å¯ä»¥å­˜åœ¨çš„æ¨¡å‹åˆæ˜¯å“ªäº›å‘¢ï¼Ÿæ¯ä¸€ä¸ªä¿¡æ¯æ¨¡å‹éƒ½å¯¹åº”ç€æŸç§è‡ªåŠ¨æ¨ç†æœºï¼Œå¯ä»¥æ¥æ”¶ä¿¡æ¯å¹¶åšä¸€å®šçš„æ¨å¯¼ç»¼åˆå·¥ä½œã€‚ä¸€ä¸ªå¯è¡Œçš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½æ›´æœ‰æ•ˆçš„åˆ©ç”¨å·²æœ‰çš„ä¿¡æ¯è¿›è¡Œæ¨å¯¼ï¼Œå¦‚ä½•æ¶ˆé™¤å†—ä½™å¹¶å‡å°‘å„ç§è½¬æ¢æˆæœ¬ã€‚æˆ‘ä»¬ç»å¸¸å¯ä»¥è§‚å¯Ÿåˆ°ï¼ŒæŸä¸€ä¿¡æ¯ç»„ç»‡æ–¹å¼æ›´å……åˆ†çš„å‘æ˜äº†ä¿¡æ¯ä¹‹é—´çš„å†…åœ¨å…³è”ï¼ˆè¡¨ç°ä¸ºå®ƒå¯¹ä¿¡æ¯çš„ä½¿ç”¨ä¸æ˜¯ç®€å•çš„å±€åŸŸåŒ–çš„ï¼Œè€Œæ˜¯åœ¨å¤šå¤„å‘ˆç°ä¸ºäº’ç›¸çº ç¼ çš„æ–¹å¼ï¼Œéš¾ä»¥è¢«åˆ†è§£ï¼‰ï¼Œè¿™ç§å†…åœ¨å…³è”è¶³å¤Ÿä¸°å¯Œï¼Œä»¥è‡³äºæˆ‘ä»¬ä¸ä¾èµ–äºå¤–éƒ¨å› ç´ å°±å¯ä»¥ç‹¬ç«‹çš„ç†è§£ã€‚è¿™ç§çº ç¼ åœ¨ä¸€èµ·çš„ä¿¡æ¯å—è‡ªç„¶ä¼šæˆä¸ºæˆ‘ä»¬å»ºæ¨¡çš„å¯¹è±¡ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä¸å†å¼ºæ±‚å•ä¸€çš„ã€å¤§è€Œå…¨çš„æ¨¡å‹ï¼Œä½¿å¾—æ¨¡å‹çš„"è¦†ç›–èƒ½åŠ›"ä¸å†æ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ï¼Œé‚£ä¹ˆå»ºæ¨¡çš„æ€ç»´å›¾å¼å°†ä¼šå‘ç”Ÿæ·±åˆ»çš„è½¬å˜ï¼šæœ€ç»ˆçš„æ¨¡å‹å¯ä»¥ç”±ä¸€ç³»åˆ—å¾®æ¨¡å‹äº¤ç»‡æ„æˆï¼Œæ¯ä¸€ä¸ªå¾®æ¨¡å‹åœ¨æŸç§ç¨‹åº¦ä¸Šè¯´éƒ½æ˜¯è‡ªç»™è‡ªè¶³ã€è‡ªåœ†å…¶è¯´çš„ï¼Œå®ƒçš„å­˜åœ¨åˆç†æ€§ç”±å…¶å†…åœ¨é€»è¾‘çš„è‡ªæ´½æ€§å†³å®šã€‚åœ¨è¿™ç§å›¾å¼ä¸‹ï¼Œæ‰€è°“çš„æ¨¡å‹å°±ç›¸å½“äºæ˜¯å·²ç»ç¡®ç«‹çš„æ•°å­¦å®šç†ï¼Œå¦‚æœå¢åŠ æ–°çš„å‡è®¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å·²æœ‰çš„å®šç†æ¨å¯¼å‡ºæ–°çš„å®šç†ï¼Œä¹Ÿå°±æ˜¯å»ºç«‹æ–°çš„æ¨¡å‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[Ai Agent] 09 LangGraph è¿›é˜¶ï¼šæ„å»ºå¯æ§ã€å¯åä½œçš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7575090551357669428</link>    <guid>https://juejin.cn/post/7575090551357669428</guid>    <pubDate>2025-11-23T09:28:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575090551357669428" data-draft-id="7575090551357653044" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[Ai Agent] 09 LangGraph è¿›é˜¶ï¼šæ„å»ºå¯æ§ã€å¯åä½œçš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ"/> <meta itemprop="keywords" content="LangChain,Agent"/> <meta itemprop="datePublished" content="2025-11-23T09:28:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†ä¼šå‘€"/> <meta itemprop="url" content="https://juejin.cn/user/446878782598644"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [Ai Agent] 09 LangGraph è¿›é˜¶ï¼šæ„å»ºå¯æ§ã€å¯åä½œçš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446878782598644/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†ä¼šå‘€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T09:28:09.000Z" title="Sun Nov 23 2025 09:28:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åšå®¢é…å¥—ä»£ç å‘å¸ƒäº<a href="https://link.juejin.cn?target=https%3A%2F%2Fso.csdn.net%2Fso%2Fsearch%3Fq%3Dgithub%26spm%3D1001.2101.3001.7020" title="https://so.csdn.net/so/search?q=github&amp;spm=1001.2101.3001.7020" target="_blank" ref="nofollow noopener noreferrer">github</a>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAnnyfee%2Fagent-craft" title="https://github.com/Annyfee/agent-craft" target="_blank" ref="nofollow noopener noreferrer">09 LangGraph è¿›é˜¶</a></p>
<p><strong>æœ¬ç³»åˆ—æ‰€æœ‰åšå®¢å‡é…å¥—Gihubå¼€æºä»£ç ï¼Œå¼€ç®±å³ç”¨ï¼Œä»…éœ€é…ç½®API_KEYã€‚</strong></p>
<p>å¦‚æœè¯¥Agentæ•™å­¦ç³»åˆ—å¸®åˆ°äº†ä½ ï¼Œ<strong>æ¬¢è¿ç»™æˆ‘ä¸ªStarâ­</strong>ï¼</p>
<p><strong>çŸ¥è¯†ç‚¹</strong>ï¼š<strong>Human-in-the-Loopï¼ˆäººå·¥å¹²é¢„ï¼‰ï½œ Graph-as-a-Toolï¼ˆå›¾å³å·¥å…·ï¼‰| Multi-Agent å¤šæ™ºèƒ½ä½“ç¼–æ’</strong></p>
<hr/>
<h2 data-id="heading-0">å‰è¨€ï¼š</h2>
<p>åœ¨08ç¯‡ä¸­ï¼Œæˆ‘ä»¬äº²æ‰‹ç”¨LangGraphå®ç°äº†ä¸€ä¸ª<strong>é€æ˜ã€å¯è¿½è¸ªã€å¸¦è®°å¿†</strong>çš„ReActã€‚å®ƒèƒ½æ€è€ƒã€è°ƒç”¨å·¥å…·å¹¶è®°ä½å†å²ï¼Œçœ‹èµ·æ¥å·²è¶³å¤Ÿå¼ºå¤§ã€‚</p>
<p>ä½†æ˜¯åœ¨ç”Ÿäº§çº§ç¯å¢ƒï¼Œå®ƒç«‹é©¬ä¼šæ’ä¸Šä¸‰å¤§éš¾é¢˜ï¼š</p>
<p><strong>å…¶ä¸€ã€å®‰å…¨å¤±æ§ï¼š</strong></p>
<p>Agentå¯ä»¥è‡ªåŠ¨åˆ é™¤æ•°æ®ã€å‘é€é‚®ä»¶ã€è½¬è´¦ä»˜æ¬¾â€”â€”æ²¡æœ‰ä»»ä½•ç¡®è®¤æœºåˆ¶ï¼Œä¸€æ—¦å‡ºé”™ï¼Œæ— å¯æŒ½å›ã€‚</p>
<p><strong>å…¶äºŒã€å·¥ä½œæµè‡ƒè‚¿ï¼š</strong></p>
<p>ä¸ºäº†è®©Agentå¤„ç†å¤æ‚ä»»åŠ¡ï¼Œæˆ‘ä»¬åœ¨å•ä¸ªèŠ‚ç‚¹é‡Œä¸æ–­å †ç Œé€»è¾‘ï¼šâ€œå…ˆéªŒè¯è¾“å…¥&gt;å†æŸ¥æ•°æ®&gt;ç„¶åè¿›è¡Œä¸šåŠ¡è®¡ç®—&gt;æœ€åæ ¼å¼åŒ–è¾“å‡º...â€</p>
<p>èŠ‚ç‚¹å‡½æ•°è¶Šæ¥è¶Šé•¿ï¼Œæµç¨‹è‡ƒè‚¿ã€‚æ¯æ¬¡ä¿®æ”¹ä¸šåŠ¡é€»è¾‘éƒ½éœ€è¦é‡å†™æ•´ä¸ªå‡½æ•°ï¼Œæµ‹è¯•éš¾åº¦é£™å‡ã€‚</p>
<p><strong>å…¶ä¸‰ã€èŒè´£æ··ä¹±ï¼š</strong></p>
<p>æ‰€æœ‰åŠŸèƒ½éƒ½æŒ¤åœ¨ä¸€ä¸ªAgenté‡Œï¼Œå®ƒæ—¢æ˜¯ç ”ç©¶å‘˜åˆæ˜¯ä¸“å®¶è¿˜æ˜¯å®¢æœï¼Œèº«å…¼æ•°èŒï¼Œæ›´åˆ«æè¿˜è¦åŠ ä¸Šä¸æ–­æ‰©å¤§çš„è®°å¿†ã€‚çŸ­æœŸå°šå¯ï¼Œé•¿æœŸå¿…ç‚¸ã€‚</p>
<p>æ‰€ä»¥ï¼Œæœ¬ç¯‡ä¸ºè¿™ä¸‰å¤§ç—›ç‚¹åˆ†åˆ«æä¾›äº†ä¸‰ç§å¯¹åº”è§£å†³çš„è¿›é˜¶èƒ½åŠ›ï¼š</p>
<p><strong>Human-in-the-Loopï¼ˆäººå·¥å¹²é¢„ï¼‰</strong> ï¼šè§£å†³å®‰å…¨å¤±æ§ï¼›</p>
<p><strong>Graph-as-a-toolï¼ˆå›¾å³å·¥å…·ï¼‰</strong> ï¼šè§£å†³å·¥ä½œæµè‡ƒè‚¿ï¼›</p>
<p><strong>Multi-Agentï¼ˆå¤šæ™ºèƒ½ä½“ç¼–æ’ï¼‰</strong> ï¼šè§£å†³èŒè´£æ··ä¹±ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸‰ä¸ªèƒ½åŠ›ï¼Œé€ä¸€æ”»å…‹ä¸Šè¿°çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€Human-in-the-Loopï¼šè®©Agentå­¦ä¼šâ€œè¯·ç¤ºâ€</h2>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆéœ€è¦äººå·¥å¹²é¢„</h3>
<p>å…¨è‡ªåŠ¨æ‰§è¡Œåœ¨demoè¿è¡Œä¸­å¬èµ·æ¥å¾ˆå¥½ï¼Œä½†åœ¨å®é™…è¿è¡Œä¸­éå¸¸<strong>æå…¶å±é™©</strong>ã€‚</p>
<p>æ¯”å¦‚ç”¨æˆ·è¯´ï¼Œâ€œæŠŠé¡¹ç›®é¢„ç®—é‚®ä»¶å‘ç»™è´¢åŠ¡â€ï¼ŒAgentè‡ªåŠ¨è°ƒç”¨send_email(to="@xx.com",content="xx")ï¼Œå¦‚æœå†…å®¹æœ‰è¯¯ï¼Œé‚®ä»¶ä¸€æ—¦å‘å‡ºæ— æ³•æ’¤å›ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼š<strong>åœ¨æ‰§è¡Œé«˜é£é™©æ“ä½œå‰æš‚åœï¼Œç­‰å¾…äººç±»ç¡®è®¤</strong>ã€‚</p>
<p>Langgraphæä¾›äº†å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼š<strong>interrupt_before + MemorySaverã€‚</strong></p>
<ul>
<li><strong>MemorySaver</strong>ä¼šå°†å›¾çš„å½“å‰çŠ¶æ€ï¼ˆåŒ…æ‹¬æ¶ˆæ¯å†å²ã€ä¸­é—´å˜é‡ï¼‰æŒä¹…åŒ–ï¼›</li>
<li><strong>interrupt_before=["node_name"]</strong> è¡¨ç¤ºâ€œåœ¨è¿›å…¥è¯¥èŠ‚ç‚¹å‰æš‚åœæ‰§è¡Œâ€ï¼›</li>
<li>æš‚åœåï¼Œç¨‹åºå¯ä»¥æ£€æŸ¥å³å°†æ‰§è¡Œçš„æ“ä½œï¼Œå¹¶è¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­ï¼›</li>
<li>è‹¥ç”¨æˆ·æ‰¹å‡†ï¼Œè°ƒç”¨<strong>app.stream(Noneï¼Œconfig)</strong> å³å¯ä»æ–­ç‚¹æ¢å¤æ‰§è¡Œ</li>
</ul>
<p>è¿™ç›¸å½“äºä¸ºAgentåŠ äº†ä¸€é“ <strong>â€œå®‰å…¨é”â€</strong> ã€‚</p>
<p>äººä¸ºå®¡æ‰¹çš„æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªå‘é‚®ä»¶Agentï¼š</p>
<p>å½“ä½ å‘é‚®ä»¶æ—¶ï¼Œè¯¥Agentä¼šæš‚åœå¹¶æ˜¾ç¤ºå³å°†æ‰§è¡Œçš„æ“ä½œï¼Œç­‰å¾…ä½ è¾“å…¥yesæ‰ç»§ç»­ã€‚</p>
<p>å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><strong>1. æå‰ç¡®å®šå¥½å“ªä¸ªèŠ‚ç‚¹éœ€è¦â€œå®¡æ‰¹â€ï¼Œåœ¨è¿™é‡Œåœä½ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">app</span> = workflow.compile(
    <span class="hljs-comment"># åœ¨å†…å­˜é‡ŒåšçŠ¶æ€æŒä¹…åŒ–</span>
    <span class="hljs-attr">checkpointer</span>=MemorySaver(),
    <span class="hljs-attr">interrupt_before</span>=[<span class="hljs-string">"tools"</span>] <span class="hljs-comment"># é€‰æ‹©è¦äººå·¥å®¡æ‰¹çš„èŠ‚ç‚¹ -- è´Ÿè´£åœ¨å“ªé‡Œåœï¼Œä¹‹åçš„ä»£ç è´Ÿè´£åœäº†ä¹‹åæ€ä¹ˆåŠ</span>
)
</code></pre>
<p><strong>2. è§¦å‘æ‰§è¡Œï¼Œå¹¶è‡ªåŠ¨æš‚åœ</strong></p>
<p>æ³¨ï¼šæ­¤å¤„ç”¨streamæµå¼ï¼Œæ˜¯åˆ©ç”¨æµå¼APIçš„ä¸­æ–­æœºåˆ¶ï¼Œä½¿å…¶èƒ½å¤Ÿç²¾å‡†åœ¨ç‰¹å®šèŠ‚ç‚¹å‰æš‚åœã€‚</p>
<pre><code class="hljs language-ini" lang="ini">    while 1:
        <span class="hljs-comment"># è§¦å‘å·¥ä½œæµæ‰§è¡Œï¼Œæ¨è¿›åˆ°ä¸‹ä¸€ä¸ªä¸­æ–­ç‚¹æˆ–è‡ªç„¶ç»“æŸ</span>
        for _ in app.stream(inputs,config,<span class="hljs-attr">stream_mode</span>=<span class="hljs-string">"values"</span>): <span class="hljs-comment"># æµå¼æ‰§è¡Œ</span>
        <span class="hljs-comment"># inputsæ³¨å…¥äº‹ä»¶;configç¡®å®šå›è¯id;"values":å®Œæ•´è®°å½•æ¯æ­¥ç»“æœ</span>
            pass   <span class="hljs-comment"># å¿…é¡»è¿­ä»£ç”Ÿæˆå™¨ï¼Œæ‰èƒ½å®é™…æ‰§è¡Œå·¥ä½œæµ</span>
</code></pre>
<p><strong>3. è·å–æš‚åœèŠ‚ç‚¹çš„çŠ¶æ€ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">        <span class="hljs-comment"># è·å–å½“å‰çŠ¶æ€</span>
        <span class="hljs-attr">snapshot</span> = app.get_state(config)
        <span class="hljs-attr">next_tasks</span> = snapshot.next <span class="hljs-comment"># è¿”å›ä¸‹ä¸€æ­¥è¦æ‰§è¡Œçš„èŠ‚ç‚¹ååˆ—è¡¨</span>
</code></pre>
<p><strong>4. å¦‚æœæ²¡æœ‰ä¸‹ä¸€æ­¥ï¼Œè¯´æ˜å·¥ä½œæµå·²ç»“æŸï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> next_tasks:
            final_msg = snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\næœ€ç»ˆå›å¤:<span class="hljs-subst">{final_msg.content}</span>'</span>)
            <span class="hljs-keyword">break</span>
</code></pre>
<p><strong>5. å¦‚æœä¸‹ä¸€æ­¥æ˜¯éœ€è¦å®¡æ‰¹çš„èŠ‚ç‚¹ï¼Œè¿›è¡Œå®¡æ‰¹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-keyword">if</span> <span class="hljs-string">"tools"</span> <span class="hljs-keyword">in</span> next_tasks:
            last_msg = snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
            tool_call = last_msg.tool_calls[<span class="hljs-number">0</span>]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\nâš ï¸ Agentå‡†å¤‡æ‰§è¡Œæ“ä½œï¼š'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'    å·¥å…·åç§°ï¼š<span class="hljs-subst">{tool_call[<span class="hljs-string">"name"</span>]}</span>'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'    å‚æ•°ï¼š<span class="hljs-subst">{tool_call[<span class="hljs-string">"args"</span>]}</span>'</span>)

            approval = <span class="hljs-built_in">input</span>(<span class="hljs-string">"\nâœ… æ˜¯å¦æ‰¹å‡†æ‰§è¡Œï¼Ÿ(è¾“å…¥ 'yes' ç»§ç»­ï¼Œå…¶ä»–å–æ¶ˆ): "</span>).strip().lower()
            <span class="hljs-keyword">if</span> approval == <span class="hljs-string">"yes"</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">'\n ç»§ç»­æ‰§è¡Œ...'</span>)
                inputs = <span class="hljs-literal">None</span> <span class="hljs-comment"># è¡¨ç¤ºä»æ–­ç‚¹ç»§ç»­ï¼Œæ— æ–°è¾“å…¥</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nâŒ æ“ä½œå·²å–æ¶ˆï¼Œæµç¨‹ç»ˆæ­¢"</span>)
                <span class="hljs-keyword">break</span>
</code></pre>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> OPENAI_API_KEY,LANGCHAIN_API_KEY
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph, MessagesState, START, END
<span class="hljs-keyword">from</span> langgraph.prebuilt <span class="hljs-keyword">import</span> ToolNode
<span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> MemorySaver

<span class="hljs-comment"># langsmithè°ƒè¯•</span>
os.environ[<span class="hljs-string">"LANGCHAIN_TRACING_V2"</span>] = <span class="hljs-string">"true"</span> <span class="hljs-comment"># æ€»å¼€å…³ï¼Œå†³å®šå¯ç”¨è¿½è¸ªåŠŸèƒ½</span>
os.environ[<span class="hljs-string">"LANGCHAIN_PROJECT"</span>] = <span class="hljs-string">"human_approval"</span> <span class="hljs-comment"># è‡ªå®šä¹‰é¡¹ç›®å</span>
os.environ[<span class="hljs-string">"LANGCHAIN_API_KEY"</span>] = LANGCHAIN_API_KEY

<span class="hljs-comment"># llmé…ç½®</span>
llm = ChatOpenAI(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    api_key=OPENAI_API_KEY,
    base_url=<span class="hljs-string">"https://api.deepseek.com"</span>
)

<span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªæ•æ„Ÿå·¥å…·ï¼šå‘é€é‚®ä»¶(æ¨¡æ‹Ÿ)</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">send_email</span>(<span class="hljs-params">to, content</span>):
    <span class="hljs-string">"""æ¨¡æ‹Ÿå‘é€é‚®ä»¶"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f'é‚®ä»¶å·²å‘é€è‡³<span class="hljs-subst">{to}</span>,å†…å®¹ä¸ºï¼š<span class="hljs-subst">{content}</span>'</span>


<span class="hljs-comment"># å·¥å…·ç»‘å®šåˆ°llm</span>
tools = [send_email]
llm_with_tools = llm.bind_tools(tools)

<span class="hljs-comment"># Nodeå‡½æ•°ä¸EdgeèŠ‚ç‚¹</span>
tool_node = ToolNode(tools)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">call_model</span>(<span class="hljs-params">state: MessagesState</span>):
    response = llm_with_tools.invoke(state[<span class="hljs-string">'messages'</span>])
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>:[response]}


<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_continue</span>(<span class="hljs-params">state: MessagesState</span>):
    last_msg = state[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_msg, <span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> last_msg.tool_calls:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>
    <span class="hljs-keyword">return</span> END


<span class="hljs-comment"># æ„å»ºåŸºç¡€ReActå›¾</span>
workflow = StateGraph(MessagesState)

workflow.add_node(<span class="hljs-string">"agent"</span>, call_model)
workflow.add_node(<span class="hljs-string">"tools"</span>, tool_node)
workflow.add_edge(START, <span class="hljs-string">"agent"</span>)

workflow.add_conditional_edges(
    <span class="hljs-string">"agent"</span>,
    should_continue,
    {
        <span class="hljs-string">"tools"</span>: <span class="hljs-string">"tools"</span>,
        END: END
    }
)

workflow.add_edge(<span class="hljs-string">"tools"</span>, <span class="hljs-string">"agent"</span>)

app = workflow.<span class="hljs-built_in">compile</span>(
    checkpointer=MemorySaver(),
    interrupt_before=[<span class="hljs-string">"tools"</span>] <span class="hljs-comment"># é€‰æ‹©è¦äººå·¥å®¡æ‰¹çš„èŠ‚ç‚¹ -- è´Ÿè´£åœ¨å“ªé‡Œåœï¼Œä¹‹åçš„ä»£ç è´Ÿè´£åœäº†ä¹‹åæ€ä¹ˆåŠ</span>
)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    config = {
        <span class="hljs-string">"configurable"</span>:{<span class="hljs-string">"thread_id"</span>:<span class="hljs-string">"user123"</span>}
    }
    user_input = <span class="hljs-string">"è¯·å¸®æˆ‘ç»™ boss@example.com å‘ä¸€å°é‚®ä»¶ï¼Œå†…å®¹æ˜¯ï¼šä¼šè®®æ¨è¿Ÿåˆ°æ˜å¤©ä¸‹åˆ3ç‚¹ã€‚"</span>

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·è¾“å…¥:"</span>,user_input)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nAgentæ­£åœ¨æ€è€ƒ...\n"</span>)

    <span class="hljs-comment"># åˆè¯†è¾“å…¥</span>
    inputs = {<span class="hljs-string">"messages"</span>:[HumanMessage(content=user_input)]}

    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        <span class="hljs-comment"># è§¦å‘å·¥ä½œæµæ‰§è¡Œï¼Œæ¨è¿›åˆ°ä¸‹ä¸€ä¸ªä¸­æ–­ç‚¹æˆ–è‡ªç„¶ç»“æŸ</span>
        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> app.stream(inputs,config,stream_mode=<span class="hljs-string">"values"</span>): <span class="hljs-comment"># æµå¼æ‰§è¡Œ</span>
            <span class="hljs-keyword">pass</span>   <span class="hljs-comment"># å¿…é¡»è¿­ä»£ç”Ÿæˆå™¨ï¼Œæ‰èƒ½å®é™…æ‰§è¡Œå·¥ä½œæµ</span>

        <span class="hljs-comment"># è·å–å½“å‰çŠ¶æ€</span>
        snapshot = app.get_state(config)
        next_tasks = snapshot.<span class="hljs-built_in">next</span> <span class="hljs-comment"># è¿”å›ä¸‹ä¸€æ­¥è¦æ‰§è¡Œçš„èŠ‚ç‚¹ååˆ—è¡¨</span>

        <span class="hljs-comment"># å¦‚æœæ²¡æœ‰ä¸‹ä¸€æ­¥ï¼Œè¯´æ˜å·¥ä½œæµå·²ç»“æŸ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> next_tasks:
            final_msg = snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\næœ€ç»ˆå›å¤:<span class="hljs-subst">{final_msg.content}</span>'</span>)
            <span class="hljs-keyword">break</span>

        <span class="hljs-comment"># å¦‚æœä¸‹ä¸€æ­¥æ˜¯éœ€è¦å®¡æ‰¹çš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"tools"</span> <span class="hljs-keyword">in</span> next_tasks:
            last_msg = snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
            tool_call = last_msg.tool_calls[<span class="hljs-number">0</span>]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\nâš ï¸ Agentå‡†å¤‡æ‰§è¡Œæ“ä½œï¼š'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'    å·¥å…·åç§°ï¼š<span class="hljs-subst">{tool_call[<span class="hljs-string">"name"</span>]}</span>'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'    å‚æ•°ï¼š<span class="hljs-subst">{tool_call[<span class="hljs-string">"args"</span>]}</span>'</span>)

            approval = <span class="hljs-built_in">input</span>(<span class="hljs-string">"\nâœ… æ˜¯å¦æ‰¹å‡†æ‰§è¡Œï¼Ÿ(è¾“å…¥ 'yes' ç»§ç»­ï¼Œå…¶ä»–å–æ¶ˆ): "</span>).strip().lower()
            <span class="hljs-keyword">if</span> approval == <span class="hljs-string">"yes"</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">'\n ç»§ç»­æ‰§è¡Œ...'</span>)
                inputs = <span class="hljs-literal">None</span> <span class="hljs-comment"># è¡¨ç¤ºä»æ–­ç‚¹ç»§ç»­ï¼Œæ— æ–°è¾“å…¥</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nâŒ æ“ä½œå·²å–æ¶ˆï¼Œæµç¨‹ç»ˆæ­¢"</span>)
                <span class="hljs-keyword">break</span>
</code></pre>
<p>æµ‹è¯•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94400e2d4baa4d6d8dde3f72eb583c02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=APMjehxTKg4h8Vy9gWDCsF2jVKw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fp0-xtjj-private.juejin.cn%2Ftos-cn-i-73owjymdk6%2Fd88b72506ee74a88a0247d9ffde7df6a~tplv-73owjymdk6-jj-mark-v1%3A0%3A0%3A0%3A0%3A5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA%3Aq75.awebp%3Fpolicy%3DeyJ2bSI6MywidWlkIjoiNDQ2ODc4NzgyNTk4NjQ0In0%253D%26rk3s%3De9ecf3d6%26x-orig-authkey%3Df32326d3454f2ac7e96d3d06cdbb035152127018%26x-orig-expires%3D1763976315%26x-orig-sign%3DuTg%252B3eWifqZC9AM%252FsazNdzp58lE%253D" target="_blank" title="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/d88b72506ee74a88a0247d9ffde7df6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiNDQ2ODc4NzgyNTk4NjQ0In0%3D&amp;rk3s=e9ecf3d6&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763976315&amp;x-orig-sign=uTg%2B3eWifqZC9AM%2FsazNdzp58lE%3D" ref="nofollow noopener noreferrer"/></p>
<p>å¦‚æœæˆ‘ä»¬æŠŠå…¶ä¸­çš„user_inputæ”¹ä¸ºbossï¼Œä¸å†™æ˜é‚®ç®±å·ï¼Œå†æµ‹è¯•ä¸€éï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf36a993059f4565a5a531f8e40da4e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=DW5vkG1ycbZK51rCevoOJn9ZdNk%3D" alt="" loading="lazy"/></p>
<p>æ­¤æ—¶æ²¡æœ‰è°ƒç”¨å‘é‚®ä»¶å·¥å…·ï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šéœ€è¦äººå·¥ç¡®è®¤äº†ã€‚</p>
<h2 data-id="heading-3">äºŒã€Graph-as-a-Toolï¼šæŠŠå¤æ‚æµç¨‹å°è£…æˆâ€œé»‘ç›’å·¥å…·â€</h2>
<h3 data-id="heading-4"><strong>ä¸ºä»€ä¹ˆéœ€è¦è¿™ç§å°è£…ï¼Ÿ</strong></h3>
<p>å›æƒ³æˆ‘ä»¬ä¹‹å‰çš„ RAG å®ç°ï¼šä¸€ä¸ªå®Œæ•´çš„æ£€ç´¢å¢å¼ºç”Ÿæˆæµç¨‹ï¼Œé€šå¸¸åŒ…å«<strong>å¤šä¸ªæ­¥éª¤</strong>â€”â€”æ–‡æ¡£åŠ è½½ä¸åˆ†å—ã€æ–‡æœ¬å‘é‡åŒ–ã€å­˜å…¥å‘é‡æ•°æ®åº“ã€æ‰§è¡Œæ£€ç´¢ã€ä¸Šä¸‹æ–‡å¢å¼ºã€æœ€ç»ˆç”Ÿæˆç­”æ¡ˆã€‚è¿™äº›æ“ä½œæœ¬èº«å·²è¶³å¤Ÿç¹çã€‚</p>
<p>å¦‚æœç›´æ¥æŠŠè¿™äº›é€»è¾‘å¡è¿›ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œå¹¶ä½œä¸º LangChain Tool æ³¨å†Œç»™ LangGraph ä½¿ç”¨ï¼Œè™½ç„¶æŠ€æœ¯ä¸Šå¯è¡Œï¼Œä½†ä¼šå¸¦æ¥<strong>æ˜æ˜¾é—®é¢˜</strong>ï¼šÂ Â </p>
<ul>
<li><strong>è€¦åˆåº¦é«˜</strong>ï¼šæ‰€æœ‰é€»è¾‘æŒ¤åœ¨ä¸€èµ·ï¼Œéš¾ä»¥å•ç‹¬æµ‹è¯•æˆ–æ›¿æ¢æŸä¸€æ­¥ï¼›</li>
<li><strong>å¯è¯»æ€§å·®</strong>ï¼šä¸»å›¾èŠ‚ç‚¹å˜æˆâ€œå¤§æ³¥çƒâ€ï¼Œå¤±å»æµç¨‹æ¸…æ™°æ€§ï¼›</li>
<li><strong>æ‰©å±•å›°éš¾</strong>ï¼šä¸€æ—¦éœ€æ±‚å˜åŒ–ï¼ˆæ¯”å¦‚åŠ å…¥é‡æ’ã€å¤šè·³æŸ¥è¯¢ã€ç»“æœæ ¡éªŒï¼‰ï¼Œä»£ç è¿…é€Ÿè†¨èƒ€ï¼Œif-else åµŒå¥—å¤±æ§ã€‚</li>
</ul>
<p>æ›´å…³é”®çš„æ˜¯â€”â€”<strong>çœŸå®ä¸–ç•Œçš„æ™ºèƒ½ä»»åŠ¡å¾€å¾€ä¸æ˜¯çº¿æ€§çš„</strong>ã€‚<br/>
ä¾‹å¦‚ï¼ŒRAG å¯èƒ½éœ€è¦æ ¹æ®æ£€ç´¢è´¨é‡å†³å®šæ˜¯å¦é‡æ–°ç”ŸæˆæŸ¥è¯¢ã€æ˜¯å¦å¼•å…¥å¤–éƒ¨çŸ¥è¯†ã€ç”šè‡³è¯·æ±‚äººå·¥ç¡®è®¤ã€‚è¿™ç±»å¸¦<strong>çŠ¶æ€è½¬ç§»ã€æ¡ä»¶åˆ†æ”¯ã€å¾ªç¯åé¦ˆ</strong>çš„é€»è¾‘ï¼Œç”¨ä¼ ç»Ÿå‡½æ•°éš¾ä»¥ä¼˜é›…è¡¨è¾¾ã€‚</p>
<p>è¿™æ—¶ï¼Œ<strong>Graph-as-a-Tool</strong> çš„ä»·å€¼å°±å‡¸æ˜¾å‡ºæ¥äº†ã€‚</p>
<p>å®ƒå…è®¸æˆ‘ä»¬å°†æŸä¸ªå¤æ‚å­ä»»åŠ¡ï¼ˆå¦‚ RAGï¼‰<strong>è‡ªèº«å»ºæ¨¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œæµå›¾ï¼ˆsub-graphï¼‰</strong> ï¼Œå†å°†æ•´ä¸ªå›¾å°è£…æˆä¸€ä¸ªå¯¹å¤–é€æ˜çš„ Toolã€‚å¯¹ä¸» Graph è€Œè¨€ï¼Œå®ƒåªæ˜¯ä¸€ä¸ª<strong>è¯­ä¹‰æ˜ç¡®çš„é»‘ç›’æ¥å£</strong>ï¼›è€Œå†…éƒ¨ï¼Œå´æ˜¯ä¸€ä¸ªç»“æ„æ¸…æ™°ã€èŠ‚ç‚¹åˆ†æ˜ã€æ”¯æŒä¸­æ–­æ¢å¤çš„<strong>å®Œæ•´æµç¨‹</strong>ã€‚</p>
<blockquote>
<p>è¿™æ­£æ˜¯ç°ä»£æ™ºèƒ½ä½“æ¶æ„çš„æ ¸å¿ƒç†å¿µï¼š<strong>åˆ†å±‚æŠ½è±¡ï¼ŒåµŒå¥—ç¼–æ’</strong>ã€‚<br/>
ä¸»å›¾è´Ÿè´£â€œå†³ç­–åšä»€ä¹ˆâ€ï¼Œå­å›¾ï¼ˆä½œä¸º Toolï¼‰è´Ÿè´£â€œå¦‚ä½•åšâ€ã€‚<br/>
è€Œåªæœ‰â€œå›¾â€è¿™ç§ç»“æ„ï¼Œæ‰èƒ½ä¼˜é›…åœ°è¡¨è¾¾è¿™ç§<strong>åˆ†å±‚ã€åµŒå¥—ã€å¸¦åé¦ˆçš„å¤æ‚å·¥ä½œæµ</strong>ã€‚</p>
</blockquote>
<p>å‡è®¾æˆ‘ä»¬è¦åšä¸€ä¸ª<strong>å¯ä»¥è‡ªåŠ¨é‡è¯•çš„APIæœåŠ¡è°ƒç”¨</strong>ã€‚è¯¥æœåŠ¡è°ƒç”¨ä½œä¸ºä¸€ä¸ªå·¥å…·ç»™ä¸»å·¥ä½œæµã€‚è€Œå®ƒè‡ªèº«åˆ™æ˜¯ç”±ä¸€ä¸ªå­å›¾æ„æˆï¼Œé‡Œé¢æ¶µç›–äº†ä¸€ä¸ªå®Œæ•´çš„å­å·¥ä½œæµã€‚</p>
<p>ä¸»è¦ä»£ç æ„å»ºå¦‚ä¸‹ï¼šï¼ˆå®Œæ•´éƒ¨åˆ†githubä¸­å·²æä¾›ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ...ç›¸å…³é…ç½®</span>
<span class="hljs-comment"># æ„å»ºå­å·¥ä½œæµ</span>
<span class="hljs-comment"># 1.å­ä»»åŠ¡çŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RetryState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    query: <span class="hljs-built_in">str</span>
    attempt: <span class="hljs-built_in">int</span>
    result: <span class="hljs-built_in">str</span>

<span class="hljs-comment"># 2.å­å›¾é€»è¾‘ -- æ¨¡æ‹Ÿä¸€ä¸ªå¯èƒ½å¤±è´¥ï¼Œéœ€é‡è¯•çš„APIè°ƒç”¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">call_unstable_api</span>(<span class="hljs-params">state:RetryState</span>):
    <span class="hljs-string">"""æ¨¡æ‹Ÿå¶å‘æ€§çš„å¤–éƒ¨æœåŠ¡ï¼Œå¶å‘å¤±è´¥"""</span>
    attempt = state[<span class="hljs-string">"attempt"</span>]
    <span class="hljs-keyword">if</span> attempt == <span class="hljs-number">1</span>:
        <span class="hljs-comment"># ç¬¬ä¸€æ¬¡æ•…æ„å¤±è´¥</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"result"</span>:<span class="hljs-string">"ERRORï¼šæœåŠ¡æš‚æ—¶ä¸å¯ç”¨"</span>,<span class="hljs-string">"attempt"</span>:attempt+<span class="hljs-number">1</span>}
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># ç¬¬äºŒæ¬¡æˆåŠŸ</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"result"</span>:<span class="hljs-string">f"SUCCESSï¼šæˆåŠŸå¤„ç†è¯·æ±‚ï¼š<span class="hljs-subst">{state[<span class="hljs-string">'query'</span>]}</span>"</span>,<span class="hljs-string">"attempt"</span>:attempt+<span class="hljs-number">1</span>}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_retry</span>(<span class="hljs-params">state:RetryState</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-string">"ERROR"</span> <span class="hljs-keyword">in</span> state[<span class="hljs-string">"result"</span>] <span class="hljs-keyword">and</span> state[<span class="hljs-string">"attempt"</span>] &lt;= <span class="hljs-number">2</span>: <span class="hljs-comment"># å‡ºç°æŠ¥é”™ä¸”é‡è¯•æ¬¡æ•°å°äº2ï¼Œé‡è¿</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"call_api"</span>
    <span class="hljs-keyword">return</span> END

<span class="hljs-comment"># 3.æ„å»ºå­å›¾å·¥ä½œæµ</span>
retry_workflow = StateGraph(RetryState)
retry_workflow.add_node(<span class="hljs-string">"call_api"</span>,call_unstable_api)
retry_workflow.add_edge(START,<span class="hljs-string">"call_api"</span>)
retry_workflow.add_conditional_edges(
    <span class="hljs-string">"call_api"</span>,
    should_retry,
    {<span class="hljs-string">"call_api"</span>:<span class="hljs-string">"call_api"</span>,END:END}
)
retry_app = retry_workflow.<span class="hljs-built_in">compile</span>()

<span class="hljs-comment"># 4.å°è£…ä¸ºtool(Graph-as-a-Tool)</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_order</span>(<span class="hljs-params">query:<span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""åˆ›å»ºæ–°è®¢å•ï¼Œè‡ªåŠ¨é‡è¯•ä¿éšœæˆåŠŸç‡"""</span>
    result = retry_app.invoke({<span class="hljs-string">"query"</span>:query,<span class="hljs-string">"attempt"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"result"</span>:<span class="hljs-string">""</span>})
    <span class="hljs-keyword">return</span> result[<span class="hljs-string">"result"</span>]


<span class="hljs-comment"># 5.ä¸»graph</span>
tools = [create_order]
llm_with_tools = llm.bind_tools(tools)
tool_node = ToolNode(tools)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">agent_node</span>(<span class="hljs-params">state:MessagesState</span>):
    response = llm_with_tools.invoke(state[<span class="hljs-string">"messages"</span>])
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>:[response]}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_continue</span>(<span class="hljs-params">state:MessagesState</span>):
    last_msg = state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_msg,<span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> last_msg.tool_calls:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>
    <span class="hljs-keyword">return</span> END

<span class="hljs-comment"># æ„å»ºä¸»å·¥ä½œæµ</span>
workflow = StateGraph(MessagesState)
workflow.add_node(<span class="hljs-string">"agent"</span>,agent_node)
workflow.add_node(<span class="hljs-string">"tools"</span>,tool_node)
workflow.add_edge(START,<span class="hljs-string">"agent"</span>)
workflow.add_conditional_edges(
    <span class="hljs-string">"agent"</span>,
    should_continue,
    {
        <span class="hljs-string">"tools"</span>: <span class="hljs-string">"tools"</span>,
        END: END
    }
)
workflow.add_edge(<span class="hljs-string">"tools"</span>,<span class="hljs-string">"agent"</span>)

app = workflow.<span class="hljs-built_in">compile</span>()

<span class="hljs-comment"># è¿è¡Œ</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    user_input = <span class="hljs-string">"è¯·åˆ›å»ºä¸€ä¸ªæ–°è®¢å•ï¼šè´­ä¹°ä¸‰æœ¬ä¹¦"</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'ç”¨æˆ·è¾“å…¥:'</span>,user_input)

    inputs = {<span class="hljs-string">"messages"</span>:[
        SystemMessage(content=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰§è¡ŒåŠ©æ‰‹ã€‚å½“ç”¨æˆ·æå‡ºä»»ä½•éœ€è¦å¤„ç†ã€æ“ä½œæˆ–æ‰§è¡Œçš„è¯·æ±‚æ—¶ï¼Œå¿…é¡»è°ƒç”¨ create_order å·¥å…·æ¥å®Œæˆï¼Œä¸è¦è‡ªè¡Œå›ç­”ç»†èŠ‚"</span>),
        HumanMessage(content=user_input)
    ]}
    result = app.invoke(inputs)

    tool_result = <span class="hljs-literal">None</span>
    <span class="hljs-comment"># åœ¨ä¸»å·¥ä½œæµçš„æ¶ˆæ¯å†å²ä¸­ï¼ŒæŸ¥æ‰¾æœ€è¿‘çš„å·¥å…·æ‰§è¡Œç»“æœ</span>
    <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(result[<span class="hljs-string">"messages"</span>]):
        <span class="hljs-keyword">if</span> msg.<span class="hljs-built_in">type</span> == <span class="hljs-string">"tool"</span>: <span class="hljs-comment"># æ‰¾åˆ°ToolMessageç±»å‹æ¶ˆæ¯</span>
            tool_result = msg.content
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> tool_result:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nâœ… ç›´æ¥è·å–å­å›¾è¿”å›å€¼:\n<span class="hljs-subst">{tool_result}</span>"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nâŒ æœªæ‰§è¡Œä»»ä½•å·¥å…·"</span>)
    final_reply = result[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\næœ€ç»ˆå›å¤:\n<span class="hljs-subst">{final_reply}</span>'</span>)
</code></pre>
<p>å…¶ä¸­çš„for msg in reversed(result["messages"]) åŒ…å«çš„æ˜¯å®Œæ•´çš„å¯¹è¯å†å²è®°å½•ï¼Œè€Œéå·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹ã€‚ToolNodeä¼šåœ¨å¯¹è¯å†å²ä¸­æ‰§è¡Œç»“æœæ¶ˆæ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6428e77d1bbd4ebf8e68dac43223d18c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=jJK1SruKvKbYOzW1Iu5j84GR0IM%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸Šï¼Œä»£ç è¿è¡ŒæˆåŠŸã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬èƒ½<strong>å¯¹åº”ä¸åŒåœºæ™¯çš„toolï¼Œç¼–å†™ä¸åŒçš„graphæ¥åº”å¯¹å¤æ‚çš„é€»è¾‘</strong>ï¼Œè¿™å°±æ˜¯<strong>graph-as-a-toolï¼ˆå›¾å³å·¥å…·ï¼‰</strong> ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€Multi-Agentç¼–æ’ï¼šè®©å¤šä¸ªä¸“å®¶ååŒå·¥ä½œ</h2>
<h3 data-id="heading-6">1. ç—›ç‚¹ï¼šä¸ºä»€ä¹ˆå• Agent ä¼šå´©æºƒï¼Ÿ</h3>
<p>åœ¨ä¹‹å‰çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯é€šè¿‡ System Prompt è®©ä¸€ä¸ª Agent æ‰®æ¼” <strong>â€œå…¨èƒ½ç¥â€</strong> ã€‚ä½†å½“<strong>éœ€æ±‚å˜å¾—å¤æ‚</strong>ï¼ˆä¾‹å¦‚åŒæ—¶éœ€è¦ RAG æ£€ç´¢ç§æœ‰ä¿¡æ¯ã€è”ç½‘æŸ¥æ‰¾æ•°æ®ã€ç”Ÿæˆä»£ç ï¼‰æ—¶ï¼Œè¿™ç§æ¨¡å¼ä¼š<strong>è¿…é€Ÿå´©å¡Œ</strong>ï¼š</p>
<ul>
<li><strong>æ³¨æ„åŠ›åˆ†æ•£</strong>ï¼šPrompt è¿‡é•¿ï¼ŒLLM ç»å¸¸å¿½ç•¥æŒ‡ä»¤ï¼Œè¡¨ç°ä¸ºâ€œå¹»è§‰â€ã€‚</li>
<li><strong>è®°å¿†çˆ†ç‚¸</strong>ï¼šæ‰€æœ‰ä»»åŠ¡å…±ç”¨ä¸€ä¸ª Message Historyï¼Œä¸Šä¸‹æ–‡é£é€Ÿæ‰©å¼ ï¼Œä¸ä»…çƒ§é’±ï¼Œè¿˜å®¹æ˜“è®©æ¨¡å‹â€œè®°æ··â€ä¿¡æ¯ã€‚</li>
<li><strong>å·¥å…·æ··æ‚</strong>ï¼šå‡ åä¸ªå·¥å…·å †åœ¨ä¸€èµ·ï¼Œæ¨¡å‹ææ˜“è¯¯è°ƒï¼ˆä¾‹å¦‚è¯¥æŸ¥æ–‡æ¡£æ—¶å»è”ç½‘ï¼‰ã€‚</li>
<li><strong>è„†å¼±æ€§</strong>ï¼šä¸€æ­¥é”™ï¼Œå…¨ç›˜è¾“ã€‚æ— æ³•é’ˆå¯¹ç‰¹å®šä»»åŠ¡ï¼ˆå¦‚å†™ä»£ç ï¼‰å•ç‹¬ä¼˜åŒ– Promptã€‚</li>
</ul>
<p><strong>è§£æ³•ï¼šå¾®æœåŠ¡åŒ–ï¼ˆMicroservicesï¼‰</strong> å°†ä¸€ä¸ªè¯•å›¾å…¨èƒ½çš„å•æ™ºèƒ½ä½“ï¼Œæ‹†è§£ä¸ºå¤šä¸ª<strong>ä¸“æ³¨ã€è‡ªæ²»ã€å¯ç»„åˆ</strong>çš„å­æ™ºèƒ½ä½“ï¼Œå¹¶é€šè¿‡ç¼–æ’åè°ƒå®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<ul>
<li>è®© <strong>RAG ä¸“å®¶</strong>åªè´Ÿè´£æŸ¥ç§æœ‰çŸ¥è¯†ã€‚</li>
<li>è®© <strong>Web æœç´¢å‘˜</strong>åªè´Ÿè´£æŸ¥å…¬å¼€ä¿¡æ¯ã€‚</li>
<li>è®© <strong>ä»£ç ç”Ÿæˆå™¨</strong>åªå†™ Pythonã€‚</li>
</ul>
<p>è€Œè¿™ä¸€åˆ‡ï¼Œéƒ½éœ€è¦ä¸€ä¸ª**æ€»æ§ï¼ˆSupervisorï¼‰**æ¥è°ƒåº¦ã€‚</p>
<h3 data-id="heading-7">2. åˆå§‹åŒ–ï¼šå·¥å…·é…ç½®ä¸æ ¸å¿ƒçŠ¶æ€å®šä¹‰</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å·¥å…·å’ŒçŠ¶æ€ã€‚è¿™é‡Œçš„æ ¸å¿ƒæŠ€æœ¯ç‚¹åœ¨äº<strong>çŠ¶æ€ï¼ˆStateï¼‰çš„è®¾è®¡</strong>ã€‚</p>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨¡æ‹Ÿå·¥å…·</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_internal_docs</span>(<span class="hljs-params">query:<span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""æœç´¢å…¬å¸å†…éƒ¨æ–‡æ¡£è·å–æ”¿ç­–ä¿¡æ¯"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æ ¹æ®å…¬å¸æ‰‹å†Œï¼Œå¹´å‡ä¸º15å¤©"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_web</span>(<span class="hljs-params">query:<span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""é€šè¿‡æœç´¢å¼•æ“è·å–æœ€æ–°çš„å…¬å¼€ä¿¡æ¯"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æ®TechCrunchæŠ¥é“ï¼ŒLangGraph 0.6å·²æ”¯æŒæŒä¹…åŒ–è®°å¿†"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_code</span>(<span class="hljs-params">requirement:<span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""æ ¹æ®éœ€æ±‚ç”Ÿæˆå¯è¿è¡Œçš„Pythonä»£ç """</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"python\nprint('Hello from Code writer!')"</span>


<span class="hljs-comment"># å…±äº«çŠ¶æ€å®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    messages: Annotated[<span class="hljs-built_in">list</span>,add_messages] <span class="hljs-comment"># è‡ªåŠ¨ç´¯ç§¯å¯¹è¯å†å²</span>
    next_speaker: <span class="hljs-built_in">str</span>
</code></pre>
<h4 data-id="heading-8"><strong>æ·±åº¦è§£è¯»ï¼šä¸ºä»€ä¹ˆä¸ç”¨é¢„ç½®çš„ MessagesStateï¼Ÿ</strong></h4>
<p>LangGraph æä¾›äº†ä¸€ä¸ª<strong>é¢„ç½®ç±»MessagesState</strong>ï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ª messages å­—æ®µã€‚åœ¨å¤šæ™ºèƒ½ä½“ç¼–æ’ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–çš„å­—æ®µÂ next_speakerÂ æ¥å­˜å‚¨ Supervisor çš„å†³ç­–ç»“æœï¼Œå› æ­¤<strong>å¿…é¡»è‡ªå®šä¹‰ TypedDict</strong> ã€‚</p>
<p>å…³äº<strong>Annotated[list, add_messages]</strong> ï¼š</p>
<ul>
<li><strong>Annotated çš„ä½œç”¨</strong>ï¼šåœ¨è¿™é‡Œå®ƒä¸ä»…ä»…æ˜¯ç±»å‹æç¤ºï¼Œå®ƒä¼šè¢« LangGraph æ¡†æ¶è¯»å–ã€‚</li>
<li><strong>add_messages çš„æœºåˆ¶</strong>ï¼šå®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰æ¡†æ¶ï¼Œå½“èŠ‚ç‚¹è¿”å›æ–°çš„ messages æ—¶ï¼Œä¸è¦ç›´æ¥è¦†ç›–æ—§åˆ—è¡¨ï¼Œè€Œæ˜¯<strong>è¿½åŠ ï¼ˆAppendï¼‰</strong> ã€‚è¿™æ˜¯å®ç°<strong>è‡ªåŠ¨ç´¯ç§¯å¯¹è¯å†å²</strong>çš„å…³é”®ã€‚</li>
</ul>
<h3 data-id="heading-9">3. å®šä¹‰èŠ‚ç‚¹ï¼šä¸“å®¶ä¸æ€»æ§</h3>
<p>è¿™ä¸€æ­¥æˆ‘ä»¬éœ€è¦æ˜ç¡® <strong>â€œå¤§è„‘â€</strong> ä¸ <strong>â€œæ‰‹è„šâ€</strong> çš„åˆ†å·¥ã€‚</p>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¸“å®¶èŠ‚ç‚¹</span>
def rag_expert(state:AgentState):
    <span class="hljs-attr">prompt</span> = <span class="hljs-string">"ä½ æ˜¯å…¬å¸çŸ¥è¯†åº“ä¸“å®¶ï¼ŒåªåŸºäºå†…éƒ¨æ–‡æ¡£å›ç­”é—®é¢˜ã€‚å›ç­”åº”ç®€æ´æ˜äº†ï¼Œç›´æ¥ç»™å‡ºæœ€ç»ˆç»“è®ºã€‚è¯·åœ¨å›ç­”çš„æœ€åä¸€è¡ŒåŠ ä¸Šï¼š(ä»»åŠ¡å·²å®Œæˆ)"</span>
    <span class="hljs-attr">messages</span> = [SystemMessage(content=prompt)]+state[<span class="hljs-string">'messages'</span>]
    <span class="hljs-attr">tools</span> = [search_internal_docs]
    <span class="hljs-attr">response</span> = llm.bind_tools(tools).invoke(messages)
    return {'messages':<span class="hljs-section">[response]</span>}

def web_research(state:AgentState):
    <span class="hljs-attr">prompt</span> = <span class="hljs-string">"ä½ æ˜¯äº’è”ç½‘ç ”ç©¶å‘˜ï¼Œæ“…é•¿ç”¨æœç´¢å¼•æ“è·å–æœ€æ–°å…¬å¼€ä¿¡æ¯ã€‚å›ç­”åº”ç®€æ´æ˜äº†ï¼Œç›´æ¥ç»™å‡ºæœ€ç»ˆç»“è®ºã€‚è¯·åœ¨å›ç­”çš„æœ€åä¸€è¡ŒåŠ ä¸Šï¼š(ä»»åŠ¡å·²å®Œæˆ)"</span>
    <span class="hljs-attr">messages</span> = [SystemMessage(content=prompt)]+state[<span class="hljs-string">'messages'</span>]
    <span class="hljs-attr">tools</span> = [search_web]
    <span class="hljs-attr">response</span> = llm.bind_tools(tools).invoke(messages)
    return {'messages':<span class="hljs-section">[response]</span>}

def code_writer(state:AgentState):
    <span class="hljs-attr">prompt</span> = <span class="hljs-string">"ä½ æ˜¯pythonå·¥ç¨‹å¸ˆï¼Œåªç”Ÿæˆå¯è¿è¡Œä»£ç ï¼Œä¸è§£é‡Šã€‚å›ç­”åº”ç®€æ´æ˜äº†ï¼Œç›´æ¥ç»™å‡ºæœ€ç»ˆç»“è®ºã€‚è¯·åœ¨å›ç­”çš„æœ€åä¸€è¡ŒåŠ ä¸Šï¼š(ä»»åŠ¡å·²å®Œæˆ)"</span>
    <span class="hljs-attr">messages</span> = [SystemMessage(content=prompt)]+state[<span class="hljs-string">'messages'</span>]
    <span class="hljs-attr">tools</span> = [generate_code]
    <span class="hljs-attr">response</span> = llm.bind_tools(tools).invoke(messages)
    return {'messages':<span class="hljs-section">[response]</span>}

<span class="hljs-comment"># æ€»æ§èŠ‚ç‚¹</span>
def supervisor(state:AgentState):
    <span class="hljs-attr">supervisor_prompt</span> = <span class="hljs-string">"""
        ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡åè°ƒå‘˜ã€‚ä½ çš„ç›®æ ‡æ˜¯ç®¡ç†ä¸“å®¶æ¥è§£å†³ç”¨æˆ·çš„é—®é¢˜ã€‚

        å½“å‰å¯¹è¯éœ€è¦ä»¥ä¸‹ä¸“å®¶å‚ä¸ï¼š
        - rag_expertï¼šæ¶‰åŠå…¬å¸æ”¿ç­–ã€å†…éƒ¨æµç¨‹
        - web_researchï¼šæ¶‰åŠå¤–éƒ¨æ–°é—»ã€å…¬å¼€æ•°æ®
        - code_writerï¼šéœ€è¦ç”Ÿæˆä»£ç 

        ã€å†³ç­–é€»è¾‘ã€‘
        1. **æ£€æŸ¥å†å²è®°å½•**ï¼šå…ˆçœ‹ä¸Šä¸€ä¸ªå›å¤æ˜¯å¦å·²ç»å®Œæ•´å›ç­”äº†ç”¨æˆ·çš„åˆå§‹é—®é¢˜ã€‚
        2. **å¦‚æœå·²ç»å›ç­”å®Œæ¯•**ï¼šå¿…é¡»è¾“å‡º 'FINISH'ã€‚
        3. **å¦‚æœå°šæœªå›ç­”æˆ–éœ€è¦è¡¥å……**ï¼šæ ¹æ®å½“å‰ç¼ºå°‘çš„æ­¥éª¤ï¼Œé€‰æ‹©ä¸‹ä¸€ä¸ªæœ€åˆé€‚çš„ä¸“å®¶ã€‚

        è¯·åªè¾“å‡ºä¸“å®¶åå­—æˆ– 'FINISH'ï¼Œä¸è¦è¾“å‡ºä»»ä½•å…¶ä»–è§£é‡Šã€‚
        """</span>
    <span class="hljs-attr">messages</span> = [SystemMessage(content=supervisor_prompt)]+state[<span class="hljs-string">'messages'</span>]
    <span class="hljs-attr">response</span> = llm.invoke(messages)
    <span class="hljs-attr">next_speaker</span> = response.content.strip()
    return {"next_speaker":next_speaker}
</code></pre>
<p><strong>é€»è¾‘è¦ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ä¸“å®¶èŠ‚ç‚¹</strong>ï¼šéµå¾ª ReAct æ¨¡å¼ã€‚å¿…é¡»ä½¿ç”¨ bind_toolsÂ å°†å·¥å…·ç»‘å®šç»™ LLMï¼Œå¦åˆ™æ¨¡å‹æ— æ³•è§¦å‘å·¥å…·è°ƒç”¨ã€‚æˆ‘ä»¬è¿˜åœ¨ Prompt ä¸­åŠ å…¥äº†â€œä»»åŠ¡å·²å®Œæˆâ€çš„æ ‡è®°ï¼Œè¾…åŠ©æ€»æ§åˆ¤æ–­ã€‚</li>
<li><strong>æ€»æ§èŠ‚ç‚¹</strong>ï¼šä¸æ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼Œåªè´Ÿè´£ <strong>â€œçœ‹â€</strong> ã€‚å®ƒçš„è¾“å‡ºç›´æ¥å†³å®šäº† next_speaker çš„å€¼ï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªå›¾çš„æµå‘ã€‚</li>
</ul>
<h3 data-id="heading-10">4. æ„å»ºåä½œå›¾ï¼šæ ¸å¿ƒæ¶æ„é€»è¾‘</h3>
<p>è¿™æ˜¯æœ¬ç« æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ StateGraphÂ å°†èŠ‚ç‚¹ç»‡æˆä¸€å¼ ç½‘ã€‚</p>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è·¯ç”±å‡½æ•°å®šä¹‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_supervisor</span>(<span class="hljs-params">state:AgentState</span>):
    <span class="hljs-keyword">if</span> state[<span class="hljs-string">"next_speaker"</span>]==<span class="hljs-string">"FINISH"</span>:
        <span class="hljs-keyword">return</span> END
    <span class="hljs-keyword">return</span> state[<span class="hljs-string">"next_speaker"</span>]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_continue</span>(<span class="hljs-params">state:AgentState</span>):
    last_msg = state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_msg,<span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> last_msg.tool_calls:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"supervisor"</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_after_tool</span>(<span class="hljs-params">state:AgentState</span>):
    <span class="hljs-comment"># å·¥å…·æ‰§è¡Œå®Œåï¼Œé€šè¿‡next_speakerçŸ¥é“æ˜¯è°è°ƒç”¨çš„ï¼Œè·¯ç”±å›å»</span>
    <span class="hljs-keyword">return</span> state[<span class="hljs-string">"next_speaker"</span>]


<span class="hljs-comment"># æ·»åŠ å·¥å…·èŠ‚ç‚¹</span>
tools = [search_internal_docs,search_web,generate_code]
tool_node = ToolNode(tools)


<span class="hljs-comment"># æ„å»ºåä½œå›¾</span>
workflow = StateGraph(AgentState)

<span class="hljs-comment"># 1. æ·»åŠ èŠ‚ç‚¹</span>
workflow.add_node(<span class="hljs-string">"supervisor"</span>,supervisor)
workflow.add_node(<span class="hljs-string">"rag_expert"</span>,rag_expert)
workflow.add_node(<span class="hljs-string">"web_research"</span>,web_research)
workflow.add_node(<span class="hljs-string">"code_writer"</span>,code_writer)
workflow.add_node(<span class="hljs-string">"tools"</span>,tool_node)


<span class="hljs-comment"># 2. æ€»æ§å›è·¯</span>
workflow.add_edge(START,<span class="hljs-string">"supervisor"</span>)
workflow.add_conditional_edges(<span class="hljs-string">"supervisor"</span>,route_supervisor)

<span class="hljs-comment"># 3. ä¸“å®¶èŠ‚ç‚¹çš„ReActå¾ªç¯</span>
<span class="hljs-keyword">for</span> member <span class="hljs-keyword">in</span> [<span class="hljs-string">"rag_expert"</span>,<span class="hljs-string">"web_research"</span>,<span class="hljs-string">"code_writer"</span>]: <span class="hljs-comment"># ä¸ºæ¯ä¸ªä¸“å®¶æ·»åŠ æ¡ä»¶è¾¹ï¼šå†³å®šæ˜¯å»æ‰§è¡Œå·¥å…·è¿˜æ˜¯å›æ€»æ§</span>
    workflow.add_conditional_edges(
        member,
        should_continue,
        {<span class="hljs-string">"tools"</span>:<span class="hljs-string">"tools"</span>,<span class="hljs-string">"supervisor"</span>:<span class="hljs-string">"supervisor"</span>}
    )

<span class="hljs-comment"># 4.å·¥å…·èŠ‚ç‚¹é—­ç¯</span>
workflow.add_conditional_edges( <span class="hljs-comment"># å·¥å…·æ‰§è¡Œå®Œï¼Œæ ¹æ®next_speakerè·¯ç”±å›åŸæ¥çš„ä¸“å®¶</span>
    <span class="hljs-string">"tools"</span>,
    route_after_tool
)

app = workflow.<span class="hljs-built_in">compile</span>()
</code></pre>
<h4 data-id="heading-11"><strong>æŠ€æœ¯æ·±æŒ–ï¼šç†è§£å›¾æ„å»ºä¸­çš„ä¸‰ä¸ªå…³é”®ç‚¹</strong></h4>
<p><strong>ç¬¬ä¸€ç‚¹ï¼šæ¡ä»¶è¾¹çš„ä¸¤ç§å†™æ³•ï¼ˆåŠ¨æ€ vs é™æ€ï¼‰</strong></p>
<ul>
<li>
<p><strong>ç›´æ¥è¿”å›ï¼ˆåŠ¨æ€è·¯ç”±ï¼‰</strong> ï¼šå¦‚ route_supervisor ã€‚<strong>å‡½æ•°ç›´æ¥è¿”å›èŠ‚ç‚¹åç§°å­—ç¬¦ä¸²</strong>ã€‚é€‚ç”¨äº<strong>ç›®æ ‡èŠ‚ç‚¹ä¸ç¡®å®š</strong>çš„æƒ…å†µï¼ˆSupervisor å¯èƒ½è¿”å›ä»»ä½•ä¸“å®¶çš„åå­—ï¼‰ã€‚</p>
<pre><code class="hljs language-perl" lang="perl">def route_supervisor(<span class="hljs-keyword">state</span>:AgentState):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">state</span>[<span class="hljs-string">"next_speaker"</span>]==<span class="hljs-string">"FINISH"</span>:
        <span class="hljs-keyword">return</span> END
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">state</span>[<span class="hljs-string">"next_speaker"</span>]

<span class="hljs-comment"># ...</span>

workflow.add_conditional_edges(<span class="hljs-string">"supervisor"</span>,route_supervisor)
</code></pre>
</li>
<li>
<p><strong>å­—å…¸æ˜ å°„ï¼ˆé™æ€ç»“æ„ï¼‰</strong> ï¼šå¦‚ should_continue ã€‚è™½ç„¶å‡½æ•°è¿”å›çš„æ˜¯ "tools"ï¼Œä½†æˆ‘ä»¬åœ¨ add_conditional_edges ä¸­<strong>æ˜¾å¼å®šä¹‰</strong>äº† {"tools": "tools"} çš„<strong>æ˜ å°„</strong>ã€‚è¿™é€‚ç”¨äº<strong>ç»“æ„å›ºå®š</strong>çš„åœºæ™¯ï¼ˆä¸‰é€‰ä¸€æˆ–äºŒé€‰ä¸€ï¼‰ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">should_continue</span>(<span class="hljs-params">state:AgentState</span>):
    last_msg = state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_msg,<span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> last_msg.tool_calls:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"supervisor"</span>

<span class="hljs-comment"># ...</span>

<span class="hljs-keyword">for</span> member <span class="hljs-keyword">in</span> [<span class="hljs-string">"rag_expert"</span>,<span class="hljs-string">"web_research"</span>,<span class="hljs-string">"code_writer"</span>]: <span class="hljs-comment"># ä¸ºæ¯ä¸ªä¸“å®¶æ·»åŠ æ¡ä»¶è¾¹ï¼šå†³å®šæ˜¯å»æ‰§è¡Œå·¥å…·è¿˜æ˜¯å›æ€»æ§</span>
    workflow.add_conditional_edges(
        member,
        should_continue,
        {<span class="hljs-string">"tools"</span>:<span class="hljs-string">"tools"</span>,<span class="hljs-string">"supervisor"</span>:<span class="hljs-string">"supervisor"</span>}
    )
</code></pre>
</li>
</ul>
<p><strong>ç¬¬äºŒç‚¹ï¼šFor å¾ªç¯çš„æœ¬è´¨ï¼ˆæ„å»ºæ—¶ vs è¿è¡Œæ—¶ï¼‰</strong> ä»£ç ä¸­çš„ for member in [...] å¹¶ä¸æ˜¯è®©ç¨‹åºè¿è¡Œæ—¶è½®æµè·‘ä¸€éä¸“å®¶ã€‚ è¿™æ˜¯<strong>æ„å»ºé˜¶æ®µï¼ˆBuild Timeï¼‰</strong> çš„ä»£ç ã€‚å®ƒçš„ä½œç”¨æ˜¯ <strong>â€œæ‰¹é‡æ³¨å†Œâ€</strong> ï¼šæˆ‘ä»¬å‘Šè¯‰å›¾ï¼Œè¿™ä¸‰ä¸ªä¸“å®¶èŠ‚ç‚¹ï¼Œå®ƒä»¬â€œå‡ºé—¨â€åçš„è§„åˆ™æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼ˆè¦ä¹ˆå»ä¿®å·¥å…·ï¼Œè¦ä¹ˆå›æ€»æ§ï¼‰ã€‚è¿™<strong>é¿å…äº†é‡å¤</strong>å†™ä¸‰éç›¸åŒçš„ add_conditional_edges ä»£ç ã€‚</p>
<p><strong>ç¬¬ä¸‰ç‚¹ï¼šadd_conditional_edges çš„å›ç¯ç‰¹æ€§</strong> è¿™ä¸€è¡Œä»£ç ç›¸å½“äºç»™èŠ‚ç‚¹å®‰è£…äº†ä¸€ä¸ªæ°¸ä¹…ç”Ÿæ•ˆçš„ <strong>â€œå•å‘ä»»æ„é—¨â€</strong> ã€‚</p>
<ul>
<li>
<p><strong>å›ç¯</strong>ï¼šä¸€æ—¦å®šä¹‰äº† <strong>Expert -&gt; check -&gt; Tools</strong> ï¼Œä»¥åæ— è®ºæµç¨‹ç¬¬å‡ æ¬¡å›åˆ° Expert èŠ‚ç‚¹ï¼Œç¦»å¼€æ—¶éƒ½ä¼šè§¦å‘è¿™ä¸ªæ£€æŸ¥ã€‚</p>
</li>
<li>
<p><strong>å•å‘æ€§</strong>ï¼šè™½ç„¶æˆ‘ä»¬åœ¨é€»è¾‘ä¸Šå®ç°äº† Expert -&gt; check -&gt; Tools Â çš„é—­ç¯ï¼Œä½†è¿™ä¸ªé—­ç¯æ˜¯ç”±ä¸¤æ¡å•å‘è¾¹æ‹¼å‡‘çš„ï¼š</p>
<ol>
<li>Expert -&gt; Toolsï¼ˆé€šè¿‡Â should_continueÂ  å®šä¹‰ï¼‰</li>
<li>Tools -&gt; Expertï¼ˆé€šè¿‡ route_after_tool å®šä¹‰ï¼Œå¿…é¡»æ˜¾å¼å†™å‡ºæ¥ï¼Œå¦åˆ™ç¨‹åºä¼šå¡æ­»åœ¨ Tools èŠ‚ç‚¹ï¼‰ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-12">5. æµ‹è¯•è¿è¡Œ</h3>
<p>æœ€åï¼Œé€šè¿‡æ‰“å°æ—¥å¿—æ¥éªŒè¯å¤šæ™ºèƒ½ä½“çš„åä½œæµã€‚</p>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æµ‹è¯•è¿è¡Œ</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    user_input = <span class="hljs-string">"å…¬å¸å¹´å‡å¤šå°‘å¤©"</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·æé—®:"</span>,user_input)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'\nå¼€å§‹å¤šæ™ºèƒ½ä½“åä½œ...\n'</span>)

    inputs = {<span class="hljs-string">"messages"</span>:[HumanMessage(content=user_input)]}
    <span class="hljs-comment"># appæ˜¯ç¼–è¯‘å¥½çš„å›¾ï¼Œstream()ä¼šè®©å›¾å¼€å§‹è¿è½¬ï¼Œå¹¶è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨</span>
    <span class="hljs-comment"># å›¾æ¯æ‰§è¡Œå®Œä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¼šäº§å‡ºä¸€ä¸ªstepå­—å…¸</span>
    <span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> app.stream(inputs):
        <span class="hljs-comment"># å› ä¸ºstepæ˜¯ä¸ªå­—å…¸ï¼Œæ‰€ä»¥éœ€è¦æ‹†åŒ…æ‹¿åˆ° èŠ‚ç‚¹å(Node) ä¸ è¾“å‡ºå†…å®¹(output)</span>
        <span class="hljs-keyword">for</span> node,output <span class="hljs-keyword">in</span> step.items():
            <span class="hljs-comment"># æœ‰å·¥å…·/ä¸“å®¶å›å¤</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">"messages"</span> <span class="hljs-keyword">in</span> output:
                msg = output[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
                <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(msg,<span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> msg.tool_calls:
                    call = msg.tool_calls[<span class="hljs-number">0</span>]
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ã€<span class="hljs-subst">{node}</span>ã€‘è°ƒç”¨å·¥å…· <span class="hljs-subst">{call[<span class="hljs-string">'name'</span>]}</span>(<span class="hljs-subst">{call[<span class="hljs-string">'args'</span>]}</span>)"</span>)
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ã€<span class="hljs-subst">{node}</span>ã€‘å›å¤ï¼š<span class="hljs-subst">{msg.content}</span>"</span>)
            <span class="hljs-comment"># supervisoråˆšåšå®Œå†³ç­–ï¼Œç¡®å®šä¸‹ä¸ªå‘è¨€äºº</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-string">"next_speaker"</span> <span class="hljs-keyword">in</span> output:
                speaker = output[<span class="hljs-string">"next_speaker"</span>]
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ã€Supervisorã€‘æŒ‡å®šä¸‹ä¸€ä½å‘è¨€äººï¼š<span class="hljs-subst">{speaker}</span>"</span>)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e4265a3b4b04e14b4570b348dbbacab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=BUH5JAHL6n66jv%2FM06zoSKG3EfI%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡è¿™æ®µæ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°è§‚æµ‹åˆ°ç³»ç»Ÿçš„<strong>è¿è¡Œè„‰ç»œ</strong>ï¼š</p>
<blockquote>
<p>Supervisor è¯†åˆ«æ„å›¾ -&gt; æŒ‡æ´¾ RAG ä¸“å®¶ -&gt; RAG ä¸“å®¶å‘ç°éœ€è¦æŸ¥åº“ -&gt; è°ƒç”¨ Tool -&gt;</p>
<p>Tool è¿”å›ç»“æœÂ  -&gt; RAG ä¸“å®¶ç”Ÿæˆæœ€ç»ˆå›å¤ -&gt; Supervisor ç¡®è®¤ä»»åŠ¡å®Œæˆ (FINISH)ã€‚</p>
</blockquote>
<p>å…¶å·¥ä½œæµå¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">           (å¼€å§‹)
             |
             v
   +--&gt; <span class="hljs-selector-attr">[ ğŸ§  æ€»æ§ Supervisor ]</span> <span class="hljs-built_in">--</span>(å®Œæˆ)--&gt; (( END ))
   |         |
   |         | (<span class="hljs-number">1</span>. æŒ‡æ´¾)
   |         v
   |    <span class="hljs-selector-attr">[ ğŸ‘· ä¸“å®¶ (Workers) ]</span> &lt;====&gt; <span class="hljs-selector-attr">[ ğŸ› ï¸ å·¥å…· (Tools) ]</span>
   |         |        ^         (<span class="hljs-number">2</span>. å¹²æ´»å¾ªç¯)
   |         |        |
   +---------+--------+
      (<span class="hljs-number">3</span>. æ±‡æŠ¥ç»“æœ)
</code></pre>
<p><strong>æ€»ç»“ï¼šä¸‰ç§èƒ½åŠ›å¦‚ä½•ç»„åˆï¼Ÿ</strong></p>

























<table><thead><tr><th>èƒ½åŠ›</th><th>è§£å†³çš„é—®é¢˜</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Human-in-the-Loop</strong></td><td>ä¸å¯é€†æ“ä½œçš„å®‰å…¨é£é™©</td><td>å‘é‚®ä»¶ã€åˆ æ•°æ®ã€å®¡æ‰¹æµ</td></tr><tr><td><strong>Graph-as-a-Tool</strong></td><td>å¤æ‚å†…éƒ¨é€»è¾‘çš„ç»´æŠ¤éš¾é¢˜</td><td>å¸¦é‡è¯•çš„ API è°ƒç”¨ã€å¤šæ­¥éªŒè¯</td></tr><tr><td><strong>Multi-Agent ç¼–æ’</strong></td><td>å• Agent èŒè´£çˆ†ç‚¸</td><td>ä¼šè®®çºªè¦ã€æ•…éšœæ’æŸ¥ã€éœ€æ±‚åˆ†æ</td></tr></tbody></table>
<h2 data-id="heading-13">å››ã€ç»¼åˆå®æˆ˜</h2>
<p>åœ¨å‰ä¸‰ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«æŒæ¡äº† <strong>å®‰å…¨é”ã€ é»‘ç›’å·¥å…·ã€ å›¢é˜Ÿç®¡ç†</strong>ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ä¸å†çº¸ä¸Šè°ˆå…µï¼Œè€Œæ˜¯å°†è¿™ä¸‰è€…èä¸ºä¸€ä½“ï¼Œæ„å»ºä¸€ä¸ª<strong>ç”Ÿäº§çº§æ¶æ„çš„ITè¿ç»´æ™ºèƒ½ä½“</strong>ã€‚</p>
<h3 data-id="heading-14">ä¸šåŠ¡åœºæ™¯è®¾å®š</h3>
<p>æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡å™¨æ•…éšœæ’æŸ¥åœºæ™¯ï¼š</p>
<p><strong>æ€»æ§(Supervisor)</strong> ï¼šè´Ÿè´£æ¥æ”¶æŠ¥è­¦ï¼Œ<strong>è°ƒåº¦ä¸“å®¶</strong>ï¼›</p>
<p><strong>æ—¥å¿—ä¸“å®¶(Log Expert)</strong> ï¼šè´Ÿè´£åˆ†ææœåŠ¡å™¨æ—¥å¿—ã€‚å®ƒæ‰‹ä¸­çš„å·¥å…· analyze_logs æ˜¯ä¸€ä¸ª<strong>å­å›¾</strong>ï¼ŒåŒ…å«SSHè¿æ¥é‡è¯•ã€æ—¥å¿—æå–ç­‰å¤æ‚é€»è¾‘ï¼ˆæ¨¡æ‹Ÿç½‘ç»œä¸ç¨³å®šçš„çœŸå®ç¯å¢ƒï¼‰ã€‚</p>
<p><strong>è¿ç»´ä¸“å®¶(Ops Expert)</strong> ï¼šè´Ÿè´£æ‰§è¡Œä¿®å¤ã€‚å®ƒæ‰‹ä¸­çš„å·¥å…· restart_services æ˜¯<strong>æ•æ„Ÿæ“ä½œ</strong>ï¼Œå¿…é¡»ç»è¿‡äººå·¥å®¡æ‰¹ï¼ˆHuman-in-the-Loopï¼‰ã€‚</p>
<h3 data-id="heading-15">ä»£ç å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> OPENAI_API_KEY,LANGCHAIN_API_KEY
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage,SystemMessage
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> StateGraph,MessagesState,START,END
<span class="hljs-keyword">from</span> langgraph.prebuilt <span class="hljs-keyword">import</span> ToolNode
<span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> MemorySaver
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict,Annotated
<span class="hljs-keyword">from</span> langgraph.graph.message <span class="hljs-keyword">import</span> add_messages

<span class="hljs-comment"># LangSmithè°ƒè¯•</span>
os.environ[<span class="hljs-string">"LANGCHAIN_TRACING_V2"</span>] = <span class="hljs-string">"true"</span> <span class="hljs-comment"># æ€»å¼€å…³ï¼Œå†³å®šå¯ç”¨è¿½è¸ªåŠŸèƒ½</span>
os.environ[<span class="hljs-string">"LANGCHAIN_PROJECT"</span>] = <span class="hljs-string">"supervisor_agent_ops_system"</span> <span class="hljs-comment"># è‡ªå®šä¹‰é¡¹ç›®å</span>
os.environ[<span class="hljs-string">"LANGCHAIN_API_KEY"</span>] = LANGCHAIN_API_KEY

llm = ChatOpenAI(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    api_key=OPENAI_API_KEY,
    base_url=<span class="hljs-string">"https://api.deepseek.com"</span>
)

<span class="hljs-comment"># === ä¸€ã€Graph-as-a-Tool ===</span>
<span class="hljs-comment"># === æ¨¡æ‹Ÿä¸€ä¸ªä¸ç¨³å®šçš„SSHæ—¥å¿—æŸ¥è¯¢è¿‡ç¨‹ ===</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SSHState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    target_ip: <span class="hljs-built_in">str</span>
    attempt: <span class="hljs-built_in">int</span>
    logs: <span class="hljs-built_in">str</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">connect_ssh</span>(<span class="hljs-params">state:SSHState</span>):
    <span class="hljs-string">"""æ¨¡æ‹ŸSSHè¿æ¥ï¼Œç¬¬ä¸€æ¬¡è¿æ¥å¿…å®šè¶…æ—¶"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f'    [å­å›¾]æ­£åœ¨å°è¯•è¿æ¥æœåŠ¡å™¨<span class="hljs-subst">{state[<span class="hljs-string">"target_ip"</span>]}</span>(ç¬¬<span class="hljs-subst">{state[<span class="hljs-string">"attempt"</span>]}</span>æ¬¡)'</span>)
    <span class="hljs-keyword">if</span> state[<span class="hljs-string">'attempt'</span>] == <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">'logs'</span>:<span class="hljs-string">'ERROR:Connection Timed Out'</span>,<span class="hljs-string">'attempt'</span>:state[<span class="hljs-string">'attempt'</span>]+<span class="hljs-number">1</span>}
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'logs'</span>:<span class="hljs-string">'CONNECTED'</span>,<span class="hljs-string">'attempt'</span>:state[<span class="hljs-string">'attempt'</span>]+<span class="hljs-number">1</span>}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">grep_system_logs</span>(<span class="hljs-params">state:SSHState</span>):
    <span class="hljs-string">"""è¿æ¥æˆåŠŸåè¯»å–æ—¥å¿—"""</span>
    <span class="hljs-keyword">if</span> state[<span class="hljs-string">"logs"</span>] == <span class="hljs-string">"CONNECTED"</span>:
        <span class="hljs-comment"># æ‰“å°æŸ¥åˆ°çš„ç»“æœ</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">'logs'</span>:<span class="hljs-string">f'SUCCESS: Retrieved logs from <span class="hljs-subst">{state[<span class="hljs-string">'target_ip'</span>]}</span>:[ERROR: OutOfMemory at line 4032]'</span>}
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'logs'</span>:state[<span class="hljs-string">'logs'</span>]} <span class="hljs-comment"># ä¿æŒé”™è¯¯çŠ¶æ€</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">ssh_routing</span>(<span class="hljs-params">state:SSHState</span>):
    <span class="hljs-string">"""è·¯ç”±é€»è¾‘ï¼šå¦‚æœè¿æ¥å¤±è´¥ä¸”å°è¯•æ¬¡æ•°å°‘äº3ï¼Œé‡è¯•"""</span>
    <span class="hljs-keyword">if</span> <span class="hljs-string">"ERROR"</span> <span class="hljs-keyword">in</span> state[<span class="hljs-string">'logs'</span>] <span class="hljs-keyword">and</span> state[<span class="hljs-string">"attempt"</span>] &lt;= <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"connect"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"grep"</span>

<span class="hljs-comment"># æ„å»ºå­å›¾</span>
ssh_workflow = StateGraph(SSHState)
ssh_workflow.add_node(<span class="hljs-string">"connect"</span>,connect_ssh)
ssh_workflow.add_node(<span class="hljs-string">"grep"</span>,grep_system_logs)

ssh_workflow.add_edge(START,<span class="hljs-string">"connect"</span>)
ssh_workflow.add_conditional_edges(<span class="hljs-string">"connect"</span>,ssh_routing,{<span class="hljs-string">"connect"</span>:<span class="hljs-string">"connect"</span>,<span class="hljs-string">"grep"</span>:<span class="hljs-string">"grep"</span>})
ssh_workflow.add_edge(<span class="hljs-string">"grep"</span>,END)

ssh_app = ssh_workflow.<span class="hljs-built_in">compile</span>()

<span class="hljs-comment"># å°†å­å›¾å°è£…ä¸ºå·¥å…·</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_server_logs</span>(<span class="hljs-params">ip_address:<span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""ä½¿ç”¨SSHè¿æ¥æœåŠ¡å™¨å¹¶åˆ†ææœ€è¿‘çš„é”™è¯¯æ—¥å¿—ï¼ˆå†…å«è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼‰"""</span>
    result = ssh_app.invoke({<span class="hljs-string">"target_ip"</span>:ip_address,<span class="hljs-string">"attempt"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"log"</span>:<span class="hljs-string">""</span>})
    <span class="hljs-keyword">return</span> result[<span class="hljs-string">'logs'</span>]



<span class="hljs-comment"># === äºŒã€Human-in-the-Loop ===</span>
<span class="hljs-comment"># === é‡å¯æœåŠ¡ï¼Œé«˜å±æ“ä½œï¼Œéœ€è¦å®¡æ‰¹ ===</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">restart_service</span>(<span class="hljs-params">service_name:<span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""é‡å¯æŒ‡å®šçš„æœåŠ¡å™¨æœåŠ¡"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"æœåŠ¡[<span class="hljs-subst">{service_name}</span>]å·²æˆåŠŸé‡å¯ï¼Œç³»ç»Ÿè´Ÿè½½å·²æ¢å¤æ­£å¸¸"</span>



<span class="hljs-comment"># === ä¸‰ã€Multi-Agent ç¼–æ’ ===</span>
<span class="hljs-comment"># === æ€»æ§è°ƒåº¦ + ä¸“å®¶åˆ†å·¥ ===</span>

<span class="hljs-comment"># 1. å…±äº«çŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentState</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
    messages:Annotated[<span class="hljs-built_in">list</span>,add_messages]
    next_speaker:<span class="hljs-built_in">str</span>

<span class="hljs-comment"># 2. ä¸“å®¶èŠ‚ç‚¹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">log_expert</span>(<span class="hljs-params">state:AgentState</span>):
    prompt = <span class="hljs-string">"ä½ æ˜¯æ—¥å¿—åˆ†æä¸“å®¶ï¼Œä½¿ç”¨å·¥å…·åˆ†ææœåŠ¡å™¨æ—¥å¿—ï¼Œæ‰¾å‡ºæŠ¥é”™åŸå› ã€‚å›ç­”éœ€ç®€æ´ã€‚"</span>
    messages = [SystemMessage(content=prompt)] + state[<span class="hljs-string">'messages'</span>]
    <span class="hljs-comment"># ç»‘å®šå­å›¾å·¥å…·</span>
    tools = [analyze_server_logs]
    response = llm.bind_tools(tools).invoke(messages)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>:[response]}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">ops_expert</span>(<span class="hljs-params">state:AgentState</span>):
    prompt = <span class="hljs-string">"ä½ æ˜¯è¿ç»´ä¸“å®¶ã€‚å½“æ”¶åˆ°ä¿®å¤æŒ‡ä»¤æ—¶ï¼Œè¯·ç«‹å³è°ƒç”¨ 'restart_service' å·¥å…·è¿›è¡Œä¿®å¤ï¼Œä¸è¦è¾“å‡ºä»»ä½•é¢å¤–çš„è§£é‡Šæ–‡æœ¬ã€‚"</span>
    messages = [SystemMessage(content=prompt)] + state[<span class="hljs-string">'messages'</span>]
    tools = [restart_service]
    <span class="hljs-comment"># ç»‘å®šæ•æ„Ÿå·¥å…·</span>
    response = llm.bind_tools(tools).invoke(messages)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>:[response]}

<span class="hljs-comment"># 3. æ€»æ§èŠ‚ç‚¹ï¼ˆsupervisorï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">supervisor</span>(<span class="hljs-params">state:AgentState</span>):
    prompt = <span class="hljs-string">"""
    ä½ æ˜¯ IT è¿ç»´æ€»æŒ‡æŒ¥ã€‚
    ä¸“å®¶åˆ—è¡¨ï¼š
    - log_expert
    - ops_expert

    å†³ç­–é€»è¾‘ï¼š
    1. æœªçŸ¥åŸå›  -&gt; log_expert
    2. å·²çŸ¥åŸå› ï¼ˆå¦‚OOMã€æŠ¥é”™ï¼‰ -&gt; ops_expert
    3. ä¿®å¤å®Œæˆ -&gt; FINISH

    ã€è¾“å‡ºçº¦æŸã€‘
    ä»…è¾“å‡ºä¸‹ä¸€ä¸ªä¸“å®¶çš„åå­—ï¼ˆå¦‚ log_expertï¼‰ï¼Œä¸è¦åŒ…å«ä»»ä½•å…¶ä»–å­—ç¬¦æˆ–æ ‡ç‚¹ã€‚
    """</span>
    messages = [SystemMessage(content=prompt)] + state[<span class="hljs-string">'messages'</span>]
    response = llm.invoke(messages)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"next_speaker"</span>:response.content.strip()}

<span class="hljs-comment"># 4. è·¯ç”±é€»è¾‘</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_supervisor</span>(<span class="hljs-params">state:AgentState</span>):
    <span class="hljs-keyword">if</span> state[<span class="hljs-string">'next_speaker'</span>] == <span class="hljs-string">"FINISH"</span>:
        <span class="hljs-keyword">return</span> END
    <span class="hljs-keyword">return</span> state[<span class="hljs-string">'next_speaker'</span>]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">should_continue</span>(<span class="hljs-params">state:AgentState</span>):
    last_msg = state[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(last_msg,<span class="hljs-string">"tool_calls"</span>) <span class="hljs-keyword">and</span> last_msg.tool_calls:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"tools"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"supervisor"</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_after_tool</span>(<span class="hljs-params">state:AgentState</span>):
    <span class="hljs-keyword">return</span> state[<span class="hljs-string">"next_speaker"</span>]


<span class="hljs-comment"># === å››ã€æ„å»ºä¸»å›¾ä¸é›†æˆ ===</span>

<span class="hljs-comment"># å·¥å…·é›†åˆ</span>
all_tools = [analyze_server_logs,restart_service]
tool_node = ToolNode(all_tools)

<span class="hljs-comment"># æ„å»ºä¸»å›¾</span>
workflow = StateGraph(AgentState)

workflow.add_node(<span class="hljs-string">"supervisor"</span>,supervisor)
workflow.add_node(<span class="hljs-string">"log_expert"</span>,log_expert)
workflow.add_node(<span class="hljs-string">"ops_expert"</span>,ops_expert)
workflow.add_node(<span class="hljs-string">"tools"</span>,tool_node)

workflow.add_edge(START,<span class="hljs-string">"supervisor"</span>)
workflow.add_conditional_edges(<span class="hljs-string">"supervisor"</span>,route_supervisor)
<span class="hljs-keyword">for</span> member <span class="hljs-keyword">in</span> [<span class="hljs-string">"log_expert"</span>,<span class="hljs-string">"ops_expert"</span>]:
    workflow.add_conditional_edges(
        member,
        should_continue,
        {<span class="hljs-string">"tools"</span>:<span class="hljs-string">"tools"</span>,<span class="hljs-string">"supervisor"</span>:<span class="hljs-string">"supervisor"</span>}
    )
workflow.add_conditional_edges(<span class="hljs-string">"tools"</span>,route_after_tool)

<span class="hljs-comment"># ç¼–è¯‘å›¾:åŠ å…¥è®°å¿†ä¸ä¸­æ–­æœºåˆ¶(Human-in-the-Loop)</span>
<span class="hljs-comment"># æ³¨: æˆ‘ä»¬åœ¨æ‰€æœ‰å·¥å…·æ‰§è¡Œå‰éƒ½æš‚åœï¼Œä½†åœ¨è¿è¡Œæ—¶è¿›è¡Œé€»è¾‘åˆ¤æ–­</span>
app = workflow.<span class="hljs-built_in">compile</span>(
    checkpointer=MemorySaver(),
    interrupt_before=[<span class="hljs-string">"tools"</span>]
)

<span class="hljs-comment"># === äº”ã€è¿è¡Œæ—¶é€»è¾‘(æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒçš„äº¤äº’) ===</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-comment"># æ¨¡æ‹Ÿä¸€æ¬¡å®Œæ•´çš„æ•…éšœå¤„ç†æµç¨‹</span>
    user_input = <span class="hljs-string">"æœåŠ¡å™¨ 192.168.1.100 æŠ¥è­¦ï¼Œå“åº”ææ…¢ï¼Œè¯·å¤„ç†ã€‚"</span>
    config = {
        <span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"incident_001"</span>}
    }

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f'æ”¶åˆ°æŠ¥è­¦ : <span class="hljs-subst">{user_input}</span>'</span>)
    inputs = {<span class="hljs-string">"messages"</span>:[HumanMessage(content=user_input)]}

    <span class="hljs-comment"># å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°ä»»åŠ¡ç»“æŸ</span>
    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        <span class="hljs-comment"># 1. æ‰§è¡Œå›¾ç›´åˆ°ä¸­æ–­æˆ–ç»“æŸ</span>
        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> app.stream(inputs,config,stream_mode=<span class="hljs-string">"values"</span>):
            <span class="hljs-keyword">pass</span>

        <span class="hljs-comment"># 2. æ£€æŸ¥å½“å‰çŠ¶æ€</span>
        snapshot = app.get_state(config)
        next_tasks = snapshot.<span class="hljs-built_in">next</span>

        <span class="hljs-comment"># æ²¡æœ‰ä¸‹ä¸€æ­¥ï¼Œä»»åŠ¡ç»“æŸ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> next_tasks:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"    æœ€ç»ˆæŠ¥å‘Š:<span class="hljs-subst">{snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>].content}</span>"</span>)
            <span class="hljs-keyword">break</span>

        <span class="hljs-comment"># 3. å¤„ç†ä¸­æ–­:åˆ¤æ–­æ˜¯å“ªä¸ªå·¥å…·è¢«è°ƒç”¨</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"tools"</span> <span class="hljs-keyword">in</span> next_tasks:
            last_msg = snapshot.values[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>]
            tool_call = last_msg.tool_calls[<span class="hljs-number">0</span>]
            tool_name = tool_call[<span class="hljs-string">"name"</span>]

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f'\n[ç³»ç»Ÿæš‚åœ] è¯·æ±‚è°ƒç”¨å·¥å…·:<span class="hljs-subst">{tool_name}</span>'</span>)

            <span class="hljs-comment"># ç­–ç•¥A: è‡ªåŠ¨æ”¾è¡Œå®‰å…¨å·¥å…·(Graph-as-a-Tool)</span>
            <span class="hljs-keyword">if</span> tool_name == <span class="hljs-string">"analyze_server_logs"</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">'     -&gt; è¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢ç±»å·¥å…·ï¼Œç³»ç»Ÿè‡ªè¡Œæ‰¹å‡†ã€‚'</span>)
                inputs = <span class="hljs-literal">None</span> <span class="hljs-comment"># ç»§ç»­æ‰§è¡Œ</span>
                <span class="hljs-keyword">continue</span>

            <span class="hljs-comment"># ç­–ç•¥B: æ‹¦æˆªé«˜å±å·¥å…·(Human-in-the-Loop)</span>
            <span class="hljs-keyword">elif</span> tool_name == <span class="hljs-string">"restart_service"</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"     -&gt; âš ï¸ è­¦å‘Š: è¿™æ˜¯ä¸€ä¸ªé«˜å±æ“ä½œ!"</span>)
                user_approval = <span class="hljs-built_in">input</span>(<span class="hljs-string">"     -&gt; è¯·äººå·¥å®¡æ‰¹ (è¾“å…¥ 'yes' å…è®¸é‡å¯):"</span>)

                <span class="hljs-keyword">if</span> user_approval == <span class="hljs-string">"yes"</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">'    -&gt; âœ… å®¡æ‰¹é€šè¿‡ï¼Œæ­£åœ¨æ‰§è¡Œ...'</span>)
                    inputs = <span class="hljs-literal">None</span> <span class="hljs-comment"># ç»§ç»­æ‰§è¡Œ</span>
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">'    -&gt; âŒï¸ å®¡æ‰¹æ‹’ç»ï¼Œä»»åŠ¡ç»ˆæ­¢!'</span>)
                    <span class="hljs-comment"># å®é™…ç³»ç»Ÿä¸­ï¼Œåº”é€šè¿‡ ToolMessage åé¦ˆäººå·¥æ‹’ç»ï¼Œä½¿ LLM èƒ½ç»§ç»­å“åº”ï¼›</span>
                    <span class="hljs-comment"># å½“å‰demoä¸ºç®€åŒ–ï¼Œç›´æ¥é€€å‡º</span>
                    <span class="hljs-keyword">break</span>
</code></pre>
<h3 data-id="heading-16">è¿è¡Œæ•ˆæœ</h3>
<p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªéå¸¸ç²¾å½©çš„<strong>äº¤äº’è¿‡ç¨‹</strong>ï¼š</p>
<ol>
<li>
<p>æ€»æ§è°ƒåº¦ï¼šSupervisoræ”¶åˆ°æŠ¥è­¦ï¼Œé¦–å…ˆæŒ‡æ´¾log_expertã€‚</p>
</li>
<li>
<p>å­å›¾è‡ªåŠ¨é‡è¯•:</p>
</li>
</ol>
<ul>
<li>log_expert è°ƒç”¨ analyze_server_logsï¼›</li>
<li>ç³»ç»Ÿè¯†åˆ«è¿™æ˜¯å®‰å…¨å·¥å…·ï¼Œè‡ªåŠ¨æ‰¹å‡†ï¼›</li>
<li>æ§åˆ¶å°æ‰“å°å‡ºå­å›¾å†…éƒ¨é€»è¾‘ï¼šç¬¬ä¸€æ¬¡è¿æ¥è¶…æ—¶ -&gt; è‡ªåŠ¨é‡è¯• -&gt; è¿æ¥æˆåŠŸ -&gt; è·å–åˆ° OutOfMemory é”™è¯¯</li>
</ul>
<ol start="3">
<li>äºŒæ¬¡è°ƒåº¦ï¼š</li>
</ol>
<ul>
<li>log_expert æ±‡æŠ¥ï¼šâ€œå‘ç°äº† OOM é”™è¯¯â€</li>
<li>Supervisor å†³ç­–ï¼šâ€œè¿™æ˜¯å†…å­˜æº¢å‡ºï¼Œéœ€è¦é‡å¯ï¼ŒæŒ‡æ´¾ops_expertã€‚â€</li>
</ul>
<ol start="4">
<li>äººå·¥æ‹¦æˆª</li>
</ol>
<ul>
<li>ops_expert è¯•å›¾è°ƒç”¨ restart_servicesã€‚</li>
<li>ç³»ç»Ÿè¯†åˆ«è¿™æ˜¯é«˜å±å·¥å…·ï¼Œå¼ºåˆ¶æš‚åœã€‚</li>
<li>æ§åˆ¶å°æç¤ºï¼šâš ï¸ è­¦å‘Š: è¿™æ˜¯ä¸€ä¸ªé«˜å±æ“ä½œ!</li>
</ul>
<ol start="5">
<li>æœ€ç»ˆä¿®å¤ï¼š</li>
</ol>
<ul>
<li>è¾“å…¥yes</li>
<li>æœåŠ¡é‡å¯æˆåŠŸï¼ŒSupervisor è¾“å‡º FINISHã€‚</li>
</ul>
<h2 data-id="heading-17"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/444f8dac2f934354a28c1c7b63285d48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=tgqknT2Ww6bEix33D0ErM14qbRA%3D" alt="" loading="lazy"/></h2>
<p>é€šè¿‡LangSmithçœ‹ä¸€ä¸‹è¯¦ç»†è¾“å‡ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/190f5e36d0164a9b985b2bee19d62887~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN5Lya5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764494889&amp;x-signature=06KJQL%2BryeOHhTnhNuROf7HPXfU%3D" alt="" loading="lazy"/>æµç¨‹è¿è¡Œå®Œç¾ã€‚</p>
<h2 data-id="heading-18">æ€»ç»“ã€</h2>
<p><strong>çŸ¥è¯†ç‚¹æ¦‚æ‹¬</strong>ï¼š<strong>Human-in-the-Loopï¼ˆäººå·¥å¹²é¢„ï¼‰ï½œ Graph-as-a-Toolï¼ˆå›¾å³å·¥å…·ï¼‰| Multi-Agent å¤šæ™ºèƒ½ä½“ç¼–æ’</strong></p>
<p>é€šè¿‡è¿™ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œæˆ‘ä»¬è¯æ˜äº† LangGraph ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ DAG ï¼ˆæœ‰å‘æ— ç¯å›¾â€”â€”æœ‰æ–¹å‘ä½†ä¸èƒ½å½¢æˆå¾ªç¯ï¼‰ï¼Œå®ƒæ˜¯ä¸€å¥—<strong>æ„ç­‘å¤æ‚ç³»ç»Ÿçš„éª¨æ¶</strong>ã€‚</p>
<p><strong>Graph-as-a-Toolï¼š</strong> è®©æˆ‘ä»¬èƒ½æŠŠè„æ´»ç´¯æ´»è—èµ·æ¥ï¼Œä¸»æµç¨‹ä¿æŒå¹²å‡€ã€‚</p>
<p><strong>Human-in-the-Loopï¼š</strong> è®©æˆ‘ä»¬æ•¢äºæŠŠAgentæ”¾å…¥ç”Ÿäº§ç¯å¢ƒï¼Œè®©äººå·¥ç¡®è®¤ä½œä¸ºæœ€ç»ˆé˜²çº¿ã€‚</p>
<p><strong>Multi-Agentï¼š</strong> è®©ç³»ç»Ÿå…·å¤‡äº†å¯æ‰©å±•æ€§ï¼ŒåŠ åŠŸèƒ½åªæ˜¯åŠ ä¸ªä¸“å®¶èŠ‚ç‚¹è€Œå·²ã€‚</p>
<p>ä¸‰è€…ç»“åˆï¼Œå³å¯æ„å»ºä¼ä¸šçº§å¯ä¿¡ Agent ç³»ç»Ÿã€‚</p>
<hr/>
<p>é¢„å‘Šï¼š<strong>10 ç¯‡ ã€Š MCP åŸºç¡€ç¯‡ã€‹</strong></p>
<p>09 ç¯‡çš„æ‰€æœ‰ä¸“å®¶éƒ½è¿è¡Œåœ¨åŒä¸€Pythonè¿›ç¨‹ä¸­ã€‚ä½†å¦‚æœï¼š</p>
<ul>
<li>RAG æœåŠ¡éƒ¨ç½²åœ¨å…¬å¸å†…ç½‘ï¼Ÿ</li>
<li>ä»£ç ç”Ÿæˆå™¨æ˜¯ Java å†™çš„ REST APIï¼Ÿ</li>
<li>ä½ æƒ³ç›´æ¥è°ƒç”¨é«˜å¾·åœ°å›¾ã€12306çš„å®˜æ–¹æœåŠ¡ï¼Ÿ</li>
</ul>
<p>10ç¯‡ï¼Œæˆ‘ä»¬å°†å¼•å…¥MCP <strong>ï¼ˆModel Context Protocolï¼‰åè®®ï¼Œ</strong></p>
<p><strong>è®©ä»»ä½•ç¬¦åˆæ ‡å‡†çš„è¿œç¨‹æœåŠ¡ï¼Œéƒ½èƒ½æˆä¸ºä½ çš„å·¥å…·â€”â€”æ— éœ€å†™ä¸€è¡Œ@toolï¼</strong></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python å¼€å‘ç¯å¢ƒä¸åŒ…ç®¡ç†]]></title>    <link>https://juejin.cn/post/7575119254313992218</link>    <guid>https://juejin.cn/post/7575119254313992218</guid>    <pubDate>2025-11-23T10:08:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575119254313992218" data-draft-id="7575133880436457523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python å¼€å‘ç¯å¢ƒä¸åŒ…ç®¡ç†"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-11-23T10:08:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cadecode"/> <meta itemprop="url" content="https://juejin.cn/user/562546315637662"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python å¼€å‘ç¯å¢ƒä¸åŒ…ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/562546315637662/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cadecode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:08:55.000Z" title="Sun Nov 23 2025 10:08:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Python çš„å®‰è£…</h2>
<h3 data-id="heading-1">Windows</h3>
<p>ä¸‹è½½å®‰è£…åŒ…ï¼Œæ¨èä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fmirrors.tuna.tsinghua.edu.cn%2Fpython%2F3.13.9%2F" target="_blank" title="https://mirrors.tuna.tsinghua.edu.cn/python/3.13.9/" ref="nofollow noopener noreferrer">æ¸…åå¼€æºè½¯ä»¶é•œåƒç«™</a>ä¸‹è½½</p>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e87bcf93c07f4f4eb7bf7a97026c467f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2FkZWNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497335&amp;x-signature=4ZNvqdXEE1mgLhwMqL0y9rnFfZA%3D" alt="image" loading="lazy"/>â€‹</p>
<p>ä»¥ python-3.13.9-amd64.exe ä¸ºä¾‹ï¼ŒPython ç‰ˆæœ¬ 3.13.9</p>
<p>å®‰è£… tipsï¼š</p>
<ul>
<li>å‹¾é€‰æœ€ä¸‹é¢ â€œAdd Python 3.x to PATHâ€ å°† Python é…ç½®åˆ°ç¯å¢ƒå˜é‡ï¼ˆç”¨æˆ·æœºç¯å¢ƒå˜é‡ï¼‰</li>
</ul>

<ul>
<li>ç„¶ç‚¹ â€œCustomize installationâ€ï¼Œå»ºè®®å…¨å‹¾</li>
<li>å®‰è£…è·¯å¾„é€‰æ‹©è‡ªå·±æ—¥å¸¸å­˜æ”¾å¼€å‘ç¯å¢ƒ SDK çš„ç›®å½•</li>
</ul>
<p>é…ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<p>å½“å®‰è£…æ—¶æ²¡æœ‰å‹¾é€‰ Add to PATHï¼Œåˆ™éœ€è¦å°†å®‰è£…ç›®å½•ã€å®‰è£…ç›®å½•ä¸‹çš„ Scripts ç›®å½•é…ç½®åˆ°ç¯å¢ƒå˜é‡ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<pre><code class="hljs">python -V
pip -V
</code></pre>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad39b12cb44d4a0ebbfc15526d9dae27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2FkZWNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497335&amp;x-signature=8WAh7UK%2FkjsdQa1U6Y%2FEIORmsvw%3D" alt="image" loading="lazy"/>â€‹</p>
<p>é…ç½® pip å›½å†…é•œåƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">pip config set global.index-url https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple</span>
pip config set global.trusted-host pypi.tuna.tsinghua.edu.cn
pip config list
</code></pre>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6b2f3dbd8394741b25e0090dd65fbf3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2FkZWNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497335&amp;x-signature=maV93clw%2FT7sWK%2BCiOjcRvnWH3w%3D" alt="image" loading="lazy"/>â€‹</p>
<h3 data-id="heading-2">Linux</h3>
<p>ä»¥ Debian ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt update
<span class="hljs-comment"># ç›´æ¥è£…å®˜æ–¹ä»“åº“ç‰ˆï¼ˆå¯èƒ½ä¸æ˜¯æœ€æ–°ï¼‰</span>
sudo apt install python3 python3-pip python3-venv
</code></pre>
<p>æ³¨æ„äº‹é¡¹ï¼šåœ¨æ—©å‰ç‰ˆæœ¬çš„ Ubuntu/Debian ä¸­ï¼Œç¦æ­¢ä½¿ç”¨ sudo pip installâ€‹ è€Œæ²¡æœ‰ç¦æ­¢ç”¨æˆ·çº§çš„ installï¼ˆé€šå¸¸å®‰è£…åˆ° ~/.local/lib/python3.x/site-packages ç›®å½•ï¼‰ã€‚</p>
<p>ä» Ubuntu 23.04ï¼ˆåŠ Debian 12ï¼‰å¼€å§‹å¼ºåˆ¶æ‰§æ‰§è¡Œ PEP 668 ä¿æŠ¤æœºåˆ¶ï¼Œç¦æ­¢ç”¨æˆ·ä½¿ç”¨ç³»ç»Ÿçº§ Python æ‰§è¡Œ pip installâ€‹ æ“ä½œï¼Œå»ºè®®é€šè¿‡è™šæ‹Ÿç¯å¢ƒéš”ç¦»å®‰è£…ã€‚</p>
<h2 data-id="heading-3">è™šæ‹Ÿç¯å¢ƒ</h2>
<h3 data-id="heading-4">è™šæ‹Ÿç¯å¢ƒæ˜¯ä»€ä¹ˆ</h3>
<p>åœ¨ä¼—å¤šç¼–ç¨‹è¯­è¨€ï¼Œä¾èµ–éš”ç¦»æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ã€‚æ‹¿ Java æ¥è¯´ï¼ŒJava é»˜è®¤ä½¿ç”¨æœ¬åœ°çš„å…¨å±€ä»“åº“ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ maven / gradle æ„å»ºå·¥å…·å£°æ˜å¥½éœ€è¦çš„ä¾èµ–ç‰ˆæœ¬ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒNodeJs æ˜¯å¤©ç”Ÿçš„é¡¹ç›®çº§éš”ç¦»ï¼Œé™¤éå¼ºè¡ŒæŒ‡å®šå…¨å±€å®‰è£…ï¼Œå¦åˆ™æ‰€æœ‰ä¾èµ–éƒ½è¢«å®‰è£…åˆ°å½“å‰é¡¹ç›®çš„ node_modulesâ€‹ ç›®å½•ä¸‹ï¼Œå½“ç§å¤„ç†æ–¹å¼ä¼šå¯¼è‡´ä¸€ä»½ä¾èµ–åœ¨ä¸åŒé¡¹ç›®å ç”¨å¤šä»½ç©ºé—´ï¼Œå› æ­¤ä¹Ÿå‚¬ç”Ÿäº†ä¸€äº›åŒ…ç®¡ç†å·¥å…·ï¼Œå¦‚ PNPMï¼Œåˆ©ç”¨ å…¨å±€ç¼“å­˜ + ç¡¬é“¾æ¥â€‹ å®ç°èŠ‚çº¦ç£ç›˜å’Œé¿å…é‡å¤ä¸‹è½½çš„ç›®çš„ã€‚</p>
<p>Python å®˜æ–¹é»˜è®¤æä¾›äº†è™šæ‹Ÿç¯å¢ƒå·¥å…· venvï¼Œåœ¨ä¸åŒåœºæ™¯ä¸€äº›ç¤¾åŒºä¹Ÿæœ‰å…¶ä»–çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ conda ç­‰ï¼Œåœ¨çº¯ Python å¼€å‘</p>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿç¯å¢ƒ</h3>
<p>åœ¨ä¸€ä¸ªç¯å¢ƒä¸­ï¼Œä¸€ä¸ªä¾èµ–çš„å®‰è£…ä¸åŒç‰ˆæœ¬ï¼Œåè€…ä¼šè¦†ç›–å‰è€…ï¼Œåªä¼šå­˜åœ¨ä¸€ä¸ªç‰ˆæœ¬ï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ªç¯å¢ƒä¸‹çš„å¤šä¸ªé¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¸åŒè€Œå¯¼è‡´å†²çªï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¾èµ–ç¯å¢ƒçš„éš”ç¦»ã€‚</p>
<p>å…¶æ¬¡ï¼Œä¸€äº›æ“ä½œç³»ç»Ÿé»˜è®¤è‡ªå¸¦äº† Python ç¯å¢ƒï¼Œä¸”ç¦æ­¢äº†ç”¨æˆ·åœ¨å…¨å±€ç¯å¢ƒä¸­å®‰è£…åŒ…ï¼Œé˜²æ­¢ç ´åæ“ä½œç³»ç»Ÿç¨³å®šæ€§ï¼Œå› æ­¤å¿…é¡»åˆ›å»ºè™šæ‹Ÿç¯å¢ƒæ¥ä½¿ç”¨</p>
<h3 data-id="heading-6">ä½¿ç”¨ venv</h3>
<p>Python 3.3+ å†…ç½®äº† venvï¼Œåˆ›å»ºè™šæ‹Ÿç¯å¢ƒçš„å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»º</span>
python -m venv .venv

<span class="hljs-comment"># æ¿€æ´»ï¼ˆLinux/macOSï¼‰</span>
<span class="hljs-built_in">source</span> .venv/bin/activate
<span class="hljs-comment"># Windows</span>
.venv\Scripts\activate

<span class="hljs-comment"># éªŒè¯</span>
<span class="hljs-built_in">which</span> python  <span class="hljs-comment"># æŒ‡å‘ .venv/bin/python</span>
pip list      <span class="hljs-comment"># åªæœ‰ 2 ä¸ªåŒ…ï¼špip setuptools</span>

<span class="hljs-comment"># é€€å‡º</span>
deactivate
</code></pre>
<p>åœ¨å½“å‰é¡¹ç›®çš„ .venv ç›®å½•ä¸‹ï¼Œä½¿ç”¨ Scriptsâ€‹ ç›®å½•ä¸‹çš„ activate è„šæœ¬æ¿€æ´»å½“å‰è™šæ‹Ÿç¯å¢ƒï¼Œåç»­ä½¿ç”¨ pipâ€‹ å®‰è£…ä¾èµ–ï¼Œéƒ½å°†å­˜æ”¾åˆ° Lib/site-packagesâ€‹ ç›®å½•ï¼Œæ¨èä½¿ç”¨ python -m pipâ€‹ æ¥æ‰§è¡Œ pip å‘½ä»¤ï¼Œè¿™æ ·æŒ‡å®š Python è§£é‡Šå™¨å¯ä»¥é˜²æ­¢ç”±äºç¯å¢ƒå˜é‡ä¼˜å…ˆçº§é—®é¢˜è€Œå¯¼è‡´ä½¿ç”¨å…¶ä»–ç¯å¢ƒçš„ pipã€‚</p>
<h2 data-id="heading-7">åŒ…ç®¡ç†</h2>
<h3 data-id="heading-8">pip</h3>
<p>Python è‡ªå¸¦çš„ pip åŒ…ç®¡ç†å·¥å…·ï¼Œå¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å®‰è£…</span>
pip install <span class="hljs-attr">requests</span>==<span class="hljs-number">2.31</span>.<span class="hljs-number">0</span>

<span class="hljs-comment"># å‡çº§</span>
pip install -U requests

<span class="hljs-comment"># å¸è½½</span>
pip uninstall requests -y

<span class="hljs-comment"># æŸ¥çœ‹</span>
pip show requests
</code></pre>
<p>pip å¤ç°ä¾èµ–çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆ</span>
pip freeze &gt; requirements.txt

<span class="hljs-comment"># æ¢å¤</span>
pip install -r requirements.txt
</code></pre>
<p>pip freeze ä¼šåˆ—å‡ºæœ‰å·²å®‰è£…çš„ä¾èµ–åŠç‰ˆæœ¬</p>
<p>â€‹<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3c91ab7723f4df284baf3d09ae2ad0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2FkZWNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497335&amp;x-signature=C8UVlJaaWv04gMm6kgGUO0Q0pUg%3D" alt="image" loading="lazy"/>â€‹</p>
<p>å¯ä»¥çœ‹åˆ°å®‰è£… requests åº“ï¼ŒåŒæ—¶è‡ªåŠ¨å®‰è£…äº†å®ƒä¾èµ–çš„å…¶ä»–åº“ï¼Œæ‰€ä»¥é€šè¿‡å¯¼å‡ºçš„ requirements.txtâ€‹ æ–‡ä»¶ï¼Œå¯ä»¥å¿«é€Ÿå¤ç°ä¸€ä¸ªé¡¹ç›®çš„å¼€å‘åœºæ™¯ã€‚</p>
<p>é—®é¢˜æ˜¯å½“æˆ‘ä»¬ä¸åœ¨éœ€è¦ requests åº“æ—¶ï¼Œæ‰§è¡Œ pip uninstall requestsâ€‹ å¸è½½ requests åº“åï¼Œå‘ç°ç”±å®ƒè€Œå¼•å…¥çš„å…¶ä»–åº“å¹¶æ²¡æœ‰è¢«ç§»é™¤ï¼Œä¹Ÿå°±è¯´ pip æ— æ³•æ­£ç¡®å¤„ç†ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–ã€‚</p>
<p>å¯¹äºé‚£äº›ç”±äºæˆä¸ºå­¤å„¿çš„é—´æ¥ä¾èµ–ï¼Œå®˜æ–¹ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ pyproject.tomlâ€‹ã€‚</p>
<p>â€‹pyproject.tomlâ€‹ æ˜¯å®˜æ–¹æ¨å‡ºçš„ Python é¡¹ç›®é…ç½®è¡¨ï¼Œç”¨äºç»Ÿä¸€å„å¤§å·¥å…·çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰å¾ˆå¤šå·¥å…·éƒ½å·²ç»é™†ç»­æ”¯æŒã€‚</p>
<p>åœ¨ toml ä¸­ç»´æŠ¤åªéœ€è¦ç»´æŠ¤å¥½ç›´æ¥ä¾èµ–ç‰ˆæœ¬</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[project]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"learn-python"</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">description</span> = <span class="hljs-string">"Add your description here"</span>
<span class="hljs-attr">readme</span> = <span class="hljs-string">"README.md"</span>
<span class="hljs-attr">requires-python</span> = <span class="hljs-string">"&gt;=3.13"</span>
<span class="hljs-attr">dependencies</span> = [
    <span class="hljs-string">"requests&gt;=2.32.5"</span>,
]
</code></pre>
<p>pip 23+ æ”¯æŒä» pyproject.tomlâ€‹ å®‰è£…ä¾èµ–</p>
<pre><code class="hljs language-bash" lang="bash">pip install .
<span class="hljs-comment"># æˆ–</span>
pip install -e . 
</code></pre>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ pip install .â€‹ ä¼šæ‰§è¡Œæ„å»º + å®‰è£…â€‹ ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¼šæŠŠæœ¬åœ°ä»£ç ç›´æ¥æ‰“è¿› site-packages ç›®å½•ï¼Œå¯¹äºé¢‘ç¹ä¿®æ”¹çš„æœ¬åœ°æ–‡ä»¶æ¥è¯´å¤šæœ‰ä¸ä¾¿ã€‚</p>
<p>æ¨èä½¿ç”¨ pip install -e .â€‹ æ¥å®‰è£…ä¾èµ–ï¼Œä¼šåœ¨ site-packages ç›®å½•ä¸­é“¾æ¥æ–‡ä»¶ï¼ŒæŒ‡å‘æœ¬åœ°ä»£ç ï¼Œä»è€Œç¼–è¾‘ä¿®æ”¹èƒ½åŠæ—¶ç”Ÿæ•ˆ</p>
</blockquote>
<h3 data-id="heading-9">uv</h3>
<p>pip å‘½ä»¤èƒ½ä» pyproject.tomlâ€‹ ä¸­è¯»å–ä¾èµ–ï¼Œä½†ç›®å‰ä¸èƒ½æ–¹ä¾¿çš„å°†ä¾èµ–é…ç½®åˆ° toml ä¸­ï¼Œæ¨èä½¿ç”¨æ›´åŠ å¼ºå¤§çš„ uv å‘½ä»¤ã€‚</p>
<p>uv æ˜¯ä¸€ä¸ªç”¨ Rust ç¼–å†™çš„æé€Ÿ Python åŒ…å’Œé¡¹ç›®ç®¡ç†å·¥å…·ã€‚</p>
<p>uv çš„å®‰è£…ï¼š</p>
<p>æ–¹æ³• 1ï¼šå®˜æ–¹å®‰è£…è„šæœ¬</p>
<pre><code class="hljs language-arduino" lang="arduino">curl -LsSf https:<span class="hljs-comment">//astral.sh/uv/install.sh | sh</span>
</code></pre>
<p>æ–¹æ³• 2ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fastral-sh%2Fuv%2Freleases" target="_blank" title="https://github.com/astral-sh/uv/releases" ref="nofollow noopener noreferrer">Github Releases</a> ä¸‹è½½å®‰è£…æ–‡ä»¶</p>
<p>æ–¹æ³• 3ï¼šç›´æ¥ä½¿ç”¨ pip å®‰è£…</p>
<pre><code class="hljs">pip install uv
</code></pre>
<p>å¸¸ç”¨å‘½ä»¤ï¼š</p>
<p>è™šæ‹Ÿç¯å¢ƒæ“ä½œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–°å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆé»˜è®¤ç›®å½• .venvï¼‰</span>
uv venv

<span class="hljs-comment"># æŒ‡å®š Python ç‰ˆæœ¬ï¼ˆè‡ªåŠ¨ä¸‹è½½è‹¥æœ¬åœ°æ²¡æœ‰ï¼‰</span>
uv venv --python 3.11
uv venv py38 -p 3.8        <span class="hljs-comment"># è‡ªå®šä¹‰ç›®å½•å</span>
</code></pre>
<p>ä¾èµ–ç®¡ç†ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># åˆå§‹åŒ–é¡¹ç›®</span>
uv <span class="hljs-keyword">init</span> myproj

<span class="hljs-meta"># å®‰è£…å…¨éƒ¨ä¾èµ–å¹¶ç”Ÿæˆ/æ›´æ–°é”æ–‡ä»¶</span>
uv sync

<span class="hljs-meta"># ä»…æ›´æ–°é”æ–‡ä»¶ï¼ˆä¸å®é™…è£…åŒ…ï¼Œé€‚åˆ CI æ ¡éªŒï¼‰</span>
uv <span class="hljs-keyword">lock</span>

<span class="hljs-meta"># å‡çº§å•ä¸ªåŒ…å¹¶é‡æ–°é”å®š</span>
<span class="hljs-meta"># é”æ–‡ä»¶ä¼šæ›´æ–°ä¸ºæœ€æ–°å…¼å®¹ç‰ˆæœ¬ï¼Œå…¶ä½™åŒ…ä¿æŒä¸åŠ¨ã€‚</span>
uv <span class="hljs-keyword">lock</span> --upgrade-package pandas

<span class="hljs-meta"># æ·»åŠ è¿è¡Œæ—¶ä¾èµ–</span>
<span class="hljs-meta"># è‡ªåŠ¨å‘ pyproject.toml çš„ [project]dependencies å†™å…¥ç‰ˆæœ¬åŒºé—´</span>
uv <span class="hljs-keyword">add</span> requests&gt;=<span class="hljs-number">2.31</span>

<span class="hljs-meta"># æ·»åŠ å¼€å‘ä¾èµ–</span>
<span class="hljs-meta"># åœ¨ pyproject.toml æ–°å¢ [dependency-groups] dev = ["pytest"]</span>
uv <span class="hljs-keyword">add</span> --<span class="hljs-keyword">group</span> dev pytest

<span class="hljs-meta"># ç§»é™¤ä¾èµ–</span>
uv <span class="hljs-keyword">remove</span> requests

<span class="hljs-meta"># ä»æ—§ requirements.txt æ‰¹é‡å¯¼å…¥</span>
uv <span class="hljs-keyword">add</span> -r requirements.txt
</code></pre>
<p>è¿è¡Œè„šæœ¬ï¼š</p>
<pre><code class="hljs language-css" lang="css"># ç›´æ¥æ‰§è¡Œ py æ–‡ä»¶
uv run <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span>
# æŒ‡å®šè§£é‡Šå™¨
uv run python <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span>
# æŒ‡å®šè§£é‡Šå™¨ç‰ˆæœ¬ï¼Œä¸å­˜åœ¨å°†ä¸‹è½½
uv run <span class="hljs-attr">--python</span> <span class="hljs-number">3.12</span> <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span>
</code></pre>
<p>å…¼å®¹ pip å‘½ä»¤(90%+)ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠŠ pip ç›´æ¥æ¢æˆ uv pipï¼Œé€Ÿåº¦æå‡ 10+ å€</span>
uv pip install requests
uv pip install -r requirements.txt
uv pip uninstall requests
</code></pre>
<h3 data-id="heading-10">è¿˜åŸä¾èµ–ç¯å¢ƒ</h3>
<p>å½“å‚ä¸ä¸€ä¸ªå·²å­˜åœ¨çš„ Python é¡¹ç›®ï¼Œå¦‚ä½•å¿«é€Ÿè¿˜åŸå¼€å‘ç¯å¢ƒï¼Ÿ</p>
<p>åœºæ™¯ 1ï¼šå½“é¡¹ç›®ä½¿ç”¨ pyproject toml æ–‡ä»¶æ¥ç®¡ç†</p>
<ul>
<li>ä½¿ç”¨ uvï¼Œç›´æ¥ uv syncâ€‹</li>
</ul>

<ul>
<li>ä½¿ç”¨ pipï¼Œä½¿ç”¨ pip install .â€‹</li>
</ul>
<p>åœºæ™¯ 2ï¼šå½“é¡¹ç›®ä½¿ç”¨ requirements.txt ç®¡ç†</p>
<ul>
<li>â€‹pip install -râ€‹ æˆ– uv pip install -râ€‹ ç›´æ¥å®‰è£…ä¾èµ–</li>
<li>â€‹uv add -râ€‹ å¯ä»¥å°† requirements å†…å®¹é…ç½®åˆ° pyproject toml</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¸…ç† Git ä»£ç åº“å¤§æ–‡ä»¶å†å²è®°å½•]]></title>    <link>https://juejin.cn/post/7575425466904870975</link>    <guid>https://juejin.cn/post/7575425466904870975</guid>    <pubDate>2025-11-23T10:01:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575425466904870975" data-draft-id="7575442779038973994" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¸…ç† Git ä»£ç åº“å¤§æ–‡ä»¶å†å²è®°å½•"/> <meta itemprop="keywords" content="Git,è¿ç»´"/> <meta itemprop="datePublished" content="2025-11-23T10:01:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="hen3y"/> <meta itemprop="url" content="https://juejin.cn/user/1425416494263021"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¸…ç† Git ä»£ç åº“å¤§æ–‡ä»¶å†å²è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1425416494263021/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    hen3y
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:01:18.000Z" title="Sun Nov 23 2025 10:01:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="obsidian">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#282b2e}.hljs-keyword,.hljs-literal,.hljs-selector-id,.hljs-selector-tag{color:#93c763}.hljs-number{color:#ffcd22}.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#e0e2e4}.hljs-attribute{color:#668bb0}.hljs-class .hljs-title,.hljs-code,.hljs-section{color:#fff}.hljs-link,.hljs-regexp{color:#d39745}.hljs-meta{color:#557182}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-emphasis,.hljs-name,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-subst,.hljs-tag,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable{color:#8cbbad}.hljs-string,.hljs-symbol{color:#ec7600}.hljs-comment,.hljs-deletion,.hljs-quote{color:#818e96}.hljs-selector-class{color:#a082bd}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-strong,.hljs-title,.hljs-type{font-weight:700}</style><h2 data-id="heading-0">æ¸…ç† Git ä»£ç åº“å¤§æ–‡ä»¶å†å²è®°å½•</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä¸å°å¿ƒå°†ä¸€äº›å¤§æ–‡ä»¶ï¼ˆå¦‚äºŒè¿›åˆ¶æ–‡ä»¶ã€å¤§å‹èµ„æºæ–‡ä»¶ç­‰ï¼‰æäº¤åˆ° Git ä»“åº“ä¸­ã€‚å³ä½¿åæ¥åˆ é™¤äº†è¿™äº›æ–‡ä»¶ï¼Œå®ƒä»¬ä¾ç„¶å­˜åœ¨äº Git çš„å†å²è®°å½•ä¸­ï¼Œå¯¼è‡´ <code>.git</code> ç›®å½•å˜å¾—éå¸¸åºå¤§ï¼Œä¸¥é‡å½±å“ <code>git clone</code> å’Œ <code>git pull</code> çš„é€Ÿåº¦ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åˆ†æ Git ä»“åº“çš„å ç”¨æƒ…å†µï¼Œå¹¶ä½¿ç”¨å·¥å…·æ¸…ç†å†å²è®°å½•ä¸­çš„å¤§æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-1">é—®é¢˜åˆ†æ</h3>
<p>Git ä»“åº“ä½“ç§¯è¿‡å¤§çš„ä¸»è¦åŸå› é€šå¸¸æ˜¯ <code>.git/objects/pack/*.pack</code> æ–‡ä»¶è¿‡å¤§ã€‚Git å°†æ–‡ä»¶å†å²è®°å½•å­˜å‚¨åœ¨æœ¬åœ°çš„ "database" ä¸­ï¼Œå¦‚æœå†å²è®°å½•ä¸­åŒ…å«äº†å¤§é‡çš„äºŒè¿›åˆ¶æ–‡ä»¶å˜åŠ¨ï¼Œpack æ–‡ä»¶å°±ä¼šè¿…é€Ÿè†¨èƒ€ã€‚</p>
<blockquote>
<p>[!info] Git Internals - Packfiles
Git ä½¿ç”¨ packfile æ¥ä¼˜åŒ–å­˜å‚¨ã€‚è¯¦æƒ…å¯å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2Fbook%2Fen%2Fv2%2FGit-Internals-Packfiles" target="_blank" title="https://git-scm.com/book/en/v2/Git-Internals-Packfiles" ref="nofollow noopener noreferrer">Git - Internals - Packfiles</a></p>
</blockquote>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šæ‰¾å‡ºå¤§æ–‡ä»¶</h3>
<p>åœ¨æ¸…ç†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰¾å‡ºæ˜¯å“ªäº›æ–‡ä»¶å ç”¨äº†å¤§é‡ç©ºé—´ã€‚</p>
<h4 data-id="heading-3">1. æŸ¥çœ‹ä»“åº“å¤§å°</h4>
<p>ä½¿ç”¨ <code>git count-objects</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹ä»“åº“çš„æ‰“åŒ…å¯¹è±¡æ•°é‡å’Œç£ç›˜å ç”¨æƒ…å†µï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># -v: verbose, æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span>
<span class="hljs-comment"># -H: human-readable, ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºå¤§å°</span>
git count-objects -v -H
</code></pre>
<h4 data-id="heading-4">2. æŸ¥æ‰¾ Packfile ä¸­æœ€å¤§çš„å¯¹è±¡</h4>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>git verify-pack</code> å‘½ä»¤æŸ¥çœ‹ packfile ä¸­çš„å¯¹è±¡è¯¦æƒ…ï¼Œå¹¶æŒ‰å¤§å°æ’åºæ‰¾å‡ºæœ€å¤§çš„å‡ ä¸ª blob å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ .git/objects/pack/ ä¸‹çš„ .idx æ–‡ä»¶</span>
<span class="hljs-comment"># sort -rn -k 3: æŒ‰ç¬¬3åˆ—ï¼ˆsizeï¼‰å€’åºæ’åˆ—</span>
<span class="hljs-comment"># head -10: å–å‰10ä¸ª</span>
git verify-pack -v .git/objects/pack/*.idx | <span class="hljs-built_in">sort</span> -rn -k 3 | <span class="hljs-built_in">head</span> -10
</code></pre>
<p>è¾“å‡ºç»“æœæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text"># SHA-1 (Blob ID) | type | size | size-in-packfile | offset-in-packfile
9704d6e7c732b07418ffe2c0dd2c2030d0cd5a2e blob   2621847 2622645 235218
2bdb752d86091c343f2f4d3af88f038f6b4c2846 blob   2212925 868876 2918139
...
</code></pre>
<h4 data-id="heading-5">3. å®šä½å…·ä½“æ–‡ä»¶è·¯å¾„</h4>
<p>æ‹¿åˆ° Blob ID åï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒå¯¹åº”çš„æ˜¯å“ªä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ <code>git rev-list</code> é…åˆ <code>grep</code> å¯ä»¥æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶åï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›¿æ¢ &lt;blob id&gt; ä¸ºä¸Šé¢æŸ¥åˆ°çš„ SHA-1</span>
git rev-list --objects --all | grep 2bdb752d86091c343f2f4d3af88f038f6b4c2846
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">2bdb752d86091c343f2f4d3af88f038f6b4c2846 .yarn/cache/playwright-core-npm-1.55.0-1c6d3fab0f-843376a8e2.zip
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°äº†ç½ªé­ç¥¸é¦–ï¼Œä¾‹å¦‚ä¸Šé¢çš„ <code>yarn/cache/playwright-core-npm-1.55.0-1c6d3fab0f-843376a8e2.zip</code>ã€‚</p>
<h3 data-id="heading-6">ç¬¬äºŒæ­¥ï¼šåˆ†æé—®é¢˜</h3>
<p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å‘ç° <code>.yarn/cache/</code> ç›®å½•ä¸‹çš„ zip æ–‡ä»¶å ç”¨äº†å¤§é‡ç©ºé—´ã€‚</p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š
åœ¨ä½¿ç”¨ Yarn 2+ (Berry) ç‰ˆæœ¬æ—¶ï¼Œé»˜è®¤ä¼šå°†ä¾èµ–ä»¥ zip å½¢å¼å­˜å‚¨ã€‚å¦‚æœé¡¹ç›®æ²¡æœ‰æ­£ç¡®é…ç½® <code>.gitignore</code>ï¼Œæˆ–è€…å¼€å‘è€…è¯¯æ“ä½œï¼Œå°±å®¹æ˜“å°† <code>.yarn/cache</code> ç›®å½•æäº¤åˆ° Git ä»“åº“ä¸­ã€‚è¿™äº›äºŒè¿›åˆ¶ç¼“å­˜æ–‡ä»¶ä¸ä»…ä½“ç§¯å¤§ï¼Œè€Œä¸”å˜åŠ¨é¢‘ç¹ï¼Œæ˜¯å¯¼è‡´ Git ä»“åº“è†¨èƒ€çš„å¸¸è§åŸå› ã€‚</p>
<p><strong>Yarn 2+ çš„ <code>.gitignore</code> æœ€ä½³å®è·µ</strong>ï¼š</p>
<p>æ ¹æ® Yarn å®˜æ–¹æ–‡æ¡£ï¼Œå¯¹äºå¤§å¤šæ•°é Zero-Installs çš„é¡¹ç›®ï¼Œæˆ‘ä»¬åº”è¯¥å¿½ç•¥ä»¥ä¸‹ç›®å½•ï¼š</p>
<pre><code class="hljs language-gitignore" lang="gitignore"># Yarn 2+
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/sdks
!.yarn/versions

# å…³é”®ï¼šå¿½ç•¥ç¼“å­˜ç›®å½•
.yarn/cache

# å¿½ç•¥æ„å»ºçŠ¶æ€å’Œå®‰è£…çŠ¶æ€
.yarn/build-state.yml
.yarn/install-state.gz

# PnP ç›¸å…³
.pnp.*
</code></pre>
<p>æ—¢ç„¶æ‰¾åˆ°äº†é—®é¢˜æ ¹æºæ˜¯è¯¯æäº¤äº† <code>.yarn/cache</code>ï¼Œæ¥ä¸‹æ¥çš„ç›®æ ‡å°±æ˜¯å°†å…¶ä»å†å²è®°å½•ä¸­å½»åº•æ¸…é™¤ã€‚</p>
<h3 data-id="heading-7">ç¬¬ä¸‰æ­¥ï¼šæ¸…ç†å¤§æ–‡ä»¶</h3>
<p>æ‰¾åˆ°å¤§æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä»æ‰€æœ‰å†å²è®°å½•ä¸­å½»åº•ç§»é™¤ã€‚è¿™é‡Œæ¨èä½¿ç”¨ <strong>BFG Repo-Cleaner</strong>ï¼Œå®ƒæ¯”åŸç”Ÿçš„ <code>git filter-branch</code> æ›´å¿«ã€æ›´ç®€å•ã€‚</p>
<h4 data-id="heading-8">ä½¿ç”¨ BFG Repo-Cleaner</h4>
<blockquote>
<p>[!info] BFG Repo-Cleaner
BFG æ˜¯ä¸€ä¸ªç”¨ Scala ç¼–å†™çš„å·¥å…·ï¼Œä¸“é—¨ç”¨äºå¿«é€Ÿæ¸…ç† Git ä»“åº“ä¸­çš„å¤§æ–‡ä»¶æˆ–éšç§ä¿¡æ¯ã€‚
å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frtyley.github.io%2Fbfg-repo-cleaner%2F" target="_blank" title="https://rtyley.github.io/bfg-repo-cleaner/" ref="nofollow noopener noreferrer">rtyley.github.io/bfg-repo-clâ€¦</a></p>
</blockquote>
<h5 data-id="heading-9">1. ä¸‹è½½å¹¶è¿è¡Œ</h5>
<p>BFG æä¾›äº†ä¸€ä¸ª <code>.jar</code> åŒ…ï¼Œéœ€è¦å®‰è£… Java ç¯å¢ƒè¿è¡Œã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ bfg-1.14.0.jar åï¼Œåœ¨ä»“åº“ç›®å½•çš„ä¸Šä¸€çº§è¿è¡Œ</span>
<span class="hljs-comment"># my-repo ä¸ºä½ çš„ä»“åº“ç›®å½•åç§°</span>

<span class="hljs-comment"># æ–¹å¼ä¸€ï¼šç§»é™¤è¶…è¿‡æŒ‡å®šå¤§å°çš„æ–‡ä»¶ (ä¾‹å¦‚ 1M)</span>
java -jar bfg-1.14.0.jar --strip-blobs-bigger-than 1M my-repo

<span class="hljs-comment"># æ–¹å¼äºŒï¼šç§»é™¤æŒ‡å®šåç§°çš„æ–‡ä»¶ (æ”¯æŒ glob æ¨¡å¼)</span>
java -jar bfg-1.14.0.jar --delete-files <span class="hljs-string">'*.{zip,jar,exe}'</span> my-repo

<span class="hljs-comment"># æ–¹å¼ä¸‰ï¼šç§»é™¤æŒ‡å®šæ–‡ä»¶å¤¹</span>
java -jar bfg-1.14.0.jar --delete-folders <span class="hljs-string">'.svn'</span> my-repo
</code></pre>
<p>å¸¸ç”¨å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>-b, --strip-blobs-bigger-than &lt;size&gt;</code>: ç§»é™¤è¶…è¿‡æŒ‡å®šå¤§å°çš„ blobã€‚</li>
<li><code>-B, --strip-biggest-blobs NUM</code>: ç§»é™¤æœ€å¤§çš„å‰ NUM ä¸ª blobã€‚</li>
<li><code>-D, --delete-files &lt;glob&gt;</code>: æŒ‰æ–‡ä»¶åç§»é™¤æ–‡ä»¶ã€‚</li>
<li><code>--delete-folders &lt;glob&gt;</code>: æŒ‰æ–‡ä»¶å¤¹åç§»é™¤æ–‡ä»¶å¤¹ã€‚</li>
<li><code>--no-blob-protection</code>: å…è®¸ä¿®æ”¹æœ€æ–°æäº¤ï¼ˆé»˜è®¤æƒ…å†µä¸‹ BFG ä¼šä¿æŠ¤æœ€æ–°çš„ä¸€æ¬¡ commit ä¸è¢«ä¿®æ”¹ï¼Œä»¥é˜²è¯¯åˆ ï¼‰ã€‚</li>
</ul>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤åˆ é™¤ <code>.yarn/cache</code> ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">java -jar bfg-1.14.0.jar --delete-folders <span class="hljs-string">'.yarn/cache'</span> my-repo
</code></pre>
<h5 data-id="heading-10">2. ç‰©ç†åˆ é™¤ä¸åƒåœ¾å›æ”¶</h5>
<p>BFG åªæ˜¯æ›´æ–°äº† Git çš„å¼•ç”¨ï¼ˆrefsï¼‰å’Œå†å²è®°å½•ï¼Œå¹¶æ²¡æœ‰çœŸæ­£ç‰©ç†åˆ é™¤ç£ç›˜ä¸Šçš„å¯¹è±¡ã€‚æˆ‘ä»¬éœ€è¦è¿è¡Œ Git çš„åƒåœ¾å›æ”¶å‘½ä»¤æ¥å½»åº•é‡Šæ”¾ç©ºé—´ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼ºåˆ¶è¿‡æœŸæ‰€æœ‰ reflogï¼Œå¹¶æ‰§è¡Œåƒåœ¾å›æ”¶</span>
git reflog expire --expire=now --all &amp;&amp; git gc --prune=now --aggressive
</code></pre>
<p>æ‰§è¡Œå®Œä¸Šè¿°æ­¥éª¤åï¼Œå†æ¬¡æ£€æŸ¥ä»“åº“å¤§å°ï¼Œåº”è¯¥ä¼šå‘ç°ä½“ç§¯æ˜æ˜¾å‡å°ã€‚æœ€åï¼Œéœ€è¦<strong>å¼ºåˆ¶</strong>æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git push origin --force --all
</code></pre>
<blockquote>
<p>[!warning] è­¦å‘Š
è¿™æ˜¯ä¸€ä¸ªç ´åæ€§æ“ä½œï¼Œä¼šé‡å†™ Git å†å²ã€‚åœ¨æ‰§è¡Œä¹‹å‰ï¼Œè¯·åŠ¡å¿…<strong>å¤‡ä»½</strong>ä½ çš„ä»“åº“ï¼
æ­¤å¤–ï¼Œå¼ºåˆ¶æ¨é€åï¼Œå…¶ä»–åä½œè€…éœ€è¦é‡æ–° clone ä»“åº“æˆ–è¿›è¡Œ rebase æ“ä½œã€‚</p>
</blockquote>
<h3 data-id="heading-11">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2Fbook%2Fen%2Fv2%2FGit-Internals-Maintenance-and-Data-Recovery" target="_blank" title="https://git-scm.com/book/en/v2/Git-Internals-Maintenance-and-Data-Recovery" ref="nofollow noopener noreferrer">Git - Maintenance and Data Recovery</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Frtyley.github.io%2Fbfg-repo-cleaner%2F" target="_blank" title="https://rtyley.github.io/bfg-repo-cleaner/" ref="nofollow noopener noreferrer">BFG Repo-Cleaner</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F18F%2FC2%2Fissues%2F439" target="_blank" title="https://github.com/18F/C2/issues/439" ref="nofollow noopener noreferrer">GitHub Issue: Reduce git repository size</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain v1 é‡å¤§æ›´æ–°è®²è§£âš âš âš ]]></title>    <link>https://juejin.cn/post/7575050949958746148</link>    <guid>https://juejin.cn/post/7575050949958746148</guid>    <pubDate>2025-11-21T17:44:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575050949958746148" data-draft-id="7575021014032678931" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain v1 é‡å¤§æ›´æ–°è®²è§£âš âš âš "/> <meta itemprop="keywords" content="LangChain,Python,Agent"/> <meta itemprop="datePublished" content="2025-11-21T17:44:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´ä½³æµ©"/> <meta itemprop="url" content="https://juejin.cn/user/2696441245481975"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain v1 é‡å¤§æ›´æ–°è®²è§£âš âš âš 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2696441245481975/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´ä½³æµ©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-21T17:44:36.000Z" title="Fri Nov 21 2025 17:44:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">LangChain v1 é‡å¤§æ›´æ–°è®²è§£</h2>
<blockquote>
<p>ä¸ºä»€ä¹ˆæ²¡æœ‰å…ˆå‘å¸ƒdemoæ•™å­¦è€Œæ˜¯å…ˆå‘å¸ƒä¸€ä¸ªä»€ä¹ˆé‡å¤§æ›´æ–°</p>
<p>å› ä¸ºlangchainæ›´æ–°äº†ï¼Œæ›´æ–°è¿˜æŒºå¤šçš„æ‰€ä»¥å»ºè®®å¤§å®¶è¿˜æ˜¯ä»æ–°ç‰ˆæœ¬å¼€å§‹å­¦ä¹ </p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2a3016eef8c4ab0933e83e98f1dd875~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764351876&amp;x-signature=Ni9%2BXYxzHe7feYf8ZfLFx6ldvXM%3D" alt="äººå·¥æ™ºèƒ½çš„æ— é™å¯èƒ½.png" loading="lazy"/></p>
<p><strong>ä½œè€…</strong>ï¼šå´ä½³æµ©</p>
<p><strong>æœ€åæ›´æ–°</strong>ï¼š2025-11-22</p>
<p><strong>é€‚ç”¨ç‰ˆæœ¬</strong>ï¼šLangChain v1.0+</p>
<h3 data-id="heading-1">ç›®å½•</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25B8%2580langchain-v1-%25E4%25B8%25BA%25E4%25BB%2580%25E4%25B9%2588%25E6%2598%25AF%25E4%25B8%2580%25E6%25AC%25A1%25E5%25A4%25A7%25E7%2589%2588%25E6%259C%25AC%25E9%259D%25A9%25E5%2591%25BD" target="_blank" title="https://www.google.com/search?q=%23-%E4%B8%80langchain-v1-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%80%E6%AC%A1%E5%A4%A7%E7%89%88%E6%9C%AC%E9%9D%A9%E5%91%BD" ref="nofollow noopener noreferrer">ğŸ“Œ ä¸€ã€LangChain v1 ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡â€œå¤§ç‰ˆæœ¬é©å‘½â€ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25BA%258Cv01--v10%25E5%25B7%25AE%25E5%25BC%2582%25E5%25AF%25B9%25E7%2585%25A7%25E8%25A1%25A8%25E6%25A0%25B8%25E5%25BF%2583%25E5%25BF%2585%25E8%25AF%25BB" target="_blank" title="https://www.google.com/search?q=%23-%E4%BA%8Cv01--v10%E5%B7%AE%E5%BC%82%E5%AF%B9%E7%85%A7%E8%A1%A8%E6%A0%B8%E5%BF%83%E5%BF%85%E8%AF%BB" ref="nofollow noopener noreferrer">ğŸš€ äºŒã€v0.1 â†’ v1.0ï¼šå·®å¼‚å¯¹ç…§è¡¨ï¼ˆæ ¸å¿ƒå¿…è¯»ï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25B8%2589langchain-v1-%25E6%259E%25B6%25E6%259E%2584%25E6%2580%25BB%25E8%25A7%2588" target="_blank" title="https://www.google.com/search?q=%23-%E4%B8%89langchain-v1-%E6%9E%B6%E6%9E%84%E6%80%BB%E8%A7%88" ref="nofollow noopener noreferrer">ğŸ§± ä¸‰ã€LangChain v1 æ¶æ„æ€»è§ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%259B%259Bcreate_agent%25E5%2585%25A8%25E6%2596%25B0%25E7%259A%2584-agent-%25E5%2588%259B%25E5%25BB%25BA%25E6%2596%25B9%25E5%25BC%258F" target="_blank" title="https://www.google.com/search?q=%23-%E5%9B%9Bcreate_agent%E5%85%A8%E6%96%B0%E7%9A%84-agent-%E5%88%9B%E5%BB%BA%E6%96%B9%E5%BC%8F" ref="nofollow noopener noreferrer">ğŸ§° å››ã€create_agentï¼šå…¨æ–°çš„ Agent åˆ›å»ºæ–¹å¼</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25BA%2594middleware%25E6%25A0%25B8%25E5%25BF%2583%25E6%2589%25A9%25E5%25B1%2595%25E6%259C%25BA%25E5%2588%25B6%25E6%25B4%258B%25E8%2591%25B1%25E6%25A8%25A1%25E5%259E%258B" target="_blank" title="https://www.google.com/search?q=%23-%E4%BA%94middleware%E6%A0%B8%E5%BF%83%E6%89%A9%E5%B1%95%E6%9C%BA%E5%88%B6%E6%B4%8B%E8%91%B1%E6%A8%A1%E5%9E%8B" ref="nofollow noopener noreferrer">ğŸ”§ äº”ã€Middlewareï¼šæ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼ˆæ´‹è‘±æ¨¡å‹ï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%2585%25ADcontent_blocks%25E8%25B7%25A8%25E6%25A8%25A1%25E5%259E%258B%25E7%25BB%259F%25E4%25B8%2580%25E8%25BE%2593%25E5%2587%25BA" target="_blank" title="https://www.google.com/search?q=%23-%E5%85%ADcontent_blocks%E8%B7%A8%E6%A8%A1%E5%9E%8B%E7%BB%9F%E4%B8%80%E8%BE%93%E5%87%BA" ref="nofollow noopener noreferrer">ğŸ“¦ å…­ã€content_blocksï¼šè·¨æ¨¡å‹ç»Ÿä¸€è¾“å‡º</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25B8%2583%25E7%25BB%2593%25E6%259E%2584%25E5%258C%2596%25E8%25BE%2593%25E5%2587%25BAstructured-output" target="_blank" title="https://www.google.com/search?q=%23-%E4%B8%83%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BAstructured-output" ref="nofollow noopener noreferrer">ğŸ“ ä¸ƒã€ç»“æ„åŒ–è¾“å‡ºï¼ˆStructured Outputï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%2585%25AB%25E5%2591%25BD%25E5%2590%258D%25E7%25A9%25BA%25E9%2597%25B4%25E9%2587%258D%25E6%259E%2584--langchain-classic" target="_blank" title="https://www.google.com/search?q=%23-%E5%85%AB%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E9%87%8D%E6%9E%84--langchain-classic" ref="nofollow noopener noreferrer">ğŸ“š å…«ã€å‘½åç©ºé—´é‡æ„ + langchain-classic</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E4%25B9%259Dv0--v1-%25E8%25BF%2581%25E7%25A7%25BB%25E6%258C%2587%25E5%258D%2597%25E5%25AE%259E%25E6%2588%2598%25E7%2589%2588" target="_blank" title="https://www.google.com/search?q=%23-%E4%B9%9Dv0--v1-%E8%BF%81%E7%A7%BB%E6%8C%87%E5%8D%97%E5%AE%9E%E6%88%98%E7%89%88" ref="nofollow noopener noreferrer">ğŸ›  ä¹ã€v0 â†’ v1 è¿ç§»æŒ‡å—ï¼ˆå®æˆ˜ç‰ˆï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%258D%2581%25E6%258E%25A8%25E8%258D%2590%25E7%259A%2584%25E7%2594%259F%25E4%25BA%25A7%25E7%25BA%25A7%25E9%25A1%25B9%25E7%259B%25AE%25E7%25BB%2593%25E6%259E%2584%25E5%259B%25BE" target="_blank" title="https://www.google.com/search?q=%23-%E5%8D%81%E6%8E%A8%E8%8D%90%E7%9A%84%E7%94%9F%E4%BA%A7%E7%BA%A7%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E5%9B%BE" ref="nofollow noopener noreferrer">ğŸ— åã€æ¨èçš„ç”Ÿäº§çº§é¡¹ç›®ç»“æ„å›¾</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%258D%2581%25E4%25B8%2580%25E7%259C%259F%25E5%25AE%259E%25E4%25BC%2581%25E4%25B8%259A%25E7%25BA%25A7%25E6%25A1%2588%25E4%25BE%258B%25E5%25A4%259A%25E6%25AD%25A5%25E9%25AA%25A4%25E4%25BB%25BB%25E5%258A%25A1-agent" target="_blank" title="https://www.google.com/search?q=%23-%E5%8D%81%E4%B8%80%E7%9C%9F%E5%AE%9E%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%A1%88%E4%BE%8B%E5%A4%9A%E6%AD%A5%E9%AA%A4%E4%BB%BB%E5%8A%A1-agent" ref="nofollow noopener noreferrer">ğŸ§ª åä¸€ã€çœŸå®ä¼ä¸šçº§æ¡ˆä¾‹ï¼šå¤šæ­¥éª¤ä»»åŠ¡ Agent</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%258D%2581%25E4%25BA%258C%25E5%258F%25AF%25E8%25BF%2590%25E8%25A1%258C%25E7%25BB%25BC%25E5%2590%2588%25E7%25A4%25BA%25E4%25BE%258B%25E4%25BB%25A3%25E7%25A0%2581" target="_blank" title="https://www.google.com/search?q=%23-%E5%8D%81%E4%BA%8C%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" ref="nofollow noopener noreferrer">ğŸ“„ åäºŒã€å¯è¿è¡Œç»¼åˆç¤ºä¾‹ä»£ç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%2523-%25E5%258D%2581%25E4%25B8%2589%25E6%2580%25BB%25E7%25BB%2593" target="_blank" title="https://www.google.com/search?q=%23-%E5%8D%81%E4%B8%89%E6%80%BB%E7%BB%93" ref="nofollow noopener noreferrer">ğŸ“ åä¸‰ã€æ€»ç»“</a></li>
</ul>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3c0946c7f754c509c415ec7c41395e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764351876&amp;x-signature=%2BwOZ4LEjJgMGSln38CEuIWgLku4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">0. ç¯å¢ƒå‡†å¤‡</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ Python ç‰ˆæœ¬ <strong>â‰¥ 3.9</strong>ï¼Œå¹¶å®‰è£…ä»¥ä¸‹æ ¸å¿ƒåŒ…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… v1 æ ¸å¿ƒåŒ…ã€ç»å…¸å…¼å®¹åŒ…å’Œå›¾è¿è¡Œæ—¶</span>
pip install -U langchain langchain-classic langgraph

<span class="hljs-comment"># å®‰è£…é€‚é…çš„æ¨¡å‹æä¾›å•†åŒ… (ä»¥ OpenAI ä¸ºä¾‹)</span>
pip install -U langchain-openai
</code></pre>
<hr/>
<h3 data-id="heading-3">ä¸€ã€LangChain v1 ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡â€œå¤§ç‰ˆæœ¬é©å‘½â€ï¼Ÿ</h3>
<p>LangChain v1 ä¸å†ä»…ä»…æ˜¯ä¸€ä¸ªâ€œLLM è°ƒç”¨å·¥å…·ç®±â€ï¼Œè€Œæ˜¯æ­£å¼è½¬å‘<strong>æ„å»ºç”Ÿäº§çº§ Agent ç³»ç»Ÿçš„å·¥ç¨‹æ¡†æ¶</strong>ã€‚</p>
<p><strong>æ ¸å¿ƒå˜åŒ–åŒ…æ‹¬ï¼š</strong></p>
<ol>
<li><strong><code>create_agent</code></strong>ï¼šæ­£å¼æˆä¸º Agent çš„æ ‡å‡†æ„å»ºæ–¹å¼ï¼ˆåº•å±‚åŸºäº LangGraphï¼‰ã€‚</li>
<li><strong>Middleware (ä¸­é—´ä»¶)</strong>ï¼šå…è®¸åœ¨ä»»æ„é˜¶æ®µï¼ˆæ¨¡å‹è°ƒç”¨å‰ã€å·¥å…·æ‰§è¡Œæ—¶ã€è¾“å‡ºåï¼‰æ‹¦æˆªå¹¶ä¿®æ”¹é€»è¾‘ã€‚</li>
<li><strong><code>content_blocks</code></strong>ï¼šæ‰€æœ‰æ¨¡å‹è¾“å‡ºï¼ˆæ¨ç†/æ–‡æœ¬/å·¥å…·è°ƒç”¨ï¼‰ç»Ÿä¸€ä¸ºæ ‡å‡†æ ¼å¼ï¼Œä¸å†ä¾èµ–æ­£åˆ™è§£æã€‚</li>
<li><strong>ç»“æ„åŒ–è¾“å‡º</strong>ï¼šPydantic Schema æˆä¸ºä¸€ç­‰å…¬æ°‘ï¼Œæå¤§æå‡ç¨³å®šæ€§ã€‚</li>
<li><strong>å‘½åç©ºé—´æ‹†åˆ†</strong>ï¼šæ—§ APIï¼ˆå¦‚ Chainsï¼‰å…¨éƒ¨è¿å…¥ <code>langchain-classic</code>ï¼Œä¸»åŒ…åªä¿ç•™ Agent æ ¸å¿ƒã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-4">äºŒã€v0.1 â†’ v1.0ï¼šå·®å¼‚å¯¹ç…§è¡¨ï¼ˆæ ¸å¿ƒå¿…è¯»ï¼‰</h3>
<p>è¿™æ˜¯ç†è§£ v1 æœ€é‡è¦çš„ä¸€å¼ è¡¨ï¼Œå±•ç¤ºäº†ä»â€œè„šæœ¬æ€ç»´â€åˆ°â€œå·¥ç¨‹æ€ç»´â€çš„è½¬å˜ã€‚</p>

































































<table><thead><tr><th><strong>é¡¹ç›®</strong></th><th><strong>LangChain v0.x (æ—§ç‰ˆ)</strong></th><th><strong>LangChain v1.0 (æ–°ç‰ˆ)</strong></th><th><strong>æ ¸å¿ƒå·®å¼‚</strong></th></tr></thead><tbody><tr><td><strong>ä¸­å¿ƒæ€æƒ³</strong></td><td>Chains (é“¾å¼è°ƒç”¨)</td><td><strong>Agents (æ™ºèƒ½ä½“)</strong></td><td>ä»çº¿æ€§æ‰§è¡Œè½¬å‘å¾ªç¯å›¾æ‰§è¡Œ (Graph)</td></tr><tr><td><strong>æ„å»ºå…¥å£</strong></td><td><code>initialize_agent</code></td><td><strong><code>create_agent</code></strong></td><td>ç»Ÿä¸€çš„æ–°æ ‡å‡†æ¥å£</td></tr><tr><td><strong>åº•å±‚å¼•æ“</strong></td><td><code>AgentExecutor</code> (ç¡¬ç¼–ç å¾ªç¯)</td><td><strong>LangGraph</strong></td><td>æ”¯æŒæŒä¹…åŒ–ã€æµå¼ã€åˆ†æ”¯ã€å¾ªç¯çš„å›¾è¿è¡Œæ—¶</td></tr><tr><td><strong>æµå¼èƒ½åŠ›</strong></td><td>éƒ¨åˆ†æ”¯æŒ (Tokençº§)</td><td><strong>å…¨é“¾è·¯æµå¼</strong></td><td>æ”¯æŒ Tokenã€ä¸­é—´æ­¥éª¤ã€æ¨ç†è¿‡ç¨‹çš„å®æ—¶æµ</td></tr><tr><td><strong>æ‰©å±•æœºåˆ¶</strong></td><td>æ—  (éœ€ä¿®æ”¹æºç æˆ–Prompt)</td><td><strong>Middleware</strong></td><td>å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸé’©å­ (Hooks)</td></tr><tr><td><strong>å·¥å…·å®šä¹‰</strong></td><td><code>Tool</code> + <code>func</code></td><td><code>Tool</code> + <strong>Pydantic Schema</strong></td><td>ç±»å‹æ›´å®‰å…¨ï¼Œå‚æ•°å®šä¹‰æ›´æ¸…æ™°</td></tr><tr><td><strong>ç»“æ„åŒ–è¾“å‡º</strong></td><td>JSON Parser + Regex</td><td><strong>Structured Output</strong></td><td>ç›´æ¥ç»‘å®š Pydantic ç±»ï¼Œç”±æ¨¡å‹åº•å±‚ä¿è¯æ ¼å¼</td></tr><tr><td><strong>è¾“å‡ºè§£æ</strong></td><td>çº¯æ–‡æœ¬ + æ­£åˆ™åŒ¹é…</td><td><strong><code>content_blocks</code></strong></td><td>æ ‡å‡†åŒ–å¯¹è±¡ (æ¨ç†å—ã€æ–‡æœ¬å—ã€å·¥å…·å—)</td></tr><tr><td><strong>åŒ…ç®¡ç†</strong></td><td><code>langchain.*</code></td><td><strong><code>langchain-classic</code></strong></td><td>æ—§åŠŸèƒ½ç§»è‡³ classic åŒ…ï¼Œä¿æŒä¸»åŒ…è½»é‡</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€LangChain v1 æ¶æ„æ€»è§ˆ</h3>
<blockquote>
<p><strong>ğŸ’¡ æ ¸å¿ƒæç¤º</strong>ï¼šLangChain v1 çš„åº•å±‚å¼•æ“å®é™…ä¸Šæ˜¯ <strong>LangGraph</strong>ã€‚<code>create_agent</code> æœ¬è´¨ä¸Šæ˜¯ä¸ºä½ é¢„æ„å»ºäº†ä¸€ä¸ªæ ‡å‡†çš„ LangGraph å›¾ã€‚</p>
</blockquote>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    subgraph AgentRuntime ["LangGraph è¿è¡Œæ—¶"]
        direction TB
        A["ç”¨æˆ·è¾“å…¥ (Messages)"] --&gt; B[" æ¨¡å‹æ¨ç† (LLM)"]
        B --&gt; C{"å†³ç­–èŠ‚ç‚¹"}
        C --&gt;|éœ€è¦å·¥å…·| D[" å·¥å…·æ‰§è¡Œ (Tool Execution)"]
        D --&gt; E[" å·¥å…·ç»“æœåé¦ˆ"]
        E --&gt; B
        C --&gt;|æ— éœ€å·¥å…·/ç»“æŸ| F[" ç”Ÿæˆæœ€ç»ˆå›ç­”"]
    end
    
    style A fill:#e1f5fe,stroke:#01579b
    style B fill:#fff9c4,stroke:#fbc02d
    style D fill:#e8f5e9,stroke:#2e7d32
</code></pre>
<hr/>
<h3 data-id="heading-6">å››ã€create_agentï¼šå…¨æ–°çš„ Agent åˆ›å»ºæ–¹å¼</h3>
<p>ä¸ºä»€ä¹ˆåºŸå¼ƒ initialize_agentï¼Ÿ</p>
<p>å› ä¸º v1 ç»Ÿä¸€ä½¿ç”¨å›¾æ¶æ„ï¼ˆGraph Architectureï¼‰ã€‚æ‰€æœ‰çš„ Agent æœ¬è´¨ä¸Šéƒ½æ˜¯ï¼šæ¨ç† â†’ å·¥å…· â†’ å†æ¨ç† çš„å¾ªç¯ã€‚create_agent æ˜¯è¿™ä¸ªæ ‡å‡†å¾ªç¯çš„å·¥å‚å‡½æ•°ã€‚</p>
<p><strong>åŸºæœ¬ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># 1. å®šä¹‰æ¨¡å‹</span>
model = ChatOpenAI(model=<span class="hljs-string">"gpt-4o"</span>)

<span class="hljs-comment"># 2. åˆ›å»º Agent</span>
agent = create_agent(
    model=model,
    tools=[search_tool, calculator_tool],
    system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„é‡‘èåˆ†æå¸ˆã€‚"</span>
)

<span class="hljs-comment"># 3. è¿è¡Œ (Invoke)</span>
result = agent.invoke({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"åˆ†æ AAPL è‚¡ä»·"</span>}]})
</code></pre>
<hr/>
<h3 data-id="heading-7">äº”ã€Middlewareï¼šæ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼ˆæ´‹è‘±æ¨¡å‹ï¼‰</h3>
<p>ä¸­é—´ä»¶æ˜¯ v1 æœ€å¼ºå¤§çš„åŠŸèƒ½ï¼Œå…è®¸ä½ åœ¨ Agent ç”Ÿå‘½å‘¨æœŸçš„ä»»æ„èŠ‚ç‚¹æ’å…¥é€»è¾‘ï¼ˆå¦‚é‰´æƒã€æ—¥å¿—ã€è·¯ç”±ï¼‰ã€‚</p>
<p><strong>ç”Ÿå‘½å‘¨æœŸæ—¶åºå›¾ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User
    participant MW as Middleware (ä¸­é—´ä»¶å±‚)
    participant Agent as Agent Runtime
    participant Model as LLM

    User-&gt;&gt;Agent: invoke(input)
    Agent-&gt;&gt;MW: 1. before_agent_start
    MW--&gt;&gt;Agent: (æ¸…æ´—åçš„è¾“å…¥)

    loop æ€è€ƒä¸æ‰§è¡Œå¾ªç¯
        Agent-&gt;&gt;MW: 2. before_model
        Note right of MW: åŠ¨æ€ä¿®æ”¹ Prompt / è·¯ç”±æ¨¡å‹
        
        rect rgb(240,240,240)
            MW-&gt;&gt;Model: 3. wrap_model_call
            Model--&gt;&gt;MW: è¿”å›åŸå§‹ç»“æœ
        end
        
        MW--&gt;&gt;Agent: 4. after_model (æ ¡éªŒè¾“å‡º)

        opt å·¥å…·è°ƒç”¨
            Agent-&gt;&gt;MW: 5. wrap_tool_call
            Note right of MW: æ•æ„Ÿæ“ä½œå®¡æ‰¹ / å®¡è®¡
            MW--&gt;&gt;Agent: å·¥å…·ç»“æœ
        end
    end

    Agent-&gt;&gt;MW: 6. after_agent
    MW--&gt;&gt;User: æœ€ç»ˆå“åº”
</code></pre>
<hr/>
<h3 data-id="heading-8">å…­ã€content_blocksï¼šè·¨æ¨¡å‹ç»Ÿä¸€è¾“å‡º</h3>
<p>è§£å†³â€œä¸åŒæ¨¡å‹è¿”å›æ ¼å¼ä¸åŒâ€çš„ç—›ç‚¹ã€‚</p>
<p>æ¨¡å‹è¾“å‡ºç°åœ¨åŒ…å«ç»Ÿä¸€çš„ .content_blocks å±æ€§ï¼š</p>
<ul>
<li><code>reasoning</code>: æ¨¡å‹çš„æ€è€ƒè¿‡ç¨‹ï¼ˆå¦‚ Chain of Thoughtï¼‰ã€‚</li>
<li><code>tool_call</code>: ç»“æ„åŒ–çš„å·¥å…·è°ƒç”¨è¯·æ±‚ã€‚</li>
<li><code>text</code>: æœ€ç»ˆå›å¤æ–‡æœ¬ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">ä¸ƒã€ç»“æ„åŒ–è¾“å‡ºï¼ˆStructured Outputï¼‰</h3>
<p>v1 æ¨èä½¿ç”¨ <strong>Pydantic Schema</strong> æ¥å¼ºåˆ¶æ¨¡å‹è¾“å‡ºç‰¹å®šæ ¼å¼ï¼Œè€Œä¸æ˜¯åœ¨ Prompt é‡Œå†™â€œè¯·è¿”å› JSONâ€ã€‚</p>
<p><strong>ä¸‰ç§ç­–ç•¥ï¼š</strong></p>
<ol>
<li><strong>SchemaBasedStructurer</strong> (æ¨è)ï¼šç›´æ¥ä¼ å…¥ Pydantic ç±»ã€‚</li>
<li><strong>ToolStrategy</strong>ï¼šåˆ©ç”¨ Tool Calling æœºåˆ¶è¾“å‡ºç»“æ„ã€‚</li>
<li><strong>ProviderStrategy</strong>ï¼šåˆ©ç”¨æ¨¡å‹åŸç”Ÿ JSON Modeï¼ˆå¦‚ OpenAI JSON Objectï¼‰ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-10">å…«ã€å‘½åç©ºé—´é‡æ„ + langchain-classic</h3>
<p>ä¸ºäº†ç»™ Agent è®©è·¯ï¼Œæ—§çš„â€œé“¾å¼â€ç»„ä»¶è¢«ç§»å…¥ <code>classic</code> åŒ…ã€‚</p>
<p><strong>è¿ç§»å¯¹ç…§ï¼š</strong></p>

























<table><thead><tr><th><strong>ç»„ä»¶</strong></th><th><strong>æ—§å¼•å…¥æ–¹å¼</strong></th><th><strong>v1 æ–°å¼•å…¥æ–¹å¼</strong></th></tr></thead><tbody><tr><td><strong>Memory</strong></td><td><code>from langchain.memory import ...</code></td><td><code>from langchain_classic.memory import ...</code></td></tr><tr><td><strong>Chains</strong></td><td><code>from langchain.chains import ...</code></td><td><code>from langchain_classic.chains import ...</code></td></tr><tr><td><strong>Retrievers</strong></td><td><code>from langchain.retrievers import ...</code></td><td><code>from langchain_classic.retrievers import ...</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-11">ğŸ›  ä¹ã€v0 â†’ v1 è¿ç§»æŒ‡å—ï¼ˆå®æˆ˜ç‰ˆï¼‰</h3>
<h4 data-id="heading-12">1. ConversationChain â†’ create_agent</h4>
<ul>
<li>
<p>âŒ <strong>æ—§ (v0)</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> ConversationChain
chain = ConversationChain(llm=llm)
chain.run(<span class="hljs-string">"Hi"</span>)
</code></pre>
</li>
<li>
<p>âœ” <strong>æ–° (v1)</strong>ï¼š</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-comment"># create_agent è‡ªå¸¦è®°å¿†ç®¡ç† (é€šè¿‡ LangGraph checkpoint)</span>
agent = create_agent(model=llm, tools=[])
agent.invoke({<span class="hljs-string">"messages"</span>: [...]})
</code></pre>
</li>
</ul>
<h4 data-id="heading-13">2. LLMChain â†’ model.invoke</h4>
<ul>
<li>
<p>âŒ <strong>æ—§ (v0)</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python">chain = LLMChain(prompt=prompt, llm=llm)
chain.run(variable=<span class="hljs-string">"value"</span>)
</code></pre>
</li>
<li>
<p>âœ” <strong>æ–° (v1)</strong>ï¼š</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-comment"># ç›´æ¥ä½¿ç”¨ LCEL (LangChain Expression Language)</span>
chain = prompt | llm
chain.invoke({<span class="hljs-string">"variable"</span>: <span class="hljs-string">"value"</span>})
</code></pre>
</li>
</ul>
<h4 data-id="heading-14">3. Tool å®šä¹‰æ–¹å¼</h4>
<ul>
<li>âŒ <strong>æ—§ (v0)</strong>ï¼šä¾èµ– <code>func</code> å’Œæ–‡æ¡£å­—ç¬¦ä¸²è§£æã€‚</li>
<li>âœ” <strong>æ–° (v1)</strong>ï¼šå¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>@tool</code> è£…é¥°å™¨å¹¶é…åˆ Pydantic ç±»å‹çš„å‚æ•°æ³¨è§£ï¼Œæˆ–è€…ä½¿ç”¨ <code>create_tool(schema=MySchema)</code>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-15">åã€æ¨èçš„ç”Ÿäº§çº§é¡¹ç›®ç»“æ„å›¾</h3>
<p>åœ¨ v1 æ—¶ä»£ï¼Œæ¨èé‡‡ç”¨åˆ†å±‚æ¶æ„æ¥ç®¡ç† Agent é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
  Root[" my_agent_project/"] --&gt; A[" app/"]
  
  A --&gt; B[" agent.py &lt;br/&gt; (create_agent ç»„è£…å…¥å£)"]
  
  A --&gt; C["middleware/ &lt;br/&gt; (ä¸­é—´ä»¶å±‚)"]
  C --&gt; C1[" auth_middleware.py"]
  C --&gt; C2[" risk_control.py"]
  
  A --&gt; D[" schemas/ &lt;br/&gt; (æ•°æ®ç»“æ„)"]
  D --&gt; D1[" user_context.py"]
  D --&gt; D2[" output_schema.py"]
  
  A --&gt; E[" tools/ &lt;br/&gt; (å·¥å…·é›†)"]
  E --&gt; E1[" search_tool.py"]
  E --&gt; E2[" db_tool.py"]
  
  A --&gt; F[" main.py &lt;br/&gt; (FastAPI/Streamlit å…¥å£)"]
</code></pre>
<hr/>
<h3 data-id="heading-16">åä¸€ã€çœŸå®ä¼ä¸šçº§æ¡ˆä¾‹ï¼šå¤šæ­¥éª¤ä»»åŠ¡ Agent</h3>
<p>åœºæ™¯ï¼šè‡ªåŠ¨ä»£ç ä¿®å¤ Agentã€‚</p>
<p>æµç¨‹ï¼šå†™ä»£ç  â†’ è¿è¡Œæµ‹è¯• â†’ å¤±è´¥åˆ™åˆ†ææ—¥å¿— â†’ ä¿®å¤ä»£ç  â†’ å¾ªç¯ç›´è‡³æˆåŠŸã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start(("å¼€å§‹")) --&gt; Gen["ç”Ÿæˆåˆç‰ˆä»£ç "]
    Gen --&gt; Run["ğŸ”§ å·¥å…·: è¿è¡Œä»£ç /æµ‹è¯•"]
    Run --&gt; Check{"æµ‹è¯•é€šè¿‡?"}
    
    Check --&gt;|å¤±è´¥| Debug[" LLM: åˆ†æé”™è¯¯æ—¥å¿—"]
    Debug --&gt; Gen
    
    Check --&gt;|æˆåŠŸ| Output["è¾“å‡ºæœ€ç»ˆä»£ç "]
    Output --&gt; End(("ç»“æŸ"))
</code></pre>
<p><em>è¿™åœ¨ v1 ä¸­é€šè¿‡ <code>create_agent</code> å¤©ç„¶æ”¯æŒï¼Œå› ä¸ºåº•å±‚ Graph æ”¯æŒå¾ªç¯ï¼Œä¸”å¯ä»¥é€šè¿‡ä¸­é—´ä»¶è®°å½•æ¯æ¬¡å°è¯•çš„è¯¦ç»†æ—¥å¿—ã€‚</em></p>
<hr/>
<h3 data-id="heading-17">åäºŒã€å¯è¿è¡Œç»¼åˆç¤ºä¾‹ä»£ç </h3>
<p>è¿™æ˜¯ä¸€ä¸ªåŒ…å«äº† <strong>ä¸­é—´ä»¶ (Middleware)</strong> å’Œ <strong>ç»“æ„åŒ–è¾“å‡º</strong> çš„å®Œæ•´ v1 ç¤ºä¾‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span>, <span class="hljs-type">Dict</span>
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> AgentMiddleware, ModelRequest, ModelResponse

<span class="hljs-comment"># 1. å®šä¹‰å·¥å…·</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"""</span>
    <span class="hljs-comment"># æ¨¡æ‹Ÿ API è¿”å›</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span> å¤©æ°”æ™´æœ—, 25Â°C"</span>

<span class="hljs-comment"># 2. å®šä¹‰ç»“æ„åŒ–è¾“å‡º Schema</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherReport</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    city: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"åŸå¸‚åç§°"</span>)
    temperature: <span class="hljs-built_in">float</span> = Field(description=<span class="hljs-string">"æ¸©åº¦æ•°å€¼"</span>)
    summary: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"ä¸€å¥è¯å¤©æ°”æ€»ç»“"</span>)

<span class="hljs-comment"># 3. å®šä¹‰è‡ªå®šä¹‰ä¸­é—´ä»¶ (ç¤ºä¾‹ï¼šè‡ªåŠ¨æ·»åŠ ç¤¼è²Œç”¨è¯­)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PolitenessMiddleware</span>(<span class="hljs-title class_ inherited__">AgentMiddleware</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrap_model_call</span>(<span class="hljs-params">self, request: ModelRequest, handler</span>) -&gt; ModelResponse:
        <span class="hljs-comment"># åœ¨å‘é€ç»™æ¨¡å‹å‰ï¼Œä¿®æ”¹ System Prompt</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ•µï¸ Middleware: æ­£åœ¨æ³¨å…¥ç¤¼è²ŒæŒ‡ä»¤..."</span>)
        <span class="hljs-keyword">if</span> request.messages:
            last_msg = request.messages[-<span class="hljs-number">1</span>]
            <span class="hljs-keyword">if</span> last_msg.role == <span class="hljs-string">"user"</span>:
                last_msg.content += <span class="hljs-string">" (è¯·ç”¨éå¸¸ç¤¼è²Œçš„è¯­æ°”å›ç­”)"</span>
        <span class="hljs-keyword">return</span> handler(request)

<span class="hljs-comment"># 4. æ„å»º Agent</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    agent = create_agent(
        model=ChatOpenAI(model=<span class="hljs-string">"gpt-4o-mini"</span>),
        tools=[get_weather],
        middleware=[PolitenessMiddleware()],
        <span class="hljs-comment"># å¼ºåˆ¶ç»“æ„åŒ–è¾“å‡º (v1 ç‰¹æ€§)</span>
        <span class="hljs-comment"># response_format=ToolStrategy(WeatherReport) # è‹¥éœ€å¼ºåˆ¶ç»“æ„åŒ–å¯å¼€å¯æ­¤è¡Œ</span>
    )

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸš€ Agent å¯åŠ¨..."</span>)
    result = <span class="hljs-keyword">await</span> agent.ainvoke({
        <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¸®æˆ‘æŸ¥ä¸€ä¸‹åŒ—äº¬çš„å¤©æ°”"</span>}]
    })

    <span class="hljs-comment"># v1 çš„ result åŒ…å«å®Œæ•´çš„æ‰§è¡ŒçŠ¶æ€</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nğŸ’¬ æœ€ç»ˆå›å¤:"</span>)
    <span class="hljs-built_in">print</span>(result[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    asyncio.run(main())
</code></pre>
<hr/>
<h3 data-id="heading-18">åä¸‰ã€æ€»ç»“</h3>
<p>LangChain v1 æ ‡å¿—ç€æˆ‘ä»¬ä» <strong>â€œç©ç¥¨æ€§è´¨çš„ Chainâ€</strong> èµ°å‘äº† <strong>â€œå·¥ç¨‹åŒ–çš„ Agentâ€</strong>ã€‚</p>
<ul>
<li>å¦‚æœä½ éœ€è¦æ„å»ºç®€å•çš„é—®ç­”æœºå™¨äººï¼ŒLangChain v1 æä¾›äº†æ›´ç»Ÿä¸€çš„æ¥å£ã€‚</li>
<li>å¦‚æœä½ éœ€è¦æ„å»ºå¤æ‚çš„ã€å¤šæ­¥æ¨ç†çš„ã€å…·æœ‰è‡ªæˆ‘çº é”™èƒ½åŠ›çš„ä¼ä¸šçº§æ™ºèƒ½ä½“ï¼ŒLangChain v1 (é…åˆ LangGraph) æ˜¯ç›®å‰ Python ç”Ÿæ€ä¸­æœ€ä½³çš„é€‰æ‹©ã€‚</li>
</ul>
<p><strong>ä¸‹ä¸€æ­¥å»ºè®®ï¼š</strong> å®‰è£… <code>langchain-classic</code> ç¡®ä¿æ—§ä»£ç è¿è¡Œï¼ŒåŒæ—¶åœ¨æ–°æ¨¡å—ä¸­å¼€å§‹å°è¯•ä½¿ç”¨ <code>create_agent</code>ã€‚
æ…é‡æ›´æ–°è€é¡¹ç›®ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å´©äº†ã€‚ã€‚ã€‚åˆ«èµ–æˆ‘ã€‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ultraciteï¼šä¸º AI æ—¶ä»£æ‰“é€ çš„é›¶é…ç½®ä»£ç è§„èŒƒå·¥å…·]]></title>    <link>https://juejin.cn/post/7575090551356686388</link>    <guid>https://juejin.cn/post/7575090551356686388</guid>    <pubDate>2025-11-22T10:26:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575090551356686388" data-draft-id="7575090551356670004" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ultraciteï¼šä¸º AI æ—¶ä»£æ‰“é€ çš„é›¶é…ç½®ä»£ç è§„èŒƒå·¥å…·"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,GitHub"/> <meta itemprop="datePublished" content="2025-11-22T10:26:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JinSo"/> <meta itemprop="url" content="https://juejin.cn/user/2041171430876333"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ultraciteï¼šä¸º AI æ—¶ä»£æ‰“é€ çš„é›¶é…ç½®ä»£ç è§„èŒƒå·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2041171430876333/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JinSo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T10:26:41.000Z" title="Sat Nov 22 2025 10:26:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">Ultracite æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>Ultracite æ˜¯ä¸€ä¸ª<strong>é«˜åº¦å›ºå®šåŒ–ã€é›¶é…ç½®</strong>çš„ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–å·¥å…·ã€‚å®ƒåŸºäºé«˜æ€§èƒ½çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fbiomejs.dev%2F" target="_blank" title="https://biomejs.dev/" ref="nofollow noopener noreferrer">Biome</a> æ„å»ºï¼Œé€‚ç”¨äºæ‰€æœ‰å‰ç«¯é¡¹ç›®ï¼Œæ— è®ºä½ ä½¿ç”¨ Reactã€Vueã€Angular è¿˜æ˜¯åŸç”Ÿ JavaScriptï¼Œéƒ½èƒ½è®©ä½ å’Œ AI ç¼–ç¨‹åŠ©æ‰‹ç¼–å†™å‡ºä¸€è‡´ä¸”é«˜è´¨é‡çš„ä»£ç ã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒç†å¿µï¼šçº¦å®šä¼˜äºé…ç½®</h3>
<p>ä¸åŒäº ESLint + Prettier éœ€è¦å¤§é‡é…ç½®ï¼ŒUltracite é‡‡ç”¨äº†æç®€ä¸»ä¹‰è®¾è®¡ç†å¿µï¼š</p>
<ul>
<li><strong>é›¶é…ç½®</strong>ï¼šå¼€ç®±å³ç”¨ï¼Œæ— éœ€ç¼–å†™ä»»ä½•é…ç½®æ–‡ä»¶</li>
<li><strong>å›ºå®šè§„åˆ™</strong>ï¼šç²¾å¿ƒæŒ‘é€‰çš„è§„åˆ™é›†ï¼Œé¿å…æ— è°“çš„é€‰æ‹©å›°æ‰°</li>
<li><strong>ç»Ÿä¸€æ ‡å‡†</strong>ï¼šæ•´ä¸ªå›¢é˜Ÿå’Œ AI åŠ©æ‰‹éƒ½éµå¾ªç›¸åŒçš„ä»£ç è§„èŒƒ</li>
</ul>
<h2 data-id="heading-2">å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-3">åˆå§‹åŒ–</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨é¡¹ç›®ä¸­åˆå§‹åŒ– Ultracite</span>
pnpm dlx ultracite init
</code></pre>
<p>Ultracite æä¾›äº†äº¤äº’å¼çš„å®‰è£…ä½“éªŒï¼Œè®©ä½ æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">â¯ pnpm dlx ultracite init
â”Œ
888     888 888    88888888888 8888888b.         d8888  .d8888b. 8888888 88888888888 8888888888
888     888 888        888     888   Y88b       d88888 d88P  Y88b  888       888     888
888     888 888        888     888    888      d88P888 888    888  888       888     888
888     888 888        888     888   d88P     d88P 888 888         888       888     8888888
888     888 888        888     8888888P<span class="hljs-string">"     d88P  888 888         888       888     888
888     888 888        888     888 T88b     d88P   888 888    888  888       888     888
Y88b. .d88P 888        888     888  T88b   d8888888888 Y88b  d88P  888       888     888
 "</span>Y88888P<span class="hljs-string">"  88888888   888     888   T88b d88P     888  "</span>Y8888P<span class="hljs-string">" 8888888     888     8888888888

â”‚
â—  Detected lockfile, using pnpm
â”‚
â—‡  Remove existing formatters/linters (recommended for clean migration)?
â”‚  Remove ESLint (dependencies, config files, VS Code settings)
â”‚
â—‡  Which frameworks are you using (optional)?
â”‚  React
â”‚
â—‡  Which editors do you want to configure (recommended)?
â”‚  VSCode / Cursor / Windsurf
â”‚
â—‡  Which agents do you want to enable (optional)?
â”‚  Cursor
â”‚
â—‡  Which agent hooks do you want to enable (optional)?
â”‚  Cursor
â”‚
â—‡  Would you like any of the following (optional)?
â”‚  Husky pre-commit hook, Lefthook pre-commit hook, Lint-staged
â”‚
â—‘  ...çœç•¥å®‰è£…æ­¥éª¤
â—†  Successfully initialized Ultracite configuration!
</span></code></pre>
<p>åˆå§‹åŒ–å®Œæˆåï¼ŒUltracite ä¼šæ ¹æ®ä½ çš„é€‰æ‹©è‡ªåŠ¨å®Œæˆä»¥ä¸‹é…ç½®ï¼š</p>
<ul>
<li>å®‰è£…å¿…è¦çš„ä¾èµ–åŒ…</li>
<li>ç”Ÿæˆç¼–è¾‘å™¨é…ç½®æ–‡ä»¶</li>
<li><strong>åˆ›å»º AI ä»£ç è§„èŒƒæç¤ºè¯</strong>ï¼ˆè¿™æ˜¯ Ultracite çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼‰</li>
<li>é…ç½® Git Hooks å·¥å…·ï¼ˆHuskyã€Lefthookã€Lint-stagedï¼‰</li>
<li>æ›´æ–° package.json è„šæœ¬</li>
<li>ç”Ÿæˆ biome.json é…ç½®æ–‡ä»¶</li>
</ul>
<p>å…³äº Git Hooks å·¥å…·çš„è¯¦ç»†ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š<a href="https://juejin.cn/post/7309290887363592233" target="_blank" title="https://juejin.cn/post/7309290887363592233">åœ¨ Monorepo ä¸­å¯¹ä»£ç è¿›è¡Œè§„èŒƒ(husky + lint-staged)</a></p>
<h3 data-id="heading-4">åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥ä»£ç é—®é¢˜</span>
npx ultracite check

<span class="hljs-comment"># è‡ªåŠ¨ä¿®å¤å’Œæ ¼å¼åŒ–ä»£ç </span>
npx ultracite fix
</code></pre>
<h2 data-id="heading-5">AI å‹å¥½ç‰¹æ€§</h2>
<p>è¿™æ˜¯ Ultracite çš„ä¸€å¤§äº®ç‚¹ â€”â€” å®ƒä¸“é—¨ä¸º AI ç¼–ç¨‹æ—¶ä»£è®¾è®¡ï¼Œè®© AI åŠ©æ‰‹ä¹Ÿèƒ½éµå¾ªé¡¹ç›®çš„ä»£ç è§„èŒƒã€‚</p>
<h3 data-id="heading-6">AI æç¤ºè¯é›†æˆ</h3>
<p>å½“ä½ é€‰æ‹©å¯ç”¨ AI agentï¼ˆå¦‚ Cursorï¼‰æ—¶ï¼ŒUltracite ä¼šç”Ÿæˆä¸€ä»½è¯¦ç»†çš„ä»£ç è§„èŒƒæç¤ºè¯æ–‡ä»¶ <code>.cursor/rules/ultracite.mdc</code>ã€‚è¿™ä»½æ–‡ä»¶åŒ…å«äº†å®Œæ•´çš„ç¼–ç è§„èŒƒï¼Œæ¶µç›–ï¼š</p>
<ul>
<li><strong>ç±»å‹å®‰å…¨è§„èŒƒ</strong>ï¼šè¦æ±‚ä½¿ç”¨æ˜ç¡®çš„ç±»å‹å®šä¹‰ï¼Œé¿å… any ç±»å‹</li>
<li><strong>ç°ä»£è¯­æ³•è§„èŒƒ</strong>ï¼šä¼˜å…ˆä½¿ç”¨ç®­å¤´å‡½æ•°ã€å¯é€‰é“¾ã€è§£æ„èµ‹å€¼ç­‰ç°ä»£ç‰¹æ€§</li>
<li><strong>å¼‚æ­¥ç¼–ç¨‹è§„èŒƒ</strong>ï¼šæ­£ç¡®ä½¿ç”¨ async/awaitï¼Œå¦¥å–„å¤„ç†é”™è¯¯</li>
<li><strong>React æœ€ä½³å®è·µ</strong>ï¼šå‡½æ•°ç»„ä»¶ã€Hooks è§„åˆ™ã€æ— éšœç¢è®¿é—®ç­‰</li>
<li><strong>ä»£ç ç»„ç»‡åŸåˆ™</strong>ï¼šå‡½æ•°å¤æ‚åº¦æ§åˆ¶ã€æ—©æœŸè¿”å›ã€å…³æ³¨ç‚¹åˆ†ç¦»</li>
</ul>
<p>æœ‰äº†è¿™ä»½æç¤ºè¯ï¼ŒAI åŠ©æ‰‹ç”Ÿæˆçš„ä»£ç ä¼šè‡ªåŠ¨éµå¾ªè¿™äº›è§„èŒƒï¼Œå¤§å¤§å‡å°‘äº†ä»£ç å®¡æŸ¥çš„å·¥ä½œé‡ã€‚</p>
<h3 data-id="heading-7">Cursor Hooks é›†æˆ</h3>
<p>å¯¹äº Cursor ç”¨æˆ·ï¼ŒUltracite è¿˜ä¼šç”Ÿæˆ hooks é…ç½®ï¼ˆ<code>.cursor/hooks.json</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"version"</span>: 1,
  <span class="hljs-string">"hooks"</span>: {
    <span class="hljs-string">"afterFileEdit"</span>: [
      {
        <span class="hljs-string">"command"</span>: <span class="hljs-string">"npx ultracite fix"</span>
      }
    ]
  }
}
</code></pre>
<p>è¿™ä¸ªé…ç½®å®ç°äº†"ä¿å­˜å³æ ¼å¼åŒ–"çš„æ•ˆæœ â€”â€” æ¯æ¬¡ä½ æˆ– AI ç¼–è¾‘æ–‡ä»¶åï¼Œä»£ç éƒ½ä¼šè‡ªåŠ¨æ ¼å¼åŒ–ï¼Œä¿æŒæ•´ä¸ªé¡¹ç›®çš„ä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-8">Git Hooks é›†æˆ</h2>
<p>Ultracite æ”¯æŒä¸»æµçš„ Git Hooks å·¥å…·ï¼Œç¡®ä¿æäº¤çš„ä»£ç éƒ½ç»è¿‡æ£€æŸ¥å’Œæ ¼å¼åŒ–ã€‚</p>
<h3 data-id="heading-9">Husky é›†æˆ</h3>
<p>ç”Ÿæˆçš„ <code>.husky/pre-commit</code> æ–‡ä»¶ä¼šåœ¨æäº¤å‰è‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh</span>
<span class="hljs-comment"># Exit on any error</span>
<span class="hljs-built_in">set</span> -e

<span class="hljs-comment"># Check if there are any staged files</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-subst">$(git diff --cached --name-only)</span>"</span> ]; <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"No staged files to format"</span>
  <span class="hljs-built_in">exit</span> 0
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Store the hash of staged changes to detect modifications</span>
STAGED_HASH=$(git diff --cached | <span class="hljs-built_in">sha256sum</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">' '</span> -f1)

<span class="hljs-comment"># Save list of staged files (handling all file states)</span>
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR)
PARTIALLY_STAGED=$(git diff --name-only)

<span class="hljs-comment"># Stash unstaged changes to preserve working directory</span>
git stash push --quiet --keep-index --message <span class="hljs-string">"pre-commit-stash"</span> || <span class="hljs-literal">true</span>
STASHED=$?

<span class="hljs-comment"># Run formatter on the staged files</span>
pnpm dlx ultracite fix
FORMAT_EXIT_CODE=$?

<span class="hljs-comment"># Restore working directory state</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$STASHED</span> -eq 0 ]; <span class="hljs-keyword">then</span>
  <span class="hljs-comment"># Re-stage the formatted files</span>
  <span class="hljs-keyword">if</span> [ -n <span class="hljs-string">"<span class="hljs-variable">$STAGED_FILES</span>"</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$STAGED_FILES</span>"</span> | <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r file; <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span> ]; <span class="hljs-keyword">then</span>
        git add <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span>
      <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">done</span>
  <span class="hljs-keyword">fi</span>

  <span class="hljs-comment"># Restore unstaged changes</span>
  git stash pop --quiet || <span class="hljs-literal">true</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Check if staged files actually changed</span>
NEW_STAGED_HASH=$(git diff --cached | <span class="hljs-built_in">sha256sum</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">' '</span> -f1)
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$STAGED_HASH</span>"</span> != <span class="hljs-string">"<span class="hljs-variable">$NEW_STAGED_HASH</span>"</span> ]; <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ¨ Files formatted by Ultracite"</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">exit</span> <span class="hljs-variable">$FORMAT_EXIT_CODE</span>
</code></pre>
<p>è¿™ä¸ªè„šæœ¬ä¼šæ™ºèƒ½å¤„ç†éƒ¨åˆ†æš‚å­˜çš„æ–‡ä»¶ï¼Œç¡®ä¿åªæ ¼å¼åŒ–ä½ è¦æäº¤çš„ä»£ç ã€‚</p>
<h3 data-id="heading-10">Lefthook é›†æˆ</h3>
<p>å¦‚æœä½ é€‰æ‹©ä½¿ç”¨ Lefthookï¼Œä¼šç”Ÿæˆ <code>lefthook.yml</code> é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">pre-commit:</span>
  <span class="hljs-attr">jobs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">pnpm</span> <span class="hljs-string">dlx</span> <span class="hljs-string">ultracite</span> <span class="hljs-string">fix</span>
      <span class="hljs-attr">glob:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.js"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.jsx"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.ts"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.tsx"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.json"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.jsonc"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">"*.css"</span>
      <span class="hljs-attr">stage_fixed:</span> <span class="hljs-literal">true</span>
</code></pre>
<p>Lefthook çš„ä¼˜åŠ¿åœ¨äºå¹¶è¡Œæ‰§è¡Œå’Œæ›´çµæ´»çš„é…ç½®é€‰é¡¹ã€‚</p>
<h3 data-id="heading-11">Lint-staged é›†æˆ</h3>
<p>é…åˆ lint-staged å¯ä»¥åªå¤„ç†æš‚å­˜çš„æ–‡ä»¶ï¼Œåœ¨ <code>package.json</code> ä¸­ä¼šæ·»åŠ ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"*.{js,jsx,ts,tsx,json,jsonc,css,scss,md,mdx}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"pnpm dlx ultracite fix"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-12">VSCode æ·±åº¦é›†æˆ</h2>
<p>Ultracite ä¼šè‡ªåŠ¨ä¸º VSCodeï¼ˆåŒ…æ‹¬ Cursorã€Windsurfï¼‰ç”Ÿæˆé…ç½®ï¼Œå®ç°ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// .vscode/settings.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[javascript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[typescript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[javascriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[typescriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[json]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[jsonc]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[css]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"[graphql]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biomejs.biome"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"typescript.tsdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node_modules/typescript/lib"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"editor.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"editor.formatOnPaste"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"emmet.showExpandedAbbreviation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"never"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"editor.codeActionsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"source.fixAll.biome"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explicit"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"source.organizeImports.biome"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explicit"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-13"><strong>MCPï¼ˆModel Context Protocolï¼‰æ”¯æŒ</strong></h2>
<p>MCP æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œè®© Claudeã€Cursor ç­‰ AI å·¥å…·èƒ½å¤Ÿå®‰å…¨åœ°è¿æ¥å¤–éƒ¨æ•°æ®æºå’Œç³»ç»Ÿã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ª"ä¸‡èƒ½é¥æ§å™¨"ï¼Œè®© AI å·¥å…·èƒ½å¤Ÿè®¿é—®çœŸå®ä¸–ç•Œçš„æ•°æ®å’ŒåŠŸèƒ½ã€‚Ultracite é€šè¿‡æ”¯æŒ MCP æ¥å¢å¼ºä½ çš„ AI å¼€å‘å·¥ä½œæµã€‚</p>
<h3 data-id="heading-14"><strong>å®‰è£…é…ç½®</strong></h3>
<ol>
<li>
<p><strong>é€‰æ‹©ä½ çš„ AI å·¥å…·</strong></p>
<p>ç¡®ä¿ä½ ä½¿ç”¨çš„ AI å¼€å‘å·¥å…·æ”¯æŒ MCPï¼š</p>
<ul>
<li>Claude Desktopï¼ˆå…è´¹ï¼Œæ¨èåˆå­¦è€…ä½¿ç”¨ï¼‰</li>
<li>Cursorï¼ˆAI é©±åŠ¨çš„ä»£ç ç¼–è¾‘å™¨ï¼‰</li>
<li>Windsurf by Codeiumï¼ˆAI å¼€å‘å¹³å°ï¼‰</li>
<li>å…¶ä»–æ”¯æŒ MCP çš„å·¥å…·</li>
</ul>
</li>
<li>
<p><strong>æ‰¾åˆ°é…ç½®æ–‡ä»¶ä½ç½®</strong></p>
<p>æ ¹æ®ä½ çš„ AI å·¥å…·ï¼Œéœ€è¦ç¼–è¾‘å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li>
<p><strong>Claude Desktop</strong>:</p>
<ul>
<li>macOS:Â <code>~/Library/Application\ Support/Claude/claude_desktop_config.json</code></li>
<li>Windows:Â <code>%APPDATA%\Claude\claude_desktop_config.json</code></li>
</ul>
</li>
<li>
<p><strong>Cursor</strong>:Â <code>.cursor/mcp.json</code></p>
</li>
<li>
<p><strong>Windsurf</strong>:Â <code>.codeium/windsurf/mcp_config.json</code></p>
</li>
<li>
<p><strong>å…¶ä»–å·¥å…·</strong>: æŸ¥çœ‹å¯¹åº”å·¥å…·çš„ MCP æ–‡æ¡£</p>
</li>
</ul>
</li>
<li>
<p><strong>æ·»åŠ  Ultracite é…ç½®</strong></p>
<p>å°†ä»¥ä¸‹é…ç½®å¤åˆ¶åˆ°ä½ çš„ MCP é…ç½®æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ultracite"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"-y"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"mcp-remote"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"&lt;https://www.ultracite.ai/api/mcp/mcp&gt;"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p><strong>é‡å¯ AI å·¥å…·</strong></p>
<p>å…³é—­å¹¶é‡æ–°æ‰“å¼€ä½ çš„ AI åº”ç”¨ï¼Œè®©é…ç½®ç”Ÿæ•ˆã€‚</p>
</li>
<li>
<p><strong>éªŒè¯è¿æ¥</strong></p>
<p>é€šè¿‡è¯¢é—®ä½ çš„ AI åŠ©æ‰‹æ¥æµ‹è¯•é›†æˆæ˜¯å¦æˆåŠŸï¼š</p>
<blockquote>
<p>"Ultracite æœ‰å“ªäº›å¯ç”¨çš„è§„åˆ™ï¼Ÿ"</p>
</blockquote>
<p>å¦‚æœé…ç½®æˆåŠŸï¼ŒAI åº”è¯¥èƒ½å¤Ÿåˆ—å‡ºå¹¶è§£é‡Š Ultracite çš„è§„åˆ™ï¼</p>
</li>
</ol>
<h2 data-id="heading-15">ä» ESLint + Prettier è¿ç§»</h2>
<p>è¿ç§»è¿‡ç¨‹éå¸¸ç®€å•ï¼š</p>
<ol>
<li>è¿è¡Œ <code>pnpm dlx ultracite init</code></li>
<li>é€‰æ‹©ç§»é™¤ç°æœ‰çš„ ESLint å’Œ Prettier é…ç½®</li>
<li>æ›´æ–° package.json ä¸­çš„è„šæœ¬å‘½ä»¤</li>
<li>åˆ é™¤æ—§çš„é…ç½®æ–‡ä»¶</li>
</ol>
<p>Ultracite çš„è§„åˆ™é›†å·²ç»æ¶µç›–äº†å¤§å¤šæ•°å¸¸ç”¨çš„ ESLint å’Œ Prettier è§„åˆ™ï¼Œä½ å‡ ä¹ä¸éœ€è¦ä»»ä½•é¢å¤–é…ç½®ã€‚</p>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>Ultracite ä»£è¡¨äº†ä»£ç è´¨é‡å·¥å…·çš„æ–°æ–¹å‘ï¼šç®€å•ã€å¿«é€Ÿã€AI å‹å¥½ã€‚å®ƒç‰¹åˆ«é€‚åˆï¼š</p>
<ul>
<li><strong>ä½¿ç”¨ AI ç¼–ç¨‹çš„å¼€å‘è€…</strong>ï¼šé€šè¿‡æç¤ºè¯å’Œ hooks ç¡®ä¿ AI ç”Ÿæˆé«˜è´¨é‡ä»£ç </li>
<li><strong>è¿½æ±‚æ•ˆç‡çš„å›¢é˜Ÿ</strong>ï¼šé›¶é…ç½®è®¾è®¡ï¼Œå‡å°‘å·¥å…·é“¾ç»´æŠ¤æˆæœ¬</li>
<li><strong>ä»»ä½•å‰ç«¯é¡¹ç›®</strong>ï¼šæ— è®ºä½¿ç”¨ä»€ä¹ˆæ¡†æ¶ï¼Œéƒ½èƒ½è·å¾—ä¸€è‡´çš„ä»£ç è´¨é‡</li>
<li><strong>Monorepo é¡¹ç›®</strong>ï¼šåŸç”Ÿæ”¯æŒï¼Œé…ç½®ç®€å•</li>
</ul>
<p>ç›¸æ¯”ä¼ ç»Ÿçš„ ESLint + Prettier ç»„åˆï¼ŒUltracite æä¾›äº†æ›´å¿«çš„æ€§èƒ½ã€æ›´ç®€å•çš„é…ç½®ã€æ›´ç»Ÿä¸€çš„å·¥å…·é“¾ï¼Œä»¥åŠåŸç”Ÿçš„ AI ç¼–ç¨‹æ”¯æŒã€‚åœ¨ AI è¾…åŠ©ç¼–ç¨‹è¶Šæ¥è¶Šæ™®åŠçš„ä»Šå¤©ï¼Œé€‰æ‹©ä¸€ä¸ª AI å‹å¥½çš„ä»£ç è§„èŒƒå·¥å…·ï¼Œèƒ½è®©ä½ çš„å¼€å‘æ•ˆç‡æ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSS å±æ€§å€¼ initialã€unset å’Œ revert çš„è§£æ]]></title>    <link>https://juejin.cn/post/7575083657994158107</link>    <guid>https://juejin.cn/post/7575083657994158107</guid>    <pubDate>2025-11-22T14:17:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575083657994158107" data-draft-id="7575133880434966579" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSS å±æ€§å€¼ initialã€unset å’Œ revert çš„è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-22T14:17:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å«"/> <meta itemprop="url" content="https://juejin.cn/user/1961184474695213"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSS å±æ€§å€¼ initialã€unset å’Œ revert çš„è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1961184474695213/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T14:17:29.000Z" title="Sat Nov 22 2025 14:17:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯<strong>å‰ç«¯æ¶æ„å¸ˆ</strong>ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€<strong>ç¨‹åºå‘˜å¤§å«</strong>ã€‘ï¼Œå…è´¹é¢†å–å‰ç«¯æœ€æ–°é¢è¯•èµ„æ–™ã€‚</p>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨ CSS ä¸­ï¼Œç®¡ç†å±æ€§å€¼å’Œç»§æ‰¿è¡Œä¸ºæ˜¯åˆ›å»ºå¥å£®ã€å¯ç»´æŠ¤æ ·å¼çš„åŸºç¡€ã€‚é™¤äº†å¸¸è§çš„å…·ä½“æ•°å€¼ï¼ˆå¦‚ <code>16px</code>ã€<code>#333</code>ï¼‰æˆ–é€šç”¨å€¼ï¼ˆå¦‚ <code>inherit</code>ï¼‰ä¹‹å¤–ï¼ŒCSS è¿˜æä¾›äº†ä¸€äº›ç‰¹æ®Šçš„<strong>å…³é”®å­—</strong>ï¼Œå®ƒä»¬èƒ½é‡ç½®æˆ–æ¢å¤å±æ€§å€¼åˆ°å…¶â€œé»˜è®¤â€æˆ–å‰ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p>å…¶ä¸­ï¼Œ<code>initial</code>ã€<code>unset</code> å’Œ <code>revert</code> æ˜¯ä¸‰ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å®¹æ˜“æ··æ·†çš„å…³é”®å­—ã€‚ç†è§£å®ƒä»¬çš„åŒºåˆ«ï¼Œèƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°æ§åˆ¶æ ·å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ç¬¬ä¸‰æ–¹ç»„ä»¶æˆ–å¤§å‹åº”ç”¨ä¸­çš„æ ·å¼å†²çªæ—¶ã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒåŒºåˆ«ä¸€è§ˆ</h2>





























<table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">ä½œç”¨</th><th align="left">è¡Œä¸ºç»†èŠ‚</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><strong><code>initial</code></strong></td><td align="left">é‡ç½®ä¸º<strong>åˆå§‹å€¼</strong></td><td align="left">å°†å±æ€§é‡ç½®ä¸ºå…¶åœ¨ CSS è§„èŒƒä¸­å®šä¹‰çš„<strong>åˆå§‹å€¼</strong>ï¼ˆå°±åƒè¯¥å±æ€§ä»æœªè¢«è®¾ç½®è¿‡ä¸€æ ·ï¼‰ã€‚</td><td align="left">ç¡®ä¿å±æ€§å€¼æ˜¯æµè§ˆå™¨é»˜è®¤çš„â€œå‡ºå‚è®¾ç½®â€ï¼Œä¸è€ƒè™‘ç»§æ‰¿ã€‚</td></tr><tr><td align="left"><strong><code>unset</code></strong></td><td align="left">é‡ç½®ä¸º<strong>æœªè®¾ç½®å€¼</strong></td><td align="left">å¦‚æœè¯¥å±æ€§æ˜¯<strong>å¯ç»§æ‰¿</strong>çš„ï¼Œåˆ™è¡¨ç°ä¸º <code>inherit</code>ï¼ˆç»§æ‰¿çˆ¶å…ƒç´ çš„å€¼ï¼‰ã€‚<br/>å¦‚æœè¯¥å±æ€§æ˜¯<strong>ä¸å¯ç»§æ‰¿</strong>çš„ï¼Œåˆ™è¡¨ç°ä¸º <code>initial</code>ã€‚</td><td align="left">æ¢å¤å±æ€§åˆ°å…¶è‡ªç„¶çš„ï¼ˆé»˜è®¤çš„ï¼‰ç»§æ‰¿è¡Œä¸ºã€‚</td></tr><tr><td align="left"><strong><code>revert</code></strong></td><td align="left">é‡ç½®ä¸º<strong>ä¸Šä¸€ä¸ªçº§è”å€¼</strong></td><td align="left">å°†å±æ€§é‡ç½®ä¸º<strong>ç”¨æˆ·ä»£ç†æ ·å¼è¡¨</strong>ï¼ˆæµè§ˆå™¨é»˜è®¤æ ·å¼ï¼‰ã€<strong>ç”¨æˆ·æ ·å¼è¡¨</strong>æˆ–<strong>ä½œè€…æ ·å¼è¡¨</strong>ä¸­åº”ç”¨è¿‡çš„ä¸Šä¸€ä¸ªå€¼ã€‚å®ƒä¼šæ’¤é”€å½“å‰æ ·å¼å—çš„æ›´æ”¹ï¼Œæ¢å¤åˆ°çº§è”é“¾ä¸­æ›´æ—©çš„å€¼ã€‚</td><td align="left">æ’¤é”€å¯¹å±æ€§çš„ç‰¹å®šè¦†ç›–ï¼Œæ¢å¤åˆ°æµè§ˆå™¨æˆ–ç”¨æˆ·å®šä¹‰çš„æ ·å¼ï¼Œå¸¸ç”¨äºæ¢å¤æµè§ˆå™¨é»˜è®¤æ ·å¼ã€‚</td></tr></tbody></table>
<h2 data-id="heading-2">å…³é”®å­—è¯¦è§£ä¸ç¤ºä¾‹</h2>
<p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ <code>color</code>ï¼ˆå¯ç»§æ‰¿ï¼‰å’Œ <code>border</code>ï¼ˆä¸å¯ç»§æ‰¿ï¼‰è¿™ä¸¤ä¸ªå±æ€§ã€‚</p>
<h3 data-id="heading-3">1. <code>initial</code>ï¼šå›åˆ°èµ·ç‚¹</h3>
<p><code>initial</code> æ€»æ˜¯å°†å±æ€§å€¼è®¾ç½®ä¸º CSS è§„èŒƒä¸­å®šä¹‰çš„<strong>åˆå§‹å€¼</strong>ã€‚è¿™ä¸ªå€¼æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”ä¸è¯¥å…ƒç´ æ˜¯å¦ç»§æ‰¿äº†çˆ¶å…ƒç´ çš„å€¼<strong>æ— å…³</strong>ã€‚</p>
<h4 data-id="heading-4"><strong>ç¤ºä¾‹ï¼š</strong></h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* åˆå§‹è®¾ç½® */</span>
<span class="hljs-selector-tag">div</span> {
  <span class="hljs-attribute">color</span>: blue;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;
}

<span class="hljs-comment">/* åº”ç”¨ initial */</span>
<span class="hljs-selector-class">.initial-demo</span> {
  <span class="hljs-comment">/* color æ˜¯å¯ç»§æ‰¿å±æ€§ï¼Œä½† initial å¼ºåˆ¶è®¾ä¸ºåˆå§‹å€¼ (é€šå¸¸æ˜¯ black) */</span>
  <span class="hljs-attribute">color</span>: initial;
  <span class="hljs-comment">/* border æ˜¯ä¸å¯ç»§æ‰¿å±æ€§ï¼Œinitial å¼ºåˆ¶è®¾ä¸ºåˆå§‹å€¼ (none) */</span>
  <span class="hljs-attribute">border</span>: initial;
}
</code></pre>























<table><thead><tr><th align="left">å…ƒç´ </th><th align="left">çˆ¶å…ƒç´  <code>div</code> çš„æ ·å¼</th><th align="left"><code>.initial-demo</code> çš„æ ·å¼</th><th align="left">æœ€ç»ˆå€¼</th></tr></thead><tbody><tr><td align="left"><code>color</code></td><td align="left"><code>blue</code></td><td align="left"><code>initial</code></td><td align="left"><strong><code>black</code></strong> (åˆå§‹å€¼)</td></tr><tr><td align="left"><code>border</code></td><td align="left"><code>1px solid black</code></td><td align="left"><code>initial</code></td><td align="left"><strong><code>none</code></strong> (åˆå§‹å€¼)</td></tr></tbody></table>
<h3 data-id="heading-5">2. <code>unset</code>ï¼šæ¢å¤è‡ªç„¶çŠ¶æ€</h3>
<p><code>unset</code> æ˜¯ä¸€ä¸ªâ€œæ™ºèƒ½â€çš„é‡ç½®ã€‚å®ƒæ ¹æ®å±æ€§çš„<strong>å¯ç»§æ‰¿æ€§</strong>æ¥å†³å®šè¡Œä¸ºï¼š</p>
<ul>
<li><strong>å¯ç»§æ‰¿å±æ€§ï¼š</strong> è¡¨ç°ä¸º <code>inherit</code>ã€‚</li>
<li><strong>ä¸å¯ç»§æ‰¿å±æ€§ï¼š</strong> è¡¨ç°ä¸º <code>initial</code>ã€‚</li>
</ul>
<h4 data-id="heading-6"><strong>ç¤ºä¾‹ï¼š</strong></h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* åˆå§‹è®¾ç½® */</span>
<span class="hljs-selector-tag">div</span> {
  <span class="hljs-attribute">color</span>: blue;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;
}

<span class="hljs-comment">/* åº”ç”¨ unset */</span>
<span class="hljs-selector-class">.unset-demo</span> {
  <span class="hljs-comment">/* color æ˜¯å¯ç»§æ‰¿å±æ€§ï¼Œè¡¨ç°ä¸º inherit */</span>
  <span class="hljs-attribute">color</span>: unset;
  <span class="hljs-comment">/* border æ˜¯ä¸å¯ç»§æ‰¿å±æ€§ï¼Œè¡¨ç°ä¸º initial */</span>
  <span class="hljs-attribute">border</span>: unset;
}
</code></pre>























<table><thead><tr><th align="left">å…ƒç´ </th><th align="left">çˆ¶å…ƒç´  <code>div</code> çš„æ ·å¼</th><th align="left"><code>.unset-demo</code> çš„æ ·å¼</th><th align="left">æœ€ç»ˆå€¼</th></tr></thead><tbody><tr><td align="left"><code>color</code></td><td align="left"><code>blue</code></td><td align="left"><code>unset</code> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> <code>inherit</code></td><td align="left"><strong><code>blue</code></strong> (ç»§æ‰¿è‡ªçˆ¶å…ƒç´ )</td></tr><tr><td align="left"><code>border</code></td><td align="left"><code>1px solid black</code></td><td align="left"><code>unset</code> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> <code>initial</code></td><td align="left"><strong><code>none</code></strong> (åˆå§‹å€¼)</td></tr></tbody></table>
<h3 data-id="heading-7">3. <code>revert</code>ï¼šæ’¤é”€ä½œè€…æ ·å¼</h3>
<p><code>revert</code> æ˜¯æœ€ç‹¬ç‰¹çš„ã€‚å®ƒæ²¿ç€ CSS çº§è”ï¼ˆCascadingï¼‰é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œæ¢å¤åˆ°<strong>ä¸Šä¸€ä¸ª</strong>è¢«åº”ç”¨çš„å€¼ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯<strong>æ’¤é”€</strong>äº†å½“å‰æ ·å¼è¡¨ä¸­çš„å±æ€§å®šä¹‰ï¼Œæ¢å¤åˆ°ï¼š</p>
<ol>
<li><strong>ç”¨æˆ·æ ·å¼</strong>ï¼ˆå¦‚æœç”¨æˆ·è®¾ç½®äº†ï¼‰ã€‚</li>
<li><strong>æµè§ˆå™¨é»˜è®¤æ ·å¼</strong>ï¼ˆç”¨æˆ·ä»£ç†æ ·å¼è¡¨ï¼‰ã€‚</li>
<li>å¦‚æœä»¥ä¸Šéƒ½æ²¡æœ‰ï¼Œåˆ™æ¢å¤åˆ° <code>unset</code> çš„è¡Œä¸ºã€‚</li>
</ol>
<p>å®ƒä¸»è¦ç”¨äºæ¢å¤æµè§ˆå™¨é»˜è®¤æ ·å¼ï¼Œä¾‹å¦‚ï¼Œæ‚¨ä¸æƒ³è®©æŸä¸ª <code>&lt;h1&gt;</code> æ ‡ç­¾åº”ç”¨æ‚¨çš„å…¨å±€å­—ä½“æ ·å¼ï¼Œå¸Œæœ›å®ƒç”¨å›æµè§ˆå™¨é»˜è®¤çš„ç²—ä½“å¤§å­—ã€‚</p>
<h4 data-id="heading-8"><strong>ç¤ºä¾‹ï¼š</strong></h4>
<p>å‡è®¾æµè§ˆå™¨é»˜è®¤æ ·å¼æ˜¯ï¼š<code>h1 { font-weight: bold; }</code></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä½œè€…æ ·å¼è¡¨ (æ‚¨çš„ä»£ç ) */</span>
<span class="hljs-selector-tag">h1</span> {
  <span class="hljs-comment">/* è¦†ç›–äº†æµè§ˆå™¨é»˜è®¤æ ·å¼ */</span>
  <span class="hljs-attribute">font-weight</span>: normal; 
}

<span class="hljs-selector-class">.revert-demo</span> {
  <span class="hljs-comment">/* æ’¤é”€äº†ä¸Šæ–¹çš„ font-weight: normal; */</span>
  <span class="hljs-attribute">font-weight</span>: revert;
}
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>.revert-demo</code> å…ƒç´ ä¼šå°† <code>font-weight</code> æ¢å¤åˆ° <strong>æµè§ˆå™¨é»˜è®¤å€¼</strong> (<code>bold</code>)ï¼Œå› ä¸ºå®ƒæ’¤é”€äº†ä½œè€…æ ·å¼è¡¨ä¸­çš„ <code>normal</code> å£°æ˜ã€‚</p>
<h2 data-id="heading-9">âœ… æ€»ç»“ä¸åº”ç”¨å»ºè®®</h2>

























<table><thead><tr><th align="left">å…³é”®å­—</th><th align="left">è®°å¿†ç‚¹</th><th align="left">åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><strong><code>initial</code></strong></td><td align="left"><strong>â€œç»å¯¹åˆå§‹â€</strong></td><td align="left">ç¡®ä¿å±æ€§å€¼æ˜¯å…¶ CSS è§„èŒƒå®šä¹‰çš„<strong>åŸå§‹é»˜è®¤å€¼</strong>ï¼Œä¸è€ƒè™‘ä¸Šä¸‹æ–‡ã€‚</td></tr><tr><td align="left"><strong><code>unset</code></strong></td><td align="left"><strong>â€œæ™ºèƒ½é‡ç½®â€</strong></td><td align="left">æ¢å¤å±æ€§çš„<strong>è‡ªç„¶ç»§æ‰¿è¡Œä¸º</strong>ï¼ˆå¯ç»§æ‰¿åˆ™ <code>inherit</code>ï¼Œä¸å¯ç»§æ‰¿åˆ™ <code>initial</code>ï¼‰ã€‚</td></tr><tr><td align="left"><strong><code>revert</code></strong></td><td align="left"><strong>â€œæ’¤é”€â€</strong></td><td align="left">æ’¤é”€ä½œè€…æ ·å¼ï¼Œ<strong>æ¢å¤åˆ°æµè§ˆå™¨é»˜è®¤æˆ–ç”¨æˆ·æ ·å¼</strong>ã€‚å¸¸ç”¨äºå¸Œæœ›ä¿æŒæµè§ˆå™¨é»˜è®¤å¤–è§‚çš„å…ƒç´ ã€‚</td></tr></tbody></table>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ªï¼Ÿ</strong></p>
<ul>
<li>å¦‚æœæ‚¨æƒ³ç¡®ä¿ä¸€ä¸ªå±æ€§å€¼æ˜¯<strong>å›ºå®šçš„ã€æ˜ç¡®çš„ CSS åˆå§‹å€¼</strong>ï¼Œä½¿ç”¨ <code>initial</code>ã€‚</li>
<li>å¦‚æœæ‚¨æƒ³è®©ä¸€ä¸ªå±æ€§<strong>éµå¾ªå…¶å›ºæœ‰çš„ç»§æ‰¿è§„åˆ™</strong>ï¼ˆå³ï¼Œå¯ç»§æ‰¿çš„å°±ç»§æ‰¿ï¼Œä¸å¯ç»§æ‰¿çš„å°±ä½¿ç”¨åˆå§‹å€¼ï¼‰ï¼Œä½¿ç”¨ <code>unset</code>ã€‚</li>
<li>å¦‚æœæ‚¨æƒ³<strong>æ’¤é”€æ‚¨çš„æ ·å¼å¯¹æŸä¸ªå…ƒç´ é»˜è®¤å¤–è§‚çš„è¦†ç›–</strong>ï¼Œæ¢å¤åˆ°æµè§ˆå™¨æä¾›çš„é»˜è®¤æ ·å¼ï¼Œä½¿ç”¨ <code>revert</code>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python ç¼–ç¨‹å®æˆ˜ Â· è¿›é˜¶ä¸èŒä¸šå‘å±•ï¼šWeb å…¨æ ˆï¼ˆDjango / FastAPIï¼‰]]></title>    <link>https://juejin.cn/post/7575015480199118900</link>    <guid>https://juejin.cn/post/7575015480199118900</guid>    <pubDate>2025-11-22T04:39:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575015480199118900" data-draft-id="7575065455074574371" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python ç¼–ç¨‹å®æˆ˜ Â· è¿›é˜¶ä¸èŒä¸šå‘å±•ï¼šWeb å…¨æ ˆï¼ˆDjango / FastAPIï¼‰"/> <meta itemprop="keywords" content="åç«¯,Python,Trae"/> <meta itemprop="datePublished" content="2025-11-22T04:39:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python ç¼–ç¨‹å®æˆ˜ Â· è¿›é˜¶ä¸èŒä¸šå‘å±•ï¼šWeb å…¨æ ˆï¼ˆDjango / FastAPIï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T04:39:16.000Z" title="Sat Nov 22 2025 04:39:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨ Python çš„èŒä¸šåŒ–é“è·¯ä¸Šï¼ŒWeb å¼€å‘å‡ ä¹æ˜¯ç»•ä¸è¿‡çš„æ–¹å‘ã€‚ä»ä¼ ç»Ÿ MVC æ¡†æ¶åˆ°ç°ä»£å¼‚æ­¥ API æœåŠ¡ï¼ŒPython çš„ Web ç”Ÿæ€ä¸»è¦ç”±ä¸¤å¤§ä»£è¡¨å æ®ï¼š<strong>Django</strong> ä¸ <strong>FastAPI</strong>ã€‚</p>
</blockquote>
<p>å®ƒä»¬é£æ ¼è¿¥å¼‚ï¼Œå´éƒ½æœ‰ç€éå¸¸å¼ºçš„ç”Ÿäº§åŠ›ã€‚æœ¬ç¯‡å¸¦ä½ ä»æ¶æ„ç†å¿µã€åº”ç”¨åœºæ™¯ã€æ ¸å¿ƒç‰¹æ€§åˆ°å·¥ç¨‹å®è·µï¼Œå…¨é¢äº†è§£å®ƒä»¬åœ¨ Web å…¨æ ˆå¼€å‘ä¸­çš„å®šä½ã€‚</p>
<hr/>
<h2 data-id="heading-0"><strong>ä¸€ã€Djangoï¼šæˆç†Ÿçš„â€œå…¨å®¶æ¡¶â€ Web Framework</strong></h2>
<p>å¦‚æœä½ æƒ³æ„å»ºä¸€ä¸ª<strong>å®Œæ•´ã€ä¸¥è‚ƒã€åŠŸèƒ½å®Œå–„çš„ Web ç½‘ç«™</strong>ï¼Œé‚£ä¹ˆ Django æ˜¯æœ€ç¨³å¦¥çš„é€‰æ‹©ã€‚å®ƒéµå¾ª MTV æ¨¡å¼ï¼Œå¹¶ä¸”å¸¦ç€å¤§é‡â€œå¼€ç®±å³ç”¨â€çš„ç»„ä»¶ï¼š</p>
<ul>
<li>ORMï¼ˆæ•°æ®åº“å±‚ï¼‰</li>
<li>æ¨¡æ¿ç³»ç»Ÿï¼ˆå‰ç«¯æ¸²æŸ“ï¼‰</li>
<li>ç”¨æˆ·è®¤è¯ç³»ç»Ÿ</li>
<li>ä¸­é—´ä»¶æœºåˆ¶</li>
<li>Admin åå°</li>
<li>ç¼“å­˜ç³»ç»Ÿ</li>
<li>Form / è¡¨å•éªŒè¯</li>
<li>ä¼šè¯ç®¡ç†ç­‰æˆç†Ÿæœºåˆ¶</li>
</ul>
<p>è¿™ç§è®¾è®¡è®©å®ƒä¸€ç›´æ˜¯ä¼ä¸šçº§ Web é¡¹ç›®çš„é¦–é€‰ï¼Œå°¤å…¶é€‚åˆï¼š</p>
<p>âœ” CMS / ä¼ä¸šç½‘ç«™
âœ” ç”µå•†ç³»ç»Ÿ
âœ” å†…éƒ¨ç®¡ç†å¹³å°ï¼ˆERP/CRMï¼‰
âœ” å†…å®¹å‘å¸ƒç³»ç»Ÿ
âœ” éœ€è¦è´¦æˆ·ä½“ç³»ã€æƒé™çš„é¡¹ç›®</p>
<hr/>
<h3 data-id="heading-1"><strong>1. Django çš„æ¶æ„ä¼˜åŠ¿</strong></h3>
<h4 data-id="heading-2"><strong>ï¼ˆ1ï¼‰é«˜é›†æˆåº¦ï¼šæ— éœ€è‡ªè¡ŒæŒ‘é€‰ä¾èµ–</strong></h4>
<p>Django çš„æ ¸å¿ƒä»·å€¼ä¹‹ä¸€å°±æ˜¯è®©å¼€å‘è€…<strong>ä¸“æ³¨ä¸šåŠ¡ï¼Œè€Œä¸æ˜¯æ¡†æ¶æ­å»º</strong>ã€‚</p>
<p>ä¸€ä¸ªç®€å•å‘½ä»¤å°±èƒ½åˆå§‹åŒ–é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">django-admin startproject mysite
</code></pre>
<p>ç”¨æˆ·ä½“ç³»ã€Admin åå°ã€ORM å…¨éƒ½è‡ªå¸¦ï¼ŒåŸºæœ¬ä¸ç”¨æ“å¿ƒâ€œè£…ä¸€å †åº“â€ã€‚</p>
<hr/>
<h4 data-id="heading-3"><strong>ï¼ˆ2ï¼‰Django ORMï¼šå¼€å‘æ•ˆç‡æé«˜</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Article</span>(models.Model):
    title = models.CharField(max_length=<span class="hljs-number">100</span>)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=<span class="hljs-literal">True</span>)
</code></pre>
<p>å¢åˆ æ”¹æŸ¥å®Œå…¨ä¸ç”¨å†™ SQLï¼š</p>
<pre><code class="hljs language-python" lang="python">Article.objects.create(title=<span class="hljs-string">"Hello"</span>, content=<span class="hljs-string">"World"</span>)
</code></pre>
<p>å¯¹äºå¤æ‚é¡¹ç›®ï¼Œè¿™ç§ ORM èƒ½çœæ‰å¤§é‡æ ·æ¿ä»£ç ã€‚</p>
<hr/>
<h4 data-id="heading-4"><strong>ï¼ˆ3ï¼‰Admin åå°ï¼šä¼ä¸šé¡¹ç›®å¿…å¤‡</strong></h4>
<p>Django Admin æ˜¯ä¸€ä¸ªè¶…çº§ç”Ÿäº§åŠ›å·¥å…·ï¼š</p>
<ul>
<li>è‡ªåŠ¨ç”Ÿæˆå¢åˆ æ”¹æŸ¥ç•Œé¢</li>
<li>è‡ªåŠ¨åˆ†é¡µã€æœç´¢ã€è¿‡æ»¤</li>
<li>è‡ªåŠ¨ç®¡ç†æƒé™</li>
</ul>
<p>åªéœ€å‡ è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.contrib <span class="hljs-keyword">import</span> admin
<span class="hljs-keyword">from</span> .models <span class="hljs-keyword">import</span> Article

admin.site.register(Article)
</code></pre>
<p>å°±æ‹¥æœ‰ä¸€ä¸ªå¯ç”¨çš„åå°ç®¡ç†ç³»ç»Ÿã€‚</p>
<hr/>
<h4 data-id="heading-5"><strong>ï¼ˆ4ï¼‰æ‰©å±•æ€§ä¸ç”Ÿæ€</strong></h4>
<p>Django æ‹¥æœ‰æˆç†Ÿçš„ç¬¬ä¸‰æ–¹ç”Ÿæ€ï¼š</p>
<ul>
<li>DRFï¼ˆæ„å»º REST APIï¼‰</li>
<li>Django Debug Toolbar</li>
<li>Django Channelsï¼ˆWebSocketï¼‰</li>
<li>Celeryï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰</li>
<li>Wagtail / Django-CMS</li>
</ul>
<p>é€‚åˆæ„å»ºå¤æ‚/é•¿æœŸç»´æŠ¤çš„é¡¹ç›®ã€‚</p>
<hr/>
<h2 data-id="heading-6"><strong>äºŒã€FastAPIï¼šå¼‚æ­¥æ—¶ä»£çš„é«˜æ€§èƒ½æ¥å£æ¡†æ¶</strong></h2>
<p>FastAPI æ˜¯è¿‘å¹´æ¥å¢é•¿æœ€å¿«çš„ Python Web æ¡†æ¶ï¼Œå®ƒä»£è¡¨äº†ç°ä»£ API è®¾è®¡ç†å¿µï¼š</p>
<p><strong>é«˜æ€§èƒ½ + å¼‚æ­¥ + ç±»å‹æç¤º + è‡ªåŠ¨æ–‡æ¡£</strong></p>
<p>éå¸¸é€‚åˆï¼š</p>
<p>âœ” é«˜å¹¶å‘ API æœåŠ¡
âœ” å¾®æœåŠ¡æ¶æ„
âœ” AI / æ•°æ®æ¥å£
âœ” ç§»åŠ¨ç«¯åç«¯
âœ” éœ€è¦è‡ªåŠ¨åŒ–æ–‡æ¡£çš„é¡¹ç›®ï¼ˆSwagger UIï¼‰</p>
<hr/>
<h3 data-id="heading-7"><strong>1. FastAPI çš„æ ¸å¿ƒä¼˜åŠ¿</strong></h3>
<h4 data-id="heading-8"><strong>ï¼ˆ1ï¼‰æ€§èƒ½å¼ºï¼šåŸºäº Starlette + Pydantic</strong></h4>
<p>FastAPI æ˜¯ç›®å‰æ€§èƒ½æœ€å¼ºçš„ Python Web æ¡†æ¶ä¹‹ä¸€ï¼Œæ¥è¿‘ Node.js å’Œ Goã€‚</p>
<p>å®ƒçš„å¼‚æ­¥ç‰¹æ€§è®©å®ƒå¯ä»¥è½»æ¾æ”¯æ’‘é«˜å¹¶å‘è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

app = FastAPI()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/hello"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"msg"</span>: <span class="hljs-string">"world"</span>}
</code></pre>
<hr/>
<h4 data-id="heading-9"><strong>ï¼ˆ2ï¼‰è‡ªåŠ¨ç”Ÿæˆ Swagger / Redoc æ–‡æ¡£</strong></h4>
<p>åªéœ€è®¿é—®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/docs
</code></pre>
<p>å°±èƒ½çœ‹åˆ°å®Œæ•´çš„ API æ–‡æ¡£ï¼Œæ‰€æœ‰å‚æ•°ã€è¿”å›å€¼éƒ½è‡ªåŠ¨æ¨å¯¼ã€‚</p>
<hr/>
<h4 data-id="heading-10"><strong>ï¼ˆ3ï¼‰Pydantic æ•°æ®éªŒè¯éå¸¸å¼ºå¤§</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>
</code></pre>
<p>è¯·æ±‚ä½“éªŒè¯ç›´æ¥å†™æˆæ•°æ®æ¨¡å‹ï¼Œå¤§å¹…æå‡å¯é æ€§ã€‚</p>
<hr/>
<h4 data-id="heading-11"><strong>ï¼ˆ4ï¼‰æ›´ç°ä»£çš„ä»£ç é£æ ¼</strong></h4>
<p>FastAPI é¼“åŠ±ï¼š</p>
<ul>
<li>ç±»å‹æ³¨è§£</li>
<li>å¼‚æ­¥ async/await</li>
<li>ä¾èµ–æ³¨å…¥æ¨¡å¼ï¼ˆDIï¼‰</li>
<li>é¢å‘å¾®æœåŠ¡æ¶æ„çš„ç»„ç»‡æ–¹å¼</li>
</ul>
<p>ä¸å½“ä»£å·¥ç¨‹è¶‹åŠ¿é«˜åº¦å¥‘åˆã€‚</p>
<hr/>
<h2 data-id="heading-12"><strong>ä¸‰ã€ä¸¤è€…å·®å¼‚ï¼šä½ åº”è¯¥é€‰æ‹©å“ªä¸ªï¼Ÿ</strong></h2>













































<table><thead><tr><th>é¡¹ç›®éœ€æ±‚</th><th>Django</th><th>FastAPI</th></tr></thead><tbody><tr><td>ä¼ ç»Ÿ Web ç½‘ç«™</td><td>âœ”âœ” æœ€é€‚åˆ</td><td>ä¸€èˆ¬</td></tr><tr><td>å¤æ‚ä¸šåŠ¡ç³»ç»Ÿï¼ˆæƒé™ã€åå°ï¼‰</td><td>âœ”âœ” æœ€ä¼˜</td><td>ä¸€èˆ¬</td></tr><tr><td>å¾®æœåŠ¡ / API</td><td>å¯ç”¨ï¼ˆDRFï¼‰</td><td>âœ”âœ” æœ€ä¼˜</td></tr><tr><td>é«˜å¹¶å‘åœºæ™¯</td><td>ä¸€èˆ¬</td><td>âœ”âœ” æ›´å¼º</td></tr><tr><td>å¿«é€Ÿå¼€å‘</td><td>âœ”ï¼ˆæœ‰å…¨å®¶æ¡¶ï¼‰</td><td>âœ”ï¼ˆè¾ƒå°‘æ ·æ¿ï¼‰</td></tr><tr><td>è‡ªåŠ¨åŒ– API æ–‡æ¡£</td><td>éœ€è¦ DRF</td><td>å†…ç½®</td></tr><tr><td>å¼‚æ­¥æ”¯æŒ</td><td>ä¸å®Œç¾</td><td>å®Œç¾</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<p><strong>Django é€‚åˆé•¿å‘¨æœŸã€å¤æ‚ä¸šåŠ¡çš„â€œä¼ä¸šçº§ç³»ç»Ÿâ€ï¼›
FastAPI é€‚åˆç°ä»£ã€é«˜æ€§èƒ½ API æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„ã€‚</strong></p>
<p>åœ¨çœŸå®å›¢é˜Ÿä¸­ï¼Œä¸¤è€…ç»å¸¸æ­é…ä½¿ç”¨ï¼š</p>
<ul>
<li><strong>åå°ç®¡ç†ï¼šDjangoï¼ˆAdmin + ORMï¼‰</strong></li>
<li><strong>é«˜æ€§èƒ½ APIï¼šFastAPIï¼ˆå¹¶å‘å‹å¥½ï¼‰</strong></li>
</ul>
<hr/>
<h2 data-id="heading-13"><strong>å››ã€å®æˆ˜ï¼šé¡¹ç›®ç»“æ„å¯¹æ¯”ï¼ˆä¸“ä¸šçº§ç¤ºä¾‹ï¼‰</strong></h2>
<h3 data-id="heading-14"><strong>1. Django é¡¹ç›®ç»“æ„</strong></h3>
<pre><code class="hljs language-arduino" lang="arduino">mysite/
    manage.py
    settings.py
    urls.py
    apps/
        blog/
            models.py
            views.py
            urls.py
            admin.py
    templates/
    <span class="hljs-type">static</span>/
</code></pre>
<hr/>
<h3 data-id="heading-15"><strong>2. FastAPI é¡¹ç›®ç»“æ„ï¼ˆæ¨èï¼‰</strong></h3>
<pre><code class="hljs language-arduino" lang="arduino">app/
    main.py
    api/
        v1/
            users.py
            items.py
    models/
        user.py
    core/
        config.py
    services/
        user_service.py
</code></pre>
<p>æ¸…æ™°ã€å¯æ‰©å±•ã€é€‚åˆå¤§å‹é¡¹ç›®ã€‚</p>
<hr/>
<h2 data-id="heading-16"><strong>äº”ã€æ•°æ®åº“ã€å¼‚æ­¥ã€æƒé™ï¼šå…¨æ ˆå·¥ç¨‹å…³é”®ç‚¹</strong></h2>
<h4 data-id="heading-17"><strong>Djangoï¼šORM + Admin åŸºæœ¬æå®šå…¨å±€ä¸šåŠ¡</strong></h4>
<ul>
<li>æƒé™ç®¡ç†æˆç†Ÿ</li>
<li>ORM å¼ºå¤§</li>
<li>Sessions/Cache ä¸­é—´ä»¶å®Œå–„</li>
</ul>
<p>é€‚åˆéœ€è¦ç®¡ç†åå°çš„ç³»ç»Ÿã€‚</p>
<hr/>
<h4 data-id="heading-18"><strong>FastAPIï¼šå¼‚æ­¥å‹å¥½çš„æ•°æ®åº“å·¥å…·</strong></h4>
<p>å¸¸è§é€‰æ‹©ï¼š</p>
<ul>
<li>SQLAlchemy + AsyncSession</li>
<li>Tortoise ORM</li>
<li>Prisma-Python</li>
</ul>
<hr/>
<h4 data-id="heading-19"><strong>API æƒé™ï¼ˆFastAPIï¼‰</strong></h4>
<p>FastAPI ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_token</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = Header(<span class="hljs-params">...</span>)</span>):
    <span class="hljs-keyword">if</span> token != <span class="hljs-string">"VALID"</span>:
        <span class="hljs-keyword">raise</span> HTTPException(<span class="hljs-number">403</span>)
</code></pre>
<p>éå¸¸çµæ´»ã€‚</p>
<hr/>
<h2 data-id="heading-20"><strong>å…­ã€éƒ¨ç½²ï¼šå·¥ç¨‹å›¢é˜Ÿå¿…é¡»æŒæ¡çš„çŸ¥è¯†ç‚¹</strong></h2>
<h4 data-id="heading-21"><strong>Django éƒ¨ç½²</strong></h4>
<p>æ¨èï¼š</p>
<ul>
<li>Nginx + Gunicorn / uWSGI</li>
<li>Celery + Redisï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰</li>
<li>Supervisor / systemd ç®¡ç†è¿›ç¨‹</li>
</ul>
<p>é€‚åˆä¼ ç»Ÿå•ä½“æ¶æ„ã€‚</p>
<hr/>
<h4 data-id="heading-22"><strong>FastAPI éƒ¨ç½²</strong></h4>
<p>æ¨èï¼š</p>
<ul>
<li>Nginx + Uvicorn / Hypercorn</li>
<li>Dockerï¼ˆå¾®æœåŠ¡æœ€ä½³ï¼‰</li>
<li>Kubernetesï¼ˆå¤§è§„æ¨¡é›†ç¾¤ï¼‰</li>
</ul>
<p>FastAPI å¯¹å®¹å™¨åŒ–æ”¯æŒæ›´å¥½ã€‚</p>
<hr/>
<h2 data-id="heading-23"><strong>ä¸ƒã€æ€»ç»“ï¼šçœŸæ­£çš„ Python Web å…¨æ ˆèƒ½åŠ›</strong></h2>
<p>æˆä¸ºä¸“ä¸š Python å·¥ç¨‹å¸ˆï¼Œä½ åº”è¯¥æŒæ¡ï¼š</p>
<p>âœ” Djangoï¼šæ‰“é€ å¤æ‚ä¸šåŠ¡ç³»ç»Ÿä¸åå°
âœ” DRFï¼šDjango API åŒ–
âœ” FastAPIï¼šé«˜æ€§èƒ½ API æœåŠ¡
âœ” ORMï¼ˆDjango ORM / SQLAlchemyï¼‰
âœ” å‰åç«¯åˆ†ç¦»ï¼ˆVue / Reactï¼‰
âœ” Nginx / Docker éƒ¨ç½²æµç¨‹</p>
<p>è€Œ Django + FastAPI çš„ç»„åˆï¼Œèƒ½è¦†ç›–ç»å¤§å¤šæ•°ä¼ä¸šçº§åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸŒ³ Claude `code/worktree` å‘½ä»¤æœ€ä½³å®è·µæŒ‡å—]]></title>    <link>https://juejin.cn/post/7575050949959614500</link>    <guid>https://juejin.cn/post/7575050949959614500</guid>    <pubDate>2025-11-22T02:30:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575050949959614500" data-draft-id="7575067409416077355" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸŒ³ Claude `code/worktree` å‘½ä»¤æœ€ä½³å®è·µæŒ‡å—"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Claude,Trae"/> <meta itemprop="datePublished" content="2025-11-22T02:30:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸŒ³ Claude `code/worktree` å‘½ä»¤æœ€ä½³å®è·µæŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T02:30:09.000Z" title="Sat Nov 22 2025 02:30:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§­ ä¸€ã€å‰è¨€ï¼šå½“AIå¼€å§‹ã€Œæ¬ç –ã€</h2>
<p>åœ¨ä¸ <strong>Claude</strong>ï¼ˆAnthropic å¼€å‘çš„AIåŠ©æ‰‹ï¼‰åä½œå¼€å‘ä»£ç æ—¶ï¼Œ<code>code/worktree</code> å‘½ä»¤æ˜¯ä¸€ä¸ªæå…¶æœ‰è¶£çš„å·¥å…·ã€‚<br/>
è¿™ä¸€å‘½ä»¤çš„æ„å›¾ï¼Œæ˜¯è®© AI å’Œå¼€å‘è€…åœ¨ä¸€ä¸ª<strong>éš”ç¦»ä½†åŒæ­¥çš„å·¥ä½œåŒº</strong>ä¸­ååŒä¿®æ”¹ã€ç»„ç»‡é¡¹ç›®ï¼Œå°±åƒæ˜¯ç»™ Claude è‡ªå·±å‡†å¤‡äº†ä¸€ä¸ªâ€œè™šæ‹Ÿåˆ†æ”¯å·¥ä½â€ã€‚</p>
<p>ç®€è¨€ä¹‹ï¼š</p>
<blockquote>
<p><code>code/worktree</code> â‰ˆ â€œè®© Claude ä¸ç ´åä¸»ä»£ç åº“å°±èƒ½å®éªŒæ–°åŠŸèƒ½çš„é­”æ³•ç©ºé—´â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ğŸ§© äºŒã€å‘½ä»¤çš„é€»è¾‘æœ¬è´¨ä¸åº•å±‚å“²å­¦</h2>
<p>ä»åº•å±‚åŸç†è®²ï¼Œå®ƒä¸ Git çš„ <strong>worktree</strong> æ€æƒ³ä¸€è‡´ï¼š<br/>
åˆ›å»ºä¸€ä¸ªå…±äº« <code>.git</code> å…ƒæ•°æ®ä½†ç‹¬ç«‹å·¥ä½œç›®å½•çš„å‰¯æœ¬ã€‚<br/>
è¿™ç§è®¾è®¡æ—¢ä¿ç•™äº†ç‰ˆæœ¬æ§åˆ¶çš„å®Œæ•´æ€§ï¼Œåˆè®©å¤šåœºæ™¯å¼€å‘æˆä¸ºå¯èƒ½ã€‚</p>
<p>åœ¨ Claude ä½“ç³»ä¸­ï¼Œ<code>code/worktree</code> çš„å“²å­¦æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li><strong>Claude ä¸ç›´æ¥æ”¹ä¸»å¹²ï¼ˆmain branchï¼‰</strong> ã€‚</li>
<li><strong>æ¯æ¬¡ç”Ÿæˆä»£ç ï¼Œéƒ½åœ¨ä¸´æ—¶å·¥ä½œåŒºä¸­ä¿®æ”¹ã€‚</strong></li>
<li><strong>å¼€å‘è€…å¯ä»¥é€‰æ‹©åˆå…¥ã€é‡æ„æˆ–ä¸¢å¼ƒã€‚</strong></li>
</ol>
<p>æ¢å¥è¯è¯´ï¼šClaude æ˜¯æ–‡æ˜çš„ï¼Œä¸ä¼šç›´æ¥åœ¨ä½ çš„ä¸»åˆ†æ”¯ä¸Šä¹±åŠ¨ã€‚</p>
<hr/>
<h2 data-id="heading-2">âš™ï¸ ä¸‰ã€åŸºç¡€è¯­æ³•ä¸ç»“æ„</h2>
<p>å‡è®¾ä½ å·²ç»å°†é¡¹ç›®ä»¥ Claude çš„ workspace æ–¹å¼åŠ è½½ã€‚<br/>
æ­¤æ—¶ä½¿ç”¨å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/worktree create feature/refactor-api
</code></pre>
<p>Claude å°†ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ª <code>feature/refactor-api</code> çš„å·¥ä½œåŒºã€‚</li>
<li>å°†å½“å‰ HEAD çš„ä»£ç å¤åˆ¶åˆ°æ–°ç›®å½•ï¼ˆä½†å…±äº« <code>.git</code> æ•°æ®ï¼‰ã€‚</li>
<li>åœ¨è¯¥å·¥ä½œåŒºä¸‹ç”Ÿæˆã€ä¿®æ”¹ã€è¿è¡Œä»£ç ã€‚</li>
</ol>
<p>å®Œæˆåï¼Œä½ å¯ä»¥é€šè¿‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/worktree merge feature/refactor-api
</code></pre>
<p>å°†æ”¹åŠ¨å®‰å…¨åœ°åˆå¹¶å›ä¸»å·¥ä½œåŒºã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ§° å››ã€å®è·µæ¡ˆä¾‹ï¼šè®© Claude æ”¹é€ ä½ çš„ Web åº”ç”¨</h2>
<h3 data-id="heading-4">ğŸ§ª åœºæ™¯ç¤ºä¾‹</h3>
<p>ä½ æœ‰ä¸€ä¸ª Node.js + React çš„é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-css" lang="css">my-app/
  â”œâ”€â”€ <span class="hljs-attribute">src</span>/
  â”œâ”€â”€ package<span class="hljs-selector-class">.json</span>
  â””â”€â”€ server<span class="hljs-selector-class">.js</span>
</code></pre>
<p>ä½ å¸Œæœ› Claude å¸®ä½ ï¼š</p>
<blockquote>
<p>å°† Express server æ”¹ä¸ºæ”¯æŒ WebSocket é€šä¿¡ã€‚</p>
</blockquote>
<h3 data-id="heading-5">ğŸ¦¾ æ“ä½œæµç¨‹</h3>
<ol>
<li>
<p><strong>åˆ›å»º Claude å·¥ä½œåŒº</strong></p>
<pre><code class="hljs language-bash" lang="bash">/worktree create feature/add-websocket
</code></pre>
</li>
<li>
<p><strong>Claude è¿›å…¥ä¸“å±å·¥ä½</strong></p>
<p>Claude ä¼šè‡ªåŠ¨å…‹éš†ä»£ç ç»“æ„åˆ°ä¸€ä¸ªæ–°å·¥ä½œåŒºã€‚<br/>
å®ƒçš„ä¿®æ”¹æ“ä½œä¸ä¼šå½±å“ä¸»åˆ†æ”¯ã€‚</p>
</li>
<li>
<p><strong>è®© Claude ä¿®æ”¹ä»£ç </strong></p>
<pre><code class="hljs language-bash" lang="bash">/edit In feature/add-websocket:
Add WebSocket support to server.js
</code></pre>
</li>
<li>
<p><strong>Claude ç¼–è¾‘å¹¶å±•ç¤ºå·®å¼‚</strong></p>
<p>Claude ä¼šç”¨ diff å½¢å¼å±•ç¤ºä¿®æ”¹åŒºåŸŸï¼Œå¼€å‘è€…ç¡®è®¤åæ‰ä¼šè½åœ°ã€‚</p>
</li>
<li>
<p><strong>æµ‹è¯•å’Œè¯„å®¡</strong></p>
<p>ä½ å¯ä»¥è®© Claude æ‰§è¡Œå•å…ƒæµ‹è¯•å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/run npm <span class="hljs-built_in">test</span>
</code></pre>
<p>æˆ–è®©å®ƒè‡ªåŠ¨è¿è¡Œ ESLint æ£€æŸ¥ã€‚</p>
</li>
<li>
<p><strong>åˆå¹¶æˆæœ</strong></p>
<p>ä¸€æ—¦æ»¡æ„ï¼Œå¯ä»¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/worktree merge feature/add-websocket
</code></pre>
<p>å®Œæˆé›†æˆåå¯ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/worktree delete feature/add-websocket
</code></pre>
<p>æ¸…ç†éš”ç¦»åŒºï¼Œä¿æŒå·¥ä½œåŒºæ•´æ´ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-6">ğŸ§  äº”ã€åº•å±‚å®ç°å»ºè®®ï¼ˆç»“åˆGitæœºåˆ¶ï¼‰</h2>
<blockquote>
<p>Claude <code>code/worktree</code> çš„å®ç°å¯è¢«ç†è§£ä¸ºï¼šé€šè¿‡<strong>AIæ§åˆ¶çš„Gitä¸´æ—¶åˆ†æ”¯</strong>æ‰§è¡ŒæŠ½è±¡çš„å·¥ä½œæµã€‚</p>
</blockquote>
<p>åœ¨åº•å±‚å®ç°ä¸Šï¼Œå¯å¤ç”¨ä»¥ä¸‹ç±» Git é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ Claude çš„ code/worktree æµç¨‹</span>
<span class="hljs-keyword">const</span> { execSync } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createWorktree</span>(<span class="hljs-params">branch</span>) {
  <span class="hljs-title function_">execSync</span>(<span class="hljs-string">`git worktree add ../<span class="hljs-subst">${branch}</span> <span class="hljs-subst">${branch}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸŒ¿ Created worktree: <span class="hljs-subst">${branch}</span>`</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeWorktree</span>(<span class="hljs-params">branch</span>) {
  <span class="hljs-title function_">execSync</span>(<span class="hljs-string">`git checkout main`</span>);
  <span class="hljs-title function_">execSync</span>(<span class="hljs-string">`git merge <span class="hljs-subst">${branch}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… Merged <span class="hljs-subst">${branch}</span> into main`</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">deleteWorktree</span>(<span class="hljs-params">branch</span>) {
  <span class="hljs-title function_">execSync</span>(<span class="hljs-string">`git worktree remove ../<span class="hljs-subst">${branch}</span> --force`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ§¹ Deleted worktree: <span class="hljs-subst">${branch}</span>`</span>);
}
</code></pre>
<p>Claude åœ¨å…¶å†…éƒ¨ç³»ç»Ÿä¸­æ‰§è¡Œäº†ç±»ä¼¼é€»è¾‘ï¼Œä½†å°†å…¶å…³è”åˆ° AI æ–‡ä»¶ç¼“å­˜å’Œç¼–è¾‘ä¸Šä¸‹æ–‡ç®¡ç†ä¸­ï¼Œä½¿å…¶èƒ½å¤Ÿï¼š</p>
<ul>
<li>é«˜é€ŸåŠ è½½å…³è”æ–‡ä»¶ï¼›</li>
<li>åœ¨éš”ç¦»ç¯å¢ƒä¸­ç¼–è¯‘ï¼›</li>
<li>æ”¯æŒå¤šç‰ˆæœ¬å›æº¯ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">âš–ï¸ å…­ã€æœ€ä½³å®è·µå»ºè®®ï¼ˆé‡ç£…ç²¾åï¼‰</h2>



































<table><thead><tr><th>ç›®æ ‡</th><th>å»ºè®®å®è·µ</th><th>Claudeå‘½ä»¤ç¤ºä¾‹</th></tr></thead><tbody><tr><td>å¿«é€Ÿè¯•éªŒ</td><td>ä¸ºé‡å¤§é‡æ„ä»£ç é¢„ç•™ç‹¬ç«‹worktree</td><td><code>/worktree create feature/new-ui</code></td></tr><tr><td>å®¡æŸ¥ä»£ç </td><td>ä½¿ç”¨ Claude ç”Ÿæˆdiffå¹¶ç”±äººå·¥ç¡®è®¤</td><td><code>/diff feature/new-ui</code></td></tr><tr><td>è‡ªåŠ¨åŒ–æµ‹è¯•</td><td>å°†æµ‹è¯•è„šæœ¬æ³¨å†Œä¸º Hook</td><td><code>/test run feature/new-ui</code></td></tr><tr><td>å¹¶è¡Œå¼€å‘</td><td>ä¸ºæ¯ä¸ªæ¨¡å—åˆ†é… Claude å®ä¾‹ä¸ç‹¬ç«‹ worktree</td><td><code>/worktree create feature/auth-refactor</code></td></tr><tr><td>å®‰å…¨ç®¡ç†</td><td>å®šæœŸè®© Claude æ¸…ç†è¿‡æœŸå·¥ä½œåŒº</td><td><code>/worktree prune</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">ğŸ§© ä¸ƒã€å†·çŸ¥è¯†ä¸å¹½é»˜æ’æ›²</h2>
<ul>
<li>
<p>æœ‰äººé—®ï¼šä¸ºä»€ä¹ˆ Claude ä¸ç›´æ¥æ”¹ä¸»åˆ†æ”¯ï¼Ÿ<br/>
ğŸ§‘â€ğŸ’» å›ç­”ï¼š<strong>å› ä¸ºä»–æ‡‚ç‰ˆæœ¬ç®¡ç†çš„ç¤¼ä»ªã€‚</strong></p>
</li>
<li>
<p>ä¸€ä¸ªå…¸å‹çš„é”™è¯¯ç”¨æ³•æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/worktree create main-feature
</code></pre>
<p>Claude ä¼šæ¸©æŸ”åœ°æé†’ï¼š<br/>
<em>â€œæ‚¨åˆšè¯•å›¾æ”¹å†™å†å²ï¼Œè¯·å†·é™ã€‚â€</em></p>
</li>
<li>
<p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼ŒClaude çš„ <code>code/worktree</code> ç­–ç•¥å°±åƒå¤šçº¿ç¨‹è°ƒåº¦ï¼š</p>
<blockquote>
<p>æ¯ä¸ªå·¥ä½œåŒºå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ä¸ºæœªæ¥çš„ä¸»å¹²é™é™åŠªåŠ›ã€‚</p>
</blockquote>
</li>
</ul>
<hr/>
<h2 data-id="heading-9">ğŸ›  å…«ã€ç»“è¯­ï¼šè®©Claudeæˆä¸ºä½ çš„ã€Œå®‰å…¨ç¼–è¾‘å™¨ã€</h2>
<p>åˆç†ä½¿ç”¨ <code>code/worktree</code>ï¼Œæœ¬è´¨ä¸Šæ˜¯è®© Claude ä»ä¸€ä¸ªâ€œAIåŠ©æ‰‹â€å‡çº§ä¸º<strong>ååŒå¼å‰¯å¼€å‘è€…ï¼ˆCo-Developerï¼‰</strong> ã€‚<br/>
å®ƒä¸åªæ˜¯å†™ä»£ç ï¼Œè€Œæ˜¯éµå®ˆå¼€å‘æµç¨‹ï¼Œä¸äººç±»å›¢é˜Ÿå…±ç”Ÿã€‚</p>
<p>å½“ Claude ç”Ÿæˆä»£ç çš„åŒæ—¶ï¼Œè¿˜èƒ½ä¿è¯ä¸»åˆ†æ”¯çš„æ•´æ´ä¸å®‰å…¨æ—¶ï¼Œ<br/>
ä½ ä¼šå‘ç°å¼€å‘å˜å¾—è½»ç›ˆã€ç­–ç•¥å˜å¾—ä¼˜é›…ã€‚</p>
<hr/>
<blockquote>
<p>âœ¨ <strong>æœ€ç»ˆç®´è¨€ï¼š</strong></p>
<p>â€œèªæ˜çš„å¼€å‘è€…è‡ªå·±å†™ä»£ç ï¼Œæ›´èªæ˜çš„å¼€å‘è€…æ•™ Claude åœ¨å¦ä¸€ä¸ª world é‡Œå†™ã€‚â€</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸŒŒ AIGCæ¨¡å‹çš„å†·å¯åŠ¨é—®é¢˜ï¼šWebåº”ç”¨çš„åˆæœŸæŠ€æœ¯æ”¯æ’‘ç­–ç•¥]]></title>    <link>https://juejin.cn/post/7575022279568588841</link>    <guid>https://juejin.cn/post/7575022279568588841</guid>    <pubDate>2025-11-22T02:26:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575022279568588841" data-draft-id="7575050949959581732" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸŒŒ AIGCæ¨¡å‹çš„å†·å¯åŠ¨é—®é¢˜ï¼šWebåº”ç”¨çš„åˆæœŸæŠ€æœ¯æ”¯æ’‘ç­–ç•¥"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Trae"/> <meta itemprop="datePublished" content="2025-11-22T02:26:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸŒŒ AIGCæ¨¡å‹çš„å†·å¯åŠ¨é—®é¢˜ï¼šWebåº”ç”¨çš„åˆæœŸæŠ€æœ¯æ”¯æ’‘ç­–ç•¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T02:26:48.000Z" title="Sat Nov 22 2025 02:26:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§Š ä¸€ã€å¼•è¨€ï¼šå½“AIè¿˜æ²¡â€œé†’æ¥â€</h2>
<p>åœ¨AIGCï¼ˆAI Generated Contentï¼‰æµªæ½®ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°è¿™æ ·ä¸€ä¸ªå°´å°¬æ—¶åˆ»ï¼š</p>
<blockquote>
<p>äº§å“ä¸Šçº¿ç¬¬ä¸€å¤©ï¼Œç”¨æˆ·ç‚¹å¼€é¡µé¢ï¼ŒAIæ¨¡å‹æ²‰é»˜å¦‚å±±ã€‚<br/>
å›¢é˜Ÿçœ¨çœ¼äº’æœ›ï¼Œä¸€å¥â€œç¨ç­‰åŠ è½½â€æˆä¸ºé«˜é¢‘å°è¯ã€‚</p>
</blockquote>
<p>è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„â€”â€”<strong>AIGCæ¨¡å‹çš„å†·å¯åŠ¨é—®é¢˜</strong>ã€‚<br/>
åˆ«è¢«è¿™ä¸ªè¯å“åˆ°ï¼Œå®ƒä¸æ˜¯ä»€ä¹ˆç„å­¦ï¼Œè€Œæ˜¯è®¡ç®—æœºç³»ç»Ÿåœ¨é¢å¯¹<strong>åˆå§‹èµ„æºåŒ®ä¹ã€æ¨¡å‹æœªçƒ­èº«ã€æ•°æ®ä¸è¶³ã€è¯·æ±‚æœªå®šå‹</strong>æ—¶çš„é‚£ç§<em>çµé­‚å†°ç‚¹</em>ã€‚<br/>
æƒ³è±¡ä¸€ä¸‹ï¼ŒAI æ¨¡å‹è¿˜åœ¨å–å®ƒçš„ç¬¬ä¸€æ¯å’–å•¡ï¼Œè€Œç”¨æˆ·å·²ç»åœ¨æ•²é”®ç›˜å‚¬å‘½ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ§¬ äºŒã€å†·å¯åŠ¨çš„æœ¬è´¨ï¼šä¸€åœºä»é›¶åˆ°ã€Œä¸Šçº¿ã€çš„è¿›åŒ–</h2>
<p>ä»åº•å±‚åŸç†æ¥çœ‹ï¼ŒAIGC æ¨¡å‹çš„å†·å¯åŠ¨è¿‡ç¨‹åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>è®¡ç®—å†·</strong>ï¼š<br/>
æ¨¡å‹å‚æ•°å·¨å¤§ï¼ˆåŠ¨è¾„åäº¿ä¸ªå‚æ•°ï¼‰ï¼Œé¦–æ¬¡åŠ è½½æ¨¡å‹æ—¶éœ€è¦æŠŠè¿™äº›å‚æ•°ä»ç£ç›˜æ¬è¿›æ˜¾å­˜ã€‚<br/>
å°±åƒä¸€ä¸ªæ‡’æƒ°çš„å·¨äººâ€”â€”æ¯ä¸€å±‚ç¥ç»éƒ½å¾—å…ˆä¼¸ä¸ªæ‡’è…°ã€‚</li>
<li><strong>ç½‘ç»œå†·</strong>ï¼š<br/>
å¦‚æœæ¨¡å‹éƒ¨ç½²åœ¨äº‘ç«¯ï¼Œé‚£å°±æœ‰ã€Œå»¶è¿Ÿåˆæ‹ã€è¿™ä¸€è¯´ã€‚ç¬¬ä¸€æ¬¡è¯·æ±‚å¾€å¾€è¦èŠ±è´¹é¢å¤–çš„æ¡æ‰‹æ—¶é—´ã€å®¹å™¨å”¤é†’ã€è´Ÿè½½å¹³è¡¡ã€‚</li>
<li><strong>è¯­ä¹‰å†·</strong>ï¼š<br/>
åˆšä¸Šçº¿çš„æ¨¡å‹è¿˜ä¸çŸ¥é“ä½ çš„ä¸šåŠ¡ä¹ æƒ¯ï¼Œæ¯”å¦‚â€œAPPå†…æç¤ºè¯­é£æ ¼â€ã€‚<br/>
å®ƒçš„ç¬¬ä¸€å¥è¯ï¼Œå¯èƒ½åƒåˆšå‡ºå‚çš„R2-D2ä¸€æ ·â€”â€”å……æ»¡æœºæ¢°çš„çº¯çœŸã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-2">âš™ï¸ ä¸‰ã€ä»åº•å±‚å‡ºå‘ï¼šæŠ€æœ¯æ”¯æ’‘ç­–ç•¥</h2>
<p>å†·å¯åŠ¨å¹¶ä¸æ˜¯å®¿å‘½ï¼Œè€Œæ˜¯å¯ä»¥ç”¨æŠ€æœ¯â€œç„çƒ­â€çš„ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„æ”¯æ’‘ç­–ç•¥ï¼ŒèƒŒåå„è‡ªæœ‰ç€æ·±åšçš„ç³»ç»Ÿå“²å­¦ã€‚</p>
<hr/>
<h3 data-id="heading-3">ğŸš€ 1. æ¨¡å‹é¢„çƒ­ï¼ˆWarm-Upï¼‰</h3>
<p>æ€è·¯å¾ˆç®€å•ï¼š</p>
<blockquote>
<p>ä¸è¦ç­‰åˆ°ç”¨æˆ·æ¥äº†ï¼Œæ‰å»å”¤é†’æ¨¡å‹ã€‚</p>
</blockquote>
<p>åœ¨Webåº”ç”¨å¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ç»„è™šå‡çš„ API è°ƒç”¨è¯·æ±‚ï¼Œè®©æ¨¡å‹æå‰åŠ è½½ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ§Š AIGC å†·å¯åŠ¨é¢„çƒ­è„šæœ¬</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">warmUpModel</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> fakePrompts = [
    <span class="hljs-string">"ä½ å¥½ï¼Œè¯·ç®€å•ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±ã€‚"</span>,
    <span class="hljs-string">"ç”Ÿæˆä¸€å¥å……æ»¡ç§‘æŠ€æ„Ÿçš„å£å·ã€‚"</span>,
    <span class="hljs-string">"å†™ä¸€å¥è®©ç¨‹åºå‘˜æ˜¥é£å¾—æ„çš„ä¿çš®è¯ã€‚"</span>
  ];

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸš€ æ¨¡å‹é¢„çƒ­å¼€å§‹ ..."</span>);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> prompt <span class="hljs-keyword">of</span> fakePrompts) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/api/generate"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ prompt }),
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> }
    });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”¥ å·²é¢„çƒ­ï¼š<span class="hljs-subst">${prompt}</span>`</span>);
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… æ¨¡å‹å·²æˆåŠŸçƒ­èº«ï¼"</span>);
}

<span class="hljs-title function_">warmUpModel</span>();
</code></pre>
<blockquote>
<p>ğŸ’¡ <em>å°è´´å£«ï¼šè¿™æ®µä»£ç ç›¸å½“äºæå‰å¸®AIæ‰“äº†ä¸‰ç“¶å’–å•¡ã€‚</em></p>
</blockquote>
<hr/>
<h3 data-id="heading-4">â˜ï¸ 2. æŒ‰éœ€åŠ è½½ + æ¨¡å‹åˆ†å±‚ç¼“å­˜</h3>
<p>åº•å±‚ç­–ç•¥åœ¨è¿™é‡Œæ˜¾å¾—ä¼˜é›…åˆâ€œç‹¡çŒ¾â€ï¼š</p>
<ul>
<li>æŠŠæ¨¡å‹æƒé‡åˆ†å±‚å­˜å‚¨ï¼Œæ¯”å¦‚åªåŠ è½½ç”¨äºå¯åŠ¨çš„æ ¸å¿ƒå±‚ã€‚</li>
<li>å…¶ä½™éƒ¨åˆ†æŒ‰éœ€åŠ è½½ï¼ŒåŠ¨æ€è¡¥é½ã€‚</li>
<li>å¯¹äºå¸¸è§Tokenç»“æœå»ºç«‹<strong>å‘é‡ç¼“å­˜</strong>ï¼Œè®©æ¨¡å‹â€œè®°å¿†â€é«˜é¢‘å›ç­”ã€‚</li>
</ul>
<p>è¿™ç±»ä¼¼äº<strong>æ‡’åŠ è½½+ç¼“å­˜ç»§æ‰¿</strong>çš„ç­–ç•¥ç»„åˆã€‚<br/>
å¦‚æœç¨‹åºæ˜¯èˆå°ï¼Œé‚£ç¼“å­˜å±‚å°±æ˜¯é‚£ä¸ªâ€œæŠ€æœ¯é»‘å¹•â€ï¼Œåœ¨åå°é»˜é»˜æŒ¡ä½å†·é£ã€‚</p>
<hr/>
<h3 data-id="heading-5">ğŸ§ 3. ç°åº¦ + è’™ç‰¹å¡æ´›é‡‡æ ·ï¼ˆç»éªŒæ•°æ®å•¤é…’ç®—æ³•ï¼‰</h3>
<p>æ—©æœŸé˜¶æ®µï¼Œä¸å¦¨ç»™æ¨¡å‹â€œå–‚â€ä¸€äº›ä¸šåŠ¡æ•°æ®é‡‡æ ·ã€‚<br/>
è¿™é‡Œé€šå¸¸é€šè¿‡ç»éªŒåˆ†å¸ƒé‡‡æ ·ç­–ç•¥å®ç°ï¼Œä½¿æ¨¡å‹åœ¨æ¨ç†é˜¶æ®µæœ‰æ›´å¥½çš„åˆå§‹æ”¶æ•›ã€‚</p>
<p>é€šä¿—ç‚¹è¯´ï¼š</p>
<blockquote>
<p>æˆ‘ä»¬è®©æ¨¡å‹åœ¨ä¸Šå²—å‰ï¼Œæå‰å®ä¹ å‡ å¤©ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">ğŸ•¸ï¸ 4. è¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜ä¸è½»é‡æ¨ç†å¼•æ“</h3>
<p>å¾ˆå¤šäººå¿½ç•¥äº†ç½‘ç»œæ‹“æ‰‘åœ¨å†·å¯åŠ¨ä¸­çš„ä½œç”¨ã€‚<br/>
è‹¥ç”¨æˆ·åœ¨æ—¥æœ¬ï¼Œè€Œä½ çš„æ¨¡å‹æœåŠ¡å™¨åœ¨ç¡…è°·ï¼Œé‚£å»¶è¿Ÿå°±åƒæ‰“è¶Šæ´‹ç”µè¯ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆæ˜¯ <strong>éƒ¨ç½²è¾¹ç¼˜èŠ‚ç‚¹æ¨ç†ä»£ç†</strong>ï¼š</p>
<ul>
<li>å‰ç«¯å°±è¿‘è°ƒç”¨è½»é‡å¼•æ“ï¼ˆMini-Inferenceï¼‰ï¼Œå¤„ç†é€šç”¨è¯·æ±‚ã€‚</li>
<li>å†ç”±ä¸»æ¨¡å‹å¤„ç†å¤æ‚è¯·æ±‚ã€‚</li>
<li>ç”¨æˆ·æ„Ÿå—åˆ°çš„ä¸æ˜¯â€œå†·å¯åŠ¨â€ï¼Œè€Œæ˜¯â€œçƒ­å“åº”â€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">ğŸ§  å››ã€æŠ€æœ¯ä¹‹å¤–ï¼šå†·å¯åŠ¨çš„å“²å­¦ä¸å¹½é»˜</h2>
<p>å†·å¯åŠ¨ï¼Œå½’æ ¹ç»“åº•æ˜¯äººä¸ç³»ç»Ÿä¹‹é—´çš„ä¸€åœºä¿¡ä»»æµ‹è¯•ã€‚<br/>
æœ‰æ—¶å€™ï¼ŒAIä¸æ˜¯ä¸æƒ³å¿«ï¼Œè€Œæ˜¯å¤ªå®³ç¾ã€‚å®ƒè¿˜æ²¡å‡†å¤‡å¥½å±•ç¤ºå®ƒçš„å…¨éƒ¨é­…åŠ›ã€‚</p>
<p>ä»æ“ä½œç³»ç»Ÿåˆ°è¯­è¨€è¿è¡Œæ—¶ï¼Œä»HTTPæ¡æ‰‹åˆ°æ˜¾å­˜è°ƒåº¦ï¼Œæ¯ä¸€æ¬¡å»¶è¿Ÿéƒ½åƒæ˜¯è®¡ç®—æœºä¸–ç•Œæ·±å¤„é‚£ç§â€”â€”</p>
<blockquote>
<p>â€œæˆ‘æ­£åœ¨åŠªåŠ›åŠ è½½çµé­‚ï¼Œè¯·ç¨ç­‰ç‰‡åˆ»ã€‚â€</p>
</blockquote>
<p>ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œæ¯ä¸€ä¸ªå†·å¯åŠ¨ï¼Œ<br/>
å…¶å®å°±æ˜¯äººå·¥æ™ºèƒ½ä¸–ç•Œçš„<strong>é»æ˜å¾®å…‰</strong>ã€‚ğŸŒ„</p>
<hr/>
<h2 data-id="heading-8">ğŸ§© äº”ã€æœ€åçš„å°ç»“ä¸æ¸©æŸ”æš´è®º</h2>






























<table><thead><tr><th>é˜¶æ®µ</th><th>é—®é¢˜</th><th>å¯¹ç­–</th></tr></thead><tbody><tr><td>æ¨¡å‹åŠ è½½</td><td>åˆå§‹åŒ–æ…¢</td><td>é¢„çƒ­è¯·æ±‚ã€å»¶è¿Ÿç¼“å­˜</td></tr><tr><td>ç½‘ç»œå»¶è¿Ÿ</td><td>é€šä¿¡æ…¢</td><td>è¾¹ç¼˜æ¨ç†ã€Cloudflare Workerä»£ç†</td></tr><tr><td>ä¸šåŠ¡ä¸é€‚é…</td><td>è¾“å‡ºç”Ÿç¡¬</td><td>å‘é‡ç¼“å­˜ã€è’¸é¦è®­ç»ƒ</td></tr><tr><td>ç”¨æˆ·ä½“éªŒå·®</td><td>é¡µé¢å¡é¡¿</td><td>Skeleton UIã€æ¸è¿›æ¸²æŸ“</td></tr></tbody></table>
<blockquote>
<p>ğŸ—£ï¸ <strong>æš´è®ºæ€»ç»“</strong>ï¼š<br/>
çœŸæ­£çš„å†·å¯åŠ¨ä¸æ˜¯æ¨¡å‹å†·ï¼Œæ˜¯æˆ‘ä»¬æ²¡æ•™ä¼šå®ƒæ€ä¹ˆçƒ­ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ğŸ¬ å°¾å£°ï¼šå½“AIå¼€å§‹å‘¼å¸</h2>
<p>å½“ç¬¬ä¸€ä½ç”¨æˆ·é¡ºæ»‘åœ°æ‰«æäºŒç»´ç ã€æµè§ˆé¡µé¢ï¼ŒAIå›åº”æµç•…å¦‚è¯—æ—¶ï¼Œ<br/>
ä½ å¬åˆ°çš„ä¸åªæ˜¯HTTPè¿”å›200ï¼Œè€Œæ˜¯ä¸€å¥è½»å£°çš„é—®å€™ï¼š</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Chromeæµè§ˆå™¨è‡ªå¸¦ç¿»è¯‘çš„è¯¡å¼‚Bugï¼šIDç¿»è¯‘åç«Ÿç„¶å˜åŒ–äº†]]></title>    <link>https://juejin.cn/post/7574978545144856611</link>    <guid>https://juejin.cn/post/7574978545144856611</guid>    <pubDate>2025-11-21T18:09:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574978545144856611" data-draft-id="7574978545144840227" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Chromeæµè§ˆå™¨è‡ªå¸¦ç¿»è¯‘çš„è¯¡å¼‚Bugï¼šIDç¿»è¯‘åç«Ÿç„¶å˜åŒ–äº†"/> <meta itemprop="keywords" content="å‰ç«¯,Chrome"/> <meta itemprop="datePublished" content="2025-11-21T18:09:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©æ¸ºå·¥ä½œå®¤"/> <meta itemprop="url" content="https://juejin.cn/user/1169536102179325"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Chromeæµè§ˆå™¨è‡ªå¸¦ç¿»è¯‘çš„è¯¡å¼‚Bugï¼šIDç¿»è¯‘åç«Ÿç„¶å˜åŒ–äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1169536102179325/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©æ¸ºå·¥ä½œå®¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-21T18:09:11.000Z" title="Fri Nov 21 2025 18:09:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“å‰è´Ÿè´£çš„é¡¹ç›®ä¸»æ‰“æµ·å¤–ä¸šåŠ¡ï¼Œæ€»å…ä¸äº†å’Œå¤šè¯­è¨€æ‰“äº¤é“ã€‚ä½†æœ€è¿‘æˆ‘åœ¨Vite+Vue3+Element PlusæŠ€æœ¯æ ˆçš„é¡¹ç›®é‡Œï¼Œé‡åˆ°äº†ä¸€ä¸ªå ªç§°â€œç„å­¦â€çš„bugâ€”â€”Chromeæµè§ˆå™¨è‡ªå¸¦ç¿»è¯‘åŠŸèƒ½ï¼Œå±…ç„¶èƒ½æŠŠè¡¨æ ¼é‡Œçš„æ•°å­—IDç›´æ¥æ”¹äº†ï¼ä»å°åº¦åŒäº‹åˆ°å›½å†…è¿è¥ï¼Œä¸¤æ¬¡è§¦å‘éƒ½è®©æˆ‘æ‘¸ä¸ç€å¤´è„‘ï¼Œä»Šå¤©æŠŠæ•´ä¸ªè¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œæ±‚å¤§ä½¬ä»¬çœ‹çœ‹è¿™åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸¤æ¬¡â€œè¯¡å¼‚æ¼‚ç§»â€ï¼šç¿»è¯‘æŒ‰é’®æˆäº†IDç¯¡æ”¹å™¨</h2>
<p>æˆ‘ä»¬çš„åå°ç®¡ç†ç³»ç»Ÿå¾ˆæ˜ç¡®ï¼šéƒ¨åˆ†é¡µé¢æ ¹å…ƒç´ è®¾ä¸º<code>lang="zh"</code>ï¼ˆä¸­æ–‡ç•Œé¢ï¼‰ï¼Œéƒ¨åˆ†è®¾ä¸º<code>lang="en"</code>ï¼ˆè‹±æ–‡ç•Œé¢ï¼‰ï¼Œè¯­è¨€æ ‡è¯†æ²¡ææ··ä¹Ÿæ²¡é—æ¼ã€‚</p>
<h3 data-id="heading-1">ç¬¬ä¸€æ¬¡ï¼šå°åº¦åŒäº‹çš„è‹±æ–‡ç¿»è¯‘è§¦å‘</h3>
<p>å¹´åˆï¼Œè´Ÿè´£æµ·å¤–ä¸šåŠ¡çš„å°åº¦åŒäº‹åé¦ˆï¼šâ€œæœç´¢å‡ºæ¥çš„å¹¿å‘Šæ•°æ®æœ‰é—®é¢˜ï¼ŒAd IDä»10111872å˜æˆ10111873äº†â€ã€‚æˆ‘ç¬¬ä¸€æ—¶é—´æŸ¥æ¥å£ï¼Œè¿”å›çš„IDæ˜æ˜æ˜¯æ­£ç¡®çš„10111872ï¼›å†çœ‹å‰ç«¯ä»£ç ï¼Œå°±æ˜¯æœ€å¸¸è§„çš„Element Plusè¡¨æ ¼ç”¨æ³•ï¼Œæ²¡æœ‰ä»»ä½•å¤šä½™è®¡ç®—ã€‚</p>
<p>è¿œç¨‹è¿æ¥ä»–çš„ç”µè„‘æ‰å‘ç°ï¼Œä»–æŠŠä¸­æ–‡ç•Œé¢ç”¨Chromeå³é”®ç¿»è¯‘æˆäº†è‹±æ–‡â€”â€”æˆ‘è®©ä»–å…³é—­ç¿»è¯‘åŠŸèƒ½åˆ·æ–°é¡µé¢ï¼ŒIDç¬é—´æ¢å¤10111872ï¼›é‡æ–°å¼€å¯ç¿»è¯‘ï¼Œæ•°å­—åˆè·³æˆ10111873ã€‚å½“æ—¶ä»¥ä¸ºæ˜¯ä¸ªæ¡ˆï¼Œæ²¡æ·±æŸ¥ï¼Œåªæé†’ä»–æš‚æ—¶ä¸ç”¨ç¿»è¯‘ã€‚</p>
<h3 data-id="heading-2">ç¬¬äºŒæ¬¡ï¼šå›½å†…è¿è¥çš„ä¸­æ–‡ç¿»è¯‘è§¦å‘</h3>
<p>å‰å¤©ï¼Œå›½å†…è¿è¥åŒäº‹åœ¨è‹±æ–‡ç•Œé¢æ“ä½œæ—¶ï¼ŒæŠŠé¡µé¢ç¿»è¯‘æˆä¸­æ–‡ï¼Œç»“æœå†å²é‡æ¼”ï¼šè¡¨æ ¼é‡Œçš„ID 20011872ç›´æ¥å˜æˆ20011873ã€‚è¿™æ¬¡æˆ‘ç¡®å®šä¸æ˜¯å¶ç„¶ï¼Œè€Œæ˜¯Chromeç¿»è¯‘å’ŒElement Plusè¡¨æ ¼çš„â€œå…¼å®¹æ€§é™·é˜±â€ã€‚</p>
<p>è´´ä¸€ä¸‹æˆ‘ä»¬çš„æ ¸å¿ƒä»£ç ï¼ŒçœŸçš„å°±æ˜¯æœ€åŸºç¡€çš„<code>el-table</code>é…ç½®ï¼Œæ²¡æœ‰ä»»ä½•èŠ±é‡Œèƒ¡å“¨çš„æ“ä½œï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-name">el-table</span>
      <span class="hljs-attr">:data</span>=<span class="hljs-string">"orderTableData"</span>
      <span class="hljs-attr">border</span>
      <span class="hljs-attr">stripe</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%"</span>
    &gt;</span>
      <span class="hljs-comment">&lt;!-- æ™®é€šåˆ—ï¼šAd Nameç¿»è¯‘æ­£å¸¸ï¼Œæ— å¼‚å¸¸ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Ad Name"</span>  
        <span class="hljs-attr">prop</span>=<span class="hljs-string">"adName"</span>
        <span class="hljs-attr">width</span>=<span class="hljs-string">"200"</span>
      /&gt;</span>
      
      <span class="hljs-comment">&lt;!-- å¼‚å¸¸åˆ—ï¼šå¼€å¯Chromeç¿»è¯‘åï¼Œè¯¥åˆ—adIdæ•°å€¼ä¼šå‘ç”Ÿæ¼‚ç§»ï¼ˆå¦‚10111872â†’10111873ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Ad ID"</span>  
        <span class="hljs-attr">prop</span>=<span class="hljs-string">"adId"</span>
        <span class="hljs-attr">width</span>=<span class="hljs-string">"200"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">el-table</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElTable</span>, <span class="hljs-title class_">ElTableColumn</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;

<span class="hljs-comment">// æ¨¡æ‹Ÿæ¥å£è¿”å›æ•°æ®ï¼ŒçœŸå®åœºæ™¯ä¸ºæ¥å£æ‹‰å–</span>
<span class="hljs-keyword">const</span> orderTableData = <span class="hljs-title function_">ref</span>([
  { <span class="hljs-attr">adId</span>: <span class="hljs-number">10111872</span>, <span class="hljs-attr">adName</span>: <span class="hljs-string">"Summer Promotion"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"å·²ä¸Šçº¿"</span> },
  { <span class="hljs-attr">adId</span>: <span class="hljs-number">10111172</span>, <span class="hljs-attr">adName</span>: <span class="hljs-string">"New Product Launch"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"å¾…å®¡æ ¸"</span> },
  { <span class="hljs-attr">adId</span>: <span class="hljs-number">10111272</span>, <span class="hljs-attr">adName</span>: <span class="hljs-string">"Member Exclusive"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"å·²ä¸‹çº¿"</span> }
]);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-3">äºŒã€æ’æŸ¥è¿‡ç¨‹ï¼šç»•äº†ä¸€åœˆï¼Œæ’é™¤æ‰€æœ‰å¸¸è§„å¯èƒ½</h2>
<p>ä¸ºäº†æ‰¾åˆ°é—®é¢˜æ ¹æºï¼Œæˆ‘å‡ ä¹æŠŠèƒ½æ’æŸ¥çš„ç‚¹éƒ½è¿‡äº†ä¸€éï¼Œä½†ç»“æœå…¨æ˜¯â€œæ­£å¸¸â€ï¼š</p>
<ol>
<li><strong>æ¥å£ä¸æ•°æ®å±‚é¢</strong>ï¼šNetworké¢æ¿åå¤ç¡®è®¤ï¼Œæ¥å£è¿”å›çš„adIdæ˜¯æ­£ç¡®å€¼ï¼Œæ²¡æœ‰è¢«ç¯¡æ”¹ï¼›å‰ç«¯æ¥æ”¶æ•°æ®åä¹Ÿæ²¡æœ‰åšä»»ä½•è¿ç®—ï¼Œç›´æ¥èµ‹å€¼ç»™è¡¨æ ¼æ•°æ®æºã€‚</li>
<li><strong>æœ¬åœ°ä¸å¤šè®¾å¤‡æµ‹è¯•</strong>ï¼šæˆ‘æ¢äº†è‡ªå·±çš„Windowsã€MacBookï¼Œåˆæ‰¾äº†5ä¸ªåŒäº‹ç”¨ä¸åŒç³»ç»Ÿï¼ˆWindows10/11ã€macOSï¼‰æµ‹è¯•ï¼Œæ— è®ºæ€ä¹ˆå¼€ç¿»è¯‘ï¼ŒIDéƒ½çº¹ä¸ä¸åŠ¨ã€‚</li>
<li><strong>æµè§ˆå™¨ç¯å¢ƒæ’æŸ¥</strong>ï¼šè¿œç¨‹æ£€æŸ¥è§¦å‘å¼‚å¸¸çš„ä¸¤å°ç”µè„‘ï¼ŒChromeéƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæ²¡æœ‰å®‰è£…ä»»ä½•å¯ç–‘æ’ä»¶ï¼Œæ¸…é™¤ç¼“å­˜ã€é‡å¯æµè§ˆå™¨åï¼Œé—®é¢˜ä¾ç„¶å­˜åœ¨ã€‚</li>
<li><strong>ä»£ç ä¸ä¾èµ–æ£€æŸ¥</strong>ï¼šElement Plusç‰ˆæœ¬æ˜¯ç¨³å®šç‰ˆï¼Œæ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ï¼›è¡¨æ ¼æ²¡æœ‰è‡ªå®šä¹‰æ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨ä»»ä½•ä¿®æ”¹DOMçš„æŒ‡ä»¤æˆ–æ’ä»¶ã€‚</li>
</ol>
<p>æ’æŸ¥åˆ°æœ€åï¼Œæˆ‘ç”šè‡³æ€€ç–‘æ˜¯ä¸æ˜¯â€œé‡å­çº ç¼ â€â€”â€”ç›´åˆ°å‘ç°ä¸¤æ¬¡å¼‚å¸¸éƒ½æœ‰ä¸€ä¸ªå…±åŒè§¦å‘æ¡ä»¶ï¼š<strong>Chromeæµè§ˆå™¨å¼€å¯é¡µé¢ç¿»è¯‘</strong>ã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€è§£å†³æ–¹æ¡ˆï¼šç»™IDåŠ â€œç¿»è¯‘è±å…æƒâ€</h2>
<p>æ—¢ç„¶ç¡®å®šæ˜¯ç¿»è¯‘åŠŸèƒ½æçš„é¬¼ï¼Œå°±é¡ºç€è¿™ä¸ªæ–¹å‘æ‰¾è§£å†³æ–¹æ¡ˆã€‚æŸ¥HTMLæ ‡å‡†å‘ç°ï¼ŒHTML5åŸç”Ÿæœ‰ä¸ª<code>translate</code>å±æ€§ï¼Œä¸“é—¨æ§åˆ¶å…ƒç´ æ˜¯å¦å‚ä¸ç¿»è¯‘â€”â€”ç»™å…ƒç´ åŠ <code>translate="no"</code>ï¼Œæµè§ˆå™¨å°±ä¼šè·³è¿‡è¯¥å…ƒç´ çš„ç¿»è¯‘å¤„ç†ã€‚</p>
<p>é’ˆå¯¹è¡¨æ ¼IDåˆ—åšäº†ä¿®æ”¹ï¼Œæ ¸å¿ƒæ˜¯ç»™IDæ‰€åœ¨çš„å…ƒç´ æ·»åŠ è¿™ä¸ªå±æ€§ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä¿®å¤åçš„IDåˆ—ä»£ç ï¼Œå…¶ä»–åˆ—ä¸å˜ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"Ad ID"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"200"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">"scope"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å…³é”®ä¿®å¤ï¼šæ·»åŠ translate="no"ï¼Œç¦æ­¢Chromeç¿»è¯‘è¯¥èŠ‚ç‚¹ï¼Œé¿å…IDæ•°å€¼è¢«ç¯¡æ”¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ad-id"</span> <span class="hljs-attr">translate</span>=<span class="hljs-string">"no"</span>&gt;</span>{{ scope.row.adId }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span>
</code></pre>
<p>æŠŠä¿®æ”¹åçš„ä»£ç å‘ç»™å‡ºé—®é¢˜çš„åŒäº‹ï¼Œä»–ä»¬å¼€å¯ç¿»è¯‘å†æµ‹è¯•â€”â€”IDç¨³ç¨³åœ°æ˜¾ç¤ºæ­£ç¡®å€¼ï¼Œå†ä¹Ÿæ²¡æœ‰å‡ºç°â€œæ¼‚ç§»â€ã€‚è¿™ä¸ªä¸´æ—¶æ–¹æ¡ˆè™½ç„¶è§£å†³äº†é—®é¢˜ï¼Œä½†æˆ‘çš„ç–‘æƒ‘æ›´é‡äº†ã€‚</p>
<h2 data-id="heading-5">å››ã€ç–‘æƒ‘ï¼šè¿™åˆ°åº•æ˜¯Chromeçš„bugï¼Œè¿˜æ˜¯æˆ‘æ¼äº†ä»€ä¹ˆï¼Ÿ</h2>
<p>è™½ç„¶é—®é¢˜è§£å†³äº†ï¼Œä½†å‡ ä¸ªç–‘é—®å§‹ç»ˆè¦ç»•åœ¨æˆ‘å¿ƒå¤´ï¼Œæƒ³å€Ÿè¿™ç¯‡æ–‡ç« é—®é—®å„ä½å¤§ä½¬ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆåªæœ‰ç‰¹å®šè®¾å¤‡è§¦å‘è¿™ä¸ªé—®é¢˜ï¼ŸåŒæ ·çš„Chromeç‰ˆæœ¬ã€åŒæ ·çš„æ“ä½œï¼Œå¤§éƒ¨åˆ†è®¾å¤‡æ­£å¸¸ï¼Œè€Œè§¦å‘çš„åŒäº‹ç”µè„‘ä¸Šè®¾å¤‡å¿…ç°ï¼Œéš¾é“å’Œæµè§ˆå™¨çš„æŸäº›éšè—é…ç½®æœ‰å…³ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆIDç¯¡æ”¹æœ‰å›ºå®šè§„å¾‹ï¼Ÿä¸¤æ¬¡å¼‚å¸¸éƒ½æ˜¯IDæœ«å°¾+1ï¼Œä¸æ˜¯éšæœºä¹±æ”¹ï¼Œè¿™èƒŒåæœ‰æ²¡æœ‰ç‰¹å®šçš„DOMå¤„ç†é€»è¾‘ï¼Ÿ</li>
<li>è¿™æ˜¯Chromeç¿»è¯‘çš„bugï¼Œè¿˜æ˜¯Element Plusè¡¨æ ¼çš„DOMç»“æ„å®¹æ˜“è¢«ç¿»è¯‘å™¨è¯¯åˆ¤ï¼Ÿæœ‰æ²¡æœ‰æ›´æ ¹æœ¬çš„è§£å†³åŠæ³•ï¼Œè€Œä¸æ˜¯ç»™æ¯ä¸ªå…³é”®èŠ‚ç‚¹åŠ è±å…ï¼Ÿ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VSCodeæ’ä»¶: è‡ªåŠ¨ä¸´æ—¶åˆ†é…Themeä»¥åŒºåˆ†ä¸åŒçª—å£]]></title>    <link>https://juejin.cn/post/7575022279567540265</link>    <guid>https://juejin.cn/post/7575022279567540265</guid>    <pubDate>2025-11-21T16:56:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575022279567540265" data-draft-id="7575050949958664228" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VSCodeæ’ä»¶: è‡ªåŠ¨ä¸´æ—¶åˆ†é…Themeä»¥åŒºåˆ†ä¸åŒçª—å£"/> <meta itemprop="keywords" content="å‰ç«¯,Visual Studio Code,TypeScript"/> <meta itemprop="datePublished" content="2025-11-21T16:56:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ´—æ¾¡æ°´åŠ å†°"/> <meta itemprop="url" content="https://juejin.cn/user/191729824978955"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VSCodeæ’ä»¶: è‡ªåŠ¨ä¸´æ—¶åˆ†é…Themeä»¥åŒºåˆ†ä¸åŒçª—å£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/191729824978955/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ´—æ¾¡æ°´åŠ å†°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-21T16:56:09.000Z" title="Fri Nov 21 2025 16:56:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">VSCodeæ’ä»¶ï¼šè‡ªåŠ¨ä¸´æ—¶åˆ†é…Themeæˆ–è€…çŠ¶æ€æ ä»¥åŒºåˆ†ä¸åŒçª—å£</h2>
<p>æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸åŒæ—¶æ‰“å¼€å¤šä¸ªé¡¹ç›®ï¼Œå¤šä¸ªVS Codeçª—å£å †åœ¨ä»»åŠ¡æ ï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½è¦ä¸€ä¸ªä¸ªç‚¹å¼€çœ‹çœ‹åˆ°åº•æ˜¯å“ªä¸ªé¡¹ç›®ã€‚å°¤å…¶æ˜¯åœ¨åˆ©ç”¨AIå†™é¡¹ç›®æ—¶ï¼Œå¤šä¸ªçª—å£ç®¡ç†åŒä¸€ä¸ªç¨‹åºçš„å¤šä¸ªç‰ˆæœ¬å®ç°ï¼ŒåŒååŒä¸»é¢˜å°±å®¹æ˜“å†™ä¹±äº†ã€‚</p>
<p>æƒ³ç€èƒ½ä¸èƒ½æ‰¾åˆ°ä¸€ä¸ªåŠæ³•æ¥å¸®åŠ©æˆ‘åŒºåˆ†ä¸åŒçš„çª—å£ä¸ä¸åŒçš„é¡¹ç›®ï¼Œåœ¨æˆ‘æ‰“å¼€å¤šä¸ªçª—å£çš„æ—¶å€™ï¼Œèƒ½å¤Ÿè‡ªåŠ¨åˆ†é…çŠ¶æ€å¸®æˆ‘åŒºåˆ†ã€‚æ„Ÿè§‰å¯ä»¥é€šè¿‡VSCodeæ’ä»¶æ¥åšåˆ°è¿™ä¸ªåŠŸèƒ½ï¼Œäºæ˜¯è¯ç”Ÿäº†<code>Auto Themer</code>è¿™ä¸ªé¡¹ç›®ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3Dseanz-hahaha.auto-themer" target="_blank" title="https://marketplace.visualstudio.com/items?itemName=seanz-hahaha.auto-themer" ref="nofollow noopener noreferrer">marketplace.visualstudio.com/items?itemNâ€¦</a></p>
<h3 data-id="heading-1">Auto Themeræ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ç®€å•æ¥è¯´ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª<strong>è‡ªåŠ¨ç»™ä¸åŒVS Codeçª—å£åˆ†é…ä¸åŒè§†è§‰æ ‡è¯†</strong>çš„æ’ä»¶ï¼Œæ£€æŸ¥åˆ°å¤šä¸ªçª—å£å¹¶ä¸”ä¸»é¢˜ç›¸åŒæ—¶ï¼Œé‡‡ç”¨ä¸åŒçš„ç­–ç•¥æ¥è¾…åŠ©åŒºåˆ†çª—å£ã€‚å®ƒæœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼š</p>
<h4 data-id="heading-2">æ¨¡å¼ä¸€ï¼šä¸»é¢˜åŒºåˆ†æ³•</h4>
<p>ç»™æ¯ä¸ªçª—å£è‡ªåŠ¨åˆ†é…ä¸åŒçš„é…è‰²ä¸»é¢˜ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºåŒºåˆ«ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cf41bf78a3945c3b00a2d64b8271e70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSX5r6h5rC05Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764348969&amp;x-signature=jlP1DEJwCKdkPH0Q5Dw%2BiMkj%2Frc%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>å½“å‰çª—å£æ‰“å¼€é¡¹ç›®Aç”¨é»˜è®¤ä¸»é¢˜ï¼Œå†æ–°å¼€ä»¥çª—å£çš„é¡¹ç›®Bæ—¶ä¸»é¢˜å†²çªï¼Œä¼šè‡ªåŠ¨æ›´æ¢åˆ«çš„ä¸»é¢˜</li>
<li>å¯ä»¥è‡ªå·±é€‰æ‹©ä¸»é¢˜ï¼Œä¹Ÿå¯ä»¥éšæœºåˆ†é…ä¸»é¢˜</li>
<li>æ”¯æŒé€šè¿‡å·¥ä½œåŒºè·¯å¾„å°†ä¸»é¢˜æŒä¹…åŒ–ï¼Œä¸‹æ¬¡æ‰“å¼€é¡¹ç›®ä¼šè‡ªåŠ¨åˆ‡æ¢</li>
<li>å…³é—­çª—å£æˆ–è€…åˆ‡æ¢å·¥ä½œåŒºæ—¶ï¼Œè®¾ç½®çš„ä¸»é¢˜çŠ¶æ€ä¼šè¢«é‡ç½®â€”â€”æ„å‘³ç€åŒä¸€ä¸ªé¡¹ç›®æ¯ä¸€æ¬¡æ‰“å¼€å¯èƒ½éƒ½æ˜¯ä¸åŒçš„ä¸»é¢˜é…ç½®</li>
</ul>
<h4 data-id="heading-3">æ¨¡å¼äºŒï¼šçŠ¶æ€æ é­”æ³•</h4>
<p>æœ‰çš„äººä¸å–œæ¬¢æ›´æ”¹Themeï¼Œæ’ä»¶æä¾›ç¬¬äºŒç§æ–¹å¼ï¼šä¿®æ”¹åº•éƒ¨çŠ¶æ€æ ã€‚ä¼šç»™æ¯ä¸ªçª—å£çš„åº•éƒ¨çŠ¶æ€æ è®¾ç½®ä¸åŒçš„é¢œè‰²å’Œæ–‡å­—æ ‡ç­¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b9cbf606e26436d9ef499c93c25343b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rSX5r6h5rC05Yqg5Yaw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764348969&amp;x-signature=rNNp1CMlw0nUBnc9H5cdumlDHyE%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>å½“å‰çª—å£æ‰“å¼€é¡¹ç›®Aç”¨é»˜è®¤ä¸»é¢˜ï¼Œå†æ–°å¼€ä»¥çª—å£çš„é¡¹ç›®Bæ—¶ä¸»é¢˜å†²çªï¼Œä¼šè‡ªåŠ¨ä¿®æ”¹çª—å£Bçš„åº•éƒ¨çŠ¶æ€æ ä¸æ–‡å­—æ ‡ç­¾</li>
<li>å¯ä»¥è‡ªå·±é€‰æ‹©åº•éƒ¨çŠ¶æ€æ çš„é¢œè‰²ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»è‡ªåŠ¨åˆ†é…ä¸‹ä¸€ä¸ªé¢œè‰²</li>
<li>æ”¯æŒé€šè¿‡å·¥ä½œåŒºè·¯å¾„å°†çŠ¶æ€æ çš„æ–‡å­—æ ‡ç­¾æŒä¹…åŒ–ï¼Œä¸‹æ¬¡æ‰“å¼€é¡¹ç›®ä¼šè‡ªåŠ¨åˆ‡æ¢ã€‚æ¯”å¦‚ ç”Ÿäº§ç¯å¢ƒé¡¹ç›® â†’ "PROD"æ ‡ç­¾</li>
<li>å…³é—­çª—å£æˆ–è€…åˆ‡æ¢å·¥ä½œåŒºæ—¶ï¼Œè®¾ç½®çš„åº•éƒ¨çŠ¶æ€æ ä¼šè¢«é‡ç½®â€”â€”æ„å‘³ç€åŒä¸€ä¸ªé¡¹ç›®æ¯ä¸€æ¬¡æ‰“å¼€å¯èƒ½éƒ½æ˜¯ä¸åŒçš„åº•éƒ¨çŠ¶æ€æ é…ç½®</li>
</ul>
<h3 data-id="heading-4">æ€ä¹ˆä½¿ç”¨ï¼Ÿ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3Dseanz-hahaha.auto-themer" target="_blank" title="https://marketplace.visualstudio.com/items?itemName=seanz-hahaha.auto-themer" ref="nofollow noopener noreferrer">marketplace.visualstudio.com/items?itemNâ€¦</a> ä¸‹è½½æ’ä»¶å¹¶å®‰è£…ã€‚</p>
<ul>
<li>è¿›å…¥æ’ä»¶è®¾ç½®ï¼Œé…ç½®<code>autoThemer.windowsThreshold</code>ï¼Œæ‰“å¼€çš„çª—å£æ•°è¶…è¿‡è¯¥é˜ˆå€¼æ—¶æ‰ä¼šè‡ªåŠ¨åˆ†é…ä¸»é¢˜ã€‚</li>
<li>é…ç½® <code>autoThemer.conflictResolution</code> ,é€‰æ‹©<code>theme</code>æˆ–<code>statusBar</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºé€šè¿‡ä¸»é¢˜æˆ–åº•éƒ¨çŠ¶æ€æ åŒºåˆ†çª—å£ã€‚</li>
<li>å…¶ä»–æ“ä½œå¯ä»¥é€šè¿‡ä¾§è¾¹æ çš„æ’ä»¶é¢æ¿è®¾ç½®ï¼Œå¦‚åˆ‡æ¢ä¸»é¢˜ã€åˆ‡æ¢çŠ¶æ€æ é¢œè‰²ã€æŒä¹…åŒ–å½“å‰å·¥ä½œåŒºçš„ä¸»é¢˜æ˜ å°„ã€æŒä¹…åŒ–åº•éƒ¨çŠ¶æ€æ æ ‡ç­¾æ˜ å°„ã€‚</li>
<li>æ–°çª—å£æ‰“å¼€å·¥ä½œåŒºåï¼Œè‡ªåŠ¨æ£€æµ‹å¹¶åˆ†é…ä¸»é¢˜æˆ–è€…çŠ¶æ€æ åˆ°<code>.vscode/settings.json</code>ï¼›åˆ‡æ¢å·¥ä½œåŒºæˆ–è€…å…³é—­çª—å£æ—¶ï¼Œä¼šè‡ªåŠ¨é‡ç½®.vscode/settings.jsonçš„colorThemeã€‚</li>
</ul>
<h4 data-id="heading-5">æ’ä»¶é¢æ¿åŠŸèƒ½è¯´æ˜</h4>
<ul>
<li>select theme: é€‰æ‹©å½“å‰çª—å£çš„ä¸»é¢˜</li>
<li>random theme: éšæœºä¸ºå½“å‰çª—å£åˆ†é…ä¸»é¢˜</li>
<li>reassign theme: é‡æ–°åˆ†é…å½“å‰çª—å£çš„ä¸»é¢˜</li>
<li>persist theme: æŒä¹…åŒ–å½“å‰çª—å£çš„ä¸»é¢˜æ˜ å°„</li>
<li>show mappings: æŸ¥çœ‹å·¥ä½œåŒºä¸ä¸»é¢˜çš„æ˜ å°„å…³ç³»</li>
<li>pick status bar scheme: é€‰æ‹©å½“å‰çª—å£çš„åº•éƒ¨çŠ¶æ€æ é¢œè‰²é…ç½®(ä»…å†…ç½®)</li>
<li>persist status bar: æŒä¹…åŒ–å½“å‰çª—å£çš„åº•éƒ¨çŠ¶æ€æ æ ‡ç­¾æ˜ å°„</li>
</ul>
<h4 data-id="heading-6">é…ç½®</h4>
<p>åœ¨ VSCode è®¾ç½®ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"autoThemer.enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoThemer.conflictResolution"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"theme"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoThemer.windowsThreshold"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoThemer.builtinThemes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoThemer.themeMappingsText"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/my/pro-dev: Kimbie Dark; /easy/hc: Kimbie Dark"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoThemer.statusBarMappingsText"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/my/pro-dev: è‡ªå®šä¹‰æ ‡ç­¾; /easy/hc: è‡ªå®šä¹‰é¡¹ç›®"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¯´æ˜ï¼š
<code>themeMappingsText</code> ä½¿ç”¨åˆ†å·åˆ†éš”çš„ <code>è·¯å¾„: ä¸»é¢˜</code> æ–‡æœ¬ï¼Œæ’ä»¶åœ¨å†…å­˜ä¸­è§£æå¹¶ä½¿ç”¨è¯¥æ˜ å°„ã€‚
<code>statusBarMappingsText</code> ä½¿ç”¨åˆ†å·åˆ†éš”çš„ <code>è·¯å¾„: æ ‡ç­¾</code> æ–‡æœ¬ï¼Œæ’ä»¶åœ¨å†…å­˜ä¸­è§£æå¹¶ä½¿ç”¨è¯¥æ˜ å°„ã€‚</p>
<hr/>
<p>æ¥ä¸‹æ¥èŠèŠå®ç°åŸç†ã€‚</p>
<h3 data-id="heading-7">å®ç°åŸç†</h3>
<p>æ’ä»¶ä¼šåœ¨VS Codeçš„å…¨å±€å­˜å‚¨ä¸­ç»´æŠ¤ä¸€ä¸ªåŸºäºç£ç›˜æ–‡ä»¶çš„çª—å£å®ä¾‹åè°ƒç³»ç»Ÿï¼Œæ‰€æœ‰çª—å£é€šè¿‡è¿™ä¸ªæœºåˆ¶æ¥"åå•†"è°ç”¨ä»€ä¹ˆä¸»é¢˜/é¢œè‰²ã€‚å½“æ£€æµ‹åˆ°å¤šçª—å£åœºæ™¯æ—¶ï¼Œå®ƒä¼šï¼š</p>
<ol>
<li>æ‰«æå½“å‰æ´»åŠ¨çª—å£</li>
<li>æ£€æŸ¥æ˜¯å¦æœ‰æŒä¹…åŒ–æ˜ å°„é…ç½®</li>
<li>ç»™æ²¡æœ‰æ˜ å°„çš„çª—å£åˆ†é…å”¯ä¸€æ ‡è¯†</li>
<li>å®šæœŸæ£€æµ‹å†²çªå¹¶å¤„ç†</li>
<li>çª—å£å…³é—­æ—¶è‡ªåŠ¨æ¸…ç†é…ç½®</li>
</ol>
<p>å…·ä½“å®ç°ä¸Šï¼Œå®ƒé€šè¿‡ä¿®æ”¹å·¥ä½œåŒºçš„<code>.vscode/settings.json</code>æ¥åº”ç”¨ä¸»é¢˜æˆ–é¢œè‰²é…ç½®ï¼Œå…³é—­çª—å£æ—¶ä¼šè‡ªåŠ¨é‡ç½®ï¼Œä¸ä¼šå½±å“é¡¹ç›®çš„åŸå§‹é…ç½®ã€‚</p>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p><code>Auto Themer</code> ä¸ºäº†è§£å†³ä¸€ä¸ªçœ‹ä¼¼ç®€å•ä½†ç¡®å®å¾ˆå½±å“æ•ˆç‡çš„é—®é¢˜â€”â€”åŒºåˆ†å¤šä¸ªé¡¹ç›®çª—å£ï¼Œæ”¯æŒé€šè¿‡ThemeåŒºåˆ†æˆ–è€…é€šè¿‡StatusBaråŒºåˆ†ï¼Œå¯ä»¥è‡ªåŠ¨åˆ‡æ¢é…è‰²ä»¥ä¾¿åŒºåˆ†ï¼Œå¹¶å¼ºè°ƒä¸´æ—¶çŠ¶æ€ç®¡ç†ä¸çŠ¶æ€é‡ç½®ï¼Œä¹Ÿæ”¯æŒçŠ¶æ€æŒä¹…åŒ–ã€‚</p>
<p>é€šè¿‡ç®€å•çš„é…ç½®å°±å¯ä»¥å¯åŠ¨åŠŸèƒ½ï¼Œæ¬¢è¿ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æPRã€‚(â€”â€” ä¸€ä¸ªä¸æ€ä¹ˆå†™å‰ç«¯çš„å¼€å‘è€…:)</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆäºŒï¼‰: è·‘é€šæœ€åŸºæœ¬çš„Leaderé€‰ä¸¾]]></title>    <link>https://juejin.cn/post/7574978545144938531</link>    <guid>https://juejin.cn/post/7574978545144938531</guid>    <pubDate>2025-11-22T00:49:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574978545144938531" data-draft-id="7574992086715826191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆäºŒï¼‰: è·‘é€šæœ€åŸºæœ¬çš„Leaderé€‰ä¸¾"/> <meta itemprop="keywords" content="åç«¯,Raft"/> <meta itemprop="datePublished" content="2025-11-22T00:49:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‡†å¤‡æ‰‹å†™Simple Raftï¼ˆäºŒï¼‰: è·‘é€šæœ€åŸºæœ¬çš„Leaderé€‰ä¸¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T00:49:26.000Z" title="Sat Nov 22 2025 00:49:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…èƒŒæ™¯ï¼š20å¹´ITä¸€çº¿å¼€å‘ç»éªŒï¼Œ15å¹´æ¶æ„å¸ˆç»éªŒã€‚æ“…é•¿åˆ†å¸ƒå¼ã€å¾®æœåŠ¡ã€æœç´¢å¼•æ“ï¼Œæ‰‹å†™è¿‡å„ç±»ä¸­é—´ä»¶ã€‚æ›¾å¯¹Jacocoã€å¤œèºç­‰è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œè´Ÿè´£è¿‡200å¤šä¸ªèŠ‚ç‚¹çš„å¤§è§„æ¨¡é›†ç¾¤ï¼Œæ¶‰åŠK8sã€å¾®æœåŠ¡ç›‘æ§ã€å¤šä¸ªä¸­é—´ä»¶çš„è¿ç»´ã€‚è‡ªç ”è¿‡åŠ è§£å¯†ä¸­é—´ä»¶ï¼Œç°æœåŠ¡äºä¸€å®¶é‡‘èå…¬å¸ï¼Œæ‹…ä»»æ¶æ„å¸ˆã€‚</p>
</blockquote>
<p><strong>å®Œæ•´ä»£ç å·²å¼€æºï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsimple-raft" target="_blank" title="https://gitee.com/sh_wangwanbao/simple-raft" ref="nofollow noopener noreferrer">gitee.com/sh_wangwanbâ€¦</a>   æœ¬ç« ä»£ç åˆ†æ”¯ï¼šch2</p>
<hr/>
<p>ä¸Šä¸€ç¯‡è®²äº†Raftçš„æ ¸å¿ƒæ€æƒ³ï¼Œè¿™ç¯‡å¼€å§‹å†™ä»£ç ã€‚</p>
<p>ä»ç†è®ºåˆ°å®ç°æ˜¯æœ€éš¾è·¨è¶Šçš„é¸¿æ²Ÿã€‚Nacosçš„JRaftæœ‰5ä¸‡è¡Œä»£ç ï¼Œç›´æ¥çœ‹ä¼šå¾ˆå›°æƒ‘ã€‚</p>
<p>æ‰€ä»¥è¿™æ¬¡æˆ‘å†³å®šè‡ªå·±åŠ¨æ‰‹å†™ä¸€ä¸ªæœ€ç®€åŒ–çš„Raftï¼Œä»æœ€åŸºç¡€çš„é€‰ä¸¾å¼€å§‹ã€‚ä¸æ±‚å®Œç¾ï¼Œå…ˆè·‘é€šå†è¯´ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€MVPçš„è¾¹ç•Œï¼šåªåšé€‰ä¸¾</h2>
<p>å®ç°å®Œæ•´çš„Raftå®¹æ˜“åŠé€”è€ŒåºŸï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯ä»æœ€åŸºç¡€çš„é€‰ä¸¾å¼€å§‹ã€‚</p>
<p><strong>è¿™æ¬¡æˆ‘ä»¬åªåšè¿™ä¸‰ä»¶äº‹ï¼š</strong></p>
<ol>
<li>é€‰ä¸¾å‡ºä¸€ä¸ªLeader</li>
<li>Leaderå®šæ—¶å‘å¿ƒè·³ç»´æŒåœ°ä½</li>
<li>æŒä¹…åŒ–termå’ŒvotedFor</li>
</ol>
<p><strong>æš‚æ—¶ä¸åšï¼š</strong></p>
<ul>
<li>æ—¥å¿—å¤åˆ¶ï¼ˆä¸‹ä¸€ç¯‡å†æï¼‰</li>
<li>å¿«ç…§</li>
<li>é…ç½®å˜æ›´</li>
<li>ReadIndex</li>
</ul>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºé€‰ä¸¾æ˜¯åœ°åŸºï¼Œå¿…é¡»å…ˆæ‰“ç‰¢ã€‚æ—¥å¿—å¤åˆ¶æ˜¯80%çš„å·¥ä½œé‡ï¼Œæ”¾åé¢æ…¢æ…¢å•ƒã€‚</p>
<h2 data-id="heading-1">äºŒã€æ¶æ„è®¾è®¡ï¼šèƒ½ç®€å•å°±ä¸å¤æ‚</h2>
<p>æŠ€æœ¯é€‰å‹ä¸Šé€‰æ‹©äº†æœ€ç®€å•çš„æ–¹æ¡ˆï¼šç”¨HTTPè€Œä¸æ˜¯gRPCï¼Œå› ä¸ºHTTPå¤Ÿç”¨ï¼Œå‡ºé—®é¢˜è¿˜èƒ½ç”¨curlè°ƒè¯•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">simple-raft/
â”œâ”€â”€ surfing-raft-core      <span class="hljs-comment"># æ ¸å¿ƒç®—æ³•ï¼ˆçº¯Javaï¼‰</span>
â”‚   â”œâ”€â”€ RaftNode           <span class="hljs-comment"># çŠ¶æ€æœºæ ¸å¿ƒ</span>
â”‚   â”œâ”€â”€ rpc/               <span class="hljs-comment"># RPCæ¶ˆæ¯å®šä¹‰</span>
â”‚   â””â”€â”€ storage/           <span class="hljs-comment"># æŒä¹…åŒ–</span>
â””â”€â”€ surfing-raft-node      <span class="hljs-comment"># èŠ‚ç‚¹æœåŠ¡ï¼ˆSpring Bootï¼‰</span>
    â”œâ”€â”€ RaftService        <span class="hljs-comment"># å®šæ—¶è°ƒåº¦</span>
    â”œâ”€â”€ RaftController     <span class="hljs-comment"># HTTPæ¥å£</span>
    â””â”€â”€ RaftRpcClient      <span class="hljs-comment"># HTTPå®¢æˆ·ç«¯</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆåˆ†ä¸¤å±‚ï¼Ÿ</strong></p>
<ul>
<li>coreå±‚ï¼šçº¯ç®—æ³•é€»è¾‘ï¼Œä¸ä¾èµ–æ¡†æ¶ï¼Œæ–¹ä¾¿å•å…ƒæµ‹è¯•</li>
<li>nodeå±‚ï¼šå¤„ç†å®šæ—¶ä»»åŠ¡ã€HTTPé€šä¿¡è¿™äº›å·¥ç¨‹é—®é¢˜</li>
</ul>
<p>ç®—æ³•å’Œå·¥ç¨‹åˆ†ç¦»çš„å¥½å¤„æ˜¯ï¼šæ ¸å¿ƒé€»è¾‘ä¸ä¼šè¢«æ¡†æ¶çš„æ³¨è§£æå¾—ä¸€å›¢ç³Ÿã€‚</p>
<p><strong>æ¨¡å—è°ƒç”¨å…³ç³»ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "surfing-raft-nodeï¼ˆå·¥ç¨‹å±‚ï¼‰"
        Controller[RaftController&lt;br/&gt;REST API]
        Service[RaftService&lt;br/&gt;å®šæ—¶è°ƒåº¦+RPCç¼–æ’]
        Client[RaftRpcClient&lt;br/&gt;HTTPå®¢æˆ·ç«¯]
    end
    
    subgraph "surfing-raft-coreï¼ˆç®—æ³•å±‚ï¼‰"
        Node[RaftNode&lt;br/&gt;æ ¸å¿ƒçŠ¶æ€æœº]
        Storage[FileStatePersistence&lt;br/&gt;æŒä¹…åŒ–]
        RPC[RPCæ¶ˆæ¯&lt;br/&gt;Request/Response]
    end
    
    Controller --&gt;|è½¬å‘RPC| Service
    Service --&gt;|è°ƒç”¨ç®—æ³•| Node
    Service --&gt;|å‘é€RPC| Client
    Client --&gt;|HTTP POST| Controller
    Node --&gt;|è¯»å†™| Storage
    Service --&gt;|æ„é€ æ¶ˆæ¯| RPC
    
    style Node fill:#ffe6e6
    style Storage fill:#e6f3ff
    style Service fill:#e6ffe6
</code></pre>
<p><strong>æ•°æ®æµç¤ºä¾‹ï¼ˆæ”¶åˆ°æŠ•ç¥¨è¯·æ±‚ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Peer as å…¶ä»–èŠ‚ç‚¹
    participant Controller as RaftController
    participant Service as RaftService
    participant Node as RaftNode
    participant Storage as FileStatePersistence
    
    Peer-&gt;&gt;Controller: POST /raft/vote&lt;br/&gt;RequestVoteRequest
    Controller-&gt;&gt;Service: handleRequestVote(request)
    Service-&gt;&gt;Node: handleRequestVote(request)
    
    rect rgb(255, 240, 240)
    Note over Node: åŠ é”å¤„ç†
    Node-&gt;&gt;Node: æ£€æŸ¥term
    Node-&gt;&gt;Node: å†³å®šæ˜¯å¦æŠ•ç¥¨
    alt åŒæ„æŠ•ç¥¨
        Node-&gt;&gt;Storage: save(term, votedFor)
        Storage--&gt;&gt;Node: æŒä¹…åŒ–æˆåŠŸ
        Node-&gt;&gt;Node: resetElectionTimeout()
    end
    end
    
    Node--&gt;&gt;Service: RequestVoteResponse
    Service--&gt;&gt;Controller: RequestVoteResponse
    Controller--&gt;&gt;Peer: HTTP 200&lt;br/&gt;è¿”å›å“åº”
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æ ¸å¿ƒé€»è¾‘ï¼šå°‘å³æ˜¯å¤š</h2>
<h3 data-id="heading-3">3.1 æŒä¹…åŒ–ï¼šåªå­˜ä¸¤ä¸ªå­—æ®µ</h3>
<p>Raftè®ºæ–‡æ˜ç¡®è¯´äº†ï¼Œå¿…é¡»æŒä¹…åŒ–çš„åªæœ‰ä¸¤ä¸ªï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PersistentState</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> currentTerm;   <span class="hljs-comment">// å½“å‰ä»»æœŸ</span>
    <span class="hljs-keyword">private</span> String votedFor;    <span class="hljs-comment">// æŠ•ç»™è°äº†</span>
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¸å­˜stateï¼ˆLEADER/FOLLOWERï¼‰ï¼Ÿ</strong></p>
<p>é‡å¯åé»˜è®¤éƒ½æ˜¯Followerï¼Œé€šè¿‡å¿ƒè·³æˆ–é€‰ä¸¾è‡ªç„¶å°±æ¢å¤äº†ã€‚èƒ½ä¸å­˜å°±ä¸å­˜ï¼Œè¿™æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºæœ¬åŸåˆ™ã€‚</p>
<p>æŒä¹…åŒ–çŠ¶æ€è¶Šå¤šï¼Œç³»ç»Ÿå‡çº§æ—¶çš„å…¼å®¹æ€§é—®é¢˜å°±è¶Šå¤æ‚ã€‚</p>
<h3 data-id="heading-4">3.2 åŸå­æ€§å†™å…¥ï¼šä¿è¯æ•°æ®å®Œæ•´</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(PersistentState state)</span> {
    <span class="hljs-comment">// å…ˆå†™ä¸´æ—¶æ–‡ä»¶</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">tempFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(stateFilePath + <span class="hljs-string">".tmp"</span>);
    objectMapper.writeValue(tempFile, state);
    
    <span class="hljs-comment">// åŸå­æ€§é‡å‘½å</span>
    Files.move(tempFile.toPath(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(stateFilePath).toPath(), 
        StandardCopyOption.ATOMIC_MOVE);
}
</code></pre>
<p>è¿™ç§"å†™ä¸´æ—¶æ–‡ä»¶+åŸå­é‡å‘½å"çš„æ¨¡å¼åœ¨å¾ˆå¤šå­˜å‚¨ç³»ç»Ÿä¸­éƒ½æœ‰ä½¿ç”¨ï¼Œæ¯”å¦‚PostgreSQLçš„WALæœºåˆ¶ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ</strong></p>
<p>å…ˆå†™ä¸´æ—¶æ–‡ä»¶ï¼ŒæˆåŠŸåå†åŸå­æ€§é‡å‘½åã€‚è¿™æ ·å³ä½¿å†™å…¥è¿‡ç¨‹ä¸­å®•æœºï¼Œè¦ä¹ˆæ–°æ–‡ä»¶æˆåŠŸï¼Œè¦ä¹ˆæ—§æ–‡ä»¶è¿˜åœ¨ï¼Œä¸ä¼šå‡ºç°æ–‡ä»¶æŸåçš„æƒ…å†µã€‚</p>
<h3 data-id="heading-5">3.3 é€‰ä¸¾é€»è¾‘ï¼štermæ˜¯æ ¸å¿ƒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">becomeCandidate</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        state = CANDIDATE;
        currentTerm++;              <span class="hljs-comment">// å…³é”®ï¼šä»»æœŸé€’å¢</span>
        votedFor = nodeId;          <span class="hljs-comment">// æŠ•ç»™è‡ªå·±</span>
        votesReceived = <span class="hljs-number">1</span>;          <span class="hljs-comment">// è‡ªå·±ç®—ä¸€ç¥¨</span>
        
        savePersistentState();      <span class="hljs-comment">// ç«‹å³æŒä¹…åŒ–ï¼</span>
        resetElectionTimeout();
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<p>è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<p><strong>æ³¨æ„1ï¼štermå¿…é¡»å…ˆé€’å¢å†å‘æŠ•ç¥¨è¯·æ±‚</strong>
å¦‚æœå‘å®Œè¯·æ±‚æ‰é€’å¢termï¼Œå…¶ä»–èŠ‚ç‚¹ä¼šå› ä¸ºtermè¿‡æ—§è€Œæ‹’ç»æŠ•ç¥¨ã€‚</p>
<p><strong>æ³¨æ„2ï¼šæŠ•ç¥¨åå¿…é¡»ç«‹å³æŒä¹…åŒ–</strong>
å¦‚æœä¸æŒä¹…åŒ–å°±é‡å¯ï¼ŒèŠ‚ç‚¹å¯èƒ½å¿˜è®°å·²æŠ•ç¥¨ï¼Œåœ¨åŒä¸€termæŠ•å¤šæ¬¡ç¥¨ï¼Œå¯¼è‡´ä¸¤ä¸ªLeaderã€‚è¿™æ˜¯Raftå®‰å…¨æ€§çš„æ ¹åŸºã€‚</p>
<p><strong>æ³¨æ„3ï¼švotesReceivedè¦åŒ…å«è‡ªå·±</strong>
å€™é€‰äººè‡ªå·±ä¹Ÿç®—ä¸€ç¥¨ã€‚å¦‚æœå¿˜è®°è¿™ç‚¹ï¼Œ3èŠ‚ç‚¹é›†ç¾¤ä¼šéœ€è¦3ç¥¨æ‰èƒ½å½“é€‰ï¼Œæ°¸è¿œé€‰ä¸å‡ºLeaderã€‚</p>
<h3 data-id="heading-6">3.4 æŠ•ç¥¨è§„åˆ™ï¼šåŒä¸€ä»»æœŸåªæŠ•ä¸€æ¬¡</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> RequestVoteResponse <span class="hljs-title function_">handleRequestVote</span><span class="hljs-params">(RequestVoteRequest request)</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ‹’ç»è¿‡æœŸè¯·æ±‚</span>
        <span class="hljs-keyword">if</span> (request.getTerm() &lt; currentTerm) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestVoteResponse</span>(currentTerm, <span class="hljs-literal">false</span>);
        }
        
        <span class="hljs-comment">// å‘ç°æ›´é«˜termï¼Œç«‹å³é™çº§</span>
        <span class="hljs-keyword">if</span> (request.getTerm() &gt; currentTerm) {
            becomeFollower(request.getTerm());
        }
        
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²æŠ•ç¥¨</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">canVote</span> <span class="hljs-operator">=</span> (votedFor == <span class="hljs-literal">null</span> || 
                          votedFor.equals(request.getCandidateId()));
        
        <span class="hljs-keyword">if</span> (canVote) {
            votedFor = request.getCandidateId();
            savePersistentState();    <span class="hljs-comment">// åˆæ˜¯ç«‹å³æŒä¹…åŒ–</span>
            resetElectionTimeout();
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestVoteResponse</span>(currentTerm, <span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestVoteResponse</span>(currentTerm, <span class="hljs-literal">false</span>);
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<p>è¿™é‡Œä½“ç°äº†Raftçš„ç²¾é«“ï¼š<strong>termæ˜¯é€»è¾‘æ—¶é’Ÿ</strong>ã€‚</p>
<p>ä»»ä½•æ—¶å€™æ”¶åˆ°æ›´é«˜çš„termï¼Œä¸ç®¡ä½ æ˜¯Leaderè¿˜æ˜¯Candidateï¼Œç«‹å³è®¤æ€‚å˜Followerã€‚è¿™ä¿è¯äº†é›†ç¾¤åœ¨æœ€é«˜termä¸‹åªæœ‰ä¸€ä¸ªåˆæ³•Leaderã€‚</p>
<h3 data-id="heading-7">3.5 å¿ƒè·³æœºåˆ¶ï¼šLeaderçš„ç”Ÿå‘½çº¿</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendHeartbeats</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (raftNode.getState() != NodeState.LEADER) {
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// åªæœ‰Leaderå‘å¿ƒè·³</span>
    }
    
    <span class="hljs-type">AppendEntriesRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppendEntriesRequest</span>(
        raftNode.getCurrentTerm(),
        raftNode.getNodeId(),
        <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>  <span class="hljs-comment">// æš‚æ—¶æ²¡æœ‰æ—¥å¿—ï¼Œè¿™äº›å­—æ®µéƒ½æ˜¯0</span>
    );
    
    <span class="hljs-comment">// å¹¶è¡Œå‘é€ç»™æ‰€æœ‰Peer</span>
    <span class="hljs-keyword">for</span> (String peer : raftNode.getPeers()) {
        executor.submit(() -&gt; {
            <span class="hljs-type">AppendEntriesResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> rpcClient.appendEntries(peer, request);
            <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">null</span> &amp;&amp; response.getTerm() &gt; raftNode.getCurrentTerm()) {
                <span class="hljs-comment">// å‘ç°æ›´é«˜termï¼ŒLeaderé™çº§</span>
                raftNode.becomeFollower(response.getTerm());
            }
        });
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå¿ƒè·³é—´éš”æ˜¯50msï¼Ÿ</strong></p>
<p>é€‰ä¸¾è¶…æ—¶æ˜¯150-300msï¼Œå¿ƒè·³é—´éš”åº”è¯¥è¿œå°äºå®ƒï¼Œä¸€èˆ¬æ˜¯1/3ã€‚è¿™æ ·å³ä½¿å¶å°”ä¸¢åŒ…ï¼Œä¹Ÿä¸ä¼šè§¦å‘é€‰ä¸¾ã€‚</p>
<p>å¦‚æœå¿ƒè·³é—´éš”è®¾ç½®å¾—è¿‡é•¿ï¼ˆæ¯”å¦‚100mså¿ƒè·³é…120msè¶…æ—¶ï¼‰ï¼Œç½‘ç»œç¨æœ‰æŠ–åŠ¨å°±ä¼šé¢‘ç¹é€‰ä¸¾ï¼Œé›†ç¾¤éš¾ä»¥ç¨³å®šã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆå¹¶è¡Œå‘é€ï¼Ÿ</strong></p>
<p>ä¸²è¡Œå‘é€çš„è¯ï¼Œ3ä¸ªèŠ‚ç‚¹å°±è¦150msï¼ˆ50ms * 3ï¼‰ï¼Œæ—©å°±è¶…æ—¶äº†ã€‚å¹¶è¡Œå‘é€èƒ½ä¿è¯å¿ƒè·³åŠæ—¶é€è¾¾ã€‚</p>
<p><strong>æ³¨æ„ï¼šä¸è¦ç”¨CompletableFuture.allOf()ç­‰å¾…æ‰€æœ‰å“åº”ã€‚</strong> ä¸€ä¸ªèŠ‚ç‚¹æ…¢äº†ï¼Œæ•´ä¸ªå¿ƒè·³å°±æ…¢äº†ã€‚æ­£ç¡®åšæ³•æ˜¯å‘å®Œå°±å®Œäº‹ï¼Œå“åº”å¼‚æ­¥å¤„ç†ã€‚</p>
<h3 data-id="heading-8">3.6 å®Œæ•´çš„é€‰ä¸¾æµç¨‹</h3>
<p>ç”¨æ—¶åºå›¾çœ‹å¾—æ›´æ¸…æ¥šï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant N1 as Node-1&lt;br/&gt;(Follower)
    participant N2 as Node-2&lt;br/&gt;(Follower)
    participant N3 as Node-3&lt;br/&gt;(Follower)
    
    Note over N1,N3: æ‰€æœ‰èŠ‚ç‚¹å¯åŠ¨ï¼Œåˆå§‹çŠ¶æ€éƒ½æ˜¯Follower&lt;br/&gt;term=0, votedFor=null
    
    Note over N1: é€‰ä¸¾è¶…æ—¶(200ms)&lt;br/&gt;æ²¡æ”¶åˆ°å¿ƒè·³
    
    rect rgb(255, 240, 240)
    Note over N1: å¼€å§‹é€‰ä¸¾
    N1-&gt;&gt;N1: becomeCandidate()&lt;br/&gt;term: 0â†’1&lt;br/&gt;votedFor: node-1&lt;br/&gt;votes: 1
    N1-&gt;&gt;N1: æŒä¹…åŒ–(term=1, votedFor=node-1)
    end
    
    par å¹¶å‘å‘é€æŠ•ç¥¨è¯·æ±‚
        N1-&gt;&gt;N2: RequestVote&lt;br/&gt;{term:1, candidateId:node-1}
        N1-&gt;&gt;N3: RequestVote&lt;br/&gt;{term:1, candidateId:node-1}
    end
    
    rect rgb(240, 255, 240)
    Note over N2: å¤„ç†æŠ•ç¥¨è¯·æ±‚
    N2-&gt;&gt;N2: term: 0â†’1&lt;br/&gt;votedFor: node-1
    N2-&gt;&gt;N2: æŒä¹…åŒ–(term=1, votedFor=node-1)
    N2-&gt;&gt;N2: é‡ç½®é€‰ä¸¾è¶…æ—¶
    N2--&gt;&gt;N1: VoteGranted: true
    end
    
    rect rgb(240, 255, 240)
    Note over N3: å¤„ç†æŠ•ç¥¨è¯·æ±‚
    N3-&gt;&gt;N3: term: 0â†’1&lt;br/&gt;votedFor: node-1
    N3-&gt;&gt;N3: æŒä¹…åŒ–(term=1, votedFor=node-1)
    N3-&gt;&gt;N3: é‡ç½®é€‰ä¸¾è¶…æ—¶
    N3--&gt;&gt;N1: VoteGranted: true
    end
    
    rect rgb(240, 240, 255)
    Note over N1: æ”¶åˆ°å¤šæ•°æ´¾æŠ•ç¥¨
    N1-&gt;&gt;N1: votes: 3/3 &gt;= 2&lt;br/&gt;becomeLeader()
    Note over N1: æˆä¸ºLeader
    end
    
    loop æ¯50mså‘é€å¿ƒè·³
        N1-&gt;&gt;N2: AppendEntries&lt;br/&gt;{term:1, leaderId:node-1}
        N1-&gt;&gt;N3: AppendEntries&lt;br/&gt;{term:1, leaderId:node-1}
        N2--&gt;&gt;N1: Success: true
        N3--&gt;&gt;N1: Success: true
    end
    
    Note over N1,N3: é›†ç¾¤ç¨³å®š&lt;br/&gt;Node-1æ˜¯Leader, term=1
</code></pre>
<p><strong>å…³é”®æ—¶åˆ»ï¼š</strong></p>
<ol>
<li><strong>0-200ms</strong>: æ‰€æœ‰èŠ‚ç‚¹ç­‰å¾…ï¼ŒNode-1å…ˆè¶…æ—¶</li>
<li><strong>200ms</strong>: Node-1å‘èµ·é€‰ä¸¾ï¼Œtermå˜æˆ1</li>
<li><strong>200-250ms</strong>: æŠ•ç¥¨è¯·æ±‚åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼ˆå‡è®¾å»¶è¿Ÿ50msï¼‰</li>
<li><strong>250ms</strong>: Node-2å’ŒNode-3æ”¶åˆ°è¯·æ±‚ï¼ŒæŠ•ç¥¨ç»™Node-1</li>
<li><strong>250-300ms</strong>: æŠ•ç¥¨å“åº”è¿”å›</li>
<li><strong>300ms</strong>: Node-1æ”¶åˆ°å¤šæ•°ç¥¨ï¼Œæˆä¸ºLeader</li>
<li><strong>300mså</strong>: Leaderæ¯50mså‘ä¸€æ¬¡å¿ƒè·³</li>
</ol>
<h3 data-id="heading-9">3.7 Leaderå¤±è”åçš„é‡æ–°é€‰ä¸¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant L as Node-1&lt;br/&gt;(Leader)
    participant F1 as Node-2&lt;br/&gt;(Follower)
    participant F2 as Node-3&lt;br/&gt;(Follower)
    
    Note over L,F2: ç¨³å®šçŠ¶æ€: Node-1æ˜¯Leader, term=1
    
    loop Leaderæ­£å¸¸å‘é€å¿ƒè·³
        L-&gt;&gt;F1: AppendEntries{term:1}
        L-&gt;&gt;F2: AppendEntries{term:1}
        F1--&gt;&gt;L: Success
        F2--&gt;&gt;L: Success
    end
    
    rect rgb(255, 200, 200)
    Note over L: Leaderå®•æœº/ç½‘ç»œæ–­å¼€
    end
    
    Note over F1,F2: Followersç­‰å¾…å¿ƒè·³...&lt;br/&gt;é€‰ä¸¾è¶…æ—¶å¼€å§‹è®¡æ—¶
    
    Note over F1: é€‰ä¸¾è¶…æ—¶(250ms)
    
    rect rgb(255, 240, 240)
    F1-&gt;&gt;F1: becomeCandidate()&lt;br/&gt;term: 1â†’2&lt;br/&gt;votedFor: node-2&lt;br/&gt;votes: 1
    F1-&gt;&gt;F1: æŒä¹…åŒ–(term=2, votedFor=node-2)
    end
    
    F1-&gt;&gt;F2: RequestVote&lt;br/&gt;{term:2, candidateId:node-2}
    
    rect rgb(240, 255, 240)
    F2-&gt;&gt;F2: term: 1â†’2&lt;br/&gt;votedFor: node-2
    F2-&gt;&gt;F2: æŒä¹…åŒ–(term=2, votedFor=node-2)
    F2--&gt;&gt;F1: VoteGranted: true
    end
    
    rect rgb(240, 240, 255)
    F1-&gt;&gt;F1: votes: 2/2 &gt;= 2&lt;br/&gt;becomeLeader()
    Note over F1: Node-2æˆä¸ºæ–°Leader
    end
    
    loop æ–°Leaderå‘é€å¿ƒè·³
        F1-&gt;&gt;F2: AppendEntries{term:2, leaderId:node-2}
        F2--&gt;&gt;F1: Success: true
    end
    
    Note over F1,F2: é›†ç¾¤æ¢å¤&lt;br/&gt;Node-2æ˜¯Leader, term=2

    opt Leaderæ¢å¤å
        L-&gt;&gt;F1: AppendEntries{term:1}
        rect rgb(255, 240, 240)
        Note over F1: å‘ç°æ—§term
        F1--&gt;&gt;L: {term:2, success:false}
        end
        rect rgb(255, 200, 200)
        Note over L: æ”¶åˆ°æ›´é«˜term
        L-&gt;&gt;L: becomeFollower(2)&lt;br/&gt;state: LEADERâ†’FOLLOWER&lt;br/&gt;æŒä¹…åŒ–
        end
    end
</code></pre>
<p><strong>è¿™ä¸ªæµç¨‹ä½“ç°äº†Raftçš„ä¸¤ä¸ªå…³é”®ç‰¹æ€§ï¼š</strong></p>
<ol>
<li><strong>ä»»æœŸå•è°ƒé€’å¢</strong>ï¼šæ–°Leaderçš„term=2 &gt; æ—§Leaderçš„term=1</li>
<li><strong>æ—§Leaderè‡ªåŠ¨é™çº§</strong>ï¼šæ”¶åˆ°æ›´é«˜termåï¼Œç«‹å³å˜æˆFollower</li>
</ol>
<h3 data-id="heading-10">3.8 èŠ‚ç‚¹çŠ¶æ€è½¬æ¢è§„åˆ™</h3>
<p>RaftèŠ‚ç‚¹æœ‰3ä¸ªçŠ¶æ€ï¼šFollowerã€Candidateã€Leaderã€‚çŠ¶æ€è½¬æ¢çš„è§¦å‘æ¡ä»¶å¦‚ä¸‹ï¼š</p>

































































<table><thead><tr><th>å½“å‰çŠ¶æ€</th><th>è§¦å‘æ¡ä»¶</th><th>è½¬æ¢åˆ°</th><th>æ‰§è¡ŒåŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>Follower</strong></td><td>é€‰ä¸¾è¶…æ—¶ï¼Œæœªæ”¶åˆ°å¿ƒè·³</td><td>Candidate</td><td>term++ï¼ŒæŠ•ç¥¨ç»™è‡ªå·±ï¼ŒæŒä¹…åŒ–</td></tr><tr><td><strong>Follower</strong></td><td>æ”¶åˆ°åˆæ³•Leaderå¿ƒè·³</td><td>Follower</td><td>é‡ç½®é€‰ä¸¾è¶…æ—¶</td></tr><tr><td><strong>Follower</strong></td><td>æ”¶åˆ°æ›´é«˜term</td><td>Follower</td><td>æ›´æ–°termï¼ŒæŒä¹…åŒ–</td></tr><tr><td><strong>Candidate</strong></td><td>è·å¾—å¤šæ•°ç¥¨</td><td>Leader</td><td>å¼€å§‹å‘é€å¿ƒè·³</td></tr><tr><td><strong>Candidate</strong></td><td>é€‰ä¸¾è¶…æ—¶ï¼Œæœªè·å¾—å¤šæ•°ç¥¨</td><td>Candidate</td><td>term++ï¼Œå‘èµ·æ–°ä¸€è½®é€‰ä¸¾</td></tr><tr><td><strong>Candidate</strong></td><td>æ”¶åˆ°æ›´é«˜term</td><td>Follower</td><td>æ›´æ–°termï¼ŒæŒä¹…åŒ–</td></tr><tr><td><strong>Candidate</strong></td><td>æ”¶åˆ°åˆæ³•Leaderå¿ƒè·³</td><td>Follower</td><td>æ›´æ–°termï¼Œé‡ç½®é€‰ä¸¾è¶…æ—¶</td></tr><tr><td><strong>Leader</strong></td><td>æ”¶åˆ°æ›´é«˜term</td><td>Follower</td><td>ç«‹å³é™çº§ï¼Œæ›´æ–°termï¼ŒæŒä¹…åŒ–</td></tr><tr><td><strong>Leader</strong></td><td>æ­£å¸¸è¿è¡Œ</td><td>Leader</td><td>å®šæ—¶å‘é€å¿ƒè·³ç»´æŒåœ°ä½</td></tr></tbody></table>
<p><strong>å…³é”®è§„åˆ™ï¼š</strong></p>
<ul>
<li>ä»»ä½•çŠ¶æ€æ”¶åˆ°æ›´é«˜termï¼Œéƒ½è¦æ›´æ–°termå¹¶è½¬ä¸ºFollower</li>
<li>Followerå’ŒCandidateæ”¶åˆ°åˆæ³•Leaderå¿ƒè·³ï¼Œç«‹å³è½¬ä¸ºFollowerå¹¶é‡ç½®é€‰ä¸¾è¶…æ—¶</li>
<li>Candidateè·å¾—å¤šæ•°ç¥¨(åŒ…æ‹¬è‡ªå·±)ï¼Œç«‹å³è½¬ä¸ºLeader</li>
<li>Leaderåªæœ‰åœ¨æ”¶åˆ°æ›´é«˜termæ—¶æ‰ä¼šé™çº§</li>
</ul>
<h2 data-id="heading-11">å››ã€è¿è¡Œæ•ˆæœï¼šçœ¼è§ä¸ºå®</h2>
<p>Talk is cheap, show me the code. ä¸ï¼Œshow me the running cluster!</p>
<h3 data-id="heading-12">4.1 å¯åŠ¨é›†ç¾¤</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> simple-raft
./start-cluster.sh
</code></pre>
<p>è¿™ä¸ªè„šæœ¬ä¼šï¼š</p>
<ol>
<li>æ¸…ç†æ—§æ•°æ®ï¼ˆ<code>/tmp/raft-data</code>ï¼‰</li>
<li>ç¼–è¯‘é¡¹ç›®ï¼ˆMavenï¼‰</li>
<li>åå°å¯åŠ¨3ä¸ªèŠ‚ç‚¹</li>
</ol>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æ¸…ç†æ—§æ•°æ®...</span>
<span class="hljs-string">ç¼–è¯‘é¡¹ç›®...</span>
[<span class="hljs-string">INFO</span>] <span class="hljs-string">BUILD</span> <span class="hljs-string">SUCCESS</span>
<span class="hljs-string">å¯åŠ¨èŠ‚ç‚¹</span> <span class="hljs-number">1</span><span class="hljs-string">...</span>
<span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">1 PID:</span> <span class="hljs-number">55160</span>
<span class="hljs-string">å¯åŠ¨èŠ‚ç‚¹</span> <span class="hljs-number">2</span><span class="hljs-string">...</span>
<span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">2 PID:</span> <span class="hljs-number">55166</span>
<span class="hljs-string">å¯åŠ¨èŠ‚ç‚¹</span> <span class="hljs-number">3</span><span class="hljs-string">...</span>
<span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">3 PID:</span> <span class="hljs-number">55170</span>

<span class="hljs-string">ä¸‰ä¸ªèŠ‚ç‚¹å·²å¯åŠ¨ï¼š</span>
  <span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">1:</span> <span class="hljs-string">http://localhost:8081</span> <span class="hljs-string">(PID:</span> <span class="hljs-number">55160</span><span class="hljs-string">)</span>
  <span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">2:</span> <span class="hljs-string">http://localhost:8082</span> <span class="hljs-string">(PID:</span> <span class="hljs-number">55166</span><span class="hljs-string">)</span>
  <span class="hljs-string">èŠ‚ç‚¹</span> <span class="hljs-attr">3:</span> <span class="hljs-string">http://localhost:8083</span> <span class="hljs-string">(PID:</span> <span class="hljs-number">55170</span><span class="hljs-string">)</span>
</code></pre>
<p><strong>å¯åŠ¨åçš„å†…éƒ¨æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Spring as Spring Boot
    participant Service as RaftService
    participant Node as RaftNode
    participant Storage as FileStatePersistence
    
    Spring-&gt;&gt;Service: @PostConstruct&lt;br/&gt;start()
    Service-&gt;&gt;Storage: åˆ›å»ºæŒä¹…åŒ–
    Service-&gt;&gt;Node: åˆ›å»ºRaftNode
    Node-&gt;&gt;Storage: loadPersistentState()
    
    alt é¦–æ¬¡å¯åŠ¨(æ–‡ä»¶ä¸å­˜åœ¨)
        Storage--&gt;&gt;Node: {term:0, votedFor:null}
        Note over Node: åˆå§‹åŒ–ä¸ºFollower&lt;br/&gt;term=0, votedFor=null
    else é‡å¯(æ–‡ä»¶å­˜åœ¨)
        Storage--&gt;&gt;Node: {term:5, votedFor:node-2}
        Note over Node: æ¢å¤ä¸ºFollower&lt;br/&gt;term=5, votedFor=node-2
    end
    
    Node-&gt;&gt;Node: ç”Ÿæˆéšæœºé€‰ä¸¾è¶…æ—¶&lt;br/&gt;150-300ms
    
    Service-&gt;&gt;Service: å¯åŠ¨å®šæ—¶ä»»åŠ¡
    
    rect rgb(240, 255, 240)
    Note over Service: å®šæ—¶ä»»åŠ¡1: é€‰ä¸¾è¶…æ—¶æ£€æŸ¥(50ms)
    loop æ¯50msæ‰§è¡Œ
        Service-&gt;&gt;Node: æ£€æŸ¥æ˜¯å¦è¶…æ—¶
        alt è¶…æ—¶ä¸”æœªæ”¶åˆ°å¿ƒè·³
            Service-&gt;&gt;Service: startElection()
        end
    end
    end
    
    rect rgb(240, 240, 255)
    Note over Service: å®šæ—¶ä»»åŠ¡2: å¿ƒè·³å‘é€(50ms)
    loop æ¯50msæ‰§è¡Œ
        alt å½“å‰æ˜¯Leader
            Service-&gt;&gt;Service: sendHeartbeats()
        end
    end
    end
    
    Note over Spring,Storage: èŠ‚ç‚¹å¯åŠ¨å®Œæˆï¼Œè¿›å…¥è¿è¡ŒçŠ¶æ€
</code></pre>
<p><strong>3ä¸ªèŠ‚ç‚¹çš„é…ç½®å·®å¼‚ï¼š</strong></p>



































<table><thead><tr><th>é…ç½®é¡¹</th><th>Node-1</th><th>Node-2</th><th>Node-3</th></tr></thead><tbody><tr><td>server.port</td><td>8081</td><td>8082</td><td>8083</td></tr><tr><td>raft.node-id</td><td>node-1</td><td>node-2</td><td>node-3</td></tr><tr><td>raft.peers</td><td>localhost:8082,<br/>localhost:8083</td><td>localhost:8081,<br/>localhost:8083</td><td>localhost:8081,<br/>localhost:8082</td></tr><tr><td>raft.storage-dir</td><td>/tmp/raft-data/<br/>node-1</td><td>/tmp/raft-data/<br/>node-2</td><td>/tmp/raft-data/<br/>node-3</td></tr></tbody></table>
<p><strong>æŒä¹…åŒ–æ–‡ä»¶ï¼š</strong></p>
<ul>
<li>Node-1: <code>/tmp/raft-data/node-1/node-1-state.json</code></li>
<li>Node-2: <code>/tmp/raft-data/node-2/node-2-state.json</code></li>
<li>Node-3: <code>/tmp/raft-data/node-3/node-3-state.json</code></li>
</ul>
<p>æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"currentTerm"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"votedFor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-1"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-13">4.2 æŸ¥çœ‹çŠ¶æ€</h3>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:8081/raft/status | jq
</code></pre>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"nodeId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"LEADER"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"currentTerm"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"leaderId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-1"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:8082/raft/status | jq
</code></pre>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"nodeId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"FOLLOWER"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"currentTerm"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"leaderId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-1"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>çœ‹åˆ°æ²¡ï¼Ÿnode-1æ˜¯Leaderï¼Œå…¶ä»–ä¸¤ä¸ªæ˜¯Followerã€‚é›†ç¾¤ç¨³å®šäº†ã€‚</p>
<h3 data-id="heading-14">4.3 æµ‹è¯•Leaderå¤±è”</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ€æ‰Leader</span>
<span class="hljs-built_in">kill</span> 55160

<span class="hljs-comment"># ç­‰2ç§’ï¼Œè®©é€‰ä¸¾å®Œæˆ</span>
<span class="hljs-built_in">sleep</span> 2

<span class="hljs-comment"># æŸ¥çœ‹æ–°çŠ¶æ€</span>
curl http://localhost:8082/raft/status | jq
</code></pre>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"nodeId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"LEADER"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"currentTerm"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"leaderId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node-2"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>node-2æˆä¸ºæ–°Leaderäº†ï¼Œtermä»1å˜æˆ2ã€‚è¿™å°±æ˜¯Raftçš„å®¹é”™èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-15">4.4 è§‚å¯Ÿæ—¥å¿—ï¼šé€‰ä¸¾çš„å®Œæ•´è¿‡ç¨‹</h3>
<p>æˆ‘åœ¨ä»£ç é‡ŒåŠ äº†è¯¦ç»†çš„æ—¥å¿—ï¼Œä½ å¯ä»¥å®æ—¶çœ‹åˆ°é€‰ä¸¾è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">tail</span> -f /tmp/raft-node-1.<span class="hljs-built_in">log</span>
</code></pre>
<p><strong>å®Œæ•´çš„æ—¥å¿—è¾“å‡ºï¼ˆå¸¦æ—¶é—´æˆ³å’Œè§£è¯»ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">2024-11-18 22:49:23.156 <span class="hljs-section">[main]</span> INFO  RaftNode - Node node-1 initialized as FOLLOWER
2024-11-18 22:49:23.158 <span class="hljs-section">[main]</span> INFO  FileStatePersistence - No persistent state file found, initializing with defaults
2024-11-18 22:49:23.159 <span class="hljs-section">[main]</span> INFO  RaftNode - Loaded persistent state: <span class="hljs-attr">term</span>=<span class="hljs-number">0</span>, votedFor=null
2024-11-18 22:49:23.162 <span class="hljs-section">[main]</span> INFO  RaftService - RaftService started for node node-1
</code></pre>
<p><strong>â†‘ èŠ‚ç‚¹å¯åŠ¨ï¼Œåˆå§‹åŒ–ä¸ºFollowerï¼Œterm=0</strong></p>
<hr/>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">2024-11-18 22:49:23.450</span> [<span class="hljs-string">pool-2-thread-1</span>] <span class="hljs-string">INFO</span>  <span class="hljs-string">RaftNode</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Election</span> <span class="hljs-string">timeout</span> <span class="hljs-string">reached,</span> <span class="hljs-attr">current state:</span> <span class="hljs-string">FOLLOWER</span>
<span class="hljs-number">2024-11-18 22:49:23.451</span> [<span class="hljs-string">pool-2-thread-1</span>] <span class="hljs-attr">INFO  RaftNode - State changed:</span> <span class="hljs-string">FOLLOWER</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">CANDIDATE,</span> <span class="hljs-attr">term:</span> <span class="hljs-number">0</span> <span class="hljs-string">-&gt;</span> <span class="hljs-number">1</span>
<span class="hljs-number">2024-11-18 22:49:23.452</span> [<span class="hljs-string">pool-2-thread-1</span>] <span class="hljs-attr">INFO  FileStatePersistence - Saved persistent state:</span> <span class="hljs-string">term=1,</span> <span class="hljs-string">votedFor=node-1</span>
</code></pre>
<p><strong>â†‘ é€‰ä¸¾è¶…æ—¶(~300ms)ï¼Œè½¬ä¸ºCandidateï¼Œtermå˜æˆ1ï¼ŒæŠ•ç¥¨ç»™è‡ªå·±å¹¶æŒä¹…åŒ–</strong></p>
<hr/>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-number">2024</span><span class="hljs-number">-11</span><span class="hljs-number">-18</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">23.453</span> [pool<span class="hljs-number">-2</span>-thread<span class="hljs-number">-1</span>] INFO  RaftService - Starting election <span class="hljs-keyword">for</span> term <span class="hljs-number">1</span>
<span class="hljs-number">2024</span><span class="hljs-number">-11</span><span class="hljs-number">-18</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">23.454</span> [pool<span class="hljs-number">-3</span>-thread<span class="hljs-number">-1</span>] INFO  RaftService - Sending vote <span class="hljs-built_in">request</span> <span class="hljs-keyword">to</span> localhost:<span class="hljs-number">8082</span>
<span class="hljs-number">2024</span><span class="hljs-number">-11</span><span class="hljs-number">-18</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">23.454</span> [pool<span class="hljs-number">-3</span>-thread<span class="hljs-number">-2</span>] INFO  RaftService - Sending vote <span class="hljs-built_in">request</span> <span class="hljs-keyword">to</span> localhost:<span class="hljs-number">8083</span>
</code></pre>
<p><strong>â†‘ å‘èµ·é€‰ä¸¾ï¼Œå¹¶è¡Œå‘å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹å‘é€æŠ•ç¥¨è¯·æ±‚</strong></p>
<hr/>
<pre><code class="hljs language-ini" lang="ini">2024-11-18 22:49:23.512 <span class="hljs-section">[pool-3-thread-1]</span> INFO  RaftService - Received vote response from localhost:8082: <span class="hljs-attr">granted</span>=<span class="hljs-literal">true</span>, term=<span class="hljs-number">1</span>
2024-11-18 22:49:23.513 <span class="hljs-section">[pool-3-thread-2]</span> INFO  RaftService - Received vote response from localhost:8083: <span class="hljs-attr">granted</span>=<span class="hljs-literal">true</span>, term=<span class="hljs-number">1</span>
</code></pre>
<p><strong>â†‘ æ”¶åˆ°å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹çš„æŠ•ç¥¨ï¼Œéƒ½æ˜¯åŒæ„(granted=true)</strong></p>
<hr/>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">2024-11-18 22:49:23.514</span> [<span class="hljs-string">pool-3-thread-1</span>] <span class="hljs-string">INFO</span>  <span class="hljs-string">RaftNode</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Received</span> <span class="hljs-string">majority</span> <span class="hljs-string">votes</span> <span class="hljs-string">(3/3),</span> <span class="hljs-string">becoming</span> <span class="hljs-string">LEADER</span>
<span class="hljs-number">2024-11-18 22:49:23.514</span> [<span class="hljs-string">pool-3-thread-1</span>] <span class="hljs-attr">INFO  RaftNode - State changed:</span> <span class="hljs-string">CANDIDATE</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">LEADER</span>
</code></pre>
<p><strong>â†‘ è·å¾—å¤šæ•°ç¥¨(3ç¥¨â‰¥2ç¥¨)ï¼Œæˆä¸ºLeader</strong></p>
<hr/>
<pre><code class="hljs language-ini" lang="ini">2024-11-18 22:49:23.565 <span class="hljs-section">[pool-2-thread-2]</span> INFO  RaftService - Sending heartbeats to 2 peers, <span class="hljs-attr">term</span>=<span class="hljs-number">1</span>
2024-11-18 22:49:23.615 <span class="hljs-section">[pool-2-thread-2]</span> INFO  RaftService - Sending heartbeats to 2 peers, <span class="hljs-attr">term</span>=<span class="hljs-number">1</span>
2024-11-18 22:49:23.665 <span class="hljs-section">[pool-2-thread-2]</span> INFO  RaftService - Sending heartbeats to 2 peers, <span class="hljs-attr">term</span>=<span class="hljs-number">1</span>
</code></pre>
<p><strong>â†‘ Leaderæ¯50mså‘é€ä¸€æ¬¡å¿ƒè·³</strong></p>
<hr/>
<p><strong>åŒæ—¶çœ‹Node-2çš„æ—¥å¿—ï¼ˆFollowerè§†è§’ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">tail</span> -f /tmp/raft-node-2.<span class="hljs-built_in">log</span>
</code></pre>
<pre><code class="hljs language-ini" lang="ini">2024-11-18 22:49:23.480 <span class="hljs-section">[http-nio-8082-exec-1]</span> INFO  RaftController - Received RequestVote: {term:1, candidateId:node-1}
2024-11-18 22:49:23.481 <span class="hljs-section">[http-nio-8082-exec-1]</span> INFO  RaftNode - Received RequestVote from node-1 for term 1
2024-11-18 22:49:23.482 <span class="hljs-section">[http-nio-8082-exec-1]</span> INFO  RaftNode - Granting vote to node-1 for term 1
2024-11-18 22:49:23.483 <span class="hljs-section">[http-nio-8082-exec-1]</span> INFO  FileStatePersistence - Saved persistent state: <span class="hljs-attr">term</span>=<span class="hljs-number">1</span>, votedFor=node-<span class="hljs-number">1</span>
</code></pre>
<p><strong>â†‘ Followeræ”¶åˆ°æŠ•ç¥¨è¯·æ±‚ï¼ŒåŒæ„æŠ•ç¥¨ï¼ŒæŒä¹…åŒ–votedFor=node-1</strong></p>
<hr/>
<pre><code class="hljs language-ini" lang="ini">2024-11-18 22:49:23.570 <span class="hljs-section">[http-nio-8082-exec-2]</span> INFO  RaftController - Received AppendEntries: {term:1, leaderId:node-1}
2024-11-18 22:49:23.571 <span class="hljs-section">[http-nio-8082-exec-2]</span> INFO  RaftNode - Received heartbeat from Leader node-1, <span class="hljs-attr">term</span>=<span class="hljs-number">1</span>
2024-11-18 22:49:23.571 <span class="hljs-section">[http-nio-8082-exec-2]</span> INFO  RaftNode - Resetting election timeout
</code></pre>
<p><strong>â†‘ Followeræ”¶åˆ°Leaderçš„å¿ƒè·³ï¼Œé‡ç½®é€‰ä¸¾è¶…æ—¶</strong></p>
<hr/>
<pre><code class="hljs language-css" lang="css"><span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-<span class="hljs-number">18</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">23.620</span> [http-nio-<span class="hljs-number">8082</span>-exec-<span class="hljs-number">3</span>] INFO  RaftController - Received AppendEntries: {term:<span class="hljs-number">1</span>, leaderId:node-<span class="hljs-number">1</span>}
<span class="hljs-number">2024</span>-<span class="hljs-number">11</span>-<span class="hljs-number">18</span> <span class="hljs-number">22</span>:<span class="hljs-number">49</span>:<span class="hljs-number">23.670</span> [http-nio-<span class="hljs-number">8082</span>-exec-<span class="hljs-number">4</span>] INFO  RaftController - Received AppendEntries: {term:<span class="hljs-number">1</span>, leaderId:node-<span class="hljs-number">1</span>}
</code></pre>
<p><strong>â†‘ æŒç»­æ”¶åˆ°å¿ƒè·³ï¼Œæ¯50msä¸€æ¬¡</strong></p>
<hr/>
<p><strong>æ—¥å¿—æ—¶é—´çº¿åˆ†æï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">gantt
    title é€‰ä¸¾è¿‡ç¨‹æ—¶é—´çº¿ï¼ˆæ¯«ç§’çº§ï¼‰
    dateFormat x
    axisFormat %L
    
    section Node-1
    å¯åŠ¨åˆå§‹åŒ–          :0, 23156
    ç­‰å¾…é€‰ä¸¾è¶…æ—¶        :23156, 23450
    æˆä¸ºCandidate       :23450, 23452
    å‘é€æŠ•ç¥¨è¯·æ±‚        :23453, 23454
    æ”¶åˆ°æŠ•ç¥¨å“åº”        :23512, 23514
    æˆä¸ºLeader          :23514, 23515
    å‘é€å¿ƒè·³            :23565, 150000
    
    section Node-2
    å¯åŠ¨åˆå§‹åŒ–          :0, 23160
    ç­‰å¾…                :23160, 23480
    æ”¶åˆ°æŠ•ç¥¨è¯·æ±‚        :23480, 23481
    æŠ•ç¥¨ç»™Node-1        :23481, 23483
    æ”¶åˆ°å¿ƒè·³            :23570, 150000
</code></pre>
<p><strong>å…³é”®æ—¶é—´ç‚¹ï¼š</strong></p>
<ul>
<li><strong>23.156s</strong>: Node-1å¯åŠ¨</li>
<li><strong>23.450s</strong>: Node-1é€‰ä¸¾è¶…æ—¶ï¼ˆç­‰äº†294msï¼‰</li>
<li><strong>23.453s</strong>: å‘èµ·é€‰ä¸¾</li>
<li><strong>23.480s</strong>: Node-2æ”¶åˆ°æŠ•ç¥¨è¯·æ±‚ï¼ˆç½‘ç»œå»¶è¿Ÿ27msï¼‰</li>
<li><strong>23.512s</strong>: Node-1æ”¶åˆ°ç¬¬ä¸€å¼ æŠ•ç¥¨ï¼ˆæ€»å»¶è¿Ÿ59msï¼‰</li>
<li><strong>23.514s</strong>: è·å¾—å¤šæ•°ç¥¨ï¼Œæˆä¸ºLeaderï¼ˆæ€»è€—æ—¶64msï¼‰</li>
<li><strong>23.565s</strong>: å¼€å§‹å‘é€å¿ƒè·³</li>
</ul>
<h2 data-id="heading-16">äº”ã€ä¸Nacos JRaftçš„å¯¹æ¯”</h2>
<p>Simple Raftåªæœ‰500è¡Œä»£ç ï¼Œè€ŒJRaftæœ‰5ä¸‡è¡Œï¼Œå·®è·åœ¨å“ªï¼Ÿ</p>
<p>æˆ‘æ•´ç†äº†ä¸ªå¯¹æ¯”è¡¨ï¼š</p>























































<table><thead><tr><th>ç‰¹æ€§</th><th>Simple Raft</th><th>Nacos JRaft</th></tr></thead><tbody><tr><td>ä»£ç é‡</td><td>~500è¡Œ</td><td>~5ä¸‡è¡Œ</td></tr><tr><td>é€‰ä¸¾æœºåˆ¶</td><td>å®Œå…¨ä¸€è‡´</td><td>å®Œå…¨ä¸€è‡´</td></tr><tr><td>æŒä¹…åŒ–</td><td>æ–‡ä»¶ï¼ˆJSONï¼‰</td><td>RocksDB</td></tr><tr><td>RPC</td><td>HTTP + JSON</td><td>gRPC/Bolt</td></tr><tr><td>æ—¥å¿—å¤åˆ¶</td><td>æœªå®ç°</td><td>å®Œæ•´å®ç°</td></tr><tr><td>å¿«ç…§</td><td>æœªå®ç°</td><td>å®Œæ•´å®ç°</td></tr><tr><td>æ€§èƒ½</td><td>å¤Ÿç”¨ï¼ˆdemoï¼‰</td><td>ç”Ÿäº§çº§ï¼ˆä¸‡çº§TPSï¼‰</td></tr><tr><td>PreVoteä¼˜åŒ–</td><td>æ— </td><td>æœ‰</td></tr><tr><td>Pipelineå¤åˆ¶</td><td>æ— </td><td>æœ‰</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒæ€æƒ³æ˜¯ä¸€æ ·çš„</strong>ï¼Œå·®è·åœ¨å·¥ç¨‹å®ç°ä¸Šã€‚</p>
<p>JRaftåšäº†å¤§é‡ä¼˜åŒ–ï¼š</p>
<ul>
<li>æ‰¹é‡å¤åˆ¶æ—¥å¿—</li>
<li>Pipelineé™ä½å»¶è¿Ÿ</li>
<li>RocksDBæŒä¹…åŒ–</li>
<li>è¯¦å°½çš„ç›‘æ§æŒ‡æ ‡</li>
</ul>
<p>ä½†è¿™äº›éƒ½ä¸æ˜¯Raftçš„æ ¸å¿ƒã€‚<strong>æˆ‘ä»¬å…ˆæŠŠæ ¸å¿ƒææ‡‚ï¼Œä¼˜åŒ–ä»¥åå†è¯´ã€‚</strong></p>
<h2 data-id="heading-17">å…­ã€å¸¸è§çš„å®ç°é—®é¢˜</h2>
<h3 data-id="heading-18">é—®é¢˜1ï¼šå¹¶å‘å®‰å…¨</h3>
<p>ä»…ç”¨volatileä¸å¤Ÿï¼Œ<code>currentTerm++</code>å’Œ<code>state=CANDIDATE</code>ä¸æ˜¯åŸå­æ“ä½œï¼Œå¯èƒ½å‡ºç°termå·²ç»+1ä½†stateè¿˜æ˜¯FOLLOWERçš„æƒ…å†µã€‚</p>
<p>éœ€è¦ç”¨ReentrantLockä¿æŠ¤æ‰€æœ‰çŠ¶æ€å˜æ›´æ“ä½œã€‚</p>
<h3 data-id="heading-19">é—®é¢˜2ï¼šé€‰ä¸¾è¶…æ—¶æœªéšæœºåŒ–</h3>
<p>å¦‚æœæ‰€æœ‰èŠ‚ç‚¹çš„é€‰ä¸¾è¶…æ—¶éƒ½æ˜¯å›ºå®šå€¼(æ¯”å¦‚200ms)ï¼Œä¼šå¯¼è‡´å¤šä¸ªèŠ‚ç‚¹åŒæ—¶è¶…æ—¶ã€åŒæ—¶å‘èµ·é€‰ä¸¾ã€äº’ç›¸æŠ•ç¥¨ç»™è‡ªå·±ï¼Œä¸€ç›´å¹³ç¥¨ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šè®¾ç½®éšæœºçš„é€‰ä¸¾è¶…æ—¶(150-300ms)ï¼Œè®©æŸä¸ªèŠ‚ç‚¹å…ˆå‘èµ·é€‰ä¸¾ã€‚</p>
<h3 data-id="heading-20">é—®é¢˜3ï¼šå¿ƒè·³å¤±è´¥åLeaderæœªé™çº§</h3>
<p>Leaderå’ŒFolloweræ–­ç½‘åï¼ŒLeaderå¯èƒ½ç»§ç»­è®¤ä¸ºè‡ªå·±æ˜¯Leaderã€‚</p>
<p>åŸå› ï¼šå¿ƒè·³å¤±è´¥ååªæ‰“æ—¥å¿—ï¼Œæ²¡æœ‰æ£€æŸ¥å“åº”çš„termã€‚æ­£ç¡®åšæ³•ï¼š<strong>æ”¶åˆ°æ›´é«˜termï¼Œç«‹å³é™çº§</strong>ã€‚</p>
<h3 data-id="heading-21">é—®é¢˜4ï¼šæŒä¹…åŒ–æ—¶æœºé”™è¯¯</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é”™è¯¯å†™æ³•</span>
votedFor = candidateId;
<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestVoteResponse</span>(currentTerm, <span class="hljs-literal">true</span>);
savePersistentState();  <span class="hljs-comment">// æ°¸è¿œæ‰§è¡Œä¸åˆ°</span>

<span class="hljs-comment">// æ­£ç¡®å†™æ³•</span>
votedFor = candidateId;
savePersistentState();  <span class="hljs-comment">// å…ˆæŒä¹…åŒ–</span>
<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestVoteResponse</span>(currentTerm, <span class="hljs-literal">true</span>);
</code></pre>
<p>çŠ¶æ€å˜æ›´å¿…é¡»å…ˆæŒä¹…åŒ–å†è¿”å›ï¼Œè¿™æ˜¯Raftå®‰å…¨æ€§çš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-22">ä¸ƒã€å½“å‰å®ç°çš„å±€é™</h2>
<p>é€šè¿‡è¿™ä¸ªMVPç‰ˆæœ¬ï¼Œæˆ‘ä»¬è·‘é€šäº†Raftçš„Leaderé€‰ä¸¾å’Œå¿ƒè·³æœºåˆ¶ã€‚3ä¸ªèŠ‚ç‚¹èƒ½æ­£å¸¸é€‰ä¸¾ï¼ŒLeaderèƒ½ç»´æŒç»Ÿæ²»ï¼ŒèŠ‚ç‚¹é‡å¯åèƒ½æ­£ç¡®æ¢å¤ã€‚</p>
<p>ä½†è¿™åªæ˜¯Raftçš„å…¥é—¨ã€‚<strong>å½“å‰å®ç°è¿˜ç¼ºå°‘æœ€æ ¸å¿ƒçš„åŠŸèƒ½ï¼š</strong></p>
<h3 data-id="heading-23">æ²¡æœ‰æ—¥å¿—å¤åˆ¶</h3>
<p>ç°åœ¨çš„Leaderåªä¼šå‘å¿ƒè·³ï¼Œä¸ä¼šå¤„ç†ä»»ä½•ä¸šåŠ¡è¯·æ±‚ã€‚é€‰ä¸¾åªæ˜¯è§£å†³äº†"è°æ¥åè°ƒ"ï¼Œè¿˜æ²¡æœ‰è§£å†³"æ€ä¹ˆåè°ƒ"ã€‚</p>
<p>å›é¡¾ç¬¬ä¸€ç¯‡è¯´çš„ï¼šRaftçš„æ ¸å¿ƒæ˜¯ä¿è¯æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç›¸åŒé¡ºåºæ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ç°åœ¨æˆ‘ä»¬åªæœ‰Leaderï¼Œä½†æ²¡æœ‰"æ“ä½œ"å’Œ"é¡ºåº"ã€‚</p>
<h3 data-id="heading-24">æ²¡æœ‰çŠ¶æ€æœº</h3>
<p>æ—¥å¿—å¤åˆ¶åï¼Œéœ€è¦åº”ç”¨åˆ°çŠ¶æ€æœºã€‚è¿™æ‰æ˜¯Raftçš„æœ€ç»ˆç›®çš„ï¼šæ„å»ºä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€æœºã€‚</p>
<h3 data-id="heading-25">æ²¡æœ‰è¿‡åŠæäº¤æœºåˆ¶</h3>
<p>Leaderå¦‚ä½•çŸ¥é“æ—¥å¿—å·²ç»è¢«å¤šæ•°èŠ‚ç‚¹æ¥æ”¶ï¼Ÿä»€ä¹ˆæ—¶å€™å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯"å†™å…¥æˆåŠŸ"ï¼Ÿè¿™äº›éƒ½éœ€è¦å®ç°ã€‚</p>
<h3 data-id="heading-26">æ—¥å¿—ä¸€è‡´æ€§æ£€æŸ¥</h3>
<p>å¦‚æœFollowerçš„æ—¥å¿—å’ŒLeaderä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿå¦‚ä½•é€šè¿‡prevLogIndex/prevLogTermæ£€æŸ¥ä¸€è‡´æ€§ï¼Ÿå†²çªäº†å¦‚ä½•å¤„ç†ï¼Ÿ</p>
<p><strong>è¿™äº›é—®é¢˜ï¼Œéƒ½åœ¨ä¸‹ä¸€ç¯‡è§£å†³ã€‚</strong></p>
<p>ä¸‹ä¸€ç¯‡å°†å®ç°æ—¥å¿—å¤åˆ¶æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>AppendEntriesæºå¸¦æ—¥å¿—æ¡ç›®</li>
<li>æ—¥å¿—ä¸€è‡´æ€§æ£€æŸ¥</li>
<li>è¿‡åŠç¡®è®¤ä¸æäº¤</li>
<li>ç®€å•çš„KVçŠ¶æ€æœº</li>
</ul>
<p>é‚£æ—¶å€™æ‰ç®—çœŸæ­£ç†è§£äº†Raftçš„æ ¸å¿ƒã€‚</p>
<hr/>
<p>å¦‚æœä½ ä¹Ÿåœ¨å­¦ä¹ Raftï¼Œæˆ–è€…å¯¹åˆ†å¸ƒå¼å…±è¯†æœ‰è‡ªå·±çš„ç†è§£ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµã€‚æœ‰é—®é¢˜ä¹Ÿå¯ä»¥ç›´æ¥ç•™è¨€ï¼Œçœ‹åˆ°ä¼šå›å¤ã€‚</p>
<p>ä»£ç å·²å¼€æºï¼Œæ¬¢è¿Starï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsimple-raft" target="_blank" title="https://gitee.com/sh_wangwanbao/simple-raft" ref="nofollow noopener noreferrer">gitee.com/sh_wangwanbâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äºŒå‰æ ‘çš„ä¸‰ç§è¿­ä»£éå†ï¼ˆæ— æ ˆç‰ˆæœ¬ï¼‰-- æˆ‘åœ¨é©¬å…‹æ€ä¸»ä¹‰è¯¾ä¸Šçš„ä¸€äº›å·§æ€]]></title>    <link>https://juejin.cn/post/7575021014033645587</link>    <guid>https://juejin.cn/post/7575021014033645587</guid>    <pubDate>2025-11-22T03:54:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575021014033645587" data-draft-id="7574718964045398066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äºŒå‰æ ‘çš„ä¸‰ç§è¿­ä»£éå†ï¼ˆæ— æ ˆç‰ˆæœ¬ï¼‰-- æˆ‘åœ¨é©¬å…‹æ€ä¸»ä¹‰è¯¾ä¸Šçš„ä¸€äº›å·§æ€"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-11-22T03:54:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shemol"/> <meta itemprop="url" content="https://juejin.cn/user/1927864794744251"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äºŒå‰æ ‘çš„ä¸‰ç§è¿­ä»£éå†ï¼ˆæ— æ ˆç‰ˆæœ¬ï¼‰-- æˆ‘åœ¨é©¬å…‹æ€ä¸»ä¹‰è¯¾ä¸Šçš„ä¸€äº›å·§æ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927864794744251/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shemol
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T03:54:53.000Z" title="Sat Nov 22 2025 03:54:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰æƒ…æè¦</h2>
<p>äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼šæœ¬äººè¿‘æ—¥è·Ÿç€é‚“ä¿Šè¾‰çš„ç½‘è¯¾å­¦ä¹ æ•°æ®ç»“æ„ï¼ˆä¸çŸ¥é“æœ‰æ²¡æœ‰å¬è¿‡çš„ï¼Œè®²å¾—çœŸçš„å¾ˆå¥½ï¼‰ï¼Œåœ¨å­¦ä¹ åˆ°äºŒå‰æ ‘çš„ä¸‰ç§éå†ï¼Œä¹Ÿå°±æ˜¯å…ˆåºã€ä¸­åºã€ååºè¿™ä¸‰ç§æ—¶ï¼Œå¯¹è¯¾å ‚ä¸Šæä¾›çš„ç®—æ³•æœ‰äº›ä¸æ»¡ï¼šä¸‰ç§ç®—æ³•å…¨éƒ½é‡‡ç”¨å¼•å…¥ä¸€ä¸ªè¾…åŠ©æ ˆçš„æ–¹æ³•æ¥ç¡®å®šèŠ‚ç‚¹çš„éå†é¡ºåºã€‚</p>
<p>è¿™æ ·çš„ç®—æ³•åœ¨æˆ‘çš„çœ¼ä¸­ï¼Œä¸å¤Ÿä¼˜é›…ã€‚è€å¸ˆåœ¨äºŒå‰æ ‘éå†çš„ç¬¬ä¸€èŠ‚è¯¾å°±è¯´è¿‡ï¼Œéšç€äºŒå‰æ ‘çš„è§„æ¨¡ã€æ·±åº¦å¢å¤§ï¼Œé€’å½’éå†ç‰ˆæœ¬ä¼šå‡ºç°â€œå‡½æ•°è°ƒç”¨æ ˆæº¢å‡ºâ€çš„é—®é¢˜ã€‚ç°åœ¨ä¼˜åŒ–ä¸ºäº†è¿­ä»£ç‰ˆæœ¬ï¼Œå´ä¾ç„¶æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>äºæ˜¯æˆ‘å°±å¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œèµ°å‘äº†é©¬å…‹æ€ä¸»ä¹‰çš„æ•™å®¤ï¼ˆæœ¬äººå¼€å­¦ä»¥æ¥ç¬¬ä¸€æ¬¡è§åˆ°è¿™è€å¸ˆï¼Œå…¶ä»–æ—¶é—´éƒ½æ˜¯åœ¨å¯å®¤è‡ªå­¦ï¼Œä»Šå¤©å¬è¯´æœ‰æœŸä¸­è€ƒè¯•æ‰æ¥çš„ï¼‰ã€‚è¯¾ä¸Šå®åœ¨æ— èŠï¼Œæˆ‘å£è¢‹é‡Œåˆæ­£å¥½æœ‰ä¸€å¼ è‰ç¨¿çº¸ã€‚é—²æ¥æ— äº‹ï¼Œåœ¨ä¸Šé¢ç”»äº†ä¸€æ£µæ ‘ã€‚</p>
<p>å†å²ä¸Šä¹Ÿä¸ä¹è¿™æ ·çš„æ—¶åˆ»--çµæ„Ÿæ€»æ˜¯åœ¨ä¸ç»æ„é—´æ¶Œç°ã€‚æˆ‘æŠŠç›®å…‰ä»æ•´ä½“çš„é€’å½’ï¼Œæˆ–è€…è¯´è¿­ä»£ç­–ç•¥ï¼Œè½¬å‘äº†å±€éƒ¨ï¼ŒèŠ‚ç‚¹ä¸èŠ‚ç‚¹ä¹‹é—´çš„é€»è¾‘è”ç³»ã€‚äºæ˜¯å‘ç°äº†ä¸€ç§åŸºäºçˆ¶æŒ‡é’ˆçš„ï¼Œä¸éœ€è¦è¾…åŠ©æ ˆçš„è¿­ä»£éå†ç­–ç•¥ã€‚è¿™æ ·çš„å‘ç°ä¸èƒ½è¯´ä¸ä»¤äººæ¬£å–œï¼Œäºæ˜¯å†™ä¸‹æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ï¼Œä»¥ä½œçºªå¿µã€‚</p>
<h2 data-id="heading-1">ç®—æ³•æ€è·¯ä¸å®ç°</h2>
<p>æˆ‘çš„ç®—æ³•åŸºäºçˆ¶æŒ‡é’ˆæ¥ç»´ç³»èŠ‚ç‚¹ä¹‹é—´çš„é€»è¾‘è”ç³»ã€‚è¿™å¤§æ¦‚æ˜¯å…¶å”¯ä¸€çš„ç¼ºç‚¹ã€‚ä½†æ˜¯ï¼Œè€—è´¹ä¸æ ˆç›¸å½“çš„ç©ºé—´ï¼ˆå¯¹äºå·²ç»æä¾›çˆ¶æŒ‡é’ˆçš„æƒ…æ™¯ï¼Œé¢å¤–çš„ç©ºé—´æ˜¯O(1)ï¼‰ï¼Œä¸ä»…èƒ½å¤Ÿè§£å†³æ ˆæº¢å‡ºçš„é—®é¢˜ï¼Œè€Œä¸”åœ¨å½¢å¼ä¸Šï¼Œä¸‰ç§éå†ç®—æ³•é«˜åº¦ç»Ÿä¸€ï¼Œæˆ‘è‡ªè®¤ä¸ºç®—æ˜¯ä¸ªä¼˜é›…ä¸”ä¼˜ç§€çš„ç®—æ³•ã€‚</p>
<h3 data-id="heading-2">å…ˆåºéå†ï¼šV-&gt;L-&gt;R</h3>
<p>å…ˆä»å…ˆåºéå†å¼€å§‹å§ï¼Œæˆ‘ä»¬æœ‰ä¸€æ£µäºŒå‰æ ‘ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fa422cc04a14323839ec8ed296a11a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlbW9s:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764388493&amp;x-signature=IpnrWdBR09VoNVbvWJ4a2GRJpwM%3D" alt="image.png" loading="lazy"/></p>
<p>æ€è·¯æ˜¯è¿™æ ·çš„ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚åœ¨ä»»æ„æ—¶åˆ»ï¼Œæˆ‘ä»¬å…ˆéå†å½“å‰èŠ‚ç‚¹ï¼Œç„¶åé¢ä¸´çš„æ— éè¿™å‡ ç§æƒ…å†µï¼š</p>
<pre><code class="hljs">å½“å‰èŠ‚ç‚¹æœ‰å·¦å­©å­ï¼Œé‚£å°±ç»§ç»­å»éå†å·¦å­©å­ã€‚
å½“å‰èŠ‚ç‚¹æ²¡æœ‰å·¦å­©å­ï¼ˆå·¦å­©å­ä¸ºç©ºï¼‰ï¼Œä½†æ˜¯æœ‰å³å­©å­ï¼Œé‚£å°±å»éå†å³å­©å­ã€‚
å½“å‰èŠ‚ç‚¹æ—¢æ²¡æœ‰å·¦å­©å­ï¼Œä¹Ÿæ²¡æœ‰å³å­©å­ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰ï¼Œé‚£å°±è¦å›æº¯äº†ã€‚
</code></pre>
<p>å›æº¯åˆ°ä»€ä¹ˆæ—¶å€™å‘¢ï¼Ÿå›æº¯æ—¶ä¹Ÿæ— éä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸å¦¨è®¨è®ºä¸€ä¸‹ï¼Œä½¿å¾—ä½ çš„æ€è·¯æ›´åŠ æ¸…æ™°ï¼š</p>
<p>ä¸€ã€å›æº¯æ—¶ï¼Œè‡ªå·±æ˜¯çˆ¶èŠ‚ç‚¹çš„â€œéç‹¬ç”Ÿâ€å·¦å­©å­ã€‚è¿™å¾ˆå¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªçˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘éå†å®Œäº†å˜›ï¼Œé‚£å°±æ¥ç€å»éå†ä»–çš„å³å­æ ‘</p>
<p>äºŒã€å›æº¯æ—¶ï¼Œè‡ªå·±æ˜¯çˆ¶èŠ‚ç‚¹çš„â€œç‹¬ç”Ÿâ€å·¦å­©å­ï¼Œæˆ–æ˜¯å³å­©å­ã€‚ä¹Ÿå¾ˆå¥½ç†è§£å§ï¼Œé‚£è¿™ä¸ªçˆ¶èŠ‚ç‚¹çš„å·¦å³å­æ ‘å°±å…¨éƒ¨éå†å®Œäº†ï¼æˆ‘ä»¬å°±è·³è¿‡è¿™ä¸ªçˆ¶èŠ‚ç‚¹,ç»§ç»­å‘ä¸Šå›æº¯ï¼Œç›´åˆ°å®ƒæ˜¯çˆ¶èŠ‚ç‚¹çš„â€œéç‹¬ç”Ÿâ€å·¦å­©å­ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºå®Œäº†éå†ä¸­æ‰€æœ‰çš„æƒ…å†µï¼Œé‚£å¾ªç¯ä»€ä¹ˆæ—¶å€™é€€å‡ºå‘¢ï¼Ÿç­”æ¡ˆæ˜¯â€œæ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘è¢«éå†å®Œâ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å‰èŠ‚ç‚¹é‡æ–°å›åˆ°æ ¹èŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ä¸ºç©ºï¼‰æ—¶ï¼Œé€€å‡ºå¾ªç¯ï¼Œéå†ç»“æŸã€‚</p>
<p>ä¸‹é¢ç»™å‡ºä»£ç ï¼ˆè‡ªè®¤ä¸ºå®Œç¾ï¼Œæ¬¢è¿å¤§ä½¬æ¥æ‰¾bugï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">template&lt;typename T, typename VST&gt;
void <span class="hljs-built_in">traverse</span>(bin_node&lt;T&gt;* node, VST&amp; visit)
{
	if (node == nullptr) return;<span class="hljs-comment">//è¾¹ç•Œæƒ…å†µè€ƒè™‘</span>

	while (true)
	{
		<span class="hljs-built_in">visit</span>(node);<span class="hljs-comment">//å…ˆåºéå†</span>
		if (node-&gt;get_left_child() != nullptr) node = node-&gt;<span class="hljs-built_in">get_left_child</span>();<span class="hljs-comment">//å¦‚æœå·¦å­©å­å­˜åœ¨ï¼Œåˆ™ç»§ç»­æ·±å…¥</span>
		else if (node-&gt;get_right_child() != nullptr) node = node-&gt;<span class="hljs-built_in">get_right_child</span>();<span class="hljs-comment">//å¦‚æœæ²¡æœ‰å·¦å­©å­ï¼Œä½†æ˜¯æœ‰å³å­©å­ï¼Œåˆ™è½¬å‘å³å­©å­</span>

		<span class="hljs-comment">//å¦‚æœä¸ºå¶èŠ‚ç‚¹ï¼Œå¼€å§‹å›æº¯</span>
		else
		{
			while (true)
			{
				if (node-&gt;get_parent() == nullptr)break;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¯´æ˜æ•´æ£µæ ‘éå†å®Œäº†ï¼Œé€€å‡ºå¾ªç¯</span>
				if (node == node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_left_child</span>())<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œè®¨è®ºæ˜¯å¦â€œç‹¬ç”Ÿâ€</span>
				{
					if (node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_right_child</span>() == nullptr);<span class="hljs-comment">//å¦‚æœç‹¬ç”Ÿï¼Œé‚£å°±ç»§ç»­å›æº¯</span>
					else break;<span class="hljs-comment">//å¦‚æœéç‹¬ç”Ÿï¼Œå°±é€€å‡ºå¾ªç¯ï¼Œå»éå†çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘</span>
				}
				else;<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­©å­ï¼Œç»§ç»­å›æº¯</span>

				node = node-&gt;<span class="hljs-built_in">get_parent</span>();
			}
			if (node-&gt;get_parent() == nullptr) return;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹çš„ä¸Šæ–¹ï¼Œè¯´æ˜å·²ç»éå†å®Œäº†</span>
			node = node-&gt;<span class="hljs-built_in">get_parent</span>()-&gt;<span class="hljs-built_in">get_right_child</span>();<span class="hljs-comment">//å¦‚æœä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼Œè½¬å‘å³å­©å­</span>
		}
	}
}
</code></pre>
<h3 data-id="heading-3">ä¸­åºéå†</h3>
<p>æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡è¿™é‡Œè¦ç­‰åˆ°èŠ‚ç‚¹çš„å·¦å­æ ‘éå†å®Œå†éå†è¯¥èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3afc1a90d31c4a98b5c0d8b5700fe274~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlbW9s:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764388493&amp;x-signature=9vU0%2FFQlVGahiFbsdXFvBf9CHJ0%3D" alt="image.png" loading="lazy"/>
æˆ‘ä»¬ä¹Ÿåˆ†æƒ…å†µè®¨è®ºã€‚ä»æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚åœ¨ä»»æ„æ—¶åˆ»ï¼Œæˆ‘ä»¬å…ˆä¸éå†å½“å‰èŠ‚ç‚¹ï¼Œé¢ä¸´çš„æ— éè¿™å‡ ç§æƒ…å†µï¼š</p>
<pre><code class="hljs">å½“å‰èŠ‚ç‚¹æœ‰å·¦å­©å­ï¼Œé‚£å°±è½¬å‘å·¦å­©å­
å½“å‰èŠ‚ç‚¹æ²¡æœ‰å·¦å­©å­ï¼Œä½†æ˜¯æœ‰å³å­©å­ã€‚é‚£å°±åˆ°äº†è¿™ä¸ªèŠ‚ç‚¹è¢«éå†çš„æ—¶å€™äº†ã€‚å®ƒè¢«éå†ä¹‹åï¼Œè¦è½¬å‘ä»–çš„å³å­©å­ã€‚
å½“å‰èŠ‚ç‚¹ä¸ºå¶èŠ‚ç‚¹ï¼Œé‚£å°±å¼€å§‹å›æº¯
</code></pre>
<p>å›æº¯çš„æ—¶å€™å‘¢ï¼Œä¹Ÿæ— éä¸‹é¢å‡ ç§æƒ…å†µï¼š</p>
<p>ä¸€ã€å½“å‰èŠ‚ç‚¹ä¸ºå·¦å­©å­ï¼Œé‚£å°±è¯´æ˜ä»–çš„çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘å·²ç»éå†å®Œäº†ï¼Œéå†ä»–çš„çˆ¶èŠ‚ç‚¹ã€‚å¦‚æœè¿™ä¸ªçˆ¶èŠ‚ç‚¹æœ‰å³å­©å­å‘¢ï¼Œå°±å»éå†ï¼Œå¦‚æœæ²¡æœ‰é‚£å°±ç»§ç»­å‘ä¸Šå›æº¯ã€‚</p>
<p>äºŒã€å½“å‰èŠ‚ç‚¹ä¸ºå³å­©å­ï¼Œé‚£è¯´æ˜å®ƒçš„çˆ¶èŠ‚ç‚¹æ˜¯ä¸ç”¨éå†çš„ï¼Œå‘ä¸Šå›æº¯ã€‚</p>
<p>ï¼ˆå†™åˆ°è¿™é‡Œï¼Œä¸å¾—ä¸æ„Ÿå¹ä¸€å¥ï¼šè¿™å†™æ–‡ç« å’Œåœ¨è„‘å­é‡Œæƒ³çœŸä¸æ˜¯ä¸€å›äº‹å•Šã€‚è„‘å­é‡Œçš„æ€è·¯é€æ˜å¦‚æ°´æ™¶ï¼Œä¸€åˆ°æƒ³è¦å†™ä¸‹æ¥æ—¶å´æ‰¾ä¸ç€ä¸œå—è¥¿åŒ—ã€‚ï¼‰</p>
<pre><code class="hljs language-scss" lang="scss">template&lt;typename T, typename VST&gt;
void <span class="hljs-built_in">my_traverse_middle</span>(bin_node&lt;T&gt;* node, VST&amp; visit)
{
	if (node == nullptr) return;<span class="hljs-comment">//è¾¹ç•Œæƒ…å†µ</span>

	while (true)
	{
		if (node-&gt;get_left_child() != nullptr) node = node-&gt;<span class="hljs-built_in">get_left_child</span>();<span class="hljs-comment">//å¦‚æœå·¦å­©å­å­˜åœ¨ï¼Œç»§ç»­æ·±å…¥</span>
		else<span class="hljs-comment">//å¦‚æœæ²¡æœ‰å·¦å­©å­ï¼Œé‚£å°±éå†å½“å‰èŠ‚ç‚¹</span>
		{
			<span class="hljs-built_in">visit</span>(node);
			if (node-&gt;get_right_child() != nullptr) node = node-&gt;<span class="hljs-built_in">get_right_child</span>();<span class="hljs-comment">//å¦‚æœæœ‰å³å­©å­ï¼Œé‚£å°±è½¬å‘å³å­©å­</span>

			else<span class="hljs-comment">//æ²¡æœ‰çš„è¯ï¼Œä¹Ÿå°±æ˜¯å¶èŠ‚ç‚¹ï¼Œå‘ä¸Šå›æº¯,ç›´åˆ°å½“å‰èŠ‚ç‚¹ä¸º"éç‹¬ç”Ÿ"å·¦å­©å­</span>
			{
				while (true)
				{
					if (node-&gt;get_parent() == nullptr)break;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¯´æ˜æ•´æ£µæ ‘éå†å®Œäº†ï¼Œé€€å‡ºå¾ªç¯</span>
					if (node == node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_left_child</span>())<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œå°±éå†çˆ¶èŠ‚ç‚¹ï¼Œå†è®¨è®ºæ˜¯å¦â€œç‹¬ç”Ÿâ€</span>
					{
						<span class="hljs-built_in">visit</span>(node-&gt;get_parent());
						if (node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_right_child</span>() != nullptr) break;<span class="hljs-comment">//å¦‚æœéç‹¬ç”Ÿï¼Œå°±å»éå†çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘</span>
						else;<span class="hljs-comment">//å¦‚æœç‹¬ç”Ÿï¼Œç»§ç»­å›æº¯</span>
					}
					else;<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­©å­ï¼Œç»§ç»­å›æº¯</span>

					node = node-&gt;<span class="hljs-built_in">get_parent</span>();
				}
				if (node-&gt;get_parent() == nullptr) return;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹çš„ä¸Šæ–¹ï¼Œè¯´æ˜éå†å®Œäº†</span>
				node = node-&gt;<span class="hljs-built_in">get_parent</span>()-&gt;<span class="hljs-built_in">get_right_child</span>();
			}
		}
	}
}
</code></pre>
<h3 data-id="heading-4">ååºéå†</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92c6b3cb4d9b4e93b9440604882cd7c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlbW9s:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764388493&amp;x-signature=qpqgnq%2FHOyhzoTOT8YoK0w8eSV4%3D" alt="image.png" loading="lazy"/></p>
<p>å¯¹äºååºéå†ï¼Œæˆ‘ä»¬ç†è§£è¿™æ ·ä¸€ä¸ªäº‹å®ï¼šå¯¹äºä»»æ„ä¸€æ£µï¼ˆå­ï¼‰æ ‘ï¼Œæˆ‘ä»¬æ€»æ˜¯å…ˆå»éå†æœ€å·¦è¾¹çš„å¶å­</p>
<p>ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæˆ‘ä»¬å‘ä¸‹éå†ï¼Œæ— éè¿™å‡ ç§æƒ…å†µï¼š</p>
<pre><code class="hljs">å½“å‰èŠ‚ç‚¹æœ‰å·¦å­©å­ï¼Œé‚£å°±ç»§ç»­å‘å·¦
å¦‚æœå½“å‰å­©å­æ²¡æœ‰å·¦å­©å­ï¼Œé‚£å°±å°è¯•å‘å³
å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ºå¶å­èŠ‚ç‚¹ï¼Œé‚£å°±éå†ï¼Œå¹¶å¼€å§‹å›æº¯
</code></pre>
<p>æˆ‘ä»¬æ¥ç€è®¨è®ºå›æº¯æ—¶çš„æƒ…å†µ</p>
<p>ä¸€ã€å½“å‰å­©å­ä¸ºâ€œéç‹¬ç”Ÿâ€å·¦å­©å­ï¼Œé‚£å°±å»éå†ä»–çš„çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘</p>
<p>äºŒã€å½“å‰èŠ‚ç‚¹ä¸ºâ€œç‹¬ç”Ÿâ€å·¦å­©å­ï¼Œæˆ–è€…å½“å‰èŠ‚ç‚¹ä¸ºå³å­©å­ï¼Œè¯´æ˜åˆ°äº†å®ƒçš„çˆ¶èŠ‚ç‚¹è¢«éå†çš„æ—¶å€™äº†</p>
<p>ä¸‹é¢ç»™å‡ºè¿™ä¸ªç®—æ³•çš„å®ç°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">template&lt;typename T, typename VST&gt;
void <span class="hljs-built_in">traverse</span>(bin_node&lt;T&gt;* node, VST&amp; visit)
{
	if (node == nullptr) return;<span class="hljs-comment">//è¾¹ç•Œæƒ…å†µ</span>

	while (true)
	{
		if (node-&gt;get_left_child() != nullptr)node = node-&gt;<span class="hljs-built_in">get_left_child</span>();<span class="hljs-comment">//å¦‚æœæœ‰å·¦å­©å­ï¼Œå°±å‘å·¦</span>
		else if (node-&gt;get_right_child() != nullptr)node = node-&gt;<span class="hljs-built_in">get_right_child</span>();<span class="hljs-comment">//å¦‚æœæ²¡æœ‰å·¦å­©å­ï¼Œä½†æ˜¯æœ‰å³å­©å­ï¼Œå°±å‘å³</span>

		else <span class="hljs-comment">//éƒ½æ²¡æœ‰ï¼Œè¯´æ˜æ˜¯å¶èŠ‚ç‚¹ï¼Œå¼€å§‹å›æº¯</span>
		{
			<span class="hljs-built_in">visit</span>(node);
			while (true)
			{
				if (node-&gt;get_parent() == nullptr)break;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹ï¼Œè¯´æ˜æ•´æ£µæ ‘éå†å®Œäº†ï¼Œé€€å‡ºå¾ªç¯</span>
				if (node == node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_left_child</span>())<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œè®¨è®ºæ˜¯å¦â€œç‹¬ç”Ÿâ€</span>
				{
					if (node-&gt;get_parent()-&gt;<span class="hljs-built_in">get_right_child</span>() == nullptr)<span class="hljs-built_in">visit</span>(node-&gt;get_parent());<span class="hljs-comment">//å¦‚æœç‹¬ç”Ÿï¼Œè¯´æ˜çˆ¶èŠ‚ç‚¹å·¦å³å­æ ‘å‡éå†å®Œï¼Œåˆ°äº†ä»–è¢«éå†çš„æ—¶å€™</span>
					else break;<span class="hljs-comment">//å¦‚æœéç‹¬ç”Ÿï¼Œå°±é€€å‡ºå¾ªç¯ï¼Œå»éå†çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘</span>
				}
				else<span class="hljs-comment">//å¦‚æœæ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­©å­ï¼Œé‚£å°±éå†çˆ¶èŠ‚ç‚¹ï¼Œç»§ç»­å›æº¯</span>
				{
					<span class="hljs-built_in">visit</span>(node-&gt;get_parent());
				}

				node = node-&gt;<span class="hljs-built_in">get_parent</span>();
			}
                        if (node-&gt;get_parent() == nullptr) return;<span class="hljs-comment">//å¦‚æœè¿½æº¯åˆ°æ ¹èŠ‚ç‚¹çš„ä¸Šæ–¹ï¼Œè¯´æ˜éå†å®Œäº†</span>
                        node = node-&gt;<span class="hljs-built_in">get_parent</span>()-&gt;<span class="hljs-built_in">get_right_child</span>();
		}

	}
}
</code></pre>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>æˆ‘è®¤ä¸ºè¿™ä¸ªç®—æ³•æ˜¯æœ‰ä»·å€¼çš„</p>
<p>é¦–å…ˆï¼Œç©ºé—´ä¸Šï¼šå¯¹äºè‡ªå¸¦çˆ¶æŒ‡é’ˆçš„æ ‘ï¼Œä»–çš„é¢å¤–ç©ºé—´å¤æ‚åº¦æ˜¯O(1),å°±ç®—æ˜¯ç®—ä¸Šçˆ¶æŒ‡é’ˆä¹Ÿä¸è¿‡O(n)ï¼Œè¿˜èƒ½é¿å…æ ˆæº¢å‡ºçš„é—®é¢˜ã€‚</p>
<p>å½¢å¼ä¸Šï¼Œä¸éš¾çœ‹å‡ºï¼Œä¸‰ç§éå†ç®—æ³•çš„é€»è¾‘å’Œä»£ç å®ç°éƒ½æ˜¯é«˜åº¦ç»Ÿä¸€çš„ã€‚</p>
<p>æ—¶é—´ä¸Šï¼Œçœå»äº†å…¥æ ˆå‡ºæ ˆçš„æ“ä½œï¼Œä»£ä»·æ˜¯æ¯ä¸ªéå¶å­èŠ‚ç‚¹éƒ½è¦è¢«nodeâ€œç»è¿‡â€ä¸¤æ¬¡ã€‚æ€»ä½“ä¸Šï¼Œæ—¶é—´å¤æ‚åº¦å¯¹æ¯”ä¼ ç»Ÿçš„è¾…åŠ©æ ˆæ–¹æ³•æ˜¯å°ä¼˜ï¼Œä»ç„¶æ˜¯O(n)</p>
<p>å½“ç„¶ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œé¦–å…ˆæ˜¯è¿™ä¸ªçˆ¶æŒ‡é’ˆçš„äº‹å§ï¼Œæˆ‘è·Ÿç€è¯¾å ‚ä¸Šå®ç°çš„äºŒå‰æ ‘ç‰ˆæœ¬æ˜¯è‡ªå¸¦çˆ¶æŒ‡é’ˆçš„ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¿™ä¸ªçˆ¶æŒ‡é’ˆçš„æ³›ç”¨æ€§å’‹æ ·ã€‚è¿˜æœ‰å°±æ˜¯ä»£ç é€»è¾‘å¯¹æ¯”ä¼ ç»Ÿçš„è¾…åŠ©æ ˆæ–¹æ³•ç¡®å®ä¸é‚£ä¹ˆç®€æ˜ï¼Œä½†æˆ‘è§‰å¾—è¿˜å¥½ã€‚ï¼ˆä¸çŸ¥é“çœ‹åˆ°è¿™é‡Œçš„ä½ çœ‹æ‡‚äº†å—ï¼Ÿï¼‰</p>
<p>äº‹å®ä¸Šï¼Œå¯¹äºå±‚æ¬¡éå†ï¼Œæˆ‘ä¹Ÿè‡ªå·±æ¨å¯¼å‡ºäº†â€œæ— é˜Ÿåˆ—ç‰ˆæœ¬â€ï¼Œä½†ä¸ºäº†ä¿è¯è¿™ç¯‡åšå®¢å†…å®¹çš„ç»Ÿä¸€æ€§ï¼Œå°±ä¸æ”¾åœ¨è¿™é‡Œäº†ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ç§ä¿¡äº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaæ²¡æœ‰æŒ‡é’ˆï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆå¹²Cè¯­è¨€é‡ŒæŒ‡é’ˆå¹²çš„æ´»çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7574997924931043368</link>    <guid>https://juejin.cn/post/7574997924931043368</guid>    <pubDate>2025-11-22T07:06:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574997924931043368" data-draft-id="7575103881420881974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaæ²¡æœ‰æŒ‡é’ˆï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆå¹²Cè¯­è¨€é‡ŒæŒ‡é’ˆå¹²çš„æ´»çš„ï¼Ÿ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-22T07:06:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XUN4J"/> <meta itemprop="url" content="https://juejin.cn/user/4179664935335515"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaæ²¡æœ‰æŒ‡é’ˆï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆå¹²Cè¯­è¨€é‡ŒæŒ‡é’ˆå¹²çš„æ´»çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4179664935335515/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XUN4J
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T07:06:01.000Z" title="Sat Nov 22 2025 07:06:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    20
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸€å¥è¯ç®€å•å›ç­”å°±æ˜¯ï¼š<strong>Javaè™½ç„¶æœ‰æŒ‡é’ˆï¼Œä½†åˆ°å¤„éƒ½æ˜¯æŒ‡é’ˆçš„å½±å­ï¼åªæ˜¯Javaé€šè¿‡JVMæŠŠå®ƒéšè—äº†èµ·æ¥ï¼Œä¸è®©ä½ ç”¨C/C++é‚£ç§æ˜¾å¼çš„æ–¹å¼æ“ä½œå®ƒã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªä¸œè¥¿ç§°ä¹‹ä¸ºâ€œå¼•ç”¨â€ã€‚</strong></p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€C/CPPæŒ‡é’ˆä¸Javaå¼•ç”¨çš„å¯¹æ¯”ï¼š</h3>
<p>C/CPPçš„æŒ‡é’ˆè¢«JVMåŒ…è£…æˆäº†æ›´åŠ å®‰å…¨çš„Javaå¼•ç”¨</p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>C++ æŒ‡é’ˆ</th><th>Java å¼•ç”¨</th></tr></thead><tbody><tr><td><strong>è¯­æ³•</strong>â€‹</td><td><code>MyClass *obj = new MyClass();</code></td><td><code>MyClass obj = new MyClass();</code></td></tr><tr><td><strong>æœ¬è´¨</strong>â€‹</td><td>å­˜å‚¨å¦ä¸€ä¸ªå˜é‡çš„å†…å­˜åœ°å€</td><td><strong>æœ¬è´¨ä¸Šä¹Ÿæ˜¯å­˜å‚¨å¯¹è±¡çš„å†…å­˜åœ°å€</strong>â€‹</td></tr><tr><td><strong>æ“ä½œ</strong>â€‹</td><td>å¯ä»¥è¿›è¡Œç®—æœ¯è¿ç®—ï¼ˆ<code>++</code>, <code>--</code>ï¼‰ã€ä»»æ„è½¬æ¢</td><td>ä¸èƒ½è¿›è¡Œç®—æœ¯è¿ç®—ï¼Œç±»å‹å®‰å…¨</td></tr><tr><td><strong>ç›®æ ‡</strong>â€‹</td><td>å¯ä»¥æŒ‡å‘ä»»ä½•å†…å­˜åœ°å€ï¼ˆåŒ…æ‹¬æ— æ•ˆçš„ï¼‰</td><td>åªèƒ½æŒ‡å‘æœ‰æ•ˆçš„å¯¹è±¡æˆ–<code>null</code></td></tr></tbody></table>
<p>æ‰€ä»¥è¯´ï¼Œå¹¶ä¸æ˜¯Javaé‡Œæ²¡æœ‰æŒ‡é’ˆï¼Œè€Œæ˜¯å¼ºå¤§çš„JVMå¸®æˆ‘ä»¬æŠŠæŒ‡é’ˆæ“ä½œæ›´åŒ…è£…æˆä¸€ä¸ªæ›´å®‰å…¨ã€ä¸éœ€è¦æ‹…å¿ƒå›æ”¶çš„å¼•ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€Javaæ‰§è¡ŒMyClass obj = new MyClass()åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ</h3>
<p>1ã€å£°æ˜å¼•ç”¨å˜é‡MyClass objæ—¶ï¼ŒJVMåœ¨å½“å‰æ–¹æ³•çš„æ ˆå¸§ï¼ˆStackä¸­ï¼‰ä¸­åˆ†é…ä¸€ä¸ªå¼•ç”¨å˜é‡çš„ç©ºé—´ç»™objï¼›</p>
<p>2ã€åˆ›å»ºå®ä¾‹åŒ–å¯¹è±¡new MyClass()æ—¶ï¼ŒJVMåœ¨å †åŒºï¼ˆHeapï¼‰åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥å­˜å‚¨MyClasså¯¹è±¡çš„æ‰€æœ‰æ•°æ®</p>
<p>3ã€å»ºç«‹æŒ‡å‘å…³ç³»=ï¼Œå°†å †ä¸­å¯¹è±¡çš„å†…å­˜åœ°å€èµ‹å€¼ç»™æ ˆä¸­çš„å¼•ç”¨å˜é‡objï¼Œä½¿å¾—å¼•ç”¨æŒ‡å‘å®ä¾‹åŒ–å¯¹è±¡ã€‚</p>
<p>è¡¥å……JVMæ¶æ„å›¾ï¼š</p>
<h2 data-id="heading-2"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/323cc03737a249d1be87fecf54fe3946~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWFVONEo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764473417&amp;x-signature=IbUHMLDevRi6%2BTmsGCbCUfn0C5c%3D" alt="image.png" loading="lazy"/></h2>
<h3 data-id="heading-3">ä¸‰ã€JVMè¿˜åŒ…è£…äº†å“ªäº›æœºåˆ¶</h3>
<ol>
<li>åƒåœ¾å›æ”¶æœºåˆ¶
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">MyClass</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>(); <span class="hljs-comment">// æ‰‹åŠ¨åˆ†é…</span>
<span class="hljs-comment">// ... ä½¿ç”¨å¯¹è±¡</span>
obj = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ— éœ€æ‰‹åŠ¨é‡Šæ”¾ï¼åƒåœ¾å›æ”¶å™¨ä¼šè‡ªåŠ¨å›æ”¶å†…å­˜</span>
</code></pre>
</li>
</ol>
<ul>
<li>Javaæœ‰ä¸€ä¸ªåå°çš„<strong>åƒåœ¾å›æ”¶å™¨GC</strong>ï¼Œå®ƒä¼šè‡ªåŠ¨ç›‘æ§å“ªäº›å¯¹è±¡ä¸å†è¢«ä»»ä½•å¼•ç”¨æŒ‡å‘ã€‚</li>
<li>å½“å¯¹è±¡å˜å¾—â€œä¸å¯è¾¾â€æ—¶ï¼ŒGCä¼šåœ¨æŸä¸ªæ—¶é—´ç‚¹è‡ªåŠ¨é‡Šæ”¾å®ƒä»¬å ç”¨çš„å†…å­˜ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šé¿å…äº†å¯æ€•çš„å†…å­˜æ³„æ¼å’Œæ‚¬ç©ºæŒ‡é’ˆé—®é¢˜ã€‚</li>
<li><strong>ä»£ä»·</strong>ï¼šç¨‹åºå‘˜æ— æ³•æ§åˆ¶å†…å­˜é‡Šæ”¾çš„ç²¾ç¡®æ—¶æœºï¼Œå¯èƒ½æœ‰æ€§èƒ½å¼€é”€ã€‚</li>
</ul>
<h4 data-id="heading-4">2. å®Œå…¨ç¦æ­¢æŒ‡é’ˆç®—æœ¯å’Œç›´æ¥å†…å­˜æ“ä½œ</h4>
<p>C/C++å¯ä»¥é€šè¿‡æ“ä½œæŒ‡é’ˆè¿›ä¸€æ­¥æ“ä½œå†…å­˜ï¼Œè¿™æ˜¯å®ƒå¼ºå¤§ä½†ä¹Ÿå±é™©çš„åœ°æ–¹ã€‚ä½†æ˜¯è€ƒè™‘åˆ°Javaæ˜¯ç«™åœ¨C/CPPä¹‹ä¸Šçš„è¯­è¨€ï¼Œå®ƒå®Œå…¨æ‘ˆå¼ƒäº†æŒ‡é’ˆç®—æœ¯å’Œç›´æ¥å†…å­˜æ“ä½œï¼Œ</p>
<p>é€šè¿‡ç¦æ­¢è¿™äº›æ“ä½œï¼ŒJavaä¿è¯äº†ï¼š</p>
<ul>
<li><strong>å†…å­˜å®‰å…¨</strong>ï¼šç¨‹åºä¸ä¼šæ„å¤–è¦†ç›–éšæœºå†…å­˜ï¼Œå¯¼è‡´å´©æºƒã€‚</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šé¿å…äº†å› ç±»å‹è½¬æ¢é”™è¯¯å¯¼è‡´çš„æ•°æ®æŸåã€‚</li>
<li><strong>å¯ç§»æ¤æ€§</strong>ï¼šJavaç¨‹åºä¸ä¾èµ–ç‰¹å®šç¡¬ä»¶çš„å†…å­˜å¸ƒå±€ã€‚</li>
</ul>
<h3 data-id="heading-5">å››ã€CPPä¸Javaåœ¨å‡½æ•°å‚æ•°ä¼ é€’çš„åŒºåˆ«ï¼ˆå¼•ç”¨ä¼ é€’ï¼‰</h3>
<p>CPPå¯ä»¥åœ¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸ŠæŒ‡å®šåˆ°åº•æ˜¯ä¼ å‚æ•°çš„æ•°å€¼è¿˜æ˜¯å¼•ç”¨ï¼Œä½†å¯¹äºJavaæ¥è¯´ï¼š
<strong>Javaé‡Œå¯¹äºæ–¹æ³•ä¼ å…¥çš„æ˜¯å¯¹è±¡å°±æ˜¯å¯¹è±¡å¼•ç”¨çš„å‰¯æœ¬ï¼Œå¦‚æœæ˜¯åŸºæœ¬ç±»å‹å°±æ˜¯å€¼çš„å‰¯æœ¬ï¼Œä¸ä¼šå½±å“æœ¬èº«ã€‚</strong></p>
<p>æ¸©é¦¨æç¤ºï¼š1ã€Stringè™½ç„¶æ˜¯æ•°ç»„ï¼Œä½†æ˜¯ç”±äºStringçš„finalå±æ€§ï¼Œä¼ å…¥æ–¹æ³•åï¼Œè¿˜æ˜¯ä¸èƒ½å¯¹å…¶æœ¬èº«è¿›è¡Œä¿®æ”¹ï¼ˆè‹¥éœ€è¦ä¿®æ”¹å¯ä»¥ä½¿ç”¨StringBuilderå¯¹è±¡ï¼‰ï¼›2ã€æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡å“¦ï¼ˆè¿™ä¸ªç¡®å®æ˜¯åŸºæœ¬å¸¸è¯†ï¼Œä½†æ˜¯æˆ‘åˆšå­¦Javaæ—¶è€æ˜¯è§‰å¾—int [] arræ˜¯åŸºæœ¬æ•°æ®ç±»å‹hhhï¼Œæ‰€ä»¥åœ¨è¿™å„¿æé†’ä¸‹åˆšå­¦Javaçš„å°ç™½ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[BLE é€šä¿¡è®¾è®¡ä¸æ¶æ„è½åœ°]]></title>    <link>https://juejin.cn/post/7575006095389573129</link>    <guid>https://juejin.cn/post/7575006095389573129</guid>    <pubDate>2025-11-22T04:35:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575006095389573129" data-draft-id="7575017581037322278" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="BLE é€šä¿¡è®¾è®¡ä¸æ¶æ„è½åœ°"/> <meta itemprop="keywords" content="Flutter,Android"/> <meta itemprop="datePublished" content="2025-11-22T04:35:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿæœˆèµ¶è·¯äºº"/> <meta itemprop="url" content="https://juejin.cn/user/3491704661625079"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            BLE é€šä¿¡è®¾è®¡ä¸æ¶æ„è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3491704661625079/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿæœˆèµ¶è·¯äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T04:35:40.000Z" title="Sat Nov 22 2025 04:35:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é¢å‘ä½åŠŸè€—ã€ç¨³å®šå¯é  BLE é€šä¿¡æ–¹æ¡ˆï¼Œä»è½¯ä»¶è®¾è®¡ç›®æ ‡ã€æ–¹æ¡ˆé€‰å‹åˆ°åˆ†å±‚æ¶æ„ä¸å…³é”®æµç¨‹ï¼Œé…å¥—æµç¨‹å›¾ä¸å®ç°è¦ç‚¹ï¼Œç›´è¾¾é‡äº§è´¨é‡ä¸ç ”å‘æ•ˆç‡ã€‚</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯ä¸ç›®æ ‡</h2>
<ul>
<li>èƒŒæ™¯ï¼šç”µæœºæ§åˆ¶ã€çŠ¶æ€é‡‡é›†ã€æ•…éšœè¯Šæ–­ä¸ OTA å‡çº§éƒ½ä¾èµ–ç§»åŠ¨ç«¯ä¸è®¾å¤‡ç«¯çš„ä½å»¶è¿Ÿã€ä½åŠŸè€—ã€ç¨³å®šè¿æ¥ã€‚</li>
<li>ç›®æ ‡ï¼šä½åŠŸè€—ã€å¿«é€Ÿè¿æ¥ã€é«˜å¯é ä¼ è¾“ã€åº”ç”¨å±‚å®‰å…¨ã€å¯æ‰©å±•åè®®ã€æ˜“ç»´æŠ¤ SDKã€‚</li>
</ul>
<h2 data-id="heading-1">æ¶æ„æ€»è§ˆ</h2>
<ul>
<li>åˆ†å±‚æ¸…æ™°ï¼šUI â†’ SDK â†’ åè®® â†’ BLE å®¢æˆ·ç«¯ â†’ è®¾å¤‡å›ºä»¶ â†’ æœåŠ¡/çŠ¶æ€æœº</li>
<li>æ§åˆ¶ä¸çŠ¶æ€åˆ†ç¦»ï¼šæ§åˆ¶é€šé“ä½å»¶è¿Ÿï¼ŒçŠ¶æ€é€šé“ç¨³å®šæµå¼ï¼›OTA ç‹¬ç«‹ä¸é˜»å¡æ§åˆ¶</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77ed4d399aa24dd08f095b968ed072e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pif5pyI6LW26Lev5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764393562&amp;x-signature=VpauAQ5YtF%2B5M1sk9dwPadNHipY%3D" alt="æˆªå±2025-11-22 12.45.56.png" loading="lazy"/></p>
<h2 data-id="heading-2">æ–¹æ¡ˆé€‰å‹</h2>
<ul>
<li>ä¼ è¾“ï¼šåŸºäº GATTï¼›å‘½ä»¤èµ°å†™å…¥ç‰¹å¾ï¼Œè®¾å¤‡é€šè¿‡é€šçŸ¥ç‰¹å¾ä¸Šè¡Œå“åº”ä¸äº‹ä»¶ã€‚</li>
<li>ç¼–ç ï¼šé‡‡ç”¨èµ·æ­¢åˆ†éš”ç¬¦ä¸è½¬ä¹‰æœºåˆ¶ï¼Œé…åˆ XOR æ ¡éªŒä¿è¯å¸§è¾¹ç•Œä¸æ•°æ®ä¸€è‡´æ€§ï¼›å¸§ç»“æ„ä¸º <code>7E | cmd(1) | len(2) | payload | xor(1) | 7E</code>ã€‚</li>
<li>å‘½ä»¤é›†ï¼šåŒ…å«åº”ç”¨ç‰ˆæœ¬æŸ¥è¯¢ã€åº”ç”¨æ§åˆ¶è®¾ç½®ã€ä»ªè¡¨ä¿¡æ¯ä¸ŠæŠ¥ã€æ§åˆ¶å“åº”ç­‰ï¼ŒåŒºåˆ†æŸ¥è¯¢å‹ä¸è®¾ç½®å‹ã€‚</li>
<li>è§£æï¼šå…ˆè¿›è¡ŒåŒ…æ ¼å¼ä¸æ ¡éªŒéªŒè¯ï¼Œå†æŒ‰åè®®æ©ç è§£æä¸ºç»“æ„åŒ–çš„çŠ¶æ€/å“åº”æ¨¡å‹ã€‚</li>
<li>MTUï¼šä¼˜å…ˆåå•†æ›´å¤§ MTU å€¼ï¼Œå†™å…¥æ ¹æ®åå•†ç»“æœè‡ªåŠ¨é€‰æ‹©çŸ­å†™æˆ–é•¿å†™ä»¥æå‡ååã€‚</li>
<li>æœåŠ¡ä¸ç‰¹å¾ï¼šå®šä¹‰ç¨³å®šçš„æœåŠ¡ UUID ä¸å†™/é€šçŸ¥ç‰¹å¾ UUIDï¼›æ‰«æé˜¶æ®µå¯ç»“åˆå¸¸è§æœåŠ¡è¿›è¡Œè¾…åŠ©è¿‡æ»¤æå‡å‘ç°æˆåŠŸç‡ã€‚</li>
</ul>
<h2 data-id="heading-3">è¿æ¥ç”Ÿå‘½å‘¨æœŸ</h2>
<ul>
<li>ç§’çº§å‘ç°ã€è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿå·²è¿/å·²é…å¯¹è®¾å¤‡ï¼›MTU åå•†åå¼€å¯ Notify å†å‘æŒ‡ä»¤</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
  A[æ‰«æå¹¿æ’­] --&gt; B{è¿‡æ»¤è®¾å¤‡}
  B --&gt;|åŒ¹é…UUID/å‚å•†æ•°æ®| C[å»ºç«‹GATTè¿æ¥]
  C --&gt; D[MTUåå•†]
  D --&gt; E[è®¢é˜…Notifyç‰¹å¾]
  E --&gt; F[å¼€å¯é€šçŸ¥]
  F --&gt; G[æ­£å¸¸é€šä¿¡]
  H --&gt; I{æ–­é“¾?}
  I --&gt;|æ˜¯| J[é€€å›æ‰«æ/ä¼˜å…ˆé‡è¿]
  I --&gt;|å¦| H
</code></pre>
<h2 data-id="heading-4">æŒ‡ä»¤ä¸åº”ç­”</h2>
<ul>
<li>ä¸Šå±‚é‡‡ç”¨ç»Ÿä¸€å‘½ä»¤æ¨¡å‹æ„å»ºè¯·æ±‚ï¼Œåè®®å±‚è´Ÿè´£ç»„å¸§ä¸å‘é€ï¼›è®¾å¤‡é€šè¿‡é€šçŸ¥è¿”å›å“åº”æˆ–çŠ¶æ€ï¼Œåè®®å¤„ç†å™¨å®ŒæˆéªŒè¯ä¸è§£æï¼Œä¸Šå±‚æŒ‰è¯·æ±‚-å“åº”æ¨¡å¼åŒ¹é…å›è°ƒã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
  participant App
  participant SDK
  participant Device

  App-&gt;&gt;SDK: send(Command)
  SDK-&gt;&gt;SDK: ç»„å¸§(7E/è½¬ä¹‰/XOR)
  SDK-&gt;&gt;Device: å†™å…¥æ•°æ®åŒ…
  Device--&gt;&gt;SDK: é€šçŸ¥ä¸Šè¡Œæ•°æ®åŒ…
  SDK--&gt;&gt;SDK: éªŒè¯/è§£æä¸ºæ¨¡å‹
  SDK--&gt;&gt;App: å›è°ƒ(å“åº”/çŠ¶æ€)
</code></pre>
<h2 data-id="heading-5">æœåŠ¡ä¸ç‰¹å¾</h2>
<ul>
<li>æœåŠ¡ä¸ç‰¹å¾ä¿æŒç¨³å®šå‘½åï¼Œä¾¿äºè·¨ç«¯åä½œä¸ç»´æŠ¤ï¼›æ‰«æé˜¶æ®µå¯ç»“åˆé€šç”¨æœåŠ¡è¿‡æ»¤ä»¥æå‡å‘ç°æ•ˆç‡ã€‚</li>
<li>å†™å…¥ç­–ç•¥æ ¹æ® MTU åå•†ç»“æœé€‰æ‹©çŸ­å†™/é•¿å†™ï¼Œå…¼é¡¾æ•ˆç‡ä¸å…¼å®¹æ€§ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
  CtrlSvc[æ§åˆ¶æœåŠ¡ 0xFFF0] --&gt; cmd_write[cmd_write: Write NR]
  CtrlSvc --&gt; cmd_notify[cmd_notify: Notify]
  StateSvc[çŠ¶æ€æœåŠ¡ 0xFFF1] --&gt; state_notify[state_notify: Notify]
  OTASvc[OTAæœåŠ¡ 0xFFF2] --&gt; ota_write[ota_write: Write]
  OTASvc --&gt; ota_notify[ota_notify: Notify]
</code></pre>
<h2 data-id="heading-6">åè®®å¸§è®¾è®¡</h2>
<ul>
<li>ç»“æ„ï¼š<code>7E | cmd(1) | len(2,BE) | payload(N) | xor(1) | 7E</code>ã€‚</li>
<li>è½¬ä¹‰ï¼šå¯¹åˆ†éš”ç¬¦ä¸è½¬ä¹‰å­—ç¬¦é‡‡ç”¨åŒå­—èŠ‚è½¬ä¹‰ï¼Œä¿è¯å¸§è¾¹ç•Œä¸è¢«è¯¯åˆ¤ã€‚</li>
<li>æ ¡éªŒï¼šä½¿ç”¨ XOR æ ¡éªŒè¦†ç›–å‘½ä»¤ã€é•¿åº¦ä¸è½½è·ï¼Œå¿«é€ŸéªŒè¯æ•°æ®ä¸€è‡´æ€§ã€‚</li>
<li>éªŒè¯ï¼šå…ˆæ ¡éªŒèµ·æ­¢ä¸æœ€å°é•¿åº¦ï¼Œå†é‡ç®—æ ¡éªŒå¯¹æ¯”ï¼Œå¤±è´¥ç«‹å³ä¸¢å¼ƒå¹¶ä¸ŠæŠ¥é”™è¯¯ã€‚</li>
</ul>
<h2 data-id="heading-7">å®‰å…¨ç­–ç•¥ï¼ˆå¯é€‰ï¼‰</h2>
<ul>
<li>åŸºäºæ˜æ–‡å¸§ + æ ¡éªŒçš„åŸºæœ¬å¯é æ€§æ–¹æ¡ˆï¼›å¦‚éœ€åŠ å¼ºå®‰å…¨ï¼Œå¯åœ¨è½½è·å±‚åŠ å…¥ç­¾åä¸æ—¶é—´æˆ³ï¼Œæˆ–åœ¨è¿æ¥å»ºç«‹ååå•†ä¼šè¯å¯†é’¥å¹¶è¿›è¡Œè½½è·åŠ å¯†ä¸è®¤è¯ã€‚</li>
</ul>
<h2 data-id="heading-8">OTA å‡çº§</h2>
<ul>
<li>ä½¿ç”¨é•¿å†™æ”¯æŒå¤§æ•°æ®åŒ…ä¼ è¾“ï¼Œç»“åˆ MTU åå•†æå‡ååï¼›åˆ†ç‰‡ä¸æ–­ç‚¹ç»­ä¼ ç”±ä¸Šå±‚æ§åˆ¶ï¼Œå‡çº§æµç¨‹ä¸æ§åˆ¶é€šé“éš”ç¦»ï¼Œä¿éšœå¸¸è§„é€šä¿¡ä¸å—å½±å“ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
  Start[å¼€å§‹å‡çº§] --&gt; Prepare[æ ¡éªŒåŒ…/ç­¾å/ç‰ˆæœ¬]
  Prepare --&gt; Switch[è¿›å…¥DFUæ¨¡å¼/æš‚åœæ§åˆ¶é€šé“]
  Switch --&gt; Chunk[åˆ†ç‰‡å‘é€]
  Chunk --&gt; Ack{åº”ç­”/æ ¡éªŒé€šè¿‡?}
  Ack --&gt;|å¦| Retry[é‡ä¼ /æ–­ç‚¹ç»­ä¼ ]
  Ack --&gt;|æ˜¯| Commit[æäº¤/åº”ç”¨æ–°å›ºä»¶]
  Commit --&gt; Reboot[é‡å¯/å›åˆ°æ­£å¸¸æ¨¡å¼]
  Reboot --&gt; End[å‡çº§å®Œæˆ]
</code></pre>
<h2 data-id="heading-9">ä½åŠŸè€—ç­–ç•¥</h2>
<ul>
<li>å¹¿æ’­ï¼šæ™®é€š 300â€“500msï¼›å¾…æœº 800â€“1200msï¼›äº‹ä»¶è§¦å‘çŸ­æ—¶æå‡</li>
<li>è¿æ¥ï¼š<code>interval=30â€“50ms</code>ã€<code>slaveLatency=4â€“10</code>ã€<code>timeout=4â€“6s</code></li>
<li>MTUï¼šåå•†è‡³ 185ï¼Œåˆ†ç‰‡éš ATT ä¸æœºå‹å·®å¼‚è‡ªé€‚åº”</li>
<li>èŠ‚æµï¼šçŠ¶æ€åˆå¹¶ä¸èŠ‚æµï¼ˆ100â€“200msï¼‰ï¼›å°åŒ…åˆå¸§å‡å°‘å”¤é†’</li>
</ul>
<h2 data-id="heading-10">å…³é”®å®ç°è¦ç‚¹</h2>
<ul>
<li>é‡ä¼ çª—å£ï¼šå¤§å° 3â€“5ï¼›è¶…æ—¶ 300â€“500msï¼›æŒ‡æ•°é€€é¿é˜²æŠ–</li>
<li>æŒ‡ä»¤æ¨¡å‹ï¼šåŒºåˆ†å¿…ç­”æ§åˆ¶ä¸å¯è·³è¿‡çŠ¶æ€ï¼›æ˜ç¡®é‡è¯•ä¸æ—¶é™</li>
<li>çº¿ç¨‹æ¨¡å‹ï¼šç§»åŠ¨ç«¯ BLE å›è°ƒçº¿ç¨‹ä¸ä¸šåŠ¡çº¿ç¨‹è§£è€¦ï¼›è®¾å¤‡ä¾§äº‹ä»¶ä¸æ§åˆ¶å¾ªç¯åˆ†ç¦»</li>
<li>æŒ‡æ ‡ä¸æ—¥å¿—ï¼šè¿æ¥æ—¶å»¶ã€MTUã€ååã€ä¸¢åŒ…ã€é‡è¯•ã€æ¡æ‰‹è€—æ—¶ã€å¤±è´¥åŸå› </li>
</ul>
<h2 data-id="heading-11">è°ƒè¯•ä¸è°ƒä¼˜</h2>
<ul>
<li>ååå‹æµ‹ï¼šä¸åŒ MTU ä¸‹ <code>pps/é‡è¯•ç‡</code> å¯¹æ¯”ï¼›å¯»æ‰¾æœ€ä½³åˆ†ç‰‡</li>
<li>ç¨³å®šæ€§ï¼šé«˜å¹²æ‰°åœºæ™¯ï¼ˆç”µæœº PWM/é‡‘å±ç¯å¢ƒï¼‰é‡è¿æˆåŠŸç‡ä¸è€—æ—¶</li>
<li>å…¼å®¹æ€§ï¼šiOS/Android æ ˆå·®å¼‚ï¼ˆå¦‚ Android GATT 133ï¼‰ï¼›è¿æ¥åå¼ºåˆ¶ <code>discoverServices</code></li>
<li>ä½åŠŸè€—éªŒè¯ï¼šè®°å½•ç”µæµæ›²çº¿ï¼Œé‡åŒ–å‚æ•°è°ƒæ•´å½±å“</li>
<li>OTA å¯é æ€§ï¼šæ–­ç”µ/æ–­é“¾æ¢å¤ã€åŒé•œåƒå›æ»šã€è¿›åº¦ä¸€è‡´æ€§</li>
</ul>
<h2 data-id="heading-12">å¸¸è§å‘ä¸è§„é¿</h2>
<ul>
<li>iOS åå°ï¼šåå°æ¨¡å¼å£°æ˜ä¸é€Ÿç‡æ§åˆ¶ï¼›é¿å…ç³»ç»ŸæŒ‚èµ·</li>
<li>Android ç¼“å­˜ï¼šç‰¹å¾ç¼“å­˜å¯èƒ½å†™æ—§ï¼›è¿æ¥åé‡æ–° <code>discoverServices</code></li>
<li>MTU åå•†ï¼šå¿…é¡»åœ¨è¿æ¥æˆåŠŸåï¼›è¿”å›å€¼å¯èƒ½ä¸ç­‰äºå®é™…å¯ç”¨</li>
<li>Notify è®¢é˜…ï¼šå…ˆè®¢é˜…å†å‘æŒ‡ä»¤ï¼›é¿å…æ—©æœŸå“åº”ä¸¢å¤±</li>
<li>å¤šè¿æ¥ï¼šä¸€è½¦ä¸€è¿ï¼›è®¾å¤‡ä¾§æ‹’ç»ç¬¬äºŒè¿æ¥è¯·æ±‚</li>
</ul>
<h2 data-id="heading-13">å®ç°æ€è·¯è¦ç‚¹</h2>
<ul>
<li>å‘½ä»¤æ¨¡å‹ç»Ÿä¸€ã€ç»„å¸§è§„èŒƒåŒ–ã€è§£æç»“æ„åŒ–ï¼Œæ–¹ä¾¿æ‰©å±•ä¸å›å½’æµ‹è¯•ã€‚</li>
<li>è¯·æ±‚-å“åº”ä¸¥æ ¼æ—¶åºï¼šå…ˆè®¢é˜…å“åº”æµï¼Œå†å‘é€è¯·æ±‚ï¼Œé¿å…æ—©æœŸå“åº”ä¸¢å¤±ã€‚</li>
<li>è®¾å¤‡æ•°æ®æµæŒ‰è®¾å¤‡ç»´åº¦éš”ç¦»ï¼Œæ”¯æŒå¤šè®¾å¤‡å¹¶å‘ç®¡ç†ä¸è®¢é˜…æ¸…ç†ã€‚</li>
<li>æ—¥å¿—ä¸æŒ‡æ ‡è´¯ç©¿é“¾è·¯ï¼šè¿æ¥ä¸åå•†ã€ååä¸ä¸¢åŒ…ã€è§£æä¸é”™è¯¯ï¼Œè¾…åŠ©å®šä½ä¸è°ƒä¼˜ã€‚</li>
</ul>
<h2 data-id="heading-14">ç»“è¯­</h2>
<ul>
<li>æ ¸å¿ƒåœ¨äºç¨³å®šã€å¯é ä¸å¯ç»´æŠ¤ã€‚å›´ç»• GATT ä¼ è¾“ã€ç¨³å¥çš„å¸§/è½¬ä¹‰/æ ¡éªŒä¸æ¸…æ™°çš„è¯·æ±‚-å“åº”æ¨¡å¼ï¼Œæ—¢ä¿è¯ eBike åœºæ™¯çš„ä½åŠŸè€—ä¸é«˜å¯é ï¼Œåˆä¸ºåç»­å®‰å…¨ä¸åŠŸèƒ½æ‰©å±•ç•™è¶³ç©ºé—´ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter å®æˆ˜ï¼šä¸ºå¼€æºè®°è´¦ App å®ç°ä¼˜é›…çš„æš—é»‘æ¨¡å¼ï¼ˆDesign Token + åŠ¨æ€ä¸»é¢˜ï¼‰]]></title>    <link>https://juejin.cn/post/7575047994681409587</link>    <guid>https://juejin.cn/post/7575047994681409587</guid>    <pubDate>2025-11-22T03:39:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575047994681409587" data-draft-id="7575031395861954606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter å®æˆ˜ï¼šä¸ºå¼€æºè®°è´¦ App å®ç°ä¼˜é›…çš„æš—é»‘æ¨¡å¼ï¼ˆDesign Token + åŠ¨æ€ä¸»é¢˜ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-22T03:39:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…¨æ ˆé˜¿ç¬‘"/> <meta itemprop="url" content="https://juejin.cn/user/2629687543598200"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter å®æˆ˜ï¼šä¸ºå¼€æºè®°è´¦ App å®ç°ä¼˜é›…çš„æš—é»‘æ¨¡å¼ï¼ˆDesign Token + åŠ¨æ€ä¸»é¢˜ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2629687543598200/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…¨æ ˆé˜¿ç¬‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-22T03:39:57.000Z" title="Sat Nov 22 2025 03:39:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘ä¸ºæˆ‘çš„å¼€æºè®°è´¦ App <strong>BeeCount èœœèœ‚è®°è´¦</strong> å®ç°äº†æš—é»‘æ¨¡å¼ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ç»éªŒã€‚è¿™ç¯‡æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»æ•´ä¸ªæŠ€æœ¯æ–¹æ¡ˆå’Œå®ç°è¿‡ç¨‹ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ã€‚</p>
<h2 data-id="heading-0">æ•ˆæœé¢„è§ˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/658b1a6c6cc84142a18a332bf9fe1083~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=b6%2FqlRbiSLdECrbuJJeDS1dR7KA%3D" alt="1.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/347a91474a024be5ab6b6173cbee9c07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=wL0xB%2Fjb%2FIAVCZgavkzDatqtybY%3D" alt="2.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96fede5bf2ff4191b5865c5c186dfb9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=cbj4VI654C8oiqYhwsm8MlFLkdk%3D" alt="3.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79b1c4999b8f451ebf7e2a8110340301~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=%2FBir%2B%2Bovdjla2d7AOFxZT%2BmBIhY%3D" alt="4.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee2186803b624a02b5e27149e275c22b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=nqilFMljrb2M%2FRNnGaAHi1ffTlU%3D" alt="5.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8299ea97865944578bb5724e19f6d9a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWo5qCI6Zi_56yR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764387597&amp;x-signature=mNeSEkUU2XjM39ZiqOMCbPwsHZY%3D" alt="6.jpg" loading="lazy"/></p>
<p>æš—é»‘æ¨¡å¼é‡‡ç”¨ã€Œ<strong>çº¯é»‘èƒŒæ™¯ + ä¸»é¢˜è‰²è¾¹æ¡†</strong>ã€çš„è®¾è®¡æ–¹æ¡ˆï¼š</p>
<ul>
<li>çº¯é»‘èƒŒæ™¯ï¼šOLED å‹å¥½ï¼Œå¤œé—´æŠ¤çœ¼</li>
<li>ä¸»é¢˜è‰²è¾¹æ¡†ï¼šä¿ç•™ä¸ªæ€§åŒ–ï¼Œå±‚æ¬¡åˆ†æ˜</li>
<li>å…¨å±€é€‚é…ï¼šæ‰€æœ‰é¡µé¢ã€ç»„ä»¶ç»Ÿä¸€é£æ ¼</li>
</ul>
<hr/>
<h2 data-id="heading-1">æŠ€æœ¯æ–¹æ¡ˆæ¦‚è¿°</h2>
<p>åœ¨å¼€å§‹å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘å…ˆæ¢³ç†äº†æ•´ä½“çš„æŠ€æœ¯æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>Design Token ç³»ç»Ÿ</strong>ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰é¢œè‰²ï¼Œä¸€å¤„ä¿®æ”¹å…¨å±€ç”Ÿæ•ˆ</li>
<li><strong>ä¸»é¢˜çŠ¶æ€ç®¡ç†</strong>ï¼šä½¿ç”¨ Riverpod ç®¡ç†ä¸»é¢˜æ¨¡å¼ï¼Œæ”¯æŒæŒä¹…åŒ–</li>
<li><strong>MaterialApp é…ç½®</strong>ï¼šé…ç½® theme å’Œ darkThemeï¼Œæ”¯æŒè·Ÿéšç³»ç»Ÿåˆ‡æ¢</li>
<li><strong>ç»„ä»¶çº§é€‚é…</strong>ï¼šé’ˆå¯¹ç‰¹æ®Šç»„ä»¶ï¼ˆå›¾è¡¨ã€å¼¹çª—ç­‰ï¼‰å•ç‹¬å¤„ç†</li>
</ol>
<p>ä¸‹é¢é€ä¸€ä»‹ç»ã€‚</p>
<hr/>
<h2 data-id="heading-2">1. Design Token ç³»ç»Ÿ</h2>
<h3 data-id="heading-3">ä¸ºä»€ä¹ˆéœ€è¦ Design Tokenï¼Ÿ</h3>
<p>é¡¹ç›®åˆæœŸï¼Œé¢œè‰²éƒ½æ˜¯ç¡¬ç¼–ç çš„ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åˆ°å¤„éƒ½æ˜¯è¿™ç§ä»£ç </span>
Text(<span class="hljs-string">'Hello'</span>, style: TextStyle(color: Colors.black87))
Container(color: Colors.white)
</code></pre>
<p>è¿™æ ·åšçš„é—®é¢˜ï¼š</p>
<ul>
<li>è¦æ”¯æŒæš—é»‘æ¨¡å¼ï¼Œå¾—å…¨å±€æœç´¢æ›¿æ¢</li>
<li>é¢œè‰²å€¼ä¸ç»Ÿä¸€ï¼ŒåŒæ ·çš„ã€Œæ¬¡è¦æ–‡å­—ã€å¯èƒ½å†™æˆ <code>black54</code>ã€<code>grey</code>ã€<code>Colors.grey.shade600</code></li>
<li>ç»´æŠ¤å›°éš¾ï¼Œæ”¹ä¸€ä¸ªé¢œè‰²è¦æ”¹ N ä¸ªåœ°æ–¹</li>
</ul>
<p>æ‰€ä»¥æˆ‘å€Ÿé‰´äº† Web å‰ç«¯çš„ <strong>CSS Variables</strong> æ€è·¯ï¼Œå»ºç«‹äº†ä¸€å¥— Design Token ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-4">æ ¸å¿ƒå®ç°</h3>
<p><strong>æ–‡ä»¶ï¼š<code>lib/styles/tokens.dart</code></strong></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;

<span class="hljs-comment">/// <span class="markdown">Design Token ç³»ç»Ÿ</span></span>
<span class="hljs-comment">/// <span class="markdown">ç»Ÿä¸€ç®¡ç†æ‰€æœ‰é¢œè‰²ï¼Œè‡ªåŠ¨é€‚é…äº®è‰²/æš—é»‘æ¨¡å¼</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BeeTokens</span> </span>{

  <span class="hljs-comment">// ========== å·¥å…·æ–¹æ³• ==========</span>

  <span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­å½“å‰æ˜¯å¦æš—é»‘æ¨¡å¼</span></span>
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isDark(BuildContext context) {
    <span class="hljs-keyword">return</span> Theme.of(context).brightness == Brightness.dark;
  }

  <span class="hljs-comment">/// <span class="markdown">è·å–ä¸»é¢˜è‰²</span></span>
  <span class="hljs-keyword">static</span> Color primary(BuildContext context) {
    <span class="hljs-keyword">return</span> Theme.of(context).primaryColor;
  }

  <span class="hljs-comment">// ========== èƒŒæ™¯è‰² ==========</span>

  <span class="hljs-comment">/// <span class="markdown">é¡µé¢èƒŒæ™¯è‰²</span></span>
  <span class="hljs-keyword">static</span> Color scaffoldBackground(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.black : <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFF5F5F5</span>);
  }

  <span class="hljs-comment">/// <span class="markdown">å¡ç‰‡/è¡¨é¢èƒŒæ™¯è‰²</span></span>
  <span class="hljs-keyword">static</span> Color surface(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.black : Colors.white;
  }

  <span class="hljs-comment">/// <span class="markdown">æå‡çš„è¡¨é¢ï¼ˆå¦‚å¼¹çª—ã€ä¸‹æ‹‰èœå•ï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color surfaceElevated(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFF1C1C1E</span>) : Colors.white;
  }

  <span class="hljs-comment">/// <span class="markdown">Header èƒŒæ™¯è‰²</span></span>
  <span class="hljs-keyword">static</span> Color surfaceHeader(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.black : Colors.white;
  }

  <span class="hljs-comment">// ========== æ–‡å­—é¢œè‰² ==========</span>

  <span class="hljs-comment">/// <span class="markdown">ä¸»è¦æ–‡å­—ï¼ˆæ ‡é¢˜ã€æ­£æ–‡ï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color textPrimary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white : Colors.black87;
  }

  <span class="hljs-comment">/// <span class="markdown">æ¬¡è¦æ–‡å­—ï¼ˆè¯´æ˜æ–‡å­—ã€å‰¯æ ‡é¢˜ï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color textSecondary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white70 : Colors.black54;
  }

  <span class="hljs-comment">/// <span class="markdown">æç¤ºæ–‡å­—ï¼ˆplaceholderã€ç¦ç”¨çŠ¶æ€ï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color textTertiary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white38 : Colors.black38;
  }

  <span class="hljs-comment">// ========== å›¾æ ‡é¢œè‰² ==========</span>

  <span class="hljs-keyword">static</span> Color iconPrimary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white : Colors.black87;
  }

  <span class="hljs-keyword">static</span> Color iconSecondary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white70 : Colors.black54;
  }

  <span class="hljs-keyword">static</span> Color iconTertiary(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white38 : Colors.black38;
  }

  <span class="hljs-comment">// ========== è¾¹æ¡†å’Œåˆ†å‰²çº¿ ==========</span>

  <span class="hljs-comment">/// <span class="markdown">æ™®é€šè¾¹æ¡†</span></span>
  <span class="hljs-keyword">static</span> Color border(BuildContext context) {
    <span class="hljs-keyword">if</span> (isDark(context)) {
      <span class="hljs-keyword">return</span> Theme.of(context).primaryColor.withOpacity(<span class="hljs-number">0.3</span>);
    }
    <span class="hljs-keyword">return</span> Colors.grey.shade200;
  }

  <span class="hljs-comment">/// <span class="markdown">åˆ†å‰²çº¿</span></span>
  <span class="hljs-keyword">static</span> Color divider(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? Colors.white12 : Colors.grey.shade200;
  }

  <span class="hljs-comment">/// <span class="markdown">ä¸»é¢˜è‰²è¾¹æ¡†ï¼ˆç”¨äºå¼ºè°ƒï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color borderThemed(BuildContext context) {
    <span class="hljs-keyword">return</span> Theme.of(context).primaryColor.withOpacity(<span class="hljs-number">0.3</span>);
  }

  <span class="hljs-comment">// ========== è¯­ä¹‰é¢œè‰² ==========</span>

  <span class="hljs-comment">/// <span class="markdown">æˆåŠŸè‰²ï¼ˆæ”¶å…¥ã€æ­£æ•°ï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color success(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFF4CD964</span>) : <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFF34C759</span>);
  }

  <span class="hljs-comment">/// <span class="markdown">é”™è¯¯è‰²ï¼ˆæ”¯å‡ºã€è´Ÿæ•°ã€é”™è¯¯æç¤ºï¼‰</span></span>
  <span class="hljs-keyword">static</span> Color error(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFFF6B6B</span>) : <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFFF3B30</span>);
  }

  <span class="hljs-comment">/// <span class="markdown">è­¦å‘Šè‰²</span></span>
  <span class="hljs-keyword">static</span> Color warning(BuildContext context) {
    <span class="hljs-keyword">return</span> isDark(context) ? <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFFFD60A</span>) : <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFFF9500</span>);
  }
}
</code></pre>
<h3 data-id="heading-5">ä½¿ç”¨æ–¹å¼</h3>
<p>æ›¿æ¢åŸæ¥çš„ç¡¬ç¼–ç é¢œè‰²ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// âŒ ä¹‹å‰</span>
Container(
  color: Colors.white,
  child: Text(
    <span class="hljs-string">'Hello'</span>,
    style: TextStyle(color: Colors.black87),
  ),
)

<span class="hljs-comment">// âœ… ä¹‹å</span>
Container(
  color: BeeTokens.surface(context),
  child: Text(
    <span class="hljs-string">'Hello'</span>,
    style: TextStyle(color: BeeTokens.textPrimary(context)),
  ),
)
</code></pre>
<h3 data-id="heading-6">Token å‘½åè§„èŒƒ</h3>
<p>æˆ‘é‡‡ç”¨äº†è¯­ä¹‰åŒ–å‘½åï¼Œè®©ä»£ç æ›´æ˜“è¯»ï¼š</p>



























































<table><thead><tr><th>Token</th><th>ç”¨é€”</th><th>äº®è‰²</th><th>æš—è‰²</th></tr></thead><tbody><tr><td><code>scaffoldBackground</code></td><td>é¡µé¢èƒŒæ™¯</td><td>#F5F5F5</td><td>#000000</td></tr><tr><td><code>surface</code></td><td>å¡ç‰‡èƒŒæ™¯</td><td>#FFFFFF</td><td>#000000</td></tr><tr><td><code>surfaceElevated</code></td><td>å¼¹çª—èƒŒæ™¯</td><td>#FFFFFF</td><td>#1C1C1E</td></tr><tr><td><code>textPrimary</code></td><td>ä¸»è¦æ–‡å­—</td><td>black87</td><td>white</td></tr><tr><td><code>textSecondary</code></td><td>æ¬¡è¦æ–‡å­—</td><td>black54</td><td>white70</td></tr><tr><td><code>textTertiary</code></td><td>æç¤ºæ–‡å­—</td><td>black38</td><td>white38</td></tr><tr><td><code>border</code></td><td>å¡ç‰‡è¾¹æ¡†</td><td>grey200</td><td>ä¸»é¢˜è‰²30%</td></tr><tr><td><code>divider</code></td><td>åˆ†å‰²çº¿</td><td>grey200</td><td>white12</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">2. ä¸»é¢˜çŠ¶æ€ç®¡ç†</h2>
<h3 data-id="heading-8">Provider å®šä¹‰</h3>
<p>ä½¿ç”¨ Riverpod ç®¡ç†ä¸»é¢˜çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter_riverpod/flutter_riverpod.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:shared_preferences/shared_preferences.dart'</span>;

<span class="hljs-comment">/// <span class="markdown">ä¸»é¢˜æ¨¡å¼æšä¸¾</span></span>
<span class="hljs-keyword">enum</span> ThemeModeOption {
  system,  <span class="hljs-comment">// è·Ÿéšç³»ç»Ÿ</span>
  light,   <span class="hljs-comment">// å§‹ç»ˆäº®è‰²</span>
  dark,    <span class="hljs-comment">// å§‹ç»ˆæš—é»‘</span>
}

<span class="hljs-comment">/// <span class="markdown">æ‰©å±•æ–¹æ³•ï¼šè½¬æ¢ä¸º Flutter çš„ ThemeMode</span></span>
<span class="hljs-keyword">extension</span> ThemeModeOptionExtension <span class="hljs-keyword">on</span> ThemeModeOption {
  ThemeMode toThemeMode() {
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">case</span> ThemeModeOption.system:
        <span class="hljs-keyword">return</span> ThemeMode.system;
      <span class="hljs-keyword">case</span> ThemeModeOption.light:
        <span class="hljs-keyword">return</span> ThemeMode.light;
      <span class="hljs-keyword">case</span> ThemeModeOption.dark:
        <span class="hljs-keyword">return</span> ThemeMode.dark;
    }
  }

  <span class="hljs-built_in">String</span> toDisplayName(BuildContext context) {
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">case</span> ThemeModeOption.system:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'è·Ÿéšç³»ç»Ÿ'</span>;
      <span class="hljs-keyword">case</span> ThemeModeOption.light:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'å§‹ç»ˆäº®è‰²'</span>;
      <span class="hljs-keyword">case</span> ThemeModeOption.dark:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'å§‹ç»ˆæš—é»‘'</span>;
    }
  }
}

<span class="hljs-comment">/// <span class="markdown">ä¸»é¢˜æ¨¡å¼ Provider</span></span>
<span class="hljs-keyword">final</span> themeModeProvider = StateNotifierProvider&lt;ThemeModeNotifier, ThemeModeOption&gt;((ref) {
  <span class="hljs-keyword">return</span> ThemeModeNotifier();
});

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThemeModeNotifier</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StateNotifier</span>&lt;<span class="hljs-title">ThemeModeOption</span>&gt; </span>{
  ThemeModeNotifier() : <span class="hljs-keyword">super</span>(ThemeModeOption.system) {
    _loadFromPrefs();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> _key = <span class="hljs-string">'theme_mode'</span>;

  Future&lt;<span class="hljs-keyword">void</span>&gt; _loadFromPrefs() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> prefs = <span class="hljs-keyword">await</span> SharedPreferences.getInstance();
    <span class="hljs-keyword">final</span> value = prefs.getString(_key);
    <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>) {
      state = ThemeModeOption.values.firstWhere(
        (e) =&gt; e.name == value,
        orElse: () =&gt; ThemeModeOption.system,
      );
    }
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; setThemeMode(ThemeModeOption mode) <span class="hljs-keyword">async</span> {
    state = mode;
    <span class="hljs-keyword">final</span> prefs = <span class="hljs-keyword">await</span> SharedPreferences.getInstance();
    <span class="hljs-keyword">await</span> prefs.setString(_key, mode.name);
  }
}
</code></pre>
<h3 data-id="heading-9">ä¸»é¢˜è‰² Provider</h3>
<p>ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ä¸»é¢˜è‰²ï¼Œè¿™ä¸ªä¹Ÿè¦æŒä¹…åŒ–ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">é¢„è®¾ä¸»é¢˜è‰²åˆ—è¡¨</span></span>
<span class="hljs-keyword">const</span> <span class="hljs-built_in">List</span>&lt;Color&gt; presetColors = [
  Color(<span class="hljs-number">0xFFFFB020</span>), <span class="hljs-comment">// èœœèœ‚é»„ï¼ˆé»˜è®¤ï¼‰</span>
  Color(<span class="hljs-number">0xFFFF6B6B</span>), <span class="hljs-comment">// çŠç‘šçº¢</span>
  Color(<span class="hljs-number">0xFF4ECDC4</span>), <span class="hljs-comment">// è–„è·ç»¿</span>
  Color(<span class="hljs-number">0xFF5C7AEA</span>), <span class="hljs-comment">// é›è“</span>
  Color(<span class="hljs-number">0xFFAB47BC</span>), <span class="hljs-comment">// ç´«ç½—å…°</span>
  Color(<span class="hljs-number">0xFF26A69A</span>), <span class="hljs-comment">// é’ç»¿</span>
  Color(<span class="hljs-number">0xFFEC407A</span>), <span class="hljs-comment">// ç²‰çº¢</span>
  Color(<span class="hljs-number">0xFF42A5F5</span>), <span class="hljs-comment">// å¤©è“</span>
];

<span class="hljs-comment">/// <span class="markdown">ä¸»é¢˜è‰² Provider</span></span>
<span class="hljs-keyword">final</span> primaryColorProvider = StateNotifierProvider&lt;PrimaryColorNotifier, Color&gt;((ref) {
  <span class="hljs-keyword">return</span> PrimaryColorNotifier();
});

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrimaryColorNotifier</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StateNotifier</span>&lt;<span class="hljs-title">Color</span>&gt; </span>{
  PrimaryColorNotifier() : <span class="hljs-keyword">super</span>(presetColors[<span class="hljs-number">0</span>]) {
    _loadFromPrefs();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> _key = <span class="hljs-string">'primary_color'</span>;

  Future&lt;<span class="hljs-keyword">void</span>&gt; _loadFromPrefs() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> prefs = <span class="hljs-keyword">await</span> SharedPreferences.getInstance();
    <span class="hljs-keyword">final</span> value = prefs.getInt(_key);
    <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>) {
      state = Color(value);
    }
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; setPrimaryColor(Color color) <span class="hljs-keyword">async</span> {
    state = color;
    <span class="hljs-keyword">final</span> prefs = <span class="hljs-keyword">await</span> SharedPreferences.getInstance();
    <span class="hljs-keyword">await</span> prefs.setInt(_key, color.value);
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-10">3. MaterialApp é…ç½®</h2>
<p>åœ¨ App å…¥å£å¤„é…ç½®ä¸»é¢˜ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ConsumerWidget</span> </span>{
  <span class="hljs-keyword">const</span> MyApp({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context, WidgetRef ref) {
    <span class="hljs-keyword">final</span> themeMode = ref.watch(themeModeProvider);
    <span class="hljs-keyword">final</span> primaryColor = ref.watch(primaryColorProvider);

    <span class="hljs-keyword">return</span> MaterialApp(
      title: <span class="hljs-string">'BeeCount'</span>,

      <span class="hljs-comment">// ä¸»é¢˜æ¨¡å¼</span>
      themeMode: themeMode.toThemeMode(),

      <span class="hljs-comment">// äº®è‰²ä¸»é¢˜</span>
      theme: ThemeData(
        brightness: Brightness.light,
        primaryColor: primaryColor,
        scaffoldBackgroundColor: <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFF5F5F5</span>),
        colorScheme: ColorScheme.light(
          primary: primaryColor,
          secondary: primaryColor,
          surface: Colors.white,
        ),
        appBarTheme: AppBarTheme(
          backgroundColor: Colors.white,
          foregroundColor: Colors.black87,
          elevation: <span class="hljs-number">0</span>,
          systemOverlayStyle: SystemUiOverlayStyle.dark,
        ),
        dividerTheme: DividerThemeData(
          color: Colors.grey.shade200,
          thickness: <span class="hljs-number">0.5</span>,
        ),
        <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
      ),

      <span class="hljs-comment">// æš—é»‘ä¸»é¢˜</span>
      darkTheme: ThemeData(
        brightness: Brightness.dark,
        primaryColor: primaryColor,
        scaffoldBackgroundColor: Colors.black,
        colorScheme: ColorScheme.dark(
          primary: primaryColor,
          secondary: primaryColor,
          surface: Colors.black,
        ),
        appBarTheme: AppBarTheme(
          backgroundColor: Colors.black,
          foregroundColor: Colors.white,
          elevation: <span class="hljs-number">0</span>,
          systemOverlayStyle: SystemUiOverlayStyle.light,
        ),
        dividerTheme: <span class="hljs-keyword">const</span> DividerThemeData(
          color: Colors.white12,
          thickness: <span class="hljs-number">0.5</span>,
        ),
        <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
      ),

      home: <span class="hljs-keyword">const</span> HomePage(),
    );
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-11">4. ç»„ä»¶çº§é€‚é…</h2>
<h3 data-id="heading-12">å¡ç‰‡ç»„ä»¶</h3>
<p>å°è£…ä¸€ä¸ªç»Ÿä¸€çš„å¡ç‰‡ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BeeCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> Widget child;
  <span class="hljs-keyword">final</span> EdgeInsetsGeometry? padding;
  <span class="hljs-keyword">final</span> EdgeInsetsGeometry? margin;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> borderRadius;

  <span class="hljs-keyword">const</span> BeeCard({
    <span class="hljs-keyword">super</span>.key,
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child,
    <span class="hljs-keyword">this</span>.padding,
    <span class="hljs-keyword">this</span>.margin,
    <span class="hljs-keyword">this</span>.borderRadius = <span class="hljs-number">12</span>,
  });

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">final</span> isDark = BeeTokens.isDark(context);

    <span class="hljs-keyword">return</span> Container(
      margin: margin,
      padding: padding ?? <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">16</span>),
      decoration: BoxDecoration(
        color: BeeTokens.surface(context),
        borderRadius: BorderRadius.circular(borderRadius),
        <span class="hljs-comment">// æš—é»‘æ¨¡å¼ï¼šä¸»é¢˜è‰²è¾¹æ¡†</span>
        border: isDark
            ? Border.all(color: BeeTokens.border(context), width: <span class="hljs-number">1</span>)
            : <span class="hljs-keyword">null</span>,
        <span class="hljs-comment">// äº®è‰²æ¨¡å¼ï¼šé˜´å½±</span>
        boxShadow: isDark
            ? <span class="hljs-keyword">null</span>
            : [
                BoxShadow(
                  color: Colors.black.withOpacity(<span class="hljs-number">0.05</span>),
                  blurRadius: <span class="hljs-number">8</span>,
                  offset: <span class="hljs-keyword">const</span> Offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),
                ),
              ],
      ),
      child: child,
    );
  }
}
</code></pre>
<h3 data-id="heading-13">å›¾è¡¨é€‚é…</h3>
<p>ä½¿ç”¨ <code>fl_chart</code> åº“æ—¶ï¼Œéœ€è¦å•ç‹¬å¤„ç†é¢œè‰²ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:fl_chart/fl_chart.dart'</span>;

Widget buildLineChart(BuildContext context, <span class="hljs-built_in">List</span>&lt;FlSpot&gt; spots) {
  <span class="hljs-keyword">final</span> isDark = BeeTokens.isDark(context);
  <span class="hljs-keyword">final</span> primaryColor = Theme.of(context).primaryColor;

  <span class="hljs-keyword">return</span> LineChart(
    LineChartData(
      <span class="hljs-comment">// ç½‘æ ¼çº¿</span>
      gridData: FlGridData(
        <span class="hljs-keyword">show</span>: <span class="hljs-keyword">true</span>,
        drawVerticalLine: <span class="hljs-keyword">false</span>,
        horizontalInterval: <span class="hljs-number">1</span>,
        getDrawingHorizontalLine: (value) =&gt; FlLine(
          color: isDark ? Colors.white10 : Colors.grey.shade200,
          strokeWidth: <span class="hljs-number">1</span>,
        ),
      ),

      <span class="hljs-comment">// è¾¹æ¡†</span>
      borderData: FlBorderData(
        <span class="hljs-keyword">show</span>: <span class="hljs-keyword">true</span>,
        border: Border(
          bottom: BorderSide(
            color: isDark ? Colors.white24 : Colors.grey.shade300,
          ),
          left: BorderSide(
            color: isDark ? Colors.white24 : Colors.grey.shade300,
          ),
        ),
      ),

      <span class="hljs-comment">// åæ ‡è½´æ ‡é¢˜</span>
      titlesData: FlTitlesData(
        bottomTitles: AxisTitles(
          sideTitles: SideTitles(
            showTitles: <span class="hljs-keyword">true</span>,
            getTitlesWidget: (value, meta) =&gt; Text(
              <span class="hljs-string">'<span class="hljs-subst">${value.toInt()}</span>'</span>,
              style: TextStyle(
                color: BeeTokens.textSecondary(context),
                fontSize: <span class="hljs-number">12</span>,
              ),
            ),
          ),
        ),
        leftTitles: AxisTitles(
          sideTitles: SideTitles(
            showTitles: <span class="hljs-keyword">true</span>,
            getTitlesWidget: (value, meta) =&gt; Text(
              <span class="hljs-string">'<span class="hljs-subst">${value.toInt()}</span>'</span>,
              style: TextStyle(
                color: BeeTokens.textSecondary(context),
                fontSize: <span class="hljs-number">12</span>,
              ),
            ),
          ),
        ),
        topTitles: <span class="hljs-keyword">const</span> AxisTitles(sideTitles: SideTitles(showTitles: <span class="hljs-keyword">false</span>)),
        rightTitles: <span class="hljs-keyword">const</span> AxisTitles(sideTitles: SideTitles(showTitles: <span class="hljs-keyword">false</span>)),
      ),

      <span class="hljs-comment">// æ•°æ®çº¿</span>
      lineBarsData: [
        LineChartBarData(
          spots: spots,
          isCurved: <span class="hljs-keyword">true</span>,
          color: primaryColor,
          barWidth: <span class="hljs-number">2</span>,
          dotData: FlDotData(
            <span class="hljs-keyword">show</span>: <span class="hljs-keyword">true</span>,
            getDotPainter: (spot, percent, barData, index) {
              <span class="hljs-keyword">return</span> FlDotCirclePainter(
                radius: <span class="hljs-number">4</span>,
                color: primaryColor,
                strokeWidth: <span class="hljs-number">2</span>,
                strokeColor: isDark ? Colors.black : Colors.white,
              );
            },
          ),
          belowBarData: BarAreaData(
            <span class="hljs-keyword">show</span>: <span class="hljs-keyword">true</span>,
            color: primaryColor.withOpacity(<span class="hljs-number">0.1</span>),
          ),
        ),
      ],
    ),
  );
}
</code></pre>
<h3 data-id="heading-14">å¼¹çª—é€‚é…</h3>
<p><code>showModalBottomSheet</code>ã€<code>showDialog</code> ç­‰å¼¹çª—éœ€è¦å•ç‹¬å¤„ç†ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">Future&lt;T?&gt; showBeeBottomSheet&lt;T&gt;({
  <span class="hljs-keyword">required</span> BuildContext context,
  <span class="hljs-keyword">required</span> WidgetBuilder builder,
  <span class="hljs-built_in">bool</span> isScrollControlled = <span class="hljs-keyword">false</span>,
}) {
  <span class="hljs-keyword">return</span> showModalBottomSheet&lt;T&gt;(
    context: context,
    isScrollControlled: isScrollControlled,
    <span class="hljs-comment">// å…³é”®ï¼šæŒ‡å®šèƒŒæ™¯è‰²</span>
    backgroundColor: BeeTokens.surfaceElevated(context),
    <span class="hljs-comment">// åœ†è§’</span>
    shape: <span class="hljs-keyword">const</span> RoundedRectangleBorder(
      borderRadius: BorderRadius.vertical(top: Radius.circular(<span class="hljs-number">16</span>)),
    ),
    builder: builder,
  );
}

Future&lt;T?&gt; showBeeDialog&lt;T&gt;({
  <span class="hljs-keyword">required</span> BuildContext context,
  <span class="hljs-keyword">required</span> WidgetBuilder builder,
}) {
  <span class="hljs-keyword">return</span> showDialog&lt;T&gt;(
    context: context,
    builder: (context) =&gt; Dialog(
      backgroundColor: BeeTokens.surfaceElevated(context),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(<span class="hljs-number">16</span>),
        <span class="hljs-comment">// æš—é»‘æ¨¡å¼ä¸‹åŠ è¾¹æ¡†</span>
        side: BeeTokens.isDark(context)
            ? BorderSide(color: BeeTokens.border(context))
            : BorderSide.none,
      ),
      child: builder(context),
    ),
  );
}
</code></pre>
<h3 data-id="heading-15">è¾“å…¥æ¡†é€‚é…</h3>
<pre><code class="hljs language-dart" lang="dart">TextField(
  decoration: InputDecoration(
    hintText: <span class="hljs-string">'è¯·è¾“å…¥'</span>,
    hintStyle: TextStyle(color: BeeTokens.textTertiary(context)),
    filled: <span class="hljs-keyword">true</span>,
    fillColor: BeeTokens.isDark(context)
        ? Colors.white.withOpacity(<span class="hljs-number">0.05</span>)
        : Colors.grey.shade100,
    border: OutlineInputBorder(
      borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
      borderSide: BorderSide.none,
    ),
    focusedBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
      borderSide: BorderSide(
        color: Theme.of(context).primaryColor,
        width: <span class="hljs-number">1.5</span>,
      ),
    ),
  ),
  style: TextStyle(color: BeeTokens.textPrimary(context)),
)
</code></pre>
<hr/>
<h2 data-id="heading-16">5. è¸©å‘è®°å½•</h2>
<h3 data-id="heading-17">å‘ 1ï¼šç¡¬ç¼–ç é¢œè‰²éå¸ƒå…¨å±€</h3>
<p><strong>é—®é¢˜</strong>ï¼šé¡¹ç›®å†å²ä»£ç ä¸­ï¼Œé¢œè‰²å€¼æ•£è½åœ¨å„å¤„ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šæˆ‘å†™äº†ä¸ªè„šæœ¬ï¼Œå…¨å±€æœç´¢æ›¿æ¢å¸¸è§çš„ç¡¬ç¼–ç é¢œè‰²ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœç´¢ç¡¬ç¼–ç é¢œè‰²</span>
grep -rn <span class="hljs-string">"Colors.black87"</span> lib/
grep -rn <span class="hljs-string">"Colors.black54"</span> lib/
grep -rn <span class="hljs-string">"Colors.white"</span> lib/
grep -rn <span class="hljs-string">"Color(0xFF"</span> lib/
</code></pre>
<p>ç„¶åé€ä¸ªæ›¿æ¢ä¸ºå¯¹åº”çš„ Tokenã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒç¹çï¼Œä½†ä¸€åŠ³æ°¸é€¸ã€‚</p>
<h3 data-id="heading-18">å‘ 2ï¼šå¼¹çª—èƒŒæ™¯è‰²ä¸ç”Ÿæ•ˆ</h3>
<p><strong>é—®é¢˜</strong>ï¼š<code>showModalBottomSheet</code> åœ¨æš—é»‘æ¨¡å¼ä¸‹èƒŒæ™¯è¿˜æ˜¯ç™½è‰²ã€‚</p>
<p><strong>åŸå› </strong>ï¼šFlutter çš„ BottomSheet é»˜è®¤ä½¿ç”¨ <code>Theme.of(context).canvasColor</code>ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šæ˜¾å¼æŒ‡å®š <code>backgroundColor</code> å‚æ•°ã€‚</p>
<pre><code class="hljs language-dart" lang="dart">showModalBottomSheet(
  context: context,
  backgroundColor: BeeTokens.surfaceElevated(context), <span class="hljs-comment">// å¿…é¡»æŒ‡å®šï¼</span>
  builder: (context) =&gt; ...
)
</code></pre>
<h3 data-id="heading-19">å‘ 3ï¼šçŠ¶æ€æ å›¾æ ‡é¢œè‰²</h3>
<p><strong>é—®é¢˜</strong>ï¼šæš—é»‘æ¨¡å¼ä¸‹çŠ¶æ€æ å›¾æ ‡è¿˜æ˜¯é»‘è‰²ï¼Œçœ‹ä¸æ¸…ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šåœ¨ AppBar æˆ–é¡µé¢çº§åˆ«è®¾ç½® <code>SystemUiOverlayStyle</code>ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æ–¹å¼ 1ï¼šé€šè¿‡ AppBar</span>
AppBar(
  systemOverlayStyle: BeeTokens.isDark(context)
      ? SystemUiOverlayStyle.light
      : SystemUiOverlayStyle.dark,
)

<span class="hljs-comment">// æ–¹å¼ 2ï¼šé€šè¿‡ AnnotatedRegion</span>
AnnotatedRegion&lt;SystemUiOverlayStyle&gt;(
  value: BeeTokens.isDark(context)
      ? SystemUiOverlayStyle.light
      : SystemUiOverlayStyle.dark,
  child: Scaffold(...),
)
</code></pre>
<h3 data-id="heading-20">å‘ 4ï¼šCupertinoDatePicker é¢œè‰²</h3>
<p><strong>é—®é¢˜</strong>ï¼šiOS é£æ ¼çš„æ—¥æœŸé€‰æ‹©å™¨åœ¨æš—é»‘æ¨¡å¼ä¸‹é¢œè‰²ä¸å¯¹ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šç”¨ <code>CupertinoTheme</code> åŒ…è£¹ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">CupertinoTheme(
  data: CupertinoThemeData(
    brightness: BeeTokens.isDark(context) ? Brightness.dark : Brightness.light,
    primaryColor: Theme.of(context).primaryColor,
  ),
  child: CupertinoDatePicker(...),
)
</code></pre>
<h3 data-id="heading-21">å‘ 5ï¼šå›¾ç‰‡å’Œå›¾æ ‡</h3>
<p><strong>é—®é¢˜</strong>ï¼šæŸäº›å›¾æ ‡/å›¾ç‰‡åœ¨æš—é»‘æ¨¡å¼ä¸‹å¯¹æ¯”åº¦ä¸å¤Ÿã€‚</p>
<p><strong>è§£å†³</strong>ï¼š</p>
<ol>
<li>ä½¿ç”¨ Icon æ—¶ï¼Œæ˜¾å¼æŒ‡å®šé¢œè‰²è€Œéä¾èµ–é»˜è®¤å€¼</li>
<li>å¯¹äºå›¾ç‰‡ï¼Œè€ƒè™‘å‡†å¤‡æš—é»‘æ¨¡å¼ç‰ˆæœ¬ï¼Œæˆ–ä½¿ç”¨ <code>ColorFiltered</code> è°ƒæ•´</li>
</ol>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å›¾æ ‡ï¼šæ˜¾å¼æŒ‡å®šé¢œè‰²</span>
Icon(
  Icons.settings,
  color: BeeTokens.iconPrimary(context), <span class="hljs-comment">// ä¸è¦çœç•¥</span>
)

<span class="hljs-comment">// å›¾ç‰‡ï¼šå¯ä»¥ç”¨ ColorFiltered è°ƒæ•´</span>
ColorFiltered(
  colorFilter: BeeTokens.isDark(context)
      ? <span class="hljs-keyword">const</span> ColorFilter.mode(Colors.white, BlendMode.srcIn)
      : <span class="hljs-keyword">null</span>,
  child: Image.asset(<span class="hljs-string">'assets/logo.png'</span>),
)
</code></pre>
<h3 data-id="heading-22">å‘ 6ï¼šä¸»é¢˜åˆ‡æ¢å Provider çŠ¶æ€</h3>
<p><strong>é—®é¢˜</strong>ï¼šä¸»é¢˜åˆ‡æ¢åï¼ŒæŸäº›é¡µé¢é¢œè‰²æ²¡æ›´æ–°ã€‚</p>
<p><strong>åŸå› </strong>ï¼šæ²¡æœ‰æ­£ç¡®ä½¿ç”¨ <code>ref.watch()</code>ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šç¡®ä¿åœ¨ <code>build</code> æ–¹æ³•ä¸­ä½¿ç”¨ <code>ref.watch()</code> ç›‘å¬ Providerï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šåªåœ¨ initState è¯»å–ä¸€æ¬¡</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ConsumerState</span>&lt;<span class="hljs-title">MyPage</span>&gt; </span>{
  <span class="hljs-keyword">late</span> Color _bgColor;

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    _bgColor = BeeTokens.surface(context); <span class="hljs-comment">// è¿™é‡Œè¯»å–åä¸ä¼šæ›´æ–°</span>
  }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåœ¨ build ä¸­ç›‘å¬</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ConsumerState</span>&lt;<span class="hljs-title">MyPage</span>&gt; </span>{
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">final</span> bgColor = BeeTokens.surface(context); <span class="hljs-comment">// æ¯æ¬¡ build éƒ½é‡æ–°è·å–</span>
    <span class="hljs-comment">// ...</span>
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-23">è®¾è®¡æ€è€ƒ</h2>
<h3 data-id="heading-24">ä¸ºä»€ä¹ˆé€‰çº¯é»‘è€Œä¸æ˜¯æ·±ç°ï¼Ÿ</h3>




















<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>çº¯é»‘ #000000</td><td>OLED çœç”µã€å¯¹æ¯”åº¦é«˜ã€æç®€</td><td>å¯èƒ½æ˜¾å¾—ã€Œç©ºæ´ã€</td></tr><tr><td>æ·±ç° #121212</td><td>Material Design æ¨èã€æŸ”å’Œ</td><td>OLED ä¸çœç”µã€å¯¹æ¯”åº¦ä½</td></tr></tbody></table>
<p>æœ€ç»ˆé€‰æ‹©çº¯é»‘ï¼Œå› ä¸ºï¼š</p>
<ol>
<li>ç°åœ¨å¤§éƒ¨åˆ†æ‰‹æœºæ˜¯ OLED å±ï¼Œçº¯é»‘çœŸçš„èƒ½çœç”µ</li>
<li>é…åˆä¸»é¢˜è‰²è¾¹æ¡†ï¼Œä¸ä¼šæ˜¾å¾—å•è°ƒ</li>
<li>æç®€é£æ ¼æ›´ç¬¦åˆè¿™ä¸ª App çš„è°ƒæ€§</li>
</ol>
<h3 data-id="heading-25">ä¸ºä»€ä¹ˆç”¨ä¸»é¢˜è‰²è¾¹æ¡†ï¼Ÿ</h3>
<ol>
<li><strong>ä¿ç•™ä¸ªæ€§åŒ–</strong>ï¼šç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ä¸»é¢˜è‰²ï¼Œæš—é»‘æ¨¡å¼ä¸‹ä¹Ÿèƒ½ä½“ç°</li>
<li><strong>å±‚æ¬¡åˆ†æ˜</strong>ï¼šè¾¹æ¡†è®©å¡ç‰‡å’ŒèƒŒæ™¯åŒºåˆ†å¼€ï¼Œä¸ä¼šé»‘æˆä¸€ç‰‡</li>
<li><strong>å“ç‰Œæ„Ÿ</strong>ï¼šå½©è‰²ç‚¹ç¼€è®©ç•Œé¢æ›´æœ‰è®°å¿†ç‚¹</li>
<li><strong>æŠ€æœ¯ç®€å•</strong>ï¼šåªéœ€è¦åœ¨æš—é»‘æ¨¡å¼ä¸‹åŠ ä¸€ä¸ª borderï¼Œä¸ç”¨å‡†å¤‡ä¸¤å¥—èµ„æº</li>
</ol>
<hr/>
<h2 data-id="heading-26">é¡¹ç›®åœ°å€</h2>
<p><strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTNT-Likely%2FBeeCount" target="_blank" title="https://github.com/TNT-Likely/BeeCount" ref="nofollow noopener noreferrer">github.com/TNT-Likely/â€¦</a></p>
<p>è¿™æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„ Flutter è®°è´¦ Appï¼Œç›®å‰å·²æœ‰ <strong>600+ Star</strong>ã€‚</p>
<p>ä¸»è¦ç‰¹æ€§ï¼š</p>
<ul>
<li>å®Œå…¨å…è´¹ï¼Œæ— å¹¿å‘Š</li>
<li>éšç§ä¼˜å…ˆï¼Œæ•°æ®æœ¬åœ°å­˜å‚¨</li>
<li>æ”¯æŒ WebDAV/Supabase è‡ªæ‰˜ç®¡åŒæ­¥</li>
<li>å¤šè´¦æœ¬ã€è´¦æˆ·ç®¡ç†ã€ç»Ÿè®¡æŠ¥è¡¨ç­‰å®Œæ•´åŠŸèƒ½</li>
<li>æ”¯æŒ iOS å’Œ Android</li>
</ul>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« æˆ–è¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç»™ä¸ª â­ Star æ”¯æŒä¸€ä¸‹ï¼</strong></p>
<p>ä»£ç éƒ½æ˜¯å¼€æºçš„ï¼Œæ¬¢è¿å‚è€ƒå’Œå€Ÿé‰´ã€‚</p>
<hr/>
<h2 data-id="heading-27">ä¸‹è½½ä½“éªŒ</h2>
<ul>
<li><strong>iOS App Store</strong>ï¼ˆæµ·å¤–åŒºï¼‰ï¼šæœç´¢ã€Œèœœèœ‚è®°è´¦-ç®€æ´è®°è´¦æœ¬ã€</li>
<li><strong>iOS TestFlight</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftestflight.apple.com%2Fjoin%2FEaw2rWxa" target="_blank" title="https://testflight.apple.com/join/Eaw2rWxa" ref="nofollow noopener noreferrer">testflight.apple.com/join/Eaw2rWâ€¦</a></li>
<li><strong>Android APK</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTNT-Likely%2FBeeCount%2Freleases" target="_blank" title="https://github.com/TNT-Likely/BeeCount/releases" ref="nofollow noopener noreferrer">github.com/TNT-Likely/â€¦</a></li>
</ul>
<p>æ¬¢è¿è¯•ç”¨å¹¶åé¦ˆæ„è§ï¼æœ‰é—®é¢˜å¯ä»¥åœ¨ GitHub Issues æˆ–è¯„è®ºåŒºå‘Šè¯‰æˆ‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java æ•°ç»„è¿›é˜¶æ“ä½œ]]></title>    <link>https://juejin.cn/post/7575102209606352922</link>    <guid>https://juejin.cn/post/7575102209606352922</guid>    <pubDate>2025-11-23T10:18:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575102209606352922" data-draft-id="7575438636330844211" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java æ•°ç»„è¿›é˜¶æ“ä½œ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-23T10:18:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»Šå¤©æ²¡ID"/> <meta itemprop="url" content="https://juejin.cn/user/441367612371065"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java æ•°ç»„è¿›é˜¶æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/441367612371065/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»Šå¤©æ²¡ID
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:18:20.000Z" title="Sun Nov 23 2025 10:18:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ•°ç»„ä½œä¸º Java ä¸­æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œå…¶å›ºå®šé•¿åº¦çš„ç‰¹æ€§ä½¿å¾—å¢åˆ æ“ä½œéœ€è¦ç‰¹æ®Šå¤„ç†ã€‚æœ¬æ–‡å°†åŸºäºæ•°ç»„æŸ¥æ‰¾åŠŸèƒ½ï¼Œä¸€æ­¥æ­¥å®ç°å…ƒç´ æ’å…¥ï¼ˆå•ä¸ªå…ƒç´  / æ•°ç»„ï¼‰å’Œåˆ é™¤æ“ä½œï¼Œå¸¦ä½ æŒæ¡æ•°ç»„æ“ä½œçš„æ ¸å¿ƒæŠ€å·§ã€‚</p>
<h2 data-id="heading-0">åŸºç¡€ï¼šæ•°ç»„å…ƒç´ æŸ¥æ‰¾</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªåŸºç¡€åŠŸèƒ½ â€”â€” æŸ¥æ‰¾æŒ‡å®šå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚è¿™æ˜¯åç»­æ‰€æœ‰æ“ä½œçš„å‰æã€‚</p>
<h3 data-id="heading-1">æŸ¥æ‰¾åŠŸèƒ½å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥æ‰¾æ•°ç»„ä¸­æŒ‡å®šå…ƒç´ çš„ä½ç½®
 * 
 * <span class="hljs-doctag">@param</span> arr å¾…æŸ¥æ‰¾çš„æ•°ç»„
 * <span class="hljs-doctag">@param</span> target è¦æŸ¥æ‰¾çš„ç›®æ ‡å…ƒç´ 
 * <span class="hljs-doctag">@return</span> å…ƒç´ æ‰€åœ¨ç´¢å¼•ï¼Œæœªæ‰¾åˆ°è¿”å›-1
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findElement</span><span class="hljs-params">(<span class="hljs-type">int</span>[] arr, <span class="hljs-type">int</span> target)</span> {
    <span class="hljs-comment">// ç©ºæ•°ç»„ç›´æ¥è¿”å›-1</span>
    <span class="hljs-keyword">if</span> (arr == <span class="hljs-literal">null</span> || arr.length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
    
    <span class="hljs-comment">// éå†æ•°ç»„æŸ¥æ‰¾å…ƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
        <span class="hljs-keyword">if</span> (arr[i] == target) {
            <span class="hljs-keyword">return</span> i; <span class="hljs-comment">// æ‰¾åˆ°å…ƒç´ ï¼Œè¿”å›ç´¢å¼•</span>
        }
    }
    
    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// æœªæ‰¾åˆ°å…ƒç´ </span>
}
</code></pre>
<h2 data-id="heading-2">è¿›é˜¶æ“ä½œä¸€ï¼šåœ¨æŒ‡å®šå…ƒç´ åæ’å…¥å•ä¸ªå…ƒç´ </h2>
<h3 data-id="heading-3">ä»£ç å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åœ¨æŒ‡å®šå…ƒç´ åæ’å…¥å•ä¸ªæ–°å…ƒç´ 
 * 
 * <span class="hljs-doctag">@param</span> arr åŸæ•°ç»„
 * <span class="hljs-doctag">@param</span> target ç›®æ ‡å…ƒç´ ï¼ˆåœ¨å…¶åæ’å…¥ï¼‰
 * <span class="hljs-doctag">@param</span> newValue è¦æ’å…¥çš„æ–°å…ƒç´ 
 * <span class="hljs-doctag">@return</span> æ’å…¥åçš„æ–°æ•°ç»„
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] insertAfterElement(<span class="hljs-type">int</span>[] arr, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span> newValue) {
    <span class="hljs-type">int</span> <span class="hljs-variable">targetIndex</span> <span class="hljs-operator">=</span> findElement(arr, target);
    
    <span class="hljs-comment">// æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å›åŸæ•°ç»„å‰¯æœ¬</span>
    <span class="hljs-keyword">if</span> (targetIndex == -<span class="hljs-number">1</span>) {
        <span class="hljs-type">int</span>[] newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[arr.length];
        System.arraycopy(arr, <span class="hljs-number">0</span>, newArr, <span class="hljs-number">0</span>, arr.length);
        <span class="hljs-keyword">return</span> newArr;
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°æ•°ç»„ï¼Œé•¿åº¦+1</span>
    <span class="hljs-type">int</span>[] newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[arr.length + <span class="hljs-number">1</span>];
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ åŠä¹‹å‰çš„å…ƒç´ </span>
    System.arraycopy(arr, <span class="hljs-number">0</span>, newArr, <span class="hljs-number">0</span>, targetIndex + <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// æ’å…¥æ–°å…ƒç´ </span>
    newArr[targetIndex + <span class="hljs-number">1</span>] = newValue;
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ ä¹‹åçš„å…ƒç´ </span>
    System.arraycopy(arr, targetIndex + <span class="hljs-number">1</span>, newArr, targetIndex + <span class="hljs-number">2</span>, 
                     arr.length - targetIndex - <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">return</span> newArr;
}
</code></pre>
<h2 data-id="heading-4">è¿›é˜¶æ“ä½œäºŒï¼šåœ¨æŒ‡å®šå…ƒç´ åæ’å…¥æ•°ç»„</h2>
<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ’å…¥å¤šä¸ªå…ƒç´ ï¼Œè¿™å°±éœ€è¦åœ¨æŒ‡å®šä½ç½®æ’å…¥ä¸€ä¸ªæ•°ç»„ã€‚</p>
<h3 data-id="heading-5">ä»£ç å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åœ¨æŒ‡å®šå…ƒç´ åæ’å…¥ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰å…ƒç´ 
 * 
 * <span class="hljs-doctag">@param</span> arr åŸæ•°ç»„
 * <span class="hljs-doctag">@param</span> target ç›®æ ‡å…ƒç´ ï¼ˆåœ¨å…¶åæ’å…¥ï¼‰
 * <span class="hljs-doctag">@param</span> insertArr è¦æ’å…¥çš„æ•°ç»„
 * <span class="hljs-doctag">@return</span> æ’å…¥åçš„æ–°æ•°ç»„
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] insertArrayAfterElement(<span class="hljs-type">int</span>[] arr, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span>[] insertArr) {
    <span class="hljs-keyword">if</span> (insertArr == <span class="hljs-literal">null</span> || insertArr.length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> arr.clone(); <span class="hljs-comment">// æ’å…¥æ•°ç»„ä¸ºç©ºï¼Œè¿”å›åŸæ•°ç»„å‰¯æœ¬</span>
    }
    
    <span class="hljs-type">int</span> <span class="hljs-variable">targetIndex</span> <span class="hljs-operator">=</span> findElement(arr, target);
    
    <span class="hljs-comment">// æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å›åŸæ•°ç»„å‰¯æœ¬</span>
    <span class="hljs-keyword">if</span> (targetIndex == -<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> arr.clone();
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°æ•°ç»„ï¼Œé•¿åº¦=åŸæ•°ç»„é•¿åº¦+æ’å…¥æ•°ç»„é•¿åº¦</span>
    <span class="hljs-type">int</span>[] newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[arr.length + insertArr.length];
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ åŠä¹‹å‰çš„å…ƒç´ </span>
    System.arraycopy(arr, <span class="hljs-number">0</span>, newArr, <span class="hljs-number">0</span>, targetIndex + <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// æ’å…¥æ–°æ•°ç»„</span>
    System.arraycopy(insertArr, <span class="hljs-number">0</span>, newArr, targetIndex + <span class="hljs-number">1</span>, insertArr.length);
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ ä¹‹åçš„å…ƒç´ </span>
    System.arraycopy(arr, targetIndex + <span class="hljs-number">1</span>, newArr, 
                     targetIndex + <span class="hljs-number">1</span> + insertArr.length, 
                     arr.length - targetIndex - <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">return</span> newArr;
}
</code></pre>
<h2 data-id="heading-6">è¿›é˜¶æ“ä½œä¸‰ï¼šåˆ é™¤æŒ‡å®šå…ƒç´ </h2>
<h3 data-id="heading-7">ä»£ç å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åˆ é™¤æ•°ç»„ä¸­çš„æŒ‡å®šå…ƒç´ 
 * 
 * <span class="hljs-doctag">@param</span> arr åŸæ•°ç»„
 * <span class="hljs-doctag">@param</span> target è¦åˆ é™¤çš„ç›®æ ‡å…ƒç´ 
 * <span class="hljs-doctag">@return</span> åˆ é™¤åçš„æ–°æ•°ç»„
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] deleteElement(<span class="hljs-type">int</span>[] arr, <span class="hljs-type">int</span> target) {
    <span class="hljs-type">int</span> <span class="hljs-variable">targetIndex</span> <span class="hljs-operator">=</span> findElement(arr, target);
    
    <span class="hljs-comment">// æœªæ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè¿”å›åŸæ•°ç»„å‰¯æœ¬</span>
    <span class="hljs-keyword">if</span> (targetIndex == -<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> arr.clone();
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°æ•°ç»„ï¼Œé•¿åº¦-1</span>
    <span class="hljs-type">int</span>[] newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[arr.length - <span class="hljs-number">1</span>];
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ ä¹‹å‰çš„å…ƒç´ </span>
    System.arraycopy(arr, <span class="hljs-number">0</span>, newArr, <span class="hljs-number">0</span>, targetIndex);
    
    <span class="hljs-comment">// å¤åˆ¶ç›®æ ‡å…ƒç´ ä¹‹åçš„å…ƒç´ </span>
    System.arraycopy(arr, targetIndex + <span class="hljs-number">1</span>, newArr, targetIndex, 
                     arr.length - targetIndex - <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">return</span> newArr;
}
</code></pre>
<h2 data-id="heading-8">æ€»ç»“</h2>
<p>æœ¬æ–‡é€šè¿‡æ•°ç»„æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤ä¸‰å¤§æ“ä½œçš„å®ç°ï¼Œå±•ç¤ºäº† Java æ•°ç»„æ“ä½œçš„æ ¸å¿ƒæŠ€å·§ï¼š</p>
<ol>
<li><strong>æŸ¥æ‰¾æ˜¯åŸºç¡€</strong>ï¼šæ‰€æœ‰å®šä½æ“ä½œéƒ½ä¾èµ–äºå…ƒç´ æŸ¥æ‰¾åŠŸèƒ½</li>
<li><strong>å¢åˆ é å¤åˆ¶</strong>ï¼šæ•°ç»„é•¿åº¦å›ºå®šï¼Œå¢åˆ æ“ä½œæœ¬è´¨æ˜¯åˆ›å»ºæ–°æ•°ç»„å¹¶åˆ†åŒºåŸŸå¤åˆ¶å…ƒç´ </li>
<li><strong>åˆ†æ®µå¤„ç†æ˜¯å…³é”®</strong>ï¼šæ— è®ºæ˜¯æ’å…¥è¿˜æ˜¯åˆ é™¤ï¼Œéƒ½éœ€è¦å°†æ•°ç»„åˆ†ä¸ºç›®æ ‡ä½ç½®å‰åä¸¤éƒ¨åˆ†åˆ†åˆ«å¤„ç†</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React+ts+viteè„šæ‰‹æ¶æ­å»ºï¼ˆäº”ï¼‰ã€ç™»å½•ç¯‡ã€‘]]></title>    <link>https://juejin.cn/post/7575182522411384870</link>    <guid>https://juejin.cn/post/7575182522411384870</guid>    <pubDate>2025-11-23T10:19:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575182522411384870" data-draft-id="7573886599433666611" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React+ts+viteè„šæ‰‹æ¶æ­å»ºï¼ˆäº”ï¼‰ã€ç™»å½•ç¯‡ã€‘"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-23T10:19:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯»æ‰¾å…‰_sxy"/> <meta itemprop="url" content="https://juejin.cn/user/1495754537711661"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React+ts+viteè„šæ‰‹æ¶æ­å»ºï¼ˆäº”ï¼‰ã€ç™»å½•ç¯‡ã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1495754537711661/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯»æ‰¾å…‰_sxy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:19:42.000Z" title="Sun Nov 23 2025 10:19:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin:30px 0 10px;color:#cca152;position:relative;padding-left:50px;border-bottom:2px solid rgba(209,163,78,.6);padding-bottom:0}.markdown-body h1{font-size:30px}.markdown-body h1:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:80%;bottom:-10px;left:-2px}.markdown-body h2{font-size:24px}.markdown-body h2:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:70%;bottom:-15px;left:-1px}.markdown-body h3{font-size:18px}.markdown-body h3:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:60%;bottom:-19px;left:-2px}.markdown-body h4{font-size:16px;padding-left:0;border-bottom:1px solid rgba(209,163,78,.6)}.markdown-body h5{font-size:15px;padding-left:0}.markdown-body em{color:#cca152}.markdown-body del{text-decoration-color:#cca152;text-decoration-thickness:2px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:80%;margin:6px auto;box-shadow:0 6px 15px #8e8e8e;display:block;margin:20px auto!important;object-fit:contain;border-radius:8px}.markdown-body hr{border:none;border-top:2px solid #e0c9a1;margin-top:32px 0}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background:#f6efde;color:#b69454;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Mono,Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;background:#fef6e1;border-radius:4px;box-shadow:0 0 8px hsla(0,0%,47%,.45)}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAOCAMAAABaWb9VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACHUExURUdwTMxCKdc8NvdYT/9hVyLJPABBAGubKNiIOv+/K+ytJBakH9aZG+5QR5VZDOBDPhmtJ8+VGuGjH/CwJR26MR6+NBq0LPW1KBmwKetNRfJUTONHP92fHuSmIeFEPhu3LR29M/BTS+mqIuqsI5qdHyLKPP++Kv9gVf9lW//KLSXXQCTQP//FLMVm5KQAAAAldFJOUwAlPPz7+woBBPu8Mzu+FlRRKmvnweeG+Wqg6mVNXmuc1OCbmjZJWF/9AAABKklEQVQoz3WS6XaCMBCFRzAM++KGsqhtDwES3//5OtmA2uP9A9zwzRoAgBC0QgQrdA68OZsDr229YGHoIEj7Pl0ZOgjKa5lYJ4Rd1vijn3nuD4Qurjmv48o6RFyfbGDnS6DeEXZfk5ZfuBhdPb9I87ECNMh1EFJKIU6agWzaa01NbmLkxznSmmObJBkkUxrERf3i+ftRiZi7ShPCYY64UhTx1AR5CDYoMXkOKEY7GmTcTzeD/FiER68DfSLgSRqEIBoB3P8h3x8RZhBXGJGusJdD6rfCBl0YqvZNkrV9zej2cWlfJWG6fRpyM41qYH+GTPPi2yFLQYC0Qybm5o96lW77kMbcrBKtgeWTsthVamNXFF4I6x0DTPuugsVRFyYpyxzWqNvHJwed8ws7QyP1UwjNjwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fef6e1}.markdown-body a{text-decoration:none;color:#d8ac5a;border-bottom:1px solid #d8ac5a}.markdown-body a:active,.markdown-body a:hover{color:#93753f;border-color:#93753f}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f4e8c7;border-collapse:collapse}.markdown-body thead{background:rgba(255,227,176,.6588235294);text-align:left;display:table-header-group;border-bottom:1px solid rgba(255,227,176,.6588235294)}.markdown-body tbody{background:rgba(255,247,229,.3882352941)}.markdown-body td,.markdown-body th{padding:7px;line-height:24px;min-width:100px}.markdown-body blockquote{color:#bd954f;padding:1px 23px;margin:22px 0;border-left:4px solid #dcb267;background-color:#fff7e5}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol .task-list-item,.markdown-body ul .task-list-item{list-style:none}.markdown-body ol li{padding-left:6px}.markdown-body::marker{color:#dcb267}.markdown-body .contains-task-list{padding-left:0}.markdown-body .contains-task-list .task-list-item{list-style:none;position:relative}.markdown-body .contains-task-list .task-list-item input[type=checkbox]{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:before{content:"";display:inline-block;height:12px;width:12px;position:absolute;left:-2px;top:-2px;border:2px solid #cda152;border-radius:5px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked:before{border:none;content:"";display:inline-block;height:17px;width:17px;position:absolute;left:-2px;top:-2px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAFo9M/3AAAAAXNSR0IArs4c6QAAAYhJREFUOBFjYACC0/MDGsDEiyvr/zOCeUwMJxn/A8HZRUEMYBFGJsZ6kFoQYALiAyAGCgDpA+sFijKeWRj4H1kWpIWBW1SDQcm+BCzOAiK/vr7BcO/gDbAAI4hE1waWgRBnmWCGIwkyKFjnwow0BhsJk9QLncvw5dV1oPE9MCEGmBWrgCKhcFEowyR+PSNYwemFAZ4M/xjMkRWYJm5oAPFB/joDpI1BHHQANgGPDxj+//vfCA4IdJ3GcevgQnAFhlHLwYIgSVA0wABcwY3tFQzokiBFGIEP0wmigW5wZAK5FFkQib0a6NUDcEmgb7AGFpIGZOZqoMFhIAFQknEAJpn9yLLEssFOBCp2IFaDkl0xg6C8FbJyB3gowUS5RdQYBORQYpVB1iwVHIIMwJh///AYTCmYRklNIBFmNi4GeYt0BhnjeIa3dw8wSBlEgDUhxw2yCRgGfHp2geHiqiSwUwUVrFAiFVkjjA1LrjgTHEwhFvosMCZM4NEIUoAtWWNoBGZ70/gN22HiAD2uhAzsYNBZAAAAAElFTkSuQmCC) 0 0 no-repeat;background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-plateau-dark">.hljs-comment,.hljs-quote{color:#7e7777}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ca4949}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#b45a3c}.hljs-bullet,.hljs-string,.hljs-symbol{color:#4b8b8b}.hljs-section,.hljs-title{color:#7272ca}.hljs-keyword,.hljs-selector-tag{color:#8464c4}.hljs-addition,.hljs-deletion{color:#1b1818;display:inline-block;width:100%}.hljs-deletion{background-color:#ca4949}.hljs-addition{background-color:#4b8b8b}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1b1818;color:#8a8585}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šä¸€ç¯‡æˆ‘ä»¬ä»‹ç»äº†åœ¨è„šæ‰‹æ¶ä¸­é…ç½®ä»£ç æ ¼å¼è§„èŒƒã€ä»£ç æäº¤è§„èŒƒï¼š<a href="https://juejin.cn/post/7561623724090097683" target="_blank" title="https://juejin.cn/post/7561623724090097683">React+ts+viteè„šæ‰‹æ¶æ­å»ºï¼ˆäº”ï¼‰ã€è§„èŒƒç¯‡ã€‘</a></p>
<p>æœ¬ç¯‡æˆ‘ä»¬å°†å¼€å§‹è„šæ‰‹æ¶ä¸­çš„æœ€åä¸€ç¯‡--ç™»å½•ç¯‡</p>
<p>æœ¬æ–‡æˆ‘ä»¬å°†å®Œæˆä¸€ä¸ªä¼ ç»Ÿçš„è´¦å·+å¯†ç ç™»å½•åŠŸèƒ½</p>
<h2 data-id="heading-1">å…·ä½“æ­¥éª¤</h2>
<h3 data-id="heading-2">æ–°å»ºä¸€ä¸ªç™»å½•è·¯ç”±</h3>
<p>åœ¨è·¯ç”±é…ç½®ä¸­æ–°å»ºä¸€ä¸ªç™»å½•è·¯ç”±
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cf6125ff1054441b3616fabdab9aab5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a-75om-5YWJX3N4eQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497982&amp;x-signature=FCozqos%2FUo1%2BESlSoWqRff6n41I%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">æ–°å»ºç™»å½•+ä»£ç </h3>
<ul>
<li>åœ¨è¿™æ®µä»£ç ä¸­æˆ‘ä»¬åˆ†åˆ«åšäº†ï¼š
<ul>
<li>è´¦å·å’Œå¯†ç çš„è¾“å…¥æ¡†ã€ç™»å½•æŒ‰é’®</li>
<li>ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘</li>
<li>ç™»å½•æˆåŠŸåå°†è¿”å›çš„tokenä¿å­˜åˆ°localStorage
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18acd908be1446849d505c7e2ffd6052~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a-75om-5YWJX3N4eQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497982&amp;x-signature=nmwjyWjfJgykJ38I8KkCi0%2FKZrc%3D" alt="image.png" loading="lazy"/></li>
</ul>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"./index.css"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Login</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [form, setForm] = <span class="hljs-title function_">useState</span>({
    <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
  });

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt; {
    <span class="hljs-keyword">const</span> { name, value } = e.<span class="hljs-property">target</span>;
    <span class="hljs-title function_">setForm</span>({
      ...form,
      [name]: value,
    });
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">login</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">if</span> (!form.<span class="hljs-property">username</span> || !form.<span class="hljs-property">password</span>) {
      <span class="hljs-title function_">alert</span>(<span class="hljs-string">"è¯·è¾“å…¥è´¦å·å¯†ç "</span>);
      <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">"token"</span>, <span class="hljs-string">"123456"</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"login"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è´¦å·"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{form.username}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¯†ç "</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{form.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{login}</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Login</span>;
</code></pre>
<p>é¡µé¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc37c86b10e24eeda46c40c807d88be3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a-75om-5YWJX3N4eQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497982&amp;x-signature=mXOU%2FoLhsA0Qj%2BqUW1EJ%2BZFsfvo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">tokençš„æºå¸¦</h3>
<p>æˆ‘ä»¬å­˜å‚¨å®Œtokenåï¼Œéœ€è¦åœ¨æ¯æ¬¡çš„æ¥å£è¯·æ±‚ä¸­éƒ½æºå¸¦ä¸Šï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸Šæºå¸¦ä¸Š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd2816b24f0941bf8ee5339088172d45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a-75om-5YWJX3N4eQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497982&amp;x-signature=PE78tMcmoFxSj8IpBichn0wH73k%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">ç™»å½•çš„æ ¡éªŒ</h3>
<p>ä¸€èˆ¬æ¥è¯´ä¸€ä¸ªéœ€è¦ç™»å½•çš„ç³»ç»Ÿï¼Œå¤§éƒ¨åˆ†çš„æ¥å£éƒ½æ˜¯éœ€è¦ç™»å½•éªŒè¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†ç™»å½•çš„æ ¡éªŒå†™åœ¨å“åº”æ‹¦æˆªå™¨ä¸­ï¼Œå½“å‘ç°æ¥å£å“åº”å›æ¥çš„codeä¸ºæœªç™»å½•çš„codeæ—¶ï¼Œå³ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µé‡æ–°å¼€å§‹ç™»å½•</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba32290a36df4420baf2611e87114aed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a-75om-5YWJX3N4eQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764497982&amp;x-signature=mYwtHQQWQzmPaBg0ubqt4vIcGtQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>è¿™æ ·ä¸€ä¸ªæç®€çš„ç™»å½•ç³»ç»Ÿå°±å·²ç»åšå¥½ã€‚ã€‚ã€‚</p>
<p>è¿™é‡Œæœ‰å‡ ç‚¹è¡¥å……ï¼š</p>
<ul>
<li>ç³»ç»Ÿç™»å½•çš„tokenä¸€èˆ¬æ˜¯é€šè¿‡æ¥å£è¿”å›çš„ï¼Œæˆ‘è¿™é‡Œæ˜¯æ¨¡æ‹Ÿäº†ä¸€ä¸‹ï¼Œå¤§å®¶åç»­å¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®çš„å®é™…æƒ…å†µæ¥å†™æ¥å£</li>
<li>ç™»å½•çš„tokenæˆ‘æ˜¯å­˜åœ¨localStorageä¸­çš„ï¼Œä½ ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨sessionStorageä¸­</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é—®ç­”åˆ°å†³ç­–ï¼šAgentic AIå¦‚ä½•é‡æ–°å®šä¹‰AIæ™ºèƒ½ä½“çš„æœªæ¥]]></title>    <link>https://juejin.cn/post/7575102209606402074</link>    <guid>https://juejin.cn/post/7575102209606402074</guid>    <pubDate>2025-11-23T10:38:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575102209606402074" data-draft-id="7575133880436490291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é—®ç­”åˆ°å†³ç­–ï¼šAgentic AIå¦‚ä½•é‡æ–°å®šä¹‰AIæ™ºèƒ½ä½“çš„æœªæ¥"/> <meta itemprop="keywords" content="ç®—æ³•,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-23T10:38:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MobotStone"/> <meta itemprop="url" content="https://juejin.cn/user/3839909554568840"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é—®ç­”åˆ°å†³ç­–ï¼šAgentic AIå¦‚ä½•é‡æ–°å®šä¹‰AIæ™ºèƒ½ä½“çš„æœªæ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3839909554568840/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MobotStone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:38:54.000Z" title="Sun Nov 23 2025 10:38:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ‰è¿™ä¹ˆä¸ªç°è±¡ï¼Œå¦‚æœä½ çš„ AI åŠ©æ‰‹ä¸å†åªæ˜¯ä¸ªå¬è¯çš„å·¥å…·ï¼Œè€Œæ˜¯èƒ½çœŸæ­£æ˜ç™½ä½ æƒ³è¦ä»€ä¹ˆï¼Œç„¶åè‡ªå·±è§„åˆ’ã€åŠ¨æ‰‹æ‰§è¡Œï¼Œè®©ä½ èƒ½è…¾å‡ºæ‰‹æ¥ï¼Œä¸“å¿ƒåšé‚£äº›çœŸæ­£é‡è¦çš„äº‹ã€‚</p>
<p>è¿™å¯ä¸æ˜¯ç§‘å¹»ç”µå½±é‡Œçš„æƒ…èŠ‚ã€‚</p>
<p>è¿™å°±æ˜¯ AI çš„æœªæ¥ï¼Œä¸€ç§å«åšâ€œ<strong>Agentic AI</strong>â€ï¼ˆè¿˜ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘åˆé€‚ï¼Œè‡ªä¸»å‹AIï¼Ÿï¼‰çš„æ–°æ¨¡å¼ï¼Œå®ƒå·²ç»å¼€å§‹æ”¹å˜æˆ‘ä»¬çš„å·¥ä½œæ–¹å¼ã€è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå¹¶æ¿€å‘å…¨æ–°çš„åˆ›æ–°ã€‚</p>
<p>ä½ è®© AI åŠ©æ‰‹å†™å°é‚®ä»¶ï¼Œå®ƒå°±å†™äº†ã€‚ä½†å¦‚æœå®ƒæ›´è¿›ä¸€æ­¥ï¼Œä¸ä»…å¸®ä½ å†™ï¼Œè¿˜èƒ½è‡ªå·±åˆ¤æ–­è¿™å°é‚®ä»¶è¯¥å‘ç»™è°ã€ä»€ä¹ˆæ—¶å€™å‘æœ€åˆé€‚ï¼Œç”šè‡³åœ¨å¯¹æ–¹æ²¡å›å¤æ—¶ï¼Œä¸»åŠ¨å¸®ä½ è¿½é—®ä¸€ä¸‹å‘¢ï¼Ÿ</p>
<p>å†æƒ³è¿œä¸€ç‚¹ï¼šåŒä¸€ä¸ª AI è¿˜èƒ½ç®¡ç†ä½ çš„å¾…åŠäº‹é¡¹ï¼Œé€šè¿‡è§‚å¯Ÿä½ æ¯å¤©çš„å·¥ä½œä¹ æƒ¯ï¼Œåœ¨å°éº»çƒ¦æ¼”å˜æˆå¤§é—®é¢˜ä¹‹å‰ï¼Œå°±æå‰ç»™ä½ é¢„è­¦ã€‚</p>
<p>è¿™å°±æ˜¯ Agentic AI å¸¦æ¥çš„å¯èƒ½æ€§ã€‚å®ƒä¸å†åªæ˜¯ä¸€ä¸ªé—®ä¸€å¥ç­”ä¸€å¥ã€æˆ–è€…ç”Ÿæˆå†…å®¹çš„å·¥å…·ï¼Œè€Œæ˜¯æ›´åƒä¸€ä¸ªâ€œæ•°å­—é˜Ÿå‹â€ã€‚å®ƒä¼šä¸ºäº†ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼Œè‡ªå·±åšå†³å®šã€è§„åˆ’æ­¥éª¤ï¼Œå¹¶é‡‡å–è¡ŒåŠ¨ã€‚</p>
<p>åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠ Agentic AI åˆ°åº•æ˜¯ä»€ä¹ˆã€å®ƒå’Œæˆ‘ä»¬ç†ŸçŸ¥çš„ AIæ™ºèƒ½ä½“æœ‰ä»€ä¹ˆä¸åŒï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒä¼šæˆä¸ºç°åœ¨ AI é¢†åŸŸæœ€çƒ­é—¨çš„è¯é¢˜ä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-0"><strong>ä»€ä¹ˆæ˜¯Agentic AIï¼Ÿ</strong></h2>
<p>Agentic AIæŒ‡çš„æ˜¯èƒ½å¤Ÿ<strong>ç‹¬ç«‹æ€è€ƒã€åˆ¶å®šè®¡åˆ’å¹¶é‡‡å–è¡ŒåŠ¨</strong>çš„äººå·¥æ™ºèƒ½ç³»ç»Ÿï¼Œå°±åƒä¸€ä¸ªæœ‰ä½¿å‘½çš„ä»£ç†äººä¸€æ ·ã€‚è¿™äº›ç³»ç»Ÿä»¥ç›®æ ‡ä¸ºå¯¼å‘ï¼Œèƒ½å¤Ÿå°†å¤§ä»»åŠ¡æ‹†è§£æˆå°æ­¥éª¤ï¼Œæ‰¾å‡ºæœ€ä½³å®ç°æ–¹å¼ï¼Œç”šè‡³åœ¨æƒ…å†µå‘ç”Ÿå˜åŒ–æ—¶çµæ´»è°ƒæ•´ã€‚</p>
<h3 data-id="heading-1">å¯ä»¥è¿™æ ·ç†è§£ï¼š</h3>
<ul>
<li><strong>ä¼ ç»ŸAI</strong>ï¼šå›ç­”ä½ çš„é—®é¢˜</li>
<li><strong>ç”Ÿæˆå¼AI</strong>ï¼šåˆ›é€ å†…å®¹</li>
<li><strong>AIæ™ºèƒ½ä½“</strong>ï¼šæ ¹æ®è§„åˆ™æˆ–æŒ‡ä»¤æ‰§è¡Œç‰¹å®šä»»åŠ¡</li>
<li><strong>Agentic AI</strong>ï¼šè®¾å®šç›®æ ‡ï¼Œåˆ¶å®šè®¡åˆ’ï¼Œä»˜è¯¸å®æ–½ï¼Œå¹¶ä»ç»“æœä¸­å­¦ä¹ </li>
</ul>
<h3 data-id="heading-2">ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</h3>
<p>å‡è®¾ä½ åœ¨ä¸€å®¶ä¿é™©å…¬å¸å·¥ä½œã€‚ä¸å…¶åªæ˜¯ç”¨èŠå¤©æœºå™¨äººå›ç­”ä¿å•é—®é¢˜ï¼ˆä¼ ç»ŸAIï¼‰ï¼Œæˆ–è€…ç”Ÿæˆå®¢æˆ·é‚®ä»¶ï¼ˆç”Ÿæˆå¼AIï¼‰ï¼Œæˆ–è€…è‡ªåŠ¨å¤„ç†ç†èµ”ç¡®è®¤ï¼ˆAI<strong>æ™ºèƒ½ä½“</strong>ï¼‰ä¸åŒï¼Œ<strong>Agentic AI</strong>èƒ½å¤Ÿï¼š</p>
<ul>
<li>å‘ç°æŸä¸ªç‰¹å®šåœ°åŒºçš„ç†èµ”æ•°é‡æ¿€å¢</li>
<li>åˆ©ç”¨å†…éƒ¨å’Œå¤–éƒ¨æ•°æ®è°ƒæŸ¥åŸå› </li>
<li>æ›´æ–°æ‰¿ä¿é£é™©æ¨¡å‹</li>
<li>ä¸ºå—å½±å“çš„å®¢æˆ·èµ·è‰é’ˆå¯¹æ€§æ²Ÿé€šå†…å®¹</li>
<li>æé†’åˆè§„å’Œåæ¬ºè¯ˆå›¢é˜Ÿ</li>
<li>æŒç»­ç›‘æ§å¹¶è°ƒæ•´ç­–ç•¥â€”â€”å®Œå…¨è‡ªä¸»å®Œæˆ</li>
</ul>
<p>è¿™å°±æ˜¯åŒºåˆ«æ‰€åœ¨â€”â€”Agentic AIä¸ä»…ä»…æ˜¯è¾…åŠ©å·¥å…·ï¼Œå®ƒå¸¦æ¥çš„æ˜¯<strong>ä¸»åŠ¨æ€§ã€ç‹¬ç«‹æ€§å’Œé€‚åº”æ€§</strong>ã€‚</p>
<h3 data-id="heading-3">ä»€ä¹ˆä¸æ˜¯<strong>Agentic AI</strong>ï¼Ÿ</h3>
<p>ä¸ºäº†çœŸæ­£ç†è§£ä»€ä¹ˆæ˜¯<strong>Agentic AI</strong>ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹å®ƒä¸æ˜¯ä»€ä¹ˆã€‚</p>
<ul>
<li><strong>ä¸æ˜¯ç®€å•çš„é—®ç­”æœºå™¨äºº</strong>ï¼šæ¯”å¦‚é‚£ç§åªå›ç­”å¸¸è§é—®é¢˜çš„æœºå™¨äººï¼Œè™½ç„¶èƒ½å¸®å¿™è§£ç­”ç–‘é—®ï¼Œä½†å®ƒåªæ˜¯å¯¹é—®é¢˜ä½œå‡ºå³æ—¶å›å¤ï¼Œä¸ä¼šè¶…å‡ºå½“å‰è¯·æ±‚å»è¿›è¡Œè§„åˆ’æˆ–é‡‡å–è¡ŒåŠ¨ã€‚</li>
<li><strong>ä¸æ˜¯åªä¼šç”Ÿæˆæ–‡æœ¬çš„å·¥å…·</strong>ï¼šæ¯”å¦‚ ChatGPT åœ¨æ”¶åˆ°æŒ‡ä»¤æ—¶ç¼–å†™åšå®¢æ–‡ç« ï¼Œè™½ç„¶æ•ˆæœå‡ºè‰²ï¼Œä½†å®ƒä»…ä»…æ˜¯åœ¨äººçš„æŒ‡ç¤ºä¸‹å·¥ä½œï¼Œä¸èƒ½è‡ªå·±è®¾å®šæ›´å¤§çš„ç›®æ ‡ã€‚</li>
<li><strong>ä¸æ˜¯æ¨èç³»ç»Ÿ</strong>ï¼šé‚£äº›ä¼šç»™ä½ æ¨èç”µå½±æˆ–å•†å“çš„ç³»ç»Ÿï¼Œè™½ç„¶å¾ˆèªæ˜ï¼Œä½†å®ƒä»¬ä¸»è¦ä¾é é¢„æµ‹ï¼Œè€Œä¸æ˜¯æ ¹æ®ç›®æ ‡åšå‡ºå®é™…è¡ŒåŠ¨ã€‚</li>
<li><strong>ä¹Ÿä¸ä»…ä»…æ˜¯è‡ªåŠ¨åŒ–å·¥å…·</strong>ï¼šæ¯”å¦‚é‚£äº›è‡ªåŠ¨å‘é€æé†’é‚®ä»¶æˆ–æ›´æ–°è¡¨æ ¼çš„ç¨‹åºï¼Œå®ƒä»¬é€šå¸¸æ˜¯æ ¹æ®å›ºå®šè§„åˆ™æ‰§è¡Œä»»åŠ¡ï¼Œä¸ä¼šè‡ªè¡Œå†³å®šè¦å¹²ä»€ä¹ˆæˆ–ä¸ºä»€ä¹ˆå»åšã€‚</li>
</ul>
<p>åœ¨ä¸Šé¢è¿™äº›æƒ…å†µä¸­ï¼Œç›¸å…³ç³»ç»Ÿéƒ½æ˜¯â€œè¢«åŠ¨å¼â€çš„ï¼šå®ƒä»¬åªæ˜¯åœ¨ç­‰å¾…è¾“å…¥æˆ–æŒ‰ç…§äº‹å…ˆè®¾å®šå¥½çš„æµç¨‹å·¥ä½œï¼Œç¼ºä¹è‡ªä¸»è®¾å®šç›®æ ‡ã€åšå‡ºå†³ç­–æˆ–æ ¹æ®ç¯å¢ƒå˜åŒ–è‡ªæˆ‘è°ƒæ•´çš„èƒ½åŠ›ã€‚</p>
<p>è€Œ<strong>Agentic AI</strong>æ›´è¿›ä¸€æ­¥â€”â€”å®ƒèƒ½æœ‰ç›®çš„åœ°è¡ŒåŠ¨ï¼Œä¼šæ ¹æ®æƒ…å†µçµæ´»è°ƒæ•´ï¼Œè€Œä¸”å¸¸å¸¸ä¸éœ€è¦äººä¸æ–­ç›‘ç£ã€‚å®ƒä¸ä»…ä»…æ˜¯å®ç°è‡ªåŠ¨åŒ–ï¼Œæ›´æ˜¯åœ¨å®ç°æ™ºèƒ½åŒ–çš„ç‹¬ç«‹å†³ç­–å’Œè¡ŒåŠ¨ã€‚</p>
<h2 data-id="heading-4">å¯¹æ¯”è¿™äº›æ¦‚å¿µï¼šAI vs. ç”Ÿæˆå¼ AI vs. æ™ºèƒ½ä½“ vs. <strong>Agentic AI</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d494255b982a4a7990b7530cc149a699~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9ib3RTdG9uZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764499133&amp;x-signature=eetyAAXArB8CgFg17%2B97pDRvHlE%3D" alt="" loading="lazy"/></p>



























































<table><thead><tr><th>ç‰¹æ€§</th><th>ç”Ÿæˆå¼AI</th><th>æ™ºèƒ½ä½“</th><th>Agentic AI</th></tr></thead><tbody><tr><td><strong>ç›®çš„</strong></td><td>ç”Ÿæˆè¾“å‡º</td><td>å®ç°ç›®æ ‡</td><td>å®Œæˆé«˜å±‚ç›®æ ‡</td></tr><tr><td><strong>æ‰§è¡Œæ–¹å¼</strong></td><td>ä¸€æ¬¡æ€§ç”Ÿæˆ</td><td>ä¸€æ­¥æ­¥åšå‡ºå†³ç­–</td><td>åŠ¨æ€ã€å¤šæ­¥éª¤å†³ç­–</td></tr><tr><td><strong>å·¥å…·ä½¿ç”¨</strong></td><td>ä¸æ”¯æŒ</td><td>åŸºç¡€å·¥å…·è®¿é—®</td><td>é«˜çº§å·¥å…·ç¼–æ’</td></tr><tr><td><strong>è®°å¿†èƒ½åŠ›</strong></td><td>æ— è®°å¿†</td><td>æœ‰é™/ä¸´æ—¶è®°å¿†</td><td>è·¨ä¼šè¯ä½¿ç”¨è®°å¿†</td></tr><tr><td><strong>æ¨ç†èƒ½åŠ›</strong></td><td>åŸºç¡€ï¼ˆæ¨¡å‹å†…éƒ¨ï¼‰</td><td>ä¸­ç­‰æ¨ç†èƒ½åŠ›</td><td>é«˜çº§æ¨ç†åŠè‡ªæˆ‘æ‰¹è¯„</td></tr><tr><td><strong>å­Agentæ”¯æŒ</strong></td><td>æ— </td><td>å•ä¸ªAgent</td><td>åä½œå¼å­Agent</td></tr><tr><td><strong>è‡ªä¸»ç¨‹åº¦</strong></td><td>ä½</td><td>ä¸­ç­‰</td><td>é«˜</td></tr><tr><td><strong>æœ€é€‚ç”¨åœºæ™¯</strong></td><td>æ–‡æœ¬/å›¾åƒ/ä»£ç ç”Ÿæˆ</td><td>ç®€å•ä»»åŠ¡è‡ªåŠ¨åŒ–</td><td>å¤æ‚å†³ç­–å’Œé—®é¢˜è§£å†³</td></tr></tbody></table>
<h3 data-id="heading-5"><strong>äººå·¥æ™ºèƒ½ (AI)</strong></h3>
<p>äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰å°±åƒä¸€ä¸ªå¤§å¸½å­ï¼ŒåŒ…å«äº†å¾ˆå¤šä¸åŒçš„æŠ€æœ¯ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæŒ‡çš„æ˜¯é‚£äº›èƒ½æ¨¡ä»¿äººç±»æ™ºèƒ½æ¥å®Œæˆäº‹æƒ…çš„æœºå™¨æˆ–ç³»ç»Ÿï¼Œæ¯”å¦‚å­¦ä¹ ã€æ€è€ƒæˆ–è€…è§£å†³é—®é¢˜ã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong> ä¸€ç§è¯„ä¼°ä¿é™©ç´¢èµ”çš„ç³»ç»Ÿï¼Œå®ƒä¼šåˆ†æå®¢æˆ·æ•°æ®å’Œç´¢èµ”å†å²ï¼Œæ¥åˆ¤æ–­ç´¢èµ”æ˜¯å¦æœ‰æ¬ºè¯ˆè¡Œä¸ºã€‚</p>
<p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼š</strong> å®ƒå¯ä»¥å¤„ç†æœ‰è§„å¾‹çš„æ•°æ®ï¼Œå‘ç°å…¶ä¸­çš„è¶‹åŠ¿ï¼Œå¹¶å¸®åŠ©äººä»¬åšå‡ºå†³ç­–â€”â€”æ¯”å¦‚æ‰¹å‡†æˆ–æ ‡è®°ç´¢èµ”ã€‚</p>
<p><strong>å®ƒçš„å±€é™æ€§ï¼š</strong> ä¼ ç»Ÿçš„AIé€šå¸¸æ¯”è¾ƒâ€œå•ä¸€â€ï¼Œå®ƒè¢«è®¾è®¡ç”¨äºå®Œæˆç‰¹å®šçš„ä»»åŠ¡ã€‚å®ƒæ— æ³•å¤„ç†è¶…å‡ºå®ƒè®­ç»ƒèŒƒå›´çš„äº‹æƒ…ï¼Œè€Œä¸”å®ƒä¹Ÿæ— æ³•åƒäººç±»ä¸€æ ·ç†è§£ä¸Šä¸‹æ–‡å’Œç›®çš„ã€‚</p>
<h3 data-id="heading-6"><strong>ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ (Generative AI)</strong></h3>
<p>ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ï¼ˆGenerative AIï¼‰æ˜¯ä¸€ç§â€œæœ‰åˆ›é€ åŠ›â€çš„AIã€‚å®ƒèƒ½åˆ›é€ å‡ºå…¨æ–°çš„å†…å®¹ï¼Œä¾‹å¦‚æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘æˆ–ä»£ç ï¼Œé€šè¿‡å­¦ä¹ ç°æœ‰çš„æ•°æ®æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong> ä¸€ç§ç”Ÿæˆå¼AIæ¨¡å‹å¯ä»¥æ ¹æ®å®¢æˆ·çš„äº¤æ˜“æ•°æ®å’ŒæŠ•èµ„ç›®æ ‡ï¼Œä¸ºå®¢æˆ·ç”Ÿæˆä¸ªæ€§åŒ–çš„è´¢åŠ¡å»ºè®®æŠ¥å‘Šã€‚</p>
<p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼š</strong> å½“ä½ ç»™å®ƒä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä¼šäº§ç”Ÿå†…å®¹ï¼Œæ¯”å¦‚ä¸€ä»½æ‰¿ä¿æŠ¥å‘Šã€ä¸€ä»½ä¿å•æ¦‚è¦ï¼Œæˆ–è€…ç»™å®¢æˆ·å‘é€çš„ä¸€å°é‚®ä»¶ã€‚</p>
<p><strong>å®ƒçš„å±€é™æ€§ï¼š</strong> å®ƒæ˜¯â€œååº”å¼â€çš„ã€‚å®ƒåªèƒ½åœ¨ä½ æ˜ç¡®æä¾›è¾“å…¥çš„æ—¶å€™å·¥ä½œã€‚å®ƒä¸ä¼šä¸»åŠ¨å†³å®šè¦åˆ›é€ ä»€ä¹ˆï¼Œæˆ–è€…ä»€ä¹ˆæ—¶å€™å¼€å§‹è¡ŒåŠ¨â€”â€”å®ƒåªæ˜¯åœ¨å“åº”ä½ çš„æŒ‡ä»¤ã€‚</p>
<h3 data-id="heading-7"><strong>AIæ™ºèƒ½ä½“ (AI Agents)</strong></h3>
<p>AIæ™ºèƒ½ä½“ï¼ˆAI Agentsï¼‰èƒ½â€œè¡ŒåŠ¨â€ã€‚å®ƒä»¬è¢«è®¾è®¡ç”¨æ¥æ ¹æ®æŒ‡ä»¤å®Œæˆç‰¹å®šçš„ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯ä¸ºäº†è‡ªåŠ¨åŒ–é‡å¤æ€§çš„å·¥ä½œã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong> ä¸€ä¸ªAIæ™ºèƒ½ä½“å¯ä»¥è‡ªåŠ¨å°†æ”¶åˆ°çš„é‚®ä»¶æ ¹æ®å†…å®¹åˆ†æï¼Œè·¯ç”±åˆ°æ­£ç¡®çš„éƒ¨é—¨â€”â€”ä¾‹å¦‚ç´¢èµ”ã€æ‰¿ä¿æˆ–æ”¯æŒéƒ¨é—¨ã€‚</p>
<p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼š</strong> å®ƒå¯ä»¥æŒ‰ç…§è®¾å®šçš„ä»»åŠ¡æ‰§è¡ŒæŒ‡ä»¤â€”â€”æ¯”å¦‚ç»™å®¢æˆ·å‘é€æé†’ã€æ›´æ–°CRMè®°å½•æˆ–è€…ä»è¡¨æ ¼ä¸­æå–å…³é”®æ•°æ®ã€‚</p>
<p><strong>å®ƒçš„å±€é™æ€§ï¼š</strong> å®ƒé€šå¸¸æ˜¯â€œä»»åŠ¡å¯¼å‘â€çš„ï¼Œå¹¶ä¸”é€šå¸¸æ˜¯â€œåŸºäºè§„åˆ™â€çš„ã€‚å®ƒæ— æ³•é€‚åº”æƒ…å†µï¼Œä¹Ÿæ— æ³•ä¸»åŠ¨é‡‡å–è¡ŒåŠ¨ï¼Œé™¤éå®ƒè¢«ç¼–ç¨‹æ¥æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-8"><strong>Agentic AI</strong></h3>
<p>è¿™æ˜¯æœ€æ–°ä¹Ÿæ˜¯æœ€å…ˆè¿›çš„ä¸€ç§AIå½¢å¼ã€‚æ™ºèƒ½ä½“å¼AI ä¸ä»…ä»…ä¼šç­‰å¾…æŒ‡ä»¤â€”â€”å®ƒèƒ½â€œè®¾å®šè‡ªå·±çš„ç›®æ ‡ã€åˆ¶å®šè®¡åˆ’å¹¶é‡‡å–è¡ŒåŠ¨â€æ¥å®ç°è¿™äº›ç›®æ ‡ï¼Œå°±åƒäººç±»ä¸€æ ·ã€‚</p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong> ä½ å‘Šè¯‰ä¸€ä¸ªæ™ºèƒ½ä½“å¼AI â€œæ”¹è¿›å®¢æˆ·æ³¨å†Œæµç¨‹â€ã€‚å®ƒä¼šåˆ†ææ³¨å†Œè¿‡ç¨‹ä¸­çš„é—®é¢˜ï¼Œé‡æ–°è®¾è®¡æ³¨å†Œæµç¨‹ï¼Œä½¿ç”¨RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç”Ÿæˆä¸ªæ€§åŒ–çš„å¸¸è§é—®é¢˜è§£ç­”ï¼Œå¹¶è‡ªåŠ¨æ”¶é›†æ–‡æ¡£ï¼ŒåŒæ—¶è¿˜ä¼šè¡¡é‡å®¢æˆ·æ»¡æ„åº¦â€”â€”è¿™äº›éƒ½æ˜¯å®ƒè‡ªå·±å®Œæˆçš„ã€‚</p>
<p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼š</strong> å®ƒå¯ä»¥â€œæ€è€ƒã€æ¨ç†å’Œé€‚åº”â€ã€‚å®ƒå¯ä»¥åˆ›å»ºå’Œæ”¹è¿›ç­–ç•¥ã€è§£å†³é—®é¢˜ï¼Œå¹¶ä¸å…¶ä»–ç³»ç»ŸååŒå·¥ä½œâ€”â€”å°±åƒä¸€ä½æ•°å­—é¡¹ç›®ç»ç†æˆ–ä¸šåŠ¡åˆ†æå¸ˆã€‚</p>
<p><strong>å®ƒçš„å±€é™æ€§ï¼š</strong> å®ƒâ€œè¿˜åœ¨å‘å±•ä¸­â€ã€‚æ™ºèƒ½ä½“å¼AIå¯èƒ½éœ€è¦ä¸€äº›ç›‘ç£ï¼Œä»¥ç¡®ä¿å®ƒä¸å…¬å¸çš„ç›®æ ‡ã€ä»·å€¼è§‚å’Œå®‰å…¨é™åˆ¶ä¿æŒä¸€è‡´ã€‚å®ƒéå¸¸å¼ºå¤§ï¼Œä½†å¹¶éä¸‡æ— ä¸€å¤±çš„ã€‚</p>
<h3 data-id="heading-9"><strong>Agentic AIçš„æ ¸å¿ƒç‰¹å¾</strong></h3>
<p>Agentic AIä¸åªæ˜¯èªæ˜ï¼Œæ›´é‡è¦çš„æ˜¯<strong>æœ‰æ˜ç¡®ç›®æ ‡ï¼Œèƒ½ä¸»åŠ¨å‡ºå‡»</strong>ã€‚å®ƒèåˆäº†æ€è€ƒèƒ½åŠ›ã€è®°å¿†èƒ½åŠ›å’Œç‹¬ç«‹è¡ŒåŠ¨èƒ½åŠ›ï¼Œæ›´åƒæ˜¯ä½ çš„æ•°å­—åŒäº‹ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿå·¥å…·ã€‚</p>
<ul>
<li><strong>æœ‰æ˜ç¡®ç›®æ ‡ï¼š</strong>Â æœç€å…·ä½“ç›®æ ‡å‰è¿›ï¼Œè€Œä¸æ˜¯è¢«åŠ¨åœ°å›ç­”æé—®ã€‚</li>
<li><strong>ç‹¬ç«‹è¡ŒåŠ¨ï¼š</strong>Â ä¸»åŠ¨å‡ºå‡»ï¼Œæ‰§è¡Œä»»åŠ¡æ—¶ä¸éœ€è¦ä½ ä¸€æ­¥æ­¥å‘Šè¯‰å®ƒæ€ä¹ˆåšã€‚</li>
<li><strong>ä¼šæ€è€ƒå’Œè§„åˆ’ï¼š</strong>Â èƒ½æŠŠå¤æ‚é—®é¢˜æ‹†è§£å¼€ï¼Œè‡ªå·±æƒ³æ¸…æ¥šæœ€å¥½çš„è§£å†³åŠæ³•ã€‚</li>
<li><strong>æœ‰è®°å¿†å’Œå­¦ä¹ èƒ½åŠ›ï¼š</strong>Â è®°å¾—ä¹‹å‰åšè¿‡ä»€ä¹ˆã€ç»“æœæ€æ ·ï¼Œç”¨è¿™äº›ç»éªŒæ¥åšæ›´å¥½çš„å†³ç­–ã€‚</li>
<li><strong>ç†è§£æƒ…å¢ƒï¼š</strong>Â èƒ½æ„ŸçŸ¥å‘¨å›´çš„ç¯å¢ƒï¼Œæ ¹æ®ä¸åŒæƒ…å†µè°ƒæ•´è‡ªå·±çš„è¡ŒåŠ¨æ–¹å¼ã€‚</li>
<li><strong>çŸ¥é“ä½•æ—¶éœ€è¦äººï¼š</strong>Â é‡åˆ°é£é™©æ—¶ä¼šåœä¸‹æ¥é—®ä½ ã€å‘ä½ æ±‡æŠ¥ï¼Œç¡®ä¿ä¸€åˆ‡åœ¨æ§åˆ¶ä¹‹ä¸­ã€‚</li>
</ul>
<p>è¿™ç§<strong>ç‹¬ç«‹æ€è€ƒå’Œä¸»åŠ¨è¡ŒåŠ¨çš„ç»“åˆ</strong>ï¼Œå°±æ˜¯Agentic AIçœŸæ­£å‰å®³çš„åœ°æ–¹ã€‚</p>
<h3 data-id="heading-10"><strong>ä¸ºä»€ä¹ˆç°åœ¨éœ€è¦ Agentic AIï¼Ÿ</strong></h3>
<p>åœ¨ç°åœ¨è¿™ä¸ªå˜åŒ–é£å¿«çš„å‘å±•ç¯å¢ƒä¸­ï¼ŒAgentic AI æ­£åœ¨æˆä¸ºæ¨åŠ¨æ™ºèƒ½åŒ–ã€å…¨æµç¨‹è‡ªåŠ¨åŒ–çš„å…³é”®åŠ›é‡ã€‚å®ƒçš„é‡è¦æ€§ä½“ç°åœ¨è¿™å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>æ•°æ®å¤ªå¤šï¼Œå†³ç­–å˜æ…¢</strong> ä¿é™©å…¬å¸æ¯å¤©è¦å¤„ç†æ”¿ç­–æ–‡ä»¶ã€ç†èµ”èµ„æ–™ã€æ³•è§„æ›´æ–°ã€å®¢æˆ·æ²Ÿé€šè¿™äº›æ‚ä¹±çš„ä¿¡æ¯ã€‚Agentic AI èƒ½å¸®ç€<strong>æ•´ç†ä¿¡æ¯ã€åˆ†æ¸…è½»é‡ç¼“æ€¥ã€ä¸»åŠ¨æ‰§è¡Œä»»åŠ¡</strong>ï¼Œæ¯”å¦‚åŠ å¿«æ ¸ä¿é€Ÿåº¦ã€æå‡æ¬ºè¯ˆè¯†åˆ«æ•ˆç‡ã€ç®€åŒ–åˆè§„æµç¨‹ã€‚</li>
<li><strong>AI å·¥å…·è¶Šæ¥è¶Šæˆç†Ÿ</strong> ç°åœ¨æœ‰äº†åƒ GPT-4 è¿™æ ·çš„å¼ºå¤§è¯­è¨€æ¨¡å‹ï¼ŒåŠ ä¸Š LangChainã€ReActã€AutoGPT è¿™ç±»å¹³å°ï¼ŒAI èƒ½<strong>è·¨æ–‡æ¡£ã€è·¨ç³»ç»Ÿã€è·¨ä»»åŠ¡åˆ†æé—®é¢˜</strong>ã€‚è¿™è®©å®¢æˆ·å¼€æˆ·ã€ç†èµ”åˆ†ç±»ã€é£é™©è¯„ä¼°è¿™äº›æµç¨‹å¯ä»¥è¢«æ™ºèƒ½è‡ªåŠ¨åŒ–ã€‚</li>
<li><strong>è¦çš„æ˜¯èƒ½è‡ªå·±å¹²æ´»çš„AI</strong> ä¼ä¸šä¸å†æ»¡è¶³äºæ­»æ¿çš„è§„åˆ™æœºå™¨äººï¼Œç°åœ¨å¸Œæœ›AIèƒ½<strong>ä¸»åŠ¨å‘èµ·è¡ŒåŠ¨ã€å®æ—¶ç›‘æ§æ•ˆæœã€çµæ´»è°ƒæ•´ç­–ç•¥</strong>ã€‚æ¯”å¦‚åœ¨äº¤æ˜“ä¸­å‘ç°å¼‚å¸¸ï¼Œæˆ–è€…åœ¨ç†èµ”æ—¶è‡ªåŠ¨æ¨èä¸‹ä¸€æ­¥æ“ä½œï¼Œå®ƒéƒ½èƒ½åšåˆ°ã€‚</li>
<li><strong>ä»çœé’±åˆ°èµšé’±</strong> ä¼ ç»Ÿè‡ªåŠ¨åŒ–ï¼ˆRPAï¼‰åªèƒ½èŠ‚çœæ—¶é—´ï¼ŒAgentic AI å´èƒ½<strong>åˆ›é€ å®é™…ä»·å€¼</strong>ã€‚å®ƒèƒ½æå‡å®¢æˆ·ä½“éªŒã€æé«˜ç•™å­˜ç‡ã€å®ç°ä¸ªæ€§åŒ–æœåŠ¡ï¼Œç”šè‡³å¸®å…¬å¸å‘ç°æ–°æ”¶å…¥æ¥æºâ€”â€”åœ¨æ•´ä¸ªä¿é™©å’ŒæŠ•èµ„æµç¨‹é‡Œï¼Œå®ƒéƒ½æ˜¯ä¸ªé è°±çš„æ•°å­—ä¼™ä¼´ã€‚</li>
</ul>
<p>Agentic AI ä¸æ˜¯å•çº¯åœ°æŠŠä»»åŠ¡åšå¾—æ›´å¿«ï¼Œè€Œæ˜¯è®©æ•´ä¸ªä¸šåŠ¡æµç¨‹å˜å¾—æ›´<strong>èªæ˜ã€çµæ´»ã€æœ‰é€‚åº”æ€§</strong>ã€‚å®ƒä»£è¡¨çš„ä¸æ˜¯ç®€å•çš„è‡ªåŠ¨åŒ–ï¼Œè€Œæ˜¯è®©AIçœŸæ­£å…·å¤‡<strong>è‡ªä¸»è¡ŒåŠ¨åŠ›</strong>çš„è½¬å˜ã€‚</p>
<h2 data-id="heading-11"><strong>æ€»ç»“</strong></h2>
<p>Agentic AI çš„å‡ºç°ï¼Œæ ‡å¿—ç€ AI çš„è§’è‰²è¿æ¥äº†ä¸€æ¬¡å¤§å˜èº«ã€‚å®ƒä¸å†æ˜¯ä¸€ä¸ªä½ å«å®ƒåšä»€ä¹ˆã€å®ƒå°±åšä»€ä¹ˆçš„è¢«åŠ¨å·¥å…·ï¼Œè€Œæ˜¯å˜æˆäº†ä¸€ä¸ªèƒ½ä¸»åŠ¨å¹²æ´»ã€ä¸»åŠ¨æ€è€ƒçš„â€œæ•°å­—åŒäº‹â€ã€‚</p>
<p>å®ƒçš„ä»»åŠ¡ä¸å†åªæ˜¯ç”Ÿæˆç‚¹å†…å®¹æˆ–è·‘è·‘å›ºå®šæµç¨‹ï¼Œè€Œæ˜¯è¦<strong>ä¸ºæœ€ç»ˆçš„ç»“æœè´Ÿè´£</strong>ï¼Œä¸ºäº†è¾¾æˆä¸šåŠ¡ç›®æ ‡è‡ªå·±æƒ³åŠæ³•ã€åšå†³ç­–ï¼Œå°±åƒä½ èº«è¾¹é‚£äº›èƒ½åŠ›å‡ºä¼—çš„çœŸäººåŒäº‹ä¸€æ ·ã€‚</p>
<p>å¯¹ä¼ä¸šæ¥è¯´ï¼Œè¿™å°±å¥½æ¯”è§£é”äº†è¶…èƒ½åŠ›ã€‚åƒ<strong>ä¿é™©æ ¸ä¿</strong>ã€<strong>ç†èµ”ç®¡ç†</strong>ã€<strong>åæ¬ºè¯ˆ</strong>ã€<strong>åˆè§„å®¡æŸ¥</strong>è¿™äº›è¿‡å»è®©äººå¤´ç–¼çš„å¤æ‚å·¥ä½œï¼Œç°åœ¨éƒ½å¯ä»¥äº¤ç»™å®ƒã€‚Agentic AI ä¸ä»…èƒ½æŠŠè¿™äº›äº‹å¤„ç†å¾—æ›´å¿«ï¼Œå…³é”®æ˜¯æ›´èªæ˜ï¼Œè¿˜èƒ½æ ¹æ®å®é™…æƒ…å†µçµæ´»è°ƒæ•´ã€‚å®ƒèƒ½è½»æ¾é©¾é©­å…¬å¸å†…éƒ¨é‚£äº›å¤æ‚åˆäº’ä¸è¿é€šçš„å„ç§ç³»ç»Ÿï¼Œè®©æ™ºèƒ½çš„åŠ›é‡è´¯ç©¿å…¨å±€ï¼Œè€Œä¸”æ•´ä¸ªè¿‡ç¨‹å‡ ä¹ä¸éœ€è¦äººæ€ä¹ˆæ“å¿ƒã€‚</p>
<p>è€Œè¿™ä¸€åˆ‡ï¼Œè¿˜ä»…ä»…æ˜¯ä¸ªå¼€å§‹ã€‚</p>
<p>éšç€ Agentic AI è¶Šæ¥è¶Šæˆç†Ÿï¼Œæœªæ¥çš„å•†ä¸šä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° AI æ™ºèƒ½ä½“å’Œäººç±»å‘˜å·¥å¹¶è‚©åä½œã€‚å®ƒä»¬ä¼šä¸»åŠ¨ç®¡ç†æŠ•èµ„ç»„åˆã€ä¸å®¢æˆ·æ²Ÿé€šäº’åŠ¨ã€å¯¹å¸‚åœºçš„é£å¹è‰åŠ¨è¿…é€Ÿåšå‡ºååº”â€”â€”åŒæ—¶è¿˜èƒ½ç¡®ä¿æ‰€æœ‰è¡Œä¸ºéƒ½ç¬¦åˆå…¬å¸å’Œæ³•è§„çš„è¦æ±‚ã€‚</p>
<p>è¿™å¸¦æ¥çš„æœºé‡ï¼Œæ—©å·²è¶…è¶Šäº†ç®€å•çš„â€œè‡ªåŠ¨åŒ–â€èŒƒç•´ï¼Œè€Œæ˜¯è¿ˆå‘äº†â€œ<strong>åœ¨æ•´ä¸ªä¼ä¸šèŒƒå›´å†…ï¼Œå®ç°è‡ªä¸»çš„ä»·å€¼åˆ›é€ </strong>â€è¿™ä¸€å…¨æ–°é«˜åº¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[jpaå°†SQLè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶]]></title>    <link>https://juejin.cn/post/7575442779039105066</link>    <guid>https://juejin.cn/post/7575442779039105066</guid>    <pubDate>2025-11-23T10:59:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575442779039105066" data-draft-id="7575313772988678185" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="jpaå°†SQLè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶"/> <meta itemprop="keywords" content="åç«¯,Spring Boot,Spring"/> <meta itemprop="datePublished" content="2025-11-23T10:59:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€ƒè™‘è€ƒè™‘"/> <meta itemprop="url" content="https://juejin.cn/user/4406498335157287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            jpaå°†SQLè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4406498335157287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€ƒè™‘è€ƒè™‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T10:59:35.000Z" title="Sun Nov 23 2025 10:59:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>Springbootæ•´åˆjpaå¯ä»¥æŠŠSQLè¯­å¥è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶</p>
<h3 data-id="heading-1">é…ç½®å¦‚ä¸‹</h3>
<p>åœ¨<code>application.yml</code>é…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">org.hibernate.SQL:</span> <span class="hljs-string">DEBUG</span>  <span class="hljs-comment"># æ‰“å° SQL è¯­å¥</span>
    <span class="hljs-attr">org.hibernate.type.descriptor.sql.BasicBinder:</span> <span class="hljs-string">TRACE</span>  <span class="hljs-comment"># æ‰“å° SQL å‚æ•°ç»‘å®šå€¼</span>
    <span class="hljs-attr">org.springframework.data.jpa:</span> <span class="hljs-string">INFO</span>  <span class="hljs-comment"># Spring Data JPA æ—¥å¿—ï¼ˆå¯é€‰ï¼‰</span>
</code></pre>
<p>è¿™æ ·å°±å¯ä»¥æŠŠ<code>SQL</code>è¯­å¥è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶</p>
<h3 data-id="heading-2">æ€»ç»“</h3>
<p>å¦‚æœä½¿ç”¨JPAæ¡†æ¶æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦æ’æŸ¥é—®é¢˜ï¼Œå¯ä»¥å°†jpaè¯­å¥è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œä½†æ˜¯å¯èƒ½ä¼šæ‹–æ…¢è¿è¡Œæ•ˆç‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[kotlinæŠ½è±¡ç±»ï¼ˆä¸æ¥å£çš„åŒºåˆ«ï¼‰]]></title>    <link>https://juejin.cn/post/7575106644499071010</link>    <guid>https://juejin.cn/post/7575106644499071010</guid>    <pubDate>2025-11-23T07:20:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575106644499071010" data-draft-id="7575112613777883170" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="kotlinæŠ½è±¡ç±»ï¼ˆä¸æ¥å£çš„åŒºåˆ«ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-23T07:20:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—é›¨åŒ—æ–—"/> <meta itemprop="url" content="https://juejin.cn/user/4059818590476286"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            kotlinæŠ½è±¡ç±»ï¼ˆä¸æ¥å£çš„åŒºåˆ«ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4059818590476286/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—é›¨åŒ—æ–—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:20:55.000Z" title="Sun Nov 23 2025 07:20:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬æ¥è¯¦ç»†æ¢è®¨ä¸€ä¸‹ Kotlin ä¸­çš„æŠ½è±¡ç±»ã€‚</p>
<p>åœ¨ Kotlin ä¸­ï¼Œ<strong>æŠ½è±¡ç±»</strong>æ˜¯ä¸€ç§ä¸èƒ½è¢«ç›´æ¥å®ä¾‹åŒ–çš„ç±»ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ä½œä¸ºå…¶ä»–ç±»çš„åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰ï¼Œç”¨äºå®šä¹‰é€šç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œå°†å…·ä½“çš„å®ç°ç»†èŠ‚ç•™ç»™å­ç±»ã€‚</p>
<h3 data-id="heading-0">1. å®šä¹‰æŠ½è±¡ç±»</h3>
<p>åœ¨ Kotlin ä¸­ï¼Œä½¿ç”¨Â <code>abstract</code>Â å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªæŠ½è±¡ç±»ã€‚</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±» Shape</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-comment">// æŠ½è±¡å±æ€§ï¼ˆæ²¡æœ‰åˆå§‹åŒ–å€¼ï¼Œå¿…é¡»åœ¨å­ç±»ä¸­é‡å†™ï¼‰</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> name: String

    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼ˆæ²¡æœ‰æ–¹æ³•ä½“ï¼Œå¿…é¡»åœ¨å­ç±»ä¸­é‡å†™ï¼‰</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateArea</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Double</span>

    <span class="hljs-comment">// éæŠ½è±¡æ–¹æ³•ï¼ˆæœ‰å…·ä½“å®ç°ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿æˆ–é‡å†™ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printName</span><span class="hljs-params">()</span></span> {
        println(<span class="hljs-string">"å½¢çŠ¶åç§°: <span class="hljs-variable">$name</span>"</span>)
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>æŠ½è±¡ç±»å¯ä»¥åŒ…å«<strong>æŠ½è±¡å±æ€§</strong>å’Œ<strong>æŠ½è±¡æ–¹æ³•</strong>ï¼Œè¿™äº›å¿…é¡»åœ¨å­ç±»ä¸­å®ç°ã€‚</li>
<li>æŠ½è±¡ç±»ä¹Ÿå¯ä»¥åŒ…å«<strong>éæŠ½è±¡å±æ€§</strong>å’Œ<strong>éæŠ½è±¡æ–¹æ³•</strong>ï¼Œè¿™äº›ä¼šè¢«å­ç±»ç»§æ‰¿ã€‚</li>
<li>æŠ½è±¡ç±»<strong>ä¸èƒ½è¢«ç›´æ¥å®ä¾‹åŒ–</strong>ï¼Œå³ä¸èƒ½ä½¿ç”¨Â <code>val shape = Shape()</code>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-1">2. ç»§æ‰¿æŠ½è±¡ç±»</h3>
<p>å­ç±»ç»§æ‰¿æŠ½è±¡ç±»æ—¶ï¼Œå¿…é¡»ä½¿ç”¨Â <code>override</code>Â å…³é”®å­—é‡å†™æ‰€æœ‰æŠ½è±¡å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å­ç±» Circle ç»§æ‰¿è‡ªæŠ½è±¡ç±» Shape</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span>(
    <span class="hljs-keyword">val</span> radius: <span class="hljs-built_in">Double</span>
) : Shape() {
    <span class="hljs-comment">// é‡å†™æŠ½è±¡å±æ€§</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> name: String = <span class="hljs-string">"åœ†å½¢"</span>

    <span class="hljs-comment">// é‡å†™æŠ½è±¡æ–¹æ³•</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateArea</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Double</span> {
        <span class="hljs-keyword">return</span> Math.PI * radius * radius
    }
}

<span class="hljs-comment">// å­ç±» Rectangle ç»§æ‰¿è‡ªæŠ½è±¡ç±» Shape</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span>(
    <span class="hljs-keyword">val</span> width: <span class="hljs-built_in">Double</span>,
    <span class="hljs-keyword">val</span> height: <span class="hljs-built_in">Double</span>
) : Shape() {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> name: String = <span class="hljs-string">"çŸ©å½¢"</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calculateArea</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Double</span> {
        <span class="hljs-keyword">return</span> width * height
    }
}
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-scss" lang="scss">fun <span class="hljs-selector-tag">main</span>() {
    val circle = Circle(<span class="hljs-number">5.0</span>)
    circle<span class="hljs-selector-class">.printName</span>() <span class="hljs-comment">// è¾“å‡ºï¼šå½¢çŠ¶åç§°: åœ†å½¢</span>
    <span class="hljs-built_in">println</span>("é¢ç§¯: ${circle.calculateArea()}") <span class="hljs-comment">// è¾“å‡ºï¼šé¢ç§¯: 78.5398...</span>

    val rectangle = <span class="hljs-built_in">Rectangle</span>(<span class="hljs-number">4.0</span>, <span class="hljs-number">6.0</span>)
    rectangle<span class="hljs-selector-class">.printName</span>() <span class="hljs-comment">// è¾“å‡ºï¼šå½¢çŠ¶åç§°: çŸ©å½¢</span>
    <span class="hljs-built_in">println</span>("é¢ç§¯: ${rectangle.calculateArea()}") <span class="hljs-comment">// è¾“å‡ºï¼šé¢ç§¯: 24.0</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-2">3. æŠ½è±¡ç±»çš„ç‰¹ç‚¹</h3>
<ol>
<li>
<p><strong>ä¸èƒ½å®ä¾‹åŒ–</strong>ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-scss" lang="scss">val shape = <span class="hljs-built_in">Shape</span>() <span class="hljs-comment">// é”™è¯¯ï¼šæŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–</span>
</code></pre>
</li>
<li>
<p><strong>å¯ä»¥åŒ…å«æŠ½è±¡å’ŒéæŠ½è±¡æˆå‘˜</strong>ï¼š</p>
<ul>
<li>æŠ½è±¡æˆå‘˜ï¼ˆ<code>abstract</code>Â ä¿®é¥°ï¼‰å¿…é¡»åœ¨å­ç±»ä¸­é‡å†™ã€‚</li>
<li>éæŠ½è±¡æˆå‘˜å¯ä»¥ç›´æ¥ç»§æ‰¿æˆ–è¢«å­ç±»é‡å†™ï¼ˆä½¿ç”¨Â <code>override</code>ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å­ç±»å¿…é¡»å®ç°æ‰€æœ‰æŠ½è±¡æˆå‘˜</strong>ï¼šå¦‚æœå­ç±»æ²¡æœ‰å®ç°æ‰€æœ‰æŠ½è±¡å±æ€§å’Œæ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»ä¹Ÿå¿…é¡»å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Square</span>(
    <span class="hljs-keyword">val</span> sideLength: <span class="hljs-built_in">Double</span>
) : Shape() {
    <span class="hljs-comment">// åªé‡å†™äº†æŠ½è±¡å±æ€§ï¼Œæ²¡æœ‰é‡å†™æŠ½è±¡æ–¹æ³• calculateArea()</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> name: String = <span class="hljs-string">"æ­£æ–¹å½¢"</span>
    
    <span class="hljs-comment">// å› æ­¤ Square ç±»ä¹Ÿå¿…é¡»æ˜¯æŠ½è±¡çš„</span>
}
</code></pre>
</li>
<li>
<p><strong>æŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»</strong>ï¼šæŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿è‡ªå¦ä¸€ä¸ªéæŠ½è±¡ç±»æˆ–æŠ½è±¡ç±»ã€‚</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">makeSound</span><span class="hljs-params">()</span></span> {
        println(<span class="hljs-string">"åŠ¨ç‰©å‘å‡ºå£°éŸ³"</span>)
    }
}

<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-type">Animal</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">makeSound</span><span class="hljs-params">()</span></span> <span class="hljs-comment">// é‡å†™å¹¶å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Puppy</span> : <span class="hljs-type">Dog</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">makeSound</span><span class="hljs-params">()</span></span> {
        println(<span class="hljs-string">"å°ç‹—æ±ªæ±ªå«"</span>)
    }
}
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-3">4. æŠ½è±¡ç±»ä¸æ¥å£çš„åŒºåˆ«</h3>
<p>åœ¨ Kotlin ä¸­ï¼ŒæŠ½è±¡ç±»å’Œæ¥å£ï¼ˆ<code>interface</code>ï¼‰éƒ½å¯ä»¥ç”¨äºå®šä¹‰æŠ½è±¡è¡Œä¸ºï¼Œä½†å®ƒä»¬æœ‰å‡ ä¸ªå…³é”®åŒºåˆ«ï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>æŠ½è±¡ç±» (<code>abstract class</code>)</th><th>æ¥å£ (<code>interface</code>)</th></tr></thead><tbody><tr><td><strong>æ„é€ å‡½æ•°</strong></td><td>å¯ä»¥æœ‰æ„é€ å‡½æ•°</td><td>ä¸èƒ½æœ‰æ„é€ å‡½æ•°ï¼ˆKotlin 1.9+ æ”¯æŒæ¥å£ä¸­å®šä¹‰å¸¦é»˜è®¤å®ç°çš„å±æ€§ï¼Œä½†ä»ä¸èƒ½æœ‰æ„é€ å‡½æ•°ï¼‰</td></tr><tr><td><strong>å¤šé‡ç»§æ‰¿</strong></td><td>åªèƒ½å•ç»§æ‰¿ï¼ˆä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼‰</td><td>å¯ä»¥å®ç°å¤šä¸ªæ¥å£</td></tr><tr><td><strong>å±æ€§</strong></td><td>å¯ä»¥åŒ…å«éæŠ½è±¡å±æ€§</td><td>æ¥å£ä¸­çš„å±æ€§é»˜è®¤æ˜¯æŠ½è±¡çš„ï¼Œæˆ–å¿…é¡»æä¾› getter å®ç°</td></tr><tr><td><strong>æ–¹æ³•å®ç°</strong></td><td>å¯ä»¥åŒ…å«éæŠ½è±¡æ–¹æ³•çš„å®ç°</td><td>æ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯æŠ½è±¡çš„ï¼Œæˆ–å¿…é¡»æä¾›å®ç°ï¼ˆKotlin 1.4+ æ”¯æŒæ¥å£æ–¹æ³•çš„é»˜è®¤å®ç°ï¼‰</td></tr><tr><td><strong>è®¿é—®ä¿®é¥°ç¬¦</strong></td><td>å¯ä»¥ä½¿ç”¨Â <code>private</code>,Â <code>protected</code>,Â <code>public</code></td><td>æ¥å£æˆå‘˜é»˜è®¤æ˜¯Â <code>public</code>ï¼Œä¸èƒ½æœ‰Â <code>private</code>Â ä¿®é¥°ç¬¦</td></tr></tbody></table>
<p><strong>ä½¿ç”¨å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¦‚æœéœ€è¦å®šä¹‰ä¸€ä¸ªé€šç”¨çš„åŸºç±»ï¼Œå¹¶ä¸”éœ€è¦åŒ…å«æ„é€ å‡½æ•°ã€éæŠ½è±¡å±æ€§æˆ–æ–¹æ³•ï¼Œä½¿ç”¨<strong>æŠ½è±¡ç±»</strong>ã€‚</li>
<li>å¦‚æœåªæ˜¯éœ€è¦å®šä¹‰ä¸€ç»„æŠ½è±¡è¡Œä¸ºï¼ˆæ–¹æ³•æˆ–å±æ€§ï¼‰ï¼Œå¹¶ä¸”å¸Œæœ›ç±»å¯ä»¥å®ç°å¤šä¸ªè¿™æ ·çš„è¡Œä¸ºï¼Œä½¿ç”¨<strong>æ¥å£</strong>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">5. æ€»ç»“</h3>
<ul>
<li>æŠ½è±¡ç±»æ˜¯ç”¨Â <code>abstract</code>Â å…³é”®å­—å£°æ˜çš„ç±»ï¼Œä¸èƒ½è¢«ç›´æ¥å®ä¾‹åŒ–ã€‚</li>
<li>æŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æˆå‘˜ï¼ˆå¿…é¡»åœ¨å­ç±»ä¸­é‡å†™ï¼‰å’ŒéæŠ½è±¡æˆå‘˜ï¼ˆå¯ä»¥ç›´æ¥ç»§æ‰¿ï¼‰ã€‚</li>
<li>å­ç±»ç»§æ‰¿æŠ½è±¡ç±»æ—¶ï¼Œå¿…é¡»é‡å†™æ‰€æœ‰æŠ½è±¡æˆå‘˜ï¼Œå¦åˆ™å­ç±»ä¹Ÿå¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚</li>
<li>æŠ½è±¡ç±»é€‚åˆä½œä¸ºå…·æœ‰å…±åŒå±æ€§å’Œè¡Œä¸ºçš„ç±»çš„åŸºç±»ï¼Œè€Œæ¥å£é€‚åˆå®šä¹‰å¤šä¸ªç±»å¯ä»¥å®ç°çš„æŠ½è±¡è¡Œä¸ºã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 16KB Page Size é€‚é…å®æˆ˜æµç¨‹ï¼šä»¥é‡ç¼–è¯‘FFmpeg soåº“ä¸ºä¾‹]]></title>    <link>https://juejin.cn/post/7575655132748316708</link>    <guid>https://juejin.cn/post/7575655132748316708</guid>    <pubDate>2025-11-23T08:25:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575655132748316708" data-draft-id="7575807729722441762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 16KB Page Size é€‚é…å®æˆ˜æµç¨‹ï¼šä»¥é‡ç¼–è¯‘FFmpeg soåº“ä¸ºä¾‹"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-23T08:25:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åœ¨ç‹‚é£æš´é›¨ä¸­å¥”è·‘"/> <meta itemprop="url" content="https://juejin.cn/user/1841028550886683"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 16KB Page Size é€‚é…å®æˆ˜æµç¨‹ï¼šä»¥é‡ç¼–è¯‘FFmpeg soåº“ä¸ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1841028550886683/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åœ¨ç‹‚é£æš´é›¨ä¸­å¥”è·‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:25:35.000Z" title="Sun Nov 23 2025 08:25:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Android 16KB Page Size é€‚é…å®æˆ˜æµç¨‹ï¼šä»¥é‡ç¼–è¯‘FFmpeg soåº“ä¸ºä¾‹</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>ä¸ºäº†ä¼˜åŒ–äº†ç³»ç»Ÿå†…å­˜æ€§èƒ½ï¼Œè°·æ­Œè®¡åˆ’å°† Android å¹³å°æ¶æ„å‘ 16KB Page Sizeï¼ˆ16384 å­—èŠ‚å†…å­˜é¡µå¤§å°ï¼‰è¿ç§»ï¼Œè¿™ä¼šå¯¼è‡´è®¸å¤šä»…æ”¯æŒ4 KB å†…å­˜é¡µé¢å¤§å°çš„ä¾èµ– C/C++ åŸç”Ÿåº“ï¼ˆ.so æ–‡ä»¶ï¼‰çš„åº”ç”¨åœ¨ 16KB AVD æˆ–è®¾å¤‡ä¸Šé­é‡åŠ è½½å´©æºƒã€‚æ ¹æ®è°·æ­Œæœ€æ–°å®˜æ–¹æ¶ˆæ¯ï¼Œè‡ª 2025 å¹´ 11 æœˆ 1 æ—¥èµ·ï¼Œæäº¤åˆ° Google Play ä¸”ä»¥ Android 15 åŠæ›´é«˜ç‰ˆæœ¬ä¸ºç›®æ ‡å¹³å°çš„æ‰€æœ‰æ–°åº”ç”¨å’Œç°æœ‰åº”ç”¨æ›´æ–°éƒ½å¿…é¡»åœ¨ 64 ä½è®¾å¤‡ä¸Šæ”¯æŒ 16KB Page Sizeã€‚ ä¾èµ– C/C++ åŸç”Ÿåº“ï¼ˆ.so æ–‡ä»¶ï¼‰çš„åº”ç”¨æ²¡åŠæ³•èº²è¿‡é€‚é…16KB Page Sizeçš„å·¥ä½œäº†ã€‚<br/>
æˆ‘æ‰‹ä¸Šçš„é¡¹ç›®<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAudioAndVideoEditor" target="_blank" title="https://github.com/Ilovecat1949/AudioAndVideoEditor" ref="nofollow noopener noreferrer">AudioAndVideoEditor</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAeroFFmpeg" target="_blank" title="https://github.com/Ilovecat1949/AeroFFmpeg" ref="nofollow noopener noreferrer">AeroFFmpeg</a>å‡ä¾èµ–FFmpeg soåº“ä¸”æœªé€‚é…16KB Page Sizeï¼Œé€‚é…16KB Page Sizeå¯¹äºæˆ‘è€Œè¨€ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜ã€‚æˆ‘æœ¬äººä¹Ÿä¸æ˜¯å¾ˆæ‡‚ C/C++ çš„ç¼–è¯‘åº•å±‚åŸç†ï¼Œé€šè¿‡æŠ„è°·æ­Œå®˜æ–¹æŒ‡å¯¼æ•™ç¨‹å’Œå¤§ä½¬åšå®¢ã€é—®aiä¸€è·¯é€‚é…ï¼Œæœ€ç»ˆåº”è¯¥æ˜¯æˆåŠŸé€‚é…çš„äº†ã€‚<br/>
æœ¬æ–‡ä»¥é‡ç¼–è¯‘FFmpeg soåº“ä¸ºä¾‹å­è®²è¯‰é€‚é…æµç¨‹ï¼šä»åˆ¤æ–­æ˜¯å¦æ”¯æŒ16KB Page Sizeï¼Œåˆ°äº¤å‰ç¼–è¯‘soåº“ï¼Œåˆ°é‡æ–°ç¼–è¯‘æ„å»ºæ•´ä¸ªé¡¹ç›®ï¼Œæœ€ç»ˆç¡®ä¿åº”ç”¨åœ¨æœ€æ–°çš„ 16KB Android ç¯å¢ƒä¸­ç¨³å®šè¿è¡Œã€‚</p>
<h3 data-id="heading-2">é€‚é…éš¾ç‚¹</h3>
<p>è™½ç„¶ 16KB é€‚é…å¯¹å¹³å°ç†è®ºä¸Šæœ‰æ˜¾è‘—ç›Šå¤„ï¼Œä½†å…¶å¤§è§„æ¨¡è½åœ°é¢ä¸´å¾ˆå¤§æŒ‘æˆ˜ã€‚çº¯Java/Koliné¡¹ç›®ç†è®ºä¸Šå¯ä»¥ç›´æ¥æ”¯æŒ16KB Page Sizeè®¾å¤‡ï¼Œå…³é”®åœ¨äºåºå¤§çš„C/C++ åŸç”Ÿåº“ç”Ÿæ€ã€‚<br/>
1.æºä»£ç ç¼ºå¤±æˆ–ä¸å¯ä¿®æ”¹ï¼š è®¸å¤šåº”ç”¨ä½¿ç”¨äº†å¤šå¹´å‰ç¼–è¯‘çš„ã€å·²åœæ­¢ç»´æŠ¤çš„ç¬¬ä¸‰æ–¹ SDK æˆ–åŸç”Ÿåº“ã€‚å¦‚æœæ— æ³•è·å–æºä»£ç æˆ–ä¿®æ”¹å…¶æ„å»ºè„šæœ¬ï¼Œåˆ™æ ¹æœ¬æ— æ³•é‡æ–°ç¼–è¯‘å¹¶æ³¨å…¥ 16KB é“¾æ¥å™¨æ ‡å¿—ã€‚<br/>
2.å¤šå±‚ä¾èµ–åµŒå¥—ï¼š å¤æ‚åº”ç”¨å¯èƒ½ä¾èµ–çš„ A åº“åˆä¾èµ– B åº“ï¼Œè€Œ B åº“åˆä¾èµ– C åº“ã€‚åªè¦ä¾èµ–é“¾ä¸­æœ‰ä¸€ä¸ªåº“æœªé€‚é…ï¼Œæ•´ä¸ªåº”ç”¨åœ¨ 16KB ç¯å¢ƒä¸­å°±å¯èƒ½å´©æºƒã€‚<br/>
æ€»ä¹‹ï¼Œæ²¡æœ‰ C/C++ åŸç”Ÿåº“å°±æ²¡æœ‰çƒ¦æ¼ã€‚<br/>
ä¸åŒé¡¹ç›®ä½¿ç”¨çš„ C/C++ ç¼–è¯‘å·¥å…·é“¾å’Œæ„å»ºç³»ç»Ÿ ä¸ä¸€æ ·ï¼Œæ¶‰åŠçš„åŸç”Ÿåº“ä¸ä¸€æ ·ï¼Œæœ¬æ–‡ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAudioAndVideoEditor" target="_blank" title="https://github.com/Ilovecat1949/AudioAndVideoEditor" ref="nofollow noopener noreferrer">AudioAndVideoEditor</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAeroFFmpeg" target="_blank" title="https://github.com/Ilovecat1949/AeroFFmpeg" ref="nofollow noopener noreferrer">AeroFFmpeg</a>ä¸ºä¾‹å­ä»‹ç»C/C++ åŸç”Ÿåº“é€‚é…16KB Page Sizeçš„æµç¨‹ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAudioAndVideoEditor" target="_blank" title="https://github.com/Ilovecat1949/AudioAndVideoEditor" ref="nofollow noopener noreferrer">AudioAndVideoEditor</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAeroFFmpeg" target="_blank" title="https://github.com/Ilovecat1949/AeroFFmpeg" ref="nofollow noopener noreferrer">AeroFFmpeg</a>ä¾èµ–çš„x264ã€x265ã€LAMEã€FFmpegéƒ½æ˜¯çŸ¥åé¡¹ç›®ä¸”ä»£ç å¼€æºï¼Œå› æ­¤å¯ä»¥è‡ªå·±é‡æ–°ç¼–è¯‘æºç é€‚é…16KB Page Sizeï¼Œè¿™ä¸€ç‚¹æ˜¯æ¯”è¾ƒå¹¸è¿çš„ã€‚æˆ‘æ˜¯å…ˆåœ¨Linuxç¯å¢ƒä½¿ç”¨NDK r20äº¤å‰ç¼–è¯‘x264ã€x265ã€LAMEã€FFmpegå¾—åˆ°å¯¹åº”soåº“ï¼Œå†é›†æˆåˆ°Androidé¡¹ç›®é‡Œé¢ä½¿ç”¨CMake+NDK r25ç¼–è¯‘æ„å»ºå¾—åˆ°æœ€ç»ˆçš„Androidåº”ç”¨å’ŒSDKåº“ã€‚é‡æ–°ç¼–è¯‘soåº“çš„è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒçç¢ä¸”è€—æ—¶çš„ã€‚</p>
<h3 data-id="heading-3">åˆ¤æ–­ä½ çš„åº”ç”¨æ˜¯å¦æ»¡è¶³16KB Page Sizeçš„è¦æ±‚</h3>
<p>16KB é€‚é…æœ€å¥½å®‰è£…æ–°çš„Android Studioä»¥ä½¿ç”¨è°·æ­Œæä¾›çš„æœ€æ–°å·¥å…·ã€‚è™½ç„¶å‡çº§Android Studioå¯èƒ½ä¼šç»™è€é¡¹ç›®åˆå¸¦æ¥ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯é•¿ç—›ä¸å¦‚çŸ­ç—›ï¼Œå‡çº§Android Studioå°½é‡è·Ÿä¸Šè°·æ­Œçš„æ­¥ä¼æ˜¯æœ€å¥½çš„ã€‚</p>
<ol>
<li>ä½¿ç”¨Android Studioä¸­çš„Analyze APKå·¥å…·<br/>
åœ¨Android Studioæ‰“å¼€é¡¹ç›®ï¼Œåœ¨æœ€é¡¶ä¸Šèœå•æ ä¸­ï¼Œä¾æ¬¡ç‚¹å‡» Build &gt; Analyze APK...<br/>
å¦‚æœä½ çš„ C/C++ åŸç”Ÿåº“å·²ç»é€‚é… 16KB ï¼Œç»“æœå¦‚ä¸‹ï¼š\</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1548376344c448e8e7e7d4544761ca0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyo54uC6aOO5pq06Zuo5Lit5aWU6LeR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491135&amp;x-signature=pI%2F3%2FIBpjXdlk7hsBtLY7Pe0QMc%3D" alt="APPåˆ†æ.jpg" loading="lazy"/></p>
<ol start="2">
<li>16 KB è™šæ‹Ÿæœºè®¾å¤‡ç›´æ¥è¿è¡Œæµ‹è¯•<br/>
arm64-v8aæˆ–x86_64çš„64ä½è®¾å¤‡æ‰æœ‰16KB Page Sizeçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Android Studioçš„16KB è™šæ‹Ÿæœºä¸Šæµ‹è¯•åº”ç”¨æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œã€‚æ³¨æ„å¦‚æœä½ æ˜¯åœ¨AMDçš„Windowsä¸Šå¼€å‘ï¼Œé‚£ä½ åº”è¯¥é€‰æ‹©x86_64çš„16KB Page Sizeè™šæ‹Ÿæœºï¼Œå¦‚æœæ˜¯ARMæ¶æ„çš„Macåº”è¯¥é€‰æ‹©arm64-v8açš„16KB Page Sizeè™šæ‹Ÿæœºã€‚<br/>
é»˜è®¤æƒ…å†µä¸‹ï¼Œ16KB Page Sizeè™šæ‹Ÿæœºä¼šä½¿ç”¨16 KB å‘åå…¼å®¹æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ çš„åº”ç”¨ä¸æ”¯æŒ16KB Page Sizeä¹Ÿä¸ä¼šä¸€ä¸‹å´©æ‰ï¼Œè€Œæ˜¯ä¼šå¼¹å‡ºæç¤ºã€‚\</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78b2360713364841bb279ca26feed160~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyo54uC6aOO5pq06Zuo5Lit5aWU6LeR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491135&amp;x-signature=o%2ByA8OJ%2FH4eYZ50SV%2BwX%2B8FIu0M%3D" alt="æœªé€‚é…æç¤º.jpg" loading="lazy"/></p>
<pre><code class="hljs">å¦‚æœä½ æƒ³çœ‹çœ‹ä½ çš„åº”ç”¨å´©æºƒçš„æ ·å­ï¼Œå¯ä»¥åœ¨åº”ç”¨è®¾ç½®é‡Œé¢é€‰æ‹©å…³æ‰16 KB å‘åå…¼å®¹æ¨¡å¼ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ã€‚

</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10d04a9c0e974d54bf47d86195aac2d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zyo54uC6aOO5pq06Zuo5Lit5aWU6LeR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491135&amp;x-signature=0x9QX%2BxdUYpme9ML5wrBY1xHNH8%3D" alt="æŠ¥é”™.jpg" loading="lazy"/></p>
<h3 data-id="heading-4">é€‚é…16KB Page Size</h3>
<h4 data-id="heading-5">å…³é”®çš„é“¾æ¥å™¨æ ‡å¿—</h4>
<p>ä¸ºAndroidç¼–è¯‘ C/C++ åŸç”Ÿåº“ä¾é NDKï¼Œä¸åŒç‰ˆæœ¬NDKå¯¹16KB Page Sizeçš„æ”¯æŒä¸ä¸€æ ·ã€‚NDK ç‰ˆæœ¬ r28 åŠæ›´é«˜ç‰ˆæœ¬é»˜è®¤ç¼–è¯‘ä¸º 16 KB å¯¹é½ã€‚Android NDK r27åŠä»¥ä¸‹ç‰ˆæœ¬éœ€è¦è®¾ç½®ç›¸å…³é…ç½®æ–‡ä»¶ã€ç¼–è¯‘è„šæœ¬æ–‡ä»¶çš„å‚æ•°ï¼Œä¸»è¦æ˜¯é“¾æ¥å™¨æ ‡å¿—å‚æ•°ã€‚è°·æ­Œå®˜æ–¹æ¨èå§‹ç»ˆæ›´æ–° NDKï¼Œä½†å®é™…ä¸Šå¯¹äºæ—§é¡¹ç›®è€Œè¨€æ›´æ–°NDKå¾€å¾€ä¼šå¸¦æ¥ä¸€ç³»åˆ—éº»çƒ¦çš„é—®é¢˜ï¼ˆå¾€å¾€ä¸æ˜¯èŠ±ä¸€å¤©ä¸¤å¤©èƒ½è§£å†³çš„ï¼‰ï¼Œå› æ­¤æˆ‘ä¾é ä¸å‡çº§NDKçš„é€‚é…æ–¹æ³•ã€‚<br/>
é€‚é… 16KB çš„å…³é”®åœ¨äºï¼Œåœ¨åŸç”Ÿåº“çš„é“¾æ¥é˜¶æ®µï¼Œå‘Šè¯‰é“¾æ¥å™¨ï¼ˆldï¼‰å°†æ‰€æœ‰ ELF ç¨‹åºæ®µçš„å¯¹é½å€¼è®¾ç½®ä¸º 16KBã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é“¾æ¥å™¨æ ‡å¿—ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">-Wl,-z,<span class="hljs-attr">max-page-size</span>=<span class="hljs-number">16384</span>
-Wl,-z,<span class="hljs-attr">common-page-size</span>=<span class="hljs-number">16384</span>
</code></pre>
<p>max-page-sizeæ˜¯é€‚é…16KB Page Sizeçš„å…³é”®ï¼Œå®ƒå¼ºåˆ¶é“¾æ¥å™¨å°† ELF æ–‡ä»¶ä¸­æ‰€æœ‰å¯åŠ è½½çš„ç¨‹åºæ®µï¼ˆProgram Segmentsï¼Œä¾‹å¦‚åŒ…å«ä»£ç çš„ .text æ®µæˆ–åŒ…å«æ•°æ®çš„ .data æ®µï¼‰çš„å¯¹é½è¦æ±‚ p_align è®¾ç½®ä¸º 16384 å­—èŠ‚ï¼ˆ16KBï¼‰ã€‚Android NDK r27~r23ç†è®ºä¸Šç”¨å®ƒå°±è¡Œã€‚<br/>
common-page-sizeç”¨äºè®¾ç½®é“¾æ¥å™¨åœ¨è¿›è¡Œå†…éƒ¨ä¼˜åŒ–å’Œç¡®å®šæ–‡ä»¶å¸ƒå±€æ—¶æ‰€ä½¿ç”¨çš„é€šç”¨é¡µå¤§å°ã€‚å®ƒå½±å“é“¾æ¥å™¨å¦‚ä½•ç»„ç»‡ä»£ç å’Œæ•°æ®ï¼Œä»¥ä¼˜åŒ–ç©ºé—´åˆ©ç”¨å’Œå†…å­˜æ˜ å°„ã€‚å®ƒå¯ä»¥è§£å†³é€‚é…16KB Page Sizeè¿‡ç¨‹ä¸­ï¼ˆå¯¹äºAndroid NDK r22 åŠæ›´ä½ç‰ˆæœ¬ï¼‰æ—§ç‰ˆ GNU ld å’Œ LLVM lld é“¾æ¥å™¨ä¸­çš„ bugã€‚<br/>
å‡ºäºç¨³å¦¥èµ·è§ï¼Œæˆ‘ä¸¤ä¸ªé“¾æ¥å™¨æ ‡å¿—éƒ½ä½¿ç”¨ã€‚</p>
<p>ä¾‹å¦‚åœ¨CMakeLists.txtè¿™æ ·ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">target_link_options(<span class="hljs-variable">${CMAKE_PROJECT_NAME}</span> PRIVATE <span class="hljs-string">"-Wl,-z,max-page-size=16384"</span>)
target_link_options(<span class="hljs-variable">${CMAKE_PROJECT_NAME}</span> PRIVATE <span class="hljs-string">"-Wl,-z,common-page-size=16384"</span>)     
</code></pre>
<h4 data-id="heading-6">é‡æ–°äº¤å‰ç¼–è¯‘soåº“</h4>
<p>ç¼–è¯‘ç¯å¢ƒï¼šVMware Workstation Proä¸­çš„ubuntuè™šæ‹Ÿæœº<br/>
NDKï¼šNDK r20<br/>
ä½¿ç”¨NDKäº¤å‰ç¼–è¯‘soåº“çš„æ—¶å€™åœ¨ç¼–è¯‘è„šæœ¬åŠ å…¥ä¸Šé¢ä¸¤ä¸ªé“¾æ¥å™¨æ ‡å¿—å‚æ•°ã€‚<br/>
ç¼–è¯‘x264è„šæœ¬å…³é”®éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">    <span class="hljs-comment"># ...</span>
    <span class="hljs-built_in">export</span> LDFLAGS=<span class="hljs-string">"-Wl,-z,max-page-size=16384 -Wl,-z,common-page-size=16384"</span>
	
	<span class="hljs-keyword">function</span> build
	{
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; build start &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>
	
	  ./configure \
	  --prefix=<span class="hljs-variable">$TARGET</span> \
	  --enable-static \
	  --enable-shared \
	  --enable-pic \
	  --host=aarch64-linux-android \
	  --disable-asm \
	  --disable-opencl \
	  --disable-cli \
	  --cross-prefix=<span class="hljs-variable">$TOOLCHAIN</span>/bin/aarch64-linux-android- \
	  --sysroot=<span class="hljs-variable">$TOOLCHAIN</span>/sysroot \
	
	make clean
	make
	make install
	
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"&gt;&gt;&gt;&gt;&gt;&gt; build done &lt;&lt;&lt;&lt;&lt;&lt;"</span>
	}
	
	build
</code></pre>
<p>ç¼–è¯‘LAMEè„šæœ¬å…³é”®éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">    <span class="hljs-comment"># ...</span>
LDFLAGS=<span class="hljs-string">"-Wl,-z,max-page-size=16384 -Wl,-z,common-page-size=16384"</span>
API=24

<span class="hljs-keyword">function</span> build_android_arm
{
<span class="hljs-built_in">echo</span> <span class="hljs-string">"build for android <span class="hljs-variable">$CPU</span>"</span>
./configure \
--host=<span class="hljs-variable">$HOST</span> \
--disable-static \
--enable-shared \
--disable-frontend \
--prefix=<span class="hljs-string">"<span class="hljs-variable">$TARGET</span>"</span> \
LDFLAGS=<span class="hljs-string">"<span class="hljs-variable">${LDFLAGS}</span>"</span> \
CPPFLAGS=<span class="hljs-string">"-fPIC"</span>

make clean
make -j8
make install

<span class="hljs-built_in">echo</span> <span class="hljs-string">"build for android <span class="hljs-variable">$CPU</span> completed"</span>
}
</code></pre>
<p>æœ€ç»ˆç¼–è¯‘FFmpegå…³é”®éƒ¨åˆ†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">DYNAMIC_LINKER_FLAGS=<span class="hljs-string">"-Wl,-z,max-page-size=16384 -Wl,-z,common-page-size=16384"</span>
<span class="hljs-comment"># ...</span>
<span class="hljs-keyword">function</span> build
{
  ./configure \
  --pkg-config=pkg-config \
  --pkg-config-flags=<span class="hljs-string">"--static"</span> \
  --prefix=<span class="hljs-variable">$OUTPUT</span> \
  --target-os=android \
  --<span class="hljs-built_in">arch</span>=arm64 \
  --cpu=armv8-a \
  --disable-x86asm \
  --disable-asm \
  --enable-neon \
  --enable-cross-compile \
  --enable-shared \
  --disable-static \
  --disable-doc \
  --disable-ffplay \
  --disable-ffprobe \
  --disable-symver \
  --disable-ffmpeg \
  --enable-pic \
  --sysroot=<span class="hljs-variable">$SYSROOT</span> \
  --cross-prefix=<span class="hljs-variable">$TOOLCHAIN</span>/bin/aarch64-linux-android- \
  --cross-prefix-clang=<span class="hljs-variable">$TOOLCHAIN</span>/bin/aarch64-linux-android<span class="hljs-variable">$API</span>- \
  --enable-encoder=aac \
  --enable-decoder=aac \
  --enable-gpl \
  --enable-encoder=libx264 \
  --enable-libx264 \
  --enable-encoder=libx265 \
  --enable-libx265 \
  --enable-libmp3lame \
  --extra-cflags=<span class="hljs-string">"-I<span class="hljs-variable">$X264_DIR</span>/include -I<span class="hljs-variable">$LAME_DIR</span>/include -I<span class="hljs-variable">$X265_DIR</span>/include"</span> \
  --extra-ldflags=<span class="hljs-string">"<span class="hljs-variable">$DYNAMIC_LINKER_FLAGS</span> -L<span class="hljs-variable">$X264_DIR</span>/lib -L<span class="hljs-variable">$LAME_DIR</span>/lib -L<span class="hljs-variable">$X265_DIR</span>/lib"</span> \
  --extra-cflags=<span class="hljs-string">"-fPIC"</span>

  make clean all
  <span class="hljs-comment"># è¿™é‡Œæ˜¯å®šä¹‰ç”¨å‡ ä¸ªCPUç¼–è¯‘</span>
  make -j12
  make install
}
</code></pre>
<p>å¯ä»¥çœ‹è§éƒ½åŠ ä¸Šäº†max-page-sizeå’Œcommon-page-sizeä¸¤ä¸ªé“¾æ¥å™¨æ ‡å¿—ï¼Œè¿™æ ·è®¾ç½®æœ€ç»ˆå¾—åˆ°çš„soåº“æ˜¯ç¬¦åˆ16KB Page Sizeè¦æ±‚çš„ã€‚</p>
<h4 data-id="heading-7">ä¿®æ”¹CMakeLists.txté‡æ–°æ„å»ºé¡¹ç›®</h4>
<p>å°†æ–°é²œå‡ºç‚‰çš„16KB soåº“æ”¾åˆ°Androidé¡¹ç›®çš„å¯¹åº”ç›®å½•ä¸‹ã€‚<br/>
æ³¨æ„åœ¨Androidé¡¹ç›®é‡Œé¢çš„CMakeLists.txtä¹Ÿéœ€è¦æ·»åŠ max-page-sizeå’Œcommon-page-sizeä¸¤ä¸ªé“¾æ¥å™¨æ ‡å¿—ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">target_link_libraries(

        <span class="hljs-comment"># æŒ‡å®šç›®æ ‡åº“ï¼Œnative-lib æ˜¯åœ¨ä¸Šé¢ add_library ä¸­é…ç½®çš„ç›®æ ‡åº“</span>
        aeroffmpeglib

        <span class="hljs-comment"># 4. è¿æ¥ FFmpeg ç›¸å…³çš„åº“</span>
        avutil
        swresample
        avcodec
        avfilter
        swscale
        avformat
        avdevice
        h264
        h265
        mp3lame
        ffmpeg

        -landroid
        OpenSLES
        -lEGL
        -lGLESv2
        <span class="hljs-comment"># Links the target library to the log library</span>
        <span class="hljs-comment"># included in the NDK.</span>
        ${log-lib}
        -Wl,-z,<span class="hljs-attr">max-page-size</span>=<span class="hljs-number">16384</span>
        -Wl,-z,<span class="hljs-attr">common-page-size</span>=<span class="hljs-number">16384</span>
)
</code></pre>
<p>ä¿®æ”¹CMakeLists.txtåé‡æ–°åŒæ­¥é…ç½®ä¿¡æ¯å¹¶æ„å»ºæ•´ä¸ªé¡¹ç›®ã€‚</p>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAudioAndVideoEditor" target="_blank" title="https://github.com/Ilovecat1949/AudioAndVideoEditor" ref="nofollow noopener noreferrer">AudioAndVideoEditor</a>å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIlovecat1949%2FAeroFFmpeg" target="_blank" title="https://github.com/Ilovecat1949/AeroFFmpeg" ref="nofollow noopener noreferrer">AeroFFmpeg</a>ç°åœ¨åº”è¯¥éƒ½æ”¯æŒAndroid 16KB Page Sizeã€‚<br/>
æˆ‘å¸Œæœ›è°·æ­Œä»¥åå°‘åšæ¶‰åŠ C/C++ åŸç”Ÿåº“çš„æ›´æ–°äº†ã€‚</p>
<h3 data-id="heading-9">å‚è€ƒ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Fguide%2Fpractices%2Fpage-sizes%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.google.cn/guide/practices/page-sizes?hl=zh-cn" ref="nofollow noopener noreferrer">è°·æ­Œæ”¯æŒ 16 KB çš„é¡µé¢å¤§å°æŒ‡å—</a><br/>
<a href="https://juejin.cn/post/7396306532671094793" target="_blank" title="https://juejin.cn/post/7396306532671094793">Android 15 ä¸Šé€‚é… 16K Page Size çš„å¡«å‘æ€è·¯ï¼Œä»¥ IJKPlayer ä¸ºä¾‹å­</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Re: 0x03. ä»é›¶å¼€å§‹çš„å…‰çº¿è¿½è¸ªå®ç°-å¤šçƒä½“ç€è‰²]]></title>    <link>https://juejin.cn/post/7575425466904576063</link>    <guid>https://juejin.cn/post/7575425466904576063</guid>    <pubDate>2025-11-23T07:18:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575425466904576063" data-draft-id="7575313772988071977" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Re: 0x03. ä»é›¶å¼€å§‹çš„å…‰çº¿è¿½è¸ªå®ç°-å¤šçƒä½“ç€è‰²"/> <meta itemprop="keywords" content="macOS,è®¡ç®—æœºå›¾å½¢å­¦"/> <meta itemprop="datePublished" content="2025-11-23T07:18:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å£•å£•"/> <meta itemprop="url" content="https://juejin.cn/user/3180232448155495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Re: 0x03. ä»é›¶å¼€å§‹çš„å…‰çº¿è¿½è¸ªå®ç°-å¤šçƒä½“ç€è‰²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3180232448155495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å£•å£•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:18:55.000Z" title="Sun Nov 23 2025 07:18:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="fancy">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç›®æ ‡</h2>
<p><a href="https://juejin.cn/post/7555462803492356150" target="_blank" title="https://juejin.cn/post/7555462803492356150">ä¸Šä¸€èŠ‚</a> å·²ç»å®ç°ä¸€ä¸ªçƒæ˜¾ç¤ºåœ¨çª—å£ä¸­å¤®ï¼Œè¿™èŠ‚çš„ç›®æ ‡æ˜¯æ˜¾ç¤ºå¤šä¸ªçƒã€‚</p>
<h2 data-id="heading-1">æœ¬èŠ‚æœ€ç»ˆæ•ˆæœ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8652a0cb44b4827a06246fa4a33ff84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aOV5aOV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764487135&amp;x-signature=98peJZl8uLs8OXbMQaVJRZ5Ub20%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">å…ˆæ˜¾ç¤ºä¸¤ä¸ªçƒ</h2>
<p>æˆ‘ä»¬å…ˆæ¥æƒ³åƒç°å®åœºæ™¯ï¼Œå‡è®¾ä½ æ¡Œå­æœ‰ä¸€ä¸ªæœ‰æ˜¾ç¤ºå™¨ï¼Œæ­¤æ—¶ä½ ä¸¾èµ·æ‰‹æœºå½•å±ï¼Œä½ èƒ½å¾ˆç›´è§‚è®¤è¯†åˆ°æ‰‹æœºç¦»ä½ æ›´è¿‘ï¼Œæ˜¾ç¤ºå™¨ç¦»ä½ æ›´è¿œï¼Œä½ çš„çœ¼ç›å°±æ˜¯é‚£ä¸ªæ‘„åƒæœºï¼Œå®ƒå‘å‡ºçš„å°„çº¿ï¼Œè‚¯å®šæ˜¯å…ˆåˆ°æ‰‹æœºï¼Œå†åˆ°æ˜¾ç¤ºå™¨ã€‚<br/>
ç°åœ¨æˆ‘ä»¬ä»£ç åšå¾—äº‹æƒ…å°±æ˜¯ï¼Œçƒå°±æ˜¯â€œæ‰‹æœºâ€ï¼ŒèƒŒæ™¯ï¼ˆå¤©ç©ºï¼‰å°±æ˜¯â€œæ˜¾ç¤ºå™¨â€ï¼Œé€šè¿‡ <code>intersect_sphere</code> æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºæŠŠâ€œæ˜¾ç¤ºå™¨â€æŒ¡ä½çš„â€œæ‰‹æœºâ€ã€‚</p>
<p>å›åˆ°ä¹‹å‰çš„ä»£ç ï¼Œåªæ˜¾ç¤ºä¸€ä¸ªçƒï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³å…‰çº¿è·Ÿçƒç›¸äº¤æ—¶ï¼Œå°±å‘Šè¯‰ fragment shader è¿™é‡Œè¦åº”è¯¥æ˜¾ç¤ºæŸä¸ªé¢œè‰²</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">intersect_sphere</span>(ray, sphere) &gt; <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0.76</span>, <span class="hljs-number">0.03</span>, <span class="hljs-number">1</span>);
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬è¦æ˜¾ç¤ºä¸¤ä¸ªçƒï¼Œæ‰€ä»¥å…ˆå¼„ä¸€ä¸ªæ•°ç»„ã€‚éœ€è¦æ³¨æ„åˆ°ï¼Œè¿™é‡Œç”¨ <code>constant</code> æ˜¯å› ä¸º MSLï¼ˆMetal Shading Languageï¼‰è§„å®š <strong>Program scope variable must reside in constant address space</strong>ï¼ˆç¨‹åºä½œç”¨åŸŸçš„å˜é‡ï¼Œå¿…é¡»æ”¾åœ¨å¸¸é‡åœ°å€ç©ºé—´ï¼‰ï¼Œæ€»ä¹‹å°±æ˜¯ä½ è¦æ˜¯å†™ä¸ªå‡½æ•°å¤–çš„å¸¸é‡ï¼Œé‚£å°±ç”¨ <code>constant</code> æŠŠå®ƒæ”¾åˆ°å¸¸é‡åœ°å€ç©ºé—´å»ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp">constant u32 OBJECT_COUNT = <span class="hljs-number">2</span>;

constant Sphere scene[OBJECT_COUNT] = {
  { .center = <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">-1.</span>), .radius = <span class="hljs-number">0.5</span> },
  { .center = <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0.</span>, <span class="hljs-number">-100.5</span>, <span class="hljs-number">-1.</span>), .radius = <span class="hljs-number">100.</span> },
};
</code></pre>
<p>å£°æ˜ç»“æŸåï¼Œåœ¨ fragment shader å‡½æ•°å†…å¾ªç¯åŒ¹é…å…‰çº¿ç›¸äº¤ã€‚<br/>
æˆ‘ä»¬æŠŠç¦»å’±ä»¬æœ€è¿‘çš„å€¼å®šä¹‰ä¸º <code>closest_t</code>ï¼Œåˆå§‹å€¼ç»™ä¸ª Metal å†…ç½®çš„å¸¸é‡ <code>FLT_MAX</code>ï¼Œå®ƒè¡¨ç¤º float çš„æœ€å¤§å€¼ï¼ˆå› ä¸ºæˆ‘ä»¬ç”¨äº† <code>float</code> ç±»å‹ï¼‰ï¼Œç„¶åå¾ªç¯é€šè¿‡è°ƒç”¨ <code>intersect_sphere</code> è®¡ç®—çš„å€¼ <code>t</code> å»æ›´æ–° <code>closest_t</code>ï¼ˆå› ä¸º <code>intersect_sphere</code> æ²¡åŒ¹é…åˆ°ä¼šè¿”å› <code>-1</code>ï¼Œæ‰€ä»¥å¾ˆæ˜¾ç„¶æˆ‘ä»¬è¦åˆ¤æ–­ <code>t &gt; 0.</code>ï¼ŒåŒæ—¶è¦å†åˆ¤æ–­ä¸‹è¿™ä¸ª <code>t</code> æ˜¯æ¯”å·²çŸ¥æœ€è¿‘çš„è¿˜è¦è¿‘çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¦æ»¡è¶³ <code>t &lt; closest_t</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">fragment vec4f <span class="hljs-title">fragmentFn</span><span class="hljs-params">(Vertex in [[stage_in]], constant Uniforms &amp;uniforms [[buffer(<span class="hljs-number">1</span>)]])</span> </span>{
  <span class="hljs-comment">// ...</span>
  let ray = Ray { origin, direction };
  var <span class="hljs-type">closest_t</span> = FLT_MAX;
  <span class="hljs-keyword">for</span> (u32 i = <span class="hljs-number">0</span>; i &lt; OBJECT_COUNT; ++i) {
    var t = <span class="hljs-built_in">intersect_sphere</span>(ray, scene[i]);
    <span class="hljs-keyword">if</span> (t &gt; <span class="hljs-number">0.</span> &amp;&amp; t &lt; <span class="hljs-type">closest_t</span>) {
      <span class="hljs-type">closest_t</span> = t;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-type">closest_t</span> &lt; FLT_MAX) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0.76</span>, <span class="hljs-number">0.03</span>, <span class="hljs-number">1</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-built_in">sky_color</span>(ray), <span class="hljs-number">1</span>);
}
</code></pre>
<p>äºæ˜¯å°±ä¼šæ˜¾ç¤º</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/416c454758084e83bcfa831977bd0651~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aOV5aOV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764487135&amp;x-signature=%2BdxdeG3aGOK4%2BZr8VYwNxgoWgVo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">æ”¹é¢œè‰²</h2>
<p>è¿™é‡Œå› ä¸ºæˆ‘ä»¬è®¾ç½®çš„é¢œè‰²æ˜¯ç›¸åŒï¼Œæ‰€ä»¥è¿åœ¨ä¸€å—æ ¹æœ¬åˆ†ä¸æ¸…å“ªè·Ÿå“ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®©ç¦»å¾—è¿‘å¾—æ›´äº®ï¼Œç¦»å¾—è¿œçš„æ›´æš—ï¼Œç»™åŸå…ˆè®¾ç½®çš„é¢œè‰²å†ä¹˜ä¸Šä¸€ä¸ªå€¼ï¼Œ<code>saturate</code> è¿™ä¸ªæ˜¯ MSL å†…ç½®çš„å‡½æ•°ï¼Œä½œç”¨æ˜¯æŠŠå°äº 0 çš„è½¬æˆ 0ï¼Œå¤§äº 1 çš„è½¬æˆ 1ï¼Œåœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> èŒƒå›´å†…çš„ä¸å˜ï¼Œç­‰äºè®²ï¼Œå¤§çš„å°±ä¹˜å¤šä¸€ç‚¹ï¼Œå°çš„å°±ä¹˜å°‘ä¸€ç‚¹ï¼Œç¬¦åˆè¿‘å¾—æ›´äº®ï¼Œè¿œå¾—æ›´æš—çš„è¦æ±‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">fragment vec4f <span class="hljs-title">fragmentFn</span><span class="hljs-params">(Vertex in [[stage_in]], constant Uniforms &amp;uniforms [[buffer(<span class="hljs-number">1</span>)]])</span> </span>{
  <span class="hljs-comment">// ...</span>
  let ray = Ray { origin, direction };
  var <span class="hljs-type">closest_t</span> = FLT_MAX;
  <span class="hljs-keyword">for</span> (u32 i = <span class="hljs-number">0</span>; i &lt; OBJECT_COUNT; ++i) {
    var t = <span class="hljs-built_in">intersect_sphere</span>(ray, scene[i]);
    <span class="hljs-keyword">if</span> (t &gt; <span class="hljs-number">0.</span> &amp;&amp; t &lt; <span class="hljs-type">closest_t</span>) {
      <span class="hljs-type">closest_t</span> = t;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-type">closest_t</span> &lt; FLT_MAX) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0.76</span>, <span class="hljs-number">0.03</span>, <span class="hljs-number">1</span>) * <span class="hljs-built_in">saturate</span>(<span class="hljs-number">1.</span> - <span class="hljs-type">closest_t</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-built_in">sky_color</span>(ray), <span class="hljs-number">1</span>);
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬èƒ½çœ‹åˆ°è¿™ä¸ªæ•ˆæœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a4ba77a46064f29a8b08f0592e42352~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aOV5aOV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764487135&amp;x-signature=7jkvQsTSAYWCaWJq5mZyBFCZags%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">å®ç°ç›®æ ‡æ•ˆæœ</h2>
<p>å…¶å®åˆ°è¿™ä¸€æ­¥ï¼Œåªæ˜¯æ¢ä¸ªé¢œè‰²ï¼Œä¸ºäº†å®ç°ç›®æ ‡æ•ˆæœï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ <code>closest_t</code> ä½œä¸ºåŸºç¡€å€¼ï¼Œåœ¨å®ƒçš„åŸºç¡€ä¸Šè½¬æˆé¢œè‰²å‘é‡</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">if</span> (<span class="hljs-type">closest_t</span> &lt; FLT_MAX) {
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-built_in">saturate</span>(<span class="hljs-type">closest_t</span>) * <span class="hljs-number">0.5</span>);
}
</code></pre>
<p>è¿™æ ·å°±èƒ½å®ç°æœ€ç»ˆæ•ˆæœ</p>
<hr/>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ä»£ç </p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;metal_stdlib&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> let const auto</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> var auto</span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> metal;

<span class="hljs-keyword">using</span> vec2f = float2;
<span class="hljs-keyword">using</span> vec3f = float3;
<span class="hljs-keyword">using</span> vec4f = float4;

<span class="hljs-keyword">using</span> u8 = uchar;
<span class="hljs-keyword">using</span> i8 = <span class="hljs-type">char</span>;
<span class="hljs-keyword">using</span> u16 = ushort;
<span class="hljs-keyword">using</span> i16 = <span class="hljs-type">short</span>;
<span class="hljs-keyword">using</span> i32 = <span class="hljs-type">int</span>;
<span class="hljs-keyword">using</span> u32 = uint;
<span class="hljs-keyword">using</span> f16 = half;
<span class="hljs-keyword">using</span> f32 = <span class="hljs-type">float</span>;
<span class="hljs-keyword">using</span> usize = <span class="hljs-type">size_t</span>;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">VertexIn</span> {
  vec2f position;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Vertex</span> {
  vec4f position [[position]];
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Uniforms</span> {
  u32 width;
  u32 height;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Ray</span> {
  vec3f origin;
  vec3f direction;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Sphere</span> {
  vec3f center;
  f32 radius;
};

constant u32 OBJECT_COUNT = <span class="hljs-number">2</span>;
constant Sphere scene[OBJECT_COUNT] = {
  { .center = <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">-1.</span>), .radius = <span class="hljs-number">0.5</span> },
  { .center = <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0.</span>, <span class="hljs-number">-100.5</span>, <span class="hljs-number">-1.</span>), .radius = <span class="hljs-number">100.</span> },
};

<span class="hljs-function">f32 <span class="hljs-title">intersect_sphere</span><span class="hljs-params">(<span class="hljs-type">const</span> Ray ray, <span class="hljs-type">const</span> Sphere sphere)</span> </span>{
  let v = ray.origin - sphere.center;
  let a = <span class="hljs-built_in">dot</span>(ray.direction, ray.direction);
  let b = <span class="hljs-built_in">dot</span>(v, ray.direction);
  let c = <span class="hljs-built_in">dot</span>(v, v) - sphere.radius * sphere.radius;
  let d = b * b - a * c;
  <span class="hljs-keyword">if</span> (d &lt; <span class="hljs-number">0.</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1.</span>;
  }
  let sqrt_d = <span class="hljs-built_in">sqrt</span>(d);
  let recip_a = <span class="hljs-number">1.</span> / a;
  let mb = -b;
  let t = (mb - sqrt_d) * recip_a;
  <span class="hljs-keyword">if</span> (t &gt; <span class="hljs-number">0.</span>) {
    <span class="hljs-keyword">return</span> t;
  }
  <span class="hljs-keyword">return</span> (mb + sqrt_d) * recip_a;
}

<span class="hljs-function">vec3f <span class="hljs-title">sky_color</span><span class="hljs-params">(Ray ray)</span> </span>{
  let a = <span class="hljs-number">0.5</span> * (<span class="hljs-built_in">normalize</span>(ray.direction).y + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> - a) * <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">1</span>) + a * <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.7</span>, <span class="hljs-number">1</span>);
}

<span class="hljs-function">vertex Vertex <span class="hljs-title">vertexFn</span><span class="hljs-params">(constant VertexIn *vertices [[buffer(<span class="hljs-number">0</span>)]], uint vid [[vertex_id]])</span> </span>{
  <span class="hljs-keyword">return</span> Vertex { <span class="hljs-built_in">vec4f</span>(vertices[vid].position, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>) };
}

<span class="hljs-function">fragment vec4f <span class="hljs-title">fragmentFn</span><span class="hljs-params">(Vertex in [[stage_in]], constant Uniforms &amp;uniforms [[buffer(<span class="hljs-number">1</span>)]])</span> </span>{
  let origin = <span class="hljs-built_in">vec3f</span>(<span class="hljs-number">0</span>);
  let focus_distance = <span class="hljs-number">1.0</span>;
  let aspect_ratio = <span class="hljs-built_in">f32</span>(uniforms.width) / <span class="hljs-built_in">f32</span>(uniforms.height);
  var uv = in.position.xy / <span class="hljs-built_in">vec2f</span>(<span class="hljs-built_in">f32</span>(uniforms.width - <span class="hljs-number">1</span>), <span class="hljs-built_in">f32</span>(uniforms.height - <span class="hljs-number">1</span>));
  uv = (<span class="hljs-number">2</span> * uv - <span class="hljs-built_in">vec2f</span>(<span class="hljs-number">1</span>)) * <span class="hljs-built_in">vec2f</span>(aspect_ratio, <span class="hljs-number">-1</span>);
  let direction = <span class="hljs-built_in">vec3f</span>(uv, -focus_distance);
  let ray = Ray { origin, direction };
  var <span class="hljs-type">closest_t</span> = FLT_MAX;
  <span class="hljs-keyword">for</span> (u32 i = <span class="hljs-number">0</span>; i &lt; OBJECT_COUNT; ++i) {
    var t = <span class="hljs-built_in">intersect_sphere</span>(ray, scene[i]);
    <span class="hljs-keyword">if</span> (t &gt; <span class="hljs-number">0.</span> &amp;&amp; t &lt; <span class="hljs-type">closest_t</span>) {
      <span class="hljs-type">closest_t</span> = t;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-type">closest_t</span> &lt; FLT_MAX) {
<span class="hljs-comment">//    return vec4f(1, 0.76, 0.03, 1);</span>
<span class="hljs-comment">//    return vec4f(1, 0.76, 0.03, 1) * saturate(1. - closest_t);</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-built_in">saturate</span>(<span class="hljs-type">closest_t</span>) * <span class="hljs-number">0.5</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec4f</span>(<span class="hljs-built_in">sky_color</span>(ray), <span class="hljs-number">1</span>);
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ llm + SQLite å®ç°è‡ªç„¶è¯­è¨€åˆ° SQL çš„æ™ºèƒ½è½¬æ¢ï¼šä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹]]></title>    <link>https://juejin.cn/post/7575102209605926938</link>    <guid>https://juejin.cn/post/7575102209605926938</guid>    <pubDate>2025-11-23T06:33:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575102209605926938" data-draft-id="7575133880436097075" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ llm + SQLite å®ç°è‡ªç„¶è¯­è¨€åˆ° SQL çš„æ™ºèƒ½è½¬æ¢ï¼šä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹"/> <meta itemprop="keywords" content="LLM,SQLite,Agent"/> <meta itemprop="datePublished" content="2025-11-23T06:33:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çƒŸè¢…"/> <meta itemprop="url" content="https://juejin.cn/user/1845419006243504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ llm + SQLite å®ç°è‡ªç„¶è¯­è¨€åˆ° SQL çš„æ™ºèƒ½è½¬æ¢ï¼šä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1845419006243504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çƒŸè¢…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T06:33:20.000Z" title="Sun Nov 23 2025 06:33:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ã€‚ä½†å¯¹éæŠ€æœ¯äººå‘˜æ¥è¯´ï¼Œå†™ SQL æŸ¥è¯¢è¯­å¥å¯èƒ½æ˜¯ä¸ªâ€œå™©æ¢¦â€ã€‚è€Œéšç€å¤§æ¨¡å‹çš„å…´èµ·ï¼Œ<strong>å°†è‡ªç„¶è¯­è¨€ç›´æ¥è½¬åŒ–ä¸º SQL æŸ¥è¯¢</strong>å·²æˆä¸ºç°å®ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°†ç»“åˆ <strong>DeepSeek Reasoner æ¨¡å‹</strong> å’Œ <strong>SQLite æ•°æ®åº“</strong>ï¼Œå±•ç¤ºå¦‚ä½•é€šè¿‡ä¸€æ®µç®€å•çš„ Python ä»£ç ï¼Œå®ç°â€œ<strong>ä½ è¯´ä¸­æ–‡ï¼Œæˆ‘å‡º SQL</strong>â€çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ§© é¡¹ç›®ç›®æ ‡</h2>
<p>ç»™å®šä¸€ä¸ªç®€å•çš„å‘˜å·¥ä¿¡æ¯è¡¨ï¼Œç”¨æˆ·è¾“å…¥è‡ªç„¶è¯­è¨€é—®é¢˜ï¼ˆå¦‚ï¼šâ€œå¼€å‘éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘ï¼Ÿâ€ï¼‰ï¼Œç¨‹åºè‡ªåŠ¨è§£æå¹¶ç”Ÿæˆå¯¹åº”çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ”§ ç¯å¢ƒå‡†å¤‡</h2>
<p>æˆ‘ä»¬ä½¿ç”¨è½»é‡çº§çš„ SQLite æ•°æ®åº“ï¼Œå¹¶æ¥å…¥ DeepSeek çš„ API æ¥å®Œæˆè‡ªç„¶è¯­è¨€ç†è§£ä¸ SQL ç”Ÿæˆä»»åŠ¡ã€‚</p>
<h3 data-id="heading-2">1. åˆ›å»ºæ•°æ®åº“è¡¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-comment"># æ‰“å¼€é“¾æ¥</span>
conn = sqlite3.connect(<span class="hljs-string">"test.db"</span>)
cursor = conn.cursor()

cursor.execute(<span class="hljs-string">"""
CREATE TABLE IF NOT EXISTS employees(
    id INTEGER PRIMARY KEY,
    name TEXT,
    department TEXT,
    salary INTEGER
)
"""</span>)
</code></pre>
<blockquote>
<p>âœ… è¿™ä¸€æ­¥åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>employees</code> çš„è¡¨ï¼ŒåŒ…å«å‘˜å·¥ç¼–å·ã€å§“åã€éƒ¨é—¨å’Œå·¥èµ„å­—æ®µã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">2. æ’å…¥æµ‹è¯•æ•°æ®</h3>
<pre><code class="hljs language-scss" lang="scss">sample_data = <span class="hljs-selector-attr">[    (6, <span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"å¼€å‘éƒ¨"</span>, 32000),    (7, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"é”€å”®éƒ¨"</span>, 20000),    (8, <span class="hljs-string">"è€å…­"</span>, <span class="hljs-string">"å¼€å‘éƒ¨"</span>, 33000),    (9, <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"é”€å”®éƒ¨"</span>, 15000)]</span>

<span class="hljs-attribute">cursor</span><span class="hljs-selector-class">.executemany</span>("INSERT INTO employees VALUES(?,?,?,?)", sample_data)
conn<span class="hljs-selector-class">.commit</span>()
</code></pre>
<blockquote>
<p>ğŸ’¡ æ’å…¥äº†4æ¡æµ‹è¯•æ•°æ®ï¼Œæ¶µç›–ä¸¤ä¸ªéƒ¨é—¨ï¼šå¼€å‘éƒ¨å’Œé”€å”®éƒ¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">3. è·å–æ•°æ®åº“ Schema</h3>
<p>ä¸ºäº†è®© LLM ç†è§£è¡¨ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¡¨çš„ schema æä¾›ç»™æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é€šè¿‡ table_info æ‹¿åˆ° employees è¡¨çš„æè¿°</span>
schema = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
schema_str = <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{col[<span class="hljs-number">1</span>]}</span> <span class="hljs-subst">{col[<span class="hljs-number">2</span>]}</span>"</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> schema]) + <span class="hljs-string">"\n)"</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®åº“Schema:"</span>)
<span class="hljs-built_in">print</span>(schema_str)
</code></pre>
<p>è¾“å‡ºç»“æœç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> EMPLOYEES (
id <span class="hljs-type">INTEGER</span>
name TEXT
department TEXT
salary <span class="hljs-type">INTEGER</span>
)
</code></pre>
<blockquote>
<p>ğŸ“Œ è¿™ä¸ª schema å°†ä½œä¸ºä¸Šä¸‹æ–‡ä¼ ç»™ DeepSeek æ¨¡å‹ï¼Œå¸®åŠ©å®ƒç†è§£å­—æ®µå«ä¹‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">4. è°ƒç”¨ DeepSeek ç”Ÿæˆ SQL</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬è°ƒç”¨ DeepSeek çš„ APIï¼Œè®©æ¨¡å‹æ ¹æ®è‡ªç„¶è¯­è¨€ç”Ÿæˆ SQL æŸ¥è¯¢ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from openai import OpenAI

<span class="hljs-attr">client</span> = OpenAI(
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">''</span>,//è¿™é‡Œå†™å…¥è‡ªå·±çš„apikey
    <span class="hljs-attr">base_url</span>=<span class="hljs-string">'https://api.deepseek.com/v1'</span>
)

def ask_deepseek(query, schema):
    <span class="hljs-attr">prompt</span> = f<span class="hljs-string">"""è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schema:
{schema}
æ ¹æ®è¿™ä¸ªSchemaï¼Œä½ èƒ½è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢æ¥å›ç­”ä»¥ä¸‹é—®é¢˜å—ï¼Ÿ
åªè¾“å‡ºSQLæŸ¥è¯¢ï¼Œä¸è¦è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä¹Ÿä¸è¦å¸¦ä»»ä½•æ ¼å¼ã€‚
é—®é¢˜:{query}
"""</span>
    <span class="hljs-attr">response</span> = client.chat_completions.create(
        <span class="hljs-attr">model</span>=<span class="hljs-string">"deepseek-reasoner"</span>,
        <span class="hljs-attr">max_tokens</span>=<span class="hljs-number">2048</span>,
        <span class="hljs-attr">messages</span>=[
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
        ]
    )
    return response.choices<span class="hljs-section">[0]</span>.message.content

<span class="hljs-comment"># ç¤ºä¾‹æé—®</span>
<span class="hljs-attr">question</span> = <span class="hljs-string">"å¼€å‘éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘?"</span>
<span class="hljs-attr">sql</span> = ask_deepseek(question, schema_str)
print("ç”Ÿæˆçš„sqlæŸ¥è¯¢ï¼š")
print(sql)
</code></pre>
<hr/>
<h2 data-id="heading-6">âœ… é¢„æœŸè¾“å‡º</h2>
<p>è¿è¡Œä¸Šè¿°ä»£ç åï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°å¦‚ä¸‹ SQL æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">SELECT name, salary FROM employees WHERE <span class="hljs-attr">department</span> = <span class="hljs-string">'å¼€å‘éƒ¨'</span><span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>ğŸ‰ å®Œç¾ï¼æ¨¡å‹æˆåŠŸç†è§£äº†â€œå¼€å‘éƒ¨é—¨â€å¯¹åº”çš„æ˜¯ <code>department = 'å¼€å‘éƒ¨'</code>ï¼Œå¹¶è¿”å›äº†æ­£ç¡®çš„å­—æ®µé€‰æ‹©ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸš€ æŠ€æœ¯äº®ç‚¹è§£æ</h2>

























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è‡ªç„¶è¯­è¨€ â†’ SQL</strong></td><td>åˆ©ç”¨ LLM çš„ç†è§£èƒ½åŠ›ï¼Œæ— éœ€äººå·¥ç¼–å†™å¤æ‚æŸ¥è¯¢</td></tr><tr><td><strong>Schema ä¸Šä¸‹æ–‡æ³¨å…¥</strong></td><td>è®©æ¨¡å‹çŸ¥é“è¡¨ç»“æ„ï¼Œé¿å…è¯¯è¯»å­—æ®µå</td></tr><tr><td><strong>è½»é‡çº§éƒ¨ç½²</strong></td><td>ä½¿ç”¨ SQLiteï¼Œæ— éœ€å¤æ‚æ•°æ®åº“ç¯å¢ƒ</td></tr><tr><td><strong>å¯æ‰©å±•æ€§å¼º</strong></td><td>å¯è½»æ¾æ¥å…¥å…¶ä»–æ•°æ®åº“æˆ–å‰ç«¯ç•Œé¢</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">ğŸ› ï¸ åº”ç”¨åœºæ™¯å»ºè®®</h2>
<ul>
<li><strong>ä½ä»£ç å¹³å°</strong>ï¼šè®©ç”¨æˆ·ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ•°æ®</li>
<li><strong>å†…éƒ¨æŠ¥è¡¨å·¥å…·</strong>ï¼šéæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½å¿«é€Ÿè·å–æ•°æ®</li>
<li><strong>æ•™å­¦è¾…åŠ©</strong>ï¼šå¸®åŠ©å­¦ç”Ÿç†è§£ SQL é€»è¾‘</li>
<li><strong>è‡ªåŠ¨åŒ–è„šæœ¬</strong>ï¼šé›†æˆåˆ°å·¥ä½œæµä¸­ï¼Œæå‡æ•ˆç‡</li>
</ul>
<hr/>
<h2 data-id="heading-9">ğŸ“Œ æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ¬¡å®è·µï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ <strong>llm</strong>ï¼Œç»“åˆ <strong>SQLite</strong> æ•°æ®åº“ï¼Œæ„å»ºä¸€ä¸ªç®€å•å´å¼ºå¤§çš„â€œè‡ªç„¶è¯­è¨€è½¬ SQLâ€ç³»ç»Ÿã€‚æ•´ä¸ªæµç¨‹æ¸…æ™°ã€æ˜“äºå¤ç°ï¼Œé€‚åˆåˆå­¦è€…ä¸Šæ‰‹ï¼Œä¹Ÿå…·å¤‡å®é™…åº”ç”¨ä»·å€¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Foundation Models Framework]]></title>    <link>https://juejin.cn/post/7575106644499169314</link>    <guid>https://juejin.cn/post/7575106644499169314</guid>    <pubDate>2025-11-23T07:53:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575106644499169314" data-draft-id="7575106644499136546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Foundation Models Framework"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-11-23T07:53:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="alloc"/> <meta itemprop="url" content="https://juejin.cn/user/923245496765566"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Foundation Models Framework
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/923245496765566/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    alloc
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:53:10.000Z" title="Sun Nov 23 2025 07:53:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»37åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ¯ ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€åœºå’ŒFoundation Modelsç®€ä»‹</h2>
<h3 data-id="heading-1">1.1 ä¸ºä»€ä¹ˆéœ€è¦Foundation Modelsï¼Ÿ</h3>
<h4 data-id="heading-2">ä¸šåŠ¡ç—›ç‚¹ vs è§£å†³æ–¹æ¡ˆ</h4>
<p>åœ¨ç›¸å†Œä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB  
Â  Â  subgraph "ä¼ ç»Ÿæ–¹æ¡ˆç—›ç‚¹"  
Â  Â  Â  Â  P1[æœç´¢ä½“éªŒå·®&lt;br/&gt;éš¾ä»¥ç”¨å…³é”®è¯æ‰¾åˆ°ç…§ç‰‡]  
Â  Â  Â  Â  P2[åˆ†ç±»å·¥ä½œç¹ç&lt;br/&gt;æ‰‹åŠ¨æ•´ç†è€—æ—¶è€—åŠ›]  
Â  Â  Â  Â  P3[å†…å®¹ç†è§£ä¸è¶³&lt;br/&gt;æ— æ³•è‡ªåŠ¨ç†è§£ç…§ç‰‡]  
Â  Â  Â  Â  P4[ä¸ªæ€§åŒ–æ¨èç¼ºå¤±&lt;br/&gt;éš¾ä»¥æ¨èç›¸å…³ç…§ç‰‡]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "Foundation Modelsè§£å†³æ–¹æ¡ˆ"  
Â  Â  Â  Â  S1[è‡ªç„¶è¯­è¨€æœç´¢&lt;br/&gt;å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡]  
Â  Â  Â  Â  S2[æ™ºèƒ½åˆ†ç±»&lt;br/&gt;è‡ªåŠ¨ç»„ç»‡ç…§ç‰‡]  
Â  Â  Â  Â  S3[å†…å®¹ç†è§£&lt;br/&gt;è‡ªåŠ¨åˆ†æç…§ç‰‡å†…å®¹]  
Â  Â  Â  Â  S4[æ™ºèƒ½æ¨è&lt;br/&gt;ç›¸ä¼¼ç…§ç‰‡æ¨è]  
Â  Â  end  
Â  Â Â   
Â  Â  P1 --&gt; S1  
Â  Â  P2 --&gt; S2  
Â  Â  P3 --&gt; S3  
Â  Â  P4 --&gt; S4  
Â  Â Â   
Â  Â  style P1 fill:#FF3B30,color:#fff  
Â  Â  style P2 fill:#FF3B30,color:#fff  
Â  Â  style P3 fill:#FF3B30,color:#fff  
Â  Â  style P4 fill:#FF3B30,color:#fff  
Â  Â Â   
Â  Â  style S1 fill:#34C759,color:#fff  
Â  Â  style S2 fill:#34C759,color:#fff  
Â  Â  style S3 fill:#34C759,color:#fff  
Â  Â  style S4 fill:#34C759,color:#fff  
</code></pre>
<h3 data-id="heading-3">1.2 ä»€ä¹ˆæ˜¯Foundation Models Framework</h3>
<h4 data-id="heading-4">æ ¸å¿ƒå®šä¹‰</h4>
<ul>
<li><strong>å®˜æ–¹å®šä¹‰</strong>: Appleåœ¨iOS 18/macOS 15ä¸­å¼•å…¥çš„åŸç”ŸAIæ¡†æ¶ï¼Œæ˜¯Apple Intelligenceçš„æ ¸å¿ƒç»„ä»¶</li>
<li><strong>æŠ€æœ¯å®šä½</strong>: è®©å¼€å‘è€…è½»æ¾é›†æˆApple Intelligenceçš„å¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›åˆ°åº”ç”¨ä¸­</li>
<li><strong>è®¾è®¡ç†å¿µ</strong>:Â <br/>
- éšç§ä¼˜å…ˆï¼šæ‰€æœ‰å¤„ç†éƒ½åœ¨è®¾å¤‡æœ¬åœ°å®Œæˆ<br/>
- å¼€å‘è€…å‹å¥½ï¼šç®€æ´çš„APIï¼Œæ˜“äºé›†æˆ<br/>
- ç³»ç»Ÿé›†æˆï¼šä¸iOS/macOSæ·±åº¦é›†æˆ</li>
</ul>
<h4 data-id="heading-5">Foundation Models vs ä¼ ç»ŸAIæ¨¡å‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB  
Â  Â  subgraph "ä¼ ç»ŸAIæ–¹æ¡ˆ"  
Â  Â  Â  Â  T1[äº‘ç«¯æœåŠ¡&lt;br/&gt;éœ€è¦ç½‘ç»œè¿æ¥]  
Â  Â  Â  Â  T2[æ•°æ®ä¸Šä¼ &lt;br/&gt;éœ€è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨]  
Â  Â  Â  Â  T3[é«˜å»¶è¿Ÿ&lt;br/&gt;ç½‘ç»œå¾€è¿”å»¶è¿Ÿ]  
Â  Â  Â  Â  T4[æˆæœ¬è®¡è´¹&lt;br/&gt;æŒ‰ä½¿ç”¨é‡ä»˜è´¹]  
Â  Â  Â  Â  T5[APIå¯†é’¥&lt;br/&gt;éœ€è¦å¯†é’¥ç®¡ç†]  
Â  Â  Â  Â  T6[éšç§é£é™©&lt;br/&gt;æ•°æ®å¯èƒ½æ³„éœ²]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "Foundation Modelsæ–¹æ¡ˆ"  
Â  Â  Â  Â  F1[è®¾å¤‡ç«¯è¿è¡Œ&lt;br/&gt;æ— éœ€ç½‘ç»œ]  
Â  Â  Â  Â  F2[æ•°æ®æœ¬åœ°åŒ–&lt;br/&gt;ä¸å‡ºè®¾å¤‡]  
Â  Â  Â  Â  F3[ä½å»¶è¿Ÿ&lt;br/&gt;æœ¬åœ°å¤„ç†]  
Â  Â  Â  Â  F4[é›¶æˆæœ¬&lt;br/&gt;Appleæä¾›]  
Â  Â  Â  Â  F5[æ— éœ€å¯†é’¥&lt;br/&gt;ç³»ç»Ÿé›†æˆ]  
Â  Â  Â  Â  F6[éšç§ä¿æŠ¤&lt;br/&gt;å®Œå…¨æœ¬åœ°å¤„ç†]  
Â  Â  end  
Â  Â Â   
Â  Â  T1 -.å¯¹æ¯”.-&gt; F1  
Â  Â  T2 -.å¯¹æ¯”.-&gt; F2  
Â  Â  T3 -.å¯¹æ¯”.-&gt; F3  
Â  Â  T4 -.å¯¹æ¯”.-&gt; F4  
Â  Â  T5 -.å¯¹æ¯”.-&gt; F5  
Â  Â  T6 -.å¯¹æ¯”.-&gt; F6  
Â  Â Â   
Â  Â  style T1 fill:#FF3B30,color:#fff  
Â  Â  style T2 fill:#FF3B30,color:#fff  
Â  Â  style T3 fill:#FF3B30,color:#fff  
Â  Â  style T4 fill:#FF3B30,color:#fff  
Â  Â  style T5 fill:#FF3B30,color:#fff  
Â  Â  style T6 fill:#FF3B30,color:#fff  
Â  Â Â   
Â  Â  style F1 fill:#34C759,color:#fff  
Â  Â  style F2 fill:#34C759,color:#fff  
Â  Â  style F3 fill:#34C759,color:#fff  
Â  Â  style F4 fill:#34C759,color:#fff  
Â  Â  style F5 fill:#34C759,color:#fff  
Â  Â  style F6 fill:#34C759,color:#fff  
</code></pre>
<p><strong>å¯¹æ¯”è¡¨æ ¼</strong>:</p>













































<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»ŸAIæ¨¡å‹</th><th>Foundation Models</th></tr></thead><tbody><tr><td>éƒ¨ç½²æ–¹å¼</td><td>äº‘ç«¯æœåŠ¡</td><td>è®¾å¤‡ç«¯è¿è¡Œ</td></tr><tr><td>ç½‘ç»œè¦æ±‚</td><td>éœ€è¦ç½‘ç»œè¿æ¥</td><td>æ— éœ€ç½‘ç»œ</td></tr><tr><td>æ•°æ®å¤„ç†</td><td>æ•°æ®ä¸Šä¼ åˆ°æœåŠ¡å™¨</td><td>æ•°æ®å®Œå…¨æœ¬åœ°åŒ–</td></tr><tr><td>å»¶è¿Ÿ</td><td>è¾ƒé«˜ï¼ˆç½‘ç»œå¾€è¿”ï¼‰</td><td>ä½ï¼ˆæœ¬åœ°å¤„ç†ï¼‰</td></tr><tr><td>æˆæœ¬</td><td>æŒ‰ä½¿ç”¨é‡è®¡è´¹</td><td>é›¶æˆæœ¬ï¼ˆAppleæä¾›ï¼‰</td></tr><tr><td>APIå¯†é’¥</td><td>éœ€è¦ç®¡ç†</td><td>æ— éœ€APIå¯†é’¥</td></tr><tr><td>éšç§</td><td>æ•°æ®å¯èƒ½æ³„éœ²</td><td>å®Œå…¨éšç§ä¿æŠ¤</td></tr></tbody></table>
<h4 data-id="heading-6">Apple Intelligence æ¶æ„æ¦‚è§ˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB  
Â  Â  subgraph "åº”ç”¨å±‚"  
Â  Â  Â  Â  App1[iOS App]  
Â  Â  Â  Â  App2[macOS App]  
Â  Â  Â  Â  App3[iPadOS App]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "Foundation Models Framework"  
Â  Â  Â  Â  FM1[LanguageModelSession&lt;br/&gt;ä¼šè¯ç®¡ç†]  
Â  Â  Â  Â  FM2[Tool Protocol&lt;br/&gt;å·¥å…·åè®®]  
Â  Â  Â  Â  FM3[Structured Generation&lt;br/&gt;ç»“æ„åŒ–ç”Ÿæˆ]  
Â  Â  Â  Â  FM4[SystemLanguageModel&lt;br/&gt;ç³»ç»Ÿè¯­è¨€æ¨¡å‹]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "åº•å±‚æ‰§è¡Œå±‚"  
Â  Â  Â  Â  CoreML[Core ML&lt;br/&gt;æ¨¡å‹æ¨ç†]  
Â  Â  Â  Â  NeuralEngine[Neural Engine&lt;br/&gt;ç¡¬ä»¶åŠ é€Ÿ]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "éšç§å’Œå®‰å…¨å±‚"  
Â  Â  Â  Â  Privacy[éšç§ä¿æŠ¤&lt;br/&gt;è®¾å¤‡ç«¯å¤„ç†]  
Â  Â  Â  Â  Security[æ•°æ®åŠ å¯†&lt;br/&gt;å®‰å…¨å­˜å‚¨]  
Â  Â  end  
Â  Â Â   
Â  Â  App1 --&gt; FM1  
Â  Â  App2 --&gt; FM1  
Â  Â  App3 --&gt; FM1  
Â  Â Â   
Â  Â  FM1 --&gt; FM2  
Â  Â  FM1 --&gt; FM3  
Â  Â  FM1 --&gt; FM4  
Â  Â Â   
Â  Â  FM4 --&gt; CoreML  
Â  Â  CoreML --&gt; NeuralEngine  
Â  Â Â   
Â  Â  NeuralEngine --&gt; Privacy  
Â  Â  Privacy --&gt; Security  
Â  Â Â   
Â  Â  style FM1 fill:#007AFF,color:#fff  
Â  Â  style FM2 fill:#007AFF,color:#fff  
Â  Â  style FM3 fill:#007AFF,color:#fff  
Â  Â  style FM4 fill:#007AFF,color:#fff  
Â  Â  style CoreML fill:#34C759,color:#fff  
Â  Â  style NeuralEngine fill:#34C759,color:#fff  
Â  Â  style Privacy fill:#FF9500,color:#fff  
Â  Â  style Security fill:#FF9500,color:#fff  
</code></pre>
<p><strong>å…³é”®ç»„ä»¶è¯´æ˜</strong>:</p>
<ol>
<li><strong>LanguageModelSession</strong>: ä¼šè¯ç®¡ç†ï¼Œç»´æŠ¤å¯¹è¯ä¸Šä¸‹æ–‡</li>
<li><strong>SystemLanguageModel</strong>: ç³»ç»Ÿæä¾›çš„è¯­è¨€æ¨¡å‹</li>
<li><strong>Tool Protocol</strong>: æ‰©å±•æ¨¡å‹èƒ½åŠ›ï¼Œè¿æ¥ç³»ç»ŸåŠŸèƒ½</li>
<li><strong>Structured Generation</strong>: ç±»å‹å®‰å…¨çš„æ•°æ®ç”Ÿæˆ</li>
</ol>
<h4 data-id="heading-7">æ ¸å¿ƒèƒ½åŠ›æ¦‚è§ˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((Foundation Models&lt;br/&gt;æ ¸å¿ƒèƒ½åŠ›))  
Â  Â  è‡ªç„¶è¯­è¨€ç†è§£  
Â  Â  Â  ç†è§£ç”¨æˆ·æŸ¥è¯¢  
Â  Â  Â  ç”Ÿæˆæµç•…å“åº”  
Â  Â  Â  å¤šè½®å¯¹è¯  
Â  Â  Â  ä¸Šä¸‹æ–‡ç»´æŠ¤  
Â  Â  ç»“æ„åŒ–æ•°æ®ç”Ÿæˆ  
Â  Â  Â  @Generableæ ‡è®°  
Â  Â  Â  ç±»å‹å®‰å…¨  
Â  Â  Â  è‡ªåŠ¨è§£æ  
Â  Â  Â  æ˜“äºé›†æˆ  
Â  Â  å·¥å…·è°ƒç”¨  
Â  Â  Â  Toolåè®®  
Â  Â  Â  ç³»ç»ŸåŠŸèƒ½è¿æ¥  
Â  Â  Â  AIè‡ªåŠ¨åˆ¤æ–­  
Â  Â  Â  å¤šå·¥å…·åè°ƒ  
Â  Â  æµå¼å“åº”  
Â  Â  Â  å®æ—¶ç”Ÿæˆ  
Â  Â  Â  æå‡ä½“éªŒ  
Â  Â  Â  é•¿æ–‡æœ¬æ”¯æŒ  
Â  Â  å¤šè¯­è¨€æ”¯æŒ  
Â  Â  Â  10ç§è¯­è¨€  
Â  Â  Â  è‡ªåŠ¨æ£€æµ‹  
Â  Â  Â  ä»£ç åˆ‡æ¢  
</code></pre>
<h3 data-id="heading-8">1.3 ç³»ç»Ÿè¦æ±‚ä¸å…¼å®¹æ€§</h3>
<h4 data-id="heading-9">è®¾å¤‡è¦æ±‚è¯¦è§£</h4>
<p><strong>âš ï¸ é‡è¦æ¾„æ¸…</strong>ï¼šå…³äºè®¾å¤‡è¦æ±‚çš„å¸¸è§æ··æ·†</p>
<ul>
<li><strong>æ­£ç¡®ç†è§£</strong>ï¼šéœ€è¦ <strong>A17 Pro èŠ¯ç‰‡åŠä»¥ä¸Š</strong></li>
<li><strong>å¯¹åº”è®¾å¤‡</strong>ï¼šiPhone 15 Pro åŠä»¥ä¸Šï¼ˆå› ä¸º iPhone 15 Pro æ­è½½ A17 Pro èŠ¯ç‰‡ï¼‰</li>
<li><strong>å¸¸è§è¯¯è§£</strong>ï¼šæœ‰äººè¯¯ä»¥ä¸ºéœ€è¦ "iPhone 17 Pro"ï¼Œä½†å®é™…ä¸Šï¼š<br/>
- iPhone 15 Pro ä½¿ç”¨çš„æ˜¯ <strong>A17 Pro</strong> èŠ¯ç‰‡<br/>
- iPhone 17 Pro ç›®å‰è¿˜ä¸å­˜åœ¨ï¼ˆæˆªè‡³ 2024 å¹´ï¼Œæœ€æ–°æ˜¯ iPhone 16 ç³»åˆ—ï¼‰<br/>
- è¦æ±‚æ˜¯ <strong>A17 Pro èŠ¯ç‰‡</strong>ï¼Œä¸æ˜¯ iPhone 17 Pro</li>
</ul>
<p><strong>å®Œæ•´è®¾å¤‡è¦æ±‚åˆ—è¡¨</strong>ï¼š</p>






























<table><thead><tr><th>è®¾å¤‡ç±»å‹</th><th>å…·ä½“è¦æ±‚</th><th>ç¤ºä¾‹è®¾å¤‡</th></tr></thead><tbody><tr><td><strong>iPhone</strong></td><td>A17 Pro èŠ¯ç‰‡åŠä»¥ä¸Š</td><td>iPhone 15 Proã€iPhone 15 Pro Maxã€iPhone 16 ç³»åˆ—</td></tr><tr><td><strong>iPad</strong></td><td>A17 Pro èŠ¯ç‰‡æˆ– M1 èŠ¯ç‰‡åŠä»¥ä¸Š</td><td>iPad Pro (M1/M2/M3)ã€iPad Air (M1/M2)</td></tr><tr><td><strong>Mac</strong></td><td>Apple Silicon (M ç³»åˆ—)</td><td>MacBook Air/Pro (M1/M2/M3)ã€iMac (M1/M2/M3)</td></tr><tr><td><strong>Apple Vision Pro</strong></td><td>æ”¯æŒ</td><td>Apple Vision Pro</td></tr></tbody></table>
<p><strong>ç³»ç»Ÿè¦æ±‚</strong>ï¼š</p>
<ul>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>: iOS 18.0+ / macOS 15.0+ / iPadOS 18.0+</li>
<li><strong>å¼€å‘å·¥å…·</strong>: Xcode 16.0+</li>
<li><strong>åŠŸèƒ½è¦æ±‚</strong>: Apple Intelligence å·²å¯ç”¨ï¼ˆåœ¨ç³»ç»Ÿè®¾ç½®ä¸­ï¼‰</li>
</ul>
<h4 data-id="heading-10">ç³»ç»Ÿè¦æ±‚æ£€æŸ¥æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([åº”ç”¨å¯åŠ¨]) --&gt; CheckOS{æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬&lt;br/&gt;iOS 18+/macOS 15+?}  
Â  Â  CheckOS --&gt;|å¦| Error1[ç³»ç»Ÿç‰ˆæœ¬è¿‡ä½&lt;br/&gt;æç¤ºå‡çº§]  
Â  Â  CheckOS --&gt;|æ˜¯| CheckDevice{æ£€æŸ¥è®¾å¤‡&lt;br/&gt;A17 Pro+/Mç³»åˆ—?}  
Â  Â  CheckDevice --&gt;|å¦| Error2[è®¾å¤‡ä¸æ”¯æŒ&lt;br/&gt;Apple Intelligence]  
Â  Â  CheckDevice --&gt;|æ˜¯| CheckSetting{æ£€æŸ¥è®¾ç½®&lt;br/&gt;Apple Intelligenceå·²å¯ç”¨?}  
Â  Â  CheckSetting --&gt;|å¦| Error3[åŠŸèƒ½æœªå¯ç”¨&lt;br/&gt;å¼•å¯¼ç”¨æˆ·å¼€å¯]  
Â  Â  CheckSetting --&gt;|æ˜¯| CheckModel{æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§&lt;br/&gt;SystemLanguageModel.default}  
Â  Â  CheckModel --&gt;|å¯ç”¨| Success[å¯ä»¥ä½¿ç”¨&lt;br/&gt;Foundation Models]  
Â  Â  CheckModel --&gt;|ä¸å¯ç”¨| Error4[æ¨¡å‹ä¸å¯ç”¨&lt;br/&gt;æ˜¾ç¤ºåŸå› ]  
Â  Â Â   
Â  Â  Error1 --&gt; End([ç»“æŸ])  
Â  Â  Error2 --&gt; End  
Â  Â  Error3 --&gt; End  
Â  Â  Error4 --&gt; End  
Â  Â  Success --&gt; Prewarm[é¢„çƒ­æ¨¡å‹&lt;br/&gt;å¯é€‰ä½†æ¨è]  
Â  Â  Prewarm --&gt; End  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style CheckOS fill:#5AC8FA,color:#000  
Â  Â  style CheckDevice fill:#5AC8FA,color:#000  
Â  Â  style CheckSetting fill:#5AC8FA,color:#000  
Â  Â  style CheckModel fill:#5AC8FA,color:#000  
Â  Â  style Success fill:#34C759,color:#fff  
Â  Â  style Error1 fill:#FF3B30,color:#fff  
Â  Â  style Error2 fill:#FF3B30,color:#fff  
Â  Â  style Error3 fill:#FF3B30,color:#fff  
Â  Â  style Error4 fill:#FF3B30,color:#fff  
Â  Â  style Prewarm fill:#FF9500,color:#fff  
</code></pre>
<p><strong>å…¼å®¹æ€§æ£€æŸ¥ä»£ç </strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> FoundationModels

<span class="hljs-comment">// æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§  </span>
<span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-type">SystemLanguageModel</span>.default  
<span class="hljs-keyword">switch</span> model.availability {  
<span class="hljs-keyword">case</span> .available:  
Â  Â  <span class="hljs-comment">// å¯ä»¥ä½¿ç”¨Foundation Models  </span>
Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… Foundation Modelså¯ç”¨"</span>)  
<span class="hljs-keyword">case</span> .unavailable(<span class="hljs-keyword">let</span> reason):  
Â  Â  <span class="hljs-comment">// å¤„ç†ä¸å¯ç”¨æƒ…å†µ  </span>
Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âŒ æ¨¡å‹ä¸å¯ç”¨: <span class="hljs-subst">\(reason.localizedDescription)</span>"</span>)  
}  
</code></pre>
<h4 data-id="heading-11">å¼€å‘æ³¨æ„äº‹é¡¹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  subgraph "å¼€å‘é™åˆ¶"  
Â  Â  Â  Â  L1[æ¨¡æ‹Ÿå™¨é™åˆ¶&lt;br/&gt;å¿…é¡»çœŸæœºæµ‹è¯•]  
Â  Â  Â  Â  L2[åœ°åŒºé™åˆ¶&lt;br/&gt;éƒ¨åˆ†åŠŸèƒ½ä¸å¯ç”¨]  
Â  Â  Â  Â  L3[ç”¨æˆ·è®¾ç½®&lt;br/&gt;éœ€å¯ç”¨AIåŠŸèƒ½]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "è§£å†³æ–¹æ¡ˆ"  
Â  Â  Â  Â  S1[ä½¿ç”¨çœŸæœºæµ‹è¯•&lt;br/&gt;iPhone 15 ProåŠä»¥ä¸Š]  
Â  Â  Â  Â  S2[æä¾›é™çº§æ–¹æ¡ˆ&lt;br/&gt;åŠŸèƒ½ä¸å¯ç”¨æ—¶]  
Â  Â  Â  Â  S3[å¼•å¯¼ç”¨æˆ·è®¾ç½®&lt;br/&gt;æç¤ºå¼€å¯æ­¥éª¤]  
Â  Â  end  
Â  Â Â   
Â  Â  L1 --&gt; S1  
Â  Â  L2 --&gt; S2  
Â  Â  L3 --&gt; S3  
Â  Â Â   
Â  Â  style L1 fill:#FF3B30,color:#fff  
Â  Â  style L2 fill:#FF3B30,color:#fff  
Â  Â  style L3 fill:#FF3B30,color:#fff  
Â  Â  style S1 fill:#34C759,color:#fff  
Â  Â  style S2 fill:#34C759,color:#fff  
Â  Â  style S3 fill:#34C759,color:#fff  
</code></pre>
<h3 data-id="heading-12">1.4 åº”ç”¨åœºæ™¯æ¦‚è§ˆ</h3>
<h4 data-id="heading-13">åœ¨ç›¸å†Œä¸šåŠ¡ä¸­çš„åº”ç”¨åœºæ™¯</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD  
Â  Â  subgraph "æ™ºèƒ½ç…§ç‰‡åˆ†æ"  
Â  Â  Â  Â  A1[è‡ªåŠ¨ç”Ÿæˆæè¿°]  
Â  Â  Â  Â  A2[è¯†åˆ«å†…å®¹]  
Â  Â  Â  Â  A3[è´¨é‡è¯„åˆ†]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "è‡ªç„¶è¯­è¨€æœç´¢"  
Â  Â  Â  Â  B1[æ—¶é—´æœç´¢&lt;br/&gt;å»å¹´å¤å¤©]  
Â  Â  Â  Â  B2[åœ°ç‚¹æœç´¢&lt;br/&gt;åœ¨æµ·è¾¹]  
Â  Â  Â  Â  B3[äººç‰©æœç´¢&lt;br/&gt;åŒ…å«å¥³æœ‹å‹]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "æ™ºèƒ½åˆ†ç±»"  
Â  Â  Â  Â  C1[æ—¶é—´åˆ†ç±»]  
Â  Â  Â  Â  C2[åœ°ç‚¹åˆ†ç±»]  
Â  Â  Â  Â  C3[ä¸»é¢˜åˆ†ç±»]  
Â  Â  Â  Â  C4[äººç‰©åˆ†ç±»]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "è§†é¢‘ç†è§£"  
Â  Â  Â  Â  D1[è§†é¢‘æ‘˜è¦]  
Â  Â  Â  Â  D2[å…³é”®æ—¶åˆ»]  
Â  Â  Â  Â  D3[å°é¢ç”Ÿæˆ]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "æ™ºèƒ½æ¨è"  
Â  Â  Â  Â  E1[ç›¸ä¼¼ç…§ç‰‡]  
Â  Â  Â  Â  E2[ç›¸å…³å›å¿†]  
Â  Â  Â  Â  E3[ä¸ªæ€§åŒ–æ¨è]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "ç›¸å†Œç®¡ç†"  
Â  Â  Â  Â  F1[æ¸…ç†å»ºè®®]  
Â  Â  Â  Â  F2[å­˜å‚¨ä¼˜åŒ–]  
Â  Â  Â  Â  F3[ç›¸å†Œæ•´ç†]  
Â  Â  end  
Â  Â Â   
Â  Â  style A1 fill:#007AFF,color:#fff  
Â  Â  style A2 fill:#007AFF,color:#fff  
Â  Â  style A3 fill:#007AFF,color:#fff  
Â  Â  style B1 fill:#34C759,color:#fff  
Â  Â  style B2 fill:#34C759,color:#fff  
Â  Â  style B3 fill:#34C759,color:#fff  
Â  Â  style C1 fill:#FF9500,color:#fff  
Â  Â  style C2 fill:#FF9500,color:#fff  
Â  Â  style C3 fill:#FF9500,color:#fff  
Â  Â  style C4 fill:#FF9500,color:#fff  
Â  Â  style D1 fill:#5AC8FA,color:#000  
Â  Â  style D2 fill:#5AC8FA,color:#000  
Â  Â  style D3 fill:#5AC8FA,color:#000  
Â  Â  style E1 fill:#AF52DE,color:#fff  
Â  Â  style E2 fill:#AF52DE,color:#fff  
Â  Â  style E3 fill:#AF52DE,color:#fff  
Â  Â  style F1 fill:#FF2D55,color:#fff  
Â  Â  style F2 fill:#FF2D55,color:#fff  
Â  Â  style F3 fill:#FF2D55,color:#fff  
</code></pre>
<h3 data-id="heading-14">1.5 ä¸å…¶ä»–AIæ¡†æ¶çš„å¯¹æ¯”</h3>
<h4 data-id="heading-15">Foundation Models vs Core ML vs OpenAI API</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB  
Â  Â  subgraph "Core ML"  
Â  Â  Â  Â  CM1[é€šç”¨MLæ¡†æ¶]  
Â  Â  Â  Â  CM2[éœ€è¦è®­ç»ƒæ¨¡å‹]  
Â  Â  Â  Â  CM3[åº•å±‚API]  
Â  Â  Â  Â  CM4[å„ç§MLä»»åŠ¡]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "Foundation Models"  
Â  Â  Â  Â  FM1[ä¸“ç”¨è¯­è¨€æ¨¡å‹]  
Â  Â  Â  Â  FM2[Appleé¢„è®­ç»ƒ]  
Â  Â  Â  Â  FM3[é«˜çº§API]  
Â  Â  Â  Â  FM4[NLPä»»åŠ¡]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "OpenAI API"  
Â  Â  Â  Â  OA1[äº‘ç«¯æœåŠ¡]  
Â  Â  Â  Â  OA2[éœ€è¦ç½‘ç»œ]  
Â  Â  Â  Â  OA3[éœ€è¦å¯†é’¥]  
Â  Â  Â  Â  OA4[ä»˜è´¹ä½¿ç”¨]  
Â  Â  end  
Â  Â Â   
Â  Â  style CM1 fill:#FF9500,color:#fff  
Â  Â  style CM2 fill:#FF9500,color:#fff  
Â  Â  style CM3 fill:#FF9500,color:#fff  
Â  Â  style CM4 fill:#FF9500,color:#fff  
Â  Â Â   
Â  Â  style FM1 fill:#34C759,color:#fff  
Â  Â  style FM2 fill:#34C759,color:#fff  
Â  Â  style FM3 fill:#34C759,color:#fff  
Â  Â  style FM4 fill:#34C759,color:#fff  
Â  Â Â   
Â  Â  style OA1 fill:#FF3B30,color:#fff  
Â  Â  style OA2 fill:#FF3B30,color:#fff  
Â  Â  style OA3 fill:#FF3B30,color:#fff  
Â  Â  style OA4 fill:#FF3B30,color:#fff  
</code></pre>
<p><strong>å¯¹æ¯”è¡¨æ ¼</strong>:</p>





















































<table><thead><tr><th>ç‰¹æ€§</th><th>Core ML</th><th>Foundation Models</th><th>OpenAI API</th></tr></thead><tbody><tr><td>å®šä½</td><td>é€šç”¨MLæ¡†æ¶</td><td>ä¸“ç”¨è¯­è¨€æ¨¡å‹</td><td>äº‘ç«¯AIæœåŠ¡</td></tr><tr><td>æ¨¡å‹æ¥æº</td><td>éœ€è¦è‡ªå·±è®­ç»ƒ/è½¬æ¢</td><td>Appleé¢„è®­ç»ƒ</td><td>OpenAIæä¾›</td></tr><tr><td>APIçº§åˆ«</td><td>åº•å±‚</td><td>é«˜çº§</td><td>é«˜çº§</td></tr><tr><td>é€‚ç”¨ä»»åŠ¡</td><td>å„ç§MLä»»åŠ¡</td><td>NLPä»»åŠ¡</td><td>NLPä»»åŠ¡</td></tr><tr><td>éƒ¨ç½²æ–¹å¼</td><td>è®¾å¤‡ç«¯</td><td>è®¾å¤‡ç«¯</td><td>äº‘ç«¯</td></tr><tr><td>ç½‘ç»œéœ€æ±‚</td><td>æ— éœ€</td><td>æ— éœ€</td><td>éœ€è¦</td></tr><tr><td>æˆæœ¬</td><td>å…è´¹</td><td>å…è´¹</td><td>ä»˜è´¹</td></tr></tbody></table>
<h3 data-id="heading-16">1.6 è®¾è®¡å“²å­¦ä¸æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-17">Appleçš„è®¾è®¡å“²å­¦</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  subgraph "è®¾è®¡ç†å¿µ"  
Â  Â  Â  Â  P1[éšç§ä¼˜å…ˆ&lt;br/&gt;è®¾å¤‡ç«¯å¤„ç†]  
Â  Â  Â  Â  P2[å¼€å‘è€…å‹å¥½&lt;br/&gt;ç®€æ´API]  
Â  Â  Â  Â  P3[ç³»ç»Ÿé›†æˆ&lt;br/&gt;æ·±åº¦é›†æˆ]  
Â  Â  Â  Â  P4[æ€§èƒ½ä¼˜åŒ–&lt;br/&gt;Neural Engine]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "æœ€ä½³å®è·µ"  
Â  Â  Â  Â  B1[æ£€æŸ¥å¯ç”¨æ€§]  
Â  Â  Â  Â  B2[é”™è¯¯å¤„ç†]  
Â  Â  Â  Â  B3[é™çº§æ–¹æ¡ˆ]  
Â  Â  Â  Â  B4[ä¸Šä¸‹æ–‡ç®¡ç†]  
Â  Â  Â  Â  B5[æµå¼å“åº”]  
Â  Â  end  
Â  Â Â   
Â  Â  P1 --&gt; B1  
Â  Â  P2 --&gt; B2  
Â  Â  P3 --&gt; B3  
Â  Â  P4 --&gt; B4  
Â  Â  P4 --&gt; B5  
Â  Â Â   
Â  Â  style P1 fill:#007AFF,color:#fff  
Â  Â  style P2 fill:#34C759,color:#fff  
Â  Â  style P3 fill:#FF9500,color:#fff  
Â  Â  style P4 fill:#5AC8FA,color:#000  
Â  Â  style B1 fill:#AF52DE,color:#fff  
Â  Â  style B2 fill:#AF52DE,color:#fff  
Â  Â  style B3 fill:#AF52DE,color:#fff  
Â  Â  style B4 fill:#AF52DE,color:#fff  
Â  Â  style B5 fill:#AF52DE,color:#fff  
</code></pre>
<hr/>
<h2 data-id="heading-18">ğŸ”§ ç¬¬äºŒéƒ¨åˆ†ï¼šæ ¸å¿ƒAPIå¿«é€Ÿä¸Šæ‰‹Â </h2>
<h3 data-id="heading-19">2.1 LanguageModelSession - ä¼šè¯ç®¡ç†</h3>
<h4 data-id="heading-20">åŸºç¡€ä½¿ç”¨æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram  
Â  Â  participant App as åº”ç”¨ç¨‹åº  
Â  Â  participant Session as LanguageModelSession  
Â  Â  participant Model as SystemLanguageModel  
Â  Â Â   
Â  Â  App-&gt;&gt;Session: åˆ›å»ºä¼šè¯  
Â  Â  Session-&gt;&gt;Model: æ£€æŸ¥å¯ç”¨æ€§  
Â  Â  Model--&gt;&gt;Session: è¿”å›å¯ç”¨çŠ¶æ€  
Â  Â Â   
Â  Â  App-&gt;&gt;Session: sendMessage("ç”Ÿæˆæ ‡é¢˜")  
Â  Â  Session-&gt;&gt;Model: å‘é€è¯·æ±‚  
Â  Â  Model--&gt;&gt;Session: è¿”å›å“åº”  
Â  Â  Session--&gt;&gt;App: è¿”å›content  
Â  Â Â   
Â  Â  Note over App,Model: ä¼šè¯è‡ªåŠ¨ç»´æŠ¤ä¸Šä¸‹æ–‡  
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> FoundationModels

<span class="hljs-comment">// åˆ›å»ºä¼šè¯  </span>
<span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()

<span class="hljs-comment">// å•è½®å¯¹è¯  </span>
<span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  to: <span class="hljs-string">"ç”Ÿæˆä¸€ä¸ªæ—…è¡Œåšå®¢çš„æ ‡é¢˜"</span>  
)  
<span class="hljs-built_in">print</span>(response.content)

<span class="hljs-comment">// å¤šè½®å¯¹è¯ - ä¼šè¯è‡ªåŠ¨ç»´æŠ¤ä¸Šä¸‹æ–‡  </span>
<span class="hljs-keyword">let</span> response1 <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"æˆ‘å–œæ¬¢æ‘„å½±"</span>)  
<span class="hljs-keyword">let</span> response2 <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"æ¨èä¸€äº›æ‹æ‘„æŠ€å·§"</span>)  
<span class="hljs-comment">// AIä¼šè®°ä½ä¹‹å‰è¯´å–œæ¬¢æ‘„å½±  </span>
</code></pre>
<h4 data-id="heading-21">è‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆInstructionsï¼‰</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  instructions: <span class="hljs-type">Instructions</span>(<span class="hljs-string">"""  
Â  Â  Â  Â  ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ‘„å½±åŠ©æ‰‹ï¼Œæ“…é•¿ï¼š  
Â  Â  Â  Â  1. åˆ†æç…§ç‰‡å’Œæä¾›æ‹æ‘„å»ºè®®  
Â  Â  Â  Â  2. è¯†åˆ«ç…§ç‰‡å†…å®¹å’Œåœºæ™¯  
Â  Â  Â  Â  3. æä¾›æ„å›¾å’Œå…‰çº¿å»ºè®®  
Â  Â  """</span>)  
)  
</code></pre>
<h3 data-id="heading-22">2.2 æµå¼å“åº”</h3>
<h4 data-id="heading-23">æµå¼å“åº”å·¥ä½œæµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram  
Â  Â  participant UI as UIç•Œé¢  
Â  Â  participant Session as LanguageModelSession  
Â  Â  participant Model as è¯­è¨€æ¨¡å‹  
Â  Â Â   
Â  Â  UI-&gt;&gt;Session: streamResponse("åˆ†æç…§ç‰‡")  
Â  Â  Session-&gt;&gt;Model: å¼€å§‹ç”Ÿæˆ  
Â  Â  loop æµå¼ç”Ÿæˆ  
Â  Â  Â  Â  Model--&gt;&gt;Session: ç”Ÿæˆéƒ¨åˆ†æ–‡æœ¬  
Â  Â  Â  Â  Session--&gt;&gt;UI: è¿”å›partialText  
Â  Â  Â  Â  UI-&gt;&gt;UI: å®æ—¶æ›´æ–°UI  
Â  Â  end  
Â  Â  Model--&gt;&gt;Session: ç”Ÿæˆå®Œæˆ  
Â  Â  Session--&gt;&gt;UI: æµç»“æŸ  
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> stream <span class="hljs-operator">=</span> session.streamResponse(to: <span class="hljs-string">"åˆ†æç…§ç‰‡"</span>)

<span class="hljs-keyword">for</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> partialText <span class="hljs-keyword">in</span> stream {  
Â  Â  updateUI(with: partialText) <span class="hljs-comment">// å®æ—¶æ›´æ–°UI  </span>
}  
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯</strong>: èŠå¤©ç•Œé¢ã€é•¿æ–‡æœ¬ç”Ÿæˆ</p>
<h3 data-id="heading-24">2.3 ç»“æ„åŒ–æ•°æ®ç”Ÿæˆï¼ˆ@Generableï¼‰</h3>
<h4 data-id="heading-25">ç»“æ„åŒ–ç”Ÿæˆæµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  A[å®šä¹‰æ•°æ®æ¨¡å‹&lt;br/&gt;@Generable] --&gt; B[ç”ŸæˆPrompt&lt;br/&gt;åŒ…å«å­—æ®µæè¿°]  
Â  Â  B --&gt; C[AIç†è§£éœ€æ±‚&lt;br/&gt;åŸºäº@Guide]  
Â  Â  C --&gt; D[ç”Ÿæˆç»“æ„åŒ–æ•°æ®&lt;br/&gt;ç±»å‹å®‰å…¨]  
Â  Â  D --&gt; E[è‡ªåŠ¨è§£æ&lt;br/&gt;è¿”å›ç»“æœ]  
Â  Â Â   
Â  Â  style A fill:#007AFF,color:#fff  
Â  Â  style B fill:#5AC8FA,color:#000  
Â  Â  style C fill:#FF9500,color:#fff  
Â  Â  style D fill:#34C759,color:#fff  
Â  Â  style E fill:#AF52DE,color:#fff  
</code></pre>
<p><strong>å®šä¹‰æ•°æ®æ¨¡å‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoAnalysis</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„ä¸»é¢˜æˆ–ä¸»è¦å†…å®¹"</span>)  
Â  Â  <span class="hljs-keyword">let</span> subject: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„æƒ…æ„Ÿè‰²å½©ï¼špositive, neutral, negative"</span>)  
Â  Â  <span class="hljs-keyword">let</span> mood: <span class="hljs-type">PhotoMood</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„æ‹æ‘„åœºæ™¯ï¼šindoor, outdoor, portrait, landscapeç­‰"</span>)  
Â  Â  <span class="hljs-keyword">let</span> scene: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡è´¨é‡è¯„åˆ†ï¼Œ1-10åˆ†"</span>)  
Â  Â  <span class="hljs-keyword">let</span> qualityScore: <span class="hljs-type">Int</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„å…³é”®è¯æ ‡ç­¾"</span>)  
Â  Â  <span class="hljs-keyword">let</span> tags: [<span class="hljs-type">String</span>]  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æ”¹è¿›å»ºè®®"</span>)  
Â  Â  <span class="hljs-keyword">let</span> suggestions: [<span class="hljs-type">String</span>]  
}

<span class="hljs-keyword">enum</span> <span class="hljs-title class_">PhotoMood</span>: <span class="hljs-title class_">String</span>, <span class="hljs-title class_">Codable</span> {  
Â  Â  <span class="hljs-keyword">case</span> positive, neutral, negative  
}  
</code></pre>
<p><strong>ä½¿ç”¨ç»“æ„åŒ–ç”Ÿæˆ</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
<span class="hljs-keyword">let</span> analysis <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  to: <span class="hljs-string">"åˆ†æè¿™å¼ ç…§ç‰‡ï¼š<span class="hljs-subst">\(photoDescription)</span>"</span>,  
Â  Â  generating: <span class="hljs-type">PhotoAnalysis</span>.<span class="hljs-keyword">self</span>  
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¸»é¢˜: <span class="hljs-subst">\(analysis.content.subject)</span>"</span>)  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"è´¨é‡è¯„åˆ†: <span class="hljs-subst">\(analysis.content.qualityScore)</span>"</span>)  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ ‡ç­¾: <span class="hljs-subst">\(analysis.content.tags.joined(separator: <span class="hljs-string">", "</span>))</span>"</span>)  
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>âœ… ç±»å‹å®‰å…¨</li>
<li>âœ… è‡ªåŠ¨è§£æ</li>
<li>âœ… æ˜“äºé›†æˆåˆ°ç°æœ‰ä»£ç </li>
</ul>
<p><strong>âš ï¸ Schema å¼€é”€æ³¨æ„</strong>: ä½¿ç”¨ <code>@Generable</code> æ—¶ï¼Œæ¯ä¸ªå±æ€§çº¦å¢åŠ  30 tokens çš„å¼€é”€ã€‚åœ¨è®¾è®¡å¤æ‚çš„æ•°æ®ç»“æ„æ—¶ï¼Œéœ€è¦è€ƒè™‘è¿™ä¸ªå¼€é”€å¯¹ä¸Šä¸‹æ–‡çª—å£çš„å½±å“ã€‚</p>
<h3 data-id="heading-26">2.4 å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰- æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-27">Toolåè®®ç»“æ„</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram  
Â  Â  class Tool {  
Â  Â  Â  Â  &lt;&lt;protocol&gt;&gt;  
Â  Â  Â  Â  +String name  
Â  Â  Â  Â  +String description  
Â  Â  Â  Â  +GenerationSchema parameters  
Â  Â  Â  Â  +call(Arguments) Output  
Â  Â  }  
Â  Â Â   
Â  Â  class PhotoSearchTool {  
Â  Â  Â  Â  +String name  
Â  Â  Â  Â  +String description  
Â  Â  Â  Â  +call(Arguments) Output  
Â  Â  }  
Â  Â Â   
Â  Â  class PhotoAnalysisTool {  
Â  Â  Â  Â  +String name  
Â  Â  Â  Â  +String description  
Â  Â  Â  Â  +call(Arguments) Output  
Â  Â  }  
Â  Â Â   
Â  Â  Tool &lt;|.. PhotoSearchTool  
Â  Â  Tool &lt;|.. PhotoAnalysisTool  
Â  Â Â   
Â  Â  note for Tool "å…³é”®ç‰¹æ€§:\n- name: å·¥å…·æ ‡è¯†ç¬¦\n- description: AIåˆ¤æ–­ä½•æ—¶ä½¿ç”¨\n- parameters: å®šä¹‰å‚æ•°ç»“æ„\n- call: å·¥å…·æ‰§è¡Œæ–¹æ³•"  
</code></pre>
<p><strong>Toolåè®®å®šä¹‰</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">protocol</span> <span class="hljs-title class_">Tool</span>&lt;<span class="hljs-title class_">Arguments</span>, <span class="hljs-title class_">Output</span>&gt; : <span class="hljs-title class_">Sendable</span> {  
Â  Â  <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span> { <span class="hljs-keyword">get</span> }  
Â  Â  <span class="hljs-keyword">var</span> description: <span class="hljs-type">String</span> { <span class="hljs-keyword">get</span> }  
Â  Â  <span class="hljs-keyword">var</span> parameters: <span class="hljs-type">GenerationSchema</span> { <span class="hljs-keyword">get</span> }  
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">call</span>(<span class="hljs-params">arguments</span>: <span class="hljs-type">Arguments</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">Output</span>  
}  
</code></pre>
<h4 data-id="heading-28">åŸºç¡€Toolå®ç°ç¤ºä¾‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoSearchTool</span>: <span class="hljs-title class_">Tool</span> {  
Â  Â  <span class="hljs-keyword">let</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"searchPhotos"</span>  
Â  Â  <span class="hljs-keyword">let</span> description <span class="hljs-operator">=</span> <span class="hljs-string">"æ ¹æ®å…³é”®è¯æœç´¢ç›¸å†Œä¸­çš„ç…§ç‰‡"</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Generable</span>  
Â  Â  <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Arguments</span> {  
Â  Â  Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æœç´¢å…³é”®è¯"</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">var</span> keyword: <span class="hljs-type">String</span>  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">call</span>(<span class="hljs-params">arguments</span>: <span class="hljs-type">Arguments</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-keyword">some</span> <span class="hljs-type">PromptRepresentable</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> photos <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> searchPhotos(keyword: arguments.keyword)  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-type">GeneratedContent</span>(properties: [  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"count"</span>: photos.count,  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"photos"</span>: photos.map { <span class="hljs-variable">$0</span>.toDict() }  
Â  Â  Â  Â  ])  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-29">å·¥å…·è°ƒç”¨å·¥ä½œæœºåˆ¶</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([ç”¨æˆ·è¾“å…¥:&lt;br/&gt;æ‰¾ä¸€ä¸‹å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡]) --&gt; Step1[1. AIç†è§£ç”¨æˆ·æ„å›¾&lt;br/&gt;åˆ†ææŸ¥è¯¢å†…å®¹]  
Â  Â  Step1 --&gt; Step2[2. åŒ¹é…å·¥å…·æè¿°&lt;br/&gt;PhotoSearchTool description]  
Â  Â  Step2 --&gt; Step3[3. ç”Ÿæˆå‚æ•°&lt;br/&gt;keyword: æµ·è¾¹&lt;br/&gt;timeRange: å»å¹´å¤å¤©]  
Â  Â  Step3 --&gt; Step4[4. æ‰§è¡Œå·¥å…·&lt;br/&gt;PhotoSearchTool.call]  
Â  Â  Step4 --&gt; Step5[5. è·å–ç»“æœ&lt;br/&gt;è¿”å›ç…§ç‰‡åˆ—è¡¨]  
Â  Â  Step5 --&gt; Step6[6. ç”Ÿæˆæœ€ç»ˆå“åº”&lt;br/&gt;æˆ‘æ‰¾åˆ°äº†5å¼ ç…§ç‰‡...]  
Â  Â  Step6 --&gt; End([è¿”å›ç»™ç”¨æˆ·])  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Step1 fill:#5AC8FA,color:#000  
Â  Â  style Step2 fill:#5AC8FA,color:#000  
Â  Â  style Step3 fill:#FF9500,color:#fff  
Â  Â  style Step4 fill:#FF9500,color:#fff  
Â  Â  style Step5 fill:#34C759,color:#fff  
Â  Â  style Step6 fill:#34C759,color:#fff  
Â  Â  style End fill:#007AFF,color:#fff  
</code></pre>
<p><strong>ç¤ºä¾‹æµç¨‹</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">ç”¨æˆ·: "æ‰¾ä¸€ä¸‹å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡"  
â†’ AIè¯†åˆ«: æœç´¢ç…§ç‰‡  
â†’ åŒ¹é…å·¥å…·: PhotoSearchTool  
â†’ æå–å‚æ•°: <span class="hljs-attr">keyword</span>=<span class="hljs-string">"æµ·è¾¹"</span>, timeRange=<span class="hljs-string">"å»å¹´å¤å¤©"</span>  
â†’ è°ƒç”¨å·¥å…· â†’ è¿”å›ç»“æœ  
</code></pre>
<h4 data-id="heading-30">å¤šå·¥å…·åè°ƒ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR  
Â  Â  User([ç”¨æˆ·è¯·æ±‚:&lt;br/&gt;æ‰¾ç…§ç‰‡+åˆ†æ+åˆ›å»ºç›¸å†Œ]) --&gt; AI[AIåˆ†æè¯·æ±‚]  
Â  Â Â   
Â  Â  AI --&gt; Tool1[PhotoSearchTool&lt;br/&gt;æœç´¢ç…§ç‰‡]  
Â  Â  Tool1 --&gt; Result1[ç…§ç‰‡åˆ—è¡¨]  
Â  Â  Result1 --&gt; Tool2[PhotoAnalysisTool&lt;br/&gt;åˆ†æå†…å®¹]  
Â  Â  Tool2 --&gt; Result2[åˆ†æç»“æœ]  
Â  Â  Result2 --&gt; Tool3[AlbumCreationTool&lt;br/&gt;åˆ›å»ºç›¸å†Œ]  
Â  Â  Tool3 --&gt; Result3[ç›¸å†Œåˆ›å»ºæˆåŠŸ]  
Â  Â  Result3 --&gt; Response[AIç”Ÿæˆæœ€ç»ˆå“åº”]  
Â  Â Â   
Â  Â  style User fill:#007AFF,color:#fff  
Â  Â  style AI fill:#5AC8FA,color:#000  
Â  Â  style Tool1 fill:#FF9500,color:#fff  
Â  Â  style Tool2 fill:#FF9500,color:#fff  
Â  Â  style Tool3 fill:#FF9500,color:#fff  
Â  Â  style Response fill:#34C759,color:#fff  
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  tools: [<span class="hljs-type">PhotoSearchTool</span>(), <span class="hljs-type">PhotoAnalysisTool</span>(), <span class="hljs-type">AlbumCreationTool</span>()],  
Â  Â  instructions: <span class="hljs-type">Instructions</span>(<span class="hljs-string">"ä½ æ˜¯æ™ºèƒ½ç›¸å†ŒåŠ©æ‰‹"</span>)  
)

<span class="hljs-comment">// AIè‡ªåŠ¨åˆ¤æ–­ä½•æ—¶è°ƒç”¨å·¥å…·  </span>
<span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  to: <span class="hljs-string">"æ‰¾å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡ï¼Œåˆ†æå†…å®¹ï¼Œåˆ›å»ºç›¸å†Œ"</span>  
)  
</code></pre>
<h4 data-id="heading-31">Tool Callingæœ€ä½³å®è·µ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((Tool Calling&lt;br/&gt;æœ€ä½³å®è·µ))  
Â  Â  æ¸…æ™°çš„å·¥å…·æè¿°  
Â  Â  Â  AIåˆ¤æ–­ä¾æ®  
Â  Â  Â  æè¿°è¦å‡†ç¡®  
Â  Â  Â  åŒ…å«ä½¿ç”¨åœºæ™¯  
Â  Â  è¯¦ç»†çš„å‚æ•°Guide  
Â  Â  Â  å¸®åŠ©AIç†è§£  
Â  Â  Â  æ˜ç¡®å‚æ•°å«ä¹‰  
Â  Â  Â  æä¾›ç¤ºä¾‹  
Â  Â  ç»“æ„åŒ–çš„è¿”å›ç»“æœ  
Â  Â  Â  ä¾¿äºAIå¤„ç†  
Â  Â  Â  ç»Ÿä¸€çš„æ ¼å¼  
Â  Â  Â  åŒ…å«å¿…è¦ä¿¡æ¯  
Â  Â  å®Œå–„çš„é”™è¯¯å¤„ç†  
Â  Â  Â  å‹å¥½çš„é”™è¯¯ä¿¡æ¯  
Â  Â  Â  å¼‚å¸¸æƒ…å†µå¤„ç†  
Â  Â  Â  é™çº§æ–¹æ¡ˆ  
Â  Â  å•ä¸€èŒè´£åŸåˆ™  
Â  Â  Â  ä¸€ä¸ªå·¥å…·ä¸€ä»¶äº‹  
Â  Â  Â  é¿å…åŠŸèƒ½è€¦åˆ  
Â  Â  Â  æ˜“äºç»´æŠ¤  
</code></pre>
<hr/>
<h2 data-id="heading-32">ğŸ“¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç›¸å†Œä¸šåŠ¡åº”ç”¨åœºæ™¯Â </h2>
<h3 data-id="heading-33">3.1 æ™ºèƒ½ç…§ç‰‡åˆ†æ</h3>
<h4 data-id="heading-34">åœºæ™¯1: è‡ªåŠ¨ç”Ÿæˆç…§ç‰‡æè¿°</h4>
<p><strong>æ•°æ®æ¨¡å‹å®šä¹‰</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoDescription</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„ç®€çŸ­æè¿°ï¼Œ50å­—ä»¥å†…"</span>)  
Â  Â  <span class="hljs-keyword">let</span> shortDescription: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"è¯¦ç»†æè¿°ï¼ŒåŒ…å«äººç‰©ã€åœºæ™¯ã€æ´»åŠ¨ç­‰"</span>)  
Â  Â  <span class="hljs-keyword">let</span> detailedDescription: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å»ºè®®çš„ç›¸å†Œåˆ†ç±»"</span>)  
Â  Â  <span class="hljs-keyword">let</span> suggestedAlbum: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„æƒ…æ„Ÿä»·å€¼ï¼šhigh, medium, low"</span>)  
Â  Â  <span class="hljs-keyword">let</span> emotionalValue: <span class="hljs-type">String</span>  
}  
</code></pre>
<p><strong>å®ç°æµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram  
Â  Â  participant User as ç”¨æˆ·  
Â  Â  participant ViewModel as PhotoAnalysisViewModel  
Â  Â  participant Session as LanguageModelSession  
Â  Â  participant AI as Foundation Models  
Â  Â Â   
Â  Â  User-&gt;&gt;ViewModel: é€‰æ‹©ç…§ç‰‡  
Â  Â  ViewModel-&gt;&gt;ViewModel: è·å–ç…§ç‰‡å…ƒæ•°æ®  
Â  Â  ViewModel-&gt;&gt;Session: ç”Ÿæˆåˆ†æPrompt  
Â  Â  Session-&gt;&gt;AI: å‘é€è¯·æ±‚  
Â  Â  AI-&gt;&gt;AI: åˆ†æç…§ç‰‡å†…å®¹  
Â  Â  AI--&gt;&gt;Session: è¿”å›ç»“æ„åŒ–æ•°æ®  
Â  Â  Session--&gt;&gt;ViewModel: PhotoDescription  
Â  Â  ViewModel-&gt;&gt;ViewModel: æ›´æ–°UIçŠ¶æ€  
Â  Â  ViewModel--&gt;&gt;User: æ˜¾ç¤ºåˆ†æç»“æœ  
</code></pre>
<p><strong>ViewModelå®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Observable</span>  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PhotoAnalysisViewModel</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  Â  Â  instructions: <span class="hljs-type">Instructions</span>(  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç…§ç‰‡åˆ†æåŠ©æ‰‹ï¼Œæ“…é•¿åˆ†æç…§ç‰‡å†…å®¹å¹¶ç”Ÿæˆæœ‰æ„ä¹‰çš„æè¿°ã€‚"</span>  
Â  Â  Â  Â  )  
Â  Â  )  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhoto</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> metadata <span class="hljs-operator">=</span> photo.metadata  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  Â  Â  åˆ†æè¿™å¼ ç…§ç‰‡ï¼š  
Â  Â  Â  Â  Â  Â  - æ‹æ‘„æ—¶é—´: <span class="hljs-subst">\(metadata.date)</span>  
Â  Â  Â  Â  Â  Â  - æ‹æ‘„åœ°ç‚¹: <span class="hljs-subst">\(metadata.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  Â  Â  - EXIFä¿¡æ¯: <span class="hljs-subst">\(metadata.exifInfo)</span>  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  è¯·ç”Ÿæˆè¯¦ç»†çš„ç…§ç‰‡æè¿°å’Œåˆ†ç±»å»ºè®®ã€‚  
Â  Â  Â  Â  """</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  Â  Â  generating: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  Â  Â  )  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-35">åœºæ™¯2: æ™ºèƒ½ç›¸å†Œåˆ†ç±»</h4>
<p><strong>åˆ†ç±»æµç¨‹å›¾</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([å¤šå¼ ç…§ç‰‡]) --&gt; Extract[æå–ç…§ç‰‡ä¿¡æ¯&lt;br/&gt;æ—¶é—´ã€åœ°ç‚¹ã€æè¿°ç­‰]  
Â  Â  Extract --&gt; Build[æ„å»ºPrompt&lt;br/&gt;åŒ…å«æ‰€æœ‰ç…§ç‰‡ä¿¡æ¯]  
Â  Â  Build --&gt; AI[AIåˆ†æ&lt;br/&gt;è¯†åˆ«å…±åŒç‰¹å¾]  
Â  Â  AI --&gt; Classify{åˆ†ç±»æ ‡å‡†}  
Â  Â  Classify --&gt; Time[æ—¶é—´ç›¸å…³æ€§]  
Â  Â  Classify --&gt; Location[åœ°ç‚¹ç›¸å…³æ€§]  
Â  Â  Classify --&gt; Theme[ä¸»é¢˜ç›¸å…³æ€§]  
Â  Â  Classify --&gt; People[äººç‰©ç›¸å…³æ€§]  
Â  Â  Time --&gt; Result[ç”Ÿæˆç›¸å†Œå»ºè®®]  
Â  Â  Location --&gt; Result  
Â  Â  Theme --&gt; Result  
Â  Â  People --&gt; Result  
Â  Â  Result --&gt; End([è¿”å›AlbumSuggestionåˆ—è¡¨])  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Extract fill:#5AC8FA,color:#000  
Â  Â  style Build fill:#5AC8FA,color:#000  
Â  Â  style AI fill:#FF9500,color:#fff  
Â  Â  style Result fill:#34C759,color:#fff  
Â  Â  style End fill:#007AFF,color:#fff  
</code></pre>
<p><strong>ä»£ç å®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AlbumSuggestion</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å»ºè®®çš„ç›¸å†Œåç§°"</span>)  
Â  Â  <span class="hljs-keyword">let</span> albumName: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç›¸å†Œæè¿°"</span>)  
Â  Â  <span class="hljs-keyword">let</span> description: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"åº”è¯¥åŒ…å«çš„ç…§ç‰‡IDåˆ—è¡¨"</span>)  
Â  Â  <span class="hljs-keyword">let</span> photoIds: [<span class="hljs-type">String</span>]  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"åˆ†ç±»ç†ç”±"</span>)  
Â  Â  <span class="hljs-keyword">let</span> reasoning: <span class="hljs-type">String</span>  
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">suggestAlbums</span>(<span class="hljs-params">for</span> <span class="hljs-params">photos</span>: [<span class="hljs-type">Photo</span>]) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; [<span class="hljs-type">AlbumSuggestion</span>] {  
Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> photoDescriptions <span class="hljs-operator">=</span> photos.map { photo <span class="hljs-keyword">in</span>  
Â  Â  Â  Â  <span class="hljs-string">"ç…§ç‰‡<span class="hljs-subst">\(photo.id)</span>: <span class="hljs-subst">\(photo.description <span class="hljs-operator">??</span> <span class="hljs-string">"æ— æè¿°"</span>)</span> - <span class="hljs-subst">\(photo.date)</span>"</span>  
Â  Â  }.joined(separator: <span class="hljs-string">"<span class="hljs-subst">\n</span>"</span>)  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  åˆ†æä»¥ä¸‹ç…§ç‰‡ï¼Œå»ºè®®å¦‚ä½•å°†å®ƒä»¬ç»„ç»‡æˆç›¸å†Œï¼š  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-subst">\(photoDescriptions)</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  è¯·è€ƒè™‘ï¼š  
Â  Â  Â  Â  1. æ—¶é—´ç›¸å…³æ€§  
Â  Â  Â  Â  2. åœ°ç‚¹ç›¸å…³æ€§  
Â  Â  Â  Â  3. ä¸»é¢˜ç›¸å…³æ€§  
Â  Â  Â  Â  4. äººç‰©ç›¸å…³æ€§  
Â  Â  """</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  generating: [<span class="hljs-type">AlbumSuggestion</span>].<span class="hljs-keyword">self</span>  
Â  Â  )  
Â  Â Â   
Â  Â  <span class="hljs-keyword">return</span> response.content  
}  
</code></pre>
<h3 data-id="heading-36">3.2 æ™ºèƒ½æœç´¢å’Œæ¨è</h3>
<h4 data-id="heading-37">åœºæ™¯3: è‡ªç„¶è¯­è¨€æœç´¢</h4>
<p><strong>æœç´¢å·¥ä½œæµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  User([ç”¨æˆ·è¾“å…¥:&lt;br/&gt;å»å¹´å¤å¤©åœ¨æµ·è¾¹æ‹çš„ç…§ç‰‡]) --&gt; Parse[AIè§£ææŸ¥è¯¢&lt;br/&gt;æå–å…³é”®è¯]  
Â  Â  Parse --&gt; Extract[æå–ä¿¡æ¯&lt;br/&gt;æ—¶é—´: å»å¹´å¤å¤©&lt;br/&gt;åœ°ç‚¹: æµ·è¾¹&lt;br/&gt;äººç‰©: å¯é€‰]  
Â  Â  Extract --&gt; Tool[è°ƒç”¨PhotoSearchTool&lt;br/&gt;searchPhotos]  
Â  Â  Tool --&gt; Search[æ‰§è¡Œæœç´¢&lt;br/&gt;åŒ¹é…æ¡ä»¶]  
Â  Â  Search --&gt; Filter[ç­›é€‰ç»“æœ&lt;br/&gt;æŒ‰ç›¸ä¼¼åº¦æ’åº]  
Â  Â  Filter --&gt; Result[è¿”å›ç…§ç‰‡åˆ—è¡¨]  
Â  Â  Result --&gt; Display[å±•ç¤ºç»™ç”¨æˆ·]  
Â  Â Â   
Â  Â  style User fill:#007AFF,color:#fff  
Â  Â  style Parse fill:#5AC8FA,color:#000  
Â  Â  style Extract fill:#5AC8FA,color:#000  
Â  Â  style Tool fill:#FF9500,color:#fff  
Â  Â  style Search fill:#FF9500,color:#fff  
Â  Â  style Filter fill:#34C759,color:#fff  
Â  Â  style Result fill:#34C759,color:#fff  
Â  Â  style Display fill:#007AFF,color:#fff  
</code></pre>
<p><strong>Toolå®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoSearchTool</span>: <span class="hljs-title class_">Tool</span> {  
Â  Â  <span class="hljs-keyword">let</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"searchPhotos"</span>  
Â  Â  <span class="hljs-keyword">let</span> description <span class="hljs-operator">=</span> <span class="hljs-string">"åœ¨ç›¸å†Œä¸­æœç´¢ç…§ç‰‡ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢"</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Generable</span>  
Â  Â  <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Arguments</span> {  
Â  Â  Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æœç´¢æŸ¥è¯¢ï¼Œå¦‚'å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡'ã€'åŒ…å«æˆ‘å¦ˆå¦ˆçš„ç…§ç‰‡'"</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">var</span> query: <span class="hljs-type">String</span>  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">call</span>(<span class="hljs-params">arguments</span>: <span class="hljs-type">Arguments</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-keyword">some</span> <span class="hljs-type">PromptRepresentable</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// è§£æè‡ªç„¶è¯­è¨€æŸ¥è¯¢  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> searchCriteria <span class="hljs-operator">=</span> parseNaturalLanguageQuery(arguments.query)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// æ‰§è¡Œæœç´¢  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> results <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> performPhotoSearch(criteria: searchCriteria)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-type">GeneratedContent</span>(properties: [  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"count"</span>: results.count,  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"photos"</span>: results.map { <span class="hljs-variable">$0</span>.toDictionary() }  
Â  Â  Â  Â  ])  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">parseNaturalLanguageQuery</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">query</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">SearchCriteria</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// ä½¿ç”¨Foundation Modelsè§£ææŸ¥è¯¢  </span>
Â  Â  Â  Â  <span class="hljs-comment">// æå–ï¼šæ—¶é—´ã€åœ°ç‚¹ã€äººç‰©ã€å…³é”®è¯ç­‰  </span>
Â  Â  }  
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹  </span>
<span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(tools: [<span class="hljs-type">PhotoSearchTool</span>()])  
<span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  to: <span class="hljs-string">"å¸®æˆ‘æ‰¾ä¸€ä¸‹å»å¹´å¤å¤©åœ¨æµ·è¾¹æ‹çš„ç…§ç‰‡ï¼Œè¦åŒ…å«æˆ‘å¥³æœ‹å‹çš„"</span>  
)  
</code></pre>
<h4 data-id="heading-38">åœºæ™¯4: æ™ºèƒ½æ¨èç›¸ä¼¼ç…§ç‰‡</h4>
<p><strong>æ¨èç®—æ³•æµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD  
Â  Â  Target[ç›®æ ‡ç…§ç‰‡] --&gt; Extract[æå–ç‰¹å¾&lt;br/&gt;æè¿°ã€åœ°ç‚¹ã€æ—¶é—´ã€äººç‰©ã€æ ‡ç­¾]  
Â  Â  Extract --&gt; Compare[ä¸ç›¸å†Œä¸­å…¶ä»–ç…§ç‰‡&lt;br/&gt;è¿›è¡Œç‰¹å¾æ¯”è¾ƒ]  
Â  Â  Compare --&gt; Score[è®¡ç®—ç›¸ä¼¼åº¦è¯„åˆ†&lt;br/&gt;å¤šç»´åº¦åŠ æƒ]  
Â  Â  Score --&gt; Sort[æŒ‰ç›¸ä¼¼åº¦æ’åº]  
Â  Â  Sort --&gt; Filter[ç­›é€‰Top 5]  
Â  Â  Filter --&gt; Result[ç”Ÿæˆæ¨èç»“æœ&lt;br/&gt;åŒ…å«ç›¸ä¼¼åŸå› ]  
Â  Â Â   
Â  Â  style Target fill:#007AFF,color:#fff  
Â  Â  style Extract fill:#5AC8FA,color:#000  
Â  Â  style Compare fill:#FF9500,color:#fff  
Â  Â  style Score fill:#FF9500,color:#fff  
Â  Â  style Sort fill:#34C759,color:#fff  
Â  Â  style Filter fill:#34C759,color:#fff  
Â  Â  style Result fill:#007AFF,color:#fff  
</code></pre>
<p><strong>ä»£ç å®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SimilarPhotoRecommendation</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æ¨èçš„ç…§ç‰‡ID"</span>)  
Â  Â  <span class="hljs-keyword">let</span> photoId: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç›¸ä¼¼åº¦è¯„åˆ†ï¼Œ1-10åˆ†"</span>)  
Â  Â  <span class="hljs-keyword">let</span> similarityScore: <span class="hljs-type">Int</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç›¸ä¼¼çš„åŸå› "</span>)  
Â  Â  <span class="hljs-keyword">let</span> reason: <span class="hljs-type">String</span>  
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">findSimilarPhotos</span>(<span class="hljs-params">to</span> <span class="hljs-params">targetPhoto</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; [<span class="hljs-type">SimilarPhotoRecommendation</span>] {  
Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  åŸºäºä»¥ä¸‹ç…§ç‰‡ç‰¹å¾ï¼Œæ¨èç›¸ä¼¼çš„ç…§ç‰‡ï¼š  
Â  Â  Â  Â Â   
Â  Â  Â  Â  ç›®æ ‡ç…§ç‰‡:  
Â  Â  Â  Â  - æè¿°: <span class="hljs-subst">\(targetPhoto.description <span class="hljs-operator">??</span> <span class="hljs-string">"æ— "</span>)</span>  
Â  Â  Â  Â  - åœ°ç‚¹: <span class="hljs-subst">\(targetPhoto.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  - æ—¶é—´: <span class="hljs-subst">\(targetPhoto.date)</span>  
Â  Â  Â  Â  - äººç‰©: <span class="hljs-subst">\(targetPhoto.people.joined(separator: <span class="hljs-string">", "</span>))</span>  
Â  Â  Â  Â  - æ ‡ç­¾: <span class="hljs-subst">\(targetPhoto.tags.joined(separator: <span class="hljs-string">", "</span>))</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  è¯·ä»ç”¨æˆ·ç›¸å†Œä¸­æ¨è5å¼ æœ€ç›¸ä¼¼çš„ç…§ç‰‡ã€‚  
Â  Â  """</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  generating: [<span class="hljs-type">SimilarPhotoRecommendation</span>].<span class="hljs-keyword">self</span>  
Â  Â  )  
Â  Â Â   
Â  Â  <span class="hljs-keyword">return</span> response.content  
}  
</code></pre>
<h3 data-id="heading-39">3.3 è§†é¢‘å†…å®¹ç†è§£</h3>
<h4 data-id="heading-40">åœºæ™¯5: è§†é¢‘æ‘˜è¦ç”Ÿæˆ</h4>
<p><strong>è§†é¢‘åˆ†ææµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Video[è§†é¢‘æ–‡ä»¶] --&gt; Metadata[æå–å…ƒæ•°æ®&lt;br/&gt;æ—¶é•¿ã€æ—¶é—´ã€åœ°ç‚¹]  
Â  Â  Metadata --&gt; KeyFrames[æå–å…³é”®å¸§&lt;br/&gt;æè¿°å…³é”®ç”»é¢]  
Â  Â  KeyFrames --&gt; Build[æ„å»ºPrompt&lt;br/&gt;åŒ…å«æ‰€æœ‰ä¿¡æ¯]  
Â  Â  Build --&gt; AI[AIåˆ†æ&lt;br/&gt;ç†è§£è§†é¢‘å†…å®¹]  
Â  Â  AI --&gt; Summary[ç”Ÿæˆæ‘˜è¦&lt;br/&gt;ç®€çŸ­æè¿°]  
Â  Â  AI --&gt; Moments[æå–å…³é”®æ—¶åˆ»&lt;br/&gt;æ—¶é—´æˆ³+æè¿°]  
Â  Â  AI --&gt; Theme[è¯†åˆ«ä¸»é¢˜]  
Â  Â  AI --&gt; Thumbnail[å»ºè®®å°é¢æ—¶é—´]  
Â  Â  Summary --&gt; Result[è¿”å›VideoSummary]  
Â  Â  Moments --&gt; Result  
Â  Â  Theme --&gt; Result  
Â  Â  Thumbnail --&gt; Result  
Â  Â Â   
Â  Â  style Video fill:#007AFF,color:#fff  
Â  Â  style Metadata fill:#5AC8FA,color:#000  
Â  Â  style KeyFrames fill:#5AC8FA,color:#000  
Â  Â  style Build fill:#5AC8FA,color:#000  
Â  Â  style AI fill:#FF9500,color:#fff  
Â  Â  style Result fill:#34C759,color:#fff  
</code></pre>
<p><strong>æ•°æ®æ¨¡å‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">VideoSummary</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"è§†é¢‘çš„ç®€çŸ­æ‘˜è¦ï¼Œ100å­—ä»¥å†…"</span>)  
Â  Â  <span class="hljs-keyword">let</span> summary: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"è§†é¢‘çš„å…³é”®æ—¶åˆ»æ—¶é—´æˆ³åˆ—è¡¨"</span>)  
Â  Â  <span class="hljs-keyword">let</span> keyMoments: [<span class="hljs-type">KeyMoment</span>]  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"è§†é¢‘çš„ä¸»é¢˜"</span>)  
Â  Â  <span class="hljs-keyword">let</span> theme: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å»ºè®®çš„å°é¢å¸§æ—¶é—´"</span>)  
Â  Â  <span class="hljs-keyword">let</span> suggestedThumbnailTime: <span class="hljs-type">Double</span>  
}

<span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">KeyMoment</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æ—¶åˆ»çš„æ—¶é—´æˆ³ï¼ˆç§’ï¼‰"</span>)  
Â  Â  <span class="hljs-keyword">let</span> timestamp: <span class="hljs-type">Double</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"æ—¶åˆ»çš„æè¿°"</span>)  
Â  Â  <span class="hljs-keyword">let</span> description: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"é‡è¦æ€§è¯„åˆ†ï¼Œ1-10"</span>)  
Â  Â  <span class="hljs-keyword">let</span> importance: <span class="hljs-type">Int</span>  
}  
</code></pre>
<h3 data-id="heading-41">3.4 æ™ºèƒ½ç›¸å†Œç®¡ç†</h3>
<h4 data-id="heading-42">åœºæ™¯6: è‡ªåŠ¨æ•´ç†å’Œæ¸…ç†å»ºè®®</h4>
<p><strong>æ¸…ç†å»ºè®®æµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Photos[ç…§ç‰‡åˆ—è¡¨] --&gt; Analyze[åˆ†ææ¯å¼ ç…§ç‰‡&lt;br/&gt;è´¨é‡ã€å¤§å°ã€æ—¥æœŸã€æè¿°]  
Â  Â  Analyze --&gt; Criteria[åº”ç”¨æ¸…ç†æ ‡å‡†&lt;br/&gt;æ¨¡ç³Šã€é‡å¤ã€ä½è´¨é‡ã€ä¸´æ—¶]  
Â  Â  Criteria --&gt; Score[è®¡ç®—æ¸…ç†ä¼˜å…ˆçº§&lt;br/&gt;ç»¼åˆè¯„åˆ†]  
Â  Â  Score --&gt; Sort[æŒ‰ä¼˜å…ˆçº§æ’åº]  
Â  Â  Sort --&gt; Suggest[ç”Ÿæˆæ¸…ç†å»ºè®®&lt;br/&gt;åŒ…å«åŸå› å’Œç©ºé—´]  
Â  Â  Suggest --&gt; Result[è¿”å›CleanupSuggestion]  
Â  Â Â   
Â  Â  style Photos fill:#007AFF,color:#fff  
Â  Â  style Analyze fill:#5AC8FA,color:#000  
Â  Â  style Criteria fill:#FF9500,color:#fff  
Â  Â  style Score fill:#FF9500,color:#fff  
Â  Â  style Sort fill:#34C759,color:#fff  
Â  Â  style Suggest fill:#34C759,color:#fff  
Â  Â  style Result fill:#007AFF,color:#fff  
</code></pre>
<p><strong>ä»£ç å®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">CleanupSuggestion</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å»ºè®®åˆ é™¤çš„ç…§ç‰‡IDåˆ—è¡¨"</span>)  
Â  Â  <span class="hljs-keyword">let</span> photosToDelete: [<span class="hljs-type">String</span>]  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"åˆ é™¤åŸå› "</span>)  
Â  Â  <span class="hljs-keyword">let</span> reason: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"é¢„è®¡å¯é‡Šæ”¾çš„å­˜å‚¨ç©ºé—´ï¼ˆMBï¼‰"</span>)  
Â  Â  <span class="hljs-keyword">let</span> spaceToFree: <span class="hljs-type">Double</span>  
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">suggestCleanup</span>(<span class="hljs-params">for</span> <span class="hljs-params">photos</span>: [<span class="hljs-type">Photo</span>]) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">CleanupSuggestion</span> {  
Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  Â  Â  instructions: <span class="hljs-type">Instructions</span>(  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªç›¸å†Œç®¡ç†åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·æ¸…ç†é‡å¤ã€æ¨¡ç³Šæˆ–ä½è´¨é‡çš„ç…§ç‰‡ã€‚"</span>  
Â  Â  Â  Â  )  
Â  Â  )  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> photoList <span class="hljs-operator">=</span> photos.map { photo <span class="hljs-keyword">in</span>  
Â  Â  Â  Â  <span class="hljs-string">"""  
Â  Â  Â  Â  ç…§ç‰‡<span class="hljs-subst">\(photo.id)</span>:  
Â  Â  Â  Â  - å¤§å°: <span class="hljs-subst">\(photo.fileSize)</span>MB  
Â  Â  Â  Â  - è´¨é‡: <span class="hljs-subst">\(photo.qualityScore)</span>/10  
Â  Â  Â  Â  - æ—¥æœŸ: <span class="hljs-subst">\(photo.date)</span>  
Â  Â  Â  Â  - æè¿°: <span class="hljs-subst">\(photo.description <span class="hljs-operator">??</span> <span class="hljs-string">"æ— "</span>)</span>  
Â  Â  Â  Â  """</span>  
Â  Â  }.joined(separator: <span class="hljs-string">"<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>"</span>)  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  åˆ†æä»¥ä¸‹ç…§ç‰‡ï¼Œå»ºè®®å“ªäº›å¯ä»¥åˆ é™¤ä»¥é‡Šæ”¾å­˜å‚¨ç©ºé—´ï¼š  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-subst">\(photoList)</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  è€ƒè™‘å› ç´ ï¼š  
Â  Â  Â  Â  1. ç…§ç‰‡è´¨é‡ï¼ˆæ¨¡ç³Šã€è¿‡æ›ã€æ¬ æ›ï¼‰  
Â  Â  Â  Â  2. é‡å¤ç…§ç‰‡  
Â  Â  Â  Â  3. æˆªå›¾å’Œä¸´æ—¶ç…§ç‰‡  
Â  Â  Â  Â  4. ç”¨æˆ·å¯èƒ½ä¸éœ€è¦çš„ç…§ç‰‡  
Â  Â  """</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  generating: <span class="hljs-type">CleanupSuggestion</span>.<span class="hljs-keyword">self</span>  
Â  Â  )  
Â  Â Â   
Â  Â  <span class="hljs-keyword">return</span> response.content  
}  
</code></pre>
<hr/>
<h2 data-id="heading-43">ğŸ’¡ ç¬¬å››éƒ¨åˆ†ï¼šå®é™…ç¼–ç å®è·µå’Œæœ€ä½³å®è·µÂ </h2>
<h3 data-id="heading-44">4.1 ä»é›¶å¼€å§‹ï¼šå®é™…å¼€å‘æµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([å¼€å§‹é›†æˆFoundation Models]) --&gt; Step1[æ­¥éª¤1: æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§&lt;br/&gt;SystemLanguageModel.default]  
Â  Â  Step1 --&gt; Check{æ¨¡å‹å¯ç”¨?}  
Â  Â  Check --&gt;|å¦| Error[æ˜¾ç¤ºé”™è¯¯æç¤º&lt;br/&gt;æä¾›é™çº§æ–¹æ¡ˆ]  
Â  Â  Check --&gt;|æ˜¯| Step2[æ­¥éª¤2: åˆ›å»ºSessionç®¡ç†å™¨&lt;br/&gt;PhotoAISessionManager]  
Â  Â  Step2 --&gt; Step3[æ­¥éª¤3: é›†æˆåˆ°ViewModel&lt;br/&gt;PhotoAnalysisViewModel]  
Â  Â  Step3 --&gt; Step4[æ­¥éª¤4: åœ¨SwiftUIä¸­ä½¿ç”¨&lt;br/&gt;PhotoAnalysisView]  
Â  Â  Step4 --&gt; Success([å®Œæˆé›†æˆ])  
Â  Â  Error --&gt; End([ç»“æŸ])  
Â  Â  Success --&gt; End  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Step1 fill:#5AC8FA,color:#000  
Â  Â  style Step2 fill:#5AC8FA,color:#000  
Â  Â  style Step3 fill:#5AC8FA,color:#000  
Â  Â  style Step4 fill:#5AC8FA,color:#000  
Â  Â  style Check fill:#FF9500,color:#fff  
Â  Â  style Error fill:#FF3B30,color:#fff  
Â  Â  style Success fill:#34C759,color:#fff  
</code></pre>
<h4 data-id="heading-45">æ­¥éª¤1: æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> FoundationModels

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FoundationModelsManager</span> {  
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> shared <span class="hljs-operator">=</span> <span class="hljs-type">FoundationModelsManager</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">init</span>() {}  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ£€æŸ¥Foundation Modelsæ˜¯å¦å¯ç”¨  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">checkAvailability</span>() -&gt; (available: <span class="hljs-type">Bool</span>, reason: <span class="hljs-type">String</span>?) {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-type">SystemLanguageModel</span>.default  
Â  Â  Â  Â  <span class="hljs-keyword">switch</span> model.availability {  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .available:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> (<span class="hljs-literal">true</span>, <span class="hljs-literal">nil</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .unavailable(<span class="hljs-keyword">let</span> reason):  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>, reason.localizedDescription)  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// åœ¨åº”ç”¨å¯åŠ¨æ—¶æ£€æŸ¥å¹¶é¢„çƒ­  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">setup</span>() <span class="hljs-keyword">async</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> (available, reason) <span class="hljs-operator">=</span> checkAvailability()  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-operator">!</span>available {  
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ Foundation Modelsä¸å¯ç”¨: <span class="hljs-subst">\(reason <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥åŸå› "</span>)</span>"</span>)  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// é¢„çƒ­æ¨¡å‹ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰  </span>
Â  Â  Â  Â  <span class="hljs-keyword">await</span> prewarmModel()  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">prewarmModel</span>() <span class="hljs-keyword">async</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"Hello"</span>)  
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… Foundation Modelsé¢„çƒ­æˆåŠŸ"</span>)  
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ æ¨¡å‹é¢„çƒ­å¤±è´¥: <span class="hljs-subst">\(error)</span>"</span>)  
Â  Â  Â  Â  }  
Â  Â  }  
}

<span class="hljs-comment">// åœ¨Appå¯åŠ¨æ—¶è°ƒç”¨  </span>
<span class="hljs-keyword">@main</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyApp</span>: <span class="hljs-title class_">App</span> {  
Â  Â  <span class="hljs-keyword">init</span>() {  
Â  Â  Â  Â  <span class="hljs-type">Task</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">FoundationModelsManager</span>.shared.setup()  
Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-46">æ­¥éª¤2: åˆ›å»ºå¯å¤ç”¨çš„Sessionç®¡ç†å™¨</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram  
Â  Â  class PhotoAISessionManager {  
Â  Â  Â  Â  -LanguageModelSession session  
Â  Â  Â  Â  -[Tool] tools  
Â  Â  Â  Â  +sendMessage(String) String  
Â  Â  Â  Â  +streamMessage(String) AsyncStream  
Â  Â  Â  Â  +generateStructured(T) T  
Â  Â  Â  Â  +reset()  
Â  Â  }  
Â  Â Â   
Â  Â  class LanguageModelSession {  
Â  Â  Â  Â  +respond(Prompt) Response  
Â  Â  Â  Â  +streamResponse(Prompt) AsyncStream  
Â  Â  Â  Â  +transcript Transcript  
Â  Â  }  
Â  Â Â   
Â  Â  class PhotoSearchTool {  
Â  Â  Â  Â  +name: String  
Â  Â  Â  Â  +description: String  
Â  Â  Â  Â  +call(Arguments) Output  
Â  Â  }  
Â  Â Â   
Â  Â  class PhotoAnalysisTool {  
Â  Â  Â  Â  +name: String  
Â  Â  Â  Â  +description: String  
Â  Â  Â  Â  +call(Arguments) Output  
Â  Â  }  
Â  Â Â   
Â  Â  PhotoAISessionManager --&gt; LanguageModelSession  
Â  Â  PhotoAISessionManager --&gt; PhotoSearchTool  
Â  Â  PhotoAISessionManager --&gt; PhotoAnalysisTool  
</code></pre>
<p><strong>å®Œæ•´å®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> FoundationModels  
<span class="hljs-keyword">import</span> Observation

<span class="hljs-meta">@Observable</span>  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PhotoAISessionManager</span> {  
Â  Â  <span class="hljs-keyword">private(set)</span> <span class="hljs-keyword">var</span> session: <span class="hljs-type">LanguageModelSession</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> tools: [<span class="hljs-keyword">any</span> <span class="hljs-type">Tool</span>]  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>() {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.tools <span class="hljs-operator">=</span> [  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">PhotoSearchTool</span>(),  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">PhotoAnalysisTool</span>(),  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">AlbumCreationTool</span>()  
Â  Â  Â  Â  ]  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  Â  Â  Â  Â  tools: tools,  
Â  Â  Â  Â  Â  Â  instructions: <span class="hljs-type">Instructions</span>(<span class="hljs-string">"""  
Â  Â  Â  Â  Â  Â  Â  Â  ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½ç›¸å†ŒåŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  1. æœç´¢ç…§ç‰‡ï¼ˆä½¿ç”¨searchPhotoså·¥å…·ï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â  2. åˆ†æç…§ç‰‡å†…å®¹ï¼ˆä½¿ç”¨analyzePhotoå·¥å…·ï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â  3. åˆ›å»ºç›¸å†Œï¼ˆä½¿ç”¨createAlbumå·¥å…·ï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  Â  Â  å§‹ç»ˆç”¨å‹å¥½ã€è‡ªç„¶çš„æ–¹å¼ä¸ç”¨æˆ·äº¤æµã€‚  
Â  Â  Â  Â  Â  Â  """</span>)  
Â  Â  Â  Â  )  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">message</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-type">Prompt</span>(message))  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">streamMessage</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">message</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">AsyncThrowingStream</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Error</span>&gt; {  
Â  Â  Â  Â  <span class="hljs-type">AsyncThrowingStream</span> { continuation <span class="hljs-keyword">in</span>  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">Task</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> stream <span class="hljs-operator">=</span> session.streamResponse(to: <span class="hljs-type">Prompt</span>(message))  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">for</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> partialText <span class="hljs-keyword">in</span> stream {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continuation.yield(partialText)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continuation.finish()  
Â  Â  Â  Â  Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continuation.finish(throwing: error)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">generateStructured</span>&lt;<span class="hljs-type">T</span>: <span class="hljs-type">Generable</span>&gt;(  
Â  Â  Â  Â  <span class="hljs-params">prompt</span>: <span class="hljs-type">String</span>,  
Â  Â  Â  Â  <span class="hljs-params">type</span>: <span class="hljs-type">T</span>.<span class="hljs-keyword">Type</span>  
Â  Â  ) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">T</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  Â  Â  generating: type  
Â  Â  Â  Â  )  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">reset</span>() {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  Â  Â  Â  Â  tools: tools,  
Â  Â  Â  Â  Â  Â  instructions: <span class="hljs-type">Instructions</span>(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½ç›¸å†ŒåŠ©æ‰‹"</span>)  
Â  Â  Â  Â  )  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-47">æ­¥éª¤3: é›†æˆåˆ°ViewModel</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB  
Â  Â  subgraph "View Layer"  
Â  Â  Â  Â  View[PhotoAnalysisView&lt;br/&gt;SwiftUI View]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "ViewModel Layer"  
Â  Â  Â  Â  ViewModel[PhotoAnalysisViewModel&lt;br/&gt;@Observable]  
Â  Â  Â  Â  SessionManager[PhotoAISessionManager]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "Model Layer"  
Â  Â  Â  Â  Model[Photo Model]  
Â  Â  Â  Â  FoundationModels[Foundation Models]  
Â  Â  end  
Â  Â Â   
Â  Â  View --&gt;|@State| ViewModel  
Â  Â  ViewModel --&gt;|è°ƒç”¨| SessionManager  
Â  Â  SessionManager --&gt;|ä½¿ç”¨| FoundationModels  
Â  Â  ViewModel --&gt;|æ“ä½œ| Model  
Â  Â  Model --&gt;|æ›´æ–°| ViewModel  
Â  Â  ViewModel --&gt;|é€šçŸ¥| View  
Â  Â Â   
Â  Â  style View fill:#007AFF,color:#fff  
Â  Â  style ViewModel fill:#5AC8FA,color:#000  
Â  Â  style SessionManager fill:#FF9500,color:#fff  
Â  Â  style Model fill:#34C759,color:#fff  
Â  Â  style FoundationModels fill:#FF3B30,color:#fff  
</code></pre>
<p><strong>ViewModelå®ç°</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Observable</span>  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PhotoAnalysisViewModel</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> sessionManager <span class="hljs-operator">=</span> <span class="hljs-type">PhotoAISessionManager</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  <span class="hljs-keyword">var</span> errorMessage: <span class="hljs-type">String</span>?  
Â  Â  <span class="hljs-keyword">var</span> analysisResult: <span class="hljs-type">PhotoDescription</span>?  
Â  Â  <span class="hljs-keyword">var</span> streamingText <span class="hljs-operator">=</span> <span class="hljs-string">""</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhoto</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> {  
Â  Â  Â  Â  isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>  
Â  Â  Â  Â  errorMessage <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> metadata <span class="hljs-operator">=</span> photo.metadata  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  Â  Â  Â  Â  åˆ†æè¿™å¼ ç…§ç‰‡ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  - æ—¶é—´: <span class="hljs-subst">\(metadata.date)</span>  
Â  Â  Â  Â  Â  Â  Â  Â  - åœ°ç‚¹: <span class="hljs-subst">\(metadata.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  Â  Â  Â  Â  - EXIF: <span class="hljs-subst">\(metadata.exifInfo)</span>  
Â  Â  Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  Â  Â  è¯·ç”Ÿæˆè¯¦ç»†çš„ç…§ç‰‡æè¿°å’Œåˆ†ç±»å»ºè®®ã€‚  
Â  Â  Â  Â  Â  Â  """</span>  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> sessionManager.generateStructured(  
Â  Â  Â  Â  Â  Â  Â  Â  prompt: prompt,  
Â  Â  Â  Â  Â  Â  Â  Â  type: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  Â  Â  Â  Â  )  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.analysisResult <span class="hljs-operator">=</span> result  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.errorMessage <span class="hljs-operator">=</span> handleError(error)  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhotoWithStreaming</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> {  
Â  Â  Â  Â  isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>  
Â  Â  Â  Â  streamingText <span class="hljs-operator">=</span> <span class="hljs-string">""</span>  
Â  Â  Â  Â  errorMessage <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> metadata <span class="hljs-operator">=</span> photo.metadata  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  Â  Â  Â  Â  åˆ†æè¿™å¼ ç…§ç‰‡ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  - æ—¶é—´: <span class="hljs-subst">\(metadata.date)</span>  
Â  Â  Â  Â  Â  Â  Â  Â  - åœ°ç‚¹: <span class="hljs-subst">\(metadata.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  Â  Â  è¯·è¯¦ç»†åˆ†æç…§ç‰‡å†…å®¹ã€‚  
Â  Â  Â  Â  Â  Â  """</span>  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">for</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> partialText <span class="hljs-keyword">in</span> sessionManager.streamMessage(prompt) {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.streamingText <span class="hljs-operator">+=</span> partialText  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.errorMessage <span class="hljs-operator">=</span> handleError(error)  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">handleError</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">error</span>: <span class="hljs-type">Error</span>) -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> generationError <span class="hljs-operator">=</span> error <span class="hljs-keyword">as?</span> <span class="hljs-type">LanguageModelSession</span>.<span class="hljs-type">GenerationError</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">switch</span> generationError {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">case</span> .exceededContextWindowSize:  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œè¯·æ¸…ç†å†å²è®°å½•"</span>  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">default</span>:  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”Ÿæˆå¤±è´¥: <span class="hljs-subst">\(generationError.localizedDescription)</span>"</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"é”™è¯¯: <span class="hljs-subst">\(error.localizedDescription)</span>"</span>  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-48">æ­¥éª¤4: åœ¨SwiftUIä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> SwiftUI

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoAnalysisView</span>: <span class="hljs-title class_">View</span> {  
Â  Â  <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">PhotoAnalysisViewModel</span>()  
Â  Â  <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhoto: <span class="hljs-type">Photo</span>?  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {  
Â  Â  Â  Â  <span class="hljs-type">VStack</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> viewModel.isLoading {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">ProgressView</span>(<span class="hljs-string">"åˆ†æä¸­..."</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .padding()  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> viewModel.errorMessage {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Text</span>(<span class="hljs-string">"é”™è¯¯: <span class="hljs-subst">\(error)</span>"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .foregroundColor(.red)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .padding()  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> viewModel.analysisResult {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">VStack</span>(alignment: .leading, spacing: <span class="hljs-number">12</span>) {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Text</span>(<span class="hljs-string">"ä¸»é¢˜: <span class="hljs-subst">\(result.subject)</span>"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Text</span>(<span class="hljs-string">"è´¨é‡è¯„åˆ†: <span class="hljs-subst">\(result.qualityScore)</span>/10"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Text</span>(<span class="hljs-string">"æ ‡ç­¾: <span class="hljs-subst">\(result.tags.joined(separator: <span class="hljs-string">", "</span>))</span>"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â  .padding()  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-operator">!</span>viewModel.streamingText.isEmpty {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">ScrollView</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Text</span>(viewModel.streamingText)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .padding()  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-type">Button</span>(<span class="hljs-string">"åˆ†æç…§ç‰‡"</span>) {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> photo <span class="hljs-operator">=</span> selectedPhoto {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">Task</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> viewModel.analyzePhoto(photo)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  .disabled(viewModel.isLoading <span class="hljs-operator">||</span> selectedPhoto <span class="hljs-operator">==</span> <span class="hljs-literal">nil</span>)  
Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<h3 data-id="heading-49">4.2 æ€§èƒ½ä¼˜åŒ–å®è·µ</h3>
<h4 data-id="heading-50">å†…å­˜æ¶ˆè€—ä¸æ€§èƒ½ç‰¹å¾</h4>
<p><strong>å®é™…å†…å­˜å ç”¨</strong>:</p>
<p>æ ¹æ®å®é™…æµ‹è¯•ï¼ŒFoundation Models åœ¨è¿è¡Œæ—¶çš„å†…å­˜æ¶ˆè€—åŒ…æ‹¬ï¼š</p>






























<table><thead><tr><th>ç»„ä»¶</th><th>å†…å­˜å ç”¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ¨¡å‹æƒé‡</td><td>~750MB</td><td>3B å‚æ•° Ã— 2-bit é‡åŒ–</td></tr><tr><td>KV Cache</td><td>~300-600MB</td><td>8-bit é‡åŒ–ï¼Œ37.5% å‡å°‘ä¼˜åŒ–</td></tr><tr><td>æ¡†æ¶å¼€é”€</td><td>~100-200MB</td><td>ç³»ç»Ÿæ¡†æ¶å’Œè¿è¡Œæ—¶å¼€é”€</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>~1.0-1.5GB</strong></td><td>å®é™…è¿è¡Œæ—¶å†…å­˜å ç”¨</td></tr></tbody></table>
<p><strong>å†…å­˜ç®¡ç†å»ºè®®</strong>:</p>
<ul>
<li>åœ¨å†…å­˜å—é™çš„è®¾å¤‡ä¸Šï¼Œéœ€è¦ä»”ç»†è€ƒè™‘ä½•æ—¶åŠ è½½å’Œé‡Šæ”¾ session</li>
<li>å¥½æ¶ˆæ¯æ˜¯è‹¹æœåšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚ KV cache çš„ 8-bit é‡åŒ–å’Œ 37.5% çš„ block sharing å‡å°‘</li>
<li>base æ¨¡å‹æœ¬èº«ä¼¼ä¹åœ¨ä¸ç”¨æ—¶ä¹Ÿä¼šè‡ªåŠ¨ unload</li>
</ul>
<p><strong>æ€§èƒ½ç‰¹å¾</strong>:</p>























<table><thead><tr><th>åœºæ™¯</th><th>iPhone</th><th>M2 Pro</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å• session</td><td>10-30 tokens/s</td><td>~30 tokens/s</td><td>æ­£å¸¸æ€§èƒ½</td></tr><tr><td>3 ä¸ªå¹¶å‘ session</td><td><strong>æ¯ä¸ªçº¦ 1 token/s</strong></td><td><strong>æ¯ä¸ªçº¦ 1 token/s</strong></td><td>âš ï¸ ä¸¥é‡æ€§èƒ½ä¸‹é™</td></tr></tbody></table>
<p><strong>âš ï¸ å¹¶å‘æ€§èƒ½è­¦å‘Š</strong>: å¤š session å¹¶å‘ä¼šä¸¥é‡å½±å“æ€§èƒ½ï¼Œä» 10-30 tokens/s éª¤é™è‡³çº¦ 1 token/sã€‚è‹¹æœåªè€ƒè™‘äº†å• session çš„ä½¿ç”¨åœºæ™¯ã€‚</p>
<p><strong>æ¨èåšæ³•</strong>: å…¨å±€ç®¡ç†<strong>ä¸€ä¸ª session</strong>ï¼Œä½¿ç”¨é˜Ÿåˆ—ä¸²è¡Œè®¿é—®ï¼Œé¿å…ä»»ä½•å¹¶å‘ sessionã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨é˜Ÿåˆ—ç®¡ç†è¯·æ±‚  </span>
<span class="hljs-keyword">actor</span> <span class="hljs-title class_">SessionManager</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> requestQueue: [<span class="hljs-type">AIRequest</span>] <span class="hljs-operator">=</span> []  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">processRequest</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">request</span>: <span class="hljs-type">AIRequest</span>) <span class="hljs-keyword">async</span> -&gt; <span class="hljs-type">AIResponse</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// ä¸²è¡Œå¤„ç†ï¼Œä¸è¦å¹¶å‘  </span>
Â  Â  Â  Â  <span class="hljs-comment">// ä½¿ç”¨é˜Ÿåˆ—ç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¯·æ±‚åœ¨ä½¿ç”¨ session  </span>
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-51">ä¸Šä¸‹æ–‡çª—å£ç®¡ç†</h4>
<p><strong>âš ï¸ é‡è¦é™åˆ¶</strong>: è™½ç„¶è‹¹æœæåˆ°æ¨¡å‹è®­ç»ƒæ—¶æ”¯æŒæœ€é«˜ 65K tokens çš„ä¸Šä¸‹æ–‡ï¼Œä½†<strong>å®é™…éƒ¨ç½²åˆ°ç”¨æˆ·è®¾å¤‡ä¸Šçš„ç¡¬é™åˆ¶æ˜¯ 4096 tokens</strong>ã€‚è¿™å¯¹äºä¸€èˆ¬çš„å¯¹è¯åœºæ™¯ï¼Œå¤§çº¦èƒ½æ”¯æŒ 10-20 è½®å¯¹è¯ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([å¼€å§‹å¯¹è¯]) --&gt; Check{Tokenä½¿ç”¨é‡&lt;br/&gt;æ£€æŸ¥}  
Â  Â  Check --&gt;|å°äº80%| Normal[æ­£å¸¸ä½¿ç”¨]  
Â  Â  Check --&gt;|è¾¾åˆ°80%| Clean[æ¸…ç†æ—§å¯¹è¯]  
Â  Â  Normal --&gt; Continue[ç»§ç»­å¯¹è¯]  
Â  Â  Clean --&gt; Keep[ä¿ç•™æœ€è¿‘å¯¹è¯&lt;br/&gt;çº¦3000 tokens]  
Â  Â  Keep --&gt; Continue  
Â  Â  Continue --&gt; Check  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Check fill:#FF9500,color:#fff  
Â  Â  style Normal fill:#34C759,color:#fff  
Â  Â  style Clean fill:#FF3B30,color:#fff  
Â  Â  style Keep fill:#5AC8FA,color:#000  
</code></pre>
<p><strong>å®ç°ä»£ç </strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedChatViewModel</span>: <span class="hljs-title class_">ObservableObject</span> {  
Â  Â  <span class="hljs-comment">// âš ï¸ å®é™…é™åˆ¶æ˜¯ 4096 tokensï¼Œä¸æ˜¯ 65K  </span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> maxTokens <span class="hljs-operator">=</span> <span class="hljs-number">4096</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> windowThreshold <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span> <span class="hljs-comment">// 80%æ—¶å¼€å§‹æ¸…ç†  </span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> targetWindowSize <span class="hljs-operator">=</span> <span class="hljs-number">3000</span> <span class="hljs-comment">// ç›®æ ‡çª—å£å¤§å°ï¼ˆä¿ç•™ä¸€äº›ä½™é‡ï¼‰  </span>
Â  Â Â   
Â  Â  <span class="hljs-keyword">private(set)</span> <span class="hljs-keyword">var</span> session: <span class="hljs-type">LanguageModelSession</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>() {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">shouldApplySlidingWindow</span>() -&gt; <span class="hljs-type">Bool</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> currentTokens <span class="hljs-operator">=</span> session.transcript.estimatedTokenCount  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> ratio <span class="hljs-operator">=</span> <span class="hljs-type">Double</span>(currentTokens) <span class="hljs-operator">/</span> <span class="hljs-type">Double</span>(maxTokens)  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> ratio <span class="hljs-operator">&gt;=</span> windowThreshold  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-meta">@MainActor</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">applySlidingWindow</span>() <span class="hljs-keyword">async</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> recentEntries <span class="hljs-operator">=</span> session.transcript.entriesWithinTokenBudget(  
Â  Â  Â  Â  Â  Â  targetWindowSize: targetWindowSize  
Â  Â  Â  Â  )  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">var</span> finalEntries <span class="hljs-operator">=</span> recentEntries  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> instructions <span class="hljs-operator">=</span> session.transcript.first(where: {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">case</span> .instructions <span class="hljs-operator">=</span> <span class="hljs-variable">$0</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> }  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>  
Â  Â  Â  Â  }) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-operator">!</span>finalEntries.contains(where: { <span class="hljs-variable">$0</span>.id <span class="hljs-operator">==</span> instructions.id }) {  
Â  Â  Â  Â  Â  Â  Â  Â  finalEntries.insert(instructions, at: <span class="hljs-number">0</span>)  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  Â  Â  Â  Â  transcript: <span class="hljs-type">Transcript</span>(entries: finalEntries)  
Â  Â  Â  Â  )  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-meta">@MainActor</span>  
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">message</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> shouldApplySlidingWindow() {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> applySlidingWindow()  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">let</span> stream <span class="hljs-operator">=</span> session.streamResponse(to: <span class="hljs-type">Prompt</span>(message))  
Â  Â  Â  Â  <span class="hljs-keyword">for</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span> stream {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æµå¼å“åº”è‡ªåŠ¨æ›´æ–°transcript  </span>
Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<h4 data-id="heading-52">é¢„åŠ è½½å’Œé¢„çƒ­ï¼ˆPrewarmingï¼‰</h4>
<p><strong>é¢„çƒ­ï¼ˆPrewarmingï¼‰</strong> æ˜¯åœ¨ç”¨æˆ·å‘å‡ºè¯·æ±‚ä¹‹å‰ï¼Œæå‰åŠ è½½å’Œåˆå§‹åŒ–è®¾å¤‡ä¸Šçš„è¯­è¨€æ¨¡å‹ï¼Œä»è€Œå‡å°‘åˆå§‹å»¶è¿Ÿçš„å…³é”®ä¼˜åŒ–æŠ€æœ¯ã€‚</p>
<h5 data-id="heading-53">é¢„çƒ­çš„å·¥ä½œåŸç†</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  subgraph NoPrewarm [æ— é¢„çƒ­åœºæ™¯]  
Â  Â  Â  Â  User1[ç”¨æˆ·è¯·æ±‚] --&gt; Load1[åŠ è½½æ¨¡å‹ è€—æ—¶ 2-3ç§’]  
Â  Â  Â  Â  Load1 --&gt; Init1[åˆå§‹åŒ–æ¨¡å‹ è€—æ—¶ 0.5-1ç§’]  
Â  Â  Â  Â  Init1 --&gt; Inference1[æ‰§è¡Œæ¨ç† è€—æ—¶ 1-2ç§’]  
Â  Â  Â  Â  Inference1 --&gt; Response1[è¿”å›ç»“æœ æ€»è€—æ—¶ 3.5-6ç§’]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph WithPrewarm [é¢„çƒ­åœºæ™¯]  
Â  Â  Â  Â  Trigger[è§¦å‘é¢„çƒ­ ç”¨æˆ·æ‰“å¼€é¡µé¢æˆ–ç‚¹å‡»è¾“å…¥æ¡†] --&gt; Load2[åå°åŠ è½½æ¨¡å‹ ç”¨æˆ·æ— æ„ŸçŸ¥]  
Â  Â  Â  Â  Load2 --&gt; Init2[åå°åˆå§‹åŒ–æ¨¡å‹ ç”¨æˆ·æ— æ„ŸçŸ¥]  
Â  Â  Â  Â  Init2 --&gt; Ready[æ¨¡å‹å‡†å¤‡å°±ç»ª ä¿æŒåœ¨å†…å­˜ä¸­]  
Â  Â  Â  Â  User2[ç”¨æˆ·è¯·æ±‚] --&gt; Inference2[ç«‹å³æ‰§è¡Œæ¨ç† è€—æ—¶ 1-2ç§’]  
Â  Â  Â  Â  Inference2 --&gt; Response2[è¿”å›ç»“æœ æ€»è€—æ—¶ 1-2ç§’]  
Â  Â  end  
Â  Â Â   
Â  Â  style User1 fill:#FF3B30,color:#fff  
Â  Â  style Load1 fill:#FF3B30,color:#fff  
Â  Â  style Response1 fill:#FF3B30,color:#fff  
Â  Â  style Trigger fill:#5AC8FA,color:#000  
Â  Â  style Ready fill:#34C759,color:#fff  
Â  Â  style User2 fill:#007AFF,color:#fff  
Â  Â  style Response2 fill:#34C759,color:#fff  
</code></pre>
<p><strong>é¢„çƒ­çš„æ ¸å¿ƒä»·å€¼</strong>:</p>
<ul>
<li>âœ… <strong>å‡å°‘é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ</strong>: ä» 3-6 ç§’é™ä½åˆ° 1-2 ç§’</li>
<li>âœ… <strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>: ç”¨æˆ·å‡ ä¹æ— æ„ŸçŸ¥çš„ç­‰å¾…æ—¶é—´</li>
<li>âœ… <strong>ä¼˜åŒ–èµ„æºåˆ©ç”¨</strong>: åœ¨ç”¨æˆ·ç©ºé—²æ—¶æå‰å‡†å¤‡ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li>
</ul>
<h5 data-id="heading-54">é¢„çƒ­çš„æœ€ä½³æ—¶æœº</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  AppStart[åº”ç”¨å¯åŠ¨] --&gt; Check1{æ˜¯å¦æ”¯æŒ Foundation Models?}  
Â  Â  Check1 --&gt;|æ˜¯| Prewarm1[åå°é¢„çƒ­ ä½ä¼˜å…ˆçº§]  
Â  Â  Check1 --&gt;|å¦| Skip1[è·³è¿‡é¢„çƒ­]  
Â  Â Â   
Â  Â  UserEnter[ç”¨æˆ·è¿›å…¥AIåŠŸèƒ½é¡µé¢] --&gt; Prewarm2[ç«‹å³é¢„çƒ­ ä¸­ä¼˜å…ˆçº§]  
Â  Â Â   
Â  Â  UserClick[ç”¨æˆ·ç‚¹å‡»è¾“å…¥æ¡†] --&gt; Prewarm3[å¿«é€Ÿé¢„çƒ­ é«˜ä¼˜å…ˆçº§]  
Â  Â Â   
Â  Â  Prewarm1 --&gt; Ready[æ¨¡å‹å‡†å¤‡å°±ç»ª]  
Â  Â  Prewarm2 --&gt; Ready  
Â  Â  Prewarm3 --&gt; Ready  
Â  Â Â   
Â  Â  Ready --&gt; UserRequest[ç”¨æˆ·å‘èµ·è¯·æ±‚]  
Â  Â  UserRequest --&gt; FastResponse[å¿«é€Ÿå“åº”]  
Â  Â Â   
Â  Â  style AppStart fill:#007AFF,color:#fff  
Â  Â  style UserEnter fill:#5AC8FA,color:#000  
Â  Â  style UserClick fill:#FF9500,color:#fff  
Â  Â  style Prewarm1 fill:#34C759,color:#fff  
Â  Â  style Prewarm2 fill:#34C759,color:#fff  
Â  Â  style Prewarm3 fill:#34C759,color:#fff  
Â  Â  style Ready fill:#AF52DE,color:#fff  
Â  Â  style FastResponse fill:#34C759,color:#fff  
</code></pre>
<p><strong>é¢„çƒ­æ—¶æœºä¼˜å…ˆçº§</strong>:</p>
<ol>
<li>
<p><strong>åº”ç”¨å¯åŠ¨æ—¶</strong>ï¼ˆä½ä¼˜å…ˆçº§ï¼‰<br/>
- ä¼˜ç‚¹ï¼šæœ€æ—©å‡†å¤‡ï¼Œç”¨æˆ·é¦–æ¬¡ä½¿ç”¨å³å¯å¿«é€Ÿå“åº”<br/>
- ç¼ºç‚¹ï¼šå¯èƒ½å½±å“åº”ç”¨å¯åŠ¨é€Ÿåº¦<br/>
- å»ºè®®ï¼šåœ¨åå°ä½ä¼˜å…ˆçº§çº¿ç¨‹é¢„çƒ­ï¼Œä¸å½±å“å¯åŠ¨</p>
</li>
<li>
<p><strong>ç”¨æˆ·è¿›å…¥AIåŠŸèƒ½é¡µé¢æ—¶</strong>ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰<br/>
- ä¼˜ç‚¹ï¼šç”¨æˆ·æ˜ç¡®æ„å›¾ï¼Œé¢„çƒ­ä»·å€¼é«˜<br/>
- ç¼ºç‚¹ï¼šå¦‚æœç”¨æˆ·ä¸å®é™…ä½¿ç”¨ï¼Œæµªè´¹èµ„æº<br/>
- å»ºè®®ï¼šåœ¨é¡µé¢å‡ºç°æ—¶ç«‹å³é¢„çƒ­</p>
</li>
<li>
<p><strong>ç”¨æˆ·ç‚¹å‡»è¾“å…¥æ¡†æ—¶</strong>ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰<br/>
- ä¼˜ç‚¹ï¼šç”¨æˆ·å³å°†ä½¿ç”¨ï¼Œé¢„çƒ­æœ€åŠæ—¶<br/>
- ç¼ºç‚¹ï¼šå¯èƒ½æ¥ä¸åŠå®Œå…¨é¢„çƒ­<br/>
- å»ºè®®ï¼šå¿«é€Ÿé¢„çƒ­ï¼Œè‡³å°‘å®ŒæˆåŸºç¡€åˆå§‹åŒ–</p>
</li>
</ol>
<h5 data-id="heading-55">åŸºç¡€é¢„çƒ­å®ç°</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelPrewarmer</span> {  
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> shared <span class="hljs-operator">=</span> <span class="hljs-type">ModelPrewarmer</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isPrewarmed <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> prewarmingTask: <span class="hljs-type">Task</span>&lt;<span class="hljs-type">Void</span>, <span class="hljs-type">Never</span>&gt;?  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> prewarmQueue <span class="hljs-operator">=</span> <span class="hljs-type">DispatchQueue</span>(label: <span class="hljs-string">"com.app.prewarm"</span>, qos: .utility)  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// é¢„çƒ­æ¨¡å‹ï¼ˆåŸºç¡€ç‰ˆæœ¬ï¼‰  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">prewarm</span>() {  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-operator">!</span>isPrewarmed <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  prewarmQueue.async {  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">Task</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// å‘é€ä¸€ä¸ªç®€å•çš„è¯·æ±‚æ¥é¢„çƒ­æ¨¡å‹  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"Hello"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isPrewarmed <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… æ¨¡å‹é¢„çƒ­æˆåŠŸ"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ æ¨¡å‹é¢„çƒ­å¤±è´¥: <span class="hljs-subst">\(error)</span>"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ£€æŸ¥é¢„çƒ­çŠ¶æ€  </span>
Â  Â  <span class="hljs-keyword">var</span> isReady: <span class="hljs-type">Bool</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> isPrewarmed  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-56">æ™ºèƒ½é¢„çƒ­å®ç°ï¼ˆå¤šæ—¶æœºæ”¯æŒï¼‰</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">PrewarmPriority</span> {  
Â  Â  <span class="hljs-keyword">case</span> low Â  Â  Â <span class="hljs-comment">// åº”ç”¨å¯åŠ¨æ—¶  </span>
Â  Â  <span class="hljs-keyword">case</span> medium Â  <span class="hljs-comment">// è¿›å…¥åŠŸèƒ½é¡µé¢æ—¶  </span>
Â  Â  <span class="hljs-keyword">case</span> high Â  Â  <span class="hljs-comment">// ç”¨æˆ·ç‚¹å‡»è¾“å…¥æ¡†æ—¶  </span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartModelPrewarmer</span> {  
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> shared <span class="hljs-operator">=</span> <span class="hljs-type">SmartModelPrewarmer</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isPrewarmed <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> prewarmingTask: <span class="hljs-type">Task</span>&lt;<span class="hljs-type">Void</span>, <span class="hljs-type">Never</span>&gt;?  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> prewarmStartTime: <span class="hljs-type">Date</span>?  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ™ºèƒ½é¢„çƒ­ï¼šæ ¹æ®ä¼˜å…ˆçº§å’Œæ—¶æœºå†³å®šæ˜¯å¦é¢„çƒ­  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">prewarm</span>(<span class="hljs-params">priority</span>: <span class="hljs-type">PrewarmPriority</span> <span class="hljs-operator">=</span> .medium) {  
Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœå·²ç»é¢„çƒ­ï¼Œç›´æ¥è¿”å›  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> isPrewarmed {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœæ­£åœ¨é¢„çƒ­ï¼Œæ£€æŸ¥ä¼˜å…ˆçº§  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> task <span class="hljs-operator">=</span> prewarmingTask, <span class="hljs-operator">!</span>task.isCancelled {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// é«˜ä¼˜å…ˆçº§å¯ä»¥å–æ¶ˆä½ä¼˜å…ˆçº§é¢„çƒ­ï¼Œé‡æ–°å¼€å§‹  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> priority <span class="hljs-operator">==</span> .high {  
Â  Â  Â  Â  Â  Â  Â  Â  task.cancel()  
Â  Â  Â  Â  Â  Â  } <span class="hljs-keyword">else</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// æ ¹æ®ä¼˜å…ˆçº§è®¾ç½® QoS  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> qos: <span class="hljs-type">TaskPriority</span> <span class="hljs-operator">=</span> priority <span class="hljs-operator">==</span> .high <span class="hljs-operator">?</span> .userInitiated : .utility  
Â  Â  Â  Â Â   
Â  Â  Â  Â  prewarmStartTime <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()  
Â  Â  Â  Â  prewarmingTask <span class="hljs-operator">=</span> <span class="hljs-type">Task</span>(priority: qos) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æ ¹æ®ä¼˜å…ˆçº§é€‰æ‹©é¢„çƒ­ç­–ç•¥  </span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">switch</span> priority {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">case</span> .high:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// é«˜ä¼˜å…ˆçº§ï¼šå¿«é€Ÿé¢„çƒ­ï¼ŒåªåšåŸºç¡€åˆå§‹åŒ–  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"Hi"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">case</span> .medium:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ä¸­ä¼˜å…ˆçº§ï¼šå®Œæ•´é¢„çƒ­  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"Hello, how can I help you?"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">case</span> .low:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ä½ä¼˜å…ˆçº§ï¼šåå°é¢„çƒ­ï¼Œä¸é˜»å¡  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: <span class="hljs-string">"Hello"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> duration <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>().timeIntervalSince(<span class="hljs-keyword">self</span>.prewarmStartTime <span class="hljs-operator">??</span> <span class="hljs-type">Date</span>())  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.isPrewarmed <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… æ¨¡å‹é¢„çƒ­æˆåŠŸï¼ˆä¼˜å…ˆçº§: <span class="hljs-subst">\(priority)</span>, è€—æ—¶: <span class="hljs-subst">\(String(format: <span class="hljs-string">"%.2f"</span>, duration))</span>ç§’ï¼‰"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ æ¨¡å‹é¢„çƒ­å¤±è´¥: <span class="hljs-subst">\(error)</span>"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// å–æ¶ˆé¢„çƒ­ï¼ˆå¦‚æœç”¨æˆ·ç¦»å¼€é¡µé¢ï¼‰  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">cancelPrewarming</span>() {  
Â  Â  Â  Â  prewarmingTask<span class="hljs-operator">?</span>.cancel()  
Â  Â  Â  Â  prewarmingTask <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-57">åœ¨åº”ç”¨ä¸­çš„é›†æˆ</h5>
<p><strong>åœºæ™¯1: åº”ç”¨å¯åŠ¨æ—¶é¢„çƒ­</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@main</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyApp</span>: <span class="hljs-title class_">App</span> {  
Â  Â  <span class="hljs-keyword">init</span>() {  
Â  Â  Â  Â  <span class="hljs-comment">// åº”ç”¨å¯åŠ¨æ—¶ï¼Œä½ä¼˜å…ˆçº§é¢„çƒ­  </span>
Â  Â  Â  Â  <span class="hljs-type">Task</span>.detached(priority: .utility) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">await</span> <span class="hljs-type">SmartModelPrewarmer</span>.shared.prewarm(priority: .low)  
Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<p><strong>åœºæ™¯2: è¿›å…¥AIåŠŸèƒ½é¡µé¢æ—¶é¢„çƒ­</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoAnalysisView</span>: <span class="hljs-title class_">View</span> {  
Â  Â  <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">PhotoAnalysisViewModel</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {  
Â  Â  Â  Â  <span class="hljs-type">VStack</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// UI å†…å®¹  </span>
Â  Â  Â  Â  }  
Â  Â  Â  Â  .onAppear {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ç”¨æˆ·è¿›å…¥é¡µé¢æ—¶ï¼Œç«‹å³é¢„çƒ­  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-type">SmartModelPrewarmer</span>.shared.prewarm(priority: .medium)  
Â  Â  Â  Â  }  
Â  Â  Â  Â  .onDisappear {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶ï¼Œå¯ä»¥å–æ¶ˆé¢„çƒ­ï¼ˆå¯é€‰ï¼‰  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// SmartModelPrewarmer.shared.cancelPrewarming()  </span>
Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<p><strong>åœºæ™¯3: ç”¨æˆ·ç‚¹å‡»è¾“å…¥æ¡†æ—¶é¢„çƒ­</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ChatInputView</span>: <span class="hljs-title class_">View</span> {  
Â  Â  <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> inputText <span class="hljs-operator">=</span> <span class="hljs-string">""</span>  
Â  Â  <span class="hljs-meta">@FocusState</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isInputFocused: <span class="hljs-type">Bool</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {  
Â  Â  Â  Â  <span class="hljs-type">TextField</span>(<span class="hljs-string">"è¾“å…¥æ¶ˆæ¯..."</span>, text: <span class="hljs-variable">$inputText</span>)  
Â  Â  Â  Â  Â  Â  .focused(<span class="hljs-variable">$isInputFocused</span>)  
Â  Â  Â  Â  Â  Â  .onChange(of: isInputFocused) { focused <span class="hljs-keyword">in</span>  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> focused {  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// ç”¨æˆ·ç‚¹å‡»è¾“å…¥æ¡†æ—¶ï¼Œé«˜ä¼˜å…ˆçº§å¿«é€Ÿé¢„çƒ­  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">SmartModelPrewarmer</span>.shared.prewarm(priority: .high)  
Â  Â  Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â  }  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-58">é¢„çƒ­æ•ˆæœå¯¹æ¯”</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  subgraph NoPrewarm [æ— é¢„çƒ­]  
Â  Â  Â  Â  Request1[ç”¨æˆ·è¯·æ±‚] --&gt; Wait1[ç­‰å¾… 3-6ç§’]  
Â  Â  Â  Â  Wait1 --&gt; Response1[è¿”å›ç»“æœ]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph WithPrewarm [æœ‰é¢„çƒ­]  
Â  Â  Â  Â  Prewarm[æå‰é¢„çƒ­ ç”¨æˆ·æ— æ„ŸçŸ¥] --&gt; Ready[æ¨¡å‹å°±ç»ª]  
Â  Â  Â  Â  Request2[ç”¨æˆ·è¯·æ±‚] --&gt; Wait2[ç­‰å¾… 1-2ç§’]  
Â  Â  Â  Â  Wait2 --&gt; Response2[è¿”å›ç»“æœ]  
Â  Â  end  
Â  Â Â   
Â  Â  style Request1 fill:#FF3B30,color:#fff  
Â  Â  style Wait1 fill:#FF3B30,color:#fff  
Â  Â  style Prewarm fill:#34C759,color:#fff  
Â  Â  style Ready fill:#34C759,color:#fff  
Â  Â  style Request2 fill:#007AFF,color:#fff  
Â  Â  style Wait2 fill:#5AC8FA,color:#000  
Â  Â  style Response2 fill:#34C759,color:#fff  
</code></pre>
<p><strong>æ€§èƒ½æå‡æ•°æ®</strong>ï¼ˆåŸºäº Instruments åˆ†æï¼‰:</p>





























<table><thead><tr><th>åœºæ™¯</th><th>æ— é¢„çƒ­</th><th>æœ‰é¢„çƒ­</th><th>æå‡</th></tr></thead><tbody><tr><td>é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ</td><td>3-6ç§’</td><td>1-2ç§’</td><td><strong>50-70%</strong></td></tr><tr><td>ç”¨æˆ·æ„ŸçŸ¥ç­‰å¾…</td><td>æ˜æ˜¾</td><td>å‡ ä¹æ— æ„ŸçŸ¥</td><td><strong>æ˜¾è‘—æ”¹å–„</strong></td></tr><tr><td>å†…å­˜å ç”¨</td><td>æŒ‰éœ€åŠ è½½</td><td>æå‰å ç”¨</td><td>å¢åŠ çº¦ 200-500MB</td></tr></tbody></table>
<h5 data-id="heading-59">é¢„çƒ­æœ€ä½³å®è·µ</h5>
<p><strong>1. é¢„çƒ­æ—¶æœºé€‰æ‹©</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((é¢„çƒ­æ—¶æœºé€‰æ‹©))  
Â  Â  åº”ç”¨å¯åŠ¨  
Â  Â  Â  ä½ä¼˜å…ˆçº§  
Â  Â  Â  åå°æ‰§è¡Œ  
Â  Â  Â  ä¸å½±å“å¯åŠ¨é€Ÿåº¦  
Â  Â  è¿›å…¥åŠŸèƒ½é¡µé¢  
Â  Â  Â  ä¸­ä¼˜å…ˆçº§  
Â  Â  Â  ç«‹å³æ‰§è¡Œ  
Â  Â  Â  ç”¨æˆ·æ„å›¾æ˜ç¡®  
Â  Â  ç‚¹å‡»è¾“å…¥æ¡†  
Â  Â  Â  é«˜ä¼˜å…ˆçº§  
Â  Â  Â  å¿«é€Ÿé¢„çƒ­  
Â  Â  Â  æœ€åŠæ—¶å“åº”  
Â  Â  é¿å…è¿‡åº¦é¢„çƒ­  
Â  Â  Â  ä¸è¦é¢‘ç¹é¢„çƒ­  
Â  Â  Â  æ£€æŸ¥é¢„çƒ­çŠ¶æ€  
Â  Â  Â  é¿å…èµ„æºæµªè´¹  
</code></pre>
<p><strong>2. é¢„çƒ­ç­–ç•¥å»ºè®®</strong></p>
<ul>
<li>âœ… <strong>æ¸è¿›å¼é¢„çƒ­</strong>: å…ˆåšåŸºç¡€åˆå§‹åŒ–ï¼Œå†é€æ­¥å®Œå–„</li>
<li>âœ… <strong>ä¼˜å…ˆçº§ç®¡ç†</strong>: æ ¹æ®ç”¨æˆ·è¡Œä¸ºè°ƒæ•´é¢„çƒ­ä¼˜å…ˆçº§</li>
<li>âœ… <strong>èµ„æºç›‘æ§</strong>: ä½¿ç”¨ Instruments ç›‘æ§é¢„çƒ­å¯¹å†…å­˜å’Œæ€§èƒ½çš„å½±å“</li>
<li>âœ… <strong>é™çº§å¤„ç†</strong>: å¦‚æœé¢„çƒ­å¤±è´¥ï¼Œæä¾›å‹å¥½çš„é™çº§æ–¹æ¡ˆ</li>
</ul>
<p><strong>3. é¢„çƒ­æ£€æŸ¥æ¸…å•</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦åœ¨åˆé€‚çš„æ—¶æœºè§¦å‘é¢„çƒ­ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é¢„çƒ­æ˜¯å¦å½±å“åº”ç”¨å¯åŠ¨é€Ÿåº¦ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦å¤„ç†äº†é¢„çƒ­å¤±è´¥çš„æƒ…å†µï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦åœ¨ç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶å–æ¶ˆä¸å¿…è¦çš„é¢„çƒ­ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦ä½¿ç”¨ Instruments éªŒè¯é¢„çƒ­æ•ˆæœï¼Ÿ</li>
</ul>
<p><strong>å‚è€ƒèµ„æº</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fzvayivqt0ufji%2Farticle%2Fdetails%2F149374995" target="_blank" title="https://blog.csdn.net/zvayivqt0ufji/article/details/149374995" ref="nofollow noopener noreferrer">CSDN - Foundation Models é¢„çƒ­ä¼˜åŒ–</a></li>
</ul>
<h4 data-id="heading-60">ç¼“å­˜ç­–ç•¥</h4>
<p>ç¼“å­˜ç­–ç•¥æ˜¯ä¼˜åŒ– Foundation Models åº”ç”¨æ€§èƒ½çš„é‡è¦æ‰‹æ®µã€‚åˆç†çš„ç¼“å­˜å¯ä»¥æ˜¾è‘—å‡å°‘é‡å¤è®¡ç®—ï¼Œæå‡å“åº”é€Ÿåº¦ï¼Œé™ä½èµ„æºæ¶ˆè€—ã€‚</p>
<h5 data-id="heading-61">ç¼“å­˜ç­–ç•¥æ¦‚è¿°</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Request[ç”¨æˆ·è¯·æ±‚] --&gt; CheckCache{æ£€æŸ¥ç¼“å­˜}  
Â  Â  CheckCache --&gt;|å‘½ä¸­| ReturnCache[è¿”å›ç¼“å­˜ç»“æœ å¿«é€Ÿå“åº”]  
Â  Â  CheckCache --&gt;|æœªå‘½ä¸­| Generate[è°ƒç”¨ Foundation Models ç”Ÿæˆç»“æœ]  
Â  Â  Generate --&gt; Store[å­˜å‚¨åˆ°ç¼“å­˜]  
Â  Â  Store --&gt; ReturnNew[è¿”å›æ–°ç»“æœ]  
Â  Â Â   
Â  Â  subgraph CacheManagement [ç¼“å­˜ç®¡ç†]  
Â  Â  Â  Â  Store --&gt; Evict{ç¼“å­˜å·²æ»¡?}  
Â  Â  Â  Â  Evict --&gt;|æ˜¯| Strategy[æ‰§è¡Œæ·˜æ±°ç­–ç•¥ LRU/LFU/FIFO]  
Â  Â  Â  Â  Evict --&gt;|å¦| Keep[ä¿ç•™ç¼“å­˜]  
Â  Â  Â  Â  Strategy --&gt; Keep  
Â  Â  end  
Â  Â Â   
Â  Â  style Request fill:#007AFF,color:#fff  
Â  Â  style CheckCache fill:#FF9500,color:#fff  
Â  Â  style ReturnCache fill:#34C759,color:#fff  
Â  Â  style Generate fill:#5AC8FA,color:#000  
Â  Â  style Store fill:#AF52DE,color:#fff  
Â  Â  style Strategy fill:#FF3B30,color:#fff  
</code></pre>
<p><strong>ç¼“å­˜çš„æ ¸å¿ƒä»·å€¼</strong>:</p>
<ul>
<li>âœ… <strong>å‡å°‘é‡å¤è®¡ç®—</strong>: ç›¸åŒè¾“å…¥ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ</li>
<li>âœ… <strong>æå‡å“åº”é€Ÿåº¦</strong>: ç¼“å­˜å‘½ä¸­æ—¶å‡ ä¹é›¶å»¶è¿Ÿ</li>
<li>âœ… <strong>é™ä½èµ„æºæ¶ˆè€—</strong>: å‡å°‘æ¨¡å‹è°ƒç”¨æ¬¡æ•°ï¼ŒèŠ‚çœè®¡ç®—èµ„æº</li>
<li>âœ… <strong>æ”¹å–„ç”¨æˆ·ä½“éªŒ</strong>: å¿«é€Ÿå“åº”ï¼Œç‰¹åˆ«æ˜¯é‡å¤æŸ¥çœ‹ç›¸åŒå†…å®¹æ—¶</li>
</ul>
<h5 data-id="heading-62">ç¼“å­˜é”®è®¾è®¡</h5>
<p>ç¼“å­˜é”®çš„è®¾è®¡ç›´æ¥å½±å“ç¼“å­˜å‘½ä¸­ç‡å’Œæœ‰æ•ˆæ€§ã€‚</p>
<p><strong>å¥½çš„ç¼“å­˜é”®åº”è¯¥åŒ…å«</strong>:</p>
<ul>
<li>è¾“å…¥æ•°æ®çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ç…§ç‰‡IDï¼‰</li>
<li>å¯èƒ½å½±å“ç»“æœçš„æ•°æ®ç‰ˆæœ¬ï¼ˆå¦‚ä¿®æ”¹æ—¶é—´ï¼‰</li>
<li>ç”Ÿæˆå‚æ•°ï¼ˆå¦‚ä¸åŒçš„Instructionså¯èƒ½äº§ç”Ÿä¸åŒç»“æœï¼‰</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheKeyBuilder</span> {  
Â  Â  <span class="hljs-comment">/// ä¸ºç…§ç‰‡åˆ†æç”Ÿæˆç¼“å­˜é”®  </span>
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">keyForPhotoAnalysis</span>(  
Â  Â  Â  Â  <span class="hljs-params">photoId</span>: <span class="hljs-type">String</span>,  
Â  Â  Â  Â  <span class="hljs-params">modificationDate</span>: <span class="hljs-type">Date</span>,  
Â  Â  Â  Â  <span class="hljs-params">instructionsHash</span>: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  
Â  Â  ) -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">var</span> components <span class="hljs-operator">=</span> [photoId, <span class="hljs-type">String</span>(modificationDate.timeIntervalSince1970)]  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> hash <span class="hljs-operator">=</span> instructionsHash {  
Â  Â  Â  Â  Â  Â  components.append(hash)  
Â  Â  Â  Â  }  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> components.joined(separator: <span class="hljs-string">"|"</span>)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// ä¸ºè‡ªç„¶è¯­è¨€æœç´¢ç”Ÿæˆç¼“å­˜é”®  </span>
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">keyForSearch</span>(  
Â  Â  Â  Â  <span class="hljs-params">query</span>: <span class="hljs-type">String</span>,  
Â  Â  Â  Â  <span class="hljs-params">photoCount</span>: <span class="hljs-type">Int</span>  
Â  Â  ) -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// ä½¿ç”¨æŸ¥è¯¢å†…å®¹å’Œç…§ç‰‡æ•°é‡ä½œä¸ºé”®  </span>
Â  Â  Â  Â  <span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœç›¸å†Œå†…å®¹å˜åŒ–ï¼Œéœ€è¦ä½¿ç¼“å­˜å¤±æ•ˆ  </span>
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"search:<span class="hljs-subst">\(query.hashValue)</span>:<span class="hljs-subst">\(photoCount)</span>"</span>  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-63">å†…å­˜ç¼“å­˜å®ç°</h5>
<p><strong>åŸºç¡€å†…å­˜ç¼“å­˜</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryCache</span>&lt;<span class="hljs-title class_">T</span>: <span class="hljs-title class_">Codable</span>&gt; {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cache: [<span class="hljs-type">String</span>: <span class="hljs-type">CacheEntry</span>&lt;<span class="hljs-type">T</span>&gt;] <span class="hljs-operator">=</span> [:]  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> maxSize: <span class="hljs-type">Int</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> accessQueue <span class="hljs-operator">=</span> <span class="hljs-type">DispatchQueue</span>(label: <span class="hljs-string">"com.app.cache"</span>, attributes: .concurrent)  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>(<span class="hljs-params">maxSize</span>: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.maxSize <span class="hljs-operator">=</span> maxSize  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// è·å–ç¼“å­˜  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">T</span>? {  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> accessQueue.sync {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> entry <span class="hljs-operator">=</span> cache[key] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æ›´æ–°è®¿é—®æ—¶é—´ï¼ˆç”¨äºLRUï¼‰  </span>
Â  Â  Â  Â  Â  Â  entry.lastAccessed <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> entry.value  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// è®¾ç½®ç¼“å­˜  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">set</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) {  
Â  Â  Â  Â  accessQueue.async(flags: .barrier) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœç¼“å­˜å·²æ»¡ï¼Œæ‰§è¡Œæ·˜æ±°ç­–ç•¥  </span>
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.cache.count <span class="hljs-operator">&gt;=</span> <span class="hljs-keyword">self</span>.maxSize <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-keyword">self</span>.cache[key] <span class="hljs-operator">==</span> <span class="hljs-literal">nil</span> {  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.evictOldest()  
Â  Â  Â  Â  Â  Â  }  
Â  Â  Â  Â  Â  Â Â   
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.cache[key] <span class="hljs-operator">=</span> <span class="hljs-type">CacheEntry</span>(value: value, lastAccessed: <span class="hljs-type">Date</span>())  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// LRUæ·˜æ±°ï¼šç§»é™¤æœ€ä¹…æœªè®¿é—®çš„æ¡ç›®  </span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">evictOldest</span>() {  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> oldest <span class="hljs-operator">=</span> cache.min(by: { <span class="hljs-variable">$0</span>.value.lastAccessed <span class="hljs-operator">&lt;</span> <span class="hljs-variable">$1</span>.value.lastAccessed }) <span class="hljs-keyword">else</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>  
Â  Â  Â  Â  }  
Â  Â  Â  Â  cache.removeValue(forKey: oldest.key)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ¸…é™¤æ‰€æœ‰ç¼“å­˜  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">clear</span>() {  
Â  Â  Â  Â  accessQueue.async(flags: .barrier) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.cache.removeAll()  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// è·å–ç¼“å­˜ç»Ÿè®¡  </span>
Â  Â  <span class="hljs-keyword">var</span> stats: <span class="hljs-type">CacheStats</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> accessQueue.sync {  
Â  Â  Â  Â  Â  Â  <span class="hljs-type">CacheStats</span>(  
Â  Â  Â  Â  Â  Â  Â  Â  size: cache.count,  
Â  Â  Â  Â  Â  Â  Â  Â  maxSize: maxSize,  
Â  Â  Â  Â  Â  Â  Â  Â  hitRate: <span class="hljs-number">0</span> <span class="hljs-comment">// éœ€è¦é¢å¤–å®ç°å‘½ä¸­ç‡ç»Ÿè®¡  </span>
Â  Â  Â  Â  Â  Â  )  
Â  Â  Â  Â  }  
Â  Â  }  
}

<span class="hljs-comment">/// ç¼“å­˜æ¡ç›®  </span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheEntry</span>&lt;<span class="hljs-title class_">T</span>&gt; {  
Â  Â  <span class="hljs-keyword">let</span> value: <span class="hljs-type">T</span>  
Â  Â  <span class="hljs-keyword">var</span> lastAccessed: <span class="hljs-type">Date</span>  
Â  Â  <span class="hljs-keyword">var</span> accessCount: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>(<span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">lastAccessed</span>: <span class="hljs-type">Date</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.value <span class="hljs-operator">=</span> value  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.lastAccessed <span class="hljs-operator">=</span> lastAccessed  
Â  Â  }  
}

<span class="hljs-comment">/// ç¼“å­˜ç»Ÿè®¡  </span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">CacheStats</span> {  
Â  Â  <span class="hljs-keyword">let</span> size: <span class="hljs-type">Int</span>  
Â  Â  <span class="hljs-keyword">let</span> maxSize: <span class="hljs-type">Int</span>  
Â  Â  <span class="hljs-keyword">let</span> hitRate: <span class="hljs-type">Double</span>  
}  
</code></pre>
<p><strong>ä½¿ç”¨å†…å­˜ç¼“å­˜çš„å®Œæ•´ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CachedPhotoAnalysisService</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> cache <span class="hljs-operator">=</span> <span class="hljs-type">MemoryCache</span>&lt;<span class="hljs-type">PhotoDescription</span>&gt;(maxSize: <span class="hljs-number">100</span>)  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> sessionManager <span class="hljs-operator">=</span> <span class="hljs-type">PhotoAISessionManager</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhoto</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// ç”Ÿæˆç¼“å­˜é”®  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> cacheKey <span class="hljs-operator">=</span> <span class="hljs-type">CacheKeyBuilder</span>.keyForPhotoAnalysis(  
Â  Â  Â  Â  Â  Â  photoId: photo.id,  
Â  Â  Â  Â  Â  Â  modificationDate: photo.modificationDate  
Â  Â  Â  Â  )  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> cached <span class="hljs-operator">=</span> cache.get(for: cacheKey) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… ç¼“å­˜å‘½ä¸­: <span class="hljs-subst">\(cacheKey)</span>"</span>)  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> cached  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âŒ ç¼“å­˜æœªå‘½ä¸­ï¼Œç”Ÿæˆæ–°ç»“æœ: <span class="hljs-subst">\(cacheKey)</span>"</span>)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// ç”Ÿæˆæ–°ç»“æœ  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> generateAnalysisPrompt(for: photo)  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> sessionManager.generateStructured(  
Â  Â  Â  Â  Â  Â  prompt: prompt,  
Â  Â  Â  Â  Â  Â  type: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  Â  Â  )  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å­˜å‚¨åˆ°ç¼“å­˜  </span>
Â  Â  Â  Â  cache.set(result, for: cacheKey)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> result  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">generateAnalysisPrompt</span>(<span class="hljs-params">for</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// ç”Ÿæˆåˆ†ææç¤ºè¯  </span>
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"åˆ†æç…§ç‰‡..."</span>  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-64">æŒä¹…åŒ–ç¼“å­˜å®ç°</h5>
<p>å¯¹äºéœ€è¦è·¨åº”ç”¨å¯åŠ¨ä¿æŒçš„ç¼“å­˜ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶ç³»ç»ŸæŒä¹…åŒ–ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PersistentCache</span>&lt;<span class="hljs-title class_">T</span>: <span class="hljs-title class_">Codable</span>&gt; {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> memoryCache <span class="hljs-operator">=</span> <span class="hljs-type">MemoryCache</span>&lt;<span class="hljs-type">T</span>&gt;(maxSize: <span class="hljs-number">50</span>)  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> cacheDirectory: <span class="hljs-type">URL</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> fileManager <span class="hljs-operator">=</span> <span class="hljs-type">FileManager</span>.default  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>(<span class="hljs-params">cacheName</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">throws</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> cacheDir <span class="hljs-operator">=</span> fileManager.urls(for: .cachesDirectory, in: .userDomainMask)[<span class="hljs-number">0</span>]  
Â  Â  Â  Â  cacheDirectory <span class="hljs-operator">=</span> cacheDir.appendingPathComponent(cacheName)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// åˆ›å»ºç¼“å­˜ç›®å½•  </span>
Â  Â  Â  Â  <span class="hljs-keyword">try</span> fileManager.createDirectory(at: cacheDirectory, withIntermediateDirectories: <span class="hljs-literal">true</span>)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// è·å–ç¼“å­˜ï¼ˆå…ˆæŸ¥å†…å­˜ï¼Œå†æŸ¥ç£ç›˜ï¼‰  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">T</span>? {  
Â  Â  Â  Â  <span class="hljs-comment">// å…ˆæŸ¥å†…å­˜ç¼“å­˜  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> memoryValue <span class="hljs-operator">=</span> memoryCache.get(for: key) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> memoryValue  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å†æŸ¥ç£ç›˜ç¼“å­˜  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> diskValue <span class="hljs-operator">=</span> loadFromDisk(key: key) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// åŠ è½½åˆ°å†…å­˜ç¼“å­˜  </span>
Â  Â  Â  Â  Â  Â  memoryCache.set(diskValue, for: key)  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> diskValue  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// è®¾ç½®ç¼“å­˜ï¼ˆåŒæ—¶å†™å…¥å†…å­˜å’Œç£ç›˜ï¼‰  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">set</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) {  
Â  Â  Â  Â  <span class="hljs-comment">// å†™å…¥å†…å­˜ç¼“å­˜  </span>
Â  Â  Â  Â  memoryCache.set(value, for: key)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å¼‚æ­¥å†™å…¥ç£ç›˜  </span>
Â  Â  Â  Â  <span class="hljs-type">Task</span>.detached(priority: .utility) {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">self</span>.saveToDisk(value: value, key: key)  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// ä»ç£ç›˜åŠ è½½  </span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadFromDisk</span>(<span class="hljs-params">key</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">T</span>? {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> fileURL <span class="hljs-operator">=</span> cacheDirectory.appendingPathComponent(<span class="hljs-string">"<span class="hljs-subst">\(key.hashValue)</span>.json"</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">Data</span>(contentsOf: fileURL),  
Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">T</span>.<span class="hljs-keyword">self</span>, from: data) <span class="hljs-keyword">else</span> {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>  
Â  Â  Â  Â  }  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> value  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// ä¿å­˜åˆ°ç£ç›˜  </span>
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">saveToDisk</span>(<span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> fileURL <span class="hljs-operator">=</span> cacheDirectory.appendingPathComponent(<span class="hljs-string">"<span class="hljs-subst">\(key.hashValue)</span>.json"</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">JSONEncoder</span>().encode(value) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }  
Â  Â  Â  Â  <span class="hljs-keyword">try?</span> data.write(to: fileURL)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ¸…ç†è¿‡æœŸç¼“å­˜  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">cleanExpired</span>(<span class="hljs-params">maxAge</span>: <span class="hljs-type">TimeInterval</span> <span class="hljs-operator">=</span> <span class="hljs-number">7</span> <span class="hljs-operator">*</span> <span class="hljs-number">24</span> <span class="hljs-operator">*</span> <span class="hljs-number">3600</span>) {  
Â  Â  Â  Â  <span class="hljs-comment">// æ¸…ç†è¶…è¿‡7å¤©çš„ç¼“å­˜æ–‡ä»¶  </span>
Â  Â  Â  Â  <span class="hljs-comment">// å®ç°ç»†èŠ‚...  </span>
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-65">ç¼“å­˜å¤±æ•ˆç­–ç•¥</h5>
<p>ç¼“å­˜å¤±æ•ˆæ˜¯ç¼“å­˜ç­–ç•¥çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Cache[ç¼“å­˜æ¡ç›®] --&gt; Check1{åŸºäºæ—¶é—´å¤±æ•ˆ?}  
Â  Â  Check1 --&gt;|æ˜¯| TimeBased[æ—¶é—´è¿‡æœŸç­–ç•¥ å¦‚ï¼š7å¤©åå¤±æ•ˆ]  
Â  Â  Check1 --&gt;|å¦| Check2{åŸºäºæ•°æ®å˜åŒ–å¤±æ•ˆ?}  
Â  Â Â   
Â  Â  Check2 --&gt;|æ˜¯| DataBased[æ•°æ®å˜åŒ–ç­–ç•¥ å¦‚ï¼šç…§ç‰‡ä¿®æ”¹åå¤±æ•ˆ]  
Â  Â  Check2 --&gt;|å¦| Check3{åŸºäºç‰ˆæœ¬å¤±æ•ˆ?}  
Â  Â Â   
Â  Â  Check3 --&gt;|æ˜¯| VersionBased[ç‰ˆæœ¬ç­–ç•¥ å¦‚ï¼šInstructionså˜åŒ–åå¤±æ•ˆ]  
Â  Â  Check3 --&gt;|å¦| Manual[æ‰‹åŠ¨å¤±æ•ˆ ç”¨æˆ·ä¸»åŠ¨æ¸…é™¤]  
Â  Â Â   
Â  Â  TimeBased --&gt; Invalidate[ä½¿ç¼“å­˜å¤±æ•ˆ]  
Â  Â  DataBased --&gt; Invalidate  
Â  Â  VersionBased --&gt; Invalidate  
Â  Â  Manual --&gt; Invalidate  
Â  Â Â   
Â  Â  style Cache fill:#007AFF,color:#fff  
Â  Â  style Check1 fill:#FF9500,color:#fff  
Â  Â  style Check2 fill:#FF9500,color:#fff  
Â  Â  style Check3 fill:#FF9500,color:#fff  
Â  Â  style TimeBased fill:#34C759,color:#fff  
Â  Â  style DataBased fill:#34C759,color:#fff  
Â  Â  style VersionBased fill:#34C759,color:#fff  
Â  Â  style Manual fill:#5AC8FA,color:#000  
Â  Â  style Invalidate fill:#FF3B30,color:#fff  
</code></pre>
<p><strong>å®ç°å¸¦å¤±æ•ˆç­–ç•¥çš„ç¼“å­˜</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheEntryWithExpiry</span>&lt;<span class="hljs-title class_">T</span>&gt; {  
Â  Â  <span class="hljs-keyword">let</span> value: <span class="hljs-type">T</span>  
Â  Â  <span class="hljs-keyword">let</span> createdAt: <span class="hljs-type">Date</span>  
Â  Â  <span class="hljs-keyword">let</span> expiresAt: <span class="hljs-type">Date</span>?  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>(<span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">ttl</span>: <span class="hljs-type">TimeInterval</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.value <span class="hljs-operator">=</span> value  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.createdAt <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.expiresAt <span class="hljs-operator">=</span> ttl.map { <span class="hljs-type">Date</span>().addingTimeInterval(<span class="hljs-variable">$0</span>) }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> isExpired: <span class="hljs-type">Bool</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> expiresAt <span class="hljs-operator">=</span> expiresAt <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> }  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-type">Date</span>() <span class="hljs-operator">&gt;</span> expiresAt  
Â  Â  }  
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ExpiringCache</span>&lt;<span class="hljs-title class_">T</span>: <span class="hljs-title class_">Codable</span>&gt; {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cache: [<span class="hljs-type">String</span>: <span class="hljs-type">CacheEntryWithExpiry</span>&lt;<span class="hljs-type">T</span>&gt;] <span class="hljs-operator">=</span> [:]  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> maxSize: <span class="hljs-type">Int</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> defaultTTL: <span class="hljs-type">TimeInterval</span>?  
Â  Â Â   
Â  Â  <span class="hljs-keyword">init</span>(<span class="hljs-params">maxSize</span>: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>, <span class="hljs-params">defaultTTL</span>: <span class="hljs-type">TimeInterval</span>? <span class="hljs-operator">=</span> <span class="hljs-number">7</span> <span class="hljs-operator">*</span> <span class="hljs-number">24</span> <span class="hljs-operator">*</span> <span class="hljs-number">3600</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.maxSize <span class="hljs-operator">=</span> maxSize  
Â  Â  Â  Â  <span class="hljs-keyword">self</span>.defaultTTL <span class="hljs-operator">=</span> defaultTTL  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">T</span>? {  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> entry <span class="hljs-operator">=</span> cache[key] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿‡æœŸ  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> entry.isExpired {  
Â  Â  Â  Â  Â  Â  cache.removeValue(forKey: key)  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">return</span> entry.value  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">set</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">value</span>: <span class="hljs-type">T</span>, <span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>, <span class="hljs-params">ttl</span>: <span class="hljs-type">TimeInterval</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> entry <span class="hljs-operator">=</span> <span class="hljs-type">CacheEntryWithExpiry</span>(value: value, ttl: ttl <span class="hljs-operator">??</span> defaultTTL)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœç¼“å­˜å·²æ»¡ï¼Œç§»é™¤è¿‡æœŸæˆ–æœ€æ—§çš„æ¡ç›®  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> cache.count <span class="hljs-operator">&gt;=</span> maxSize <span class="hljs-operator">&amp;&amp;</span> cache[key] <span class="hljs-operator">==</span> <span class="hljs-literal">nil</span> {  
Â  Â  Â  Â  Â  Â  evictExpiredOrOldest()  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  cache[key] <span class="hljs-operator">=</span> entry  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">evictExpiredOrOldest</span>() {  
Â  Â  Â  Â  <span class="hljs-comment">// å…ˆç§»é™¤è¿‡æœŸçš„  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> expiredKeys <span class="hljs-operator">=</span> cache.filter { <span class="hljs-variable">$0</span>.value.isExpired }.map { <span class="hljs-variable">$0</span>.key }  
Â  Â  Â  Â  expiredKeys.forEach { cache.removeValue(forKey: <span class="hljs-variable">$0</span>) }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœè¿˜æœ‰ç©ºé—´ï¼Œä¸éœ€è¦ç»§ç»­  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> cache.count <span class="hljs-operator">&lt;</span> maxSize { <span class="hljs-keyword">return</span> }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// ç§»é™¤æœ€æ—§çš„  </span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> oldest <span class="hljs-operator">=</span> cache.min(by: { <span class="hljs-variable">$0</span>.value.createdAt <span class="hljs-operator">&lt;</span> <span class="hljs-variable">$1</span>.value.createdAt }) {  
Â  Â  Â  Â  Â  Â  cache.removeValue(forKey: oldest.key)  
Â  Â  Â  Â  }  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// æ‰‹åŠ¨ä½¿ç¼“å­˜å¤±æ•ˆ  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">invalidate</span>(<span class="hljs-params">for</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>) {  
Â  Â  Â  Â  cache.removeValue(forKey: key)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-comment">/// ä½¿æ‰€æœ‰ç¼“å­˜å¤±æ•ˆ  </span>
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">invalidateAll</span>() {  
Â  Â  Â  Â  cache.removeAll()  
Â  Â  }  
}  
</code></pre>
<h5 data-id="heading-66">ç¼“å­˜ç­–ç•¥é€‰æ‹©æŒ‡å—</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((ç¼“å­˜ç­–ç•¥é€‰æ‹©))  
Â  Â  å†…å­˜ç¼“å­˜  
Â  Â  Â  å¿«é€Ÿè®¿é—®  
Â  Â  Â  é€‚åˆé¢‘ç¹è®¿é—®  
Â  Â  Â  å®¹é‡æœ‰é™  
Â  Â  Â  åº”ç”¨é‡å¯åä¸¢å¤±  
Â  Â  æŒä¹…åŒ–ç¼“å­˜  
Â  Â  Â  è·¨å¯åŠ¨ä¿æŒ  
Â  Â  Â  é€‚åˆé‡è¦ç»“æœ  
Â  Â  Â  éœ€è¦ç£ç›˜ç©ºé—´  
Â  Â  Â  éœ€è¦ç®¡ç†æ–‡ä»¶  
Â  Â  ç¼“å­˜å¤±æ•ˆ  
Â  Â  Â  æ—¶é—´è¿‡æœŸ  
Â  Â  Â  æ•°æ®å˜åŒ–è§¦å‘  
Â  Â  Â  ç‰ˆæœ¬æ§åˆ¶  
Â  Â  Â  æ‰‹åŠ¨æ¸…é™¤  
Â  Â  ç¼“å­˜æ·˜æ±°  
Â  Â  Â  LRU æœ€è¿‘æœ€å°‘ä½¿ç”¨  
Â  Â  Â  LFU æœ€ä¸å¸¸ç”¨  
Â  Â  Â  FIFO å…ˆè¿›å…ˆå‡º  
Â  Â  Â  æ ¹æ®åœºæ™¯é€‰æ‹©  
</code></pre>
<p><strong>ä¸åŒåœºæ™¯çš„ç¼“å­˜ç­–ç•¥å»ºè®®</strong>:</p>








































<table><thead><tr><th>åœºæ™¯</th><th>ç¼“å­˜ç±»å‹</th><th>å¤±æ•ˆç­–ç•¥</th><th>æ·˜æ±°ç­–ç•¥</th><th>å®¹é‡å»ºè®®</th></tr></thead><tbody><tr><td>ç…§ç‰‡åˆ†æç»“æœ</td><td>å†…å­˜+æŒä¹…åŒ–</td><td>ç…§ç‰‡ä¿®æ”¹æ—¶å¤±æ•ˆ</td><td>LRU</td><td>100-200æ¡</td></tr><tr><td>æœç´¢æŸ¥è¯¢ç»“æœ</td><td>ä»…å†…å­˜</td><td>ç›¸å†Œå†…å®¹å˜åŒ–æ—¶å¤±æ•ˆ</td><td>LRU</td><td>50-100æ¡</td></tr><tr><td>ç›¸å†Œåˆ†ç±»å»ºè®®</td><td>ä»…å†…å­˜</td><td>ç…§ç‰‡æ•°é‡å˜åŒ–æ—¶å¤±æ•ˆ</td><td>FIFO</td><td>20-50æ¡</td></tr><tr><td>è§†é¢‘æ‘˜è¦</td><td>æŒä¹…åŒ–</td><td>7å¤©è¿‡æœŸ</td><td>LRU</td><td>50-100æ¡</td></tr></tbody></table>
<h5 data-id="heading-67">ç¼“å­˜æœ€ä½³å®è·µ</h5>
<p><strong>1. ç¼“å­˜é”®è®¾è®¡åŸåˆ™</strong></p>
<ul>
<li>âœ… åŒ…å«æ‰€æœ‰å½±å“ç»“æœçš„å› ç´ </li>
<li>âœ… ä½¿ç”¨ç¨³å®šçš„æ ‡è¯†ç¬¦ï¼ˆå¦‚ç…§ç‰‡ID + ä¿®æ”¹æ—¶é—´ï¼‰</li>
<li>âœ… é¿å…åŒ…å«æ˜“å˜æ•°æ®ï¼ˆå¦‚å½“å‰æ—¶é—´æˆ³ï¼‰</li>
<li>âœ… è€ƒè™‘å“ˆå¸Œå†²çªï¼Œä½¿ç”¨è¶³å¤Ÿé•¿çš„é”®</li>
</ul>
<p><strong>2. ç¼“å­˜å®¹é‡ç®¡ç†</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheManager</span> {  
Â  Â  <span class="hljs-comment">/// æ ¹æ®è®¾å¤‡å†…å­˜åŠ¨æ€è°ƒæ•´ç¼“å­˜å¤§å°  </span>
Â  Â  <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">optimalCacheSize</span>() -&gt; <span class="hljs-type">Int</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> totalMemory <span class="hljs-operator">=</span> <span class="hljs-type">ProcessInfo</span>.processInfo.physicalMemory  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> availableMemory <span class="hljs-operator">=</span> totalMemory <span class="hljs-operator">/</span> <span class="hljs-number">4</span> <span class="hljs-comment">// ä½¿ç”¨1/4å¯ç”¨å†…å­˜  </span>
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å‡è®¾æ¯ä¸ªç¼“å­˜æ¡ç›®å¹³å‡å ç”¨ 10KB  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> entrySize <span class="hljs-operator">=</span> <span class="hljs-number">10</span> <span class="hljs-operator">*</span> <span class="hljs-number">1024</span>  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> maxEntries <span class="hljs-operator">=</span> <span class="hljs-type">Int</span>(availableMemory) <span class="hljs-operator">/</span> entrySize  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// é™åˆ¶åœ¨åˆç†èŒƒå›´å†…  </span>
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(maxEntries, <span class="hljs-number">500</span>)  
Â  Â  }  
}  
</code></pre>
<p><strong>3. ç¼“å­˜æ€§èƒ½ç›‘æ§</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheMetrics</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hits: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> misses: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">recordHit</span>() { hits <span class="hljs-operator">+=</span> <span class="hljs-number">1</span> }  
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">recordMiss</span>() { misses <span class="hljs-operator">+=</span> <span class="hljs-number">1</span> }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> hitRate: <span class="hljs-type">Double</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> total <span class="hljs-operator">=</span> hits <span class="hljs-operator">+</span> misses  
Â  Â  Â  Â  <span class="hljs-keyword">guard</span> total <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> }  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-type">Double</span>(hits) <span class="hljs-operator">/</span> <span class="hljs-type">Double</span>(total)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">reset</span>() {  
Â  Â  Â  Â  hits <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  
Â  Â  Â  Â  misses <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  
Â  Â  }  
}

<span class="hljs-comment">// åœ¨ç¼“å­˜æœåŠ¡ä¸­ä½¿ç”¨  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CachedPhotoAnalysisService</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> metrics <span class="hljs-operator">=</span> <span class="hljs-type">CacheMetrics</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhoto</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> cacheKey <span class="hljs-operator">=</span> <span class="hljs-type">CacheKeyBuilder</span>.keyForPhotoAnalysis(<span class="hljs-operator">...</span>)  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> cached <span class="hljs-operator">=</span> cache.get(for: cacheKey) {  
Â  Â  Â  Â  Â  Â  metrics.recordHit()  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> cached  
Â  Â  Â  Â  }  
Â  Â  Â  Â Â   
Â  Â  Â  Â  metrics.recordMiss()  
Â  Â  Â  Â  <span class="hljs-comment">// ... ç”Ÿæˆæ–°ç»“æœ  </span>
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">getCacheStats</span>() -&gt; (hitRate: <span class="hljs-type">Double</span>, size: <span class="hljs-type">Int</span>) {  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> (metrics.hitRate, cache.stats.size)  
Â  Â  }  
}  
</code></pre>
<p><strong>4. ç¼“å­˜æ£€æŸ¥æ¸…å•</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ç¼“å­˜é”®æ˜¯å¦åŒ…å«æ‰€æœ‰å½±å“ç»“æœçš„å› ç´ ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦å®ç°äº†åˆé€‚çš„å¤±æ•ˆç­–ç•¥ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ç¼“å­˜å®¹é‡æ˜¯å¦åˆç†ï¼ˆä¸ä¼šå¯¼è‡´å†…å­˜å‹åŠ›ï¼‰ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦ç›‘æ§äº†ç¼“å­˜å‘½ä¸­ç‡ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦å¤„ç†äº†ç¼“å­˜å¤±è´¥çš„æƒ…å†µï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦éœ€è¦æŒä¹…åŒ–ç¼“å­˜ï¼ˆè·¨å¯åŠ¨ä¿æŒï¼‰ï¼Ÿ</li>
</ul>
<p><strong>å‚è€ƒèµ„æº</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fonevcat.com%2F2025%2F06%2Ffoundation-models%2F" target="_blank" title="https://onevcat.com/2025/06/foundation-models/" ref="nofollow noopener noreferrer">OneV's Den - Foundation Models å†…å­˜åˆ†æ</a></li>
</ul>
<h4 data-id="heading-68">ä½¿ç”¨ Instruments è¿›è¡Œæ€§èƒ½åˆ†æ</h4>
<p><strong>Instruments</strong> æ˜¯ Apple æä¾›çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œæœ€æ–°ç‰ˆæœ¬å·²æ·»åŠ  <strong>Foundation Models æ¨¡å—</strong>ï¼Œå¯ä»¥åœ¨ iPhone è®¾å¤‡ä¸Šç›´æ¥è¿›è¡Œæ€§èƒ½åˆ†æï¼Œå¸®åŠ©å¼€å‘è€…ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p>
<h5 data-id="heading-69">Instruments Foundation Models æ¨¡å—åŠŸèƒ½</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Start([å¯åŠ¨ Instruments]) --&gt; Select[é€‰æ‹© Foundation Models æ¨¡æ¿]  
Â  Â  Select --&gt; Connect[è¿æ¥ iPhone è®¾å¤‡]  
Â  Â  Connect --&gt; Launch[å¯åŠ¨åº”ç”¨]  
Â  Â  Launch --&gt; Record[å¼€å§‹å½•åˆ¶æ€§èƒ½æ•°æ®]  
Â  Â  Record --&gt; Analyze[åˆ†ææ€§èƒ½æŒ‡æ ‡]  
Â  Â Â   
Â  Â  Analyze --&gt; LoadTime[æ¨¡å‹åŠ è½½æ—¶é—´åˆ†æ]  
Â  Â  Analyze --&gt; InferenceTime[æ¨ç†æ—¶é—´åˆ†æ]  
Â  Â  Analyze --&gt; TokenCount[è¾“å…¥ä»¤ç‰Œæ•°é‡åˆ†æ]  
Â  Â  Analyze --&gt; Memory[å†…å­˜ä½¿ç”¨åˆ†æ]  
Â  Â Â   
Â  Â  LoadTime --&gt; Optimize1[ä¼˜åŒ–åŠ è½½ç­–ç•¥]  
Â  Â  InferenceTime --&gt; Optimize2[ä¼˜åŒ– Prompt è®¾è®¡]  
Â  Â  TokenCount --&gt; Optimize3[ä¼˜åŒ–è¾“å…¥é•¿åº¦]  
Â  Â  Memory --&gt; Optimize4[ä¼˜åŒ–å†…å­˜ç®¡ç†]  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Select fill:#5AC8FA,color:#000  
Â  Â  style Connect fill:#5AC8FA,color:#000  
Â  Â  style Record fill:#FF9500,color:#fff  
Â  Â  style Analyze fill:#FF9500,color:#fff  
Â  Â  style LoadTime fill:#34C759,color:#fff  
Â  Â  style InferenceTime fill:#34C759,color:#fff  
Â  Â  style TokenCount fill:#34C759,color:#fff  
Â  Â  style Memory fill:#34C759,color:#fff  
</code></pre>
<p><strong>æ ¸å¿ƒåˆ†ææŒ‡æ ‡</strong>:</p>
<ol>
<li>
<p><strong>æ¨¡å‹åŠ è½½æ—¶é—´ï¼ˆModel Load Timeï¼‰</strong><br/>
- æµ‹é‡æ¨¡å‹ä»å­˜å‚¨åŠ è½½åˆ°å†…å­˜å¹¶å‡†å¤‡å°±ç»ªçš„æ—¶é—´<br/>
- å¸®åŠ©è¯†åˆ«é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿé—®é¢˜<br/>
- ä¼˜åŒ–å»ºè®®ï¼šé¢„çƒ­æ¨¡å‹ã€ä¼˜åŒ–å­˜å‚¨ä½ç½®</p>
</li>
<li>
<p><strong>æ¨ç†æ—¶é—´ï¼ˆInference Timeï¼‰</strong><br/>
- æµ‹é‡æ¨¡å‹æ¥æ”¶è¾“å…¥å¹¶ç”Ÿæˆè¾“å‡ºæ‰€éœ€çš„æ—¶é—´<br/>
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–ç‚¹<br/>
- ä¼˜åŒ–å»ºè®®ï¼šç²¾ç®€ Promptã€ä¼˜åŒ– Instructions</p>
</li>
<li>
<p><strong>è¾“å…¥ä»¤ç‰Œæ•°é‡ï¼ˆInput Token Countï¼‰</strong><br/>
- ç»Ÿè®¡æ¯æ¬¡è¯·æ±‚çš„è¾“å…¥ä»¤ç‰Œæ€»æ•°<br/>
- å¸®åŠ©ä¼˜åŒ–è¾“å…¥é•¿åº¦ï¼Œå‡å°‘æˆæœ¬<br/>
- ä¼˜åŒ–å»ºè®®ï¼šç²¾ç®€ä¸Šä¸‹æ–‡ã€ä½¿ç”¨æ‘˜è¦</p>
</li>
<li>
<p><strong>å†…å­˜ä½¿ç”¨ï¼ˆMemory Usageï¼‰</strong><br/>
- ç›‘æ§æ¨¡å‹è¿è¡Œæ—¶çš„å†…å­˜å ç”¨<br/>
- è¯†åˆ«å†…å­˜æ³„æ¼å’Œå³°å€¼ä½¿ç”¨<br/>
- ä¼˜åŒ–å»ºè®®ï¼šåŠæ—¶é‡Šæ”¾ Sessionã€ç®¡ç†ä¸Šä¸‹æ–‡çª—å£</p>
</li>
</ol>
<h5 data-id="heading-70">ä½¿ç”¨æ­¥éª¤</h5>
<p><strong>æ­¥éª¤1: æ‰“å¼€ Instruments</strong></p>
<ol>
<li>åœ¨ Xcode ä¸­ï¼Œé€‰æ‹© <strong>Product â†’ Profile</strong>ï¼ˆæˆ–æŒ‰ <code>âŒ˜I</code>ï¼‰</li>
<li>é€‰æ‹© <strong>Foundation Models</strong> æ¨¡æ¿</li>
<li>é€‰æ‹©ç›®æ ‡è®¾å¤‡ï¼ˆå¿…é¡»æ˜¯æ”¯æŒ Apple Intelligence çš„çœŸå®è®¾å¤‡ï¼‰</li>
</ol>
<p><strong>æ­¥éª¤2: é…ç½®åˆ†æé€‰é¡¹</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR  
Â  Â  Config[é…ç½®åˆ†æé€‰é¡¹] --&gt; Option1[æ¨¡å‹åŠ è½½æ—¶é—´è¿½è¸ª]  
Â  Â  Config --&gt; Option2[æ¨ç†æ—¶é—´è¿½è¸ª]  
Â  Â  Config --&gt; Option3[ä»¤ç‰Œè®¡æ•°è¿½è¸ª]  
Â  Â  Config --&gt; Option4[å†…å­˜ä½¿ç”¨è¿½è¸ª]  
Â  Â Â   
Â  Â  Option1 --&gt; Start[å¼€å§‹å½•åˆ¶]  
Â  Â  Option2 --&gt; Start  
Â  Â  Option3 --&gt; Start  
Â  Â  Option4 --&gt; Start  
Â  Â Â   
Â  Â  style Config fill:#007AFF,color:#fff  
Â  Â  style Option1 fill:#5AC8FA,color:#000  
Â  Â  style Option2 fill:#5AC8FA,color:#000  
Â  Â  style Option3 fill:#5AC8FA,color:#000  
Â  Â  style Option4 fill:#5AC8FA,color:#000  
Â  Â  style Start fill:#34C759,color:#fff  
</code></pre>
<p><strong>æ­¥éª¤3: æ‰§è¡Œæ“ä½œå¹¶åˆ†æ</strong></p>
<p>åœ¨åº”ç”¨ä¸­ä½¿ç”¨ Foundation Models åŠŸèƒ½ï¼ŒInstruments ä¼šè‡ªåŠ¨è®°å½•ï¼š</p>
<ul>
<li>æ¯æ¬¡ <code>LanguageModelSession.respond()</code> è°ƒç”¨çš„æ—¶é—´çº¿</li>
<li>æ¨¡å‹åŠ è½½äº‹ä»¶å’Œè€—æ—¶</li>
<li>è¾“å…¥ä»¤ç‰Œæ•°é‡ç»Ÿè®¡</li>
<li>å†…å­˜åˆ†é…å’Œé‡Šæ”¾æƒ…å†µ</li>
</ul>
<p><strong>æ­¥éª¤4: æŸ¥çœ‹åˆ†æç»“æœ</strong></p>
<p>Instruments ä¼šæ˜¾ç¤ºä»¥ä¸‹è§†å›¾ï¼š</p>
<ul>
<li><strong>æ—¶é—´çº¿è§†å›¾</strong>: æ˜¾ç¤ºæ¨¡å‹åŠ è½½å’Œæ¨ç†çš„æ—¶é—´åˆ†å¸ƒ</li>
<li><strong>ç»Ÿè®¡è§†å›¾</strong>: æ˜¾ç¤ºå¹³å‡/æœ€å¤§/æœ€å°æ¨ç†æ—¶é—´</li>
<li><strong>ä»¤ç‰Œç»Ÿè®¡</strong>: æ˜¾ç¤ºè¾“å…¥ä»¤ç‰Œæ•°é‡åˆ†å¸ƒ</li>
<li><strong>å†…å­˜è§†å›¾</strong>: æ˜¾ç¤ºå†…å­˜ä½¿ç”¨è¶‹åŠ¿</li>
</ul>
<h5 data-id="heading-71">æ€§èƒ½ä¼˜åŒ–å®è·µç¤ºä¾‹</h5>
<p><strong>åœºæ™¯1: ä¼˜åŒ–é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åœ¨ Instruments ä¸­è§‚å¯Ÿæ¨¡å‹åŠ è½½æ—¶é—´  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PhotoAnalysisService</span> {  
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhoto</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// Instruments ä¼šè®°å½•è¿™é‡Œçš„æ¨¡å‹åŠ è½½æ—¶é—´  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  Â  Â Â   
Â  Â  Â  Â  <span class="hljs-comment">// å¦‚æœåŠ è½½æ—¶é—´è¿‡é•¿ï¼Œè€ƒè™‘é¢„çƒ­  </span>
Â  Â  Â  Â  <span class="hljs-comment">// åœ¨åº”ç”¨å¯åŠ¨æ—¶æå‰åŠ è½½æ¨¡å‹  </span>
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(<span class="hljs-string">"åˆ†æç…§ç‰‡"</span>),  
Â  Â  Â  Â  Â  Â  generating: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  Â  Â  )  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  }  
}  
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>:</p>
<ul>
<li>å¦‚æœ Instruments æ˜¾ç¤ºé¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ &gt; 2ç§’ï¼Œè€ƒè™‘åœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„çƒ­æ¨¡å‹</li>
<li>ä½¿ç”¨ <code>ModelPrewarmer</code> åœ¨åå°é¢„çƒ­ï¼Œé¿å…ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶ç­‰å¾…</li>
</ul>
<p><strong>åœºæ™¯2: ä¼˜åŒ– Prompt é•¿åº¦</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åœ¨ Instruments ä¸­è§‚å¯Ÿè¾“å…¥ä»¤ç‰Œæ•°é‡  </span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhotoWithMetadata</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â Â   
Â  Â  <span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•ï¼šåŒ…å«è¿‡å¤šå…ƒæ•°æ®ï¼Œä»¤ç‰Œæ•°é‡è¿‡å¤š  </span>
Â  Â  <span class="hljs-keyword">let</span> longPrompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  åˆ†æç…§ç‰‡ï¼š  
Â  Â  Â  Â  - æ‹æ‘„æ—¶é—´: <span class="hljs-subst">\(photo.date)</span>  
Â  Â  Â  Â  - æ‹æ‘„åœ°ç‚¹: <span class="hljs-subst">\(photo.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  - EXIFä¿¡æ¯: <span class="hljs-subst">\(photo.exifInfo)</span>  
Â  Â  Â  Â  - æ–‡ä»¶å¤§å°: <span class="hljs-subst">\(photo.fileSize)</span>MB  
Â  Â  Â  Â  - åˆ†è¾¨ç‡: <span class="hljs-subst">\(photo.resolution)</span>  
Â  Â  Â  Â  - ç›¸æœºå‹å·: <span class="hljs-subst">\(photo.cameraModel)</span>  
Â  Â  Â  Â  - ISO: <span class="hljs-subst">\(photo.iso)</span>  
Â  Â  Â  Â  - å…‰åœˆ: <span class="hljs-subst">\(photo.aperture)</span>  
Â  Â  Â  Â  - å¿«é—¨é€Ÿåº¦: <span class="hljs-subst">\(photo.shutterSpeed)</span>  
Â  Â  Â  Â  ... æ›´å¤šå…ƒæ•°æ®  
Â  Â  """</span>  
Â  Â Â   
Â  Â  <span class="hljs-comment">// âœ… å¥½çš„åšæ³•ï¼šåªåŒ…å«å…³é”®ä¿¡æ¯ï¼Œå‡å°‘ä»¤ç‰Œæ•°é‡  </span>
Â  Â  <span class="hljs-keyword">let</span> optimizedPrompt <span class="hljs-operator">=</span> <span class="hljs-string">"""  
Â  Â  Â  Â  åˆ†æç…§ç‰‡ï¼š  
Â  Â  Â  Â  - æ—¶é—´: <span class="hljs-subst">\(photo.date)</span>  
Â  Â  Â  Â  - åœ°ç‚¹: <span class="hljs-subst">\(photo.location <span class="hljs-operator">??</span> <span class="hljs-string">"æœªçŸ¥"</span>)</span>  
Â  Â  Â  Â  - å…³é”®ä¿¡æ¯: <span class="hljs-subst">\(photo.keyMetadata)</span>  
Â  Â  """</span>  
Â  Â Â   
Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(optimizedPrompt),  
Â  Â  Â  Â  generating: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  )  
Â  Â  <span class="hljs-keyword">return</span> response.content  
}  
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>:</p>
<ul>
<li>ä½¿ç”¨ Instruments ç›‘æ§è¾“å…¥ä»¤ç‰Œæ•°é‡</li>
<li>å¦‚æœå¹³å‡ä»¤ç‰Œæ•°é‡ &gt; 1000ï¼Œè€ƒè™‘ç²¾ç®€ Prompt</li>
<li>ç§»é™¤ä¸å¿…è¦çš„å…ƒæ•°æ®ï¼Œåªä¿ç•™å…³é”®ä¿¡æ¯</li>
</ul>
<p><strong>åœºæ™¯3: è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD  
Â  Â  Profile[ä½¿ç”¨ Instruments åˆ†æ] --&gt; Check1{æ¨¡å‹åŠ è½½æ—¶é—´&lt;br/&gt;æ˜¯å¦è¿‡é•¿?}  
Â  Â  Check1 --&gt;|æ˜¯| Action1[é¢„çƒ­æ¨¡å‹&lt;br/&gt;ä¼˜åŒ–åŠ è½½ç­–ç•¥]  
Â  Â  Check1 --&gt;|å¦| Check2{æ¨ç†æ—¶é—´&lt;br/&gt;æ˜¯å¦è¿‡é•¿?}  
Â  Â Â   
Â  Â  Check2 --&gt;|æ˜¯| Action2[ç²¾ç®€ Prompt&lt;br/&gt;ä¼˜åŒ– Instructions]  
Â  Â  Check2 --&gt;|å¦| Check3{ä»¤ç‰Œæ•°é‡&lt;br/&gt;æ˜¯å¦è¿‡å¤š?}  
Â  Â Â   
Â  Â  Check3 --&gt;|æ˜¯| Action3[å‡å°‘ä¸Šä¸‹æ–‡&lt;br/&gt;ä½¿ç”¨æ‘˜è¦]  
Â  Â  Check3 --&gt;|å¦| Check4{å†…å­˜ä½¿ç”¨&lt;br/&gt;æ˜¯å¦å¼‚å¸¸?}  
Â  Â Â   
Â  Â  Check4 --&gt;|æ˜¯| Action4[ç®¡ç†ä¸Šä¸‹æ–‡çª—å£&lt;br/&gt;åŠæ—¶é‡Šæ”¾ Session]  
Â  Â  Check4 --&gt;|å¦| Success[æ€§èƒ½ä¼˜åŒ–å®Œæˆ]  
Â  Â Â   
Â  Â  Action1 --&gt; Success  
Â  Â  Action2 --&gt; Success  
Â  Â  Action3 --&gt; Success  
Â  Â  Action4 --&gt; Success  
Â  Â Â   
Â  Â  style Profile fill:#007AFF,color:#fff  
Â  Â  style Check1 fill:#FF9500,color:#fff  
Â  Â  style Check2 fill:#FF9500,color:#fff  
Â  Â  style Check3 fill:#FF9500,color:#fff  
Â  Â  style Check4 fill:#FF9500,color:#fff  
Â  Â  style Action1 fill:#34C759,color:#fff  
Â  Â  style Action2 fill:#34C759,color:#fff  
Â  Â  style Action3 fill:#34C759,color:#fff  
Â  Â  style Action4 fill:#34C759,color:#fff  
Â  Â  style Success fill:#007AFF,color:#fff  
</code></pre>
<h5 data-id="heading-72">Instruments åˆ†ææœ€ä½³å®è·µ</h5>
<p><strong>1. å»ºç«‹æ€§èƒ½åŸºå‡†</strong></p>
<p>åœ¨ä¼˜åŒ–å‰ï¼Œå…ˆå»ºç«‹æ€§èƒ½åŸºå‡†ï¼š</p>
<ul>
<li>è®°å½•é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿ</li>
<li>è®°å½•å¹³å‡æ¨ç†æ—¶é—´</li>
<li>è®°å½•å…¸å‹åœºæ™¯çš„ä»¤ç‰Œæ•°é‡</li>
<li>è®°å½•å³°å€¼å†…å­˜ä½¿ç”¨</li>
</ul>
<p><strong>2. å¯¹æ¯”ä¼˜åŒ–æ•ˆæœ</strong></p>
<p>æ¯æ¬¡ä¼˜åŒ–åï¼Œä½¿ç”¨ Instruments å¯¹æ¯”ï¼š</p>
<ul>
<li>ä¼˜åŒ–å‰åçš„æ—¶é—´å¯¹æ¯”</li>
<li>ä»¤ç‰Œæ•°é‡å˜åŒ–</li>
<li>å†…å­˜ä½¿ç”¨æ”¹å–„</li>
</ul>
<p><strong>3. å…³æ³¨å…³é”®è·¯å¾„</strong></p>
<p>é‡ç‚¹å…³æ³¨ç”¨æˆ·æ„ŸçŸ¥æ˜æ˜¾çš„è·¯å¾„ï¼š</p>
<ul>
<li>é¦–æ¬¡è°ƒç”¨å»¶è¿Ÿï¼ˆå½±å“ç¬¬ä¸€å°è±¡ï¼‰</li>
<li>å¸¸è§æ“ä½œçš„æ¨ç†æ—¶é—´ï¼ˆå½±å“æ—¥å¸¸ä½“éªŒï¼‰</li>
<li>å³°å€¼å†…å­˜ä½¿ç”¨ï¼ˆå½±å“ç¨³å®šæ€§ï¼‰</li>
</ul>
<p><strong>4. çœŸå®è®¾å¤‡æµ‹è¯•</strong></p>
<p>âš ï¸ <strong>é‡è¦</strong>: Foundation Models åœ¨æ¨¡æ‹Ÿå™¨ä¸Šä¸å¯ç”¨ï¼Œå¿…é¡»åœ¨çœŸå®è®¾å¤‡ä¸Šä½¿ç”¨ Instruments åˆ†æã€‚</p>
<p><strong>å‚è€ƒèµ„æº</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fxcode%2Finstruments" target="_blank" title="https://developer.apple.com/documentation/xcode/instruments" ref="nofollow noopener noreferrer">Apple Developer - Instruments</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fzvayivqt0ufji%2Farticle%2Fdetails%2F149374995" target="_blank" title="https://blog.csdn.net/zvayivqt0ufji/article/details/149374995" ref="nofollow noopener noreferrer">CSDN - Foundation Models æ€§èƒ½åˆ†æ</a></li>
</ul>
<h3 data-id="heading-73">4.3 Foundation Models çš„è¾¹ç•Œå’Œé™åˆ¶</h3>
<p>äº†è§£ Foundation Models çš„è¾¹ç•Œå’Œé™åˆ¶ï¼Œå¯¹äºåœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è‡³å…³é‡è¦ã€‚æœ¬èŠ‚åŸºäºå®é™…æµ‹è¯•æ•°æ®ï¼Œå¸®åŠ©ä½ ç†è§£æ¡†æ¶çš„èƒ½åŠ›è¾¹ç•Œã€‚</p>
<h4 data-id="heading-74">æ ¸å¿ƒé™åˆ¶æ±‡æ€»</h4>



































<table><thead><tr><th>ç±»åˆ«</th><th>é™åˆ¶/ç‰¹å¾</th><th>è¯¦ç»†è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ä¸Šä¸‹æ–‡çª—å£</strong></td><td>4096 tokens</td><td>â€¢ å®é™…é™åˆ¶ï¼š4096 tokensï¼ˆä¸æ˜¯è®­ç»ƒæ—¶çš„ 65Kï¼‰<br/>â€¢ çº¦æ”¯æŒ 10-20 è½®å¯¹è¯<br/>â€¢ éœ€è¦è®¾è®¡ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥</td></tr><tr><td><strong>å†…å­˜æ¶ˆè€—</strong></td><td>1.0-1.5GB</td><td>â€¢ æ¨¡å‹æƒé‡ï¼š~750MBï¼ˆ3B å‚æ•° Ã— 2-bit é‡åŒ–ï¼‰<br/>â€¢ KV Cacheï¼š~300-600MBï¼ˆ8-bit é‡åŒ–ï¼Œ37.5% å‡å°‘ä¼˜åŒ–ï¼‰<br/>â€¢ æ¡†æ¶å¼€é”€ï¼š~100-200MB</td></tr><tr><td><strong>å¹¶å‘æ€§èƒ½</strong></td><td>å• session æ­£å¸¸</td><td>â€¢ å• sessionï¼šiPhone 10-30 tokens/sï¼ŒM2 Pro ~30 tokens/s<br/>â€¢ å¤š sessionï¼šæ¯ä¸ª session é™è‡³çº¦ 1 token/s<br/>â€¢ <strong>å»ºè®®</strong>ï¼šä½¿ç”¨é˜Ÿåˆ—ä¸²è¡Œè®¿é—®ï¼Œé¿å…å¹¶å‘ session</td></tr><tr><td><strong>ç»“æ„åŒ–ç”Ÿæˆ</strong></td><td>Schema å¼€é”€</td><td>â€¢ æ¯ä¸ª <code>@Generable</code> å±æ€§çº¦å¢åŠ  30 tokens<br/>â€¢ è®¾è®¡å¤æ‚æ•°æ®ç»“æ„æ—¶éœ€è¦è€ƒè™‘å¼€é”€<br/>â€¢ å½±å“ä¸Šä¸‹æ–‡çª—å£ä½¿ç”¨</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ–‡æœ¬å¤„ç†ä¸ºä¸»</td><td><strong>âœ… é€‚åˆ</strong>ï¼šæ–‡æœ¬æ‘˜è¦ã€å†…å®¹åˆ†ç±»ã€ç»“æ„åŒ–æå–ã€è‡ªç„¶è¯­è¨€ç†è§£<br/><strong>âŒ ä¸é€‚åˆ</strong>ï¼šæ•°å­¦è®¡ç®—ã€ä»£ç ç”Ÿæˆã€å¤æ‚æ¨ç†ã€æœ€æ–°ä¿¡æ¯ï¼ˆè®­ç»ƒæ•°æ®æˆªæ­¢ 2023å¹´10æœˆï¼‰</td></tr></tbody></table>
<h4 data-id="heading-75">é€‚ç”¨åœºæ™¯ä¸ä¸é€‚ç”¨åœºæ™¯</h4>
<p><strong>âœ… é€‚åˆçš„åœºæ™¯</strong>:</p>
<p>æ ¹æ®å®é™…æµ‹è¯•ï¼ŒFoundation Models åœ¨ä»¥ä¸‹åœºæ™¯è¡¨ç°ä¸é”™ï¼š</p>
<ul>
<li><strong>æ–‡æœ¬æ‘˜è¦</strong>: ç”Ÿæˆå†…å®¹æ‘˜è¦ã€æå–å…³é”®ä¿¡æ¯</li>
<li><strong>å†…å®¹åˆ†ç±»</strong>: å¯¹æ–‡æœ¬ã€ç…§ç‰‡ç­‰å†…å®¹è¿›è¡Œåˆ†ç±»</li>
<li><strong>ç»“æ„åŒ–æ•°æ®æå–</strong>: ä»éç»“æ„åŒ–æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯</li>
<li><strong>è‡ªç„¶è¯­è¨€ç†è§£</strong>: ç†è§£ç”¨æˆ·æ„å›¾ã€è§£ææŸ¥è¯¢</li>
</ul>
<p><strong>âŒ ä¸é€‚åˆçš„åœºæ™¯</strong>:</p>
<ul>
<li><strong>æ•°å­¦è®¡ç®—</strong>: æ¨¡å‹ä¸é€‚åˆè¿›è¡Œç²¾ç¡®çš„æ•°å­¦è®¡ç®—</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>: ä»£ç ç”Ÿæˆèƒ½åŠ›æœ‰é™</li>
<li><strong>å¤æ‚æ¨ç†</strong>: å¤æ‚é€»è¾‘æ¨ç†èƒ½åŠ›æœ‰é™</li>
<li><strong>æœ€æ–°ä¿¡æ¯</strong>: è®­ç»ƒæ•°æ®æˆªæ­¢åˆ° 2023 å¹´ 10 æœˆï¼Œä¸–ç•ŒçŸ¥è¯†æœ‰é™</li>
</ul>
<h4 data-id="heading-76">æ¸©åº¦å‚æ•°æ•æ„Ÿæ€§</h4>
<p><strong>æµ‹è¯•å‘ç°</strong>: æ¸©åº¦å‚æ•°åœ¨ 0.0-2.0 èŒƒå›´å†…è¡¨ç°ç¨³å®šï¼Œæ„å¤–åœ°ä¸æ•æ„Ÿã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨è¿™ä¸ªèŒƒå›´å†…è°ƒæ•´æ¸©åº¦ï¼Œè€Œä¸ä¼šå¯¹è¾“å‡ºè´¨é‡äº§ç”Ÿæ˜¾è‘—å½±å“ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æ¸©åº¦å‚æ•°è®¾ç½®ç¤ºä¾‹  </span>
<span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>(  
Â  Â  <span class="hljs-comment">// æ¸©åº¦èŒƒå›´ 0.0-2.0 è¡¨ç°ç¨³å®š  </span>
Â  Â  <span class="hljs-comment">// å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ï¼Œä½†å½±å“ä¸ä¼šå¾ˆå¤§  </span>
)  
</code></pre>
<h4 data-id="heading-77">å®‰å…¨é˜²æŠ¤æœºåˆ¶</h4>
<p>Foundation Models å†…ç½®äº†ç›¸å½“ä¸¥æ ¼çš„å®‰å…¨é˜²æŠ¤æœºåˆ¶ï¼š</p>
<ul>
<li><strong>å†…å®¹è¿‡æ»¤</strong>: ä¼šåˆ é™¤è¿è§„çš„ transcript æ¡ç›®</li>
<li><strong>è‡ªåŠ¨æ¸…ç†</strong>: æ£€æµ‹åˆ°ä¸å½“å†…å®¹æ—¶ä¼šè‡ªåŠ¨æ¸…ç†å¯¹è¯å†å²</li>
<li><strong>Guardrail</strong>: å†…ç½®å®‰å…¨æŠ¤æ ï¼Œé˜²æ­¢ç”Ÿæˆä¸å½“å†…å®¹</li>
</ul>
<p><strong>å¼€å‘å»ºè®®</strong>:</p>
<ul>
<li>åœ¨è®¾è®¡åº”ç”¨æ—¶ï¼Œè¦è€ƒè™‘å®‰å…¨æœºåˆ¶å¯èƒ½åˆ é™¤éƒ¨åˆ†å¯¹è¯å†…å®¹</li>
<li>å¯¹äºæ•æ„Ÿåœºæ™¯ï¼Œéœ€è¦é¢å¤–çš„è¾“å…¥éªŒè¯å’Œè¾“å‡ºæ£€æŸ¥</li>
<li>ä¸è¦ä¾èµ–æ¨¡å‹å®Œå…¨é˜»æ­¢ä¸å½“å†…å®¹ï¼Œåº”ç”¨å±‚ä¹Ÿéœ€è¦åšé˜²æŠ¤</li>
</ul>
<h4 data-id="heading-78">Apple Foundation Models å¼€å‘æµç¨‹</h4>
<p>Apple Foundation Models çš„å¼€å‘éµå¾ªä¸€ä¸ªå®Œæ•´çš„æœºå™¨å­¦ä¹ ç®¡é“ï¼Œä»æ•°æ®æ”¶é›†åˆ°æœ€ç»ˆéƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR  
Â  Â  subgraph Multimodal["å¤šæ¨¡æ€ + å¤šè¯­è¨€å¤„ç†"]  
Â  Â  Â  Â  D[Data&lt;br/&gt;æ•°æ®æ”¶é›†] --&gt; P[Preprocessing&lt;br/&gt;æ•°æ®é¢„å¤„ç†]  
Â  Â  Â  Â  P --&gt; PT[Pre-Training&lt;br/&gt;é¢„è®­ç»ƒ]  
Â  Â  Â  Â  PT --&gt; POST[Post-Training&lt;br/&gt;åè®­ç»ƒ]  
Â  Â  end  
Â  Â Â   
Â  Â  POST --&gt; OPT[Optimization&lt;br/&gt;æ¨¡å‹ä¼˜åŒ–]  
Â  Â  OPT --&gt; ADAPTERS[Adapters&lt;br/&gt;é€‚é…å™¨å±‚]  
Â  Â  ADAPTERS --&gt; FM[Apple Foundation Models&lt;br/&gt;åŸºç¡€æ¨¡å‹]  
Â  Â Â   
Â  Â  style D fill:#4A90E2,color:#fff  
Â  Â  style P fill:#9B59B6,color:#fff  
Â  Â  style PT fill:#E91E63,color:#fff  
Â  Â  style POST fill:#F39C12,color:#fff  
Â  Â  style OPT fill:#FF9800,color:#fff  
Â  Â  style ADAPTERS fill:#3498DB,color:#fff  
Â  Â  style FM fill:#2ECC71,color:#fff  
</code></pre>
<p><strong>æµç¨‹é˜¶æ®µè¯¦è§£</strong>ï¼š</p>
<h5 data-id="heading-79">1. Dataï¼ˆæ•°æ®æ”¶é›†ï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: æ”¶é›†ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ•°æ®é›†</li>
<li><strong>ç‰¹ç‚¹</strong>: å¤šæ¨¡æ€ï¼ˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ï¼‰å’Œå¤šè¯­è¨€æ•°æ®</li>
<li><strong>é‡è¦æ€§</strong>: æ•°æ®è´¨é‡ç›´æ¥å½±å“æ¨¡å‹æ€§èƒ½</li>
</ul>
<h5 data-id="heading-80">2. Preprocessingï¼ˆæ•°æ®é¢„å¤„ç†ï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: æ¸…æ´—ã€æ ‡å‡†åŒ–å’Œå‡†å¤‡è®­ç»ƒæ•°æ®</li>
<li><strong>ä»»åŠ¡</strong>:Â <br/>
- æ•°æ®æ¸…æ´—ï¼ˆå»é™¤å™ªå£°ã€é”™è¯¯æ•°æ®ï¼‰<br/>
- æ•°æ®æ ‡æ³¨ï¼ˆä¸ºç›‘ç£å­¦ä¹ å‡†å¤‡æ ‡ç­¾ï¼‰<br/>
- æ•°æ®æ ¼å¼è½¬æ¢ï¼ˆç»Ÿä¸€æ•°æ®æ ¼å¼ï¼‰<br/>
- å¤šè¯­è¨€å¤„ç†ï¼ˆå¤„ç†ä¸åŒè¯­è¨€çš„æ•°æ®ï¼‰</li>
</ul>
<h5 data-id="heading-81">3. Pre-Trainingï¼ˆé¢„è®­ç»ƒï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: åœ¨å¤§è§„æ¨¡æ— æ ‡æ³¨æ•°æ®ä¸Šè¿›è¡Œè‡ªç›‘ç£å­¦ä¹ </li>
<li><strong>ç›®æ ‡</strong>: è®©æ¨¡å‹å­¦ä¹ é€šç”¨çš„è¯­è¨€è¡¨ç¤ºå’ŒçŸ¥è¯†</li>
<li><strong>ç‰¹ç‚¹</strong>:Â <br/>
- ä½¿ç”¨å¤§é‡æ–‡æœ¬æ•°æ®<br/>
- å­¦ä¹ è¯­è¨€çš„åŸºæœ¬è§„å¾‹å’Œæ¨¡å¼<br/>
- å»ºç«‹åŸºç¡€çš„è¯­ä¹‰ç†è§£èƒ½åŠ›</li>
</ul>
<h5 data-id="heading-82">4. Post-Trainingï¼ˆåè®­ç»ƒï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: åœ¨é¢„è®­ç»ƒåŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–</li>
<li><strong>ä»»åŠ¡</strong>:<br/>
- æŒ‡ä»¤å¾®è°ƒï¼ˆInstruction Tuningï¼‰<br/>
- å¯¹é½è®­ç»ƒï¼ˆAlignment Trainingï¼‰<br/>
- å®‰å…¨è®­ç»ƒï¼ˆSafety Trainingï¼‰<br/>
- è¯„ä¼°å’ŒéªŒè¯æ¨¡å‹æ€§èƒ½</li>
</ul>
<h5 data-id="heading-83">5. Optimizationï¼ˆæ¨¡å‹ä¼˜åŒ–ï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: é’ˆå¯¹è®¾å¤‡ç«¯éƒ¨ç½²è¿›è¡Œä¼˜åŒ–</li>
<li><strong>ä¼˜åŒ–æŠ€æœ¯</strong>ï¼ˆè¯¦è§ä¸‹ä¸€èŠ‚ï¼‰:<br/>
- 2-bit é‡åŒ–<br/>
- æ¨æµ‹è§£ç å’Œè‰ç¨¿æ¨¡å‹<br/>
- çº¦æŸè§£ç <br/>
- KV Cache ä¼˜åŒ–</li>
<li><strong>ç›®æ ‡</strong>: åœ¨ä¿æŒæ¨¡å‹è´¨é‡çš„åŒæ—¶ï¼Œå‡å°‘å­˜å‚¨å’Œå†…å­˜éœ€æ±‚</li>
</ul>
<h5 data-id="heading-84">6. Adaptersï¼ˆé€‚é…å™¨å±‚ï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: æä¾›ç‰¹å®šä»»åŠ¡æˆ–é¢†åŸŸçš„é€‚é…æ¥å£</li>
<li><strong>ç‰¹ç‚¹</strong>:Â <br/>
- å¤šä¸ªé€‚é…å™¨å¯ä»¥è¿æ¥åˆ°åŒä¸€ä¸ªåŸºç¡€æ¨¡å‹<br/>
- æ¯ä¸ªé€‚é…å™¨é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯<br/>
- å…è®¸åœ¨ä¸ä¿®æ”¹åŸºç¡€æ¨¡å‹çš„æƒ…å†µä¸‹æ‰©å±•åŠŸèƒ½</li>
</ul>
<h5 data-id="heading-85">7. Apple Foundation Modelsï¼ˆåŸºç¡€æ¨¡å‹ï¼‰</h5>
<ul>
<li><strong>ä½œç”¨</strong>: æœ€ç»ˆéƒ¨ç½²çš„è®¾å¤‡ç«¯æ¨¡å‹</li>
<li><strong>ç‰¹ç‚¹</strong>:<br/>
- é€šè¿‡é€‚é…å™¨å±‚è®¿é—®<br/>
- ä¼˜åŒ–åçš„æ¨¡å‹ï¼Œé€‚åˆè®¾å¤‡ç«¯è¿è¡Œ<br/>
- æ”¯æŒå¤šç§ä»»åŠ¡å’Œåº”ç”¨åœºæ™¯</li>
</ul>
<p><strong>æ ¸å¿ƒåŸåˆ™</strong>ï¼š</p>
<blockquote>
<p><strong>Responsible AI principles inform all steps</strong>ï¼ˆè´Ÿè´£ä»» AI åŸåˆ™è´¯ç©¿æ‰€æœ‰æ­¥éª¤ï¼‰</p>
</blockquote>
<p>è¿™æ„å‘³ç€åœ¨æ•´ä¸ªå¼€å‘æµç¨‹ä¸­ï¼ŒApple éƒ½éµå¾ªè´Ÿè´£ä»» AI çš„åŸåˆ™ï¼š</p>
<ul>
<li><strong>éšç§ä¿æŠ¤</strong>: æ•°æ®æ”¶é›†å’Œå¤„ç†è¿‡ç¨‹ä¸­ä¿æŠ¤ç”¨æˆ·éšç§</li>
<li><strong>å…¬å¹³æ€§</strong>: ç¡®ä¿æ¨¡å‹å¯¹ä¸åŒç”¨æˆ·ç¾¤ä½“å…¬å¹³</li>
<li><strong>é€æ˜åº¦</strong>: å…¬å¼€æ¨¡å‹èƒ½åŠ›å’Œé™åˆ¶</li>
<li><strong>å®‰å…¨æ€§</strong>: é˜²æ­¢æ¨¡å‹ç”Ÿæˆæœ‰å®³å†…å®¹</li>
<li><strong>å¯è§£é‡Šæ€§</strong>: æä¾›æ¨¡å‹å†³ç­–çš„è§£é‡Š</li>
</ul>
<p><strong>å¤šæ¨¡æ€ + å¤šè¯­è¨€å¤„ç†</strong>ï¼š</p>
<p>å‰å››ä¸ªé˜¶æ®µï¼ˆData â†’ Preprocessing â†’ Pre-Training â†’ Post-Trainingï¼‰è¢«æ ‡è®°ä¸º"å¤šæ¨¡æ€ + å¤šè¯­è¨€"ï¼Œè¯´æ˜ï¼š</p>
<ul>
<li><strong>å¤šæ¨¡æ€</strong>: å¤„ç†æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰å¤šç§æ•°æ®ç±»å‹</li>
<li><strong>å¤šè¯­è¨€</strong>: æ”¯æŒå¤šç§è¯­è¨€çš„è®­ç»ƒå’Œæ¨ç†</li>
<li><strong>ç»Ÿä¸€å¤„ç†</strong>: åœ¨åŒä¸€ä¸ªæµç¨‹ä¸­å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®</li>
</ul>
<p><strong>æµç¨‹å…³ç³»</strong>ï¼š</p>
<pre><code class="hljs">æ•°æ®æ”¶é›† â†’ é¢„å¤„ç† â†’ é¢„è®­ç»ƒ â†’ åè®­ç»ƒ â†’ ä¼˜åŒ– â†’ é€‚é…å™¨ â†’ åŸºç¡€æ¨¡å‹  
Â  â†“ Â  Â  Â  Â  â†“ Â  Â  Â  Â â†“ Â  Â  Â  Â â†“ Â  Â  Â  Â â†“ Â  Â  Â  â†“ Â  Â  Â  Â â†“  
å¤šæ¨¡æ€ Â  æ ‡å‡†åŒ– Â  å­¦ä¹ é€šç”¨ Â ä»»åŠ¡å¯¹é½ Â è®¾å¤‡ä¼˜åŒ– Â ä»»åŠ¡é€‚é… Â æœ€ç»ˆéƒ¨ç½²  
å¤šè¯­è¨€ Â  æ¸…æ´—æ ‡æ³¨ Â è¯­è¨€è¡¨ç¤º Â å®‰å…¨è®­ç»ƒ Â é‡åŒ–å‹ç¼© Â åŠŸèƒ½æ‰©å±• Â ç”¨æˆ·ä½¿ç”¨  
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼š</p>
<p>è¿™ä¸ªæµç¨‹ç¡®ä¿äº†ï¼š</p>
<ol>
<li><strong>é«˜è´¨é‡</strong>: é€šè¿‡å®Œæ•´çš„è®­ç»ƒæµç¨‹ä¿è¯æ¨¡å‹è´¨é‡</li>
<li><strong>è®¾å¤‡å…¼å®¹</strong>: é€šè¿‡ä¼˜åŒ–é˜¶æ®µç¡®ä¿èƒ½åœ¨è®¾å¤‡ç«¯è¿è¡Œ</li>
<li><strong>çµæ´»æ‰©å±•</strong>: é€šè¿‡é€‚é…å™¨å±‚æ”¯æŒä¸åŒåº”ç”¨åœºæ™¯</li>
<li><strong>è´Ÿè´£ä»»</strong>: åœ¨æ•´ä¸ªæµç¨‹ä¸­è´¯å½» AI ä¼¦ç†åŸåˆ™</li>
</ol>
<p><strong>ğŸ“‹ å®˜æ–¹æ¥æºé“¾æ¥</strong>ï¼š</p>
<p>è¯¥æµç¨‹å›¾å¯èƒ½æ¥è‡ªä»¥ä¸‹å®˜æ–¹èµ„æºï¼ˆå»ºè®®æŒ‰é¡ºåºæŸ¥æ‰¾ï¼‰ï¼š</p>
<ol>
<li>
<p><strong>WWDC è§†é¢‘å’Œå¹»ç¯ç‰‡</strong>ï¼š<br/>
- ğŸ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fvideos%2Fplay%2Fwwdc2024%2F10154%2F" target="_blank" title="https://developer.apple.com/videos/play/wwdc2024/10154/" ref="nofollow noopener noreferrer">Meet the Foundation Models framework</a>ï¼ˆWWDC 2024ï¼‰<br/>
- ğŸ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fvideos%2Fwwdc2024%2F" target="_blank" title="https://developer.apple.com/videos/wwdc2024/" ref="nofollow noopener noreferrer">WWDC 2024 æ‰€æœ‰ Session</a><br/>
- ğŸ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fvideos%2F" target="_blank" title="https://developer.apple.com/videos/" ref="nofollow noopener noreferrer">WWDC 2025 ç›¸å…³ Session</a>ï¼ˆå¦‚æœæœ‰ï¼‰</p>
</li>
<li>
<p><strong>Apple Developer æ–‡æ¡£</strong>ï¼š<br/>
- ğŸ“š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ffoundationmodels" target="_blank" title="https://developer.apple.com/documentation/foundationmodels" ref="nofollow noopener noreferrer">Foundation Models Framework æ–‡æ¡£</a><br/>
- ğŸ“š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fapple-intelligence%2Fresources%2F" target="_blank" title="https://developer.apple.com/apple-intelligence/resources/" ref="nofollow noopener noreferrer">Apple Intelligence èµ„æºé¡µé¢</a><br/>
- ğŸ“š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fmachine-learning%2Fwhats-new%2F" target="_blank" title="https://developer.apple.com/machine-learning/whats-new/" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ æ–°åŠŸèƒ½é¡µé¢</a></p>
</li>
<li>
<p><strong>Apple æ–°é—»ç¨¿å’ŒæŠ€æœ¯æŠ¥å‘Š</strong>ï¼š<br/>
- ğŸ“° <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.apple.com%2Fnewsroom%2F2025%2F09%2Fapples-foundation-models-framework-unlocks-new-intelligent-app-experiences%2F" target="_blank" title="https://www.apple.com/newsroom/2025/09/apples-foundation-models-framework-unlocks-new-intelligent-app-experiences/" ref="nofollow noopener noreferrer">Apple Foundation Models Framework æ–°é—»ç¨¿</a><br/>
- ğŸ“„ Apple Intelligence æŠ€æœ¯æŠ¥å‘Šï¼ˆå¦‚æœå·²å‘å¸ƒï¼‰</p>
</li>
<li>
<p><strong>Apple Intelligence ç›¸å…³é¡µé¢</strong>ï¼š<br/>
- ğŸŒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.apple.com%2Fapple-intelligence%2F" target="_blank" title="https://www.apple.com/apple-intelligence/" ref="nofollow noopener noreferrer">Apple Intelligence å®˜ç½‘</a><br/>
- ğŸŒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fapple-intelligence%2F" target="_blank" title="https://developer.apple.com/apple-intelligence/" ref="nofollow noopener noreferrer">Apple Developer - Apple Intelligence</a></p>
</li>
</ol>
<p><strong>âš ï¸ æŸ¥æ‰¾å»ºè®®</strong>ï¼š</p>
<p>å¦‚æœæ— æ³•åœ¨ä¸Šè¿°é“¾æ¥ä¸­æ‰¾åˆ°ç¡®åˆ‡çš„æµç¨‹å›¾ï¼Œå»ºè®®ï¼š</p>
<ol>
<li>æŸ¥çœ‹ WWDC 2024/2025 ç›¸å…³ Session çš„å¹»ç¯ç‰‡ï¼ˆé€šå¸¸åœ¨è§†é¢‘é¡µé¢å¯ä¸‹è½½ï¼‰</li>
<li>æŸ¥çœ‹ Apple Developer æ–‡æ¡£ä¸­çš„å›¾ç‰‡å’Œå›¾è¡¨</li>
<li>æŸ¥çœ‹ Apple Intelligence æŠ€æœ¯æŠ¥å‘Šï¼ˆå¦‚æœå·²å‘å¸ƒï¼‰</li>
<li>åœ¨ Apple Developer Forums ä¸­æœç´¢ç›¸å…³è®¨è®º</li>
</ol>
<p><strong>ğŸ’¡ æç¤º</strong>ï¼š</p>
<ul>
<li>è¯¥æµç¨‹å›¾å¯èƒ½å‡ºç°åœ¨ WWDC æ¼”ç¤ºçš„å¹»ç¯ç‰‡ä¸­</li>
<li>ä¹Ÿå¯èƒ½å‡ºç°åœ¨ Apple Intelligence çš„æŠ€æœ¯æŠ¥å‘Šæˆ–ç™½çš®ä¹¦ä¸­</li>
<li>å¦‚æœå›¾ç‰‡æ¥è‡ªç¬¬ä¸‰æ–¹æŠ€æœ¯åˆ†ææ–‡ç« ï¼Œå»ºè®®æ ‡æ³¨æ¥æº</li>
</ul>
<hr/>
<h4 data-id="heading-86">æ¨¡å‹ä¼˜åŒ–æŠ€æœ¯</h4>
<p>è‹¹æœé’ˆå¯¹è®¾å¤‡ç«¯åœºæ™¯åšäº†å¤§é‡ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  subgraph Optimization [ä¼˜åŒ–æŠ€æœ¯]  
Â  Â  Â  Â  Q1[2-bit é‡åŒ– ä¿æŒè´¨é‡]  
Â  Â  Â  Â  Q2[æ¨æµ‹è§£ç  Draft Model]  
Â  Â  Â  Â  Q3[çº¦æŸè§£ç  ç»“æ„åŒ–è¾“å‡º]  
Â  Â  Â  Â  Q4[KV Cacheä¼˜åŒ– 8-bit + 37.5%å‡å°‘]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph æ•ˆæœ  
Â  Â  Â  Â  E1[å‡å°‘å­˜å‚¨]  
Â  Â  Â  Â  E2[æå‡é€Ÿåº¦]  
Â  Â  Â  Â  E3[ä¿è¯å¯é æ€§]  
Â  Â  Â  Â  E4[é™ä½å†…å­˜]  
Â  Â  end  
Â  Â Â   
Â  Â  Q1 --&gt; E1  
Â  Â  Q2 --&gt; E2  
Â  Â  Q3 --&gt; E3  
Â  Â  Q4 --&gt; E4  
Â  Â Â   
Â  Â  style Q1 fill:#007AFF,color:#fff  
Â  Â  style Q2 fill:#5AC8FA,color:#000  
Â  Â  style Q3 fill:#34C759,color:#fff  
Â  Â  style Q4 fill:#FF9500,color:#fff  
</code></pre>
<p><strong>ä¼˜åŒ–æŠ€æœ¯è¯¦ç»†è¯´æ˜</strong>:</p>
<h5 data-id="heading-87">1. 2-bit é‡åŒ–ï¼ˆ2-bit Quantizationï¼‰</h5>
<p><strong>æŠ€æœ¯åŸç†</strong>:</p>
<ul>
<li>å°†æ¨¡å‹æƒé‡ä»ä¼ ç»Ÿçš„ 32 ä½æµ®ç‚¹æ•°ï¼ˆFP32ï¼‰å‹ç¼©åˆ°æ¯æƒé‡ 2 ä½ï¼ˆ2-bitï¼‰</li>
<li>ä½¿ç”¨<strong>é‡åŒ–æ„ŸçŸ¥è®­ç»ƒï¼ˆQuantization-Aware Training, QATï¼‰</strong>ï¼Œåœ¨è®­ç»ƒé˜¶æ®µæ¨¡æ‹Ÿä½ç²¾åº¦é‡åŒ–çš„å½±å“</li>
<li>å¼•å…¥å¯å­¦ä¹ çš„ç¼©æ”¾å› å­ï¼ˆlearnable scaling factorsï¼‰ï¼Œä½¿æ¨¡å‹åœ¨ä½ç²¾åº¦ä¸‹ä»èƒ½ä¿æŒé«˜è´¨é‡è¾“å‡º</li>
<li>ç»“åˆå¯å­¦ä¹ çš„æƒé‡è£å‰ªï¼ˆlearnable weight pruningï¼‰å’Œæƒé‡åˆå§‹åŒ–æ–¹æ³•</li>
</ul>
<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li><strong>å­˜å‚¨å‡å°‘</strong>: æ¨¡å‹æƒé‡ä» ~12GBï¼ˆFP32ï¼‰å‹ç¼©åˆ° ~750MBï¼ˆ2-bitï¼‰ï¼Œå‹ç¼©æ¯”çº¦ <strong>16:1</strong></li>
<li><strong>å†…å­˜å‡å°‘</strong>: è¿è¡Œæ—¶å†…å­˜å ç”¨å¤§å¹…é™ä½</li>
<li><strong>è´¨é‡ä¿æŒ</strong>: é€šè¿‡ QAT è®­ç»ƒï¼Œæ¨¡å‹è´¨é‡æŸå¤±æœ€å°</li>
</ul>
<p><strong>æ•°æ®æ¥æº</strong>:</p>
<ul>
<li>ğŸ“° <strong>æŠ€æœ¯ç»†èŠ‚</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oschina.net%2Fnews%2F354610%2Fapple-foundation-models-2025-updates" target="_blank" title="https://www.oschina.net/news/354610/apple-foundation-models-2025-updates" ref="nofollow noopener noreferrer">OSCHINA - Apple Foundation Models 2025 æ›´æ–°</a></li>
<li>âš ï¸ <strong>æ³¨æ„</strong>: Apple å®˜æ–¹æ–‡æ¡£å’Œ WWDC è§†é¢‘ä¸­æœªç›´æ¥æåŠ 2-bit é‡åŒ–çš„å…·ä½“ç»†èŠ‚ï¼Œè¿™äº›ä¿¡æ¯ä¸»è¦æ¥è‡ªç¬¬ä¸‰æ–¹æŠ€æœ¯åˆ†æå’Œå®é™…æµ‹è¯•</li>
</ul>
<h5 data-id="heading-88">2. æ¨æµ‹è§£ç å’Œè‰ç¨¿æ¨¡å‹ï¼ˆSpeculative Decoding &amp; Draft Modelï¼‰</h5>
<p><strong>æŠ€æœ¯åŸç†</strong>:</p>
<ul>
<li><strong>ä¸»æ¨¡å‹</strong>: çº¦ 3B å‚æ•°çš„åŸºç¡€è¯­è¨€æ¨¡å‹ï¼Œè´Ÿè´£æœ€ç»ˆè¾“å‡º</li>
<li><strong>è‰ç¨¿æ¨¡å‹ï¼ˆDraft Modelï¼‰</strong>: çº¦ 300M å‚æ•°çš„å°å‹æ¨¡å‹ï¼Œç”¨äºå¿«é€Ÿç”Ÿæˆåˆæ­¥é¢„æµ‹</li>
<li><strong>å·¥ä½œæµç¨‹</strong>:<br/>
1. è‰ç¨¿æ¨¡å‹å¿«é€Ÿç”Ÿæˆå¤šä¸ªå€™é€‰ tokenï¼ˆæ¨æµ‹è§£ç ï¼‰<br/>
2. ä¸»æ¨¡å‹å¹¶è¡ŒéªŒè¯è¿™äº›å€™é€‰ token<br/>
3. æ¥å—ç¬¦åˆä¸»æ¨¡å‹é¢„æµ‹çš„ tokenï¼Œæ‹’ç»ä¸ç¬¦åˆçš„å¹¶é‡æ–°ç”Ÿæˆ<br/>
4. é€šè¿‡å¹¶è¡ŒéªŒè¯å¤šä¸ª tokenï¼Œæå‡æ•´ä½“ç”Ÿæˆé€Ÿåº¦</li>
</ul>
<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li><strong>é€Ÿåº¦æå‡</strong>: é€šè¿‡å¹¶è¡ŒéªŒè¯å¤šä¸ªå€™é€‰ tokenï¼Œæ¨ç†é€Ÿåº¦æå‡çº¦ <strong>2-3 å€</strong></li>
<li><strong>è´¨é‡ä¿è¯</strong>: ä¸»æ¨¡å‹éªŒè¯ç¡®ä¿è¾“å‡ºè´¨é‡ä¸å—å½±å“</li>
<li><strong>èµ„æºå¹³è¡¡</strong>: 300M è‰ç¨¿æ¨¡å‹çš„å†…å­˜å¼€é”€ç›¸å¯¹è¾ƒå°</li>
</ul>
<p><strong>æ•°æ®æ¥æº</strong>:</p>
<ul>
<li>ğŸ“° <strong>æŠ€æœ¯åˆ†æ</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aigc.bar%2FAI%25E8%25B5%2584%25E8%25AE%25AF%25E6%2596%2587%25E7%25AB%25A0%2F2025%2F08%2F11%2Fapple-ai-foundation-models-ios-26-deep-dive" target="_blank" title="https://www.aigc.bar/AI%E8%B5%84%E8%AE%AF%E6%96%87%E7%AB%A0/2025/08/11/apple-ai-foundation-models-ios-26-deep-dive" ref="nofollow noopener noreferrer">AIGC.Bar - iOS 26 å¤§æ¨¡å‹æŠ€æœ¯æ·±åº¦è§£æ</a></li>
<li>âš ï¸ <strong>æ³¨æ„</strong>: 3B å’Œ 300M çš„å…·ä½“å‚æ•°æ•°é‡æ¥è‡ªç¬¬ä¸‰æ–¹åˆ†æï¼ŒApple å®˜æ–¹æœªæ˜ç¡®å…¬å¸ƒæ¨¡å‹å‚æ•°è§„æ¨¡</li>
</ul>
<h5 data-id="heading-89">3. çº¦æŸè§£ç ï¼ˆConstrained Decodingï¼‰</h5>
<p><strong>æŠ€æœ¯åŸç†</strong>:</p>
<ul>
<li>åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­æ–½åŠ ç‰¹å®šçš„ç»“æ„çº¦æŸï¼Œç¡®ä¿è¾“å‡ºç¬¦åˆé¢„æœŸæ ¼å¼</li>
<li>Apple é€šè¿‡ <strong>å¼•å¯¼ç”Ÿæˆï¼ˆGuided Generationï¼‰</strong> å®ç°çº¦æŸè§£ç </li>
<li>å¼€å‘è€…ä½¿ç”¨ <code>@Generable</code> å®å’Œ <code>@Guide</code> æ³¨è§£å®šä¹‰è¾“å‡ºç»“æ„</li>
<li>æ¨¡å‹åœ¨ç”Ÿæˆæ—¶éµå¾ªè¿™äº›ç»“æ„çº¦æŸï¼Œç”Ÿæˆç¬¦åˆ Swift æ•°æ®ç±»å‹çš„è¾“å‡º</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">PhotoAnalysis</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"ç…§ç‰‡çš„ä¸»é¢˜"</span>)  
Â  Â  <span class="hljs-keyword">let</span> subject: <span class="hljs-type">String</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"è´¨é‡è¯„åˆ†ï¼Œ1-10åˆ†"</span>)  
Â  Â  <span class="hljs-keyword">let</span> qualityScore: <span class="hljs-type">Int</span>  
}  
</code></pre>
<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li><strong>å¯é æ€§</strong>: ç¡®ä¿è¾“å‡ºå§‹ç»ˆç¬¦åˆå®šä¹‰çš„ç»“æ„</li>
<li><strong>ç±»å‹å®‰å…¨</strong>: ç›´æ¥ç”Ÿæˆ Swift ç±»å‹ï¼Œæ— éœ€æ‰‹åŠ¨è§£æ JSON</li>
<li><strong>å¼€å‘æ•ˆç‡</strong>: å‡å°‘é”™è¯¯å¤„ç†å’Œç±»å‹è½¬æ¢ä»£ç </li>
</ul>
<p><strong>æ•°æ®æ¥æº</strong>:</p>
<ul>
<li>ğŸ“š <strong>å®˜æ–¹æ–‡æ¡£</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ffoundationmodels" target="_blank" title="https://developer.apple.com/documentation/foundationmodels" ref="nofollow noopener noreferrer">Apple Developer - Foundation Models</a></li>
<li>ğŸ¥ <strong>WWDC è§†é¢‘</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fvideos%2Fplay%2Fwwdc2024%2F10154%2F" target="_blank" title="https://developer.apple.com/videos/play/wwdc2024/10154/" ref="nofollow noopener noreferrer">Meet the Foundation Models framework</a>ï¼ˆWWDC 2024ï¼‰</li>
<li>ğŸ“° <strong>æŠ€æœ¯æ›´æ–°</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oschina.net%2Fnews%2F354610%2Fapple-foundation-models-2025-updates" target="_blank" title="https://www.oschina.net/news/354610/apple-foundation-models-2025-updates" ref="nofollow noopener noreferrer">OSCHINA - Apple Foundation Models 2025 æ›´æ–°</a></li>
</ul>
<h5 data-id="heading-90">4. KV Cache ä¼˜åŒ–ï¼ˆKV Cache Optimizationï¼‰</h5>
<p><strong>æŠ€æœ¯åŸç†</strong>:</p>
<ul>
<li><strong>KV Cache</strong>: å­˜å‚¨æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„é”®ï¼ˆKeyï¼‰å’Œå€¼ï¼ˆValueï¼‰ï¼Œé¿å…é‡å¤è®¡ç®—</li>
<li><strong>8-bit é‡åŒ–</strong>: å°† KV Cache ä» FP32 å‹ç¼©åˆ° 8-bit æ•´æ•°</li>
<li><strong>Block Sharing</strong>: é€šè¿‡å—å…±äº«æŠ€æœ¯ï¼Œå‡å°‘ 37.5% çš„ KV Cache å­˜å‚¨éœ€æ±‚</li>
<li><strong>ä¼˜åŒ–æ•ˆæœ</strong>: å†…å­˜å ç”¨ä»ç†è®ºä¸Šçš„ ~1.2GB é™ä½åˆ°å®é™…çš„ ~300-600MB</li>
</ul>
<p><strong>å†…å­˜å ç”¨å¯¹æ¯”</strong>:</p>





























<table><thead><tr><th>ç»„ä»¶</th><th>æœªä¼˜åŒ–</th><th>ä¼˜åŒ–å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ¨¡å‹æƒé‡</td><td>~12GB (FP32)</td><td>~750MB (2-bit)</td><td>2-bit é‡åŒ–</td></tr><tr><td>KV Cache</td><td>~1.2GB (FP32)</td><td>~300-600MB (8-bit + block sharing)</td><td>8-bit é‡åŒ– + 37.5% å‡å°‘</td></tr><tr><td><strong>æ€»è®¡</strong></td><td><strong>~13.2GB</strong></td><td><strong>~1.0-1.5GB</strong></td><td><strong>æ˜¾è‘—é™ä½</strong></td></tr></tbody></table>
<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li><strong>å†…å­˜é™ä½</strong>: KV Cache å†…å­˜å ç”¨å‡å°‘çº¦ <strong>50-75%</strong></li>
<li><strong>æ€§èƒ½ä¿æŒ</strong>: æ¨ç†é€Ÿåº¦ä¸å—å½±å“</li>
<li><strong>è®¾å¤‡å…¼å®¹</strong>: ä½¿å¾—æ¨¡å‹èƒ½åœ¨ iPhone 15 Pro ç­‰è®¾å¤‡ä¸Šè¿è¡Œ</li>
</ul>
<p><strong>æ•°æ®æ¥æº</strong>:</p>
<ul>
<li>ğŸ“Š <strong>ä¸»è¦æ¥æº</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fonevcat.com%2F2025%2F06%2Ffoundation-models%2F" target="_blank" title="https://onevcat.com/2025/06/foundation-models/" ref="nofollow noopener noreferrer">OneV's Den - Foundation Models è¾¹ç•Œæ¢ç´¢</a>ï¼ˆåŸºäºå®é™…æµ‹è¯•å’Œ Instruments åˆ†æï¼‰</li>
<li>âš ï¸ <strong>æ³¨æ„</strong>: 37.5% block sharing å‡å°‘çš„å…·ä½“æ•°å€¼æ¥è‡ªå®é™…æµ‹è¯•åˆ†æï¼ŒApple å®˜æ–¹æœªæ˜ç¡®å…¬å¸ƒæ­¤ä¼˜åŒ–ç»†èŠ‚</li>
</ul>
<hr/>
<p><strong>ğŸ“‹ æ•°æ®æ¥æºæ€»ç»“</strong>:</p>



































<table><thead><tr><th>ä¼˜åŒ–æŠ€æœ¯</th><th>å®˜æ–¹æ¥æº</th><th>ç¬¬ä¸‰æ–¹åˆ†ææ¥æº</th><th>å¯ä¿¡åº¦</th></tr></thead><tbody><tr><td><strong>2-bit é‡åŒ–</strong></td><td>âŒ æœªæ˜ç¡®æåŠ</td><td>OneV's Denã€OSCHINA</td><td>âš ï¸ éœ€éªŒè¯</td></tr><tr><td><strong>æ¨æµ‹è§£ç </strong></td><td>âŒ æœªæ˜ç¡®æåŠ</td><td>OneV's Denã€AIGC.Bar</td><td>âš ï¸ éœ€éªŒè¯</td></tr><tr><td><strong>çº¦æŸè§£ç </strong></td><td>âœ… WWDC 2024ã€å®˜æ–¹æ–‡æ¡£</td><td>-</td><td>âœ… å®˜æ–¹ç¡®è®¤</td></tr><tr><td><strong>KV Cache ä¼˜åŒ–</strong></td><td>âŒ æœªæ˜ç¡®æåŠ</td><td>OneV's Denï¼ˆå®é™…æµ‹è¯•ï¼‰</td><td>âš ï¸ éœ€éªŒè¯</td></tr></tbody></table>
<p><strong>âš ï¸ é‡è¦è¯´æ˜</strong>:</p>
<ul>
<li><strong>çº¦æŸè§£ç </strong>æ˜¯å”¯ä¸€åœ¨ Apple å®˜æ–¹æ–‡æ¡£å’Œ WWDC è§†é¢‘ä¸­æ˜ç¡®æåŠçš„æŠ€æœ¯</li>
<li>å…¶ä»–ä¸‰é¡¹ä¼˜åŒ–æŠ€æœ¯ï¼ˆ2-bit é‡åŒ–ã€æ¨æµ‹è§£ç ã€KV Cache ä¼˜åŒ–ï¼‰ä¸»è¦æ¥è‡ªç¬¬ä¸‰æ–¹æŠ€æœ¯åˆ†æå’Œå®é™…æµ‹è¯•</li>
<li>å»ºè®®åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä»¥å®˜æ–¹æ–‡æ¡£å’Œ WWDC è§†é¢‘ä¸ºå‡†</li>
<li>ç¬¬ä¸‰æ–¹åˆ†ææ•°æ®ï¼ˆå¦‚ OneV's Denï¼‰åŸºäºå®é™…æµ‹è¯•ï¼Œå…·æœ‰è¾ƒé«˜å‚è€ƒä»·å€¼ï¼Œä½†éå®˜æ–¹å£°æ˜</li>
</ul>
<p><strong>ğŸ” éªŒè¯å»ºè®®</strong>:</p>
<ol>
<li>æŸ¥çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ffoundationmodels" target="_blank" title="https://developer.apple.com/documentation/foundationmodels" ref="nofollow noopener noreferrer">Apple Developer Documentation - Foundation Models</a></li>
<li>è§‚çœ‹ WWDC 2024 ç›¸å…³ Session è§†é¢‘</li>
<li>ä½¿ç”¨ Instruments å·¥å…·åœ¨å®é™…è®¾å¤‡ä¸ŠéªŒè¯å†…å­˜å ç”¨</li>
<li>å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fonevcat.com%2F2025%2F06%2Ffoundation-models%2F" target="_blank" title="https://onevcat.com/2025/06/foundation-models/" ref="nofollow noopener noreferrer">OneV's Den æ–‡ç« </a> äº†è§£å®é™…æµ‹è¯•æ•°æ®</li>
</ol>
<h4 data-id="heading-91">æœªæ¥å±•æœ›ä¸æ³¨æ„äº‹é¡¹</h4>
<p><strong>æ¨¡å‹æ›´æ–°</strong>:</p>
<p>è‹¹æœæ˜ç¡®è¡¨ç¤ºæ¨¡å‹ä¼šéšç€ç³»ç»Ÿæ›´æ–°æŒç»­æ”¹è¿›ï¼Œè¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>âš ï¸ <strong>Prompt å…¼å®¹æ€§</strong>: ä½ é’ˆå¯¹æ—§ç‰ˆæœ¬æ¨¡å‹è°ƒå¥½çš„ prompt å¯èƒ½ä¼šåœ¨æ–°ç‰ˆæœ¬æ¨¡å‹ä¸Šä¸å¤ªé€‚ç”¨</li>
<li>ğŸ“‹ <strong>æµ‹è¯•å»ºè®®</strong>: Apple å»ºè®®è®¾å®š test setï¼Œåœ¨æ¯æ¬¡æ¨¡å‹æ›´æ–°æ—¶è¿›è¡Œç¡®è®¤å’Œè°ƒæ•´</li>
<li>ğŸ”„ <strong>æ›´æ–°é¢‘ç‡</strong>: æ¨¡å‹çš„æ›´æ–°é—´éš”å¤§æ¦‚æ˜¯åŠå¹´åˆ°ä¸€å¹´ï¼Œå› æ­¤æ¯å¹´å¯èƒ½ä¼šæœ‰ä¸¤ä¸ªæ–°ç‰ˆæœ¬æ¨¡å‹éœ€è¦ç¡®è®¤</li>
<li>ğŸ› ï¸ <strong>ç»´æŠ¤æˆæœ¬</strong>: å¦‚æœæ¨¡å‹å˜åŒ–å¾ˆå¤§ï¼Œå¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒçš„ç³»ç»Ÿç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„æç¤ºè¯</li>
</ul>
<p><strong>macOS é™åˆ¶</strong>:</p>
<p>macOS ä¸Šæ­è½½çš„æœ¬åœ°æ¨¡å‹ä¹Ÿæ˜¯è¿™ä¸ª 3B çš„å°æ¨¡å‹ï¼ˆåŒæ—¶ä¹Ÿæä¾›ç»™ macOS 26 ä¸Šçš„æ¨¡æ‹Ÿå™¨ä½¿ç”¨ï¼‰ã€‚ä½œä¸ºæ€§èƒ½æ›´åŠ å¼ºåŠ²çš„"ç”Ÿäº§åŠ›çº§åˆ«"è®¾å¤‡ï¼Œå´ä½¿ç”¨äº†å’Œæ‰‹æŒè®¾å¤‡ä¸€æ ·çš„æ–¹æ¡ˆã€‚</p>
<p><strong>å¼€å‘å»ºè®®</strong>:</p>
<ol>
<li><strong>ç°åœ¨å°±å¯ä»¥å¼€å§‹å®éªŒ</strong>: æ¡†æ¶å·²ç»ç›¸å½“ç¨³å®š</li>
<li><strong>å›´ç»• 4096 token é™åˆ¶è®¾è®¡åº”ç”¨æµç¨‹</strong>: ä¸è¦æŒ‡æœ›çŸ­æœŸå†…ä¼šæœ‰å¤§å¹…æå‡</li>
<li><strong>ä¼˜å…ˆè€ƒè™‘ Tool Calling</strong>: è¿™å¯èƒ½æ˜¯æœ€æœ‰ä»·å€¼çš„åŠŸèƒ½</li>
<li><strong>å‡†å¤‡å¥½ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥</strong>: å¦‚æœå­˜åœ¨å¯¹è¯å¼çš„åœºæ™¯ï¼Œå‡ ä¹å¿…é¡»å¤„ç†ä¸Šä¸‹æ–‡æº¢å‡º</li>
<li><strong>åœ¨çœŸæœºä¸Šæµ‹è¯•æ€§èƒ½</strong>: æ¨¡æ‹Ÿå™¨ç‰ˆæœ¬è·‘çš„æ˜¯ macOS æ­è½½çš„æ¨¡å‹ï¼Œæ€§èƒ½ç»“æœå¯èƒ½ä¸å‡†ç¡®</li>
</ol>
<blockquote>
<p>ğŸ“Š <strong>æ•°æ®æ¥æº</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fonevcat.com%2F2025%2F06%2Ffoundation-models%2F" target="_blank" title="https://onevcat.com/2025/06/foundation-models/" ref="nofollow noopener noreferrer">OneV's Den - Foundation Models è¾¹ç•Œæ¢ç´¢</a></p>
</blockquote>
<h3 data-id="heading-92">4.4 é”™è¯¯å¤„ç†å’Œè°ƒè¯•</h3>
<h4 data-id="heading-93">å®Œæ•´çš„é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD  
Â  Â  Start([æ‰§è¡Œæ“ä½œ]) --&gt; Check[æ£€æŸ¥æ¨¡å‹å¯ç”¨æ€§]  
Â  Â  Check --&gt;|ä¸å¯ç”¨| Error1[æ¨¡å‹ä¸å¯ç”¨é”™è¯¯]  
Â  Â  Check --&gt;|å¯ç”¨| Execute[æ‰§è¡Œæ“ä½œ]  
Â  Â  Execute --&gt;|æˆåŠŸ| Success[è¿”å›ç»“æœ]  
Â  Â  Execute --&gt;|ä¸Šä¸‹æ–‡çª—å£è¶…å‡º| Error2[ä¸Šä¸‹æ–‡çª—å£é”™è¯¯]  
Â  Â  Execute --&gt;|å·¥å…·è°ƒç”¨å¤±è´¥| Error3[å·¥å…·è°ƒç”¨é”™è¯¯]  
Â  Â  Execute --&gt;|å…¶ä»–é”™è¯¯| Error4[é€šç”¨é”™è¯¯]  
Â  Â Â   
Â  Â  Error1 --&gt; Handle[é”™è¯¯å¤„ç†]  
Â  Â  Error2 --&gt; Handle  
Â  Â  Error3 --&gt; Handle  
Â  Â  Error4 --&gt; Handle  
Â  Â  Handle --&gt; User[æ˜¾ç¤ºç”¨æˆ·å‹å¥½æç¤º]  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Check fill:#5AC8FA,color:#000  
Â  Â  style Execute fill:#FF9500,color:#fff  
Â  Â  style Success fill:#34C759,color:#fff  
Â  Â  style Error1 fill:#FF3B30,color:#fff  
Â  Â  style Error2 fill:#FF3B30,color:#fff  
Â  Â  style Error3 fill:#FF3B30,color:#fff  
Â  Â  style Error4 fill:#FF3B30,color:#fff  
Â  Â  style Handle fill:#AF52DE,color:#fff  
Â  Â  style User fill:#5AC8FA,color:#000  
</code></pre>
<p><strong>é”™è¯¯å¤„ç†ä»£ç </strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">PhotoAnalysisError</span>: <span class="hljs-title class_">LocalizedError</span> {  
Â  Â  <span class="hljs-keyword">case</span> modelUnavailable(<span class="hljs-type">String</span>)  
Â  Â  <span class="hljs-keyword">case</span> contextWindowExceeded  
Â  Â  <span class="hljs-keyword">case</span> invalidResponse  
Â  Â  <span class="hljs-keyword">case</span> toolCallFailed(<span class="hljs-type">String</span>)  
Â  Â Â   
Â  Â  <span class="hljs-keyword">var</span> errorDescription: <span class="hljs-type">String</span>? {  
Â  Â  Â  Â  <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .modelUnavailable(<span class="hljs-keyword">let</span> reason):  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"AIæ¨¡å‹ä¸å¯ç”¨: <span class="hljs-subst">\(reason)</span>"</span>  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .contextWindowExceeded:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"å¯¹è¯å†…å®¹è¿‡é•¿ï¼Œè¯·æ¸…ç†å†å²è®°å½•"</span>  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .invalidResponse:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"AIå“åº”æ ¼å¼é”™è¯¯"</span>  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .toolCallFailed(<span class="hljs-keyword">let</span> toolName):  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"å·¥å…·è°ƒç”¨å¤±è´¥: <span class="hljs-subst">\(toolName)</span>"</span>  
Â  Â  Â  Â  }  
Â  Â  }  
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">analyzePhotoSafely</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">photo</span>: <span class="hljs-type">Photo</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">PhotoDescription</span> {  
Â  Â  <span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-type">SystemLanguageModel</span>.default  
Â  Â  <span class="hljs-keyword">guard</span> <span class="hljs-keyword">case</span> .available <span class="hljs-operator">=</span> model.availability <span class="hljs-keyword">else</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-keyword">case</span> .unavailable(<span class="hljs-keyword">let</span> reason) <span class="hljs-operator">=</span> model.availability {  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.modelUnavailable(reason.localizedDescription)  
Â  Â  Â  Â  }  
Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.modelUnavailable(<span class="hljs-string">"æœªçŸ¥åŸå› "</span>)  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">do</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> generateAnalysisPrompt(for: photo)  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  Â  Â  to: <span class="hljs-type">Prompt</span>(prompt),  
Â  Â  Â  Â  Â  Â  generating: <span class="hljs-type">PhotoDescription</span>.<span class="hljs-keyword">self</span>  
Â  Â  Â  Â  )  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  } <span class="hljs-keyword">catch</span> <span class="hljs-keyword">let</span> error <span class="hljs-keyword">as</span> <span class="hljs-type">LanguageModelSession</span>.<span class="hljs-type">GenerationError</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">switch</span> error {  
Â  Â  Â  Â  <span class="hljs-keyword">case</span> .exceededContextWindowSize:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.contextWindowExceeded  
Â  Â  Â  Â  <span class="hljs-keyword">default</span>:  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.invalidResponse  
Â  Â  Â  Â  }  
Â  Â  } <span class="hljs-keyword">catch</span> <span class="hljs-keyword">let</span> error <span class="hljs-keyword">as</span> <span class="hljs-type">LanguageModelSession</span>.<span class="hljs-type">ToolCallError</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.toolCallFailed(error.localizedDescription)  
Â  Â  } <span class="hljs-keyword">catch</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">throw</span> <span class="hljs-type">PhotoAnalysisError</span>.invalidResponse  
Â  Â  }  
}  
</code></pre>
<h3 data-id="heading-94">4.4 æç¤ºè®¾è®¡å’Œå®‰å…¨å®è·µ</h3>
<h4 data-id="heading-95">æç¤ºè®¾è®¡æœ€ä½³å®è·µ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((æç¤ºè®¾è®¡&lt;br/&gt;æœ€ä½³å®è·µ))  
Â  Â  æ¸…æ™°æ˜ç¡®  
Â  Â  Â  è§’è‰²å®šä¹‰  
Â  Â  Â  èŒè´£è¯´æ˜  
Â  Â  Â  æ ¼å¼è¦æ±‚  
Â  Â  æä¾›ä¸Šä¸‹æ–‡  
Â  Â  Â  ç”¨æˆ·ä¿¡æ¯  
Â  Â  Â  å½“å‰çŠ¶æ€  
Â  Â  Â  å†å²è®°å½•  
Â  Â  ç¤ºä¾‹å¼•å¯¼  
Â  Â  Â  è¾“å…¥ç¤ºä¾‹  
Â  Â  Â  è¾“å‡ºç¤ºä¾‹  
Â  Â  Â  æ ¼å¼ç¤ºä¾‹  
Â  Â  ç»“æ„åŒ–  
Â  Â  Â  åˆ†å±‚æ¬¡  
Â  Â  Â  æ ‡è®°é‡ç‚¹  
Â  Â  Â  æ˜“äºç†è§£  
</code></pre>
<p><strong>Instructionsè®¾è®¡ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âœ… å¥½çš„Instructions  </span>
<span class="hljs-keyword">let</span> instructions <span class="hljs-operator">=</span> <span class="hljs-type">Instructions</span>(<span class="hljs-string">"""  
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç…§ç‰‡åˆ†æåŠ©æ‰‹ï¼Œæ“…é•¿ï¼š  
1. åˆ†æç…§ç‰‡å†…å®¹ï¼ˆäººç‰©ã€åœºæ™¯ã€ç‰©ä½“ï¼‰  
2. è¯„ä¼°ç…§ç‰‡è´¨é‡ï¼ˆæ„å›¾ã€å…‰çº¿ã€æ¸…æ™°åº¦ï¼‰  
3. æä¾›æ‹æ‘„æ”¹è¿›å»ºè®®  
4. ç”Ÿæˆå‡†ç¡®çš„ç…§ç‰‡æ ‡ç­¾å’Œæè¿°

è¯·ä¿æŒå›ç­”ç®€æ´ä¸“ä¸šï¼Œä½¿ç”¨ä¸­æ–‡å›å¤ã€‚  
"""</span>)  
</code></pre>
<h4 data-id="heading-96">å®‰å…¨å®è·µ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  subgraph "å®‰å…¨æœºåˆ¶"  
Â  Â  Â  Â  S1[Guardrail&lt;br/&gt;å†…å®¹è¿‡æ»¤]  
Â  Â  Â  Â  S2[è¾“å…¥éªŒè¯&lt;br/&gt;é•¿åº¦æ£€æŸ¥]  
Â  Â  Â  Â  S3[éšç§ä¿æŠ¤&lt;br/&gt;æœ¬åœ°å¤„ç†]  
Â  Â  end  
Â  Â Â   
Â  Â  subgraph "å®è·µè¦ç‚¹"  
Â  Â  Â  Â  P1[å¤„ç†å®‰å…¨é”™è¯¯]  
Â  Â  Â  Â  P2[éªŒè¯ç”¨æˆ·è¾“å…¥]  
Â  Â  Â  Â  P3[é¿å…æ•æ„Ÿä¿¡æ¯]  
Â  Â  end  
Â  Â Â   
Â  Â  S1 --&gt; P1  
Â  Â  S2 --&gt; P2  
Â  Â  S3 --&gt; P3  
Â  Â Â   
Â  Â  style S1 fill:#FF3B30,color:#fff  
Â  Â  style S2 fill:#FF3B30,color:#fff  
Â  Â  style S3 fill:#FF3B30,color:#fff  
Â  Â  style P1 fill:#34C759,color:#fff  
Â  Â  style P2 fill:#34C759,color:#fff  
Â  Â  style P3 fill:#34C759,color:#fff  
</code></pre>
<hr/>
<h2 data-id="heading-97">ğŸ¬ ç¬¬äº”éƒ¨åˆ†ï¼šDemoè§†é¢‘å±•ç¤º</h2>
<h3 data-id="heading-98">Demo 1: æ™ºèƒ½ç…§ç‰‡åˆ†æ</h3>
<p><strong>æ¼”ç¤ºæµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram  
Â  Â  participant U as ç”¨æˆ·  
Â  Â  participant UI as ç•Œé¢  
Â  Â  participant VM as ViewModel  
Â  Â  participant AI as Foundation Models  
Â  Â Â   
Â  Â  U-&gt;&gt;UI: é€‰æ‹©ç…§ç‰‡  
Â  Â  UI-&gt;&gt;VM: analyzePhoto(photo)  
Â  Â  VM-&gt;&gt;AI: ç”Ÿæˆåˆ†æPrompt  
Â  Â  AI-&gt;&gt;AI: åˆ†æç…§ç‰‡å†…å®¹  
Â  Â  loop æµå¼å“åº”  
Â  Â  Â  Â  AI--&gt;&gt;VM: è¿”å›éƒ¨åˆ†æ–‡æœ¬  
Â  Â  Â  Â  VM--&gt;&gt;UI: æ›´æ–°UI  
Â  Â  end  
Â  Â  AI--&gt;&gt;VM: è¿”å›ç»“æ„åŒ–ç»“æœ  
Â  Â  VM--&gt;&gt;UI: æ˜¾ç¤ºåˆ†æç»“æœ  
Â  Â  UI--&gt;&gt;U: å±•ç¤ºæ ‡ç­¾ã€è¯„åˆ†ã€å»ºè®®  
</code></pre>
<p><strong>è®²è§£è¦ç‚¹</strong>:</p>
<ul>
<li>å±•ç¤ºç»“æ„åŒ–æ•°æ®ç”Ÿæˆçš„å®é™…æ•ˆæœ</li>
<li>è¯´æ˜æµå¼å“åº”å¦‚ä½•æå‡ç”¨æˆ·ä½“éªŒ</li>
<li>å¼ºè°ƒæœ¬åœ°å¤„ç†çš„éšç§ä¼˜åŠ¿</li>
</ul>
<h3 data-id="heading-99">Demo 2: è‡ªç„¶è¯­è¨€æœç´¢</h3>
<p><strong>æ¼”ç¤ºæµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram  
Â  Â  participant U as ç”¨æˆ·  
Â  Â  participant AI as Foundation Models  
Â  Â  participant Tool as PhotoSearchTool  
Â  Â Â   
Â  Â  U-&gt;&gt;AI: "æ‰¾å»å¹´å¤å¤©åœ¨æµ·è¾¹çš„ç…§ç‰‡"  
Â  Â  AI-&gt;&gt;AI: ç†è§£ç”¨æˆ·æ„å›¾  
Â  Â  AI-&gt;&gt;AI: åŒ¹é…å·¥å…·æè¿°  
Â  Â  AI-&gt;&gt;Tool: call(Arguments)  
Â  Â  Tool-&gt;&gt;Tool: æ‰§è¡Œæœç´¢  
Â  Â  Tool--&gt;&gt;AI: è¿”å›ç…§ç‰‡åˆ—è¡¨  
Â  Â  AI-&gt;&gt;AI: ç”Ÿæˆå“åº”  
Â  Â  AI--&gt;&gt;U: "æˆ‘æ‰¾åˆ°äº†5å¼ ç…§ç‰‡..."  
</code></pre>
<p><strong>è®²è§£è¦ç‚¹</strong>:</p>
<ul>
<li>å±•ç¤ºå·¥å…·è°ƒç”¨çš„å·¥ä½œæœºåˆ¶</li>
<li>è¯´æ˜è‡ªç„¶è¯­è¨€ç†è§£çš„ä¼˜åŠ¿</li>
<li>å¼ºè°ƒæ— éœ€ç²¾ç¡®å…³é”®è¯çš„ä¾¿åˆ©æ€§</li>
</ul>
<h3 data-id="heading-100">Demo 3: å®Œæ•´å·¥ä½œæµ</h3>
<p><strong>æ¼”ç¤ºæµç¨‹</strong>:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR  
Â  Â  User([ç”¨æˆ·è¯·æ±‚]) --&gt; AI[AIåˆ†æ]  
Â  Â  AI --&gt; T1[æœç´¢ç…§ç‰‡]  
Â  Â  T1 --&gt; T2[åˆ†æå†…å®¹]  
Â  Â  T2 --&gt; T3[åˆ›å»ºç›¸å†Œ]  
Â  Â  T3 --&gt; Result[å®Œæˆ]  
Â  Â Â   
Â  Â  style User fill:#007AFF,color:#fff  
Â  Â  style AI fill:#5AC8FA,color:#000  
Â  Â  style T1 fill:#FF9500,color:#fff  
Â  Â  style T2 fill:#FF9500,color:#fff  
Â  Â  style T3 fill:#FF9500,color:#fff  
Â  Â  style Result fill:#34C759,color:#fff  
</code></pre>
<p><strong>è®²è§£è¦ç‚¹</strong>:</p>
<ul>
<li>å±•ç¤ºå¤šå·¥å…·åè°ƒçš„èƒ½åŠ›</li>
<li>è¯´æ˜AIå¦‚ä½•è‡ªåŠ¨åˆ¤æ–­å·¥å…·è°ƒç”¨é¡ºåº</li>
<li>å¼ºè°ƒå¤æ‚ä»»åŠ¡çš„ä¸€ç«™å¼è§£å†³</li>
</ul>
<hr/>
<h2 data-id="heading-101">ğŸ“š ç¬¬å…­éƒ¨åˆ†ï¼šå­¦ä¹ èµ„æºå’Œæ€»ç»“Â </h2>
<h3 data-id="heading-102">å®˜æ–¹èµ„æº</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD  
Â  Â  Resource[å­¦ä¹ èµ„æº] --&gt; Official[å®˜æ–¹èµ„æº]  
Â  Â  Resource --&gt; Video[è§†é¢‘æ•™ç¨‹]  
Â  Â  Resource --&gt; Demo[ç¤ºä¾‹é¡¹ç›®]  
Â  Â Â   
Â  Â  Official --&gt; Doc[Appleæ–‡æ¡£]  
Â  Â  Official --&gt; WWDC[WWDC 2024]  
Â  Â Â   
Â  Â  Video --&gt; V1[Frameworkä»‹ç»]  
Â  Â  Video --&gt; V2[æ·±å…¥ç†è§£]  
Â  Â  Video --&gt; V3[ç¼–ç å®è·µ]  
Â  Â  Video --&gt; V4[æç¤ºå’Œå®‰å…¨]  
Â  Â Â   
Â  Â  Demo --&gt; Project[Foundation Lab]  
Â  Â Â   
Â  Â  style Resource fill:#007AFF,color:#fff  
Â  Â  style Official fill:#34C759,color:#fff  
Â  Â  style Video fill:#FF9500,color:#fff  
Â  Â  style Demo fill:#5AC8FA,color:#000  
</code></pre>
<p><strong>èµ„æºåˆ—è¡¨</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Ffoundationmodels" target="_blank" title="https://developer.apple.com/documentation/foundationmodels" ref="nofollow noopener noreferrer">Apple Developer Documentation - Foundation Models</a></li>
<li>WWDC 2024ç›¸å…³Session</li>
<li>ç¤ºä¾‹é¡¹ç›®ï¼šFoundation Lab</li>
</ul>
<p><strong>æ¨èè§†é¢‘</strong>:</p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DmJMvFyBvZEk" target="_blank" title="https://www.youtube.com/watch?v=mJMvFyBvZEk" ref="nofollow noopener noreferrer">Foundation Models Framework ä»‹ç»</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D6Wgg7DIY29E" target="_blank" title="https://www.youtube.com/watch?v=6Wgg7DIY29E" ref="nofollow noopener noreferrer">æ·±å…¥äº†è§£ Foundation Models æ¡†æ¶</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DS5F196tqRMI" target="_blank" title="https://www.youtube.com/watch?v=S5F196tqRMI" ref="nofollow noopener noreferrer">å®é™…ç¼–ç å®è·µ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D-aMFBj-kwdU" target="_blank" title="https://www.youtube.com/watch?v=-aMFBj-kwdU" ref="nofollow noopener noreferrer">æ¢ç´¢è®¾å¤‡ç«¯åŸºç¡€æ¨¡å‹çš„æç¤ºè®¾è®¡å’Œå®‰å…¨</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dz-t64Zlj1ok" target="_blank" title="https://www.youtube.com/watch?v=z-t64Zlj1ok" ref="nofollow noopener noreferrer">YouTube åˆ†äº«è§†é¢‘</a> - å¯ä½œä¸ºè¡¥å……å‚è€ƒï¼Œç»“åˆæœ¬æ–‡æ¡£å†…å®¹è§‚çœ‹ï¼Œæ›´å¥½ç†è§£å®é™…æ¼”ç¤ºç»†èŠ‚</li>
</ol>
<p><strong>æ·±åº¦æŠ€æœ¯åˆ†æ</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fonevcat.com%2F2025%2F06%2Ffoundation-models%2F" target="_blank" title="https://onevcat.com/2025/06/foundation-models/" ref="nofollow noopener noreferrer">OneV's Den - Foundation Modelsï¼šè‹¹æœè®¾å¤‡ç«¯æ¨¡å‹çš„è¾¹ç•Œæ¢ç´¢</a> - åŸºäºå®é™…æµ‹è¯•çš„æ€§èƒ½æ•°æ®ã€è¾¹ç•Œé™åˆ¶å’Œæœ€ä½³å®è·µï¼ŒåŒ…å«å†…å­˜æ¶ˆè€—ã€å¹¶å‘æ€§èƒ½ã€ä¸Šä¸‹æ–‡çª—å£ç­‰å…³é”®æŒ‡æ ‡çš„è¯¦ç»†åˆ†æ</li>
</ul>
<h3 data-id="heading-103">å®è·µå»ºè®®</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  Start([å¼€å§‹å­¦ä¹ ]) --&gt; Step1[å•è½®å¯¹è¯]  
Â  Â  Step1 --&gt; Step2[ç»“æ„åŒ–ç”Ÿæˆ]  
Â  Â  Step2 --&gt; Step3[å®ç°Tool]  
Â  Â  Step3 --&gt; Step4[ä¸šåŠ¡é›†æˆ]  
Â  Â  Step4 --&gt; End([ç”Ÿäº§åº”ç”¨])  
Â  Â Â   
Â  Â  style Start fill:#007AFF,color:#fff  
Â  Â  style Step1 fill:#5AC8FA,color:#000  
Â  Â  style Step2 fill:#5AC8FA,color:#000  
Â  Â  style Step3 fill:#FF9500,color:#fff  
Â  Â  style Step4 fill:#34C759,color:#fff  
Â  Â  style End fill:#007AFF,color:#fff  
</code></pre>
<hr/>
<h2 data-id="heading-104">ğŸ¤” ç¬¬ä¸ƒéƒ¨åˆ†ï¼šQ&amp;AÂ </h2>
<h3 data-id="heading-105">å¸¸è§é—®é¢˜å¯¹æ¯”</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB  
Â  Â  Q1[Q: å’ŒChatGPTçš„åŒºåˆ«?] --&gt; A1[å®Œå…¨æœ¬åœ°åŒ–&lt;br/&gt;æ— éœ€ç½‘ç»œ&lt;br/&gt;æ•°æ®ä¸å‡ºè®¾å¤‡]  
Â  Â  Q2[Q: å¯ç”¨äºç”Ÿäº§?] --&gt; A2[éœ€è¦iOS 18+&lt;br/&gt;è®¾å¤‡éœ€æ”¯æŒAI]  
Â  Â  Q3[Q: æ€§èƒ½å¦‚ä½•?] --&gt; A3[æ€§èƒ½è‰¯å¥½&lt;br/&gt;é¦–æ¬¡è°ƒç”¨æœ‰å»¶è¿Ÿ]  
Â  Â  Q4[Q: å¦‚ä½•æµ‹è¯•?] --&gt; A4[å¿…é¡»çœŸæœºæµ‹è¯•&lt;br/&gt;æ¨¡æ‹Ÿå™¨ä¸æ”¯æŒ]  
Â  Â  Q5[Q: æˆæœ¬å¦‚ä½•?] --&gt; A5[å®Œå…¨å…è´¹&lt;br/&gt;æ— APIè´¹ç”¨]  
Â  Â Â   
Â  Â  style Q1 fill:#5AC8FA,color:#000  
Â  Â  style Q2 fill:#5AC8FA,color:#000  
Â  Â  style Q3 fill:#5AC8FA,color:#000  
Â  Â  style Q4 fill:#5AC8FA,color:#000  
Â  Â  style Q5 fill:#5AC8FA,color:#000  
Â  Â  style A1 fill:#34C759,color:#fff  
Â  Â  style A2 fill:#34C759,color:#fff  
Â  Â  style A3 fill:#34C759,color:#fff  
Â  Â  style A4 fill:#34C759,color:#fff  
Â  Â  style A5 fill:#34C759,color:#fff  
</code></pre>
<h3 data-id="heading-106">è®¨è®ºè¯é¢˜</h3>
<ul>
<li>åœ¨ç›¸å†Œä¸šåŠ¡ä¸­ï¼Œå“ªäº›åœºæ™¯æœ€é€‚åˆä½¿ç”¨Foundation Modelsï¼Ÿ</li>
<li>å¦‚ä½•å¹³è¡¡AIèƒ½åŠ›å’Œç”¨æˆ·ä½“éªŒï¼Ÿ</li>
<li>å¦‚ä½•å¤„ç†æ¨¡å‹ä¸å¯ç”¨çš„æƒ…å†µï¼Ÿ</li>
</ul>
<hr/>
<h2 data-id="heading-107">ğŸ“ æ€»ç»“</h2>
<h3 data-id="heading-108">å…³é”®è¦ç‚¹æ€»ç»“</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap  
Â  root((Foundation Models&lt;br/&gt;å…³é”®è¦ç‚¹))  
Â  Â  åŸç”ŸAIèƒ½åŠ›  
Â  Â  Â  Appleæä¾›  
Â  Â  Â  iOS 18+  
Â  Â  Â  Apple Intelligence  
Â  Â  éšç§ä¿æŠ¤  
Â  Â  Â  è®¾å¤‡ç«¯å¤„ç†  
Â  Â  Â  æ•°æ®ä¸å‡ºè®¾å¤‡  
Â  Â  Â  å®Œå…¨æœ¬åœ°åŒ–  
Â  Â  æ˜“äºé›†æˆ  
Â  Â  Â  ç®€æ´API  
Â  Â  Â  å¼€å‘è€…å‹å¥½  
Â  Â  Â  ç³»ç»Ÿé›†æˆ  
Â  Â  åº”ç”¨åœºæ™¯  
Â  Â  Â  ç…§ç‰‡åˆ†æ  
Â  Â  Â  è‡ªç„¶è¯­è¨€æœç´¢  
Â  Â  Â  æ™ºèƒ½åˆ†ç±»  
Â  Â  Â  è§†é¢‘ç†è§£  
</code></pre>
<h3 data-id="heading-109">ä¸‹ä¸€æ­¥è¡ŒåŠ¨</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR  
Â  Â  A[åˆ›å»ºDemo] --&gt; B[é€‰æ‹©åŠŸèƒ½]  
Â  Â  B --&gt; C[é›†æˆAI]  
Â  Â  C --&gt; D[æ”¶é›†åé¦ˆ]  
Â  Â  D --&gt; E[è¿­ä»£ä¼˜åŒ–]  
Â  Â Â   
Â  Â  style A fill:#007AFF,color:#fff  
Â  Â  style B fill:#5AC8FA,color:#000  
Â  Â  style C fill:#FF9500,color:#fff  
Â  Â  style D fill:#34C759,color:#fff  
Â  Â  style E fill:#AF52DE,color:#fff  
</code></pre>
<h3 data-id="heading-110">ç›¸å†Œä¸šåŠ¡åº”ç”¨ä¼˜å…ˆçº§</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">pie title ç›¸å†Œä¸šåŠ¡åº”ç”¨ä¼˜å…ˆçº§  
Â  Â  "é«˜ä¼˜å…ˆçº§" : 3  
Â  Â  "ä¸­ä¼˜å…ˆçº§" : 3  
Â  Â  "ä½ä¼˜å…ˆçº§" : 2  
</code></pre>
<p><strong>ä¼˜å…ˆçº§è¯¦æƒ…</strong>:</p>
<ul>
<li><strong>é«˜ä¼˜å…ˆçº§</strong>: æ™ºèƒ½ç…§ç‰‡æè¿°ç”Ÿæˆã€è‡ªç„¶è¯­è¨€æœç´¢ã€æ™ºèƒ½ç›¸å†Œåˆ†ç±»</li>
<li><strong>ä¸­ä¼˜å…ˆçº§</strong>: ç›¸ä¼¼ç…§ç‰‡æ¨èã€è§†é¢‘æ‘˜è¦ç”Ÿæˆã€æ¸…ç†å»ºè®®</li>
<li><strong>ä½ä¼˜å…ˆçº§</strong>: ç…§ç‰‡è´¨é‡è¯„åˆ†ã€è‡ªåŠ¨æ ‡ç­¾ç”Ÿæˆ</li>
</ul>
<hr/>
<h2 data-id="heading-111">ğŸ“ é™„å½•ï¼šä»£ç æ¨¡æ¿</h2>
<h3 data-id="heading-112">åŸºç¡€ä¼šè¯æ¨¡æ¿</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> FoundationModels

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicSessionManager</span> {  
Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">chat</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">message</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">String</span> {  
Â  Â  Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(to: message)  
Â  Â  Â  Â  <span class="hljs-keyword">return</span> response.content  
Â  Â  }  
}  
</code></pre>
<h3 data-id="heading-113">Toolå®ç°æ¨¡æ¿</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyTool</span>: <span class="hljs-title class_">Tool</span> {  
Â  Â  <span class="hljs-keyword">let</span> name <span class="hljs-operator">=</span> <span class="hljs-string">"toolName"</span>  
Â  Â  <span class="hljs-keyword">let</span> description <span class="hljs-operator">=</span> <span class="hljs-string">"å·¥å…·æè¿°"</span>  
Â  Â Â   
Â  Â  <span class="hljs-meta">@Generable</span>  
Â  Â  <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Arguments</span> {  
Â  Â  Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å‚æ•°æè¿°"</span>)  
Â  Â  Â  Â  <span class="hljs-keyword">var</span> param: <span class="hljs-type">String</span>  
Â  Â  }  
Â  Â Â   
Â  Â  <span class="hljs-keyword">func</span> <span class="hljs-title function_">call</span>(<span class="hljs-params">arguments</span>: <span class="hljs-type">Arguments</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-keyword">some</span> <span class="hljs-type">PromptRepresentable</span> {  
Â  Â  Â  Â  <span class="hljs-comment">// å®ç°å·¥å…·é€»è¾‘  </span>
Â  Â  Â  Â  <span class="hljs-keyword">return</span> <span class="hljs-string">"å·¥å…·è¿”å›ç»“æœ"</span>  
Â  Â  }  
}  
</code></pre>
<h3 data-id="heading-114">ç»“æ„åŒ–æ•°æ®ç”Ÿæˆæ¨¡æ¿</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@Generable</span>  
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyDataModel</span> {  
Â  Â  <span class="hljs-meta">@Guide</span>(description: <span class="hljs-string">"å­—æ®µæè¿°"</span>)  
Â  Â  <span class="hljs-keyword">let</span> field: <span class="hljs-type">String</span>  
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">generateData</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">MyDataModel</span> {  
Â  Â  <span class="hljs-keyword">let</span> session <span class="hljs-operator">=</span> <span class="hljs-type">LanguageModelSession</span>()  
Â  Â  <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> session.respond(  
Â  Â  Â  Â  to: <span class="hljs-string">"ç”Ÿæˆæ•°æ®çš„æç¤ºè¯"</span>,  
Â  Â  Â  Â  generating: <span class="hljs-type">MyDataModel</span>.<span class="hljs-keyword">self</span>  
Â  Â  )  
Â  Â  <span class="hljs-keyword">return</span> response.content  
}  
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP8.6 æ–°çš„ RFC ææ¡ˆ Context Managers ä¼˜é›…ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ]]></title>    <link>https://juejin.cn/post/7575112613778047010</link>    <guid>https://juejin.cn/post/7575112613778047010</guid>    <pubDate>2025-11-23T09:18:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575112613778047010" data-draft-id="7575162322240077824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP8.6 æ–°çš„ RFC ææ¡ˆ Context Managers ä¼˜é›…ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-11-23T09:18:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP8.6 æ–°çš„ RFC ææ¡ˆ Context Managers ä¼˜é›…ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T09:18:13.000Z" title="Sun Nov 23 2025 09:18:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨æ—¥å¸¸ PHP å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†èµ„æºçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šæ‰“å¼€æ–‡ä»¶åè¦è®°å¾—å…³é—­ï¼Œå¼€å¯æ•°æ®åº“äº‹åŠ¡åè¦ç¡®ä¿æäº¤æˆ–å›æ»šï¼Œè·å–é”åè¦è®°å¾—é‡Šæ”¾â€¦â€¦è¿™äº›é‡å¤çš„"è®¾ç½®-ä½¿ç”¨-æ¸…ç†"æ¨¡å¼å……æ–¥ç€æˆ‘ä»¬çš„ä»£ç ï¼Œä¸ä»…ç¹çï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚</p>
<p>PHP 8.6 å³å°†å¼•å…¥çš„ <strong>Context Managersï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰</strong> ç‰¹æ€§ï¼Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ã€‚è¿™ä¸ªç‰¹æ€§å€Ÿé‰´è‡ª Pythonï¼Œé€šè¿‡æ–°å¢çš„ <code>using</code> å…³é”®å­—å’Œ <code>ContextManager</code> æ¥å£ï¼Œæä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥æŠ½è±¡è¿™äº›é€šç”¨çš„æ§åˆ¶æµå’Œå˜é‡ç”Ÿå‘½å‘¨æœŸç®¡ç†æ¨¡å¼ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-11%2Fphp-context-managers-rfc-zh" target="_blank" title="https://catchadmin.com/post/2025-11/php-context-managers-rfc-zh" ref="nofollow noopener noreferrer">åŸæ–‡é“¾æ¥ PHP8.6 æ–°çš„ RFC ææ¡ˆ Context Managers ä¼˜é›…ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ</a>
è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚ä¼ ç»Ÿçš„æ–‡ä»¶å¤„ç†ä»£ç éœ€è¦è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">'file.txt'</span>, <span class="hljs-string">'w'</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$fp</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$someThing</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>) {
            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$value</span>));
        }
    } <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) {
        <span class="hljs-title function_ invoke__">log</span>(<span class="hljs-string">'The file failed.'</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);
    }
}
<span class="hljs-keyword">unset</span>(<span class="hljs-variable">$fp</span>);
</code></pre>
<p>è€Œä½¿ç”¨ Context Managers åï¼Œå¯ä»¥ç®€åŒ–ä¸ºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-title function_ invoke__">file_for_write</span>(<span class="hljs-string">'file.txt'</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$someThing</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$value</span>) {
        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$value</span>));
    }
}
<span class="hljs-comment">// æ­¤æ—¶å¯ä»¥ä¿è¯ $fp å·²ç»å…³é—­ï¼Œæ— è®ºæ˜¯å¦å‘ç”Ÿé”™è¯¯</span>
</code></pre>
<h2 data-id="heading-1">æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-2">ContextManager æ¥å£</h3>
<p>Context Managers çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªæ–°çš„æ¥å£ <code>ContextManager</code>ï¼Œå®ƒå®šä¹‰äº†ä¸¤ä¸ªå…³é”®æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span></span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span></span>;
}
</code></pre>
<ul>
<li><strong><code>enterContext()</code></strong>ï¼šåœ¨è¿›å…¥ä¸Šä¸‹æ–‡å—æ—¶è°ƒç”¨ï¼Œæ‰§è¡Œå¿…è¦çš„è®¾ç½®æ“ä½œï¼Œè¿”å›å€¼å°†ä½œä¸ºä¸Šä¸‹æ–‡å˜é‡æä¾›ç»™ä»£ç å—ä½¿ç”¨</li>
<li><strong><code>exitContext()</code></strong>ï¼šåœ¨ç¦»å¼€ä¸Šä¸‹æ–‡å—æ—¶è°ƒç”¨ï¼Œæ‰§è¡Œæ¸…ç†æ“ä½œã€‚æ¥æ”¶ä¸€ä¸ªå¯é€‰çš„å¼‚å¸¸å‚æ•°ï¼Œå¦‚æœè¿”å› <code>true</code> åˆ™æŠ‘åˆ¶å¼‚å¸¸ï¼Œå¦åˆ™å¼‚å¸¸ä¼šé‡æ–°æŠ›å‡º</li>
</ul>
<h3 data-id="heading-3">using å…³é”®å­—è¯­æ³•</h3>
<p><code>using</code> è¯­å¥çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> ((EXPR [<span class="hljs-keyword">as</span> VAR])[,]+) {
    BODY
}
</code></pre>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><strong>EXPR</strong>ï¼šä»»æ„è¡¨è¾¾å¼ï¼Œå…¶ç»“æœå¿…é¡»æ˜¯ <code>ContextManager</code> å®ä¾‹</li>
<li><strong>VAR</strong>ï¼šå¯é€‰çš„å˜é‡åï¼Œç”¨äºæ¥æ”¶ <code>enterContext()</code> çš„è¿”å›å€¼</li>
<li><strong>BODY</strong>ï¼šä»»æ„ PHP è¯­å¥</li>
<li><strong>é€—å·åˆ†éš”</strong>ï¼šå¯ä»¥åœ¨ä¸€ä¸ª <code>using</code> è¯­å¥ä¸­ä½¿ç”¨å¤šä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œç”¨é€—å·åˆ†éš”</li>
</ul>
<p><strong>è¯­æ³•ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// å•ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå¸¦ä¸Šä¸‹æ–‡å˜é‡</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileManager</span>(<span class="hljs-string">'file.txt'</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-comment">// ä½¿ç”¨ $fp</span>
}

<span class="hljs-comment">// å•ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¸éœ€è¦ä¸Šä¸‹æ–‡å˜é‡</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransactionManager</span>()) {
    <span class="hljs-comment">// æ‰§è¡Œäº‹åŠ¡æ€§æ“ä½œ</span>
}

<span class="hljs-comment">// å¤šä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">LockA</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$a</span>, <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">LockB</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$b</span>) {
    <span class="hljs-comment">// åŒæ—¶ä½¿ç”¨ $a å’Œ $b</span>
}

<span class="hljs-comment">// è¡¨è¾¾å¼å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨æˆ–æ–¹æ³•é“¾</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">transaction</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$tx</span>) {
    <span class="hljs-comment">// ä½¿ç”¨äº‹åŠ¡</span>
}
</code></pre>
<h3 data-id="heading-4">ä¸Šä¸‹æ–‡ç®¡ç†å™¨ vs ä¸Šä¸‹æ–‡å˜é‡</h3>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ<strong>ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼ˆContextManager å®ä¾‹ï¼‰å’Œ<strong>ä¸Šä¸‹æ–‡å˜é‡</strong>ï¼ˆ<code>as</code> åé¢çš„å˜é‡ï¼‰æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼šè´Ÿè´£ç®¡ç†ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œé€šå¸¸å¯¹ä¸šåŠ¡ä»£ç ä¸å¯è§</li>
<li><strong>ä¸Šä¸‹æ–‡å˜é‡</strong>ï¼š<code>enterContext()</code> è¿”å›çš„å€¼ï¼Œè¿™æ‰æ˜¯ä¸šåŠ¡ä»£ç å®é™…ä½¿ç”¨çš„å¯¹è±¡</li>
</ul>
<p>ä¾‹å¦‚ï¼Œåœ¨æ–‡ä»¶å¤„ç†åœºæ™¯ä¸­ï¼ŒContext Manager å¯èƒ½æ˜¯ä¸€ä¸ª <code>FileManager</code> å¯¹è±¡ï¼Œè€Œä¸Šä¸‹æ–‡å˜é‡åˆ™æ˜¯å®é™…çš„æ–‡ä»¶å¥æŸ„ã€‚</p>
<h2 data-id="heading-5">æ‰§è¡Œæµç¨‹è¯¦è§£</h2>
<h3 data-id="heading-6">æˆåŠŸåœºæ™¯</h3>
<p>å½“ä»£ç å—æ­£å¸¸æ‰§è¡Œå®Œæ¯•æ—¶ï¼š</p>
<ol>
<li>éªŒè¯ EXPR è¿”å›çš„æ˜¯ <code>ContextManager</code> å®ä¾‹ï¼ˆå¦åˆ™æŠ›å‡º <code>TypeError</code>ï¼‰</li>
<li>è°ƒç”¨ <code>enterContext()</code>ï¼Œå°†è¿”å›å€¼èµ‹ç»™ä¸Šä¸‹æ–‡å˜é‡ï¼ˆå¦‚æœæŒ‡å®šäº† <code>as VAR</code>ï¼‰</li>
<li>æ‰§è¡Œä»£ç å—ä¸­çš„è¯­å¥</li>
<li>è°ƒç”¨ <code>exitContext()</code>ï¼ˆä¸ä¼ å‚æ•°ï¼‰</li>
<li>æ˜¾å¼ <code>unset()</code> ä¸Šä¸‹æ–‡å˜é‡</li>
<li>Context Manager è‡ªç„¶è¶…å‡ºä½œç”¨åŸŸï¼Œè¢«åƒåœ¾å›æ”¶</li>
</ol>
<h3 data-id="heading-7">å¤±è´¥åœºæ™¯</h3>
<p>å½“ä»£ç å—ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶ï¼š</p>
<ol>
<li>æ•è·å¼‚å¸¸</li>
<li>è°ƒç”¨ <code>exitContext($exception)</code>ï¼Œä¼ å…¥æ•è·çš„å¼‚å¸¸</li>
<li>æ˜¾å¼ <code>unset()</code> ä¸Šä¸‹æ–‡å˜é‡</li>
<li>å¦‚æœ <code>exitContext()</code> è¿”å› <code>true</code>ï¼Œå¼‚å¸¸è¢«æŠ‘åˆ¶ï¼›å¦åˆ™é‡æ–°æŠ›å‡ºå¼‚å¸¸</li>
</ol>
<h3 data-id="heading-8">ç‰¹æ®Šæ§åˆ¶è¯­å¥</h3>
<p>åœ¨ <code>using</code> å—ä¸­ï¼Œä¸‰ä¸ªå…³é”®å­—æœ‰ç‰¹æ®Šå«ä¹‰ï¼š</p>
<ul>
<li><strong><code>break</code></strong>ï¼šè·³å‡º <code>using</code> å—ï¼Œè§†ä¸ºæˆåŠŸåœºæ™¯ã€‚å¦‚æœåœ¨åµŒå¥—æ§åˆ¶ç»“æ„ä¸­ï¼Œä½¿ç”¨ <code>break 2</code> ç­‰æ¥æŒ‡å®šè·³å‡ºå±‚çº§</li>
<li><strong><code>continue</code></strong>ï¼šè¡Œä¸ºåŒ <code>break</code>ï¼Œä½†ä¼šè§¦å‘è­¦å‘Šï¼ˆä¸ <code>switch</code> ä¿æŒä¸€è‡´ï¼‰</li>
<li><strong><code>return</code></strong>ï¼šä»å‡½æ•°è¿”å›ï¼Œå…ˆè§¦å‘æˆåŠŸåœºæ™¯çš„æ¸…ç†æµç¨‹ï¼Œå†è¿”å›</li>
</ul>
<p><strong>é‡è¦è¯´æ˜</strong>ï¼š<code>using</code> å—ä¸ä¼šåˆ›å»ºæ–°çš„ä½œç”¨åŸŸï¼ˆä¸åƒå‡½æ•°æˆ–é—­åŒ…ï¼‰ã€‚è¿™æ„å‘³ç€ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$outer</span> = <span class="hljs-string">'outside'</span>;

<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Manager</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$ctx</span>) {
    <span class="hljs-comment">// å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$outer</span>; <span class="hljs-comment">// è¾“å‡ºï¼šoutside</span>
    
    <span class="hljs-comment">// åœ¨å—å†…å®šä¹‰çš„å˜é‡</span>
    <span class="hljs-variable">$inner</span> = <span class="hljs-string">'inside'</span>;
}

<span class="hljs-comment">// ä¸Šä¸‹æ–‡å˜é‡ $ctx å·²è¢«æ˜¾å¼ unsetï¼Œæ­¤å¤„ä¸å¯è®¿é—®</span>
<span class="hljs-comment">// var_dump($ctx); // é”™è¯¯ï¼šUndefined variable</span>

<span class="hljs-comment">// ä½†å—å†…å®šä¹‰çš„å…¶ä»–å˜é‡ä»ç„¶å­˜åœ¨</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$inner</span>; <span class="hljs-comment">// è¾“å‡ºï¼šinside</span>
</code></pre>
<h2 data-id="heading-9">å®ç°åŸç†</h2>
<p><code>using</code> å—åœ¨ç¼–è¯‘æ—¶ä¼šè¢«è½¬æ¢ï¼ˆdesugaringï¼‰ä¸ºä¼ ç»Ÿä»£ç ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•ç¤ºä¾‹çš„è½¬æ¢ç»“æœï¼š</p>
<p><strong>åŸå§‹ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Manager</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>) {
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Hello world\n"</span>;
}
</code></pre>
<p><strong>ç­‰æ•ˆè½¬æ¢åçš„ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// æ­¥éª¤ 1: åˆ›å»ºä¸Šä¸‹æ–‡ç®¡ç†å™¨å®ä¾‹</span>
<span class="hljs-variable">$__mgr</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Manager</span>();

<span class="hljs-comment">// æ­¥éª¤ 2: æ ‡è®°å¼‚å¸¸å¤„ç†çŠ¶æ€ï¼ˆç¡®ä¿ exitContext åªè°ƒç”¨ä¸€æ¬¡ï¼‰</span>
<span class="hljs-variable">$__closed</span> = <span class="hljs-literal">false</span>;

<span class="hljs-comment">// æ­¥éª¤ 3: è°ƒç”¨ enterContext() å¹¶ä¿å­˜è¿”å›å€¼åˆ°ä¸Šä¸‹æ–‡å˜é‡</span>
<span class="hljs-variable">$var</span> = <span class="hljs-variable">$__mgr</span>-&gt;<span class="hljs-title function_ invoke__">enterContext</span>();

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// æ­¥éª¤ 4: æ‰§è¡Œç”¨æˆ·ä»£ç å—</span>
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Hello world\n"</span>;
    
} <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// æ­¥éª¤ 5a: æ•è·å¼‚å¸¸æ—¶çš„å¤„ç†ï¼ˆå¤±è´¥åœºæ™¯ï¼‰</span>
    <span class="hljs-variable">$__closed</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// è°ƒç”¨ exitContext å¹¶ä¼ å…¥å¼‚å¸¸</span>
    <span class="hljs-variable">$__ret</span> = <span class="hljs-variable">$__mgr</span>-&gt;<span class="hljs-title function_ invoke__">exitContext</span>(<span class="hljs-variable">$e</span>);
    
    <span class="hljs-comment">// å¦‚æœè¿”å›å€¼ä¸æ˜¯ trueï¼Œåˆ™é‡æ–°æŠ›å‡ºå¼‚å¸¸</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$__ret</span> !== <span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-variable">$e</span>;
    }
    <span class="hljs-comment">// å¦‚æœè¿”å› trueï¼Œåˆ™æŠ‘åˆ¶å¼‚å¸¸ï¼ˆä¸å†æŠ›å‡ºï¼‰</span>
    
} <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// æ­¥éª¤ 5b/6: æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„æ¸…ç†ä»£ç </span>
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼ˆæˆåŠŸåœºæ™¯ï¼‰ï¼Œè°ƒç”¨ exitContext()</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$__closed</span>) {
        <span class="hljs-variable">$__mgr</span>-&gt;<span class="hljs-title function_ invoke__">exitContext</span>();
    }
    
    <span class="hljs-comment">// æ˜¾å¼æ¸…ç†æ‰€æœ‰ç›¸å…³å˜é‡</span>
    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$var</span>);      <span class="hljs-comment">// æ¸…ç†ä¸Šä¸‹æ–‡å˜é‡</span>
    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$__closed</span>); <span class="hljs-comment">// æ¸…ç†çŠ¶æ€æ ‡è®°</span>
    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$__mgr</span>);    <span class="hljs-comment">// æ¸…ç†ç®¡ç†å™¨ï¼ˆè§¦å‘åƒåœ¾å›æ”¶ï¼‰</span>
}
</code></pre>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ul>
<li><code>$__mgr</code>ã€<code>$__closed</code>ã€<code>$__ret</code> ç­‰å˜é‡å®é™…ä¸Šä¸ä¼šä»¥è¿™ä¸ªåå­—æš´éœ²ï¼Œè¿™åªæ˜¯ä¸ºäº†è¯´æ˜å…¶å·¥ä½œåŸç†</li>
<li><strong><code>exitContext()</code> ä¿è¯åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</strong>ï¼Œæ— è®ºæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥åœºæ™¯</li>
<li>æ‰€æœ‰éœ€è¦åœ¨ä¸¤ç§æƒ…å†µä¸‹æ‰§è¡Œçš„æ¸…ç†æ“ä½œéƒ½åº”è¯¥åœ¨ <code>exitContext()</code> ä¸­ç»Ÿä¸€å¤„ç†</li>
<li><code>finally</code> å—ç¡®ä¿æ¸…ç†ä»£ç ä¸€å®šä¼šæ‰§è¡Œï¼Œå³ä½¿åœ¨ <code>catch</code> ä¸­é‡æ–°æŠ›å‡ºå¼‚å¸¸</li>
</ul>
<h2 data-id="heading-10">å®æˆ˜åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-11">åœºæ™¯ä¸€ï¼šæ•°æ®åº“äº‹åŠ¡</h3>
<p>æ•°æ®åº“äº‹åŠ¡æ˜¯ Context Managers çš„å…¸å‹åº”ç”¨åœºæ™¯ã€‚ä¼ ç»Ÿæ–¹å¼éœ€è¦æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡çš„å¼€å¯ã€æäº¤å’Œå›æ»šï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseTransaction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> DatabaseConnection <span class="hljs-variable">$connection</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">DatabaseConnection</span>
    </span>{
        <span class="hljs-comment">// è¿”å›æ•°æ®åº“è¿æ¥ï¼Œä¾›ä¸šåŠ¡ä»£ç ä½¿ç”¨</span>
        <span class="hljs-comment">// æ³¨ï¼šå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦åœ¨æ­¤å¤„è°ƒç”¨ beginTransaction()</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;connection;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$e</span>) {
            <span class="hljs-variable language_">$this</span>-&gt;connection-&gt;<span class="hljs-title function_ invoke__">rollback</span>();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">$this</span>-&gt;connection-&gt;<span class="hljs-title function_ invoke__">commit</span>();
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseConnection</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transaction</span>(<span class="hljs-params"/>): <span class="hljs-title">DatabaseTransaction</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseTransaction</span>(<span class="hljs-variable language_">$this</span>);
    }
}
</code></pre>
<p>ä½¿ç”¨æ—¶éå¸¸ç®€æ´ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// æ³¨æ„è¿™é‡Œçœç•¥äº† 'as' è¡¨è¾¾å¼ï¼Œå› ä¸ºä¸éœ€è¦è¿”å›å€¼</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">transaction</span>()) {
    <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">insert</span>(<span class="hljs-string">'users'</span>, [<span class="hljs-string">'name'</span> =&gt; <span class="hljs-string">'Alice'</span>]);
    <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">insert</span>(<span class="hljs-string">'logs'</span>, [<span class="hljs-string">'action'</span> =&gt; <span class="hljs-string">'user_created'</span>]);
}
<span class="hljs-comment">// å¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œäº‹åŠ¡è‡ªåŠ¨æäº¤ï¼›å¦‚æœæœ‰å¼‚å¸¸ï¼Œäº‹åŠ¡è‡ªåŠ¨å›æ»š</span>
</code></pre>
<h3 data-id="heading-12">åœºæ™¯äºŒï¼šæ–‡ä»¶é”å®š</h3>
<p>åœ¨éœ€è¦ç‹¬å è®¿é—®æŸä¸ªæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶é”å®šæœºåˆ¶è‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$handle</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$locked</span> = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span>,
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> <span class="hljs-variable">$forWriting</span> = <span class="hljs-literal">true</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-variable">$this</span>-&gt;forWriting ? <span class="hljs-string">'w'</span> : <span class="hljs-string">'r'</span>);
        <span class="hljs-variable language_">$this</span>-&gt;locked = <span class="hljs-title function_ invoke__">flock</span>(<span class="hljs-variable">$this</span>-&gt;handle, <span class="hljs-variable">$this</span>-&gt;forWriting ? LOCK_EX : LOCK_SH);
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;locked) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\RuntimeException</span>(<span class="hljs-string">'Could not acquire lock.'</span>);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;handle;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;locked) {
            <span class="hljs-title function_ invoke__">flock</span>(<span class="hljs-variable">$this</span>-&gt;handle, LOCK_UN);
        }
        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$this</span>-&gt;handle);
    }
}
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// éœ€è¦å†™å…¥æ–‡ä»¶çš„ç‹¬å è®¿é—®</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileLock</span>(<span class="hljs-string">'file.txt'</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-string">'important stuff'</span>);
}

<span class="hljs-comment">// ä»…ç”¨äºåŒæ­¥ï¼Œä¸å®é™…æ“ä½œæ–‡ä»¶</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileLock</span>(<span class="hljs-string">'sentinel'</span>)) {
    <span class="hljs-comment">// æ‰§è¡Œéœ€è¦åŒæ­¥çš„æ“ä½œï¼Œä¸æ¶‰åŠæ–‡ä»¶è¯»å†™</span>
}
</code></pre>
<h3 data-id="heading-13">åœºæ™¯ä¸‰ï¼šç»“æ„åŒ–å¼‚æ­¥æ§åˆ¶</h3>
<p>Context Managers ä¹Ÿå¯ä»¥ç”¨äºç®¡ç†å¼‚æ­¥åç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BlockingScope</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">private</span> Scope <span class="hljs-variable">$scope</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">Scope</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;scope = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scope</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$e</span>) {
            <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶å–æ¶ˆæ‰€æœ‰åç¨‹</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;scope-&gt;routines <span class="hljs-keyword">as</span> <span class="hljs-variable">$r</span>) {
                <span class="hljs-variable">$r</span>-&gt;<span class="hljs-title function_ invoke__">cancel</span>();
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æ­£å¸¸é€€å‡ºæ—¶ç­‰å¾…æ‰€æœ‰åç¨‹å®Œæˆ</span>
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;scope-&gt;routines <span class="hljs-keyword">as</span> <span class="hljs-variable">$r</span>) {
                <span class="hljs-variable">$r</span>-&gt;<span class="hljs-title function_ invoke__">wait</span>();
            }
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CancellingScope</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">private</span> Scope <span class="hljs-variable">$scope</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">Scope</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;scope = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scope</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// æ— è®ºå¦‚ä½•éƒ½å–æ¶ˆæ‰€æœ‰åç¨‹</span>
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;scope-&gt;routines <span class="hljs-keyword">as</span> <span class="hljs-variable">$r</span>) {
            <span class="hljs-variable">$r</span>-&gt;<span class="hljs-title function_ invoke__">cancel</span>();
        }
    }
}
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">BlockingScope</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$scope</span>) {
    <span class="hljs-variable">$scope</span>-&gt;<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-title function_ invoke__">someAsyncTask</span>());
    <span class="hljs-variable">$scope</span>-&gt;<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-title function_ invoke__">anotherAsyncTask</span>());
}
<span class="hljs-comment">// ä»£ç ä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°æ‰€æœ‰åç¨‹å®Œæˆ</span>

<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">CancellingScope</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$scope</span>) {
    <span class="hljs-variable">$scope</span>-&gt;<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-title function_ invoke__">longRunningTask</span>());
    <span class="hljs-variable">$scope</span>-&gt;<span class="hljs-title function_ invoke__">wait</span>(<span class="hljs-number">5</span>); <span class="hljs-comment">// ç­‰å¾… 5 ç§’</span>
}
<span class="hljs-comment">// 5 ç§’åæ‰€æœ‰æœªå®Œæˆçš„åç¨‹ä¼šè¢«ç«‹å³å–æ¶ˆ</span>
</code></pre>
<h3 data-id="heading-14">åœºæ™¯å››ï¼šä¸´æ—¶ä¿®æ”¹å…¨å±€é…ç½®</h3>
<p>æœ‰æ—¶éœ€è¦ä¸´æ—¶ä¿®æ”¹æŸä¸ªå…¨å±€è®¾ç½®ï¼Œæ‰§è¡Œå®Œç‰¹å®šä»£ç åæ¢å¤ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomErrorHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$oldHandler</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-variable">$newHandler</span>,
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;oldHandler = <span class="hljs-title function_ invoke__">set_error_handler</span>(<span class="hljs-variable">$this</span>-&gt;newHandler);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-title function_ invoke__">set_error_handler</span>(<span class="hljs-variable">$this</span>-&gt;oldHandler);
    }
}
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ä¸´æ—¶ç¦ç”¨æ‰€æœ‰é”™è¯¯å¤„ç†</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomErrorHandler</span>(fn() =&gt; <span class="hljs-literal">null</span>)) {
    <span class="hljs-comment">// åœ¨è¿™é‡Œ"å±é™©åœ°"æ‰§è¡Œä»£ç </span>
}
<span class="hljs-comment">// é€€å‡ºå—åï¼Œä¹‹å‰çš„é”™è¯¯å¤„ç†å™¨å·²è‡ªåŠ¨æ¢å¤</span>
</code></pre>
<p>ç±»ä¼¼çš„ï¼Œå¯ä»¥åˆ›å»ºç”¨äºä¸´æ—¶ä¿®æ”¹ <code>ini</code> è®¾ç½®çš„ Context Managerã€‚</p>
<h3 data-id="heading-15">åœºæ™¯äº”ï¼šç®€åŒ–çš„æ–‡ä»¶å¤„ç†</h3>
<p>å¯¹äºå¸¸è§çš„æ–‡ä»¶æ“ä½œï¼Œå¯ä»¥åˆ›å»ºä¾¿åˆ©çš„å·¥å‚å‡½æ•°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_for_write</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$filename</span></span>): <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-class"><span class="hljs-keyword">class</span>($<span class="hljs-title">filename</span>) <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span> </span>{
        <span class="hljs-keyword">private</span> <span class="hljs-variable">$handle</span>;
        
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$file</span></span>) </span>{}
        
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
        </span>{
            <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-string">'w'</span>);
            <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;handle) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\RuntimeException</span>(<span class="hljs-string">"Cannot open file: <span class="hljs-subst">{$this-&gt;file}</span>"</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;handle;
        }
        
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
        </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;handle) {
                <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$this</span>-&gt;handle);
            }
        }
    };
}
</code></pre>
<p>ä½¿ç”¨æ—¶éå¸¸ç›´è§‚ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-title function_ invoke__">file_for_write</span>(<span class="hljs-string">'output.txt'</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-string">"Line 1\n"</span>);
    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-string">"Line 2\n"</span>);
}
<span class="hljs-comment">// æ–‡ä»¶è‡ªåŠ¨å…³é—­ï¼Œæ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸</span>
</code></pre>
<h2 data-id="heading-16">é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-17">åµŒå¥—ä¸Šä¸‹æ–‡ç®¡ç†å™¨</h3>
<p><code>using</code> è¯­å¥æ”¯æŒåœ¨ä¸€ä¸ªè¯­å¥ä¸­ä½¿ç”¨å¤šä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œç”¨é€—å·åˆ†éš”ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$foo</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bar</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$bar</span>) {
    <span class="hljs-comment">// å¯ä»¥åŒæ—¶ä½¿ç”¨ $foo å’Œ $bar</span>
}
</code></pre>
<p>è¿™ç­‰ä»·äºåµŒå¥—çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$foo</span>) {
    <span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Bar</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$bar</span>) {
        <span class="hljs-comment">// å¯ä»¥åŒæ—¶ä½¿ç”¨ $foo å’Œ $bar</span>
    }
}
</code></pre>
<p><strong>é‡è¦</strong>ï¼šåé¢çš„ç®¡ç†å™¨ä¼šå…ˆæ‰§è¡Œæ¸…ç†ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>Bar</code> çš„ <code>exitContext()</code> ä¼šå…ˆäº <code>Foo</code> çš„ <code>exitContext()</code> æ‰§è¡Œï¼Œè¿™ç¬¦åˆ LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰çš„èµ„æºç®¡ç†åŸåˆ™ã€‚</p>
<h3 data-id="heading-18">Resource è‡ªåŠ¨åŒ…è£…</h3>
<p>ç”±äº PHP ä¸­çš„èµ„æºï¼ˆresourceï¼‰ç±»å‹å°šæœªå®Œå…¨å¯¹è±¡åŒ–ï¼ˆå¦‚ <code>fopen()</code> è¿”å›çš„æ–‡ä»¶å¥æŸ„ï¼‰ï¼ŒRFC ç‰¹åˆ«ä¸ºèµ„æºæä¾›äº†è‡ªåŠ¨åŒ…è£…æœºåˆ¶ã€‚</p>
<p>å½“ <code>using</code> è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªèµ„æºç±»å‹æ—¶ï¼Œä¼šè‡ªåŠ¨åŒ…è£…æˆä¸€ä¸ªå†…ç½®çš„ Context Managerï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// è¿™æ®µä»£ç </span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">'foo.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-string">'bar'</span>);
}

<span class="hljs-comment">// ä¼šè‡ªåŠ¨è½¬æ¢ä¸º</span>
<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourceContext</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">'foo.txt'</span>, <span class="hljs-string">'r'</span>)) <span class="hljs-keyword">as</span> <span class="hljs-variable">$fp</span>) {
    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-string">'bar'</span>);
}
</code></pre>
<p>å…¶ä¸­ <code>ResourceContext</code> å¤§è‡´ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResourceContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ContextManager</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-variable">$resource</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enterContext</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;resource;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exitContext</span>(<span class="hljs-params">?\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span> = <span class="hljs-literal">null</span></span>): ?<span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$this</span>-&gt;resource)) {
            <span class="hljs-title function_ invoke__">close</span>(<span class="hljs-variable">$this</span>-&gt;resource); <span class="hljs-comment">// C å±‚é¢çš„ç»Ÿä¸€å…³é—­å‡½æ•°</span>
        }
    }
}
</code></pre>
<p>è¿™æ ·å³ä½¿åœ¨èµ„æºå®Œå…¨å¯¹è±¡åŒ–ä¹‹å‰ï¼Œä¹Ÿèƒ½äº«å— Context Managers å¸¦æ¥çš„ä¾¿åˆ©ã€‚</p>
<h2 data-id="heading-19">è®¾è®¡å†³ç­–</h2>
<h3 data-id="heading-20">ä¸ºä½•é€‰æ‹© <code>using</code> è€Œé <code>with</code></h3>
<p>æœ€åˆçš„ææ¡ˆä½¿ç”¨ <code>with</code> å…³é”®å­—ï¼ˆä¸ Python ä¸€è‡´ï¼‰ï¼Œä½†å‘ç° Laravel åœ¨å…¨å±€åŠ©æ‰‹å‡½æ•°ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>with()</code> çš„å‡½æ•°ã€‚å¼•å…¥ <code>with</code> å…³é”®å­—ä¼šå¯¼è‡´æ‰€æœ‰ Laravel åº”ç”¨åœ¨å‡çº§åˆ° PHP 8.6 æ—¶ç«‹å³ä¸å…¼å®¹ï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚</p>
<p>ç»è¿‡è°ƒç ”å‘ç°ï¼Œ<code>using</code> åœ¨ Packagist å‰ 14000 ä¸ªåŒ…ä¸­ä»…å‡ºç° 2 æ¬¡ï¼ˆç›¸æ¯”ä¹‹ä¸‹ <code>with</code> å‡ºç° 19 æ¬¡ï¼‰ã€‚C# ä¹Ÿä½¿ç”¨ <code>using</code> å®ç°ç±»ä¼¼ï¼ˆä½†åŠŸèƒ½è¾ƒå¼±ï¼‰çš„ç‰¹æ€§ã€‚å› æ­¤æœ€ç»ˆé€‰æ‹©äº† <code>using</code> å…³é”®å­—ã€‚</p>
<h3 data-id="heading-21">ä¸ºä½•ä¸ä½¿ç”¨ææ„å‡½æ•°</h3>
<p>æœ‰äººå¯èƒ½ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ¥å®ç°"è¿›å…¥"å’Œ"é€€å‡º"é€»è¾‘å‘¢ï¼Ÿè¿™ç§æ–¹æ¡ˆå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ— æ³•åˆ†ç¦»ç®¡ç†å™¨å’Œå˜é‡</strong>ï¼šæ— æ³•åŒºåˆ†ç®¡ç†å¯¹è±¡å’Œå®é™…ä½¿ç”¨çš„å¯¹è±¡</li>
<li><strong>æ— æ³•åŒºåˆ†æˆåŠŸ/å¤±è´¥</strong>ï¼šææ„å‡½æ•°ä¸æ¥å—å‚æ•°ï¼Œæ— æ³•çŸ¥é“æ˜¯æ­£å¸¸é€€å‡ºè¿˜æ˜¯å¼‚å¸¸é€€å‡º</li>
<li><strong>æ—¶æœºä¸å¯æ§</strong>ï¼šææ„å‡½æ•°çš„è°ƒç”¨æ—¶æœºä¸ç¡®å®šï¼Œå¯èƒ½å› ä¸ºå˜é‡è¢«å…¶ä»–åœ°æ–¹å¼•ç”¨è€Œå»¶è¿Ÿæ‰§è¡Œ</li>
<li><strong>é¡ºåºé—®é¢˜</strong>ï¼šåœ¨åƒåœ¾å›æ”¶æœŸé—´ï¼Œææ„å‡½æ•°çš„è°ƒç”¨é¡ºåºæ˜¯ä¸ç¡®å®šçš„</li>
</ol>
<p>å› æ­¤ï¼ŒRFC é‡‡ç”¨äº†æ˜¾å¼çš„æ¥å£è®¾è®¡ã€‚</p>
<h2 data-id="heading-22">å½±å“å’Œå±•æœ›</h2>
<h3 data-id="heading-23">å‘åå…¼å®¹æ€§</h3>
<ul>
<li>å¼•å…¥äº†æ–°çš„å…¨å±€æ¥å£ <code>ContextManager</code></li>
<li>å¼•å…¥äº†æ–°çš„åŠä¿ç•™å…³é”®å­— <code>using</code>ï¼ˆç¦æ­¢ç”¨äºå…¨å±€å¸¸é‡å’Œå‡½æ•°ï¼Œä½†æ–¹æ³•å’Œç±»å¸¸é‡ä»å¯ä½¿ç”¨ï¼‰</li>
</ul>
<p>ç”±äºå…¨å±€å‘½åç©ºé—´é€šå¸¸è¢«è®¤ä¸ºæ˜¯ PHP å†…éƒ¨ä¿ç•™çš„ï¼Œé¢„è®¡ä¸ä¼šæœ‰é‡å¤§å…¼å®¹æ€§é—®é¢˜ã€‚</p>
<h3 data-id="heading-24">ç”Ÿæ€ç³»ç»Ÿå½±å“</h3>
<p>Context Managers ä½œä¸ºä¸€ä¸ªé€šç”¨çš„"è®¾ç½®-æ¸…ç†"æŠ½è±¡ï¼Œæœªæ¥çš„ PHP API è®¾è®¡å¯èƒ½ä¼šè€ƒè™‘æä¾›ç›¸åº”çš„ Context Managerï¼Œè€Œä¸æ˜¯å¼•å…¥æ–°çš„è¯­æ³•ç³–ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>æ•°æ®åº“åº“å¯èƒ½æä¾›äº‹åŠ¡ Context Manager</li>
<li>HTTP å®¢æˆ·ç«¯å¯èƒ½æä¾›è¿æ¥æ±  Context Manager</li>
<li>æ—¥å¿—åº“å¯èƒ½æä¾›ä¸Šä¸‹æ–‡çº§åˆ«é…ç½® Context Manager</li>
</ul>
<h3 data-id="heading-25">æœªæ¥å¯èƒ½æ€§ï¼šGenerator è£…é¥°å™¨</h3>
<p>Python å…è®¸ä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆgeneratorï¼‰å’Œè£…é¥°å™¨æ¥åˆ›å»º Context Managerï¼Œä½¿è¯­æ³•æ›´ç®€æ´ã€‚PHP ä¹ŸéªŒè¯äº†ç±»ä¼¼å®ç°çš„å¯è¡Œæ€§ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[ContextManager</span><span class="hljs-meta">]</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">opening</span>(<span class="hljs-params"><span class="hljs-variable">$filename</span></span>) </span>{
    <span class="hljs-variable">$f</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-string">"r"</span>);
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$f</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"fopen(<span class="hljs-subst">$filename</span>) failed"</span>);
    }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">yield</span> <span class="hljs-variable">$f</span>;
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$f</span>);
    }
}

<span class="hljs-title function_ invoke__">using</span> (<span class="hljs-title function_ invoke__">opening</span>(<span class="hljs-keyword">__FILE__</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>) {
    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$f</span>);
}
</code></pre>
<p>ä¸è¿‡å½“å‰ RFC è®¤ä¸ºå¯¹è±¡å½¢å¼å·²ç»è¶³å¤Ÿï¼Œè¿™ä¸ªç‰¹æ€§è¢«åˆ—ä¸ºæœªæ¥å¯èƒ½çš„å¢å¼ºã€‚</p>
<h2 data-id="heading-26">æ€»ç»“</h2>
<p>PHP Context Managers ä¸ºèµ„æºç”Ÿå‘½å‘¨æœŸç®¡ç†æä¾›äº†ä¸€ç§ä¼˜é›…ä¸”ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ <code>using</code> å…³é”®å­—å’Œ <code>ContextManager</code> æ¥å£ï¼Œå¼€å‘è€…å¯ä»¥ï¼š</p>
<ul>
<li><strong>å‡å°‘æ ·æ¿ä»£ç </strong>ï¼šä¸å†éœ€è¦ä¸ºæ¯ä¸ªèµ„æºæ“ä½œç¼–å†™é‡å¤çš„ try-finally é€»è¾‘</li>
<li><strong>æé«˜ä»£ç å¯é æ€§</strong>ï¼šä¿è¯æ¸…ç†ä»£ç ä¸€å®šä¼šæ‰§è¡Œï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸</li>
<li><strong>æå‡å¯è¯»æ€§</strong>ï¼šä¸šåŠ¡é€»è¾‘æ›´æ¸…æ™°ï¼Œä¸å†è¢«èµ„æºç®¡ç†ç»†èŠ‚å¹²æ‰°</li>
<li><strong>ä¿ƒè¿›ä»£ç å¤ç”¨</strong>ï¼šå°†é€šç”¨çš„èµ„æºç®¡ç†æ¨¡å¼å°è£…æˆå¯å¤ç”¨çš„ Context Manager</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>æ–‡ä»¶æ“ä½œ</li>
<li>æ•°æ®åº“äº‹åŠ¡</li>
<li>é”ç®¡ç†</li>
<li>ä¸´æ—¶é…ç½®ä¿®æ”¹</li>
<li>å¼‚æ­¥ä»»åŠ¡ç®¡ç†</li>
<li>ä»»ä½•éœ€è¦"è®¾ç½®-ä½¿ç”¨-æ¸…ç†"æ¨¡å¼çš„åœºæ™¯</li>
</ul>
<p>Context Managers å°†éš <strong>PHP 8.6</strong> å‘å¸ƒï¼Œç›®å‰å¤„äºè®¨è®ºé˜¶æ®µã€‚å¦‚æœä½ å¯¹æ­¤ç‰¹æ€§æ„Ÿå…´è¶£ï¼Œå¯ä»¥å…³æ³¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwiki.php.net%2Frfc%2Fcontext_managers" target="_blank" title="https://wiki.php.net/rfc/context_managers" ref="nofollow noopener noreferrer">RFC è®¨è®º</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Farnaud-lb%2Fphp-src%2Fpull%2F26" target="_blank" title="https://github.com/arnaud-lb/php-src/pull/26" ref="nofollow noopener noreferrer">å®ç°ä»£ç </a>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¸©å‘æ—¥è®°ï¼šä¸ºä»€ä¹ˆGit çªç„¶ Push ä¸ä¸Šå»äº†]]></title>    <link>https://juejin.cn/post/7575112613777899554</link>    <guid>https://juejin.cn/post/7575112613777899554</guid>    <pubDate>2025-11-23T07:28:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575112613777899554" data-draft-id="7575106644499087394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¸©å‘æ—¥è®°ï¼šä¸ºä»€ä¹ˆGit çªç„¶ Push ä¸ä¸Šå»äº†"/> <meta itemprop="keywords" content="GitHub,Git,SSH"/> <meta itemprop="datePublished" content="2025-11-23T07:28:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°Luçš„æ—¥å¸¸"/> <meta itemprop="url" content="https://juejin.cn/user/2585689638569422"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¸©å‘æ—¥è®°ï¼šä¸ºä»€ä¹ˆGit çªç„¶ Push ä¸ä¸Šå»äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2585689638569422/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°Luçš„æ—¥å¸¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:28:34.000Z" title="Sun Nov 23 2025 07:28:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©åœ¨å¼€å‘çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªå¾ˆç¦»è°±çš„é—®é¢˜ï¼Œgit push æ˜æ˜æ˜¨å¤©è¿˜å¥½å¥½çš„ï¼Œç»“æœä»Šå¤©çªç„¶å®Œå…¨æ¨ä¸ä¸Šå»ã€‚</p>
<p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ERROR:</span> no healthy upstream
<span class="hljs-symbol">fatal:</span> Could <span class="hljs-built_in">not</span> read <span class="hljs-keyword">from</span> remote repository.

Please make sure you have the correct access rights
<span class="hljs-built_in">and</span> the repository exists.
</code></pre>
<p>æˆ–è€…æ˜¯</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ERROR:</span> upstream connect <span class="hljs-keyword">error</span> <span class="hljs-built_in">or</span> disconnect/reset before headers.
remote connection failure, transport failure reason: delayed connect <span class="hljs-keyword">error</span>: Connection refused
<span class="hljs-symbol">fatal:</span> Could <span class="hljs-built_in">not</span> read <span class="hljs-keyword">from</span> remote repository.
</code></pre>
<p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ GitHub æŒ‚äº†ï¼Œæˆ–è€…æˆ‘ SSH key å¤±æ•ˆäº†ã€‚ç»“æœä¸€åˆ‡æ­£å¸¸ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">ssh -T git@github.com

Hi shenlu89! You<span class="hljs-comment">'ve successfully authenticated, but GitHub does not provide shell access.</span>
</code></pre>
<p>æˆ‘åˆæŸ¥äº†ä¸€ä¸‹è¿œç«¯Gitä»“åº“çš„URLæ˜¯å¦æ­£ç¡®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">git remote -v 
origin  git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:shenlu89/docs.git (fetch)
origin  git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:shenlu89/docs.git (push)
</code></pre>
<p>SSH è¿æ¥æ²¡æœ‰é—®é¢˜</p>
<ul>
<li>ä»“åº“åœ°å€æ²¡é”™</li>
<li>SSH æˆæƒæ­£å¸¸</li>
<li>git remote -v æ­£å¸¸</li>
</ul>
<p>é‚£é—®é¢˜ä»å“ªé‡Œæ¥ï¼Ÿ</p>
<p>æ­£å¸¸æ¥è¯´ï¼Œä½¿ç”¨ SSH æ–¹å¼ pushï¼Œé‚£åªè¦ ssh -T å¯ç”¨ï¼Œpush ä¸€å®šå¯ç”¨ï¼Œä½†æˆ‘è¿™é‡Œï¼š</p>
<pre><code class="hljs language-java" lang="java">ssh -T git<span class="hljs-meta">@github</span>.com   <span class="hljs-comment">// æ­£å¸¸</span>
git push                <span class="hljs-comment">// å¤±è´¥</span>
</code></pre>
<p>è¿™è¯´æ˜ push åº•å±‚ä¸æ˜¯ç®€å•çš„ SSH é—®é¢˜ï¼Œè€Œæ˜¯ è¿æ¥è¢«ä»£ç†æˆ–ç½‘ç»œå¹²æ‰°äº†ã€‚</p>
<p>ç»§ç»­æ’æŸ¥ macOS ç³»ç»Ÿä»£ç†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">networksetup -getwebproxy <span class="hljs-string">"Wi-Fi"</span>
networksetup -getsocksfirewallproxy <span class="hljs-string">"Wi-Fi"</span>
</code></pre>
<p>ç»“æœæ˜¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Enabled:</span> <span class="hljs-literal">Yes</span>
<span class="hljs-attr">Server:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
<span class="hljs-attr">Port:</span> <span class="hljs-number">7890</span>
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒmacOS ç³»ç»Ÿçº§ HTTP/HTTPS/SOCKS éƒ½æŒ‡å‘äº† 127.0.0.1:7890ã€‚</p>
<p>è¿™å°±å¯¼è‡´æ‰€æœ‰ Git è¿æ¥èµ°ç³»ç»Ÿä»£ç†ï¼Œç³»ç»Ÿä»£ç†ä¸ºç©ºï¼Œè¯·æ±‚è¢«ç›´æ¥æ‹’ç»ï¼ŒGit push æŠ¥ connection refused</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ SSH æµ‹è¯•èƒ½è¿ï¼Œä½† git push åè€Œå¤±è´¥ã€‚</p>
<p>å› ä¸º SSH æµ‹è¯•å‘½ä»¤ä¸èµ°ç³»ç»Ÿä»£ç†ï¼Œè€Œ Git push èµ°äº†ã€‚</p>
<p>ç›´æ¥å…³æ‰ macOS çš„ä»£ç†å³å¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">networksetup -setwebproxystate <span class="hljs-string">"Wi-Fi"</span> <span class="hljs-keyword">off</span>
networksetup -setsecurewebproxystate <span class="hljs-string">"Wi-Fi"</span> <span class="hljs-keyword">off</span>
networksetup -setsocksfirewallproxystate <span class="hljs-string">"Wi-Fi"</span> <span class="hljs-keyword">off</span>
</code></pre>
<p>ç„¶åï¼š</p>
<pre><code class="hljs language-perl" lang="perl">git <span class="hljs-keyword">push</span>
</code></pre>
<p>ç¬é—´æ¢å¤æ­£å¸¸ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯å°† GitHub SSH æ”¹ç”¨ 443 ç«¯å£ï¼Œä¸ºäº†å…¼å®¹å„ç§å¥‡æ€ªç½‘ç»œç¯å¢ƒï¼ˆå…¬å¸ã€å­¦æ ¡ã€é…’åº— WiFi ç­‰ï¼‰ï¼Œæˆ‘é¡ºæ‰‹ä¹ŸæŠŠ GitHub SSH é€šé“æ”¹åˆ°äº† 443 ç«¯å£ï¼Œç¼–è¾‘ ~/.ssh/configï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Host github.com
    HostName ssh.github.com
    Port 443
    User git
    IdentityFile ~/.ssh/id_ed25519
    IdentitiesOnly <span class="hljs-built_in">yes</span>
</code></pre>
<p>443 ç«¯å£ä¸€èˆ¬ä¸ä¼šè¢«å°ï¼Œä¹Ÿä¸å—ä»£ç†å½±å“ï¼Œæ¯” 22 ç«¯å£ç¨³å®šå¤ªå¤šã€‚</p>
<p>è¿™æ ·é—®é¢˜å°±æˆåŠŸè§£å†³äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›´å°çŒ«ç§˜ç±]]></title>    <link>https://juejin.cn/post/7575162322239979520</link>    <guid>https://juejin.cn/post/7575162322239979520</guid>    <pubDate>2025-11-23T08:21:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575162322239979520" data-draft-id="7575162322239963136" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›´å°çŒ«ç§˜ç±"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-23T08:21:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’é’å­è¡¿æ‚ æ‚ æˆ‘å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/4383112851623134"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›´å°çŒ«ç§˜ç±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4383112851623134/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’é’å­è¡¿æ‚ æ‚ æˆ‘å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:21:37.000Z" title="Sun Nov 23 2025 08:21:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">åœ¨çº¿æ¸¸æˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Fc.getline.cloud%2F" target="_blank" title="https://c.getline.cloud/" ref="nofollow noopener noreferrer">c.getline.cloud/</a></h4>
<h4 data-id="heading-1">ç¤¾åŒºä»£ç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwenyang0%2Fphaser-catch-the-cat" target="_blank" title="https://github.com/wenyang0/phaser-catch-the-cat" ref="nofollow noopener noreferrer">github.com/wenyang0/phâ€¦</a></h4>
<h2 data-id="heading-2">å›´ä½ä¸€åªçŒ«çŒ«éœ€è¦å‡ æ­¥ï¼Ÿ</h2>
<p>ä»Šå¤©è¦è®²çš„æ¸¸æˆå«åš<strong>å›´å°çŒ«</strong>ï¼Œ2021å¹´åº•åœ¨æœ‹å‹åœˆé‡Œç€å®æ˜¯ç«äº†ä¸€æŠŠï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰ç©è¿‡ï¼Œå¯ä»¥åœ¨æœç´¢å¼•æ“ä¸­æœç´¢â€œå›´å°çŒ«â€ã€‚è®°å¿†åŠ›å¥½çš„è¯»è€…å¯èƒ½ä¼šè®°å¾—ï¼Œè¿™æ¬¾æ¸¸æˆå¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡ç«äº†ï¼Œæ²¡é”™ï¼Œå®ƒå°±æ˜¯2014å¹´æ›¾åœ¨æœ‹å‹åœˆå¤§ç«è¿‡çš„â€œ<strong>å›´ä½ç¥ç»çŒ«</strong>â€çš„æ–°çš®è‚¤ï¼å…¶åŸå‹å¯ä»¥è¿½æº¯åˆ°æ›´æ—©ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50d89ac7f601408fb93618e7c043c26e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=Qsl3%2FrBH4GfLzZEmIqnodG%2F5sXo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">æ¸¸æˆä»‹ç»</h3>
<p>é¦–å…ˆä»‹ç»ä¸€ä¸‹æ¸¸æˆè§„åˆ™ã€‚</p>
<ul>
<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼šå°çŒ«ä½äºæ£‹ç›˜ä¸­å¿ƒï¼Œ6-8ä¸ªéšœç¢ç‰©ä¼šè¢«é¢„å…ˆéšæœºæ”¾ç½®åœ¨åœ°å›¾ä¸Šã€‚</li>
<li><strong>æˆ‘æ–¹è¡ŒåŠ¨</strong>ï¼šæ¯æ¬¡ç‚¹å‡»å°åœ†ç‚¹å°±å¯ä»¥åœ¨è¯¥å¤„æ”¾ç½®ä¸€ä¸ªéšœç¢ç‰©ã€‚</li>
<li><strong>çŒ«çŒ«è¡ŒåŠ¨</strong>ï¼šå°çŒ«ä¹Ÿä¼šå‘åœ°å›¾è¾¹ç¼˜ç§»åŠ¨ä¸€æ ¼ã€‚</li>
<li><strong>èƒœè´Ÿåˆ¤å®š</strong>ï¼š
<ul>
<li><strong>èƒœåˆ©</strong>ï¼šçŒ«çŒ«è¢«éšœç¢ç‰©å›´ä½ã€‚</li>
<li><strong>å¤±è´¥</strong>ï¼šçŒ«çŒ«åˆ°è¾¾åœ°å›¾è¾¹ç¼˜æºœèµ°ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™æ ·ä¸æ–­é‡å¤ä¸‹å»ï¼Œç›´åˆ°æ¸¸æˆç»“æŸã€‚</p>
<p>åˆä¸Šæ‰‹çš„æ—¶å€™ä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªæ¸¸æˆå¹¶ä¸ç®€å•ï¼Œå‡ ä¹å¾ˆéš¾æˆåŠŸã€‚å› ä¸ºæ£‹ç›˜å…¶å®å¹¶ä¸å¤§ï¼ŒçŒ«åªéœ€è¦5æ­¥å°±å¯ä»¥è·‘å‡ºæ£‹ç›˜è¾¹ç•Œï¼Œå¾ˆéš¾å°†å°çŒ«å µä½ã€‚</p>
<p>é‚£ä¹ˆä¸€ä¸ªè‡ªç„¶è€Œç„¶çš„é—®é¢˜æ˜¯ï¼š<strong>å¦‚æœæ£‹ç›˜è¶³å¤Ÿå¤§ï¼Œå¯ä»¥ä¿è¯å°†å°çŒ«å µä½å—ï¼Ÿ</strong> åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œè¯·è®©æˆ‘å…ˆä»‹ç»ä¸€ä¸‹â€œå¤©ä½¿é—®é¢˜â€ã€‚</p>
<h3 data-id="heading-4">å¤©ä½¿é—®é¢˜</h3>
<p>å¤©ä½¿é—®é¢˜é¦–æ¬¡è§äº1982å¹´å‡ºç‰ˆçš„ã€ŠWinning Waysã€‹ä¸€ä¹¦ï¼Œç”±ä¹¦ä½œè€…æ•°å­¦å®¶<strong>çº¦ç¿°Â·HÂ·åº·å¨</strong>ï¼ˆJohn H. Conwayï¼‰æå‡ºã€‚è¿™æ˜¯ä¸€ä¸ªåŒæ–¹ç©å®¶åˆ†åˆ«æ‰®æ¼”å¤©ä½¿å’Œæ¶é­”çš„åšå¼ˆæ¸¸æˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b22fb76a8d2a4b5ca01291480a98fb5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=YFvnMhhKAH5wq%2B7TVKiFFNmSyFM%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>æ£‹ç›˜</strong>ï¼šæ¸¸æˆåœ¨ä¸€ä¸ªæ— é™å¤§æ–¹æ ¼æ£‹ç›˜ä¸Šè¿›è¡Œï¼Œèµ·å§‹æ£‹ç›˜æ˜¯ç©ºçš„ã€‚</li>
<li><strong>å¤©ä½¿</strong>ï¼šå®šä¹‰æ­£æ•´æ•°kä¸ºå¤©ä½¿çš„<strong>é˜¶æ•°</strong>ï¼Œké˜¶å¤©ä½¿æ¯æ­¥å¯ä»¥è·³åˆ°k*kèŒƒå›´å†…çš„ä»»ä½•ä¸€æ ¼ï¼Œæ— è®ºè·¯ä¸Šæœ‰æ²¡æœ‰éšœç¢ç‰©ã€‚</li>
<li><strong>æ¶é­”</strong>ï¼šæ¯ä¸€è½®ä¸­ï¼Œæ¶é­”å¯ä»¥åœ¨æ£‹ç›˜ä¸Šæ”¾ç½®ä¸€ä¸ªéšœç¢ç‰©ï¼Œä½†ä¸å¯æ”¾åœ¨å½“å‰å¤©ä½¿æ‰€åœ¨çš„ä½ç½®ã€‚</li>
<li><strong>èƒœè´Ÿ</strong>ï¼š
<ul>
<li>è‹¥åœ¨ä¸€è½®ä¸­ï¼Œå¤©ä½¿æ— æ³•ç§»åŠ¨ï¼Œåˆ™<strong>æ¶é­”è·èƒœ</strong>ã€‚</li>
<li>å¦‚æœå¤©ä½¿èƒ½æ— é™åœ°ç»§ç»­æ¸¸æˆï¼Œåˆ™<strong>å¤©ä½¿è·èƒœ</strong>ã€‚</li>
</ul>
</li>
</ul>
<p>åº·å¨å·²ç»è¯æ˜ï¼ˆè™½ç„¶ä»–è¯´æ˜¯è¯¥ä¹¦çš„å…±åŒä½œè€…ä¼¯åˆ©åæ™®å±•ç¤ºç»™ä»–çš„ï¼‰ï¼Œåªè¦æ£‹ç›˜å¤§å°å¤§äº32*33ï¼Œk=1çš„æƒ…å†µä¸‹æ¶é­”æ˜¯å¿…èƒœçš„ã€‚</p>
<p>ä¸ºæ–¹ä¾¿å±•ç¤ºï¼Œè¿™é‡Œå°†æ ¼ç‚¹åŒ–ä¸ºæ–¹æ ¼ã€‚å¦‚å›¾2æ‰€ç¤ºæ˜¯ä¸€ä¸ª33*33çš„æ£‹ç›˜ï¼Œå¤©ä½¿èµ·å§‹ä½äºçº¢è‰²æ–¹æ ¼ã€‚æ— è®ºå¤©ä½¿å¼€å±€æ€ä¹ˆèµ°ï¼Œæ¶é­”å‰8æ­¥åªéœ€å°†æ£‹ç›˜å››å‘¨çš„8ä¸ªé»‘æ ¼å¡«ä¸Šéšœç¢ç‰©ï¼Œè¿™æ—¶å¤©ä½¿å¿…ç„¶ä½äºä¸­é—´çš„è“è‰²åŒºåŸŸå†…ï¼Œè·ç¦»æ¥è§¦åŒ…å›´åœˆè¿˜æœ‰7æ­¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e127c1aa3e14800b0b33c4200a5ef70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=nNErLXb8nngKVGjdUFYjxR%2F19n0%3D" alt="image.png" loading="lazy"/></p>
<p>è€Œæ— è®ºå¤©ä½¿å‘å“ªä¸ªæ–¹å‘é€ƒï¼Œæ¶é­”éƒ½å¯ä»¥éš”ä¸€æ ¼æ”¾ä¸€ä¸ªéšœç¢ç‰©è¿™æ ·é€æ¸ç¼©å°ç¼ºå£ï¼Œä¿è¯åœ¨å¤©ä½¿æ¥è§¦æ£‹ç›˜è¾¹ç¼˜ä¹‹å‰å°†ç¼ºå£å µä¸Šï¼Œå› æ­¤æ¶é­”æ˜¯å¿…èƒœçš„ã€‚</p>
<h3 data-id="heading-5">å›åˆ°å›´å°çŒ«</h3>
<p>ä¸€é˜¶çš„å¤©ä½¿é—®é¢˜å‘Šè¯‰æˆ‘ä»¬ï¼Œåªè¦æ£‹ç›˜è¶³å¤Ÿå¤§ï¼Œè®©æˆ‘ä»¬å¯ä»¥æå‰å¸ƒç½®å¥½åŒ…å›´åœˆï¼Œå°±ä¸€å®šèƒ½å›´ä½å¤©ä½¿ã€‚è€Œä¸”å¤©ä½¿é—®é¢˜ä¸­çš„æ£‹ç›˜æ˜¯<strong>å…«è¿é€š</strong>çš„ï¼Œå³å¤©ä½¿å‘æ¨ªç«–æ–œå…«ä¸ªæ–¹å‘éƒ½å¯ä»¥ç§»åŠ¨ï¼Œæ‰€ä»¥å¸ƒç½®ä¸€ä¸ªåŒ…å›´åœˆè‡³å°‘éœ€è¦å…«æ­¥ã€‚è€Œå›´å°çŒ«ä¸­çš„æ£‹ç›˜æ˜¯<strong>å…­è¿é€š</strong>çš„ï¼Œå› æ­¤åŒ…å›´åœˆåªéœ€è¦6æ­¥ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰<strong>çŒ«çŒ«ä»ç©ºç™½æ£‹ç›˜ä¸­å¿ƒé€ƒè„±çš„æœ€å°‘æ­¥æ•°ä¸ºæ£‹ç›˜çš„æ·±åº¦n</strong>ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå›´å°çŒ«æ¸¸æˆçš„æ£‹ç›˜æ·±åº¦ä¸º5ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fae7ede7e26740388e006f99eea8d394~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=PyQoqXub0pokR%2BPDZ5sFYih9R7I%3D" alt="image.png" loading="lazy"/>
ä¸°å¯Œçš„æ¸¸æˆç»éªŒå‘Šè¯‰æˆ‘ï¼Œn=5æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚å¦‚æœè¦ä¿è¯å¿…èƒœï¼Œåƒå¤©ä½¿é—®é¢˜é‡Œä¸€æ ·å¸ƒç½®ä¸€ä¸ªåŒ…å›´åœˆè‡³å°‘éœ€è¦6ä¸ªéšœç¢ç‰©ï¼Œä¹Ÿå°±æ˜¯6æ­¥ã€‚å› ä¸ºçŒ«næ­¥å°±ä¼šé€ƒå‡ºæ£‹ç›˜ï¼Œè€Œæˆ‘ä»¬å¿…é¡»åœ¨çŒ«é€ƒè„±ä¹‹å‰èŠ±è‡³å°‘ä¸€æ­¥å µä½é€ƒè„±çš„æ–¹å‘ï¼Œæ‰€ä»¥æ£‹ç›˜çš„æ·±åº¦nè‡³å°‘åº”è¯¥ä¸º6+1+1=8ã€‚</p>
<p>é‚£ä¹ˆæ£‹ç›˜éœ€è¦æœ‰å¤šå¤§æ‰èƒ½ä¿è¯å¿…èƒœå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯<strong>n=8</strong>ã€‚å›¾ä¸­å¶æ•°å·æ ¼ç‚¹ä¸ºæˆ‘æ–¹æ”¾çš„éšœç¢ç‰©ï¼Œå¥‡æ•°å·æ ¼ç‚¹ä¾æ¬¡ä¸ºçŒ«çŒ«çš„è¡ŒåŠ¨è½¨è¿¹ï¼Œå¯ä»¥çœ‹åˆ°è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘æ–¹æ˜¯å¿…å®šè·èƒœçš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31f9c308eef741b6ada10e7d52125285~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=9uwMqLRD9PuNalIxJ4%2Byhl70rps%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰€ä»¥ï¼Œ<strong>åªè¦æ£‹ç›˜çš„æ·±åº¦ä¸å°äº8ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªç©ºç™½çš„æ£‹ç›˜ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å¿…å®šå¯ä»¥å›´ä½å°çŒ«çš„ã€‚</strong> ç›¸åº”åœ°ï¼Œåœ¨æ²¡æœ‰éšœç¢ç‰©çš„æƒ…å†µä¸‹ï¼Œæ£‹ç›˜æ·±åº¦å°äº8æ—¶æˆ‘ä»¬æ˜¯ä¸å¯èƒ½å›´ä½å°çŒ«çš„ã€‚</p>
<h3 data-id="heading-6">é‚£ä¹ˆï¼Œæœ‰éšœç¢ç‰©å‘¢ï¼Ÿ</h3>
<p>ç»ˆäºå›åˆ°äº†æˆ‘ä»¬æœ€åˆçš„é—®é¢˜ï¼š<strong>å¦‚ä½•åœ¨ä¸€ä¸ªn=5çš„æ£‹ç›˜ä¸Šåˆ©ç”¨å·²æœ‰çš„éšœç¢ç‰©å›´ä½çŒ«çŒ«ã€‚</strong></p>
<p>å…¶å®è¿™é‡Œçš„æ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯ï¼šå…ˆç”¨è‹¥å¹²æ­¥å¸ƒç½®ä¸€ä¸ªåŒ…å›´åœˆï¼Œç„¶åé€šè¿‡å›´å µæ¥å®Œå–„åŒ…å›´åœˆã€‚å”¯ä¸€çš„ä¸åŒæ˜¯ï¼Œç”±äºæ£‹ç›˜ä¸å¤Ÿå¤§ï¼Œæˆ‘ä»¬å¿…é¡»åˆ©ç”¨å·²æœ‰çš„éšœç¢ç‰©æ¥å¸ƒç½®åŒ…å›´åœˆã€‚å’Œæ£‹ç›˜çš„æ·±åº¦ä¸€æ ·ï¼Œæˆ‘ä»¬å®šä¹‰<strong>åŒ…å›´åœˆçš„æ·±åº¦ä¸ºçŒ«çŒ«é€ƒå‡ºåŒ…å›´åœˆçš„æœ€å°‘æ­¥æ•°</strong>ã€‚å¾ˆæ˜¾ç„¶ï¼ŒåŒ…å›´åœˆè¶Šæ·±ï¼Œç•™ç»™æˆ‘ä»¬å¸ƒç½®é˜²çº¿çš„æ­¥æ•°å°±è¶Šå¤šã€‚</p>
<p>å…ˆæ¥ç ”ç©¶ä¸€ä¸‹åŒ…å›´åœˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼š</p>
<ul>
<li>åŒ…å›´åœˆåº”å½“æ˜¯<strong>å…­è¾¹å½¢</strong>ï¼Œä¸æ£‹ç›˜å½¢çŠ¶ç›¸åŒã€‚</li>
<li>æ¯æ¡è¾¹éƒ½<strong>å¿…é¡»ç»è¿‡æ¯ä¸ªç»è¿‡æ ¼ç‚¹çš„åœ†å¿ƒ</strong>ï¼Œä¸å…è®¸æ–œç€ç›´æ¥è¿ã€‚</li>
<li>åªæœ‰åŒ…å›´åœˆçš„<strong>æ¯ä¸ªé¡¶ç‚¹</strong>ï¼ˆå¦‚ä¸‹é¢å›¾6ä¸­çš„1-6å·ç‚¹ï¼‰æˆ–è€…<strong>ä¸è¯¥é¡¶ç‚¹ç›¸é‚»ä¸”åœ¨åŒ…å›´åœˆä¸Šçš„æ ¼ç‚¹</strong>ï¼ˆå¦‚ä¸‹å›¾6ä¸­çš„7-15å·ç‚¹ï¼‰æœ‰éšœç¢ç‰©ï¼Œæ‰èƒ½èµ·åˆ°æŒ¡ä½çŒ«çŒ«çš„æ•ˆæœã€‚å¦‚æœä¸Šè¿°ä½ç½®æ²¡æœ‰éšœç¢ç‰©çš„è¯ï¼Œå°±æ— æ³•ä¿è¯åœ¨çŒ«çŒ«è¢«è¿½èµ¶åˆ°æ­¤å¤„æ—¶é—­åˆåŒ…å›´åœˆã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d09e8af6011b4b119ccf62883bf5cba2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=JOK236hgmRgUmBs3BPJZs54B2Eg%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä¸€ä¸ªé¡¶ç‚¹æˆ–ä¸å…¶ç›¸é‚»ä¸”åœ¨åŒ…å›´åœˆä¸Šçš„æ ¼ç‚¹ä¸Šæœ‰éšœç¢ç‰©ï¼Œæˆ‘ä»¬å°±ç§°è¿™ä¸ªé¡¶ç‚¹<strong>å·²å®Œæˆ</strong>ï¼Œå®šä¹‰ä¸€ä¸ª<strong>åŒ…å›´åœˆçš„å®Œæˆåº¦ä¸ºå·²å®Œæˆçš„é¡¶ç‚¹æ•°é‡</strong>ã€‚ä¸‹é¢æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec958e4073ee411098b78f7bd63b384c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=83Q0LPntbRJWr3FART%2FDFmikozI%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/734496a7e84d4208bb2c939f161cb2da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=%2ByXb1a4rcbk6%2FrgCQddumcVvEYk%3D" alt="image.png" loading="lazy"/>
å›¾6æ˜¯ä¸€ä¸ªåŒ…å›´åœˆçš„é›å½¢ï¼Œå¯ä»¥çœ‹åˆ°1ï¼Œ2ï¼Œ11ï¼Œ4ï¼Œ5å·ç‚¹éƒ½æœ‰éšœç¢ç‰©ï¼Œä»–ä»¬å¯¹åº”çš„é¡¶ç‚¹éƒ½å·²å®Œæˆã€‚ä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŒ…å›´åœˆï¼Œå› ä¸ºé¡¶ç‚¹6æ˜¯æœªå®Œæˆçš„ã€‚å¦‚æœçŒ«çŒ«ä»å³ä¸Šå¾€å·¦ä¸Šé€ƒï¼Œæˆ‘ä»¬å µä½8å·ç‚¹åçŒ«çŒ«ä¼šé€ƒè‡³16å·ç‚¹ï¼Œæ­¤æ—¶6ï¼Œ7ä¸¤ç‚¹å‡ç©ºï¼ŒçŒ«çŒ«é€ƒè„±ã€‚é¡¶ç‚¹5è™½ç„¶æœ‰éšœç¢ç‰©ï¼Œä½†å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼Œä¸èƒ½ç®—ä½œé¡¶ç‚¹6çš„ç›¸é‚»ç‚¹ã€‚æ‰€ä»¥è¿™ä¸ªåŒ…å›´åœˆçš„å®Œæˆåº¦æ˜¯5ã€‚</p>
<p>ä»æ£‹ç›˜æ·±åº¦ä¸º8çš„æƒ…å½¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨åŒ…å›´åœˆå®Œæˆï¼Œå³å®Œæˆåº¦ä¸º6æ—¶ï¼Œå¦‚æœçŒ«çŒ«è·ç¦»åŒ…å›´åœˆè‡³å°‘æœ‰2æ ¼ï¼Œæˆ‘ä»¬æ ¹æ®çŒ«çŒ«çš„ä½ç½®æ”¾éšœç¢ç‰©æ¥å›´å µå°±å¯ä»¥å¿…èƒœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å¿…èƒœæ¡ä»¶æ˜¯åŒ…å›´åœˆæ·±åº¦ + åŒ…å›´åœˆå®Œæˆåº¦è‡³å°‘ä¸º8</strong>ã€‚</p>
<p>æ‰€å¹¸ï¼Œä¸Šå›¾ä¸­çš„çŒ«çŒ«è·ç¦»åŒ…å›´åœˆæœ‰3æ ¼ï¼Œä¹Ÿå°±æ˜¯è¯´åŒ…å›´åœˆçš„æ·±åº¦æ˜¯3ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åªéœ€è¡¥ä¸ŠåŒ…å›´åœˆé‡Œç¼ºå¤±çš„ç‚¹ï¼Œå°±å¯ä»¥ä¿è¯å¿…èƒœã€‚è¿™å°±æ˜¯çœ‹è¿‡æœ¬æ–‡çš„æˆ‘ä»¬ï¼Œç¬¬ä¸€æ­¥è½åœ¨çœ‹ä¼¼ä¸éœ€è¦ä¼˜å…ˆå›´å µçš„6å·ç‚¹çš„åŸå› ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>ç”»åŒ…å›´åœˆä¹Ÿæ˜¯æœ‰æŠ€å·§çš„</strong>ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå›¾8å°±æœ‰ABä¸¤ç§ç”»åœˆçš„æ–¹å¼ï¼Œä¸”åŒ…å›´åœˆçš„å®Œæˆåº¦å‡ä¸º5ã€‚</p>
<ul>
<li>å¦‚æœæŒ‰ç…§<strong>çº¢è‰²çš„Aæ–¹æ¡ˆ</strong>è§„åˆ’4ï¼Œ5å·ç‚¹ä¹‹é—´çš„åŒ…å›´åœˆï¼Œåˆ™åŒ…å›´åœˆçš„æ·±åº¦ä¸º2ï¼Œ5+2&lt;8ï¼Œæ— æ³•å›´ä½çŒ«çŒ«ã€‚</li>
<li>å¦‚æœæŒ‰ç…§<strong>è“è‰²çš„æ–¹æ¡ˆB</strong>ï¼Œåˆ™åŒ…å›´åœˆçš„æ·±åº¦ä¸º3ï¼Œ5+3=8ï¼Œå¯ä»¥å›´ä½çŒ«çŒ«ã€‚</li>
</ul>
<p>æ‰€ä»¥ç”»åœˆçš„æ–¹å¼ä¹Ÿæ˜¯å¾ˆé‡è¦çš„å“¦ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c253ad1207f44269b9d87554e1898ed1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=LyA3Cx6A0sxctaAGCGbjAfcPqC8%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶è€Œï¼Œç”±äºæ¸¸æˆæ¡ä»¶çš„é™åˆ¶ï¼Œåˆå§‹åªæœ‰6-8ä¸ªéšœç¢ç‰©ï¼Œæ£‹ç›˜æ·±åº¦ä¹Ÿåªæœ‰5ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯æ— æ³•å¿…èƒœçš„ï¼Œå¦‚æœæƒ³å›´ä½å°çŒ«ï¼Œå°±å¤šå¤šåœ°åˆ·æ–°å§ï¼</p>
<p>ä¸è¿‡ï¼Œå®é™…ä¸Šæ¸¸æˆé‡Œçš„è¿™åªå°çŒ«å¹¶ä¸å¤ªèªæ˜ï¼Œå®ƒçš„é€ƒè„±é€»è¾‘åªæ˜¯ä¸€ä¸ª<strong>å•å±‚çš„è´ªå¿ƒç®—æ³•</strong>ï¼šåªè€ƒè™‘å½“å‰çœ‹æ¥æ˜¯æœ€å¥½çš„é€ƒè„±è·¯çº¿ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹è®¾ä¸‹é™·é˜±ï¼Œè¯±å¯¼çŒ«çŒ«èµ°å‡ºå¤šä½™çš„æ­¥æ•°ï¼Œä»è€Œèµ¢ä¸‹æ— æ³•å¿…èƒœçš„æ£‹ç›˜ï¼Œæœ‰å…´è¶£çš„è¯»è€…æœ‹å‹ä¸€å®šè¦å»è¯•ä¸€è¯•å“¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b8da92d294b4d5497ad26d245eb7d5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S6Z2S5a2Q6KG_5oKg5oKg5oiR5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490897&amp;x-signature=ioO5GPCWelHSQpxc5iKQUWAyz3s%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">å›´ä½çŒ«çŒ«çš„ç§˜è¯€ï¼</h3>
<p>æœ€åï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å›´ä½çŒ«çŒ«çš„ç§˜è¯€å§ï¼åªéœ€è¦ç®€å•çš„ä¸‰æ­¥å“¦ã€‚</p>
<ol>
<li><strong>ç¬¬ä¸€æ­¥</strong>ï¼šæ ¹æ®å·²æœ‰çš„åˆå§‹éšœç¢ç‰©åˆ’å®šåŒ…å›´åœˆï¼Œåœ¨ä¿è¯æœ‰å°½å¯èƒ½å¤šé¡¶ç‚¹è¢«å®Œæˆçš„å‰æä¸‹ï¼Œè®©åŒ…å›´åœˆçš„æ·±åº¦å°½å¯èƒ½åœ°å¤§ã€‚</li>
<li><strong>ç¬¬äºŒæ­¥</strong>ï¼šåˆ¤æ–­<strong>åŒ…å›´åœˆå®Œæˆåº¦ + åŒ…å›´åœˆçš„æ·±åº¦</strong>æ˜¯å¦<strong>â‰¥8</strong>ï¼Ÿå¦‚æœå°äºåˆ™æ— æ³•ä¿è¯å›´ä½çŒ«çŒ«ï¼Œç›´æ¥é‡ç½®ã€‚</li>
<li><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šå…ˆå°†åŒ…å›´åœˆå®Œæˆï¼Œç„¶åå¯¹åº”çŒ«çŒ«æ‰€åœ¨ä½ç½®è¿›è¡Œå›´å µå³å¯è·èƒœã€‚</li>
</ol>
<h3 data-id="heading-8">å†™åœ¨æœ€å</h3>
<p>è¿˜è®°å¾—å¼€å¤´è¯´çš„å¤©ä½¿é—®é¢˜å—ï¼Ÿè¿™ä¸ªé—®é¢˜å…¶å®å¹¶æ²¡æœ‰è¢«å®Œå…¨è§£å†³ã€‚ç›®å‰åœ¨å¤©ä½¿çš„é˜¶æ•°kæ¯”è¾ƒå°ï¼Œæ¯”å¦‚k=2çš„æ—¶å€™ï¼Œæ•°å­¦å®¶å·²ç»è¯æ˜å¤©ä½¿åœ¨æ— é™å¤§æ£‹ç›˜ä¸Šæ˜¯å¿…èƒœçš„ï¼Œä½†æ˜¯å¯¹äºä»»æ„æœ‰é™é˜¶çš„å¤©ä½¿ï¼Œå“ªæ–¹èƒ½å¿…èƒœè¿™ä¸ªé—®é¢˜å°šæ— ç­”æ¡ˆã€‚</p>
<p>ä¹Ÿè®¸ï¼Œèƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜çš„å°±æ˜¯èªæ˜çš„ä½ ã€‚</p>
<p><strong>è§£å†³ä¸äº†ä¹Ÿæ²¡å…³ç³»ï¼Œè‡³å°‘ï¼Œä½ å­¦ä¼šå¦‚ä½•æŠ“ä½çŒ«çŒ«äº†ï¼Œå¯¹å§ï¼Ÿ</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» JDK1.2 åˆ° JDK21ï¼šThreadLocalçš„è¿›åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜]]></title>    <link>https://juejin.cn/post/7575367791272804390</link>    <guid>https://juejin.cn/post/7575367791272804390</guid>    <pubDate>2025-11-23T09:55:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575367791272804390" data-draft-id="7575182522411335718" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» JDK1.2 åˆ° JDK21ï¼šThreadLocalçš„è¿›åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,Java,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-23T09:55:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åªå«ç…¤çƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/1732486058745054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» JDK1.2 åˆ° JDK21ï¼šThreadLocalçš„è¿›åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486058745054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åªå«ç…¤çƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T09:55:30.000Z" title="Sun Nov 23 2025 09:55:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. JDK 1.2ï¼šThreadLocal åˆç‰ˆï¼ˆæœ€å°å¯ç”¨ï¼‰</h2>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><code>ThreadLocal</code> é¦–æ¬¡å‡ºç°ã€‚</li>
<li>æ¯ä¸ªçº¿ç¨‹ç»´æŠ¤è‡ªå·±çš„ <code>ThreadLocalMap</code>ã€‚</li>
<li><code>ThreadLocalMap</code> çš„ key å°±æ˜¯ <code>ThreadLocal</code> æœ¬èº«ã€‚</li>
<li>åº•å±‚ä½¿ç”¨å¼€æ”¾åœ°å€æ³•çš„å“ˆå¸Œè¡¨ï¼ˆ<code>Entry[] table</code>ï¼‰ã€‚</li>
<li><strong>key ä¸æ˜¯å¼±å¼•ç”¨</strong>ï¼Œå¯¼è‡´ ThreadLocal å¯¹è±¡ä¸é‡Šæ”¾æ—¶å¯èƒ½é€ æˆå†…å­˜æ³„æ¼ã€‚</li>
</ul>
<p><strong>ä¸»è¦é—®é¢˜ï¼š</strong></p>
<ul>
<li>ThreadLocal å®ä¾‹å¦‚æœè¢« GC å›æ”¶å‰æœªæ‰‹åŠ¨ <code>remove()</code>ï¼Œçº¿ç¨‹ï¼ˆå°¤å…¶æ˜¯çº¿ç¨‹æ± ï¼‰ä¸ä¼šç»“æŸï¼ŒEntry æ°¸è¿œå­˜åœ¨ï¼Œå¯¼è‡´ value æ³„æ¼ã€‚</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯è¡Œä¸šé‡Œå¸¸è¯´çš„ ThreadLocal æ³„æ¼æœ€åˆæ¥æºã€‚</p>
<hr/>
<h2 data-id="heading-1">2. JDK 1.3 ~ 1.4ï¼šBug ä¿®å¤ + è¡Œä¸ºç¨³å®š</h2>
<p><strong>å…³é”®æ”¹åŠ¨ï¼š</strong></p>
<ul>
<li>å¢å¼ºæ¸…ç†æœºåˆ¶ï¼Œä½†ä¾ç„¶æ˜¯ key å¼ºå¼•ç”¨ã€‚</li>
<li>ä¿®å¤éƒ¨åˆ†æ‰©å®¹å’Œå†²çªå¤„ç†é—®é¢˜ã€‚</li>
</ul>
<p>ä½†æ ¹æœ¬æ€§çš„æ³„æ¼é—®é¢˜ä»ç„¶å­˜åœ¨ã€‚</p>
<hr/>
<h2 data-id="heading-2">3. JDK 5ï¼šå¼•å…¥å¼±å¼•ç”¨ï¼ˆå…³é”®é‡Œç¨‹ç¢‘ï¼‰</h2>
<p>è¿™æ˜¯ ThreadLocal è®¾è®¡å²ä¸Šæœ€é‡è¦çš„å˜æ›´ã€‚</p>
<p><strong>é‡å¤§æ›´æ–°ï¼š</strong></p>
<ul>
<li>
<p><code>ThreadLocalMap.Entry</code> æ”¹ä¸º <strong>å¼±å¼•ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-scala" lang="scala">static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WeakReference&lt;ThreadLocal&lt;?&gt;&gt;</span> </span>{
    <span class="hljs-type">Object</span> value;
}
</code></pre>
</li>
<li>
<p>ä¸€æ—¦ ThreadLocal å¯¹è±¡ä¸å†è¢«å¤–éƒ¨å¼•ç”¨ï¼Œå¯ä»¥è¢« GC å›æ”¶ï¼ŒEntry çš„ key ä¼šå˜æˆ <code>null</code>ã€‚</p>
</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆæ”¹æˆå¼±å¼•ç”¨ï¼Ÿ</strong></p>
<ul>
<li>é˜²æ­¢ ThreadLocal å¯¹è±¡ä¸é‡Šæ”¾å¯¼è‡´æ•´ç»„ Entry æ— æ³•è¢«æ¸…ç†ã€‚</li>
</ul>
<p><strong>å¸¦æ¥çš„å‰¯ä½œç”¨ï¼š</strong></p>
<ul>
<li>value ä»ç„¶æ˜¯å¼ºå¼•ç”¨ï¼Œåªè¦çº¿ç¨‹æ´»ç€ï¼Œvalue æ°¸è¿œä¸ä¼šè¢«å›æ”¶ã€‚</li>
<li>å¦‚æœä½ ä¸æ‰‹åŠ¨ <code>remove()</code>ï¼Œä¾æ—§å¯èƒ½å†…å­˜æ³„æ¼ï¼ˆå°¤å…¶çº¿ç¨‹æ± ï¼‰ã€‚</li>
</ul>
<p>è‡³æ­¤ï¼ŒThreadLocal çš„å†…å­˜æ³„æ¼é—®é¢˜å˜æˆäº†ï¼š</p>
<ul>
<li><strong>ä¸æ˜¯ key æ³„æ¼ï¼Œè€Œæ˜¯ value æ³„æ¼ã€‚</strong></li>
</ul>
<hr/>
<h2 data-id="heading-3">4. JDK 6ï¼šæ¸…ç†æœºåˆ¶å¢å¼º + TAB æ•°ç»„ rehash æ”¹å–„</h2>
<p><strong>JDK6 çš„é‡è¦æ¼”è¿›ï¼š</strong></p>
<ul>
<li>åŠ å¼ºå¯¹ key ä¸º <code>null</code> çš„ Entry çš„æ¸…ç†é€»è¾‘ï¼ˆä¾‹å¦‚è®¿é—®å†²çªä½ç‚¹æ—¶ä¸»åŠ¨æ¸…ç†ï¼‰ã€‚</li>
<li>ä¼˜åŒ– rehash å’Œæ¢æµ‹æœºåˆ¶ã€‚</li>
</ul>
<p>æ•´ä½“ç»“æ„ä»ä¸ºå¼€æ”¾åœ°å€æ³•ï¼Œä¸æ”¹å˜æœ¬è´¨æœºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-4">5. JDK 7ï¼šæ€§èƒ½ä¼˜åŒ– + éƒ¨åˆ†çº¿ç¨‹å±€éƒ¨ç¼“å­˜è¡Œä¸ºæ”¹è¿›</h2>
<p>JDK7 çš„å˜åŒ–åå‘å®ç°å±‚ã€‚</p>
<p><strong>å¢å¼ºç‚¹ï¼š</strong></p>
<ul>
<li>å®Œå–„å†²çªæ¢æµ‹ï¼Œé™ä½å“ˆå¸Œå†²çªå¯¼è‡´çš„é€€åŒ–ã€‚</li>
<li>æ”¹å–„ nextIndex/prevIndex çš„æ€§èƒ½ã€‚</li>
<li>ä¿®å¤æ‰©å®¹å rehash çš„ä¸€äº› bugã€‚</li>
</ul>
<p>ThreadLocalMap å˜å¾—æ›´å¥å£®ï¼Œä½†ä¸æ”¹å˜è¯­ä¹‰ã€‚</p>
<hr/>
<h2 data-id="heading-5">6. JDK 8ï¼šæ¸…ç†ç­–ç•¥è¿›ä¸€æ­¥åŠ å¼ºï¼Œæ ¸å¿ƒé€»è¾‘æˆç†Ÿç¨³å®š</h2>
<p><strong>å…³é”®å˜åŒ–ï¼š</strong></p>
<ul>
<li>
<p>ThreadLocalMap æ¸…ç† <code>stale entry</code>ï¼ˆkey = nullï¼‰çš„ç­–ç•¥æ›´åŠ æ¿€è¿›ï¼š</p>
<ul>
<li>get/set/remove æ—¶éƒ½ä¼šå°è¯•æ¸…ç†æ­» keyã€‚</li>
</ul>
</li>
<li>
<p>å†…éƒ¨ rehash ç­–ç•¥æ›´é«˜æ•ˆã€‚</p>
</li>
<li>
<p>çº¿ç¨‹æ± åœºæ™¯ä¸‹çš„å†…å­˜æ³„æ¼ä»ç„¶éœ€è¦æ‰‹åŠ¨å¤„ç† (<code>remove()</code>)ï¼Œä½† default é€»è¾‘æ›´å¥å£®ã€‚</p>
</li>
</ul>
<p><strong>JDK8 çš„ ThreadLocal åŸºæœ¬æˆä¸ºè¡Œä¸šä¸»æµå‚è€ƒå®ç°ã€‚</strong></p>
<hr/>
<h2 data-id="heading-6">7. JDK 9ï¼šæ–°å¢ <code>ThreadLocal.withInitial()</code>ï¼ˆè¯­æ³•ç³–ï¼‰</h2>
<p>æ­¤ç‰ˆæœ¬ä»¥åå±äºç¨³å®šæœŸï¼Œæ–°å¢åŠŸèƒ½è€Œéæœºåˆ¶å˜åŒ–ã€‚</p>
<p><strong>æ–°å¢ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">ThreadLocal<span class="hljs-selector-class">.withInitial</span>(() -&gt; new <span class="hljs-built_in">SimpleDateFormat</span>("yyyy-MM-dd"))
</code></pre>
<p>æœºåˆ¶ä¸å˜ï¼Œæ˜“ç”¨æ€§æå‡ã€‚</p>
<hr/>
<h2 data-id="heading-7">8. JDK 11 / JDK 17ï¼šå‡ ä¹æ— å˜åŒ–ï¼Œå±äºç¨³å®šç»´æŠ¤æœŸ</h2>
<ul>
<li>æŒç»­åšå°ä¿®å¤ï¼Œå¢å¼ºå¯è¯»æ€§ä¸è¾¹ç•Œå¤„ç†ã€‚</li>
<li>å†…å­˜æ¸…ç†ç­–ç•¥ä¸ JDK8 å‡ ä¹æ— å·®åˆ«ã€‚</li>
<li>è¯­ä¹‰å’Œè¡Œä¸ºå·²ç»éå¸¸ç¨³å®šã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">9. JDK 21ï¼šè™šæ‹Ÿçº¿ç¨‹ï¼ˆLoomï¼‰ä¸‹çš„ ThreadLocal è¯­ä¹‰æ‰©å±•ï¼ˆé‡è¦ï¼‰</h2>
<p>åœ¨ Loomï¼ˆè™šæ‹Ÿçº¿ç¨‹ï¼‰ä¸­ï¼š</p>
<p><strong>ThreadLocal é»˜è®¤æœºåˆ¶ä»ç„¶å¯ç”¨ï¼Œä½†æˆæœ¬æ›´ä½ï¼š</strong></p>
<ul>
<li>è™šæ‹Ÿçº¿ç¨‹æ˜¯è½»é‡ç»“æ„ï¼Œä¿ç•™è‡ªå·±çš„ ThreadLocalMapã€‚</li>
<li>è™šæ‹Ÿçº¿ç¨‹ä¸å¤ç”¨ï¼Œç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œå› æ­¤ä¸å®¹æ˜“äº§ç”Ÿ ThreadLocal value æ³„æ¼ã€‚</li>
</ul>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>è™šæ‹Ÿçº¿ç¨‹ä¸æ˜¯æ± åŒ–çº¿ç¨‹ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹æ± æ³„æ¼é—®é¢˜ã€‚</li>
<li>æŸäº›åœºæ™¯ ThreadLocal æˆæœ¬åè€Œæ¯”ä¼ ç»Ÿçº¿ç¨‹æ›´è½»ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">10. å‰åæœºåˆ¶çš„æ ¸å¿ƒå˜åŒ–æ€»ç»“</h2>


















































<table><thead><tr><th>JDK ç‰ˆæœ¬</th><th>å˜åŒ–ç‚¹</th><th>å½±å“</th></tr></thead><tbody><tr><td>1.2</td><td>åŸºæœ¬å®ç°</td><td>å­˜åœ¨ä¸¥é‡æ³„æ¼é£é™©</td></tr><tr><td>1.3-1.4</td><td>Bug ä¿®å¤</td><td>ç¨³å®šæ€§å¢å¼º</td></tr><tr><td>5</td><td><strong>key æ”¹ä¸ºå¼±å¼•ç”¨</strong></td><td>é¿å… key æ³„æ¼ï¼Œä½† value æ³„æ¼ä¾æ—§</td></tr><tr><td>6</td><td>åŠ å¼ºåŒ–æ¸…ç†é€»è¾‘</td><td>é™ä½å†…å­˜æ³„æ¼é£é™©</td></tr><tr><td>7</td><td>è¿›ä¸€æ­¥ä¼˜åŒ–å†²çªå¤„ç†</td><td>æ€§èƒ½æå‡</td></tr><tr><td>8</td><td><strong>æˆç†Ÿå®ç°ï¼Œæ¸…ç†æ›´æ¿€è¿›</strong></td><td>æ ‡å‡†å®ç°ï¼Œè¢«è¡Œä¸šæ™®éä½¿ç”¨</td></tr><tr><td>9+</td><td>æ˜“ç”¨æ€§æå‡ï¼ˆwithInitialï¼‰</td><td>å¼€å‘ä½“éªŒå¢å¼º</td></tr><tr><td>21</td><td>è™šæ‹Ÿçº¿ç¨‹æ”¯æŒç¨³å®š</td><td>æ³„æ¼é£é™©æ˜¾è‘—é™ä½</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10">11. å“ªäº›é—®é¢˜è´¯ç©¿æ‰€æœ‰ç‰ˆæœ¬ï¼Ÿ</h2>
<p>æ— è®ºå“ªä¸ªç‰ˆæœ¬ï¼ŒThreadLocal æ°¸è¿œæœ‰ä¸¤ä¸ªæ ¸å¿ƒé£é™©ï¼š</p>
<ol>
<li><strong>value ä¼šæ³„æ¼ï¼Œåªè¦çº¿ç¨‹è¿˜æ´»ç€</strong></li>
<li><strong>çº¿ç¨‹æ± å¤ç”¨å¯¼è‡´ value é•¿æœŸé©»ç•™</strong></li>
</ol>
<p>è¿™ä¸¤ä¸ªé—®é¢˜åœ¨ JDK21 çš„è™šæ‹Ÿçº¿ç¨‹ä¸­å¼±åŒ–ä½†æœªå½»åº•æ¶ˆå¤±ã€‚</p>
<hr/>
<h2 data-id="heading-11">12. ä¸šå†…æœ€ä½³å®è·µ</h2>
<ol>
<li>åˆ›å»ºåå¿…é¡»æ‰‹åŠ¨ <code>remove()</code></li>
<li>é¿å…åœ¨å®¹å™¨/æ¡†æ¶çº§åˆ«ç¼“å­˜ä¸šåŠ¡å€¼</li>
<li>é¿å…ä½¿ç”¨æ— ç•Œçº¿ç¨‹æ± ç»“åˆ ThreadLocal</li>
<li>ä¸è¦æŠŠ ThreadLocal å½“æˆä¸Šä¸‹æ–‡ä¼ é€’æœºåˆ¶ï¼ˆåº”ä½¿ç”¨ ThreadLocal è®¾è®¡çš„æ¡†æ¶ï¼‰</li>
<li>æ¨èä½¿ç”¨ <code>withInitial()</code> é¿å… null å€¼</li>
</ol>
<hr/>
<h2 data-id="heading-12">13. è®²æ¸…æ¥šæœ¬è´¨</h2>
<p><strong>ThreadLocal åœ¨æ•´ä¸ª JDK ç”Ÿå‘½å‘¨æœŸä¸­çš„æ ¸å¿ƒå˜åŒ–åªæœ‰ä¸€æ¬¡ï¼šJDK5 å¼•å…¥å¼±å¼•ç”¨ã€‚</strong></p>
<p>å…¶ä½™ç‰ˆæœ¬æ”¹åŠ¨éƒ½æ˜¯ï¼š</p>
<ul>
<li>æ›´æ¿€è¿›çš„æ¸…ç†ç­–ç•¥</li>
<li>æ›´å¥å£®çš„å“ˆå¸Œæ¢æµ‹ä¸ rehash</li>
<li>æ›´æ˜“ç”¨çš„ API</li>
<li>è™šæ‹Ÿçº¿ç¨‹åœºæ™¯ä¸‹çš„è¿è¡Œæ—¶è¡¨ç°æ”¹å–„</li>
</ul>
<p>ä½†è¡Œä¸ºæœ¬è´¨æ²¡æœ‰æ”¹å˜ï¼š</p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä¸ª Map</li>
<li>key å¼±å¼•ç”¨</li>
<li>value å¼ºå¼•ç”¨</li>
<li>éœ€è¦æ‰‹åŠ¨ removeï¼Œçº¿ç¨‹æ± ä¸­æ›´åº”å½“å¦‚æ­¤</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»æµ·é‡æ—¶åºæ•°æ®åˆ°æ— äººå€¼å®ˆï¼šæ•°æ®åº“åœ¨æ–°èƒ½æºé›†æ§ç³»ç»Ÿä¸­çš„æ¶æ„å®è·µ]]></title>    <link>https://juejin.cn/post/7575442779038761002</link>    <guid>https://juejin.cn/post/7575442779038761002</guid>    <pubDate>2025-11-23T08:22:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575442779038761002" data-draft-id="7575442779038744618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»æµ·é‡æ—¶åºæ•°æ®åˆ°æ— äººå€¼å®ˆï¼šæ•°æ®åº“åœ¨æ–°èƒ½æºé›†æ§ç³»ç»Ÿä¸­çš„æ¶æ„å®è·µ"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-11-23T08:22:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºçš„çŸ³å¤´_"/> <meta itemprop="url" content="https://juejin.cn/user/3168119757484368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»æµ·é‡æ—¶åºæ•°æ®åˆ°æ— äººå€¼å®ˆï¼šæ•°æ®åº“åœ¨æ–°èƒ½æºé›†æ§ç³»ç»Ÿä¸­çš„æ¶æ„å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3168119757484368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºçš„çŸ³å¤´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:22:35.000Z" title="Sun Nov 23 2025 08:22:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b59e5aa258b845fc8c7f38558707f456~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490954&amp;x-signature=EjncswH7gCo%2BAzdkVNhJOGIhN3Y%3D" alt="640.gif" loading="lazy"/></p>
<p>@[toc]</p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>è°ˆåˆ°â€œåŒç¢³â€ä¸èƒ½æºé©å‘½ï¼Œé£ç”µï¼Œå…‰ä¼è¿™äº›æ–°èƒ½æºäº§ä¸šæ˜¾ç„¶æ˜¯å½“ä¸‹æœ€ä¸ºç‚™æ‰‹å¯çƒ­çš„é£å£ï¼Œè‹¥æƒ³åœ¨è¯¥èµ›é“è·‘å¾—æ›´è¿œï¼Œæ›´å¿«ï¼Œæ•°å­—åŒ–å’Œæ™ºèƒ½åŒ–è½¬å‹å¹¶éå¯é€‰ï¼Œè€Œæ˜¯å¿…å¤‡åŠŸè¯¾ï¼Œè¦çŸ¥é“ï¼Œä»è¿œç¨‹æ“æ§æˆåƒä¸Šä¸‡å°é£ç”µæœºç»„ï¼Œåˆ°åŠæ—¶åˆ†æå¤§é‡çš„è®¾å¤‡æ•°æ®ï¼Œç›´è‡³æŠŠæ•´ä¸ªç”Ÿäº§è¿ç»´æµç¨‹ç®¡ç†å¾—äº•äº•æœ‰æ¡ï¼Œå“ªä¸€æ­¥èƒ½ç¦»å¼€ç¨³å®šï¼Œé«˜æ•ˆä¸”å®‰å…¨çš„æ•°æ®â€œå¤§åæ–¹â€å‘¢ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œä¸€äº›é—®é¢˜ä¾¿éšä¹‹å‡ºç°ï¼Œæ–°èƒ½æºç›¸å…³ä¸šåŠ¡å¯¹äºæ•°æ®åº“çš„è¦æ±‚éå¸¸é«˜ï¼Œå…¶ä¸€ï¼Œç‰©è”ç½‘è®¾å¤‡æ¯æ—¥æ‰€ç”Ÿæˆçš„æ—¶åºæ•°æ®é‡çŠ¹å¦‚å¤©æ–‡æ•°å­—ï¼Œå…¶äºŒï¼Œç”Ÿäº§ç»è¥ä½“ç³»è¦æ‰¿å—é«˜å¹¶å‘è®¿é—®çš„å‹åŠ›ï¼Œé‚£äº›ä½äºå››é¢å…«æ–¹åœºç«™è¿˜è¦æ‰§è¡Œå¥½å®¹ç¾å¤‡ä»½å·¥ä½œï¼Œè¿™å°±åƒè¦æ±‚ä¸€ååå«ä¸ä½†è¦é€Ÿåº¦å¿«è€Œä¸”ä½“æ ¼å¥ç¡•ï¼Œå…³é”®æ—¶å€™ä¹Ÿä¸èƒ½å‡ºç°çº°æ¼ã€‚</p>
<p>åœ¨æ­¤ç§å¤§èƒŒæ™¯ä¹‹ä¸‹ï¼Œæˆ‘ä»¬é«˜å…´åœ°å‘ç°ï¼Œå›½äº§æ•°æ®åº“æ­£ä¾é è‡ªèº«çš„æŠ€æœ¯å®åŠ›ä¸æœåŠ¡ï¼Œæ¸æ¸åŒ–ä¸ºæ–°èƒ½æºè¡Œä¸šæ•°å­—åŒ–è½¬å‹çš„ä¸­åšåŠ›é‡ï¼Œé‡‘ä»“æ•°æ®åº“ï¼ˆKingbaseï¼‰ä¾¿æ˜¯å…¶ä¸­ä¸å¯å¿½ç•¥çš„ä¸€ä¸ªå­˜åœ¨ï¼Œå…¶çŠ¹å¦‚ä¸€ä½èº«æ€€ç»æŠ€çš„â€œæ‰«åœ°åƒ§â€ï¼Œå‡­å€Ÿåœ¨é«˜æ€§èƒ½ï¼Œé«˜å¯é æ€§ï¼Œé«˜å®‰å…¨æ€§ä»¥åŠæ™ºèƒ½è¿ä½œç»´æŠ¤æ–¹é¢æ‰€ç§¯æ·€çš„æ·±åšåŠŸåº•ï¼Œç»™ä¼—å¤šæ–°èƒ½æºä¼ä¸šçš„å…³é”®ç³»ç»Ÿç»™äºˆäº†ç¨³å›ºæœ‰åŠ›çš„æ”¯æŒï¼Œå¾ˆå¥½åœ°è§£å†³äº†è®¸å¤šä»¤äººå¤´ç–¼çš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-1">å…³äºé‡‘ä»“æ•°æ®åº“</h2>
<p>é‚£ä¹ˆï¼Œè¿™ä¸ªé‡‘ä»“æ•°æ®åº“åˆ°åº•æ˜¯ä»€ä¹ˆæ¥å¤´ï¼Ÿ</p>
<p>ç®€å•æ¥è¯´ï¼ŒKingbaseæ˜¯ç”µç§‘é‡‘ä»“ï¼ˆåŒ—äº¬ï¼‰ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸çš„å½“å®¶äº§å“ã€‚è¿™å®¶å…¬å¸æ¥å¤´ä¸å°ï¼Œä¸ä½†æ˜¯å›½å†…æœ€æ—©ä¸€æ‰¹åšè‡ªä¸»æ•°æ®åº“çš„å‚å•†ï¼Œè¿˜æ˜¯ä¸­å›½ç”µå­ç§‘æŠ€é›†å›¢ï¼ˆCETCï¼‰çš„â€œå›½å®¶é˜Ÿâ€æˆå‘˜ã€‚ä»–ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯è¦åšé¡¶å°–çš„ä¼ä¸šçº§æ•°æ®åº“äº§å“ã€‚</p>
<p>å…¶æ——èˆ°äº§å“é‡‘ä»“æ•°æ®åº“ç®¡ç†ç³»ç»ŸKingbaseESï¼ˆç®€ç§°KESï¼‰ï¼Œå°±æ˜¯ä¸€æ¬¾ä¸“ä¸ºäº‹åŠ¡å¯†é›†ã€é«˜å¹¶å‘ã€é«˜å¯ç”¨çš„å¤æ‚åœºæ™¯æ‰“é€ çš„ä¼ä¸šçº§å…³ç³»å‹æ•°æ®åº“ã€‚å®ƒæœ‰å‡ æ‰‹â€œç‹¬é—¨ç»æŠ€â€ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa25b64f0e334c88b3e0d54130d4d5a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490954&amp;x-signature=aLBSol7mNTMuluaP9OmhvBlgun4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/755f78bc8e8549ada0abdf17cd814a3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490954&amp;x-signature=LOv6GV1IzvMLOXea9rlSF5A8KQs%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<p><strong>å“è¶Šæ€§èƒ½ä¸è‡ªæ²»è°ƒä¼˜</strong>ï¼šå¬èµ·æ¥å¾ˆä¸“ä¸šï¼Œå…¶å®å¯ä»¥ç†è§£ä¸ºKingbaseESçš„å†…æ ¸é‡Œè—ç€ä¸€ä¸ªâ€œè°ƒä¼˜æœºå™¨äººâ€ã€‚å®ƒèƒ½è‡ªå·±è¯Šæ–­ã€è‡ªå·±ä¼˜åŒ–ï¼ŒæŠŠä»¥å‰éœ€è¦æ•°æ®åº“ä¸“å®¶ç†¬å¤œå¹²çš„æ´»å„¿ï¼Œå˜æˆäº†æ•°æ®åº“è‡ªå·±çš„æ—¥å¸¸å·¥ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ç®—é¢å¯¹å‡ åƒäººåŒæ—¶æ“ä½œçš„æç«¯æƒ…å†µï¼Œç³»ç»Ÿä¹Ÿèƒ½ååº”é£å¿«ã€‚</p>
</li>
<li>
<p><strong>é‡‘èçº§é«˜å¯ç”¨ä¿éšœ</strong>ï¼šæ–°èƒ½æºä¸šåŠ¡å¯æ˜¯ä¸€å¤©24å°æ—¶ã€ä¸€å¹´365å¤©éƒ½ä¸èƒ½åœçš„ã€‚ä¸ºäº†ç¡®ä¿ä¸‡æ— ä¸€å¤±ï¼ŒKingbaseESæ‹¿å‡ºäº†ä¸€å¥—é‡‘èçº§åˆ«çš„â€œä¸æ­»é¸Ÿâ€æ–¹æ¡ˆã€‚å®ƒæ”¯æŒâ€œä¸€ä¸»å¤šå¤‡â€çš„é›†ç¾¤æ¨¡å¼ï¼Œä¸»æœåŠ¡å™¨çš„æ•°æ®èƒ½å®æ—¶åŒæ­¥åˆ°å¤‡ç”¨æœåŠ¡å™¨ä¸Šï¼Œä¸‡ä¸€ä¸»æœåŠ¡å™¨â€œç½¢å·¥â€ï¼Œå¤‡ç”¨æœåŠ¡å™¨èƒ½ç§’çº§é¡¶ä¸Šï¼Œæ•°æ®ä¸€ä¸ªéƒ½ä¸ä¼šä¸¢ã€‚å®ƒç”šè‡³è¿˜èƒ½æå®šè·¨è¶Šä¸Šåƒå…¬é‡Œçš„å¼‚åœ°å®¹ç¾ï¼ŒçœŸæ­£åšåˆ°é«˜æ•æ— å¿§ã€‚</p>
</li>
<li>
<p><strong>å…¨æ–¹ä½æ•°æ®å®‰å…¨</strong>ï¼šæ•°æ®å®‰å…¨æ˜¯å‘½è„‰ã€‚KingbaseESå°±åƒç»™æ•°æ®ç©¿ä¸Šäº†ä¸€å±‚å±‚â€œé‡‘é’Ÿç½©é“å¸ƒè¡«â€ï¼Œä»è®¿é—®æ§åˆ¶ã€æ•°æ®åŠ å¯†åˆ°å®‰å…¨å®¡è®¡ï¼Œé˜²æŠ¤æªæ–½ä¸€åº”ä¿±å…¨ï¼Œè¾¾åˆ°äº†å›½å®¶ä¿¡æ¯ç³»ç»Ÿå®‰å…¨ç­‰çº§ä¿æŠ¤çš„å››çº§è¦æ±‚ã€‚æŠŠæ ¸å¿ƒç”Ÿäº§æ•°æ®äº¤ç»™å®ƒï¼Œå¿ƒé‡Œè¸å®ã€‚</p>
</li>
<li>
<p><strong>é«˜åº¦å…¼å®¹ä¸å¹³æ»‘è¿ç§»</strong>ï¼šå¾ˆå¤šä¼ä¸šæœ€å¤´ç–¼çš„å°±æ˜¯æ¢ç³»ç»Ÿï¼Œæ€•åŸæ¥çš„åº”ç”¨è·‘ä¸èµ·æ¥ã€‚KingbaseESæ—©å°±æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œå®ƒå¯¹Oracleçš„è¯­æ³•å…¼å®¹æ€§åšå¾—éå¸¸å¥½ï¼Œè¿˜é…äº†ä¸ªå«KDTSçš„â€œæ¬å®¶ç¥å™¨â€ã€‚è¿™ä¸ªå·¥å…·èƒ½æŠŠåŸæ¥è·‘åœ¨MySQLã€PostgreSQLç”šè‡³MongoDBä¸Šçš„æ•°æ®å’Œåº”ç”¨ï¼Œä»¥æä½çš„æˆæœ¬ã€ç”šè‡³â€œé›¶ä»£ç ä¿®æ”¹â€çš„ä»£ä»·ï¼Œå¿«é€Ÿè¿ç§»è¿‡æ¥ï¼Œè®©å›½äº§åŒ–æ›¿ä»£ä¸å†æ˜¯ä»¶æ„äººçš„äº‹ã€‚</p>
</li>
</ul>
<p>æ­£æ˜¯é ç€è¿™äº›ç¡¬æ ¸å®åŠ›ï¼Œé‡‘ä»“æ•°æ®åº“æ‰æˆäº†ä¼—å¤šå…³é”®è¡Œä¸šæ ¸å¿ƒç³»ç»Ÿçš„æ”¾å¿ƒä¹‹é€‰ã€‚</p>
<hr/>
<h2 data-id="heading-2">é‡‘ä»“æ•°æ®åº“åœ¨æ–°èƒ½æºè¡Œä¸šçš„æŠ€æœ¯è§£è¯»</h2>
<p>å’±ä»¬å†å¾€æ·±äº†èŠèŠï¼Œé‡‘ä»“æ•°æ®åº“åœ¨æ–°èƒ½æºè¡Œä¸šé‡Œï¼Œåˆ°åº•æ˜¯æ€ä¹ˆâ€œç§€è‚Œè‚‰â€çš„ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæ–°èƒ½æºçš„æ•°å­—åŒ–ç³»ç»Ÿï¼Œæ¯”å¦‚é›†æ§ä¸­å¿ƒã€è¿ç»´å¹³å°ï¼Œæœ‰å››ä¸ªâ€œè€å¤§éš¾â€é—®é¢˜ï¼šæ—¶åºæ•°æ®å¤šåˆ°çˆ†ç‚¸ã€é«˜å¹¶å‘è®¿é—®å‹åŠ›å±±å¤§ã€ä¸šåŠ¡ä¸€ç§’éƒ½ä¸èƒ½åœã€è€æ—§ç³»ç»Ÿäº”èŠ±å…«é—¨ã€‚é¢å¯¹è¿™äº›ï¼ŒKingbaseESè§æ‹›æ‹†æ‹›ï¼Œç”¨è‡ªå·±çš„ä¸€å¥—ç»„åˆæ‹³ç»™å‡ºäº†æ¼‚äº®çš„ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-3">1. åº”å¯¹æµ·é‡æ—¶åºæ•°æ®ï¼šåˆ†åŒºå­˜å‚¨ä¸é«˜æ•ˆæŸ¥è¯¢</h3>
<p><strong>ä¸šåŠ¡æŒ‘æˆ˜</strong>ï¼šé£æœºã€å…‰ä¼æ¿è¿™äº›è®¾å¤‡ï¼Œä¸ªä¸ªéƒ½æ˜¯æ•°æ®â€œç”Ÿäº§å¤§æˆ·â€ï¼Œæ¯æ—¶æ¯åˆ»éƒ½åœ¨å¾€å¤–è¹¦å„ç§å·¥å†µæ•°æ®ã€‚è¿™äº›æ•°æ®æ˜¯å®è´ï¼Œæ˜¯è®¾å¤‡ç›‘æ§ã€æ•…éšœé¢„è­¦çš„åŸºç¡€ã€‚ä½†æ•°æ®é‡å®åœ¨å¤ªå¤§äº†ï¼Œæ€ä¹ˆå­˜ã€æ€ä¹ˆæŸ¥ï¼Œæ‰èƒ½åˆå¿«åˆå¥½ï¼Œæ˜¯ä¸ªå¤§éš¾é¢˜ã€‚</p>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆ</strong>ï¼šKingbaseESç”¨äº†ä¸€ä¸ªèªæ˜çš„åŠæ³•â€”â€”<strong>è¡¨åˆ†åŒº</strong>ã€‚å®ƒæŠŠä¸€å¼ å·¨å¤§çš„æ•°æ®è¡¨ï¼ŒæŒ‰æ—¶é—´ï¼ˆæ¯”å¦‚æŒ‰å¤©æˆ–æŒ‰æœˆï¼‰åˆ‡æˆä¸€å°å—ä¸€å°å—ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼š</p>
<ul>
<li><strong>å†™å…¥æŸ¥è¯¢éƒ½é£å¿«</strong>ï¼šæ–°æ•°æ®åªå¾€æœ€æ–°çš„é‚£ä¸€å°å—é‡Œå†™ï¼Œäº’ä¸å¹²æ‰°ã€‚æŸ¥è¯¢çš„æ—¶å€™ï¼Œåªè¦å‘Šè¯‰å®ƒæ—¶é—´èŒƒå›´ï¼Œå®ƒå°±èƒ½ç²¾å‡†åœ°æ‰¾åˆ°å¯¹åº”çš„é‚£å‡ å—æ•°æ®ï¼Œä¸ç”¨å†å¤§æµ·æé’ˆä¸€æ ·åœ°å…¨è¡¨æ‰«æã€‚</li>
<li><strong>ç®¡ç†æ•°æ®è¶…è½»æ¾</strong>ï¼šè¿‡æœŸçš„å†å²æ•°æ®æƒ³åˆ æ‰ï¼Ÿç®€å•ï¼ä»¥å‰ç”¨<code>DELETE</code>å¾—åˆ åŠå¤©ï¼Œè¿˜ç•™ä¸‹ä¸€å †â€œåƒåœ¾â€ã€‚ç°åœ¨ç›´æ¥æŠŠå¯¹åº”çš„æ—§åˆ†åŒºæ•´ä¸ªç«¯æ‰å°±è¡Œï¼Œç§’é€Ÿå®Œæˆï¼Œå¹²å‡€åˆ©è½ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼šåˆ›å»ºæŒ‰æœˆåˆ†åŒºçš„è®¾å¤‡æ•°æ®è¡¨</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºä¸€ä¸ªæŒ‰æœˆåˆ†åŒºçš„è®¾å¤‡æ•°æ®ä¸»è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> device_metrics (
    device_id   <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    metric_time <span class="hljs-type">TIMESTAMP</span>   <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    metric_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    <span class="hljs-keyword">value</span>       <span class="hljs-type">NUMERIC</span>(<span class="hljs-number">18</span>, <span class="hljs-number">6</span>)
) <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">RANGE</span> (metric_time);

<span class="hljs-comment">-- ä¸º2025å¹´11æœˆå’Œ12æœˆåˆ›å»ºåˆ†åŒº</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> device_metrics_202511 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> device_metrics
    <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2025-11-01'</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2025-12-01'</span>);

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> device_metrics_202512 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> device_metrics
    <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2025-12-01'</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2026-01-01'</span>);

<span class="hljs-comment">-- å½“æŸ¥è¯¢ç‰¹å®šæ—¶é—´èŒƒå›´çš„æ•°æ®æ—¶ï¼Œä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„åˆ†åŒº</span>
<span class="hljs-comment">-- ä¾‹å¦‚ï¼Œæ­¤æŸ¥è¯¢å°†ä»…æ‰«æ device_metrics_202511 åˆ†åŒº</span>
<span class="hljs-keyword">SELECT</span> device_id, <span class="hljs-keyword">value</span>
<span class="hljs-keyword">FROM</span> device_metrics
<span class="hljs-keyword">WHERE</span> metric_time <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-11-10'</span> <span class="hljs-keyword">AND</span> metric_time <span class="hljs-operator">&lt;</span> <span class="hljs-string">'2025-11-11'</span>;
</code></pre>
<h3 data-id="heading-4">2. æ”¯æ’‘é«˜å¹¶å‘è®¿é—®ï¼šè¯»å†™åˆ†ç¦»ä¸è‡ªæ²»è°ƒä¼˜</h3>
<p><strong>ä¸šåŠ¡æŒ‘æˆ˜</strong>ï¼šä¸€ä¸ªç”Ÿäº§è¿ç»´ç³»ç»Ÿï¼Œå¯èƒ½åŒæ—¶æœ‰å‡ åƒå·äººåœ¨çº¿æ“ä½œï¼Œæœ‰æŸ¥æŠ¥è¡¨çš„ï¼Œæœ‰å¼€å·¥å•çš„ï¼Œæœ‰åšæ£€ä¿®çš„ã€‚è¿™ä¹ˆå¤šè¯·æ±‚ä¸€è‚¡è„‘å„¿åœ°æ¶Œè¿‡æ¥ï¼Œæ•°æ®åº“è¦æ˜¯æ‰›ä¸ä½ï¼Œæ•´ä¸ªç³»ç»Ÿå°±å¾—å¡é¡¿ç”šè‡³ç˜«ç—ªã€‚</p>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆ</strong>ï¼šKingbaseESæœ‰ä¸¤å¤§æ³•å®æ¥åº”å¯¹ï¼š<strong>è¯»å†™åˆ†ç¦»é›†ç¾¤</strong>å’Œ<strong>å†…æ ¸è‡ªæ²»è°ƒä¼˜</strong>ã€‚</p>
<ul>
<li>
<p><strong>è¯»å†™åˆ†ç¦»é›†ç¾¤æ¶æ„</strong>ï¼šè¿™ä¸ªæˆ˜æœ¯å¾ˆç®€å•ï¼Œå°±æ˜¯â€œåˆ†å·¥åˆä½œâ€ã€‚æä¸€ä¸ªâ€œä¸€ä¸»å¤šå¤‡â€çš„é›†ç¾¤ï¼Œä¸»èŠ‚ç‚¹æ˜¯â€œæ€»æŒ‡æŒ¥â€ï¼Œä¸“é—¨å¤„ç†â€œå†™â€è¿™ç§å…³é”®æ“ä½œã€‚å…¶ä»–å‡ ä¸ªå¤‡èŠ‚ç‚¹å½“â€œå‚è°‹â€ï¼Œä»ä¸»èŠ‚ç‚¹é‚£å„¿åŒæ­¥æ•°æ®ï¼Œç„¶åä¸“é—¨è´Ÿè´£â€œè¯»â€è¿™ç§æŸ¥è¯¢ã€çœ‹æŠ¥è¡¨çš„å·¥ä½œã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±æŠŠå‹åŠ›åˆ†æ•£å‡ºå»äº†ï¼Œå¤§å®¶éƒ½èƒ½è½»æ¾ä¸Šé˜µã€‚</p>
<pre><code class="hljs language-scss" lang="scss">+----------------+      /---&gt; <span class="hljs-selector-attr">[å¤‡èŠ‚ç‚¹1 (åªè¯»)]</span>
|   åº”ç”¨æœåŠ¡     |     /
| (è¯»å†™è¯·æ±‚)     |---&gt; <span class="hljs-selector-attr">[ä¸»èŠ‚ç‚¹ (è¯»å†™)]</span> ---&gt; <span class="hljs-selector-attr">[å¤‡èŠ‚ç‚¹2 (åªè¯»)]</span>
+----------------+     \
                        \---&gt; <span class="hljs-selector-attr">[å¤‡èŠ‚ç‚¹3 (åªè¯»)]</span>
                                 |
                                 V
                            <span class="hljs-selector-attr">[ç‰©ç†æ—¥å¿—æµåŒæ­¥]</span>
</code></pre>
</li>
<li>
<p><strong>è‡ªæ²»è°ƒä¼˜èƒ½åŠ›</strong>ï¼šè¿™å°±æ˜¯å‰é¢æåˆ°çš„â€œè°ƒä¼˜æœºå™¨äººâ€ã€‚å®ƒèƒ½è‡ªåŠ¨ä¼˜åŒ–SQLï¼Œè¿˜èƒ½æ ¹æ®å†å²ç»éªŒâ€œå­¦ä¹ â€è¿›åŒ–ï¼Œè®©æ‰§è¡Œè®¡åˆ’è¶Šæ¥è¶Šèªæ˜ã€‚ç”šè‡³åœ¨ä½ å†™çš„SQLæ€§èƒ½ä¸ä½³æ—¶ï¼Œå®ƒè¿˜ä¼šä¸»åŠ¨ç»™ä½ æå»ºè®®ï¼Œæ¯”å¦‚â€œè¿™é‡Œè¯¥å»ºä¸ªç´¢å¼•äº†â€ï¼Œå¤§å¤§å‡è½»äº†æ•°æ®åº“ç®¡ç†å‘˜çš„è´Ÿæ‹…ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">3. ä¿éšœä¸šåŠ¡è¿ç»­æ€§ï¼šè·¨åœ°åŸŸé«˜å¯ç”¨ä¸å®¹ç¾</h3>
<p><strong>ä¸šåŠ¡æŒ‘æˆ˜</strong>ï¼šæ ¸å¿ƒç”Ÿäº§ç³»ç»Ÿï¼Œå°±è·Ÿäººçš„å¿ƒè„ä¸€æ ·ï¼Œä¸€ç§’é’Ÿéƒ½ä¸èƒ½åœã€‚ä¸ä»…è¦é˜²æ­¢æœ¬åœ°å‡ºæ•…éšœï¼Œè¿˜å¾—èƒ½æ‰›å¾—ä½åœ°éœ‡ã€æ–­ç”µè¿™ç§åŒºåŸŸæ€§çš„å¤©ç¾äººç¥¸ã€‚</p>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆ</strong>ï¼šKingbaseESæä¾›çš„æ˜¯ä¸€å¥—ç»è¿‡å®æˆ˜æ£€éªŒçš„â€œä¸¤åœ°ä¸‰ä¸­å¿ƒâ€æˆ–â€œå¼‚åœ°åŒä¸­å¿ƒâ€é«˜å¯ç”¨æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>åœ¨ç”Ÿäº§ä¸­å¿ƒ</strong>ï¼šéƒ¨ç½²ä¸€ä¸ªâ€œä¸€ä¸»ä¸¤å¤‡â€çš„æœ¬åœ°é«˜å¯ç”¨é›†ç¾¤ã€‚ä¸»å¤‡ä¹‹é—´çš„æ•°æ®å®æ—¶åŒæ­¥ã€‚ä¸‡ä¸€ä¸»èŠ‚ç‚¹â€œç‰ºç‰²â€ï¼Œç³»ç»Ÿå‡ ç§’å†…å°±èƒ½è‡ªåŠ¨æŠŠå¤‡ç”¨èŠ‚ç‚¹æ‰¶æ­£ï¼Œä¸šåŠ¡å‡ ä¹æ„Ÿè§‰ä¸åˆ°ä¸­æ–­ï¼Œæ•°æ®ä¹Ÿé›¶ä¸¢å¤±ã€‚</p>
</li>
<li>
<p><strong>åœ¨å¼‚åœ°ç¾å¤‡ä¸­å¿ƒ</strong>ï¼šåœ¨å‡ ç™¾ç”šè‡³ä¸Šåƒå…¬é‡Œå¤–çš„å¦ä¸€ä¸ªåŸå¸‚ï¼Œå†éƒ¨ç½²ä¸€ä¸ªç¾å¤‡èŠ‚ç‚¹ã€‚ç”Ÿäº§ä¸­å¿ƒçš„æ•°æ®ä¼šå‡†å®æ—¶åœ°å¤åˆ¶è¿‡å»ã€‚è¿™æ ·ï¼Œå°±ç®—æ•´ä¸ªç”Ÿäº§ä¸­å¿ƒéƒ½â€œæ²¦é™·â€äº†ï¼Œè¿˜èƒ½ä»å®¹åœ°æŠŠä¸šåŠ¡åˆ‡æ¢åˆ°ç¾å¤‡ä¸­å¿ƒï¼Œä¿ä½æœ€åçš„ç«ç§ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">+---------------------------+      <span class="hljs-selector-attr">[å¹¿åŸŸç½‘ (WAN)]</span>      +---------------------------+
|      ç”Ÿäº§ä¸­å¿ƒ (åŸå¸‚A)     |                          |      ç¾å¤‡ä¸­å¿ƒ (åŸå¸‚B)     |
|                           |                          |                           |
|  <span class="hljs-selector-attr">[ä¸»]</span> ---&gt; <span class="hljs-selector-attr">[å¤‡1]</span> ---&gt; <span class="hljs-selector-attr">[å¤‡2]</span> | <span class="hljs-built_in">--</span>(å¼‚æ­¥ç‰©ç†æ—¥å¿—å¤åˆ¶)--&gt; |           <span class="hljs-selector-attr">[å¤‡3]</span>           |
|  (åŒæ­¥/å¼‚æ­¥ç‰©ç†æ—¥å¿—å¤åˆ¶)  |                          |                           |
+---------------------------+                          +---------------------------+
</code></pre>
</li>
</ul>
<h3 data-id="heading-6">4. å®ç°å¹³æ»‘è¿ç§»ï¼šé«˜åº¦å…¼å®¹ä¸è‡ªåŠ¨åŒ–å·¥å…·</h3>
<p><strong>ä¸šåŠ¡æŒ‘æˆ˜</strong>ï¼šå¾ˆå¤šæ–°èƒ½æºä¼ä¸šä¸€è·¯å‘å±•è¿‡æ¥ï¼Œç³»ç»Ÿé‡Œç”¨äº†MySQLã€Oracleã€PostgreSQLç­‰å„ç§æ•°æ®åº“ï¼Œäº”èŠ±å…«é—¨ï¼Œå½¢æˆäº†â€œæ•°æ®å­¤å²›â€ã€‚ç°åœ¨æƒ³å»ºä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ï¼ŒæŠŠè¿™äº›è€ç³»ç»Ÿé‡Œçš„å®è´æ•°æ®å’Œåº”ç”¨éƒ½æ¬è¿‡æ¥ï¼Œç®€ç›´æ˜¯æµ©å¤§åˆå¤´ç–¼çš„å·¥ç¨‹ã€‚</p>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆ</strong>ï¼šKingbaseESåœ¨è®¾è®¡ä¹‹åˆå°±æƒ³åˆ°äº†è¿™ä¸€ç‚¹ã€‚</p>
<ul>
<li>
<p><strong>å®ƒé«˜åº¦å…¼å®¹Oracle</strong>ï¼šä»è¯­æ³•ã€æ•°æ®ç±»å‹åˆ°å­˜å‚¨è¿‡ç¨‹ï¼Œéƒ½è·ŸOracleå¾ˆåƒã€‚è¿™æ„å‘³ç€ï¼ŒåŸæ¥ç»™Oracleå†™çš„åº”ç”¨ï¼ŒåŸºæœ¬ä¸Šä¸ç”¨æ€ä¹ˆæ”¹ï¼Œç”šè‡³ä¸ç”¨æ”¹ï¼Œå°±èƒ½ç›´æ¥åœ¨KingbaseESä¸Šè·‘èµ·æ¥ã€‚</p>
</li>
<li>
<p><strong>å®ƒæœ‰è‡ªåŠ¨åŒ–â€œæ¬å®¶â€å·¥å…·KDTS</strong>ï¼šè¿™ä¸ªå·¥å…·éå¸¸å¼ºå¤§ï¼Œèƒ½è‡ªåŠ¨æå®šæ•°æ®ç»“æ„æ˜ å°„ã€æ•°æ®è¿ç§»ã€æ•°æ®æ ¡éªŒè¿™äº›ç¹ççš„æ´»å„¿ã€‚åŸæ¥å¯èƒ½è¦èŠ±å‡ ä¸ªæ˜ŸæœŸæ‰èƒ½å¹²å®Œçš„è¿ç§»å·¥ä½œï¼Œç°åœ¨å‡ å¤©ç”šè‡³æ›´çŸ­æ—¶é—´å°±èƒ½æå®šï¼Œé£é™©å’Œæˆæœ¬éƒ½å¤§å¤§é™ä½ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-7">æ¡ˆä¾‹åˆ†æï¼šé‡‘ä»“æ•°æ®åº“èµ‹èƒ½æ–°èƒ½æºæ™ºæ…§è¿ç»´</h2>
<p>â€œå…‰è¯´ä¸ç»ƒå‡æŠŠå¼â€ã€‚ç†è®ºè¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é‡‘ä»“æ•°æ®åº“åœ¨çœŸå®æˆ˜åœºä¸Šçš„è¡¨ç°åˆ°åº•æ€ä¹ˆæ ·ã€‚å…¶å®ï¼Œå®ƒæ—©å°±åœ¨å›½å®¶èƒ½æºé›†å›¢ã€ä¸­å›½å¹¿æ ¸é›†å›¢ã€å›½å®¶ç”µåŠ›æŠ•èµ„é›†å›¢ç­‰å¤šä¸ªå¤§å‹èƒ½æºä¼ä¸šçš„æ ¸å¿ƒç³»ç»Ÿä¸­â€œèº«ç»ç™¾æˆ˜â€äº†ã€‚ä¸‹é¢è¿™å‡ ä¸ªæ¡ˆä¾‹ï¼Œå°±å¾ˆæœ‰ä»£è¡¨æ€§ã€‚</p>
<h3 data-id="heading-8">æ¡ˆä¾‹ä¸€ï¼šä¸­å¹¿æ ¸æ–°èƒ½æºç”Ÿäº§è¿ç»´ç³»ç»Ÿâ€”â€”åº”å¯¹â€œæ•´åˆã€é«˜å¹¶å‘ã€é«˜å¯ç”¨â€ä¸‰å¤§æŒ‘æˆ˜</h3>
<ul>
<li>
<p><strong>ä¸šåŠ¡èƒŒæ™¯</strong>ï¼šä¸­å¹¿æ ¸çš„æ–°èƒ½æºä¸šåŠ¡æ‘Šå­é“ºå¾—å¾ˆå¤§ï¼Œé£ã€å…‰ã€æ°´å¤šç‚¹å¼€èŠ±ï¼Œç®¡ç€600å¤šä¸ªåœºç«™ã€‚ä½†ä»¥å‰çš„ç”Ÿäº§ç³»ç»Ÿéƒ½æ˜¯å„æå„çš„ï¼ŒæŠ€æœ¯äº”èŠ±å…«é—¨ï¼Œæ•°æ®ä¸é€šï¼Œç®¡ç†èµ·æ¥å¾ˆè´¹åŠ²ã€‚æ‰€ä»¥ï¼Œä»–ä»¬ä¸‹å†³å¿ƒè¦æä¸€ä¸ªç»Ÿä¸€çš„ç”Ÿäº§è¿ç»´ç³»ç»Ÿã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜</strong>ï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿæ•´åˆéš¾</strong>ï¼šè¦æŠŠåŸæ¥åŸºäºMySQLã€PostgreSQLã€MongoDBç­‰å„ç§æ•°æ®åº“çš„åº”ç”¨å’Œæ•°æ®éƒ½ç»Ÿä¸€èµ·æ¥ï¼Œè¿™æ´»å„¿æƒ³æƒ³å°±å¤´å¤§ã€‚</li>
<li><strong>å¹¶å‘è®¿é—®é«˜</strong>ï¼šæ–°ç³»ç»Ÿä¸Šçº¿ï¼Œå¾—æ’‘ä½6000å¤šå·å‘˜å·¥åŒæ—¶åœ¨çº¿æ“ä½œï¼Œè¿˜è¦æ±‚ååº”é€Ÿåº¦è¦å¿«ã€‚</li>
<li><strong>å¯ç”¨æ€§è¦æ±‚æè‡´</strong>ï¼šè¿™å¯æ˜¯æ ¸å¿ƒç”Ÿäº§ç³»ç»Ÿï¼Œå¿…é¡»åšåˆ°é‡‘èçº§çš„99.999%å¯ç”¨æ€§ï¼Œè¿˜å¾—èƒ½è·¨ä¸Šåƒå…¬é‡Œæå¼‚åœ°å®¹ç¾ã€‚</li>
</ol>
</li>
<li>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆä¸æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li><strong>å¹³æ»‘è¿ç§»ï¼Œé›¶ä»£ç ä¿®æ”¹</strong>ï¼šé‡‘ä»“çš„å›¢é˜Ÿå¸¦ç€â€œæ¬å®¶ç¥å™¨â€KDTSä¸€è¿›åœºï¼Œå¾ˆå¿«å°±æŠŠå„ä¸ªâ€œå±±å¤´â€çš„æ•°æ®å’Œåº”ç”¨éƒ½æ”¶ç¼–äº†è¿‡æ¥ï¼Œè½¯ä»¶å¼€å‘å•†çš„åº”ç”¨ç”šè‡³åšåˆ°äº†â€œé›¶ä»£ç ä¿®æ”¹â€ï¼Œä¸€ä¸‹å­å°±è®©å¤§å®¶æ‚¬ç€çš„å¿ƒæ”¾ä¸‹äº†ã€‚</li>
<li><strong>è‡ªæ²»è°ƒä¼˜ï¼Œæ€§èƒ½å“è¶Š</strong>ï¼šé¢å¯¹6000äººå¹¶å‘çš„å‹åŠ›æµ‹è¯•ï¼ŒKingbaseESçš„â€œè°ƒä¼˜æœºå™¨äººâ€å¤§æ˜¾èº«æ‰‹ï¼ŒåªèŠ±äº†3å¤©å°±å®Œæˆäº†æ€§èƒ½ä¼˜åŒ–ï¼Œè®©ç³»ç»Ÿåœ¨é«˜å‹ä¸‹ä¹Ÿèƒ½ç§’çº§å“åº”ã€‚</li>
<li><strong>å¼‚åœ°åŒä¸­å¿ƒï¼Œç¨³å®šå¯é </strong>ï¼šé€šè¿‡éƒ¨ç½²â€œç”Ÿäº§ä¸­å¿ƒ+ç¾å¤‡ä¸­å¿ƒâ€çš„æ¶æ„ï¼ŒKingbaseESç»™ç³»ç»Ÿä¸Šäº†åŒä¿é™©ï¼Œç¡®ä¿äº†7x24å°æ—¶çš„ç¨³å®šè¿è¡Œã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e691206c448246ff96d772447f3d78d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490954&amp;x-signature=%2FDpJ%2F8Q9yE1Ic0S9%2B1z26PEB0xM%3D" alt="image.png" loading="lazy"/></li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">æ¡ˆä¾‹äºŒï¼šå›½å®¶èƒ½æºé›†å›¢é¾™æºç”µåŠ›â€”â€”186ä¸ªæ–°èƒ½æºåœºç«™é›†æ§ç³»ç»Ÿå›½äº§åŒ–æ›¿ä»£</h3>
<ul>
<li>
<p><strong>ä¸šåŠ¡èƒŒæ™¯</strong>ï¼šé¾™æºç”µåŠ›æ˜¯å…¨çƒæœ€å¤§çš„é£ç”µè¿è¥å•†ï¼Œä»–ä»¬è¦åœ¨å…¨å›½27ä¸ªçœåŒºçš„186ä¸ªåœºç«™æä¸€å¥—æ–°çš„é›†æ§ç³»ç»Ÿï¼ŒæŠŠæ•°æ®éƒ½ç»Ÿä¸€ç®¡èµ·æ¥ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜</strong>ï¼š</p>
<ol>
<li><strong>éƒ¨ç½²èŒƒå›´å¹¿</strong>ï¼šé¡¹ç›®éå¸ƒå¤§æ±Ÿå—åŒ—ï¼Œå¯¹éƒ¨ç½²ã€è¿ç»´å’Œæœ¬åœ°åŒ–æœåŠ¡çš„å“åº”èƒ½åŠ›æ˜¯ä¸ªå·¨å¤§è€ƒéªŒã€‚</li>
<li><strong>æ ¸å¿ƒç³»ç»Ÿå¯é æ€§</strong>ï¼šåœºç«™çš„é›†æ§æ ¸å¿ƒç³»ç»Ÿç»å¯¹ä¸èƒ½å‡ºé—®é¢˜ï¼ŒåŸæ¥ç”¨çš„Oracleè™½ç„¶ç¨³ï¼Œä½†ç»´ä¿æˆæœ¬é«˜ï¼Œè¿˜æœ‰â€œå¡è„–å­â€çš„é£é™©ã€‚</li>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼šè¿™äº›å¯éƒ½æ˜¯æ ¸å¿ƒç”Ÿäº§æ•°æ®ï¼Œå®‰å…¨ç­‰çº§è¦æ±‚éå¸¸é«˜ã€‚</li>
</ol>
</li>
<li>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆä¸æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li><strong>ä¸»å¤‡é«˜å¯ç”¨ï¼Œä¿éšœä¸šåŠ¡è¿ç»­</strong>ï¼šæ¯ä¸ªåœºç«™éƒ½ç”¨KingbaseESæäº†â€œåŒæœºä¸»å¤‡â€æ¶æ„ï¼ŒæˆåŠŸæ¢æ‰äº†Oracleï¼Œæ—¢ä¿è¯äº†ä¸šåŠ¡ä¸ä¸­æ–­ï¼Œä¹Ÿåšå¥½äº†æ•°æ®å¤‡ä»½ã€‚</li>
<li><strong>é«˜åº¦å…¼å®¹Oracleï¼Œå¿«é€Ÿè¿ç§»</strong>ï¼šå› ä¸ºKingbaseESå’ŒOracleå¾ˆâ€œåƒâ€ï¼Œæ•´ä¸ªæ›¿æ¢è¿‡ç¨‹éå¸¸é¡ºæ»‘ï¼Œåº”ç”¨åŸºæœ¬æ²¡æ€ä¹ˆæ”¹ã€‚</li>
<li><strong>å…¨å›½æœåŠ¡ç½‘ç»œï¼Œæœ¬åœ°åŒ–æ”¯æŒ</strong>ï¼šé‡‘ä»“éå¸ƒå…¨å›½çš„æœåŠ¡ç½‘ç»œå‘æŒ¥äº†å·¨å¤§ä½œç”¨ï¼Œä¸º27ä¸ªçœåŒºçš„é¡¹ç›®æä¾›äº†7x24å°æ—¶çš„æœ¬åœ°æ”¯æŒï¼Œç¡®ä¿äº†é¡¹ç›®é¡ºåˆ©è½åœ°ã€‚</li>
<li><strong>å®‰å…¨åˆè§„</strong>ï¼šKingbaseESè‡ªå¸¦çš„å„ç§å®‰å…¨åŠŸèƒ½ï¼Œå®Œå…¨æ»¡è¶³å›½å®¶å¯¹æ ¸å¿ƒæ•°æ®å®‰å…¨çš„è¦æ±‚ï¼Œè®©äººæ”¾å¿ƒã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a5ff48045c54bd981adffc1e19a548d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490954&amp;x-signature=TVeoY%2Bwwk64gHOKu8IGRBTTgL5E%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-10">æ¡ˆä¾‹ä¸‰ï¼šå›½å®¶ç”µæŠ•é›†å›¢ç”˜è‚ƒæ–°èƒ½æºâ€”â€”â€œæ— äººå€¼å®ˆâ€é£ç”µåœºé›†æ§ç³»ç»Ÿ</h3>
<ul>
<li>
<p><strong>ä¸šåŠ¡èƒŒæ™¯</strong>ï¼šä¸ºäº†åœ¨åè¿œåœ°åŒºå®ç°é£ç”µåœºâ€œæ— äººå€¼ç­ã€å°‘äººå€¼å®ˆâ€çš„æ™ºæ…§è¿ç»´ï¼Œå›½å®¶ç”µæŠ•ç”˜è‚ƒæ–°èƒ½æºå…¬å¸éœ€è¦ä¸€å¥—é«˜åº¦è‡ªåŠ¨åŒ–çš„é›†æ§ç³»ç»Ÿã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼šâ€œæ— äººå€¼å®ˆâ€æ¨¡å¼ä¸‹ï¼Œæ•°æ®ç»å¯¹ä¸èƒ½å‡ºé”™ï¼Œå¦åˆ™ä¸€ä¸ªé”™è¯¯çš„æŒ‡ä»¤å°±å¯èƒ½é€ æˆå·¨å¤§æŸå¤±ã€‚</li>
<li><strong>ä¸šåŠ¡è¿ç»­æ€§</strong>ï¼šè‡ªåŠ¨åŒ–è°ƒåº¦ç³»ç»Ÿå¿…é¡»åƒæ°¸åŠ¨æœºä¸€æ ·ä¸åœè¿è½¬ã€‚</li>
</ul>
</li>
<li>
<p><strong>é‡‘ä»“è§£å†³æ–¹æ¡ˆä¸æˆæ•ˆ</strong>ï¼š</p>
<ul>
<li><strong>é«˜å¯ç”¨æ¶æ„ï¼Œæ›¿ä»£Oracle</strong>ï¼šåŒæ ·ï¼ŒKingbaseESçš„é«˜å¯ç”¨æ–¹æ¡ˆæˆåŠŸæ›¿ä»£äº†Oracleï¼Œæ—¢ä¿è¯äº†ç³»ç»Ÿå†—ä½™ï¼Œä¹Ÿç¡®ä¿äº†æ•°æ®å®‰å…¨å¯é ã€‚</li>
<li><strong>åŸå‚æœ¬åœ°åŒ–æœåŠ¡</strong>ï¼šé‡‘ä»“çš„è¿ç»´å›¢é˜Ÿæä¾›äº†â€œç§’çº§å“åº”â€çš„æœ¬åœ°æœåŠ¡ï¼Œæˆäº†ç³»ç»Ÿç¨³å®šè¿è¡Œçš„åšå®åç›¾ï¼Œä¹Ÿä¸ºåç»­æ›´å¤§èŒƒå›´çš„å›½äº§åŒ–é“ºå¹³äº†é“è·¯ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-11">ç»“è¯­</h2>
<p>å†™åˆ°æœ€åï¼Œå°±ä¼šå¯Ÿè§‰ï¼Œåœ¨å½¢æˆæ–°å‹ç”µåŠ›ç³»ç»Ÿè¿™ä¸€æ—¶ä»£æ´ªæµå½“ä¸­ï¼Œæ•°å­—åŒ–å’Œæ™ºèƒ½åŒ–æ˜¯æä¸ºå…³é”®çš„â€œèˆ¹â€ä¸â€œæ¡¨â€ã€‚</p>
<p>å›é¡¾é‡‘ä»“æ•°æ®åº“çš„æŠ€æœ¯è¦ç‚¹åŠå…¶åœ¨æ–°èƒ½æºé¢†åŸŸçš„å®é™…åº”ç”¨æƒ…å†µï¼Œä¸è®ºæ˜¯è§£å†³å¤æ‚çš„å¼‚æ„æ•°æ®è¿ç§»é—®é¢˜ï¼Œæ‰¿å—å¤§é‡çš„å¹¶å‘è®¿é—®å‹åŠ›ï¼Œè¿˜æ˜¯ä¿éšœâ€œæ— äººå€¼å®ˆâ€é£ç”µåœºçš„ç¨³å®šè¿è¡Œï¼Œè¯¥æ•°æ®åº“å‡è¡¨ç°å‡ºè‰²ï¼Œè¿™è¡¨æ˜å…¶ä½œä¸ºå›½äº§æ•°æ®åº“çš„é¢†å…ˆè€…ï¼Œå…·å¤‡æˆä¸ºæ–°èƒ½æºè¡Œä¸šæ ¸å¿ƒä¸šåŠ¡ç¨³å›ºæ ¹åŸºçš„èƒ½åŠ›ä¸å®åŠ›ã€‚</p>
<p>æœªæ¥çš„æ–°èƒ½æºä¸–ç•Œå¿…å®šä¼šæ„ˆåŠ é‡è§†æ•°æ®ï¼Œé‡‘ä»“æ•°æ®åº“è¿™èˆ¬æ—¢ç²¾é€šæŠ€æœ¯åˆäº†è§£è¡Œä¸šçš„äººæ‰å°†ä¼šä¸€ç›´å‘æŒ¥å…³é”®ä½œç”¨ï¼Œå‡­å€Ÿå…¶ç¨³å®šï¼Œå¯é ä¸”é«˜æ•ˆçš„æ•°æ®èƒ½åŠ›ä¸æ–­ç»™ä¸­å›½æ–°èƒ½æºäº‹ä¸šå¢æ·»æ´»åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§åœºé¢è¯•ä¹‹æœ€ç»ˆä¸€è‡´æ€§ä¸åˆ†å¸ƒå¼é”]]></title>    <link>https://juejin.cn/post/7575655132748300324</link>    <guid>https://juejin.cn/post/7575655132748300324</guid>    <pubDate>2025-11-23T08:23:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575655132748300324" data-draft-id="7575442779038777386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§åœºé¢è¯•ä¹‹æœ€ç»ˆä¸€è‡´æ€§ä¸åˆ†å¸ƒå¼é”"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-23T08:23:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="360_go_php"/> <meta itemprop="url" content="https://juejin.cn/user/2436173498956695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§åœºé¢è¯•ä¹‹æœ€ç»ˆä¸€è‡´æ€§ä¸åˆ†å¸ƒå¼é”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173498956695/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    360_go_php
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:23:56.000Z" title="Sun Nov 23 2025 08:23:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">1.åˆ†å¸ƒå¼ç›¸å…³ç†è®º(é‡ç‚¹)</h2>
<h3 data-id="heading-1">1.1 CAPå®šç†<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cfd7d997b8f4b9ba2281d931a5eafd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=AOupmtP2Us8lA%2BlAYx1Z2SX2ei0%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h3>
<p>CAPå®šç†ï¼Œä¹Ÿç§°ä¸ºå¸ƒé²å°”å®šç†ï¼Œæ˜¯åˆ†å¸ƒå¼è®¡ç®—é¢†åŸŸçš„ä¸€ä¸ªåŸºæœ¬åŸç†ï¼Œç”¨äºæè¿°åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡ä¸­çš„ä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼šä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰ä¹‹é—´çš„æƒè¡¡å…³ç³»ã€‚</p>
<p>CAPå®šç†è¡¨æ˜ï¼Œåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—ç³»ç»Ÿä¸­ï¼Œä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªè¦æ±‚ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­çš„ä¸¤ä¸ªã€‚å…·ä½“è€Œè¨€ï¼š</p>
<ol>
<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰æŒ‡çš„æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåœ¨åŒä¸€æ—¶é—´ç‚¹ä¸Šæ˜¯å¦å…·æœ‰ç›¸åŒçš„æ•°æ®å‰¯æœ¬ã€‚å¦‚æœç³»ç»Ÿåœ¨æ›´æ–°æ•°æ®åï¼Œæ‰€æœ‰èŠ‚ç‚¹ç«‹å³èƒ½å¤Ÿçœ‹åˆ°æœ€æ–°çš„æ•°æ®ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±æ˜¯å¼ºä¸€è‡´æ€§çš„ï¼›å¦‚æœç³»ç»Ÿåœ¨æ›´æ–°æ•°æ®åï¼Œä¸åŒèŠ‚ç‚¹çš„æ•°æ®åŒæ­¥å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿï¼Œé‚£ä¹ˆç³»ç»Ÿå°±æ˜¯å¼±ä¸€è‡´æ€§çš„ã€‚</li>
<li>å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰æŒ‡çš„æ˜¯ç³»ç»Ÿèƒ½å¤Ÿåœ¨æœ‰é™çš„æ—¶é—´å†…å¯¹å¤–æä¾›æœåŠ¡ï¼Œå³ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†è¯·æ±‚å¹¶è¿”å›åˆç†çš„å“åº”ã€‚å¯ç”¨æ€§è¦æ±‚ç³»ç»Ÿåœ¨é¢å¯¹æ•…éšœæˆ–å¼‚å¸¸æƒ…å†µæ—¶ï¼Œä»èƒ½å¤Ÿä¿æŒæ­£å¸¸çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚</li>
<li>åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰æŒ‡çš„æ˜¯ç³»ç»Ÿèƒ½å¤Ÿåœ¨é¢å¯¹ç½‘ç»œåˆ†åŒºï¼ˆèŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡æ•…éšœï¼‰æ—¶ï¼Œä»èƒ½å¤Ÿç»§ç»­è¿è¡Œï¼Œå¹¶ä¿æŒæ•°æ®ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç½‘ç»œåˆ†åŒºæ˜¯ä¸å¯é¿å…çš„ï¼Œå› æ­¤åˆ†åŒºå®¹é”™æ€§æ˜¯å¿…é¡»è€ƒè™‘çš„å› ç´ ã€‚</li>
</ol>
<p>æ ¹æ®CAPå®šç†ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡è€…éœ€è¦åœ¨ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ä¹‹é—´è¿›è¡Œæƒè¡¡å–èˆã€‚æ ¹æ®å®é™…éœ€æ±‚å’Œåº”ç”¨åœºæ™¯çš„ä¸åŒï¼Œå¯ä»¥é€‰æ‹©æ»¡è¶³ä¸åŒç¨‹åº¦çš„ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCAPå®šç†æ˜¯ä¸€ä¸ªç†è®ºä¸Šçš„åŸåˆ™ï¼Œå¹¶æ²¡æœ‰è¦æ±‚ç³»ç»Ÿåªèƒ½æ»¡è¶³å…¶ä¸­çš„ä¸¤ä¸ªè¦æ±‚ï¼Œå®é™…ç³»ç»Ÿå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚å’ŒæŠ€æœ¯æ‰‹æ®µåšå‡ºæ›´ç»†è‡´çš„æƒè¡¡å’Œè®¾è®¡ã€‚æ­¤å¤–ï¼ŒCAPå®šç†åªæè¿°äº†ä¸‰ä¸ªåŸºæœ¬è¦ç´ ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠæ€§èƒ½ã€æ€§ä»·æ¯”ç­‰å…¶ä»–æ–¹é¢çš„è€ƒè™‘ã€‚åœ¨å®é™…ç³»ç»Ÿè®¾è®¡ä¸­ï¼Œè¿˜éœ€è¦ç»“åˆå…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯å®ç°æ¥è¿›è¡Œç»¼åˆæƒè¡¡å’Œè®¾è®¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dc07eded0594004b4a98ee04af5e415~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=WirfF8OMb%2BemuUTCTBlYlX1dlwc%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<ul>
<li>CP æ¶æ„çš„ç³»ç»Ÿ:</li>
</ul>
<p>ï¼ˆ1ï¼‰<strong>Apache ZooKeeper</strong>ï¼šZooKeeperæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼Œæä¾›äº†é«˜å¯ç”¨ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§çš„ç‰¹æ€§ï¼Œç”¨äºæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>Consul</strong>æ˜¯ç”±HashiCorpå¼€å‘çš„æœåŠ¡å‘ç°å’Œé…ç½®å·¥å…·ï¼Œæä¾›äº†æœåŠ¡å‘ç°ã€å¥åº·æ£€æŸ¥ã€KVå­˜å‚¨å’Œå¤šæ•°æ®ä¸­å¿ƒçš„åŠŸèƒ½ã€‚</p>
<ul>
<li>APæ¶æ„çš„ç³»ç»Ÿï¼š</li>
</ul>
<p>ï¼ˆ1ï¼‰<strong>Redis</strong>ï¼šRedisæ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜æ•°æ®åº“ï¼Œå®ƒæä¾›äº†é«˜æ€§èƒ½çš„é”®å€¼å­˜å‚¨å’Œæ”¯æŒå¤åˆ¶ã€åˆ†åŒºå®¹é”™ç­‰ç‰¹æ€§ï¼Œå¼ºè°ƒäº†å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>Elasticsearch</strong>ï¼šElasticsearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œå…·æœ‰é«˜å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ï¼Œé€‚ç”¨äºæ„å»ºå®æ—¶æœç´¢å’Œåˆ†æç³»ç»Ÿã€‚</p>
<p>ï¼ˆ3ï¼‰<strong>Apache Kafka</strong>ï¼šKafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµå¤„ç†å¹³å°ï¼Œå…·æœ‰é«˜å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ï¼Œè¢«å¹¿æ³›ç”¨äºæ„å»ºå®æ—¶æ•°æ®ç®¡é“å’Œäº‹ä»¶æµå¤„ç†ç³»ç»Ÿã€‚</p>
<p>ï¼ˆ4ï¼‰<strong>Nacos</strong>ï¼š nacos æ˜¯ä¸€ä¸ªå¼€æºçš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚å®ƒæä¾›äº†æœåŠ¡æ³¨å†Œä¸å‘ç°ã€åŠ¨æ€é…ç½®ç®¡ç†ã€æœåŠ¡å¥åº·æ£€æŸ¥å’ŒåŠ¨æ€DNSç­‰åŠŸèƒ½ã€‚é»˜è®¤APï¼Œå¯æ‰‹åŠ¨æ”¹ä¸ºCP ã€‚</p>
<h3 data-id="heading-2">2.2 BASEç†è®º</h3>
<p>BASEç†è®ºæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡ä¸­çš„ä¸€ä¸ªåŸåˆ™ï¼Œç”¨äºæè¿°åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿½æ±‚å¯ç”¨æ€§å’Œæ€§èƒ½çš„ç­–ç•¥ã€‚BASEæ˜¯"Basically Available, Soft state, Eventually consistent"çš„ç¼©å†™ã€‚</p>
<ul>
<li><strong>Basically Available</strong>ï¼ˆåŸºæœ¬å¯ç”¨ï¼‰ï¼šç³»ç»Ÿåœ¨é¢å¯¹éƒ¨åˆ†æ•…éšœæˆ–å¼‚å¸¸æƒ…å†µæ—¶ï¼Œä»èƒ½å¤Ÿä¿æŒåŸºæœ¬çš„å¯ç”¨æ€§ï¼Œå³ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†è¯·æ±‚å¹¶è¿”å›åˆç†çš„å“åº”ã€‚åŸºæœ¬å¯ç”¨æ€§æ˜¯ç›¸å¯¹äºå®Œå…¨ä¸å¯ç”¨è€Œè¨€çš„ï¼Œç³»ç»Ÿå¯ä»¥é€šè¿‡<strong>é™çº§ã€é™æµ</strong>ç­‰æœºåˆ¶æ¥ä¿æŒåŸºæœ¬çš„å¯ç”¨æ€§ã€‚</li>
<li><strong>Soft state</strong>ï¼ˆè½¯çŠ¶æ€ï¼‰ï¼šç³»ç»Ÿä¸­çš„æ•°æ®çŠ¶æ€å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…æ˜¯ä¸å®Œå…¨ä¸€è‡´çš„ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºå­˜åœ¨ç½‘ç»œå»¶è¿Ÿã€èŠ‚ç‚¹æ•…éšœç­‰å› ç´ ï¼Œå„èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒæ­¥å¯èƒ½å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿã€‚è½¯çŠ¶æ€çš„ç‰¹ç‚¹æ˜¯æ•°æ®çŠ¶æ€å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…æ˜¯éƒ¨åˆ†ä¸€è‡´çš„ï¼Œä½†æœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çŠ¶æ€ã€‚</li>
<li><strong>Eventually consistent</strong>ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ï¼šç³»ç»Ÿä¸­çš„æ•°æ®æœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çŠ¶æ€ï¼Œä½†åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šå¯èƒ½å­˜åœ¨éƒ¨åˆ†ä¸ä¸€è‡´çš„æƒ…å†µã€‚æœ€ç»ˆä¸€è‡´æ€§æ˜¯ç›¸å¯¹äºå¼ºä¸€è‡´æ€§è€Œè¨€çš„ï¼Œç³»ç»Ÿå¯ä»¥é€šè¿‡<strong>å¼‚æ­¥å¤åˆ¶ã€å»¶è¿Ÿè¡¥å¿</strong>ç­‰æœºåˆ¶æ¥å®ç°æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
</ul>
<p>BASEç†è®ºçš„ç›®æ ‡æ˜¯é€šè¿‡æ”¾å®½ä¸€è‡´æ€§è¦æ±‚ï¼Œè¿½æ±‚æ›´é«˜çš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚ç›¸å¯¹äºä¼ ç»Ÿçš„ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰äº‹åŠ¡æ¨¡å‹ï¼ŒBASEç†è®ºæ›´é€‚ç”¨äºå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¯ä»¥æä¾›æ›´å¥½çš„å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒBASEç†è®ºå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç®—æ³•æˆ–å®ç°ï¼Œè€Œæ˜¯ä¸€ç§æ€æƒ³å’ŒåŸåˆ™ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯å®ç°è¿›è¡Œçµæ´»çš„åº”ç”¨ã€‚åœ¨å®é™…ç³»ç»Ÿè®¾è®¡ä¸­ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€æ€§èƒ½ç­‰å› ç´ ï¼Œé€‰æ‹©é€‚åˆçš„ç­–ç•¥å¹¶è¿›è¡Œåˆç†çš„æƒè¡¡ã€‚</p>
<h2 data-id="heading-3">2. æœåŠ¡ç«¯è®¾å¤‡è¿è¡Œæ—¥å¿—</h2>
<h3 data-id="heading-4">2.1 éœ€æ±‚åˆ†æ</h3>
<p>å½“ç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼ŒæœåŠ¡ç«¯éœ€è¦å‘è®¾å¤‡å‘é€å‡ºè´§æŒ‡ä»¤ã€‚è®¾å¤‡æ”¶åˆ°å‡ºè´§æŒ‡ä»¤åï¼Œæ‰§è¡Œå‡ºè´§ï¼Œå¹¶å°†ç»“æœå‘é€ç»™æœåŠ¡ç«¯ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦éšæ—¶æŒæ¡æœ‰å“ªäº›æ•°æ®æ˜¯æˆåŠŸäº†ï¼Œæœ‰å“ªäº›æ˜¯å¤±è´¥äº†ï¼Œæœ‰å“ªäº›æ˜¯æ²¡æœ‰å¾—åˆ°ç»“æœã€‚</p>
<h3 data-id="heading-5">2.2 å®ç°æ€è·¯</h3>
<p>æˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡ç«¯å»ºç«‹ä¸€ä¸ªè®¾å¤‡å‘é€æ—¥å¿—ï¼Œå½“å‘é€ç»™è®¾å¤‡æŒ‡ä»¤æ—¶æ–°å¢è®°å½•ï¼ŒçŠ¶æ€ä¸º0 ï¼Œå½“æ”¶åˆ°ç»“æœæ—¶ä¿®æ”¹çŠ¶æ€ï¼ŒæˆåŠŸä¸º1 ï¼Œå¤±è´¥ä¸º2 ã€‚</p>
<p>è¿™ä¸ªè¡¨å°±æ˜¯ tb_vendout_running</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37740863caa84e0aa5ef6cfa1912a5b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=VhonmMZSaAPNrwgbcNLoY9hafo4%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h3 data-id="heading-6">2.3 ä»£ç å®ç°</h3>
<h4 data-id="heading-7">2.3.1 å‘è´§æ·»åŠ æ—¥å¿—</h4>
<p>ï¼ˆ1ï¼‰åˆ›å»ºDTO</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VendoutRunningDTO</span> {


    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> orderNo;<span class="hljs-comment">//è®¢å•ç¼–å·</span>


    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> innerCode;<span class="hljs-comment">//å”®è´§æœºç¼–å·</span>


    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> channelCode;<span class="hljs-comment">//è´§é“ç¼–å·</span>


    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> status;<span class="hljs-comment">//çŠ¶æ€</span>

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰feignæ¥å£ç±» VMService æ–°å¢æ–¹æ³•å®šä¹‰</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * æ–°å¢å”®è´§æœºæ—¥å¿—
 * @param vendoutRunning
 * @return æ˜¯å¦æˆåŠŸ
 */</span>
<span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/vendoutRunning"</span>)
public boolean <span class="hljs-built_in">addVendoutRunning</span>(<span class="hljs-variable">@RequestBody</span> VendoutRunningDTO vendoutRunning);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰VmServiceFallbackFactory ç¼–å†™ç†”æ–­æ–¹æ³•</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">addVendoutRunning</span>(<span class="hljs-params">VendoutRunningDTO vendoutRunning</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ4ï¼‰åˆ›å»ºè¿è¡Œæ—¥å¿—çŠ¶æ€</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
 * è¿è¡Œæ—¥å¿—çŠ¶æ€ã€€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VMRuningStatus</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> VENDOUT_PREP = <span class="hljs-string">"0"</span>; <span class="hljs-comment">//å‡†å¤‡å‘è´§ã€€</span>

    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> VENDOUT_COMP = <span class="hljs-string">"1"</span>;<span class="hljs-comment">//å®Œæˆå‘è´§</span>

    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> VENDOUT_FAIL = <span class="hljs-string">"2"</span>;<span class="hljs-comment">//å‘è´§å¤±è´¥</span>

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ5ï¼‰åœ¨å‘é€å‡ºè´§æŒ‡ä»¤æ—¶ï¼Œå‘å”®è´§æœºè¿è¡Œæ—¥å¿—æ’å…¥è®°å½•ï¼ŒçŠ¶æ€ä¸º0 ï¼ˆæ— ç»“æœï¼‰</p>
<p>ä¿®æ”¹CallBackServiceImplçš„successPayæ–¹æ³•ï¼Œåœ¨å‘é€æ¶ˆæ¯å‰ ï¼Œ æ·»åŠ æ·»åŠ å”®è´§æœºè¿è¡Œæ—¥å¿—</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Override</span>
public void successPay(String orderSn) {
    log<span class="hljs-selector-class">.info</span>("æ”¯ä»˜æˆåŠŸå›è°ƒ{}",orderSn);
    OrderEntity orderEntity = orderService<span class="hljs-selector-class">.getByOrderNo</span>(orderSn);
    <span class="hljs-built_in">if</span>(orderEntity!=null){
        <span class="hljs-built_in">if</span>(orderEntity.getStatus()<span class="hljs-selector-class">.equals</span>( OrderStatus.ORDER_STATUS_CREATE )){
            orderEntity<span class="hljs-selector-class">.setStatus</span>(OrderStatus.ORDER_STATUS_PAYED); <span class="hljs-comment">//è®¢å•çŠ¶æ€  å·²æ”¯ä»˜</span>
            orderEntity<span class="hljs-selector-class">.setPayStatus</span>(PayStatus.PAY_STATUS_PAYED) ;<span class="hljs-comment">//æ”¯ä»˜çŠ¶æ€  æˆåŠŸ</span>
            <span class="hljs-comment">//æŸ¥è¯¢å‡ºè´§è´§é“</span>
            ChannelVO channelVO = vmService<span class="hljs-selector-class">.getChannel</span>(orderEntity.getInnerCode(), orderEntity<span class="hljs-selector-class">.getSkuId</span>());
            orderEntity<span class="hljs-selector-class">.setChannelCode</span>( channelVO.getChannelCode() );
            orderService<span class="hljs-selector-class">.updateById</span>( orderEntity );

            <span class="hljs-comment">//æ·»åŠ æœåŠ¡ç«¯è¿è¡Œæ—¥å¿—</span>
            VendoutRunningDTO vendoutRunning =new  <span class="hljs-built_in">VendoutRunningDTO</span>();
            BeanUtils<span class="hljs-selector-class">.copyProperties</span>( orderEntity,vendoutRunning );
            vendoutRunning<span class="hljs-selector-class">.setStatus</span>(VMRuningStatus.VENDOUT_PREP);  <span class="hljs-comment">//çŠ¶æ€:å‡†å¤‡å‘è´§</span>
            vmService<span class="hljs-selector-class">.addVendoutRunning</span>(vendoutRunning );

            <span class="hljs-comment">//æ„å»ºæŠ¥æ–‡å¹¶å‘é€</span>
            VendoutDTO vendoutDTO=new <span class="hljs-built_in">VendoutDTO</span>();  <span class="hljs-comment">//æŠ¥æ–‡å°è£…å¯¹è±¡  ï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰</span>
            BeanUtils<span class="hljs-selector-class">.copyProperties</span>( orderEntity,vendoutDTO );
            elegentAC<span class="hljs-selector-class">.publish</span>(TopicConfig.getVendoutTopic( orderEntity.getInnerCode() ) , vendoutDTO);
        }
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-8">2.3.2 å¤„ç†å‡ºè´§ç»“æœ</h4>
<p>åœ¨å”®è´§æœºå¾®æœåŠ¡æ¥åˆ°æ­£å¸¸çš„å‡ºè´§ç»“æœæ—¶ï¼Œæ›´æ”¹æ—¥å¿—çŠ¶æ€ä¸º1 ï¼ˆæ­£å¸¸ï¼‰</p>
<p>åœ¨å”®è´§æœºå¾®æœåŠ¡æ¥åˆ°å¼‚å¸¸çš„å‡ºè´§ç»“æœæ—¶ï¼Œæ›´æ”¹æ—¥å¿—çŠ¶æ€ä¸º2 ï¼ˆå¼‚å¸¸ï¼‰</p>
<p>ä¿®æ”¹å”®è´§æœºå¾®æœåŠ¡ dkd_vms_serviceçš„VendOutResultHandleræ–¹æ³•</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * å”®è´§æœºå¾®æœåŠ¡å¤„ç†å‡ºè´§ç»“æœ
 */</span>
<span class="hljs-variable">@Topic</span>(TopicConfig.VMS_RESULT_TOPIC)
<span class="hljs-variable">@Slf4j</span>
public class VendoutResultHandler  implements ACHandler&lt;VendoutResultDTO&gt; {


    <span class="hljs-variable">@Autowired</span>
    private ChannelService channelService;

    <span class="hljs-variable">@Autowired</span>
    private VendoutRunningService vendoutRunningService;

    <span class="hljs-variable">@Override</span>
    public void <span class="hljs-built_in">process</span>(String s, VendoutResultDTO vendoutResultDTO) throws Exception {

        <span class="hljs-comment">//å‡ºè´§æˆåŠŸæ‰£å‡åº“å­˜</span>
        <span class="hljs-selector-tag">if</span>(vendoutResultDTO.<span class="hljs-built_in">isSuccess</span>()){
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>( <span class="hljs-string">"å‡ºè´§æˆåŠŸï¼Œæ‰£å‡åº“å­˜:{}"</span>,  vendoutResultDTO );
            <span class="hljs-selector-tag">ChannelEntity</span> <span class="hljs-selector-tag">channelEntity</span> = <span class="hljs-selector-tag">channelService</span><span class="hljs-selector-class">.getChannelInfo</span>(vendoutResultDTO.<span class="hljs-built_in">getInnerCode</span>(), vendoutResultDTO.<span class="hljs-built_in">getChannelCode</span>());
            <span class="hljs-selector-tag">channelEntity</span><span class="hljs-selector-class">.setCurrentCapacity</span>( channelEntity.<span class="hljs-built_in">getCurrentCapacity</span>()-<span class="hljs-number">1</span> );
            <span class="hljs-selector-tag">channelService</span><span class="hljs-selector-class">.updateById</span>( channelEntity);
            <span class="hljs-selector-tag">vendoutRunningService</span><span class="hljs-selector-class">.updateStatus</span>(vendoutResultDTO.<span class="hljs-built_in">getOrderNo</span>(), VMRuningStatus.VENDOUT_COMP);<span class="hljs-comment">//å‘è´§æˆåŠŸ</span>

        }<span class="hljs-selector-tag">else</span>{
            <span class="hljs-selector-tag">vendoutRunningService</span><span class="hljs-selector-class">.updateStatus</span>(vendoutResultDTO.<span class="hljs-built_in">getOrderNo</span>(), VMRuningStatus.VENDOUT_FAIL);<span class="hljs-comment">//å‘è´§å¤±è´¥</span>
        }
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-9">2.3.3 æœ€ç»ˆä¸€è‡´æ€§è¡¥å¿æ•°æ®</h4>
<p>å› ä¸ºæœåŠ¡ç«¯å’Œè®¾å¤‡éœ€è¦é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œè¿™æœŸé—´å¯èƒ½ä¼šå› ä¸ºç½‘ç»œåŸå› æ— æ³•å°†å‡ºè´§æŒ‡ä»¤é€è¾¾åˆ°è®¾å¤‡ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šåœ¨è®¾å¤‡å‡ºè´§åå› ä¸ºç½‘ç»œæ•…éšœæ— æ³•å°†ç»“æœä¸ŠæŠ¥ç»™æœåŠ¡ç«¯ã€‚è¿™ä¸¤ç§æƒ…å†µï¼Œéƒ½å¯èƒ½å¯¼è‡´è¿è¡Œæ—¥å¿—çš„çŠ¶æ€ä¸º0 ã€‚</p>
<p>é‚£ä¹ˆï¼Œé‡åˆ°è¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>æœåŠ¡ç«¯å’Œè®¾å¤‡ç«¯éƒ½ä¿å­˜æœ‰æ—¥å¿—è®°å½•ï¼Œè®¾å¤‡ç«¯åœ¨æ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œä¹Ÿä¼šè®°å½•åœ¨æ—¥å¿—ä¸­ã€‚è®¾å¤‡åœ¨ä¸ŠæŠ¥å‰å’Œä¸ŠæŠ¥åéƒ½ä¼šåšè®°å½•ï¼Œå¦‚æœè®¾å¤‡ç«¯çš„æ—¥å¿—è®°å½•ä¸ŠæŠ¥çŠ¶æ€ä¸ºæœªä¸ŠæŠ¥ï¼Œåˆ™æ˜¯å› ä¸ºç½‘ç»œåŸå› å¯¼è‡´æ— æ³•åŠæ—¶ä¸ŠæŠ¥æ¶ˆæ¯ã€‚</p>
<p>å¯¹äºè¿™äº›æ²¡æœ‰æˆåŠŸä¸ŠæŠ¥çš„æ¶ˆæ¯ï¼Œè®¾å¤‡ç«¯ä¼šæ¯é—´éš”ä¸€æ®µæ—¶é—´å†æ¬¡è¿›è¡ŒçŠ¶æ€çš„ä¸ŠæŠ¥ã€‚è¿™æ ·ä¸€æ—¦ç½‘ç»œé€šç•…äº†ï¼Œå°±ä¼šå®ç°æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-10">3.åˆ†å¸ƒå¼é”æŠ€æœ¯ç ”ç©¶(é‡ç‚¹)</h2>
<h3 data-id="heading-11">3.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”</h3>
<p>åˆ†å¸ƒå¼é”æ˜¯ä¸€ç§ç”¨äºåè°ƒåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¹¶å‘è®¿é—®çš„æœºåˆ¶ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹å¯èƒ½åŒæ—¶è®¿é—®å…±äº«èµ„æºï¼Œä¸ºäº†é¿å…æ•°æ®ä¸ä¸€è‡´æˆ–ç«äº‰æ¡ä»¶çš„å‘ç”Ÿï¼Œéœ€è¦ä¸€ç§æœºåˆ¶æ¥ç¡®ä¿åœ¨æŸä¸ªèŠ‚ç‚¹æ“ä½œå…±äº«èµ„æºæ—¶ï¼Œå…¶ä»–èŠ‚ç‚¹ä¸èƒ½åŒæ—¶è®¿é—®è¯¥èµ„æºã€‚</p>
<p>åˆ†å¸ƒå¼é”é€šè¿‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¼•å…¥ä¸€ä¸ªå…¨å±€çš„é”æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå®ƒé¦–å…ˆå°è¯•è·å–åˆ†å¸ƒå¼é”ï¼Œå¦‚æœæˆåŠŸè·å–åˆ°é”ï¼Œåˆ™å¯ä»¥æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼›å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™éœ€è¦ç­‰å¾…é”é‡Šæ”¾åå†æ¬¡å°è¯•ã€‚</p>
<p>åˆ†å¸ƒå¼é”å¯ä»¥ä½¿ç”¨å„ç§æŠ€æœ¯å’Œç®—æ³•æ¥å®ç°ï¼Œå¸¸è§çš„å®ç°æ–¹å¼åŒ…æ‹¬åŸºäºæ•°æ®åº“ã€åŸºäºç¼“å­˜ã€åŸºäºZooKeeperç­‰ã€‚è¿™äº›å®ç°æ–¹å¼é€šå¸¸è¦è€ƒè™‘é«˜å¯ç”¨æ€§ã€æ€§èƒ½å’Œå¯é æ€§ç­‰å› ç´ ã€‚</p>
<p>ä½¿ç”¨åˆ†å¸ƒå¼é”å¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¹¶å‘è®¿é—®ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œæ­£ç¡®æ€§ã€‚ç„¶è€Œï¼Œåˆ†å¸ƒå¼é”çš„è®¾è®¡å’Œä½¿ç”¨éœ€è¦ä»”ç»†è€ƒè™‘å„ç§æƒ…å†µï¼Œé¿å…æ­»é”ã€æ€§èƒ½ç“¶é¢ˆå’Œå•ç‚¹æ•…éšœç­‰é—®é¢˜çš„å‘ç”Ÿã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef87d16f140447e68ecab793ff4e4a70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=%2FjfeWIr9J4%2FC7fCWCzgrs2H4uQM%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h3 data-id="heading-12">3.2 åˆ†å¸ƒå¼é”çš„åˆ†ç±»</h3>
<ol>
<li><strong>æŒ‰å®ç°æ–¹å¼åˆ†ç±»</strong>ï¼š</li>
</ol>
<ul>
<li>
<ul>
<li>åŸºäºæ•°æ®åº“çš„åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨æ•°æ®åº“çš„äº‹åŠ¡å’Œå”¯ä¸€çº¦æŸæ¥å®ç°åˆ†å¸ƒå¼é”ï¼Œé€šå¸¸ä½¿ç”¨è¡¨ä¸­çš„ä¸€è¡Œè®°å½•è¡¨ç¤ºä¸€ä¸ªé”ã€‚</li>
<li>åŸºäºç¼“å­˜çš„åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚Redisï¼‰çš„åŸå­æ€§æ“ä½œå’Œè¿‡æœŸæ—¶é—´ç‰¹æ€§æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚</li>
<li>åŸºäºZookeeperçš„åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨ZooKeeperè¿™æ ·çš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡æ¥å®ç°åˆ†å¸ƒå¼é”ï¼Œé€šè¿‡åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹æ¥å®ç°é”çš„è·å–å’Œé‡Šæ”¾ã€‚</li>
<li>åŸºäºConsul çš„åˆ†å¸ƒå¼é”</li>
</ul>
</li>
</ul>
<ol>
<li><strong>æŒ‰ç‰¹æ€§åˆ†ç±»</strong>ï¼š</li>
</ol>
<ul>
<li>
<ul>
<li><strong>é˜»å¡é”</strong>ï¼šè·å–é”å¤±è´¥æ—¶ï¼Œè¯·æ±‚çº¿ç¨‹ä¼šè¢«é˜»å¡ç›´åˆ°è·å–åˆ°é”ä¸ºæ­¢ã€‚</li>
<li><strong>éé˜»å¡é”</strong>ï¼šè·å–é”å¤±è´¥æ—¶ï¼Œè¯·æ±‚çº¿ç¨‹ä¼šç«‹å³è¿”å›è€Œä¸ä¼šè¢«é˜»å¡ï¼Œå¯ä»¥é€šè¿‡è½®è¯¢æˆ–è€…å›è°ƒæ–¹å¼æ¥è·å–é”ã€‚</li>
</ul>
</li>
</ul>
<ol>
<li><strong>æŒ‰æ˜¯å¦å¯é‡å…¥åˆ†ç±»</strong>ï¼š</li>
</ol>
<ul>
<li>
<ul>
<li><strong>å¯é‡å…¥é”</strong>ï¼šå…è®¸åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–åŒä¸€æŠŠé”ï¼Œé€šå¸¸ç”¨äºé€’å½’è°ƒç”¨æˆ–è€…åµŒå¥—è°ƒç”¨çš„åœºæ™¯ã€‚<br/>
å¯é‡å…¥é”æ˜¯ä¸€ç§ç‰¹æ®Šçš„é”ï¼Œå…è®¸åŒä¸€ä¸ªçº¿ç¨‹åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹å¤šæ¬¡è·å–è¯¥é”ï¼Œè€Œä¸ä¼šè¢«è‡ªå·±æ‰€æŒæœ‰çš„é”æ‰€é˜»å¡ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—çº¿ç¨‹å¯ä»¥åœ¨é€’å½’è°ƒç”¨æˆ–è€…åµŒå¥—è°ƒç”¨çš„æƒ…å†µä¸‹å®‰å…¨åœ°ä½¿ç”¨é”ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ­»é”æˆ–è€…ç«äº‰æ¡ä»¶çš„é—®é¢˜ã€‚<br/>
åœ¨å®ç°å¯é‡å…¥é”æ—¶ï¼Œé€šå¸¸éœ€è¦è®°å½•å½“å‰é”çš„æŒæœ‰è€…ä»¥åŠæŒæœ‰æ¬¡æ•°ã€‚å½“çº¿ç¨‹å†æ¬¡è·å–åŒä¸€æŠŠé”æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»æŒæœ‰è¯¥é”ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å¢åŠ æŒæœ‰æ¬¡æ•°ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™é˜»å¡æˆ–è€…è¿”å›å¤±è´¥ã€‚</li>
<li><strong>ä¸å¯é‡å…¥é”</strong></li>
</ul>
</li>
</ul>
<ol>
<li>æŒ‰æ˜¯å¦å…¬å¹³åˆ†ç±»ï¼š</li>
</ol>
<ul>
<li>
<ul>
<li>
<p><strong>å…¬å¹³é”</strong>ï¼š<br/>
å…¬å¹³é”æ˜¯ä¸€ç§é”ï¼Œå®ƒä¿è¯é”çš„è·å–æŒ‰ç…§è¯·æ±‚çš„é¡ºåºè¿›è¡Œåˆ†é…ï¼Œé¿å…æŸäº›çº¿ç¨‹é•¿æœŸç­‰å¾…è€Œæ— æ³•è·å–é”çš„æƒ…å†µï¼Œä»è€Œé¿å…äº†"é¥¥é¥¿"ç°è±¡çš„å‘ç”Ÿã€‚<br/>
åœ¨å…¬å¹³é”ä¸­ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€æŠŠé”æ—¶ï¼Œé”ä¼šæŒ‰ç…§è¯·æ±‚çš„é¡ºåºåˆ†é…ç»™ç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹ï¼Œè€Œä¸æ˜¯éšæœºåˆ†é…ç»™ä»»æ„ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰çº¿ç¨‹éƒ½æœ‰å…¬å¹³çš„æœºä¼šè·å–é”ï¼Œé¿å…äº†æŸäº›çº¿ç¨‹é•¿æœŸæ— æ³•è·å–é”çš„æƒ…å†µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fd41aa4e0464835b93fa5f54be31190~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=Bx%2BV%2BGGtlJI5hE%2BGsfihrFb2zro%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
</li>
<li>
<p><strong>éå…¬å¹³é”</strong> å½“æœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€æŠŠé”æ—¶ ï¼Œéšæœºåˆ†é…ç»™ä»»æ„ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b96573af220444ec8ecc4d4939902b7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=eWMIikYuld5wRU2ea%2FMfil2iiek%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-13">3.3 å®ç°åˆ†å¸ƒå¼é”çš„å‡ ç§æ–¹å¼</h3>
<h4 data-id="heading-14">3.3.1 åŸºäºæ•°æ®åº“å®ç°çš„åˆ†å¸ƒå¼é”ï¼ˆäº†è§£ï¼‰</h4>
<p><strong>åˆ›å»ºé”è¡¨</strong>ï¼šåœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€å¼ ç”¨äºå­˜å‚¨é”ä¿¡æ¯çš„è¡¨ï¼Œä¾‹å¦‚åä¸º<code>distributed_lock</code>ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li><code>lock_name</code>ï¼šé”çš„åç§°ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„é”ã€‚</li>
<li><code>holder</code>ï¼šé”çš„æŒæœ‰è€…æ ‡è¯†ï¼Œå¯ä»¥æ˜¯è¿›ç¨‹IDã€çº¿ç¨‹IDæˆ–è€…å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚</li>
<li><code>expire_time</code>ï¼šé”çš„è¿‡æœŸæ—¶é—´ï¼Œé¿å…é”è¢«é•¿æ—¶é—´å ç”¨ã€‚</li>
</ul>

<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> distributed_lock (
    lock_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
    holder <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>),
    expire_time <span class="hljs-type">TIMESTAMP</span>
);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>è·å–é”</strong>ï¼šåœ¨éœ€è¦è·å–é”çš„åœ°æ–¹ï¼Œé€šè¿‡æ•°æ®åº“äº‹åŠ¡æ¥å°è¯•æ’å…¥ä¸€æ¡é”è®°å½•ï¼Œå¦‚æœæ’å…¥æˆåŠŸåˆ™è¡¨ç¤ºè·å–åˆ°äº†é”ï¼Œå¦åˆ™è¡¨ç¤ºé”å·²ç»è¢«å…¶ä»–è¿›ç¨‹æŒæœ‰ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> distributed_lock (lock_name, holder, expire_time) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'my_lock'</span>, <span class="hljs-string">'process_id'</span>, NOW() <span class="hljs-operator">+</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-number">10</span> <span class="hljs-keyword">SECOND</span>);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>é‡Šæ”¾é”</strong>ï¼šåœ¨ä»»åŠ¡æ‰§è¡Œå®Œæˆæˆ–è€…é”è¿‡æœŸæ—¶ï¼Œé€šè¿‡äº‹åŠ¡æ“ä½œæ¥åˆ é™¤å¯¹åº”çš„é”è®°å½•ï¼Œé‡Šæ”¾é”èµ„æºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">DELETE FROM distributed_lock WHERE <span class="hljs-attr">lock_name</span> = <span class="hljs-string">'my_lock'</span> AND holder = <span class="hljs-string">'process_id'</span><span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>å¤„ç†é”è¶…æ—¶</strong>ï¼šå®šæœŸæ¸…ç†è¿‡æœŸçš„é”è®°å½•ï¼Œå¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡æˆ–è€…åå°è¿›ç¨‹æ¥å®ç°ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> distributed_lock <span class="hljs-keyword">WHERE</span> expire_time <span class="hljs-operator">&lt;</span> NOW();
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ä¼˜ç¼ºç‚¹ï¼š</p>
<p>ä¼˜ç‚¹ï¼šä¸éœ€è¦å¼•å…¥å…¶å®ƒä¸­é—´ä»¶ã€‚</p>
<p>ç¼ºç‚¹ï¼šå¯¹æ•°æ®åº“å‹åŠ›è¾ƒå¤§ï¼Œæ‰§è¡Œæ•ˆç‡è¾ƒä½ã€‚</p>
<h4 data-id="heading-15">3.3.2 Redisåˆ†å¸ƒå¼é”-setNxå‘½ä»¤(äº†è§£)</h4>
<p>rediså®ç°åˆ†å¸ƒå¼é”å¯ä»¥ä½¿ç”¨Redisçš„setNxå‘½ä»¤æ¥å®ç°ï¼Œå®ƒçš„åŸç†æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6cfa1d717614f3c9c26aa17f6ddeb2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=SjMQRpqZFutkj%2FJtSR0kUd10MSw%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯SpringDataRedis ,å®ç°çš„æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ï¼š</p>
<p>å¦‚æœæ˜¯åŠ é”ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Boolean <span class="hljs-attr">result</span> = redisTemplate.opsForValue().setIfAbsent(key, <span class="hljs-number">1</span>, <span class="hljs-number">60</span>, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™é‡Œé¢å®é™…å°±æ˜¯è°ƒç”¨äº†redisçš„setnx ï¼Œ<strong>setnx</strong> å¤§è‡´åŸç†ï¼Œä¸»è¦ä¾æ‰˜äº†å®ƒçš„<strong>keyä¸å­˜åœ¨æ‰èƒ½setæˆåŠŸçš„ç‰¹æ€§</strong>ã€‚</p>
<p>å¦‚æœæ˜¯é‡Šæ”¾é”ï¼Œæ¯”è¾ƒç®€å•çš„æ˜¯ç›´æ¥æŠŠè¿™ä¸ªkeyåˆ é™¤æ‰ã€‚ä½†æ˜¯è¿™æ ·ä¸€æ¥åˆ é™¤é”å’ŒåŠ é”çš„ä¸ä¸€å®šæ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡Šæ”¾é”çš„æ—¶å€™åˆ¤æ–­å½“å‰è¿›ç¨‹å’ŒåŠ é”çš„è¿›ç¨‹æ˜¯ä¸æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™å°±éœ€è¦åœ¨åˆ é™¤å‰å†æŸ¥è¯¢ä¸€æ¬¡ï¼Œè€Œè¿™æ ·ä¸€æ¥å°±ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œäº†ã€‚å¦‚æœé‡Šæ”¾é”æƒ³è¦æˆä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œæ¯”è¾ƒå¸¸è§çš„æ–¹æ¡ˆå°±æ˜¯é€šè¿‡è°ƒç”¨luaè„šæœ¬æ¥å®ç°ã€‚</p>
<p>é‡Šæ”¾é”çš„luaè„šæœ¬æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">'get'</span>, KEYS[<span class="hljs-number">1</span>]) == ARGV[<span class="hljs-number">1</span>] 
 <span class="hljs-keyword">then</span> 
 <span class="hljs-comment">-- æ‰§è¡Œåˆ é™¤æ“ä½œ</span>
 <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">'del'</span>, KEYS[<span class="hljs-number">1</span>]) 
<span class="hljs-keyword">else</span> 
 <span class="hljs-comment">-- ä¸æˆåŠŸï¼Œè¿”å›0</span>
 <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> 
 <span class="hljs-keyword">end</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªLuaè„šæœ¬ä¸­ï¼Œå‡è®¾é”çš„é”®åä¸º<code>KEYS[1]</code>ï¼Œå¹¶ä¸”é”çš„å€¼ä¸º<code>ARGV[1]</code>ã€‚è„šæœ¬é¦–å…ˆé€šè¿‡<code>get</code>å‘½ä»¤è·å–é”çš„å½“å‰å€¼ï¼Œç„¶ååˆ¤æ–­é”çš„å½“å‰å€¼æ˜¯å¦ä¸ä¼ å…¥çš„å€¼ç›¸åŒã€‚å¦‚æœç›¸åŒï¼Œåˆ™ä½¿ç”¨<code>del</code>å‘½ä»¤åˆ é™¤è¯¥é”®ï¼Œè¡¨ç¤ºæˆåŠŸé‡Šæ”¾é”ï¼›å¦‚æœä¸ç›¸åŒï¼Œåˆ™è¿”å›0ï¼Œè¡¨ç¤ºé‡Šæ”¾å¤±è´¥ã€‚</p>
<p>æ‰§è¡Œé‡Šæ”¾é”çš„luaè„šæœ¬</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è§£é”è„šæœ¬</span>
<span class="hljs-title class_">DefaultRedisScript</span>&lt;<span class="hljs-title class_">Object</span>&gt; unlockScript = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultRedisScript</span>();
unlockScript.<span class="hljs-title function_">setScriptSource</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourceScriptSource</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(<span class="hljs-string">"lockDel.lua"</span>)));
 <span class="hljs-comment">// æ‰§è¡Œluaè„šæœ¬è§£é”</span>
 redisTemplate.<span class="hljs-title function_">execute</span>(unlockScript, <span class="hljs-title class_">Collections</span>.<span class="hljs-title function_">singletonList</span>(keyName), value);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ã€çŸ¥è¯†ç‚¹å°èŠ‚ã€‘</p>
<ol>
<li>å¦‚ä½•å®ç°redisåˆ†å¸ƒå¼é”ï¼Ÿ</li>
</ol>
<p>ï¼ˆ1ï¼‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Redisçš„setNxå‘½ä»¤åŠ é”ï¼Œå¯¹äºæˆ‘ä»¬å¸¸ç”¨çš„SpringDataRedisæ¡†æ¶æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨setIfAbsentæ–¹æ³•æ¥å®ç°åŠ é”ã€‚</p>
<p>ï¼ˆ2ï¼‰è¿™ç§æ–¹å¼çš„é‡Šæ”¾é”ä¸å…·å¤‡åŸå­æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é‡Šæ”¾é”çš„æ“ä½œæ”¾åˆ°luaè„šæœ¬ï¼Œåœ¨ä»£ç ä¸­è°ƒç”¨luaè„šæœ¬æ¥å®ç°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨redisTemplateçš„executeæ–¹æ³•æ¥è°ƒç”¨luaè„šæœ¬ã€‚</p>
<h4 data-id="heading-16">rediså®ç°åˆ†å¸ƒå¼é”å¯ä»¥ä½¿ç”¨Redisçš„setNxå‘½ä»¤æ¥å®ç°ï¼Œå®ƒçš„åŸç†æ˜¯è¿™æ ·çš„ï¼š</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a9f53e510844a2fa8ad2d6ce1b371b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=V3dOW%2BfWwtbA8uNRrD1tVJcM3oQ%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯SpringDataRedis ,å®ç°çš„æ–¹å¼ä¹Ÿæ¯”è¾ƒç®€å•ï¼š</p>
<p>å¦‚æœæ˜¯åŠ é”ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Boolean <span class="hljs-attr">result</span> = redisTemplate.opsForValue().setIfAbsent(key, <span class="hljs-number">1</span>, <span class="hljs-number">60</span>, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™é‡Œé¢å®é™…å°±æ˜¯è°ƒç”¨äº†redisçš„setnx ï¼Œ<strong>setnx</strong> å¤§è‡´åŸç†ï¼Œä¸»è¦ä¾æ‰˜äº†å®ƒçš„<strong>keyä¸å­˜åœ¨æ‰èƒ½setæˆåŠŸçš„ç‰¹æ€§</strong>ã€‚</p>
<p>å¦‚æœæ˜¯é‡Šæ”¾é”ï¼Œæ¯”è¾ƒç®€å•çš„æ˜¯ç›´æ¥æŠŠè¿™ä¸ªkeyåˆ é™¤æ‰ã€‚ä½†æ˜¯è¿™æ ·ä¸€æ¥åˆ é™¤é”å’ŒåŠ é”çš„ä¸ä¸€å®šæ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡Šæ”¾é”çš„æ—¶å€™åˆ¤æ–­å½“å‰è¿›ç¨‹å’ŒåŠ é”çš„è¿›ç¨‹æ˜¯ä¸æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™å°±éœ€è¦åœ¨åˆ é™¤å‰å†æŸ¥è¯¢ä¸€æ¬¡ï¼Œè€Œè¿™æ ·ä¸€æ¥å°±ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œäº†ã€‚å¦‚æœé‡Šæ”¾é”æƒ³è¦æˆä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œæ¯”è¾ƒå¸¸è§çš„æ–¹æ¡ˆå°±æ˜¯é€šè¿‡è°ƒç”¨luaè„šæœ¬æ¥å®ç°ã€‚</p>
<p>é‡Šæ”¾é”çš„luaè„šæœ¬æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">'get'</span>, KEYS[<span class="hljs-number">1</span>]) == ARGV[<span class="hljs-number">1</span>] 
 <span class="hljs-keyword">then</span> 
 <span class="hljs-comment">-- æ‰§è¡Œåˆ é™¤æ“ä½œ</span>
 <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">'del'</span>, KEYS[<span class="hljs-number">1</span>]) 
<span class="hljs-keyword">else</span> 
 <span class="hljs-comment">-- ä¸æˆåŠŸï¼Œè¿”å›0</span>
 <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> 
 <span class="hljs-keyword">end</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªLuaè„šæœ¬ä¸­ï¼Œå‡è®¾é”çš„é”®åä¸ºKEYS[1]ï¼Œå¹¶ä¸”é”çš„å€¼ä¸ºARGV[1]ã€‚è„šæœ¬é¦–å…ˆé€šè¿‡getå‘½ä»¤è·å–é”çš„å½“å‰å€¼ï¼Œç„¶ååˆ¤æ–­é”çš„å½“å‰å€¼æ˜¯å¦ä¸ä¼ å…¥çš„å€¼ç›¸åŒã€‚å¦‚æœç›¸åŒï¼Œåˆ™ä½¿ç”¨delå‘½ä»¤åˆ é™¤è¯¥é”®ï¼Œè¡¨ç¤ºæˆåŠŸé‡Šæ”¾é”ï¼›å¦‚æœä¸ç›¸åŒï¼Œåˆ™è¿”å›0ï¼Œè¡¨ç¤ºé‡Šæ”¾å¤±è´¥ã€‚</p>
<p>æ‰§è¡Œé‡Šæ”¾é”çš„luaè„šæœ¬</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è§£é”è„šæœ¬</span>
<span class="hljs-title class_">DefaultRedisScript</span>&lt;<span class="hljs-title class_">Object</span>&gt; unlockScript = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultRedisScript</span>();
unlockScript.<span class="hljs-title function_">setScriptSource</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourceScriptSource</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(<span class="hljs-string">"lockDel.lua"</span>)));
 <span class="hljs-comment">// æ‰§è¡Œluaè„šæœ¬è§£é”</span>
 redisTemplate.<span class="hljs-title function_">execute</span>(unlockScript, <span class="hljs-title class_">Collections</span>.<span class="hljs-title function_">singletonList</span>(keyName), value);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ã€çŸ¥è¯†ç‚¹å°èŠ‚ã€‘</p>
<ol>
<li>å¦‚ä½•å®ç°redisåˆ†å¸ƒå¼é”ï¼Ÿ</li>
</ol>
<p>ï¼ˆ1ï¼‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Redisçš„setNxå‘½ä»¤åŠ é”ï¼Œå¯¹äºæˆ‘ä»¬å¸¸ç”¨çš„SpringDataRedisæ¡†æ¶æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨setIfAbsentæ–¹æ³•æ¥å®ç°åŠ é”ã€‚</p>
<p>ï¼ˆ2ï¼‰è¿™ç§æ–¹å¼çš„é‡Šæ”¾é”ä¸å…·å¤‡åŸå­æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é‡Šæ”¾é”çš„æ“ä½œæ”¾åˆ°luaè„šæœ¬ï¼Œåœ¨ä»£ç ä¸­è°ƒç”¨luaè„šæœ¬æ¥å®ç°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨redisTemplateçš„executeæ–¹æ³•æ¥è°ƒç”¨luaè„šæœ¬ã€‚</p>
<h4 data-id="heading-17">3.3.3 Redissonç»„ä»¶å°è£…å®ç°</h4>
<p>å› ä¸ºsetNxåŠ é”å­˜åœ¨å‡ ä¸ªå¼Šç«¯ï¼š</p>
<p>ï¼ˆ1ï¼‰é‡Šæ”¾é”è°ƒç”¨luaè„šæœ¬å®ç°ç¨ç¹ç</p>
<p>ï¼ˆ2ï¼‰ä¸å¯é‡å…¥</p>
<p>ï¼ˆ3ï¼‰æ²¡æœ‰å®ç°ç»­æœŸ</p>
<p>æˆ‘ä»¬ä½¿ç”¨Redissonç»„ä»¶å¯ä»¥å¾ˆè½»æ¾åœ°è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚ Redissonç»„ä»¶æä¾›äº†å¯é‡å…¥çš„ï¼Œå¯ä»¥å®ç°ç»­æœŸçš„åˆ†å¸ƒå¼é”ã€‚Redissonç»„ä»¶ä¸ºä½ æä¾›äº†ä¸€ä¸ªâ€œçœ‹é—¨ç‹—â€æœºåˆ¶ã€‚</p>
<p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå‚è€ƒä»¥ä¸‹æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰ å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.redisson<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>redisson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.16.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰ç¼–å†™é…ç½®ç±»</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Configuration</span>
 <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedissionConfig</span> {
   <span class="hljs-meta">@Value(<span class="hljs-string">"<span class="hljs-subst">${spring.redis.host}</span>"</span>)</span>
   <span class="hljs-keyword">private</span> String redisHost;

   <span class="hljs-meta">@Value(<span class="hljs-string">"<span class="hljs-subst">${spring.redis.password}</span>"</span>)</span>
   <span class="hljs-keyword">private</span> String password;

   <span class="hljs-keyword">private</span> int port = <span class="hljs-number">6379</span>;

   <span class="hljs-meta">@Bean</span>
   <span class="hljs-keyword">public</span> RedissonClient getRedisson() {
     Config config = new Config();
     config.useSingleServer().
     setAddress(<span class="hljs-string">"redis://"</span> + redisHost + <span class="hljs-string">":"</span> + port).
     setPassword(password);
     <span class="hljs-keyword">return</span> Redisson.create(config);
   }
 }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åŠ é”å’Œé‡Šæ”¾é”</p>
<p>å¼•å…¥RedissonClient</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Resource</span>
 <span class="hljs-keyword">private</span> RedissonClient redissonClient;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>é€šè¿‡RLockåŠ é”</p>
<pre><code class="hljs language-ini" lang="ini">RLock <span class="hljs-attr">rLock</span> = redissonClient.getLock(lockName)<span class="hljs-comment">;</span>
 boolean <span class="hljs-attr">isLocked</span> = rLock.tryLock(expireTime, TimeUnit.MILLISECONDS)<span class="hljs-comment">;</span>
 if (isLocked) {
 // TODOï¼š å¦‚æœåŠ é”æˆåŠŸ 
 }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>é€šè¿‡RLocké‡Šæ”¾é”</p>
<pre><code class="hljs language-ini" lang="ini">RLock <span class="hljs-attr">rLock</span> = redissonClient.getLock(lockName)<span class="hljs-comment">;</span>
 boolean <span class="hljs-attr">isLocked</span> = rLock.unLock()<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ã€çŸ¥è¯†ç‚¹å°èŠ‚ã€‘</p>
<p>å¦‚ä½•ä½¿ç”¨Redissonç»„ä»¶å®ç°åˆ†å¸ƒå¼é”ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨Redisson.createæ–¹æ³•åˆ›å»ºRedissonClientã€‚</p>
<p>ï¼ˆ2ï¼‰é€šè¿‡redissonClient.getLockæ–¹æ³•è·å–é”å¯¹è±¡RLockã€‚</p>
<p>ï¼ˆ3ï¼‰é€šè¿‡è°ƒç”¨RLockçš„tryLockæ–¹æ³•åŠ é”</p>
<p>ï¼ˆ4ï¼‰é€šè¿‡è°ƒç”¨RLockçš„unLockæ–¹æ³•é‡Šæ”¾é”</p>
<h4 data-id="heading-18">3.3.4 RedLockç®—æ³•çš„å®ç°</h4>
<p>ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨çº¢é”ï¼ˆRedLockï¼‰ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰å¦‚æœæˆ‘ä»¬è¿æ¥çš„æ˜¯ä¸€ä¸ªå•èŠ‚ç‚¹çš„Redisï¼Œæœ‰å¯èƒ½å› ä¸ºRediså®•æœºå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿç˜«ç—ªã€‚</p>
<p>ï¼ˆ2ï¼‰å¦‚æœæˆ‘ä»¬è¿æ¥çš„æ˜¯ä¸€ä¸ªé›†ç¾¤ç¯å¢ƒï¼Œæœ‰å¯èƒ½å› ä¸ºè„‘è£‚é—®é¢˜å¯¼è‡´åˆ†å¸ƒå¼é”å¤±æ•ˆã€‚</p>
<p>è„‘è£‚ æŒ‡çš„æ˜¯å› ä¸ºç½‘ç»œé€šè®¯ä¸­æ–­å¯¼è‡´ä¸€ä¸ªé›†ç¾¤åˆ†è£‚ä¸ºä¸¤ä¸ªé›†ç¾¤çš„ç°è±¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14fa6fdd04da4eb19a1b7995dc8e8695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=TyeC928XqPJ9zfkIPCTf98dktW8%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>ï¼ˆ3ï¼‰å¦‚æœæˆ‘ä»¬ä½¿ç”¨çº¢é”ç®—æ³•ï¼Œå®ƒæ‰€è¿æ¥çš„å¤šä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼Œè€Œæ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒçš„å®ç°åŸç†å°±æ˜¯å¯¹æ¯ä¸ªèŠ‚ç‚¹ä¾æ¬¡åŠ é”ï¼Œè¶…è¿‡åŠæ•°æˆåŠŸï¼Œä¸è¶…è¿‡åŠæ•°å¤±è´¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d745924e5134121aa1e180628804aae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=52MpwZnVutZNoFeaNCa0tXUGC40%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>å¦‚ä½•ä½¿ç”¨çº¢é”ï¼Œæˆ‘ä»¬çœ‹ä»£ç ï¼š</p>
<p>ï¼ˆ1ï¼‰ å¼•å…¥redissonä¾èµ– ï¼Œå’Œä¸Šè¾¹çš„ä¸€æ ·</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.redisson<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>redisson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.13.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰ç¼–å†™é…ç½®ç±»ï¼Œè¿™ä¸ªæœ‰äº›åŒºåˆ«</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Configuration</span>
public class RedissionConfig {
  
    <span class="hljs-comment">/**
     * çº¢é”åœ°å€åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">@Value</span>(<span class="hljs-string">"${elegent.lock.address}"</span>)
    private String[] address;

    <span class="hljs-keyword">@Bean</span>
    public RedissonClient[] getRedisson() {
        <span class="hljs-comment">//åˆå§‹åŒ–</span>
        RedissonClient<span class="hljs-selector-attr">[]</span> redissonClients=new RedissonClient<span class="hljs-selector-attr">[ address.length  ]</span>;
        <span class="hljs-built_in">for</span>(int i=<span class="hljs-number">0</span>;i&lt;redisLockConfig.getAddress()<span class="hljs-selector-class">.length</span>;<span class="hljs-selector-tag">i</span>++){
            Config config = new <span class="hljs-built_in">Config</span>();
            config<span class="hljs-selector-class">.useSingleServer</span>()<span class="hljs-selector-class">.setAddress</span>( "redis://"+redisLockConfig.getAddress()<span class="hljs-selector-attr">[i]</span> );
            redissonClients<span class="hljs-selector-attr">[i]</span> = Redisson<span class="hljs-selector-class">.create</span>(config);
        }
        return redissonClients;
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åŠ é”å’Œé‡Šæ”¾é”</p>
<p>å…ˆè¦åˆå§‹åŒ–ï¼Œå‡è®¾æˆ‘ä»¬æœ‰äº”ä¸ªèŠ‚ç‚¹</p>
<pre><code class="hljs language-ini" lang="ini">//å®¢æˆ·ç«¯
    private RedissonClient <span class="hljs-section">[]</span> redissonClients<span class="hljs-comment">;</span>

    @PostConstruct
    public void init() {
        //åˆå§‹åŒ–
        <span class="hljs-attr">redissonClients</span>=new RedissonClient[ address.length  ]<span class="hljs-comment">;</span>
        for(int <span class="hljs-attr">i</span>=<span class="hljs-number">0</span><span class="hljs-comment">;i&lt;redisLockConfig.getAddress().length;i++){</span>
            Config <span class="hljs-attr">config</span> = new Config()<span class="hljs-comment">;</span>
            config.useSingleServer().setAddress( "redis://"+redisLockConfig.getAddress()<span class="hljs-section">[i]</span> )<span class="hljs-comment">;</span>
            redissonClients<span class="hljs-section">[i]</span> = Redisson.create(config)<span class="hljs-comment">;</span>
        }
    }  

   private RedissonRedLock getRedissonRedLock(String lockName){
        RLock <span class="hljs-attr">lock0</span> = redissonClients[<span class="hljs-number">0</span>].getLock(lockName)<span class="hljs-comment">;</span>
        RLock <span class="hljs-attr">lock1</span> = redissonClients[<span class="hljs-number">1</span>].getLock(lockName)<span class="hljs-comment">;</span>
        RLock <span class="hljs-attr">lock2</span> = redissonClients[<span class="hljs-number">2</span>].getLock(lockName)<span class="hljs-comment">;</span>
        RLock <span class="hljs-attr">lock3</span> = redissonClients[<span class="hljs-number">3</span>].getLock(lockName)<span class="hljs-comment">;</span>
        RLock <span class="hljs-attr">lock4</span> = redissonClients[<span class="hljs-number">4</span>].getLock(lockName)<span class="hljs-comment">;</span>
        return new RedissonRedLock(lock0,lock1,lock2,lock3,lock4)<span class="hljs-comment">;</span>
    }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ä¸šåŠ¡ä»£ç ä¸­åŠ é”å’Œé‡Šæ”¾é”</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//çº¢é”</span>
RedissonRedLock redLock=<span class="hljs-built_in">getRedissonRedLock</span>(lockName);  
redLock<span class="hljs-selector-class">.tryLock</span>(<span class="hljs-number">60</span> ,TimeUnit.SECONDS);<span class="hljs-comment">//åŠ é”   å‚æ•°1æ˜¯è¿‡æœŸæ—¶é—´ ï¼Œå¦‚æœç»™-1åˆ™è¡¨ç¤ºç»­æœŸ</span>
redLock<span class="hljs-selector-class">.unlock</span>();<span class="hljs-comment">//é‡Šæ”¾é”</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ã€çŸ¥è¯†ç‚¹å°èŠ‚ã€‘</p>
<p>å¦‚ä½•ä½¿ç”¨çº¢é”ï¼Ÿ</p>
<p>ï¼ˆ1ï¼‰åˆ›å»ºæ¯ä¸ªredisèŠ‚ç‚¹çš„RedissonClient</p>
<p>ï¼ˆ2ï¼‰é€šè¿‡æ¯ä¸ªredisèŠ‚ç‚¹çš„RedissonClientæ„å»ºRedissonRedLock ã€‚</p>
<p>ï¼ˆ3ï¼‰é€šè¿‡RedissonRedLockçš„å®ä¾‹çš„tryLockåŠ é”ï¼Œunlocké‡Šæ”¾é”ã€‚</p>
<h3 data-id="heading-19">3.4 Elegent-lock</h3>
<h4 data-id="heading-20">3.4.1 Elegent-lockç®€ä»‹</h4>
<p>è¿™æ˜¯ä¸€ä¸ªåŸºäºspringbootçš„ä¼˜é›…çš„åˆ†å¸ƒå¼é”ç»„ä»¶ã€‚ä½¿ç”¨è¿™ä¸ªç»„ä»¶å¯ä»¥è®©ä½ æ›´è½»æ¾ã€æ›´ä¼˜é›…åœ°åœ¨é¡¹ç›®ä¸­é›†æˆåˆ†å¸ƒå¼é”ï¼Œè®©ä½ æ›´ä¸“æ³¨ä¸šåŠ¡ä»£ç çš„å¼€å‘ã€‚å®ƒç›®å‰æ”¯æŒredisåˆ†å¸ƒå¼é”ã€consulåˆ†å¸ƒå¼é”ä¸¤ç§å®ç°æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹é…ç½®è‡ªç”±åˆ‡æ¢è€Œä¸éœ€è¦æ›´æ”¹ä¸šåŠ¡ä»£ç ã€‚</p>
<p>å¼€æºé¡¹ç›®åœ°å€ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fchuanzhiliubei%2Felegent-lock" title="https://gitee.com/chuanzhiliubei/elegent-lock" target="_blank" ref="nofollow noopener noreferrer">gitee.com/chuanzhiliuâ€¦</a></p>
<h4 data-id="heading-21">3.4.2 Elegent-lockå¿«é€Ÿå…¥é—¨</h4>
<h5 data-id="heading-22">é›†æˆ</h5>
<p>1.åœ¨é¡¹ç›®ä¸­å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.lock<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-lock-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>2.åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶æ·»åŠ é…ç½®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">lock:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:6379</span>
    <span class="hljs-attr">wait:</span> <span class="hljs-number">10</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>é…ç½®è¯´æ˜ï¼š</p>
<p>ï¼ˆ1ï¼‰type: åˆ†å¸ƒå¼é”ç±»å‹ï¼Œå¯é€‰å€¼ï¼šconsulã€redisï¼Œé»˜è®¤å€¼æ˜¯redisã€‚</p>
<p>ï¼ˆ2ï¼‰host: åˆ†å¸ƒå¼é”ä¸­é—´ä»¶çš„éƒ¨ç½²åœ°å€ï¼Œé»˜è®¤å€¼ä¸º127.0.0.1ã€‚</p>
<p>ï¼ˆ3ï¼‰wait: ç­‰å¾…è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ï¼Œé»˜è®¤å€¼10ã€‚è¡¨ç¤ºåœ¨è·å–ä¸åˆ°é”çš„æ—¶å€™ä¼šåœ¨æ­¤æ—¶é—´å†…ä¼šè¿›è¡Œé‡è¯•ã€‚</p>
<h5 data-id="heading-23">ä»£ç æ–¹å¼</h5>
<p>ç±»ä¸­å¼•å…¥ElegentLock</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ElegentLock elegentLock;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ–¹æ³•è°ƒç”¨ä»¥ä¸‹æ–¹æ³•å®ç°åŠ é”ä¸é‡Šæ”¾é”</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">//å‚æ•°è¯´æ˜ï¼š é”åç§°ï¼Œè¿‡æœŸæ—¶é—´ï¼Œæ˜¯å¦è‡ªæ—‹</span>
boolean b = elegentLock.<span class="hljs-keyword">lock</span>(name,<span class="hljs-number">60</span>,<span class="hljs-literal">false</span>);
<span class="hljs-comment">//todo: ä¸šåŠ¡é€»è¾‘</span>
System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä¸šåŠ¡é€»è¾‘"</span>+b);
elegentLock.unLock(name);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h5 data-id="heading-24">æ³¨è§£æ–¹å¼</h5>
<p>åœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£<code>@ELegentLock(lockName = "test",isSpin= true,ttl=10)</code> å³å¯ã€‚</p>
<p><code>lockName</code>ä¸ºé”åå­—ï¼Œå®é™…åŠ é”ä¼šä»¥<code>lockName</code>+æ–¹æ³•å‚æ•°ä½œä¸ºé”keyã€‚</p>
<p><code>always =true</code>ï¼ŒåŠ é”ï¼Œå¦‚æœé”è¢«å ç”¨ä¼šé€šè¿‡è‡ªæ—‹æ–¹å¼ä¸æ–­å°è¯•ï¼Œç›´åˆ°åŠ æˆåŠŸä¸ºæ­¢ã€‚</p>
<p><code>always =false</code>ï¼Œï¼ˆé»˜è®¤å€¼ï¼‰åŠ é”ï¼Œåªå°è¯•ä¸€æ¬¡ã€‚æ¨èä½¿ç”¨æ­¤é€‰é¡¹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è¿è¡ŒElegentæä¾›çš„demoä»£ç ï¼Œè¿›è¡Œå¿«é€Ÿå­¦ä¹ ã€‚</p>
<h3 data-id="heading-25">3.5 åŸºäºConsulåˆ†å¸ƒå¼é”</h3>
<h4 data-id="heading-26">3.5.1 Consulç®€ä»‹</h4>
<p>Consulæ˜¯HashiCorpå…¬å¸æ¨å‡ºçš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚ Consulæ˜¯åˆ†å¸ƒå¼çš„ã€é«˜å¯ç”¨çš„ã€å¯æ¨ªå‘æ‰©å±•çš„ã€‚å®ƒå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ :</p>
<p>æœåŠ¡å‘ç°ï¼šconsulé€šè¿‡DNSæˆ–è€…HTTPæ¥å£ä½¿æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°å˜çš„å¾ˆå®¹æ˜“ã€‚<br/>
å¥åº·æ£€æŸ¥ï¼šå¥åº·æ£€æµ‹ä½¿consulå¯ä»¥å¿«é€Ÿçš„å‘Šè­¦åœ¨é›†ç¾¤ä¸­çš„æ“ä½œã€‚<br/>
é”®/å€¼å­˜å‚¨ï¼šä¸€ä¸ªç”¨æ¥å­˜å‚¨åŠ¨æ€é…ç½®çš„ç³»ç»Ÿã€‚æä¾›ç®€å•çš„HTTPæ¥å£ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ“ä½œã€‚<br/>
å¤šæ•°æ®ä¸­å¿ƒï¼šæ— éœ€å¤æ‚çš„é…ç½®ï¼Œå³å¯æ”¯æŒä»»æ„æ•°é‡çš„åŒºåŸŸã€‚</p>
<p>ä¸€å¥è¯æ¦‚å†µï¼š</p>
<p>Consulæ—¢å¯ä»¥ç”¨äºæ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥åškeyValueå­˜å‚¨ã€‚ä½¿ç”¨Consulåšåˆ†å¸ƒå¼é”çš„åº•å±‚åŸç†å°±æ˜¯keyValueå­˜å‚¨ã€‚</p>
<p>è¯¾ç¨‹æä¾›äº†é…å¥—çš„ consul æœ¬åœ°è¿è¡Œç¯å¢ƒ</p>
<h4 data-id="heading-27">3.5.2 é¡¹ç›®ä¸ºä»€ä¹ˆä½¿ç”¨Consulåšåˆ†å¸ƒå¼é”ï¼Ÿ</h4>
<p>Consulçš„åˆ†å¸ƒå¼é”ä¸Redisåˆ†å¸ƒå¼é”æœ‰ä»€ä¹ˆä¸åŒï¼Ÿé¡¹ç›®ä¸ºä»€ä¹ˆä½¿ç”¨Consulåšåˆ†å¸ƒå¼é”ï¼Ÿ</p>
<p>ä¸€å¥è¯æ¦‚å†µï¼š</p>
<p>å› ä¸ºConsulåˆ†å¸ƒå¼é”æ˜¯CPæ¶æ„çš„ï¼Œä½¿ç”¨ Raft ç®—æ³•æ¥ä¿è¯ä¸€è‡´æ€§ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒRedisç”±äºæ˜¯APæ¶æ„ï¼Œå¯èƒ½å› ä¸ºè„‘è£‚é€ æˆæ•°æ®ä¸ä¸€è‡´ï¼Œå¦‚æœé‡‡ç”¨Redisçº¢é”æ€§èƒ½åˆå¾ˆå·®ã€‚æ‰€ä»¥ï¼Œå½“æ—¶æˆ‘ä»¬æƒè¡¡åˆ©å¼Šï¼Œå†³å®šé‡‡ç”¨Consulåˆ†å¸ƒå¼é”ã€‚</p>
<p>çº¢é”ä¼šæœ‰å¼Šç«¯ã€‚æ—¶é—´å¤æ‚åº¦å˜é«˜ï¼ˆå“åº”æ—¶é—´è¾¹é•¿ï¼Œååé‡å˜ä½ï¼‰ ï¼Œç©ºé—´å¤æ‚åº¦å˜é«˜äº†ã€‚</p>
<h4 data-id="heading-28">3.5.3 Consulåšåˆ†å¸ƒå¼é”å¿«é€Ÿå…¥é—¨</h4>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶ ä¸ºconsul</p>
<h2 data-id="heading-29">4 åˆ†å¸ƒå¼é”è§£å†³è¶…å–é—®é¢˜</h2>
<h3 data-id="heading-30">4.1 é—®é¢˜åˆ†æ</h3>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆè¯´ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¶…ä¹°çš„é—®é¢˜ã€‚</p>
<p>å¦‚æœå”®è´§æœºæ˜¯å¸¦å±å¹•çš„ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯ä¸ä¼šäº§ç”Ÿè¶…å–é—®é¢˜çš„ã€‚å› ä¸ºå¸¦å±å¹•çš„å”®è´§æœºå®é™…ä¸­å°±åªèƒ½æ˜¯ç‹¬å ç±»å‹çš„æ“ä½œï¼Œä½†æ˜¯å¦‚æœæ˜¯ä¸å¸¦å±å¹•çš„å”®è´§æœºï¼Œç”¨æˆ·å°±éœ€è¦æ‰«æå”®è´§æœºä¸Šçš„äºŒç»´ç æ¥è¿›è¡Œè´­ä¹°æ“ä½œï¼Œ é‚£ä¹ˆå‡è®¾æœ‰ä¸¤ä¸ªç”¨æˆ·åœ¨ç›¸è¿‘çš„æ—¶é—´ç‚¹åœ¨åŒä¸€å°å”®è´§æœºè´­ä¹°äº†åŒä¸€ä¸ªå•†å“ï¼Œ è€Œæ°å¥½è¿™ä»¶å•†å“åªæœ‰ä¸€ä»¶äº†ï¼Œå°±ä¼šå¯èƒ½äº§ç”Ÿè¶…å–çš„é—®é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/495f65418e504665afb86a120b5f23b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=jbsfGFIHihZ1vOMVReOhoXiEQzA%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>ä¸ºä»€ä¹ˆä¼šè¶…å–å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„å›¾ï¼š</p>
<p>è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·çš„è´­ä¹°æ—¶åºå›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ca6945323e04f18aec825913afc50a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=GnRAZbl8YJxasJJaWO6cnI2VUOA%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>å½“ç”¨æˆ·ä¸‹å•æ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰è¦è´­ä¹°çš„å•†å“åœ¨è¯¥å”®è´§æœºçš„åº“å­˜ï¼Œå¦‚æœå½“å‰åº“å­˜ä¸º1ä»¶ï¼Œä¹Ÿæ˜¯å¯ä»¥ä¸‹å•çš„ï¼Œç”¨æˆ·è¿™ä¸ªæ—¶å€™ä¸‹å•å¹¶æ”¯ä»˜ï¼Œæ”¯ä»˜æˆåŠŸåï¼Œæ”¯ä»˜ç³»ç»Ÿå›è°ƒæˆ‘ä»¬çš„è®¢å•å¾®æœåŠ¡ï¼Œè®¢å•å¾®æœåŠ¡å‘å”®è´§æœºå‘é€å‡ºè´§æŒ‡ä»¤ï¼Œå”®è´§æœºç»ˆç«¯æ‰§è¡Œå‡ºè´§ï¼Œå¹¶å‘æœåŠ¡ç«¯ä¸ŠæŠ¥ç»“æœï¼ŒæœåŠ¡ç«¯çš„å”®è´§æœºå¾®æœåŠ¡å†æ‰£å‡åº“å­˜ã€‚è¿™æœŸé—´å…¶å®è‡³å°‘ä¹Ÿéœ€å‡ ç§’å·¦å³çš„æ—¶é—´æ‰èƒ½å®Œæˆã€‚è€Œå¦‚æœåœ¨è¿™æœŸé—´ï¼Œå¦å¤–ä¸€ä¸ªäººä¹Ÿç€æ€¥è´­ä¹°å•†å“ï¼Œæ‰«æå¹¶ä¸‹å•è´­ä¹°åŒä¸€ä¸ªå•†å“ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªäººè´­ä¹°çš„æµç¨‹è¿˜æ²¡æœ‰ç»“æŸï¼Œåº“å­˜è¿˜æ²¡æœ‰æ‰£å‡ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„å•†å“ä»ç„¶è¿˜æœ‰ä¸€ä»¶ï¼Œé‚£ä»–ä»ç„¶å¯ä»¥ä¸‹å•ã€‚ç­‰ä»–æ”¯ä»˜å®Œæˆåï¼Œå”®è´§æœºæ²¡æœ‰å•†å“å¯ä»¥å‡ºè´§äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±äº§ç”Ÿäº†è¶…å–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f68c5d10ad6d4ad0b05f88f19aea71e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=TiN2BJKPmiYAQUf8A1fWk4umJd4%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>è¿™æ ·æˆ‘ä»¬å°±ä¼šäº§ç”Ÿè¶…å–çš„ç°è±¡ã€‚</p>
<h3 data-id="heading-31">4.2 å®ç°æ€è·¯</h3>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³è¶…å–ç°è±¡å‘¢ï¼Ÿæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥è§£å†³ã€‚</p>
<p>user1åœ¨ä¸‹å•å‰éœ€è¦åŠ é”ï¼Œåœ¨æ‰£å‡åº“å­˜åè¦é‡Šæ”¾é”ã€‚è¿™æ ·ï¼Œå°±ç¡®ä¿user2åœ¨ä¸‹å•æ—¶ä¸Šä¸€ä¸ªæµç¨‹æ˜¯å·²ç»è·‘å®Œçš„ï¼Œæ­¤æ—¶çš„åº“å­˜å°±æ˜¯å‡†ç¡®çš„ï¼Œå°±ä¸ä¼šäº§ç”Ÿè¶…å–çš„é—®é¢˜äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d1fc320bf174cacbe4ac0ac47e85d79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491036&amp;x-signature=xO5XE%2FScLggA%2BmfHAW3Zf4wLZ7I%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h3 data-id="heading-32">4.3 ä»£ç å®ç°</h3>
<h4 data-id="heading-33">4.3.1 è®¢å•å¾®æœåŠ¡åŠ é”</h4>
<p>ï¼ˆ1ï¼‰åœ¨è®¢å•å¾®æœåŠ¡çš„pomæ–‡ä»¶å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.lock<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-lock-consul<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰åœ¨è®¢å•å¾®æœåŠ¡çš„é…ç½®ï¼ˆé…ç½®ä¸­å¿ƒï¼‰ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">lock:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">consul</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8500</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åœ¨OrderServiceImplçš„createOrderæ–¹æ³•ä¸­æ·»åŠ åˆ†å¸ƒå¼é”ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ElegentLock</span> eLegentLock;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">OrderEntity</span> <span class="hljs-title function_">createOrder</span>(<span class="hljs-params">PayVO payVO,<span class="hljs-built_in">String</span> platform</span>) {
        <span class="hljs-comment">//åˆ¤æ–­åº“å­˜</span>
        <span class="hljs-keyword">if</span>( !vmService.<span class="hljs-title function_">hasCapacity</span>(payVO.<span class="hljs-title function_">getInnerCode</span>(), <span class="hljs-title class_">Long</span>.<span class="hljs-title function_">valueOf</span>(payVO.<span class="hljs-title function_">getSkuId</span>())) ){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogicException</span>(<span class="hljs-string">"å•†å“åº“å­˜ä¸è¶³"</span>);
        }

        <span class="hljs-comment">//åŠ é”ï¼Œåˆ¤æ–­ä¸Šæ¬¡äº¤æ˜“æ˜¯å¦å®Œæˆ</span>
        <span class="hljs-built_in">boolean</span> lock = eLegentLock.<span class="hljs-title function_">lock</span>(payVO.<span class="hljs-title function_">getInnerCode</span>() + <span class="hljs-string">"-"</span> + payVO.<span class="hljs-title function_">getSkuId</span>(), <span class="hljs-number">60</span>, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span>(!lock){
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogicException</span>(<span class="hljs-string">"ä¸Šä¸€ç¬”äº¤æ˜“æœªå®Œæˆï¼Œè¯·ç¨åï¼"</span>);
        }
        ..................................
    }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-34">4.3.2 å”®è´§æœºå¾®æœåŠ¡é‡Šæ”¾é”</h4>
<p>ï¼ˆ1ï¼‰åœ¨å”®è´§æœºå¾®æœåŠ¡çš„pomæ–‡ä»¶å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.lock<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-lock-consul<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰åœ¨å”®è´§æœºå¾®æœåŠ¡çš„é…ç½®ï¼ˆé…ç½®ä¸­å¿ƒï¼‰ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">lock:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">consul</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8500</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åœ¨VendOutResultHandlerçš„processæ–¹æ³•ä¸­æ·»åŠ é‡Šæ”¾åˆ†å¸ƒå¼é”ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ElegentLock elegentLock;

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">(String s,VendoutResultDTO vendoutResultDTO)</span> <span class="hljs-keyword">throws</span> Exception {
    log.info(<span class="hljs-string">"æ¥æ”¶åˆ°å‡ºè´§ç»“æœ,{}"</span>, vendoutResultDTO);
    ..........       
    <span class="hljs-comment">//é‡Šæ”¾é”</span>
    elegentLock.unLock( vendoutResultDTO.getInnerCode()+<span class="hljs-string">"-"</span>+vendoutResultDTO.getSkuId() );
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-35">5.è¶…æ—¶è®¢å•å¤„ç†æ–¹æ¡ˆ-å»¶è¿Ÿæ¶ˆæ¯</h2>
<h3 data-id="heading-36">5.1 éœ€æ±‚åˆ†æ</h3>
<p>æœ‰å¾ˆå¤šæ—¶å€™ï¼Œç”¨æˆ·ä¸‹å•åï¼Œå¹¶ä¸ä¸€å®šä¼šæ”¯ä»˜ã€‚å¦‚æœç”¨æˆ·ä¸€ç›´ä¸æ”¯ä»˜ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¢å•å²‚ä¸æ˜¯ä¸€ç›´å¤„äºæœªæ”¯ä»˜çŠ¶æ€ï¼Œè¿™å¹¶ä¸åˆ©äºæˆ‘ä»¬çš„è®¢å•ç®¡ç†ï¼Œæˆ‘ä»¬é€šå¸¸çš„åšæ³•æ˜¯è®¾å®šä¸€ä¸ªæ—¶æ•ˆï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œéœ€è¦å°†è¿™ä¸ªè®¢å•æ›´æ”¹ä¸ºæ— æ•ˆçŠ¶æ€ï¼Œå¹¶ä¸”åœ¨æ”¯ä»˜å¹³å°å°†è¿™ç¬”äº¤æ˜“å…³é—­æ‰ã€‚</p>
<h3 data-id="heading-37">5.2 å®ç°æ€è·¯</h3>
<p>ï¼ˆ1ï¼‰åœ¨ä¸‹å•æ—¶ï¼Œé€šè¿‡ACæ¡†æ¶å‘é€å¼‚æ­¥æ¶ˆæ¯ï¼Œå»¶è¿Ÿæ—¶é—´ä¸º5åˆ†é’Ÿã€‚å‘é€å†…å®¹ä¸ºè®¢å•å·</p>
<p>åè®®å°è£…: OrderCheck å°è£…çš„æ˜¯è®¢å•å·</p>
<p>ä¸»é¢˜å°è£…: TopicConfig.ORDER_CHECK_TOPIC</p>
<p>å¦‚æœå»¶è¿Ÿ5åˆ†é’Ÿ,å‰ç¼€ä¸º $delayed/300/</p>
<p>ï¼ˆ2ï¼‰åœ¨è®¢å•æœåŠ¡ä¸­æ¥æ”¶å»¶è¿Ÿæ¶ˆæ¯, ä»åè®®ä¸­è§£æå‡ºè®¢å•å·, æŸ¥è¯¢è®¢å•ï¼Œå¦‚æœæ­¤è®¢å•æœªæ”¯ä»˜åˆ™ä¿®æ”¹ä¸ºæ— æ•ˆè®¢å•ï¼Œå¹¶å…³é—­æ­¤æ”¯ä»˜äº¤æ˜“å•ã€‚</p>
<h3 data-id="heading-38">5.3 ä»£ç å®ç°</h3>
<h4 data-id="heading-39">5.3.1 ä¸»é¢˜å®šä¹‰ä¸åè®®å°è£…</h4>
<p>ï¼ˆ1ï¼‰TopicConfigå®šä¹‰å»¶è¿Ÿè®¢å•ä¸»é¢˜</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
 * å»¶è¿Ÿè®¢å•ä¸»é¢˜
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">static</span> <span class="hljs-type">String</span> ORDER_CHECK_TOPIC = <span class="hljs-string">"server/order/check"</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰service_commonå®šä¹‰OrderCheckDTOï¼Œç”¨äºå°è£…è®¢å•å·</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
 * è®¢å•å»¶è¿Ÿæ£€æŸ¥åè®®ç±»
 */</span>
@Data
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderCheckDTO</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> orderNo;

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-40">5.3.2 å‘é€å»¶è¿Ÿæ¶ˆæ¯</h4>
<p>OrderServiceImplå¼•å…¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ElegentAC elegentAC;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>åœ¨OrderServiceImpl çš„createOrderæ–¹æ³•<strong>ç»“å°¾å¤„</strong>æ·»åŠ ä»¥ä¸‹ä»£ç </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//å°†è®¢å•æ”¾åˆ°å»¶è¿Ÿé˜Ÿåˆ—ä¸­ï¼Œ5åˆ†é’Ÿåæ£€æŸ¥æ”¯ä»˜çŠ¶æ€ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span>
OrderCheckDTO orderCheck = new <span class="hljs-built_in">OrderCheckDTO</span>();
orderCheck<span class="hljs-selector-class">.setOrderNo</span>(orderEntity.getOrderNo());
try {
    elegentAC<span class="hljs-selector-class">.delayPublish</span>(TopicConfig.ORDER_CHECK_TOPIC,orderCheck,<span class="hljs-number">300</span>);
} catch (Exception e) {
    log<span class="hljs-selector-class">.error</span>("send to emq error",e);
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-41">5.3.3 æ¥æ”¶å»¶è¿Ÿæ¶ˆæ¯</h4>
<p>åœ¨è®¢å•æœåŠ¡é¡¹ç›®ä¸­å®ç°æ¥æ”¶åˆ°è¯¥æ¶ˆæ¯çš„å¤„ç†ä»£ç ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * è®¢å•è¶…æ—¶å¤„ç†
 */</span>
<span class="hljs-variable">@Topic</span>(TopicConfig.ORDER_CHECK_TOPIC)
<span class="hljs-variable">@Slf4j</span>
public class OrderCheckHandler implements ACHandler&lt;OrderCheckDTO&gt; {

    <span class="hljs-variable">@Autowired</span>
    private OrderService orderService;

    <span class="hljs-variable">@Autowired</span>
    private ElegentPay elegentPay;

    <span class="hljs-variable">@Override</span>
    public void <span class="hljs-built_in">process</span>(String s, OrderCheckDTO orderCheck) throws Exception {

        <span class="hljs-selector-tag">if</span>(orderCheck == null || Strings.<span class="hljs-built_in">isNullOrEmpty</span>(orderCheck.<span class="hljs-built_in">getOrderNo</span>())) <span class="hljs-selector-tag">return</span>;
        <span class="hljs-comment">//æŸ¥è¯¢è®¢å•</span>
        <span class="hljs-selector-tag">OrderEntity</span> <span class="hljs-selector-tag">orderEntity</span> = <span class="hljs-selector-tag">orderService</span><span class="hljs-selector-class">.getByOrderNo</span>(orderCheck.<span class="hljs-built_in">getOrderNo</span>());
        <span class="hljs-selector-tag">if</span>(orderEntity == null) <span class="hljs-selector-tag">return</span>;
        <span class="hljs-selector-tag">if</span>(orderEntity.<span class="hljs-built_in">getStatus</span>().<span class="hljs-built_in">equals</span>(OrderStatus.ORDER_STATUS_CREATE)){  <span class="hljs-comment">//å¦‚æœæ˜¯æœªæ”¯ä»˜</span>
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"è®¢å•æ— æ•ˆå¤„ç† è®¢å•å·ï¼š{}"</span>,orderCheck.<span class="hljs-built_in">getOrderNo</span>());
            <span class="hljs-selector-tag">orderEntity</span><span class="hljs-selector-class">.setStatus</span>(OrderStatus.ORDER_STATUS_INVALID); <span class="hljs-comment">//æ— æ•ˆçŠ¶æ€</span>
            <span class="hljs-selector-tag">orderService</span><span class="hljs-selector-class">.updateById</span>(orderEntity);
            <span class="hljs-comment">//å…³é—­æ”¯ä»˜</span>
            <span class="hljs-selector-tag">elegentPay</span><span class="hljs-selector-class">.closePay</span>( orderEntity.<span class="hljs-built_in">getOrderNo</span>(),orderEntity.<span class="hljs-built_in">getPayType</span>() );
        }
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-42">æ€»ç»“ï¼š</h3>
<p>ï¼ˆï¼‘ï¼‰è¯·é—®ä½ å¦‚ä½•ç†è§£CAPå®šç† ï¼Ÿ</p>
<p>CAP å®šç†é˜è¿°ä¸€ä¸ªè§‚ç‚¹ï¼š Cï¼ˆä¸€è‡´æ€§ï¼‰Aï¼ˆå¯ç”¨æ€§ï¼‰Pï¼ˆåˆ†åŒºå®¹é”™ï¼‰ ä¸èƒ½åŒæ—¶æ»¡è¶³ã€‚</p>
<p>CPç³»ç»Ÿï¼š ZK \ consul</p>
<p>APç³»ç»Ÿï¼š redis NACOS</p>
<p>ï¼ˆï¼’ï¼‰ä»€ä¹ˆæ˜¯BASEç†è®º</p>
<p>åŸºæœ¬å¯ç”¨ è½¯çŠ¶æ€ æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>ï¼ˆï¼“ï¼‰ä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦ä½¿ç”¨è¿‡åˆ†å¸ƒé”ï¼Ÿ</p>
<p>æ˜¯ï¼Œç”¨è¿‡ã€‚æˆ‘ä»¬ä½¿ç”¨CONSULçš„åŸå› ã€‚[åˆ†æåˆ†å¸ƒå¼é”å•æœºç‰ˆå•ç‚¹æ•…éšœã€çº¢é”æ€§èƒ½æŸå¤±è§’åº¦é€æ­¥åˆ†æ ]</p>
<p>ï¼ˆï¼”ï¼‰ä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦ä½¿ç”¨è¿‡çº¿ç¨‹æ± æŠ€æœ¯ï¼Ÿ</p>
<p>æ˜¯ï¼Œç”¨è¿‡ã€‚</p>
<p>ï¼ˆï¼•ï¼‰åˆ†å¸ƒå¼é”æœ‰å“ªäº›ï¼Ÿ</p>
<p>ï¼ˆï¼–ï¼‰REDISSIONåˆ†å¸ƒå¼é”ä½ æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ç­”ï¼šå¸¸è§æ–¹æ³•ï¼å¼•å‡ºæ¡†æ¶å’ŒCONSULåˆ†å¸ƒå¼é”ã€‚</p>
<p>ï¼ˆï¼—ï¼‰å»¶è¿Ÿæ¶ˆæ¯ä½ é¡¹ç›®ä¸­åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¥½PowerMockï¼Œè½»æ¾æå®šé‚£äº›è®©ä½ å¤´ç–¼çš„å•å…ƒæµ‹è¯•]]></title>    <link>https://juejin.cn/post/7575102209606221850</link>    <guid>https://juejin.cn/post/7575102209606221850</guid>    <pubDate>2025-11-23T08:26:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575102209606221850" data-draft-id="7575119254313844762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¥½PowerMockï¼Œè½»æ¾æå®šé‚£äº›è®©ä½ å¤´ç–¼çš„å•å…ƒæµ‹è¯•"/> <meta itemprop="keywords" content="åç«¯,å•å…ƒæµ‹è¯•"/> <meta itemprop="datePublished" content="2025-11-23T08:26:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaéšæƒ³å½•"/> <meta itemprop="url" content="https://juejin.cn/user/2837192913204935"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¥½PowerMockï¼Œè½»æ¾æå®šé‚£äº›è®©ä½ å¤´ç–¼çš„å•å…ƒæµ‹è¯•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2837192913204935/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaéšæƒ³å½•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:26:47.000Z" title="Sun Nov 23 2025 08:26:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å·²æ”¶å½•è‡³GitHubï¼Œæ¨èé˜…è¯» ğŸ‘‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FBookSea4j%2FJavaRecord" target="_blank" title="https://github.com/BookSea4j/JavaRecord" ref="nofollow noopener noreferrer">Javaéšæƒ³å½•</a></p>
<p>å¾®ä¿¡å…¬ä¼—å·ï¼šJavaéšæƒ³å½•</p>
<p>ç»“åˆÂ <a href="https://juejin.cn/post/7498580969286631434" target="_blank" title="https://juejin.cn/post/7498580969286631434">ä¸ç”¨Mockitoå†™å•å…ƒæµ‹è¯•ï¼Ÿä½ å¯èƒ½åœ¨æµªè´¹ä¸€åŠæ—¶é—´</a>Â é˜…è¯»ä½“éªŒæ›´ä½³ã€‚</p>
<blockquote>
<p>é¢å¯¹æ— æ³•Mockçš„é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•å’Œfinalç±»ï¼ŒPowerMockä¸ºä½ æ‰“å¼€ä¸€æ‰‡æ–°çš„å¤§é—¨</p>
</blockquote>
<p>ä½œä¸ºä¸€åJavaå¼€å‘è€…ï¼Œå•å…ƒæµ‹è¯•æ˜¯æˆ‘ä»¬ä¿è¯ä»£ç è´¨é‡çš„é‡è¦ç¯èŠ‚ã€‚ä½†åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›éš¾ä»¥æµ‹è¯•çš„ä»£ç åœºæ™¯ï¼šé™æ€å·¥å…·ç±»ã€finalç±»ã€ç§æœ‰æ–¹æ³•ç­‰ã€‚ä¼ ç»Ÿçš„Mockitoæ¡†æ¶å¯¹è¿™äº›æƒ…å†µæŸæ‰‹æ— ç­–ï¼Œè€ŒPowerMockçš„å‡ºç°æ­£å¥½è§£å†³äº†è¿™äº›ç—›ç‚¹ã€‚</p>
<h2 data-id="heading-0">PowerMockæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</h2>
<h3 data-id="heading-1">PowerMockçš„æ ¸å¿ƒå®šä½</h3>
<p>PowerMockæ˜¯ä¸€ä¸ªå¼ºå¤§çš„Javaå•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œå®ƒé€šè¿‡æ‰©å±•ç°æœ‰çš„Mockæ¡†æ¶ï¼ˆå¦‚Mockitoå’ŒEasyMockï¼‰ï¼Œæä¾›äº†æ›´å¼ºå¤§çš„Mockèƒ½åŠ›ã€‚<strong>PowerMockçš„æ ¸å¿ƒä»·å€¼åœ¨äºå®ƒèƒ½å¤ŸMocké‚£äº›ä¼ ç»ŸMockå·¥å…·æ— æ³•å¤„ç†çš„æƒ…å†µ</strong>ï¼ŒåŒ…æ‹¬é™æ€æ–¹æ³•ã€finalç±»å’Œæ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ã€‚</p>
<p>ä¸æ™®é€šMockæ¡†æ¶ä¸åŒï¼ŒPowerMockä½¿ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å’Œå­—èŠ‚ç æ“ä½œæŠ€æœ¯ï¼ˆåŸºäºJavassistå’ŒASMåº“ï¼‰ï¼Œåœ¨è¿è¡Œæ—¶ä¿®æ”¹ç±»çš„è¡Œä¸ºï¼Œä»è€Œå®ç°å¯¹è¿™äº›"éš¾ä»¥Mock"çš„åœºæ™¯çš„å®Œå…¨æ§åˆ¶ã€‚</p>
<h3 data-id="heading-2">PowerMockä¸Mockitoçš„å…³ç³»å’ŒåŒºåˆ«</h3>
<p>è™½ç„¶PowerMockå’ŒMockitoéƒ½æ˜¯ç”¨äºå•å…ƒæµ‹è¯•çš„Mockæ¡†æ¶ï¼Œä½†å®ƒä»¬åœ¨åŠŸèƒ½å’Œå®šä½ä¸Šæœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼š</p>
<p><strong>Mockito</strong>æ˜¯ä¸€ä¸ªè½»é‡çº§ã€ç®€å•æ˜“ç”¨çš„Mockæ¡†æ¶ï¼Œé€‚ç”¨äºå¤§å¤šæ•°æ—¥å¸¸æµ‹è¯•åœºæ™¯ã€‚ä½†å®ƒæœ‰æ˜æ˜¾çš„å±€é™æ€§ï¼šæ— æ³•Mocké™æ€æ–¹æ³•ã€finalç±»ã€ç§æœ‰æ–¹æ³•å’Œæ„é€ å‡½æ•°ç­‰ã€‚</p>
<p><strong>PowerMock</strong>åˆ™æ˜¯å¯¹Mockitoçš„å¢å¼ºï¼Œå¡«è¡¥äº†Mockitoçš„åŠŸèƒ½ç©ºç™½ã€‚å®ƒä¸æ˜¯æ›¿ä»£Mockitoï¼Œè€Œæ˜¯ä¸MockitoååŒå·¥ä½œï¼Œå…±åŒæ„å»ºå®Œæ•´çš„å•å…ƒæµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä¸¤è€…æ ¸å¿ƒåŒºåˆ«ä½“ç°åœ¨åº•å±‚å®ç°ä¸Šï¼šMockitoä½¿ç”¨åŠ¨æ€ä»£ç†ï¼ˆCGLIBï¼‰æŠ€æœ¯ï¼Œè€ŒPowerMocké€šè¿‡ä¿®æ”¹å­—èŠ‚ç æ¥å®ç°æ›´å¼ºå¤§çš„Mockèƒ½åŠ›ã€‚</p>
<p>æ­£å› ä¸ºè¿™ç§æ ¹æœ¬å·®å¼‚ï¼ŒPowerMockå¯ä»¥è§£å†³Mockitoæ— æ³•è§£å†³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-3">PowerMockè§£å†³çš„ç—›ç‚¹</h3>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä»¥ä¸‹æµ‹è¯•éš¾é¢˜ï¼š</p>
<ul>
<li><strong>é™æ€å·¥å…·ç±»</strong>ï¼šå¦‚å„ç§Utilç±»ä¸­çš„é™æ€æ–¹æ³•ã€‚</li>
<li><strong>finalç±»å’Œfinalæ–¹æ³•</strong>ï¼šç‰¹åˆ«æ˜¯ç¬¬ä¸‰æ–¹åº“ä¸­çš„finalç±»ã€‚</li>
<li><strong>ç§æœ‰æ–¹æ³•</strong>ï¼šéœ€è¦ç›´æ¥æµ‹è¯•çš„ç§æœ‰æ–¹æ³•é€»è¾‘ã€‚</li>
<li><strong>æ„é€ å‡½æ•°ä¾èµ–</strong>ï¼šæ–¹æ³•å†…éƒ¨é€šè¿‡newåˆ›å»ºçš„å¯¹è±¡ã€‚</li>
<li><strong>é™æ€ä»£ç å—å’Œç³»ç»Ÿç±»</strong>ï¼šå¦‚System.currentTimeMillis()ã€‚</li>
</ul>
<p>è¿™äº›é—®é¢˜ä½¿ç”¨ä¼ ç»ŸMockæ¡†æ¶éš¾ä»¥è§£å†³ï¼Œè€ŒPowerMockä¸ºæ­¤æä¾›äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆ</p>
<h2 data-id="heading-4">ç¯å¢ƒé…ç½®ä¸åŸºæœ¬ç”¨æ³•</h2>
<h3 data-id="heading-5">æ·»åŠ Mavenä¾èµ–</h3>
<p>è¦å¼€å§‹ä½¿ç”¨PowerMockï¼Œé¦–å…ˆéœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ç›¸å…³ä¾èµ–ã€‚ç”±äºPowerMockéœ€è¦ä¸MockitoååŒå·¥ä½œï¼Œéœ€è¦åŒæ—¶æ·»åŠ ä¸¤ä¸ªä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- PowerMock + Mockito ç»„åˆ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.powermock<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>powermock-module-junit4<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.powermock<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>powermock-api-mockito2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>ç‰ˆæœ¬å…¼å®¹æ€§æ³¨æ„</strong>ï¼šç¡®ä¿PowerMockä¸Mockito/JUnitç‰ˆæœ¬åŒ¹é…ï¼Œå…·ä½“å…¼å®¹æ€§å…³ç³»å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</p>
<h3 data-id="heading-6">åŸºæœ¬é…ç½®æ³¨è§£</h3>
<p>ä½¿ç”¨PowerMockéœ€è¦åœ¨æµ‹è¯•ç±»ä¸Šæ·»åŠ å¿…è¦çš„æ³¨è§£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span> <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨PowerMockRunner</span>
<span class="hljs-meta">@PrepareForTest({StaticUtils.class, User.class})</span> <span class="hljs-comment">// å£°æ˜éœ€å¢å¼ºçš„ç±»</span>
<span class="hljs-meta">@PowerMockIgnore("javax.management.*")</span> <span class="hljs-comment">// è§£å†³ç±»åŠ è½½å™¨å†²çª</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceTest</span> {
    <span class="hljs-comment">// æµ‹è¯•å†…å®¹</span>
}
</code></pre>
<ul>
<li><code>@RunWith(PowerMockRunner.class)</code>ï¼šå‘Šè¯‰JUnitä½¿ç”¨PowerMockçš„æµ‹è¯•è¿è¡Œå™¨ã€‚</li>
<li><code>@PrepareForTest</code>ï¼šæŒ‡å®šéœ€è¦è¢«PowerMockä¿®æ”¹çš„ç±»ï¼ˆåŒ…å«é™æ€æ–¹æ³•ã€finalæ–¹æ³•ç­‰çš„ç±»ï¼‰ã€‚</li>
<li><code>@PowerMockIgnore</code>ï¼šè§£å†³ä½¿ç”¨PowerMockåå¯èƒ½å‡ºç°çš„ç±»åŠ è½½å™¨å†²çªé—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-7">PowerMockæ ¸å¿ƒä½¿ç”¨åœºæ™¯è¯¦è§£</h2>
<h3 data-id="heading-8">é™æ€æ–¹æ³•Mock</h3>
<p>é™æ€æ–¹æ³•æ˜¯æœ€å¸¸è§çš„æµ‹è¯•éš¾ç‚¹ä¹‹ä¸€ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹PowerMockå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>åœºæ™¯ç¤ºä¾‹</strong>ï¼šå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé™æ€å·¥å…·ç±»ï¼Œç”¨äºç”Ÿæˆå”¯ä¸€IDï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">generateUniqueId</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®é™…ä¸šåŠ¡ä¸­å¯èƒ½åŒ…å«å¤æ‚çš„é€»è¾‘æˆ–å¤–éƒ¨ä¾èµ–</span>
        <span class="hljs-keyword">return</span> UUID.randomUUID().toString();
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">createOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> IdGenerator.generateUniqueId();
        <span class="hljs-comment">// åˆ›å»ºè®¢å•çš„é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ORDER_"</span> + orderId;
    }
}
</code></pre>
<p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span>
<span class="hljs-meta">@PrepareForTest({IdGenerator.class, OrderService.class})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderServiceTest</span> {
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateOrderWithStaticMock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. å‡†å¤‡é™æ€ç±»çš„Mock</span>
        PowerMockito.mockStatic(IdGenerator.class);
        
        <span class="hljs-comment">// 2. é¢„è®¾é™æ€æ–¹æ³•è¡Œä¸º</span>
        PowerMockito.when(IdGenerator.generateUniqueId()).thenReturn(<span class="hljs-string">"123e4567"</span>);
        
        <span class="hljs-comment">// 3. åˆ›å»ºè¢«æµ‹è¯•å¯¹è±¡å¹¶è°ƒç”¨è¢«æµ‹æ–¹æ³•</span>
        <span class="hljs-type">OrderService</span> <span class="hljs-variable">orderService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderService</span>();
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> orderService.createOrder();
        
        <span class="hljs-comment">// 4. éªŒè¯ç»“æœ</span>
        assertEquals(<span class="hljs-string">"ORDER_123e4567"</span>, result);
        
        <span class="hljs-comment">// 5. éªŒè¯é™æ€æ–¹æ³•è°ƒç”¨ï¼ˆå¿…é¡»è°ƒç”¨ï¼‰</span>
        PowerMockito.verifyStatic(IdGenerator.class);
        IdGenerator.generateUniqueId();
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>mockStatic()</code>æ–¹æ³•ç”¨äºå‘Šè¯‰PowerMockè¦Mockå“ªä¸ªç±»çš„é™æ€æ–¹æ³•</li>
<li>é™æ€æ–¹æ³•çš„Stubbingï¼ˆå®šä¹‰è¡Œä¸ºï¼‰ä¸æ™®é€šMockitoè¯­æ³•ç±»ä¼¼</li>
<li><strong>å¿…é¡»è°ƒç”¨</strong><code>verifyStatic()</code>æ¥éªŒè¯é™æ€æ–¹æ³•çš„è°ƒç”¨ï¼Œä¸”éœ€è¦åœ¨éªŒè¯å‰è°ƒç”¨ä¸€æ¬¡</li>
</ul>
<p><strong>å¸¸è§å‘ç‚¹</strong>ï¼šå¿˜è®°è°ƒç”¨<code>verifyStatic()</code>ä¼šå¯¼è‡´æ— æ³•éªŒè¯é™æ€æ–¹æ³•æ˜¯å¦è¢«æ­£ç¡®è°ƒç”¨ã€‚</p>
<h3 data-id="heading-9">ç§æœ‰æ–¹æ³•Mock</h3>
<p>æµ‹è¯•ç§æœ‰æ–¹æ³•ä¸€ç›´å­˜åœ¨äº‰è®®ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ˆå¦‚å¤æ‚ç®—æ³•éªŒè¯ï¼‰ç¡®å®æœ‰å¿…è¦ç›´æ¥æµ‹è¯•ç§æœ‰æ–¹æ³•ã€‚</p>
<p><strong>åœºæ™¯ç¤ºä¾‹</strong>ï¼šä¸€ä¸ªåŒ…å«å¤æ‚æ ¡éªŒé€»è¾‘çš„UserServiceï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateUser</span><span class="hljs-params">(String username, String password)</span> {
        <span class="hljs-keyword">if</span> (!isValidFormat(username) || !isValidFormat(password)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> internalComplexValidation(username, password);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidFormat</span><span class="hljs-params">(String input)</span> {
        <span class="hljs-comment">// å¤æ‚çš„æ ¼å¼æ ¡éªŒé€»è¾‘</span>
        <span class="hljs-keyword">return</span> input != <span class="hljs-literal">null</span> &amp;&amp; input.length() &gt;= <span class="hljs-number">5</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">internalComplexValidation</span><span class="hljs-params">(String username, String password)</span> {
        <span class="hljs-comment">// éå¸¸å¤æ‚çš„å†…éƒ¨æ ¡éªŒé€»è¾‘</span>
        <span class="hljs-comment">// å¯èƒ½æ¶‰åŠåŠ å¯†ã€æ•°æ®åº“æŸ¥è¯¢ç­‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ç®€åŒ–ç¤ºä¾‹</span>
    }
}
</code></pre>
<p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span>
<span class="hljs-meta">@PrepareForTest(UserService.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceTest</span> {

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPrivateMethod</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ›å»ºè¢«æµ‹ç±»çš„Spyå¯¹è±¡ï¼ˆéƒ¨åˆ†çœŸå®è°ƒç”¨ï¼‰</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>();
        <span class="hljs-type">UserService</span> <span class="hljs-variable">spyService</span> <span class="hljs-operator">=</span> PowerMockito.spy(userService);

        <span class="hljs-comment">// 2. Stubbingï¼šé¢„è®¾ç§æœ‰æ–¹æ³•è¡Œä¸º</span>
        PowerMockito.doReturn(<span class="hljs-literal">true</span>).when(spyService, <span class="hljs-string">"isValidFormat"</span>, Mockito.anyString());

        <span class="hljs-comment">// 3. è°ƒç”¨è¢«æµ‹æ–¹æ³•</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> spyService.validateUser(<span class="hljs-string">"testuser"</span>, <span class="hljs-string">"testpass"</span>);

        <span class="hljs-comment">// 4. éªŒè¯ç»“æœ</span>
        assertTrue(result);

        <span class="hljs-comment">// 5. éªŒè¯ç§æœ‰æ–¹æ³•è¢«è°ƒç”¨ï¼ˆå¯é€‰ï¼‰</span>
        PowerMockito.verifyPrivate(spyService,Mockito.times(<span class="hljs-number">2</span>))
                .invoke(<span class="hljs-string">"isValidFormat"</span>, Mockito.anyString());
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testPrivateMethodWithArguments</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>();
        <span class="hljs-type">UserService</span> <span class="hljs-variable">spyService</span> <span class="hljs-operator">=</span> PowerMockito.spy(userService);

        <span class="hljs-comment">// Mockæœ‰å‚æ•°çš„ç§æœ‰æ–¹æ³•</span>
        PowerMockito.doReturn(<span class="hljs-literal">false</span>)
                .when(spyService, <span class="hljs-string">"internalComplexValidation"</span>, <span class="hljs-string">"user"</span>, <span class="hljs-string">"pass"</span>);

        <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> spyService.validateUser(<span class="hljs-string">"user"</span>, <span class="hljs-string">"pass"</span>);

        assertFalse(result);
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>spy()</code>æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œè¿™æ ·æœªè¢«Mockçš„æ–¹æ³•ä¼šä¿æŒçœŸå®è¡Œä¸ºã€‚</li>
<li>ä½¿ç”¨<code>doReturn().when()</code>è¯­æ³•æ¥Mockç§æœ‰æ–¹æ³•ï¼Œéœ€é€šè¿‡æ–¹æ³•åå­—ç¬¦ä¸²æŒ‡å®šç›®æ ‡æ–¹æ³•ã€‚</li>
<li>å¯ä»¥é€šè¿‡<code>verifyPrivate()</code>éªŒè¯ç§æœ‰æ–¹æ³•çš„è°ƒç”¨ã€‚</li>
</ul>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šä¼˜å…ˆé€šè¿‡å…¬å…±æ–¹æ³•æµ‹è¯•ç§æœ‰é€»è¾‘ï¼Œä»…åœ¨å¤æ‚ç®—æ³•éªŒè¯ç­‰ç‰¹æ®Šåœºæ™¯ä¸‹ç›´æ¥æµ‹è¯•ç§æœ‰æ–¹æ³•ã€‚</p>
<h3 data-id="heading-10">finalç±»ä¸æ–¹æ³•Mock</h3>
<p>finalç±»å’Œæ–¹æ³•ç”±äºå…¶ä¸å¯ç»§æ‰¿æ€§ï¼Œåœ¨ä¼ ç»ŸMockæ¡†æ¶ä¸­æ— æ³•è¢«Mockï¼Œä½†PowerMockå®Œç¾è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p><strong>åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FinalUtility</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">finalMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Final implementation"</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">staticFinalMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Static final implementation"</span>;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">FinalUtility</span> <span class="hljs-variable">utility</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FinalUtility</span>();
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">useFinalClass</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> utility.finalMethod() + <span class="hljs-string">"_processed"</span>;
    }
}
</code></pre>
<p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span>
<span class="hljs-meta">@PrepareForTest({FinalUtility.class, SomeService.class})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeServiceTest</span> {
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFinalClassAndMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºfinalç±»çš„Mockå¯¹è±¡</span>
        <span class="hljs-type">FinalUtility</span> <span class="hljs-variable">mockUtility</span> <span class="hljs-operator">=</span> PowerMockito.mock(FinalUtility.class);
        
        <span class="hljs-comment">// 2. é¢„è®¾finalæ–¹æ³•è¡Œä¸º</span>
        PowerMockito.when(mockUtility.finalMethod()).thenReturn(<span class="hljs-string">"Mocked final"</span>);
        
        <span class="hljs-comment">// 3. å½“åˆ›å»ºçœŸå®å¯¹è±¡æ—¶è¿”å›Mockå¯¹è±¡</span>
        PowerMockito.whenNew(FinalUtility.class).withNoArguments().thenReturn(mockUtility);
        
        <span class="hljs-comment">// 4. æµ‹è¯•</span>
        <span class="hljs-type">SomeService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SomeService</span>();
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> service.useFinalClass();
        
        assertEquals(<span class="hljs-string">"Mocked final_processed"</span>, result);
    }
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStaticFinalMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Mocké™æ€finalæ–¹æ³•</span>
        PowerMockito.mockStatic(FinalUtility.class);
        PowerMockito.when(FinalUtility.staticFinalMethod()).thenReturn(<span class="hljs-string">"Mocked static final"</span>);
        
        assertEquals(<span class="hljs-string">"Mocked static final"</span>, FinalUtility.staticFinalMethod());
    }
}
</code></pre>
<p><strong>åº•å±‚åŸç†</strong>ï¼šPowerMocké€šè¿‡ä¿®æ”¹å­—èŠ‚ç ï¼Œå»é™¤äº†finalæ–¹æ³•çš„finalæ ‡è¯†ç¬¦ï¼Œä»è€Œå…è®¸Mockæ“ä½œã€‚</p>
<h3 data-id="heading-11">æ„é€ å‡½æ•°Mock</h3>
<p>å½“æ–¹æ³•å†…éƒ¨ç›´æ¥é€šè¿‡newåˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼ ç»ŸMockéš¾ä»¥ä»‹å…¥ï¼ŒPowerMockçš„æ„é€ å‡½æ•°MockåŠŸèƒ½ä¸ºæ­¤æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConnection</span> {
    <span class="hljs-keyword">private</span> String connectionString;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DatabaseConnection</span><span class="hljs-params">(String connectionString)</span> {
        <span class="hljs-built_in">this</span>.connectionString = connectionString;
        <span class="hljs-comment">// å¯èƒ½åŒ…å«å¤æ‚çš„åˆå§‹åŒ–é€»è¾‘</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(String sql)</span> {
        <span class="hljs-comment">// æ‰§è¡ŒSQLé€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepository</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(String username)</span> {
        <span class="hljs-comment">// åœ¨æ–¹æ³•å†…éƒ¨ç›´æ¥åˆ›å»ºä¾èµ–å¯¹è±¡</span>
        <span class="hljs-type">DatabaseConnection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseConnection</span>(<span class="hljs-string">"jdbc:mysql://localhost:3306/test"</span>);
        <span class="hljs-keyword">return</span> connection.execute(<span class="hljs-string">"INSERT INTO users VALUES ('"</span> + username + <span class="hljs-string">"')"</span>);
    }
}
</code></pre>
<p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span>
<span class="hljs-meta">@PrepareForTest(UserRepository.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepositoryTest</span> {
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConstructorMock</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ›å»ºMockå¯¹è±¡</span>
        <span class="hljs-type">DatabaseConnection</span> <span class="hljs-variable">mockConnection</span> <span class="hljs-operator">=</span> PowerMockito.mock(DatabaseConnection.class);
        
        <span class="hljs-comment">// 2. é¢„è®¾æ„é€ å‡½æ•°è¡Œä¸º</span>
        PowerMockito.whenNew(DatabaseConnection.class)
                   .withParameterTypes(String.class)
                   .withArguments(<span class="hljs-string">"jdbc:mysql://localhost:3306/test"</span>)
                   .thenReturn(mockConnection);
        
        <span class="hljs-comment">// 3. é¢„è®¾æ–¹æ³•è¡Œä¸º</span>
        PowerMockito.when(mockConnection.execute(Mockito.anyString())).thenReturn(<span class="hljs-literal">true</span>);
        
        <span class="hljs-comment">// 4. æ‰§è¡Œæµ‹è¯•</span>
        <span class="hljs-type">UserRepository</span> <span class="hljs-variable">repository</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRepository</span>();
        <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> repository.saveUser(<span class="hljs-string">"testuser"</span>);
        
        <span class="hljs-comment">// 5. éªŒè¯</span>
        assertTrue(result);
        PowerMockito.verifyNew(DatabaseConnection.class)
                   .withArguments(<span class="hljs-string">"jdbc:mysql://localhost:3306/test"</span>);
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>whenNew()</code>ç”¨äºæ‹¦æˆªæ„é€ å‡½æ•°è°ƒç”¨ã€‚</li>
<li><code>withParameterTypes()</code>å’Œ<code>withArguments()</code>ç”¨äºç²¾ç¡®åŒ¹é…æ„é€ å‡½æ•°ã€‚</li>
<li>éœ€è¦ä½¿ç”¨<code>verifyNew()</code>éªŒè¯æ„é€ å‡½æ•°è°ƒç”¨ã€‚</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºæµ‹è¯•é—ç•™ä»£ç ä¸­åœ¨æ–¹æ³•å†…éƒ¨ç›´æ¥å®ä¾‹åŒ–ä¾èµ–å¯¹è±¡çš„æƒ…å†µã€‚</p>
<h3 data-id="heading-12">é™æ€ä»£ç å—å¤„ç†</h3>
<p>é™æ€ä»£ç å—åœ¨ç±»åŠ è½½æ—¶æ‰§è¡Œï¼Œå¯èƒ½åŒ…å«ä¸æ„¿åœ¨æµ‹è¯•ä¸­è¿è¡Œçš„ä»£ç ï¼ˆå¦‚åˆå§‹åŒ–æ˜‚è´µèµ„æºï¼‰ï¼ŒPowerMockå¯ä»¥æŠ‘åˆ¶é™æ€ä»£ç å—çš„æ‰§è¡Œã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationLoader</span> {
    <span class="hljs-keyword">static</span> {
        <span class="hljs-comment">// é™æ€ä»£ç å—ï¼Œå¯èƒ½åŒ…å«æ˜‚è´µçš„åˆå§‹åŒ–æ“ä½œ</span>
        loadConfigurationFromRemote();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadConfigurationFromRemote</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿæ˜‚è´µçš„åˆå§‹åŒ–</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ä¸åº”è¯¥åœ¨æµ‹è¯•ä¸­æ‰§è¡Œ"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getConfig</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"value"</span>;
    }
}
</code></pre>
<p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RunWith(PowerMockRunner.class)</span>
<span class="hljs-meta">@PrepareForTest(ConfigurationLoader.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationLoaderTest</span> {
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSuppressStaticInitializer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// æŠ‘åˆ¶é™æ€ä»£ç å—æ‰§è¡Œ</span>
        PowerMockito.suppress(PowerMockito.method(ConfigurationLoader.class, <span class="hljs-string">"loadConfigurationFromRemote"</span>));
        
        <span class="hljs-comment">// ç°åœ¨å¯ä»¥å®‰å…¨æµ‹è¯•ï¼Œé™æ€ä»£ç å—ä¸ä¼šæ‰§è¡Œ</span>
        assertNotNull(ConfigurationLoader.getConfig(<span class="hljs-string">"testkey"</span>));
    }
}
</code></pre>
<h2 data-id="heading-13">PowerMockæœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-14">è°¨æ…ä½¿ç”¨PowerMock</h3>
<p>è™½ç„¶PowerMockåŠŸèƒ½å¼ºå¤§ï¼Œä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½æ˜¯ä»£ç è®¾è®¡é—®é¢˜çš„ä¿¡å·ã€‚<strong>ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨åŸåˆ™</strong>ï¼š</p>
<ul>
<li><strong>ä¼˜å…ˆè€ƒè™‘é‡æ„</strong>ï¼šå¦‚æœä»£ç ä¸­å¤§é‡ä½¿ç”¨PowerMockï¼Œåº”è¯¥è€ƒè™‘é‡æ„ä»£ç ä»¥æé«˜å¯æµ‹è¯•æ€§ã€‚ä¾‹å¦‚ï¼Œå°†é™æ€æ–¹æ³•æ”¹ä¸ºå®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥è§£è€¦ç­‰ã€‚</li>
<li><strong>ä»…ç”¨äºé—ç•™ä»£ç </strong>ï¼šåœ¨æ–°é¡¹ç›®ä¸­ï¼Œä¼˜å…ˆé€šè¿‡è‰¯å¥½è®¾è®¡é¿å…ä½¿ç”¨PowerMockï¼Œä»…åœ¨å¤„ç†éš¾ä»¥ä¿®æ”¹çš„é—ç•™ä»£ç æ—¶å¤§é‡ä½¿ç”¨ã€‚</li>
<li><strong>éš”ç¦»ä½¿ç”¨</strong>ï¼šå°†ä½¿ç”¨PowerMockçš„æµ‹è¯•ç±»å•ç‹¬æ”¾ç½®ï¼Œé˜²æ­¢å½±å“å…¶ä»–æµ‹è¯•çš„æ‰§è¡Œæ•ˆç‡ã€‚</li>
</ul>
<h3 data-id="heading-15">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<p>PowerMockç”±äºä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨å’Œå­—èŠ‚ç æ“ä½œï¼Œä¼šå¯¹æµ‹è¯•æ‰§è¡Œæ—¶é—´äº§ç”Ÿæ˜¾è‘—å½±å“ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¼˜åŒ–å»ºè®®ï¼š</p>
<ul>
<li><strong>æœ€å°åŒ–@PrepareForTest</strong>ï¼šåªå°†ç¡®å®éœ€è¦Mockçš„ç±»æ”¾å…¥æ³¨è§£ä¸­ï¼Œå‡å°‘å­—èŠ‚ç æ“ä½œçš„èŒƒå›´ã€‚</li>
<li><strong>åˆç†ä½¿ç”¨Mockito</strong>ï¼šå¯¹äºå¸¸è§„Mockåœºæ™¯ï¼Œä»ç„¶ä½¿ç”¨Mockitoï¼Œä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨PowerMockã€‚</li>
<li><strong>é¿å…è¿‡åº¦Mock</strong>ï¼šä¸è¦Mockç³»ç»Ÿç±»æˆ–ç®€å•å€¼å¯¹è±¡ï¼Œè¿™ä¼šç»™æµ‹è¯•å¸¦æ¥ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚</li>
</ul>
<h3 data-id="heading-16">ç‰ˆæœ¬é€‰æ‹©ä¸å…¼å®¹æ€§</h3>
<p><strong>ç‰ˆæœ¬å…¼å®¹æ€§</strong>ï¼šPowerMockä¸Mockitoã€JUnitçš„ç‰ˆæœ¬å…¼å®¹æ€§éå¸¸é‡è¦ã€‚ä»¥ä¸‹æ˜¯æ¨èç»„åˆï¼š</p>
<ul>
<li>PowerMock 2.x + Mockito 2.x + JUnit 4.12+</li>
<li>é¿å…æ··åˆä½¿ç”¨ä¸å…¼å®¹çš„ç‰ˆæœ¬</li>
</ul>
<p><strong>JUnit 5æ”¯æŒ</strong>ï¼šæˆªè‡³ç›®å‰ï¼ŒPowerMockä¸æ”¯æŒJUnit 5ï¼Œè¿™æ˜¯é€‰æ‹©æµ‹è¯•æ¡†æ¶æ—¶éœ€è¦è€ƒè™‘çš„å› ç´ ã€‚</p>
<h3 data-id="heading-17">å¸¸è§é—®é¢˜æ’æŸ¥</h3>
<p><strong>ç±»åŠ è½½å™¨å†²çª</strong>ï¼šä½¿ç”¨<code>@PowerMockIgnore</code>æ³¨è§£æ’é™¤å†²çªçš„åŒ…ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@PowerMockIgnore({"javax.management.*", "javax.net.ssl.*"})</span>
</code></pre>
<p><strong>ç‰ˆæœ¬å†²çª</strong>ï¼šç¡®ä¿æ‰€æœ‰Mockç›¸å…³åº“çš„ç‰ˆæœ¬å…¼å®¹ã€‚</p>
<p><strong>é™æ€æ–¹æ³•éªŒè¯å¤±è´¥</strong>ï¼šè®°ä½æ¯æ¬¡éªŒè¯é™æ€æ–¹æ³•è°ƒç”¨æ—¶éƒ½è¦å…ˆè°ƒç”¨<code>verifyStatic()</code>ã€‚</p>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>PowerMockè§£å†³äº†ä¼ ç»ŸMockæ¡†æ¶æ— æ³•å¤„ç†çš„æ£˜æ‰‹é—®é¢˜ã€‚é€šè¿‡å­—èŠ‚ç æ“ä½œæŠ€æœ¯ï¼ŒPowerMockèƒ½å¤ŸMocké™æ€æ–¹æ³•ã€finalç±»ã€ç§æœ‰æ–¹æ³•å’Œæ„é€ å‡½æ•°ç­‰"ä¸å¯Mock"çš„å…ƒç´ ã€‚</p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼š</p>
<ul>
<li>å¡«è¡¥äº†Mockitoçš„åŠŸèƒ½ç©ºç™½ï¼Œå®Œå–„äº†Javaå•å…ƒæµ‹è¯•çš„å·¥å…·é“¾ã€‚</li>
<li>ç‰¹åˆ«é€‚ç”¨äºå¤„ç†é—ç•™ä»£ç å’Œç¬¬ä¸‰æ–¹åº“çš„æµ‹è¯•é—®é¢˜ã€‚</li>
<li>é€šè¿‡æé«˜ä»£ç è¦†ç›–ç‡æ¥æå‡è½¯ä»¶è´¨é‡ã€‚</li>
</ul>
<p><strong>é€‚ç”¨è¾¹ç•Œ</strong>ï¼š</p>
<ul>
<li>ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½é€‚åˆä½¿ç”¨PowerMockï¼Œæ–°é¡¹ç›®åº”ä¼˜å…ˆè€ƒè™‘è‰¯å¥½çš„ä»£ç è®¾è®¡ã€‚</li>
<li>åœ¨æµ‹è¯•æ€§èƒ½å’Œä»£ç å¯ç»´æŠ¤æ€§ä¹‹é—´éœ€è¦æƒè¡¡ã€‚</li>
<li>å»ºè®®å°†ä½¿ç”¨èŒƒå›´æ§åˆ¶åœ¨ç¡®å®å¿…è¦çš„å¤æ‚åœºæ™¯ä¸­ã€‚</li>
</ul>
<p>å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ åœ¨å®é™…é¡¹ç›®ä¸­æ›´å¥½åœ°ä½¿ç”¨PowerMockã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–ç»éªŒåˆ†äº«ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºWASMçš„çº¯å‰ç«¯Officeè§£å†³æ–¹æ¡ˆï¼šåœ¨çº¿ç¼–è¾‘/å¯¼å…¥å¯¼å‡º/æƒé™åˆ‡æ¢ï¼ˆå·²å¼€æºï¼‰]]></title>    <link>https://juejin.cn/post/7575425466904723519</link>    <guid>https://juejin.cn/post/7575425466904723519</guid>    <pubDate>2025-11-23T08:32:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575425466904723519" data-draft-id="7575425466904690751" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºWASMçš„çº¯å‰ç«¯Officeè§£å†³æ–¹æ¡ˆï¼šåœ¨çº¿ç¼–è¾‘/å¯¼å…¥å¯¼å‡º/æƒé™åˆ‡æ¢ï¼ˆå·²å¼€æºï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-23T08:32:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Electrolux"/> <meta itemprop="url" content="https://juejin.cn/user/3004311888208296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºWASMçš„çº¯å‰ç«¯Officeè§£å†³æ–¹æ¡ˆï¼šåœ¨çº¿ç¼–è¾‘/å¯¼å…¥å¯¼å‡º/æƒé™åˆ‡æ¢ï¼ˆå·²å¼€æºï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3004311888208296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Electrolux
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:32:31.000Z" title="Sun Nov 23 2025 08:32:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ•ˆæœå±•ç¤º</h2>
<p>æ‰€æœ‰æ“ä½œå‡åœ¨æµè§ˆå™¨è¿›è¡Œï¼Œå…ˆæ¥çœ‹çœ‹æœ€ç»ˆæ•ˆæœï¼š</p>
<p>ğŸŒ <strong>åœ¨çº¿æ¼”ç¤º</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fmvp-onlyoffice.vercel.app%2F" target="_blank" title="https://mvp-onlyoffice.vercel.app/" ref="nofollow noopener noreferrer">mvp-onlyoffice.vercel.app/</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc97b2347465410184d7b237954a61bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxlY3Ryb2x1eA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491695&amp;x-signature=J3BA0nQbpFpxQGMHFE5DLw59lks%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-1">æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º</h3>
<ul>
<li>âœ… <strong>æ–‡æ¡£ä¸Šä¼ </strong>ï¼šæ”¯æŒæœ¬åœ°æ–‡ä»¶ç›´æ¥ä¸Šä¼ </li>
<li>âœ… <strong>å®æ—¶ç¼–è¾‘</strong>ï¼šæµç•…çš„æ–‡æ¡£ç¼–è¾‘ä½“éªŒ</li>
<li>âœ… <strong>æ ¼å¼è½¬æ¢</strong>ï¼šåŸºäºWASMçš„æ–‡æ¡£æ ¼å¼è½¬æ¢</li>
<li>âœ… <strong>å¯¼å‡ºä¿å­˜</strong>ï¼šä¸€é”®å¯¼å‡ºç¼–è¾‘åçš„æ–‡æ¡£</li>
<li>âœ… <strong>æ¨¡å¼åˆ‡æ¢</strong>ï¼šåªè¯»/å¯ç¼–è¾‘æ¨¡å¼è‡ªç”±åˆ‡æ¢</li>
<li>âœ… <strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šä¸­è‹±æ–‡ç•Œé¢æ— ç¼åˆ‡æ¢</li>
</ul>
<h2 data-id="heading-2">æŠ€æœ¯æ¶æ„</h2>
<h3 data-id="heading-3">æ ¸å¿ƒæŠ€æœ¯æ ˆ</h3>
<ul>
<li><strong>React 19</strong> + <strong>Next.js 15</strong>ï¼šç°ä»£åŒ–å‰ç«¯æ¡†æ¶</li>
<li><strong>OnlyOffice SDK</strong>ï¼šå®˜æ–¹JavaScript SDKï¼Œæä¾›æ–‡æ¡£ç¼–è¾‘æ ¸å¿ƒèƒ½åŠ›</li>
<li><strong>WebAssembly (x2t-wasm)</strong>ï¼šæ–‡æ¡£æ ¼å¼è½¬æ¢å¼•æ“</li>
<li><strong>TypeScript</strong>ï¼šç±»å‹å®‰å…¨çš„å¼€å‘ä½“éªŒ</li>
<li><strong>EventBus</strong>ï¼šäº‹ä»¶é©±åŠ¨çš„æ¶æ„è®¾è®¡</li>
<li><strong>IndexedDB</strong>ï¼šWASMæ–‡ä»¶ç¼“å­˜ä¼˜åŒ–</li>
</ul>
<p>tip: äº‹å®ä¸Šä¸ä¾èµ–äº reactï¼Œä½ å¯ä»¥æ‹¿åˆ° é¡¹ç›®ä¸­çš„ src/onlyoffice-comp ,ç„¶åæ¥å…¥åˆ°ä»»ä½•ç³»ç»Ÿä¸­å»ï¼Œæ¥å…¥å±‚å¯ä»¥å‚è€ƒ <code>src/app/excel/page.tsx</code>ç­‰åº”ç”¨å±‚æ–‡ä»¶</p>
<h3 data-id="heading-4">æ¶æ„æµç¨‹å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£
    â†“
Reactç»„ä»¶å±‚
    â†“
EditorManager (ç¼–è¾‘å™¨ç®¡ç†å™¨)
    â†“
X2T Converter (WASMè½¬æ¢å™¨)
    â†“
OnlyOffice SDK (æ–‡æ¡£ç¼–è¾‘å™¨)
    â†“
EventBus (äº‹ä»¶æ€»çº¿)
    â†“
å¯¼å‡º/ä¿å­˜æ–‡æ¡£
</code></pre>
<h2 data-id="heading-5">WASMæ–‡æ¡£è½¬æ¢æ ¸å¿ƒæµç¨‹</h2>
<h3 data-id="heading-6">è½¬æ¢æµç¨‹å›¾è§£</h3>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·é€‰æ‹©æ–‡ä»¶
<span class="hljs-code">    â†“
æµè§ˆå™¨è¯»å–æ–‡ä»¶
    â†“
WASMè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
    â†“
X2Tå¼•æ“æ‰§è¡Œè½¬æ¢
    â†“
ç”ŸæˆäºŒè¿›åˆ¶æ•°æ® + åª’ä½“èµ„æº
    â†“
OnlyOfficeç¼–è¾‘å™¨åŠ è½½
</span></code></pre>
<h3 data-id="heading-7">æ ¸å¿ƒä»£ç å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/onlyoffice-comp/lib/x2t.ts</span>

<span class="hljs-comment">/**
 * X2T å·¥å…·ç±» - è´Ÿè´£æ–‡æ¡£è½¬æ¢åŠŸèƒ½
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">X2TConverter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">x2tModule</span>: <span class="hljs-title class_">EmscriptenModule</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-comment">// æ”¯æŒçš„æ–‡ä»¶ç±»å‹æ˜ å°„</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">DOCUMENT_TYPE_MAP</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">DocumentType</span>&gt; = {
    <span class="hljs-attr">docx</span>: <span class="hljs-string">'word'</span>,
    <span class="hljs-attr">doc</span>: <span class="hljs-string">'word'</span>,
    <span class="hljs-attr">odt</span>: <span class="hljs-string">'word'</span>,
    <span class="hljs-attr">rtf</span>: <span class="hljs-string">'word'</span>,
    <span class="hljs-attr">txt</span>: <span class="hljs-string">'word'</span>,
    <span class="hljs-attr">xlsx</span>: <span class="hljs-string">'cell'</span>,
    <span class="hljs-attr">xls</span>: <span class="hljs-string">'cell'</span>,
    <span class="hljs-attr">ods</span>: <span class="hljs-string">'cell'</span>,
    <span class="hljs-attr">csv</span>: <span class="hljs-string">'cell'</span>,
    <span class="hljs-attr">pptx</span>: <span class="hljs-string">'slide'</span>,
    <span class="hljs-attr">ppt</span>: <span class="hljs-string">'slide'</span>,
    <span class="hljs-attr">odp</span>: <span class="hljs-string">'slide'</span>,
  };

  <span class="hljs-comment">/**
   * è½¬æ¢æ–‡æ¡£æ ¼å¼
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">convertDocument</span>(<span class="hljs-attr">file</span>: <span class="hljs-title class_">File</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ConversionResult</span>&gt; {
    <span class="hljs-comment">// åˆå§‹åŒ–WASMæ¨¡å—</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">ensureReady</span>();
    
    <span class="hljs-comment">// å†™å…¥è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">x2tModule</span>!.<span class="hljs-property">FS</span>.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">'/working/origin'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(data));
    
    <span class="hljs-comment">// æ‰§è¡ŒC++ç¼–è¯‘çš„è½¬æ¢æ¨¡å—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeConversion</span>(<span class="hljs-string">'/working/params.xml'</span>);
    
    <span class="hljs-comment">// æå–è½¬æ¢ç»“æœå’Œåª’ä½“æ–‡ä»¶</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">bin</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">x2tModule</span>!.<span class="hljs-property">FS</span>.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'/working/output.bin'</span>),
      <span class="hljs-attr">media</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">collectMediaFiles</span>() <span class="hljs-comment">// æå–å›¾ç‰‡ç­‰èµ„æº</span>
    };
  }
}
</code></pre>
<h2 data-id="heading-8">ç¼–è¾‘å™¨ç®¡ç†å™¨ï¼šProxyæ¨¡å¼çš„å®‰å…¨å°è£…</h2>
<p>é¡¹ç›®é‡‡ç”¨Proxyæ¨¡å¼å¯¹OnlyOfficeç¼–è¾‘å™¨å®ä¾‹è¿›è¡Œå®‰å…¨å°è£…ï¼Œæä¾›ç»Ÿä¸€çš„APIæ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/onlyoffice-comp/lib/editor-manager.ts</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EditorManager</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">editor</span>: <span class="hljs-title class_">DocEditor</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-comment">// ä½¿ç”¨ Proxy æä¾›å®‰å…¨çš„è®¿é—®æ¥å£</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">createProxy</span>(): <span class="hljs-title class_">DocEditor</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>({} <span class="hljs-keyword">as</span> <span class="hljs-title class_">DocEditor</span>, {
      <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">_target, prop</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">'destroyEditor'</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroy</span>();
        }
        <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">'sendCommand'</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span>.<span class="hljs-title function_">sendCommand</span>(params);
            }
          };
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span> ? (<span class="hljs-variable language_">this</span>.<span class="hljs-property">editor</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[prop] : <span class="hljs-literal">undefined</span>;
      },
    });
  }
  
  <span class="hljs-comment">// å¯¼å‡ºæ–‡æ¡£ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">export</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">SaveDocumentData</span>&gt; {
    <span class="hljs-keyword">const</span> editor = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>();
    <span class="hljs-keyword">if</span> (!editor) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Editor not available'</span>);
    }
    
    <span class="hljs-comment">// è§¦å‘ä¿å­˜</span>
    (editor <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-title function_">downloadAs</span>();
    
    <span class="hljs-comment">// ç­‰å¾…ä¿å­˜äº‹ä»¶</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> onlyofficeEventbus.<span class="hljs-title function_">waitFor</span>(
      <span class="hljs-variable constant_">ONLYOFFICE_EVENT_KEYS</span>.<span class="hljs-property">SAVE_DOCUMENT</span>, 
      <span class="hljs-number">10000</span>
    );
    
    <span class="hljs-keyword">return</span> result;
  }
}
</code></pre>
<h2 data-id="heading-9">äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šEventBusè§£è€¦è®¾è®¡</h2>
<p>é¡¹ç›®é‡‡ç”¨äº‹ä»¶æ€»çº¿æœºåˆ¶ï¼Œå®ç°ç»„ä»¶é—´çš„æ¾è€¦åˆé€šä¿¡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/onlyoffice-comp/lib/eventbus.ts</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">EventKey</span>, <span class="hljs-title class_">Array</span>&lt;<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>&gt;&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  
  <span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span>
  on&lt;K <span class="hljs-keyword">extends</span> <span class="hljs-title class_">EventKey</span>&gt;(<span class="hljs-attr">key</span>: K, <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">data: EventDataMap[K]</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">set</span>(key, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(key)!.<span class="hljs-title function_">push</span>(callback);
  }
  
  <span class="hljs-comment">// ç­‰å¾…äº‹ä»¶è§¦å‘ï¼ˆè¿”å› Promiseï¼‰</span>
  waitFor&lt;K <span class="hljs-keyword">extends</span> <span class="hljs-title class_">EventKey</span>&gt;(<span class="hljs-attr">key</span>: K, timeout?: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">EventDataMap</span>[K]&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> timeoutId = timeout
        ? <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(key, handleEvent);
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Event <span class="hljs-subst">${key}</span> timeout after <span class="hljs-subst">${timeout}</span>ms`</span>));
          }, timeout)
        : <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEvent</span> = (<span class="hljs-params">data: EventDataMap[K]</span>) =&gt; {
        <span class="hljs-keyword">if</span> (timeoutId) <span class="hljs-built_in">clearTimeout</span>(timeoutId);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(key, handleEvent);
        <span class="hljs-title function_">resolve</span>(data);
      };

      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(key, handleEvent);
    });
  }
}
</code></pre>
<h3 data-id="heading-10">æ”¯æŒçš„äº‹ä»¶ç±»å‹</h3>
<ul>
<li><code>saveDocument</code> - æ–‡æ¡£ä¿å­˜å®Œæˆäº‹ä»¶</li>
<li><code>documentReady</code> - æ–‡æ¡£åŠ è½½å°±ç»ªäº‹ä»¶</li>
<li><code>loadingChange</code> - åŠ è½½çŠ¶æ€å˜åŒ–äº‹ä»¶</li>
</ul>
<h2 data-id="heading-11">æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h2>
<h3 data-id="heading-12">1. å›½é™…åŒ–æ”¯æŒ</h3>
<p>é¡¹ç›®å†…ç½®å¤šè¯­è¨€æ”¯æŒï¼Œå¯è‡ªç”±åˆ‡æ¢ä¸­è‹±æ–‡ç•Œé¢ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆ‡æ¢è¯­è¨€</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLanguageSwitch</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> newLang = currentLang === <span class="hljs-string">'zh'</span> ? <span class="hljs-string">'en'</span> : <span class="hljs-string">'zh'</span>;
  <span class="hljs-title function_">setCurrentLang</span>(newLang);
  
  <span class="hljs-comment">// å¦‚æœç¼–è¾‘å™¨å·²å­˜åœ¨ï¼Œé‡æ–°åˆ›å»ºä»¥åº”ç”¨æ–°è¯­è¨€</span>
  <span class="hljs-keyword">if</span> (editorManager.<span class="hljs-title function_">exists</span>()) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleView</span>(fileName, file);
  }
};
</code></pre>
<h3 data-id="heading-13">2. å¯¼å…¥å¯¼å‡ºåŠŸèƒ½</h3>
<p>å®Œæ•´çš„æ–‡æ¡£å¯¼å…¥å¯¼å‡ºèƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¯¼å‡ºæ–‡æ¡£</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">export</span>();
<span class="hljs-comment">// result åŒ…å«: { fileName, fileType, binData, media }</span>

<span class="hljs-comment">// è½¬æ¢å¹¶ä¸‹è½½</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> <span class="hljs-title function_">convertBinToDocument</span>(
  result.<span class="hljs-property">binData</span>, 
  result.<span class="hljs-property">fileName</span>,
  <span class="hljs-variable constant_">FILE_TYPE</span>.<span class="hljs-property">XLSX</span>, 
  result.<span class="hljs-property">media</span>
);

<span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([buffer.<span class="hljs-property">data</span>], {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>
});
<span class="hljs-comment">// æ‰§è¡Œä¸‹è½½æ“ä½œ</span>
</code></pre>
<h3 data-id="heading-14">3. åªè¯»/å¯ç¼–è¾‘æ¨¡å¼åˆ‡æ¢</h3>
<p>çµæ´»çš„æƒé™æ§åˆ¶ï¼Œæ”¯æŒåŠ¨æ€åˆ‡æ¢ç¼–è¾‘æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è®¾ç½®ä¸ºåªè¯»æ¨¡å¼</span>
<span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">setReadOnly</span>(<span class="hljs-literal">true</span>);

<span class="hljs-comment">// åˆ‡æ¢ä¸ºå¯ç¼–è¾‘æ¨¡å¼</span>
<span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">setReadOnly</span>(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// æŸ¥è¯¢å½“å‰æ¨¡å¼</span>
<span class="hljs-keyword">const</span> isReadOnly = editorManager.<span class="hljs-title function_">getReadOnly</span>();
</code></pre>
<p><strong>å®ç°åŸç†</strong>ï¼š</p>
<ul>
<li>ä»åªè¯»åˆ‡æ¢åˆ°å¯ç¼–è¾‘ï¼šé‡æ–°åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹</li>
<li>ä»å¯ç¼–è¾‘åˆ‡æ¢åˆ°åªè¯»ï¼šä½¿ç”¨<code>processRightsChange</code>å‘½ä»¤</li>
</ul>
<h3 data-id="heading-15">4. IndexedDBç¼“å­˜ä¼˜åŒ–</h3>
<p>ä½¿ç”¨IndexedDBç¼“å­˜WASMæ–‡ä»¶ï¼Œå¤§å¹…æå‡äºŒæ¬¡åŠ è½½é€Ÿåº¦ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ‹¦æˆª fetchï¼Œç¼“å­˜ WASM æ–‡ä»¶åˆ° IndexedDB</span>
<span class="hljs-keyword">private</span> <span class="hljs-title function_">interceptFetch</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> originalFetch = <span class="hljs-variable language_">window</span>.<span class="hljs-property">fetch</span>;
  
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">fetch</span> = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">input: RequestInfo | URL</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Response</span>&gt; {
    <span class="hljs-comment">// å…ˆå°è¯•ä»ç¼“å­˜è¯»å–</span>
    <span class="hljs-keyword">const</span> cached = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCachedWasm</span>(url);
    <span class="hljs-keyword">if</span> (cached) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(cached, {
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/wasm'</span> }
      });
    }
    
    <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­ï¼Œä»ç½‘ç»œåŠ è½½å¹¶ç¼“å­˜</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">originalFetch</span>(input);
    <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheWasm</span>(url, arrayBuffer);
    
    <span class="hljs-keyword">return</span> response;
  };
}
</code></pre>
<h2 data-id="heading-16">ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-17">åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createEditorView } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/onlyoffice-comp/lib/x2t'</span>;
<span class="hljs-keyword">import</span> { editorManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/onlyoffice-comp/lib/editor-manager'</span>;

<span class="hljs-comment">// åˆ›å»ºç¼–è¾‘å™¨è§†å›¾</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">createEditorView</span>({
  <span class="hljs-attr">file</span>: fileObject,        <span class="hljs-comment">// File å¯¹è±¡ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-attr">fileName</span>: <span class="hljs-string">'document.xlsx'</span>, <span class="hljs-comment">// æ–‡ä»¶å</span>
  <span class="hljs-attr">isNew</span>: <span class="hljs-literal">false</span>,            <span class="hljs-comment">// æ˜¯å¦æ–°å»ºæ–‡æ¡£</span>
  <span class="hljs-attr">readOnly</span>: <span class="hljs-literal">false</span>,        <span class="hljs-comment">// æ˜¯å¦åªè¯»</span>
  <span class="hljs-attr">lang</span>: <span class="hljs-string">'zh'</span>,             <span class="hljs-comment">// ç•Œé¢è¯­è¨€</span>
});

<span class="hljs-comment">// å¯¼å‡ºæ–‡æ¡£</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">export</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¯¼å‡ºæˆåŠŸ:'</span>, result);
</code></pre>
<h3 data-id="heading-18">Reactç»„ä»¶é›†æˆ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/app/excel/page.tsx</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ExcelPageContent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [readOnly, setReadOnly] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [currentLang, setCurrentLang] = useState&lt;<span class="hljs-string">'zh'</span> | <span class="hljs-string">'en'</span>&gt;(<span class="hljs-string">'zh'</span>);
  
  <span class="hljs-comment">// ä¸Šä¼ æ–‡æ¡£</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleView</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">fileName: <span class="hljs-built_in">string</span>, file?: File</span>) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">initializeOnlyOffice</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">createEditorView</span>({
      file,
      fileName,
      <span class="hljs-attr">isNew</span>: !file,
      readOnly,
      <span class="hljs-attr">lang</span>: currentLang,
    });
  };
  
  <span class="hljs-comment">// å¯¼å‡ºæ–‡æ¡£</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleExport</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">export</span>();
    <span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> <span class="hljs-title function_">convertBinToDocument</span>(
      result.<span class="hljs-property">binData</span>, 
      result.<span class="hljs-property">fileName</span>,
      <span class="hljs-variable constant_">FILE_TYPE</span>.<span class="hljs-property">XLSX</span>, 
      result.<span class="hljs-property">media</span>
    );
    <span class="hljs-comment">// ä¸‹è½½æ–‡ä»¶...</span>
  };
  
  <span class="hljs-comment">// åˆ‡æ¢åªè¯»æ¨¡å¼</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleReadOnly</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> newReadOnly = !readOnly;
    <span class="hljs-title function_">setReadOnly</span>(newReadOnly);
    <span class="hljs-keyword">await</span> editorManager.<span class="hljs-title function_">setReadOnly</span>(newReadOnly);
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* UIç»„ä»¶ */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-19">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-csharp" lang="csharp">mvp-onlyoffice/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/              <span class="hljs-meta"># Next.js åº”ç”¨é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ excel/        <span class="hljs-meta"># Excel ç¼–è¾‘å™¨é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ docs/         <span class="hljs-meta"># Word ç¼–è¾‘å™¨é¡µé¢</span>
â”‚   â”‚   â””â”€â”€ ppt/          <span class="hljs-meta"># PowerPoint ç¼–è¾‘å™¨é¡µé¢</span>
â”‚   â”œâ”€â”€ onlyoffice-comp/  <span class="hljs-meta"># OnlyOffice ç»„ä»¶åº“</span>
â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚       â”œâ”€â”€ editor-manager.ts  <span class="hljs-meta"># ç¼–è¾‘å™¨ç®¡ç†å™¨</span>
â”‚   â”‚       â”œâ”€â”€ x2t.ts             <span class="hljs-meta"># æ–‡æ¡£è½¬æ¢æ¨¡å—</span>
â”‚   â”‚       â”œâ”€â”€ eventbus.ts        <span class="hljs-meta"># äº‹ä»¶æ€»çº¿</span>
â”‚   â”‚       â””â”€â”€ utils.ts            <span class="hljs-meta"># å·¥å…·å‡½æ•°</span>
â”‚   â””â”€â”€ components/       <span class="hljs-meta"># é€šç”¨ç»„ä»¶</span>
â”œâ”€â”€ <span class="hljs-keyword">public</span>/               <span class="hljs-meta"># é™æ€èµ„æº</span>
â”‚   â”œâ”€â”€ web-apps/         <span class="hljs-meta"># OnlyOffice Web åº”ç”¨èµ„æº</span>
â”‚   â”œâ”€â”€ sdkjs/            <span class="hljs-meta"># OnlyOffice SDK èµ„æº</span>
â”‚   â””â”€â”€ wasm/             <span class="hljs-meta"># WebAssembly è½¬æ¢å™¨</span>
â””â”€â”€ onlyoffice-x2t-wasm/  <span class="hljs-meta"># x2t-wasm æºç </span>
</code></pre>
<h2 data-id="heading-20">éƒ¨ç½²æ–¹æ¡ˆ</h2>
<h3 data-id="heading-21">Vercelä¸€é”®éƒ¨ç½²</h3>
<p>é¡¹ç›®å·²é…ç½®é™æ€å¯¼å‡ºï¼Œå¯ç›´æ¥éƒ¨ç½²åˆ°Vercelï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm install

<span class="hljs-comment"># æ„å»ºé¡¹ç›®</span>
npm run build

<span class="hljs-comment"># Vercel ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²</span>
</code></pre>
<p>ğŸŒ <strong>åœ¨çº¿æ¼”ç¤º</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fmvp-onlyoffice.vercel.app%2F" target="_blank" title="https://mvp-onlyoffice.vercel.app/" ref="nofollow noopener noreferrer">mvp-onlyoffice.vercel.app/</a></p>
<h3 data-id="heading-22">é™æ€æ–‡ä»¶éƒ¨ç½²</h3>
<p>é¡¹ç›®æ”¯æŒé™æ€å¯¼å‡ºï¼Œæ„å»ºåçš„æ–‡ä»¶å¯éƒ¨ç½²åˆ°ä»»ä½•é™æ€æ‰˜ç®¡æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ„å»ºé™æ€æ–‡ä»¶</span>
npm run build

<span class="hljs-comment"># è¾“å‡ºç›®å½•: out/</span>
<span class="hljs-comment"># å¯ç›´æ¥éƒ¨ç½²åˆ° GitHub Pagesã€Netlifyã€Nginx ç­‰</span>
</code></pre>
<h2 data-id="heading-23">æŠ€æœ¯ä¼˜åŠ¿æ€»ç»“</h2>













































<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»Ÿæ–¹æ¡ˆ</th><th>æœ¬æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ•°æ®å®‰å…¨</td><td>âŒ éœ€è¦ä¸Šä¼ æœåŠ¡å™¨</td><td>âœ… å®Œå…¨æœ¬åœ°å¤„ç†</td></tr><tr><td>éƒ¨ç½²æˆæœ¬</td><td>âŒ éœ€è¦åç«¯æœåŠ¡</td><td>âœ… çº¯é™æ€éƒ¨ç½²</td></tr><tr><td>æ ¼å¼æ”¯æŒ</td><td>âš ï¸ æœ‰é™æ ¼å¼</td><td>âœ… 30+ç§æ ¼å¼</td></tr><tr><td>ç¦»çº¿ä½¿ç”¨</td><td>âŒ éœ€è¦ç½‘ç»œ</td><td>âœ… å®Œå…¨ç¦»çº¿</td></tr><tr><td>æ€§èƒ½ä¼˜åŒ–</td><td>âš ï¸ ä¾èµ–ç½‘ç»œ</td><td>âœ… IndexedDBç¼“å­˜</td></tr><tr><td>å›½é™…åŒ–</td><td>âš ï¸ éœ€é¢å¤–é…ç½®</td><td>âœ… å†…ç½®æ”¯æŒ</td></tr><tr><td>æƒé™æ§åˆ¶</td><td>âš ï¸ å¤æ‚å®ç°</td><td>âœ… ç®€å•API</td></tr></tbody></table>
<h2 data-id="heading-24">æŠ€æœ¯åŸç†</h2>
<h3 data-id="heading-25">ä½¿ç”¨x2t-wasmæ›¿ä»£OnlyOfficeæœåŠ¡</h3>
<p>ä¼ ç»ŸOnlyOfficeé›†æˆéœ€è¦ï¼š</p>
<ol>
<li>æ­å»ºOnlyOffice Document Server</li>
<li>é…ç½®æ–‡æ¡£è½¬æ¢æœåŠ¡</li>
<li>å¤„ç†æ–‡æ¡£ä¸Šä¼ ä¸‹è½½</li>
<li>ç®¡ç†æœåŠ¡å™¨èµ„æº</li>
</ol>
<p>æœ¬æ–¹æ¡ˆé€šè¿‡WASMæŠ€æœ¯ï¼š</p>
<ol>
<li>åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è¿è¡Œx2tè½¬æ¢å¼•æ“</li>
<li>ä½¿ç”¨è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå¤„ç†æ–‡æ¡£</li>
<li>å®Œå…¨å®¢æˆ·ç«¯åŒ–ï¼Œæ— éœ€æœåŠ¡å™¨</li>
</ol>
<h3 data-id="heading-26">å‚è€ƒé¡¹ç›®</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQihoo360%2Fse-office" target="_blank" title="https://github.com/Qihoo360/se-office" ref="nofollow noopener noreferrer">Qihoo360/se-office</a> - se-officeæ‰©å±•ï¼Œæä¾›åŸºäºå¼€æ”¾æ ‡å‡†çš„å…¨åŠŸèƒ½åŠå…¬ç”Ÿäº§åŠ›å¥—ä»¶</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcryptpad%2Fonlyoffice-x2t-wasm" target="_blank" title="https://github.com/cryptpad/onlyoffice-x2t-wasm" ref="nofollow noopener noreferrer">cryptpad/onlyoffice-x2t-wasm</a> - CryptPad WebAssemblyæ–‡ä»¶è½¬æ¢å·¥å…·</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Franuts%2Fdocument" target="_blank" title="https://github.com/ranuts/document" ref="nofollow noopener noreferrer">ranuts/document</a> - å‚è€ƒé™æ€èµ„æºå®ç°</li>
</ul>
<h2 data-id="heading-27">å¼€æºåœ°å€</h2>
<p>ğŸ”— <strong>GitHubä»“åº“</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyour-username%2Fmvp-onlyoffice" target="_blank" title="https://github.com/your-username/mvp-onlyoffice" ref="nofollow noopener noreferrer">mvp-onlyoffice</a></p>
<h2 data-id="heading-28">æ€»ç»“</h2>
<p>æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„çº¯å‰ç«¯OnlyOfficeé›†æˆæ–¹æ¡ˆï¼Œé€šè¿‡WASMæŠ€æœ¯å®ç°äº†æ–‡æ¡£æ ¼å¼è½¬æ¢çš„æœ¬åœ°åŒ–ï¼Œç»“åˆReactå’ŒOnlyOffice SDKï¼Œæ‰“é€ äº†ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€æ€§èƒ½ä¼˜ç§€çš„æ–‡æ¡£ç¼–è¾‘å™¨ã€‚</p>
<p><strong>æ ¸å¿ƒäº®ç‚¹</strong>ï¼š</p>
<ul>
<li>ğŸš€ çº¯å‰ç«¯æ¶æ„ï¼Œæ— éœ€åç«¯æœåŠ¡</li>
<li>ğŸ”’ æ•°æ®å®Œå…¨æœ¬åœ°åŒ–ï¼Œä¿æŠ¤éšç§å®‰å…¨</li>
<li>âš¡ åŸºäºWASMçš„é«˜æ€§èƒ½è½¬æ¢</li>
<li>ğŸŒ å†…ç½®å›½é™…åŒ–æ”¯æŒ</li>
<li>ğŸ“¦ æ”¯æŒå¯¼å…¥å¯¼å‡º</li>
<li>ğŸ” çµæ´»çš„æƒé™æ§åˆ¶</li>
</ul>
<p>æ¬¢è¿Starå’ŒForkï¼Œä¸€èµ·æ¨åŠ¨å‰ç«¯Officeç¼–è¾‘æŠ€æœ¯çš„å‘å±•ï¼</p>
<hr/>
<p><strong>ç›¸å…³é˜…è¯»</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.onlyoffice.com%2Fzh-CN%2Fdocs%2Fdocs-api%2Fusage-api%2Fconfig%2Fdocument%2F" target="_blank" title="https://api.onlyoffice.com/zh-CN/docs/docs-api/usage-api/config/document/" ref="nofollow noopener noreferrer">OnlyOffice API æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebassembly.org%2F" target="_blank" title="https://webassembly.org/" ref="nofollow noopener noreferrer">WebAssembly å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fapp%2Fbuilding-your-application%2Fdeploying%2Fstatic-exports" target="_blank" title="https://nextjs.org/docs/app/building-your-application/deploying/static-exports" ref="nofollow noopener noreferrer">Next.js é™æ€å¯¼å‡º</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•æ—¥å¿—elkä¹‹ESæ•°æ®æŸ¥è¯¢ä¸æ•°æ®åŒæ­¥]]></title>    <link>https://juejin.cn/post/7575425466904739903</link>    <guid>https://juejin.cn/post/7575425466904739903</guid>    <pubDate>2025-11-23T08:36:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575425466904739903" data-draft-id="7575442779038793770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•æ—¥å¿—elkä¹‹ESæ•°æ®æŸ¥è¯¢ä¸æ•°æ®åŒæ­¥"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-23T08:36:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="360_go_php"/> <meta itemprop="url" content="https://juejin.cn/user/2436173498956695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•æ—¥å¿—elkä¹‹ESæ•°æ®æŸ¥è¯¢ä¸æ•°æ®åŒæ­¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173498956695/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    360_go_php
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:36:47.000Z" title="Sun Nov 23 2025 08:36:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">1.ESæŒä¹…å±‚æŠ€æœ¯<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e71b2815054e41c3a5854e4d2a53f1ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=jlTZBLahH27cIf3s5ZhjweZlzgY%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h2>
<h3 data-id="heading-1">1.1 ESåº”ç”¨åœºæ™¯<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b3f551db8dd4c08b1dfbaa0ad5a3201~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=0BUiIMFn0j%2B1rVYQAvsEZ8InnAA%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</h3>
<p><strong>1å…¨æ–‡æœç´¢</strong></p>
<p>Elasticsearchå¯ä»¥ç”¨äºå®ç°å…¨æ–‡æœç´¢åŠŸèƒ½ï¼Œä¾‹å¦‚æœç´¢å¼•æ“ã€æ–‡æ¡£ç®¡ç†ç³»ç»Ÿã€ç”µå­å•†åŠ¡æœç´¢ç­‰ã€‚å®ƒæ”¯æŒå¤æ‚çš„æŸ¥è¯¢è¯­å¥ã€ä¸­æ–‡åˆ†è¯ã€è¿‘ä¼¼æœç´¢ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å¿«é€Ÿåœ°æœç´¢å¹¶è¿”å›åŒ¹é…çš„ç»“æœã€‚<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3938e6b79c648f2ae9599c9e4f88772~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=T8yNTzVvHw24z45TTIZ%2FnYVi9%2FE%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<p><strong>2æ—¥å¿—åˆ†æ</strong></p>
<p>Elasticsearchå¯ä»¥ç”¨äºå®ç°å®æ—¶æ—¥å¿—åˆ†æï¼Œä¾‹å¦‚ç›‘æ§ç³»ç»Ÿã€å¼‚å¸¸æ—¥å¿—åˆ†æç­‰ã€‚å®ƒå¯ä»¥å¿«é€Ÿåœ°ç´¢å¼•å’Œæœç´¢å¤§é‡çš„æ—¥å¿—æ•°æ®ï¼Œå¹¶æ”¯æŒèšåˆã€å¯è§†åŒ–ç­‰åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜ã€‚ <strong>ELK</strong></p>
<p><strong>3ä¸šåŠ¡åˆ†æ</strong></p>
<p>Elasticsearchå¯ä»¥ç”¨äºå®ç°ä¸šåŠ¡åˆ†æï¼Œä¾‹å¦‚ä¼ä¸šæ•°æ®åˆ†æã€å¸‚åœºè°ƒç ”ç­‰ã€‚å®ƒå¯ä»¥å¯¹æµ·é‡æ•°æ®è¿›è¡Œæœç´¢ã€èšåˆå’Œåˆ†æï¼Œæ”¯æŒå¤šç§æ•°æ®æ ¼å¼å’Œæ•°æ®æºï¼Œä¾‹å¦‚æ•°æ®åº“ã€æ—¥å¿—ã€ç½‘é¡µç­‰ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·äº†è§£ä¸šåŠ¡æƒ…å†µã€å¸‚åœºè¶‹åŠ¿ç­‰ã€‚</p>
<p><strong>4æœç´¢æ¨è</strong></p>
<p>Elasticsearchå¯ä»¥ç”¨äºå®ç°æœç´¢æ¨èåŠŸèƒ½ï¼Œä¾‹å¦‚ç”µå•†æœç´¢æ¨èã€æ–°é—»æ¨èç­‰ã€‚å®ƒå¯ä»¥æ ¹æ®ç”¨æˆ·çš„æœç´¢å†å²ã€è¡Œä¸ºç­‰æ•°æ®ï¼Œè¿›è¡Œä¸ªæ€§åŒ–æ¨èï¼Œå¹¶æ”¯æŒå®æ—¶æ›´æ–°å’Œè°ƒæ•´æ¨èç»“æœã€‚</p>
<p><strong>5åœ°ç†ä¿¡æ¯ç³»ç»Ÿ</strong></p>
<p>Elasticsearchå¯ä»¥ç”¨äºå®ç°åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼Œä¾‹å¦‚åœ°å›¾æœç´¢ã€ä½ç½®åˆ†æç­‰ã€‚å®ƒæ”¯æŒåœ°ç†åæ ‡ç´¢å¼•å’ŒæŸ¥è¯¢ï¼Œå¯ä»¥å¿«é€Ÿåœ°æœç´¢å’Œèšåˆåœ°ç†æ•°æ®ï¼Œå¹¶æ”¯æŒåœ°å›¾å¯è§†åŒ–ç­‰åŠŸèƒ½ã€‚ <strong>GEO</strong></p>
<h3 data-id="heading-2">1.2 ElasticsearchæŒä¹…å±‚æŠ€æœ¯ç›˜ç‚¹</h3>
<ol>
<li><strong>Elasticsearchå®˜æ–¹æä¾›çš„Javaå®¢æˆ·ç«¯</strong>ï¼š Elasticsearchå®˜æ–¹æä¾›äº†Javaå®¢æˆ·ç«¯ï¼ˆ<strong>High-Level REST Clientå’ŒLow-Level REST Client</strong>ï¼‰ï¼Œå¯ä»¥é€šè¿‡Javaä»£ç ä¸ESè¿›è¡Œäº¤äº’ã€‚è¿™äº›å®¢æˆ·ç«¯æä¾›äº†å„ç§APIå’Œæ–¹æ³•ï¼Œç”¨äºæ‰§è¡Œç´¢å¼•ã€æœç´¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œï¼Œå¹¶ä¸”æ”¯æŒä¸ESé›†ç¾¤çš„è¿æ¥å’Œé€šä¿¡ã€‚</li>
<li><strong>Spring Data Elasticsearch</strong>ï¼š Spring Data Elasticsearchæ˜¯SpringDataæ¡†æ¶æä¾›çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºç®€åŒ–ä¸Elasticsearchçš„é›†æˆå’Œæ“ä½œã€‚å¯¹äºæ¯”è¾ƒç®€å•çš„æŸ¥è¯¢æ“ä½œï¼ŒSpring Data Elasticsearchå¯ä»¥æ¯”è¾ƒç®€ä¾¿åœ°å®ç°æŸ¥è¯¢åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºæ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢ï¼Œ<strong>Spring Data Elasticsearchä½¿ç”¨èµ·æ¥ä¾ç„¶æ¯”è¾ƒç¹ç</strong>ï¼Œè€Œä¸”å®ƒçš„ç‰ˆæœ¬æ›´æ–°é€Ÿåº¦è·Ÿä¸ä¸Š Elasticsearchå®˜æ–¹ç‰ˆæœ¬çš„æ›´æ–°é€Ÿåº¦ï¼Œæ‰€ä»¥ä¼ä¸šåº”ç”¨è¾ƒå°‘ã€‚</li>
<li><strong>Jest</strong>ï¼š Jestæ˜¯ä¸€ä¸ªå¼€æºçš„Java HTTPå®¢æˆ·ç«¯åº“ï¼Œä¸“é—¨ç”¨äºä¸Elasticsearchè¿›è¡Œäº¤äº’ã€‚å®ƒæä¾›äº†ä¸€ç»„æ˜“äºä½¿ç”¨çš„APIå’Œæ–¹æ³•ï¼Œå¯ä»¥æ‰§è¡Œç´¢å¼•ã€æœç´¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚Jestå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œå¹¶ä¸”æ”¯æŒä¸ESé›†ç¾¤çš„è¿æ¥å’Œé€šä¿¡ã€‚</li>
<li><strong>Transport Client</strong>ï¼ˆå·²å¼ƒç”¨ï¼‰ï¼š Transport Clientæ˜¯Elasticsearchæ—©æœŸç‰ˆæœ¬ä¸­æä¾›çš„Javaå®¢æˆ·ç«¯ï¼Œè‡ªElasticsearch 7.0ç‰ˆæœ¬èµ·ï¼Œ<strong>Transport Clientå·²è¢«å®˜æ–¹å¼ƒç”¨</strong>ã€‚</li>
<li><strong>Elegent Data Elasticsearch</strong>ï¼šElegent Data Elasticsearchæ˜¯Elegent Dataçš„å­æ¡†æ¶ã€‚Elegent Dataæ˜¯ä¼ æ™ºæ•™è‚²ç ”ç©¶é™¢å¼€å‘çš„ä¸€æ¬¾é’ˆå¯¹NoSQLçš„æŒä¹…å±‚æ¡†æ¶ã€‚Elegent Data Elasticsearch æ”¹å˜äº†å¤§å®¶å¤´ç–¼çš„ElasticsearchæŒä¹…åŒ–æ“ä½œçš„éš¾é¢˜ã€‚å› ä¸ºå®ƒå¯ä»¥<strong>è®©ç”¨æˆ·æŒ‰ç…§myBatisPlusçš„é£æ ¼æ¥æ“ä½œElasticsearch</strong>ï¼Œè½»æ¾ä¸Šæ‰‹ã€‚</li>
</ol>
<p>ä½¿ç”¨Elegent Data Elasticsearchæ¡†æ¶ï¼Œå¯ä»¥è®©ä½ çš„ç¨‹åºæ›´ä¼˜é›…ã€‚æˆ‘ä»¬é€‰æ‹©Elegent Data Elasticsearchæ¡†æ¶ã€‚</p>
<h3 data-id="heading-3">1.3 Elegent Data</h3>
<h4 data-id="heading-4">1.3.1 Elegent Data ç®€ä»‹</h4>
<p>Elegent Dataæ˜¯ä¸€ä¸ªä¼˜é›…çš„NoSQLæ•°æ®æŒä¹…å±‚æ¡†æ¶ã€‚</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨è¿™ä¸ªç»„ä»¶å¯ä»¥è®©ä½ æ›´è½»æ¾ã€æ›´ä¼˜é›…åœ°åœ¨é¡¹ç›®ä¸­æ“ä½œ Elasticsearch ç­‰NoSQLæ•°æ®åº“ï¼Œé£æ ¼ç±»ä¼¼äºMyBatisPlusï¼Œè®©ä½ æ›´ä¸“æ³¨ä¸šåŠ¡ä»£ç çš„å¼€å‘ã€‚</p>
<p>ï¼ˆ2ï¼‰æ”¯æŒç”¨æˆ·è‡ªè¡Œæ‰©å±•ã€‚</p>
<p>å¼€æºé¡¹ç›®åœ°å€ ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fchuanzhiliubei%2Felegent-data" title="https://gitee.com/chuanzhiliubei/elegent-data" target="_blank" ref="nofollow noopener noreferrer">gitee.com/chuanzhiliuâ€¦</a></p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹Elegent Dataæ¡†æ¶çš„ç³»ç»Ÿæ¶æ„å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e56b9e8f6cc44070b5a8a06ba7b073bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=3J7j7sFyDBiZWTDsJIXsqHnLAIE%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h4 data-id="heading-5">1.3.2 Elegent Data Elasticsearchå¿«é€Ÿå…¥é—¨</h4>
<p>ï¼ˆ1ï¼‰åœ¨pomæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.data<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-data-elasticsearch7<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰application.ymlæ·»åŠ é…ç½®</p>
<pre><code class="hljs language-less" lang="less">spring:
  elasticsearch:
    <span class="hljs-attribute">rest</span>:
      <span class="hljs-attribute">uris</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//127.0.0.1:9201</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åˆ›å»ºDTO</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderDTO</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Long</span> id;<span class="hljs-comment">//id</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> orderNo;<span class="hljs-comment">//è®¢å•ç¼–å·</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> innerCode;<span class="hljs-comment">//æœºå™¨ç¼–å·</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> addr;<span class="hljs-comment">//ç‚¹ä½åœ°å€</span>
  
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Long</span> skuId;<span class="hljs-comment">//å•†å“id</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> skuName;<span class="hljs-comment">//å•†å“åç§°</span>
  
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> status;<span class="hljs-comment">//è®¢å•çŠ¶æ€:0-åˆ›å»º;1-æ”¯ä»˜å®Œæˆ;2-å‡ºè´§æˆåŠŸ;3-å‡ºè´§å¤±è´¥;</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> amount;<span class="hljs-comment">//æ”¯ä»˜é‡‘é¢</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> bill;<span class="hljs-comment">//åˆ†è´¦é‡‘é¢</span>

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Integer</span> price;<span class="hljs-comment">//å•†å“é‡‘é¢</span>
  
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ4ï¼‰åˆ›å»ºæœåŠ¡ç±»</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-meta">@Component</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderEsService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Elasticsearch7DataService&lt;OrderDTO&gt;</span> </span>{

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ5ï¼‰åˆ›å»ºControllerç±»ï¼Œæµ‹è¯•åˆ†é¡µæŸ¥è¯¢ã€åˆ—è¡¨æŸ¥è¯¢ã€å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹æ“ä½œã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/order"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderEsService</span> orderEsService;


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/page"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Pager</span>&lt;<span class="hljs-title class_">OrderDTO</span>&gt; <span class="hljs-title function_">findPage</span>(<span class="hljs-params"/>){
        <span class="hljs-title class_">ElegentQueryWapper</span> elegentQueryWapper=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ElegentQueryWapper</span>();
        elegentQueryWapper.<span class="hljs-title function_">from</span>(<span class="hljs-string">"order"</span>)
                .<span class="hljs-title function_">eq</span>(<span class="hljs-string">"status"</span>,<span class="hljs-string">"1"</span>)
                .<span class="hljs-title function_">eq</span>(<span class="hljs-string">"sku_name"</span>,<span class="hljs-string">"ç»Ÿä¸€å¥¶èŒ¶"</span>);
        <span class="hljs-keyword">return</span>  orderEsService.<span class="hljs-title function_">page</span>(elegentQueryWapper,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>);
    }

    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/list"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">OrderDTO</span>&gt; <span class="hljs-title function_">findList</span>(<span class="hljs-params"/>){
        <span class="hljs-title class_">ElegentQueryWapper</span> elegentQueryWapper=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ElegentQueryWapper</span>();
        elegentQueryWapper.<span class="hljs-title function_">from</span>(<span class="hljs-string">"order"</span>);
        <span class="hljs-keyword">return</span>  orderEsService.<span class="hljs-title function_">list</span>(elegentQueryWapper);
    }


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/statistics"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">StatisticsVo</span>&gt; <span class="hljs-title function_">findStatistics</span>(<span class="hljs-params"/>){
        <span class="hljs-title class_">ElegentQueryWapper</span> queryWapper=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ElegentQueryWapper</span>();
        queryWapper.<span class="hljs-title function_">from</span>(<span class="hljs-string">"order"</span>)
                .<span class="hljs-title function_">eq</span>(<span class="hljs-string">"status"</span>,<span class="hljs-string">"1"</span>)
                .<span class="hljs-title function_">count</span>(<span class="hljs-string">"price"</span>).<span class="hljs-title function_">groupBy</span>(<span class="hljs-string">"sku_id"</span>);
        <span class="hljs-keyword">return</span>  orderEsService.<span class="hljs-title function_">statistics</span>(queryWapper);
    }


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/save"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">save</span>(<span class="hljs-params"/>){
        <span class="hljs-title class_">OrderDTO</span> orderDTO=<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
        orderDTO.<span class="hljs-title function_">setId</span>(200L);
        orderDTO.<span class="hljs-title function_">setAddr</span>(<span class="hljs-string">"æµ‹è¯•åœ°å€"</span>);
        orderDTO.<span class="hljs-title function_">setStatus</span>(<span class="hljs-number">1</span>);
        orderEsService.<span class="hljs-title function_">save</span>(<span class="hljs-string">"order"</span>,orderDTO.<span class="hljs-title function_">getId</span>()+<span class="hljs-string">""</span>,orderDTO);
    }


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/update"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"/>){
        <span class="hljs-title class_">OrderDTO</span> orderDTO=<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
        orderDTO.<span class="hljs-title function_">setId</span>(200L);
        orderDTO.<span class="hljs-title function_">setAddr</span>(<span class="hljs-string">"åœ°å€æµ‹è¯•"</span>);
        orderDTO.<span class="hljs-title function_">setStatus</span>(<span class="hljs-number">2</span>);
        orderEsService.<span class="hljs-title function_">update</span>(<span class="hljs-string">"order"</span>,orderDTO.<span class="hljs-title function_">getId</span>()+<span class="hljs-string">""</span>,orderDTO);
    }


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/delete"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params"/>){
        orderEsService.<span class="hljs-title function_">delete</span>(<span class="hljs-string">"order"</span>,<span class="hljs-string">"200"</span>);
    }

    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/findById/{id}"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">OrderDTO</span> <span class="hljs-title function_">findById</span>(<span class="hljs-params"> <span class="hljs-meta">@PathVariable</span>(<span class="hljs-string">"id"</span>) <span class="hljs-built_in">String</span> id</span>){
        <span class="hljs-title class_">OrderDTO</span> order = orderEsService.<span class="hljs-title function_">findById</span>(<span class="hljs-string">"order"</span>, id);
        <span class="hljs-keyword">return</span> order;
    }

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-6">2.è®¢å•æœç´¢</h2>
<h3 data-id="heading-7">2.1 éœ€æ±‚åˆ†æ</h3>
<p>ç”¨æˆ·åœ¨å¾®ä¿¡å°ç¨‹åºä¸­èƒ½å¤Ÿæ ¹æ®æ—¥æœŸèŒƒå›´æ£€ç´¢æŸ¥è¯¢å†å²è®¢å•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b07548397224bcfb5d9018bd3cee06f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=8GB3PidTOi0b2xH0ADOqebXB6BY%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<p>é™¤äº†å°ç¨‹åºï¼Œè¿˜æœ‰ç®¡ç†åå°ä¹Ÿéœ€è¦è®¢å•æŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7b11b093a0b4f4c81e9c0c217a230c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=quf0Q6UnVy%2FYjtURPVeAVNCUxdY%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h3 data-id="heading-8">2.2 å®ç°æ€è·¯</h3>
<p>ï¼ˆ1ï¼‰åœ¨è®¢å•å¾®æœåŠ¡ï¼Œå°è£…æŸ¥è¯¢é€»è¾‘ï¼Œé€šè¿‡ä½¿ç”¨<strong>ElegentDataæŸ¥è¯¢</strong>elasticsearchä¸­çš„è®¢å•æ•°æ®ã€‚</p>
<p>ï¼ˆ2ï¼‰åœ¨Cç«¯ç½‘å…³è·¯ç”±åˆ°è®¢å•å¾®æœåŠ¡</p>
<h3 data-id="heading-9">2.3 ä»£ç å®ç°</h3>
<h4 data-id="heading-10">2.3.1 è®¢å•å¾®æœåŠ¡æœç´¢åŠŸèƒ½çš„å®ç°</h4>
<p>ï¼ˆ1ï¼‰åœ¨è®¢å•å¾®æœåŠ¡çš„pomæ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.data<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-data-elasticsearch7<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰åœ¨è®¢å•å¾®æœåŠ¡çš„é…ç½®ä¸­ï¼ˆé…ç½®ä¸­å¿ƒï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®</p>
<pre><code class="hljs language-less" lang="less">spring:
  elasticsearch:
    <span class="hljs-attribute">rest</span>:
      <span class="hljs-attribute">uris</span>: <span class="hljs-attribute">http</span>:<span class="hljs-comment">//127.0.0.1:9201</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åˆ›å»ºæœç´¢æœåŠ¡ç±» OrderEsService</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-meta">@Component</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderEsService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Elasticsearch7DataService&lt;OrderVO&gt;</span> </span>{

}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ4ï¼‰OrderServiceæ–°å¢æ–¹æ³•</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æœç´¢è®¢å•
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">pageIndex</span>
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">pageSize</span>
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">orderNo</span>
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">openId</span>
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">startDate</span>
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">endDate</span>
 * <span class="hljs-doctag">@return</span>
 */</span>
<span class="hljs-title class_">Pager</span>&lt;<span class="hljs-title class_">OrderVO</span>&gt; <span class="hljs-title function_">search</span>(<span class="hljs-title class_">Integer</span> pageIndex, <span class="hljs-title class_">Integer</span> pageSize, <span class="hljs-title class_">String</span> orderNo, <span class="hljs-title class_">String</span> openId, <span class="hljs-title class_">String</span> startDate, <span class="hljs-title class_">String</span> endDate);
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ5ï¼‰OrderServiceImplå®ç°æ­¤æ–¹æ³•</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderEsService</span> orderEsService;

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">Pager</span>&lt;<span class="hljs-title class_">OrderVO</span>&gt; <span class="hljs-title function_">search</span>(<span class="hljs-params">Integer pageIndex, Integer pageSize, <span class="hljs-built_in">String</span> orderNo, <span class="hljs-built_in">String</span> openId, <span class="hljs-built_in">String</span> startDate, <span class="hljs-built_in">String</span> endDate</span>) {
    <span class="hljs-title class_">ElegentQueryWapper</span> elegentQueryWapper=<span class="hljs-keyword">new</span> <span class="hljs-title class_">ElegentQueryWapper</span>();
    elegentQueryWapper.<span class="hljs-title function_">from</span>(<span class="hljs-string">"order"</span>);
    <span class="hljs-keyword">if</span>(orderNo!=<span class="hljs-literal">null</span>){
        elegentQueryWapper.<span class="hljs-title function_">eq</span>(<span class="hljs-string">"order_no"</span>,orderNo);
    }
    <span class="hljs-keyword">if</span>(openId!=<span class="hljs-literal">null</span>){
        elegentQueryWapper.<span class="hljs-title function_">eq</span>(<span class="hljs-string">"open_id"</span>,openId);
    }
    <span class="hljs-keyword">if</span>(startDate!=<span class="hljs-literal">null</span> &amp;&amp; endDate!=<span class="hljs-literal">null</span>){
        elegentQueryWapper.<span class="hljs-title function_">between</span>(  <span class="hljs-string">"create_time"</span>,startDate, endDate  );
    }
   <span class="hljs-keyword">return</span> orderEsService.<span class="hljs-title function_">page</span>(elegentQueryWapper, pageIndex, pageSize);
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ6ï¼‰OrderControllerè°ƒç”¨ serviceçš„searchæ–¹æ³•</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * æœç´¢
 * @param pageIndex
 * @param pageSize
 * @param orderNo
 * @param openId
 * @param startDate
 * @param endDate
 * @return
 */</span>
<span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/search"</span>)
public Pager&lt;OrderVO&gt; <span class="hljs-built_in">search</span>(
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"pageIndex"</span>,required = false,defaultValue = <span class="hljs-string">"1"</span>) Integer pageIndex,
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"pageSize"</span>,required = false,defaultValue = <span class="hljs-string">"10"</span>) Integer pageSize,
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"orderNo"</span>,required = false,defaultValue = <span class="hljs-string">""</span>) String orderNo,
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"openId"</span>,required = false,defaultValue = <span class="hljs-string">""</span>) String openId,
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"startDate"</span>,required = false,defaultValue = <span class="hljs-string">""</span>) String startDate,
        <span class="hljs-variable">@RequestParam</span>(value = <span class="hljs-string">"endDate"</span>,required = false,defaultValue = <span class="hljs-string">""</span>) String endDate){
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">orderService</span><span class="hljs-selector-class">.search</span>(pageIndex,pageSize,orderNo,openId,startDate,endDate);
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-11">2.3.2 Cç«¯ç½‘å…³è·¯ç”±é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">gateway:</span>
      <span class="hljs-attr">routes:</span>
      <span class="hljs-comment">#è®¢å•å¾®æœåŠ¡</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">order</span>
        <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://order-service</span>
        <span class="hljs-attr">predicates:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/order/**</span>
        <span class="hljs-attr">filters:</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-12">2.4 æµ‹è¯•</h3>
<p>VSCODEçš„æµ‹è¯•è„šæœ¬</p>
<pre><code class="hljs language-css" lang="css">GET http://{{hostname}}:{{port}}/<span class="hljs-attribute">order</span>/search?pageIndex=<span class="hljs-number">1</span>&amp;pageSize=<span class="hljs-number">10</span>&amp;openId=oJ9WJ5MhIS-hiwuUX0GmsHDzqTyQ&amp;startDate=<span class="hljs-number">2020</span>-<span class="hljs-number">01</span>-<span class="hljs-number">01</span>&amp;endDate=<span class="hljs-number">2023</span>-<span class="hljs-number">12</span>-<span class="hljs-number">31</span> HTTP/<span class="hljs-number">1.1</span>
<span class="hljs-attribute">Content</span>-Type: {{contentType}}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-13">3. æ•°æ®åŒæ­¥æŠ€æœ¯</h2>
<p>æˆ‘ä»¬ç°åœ¨å·²ç»å®ç°äº†ESæ•°æ®çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œä½†æ˜¯ESæ•°æ®ä»å“ªé‡Œæ¥å‘€ï¼Ÿè¿™å°±éœ€è¦æ•°æ®åŒæ­¥æŠ€æœ¯å®ç°æ•°æ®ä»Mysqlåˆ°ESçš„æ¬è¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7253a186b274e8b993929be85b8f02f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMzYwX2dvX3BocA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764491806&amp;x-signature=9sICyHlwrTQARGDxLT0VWpQ3Pic%3D" alt="" loading="lazy"/>â€‹</p>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>ç¼–è¾‘</p>
<h3 data-id="heading-14">3.1 æŠ€æœ¯æ–¹æ¡ˆé€‰å‹</h3>
<h4 data-id="heading-15">3.1.1 MQå¼‚æ­¥é€šçŸ¥</h4>
<p>MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰å¼‚æ­¥é€šçŸ¥æ˜¯ä¸€ç§å¸¸è§çš„å¼‚æ­¥é€šä¿¡æ¨¡å¼ï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°è§£è€¦å’Œå¼‚æ­¥å¤„ç†ã€‚å®ƒé€šè¿‡å°†æ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åç”±æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ï¼Œå®ç°äº†æ¶ˆæ¯çš„å¼‚æ­¥ä¼ é€’å’Œå¤„ç†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®çš„å¢åˆ æ”¹æ–¹æ³•æ“ä½œä¸Šï¼Œå‘é€æ•°æ®MQï¼Œ æ¶ˆè´¹è€…æ¥å—æ•°æ®åè¿›è¡Œæ•°æ®çš„åŒæ­¥å¤„ç†ã€‚</p>
<h4 data-id="heading-16">3.1.2 canal</h4>
<p>é˜¿é‡Œçš„Canalæ˜¯ä¸€ç§å¼€æºçš„åˆ†å¸ƒå¼æ•°æ®åº“å¤åˆ¶ä¸å®æ—¶æ•°æ®è®¢é˜…ç³»ç»Ÿã€‚å®ƒç”±é˜¿é‡Œå·´å·´é›†å›¢å¼€å‘ï¼Œæ—¨åœ¨è§£å†³å¤§è§„æ¨¡åˆ†å¸ƒå¼æ•°æ®åº“çš„æ•°æ®åŒæ­¥å’Œå®æ—¶æ•°æ®è®¢é˜…çš„éœ€æ±‚ã€‚</p>
<p>CanalåŸºäºMySQLçš„ä¸»ä»å¤åˆ¶åŸç†ï¼Œé€šè¿‡è§£æMySQLçš„binlogæ—¥å¿—æ¥å®ç°æ•°æ®çš„å¢é‡è®¢é˜…å’ŒåŒæ­¥ã€‚å®ƒæ”¯æŒå¤šç§è®¢é˜…æ–¹å¼ï¼ŒåŒ…æ‹¬åŸºäºæ•°æ®åº“è¡¨çš„å¢é‡è®¢é˜…ã€åŸºäºå…¨å±€äº‹åŠ¡çš„å¢é‡è®¢é˜…ä»¥åŠåŸºäºæ—¶é—´ç‚¹çš„å…¨é‡è®¢é˜…ã€‚Canalå¯ä»¥å°†æ•°æ®åº“çš„å˜æ›´æ•°æ®å®æ—¶åœ°æ¨é€ç»™è®¢é˜…è€…ï¼Œä½¿å¾—è®¢é˜…è€…èƒ½å¤Ÿå®æ—¶è·å–åˆ°æ•°æ®åº“çš„æœ€æ–°æ•°æ®ã€‚</p>
<h4 data-id="heading-17">3.1.3 Elegent Pipe</h4>
<p>ä¼ æ™ºæ•™è‚²ç ”ç©¶é™¢ç ”å‘çš„ä¸€æ¬¾æ•°æ®åŒæ­¥æ¡†æ¶ã€‚å®ƒçš„å®ç°åŸç†ä¸Canalæ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åŸºäºMySQLçš„ä¸»ä»å¤åˆ¶åŸç†ï¼Œé€šè¿‡è§£æMySQLçš„binlogæ—¥å¿—æ¥å®ç°æ•°æ®çš„å¢é‡è®¢é˜…å’ŒåŒæ­¥ã€‚ä¸Canalä¸åŒçš„æ˜¯ï¼ŒElegent Pipe æ˜¯åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒæœåŠ¡ç«¯å¤„ç†ç›‘å¬åï¼Œé€šè¿‡ElegentACå°†æ•°æ®åº“å˜åŠ¨çš„å†…å®¹å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ElegentPipe æ›´é€‚åˆå¾®æœåŠ¡æ¶æ„åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚</p>
<p>å¼€æºé¡¹ç›®åœ°å€ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fchuanzhiliubei%2Felegent-pipe" title="https://gitee.com/chuanzhiliubei/elegent-pipe" target="_blank" ref="nofollow noopener noreferrer">gitee.com/chuanzhiliuâ€¦</a></p>
<h3 data-id="heading-18">3.2 Elegent Pipeå¿«é€Ÿå…¥é—¨</h3>
<h4 data-id="heading-19">3.2.1 å¼€å¯binlog</h4>
<p>mysql8æ˜¯é»˜è®¤å¼€å¯binlogçš„ ï¼Œmysql5.7é»˜è®¤ä¸å¼€å¯.</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹binlogæ˜¯å¦å¼€å¯</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%log_bin%'</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¦å¼€å¯MySQLçš„binlogï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p>
<ol>
<li>ç¼–è¾‘MySQLçš„é…ç½®æ–‡ä»¶ <code>my.cnf</code> æˆ– <code>my.ini</code>ï¼Œå…·ä½“ä½ç½®æ ¹æ®æ‚¨çš„æ“ä½œç³»ç»Ÿå’ŒMySQLç‰ˆæœ¬è€Œå®šã€‚</li>
<li>æ‰¾åˆ°å¹¶ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[mysqld]</span>
<span class="hljs-attr">log-bin</span>=mysql-bin
<span class="hljs-attr">server-id</span>=<span class="hljs-number">1</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<ul>
<li>
<ul>
<li><code>log-bin</code>ï¼šæŒ‡å®šbinlogæ—¥å¿—æ–‡ä»¶çš„å‰ç¼€åç§°ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰ã€‚</li>
<li><code>server-id</code>ï¼šæŒ‡å®šMySQLå®ä¾‹çš„å”¯ä¸€æ ‡è¯†ï¼Œæ¯ä¸ªMySQLå®ä¾‹éœ€è¦æœ‰ä¸åŒçš„server-idã€‚</li>
</ul>
</li>
</ul>
<ol>
<li>ä¿å­˜å¹¶é€€å‡ºé…ç½®æ–‡ä»¶ã€‚</li>
<li>é‡å¯MySQLæœåŠ¡ï¼Œä»¥ä½¿é…ç½®ç”Ÿæ•ˆã€‚</li>
</ol>
<p>å¼€å¯binlogåï¼ŒMySQLå°†å¼€å§‹è®°å½•æ‰€æœ‰çš„æ•°æ®åº“æ›´æ”¹æ“ä½œï¼Œå¹¶å°†å…¶å†™å…¥binlogæ–‡ä»¶ä¸­ã€‚è¿™äº›binlogæ–‡ä»¶å¯ä»¥ç”¨äºæ•°æ®æ¢å¤ã€æ•°æ®å¤‡ä»½ã€æ•°æ®åŒæ­¥ç­‰ç”¨é€”ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨ä¿®æ”¹MySQLé…ç½®æ–‡ä»¶ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å¯¹MySQLæœ‰è¶³å¤Ÿçš„æƒé™ï¼Œå¹¶ä¸”å¤‡ä»½äº†é‡è¦çš„æ•°æ®ã€‚æ­¤å¤–ï¼Œå¼€å¯binlogä¼šå¢åŠ MySQLçš„å†™å…¥è´Ÿè½½ï¼Œå› æ­¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”è¯¥æ ¹æ®ç³»ç»Ÿçš„æ€§èƒ½å’Œèµ„æºæƒ…å†µè¿›è¡Œè¯„ä¼°å’Œè°ƒæ•´ã€‚</p>
<h4 data-id="heading-20">3.2.2 ä»£ç å®ç°</h4>
<p>ï¼ˆ1ï¼‰åœ¨æœåŠ¡ç«¯çš„å·¥ç¨‹å¼•å…¥ä¾èµ– ï¼ˆç”±äºElegentPipeä¾èµ–ElegentACï¼Œæ‰€ä»¥è¿˜è¦å¼•å…¥elegent-AC-mqtt ï¼‰</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.pipe<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-pipe-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.ac<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-AC-mqtt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰åœ¨æœåŠ¡ç«¯çš„é…ç½®å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">pipe:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">3306</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">passwd:</span> <span class="hljs-string">HuangShu_2023</span>
    <span class="hljs-attr">tables:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">demo:users</span>
  <span class="hljs-attr">ac:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">1883</span>
    <span class="hljs-attr">clientId:</span> <span class="hljs-string">transmitServer</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">public</span>
    <span class="hljs-attr">keepAliveInterval:</span> <span class="hljs-number">30</span>
    <span class="hljs-attr">connectionTimeout:</span> <span class="hljs-number">60</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8888</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰åœ¨å®¢æˆ·ç«¯å·¥ç¨‹å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.pipe<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-pipe-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.ac<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-AC-mqtt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ4ï¼‰åœ¨å®¢æˆ·ç«¯å·¥ç¨‹çš„é…ç½®æ–‡ä»¶æ·»åŠ </p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">ac:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">1883</span>
    <span class="hljs-attr">clientId:</span> <span class="hljs-string">transmitClient</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">public</span>
    <span class="hljs-attr">keepAliveInterval:</span> <span class="hljs-number">30</span>
    <span class="hljs-attr">connectionTimeout:</span> <span class="hljs-number">60</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ5ï¼‰åœ¨å®¢æˆ·ç«¯å·¥ç¨‹æ·»åŠ ç±»ç”¨äºå¤„ç†æ•°æ®å¢åˆ æ”¹ä¹‹åçš„æ“ä½œ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@ElegentPipe</span>(db=<span class="hljs-string">"demo"</span>,table = <span class="hljs-string">"users"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserTransmit</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PipeService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">insertHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹å‰æ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getBefore</span>());
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹åæ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getAfter</span>());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹å‰æ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getBefore</span>());
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹åæ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getAfter</span>());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deleteHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹å‰æ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getBefore</span>());
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä¿®æ”¹åæ•°æ®ï¼š"</span>+transmitDTO.<span class="hljs-title function_">getAfter</span>());
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-21">3.2.3 å¸¸è§é”™è¯¯</h4>
<p>Javaç›‘å¬mysqlçš„binlog æŠ¥é”™è§£å†³åŠæ³•</p>
<p>æŠ¥é”™ï¼šcom.github.shyiko.mysql.binlog.network.AuthenticationException: Client does not support authentication protocol requested by server; consider upgrading MySQL client</p>
<p>è¿™æ˜¯ä½ çš„mysqlè®¤è¯è§„åˆ™ä¸æ­£ç¡®å¯¼è‡´çš„ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šåœ¨mysqlä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">user</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> identified <span class="hljs-keyword">with</span> mysql_native_password <span class="hljs-keyword">by</span> <span class="hljs-string">'å¯†ç '</span>;  <span class="hljs-comment">--ä¿®æ”¹è®¤è¯è§„åˆ™</span>
flush privileges; <span class="hljs-comment">--åˆ·æ–°æƒé™</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-22">4. è®¢å•æ•°æ®åŒæ­¥</h2>
<h3 data-id="heading-23">4.1 éœ€æ±‚åˆ†æ</h3>
<p>å°†è®¢å•åº“ä¸­çš„è®¢å•è¡¨æ•°æ®ï¼ŒåŒæ­¥åˆ°ESä¸­</p>
<h3 data-id="heading-24">4.2 å®ç°æ€è·¯</h3>
<p>ï¼ˆ1ï¼‰åˆ›å»ºæ•°æ®åŒæ­¥çš„æœåŠ¡ç«¯æ¨¡å—ï¼Œå¼•å…¥elegent-pipe-serverä»¥åŠSpringbootä¾èµ–</p>
<p>ï¼ˆ2ï¼‰åœ¨æœåŠ¡ç«¯æ¨¡å—é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®ç›‘å¬dkd_orderåº“çš„tb_orderè¡¨ã€‚</p>
<p>ï¼ˆ3ï¼‰åœ¨è®¢å•å¾®æœåŠ¡å¼•å…¥elegent-pipe-client</p>
<p>ï¼ˆ4ï¼‰ç¼–å†™æ•°æ®å¤„ç†ç±»ï¼Œæ¥æ”¶æ•°æ®ï¼Œå¹¶é€šè¿‡Elegent Data Elasticsearchå°†æ•°æ®ä¿å­˜åˆ° elasticsearchä¸­ã€‚</p>
<h3 data-id="heading-25">4.3 ä»£ç å®ç°</h3>
<h4 data-id="heading-26">4.3.1 æ„å»ºæ•°æ®åŒæ­¥æœåŠ¡</h4>
<p>ï¼ˆ1ï¼‰åˆ›å»ºdkd_pipe_serviceæ¨¡å—,Pomæ–‡ä»¶å¼•å…¥elegent-pipe-serverä»¥åŠSpringbootä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.pipe<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-pipe-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.ac<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-AC-mqtt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">elegent:</span>
  <span class="hljs-attr">pipe:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">3306</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
    <span class="hljs-attr">passwd:</span> <span class="hljs-string">HuangShu_2023</span>
    <span class="hljs-attr">tables:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">dkd_order:tb_order</span>
  <span class="hljs-attr">ac:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">1883</span>
    <span class="hljs-attr">clientId:</span> <span class="hljs-string">transmitServer</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">public</span>
    <span class="hljs-attr">keepAliveInterval:</span> <span class="hljs-number">30</span>
    <span class="hljs-attr">connectionTimeout:</span> <span class="hljs-number">60</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">pipe-service</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8999</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ3ï¼‰æ·»åŠ å¯åŠ¨ç±»</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransmitServerApplication</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>){
        <span class="hljs-title class_">SpringApplication</span>.<span class="hljs-title function_">run</span>(<span class="hljs-title class_">TransmitServerApplication</span>.<span class="hljs-property">class</span>, args);
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-27">4.3.2 åŒæ­¥é€»è¾‘çš„å®ç°</h4>
<p>ï¼ˆ1ï¼‰è®¢å•å¾®æœåŠ¡ æ·»åŠ ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.elegent.pipe<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elegent-pipe-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰è®¢å•å¾®æœåŠ¡ åˆ›å»ºæ•°æ®åŒæ­¥å¤„ç†ç±»</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * æ¥å—è®¢å•æ•°æ®åŒæ­¥
 */</span>
<span class="hljs-meta">@ElegentPipe</span>(db=<span class="hljs-string">"dkd_order"</span>,table = <span class="hljs-string">"tb_order"</span>)
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderPipe</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PipeService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">OrderEsService</span> orderEsService;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">insertHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Serializable</span>&gt; orderMap = transmitDTO.<span class="hljs-title function_">getAfter</span>();
        orderEsService.<span class="hljs-title function_">save</span>(<span class="hljs-string">"order"</span>, (<span class="hljs-title class_">Long</span>)orderMap.<span class="hljs-title function_">get</span>(<span class="hljs-string">"id"</span>)+<span class="hljs-string">""</span>,orderMap );
        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ESæ’å…¥è®¢å•æ•°æ®{}"</span>,orderMap);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Serializable</span>&gt; orderMap = transmitDTO.<span class="hljs-title function_">getAfter</span>();
        orderEsService.<span class="hljs-title function_">update</span>(<span class="hljs-string">"order"</span>,(<span class="hljs-title class_">Long</span>)orderMap.<span class="hljs-title function_">get</span>(<span class="hljs-string">"id"</span>)+<span class="hljs-string">""</span>,orderMap );
        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ESä¿®æ”¹è®¢å•æ•°æ®{}"</span>,orderMap);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deleteHandler</span>(<span class="hljs-params">TransmitDTO transmitDTO</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Serializable</span>&gt; orderMap = transmitDTO.<span class="hljs-title function_">getBefore</span>();
        orderEsService.<span class="hljs-title function_">delete</span>(<span class="hljs-string">"order"</span>,(<span class="hljs-title class_">Long</span>)orderMap.<span class="hljs-title function_">get</span>(<span class="hljs-string">"id"</span>)+<span class="hljs-string">""</span>);
        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ESåˆ é™¤è®¢å•æ•°æ®{}"</span>,orderMap);
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¿« 2026 å¹´äº†ï¼Œè°è¿˜åœ¨ä¸º this æŒ å¤´ï¼Ÿçœ‹å®Œè¿™ç¯‡è®©ä½ å½»åº•ä»æ‡µåœˆåˆ°ç²¾é€š]]></title>    <link>https://juejin.cn/post/7575807729722359842</link>    <guid>https://juejin.cn/post/7575807729722359842</guid>    <pubDate>2025-11-23T08:00:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575807729722359842" data-draft-id="7575104251866284042" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¿« 2026 å¹´äº†ï¼Œè°è¿˜åœ¨ä¸º this æŒ å¤´ï¼Ÿçœ‹å®Œè¿™ç¯‡è®©ä½ å½»åº•ä»æ‡µåœˆåˆ°ç²¾é€š"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,Node.js"/> <meta itemprop="datePublished" content="2025-11-23T08:00:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£æ­¢ä½•å®‰å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/2517239724512420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¿« 2026 å¹´äº†ï¼Œè°è¿˜åœ¨ä¸º this æŒ å¤´ï¼Ÿçœ‹å®Œè¿™ç¯‡è®©ä½ å½»åº•ä»æ‡µåœˆåˆ°ç²¾é€š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517239724512420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£æ­¢ä½•å®‰å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:00:36.000Z" title="Sun Nov 23 2025 08:00:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å„ä½ å‰ç«¯er ä»¬ï¼Œè°è¿˜æ²¡è¢« JavaScript é‡Œçš„Â <code>this</code>Â è™è¿‡ï¼Ÿè¿™ç©æ„ç®€ç›´å°±æ˜¯ç¼–ç¨‹ç•Œçš„ <strong>â€œå˜è„¸å¤§å¸ˆâ€</strong>ï¼Œç¿»è„¸æ¯”å­™çŒ´å­è¿˜å¿«ã€‚ä¸€ä¼šå„¿æ˜¯å…¨å±€å¯¹è±¡ï¼Œä¸€ä¼šå„¿æ˜¯æŸä¸ªå®ä¾‹ï¼Œä¸€ä¼šå„¿åˆè·Ÿç€è°ƒç”¨åœºæ™¯æ”¹å¤´æ¢é¢ï¼Œè¿™ä¸å°±æ˜¯æ´»ç”Ÿç”Ÿçš„ â€œç™¾å˜é©¬ä¸â€ å—ï¼Ÿå†™ä»£ç æ—¶æ€»è¢«å®ƒæå¾—æ™•å¤´è½¬å‘ï¼Œè°ƒè¯•åŠå¤©å°±å› ä¸ºÂ <code>this</code>Â æŒ‡å‘ä¸å¯¹ï¼ŒçœŸæœ‰ç§ <strong>â€œä¸€æ¯èŒ¶ä¸€åŒ…çƒŸï¼Œä¸€ä¸ªthisæ”¹ä¸€å¤©â€</strong> çš„å´©æºƒæ„Ÿã€‚å¦‚æœä½ è¿˜æä¸æ‡‚ JavaScript é‡Œé¢çš„ <code>this</code>,é‚£è¿™ç¯‡å°†è®©ä½ æå®šåŸç†å¹¶ä¸”æ‹¿æç”¨æ³•ï¼ŒæŠŠé‚£äº›ç»•äººçš„ç»‘å®šè§„åˆ™æ°æ‰¯å¾—æ˜æ˜ç™½ç™½ï¼</p>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆè¦æœ‰ thisï¼Ÿâ€”â€” è®©ä»£ç  â€œä¼˜é›…åˆ°é£èµ·â€</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å†™äº†ä¸ªå‡½æ•°ï¼Œæƒ³åœ¨ä¸åŒå¯¹è±¡ä¸Šå¤ç”¨å®ƒã€‚è¦æ˜¯æ²¡æœ‰<code>this</code>ï¼Œå°±å¾—æ¯æ¬¡æ‰‹åŠ¨ä¼ å¯¹è±¡å‚æ•°ï¼Œæƒ³æƒ³éƒ½éº»çƒ¦ï¼<code>this</code>å°±åƒä¸ª â€œæ™ºèƒ½ä»£è¯â€ï¼Œæ‚„å’ªå’ªåœ°å¸®æˆ‘ä»¬ä¼ é€’å¯¹è±¡å¼•ç”¨ã€‚é€šä¿—æ¥è¯´å°±æ˜¯ <code>this</code> æä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼æ¥éšå¼çš„ä¼ é€’ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå¯ä»¥è®©ä»£ç æ›´ç®€æ´æ˜“äºå¤ç”¨ã€‚</p>
<p>æ¯”å¦‚ä¸‹é¢è¿™ä¸¤ç§å†™æ³•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">function <span class="hljs-built_in">identify</span>(context) {
    return context<span class="hljs-selector-class">.name</span><span class="hljs-selector-class">.toUpperCase</span>();
}
function <span class="hljs-attribute">speak</span>(context) {
    <span class="hljs-selector-tag">var</span> greet = 'hello, <span class="hljs-selector-tag">I</span> am ' + <span class="hljs-built_in">identify</span>(context);
    console<span class="hljs-selector-class">.log</span>(greet);
}
<span class="hljs-selector-tag">var</span> myname = {
    name: <span class="hljs-string">'henry'</span>
}
<span class="hljs-attribute">speak</span>(myname);
</code></pre>
<p>æˆ‘ä»¬å®šä¹‰Â <code>identify</code>Â å‡½æ•°æ¥æ”¶å¯¹è±¡å‚æ•°ï¼Œè¿”å›å…¶Â <code>name</code>Â å¤§å†™å€¼ï¼›<code>speak</code>Â å‡½æ•°æ¥æ”¶å¯¹è±¡ï¼Œè°ƒç”¨Â <code>identify</code>Â æ‹¼æ¥é—®å€™è¯­å¹¶æ‰“å°ï¼›æœ€ååˆ›å»ºå«Â <code>name</code>Â çš„Â <code>myname</code>Â å¯¹è±¡ï¼Œä¼ ç»™Â <code>speak</code>Â æ‰§è¡Œï¼Œè¾“å‡ºÂ <code>hello, I am HENRY</code>ã€‚æ ¸å¿ƒæ˜¯<strong>æ‰‹åŠ¨ä¼ é€’</strong>å¯¹è±¡å‚æ•°å®ç°å¤ç”¨ã€‚</p>
<p>è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cf3a10c989a48f8bbad9aa01b590edb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=ndRrkutsgIwH9NLuQh1awex5y9I%3D" alt="image.png" loading="lazy"/></p>
<p>ç»“æœæ²¡é”™ï¼Œ<code>henry</code> ç¡®ç¡®å®å®å¤§å†™äº†ï¼Œä½†æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨ä¼ å‚ä½ è‡ªå·±ä¸å«Œéº»çƒ¦å—ï¼Ÿè¿™æ—¶å€™æˆ‘ä»¬è¯·å‡ºå¤§åé¼é¼çš„--<code>this</code>ï¼</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">identify</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>.<span class="hljs-title function_">toUpperCase</span>();
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> greet = <span class="hljs-string">'hello, I am '</span> + identify.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(greet);
}
<span class="hljs-keyword">var</span> myname = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'henry'</span>
}
speak.<span class="hljs-title function_">call</span>(myname);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a11d00940b6d4722a15f8e2ae7f6adc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=mXiVLKZgc7NIU3nAsGcl%2Bo3FJYs%3D" alt="image.png" loading="lazy"/></p>
<p>è¯¶ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘2ä¸ªå‡½æ•°éƒ½æ²¡æœ‰ä¼ å‚ï¼Œä½†æ˜¯éƒ½è¾“å‡ºäº†ç»“æœã€‚è¿™é‡Œæœ‰2ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>ç”¨Â <code>call</code>Â å¼ºåˆ¶è®©Â <code>speak</code>Â çš„Â <code>this</code>Â æŒ‡å‘Â <code>myname</code>ï¼›</li>
<li><code>speak</code>Â å†…éƒ¨è°ƒç”¨Â <code>identify.call(this)</code>Â æ—¶ï¼Œ<code>this</code>Â å·²ç»‘å®šÂ <code>myname</code>ï¼Œå› æ­¤Â <code>identify</code>Â ä¹Ÿèƒ½è®¿é—®Â <code>myname.name</code>ã€‚</li>
</ul>
<p>è‡³äº<code>call</code>æ˜¯ä¸ªå•¥ï¼Œå¾€ä¸‹çœ‹å§ï¼Œå˜¿å˜¿ï¼</p>
<h3 data-id="heading-2">äºŒã€this ç”¨åœ¨å“ªï¼Ÿâ€”â€” â€œä»£è¯â€ çš„èˆå°</h3>
<p><code>this</code>å°±åƒ â€œå˜è‰²é¾™â€ï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹æŒ‡ä»£ä¸åŒçš„è§’è‰²ï¼š</p>
<ul>
<li><strong>å…¨å±€ä½œç”¨åŸŸ</strong>ï¼šåœ¨æµè§ˆå™¨é‡Œï¼Œ<code>this</code>å°±ç­‰äº<code>window</code>ï¼ˆå°±åƒå…¨å±€èˆå°çš„ â€œC ä½â€ï¼‰ã€‚æ¯”å¦‚ä½ ç›´æ¥å†™<code>console.log(this)</code>ï¼Œæ‰“å°çš„å°±æ˜¯<code>window</code>å¯¹è±¡ã€‚</li>
</ul>
<p>æ¯”å¦‚æˆ‘åœ¨ Google Chrome ä¸Šé¢å†™<code>console.log(this)</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e07785dce0614bf5b46bec9805371ce4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=4rEz48d8iytdOPiD6HijzftVf9o%3D" alt="image.png" loading="lazy"/></p>
<p>ä½†åœ¨node.jsé‡Œï¼Œæ‰“å°å‡ºæ¥çš„æ˜¯<code>global</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5ee9a520ea04d23b3bb720ee6908fcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=gFtVWwP%2FmRm7YcT1iDOyi%2Fl88k8%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>å‡½æ•°ä½œç”¨åŸŸ</strong>ï¼šè¿™å°±æ˜¯<code>this</code>çš„ â€œä¸»æˆ˜åœºâ€äº†ï¼Œåœ¨è¿™å®ƒçš„èº«ä»½å˜åŒ–å¯å¤šäº†ï¼Œå’±ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€this çš„ç»‘å®šè§„åˆ™ â€”â€” ç»™ this â€œå®šè§„çŸ©â€</h3>
<h4 data-id="heading-4">1. é»˜è®¤ç»‘å®š â€”â€” â€œè‡ªç”±æ•£æ¼«â€ çš„ this</h4>
<p>å½“å‡½æ•°è¢«<strong>ç‹¬ç«‹è°ƒç”¨</strong>æ—¶ï¼Œ<code>this</code>å°±æŒ‡å‘<code>window</code>ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯<code>undefined</code>ï¼‰ã€‚å°±åƒä½ ä¸€ä¸ªäººé€›è¡—ï¼Œæ²¡å¯¹è±¡é™ª~</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">a</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
function foo() {
    console.log(this.a)<span class="hljs-comment">;</span>
}
function bar() {
    var <span class="hljs-attr">a</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>
    foo()<span class="hljs-comment">;</span>
}
bar()<span class="hljs-comment">;</span>
</code></pre>
<p>çµé­‚æ‹·é—®ï¼šè¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿè‚¯å®šæœ‰äººè¯´<code>2</code>ï¼Œè€Œä¸”è¿˜ä¸å°‘ï¼ä½ ä¸æœäº†ï¼Œè¿™è°ƒç”¨<code>bar()</code>ï¼Œç„¶åé‡Œé¢åœ¨è°ƒç”¨<code>foo()</code>, ä¸åº”è¯¥æ ¹æ®å˜é‡æå‡å…ˆæ‰¾<code>bar()</code>é‡Œé¢çš„<code>a = 2</code>å—ï¼Ÿè¯´æ˜å‰é¢è¿˜æ²¡çœ‹æ‡‚å˜»å˜»ï¼Œå½“å‡½æ•°è¢«ç‹¬ç«‹è°ƒç”¨--å°±ä¸€ä¸ª<code>foo()</code>ï¼Œå®ƒå°±æ˜¯æŒ‡å‘å…¨å±€ï¼Œä¸ç®¡é‚£äº›æ‚ä¸ƒæ‚å…«çš„ï¼Œä½ å°±æ˜¯ä¸€ä¸ªäººé€›è¡—ï¼Œæ²¡æœ‰å¯¹è±¡é™ªï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯å…¨å±€çš„<code>a = 1</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a379da0232fd4236a4907503ceacc9bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=t3f4m1wC6QLi%2FfJk2mzjS%2BaXUT0%3D" alt="image.png" loading="lazy"/></p>
<p>æœ€åå°±æ˜¯æ‰“å°å‡ºäº†<code>1</code>ï¼Œè¿™å°±æ˜¯å‡½æ•°çš„ç‹¬ç«‹è°ƒç”¨ã€‚</p>
<h4 data-id="heading-5">2. éšå¼ç»‘å®š â€”â€” â€œä¾é™„å¯¹è±¡â€ çš„ this</h4>
<p>å½“å‡½æ•°è¢«<strong>ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨</strong>æ—¶ï¼Œ<code>this</code>å°±ç»‘å®šåˆ°è¿™ä¸ªå¯¹è±¡ä¸Šã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function foo() {
    console.log(this)<span class="hljs-comment">;</span>
}
var <span class="hljs-attr">a</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
var <span class="hljs-attr">obj</span> = {
    foo: foo
}
obj.foo()<span class="hljs-comment">;</span>
</code></pre>
<p>å¥½ï¼Œæœ€åçš„è°ƒç”¨<code>obj.foo()</code>ã€‚é¦–å…ˆå®ƒä¸æ˜¯å•ç‹¬è°ƒç”¨ï¼Œé‚£ä¹ˆå°±è¦ç”¨åˆ°<strong>ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨</strong>ï¼Œå’±ä»¬ä¸€å¥è¯è¯´æ¸…æ ¸å¿ƒï¼š<code>obj.foo()</code>Â æ˜¯é€šè¿‡å¯¹è±¡Â <code>obj</code>Â è°ƒç”¨å‡½æ•°Â <code>foo</code>ï¼Œæ‰€ä»¥Â <code>foo</code>Â é‡Œçš„Â <code>this</code>Â ç›´æ¥ç»‘å®šåˆ°Â <code>obj</code>ï¼Œæœ€ç»ˆæ‰“å°Â <code>obj</code>Â æ•´ä¸ªå¯¹è±¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2844f0af6e73459a9f0e9e1847e592e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=3pxzCNi920tAcZUMdGKQ6a0m2PI%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">3. éšå¼ä¸¢å¤± â€”â€” â€œå±‚å±‚å‰¥ç¦»â€ çš„ this</h4>
<p>å½“å‡½æ•°è¢«å¤šå±‚å¯¹è±¡è°ƒç”¨æ—¶ï¼Œ<code>this</code>ä¼šæŒ‡å‘<strong>æœ€è¿‘çš„é‚£ä¸ªå¯¹è±¡</strong>ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒå°æ—¶å€™ç©çš„æ¸¸æˆğŸ® â€œå‡»é¼“ä¼ èŠ±â€ï¼Œä¼ åˆ°æœ€åèŠ±è½è°å®¶ï¼Ÿ</p>
<p>å¥½ï¼Œé‚£çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-css" lang="css">function foo() {
    console<span class="hljs-selector-class">.log</span>(this<span class="hljs-selector-class">.a</span>);
}
<span class="hljs-selector-tag">var</span> obj = {
    <span class="hljs-selector-tag">a</span>: <span class="hljs-number">1</span>,
    foo: foo
}
<span class="hljs-selector-tag">var</span> obj2 = {
    <span class="hljs-selector-tag">a</span>: <span class="hljs-number">2</span>,
    foo: obj
}
obj2<span class="hljs-selector-class">.foo</span><span class="hljs-selector-class">.foo</span>();
</code></pre>
<p>OKï¼Œæ‡µäº†âŠ™â–ƒâŠ™å§ã€‚æ€ä¹ˆå›äº‹è¿ç»­è°ƒç”¨2æ¬¡ï¼Œæœ€åè¾“å‡ºçš„åˆ°åº•æ˜¯<code>obj</code>é‡Œçš„è¿˜æ˜¯<code>obj2</code>é‡Œçš„ï¼Ÿç­”æ¡ˆæ˜¯<code>obj</code>ï¼</p>
<p><strong>å…³é”®è¯¯åŒºæé†’</strong>ï¼š</p>
<p>ä¸è¦ä»¥ä¸ºÂ <code>obj2</code>Â åœ¨å‰é¢ï¼Œ<code>this</code>Â å°±æŒ‡å‘Â <code>obj2</code>ï¼</p>
<p><code>this</code>Â åªçœ‹ <strong>ã€Œå‡½æ•°æ‰§è¡Œæ—¶çš„ç›´æ¥è°ƒç”¨è€…ã€</strong>ï¼Œå’Œå¤–å±‚åµŒå¥—çš„å¯¹è±¡ï¼ˆ<code>obj2</code>ï¼‰æ— å…³ã€‚å¦‚æœæƒ³è®©Â <code>this</code>Â æŒ‡å‘Â <code>obj2</code>ï¼Œéœ€è¦è®©Â <code>obj2</code>Â ç›´æ¥è°ƒç”¨Â <code>foo</code>ï¼ˆæ¯”å¦‚Â <code>obj2.foo = foo; obj2.foo()</code>ï¼‰ã€‚</p>
<p>å°±å¥½æ¯”æˆ‘ä»¬è‹±è¯­çš„ <strong>å°±è¿‘åŸåˆ™</strong>ï¼Œç¦»è°è¿‘å°±æŒ‡å‘è°ï¼</p>
<p>è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4c5549bd148495d90237bfb9a6088ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=zez8A4FLcydF5hlgtAmDnOYM6Zo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">4. æ˜¾å¼ç»‘å®š â€”â€” â€œå¼ºè¡ŒæŒ‡å®šâ€ çš„ thisï¼ˆcallã€applyã€bind ä¸‰ä½å¥½å®¤å‹ç™»åœºï¼ï¼‰</h4>
<p>å’±ä»¬å¯ä»¥æŠŠè¿™ä¸‰ä¸ªæ–¹æ³•æƒ³è±¡æˆä½ çš„ä¸‰ä¸ª â€œçƒ­å¿ƒå®¤å‹â€ï¼š</p>
<ul>
<li><strong>call å®¤å‹</strong>ï¼šæ€¥æ€§å­ï¼Œç›´æ¥å¸®å‡½æ•°æŠŠ<code>this</code>ç»‘å®šåˆ°ç›®æ ‡å¯¹è±¡ï¼Œå‚æ•°ä¸€ä¸ªä¸ªä¼ ã€‚</li>
<li><strong>apply å®¤å‹</strong>ï¼šçˆ±å·æ‡’ï¼Œå‚æ•°æ‰“åŒ…æˆæ•°ç»„ä¼ ç»™å‡½æ•°ã€‚</li>
<li><strong>bind å®¤å‹</strong>ï¼šæ…¢æ€§å­ï¼Œå…ˆç»‘å®š<code>this</code>å’Œéƒ¨åˆ†å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª â€œåŠæˆå“â€ å‡½æ•°ï¼Œæƒ³å•¥æ—¶å€™è°ƒç”¨éƒ½è¡Œã€‚</li>
</ul>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-tag">var</span> obj = {
    <span class="hljs-selector-tag">a</span>: <span class="hljs-number">1</span>
}
function <span class="hljs-built_in">foo</span>(x, y) { 
    console<span class="hljs-selector-class">.log</span>(this.a, x + y);
}
foo<span class="hljs-selector-class">.call</span>(obj, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);    <span class="hljs-comment">// callå®¤å‹å‡ºé©¬</span>
foo<span class="hljs-selector-class">.apply</span>(obj, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]); <span class="hljs-comment">// applyå®¤å‹å·æ‡’</span>
const bar = foo<span class="hljs-selector-class">.bind</span>(obj, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);  
<span class="hljs-built_in">bar</span>();  <span class="hljs-comment">// bindå®¤å‹æ…¢æ€§å­</span>
</code></pre>
<ol>
<li><code>foo.call(obj, 1, 2)</code>ï¼šcall å®¤å‹ â€œæ€¥æ€§å­â€ï¼Œç›´æ¥æŠŠ foo çš„ this ç»‘å®šåˆ° objï¼Œå†é€ä¸ªä¼ å…¥å‚æ•° 1 å’Œ 2 â†’ æ‰“å° obj çš„ aï¼ˆ1ï¼‰å’Œ 1+2ï¼ˆ3ï¼‰ï¼Œè¾“å‡ºï¼š1 3ï¼›</li>
<li><code>foo.apply(obj, [1, 2])</code>ï¼šapply å®¤å‹ â€œçˆ±å·æ‡’â€ï¼ŒåŒæ ·ç»‘å®š this åˆ° objï¼Œä½†å‚æ•°è¦æ‰“åŒ…æˆæ•°ç»„ [1,2] ä¼ å…¥ â†’ ç»“æœå’Œ call ä¸€è‡´ï¼Œè¾“å‡ºï¼š1 3ï¼›</li>
<li><code>const bar = foo.bind(obj, 2, 3); bar()</code>ï¼šbind å®¤å‹ â€œæ…¢æ€§å­â€ï¼Œå…ˆç»‘å®š this åˆ° objã€é¢„ä¼ å‚æ•° 1 å’Œ 2ï¼Œè¿”å› â€œåŠæˆå“â€ å‡½æ•° barï¼Œè°ƒç”¨ bar æ—¶æ‰æ‰§è¡Œ â†’ æ‰“å° obj çš„ aï¼ˆ1ï¼‰å’Œ 1+2ï¼ˆ3ï¼‰ï¼Œè¾“å‡ºï¼š1 3ã€‚</li>
</ol>
<p>ç»“æœå’Œæˆ‘ä»¬åˆ†æçš„ä¸€æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5899e8ff04b94c72a74cace92a0fc362~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=eaESjDe%2B3ptMCkYsWIDShML0ZuQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">5. new ç»‘å®š â€”â€” â€œå®ä¾‹ä¸“å±â€ çš„ this</h4>
<p><code>new</code>å…³é”®å­—å°±åƒä¸ª â€œä¸“å±å®šåˆ¶å·¥å‚â€ï¼Œä¸“é—¨ç”¨æ„é€ å‡½æ•°ä¸ºæ–°å¯¹è±¡ â€œé‡èº«æ‰“é€ â€ èº«ä»½ã€‚å½“æˆ‘ä»¬ç”¨<code>new</code>è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œ<code>this</code>ä¼šç›´æ¥ç»‘å®šåˆ°è¿™ä¸ªåˆšåˆ›å»ºçš„<strong>å®ä¾‹å¯¹è±¡</strong>ä¸Šï¼Œç›¸å½“äºå·¥å‚æŠŠå®šåˆ¶å¥½çš„ â€œä¸“å±èº«ä»½â€ ç›´æ¥èµ‹ç»™äº†æ–°å®ä¾‹ã€‚</p>
<p>ä½†è¿™ä¸ª â€œå®šåˆ¶å·¥å‚â€ æœ‰ä¸ª<strong>ç‰¹æ®Šè§„åˆ™</strong>,åˆ†ä¸‰ç§æƒ…å†µ:</p>
<p><strong>æƒ…å†µ 1ï¼šæ­£å¸¸å®šåˆ¶</strong> â€”â€” è¿”å›ç»‘å®š this çš„å®ä¾‹</p>
<p>å½“æ„é€ å‡½æ•°é‡Œæ²¡æœ‰æ‰‹åŠ¨<code>return</code>ï¼Œæˆ–è€…åª<code>return</code>äº†<code>undefined</code>ï¼ˆé»˜è®¤éšå«ï¼‰æ—¶ï¼Œå·¥å‚ä¼šæŒ‰æµç¨‹å®Œæˆ â€œå®šåˆ¶â€ï¼Œè¿”å›ç»‘å®šäº†<code>this</code>çš„å®ä¾‹å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}
<span class="hljs-keyword">let</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'henry'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1.<span class="hljs-property">name</span>); <span class="hljs-comment">// è¾“å‡º"henry"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1);      <span class="hljs-comment">// è¾“å‡ºPerson { name: "henry" }ï¼Œthisç»‘å®šç”Ÿæ•ˆ</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee9dfb60533a4af79a7d2e0889f0d080~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=6FB358AMcLNNu%2B5m7YXSWZe5rZw%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æƒ…å†µ 2ï¼šæ”¾å¼ƒå®šåˆ¶</strong> â€”â€” return å¼•ç”¨ç±»å‹ï¼Œè¿”å›æ‰‹åŠ¨æŒ‡å®šçš„å¯¹è±¡</p>
<p>å¦‚æœæ„é€ å‡½æ•°é‡Œä¸»åŠ¨<code>return</code>äº†ä¸€ä¸ª<strong>å¼•ç”¨ç±»å‹</strong>ï¼ˆæ¯”å¦‚å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰å¤æ‚æ•°æ®ï¼‰ï¼Œç›¸å½“äºä½ ç»™å·¥å‚é€’äº†ä¸€ä¸ª â€œç°æˆäº§å“â€ï¼Œå·¥å‚ä¼šç›´æ¥æ”¾å¼ƒåŸæœ¬çš„å®šåˆ¶æµç¨‹ï¼Œè¿”å›è¿™ä¸ªæ‰‹åŠ¨æŒ‡å®šçš„å¼•ç”¨ç±»å‹ï¼ŒåŸæœ¬ç»‘å®š<code>this</code>çš„å®ä¾‹ä¼šè¢«ç›´æ¥å¿½ç•¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> }; 
}
<span class="hljs-keyword">let</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'harvest'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p2);      <span class="hljs-comment">// è¾“å‡º{ age: 20 }ï¼Œå®ä¾‹è¢«å¿½ç•¥</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p2.<span class="hljs-property">name</span>); <span class="hljs-comment">// è¾“å‡ºundefinedï¼Œæ‹¿ä¸åˆ°åŸæœ¬çš„nameå±æ€§</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17b7695c002c47f893a1903e851e6ffd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=tQe57Um4TKAXNfVHHsj%2B4yRNAuA%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æƒ…å†µ 3ï¼šæ— è§† return</strong> â€”â€” return åŸå§‹ç±»å‹ï¼Œä¾ç„¶è¿”å›å®ä¾‹</p>
<p>å¦‚æœæ„é€ å‡½æ•°é‡Œ<code>return</code>çš„æ˜¯<strong>åŸå§‹æ•°æ®ç±»å‹</strong>ï¼ˆæ¯”å¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€nullã€undefinedï¼‰ï¼Œè¿™ä¸ª<code>return</code>ä¼šè¢«å·¥å‚ â€œæ— è§†â€ï¼Œä¾ç„¶æŒ‰åŸè§„åˆ™è¿”å›ç»‘å®šäº†<code>this</code>çš„å®ä¾‹å¯¹è±¡ï¼Œç›¸å½“äºä½ é€’äº†ä¸ª â€œæ— æ•ˆäº§å“â€ï¼Œå·¥å‚è¿˜æ˜¯æŒ‰å®šåˆ¶æµç¨‹æ¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>; <span class="hljs-comment">// return æ— æ•ˆ</span>
}
<span class="hljs-keyword">let</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'henry'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p3.<span class="hljs-property">name</span>); <span class="hljs-comment">// è¾“å‡º"henry"ï¼Œå®ä¾‹æ­£å¸¸ç”Ÿæ•ˆ</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58a9a661eade4e5da9cadc93475da495~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=zwaQaMGNZ1tKJvZEDFwDpT8Tgsk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">6. ç®­å¤´å‡½æ•° â€”â€” â€œæ²¡æœ‰ thisâ€ çš„ this</h4>
<p>ç®­å¤´å‡½æ•°é‡Œæ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œå®ƒçš„<code>this</code>æ˜¯<strong>å¤–å±‚éç®­å¤´å‡½æ•°çš„ this</strong>ã€‚å°±åƒ â€œå°è·Ÿç­â€ï¼Œæ°¸è¿œè·Ÿç€å¤–å±‚å‡½æ•°çš„<code>this</code>èµ°ï¼Œä¸ä¼šè¢«ä»»ä½•ç»‘å®šè§„åˆ™æ”¹å˜ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">function foo() {
    var <span class="hljs-attr">bar</span> = () =&gt; {
        <span class="hljs-attr">this.a</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>
    }
    bar()<span class="hljs-comment">;</span>
}
var <span class="hljs-attr">obj</span> = {
    a: 1,
    baz: foo
}
obj.baz()<span class="hljs-comment">;</span>
console.log(obj)<span class="hljs-comment">;</span>
</code></pre>
<p>å†æ¬¡çµé­‚æ‹·é—®ï¼š<code>a</code> æ˜¯ 1 è¿˜æ˜¯ 2 ï¼Ÿ ç­”æ¡ˆï¼š<code>2</code> ï¼</p>
<p><strong>å…³é”®é€»è¾‘ï¼š</strong></p>
<ol>
<li><code>obj.baz()</code>Â æ˜¯<strong>éšå¼ç»‘å®š</strong>ï¼šfoo å‡½æ•°è¢« obj è°ƒç”¨ï¼Œæ‰€ä»¥ foo é‡Œçš„<code>this</code>æŒ‡å‘ objï¼›</li>
<li>ç®­å¤´å‡½æ•°<code>bar</code>æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œç›´æ¥ â€œå·â€ äº†å¤–å±‚ foo çš„<code>this</code>ï¼ˆä¹Ÿå°±æ˜¯ objï¼‰ï¼›</li>
<li>æ‰§è¡Œ<code>bar()</code>æ—¶ï¼Œ<code>this.a = 2</code>Â å…¶å®æ˜¯ç»™<code>obj.a</code>èµ‹å€¼ï¼ŒæŠŠåŸæ¥çš„ 1 æ”¹æˆäº† 2ï¼›</li>
<li>æœ€åæ‰“å° objï¼Œa å±æ€§å·²ç»å˜æˆ 2ï¼Œç»“æœå°±æ˜¯Â <code>{ a: 2, baz: å‡½æ•°foo }</code>ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9a92f2c5f224de680f283a132db4316~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764489636&amp;x-signature=k2qlGEtEpbMiI9nrfxLAAGGJEoM%3D" alt="image.png" loading="lazy"/></p>
<p>OKï¼Œæ˜¯ä¸æ˜¯è§‰å¾—è‡ªå·±å·²ç»æ‹¿æ<code>this</code>äº†ï¼Ÿ</p>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>ä» â€œè‡ªç”±æ•£æ¼«â€ çš„é»˜è®¤ç»‘å®šã€â€œä¾é™„å¯¹è±¡â€ çš„éšå¼ç»‘å®šï¼Œåˆ° â€œå¼ºè¡ŒæŒ‡å®šâ€ çš„ä¸‰ä¸ªâ€œçƒ­å¿ƒâ€çš„å®¤å‹ï¼Œå†åˆ° â€œå®šåˆ¶åŒ–â€ çš„ new ç»‘å®šï¼ˆä¸‰ç§æƒ…å†µï¼‰ï¼Œæœ€åæ˜¯ â€œç²˜äººè·Ÿç­â€ çš„ç®­å¤´å‡½æ•° â€”â€” åªè¦æ‰¾å‡†åœºæ™¯å¯¹å·å…¥åº§ï¼Œ<code>this</code>å°±å†ä¹Ÿä¸ä¼šè®©ä½ å¤´ç–¼å•¦ï¼</p>
<blockquote>
<p>æŒæ¡<code>this</code>ï¼Œè®©ä½ çš„ä»£ç æ›´ä¸Šä¸€å±‚æ¥¼å§!</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JDK8 Lambda åŠ æŒï¼šæ‰“é€ ä¼˜é›…é€šç”¨çš„å¯¹è±¡æ„å»ºå™¨]]></title>    <link>https://juejin.cn/post/7575119254313648154</link>    <guid>https://juejin.cn/post/7575119254313648154</guid>    <pubDate>2025-11-23T07:19:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575119254313648154" data-draft-id="7575182522411040806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JDK8 Lambda åŠ æŒï¼šæ‰“é€ ä¼˜é›…é€šç”¨çš„å¯¹è±¡æ„å»ºå™¨"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-23T07:19:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åªä¼šå†™ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/995479086189514"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JDK8 Lambda åŠ æŒï¼šæ‰“é€ ä¼˜é›…é€šç”¨çš„å¯¹è±¡æ„å»ºå™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/995479086189514/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åªä¼šå†™ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:19:29.000Z" title="Sun Nov 23 2025 07:19:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸ Java å¼€å‘ä¸­ï¼Œå¯¹è±¡æ„å»ºæ˜¯é«˜é¢‘æ“ä½œã€‚ä¼ ç»Ÿçš„<code>new å¯¹è±¡ + é“¾å¼setter</code>æˆ–æ‰‹åŠ¨ç¼–å†™ Builder æ¨¡å¼ï¼Œè¦ä¹ˆä»£ç å†—ä½™ç¹çï¼Œè¦ä¹ˆéœ€è¦é‡å¤å¼€å‘æ¨¡æ¿ä»£ç ã€‚æœ¬æ–‡å°†åŸºäº JDK8 çš„ Lambda ç‰¹æ€§ï¼Œå®ç°ä¸€ä¸ªé€šç”¨ã€ä¼˜é›…ã€æ”¯æŒçµæ´»æ ¡éªŒçš„å¯¹è±¡æ„å»ºå™¨ï¼Œå½»åº•è§£å†³å¯¹è±¡æ„å»ºçš„ç—›ç‚¹ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ç—›ç‚¹å›é¡¾ï¼šä¼ ç»Ÿå¯¹è±¡æ„å»ºçš„å›°å¢ƒ</h2>
<p>å…ˆçœ‹ä¸€ä¸ªå¸¸è§åœºæ™¯ï¼šåˆ›å»ºä¸€ä¸ª<code>User</code>å¯¹è±¡å¹¶è®¾ç½®å±æ€§ï¼Œéƒ¨åˆ†å±æ€§éœ€è¦æ ¡éªŒï¼ˆå¦‚å¹´é¾„å¿…é¡»å¤§äº 0ï¼‰ã€‚</p>
<h3 data-id="heading-1">1. ä¼ ç»Ÿ setter æ¨¡å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
user.setName(<span class="hljs-string">"å¼ ä¸‰"</span>);
user.setAge(<span class="hljs-number">25</span>);
user.setEmail(<span class="hljs-string">"zhangsan@xxx.com"</span>);
<span class="hljs-comment">// æ ¡éªŒé€»è¾‘æ•£è½å„å¤„</span>
<span class="hljs-keyword">if</span> (user.getAge() &lt;= <span class="hljs-number">0</span>) {
   <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"å¹´é¾„å¿…é¡»å¤§äº0"</span>);
}
</code></pre>
<ul>
<li>é—®é¢˜ï¼šä»£ç å†—é•¿ï¼Œç¼ºä¹é“¾å¼è°ƒç”¨çš„æµç•…æ€§ï¼Œæ ¡éªŒé€»è¾‘ä¸å±æ€§è®¾ç½®åˆ†ç¦»ï¼Œç»´æŠ¤æˆæœ¬é«˜ã€‚</li>
</ul>
<h3 data-id="heading-2">2. æ‰‹åŠ¨ç¼–å†™ Builder æ¨¡å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBuilder</span> {
   <span class="hljs-keyword">private</span> User user;
   <span class="hljs-keyword">private</span> <span class="hljs-title function_">UserBuilder</span><span class="hljs-params">()</span> { user = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(); }
   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> UserBuilder <span class="hljs-title function_">builder</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserBuilder</span>(); }
   <span class="hljs-keyword">public</span> UserBuilder <span class="hljs-title function_">name</span><span class="hljs-params">(String name)</span> {
       user.setName(name);
       <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
   }
   <span class="hljs-keyword">public</span> UserBuilder <span class="hljs-title function_">age</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
       <span class="hljs-keyword">if</span> (age &lt;= <span class="hljs-number">0</span>) {
           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"å¹´é¾„å¿…é¡»å¤§äº0"</span>);
       }
       user.setAge(age);
       <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
   }
   <span class="hljs-comment">// å…¶ä»–å±æ€§çš„setter...</span>
   <span class="hljs-keyword">public</span> User <span class="hljs-title function_">build</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> user; }
}
<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> UserBuilder.builder()
       .name(<span class="hljs-string">"å¼ ä¸‰"</span>)
       .age(<span class="hljs-number">25</span>)
       .email(<span class="hljs-string">"zhangsan@xxx.com"</span>)
       .build();
</code></pre>
<ul>
<li>é—®é¢˜ï¼šæ¯ä¸ªå®ä½“ç±»éƒ½è¦ç¼–å†™å¯¹åº”çš„ Builder ç±»ï¼Œé‡å¤ä»£ç å¤šï¼›æ ¡éªŒé€»è¾‘ä¸ Builder å¼ºè€¦åˆï¼Œçµæ´»æ€§å·®ã€‚
æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼ï¼Œæ—¢èƒ½äº«å— Builder æ¨¡å¼çš„é“¾å¼ä¼˜é›…ï¼Œåˆä¸ç”¨ç¼–å†™é‡å¤æ¨¡æ¿ä»£ç ï¼Œè¿˜èƒ½çµæ´»æ”¯æŒå±æ€§æ ¡éªŒï¼Ÿç­”æ¡ˆæ˜¯ï¼šç”¨ JDK8 Lambda å®ç°é€šç”¨æ„å»ºå™¨ï¼</li>
</ul>
<h2 data-id="heading-3">äºŒã€æ ¸å¿ƒè®¾è®¡ï¼šLambda æ„å»ºå™¨çš„å®ç°åŸç†</h2>
<p>æ ¸å¿ƒæ€è·¯ï¼š<strong>ç”¨å‡½æ•°å¼æ¥å£æ‰¿æ¥ setter é€»è¾‘ï¼Œé€šè¿‡ Lambda è¡¨è¾¾å¼ç®€åŒ–è°ƒç”¨ï¼Œå°è£…æ„å»ºé€»è¾‘ä¸ºé€šç”¨å·¥å…·ç±»</strong>ã€‚
æ•´ä½“ç»“æ„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li>å‡½æ•°å¼æ¥å£<code>SetterFunction</code>ï¼šå®šä¹‰å±æ€§è®¾ç½®è¡Œä¸º</li>
<li>æ„å»ºå™¨ç±»<code>InstanceBuilder</code>ï¼šå°è£…å®ä¾‹åˆ›å»ºã€å±æ€§è®¾ç½®ã€æ ¡éªŒé€»è¾‘</li>
</ol>
<h3 data-id="heading-4">1. å‡½æ•°å¼æ¥å£ï¼šSetterFunction</h3>
<p>è¿™æ˜¯ Lambda èƒ½ç”Ÿæ•ˆçš„æ ¸å¿ƒ â€”â€” å¿…é¡»æ˜¯<strong>å‡½æ•°å¼æ¥å£</strong>ï¼ˆä»…ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œç”¨äºæ‰¿æ¥ â€œå¯¹è±¡ + å±æ€§å€¼â€ çš„è®¾ç½®é€»è¾‘ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
* Setteræ–¹æ³•å‡½æ•°å¼æ¥å£
* æ‰¿æ¥å¯¹è±¡çš„å±æ€§è®¾ç½®è¡Œä¸ºï¼Œä¸ºLambdaè¡¨è¾¾å¼æä¾›ç›®æ ‡ç±»å‹
* <span class="hljs-doctag">@param</span> &lt;T&gt; ç›®æ ‡å¯¹è±¡ç±»å‹
* <span class="hljs-doctag">@param</span> &lt;P&gt; å±æ€§å€¼ç±»å‹
*/</span>
<span class="hljs-meta">@FunctionalInterface</span> <span class="hljs-comment">// æ˜¾å¼å£°æ˜å‡½æ•°å¼æ¥å£ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SetterFunction</span>&lt;T, P&gt; {
    <span class="hljs-comment">/**
    * æ‰§è¡Œå±æ€§è®¾ç½®
    * <span class="hljs-doctag">@param</span> target ç›®æ ‡å¯¹è±¡
    * <span class="hljs-doctag">@param</span> param è¦è®¾ç½®çš„å±æ€§å€¼
    */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">(T target, P param)</span>;
    }
</code></pre>
<p>ä¸ºä»€ä¹ˆä¸ç”¨ JDK è‡ªå¸¦çš„<code>BiConsumer&lt;T, P&gt;</code>ï¼Ÿ
<code>BiConsumer</code>çš„æ–¹æ³•åæ˜¯<code>accept</code>ï¼Œè¯­ä¹‰ä¸å¤Ÿæ˜ç¡®ï¼›è€Œ<code>SetterFunction</code>çš„<code>call</code>æ–¹æ³•æ›´ç›´è§‚ä½“ç° â€œæ‰§è¡Œå±æ€§è®¾ç½®â€ çš„æ„å›¾ï¼Œä¸”è‡ªå®šä¹‰æ¥å£å¯åç»­æ‰©å±•ï¼ˆå¦‚æ·»åŠ é»˜è®¤æ–¹æ³•ï¼‰ï¼Œçµæ´»æ€§æ›´é«˜ã€‚</p>
<h3 data-id="heading-5">2. æ ¸å¿ƒæ„å»ºå™¨ï¼šInstanceBuilder</h3>
<p>å°è£…å®ä¾‹åˆ›å»ºã€é“¾å¼è®¾ç½®ã€å±æ€§æ ¡éªŒã€å®ä¾‹è¿”å›çš„å®Œæ•´é€»è¾‘ï¼Œæä¾›ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼ˆæ–°å®ä¾‹ / ç°æœ‰å®ä¾‹ï¼‰ï¼Œæ”¯æŒå¯é€‰æ ¡éªŒã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Objects;
<span class="hljs-keyword">import</span> java.util.function.Predicate;

<span class="hljs-comment">/**
 * å®ä¾‹æ„å»ºå™¨
 * ç”¨äºæ„å»ºå’Œé…ç½®å¯¹è±¡å®ä¾‹ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨è®¾ç½®å±æ€§å€¼
 *
 * <span class="hljs-doctag">@param</span> &lt;T&gt; è¦æ„å»ºçš„å®ä¾‹ç±»å‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InstanceBuilder</span>&lt;T&gt; {

    <span class="hljs-comment">/** æ­£åœ¨æ„å»ºçš„å®ä¾‹å¯¹è±¡ */</span>
    <span class="hljs-keyword">private</span> T inst;

    <span class="hljs-comment">/**
     * ç§æœ‰æ„é€ å‡½æ•° - åŸºäºç°æœ‰å®ä¾‹åˆ›å»ºæ„å»ºå™¨
     *
     * <span class="hljs-doctag">@param</span> inst å·²å­˜åœ¨çš„å®ä¾‹å¯¹è±¡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">InstanceBuilder</span><span class="hljs-params">(T inst)</span> {
        <span class="hljs-built_in">this</span>.inst = Objects.requireNonNull(inst, <span class="hljs-string">"Instance cannot be null"</span>);
    }

    <span class="hljs-comment">/**
     * ç§æœ‰æ„é€ å‡½æ•° - åŸºäºç±»åˆ›å»ºæ„å»ºå™¨ï¼ˆé€šè¿‡åå°„å®ä¾‹åŒ–ï¼‰
     *
     * <span class="hljs-doctag">@param</span> instClass è¦å®ä¾‹åŒ–çš„ç±»
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">InstanceBuilder</span><span class="hljs-params">(Class&lt;T&gt; instClass)</span> {
        Objects.requireNonNull(instClass, <span class="hljs-string">"instClass cannot be null"</span>);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä½¿ç”¨æ— å‚æ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹</span>
            <span class="hljs-built_in">this</span>.inst = instClass.getDeclaredConstructor().newInstance();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Failed to create instance of "</span> + instClass.getName(), e);
        }
    }

    <span class="hljs-comment">/**
     * é™æ€å·¥å‚æ–¹æ³• - åŸºäºç°æœ‰å®ä¾‹åˆ›å»ºæ„å»ºå™¨
     *
     * <span class="hljs-doctag">@param</span> &lt;T&gt; å®ä¾‹ç±»å‹
     * <span class="hljs-doctag">@param</span> inst å·²å­˜åœ¨çš„å®ä¾‹å¯¹è±¡
     * <span class="hljs-doctag">@return</span> InstBuilderå®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; InstanceBuilder&lt;T&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(T inst)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InstanceBuilder</span>&lt;&gt;(inst);
    }

    <span class="hljs-comment">/**
     * é™æ€å·¥å‚æ–¹æ³• - åŸºäºç±»åˆ›å»ºæ„å»ºå™¨
     *
     * <span class="hljs-doctag">@param</span> &lt;T&gt; å®ä¾‹ç±»å‹
     * <span class="hljs-doctag">@param</span> instClass è¦å®ä¾‹åŒ–çš„ç±»
     * <span class="hljs-doctag">@return</span> InstBuilderå®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; InstanceBuilder&lt;T&gt; <span class="hljs-title function_">of</span><span class="hljs-params">(Class&lt;T&gt; instClass)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InstanceBuilder</span>&lt;&gt;(instClass);
    }

    <span class="hljs-comment">/**
     * è®¾ç½®å®ä¾‹å±æ€§å€¼
     * ä½¿ç”¨å‡½æ•°å¼æ¥å£æ–¹å¼è®¾ç½®å®ä¾‹çš„ç‰¹å®šå±æ€§ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
     *
     * <span class="hljs-doctag">@param</span> &lt;V&gt; å±æ€§å€¼ç±»å‹
     * <span class="hljs-doctag">@param</span> fnSet è®¾ç½®å±æ€§çš„å‡½æ•°å¼æ¥å£
     * <span class="hljs-doctag">@param</span> v è¦è®¾ç½®çš„å±æ€§å€¼
     * <span class="hljs-doctag">@return</span> å½“å‰æ„å»ºå™¨å®ä¾‹ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> &lt;V&gt; InstanceBuilder&lt;T&gt; <span class="hljs-title function_">set</span><span class="hljs-params">(SetterFunction&lt;T, V&gt; fnSet, V v)</span>{
        fnSet.call(inst, v);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }

    <span class="hljs-comment">/**
     * å¸¦æ ¡éªŒçš„setæ–¹æ³•ï¼ˆé‡è½½ï¼Œæƒ³ç”¨æ—¶ç”¨ï¼Œä¸æƒ³ç”¨è¿˜èƒ½ç”¨åŸæ¥çš„ï¼‰
     * <span class="hljs-doctag">@param</span> fnSet è®¾ç½®å±æ€§çš„å‡½æ•°å¼æ¥å£
     * <span class="hljs-doctag">@param</span> v è¦è®¾ç½®çš„å±æ€§å€¼
     * <span class="hljs-doctag">@param</span> validator æ ¡éªŒå™¨
     * <span class="hljs-doctag">@return</span> å½“å‰æ„å»ºå™¨å®ä¾‹ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰
     * <span class="hljs-doctag">@param</span> &lt;V&gt; å±æ€§å€¼ç±»å‹
     */</span>
    <span class="hljs-keyword">public</span> &lt;V&gt; InstanceBuilder&lt;T&gt; <span class="hljs-title function_">set</span><span class="hljs-params">(SetterFunction&lt;T, V&gt; fnSet, V v, Predicate&lt;V&gt; validator)</span>{
        <span class="hljs-comment">// å…ˆæ ¡éªŒï¼šç¬¦åˆæ¡ä»¶æ‰è®¾ç½®å±æ€§ï¼Œä¸ç¬¦åˆå°±æŠ¥é”™</span>
        <span class="hljs-keyword">if</span> (!validator.test(v)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"å±æ€§å€¼ä¸å¯¹ï¼š"</span> + v);
        }
        fnSet.call(inst, v); <span class="hljs-comment">// æ ¡éªŒé€šè¿‡å†è°ƒç”¨ä½ åŸæœ‰çš„è®¾ç½®é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }

    <span class="hljs-comment">/**
     * æ„å»ºå¹¶è¿”å›é…ç½®å®Œæˆçš„å®ä¾‹
     *
     * <span class="hljs-doctag">@return</span> æ„å»ºå®Œæˆçš„å®ä¾‹å¯¹è±¡
     */</span>
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">build</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">return</span> inst;
    }
}
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino">æ ¸å¿ƒè®¾è®¡äº®ç‚¹ï¼š
* ç§æœ‰æ„é€  + é™æ€å·¥å‚ï¼šé™åˆ¶åˆ›å»ºæ–¹å¼ï¼Œä¿è¯å®ä¾‹å®‰å…¨æ€§
* åŒé‡åˆ›å»ºæ”¯æŒï¼šæ—¢æ”¯æŒæ–°å®ä¾‹åˆ›å»ºï¼ˆåå°„æ— å‚æ„é€ ï¼‰ï¼Œä¹Ÿæ”¯æŒç°æœ‰å®ä¾‹ä¿®æ”¹
* é‡è½½ set æ–¹æ³•ï¼šæ™®é€šè®¾ç½® + æ ¡éªŒè®¾ç½®åˆ†ç¦»ï¼ŒæŒ‰éœ€ä½¿ç”¨ï¼Œä¸ä¾µå…¥åŸºç¡€é€»è¾‘
* å‡½æ•°å¼æ¥å£ç»“åˆï¼š`SetterFunction`æ‰¿æ¥ setterï¼Œ`Predicate`æ‰¿æ¥æ ¡éªŒï¼ŒLambda ç®€åŒ–è°ƒç”¨

## ä¸‰ã€å®æˆ˜ç”¨æ³•ï¼š<span class="hljs-number">3</span> åˆ†é’Ÿä¸Šæ‰‹ä¼˜é›…æ„å»º
ä¸‹é¢é€šè¿‡ <span class="hljs-number">3</span> ä¸ªæ ¸å¿ƒåœºæ™¯ï¼Œæ¼”ç¤ºå¦‚ä½•ç”¨è¿™ä¸ªæ„å»ºå™¨ç®€åŒ–å¼€å‘ã€‚
### å‡†å¤‡å·¥ä½œï¼šå®šä¹‰å®ä½“ç±»
å…ˆå®šä¹‰ä¸€ä¸ªæ™®é€šå®ä½“ç±»ï¼ˆæ— éœ€ä»»ä½•æ”¹é€ ï¼Œæ— ä¾µå…¥æ€§ï¼‰ï¼š

```java
<span class="hljs-comment">/**
* æ™®é€šå®ä½“ç±»ï¼ˆæ— éœ€å®ç°ä»»ä½•æ¥å£/æ³¨è§£ï¼‰
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> name;
    <span class="hljs-keyword">private</span> Integer age;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> email;
    <span class="hljs-comment">// æ— å‚æ„é€ ï¼ˆåå°„åˆ›å»ºå¿…éœ€ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>{}
    <span class="hljs-comment">// getter/setterï¼ˆå¸¸è§„ç”Ÿæˆå³å¯ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> name; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(<span class="hljs-type">String</span> name)</span> </span>{ <span class="hljs-keyword">this</span>.name = name; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> age; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(Integer age)</span> </span>{ <span class="hljs-keyword">this</span>.age = age; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getEmail</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> email; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setEmail</span><span class="hljs-params">(<span class="hljs-type">String</span> email)</span> </span>{ <span class="hljs-keyword">this</span>.email = email; }
}
</code></pre>
<h3 data-id="heading-6">åœºæ™¯ 1ï¼šåˆ›å»ºæ–°å®ä¾‹ï¼ˆæ— å‚æ„é€ ï¼‰</h3>
<p>é€šè¿‡<code>InstanceBuilder.of(Class)</code>åˆ›å»ºæ–°å®ä¾‹ï¼Œé“¾å¼è®¾ç½®å±æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ„å»ºUserå®ä¾‹ï¼šæ— æ ¡éªŒ</span>
<span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> InstanceBuilder.of(User.class)
    .set(User::setName, <span class="hljs-string">"å¼ ä¸‰"</span>) <span class="hljs-comment">// Lambdaæ›¿ä»£setterè°ƒç”¨</span>
    .set(User::setAge, <span class="hljs-number">25</span>)
    .set(User::setEmail, <span class="hljs-string">"zhangsan@xxx.com"</span>)
    .build();
System.out.println(user.getName()); <span class="hljs-comment">// è¾“å‡ºï¼šå¼ ä¸‰</span>
</code></pre>
<h3 data-id="heading-7">åœºæ™¯ 2ï¼šä¿®æ”¹ç°æœ‰å®ä¾‹</h3>
<p>é€šè¿‡<code>InstanceBuilder.of(å®ä¾‹)</code>ä¿®æ”¹å·²æœ‰å¯¹è±¡çš„å±æ€§ï¼ˆé€‚åˆ DTO è½¬æ¢ã€å¯¹è±¡æ›´æ–°åœºæ™¯ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å·²æœ‰å®ä¾‹</span>
<span class="hljs-type">User</span> <span class="hljs-variable">existingUser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
existingUser.setName(<span class="hljs-string">"æå››"</span>);
<span class="hljs-comment">// ä¿®æ”¹ç°æœ‰å®ä¾‹çš„å±æ€§</span>
<span class="hljs-type">User</span> <span class="hljs-variable">updatedUser</span> <span class="hljs-operator">=</span> InstanceBuilder.of(existingUser)
    .set(User::setAge, <span class="hljs-number">30</span>)
    .set(User::setEmail, <span class="hljs-string">"lisi@xxx.com"</span>)
    .build();
System.out.println(updatedUser.getAge()); <span class="hljs-comment">// è¾“å‡ºï¼š30</span>
System.out.println(updatedUser.getName()); <span class="hljs-comment">// è¾“å‡ºï¼šæå››ï¼ˆæœªä¿®æ”¹çš„å±æ€§ä¿ç•™åŸå€¼ï¼‰</span>
</code></pre>
<h3 data-id="heading-8">åœºæ™¯ 3ï¼šå¸¦å±æ€§æ ¡éªŒçš„æ„å»º</h3>
<p>é€šè¿‡<code>set(SetterFunction, value, Predicate)</code>æ·»åŠ æ ¡éªŒé€»è¾‘ï¼ˆå¦‚å¹´é¾„ &gt; 0ã€é‚®ç®±éç©ºï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> {
    <span class="hljs-type">User</span> <span class="hljs-variable">validUser</span> <span class="hljs-operator">=</span> InstanceBuilder.of(User.class)
        .set(User::setName, <span class="hljs-string">"ç‹äº”"</span>, name -&gt; name.length() &gt;= <span class="hljs-number">2</span>) <span class="hljs-comment">// å§“åè‡³å°‘2ä¸ªå­—ç¬¦</span>
        .set(User::setAge, -<span class="hljs-number">5</span>, age -&gt; age &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// å¹´é¾„å¿…é¡»å¤§äº0ï¼ˆæ•…æ„ä¼ é”™å€¼ï¼‰</span>
        .set(User::setEmail, <span class="hljs-string">"wangwu@xxx.com"</span>, email -&gt; email.contains(<span class="hljs-string">"@"</span>)) <span class="hljs-comment">// é‚®ç®±å¿…é¡»åŒ…å«@</span>
        .build();
} <span class="hljs-keyword">catch</span> (IllegalArgumentException e) {
    System.out.println(e.getMessage()); <span class="hljs-comment">// è¾“å‡ºï¼šå±æ€§å€¼æ ¡éªŒå¤±è´¥ï¼š-5</span>
}
</code></pre>
<p>æ ¡éªŒé€»è¾‘çµæ´»å¯é…ç½®ï¼Œæ”¯æŒä»»æ„å¤æ‚è§„åˆ™ï¼ˆå¦‚å¤šæ¡ä»¶ç»„åˆã€æ­£åˆ™åŒ¹é…ç­‰ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¤æ‚æ ¡éªŒï¼šé‚®ç®±å¿…é¡»åŒ…å«@ä¸”é•¿åº¦&gt;5</span>
.set(User::setEmail, <span class="hljs-string">"ww@xxx.com"</span>, email -&gt; email.contains(<span class="hljs-string">"@"</span>) &amp;&amp; email.length() &gt; <span class="hljs-number">5</span>)
</code></pre>
<h2 data-id="heading-9">å››ã€æ ¸å¿ƒç‰¹æ€§ï¼šä¸ºä»€ä¹ˆè¿™ä¸ªæ„å»ºå™¨å€¼å¾—ç”¨ï¼Ÿ</h2>
<h3 data-id="heading-10">1. æç®€é“¾å¼è°ƒç”¨ï¼Œä»£ç æ›´ä¼˜é›…</h3>
<p>Lambda è¡¨è¾¾å¼æ›¿ä»£äº†å†—é•¿çš„ setter è°ƒç”¨ï¼Œé“¾å¼å†™æ³•ä¸€æ°”å‘µæˆï¼Œä»£ç å¯è¯»æ€§å¤§å¹…æå‡ã€‚</p>
<h3 data-id="heading-11">2. é›¶ä¾µå…¥æ€§ï¼Œæ— éœ€æ”¹é€ å®ä½“ç±»</h3>
<p>å®ä½“ç±»æ— éœ€å®ç°ä»»ä½•æ¥å£ã€æ·»åŠ ä»»ä½•æ³¨è§£ï¼Œä¹Ÿä¸ç”¨ç¼–å†™ Builder å†…éƒ¨ç±»ï¼Œå®Œå…¨å¤ç”¨åŸæœ‰ getter/setterã€‚</p>
<h3 data-id="heading-12">3. çµæ´»åˆ›å»º + ä¿®æ”¹ï¼Œåœºæ™¯å…¨è¦†ç›–</h3>
<p>æ”¯æŒ â€œæ–°å®ä¾‹åˆ›å»ºâ€ å’Œ â€œç°æœ‰å®ä¾‹ä¿®æ”¹â€ ä¸¤ç§åœºæ™¯ï¼Œæ»¡è¶³å¯¹è±¡åˆå§‹åŒ–ã€DTO æ›´æ–°ã€å±æ€§æ‰¹é‡ä¿®æ”¹ç­‰éœ€æ±‚ã€‚</p>
<h3 data-id="heading-13">4. å¯é€‰æ ¡éªŒæœºåˆ¶ï¼Œé€»è¾‘è§£è€¦</h3>
<p>æ ¡éªŒé€»è¾‘é€šè¿‡<code>Predicate</code>ä¼ å…¥ï¼Œä¸å±æ€§è®¾ç½®åˆ†ç¦»ï¼Œæ— éœ€ä¾µå…¥å®ä½“ç±»æˆ–æ„å»ºå™¨æ ¸å¿ƒé€»è¾‘ï¼ŒæŒ‰éœ€å¯ç”¨ã€‚</p>
<h3 data-id="heading-14">5. JDK8 åŸç”Ÿæ”¯æŒï¼Œæ— ä¾èµ–</h3>
<p>ä»…ä¾èµ– JDK8 æ ¸å¿ƒ APIï¼ˆLambdaã€å‡½æ•°å¼æ¥å£ã€åå°„ï¼‰ï¼Œæ— éœ€å¼•å…¥ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼ˆå¦‚ Lombokï¼‰ï¼Œè½»é‡åŒ–æ— å†—ä½™ã€‚</p>
<h2 data-id="heading-15">äº”ã€å¯¹æ¯”ä¼ ç»Ÿæ–¹æ¡ˆï¼šä¼˜åŠ¿ä¸€ç›®äº†ç„¶</h2>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä»£ç ç®€æ´åº¦</th><th>ä¾µå…¥æ€§</th><th>æ ¡éªŒæ”¯æŒ</th><th>å¤ç”¨æ€§</th></tr></thead><tbody><tr><td>ä¼ ç»Ÿ new+setter</td><td>ä½</td><td>æ— </td><td>å·®ï¼ˆæ•£è½ï¼‰</td><td>æ— </td></tr><tr><td>æ‰‹åŠ¨ç¼–å†™ Builder</td><td>ä¸­</td><td>é«˜ï¼ˆéœ€å†™å†…éƒ¨ç±»ï¼‰</td><td>ä¸­ï¼ˆè€¦åˆï¼‰</td><td>ä½ï¼ˆæ¯ä¸ªå®ä½“ç±»å•ç‹¬å†™ï¼‰</td></tr><tr><td>æœ¬æ–‡ Lambda æ„å»ºå™¨</td><td>é«˜</td><td>æ— </td><td>é«˜ï¼ˆçµæ´»ï¼‰</td><td>é«˜ï¼ˆé€šç”¨ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-16">å…­ã€æ€»ç»“</h2>
<p>æœ¬æ–‡åŸºäº JDK8 Lambda ç‰¹æ€§ï¼Œå®ç°äº†ä¸€ä¸ªé€šç”¨ã€ä¼˜é›…ã€çµæ´»çš„å¯¹è±¡æ„å»ºå™¨ã€‚æ ¸å¿ƒæ˜¯é€šè¿‡<code>SetterFunction</code>å‡½æ•°å¼æ¥å£æ‰¿æ¥ setter é€»è¾‘ï¼Œç»“åˆ<code>InstanceBuilder</code>å°è£…æ„å»ºæµç¨‹ï¼Œæ—¢è§£å†³äº†ä¼ ç»Ÿ setter çš„ç¹çï¼Œåˆé¿å…äº†æ‰‹åŠ¨ç¼–å†™ Builder çš„é‡å¤åŠ³åŠ¨ã€‚
è¿™ä¸ªæ„å»ºå™¨çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š<strong>ç”¨æç®€çš„ä»£ç å®ç°å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¿æŒé›¶ä¾µå…¥ã€é«˜çµæ´»ã€æ— ä¾èµ–</strong>ï¼Œé€‚åˆåœ¨ä»»ä½• JDK8 + é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå°¤å…¶é€‚åˆå¤šå±æ€§ã€éœ€æ ¡éªŒã€é¢‘ç¹æ„å»ºå¯¹è±¡çš„åœºæ™¯ã€‚</p>
<h2 data-id="heading-17">ä¸ƒã€æ€»ç»“</h2>
<p>è‹¥ä½ åŒå€¦äº†æ‰‹åŠ¨ç¼–å†™ Builder çš„é‡å¤æ¨¡æ¿ â€”â€” æ–°å¢å±æ€§å°±å¾—åŒæ­¥æ”¹ Builderï¼Œä¹Ÿå—å¤Ÿäº†ä¼ ç»Ÿ setter çš„å†—é•¿ã€æ ¡éªŒé€»è¾‘çš„è€¦åˆï¼Œè¿™ä¸ª Lambda æ„å»ºå™¨æ­£æ˜¯è§£æ–¹ã€‚</p>
<p>å®ƒé›¶æ¨¡æ¿ä»£ç ã€ä¸æ”¹é€ å®ä½“ç±»ï¼Œä¸€è¡Œ Lambda æå®šå±æ€§è®¾ç½®ï¼Œæ ¡éªŒéšç”¨éšåŠ ï¼Œæ–°å®ä¾‹åˆ›å»ºæˆ–è€å¯¹è±¡ä¿®æ”¹éƒ½èƒ½æç®€é“¾å¼æ‰¿æ¥ï¼Œè¿˜æ— éœ€ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œç‰¹åˆ«é€‚åˆä¸ªäººå¼€å‘åœºæ™¯ä¸‹å¿«é€Ÿå¤ç”¨ã€‚</p>
<p>ä¸‹æ¬¡æ„å»ºå¯¹è±¡æ—¶ï¼Œç›´æ¥ç”¨InstanceBuilder.of(User.class)å¼€ç¯‡ï¼Œä½“éªŒ â€œ5 è¡Œä»£ç æ›¿ä»£ 20 è¡Œä¼ ç»Ÿ Builderâ€ çš„æ¸…çˆ½ã€‚æœ¬æ–‡å‰æ–‡å·²å®Œæ•´é™„ä¸ŠSetterFunctionä¸InstanceBuilderæºç ï¼Œç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®ä¸­ï¼Œå³å¯é‡æ„ä¸‹ä¸€æ¬¡å¯¹è±¡æ„å»ºã€‚</p>
<p>è‹¥ä½¿ç”¨ä¸­é‡åˆ°ç–‘é—®ã€æœ‰ä¼˜åŒ–å»ºè®®ï¼Œæ¬¢è¿ç•™è¨€äº¤æµï¼›è§‰å¾—å®ç”¨ä¹Ÿå¯æ”¶è—å¤‡ç”¨ï¼Œæ–¹ä¾¿åç»­è‡ªå·±å¤ç”¨æˆ–åˆ†äº«ç»™æœ‰éœ€è¦çš„å¼€å‘è€…æœ‹å‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Arthas çº¿ä¸Šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥æ‰‹å†Œï¼šJava è¯Šæ–­ç¥å™¨ï¼Œ5 åˆ†é’Ÿå®šä½çº¿ä¸Šé—®é¢˜ï¼]]></title>    <link>https://juejin.cn/post/7575133880436228147</link>    <guid>https://juejin.cn/post/7575133880436228147</guid>    <pubDate>2025-11-23T07:38:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575133880436228147" data-draft-id="7575119254313680922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Arthas çº¿ä¸Šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥æ‰‹å†Œï¼šJava è¯Šæ–­ç¥å™¨ï¼Œ5 åˆ†é’Ÿå®šä½çº¿ä¸Šé—®é¢˜ï¼"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-11-23T07:38:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sinoçˆ±å­¦ä¹ "/> <meta itemprop="url" content="https://juejin.cn/user/1873223544473431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Arthas çº¿ä¸Šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥æ‰‹å†Œï¼šJava è¯Šæ–­ç¥å™¨ï¼Œ5 åˆ†é’Ÿå®šä½çº¿ä¸Šé—®é¢˜ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223544473431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sinoçˆ±å­¦ä¹ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:38:59.000Z" title="Sun Nov 23 2025 07:38:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10a4a87f485942cb92b2af3519bc6ce5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2lub-eIseWtpuS5oA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764490187&amp;x-signature=BkgMikxh1aC3tyTrmZ8Mzbpa%2F88%3D" alt="1763883473870.png" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€Arthas æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿ</h2>
<p>Arthas æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€æ¬¾ Java çº¿ä¸Šè¯Šæ–­å·¥å…·ï¼Œæ— éœ€é‡å¯ JVMã€æ— éœ€ä¿®æ”¹ä»£ç ï¼Œå³å¯å®æ—¶ç›‘æ§ã€è¯Šæ–­ Java åº”ç”¨çš„è¿è¡ŒçŠ¶æ€ã€‚</p>
<h3 data-id="heading-1">âœ… é€‚ç”¨åœºæ™¯</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>ä¼ ç»Ÿæ–¹å¼</th><th>Arthas æ–¹å¼</th></tr></thead><tbody><tr><td>çº¿ä¸Š CPU é£™é«˜</td><td><code>top</code> + <code>jstack</code> æ‰‹åŠ¨æŠ“æ ˆ</td><td><code>thread -n 3</code> ä¸€é”®å®šä½</td></tr><tr><td>æ¥å£å“åº”æ…¢</td><td>åŠ æ—¥å¿— â†’ é‡æ–°å‘å¸ƒ</td><td><code>trace</code> è¿½è¸ªè€—æ—¶</td></tr><tr><td>ä»£ç æœªç”Ÿæ•ˆ</td><td>æ€€ç–‘äººç”Ÿ</td><td><code>jad</code> åç¼–è¯‘ç¡®è®¤</td></tr><tr><td>å¼‚å¸¸ä¿¡æ¯ä¸å…¨</td><td>æ—¥å¿—ç¼ºå¤±</td><td><code>watch</code> å®æ—¶è§‚æµ‹</td></tr><tr><td>çƒ­æ›´æ–°</td><td>é‡å¯æœåŠ¡</td><td><code>redefine</code> çƒ­åŠ è½½</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">äºŒã€å¿«é€Ÿå®‰è£…ä¸å¯åŠ¨</h2>
<h3 data-id="heading-3">1. ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">curl -O https://arthas.aliyun.com/arthas-boot.jar
java -jar arthas-boot.jar
</code></pre>
<h3 data-id="heading-4">2. é€‰æ‹©ç›®æ ‡è¿›ç¨‹</h3>
<pre><code class="hljs language-bash" lang="bash">[INFO] Found existing java process, please choose one:
* [1]: 12345 demo.jar
  [2]: 67890 app.jar
</code></pre>
<p>è¾“å…¥ç¼–å·ï¼ˆå¦‚ <code>1</code>ï¼‰å³å¯ attachã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€çº¿ä¸Šé«˜é¢‘å‘½ä»¤é€ŸæŸ¥è¡¨</h2>






































































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>dashboard</code></td><td>å®æ—¶ç³»ç»Ÿé¢æ¿ï¼ˆçº¿ç¨‹ã€å†…å­˜ã€GCï¼‰</td><td><code>dashboard -i 2000 -n 5</code></td></tr><tr><td><code>thread</code></td><td>çº¿ç¨‹åˆ†æ</td><td><code>thread -n 3</code>ï¼ˆæœ€å¿™çº¿ç¨‹ï¼‰<br/><code>thread -b</code>ï¼ˆæ­»é”ï¼‰</td></tr><tr><td><code>trace</code></td><td>æ–¹æ³•è€—æ—¶è¿½è¸ª</td><td><code>trace com.example.UserService getUserById</code></td></tr><tr><td><code>watch</code></td><td>è§‚æµ‹æ–¹æ³•å…¥å‚/è¿”å›å€¼/å¼‚å¸¸</td><td><code>watch com.example.UserService getUserById "{params, returnObj, throwExp}" -x 3</code></td></tr><tr><td><code>jad</code></td><td>åç¼–è¯‘ç±»æˆ–æ–¹æ³•</td><td><code>jad com.example.UserService</code></td></tr><tr><td><code>sc</code></td><td>æŸ¥æ‰¾å·²åŠ è½½çš„ç±»</td><td><code>sc -d com.example.UserService</code></td></tr><tr><td><code>sm</code></td><td>æŸ¥çœ‹ç±»æ–¹æ³•ç­¾å</td><td><code>sm -d com.example.UserService</code></td></tr><tr><td><code>monitor</code></td><td>æ–¹æ³•è°ƒç”¨ç»Ÿè®¡</td><td><code>monitor -c 60 com.example.UserService getUserById</code></td></tr><tr><td><code>tt</code></td><td>æ–¹æ³•è°ƒç”¨æ—¶å…‰éš§é“ï¼ˆè®°å½•ä¸å›æ”¾ï¼‰</td><td><code>tt -t com.example.UserService getUserById</code></td></tr><tr><td><code>heapdump</code></td><td>å¯¼å‡ºå †å¿«ç…§</td><td><code>heapdump /tmp/dump.hprof</code></td></tr><tr><td><code>profiler</code></td><td>ç”Ÿæˆ CPU ç«ç„°å›¾</td><td><code>profiler start</code> â†’ <code>profiler stop --format html</code></td></tr><tr><td><code>redefine</code></td><td>çƒ­æ›´æ–° <code>.class</code> æ–‡ä»¶</td><td><code>redefine /tmp/UserService.class</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">å››ã€å®æˆ˜æ¡ˆä¾‹ï¼š5 åˆ†é’Ÿå®šä½çº¿ä¸Šé—®é¢˜</h2>
<h3 data-id="heading-7">æ¡ˆä¾‹ 1ï¼šCPU é£™é«˜</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹æœ€å¿™çº¿ç¨‹</span>
thread -n 1

<span class="hljs-comment"># 2. æŸ¥çœ‹å †æ ˆ</span>
thread 123

<span class="hljs-comment"># 3. åç¼–è¯‘é—®é¢˜æ–¹æ³•</span>
jad com.example.MyService calculate
</code></pre>
<h3 data-id="heading-8">æ¡ˆä¾‹ 2ï¼šæ¥å£å“åº”æ…¢</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. è¿½è¸ªæ–¹æ³•è€—æ—¶</span>
trace com.example.controller.UserController getProfile

<span class="hljs-comment"># 2. å‘ç°æ•°æ®åº“æŸ¥è¯¢æ…¢</span>
trace com.example.dao.UserDAO findById

<span class="hljs-comment"># 3. æŸ¥çœ‹ SQL å‚æ•°</span>
watch com.example.dao.UserDAO findById <span class="hljs-string">"{params[0]}"</span> -x 1
</code></pre>
<h3 data-id="heading-9">æ¡ˆä¾‹ 3ï¼šä»£ç æœªç”Ÿæ•ˆï¼ˆçƒ­æ›´æ–°ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åç¼–è¯‘æºç </span>
jad com.example.UserService --source-only &gt; /tmp/UserService.java

<span class="hljs-comment"># 2. ä¿®æ”¹ä»£ç åç¼–è¯‘</span>
mc /tmp/UserService.java -d /tmp

<span class="hljs-comment"># 3. çƒ­åŠ è½½</span>
redefine /tmp/com/example/UserService.class
</code></pre>
<hr/>
<h2 data-id="heading-10">äº”ã€æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2>

























<table><thead><tr><th>é¡¹ç›®</th><th>å»ºè®®</th></tr></thead><tbody><tr><td><strong>æƒé™æ§åˆ¶</strong></td><td>ç”Ÿäº§ç¯å¢ƒé™åˆ¶ä½¿ç”¨æƒé™ï¼Œé¿å…è¯¯æ“ä½œ</td></tr><tr><td><strong>æ€§èƒ½å½±å“</strong></td><td><code>watch</code>ã€<code>trace</code> ä¼šå¢å¼ºå­—èŠ‚ç ï¼Œæ’æŸ¥ååŠæ—¶ <code>stop</code> æˆ– <code>reset</code></td></tr><tr><td><strong>å®‰å…¨é£é™©</strong></td><td>ç¦æ­¢å°† Arthas æš´éœ²åœ¨å…¬ç½‘ï¼Œå»ºè®®é€šè¿‡éš§é“æˆ–è·³æ¿æœºè®¿é—®</td></tr><tr><td><strong>å‘½ä»¤å†²çª</strong></td><td><code>redefine</code> ä¸ <code>watch/trace</code> å†²çªï¼Œä½¿ç”¨å‰éœ€ <code>reset</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-11">å…­ã€è¿›é˜¶ï¼šDocker &amp; K8s é›†æˆå»ºè®®</h2>
<h3 data-id="heading-12">Dockerfile ç¤ºä¾‹ï¼ˆé¢„è£… Arthasï¼‰</h3>
<pre><code class="hljs language-dockerfile" lang="dockerfile">FROM openjdk:8-jdk-alpine
COPY arthas /opt/arthas
COPY app.jar /app.jar
CMD java -jar /app.jar &amp; \
    sleep 15 &amp;&amp; \
    java -jar /opt/arthas/arthas-boot.jar --tunnel-server 'ws://tunnel-server:7777/ws' --app-name myapp
</code></pre>
<h3 data-id="heading-13">K8s ä¸€é”® attachï¼ˆæ¨èï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">helm install arthas arthas/arthas-k8s
arthas-k8s attach myapp-0
</code></pre>
<hr/>
<h2 data-id="heading-14">ä¸ƒã€æ€»ç»“ï¼šä¸€å¼ å›¾è®°ä½ Arthas</h2>
<pre><code class="hljs language-text" lang="text">+--------------------------------------------------+
|                    Arthas                        |
|                                                  |
|  dashboard â†’ ç³»ç»Ÿé¢æ¿                            |
|  thread   â†’ çº¿ç¨‹/æ­»é”                            |
|  trace    â†’ æ–¹æ³•è€—æ—¶                             |
|  watch    â†’ å…¥å‚/è¿”å›å€¼/å¼‚å¸¸                      |
|  jad      â†’ åç¼–è¯‘                               |
|  tt       â†’ æ—¶å…‰éš§é“ï¼ˆè®°å½•+å›æ”¾ï¼‰                 |
|  redefine â†’ çƒ­æ›´æ–°                               |
|  profiler â†’ ç«ç„°å›¾                               |
+--------------------------------------------------+
</code></pre>
<hr/>
<h2 data-id="heading-15">å…«ã€å‚è€ƒèµ„æ–™ä¸å»¶ä¼¸é˜…è¯»</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farthas.aliyun.com%2Fdoc%2F" target="_blank" title="https://arthas.aliyun.com/doc/" ref="nofollow noopener noreferrer">Arthas å®˜æ–¹æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas" target="_blank" title="https://github.com/alibaba/arthas" ref="nofollow noopener noreferrer">Arthas GitHub ä»“åº“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farthas.aliyun.com%2Fdoc%2Ftunnel.html" target="_blank" title="https://arthas.aliyun.com/doc/tunnel.html" ref="nofollow noopener noreferrer">Arthas Tunnel é›†ä¸­ç®¡ç†æ–¹æ¡ˆ</a></li>
</ul>
<hr/>
<p><strong>Â© 2025 æŠ€æœ¯åšå®¢ | è½¬è½½è¯·æ³¨æ˜åŸä½œè€…ä¸é“¾æ¥</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[synchronized çš„åº•å±‚åŸç†åŠä¼˜åŒ–æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7575162322239930368</link>    <guid>https://juejin.cn/post/7575162322239930368</guid>    <pubDate>2025-11-23T08:03:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575162322239930368" data-draft-id="7575807729722343458" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="synchronized çš„åº•å±‚åŸç†åŠä¼˜åŒ–æœºåˆ¶"/> <meta itemprop="keywords" content="é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-23T08:03:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éšé£é£˜çš„äº‘"/> <meta itemprop="url" content="https://juejin.cn/user/361110952753560"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            synchronized çš„åº•å±‚åŸç†åŠä¼˜åŒ–æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/361110952753560/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éšé£é£˜çš„äº‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:03:06.000Z" title="Sun Nov 23 2025 08:03:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>synchronized</code>Â æ˜¯ Java å†…ç½®çš„<strong>æ‚²è§‚é”</strong>ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„<strong>åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§</strong>ï¼Œä» JDK 1.6 å¼€å§‹è¿›è¡Œäº†å¤§é‡ä¼˜åŒ–ï¼ˆå¦‚åå‘é”ã€è½»é‡çº§é”ï¼‰ï¼Œæ€§èƒ½å¤§å¹…æå‡ï¼Œæˆä¸ºå¹¶å‘ç¼–ç¨‹ä¸­æœ€å¸¸ç”¨çš„åŒæ­¥æ‰‹æ®µä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€åº•å±‚æ ¸å¿ƒåŸç†</h2>
<p><code>synchronized</code>Â çš„å®ç°ä¾èµ–Â <strong>Java å¯¹è±¡å¤´ï¼ˆMark Wordï¼‰</strong> Â å’ŒÂ <strong>ç›‘è§†å™¨é”ï¼ˆMonitorï¼‰</strong> ï¼Œå…¶æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š<strong>é€šè¿‡ç«äº‰ Monitor çš„æ‰€æœ‰æƒå®ç°çº¿ç¨‹äº’æ–¥</strong>ã€‚</p>
<h3 data-id="heading-1">1. æ ¸å¿ƒä¾èµ–ï¼šç›‘è§†å™¨é”ï¼ˆMonitorï¼‰</h3>
<p>Monitor æ˜¯ JVM å±‚é¢çš„æŠ½è±¡æ¦‚å¿µï¼Œæœ¬è´¨æ˜¯ä¸€ç§<strong>åŒæ­¥å·¥å…·</strong>ï¼Œå¯ç†è§£ä¸º â€œé”çš„æŒæœ‰è€…ç®¡ç†æœºåˆ¶â€ï¼Œæ¯ä¸ª Java å¯¹è±¡éƒ½éšå¼å…³è”ä¸€ä¸ª Monitorï¼ˆå³ â€œå¯¹è±¡é”â€ çš„åº•å±‚è½½ä½“ï¼‰ã€‚</p>
<h4 data-id="heading-2">Monitor çš„ç»“æ„ï¼ˆç®€åŒ–ï¼‰ï¼š</h4>
<ul>
<li><strong>Owner</strong>ï¼šå½“å‰æŒæœ‰é”çš„çº¿ç¨‹ï¼ˆåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼‰ã€‚</li>
<li><strong>EntryList</strong>ï¼šç­‰å¾…è·å–é”çš„çº¿ç¨‹é˜Ÿåˆ—ï¼ˆçº¿ç¨‹å¤„äº BLOCKED çŠ¶æ€ï¼‰ã€‚</li>
<li><strong>WaitSet</strong>ï¼šè°ƒç”¨Â <code>wait()</code>Â åé‡Šæ”¾é”çš„çº¿ç¨‹é˜Ÿåˆ—ï¼ˆçº¿ç¨‹å¤„äº WAITING çŠ¶æ€ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-3">Monitor çš„æ ¸å¿ƒé€»è¾‘ï¼š</h4>
<ol>
<li>
<p>çº¿ç¨‹å°è¯•è·å–é”æ—¶ï¼Œä¼šç«äº‰ Monitor çš„ Owner ä½ç½®ï¼š</p>
<ul>
<li>è‹¥ Owner ä¸ºç©ºï¼Œå½“å‰çº¿ç¨‹ç›´æ¥æˆä¸º Ownerï¼ŒæŒæœ‰é”ã€‚</li>
<li>è‹¥ Owner å·²è¢«å…¶ä»–çº¿ç¨‹å ç”¨ï¼Œå½“å‰çº¿ç¨‹è¿›å…¥ EntryList é˜»å¡ã€‚</li>
</ul>
</li>
<li>
<p>çº¿ç¨‹é‡Šæ”¾é”æ—¶ï¼ˆé€€å‡ºåŒæ­¥å— / æ–¹æ³•ã€è°ƒç”¨Â <code>wait()</code>ï¼‰ï¼š</p>
<ul>
<li>è‹¥è°ƒç”¨Â <code>wait()</code>ï¼Œçº¿ç¨‹é‡Šæ”¾ Owner èº«ä»½ï¼Œè¿›å…¥ WaitSet ç­‰å¾…è¢«å”¤é†’ã€‚</li>
<li>è‹¥æ­£å¸¸é‡Šæ”¾ï¼ŒOwner ç½®ç©ºï¼ŒJVM ä» EntryList å”¤é†’ä¸€ä¸ªçº¿ç¨‹ç«äº‰é”ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-4">2. é”çŠ¶æ€çš„å­˜å‚¨åŸºç¡€ï¼šJava å¯¹è±¡å¤´ï¼ˆMark Wordï¼‰</h3>
<p>Java å¯¹è±¡åœ¨å†…å­˜ä¸­åˆ†ä¸º 3 éƒ¨åˆ†ï¼š<strong>å¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®ã€å¯¹é½å¡«å……</strong>ã€‚å…¶ä¸­ï¼Œ<strong>å¯¹è±¡å¤´çš„ Mark Word æ˜¯å­˜å‚¨é”çŠ¶æ€çš„å…³é”®</strong>ã€‚</p>
<h4 data-id="heading-5">Mark Word çš„ç»“æ„ï¼ˆåŠ¨æ€å˜åŒ–ï¼Œ32 ä½ JVM ç¤ºä¾‹ï¼‰ï¼š</h4>

























<table><thead><tr><th>é”çŠ¶æ€</th><th>Mark Word å­˜å‚¨å†…å®¹</th></tr></thead><tbody><tr><td>æ— é”</td><td>HashCodeï¼ˆ25 ä½ï¼‰ + å¯¹è±¡å¹´é¾„ï¼ˆ4 ä½ï¼‰ + æ˜¯å¦åå‘é”ï¼ˆ1 ä½ï¼Œ0ï¼‰ + é”çŠ¶æ€ï¼ˆ2 ä½ï¼Œ01ï¼‰</td></tr><tr><td>åå‘é”</td><td>åå‘çº¿ç¨‹ IDï¼ˆ23 ä½ï¼‰ + Epochï¼ˆ2 ä½ï¼‰ + å¯¹è±¡å¹´é¾„ï¼ˆ4 ä½ï¼‰ + æ˜¯å¦åå‘é”ï¼ˆ1 ä½ï¼Œ1ï¼‰ + é”çŠ¶æ€ï¼ˆ2 ä½ï¼Œ01ï¼‰</td></tr><tr><td>è½»é‡çº§é”</td><td>æŒ‡å‘æ ˆå¸§ä¸­ â€œé”è®°å½•ï¼ˆLock Recordï¼‰â€ çš„æŒ‡é’ˆï¼ˆ30 ä½ï¼‰ + é”çŠ¶æ€ï¼ˆ2 ä½ï¼Œ00ï¼‰</td></tr><tr><td>é‡é‡çº§é”</td><td>æŒ‡å‘ Monitor çš„æŒ‡é’ˆï¼ˆ30 ä½ï¼‰ + é”çŠ¶æ€ï¼ˆ2 ä½ï¼Œ11ï¼‰</td></tr></tbody></table>
<ul>
<li>é”çŠ¶æ€ç”±Â <strong>2 ä½æ ‡å¿—ä½</strong>Â +Â <strong>æ˜¯å¦åå‘é”æ ‡å¿—ä½</strong>Â å…±åŒå†³å®šã€‚</li>
<li>Mark Word çš„åŠ¨æ€å˜åŒ–æ˜¯Â <code>synchronized</code>Â é”å‡çº§çš„æ ¸å¿ƒä¾æ®ã€‚</li>
</ul>
<h3 data-id="heading-6">3. synchronized çš„ä¸¤ç§ä½¿ç”¨æ–¹å¼åŠåº•å±‚å®ç°</h3>
<p><code>synchronized</code>Â å¯ä¿®é¥°<strong>æ–¹æ³•</strong>æˆ–<strong>ä»£ç å—</strong>ï¼Œåº•å±‚å®ç°ç•¥æœ‰å·®å¼‚ï¼Œä½†æ ¸å¿ƒéƒ½æ˜¯ç«äº‰ Monitorã€‚</p>
<h4 data-id="heading-7">ï¼ˆ1ï¼‰ä¿®é¥°ä»£ç å—ï¼šmonitorenter + monitorexit æŒ‡ä»¤</h4>
<p>ç¼–è¯‘åï¼ŒåŒæ­¥ä»£ç å—çš„å‰åä¼šæ’å…¥Â <code>monitorenter</code>Â å’ŒÂ <code>monitorexit</code>Â å­—èŠ‚ç æŒ‡ä»¤ï¼š</p>
<ul>
<li><strong>monitorenter</strong>ï¼šçº¿ç¨‹è¿›å…¥æ—¶æ‰§è¡Œï¼Œå°è¯•è·å– Monitor æ‰€æœ‰æƒï¼ˆæˆåŠŸåˆ™ Owner è®¾ä¸ºå½“å‰çº¿ç¨‹ï¼Œå¤±è´¥åˆ™é˜»å¡ï¼‰ã€‚</li>
<li><strong>monitorexit</strong>ï¼šçº¿ç¨‹é€€å‡ºæ—¶æ‰§è¡Œï¼Œé‡Šæ”¾ Monitor æ‰€æœ‰æƒï¼ˆOwner ç½®ç©ºï¼Œå”¤é†’ç­‰å¾…çº¿ç¨‹ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šç¼–è¯‘å™¨ä¼šç”ŸæˆÂ <strong>2 ä¸ª monitorexit</strong>ï¼šä¸€ä¸ªå¯¹åº”æ­£å¸¸é€€å‡ºï¼Œä¸€ä¸ªå¯¹åº”å¼‚å¸¸é€€å‡ºï¼ˆç¡®ä¿é”ä¸€å®šé‡Šæ”¾ï¼Œé¿å…æ­»é”ï¼‰ã€‚</p>
</blockquote>
<h4 data-id="heading-8">ï¼ˆ2ï¼‰ä¿®é¥°æ–¹æ³•ï¼šACC_SYNCHRONIZED æ ‡å¿—</h4>
<p>ä¿®é¥°æ–¹æ³•æ—¶ï¼Œå­—èŠ‚ç ä¸­ä¸ä¼šæ’å…¥æŒ‡ä»¤ï¼Œè€Œæ˜¯åœ¨<strong>æ–¹æ³•è¡¨ï¼ˆmethod_infoï¼‰</strong> Â ä¸­æ·»åŠ Â <code>ACC_SYNCHRONIZED</code>Â æ ‡å¿—ï¼š</p>
<ul>
<li>çº¿ç¨‹è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒJVM æ£€æŸ¥è¯¥æ ‡å¿—ï¼šè‹¥å­˜åœ¨ï¼Œå…ˆè·å– Monitor é”ï¼Œå†æ‰§è¡Œæ–¹æ³•ä½“ã€‚</li>
<li>æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼ˆæ­£å¸¸è¿”å› / æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼ŒJVM è‡ªåŠ¨é‡Šæ”¾ Monitor é”ã€‚</li>
</ul>
<h4 data-id="heading-9">ç±»é” vs å¯¹è±¡é”</h4>
<ul>
<li><strong>å¯¹è±¡é”</strong>ï¼šä¿®é¥°å®ä¾‹æ–¹æ³•æˆ–ä»£ç å—ï¼ˆé”å¯¹è±¡ä¸ºÂ <code>this</code>Â æˆ–è‡ªå®šä¹‰å¯¹è±¡ï¼‰ï¼Œç«äº‰çš„æ˜¯ â€œå®ä¾‹å¯¹è±¡å…³è”çš„ Monitorâ€ã€‚</li>
<li><strong>ç±»é”</strong>ï¼šä¿®é¥°é™æ€æ–¹æ³•æˆ–ä»£ç å—ï¼ˆé”å¯¹è±¡ä¸ºÂ <code>XXX.class</code>ï¼‰ï¼Œç«äº‰çš„æ˜¯ â€œç±»å¯¹è±¡ï¼ˆClass å®ä¾‹ï¼‰å…³è”çš„ Monitorâ€ã€‚</li>
<li>æœ¬è´¨ï¼šç±»é”ä¹Ÿæ˜¯å¯¹è±¡é”ï¼ˆClass æ˜¯ JVM åŠ è½½çš„å•ä¾‹å¯¹è±¡ï¼‰ï¼Œä¸¤è€…ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚</li>
</ul>
<h2 data-id="heading-10">äºŒã€JDK 1.6+ æ ¸å¿ƒä¼˜åŒ–æœºåˆ¶</h2>
<p>æ—©æœŸÂ <code>synchronized</code>Â æ˜¯ â€œé‡é‡çº§é”â€ï¼Œçº¿ç¨‹ç«äº‰å¤±è´¥ä¼šç›´æ¥é˜»å¡ï¼ˆåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå¼€é”€å¤§ï¼‰ã€‚JDK 1.6 å¼•å…¥<strong>é”å‡çº§æœºåˆ¶</strong>å’Œå…¶ä»–ä¼˜åŒ–ï¼Œè®©Â <code>synchronized</code>Â åœ¨æ— ç«äº‰ / è½»åº¦ç«äº‰åœºæ™¯ä¸‹æ€§èƒ½æ¥è¿‘ä¹è§‚é”ï¼ˆå¦‚Â <code>ReentrantLock</code>ï¼‰ã€‚</p>
<p>æ ¸å¿ƒä¼˜åŒ–æ€è·¯ï¼š<strong>æ ¹æ®ç«äº‰å¼ºåº¦åŠ¨æ€åˆ‡æ¢é”çŠ¶æ€ï¼ˆæ— é” â†’ åå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”ï¼‰ï¼Œå‡å°‘æ— ç«äº‰ / è½»åº¦ç«äº‰æ—¶çš„å¼€é”€</strong>ã€‚</p>
<h3 data-id="heading-11">1. é”å‡çº§æœºåˆ¶ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰</h3>
<p>é”å‡çº§æ˜¯ä¸å¯é€†çš„ï¼ˆåªèƒ½ä»ä½å¼€é”€å‘é«˜å¼€é”€å‡çº§ï¼‰ï¼Œç›®çš„æ˜¯ â€œæŒ‰éœ€åˆ†é…èµ„æºâ€ï¼šæ— ç«äº‰æ—¶ç”¨åå‘é”ï¼Œè½»åº¦ç«äº‰æ—¶ç”¨è½»é‡çº§é”ï¼Œæ¿€çƒˆç«äº‰æ—¶ç”¨é‡é‡çº§é”ã€‚</p>
<h4 data-id="heading-12">ï¼ˆ1ï¼‰åå‘é”ï¼šæ— ç«äº‰åœºæ™¯çš„æœ€ä¼˜è§£</h4>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé”ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å–ï¼Œæ— å…¶ä»–çº¿ç¨‹ç«äº‰ï¼ˆå¦‚å•çº¿ç¨‹å¾ªç¯è°ƒç”¨åŒæ­¥æ–¹æ³•ï¼‰ã€‚<strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šâ€œåå‘â€ ç¬¬ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹ï¼Œåç»­è¯¥çº¿ç¨‹æ— éœ€ç«äº‰ï¼Œç›´æ¥æŒæœ‰é”ã€‚</p>
<h5 data-id="heading-13">å®ç°åŸç†ï¼š</h5>
<ol>
<li>
<p>çº¿ç¨‹ç¬¬ä¸€æ¬¡è·å–é”æ—¶ï¼Œé€šè¿‡ CAS å°† Mark Word ä¸­çš„ â€œåå‘çº¿ç¨‹ IDâ€ è®¾ä¸ºå½“å‰çº¿ç¨‹ IDï¼Œâ€œæ˜¯å¦åå‘é”â€ è®¾ä¸º 1ï¼Œé”çŠ¶æ€ä¿æŒ 01ï¼ˆåå‘é”æ ‡è¯†ï¼‰ã€‚</p>
</li>
<li>
<p>åç»­è¯¥çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä»…éœ€æ£€æŸ¥ï¼š</p>
<ul>
<li>Mark Word ä¸­çš„åå‘çº¿ç¨‹ ID æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹ã€‚</li>
<li>åå‘é”æ ‡å¿—æ˜¯å¦ä¸º 1ã€‚</li>
<li>é”çŠ¶æ€æ˜¯å¦ä¸º 01ã€‚æ»¡è¶³åˆ™ç›´æ¥è·å–é”ï¼Œæ— éœ€ CAS æˆ–é˜»å¡ï¼Œå¼€é”€æä½ã€‚</li>
</ul>
</li>
</ol>
<h5 data-id="heading-14">åå‘é”çš„æ’¤é”€ï¼š</h5>
<p>å½“æœ‰å…¶ä»–çº¿ç¨‹å°è¯•ç«äº‰åå‘é”æ—¶ï¼Œåå‘é”ä¼šè¢« â€œæ’¤é”€â€ï¼Œå‡çº§ä¸ºè½»é‡çº§é”ã€‚æ’¤é”€æµç¨‹ï¼š</p>
<ol>
<li>
<p>æš‚åœæŒæœ‰åå‘é”çš„çº¿ç¨‹ï¼ˆSTW çŸ­æš‚åœé¡¿ï¼‰ã€‚</p>
</li>
<li>
<p>æ£€æŸ¥æŒæœ‰çº¿ç¨‹çš„çŠ¶æ€ï¼š</p>
<ul>
<li>è‹¥çº¿ç¨‹å·²ç»ˆæ­¢ï¼Œç›´æ¥å°† Mark Word é‡ç½®ä¸ºæ— é”çŠ¶æ€ã€‚</li>
<li>è‹¥çº¿ç¨‹ä»å­˜æ´»ï¼Œå°†é”å‡çº§ä¸ºè½»é‡çº§é”ï¼ŒæŒæœ‰çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œç«äº‰çº¿ç¨‹è¿›å…¥è½»é‡çº§é”ç«äº‰ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-15">ï¼ˆ2ï¼‰è½»é‡çº§é”ï¼šè½»åº¦ç«äº‰åœºæ™¯çš„ä¼˜åŒ–</h4>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå°‘é‡çº¿ç¨‹ç«äº‰é”ï¼Œä¸”ç«äº‰æ—¶é—´çŸ­ï¼ˆå¦‚ä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è·å–é”ï¼‰ã€‚<strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šç”¨ â€œè‡ªæ—‹â€ æ›¿ä»£ â€œé˜»å¡â€ï¼Œé¿å…çº¿ç¨‹åˆ‡æ¢åˆ°å†…æ ¸æ€çš„å¼€é”€ã€‚</p>
<h5 data-id="heading-16">å®ç°åŸç†ï¼š</h5>
<ol>
<li>
<p>çº¿ç¨‹è·å–é”æ—¶ï¼Œå…ˆåœ¨å½“å‰æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªÂ <strong>Lock Recordï¼ˆé”è®°å½•ï¼‰</strong> ï¼Œå­˜å‚¨å¯¹è±¡å½“å‰çš„ Mark Word å‰¯æœ¬ï¼ˆDisplaced Mark Wordï¼‰ã€‚</p>
</li>
<li>
<p>é€šè¿‡ CAS å°†å¯¹è±¡çš„ Mark Word æ›´æ–°ä¸º â€œæŒ‡å‘å½“å‰ Lock Record çš„æŒ‡é’ˆâ€ï¼š</p>
<ul>
<li>CAS æˆåŠŸï¼šçº¿ç¨‹è·å–è½»é‡çº§é”ï¼Œé”çŠ¶æ€å˜ä¸º 00ã€‚</li>
<li>CAS å¤±è´¥ï¼šè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹ç«äº‰ï¼Œæ­¤æ—¶ä¼šå…ˆè‡ªæ—‹ï¼ˆç©ºå¾ªç¯ï¼‰å‡ æ¬¡ï¼Œå°è¯•å†æ¬¡è·å–é”ã€‚</li>
</ul>
</li>
</ol>
<h5 data-id="heading-17">è½»é‡çº§é”çš„è†¨èƒ€ï¼š</h5>
<p>è‹¥è‡ªæ—‹å¤±è´¥ï¼ˆå¦‚è‡ªæ—‹æ¬¡æ•°è€—å°½ä»æœªè·å–é”ï¼Œæˆ–æœ‰æ›´å¤šçº¿ç¨‹å‚ä¸ç«äº‰ï¼‰ï¼Œè½»é‡çº§é”ä¼š â€œè†¨èƒ€â€ ä¸ºé‡é‡çº§é”ï¼š</p>
<ol>
<li>å°† Mark Word ä¸­çš„æŒ‡é’ˆæ”¹ä¸º â€œæŒ‡å‘ Monitor çš„æŒ‡é’ˆâ€ï¼Œé”çŠ¶æ€å˜ä¸º 11ã€‚</li>
<li>æœªè·å–é”çš„çº¿ç¨‹è¿›å…¥ EntryList é˜»å¡ï¼ˆBLOCKED çŠ¶æ€ï¼‰ï¼Œé¿å…æ— æ•ˆè‡ªæ—‹æµªè´¹ CPUã€‚</li>
</ol>
<h4 data-id="heading-18">ï¼ˆ3ï¼‰é‡é‡çº§é”ï¼šæ¿€çƒˆç«äº‰åœºæ™¯çš„å…œåº•</h4>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ç«äº‰é”ï¼Œä¸”ç«äº‰æ—¶é—´é•¿ï¼ˆå¦‚çº¿ç¨‹æŒæœ‰é”æ‰§è¡Œè€—æ—¶æ“ä½œï¼‰ã€‚<strong>å®ç°åŸç†</strong>ï¼šä¾èµ–æ“ä½œç³»ç»Ÿçš„Â <strong>äº’æ–¥é‡ï¼ˆMutexï¼‰</strong> Â å®ç°ï¼Œçº¿ç¨‹ç«äº‰å¤±è´¥ä¼šç›´æ¥é˜»å¡ï¼ˆä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼‰ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚<strong>ç‰¹ç‚¹</strong>ï¼šå¼€é”€æœ€å¤§ï¼ˆçº¿ç¨‹é˜»å¡ / å”¤é†’éœ€å†…æ ¸æ€åˆ‡æ¢ï¼‰ï¼Œä½†ç¨³å®šæ€§æœ€é«˜ï¼Œé€‚åˆæ¿€çƒˆç«äº‰åœºæ™¯ã€‚</p>
<h3 data-id="heading-19">2. å…¶ä»–å…³é”®ä¼˜åŒ–</h3>
<h4 data-id="heading-20">ï¼ˆ1ï¼‰è‡ªæ—‹é”ä¸é€‚åº”æ€§è‡ªæ—‹é”</h4>
<ul>
<li>
<p><strong>è‡ªæ—‹é”</strong>ï¼šè½»é‡çº§é”ç«äº‰æ—¶ï¼Œçº¿ç¨‹ä¸ç›´æ¥é˜»å¡ï¼Œè€Œæ˜¯è‡ªæ—‹ï¼ˆç©ºå¾ªç¯ï¼‰ä¸€æ®µæ—¶é—´ï¼ˆé»˜è®¤ 10 æ¬¡ï¼‰ï¼Œç­‰å¾…æŒæœ‰é”çš„çº¿ç¨‹å¿«é€Ÿé‡Šæ”¾ã€‚è‡ªæ—‹æ— éœ€åˆ‡æ¢å†…æ ¸æ€ï¼Œé€‚åˆé”æŒæœ‰æ—¶é—´çŸ­çš„åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>é€‚åº”æ€§è‡ªæ—‹é”</strong>ï¼šJDK 1.6 ä¼˜åŒ–ï¼Œè‡ªæ—‹æ¬¡æ•°ä¸å†å›ºå®šï¼Œè€Œæ˜¯æ ¹æ® â€œå†å²è‡ªæ—‹æˆåŠŸç‡â€ åŠ¨æ€è°ƒæ•´ï¼š</p>
<ul>
<li>è‹¥ä¹‹å‰è‡ªæ—‹æˆåŠŸè·å–é”ï¼Œä¸‹æ¬¡è‡ªæ—‹æ¬¡æ•°å¢åŠ ï¼ˆå¦‚ 20 æ¬¡ï¼‰ã€‚</li>
<li>è‹¥ä¹‹å‰è‡ªæ—‹å¤±è´¥ï¼Œä¸‹æ¬¡è‡ªæ—‹æ¬¡æ•°å‡å°‘æˆ–ç›´æ¥æ”¾å¼ƒè‡ªæ—‹ï¼ˆé¿å…æµªè´¹ CPUï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-21">ï¼ˆ2ï¼‰é”æ¶ˆé™¤</h4>
<p>JIT ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ï¼Œé€šè¿‡<strong>é€ƒé€¸åˆ†æ</strong>åˆ¤æ–­ï¼šè‹¥ä¸€ä¸ªé”å¯¹è±¡ä»…è¢«å½“å‰çº¿ç¨‹è®¿é—®ï¼ˆæ— é€ƒé€¸åˆ°å…¶ä»–çº¿ç¨‹ï¼‰ï¼Œåˆ™ç›´æ¥æ¶ˆé™¤è¯¥é”ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼š<code>StringBuffer</code>Â çš„Â <code>append()</code>Â æ–¹æ³•æ˜¯åŒæ­¥æ–¹æ³•ï¼Œä½†å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒJIT ä¼šæ¶ˆé™¤å…¶é”ï¼ˆå› ä¸ºÂ <code>StringBuffer</code>Â å¯¹è±¡æœªé€ƒé€¸ï¼Œæ— éœ€åŒæ­¥ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-22">ï¼ˆ3ï¼‰é”ç²—åŒ–</h4>
<p>è‹¥å¤šä¸ªè¿ç»­çš„é”æ“ä½œé’ˆå¯¹<strong>åŒä¸€ä¸ªå¯¹è±¡</strong>ï¼ŒJIT ä¼šå°†è¿™äº›åˆ†æ•£çš„é”åˆå¹¶ä¸ºä¸€ä¸ª â€œç²—ç²’åº¦é”â€ï¼Œå‡å°‘é”çš„è·å– / é‡Šæ”¾æ¬¡æ•°ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šå¾ªç¯ä¸­å¤šæ¬¡è°ƒç”¨Â <code>synchronized (this) { ... }</code>ï¼ŒJIT ä¼šå°†é”ç²—åŒ–åˆ°å¾ªç¯å¤–éƒ¨ï¼Œä»…è·å–ä¸€æ¬¡é”å³å¯ã€‚</li>
</ul>
<h2 data-id="heading-23">ä¸‰ã€synchronized å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Œæœ‰åºæ€§ï¼ŒåŸå­æ€§</h2>
<p><code>synchronized</code>Â æ˜¯ Java ä¸­å”¯ä¸€èƒ½åŒæ—¶ä¿è¯Â <strong>åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§</strong>Â çš„å†…ç½®åŒæ­¥æœºåˆ¶ï¼Œå…¶ä¿éšœé€»è¾‘å®Œå…¨åŸºäºåº•å±‚çš„Â <strong>Monitor ç›‘è§†å™¨é”</strong>Â å’ŒÂ <strong>JMMï¼ˆJava å†…å­˜æ¨¡å‹ï¼‰è§„åˆ™</strong>ï¼Œä¸ä¹‹å‰æåˆ°çš„åº•å±‚åŸç†ï¼ˆå¦‚é”è·å– / é‡Šæ”¾ã€å¯¹è±¡å¤´æ“ä½œï¼‰æ·±åº¦ç»‘å®šã€‚ä¸‹é¢åˆ†ä¸‰ä¸ªç‰¹æ€§ï¼Œæ‹†è§£å…¶å…·ä½“ä¿éšœæœºåˆ¶ï¼š</p>
<h3 data-id="heading-24">1ã€ä¿è¯åŸå­æ€§ï¼šåŸºäº Monitor çš„äº’æ–¥æ‰§è¡Œ</h3>
<h4 data-id="heading-25">1.1. åŸå­æ€§çš„å®šä¹‰</h4>
<p>åŸå­æ€§æŒ‡Â <strong>ä¸€ä¸ªæ“ä½œæˆ–ä¸€ç»„æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œä¸”æ‰§è¡Œè¿‡ç¨‹ä¸è¢«æ‰“æ–­ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</strong>ï¼ˆä¸å¯åˆ†å‰²ï¼‰ã€‚æ¯”å¦‚Â <code>i++</code>Â æœ¬è´¨æ˜¯ã€Œè¯»å– i â†’ åŠ  1 â†’ å†™å…¥ iã€ä¸‰ä¸ªæ­¥éª¤ï¼Œè‹¥ä¸åŠ åŒæ­¥ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­ï¼Œå¯¼è‡´ç»“æœé”™è¯¯ã€‚</p>
<h4 data-id="heading-26">1.2. synchronized å¦‚ä½•ä¿è¯åŸå­æ€§ï¼Ÿ</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼š<strong>é€šè¿‡ Monitor é”çš„äº’æ–¥æ€§ï¼Œç¡®ä¿åŒæ­¥å— / æ–¹æ³•åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</strong>ã€‚</p>
<p>ç»“åˆåº•å±‚åŸç†çš„ç»†èŠ‚ï¼š</p>
<ul>
<li>çº¿ç¨‹è¦è¿›å…¥åŒæ­¥å— / æ–¹æ³•ï¼Œå¿…é¡»å…ˆè·å– Monitor çš„æ‰€æœ‰æƒï¼ˆé€šè¿‡Â <code>monitorenter</code>Â æŒ‡ä»¤æˆ–Â <code>ACC_SYNCHRONIZED</code>Â æ ‡å¿—ï¼‰ã€‚</li>
<li>Monitor çš„Â <code>Owner</code>Â å­—æ®µåŒä¸€æ—¶é—´åªèƒ½æŒ‡å‘ä¸€ä¸ªçº¿ç¨‹ï¼ˆäº’æ–¥æ€§ï¼‰ï¼Œå…¶ä»–ç«äº‰çº¿ç¨‹ä¼šè¢«é˜»å¡åœ¨Â <code>EntryList</code>ï¼ˆBLOCKED çŠ¶æ€ï¼‰ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹é‡Šæ”¾é”ã€‚</li>
<li>åŒæ­¥å— / æ–¹æ³•å†…çš„æ‰€æœ‰æ“ä½œï¼Œä¼šä½œä¸ºä¸€ä¸ª â€œæ•´ä½“â€ è¢«æ‰§è¡Œ â€”â€” åœ¨å½“å‰çº¿ç¨‹é‡Šæ”¾é”å‰ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æ’å…¥æ‰§è¡Œï¼Œå› æ­¤è¿™ç»„æ“ä½œå…·å¤‡ä¸å¯åˆ†å‰²çš„åŸå­æ€§ã€‚</li>
</ul>
<h4 data-id="heading-27">ç¤ºä¾‹éªŒè¯ï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">void</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span> </span>{
    count++; <span class="hljs-comment">// è¯»å–ã€åŠ 1ã€å†™å…¥ä¸‰ä¸ªæ­¥éª¤ï¼Œè¢«synchronizedä¿è¯ä¸ºåŸå­æ“ä½œ</span>
}
</code></pre>
<ul>
<li>è‹¥ä¸åŠ Â <code>synchronized</code>ï¼Œ1000 ä¸ªçº¿ç¨‹å„è°ƒç”¨ 1000 æ¬¡Â <code>increment()</code>ï¼Œæœ€ç»ˆÂ <code>count</code>Â ä¼šå°äº 1000000ï¼ˆå› æ­¥éª¤è¢«æ‰“æ–­ï¼‰ã€‚</li>
<li>åŠ Â <code>synchronized</code>Â åï¼Œ<code>count++</code>Â çš„ä¸‰ä¸ªæ­¥éª¤è¢« â€œä¸²è¡ŒåŒ–â€ï¼Œæœ€ç»ˆç»“æœå¿…ç„¶æ˜¯ 1000000ï¼ŒåŸå­æ€§å¾—åˆ°ä¿è¯ã€‚</li>
</ul>
<h4 data-id="heading-28">è¡¥å……ï¼šå¯é‡å…¥æ€§ä¸ç ´ååŸå­æ€§</h4>
<p><code>synchronized</code>Â æ˜¯å¯é‡å…¥é”ï¼ˆåŒä¸€çº¿ç¨‹å¯å¤šæ¬¡è·å–åŒä¸€é”ï¼‰ï¼Œä½†å¤šæ¬¡è·å–ä¸ä¼šæ‰“ç ´äº’æ–¥æ€§ â€”â€” å…¶ä»–çº¿ç¨‹ä»éœ€ç­‰å¾…å½“å‰çº¿ç¨‹å®Œå…¨é‡Šæ”¾é”ï¼ˆæ‰€æœ‰é‡å…¥çš„é”éƒ½é‡Šæ”¾ï¼‰æ‰èƒ½ç«äº‰ï¼Œå› æ­¤åŸå­æ€§ä¾ç„¶æˆç«‹ã€‚</p>
<h3 data-id="heading-29">2ã€ä¿è¯å¯è§æ€§ï¼šåŸºäºé”é‡Šæ”¾ / è·å–çš„å†…å­˜åˆ·æ–°è§„åˆ™</h3>
<h4 data-id="heading-30">2.1. å¯è§æ€§çš„å®šä¹‰</h4>
<p>å¯è§æ€§æŒ‡Â <strong>ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼åï¼Œå…¶ä»–çº¿ç¨‹èƒ½ç«‹åˆ»æ„ŸçŸ¥åˆ°è¿™ä¸ªä¿®æ”¹</strong>ã€‚è‹¥æ²¡æœ‰å¯è§æ€§ä¿éšœï¼Œçº¿ç¨‹ A ä¿®æ”¹çš„å˜é‡å¯èƒ½åªå­˜åœ¨äºè‡ªå·±çš„å·¥ä½œå†…å­˜ä¸­ï¼ŒæœªåŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œçº¿ç¨‹ B è¯»å–çš„ä»æ˜¯ä¸»å†…å­˜ä¸­æ—§å€¼ã€‚</p>
<h4 data-id="heading-31">2.2. synchronized å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Ÿ</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼š<strong>JMM ä¸ºÂ <code>synchronized</code>Â å®šä¹‰äº†ã€Œé”é‡Šæ”¾ - è·å–çš„å†…å­˜è¯­ä¹‰ã€ï¼Œå¼ºåˆ¶åˆ·æ–°å…±äº«å˜é‡çš„å†…å­˜</strong>ã€‚</p>
<p>å…·ä½“è§„åˆ™ï¼ˆä¸åº•å±‚é”æ“ä½œç»‘å®šï¼‰ï¼š</p>
<ul>
<li><strong>é”é‡Šæ”¾æ—¶ï¼šå¼ºåˆ¶åˆ·æ–°å·¥ä½œå†…å­˜åˆ°ä¸»å†…å­˜</strong>çº¿ç¨‹é‡Šæ”¾ Monitor é”æ—¶ï¼ˆæ‰§è¡ŒÂ <code>monitorexit</code>Â æŒ‡ä»¤ï¼Œæˆ–æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼‰ï¼ŒJVM ä¼šè§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼šå°†è¯¥çº¿ç¨‹åœ¨å·¥ä½œå†…å­˜ä¸­ä¿®æ”¹çš„æ‰€æœ‰å…±äº«å˜é‡ï¼Œ<strong>å¼ºåˆ¶åˆ·æ–°åˆ°ä¸»å†…å­˜</strong>ï¼ˆæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­çš„ç¼“å­˜ï¼Œç¡®ä¿ä¸»å†…å­˜æ˜¯æœ€æ–°å€¼ï¼‰ã€‚</li>
<li><strong>é”è·å–æ—¶ï¼šå¼ºåˆ¶ä»ä¸»å†…å­˜åŠ è½½æœ€æ–°å€¼</strong>çº¿ç¨‹è·å– Monitor é”æ—¶ï¼ˆæ‰§è¡ŒÂ <code>monitorenter</code>Â æŒ‡ä»¤ï¼Œæˆ–è°ƒç”¨åŒæ­¥æ–¹æ³•ï¼‰ï¼ŒJVM ä¼šè§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼šå°†è¯¥çº¿ç¨‹å·¥ä½œå†…å­˜ä¸­å¯¹åº”çš„å…±äº«å˜é‡Â <strong>ç½®ä¸ºæ— æ•ˆ</strong>ï¼Œåç»­è¯»å–è¯¥å˜é‡æ—¶ï¼Œå¿…é¡»ä»ä¸»å†…å­˜é‡æ–°åŠ è½½ï¼ˆç¡®ä¿æ‹¿åˆ°çš„æ˜¯æœ€æ–°å€¼ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-32">ç¤ºä¾‹éªŒè¯ï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> flag = <span class="hljs-literal">false</span>;
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">void</span> <span class="hljs-title">setFlag</span><span class="hljs-params">()</span> </span>{
    flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// çº¿ç¨‹Aä¿®æ”¹åï¼Œé‡Šæ”¾é”æ—¶åˆ·æ–°åˆ°ä¸»å†…å­˜</span>
}
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">void</span> <span class="hljs-title">checkFlag</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (flag) { <span class="hljs-comment">// çº¿ç¨‹Bè·å–é”æ—¶ï¼Œä»ä¸»å†…å­˜åŠ è½½æœ€æ–°çš„flagï¼ˆtrueï¼‰</span>
        System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"æ„ŸçŸ¥åˆ°flagä¿®æ”¹"</span>);
    }
}
</code></pre>
<ul>
<li>è‹¥ä¸åŠ Â <code>synchronized</code>ï¼Œçº¿ç¨‹ A ä¿®æ”¹å˜é‡åå¯èƒ½æœªåˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œçº¿ç¨‹ B ä¸€ç›´è¯»å–å·¥ä½œå†…å­˜ä¸­çš„æ—§å€¼Â <code>false</code>ï¼Œæ— æ³•æ„ŸçŸ¥ä¿®æ”¹ã€‚</li>
<li>åŠ Â <code>synchronized</code>Â åï¼Œé”é‡Šæ”¾ / è·å–çš„å†…å­˜è¯­ä¹‰ç¡®ä¿äº†Â <code>flag</code>Â çš„ä¿®æ”¹å¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚</li>
</ul>
<h3 data-id="heading-33">3ã€ä¿è¯æœ‰åºæ€§ï¼šåŸºäºäº’æ–¥æ‰§è¡Œ + happens-before è§„åˆ™</h3>
<h4 data-id="heading-34">3.1. æœ‰åºæ€§çš„å®šä¹‰</h4>
<p>æœ‰åºæ€§æŒ‡Â <strong>ç¨‹åºæ‰§è¡Œçš„é¡ºåºä¸ä»£ç ç¼–å†™çš„é¡ºåºä¸€è‡´</strong>ï¼Œé¿å…å› ã€ŒæŒ‡ä»¤é‡æ’åºã€å¯¼è‡´çš„å¤šçº¿ç¨‹æ‰§è¡Œæ··ä¹±ã€‚JIT ç¼–è¯‘å™¨ã€CPU ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œä¼šåœ¨ä¸å½±å“å•çº¿ç¨‹æ‰§è¡Œç»“æœçš„å‰æä¸‹é‡æ’åºæŒ‡ä»¤ï¼Œä½†å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å¯¼è‡´é”™è¯¯ã€‚</p>
<h4 data-id="heading-35">3.2. synchronized å¦‚ä½•ä¿è¯æœ‰åºæ€§ï¼Ÿ</h4>
<p>æ ¸å¿ƒé€»è¾‘ï¼š<strong>é€šè¿‡ã€Œäº’æ–¥æ‰§è¡Œçš„ä¸²è¡ŒåŒ–ã€å’Œã€ŒJMM çš„ happens-before è§„åˆ™ã€ï¼Œé—´æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’åºçš„å¯è§æ€§</strong>ã€‚</p>
<h5 data-id="heading-36">ï¼ˆ1ï¼‰äº’æ–¥æ‰§è¡Œçš„ä¸²è¡ŒåŒ–ä¿éšœ</h5>
<p>ç”±äºåŒæ­¥å— / æ–¹æ³•åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œç›¸å½“äºå°†å¤šçº¿ç¨‹æ‰§è¡Œè½¬åŒ–ä¸ºã€Œå•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œã€ã€‚è€Œå•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒæŒ‡ä»¤é‡æ’åºä¸ä¼šå½±å“æ‰§è¡Œç»“æœï¼ˆas-if-serial è¯­ä¹‰ï¼‰â€”â€” æ— è®ºæŒ‡ä»¤å¦‚ä½•é‡æ’ï¼Œå•çº¿ç¨‹æ‰§è¡Œçš„æœ€ç»ˆç»“æœä¸ä»£ç é¡ºåºä¸€è‡´ï¼Œå› æ­¤å¤šçº¿ç¨‹é€šè¿‡Â <code>synchronized</code>Â æ‰§è¡Œæ—¶ï¼Œä¸ä¼šå‡ºç°å› é‡æ’åºå¯¼è‡´çš„é€»è¾‘é”™è¯¯ã€‚</p>
<h5 data-id="heading-37">ï¼ˆ2ï¼‰happens-before è§„åˆ™çš„å¼ºçº¦æŸ</h5>
<p>JMM å®šä¹‰äº†ã€Œç›‘è§†å™¨é”è§„åˆ™ã€ï¼š<strong>å¯¹åŒä¸€ä¸ªé”çš„è§£é”æ“ä½œï¼ˆunlockï¼‰ï¼Œhappens-before äºåç»­å¯¹è¯¥é”çš„åŠ é”æ“ä½œï¼ˆlockï¼‰</strong> ã€‚</p>
<ul>
<li>
<p><code>happens-before</code>Â çš„å«ä¹‰ï¼šè‹¥æ“ä½œ A happens-before æ“ä½œ Bï¼Œåˆ™ A çš„æ‰§è¡Œç»“æœå¯¹ B å¯è§ï¼Œä¸” A çš„æ‰§è¡Œé¡ºåºåœ¨ B ä¹‹å‰ï¼ˆç¦æ­¢ A ä¹‹åçš„æŒ‡ä»¤é‡æ’åºåˆ° A ä¹‹å‰ï¼Œä¹Ÿç¦æ­¢ B ä¹‹å‰çš„æŒ‡ä»¤é‡æ’åºåˆ° B ä¹‹åï¼‰ã€‚</p>
</li>
<li>
<p>å…·ä½“æ•ˆæœï¼šåŒæ­¥å—å†…çš„æ‰€æœ‰æ“ä½œï¼ˆè§£é”å‰çš„æ“ä½œï¼‰ï¼Œhappens-before äºåç»­è·å–è¯¥é”çš„çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œï¼ˆåŠ é”åçš„æ“ä½œï¼‰ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>åŒæ­¥å—å†…çš„æŒ‡ä»¤å¯ä»¥é‡æ’åºï¼Œä½†ä¸ä¼šé‡æ’åºåˆ°åŒæ­¥å—å¤–éƒ¨ï¼ˆè§£é”åï¼‰ã€‚</li>
<li>åç»­çº¿ç¨‹è·å–é”åï¼Œèƒ½çœ‹åˆ°å‰ä¸€ä¸ªçº¿ç¨‹åŒæ­¥å—å†…æ‰€æœ‰æ“ä½œçš„ç»“æœï¼ˆåŒ…æ‹¬æŒ‡ä»¤é‡æ’åºåçš„æ­£ç¡®ç»“æœï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-38">ç¤ºä¾‹éªŒè¯ï¼ˆé¿å…é‡æ’åºé—®é¢˜ï¼‰ï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> a = <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> ready = <span class="hljs-literal">false</span>;

<span class="hljs-comment">// çº¿ç¨‹Aæ‰§è¡Œ</span>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">void</span> <span class="hljs-title">write</span><span class="hljs-params">()</span> </span>{
    a = <span class="hljs-number">1</span>;      <span class="hljs-comment">// æ“ä½œ1</span>
    ready = <span class="hljs-literal">true</span>;<span class="hljs-comment">// æ“ä½œ2</span>
}

<span class="hljs-comment">// çº¿ç¨‹Bæ‰§è¡Œ</span>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">void</span> <span class="hljs-title">read</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (ready) { <span class="hljs-comment">// æ“ä½œ3</span>
        System.out.<span class="hljs-built_in">println</span>(a); <span class="hljs-comment">// æ“ä½œ4ï¼Œå¿…ç„¶è¾“å‡º1</span>
    }
}
</code></pre>
<ul>
<li>
<p>è‹¥ä¸åŠ Â <code>synchronized</code>ï¼ŒCPU å¯èƒ½å°†çº¿ç¨‹ A çš„ã€Œæ“ä½œ 1 å’Œæ“ä½œ 2ã€é‡æ’åºï¼ˆå…ˆæ‰§è¡ŒÂ <code>ready=true</code>ï¼Œå†æ‰§è¡ŒÂ <code>a=1</code>ï¼‰ï¼Œå¯¼è‡´çº¿ç¨‹ B æ‰§è¡Œæ—¶Â <code>ready=true</code>Â ä½†Â <code>a=0</code>ï¼Œè¾“å‡ºé”™è¯¯ã€‚</p>
</li>
<li>
<p>åŠ Â <code>synchronized</code>Â åï¼š</p>
<ol>
<li>çº¿ç¨‹ A çš„åŒæ­¥å—å†…ï¼Œæ“ä½œ 1 å’Œæ“ä½œ 2 å¯é‡æ’åºï¼Œä½†ä¸ä¼šé‡æ’åºåˆ°Â <code>write()</code>Â æ–¹æ³•å¤–éƒ¨ï¼ˆè§£é”åï¼‰ã€‚</li>
<li>ã€Œçº¿ç¨‹ A è§£é”ã€happens-beforeã€Œçº¿ç¨‹ B åŠ é”ã€ï¼Œå› æ­¤çº¿ç¨‹ B æ‰§è¡Œæ—¶ï¼Œå¿…ç„¶èƒ½çœ‹åˆ°çº¿ç¨‹ A æ“ä½œ 1 å’Œæ“ä½œ 2 çš„æœ€ç»ˆç»“æœï¼ˆ<code>a=1</code>Â ä¸”Â <code>ready=true</code>ï¼‰ï¼Œè¾“å‡ºæ­£ç¡®ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-39">4ã€æ€»ç»“ï¼šä¸‰ä¸ªç‰¹æ€§çš„æ ¸å¿ƒä¿éšœé€»è¾‘</h3>





















<table><thead><tr><th>ç‰¹æ€§</th><th>æ ¸å¿ƒä¿éšœæœºåˆ¶</th></tr></thead><tbody><tr><td>åŸå­æ€§</td><td>Monitor é”çš„äº’æ–¥æ€§ï¼šåŒæ­¥å— / æ–¹æ³•åŒä¸€æ—¶é—´ä»…ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œæ“ä½œä¸å¯åˆ†å‰²ã€‚</td></tr><tr><td>å¯è§æ€§</td><td>é”é‡Šæ”¾ / è·å–çš„å†…å­˜è¯­ä¹‰ï¼šé‡Šæ”¾é”æ—¶åˆ·æ–°å·¥ä½œå†…å­˜åˆ°ä¸»å†…å­˜ï¼Œè·å–é”æ—¶ä»ä¸»å†…å­˜åŠ è½½æœ€æ–°å€¼ã€‚</td></tr><tr><td>æœ‰åºæ€§</td><td>1. äº’æ–¥æ‰§è¡Œè½¬åŒ–ä¸ºå•çº¿ç¨‹ä¸²è¡Œï¼ˆas-if-serial è¯­ä¹‰ï¼‰ï¼›2. happens-before è§„åˆ™çº¦æŸæŒ‡ä»¤é‡æ’åºã€‚</td></tr></tbody></table>
<h2 data-id="heading-40">å››ã€æ€»ç»“</h2>
<h3 data-id="heading-41">1. åº•å±‚åŸç†æ ¸å¿ƒ</h3>
<p><code>synchronized</code>Â åŸºäºÂ <strong>Monitor ç›‘è§†å™¨é”</strong>Â å’ŒÂ <strong>å¯¹è±¡å¤´ Mark Word</strong>Â å®ç°ï¼Œé€šè¿‡ç«äº‰ Monitor æ‰€æœ‰æƒä¿è¯çº¿ç¨‹äº’æ–¥ï¼Œé”çŠ¶æ€å­˜å‚¨åœ¨ Mark Word ä¸­ã€‚</p>
<h3 data-id="heading-42">2. ä¼˜åŒ–æœºåˆ¶æ ¸å¿ƒ</h3>
<p>JDK 1.6+ çš„ä¼˜åŒ–æ ¸å¿ƒæ˜¯Â  <strong>â€œé”å‡çº§â€</strong> ï¼šä»åå‘é”ï¼ˆæ— ç«äº‰ï¼‰â†’ è½»é‡çº§é”ï¼ˆè½»åº¦ç«äº‰ï¼Œè‡ªæ—‹ï¼‰â†’ é‡é‡çº§é”ï¼ˆæ¿€çƒˆç«äº‰ï¼Œé˜»å¡ï¼‰ï¼ŒæŒ‰éœ€é™ä½å¼€é”€ï¼›é…åˆè‡ªæ—‹é”ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ç­‰ä¼˜åŒ–ï¼Œè®©Â <code>synchronized</code>Â å…¼é¡¾å®‰å…¨æ€§å’Œé«˜æ€§èƒ½ã€‚</p>
<h3 data-id="heading-43">3. æ€§èƒ½å¯¹æ¯”</h3>
<ul>
<li>æ— ç«äº‰åœºæ™¯ï¼šåå‘é” &gt; è½»é‡çº§é” &gt; é‡é‡çº§é”ï¼ˆåå‘é”å‡ ä¹æ— å¼€é”€ï¼‰ã€‚</li>
<li>è½»åº¦ç«äº‰åœºæ™¯ï¼šè½»é‡çº§é”ï¼ˆè‡ªæ—‹ï¼‰&gt; é‡é‡çº§é”ï¼ˆé¿å…å†…æ ¸æ€åˆ‡æ¢ï¼‰ã€‚</li>
<li>æ¿€çƒˆç«äº‰åœºæ™¯ï¼šé‡é‡çº§é”ï¼ˆè‡ªæ—‹æ— æ•ˆï¼Œé˜»å¡æ›´é«˜æ•ˆï¼‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Microsoft Agent Framework]]></title>    <link>https://juejin.cn/post/7575313772988399657</link>    <guid>https://juejin.cn/post/7575313772988399657</guid>    <pubDate>2025-11-23T08:40:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575313772988399657" data-draft-id="7575655132748349476" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Microsoft Agent Framework"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-11-23T08:40:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€å§‹ä½¿ç”¨ Elastic Agent Builder å’Œ Microsoft Agent Framework
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:40:23.000Z" title="Sun Nov 23 2025 08:40:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fjonathan-simon" title="https://www.elastic.co/search-labs/author/jonathan-simon" target="_blank" ref="nofollow noopener noreferrer">Jonathan Simon</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e12fa40a8534389b0387e53ff3c0016~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=oIIS7CCMF2LuT17tdHYHDvoXPQk%3D" alt="" loading="lazy"/></p>
<p>é€æ­¥è®²è§£å¦‚ä½•ä½¿ç”¨ Elastic Agent Builder åˆ›å»ºä¸€ä¸ª agent çš„å®Œæ•´æµç¨‹ï¼Œç„¶åæ¢ç´¢å¦‚ä½•é€šè¿‡ç”± Microsoft Agent Framework ç¼–æ’çš„ A2A åè®®æ¥ä½¿ç”¨è¯¥ agentã€‚</p>
<p>Agent Builder ç°åœ¨ä½œä¸ºæŠ€æœ¯é¢„è§ˆç‰ˆæä¾›ã€‚å¼€å§‹ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://cloud.elastic.co/registration?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">Elastic Cloud è¯•ç”¨</a>ï¼Œå¹¶åœ¨æ­¤æŸ¥çœ‹ Agent Builder çš„æ–‡æ¡£ã€‚</p>
<p>Elastic <a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F153865391" title="https://elasticstack.blog.csdn.net/article/details/153865391" target="_blank" ref="nofollow noopener noreferrer">9.2</a> æœ€è¿‘å‘å¸ƒï¼Œå¹¶åŒ…å«ä¸€ä¸ªåä¸º <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Felasticsearch%2Fagent-builder" title="https://www.elastic.co/elasticsearch/agent-builder" target="_blank" ref="nofollow noopener noreferrer">Agent Builder</a> çš„æ–°åŠŸèƒ½ã€‚å®ƒè®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿåˆ›å»ºç”± Elasticsearch ä¸­å­˜å‚¨çš„æ•°æ®é©±åŠ¨çš„ AI agents å’Œ toolsã€‚ä½ åœ¨ Agent Builder ä¸­åˆ›å»ºçš„ä»»ä½• tools æˆ– agents éƒ½å¯ä»¥ç«‹å³åœ¨ä½ è‡ªå·±çš„è‡ªå®šä¹‰ AI åº”ç”¨ä¸­ä½¿ç”¨ã€‚</p>
<p>åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®²è§£ä½¿ç”¨ Elastic Agent Builder åˆ›å»ºä¸€ä¸ª agent çš„æ‰€æœ‰æ­¥éª¤ã€‚ç„¶åæˆ‘ä»¬å°†è®²è§£è¿è¡Œä¸€ä¸ªç¤ºä¾‹ Python åº”ç”¨çš„æµç¨‹ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ Microsoft Agent Framework æ¥ç¼–æ’ä½ çš„ Elastic agentã€‚</p>
<h2 data-id="heading-0">åˆ›å»ºä¸€ä¸ª Elastic Serverless é¡¹ç›®</h2>
<p>è¦ä½¿ç”¨ Agent Builderï¼Œä½ éœ€è¦ä¸€ä¸ª Elastic éƒ¨ç½²æˆ–ä¸€ä¸ª Elastic <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fcloud%2Fserverless" title="https://www.elastic.co/cloud/serverless" target="_blank" ref="nofollow noopener noreferrer">serverless</a> é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä»åˆ›å»ºä¸€ä¸ª Elastic serverless é¡¹ç›®å¼€å§‹ã€‚è¿›å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration" title="https://cloud.elastic.co/registration" target="_blank" ref="nofollow noopener noreferrer">Elastic Cloud</a> å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ Elasticsearch <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fcloud%2Fserverless" title="https://www.elastic.co/cloud/serverless" target="_blank" ref="nofollow noopener noreferrer">Serverless</a> é¡¹ç›®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d217235199794785a2b684aba2bfb3be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=gUhNOGypdo%2FnZwsyxJRD2J2omjE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">åˆ›å»ºä¸€ä¸ªç´¢å¼•å¹¶æ·»åŠ æ•°æ®</h2>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ª Elastic é¡¹ç›®ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œè¿™æ˜¯ Elasticsearch ç”¨æ¥å­˜å‚¨æ•°æ®çš„åœ°æ–¹ã€‚æ‰“å¼€ Elastic Cloud ä¸­çš„ Developer Toolsï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œè¿è¡Œå‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªç´¢å¼•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b428801cf1a14dc3bc53d1264f06eef3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=uclXaT4954LTq9emN2HeGCuWixA%3D" alt="" loading="lazy"/></p>
<p>å¤åˆ¶ä¸‹é¢çš„ PUT å‘½ä»¤ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªåä¸º my-docs çš„ç´¢å¼•ï¼ŒåŒ…å«å¤šç§å­—æ®µï¼Œä»¥åŠåˆ©ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Freference%2Felasticsearch%2Fmapping-reference%2Fsemantic-text" title="https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/semantic-text" target="_blank" ref="nofollow noopener noreferrer">è¯­ä¹‰æœç´¢</a>çš„å†…å®¹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT /my-docs
2.  {
3.    <span class="hljs-string">"mappings"</span>: {
4.      <span class="hljs-string">"properties"</span>: {
5.        <span class="hljs-string">"title"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span> },
6.        <span class="hljs-string">"content"</span>: { 
7.          <span class="hljs-string">"type"</span>: <span class="hljs-string">"semantic_text"</span>
8.        },
9.        <span class="hljs-string">"filename"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span> },
10.        <span class="hljs-string">"last_modified"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"date"</span> }
11.      }
12.    }
13.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>å°† PUT å‘½ä»¤ç²˜è´´åˆ° Developer Tools æ§åˆ¶å°çš„è¾“å…¥åŒºåŸŸã€‚æŠŠé¼ æ ‡æ‚¬åœåœ¨æ§åˆ¶å°ä¸­çš„å‘½ä»¤ä¸Šï¼Œç„¶åç‚¹å‡» Run æŒ‰é’®æ¥æ‰§è¡Œè¯¥å‘½ä»¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/383550b40f3649ec8f17e3e33dc2df7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=HwMjEZEUh%2B%2BJLO9AlxCU%2F1740Kc%3D" alt="" loading="lazy"/></p>
<p>ä¸‹ä¸€æ­¥æ˜¯å‘ä½ åˆšåˆ›å»ºçš„ my-docs ç´¢å¼•ä¸­æ·»åŠ ä¸€äº›æ•°æ®ã€‚å°†ä¸‹é¢çš„å‘½ä»¤å¤åˆ¶å¹¶ç²˜è´´åˆ° Develop Tools æ§åˆ¶å°ä¸­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT /my-docs/_doc/greetings-md
2.  {
3.    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Greetings"</span>,
4.    <span class="hljs-string">"content"</span>: <span class="hljs-string">"
5.  # Greetings

7.  ## Basic Greeting
8.  Hello!

10.  ## Helloworld Greeting
11.  Hello World! ğŸŒ

13.  ## Not Greeting
14.  I'm only a greeting agent. ğŸ¤·

16.  "</span>,
17.    <span class="hljs-string">"filename"</span>: <span class="hljs-string">"greetings.md"</span>,
18.    <span class="hljs-string">"last_modified"</span>: <span class="hljs-string">"2025-11-04T12:00:00Z"</span>
19.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>ç‚¹å‡»è¯¥å‘½ä»¤çš„ Run æŒ‰é’®æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™å°†å‘ my-docs ç´¢å¼•æ·»åŠ ä¸€ä¸ªæ–‡æ¡£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3067081540db4b6e84b62180f196b98b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=Un1vqEg6RDYZEUoGPPHSzolxzDQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä½ æ‰€è§ï¼Œä¸Šé¢çš„å‘½ä»¤æ·»åŠ äº†ä¸€ä¸ªåä¸º greetings.md çš„æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«ä¸åŒç±»å‹çš„é—®å€™å›åº”å†…å®¹ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨ Elastic ç´¢å¼•ä¸­æœ‰äº†ä¸€äº›æ•°æ®ï¼Œè®©æˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹å¯ä»¥ä½¿ç”¨çš„æ•°æ®ã€‚åˆ©ç”¨ Agent Builder ä¸­é»˜è®¤å¯ç”¨çš„å†…ç½® Elastic AI Agentï¼Œä½ ç°åœ¨å¯ä»¥å°±ä½ çš„æ•°æ®è¿›è¡Œå¯¹è¯ã€‚åœ¨å¯¼èˆªèœå•ä¸­é€‰æ‹© Agentsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/940bc29e283347bda465a0f4b54bbbf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=OabfpsMxQM7E21hne7S9ZaiZgdQ%3D" alt="" loading="lazy"/></p>
<p>ç„¶ååªéœ€é—®ï¼šâ€œæˆ‘æœ‰ä»€ä¹ˆæ•°æ®ï¼Ÿâ€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a55c7d9b2177413aad033832b886877a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=%2FbQdDI%2B6qLP4oo3XV4UKlM%2FpKNw%3D" alt="" loading="lazy"/></p>
<p>é»˜è®¤çš„ Elastic AI Agent ä¼šæä¾›å½“å‰å­˜å‚¨åœ¨ Elastic ä¸­æ•°æ®çš„è‰¯å¥½æ€»ç»“ã€‚</p>
<h2 data-id="heading-2">åˆ›å»ºä¸€ä¸ª tool</h2>
<p>æ­¤æ¼”ç»ƒçš„ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿä½¿ç”¨å­˜å‚¨åœ¨ Elastic ä¸­æ•°æ®çš„ agentã€‚</p>
<p>å¦‚ä½ æ‰€è§ï¼ŒElastic Agent Builder ä¸­çš„é»˜è®¤ agent å·²ç»å¯ä»¥ç”¨æ¥ä¸ä½ çš„æ•°æ®èŠå¤©ï¼Œä½†è¦çœŸæ­£èµ‹äºˆ agent è‡ªå®šä¹‰èƒ½åŠ›ï¼Œå®ƒä»¬éœ€è¦é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fdocs%2Fgetting-started%2Fintro" title="https://modelcontextprotocol.io/docs/getting-started/intro" target="_blank" ref="nofollow noopener noreferrer">Model Context Protocol (MCP)</a> è®¿é—® toolsã€‚Agent Builder æ‹¥æœ‰å®Œæ•´çš„ tool åˆ›å»ºå’Œç®¡ç†åŠŸèƒ½ï¼Œä½ å¯ä»¥ç”¨å®ƒå¿«é€Ÿåˆ›å»ºè‡ªå®šä¹‰ MCP toolsï¼Œè¿™äº› tools ä¼šæ‰˜ç®¡åœ¨ä¸æ•°æ®ç›¸åŒçš„å¯æ‰©å±• Elastic é¡¹ç›®ä¸­ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬åœ¨ Elastic Agent Builder ä¸­åˆ›å»ºä¸€ä¸ªå¯ä»¥è®¿é—® Elastic ä¸­æ•°æ®çš„ toolã€‚ç‚¹å‡» + New å¼€å§‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f795dec328184949b4ca1a878f906086~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=IeE4iZ2pPR7lQvQCsTfhZU7jtOU%3D" alt="" loading="lazy"/></p>
<p>ç„¶åç‚¹å‡» Manage toolsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4be79f7ee762471588354922a413420a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=uSYQXw3TsINQawcf6tcrSsfOw8c%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» + New tool æŒ‰é’®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0dcbda00590748ed9a0d6bd43dba5e57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=SGxwM%2F5j4z34HuiNcVpw5x7o%2FLA%3D" alt="" loading="lazy"/></p>
<p>åœ¨ Create Tool è¡¨å•ä¸­ï¼Œé€‰æ‹© ES|QL ä½œä¸º tool Typeï¼Œå¹¶è¾“å…¥ä»¥ä¸‹å€¼ã€‚</p>
<p><strong>Tool ID</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`example.get_greetings`</span>AIå†™ä»£ç 
</code></pre>
<p><strong>Description</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`<span class="hljs-keyword">Get</span> greetings doc <span class="hljs-keyword">from</span> Elasticsearch my_docs index.`AIå†™ä»£ç 
</code></pre>
<p><strong>Configuration</strong>ï¼šåœ¨ ES|QL Query æ–‡æœ¬åŒºåŸŸä¸­è¾“å…¥ä»¥ä¸‹æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`FROM my-docs | WHERE <span class="hljs-attr">filename</span> == <span class="hljs-string">"greetings.md"</span>`AIå†™ä»£ç 
</code></pre>
<p>ä½ å®Œæˆçš„ Create a new tool è¡¨å•åº”å¦‚ä¸‹æ‰€ç¤ºã€‚ç‚¹å‡» Save åˆ›å»ºè¯¥ toolã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd7b2dba5b034284a21afdd127023f2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=AeFPT%2Fh5SfNrlEw3Ux7mvQT6ie8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">åˆ›å»ºä¸€ä¸ª Agent å¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ª tool</h2>
<p>å•Šï¼æœ‰äº†æ–° tool å¹¶å‡†å¤‡ä½¿ç”¨çš„æ„Ÿè§‰çœŸå¥½ã€‚Agents éœ€è¦ tools æ¥èµ‹äºˆå®ƒä»¬è¶…å‡ºä¸€èˆ¬ LLM èƒ½åŠ›çš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œè€Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå…¨æ–°çš„ toolã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯ä»¥å……åˆ†åˆ©ç”¨æˆ‘ä»¬ tool çš„ agentã€‚åœ¨å¯¼èˆªèœå•ä¸­é€‰æ‹© Agentsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5017f7bf2d6343a2ab9358ecbf0de508~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=b%2B8xWmBlJReUS4EKfz9%2F4lTF9kc%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Create a new agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d985de944f04cf79001770bdb005183~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=fosa7HZKNd7e%2FtFgh31Z436yVjs%3D" alt="" loading="lazy"/></p>
<p>æ ¹æ® tool çš„åç§°å’Œå®ƒè®¿é—®çš„æ•°æ®ï¼Œä½ å¯èƒ½å·²ç»çŒœåˆ°æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªé—®å€™ agentï¼Œä½ çŒœå¯¹äº†ï¼è®©æˆ‘ä»¬ç°åœ¨åˆ›å»ºä¸€ä¸ª Hello World agentã€‚</p>
<p>åœ¨ New Agent è¡¨å•ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å€¼ã€‚</p>
<p><strong>Agent ID</strong>ï¼šè¾“å…¥æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`helloworld_agent`</span>AIå†™ä»£ç 
</code></pre>
<p>åœ¨ <strong>Custom Instructions</strong> æ–‡æœ¬åŒºåŸŸä¸­è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">`

<span class="hljs-number">1.</span>  If the prompt <span class="hljs-keyword">contains</span> greeting text <span class="hljs-keyword">like</span> "Hi" <span class="hljs-keyword">or</span> "Hello" <span class="hljs-keyword">then</span> respond <span class="hljs-keyword">with</span> <span class="hljs-keyword">only</span> the Basic Hello text <span class="hljs-keyword">from</span> your documents.

<span class="hljs-number">3.</span>  If the prompt <span class="hljs-keyword">contains</span> the text â€œHello Worldâ€ <span class="hljs-keyword">then</span> respond <span class="hljs-keyword">with</span> <span class="hljs-keyword">only</span> the Hello World text <span class="hljs-keyword">from</span> your documents.

<span class="hljs-number">5.</span>  <span class="hljs-keyword">In</span> <span class="hljs-keyword">all</span> other cases <span class="hljs-keyword">where</span> the prompt does <span class="hljs-keyword">not</span> contain greeting words, <span class="hljs-keyword">then</span> respond <span class="hljs-keyword">with</span> <span class="hljs-keyword">only</span> the <span class="hljs-keyword">Not</span> Greeting text <span class="hljs-keyword">from</span> your documents.

`AIå†™ä»£ç 
</code></pre>
<p><strong>Display name</strong>ï¼šè¾“å…¥æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`HelloWorld Agent`</span>AIå†™ä»£ç 
</code></pre>
<p><strong>Display description</strong>ï¼šè¾“å…¥æ–‡æœ¬ï¼š</p>
<pre><code class="hljs language-css" lang="css">`An agent that responds <span class="hljs-selector-tag">to</span> greetings.`AIå†™ä»£ç 
</code></pre>
<p>ä½ å®Œæˆçš„ <strong>New Agent</strong> è¡¨å•åº”å¦‚ä¸‹æ‰€ç¤ºã€‚ä¸‹ä¸€æ­¥æ˜¯ä¸º agent åˆ†é…æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥åˆ›å»ºçš„ toolã€‚ç‚¹å‡» <strong>Tools</strong> æ ‡ç­¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2928610d469b4f239c161d86e86804aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=hUJZPj5vxVr1qYtC3kaiP1CYrwE%3D" alt="" loading="lazy"/></p>
<p>åªé€‰æ‹©æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ example.get_greetings toolã€‚å–æ¶ˆé€‰æ‹©æ‰€æœ‰å…¶ä»–å¯ç”¨çš„ toolsã€‚è¿™å°†é…ç½®æ­£åœ¨åˆ›å»ºçš„ agent ä»…èƒ½è®¿é—®æˆ‘ä»¬åˆ›å»ºçš„ toolã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c721718bf9ec4b40bcf188d59bf9774c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=TQd0QyujnA1AniH%2Fb8RQ%2BCA2lZE%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» <strong>Save</strong> åˆ›å»ºè¯¥ agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d5ec24af7af4120a55faa92315e6f5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=xPsKPYZuIowxpotZNEknI3NSJ8o%3D" alt="" loading="lazy"/></p>
<p>ä½ å°†è¢«å¸¦åˆ° Agents åˆ—è¡¨ï¼Œåœ¨é‚£é‡Œå¯ä»¥çœ‹åˆ°æ–°çš„ HelloWorld Agent å·²ç»åˆ›å»ºã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Agent Builder ä¸­å¿«é€Ÿæµ‹è¯•æˆ‘ä»¬çš„æ–° agentã€‚åœ¨å¯¼èˆªèœå•ä¸­é€‰æ‹© Agentsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ab5fe1716b843bda92ca29fce18144a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=zSBhYbP%2F4wrlDSMO8MmEnBJIb4s%3D" alt="" loading="lazy"/></p>
<p>åœ¨ Agent Chat agent é€‰æ‹©å™¨ä¸­é€‰æ‹© HelloWorld Agentã€‚è¾“å…¥æç¤º â€œhello worldâ€ï¼Œä½ åº”è¯¥ä¼šä»å­˜å‚¨åœ¨ my-docs Elastic ç´¢å¼•ä¸­çš„ greetings.md æ–‡æ¡£ä¸­å¾—åˆ° Hello World æ–‡æœ¬ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcb09d6d4c534b60932b7d0c7ed40b40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=SmMPirV7gu%2BvXWLbgLxxPgIIcDY%3D" alt="" loading="lazy"/></p>
<p>å¹²å¾—å¥½ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„ agent æŒ‰é¢„æœŸå·¥ä½œï¼Œè®©æˆ‘ä»¬æ¢ç´¢åœ¨ Agent Builder ä¸­åˆ›å»ºçš„ tools å’Œ agents å¸¦æ¥çš„å³æ—¶å¼€å‘å¥½å¤„ã€‚ä½ åœ¨ Agent Builder ä¸­åˆ›å»ºçš„ä»»ä½• tools éƒ½å¯ä»¥é€šè¿‡ MCP è¢«ä»»ä½•æ”¯æŒ MCP çš„ agent æ„å»ºå¹³å°ä½¿ç”¨ã€‚åŒæ—¶ï¼Œä½ åœ¨ Agent Builder ä¸­åˆ›å»ºçš„ä»»ä½• agents éƒ½å¯ä»¥åœ¨ä»»ä½•æ”¯æŒ AgentToAgent (A2A) åè®®çš„ agent æ„å»ºå¹³å°ä¸­ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-4">Microsoft Agent Framework</h2>
<p>å¦‚æœä½ æœ‰å…´è¶£å°è¯•æ–°çš„ Agent å¼€å‘å·¥å…·ï¼Œé‚£ä¹ˆæœ€è¿‘å®£å¸ƒçš„å¼€æºå¼€å‘å·¥å…·åŒ… <a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fagent-framework%2Foverview%2Fagent-framework-overview" title="https://learn.microsoft.com/en-us/agent-framework/overview/agent-framework-overview" target="_blank" ref="nofollow noopener noreferrer">Microsoft Agent Framework</a> ä½ ç»å¯¹åº”è¯¥äº²è‡ªå°è¯•ã€‚Agent Framework å…è®¸ä½ ä½¿ç”¨ A2A åè®®æ¥ç¼–æ’ agent åº”ç”¨ï¼Œå¯ä»¥ç»„åˆåœ¨ä¸åŒä¸»æœºä¸Šè¿è¡Œçš„å¤šä¸ª agentsï¼Œä»è€Œå®ç°ä»…é é€šç”¨ GenAI Large Language Model æ— æ³•å®ç°çš„è§£å†³æ–¹æ¡ˆã€‚Agent Framework æä¾› Python å’Œ C# ç‰ˆæœ¬ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨åŸºäº Python çš„ Agent Framework è°ƒç”¨æˆ‘ä»¬åˆšåˆ›å»ºçš„è‡ªå®šä¹‰ Elastic Agentã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/311fb06b0c614586bb26a53b6a96af79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=Bzs94%2BOuTFe04%2BhVGsDP%2FMEnX%2FI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">åœ¨ Python ä¸­å¼€å§‹ä½¿ç”¨ Agent Framework</h2>
<p>è®©æˆ‘ä»¬è¿è¡Œä¸€äº›ä»£ç ï¼åœ¨ä½ çš„æœ¬åœ°ç”µè„‘ä¸Šæ‰“å¼€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Fdownload" title="https://code.visualstudio.com/download" target="_blank" ref="nofollow noopener noreferrer">Visual Studio Code</a> å¹¶æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/198375dc5d2e453c8eb1c58610cfeb11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=hZUoZ9K3LXmkugUcvgPo3ufgByg%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ‰“å¼€çš„ç»ˆç«¯ä¸­ï¼Œå…‹éš†åŒ…å« <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Felastic%2Felasticsearch-labs%2Ftree%2Fmain%2Fsupporting-blog-content%2Fagent-builder-a2a-agent-framework" title="https://github.com/elastic/elasticsearch-labs/tree/main/supporting-blog-content/agent-builder-a2a-agent-framework" target="_blank" ref="nofollow noopener noreferrer">Elastic Agent Builder A2A ç¤ºä¾‹åº”ç”¨</a>çš„ Elastic Search Labs æºä»£ç ä»“åº“ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`git <span class="hljs-built_in">clone</span> https://github.com/elastic/elasticsearch-labs`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ç»ˆç«¯ä¸­ï¼Œä½¿ç”¨ cd å‘½ä»¤åˆ‡æ¢ç›®å½•åˆ° elasticsearch-labsã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">cd</span> elasticsearch-labs`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥åœ¨ Visual Studio Code ç¼–è¾‘å™¨ä¸­æ‰“å¼€å½“å‰æ–‡ä»¶å¤¹ã€‚</p>
<pre><code class="hljs language-css" lang="css">`<span class="hljs-selector-tag">code</span> .`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ Visual Studio æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­ï¼Œå±•å¼€ supporting-blog-content å’Œ agent-builder-a2a-agent-framework æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€åä¸º elastic_agent_builder_a2a.py çš„æ–‡ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1651e1e6031f45559a4012b352edd887~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=KveKCpM6ZfqGwDZ0ue5ZqQFwF0k%3D" alt="" loading="lazy"/></p>
<p>è¿™æ˜¯ä½ åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­åº”è¯¥çœ‹åˆ°çš„ elastic_agent_builder_a2a.py çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  import asyncio
2.  from dotenv import load_dotenv
3.  import httpx
4.  import os
5.  from a2a.client import A2ACardResolver
6.  from agent_framework.a2a import A2AAgent

9.  async def main():
10.      load_dotenv()
<span class="hljs-attr">11.      a2a_agent_host</span> = os.getenv(<span class="hljs-string">"ES_AGENT_URL"</span>)
<span class="hljs-attr">12.      a2a_agent_key</span> = os.getenv(<span class="hljs-string">"ES_API_KEY"</span>)

14.      print(f"Connection to Elastic A2A agent at: {a2a_agent_host}")

<span class="hljs-attr">16.      custom_headers</span> = {<span class="hljs-string">"Authorization"</span>: f<span class="hljs-string">"ApiKey {a2a_agent_key}"</span>}

18.      async with httpx.AsyncClient(<span class="hljs-attr">timeout</span>=<span class="hljs-number">60.0</span>, headers=custom_headers) as http_client:
19.          <span class="hljs-comment"># Resolve the A2A Agent Card</span>
<span class="hljs-attr">20.          resolver</span> = A2ACardResolver(httpx_client=http_client, base_url=a2a_agent_host)
<span class="hljs-attr">21.          agent_card</span> = await resolver.get_agent_card(
<span class="hljs-attr">22.              relative_card_path</span>=<span class="hljs-string">"/helloworld_agent.json"</span>
23.          )
24.          print(f"Found Agent: {agent_card.name} - {agent_card.description}")

26.          <span class="hljs-comment"># Use the Agent</span>
<span class="hljs-attr">27.          agent</span> = A2AAgent(
<span class="hljs-attr">28.              name</span>=agent_card.name,
<span class="hljs-attr">29.              description</span>=agent_card.description,
<span class="hljs-attr">30.              agent_card</span>=agent_card,
<span class="hljs-attr">31.              url</span>=a2a_agent_host,
<span class="hljs-attr">32.              http_client</span>=http_client,
33.          )
<span class="hljs-attr">34.          prompt</span> = input(<span class="hljs-string">"Enter Greeting &gt;&gt;&gt; "</span>)
35.          print("\nSending message to Elastic A2A agent...")
<span class="hljs-attr">36.          response</span> = await agent.run(prompt)
37.          print("\nAgent Response:")
38.          for message in response.messages:
39.              print(message.text)

42.  if <span class="hljs-attr">__name__</span> == <span class="hljs-string">"__main__"</span>:
43.      asyncio.run(main())

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>main() æ–¹æ³•ä¸­çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Agent Framework æ§åˆ¶ä½ çš„ Elastic Agent Builder agentã€‚å®ƒä½¿ç”¨æ¥è‡ªä½ çš„ Elastic é¡¹ç›®çš„ URL å’Œ API key ä¸º agent åˆ›å»ºä¸€ä¸ª http_clientã€‚ç„¶åè°ƒç”¨ Agent Framework çš„ A2ACardResolverï¼Œå¹¶ä¼ å…¥è¯¥ http_clientï¼Œä»¥æ ¹æ® relative_card_path ä¸º â€œ/helloworld_agent.jsonâ€ è·å– agent çš„ A2A agent cardï¼Œä»è€Œå¼•ç”¨ä½ çš„ agent çš„ Agent IDï¼Œå³ â€œhelloworld_agentâ€ã€‚æ¥ç€ï¼Œä»£ç ä½¿ç”¨ Agent Framework è°ƒç”¨ä½ çš„ agent å¹¶ä¼ å…¥ A2A agent cardã€‚main() æ–¹æ³•çš„æœ€åéƒ¨åˆ†æç¤ºåº”ç”¨çš„ç”¨æˆ·è¾“å…¥ä¸€ä¸ª â€œgreetingâ€ï¼Œç„¶åå°†ç”¨æˆ·è¾“å…¥ä½œä¸ºæç¤ºå‘é€ç»™ä½ çš„ agentã€‚æ ¹æ®ä½ åˆ›å»º agent æ—¶æŒ‡å®šçš„æŒ‡ä»¤å’Œ toolsï¼Œagent çš„å“åº”ä¼šæ˜¾ç¤ºç»™åº”ç”¨ç”¨æˆ·ã€‚</p>
<h2 data-id="heading-6">å°†ä½ çš„ agent URL å’Œ API Key è®¾ç½®ä¸ºç¯å¢ƒå˜é‡</h2>
<p>å¤åˆ¶æ–‡ä»¶ env.example å¹¶å°†æ–°æ–‡ä»¶å‘½åä¸º .envã€‚ç¼–è¾‘æ–°åˆ›å»ºçš„ .env æ–‡ä»¶ï¼Œå°†ç¯å¢ƒå˜é‡çš„å€¼è®¾ç½®ä¸ºä»ä½ çš„ Elastic é¡¹ç›®ä¸­å¤åˆ¶çš„ç‰¹å®šå€¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9469770a5dca47b09693c7aa46067d90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=J5Uzv5MLL%2FbU7e5nmq9Bp3%2FVULA%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å°† æ›¿æ¢ä¸ºä½ å¯ä»¥ä» Elastic é¡¹ç›®ä¸­çš„ Agent Builder - Tools é¡µé¢å¤åˆ¶çš„ Agent URL è·¯å¾„ã€‚å›åˆ° Elastic Agent Builderï¼Œåœ¨å¯¼èˆªèœå•ä¸­ç‚¹å‡» Agentsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/534f619664af4bf791846d2a8208e328~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=eoVGbnWNvggB8m9nF8t1Fse2T%2FE%3D" alt="" loading="lazy"/></p>
<p>é€‰æ‹© Manage toolsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b121e546060a489a81c7424be35243e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=1scXn%2FnXYZcAsyOuOudr1ve5DMA%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Tools é¡µé¢é¡¶éƒ¨çš„ MCP Server ä¸‹æ‹‰èœå•ã€‚é€‰æ‹© Copy MCP Server URLã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05044a5651b24a86a366d653c0752979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=xj6Xt%2F44qYoJirHe2jTJa64oyBE%3D" alt="" loading="lazy"/></p>
<p>å›åˆ° Visual Studio Codeï¼Œåœ¨ .env æ–‡ä»¶ä¸­æ‰¾åˆ°å ä½ç¬¦æ–‡æœ¬ â€œ<strong>YOUR-ELASTIC-AGENT-BUILDER-URL&gt;</strong>â€ï¼Œå¹¶ç²˜è´´å¤åˆ¶çš„ MCP Server URL æ¥æ›¿æ¢å ä½ç¬¦æ–‡æœ¬ã€‚ç°åœ¨ç¼–è¾‘ç²˜è´´çš„ MCP Server URLã€‚åˆ é™¤ URL æœ«å°¾çš„ â€œmcpâ€ æ–‡æœ¬ï¼Œå¹¶æ›¿æ¢ä¸º â€œa2aâ€ã€‚ç¼–è¾‘åçš„ URL åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`https://example-project-a123.kb.westus2.azure.elastic.cloud/api/agent_builder/a2a`AIå†™ä»£ç 
</code></pre>
<p>ä¸‹ä¸€ä¸ªéœ€è¦åœ¨ .env æ–‡ä»¶ä¸­æ›¿æ¢çš„å ä½ç¬¦æ–‡æœ¬æ˜¯ ã€‚æˆ‘ä»¬å°†ç”¨æ¥è‡ªä½ çš„ Elastic é¡¹ç›®çš„å®é™… API Key æ›¿æ¢å®ƒã€‚å›åˆ°ä½ çš„ Elastic é¡¹ç›®ï¼Œåœ¨å¯¼èˆªèœå•ä¸­ç‚¹å‡» Elasticsearchã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b2b86cd27784905849c2304808d5493~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=peXEnbb6%2F3PuGEDHrItEvTSjem8%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» Create API key åˆ›å»ºä¸€ä¸ªæ–°çš„ API keyã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dbb46d8db094070bd110f7fdd5d7898~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=IYPENBjhPV0MMq5a5RoROTY6zHE%3D" alt="" loading="lazy"/></p>
<p>è¾“å…¥ API key çš„ Nameï¼Œç„¶åç‚¹å‡» Create API keyã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f834245ec3374a2895618490a85a64ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=hNUIUlTTwVtJiBjj%2FdMs%2BJp2CFY%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡»å¤åˆ¶æŒ‰é’®æ¥å¤åˆ¶ API keyã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37b367a4c6b84a2cadbc0841747fbc81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=%2FsyDwD1DTJVvfbU9CKwZKDx0Qxw%3D" alt="" loading="lazy"/></p>
<p>å›åˆ° Visual Studio Codeï¼Œåœ¨ .env æ–‡ä»¶ä¸­æ‰¾åˆ°å ä½ç¬¦æ–‡æœ¬ â€œ<strong/>â€ï¼Œå¹¶ç²˜è´´å¤åˆ¶çš„ API Key å€¼æ¥æ›¿æ¢å ä½ç¬¦æ–‡æœ¬ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¿å­˜å¯¹ .env æ–‡ä»¶æ‰€åšçš„æ›´æ”¹ã€‚ç¼–è¾‘åçš„æ–‡ä»¶åº”çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95372068b90a495499b4578ce6428ecf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=kKD16WypLILv%2B4KNXFIOEDyHTPc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">è¿è¡Œç¤ºä¾‹åº”ç”¨</h2>
<p>ç°åœ¨æ˜¯è¿è¡Œä»£ç çš„æ—¶å€™äº†ã€‚ä¸ºæ­¤ï¼Œåœ¨ Visual Studio Code ä¸­æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯ã€‚ç‚¹å‡»é¡¶éƒ¨èœå•çš„ Terminalï¼Œç„¶åé€‰æ‹© New Terminalã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc40130777204bd6bc3dc1ecb5ccc31c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=xwJ4mRuJokjjDeooYc2QONj1kEg%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ–°ç»ˆç«¯ä¸­ï¼Œä½¿ç”¨ cd å‘½ä»¤åˆ‡æ¢ç›®å½•åˆ°åŒ…å« agent-builder-a2a-agent-framework ç¤ºä¾‹åº”ç”¨çš„ç›®å½•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">cd</span> elasticsearch-labs/supporting-blog-content/agent-builder-a2a-agent-framework`AIå†™ä»£ç 
</code></pre>
<p>åœ¨ç»ˆç«¯ä¸­ï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ª Python è™šæ‹Ÿç¯å¢ƒã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`python -m venv .venv`</span>AIå†™ä»£ç 
</code></pre>
<p>åœ¨ç»ˆç«¯çª—å£ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆæ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿï¼‰ï¼š</p>
<ul>
<li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ MacOS æˆ– Linuxï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒçš„å‘½ä»¤æ˜¯ï¼š</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">`<span class="hljs-built_in">source</span> .venv/bin/activate`AIå†™ä»£ç 
</code></pre>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Windowsï¼Œæ¿€æ´»è™šæ‹Ÿç¯å¢ƒçš„å‘½ä»¤æ˜¯ï¼š</p>
<pre><code class="hljs language-r" lang="r">`.venv\Scripts\activate`AIå†™ä»£ç 
</code></pre>
<p>elastic_agent_builder_a2a.py æ–‡ä»¶ä¸­çš„ä»£ç ç”± Microsoft Agent Framework é©±åŠ¨ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦å®‰è£…å®ƒï¼Œæ‰€ä»¥ç°åœ¨æ¥å®‰è£…ã€‚è¿è¡Œä»¥ä¸‹ pip å‘½ä»¤ä»¥å®‰è£…åŸºäº Python çš„ Agent Framework åŠå…¶æ‰€éœ€çš„ Python åŒ…ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`pip install -r requirements.txt`</span>AIå†™ä»£ç 
</code></pre>
<p>å¤ªæ£’äº†ï¼ç°åœ¨ä¸€åˆ‡éƒ½å·²å°±ç»ªã€‚æ˜¯æ—¶å€™ä½“éªŒé‚£ç§ç¾å¦™çš„æ„Ÿè§‰äº†â€¦â€¦è®©æˆ‘ä»¬è¿è¡Œå®ƒã€‚åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿è¡Œç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-string">`python elastic_agent_builder_a2a.py`</span>AIå†™ä»£ç 
</code></pre>
<p>ä½ åº”è¯¥ä¼šçœ‹åˆ° Agent Framework è¿æ¥åˆ° Elastic Agentã€‚å½“æç¤ºè¾“å…¥ greeting æ—¶ï¼Œè¾“å…¥ â€œhello worldâ€ã€‚ä½ åº”è¯¥ä¼šçœ‹åˆ° HelloWorld Agent çš„å“åº” â†’ Hello World! ğŸŒ</p>
<p>é¡¶å°–çš„å·¥ä½œï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a8870e7751f4c90a39578f5075491bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764492022&amp;x-signature=7SVFOAZ9Wv%2F3mt5nnSNPU0l0UGU%3D" alt="" loading="lazy"/></p>
<p>åœ¨ Agent Builder ä¸­æ„å»º agents å¹¶å°†å®ƒä»¬è¿æ¥åˆ° toolsï¼Œå¯ä»¥è®©ä½ ç«‹å³ä¸æœ€æ–°çš„ agent å¼€å‘å¹³å°ï¼ˆå¦‚ Microsoft Agent Frameworkï¼‰å®ç°å¯æ“ä½œæ€§ã€‚ä½ ç°åœ¨å·²ç»çŸ¥é“å¦‚ä½•åˆ›å»ºä¸€ä¸ª Elastic agent å¹¶å°†å…¶ç”¨ä½œå¯æ‰©å±•çš„ç›¸å…³æ•°æ®æºï¼Œéšæ—¶ä¸ºä½ æ¥ä¸‹æ¥æ„å»ºçš„æ‰€æœ‰ AI åº”ç”¨æä¾›è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä»Šå¤©å°±å…è´¹è¯•ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://cloud.elastic.co/registration?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">Elastic</a> å¹¶åˆ›å»ºä¸€äº› agents å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ LLM è‡ªåŠ¨ç”Ÿæˆ SQLï¼šä» SQLite Schema åˆ°è‡ªç„¶è¯­è¨€æŸ¥è¯¢çš„å®Œæ•´å®è·µ]]></title>    <link>https://juejin.cn/post/7575102474640162867</link>    <guid>https://juejin.cn/post/7575102474640162867</guid>    <pubDate>2025-11-23T08:47:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575102474640162867" data-draft-id="7574651025728110630" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ LLM è‡ªåŠ¨ç”Ÿæˆ SQLï¼šä» SQLite Schema åˆ°è‡ªç„¶è¯­è¨€æŸ¥è¯¢çš„å®Œæ•´å®è·µ"/> <meta itemprop="keywords" content="å…¨æ ˆ"/> <meta itemprop="datePublished" content="2025-11-23T08:47:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‰å®‡å¤•è½"/> <meta itemprop="url" content="https://juejin.cn/user/3323164053734988"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ LLM è‡ªåŠ¨ç”Ÿæˆ SQLï¼šä» SQLite Schema åˆ°è‡ªç„¶è¯­è¨€æŸ¥è¯¢çš„å®Œæ•´å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3323164053734988/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‰å®‡å¤•è½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:47:44.000Z" title="Sun Nov 23 2025 08:47:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆè¦åšâ€œè‡ªç„¶è¯­è¨€è½¬ SQLâ€ï¼Ÿ</h2>
<p>åœ¨æ•°æ®åˆ†æã€ä½ä»£ç å¹³å°ã€BI å·¥å…·ç­‰åœºæ™¯ä¸­ï¼ŒéæŠ€æœ¯äººå‘˜å¸¸å› ä¸ä¼šå†™ SQL è€Œæ— æ³•è‡ªåŠ©æŸ¥è¯¢æ•°æ®ã€‚è€Œå€ŸåŠ© LLMï¼ˆå¦‚ DeepSeekã€GPTï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li><strong>é™ä½ä½¿ç”¨é—¨æ§›</strong>ï¼šç”¨æˆ·åªéœ€ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼ˆå¦‚â€œå¼€å‘éƒ¨å‘˜å·¥å·¥èµ„å¤šå°‘ï¼Ÿâ€ï¼‰</li>
<li><strong>æå‡å¼€å‘æ•ˆç‡</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆå‡†ç¡® SQLï¼Œå‡å°‘äººå·¥ç¼–å†™ä¸è°ƒè¯•æˆæœ¬</li>
<li><strong>å¿«é€ŸéªŒè¯æƒ³æ³•</strong>ï¼šåŸå‹é˜¶æ®µæ— éœ€æ„å»ºå¤æ‚ UIï¼Œä¸€å¥è¯å³å¯æŸ¥æ•°æ®</li>
</ul>
<blockquote>
<p>âœ… æœ¬æ–‡ä»¥ <strong>SQLite + DeepSeek API</strong> ä¸ºä¾‹ï¼Œå±•ç¤ºä¸€ä¸ªæœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆMVPï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€æŠ€æœ¯æ ˆä¸å‡†å¤‡</h2>

























<table><thead><tr><th>ç»„ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ•°æ®åº“</strong></td><td>SQLiteï¼ˆPython å†…ç½®ï¼Œæ— éœ€å®‰è£…æœåŠ¡ï¼‰</td></tr><tr><td><strong>LLM æœåŠ¡</strong></td><td>DeepSeekï¼ˆå…¼å®¹ OpenAI APIï¼Œå›½å†…å¯è®¿é—®ï¼‰</td></tr><tr><td><strong>ç¼–ç¨‹è¯­è¨€</strong></td><td>Python 3.7+</td></tr><tr><td><strong>ä¾èµ–åº“</strong></td><td><code>sqlite3</code>ï¼ˆå†…ç½®ï¼‰ã€<code>openai</code>ï¼ˆç”¨äºè°ƒç”¨ DeepSeekï¼‰</td></tr></tbody></table>
<p>å®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="hljs">bash
ç¼–è¾‘
pip install openai
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€å®Œæ•´å®ç°æ­¥éª¤</h2>
<h3 data-id="heading-3">æ­¥éª¤ 1ï¼šåˆ›å»º SQLite è¡¨å¹¶æ’å…¥ç¤ºä¾‹æ•°æ®</h3>
<pre><code class="hljs language-python" lang="python">python
ç¼–è¾‘
<span class="hljs-keyword">import</span> sqlite3

<span class="hljs-comment"># è¿æ¥æ•°æ®åº“ï¼ˆè‹¥ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºï¼‰</span>
conn = sqlite3.connect(<span class="hljs-string">"text5.db"</span>)
cursor = conn.cursor()

<span class="hljs-comment"># åˆ›å»º employees è¡¨</span>
cursor.execute(<span class="hljs-string">"""
CREATE TABLE IF NOT EXISTS employees (
    id INTEGER PRIMARY KEY,      -- æ³¨æ„ï¼šåŸæ–‡ PRINARY æ˜¯æ‹¼å†™é”™è¯¯ï¼Œåº”ä¸º PRIMARY
    name TEXT,
    department TEXT,
    salary INTEGER
)
"""</span>)

<span class="hljs-comment"># æ’å…¥æµ‹è¯•æ•°æ®</span>
sample_data = [
    (<span class="hljs-number">6</span>, <span class="hljs-string">"é™ˆè€æ¿"</span>, <span class="hljs-string">"å¼€å‘éƒ¨"</span>, <span class="hljs-number">100000</span>),
    (<span class="hljs-number">7</span>, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"é”€å”®éƒ¨"</span>, <span class="hljs-number">20000</span>),
    (<span class="hljs-number">8</span>, <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"å¼€å‘éƒ¨"</span>, <span class="hljs-number">50000</span>),
    (<span class="hljs-number">9</span>, <span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"é”€å”®éƒ¨"</span>, <span class="hljs-number">22000</span>),
]
cursor.executemany(<span class="hljs-string">'INSERT INTO employees VALUES (?, ?, ?, ?)'</span>, sample_data)
conn.commit()
</code></pre>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šåŸæ–‡ä¸­ <code>PRINARY KEY</code> æ˜¯æ‹¼å†™é”™è¯¯ï¼Œæ­£ç¡®åº”ä¸º <code>PRIMARY KEY</code>ï¼Œå¦åˆ™ä¼šåˆ›å»ºæˆæ™®é€šåˆ—ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">æ­¥éª¤ 2ï¼šæå–è¡¨ç»“æ„ï¼ˆSchemaï¼‰</h3>
<p>ä¸ºäº†è®© LLM ç†è§£è¡¨ç»“æ„ï¼Œéœ€æä¾›æ¸…æ™°çš„ Schema æè¿°ï¼š</p>
<pre><code class="hljs language-python" lang="python">python
ç¼–è¾‘
<span class="hljs-comment"># è·å–è¡¨å­—æ®µä¿¡æ¯</span>
schema = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
<span class="hljs-comment"># æ„é€  CREATE TABLE é£æ ¼çš„å­—ç¬¦ä¸²</span>
schema_str = <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"    <span class="hljs-subst">{col[<span class="hljs-number">1</span>]}</span> <span class="hljs-subst">{col[<span class="hljs-number">2</span>]}</span>"</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> schema]) + <span class="hljs-string">"\n)"</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®åº“ Schema:"</span>)
<span class="hljs-built_in">print</span>(schema_str)
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> EMPLOYEES (
    id <span class="hljs-type">INTEGER</span>
    name TEXT
    department TEXT
    salary <span class="hljs-type">INTEGER</span>
)
</code></pre>
<blockquote>
<p>ğŸ’¡ è™½ç„¶ç¼ºå°‘çº¦æŸï¼ˆå¦‚ PRIMARY KEYï¼‰ï¼Œä½†å¯¹ç®€å•æŸ¥è¯¢å·²è¶³å¤Ÿã€‚æ›´ä¸¥è°¨çš„åšæ³•å¯è§£æ DDL æˆ–è¡¥å……æ³¨é‡Šã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">æ­¥éª¤ 3ï¼šè°ƒç”¨ LLM ç”Ÿæˆ SQL</h3>
<p>ä½¿ç”¨ DeepSeek çš„ Reasoner æ¨¡å‹ï¼ˆæ“…é•¿æ¨ç†ä»»åŠ¡ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">python
ç¼–è¾‘
from openai import OpenAI

<span class="hljs-attr">client</span> = OpenAI(
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">'sk-xxxx'</span>,  <span class="hljs-comment"># æ›¿æ¢ä¸ºä½ çš„ DeepSeek API Key</span>
    <span class="hljs-attr">base_url</span>=<span class="hljs-string">'https://api.deepseek.com/v1'</span>
)

def ask_deepseek(query: str, schema: str) -&gt; str:
    <span class="hljs-attr">prompt</span> = f<span class="hljs-string">"""
è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schema:
{schema}
æ ¹æ®è¿™ä¸ªSchema,ä½ èƒ½è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢æ¥å›ç­”ä»¥ä¸‹é—®é¢˜å—ï¼Ÿ
åªè¾“å‡ºSQLæŸ¥è¯¢,ä¸è¦è¾“å‡ºä»»ä½•å…¶ä»–å†…å®¹ã€‚ä¹Ÿä¸è¦å¸¦ä»»ä½•æ ¼å¼ã€‚
é—®é¢˜ï¼š{query}
"""</span>
    <span class="hljs-attr">response</span> = client.chat.completions.create(
        <span class="hljs-attr">model</span>=<span class="hljs-string">"deepseek-reasoner"</span>,
        <span class="hljs-attr">max_tokens</span>=<span class="hljs-number">2048</span>,
        <span class="hljs-attr">messages</span>=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}]
    )
    return response.choices<span class="hljs-section">[0]</span>.message.content.strip()

<span class="hljs-comment"># æµ‹è¯•æé—®</span>
<span class="hljs-attr">question</span> = <span class="hljs-string">"å¼€å‘éƒ¨éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘ï¼Ÿ"</span>
<span class="hljs-attr">sql</span> = ask_deepseek(question, schema_str)
print("ç”Ÿæˆçš„ SQL æŸ¥è¯¢ï¼š")
print(sql)
</code></pre>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">sql</span>
ç¼–è¾‘
<span class="hljs-keyword">SELECT</span> name, salary <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department <span class="hljs-operator">=</span> <span class="hljs-string">'å¼€å‘éƒ¨'</span>;
</code></pre>
<hr/>
<h3 data-id="heading-6">æ­¥éª¤ 4ï¼šæ‰§è¡Œ SQL å¹¶è¿”å›ç»“æœï¼ˆå¯é€‰ï¼‰</h3>
<pre><code class="hljs language-scss" lang="scss">python
ç¼–è¾‘
result = <span class="hljs-attribute">cursor</span><span class="hljs-selector-class">.execute</span>(sql)<span class="hljs-selector-class">.fetchall</span>()
<span class="hljs-built_in">print</span>("æŸ¥è¯¢ç»“æœï¼š", result)
# è¾“å‡ºï¼š<span class="hljs-selector-attr">[(<span class="hljs-string">'é™ˆè€æ¿'</span>, 100000), (<span class="hljs-string">'æå››'</span>, 50000)]</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">å››ã€å…³é”®æŠ€å·§ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-8">1. Prompt è®¾è®¡è¦ç‚¹</h3>
<ul>
<li><strong>æ˜ç¡®æŒ‡ä»¤</strong>ï¼šâ€œåªè¾“å‡º SQLï¼Œä¸è¦è§£é‡Šâ€</li>
<li><strong>æä¾›ç²¾ç¡® Schema</strong>ï¼šå­—æ®µåã€ç±»å‹å¿…é¡»ä¸€è‡´</li>
<li><strong>ç¤ºä¾‹å¼•å¯¼ï¼ˆFew-shotï¼‰</strong> ï¼šå¤æ‚åœºæ™¯å¯åŠ  1~2 ä¸ªä¾‹å­æå‡å‡†ç¡®ç‡</li>
</ul>
<h3 data-id="heading-9">2. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>






























<table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>ç”Ÿæˆæ— æ•ˆ SQL</td><td>Schema ä¸æ¸…æ™°æˆ–å­—æ®µåä¸åŒ¹é…</td><td>ä½¿ç”¨Â <code>PRAGMA table_info</code>Â ç²¾ç¡®è·å–å­—æ®µ</td></tr><tr><td>è¿”å›å¤šä½™æ–‡æœ¬</td><td>LLM æœªä¸¥æ ¼éµå¾ªæŒ‡ä»¤</td><td>åœ¨ Prompt ä¸­å¼ºè°ƒâ€œä»…è¾“å‡º SQLâ€</td></tr><tr><td>è¡¨åå¤§å°å†™é”™è¯¯</td><td>SQLite é»˜è®¤å°å†™</td><td>Schema ä¸­ç»Ÿä¸€ç”¨å°å†™è¡¨å</td></tr><tr><td>æ‹¼å†™é”™è¯¯ï¼ˆå¦‚ PRINARYï¼‰</td><td>æ‰‹åŠ¨å»ºè¡¨å¤±è¯¯</td><td>å»ºè¡¨æ—¶ä»”ç»†æ£€æŸ¥è¯­æ³•</td></tr></tbody></table>
<h3 data-id="heading-10">3. å®‰å…¨è­¦å‘Š âš ï¸</h3>
<ul>
<li><strong>åˆ‡å‹¿ç›´æ¥æ‰§è¡Œ LLM ç”Ÿæˆçš„ SQLï¼</strong><br/>
åº”è¿›è¡Œ<strong>ç™½åå•æ ¡éªŒ</strong>ï¼ˆå¦‚åªå…è®¸ SELECTï¼‰ã€<strong>å‚æ•°åŒ–æŸ¥è¯¢</strong>ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»ã€‚</li>
<li>ç”Ÿäº§ç¯å¢ƒå»ºè®®å¢åŠ  SQL è§£æå™¨ï¼ˆå¦‚Â <code>sqlglot</code>ï¼‰åšè¯­æ³•æ ¡éªŒã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">äº”ã€æ–¹æ¡ˆå¯¹æ¯”ï¼šä¸åŒå®ç°æ–¹å¼ä¼˜åŠ£</h2>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>LLM ç›´æ¥ç”Ÿæˆ SQL</strong></td><td>å¿«é€Ÿã€çµæ´»ã€æ”¯æŒè‡ªç„¶è¯­è¨€</td><td>å¯èƒ½å‡ºé”™ã€éœ€æ ¡éªŒ</td><td>åŸå‹éªŒè¯ã€å†…éƒ¨å·¥å…·</td></tr><tr><td><strong>æ¨¡æ¿åŒ¹é… + è§„åˆ™å¼•æ“</strong></td><td>ç¨³å®šã€å¯æ§</td><td>æ‰©å±•æ€§å·®ã€éœ€ç»´æŠ¤è§„åˆ™</td><td>å›ºå®šæŸ¥è¯¢æ¨¡å¼</td></tr><tr><td><strong>ä¸“ç”¨ NL2SQL æ¨¡å‹ï¼ˆå¦‚ SQLCoderï¼‰</strong></td><td>å‡†ç¡®ç‡é«˜</td><td>éœ€éƒ¨ç½²æ¨¡å‹ã€èµ„æºæ¶ˆè€—å¤§</td><td>ä¼ä¸šçº§äº§å“</td></tr></tbody></table>
<blockquote>
<p>âœ… å¯¹äºä¸ªäººé¡¹ç›®æˆ– MVPï¼Œ<strong>LLM + Prompt å·¥ç¨‹</strong> æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„é€‰æ‹©ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-12">å…­ã€æ€»ç»“è¦ç‚¹</h2>
<ul>
<li>âœ… SQLite è½»é‡æ˜“ç”¨ï¼Œé€‚åˆæœ¬åœ°æ•°æ®å­˜å‚¨ä¸æµ‹è¯•</li>
<li>âœ… é€šè¿‡Â <code>PRAGMA table_info</code>Â å¯ç¨‹åºåŒ–è·å–è¡¨ç»“æ„</li>
<li>âœ… LLMï¼ˆå¦‚ DeepSeekï¼‰èƒ½æœ‰æ•ˆå°†è‡ªç„¶è¯­è¨€è½¬ä¸º SQL</li>
<li>âœ…Â <strong>Prompt è¦æ¸…æ™°ã€çº¦æŸè¦æ˜ç¡®</strong></li>
<li>âŒÂ <strong>æ°¸è¿œä¸è¦ä¿¡ä»» LLM è¾“å‡ºï¼Œå¿…é¡»æ ¡éªŒ SQL å®‰å…¨æ€§</strong></li>
</ul>
<hr/>
<h2 data-id="heading-13">ä¸ƒã€æ‹“å±•æ€è€ƒ</h2>
<ol>
<li><strong>å¦‚ä½•æ”¯æŒå¤šè¡¨ JOIN æŸ¥è¯¢ï¼Ÿ</strong><br/>
â†’ åœ¨ Schema ä¸­æä¾›å¤šä¸ªè¡¨çš„ DDLï¼Œå¹¶åœ¨é—®é¢˜ä¸­æ˜ç¡®å…³è”å­—æ®µã€‚</li>
<li><strong>èƒ½å¦ç¼“å­˜å¸¸è§é—®é¢˜çš„ SQLï¼Ÿ</strong><br/>
â†’ å¯å»ºç«‹â€œé—®é¢˜- SQLâ€æ˜ å°„ç¼“å­˜ï¼Œæå‡å“åº”é€Ÿåº¦ä¸ç¨³å®šæ€§ã€‚</li>
<li><strong>å¦‚ä½•è¯„ä¼°ç”Ÿæˆ SQL çš„å‡†ç¡®ç‡ï¼Ÿ</strong><br/>
â†’ æ„å»ºæµ‹è¯•é›†ï¼Œç”¨æ‰§è¡Œç»“æœ vs äººå·¥æ ‡æ³¨ç»“æœåšæ¯”å¯¹ã€‚</li>
<li><strong>å‰ç«¯é›†æˆï¼Ÿ</strong><br/>
â†’ ç”¨ Flask/FastAPI å°è£…ä¸º REST APIï¼Œå‰ç«¯è¾“å…¥é—®é¢˜ â†’ è¿”å›è¡¨æ ¼æ•°æ®ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å¼€å§‹ï¼šå‰ç«¯å¦‚ä½•é€šè¿‡ `fetch` è°ƒç”¨ å¤§æ¨¡å‹ï¼ˆè¯¦è§£ï¼‰]]></title>    <link>https://juejin.cn/post/7575104251866873866</link>    <guid>https://juejin.cn/post/7575104251866873866</guid>    <pubDate>2025-11-23T06:34:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575104251866873866" data-draft-id="7575102474639327283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" ä»é›¶å¼€å§‹ï¼šå‰ç«¯å¦‚ä½•é€šè¿‡ `fetch` è°ƒç”¨ å¤§æ¨¡å‹ï¼ˆè¯¦è§£ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,LLM"/> <meta itemprop="datePublished" content="2025-11-23T06:34:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çƒŸè¢…"/> <meta itemprop="url" content="https://juejin.cn/user/1845419006243504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             ä»é›¶å¼€å§‹ï¼šå‰ç«¯å¦‚ä½•é€šè¿‡ `fetch` è°ƒç”¨ å¤§æ¨¡å‹ï¼ˆè¯¦è§£ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1845419006243504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çƒŸè¢…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T06:34:12.000Z" title="Sun Nov 23 2025 06:34:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£ AI åº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨æµè§ˆå™¨ç«¯ç›´æ¥è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ APIã€‚è™½ç„¶æœ‰ OpenAI SDK ç­‰å°è£…å·¥å…·ï¼Œä½†ä½¿ç”¨åŸç”Ÿ <code>fetch</code> å‘é€ HTTP è¯·æ±‚æ˜¯ä¸€ç§æ›´çµæ´»ã€å¯æ§ä¸”æ˜“äºç†è§£çš„æ–¹å¼ã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆä½ æä¾›çš„ä»£ç å’Œç¬”è®°ï¼Œæ·±å…¥è§£æ <strong>å¦‚ä½•åœ¨å‰ç«¯é€šè¿‡ <code>fetch</code> è°ƒç”¨ DeepSeek çš„èŠå¤©æ¥å£</strong>ï¼Œå¹¶é€è¡Œè§£é‡Šæ¯ä¸€ä¸ªå…³é”®æ­¥éª¤ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ§© ä¸€ã€å®Œæ•´çš„è°ƒç”¨ä»£ç </h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// llm api åœ°å€</span>
<span class="hljs-keyword">const</span> endpoint = <span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>;

<span class="hljs-comment">// è¯·æ±‚å¤´</span>
<span class="hljs-keyword">const</span> headers = {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
  <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_DEEPSEEK_API_KEY}</span>`</span>
};

<span class="hljs-comment">// è¯·æ±‚ä½“</span>
<span class="hljs-keyword">const</span> payload = {
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
  <span class="hljs-attr">messages</span>: [
    { <span class="hljs-attr">role</span>: <span class="hljs-string">'system'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'You are a helpful assistant.'</span> },
    { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ å¥½ Deepseek'</span> }
  ]
};

<span class="hljs-comment">// å‘èµ·è¯·æ±‚</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(endpoint, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  headers,
  <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payload)
});

<span class="hljs-comment">// è§£æå“åº”</span>
<span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);

<span class="hljs-comment">// æ˜¾ç¤ºç»“æœ</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'reply'</span>).<span class="hljs-property">textContent</span> = data.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
</code></pre>
<p>è¿™æ®µä»£ç å®ç°äº†ä»ç”¨æˆ·è¾“å…¥åˆ°æ¨¡å‹å›å¤çš„å®Œæ•´æµç¨‹ã€‚ä¸‹é¢æˆ‘ä»¬é€éƒ¨åˆ†æ‹†è§£ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ” äºŒã€HTTP è¯·æ±‚ç»“æ„è§£æï¼ˆç»“åˆä½ çš„ç¬”è®°ï¼‰</h2>
<h3 data-id="heading-2">1. è¯·æ±‚è¡Œï¼ˆRequest Lineï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">POST /chat/completions HTTP/1.1
Host: api.deepseek.com
</code></pre>
<ul>
<li><code>POST</code>ï¼šå¿…é¡»ä½¿ç”¨ POST æ–¹æ³•ï¼Œå› ä¸º API æ¥å£è¦æ±‚ï¼›</li>
<li><code>/chat/completions</code>ï¼šDeepSeek çš„èŠå¤©æ¥å£è·¯å¾„ï¼›</li>
<li><code>HTTP/1.1</code>ï¼šæ ‡å‡†ç‰ˆæœ¬ï¼Œæµè§ˆå™¨è‡ªåŠ¨å¤„ç†ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3">2. è¯·æ±‚å¤´ï¼ˆHeadersï¼‰</h3>
<pre><code class="hljs language-css" lang="css">{
  '<span class="hljs-attribute">Content</span>-Type': <span class="hljs-string">'application/json'</span>,
  <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer sk-xxxxxx'</span>
}
</code></pre>
<ul>
<li><code>'Content-Type': 'application/json'</code><br/>
å‘Šè¯‰æœåŠ¡å™¨è¯·æ±‚ä½“æ˜¯ JSON æ ¼å¼ï¼Œè¿™æ˜¯å¿…éœ€çš„ã€‚</li>
<li><code>'Authorization': 'Bearer &lt;key&gt;'</code><br/>
è®¤è¯æ–¹å¼ï¼Œ<code>Bearer</code> æ˜¯å›ºå®šå‰ç¼€ï¼Œåé¢è·Ÿä½ çš„ API Keyã€‚</li>
</ul>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šAPI Key ä¸èƒ½ç¡¬ç¼–ç åœ¨å‰ç«¯ä»£ç ä¸­ï¼Œåº”é€šè¿‡ Vite çš„ç¯å¢ƒå˜é‡ç®¡ç†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// .env æ–‡ä»¶
<span class="hljs-attr">VITE_DEEPSEEK_API_KEY</span>=sk-xxxxxxxx
</code></pre>
<p>åœ¨ä»£ç ä¸­ä½¿ç”¨ <code>import.meta.env.VITE_DEEPSEEK_API_KEY</code> è·å–ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">3. è¯·æ±‚ä½“ï¼ˆBodyï¼‰</h3>
<pre><code class="hljs language-css" lang="css">{
  model: <span class="hljs-string">'deepseek-chat'</span>,
  messages: [
    { role: <span class="hljs-string">'system'</span>, content: <span class="hljs-string">'You are a helpful assistant.'</span> },
    { role: <span class="hljs-string">'user'</span>, content: <span class="hljs-string">'ä½ å¥½ Deepseek'</span> }
  ]
}
</code></pre>
<ul>
<li>
<p><code>model</code>ï¼šæŒ‡å®šä½¿ç”¨çš„æ¨¡å‹åç§°ï¼›</p>
</li>
<li>
<p><code>messages</code>ï¼šå¯¹è¯å†å²ï¼Œæ”¯æŒå¤šè½®äº¤äº’ï¼›</p>
<ul>
<li><code>role: "system"</code>ï¼šè®¾å®šåŠ©æ‰‹è¡Œä¸ºï¼›</li>
<li><code>role: "user"</code>ï¼šç”¨æˆ·çš„æé—®å†…å®¹ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… æ³¨æ„ï¼š<strong>è¯·æ±‚ä½“å¿…é¡»æ˜¯å­—ç¬¦ä¸²åŒ–åçš„ JSON</strong>ï¼Œæ‰€ä»¥è¦ç”¨ <code>JSON.stringify()</code>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">4. ä½¿ç”¨ <code>fetch</code> å‘é€è¯·æ±‚</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(endpoint, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  headers,
  <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payload)
});
</code></pre>
<ul>
<li><code>method: 'POST'</code>ï¼šå‘é€ POST è¯·æ±‚ï¼›</li>
<li><code>headers</code>ï¼šè®¾ç½®è¯·æ±‚å¤´ï¼›</li>
<li><code>body: JSON.stringify(payload)</code>ï¼šå°† JS å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œ<strong>ä¸èƒ½ç›´æ¥ä¼ å¯¹è±¡</strong>ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ <code>await</code> æ¯” <code>.then()</code> æ›´ç›´è§‚ï¼Œé€‚åˆå¼‚æ­¥æ“ä½œã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">5. å¤„ç†å“åº”</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">data</span> = await response.json()<span class="hljs-comment">;</span>
console.log(data)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><code>response.json()</code> å°†å“åº”ä½“è§£æä¸º JavaScript å¯¹è±¡ï¼›</li>
<li><code>data.choices[0].message.content</code> æ˜¯æ¨¡å‹è¿”å›çš„æ–‡æœ¬ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">6. æ˜¾ç¤ºç»“æœ</h3>
<pre><code class="hljs language-ini" lang="ini">document.getElementById('reply').<span class="hljs-attr">textContent</span> = data.choices[<span class="hljs-number">0</span>].message.content<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>å°†æ¨¡å‹å›å¤æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼ˆå‡è®¾æœ‰ä¸€ä¸ª id ä¸º <code>reply</code> çš„å…ƒç´ ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">ğŸ”„ ä¸‰ã€å¼‚æ­¥å¤„ç†ï¼š<code>.then</code> vs <code>await</code></h2>
<p>ä½ æåˆ°ï¼š</p>
<blockquote>
<p><code>- await å¼‚æ­¥å˜åŒæ­¥æ¯” then æ›´æ–¹ä¾¿</code></p>
</blockquote>
<p>âœ… å®Œå…¨æ­£ç¡®ï¼</p>

















<table><thead><tr><th>æ–¹å¼</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>.then()</code></td><td>é“¾å¼è°ƒç”¨ï¼Œé€‚åˆå¤æ‚é€»è¾‘</td></tr><tr><td><code>await</code></td><td>ä»£ç åƒåŒæ­¥ä¸€æ ·ï¼Œæ›´æ˜“è¯»</td></tr></tbody></table>
<p>æ¨èä½¿ç”¨ <code>await</code>ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œæ—¶ã€‚</p>
<hr/>
<h2 data-id="heading-9">ğŸ” å››ã€å®‰å…¨å»ºè®®ï¼šAPI Key çš„å­˜æ”¾ä½ç½®</h2>
<h3 data-id="heading-10">âŒ ä¸æ¨èï¼ˆå‰ç«¯æš´éœ²ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">apiKey</span> = <span class="hljs-string">'sk-xxxxxxxx'</span><span class="hljs-comment">; // ç›´æ¥å†™åœ¨ä»£ç é‡Œ â†’ å®¹æ˜“æ³„éœ²</span>
</code></pre>
<h3 data-id="heading-11">âœ… æ¨èï¼ˆåç«¯ä»£ç†ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯è·¯ç”±</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>, {
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${process.env.DEEPSEEK_API_KEY}</span>`</span> <span class="hljs-comment">// åç«¯ç¯å¢ƒå˜é‡ï¼Œå®‰å…¨ï¼</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(req.<span class="hljs-property">body</span>)
  });
  res.<span class="hljs-title function_">json</span>(result);
});
</code></pre>
<p>ç„¶åå‰ç«¯åªè°ƒç”¨è‡ªå·±çš„ <code>/api/chat</code>ï¼Œ<strong>æ°¸è¿œçœ‹ä¸åˆ°çœŸå® API Key</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-12">âœ… äº”ã€æ€»ç»“ï¼šå‰ç«¯è°ƒç”¨ LLM çš„æ ¸å¿ƒè¦ç‚¹</h2>





































<table><thead><tr><th>è¦ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… ä½¿ç”¨ <code>fetch</code> å‘é€ POST è¯·æ±‚</td><td>æ ‡å‡†æ–¹å¼ï¼Œå…¼å®¹æ€§å¼º</td></tr><tr><td>âœ… è®¾ç½® <code>Content-Type: application/json</code></td><td>å¿…é¡»</td></tr><tr><td>âœ… æ·»åŠ  <code>Authorization: Bearer &lt;key&gt;</code></td><td>è®¤è¯å¿…è¦</td></tr><tr><td>âœ… ä½¿ç”¨ <code>JSON.stringify()</code> å¤„ç†è¯·æ±‚ä½“</td><td>ä¸èƒ½ç›´æ¥å‘é€ JS å¯¹è±¡</td></tr><tr><td>âœ… ä½¿ç”¨ <code>await</code> å¤„ç†å¼‚æ­¥</td><td>æ›´ç®€æ´</td></tr><tr><td>âœ… ç¯å¢ƒå˜é‡ç®¡ç† API Key</td><td>Vite æ”¯æŒ <code>VITE_</code> å¼€å¤´å˜é‡</td></tr><tr><td>âš ï¸ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æš´éœ² API Key</td><td>å¿…é¡»èµ°åç«¯ä»£ç†</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-13">ğŸ¯ ç»“è¯­</h2>
<blockquote>
<p><strong>æŠ€æœ¯çš„æœ¬è´¨æ˜¯è§£å†³é—®é¢˜ï¼Œè€Œä¸æ˜¯è¿½æ±‚â€œé«˜å¤§ä¸Šâ€çš„å·¥å…·ã€‚</strong></p>
</blockquote>
<p>å½“ä½ ç†è§£äº† <code>fetch</code> çš„å·¥ä½œåŸç†ï¼Œå°±èƒ½è½»æ¾å¯¹æ¥ä»»ä½•ç¬¦åˆ OpenAI åè®®çš„ LLM æœåŠ¡ã€‚æ— è®ºæ˜¯ DeepSeekã€Qwen è¿˜æ˜¯å…¶ä»–æ¨¡å‹ï¼Œåªè¦ä½ çŸ¥é“å®ƒçš„ API åœ°å€å’Œå‚æ•°æ ¼å¼ï¼Œå°±å¯ä»¥ç”¨è¿™æ®µä»£ç å¿«é€Ÿæ¥å…¥ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« å¸®ä½ å½»åº•ææ‡‚äº†å‰ç«¯è°ƒç”¨ LLM çš„å…¨è¿‡ç¨‹ï¼<br/>
å¦‚æœä½ æ­£åœ¨åšé¡¹ç›®ï¼Œæˆ‘å¯ä»¥å¸®ä½ å°è£…ä¸€ä¸ªé€šç”¨çš„ AI è°ƒç”¨æ¨¡å— ğŸ˜Š</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼šåŸºäº Vite çš„å·¥ç¨‹åŒ–å®è·µä¸ HTTP è¯·æ±‚è¯¦è§£]]></title>    <link>https://juejin.cn/post/7575090551357521972</link>    <guid>https://juejin.cn/post/7575090551357521972</guid>    <pubDate>2025-11-23T07:17:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575090551357521972" data-draft-id="7575162322239881216" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" å‰ç«¯è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼šåŸºäº Vite çš„å·¥ç¨‹åŒ–å®è·µä¸ HTTP è¯·æ±‚è¯¦è§£"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-23T07:17:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tzarevich"/> <meta itemprop="url" content="https://juejin.cn/user/578786070367529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             å‰ç«¯è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼šåŸºäº Vite çš„å·¥ç¨‹åŒ–å®è·µä¸ HTTP è¯·æ±‚è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578786070367529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tzarevich
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T07:17:23.000Z" title="Sun Nov 23 2025 07:17:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼šåŸºäº Vite çš„å·¥ç¨‹åŒ–å®è·µä¸ HTTP è¯·æ±‚è¯¦è§£</h2>
<p>éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿…çŒ›å‘å±•ï¼Œå¤§è¯­è¨€æ¨¡å‹å·²é€æ¸ä»ç§‘ç ”å®éªŒå®¤èµ°å‘å·¥ä¸šåº”ç”¨ã€‚æœ¬æ–‡å°†å›´ç»•â€œå‰ç«¯å¦‚ä½•ä»¥ HTTP è¯·æ±‚æ–¹å¼è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹â€è¿™ä¸€æ ¸å¿ƒä¸»é¢˜ï¼Œç»“åˆç°ä»£å‰ç«¯å·¥ç¨‹åŒ–å·¥å…· Viteï¼Œè¯¦ç»†è®²è§£é¡¹ç›®åˆå§‹åŒ–ã€ç¯å¢ƒå˜é‡é…ç½®ã€fetch è¯·æ±‚å°è£…ã€å®‰å…¨æ³¨æ„äº‹é¡¹ç­‰å…³é”®ç¯èŠ‚ï¼Œå¸®åŠ©è¯»è€…æŒæ¡ä»å‰ç«¯å‘èµ· LLM è°ƒç”¨çš„å…¨æµç¨‹ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆå‰ç«¯å¯ä»¥ç›´æ¥è°ƒç”¨ LLMï¼Ÿ</h3>
<p>ä¼ ç»Ÿè§‚ç‚¹è®¤ä¸ºï¼ŒAI æ¨¡å‹åº”ç”±åç«¯æœåŠ¡ä»£ç†è°ƒç”¨ï¼Œå‰ç«¯ä»…è´Ÿè´£å±•ç¤ºç»“æœã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œ<strong>å‰ç«¯ç›´è¿ LLM API æ˜¯å¯è¡Œä¸”é«˜æ•ˆçš„</strong>ï¼Œå‰ææ˜¯ï¼š</p>
<ol>
<li><strong>API æ”¯æŒ CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰</strong> ï¼šå¦‚ DeepSeekã€OpenRouter ç­‰éƒ¨åˆ†æœåŠ¡å•†å…è®¸æµè§ˆå™¨ç›´æ¥è¯·æ±‚ã€‚</li>
<li><strong>å®‰å…¨æ€§å¯æ§</strong>ï¼šé€šè¿‡çŸ­æœŸæœ‰æ•ˆçš„ API Keyã€IP ç™½åå•ã€è¯·æ±‚é¢‘ç‡é™åˆ¶ç­‰æ–¹å¼é™ä½é£é™©ã€‚</li>
<li><strong>æ— éœ€æ•æ„Ÿæ•°æ®å¤„ç†</strong>ï¼šç”¨æˆ·è¾“å…¥ä¸æ¶‰åŠéšç§æˆ–æœºå¯†ä¿¡æ¯ã€‚</li>
</ol>
<p>ä»¥ DeepSeek ä¸ºä¾‹ï¼Œå…¶å®˜æ–¹ API æ”¯æŒ CORSï¼Œå…è®¸å‰ç«¯é€šè¿‡ <code>fetch</code> ç›´æ¥å‘èµ· POST è¯·æ±‚ï¼Œè¿™ä¸ºå¿«é€ŸåŸå‹å¼€å‘å’Œè½»é‡çº§åº”ç”¨æä¾›äº†æå¤§ä¾¿åˆ©ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€é¡¹ç›®åˆå§‹åŒ–ï¼šä½¿ç”¨ Vite æ­å»ºå…¨æ ˆå‹å¥½å‹å‰ç«¯é¡¹ç›®</h3>
<p>Vite æ˜¯æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œä»¥å…¶æé€Ÿçš„å†·å¯åŠ¨å’Œçƒ­æ›´æ–°èƒ½åŠ›è‘—ç§°ã€‚è™½ç„¶ Vite æœ¬èº«æ˜¯å‰ç«¯æ„å»ºå™¨ï¼Œä½†å…¶å¯¹ç¯å¢ƒå˜é‡ã€TypeScriptã€ESM æ¨¡å—çš„åŸç”Ÿæ”¯æŒï¼Œä½¿å…¶æˆä¸ºè°ƒç”¨ LLM çš„ç†æƒ³è„šæ‰‹æ¶ã€‚</p>
<h4 data-id="heading-3">1. åˆ›å»ºé¡¹ç›®</h4>
<pre><code class="hljs language-sql" lang="sql">npm <span class="hljs-keyword">create</span> vite<span class="hljs-variable">@latest</span> llm<span class="hljs-operator">-</span>frontend<span class="hljs-operator">-</span>demo <span class="hljs-comment">-- --template vanilla</span>
cd llm<span class="hljs-operator">-</span>frontend<span class="hljs-operator">-</span>demo
npm install
</code></pre>
<p>é€‰æ‹© <code>vanilla</code> æ¨¡æ¿å³å¯è·å¾—ä¸€ä¸ªçº¯å‡€çš„ HTML/CSS/JS é¡¹ç›®ç»“æ„ï¼Œé€‚åˆæ•™å­¦å’Œå¿«é€ŸéªŒè¯ã€‚</p>
<h4 data-id="heading-4">2. é…ç½®ç¯å¢ƒå˜é‡</h4>
<p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œ<strong>API Key ç»ä¸èƒ½ç¡¬ç¼–ç åœ¨æºç ä¸­</strong>ã€‚Vite æä¾›äº† <code>.env</code> æ–‡ä»¶æœºåˆ¶ï¼Œæ‰€æœ‰ä»¥ <code>VITE_</code> å¼€å¤´çš„å˜é‡ä¼šè¢«æ³¨å…¥åˆ°å®¢æˆ·ç«¯ä»£ç ä¸­ã€‚</p>
<p>åˆ›å»º <code>.env.local</code> æ–‡ä»¶ï¼ˆè¯¥æ–‡ä»¶é€šå¸¸åŠ å…¥ <code>.gitignore</code>ï¼Œé¿å…æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">VITE_DEEPSEEK_API_KEY</span>=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šæ­¤æ–¹æ³•ä»…é€‚ç”¨äº API æœåŠ¡å•†å…è®¸å‰ç«¯ç›´è¿çš„åœºæ™¯ã€‚è‹¥æœåŠ¡å•†ç¦æ­¢ CORS æˆ–è¦æ±‚æ›´é«˜å®‰å…¨çº§åˆ«ï¼Œåˆ™å¿…é¡»é€šè¿‡åç«¯ä»£ç†ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€HTTP è¯·æ±‚è¯¦è§£ï¼šå¦‚ä½•æ­£ç¡®è°ƒç”¨ LLM API</h3>
<p>LLM API é€šå¸¸éµå¾ª RESTful è®¾è®¡ï¼Œä½¿ç”¨ JSON æ ¼å¼é€šä¿¡ã€‚ä»¥ DeepSeek çš„ <code>/chat/completions</code> æ¥å£ä¸ºä¾‹ï¼Œä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š<strong>è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“</strong>ã€‚</p>
<h4 data-id="heading-6">1. è¯·æ±‚è¡Œï¼ˆRequest Lineï¼‰</h4>
<ul>
<li><strong>Method</strong>: <code>POST</code>ï¼ˆå› ä¸ºéœ€è¦å‘é€æ¶ˆæ¯å†…å®¹ï¼‰</li>
<li><strong>URL</strong>: <code>https://api.deepseek.com/chat/completions</code></li>
<li><strong>HTTP ç‰ˆæœ¬</strong>: é€šå¸¸ç”±æµè§ˆå™¨è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ˜¾å¼æŒ‡å®š</li>
</ul>
<h4 data-id="heading-7">2. è¯·æ±‚å¤´ï¼ˆHeadersï¼‰</h4>
<p>å¿…é¡»åŒ…å«ä¸¤ä¸ªå…³é”®å­—æ®µï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> headers = {
  <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
  <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_DEEPSEEK_API_KEY}</span>`</span>
};
</code></pre>
<ul>
<li><code>Content-Type: application/json</code> å‘ŠçŸ¥æœåŠ¡å™¨è¯·æ±‚ä½“ä¸º JSON æ ¼å¼ã€‚</li>
<li><code>Authorization: Bearer &lt;token&gt;</code> æ˜¯ OAuth 2.0 æ ‡å‡†çš„è®¤è¯æ–¹å¼ï¼Œ<code>Bearer</code> ä¸ºå›ºå®šå‰ç¼€ã€‚</li>
</ul>
<h4 data-id="heading-8">3. è¯·æ±‚ä½“ï¼ˆBodyï¼‰</h4>
<p>LLM æ¥å£é€šå¸¸è¦æ±‚ç»“æ„åŒ–çš„æ¶ˆæ¯æ•°ç»„ï¼š</p>
<pre><code class="hljs language-css" lang="css">const payload = {
  model: <span class="hljs-string">'deepseek-chat'</span>, // æŒ‡å®šæ¨¡å‹åç§°
  messages: [
    { role: <span class="hljs-string">"system"</span>, content: <span class="hljs-string">"You are a helpful assistant."</span> },
    { role: <span class="hljs-string">"user"</span>, content: <span class="hljs-string">"ä½ å¥½ DeepSeek"</span> }
  ]
};
</code></pre>
<p>æ³¨æ„ï¼š<strong>body å¿…é¡»æ˜¯å­—ç¬¦ä¸²</strong>ï¼Œä¸èƒ½ç›´æ¥ä¼ å…¥ JavaScript å¯¹è±¡ã€‚éœ€ä½¿ç”¨ <code>JSON.stringify()</code> åºåˆ—åŒ–ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span>: JSON.<span class="hljs-built_in">stringify</span>(payload)
</code></pre>
<h5 data-id="heading-9">ä¸ºä»€ä¹ˆ body å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Ÿ</h5>
<p>è¿™æ˜¯å› ä¸º <strong><code>fetch</code> API çš„åº•å±‚å®ç°éµå¾ª HTTP åè®®è§„èŒƒ</strong>ï¼Œè€Œ HTTP åè®®è§„å®šï¼š<strong>è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰åªèƒ½æ˜¯å­—èŠ‚æµï¼ˆå³äºŒè¿›åˆ¶æ•°æ®ï¼‰</strong> ã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼ŒJavaScript æ— æ³•ç›´æ¥å‘é€å¯¹è±¡ã€æ•°ç»„ç­‰é«˜çº§æ•°æ®ç»“æ„â€”â€”è¿™äº›ç»“æ„åªå­˜åœ¨äºè¿è¡Œæ—¶å†…å­˜ä¸­ï¼Œç½‘ç»œä¼ è¾“å¿…é¡»å°†å…¶è½¬æ¢ä¸ºå¯åºåˆ—åŒ–çš„æ ¼å¼ã€‚</p>
<p>å½“ä½ è°ƒç”¨ <code>fetch</code> å¹¶è®¾ç½® <code>body</code> å­—æ®µæ—¶ï¼Œæµè§ˆå™¨æœŸæœ›ä½ æä¾›ä»¥ä¸‹å‡ ç§ç±»å‹ä¹‹ä¸€ï¼š</p>
<ul>
<li><code>string</code>ï¼ˆå¦‚ JSON å­—ç¬¦ä¸²ï¼‰</li>
<li><code>FormData</code></li>
<li><code>URLSearchParams</code></li>
<li><code>Blob</code> / <code>ArrayBuffer</code> / <code>ReadableStream</code> ç­‰äºŒè¿›åˆ¶ç±»å‹</li>
</ul>
<p>å¦‚æœä½ ç›´æ¥ä¼ å…¥ä¸€ä¸ª JavaScript å¯¹è±¡ï¼ˆä¾‹å¦‚ <code>{ key: "value" }</code>ï¼‰ï¼Œæµè§ˆå™¨ä¼šå°è¯•å°†å…¶éšå¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç»“æœé€šå¸¸æ˜¯ <code>[object Object]</code> â€”â€” è¿™æ˜¾ç„¶ä¸æ˜¯æœåŠ¡å™¨æœŸæœ›çš„ JSON æ ¼å¼ï¼Œä¼šå¯¼è‡´ API è¿”å›è§£æé”™è¯¯ï¼ˆå¦‚ 400 Bad Requestï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œ<strong>å¿…é¡»æ˜¾å¼ä½¿ç”¨ <code>JSON.stringify()</code> å°†å¯¹è±¡è½¬æ¢ä¸ºæ ‡å‡†çš„ JSON å­—ç¬¦ä¸²</strong>ï¼Œç¡®ä¿æœåŠ¡ç«¯èƒ½æ­£ç¡®ååºåˆ—åŒ–å¹¶ç†è§£ä½ çš„è¯·æ±‚å†…å®¹ã€‚åŒæ—¶ï¼Œé…åˆè®¾ç½®è¯·æ±‚å¤´ <code>'Content-Type': 'application/json'</code>ï¼Œå‘ŠçŸ¥æœåŠ¡å™¨ï¼šâ€œæˆ‘å‘é€çš„æ˜¯ JSON æ ¼å¼çš„æ–‡æœ¬â€ã€‚</p>
<blockquote>
<p>âœ… æ­£ç¡®åšæ³•ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span>: JSON.<span class="hljs-built_in">stringify</span>({ message: <span class="hljs-string">"hello"</span> })
</code></pre>
<p>âŒ é”™è¯¯åšæ³•ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span>: { message: <span class="hljs-string">"hello"</span> }  // å®é™…å‘é€çš„æ˜¯ "<span class="hljs-selector-attr">[object Object]</span>"
</code></pre>
</blockquote>
<p>è¿™ä¸€ç»†èŠ‚çœ‹ä¼¼å¾®å°ï¼Œå´æ˜¯å‰åç«¯æ•°æ®é€šä¿¡å¯é æ€§çš„å…³é”®ä¿éšœã€‚</p>
<h3 data-id="heading-10">å››ã€ä½¿ç”¨ fetch å‘èµ·å¼‚æ­¥è¯·æ±‚</h3>
<p>ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒ <code>fetch</code> APIï¼Œå®ƒæ˜¯å‘èµ· HTTP è¯·æ±‚çš„æ ‡å‡†æ–¹å¼ã€‚</p>
<h4 data-id="heading-11">å®Œæ•´è°ƒç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> endpoint = <span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">callDeepSeek</span>(<span class="hljs-params">userMessage</span>) {
  <span class="hljs-keyword">const</span> headers = {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
    <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_DEEPSEEK_API_KEY}</span>`</span>
  };

  <span class="hljs-keyword">const</span> payload = {
    <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
    <span class="hljs-attr">messages</span>: [
      { <span class="hljs-attr">role</span>: <span class="hljs-string">"system"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"You are a helpful assistant."</span> },
      { <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: userMessage }
    ]
  };

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(endpoint, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      headers,
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payload)
    });

    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">return</span> data.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è°ƒç”¨ DeepSeek å¤±è´¥:'</span>, error);
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æŠ±æ­‰ï¼Œæš‚æ—¶æ— æ³•è·å–å›å¤ã€‚'</span>;
  }
}

<span class="hljs-comment">// ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'send-btn'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'user-input'</span>);
  <span class="hljs-keyword">const</span> replyEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'reply'</span>);

  <span class="hljs-keyword">const</span> userMsg = input.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
  <span class="hljs-keyword">if</span> (!userMsg) <span class="hljs-keyword">return</span>;

  replyEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">'æ€è€ƒä¸­...'</span>;
  <span class="hljs-keyword">const</span> reply = <span class="hljs-keyword">await</span> <span class="hljs-title function_">callDeepSeek</span>(userMsg);
  replyEl.<span class="hljs-property">textContent</span> = reply;
  input.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
});
</code></pre>
<h4 data-id="heading-12">å…³é”®ç‚¹è¯´æ˜</h4>
<ul>
<li>ä½¿ç”¨ <code>async/await</code> ä½¿å¼‚æ­¥ä»£ç æ›´æ˜“è¯»ï¼Œé¿å…å›è°ƒåœ°ç‹±ã€‚</li>
<li>å¯¹ <code>response.ok</code> è¿›è¡Œåˆ¤æ–­ï¼Œé˜²æ­¢é 2xx å“åº”è¢«è¯¯è®¤ä¸ºæˆåŠŸã€‚</li>
<li>é”™è¯¯å¤„ç†å¿…ä¸å¯å°‘ï¼Œç½‘ç»œæ³¢åŠ¨æˆ–é…é¢è€—å°½å¯èƒ½å¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13">äº”ã€å·¥ç¨‹åŒ–æ€ç»´ï¼šä»£ç å¦‚é’¢ç­‹æ°´æ³¥</h3>
<p>åœ¨ Trae æ‰€å€¡å¯¼çš„â€œå·¥ç¨‹åŒ–â€ç†å¿µä¸­ï¼Œä»£ç ä¸ä»…æ˜¯åŠŸèƒ½çš„è½½ä½“ï¼Œæ›´æ˜¯å¯ç»´æŠ¤ã€å¯æ‰©å±•ã€å¯åä½œçš„â€œå»ºç­‘ææ–™â€ã€‚è°ƒç”¨ LLM ä¸åº”åªæ˜¯å¤åˆ¶ç²˜è´´ä¸€æ®µ fetch ä»£ç ï¼Œè€Œåº”æ€è€ƒï¼š</p>
<ul>
<li><strong>å¯å¤ç”¨æ€§</strong>ï¼šå°† LLM è°ƒç”¨å°è£…ä¸ºç‹¬ç«‹å‡½æ•°æˆ–æ¨¡å—ã€‚</li>
<li><strong>å¯é…ç½®æ€§</strong>ï¼šæ¨¡å‹åç§°ã€ç³»ç»Ÿæç¤ºè¯å¯é€šè¿‡å‚æ•°ä¼ å…¥ã€‚</li>
<li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šæ¨¡æ‹Ÿ API å“åº”è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šåŠ è½½çŠ¶æ€ã€é”™è¯¯æç¤ºã€è¾“å…¥é™åˆ¶ç­‰ç»†èŠ‚ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¯è¿›ä¸€æ­¥æŠ½è±¡ä¸ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMClient</span> {
  <span class="hljs-keyword">constructor</span>(apiKey, model = <span class="hljs-string">'deepseek-chat'</span>) {
    <span class="hljs-keyword">this</span>.apiKey = apiKey;
    <span class="hljs-keyword">this</span>.model = model;
    <span class="hljs-keyword">this</span>.endpoint = <span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>;
  }

  async chat(messages, systemPrompt = <span class="hljs-string">"You are a helpful assistant."</span>) {
    <span class="hljs-keyword">const</span> fullMessages = [
      { role: <span class="hljs-string">"system"</span>, content: systemPrompt },
      ...messages
    ];

    <span class="hljs-keyword">const</span> response = await fetch(<span class="hljs-keyword">this</span>.endpoint, {
      method: <span class="hljs-string">'POST'</span>,
      headers: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        <span class="hljs-string">'Authorization'</span>: `Bearer ${<span class="hljs-keyword">this</span>.apiKey}`
      },
      body: JSON.stringify({ model: <span class="hljs-keyword">this</span>.model, messages: fullMessages })
    });

    <span class="hljs-keyword">const</span> <span class="hljs-keyword">data</span> = await response.json();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>.choices[<span class="hljs-number">0</span>].message.content;
  }
}
</code></pre>
<p>è¿™ç§é¢å‘å¯¹è±¡çš„è®¾è®¡æ›´åˆ©äºå¤§å‹é¡¹ç›®é›†æˆã€‚</p>
<hr/>
<h3 data-id="heading-14">å…­ã€å®‰å…¨ä¸æœ€ä½³å®è·µ</h3>
<p>å°½ç®¡å‰ç«¯ç›´è¿ LLM ä¾¿æ·é«˜æ•ˆï¼Œä½†ä¹Ÿå­˜åœ¨é£é™©ï¼š</p>
<ol>
<li>
<p><strong>API Key æ³„éœ²</strong>ï¼šä¸€æ—¦ <code>.env</code> ä¸­çš„ Key è¢«æå–ï¼Œå¯èƒ½è¢«æ»¥ç”¨äº§ç”Ÿé«˜é¢è´¹ç”¨ã€‚</p>
<ul>
<li>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨çŸ­æœŸ Tokenã€è®¾ç½® IP ç™½åå•ã€ç›‘æ§è°ƒç”¨é‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>CORS é™åˆ¶</strong>ï¼šå¹¶éæ‰€æœ‰ LLM æœåŠ¡å•†éƒ½å¼€æ”¾ CORSã€‚</p>
<ul>
<li>æ›¿ä»£æ–¹æ¡ˆï¼šé€šè¿‡ Vite çš„ä»£ç†åŠŸèƒ½ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰æˆ–éƒ¨ç½²è½»é‡åç«¯ï¼ˆå¦‚ Cloudflare Workersï¼‰ä¸­è½¬ã€‚</li>
</ul>
</li>
<li>
<p><strong>é€Ÿç‡é™åˆ¶</strong>ï¼šé¢‘ç¹è¯·æ±‚å¯èƒ½è§¦å‘é™æµã€‚</p>
<ul>
<li>å»ºè®®ï¼šæ·»åŠ é˜²æŠ–ã€é˜Ÿåˆ—æœºåˆ¶æˆ–ç”¨æˆ·æç¤ºã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-15">ç»“è¯­</h3>
<p>å‰ç«¯è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ä¸å†æ˜¯é¥ä¸å¯åŠçš„æ¦‚å¿µï¼Œè€Œæ˜¯è§¦æ‰‹å¯åŠçš„å·¥ç¨‹å®è·µã€‚å€ŸåŠ© Vite çš„ç°ä»£åŒ–å¼€å‘ä½“éªŒå’Œæµè§ˆå™¨åŸç”Ÿçš„ <code>fetch</code> èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿæ„å»ºå…·å¤‡ AI èƒ½åŠ›çš„ Web åº”ç”¨ã€‚ç„¶è€Œï¼ŒæŠ€æœ¯ä¾¿åˆ©çš„èƒŒåæ˜¯å¯¹å·¥ç¨‹è§„èŒƒã€å®‰å…¨æ„è¯†å’Œç”¨æˆ·ä½“éªŒçš„æ›´é«˜è¦æ±‚ã€‚</p>
<p>æœªæ¥ï¼Œéšç€ WebAssemblyã€WebGPU ç­‰æŠ€æœ¯çš„å‘å±•ï¼Œç”šè‡³å¯èƒ½åœ¨æµè§ˆå™¨æœ¬åœ°è¿è¡Œå°å‹ LLMï¼Œå®ç°å®Œå…¨ç¦»çº¿çš„æ™ºèƒ½äº¤äº’ã€‚ä½†æ— è®ºæŠ€æœ¯å¦‚ä½•æ¼”è¿›ï¼Œâ€œå·¥ç¨‹åŒ–â€å§‹ç»ˆæ˜¯é«˜è´¨é‡è½¯ä»¶å¼€å‘çš„åŸºçŸ³â€”â€”æ­£å¦‚é’¢ç­‹æ°´æ³¥ä¹‹äºæ‘©å¤©å¤§æ¥¼ï¼Œä»£ç ç»“æ„ä¹‹äºæ•°å­—ä¸–ç•Œã€‚</p>
<blockquote>
<p><strong>ä»£ç ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ç²¾å¿ƒè®¾è®¡çš„å·¥ç¨‹ã€‚</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Monorepo æ¶æ„å…¨è§£æï¼šä»æ¦‚å¿µåˆ°è½åœ°çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7575807729722392610</link>    <guid>https://juejin.cn/post/7575807729722392610</guid>    <pubDate>2025-11-23T08:06:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7575807729722392610" data-draft-id="7575807729722228770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Monorepo æ¶æ„å…¨è§£æï¼šä»æ¦‚å¿µåˆ°è½åœ°çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-23T08:06:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wect"/> <meta itemprop="url" content="https://juejin.cn/user/4185164878720068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Monorepo æ¶æ„å…¨è§£æï¼šä»æ¦‚å¿µåˆ°è½åœ°çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4185164878720068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wect
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-23T08:06:51.000Z" title="Sun Nov 23 2025 08:06:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Monorepoï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>Monorepoï¼ˆå•ä½“ä»“åº“ï¼‰æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘æ¶æ„æ¨¡å¼ï¼Œå®ƒå°†å¤šä¸ªç›¸å…³é¡¹ç›®ã€åº”ç”¨æˆ–æ¨¡å—çš„æºä»£ç é›†ä¸­å­˜å‚¨åœ¨å•ä¸€çš„ä»£ç ä»“åº“ä¸­è¿›è¡Œç®¡ç†ã€‚ä¸ä¼ ç»Ÿçš„å¤šä»“åº“ï¼ˆMulti-repoï¼‰æ¨¡å¼ä¸åŒï¼ŒMonorepo å…è®¸å›¢é˜Ÿåœ¨ä¸€ä¸ªç»Ÿä¸€çš„ä¸Šä¸‹æ–‡ä¸­å¼€å‘å¤šä¸ªç›¸å…³ç»„ä»¶ï¼Œä»è€Œç®€åŒ–äº†ä»£ç å…±äº«å’Œé¡¹ç›®é—´ä¾èµ–ç®¡ç†ã€‚</p>
<h3 data-id="heading-2">1.2 ä¸å¤šä»“åº“ï¼ˆMulti-repoï¼‰çš„å¯¹æ¯”</h3>


















































<table><thead><tr><th>ç‰¹æ€§/æ–¹é¢</th><th>Monorepoï¼ˆå•ä½“ä»“åº“ï¼‰</th><th>Multi-repoï¼ˆå¤šä»“åº“ï¼‰</th></tr></thead><tbody><tr><td><strong>ä»£ç ç»„ç»‡</strong></td><td>æ‰€æœ‰é¡¹ç›®ä»£ç åœ¨ä¸€ä¸ªä»“åº“ä¸­</td><td>æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹ä»“åº“</td></tr><tr><td><strong>ä»£ç å…±äº«</strong></td><td>ç›´æ¥é€šè¿‡å¼•ç”¨å…±äº«ä»£ç ï¼Œæ— éœ€å‘å¸ƒåŒ…</td><td>éœ€è¦å°†å…±äº«ä»£ç å‘å¸ƒä¸ºnpmåŒ…æ‰èƒ½å¤ç”¨</td></tr><tr><td><strong>ä¾èµ–ç®¡ç†</strong></td><td>ç»Ÿä¸€ä¾èµ–ç‰ˆæœ¬ï¼Œé¿å…ç‰ˆæœ¬å†²çª</td><td>å„ä»“åº“å¯èƒ½ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ä¾èµ–ï¼Œæ˜“å‡ºç°å†²çª</td></tr><tr><td><strong>ä»£ç å˜æ›´</strong></td><td>è·¨é¡¹ç›®å˜æ›´å¯åœ¨ä¸€æ¬¡æäº¤ä¸­å®Œæˆ</td><td>éœ€è¦åœ¨å¤šä¸ªä»“åº“ä¸­è¿›è¡Œå¤šæ¬¡æäº¤å’Œåè°ƒ</td></tr><tr><td><strong>æ„å»ºæµ‹è¯•</strong></td><td>å¯ç»Ÿä¸€æ„å»ºã€æµ‹è¯•æ‰€æœ‰é¡¹ç›®</td><td>éœ€è¦å•ç‹¬æ„å»ºã€æµ‹è¯•æ¯ä¸ªä»“åº“</td></tr><tr><td><strong>å­˜å‚¨æ•ˆç‡</strong></td><td>ä¾èµ–åªå®‰è£…ä¸€æ¬¡ï¼ŒèŠ‚çœç©ºé—´</td><td>ç›¸åŒä¾èµ–åœ¨å„ä»“åº“ä¸­é‡å¤å®‰è£…</td></tr><tr><td><strong>æƒé™ç®¡ç†</strong></td><td>è¾ƒéš¾å®ç°ç»†ç²’åº¦çš„æƒé™æ§åˆ¶</td><td>å¯é’ˆå¯¹ä¸åŒä»“åº“è®¾ç½®ä¸åŒæƒé™</td></tr><tr><td><strong>åˆå§‹å¤æ‚åº¦</strong></td><td>é…ç½®ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦ä¸“ç”¨å·¥å…·æ”¯æŒ</td><td>é…ç½®ç®€å•ï¼Œå®¹æ˜“ä¸Šæ‰‹</td></tr></tbody></table>
<h3 data-id="heading-3">1.3 é€‚ç”¨åœºæ™¯</h3>
<p>Monorepo ç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šå¤šä¸ªæœåŠ¡ç´§å¯†ç›¸å…³ï¼Œç»å¸¸éœ€è¦ååŒå¼€å‘å’Œéƒ¨ç½²</li>
<li><strong>ç»„ä»¶åº“å¼€å‘</strong>ï¼šå…±äº«UIç»„ä»¶ã€å·¥å…·å‡½æ•°ç­‰å…¬å…±èµ„æº</li>
<li><strong>å‰ç«¯åº”ç”¨ä¸åç«¯æœåŠ¡çš„è”åˆå¼€å‘</strong>ï¼šéœ€è¦é¢‘ç¹è·¨é¡¹ç›®åä½œ</li>
<li><strong>å¤§å‹å›¢é˜Ÿåä½œ</strong>ï¼šä»£ç å…±äº«éœ€æ±‚é«˜ï¼Œéœ€è¦ç»Ÿä¸€çš„å·¥ä½œæµå’Œè§„èŒƒ</li>
<li><strong>éœ€è¦é¢‘ç¹åŒæ­¥æ›´æ–°çš„å¤šé¡¹ç›®</strong>ï¼šç›¸å…³é¡¹ç›®ä¹‹é—´å­˜åœ¨ç´§å¯†ä¾èµ–å…³ç³»</li>
</ul>
<h3 data-id="heading-4">1.4 å¸¸è§è¯¯åŒº</h3>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMonorepo å¹¶éé€‚ç”¨äºæ‰€æœ‰åœºæ™¯ï¼š</p>
<ul>
<li>å®ƒä¸æ„å‘³ç€æ‰€æœ‰ä»£ç éƒ½å¿…é¡»æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»ç„¶ä¿æŒè‰¯å¥½çš„æ¨¡å—åŒ–ç»“æ„</li>
<li>å®ƒä¸æ¶ˆé™¤ä»£ç éš”ç¦»çš„éœ€è¦ï¼Œç›¸åï¼ŒMonorepo æ›´å¼ºè°ƒåˆç†çš„é¡¹ç›®è¾¹ç•Œåˆ’åˆ†</li>
<li>å®ƒä¸æ˜¯è§£å†³æ‰€æœ‰åä½œé—®é¢˜çš„é“¶å¼¹ï¼Œä»éœ€è‰¯å¥½çš„å¼€å‘è§„èŒƒå’Œæµç¨‹é…åˆ</li>
<li>å¯¹äºå®Œå…¨ç‹¬ç«‹ã€æŠ€æœ¯æ ˆå·®å¼‚å¤§ã€å‡ ä¹ä¸éœ€è¦ä»£ç å…±äº«çš„é¡¹ç›®ï¼Œå¤šä»“åº“æ¨¡å¼å¯èƒ½æ›´åˆé€‚</li>
</ul>
<h2 data-id="heading-5">äºŒã€Monorepo æ ¸å¿ƒç›®æ ‡</h2>
<p>åœ¨åŠ¨æ‰‹å‰ï¼Œå…ˆæ˜ç¡® Monorepo çš„æ ¸å¿ƒç›®æ ‡ï¼Œé¿å…èµ°åã€‚å…¶æ ¸å¿ƒæ˜¯â€œå…¬å…±ä»£ç æŠ½ç¦»ã€ä¸šåŠ¡é¡¹ç›®éš”ç¦»â€ï¼Œå…·ä½“ç›®æ ‡åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼šä»£ç ã€ä¾èµ–ã€æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²æµç¨‹ç»Ÿä¸€ç»´æŠ¤ï¼›</li>
<li><strong>å…±äº«å¤ç”¨</strong>ï¼šå…¬å…±ä»£ç ï¼ˆå¦‚å·¥å…·å‡½æ•°ã€ç»„ä»¶ã€é…ç½®ï¼‰æŠ½ä¸ºå…¬å…±åŒ…ï¼Œé¿å…é‡å¤å¼€å‘ï¼›</li>
<li><strong>éš”ç¦»æ¸…æ™°</strong>ï¼šå„é¡¹ç›®/æ¨¡å—ç‹¬ç«‹ç¼–è¯‘ã€æµ‹è¯•ã€å‘å¸ƒï¼Œäº’ä¸å¹²æ‰°ï¼›</li>
<li><strong>é«˜æ•ˆåä½œ</strong>ï¼šè·¨é¡¹ç›®å¼€å‘æ— éœ€åˆ‡æ¢ä»“åº“ï¼Œåˆ†æ”¯ç®¡ç†ã€ä»£ç å®¡æŸ¥æ›´ç®€åŒ–ï¼›</li>
<li><strong>ç‰ˆæœ¬ä¸€è‡´</strong>ï¼šé¿å…å¤šä»“åº“é—´ä¾èµ–ç‰ˆæœ¬å†²çªï¼Œç¡®ä¿æ‰€æœ‰é¡¹ç›®ä½¿ç”¨ç»Ÿä¸€çš„ä¾èµ–ç‰ˆæœ¬ã€‚</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€æŠ€æœ¯æ ˆé€‰æ‹©</h2>
<p>åœ¨ä¼—å¤š Monorepo è§£å†³æ–¹æ¡ˆä¸­ï¼Œæœ¬æ¬¡é€‰ç”¨çš„æŠ€æœ¯æ ˆåŠæ ¸å¿ƒç†ç”±å¦‚ä¸‹ï¼š</p>

























<table><thead><tr><th>æŠ€æœ¯ç»„ä»¶</th><th>ç‰ˆæœ¬/ä½œç”¨</th><th>é€‰æ‹©ç†ç”±</th></tr></thead><tbody><tr><td>æ ¸å¿ƒåŒ…ç®¡ç†å™¨</td><td>Yarn 4.9.1ï¼ˆWorkspace ç‰¹æ€§ï¼‰</td><td>1. Workspace åŠŸèƒ½æˆç†Ÿç¨³å®šï¼›2. ä¾èµ–æå‡æœºåˆ¶ï¼ˆhoistingï¼‰å‡å°‘é‡å¤ä¾èµ–ï¼›3. æ”¯æŒ node-modules æ¨¡å¼ï¼›4. ä¸°å¯Œçš„å‘½ä»¤è¡Œå·¥å…·é€‚é… Monorepo æ“ä½œ</td></tr><tr><td>ä»£ç è§„èŒƒ</td><td>EditorConfig</td><td>ç»Ÿä¸€å¤šç¼–è¾‘å™¨ä»£ç æ ¼å¼é…ç½®ï¼Œä¿è¯å›¢é˜Ÿç¼–ç é£æ ¼ä¸€è‡´</td></tr><tr><td>ä»»åŠ¡è°ƒåº¦</td><td>concurrently</td><td>æ”¯æŒå¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œæå‡å¼€å‘å’Œæ„å»ºæ•ˆç‡</td></tr></tbody></table>
<h2 data-id="heading-7">å››ã€é¡¹ç›®ç›®å½•ç»“æ„è®¾è®¡</h2>
<p>åˆç†çš„ç›®å½•ç»“æ„æ˜¯ Monorepo æˆåŠŸçš„å…³é”®ï¼Œæœ¬æ¬¡é‡‡ç”¨ç»å…¸çš„åˆ†å±‚ç»“æ„ï¼Œæ¸…æ™°åŒºåˆ†ä¸šåŠ¡åº”ç”¨ä¸å…¬å…±èµ„æºï¼Œå…·ä½“ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">LowCode/
â”œâ”€â”€ package.json                <span class="hljs-meta"># æ ¹é¡¹ç›®é…ç½®ï¼ˆç®¡ç†å…¬å…±ä¾èµ–ã€è„šæœ¬å‘½ä»¤ï¼‰</span>
â”œâ”€â”€ tsconfig.<span class="hljs-keyword">base</span>.json          <span class="hljs-meta"># TypeScript åŸºç¡€é…ç½®ï¼ˆå…±äº«ç»™æ‰€æœ‰å­é¡¹ç›®ï¼‰</span>
â”œâ”€â”€ .yarn/                      <span class="hljs-meta"># Yarn é…ç½®</span>
â”œâ”€â”€ .yarnrc.yml                 <span class="hljs-meta"># Yarn è¿è¡Œæ—¶é…ç½®</span>
â”œâ”€â”€ å…¶ä»–é…ç½®...
â”œâ”€â”€ apps/                       <span class="hljs-meta"># ä¸šåŠ¡é¡¹ç›®ç›®å½•ï¼ˆç‹¬ç«‹éƒ¨ç½²çš„åº”ç”¨ï¼‰</span>
â”‚   â”œâ”€â”€ web/                    <span class="hljs-meta"># å‰ç«¯ Web åº”ç”¨</span>
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ api/                    <span class="hljs-meta"># åç«¯ API æœåŠ¡</span>
â”‚   â”‚   â””â”€â”€ package.json
â”œâ”€â”€ packages/                   <span class="hljs-meta"># å…¬å…±åŒ…ç›®å½•ï¼ˆå¯è¢«å…¶ä»–é¡¹ç›®ä¾èµ–ï¼‰</span>
â”‚   â”œâ”€â”€ utils/                  <span class="hljs-meta"># å·¥å…·å‡½æ•°åº“</span>
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ components/             <span class="hljs-meta"># UI ç»„ä»¶åº“</span>
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ config/                 <span class="hljs-meta"># å…±äº«é…ç½®åº“</span>
â”‚   â”‚   â””â”€â”€ package.json
</code></pre>
<p><strong>æ ¸å¿ƒç›®å½•è¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>apps/</strong> ï¼šå­˜æ”¾ä¸šåŠ¡åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½æ˜¯ç‹¬ç«‹å¯éƒ¨ç½²çš„é¡¹ç›®ï¼Œå¦‚å‰ç«¯ Web åº”ç”¨å’Œåç«¯ API æœåŠ¡ï¼›</li>
<li><strong>packages/</strong> ï¼šå­˜æ”¾å¯é‡ç”¨çš„å…¬å…±åº“ï¼Œä¾› apps ç›®å½•ä¸‹çš„é¡¹ç›®ä¾èµ–ä½¿ç”¨ï¼ŒåŒ…æ‹¬å·¥å…·å‡½æ•°ã€UI ç»„ä»¶å’Œå…±äº«é…ç½®ç­‰ï¼›</li>
<li><strong>æ ¹ç›®å½•</strong>ï¼šæ‰¿æ‹…å…¨å±€ç®¡ç†èŒè´£ï¼ŒåŒ…å«é¡¹ç›®çº§å…¬å…±é…ç½®ã€å…±äº«è„šæœ¬ã€ä¾èµ–å£°æ˜å’Œé¡¹ç›®æ–‡æ¡£ã€‚</li>
</ul>
<h2 data-id="heading-8">äº”ã€å®ç°æ­¥éª¤è¯¦è§£</h2>
<p>Monorepo çš„å®ç°éµå¾ªâ€œåˆå§‹åŒ–-é…ç½®-ç»†åŒ–â€çš„æµç¨‹ï¼Œä»æ ¹é¡¹ç›®æ­å»ºåˆ°å­é¡¹ç›®é…ç½®é€æ­¥æ¨è¿›ï¼Œç¡®ä¿æ¯ä¸ªç¯èŠ‚è¡”æ¥é¡ºç•…ã€‚</p>
<h3 data-id="heading-9">1. åˆå§‹åŒ–æ ¹é¡¹ç›®</h3>
<p>é¦–å…ˆåˆ›å»ºé¡¹ç›®æ ¹ç›®å½•å¹¶é€šè¿‡ Yarn åˆå§‹åŒ–ï¼Œç”ŸæˆåŸºç¡€çš„ package.json æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> LowCode
<span class="hljs-built_in">cd</span> LowCode
yarn init -y
</code></pre>
<h3 data-id="heading-10">2. é…ç½® Yarn Workspace</h3>
<p>Yarn Workspace æ˜¯å®ç° Monorepo ä¾èµ–ç®¡ç†å’Œé¡¹ç›®å…³è”çš„æ ¸å¿ƒï¼Œéœ€åœ¨æ ¹é¡¹ç›®çš„ package.json ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œæ˜ç¡®å·¥ä½œç©ºé—´èŒƒå›´å’Œå…¬å…±è„šæœ¬ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"low_code"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"packageManager"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn@4.9.1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"private"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"workspaces"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"packages/*"</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// æ‰€æœ‰åœ¨ packages ç›®å½•ä¸‹çš„å­é¡¹ç›®</span>
    <span class="hljs-string">"apps/*"</span>         <span class="hljs-comment">// æ‰€æœ‰åœ¨ apps ç›®å½•ä¸‹çš„å­é¡¹ç›®</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A run test"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build:all"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A -p run build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build:apps"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A --include 'apps/*' -p run build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build:packages"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A --include 'packages/*' -p run build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev:web"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspace @wect/web dev"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev:api"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspace @wect/api dev"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev:all"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"concurrently "</span>yarn workspace @wect/web dev<span class="hljs-string">" "</span>yarn workspace @wect/api dev<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"clean"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A -p run clean"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"add"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspace"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"remove"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspace"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A -p run lint"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn workspaces foreach -A -p run lint:fix"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write './**/*.{js,jsx,ts,tsx,json,md,yml}' --ignore-path .prettierignore"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"format:check"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --check './**/*.{js,jsx,ts,tsx,json,md,yml}' --ignore-path .prettierignore"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"concurrently"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^9.2.1"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>é…ç½®å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>private: true</code> ç¡®ä¿æ ¹é¡¹ç›®ä¸ä¼šè¢«æ„å¤–å‘å¸ƒï¼›</li>
<li><code>workspaces</code> æ•°ç»„å®šä¹‰å·¥ä½œç©ºé—´ä½ç½®ï¼Œè‡ªåŠ¨è¯†åˆ«æŒ‡å®šç›®å½•ä¸‹çš„å­é¡¹ç›®ï¼›</li>
<li>é€šè¿‡ <code>workspace</code> å‘½ä»¤æ“ä½œå•ä¸ªå­é¡¹ç›®ï¼Œ<code>workspaces foreach</code> æ‰¹é‡æ“ä½œæ‰€æœ‰å­é¡¹ç›®ï¼›</li>
<li>å­é¡¹ç›®åç§°ç»Ÿä¸€ä½¿ç”¨ä½œç”¨åŸŸå‰ç¼€ï¼ˆå¦‚ <code>@wect/web</code>ï¼‰ï¼Œé¿å…å‘½åå†²çªã€‚</li>
</ul>
<h3 data-id="heading-11">3. é…ç½® Yarn è¿è¡Œæ—¶</h3>
<p>åˆ›å»º <code>.yarnrc.yml</code> æ–‡ä»¶ï¼ŒæŒ‡å®š Yarn çš„ä¾èµ–é“¾æ¥æ¨¡å¼ï¼Œæœ¬æ¬¡é‡‡ç”¨ç»å…¸çš„ node-modules æ¨¡å¼ï¼Œå…¼å®¹æ€§æ›´å¼ºï¼š</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># Yarné…ç½®æ–‡ä»¶</span>
<span class="hljs-attr">nodeLinker:</span> <span class="hljs-string">node-modules</span>
</code></pre>
<h3 data-id="heading-12">4. åˆå§‹åŒ–å­é¡¹ç›®</h3>
<p>å­é¡¹ç›®åˆå§‹åŒ–æä¾›ä¸¤ç§æ–¹å¼ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©ï¼š</p>
<h4 data-id="heading-13">æ–¹æ³•ä¸€ï¼šæ‰¹é‡åˆå§‹åŒ–ï¼ˆæ¨èï¼‰</h4>
<p>å…ˆå®‰è£…ä»»åŠ¡è°ƒåº¦ä¾èµ– concurrentlyï¼Œå†é€šè¿‡ Yarn å‘½ä»¤æ‰¹é‡åˆå§‹åŒ–æ‰€æœ‰å­é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å…¬å…±å¼€å‘ä¾èµ–</span>
yarn add -D concurrently

<span class="hljs-comment"># æ‰¹é‡åˆå§‹åŒ–æ‰€æœ‰å­é¡¹ç›®</span>
yarn workspaces foreach -A -p init
</code></pre>
<h4 data-id="heading-14">æ–¹æ³•äºŒï¼šæ‰‹åŠ¨åˆå§‹åŒ–ï¼ˆé€‚ç”¨äºä¸ªåˆ«é¡¹ç›®ï¼‰</h4>
<p>è¿›å…¥å…·ä½“å­é¡¹ç›®ç›®å½•ï¼Œå•ç‹¬æ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤ï¼Œä»¥ web åº”ç”¨ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> apps/web
yarn init -y
</code></pre>
<h3 data-id="heading-15">5. é…ç½®å­é¡¹ç›®</h3>
<p>æ¯ä¸ªå­é¡¹ç›®éœ€é…ç½®ç‹¬ç«‹çš„ package.jsonï¼Œæ˜ç¡®è‡ªèº«ä¾èµ–ã€è„šæœ¬å‘½ä»¤ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶é€šè¿‡ workspace åè®®å…³è”å†…éƒ¨å…¬å…±åŒ…ã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒå­é¡¹ç›®çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<h4 data-id="heading-16">Web åº”ç”¨é…ç½®ï¼ˆapps/web/package.jsonï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"@wect/web"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"private"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"packageManager"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn@4.9.1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsc &amp;&amp; vite build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite preview"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo 'è¿è¡ŒWebæµ‹è¯•...'"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"clean"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"rm -rf dist"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint 'src/**/*.{js,jsx,ts,tsx}'"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint:fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint 'src/**/*.{js,jsx,ts,tsx}' --fix"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"prettier --write 'src/**/*' --ignore-path ../../.prettierignore"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@wect/utils"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span><span class="hljs-punctuation">,</span>       <span class="hljs-comment">// ä¾èµ–å†…éƒ¨å·¥å…·åŒ…</span>
    <span class="hljs-attr">"@wect/components"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// ä¾èµ–å†…éƒ¨ç»„ä»¶åº“</span>
    <span class="hljs-attr">"@wect/config"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span><span class="hljs-punctuation">,</span>      <span class="hljs-comment">// ä¾èµ–å†…éƒ¨é…ç½®åº“</span>
    <span class="hljs-attr">"react"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"react-dom"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.2.0"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@types/node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^20.14.10"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@types/react"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@types/react-dom"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^19.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@vitejs/plugin-react"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^9.7.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint-plugin-react"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^7.35.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint-plugin-react-hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.6.2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"typescript"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.5.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vite"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^6.3.9"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-17">API æœåŠ¡é…ç½®ï¼ˆapps/api/package.jsonï¼‰</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"@wect/api"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"private"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>å¯åŠ¨APIå¼€å‘æœåŠ¡å™¨...<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>æ„å»ºAPIæœåŠ¡...<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>è¿è¡ŒAPIæœåŠ¡æµ‹è¯•...<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>æ£€æŸ¥APIæœåŠ¡ä»£ç ...<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"clean"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>æ¸…ç†APIæœåŠ¡æ„å»ºäº§ç‰©...<span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deploy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo "</span>éƒ¨ç½²APIæœåŠ¡...<span class="hljs-string">""</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@wect/utils"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@wect/config"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-18">6. ä¾èµ–ç®¡ç†è¯¦è§£</h3>
<p>Monorepo ä¸­çš„ä¾èµ–ç®¡ç†åˆ†ä¸ºâ€œå¤–éƒ¨ä¾èµ–â€å’Œâ€œå†…éƒ¨ä¾èµ–â€ï¼Œéœ€é‡‡ç”¨ä¸åŒçš„ç®¡ç†æ–¹å¼ï¼š</p>
<h4 data-id="heading-19">å®‰è£…å¤–éƒ¨ä¾èµ–</h4>
<p>æ ¹æ®ä¾èµ–çš„ä½œç”¨èŒƒå›´ï¼Œå¯å®‰è£…åœ¨æ ¹é¡¹ç›®ï¼ˆæ‰€æœ‰å­é¡¹ç›®å…±äº«ï¼‰æˆ–ç‰¹å®šå­é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…æ ¹é¡¹ç›®ä¾èµ–ï¼ˆæ‰€æœ‰å­é¡¹ç›®å…±äº«ï¼‰</span>
yarn add -D prettier eslint

<span class="hljs-comment"># ä¸º web åº”ç”¨å•ç‹¬å®‰è£…ä¾èµ–</span>
yarn workspace @wect/web add react react-dom
</code></pre>
<h4 data-id="heading-20">ä¾èµ–å†…éƒ¨å­é¡¹ç›®</h4>
<p>ä½¿ç”¨ <code>workspace:</code> åè®®å¼•ç”¨å…¶ä»–å·¥ä½œç©ºé—´ï¼Œç¡®ä¿å§‹ç»ˆä½¿ç”¨æœ¬åœ°æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…ç‰ˆæœ¬ä¸ä¸€è‡´é—®é¢˜ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@wect/utils"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span><span class="hljs-punctuation">,</span>    <span class="hljs-comment">// * è¡¨ç¤ºåŒ¹é…æœ€æ–°ç‰ˆæœ¬</span>
    <span class="hljs-attr">"@wect/components"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workspace:*"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-21">7. å¸¸ç”¨è„šæœ¬å‘½ä»¤è¯¦è§£</h3>
<p>æ ¹é¡¹ç›®çš„ scripts é…ç½®äº†æ‰¹é‡æ“ä½œå­é¡¹ç›®çš„å‘½ä»¤ï¼Œç»“åˆ Yarn Workspace ç‰¹æ€§å®ç°é«˜æ•ˆç®¡ç†ï¼Œæ ¸å¿ƒå‘½ä»¤åŠç”¨é€”å¦‚ä¸‹ï¼š</p>

































































<table><thead><tr><th>å‘½ä»¤åˆ†ç±»</th><th>å…·ä½“å‘½ä»¤</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td>å¼€å‘å‘½ä»¤</td><td>yarn dev:web</td><td>å•ç‹¬å¯åŠ¨ web åº”ç”¨å¼€å‘æœåŠ¡å™¨</td></tr><tr><td>yarn dev:api</td><td>å•ç‹¬å¯åŠ¨ API æœåŠ¡å¼€å‘æœåŠ¡å™¨</td><td/></tr><tr><td>yarn dev:all</td><td>å¹¶è¡Œå¯åŠ¨ web å’Œ API å¼€å‘æœåŠ¡ï¼ˆä¾èµ– concurrentlyï¼‰</td><td/></tr><tr><td>æ„å»ºå‘½ä»¤</td><td>yarn build:all</td><td>æ„å»ºæ‰€æœ‰å·¥ä½œç©ºé—´ï¼ˆåº”ç”¨+å…¬å…±åŒ…ï¼‰</td></tr><tr><td>yarn build:apps</td><td>ä»…æ„å»º apps ç›®å½•ä¸‹çš„ä¸šåŠ¡åº”ç”¨</td><td/></tr><tr><td>yarn build:packages</td><td>ä»…æ„å»º packages ç›®å½•ä¸‹çš„å…¬å…±åŒ…</td><td/></tr><tr><td>è´¨é‡ä¿éšœå‘½ä»¤</td><td>yarn test</td><td>è¿è¡Œæ‰€æœ‰å­é¡¹ç›®çš„æµ‹è¯•ç”¨ä¾‹</td></tr><tr><td>yarn lint / lint:fix</td><td>æ£€æŸ¥/ä¿®å¤æ‰€æœ‰å­é¡¹ç›®çš„ä»£ç è§„èŒƒé—®é¢˜</td><td/></tr><tr><td>yarn format / format:check</td><td>æ ¼å¼åŒ–ä»£ç /æ£€æŸ¥ä»£ç æ ¼å¼æ˜¯å¦åˆè§„</td><td/></tr><tr><td>yarn clean</td><td>æ¸…ç†æ‰€æœ‰å­é¡¹ç›®çš„æ„å»ºäº§ç‰©ï¼ˆdist ç›®å½•ï¼‰</td><td/></tr><tr><td/><td/><td/></tr></tbody></table>
<p><strong>æ‰¹é‡å‘½ä»¤æŠ€å·§</strong>ï¼š</p>
<ul>
<li><code>-A</code> å‚æ•°ï¼šæ“ä½œæ‰€æœ‰å·¥ä½œç©ºé—´ï¼›</li>
<li><code>-p</code> å‚æ•°ï¼šå¹¶è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œæå‡æ•ˆç‡ï¼›</li>
<li><code>--include</code> å‚æ•°ï¼šè¿‡æ»¤ç›®æ ‡å·¥ä½œç©ºé—´ï¼Œå¦‚ <code>--include 'apps/*'</code> ä»…æ“ä½œåº”ç”¨é¡¹ç›®ã€‚</li>
</ul>
<h2 data-id="heading-22">å…­ã€ç‰ˆæœ¬ä¸€è‡´æ€§ä¿éšœ</h2>
<p>Monorepo ä¸­ä¾èµ–ç‰ˆæœ¬ä¸ä¸€è‡´æ˜¯å¸¸è§é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´è¿è¡ŒæŠ¥é”™æˆ–åŠŸèƒ½å¼‚å¸¸ï¼Œéœ€ä»ä»¥ä¸‹ä¸‰æ–¹é¢ä¿éšœç‰ˆæœ¬ç»Ÿä¸€ï¼š</p>
<ol>
<li><strong>æ ¹çº§ä¾èµ–é”å®š</strong>ï¼šå°† TypeScriptã€æ„å»ºå·¥å…·ã€ä»£ç è§„èŒƒå·¥å…·ç­‰å…¬å…±ä¾èµ–åœ¨æ ¹é¡¹ç›®çš„ package.json ä¸­æ˜ç¡®å®šä¹‰ç‰ˆæœ¬ï¼Œå­é¡¹ç›®æ— éœ€é‡å¤å£°æ˜ï¼Œç›´æ¥ç»§æ‰¿æ ¹ä¾èµ–ç‰ˆæœ¬ï¼›</li>
<li><strong>ä½¿ç”¨ workspace åè®®</strong>ï¼šå­é¡¹ç›®é—´çš„ä¾èµ–å¿…é¡»ä½¿ç”¨ <code>workspace:*</code> åè®®ï¼Œç¡®ä¿å§‹ç»ˆå¼•ç”¨æœ¬åœ°æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…å­é¡¹ç›®é—´ä¾èµ–ç‰ˆæœ¬é”™ä½ï¼›</li>
<li><strong>ç»Ÿä¸€ TypeScript é…ç½®</strong>ï¼šæ ¹é¡¹ç›®åˆ›å»º <code>tsconfig.base.json</code> ä½œä¸ºåŸºç¡€é…ç½®ï¼Œå­é¡¹ç›®é€šè¿‡ <code>"extends": "../../tsconfig.base.json"</code> ç»§æ‰¿ï¼Œä¿è¯ç±»å‹æ£€æŸ¥è§„åˆ™ä¸€è‡´ã€‚</li>
</ol>
<h2 data-id="heading-23">ä¸ƒã€å®é™…é…ç½®æ€»ç»“</h2>
<p>æœ¬æ¬¡ Monorepo å®ç°çš„æ ¸å¿ƒé…ç½®è¦ç‚¹å¯å½’çº³ä¸ºä»¥ä¸‹ä¸‰ç‚¹ï¼Œä¾¿äºåç»­ç»´æŠ¤å’Œæ‰©å±•ï¼š</p>
<ul>
<li><strong>ä¾èµ–æ¨¡å¼</strong>ï¼šé‡‡ç”¨ node-modules æ¨¡å¼ï¼Œå…¼å®¹æ€§å¼ºï¼Œé¿å… PnP æ¨¡å¼å¯èƒ½å‡ºç°çš„å·¥å…·é€‚é…é—®é¢˜ï¼›</li>
<li><strong>å‘½åè§„èŒƒ</strong>ï¼šå­é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨ <code>@wect/</code> ä½œç”¨åŸŸå‰ç¼€ï¼Œæ¸…æ™°åŒºåˆ†é¡¹ç›®å½’å±ï¼Œé¿å…å‘½åå†²çªï¼›</li>
<li><strong>è„šæœ¬ç»Ÿä¸€</strong>ï¼šæ‰€æœ‰å­é¡¹ç›®å®šä¹‰ä¸€è‡´çš„è„šæœ¬å‘½ä»¤ï¼ˆå¦‚ buildã€devã€testï¼‰ï¼Œç¡®ä¿æ‰¹é‡æ“ä½œé¡ºç•…ï¼›</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>