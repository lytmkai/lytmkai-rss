<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[å…«å¹´å¼€æºï¼ŒGSY ç”¨äº”ç§æŠ€æœ¯å¼€å‘äº†åŒä¸€ä¸ª Github å®¢æˆ·ç«¯ï¼Œè¿™æ¬¡è½®åˆ° AI + Compose]]></title>    <link>https://juejin.cn/post/7585645111876632603</link>    <guid>https://juejin.cn/post/7585645111876632603</guid>    <pubDate>2025-12-21T23:11:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585645111876632603" data-draft-id="7585645111876616219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…«å¹´å¼€æºï¼ŒGSY ç”¨äº”ç§æŠ€æœ¯å¼€å‘äº†åŒä¸€ä¸ª Github å®¢æˆ·ç«¯ï¼Œè¿™æ¬¡è½®åˆ° AI + Compose"/> <meta itemprop="keywords" content="å‰ç«¯,Android,Flutter"/> <meta itemprop="datePublished" content="2025-12-21T23:11:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹çŒ«deå°éƒ­"/> <meta itemprop="url" content="https://juejin.cn/user/817692379985752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…«å¹´å¼€æºï¼ŒGSY ç”¨äº”ç§æŠ€æœ¯å¼€å‘äº†åŒä¸€ä¸ª Github å®¢æˆ·ç«¯ï¼Œè¿™æ¬¡è½®åˆ° AI + Compose
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/817692379985752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹çŒ«deå°éƒ­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T23:11:10.000Z" title="Sun Dec 21 2025 23:11:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¹‹æ‰€ä»¥ 2025 äº† GSYGithubApp è¿˜èƒ½è¿æ¥ Jetpack Compose ç‰ˆæœ¬çš„å¼€æºï¼Œä¸»è¦è¿˜æ˜¯ä¾èµ–äº AI çš„å¼ºå¤§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppCompose" target="_blank" title="https://github.com/CarGuo/GSYGithubAppCompose" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a> ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77fbbc01e86d41568b8f02745c2ede70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=HYod%2BkDbevJtqti22GAfsF89nMM%3D" alt="" loading="lazy"/></p>
<p>GSY ç³»åˆ—é¡¹ç›®åšæ—©æ˜¯ä» 2016 å¹´å¼€å§‹åšçš„å¼€æºï¼Œå…¶ä¸­å¤§å®¶æœ€ä¸ºç†Ÿæ‚‰çš„åº”è¯¥æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYVideoPlayer" target="_blank" title="https://github.com/CarGuo/GSYVideoPlayer" ref="nofollow noopener noreferrer">GSYVideoPlayer</a> ï¼Œå®ƒä¹Ÿæ˜¯ç»´æŠ¤è‡³ä»Šæœ€é•¿çš„é¡¹ç›®ï¼Œè€Œ GSYGithubApp ç³»åˆ—æœ€æ—©æ˜¯åœ¨ 2017 å¹´ 11 æœˆå¼€æºï¼Œè‡³ä»Šæ­£å¥½æ˜¯å…«å¹´ï¼Œè€Œè¿‘æ—¥è¿™ä¸ªé¡¹ç›®ä¹Ÿæ­£å¼å¼€æºäº† GSYGithubApp çš„ Jetpack Compose ç‰ˆæœ¬ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd2568bafbbc4b249059fa52989ed415~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=Axg0fzCmKSJ6I%2B5O4h5HGdorRfQ%3D" alt="" loading="lazy"/></p>
<p>GSYGithubApp è¯ç”Ÿä¹‹åˆ Github çš„å®˜æ–¹å®¢æˆ·ç«¯è¿˜æ²¡æœ‰å‡ºæ¥ï¼Œè€Œå½“æ—¶å› ä¸ºåšå¼€æºä¹Ÿæœ‰äº›æ—¶é—´ï¼Œæ‰€ä»¥åœ¨æ—¥å¸¸ä¸­æ²¡æœ‰ä¸€ä¸ªåº”ç”¨å…¶å®æŒºä¸æ–¹ä¾¿ï¼Œæ­£å¥½é‚£æ—¶å€™åˆšå­¦ React Native æ²¡å¤šä¹…ï¼Œ<strong>æ‰€ä»¥ 2017 å¹´ç¬¬ä¸€ä¸ª GSYGithubApp å°±ä½œä¸ºç»ƒæ‰‹é¡¹ç›®è¯ç”Ÿäº†</strong>ï¼Œä¹‹åé™†ç»­éšç€æ¥è§¦çš„æŠ€æœ¯æ ˆå˜åŒ–ï¼Œå¼€æºçš„ç‰ˆæœ¬ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå®ƒä»¬å¼€æºçš„é¡ºåºä¾æ¬¡æ˜¯ï¼š</p>
<ul>
<li>React Native <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubApp" target="_blank" title="https://github.com/CarGuo/GSYGithubApp" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
<li>Weex <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppWeex" target="_blank" title="https://github.com/CarGuo/GSYGithubAppWeex" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
<li>Android Kotlin View <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppKotlin" target="_blank" title="https://github.com/CarGuo/GSYGithubAppKotlin" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
<li>Flutter <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppFlutter" target="_blank" title="https://github.com/CarGuo/GSYGithubAppFlutter" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
<li>Android Jetpack Compose <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppCompose" target="_blank" title="https://github.com/CarGuo/GSYGithubAppCompose" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b75b5a15bdc24cdeb7ca8bdce93243b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=M41mBMSCRoVyuSfXSxTKZ7NXgew%3D" alt="" loading="lazy"/></p>
<p>è€Œå…¶å®éšç€ Github å®˜æ–¹çš„ App å‘å¸ƒåï¼ŒGSYGithubApp å­˜åœ¨çš„æ„ä¹‰å°±å˜äº†ï¼š<strong>å®ƒæ›´å¤šæ˜¯æˆä¸ºä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯å­¦ä¹ é¡¹ç›®ï¼Œå¹¶æä¾›åŒæ¬¾æŠ€æœ¯å¯¹æ¯”çš„ä¸€ä¸ªç›®çš„</strong>ã€‚</p>
<p>å¦å¤–è¿‡å»çš„æ—¶å€™ï¼Œé—²é±¼å°±æ›¾ç”¨è¿‡ GSYGithubApp çš„ React Native ç‰ˆæœ¬å’Œ Flutter ç‰ˆæœ¬åšè¿‡ä¸€äº›æ€§èƒ½å¯¹æ¯”æµ‹è¯•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67b39aade61b46b09b834774c7b9a219~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=we154kIzAhBEOK6vDGVDM5K5JVg%3D" alt="image-20251112111329006" loading="lazy"/></p>
<blockquote>
<p>è€Œä¹‹æ‰€ä»¥é€‰æ‹©åš Github å®¢æˆ·ç«¯ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªï¼Œè¿™èƒ½è®©å®ƒæˆä¸ºä¸€ä¸ªå®Œæ•´çš„ App å¼€æºé¡¹ç›®ï¼ŒGithub API ç›¸å¯¹ç¨³å®šå¹¶ä¸”ä¸°å¯Œï¼Œæµç¨‹ä»ç™»å½•ï¼Œç”¨æˆ·ï¼Œä»“åº“ï¼ŒIssue ï¼Œè¾“å…¥è¾“å‡ºï¼Œæ•°æ®åº“ç­‰éƒ½èƒ½è¦†ç›–ï¼Œèƒ½è®©å¼€æºé¡¹ç›®æ¶‰åŠçš„å†…å®¹æ›´å…¨é¢ã€‚</p>
</blockquote>
<p>å½“ç„¶ï¼Œä¸ªäººç»å†æœ‰é™ï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œå…¶å® GSYGithubApp åœ¨è¿‡å»æŒºé•¿çš„æ—¶é—´é‡Œï¼Œé™¤äº† Flutter ç‰ˆæœ¬å¤–ï¼Œå…¶ä»–ç‰ˆæœ¬éƒ½æ˜¯å¤„äºâ€œæ”¾ï¼ˆqiï¼‰ç”Ÿï¼ˆkengï¼‰â€çŠ¶æ€ï¼Œç›´åˆ° 2025 AI çš„èƒ½åŠ›å¤§å¹…æå‡ä¹‹åï¼Œå®ƒä»¬æ‰åˆè¿æ¥äº†æ›´æ–°ï¼š</p>
<ul>
<li>React Native ç‰ˆæœ¬ç›®å‰æ›´æ–°åˆ° 0.82 ï¼Œè¯´å®è¯å°±ç®—æ˜¯æœ‰ AI ï¼Œä» 0.61 å‡çº§åˆ° 0.82 ä¹Ÿæ˜¯ä¸€ä¸ªæŒºè®©äººâ€œç»æœ›â€çš„ä½“éªŒï¼Œè¯¦ç»†å¯è§ï¼š<a href="https://juejin.cn/post/7534367912388427815" target="_blank" title="https://juejin.cn/post/7534367912388427815">ç”¨ AI æŠŠä¸€ä¸ªäº”å¹´å‰çš„ RN é¡¹ç›®ï¼Œä» 0.61.3 å‡çº§åˆ° 0.74.0 æ˜¯ä¸€ç§ä»€ä¹ˆæ ·çš„ä½“éªŒ</a></li>
<li>Android Kotlin View ç‰ˆæœ¬ï¼Œåœ¨ AI çš„å¸®åŠ©ä¸‹ï¼Œç»ˆäºæˆåŠŸå‡çº§åˆ°å¯ä»¥åœ¨æœ€æ–° Android Studio å’Œ Gradle ç¯å¢ƒè¿è¡Œ</li>
<li>Weex ç‰ˆæœ¬ï¼Œå—¯ï¼Œè¿˜æ˜¯å¤„äºâ€œæ”¾ï¼ˆqiï¼‰ç”Ÿï¼ˆkengï¼‰â€çŠ¶æ€ï¼Œæ‡‚å¾—éƒ½æ‡‚</li>
</ul>
<p>æ‰€ä»¥åœ¨æ„Ÿå—åˆ° AI å¼ºå¤§çš„è¾…åŠ©èƒ½åŠ›åï¼Œ<strong>æˆ‘å°±è§‰å¾—ä¹Ÿè®¸å¯ä»¥å†æ¥ä¸ª Jetpack Compose ç‰ˆæœ¬çš„ GSYGithubApp é¡¹ç›®ï¼Œè€Œå®é™…ä¸Šé›¶é›¶æ•£æ•£å¼€å‘ç›´åˆ°å¼€æºï¼Œå¤§æ¦‚ä¹Ÿå°±æ˜¯ä¸¤å‘¨çš„æ—¶é—´ï¼Œå…¶ä¸­ 80% ä»¥ä¸Šéƒ½æ˜¯ AI å®Œæˆ</strong>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad66fb5b1ab949258e3cb16a767abc40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=zNQzi%2Bby%2Fap2Tmg8xszVwAwuepQ%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªé€Ÿåº¦ä¸»è¦ä¹Ÿæ˜¯å› ä¸ºéœ€æ±‚æ˜ç¡®ï¼ŒåŸå‹å·²ç»æœ‰äº†ï¼Œç»™ AI å‚è€ƒçš„èµ„æ–™å°±å¤šäº†ï¼ŒåŸºæœ¬ä¸Šä¹Ÿç®—æ˜¯ç†Ÿæ‚‰çš„é¢†åŸŸï¼Œå¤§éƒ¨åˆ†åªéœ€ç»™ AI æŠ•å–‚å¥½èµ„æ–™ï¼Œåˆå§‹ç»“æ„ç›´æ¥è®© AI å‚è€ƒå®˜æ–¹çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fandroid%2Fandroidify" target="_blank" title="https://github.com/android/androidify" ref="nofollow noopener noreferrer">android/androidify</a> é¡¹ç›®ï¼Œåˆ¶å®šå¥½è·¯çº¿å’Œæ–¹å‘ï¼Œæ•´ä½“è¿˜æ˜¯ç›¸å½“çœå¿ƒçš„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b78db26fc02409f82e3efa628092c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=Jqm0nlqvTfo6%2Bjxrlp5H2Yfw1O4%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ca37519fe274638ad3ee18c13ab9376~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=6FvbYxA6hyvIRAbb00%2BxtLaKyHQ%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿™é‡Œé¢å°±ä¸å¾—ä¸æå¼€å‘è¿‡ç¨‹ä¸­ç»™ AI æŒ‡å®š rules çš„å¿…è¦æ€§ï¼Œå› ä¸º AI å®é™…ä¸Šå¾ˆå¤šæ—¶å€™å¹¶ä¸ä¼šå…¨å±€è€ƒè™‘ä½ çš„é¡¹ç›®ç»“æ„ï¼Œæ¯æ¬¡éœ€æ±‚å¯¹ä»–æœ‰é™çš„ Context æ¥è¯´ï¼Œå¤§å¤šæ•°æ—¶å€™éƒ½åªä¼šå±€é™æ€§çš„è€ƒè™‘é—®é¢˜ï¼Œè¿™æ—¶å€™åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ ¹æ® AI çš„è°ƒæ€§é…ç½®ç›¸åº”çš„è§„åˆ™è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œä¾‹å¦‚é€šç”¨çš„æ¨¡æ¿å’Œç”Ÿæˆè§„åˆ™å°±å¾ˆæœ‰å¿…è¦ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb29035ed20145caa18b6a35cdab6c6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=zg73mz9tZP4vPIGuR4W4XKy2ZW8%3D" alt="" loading="lazy"/></p>
<p>è¿™äº›è§„åˆ™ä¸æ˜¯è¯´ä½ ä¸€å¼€å§‹å°±è¦æœ‰ï¼Œè€Œæ˜¯åœ¨ AI å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåœ¨å·²ç»æœ‰ä¸€å®šä»£ç çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è®© AI è¯»å–ç°æœ‰çš„ç»“æ„å»ç”Ÿæˆï¼Œè¿˜æœ‰å°±æ˜¯ AI çš„è„‘å›è·¯å¤§å¤šæ•°æ—¶å€™åªå’Œå®ƒè®­ç»ƒæ—¶çš„æ•°æ®ç»‘å®šï¼Œæ‰€ä»¥æœ‰äº›æ–°çš„ä¸œè¥¿ï¼Œå°±éœ€è¦ä½ æ˜è¯´ï¼Œä¸€äº›ä»–ç»å¸¸é”™çš„ä¸œè¥¿ï¼Œå°±éœ€è¦ä½ æ˜¾å¼çš„ç½—åˆ—å‡ºæ¥ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47baa453c3dd4e36b29141063b2881bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=X3xbCluucH8etdVUldCp13qGfhM%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>è¿™é‡Œå¤§éƒ¨åˆ†éƒ½æ˜¯ä½¿ç”¨ Android Studio çš„ <code>Gemini for businesses</code> å®Œæˆï¼Œéƒ¨åˆ†æ˜¯ Copilot Web Agent å’Œ Claude å®Œæˆï¼Œå¦å¤–ï¼Œæ–°ç‰ˆçš„ <a href="https://juejin.cn/post/7579999793320247302" target="_blank" title="https://juejin.cn/post/7579999793320247302">Android Studio Otter 2 Feature</a> Android Studio çš„ Agent æ¨¡å¼ä¹Ÿå¼€å§‹é…å¤‡äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fr%2Fstudio-ui%2Fgemini%2Fandroid-knowledge-base" target="_blank" title="https://developer.android.com/r/studio-ui/gemini/android-knowledge-base" ref="nofollow noopener noreferrer">Android çŸ¥è¯†åº“ </a>ï¼Œä»è€Œæ˜¾è‘—æé«˜å‡†ç¡®æ€§å¹¶å‡å°‘é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œ<strong>Agent ä¸å†ä»…ä»…ä¾èµ–äºå…¶è®­ç»ƒæ•°æ®ï¼Œè€Œæ˜¯å¯ä»¥åœ¨å›ç­”ç”¨æˆ·é—®é¢˜ä¹‹å‰ä¸»åŠ¨æŸ¥é˜…æ¥è‡ªå®˜æ–¹æ¥æºï¼ˆä¾‹å¦‚ Android å¼€å‘è€…æ–‡æ¡£ã€Firebaseã€Google Developers å’Œ Kotlin æ–‡æ¡£ï¼‰çš„æœ€æ–°æ–‡æ¡£</strong>ã€‚</p>
</blockquote>
<p>å½“ç„¶ï¼Œæœ€ç»ˆä»£ç è¿˜æ˜¯éœ€è¦äººå®¡æ ¸ï¼Œå’±ä¹Ÿä¸æ‡‚ï¼Œä¸ºä»€ä¹ˆå®ƒå¢åŠ ä¸ªå¤šè¯­è¨€çš„æ—¶å€™ï¼Œä¼šåˆ æ‰æŸä¸ªæ ‡ç­¾ï¼ŒåŠ ä¸ª <code>camera</code> åšä»€ä¹ˆï¼Ÿ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6386b29445284e308f8f8d97f4e99371~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=RWuSCm5ce5GENQgSj4KdBhZtdTg%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œï¼Œä½ è¿˜èƒ½è§åˆ°å˜´ç¡¬çš„ AI å¼€å§‹æ¨å¸è´£ä»»ï¼Œä¸å¾—ä¸è¯´ AI çš„æ‹ŸäººåŒ–è¶Šæ¥è¶ŠçœŸå®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ba10312586a4975aef68a1b5568dec0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=Y%2FbvahNofg6lNejtkeHCVtfOFs0%3D" alt="ce1f85625ff3a0afd78e8e419fd014fa" loading="lazy"/></p>
<p>è€Œå¯¹äºé¡¹ç›®çš„æ¶æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ AI æ¥å®Œæˆï¼Œä¾‹å¦‚ <code>https://deepwiki.com/</code> ï¼Œåªéœ€è¦é€šè¿‡ <code>https://deepwiki.com/CarGuo/GSYGithubAppCompose</code> ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä»½é¡¹ç›®çš„æ¶æ„æŠ¥å‘Šï¼Œå¹¶ä¸”ä½ è¿˜å¯ä»¥é€šè¿‡å®ƒç»§ç»­è¯¢é—®ç›¸å…³é—®é¢˜ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92cb0b8991e540e1ad1182c7b27fc2ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=8pSPcW3c75SjQPDhLmjqwkYcg34%3D" alt="" loading="lazy"/></p>
<p>å¦å¤–ï¼Œé€šè¿‡ AI æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”Ÿæˆå¯¹åº”çš„ç»“æ„å®ç°ï¼Œä¾‹å¦‚ä»¥ä¸‹å°±æ˜¯é€šè¿‡ Gemini ç”Ÿæˆçš„æ‰‹ç»˜å›¾ç¤ºä¾‹ï¼š</p>
<h4 data-id="heading-0">æ¶æ„å›¾</h4>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   GSYGithubAppCompose Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (Jetpack Compose + MVVM) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚
 Â  Â  Â  Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” Â  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â   â”‚  Presentation  â”‚ Â  â”‚ Â   Data Â  Â  â”‚ Â   â”‚ Â  Â   Core Â  Â   â”‚
 Â  Â  Â   â”‚ Â  Â  Layer Â  Â   â”‚ Â  â”‚ Â   Layer Â   â”‚ Â   â”‚ Â  Â  Layer Â  Â   â”‚
 Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” Â  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â   â”‚ Â  feature/* Â   â”‚ Â  â”‚ Â   data Â  Â  â”‚ Â   â”‚  core/network  â”‚
 Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  Â   â”‚ Â  â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â   â”‚  core/database â”‚
 Â  Â  Â   â”‚ - welcome Â  Â   â”‚ Â  â”‚ Repository  â”‚ Â   â”‚  core/common Â  â”‚
 Â  Â  Â   â”‚ - login Â  Â  Â   â”‚ Â  â”‚ Â  Pattern Â  â”‚ Â   â”‚  core/ui Â  Â  Â  â”‚
 Â  Â  Â   â”‚ - home Â  Â  Â  Â  â”‚ Â  â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â   â”‚ - dynamic Â  Â   â”‚ Â  â”‚ - User Â  Â   â”‚
 Â  Â  Â   â”‚ - trending Â  Â  â”‚ Â  â”‚ - Event Â  Â  â”‚
 Â  Â  Â   â”‚ - profile Â  Â   â”‚ Â  â”‚ - Repo Â  Â   â”‚
 Â  Â  Â   â”‚ - search Â  Â  Â  â”‚ Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â   â”‚ - detail Â  Â  Â  â”‚
 Â  Â  Â   â”‚ - code Â  Â  Â  Â  â”‚
 Â  Â  Â   â”‚ - issue Â  Â  Â   â”‚
 Â  Â  Â   â”‚ - push Â  Â  Â  Â  â”‚
 Â  Â  Â   â”‚ - list Â  Â  Â  Â  â”‚
 Â  Â  Â   â”‚ - notification â”‚
 Â  Â  Â   â”‚ - info Â  Â  Â  Â  â”‚
 Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-1">æ¨¡å—ä¾èµ–å…³ç³»å›¾</h4>
<pre><code class="hljs language-bash" lang="bash"> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Â  app Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚
 Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” Â  Â  Â  Â  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â  Â   â”‚  feature/*  â”‚ Â  Â  Â  Â  â”‚ Â   data Â  â”‚ Â  Â  Â  Â   â”‚ Â  core/ui Â  â”‚
 Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  Â   â”‚æ‰€æœ‰åŠŸèƒ½æ¨¡å—  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤Repository â”‚ Â  Â  Â  Â   â”‚  é€šç”¨UIç»„ä»¶  â”‚
 Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â  Â  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ Â  Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â  Â  Â  Â   â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  â”‚ Â  Â  Â   â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚core/network â”‚  â”‚core/database â”‚  â”‚core/common  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â  â”‚  â”‚ Â  Â  Â  Â  Â  Â   â”‚  â”‚ Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Retrofit Â   â”‚  â”‚ Â   Room Â  Â   â”‚  â”‚ DataStore Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Apollo Â  Â   â”‚  â”‚ Â   Entity Â   â”‚  â”‚ Â  Token Â  Â  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚ Model Â  Â  Â  â”‚  â”‚ Â   DAO Â  Â  Â  â”‚  â”‚  Resources  â”‚
 Â  Â  Â  Â  Â  Â  Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â€‹
ä¾èµ–è§„åˆ™ï¼š
  app Â  Â  Â  Â   â†’ feature/*, core/ui, data
  feature/* Â   â†’ data, core/ui, core/common
  data Â  Â  Â  Â  â†’ core/network, core/database, core/common
  core/ui Â  Â   â†’ core/common
  core/network â†’ (ç‹¬ç«‹æ¨¡å—)
  core/databaseâ†’ (ç‹¬ç«‹æ¨¡å—)
  core/common  â†’ (ç‹¬ç«‹æ¨¡å—)
</code></pre>
<h4 data-id="heading-2">æŠ€æœ¯æ¶æ„å›¾</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  æŠ€æœ¯æ ˆ (Tech Stack) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  UIå±‚ Â  Â  Â  Â  Â  Â  Â  Â   Jetpack Compose + Material <span class="hljs-number">3</span> Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Navigation Compose Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Coil (å›¾ç‰‡åŠ è½½) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  çŠ¶æ€ç®¡ç† Â  Â  Â  Â  Â  Â   StateFlow + ViewModel Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Kotlin Coroutines + <span class="hljs-attribute">Flow</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  ä¾èµ–æ³¨å…¥ Â  Â  Â  Â  Â  Â   Hilt (Dagger <span class="hljs-number">2</span>) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  ç½‘ç»œå±‚ Â  Â  Â  Â  Â  Â  Â   Retrofit <span class="hljs-number">2</span> + OkHttp Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Apollo GraphQL Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Gson / Kotlinx Serialization Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  æ•°æ®åº“å±‚ Â  Â  Â  Â  Â  Â   Room Database Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   DataStore (æ›¿ä»£ SharedPreferences) Â  Â  Â  Â  Â   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚  æ¶æ„æ¨¡å¼ Â  Â  Â  Â  Â  Â   MVVM + Repository Pattern Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Clean Architecture Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Unidirectional Data <span class="hljs-attribute">Flow</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-3">æ•°æ®æµå‘å›¾</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚
â”‚ Â  Screen Â  Â  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤  ViewModel Â  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤  Repository  â”‚
â”‚  (Compose) Â  â”‚ State  â”‚ Â  (MVVM) Â  Â  â”‚  <span class="hljs-attribute">Flow</span>  â”‚ Â  (Data) Â  Â  â”‚
â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
 Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  â”‚ User Action Â  Â  Â  Â  Â  â”‚ Business Logic Â  Â  Â   â”‚ Data Source
 Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â”‚
 Â  Â  Â  â–¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–¼ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Â  Â  Â   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚
â”‚ Â  onClick Â   â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  <span class="hljs-built_in">loadData</span>()  â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Network / Â  â”‚
â”‚ Â  onRefresh  â”‚ Event  â”‚  <span class="hljs-built_in">refresh</span>() Â  â”‚ API Â   â”‚  Database Â   â”‚
â”‚ Â  Â  Â  Â  Â  Â   â”‚ Â  Â  Â   â”‚ Â  Â  Â  Â  Â  Â   â”‚ Call Â  â”‚ Â  Â  Â  Â  Â  Â   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Â  Â  Â   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â€‹
æ•°æ®æµï¼š
<span class="hljs-number">1</span>. ç”¨æˆ·æ“ä½œè§¦å‘ UI äº‹ä»¶
<span class="hljs-number">2</span>. ViewModel å¤„ç†ä¸šåŠ¡é€»è¾‘
<span class="hljs-number">3</span>. Repository åè°ƒæ•°æ®æºï¼ˆç½‘ç»œ/æ•°æ®åº“ï¼‰
<span class="hljs-number">4</span>. æ•°æ®é€šè¿‡ <span class="hljs-attribute">Flow</span> è¿”å›åˆ° ViewModel
<span class="hljs-number">5</span>. ViewModel æ›´æ–° UiState
<span class="hljs-number">6</span>. UI è‡ªåŠ¨é‡ç»„æ˜¾ç¤ºæ–°çŠ¶æ€
</code></pre>
<h4 data-id="heading-4">åˆ†å±‚èŒè´£</h4>















































<table><thead><tr><th>å±‚çº§</th><th>æ¨¡å—</th><th>èŒè´£</th><th>ä¸»è¦æŠ€æœ¯</th></tr></thead><tbody><tr><td><strong>è¡¨ç°å±‚</strong></td><td>feature/*</td><td>UIæ¸²æŸ“ã€ç”¨æˆ·äº¤äº’ã€çŠ¶æ€å±•ç¤º</td><td>Jetpack Composeã€Navigation</td></tr><tr><td><strong>ä¸šåŠ¡å±‚</strong></td><td>data (ViewModel)</td><td>ä¸šåŠ¡é€»è¾‘ã€çŠ¶æ€ç®¡ç†ã€æ•°æ®ç¼–æ’</td><td>StateFlowã€Coroutines</td></tr><tr><td><strong>æ•°æ®å±‚</strong></td><td>data (Repository)</td><td>æ•°æ®è®¿é—®ã€ç¼“å­˜ç­–ç•¥ã€æ•°æ®æ˜ å°„</td><td>Repository Pattern</td></tr><tr><td><strong>ç½‘ç»œå±‚</strong></td><td>core/network</td><td>APIè°ƒç”¨ã€ç½‘ç»œè¯·æ±‚ã€æ•°æ®æ¨¡å‹</td><td>Retrofitã€Apolloã€OkHttp</td></tr><tr><td><strong>å­˜å‚¨å±‚</strong></td><td>core/database</td><td>æœ¬åœ°ç¼“å­˜ã€æ•°æ®æŒä¹…åŒ–</td><td>Roomã€DataStore</td></tr><tr><td><strong>åŸºç¡€å±‚</strong></td><td>core/commonã€core/ui</td><td>å…¬å…±å·¥å…·ã€UIç»„ä»¶ã€èµ„æº</td><td>å¤šè¯­è¨€ã€ä¸»é¢˜ã€å·¥å…·ç±»</td></tr></tbody></table>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAI ç¡®å®å¯ä»¥å¤§å¤§æé«˜å¼€å‘çš„æ•ˆç‡ï¼Œä¸ä»…â€œæ•‘æ´»â€äº†å·²ç»è’åºŸçš„è€é¡¹ç›®ï¼Œåœ¨æ–°é¡¹ç›®çš„è¿­ä»£ä¸Šä¹Ÿèµ·åˆ°äº†å¾ˆå¤§çš„å¸®åŠ©ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ 2025 äº†è¿˜èƒ½æœ‰ GSYGithubAppCompose çš„åŸå› ã€‚</p>
<p><strong>äº‹å®ä¸Šç°åœ¨ GSYGithubApp ç³»åˆ—é¡¹ç›®å­˜åœ¨çš„æ„ä¹‰ä¹Ÿå°±æ˜¯å­¦ä¹ å’Œå¯¹æ¯”ï¼Œè€Œ GSYGithubAppCompose çš„æ„ä¹‰ï¼Œè¿˜æç°åœ¨ AI çš„åº”ç”¨å’Œé¡¹ç›®ç»´æŠ¤ä¸Š</strong>ï¼Œå¦‚ä½•æ›´å¥½ä½¿ç”¨ AI å»ç»´æŠ¤ä¸€ä¸ªé¡¹ç›®ï¼Œè¿™å¯¹äºç¨‹åºçŒ¿æ¥è¯´ï¼Œè¿˜æ˜¯æœ‰ä¸€å®šçš„å¿…è¦çš„ï¼Œæ¯•ç«Ÿ 2025 ä½œä¸ºå¼€å‘è€…ï¼ŒçœŸçš„ç¦»ä¸å¼€ AIã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœä½ æ˜¯ Android åŸç”Ÿå¼€å‘ï¼Œè¿˜æ²¡ç”¨ä¸Š Compose ï¼Œé‚£ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppCompose" target="_blank" title="https://github.com/CarGuo/GSYGithubAppCompose" ref="nofollow noopener noreferrer">GSYGithubAppCompose</a> æˆ–è€…ä¹Ÿå€¼å¾—äº†è§£ä¸‹ï¼Ÿæ¯•ç«Ÿå¦‚æœ Compose ä¼šäº†ï¼Œçº¦ç­‰äº Compose MultiPlatform ä¹Ÿä¼šäº†ä¸æ˜¯ä¹ˆï¼Ÿå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è¯´ï¼ŒAI ä¼šå°±è¡ŒğŸ¤­ ã€‚</p>
<h2 data-id="heading-5">æœ€å</h2>
<p>æœ€åï¼Œå€Ÿç€ AI çš„é£ï¼Œæœ¬æ¬¡ä¹ŸæŠŠæ‰€æœ‰é¡¹ç›®çš„ Logo å½¢è±¡éƒ½ç»Ÿä¸€ï¼Œä»äº”ä¸ª GSYGithubApp ï¼Œåˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2Fgsy_flutter_book" target="_blank" title="https://github.com/CarGuo/gsy_flutter_book" ref="nofollow noopener noreferrer">gsy_flutter_book</a> æ–‡ç« åˆé›†é¡¹ç›®ï¼Œå†åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYVideoPlayer" target="_blank" title="https://github.com/CarGuo/GSYVideoPlayer" ref="nofollow noopener noreferrer">GSYVideoPlayer</a> æ’­æ”¾å™¨å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2Fgsy_flutter_demo" target="_blank" title="https://github.com/CarGuo/gsy_flutter_demo" ref="nofollow noopener noreferrer">gsy_flutter_demo</a> ç¤ºä¾‹é¡¹ç›®ï¼Œç°åœ¨å…¨éƒ½ç»Ÿä¸€ä½¿ç”¨è¿™ä¸ª logo ï¼Œè™½ç„¶æ²¡ä»€ä¹ˆè®¾è®¡æ„Ÿï¼Œä½†æ˜¯æˆ‘å¾ˆæ»¡æ„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fea239b15b6e41fe96308cd388debdaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=5ITSFN%2BIICm6X9yHMWfzyBnrQG4%3D" alt="" loading="lazy"/></p>
<p>å†ç»“åˆ AI ï¼Œä¸€ä¸ªçœ‹èµ·æ¥å¾ˆé¢ çš„è§†é¢‘æ•ˆæœå°±è¿™ä¹ˆå‡ºæ¥äº†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a840f4a770e473bb2f3d3fddf5164a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766963470&amp;x-signature=JIyCl1%2FoiA4mzhP5Oom8MrXC6uM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">é“¾æ¥</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2F" target="_blank" title="https://github.com/CarGuo/" ref="nofollow noopener noreferrer">github.com/CarGuo/</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCarGuo%2FGSYGithubAppCompose" target="_blank" title="https://github.com/CarGuo/GSYGithubAppCompose" ref="nofollow noopener noreferrer">github.com/CarGuo/GSYGâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ C#.NET recordï¼šä¸å¯å˜å¯¹è±¡ä¸å€¼è¯­ä¹‰çš„ç°ä»£å®è·µ]]></title>    <link>https://juejin.cn/post/7585964362565845007</link>    <guid>https://juejin.cn/post/7585964362565845007</guid>    <pubDate>2025-12-21T23:38:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585964362565845007" data-draft-id="7585850609016307727" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ C#.NET recordï¼šä¸å¯å˜å¯¹è±¡ä¸å€¼è¯­ä¹‰çš„ç°ä»£å®è·µ"/> <meta itemprop="keywords" content="C#,.NET"/> <meta itemprop="datePublished" content="2025-12-21T23:38:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”é’æ«"/> <meta itemprop="url" content="https://juejin.cn/user/3737995266234280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ C#.NET recordï¼šä¸å¯å˜å¯¹è±¡ä¸å€¼è¯­ä¹‰çš„ç°ä»£å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3737995266234280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”é’æ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T23:38:14.000Z" title="Sun Dec 21 2025 23:38:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ç®€ä»‹</h3>
<p><code>record</code> æ˜¯ <code>C# 9</code> å¼•å…¥çš„æ–°å¼•ç”¨ç±»å‹ï¼ˆ<code>Reference Type</code>ï¼‰ï¼Œä¸“é—¨ç”¨äºæ•°æ®å¯¼å‘ï¼ˆ<code>Data-Oriented</code>ï¼‰çš„ä¸å¯å˜å¯¹è±¡ã€‚ç‰¹åˆ«é€‚åˆç”¨äºè¡¨ç¤ºä¸å¯å˜çš„æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆ<code>DTO</code>ï¼‰ã€å€¼å¯¹è±¡å’Œé¢†åŸŸæ¨¡å‹ã€‚</p>
<p>âš¡ ä¸»è¦ç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>å†…ç½®å€¼ç›¸ç­‰æ€§ï¼šä¸¤ä¸ª <code>record</code> å®ä¾‹å¦‚æœå±æ€§å€¼ç›¸åŒï¼Œåˆ™è¢«è®¤ä¸ºç›¸ç­‰ï¼ˆå€¼ç›¸ç­‰ï¼‰ã€‚</p>
</li>
<li>
<p>ç®€æ´è¯­æ³•ï¼šé€šè¿‡â€œä¸»æ„é€ å‡½æ•°â€ç›´æ¥å®šä¹‰å±æ€§ã€‚</p>
</li>
<li>
<p>ä¸å¯å˜è®¾è®¡ï¼šæ¨èä½¿ç”¨ <code>init</code> è®¿é—®å™¨ï¼Œå®ç°åªè¯»å±æ€§ã€‚</p>
</li>
<li>
<p>æ¨¡å¼åŒ¹é…å‹å¥½ï¼šå¯ä»¥ç”¨ <code>with</code>ã€è§£æ„ç­‰ç®€åŒ–æ•°æ®å¤„ç†ã€‚</p>
</li>
</ul>
<h3 data-id="heading-1">åŸºæœ¬è¯­æ³•</h3>
<h4 data-id="heading-2">ç®€å•å£°æ˜</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Person</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> FirstName, <span class="hljs-built_in">string</span> LastName</span>)</span>;
</code></pre>
<ul>
<li>
<p><code>record</code> å…³é”®å­—å®šä¹‰ä¸€ä¸ªä¸å¯å˜å¼•ç”¨ç±»å‹ã€‚</p>
</li>
<li>
<p><code>(string FirstName, string LastName)</code> å®šä¹‰ä¸»æ„é€ å‡½æ•°å’Œè‡ªåŠ¨ <code>init</code> å±æ€§ã€‚</p>
</li>
</ul>
<p>ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FirstName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> LastName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> firstName, <span class="hljs-built_in">string</span> lastName</span>)</span>
        =&gt; (FirstName, LastName) = (firstName, lastName);

    <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆå€¼ç›¸ç­‰æ¯”è¾ƒã€Deconstruct æ–¹æ³•ç­‰</span>
}
</code></pre>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Smith"</span>);
Console.WriteLine(p1.FirstName); <span class="hljs-comment">// Alice</span>
</code></pre>
<h3 data-id="heading-3">ä¸å¯å˜æ€§ï¼ˆinit-onlyï¼‰</h3>
<p><code>Record</code> çš„å±æ€§é»˜è®¤æ˜¯åªè¯»çš„ï¼ˆ<code>init-only</code>ï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åªèƒ½åœ¨åˆå§‹åŒ–æ—¶è®¾ç½®</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Person</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> FirstName, <span class="hljs-built_in">string</span> LastName, <span class="hljs-built_in">int</span> Age</span>)</span>;

<span class="hljs-comment">// åˆ›å»º record å®ä¾‹</span>
<span class="hljs-keyword">var</span> person = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"John"</span>, <span class="hljs-string">"Doe"</span>, <span class="hljs-number">30</span>);

<span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹å±æ€§</span>
<span class="hljs-comment">// person.Age = 31;</span>
</code></pre>
<h3 data-id="heading-4">å€¼ç›¸ç­‰ï¼ˆValue Equalityï¼‰</h3>
<h4 data-id="heading-5">å¼•ç”¨ç±»å‹ vs å€¼ç±»å‹å¯¹æ¯”</h4>





















<table><thead><tr><th>ç±»å‹</th><th>ç›¸ç­‰æ¯”è¾ƒï¼ˆé»˜è®¤ï¼‰</th></tr></thead><tbody><tr><td><code>class</code></td><td><strong>å¼•ç”¨ç›¸ç­‰</strong>ï¼ˆReference Equalityï¼‰</td></tr><tr><td><code>struct</code></td><td>å€¼ç›¸ç­‰ï¼ˆå­—æ®µé€ä¸€æ¯”è¾ƒï¼‰</td></tr><tr><td><code>record</code></td><td><strong>å€¼ç›¸ç­‰</strong>ï¼ˆè‡ªåŠ¨ç”Ÿæˆ <code>Equals</code>/<code>==</code>ï¼‰</td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Smith"</span>);
<span class="hljs-keyword">var</span> p2 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Smith"</span>);
Console.WriteLine(p1 == p2);      <span class="hljs-comment">// True</span>
Console.WriteLine(p1.Equals(p2)); <span class="hljs-comment">// True</span>
</code></pre>
<p>å³ä½¿ <code>p1</code> å’Œ <code>p21</code> æ˜¯ä¸åŒå®ä¾‹ï¼Œåªè¦å±æ€§å€¼ç›¸åŒï¼Œå°±ç›¸ç­‰ã€‚</p>
<h3 data-id="heading-6">with è¡¨è¾¾å¼ï¼ˆéç ´åæ€§å¤åˆ¶ï¼‰</h3>
<p><code>record</code> å¯ä»¥ä½¿ç”¨ <code>with</code> è¡¨è¾¾å¼å¤åˆ¶å¹¶ä¿®æ”¹éƒ¨åˆ†å±æ€§ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> p1 = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Smith"</span>);
<span class="hljs-keyword">var</span> p2 = p1 <span class="hljs-keyword">with</span> { LastName = <span class="hljs-string">"Johnson"</span> };

Console.WriteLine(p2.FirstName); <span class="hljs-comment">// Alice</span>
Console.WriteLine(p2.LastName);  <span class="hljs-comment">// Johnson</span>
</code></pre>
<ul>
<li>
<p><code>p1</code> ä¿æŒä¸å˜ï¼Œ<code>p2</code> æ˜¯æ–°çš„å®ä¾‹ã€‚</p>
</li>
<li>
<p>è¿™æ˜¯ä¸å¯å˜å¯¹è±¡çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">è§£æ„ï¼ˆDeconstructionï¼‰</h3>
<p>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆ <code>Deconstruct</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> person = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Smith"</span>);
<span class="hljs-keyword">var</span> (first, last) = person;
Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{first}</span> <span class="hljs-subst">{last}</span>"</span>);
</code></pre>
<p>å¯ç›´æ¥ç”¨å…ƒç»„è§£æ„ã€‚</p>
<h3 data-id="heading-8">ç»§æ‰¿ä¸å¤šæ€</h3>
<p><code>record</code> æ”¯æŒç»§æ‰¿ï¼Œä¸”ä¿ç•™å€¼ç›¸ç­‰è¯­ä¹‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Person</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> Name</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Student</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> Name, <span class="hljs-built_in">int</span> Grade</span>) : <span class="hljs-title">Person</span>(<span class="hljs-params">Name</span>)</span>;

Person p = <span class="hljs-keyword">new</span> Student(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">5</span>);
Console.WriteLine(p <span class="hljs-keyword">is</span> Student); <span class="hljs-comment">// True</span>
</code></pre>
<p>è‡ªåŠ¨ç”Ÿæˆçš„ <code>Equals</code> ä¼šåŒ…å«ç±»å‹æ£€æŸ¥ï¼Œå­ç±»ä¸çˆ¶ç±»ä¸åŒç±»å‹å³ä½¿å±æ€§ç›¸åŒä¹Ÿä¸ç›¸ç­‰ã€‚</p>
<h3 data-id="heading-9">æ˜¾å¼å±æ€§å®šä¹‰</h3>
<p>å¯ä»¥ä¸ç”¨ä¸»æ„é€ å‡½æ•°ï¼Œåƒ <code>class</code> ä¸€æ ·å®šä¹‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Car</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Brand { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Model { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }
}
</code></pre>
<p>ä¸ <code>class</code> çš„å”¯ä¸€åŒºåˆ«æ˜¯è‡ªåŠ¨ç”Ÿæˆäº†å€¼ç›¸ç­‰æ¯”è¾ƒã€‚</p>
<h3 data-id="heading-10">record structï¼ˆå€¼ç±»å‹è®°å½•ï¼ŒC# 10+ï¼‰</h3>
<p><code>C# 10</code> å¼•å…¥ <code>record struct</code>ï¼Œç»“åˆäº† <code>record</code> çš„å€¼ç›¸ç­‰ å’Œ <code>struct</code> çš„å€¼ç±»å‹ç‰¹æ€§ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// Record structï¼ˆå€¼ç±»å‹ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-keyword">struct</span> <span class="hljs-title">Point</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> X, <span class="hljs-built_in">int</span> Y</span>)</span>;

<span class="hljs-comment">// ä½¿ç”¨ record struct</span>
<span class="hljs-keyword">var</span> point1 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);
<span class="hljs-keyword">var</span> point2 = <span class="hljs-keyword">new</span> Point(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);

Console.WriteLine(point1 == point2); <span class="hljs-comment">// True</span>
Console.WriteLine(point1); <span class="hljs-comment">// Point { X = 3, Y = 4 }</span>

<span class="hljs-comment">// ä¿®æ”¹ record structï¼ˆå› ä¸ºæ˜¯å€¼ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹ï¼‰</span>
point1.X = <span class="hljs-number">5</span>;
Console.WriteLine(point1); <span class="hljs-comment">// Point { X = 5, Y = 4 }</span>

<span class="hljs-comment">// åªè¯» record struct</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">record</span> <span class="hljs-keyword">struct</span> <span class="hljs-title">ImmutablePoint</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> X, <span class="hljs-built_in">int</span> Y</span>)</span>;

<span class="hljs-keyword">var</span> immutablePoint = <span class="hljs-keyword">new</span> ImmutablePoint(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);
<span class="hljs-comment">// immutablePoint.X = 5; // ç¼–è¯‘é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹åªè¯»å­—æ®µ</span>
</code></pre>
<h3 data-id="heading-11">è®°å½•çš„æˆå‘˜ç”Ÿæˆ</h3>
<p>ç¼–è¯‘å™¨ä¸º <code>record</code> è‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>
<p><code>Equals(object?)</code> å’Œ <code>GetHashCode()</code>ï¼šåŸºäºå±æ€§å€¼ã€‚</p>
</li>
<li>
<p><code>==</code> å’Œ <code>!=</code> è¿ç®—ç¬¦ã€‚</p>
</li>
<li>
<p><code>Deconstruct</code> æ–¹æ³•ã€‚</p>
</li>
<li>
<p><code>ToString()</code>ï¼šè¾“å‡ºå½¢å¦‚ <code>Person { FirstName = Alice, LastName = Smith }</code>ã€‚</p>
</li>
</ul>
<p>è¿™ä½¿å¾— <code>record</code> éå¸¸é€‚åˆä½œä¸º <code>DTO</code>ã€æŸ¥è¯¢ç»“æœã€é…ç½®æ•°æ®ã€‚</p>
<h3 data-id="heading-12">ä¸ class / struct å¯¹æ¯”</h3>






















































<table><thead><tr><th>ç‰¹æ€§</th><th><code>class</code></th><th><code>struct</code></th><th><code>record</code>ï¼ˆclassï¼‰</th><th><code>record struct</code></th></tr></thead><tbody><tr><td>ç±»å‹</td><td>å¼•ç”¨ç±»å‹</td><td>å€¼ç±»å‹</td><td>å¼•ç”¨ç±»å‹</td><td>å€¼ç±»å‹</td></tr><tr><td>ç›¸ç­‰æ€§</td><td>å¼•ç”¨ç›¸ç­‰</td><td>å€¼ç›¸ç­‰</td><td><strong>å€¼ç›¸ç­‰</strong></td><td><strong>å€¼ç›¸ç­‰</strong></td></tr><tr><td>é»˜è®¤ä¸å¯å˜</td><td>âŒï¼ˆå¯å˜ï¼‰</td><td>âŒï¼ˆå¯å˜ï¼‰</td><td>âœ…ï¼ˆæ¨è <code>init</code>ï¼‰</td><td>âœ…ï¼ˆæ¨è <code>readonly</code>ï¼‰</td></tr><tr><td>å†…å­˜åˆ†é…</td><td>å †</td><td>æ ˆ/å †</td><td>å †</td><td>æ ˆ/å †</td></tr><tr><td>ç»§æ‰¿</td><td>æ”¯æŒ</td><td>ä»…æ¥å£</td><td>æ”¯æŒ</td><td>ä»…æ¥å£</td></tr><tr><td><code>with</code> è¡¨è¾¾å¼</td><td>âŒ</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h3 data-id="heading-13">é«˜çº§ç”¨æ³•</h3>
<h4 data-id="heading-14">ä¸æ¨¡å¼åŒ¹é…</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">if</span> (person <span class="hljs-keyword">is</span> Person { FirstName: <span class="hljs-string">"Alice"</span> })
    Console.WriteLine(<span class="hljs-string">"Found Alice!"</span>);
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Shape</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Circle</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> Radius</span>) : Shape</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Rectangle</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> Width, <span class="hljs-built_in">double</span> Height</span>) : Shape</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Triangle</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> Base, <span class="hljs-built_in">double</span> Height</span>) : Shape</span>;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">double</span> <span class="hljs-title">CalculateArea</span>(<span class="hljs-params">Shape shape</span>)</span>
{
    <span class="hljs-keyword">return</span> shape <span class="hljs-keyword">switch</span>
    {
        Circle c =&gt; Math.PI * c.Radius * c.Radius,
        Rectangle r =&gt; r.Width * r.Height,
        Triangle t =&gt; <span class="hljs-number">0.5</span> * t.Base * t.Height,
        _ =&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentException(<span class="hljs-string">"Unknown shape"</span>)
    };
}

<span class="hljs-comment">// ä½¿ç”¨æ¨¡å¼åŒ¹é…</span>
<span class="hljs-keyword">var</span> circle = <span class="hljs-keyword">new</span> Circle(<span class="hljs-number">5</span>);
<span class="hljs-keyword">var</span> rectangle = <span class="hljs-keyword">new</span> Rectangle(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>);

Console.WriteLine(CalculateArea(circle)); <span class="hljs-comment">// 78.53981633974483</span>
Console.WriteLine(CalculateArea(rectangle)); <span class="hljs-comment">// 24</span>
</code></pre>
<h4 data-id="heading-15">ä½ç½®è®°å½• + è§£æ„</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">Order</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> Id, <span class="hljs-built_in">decimal</span> Price</span>)</span>;
<span class="hljs-keyword">var</span> order = <span class="hljs-keyword">new</span> Order(<span class="hljs-number">1001</span>, <span class="hljs-number">99.99</span>m);
<span class="hljs-keyword">var</span> (id, price) = order; <span class="hljs-comment">// è‡ªåŠ¨è§£æ„</span>
</code></pre>
<h3 data-id="heading-16">å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-17">DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// API å“åº” DTO</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">ApiResponse</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-built_in">bool</span> Success, <span class="hljs-built_in">string</span> Message, T Data</span>)</span>;

<span class="hljs-comment">// API è¯·æ±‚ DTO</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">CreateUserRequest</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> Username, <span class="hljs-built_in">string</span> Email, <span class="hljs-built_in">string</span> Password</span>)</span>;

<span class="hljs-comment">// ä½¿ç”¨ record DTO</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> : <span class="hljs-title">ControllerBase</span>
{
    [<span class="hljs-meta">HttpPost</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">CreateUser</span>(<span class="hljs-params">CreateUserRequest request</span>)</span>
    {
        <span class="hljs-comment">// å¤„ç†è¯·æ±‚...</span>
        <span class="hljs-keyword">var</span> response = <span class="hljs-keyword">new</span> ApiResponse&lt;User&gt;(<span class="hljs-literal">true</span>, <span class="hljs-string">"User created successfully"</span>, user);
        <span class="hljs-keyword">return</span> Ok(response);
    }
}
</code></pre>
<h4 data-id="heading-18">é…ç½®å¯¹è±¡</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åº”ç”¨ç¨‹åºé…ç½®</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">AppSettings</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> ConnectionString { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> MaxRetryAttempts { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; } = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">public</span> TimeSpan Timeout { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; } = TimeSpan.FromSeconds(<span class="hljs-number">30</span>);
    <span class="hljs-keyword">public</span> LoggingSettings Logging { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">LoggingSettings</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Level { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; } = <span class="hljs-string">"Information"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FilePath { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">init</span>; } = <span class="hljs-string">"logs/app.log"</span>;
}

<span class="hljs-comment">// ä½¿ç”¨é…ç½®</span>
<span class="hljs-keyword">var</span> settings = <span class="hljs-keyword">new</span> AppSettings
{
    ConnectionString = <span class="hljs-string">"Server=localhost;Database=MyDb"</span>,
    MaxRetryAttempts = <span class="hljs-number">5</span>,
    Logging = <span class="hljs-keyword">new</span> LoggingSettings { Level = <span class="hljs-string">"Debug"</span> }
};
</code></pre>
<h3 data-id="heading-19">é€‚ç”¨åœºæ™¯</h3>
<p>æ¨èä½¿ç”¨ <code>record</code> çš„åœºæ™¯ï¼š</p>
<ul>
<li>
<p>ä¸å¯å˜çš„æ•°æ®æ¨¡å‹ï¼š<code>DTO</code>ã€<code>API</code> å“åº”å¯¹è±¡</p>
</li>
<li>
<p>é…ç½®é¡¹ã€è®¾ç½®ç±»</p>
</li>
<li>
<p>æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼ˆ<code>EF Core</code> ä¸­å¾ˆå¸¸è§ï¼‰</p>
</li>
<li>
<p>äº‹ä»¶/æ¶ˆæ¯æ¨¡å‹ï¼ˆ<code>Event Sourcing</code>ã€<code>CQRS</code>ï¼‰</p>
</li>
</ul>
<p>ä¸æ¨èä½¿ç”¨ <code>record</code> çš„åœºæ™¯ï¼š</p>
<ul>
<li>
<p>å¯¹è±¡éœ€è¦é¢‘ç¹ä¿®æ”¹ã€‚</p>
</li>
<li>
<p>éœ€è¦ä¸¥æ ¼çš„å¼•ç”¨è¯­ä¹‰ï¼ˆä¾‹å¦‚ç¼“å­˜ä¸­çš„å”¯ä¸€å®ä¾‹ï¼‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-20">æ€§èƒ½ä¸æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p><code>record</code> æ˜¯å¼•ç”¨ç±»å‹ï¼ˆé™¤éæ˜¯ <code>record struct</code>ï¼‰ï¼Œæ‰€ä»¥åœ¨å †ä¸Šåˆ†é…ï¼Œä»æœ‰ <code>GC</code> å¼€é”€ã€‚</p>
</li>
<li>
<p>å€¼æ¯”è¾ƒå¯èƒ½ç•¥å¾®å¢åŠ  <code>Equals/GetHashCode</code> çš„è®¡ç®—æˆæœ¬ã€‚</p>
</li>
<li>
<p><code>with</code> è¡¨è¾¾å¼ä¼šåˆ›å»ºæ–°å¯¹è±¡ï¼Œä¸è¦åœ¨é«˜é¢‘åœºæ™¯é¢‘ç¹ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-21">æ€»ç»“</h3>





































<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ ¸å¿ƒç›®æ ‡</td><td><strong>ç®€åŒ–ä¸å¯å˜æ•°æ®ç±»å‹</strong>çš„å£°æ˜å’Œæ¯”è¾ƒ</td></tr><tr><td>ç±»å‹</td><td>å¼•ç”¨ç±»å‹ï¼ˆé»˜è®¤ï¼‰/å€¼ç±»å‹ï¼ˆ<code>record struct</code>ï¼‰</td></tr><tr><td>ç›¸ç­‰æ€§</td><td>è‡ªåŠ¨å®ç°<strong>åŸºäºå€¼çš„ç›¸ç­‰æ€§</strong>ï¼ˆ<code>Equals</code>ã€<code>==</code>ï¼‰</td></tr><tr><td>ä¸å¯å˜æ€§</td><td>æ¨èä½¿ç”¨ <code>init</code> æˆ– <code>readonly</code></td></tr><tr><td>å¤åˆ¶</td><td><code>with</code> è¡¨è¾¾å¼å®ç°éç ´åæ€§å¤åˆ¶</td></tr><tr><td>è§£æ„</td><td>è‡ªåŠ¨ç”Ÿæˆ <code>Deconstruct</code>ï¼Œæ”¯æŒå…ƒç»„è§£æ„</td></tr><tr><td>å…¸å‹åº”ç”¨</td><td>DTOã€API æ•°æ®æ¨¡å‹ã€é…ç½®å¯¹è±¡ã€äº‹ä»¶/æ¶ˆæ¯å¯¹è±¡</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡è®²æ¸…æ¥šå›¾è®ºç›¸å…³ç®—æ³•]]></title>    <link>https://juejin.cn/post/7585743487259672585</link>    <guid>https://juejin.cn/post/7585743487259672585</guid>    <pubDate>2025-12-21T23:53:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487259672585" data-draft-id="7585452404113473551" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" ä¸€æ–‡è®²æ¸…æ¥šå›¾è®ºç›¸å…³ç®—æ³•"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T23:53:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             ä¸€æ–‡è®²æ¸…æ¥šå›¾è®ºç›¸å…³ç®—æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T23:53:39.000Z" title="Sun Dec 21 2025 23:53:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»30åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å»ºå›¾å‡½æ•°</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt;[] buildGraph(<span class="hljs-type">int</span> numCourses, <span class="hljs-type">int</span>[][] prerequisites) {
    <span class="hljs-comment">// å›¾ä¸­å…±æœ‰ numCourses ä¸ªèŠ‚ç‚¹</span>
    List&lt;Integer&gt;[] graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>[numCourses];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        graph[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    }
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : prerequisites) {
        <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>], to = edge[<span class="hljs-number">0</span>];
        <span class="hljs-comment">// æ·»åŠ ä¸€æ¡ä» from æŒ‡å‘ to çš„æœ‰å‘è¾¹</span>
        <span class="hljs-comment">// è¾¹çš„æ–¹å‘æ˜¯ã€Œè¢«ä¾èµ–ã€å…³ç³»ï¼Œå³ä¿®å®Œè¯¾ç¨‹ from æ‰èƒ½ä¿®è¯¾ç¨‹ to</span>
        graph[from].add(to);
    }
    <span class="hljs-keyword">return</span> graph;
}
</code></pre>
<h2 data-id="heading-0">ç¯æ£€æµ‹ç®—æ³•</h2>
<h3 data-id="heading-1">DFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ä¸€æ¬¡é€’å½’å †æ ˆä¸­çš„èŠ‚ç‚¹</span>
<span class="hljs-type">boolean</span>[] onPath;
<span class="hljs-comment">// è®°å½•éå†è¿‡çš„èŠ‚ç‚¹ï¼Œé˜²æ­¢èµ°å›å¤´è·¯</span>
<span class="hljs-type">boolean</span>[] visited;
<span class="hljs-comment">// è®°å½•å›¾ä¸­æ˜¯å¦æœ‰ç¯</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">hasCycle</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-type">boolean</span> <span class="hljs-title function_">canFinish</span><span class="hljs-params">(<span class="hljs-type">int</span> numCourses, <span class="hljs-type">int</span>[][] prerequisites)</span> {
    List&lt;Integer&gt;[] graph = buildGraph(numCourses, prerequisites);

    visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[numCourses];
    onPath = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[numCourses];

    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        <span class="hljs-comment">// éå†å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹</span>
        traverse(graph, i);
    }
    <span class="hljs-comment">// åªè¦æ²¡æœ‰å¾ªç¯ä¾èµ–å¯ä»¥å®Œæˆæ‰€æœ‰è¯¾ç¨‹</span>
    <span class="hljs-keyword">return</span> !hasCycle;
}

<span class="hljs-keyword">void</span> <span class="hljs-title function_">traverse</span><span class="hljs-params">(List&lt;Integer&gt;[] graph, <span class="hljs-type">int</span> s)</span> {
    <span class="hljs-keyword">if</span> (onPath[s]) {
        <span class="hljs-comment">// å‡ºç°ç¯</span>
        hasCycle = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">if</span> (visited[s] || hasCycle) {
        <span class="hljs-comment">// å¦‚æœå·²ç»æ‰¾åˆ°äº†ç¯ï¼Œä¹Ÿä¸ç”¨å†éå†äº†</span>
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰åºä»£ç ä½ç½®</span>
    visited[s] = <span class="hljs-literal">true</span>;
    onPath[s] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> t : graph[s]) {
        traverse(graph, t);
    }
    <span class="hljs-comment">// ååºä»£ç ä½ç½®</span>
    onPath[s] = <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-2">BFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸»å‡½æ•°</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canFinish</span><span class="hljs-params">(<span class="hljs-type">int</span> numCourses, <span class="hljs-type">int</span>[][] prerequisites)</span> {
    <span class="hljs-comment">// å»ºå›¾ï¼Œæœ‰å‘è¾¹ä»£è¡¨ã€Œè¢«ä¾èµ–ã€å…³ç³»</span>
    List&lt;Integer&gt;[] graph = buildGraph(numCourses, prerequisites);
    <span class="hljs-comment">// æ„å»ºå…¥åº¦æ•°ç»„</span>
    <span class="hljs-type">int</span>[] indgree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[numCourses];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : prerequisites) {
        <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>], to = edge[<span class="hljs-number">0</span>];
        <span class="hljs-comment">// èŠ‚ç‚¹ to çš„å…¥åº¦åŠ ä¸€</span>
        indgree[to]++;
    }

    <span class="hljs-comment">// æ ¹æ®å…¥åº¦åˆå§‹åŒ–é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹</span>
    Queue&lt;Integer&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        <span class="hljs-keyword">if</span> (indgree[i] == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// èŠ‚ç‚¹ i æ²¡æœ‰å…¥åº¦ï¼Œå³æ²¡æœ‰ä¾èµ–çš„èŠ‚ç‚¹</span>
            <span class="hljs-comment">// å¯ä»¥ä½œä¸ºæ‹“æ‰‘æ’åºçš„èµ·ç‚¹ï¼ŒåŠ å…¥é˜Ÿåˆ—</span>
            q.offer(i);
        }
    }

    <span class="hljs-comment">// è®°å½•éå†çš„èŠ‚ç‚¹ä¸ªæ•°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-comment">// å¼€å§‹æ‰§è¡Œ BFS å¾ªç¯</span>
    <span class="hljs-keyword">while</span> (!q.isEmpty()) {
        <span class="hljs-comment">// å¼¹å‡ºèŠ‚ç‚¹ curï¼Œå¹¶å°†å®ƒæŒ‡å‘çš„èŠ‚ç‚¹çš„å…¥åº¦å‡ä¸€</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> q.poll();
        count++;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> next : graph[cur]) {
            indgree[next]--;
            <span class="hljs-keyword">if</span> (indgree[next] == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// å¦‚æœå…¥åº¦å˜ä¸º 0ï¼Œè¯´æ˜ next ä¾èµ–çš„èŠ‚ç‚¹éƒ½å·²è¢«éå†</span>
                q.offer(next);
            }
        }
    }

    <span class="hljs-comment">// å¦‚æœæ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«éå†è¿‡ï¼Œè¯´æ˜ä¸æˆç¯</span>
    <span class="hljs-keyword">return</span> count == numCourses;
}
</code></pre>
<p>è¿™æ®µ BFS ç®—æ³•çš„æ€è·¯ï¼š</p>
<p>1ã€æ„å»ºé‚»æ¥è¡¨ï¼Œå’Œä¹‹å‰ä¸€æ ·ï¼Œè¾¹çš„æ–¹å‘è¡¨ç¤ºã€Œè¢«ä¾èµ–ã€å…³ç³»ã€‚</p>
<p>2ã€æ„å»ºä¸€ä¸ª <code>indegree</code> æ•°ç»„è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ï¼Œå³ <code>indegree[i]</code> è®°å½•èŠ‚ç‚¹ <code>i</code> çš„å…¥åº¦ã€‚</p>
<p>3ã€å¯¹ BFS é˜Ÿåˆ—è¿›è¡Œåˆå§‹åŒ–ï¼Œå°†å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹é¦–å…ˆè£…å…¥é˜Ÿåˆ—ã€‚</p>
<p><strong>4ã€å¼€å§‹æ‰§è¡Œ BFS å¾ªç¯ï¼Œä¸æ–­å¼¹å‡ºé˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ï¼Œå‡å°‘ç›¸é‚»èŠ‚ç‚¹çš„å…¥åº¦ï¼Œå¹¶å°†å…¥åº¦å˜ä¸º 0 çš„èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—</strong>ã€‚</p>
<p><strong>5ã€å¦‚æœæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«éå†è¿‡ï¼ˆ<code>count</code> ç­‰äºèŠ‚ç‚¹æ•°ï¼‰ï¼Œåˆ™è¯´æ˜ä¸å­˜åœ¨ç¯ï¼Œåä¹‹åˆ™è¯´æ˜å­˜åœ¨ç¯</strong>ã€‚</p>
<h2 data-id="heading-3">æ‹“æ‰‘æ’åºç®—æ³•</h2>
<p>å¯¹ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(Directed Acyclic Graphç®€ç§°DAG)Gè¿›è¡Œæ‹“æ‰‘æ’åºï¼Œæ˜¯å°†Gä¸­æ‰€æœ‰é¡¶ç‚¹æ’æˆä¸€ä¸ªçº¿æ€§åºåˆ—ï¼Œä½¿å¾—å›¾ä¸­ä»»æ„ä¸€å¯¹é¡¶ç‚¹uå’Œvï¼Œè‹¥è¾¹(u,v)âˆˆE(G)ï¼Œåˆ™uåœ¨çº¿æ€§åºåˆ—ä¸­å‡ºç°åœ¨vä¹‹å‰ã€‚é€šå¸¸ï¼Œè¿™æ ·çš„çº¿æ€§åºåˆ—ç§°ä¸ºæ»¡è¶³æ‹“æ‰‘æ¬¡åº(Topological Order)çš„åºåˆ—ï¼Œç®€ç§°æ‹“æ‰‘åºåˆ—ã€‚ç®€å•çš„è¯´ï¼Œç”±æŸä¸ªé›†åˆä¸Šçš„ä¸€ä¸ªååºå¾—åˆ°è¯¥é›†åˆä¸Šçš„ä¸€ä¸ªå…¨åºï¼Œè¿™ä¸ªæ“ä½œç§°ä¹‹ä¸ºæ‹“æ‰‘æ’åºã€‚</p>
<h3 data-id="heading-4">DFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ååºéå†ç»“æœ</span>
List&lt;Integer&gt; postorder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
<span class="hljs-comment">// è®°å½•æ˜¯å¦å­˜åœ¨ç¯</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">hasCycle</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
<span class="hljs-type">boolean</span>[] visited, onPath;

<span class="hljs-comment">// ä¸»å‡½æ•°</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] findOrder(<span class="hljs-type">int</span> numCourses, <span class="hljs-type">int</span>[][] prerequisites) {
    List&lt;Integer&gt;[] graph = buildGraph(numCourses, prerequisites);
    visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[numCourses];
    onPath = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[numCourses];
    <span class="hljs-comment">// éå†å›¾</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        traverse(graph, i);
    }
    <span class="hljs-comment">// æœ‰ç¯å›¾æ— æ³•è¿›è¡Œæ‹“æ‰‘æ’åº</span>
    <span class="hljs-keyword">if</span> (hasCycle) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]{};
    }
    <span class="hljs-comment">// é€†ååºéå†ç»“æœå³ä¸ºæ‹“æ‰‘æ’åºç»“æœ</span>
    Collections.reverse(postorder);
    <span class="hljs-type">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[numCourses];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        res[i] = postorder.get(i);
    }
    <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// å›¾éå†å‡½æ•°</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">traverse</span><span class="hljs-params">(List&lt;Integer&gt;[] graph, <span class="hljs-type">int</span> s)</span> {
    <span class="hljs-keyword">if</span> (onPath[s]) {
        <span class="hljs-comment">// å‘ç°ç¯</span>
        hasCycle = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">if</span> (visited[s] || hasCycle) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰åºéå†ä½ç½®</span>
    onPath[s] = <span class="hljs-literal">true</span>;
    visited[s] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> t : graph[s]) {
        traverse(graph, t);
    }
    <span class="hljs-comment">// ååºéå†ä½ç½®</span>
    postorder.add(s);
    onPath[s] = <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-5">BFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸»å‡½æ•°</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] findOrder(<span class="hljs-type">int</span> numCourses, <span class="hljs-type">int</span>[][] prerequisites) {
    <span class="hljs-comment">// å»ºå›¾ï¼Œå’Œç¯æ£€æµ‹ç®—æ³•ç›¸åŒ</span>
    List&lt;Integer&gt;[] graph = buildGraph(numCourses, prerequisites);
    <span class="hljs-comment">// è®¡ç®—å…¥åº¦ï¼Œå’Œç¯æ£€æµ‹ç®—æ³•ç›¸åŒ</span>
    <span class="hljs-type">int</span>[] indgree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[numCourses];
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : prerequisites) {
        <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>], to = edge[<span class="hljs-number">0</span>];
        indgree[to]++;
    }

    <span class="hljs-comment">// æ ¹æ®å…¥åº¦åˆå§‹åŒ–é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ï¼Œå’Œç¯æ£€æµ‹ç®—æ³•ç›¸åŒ</span>
    Queue&lt;Integer&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numCourses; i++) {
        <span class="hljs-keyword">if</span> (indgree[i] == <span class="hljs-number">0</span>) {
            q.offer(i);
        }
    }

    <span class="hljs-comment">// è®°å½•æ‹“æ‰‘æ’åºç»“æœ</span>
    <span class="hljs-type">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[numCourses];
    <span class="hljs-comment">// è®°å½•éå†èŠ‚ç‚¹çš„é¡ºåºï¼ˆç´¢å¼•ï¼‰</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-comment">// å¼€å§‹æ‰§è¡Œ BFS ç®—æ³•</span>
    <span class="hljs-keyword">while</span> (!q.isEmpty()) {
        <span class="hljs-type">int</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> q.poll();
        <span class="hljs-comment">// å¼¹å‡ºèŠ‚ç‚¹çš„é¡ºåºå³ä¸ºæ‹“æ‰‘æ’åºç»“æœ</span>
        res[count] = cur;
        count++;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> next : graph[cur]) {
            indgree[next]--;
            <span class="hljs-keyword">if</span> (indgree[next] == <span class="hljs-number">0</span>) {
                q.offer(next);
            }
        }
    }

    <span class="hljs-keyword">if</span> (count != numCourses) {
        <span class="hljs-comment">// å­˜åœ¨ç¯ï¼Œæ‹“æ‰‘æ’åºä¸å­˜åœ¨</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]{};
    }

    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h2 data-id="heading-6">äºŒåˆ†å›¾åˆ¤å®šç®—æ³•</h2>
<p>äºŒåˆ†å›¾çš„é¡¶ç‚¹é›†å¯åˆ†å‰²ä¸ºä¸¤ä¸ªäº’ä¸ç›¸äº¤çš„å­é›†ï¼Œå›¾ä¸­æ¯æ¡è¾¹ä¾é™„çš„ä¸¤ä¸ªé¡¶ç‚¹éƒ½åˆ†å±äºè¿™ä¸¤ä¸ªå­é›†ï¼Œä¸”ä¸¤ä¸ªå­é›†å†…çš„é¡¶ç‚¹ä¸ç›¸é‚»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f66a4304e714bfc9535cfa7b0a49533~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766966018&amp;x-signature=BIZ5O43ktnx%2BpZohtgtxKSGTX58%3D" alt="" loading="lazy"/></p>
<p><strong>ç»™ä½ ä¸€å¹…ã€Œå›¾ã€ï¼Œè¯·ä½ ç”¨ä¸¤ç§é¢œè‰²å°†å›¾ä¸­çš„æ‰€æœ‰é¡¶ç‚¹ç€è‰²ï¼Œä¸”ä½¿å¾—ä»»æ„ä¸€æ¡è¾¹çš„ä¸¤ä¸ªç«¯ç‚¹çš„é¢œè‰²éƒ½ä¸ç›¸åŒï¼Œä½ èƒ½åšåˆ°å—</strong>ï¼Ÿ</p>
<p>è¿™å°±æ˜¯å›¾çš„ã€ŒåŒè‰²é—®é¢˜ã€ï¼Œå…¶å®è¿™ä¸ªé—®é¢˜å°±ç­‰åŒäºäºŒåˆ†å›¾çš„åˆ¤å®šé—®é¢˜ï¼Œå¦‚æœä½ èƒ½å¤ŸæˆåŠŸåœ°å°†å›¾æŸ“è‰²ï¼Œé‚£ä¹ˆè¿™å¹…å›¾å°±æ˜¯ä¸€å¹…äºŒåˆ†å›¾ï¼Œåä¹‹åˆ™ä¸æ˜¯</p>
<h3 data-id="heading-7">DFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•å›¾æ˜¯å¦ç¬¦åˆäºŒåˆ†å›¾æ€§è´¨</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">ok</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
<span class="hljs-comment">// è®°å½•å›¾ä¸­èŠ‚ç‚¹çš„é¢œè‰²ï¼Œfalse å’Œ true ä»£è¡¨ä¸¤ç§ä¸åŒé¢œè‰²</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span>[] color;
<span class="hljs-comment">// è®°å½•å›¾ä¸­èŠ‚ç‚¹æ˜¯å¦è¢«è®¿é—®è¿‡</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span>[] visited;

<span class="hljs-comment">// ä¸»å‡½æ•°ï¼Œè¾“å…¥é‚»æ¥è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯äºŒåˆ†å›¾</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBipartite</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> graph.length;
    color =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];
    visited =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];
    <span class="hljs-comment">// å› ä¸ºå›¾ä¸ä¸€å®šæ˜¯è”é€šçš„ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªå­å›¾</span>
    <span class="hljs-comment">// æ‰€ä»¥è¦æŠŠæ¯ä¸ªèŠ‚ç‚¹éƒ½ä½œä¸ºèµ·ç‚¹è¿›è¡Œä¸€æ¬¡éå†</span>
    <span class="hljs-comment">// å¦‚æœå‘ç°ä»»ä½•ä¸€ä¸ªå­å›¾ä¸æ˜¯äºŒåˆ†å›¾ï¼Œæ•´å¹…å›¾éƒ½ä¸ç®—äºŒåˆ†å›¾</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; v &lt; n; v++) {
        <span class="hljs-keyword">if</span> (!visited[v]) {
            traverse(graph, v);
        }
    }
    <span class="hljs-keyword">return</span> ok;
}

<span class="hljs-comment">// DFS éå†æ¡†æ¶</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">traverse</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> v)</span> {
    <span class="hljs-comment">// å¦‚æœå·²ç»ç¡®å®šä¸æ˜¯äºŒåˆ†å›¾äº†ï¼Œå°±ä¸ç”¨æµªè´¹æ—¶é—´å†é€’å½’éå†äº†</span>
    <span class="hljs-keyword">if</span> (!ok) <span class="hljs-keyword">return</span>;

    visited[v] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> w : graph[v]) {
        <span class="hljs-keyword">if</span> (!visited[w]) {
            <span class="hljs-comment">// ç›¸é‚»èŠ‚ç‚¹ w æ²¡æœ‰è¢«è®¿é—®è¿‡</span>
            <span class="hljs-comment">// é‚£ä¹ˆåº”è¯¥ç»™èŠ‚ç‚¹ w æ¶‚ä¸Šå’ŒèŠ‚ç‚¹ v ä¸åŒçš„é¢œè‰²</span>
            color[w] = !color[v];
            <span class="hljs-comment">// ç»§ç»­éå† w</span>
            traverse(graph, w);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç›¸é‚»èŠ‚ç‚¹ w å·²ç»è¢«è®¿é—®è¿‡</span>
            <span class="hljs-comment">// æ ¹æ® v å’Œ w çš„é¢œè‰²åˆ¤æ–­æ˜¯å¦æ˜¯äºŒåˆ†å›¾</span>
            <span class="hljs-keyword">if</span> (color[w] == color[v]) {
                <span class="hljs-comment">// è‹¥ç›¸åŒï¼Œåˆ™æ­¤å›¾ä¸æ˜¯äºŒåˆ†å›¾</span>
                ok = <span class="hljs-literal">false</span>;
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-8">BFS</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•å›¾æ˜¯å¦ç¬¦åˆäºŒåˆ†å›¾æ€§è´¨</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">ok</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
<span class="hljs-comment">// è®°å½•å›¾ä¸­èŠ‚ç‚¹çš„é¢œè‰²ï¼Œfalse å’Œ true ä»£è¡¨ä¸¤ç§ä¸åŒé¢œè‰²</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span>[] color;
<span class="hljs-comment">// è®°å½•å›¾ä¸­èŠ‚ç‚¹æ˜¯å¦è¢«è®¿é—®è¿‡</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span>[] visited;

<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBipartite</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> graph.length;
    color =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];
    visited =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; v &lt; n; v++) {
        <span class="hljs-keyword">if</span> (!visited[v]) {
            <span class="hljs-comment">// æ”¹ä¸ºä½¿ç”¨ BFS å‡½æ•°</span>
            bfs(graph, v);
        }
    }
    
    <span class="hljs-keyword">return</span> ok;
}

<span class="hljs-comment">// ä» start èŠ‚ç‚¹å¼€å§‹è¿›è¡Œ BFS éå†</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bfs</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> start)</span> {
    Queue&lt;Integer&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    visited[start] = <span class="hljs-literal">true</span>;
    q.offer(start);
    
    <span class="hljs-keyword">while</span> (!q.isEmpty() &amp;&amp; ok) {
        <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> q.poll();
        <span class="hljs-comment">// ä»èŠ‚ç‚¹ v å‘æ‰€æœ‰ç›¸é‚»èŠ‚ç‚¹æ‰©æ•£</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> w : graph[v]) {
            <span class="hljs-keyword">if</span> (!visited[w]) {
                <span class="hljs-comment">// ç›¸é‚»èŠ‚ç‚¹ w æ²¡æœ‰è¢«è®¿é—®è¿‡</span>
                <span class="hljs-comment">// é‚£ä¹ˆåº”è¯¥ç»™èŠ‚ç‚¹ w æ¶‚ä¸Šå’ŒèŠ‚ç‚¹ v ä¸åŒçš„é¢œè‰²</span>
                color[w] = !color[v];
                <span class="hljs-comment">// æ ‡è®° w èŠ‚ç‚¹ï¼Œå¹¶æ”¾å…¥é˜Ÿåˆ—</span>
                visited[w] = <span class="hljs-literal">true</span>;
                q.offer(w);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// ç›¸é‚»èŠ‚ç‚¹ w å·²ç»è¢«è®¿é—®è¿‡</span>
                <span class="hljs-comment">// æ ¹æ® v å’Œ w çš„é¢œè‰²åˆ¤æ–­æ˜¯å¦æ˜¯äºŒåˆ†å›¾</span>
                <span class="hljs-keyword">if</span> (color[w] == color[v]) {
                    <span class="hljs-comment">// è‹¥ç›¸åŒï¼Œåˆ™æ­¤å›¾ä¸æ˜¯äºŒåˆ†å›¾</span>
                    ok = <span class="hljs-literal">false</span>;
                }
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-9">Union-Findå¹¶æŸ¥é›†</h2>
<p>å¤§ç™½è¯å°±æ˜¯å½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦åœ¨åŒä¸€ä¸ªé›†åˆé‡Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¦æƒ³åˆ°ç”¨å¹¶æŸ¥é›†ã€‚</p>
<p>å¹¶æŸ¥é›†ä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>å°†ä¸¤ä¸ªå…ƒç´ æ·»åŠ åˆ°ä¸€ä¸ªé›†åˆä¸­ã€‚</li>
<li>åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ åœ¨ä¸åœ¨åŒä¸€ä¸ªé›†åˆ</li>
</ul>
<p>åç§°"å¹¶æŸ¥é›†"ç›´æ¥ä½“ç°äº†å®ƒçš„æ ¸å¿ƒåŠŸèƒ½ï¼šåˆå¹¶é›†åˆä¸æŸ¥è¯¢å…ƒç´ æ‰€å±é›†åˆã€‚åœ¨è‹±æ–‡ä¸­ï¼Œå®ƒé€šå¸¸è¢«ç§°ä¸º"Union-Find"æ•°æ®ç»“æ„æˆ–"Disjoint-Set"æ•°æ®ç»“æ„ã€‚</p>
<p>å¹¶æŸ¥é›†çš„åŸºæœ¬æ€æƒ³æ˜¯ä½¿ç”¨æ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºæ¯ä¸ªé›†åˆï¼Œæ ‘çš„æ ¹èŠ‚ç‚¹ä½œä¸ºé›†åˆçš„ä»£è¡¨å…ƒç´ ã€‚</p>
<p>å¹¶æŸ¥é›†æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>å¿«é€ŸæŸ¥æ‰¾ï¼šèƒ½å¤Ÿå¿«é€Ÿåˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å±äºåŒä¸€é›†åˆ</li>
<li>å¿«é€Ÿåˆå¹¶ï¼šèƒ½å¤Ÿå¿«é€Ÿå°†ä¸¤ä¸ªé›†åˆåˆå¹¶ä¸ºä¸€ä¸ª</li>
<li>è·¯å¾„å‹ç¼©ï¼šä¼˜åŒ–æŸ¥æ‰¾æ“ä½œï¼Œä½¿æ ‘çš„é«˜åº¦å°½é‡å°</li>
<li>æŒ‰ç§©åˆå¹¶ï¼šä¼˜åŒ–åˆå¹¶æ“ä½œï¼Œå‡å°‘æ ‘çš„é«˜åº¦å¢é•¿</li>
</ol>
<p>Union-Find ç®—æ³•ä¸»è¦éœ€è¦å®ç°è¿™ä¸¤ä¸ª APIï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UF</span> {
    <span class="hljs-comment">/* å°† p å’Œ q è¿æ¥ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span>;
    <span class="hljs-comment">/* åˆ¤æ–­ p å’Œ q æ˜¯å¦è¿é€š */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">connected</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span>;
    <span class="hljs-comment">/* è¿”å›å›¾ä¸­æœ‰å¤šå°‘ä¸ªè¿é€šåˆ†é‡ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">count</span><span class="hljs-params">()</span>;
}
</code></pre>
<p>è¿™é‡Œæ‰€è¯´çš„ã€Œè¿é€šã€æ˜¯ä¸€ç§ç­‰ä»·å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´å…·æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ€§è´¨ï¼š</p>
<p>1ã€è‡ªåæ€§ï¼šèŠ‚ç‚¹<code>p</code>å’Œ<code>p</code>æ˜¯è¿é€šçš„ã€‚</p>
<p>2ã€å¯¹ç§°æ€§ï¼šå¦‚æœèŠ‚ç‚¹<code>p</code>å’Œ<code>q</code>è¿é€šï¼Œé‚£ä¹ˆ<code>q</code>å’Œ<code>p</code>ä¹Ÿè¿é€šã€‚</p>
<p>3ã€ä¼ é€’æ€§ï¼šå¦‚æœèŠ‚ç‚¹<code>p</code>å’Œ<code>q</code>è¿é€šï¼Œ<code>q</code>å’Œ<code>r</code>è¿é€šï¼Œé‚£ä¹ˆ<code>p</code>å’Œ<code>r</code>ä¹Ÿè¿é€šã€‚</p>
<p>æ¯”å¦‚è¯´æœ‰ä¸€å¹…å›¾ï¼Œ0ï½9 ä»»æ„ä¸¤ä¸ª<strong>ä¸åŒ</strong>çš„ç‚¹éƒ½ä¸è¿é€šï¼Œè°ƒç”¨<code>connected</code>éƒ½ä¼šè¿”å› falseï¼Œè¿é€šåˆ†é‡ä¸º 10 ä¸ªã€‚</p>
<p>å¦‚æœç°åœ¨è°ƒç”¨<code>union(0, 1)</code>ï¼Œé‚£ä¹ˆ 0 å’Œ 1 è¢«è¿é€šï¼Œè¿é€šåˆ†é‡é™ä¸º 9 ä¸ªã€‚</p>
<p>å†è°ƒç”¨<code>union(1, 2)</code>ï¼Œè¿™æ—¶ 0,1,2 éƒ½è¢«è¿é€šï¼Œè°ƒç”¨<code>connected(0, 2)</code>ä¹Ÿä¼šè¿”å› trueï¼Œè¿é€šåˆ†é‡å˜ä¸º 8 ä¸ªã€‚</p>
<h3 data-id="heading-10">åŸºç¡€ç®—æ³•</h3>
<p>è®¾å®šæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶çˆ¶èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯æ ¹èŠ‚ç‚¹çš„è¯ï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘è‡ªå·±ã€‚æ¯”å¦‚è¯´åˆšæ‰é‚£å¹… 10 ä¸ªèŠ‚ç‚¹çš„å›¾ï¼Œä¸€å¼€å§‹çš„æ—¶å€™æ²¡æœ‰ç›¸äº’è¿é€šï¼Œå°±æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UF</span> {
    <span class="hljs-comment">// è®°å½•è¿é€šåˆ†é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> count;
    <span class="hljs-comment">// èŠ‚ç‚¹ x çš„èŠ‚ç‚¹æ˜¯ parent[x]</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] parent;

    <span class="hljs-comment">/* æ„é€ å‡½æ•°ï¼Œn ä¸ºå›¾çš„èŠ‚ç‚¹æ€»æ•° */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UF</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-comment">// ä¸€å¼€å§‹äº’ä¸è¿é€š</span>
        <span class="hljs-built_in">this</span>.count = n;
        <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹æŒ‡é’ˆåˆå§‹æŒ‡å‘è‡ªå·±</span>
        parent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)
            parent[i] = i;
    }

    <span class="hljs-comment">/* å…¶ä»–å‡½æ•° */</span>
}
</code></pre>
<p><strong>å¦‚æœæŸä¸¤ä¸ªèŠ‚ç‚¹è¢«è¿é€šï¼Œåˆ™è®©å…¶ä¸­çš„ï¼ˆä»»æ„ï¼‰ä¸€ä¸ªèŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹æ¥åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹ä¸Š</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
    <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);
    <span class="hljs-keyword">if</span> (rootP == rootQ)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µ</span>
    parent[rootP] = rootQ;
    <span class="hljs-comment">// parent[rootQ] = rootP ä¹Ÿä¸€æ ·</span>
    count--; <span class="hljs-comment">// ä¸¤ä¸ªåˆ†é‡åˆäºŒä¸ºä¸€</span>
}

<span class="hljs-comment">/* è¿”å›æŸä¸ªèŠ‚ç‚¹ x çš„æ ¹èŠ‚ç‚¹ */</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-comment">// æ ¹èŠ‚ç‚¹çš„ parent[x] == x</span>
    <span class="hljs-keyword">while</span> (parent[x] != x)
        x = parent[x];
    <span class="hljs-keyword">return</span> x;
}

<span class="hljs-comment">/* è¿”å›å½“å‰çš„è¿é€šåˆ†é‡ä¸ªæ•° */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">count</span><span class="hljs-params">()</span> { 
    <span class="hljs-keyword">return</span> count;
}
</code></pre>
<p><strong>è¿™æ ·ï¼Œå¦‚æœèŠ‚ç‚¹<code>p</code>å’Œ<code>q</code>è¿é€šçš„è¯ï¼Œå®ƒä»¬ä¸€å®šæ‹¥æœ‰ç›¸åŒçš„æ ¹èŠ‚ç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">connected</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
    <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);
    <span class="hljs-keyword">return</span> rootP == rootQ;
}
</code></pre>
<p>è‡³æ­¤ï¼ŒUnion-Find ç®—æ³•å°±åŸºæœ¬å®Œæˆäº†ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸ªç®—æ³•çš„å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œä¸»è¦ API<code>connected</code>å’Œ<code>union</code>ä¸­çš„å¤æ‚åº¦éƒ½æ˜¯<code>find</code>å‡½æ•°é€ æˆçš„ï¼Œæ‰€ä»¥è¯´å®ƒä»¬çš„å¤æ‚åº¦å’Œ<code>find</code>ä¸€æ ·ã€‚</p>
<p><code>find</code>ä¸»è¦åŠŸèƒ½å°±æ˜¯ä»æŸä¸ªèŠ‚ç‚¹å‘ä¸Šéå†åˆ°æ ‘æ ¹ï¼Œå…¶æ—¶é—´å¤æ‚åº¦å°±æ˜¯æ ‘çš„é«˜åº¦ã€‚æˆ‘ä»¬å¯èƒ½ä¹ æƒ¯æ€§åœ°è®¤ä¸ºæ ‘çš„é«˜åº¦å°±æ˜¯<code>logN</code>ï¼Œä½†è¿™å¹¶ä¸ä¸€å®šã€‚<code>logN</code>çš„é«˜åº¦åªå­˜åœ¨äºå¹³è¡¡äºŒå‰æ ‘ï¼Œå¯¹äºä¸€èˆ¬çš„æ ‘å¯èƒ½å‡ºç°æç«¯ä¸å¹³è¡¡çš„æƒ…å†µï¼Œä½¿å¾—ã€Œæ ‘ã€å‡ ä¹é€€åŒ–æˆã€Œé“¾è¡¨ã€ï¼Œæ ‘çš„é«˜åº¦æœ€åæƒ…å†µä¸‹å¯èƒ½å˜æˆ<code>N</code>ã€‚</p>
<p>æ‰€ä»¥è¯´ä¸Šé¢è¿™ç§è§£æ³•ï¼Œ<code>find</code>,<code>union</code>,<code>connected</code>çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(N)ã€‚è¿™ä¸ªå¤æ‚åº¦å¾ˆä¸ç†æƒ³çš„ï¼Œä½ æƒ³å›¾è®ºè§£å†³çš„éƒ½æ˜¯è¯¸å¦‚ç¤¾äº¤ç½‘ç»œè¿™æ ·æ•°æ®è§„æ¨¡å·¨å¤§çš„é—®é¢˜ï¼Œå¯¹äº<code>union</code>å’Œ<code>connected</code>çš„è°ƒç”¨éå¸¸é¢‘ç¹ï¼Œæ¯æ¬¡è°ƒç”¨éœ€è¦çº¿æ€§æ—¶é—´å®Œå…¨ä¸å¯å¿å—ã€‚</p>
<h3 data-id="heading-11">å¹³è¡¡æ€§ä¼˜åŒ–</h3>
<p>è¦çŸ¥é“å“ªç§æƒ…å†µä¸‹å¯èƒ½å‡ºç°ä¸å¹³è¡¡ç°è±¡ï¼Œå…³é”®åœ¨äº<code>union</code>è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
    <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);
    <span class="hljs-keyword">if</span> (rootP == rootQ)
        <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µ</span>
    parent[rootP] = rootQ;
    <span class="hljs-comment">// parent[rootQ] = rootP ä¹Ÿå¯ä»¥</span>
    count--; 
}
</code></pre>
<p>æˆ‘ä»¬ä¸€å¼€å§‹å°±æ˜¯ç®€å•ç²—æš´çš„æŠŠ<code>p</code>æ‰€åœ¨çš„æ ‘æ¥åˆ°<code>q</code>æ‰€åœ¨çš„æ ‘çš„æ ¹èŠ‚ç‚¹ä¸‹é¢ï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¯èƒ½å‡ºç°ã€Œå¤´é‡è„šè½»ã€çš„ä¸å¹³è¡¡çŠ¶å†µï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§å±€é¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37fa63f2278f4b8785cd2ee259522713~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766966018&amp;x-signature=UzFf0QwD1wPYDCzv8dikoFYbQrI%3D" alt="" loading="lazy"/></p>
<p>é•¿æ­¤ä»¥å¾€ï¼Œæ ‘å¯èƒ½ç”Ÿé•¿å¾—å¾ˆä¸å¹³è¡¡ã€‚<strong>æˆ‘ä»¬å…¶å®æ˜¯å¸Œæœ›ï¼Œå°ä¸€äº›çš„æ ‘æ¥åˆ°å¤§ä¸€äº›çš„æ ‘ä¸‹é¢ï¼Œè¿™æ ·å°±èƒ½é¿å…å¤´é‡è„šè½»ï¼Œæ›´å¹³è¡¡ä¸€äº›</strong>ã€‚è§£å†³æ–¹æ³•æ˜¯é¢å¤–ä½¿ç”¨ä¸€ä¸ª<code>size</code>æ•°ç»„ï¼Œè®°å½•æ¯æ£µæ ‘åŒ…å«çš„èŠ‚ç‚¹æ•°ï¼Œæˆ‘ä»¬ä¸å¦¨ç§°ä¸ºã€Œé‡é‡ã€ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UF</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> count;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] parent;
    <span class="hljs-comment">// æ–°å¢ä¸€ä¸ªæ•°ç»„è®°å½•æ ‘çš„â€œé‡é‡â€</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] size;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UF</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-built_in">this</span>.count = n;
        parent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        <span class="hljs-comment">// æœ€åˆæ¯æ£µæ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹</span>
        <span class="hljs-comment">// é‡é‡åº”è¯¥åˆå§‹åŒ– 1</span>
        size = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) {
            parent[i] = i;
            size[i] = <span class="hljs-number">1</span>;
        }
    }
    <span class="hljs-comment">/* å…¶ä»–å‡½æ•° */</span>
}
</code></pre>
<p>æ¯”å¦‚è¯´<code>size[3] = 5</code>è¡¨ç¤ºï¼Œä»¥èŠ‚ç‚¹<code>3</code>ä¸ºæ ¹çš„é‚£æ£µæ ‘ï¼Œæ€»å…±æœ‰<code>5</code>ä¸ªèŠ‚ç‚¹ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸€ä¸‹<code>union</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
    <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);
    <span class="hljs-keyword">if</span> (rootP == rootQ)
        <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// å°æ ‘æ¥åˆ°å¤§æ ‘ä¸‹é¢ï¼Œè¾ƒå¹³è¡¡</span>
    <span class="hljs-keyword">if</span> (size[rootP] &gt; size[rootQ]) {
        parent[rootQ] = rootP;
        size[rootP] += size[rootQ];
    } <span class="hljs-keyword">else</span> {
        parent[rootP] = rootQ;
        size[rootQ] += size[rootP];
    }
    count--;
}
</code></pre>
<p>è¿™æ ·ï¼Œé€šè¿‡æ¯”è¾ƒæ ‘çš„é‡é‡ï¼Œå°±å¯ä»¥ä¿è¯æ ‘çš„ç”Ÿé•¿ç›¸å¯¹å¹³è¡¡ï¼Œæ ‘çš„é«˜åº¦å¤§è‡´åœ¨<code>logN</code>è¿™ä¸ªæ•°é‡çº§ï¼Œæå¤§æå‡æ‰§è¡Œæ•ˆç‡ã€‚</p>
<p>æ­¤æ—¶ï¼Œ<code>find</code>,<code>union</code>,<code>connected</code>çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸‹é™ä¸º O(logN)ï¼Œå³ä¾¿æ•°æ®è§„æ¨¡ä¸Šäº¿ï¼Œæ‰€éœ€æ—¶é—´ä¹Ÿéå¸¸å°‘ã€‚</p>
<h3 data-id="heading-12">è·¯å¾„å‹ç¼©</h3>
<p><strong>å…¶å®æˆ‘ä»¬å¹¶ä¸åœ¨ä¹æ¯æ£µæ ‘çš„ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Œåªåœ¨ä¹æ ¹èŠ‚ç‚¹</strong>ã€‚</p>
<p>å› ä¸ºæ— è®ºæ ‘é•¿å•¥æ ·ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥èƒ½ä¸èƒ½è¿›ä¸€æ­¥å‹ç¼©æ¯æ£µæ ‘çš„é«˜åº¦ï¼Œä½¿æ ‘é«˜å§‹ç»ˆä¿æŒä¸ºå¸¸æ•°ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6279b0a47ee4c3cac653d70ecafd639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766966018&amp;x-signature=PRqcGYOmKkj7%2BJSRhZSrN%2FbkFaw%3D" alt="" loading="lazy"/></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å°±æ˜¯æ•´æ£µæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œ<code>find</code>å°±èƒ½ä»¥ O(1) çš„æ—¶é—´æ‰¾åˆ°æŸä¸€èŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹ï¼Œç›¸åº”çš„ï¼Œ<code>connected</code>å’Œ<code>union</code>å¤æ‚åº¦éƒ½ä¸‹é™ä¸º O(1)ã€‚</p>
<p>è¦åšåˆ°è¿™ä¸€ç‚¹ä¸»è¦æ˜¯ä¿®æ”¹<code>find</code>å‡½æ•°é€»è¾‘ï¼Œéå¸¸ç®€å•ï¼Œä½†ä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸¤ç§ä¸åŒçš„å†™æ³•ã€‚</p>
<p>ç¬¬ä¸€ç§æ˜¯åœ¨<code>find</code>ä¸­åŠ ä¸€è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-keyword">while</span> (parent[x] != x) {
        <span class="hljs-comment">// è¿™è¡Œä»£ç è¿›è¡Œè·¯å¾„å‹ç¼©</span>
        parent[x] = parent[parent[x]];
        x = parent[x];
    }
    <span class="hljs-keyword">return</span> x;
}
</code></pre>
<p>ç”¨è¯­è¨€æè¿°å°±æ˜¯ï¼Œæ¯æ¬¡ while å¾ªç¯éƒ½ä¼šæŠŠä¸€å¯¹å„¿çˆ¶å­èŠ‚ç‚¹æ”¹åˆ°åŒä¸€å±‚ï¼Œè¿™æ ·æ¯æ¬¡è°ƒç”¨<code>find</code>å‡½æ•°å‘æ ‘æ ¹éå†çš„åŒæ—¶ï¼Œé¡ºæ‰‹å°±å°†æ ‘é«˜ç¼©çŸ­äº†ã€‚</p>
<p>è·¯å¾„å‹ç¼©çš„ç¬¬äºŒç§å†™æ³•æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¬¬äºŒç§è·¯å¾„å‹ç¼©çš„ find æ–¹æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-keyword">if</span> (parent[x] != x) {
        parent[x] = find(parent[x]);
    }
    <span class="hljs-keyword">return</span> parent[x];
}
</code></pre>
<p>è¿™ä¸ªé€’å½’è¿‡ç¨‹æœ‰ç‚¹ä¸å¥½ç†è§£ï¼Œä½ å¯ä»¥è‡ªå·±æ‰‹ç”»ä¸€ä¸‹é€’å½’è¿‡ç¨‹ã€‚æˆ‘æŠŠè¿™ä¸ªå‡½æ•°åšçš„äº‹æƒ…ç¿»è¯‘æˆè¿­ä»£å½¢å¼ï¼Œæ–¹ä¾¿ä½ ç†è§£å®ƒè¿›è¡Œè·¯å¾„å‹ç¼©çš„åŸç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿™æ®µè¿­ä»£ä»£ç æ–¹ä¾¿ä½ ç†è§£é€’å½’ä»£ç æ‰€åšçš„äº‹æƒ…</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
    <span class="hljs-comment">// å…ˆæ‰¾åˆ°æ ¹èŠ‚ç‚¹</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> x;
    <span class="hljs-keyword">while</span> (parent[root] != root) {
        root = parent[root];
    }
    <span class="hljs-comment">// ç„¶åæŠŠ x åˆ°æ ¹èŠ‚ç‚¹ä¹‹é—´çš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æ¥åˆ°æ ¹èŠ‚ç‚¹ä¸‹é¢</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">old_parent</span> <span class="hljs-operator">=</span> parent[x];
    <span class="hljs-keyword">while</span> (x != root) {
        parent[x] = root;
        x = old_parent;
        old_parent = parent[old_parent];
    }
    <span class="hljs-keyword">return</span> root;
}
</code></pre>
<p>è¿™ç§è·¯å¾„å‹ç¼©çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db56ffc435684f41bf0ea9a0a05ab589~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766966018&amp;x-signature=nH2ekTCSttxUs07fWOwpTzUPFrM%3D" alt="" loading="lazy"/></p>
<p>æ¯”èµ·ç¬¬ä¸€ç§è·¯å¾„å‹ç¼©ï¼Œæ˜¾ç„¶è¿™ç§æ–¹æ³•å‹ç¼©å¾—æ›´å½»åº•ï¼Œç›´æ¥æŠŠä¸€æ•´æ¡æ ‘æå‹å¹³ï¼Œä¸€ç‚¹æ„å¤–éƒ½æ²¡æœ‰ã€‚å°±ç®—ä¸€äº›æç«¯æƒ…å†µä¸‹äº§ç”Ÿäº†ä¸€æ£µæ¯”è¾ƒé«˜çš„æ ‘ï¼Œåªè¦ä¸€æ¬¡è·¯å¾„å‹ç¼©å°±èƒ½å¤§å¹…é™ä½æ ‘é«˜ï¼Œä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Ftools%2Fblog-entry%3Ftarget%3Dhttps%253A%252F%252Fmp.weixin.qq.com%252Fs%253F__biz%253DMzAxODQxMDM0Mw%253D%253D%2526mid%253D2247496738%2526idx%253D1%2526sn%253D2c7d16c8b0ee64d8101abb35e06b08cc%2526scene%253D21%2523wechat_redirect%26source%3Darticle%26objectId%3D2190285" target="_blank" title="https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzAxODQxMDM0Mw%3D%3D%26mid%3D2247496738%26idx%3D1%26sn%3D2c7d16c8b0ee64d8101abb35e06b08cc%26scene%3D21%23wechat_redirect&amp;source=article&amp;objectId=2190285" ref="nofollow noopener noreferrer">æ‘Šè¿˜åˆ†æ</a> çš„è§’åº¦æ¥çœ‹ï¼Œæ‰€æœ‰æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¾ç„¶æ˜¯ O(1)ï¼Œæ‰€ä»¥ä»æ•ˆç‡çš„è§’åº¦æ¥è¯´ï¼Œæ¨èä½ ä½¿ç”¨è¿™ç§è·¯å¾„å‹ç¼©ç®—æ³•ã€‚</p>
<p><strong>å¦å¤–ï¼Œå¦‚æœä½¿ç”¨è·¯å¾„å‹ç¼©æŠ€å·§ï¼Œé‚£ä¹ˆ<code>size</code>æ•°ç»„çš„å¹³è¡¡ä¼˜åŒ–å°±ä¸æ˜¯ç‰¹åˆ«å¿…è¦äº†</strong>ã€‚æ‰€ä»¥ä½ ä¸€èˆ¬çœ‹åˆ°çš„ Union Find ç®—æ³•åº”è¯¥æ˜¯å¦‚ä¸‹å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UF</span> {
    <span class="hljs-comment">// è¿é€šåˆ†é‡ä¸ªæ•°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> count;
    <span class="hljs-comment">// å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] parent;

    <span class="hljs-comment">// n ä¸ºå›¾ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UF</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-built_in">this</span>.count = n;
        parent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) {
            parent[i] = i;
        }
    }

    <span class="hljs-comment">// å°†èŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q è¿é€š</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
        <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);

        <span class="hljs-keyword">if</span> (rootP == rootQ)
            <span class="hljs-keyword">return</span>;

        parent[rootQ] = rootP;
        <span class="hljs-comment">// ä¸¤ä¸ªè¿é€šåˆ†é‡åˆå¹¶æˆä¸€ä¸ªè¿é€šåˆ†é‡</span>
        count--;
    }

    <span class="hljs-comment">// åˆ¤æ–­èŠ‚ç‚¹ p å’ŒèŠ‚ç‚¹ q æ˜¯å¦è¿é€š</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">connected</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);
        <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);
        <span class="hljs-keyword">return</span> rootP == rootQ;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
        <span class="hljs-keyword">if</span> (parent[x] != x) {
            parent[x] = find(parent[x]);
        }
        <span class="hljs-keyword">return</span> parent[x];
    }

    <span class="hljs-comment">// è¿”å›å›¾ä¸­çš„è¿é€šåˆ†é‡ä¸ªæ•°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">count</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> count;
    }
}
</code></pre>
<p>Union-Find ç®—æ³•çš„å¤æ‚åº¦å¯ä»¥è¿™æ ·åˆ†æï¼šæ„é€ å‡½æ•°åˆå§‹åŒ–æ•°æ®ç»“æ„éœ€è¦ O(N) çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ï¼›è¿é€šä¸¤ä¸ªèŠ‚ç‚¹<code>union</code>ã€åˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹çš„è¿é€šæ€§<code>connected</code>ã€è®¡ç®—è¿é€šåˆ†é‡<code>count</code>æ‰€éœ€çš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O(1)ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»æŒæ¡äº† Union-Find ç®—æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼Œæ€»ç»“ä¸€ä¸‹æˆ‘ä»¬ä¼˜åŒ–ç®—æ³•çš„è¿‡ç¨‹ï¼š</p>
<p>1ã€ç”¨<code>parent</code>æ•°ç»„è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œç›¸å½“äºæŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥<code>parent</code>æ•°ç»„å†…å®é™…å­˜å‚¨ç€ä¸€ä¸ªæ£®æ—ï¼ˆè‹¥å¹²æ£µå¤šå‰æ ‘ï¼‰ã€‚</p>
<p>2ã€ç”¨<code>size</code>æ•°ç»„è®°å½•ç€æ¯æ£µæ ‘çš„é‡é‡ï¼Œç›®çš„æ˜¯è®©<code>union</code>åæ ‘ä¾ç„¶æ‹¥æœ‰å¹³è¡¡æ€§ï¼Œä¿è¯å„ä¸ª API æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ï¼Œè€Œä¸ä¼šé€€åŒ–æˆé“¾è¡¨å½±å“æ“ä½œæ•ˆç‡ã€‚</p>
<p>3ã€åœ¨<code>find</code>å‡½æ•°ä¸­è¿›è¡Œè·¯å¾„å‹ç¼©ï¼Œä¿è¯ä»»æ„æ ‘çš„é«˜åº¦ä¿æŒåœ¨å¸¸æ•°ï¼Œä½¿å¾—å„ä¸ª API æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚ä½¿ç”¨äº†è·¯å¾„å‹ç¼©ä¹‹åï¼Œå¯ä»¥ä¸ä½¿ç”¨<code>size</code>æ•°ç»„çš„å¹³è¡¡ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-13">ä¼˜ç‚¹</h3>
<ol>
<li>æŸ¥æ‰¾å’Œåˆå¹¶æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦æ¥è¿‘O(1)</li>
<li>å®ç°ç®€å•ï¼Œæ˜“äºç†è§£</li>
<li>ç©ºé—´å¤æ‚åº¦ä½ï¼Œåªéœ€è¦ä¸¤ä¸ªæ•°ç»„</li>
<li>é€‚ç”¨äºå¤„ç†å¤§é‡åŠ¨æ€è¿é€šæ€§é—®é¢˜</li>
</ol>
<h3 data-id="heading-14">ç¼ºç‚¹</h3>
<ol>
<li>ä¸æ”¯æŒåˆ†è£‚æ“ä½œï¼ˆå°†ä¸€ä¸ªé›†åˆåˆ†æˆä¸¤ä¸ªï¼‰</li>
<li>ä¸æ–¹ä¾¿æŸ¥è¯¢é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </li>
<li>åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ€§èƒ½å¯èƒ½é€€åŒ–</li>
</ol>
<h3 data-id="heading-15">åº”ç”¨åœºæ™¯</h3>
<p>Kruskalæœ€å°ç”Ÿæˆæ ‘ç®—æ³•ï¼šåœ¨Kruskalç®—æ³•ä¸­ï¼Œå¹¶æŸ¥é›†æ˜¯æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚è¯¥ç®—æ³•æŒ‰æƒé‡ä»å°åˆ°å¤§éå†è¾¹ï¼Œä½¿ç”¨å¹¶æŸ¥é›†åˆ¤æ–­åŠ å…¥æŸæ¡è¾¹æ˜¯å¦ä¼šå½¢æˆç¯ï¼Œä»è€Œé«˜æ•ˆæ„å»ºæœ€å°ç”Ÿæˆæ ‘ã€‚</p>
<p>ç½‘ç»œè¿é€šæ€§é—®é¢˜ï¼šå¹¶æŸ¥é›†å¯é«˜æ•ˆè§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜ï¼Œæ¯”å¦‚åˆ¤æ–­ç½‘ç»œä¸­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿é€šã€ç¤¾äº¤ç½‘ç»œä¸­ç”¨æˆ·é—´çš„å…³ç³»è¿æ¥ç­‰ã€‚å½“å…³ç³»å˜åŒ–æ—¶ï¼Œåªéœ€æ‰§è¡Œç®€å•çš„unionæ“ä½œï¼Œåˆ¤æ–­è¿é€šæ€§æ—¶ä½¿ç”¨findæ“ä½œå³å¯ã€‚</p>
<p>ç­‰ä»·ç±»åˆ’åˆ†ï¼šåœ¨ç¼–è¯‘å™¨è®¾è®¡ã€ç”µè·¯åˆ†æç­‰é¢†åŸŸï¼Œå¹¶æŸ¥é›†å¯ç”¨äºç­‰ä»·ç±»è¯†åˆ«ä¸åˆå¹¶ã€‚å½“ç³»ç»Ÿå‘ç°ä¸¤ä¸ªå…ƒç´ ç­‰ä»·æ—¶æ‰§è¡Œunionæ“ä½œï¼Œéœ€è¦åˆ¤æ–­ç­‰ä»·å…³ç³»æ—¶ä½¿ç”¨findæ“ä½œï¼Œè¿™ç§åŠ¨æ€ç»´æŠ¤ç­‰ä»·å…³ç³»çš„èƒ½åŠ›æ­£æ˜¯å¹¶æŸ¥é›†çš„ä¼˜åŠ¿æ‰€åœ¨ã€‚</p>
<p>åˆ¤æ–­æ— å‘å›¾ä¸­çš„ç¯ï¼šå½“å‘æ— å‘å›¾ä¸­æ·»åŠ è¾¹æ—¶ï¼Œå¦‚æœè¾¹çš„ä¸¤ä¸ªç«¯ç‚¹å·²åœ¨åŒä¸€ä¸ªé›†åˆä¸­ï¼Œåˆ™æ·»åŠ è¿™æ¡è¾¹ä¼šå½¢æˆç¯ã€‚åœ¨å¾ˆå¤šå›¾ç®—æ³•å’Œç½‘ç»œè®¾è®¡é—®é¢˜ä¸­éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸€ç‰¹æ€§ã€‚</p>
<h2 data-id="heading-16">Kruskal æœ€å°ç”Ÿæˆæ ‘ç®—æ³•</h2>
<p>Kruskal çš„ å…³é”®å°±æ˜¯ å¹¶æŸ¥é›†ç®—æ³•</p>
<p><strong>å…ˆè¯´ã€Œæ ‘ã€å’Œã€Œå›¾ã€çš„æ ¹æœ¬åŒºåˆ«ï¼šæ ‘ä¸ä¼šåŒ…å«ç¯ï¼Œå›¾å¯ä»¥åŒ…å«ç¯</strong>ã€‚</p>
<p>å¦‚æœä¸€å¹…å›¾æ²¡æœ‰ç¯ï¼Œå®Œå…¨å¯ä»¥æ‹‰ä¼¸æˆä¸€æ£µæ ‘çš„æ¨¡æ ·ã€‚è¯´çš„ä¸“ä¸šä¸€ç‚¹ï¼Œæ ‘å°±æ˜¯ã€Œæ— ç¯è¿é€šå›¾ã€ã€‚</p>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯å›¾çš„ã€Œç”Ÿæˆæ ‘ã€å‘¢ï¼Œå…¶å®æŒ‰å­—é¢æ„æ€ä¹Ÿå¥½ç†è§£ï¼Œå°±æ˜¯åœ¨å›¾ä¸­æ‰¾ä¸€æ£µåŒ…å«å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹çš„æ ‘ã€‚ä¸“ä¸šç‚¹è¯´ï¼Œç”Ÿæˆæ ‘æ˜¯å«æœ‰å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹çš„ã€Œæ— ç¯è¿é€šå­å›¾ã€ã€‚</p>
<p>å®¹æ˜“æƒ³åˆ°ï¼Œä¸€å¹…å›¾å¯ä»¥æœ‰å¾ˆå¤šä¸åŒçš„ç”Ÿæˆæ ‘ï¼Œæ¯”å¦‚ä¸‹é¢è¿™å¹…å›¾ï¼Œçº¢è‰²çš„è¾¹å°±ç»„æˆäº†ä¸¤æ£µä¸åŒçš„ç”Ÿæˆæ ‘ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2cd0aca70e44ba8b08ff19687cfabbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766966018&amp;x-signature=b0cLXz%2F4qKcSWGClD7t4GeTShPE%3D" alt="" loading="lazy"/></p>
<p>å¯¹äºåŠ æƒå›¾ï¼Œæ¯æ¡è¾¹éƒ½æœ‰æƒé‡ï¼Œæ‰€ä»¥æ¯æ£µç”Ÿæˆæ ‘éƒ½æœ‰ä¸€ä¸ªæƒé‡å’Œã€‚æ¯”å¦‚ä¸Šå›¾ï¼Œå³ä¾§ç”Ÿæˆæ ‘çš„æƒé‡å’Œæ˜¾ç„¶æ¯”å·¦ä¾§ç”Ÿæˆæ ‘çš„æƒé‡å’Œè¦å°ã€‚</p>
<p><strong>é‚£ä¹ˆæœ€å°ç”Ÿæˆæ ‘å¾ˆå¥½ç†è§£äº†ï¼Œæ‰€æœ‰å¯èƒ½çš„ç”Ÿæˆæ ‘ä¸­ï¼Œæƒé‡å’Œæœ€å°çš„é‚£æ£µç”Ÿæˆæ ‘å°±å«ã€Œæœ€å°ç”Ÿæˆæ ‘ã€</strong>ã€‚</p>
<blockquote>
<p>PSï¼šä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨<strong>æ— å‘åŠ æƒå›¾</strong>ä¸­è®¡ç®—æœ€å°ç”Ÿæˆæ ‘çš„ï¼Œæ‰€ä»¥ä½¿ç”¨æœ€å°ç”Ÿæˆæ ‘ç®—æ³•çš„ç°å®åœºæ™¯ä¸­ï¼Œå›¾çš„è¾¹æƒé‡ä¸€èˆ¬ä»£è¡¨æˆæœ¬ã€è·ç¦»è¿™æ ·çš„æ ‡é‡ã€‚</p>
</blockquote>
<p>æ‰€è°“æœ€å°ç”Ÿæˆæ ‘ï¼Œå°±æ˜¯å›¾ä¸­è‹¥å¹²è¾¹çš„é›†åˆï¼ˆæˆ‘ä»¬åæ–‡ç§°è¿™ä¸ªé›†åˆä¸º<code>mst</code>ï¼Œæœ€å°ç”Ÿæˆæ ‘çš„è‹±æ–‡ç¼©å†™ï¼‰ï¼Œä½ è¦ä¿è¯è¿™äº›è¾¹ï¼š</p>
<p>1ã€åŒ…å«å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</p>
<p>2ã€å½¢æˆçš„ç»“æ„æ˜¯æ ‘ç»“æ„ï¼ˆå³ä¸å­˜åœ¨ç¯ï¼‰ã€‚</p>
<p>3ã€æƒé‡å’Œæœ€å°ã€‚</p>
<p>å‰ä¸¤æ¡å…¶å®å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ©ç”¨ Union-Find ç®—æ³•åšåˆ°ï¼Œå…³é”®åœ¨äºç¬¬ 3 ç‚¹ï¼Œå¦‚ä½•ä¿è¯å¾—åˆ°çš„è¿™æ£µç”Ÿæˆæ ‘æ˜¯æƒé‡å’Œæœ€å°çš„ã€‚</p>
<p>è¿™é‡Œå°±ç”¨åˆ°äº†è´ªå¿ƒæ€è·¯ï¼š<strong>å°†æ‰€æœ‰è¾¹æŒ‰ç…§æƒé‡ä»å°åˆ°å¤§æ’åºï¼Œä»æƒé‡æœ€å°çš„è¾¹å¼€å§‹éå†ï¼Œå¦‚æœè¿™æ¡è¾¹å’Œ<code>mst</code>ä¸­çš„å…¶å®ƒè¾¹ä¸ä¼šå½¢æˆç¯ï¼Œåˆ™è¿™æ¡è¾¹æ˜¯æœ€å°ç”Ÿæˆæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå°†å®ƒåŠ å…¥<code>mst</code>é›†åˆï¼›å¦åˆ™ï¼Œè¿™æ¡è¾¹ä¸æ˜¯æœ€å°ç”Ÿæˆæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œä¸è¦æŠŠå®ƒåŠ å…¥<code>mst</code>é›†åˆ</strong>ã€‚</p>
<p>è¿™æ ·ï¼Œæœ€å<code>mst</code>é›†åˆä¸­çš„è¾¹å°±å½¢æˆäº†æœ€å°ç”Ÿæˆæ ‘ï¼Œç®—æ³•ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-title function_">minimumCost</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span>[][] connections)</span> {
    <span class="hljs-comment">// åŸå¸‚ç¼–å·ä¸º 1...nï¼Œæ‰€ä»¥åˆå§‹åŒ–å¤§å°ä¸º n + 1</span>
    <span class="hljs-type">UF</span> <span class="hljs-variable">uf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UF</span>(n + <span class="hljs-number">1</span>);
    <span class="hljs-comment">// å¯¹æ‰€æœ‰è¾¹æŒ‰ç…§æƒé‡ä»å°åˆ°å¤§æ’åº</span>
    Arrays.sort(connections, (a, b) -&gt; (a[<span class="hljs-number">2</span>] - b[<span class="hljs-number">2</span>]));
    <span class="hljs-comment">// è®°å½•æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡ä¹‹å’Œ</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">mst</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : connections) {
        <span class="hljs-type">int</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">0</span>];
        <span class="hljs-type">int</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>];
        <span class="hljs-type">int</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">2</span>];
        <span class="hljs-comment">// è‹¥è¿™æ¡è¾¹ä¼šäº§ç”Ÿç¯ï¼Œåˆ™ä¸èƒ½åŠ å…¥ mst</span>
        <span class="hljs-keyword">if</span> (uf.connected(u, v)) {
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-comment">// è‹¥è¿™æ¡è¾¹ä¸ä¼šäº§ç”Ÿç¯ï¼Œåˆ™å±äºæœ€å°ç”Ÿæˆæ ‘</span>
        mst += weight;
        uf.union(u, v);
    }
    <span class="hljs-comment">// ä¿è¯æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«è¿é€š</span>
    <span class="hljs-comment">// æŒ‰ç†è¯´ uf.count() == 1 è¯´æ˜æ‰€æœ‰èŠ‚ç‚¹è¢«è¿é€š</span>
    <span class="hljs-comment">// ä½†å› ä¸ºèŠ‚ç‚¹ 0 æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ 0 ä¼šé¢å¤–å ç”¨ä¸€ä¸ªè¿é€šåˆ†é‡</span>
    <span class="hljs-keyword">return</span> uf.count() == <span class="hljs-number">2</span> ? mst : -<span class="hljs-number">1</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UF</span> {
    <span class="hljs-comment">// è§ä¸Šæ–‡å¹¶æŸ¥é›†ä»£ç å®ç°</span>
}
</code></pre>
<p>å¤æ‚åº¦åˆ†æï¼š</p>
<p>å‡è®¾ä¸€å¹…å›¾çš„èŠ‚ç‚¹ä¸ªæ•°ä¸ºVï¼Œè¾¹çš„æ¡æ•°ä¸ºEï¼Œé¦–å…ˆéœ€è¦O(E)çš„ç©ºé—´è£…æ‰€æœ‰è¾¹ï¼Œè€Œä¸” Union-Find ç®—æ³•ä¹Ÿéœ€è¦O(V)çš„ç©ºé—´ï¼Œæ‰€ä»¥ Kruskal ç®—æ³•æ€»çš„ç©ºé—´å¤æ‚åº¦å°±æ˜¯O(V + E)ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸»è¦è€—è´¹åœ¨æ’åºï¼Œéœ€è¦O(ElogE)çš„æ—¶é—´ï¼ŒUnion-Find ç®—æ³•æ‰€æœ‰æ“ä½œçš„å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼Œå¥—ä¸€ä¸ª for å¾ªç¯ä¹Ÿä¸è¿‡æ˜¯O(E)ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(ElogE)ã€‚</p>
<h2 data-id="heading-17">PRIM æœ€å°ç”Ÿæˆæ ‘ç®—æ³•</h2>
<p><strong>Prim ç®—æ³•ä¹Ÿä½¿ç”¨è´ªå¿ƒæ€æƒ³æ¥è®©ç”Ÿæˆæ ‘çš„æƒé‡å°½å¯èƒ½å°</strong>ï¼Œä¹Ÿå°±æ˜¯ã€Œåˆ‡åˆ†å®šç†ã€ã€‚</p>
<p><strong>å…¶æ¬¡ï¼ŒPrim ç®—æ³•ä½¿ç”¨</strong> <strong>BFS ç®—æ³•æ€æƒ³</strong> <strong>å’Œ</strong> <strong>visited</strong> <strong>å¸ƒå°”æ•°ç»„é¿å…æˆç¯</strong>ï¼Œæ¥ä¿è¯é€‰å‡ºæ¥çš„è¾¹æœ€ç»ˆå½¢æˆçš„ä¸€å®šæ˜¯ä¸€æ£µæ ‘ã€‚</p>
<p>Prim ç®—æ³•ä¸éœ€è¦äº‹å…ˆå¯¹æ‰€æœ‰è¾¹æ’åºï¼Œè€Œæ˜¯åˆ©ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—åŠ¨æ€å®ç°æ’åºçš„æ•ˆæœï¼Œæ‰€ä»¥ Prim ç®—æ³•ç±»ä¼¼äº Kruskal çš„åŠ¨æ€è¿‡ç¨‹ã€‚</p>
<blockquote>
<p>åˆ‡åˆ†å®šç†ï¼šå¯¹äºä»»æ„ä¸€ç§ã€Œåˆ‡åˆ†ã€ï¼Œå…¶ä¸­æƒé‡æœ€å°çš„é‚£æ¡ã€Œæ¨ªåˆ‡è¾¹ã€ä¸€å®šæ˜¯æ„æˆæœ€å°ç”Ÿæˆæ ‘çš„ä¸€æ¡è¾¹ã€‚åªè¦æŠŠå›¾ä¸­çš„èŠ‚ç‚¹åˆ‡æˆä¸¤ä¸ªä¸é‡å ä¸”éç©ºçš„èŠ‚ç‚¹é›†åˆå³å¯ç®—ä½œä¸€ä¸ªåˆæ³•çš„ã€Œåˆ‡åˆ†ã€</p>
</blockquote>
<blockquote>
<p>åè¯æ³•è¯æ˜ï¼šç»™å®šä¸€å¹…å›¾çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆéšä¾¿ç»™ä¸€ç§ã€Œåˆ‡åˆ†ã€ï¼Œä¸€å®šè‡³å°‘æœ‰ä¸€æ¡ã€Œæ¨ªåˆ‡è¾¹ã€å±äºæœ€å°ç”Ÿæˆæ ‘ã€‚å‡è®¾è¿™æ¡ã€Œæ¨ªåˆ‡è¾¹ã€ä¸æ˜¯æƒé‡æœ€å°çš„ï¼Œé‚£è¯´æ˜æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡å’Œå°±è¿˜æœ‰å†å‡å°çš„ä½™åœ°ï¼Œé‚£è¿™å°±çŸ›ç›¾äº†ï¼Œæœ€å°ç”Ÿæˆæ ‘çš„æƒé‡å’Œæœ¬æ¥å°±æ˜¯æœ€å°çš„ï¼Œæ€ä¹ˆå†å‡ï¼Ÿæ‰€ä»¥åˆ‡åˆ†å®šç†æ˜¯æ­£ç¡®çš„ã€‚</p>
</blockquote>
<p>ç®—æ³•å®ç°ï¼šPrim ç®—æ³•çš„é€»è¾‘å°±æ˜¯ï¼Œæ¯æ¬¡åˆ‡åˆ†éƒ½èƒ½æ‰¾åˆ°æœ€å°ç”Ÿæˆæ ‘çš„ä¸€æ¡è¾¹ï¼Œç„¶ååˆå¯ä»¥è¿›è¡Œæ–°ä¸€è½®åˆ‡åˆ†ï¼Œç›´åˆ°æ‰¾åˆ°æœ€å°ç”Ÿæˆæ ‘çš„æ‰€æœ‰è¾¹ä¸ºæ­¢ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Prim</span> {
    <span class="hljs-comment">// æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œå­˜å‚¨ã€Œæ¨ªåˆ‡è¾¹ã€çš„ä¼˜å…ˆçº§é˜Ÿåˆ—</span>
    <span class="hljs-keyword">private</span> PriorityQueue&lt;<span class="hljs-type">int</span>[]&gt; pq;
    <span class="hljs-comment">// ç±»ä¼¼ visited æ•°ç»„çš„ä½œç”¨ï¼Œè®°å½•å“ªäº›èŠ‚ç‚¹å·²ç»æˆä¸ºæœ€å°ç”Ÿæˆæ ‘çš„ä¸€éƒ¨åˆ†</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span>[] inMST;
    <span class="hljs-comment">// è®°å½•æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡å’Œ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">weightSum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-comment">// graph æ˜¯ç”¨é‚»æ¥è¡¨è¡¨ç¤ºçš„ä¸€å¹…å›¾ï¼Œ</span>
    <span class="hljs-comment">// graph[s] è®°å½•èŠ‚ç‚¹ s æ‰€æœ‰ç›¸é‚»çš„è¾¹ï¼Œ</span>
    <span class="hljs-comment">// ä¸‰å…ƒç»„ int[]{from, to, weight} è¡¨ç¤ºä¸€æ¡è¾¹</span>
    <span class="hljs-keyword">private</span> List&lt;<span class="hljs-type">int</span>[]&gt;[] graph;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Prim</span><span class="hljs-params">(List&lt;<span class="hljs-type">int</span>[]&gt;[] graph)</span> {
        <span class="hljs-built_in">this</span>.graph = graph;
        <span class="hljs-built_in">this</span>.pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; {
            <span class="hljs-comment">// æŒ‰ç…§è¾¹çš„æƒé‡ä»å°åˆ°å¤§æ’åº</span>
            <span class="hljs-keyword">return</span> a[<span class="hljs-number">2</span>] - b[<span class="hljs-number">2</span>];
        });
        <span class="hljs-comment">// å›¾ä¸­æœ‰ n ä¸ªèŠ‚ç‚¹</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> graph.length;
        <span class="hljs-built_in">this</span>.inMST = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];

        <span class="hljs-comment">// éšä¾¿ä»ä¸€ä¸ªç‚¹å¼€å§‹åˆ‡åˆ†éƒ½å¯ä»¥ï¼Œæˆ‘ä»¬ä¸å¦¨ä»èŠ‚ç‚¹ 0 å¼€å§‹</span>
        inMST[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;
        cut(<span class="hljs-number">0</span>);
        <span class="hljs-comment">// ä¸æ–­è¿›è¡Œåˆ‡åˆ†ï¼Œå‘æœ€å°ç”Ÿæˆæ ‘ä¸­æ·»åŠ è¾¹</span>
        <span class="hljs-keyword">while</span> (!pq.isEmpty()) {
            <span class="hljs-type">int</span>[] edge = pq.poll();
            <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>];
            <span class="hljs-type">int</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">2</span>];
            <span class="hljs-keyword">if</span> (inMST[to]) {
                <span class="hljs-comment">// èŠ‚ç‚¹ to å·²ç»åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸­ï¼Œè·³è¿‡</span>
                <span class="hljs-comment">// å¦åˆ™è¿™æ¡è¾¹ä¼šäº§ç”Ÿç¯</span>
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-comment">// å°†è¾¹ edge åŠ å…¥æœ€å°ç”Ÿæˆæ ‘</span>
            weightSum += weight;
            inMST[to] = <span class="hljs-literal">true</span>;
            <span class="hljs-comment">// èŠ‚ç‚¹ to åŠ å…¥åï¼Œè¿›è¡Œæ–°ä¸€è½®åˆ‡åˆ†ï¼Œä¼šäº§ç”Ÿæ›´å¤šæ¨ªåˆ‡è¾¹</span>
            cut(to);
        }
    }

    <span class="hljs-comment">// å°† s çš„æ¨ªåˆ‡è¾¹åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cut</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> {
        <span class="hljs-comment">// éå† s çš„é‚»è¾¹</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : graph[s]) {
            <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> edge[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> (inMST[to]) {
                <span class="hljs-comment">// ç›¸é‚»æ¥ç‚¹ to å·²ç»åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸­ï¼Œè·³è¿‡</span>
                <span class="hljs-comment">// å¦åˆ™è¿™æ¡è¾¹ä¼šäº§ç”Ÿç¯</span>
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-comment">// åŠ å…¥æ¨ªåˆ‡è¾¹é˜Ÿåˆ—</span>
            pq.offer(edge);
        }
    }

    <span class="hljs-comment">// æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡å’Œ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">weightSum</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> weightSum;
    }

    <span class="hljs-comment">// åˆ¤æ–­æœ€å°ç”Ÿæˆæ ‘æ˜¯å¦åŒ…å«å›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">allConnected</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; inMST.length; i++) {
            <span class="hljs-keyword">if</span> (!inMST[i]) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>å¤æ‚åº¦åˆ†æï¼š</p>
<p>å¤æ‚åº¦ä¸»è¦åœ¨ä¼˜å…ˆçº§é˜Ÿåˆ— pq çš„æ“ä½œä¸Šï¼Œç”±äº pq é‡Œé¢è£…çš„æ˜¯å›¾ä¸­çš„ã€Œè¾¹ã€ï¼Œå‡è®¾ä¸€å¹…å›¾è¾¹çš„æ¡æ•°ä¸º Eï¼Œé‚£ä¹ˆæœ€å¤šæ“ä½œ O(E) æ¬¡ pqã€‚æ¯æ¬¡æ“ä½œä¼˜å…ˆçº§é˜Ÿåˆ—çš„æ—¶é—´å¤æ‚åº¦å–å†³äºé˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå–æœ€åæƒ…å†µå°±æ˜¯ O(logE)ã€‚</p>
<p>è¿™ç§ Prim ç®—æ³•å®ç°çš„æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ O(ElogE)</p>
<h2 data-id="heading-18">Dijkstra æœ€çŸ­è·¯å¾„è§„åˆ’ç®—æ³•</h2>
<p>ç®—æ³•ç­¾åï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¾“å…¥ä¸€å¹…å›¾å’Œä¸€ä¸ªèµ·ç‚¹ startï¼Œè®¡ç®— start åˆ°å…¶ä»–èŠ‚ç‚¹çš„æœ€çŸ­è·ç¦»</span>
<span class="hljs-type">int</span>[] dijkstra(<span class="hljs-type">int</span> start, List&lt;Integer&gt;[] graph);
</code></pre>
<p>è¾“å…¥æ˜¯ä¸€å¹…å›¾ graph å’Œä¸€ä¸ªèµ·ç‚¹ startï¼Œè¿”å›æ˜¯ä¸€ä¸ªè®°å½•æœ€çŸ­è·¯å¾„æƒé‡çš„æ•°ç»„ã€‚</p>
<p>æ¯”æ–¹è¯´ï¼Œè¾“å…¥èµ·ç‚¹ start = 3ï¼Œå‡½æ•°è¿”å›ä¸€ä¸ª int[] æ•°ç»„ï¼Œå‡è®¾èµ‹å€¼ç»™ distTo å˜é‡ï¼Œé‚£ä¹ˆä»èµ·ç‚¹ 3 åˆ°èŠ‚ç‚¹ 6 çš„æœ€çŸ­è·¯å¾„æƒé‡çš„å€¼å°±æ˜¯ distTo[6]ã€‚æ ‡å‡†çš„ Dijkstra ç®—æ³•ä¼šæŠŠä»èµ·ç‚¹ start åˆ°æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„éƒ½ç®—å‡ºæ¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span> {
    <span class="hljs-comment">// å›¾èŠ‚ç‚¹çš„ id</span>
    <span class="hljs-type">int</span> id;
    <span class="hljs-comment">// ä» start èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·ç¦»</span>
    <span class="hljs-type">int</span> distFromStart;

    State(<span class="hljs-type">int</span> id, <span class="hljs-type">int</span> distFromStart) {
        <span class="hljs-built_in">this</span>.id = id;
        <span class="hljs-built_in">this</span>.distFromStart = distFromStart;
    }
}
</code></pre>
<p>ä½¿ç”¨ distFromStart å˜é‡è®°å½•ä»èµ·ç‚¹ start åˆ°å½“å‰è¿™ä¸ªèŠ‚ç‚¹çš„è·ç¦»ã€‚</p>
<p>æ™®é€š BFS ç®—æ³•ä¸­ï¼Œæ ¹æ® BFS çš„é€»è¾‘å’Œæ— æƒå›¾çš„ç‰¹ç‚¹ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°æŸä¸ªèŠ‚ç‚¹æ‰€èµ°çš„æ­¥æ•°å°±æ˜¯æœ€çŸ­è·ç¦»ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ª visited æ•°ç»„é˜²æ­¢èµ°å›å¤´è·¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªä¼šç»è¿‡ä¸€æ¬¡ã€‚</p>
<p>åŠ æƒå›¾ä¸­çš„ Dijkstra ç®—æ³•å’Œæ— æƒå›¾ä¸­çš„æ™®é€š BFS ç®—æ³•ä¸åŒï¼Œåœ¨ Dijkstra ç®—æ³•ä¸­ï¼Œä½ ç¬¬ä¸€æ¬¡ç»è¿‡æŸä¸ªèŠ‚ç‚¹æ—¶çš„è·¯å¾„æƒé‡ï¼Œä¸è§å¾—å°±æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥å¯¹äºåŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯èƒ½ä¼šç»è¿‡å¤šæ¬¡ï¼Œè€Œä¸”æ¯æ¬¡çš„ distFromStart å¯èƒ½éƒ½ä¸ä¸€æ ·ï¼Œå– distFromStart æœ€å°çš„é‚£æ¬¡ï¼Œå°±æ˜¯ä»èµ·ç‚¹ start åˆ°èŠ‚ç‚¹ 5 çš„æœ€çŸ­è·¯å¾„æƒé‡</p>
<p>Dijkstra å¯ä»¥ç†è§£æˆä¸€ä¸ªå¸¦ dp tableï¼ˆæˆ–è€…è¯´å¤‡å¿˜å½•ï¼‰çš„ BFS ç®—æ³•ï¼Œä¼ªç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿”å›èŠ‚ç‚¹ from åˆ°èŠ‚ç‚¹ to ä¹‹é—´çš„è¾¹çš„æƒé‡</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">weight</span><span class="hljs-params">(<span class="hljs-type">int</span> from, <span class="hljs-type">int</span> to)</span>;

<span class="hljs-comment">// è¾“å…¥èŠ‚ç‚¹ s è¿”å› s çš„ç›¸é‚»èŠ‚ç‚¹</span>
List&lt;Integer&gt; <span class="hljs-title function_">adj</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span>;

<span class="hljs-comment">// è¾“å…¥ä¸€å¹…å›¾å’Œä¸€ä¸ªèµ·ç‚¹ startï¼Œè®¡ç®— start åˆ°å…¶ä»–èŠ‚ç‚¹çš„æœ€çŸ­è·ç¦»</span>
<span class="hljs-type">int</span>[] dijkstra(<span class="hljs-type">int</span> start, List&lt;Integer&gt;[] graph) {
    <span class="hljs-comment">// å›¾ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">V</span> <span class="hljs-operator">=</span> graph.length;
    <span class="hljs-comment">// è®°å½•æœ€çŸ­è·¯å¾„çš„æƒé‡ï¼Œä½ å¯ä»¥ç†è§£ä¸º dp table</span>
    <span class="hljs-comment">// å®šä¹‰ï¼šdistTo[i] çš„å€¼å°±æ˜¯èŠ‚ç‚¹ start åˆ°è¾¾èŠ‚ç‚¹ i çš„æœ€çŸ­è·¯å¾„æƒé‡</span>
    <span class="hljs-type">int</span>[] distTo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[V];
    <span class="hljs-comment">// æ±‚æœ€å°å€¼ï¼Œæ‰€ä»¥ dp table åˆå§‹åŒ–ä¸ºæ­£æ— ç©·</span>
    Arrays.fill(distTo, Integer.MAX_VALUE);
    <span class="hljs-comment">// base caseï¼Œstart åˆ° start çš„æœ€çŸ­è·ç¦»å°±æ˜¯ 0</span>
    distTo[start] = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ŒdistFromStart è¾ƒå°çš„æ’åœ¨å‰é¢</span>
    Queue&lt;State&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; {
        <span class="hljs-keyword">return</span> a.distFromStart - b.distFromStart;
    });

    <span class="hljs-comment">// ä»èµ·ç‚¹ start å¼€å§‹è¿›è¡Œ BFS</span>
    pq.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">State</span>(start, <span class="hljs-number">0</span>));

     <span class="hljs-keyword">while</span> (!pq.isEmpty()) {
        <span class="hljs-type">State</span> <span class="hljs-variable">curState</span> <span class="hljs-operator">=</span> pq.poll();
        <span class="hljs-type">int</span> <span class="hljs-variable">curNodeID</span> <span class="hljs-operator">=</span> curState.id;
        <span class="hljs-type">int</span> <span class="hljs-variable">curDistFromStart</span> <span class="hljs-operator">=</span> curState.distFromStart;

        <span class="hljs-keyword">if</span> (curDistFromStart &gt; distTo[curNodeID]) {
            <span class="hljs-comment">// å·²ç»æœ‰ä¸€æ¡æ›´çŸ­çš„è·¯å¾„åˆ°è¾¾ curNode èŠ‚ç‚¹äº†</span>
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-comment">// å°† curNode çš„ç›¸é‚»èŠ‚ç‚¹è£…å…¥é˜Ÿåˆ—</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> nextNodeID : adj(curNodeID)) {
            <span class="hljs-comment">// çœ‹çœ‹ä» curNode è¾¾åˆ° nextNode çš„è·ç¦»æ˜¯å¦ä¼šæ›´çŸ­</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">distToNextNode</span> <span class="hljs-operator">=</span> distTo[curNodeID] + weight(curNodeID, nextNodeID);
            <span class="hljs-keyword">if</span> (distTo[nextNodeID] &gt; distToNextNode) {
                <span class="hljs-comment">// æ›´æ–° dp table</span>
                distTo[nextNodeID] = distToNextNode;
                <span class="hljs-comment">// å°†è¿™ä¸ªèŠ‚ç‚¹ä»¥åŠè·ç¦»æ”¾å…¥é˜Ÿåˆ—</span>
                pq.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">State</span>(nextNodeID, distToNextNode));
            }
        }
    }
    <span class="hljs-keyword">return</span> distTo;
}
</code></pre>
<p>è®¡ç®—èµ·ç‚¹åˆ°ç»ˆç‚¹endçš„æœ€çŸ­è·ç¦»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¾“å…¥èµ·ç‚¹ start å’Œç»ˆç‚¹ endï¼Œè®¡ç®—èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·ç¦»</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">dijkstra</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, List&lt;Integer&gt;[] graph)</span> {

    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">while</span> (!pq.isEmpty()) {
        <span class="hljs-type">State</span> <span class="hljs-variable">curState</span> <span class="hljs-operator">=</span> pq.poll();
        <span class="hljs-type">int</span> <span class="hljs-variable">curNodeID</span> <span class="hljs-operator">=</span> curState.id;
        <span class="hljs-type">int</span> <span class="hljs-variable">curDistFromStart</span> <span class="hljs-operator">=</span> curState.distFromStart;

        <span class="hljs-comment">// åœ¨è¿™é‡ŒåŠ ä¸€ä¸ªåˆ¤æ–­å°±è¡Œäº†ï¼Œå…¶ä»–ä»£ç ä¸ç”¨æ”¹</span>
        <span class="hljs-keyword">if</span> (curNodeID == end) {
            <span class="hljs-keyword">return</span> curDistFromStart;
        }

        <span class="hljs-keyword">if</span> (curDistFromStart &gt; distTo[curNodeID]) {
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-comment">// å¦‚æœè¿è¡Œåˆ°è¿™é‡Œï¼Œè¯´æ˜ä» start æ— æ³•èµ°åˆ° end</span>
    <span class="hljs-keyword">return</span> Integer.MAX_VALUE;
}
</code></pre>
<h2 data-id="heading-19">A* ç®—æ³•</h2>
<p>Dijkstraç®—æ³•çš„ä¼˜ç‚¹åœ¨äºå…¶ç®€å•å¯é ï¼Œèƒ½å¤Ÿä¿è¯æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚ç„¶è€Œï¼Œå…¶ç¼ºç‚¹ä¹Ÿæ˜æ˜¾ï¼šå¯¹å¤§è§„æ¨¡å›¾çš„å¤„ç†æ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºå®ƒéœ€è¦éå†æ•´ä¸ªå›¾ã€‚</p>
<p>Astar æ˜¯ä¸€ç§ å¹¿æœçš„æ”¹è‰¯ç‰ˆã€‚æœ‰çš„ Astaræ˜¯ dijkstra çš„æ”¹è‰¯ç‰ˆã€‚</p>
<p>å…¶å®åªæ˜¯åœºæ™¯ä¸åŒè€Œå·²ï¼Œåœ¨æœç´¢æœ€çŸ­è·¯çš„æ—¶å€™ï¼Œ å¦‚æœæ˜¯æ— æƒå›¾ï¼ˆè¾¹çš„æƒå€¼éƒ½æ˜¯1ï¼‰ é‚£å°±ç”¨å¹¿æœï¼Œä»£ç ç®€æ´ï¼Œæ—¶é—´æ•ˆç‡å’Œ dijkstra å·®ä¸å¤š ï¼ˆå…·ä½“è¦å–å†³äºå›¾çš„ç¨ å¯†ï¼‰å¦‚æœæ˜¯æœ‰æƒå›¾ï¼ˆè¾¹æœ‰ä¸åŒçš„æƒå€¼ï¼‰ï¼Œä¼˜å…ˆè€ƒè™‘ dijkstraã€‚</p>
<p>è€Œ Astar å…³é”®åœ¨äº å¯å‘å¼å‡½æ•°ï¼Œ ä¹Ÿå°±æ˜¯ å½±å“ å¹¿æœæˆ–è€… dijkstra ä» å®¹å™¨ï¼ˆé˜Ÿåˆ—ï¼‰é‡Œå–å…ƒç´ çš„ä¼˜å…ˆé¡ºåºã€‚</p>
<h3 data-id="heading-20">å®ç°æœºåˆ¶</h3>
<ol>
<li>
<p>å¯å‘å¼æœç´¢çš„ä¼˜åŠ¿
A*ç®—æ³•å¼•å…¥äº†å¯å‘å¼å‡½æ•°h(v)ï¼Œå®ƒé¢„ä¼°äº†ä»èŠ‚ç‚¹våˆ°ç›®æ ‡èŠ‚ç‚¹çš„æœ€ä¼˜è·¯å¾„æˆæœ¬ã€‚è¿™ä½¿å¾—A*èƒ½å¤Ÿåœ¨æœç´¢è¿‡ç¨‹ä¸­å…·æœ‰æ–¹å‘æ€§ï¼Œä¼˜å…ˆæ¢ç´¢é‚£äº›æ›´æœ‰å¯èƒ½å¯¼å‘ç›®æ ‡çš„è·¯å¾„ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„æ¢ç´¢ï¼Œæé«˜æœç´¢æ•ˆç‡ã€‚</p>
</li>
<li>
<p>å®ç°æœºåˆ¶</p>
<ul>
<li>
<p>è¯„ä¼°å‡½æ•°ï¼šA*çš„å…³é”®åœ¨äºf(v)=g(v)+h(v)ï¼Œå…¶ä¸­g(v)æ˜¯ä»èµ·ç‚¹åˆ°èŠ‚ç‚¹vçš„å®é™…æˆæœ¬ï¼Œh(v)æ˜¯å¯å‘å¼å‡½æ•°ï¼Œé€šå¸¸è¡¨ç¤º å½“å‰èŠ‚ç‚¹ åˆ°ç»ˆç‚¹çš„è·ç¦»ã€‚å› æ­¤ä¸¤è€…ç›¸åŠ å°±æ˜¯èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·ç¦»ã€‚</p>
</li>
<li>
<p>å¼€æ”¾ä¸å…³é—­é›†åˆï¼šç®—æ³•ç»´æŠ¤ä¸¤ä¸ªé›†åˆï¼Œå¼€æ”¾é›†åˆå­˜æ”¾å¾…è¯„ä¼°çš„èŠ‚ç‚¹ï¼Œå…³é—­é›†åˆå­˜æ”¾å·²è¯„ä¼°èŠ‚ç‚¹ã€‚æ¯æ¬¡è¿­ä»£ä»å¼€æ”¾é›†åˆä¸­é€‰æ‹©få€¼æœ€å°çš„èŠ‚ç‚¹è¿›è¡Œæ‰©å±•ï¼Œç›´åˆ°ç›®æ ‡èŠ‚ç‚¹è¢«åŠ å…¥å…³é—­é›†åˆã€‚</p>
</li>
</ul>
</li>
</ol>
<p><strong>BFS æ˜¯æ²¡æœ‰ç›®çš„æ€§çš„ ä¸€åœˆä¸€åœˆå»æœç´¢ï¼Œ è€Œ A* æ˜¯æœ‰æ–¹å‘æ€§çš„å»æœç´¢</strong>ã€‚</p>
<p>é‚£ä¹ˆ A* ä¸ºä»€ä¹ˆå¯ä»¥æœ‰æ–¹å‘æ€§çš„å»æœç´¢ï¼Œå®ƒçš„å¦‚ä½•çŸ¥é“æ–¹å‘å‘¢ï¼Ÿ<strong>å…¶å…³é”®åœ¨äº å¯å‘å¼å‡½æ•°</strong>ã€‚</p>
<p>è®¡ç®—ä¸¤ç‚¹è·ç¦»é€šå¸¸æœ‰å¦‚ä¸‹ä¸‰ç§è®¡ç®—æ–¹å¼ï¼šè¿™ä¹Ÿä¸€èˆ¬è¢«é€‰ä¸ºå¯å‘å¼å‡½æ•°ï¼Œç”¨æ¥é¢„ä¼°å½“å‰èŠ‚ç‚¹åˆ°ç»ˆç‚¹çš„è·ç¦»</p>
<ol>
<li>æ›¼å“ˆé¡¿è·ç¦»ï¼Œè®¡ç®—æ–¹å¼ï¼šd = abs(x1-x2)+abs(y1-y2)</li>
<li>æ¬§æ°è·ç¦»ï¼ˆæ¬§æ‹‰è·ç¦»ï¼‰ ï¼Œè®¡ç®—æ–¹å¼ï¼šd = sqrt( (x1-x2)^2 + (y1-y2)^2 )</li>
<li>åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼Œè®¡ç®—æ–¹å¼ï¼šd = max(abs(x1 - x2), abs(y1 - y2))</li>
</ol>
<h3 data-id="heading-21">ä¸Dijkstraçš„å¯¹æ¯”åˆ†æ</h3>
<ul>
<li>è®¡ç®—æ•ˆç‡ï¼šA*ç”±äºé‡‡ç”¨äº†å¯å‘å¼ä¿¡æ¯ï¼Œé€šå¸¸æ¯”Dijkstraç®—æ³•æ›´å¿«æ‰¾åˆ°è§£ï¼Œå°¤å…¶åœ¨å¤æ‚è·¯ç½‘ä¸­æ›´ä¸ºæ˜¾è‘—ã€‚</li>
<li>è·¯å¾„è´¨é‡ï¼šç†è®ºä¸Šï¼Œåªè¦å¯å‘å¼å‡½æ•°æ»¡è¶³å¯æ¥çº³æ€§æ¡ä»¶ï¼ŒA*ä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„ã€‚DijkstraåŒæ ·ä¿è¯æœ€çŸ­è·¯å¾„ï¼Œä½†ç¼ºä¹æ•ˆç‡ä¼˜åŠ¿ã€‚</li>
<li>èµ„æºæ¶ˆè€—ï¼šA*åœ¨å†…å­˜ä½¿ç”¨ä¸Šå¯èƒ½æ›´é«˜ï¼Œå› ä¸ºå®ƒéœ€è¦ç»´æŠ¤å¼€æ”¾é›†åˆå’Œå…³é—­é›†åˆï¼Œè€ŒDijkstraåªéœ€ç»´æŠ¤æœªè®¿é—®é›†åˆå’Œå‰é©±èŠ‚ç‚¹æ˜ å°„ã€‚</li>
<li>é€‚ç”¨åœºæ™¯ï¼šDijkstraé€‚ç”¨äºå°å‹æˆ–ä¸­å‹è§„æ¨¡ã€å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼›A*æ›´é€‚åˆå¤§å‹å›¾æœç´¢æˆ–å¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„æ— åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-22">ä»£ç å®ç°</h3>
<p>å®ç°ä»£ç å¦‚ä¸‹ï¼šå¯å‘å¼å‡½æ•° é‡‡ç”¨ æ¬§æ‹‰è·ç¦»è®¡ç®—æ–¹å¼</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-comment">//è¡¨ç¤ºèŠ‚ç‚¹åœ¨ç½‘æ ¼ä¸­çš„ä½ç½®</span>
    <span class="hljs-type">int</span> x, y;
    <span class="hljs-comment">//gCostè¡¨ç¤ºä»èµ·ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„å®é™…ä»£ä»·ï¼ŒhCostè¡¨ç¤ºä»è¯¥èŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„ä¼°è®¡ä»£ä»·ï¼ˆå¯å‘å¼å€¼ï¼‰ï¼ŒfCostæ˜¯ä¸¤è€…ä¹‹å’Œã€‚</span>
    <span class="hljs-type">double</span> gCost, hCost, fCost;
    <span class="hljs-comment">//ç”¨äºé‡æ„è·¯å¾„</span>
    Node parent;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
        <span class="hljs-built_in">this</span>.x = x;
        <span class="hljs-built_in">this</span>.y = x;
    }

    <span class="hljs-comment">//è®¡ç®—å½“å‰èŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„æ¬§æ‹‰è·ç¦»ã€‚</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateHeuristic</span><span class="hljs-params">(Node target)</span> {
        <span class="hljs-keyword">return</span> Math.sqrt(Math.pow(<span class="hljs-built_in">this</span>.x - target.x, <span class="hljs-number">2</span>) + Math.pow(<span class="hljs-built_in">this</span>.y - target.y, <span class="hljs-number">2</span>));
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateCosts</span><span class="hljs-params">(Node target, <span class="hljs-type">double</span> gCost)</span> {
        <span class="hljs-built_in">this</span>.gCost = gCost;
        <span class="hljs-built_in">this</span>.hCost = calculateHeuristic(target);
        <span class="hljs-built_in">this</span>.fCost = <span class="hljs-built_in">this</span>.gCost + <span class="hljs-built_in">this</span>.hCost;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object obj)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == obj) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span> || getClass() != obj.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> (Node) obj;
        <span class="hljs-keyword">return</span> x == node.x &amp;&amp; y == node.y;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Objects.hash(x, y);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AStar</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span>[][] DIRECTIONS = {{<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}, {-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}, {<span class="hljs-number">0</span>, <span class="hljs-number">1</span>}, {<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>},
            {<span class="hljs-number">1</span>, <span class="hljs-number">1</span>}, {<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>}, {-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>}, {-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>}};

    <span class="hljs-keyword">public</span> List&lt;Node&gt; <span class="hljs-title function_">findPath</span><span class="hljs-params">(Node start, Node target, <span class="hljs-type">int</span>[][] grid)</span> {
        <span class="hljs-comment">//è¡¨ç¤ºå¾…å¤„ç†èŠ‚ç‚¹</span>
        Set&lt;Node&gt; openSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        <span class="hljs-comment">//è¡¨ç¤ºå·²å¤„ç†èŠ‚ç‚¹</span>
        Set&lt;Node&gt; closedSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        <span class="hljs-comment">//ç”¨äºè·å–å…·æœ‰æœ€å°fCostçš„èŠ‚ç‚¹</span>
        PriorityQueue&lt;Node&gt; priorityQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(Comparator.comparingDouble(n -&gt; n.fCost));

        start.updateCosts(target, <span class="hljs-number">0</span>);
        openSet.add(start);
        priorityQueue.add(start);

        <span class="hljs-keyword">while</span> (!openSet.isEmpty()) {
            <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> priorityQueue.poll();
            openSet.remove(current);
            closedSet.add(current);

            <span class="hljs-keyword">if</span> (current.equals(target)) {
                <span class="hljs-keyword">return</span> reconstructPath(current);
            }

            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] direction : DIRECTIONS) {
                <span class="hljs-type">int</span> <span class="hljs-variable">newX</span> <span class="hljs-operator">=</span> current.x + direction[<span class="hljs-number">0</span>];
                <span class="hljs-type">int</span> <span class="hljs-variable">newY</span> <span class="hljs-operator">=</span> current.y + direction[<span class="hljs-number">1</span>];

                <span class="hljs-keyword">if</span> (!isInBounds(newX, newY, grid) || grid[newX][newY] == <span class="hljs-number">1</span>) {
                    <span class="hljs-keyword">continue</span>;
                }

                <span class="hljs-type">Node</span> <span class="hljs-variable">neighbor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(newX, newY);
                <span class="hljs-keyword">if</span> (closedSet.contains(neighbor)) {
                    <span class="hljs-keyword">continue</span>;
                }

                <span class="hljs-type">double</span> <span class="hljs-variable">tentativeGCost</span> <span class="hljs-operator">=</span> current.gCost + current.calculateHeuristic(neighbor);
                <span class="hljs-keyword">if</span> (!openSet.contains(neighbor) || tentativeGCost &lt; neighbor.gCost) {
                    neighbor.updateCosts(target, tentativeGCost);
                    neighbor.parent = current;

                    <span class="hljs-keyword">if</span> (!openSet.contains(neighbor)) {
                        openSet.add(neighbor);
                        priorityQueue.add(neighbor);
                    }
                }
            }
        }
        <span class="hljs-keyword">return</span> Collections.emptyList();
    }

    <span class="hljs-comment">// æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦åœ¨ç½‘æ ¼èŒƒå›´å†…ã€‚</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isInBounds</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span>[][] grid)</span> {
        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; grid.length &amp;&amp; y &lt; grid[<span class="hljs-number">0</span>].length;
    }

    <span class="hljs-comment">//ä»ç›®æ ‡èŠ‚ç‚¹å›æº¯æ„å»ºè·¯å¾„ã€‚</span>
    <span class="hljs-keyword">private</span> List&lt;Node&gt; <span class="hljs-title function_">reconstructPath</span><span class="hljs-params">(Node node)</span> {
        List&lt;Node&gt; path = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">while</span> (node != <span class="hljs-literal">null</span>) {
            path.add(node);
            node = node.parent;
        }
        Collections.reverse(path);
        <span class="hljs-keyword">return</span> path;
    }
}
</code></pre>
<h3 data-id="heading-23">å¤æ‚åº¦åˆ†æ</h3>
<p>A* ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ å…¶å®æ˜¯ä¸å¥½å»é‡åŒ–çš„ï¼Œå› ä¸ºä»–å–å†³äº å¯å‘å¼å‡½æ•°æ€ä¹ˆå†™ã€‚</p>
<ul>
<li>
<p>æœ€åæƒ…å†µä¸‹ï¼ŒA* é€€åŒ–æˆå¹¿æœï¼Œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ æ˜¯ O(n * 2)ï¼Œn ä¸ºèŠ‚ç‚¹æ•°é‡ã€‚</p>
</li>
<li>
<p>æœ€ä½³æƒ…å†µï¼Œæ˜¯ä»èµ·ç‚¹ç›´æ¥åˆ°ç»ˆç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(dlogd)ï¼Œd ä¸ºèµ·ç‚¹åˆ°ç»ˆç‚¹çš„æ·±åº¦ã€‚å› ä¸ºåœ¨æœç´¢çš„è¿‡ç¨‹ä¸­ä¹Ÿéœ€è¦å †æ’åºï¼Œæ‰€ä»¥æ˜¯ O(dlogd)ã€‚</p>
</li>
</ul>
<p>å®é™…ä¸Š A* çš„æ—¶é—´å¤æ‚åº¦æ˜¯ä»‹äº æœ€ä¼˜ å’Œæœ€å æƒ…å†µä¹‹é—´ï¼Œ å¯ä»¥ éå¸¸ç²—ç•¥çš„è®¤ä¸º A* ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogn) ï¼Œn ä¸ºèŠ‚ç‚¹æ•°é‡ã€‚</p>
<p>A* ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ O(b ^ d) ,d ä¸ºèµ·ç‚¹åˆ°ç»ˆç‚¹çš„æ·±åº¦ï¼Œb æ˜¯ å›¾ä¸­èŠ‚ç‚¹é—´çš„è¿æ¥æ•°é‡</p>
<h3 data-id="heading-24">A* çš„ç¼ºç‚¹</h3>
<p>å¤§å®¶çœ‹ä¸Šè¿° A * ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ° æˆ‘ä»¬å‘é˜Ÿåˆ—é‡Œæ·»åŠ äº†å¾ˆå¤šèŠ‚ç‚¹ï¼Œä½†çœŸæ­£ä»é˜Ÿåˆ—é‡Œå–å‡ºæ¥çš„ ä»…ä»…æ˜¯ é å¯å‘å¼å‡½æ•°åˆ¤æ–­ è·ç¦»ç»ˆç‚¹æœ€è¿‘çš„èŠ‚ç‚¹ã€‚</p>
<p>ç›¸å¯¹äºæ™®é€šBFSï¼ŒA* ç®—æ³•åªä» é˜Ÿåˆ—é‡Œå–å‡º è·ç¦»ç»ˆç‚¹æœ€è¿‘çš„èŠ‚ç‚¹ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒA* åœ¨ä¸€æ¬¡è·¯å¾„æœç´¢ä¸­ï¼Œå¤§é‡ä¸éœ€è¦è®¿é—®çš„èŠ‚ç‚¹éƒ½åœ¨é˜Ÿåˆ—é‡Œï¼Œä¼šé€ æˆç©ºé—´çš„è¿‡åº¦æ¶ˆè€—ã€‚</p>
<p>IDA* ç®—æ³•å¯¹è¿™ä¸€ç©ºé—´å¢é•¿é—®é¢˜è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå…³äº IDA* ç®—æ³•ï¼Œåç»­å†æ›´æ–° //to do</p>
<p>å¦å¤–è¿˜æœ‰ä¸€ç§åœºæ™¯ æ˜¯ A* è§£å†³ä¸äº†çš„ã€‚</p>
<p>å¦‚æœç»™å‡ºå¤šä¸ªå¯èƒ½çš„ç›®æ ‡ï¼Œç„¶ååœ¨è¿™å¤šä¸ªç›®æ ‡ä¸­é€‰æ‹©æœ€è¿‘çš„ç›®æ ‡ï¼Œè¿™ç§ A* å°±ä¸æ“…é•¿äº†ï¼Œ A* åªæ“…é•¿ç»™å‡ºæ˜ç¡®çš„ç›®æ ‡ ç„¶åæ‰¾åˆ°æœ€çŸ­è·¯å¾„ã€‚</p>
<p>å¦‚æœæ˜¯å¤šä¸ªç›®æ ‡æ‰¾æœ€è¿‘ç›®æ ‡ï¼ˆç‰¹åˆ«æ˜¯æ½œåœ¨ç›®æ ‡æ•°é‡å¾ˆå¤šçš„æ—¶å€™ï¼‰ï¼Œå¯ä»¥è€ƒè™‘ Dijkstra ï¼ŒBFS æˆ–è€… Floydã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®è®¡ç®—æ¡†æ¶-æµå¼è®¡ç®—çš„Join]]></title>    <link>https://juejin.cn/post/7585920796099362843</link>    <guid>https://juejin.cn/post/7585920796099362843</guid>    <pubDate>2025-12-22T00:03:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585920796099362843" data-draft-id="7585839411122339886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®è®¡ç®—æ¡†æ¶-æµå¼è®¡ç®—çš„Join"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-22T00:03:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®è®¡ç®—æ¡†æ¶-æµå¼è®¡ç®—çš„Join
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-22T00:03:43.000Z" title="Mon Dec 22 2025 00:03:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šæµå¼Joinä¸­è‹¥AæœªåŒ¹é…åˆ°Bï¼Œå¯ä¸¢å¼ƒã€ç”¨Outer Joinä¿ç•™ã€å»¶é•¿ç­‰å¾…æ—¶é—´ï¼Œæˆ–é€šè¿‡è‡ªå®šä¹‰å‡½æ•°+å®šæ—¶å™¨å¤„ç†è¶…æ—¶ï¼Œä¹Ÿå¯å°†æœªåŒ¹é…äº‹ä»¶é€å…¥DLQå…œåº•ã€‚</p>
<p>åœ¨æµå¼è®¡ç®—æ¡†æ¶ï¼ˆå¦‚ Apache Flinkã€Apache Kafka Streamsã€Apache Spark Structured Streaming ç­‰ï¼‰ä¸­ï¼Œè¿›è¡Œ <strong>çª—å£å†…çš„ Join æ“ä½œ</strong>ï¼ˆä¾‹å¦‚ Windowed Join æˆ– Interval Joinï¼‰æ—¶ï¼Œå¦‚æœä¸€ä¸ªæµä¸­çš„äº‹ä»¶ A åœ¨æŒ‡å®šçš„çª—å£æˆ–æ—¶é—´èŒƒå›´å†…æ²¡æœ‰åŒ¹é…åˆ°å¦ä¸€ä¸ªæµä¸­çš„äº‹ä»¶ Bï¼Œé€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§å¤„ç†ç­–ç•¥ï¼Œå…·ä½“å–å†³äºä½ ä½¿ç”¨çš„æ¡†æ¶å’Œä¸šåŠ¡éœ€æ±‚ï¼š</p>
<hr/>
<h3 data-id="heading-0">1. <strong>ä¸¢å¼ƒæœªåŒ¹é…çš„äº‹ä»¶ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</strong></h3>
<p>å¤§å¤šæ•°æµå¼ Join æ“ä½œï¼ˆå°¤å…¶æ˜¯ Inner Joinï¼‰<strong>åªè¾“å‡ºåŒ¹é…æˆåŠŸçš„è®°å½•å¯¹</strong>ã€‚</p>
<ul>
<li>å¦‚æœ A åœ¨çª—å£å†…æ²¡æœ‰å¯¹åº”çš„ Bï¼Œåˆ™ A ä¸ä¼šå‡ºç°åœ¨è¾“å‡ºç»“æœä¸­ã€‚</li>
<li>è¿™æ˜¯æœ€å¸¸è§çš„é»˜è®¤è¡Œä¸ºï¼Œé€‚ç”¨äºâ€œåªå…³å¿ƒæˆå¯¹äº‹ä»¶â€çš„åœºæ™¯ã€‚</li>
</ul>
<blockquote>
<p>ç¤ºä¾‹ï¼šFlink çš„ <code>window join</code> é»˜è®¤æ˜¯ inner joinï¼Œä¸åŒ¹é…å°±ä¸¢å¼ƒã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">2. <strong>ä½¿ç”¨ Outer Joinï¼ˆå·¦/å³/å…¨å¤–è¿æ¥ï¼‰</strong></h3>
<p>éƒ¨åˆ†æ¡†æ¶æ”¯æŒ <strong>Outer Join</strong> è¯­ä¹‰ï¼Œå¯ä»¥åœ¨æ²¡æœ‰åŒ¹é…é¡¹æ—¶ä¿ç•™ä¸€ä¾§çš„äº‹ä»¶ï¼Œå¹¶ç”¨ null å¡«å……å¦ä¸€ä¾§ã€‚</p>
<ul>
<li><strong>Flink</strong>ï¼šåŸç”Ÿçª—å£ Join ä¸ç›´æ¥æ”¯æŒ outer joinï¼Œä½†å¯ä»¥é€šè¿‡ <strong>CoProcessFunction + çŠ¶æ€ + å®šæ—¶å™¨</strong> æ‰‹åŠ¨å®ç°ã€‚</li>
<li><strong>Kafka Streams</strong>ï¼šæ”¯æŒ <code>leftJoin</code> / <code>outerJoin</code>ï¼Œå¯ä»¥ä¿ç•™å·¦ä¾§æµä¸­æœªåŒ¹é…çš„è®°å½•ã€‚</li>
<li><strong>Spark Structured Streaming</strong>ï¼šä» 3.0+ å¼€å§‹æ”¯æŒ <strong>stream-stream outer join</strong>ï¼ˆéœ€å¯ç”¨ watermark å’ŒçŠ¶æ€ç®¡ç†ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ç¤ºä¾‹ï¼ˆKafka Streamsï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css">streamA<span class="hljs-selector-class">.leftJoin</span>(streamB, (<span class="hljs-selector-tag">a</span>, <span class="hljs-selector-tag">b</span>) -&gt; <span class="hljs-selector-tag">b</span> == null ? handleUnmatchedA(<span class="hljs-selector-tag">a</span>) : <span class="hljs-built_in">merge</span>(a, b), windows);
</code></pre>
</blockquote>
<hr/>
<h3 data-id="heading-2">3. <strong>å»¶è¿Ÿè§¦å‘ + Watermark æœºåˆ¶</strong></h3>
<p>æµå¼ç³»ç»Ÿå¸¸ä½¿ç”¨ <strong>Watermark</strong> æ¥åˆ¤æ–­â€œäº‹ä»¶æ˜¯å¦è¿Ÿåˆ°â€ä»¥åŠâ€œçª—å£æ˜¯å¦å¯ä»¥å…³é—­â€ã€‚</p>
<ul>
<li>å¦‚æœ B å¯èƒ½ç¨æ™šåˆ°è¾¾ï¼Œå¯é€‚å½“ <strong>å¢å¤§çª—å£å¤§å°æˆ–å…è®¸å»¶è¿Ÿï¼ˆallowedLatenessï¼‰</strong> ã€‚</li>
<li>ä½†è‹¥è¶…è¿‡æœ€å¤§ç­‰å¾…æ—¶é—´ä»æœªåŒ¹é…ï¼Œç³»ç»Ÿä»ä¼šå…³é—­çª—å£å¹¶ä¸¢å¼ƒ Aï¼ˆé™¤éä½¿ç”¨ outer joinï¼‰ã€‚</li>
</ul>
<blockquote>
<p>Watermark æ˜¯æµå¼è®¡ç®—ä¸­ç”¨äºå¤„ç†<strong>äº‹ä»¶æ—¶é—´ï¼ˆEvent Timeï¼‰ä¹±åº</strong>çš„æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ç§<strong>å¸¦æœ‰æ—¶é—´æˆ³çš„ç‰¹æ®Šä¿¡å·</strong>ï¼Œè¡¨ç¤ºâ€œåœ¨æ­¤ Watermark æ—¶é—´ä¹‹å‰çš„æ‰€æœ‰äº‹ä»¶éƒ½å·²åˆ°è¾¾â€ã€‚ç³»ç»Ÿä¾æ® Watermark åˆ¤æ–­çª—å£æ˜¯å¦å¯ä»¥å…³é—­å¹¶è§¦å‘è®¡ç®—ï¼Œä»è€Œåœ¨å®¹å¿ä¸€å®šä¹±åºçš„åŒæ—¶ä¿è¯ç»“æœçš„æ­£ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">4. <strong>è‡ªå®šä¹‰é€»è¾‘ï¼šç”¨ ProcessFunction / CoProcessFunction å®ç°</strong></h3>
<p>å¯¹äºæ›´å¤æ‚çš„è¯­ä¹‰ï¼ˆå¦‚â€œç­‰ 5 åˆ†é’Ÿæ²¡ç­‰åˆ° B å°±å•ç‹¬å¤„ç† Aâ€ï¼‰ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>KeyedCoProcessFunction</strong>ï¼ˆFlinkï¼‰æˆ–ç±»ä¼¼ä½é˜¶ APIã€‚</li>
<li>å°† A å­˜å…¥çŠ¶æ€ï¼ˆStateï¼‰ï¼Œæ³¨å†Œå®šæ—¶å™¨ï¼ˆTimerï¼‰ã€‚</li>
<li>è‹¥å®šæ—¶å™¨è§¦å‘æ—¶ä»æœªæ”¶åˆ° Bï¼Œåˆ™å•ç‹¬è¾“å‡º Aï¼ˆå¦‚å†™å…¥â€œæœªåŒ¹é…â€æ—¥å¿—ã€å‘Šè­¦ã€é™çº§å¤„ç†ç­‰ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ç¤ºä¾‹æ€è·¯ï¼ˆFlinkï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UnmatchedHandler</span> <span class="hljs-title">extends</span> <span class="hljs-title">KeyedCoProcessFunction</span>&lt;<span class="hljs-title">String</span>, <span class="hljs-title">EventA</span>, <span class="hljs-title">EventB</span>, <span class="hljs-title">Output</span>&gt; {
    ValueState&lt;EventA&gt; aState;
    
    @Override
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processElement1</span>(<span class="hljs-params">EventA a, Context ctx, Collector&lt;Output&gt; <span class="hljs-keyword">out</span></span>)</span> {
        aState.update(a);
        ctx.timerService().registerEventTimeTimer(ctx.timestamp() + <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>); <span class="hljs-comment">// ç­‰5åˆ†é’Ÿ</span>
    }
    
    @Override
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processElement2</span>(<span class="hljs-params">EventB b, Context ctx, Collector&lt;Output&gt; <span class="hljs-keyword">out</span></span>)</span> {
        EventA a = aState.<span class="hljs-keyword">value</span>();
        <span class="hljs-keyword">if</span> (a != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">out</span>.collect(merge(a, b));
            aState.clear();
        }
    }
    
    @Override
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onTimer</span>(<span class="hljs-params"><span class="hljs-built_in">long</span> timestamp, OnTimerContext ctx, Collector&lt;Output&gt; <span class="hljs-keyword">out</span></span>)</span> {
        EventA a = aState.<span class="hljs-keyword">value</span>();
        <span class="hljs-keyword">if</span> (a != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">out</span>.collect(handleUnmatched(a)); <span class="hljs-comment">// å•ç‹¬å¤„ç†æœªåŒ¹é…çš„A</span>
            aState.clear();
        }
    }
}
</code></pre>
</blockquote>
<hr/>
<h3 data-id="heading-4">5. <strong>ä¸šåŠ¡å±‚é¢å…œåº•</strong></h3>
<ul>
<li>å°†æœªåŒ¹é…çš„ A å†™å…¥ <strong>æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰</strong> æˆ– <strong>å¼‚å¸¸æµ</strong>ï¼Œä¾›åç»­æ‰¹å¤„ç†è¡¥å¿ã€‚</li>
<li>è§¦å‘ <strong>å‘Šè­¦æˆ–ç›‘æ§æŒ‡æ ‡</strong>ï¼Œæç¤ºæ•°æ®ä¸ä¸€è‡´æˆ–ä¸Šæ¸¸é—®é¢˜ã€‚</li>
</ul>
<blockquote>
<p>DLQï¼ˆDead Letter Queueï¼Œæ­»ä¿¡é˜Ÿåˆ—ï¼‰ç”¨äºå­˜æ”¾æ— æ³•æ­£å¸¸å¤„ç†çš„æ¶ˆæ¯ï¼ˆå¦‚æ ¼å¼é”™è¯¯ã€é‡è¯•å¤±è´¥æˆ–æœªåŒ¹é…äº‹ä»¶ï¼‰ï¼Œé˜²æ­¢ç³»ç»Ÿé˜»å¡ï¼Œä¾¿äºåç»­æ’æŸ¥ã€é‡æ”¾æˆ–è¡¥å¿å¤„ç†ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">æ€»ç»“</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>åªè¦æˆå¯¹æ•°æ®</td><td>é»˜è®¤ inner joinï¼Œä¸¢å¼ƒæœªåŒ¹é…é¡¹</td></tr><tr><td>éœ€ä¿ç•™ Aï¼ˆå³ä½¿æ—  Bï¼‰</td><td>ä½¿ç”¨ left/outer joinï¼ˆè‹¥æ¡†æ¶æ”¯æŒï¼‰</td></tr><tr><td>éœ€å»¶è¿Ÿç­‰å¾… B</td><td>è°ƒæ•´çª—å£å¤§å° + allowedLateness</td></tr><tr><td>å¤æ‚è¶…æ—¶é€»è¾‘</td><td>è‡ªå®šä¹‰ CoProcessFunction + Timer</td></tr><tr><td>å®¹é”™ä¸ç›‘æ§</td><td>è¾“å‡ºæœªåŒ¹é…äº‹ä»¶åˆ° DLQ + å‘Šè­¦</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»€ä¹ˆ?è¿˜ä¸çŸ¥é“git cherry pickï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585727457473101824</link>    <guid>https://juejin.cn/post/7585727457473101824</guid>    <pubDate>2025-12-21T17:40:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457473101824" data-draft-id="7585555806668259362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»€ä¹ˆ?è¿˜ä¸çŸ¥é“git cherry pickï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Git"/> <meta itemprop="datePublished" content="2025-12-21T17:40:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°‘å¹´å§œå¤ªå…¬"/> <meta itemprop="url" content="https://juejin.cn/user/4334729370542980"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»€ä¹ˆ?è¿˜ä¸çŸ¥é“git cherry pickï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4334729370542980/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°‘å¹´å§œå¤ªå…¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T17:40:31.000Z" title="Sun Dec 21 2025 17:40:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>ä¸Šå‘¨å››åœ¨å…¬å¸å¼€å‘ä»£ç æ—¶ï¼Œä¸€ä¸‹æ²¡æ³¨æ„ä»æµ‹è¯•åˆ†æ”¯<code>dev</code>ä¸Šæ‹‰äº†ä»£ç å¹¶è¿›è¡Œå¼€å‘ï¼Œæœ€åè¦ä¸Šçº¿çš„æ—¶å€™æ‰çŒ›ç„¶å‘ç°åˆ†æ”¯æ‹‰é”™äº†ï¼Œä¸€çœ‹gitLabä¸Šæ”¹äº†å‡ åä¸ªæ–‡ä»¶ï¼Œå†ä¸€æŸ¥å‘ç°è‡ªå·±æ‹‰ä»£ç æ‹‰é”™äº†ğŸ˜­ğŸ˜­ğŸ˜­ï¼Œæœ¬æ¥éƒ½å‡†å¤‡ä¸‹ç­äº†ï¼Œç»“æœç¡¬æ˜¯æ–°å»ºäº†ä¸€ä¸ªåˆ†æ”¯ï¼ŒæŠŠå››äº”ä¸ªæ–‡ä»¶è¿‘1000è¡Œä»£ç ä¸€ç‚¹ä¸€ç‚¹cvåˆ°æ–°åˆ†æ”¯ä¸Šï¼Œç»“æœæå®Œä¸€æŸ¥æ‰å‘ç°gitæœ‰ä¸ªcherry pickçš„å‘½ä»¤å¯ä»¥ç›´æ¥æå®Œï¼Œå¸Œæœ›jymçœ‹å®Œè¿™ç¯‡æ–‡ç« ä»¥åä¸è¦åƒæˆ‘ä¸€æ ·åšè¿™ç§ä¸€ç‚¹ä¸€ç‚¹cvçš„è ¢äº‹äº†ğŸ˜­ğŸ˜­ğŸ˜­</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯cherry pick</h3>
<p><code>cherry pick</code>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æ¨±æ¡ƒé‡‡æ‘˜ï¼Œåªé‡‡æ‘˜ä½ æƒ³è¦çš„é‚£ä¸€é¢—ï¼Œå¤šä¸€ä¸ªéƒ½ä¸è¦ï¼Œä»–ä¸»è¦çš„ä½œç”¨å°±æ˜¯å¯ä»¥å°†æŸä¸ªåˆ†æ”¯ä¸Šçš„commitä»£ç ï¼Œç§»æ¤åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ä¸Šã€‚</p>
<h3 data-id="heading-2">ç”¨æ³•</h3>
<ul>
<li>git cherry-pick 
commit</li>
</ul>
<p>å”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯ä»–çš„commit-idï¼Œå¦‚æœä¸çŸ¥é“æ€ä¹ˆæŸ¥çœ‹çš„è¯å¯ä»¥ç”¨<code>git log </code>æ¥è¿›è¡ŒæŸ¥çœ‹<code>commit-id</code>ï¼Œå½“æ‰§è¡Œå®Œ<code>cherry pick</code>ä»¥åï¼Œä»–ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„commitï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ–°çš„commit-idï¼Œè¿™ä¸ªæäº¤çš„commitå’ŒåŸæ¥çš„ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯è¿™ä¸ª<code>commit-id</code>ä¸ä¸€æ ·ã€‚</p>
<h3 data-id="heading-3">å›¾è§£</h3>
<p align="right">    </p>
<p align="right"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/194901a305cf4a8ab8f80ee9cf1e33b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCR5bm05aec5aSq5YWs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766943630&amp;x-signature=sOkOZFI3iay2frz6Sc%2BHzHe2VbA%3D" alt="image.png" width="50%" loading="lazy"/></p>
<p align="right"> </p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åˆ†æ”¯Aï¼Œåœ¨Aä¸Šé¢è¿›è¡Œäº†ä¸€æ¬¡æäº¤Bï¼Œåœ¨Aåé¢æäº¤äº†ä¸‰æ¬¡ï¼Œåˆ†åˆ«æ˜¯<code>add f1,add f2 ,fix bug</code> ï¼Œä½†æ˜¯æœ€åç»è¿‡æŸ¥çœ‹å‘ç°è¿™ä¸ªbugåœ¨Aåˆ†æ”¯çš„Bé‡Œé¢ï¼Œå› ä¸ºåœ¨masteråˆ†æ”¯ä¸Šè¿˜æœ‰å…¶ä»–çš„æäº¤ï¼Œæ‰€ä»¥è¿™ç§æˆ‘ä»¬è‚¯å®šä¸èƒ½è¯´ç›´æ¥git mergeä¸€ä¸‹ï¼Œç»™ä»–mergeåˆ°Bä¸Šé¢ï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å°±å¯ä»¥å…ˆåˆ‡æ¢åˆ°Aåˆ†æ”¯ä¸Šï¼Œç„¶åç”¨<code>git cherry-pick &lt;fix-bug-commit-id&gt;</code>å»æŠŠä»–åˆšç»™æäº¤åˆ°Båé¢</p>
<h3 data-id="heading-4">å°ç»“</h3>
<p>æœ€åå°ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯å½“æˆ‘ä»¬æƒ³è¦åˆå¹¶æŸäº›å†…å®¹ï¼Œä½†æ˜¯åˆä¸æƒ³åŒ…å«æ•´ä¸ªåˆ†æ”¯çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨cherry-pickäº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonå…¥é—¨æŒ‡å—(å…­) - æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªYOLOæ£€æµ‹API]]></title>    <link>https://juejin.cn/post/7585789195869012004</link>    <guid>https://juejin.cn/post/7585789195869012004</guid>    <pubDate>2025-12-21T16:10:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585789195869012004" data-draft-id="7585758163436109830" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonå…¥é—¨æŒ‡å—(å…­) - æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªYOLOæ£€æµ‹API"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½,Python"/> <meta itemprop="datePublished" content="2025-12-21T16:10:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´ä½³æµ©"/> <meta itemprop="url" content="https://juejin.cn/user/2696441245481975"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonå…¥é—¨æŒ‡å—(å…­) - æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªYOLOæ£€æµ‹API
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2696441245481975/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´ä½³æµ©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T16:10:09.000Z" title="Sun Dec 21 2025 16:10:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-dune-dark">.hljs-comment,.hljs-quote{color:#999580}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d73737}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#b65611}.hljs-bullet,.hljs-string,.hljs-symbol{color:#60ac39}.hljs-section,.hljs-title{color:#6684e1}.hljs-keyword,.hljs-selector-tag{color:#b854d4}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#20201d;color:#a6a28c}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Pythonå…¥é—¨æŒ‡å—(å…­) - æ­å»ºä½ çš„ç¬¬ä¸€ä¸ªYOLOæ£€æµ‹API</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06491288ade342dbaf4fa3d097b4c3e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766938209&amp;x-signature=frRTpQ66O8sr5UTEtEm%2FhmLLcBc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ¬¢è¿æ¥åˆ°Pythonå…¥é—¨æŒ‡å—çš„ç¬¬å…­éƒ¨åˆ†ï¼åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥äº†è§£äº†FastAPIçš„ä¼˜åŠ¿ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åŠ¨æ‰‹å®æˆ˜â€”â€”ä½¿ç”¨FastAPIå’ŒUltralytics YOLOæ„å»ºä¸€ä¸ªçœŸæ­£å¯ç”¨çš„ç›®æ ‡æ£€æµ‹APIæœåŠ¡ã€‚</p>
<p>æœ¬ç« å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥æ­¥æ­å»ºä¸€ä¸ªå®Œæ•´çš„AIæ£€æµ‹æœåŠ¡ï¼ŒåŒ…æ‹¬å›¾ç‰‡ä¸Šä¼ ã€æ¨¡å‹æ¨ç†ã€ç»“æœè¿”å›å’Œå¯è§†åŒ–ã€‚
<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_43712047%2Farticle%2Fdetails%2F156136555%3Fspm%3D1011.2124.3001.6209" target="_blank" title="https://blog.csdn.net/weixin_43712047/article/details/156136555?spm=1011.2124.3001.6209" ref="nofollow noopener noreferrer">csdn&amp;æ˜é‡‘åŒæ­¥å‘å¸ƒ</a></p>
<hr/>
<h3 data-id="heading-1"><strong>æœ¬ç« ç›®æ ‡</strong></h3>
<p>å®Œæˆæœ¬ç« å­¦ä¹ åï¼Œä½ å°†èƒ½å¤Ÿï¼š</p>
<ul>
<li>âœ… æ­å»ºFastAPIé¡¹ç›®ç»“æ„</li>
<li>âœ… é›†æˆUltralytics YOLOæ¨¡å‹</li>
<li>âœ… å®ç°å›¾ç‰‡ä¸Šä¼ å’Œæ£€æµ‹åŠŸèƒ½</li>
<li>âœ… è¿”å›JSONæ ¼å¼çš„æ£€æµ‹ç»“æœ</li>
<li>âœ… ç”Ÿæˆå¸¦æ ‡æ³¨çš„æ£€æµ‹å›¾ç‰‡</li>
<li>âœ… ä½¿ç”¨Swagger UIæµ‹è¯•API</li>
</ul>
<hr/>
<h3 data-id="heading-2"><strong>ç¯å¢ƒå‡†å¤‡</strong></h3>
<h4 data-id="heading-3"><strong>1. å®‰è£…ä¾èµ–åŒ…</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰</span>
python -m venv venv
<span class="hljs-built_in">source</span> venv/bin/activate  <span class="hljs-comment"># Windows: venv\Scripts\activate</span>

<span class="hljs-comment"># å®‰è£…æ ¸å¿ƒä¾èµ–</span>
pip install fastapi uvicorn python-multipart
pip install ultralytics
pip install pillow opencv-python
</code></pre>
<p><strong>ä¾èµ–è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>fastapi</code>: Webæ¡†æ¶æ ¸å¿ƒ</li>
<li><code>uvicorn</code>: ASGIæœåŠ¡å™¨</li>
<li><code>python-multipart</code>: å¤„ç†æ–‡ä»¶ä¸Šä¼ </li>
<li><code>ultralytics</code>: YOLOæ¨¡å‹åº“</li>
<li><code>pillow</code>: å›¾ç‰‡å¤„ç†</li>
<li><code>opencv-python</code>: å›¾åƒç»˜åˆ¶å’Œå¤„ç†</li>
</ul>
<h4 data-id="heading-4"><strong>2. ä¸‹è½½YOLOæ¨¡å‹</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># download_model.py</span>
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

<span class="hljs-comment"># ä¸‹è½½YOLOv8næ¨¡å‹ï¼ˆæœ€è½»é‡çº§ï¼‰</span>
model = YOLO(<span class="hljs-string">'yolov8n.pt'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹ä¸‹è½½å®Œæˆï¼"</span>)
</code></pre>
<p>è¿è¡Œä¸‹è½½è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python download_model.py
</code></pre>
<hr/>
<h3 data-id="heading-5"><strong>é¡¹ç›®ç»“æ„è®¾è®¡</strong></h3>
<p>åˆ›å»ºæ¸…æ™°çš„é¡¹ç›®ç»“æ„æ˜¯æˆåŠŸçš„ç¬¬ä¸€æ­¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">    yolo-detection-api/
    â”œâ”€â”€ app/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ main.py              <span class="hljs-comment"># FastAPIåº”ç”¨å…¥å£</span>
    â”‚   â”œâ”€â”€ models.py            <span class="hljs-comment"># Pydanticæ•°æ®æ¨¡å‹</span>
    â”‚   â”œâ”€â”€ detector.py          <span class="hljs-comment"># YOLOæ£€æµ‹é€»è¾‘</span>
    â”‚   â””â”€â”€ utils.py             <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
    â”œâ”€â”€ models/
    â”‚   â””â”€â”€ yolov8n.pt           <span class="hljs-comment"># YOLOæ¨¡å‹æ–‡ä»¶</span>
    â”œâ”€â”€ uploads/                 <span class="hljs-comment"># ä¸´æ—¶ä¸Šä¼ ç›®å½•</span>
    â”œâ”€â”€ outputs/                 <span class="hljs-comment"># æ£€æµ‹ç»“æœè¾“å‡ºç›®å½•</span>
    â”œâ”€â”€ requirements.txt         <span class="hljs-comment"># ä¾èµ–åˆ—è¡¨</span>
    â””â”€â”€ README.md
</code></pre>
<p>åˆ›å»ºé¡¹ç›®ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p yolo-detection-api/app
<span class="hljs-built_in">mkdir</span> -p yolo-detection-api/models
<span class="hljs-built_in">mkdir</span> -p yolo-detection-api/uploads
<span class="hljs-built_in">mkdir</span> -p yolo-detection-api/outputs
<span class="hljs-built_in">cd</span> yolo-detection-api
</code></pre>
<hr/>
<h3 data-id="heading-6"><strong>æ ¸å¿ƒä»£ç å®ç°</strong></h3>
<h4 data-id="heading-7"><strong>Step 1: å®šä¹‰æ•°æ®æ¨¡å‹ï¼ˆmodels.pyï¼‰</strong></h4>
<p>ä½¿ç”¨Pydanticå®šä¹‰APIçš„è¾“å…¥è¾“å‡ºæ ¼å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/models.py</span>
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionBox</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-string">"""å•ä¸ªæ£€æµ‹æ¡†çš„æ•°æ®ç»“æ„"""</span>
    class_name: <span class="hljs-built_in">str</span> = Field(..., description=<span class="hljs-string">"æ£€æµ‹åˆ°çš„ç‰©ä½“ç±»åˆ«"</span>)
    confidence: <span class="hljs-built_in">float</span> = Field(..., ge=<span class="hljs-number">0</span>, le=<span class="hljs-number">1</span>, description=<span class="hljs-string">"ç½®ä¿¡åº¦(0-1)"</span>)
    bbox: <span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>] = Field(..., description=<span class="hljs-string">"è¾¹ç•Œæ¡†åæ ‡[x1, y1, x2, y2]"</span>)
    
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
        json_schema_extra = {
            <span class="hljs-string">"example"</span>: {
                <span class="hljs-string">"class_name"</span>: <span class="hljs-string">"person"</span>,
                <span class="hljs-string">"confidence"</span>: <span class="hljs-number">0.95</span>,
                <span class="hljs-string">"bbox"</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">300</span>, <span class="hljs-number">450</span>]
            }
        }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionResponse</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-string">"""æ£€æµ‹ç»“æœå“åº”"""</span>
    success: <span class="hljs-built_in">bool</span> = Field(..., description=<span class="hljs-string">"æ£€æµ‹æ˜¯å¦æˆåŠŸ"</span>)
    image_size: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>] = Field(..., description=<span class="hljs-string">"å›¾ç‰‡å°ºå¯¸[width, height]"</span>)
    detections: <span class="hljs-type">List</span>[DetectionBox] = Field(..., description=<span class="hljs-string">"æ£€æµ‹åˆ°çš„æ‰€æœ‰ç›®æ ‡"</span>)
    detection_count: <span class="hljs-built_in">int</span> = Field(..., description=<span class="hljs-string">"æ£€æµ‹åˆ°çš„ç›®æ ‡æ•°é‡"</span>)
    inference_time: <span class="hljs-built_in">float</span> = Field(..., description=<span class="hljs-string">"æ¨ç†è€—æ—¶(ç§’)"</span>)
    annotated_image_url: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(<span class="hljs-literal">None</span>, description=<span class="hljs-string">"æ ‡æ³¨å›¾ç‰‡URL"</span>)
    
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
        json_schema_extra = {
            <span class="hljs-string">"example"</span>: {
                <span class="hljs-string">"success"</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">"image_size"</span>: [<span class="hljs-number">640</span>, <span class="hljs-number">480</span>],
                <span class="hljs-string">"detections"</span>: [
                    {
                        <span class="hljs-string">"class_name"</span>: <span class="hljs-string">"person"</span>,
                        <span class="hljs-string">"confidence"</span>: <span class="hljs-number">0.95</span>,
                        <span class="hljs-string">"bbox"</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">300</span>, <span class="hljs-number">450</span>]
                    }
                ],
                <span class="hljs-string">"detection_count"</span>: <span class="hljs-number">1</span>,
                <span class="hljs-string">"inference_time"</span>: <span class="hljs-number">0.023</span>,
                <span class="hljs-string">"annotated_image_url"</span>: <span class="hljs-string">"/outputs/result_123.jpg"</span>
            }
        }
</code></pre>
<hr/>
<h4 data-id="heading-8"><strong>Step 2: å®ç°YOLOæ£€æµ‹å™¨ï¼ˆdetector.pyï¼‰</strong></h4>
<p>å°è£…YOLOæ¨¡å‹çš„åŠ è½½å’Œæ¨ç†é€»è¾‘ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/detector.py</span>
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span>
<span class="hljs-keyword">from</span> .models <span class="hljs-keyword">import</span> DetectionBox

<span class="hljs-keyword">class</span> <span class="hljs-title class_">YOLODetector</span>:
    <span class="hljs-string">"""YOLOç›®æ ‡æ£€æµ‹å™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_path: <span class="hljs-built_in">str</span> = <span class="hljs-string">"models/yolov8n.pt"</span></span>):
        <span class="hljs-string">"""
        åˆå§‹åŒ–æ£€æµ‹å™¨
        Args:
            model_path: YOLOæ¨¡å‹æ–‡ä»¶è·¯å¾„
        """</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£åœ¨åŠ è½½YOLOæ¨¡å‹: <span class="hljs-subst">{model_path}</span>"</span>)
        self.model = YOLO(model_path)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹åŠ è½½å®Œæˆï¼"</span>)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect</span>(<span class="hljs-params">
        self, 
        image_path: <span class="hljs-built_in">str</span>, 
        conf_threshold: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.25</span>,
        iou_threshold: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.45</span>
    </span>) -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-type">List</span>[DetectionBox], <span class="hljs-built_in">float</span>, np.ndarray]:
        <span class="hljs-string">"""
        æ‰§è¡Œç›®æ ‡æ£€æµ‹
        Args:
            image_path: å›¾ç‰‡è·¯å¾„
            conf_threshold: ç½®ä¿¡åº¦é˜ˆå€¼
            iou_threshold: IOUé˜ˆå€¼
        Returns:
            (æ£€æµ‹ç»“æœåˆ—è¡¨, æ¨ç†è€—æ—¶, åŸå§‹å›¾ç‰‡æ•°ç»„)
        """</span>
        <span class="hljs-comment"># è®°å½•å¼€å§‹æ—¶é—´</span>
        start_time = time.time()
        
        <span class="hljs-comment"># è¯»å–å›¾ç‰‡</span>
        image = cv2.imread(image_path)
        <span class="hljs-keyword">if</span> image <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"æ— æ³•è¯»å–å›¾ç‰‡: <span class="hljs-subst">{image_path}</span>"</span>)
        
        <span class="hljs-comment"># æ‰§è¡Œæ£€æµ‹</span>
        results = self.model.predict(
            source=image,
            conf=conf_threshold,
            iou=iou_threshold,
            verbose=<span class="hljs-literal">False</span>  <span class="hljs-comment"># å…³é—­æ—¥å¿—è¾“å‡º</span>
        )
        
        <span class="hljs-comment"># è®¡ç®—æ¨ç†æ—¶é—´</span>
        inference_time = time.time() - start_time
        
        <span class="hljs-comment"># è§£ææ£€æµ‹ç»“æœ</span>
        detections = []
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            boxes = result.boxes
            <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> boxes:
                <span class="hljs-comment"># æå–æ£€æµ‹æ¡†ä¿¡æ¯</span>
                detection = DetectionBox(
                    class_name=self.model.names[<span class="hljs-built_in">int</span>(box.cls)],
                    confidence=<span class="hljs-built_in">float</span>(box.conf),
                    bbox=box.xyxy[<span class="hljs-number">0</span>].tolist()  <span class="hljs-comment"># [x1, y1, x2, y2]</span>
                )
                detections.append(detection)
        
        <span class="hljs-keyword">return</span> detections, inference_time, image
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">draw_detections</span>(<span class="hljs-params">
        self, 
        image: np.ndarray, 
        detections: <span class="hljs-type">List</span>[DetectionBox],
        output_path: <span class="hljs-built_in">str</span>
    </span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""
        åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶æ£€æµ‹ç»“æœ
        Args:
            image: åŸå§‹å›¾ç‰‡æ•°ç»„
            detections: æ£€æµ‹ç»“æœåˆ—è¡¨
            output_path: è¾“å‡ºè·¯å¾„
        Returns:
            ä¿å­˜çš„å›¾ç‰‡è·¯å¾„
        """</span>
        <span class="hljs-comment"># å¤åˆ¶å›¾ç‰‡é¿å…ä¿®æ”¹åŸå›¾</span>
        annotated_image = image.copy()
        
        <span class="hljs-comment"># ç»˜åˆ¶æ¯ä¸ªæ£€æµ‹æ¡†</span>
        <span class="hljs-keyword">for</span> det <span class="hljs-keyword">in</span> detections:
            x1, y1, x2, y2 = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, det.bbox)
            
            <span class="hljs-comment"># ç»˜åˆ¶è¾¹ç•Œæ¡†</span>
            cv2.rectangle(
                annotated_image, 
                (x1, y1), 
                (x2, y2), 
                (<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>),  <span class="hljs-comment"># ç»¿è‰²</span>
                <span class="hljs-number">2</span>  <span class="hljs-comment"># çº¿å®½</span>
            )
            
            <span class="hljs-comment"># ç»˜åˆ¶æ ‡ç­¾èƒŒæ™¯</span>
            label = <span class="hljs-string">f"<span class="hljs-subst">{det.class_name}</span> <span class="hljs-subst">{det.confidence:<span class="hljs-number">.2</span>f}</span>"</span>
            (label_w, label_h), _ = cv2.getTextSize(
                label, 
                cv2.FONT_HERSHEY_SIMPLEX, 
                <span class="hljs-number">0.5</span>, 
                <span class="hljs-number">1</span>
            )
            cv2.rectangle(
                annotated_image,
                (x1, y1 - label_h - <span class="hljs-number">10</span>),
                (x1 + label_w, y1),
                (<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>),
                -<span class="hljs-number">1</span>  <span class="hljs-comment"># å¡«å……</span>
            )
            
            <span class="hljs-comment"># ç»˜åˆ¶æ ‡ç­¾æ–‡å­—</span>
            cv2.putText(
                annotated_image,
                label,
                (x1, y1 - <span class="hljs-number">5</span>),
                cv2.FONT_HERSHEY_SIMPLEX,
                <span class="hljs-number">0.5</span>,
                (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),  <span class="hljs-comment"># é»‘è‰²æ–‡å­—</span>
                <span class="hljs-number">1</span>
            )
        
        <span class="hljs-comment"># ä¿å­˜æ ‡æ³¨å›¾ç‰‡</span>
        cv2.imwrite(output_path, annotated_image)
        <span class="hljs-keyword">return</span> output_path
</code></pre>
<hr/>
<h4 data-id="heading-9"><strong>Step 3: å·¥å…·å‡½æ•°ï¼ˆutils.pyï¼‰</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/utils.py</span>
<span class="hljs-keyword">import</span> uuid
<span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> UploadFile
<span class="hljs-keyword">import</span> shutil

<span class="hljs-keyword">def</span> <span class="hljs-title function_">save_upload_file</span>(<span class="hljs-params">upload_file: UploadFile, destination: Path</span>) -&gt; Path:
    <span class="hljs-string">"""
    ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶
    Args:
        upload_file: FastAPIä¸Šä¼ æ–‡ä»¶å¯¹è±¡
        destination: ç›®æ ‡è·¯å¾„
    Returns:
        ä¿å­˜åçš„æ–‡ä»¶è·¯å¾„
    """</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">with</span> destination.<span class="hljs-built_in">open</span>(<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> buffer:
            shutil.copyfileobj(upload_file.file, buffer)
        <span class="hljs-keyword">return</span> destination
    <span class="hljs-keyword">finally</span>:
        upload_file.file.close()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_unique_filename</span>(<span class="hljs-params">original_filename: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""
    ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
    Args:
        original_filename: åŸå§‹æ–‡ä»¶å
    Returns:
        å¸¦UUIDçš„å”¯ä¸€æ–‡ä»¶å
    """</span>
    suffix = Path(original_filename).suffix
    unique_name = <span class="hljs-string">f"<span class="hljs-subst">{uuid.uuid4().<span class="hljs-built_in">hex</span>}</span><span class="hljs-subst">{suffix}</span>"</span>
    <span class="hljs-keyword">return</span> unique_name

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cleanup_old_files</span>(<span class="hljs-params">directory: Path, max_files: <span class="hljs-built_in">int</span> = <span class="hljs-number">100</span></span>):
    <span class="hljs-string">"""
    æ¸…ç†æ—§æ–‡ä»¶ï¼Œä¿æŒç›®å½•æ•´æ´
    Args:
        directory: ç›®æ ‡ç›®å½•
        max_files: æœ€å¤§ä¿ç•™æ–‡ä»¶æ•°
    """</span>
    files = <span class="hljs-built_in">sorted</span>(directory.glob(<span class="hljs-string">"*"</span>), key=<span class="hljs-keyword">lambda</span> x: x.stat().st_mtime)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(files) &gt; max_files:
        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files[:-max_files]:
            file.unlink()
</code></pre>
<hr/>
<h4 data-id="heading-10"><strong>Step 4: FastAPIä¸»åº”ç”¨ï¼ˆmain.pyï¼‰</strong></h4>
<p>æ•´åˆæ‰€æœ‰ç»„ä»¶ï¼Œæ„å»ºå®Œæ•´çš„APIæœåŠ¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/main.py</span>
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, File, UploadFile, HTTPException, Query
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> FileResponse
<span class="hljs-keyword">from</span> fastapi.staticfiles <span class="hljs-keyword">import</span> StaticFiles
<span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path
<span class="hljs-keyword">import</span> logging

<span class="hljs-keyword">from</span> .models <span class="hljs-keyword">import</span> DetectionResponse
<span class="hljs-keyword">from</span> .detector <span class="hljs-keyword">import</span> YOLODetector
<span class="hljs-keyword">from</span> .utils <span class="hljs-keyword">import</span> save_upload_file, generate_unique_filename, cleanup_old_files

<span class="hljs-comment"># é…ç½®æ—¥å¿—</span>
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

<span class="hljs-comment"># åˆ›å»ºFastAPIåº”ç”¨</span>
app = FastAPI(
    title=<span class="hljs-string">"YOLOç›®æ ‡æ£€æµ‹API"</span>,
    description=<span class="hljs-string">"åŸºäºYOLOv8çš„å®æ—¶ç›®æ ‡æ£€æµ‹æœåŠ¡"</span>,
    version=<span class="hljs-string">"1.0.0"</span>
)

<span class="hljs-comment"># åˆ›å»ºå¿…è¦çš„ç›®å½•</span>
UPLOAD_DIR = Path(<span class="hljs-string">"uploads"</span>)
OUTPUT_DIR = Path(<span class="hljs-string">"outputs"</span>)
UPLOAD_DIR.mkdir(exist_ok=<span class="hljs-literal">True</span>)
OUTPUT_DIR.mkdir(exist_ok=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># æŒ‚è½½é™æ€æ–‡ä»¶ç›®å½•</span>
app.mount(<span class="hljs-string">"/outputs"</span>, StaticFiles(directory=<span class="hljs-string">"outputs"</span>), name=<span class="hljs-string">"outputs"</span>)

<span class="hljs-comment"># åˆå§‹åŒ–YOLOæ£€æµ‹å™¨</span>
detector = YOLODetector(model_path=<span class="hljs-string">"models/yolov8n.pt"</span>)

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">root</span>():
    <span class="hljs-string">"""APIæ ¹è·¯å¾„"""</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ¬¢è¿ä½¿ç”¨YOLOæ£€æµ‹API"</span>,
        <span class="hljs-string">"docs"</span>: <span class="hljs-string">"/docs"</span>,
        <span class="hljs-string">"health"</span>: <span class="hljs-string">"/health"</span>
    }

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/health"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">health_check</span>():
    <span class="hljs-string">"""å¥åº·æ£€æŸ¥ç«¯ç‚¹"""</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"healthy"</span>,
        <span class="hljs-string">"model_loaded"</span>: detector.model <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>
    }

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/detect"</span>, response_model=DetectionResponse</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_objects</span>(<span class="hljs-params">
    file: UploadFile = File(<span class="hljs-params">..., description=<span class="hljs-string">"è¦æ£€æµ‹çš„å›¾ç‰‡æ–‡ä»¶"</span></span>),
    conf_threshold: <span class="hljs-built_in">float</span> = Query(<span class="hljs-params"><span class="hljs-number">0.25</span>, ge=<span class="hljs-number">0</span>, le=<span class="hljs-number">1</span>, description=<span class="hljs-string">"ç½®ä¿¡åº¦é˜ˆå€¼"</span></span>),
    iou_threshold: <span class="hljs-built_in">float</span> = Query(<span class="hljs-params"><span class="hljs-number">0.45</span>, ge=<span class="hljs-number">0</span>, le=<span class="hljs-number">1</span>, description=<span class="hljs-string">"IOUé˜ˆå€¼"</span></span>),
    return_image: <span class="hljs-built_in">bool</span> = Query(<span class="hljs-params"><span class="hljs-literal">True</span>, description=<span class="hljs-string">"æ˜¯å¦è¿”å›æ ‡æ³¨å›¾ç‰‡"</span></span>)
</span>):
    <span class="hljs-string">"""
    ç›®æ ‡æ£€æµ‹API
    
    ä¸Šä¼ å›¾ç‰‡ï¼Œè¿”å›æ£€æµ‹åˆ°çš„æ‰€æœ‰ç›®æ ‡åŠå…¶ä½ç½®ä¿¡æ¯
    """</span>
    <span class="hljs-comment"># éªŒè¯æ–‡ä»¶ç±»å‹</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file.content_type.startswith(<span class="hljs-string">"image/"</span>):
        <span class="hljs-keyword">raise</span> HTTPException(
            status_code=<span class="hljs-number">400</span>,
            detail=<span class="hljs-string">f"ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: <span class="hljs-subst">{file.content_type}</span>ï¼Œè¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶"</span>
        )
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># ç”Ÿæˆå”¯ä¸€æ–‡ä»¶åå¹¶ä¿å­˜</span>
        unique_filename = generate_unique_filename(file.filename)
        upload_path = UPLOAD_DIR / unique_filename
        save_upload_file(file, upload_path)
        
        logger.info(<span class="hljs-string">f"å¼€å§‹æ£€æµ‹å›¾ç‰‡: <span class="hljs-subst">{unique_filename}</span>"</span>)
        
        <span class="hljs-comment"># æ‰§è¡Œæ£€æµ‹</span>
        detections, inference_time, original_image = detector.detect(
            image_path=<span class="hljs-built_in">str</span>(upload_path),
            conf_threshold=conf_threshold,
            iou_threshold=iou_threshold
        )
        
        <span class="hljs-comment"># è·å–å›¾ç‰‡å°ºå¯¸</span>
        height, width = original_image.shape[:<span class="hljs-number">2</span>]
        
        <span class="hljs-comment"># ç”Ÿæˆæ ‡æ³¨å›¾ç‰‡</span>
        annotated_image_url = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> return_image <span class="hljs-keyword">and</span> detections:
            output_filename = <span class="hljs-string">f"result_<span class="hljs-subst">{unique_filename}</span>"</span>
            output_path = OUTPUT_DIR / output_filename
            detector.draw_detections(original_image, detections, <span class="hljs-built_in">str</span>(output_path))
            annotated_image_url = <span class="hljs-string">f"/outputs/<span class="hljs-subst">{output_filename}</span>"</span>
        
        logger.info(
            <span class="hljs-string">f"æ£€æµ‹å®Œæˆ: å‘ç°<span class="hljs-subst">{<span class="hljs-built_in">len</span>(detections)}</span>ä¸ªç›®æ ‡, "</span>
            <span class="hljs-string">f"è€—æ—¶<span class="hljs-subst">{inference_time:<span class="hljs-number">.3</span>f}</span>ç§’"</span>
        )
        
        <span class="hljs-comment"># æ¸…ç†æ—§æ–‡ä»¶</span>
        cleanup_old_files(UPLOAD_DIR)
        cleanup_old_files(OUTPUT_DIR)
        
        <span class="hljs-comment"># è¿”å›ç»“æœ</span>
        <span class="hljs-keyword">return</span> DetectionResponse(
            success=<span class="hljs-literal">True</span>,
            image_size=[width, height],
            detections=detections,
            detection_count=<span class="hljs-built_in">len</span>(detections),
            inference_time=<span class="hljs-built_in">round</span>(inference_time, <span class="hljs-number">4</span>),
            annotated_image_url=annotated_image_url
        )
        
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        logger.error(<span class="hljs-string">f"æ£€æµ‹å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-string">f"æ£€æµ‹å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
    
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-comment"># æ¸…ç†ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶</span>
        <span class="hljs-keyword">if</span> upload_path.exists():
            upload_path.unlink()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/outputs/{filename}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_output_image</span>(<span class="hljs-params">filename: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""
    è·å–æ£€æµ‹ç»“æœå›¾ç‰‡
    """</span>
    file_path = OUTPUT_DIR / filename
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file_path.exists():
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">404</span>, detail=<span class="hljs-string">"å›¾ç‰‡ä¸å­˜åœ¨"</span>)
    <span class="hljs-keyword">return</span> FileResponse(file_path)
</code></pre>
<hr/>
<h3 data-id="heading-11"><strong>å¯åŠ¨å’Œæµ‹è¯•</strong></h3>
<h4 data-id="heading-12"><strong>1. å¯åŠ¨æœåŠ¡</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰</span>
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

<span class="hljs-comment"># ç”Ÿäº§æ¨¡å¼</span>
uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
</code></pre>
<p>çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash">    INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
    INFO:     æ­£åœ¨åŠ è½½YOLOæ¨¡å‹: models/yolov8n.pt
    INFO:     æ¨¡å‹åŠ è½½å®Œæˆï¼
</code></pre>
<h4 data-id="heading-13"><strong>2. è®¿é—®è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£</strong></h4>
<p>æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š</p>
<ul>
<li><strong>Swagger UI</strong>: <code>http://localhost:8000/docs</code></li>
<li><strong>ReDoc</strong>: <code>http://localhost:8000/redoc</code></li>
</ul>
<hr/>
<h3 data-id="heading-14"><strong>APIæµ‹è¯•å®æˆ˜</strong></h3>
<h4 data-id="heading-15"><strong>æ–¹æ³•1: ä½¿ç”¨Swagger UIï¼ˆæ¨èæ–°æ‰‹ï¼‰</strong></h4>
<ol>
<li>è®¿é—® <code>http://localhost:8000/docs</code></li>
<li>æ‰¾åˆ° <code>POST /detect</code> ç«¯ç‚¹</li>
<li>ç‚¹å‡» "Try it out"</li>
<li>ä¸Šä¼ æµ‹è¯•å›¾ç‰‡</li>
<li>è°ƒæ•´å‚æ•°ï¼ˆå¯é€‰ï¼‰ï¼š
<ul>
<li><code>conf_threshold</code>: ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆé»˜è®¤0.25ï¼‰</li>
<li><code>iou_threshold</code>: IOUé˜ˆå€¼ï¼ˆé»˜è®¤0.45ï¼‰</li>
<li><code>return_image</code>: æ˜¯å¦è¿”å›æ ‡æ³¨å›¾ç‰‡ï¼ˆé»˜è®¤trueï¼‰</li>
</ul>
</li>
<li>ç‚¹å‡» "Execute"</li>
<li>æŸ¥çœ‹è¿”å›ç»“æœ</li>
</ol>
<h4 data-id="heading-16"><strong>æ–¹æ³•2: ä½¿ç”¨Python requests</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># test_api.py</span>
<span class="hljs-keyword">import</span> requests

<span class="hljs-comment"># APIç«¯ç‚¹</span>
url = <span class="hljs-string">"http://localhost:8000/detect"</span>

<span class="hljs-comment"># å‡†å¤‡æµ‹è¯•å›¾ç‰‡</span>
files = {<span class="hljs-string">"file"</span>: <span class="hljs-built_in">open</span>(<span class="hljs-string">"test_image.jpg"</span>, <span class="hljs-string">"rb"</span>)}

<span class="hljs-comment"># å¯é€‰å‚æ•°</span>
params = {
    <span class="hljs-string">"conf_threshold"</span>: <span class="hljs-number">0.3</span>,
    <span class="hljs-string">"iou_threshold"</span>: <span class="hljs-number">0.45</span>,
    <span class="hljs-string">"return_image"</span>: <span class="hljs-literal">True</span>
}

<span class="hljs-comment"># å‘é€è¯·æ±‚</span>
response = requests.post(url, files=files, params=params)

<span class="hljs-comment"># æ‰“å°ç»“æœ</span>
<span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
    result = response.json()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ£€æµ‹æˆåŠŸï¼"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‘ç°ç›®æ ‡æ•°é‡: <span class="hljs-subst">{result[<span class="hljs-string">'detection_count'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¨ç†è€—æ—¶: <span class="hljs-subst">{result[<span class="hljs-string">'inference_time'</span>]}</span>ç§’"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ£€æµ‹è¯¦æƒ…:"</span>)
    <span class="hljs-keyword">for</span> i, det <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(result[<span class="hljs-string">'detections'</span>], <span class="hljs-number">1</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{i}</span>. <span class="hljs-subst">{det[<span class="hljs-string">'class_name'</span>]}</span> - ç½®ä¿¡åº¦: <span class="hljs-subst">{det[<span class="hljs-string">'confidence'</span>]:<span class="hljs-number">.2</span>f}</span>"</span>)
    
    <span class="hljs-keyword">if</span> result[<span class="hljs-string">'annotated_image_url'</span>]:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ ‡æ³¨å›¾ç‰‡: http://localhost:8000<span class="hljs-subst">{result[<span class="hljs-string">'annotated_image_url'</span>]}</span>"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ£€æµ‹å¤±è´¥: <span class="hljs-subst">{response.status_code}</span>"</span>)
    <span class="hljs-built_in">print</span>(response.json())
</code></pre>
<h4 data-id="heading-17"><strong>æ–¹æ³•3: ä½¿ç”¨curlå‘½ä»¤</strong></h4>
<pre><code class="hljs language-bash" lang="bash">curl -X POST <span class="hljs-string">"http://localhost:8000/detect"</span> \
  -F <span class="hljs-string">"file=@test_image.jpg"</span> \
  -F <span class="hljs-string">"conf_threshold=0.25"</span> \
  -F <span class="hljs-string">"return_image=true"</span>
</code></pre>
<hr/>
<h3 data-id="heading-18"><strong>å®Œæ•´çš„è¯·æ±‚å¤„ç†æµç¨‹</strong></h3>
<p>è®©æˆ‘ä»¬ç”¨Mermaidå›¾å±•ç¤ºä¸€æ¬¡å®Œæ•´çš„APIè°ƒç”¨æµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as å®¢æˆ·ç«¯
    participant F as FastAPI
    participant V as æ•°æ®éªŒè¯
    participant D as YOLOæ£€æµ‹å™¨
    participant S as æ–‡ä»¶ç³»ç»Ÿ
    
    C-&gt;&gt;F: POST /detect&lt;br/&gt;(ä¸Šä¼ å›¾ç‰‡)
    F-&gt;&gt;V: éªŒè¯æ–‡ä»¶ç±»å‹
    alt æ–‡ä»¶ç±»å‹é”™è¯¯
        V--&gt;&gt;C: è¿”å›400é”™è¯¯
    end
    
    V-&gt;&gt;S: ä¿å­˜ä¸Šä¼ æ–‡ä»¶
    F-&gt;&gt;D: è°ƒç”¨detect()
    D-&gt;&gt;D: åŠ è½½å›¾ç‰‡
    D-&gt;&gt;D: æ¨¡å‹æ¨ç†
    D-&gt;&gt;D: è§£æç»“æœ
    D--&gt;&gt;F: è¿”å›æ£€æµ‹ç»“æœ
    
    alt éœ€è¦æ ‡æ³¨å›¾ç‰‡
        F-&gt;&gt;D: è°ƒç”¨draw_detections()
        D-&gt;&gt;S: ä¿å­˜æ ‡æ³¨å›¾ç‰‡
    end
    
    F-&gt;&gt;S: æ¸…ç†æ—§æ–‡ä»¶
    F--&gt;&gt;C: è¿”å›JSONç»“æœ
    
    Note over C,S: æ•´ä¸ªæµç¨‹å¼‚æ­¥å¤„ç†&lt;br/&gt;ä¸é˜»å¡å…¶ä»–è¯·æ±‚
</code></pre>
<hr/>
<h3 data-id="heading-19"><strong>å“åº”ç¤ºä¾‹</strong></h3>
<p>æˆåŠŸæ£€æµ‹åçš„JSONå“åº”ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1920</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1080</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"detections"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"class_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"person"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.95</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"bbox"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">345.2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">120.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">678.9</span><span class="hljs-punctuation">,</span> <span class="hljs-number">890.3</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"class_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"car"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.87</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"bbox"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1200.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">450.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1600.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">800.0</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"class_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dog"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.82</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"bbox"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">200.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">600.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">450.0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">950.0</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"detection_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"inference_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.0234</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"annotated_image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/outputs/result_abc123def456.jpg"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-20"><strong>æ€§èƒ½ä¼˜åŒ–å»ºè®®</strong></h3>
<h4 data-id="heading-21"><strong>1. ä½¿ç”¨æ¨¡å‹ç¼“å­˜</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache

<span class="hljs-meta">@lru_cache(<span class="hljs-params">maxsize=<span class="hljs-number">1</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_detector</span>():
    <span class="hljs-string">"""å•ä¾‹æ¨¡å¼ï¼Œç¡®ä¿åªåŠ è½½ä¸€æ¬¡æ¨¡å‹"""</span>
    <span class="hljs-keyword">return</span> YOLODetector()
</code></pre>
<h4 data-id="heading-22"><strong>2. å¼‚æ­¥å¤„ç†å¤§å›¾ç‰‡</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor

executor = ThreadPoolExecutor(max_workers=<span class="hljs-number">4</span>)

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/detect"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_objects</span>(<span class="hljs-params">file: UploadFile</span>):
    <span class="hljs-comment"># åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡ŒCPUå¯†é›†å‹ä»»åŠ¡</span>
    loop = asyncio.get_event_loop()
    result = <span class="hljs-keyword">await</span> loop.run_in_executor(
        executor, 
        detector.detect, 
        image_path
    )
    <span class="hljs-keyword">return</span> result
</code></pre>
<h4 data-id="heading-23"><strong>3. æ‰¹é‡æ£€æµ‹</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/batch-detect"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_detect</span>(<span class="hljs-params">files: <span class="hljs-type">List</span>[UploadFile]</span>):
    <span class="hljs-string">"""æ‰¹é‡æ£€æµ‹å¤šå¼ å›¾ç‰‡"""</span>
    results = []
    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
        <span class="hljs-comment"># å¼‚æ­¥å¤„ç†æ¯å¼ å›¾ç‰‡</span>
        result = <span class="hljs-keyword">await</span> detect_single_image(file)
        results.append(result)
    <span class="hljs-keyword">return</span> results
</code></pre>
<hr/>
<h3 data-id="heading-24"><strong>é”™è¯¯å¤„ç†å’Œæ—¥å¿—</strong></h3>
<h4 data-id="heading-25"><strong>å®Œå–„çš„é”™è¯¯å¤„ç†</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> status
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> JSONResponse

<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">ValueError</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">value_error_handler</span>(<span class="hljs-params">request, exc</span>):
    <span class="hljs-keyword">return</span> JSONResponse(
        status_code=status.HTTP_400_BAD_REQUEST,
        content={<span class="hljs-string">"error"</span>: <span class="hljs-built_in">str</span>(exc)}
    )

<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">Exception</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">general_exception_handler</span>(<span class="hljs-params">request, exc</span>):
    logger.error(<span class="hljs-string">f"æœªå¤„ç†çš„å¼‚å¸¸: <span class="hljs-subst">{exc}</span>"</span>, exc_info=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">return</span> JSONResponse(
        status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
        content={<span class="hljs-string">"error"</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span>}
    )
</code></pre>
<hr/>
<h3 data-id="heading-26"><strong>ç›‘æ§å’Œç»Ÿè®¡</strong></h3>
<p>æ·»åŠ ç®€å•çš„ç»Ÿè®¡åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å…¨å±€ç»Ÿè®¡å˜é‡</span>
detection_stats = {
    <span class="hljs-string">"total_requests"</span>: <span class="hljs-number">0</span>,
    <span class="hljs-string">"total_detections"</span>: <span class="hljs-number">0</span>,
    <span class="hljs-string">"average_inference_time"</span>: <span class="hljs-number">0.0</span>
}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/stats"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_stats</span>():
    <span class="hljs-string">"""è·å–APIç»Ÿè®¡ä¿¡æ¯"""</span>
    <span class="hljs-keyword">return</span> detection_stats

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/detect"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_objects</span>(<span class="hljs-params">file: UploadFile</span>):
    <span class="hljs-comment"># ... æ£€æµ‹é€»è¾‘ ...</span>
    
    <span class="hljs-comment"># æ›´æ–°ç»Ÿè®¡</span>
    detection_stats[<span class="hljs-string">"total_requests"</span>] += <span class="hljs-number">1</span>
    detection_stats[<span class="hljs-string">"total_detections"</span>] += <span class="hljs-built_in">len</span>(detections)
    <span class="hljs-comment"># æ›´æ–°å¹³å‡æ¨ç†æ—¶é—´</span>
    <span class="hljs-comment"># ...</span>
    
    <span class="hljs-keyword">return</span> result
</code></pre>
<hr/>
<h3 data-id="heading-27"><strong>æœ¬ç« æ€»ç»“</strong></h3>
<p>æ­å–œä½ ï¼ä½ å·²ç»æˆåŠŸæ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„YOLOæ£€æµ‹APIæœåŠ¡ã€‚è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<h4 data-id="heading-28"><strong>å…³é”®æˆå°±</strong></h4>
<ul>
<li>âœ… æ­å»ºäº†è§„èŒƒçš„FastAPIé¡¹ç›®ç»“æ„</li>
<li>âœ… é›†æˆäº†Ultralytics YOLOæ¨¡å‹</li>
<li>âœ… å®ç°äº†å›¾ç‰‡ä¸Šä¼ å’Œæ£€æµ‹åŠŸèƒ½</li>
<li>âœ… è‡ªåŠ¨ç”Ÿæˆäº†APIæ–‡æ¡£</li>
<li>âœ… æ”¯æŒè‡ªå®šä¹‰æ£€æµ‹å‚æ•°</li>
<li>âœ… è¿”å›æ ‡æ³¨åçš„å¯è§†åŒ–ç»“æœ</li>
</ul>
<h4 data-id="heading-29"><strong>æŠ€æœ¯äº®ç‚¹</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((YOLO API))
    FastAPIç‰¹æ€§
      è‡ªåŠ¨éªŒè¯
      å¼‚æ­¥å¤„ç†
      Swaggeræ–‡æ¡£
      ç±»å‹å®‰å…¨
    YOLOèƒ½åŠ›
      å®æ—¶æ£€æµ‹
      é«˜ç²¾åº¦
      å¤šç±»åˆ«
      è¾¹ç•Œæ¡†
    å·¥ç¨‹å®è·µ
      æ–‡ä»¶ç®¡ç†
      é”™è¯¯å¤„ç†
      æ€§èƒ½ä¼˜åŒ–
      æ—¥å¿—è®°å½•
</code></pre>
<h4 data-id="heading-30"><strong>æ€§èƒ½æŒ‡æ ‡</strong></h4>

























<table><thead><tr><th>æŒ‡æ ‡</th><th>è¡¨ç°</th></tr></thead><tbody><tr><td><strong>å•å¼ å›¾ç‰‡æ£€æµ‹</strong></td><td>&lt; 50ms</td></tr><tr><td><strong>å¹¶å‘å¤„ç†èƒ½åŠ›</strong></td><td>100+ req/s</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>~500MB</td></tr><tr><td><strong>æ¨¡å‹åŠ è½½æ—¶é—´</strong></td><td>~2ç§’</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-31"><strong>ä¸‹ä¸€ç« é¢„å‘Š</strong></h3>
<p>åœ¨ç¬¬ä¸ƒç« ä¸­ï¼Œå°†è¿›ä¸€æ­¥æå‡æˆ‘ä»¬çš„APIæœåŠ¡ï¼š</p>
<ul>
<li><strong>å‚æ•°è°ƒæ•´</strong>ï¼šä¿®æ”¹ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œè§‚å¯Ÿæ£€æµ‹ç»“æœçš„å˜åŒ–</li>
<li><strong>æ–‡ä»¶è§†é¢‘æ£€æµ‹</strong>ï¼šæ·»åŠ ä¸€ä¸ª <code>/detect-video</code> ç«¯ç‚¹ï¼Œæ”¯æŒè§†é¢‘æ–‡ä»¶æ£€æµ‹</li>
<li><strong>æŒä¹…åŒ–</strong>ï¼šç°æ£€æµ‹ç»“æœçš„æŒä¹…åŒ–å­˜å‚¨ï¼ˆä½¿ç”¨SQLiteï¼‰</li>
<li><strong>è§†é¢‘æµæ£€æµ‹</strong>ï¼šå®æ—¶å¤„ç†è§†é¢‘å¸§</li>
<li><strong>WebSocketæ”¯æŒ</strong>ï¼šå®ç°çœŸæ­£çš„å®æ—¶é€šä¿¡</li>
<li><strong>æ•°æ®åº“é›†æˆ</strong>ï¼šä¿å­˜æ£€æµ‹å†å²è®°å½•</li>
<li><strong>å‰ç«¯ç•Œé¢</strong>ï¼šæ„å»ºå¯è§†åŒ–çš„Webç•Œé¢</li>
<li><strong>Dockeréƒ¨ç½²</strong>ï¼šå®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å‰ç«¯å¿…çœ‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ æŠŠ Strapi 5 è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°å®å¡”ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ä¼ ä»£ç äº†ï¼]]></title>    <link>https://juejin.cn/post/7585727457473052672</link>    <guid>https://juejin.cn/post/7585727457473052672</guid>    <pubDate>2025-12-21T16:30:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457473052672" data-draft-id="7585929179318353955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å‰ç«¯å¿…çœ‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ æŠŠ Strapi 5 è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°å®å¡”ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ä¼ ä»£ç äº†ï¼"/> <meta itemprop="keywords" content="è‡ªåŠ¨åŒ–è¿ç»´"/> <meta itemprop="datePublished" content="2025-12-21T16:30:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŸ¥èˆªé©¿ç«™"/> <meta itemprop="url" content="https://juejin.cn/user/4125023356335576"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å‰ç«¯å¿…çœ‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ æŠŠ Strapi 5 è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°å®å¡”ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ä¼ ä»£ç äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023356335576/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŸ¥èˆªé©¿ç«™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T16:30:25.000Z" title="Sun Dec 21 2025 16:30:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å…„å¼Ÿä»¬ï¼Œä½œä¸ºä¸€åæ™®é€šå‰ç«¯ï¼Œæ¯æ¬¡å†™å®Œæ¥å£è¿˜è¦è‡ªå·±ç™»å½•æœåŠ¡å™¨ã€æ‰‹åŠ¨ä¸Šä¼ ä»£ç ã€è£…ä¾èµ–ã€å†é‡å¯ PM2ï¼Œè¿™ä¸€å¥—â€œå¹¿æ’­ä½“æ“â€åšä¸‹æ¥ï¼Œå¤©éƒ½é»‘äº†ã€‚</p>
<p>ä»Šå¤©å’±ä»¬å°±èŠ± 10 åˆ†é’Ÿï¼ŒæŠŠè¿™å¥—æ´»å„¿äº¤ç»™ <strong>GitHub Actions</strong>ã€‚ä»¥åä½ åªç®¡åœ¨æœ¬åœ° <code>git push</code>ï¼Œå‰©ä¸‹çš„è„æ´»ç´¯æ´»å…¨è®©æœºå™¨äººå¸®ä½ å¹²ï¼</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhangjob.github.io%2Fstrapi-plugin-bag%2F" target="_blank" title="https://hangjob.github.io/strapi-plugin-bag/" ref="nofollow noopener noreferrer">åœ¨çº¿æ–‡æ¡£</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhangjob%2Fstrapi-plugin-bag" target="_blank" title="https://github.com/hangjob/strapi-plugin-bag" ref="nofollow noopener noreferrer">åœ¨çº¿æºç </a></p>
<h2 data-id="heading-1">ä¸€ã€ æ•´ä½“æ€è·¯ï¼ˆå¤§ç™½è¯ç‰ˆï¼‰</h2>
<ol>
<li><strong>ä»£ç æ”¾ GitHub</strong>ï¼šè¿™å¤§å®¶éƒ½ä¼šã€‚</li>
<li><strong>GitHub Actions å¼€å·¥</strong>ï¼šä½ ä¸€æ¨ä»£ç ï¼Œå®ƒå°±è·³å‡ºæ¥æ‰§è¡Œä¸€ä¸ªè„šæœ¬ã€‚</li>
<li><strong>SSH è¿œç¨‹ç™»å½•</strong>ï¼šGitHub åƒä¸ªâ€œä»£è·‘è…¿â€çš„ï¼Œæ‹¿ç€ä½ çš„é’¥åŒ™ï¼Œç™»å½•ä½ çš„å®å¡”æœåŠ¡å™¨ã€‚</li>
<li><strong>æœåŠ¡å™¨å¹²æ´»</strong>ï¼šæ‹‰ä»£ç ã€æ‰“åŒ…ã€é‡å¯ Strapiï¼Œä¸€æ°”å‘µæˆã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-2">äºŒã€ æœåŠ¡å™¨ç¯å¢ƒï¼šæŠŠâ€œè·¯â€é“ºå¹³</h2>
<p>å®å¡”ç¯å¢ƒä¸‹çš„ Node è·¯å¾„æ¯”è¾ƒç‰¹æ®Šï¼ŒSSH è¿œç¨‹ç™»å½•æ—¶ç»å¸¸â€œå¤±å¿†â€æ‰¾ä¸åˆ°å‘½ä»¤ã€‚æˆ‘ä»¬è¦å…ˆåœ¨æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼Œå»ºç«‹ç³»ç»Ÿçº§â€œè·¯æ ‡â€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¼ºè¡Œå»ºç«‹å…¨å±€è½¯é“¾æ¥ï¼Œç¡®ä¿ç³»ç»Ÿä»»ä½•æ—¶å€™éƒ½èƒ½æ‰¾åˆ°å®ƒä»¬</span>
<span class="hljs-built_in">ln</span> -sf $(<span class="hljs-built_in">which</span> pnpm) /usr/bin/pnpm
<span class="hljs-built_in">ln</span> -sf $(<span class="hljs-built_in">which</span> node) /usr/bin/node
<span class="hljs-built_in">ln</span> -sf $(<span class="hljs-built_in">which</span> pm2) /usr/bin/pm2

<span class="hljs-comment"># 2. æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æˆåŠŸï¼ˆåº”è¯¥è¾“å‡ºç‰ˆæœ¬å·ï¼‰</span>
pnpm -v
node -v
</code></pre>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€ é…ç½®â€œé’¥åŒ™â€å’Œâ€œé”â€ (SSH)</h2>
<h3 data-id="heading-4">1. ç”Ÿæˆé’¥åŒ™å¯¹</h3>
<p>åœ¨æœåŠ¡å™¨é‡Œè¾“å…¥ï¼š<code>ssh-keygen -t rsa -b 4096</code>ï¼Œ<strong>ä¸€è·¯ç‹‚æŒ‰å›è½¦</strong>ï¼Œä¸è¦è®¾å¯†ç ï¼</p>
<h3 data-id="heading-5">2. æŠŠâ€œå…¬é’¥â€ç»™ GitHub ä»“åº“ï¼ˆç”¨äºæ‹‰ä»£ç ï¼‰</h3>
<p>è¾“å…¥ <code>cat ~/.ssh/id_rsa.pub</code>ï¼ŒæŠŠå†…å®¹å¤åˆ¶ä¸‹æ¥ã€‚
å» GitHub ä»“åº“ -&gt; <strong>Settings</strong> -&gt; <strong>Deploy keys</strong> -&gt; <strong>Add deploy key</strong> å­˜è¿›å»ã€‚</p>
<h3 data-id="heading-6">3. æŠŠâ€œç§é’¥â€ç»™ GitHub æœºå™¨äººï¼ˆç”¨äºç™»å½•æœåŠ¡å™¨ï¼‰</h3>
<p>è¾“å…¥ <code>cat ~/.ssh/id_rsa</code>ï¼Œ<strong>å®Œæ•´å¤åˆ¶</strong>ï¼ˆå¿…é¡»åŒ…å« <code>-----BEGIN...</code> å’Œ <code>-----END...</code>ï¼‰ã€‚
å» GitHub ä»“åº“ -&gt; <strong>Settings</strong> -&gt; <strong>Secrets and variables</strong> -&gt; <strong>Actions</strong> -&gt; æ–°å»ºä¸€ä¸ªåä¸º <code>SSH_PRIVATE_KEY</code> çš„ Secret å­˜è¿›å»ã€‚</p>
<h3 data-id="heading-7">4. æŠŠâ€œå…¬é’¥â€è£…è¿›æœåŠ¡å™¨é”å¿ƒé‡Œ</h3>
<p>åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
<span class="hljs-built_in">chmod</span> 700 ~/.ssh &amp;&amp; <span class="hljs-built_in">chmod</span> 600 ~/.ssh/authorized_keys
</code></pre>
<hr/>
<h2 data-id="heading-8">å››ã€ æ ¸å¿ƒä»£ç å®ç°</h2>
<h3 data-id="heading-9">1. PM2 é…ç½®æ–‡ä»¶ï¼šecosystem.config.js</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºï¼Œè¿™æ˜¯ç”Ÿäº§ç¯å¢ƒè¿è¡Œçš„â€œæŒ‡æŒ¥æ£’â€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">apps</span>: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'strapi-bag'</span>,           <span class="hljs-comment">// è¿›ç¨‹å</span>
      <span class="hljs-attr">script</span>: <span class="hljs-string">'pnpm'</span>,               <span class="hljs-comment">// å¯åŠ¨ç¨‹åº</span>
      <span class="hljs-attr">args</span>: <span class="hljs-string">'start'</span>,                <span class="hljs-comment">// å¯åŠ¨å‚æ•°</span>
      <span class="hljs-attr">cwd</span>: <span class="hljs-string">'./apps/backend'</span>,        <span class="hljs-comment">// åç«¯åº”ç”¨æ‰€åœ¨ç›®å½•</span>
      <span class="hljs-attr">interpreter</span>: <span class="hljs-string">'none'</span>,          <span class="hljs-comment">// é’ˆå¯¹ pnpm å‘½ä»¤å¿…é¡»è®¾ä¸º none</span>
      <span class="hljs-attr">env</span>: {
        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">'production'</span>,     <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒæ ‡è¯†</span>
        <span class="hljs-attr">PORT</span>: <span class="hljs-number">1339</span>,                 <span class="hljs-comment">// ç«¯å£å·</span>
      },
      <span class="hljs-attr">max_memory_restart</span>: <span class="hljs-string">'1G'</span>,     <span class="hljs-comment">// å†…å­˜æº¢å‡ºä¿æŠ¤</span>
    },
  ],
};
</code></pre>
<h3 data-id="heading-10">2. GitHub å·¥ä½œæµï¼š.github/workflows/deploy.yml</h3>
<p>åœ¨é¡¹ç›®é‡Œåˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™å°±æ˜¯é‚£ä¸ªâ€œä»£è·‘è…¿æœºå™¨äººâ€çš„æ‰§è¡Œè¯´æ˜ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">BT</span> <span class="hljs-string">Server</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [<span class="hljs-string">main</span>] <span class="hljs-comment"># åªæœ‰æ¨é€åˆ° main åˆ†æ”¯æ—¶æ‰è§¦å‘</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">SSH</span> <span class="hljs-string">Remote</span> <span class="hljs-string">Deployment</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">appleboy/ssh-action@master</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">host:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.REMOTE_HOST</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">username:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.REMOTE_USER</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SSH_PRIVATE_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">script:</span> <span class="hljs-string">|
            # 1. å…¼å®¹å®å¡”é¢æ¿çš„ Node è·¯å¾„åŠ è½½
            export PATH=$PATH:/usr/local/bin:/usr/bin
            export PATH=$PATH:$(find /www/server/nodejs -maxdepth 3 -type d -name "bin" 2&gt;/dev/null | head -n 1)
</span>            
            <span class="hljs-comment"># 2. è¿›å…¥é¡¹ç›®ç›®å½•å¹¶æ‹‰å–ä»£ç </span>
            <span class="hljs-string">cd</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.TARGET_DIR</span> <span class="hljs-string">}}</span>
            <span class="hljs-string">git</span> <span class="hljs-string">pull</span> <span class="hljs-string">origin</span> <span class="hljs-string">main</span>
            
            <span class="hljs-comment"># 3. è‡ªåŠ¨åŒ–æµæ°´çº¿</span>
            <span class="hljs-string">pnpm</span> <span class="hljs-string">install</span> <span class="hljs-string">--no-frozen-lockfile</span>
            <span class="hljs-string">pnpm</span> <span class="hljs-string">build</span>
            
            <span class="hljs-comment"># 4. é‡å¯æœåŠ¡ (åŠ è½½æœ€æ–°é…ç½®)</span>
            <span class="hljs-string">pm2</span> <span class="hljs-string">reload</span> <span class="hljs-string">ecosystem.config.js</span> <span class="hljs-string">||</span> <span class="hljs-string">pm2</span> <span class="hljs-string">start</span> <span class="hljs-string">ecosystem.config.js</span>
</code></pre>
<h3 data-id="heading-11">3. Strapi åŸŸåé…ç½®ï¼šapps/backend/config/server.js</h3>
<p>ä¸ºäº†è®©åŸŸåè®¿é—®æ—¶ä¸æŠ¥é”™ï¼Œå¿…é¡»åŠ ä¸Š <code>url</code> é…ç½®ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">{ env }</span>) =&gt;</span> ({
  <span class="hljs-attr">host</span>: <span class="hljs-title function_">env</span>(<span class="hljs-string">'HOST'</span>, <span class="hljs-string">'0.0.0.0'</span>),
  <span class="hljs-attr">port</span>: env.<span class="hljs-title function_">int</span>(<span class="hljs-string">'PORT'</span>, <span class="hljs-number">1339</span>),
  <span class="hljs-attr">url</span>: <span class="hljs-title function_">env</span>(<span class="hljs-string">'STRAPI_URL'</span>, <span class="hljs-string">'https://api.yourdomain.com'</span>), <span class="hljs-comment">// è¿™é‡Œå¡«ä½ çš„çœŸå®åŸŸå</span>
  <span class="hljs-attr">app</span>: {
    <span class="hljs-attr">keys</span>: env.<span class="hljs-title function_">array</span>(<span class="hljs-string">'APP_KEYS'</span>),
  },
});
</code></pre>
<hr/>
<h2 data-id="heading-12">äº”ã€ å®å¡” Nginx åå‘ä»£ç†é…ç½®</h2>
<ol>
<li><strong>å»ºç«™</strong>ï¼šåœ¨å®å¡”å»ºä¸€ä¸ªçº¯é™æ€ç«™ç‚¹ï¼Œç»‘å®šåŸŸåã€‚</li>
<li><strong>åä»£</strong>ï¼šç«™ç‚¹è®¾ç½® -&gt; åå‘ä»£ç† -&gt; æ·»åŠ ã€‚ç›®æ ‡ URL å¡« <code>http://127.0.0.1:1339</code>ã€‚</li>
<li><strong>Header ä¿®æ­£</strong>ï¼šç‚¹å‡»åä»£è®¾ç½®é‡Œçš„â€œé…ç½®æ–‡ä»¶â€ï¼Œç¡®ä¿æœ‰ä»¥ä¸‹è¿™è¡Œï¼Œå¦åˆ™ HTTPS ä¸‹ä¼šæŠ¥é”™ï¼š
<pre><code class="hljs language-nginx" lang="nginx">proxy_set_header X-Forwarded-Proto $scheme;
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-13">å…­ã€ æ€»ç»“ï¼šé¿å‘è´´å£«</h2>
<ol>
<li><strong>ç¬¬ä¸€æ¬¡æ‰‹åŠ¨æ¥ä¸€é</strong>ï¼šå…ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡ <code>pnpm build</code> å’Œ <code>pm2 start ecosystem.config.js</code>ã€‚</li>
<li><strong>å®‰å…¨ç»„/é˜²ç«å¢™</strong>ï¼šè®°å¾—åœ¨å®å¡”é¢æ¿å’Œäº‘æœåŠ¡å™¨åå°åŒæ—¶æ”¾è¡Œ <code>1339</code> ç«¯å£ã€‚</li>
<li><strong>Secrets</strong>ï¼šGitHub ç½‘é¡µä¸Šçš„ <code>REMOTE_HOST</code> ç­‰å˜é‡åå¿…é¡»å’Œ <code>deploy.yml</code> é‡Œå†™çš„ä¸€æ¨¡ä¸€æ ·ã€‚</li>
</ol>
<p><strong>ä»æ­¤ï¼Œä½ çš„å¼€å‘æµç¨‹å°†å˜æˆï¼š</strong>
<code>ä¿®æ”¹ä»£ç </code> -&gt; <code>Git Push</code> -&gt; <code>å–æ¯å’–å•¡</code> -&gt; <code>éƒ¨ç½²å®Œæˆ</code>ï¼</p>
<hr/>
<blockquote>
<p>æˆ‘æ˜¯ ç¾Šå…ˆç”Ÿï¼Œä¸€ååœ¨å‘é‡Œæ‘¸çˆ¬æ»šæ‰“çš„å‰ç«¯å¼€å‘ã€‚å¦‚æœä½ ä¹Ÿæƒ³è®©å¼€å‘æ›´è½»æ¾ï¼Œæ¬¢è¿å…³æ³¨æˆ‘ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring AI è¿›é˜¶ä¹‹è·¯05ï¼šé›†æˆ MCP åè®®å®ç°å·¥å…·è°ƒç”¨]]></title>    <link>https://juejin.cn/post/7585693761533001762</link>    <guid>https://juejin.cn/post/7585693761533001762</guid>    <pubDate>2025-12-21T15:22:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585693761533001762" data-draft-id="7585693761532985378" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring AI è¿›é˜¶ä¹‹è·¯05ï¼šé›†æˆ MCP åè®®å®ç°å·¥å…·è°ƒç”¨"/> <meta itemprop="keywords" content="åç«¯,Spring Boot,LLM"/> <meta itemprop="datePublished" content="2025-12-21T15:22:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ«æƒ¹CC"/> <meta itemprop="url" content="https://juejin.cn/user/4095037267779687"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring AI è¿›é˜¶ä¹‹è·¯05ï¼šé›†æˆ MCP åè®®å®ç°å·¥å…·è°ƒç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4095037267779687/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ«æƒ¹CC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T15:22:08.000Z" title="Sun Dec 21 2025 15:22:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="hybrid">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1d1f21}.hljs::selection,.hljs span::selection{background:#373b41}.hljs::-moz-selection,.hljs span::-moz-selection{background:#373b41}.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#c5c8c6}.hljs-name,.hljs-title{color:#f0c674}.hljs-comment,.hljs-meta,.hljs-meta .hljs-keyword{color:#707880}.hljs-deletion,.hljs-link,.hljs-literal,.hljs-number,.hljs-symbol{color:#c66}.hljs-addition,.hljs-doctag,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string{color:#b5bd68}.hljs-attribute,.hljs-code,.hljs-selector-id{color:#b294bb}.hljs-bullet,.hljs-keyword,.hljs-selector-tag,.hljs-tag{color:#81a2be}.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-variable{color:#8abeb7}.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-selector-class,.hljs-type{color:#de935f}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•å­</h2>
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é›†æˆ SearXNGï¼ŒæˆåŠŸè®©å¤§æ¨¡å‹â€œççœ¼çœ‹ä¸–ç•Œâ€ï¼Œå…·å¤‡äº†è·å–äº’è”ç½‘å®æ—¶ä¿¡æ¯çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œæ— è®ºæ˜¯ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰è¿˜æ˜¯è”ç½‘æœç´¢ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯è®© AI <strong>â€œè¯»â€</strong> æ›´å¤šçš„ä¹¦ï¼Œè·å–æ›´å¤šçš„ä¿¡æ¯ã€‚ä½†ä¸€ä¸ªçœŸæ­£çš„æ™ºèƒ½åŠ©æ‰‹ï¼Œä¸ä»…è¦èƒ½â€œè¯»â€ï¼Œè¿˜è¦èƒ½ <strong>â€œå†™â€</strong> å’Œ <strong>â€œåšâ€</strong>ã€‚</p>
<p>è¯•æƒ³è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä½ å¸Œæœ› AI å¸®ä½ æ•´ç†ä»Šå¤©çš„è‚¡å¸‚æ•°æ®ï¼Œå¹¶ç”Ÿæˆä¸€ä»½ Excel æŠ¥è¡¨ä¿å­˜åˆ°æ¡Œé¢ï¼›æˆ–è€…ä½ å¸Œæœ› AI å¸®ä½ ç»™å®¢æˆ·å‘é€ä¸€å°ä¼šè®®é‚€è¯·é‚®ä»¶ã€‚åœ¨ç›®å‰çš„æ¶æ„ä¸‹ï¼Œå¤§æ¨¡å‹åªèƒ½å‘Šè¯‰ä½ â€œé‚®ä»¶å†…å®¹å†™å¥½äº†ï¼Œè¯·ä½ å¤åˆ¶ç²˜è´´å»å‘é€â€ï¼Œå®ƒå°±åƒä¸€ä¸ªè¢«å›°åœ¨ç½å­é‡Œçš„â€œè¶…çº§å¤§è„‘â€ï¼Œè™½ç„¶åšå­¦ï¼Œå´æ— æ³•è§¦ç¢°ç°å®ä¸–ç•Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/112c3d4224da44c98b98068ddb0457d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=IFsNRY1NaTPVblNkYqWnRWxFTXM%3D" alt="1.png" loading="lazy"/></p>
<p>ä¸ºäº†æ‰“ç ´è¿™ä¸ªæ¬¡å…ƒå£ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ <strong>MCPï¼ˆModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰</strong>ã€‚å…³äºå®ƒçš„æ¦‚å¿µä¸å¤šèµ˜è¿°æ¦‚å¿µï¼Œç½‘ä¸Šç›¸å…³çš„æ–‡ç« å·²ç»å¾ˆå¤šäº†ï¼Œæœ‰éœ€è¦äº†è§£è¯·çœ‹MCPä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.mcpcn.org%2Fintroduction%25E3%2580%2582" target="_blank" title="https://docs.mcpcn.org/introduction%E3%80%82" ref="nofollow noopener noreferrer">docs.mcpcn.org/introductioâ€¦</a></p>
<p>æœ¬æ–‡å°†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†å®æˆ˜ MCPï¼š</p>
<ol>
<li><strong>ä½œä¸ºå®¢æˆ·ç«¯ï¼ˆClientï¼‰</strong>ï¼šè°ƒç”¨ç°æˆçš„ MCP æœåŠ¡ã€‚</li>
<li><strong>ä½œä¸ºæœåŠ¡ç«¯ï¼ˆServerï¼‰</strong>ï¼šå¼€å‘æˆ‘ä»¬è‡ªå·±çš„ MCP æœåŠ¡ã€‚</li>
</ol>
<h2 data-id="heading-1">è°ƒç”¨ MCP æœåŠ¡ï¼šæ“ä½œæœ¬åœ°æ–‡ä»¶</h2>
<p>Spring AI æä¾›äº† <code>spring-ai-mcp-client</code>ï¼Œå…è®¸æˆ‘ä»¬çš„åº”ç”¨è¿æ¥åˆ°ä»»ä½•éµå¾ª MCP æ ‡å‡†çš„æœåŠ¡å™¨ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥å®˜æ–¹æä¾›çš„ <strong>æ–‡ä»¶ç³»ç»Ÿ MCP æœåŠ¡å™¨</strong> ä¸ºä¾‹ï¼Œè®© AI å…·å¤‡åœ¨æœ¬åœ°åˆ›å»ºå’Œè¯»å–æ–‡ä»¶çš„èƒ½åŠ›ã€‚</p>
<blockquote>
<p><strong>å‰ææ¡ä»¶</strong>ï¼šç”±äºæ–‡ä»¶ç³»ç»Ÿ MCP æœåŠ¡æ˜¯åŸºäº Node.js çš„ï¼Œè¯·ç¡®ä¿ä½ çš„æœ¬åœ°ç¯å¢ƒå·²å®‰è£… Node.js (v18+)ã€‚</p>
</blockquote>
<h3 data-id="heading-2">1.æ·»åŠ ä¾èµ–</h3>
<p>åœ¨ <code>pom.xml</code> ä¸­å¼•å…¥ MCP Client ç›¸å…³çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-mcp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. é…ç½® MCP Server è¿æ¥</h3>
<p>MCP æ”¯æŒä¸¤ç§è¿æ¥æ¨¡å¼ï¼š<code>stdio</code>ï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼Œé€‚ç”¨äºæœ¬åœ°è¿›ç¨‹ï¼‰å’Œ <code>sse</code>ï¼ˆServer-Sent Eventsï¼Œé€‚ç”¨äºç½‘ç»œæœåŠ¡ï¼‰ã€‚å¯¹äºæœ¬åœ°æ–‡ä»¶ç³»ç»ŸæœåŠ¡ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>stdio</code> æ¨¡å¼ã€‚</p>
<p>åœ¨ <code>resources</code> ç›®å½•ä¸‹æ–°å»º <code>mcp-server.json</code> æ–‡ä»¶ï¼Œå®šä¹‰å¦‚ä½•å¯åŠ¨æ–‡ä»¶ç³»ç»ŸæœåŠ¡ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"filesystem"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"D:\\devolop\\node\\npx.cmd"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"-y"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"@modelcontextprotocol/server-filesystem"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"D:\\devolop"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p><strong>é…ç½®è§£æ</strong>ï¼š</p>
<ul>
<li><code>command</code>: æŒ‡å‘ä½ çš„ <code>npx</code> å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ˆWindows ä¸‹é€šå¸¸æ˜¯ <code>npx.cmd</code>ï¼‰ã€‚</li>
<li><code>args</code>:
<ul>
<li><code>-y</code>: è‡ªåŠ¨ç¡®è®¤å®‰è£…ã€‚</li>
<li><code>@modelcontextprotocol/server-filesystem</code>: å®˜æ–¹çš„æ–‡ä»¶ç³»ç»Ÿ MCP æœåŠ¡åŒ…ã€‚</li>
<li><code>D:\\devolop</code>: <strong>è¿™æ˜¯å…è®¸ AI è®¿é—®çš„æ ¹ç›®å½•</strong>ã€‚ä¸ºäº†å®‰å…¨èµ·è§ï¼ŒAI åªèƒ½æ“ä½œè¿™ä¸ªç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</li>
</ul>
</li>
</ul>
</blockquote>
<p>æ¥ç€ï¼Œåœ¨ <code>application.yml</code> ä¸­å¯ç”¨ MCP Client å¹¶åŠ è½½ä¸Šè¿°é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">mcp:</span>
      <span class="hljs-attr">client:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">spring-ai-mcp-client</span>
        <span class="hljs-attr">type:</span> <span class="hljs-string">ASYNC</span> <span class="hljs-comment"># æ¨èä½¿ç”¨å¼‚æ­¥éé˜»å¡æ¨¡å¼</span>
        <span class="hljs-attr">stdio:</span>
          <span class="hljs-attr">servers-configuration:</span> <span class="hljs-string">classpath:mcp-server.json</span>
</code></pre>
<h3 data-id="heading-4">3.ä»£ç æ”¹é€ </h3>
<p>æˆ‘ä»¬éœ€è¦åœ¨ <code>ChatService</code> åˆå§‹åŒ–æ—¶ï¼Œå°† MCP Client å‘ç°çš„å·¥å…·æ³¨å†Œåˆ° <code>ChatClient</code> ä¸­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatServiceImpl</span><span class="hljs-params">(ChatClient.Builder chatClientBuilder, ToolCallbackProvider tools)</span> {
   <span class="hljs-comment">// tools ä¼šè‡ªåŠ¨æ³¨å…¥æ‰€æœ‰é…ç½®å¥½çš„ MCP å·¥å…·</span>
   <span class="hljs-built_in">this</span>.chatClient = chatClientBuilder
           .defaultToolCallbacks(tools)
           .build();
}
</code></pre>
<h3 data-id="heading-5">4.æ•ˆæœæµ‹è¯•</h3>
<p>å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°MCPå·¥å…·å·²ç»è¿æ¥æˆåŠŸã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1f8cd1d8a5d47f0ab7b5327d43d3917~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=AXC0kWm7siV5b2xl4932ouzr8XU%3D" alt="2.png" loading="lazy"/></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨å¯¹è¯æ¡†ä¸­è¾“å…¥è¿™äº›å†…å®¹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e790c0f3a9e4389a92b1ea68527eecc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=dLxGT3uv1wqPvGt2SDp%2Fgqbhze0%3D" alt="3.png" loading="lazy"/></p>
<p>æ‰“å¼€æˆ‘ä»¬é…ç½®çš„ <code>D:\devolop</code> ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶å·²ç»è¢«æˆåŠŸåˆ›å»ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d84ab98b32e3487cb0759294bc6e896d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=Loch1pjLzpaxpdUEPXBmN%2F9%2BZv0%3D" alt="4.png" loading="lazy"/></p>
<h2 data-id="heading-6">å¼€å‘ MCP æœåŠ¡ï¼šé‚®ä»¶ä¸æ—¶é—´å·¥å…·</h2>
<p>é™¤äº†è°ƒç”¨ç°æœ‰çš„å·¥å…·ï¼Œæ›´å¸¸è§çš„åœºæ™¯æ˜¯å°†æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æŸ¥è¯¢å†…éƒ¨ç³»ç»Ÿã€å‘é€é€šçŸ¥ï¼‰å°è£…æˆ MCP å·¥å…·ä¾›å¤§æ¨¡å‹è°ƒç”¨ã€‚</p>
<p>ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å— <code>mcp-server</code>ï¼Œå®ç°â€œè·å–å½“å‰æ—¶é—´â€å’Œâ€œå‘é€é‚®ä»¶â€ä¸¤ä¸ªåŠŸèƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe20b85c399545a9a49031def2514858~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=Sg0I4aLQTFnFLcfNaoKs7A2iHh8%3D" alt="5.png" loading="lazy"/></p>
<p>åœ¨ <code>mcp-server</code> æ¨¡å—çš„ <code>pom.xml</code> ä¸­æ·»åŠ å¿…è¦çš„ä¾èµ–ã€‚é™¤äº† WebFluxï¼ˆMCP Server å¸¸ç”¨åº•å±‚ï¼‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ <code>spring-boot-starter-mail</code> æ¥å‘é€é‚®ä»¶ï¼Œä»¥åŠ <code>flexmark</code> ç”¨äºå°† AI ç”Ÿæˆçš„ Markdown å†…å®¹è½¬æ¢ä¸ºé‚®ä»¶å‹å¥½çš„ HTMLã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.cc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>SpringAI-MCP-RAG-Dev<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mcp-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- MCP Server ä¾èµ– --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-server-webflux<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- é‚®ä»¶å‘é€ä¾èµ– --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Markdown è½¬ HTML å·¥å…· --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.vladsch.flexmark<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flexmark-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.64.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.17.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">1.æ·»åŠ é…ç½®</h3>
<p>åœ¨ <code>application.yml</code> ä¸­é…ç½® OpenAI Keyã€Redisï¼ˆç”¨äºå‘é‡å­˜å‚¨æˆ–ç¼“å­˜ï¼‰ä»¥åŠ SMTP é‚®ä»¶æœåŠ¡ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">spring-ai-mcp-server</span>
  <span class="hljs-attr">data:</span>
    <span class="hljs-attr">redis:</span>
      <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">9379</span>
      <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">mcp:</span>
      <span class="hljs-attr">server:</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">spring-ai-mcp-server-sse</span>
        <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
        <span class="hljs-attr">sse-endpoint:</span> <span class="hljs-string">/sse</span>
        <span class="hljs-attr">type:</span> <span class="hljs-string">async</span>
  <span class="hljs-attr">mail:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">smtp.163.com</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">465</span>
    <span class="hljs-attr">username:</span> <span class="hljs-number">123</span><span class="hljs-string">@163.com</span>
    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>  <span class="hljs-comment"># æ³¨æ„ï¼šè¿™é‡Œé€šå¸¸æ˜¯é‚®ç®±æˆæƒç ï¼Œä¸æ˜¯ç™»å½•å¯†ç </span>
    <span class="hljs-attr">protocol:</span> <span class="hljs-string">smtp</span>
    <span class="hljs-attr">default-encoding:</span> <span class="hljs-string">UTF-8</span>
    <span class="hljs-attr">properties:</span>
      <span class="hljs-attr">mail:</span>
        <span class="hljs-attr">smtp:</span>
          <span class="hljs-attr">socketFactory:</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">465</span>
            <span class="hljs-attr">class:</span> <span class="hljs-string">javax.net.ssl.SSLSocketFactory</span>
          <span class="hljs-attr">ssl:</span>
            <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>


<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">root:</span> <span class="hljs-string">info</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">6080</span>
</code></pre>
<p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—® <code>http://localhost:6080/sse</code>ï¼Œå¦‚æœèƒ½æ­£å¸¸å¯åŠ¨ï¼Œè¯´æ˜é…ç½®æ— è¯¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a67f2f1af6f34769843a7524e37ee111~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=QRjpB0UFv4bRBOcVjlN1G5q0Is4%3D" alt="6.png" loading="lazy"/></p>
<h3 data-id="heading-8">2. å¼€å‘æ—¶é—´æŸ¥è¯¢å·¥å…·</h3>
<p>å¤§æ¨¡å‹æœ¬èº«å¯¹â€œç°åœ¨æ˜¯å‡ ç‚¹â€æ²¡æœ‰æ¦‚å¿µï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå·¥å…·ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.cc.mcp.tool;

<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.ai.tool.annotation.Tool;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.format.DateTimeFormatter;

<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DateTool</span> {

    <span class="hljs-comment">// @Tool æ³¨è§£å°†æ–¹æ³•æš´éœ²ä¸º MCP å·¥å…·</span>
    <span class="hljs-comment">// description éå¸¸é‡è¦ï¼Œå¤§æ¨¡å‹æ ¹æ®å®ƒæ¥åˆ¤æ–­ä½•æ—¶è°ƒç”¨æ­¤å·¥å…·</span>
    <span class="hljs-meta">@Tool(description = "è·å–å½“å‰æ—¶é—´")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCurrentTime</span><span class="hljs-params">()</span> {
        log.info(<span class="hljs-string">"=================è°ƒç”¨MCPå·¥å…·ï¼šè·å–å½“å‰æ—¶é—´================="</span>);
        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"å½“å‰çš„æ—¶é—´æ˜¯ %s"</span>, LocalDateTime.now().format(DateTimeFormatter.ofPattern(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>)));
    }

}

</code></pre>
<h3 data-id="heading-9">3. å¼€å‘é‚®ä»¶å‘é€å·¥å…·</h3>
<p>è¿™æ˜¯ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„å·¥å…·ï¼Œéœ€è¦å®šä¹‰å‚æ•°ç»“æ„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.cc.mcp.tool;

<span class="hljs-keyword">import</span> com.vladsch.flexmark.html.HtmlRenderer;
<span class="hljs-keyword">import</span> com.vladsch.flexmark.parser.Parser;
<span class="hljs-keyword">import</span> com.vladsch.flexmark.util.data.MutableDataSet;
<span class="hljs-keyword">import</span> jakarta.mail.MessagingException;
<span class="hljs-keyword">import</span> jakarta.mail.internet.MimeMessage;
<span class="hljs-keyword">import</span> lombok.*;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.ai.tool.annotation.Tool;
<span class="hljs-keyword">import</span> org.springframework.ai.tool.annotation.ToolParam;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.JavaMailSender;
<span class="hljs-keyword">import</span> org.springframework.mail.javamail.MimeMessageHelper;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailTool</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JavaMailSender mailSender;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String from;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">EmailTool</span><span class="hljs-params">(JavaMailSender mailSender, <span class="hljs-meta">@Value("${spring.mail.username}")</span> String from)</span> {
        <span class="hljs-built_in">this</span>.mailSender = mailSender;
        <span class="hljs-built_in">this</span>.from = from;
    }

    <span class="hljs-comment">// å®šä¹‰è¯·æ±‚å‚æ•°ç±»ï¼Œå¤§æ¨¡å‹ä¼šè‡ªåŠ¨å¡«å……è¿™äº›å­—æ®µ</span>
    <span class="hljs-meta">@Data</span>
    <span class="hljs-meta">@ToString</span>
    <span class="hljs-meta">@NoArgsConstructor</span>
    <span class="hljs-meta">@AllArgsConstructor</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailRequest</span> {
        <span class="hljs-meta">@ToolParam(description = "æ”¶ä»¶äººé‚®ç®±åœ°å€")</span>
        <span class="hljs-keyword">private</span> String email;
        
        <span class="hljs-meta">@ToolParam(description = "å‘é€é‚®ä»¶çš„æ ‡é¢˜/ä¸»é¢˜")</span>
        <span class="hljs-keyword">private</span> String subject;
        
        <span class="hljs-meta">@ToolParam(description = "å‘é€é‚®ä»¶çš„æ¶ˆæ¯/æ­£æ–‡å†…å®¹")</span>
        <span class="hljs-keyword">private</span> String message;
        
        <span class="hljs-meta">@ToolParam(description = "å‘é€é‚®ä»¶çš„å†…å®¹ç±»å‹ï¼Œ1ä¸ºHTMLæ ¼å¼ï¼Œ2ä¸ºæ™®é€šæ–‡æœ¬æ ¼å¼")</span>
        <span class="hljs-keyword">private</span> Integer contentType;
    }

    <span class="hljs-meta">@Tool(description = "ç»™æŒ‡å®šé‚®ç®±å‘é€é‚®ä»¶ä¿¡æ¯ã€‚")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">sendEmail</span><span class="hljs-params">(EmailRequest emailRequest)</span> {
        log.info(<span class="hljs-string">"=================è°ƒç”¨MCPå·¥å…·ï¼šsendEmail================="</span>);
        log.info(<span class="hljs-string">"è¯·æ±‚è¯¦æƒ…: {}"</span>, emailRequest);

        <span class="hljs-type">Integer</span> <span class="hljs-variable">contentType</span> <span class="hljs-operator">=</span> emailRequest.getContentType();

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">MimeMessage</span> <span class="hljs-variable">mimeMessage</span> <span class="hljs-operator">=</span> mailSender.createMimeMessage();
            <span class="hljs-type">MimeMessageHelper</span> <span class="hljs-variable">mimeMessageHelper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MimeMessageHelper</span>(mimeMessage);
            
            mimeMessageHelper.setFrom(from);
            mimeMessageHelper.setTo(emailRequest.getEmail());
            mimeMessageHelper.setSubject(emailRequest.getSubject());
            
            <span class="hljs-comment">// æ™ºèƒ½å¤„ç†ï¼šå¦‚æœæ˜¯ Markdown æ ¼å¼ï¼Œè‡ªåŠ¨è½¬ HTML</span>
            <span class="hljs-keyword">if</span> (contentType != <span class="hljs-literal">null</span> &amp;&amp; contentType == <span class="hljs-number">1</span>) {
                mimeMessageHelper.setText(convertMarkdownToHtml(emailRequest.getMessage()), <span class="hljs-literal">true</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (contentType != <span class="hljs-literal">null</span> &amp;&amp; contentType == <span class="hljs-number">2</span>) {
                mimeMessageHelper.setText(emailRequest.getMessage(), <span class="hljs-literal">true</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// é»˜è®¤å¤„ç†</span>
                mimeMessageHelper.setText(emailRequest.getMessage());
            }
            
            mailSender.send(mimeMessage);
            <span class="hljs-keyword">return</span> <span class="hljs-string">"é‚®ä»¶å‘é€æˆåŠŸ"</span>;
            
        } <span class="hljs-keyword">catch</span> (MessagingException e) {
            log.error(<span class="hljs-string">"å‘é€é‚®ä»¶å¤±è´¥"</span>, e);
            <span class="hljs-keyword">return</span> <span class="hljs-string">"å‘é€é‚®ä»¶å¤±è´¥: "</span> + e.getMessage();
        }
    }

    <span class="hljs-comment">/**
     * å°†Markdownæ ¼å¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºHTMLæ ¼å¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">convertMarkdownToHtml</span><span class="hljs-params">(String markdownStr)</span> {
        <span class="hljs-type">MutableDataSet</span> <span class="hljs-variable">dataSet</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableDataSet</span>();
        <span class="hljs-type">Parser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> Parser.builder(dataSet).build();
        <span class="hljs-type">HtmlRenderer</span> <span class="hljs-variable">htmlRenderer</span> <span class="hljs-operator">=</span> HtmlRenderer.builder(dataSet).build();
        <span class="hljs-keyword">return</span> htmlRenderer.render(parser.parse(markdownStr));
    }
}
</code></pre>
<h3 data-id="heading-10">4. æ³¨å†Œå·¥å…·</h3>
<p>æœ€åï¼Œåœ¨å¯åŠ¨ç±»æˆ–é…ç½®ç±»ä¸­ï¼Œå°†æˆ‘ä»¬ç¼–å†™çš„ Tool Bean æ³¨å†Œåˆ° <code>ToolCallbackProvider</code> ä¸­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">cc</span>.<span class="hljs-property">mcp</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">cc</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">tool</span>.<span class="hljs-property">DateTool</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">cc</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">tool</span>.<span class="hljs-property">EmailTool</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">ai</span>.<span class="hljs-property">tool</span>.<span class="hljs-property">ToolCallbackProvider</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">ai</span>.<span class="hljs-property">tool</span>.<span class="hljs-property">method</span>.<span class="hljs-property">MethodToolCallbackProvider</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">boot</span>.<span class="hljs-property">SpringApplication</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">boot</span>.<span class="hljs-property">autoconfigure</span>.<span class="hljs-property">SpringBootApplication</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Bean</span>;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-title class_">SpringApplication</span>.<span class="hljs-title function_">run</span>(<span class="hljs-title class_">Application</span>.<span class="hljs-property">class</span>, args);
    }

    <span class="hljs-comment">/**
     * æ³¨å†Œè‡ªå®šä¹‰ MCP å·¥å…·
     * è¿™æ · ChatClient å°±èƒ½æ„ŸçŸ¥åˆ°è¿™äº›å·¥å…·çš„å­˜åœ¨
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">ToolCallbackProvider</span> <span class="hljs-title function_">registerMCPTools</span>(<span class="hljs-params">DateTool dateTool, EmailTool emailTool</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">MethodToolCallbackProvider</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">toolObjects</span>(dateTool, emailTool)
                .<span class="hljs-title function_">build</span>();
    }
}
</code></pre>
<h3 data-id="heading-11">5. ç»¼åˆæµ‹è¯•</h3>
<p>å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯Ÿæ—¥å¿—ï¼Œç¡®è®¤å·¥å…·å·²åŠ è½½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/737862a3ab9347dfbd6c23e6ee18bb53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=ueP9o3ecwR4TUSjZvjOFLsUfJtc%3D" alt="7.png" loading="lazy"/></p>
<p><strong>æµ‹è¯•æ—¶é—´æŸ¥è¯¢ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55fc42de75c246068f6ef736de5ffc13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=02Erj%2FpcfdAbDI%2BsTDYz8oD4CpE%3D" alt="8.png" loading="lazy"/></p>
<p><strong>æµ‹è¯•é‚®ä»¶å‘é€ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/076dee406d41468a88a5a2f96bd2231e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=9QT%2FNW4DdvbBpJ7P0CLBxPkhE8I%3D" alt="9.png" loading="lazy"/></p>
<h2 data-id="heading-12">å¢åŠ è®°å¿†åŠŸèƒ½ï¼šè®©å¯¹è¯æ›´è¿è´¯</h2>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåˆ†å¤šè½®å¯¹è¯æ¥å®Œæˆä»»åŠ¡ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ChatClient</code> æ˜¯æ— çŠ¶æ€çš„ï¼Œå®ƒè®°ä¸ä½ä¸Šä¸€å¥è¯´äº†ä»€ä¹ˆï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee71c0d5358346a9948565c436945b86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=vxLNwxK8ZDra3iEjG1MFy7Esz2w%3D" alt="10.png" loading="lazy"/></p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ <strong>Chat Memory</strong>ã€‚åœ¨ <code>ChatServiceImpl</code> ä¸­æ³¨å…¥ <code>ChatMemory</code>ï¼Œå¹¶å°†å…¶é…ç½®åˆ° <code>ChatClient</code> ä¸­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient chatClient;

    <span class="hljs-comment">// æ³¨å…¥ ChatMemory</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatServiceImpl</span><span class="hljs-params">(ChatClient.Builder chatClientBuilder, 
                           ToolCallbackProvider tools, 
                           ChatMemory chatMemory)</span> {
        <span class="hljs-built_in">this</span>.chatClient = chatClientBuilder
                <span class="hljs-comment">// æ·»åŠ è®°å¿† Advisor</span>
                .defaultAdvisors(MessageChatMemoryAdvisor.builder(chatMemory).build())
                .defaultToolCallbacks(tools)
                .build();
    }
</code></pre>
<p>é…ç½®å®Œæˆåï¼Œæ¨¡å‹å°±å…·å¤‡äº†ä¸Šä¸‹æ–‡è®°å¿†èƒ½åŠ›ï¼Œèƒ½å¤Ÿæµç•…åœ°å¤„ç†å¤šè½®æ„å›¾ç¡®è®¤ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eeea39ce518841f4a8d5fa04137f67cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766935328&amp;x-signature=O0DPjUCJhJXSgOyua9pl6qKzZLk%3D" alt="11.png" loading="lazy"/></p>
<h2 data-id="heading-13">å°ç»“</h2>
<p>é€šè¿‡æœ¬ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å®ç°äº† Spring AI åº”ç”¨åŠŸèƒ½çš„é‡å¤§é£è·ƒï¼šä»å•çº¯çš„â€œä¿¡æ¯è·å–è€…â€è¿›åŒ–ä¸ºäº†â€œä»»åŠ¡æ‰§è¡Œè€…â€ã€‚</p>
<ol>
<li>åˆ©ç”¨ <strong>MCP Client</strong>ï¼Œæˆ‘ä»¬è½»æ¾é›†æˆäº†ç°æœ‰çš„æ–‡ä»¶ç³»ç»ŸæœåŠ¡ã€‚</li>
<li>åˆ©ç”¨ <strong>Spring AI Tool</strong>ï¼Œæˆ‘ä»¬å¼€å‘äº†è‡ªå®šä¹‰çš„é‚®ä»¶å’Œæ—¶é—´æœåŠ¡ã€‚</li>
<li>åˆ©ç”¨ <strong>Chat Memory</strong>ï¼Œæˆ‘ä»¬èµ‹äºˆäº† AI è®°å¿†ï¼Œä½¿å…¶äº¤äº’æ›´åŠ è‡ªç„¶ã€‚</li>
</ol>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„ AI å·²ç»å¯ä»¥æ“ä½œæ–‡ä»¶ã€å‘é€é‚®ä»¶äº†ã€‚ä½†åœ¨ä¼ä¸šçº§åº”ç”¨ä¸­ï¼Œæœ€æ ¸å¿ƒçš„æ•°æ®å¾€å¾€å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚å¦‚ä½•è®©å¤§æ¨¡å‹å®‰å…¨ã€å‡†ç¡®åœ°æŸ¥è¯¢å’Œæ“ä½œæ•°æ®åº“ï¼Ÿä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ¢è®¨<strong>åŸºäº MCP çš„å¤§æ¨¡å‹ä¸æ•°æ®åº“äº¤äº’å¼€å‘</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JobFlowå·²å¼€æºï¼šé¢å‘ä¸šåŠ¡ä¸­å°çš„è½»é‡çº§åˆ†å¸ƒå¼è°ƒåº¦å¼•æ“ â€” æ”¯æŒåŠ¨æ€åˆ†ç‰‡ä¸å»¶æ—¶é˜Ÿåˆ—]]></title>    <link>https://juejin.cn/post/7585693761533083682</link>    <guid>https://juejin.cn/post/7585693761533083682</guid>    <pubDate>2025-12-21T15:38:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585693761533083682" data-draft-id="7585727457472872448" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JobFlowå·²å¼€æºï¼šé¢å‘ä¸šåŠ¡ä¸­å°çš„è½»é‡çº§åˆ†å¸ƒå¼è°ƒåº¦å¼•æ“ â€” æ”¯æŒåŠ¨æ€åˆ†ç‰‡ä¸å»¶æ—¶é˜Ÿåˆ—"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,å¼€æº"/> <meta itemprop="datePublished" content="2025-12-21T15:38:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JobFlowå·²å¼€æºï¼šé¢å‘ä¸šåŠ¡ä¸­å°çš„è½»é‡çº§åˆ†å¸ƒå¼è°ƒåº¦å¼•æ“ â€” æ”¯æŒåŠ¨æ€åˆ†ç‰‡ä¸å»¶æ—¶é˜Ÿåˆ—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T15:38:44.000Z" title="Sun Dec 21 2025 15:38:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“– é¡¹ç›®ç®€ä»‹</h2>
<p>JobFlow æ˜¯é¢å‘ä¸šåŠ¡ä¸­å°çš„è½»é‡çº§ã€é«˜æ€§èƒ½åˆ†å¸ƒå¼è°ƒåº¦å¼•æ“ï¼Œä¸“ä¸º Nacos ä½“ç³»æ‰“é€ ï¼Œåœ¨ä¸å¼•å…¥ä»»ä½•æ–°ä¸­é—´ä»¶çš„å‰æä¸‹ï¼Œå°†ä»»åŠ¡è°ƒåº¦ã€åŠ¨æ€åˆ†ç‰‡å’Œå»¶æ—¶é˜Ÿåˆ—èƒ½åŠ›å†…å»ºåˆ°å¾®æœåŠ¡æ¶æ„ä¹‹ä¸­ã€‚</p>
<h2 data-id="heading-1">ğŸ”— å¼€æºåœ°å€ä¸ç³»åˆ—æ–‡ç« </h2>
<ul>
<li><strong>å¼€æºåœ°å€</strong>ï¼š<code>https://gitee.com/sh_wangwanbao/job-flow</code></li>
<li><strong>ç³»åˆ—æ–‡ç« ï¼š</strong>
<ul>
<li><a href="https://juejin.cn/post/7583469866007969827" target="_blank" title="https://juejin.cn/post/7583469866007969827">ç¬¬ä¸€ç¯‡ï¼šåŸºäºNacosçš„è½»é‡ä»»åŠ¡è°ƒåº¦æ–¹æ¡ˆ â€”â€” ä» XXL-Job çš„ç—›ç‚¹è¯´èµ·</a></li>
<li><a href="https://juejin.cn/post/7584353612501106729" target="_blank" title="https://juejin.cn/post/7584353612501106729">ç¬¬äºŒç¯‡ï¼šJobFlow å®ç°æ–¹æ¡ˆï¼šäº‘åŸç”Ÿæ—¶ä»£çš„ä»»åŠ¡è°ƒåº¦æ–°æ€è·¯</a></li>
<li><a href="https://juejin.cn/post/7585727457472823296" target="_blank" title="https://juejin.cn/post/7585727457472823296">ç¬¬ä¸‰ç¯‡ï¼šJobFlow å®æˆ˜ï¼šæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšåˆ°çš„</a></li>
<li>ç¬¬å››ç¯‡ï¼šåˆ†å¸ƒå¼è°ƒåº¦çš„ç»ˆæéš¾é¢˜ï¼šè¶…æ—¶ã€è¡¥å¿ä¸æ¼è°ƒï¼ˆç»Ÿå†™ä¸­ï¼‰</li>
<li>ç¬¬äº”ç¯‡ï¼šå»¶æ—¶é˜Ÿåˆ—çš„è®¾è®¡ä¸å®ç°ï¼ˆç»Ÿå†™ä¸­ï¼‰</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">âœ¨ æ ¸å¿ƒåŠŸèƒ½</h2>
<h3 data-id="heading-3">1. è°ƒåº¦ä¸­å°åŒ–ï¼šè°ƒåº¦å³ä¸šåŠ¡</h3>
<p><strong>è®¾è®¡ç†å¿µï¼š</strong></p>
<ul>
<li>è°ƒåº¦å™¨ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„â€œå¹³å°â€ï¼Œè€Œæ˜¯ä¸šåŠ¡ä¸­å°çš„ä¸€éƒ¨åˆ†</li>
<li>ä¸éœ€è¦é¢å¤–çš„ç®¡ç†åå°ï¼Œç›´æ¥é€šè¿‡æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶ç®¡ç†</li>
<li>å¤ç”¨ç°æœ‰çš„ç›‘æ§ã€æ—¥å¿—ã€æœåŠ¡å‘ç°ä½“ç³»</li>
</ul>
<p><strong>ä¸ä¼ ç»Ÿæ–¹æ¡ˆå¯¹æ¯”ï¼š</strong></p>



































<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿè°ƒåº¦å¹³å°</th><th>JobFlow ä¸­å°åŒ–</th></tr></thead><tbody><tr><td>å®šä½</td><td>ç‹¬ç«‹çš„è°ƒåº¦å¹³å°</td><td>ä¸šåŠ¡ä¸­å°çš„ä¸€éƒ¨åˆ†</td></tr><tr><td>ç®¡ç†æ–¹å¼</td><td>Web ç®¡ç†åå°</td><td>æ•°æ®åº“ + é…ç½®æ–‡ä»¶</td></tr><tr><td>è¿ç»´å›¢é˜Ÿ</td><td>éœ€è¦ä¸“é—¨è¿ç»´</td><td>ä¸šåŠ¡å›¢é˜Ÿè‡ªå·±ç»´æŠ¤</td></tr><tr><td>ç›‘æ§æ—¥å¿—</td><td>éœ€è¦å•ç‹¬æ¥å…¥</td><td>å¤ç”¨ç°æœ‰ä½“ç³»</td></tr><tr><td>æœåŠ¡å‘ç°</td><td>è‡ªå»ºæ³¨å†Œä¸­å¿ƒ</td><td>å¤ç”¨ Nacos</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong></p>
<ul>
<li>é›¶é¢å¤–è¿ç»´æˆæœ¬ï¼šå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Spring Boot å¾®æœåŠ¡</li>
<li>ä½å­¦ä¹ æˆæœ¬ï¼šå¤ç”¨ç°æœ‰æŠ€æœ¯æ ˆï¼Œæ— éœ€å­¦ä¹ æ–°å¹³å°</li>
<li>é«˜é›†æˆåº¦ï¼šä¸ä¸šåŠ¡ä¸­å°ç´§å¯†é›†æˆï¼Œä¸æ˜¯â€œå¤–éƒ¨ç³»ç»Ÿâ€</li>
</ul>
<h3 data-id="heading-4">2. åˆ†ç‰‡è°ƒåº¦æœºåˆ¶ï¼ˆæ ¸å¿ƒäº®ç‚¹ï¼‰</h3>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡ï¼Ÿ</strong></p>
<p>å½“å¤„ç†å¤§æ•°æ®é‡ä»»åŠ¡æ—¶ï¼ˆå¦‚ç»™ 100 ä¸‡ç”¨æˆ·å‘é€é€šçŸ¥ï¼‰ï¼Œå•å®ä¾‹æ‰§è¡Œéœ€è¦å¾ˆé•¿æ—¶é—´ã€‚åˆ†ç‰‡å¯ä»¥ï¼š</p>
<ul>
<li>å°†å¤§ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡</li>
<li>å¤šä¸ªæ‰§è¡Œå™¨å¹¶è¡Œå¤„ç†</li>
<li>æ˜¾è‘—ç¼©çŸ­æ€»æ‰§è¡Œæ—¶é—´</li>
</ul>
<p><strong>JobFlow çš„åˆ†ç‰‡è®¾è®¡ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">çˆ¶å­è®°å½•ç»“æ„ï¼š
- çˆ¶è®°å½•ï¼ˆjob_executionï¼‰ï¼šè®°å½•æ•´ä½“ä»»åŠ¡ä¿¡æ¯
- å­è®°å½•ï¼ˆjob_sub_executionï¼‰ï¼šæ¯ä¸ªåˆ†ç‰‡çš„æ‰§è¡Œè®°å½•

å›è°ƒé©±åŠ¨åŠ¨æ€åˆ†é…ï¼š
1. è°ƒåº¦å™¨è§¦å‘ä»»åŠ¡ï¼Œåˆ›å»ºçˆ¶å­è®°å½•
2. åˆå§‹åˆ†é… min(n, m) ä¸ªåˆ†ç‰‡
   - <span class="hljs-attr">n</span> = æ‰§è¡Œå™¨å®ä¾‹æ•°
   - <span class="hljs-attr">m</span> = é…ç½®çš„åˆ†ç‰‡æ•°
3. æ‰§è¡Œå™¨å®Œæˆåˆ†ç‰‡åå›è°ƒè°ƒåº¦å™¨
4. è°ƒåº¦å™¨åŠ¨æ€åˆ†é…ä¸‹ä¸€ä¸ª PENDING åˆ†ç‰‡
5. å¾ªç¯ç›´åˆ°æ‰€æœ‰åˆ†ç‰‡å®Œæˆ

ä¹è§‚é” CAS æŠ¢å ï¼š
- å¤šä¸ªæ‰§è¡Œå™¨åŒæ—¶å›è°ƒæ—¶ï¼Œé€šè¿‡ CAS æ›´æ–°æŠ¢å åˆ†ç‰‡
- WHERE <span class="hljs-attr">id</span> = ? AND status = <span class="hljs-string">'PENDING'</span> AND version = ?
- åªæœ‰ä¸€ä¸ªæ‰§è¡Œå™¨èƒ½æŠ¢åˆ°ï¼Œå…¶ä»–è‡ªåŠ¨é‡è¯•
</code></pre>
<p><strong>ä¼˜åŠ¿å¯¹æ¯”ï¼š</strong></p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»Ÿé™æ€åˆ†ç‰‡</th><th>JobFlow åŠ¨æ€åˆ†ç‰‡</th></tr></thead><tbody><tr><td>åˆ†ç‰‡åˆ†é…</td><td>è°ƒåº¦æ—¶ä¸€æ¬¡åˆ†é…å®Œ</td><td>å›è°ƒé©±åŠ¨åŠ¨æ€åˆ†é…</td></tr><tr><td>è´Ÿè½½å‡è¡¡</td><td>ä¸å‡è¡¡ï¼ˆæ…¢å®ä¾‹å¡ä½ï¼‰</td><td>è‡ªåŠ¨å‡è¡¡ï¼ˆå¿«å®ä¾‹å¤šå¤„ç†ï¼‰</td></tr><tr><td>å®ä¾‹å˜åŒ–</td><td>éœ€è¦é‡æ–°è°ƒåº¦</td><td>è‡ªåŠ¨é€‚åº”</td></tr><tr><td>å¹¶å‘æ§åˆ¶</td><td>å›ºå®šå¹¶å‘æ•°</td><td>åŠ¨æ€å¹¶å‘ï¼ˆæ ¹æ®å®é™…è´Ÿè½½ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-5">3. å»¶æ—¶é˜Ÿåˆ—ï¼ˆç‹¬ç«‹è®¾è®¡ï¼‰</h3>
<ul>
<li><strong>ä¸€æ¬¡æ€§å»¶æ—¶ä»»åŠ¡</strong>ï¼šæ”¯æŒä»»æ„æ—¶é—´åæ‰§è¡Œçš„å»¶æ—¶ä»»åŠ¡</li>
<li><strong>ä¸šåŠ¡å‚æ•°é€ä¼ </strong>ï¼šé€šè¿‡ JSON Payload ä¼ é€’ä¸šåŠ¡å‚æ•°</li>
<li><strong>æŒ‡æ•°é€€é¿é‡è¯•</strong>ï¼šå¤±è´¥åè‡ªåŠ¨é‡è¯•ï¼ˆ3åˆ†é’Ÿ â†’ 5åˆ†é’Ÿï¼Œæœ€å¤š3æ¬¡ï¼‰</li>
<li><strong>å¹‚ç­‰æ€§ä¿è¯</strong>ï¼šåŸºäº bizUuid çš„å”¯ä¸€çº¦æŸï¼Œé˜²æ­¢é‡å¤æäº¤</li>
</ul>
<h3 data-id="heading-6">4. é«˜å¯ç”¨ä¿éšœ</h3>
<ul>
<li><strong>æ— é”è°ƒåº¦</strong>ï¼šHash åˆ†åŒº + Owner åˆ¤å®šï¼Œé¿å…åˆ†å¸ƒå¼é”</li>
<li><strong>è¶…æ—¶å·¡æ£€</strong>ï¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ ‡è®°è¶…æ—¶ä»»åŠ¡</li>
<li><strong>åˆ†ç‰‡è¡¥å¿</strong>ï¼šPENDING/RUNNING è¶…æ—¶åˆ†ç‰‡è‡ªåŠ¨é‡è¯•</li>
<li><strong>ä½é¢‘æ¼è°ƒæ£€æµ‹</strong>ï¼šå°æ—¶çº§ä»»åŠ¡çš„æ¼è°ƒè‡ªåŠ¨è¡¥å¿</li>
</ul>
<h3 data-id="heading-7">5. å¯è§‚æµ‹æ€§</h3>
<ul>
<li><strong>å…¨é“¾è·¯ TraceId</strong>ï¼šä»è°ƒåº¦å™¨åˆ°æ‰§è¡Œå™¨çš„å®Œæ•´é“¾è·¯è¿½è¸ª</li>
<li><strong>è¯¦ç»†æ—¥å¿—</strong>ï¼šå…³é”®èŠ‚ç‚¹çš„å®Œæ•´æ—¥å¿—è®°å½•</li>
<li><strong>çŠ¶æ€å¯æŸ¥</strong>ï¼šæ•°æ®åº“çŠ¶æ€å®æ—¶å¯æŸ¥ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</li>
</ul>
<h2 data-id="heading-8">ğŸ†š ä¸ XXL-Job å¯¹æ¯”</h2>


















































<table><thead><tr><th>ç‰¹æ€§</th><th>JobFlow</th><th>XXL-Job</th></tr></thead><tbody><tr><td><strong>æœåŠ¡å‘ç°</strong></td><td>âœ… å¤ç”¨ Nacos</td><td>âŒ ç‹¬ç«‹å®ç°ï¼ˆæ‰‹åŠ¨æ³¨å†Œï¼‰</td></tr><tr><td><strong>ä¾èµ–ä¸­é—´ä»¶</strong></td><td>ä»…éœ€ MySQL + Nacos</td><td>MySQL + ç‹¬ç«‹è°ƒåº¦ä¸­å¿ƒ</td></tr><tr><td><strong>åˆ†ç‰‡ç­–ç•¥</strong></td><td>åŠ¨æ€å›è°ƒé©±åŠ¨ + ä¹è§‚é” CAS</td><td>é™æ€åˆ†é…ï¼ˆè°ƒåº¦æ—¶ç¡®å®šï¼‰</td></tr><tr><td><strong>å»¶æ—¶é˜Ÿåˆ—</strong></td><td>âœ… åŸç”Ÿæ”¯æŒï¼ˆç‹¬ç«‹è®¾è®¡ï¼‰</td><td>âŒ ä¸æ”¯æŒ</td></tr><tr><td><strong>æ— é”è°ƒåº¦</strong></td><td>âœ… Hash åˆ†åŒº</td><td>éœ€è¦åˆ†å¸ƒå¼é”</td></tr><tr><td><strong>ä½é¢‘è¡¥å¿</strong></td><td>âœ… è‡ªåŠ¨æ£€æµ‹å°æ—¶çº§ä»»åŠ¡æ¼è°ƒ</td><td>âŒ ä¸æ”¯æŒ</td></tr><tr><td><strong>æ¶æ„å¤æ‚åº¦</strong></td><td>è½»é‡çº§ï¼ˆæ— è°ƒåº¦ä¸­å¿ƒ UIï¼‰</td><td>é‡é‡çº§ï¼ˆåŒ…å«å®Œæ•´ç®¡ç†åå°ï¼‰</td></tr><tr><td><strong>å­¦ä¹ æˆæœ¬</strong></td><td>ä½ï¼ˆå¤ç”¨ Spring Boot ç”Ÿæ€ï¼‰</td><td>ä¸­ç­‰</td></tr></tbody></table>
<h2 data-id="heading-9">ğŸ¯ è®¾è®¡ç†å¿µ</h2>
<h3 data-id="heading-10">1. å¤ç”¨ä¼˜äºé‡é€ </h3>
<ul>
<li><strong>Nacos æœåŠ¡å‘ç°</strong>ï¼šä¸é‡å¤é€ è½®å­ï¼Œç›´æ¥å¤ç”¨å¾®æœåŠ¡åŸºç¡€è®¾æ–½</li>
<li><strong>HTTP è°ƒç”¨</strong>ï¼šå¤ç”¨ Spring Boot Web èƒ½åŠ›ï¼Œæ— éœ€è‡ªå®šä¹‰åè®®</li>
<li><strong>ç»Ÿä¸€æ³¨è§£</strong>ï¼šå‘¨æœŸä»»åŠ¡å’Œå»¶æ—¶ä»»åŠ¡å…±äº« <code>@JobHandler</code> æ³¨è§£</li>
</ul>
<h3 data-id="heading-11">2. å…³æ³¨ç‚¹åˆ†ç¦»</h3>
<ul>
<li><strong>Cron å±‚æŠ½è±¡</strong>ï¼šæ‰€æœ‰å®šæ—¶ä»»åŠ¡ç»Ÿä¸€ç”± <code>CronTasks</code> è§¦å‘ï¼Œä¸šåŠ¡é€»è¾‘åœ¨ Service å±‚</li>
<li><strong>ç‹¬ç«‹è¡¨è®¾è®¡</strong>ï¼šå»¶æ—¶ä»»åŠ¡ä½¿ç”¨ç‹¬ç«‹çš„ <code>job_delay_task</code> è¡¨ï¼Œä¸å‘¨æœŸä»»åŠ¡è§£è€¦</li>
<li><strong>èŒè´£å•ä¸€</strong>ï¼šæ¯ä¸ªæ¨¡å—ä¸“æ³¨äºè‡ªå·±çš„æ ¸å¿ƒèŒè´£</li>
</ul>
<h3 data-id="heading-12">3. é«˜æ€§ä»·æ¯”å®¹é”™</h3>
<ul>
<li><strong>æ•°æ®åº“å…œåº•</strong>ï¼šé€šè¿‡å”¯ä¸€ç´¢å¼•é˜²æ­¢é‡å¤è°ƒåº¦ï¼Œæ— éœ€åˆ†å¸ƒå¼é”</li>
<li><strong>CAS ä¹è§‚é”</strong>ï¼šåˆ†ç‰‡æŠ¢å ä½¿ç”¨æ•°æ®åº“ CASï¼Œç®€å•å¯é </li>
<li><strong>æŒ‡æ•°é€€é¿</strong>ï¼šå¤±è´¥é‡è¯•é‡‡ç”¨æŒ‡æ•°é€€é¿ï¼Œé¿å…é›ªå´©</li>
</ul>
<h3 data-id="heading-13">4. è½»é‡çº§ä¼˜å…ˆ</h3>
<ul>
<li><strong>æ—  UI ç®¡ç†åå°</strong>ï¼šé€šè¿‡é…ç½®æ–‡ä»¶å’Œæ•°æ®åº“ç®¡ç†ä»»åŠ¡ï¼Œé™ä½è¿ç»´æˆæœ¬</li>
<li><strong>æœ€å°ä¾èµ–</strong>ï¼šåªä¾èµ– Spring Bootã€MySQLã€Nacos</li>
<li><strong>ç®€å•éƒ¨ç½²</strong>ï¼šè°ƒåº¦å™¨å’Œæ‰§è¡Œå™¨éƒ½æ˜¯æ ‡å‡†çš„ Spring Boot åº”ç”¨</li>
</ul>
<h2 data-id="heading-14">ğŸ—ï¸ æ¶æ„è®¾è®¡</h2>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nacos æœåŠ¡å‘ç°                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JobFlow Scheduler   â”‚      â”‚  ä¸šåŠ¡å¾®æœåŠ¡é›†ç¾¤       â”‚
â”‚  (è°ƒåº¦ä¸­å°)          â”‚      â”‚  (æ‰§è¡Œå™¨)            â”‚
â”‚                      â”‚      â”‚                      â”‚
â”‚  - CronTasks         â”‚â”€â”€â”€â”€â”€â†’â”‚  - <span class="hljs-keyword">@JobHandler</span>       â”‚
â”‚  - JobScheduler      â”‚      â”‚  - JobExecutor       â”‚
â”‚  - DelayTaskService  â”‚      â”‚  - ä¸šåŠ¡é€»è¾‘          â”‚
â”‚  - å·¡æ£€è¡¥å¿          â”‚â†â”€â”€â”€â”€â”€â”‚  - çŠ¶æ€å›è°ƒ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL æ•°æ®åº“        â”‚
â”‚  - job_definition    â”‚
â”‚  - job_execution     â”‚
â”‚  - job_sub_execution â”‚
â”‚  - job_delay_task    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-15">ğŸš€ å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-16">1. ç¯å¢ƒå‡†å¤‡</h3>
<ul>
<li>JDK 17+</li>
<li>Maven 3.6+</li>
<li>MySQL 8.0+</li>
<li>Nacos 2.x</li>
</ul>
<h3 data-id="heading-17">2. åˆå§‹åŒ–æ•°æ®åº“</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ‰§è¡Œ SQL è„šæœ¬</span>
source job<span class="hljs-operator">-</span>flow.sql
</code></pre>
<h3 data-id="heading-18">3. å¯åŠ¨è°ƒåº¦å™¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> jobflow-scheduler
mvn spring-boot:run
</code></pre>
<h3 data-id="heading-19">4. ä¸šåŠ¡æœåŠ¡é›†æˆ</h3>
<p><strong>å¼•å…¥ä¾èµ–ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.surfing.jobflow<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jobflow-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>å¯ç”¨ JobFlowï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-meta">@EnableJobFlow</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre>
<p><strong>ç¼–å†™ä»»åŠ¡å¤„ç†å™¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@JobHandler("demoJob")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoJobHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IJobHandler</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> JobResult <span class="hljs-title function_">execute</span><span class="hljs-params">(JobContext context)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">shardStart</span> <span class="hljs-operator">=</span> context.getShardStart();
        <span class="hljs-type">int</span> <span class="hljs-variable">shardEnd</span> <span class="hljs-operator">=</span> context.getShardEnd();
        
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
        log.info(<span class="hljs-string">"æ‰§è¡Œåˆ†ç‰‡ä»»åŠ¡ï¼ŒèŒƒå›´ï¼š{}-{}"</span>, shardStart, shardEnd);
        
        <span class="hljs-keyword">return</span> JobResult.success(<span class="hljs-string">"ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-20">5. é…ç½®ä»»åŠ¡</h3>
<p>åœ¨æ•°æ®åº“ä¸­æ’å…¥ä»»åŠ¡å®šä¹‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> job_definition (
    name, service_name, handler, cron, enabled, shard_count
) <span class="hljs-keyword">VALUES</span> (
    <span class="hljs-string">'demoJob'</span>, <span class="hljs-string">'user-service-example'</span>, <span class="hljs-string">'demoJob'</span>, 
    <span class="hljs-string">'*/10 * * * * ?'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>
);
</code></pre>
<h2 data-id="heading-21">ğŸ“Š æ ¸å¿ƒè¡¨è®¾è®¡</h2>
<h3 data-id="heading-22">job_definition - ä»»åŠ¡å®šä¹‰</h3>
<pre><code class="hljs language-sql" lang="sql">id, name, service_name, handler, cron, enabled,
shard_count, shard_strategy, timeout_seconds, max_retry
</code></pre>
<h3 data-id="heading-23">job_execution - æ‰§è¡Œè®°å½•ï¼ˆçˆ¶è®°å½•ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql">id, job_name, trace_id, trigger_time, status, 
shard_total, finish_time
</code></pre>
<h3 data-id="heading-24">job_sub_execution - åˆ†ç‰‡æ‰§è¡Œï¼ˆå­è®°å½•ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql">id, parent_execution_id, shard_index, status, 
executor_instance, retry_count, start_time, finish_time
</code></pre>
<h3 data-id="heading-25">job_delay_task - å»¶æ—¶ä»»åŠ¡</h3>
<pre><code class="hljs language-sql" lang="sql">id, trace_id, biz_uuid, service_name, handler,
execute_time, next_attempt_time, payload_json, 
status, retry_count, max_retry
</code></pre>
<h2 data-id="heading-26">ğŸ¯ é€‚ç”¨åœºæ™¯</h2>
<h3 data-id="heading-27">âœ… é€‚åˆä½¿ç”¨ JobFlow</h3>
<ul>
<li><strong>å¾®æœåŠ¡æ¶æ„</strong>ï¼šå·²ä½¿ç”¨ Nacos çš„é¡¹ç›®ï¼Œé›¶é¢å¤–ä¾èµ–æˆæœ¬</li>
<li><strong>å‘¨æœŸæ€§æ‰¹å¤„ç†</strong>ï¼šæ•°æ®åŒæ­¥ã€æŠ¥è¡¨ç”Ÿæˆã€å®šæ—¶æ¸…ç†</li>
<li><strong>å»¶æ—¶ä»»åŠ¡</strong>ï¼šè®¢å•è¶…æ—¶å–æ¶ˆã€ä¸´æ—¶æƒé™åˆ°æœŸã€å»¶è¿Ÿé€šçŸ¥</li>
<li><strong>åˆ†ç‰‡å¹¶è¡Œ</strong>ï¼šå¤§æ•°æ®é‡çš„åˆ†ç‰‡å¤„ç†ï¼ˆç”¨æˆ·æ¨é€ã€æ•°æ®è¿ç§»ï¼‰</li>
</ul>
<h3 data-id="heading-28">âŒ ä¸é€‚åˆä½¿ç”¨ JobFlow</h3>
<ul>
<li><strong>éœ€è¦ UI ç®¡ç†åå°</strong>ï¼šJobFlow ä¸“æ³¨äºè½»é‡çº§ï¼Œæš‚æœªæä¾› Web ç®¡ç†ç•Œé¢</li>
<li><strong>ç§’çº§å»¶æ—¶ç²¾åº¦</strong>ï¼šå»¶æ—¶é˜Ÿåˆ—æ‰«æå‘¨æœŸä¸º5ç§’ï¼Œä¸é€‚åˆæ¯«ç§’çº§è¦æ±‚</li>
<li><strong>æµ·é‡ä»»åŠ¡</strong>ï¼šå•è¡¨ç™¾ä¸‡çº§ä»¥ä¸‹ä»»åŠ¡é‡ï¼Œè¶…å¤§è§„æ¨¡éœ€è¦åˆ†åº“åˆ†è¡¨</li>
</ul>
<h2 data-id="heading-29">ğŸ”§ é…ç½®å‚æ•°</h2>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">jobflow:</span>
  <span class="hljs-attr">scheduler:</span>
    <span class="hljs-comment"># ä»»åŠ¡æ‰«æå‘¨æœŸï¼ˆæ¯«ç§’ï¼‰</span>
    <span class="hljs-attr">poll-interval-ms:</span> <span class="hljs-number">5000</span>
    
    <span class="hljs-comment"># åˆ†ç‰‡å·¡æ£€å‘¨æœŸï¼ˆæ¯«ç§’ï¼Œ3åˆ†é’Ÿï¼‰</span>
    <span class="hljs-attr">inspect-interval-ms:</span> <span class="hljs-number">180000</span>
    
    <span class="hljs-comment"># ä½é¢‘ä»»åŠ¡å·¡æ£€å‘¨æœŸï¼ˆæ¯«ç§’ï¼Œ10åˆ†é’Ÿï¼‰</span>
    <span class="hljs-attr">low-frequency-inspect-interval-ms:</span> <span class="hljs-number">600000</span>
    
    <span class="hljs-comment"># å»¶æ—¶ä»»åŠ¡æ‰«æå‘¨æœŸï¼ˆæ¯«ç§’ï¼Œ5ç§’ï¼‰</span>
    <span class="hljs-attr">delay-inspect-interval-ms:</span> <span class="hljs-number">5000</span>
    
    <span class="hljs-comment"># é»˜è®¤è¶…æ—¶é˜ˆå€¼ï¼ˆåˆ†é’Ÿï¼‰</span>
    <span class="hljs-attr">timeout-threshold-minutes:</span> <span class="hljs-number">10</span>
</code></pre>
<hr/>
<p><strong>Author:</strong> è¸æµªæ— ç—•<br/>
<strong>Last Updated:</strong> 2025-12-21</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‹¹æœè¿™æ³¢å¼€æºå¤ªç‹ äº†ï¼šå•å¼ ç…§ç‰‡ç§’å˜3Dï¼Œé€Ÿåº¦æå‡ä¸€åƒå€]]></title>    <link>https://juejin.cn/post/7585850609015881743</link>    <guid>https://juejin.cn/post/7585850609015881743</guid>    <pubDate>2025-12-21T15:53:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585850609015881743" data-draft-id="7585727457472954368" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‹¹æœè¿™æ³¢å¼€æºå¤ªç‹ äº†ï¼šå•å¼ ç…§ç‰‡ç§’å˜3Dï¼Œé€Ÿåº¦æå‡ä¸€åƒå€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-21T15:53:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‹¹æœè¿™æ³¢å¼€æºå¤ªç‹ äº†ï¼šå•å¼ ç…§ç‰‡ç§’å˜3Dï¼Œé€Ÿåº¦æå‡ä¸€åƒå€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T15:53:25.000Z" title="Sun Dec 21 2025 15:53:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœè¯´ä»¥å‰åš3Då»ºæ¨¡æ˜¯åœ¨â€œé›•åˆ»â€ï¼Œé‚£ä¹ˆè‹¹æœåˆšåˆšå‘å¸ƒçš„SHARPæ¨¡å‹å°±æ˜¯åœ¨â€œå¤å°â€ã€‚</p>
<p>åœ¨è®¡ç®—æœºè§†è§‰åœˆå­é‡Œï¼Œä»2Dç…§ç‰‡é‡å»º3Dåœºæ™¯ä¸€ç›´æ˜¯ä¸ªç¡¬éª¨å¤´ã€‚æŒ‰ç…§ä¼ ç»Ÿè·¯æ•°ï¼Œä½ å¾—æ‹¿ç€ç›¸æœºå›´ç€ç‰©ä½“è½¬å‡ ååœˆï¼Œæ‹ä¸Šç™¾å¼ ç…§ç‰‡ï¼Œç„¶åäº¤ç»™ç®—æ³•è·‘ä¸Šå‡ ä¸ªå°æ—¶ï¼Œæ‰èƒ½ç®—å‡ºä¸€ä¸ªåƒæ ·çš„æ¨¡å‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸ä»…ç´¯äººï¼Œè€Œä¸”å¯¹ç®—åŠ›è¦æ±‚æé«˜ã€‚</p>
<p>ä½†å°±åœ¨æœ€è¿‘ï¼Œè‹¹æœå‘å¸ƒå¹¶å¼€æºäº†SHARPæ¨¡å‹ï¼Œç›´æ¥æŠŠè¿™ä¸ªè§„åˆ™æ¨å€’é‡æ¥ã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®çš„å…¨ç§°æ˜¯Sharp Monocular View Synthesisã€‚åå­—å¬ç€æŒºå­¦æœ¯ï¼Œä½†æ ¸å¿ƒé€»è¾‘éå¸¸æš´åŠ›ç¾å­¦ï¼šç»™å®ƒä¸€å¼ æ™®é€šçš„2Dç…§ç‰‡ï¼Œä¸åˆ°ä¸€ç§’é’Ÿï¼Œå®ƒå°±èƒ½åå‡ºä¸€ä¸ªå¸¦æœ‰çœŸå®ç‰©ç†å°ºåº¦çš„3Dåœºæ™¯ã€‚</p>
<p>è¿™ä¸æ˜¯ç§‘å¹»ç‰‡ï¼Œä»£ç å·²ç»åœ¨GitHubä¸Šèººç€äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-21_23.47.55-1024x525.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-21_23.47.55-1024x525.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/803e574e83e248a4a932a06e3ccc7bf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766937205&amp;x-signature=5Q%2FU4X6YvXxGz4TeWX4S4AF98U0%3D" alt="iShot_2025-12-21_23.47.55" loading="lazy"/></a></p>
<p><strong>ä¸ºä»€ä¹ˆå®ƒèƒ½å¿«ä¸‰ä¸ªæ•°é‡çº§ï¼Ÿ</strong></p>
<p>SHARPä¹‹æ‰€ä»¥èƒ½æŠŠåŸæœ¬å‡ ååˆ†é’Ÿçš„å·¥ä½œå‹ç¼©åˆ°ä¸€ç§’å†…ï¼Œæ˜¯å› ä¸ºå®ƒæ¢äº†ä¸€æ¡èµ›é“ã€‚</p>
<p>ä¼ ç»Ÿæ–¹æ³•ï¼ˆæ¯”å¦‚åŸæœ¬çš„3Dé«˜æ–¯æ³¼æº…æˆ–NeRFï¼‰æ˜¯åœ¨â€œåšé¢˜â€ã€‚é¢å¯¹ä¸€ç»„ç…§ç‰‡ï¼Œç®—æ³•éœ€è¦åå¤è¿­ä»£ã€ä¼˜åŒ–ï¼Œä¸€ç‚¹ç‚¹æ¨ç®—å‡ºç‰©ä½“åœ¨ç©ºé—´ä¸­çš„ä½ç½®ï¼Œè¿™å«â€œä¼˜åŒ–â€ã€‚</p>
<p>è€ŒSHARPæ˜¯åœ¨â€œçŒœé¢˜â€ã€‚è‹¹æœè®©ç¥ç»ç½‘ç»œåœ¨æµ·é‡åˆæˆæ•°æ®å’ŒçœŸå®æ•°æ®ä¸­â€œé˜…å·â€æ— æ•°ï¼Œè®©AIæŒæ¡äº†é€šç”¨çš„æ·±åº¦å’Œå‡ ä½•è§„å¾‹ã€‚å½“å®ƒçœ‹åˆ°ä¸€å¼ æ–°ç…§ç‰‡æ—¶ï¼Œä¸éœ€è¦ä»å¤´è®¡ç®—ï¼Œè€Œæ˜¯å‡­â€œç›´è§‰â€ç›´æ¥é¢„æµ‹å‡ºæ•°ç™¾ä¸‡ä¸ª3Dé«˜æ–¯çƒçš„ä½ç½®ã€é¢œè‰²å’Œå½¢çŠ¶ã€‚</p>
<p>ä»â€œæ­»ç®—â€å˜æˆâ€œé¢„æµ‹â€ï¼Œè¿™å°±æ˜¯SHARPå®ç°é€Ÿåº¦é£è·ƒçš„æ ¹æœ¬åŸå› ã€‚æ ¹æ®è‹¹æœçš„æ•°æ®ï¼Œåœ¨æ ‡å‡†GPUä¸Šï¼Œå®ƒçš„å¤„ç†æ—¶é—´è¢«å‹ç¼©åˆ°äº†1ç§’ä»¥å†…ï¼Œç›¸æ¯”ä¼ ç»Ÿæ–¹æ¡ˆï¼Œé€Ÿåº¦æå‡äº†æ•´æ•´ä¸‰ä¸ªæ•°é‡çº§ï¼ˆçº¦1000å€ï¼‰ã€‚</p>
<p><strong>è´¨é‡æ²¡ç¼©æ°´ï¼Œåè€Œæ›´å¼ºäº†</strong></p>
<p>é€šå¸¸æˆ‘ä»¬è®¤ä¸ºâ€œå¿«å·¥å‡ºç»†æ´»â€æ˜¯ä¸ªä¼ªå‘½é¢˜ï¼Œä½†åœ¨AIé¢†åŸŸå¾€å¾€ç›¸åã€‚</p>
<p>SHARPå¹¶æ²¡æœ‰å› ä¸ºè¿½æ±‚é€Ÿåº¦è€Œç‰ºç‰²ç”»è´¨ã€‚åœ¨LPIPSï¼ˆæ„ŸçŸ¥ç›¸ä¼¼åº¦ï¼‰å’ŒDISTSï¼ˆçº¹ç†ç›¸ä¼¼åº¦ï¼‰è¿™ä¸¤ä¸ªå…³é”®æŒ‡æ ‡ä¸Šï¼ŒSHARPç›¸æ¯”ä¹‹å‰çš„æœ€ä½³æ¨¡å‹ï¼Œè¯¯å·®åˆ†åˆ«é™ä½äº†25%-34%å’Œ21%-43%ã€‚</p>
<p>æ¢æˆäººè¯å°±æ˜¯ï¼šå®ƒç”Ÿæˆçš„3Dåœºæ™¯ï¼Œçº¹ç†æ›´æ¸…æ™°ï¼Œç»“æ„æ›´åˆç†ï¼Œä¸åƒä»¥å‰é‚£äº›å¿«é€Ÿç”Ÿæˆçš„æ¨¡å‹é‚£æ ·æœ‰ä¸€ç§â€œèåŒ–â€çš„å¡‘æ–™æ„Ÿã€‚æœ€å…³é”®çš„æ˜¯ï¼Œå®ƒç”Ÿæˆçš„åœºæ™¯å…·å¤‡çœŸå®çš„ç‰©ç†å°ºåº¦ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æŠŠè¿™å¥—æŠ€æœ¯æ”¾åˆ°VRçœ¼é•œé‡Œï¼Œå½“ä½ åœ¨è™šæ‹Ÿåœºæ™¯ä¸­ç§»åŠ¨ä¸€æ­¥ï¼Œè§†è§‰ä¸Šçš„åé¦ˆå’ŒçœŸå®ä¸–ç•Œç§»åŠ¨ä¸€æ­¥æ˜¯ä¸€è‡´çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2FiShot_2025-12-21_23.43.48-1024x491.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/iShot_2025-12-21_23.43.48-1024x491.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b3901a1993d48118cf2c525078dbda9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766937205&amp;x-signature=s705anlndJHdMqfU%2FqOFMlIa%2FIg%3D" alt="iShot_2025-12-21_23.43.48" loading="lazy"/></a></p>
<p><strong>åˆ«æ€¥ï¼Œå®ƒä¹Ÿæœ‰åšä¸åˆ°çš„äº‹</strong></p>
<p>å¹å®ŒæŠ€æœ¯ï¼Œå¿…é¡»å¾—èŠèŠå®ƒçš„è¾¹ç•Œã€‚SHARPè™½ç„¶å¼ºï¼Œä½†ä¸æ˜¯é­”æ³•ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒèƒ½åŠ›æ˜¯â€œå•ç›®è§†å›¾åˆæˆâ€ã€‚ç®€å•è¯´ï¼Œå®ƒæœ€æ“…é•¿çš„æ˜¯è®©ä½ åœ¨é‚£å¼ 2Dç…§ç‰‡çš„æ‹æ‘„è§†è§’é™„è¿‘ï¼Œè¿›è¡Œå°å¹…åº¦çš„ç§»åŠ¨è§‚å¯Ÿï¼Œäº§ç”Ÿé€¼çœŸçš„3Dè§†å·®æ•ˆæœã€‚</p>
<p>ç”±äºå®ƒåªçœ‹è¿‡ç‰©ä½“çš„ä¸€é¢ï¼Œå®ƒæ— æ³•å‡­ç©ºå˜å‡ºç‰©ä½“èƒŒåçš„æ ·å­ã€‚å¦‚æœä½ è¯•å›¾ç»•åˆ°ç‰©ä½“èƒŒé¢ï¼Œæˆ–è€…çœ‹é‚£äº›ç…§ç‰‡é‡Œå®Œå…¨è¢«é®æŒ¡çš„æ­»è§’ï¼Œæ¨¡å‹æ˜¯æ— èƒ½ä¸ºåŠ›çš„ã€‚å®ƒä¸ä¼šåƒæŸäº›ç”Ÿæˆå¼AIé‚£æ ·çç¼–ä¸€ä¸ªèƒŒé¢ç»™ä½ ï¼Œå®ƒä¸»è¦ä¿è¯çš„æ˜¯â€œå¯è§†èŒƒå›´å†…â€çš„ç»å¯¹çœŸå®å’Œç«‹ä½“æ„Ÿã€‚</p>
<p>æ‰€ä»¥ï¼Œåˆ«æŒ‡æœ›ç”¨ä¸€å¼ ç…§ç‰‡å°±èƒ½ç«‹åˆ»3Dæ‰“å°å‡ºä¸€ä¸ªå®Œç¾çš„æ‰‹åŠï¼Œä½†å¦‚æœä½ æ˜¯æƒ³åœ¨å±å¹•ä¸Šæˆ–è€…VRé‡Œè·å¾—èº«ä¸´å…¶å¢ƒçš„ç«‹ä½“è§‚æ„Ÿï¼Œå®ƒå®Œå…¨å¤Ÿç”¨äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fdafsddsf.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/dafsddsf.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34945f0441894290a3f61695a13d6f84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766937205&amp;x-signature=lgoij6BQgmJiKODLpX15Dqwt%2BDQ%3D" alt="dafsddsf" loading="lazy"/></a></p>
<p><strong>è‹¹æœçš„é˜³è°‹</strong></p>
<p>è‹¹æœè¿™æ¬¡ä¸ä»…å‘äº†è®ºæ–‡ï¼Œè¿˜ç½•è§åœ°åœ¨GitHubå’ŒHugging Faceä¸Šå¼€æºäº†å®Œæ•´ä»£ç å’Œé¢„è®­ç»ƒæ¨¡å‹ã€‚</p>
<p>è¿™ä¸ªåŠ¨ä½œèƒŒåçš„æ„å›¾å¾ˆæ˜æ˜¾ã€‚Vision Proéœ€è¦å†…å®¹ï¼Œè€Œç°æœ‰çš„3Då†…å®¹åˆ¶ä½œæˆæœ¬å¤ªé«˜äº†ã€‚é€šè¿‡å¼€æºSHARPï¼Œè‹¹æœå®é™…ä¸Šæ˜¯æŠŠä¸€æŠŠä½é—¨æ§›çš„â€œ3Dé“²å­â€é€’ç»™äº†å…¨çƒçš„å¼€å‘è€…ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œæœªæ¥çš„ç”µå•†Appï¼Œä½ éšæ‰‹æ‹å¼ é‹å­çš„ç…§ç‰‡ï¼Œç¬é—´å°±èƒ½åœ¨æ‰‹æœºä¸Šå·¦å³æ™ƒåŠ¨æŸ¥çœ‹ç«‹ä½“ç»†èŠ‚ï¼›æˆ–è€…åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œç¾æœ¯å¸ˆæ‹å¼ é£æ™¯ç…§å°±èƒ½ç›´æ¥ç”Ÿæˆæ¸¸æˆåœºæ™¯çš„åº•åº§ã€‚</p>
<p>SHARPæŠŠ3Dé‡å»ºçš„é—¨æ§›ä»â€œæ‘„å½±æ£šçº§â€é™åˆ°äº†â€œæ‰‹æœºæŠ“æ‹çº§â€ã€‚å¯¹äºæ•´ä¸ªç©ºé—´è®¡ç®—è¡Œä¸šæ¥è¯´ï¼Œè¿™å¯èƒ½æ‰æ˜¯æœ€å€¼å¾—å…´å¥‹çš„ä¿¡å·ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ’ å‰ç«¯ AI åº”ç”¨å®æˆ˜ï¼šç”¨ Vue3 + Cozeï¼ŒæŠŠå® ç‰©ä¸€é”®å˜æˆå†°çƒè¿åŠ¨å‘˜ï¼]]></title>    <link>https://juejin.cn/post/7585645111876435995</link>    <guid>https://juejin.cn/post/7585645111876435995</guid>    <pubDate>2025-12-21T16:02:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585645111876435995" data-draft-id="7585808181239201843" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ’ å‰ç«¯ AI åº”ç”¨å®æˆ˜ï¼šç”¨ Vue3 + Cozeï¼ŒæŠŠå® ç‰©ä¸€é”®å˜æˆå†°çƒè¿åŠ¨å‘˜ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,Coze"/> <meta itemprop="datePublished" content="2025-12-21T16:02:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç™½å…°åœ°ç©ºç“¶"/> <meta itemprop="url" content="https://juejin.cn/user/191753514127514"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ’ å‰ç«¯ AI åº”ç”¨å®æˆ˜ï¼šç”¨ Vue3 + Cozeï¼ŒæŠŠå® ç‰©ä¸€é”®å˜æˆå†°çƒè¿åŠ¨å‘˜ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/191753514127514/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç™½å…°åœ°ç©ºç“¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T16:02:41.000Z" title="Sun Dec 21 2025 16:02:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ä¸æ˜¯ AI ä¸å¤Ÿå¼ºï¼Œè€Œæ˜¯ä½ è¿˜æ²¡æŠŠå®ƒâ€œæ¥è¿›å‰ç«¯â€</strong></p>
<p>è¿™æ˜¯ä¸€ç¯‡çœŸæ­£ã€Œå‰ç«¯è§†è§’ã€çš„ AI åº”ç”¨è½åœ°å®æˆ˜ï¼Œè€Œä¸æ˜¯æ¨¡å‹ç§‘æ™®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ¤” ä¸ºä»€ä¹ˆæˆ‘è¦åšè¿™ä¸ªã€Œå® ç‰©å†°çƒå‘˜ã€AI åº”ç”¨ï¼Ÿ</h2>
<p>æœ€è¿‘åˆ·æ˜é‡‘ï¼Œä½ ä¸€å®šå‘ç°äº†ä¸€ä¸ªç°è±¡ ğŸ‘‡</p>
<ul>
<li>AI å¾ˆç«</li>
<li>å¤§æ¨¡å‹å¾ˆå¼º</li>
<li>ä½†çœŸæ­£èƒ½è·‘èµ·æ¥çš„ <strong>å‰ç«¯ AI åº”ç”¨å¾ˆå°‘</strong></li>
</ul>
<p>å¾ˆå¤šåŒå­¦å¡åœ¨è¿™ä¸€æ­¥ï¼š</p>
<blockquote>
<p>âŒ ä¼š Vue / React<br/>
âŒ ä¼šè°ƒæ¥å£<br/>
âŒ ä½†ä¸çŸ¥é“ AI é¡¹ç›®<strong>æ•´ä½“è¯¥æ€ä¹ˆæ­</strong></p>
</blockquote>
<p>äºæ˜¯æˆ‘åšäº†è¿™ä¸ªé¡¹ç›®ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ¯ é¡¹ç›®ä¸€å¥è¯ä»‹ç»</h2>
<blockquote>
<p><strong>ä¸Šä¼ ä¸€å¼ å® ç‰©ç…§ç‰‡ï¼Œç”Ÿæˆä¸€å¼ ä¸“å±â€œå†°çƒè¿åŠ¨å‘˜å½¢è±¡ç…§â€</strong></p>
</blockquote>
<p>è€Œä¸”ä¸æ˜¯éšä¾¿ç”Ÿæˆï¼Œè€Œæ˜¯<strong>å¯æ§çš„ AI</strong>ğŸ‘‡</p>
<ul>
<li>ğŸ§¢ é˜Ÿæœç¼–å·</li>
<li>ğŸ¨ é˜Ÿæœé¢œè‰²</li>
<li>ğŸ’ åœºä¸Šä½ç½®ï¼ˆå®ˆé—¨å‘˜ / å‰é”‹ / åå«ï¼‰</li>
<li>âœ‹ æŒæ†æ–¹å¼ï¼ˆå·¦ / å³ï¼‰</li>
<li>ğŸ­ ç»˜ç”»é£æ ¼ï¼ˆå†™å® / æ—¥æ¼« / å›½æ¼« / æ²¹ç”» / ç´ æï¼‰</li>
</ul>
<p>ğŸ“Œ <strong>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ã€Œæ´»åŠ¨å‹ AI åº”ç”¨ã€</strong></p>
<p>éå¸¸é€‚åˆï¼š</p>
<ul>
<li>å†°çƒåä¼šå®£ä¼ </li>
<li>å® ç‰©ç¤¾åŒºè£‚å˜</li>
<li>æ´»åŠ¨æ‹‰æ–°</li>
<li>æœ‹å‹åœˆåˆ†äº«</li>
</ul>
<hr/>
<h2 data-id="heading-2">ğŸ§  æ•´ä½“æ¶æ„ï¼šå‰ç«¯ + AI æ˜¯æ€ä¹ˆé…åˆçš„ï¼Ÿ</h2>
<p>å…ˆä¸Šç»“è®ºğŸ‘‡</p>
<blockquote>
<p><strong>å‰ç«¯è´Ÿè´£â€œæ„å›¾â€ï¼ŒAI è´Ÿè´£â€œç”Ÿæˆâ€</strong></p>
</blockquote>
<p>æ•´ä½“æµç¨‹éå¸¸æ¸…æ™°ï¼š</p>
<pre><code class="hljs">Vue3 å‰ç«¯
  â†“
å›¾ç‰‡ä¸Šä¼ ï¼ˆCoze æ–‡ä»¶ APIï¼‰
  â†“
è°ƒç”¨ Coze å·¥ä½œæµ
  â†“
AI ç”Ÿæˆå›¾ç‰‡
  â†“
å‰ç«¯å±•ç¤ºç»“æœ
</code></pre>
<h3 data-id="heading-3">ğŸ§© æŠ€æœ¯é€‰å‹ä¸€è§ˆ</h3>





























<table><thead><tr><th>æ¨¡å—</th><th>æŠ€æœ¯</th></tr></thead><tbody><tr><td>å‰ç«¯</td><td>Vue3 + Composition API</td></tr><tr><td>AI ç¼–æ’</td><td>Coze å·¥ä½œæµ</td></tr><tr><td>ç½‘ç»œ</td><td>fetch / HTTP</td></tr><tr><td>ä¸Šä¼ </td><td>FormData</td></tr><tr><td>çŠ¶æ€</td><td>ref å“åº”å¼</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">ğŸ–¼ï¸ å‰ç«¯ç¬¬ä¸€éš¾ç‚¹ï¼šå›¾ç‰‡ä¸Šä¼  &amp; é¢„è§ˆ</h2>
<p>AI åº”ç”¨é‡Œï¼Œ<strong>æœ€å®¹æ˜“è¢«å¿½ç•¥çš„ä¸æ˜¯ AIï¼Œè€Œæ˜¯ç”¨æˆ·ä½“éªŒ</strong>ã€‚</p>
<h3 data-id="heading-5">â“ ä¸€ä¸ªé—®é¢˜</h3>
<blockquote>
<p>å›¾ç‰‡å¾ˆå¤§ï¼Œç”¨æˆ·ç‚¹ã€Œç”Ÿæˆã€ä¹‹åä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï¼Œä¼šæ€æ ·ï¼Ÿ</p>
</blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼š<br/>
<strong>ä»–ä»¥ä¸ºä½ çš„ç½‘ç«™å¡æ­»äº†</strong></p>
<hr/>
<h3 data-id="heading-6">âœ… è§£å†³æ–¹æ¡ˆï¼šæœ¬åœ°é¢„è§ˆï¼ˆä¸ç­‰ä¸Šä¼ ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">reader</span> = new FileReader()
reader.readAsDataURL(file)
<span class="hljs-attr">reader.onload</span> = e =&gt; {
  <span class="hljs-attr">imgPreview.value</span> = e.target.result
}
</code></pre>
<p>ğŸ“Œ è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ï¼š</p>
<ul>
<li><code>FileReader</code></li>
<li><code>readAsDataURL</code></li>
<li>base64 ç›´æ¥æ¸²æŸ“</li>
</ul>
<blockquote>
<p><strong>å›¾ç‰‡è¿˜æ²¡ä¸Šä¼ ï¼Œç”¨æˆ·å·²ç»â€œçœ‹è§åé¦ˆâ€äº†</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ›ï¸ è¡¨å•ä¸æ˜¯è¡¨å•ï¼Œè€Œæ˜¯ã€ŒAI å‚æ•°é¢æ¿ã€</h2>
<p>å¾ˆå¤šäººå†™è¡¨å•æ˜¯ä¸ºäº†æäº¤æ•°æ®<br/>
<strong>ä½† AI åº”ç”¨çš„è¡¨å•ï¼Œæœ¬è´¨æ˜¯ Prompt çš„ä¸€éƒ¨åˆ†</strong></p>
<pre><code class="hljs language-ini" lang="ini">&lt;select <span class="hljs-attr">v-model</span>=<span class="hljs-string">"style"</span>&gt;
  &lt;option <span class="hljs-attr">value</span>=<span class="hljs-string">"å†™å®"</span>&gt;å†™å®&lt;/option&gt;
  &lt;option <span class="hljs-attr">value</span>=<span class="hljs-string">"æ—¥æ¼«"</span>&gt;æ—¥æ¼«&lt;/option&gt;
  &lt;option <span class="hljs-attr">value</span>=<span class="hljs-string">"æ²¹ç”»"</span>&gt;æ²¹ç”»&lt;/option&gt;
&lt;/select&gt;
</code></pre>
<p>æœ€ç»ˆåœ¨è°ƒç”¨å·¥ä½œæµæ—¶ï¼Œå˜æˆï¼š</p>
<pre><code class="hljs language-css" lang="css">parameters: {
  style,
  uniform_color,
  uniform_number,
  <span class="hljs-attribute">position</span>,
  shooting_hand
}
</code></pre>
<p>ğŸ’¡ <strong>å‰ç«¯çš„èŒè´£ä¸æ˜¯â€œç”Ÿæˆ AIâ€</strong><br/>
ğŸ’¡ <strong>è€Œæ˜¯â€œè®© AI æ›´å¬è¯â€</strong></p>
<hr/>
<h2 data-id="heading-8">ğŸ¤– AI çœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼šCoze å·¥ä½œæµ</h2>
<p>ä¸€ä¸ªéå¸¸é‡è¦çš„è®¤çŸ¥ğŸ‘‡</p>
<blockquote>
<p>âŒ AI é€»è¾‘ä¸åº”è¯¥å†™åœ¨å‰ç«¯<br/>
âœ… AI é€»è¾‘åº”è¯¥å†™åœ¨ã€Œå·¥ä½œæµã€é‡Œ</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">ğŸ§© æˆ‘çš„ Coze å·¥ä½œæµç»“æ„ï¼ˆæ ¸å¿ƒï¼‰</h3>
<p>ä½ æ­å»ºçš„å·¥ä½œæµå¤§è‡´åŒ…å«ï¼š</p>
<ul>
<li>ğŸ“· å›¾ç‰‡ç†è§£ï¼ˆimgUnderstandï¼‰</li>
<li>ğŸ” ç‰¹å¾æå–</li>
<li>ğŸ“ Prompt ç”Ÿæˆ</li>
<li>ğŸ¨ å›¾ç‰‡ç”Ÿæˆ</li>
<li>ğŸ”— è¾“å‡ºå›¾ç‰‡ URL</li>
</ul>
<p>ğŸ‘‰ å·¥ä½œæµåœ°å€ï¼ˆå¯ç›´æ¥å‚è€ƒï¼‰<br/>
ğŸ”— <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.coze.cn%2Fwork_flow%3Fworkflow_id%3D7584046269044211746%26space_id%3D7567272215612817435" target="_blank" title="https://www.coze.cn/work_flow?workflow_id=7584046269044211746&amp;space_id=7567272215612817435" ref="nofollow noopener noreferrer">www.coze.cn/work_flow?wâ€¦</a></p>
<p>ğŸ“Œ <strong>å·¥ä½œæµ = AI åç«¯</strong></p>
<p>å‰ç«¯åªéœ€è¦åšä¸€ä»¶äº‹ğŸ‘‡</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">'https://api.coze.cn/v1/workflow/run'</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-attr">Authorization</span>: `Bearer ${patToken}`,
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
  },
  <span class="hljs-attr">body</span>: JSON.<span class="hljs-title function_ invoke__">stringify</span>({
    workflow_id,
    parameters
  })
})
</code></pre>
<hr/>
<h2 data-id="heading-10">ğŸ“¤ æ–‡ä»¶ä¸Šä¼ ï¼šå‰ç«¯ AI é¡¹ç›®çš„å¿…ä¿®è¯¾</h2>
<h3 data-id="heading-11">â“ ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æŠŠå›¾ç‰‡ä¼ ç»™å·¥ä½œæµï¼Ÿ</h3>
<p>å› ä¸ºï¼š</p>
<ul>
<li>å·¥ä½œæµä¸èƒ½ç›´æ¥æ¥æ”¶æœ¬åœ°æ–‡ä»¶</li>
<li>å¿…é¡»å…ˆä¸Šä¼ ï¼Œæ¢ä¸€ä¸ª <code>file_id</code></li>
</ul>
<hr/>
<h3 data-id="heading-12">âœ… æ­£ç¡®å§¿åŠ¿ï¼šFormData</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> formdata = <span class="hljs-built_in">new</span> FormData()
formdata.<span class="hljs-built_in">append</span>(<span class="hljs-string">'file'</span>, input.files[<span class="hljs-number">0</span>])
</code></pre>
<p>è¿”å›ç»“æœä¸­ä¼šæ‹¿åˆ°ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"file_xxx"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶ååœ¨å·¥ä½œæµå‚æ•°é‡Œä¼ ğŸ‘‡</p>
<pre><code class="hljs language-css" lang="css">picture: JSON.<span class="hljs-built_in">stringify</span>({ file_id })
</code></pre>
<p>ğŸ“Œ <strong>AI åº”ç”¨ç”¨çš„è¿˜æ˜¯è€æœ‹å‹ï¼šHTTP + è¡¨å•</strong></p>
<hr/>
<h2 data-id="heading-13">â³ çŠ¶æ€ç®¡ç†ï¼šAI åº”ç”¨çš„â€œä¿¡ä»»æ„Ÿæ¥æºâ€</h2>
<p>AI â‰  ç§’å‡ºç»“æœ<br/>
æ‰€ä»¥çŠ¶æ€æç¤ºéå¸¸é‡è¦ğŸ‘‡</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">status.value</span> = <span class="hljs-string">"å›¾ç‰‡ä¸Šä¼ ä¸­..."</span>
<span class="hljs-attr">status.value</span> = <span class="hljs-string">"æ­£åœ¨ç”Ÿæˆ..."</span>
</code></pre>
<p>å¦‚æœå‡ºé”™ğŸ‘‡</p>
<pre><code class="hljs language-ini" lang="ini">if (ret.code !== 0) {
  <span class="hljs-attr">status.value</span> = ret.msg
}
</code></pre>
<blockquote>
<p><strong>ä¸€ä¸ªæ²¡æœ‰çŠ¶æ€æç¤ºçš„ AI åº”ç”¨ = ä¸å¯ç”¨</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-14">âš ï¸ AI åº”ç”¨çš„ä¸‰ä¸ªâ€œéšè—å‘â€</h2>
<h3 data-id="heading-15">1ï¸âƒ£ AI æ˜¯æ…¢çš„</h3>
<ul>
<li>loading å¿…é¡»æœ‰</li>
<li>æŒ‰é’®è¦ç¦ç”¨</li>
<li>ç”¨æˆ·è¦çŸ¥é“ç°åœ¨åœ¨å¹²å˜›</li>
</ul>
<hr/>
<h3 data-id="heading-16">2ï¸âƒ£ AI æ˜¯ä¸ç¨³å®šçš„</h3>
<ul>
<li>å¯èƒ½å¤±è´¥</li>
<li>å¯èƒ½ç”Ÿæˆä¸ç¬¦åˆé¢„æœŸ</li>
<li>å¯èƒ½ URL ä¸ºç©º</li>
</ul>
<p>ğŸ“Œ <strong>å‰ç«¯å¿…é¡»å…œåº•ï¼Œè€Œä¸æ˜¯å‡è®¾ AI æ°¸è¿œæˆåŠŸ</strong></p>
<hr/>
<h3 data-id="heading-17">3ï¸âƒ£ AI åº”ç”¨ â‰  CRUD</h3>
<p>å®ƒæ›´åƒä¸€æ¬¡ï¼š</p>
<blockquote>
<p><strong>ç”¨æˆ·æ„å›¾ â†’ AI ç†è§£ â†’ å†…å®¹ç”Ÿæˆ â†’ ç»“æœåé¦ˆ</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-18">âœ… åšå®Œè¿™ä¸ªé¡¹ç›®ï¼Œä½ çœŸæ­£æŒæ¡äº†ä»€ä¹ˆï¼Ÿ</h2>
<p>å¦‚æœä½ å®Œæ•´è·‘é€šè¿™å¥—æµç¨‹ï¼Œä½ è‡³å°‘å­¦ä¼šäº†ğŸ‘‡</p>
<ul>
<li>âœ… Vue3 Composition API å®æˆ˜</li>
<li>âœ… æ–‡ä»¶ä¸Šä¼  &amp; å›¾ç‰‡é¢„è§ˆ</li>
<li>âœ… AI å·¥ä½œæµçš„æ­£ç¡®ä½¿ç”¨æ–¹å¼</li>
<li>âœ… å‰ç«¯å¦‚ä½•â€œé©±åŠ¨ AIâ€</li>
<li>âœ… ä¸€ä¸ªå®Œæ•´ AI åº”ç”¨çš„å·¥ç¨‹æ€è·¯</li>
</ul>
<hr/>
<h2 data-id="heading-19">âœï¸ å†™åœ¨æœ€åï¼šå‰ç«¯ + AI çš„çœŸæ­£ä»·å€¼</h2>
<p>å¾ˆå¤šäººæ‹…å¿ƒğŸ‘‡</p>
<blockquote>
<p>ã€Œå‰ç«¯ä¼šä¸ä¼šè¢« AI å–ä»£ï¼Ÿã€</p>
</blockquote>
<p>æˆ‘çš„ç­”æ¡ˆæ˜¯ï¼š</p>
<blockquote>
<p>âŒ åªä¼šå†™é¡µé¢çš„å‰ç«¯ä¼šè¢«å–ä»£<br/>
âœ… ä¼š<strong>è®¾è®¡ AI äº¤äº’ä½“éªŒ</strong>çš„å‰ç«¯ä¸ä¼š</p>
</blockquote>
<p>AI å¾ˆå¼º<br/>
ä½†<strong>AI ä¸çŸ¥é“ç”¨æˆ·è¦ä»€ä¹ˆ</strong></p>
<p>è€Œå‰ç«¯ï¼Œæ­£æ˜¯è¿æ¥ã€Œç”¨æˆ·æ„å›¾ã€å’Œã€ŒAI èƒ½åŠ›ã€çš„æ¡¥æ¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ª WPF å¼€æºã€å…è´¹çš„ SVG å›¾åƒæŸ¥çœ‹æ§ä»¶]]></title>    <link>https://juejin.cn/post/7585778343351205951</link>    <guid>https://juejin.cn/post/7585778343351205951</guid>    <pubDate>2025-12-21T14:04:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585778343351205951" data-draft-id="7585758163435896838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ª WPF å¼€æºã€å…è´¹çš„ SVG å›¾åƒæŸ¥çœ‹æ§ä»¶"/> <meta itemprop="keywords" content="åç«¯,.NET"/> <meta itemprop="datePublished" content="2025-12-21T14:04:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿½é€æ—¶å…‰è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2770425031690333"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ª WPF å¼€æºã€å…è´¹çš„ SVG å›¾åƒæŸ¥çœ‹æ§ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2770425031690333/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿½é€æ—¶å…‰è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:04:11.000Z" title="Sun Dec 21 2025 14:04:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä»Šå¤©å¤§å§šç»™å¤§å®¶åˆ†äº«ä¸€ä¸ª WPF å¼€æºã€å…è´¹çš„ SVG å›¾åƒæŸ¥çœ‹æ§ä»¶ï¼šSVGImageã€‚</p>
<h2 data-id="heading-1">é¡¹ç›®ä»‹ç»</h2>
<p>SVGImage æ˜¯ä¸€ä¸ªä¸º WPFï¼ˆWindows Presentation Foundationï¼‰åº”ç”¨ç¨‹åºè®¾è®¡ã€å¼€æºï¼ˆMIT licenseï¼‰ã€å…è´¹çš„ SVGï¼ˆScalable Vector Graphicsï¼‰å›¾åƒæŸ¥çœ‹æ§ä»¶ã€‚</p>
<h2 data-id="heading-2">åº”ç”¨åœºæ™¯</h2>
<p>SVGImage æ§ä»¶é€‚ç”¨äºéœ€è¦åœ¨ WPF åº”ç”¨ç¨‹åºä¸­æ˜¾ç¤ºå’Œæ“ä½œ SVG å›¾åƒçš„åœºæ™¯ã€‚SVG å›¾åƒå› å…¶å¯ç¼©æ”¾æ€§å’Œä¸å¤±çœŸç‰¹æ€§ï¼Œåœ¨éœ€è¦é«˜è´¨é‡å›¾å½¢çš„åº”ç”¨ä¸­ï¼ˆå¦‚å›¾è¡¨ã€å›¾æ ‡ã€åŠ¨æ€å›¾å½¢ç­‰ï¼‰å…·æœ‰å¹¿æ³›åº”ç”¨ã€‚å…·ä½“åº”ç”¨åœºæ™¯åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li><strong>æ•°æ®å¯è§†åŒ–</strong>: æ˜¾ç¤ºåŠ¨æ€ç”Ÿæˆçš„å›¾è¡¨å’Œå›¾å½¢ã€‚</li>
<li><strong>UI è®¾è®¡</strong>: ä½¿ç”¨ SVG å›¾æ ‡å’Œå›¾å½¢å¢å¼ºç”¨æˆ·ç•Œé¢ã€‚</li>
<li><strong>æ•™è‚²è½¯ä»¶</strong>: æ˜¾ç¤ºäº¤äº’å¼çš„ç§‘å­¦å›¾å½¢å’Œæ¨¡å‹ã€‚</li>
</ul>
<h2 data-id="heading-3">æ¡†æ¶æ”¯æŒ</h2>
<p>SVGImageæ§ä»¶åº“é¢å‘ä»¥ä¸‹æ¡†æ¶ï¼š</p>
<ul>
<li>.NET Framework, Version 4.0</li>
<li>.NET Framework, Version 4.5</li>
<li>.NET Framework, Version 4.6</li>
<li>.NET Framework, Version 4.7</li>
<li>.NET Framework, Version 4.8</li>
<li>.NET Core, Version 3.1</li>
<li>.NET 6 ~ 8</li>
</ul>
<blockquote>
<p>NuGetåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nuget.org%2Fpackages%2FDotNetProjects.SVGImage" target="_blank" title="https://www.nuget.org/packages/DotNetProjects.SVGImage" ref="nofollow noopener noreferrer">www.nuget.org/packages/Doâ€¦</a></p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5060f01794d42c38ee67bdefe1fa72e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=OWGwGZsD2FayasNqJ4j0pf5zkU0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">é¡¹ç›®æºä»£ç è¿è¡Œ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cb1929212264368be06ddd9e57c6a56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=u4U3dXT2f46UJYBR3UUDq4irkyc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90316529f27640629910bff83d02404c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=ZechpLXP5CkNlVh%2F%2BR9%2FJD%2Bhi9c%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4614778fb77d40e8bce2fc4242f03a3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=IGnRQC3aB4cn6%2Bxgbnh8tqJrchU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/330eed2c567e4fba924df41cdb8169fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=rUQCAagnMOXqP06KlbMJoYIfOdI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d47e014a1d634736b0b0b71759e89ad2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=VJxiYxYnIxmT7a%2BKDMmk%2BmUWYiw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98f4693d4ca146838ba206e3503b3fe6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=XDPxNAGyoLQGXM7gaG5JhklgIoQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0ab687004ba4a499ab5c1353c30207e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=RCNbaT9dSPVl4nw0Puhvk8JfMmQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46aae09b4a5e4879bab6c92fc62c0859~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=GAkWJrYgwbBYKgZ4TdYOKElJP3M%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fdfaee29d124dddaf59e6413592f3e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930650&amp;x-signature=Rd0USPsHi7H1Oraiyjkk7HqoQLU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">é¡¹ç›®æºç åœ°å€</h2>
<p>æ›´å¤šé¡¹ç›®å®ç”¨åŠŸèƒ½å’Œç‰¹æ€§æ¬¢è¿å‰å¾€é¡¹ç›®å¼€æºåœ°å€æŸ¥çœ‹ğŸ‘€ï¼Œåˆ«å¿˜äº†ç»™é¡¹ç›®ä¸€ä¸ªStaræ”¯æŒğŸ’–ã€‚</p>
<ul>
<li><strong>GitHubå¼€æºåœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdotnetprojects%2FSVGImage" target="_blank" title="https://github.com/dotnetprojects/SVGImage" ref="nofollow noopener noreferrer">github.com/dotnetprojeâ€¦</a></li>
</ul>
<h2 data-id="heading-6">ä¼˜ç§€é¡¹ç›®å’Œæ¡†æ¶ç²¾é€‰</h2>
<p>è¯¥é¡¹ç›®å·²æ”¶å½•åˆ°C#/.NET/.NET Coreä¼˜ç§€é¡¹ç›®å’Œæ¡†æ¶ç²¾é€‰ä¸­ï¼Œå…³æ³¨ä¼˜ç§€é¡¹ç›®å’Œæ¡†æ¶ç²¾é€‰èƒ½è®©ä½ åŠæ—¶äº†è§£C#ã€.NETå’Œ.NET Coreé¢†åŸŸçš„æœ€æ–°åŠ¨æ€å’Œæœ€ä½³å®è·µï¼Œæé«˜å¼€å‘å·¥ä½œæ•ˆç‡å’Œè´¨é‡ã€‚å‘å·²æŒ–ï¼Œæ¬¢è¿å¤§å®¶è¸Šè·ƒæäº¤PRæ¨èæˆ–è‡ªèï¼ˆ<strong>è®©ä¼˜ç§€çš„é¡¹ç›®å’Œæ¡†æ¶ä¸è¢«åŸ‹æ²¡ğŸ¤</strong>ï¼‰ã€‚</p>
<ul>
<li><strong>GitHubå¼€æºåœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FYSGStudyHards%2FDotNetGuide%2Fblob%2Fmain%2Fdocs%2FDotNet%2FDotNetProjectPicks.md" target="_blank" title="https://github.com/YSGStudyHards/DotNetGuide/blob/main/docs/DotNet/DotNetProjectPicks.md" ref="nofollow noopener noreferrer">github.com/YSGStudyHarâ€¦</a></li>
<li><strong>Giteeå¼€æºåœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fysgdaydayup%2FDotNetGuide%2Fblob%2Fmain%2Fdocs%2FDotNet%2FDotNetProjectPicks.md" target="_blank" title="https://gitee.com/ysgdaydayup/DotNetGuide/blob/main/docs/DotNet/DotNetProjectPicks.md" ref="nofollow noopener noreferrer">gitee.com/ysgdaydayupâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»å¤§å‚æ¯•ä¸šåï¼Œåˆ°å°å…¬å¸å½“ç®¡ç†ï¼Œåå¹´äº’è”ç½‘è€å…µçš„æ€ç»´ä¹ æƒ¯é˜¶æ®µå¤ç›˜]]></title>    <link>https://juejin.cn/post/7585751355592720403</link>    <guid>https://juejin.cn/post/7585751355592720403</guid>    <pubDate>2025-12-21T14:08:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585751355592720403" data-draft-id="7585789195868848164" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»å¤§å‚æ¯•ä¸šåï¼Œåˆ°å°å…¬å¸å½“ç®¡ç†ï¼Œåå¹´äº’è”ç½‘è€å…µçš„æ€ç»´ä¹ æƒ¯é˜¶æ®µå¤ç›˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T14:08:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uzong"/> <meta itemprop="url" content="https://juejin.cn/user/372082495985181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»å¤§å‚æ¯•ä¸šåï¼Œåˆ°å°å…¬å¸å½“ç®¡ç†ï¼Œåå¹´äº’è”ç½‘è€å…µçš„æ€ç»´ä¹ æƒ¯é˜¶æ®µå¤ç›˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/372082495985181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uzong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:08:07.000Z" title="Sun Dec 21 2025 14:08:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆä¸ºè‡ªå·±æˆé•¿çš„ç¬¬ä¸€è´£ä»»äººï¼šæ„å»ºä¸ªäººSOPï¼Œèµ°å‘é•¿æœŸä¸»ä¹‰çš„ç ´å±€ä¹‹è·¯</p>
<p>åœ¨è¿™ä¸ªä¿¡æ¯çˆ†ç‚¸ã€èŠ‚å¥é£å¿«çš„æ—¶ä»£ï¼Œæˆ‘ä»¬å¸¸å¸¸è¢«â€œç´§æ€¥â€è£¹æŒŸï¼Œå´å¿˜äº†â€œé‡è¦â€ã€‚æ¯å¤©çœ‹ä¼¼å¿™ç¢Œï¼Œå¹´ç»ˆå¤ç›˜æ—¶å´å‘ç°ä¸»çº¿ä»»åŠ¡å‡ ä¹ä¸ºé›¶ï¼›å¸®åˆ«äººå®Œæˆäº†æ— æ•°å°äº‹ï¼Œè‡ªå·±çš„OKRå´åŸåœ°è¸æ­¥ã€‚é—®é¢˜ä¸åœ¨åŠªåŠ›ä¸å¤Ÿï¼Œè€Œåœ¨æ–¹å‘æ¨¡ç³Šâ€”â€”æ²¡æœ‰å±äºè‡ªå·±çš„ä¸ªäººSOPï¼ˆæ ‡å‡†æ“ä½œæµç¨‹ï¼‰ï¼Œæ²¡æœ‰å¯¹â€œè¦äº‹â€çš„æ¸…æ™°ç•Œå®šï¼Œæ›´ç¼ºä¹ä¸€å¥—ç³»ç»Ÿæ€§çš„è‡ªæˆ‘æˆé•¿æœºåˆ¶ã€‚</p>
<p>çœŸæ­£çš„æˆé•¿ï¼Œä¸æ˜¯é åŠ ç­åŠ ç‚¹å †å‡ºæ¥çš„ï¼Œè€Œæ˜¯é€šè¿‡<strong>æ€»ç»“è§„å¾‹ã€æ²‰æ·€æ–¹æ³•ã€å‰–å¼€ç°è±¡ã€å¯»æ±‚æœ¬è´¨</strong>ï¼Œåœ¨æŒç»­çš„<strong>åˆ»æ„ç»ƒä¹ ã€æ€ç»´è·ƒè¿ã€è‡ªæˆ‘å¤ç›˜ä¸è¿­ä»£æ›´æ–°</strong>ä¸­ï¼Œå½¢æˆæ­£å‘é£è½®ã€‚å”¯æœ‰å¦‚æ­¤ï¼Œæ‰èƒ½çªç ´åœˆå±‚ï¼Œæ‰“ç ´æ€ç»´æƒ¯æ€§ï¼ŒçœŸæ­£æˆä¸ºè‡ªå·±äººç”Ÿçš„ç¬¬ä¸€è´£ä»»äººã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€è¦äº‹ç¬¬ä¸€ï¼šåˆ†æ¸…ä»€ä¹ˆæ˜¯â€œå¯¹ä½ çœŸæ­£é‡è¦çš„äº‹â€</h3>
<p>â€œè¦äº‹ç¬¬ä¸€â€å¬èµ·æ¥è€ç”Ÿå¸¸è°ˆï¼Œä½†å…³é”®åœ¨äºâ€”â€”<strong>å¯¹ä½ è€Œè¨€ï¼Œä»€ä¹ˆæ‰æ˜¯è¦äº‹ï¼Ÿ</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6ec742f0d2244eaa4d803a60a4df5e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=D3bwQtXfRYDa%2FnklquCXJr9xLbA%3D" alt="" loading="lazy"/></p>
<p>åœ¨èŒåœºï¼Œå®Œæˆè‡ªå·±çš„OKRæ˜¯æ ¸å¿ƒè¦äº‹ï¼›ååŠ©ä»–äººè™½ç´§æ€¥ï¼Œä½†è‹¥æŒ¤å äº†ä½ ä¸»çº¿ç›®æ ‡çš„æ—¶é—´ï¼Œå°±å¾—é‡æ–°æƒè¡¡ã€‚<br/>
å¦‚æœä½ å·¥ä½œçš„ç»ˆæç›®æ ‡æ˜¯æå‡èƒ½åŠ›ã€ä¸ºæœªæ¥è·³æ§½é“ºè·¯ï¼Œé‚£ä¹ˆä¸‹ç­åç¬¬ä¸€ä»¶äº‹ä¸è¯¥æ˜¯ç»§ç»­å¤„ç†è€æ¿çš„ä¸´æ—¶éœ€æ±‚ï¼Œè€Œåº”æ˜¯<strong>ç•™å‡ºå›ºå®šæ—¶é—´ç²¾è¿›æŠ€èƒ½</strong>â€”â€”æ¯”å¦‚æ¶æ„è®¾è®¡ã€ç³»ç»Ÿæ€ç»´ã€ç®¡ç†è®¤çŸ¥ã€‚</p>
<p>ã€Šé«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯ã€‹æ—©å·²æŒ‡å‡ºï¼š<strong>é‡è¦ä¸”ç´§æ€¥çš„äº‹éœ€ç«‹å³åšï¼Œä½†çœŸæ­£å†³å®šä½ é•¿æœŸä»·å€¼çš„ï¼Œæ˜¯é‚£äº›é‡è¦å´ä¸ç´§æ€¥çš„äº‹</strong>â€”â€”ç»ˆèº«å­¦ä¹ ã€å¥åº·ç»´æŠ¤ã€æ·±åº¦æ€è€ƒã€å…³ç³»ç»è¥ã€‚è¿™äº›äº‹ä¸å‚¬ä½ ï¼Œä½†ä¸€æ—¦è’åºŸï¼Œç»ˆå°†åå™¬ã€‚</p>
<p>è¯·æ­£è§†ï¼šå¯¹ä½ æœ€ç»ˆé‡è¦çš„ï¼Œç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿæ˜¯äº‹ä¸šçªç ´ï¼Ÿèº«å¿ƒå¥åº·ï¼Ÿè¿˜æ˜¯å®¶åº­é™ªä¼´ï¼Ÿæ‹æ¸…è¿™ä¸ªï¼Œæ‰èƒ½ä¸è¢«çç¢ç»‘æ¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/324108c8a51f4f39a01378ae754bee4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=mj97sogk3LE%2BMmjumBTRwswvURo%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-1">äºŒã€é•¿æœŸä¸»ä¹‰ï¼šæ—¥æ‹±ä¸€å’ï¼Œä¸“æ³¨ç¬¬äºŒè±¡é™</h3>
<p>æˆ‘ä»¬å¸¸é™·å…¥â€œç¬¬ä¸€è±¡é™â€ï¼ˆé‡è¦ä¸”ç´§æ€¥ï¼‰å’Œâ€œç¬¬å››è±¡é™â€ï¼ˆä¸é‡è¦ä½†ç´§æ€¥ï¼‰çš„æ³¥æ½­ï¼Œä¸šä½™æ—¶é—´åˆæ»‘å…¥â€œç¬¬ä¸‰è±¡é™â€ï¼ˆä¸é‡è¦ä¸ç´§æ€¥ï¼‰çš„å¨±ä¹æ¶ˆé£ã€‚ç»“æœï¼Œâ€œç¬¬äºŒè±¡é™â€â€”â€”<strong>é‡è¦ä½†ä¸ç´§æ€¥çš„äº‹</strong>â€”â€”è¢«æ— é™æ¨è¿Ÿã€‚</p>
<p>å¯æ°æ°æ˜¯è¿™äº›äº‹ï¼Œå†³å®šäº†ä½ èƒ½å¦è´¨å˜ï¼š</p>
<ul>
<li>æ¯å¤©è¯»30åˆ†é’ŸæŠ€æœ¯æ–‡æ¡£</li>
<li>æ¯å‘¨å¤ç›˜ä¸€æ¬¡é¡¹ç›®å¾—å¤±</li>
<li>æ¯æœˆè§„åˆ’ä¸€æ¬¡èŒä¸šè·¯å¾„</li>
</ul>
<p><strong>ä¸ªäººæˆé•¿å¿…é¡»å¤§äºå…¬å¸ä»»åŠ¡ï¼Œå®¶äººé™ªä¼´å¿…é¡»å¤§äºä¸ªäººæˆå°±</strong>ã€‚è§’è‰²ä¸åŒï¼Œä¼˜å…ˆçº§éšä¹‹è°ƒæ•´ï¼Œä½†æ ¸å¿ƒä¸å˜ï¼š<strong>å®ˆæŠ¤é‚£äº›é•¿æœŸå¯¹ä½ æœ‰ç›Šçš„æŠ•å…¥</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24592ce9224f47d58431848e5d343af7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=jO3Bw5dH%2FkWPDVgL1MZ8GB0a5LE%3D" alt="" loading="lazy"/></p>
<p>å·¥ä½œä¸­æœ‰ä¸»çº¿ä¸æ”¯çº¿ã€‚ä¿®bugã€æ•‘ç«ã€å¸®åŒäº‹ã€æ¥å°éœ€æ±‚â€¦â€¦çœ‹ä¼¼å……å®ï¼Œå®åˆ™å¤šä¸ºæ”¯çº¿ã€‚è‹¥ä¸€å¹´åˆ°å¤´ä¸»çº¿æœªæ¨è¿›ï¼Œå¹´ç»ˆè¿°èŒä¾¿æ— è¯å¯è¯´ã€‚ä½ å¯ä»¥å½“é…è§’ï¼Œä½†ä¸èƒ½æ°¸è¿œåªå½“é…è§’ã€‚<strong>é•¿æœŸä¸»ä¹‰ï¼Œå°±æ˜¯æ­»å®ˆä¸»çº¿ï¼Œæ‹’ç»è¢«æ— å…³äº‹åŠ¡ç¨€é‡Šèƒ½é‡</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/100aed2b159048839c48b79218e51d57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=mhHiWubHc71tvqi6C6xMd9rVSMo%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€ä¿æŒå¿ƒåŠ›ä¸ä¸“æ³¨ï¼šç²¾åŠ›æ˜¯æœ‰é™çš„æˆ˜ç•¥èµ„æº</h3>
<p>å¿ƒåŠ›æ¯”æ—¶é—´æ›´ç¨€ç¼ºã€‚çç¢æ²Ÿé€šã€æƒ…ç»ªå†…è€—ã€ä½ä»·å€¼ä¼šè®®ï¼Œéƒ½åœ¨æ— å£°åå™¬ä½ çš„æˆ˜ç•¥å¸¦å®½ã€‚<br/>
<strong>çœŸæ­£çš„é«˜æ‰‹ï¼Œæ‡‚å¾—â€œè¯¥æŠ•å…¥çš„å…¨åŠ›æŠ•å…¥ï¼Œä¸è¯¥ç¢°çš„åšå†³å±è”½â€</strong> ã€‚</p>
<p>ä¿æŒå¤§å—æ—¶é—´ç”¨äºæ·±åº¦æ€è€ƒä¸å…³é”®æ¨è¿›ã€‚ç¢ç‰‡åŒ–åªä¼šåˆ¶é€ â€œä¼ªå¿™ç¢Œâ€ã€‚<br/>
è¯­æ°”è¦åšå®šï¼Œé€»è¾‘è¦ç¼œå¯†ï¼Œå†³ç­–è¦æœ‰ä¸»è§â€”â€”è¿™ä¸ä»…æ˜¯ä¸“ä¸šç´ å…»ï¼Œæ›´æ˜¯å¯¹è‡ªæˆ‘å¿ƒåŠ›çš„ä¿æŠ¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8732fffdb7d4393aae1333d82541a7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=3bYZ%2FJIZTXRWwWRrJLWvDi4zVgk%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-3">å››ã€ç®€å•å¿«é€Ÿï¼šå®Œæˆè¿œèƒœå®Œç¾</h3>
<p>åœ¨å•†ä¸šä¸–ç•Œï¼Œ<strong>å®Œæˆæ¯”å®Œç¾é‡è¦åå€</strong>ã€‚<br/>
é¢†å¯¼é—®è¿›åº¦ï¼Œä½ è¯´â€œè¿˜åœ¨æ‰“ç£¨ç»†èŠ‚ï¼Œä¸€å‘¨åäº¤ä»˜â€ï¼Œä¸å¦‚è¯´â€œå·²ä¸Šçº¿å¯ç”¨ç‰ˆæœ¬ï¼Œç»†èŠ‚å¯åç»­ä¼˜åŒ–â€ã€‚</p>
<p>åè€…ä¼ é€’çš„æ˜¯æŒæ§æ„Ÿä¸æ‰§è¡ŒåŠ›ã€‚å‰è€…å¸¦æ¥çš„æ˜¯ä¸ç¡®å®šæ€§ä¸ç„¦è™‘ã€‚<br/>
ä»£ç è¶Šå°‘ï¼ŒBugè¶Šå°‘ï¼›æ–¹æ¡ˆè¶Šç®€ï¼Œç†è§£æˆæœ¬è¶Šä½ã€‚<strong>å¿«ã€å‡†ã€ç‹ ï¼Œæ‰æ˜¯èŒåœºç”Ÿå­˜æ³•åˆ™</strong>ã€‚</p>
<p>è®°ä½ï¼šå®Œç¾æ˜¯äº¤ä»˜çš„æ•Œäººã€‚å…ˆè·‘é€šé—­ç¯ï¼Œå†è¿­ä»£ä¼˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/765b53a6362948d68dd6c27c041ada52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=QI2PMlKvmRNznH6Tnhzep%2Bls46M%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-4">äº”ã€ç«‹å³è¡ŒåŠ¨ï¼šç”¨è¡ŒåŠ¨æ¶ˆç­ç„¦è™‘</h3>
<p>ç„¦è™‘çš„æœ¬è´¨ï¼Œæ˜¯æœªå®Œæˆäº‹é¡¹çš„å †ç§¯ã€‚<br/>
è¶Šæ˜¯æ‹–å»¶ï¼Œå¿ƒç†è´Ÿæ‹…è¶Šé‡ï¼›è¶Šæ—©åŠ¨æ‰‹ï¼Œè¶Šæ—©è§£è„±ã€‚</p>
<p>åˆ«å†™èŠ±é‡Œèƒ¡å“¨çš„å‘¨æŠ¥ï¼Œèšç„¦çœŸå®è¿›å±•ã€å¡ç‚¹ä¸æ±‚åŠ©ã€‚<strong>æ±‚çœŸåŠ¡å®ï¼Œæ˜¯æœ€é«˜æ•ˆçš„æ²Ÿé€šæ–¹å¼</strong>ã€‚<br/>
æƒ³åˆ°å°±åšï¼Œç›´æ¥å¹²ã€‚è¡ŒåŠ¨æ˜¯è§£è¯ï¼Œä¸æ˜¯é€‰é¡¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8696c523ad944221acba3830eb9b3680~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=CxfVm%2B5piZb82NitMzMDkjNOJWw%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-5">å…­ã€å‰ç»æ€§ä¸é¢„åˆ¤åŠ›ï¼šå¤šæƒ³ä¸‰æ­¥ï¼Œæå‰å¸ƒå±€</h3>
<p>é«˜æ‰‹ä¸æ™®é€šäººçš„åŒºåˆ«ï¼Œåœ¨äº<strong>æ˜¯å¦æå‰æ€è€ƒ</strong>ã€‚</p>
<ul>
<li>éœ€æ±‚è¯„å®¡æ—¶ï¼Œé¢„åˆ¤æŠ€æœ¯å€ºä¸æ‰©å±•æ€§</li>
<li>å›¢é˜Ÿå˜åŠ¨å‰ï¼Œä¸»åŠ¨æ²Ÿé€šHCé£é™©</li>
<li>é¡¹ç›®å¯åŠ¨å‰ï¼Œæ˜ç¡®å„æ–¹è´£ä»»è¾¹ç•Œ</li>
</ul>
<p><strong>ä¸è½»æ˜“ä¸‹å†³å®šï¼Œä½†ä¸€æ—¦å†³å®šï¼Œå¿…æœ‰ä¾æ®</strong>ã€‚<br/>
å¤šé—®ä¸€å¥â€œä¸ºä»€ä¹ˆâ€ï¼Œå¤šæƒ³ä¸€æ­¥â€œä¹‹åå‘¢â€ï¼Œå¾€å¾€èƒ½é¿å¼€å¤§å‘ã€‚é¢„åˆ¤ä¸æ˜¯å¤©èµ‹ï¼Œæ˜¯ä¹ æƒ¯ã€‚</p>
<hr/>
<h3 data-id="heading-6">ä¸ƒã€å…³æ³¨ç»“æœï¼šä¸ºäº§å‡ºè´Ÿè´£ï¼Œè€Œéè‹¦åŠ³</h3>
<p>å…¬å¸çœ‹çš„æ˜¯ç»“æœï¼Œä¸æ˜¯è¿‡ç¨‹ã€‚<br/>
å¹´ç»ˆæ€»ç»“æ—¶ï¼Œæ²¡äººè®°å¾—ä½ åŠ äº†å¤šå°‘ç­ï¼Œåªè®°å¾—ä½ äº¤ä»˜äº†ä»€ä¹ˆå…³é”®é¡¹ç›®ã€‚</p>
<p><strong>å‘å†…æ±‚ï¼Œä¸å‘å¤–èµ–</strong>ã€‚èµ„æºè¦äº‰å–ï¼Œä½†æ›´è¦è¯æ˜ROIï¼ˆæŠ•å…¥äº§å‡ºæ¯”ï¼‰ã€‚<br/>
æ›¿é¢†å¯¼æƒ³æ¸…æ¥šé—®é¢˜ï¼Œå¸®ä»–å‡è´Ÿï¼Œä½ æ‰çœŸæ­£å…·å¤‡ä¸å¯æ›¿ä»£æ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54499da647704dfe9aacfce5292f9025~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=TX0QTA4rOqkqfaMLTbA2UuXHVQE%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-7">å…«ã€è­¦æƒ•â€œæƒ°æ€§æ€ç»´â€ï¼šç”¨å·¥å…·ä¸è§„å¾‹ç ´å±€é‡å¤åŠ³åŠ¨</h3>
<p>æ›¾æœ‰ä¸€æ¬¡çº¿ä¸Šæ•…éšœï¼Œå…¨ç»„äººå·¥æ¯”å¯¹æ•°æ®åŠå°æ—¶æ— æœï¼Œé¢†å¯¼ä¸€æ¡SQLè„šæœ¬ç¬é—´å®šä½é—®é¢˜ã€‚é‚£ä¸€åˆ»çš„éœ‡æ’¼è‡³ä»Šéš¾å¿˜ï¼š<strong>äººè‚‰è‹¦å¹²ï¼Œä¸å¦‚ç³»ç»Ÿæ€è€ƒ</strong>ã€‚</p>
<p>é‡å¤æ€§å·¥ä½œä¸æ˜¯â€œå‹¤å¥‹â€çš„è¯æ˜ï¼Œè€Œæ˜¯â€œæ‡’äºæ€è€ƒâ€çš„é®ç¾å¸ƒã€‚<br/>
å–„ç”¨è„šæœ¬ã€æ¨¡æ¿ã€è‡ªåŠ¨åŒ–å·¥å…·ï¼ŒæŠŠæ—¶é—´çœä¸‹æ¥åšé«˜ä»·å€¼çš„äº‹ã€‚<strong>ç§‘æŠ€çš„ä»·å€¼ï¼Œå°±æ˜¯è®©è€é»„ç‰›å¼åŠªåŠ›å˜å¾—è¿‡æ—¶</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5dab7fb3b1e493c956b0b70a02d242e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=evc6oJu7%2BvOHMMCK%2BnoQZH3CiHU%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-8">ä¹ã€æ‹†è§£é—®é¢˜ï¼šå¤§é—®é¢˜ï¼Œä¸è¿‡æ˜¯å‡ ä¸ªå°æ ¸å¿ƒ</h3>
<p>é¢å¯¹å¤æ‚éš¾é¢˜ï¼Œé«˜æ‰‹ä»ä¸æ…Œä¹±ã€‚ä»–ä»¬<strong>ä¸æ–­è¿½é—®ã€å±‚å±‚å‰–æï¼Œç›´åˆ°é—®é¢˜æ˜¾éœ²å‡ºæœ¬è´¨ç»“æ„</strong>ã€‚</p>
<p>ä¸€ä¸ªçœ‹ä¼¼åºå¤§çš„ç³»ç»Ÿæ•…éšœï¼Œå¯èƒ½åªæºäºä¸¤ä¸ªé…ç½®é”™è¯¯ï¼›<br/>
ä¸€ä¸ªè·¨å›¢é˜Ÿåä½œåƒµå±€ï¼Œæˆ–è®¸åªéœ€å˜æ¸…ä¸‰æ–¹è´£ä»»è¾¹ç•Œã€‚</p>
<p><strong>æ‹†è§£ï¼Œæ˜¯é¡¶çº§çš„èƒ½åŠ›</strong>ã€‚æŠŠå¤§é—®é¢˜åŒ–ä¸ºå¯æ‰§è¡Œçš„å°å•å…ƒï¼Œé€ä¸ªå‡»ç ´ï¼Œå…¨å±€è‡ªè§£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a767baf799554ccf87b4b917324d31c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdXpvbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766930887&amp;x-signature=cau7QIN1QwFJytnel70mNfKVZ4A%3D" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-9">ç»“è¯­ï¼šæ„å»ºä½ çš„ä¸ªäººSOPï¼Œå¯åŠ¨æˆé•¿é£è½®</h3>
<p>æˆé•¿ä¸æ˜¯å¶ç„¶ï¼Œè€Œæ˜¯è®¾è®¡ã€‚å°½æ—©å»ºç«‹å±äºè‡ªå·±çš„SOPï¼š</p>
<ul>
<li>æ˜ç¡®è¦äº‹</li>
<li>åšå®ˆé•¿æœŸ</li>
<li>ä¿æŠ¤å¿ƒåŠ›</li>
<li>å¿«é€Ÿäº¤ä»˜</li>
<li>ç«‹å³è¡ŒåŠ¨</li>
<li>æå‰é¢„åˆ¤</li>
<li>èšç„¦ç»“æœ</li>
<li>å–„ç”¨å·¥å…·</li>
<li>æ‹†è§£é—®é¢˜</li>
</ul>
<p>åœ¨ä¸€æ¬¡æ¬¡å¤ç›˜ã€è¿­ä»£ã€æ›´æ–°ä¸­ï¼Œè¿™å¥—ç³»ç»Ÿä¼šè¶Šæ¥è¶Šå¼ºï¼Œæœ€ç»ˆå½¢æˆ<strong>è‡ªæˆ‘é©±åŠ¨çš„é£è½®æ•ˆåº”</strong>â€”â€”ä½ ä¸å†è¢«ç¯å¢ƒæ¨ç€èµ°ï¼Œè€Œæ˜¯ä¸»åŠ¨å®šä¹‰è‡ªå·±çš„è½¨è¿¹ã€‚<strong>æˆä¸ºè‡ªå·±æˆé•¿é“è·¯ä¸Šçš„ç¬¬ä¸€è´£ä»»äººï¼Œä¸æ˜¯ä¸€å¥å£å·ï¼Œè€Œæ˜¯ä¸€å¥—å¯æ‰§è¡Œã€å¯æ²‰æ·€ã€å¯ä¼ æ‰¿çš„æ–¹æ³•è®º</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼škratos-bootstrap å…¥é—¨æ•™ç¨‹ï¼ˆç±»æ¯” Spring Bootï¼‰]]></title>    <link>https://juejin.cn/post/7585798113546666034</link>    <guid>https://juejin.cn/post/7585798113546666034</guid>    <pubDate>2025-12-21T14:09:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585798113546666034" data-draft-id="7585798113546649650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼škratos-bootstrap å…¥é—¨æ•™ç¨‹ï¼ˆç±»æ¯” Spring Bootï¼‰"/> <meta itemprop="keywords" content="åç«¯,Go,å¾®æœåŠ¡"/> <meta itemprop="datePublished" content="2025-12-21T14:09:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–µä¸ªå’ª"/> <meta itemprop="url" content="https://juejin.cn/user/1350630784901262"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼škratos-bootstrap å…¥é—¨æ•™ç¨‹ï¼ˆç±»æ¯” Spring Bootï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1350630784901262/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–µä¸ªå’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:09:16.000Z" title="Sun Dec 21 2025 14:09:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼škratos-bootstrap å…¥é—¨æ•™ç¨‹ï¼ˆç±»æ¯” Spring Bootï¼‰</h2>
<p>kratos-bootstrap æ˜¯ GoWind Admin åº•å±‚æ ¸å¿ƒçš„åº”ç”¨å¼•å¯¼æ¡†æ¶ï¼Œæ‰¿æ‹…ç€ç±»ä¼¼ Java ç”Ÿæ€ä¸­ Spring Boot çš„è§’è‰² â€”â€” é€šè¿‡æ ‡å‡†åŒ–åˆå§‹åŒ–æµç¨‹ã€ç»Ÿä¸€é…ç½®ç®¡ç†ã€ç®€åŒ–ç»„ä»¶é›†æˆï¼Œä¸ºå¼€å‘è€…å±è”½åŸºç¡€è®¾æ–½æ­å»ºçš„å¤æ‚æ€§ã€‚å€ŸåŠ©å®ƒï¼Œå¼€å‘è€…æ— éœ€é‡å¤ç¼–å†™å¾®æœåŠ¡å¯åŠ¨ã€é…ç½®åŠ è½½ã€ä¸­é—´ä»¶æ³¨å†Œç­‰æ ·æ¿ä»£ç ï¼Œå¯ç›´æ¥èšç„¦ä¸šåŠ¡é€»è¾‘å¼€å‘ã€‚æœ¬æ–‡å°†è¯¦ç»†è®²è§£å¦‚ä½•åœ¨ GoWind Admin ä¸­é€šè¿‡ kratos-bootstrap å®Œæˆåº”ç”¨åˆå§‹åŒ–ã€é…ç½®ç®¡ç†ã€ç»„ä»¶é›†æˆç­‰å…³é”®æ“ä½œï¼Œå¹¶å¯¹æ¯” Spring ç­‰ä¸»æµæ¡†æ¶çš„è®¾è®¡ç†å¿µï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€kratos-bootstrap åœ¨ GoWind Admin ä¸­çš„è§’è‰²ï¼šç±»æ¯” Spring Boot çš„ã€ŒåŸºç¡€è®¾æ–½å¼•æ“ã€</h3>
<p>åœ¨ Java ç”Ÿæ€ä¸­ï¼ŒSpring Boot ä»¥ã€Œè‡ªåŠ¨é…ç½®ã€ starters ä¾èµ–ã€åµŒå…¥å¼å®¹å™¨ã€ä¸‰å¤§ç‰¹æ€§ç®€åŒ–äº†åº”ç”¨å¼€å‘ï¼›è€Œåœ¨ GoWind Admin ä¸­ï¼Œkratos-bootstrap æ‰®æ¼”ç€ç±»ä¼¼è§’è‰²ï¼Œä¸º Go å¾®æœåŠ¡æä¾›ã€Œä¸€ç«™å¼åŸºç¡€è®¾æ–½è§£å†³æ–¹æ¡ˆã€ã€‚å…¶æ ¸å¿ƒä»·å€¼ä½“ç°åœ¨ï¼š</p>



































<table><thead><tr><th>åŠŸèƒ½ç»´åº¦</th><th>kratos-bootstrap å®ç°</th><th>Spring ç”Ÿæ€å¯¹åº”ç»„ä»¶</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td>åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</td><td><code>bootstrap.Bootstrap</code> ç»Ÿä¸€ç®¡æ§ä»åˆå§‹åŒ–åˆ°é€€å‡ºçš„æµç¨‹</td><td>Spring å®¹å™¨çš„ refresh() ç”Ÿå‘½å‘¨æœŸ</td><td>æ ‡å‡†åŒ–å¯åŠ¨ / å…³é—­æµç¨‹ï¼Œé¿å…é‡å¤ç¼–ç </td></tr><tr><td>é…ç½®ç®¡ç†</td><td>å¤šæºé…ç½®ï¼ˆæœ¬åœ°æ–‡ä»¶ / Etcd/Nacos ç­‰ï¼‰è‡ªåŠ¨èšåˆ</td><td>Spring Cloud Config + @Configuration</td><td>åŠ¨æ€åŠ è½½ã€åˆå¹¶å¤šç¯å¢ƒé…ç½®</td></tr><tr><td>ç»„ä»¶é›†æˆ</td><td>é¢„å®šä¹‰ä¸­é—´ä»¶ã€æ•°æ®åº“ã€æ³¨å†Œä¸­å¿ƒçš„é›†æˆæ¥å£</td><td>Spring Boot Startersï¼ˆå¦‚ spring-boot-starter-webï¼‰</td><td>ä¸€é”®é›†æˆç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå‡å°‘ä¾èµ–é…ç½®</td></tr><tr><td>ç¯å¢ƒé€‚é…</td><td>å‘½ä»¤è¡Œå‚æ•° + ç¯å¢ƒå˜é‡åŠ¨æ€è°ƒæ•´é…ç½®</td><td>Spring Profiles + å¤–éƒ¨åŒ–é…ç½®</td><td>çµæ´»é€‚é…å¼€å‘ / æµ‹è¯• / ç”Ÿäº§ç¯å¢ƒ</td></tr></tbody></table>
<p>åœ¨ GoWind Admin ä¸­ï¼Œkratos-bootstrap æ˜¯æ•´ä¸ªåº”ç”¨çš„ã€Œå‘åŠ¨æœºã€ï¼š<code>main</code> å‡½æ•°é€šè¿‡è°ƒç”¨å…¶æ ¸å¿ƒæ–¹æ³•å¯åŠ¨åº”ç”¨ï¼Œæ‰€æœ‰åŸºç¡€è®¾æ–½ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€æœåŠ¡æ³¨å†Œã€æ—¥å¿—ç»„ä»¶ï¼‰å‡é€šè¿‡å®ƒåŠ è½½ï¼Œå½¢æˆã€Œé…ç½®é©±åŠ¨ã€ç»„ä»¶å¯æ’æ‹”ã€çš„æ¶æ„ã€‚</p>
<h3 data-id="heading-2">äºŒã€å¿«é€Ÿä¸Šæ‰‹ï¼šåˆå§‹åŒ–ä¸å¯åŠ¨æµç¨‹ï¼ˆç±»æ¯” Spring å®¹å™¨å¯åŠ¨ï¼‰</h3>
<p>GoWind Admin çš„å¯åŠ¨æµç¨‹ä¸ Spring Boot ç±»ä¼¼ï¼Œå‡éµå¾ªã€Œé…ç½®åŠ è½½â†’ç»„ä»¶åˆå§‹åŒ–â†’æœåŠ¡å¯åŠ¨â†’ä¼˜é›…é€€å‡ºã€çš„ç”Ÿå‘½å‘¨æœŸã€‚ä»¥ä¸‹ä»ä»£ç å®ç°å’Œæµç¨‹è§£æä¸¤æ–¹é¢å±•å¼€ã€‚</p>
<h4 data-id="heading-3">1. æ ¸å¿ƒå¯åŠ¨å…¥å£ï¼šä¸€è¡Œä»£ç å¯åŠ¨åº”ç”¨</h4>
<p>ä¸ Spring Boot çš„ <code>SpringApplication.run(Application.class, args)</code> ç±»ä¼¼ï¼Œkratos-bootstrap æä¾›äº† <code>bootstrap.RunApp</code> ä½œä¸ºå¯åŠ¨å…¥å£ï¼Œå°è£…äº†æ‰€æœ‰åˆå§‹åŒ–ç»†èŠ‚ã€‚å…¸å‹ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>

	<span class="hljs-string">"github.com/go-kratos/kratos/v2"</span>
	<span class="hljs-string">"github.com/go-kratos/kratos/v2/transport/http"</span>
	<span class="hljs-string">"github.com/tx7do/kratos-transport/transport/asynq"</span>
	<span class="hljs-string">"github.com/tx7do/kratos-transport/transport/sse"</span>

	conf <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/api/gen/go/conf/v1"</span>
	<span class="hljs-string">"github.com/tx7do/kratos-bootstrap/bootstrap"</span>

	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/apollo"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/consul"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/etcd"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/kubernetes"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/nacos"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/config/polaris"</span>

	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/aliyun"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/fluent"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/logrus"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/tencent"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/zap"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/logger/zerolog"</span>

	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/consul"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/etcd"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/eureka"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/kubernetes"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/nacos"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/polaris"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/servicecomb"</span>
	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/registry/zookeeper"</span>

	<span class="hljs-comment">//_ "github.com/tx7do/kratos-bootstrap/tracer"</span>

	<span class="hljs-string">"go-wind-admin/pkg/service"</span>
)

<span class="hljs-keyword">var</span> version = <span class="hljs-string">"1.0.0"</span>

<span class="hljs-comment">// go build -ldflags "-X main.version=x.y.z"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newApp</span><span class="hljs-params">(
	ctx *bootstrap.Context,
	hs *http.Server,
	as *asynq.Server,
	ss *sse.Server,
)</span></span> *kratos.App {
	<span class="hljs-keyword">return</span> bootstrap.NewApp(ctx,
		hs,
		as,
		ss,
	)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">runApp</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
	ctx := bootstrap.NewContext(
		context.Background(),
		&amp;conf.AppInfo{
			Project: service.Project,
			AppId:   service.AdminService,
			Version: version,
		},
	)
	<span class="hljs-keyword">return</span> bootstrap.RunApp(ctx, initApp)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-keyword">if</span> err := runApp(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-built_in">panic</span>(err)
	}
}
</code></pre>
<p><strong>å…³é”®ç±»æ¯”ï¼š</strong></p>
<ul>
<li><code>bootstrap.NewContext</code> ç±»ä¼¼ Spring çš„ <code>ApplicationContext</code>ï¼Œå­˜å‚¨åº”ç”¨é…ç½®ã€ç»„ä»¶å®ä¾‹ç­‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›</li>
<li>è¢«æ³¨é‡Šçš„ç»„ä»¶å¯¼å…¥ï¼ˆå¦‚ <code>_ "github.com/tx7do/kratos-bootstrap/config/etcd"</code>ï¼‰ç±»ä¼¼ Spring Starter çš„ <code>@EnableXXX</code> æ³¨è§£ï¼Œé€šè¿‡ã€Œå¯¼å…¥å³å¯ç”¨ã€çš„æ–¹å¼å®ç°ç»„ä»¶è‡ªåŠ¨é…ç½®ã€‚</li>
</ul>
<h4 data-id="heading-4">2. åˆå§‹åŒ–æµç¨‹è§£æï¼šä¸ Spring ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”</h4>
<p>kratos-bootstrap çš„å¯åŠ¨æµç¨‹åœ¨ <code>bootstrap.go</code> ä¸­å®šä¹‰ï¼Œå¯ç±»æ¯” Spring å®¹å™¨çš„ <code>refresh()</code> è¿‡ç¨‹ï¼Œåˆ†ä¸ºä»¥ä¸‹é˜¶æ®µï¼š</p>









































<table><thead><tr><th>é˜¶æ®µ</th><th>kratos-bootstrap å®ç°</th><th>Spring å¯¹åº”é˜¶æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>1. åº”ç”¨ä¿¡æ¯åˆå§‹åŒ–</td><td><code>copyAppInfo</code> å¤åˆ¶åº”ç”¨å…ƒæ•°æ®ï¼ˆåç§°ã€ç‰ˆæœ¬ç­‰ï¼‰</td><td><code>prepareContext</code> å‡†å¤‡ä¸Šä¸‹æ–‡</td><td>è®°å½•åº”ç”¨æ ‡è¯†ï¼Œç”¨äºæ—¥å¿—ã€æ³¨å†Œä¸­å¿ƒç­‰åœºæ™¯</td></tr><tr><td>2. é…ç½®åŠ è½½</td><td><code>bootstrap</code> åŠ è½½æœ¬åœ° / è¿œç¨‹é…ç½®ï¼Œåˆå¹¶ä¸ºç»Ÿä¸€é…ç½®å¯¹è±¡</td><td><code>loadBeanDefinitions</code> åŠ è½½é…ç½®</td><td>æ”¯æŒå¤šæºé…ç½®èšåˆï¼Œè¿œç¨‹é…ç½®ï¼ˆå¦‚ Etcdï¼‰ä¼˜å…ˆçº§é«˜äºæœ¬åœ°æ–‡ä»¶</td></tr><tr><td>3. ç»„ä»¶åˆå§‹åŒ–</td><td><code>initApp</code> å›è°ƒç”¨æˆ·è‡ªå®šä¹‰åˆå§‹åŒ–é€»è¾‘ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€ä¸­é—´ä»¶æ³¨å†Œï¼‰</td><td><code>onRefresh</code> åˆå§‹åŒ–éæ‡’åŠ è½½ Bean</td><td>å¼€å‘è€…åœ¨æ­¤å¤„æ³¨å†Œä¸šåŠ¡ç»„ä»¶ï¼Œæ¡†æ¶è‡ªåŠ¨ç®¡ç†ä¾èµ–</td></tr><tr><td>4. æœåŠ¡å¯åŠ¨</td><td><code>app.Run()</code> å¯åŠ¨ HTTP/GRPC ç­‰æœåŠ¡ï¼Œæ³¨å†Œåˆ°æœåŠ¡å‘ç°ä¸­å¿ƒ</td><td><code>finishRefresh</code> å¯åŠ¨åµŒå…¥å¼å®¹å™¨</td><td>è‡ªåŠ¨ç»‘å®šç«¯å£ï¼Œæ³¨å†ŒæœåŠ¡å®ä¾‹åˆ°æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ Etcdï¼‰</td></tr><tr><td>5. ä¼˜é›…é€€å‡º</td><td><code>defer cleanup()</code> æ‰§è¡Œèµ„æºé‡Šæ”¾é€»è¾‘ï¼ˆå…³é—­æ•°æ®åº“è¿æ¥ã€æ³¨é”€æœåŠ¡ï¼‰</td><td><code>registerShutdownHook</code> é’©å­å‡½æ•°</td><td>ç›‘å¬ç³»ç»Ÿä¿¡å·ï¼ˆå¦‚ SIGINTï¼‰ï¼Œç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾</td></tr></tbody></table>
<p>é€šè¿‡è¿™ç§æ ‡å‡†åŒ–æµç¨‹ï¼Œkratos-bootstrap é¿å…äº†å¼€å‘è€…æ‰‹åŠ¨ç¼–å†™åˆå§‹åŒ–é€»è¾‘ï¼Œå¦‚åŒ Spring æ¶ˆé™¤äº† XML é…ç½®çš„ç¹çã€‚</p>
<h3 data-id="heading-5">ä¸‰ã€é…ç½®ç®¡ç†ï¼šå¤šæºé…ç½®ä¸åŠ¨æ€æ›´æ–°ï¼ˆç±»æ¯” Spring Cloud Configï¼‰</h3>
<p>kratos-bootstrap çš„é…ç½®ç®¡ç†æœºåˆ¶ç±»ä¼¼ Spring Cloud Config + Nacos çš„ç»„åˆï¼Œæ”¯æŒæœ¬åœ°æ–‡ä»¶ã€Etcdã€Nacos ç­‰å¤šæºé…ç½®ï¼Œå¹¶æä¾›é…ç½®çƒ­æ›´æ–°èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒè®¾è®¡éµå¾ªã€Œçº¦å®šä¼˜äºé…ç½®ã€åŸåˆ™ï¼Œé…ç½®å®šä¹‰åŸºäº Protobuf å®ç°å¼ºç±»å‹æ ¡éªŒã€‚</p>
<h4 data-id="heading-6">1. é…ç½®æ–‡ä»¶ç»“æ„ï¼šå¼ºç±»å‹å®šä¹‰ï¼ˆç±»æ¯” Spring @ConfigurationPropertiesï¼‰</h4>
<p>ä¸ Spring é€šè¿‡ <code>@ConfigurationProperties</code> ç»‘å®šé…ç½®ç±»ç±»ä¼¼ï¼Œkratos-bootstrap ä½¿ç”¨ Protobuf å®šä¹‰é…ç½®ç»“æ„ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚æ ¸å¿ƒé…ç½® Bootstrap å®šä¹‰åœ¨ <code>api/protos/conf/v1/kratos_conf_bootstrap.proto</code> ä¸­ï¼ŒåŒ…å«æ‰€æœ‰ç»„ä»¶çš„é…ç½®é¡¹ï¼š</p>
<pre><code class="hljs language-protobuf" lang="protobuf">// å¼•å¯¼é…ç½®æ ¹ç»“æ„
message Bootstrap {
  optional Server server = 1;        // æœåŠ¡é…ç½®ï¼ˆHTTP/GRPC ç«¯å£ã€è¶…æ—¶ç­‰ï¼‰
  optional Client client = 2;        // å®¢æˆ·ç«¯é…ç½®ï¼ˆè°ƒç”¨å…¶ä»–æœåŠ¡çš„å‚æ•°ï¼‰
  optional Data data = 3;            // æ•°æ®åº“é…ç½®ï¼ˆMySQL/Redis/InfluxDB ç­‰ï¼‰
  optional Logger logger = 5;        // æ—¥å¿—é…ç½®ï¼ˆè¾“å‡ºæ ¼å¼ã€çº§åˆ«ã€å­˜å‚¨æ–¹å¼ï¼‰
  optional Registry registry = 6;    // æœåŠ¡æ³¨å†Œå‘ç°é…ç½®ï¼ˆEtcd/Nacos åœ°å€ç­‰ï¼‰
  optional RemoteConfig config = 7;  // è¿œç¨‹é…ç½®ä¸­å¿ƒé…ç½®ï¼ˆç±»å‹ã€è¿æ¥å‚æ•°ï¼‰
  optional OSS oss = 8;              // å¯¹è±¡å­˜å‚¨é…ç½®ï¼ˆMinIO åœ°å€ã€å¯†é’¥ç­‰ï¼‰
  optional Authentication authn = 10;// è®¤è¯é…ç½®ï¼ˆJWT å¯†é’¥ã€è¿‡æœŸæ—¶é—´ç­‰ï¼‰
  // ... å…¶ä»–ç»„ä»¶é…ç½®
}
</code></pre>
<p>åœ¨ GoWind Admin ä¸­ï¼Œé…ç½®æ–‡ä»¶é»˜è®¤æ”¾åœ¨ <code>configs/</code> ç›®å½•ï¼ŒæŒ‰ç¯å¢ƒæ‹†åˆ†ï¼ˆå¦‚ <code>configs/dev/</code>ã€<code>configs/prod/</code>ï¼‰ï¼Œæ ¼å¼ä¸ Protobuf ç»“æ„ä¸€ä¸€å¯¹åº”ï¼ˆæ”¯æŒ YAML/JSON/XML ç­‰ï¼‰ã€‚ä¾‹å¦‚ <code>configs/dev/config.yaml</code> ç‰‡æ®µï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">http:</span>
    <span class="hljs-attr">addr:</span> <span class="hljs-string">"0.0.0.0:8080"</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">"30s"</span>
<span class="hljs-attr">logger:</span>
  <span class="hljs-attr">level:</span> <span class="hljs-string">"debug"</span>
  <span class="hljs-attr">output:</span> <span class="hljs-string">"stdout"</span>
<span class="hljs-attr">registry:</span>
  <span class="hljs-attr">etcd:</span>
    <span class="hljs-attr">endpoints:</span> [<span class="hljs-string">"127.0.0.1:2379"</span>]
</code></pre>
<h4 data-id="heading-7">2. åŠ è½½è¿œç¨‹é…ç½®ï¼šä»¥ Etcd ä¸ºä¾‹ï¼ˆç±»æ¯” Nacos é…ç½®ä¸­å¿ƒï¼‰</h4>
<p>å½“éœ€è¦åŠ¨æ€è°ƒæ•´é…ç½®ï¼ˆå¦‚çº¿ä¸Šä¸´æ—¶è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼‰æ—¶ï¼Œå¯é€šè¿‡è¿œç¨‹é…ç½®ä¸­å¿ƒå®ç°ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼ˆä»¥ Etcd ä¸ºä¾‹ï¼‰ï¼š</p>
<h5 data-id="heading-8">ï¼ˆ1ï¼‰å¯ç”¨ Etcd é…ç½®é©±åŠ¨ï¼ˆç±»ä¼¼å¼•å…¥ spring-cloud-starter-alibaba-nacos-configï¼‰</h5>
<p>åœ¨ä»£ç ä¸­å¯¼å…¥ Etcd é…ç½®é©±åŠ¨ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨æ³¨å†Œé…ç½®è§£æå™¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
  _ <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/config/etcd"</span> <span class="hljs-comment">// å¯ç”¨ Etcd é…ç½®æ”¯æŒ</span>
)
</code></pre>
<h5 data-id="heading-9">ï¼ˆ2ï¼‰é…ç½® Etcd è¿æ¥ä¿¡æ¯</h5>
<p>åœ¨æœ¬åœ°é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿œç¨‹é…ç½®ä¸­å¿ƒç±»å‹å’Œè¿æ¥å‚æ•°ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">config:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">"etcd"</span>               <span class="hljs-comment"># è¿œç¨‹é…ç½®ç±»å‹ï¼ˆæ”¯æŒ etcd/nacos/consul ç­‰ï¼‰</span>
  <span class="hljs-attr">etcd:</span>
    <span class="hljs-attr">endpoints:</span> [<span class="hljs-string">"127.0.0.1:2379"</span>]  <span class="hljs-comment"># Etcd é›†ç¾¤åœ°å€</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">"/go-wind-admin/configs"</span> <span class="hljs-comment"># é…ç½®åœ¨ Etcd ä¸­çš„å­˜å‚¨è·¯å¾„</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">"5s"</span>                  <span class="hljs-comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span>
</code></pre>
<h5 data-id="heading-10">ï¼ˆ3ï¼‰é…ç½®çƒ­æ›´æ–°ï¼ˆç±»æ¯” Spring @RefreshScopeï¼‰</h5>
<p>kratos-bootstrap ä¼šç›‘å¬è¿œç¨‹é…ç½®å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–°å†…å­˜ä¸­çš„é…ç½®å¯¹è±¡ã€‚è‹¥éœ€åœ¨é…ç½®å˜åŒ–æ—¶æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚é‡å¯è¿æ¥ï¼‰ï¼Œå¯æ³¨å†Œç›‘å¬å™¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *source)</span></span> Watch() (config.Watcher, <span class="hljs-type">error</span>) {
	w, err := newWatcher(s)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, wrapConnError(<span class="hljs-string">"create watcher"</span>, s.options.path, err)
	}
	<span class="hljs-keyword">return</span> w, <span class="hljs-literal">nil</span>
}
</code></pre>
<h4 data-id="heading-11">3. æ³¨å†Œè‡ªå®šä¹‰é…ç½®ï¼ˆç±»æ¯” Spring è‡ªå®šä¹‰ @Configurationï¼‰</h4>
<p>è‹¥ä¸šåŠ¡éœ€è¦è‡ªå®šä¹‰é…ç½®ï¼ˆå¦‚ç¬¬ä¸‰æ–¹ API å¯†é’¥ï¼‰ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ‰©å±•ï¼š</p>
<h5 data-id="heading-12">ï¼ˆ1ï¼‰å®šä¹‰ Protobuf ç»“æ„</h5>
<pre><code class="hljs language-protobuf" lang="protobuf">// api/protos/conf/v1/custom_config.proto
syntax = "proto3";
package conf.v1;

message CustomConfig {
  string api_key = 1;    // ç¬¬ä¸‰æ–¹ API å¯†é’¥
  int32 timeout = 2;     // è°ƒç”¨è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
}
</code></pre>
<h5 data-id="heading-13">ï¼ˆ2ï¼‰æ³¨å†Œé…ç½®åˆ°æ¡†æ¶</h5>
<p>é€šè¿‡ <code>bootstrap.Context.RegisterCustomConfig</code> æ³¨å†Œè‡ªå®šä¹‰é…ç½®ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨ä»å¤šæºé…ç½®ä¸­åŠ è½½å¹¶è§£æï¼š</p>
<pre><code class="hljs language-go" lang="go">ctx := bootstrap.NewContext(
    context.Background(),
    &amp;conf.AppInfo{
        Project: service.Project,
        AppId:   service.AdminService,
        Version: version,
    },
)
ctx.RegisterCustomConfig(<span class="hljs-string">"CustomConfig"</span>, &amp;appConf.CustomConfig{})
</code></pre>
<h5 data-id="heading-14">ï¼ˆ3ï¼‰ä½¿ç”¨é…ç½®</h5>
<p>åœ¨ä»£ç ä¸­é€šè¿‡ä¸Šä¸‹æ–‡è·å–è§£æåçš„é…ç½®ï¼š</p>
<pre><code class="hljs language-go" lang="go">cfg, ok := ctx.GetCustomConfig(<span class="hljs-string">"CustomConfig"</span>)
<span class="hljs-keyword">if</span> ok {
    cfg.(*appConf.CustomConfig).ApiKey
}
</code></pre>
<h3 data-id="heading-15">å››ã€ç»„ä»¶é›†æˆï¼šä¸­é—´ä»¶ä¸æœåŠ¡å‘ç°ï¼ˆç±»æ¯” Spring ç”Ÿæ€ç»„ä»¶ï¼‰</h3>
<p>kratos-bootstrap é¢„è®¾äº†ä¸°å¯Œçš„ç»„ä»¶é›†æˆæ¥å£ï¼Œç±»ä¼¼ Spring Boot Starterï¼Œå¼€å‘è€…åªéœ€å¯¼å…¥å¯¹åº”åŒ…å¹¶é…ç½®å‚æ•°ï¼Œå³å¯å¿«é€Ÿé›†æˆä¸­é—´ä»¶ã€æ•°æ®åº“ã€æœåŠ¡æ³¨å†Œç­‰ç»„ä»¶ã€‚</p>
<h4 data-id="heading-16">1. æœåŠ¡æ³¨å†Œå‘ç°ï¼šä»¥ Etcd ä¸ºä¾‹ï¼ˆç±»æ¯” Spring Cloud Eureka/Consulï¼‰</h4>
<p>æœåŠ¡æ³¨å†Œå‘ç°æ˜¯å¾®æœåŠ¡çš„æ ¸å¿ƒèƒ½åŠ›ï¼Œkratos-bootstrap é›†æˆäº† Etcdã€Nacos ç­‰ä¸»æµæ³¨å†Œä¸­å¿ƒï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h5 data-id="heading-17">ï¼ˆ1ï¼‰å¯¼å…¥ Etcd æ³¨å†Œé©±åŠ¨</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
  _ <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/registry/etcd"</span> <span class="hljs-comment">// å¯ç”¨ Etcd æ³¨å†Œä¸­å¿ƒ</span>
)
</code></pre>
<h5 data-id="heading-18">ï¼ˆ2ï¼‰é…ç½®æ³¨å†Œä¸­å¿ƒå‚æ•°</h5>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š Etcd åœ°å€å’ŒæœåŠ¡æ³¨å†Œä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">registry:</span>
  <span class="hljs-attr">etcd:</span>
    <span class="hljs-attr">endpoints:</span> [<span class="hljs-string">"127.0.0.1:2379"</span>]  <span class="hljs-comment"># Etcd é›†ç¾¤åœ°å€</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">"3s"</span>                  <span class="hljs-comment"># è¿æ¥è¶…æ—¶</span>
    <span class="hljs-attr">prefix:</span> <span class="hljs-string">"/go-wind-admin/services"</span> <span class="hljs-comment"># æœåŠ¡æ³¨å†Œå‰ç¼€</span>
</code></pre>
<h5 data-id="heading-19">ï¼ˆ3ï¼‰è‡ªåŠ¨æ³¨å†Œä¸å‘ç°</h5>
<p>æ¡†æ¶ä¼šåœ¨æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨å°†å½“å‰å®ä¾‹æ³¨å†Œåˆ° Etcdï¼Œå¹¶åœ¨æœåŠ¡å…³é—­æ—¶æ³¨é”€ã€‚è°ƒç”¨å…¶ä»–æœåŠ¡æ—¶ï¼Œå¯é€šè¿‡æ³¨å†Œä¸­å¿ƒè‡ªåŠ¨å‘ç°åœ°å€ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
  <span class="hljs-string">"github.com/go-kratos/kratos/v2/transport/grpc"</span>
  <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/registry"</span>
)

<span class="hljs-comment">// åˆ›å»ºè°ƒç”¨å…¶ä»–æœåŠ¡çš„å®¢æˆ·ç«¯ï¼ˆè‡ªåŠ¨ä»æ³¨å†Œä¸­å¿ƒå‘ç°åœ°å€ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newUserClient</span><span class="hljs-params">(bctx *bootstrap.Context)</span></span> (user.UserClient, <span class="hljs-type">error</span>) {
  conn, err := grpc.DialInsecure(
    context.Background(),
    grpc.WithEndpoint(<span class="hljs-string">"discovery:///user-service"</span>), <span class="hljs-comment">// æœåŠ¡åä»æ³¨å†Œä¸­å¿ƒè·å–</span>
    grpc.WithDiscovery(bctx.Registry),              <span class="hljs-comment">// ä¼ å…¥æ³¨å†Œä¸­å¿ƒå®ä¾‹</span>
  )
  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
  }
  <span class="hljs-keyword">return</span> user.NewUserClient(conn), <span class="hljs-literal">nil</span>
}
</code></pre>
<p><strong>ç±»æ¯”è¯´æ˜ï¼š</strong></p>
<p>æ­¤è¿‡ç¨‹ç±»ä¼¼ Spring Cloud ä¸­é€šè¿‡ <code>@LoadBalanced</code> æ³¨è§£å’Œ <code>DiscoveryClient</code> å®ç°æœåŠ¡å‘ç°ï¼Œkratos-bootstrap ç®€åŒ–äº†æ³¨å†Œ / å‘ç°çš„åº•å±‚é€»è¾‘ï¼Œå¼€å‘è€…æ— éœ€å…³æ³¨å¿ƒè·³ã€å¥åº·æ£€æŸ¥ç­‰ç»†èŠ‚ã€‚</p>
<h4 data-id="heading-20">2. ä¸­é—´ä»¶é›†æˆï¼šé™æµä¸ç›‘æ§ï¼ˆç±»æ¯” Spring Interceptor/AOPï¼‰</h4>
<p>kratos-bootstrap æä¾›äº†é™æµã€ç›‘æ§ã€é“¾è·¯è¿½è¸ªç­‰å¸¸ç”¨ä¸­é—´ä»¶ï¼Œç±»ä¼¼ Spring çš„ Interceptor æˆ– AOP åˆ‡é¢ï¼Œå¯é€šè¿‡é…ç½®å¿«é€Ÿå¯ç”¨ã€‚</p>
<h5 data-id="heading-21">ï¼ˆ1ï¼‰HTTP é™æµä¸­é—´ä»¶ï¼ˆåŸºäº BBR ç®—æ³•ï¼‰</h5>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨é™æµï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">http:</span>
    <span class="hljs-attr">middleware:</span>
      <span class="hljs-attr">limiter:</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">"bbr"</span>       <span class="hljs-comment"># é™æµç®—æ³•ï¼ˆbbr/token-bucket ç­‰ï¼‰</span>
        <span class="hljs-attr">qps:</span> <span class="hljs-number">100</span>          <span class="hljs-comment"># æ¯ç§’è¯·æ±‚ä¸Šé™</span>
</code></pre>
<p>æ¡†æ¶ä¼šè‡ªåŠ¨æ³¨å†Œé™æµä¸­é—´ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–ç ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆå§‹åŒ– HTTP æœåŠ¡æ—¶è‡ªåŠ¨åº”ç”¨ä¸­é—´ä»¶</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">initHttpServer</span><span class="hljs-params">(bctx *bootstrap.Context)</span></span> *http.Server {
  <span class="hljs-keyword">return</span> http.NewServer(
    http.Middleware(
      <span class="hljs-comment">// æ¡†æ¶å·²é€šè¿‡é…ç½®è‡ªåŠ¨æ³¨å…¥é™æµã€è¿½è¸ªç­‰ä¸­é—´ä»¶</span>
      bctx.Middlewares.HTTP()...,
    ),
  )
}
</code></pre>
<h5 data-id="heading-22">ï¼ˆ2ï¼‰é“¾è·¯è¿½è¸ªï¼ˆç±»ä¼¼ Spring Cloud Sleuth + Zipkinï¼‰</h5>
<p>å¯¼å…¥è¿½è¸ªç»„ä»¶ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
  _ <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/tracer"</span> <span class="hljs-comment">// å¯ç”¨é“¾è·¯è¿½è¸ª</span>
)
</code></pre>
<p>å¹¶é…ç½®:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">trace:</span>
  <span class="hljs-attr">endpoint:</span> <span class="hljs-string">"localhost:4317"</span>
  <span class="hljs-attr">exporter:</span> <span class="hljs-string">"otlp-grpc"</span>
  <span class="hljs-attr">sampler:</span> <span class="hljs-number">1.0</span>
  <span class="hljs-attr">env:</span> <span class="hljs-string">"dev"</span>
  <span class="hljs-attr">insecure:</span> <span class="hljs-literal">true</span>
</code></pre>
<p>æ¡†æ¶ä¼šè‡ªåŠ¨ä¸º HTTP/GRPC è°ƒç”¨ç”Ÿæˆè¿½è¸ªé“¾è·¯ï¼Œæ— éœ€ä¾µå…¥ä¸šåŠ¡ä»£ç ã€‚</p>
<h4 data-id="heading-23">3. æ•°æ®åº“é›†æˆï¼šä»¥ InfluxDB ä¸ºä¾‹ï¼ˆç±»æ¯” Spring Data JPAï¼‰</h4>
<p>kratos-bootstrap å°è£…äº†ä¸»æµæ•°æ®åº“çš„å®¢æˆ·ç«¯åˆå§‹åŒ–é€»è¾‘ï¼Œä»¥ InfluxDB ä¸ºä¾‹ï¼š</p>
<h5 data-id="heading-24">ï¼ˆ1ï¼‰é…ç½®æ•°æ®åº“è¿æ¥</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">data:</span>
  <span class="hljs-attr">influxdb:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">"http://127.0.0.1:8181"</span>
    <span class="hljs-attr">token:</span> <span class="hljs-string">"your-admin-token"</span>
    <span class="hljs-attr">org:</span> <span class="hljs-string">"my_org"</span>
    <span class="hljs-attr">bucket:</span> <span class="hljs-string">"go_wind_admin"</span>
</code></pre>
<h5 data-id="heading-25">ï¼ˆ2ï¼‰åˆå§‹åŒ–å®¢æˆ·ç«¯å¹¶ä½¿ç”¨</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
  <span class="hljs-string">"github.com/tx7do/kratos-bootstrap/database/influxdb"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">initInfluxDB</span><span class="hljs-params">(bctx *bootstrap.Context)</span></span> (*influxdb.Client, <span class="hljs-type">error</span>) {
  <span class="hljs-comment">// ä»é…ç½®åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆç±»ä¼¼ Spring Data çš„ Repository è‡ªåŠ¨æ³¨å…¥ï¼‰</span>
  <span class="hljs-keyword">return</span> influxdb.NewClient(bctx.Config.Data.Influxdb)
}

<span class="hljs-comment">// å†™å…¥æ•°æ®ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">writeData</span><span class="hljs-params">(client *influxdb.Client)</span></span> <span class="hljs-type">error</span> {
  point := influxdb.NewPoint(
    <span class="hljs-string">"user_operation"</span>, <span class="hljs-comment">//  measurement å</span>
    <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{<span class="hljs-string">"user_id"</span>: <span class="hljs-string">"123"</span>}, <span class="hljs-comment">// æ ‡ç­¾ï¼ˆç´¢å¼•å­—æ®µï¼‰</span>
    <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{<span class="hljs-string">"action"</span>: <span class="hljs-string">"login"</span>}, <span class="hljs-comment">// å­—æ®µï¼ˆæ•°æ®ï¼‰</span>
    time.Now(), <span class="hljs-comment">// æ—¶é—´æˆ³</span>
  )
  <span class="hljs-keyword">return</span> client.Write(point)
}
</code></pre>
<h3 data-id="heading-26">äº”ã€å‘½ä»¤è¡Œå‚æ•°ï¼šåŠ¨æ€è°ƒæ•´å¯åŠ¨è¡Œä¸ºï¼ˆç±»æ¯” Spring Profilesï¼‰</h3>
<p>kratos-bootstrap æ”¯æŒé€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¦†ç›–é…ç½®ï¼Œç±»ä¼¼ Spring çš„ <code>spring.profiles.active</code> å’Œå‘½ä»¤è¡Œå‚æ•°ï¼Œä¾¿äºåœ¨ä¸åŒç¯å¢ƒå¿«é€Ÿåˆ‡æ¢é…ç½®ã€‚</p>
<h4 data-id="heading-27">å¸¸ç”¨å‚æ•°è¯´æ˜</h4>
<p>å®šä¹‰åœ¨ <code>flag.go</code> ä¸­çš„æ ¸å¿ƒå‚æ•°ï¼š</p>















































<table><thead><tr><th>å‚æ•°å</th><th>ç¼©å†™</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th><th>ç±»æ¯” Spring é…ç½®</th></tr></thead><tbody><tr><td><code>--conf</code></td><td><code>-c</code></td><td><code>../../configs</code></td><td>é…ç½®æ–‡ä»¶ç›®å½•è·¯å¾„</td><td><code>spring.config.location</code></td></tr><tr><td><code>--env</code></td><td><code>-e</code></td><td><code>dev</code></td><td>è¿è¡Œç¯å¢ƒï¼ˆdev/test/prodï¼‰</td><td><code>spring.profiles.active</code></td></tr><tr><td><code>--chost</code></td><td><code>-s</code></td><td><code>127.0.0.1:8500</code></td><td>è¿œç¨‹é…ç½®ä¸­å¿ƒåœ°å€</td><td><code>spring.cloud.nacos.config.server-addr</code></td></tr><tr><td><code>--ctype</code></td><td><code>-t</code></td><td><code>consul</code></td><td>è¿œç¨‹é…ç½®ä¸­å¿ƒç±»å‹ï¼ˆetcd/nacos ç­‰ï¼‰</td><td>æ— ï¼ˆSpring éœ€æ‰‹åŠ¨æŒ‡å®šé…ç½®ç±»å‹ï¼‰</td></tr><tr><td><code>--daemon</code></td><td><code>-d</code></td><td><code>false</code></td><td>æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼è¿è¡Œ</td><td>æ— ï¼ˆéœ€é¢å¤–é…ç½®æœåŠ¡åŒ–ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-28">ä½¿ç”¨ç¤ºä¾‹</h4>
<p>æŒ‡å®šç”Ÿäº§ç¯å¢ƒé…ç½®å¹¶å¯ç”¨ Etcd è¿œç¨‹é…ç½®ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿäº§ç¯å¢ƒå¯åŠ¨ï¼Œé…ç½®æ–‡ä»¶ç›®å½•ä¸º ./configs/prodï¼Œè¿œç¨‹é…ç½®ä¸­å¿ƒä¸º Etcd</span>
go run main.go -e prod -c ./configs/prod -t etcd -s 192.168.1.100:2379
</code></pre>
<h3 data-id="heading-29">å…­ã€æœ€ä½³å®è·µï¼šå€Ÿé‰´ Spring ç”Ÿæ€çš„æˆç†Ÿç»éªŒ</h3>
<p>ç»“åˆ Spring ç”Ÿæ€çš„æœ€ä½³å®è·µï¼Œåœ¨ GoWind Admin ä¸­ä½¿ç”¨ kratos-bootstrap æ—¶å»ºè®®éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<h4 data-id="heading-30">1. ç¯å¢ƒéš”ç¦»ï¼šé…ç½®æŒ‰ç¯å¢ƒæ‹†åˆ†</h4>
<p>ç±»ä¼¼ Spring Profilesï¼Œå°†é…ç½®æŒ‰ç¯å¢ƒï¼ˆdev/test/prodï¼‰æ‹†åˆ†åˆ°ä¸åŒç›®å½•ï¼Œé€šè¿‡ <code>--env</code> å‚æ•°åˆ‡æ¢ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">configs/
  dev/        # å¼€å‘ç¯å¢ƒé…ç½®
    config.yaml
    logger.yaml
  test/       # æµ‹è¯•ç¯å¢ƒé…ç½®
    config.yaml
  prod/       # ç”Ÿäº§ç¯å¢ƒé…ç½®
    config.yaml
</code></pre>
<h4 data-id="heading-31">2. é…ç½®ä¼˜å…ˆçº§ï¼šè¿œç¨‹é…ç½®è¦†ç›–æœ¬åœ°</h4>
<p>éµå¾ªã€Œè¿œç¨‹é…ç½® &gt; å‘½ä»¤è¡Œå‚æ•° &gt; ç¯å¢ƒå˜é‡ &gt; æœ¬åœ°æ–‡ä»¶ã€çš„ä¼˜å…ˆçº§ï¼Œç¡®ä¿çº¿ä¸Šé…ç½®å¯åŠ¨æ€è°ƒæ•´ï¼ˆç±»ä¼¼ Spring Cloud Config çš„é…ç½®ä¼˜å…ˆçº§ï¼‰ã€‚</p>
<h4 data-id="heading-32">3. ç»„ä»¶æŒ‰éœ€åŠ è½½ï¼šé¿å…ä¾èµ–å†—ä½™</h4>
<p>ä»…å¯¼å…¥éœ€è¦çš„ç»„ä»¶é©±åŠ¨ï¼ˆå¦‚æ— éœ€ Consul åˆ™ä¸å¯¼å…¥ <code>_ "github.com/tx7do/kratos-bootstrap/registry/consul"</code>ï¼‰ï¼Œå‡å°‘äºŒè¿›åˆ¶ä½“ç§¯ï¼Œç±»ä¼¼ Spring Boot çš„ã€Œstarter æŒ‰éœ€å¼•å…¥ã€ã€‚</p>
<h4 data-id="heading-33">4. èµ„æºä¼˜é›…é‡Šæ”¾ï¼šåˆ©ç”¨ cleanup å‡½æ•°</h4>
<p>åœ¨ <code>initApp</code> å‡½æ•°ä¸­è¿”å›èµ„æºé‡Šæ”¾é€»è¾‘ï¼Œç¡®ä¿æœåŠ¡é€€å‡ºæ—¶å…³é—­æ•°æ®åº“è¿æ¥ã€æ³¨é”€æœåŠ¡å®ä¾‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">initApp</span><span class="hljs-params">(bctx *bootstrap.Context)</span></span> (*kratos.App, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>, <span class="hljs-type">error</span>) {
  <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®åº“è¿æ¥</span>
  db, err := initDB(bctx)
  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>, err
  }
  
  <span class="hljs-comment">// å®šä¹‰ cleanup å‡½æ•°ï¼ˆç±»ä¼¼ Spring çš„ @PreDestroyï¼‰</span>
  cleanup := <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    db.Close() <span class="hljs-comment">// å…³é—­æ•°æ®åº“è¿æ¥</span>
    log.Println(<span class="hljs-string">"èµ„æºå·²é‡Šæ”¾"</span>)
  }
  
  <span class="hljs-keyword">return</span> app, cleanup, <span class="hljs-literal">nil</span>
}
</code></pre>
<h3 data-id="heading-34">ä¸ƒã€æ€»ç»“ï¼škratos-bootstrap ä¸ Spring ç”Ÿæ€çš„å¼‚æ›²åŒå·¥ä¹‹å¦™</h3>
<p>kratos-bootstrap åœ¨ GoWind Admin ä¸­æ‰®æ¼”çš„è§’è‰²ï¼Œä¸ Spring Boot åœ¨ Java ç”Ÿæ€ä¸­ç±»ä¼¼ï¼šé€šè¿‡æ ‡å‡†åŒ–æµç¨‹ã€è‡ªåŠ¨åŒ–é…ç½®ã€ç»„ä»¶åŒ–é›†æˆï¼Œå¤§å¹…é™ä½å¾®æœåŠ¡å¼€å‘çš„åŸºç¡€è®¾æ–½æˆæœ¬ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ç®€åŒ–å¼€å‘</strong>ï¼šå±è”½é…ç½®åŠ è½½ã€æœåŠ¡æ³¨å†Œç­‰åº•å±‚é€»è¾‘ï¼Œå¼€å‘è€…èšç„¦ä¸šåŠ¡ï¼›</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šæ”¯æŒå¤šæºé…ç½®ã€å¤šæ³¨å†Œä¸­å¿ƒï¼Œé€‚é…ä¸åŒéƒ¨ç½²ç¯å¢ƒï¼›</li>
<li><strong>ç”Ÿæ€å…¼å®¹</strong>ï¼šä¸ Kratos æ¡†æ¶æ·±åº¦èåˆï¼ŒåŒæ—¶å…¼å®¹ä¸»æµä¸­é—´ä»¶ï¼ˆEtcdã€Nacos ç­‰ï¼‰ã€‚</li>
</ul>
<p>é€šè¿‡æœ¬æ–‡çš„è®²è§£ï¼Œå¼€å‘è€…å¯å¿«é€ŸæŒæ¡ kratos-bootstrap çš„ä½¿ç”¨æ–¹å¼ï¼Œå¹¶å€ŸåŠ© Spring ç”Ÿæ€çš„ç»éªŒç†è§£å…¶è®¾è®¡ç†å¿µã€‚å¦‚éœ€æ·±å…¥å­¦ä¹ ï¼Œå¯å‚è€ƒï¼š</p>
<ul>
<li>kratos-bootstrap æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftx7do%2Fkratos-bootstrap" target="_blank" title="https://github.com/tx7do/kratos-bootstrap" ref="nofollow noopener noreferrer">github.com/tx7do/kratoâ€¦</a></li>
<li>GoWind Admin åˆå§‹åŒ–é€»è¾‘ï¼š<code>app/admin/service/cmd/server</code> ç›®å½•</li>
<li>Kratos å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo-kratos.dev%2Fdocs%2F" target="_blank" title="https://go-kratos.dev/docs/" ref="nofollow noopener noreferrer">go-kratos.dev/docs/</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOS6 æ¥å…¥åˆ†äº«ï¼ŒåŸæ¥ä¹Ÿæ˜¯ä¸‰åˆ†é’Ÿçš„äº‹æƒ…]]></title>    <link>https://juejin.cn/post/7585600621522698280</link>    <guid>https://juejin.cn/post/7585600621522698280</guid>    <pubDate>2025-12-21T14:12:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585600621522698280" data-draft-id="7585693761532936226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOS6 æ¥å…¥åˆ†äº«ï¼ŒåŸæ¥ä¹Ÿæ˜¯ä¸‰åˆ†é’Ÿçš„äº‹æƒ…"/> <meta itemprop="keywords" content="å‰ç«¯,HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-21T14:12:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‡å°‘"/> <meta itemprop="url" content="https://juejin.cn/user/4441682708283191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOS6 æ¥å…¥åˆ†äº«ï¼ŒåŸæ¥ä¹Ÿæ˜¯ä¸‰åˆ†é’Ÿçš„äº‹æƒ…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4441682708283191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‡å°‘
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.5 å¦‚é±¼å¾—æ°´
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.5 å¦‚é±¼å¾—æ°´" title="VIP.5 å¦‚é±¼å¾—æ°´" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:12:22.000Z" title="Sun Dec 21 2025 14:12:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">HarmonyOS6 æ¥å…¥åˆ†äº«ï¼ŒåŸæ¥ä¹Ÿæ˜¯ä¸‰åˆ†é’Ÿçš„äº‹æƒ…</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>æœ€è¿‘æ‰“ç®—ç»™å‡†å¤‡å¼€å‘çš„åº”ç”¨æ¥å…¥åˆ†äº«åŠŸèƒ½ï¼Œè€ƒè™‘åˆ°æ¨¡æ¿å¸‚åœºä¸Šå·²ç»æœ‰ç°æˆçš„æ¨¡ç‰ˆäº†ï¼Œç„¶åç»“åˆAIæ¥æ¥å…¥ï¼Œæ¥å…¥èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯3åˆ†é’Ÿçš„äº‹æƒ…ã€‚</p>
<h3 data-id="heading-2">æ–°å»ºå·¥ç¨‹</h3>
<p>å¦‚æœè¿˜æ²¡æœ‰å·¥ç¨‹çš„è¯ï¼Œç›´æ¥æ–°å»ºå·¥ç¨‹ã€åˆ›å»ºé¡¹ç›®</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/657fc801eca04aa6bf5009c996c7396d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=tnU449GQRpFgge5E%2B2fjH9h0Bxc%3D" alt="image-20251221211420491" loading="lazy"/></p>
<h3 data-id="heading-3">ç»„ä»¶å¸‚åœºç›´æ¥æ¥å…¥</h3>
<p>åœ¨devEco Studio ä¸Šçš„ ç»„ä»¶å¸‚åœºä¸Šæœç´¢ï¼Œ<strong>é€šç”¨ç³»ç»Ÿåˆ†äº«</strong>ï¼Œç„¶åç›´æ¥ä¸‹è½½åˆ°é¡¹ç›®ä¸­å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7db020bab8594e469a28eabac6103f65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=yCZDhoyjn2%2Bu3D0GB5EwTPnaMIo%3D" alt="image-20251221211738225" loading="lazy"/></p>
<p>æˆåŠŸåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥å’Œæ„å»ºï¼Œè¿™ä¸ªæ—¶å€™ä¼šæç¤ºæ–‡ä»¶æ‰¾ä¸åˆ° Â <strong>build-profile.json5</strong>ï¼Œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81bc42dee530403fb0806df26352368a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=K1tSXqSVOKo8vUuG6Dv%2FsDJKqAc%3D" alt="image-20251221212416142" loading="lazy"/></p>
<p>è¿™ä¸ªæ—¶å€™æ‰‹åŠ¨åˆ é™¤é…ç½®å³å¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b1ac0526adb48b6a73c2336997489ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=F7aMGQyuKcE0ztF98joTNmDKtmU%3D" alt="image-20251221212502217" loading="lazy"/></p>
<h3 data-id="heading-4">AIå·¥å…·ç›´æ¥å¸®ä½ æ¥å…¥</h3>
<p>ç„¶åä½¿ç”¨è‡ªå·±ä¹ æƒ¯çš„AIç¼–è¾‘å™¨æ‰“å¼€å½“å‰å·¥ç¨‹ï¼Œä¸‡å°‘è¿™è¾¹ä½¿ç”¨çš„æ˜¯Â <strong>Trae æµ·å¤–ç‰ˆ + Gemini-3-pro æ¨¡å‹</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af09ea4e9ff64ef1af58cce773880a23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=KvRXvXqGwFKPHs6P7Q5q2Qh%2Byls%3D" alt="image-20251221212707611" loading="lazy"/></p>
<p>ä½ ç‚¹å‡»åˆšæ‰ç»„ä»¶å¸‚åœºå†…çš„é€šç”¨åˆ†äº«ç»„ä»¶çš„å®˜ç½‘é“¾æ¥ï¼Œå¤åˆ¶è¿™ä¸ªç½‘å€ã€‚</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fmarket%2Fprod-detail%2Fcbc8bb4edde94e9097f366233bf2cfd5%2F2adce9bbd4cb42d58a87e6add45594b3" target="_blank" title="https://developer.huawei.com/consumer/cn/market/prod-detail/cbc8bb4edde94e9097f366233bf2cfd5/2adce9bbd4cb42d58a87e6add45594b3" ref="nofollow noopener noreferrer">developer.huawei.com/consumer/cnâ€¦</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43802f24f5e144259f964b615fc296c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=cW3GwjSXQsmuOmAxxi8QQaq4cOo%3D" alt="image-20251221212813537" loading="lazy"/></p>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4b5aa9698eb4286aa03557ae853c9b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=mKNlhlQFtpVuf%2FEAmoD2n%2Fcey6Y%3D" alt="image-20251221212838563" loading="lazy"/></p>
<p>æœ€åï¼Œä½¿ç”¨<strong>è€å¥¶å¥¶</strong>ä¹Ÿèƒ½å¬æ‡‚çš„è‡ªç„¶è¯­è¨€å¸®ä½ çš„AIç¼–è¾‘å™¨å¸®ä½ æ¥å…¥å³å¯ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b72666550446436789f0579fff8769cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=TqKhXJl2sPrR1b9FcE2RKFBDJPc%3D" alt="image-20251221212951496" loading="lazy"/></p>
<h3 data-id="heading-5">æœ€åæ•ˆæœ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fef8ca23b5644e9854f8e6b0c722ae4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766931141&amp;x-signature=%2BhtYVzPZl1xp%2BcQj6ngVKcwBb8M%3D" alt="image-20251221213721538" loading="lazy"/></p>
<h3 data-id="heading-6">æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>å¦‚æœéœ€è¦æ¥å—æ¯”å¦‚åˆ†äº«åˆ°QQååˆ°å›è°ƒ</li>
<li>æˆ–è€…éœ€è¦é…ç½®å¾®åšåˆ†äº«</li>
</ol>
<p>éƒ½éœ€è¦ä»”ç»†æŸ¥çœ‹ç»„ä»¶å®˜ç½‘çš„æè¿°</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fmarket%2Fprod-detail%2Fcbc8bb4edde94e9097f366233bf2cfd5%2F2adce9bbd4cb42d58a87e6add45594b3" target="_blank" title="https://developer.huawei.com/consumer/cn/market/prod-detail/cbc8bb4edde94e9097f366233bf2cfd5/2adce9bbd4cb42d58a87e6add45594b3" ref="nofollow noopener noreferrer">developer.huawei.com/consumer/cnâ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251215-251219ï¼‰]]></title>    <link>https://juejin.cn/post/7585743487259148297</link>    <guid>https://juejin.cn/post/7585743487259148297</guid>    <pubDate>2025-12-21T14:21:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487259148297" data-draft-id="7585798113546747954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251215-251219ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-21T14:21:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ"/> <meta itemprop="url" content="https://juejin.cn/user/2831954919569245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251215-251219ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2831954919569245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:21:24.000Z" title="Sun Dec 21 2025 14:21:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Kling-Omni Technical Report</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.16776" target="_blank" title="https://arxiv.org/abs/2512.16776" ref="nofollow noopener noreferrer">Kling-Omni æŠ€æœ¯æŠ¥å‘Š</a></p>
<p>æˆ‘ä»¬æå‡ºäº† Kling-Omniï¼Œä¸€ä¸ªé€šç”¨çš„ç”Ÿæˆå¼æ¡†æ¶ï¼Œæ—¨åœ¨ç›´æ¥ä»å¤šæ¨¡æ€è§†è§‰è¯­è¨€è¾“å…¥åˆæˆé«˜ä¿çœŸè§†é¢‘ã€‚åŸºäºç«¯åˆ°ç«¯çš„è®¾è®¡ç†å¿µï¼ŒKling-Omni æ‰“ç ´äº†å¤šæ ·åŒ–è§†é¢‘ç”Ÿæˆã€ç¼–è¾‘å’Œæ™ºèƒ½æ¨ç†ä»»åŠ¡ä¹‹é—´çš„åŠŸèƒ½å£å’ï¼Œå°†å…¶æ•´åˆä¸ºä¸€ä¸ªç»Ÿä¸€çš„æ•´ä½“ç³»ç»Ÿã€‚ä¸å‰²è£‚çš„æµæ°´çº¿æ–¹æ³•ä¸åŒï¼ŒKling-Omni æ”¯æŒå¤šç§ç”¨æˆ·è¾“å…¥ï¼ŒåŒ…æ‹¬æ–‡æœ¬æŒ‡ä»¤ã€å‚è€ƒå›¾åƒå’Œè§†é¢‘ä¸Šä¸‹æ–‡ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºç»Ÿä¸€çš„å¤šæ¨¡æ€è¡¨ç¤ºï¼Œä»è€Œå®ç°ç”µå½±çº§ç”»è´¨å’Œé«˜åº¦æ™ºèƒ½çš„è§†é¢‘å†…å®¹åˆ›ä½œã€‚ä¸ºäº†æ”¯æ’‘è¿™äº›èƒ½åŠ›ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå…¨é¢çš„æ•°æ®ç³»ç»Ÿï¼Œä½œä¸ºå¤šæ¨¡æ€è§†é¢‘åˆ›ä½œçš„åŸºç¡€ã€‚è¯¥æ¡†æ¶è¿˜é€šè¿‡é«˜æ•ˆçš„å¤§è§„æ¨¡é¢„è®­ç»ƒç­–ç•¥å’Œä¼˜åŒ–çš„æ¨ç†åŸºç¡€è®¾æ–½å¾—åˆ°è¿›ä¸€æ­¥å¼ºåŒ–ã€‚å…¨é¢çš„è¯„ä¼°è¡¨æ˜ï¼ŒKling-Omni åœ¨ä¸Šä¸‹æ–‡ç”Ÿæˆã€åŸºäºæ¨ç†çš„ç¼–è¾‘ä»¥åŠå¤šæ¨¡æ€æŒ‡ä»¤éµå¾ªæ–¹é¢å±•ç°å‡ºå“è¶Šçš„æ€§èƒ½ã€‚Kling-Omni ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå†…å®¹åˆ›ä½œå·¥å…·ï¼Œæˆ‘ä»¬ç›¸ä¿¡å®ƒæ˜¯è¿ˆå‘èƒ½å¤Ÿæ„ŸçŸ¥ã€æ¨ç†ã€ç”Ÿæˆå¹¶ä¸åŠ¨æ€å¤æ‚ä¸–ç•Œäº¤äº’çš„å¤šæ¨¡æ€ä¸–ç•Œæ¨¡æ‹Ÿå™¨çš„å…³é”®è¿›å±•ã€‚</p>
<h2 data-id="heading-1">Step-GUI Technical Report</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.15431" target="_blank" title="https://arxiv.org/abs/2512.15431" ref="nofollow noopener noreferrer">Step-GUI æŠ€æœ¯æŠ¥å‘Š</a></p>
<p>å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (Multimodal Large Language Model) çš„æœ€æ–°è¿›å±•ä¸ºå›¾å½¢ç”¨æˆ·ç•Œé¢ (GUI) è‡ªåŠ¨åŒ–å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„æœºé‡ã€‚ç„¶è€Œï¼Œä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ä¾ç„¶å­˜åœ¨ï¼šå¦‚ä½•åœ¨ä¿è¯æ ‡æ³¨å¯é æ€§çš„å‰æä¸‹ï¼Œé«˜æ•ˆè·å–é«˜è´¨é‡çš„è®­ç»ƒæ•°æ®ï¼Ÿæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç”±æ ¡å‡†æ­¥éª¤å¥–åŠ±ç³»ç»Ÿ (Calibrated Step Reward System) é©±åŠ¨çš„è‡ªæ¼”è¿›è®­ç»ƒæµæ°´çº¿ã€‚è¯¥æµæ°´çº¿é€šè¿‡è½¨è¿¹çº§æ ¡å‡†ï¼Œå°†æ¨¡å‹ç”Ÿæˆçš„æ“ä½œåºåˆ—è½¬åŒ–ä¸ºå¯é çš„è®­ç»ƒä¿¡å·ï¼Œä»è€Œä»¥é™ä½ 10 è‡³ 100 å€çš„æˆæœ¬å®ç°äº†è¶…è¿‡ 90% çš„æ ‡æ³¨å‡†ç¡®ç‡ã€‚åŸºäºæ­¤æµæ°´çº¿ï¼Œæˆ‘ä»¬æ¨å‡ºäº† Step-GUI æ¨¡å‹ç³»åˆ— (4B/8B å‚æ•°)ã€‚è¯¥ç³»åˆ—æ¨¡å‹åœ¨ä¿æŒå¼ºå¤§é€šç”¨èƒ½åŠ›çš„åŒæ—¶ï¼Œå®ç°äº†ä¸šç•Œé¢†å…ˆçš„ GUI æ€§èƒ½ (8B æ¨¡å‹: AndroidWorld 80.2%, OSWorld 48.5%, ScreenShot-Pro 62.6%)ã€‚éšç€ GUI æ™ºèƒ½ä½“èƒ½åŠ›çš„å¢å¼ºï¼Œå®é™…éƒ¨ç½²è¦æ±‚èƒ½åœ¨å¼‚æ„è®¾å¤‡é—´æä¾›æ ‡å‡†åŒ–æ¥å£ï¼Œå¹¶ä¿æŠ¤ç”¨æˆ·éšç§ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† GUI-MCPï¼Œè¿™æ˜¯é¦–ä¸ªä¸“ä¸º GUI è‡ªåŠ¨åŒ–è®¾è®¡çš„æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (Model Context Protocol)ã€‚å®ƒé‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œç»“åˆäº†åº•å±‚çš„åŸå­æ“ä½œä¸å°†é«˜å±‚ä»»åŠ¡å§”æ´¾ç»™æœ¬åœ°ä¸“å®¶æ¨¡å‹çš„èƒ½åŠ›ï¼Œä»è€Œå®ç°äº†é«˜éšç§ä¿æŠ¤æ‰§è¡Œâ€”â€”æ•æ„Ÿæ•°æ®å…¨ç¨‹ä¿ç•™åœ¨è®¾å¤‡æœ¬åœ°ã€‚æœ€åï¼Œä¸ºäº†è¯„ä¼°æ™ºèƒ½ä½“å¤„ç†çœŸå®æ—¥å¸¸ä½¿ç”¨åœºæ™¯çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¼•å…¥äº† AndroidDaily åŸºå‡†æµ‹è¯•ã€‚è¯¥æµ‹è¯•åŸºäºçœŸå®çš„ç§»åŠ¨è®¾å¤‡ä½¿ç”¨æ¨¡å¼æ„å»ºï¼Œæ¶µç›–äº†é«˜é¢‘æ—¥å¸¸åœºæ™¯ï¼ŒåŒ…å« 3146 ä¸ªé™æ€åŠ¨ä½œå’Œ 235 ä¸ªç«¯åˆ°ç«¯ä»»åŠ¡ (8B æ¨¡å‹: é™æ€åŠ¨ä½œå‡†ç¡®ç‡ 89.91%, ç«¯åˆ°ç«¯ä»»åŠ¡æˆåŠŸç‡ 52.50%)ã€‚æˆ‘ä»¬çš„å·¥ä½œæ¨åŠ¨äº†å®ç”¨å‹ GUI æ™ºèƒ½ä½“çš„å‘å±•ï¼Œå¹¶å±•ç°äº†å…¶åœ¨æ—¥å¸¸æ•°å­—äº¤äº’ä¸­è¿›è¡Œå®é™…éƒ¨ç½²çš„å·¨å¤§æ½œåŠ›ã€‚</p>
<h2 data-id="heading-2">MMGR: Multi-Modal Generative Reasoning</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.14691" target="_blank" title="https://arxiv.org/abs/2512.14691" ref="nofollow noopener noreferrer">MMGR: å¤šæ¨¡æ€ç”Ÿæˆå¼æ¨ç†</a></p>
<p>è§†é¢‘åŸºç¡€æ¨¡å‹ (Video foundation models) èƒ½å¤Ÿç”Ÿæˆè§†è§‰é€¼çœŸä¸”æ—¶åºè¿è´¯çš„å†…å®¹ï¼Œä½†å…¶ä½œä¸ºä¸–ç•Œæ¨¡æ‹Ÿå™¨ (world simulators) çš„å¯é æ€§ï¼Œå–å†³äºå®ƒä»¬æ˜¯å¦æ•æ‰åˆ°äº†ç‰©ç†ã€é€»è¾‘å’Œç©ºé—´çº¦æŸã€‚ç°æœ‰æŒ‡æ ‡ï¼Œå¦‚å¼—é›·æ­‡è§†é¢‘è·ç¦» (Frechet Video Distance, FVD)ï¼Œä¾§é‡äºæ„ŸçŸ¥è´¨é‡ï¼Œå´å¿½ç•¥äº†æ¨ç†é”™è¯¯ (reasoning failures)ï¼ŒåŒ…æ‹¬å¯¹å› æœå…³ç³»ã€ç‰©ç†å®šå¾‹å’Œå…¨å±€ä¸€è‡´æ€§çš„è¿èƒŒã€‚æˆ‘ä»¬æå‡ºäº† MMGR (å¤šæ¨¡æ€ç”Ÿæˆå¼æ¨ç†è¯„ä¼°ä¸åŸºå‡†ï¼ŒMulti-Modal Generative Reasoning Evaluation and Benchmark)ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºäº”ç§æ¨ç†èƒ½åŠ›çš„ç³»ç»Ÿæ€§è¯„ä¼°æ¡†æ¶ï¼šç‰©ç†æ¨ç†ã€é€»è¾‘æ¨ç†ã€3D ç©ºé—´æ¨ç†ã€2D ç©ºé—´æ¨ç†å’Œæ—¶åºæ¨ç†ã€‚MMGR åœ¨ä¸‰ä¸ªé¢†åŸŸè¯„ä¼°ç”Ÿæˆå¼æ¨ç† (Generative Reasoning)ï¼šæŠ½è±¡æ¨ç† (Abstract Reasoningï¼ŒåŒ…æ‹¬ ARC-AGI å’Œæ•°ç‹¬)ã€å…·èº«å¯¼èˆª (Embodied Navigationï¼ŒåŒ…æ‹¬çœŸå®ä¸–ç•Œçš„ 3D å¯¼èˆªä¸å®šä½) ä»¥åŠç‰©ç†å¸¸è¯† (Physical Commonsenseï¼ŒåŒ…æ‹¬è¿åŠ¨å’Œç»„åˆäº¤äº’)ã€‚MMGR é‡‡ç”¨ç»†ç²’åº¦æŒ‡æ ‡ï¼Œè¦æ±‚è§†é¢‘å’Œå›¾åƒç”Ÿæˆå…·å¤‡æ•´ä½“æ­£ç¡®æ€§ã€‚æˆ‘ä»¬å¯¹é¢†å…ˆçš„è§†é¢‘æ¨¡å‹ (Veo-3, Sora-2, Wan-2.2) å’Œå›¾åƒæ¨¡å‹ (Nano-banana, Nano-banana Pro, GPT-4o-image, Qwen-image) è¿›è¡Œäº†åŸºå‡†æµ‹è¯•ï¼Œç»“æœæ­ç¤ºäº†è·¨é¢†åŸŸçš„æ˜¾è‘—æ€§èƒ½å·®è·ã€‚æ¨¡å‹åœ¨ç‰©ç†å¸¸è¯†ä»»åŠ¡ä¸Šå–å¾—äº†ä¸­ç­‰æˆåŠŸï¼Œä½†åœ¨æŠ½è±¡æ¨ç†ä¸Šè¡¨ç°ä¸ä½³ (åœ¨ ARC-AGI ä¸Šçš„å‡†ç¡®ç‡ä½äº 10%)ï¼Œå¹¶ä¸”åœ¨å…·èº«ç¯å¢ƒä¸­çš„é•¿æ—¶ç¨‹ç©ºé—´è§„åˆ’æ–¹é¢å­˜åœ¨å›°éš¾ã€‚æˆ‘ä»¬çš„åˆ†ææŒ‡å‡ºäº†å½“å‰æ¨¡å‹çš„å…³é”®å±€é™ï¼ŒåŒ…æ‹¬è¿‡åº¦ä¾èµ–æ„ŸçŸ¥æ•°æ®ã€å…¨å±€çŠ¶æ€ä¸€è‡´æ€§è¾ƒå¼±ï¼Œä»¥åŠä¼˜åŒ–ç›®æ ‡æ›´å€¾å‘äºå¥–åŠ±è§†è§‰åˆç†æ€§è€Œéå› æœæ­£ç¡®æ€§ã€‚MMGR æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è¯Šæ–­åŸºå‡†ï¼Œå¹¶ä¸ºå¼€å‘å…·å¤‡æ¨ç†æ„è¯†çš„ç”Ÿæˆå¼ä¸–ç•Œæ¨¡å‹æŒ‡æ˜äº†ä¸€æ¡è·¯å¾„ã€‚</p>
<h2 data-id="heading-3">EgoX: Egocentric Video Generation from a Single Exocentric Video</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.08269" target="_blank" title="https://arxiv.org/abs/2512.08269" ref="nofollow noopener noreferrer">EgoX: ä»å•æ®µç¬¬ä¸‰äººç§°è§†é¢‘ç”Ÿæˆç¬¬ä¸€äººç§°è§†é¢‘</a></p>
<p>ç¬¬ä¸€äººç§°è§†è§’æ„ŸçŸ¥ä½¿äººç±»èƒ½å¤Ÿç›´æ¥ä»è‡ªèº«è§†è§’ä½“éªŒå’Œç†è§£ä¸–ç•Œã€‚å°†ç¬¬ä¸‰äººç§°è§†è§’è§†é¢‘è½¬æ¢ä¸ºç¬¬ä¸€äººç§°è§†è§’è§†é¢‘ï¼Œä¸ºæ²‰æµ¸å¼ç†è§£å¼€è¾Ÿäº†æ–°é€”å¾„ã€‚ç„¶è€Œï¼Œç”±äºç›¸æœºå§¿æ€å˜åŒ–å‰§çƒˆä¸”è§†å›¾é‡å åŒºåŸŸæå°ï¼Œè¯¥ä»»åŠ¡ä»æå…·æŒ‘æˆ˜æ€§ã€‚å®ƒè¦æ±‚æ¨¡å‹åœ¨å¿ å®ä¿ç•™å¯è§å†…å®¹çš„åŒæ—¶ï¼Œä»¥å‡ ä½•ä¸€è‡´çš„æ–¹å¼åˆæˆä¸å¯è§åŒºåŸŸã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† EgoXï¼Œä¸€ä¸ªä»å•æ®µç¬¬ä¸‰äººç§°è¾“å…¥è§†é¢‘ç”Ÿæˆç¬¬ä¸€äººç§°è§†é¢‘çš„æ–°æ¡†æ¶ã€‚EgoX é€šè¿‡è½»é‡åŒ–çš„ä½ç§©é€‚é… (LoRA) æŠ€æœ¯ï¼Œåˆ©ç”¨å¤§è§„æ¨¡è§†é¢‘æ‰©æ•£æ¨¡å‹çš„é¢„è®­ç»ƒæ—¶ç©ºçŸ¥è¯†ï¼Œå¹¶å¼•å…¥äº†ä¸€ç§ç»Ÿä¸€çš„è°ƒèŠ‚ç­–ç•¥ã€‚è¯¥ç­–ç•¥é€šè¿‡æ²¿å®½åº¦å’Œé€šé“ç»´åº¦æ‹¼æ¥çš„æ–¹å¼ï¼Œèåˆäº†ç¬¬ä¸‰äººç§°ä¸ç¬¬ä¸€äººç§°è§†è§’å…ˆéªŒã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§å‡ ä½•å¼•å¯¼çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œèƒ½å¤Ÿé€‰æ‹©æ€§åœ°å…³æ³¨ç©ºé—´ç›¸å…³åŒºåŸŸï¼Œä»è€Œç¡®ä¿äº†å‡ ä½•ä¸€è‡´æ€§å¹¶å®ç°äº†é«˜è§†è§‰ä¿çœŸåº¦ã€‚æˆ‘ä»¬çš„æ–¹æ³•èƒ½å¤Ÿç”Ÿæˆè¿è´¯ä¸”é€¼çœŸçš„ç¬¬ä¸€äººç§°è§†è§’è§†é¢‘ï¼Œå¹¶åœ¨æœªè§è¿‡çš„åŠçœŸå®åœºæ™¯è§†é¢‘ä¸Šè¡¨ç°å‡ºäº†è‰¯å¥½çš„å¯æ‰©å±•æ€§ä¸é²æ£’æ€§ã€‚</p>
<h2 data-id="heading-4">Memory in the Age of AI Agents</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13564" target="_blank" title="https://arxiv.org/abs/2512.13564" ref="nofollow noopener noreferrer">AI æ™ºèƒ½ä½“æ—¶ä»£çš„è®°å¿†</a></p>
<p>è®°å¿†å·²æˆä¸ºåŸºäºåŸºç¡€æ¨¡å‹çš„æ™ºèƒ½ä½“çš„ä¸€é¡¹æ ¸å¿ƒèƒ½åŠ›ï¼Œå¹¶ä¸”è¿™ä¸€åœ°ä½å°†æŒç»­ä¿æŒã€‚éšç€æ™ºèƒ½ä½“è®°å¿†ç ”ç©¶çš„è¿…é€Ÿæ‰©å±•å¹¶å¸å¼•å‰æ‰€æœªæœ‰çš„å…³æ³¨ï¼Œè¯¥é¢†åŸŸä¹Ÿæ—¥ç›Šå‘ˆç°å‡ºç¢ç‰‡åŒ–è¶‹åŠ¿ã€‚ç°æœ‰å…³äºæ™ºèƒ½ä½“è®°å¿†çš„ç ”ç©¶ï¼Œå…¶åŠ¨æœºã€å®ç°æ–¹å¼å’Œè¯„ä¼°åè®®å¾€å¾€å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼Œè€Œå®šä¹‰æ¾æ•£çš„è®°å¿†æœ¯è¯­çš„æ¿€å¢è¿›ä¸€æ­¥åŠ å‰§äº†æ¦‚å¿µä¸Šçš„æ¨¡ç³Šæ€§ã€‚è¯¸å¦‚é•¿/çŸ­æœŸè®°å¿†ä¹‹ç±»çš„ä¼ ç»Ÿåˆ†ç±»æ³•å·²è¢«è¯æ˜ä¸è¶³ä»¥æ¶µç›–å½“ä»£æ™ºèƒ½ä½“è®°å¿†ç³»ç»Ÿçš„å¤šæ ·æ€§ã€‚æœ¬æ–‡æ—¨åœ¨å‹¾å‹’å½“å‰æ™ºèƒ½ä½“è®°å¿†ç ”ç©¶çš„æœ€æ–°å…¨æ™¯ã€‚æˆ‘ä»¬é¦–å…ˆæ˜ç¡®ç•Œå®šæ™ºèƒ½ä½“è®°å¿†çš„èŒƒç•´ï¼Œå¹¶å°†å…¶ä¸å¤§è¯­è¨€æ¨¡å‹è®°å¿†ã€æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG) ä»¥åŠä¸Šä¸‹æ–‡å·¥ç¨‹ç­‰ç›¸å…³æ¦‚å¿µåŒºåˆ†å¼€æ¥ã€‚æ¥ç€ï¼Œæˆ‘ä»¬é€šè¿‡å½¢å¼ã€åŠŸèƒ½å’ŒåŠ¨æ€è¿™ä¸‰ä¸ªç»Ÿä¸€çš„è§†è§’æ¥å®¡è§†æ™ºèƒ½ä½“è®°å¿†ã€‚ä»å½¢å¼è§†è§’ï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºæ™ºèƒ½ä½“è®°å¿†çš„ä¸‰ç§ä¸»è¦å®ç°æ–¹å¼ï¼šToken çº§è®°å¿†ã€å‚æ•°åŒ–è®°å¿†å’Œæ½œåœ¨è®°å¿†ã€‚ä»åŠŸèƒ½è§†è§’ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ›´ç»†ç²’åº¦çš„åˆ†ç±»æ³•ï¼ŒåŒºåˆ†äº‹å®æ€§è®°å¿†ã€ç»éªŒæ€§è®°å¿†å’Œå·¥ä½œè®°å¿†ã€‚ä»åŠ¨æ€è§†è§’ï¼Œæˆ‘ä»¬åˆ†æäº†è®°å¿†å¦‚ä½•éšæ—¶é—´å½¢æˆã€æ¼”åŒ–ä¸æ£€ç´¢ã€‚ä¸ºæ”¯æŒå®é™…å¼€å‘ï¼Œæˆ‘ä»¬æ±‡ç¼–äº†å…³äºè®°å¿†åŸºå‡†æµ‹è¯•å’Œå¼€æºæ¡†æ¶çš„å…¨é¢æ€»ç»“ã€‚åœ¨æ•´åˆç°æœ‰æˆæœä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜é˜è¿°äº†å¯¹æ–°å…´ç ”ç©¶å‰æ²¿çš„å‰ç»æ€§çœ‹æ³•ï¼ŒåŒ…æ‹¬è®°å¿†è‡ªåŠ¨åŒ–ã€å¼ºåŒ–å­¦ä¹ é›†æˆã€å¤šæ¨¡æ€è®°å¿†ã€å¤šæ™ºèƒ½ä½“è®°å¿†ä»¥åŠå¯ä¿¡åº¦é—®é¢˜ã€‚æˆ‘ä»¬å¸Œæœ›æœ¬ç»¼è¿°ä¸ä»…èƒ½ä½œä¸ºç°æœ‰ç ”ç©¶çš„å‚è€ƒï¼Œæ›´èƒ½ä¸ºå°†è®°å¿†é‡æ–°æ€è€ƒä¸ºæœªæ¥æ™ºèƒ½ä½“æ™ºèƒ½è®¾è®¡ä¸­çš„ä¸€ç­‰åŸè¯­æä¾›æ¦‚å¿µåŸºç¡€ã€‚</p>
<h2 data-id="heading-5">QwenLong-L1.5: Post-Training Recipe for Long-Context Reasoning and Memory Management</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.12967" target="_blank" title="https://arxiv.org/abs/2512.12967" ref="nofollow noopener noreferrer">QwenLong-L1.5: é¢å‘é•¿ä¸Šä¸‹æ–‡æ¨ç†ä¸è®°å¿†ç®¡ç†çš„åè®­ç»ƒæ–¹æ¡ˆ</a></p>
<p>æˆ‘ä»¬æ¨å‡º QwenLong-L1.5ï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡ç³»ç»Ÿæ€§åè®­ç»ƒåˆ›æ–°å®ç°å“è¶Šé•¿ä¸Šä¸‹æ–‡æ¨ç†èƒ½åŠ›çš„æ¨¡å‹ã€‚QwenLong-L1.5 çš„å…³é”®æŠ€æœ¯çªç ´å¦‚ä¸‹ï¼š(1) é•¿ä¸Šä¸‹æ–‡æ•°æ®åˆæˆæµæ°´çº¿ï¼šæˆ‘ä»¬å¼€å‘äº†ä¸€å¥—ç³»ç»Ÿæ€§çš„åˆæˆæ¡†æ¶ï¼Œç”¨äºç”Ÿæˆéœ€è¦åŸºäºå…¨å±€åˆ†æ•£è¯æ®è¿›è¡Œå¤šè·³å…³è”çš„æŒ‘æˆ˜æ€§æ¨ç†ä»»åŠ¡ã€‚é€šè¿‡å°†æ–‡æ¡£è§£æ„ä¸ºåŸå­äº‹å®åŠå…¶åº•å±‚å…³ç³»ï¼Œå¹¶ä»¥ç¼–ç¨‹æ–¹å¼æ„å»ºå¯éªŒè¯çš„æ¨ç†é—®é¢˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•èƒ½å¤Ÿå¤§è§„æ¨¡ç”Ÿæˆé«˜è´¨é‡è®­ç»ƒæ•°æ®ï¼Œä»è€Œå®ç°äº†ä»ç®€å•æ£€ç´¢ä»»åŠ¡åˆ°çœŸæ­£é•¿ç¨‹æ¨ç†èƒ½åŠ›çš„å®è´¨æ€§è·¨è¶Šã€‚(2) é¢å‘é•¿ä¸Šä¸‹æ–‡è®­ç»ƒçš„ç¨³å®šå¼ºåŒ–å­¦ä¹ ï¼šä¸ºå…‹æœé•¿ä¸Šä¸‹æ–‡å¼ºåŒ–å­¦ä¹  (RL) ä¸­çš„æ ¸å¿ƒä¸ç¨³å®šæ€§ï¼Œæˆ‘ä»¬å¼•å…¥äº†ç»“åˆä»»åŠ¡ç‰¹å®šä¼˜åŠ¿ä¼°è®¡çš„ä»»åŠ¡å¹³è¡¡é‡‡æ ·ä»¥ç¼“è§£å¥–åŠ±åå·®ï¼Œå¹¶æå‡ºäº†è‡ªé€‚åº”ç†µæ§åˆ¶ç­–ç•¥ä¼˜åŒ– (AEPO)ï¼ŒåŠ¨æ€è°ƒèŠ‚æ¢ç´¢ä¸åˆ©ç”¨ä¹‹é—´çš„æƒè¡¡ã€‚(3) é¢å‘è¶…é•¿ä¸Šä¸‹æ–‡çš„è®°å¿†å¢å¼ºæ¶æ„ï¼šæˆ‘ä»¬è®¤è¯†åˆ°ï¼Œå³ä½¿æ‰©å±•çš„ä¸Šä¸‹æ–‡çª—å£ä¹Ÿæ— æ³•å®¹çº³ä»»æ„é•¿çš„åºåˆ—ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªåŒ…å«å¤šé˜¶æ®µèåˆå¼ºåŒ–å­¦ä¹ è®­ç»ƒçš„è®°å¿†ç®¡ç†æ¡†æ¶ï¼Œè¯¥æ¡†æ¶å°†å•æ¬¡æ¨ç†ä¸åŸºäºè®°å¿†çš„è¿­ä»£å¤„ç†æ— ç¼é›†æˆï¼Œä»¥å¤„ç†è¶…è¿‡ 4M Token çš„ä»»åŠ¡ã€‚åŸºäº Qwen3-30B-A3B-Thinking æ¨¡å‹ï¼ŒQwenLong-L1.5 åœ¨é•¿ä¸Šä¸‹æ–‡æ¨ç†åŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†ä¸ GPT-5 å’Œ Gemini-2.5-Pro ç›¸å½“çš„æ€§èƒ½ï¼Œå¹³å‡è¶…è¶Šå…¶åŸºçº¿ 9.90 åˆ†ã€‚åœ¨è¶…é•¿ä»»åŠ¡ (1M~4M Token) ä¸Šï¼ŒQwenLong-L1.5 çš„è®°å¿†æ™ºèƒ½ä½“æ¡†æ¶ç›¸æ¯”æ™ºèƒ½ä½“åŸºçº¿å®ç°äº† 9.48 åˆ†çš„æ€§èƒ½æå‡ã€‚æ­¤å¤–ï¼Œæ‰€è·å¾—çš„é•¿ä¸Šä¸‹æ–‡æ¨ç†èƒ½åŠ›ä¹Ÿå¸¦æ¥äº†åœ¨ç§‘å­¦æ¨ç†ã€è®°å¿†å·¥å…·ä½¿ç”¨ä»¥åŠæ‰©å±•å¯¹è¯ç­‰é€šç”¨é¢†åŸŸæ€§èƒ½çš„å¢å¼ºã€‚</p>
<h2 data-id="heading-6">Towards Scalable Pre-training of Visual Tokenizers for Generation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13687" target="_blank" title="https://arxiv.org/abs/2512.13687" ref="nofollow noopener noreferrer">é¢å‘ç”Ÿæˆä»»åŠ¡çš„å¯æ‰©å±•è§†è§‰åˆ†è¯å™¨é¢„è®­ç»ƒ</a></p>
<p>è§†è§‰åˆ†è¯å™¨ (ä¾‹å¦‚ï¼ŒVAEs) çš„æ½œåœ¨ç©ºé—´è´¨é‡å¯¹ç°ä»£ç”Ÿæˆæ¨¡å‹è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œæ ‡å‡†çš„åŸºäºé‡å»ºçš„è®­ç»ƒèŒƒå¼æ‰€äº§ç”Ÿçš„æ½œåœ¨ç©ºé—´åå‘äºç¼–ç ä½çº§ä¿¡æ¯ï¼Œè¿™å¯¼è‡´äº†ä¸€ä¸ªåŸºç¡€æ€§ç¼ºé™·ï¼šæ›´é«˜çš„åƒç´ çº§ç²¾åº¦å¹¶ä¸èƒ½å¸¦æ¥æ›´é«˜è´¨é‡çš„ç”Ÿæˆç»“æœã€‚è¿™æ„å‘³ç€ï¼Œå°†å¤§é‡è®¡ç®—èµ„æºæŠ•å…¥åˆ°è§†è§‰åˆ†è¯å™¨é¢„è®­ç»ƒä¸­ï¼Œéš¾ä»¥æœ‰æ•ˆè½¬åŒ–ä¸ºç”Ÿæˆæ€§èƒ½çš„æå‡ã€‚æˆ‘ä»¬å°†æ­¤ç•Œå®šä¸ºâ€œé¢„è®­ç»ƒç¼©æ”¾é—®é¢˜â€ï¼Œå¹¶æŒ‡å‡ºå¿…é¡»åšå‡ºè½¬å˜ï¼šä¸€ä¸ªæ½œåœ¨ç©ºé—´è¦æƒ³å¯¹ç”Ÿæˆä»»åŠ¡æœ‰æ•ˆï¼Œå°±å¿…é¡»èƒ½ç®€æ´åœ°è¡¨å¾é«˜çº§è¯­ä¹‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† VTPï¼Œä¸€ä¸ªç»Ÿä¸€çš„è§†è§‰åˆ†è¯å™¨é¢„è®­ç»ƒæ¡†æ¶ï¼Œç‡å…ˆå¯¹å›¾åƒ-æ–‡æœ¬å¯¹æ¯”æŸå¤±ã€è‡ªç›‘ç£æŸå¤±å’Œé‡å»ºæŸå¤±è¿›è¡Œè”åˆä¼˜åŒ–ã€‚æˆ‘ä»¬çš„å¤§è§„æ¨¡ç ”ç©¶å¾—å‡ºäº†ä¸¤ä¸ªä¸»è¦ç»“è®ºï¼š(1) ç†è§£æ˜¯ç”Ÿæˆçš„å…³é”®é©±åŠ¨åŠ›ï¼›(2) VTP å±•ç°å‡ºä¼˜è¶Šå¾—å¤šçš„ç¼©æ”¾ç‰¹æ€§ï¼Œå…¶ç”Ÿæˆæ€§èƒ½èƒ½éšé¢„è®­ç»ƒæŠ•å…¥çš„è®¡ç®—é‡ã€å‚æ•°é‡å’Œæ•°æ®é›†å¤§å°è€Œæœ‰æ•ˆæå‡ã€‚ç»è¿‡å¤§è§„æ¨¡é¢„è®­ç»ƒåï¼Œæˆ‘ä»¬çš„åˆ†è¯å™¨å–å¾—äº†å…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½æŒ‡æ ‡ (åœ¨ ImageNet ä¸Šè¾¾åˆ° 78.2 çš„é›¶æ ·æœ¬ç²¾åº¦å’Œ 0.36 çš„ rFID) ï¼Œå¹¶ä¸”åœ¨ç”Ÿæˆä»»åŠ¡ä¸Šçš„æ”¶æ•›é€Ÿåº¦æ¯”å…ˆè¿›çš„è’¸é¦æ–¹æ³•å¿« 4.1 å€ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒå…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼šåœ¨ä¸æ”¹å˜æ ‡å‡† DiT è®­ç»ƒé…ç½®çš„æƒ…å†µä¸‹ï¼Œä»…é€šè¿‡åœ¨é¢„è®­ç»ƒ VTP æ—¶æŠ•å…¥æ›´å¤š FLOPSï¼Œå°±èƒ½ä¸ºä¸‹æ¸¸ç”Ÿæˆä»»åŠ¡å¸¦æ¥ 65.8% çš„ FID æå‡ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿè‡ªç¼–ç å™¨ä»…ä½¿ç”¨å…¶ 1/10 çš„è®¡ç®—é‡æ—¶ï¼Œæ€§èƒ½ä¾¿å·²æ—©æ—©é™·å…¥åœæ»ã€‚æˆ‘ä»¬çš„é¢„è®­ç»ƒæ¨¡å‹å‘å¸ƒäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMiniMax-AI%2FVTP%25E3%2580%2582" target="_blank" title="https://github.com/MiniMax-AI/VTP%E3%80%82" ref="nofollow noopener noreferrer">github.com/MiniMax-AI/â€¦</a></p>
<h2 data-id="heading-7">ReFusion: A Diffusion Large Language Model with Parallel Autoregressive Decoding</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13586" target="_blank" title="https://arxiv.org/abs/2512.13586" ref="nofollow noopener noreferrer">ReFusion: ä¸€ç§å…·æœ‰å¹¶è¡Œè‡ªå›å½’è§£ç èƒ½åŠ›çš„æ‰©æ•£å¤§è¯­è¨€æ¨¡å‹</a></p>
<p>è‡ªå›å½’æ¨¡å‹ (Autoregressive Models, ARMs) å—é™äºå…¶ç¼“æ…¢çš„é¡ºåºæ¨ç†é€Ÿåº¦ã€‚æ©ç æ‰©æ•£æ¨¡å‹ (Masked Diffusion Models, MDMs) è™½æä¾›äº†å¹¶è¡Œçš„æ›¿ä»£æ–¹æ¡ˆï¼Œä½†ä¹Ÿé¢ä¸´ä¸¤ä¸ªå…³é”®ç¼ºé™·ï¼šä¸€æ˜¯å› æ— æ³•ä½¿ç”¨é”®å€¼ (Key-Value, KV) ç¼“å­˜è€Œå¯¼è‡´çš„é«˜è®¡ç®—å¼€é”€ï¼ŒäºŒæ˜¯åœ¨å­¦ä¹ éš¾ä»¥å¤„ç†çš„ Token ç»„åˆç©ºé—´ä¸Šçš„ä¾èµ–å…³ç³»æ—¶ï¼Œä¼šå¯¼è‡´ç”Ÿæˆå†…å®¹ä¸è¿è´¯ã€‚ä¸ºå…‹æœè¿™äº›é™åˆ¶ï¼Œæˆ‘ä»¬æå‡ºäº† ReFusionï¼Œè¿™æ˜¯ä¸€ç§æ–°é¢–çš„æ©ç æ‰©æ•£æ¨¡å‹ã€‚å®ƒé€šè¿‡å°†å¹¶è¡Œè§£ç ä» Token çº§åˆ«æå‡è‡³æ›´é«˜çš„æ§½ä½ (slot) çº§åˆ«ï¼ˆæ¯ä¸ªæ§½ä½æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¿ç»­å­åºåˆ—ï¼‰ï¼Œä»è€Œå®ç°äº†å“è¶Šçš„æ€§èƒ½ä¸æ•ˆç‡ã€‚å…¶æ ¸å¿ƒæ˜¯ä¸€ä¸ªè¿­ä»£çš„â€œè§„åˆ’ä¸å¡«å……â€è§£ç è¿‡ç¨‹ï¼šé¦–å…ˆï¼Œä¸€ä¸ªåŸºäºæ‰©æ•£çš„è§„åˆ’æ­¥éª¤è¯†åˆ«å‡ºä¸€ç»„å¼±ä¾èµ–çš„æ§½ä½ï¼›éšåï¼Œä¸€ä¸ªè‡ªå›å½’å¡«å……æ­¥éª¤å¹¶è¡Œè§£ç è¿™äº›é€‰å®šçš„æ§½ä½ã€‚è¿™ç§åŸºäºæ§½ä½çš„è®¾è®¡å…·æœ‰åŒé‡ä¼˜åŠ¿ï¼šå®ƒé€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å› æœæ¡†æ¶å®ç°äº†å®Œæ•´çš„ KV ç¼“å­˜é‡ç”¨ï¼ŒåŒæ—¶å°†å­¦ä¹ å¤æ‚åº¦ä»å·¨å¤§çš„ Token ç»„åˆç©ºé—´é™ä½åˆ°äº†å¯ç®¡ç†çš„æ§½ä½çº§æ’åˆ—ç©ºé—´ã€‚åœ¨ä¸ƒä¸ªå¤šæ ·åŒ–åŸºå‡†ä¸Šçš„å¹¿æ³›å®éªŒè¡¨æ˜ï¼ŒReFusion ä¸ä»…ä»¥ 34% çš„æ€§èƒ½æå‡å’Œå¹³å‡è¶…è¿‡ 18 å€çš„åŠ é€Ÿæ¯”æ˜¾è‘—è¶…è¶Šäº†å…ˆå‰çš„ MDMsï¼Œè€Œä¸”åœ¨ä¿æŒå¹³å‡ 2.33 å€åŠ é€Ÿæ¯”ä¼˜åŠ¿çš„åŒæ—¶ï¼Œå¼¥åˆäº†ä¸å¼ºå¤§ ARMs ä¹‹é—´çš„æ€§èƒ½å·®è·ã€‚</p>
<h2 data-id="heading-8">Adaptation of Agentic AI</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.16301" target="_blank" title="https://arxiv.org/abs/2512.16301" ref="nofollow noopener noreferrer">æ™ºèƒ½ä½“ AI çš„é€‚é…</a></p>
<p>æœ€å…ˆè¿›çš„æ™ºèƒ½ä½“ AI (Agentic AI) ç³»ç»Ÿæ„å»ºäºåŸºç¡€æ¨¡å‹ä¹‹ä¸Šï¼Œè¿™äº›æ¨¡å‹èƒ½å¤Ÿé€šè¿‡é€‚é…æ¥è¿›è¡Œè§„åˆ’ã€æ¨ç†ï¼Œå¹¶ä¸å¤–éƒ¨å·¥å…·äº¤äº’ï¼Œä»¥æ‰§è¡Œæ—¥ç›Šå¤æ‚å’Œä¸“é—¨åŒ–çš„ä»»åŠ¡ã€‚éšç€æ­¤ç±»ç³»ç»Ÿèƒ½åŠ›å’Œåº”ç”¨èŒƒå›´çš„å¢é•¿ï¼Œé€‚é…å·²æˆä¸ºæå‡å…¶æ€§èƒ½ã€å¯é æ€§å’Œæ³›åŒ–èƒ½åŠ›çš„æ ¸å¿ƒæœºåˆ¶ã€‚æœ¬æ–‡æ—¨åœ¨å°†è¿™ä¸€å¿«é€Ÿå‘å±•çš„ç ”ç©¶é¢†åŸŸç»Ÿä¸€ä¸ºä¸€ä¸ªç³»ç»Ÿæ€§æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åŒæ—¶æ¶µç›–æ™ºèƒ½ä½“é€‚é…ä¸å·¥å…·é€‚é…ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥å°†æ™ºèƒ½ä½“é€‚é…åˆ†è§£ä¸º<strong>å·¥å…·æ‰§è¡Œä¿¡å·è§¦å‘å‹</strong>å’Œ<strong>æ™ºèƒ½ä½“è¾“å‡ºä¿¡å·è§¦å‘å‹</strong>ï¼Œå°†å·¥å…·é€‚é…åˆ†è§£ä¸º<strong>æ™ºèƒ½ä½“æ— å…³å‹</strong>å’Œ<strong>æ™ºèƒ½ä½“ç›‘ç£å‹</strong>ã€‚æˆ‘ä»¬è®ºè¯äº†è¯¥æ¡†æ¶æœ‰åŠ©äºå˜æ¸…æ™ºèƒ½ä½“ AI ä¸­å„ç§é€‚é…ç­–ç•¥çš„è®¾è®¡ç©ºé—´ï¼Œæ˜ç¡®æ­ç¤ºå…¶æƒè¡¡å–èˆï¼Œå¹¶ä¸ºç³»ç»Ÿè®¾è®¡è¿‡ç¨‹ä¸­ç­–ç•¥çš„é€‰æ‹©æˆ–åˆ‡æ¢æä¾›å®è·µæŒ‡å¯¼ã€‚éšåï¼Œæˆ‘ä»¬å›é¡¾äº†å„ç±»åˆ«ä¸­çš„ä»£è¡¨æ€§æ–¹æ³•ï¼Œåˆ†æäº†å…¶ä¼˜åŠ¿ä¸å±€é™ï¼Œå¹¶ç€é‡æŒ‡å‡ºäº†å…³é”®çš„å¼€æ”¾æ€§æŒ‘æˆ˜ä¸æœªæ¥æœºé‡ã€‚æ€»è€Œè¨€ä¹‹ï¼Œæœ¬æ–‡æ—¨åœ¨ä¸ºè‡´åŠ›äºæ„å»ºæ›´å¼ºå¤§ã€é«˜æ•ˆã€å¯é çš„æ™ºèƒ½ä½“ AI ç³»ç»Ÿçš„ç ”ç©¶äººå‘˜ä¸ä»ä¸šè€…ï¼Œæä¾›ä¸€ä¸ªåšå®çš„ç†è®ºåŸºçŸ³å’Œæ¸…æ™°çš„å®è·µè·¯çº¿å›¾ã€‚</p>
<h2 data-id="heading-9">LongVie 2: Multimodal Controllable Ultra-Long Video World Model</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13604" target="_blank" title="https://arxiv.org/abs/2512.13604" ref="nofollow noopener noreferrer">LongVie 2: å¤šæ¨¡æ€å¯æ§è¶…é•¿è§†é¢‘ä¸–ç•Œæ¨¡å‹</a></p>
<p>åœ¨é¢„è®­ç»ƒè§†é¢‘ç”Ÿæˆç³»ç»ŸåŸºç¡€ä¸Šæ„å»ºè§†é¢‘ä¸–ç•Œæ¨¡å‹ï¼Œæ˜¯è¿ˆå‘é€šç”¨æ—¶ç©ºæ™ºèƒ½çš„å…³é”®ä¸”å¯Œæœ‰æŒ‘æˆ˜æ€§çš„ä¸€æ­¥ã€‚ä¸€ä¸ªç†æƒ³çš„ä¸–ç•Œæ¨¡å‹åº”å…·å¤‡ä¸‰ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼šå¯æ§æ€§ã€é•¿æœŸè§†è§‰è´¨é‡ä¸æ—¶é—´ä¸€è‡´æ€§ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§æ¸è¿›å¼ç­–ç•¥ï¼šé¦–å…ˆæå‡å¯æ§æ€§ï¼Œè¿›è€Œæ‰©å±•åˆ°é•¿æœŸã€é«˜è´¨é‡çš„è§†é¢‘ç”Ÿæˆã€‚æœ¬æ–‡æå‡ºäº† LongVie 2ï¼Œè¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„è‡ªå›å½’æ¡†æ¶ï¼Œå…¶è®­ç»ƒåŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š(1) å¤šæ¨¡æ€å¼•å¯¼ï¼Œé€šè¿‡èåˆå¯†é›†ä¸ç¨€ç–çš„æ§åˆ¶ä¿¡å·ï¼Œæä¾›éšå¼çš„ä¸–ç•Œå±‚é¢ç›‘ç£ä»¥å¢å¼ºå¯æ§æ€§ï¼›(2) è¾“å…¥å¸§çš„é€€åŒ–æ„ŸçŸ¥è®­ç»ƒï¼Œæ—¨åœ¨ç¼©å°è®­ç»ƒä¸é•¿æœŸæ¨ç†ä¹‹é—´çš„å·®å¼‚ï¼Œä»è€Œç»´æŒé«˜è§†è§‰è´¨é‡ï¼›(3) å†å²ä¸Šä¸‹æ–‡å¼•å¯¼ï¼Œé€šè¿‡å¯¹é½ç›¸é‚»è§†é¢‘ç‰‡æ®µé—´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥ç¡®ä¿æ—¶é—´ä¸€è‡´æ€§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ¨å‡ºäº† LongVGenBenchï¼Œä¸€ä¸ªåŒ…å« 100 æ®µé«˜åˆ†è¾¨ç‡ã€æ—¶é•¿ä¸€åˆ†é’Ÿè§†é¢‘çš„ç»¼åˆè¯„æµ‹åŸºå‡†ï¼Œæ¶µç›–äº†å¤šæ ·åŒ–çš„çœŸå®ä¸–ç•Œä¸åˆæˆåœºæ™¯ã€‚å¤§é‡å®éªŒè¯æ˜ï¼ŒLongVie 2 åœ¨é•¿ç¨‹å¯æ§æ€§ã€æ—¶é—´è¿è´¯æ€§ä¸è§†è§‰ä¿çœŸåº¦æ–¹é¢å‡è¾¾åˆ°äº†æœ€å…ˆè¿›æ°´å¹³ï¼Œå¹¶èƒ½æ”¯æŒæŒç»­ç”Ÿæˆé•¿è¾¾äº”åˆ†é’Ÿçš„è§†é¢‘ï¼Œè¿™æ ‡å¿—ç€æˆ‘ä»¬åœ¨æ„å»ºç»Ÿä¸€è§†é¢‘ä¸–ç•Œæ¨¡å‹çš„å¾ç¨‹ä¸Šè¿ˆå‡ºäº†åšå®çš„ä¸€æ­¥ã€‚</p>
<h2 data-id="heading-10">WorldPlay: Towards Long-Term Geometric Consistency for Real-Time Interactive World Modeling</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.14614" target="_blank" title="https://arxiv.org/abs/2512.14614" ref="nofollow noopener noreferrer">WorldPlay: é¢å‘å®æ—¶äº¤äº’å¼ä¸–ç•Œå»ºæ¨¡çš„é•¿æœŸå‡ ä½•ä¸€è‡´æ€§</a></p>
<p>æœ¬æ–‡æå‡ºäº† WorldPlayï¼Œè¿™æ˜¯ä¸€ä¸ªæµå¼è§†é¢‘æ‰©æ•£æ¨¡å‹ï¼Œèƒ½å¤Ÿå®ç°å…·æœ‰é•¿æœŸå‡ ä½•ä¸€è‡´æ€§çš„å®æ—¶äº¤äº’å¼ä¸–ç•Œå»ºæ¨¡ï¼Œä»è€Œè§£å†³äº†å½“å‰æ–¹æ³•æ‰€é¢ä¸´çš„é€Ÿåº¦ä¸å†…å­˜ä¹‹é—´çš„æƒè¡¡é—®é¢˜ã€‚WorldPlay åŸºäºä¸‰é¡¹å…³é”®åˆ›æ–°ã€‚1) æˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§åŒé‡åŠ¨ä½œè¡¨ç¤ºï¼Œä»¥å®ç°å¯¹ç”¨æˆ·é”®ç›˜å’Œé¼ æ ‡è¾“å…¥çš„é²æ£’åŠ¨ä½œæ§åˆ¶ã€‚2) ä¸ºäº†ç¡®ä¿é•¿æœŸä¸€è‡´æ€§ï¼Œæˆ‘ä»¬æå‡ºçš„é‡æ„ä¸Šä¸‹æ–‡å†…å­˜èƒ½å¤ŸåŠ¨æ€åœ°ä»å†å²å¸§é‡å»ºä¸Šä¸‹æ–‡ï¼Œå¹¶åˆ©ç”¨æ—¶é—´é‡æ„æŠ€æœ¯ä½¿å‡ ä½•ä¸Šé‡è¦ä½†å†å²ä¹…è¿œçš„å¸§ä¿æŒå¯è®¿é—®æ€§ï¼Œä»è€Œæœ‰æ•ˆç¼“è§£äº†å†…å­˜è¡°å‡é—®é¢˜ã€‚3) æˆ‘ä»¬è¿˜æå‡ºäº†ä¸Šä¸‹æ–‡å¼ºåˆ¶ï¼Œè¿™æ˜¯ä¸€ç§ä¸“ä¸ºå†…å­˜æ„ŸçŸ¥æ¨¡å‹è®¾è®¡çš„æ–°å‹è’¸é¦æ–¹æ³•ã€‚é€šè¿‡å¯¹é½æ•™å¸ˆæ¨¡å‹ä¸å­¦ç”Ÿæ¨¡å‹ä¹‹é—´çš„å†…å­˜ä¸Šä¸‹æ–‡ï¼Œè¯¥æ–¹æ³•ä¿ç•™äº†å­¦ç”Ÿæ¨¡å‹åˆ©ç”¨é•¿ç¨‹ä¿¡æ¯çš„èƒ½åŠ›ï¼Œåœ¨å®ç°å®æ—¶ç”Ÿæˆé€Ÿåº¦çš„åŒæ—¶ï¼Œé˜²æ­¢äº†è¯¯å·®æ¼‚ç§»ã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒWorldPlay èƒ½å¤Ÿä»¥ 24 FPS çš„å¸§ç‡å®æ—¶ç”Ÿæˆé•¿åºåˆ—çš„ 720p æµå¼è§†é¢‘ï¼Œå…·æœ‰å“è¶Šçš„ä¸€è‡´æ€§ï¼Œå…¶æ€§èƒ½ä¼˜äºç°æœ‰æŠ€æœ¯ï¼Œå¹¶åœ¨å¤šæ ·åŒ–çš„åœºæ™¯ä¸­è¡¨ç°å‡ºå¼ºå¤§çš„æ³›åŒ–èƒ½åŠ›ã€‚é¡¹ç›®é¡µé¢ä¸åœ¨çº¿æ¼”ç¤ºè¯·è®¿é—®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2F3d-models.hunyuan.tencent.com%2Fworld%2F" target="_blank" title="https://3d-models.hunyuan.tencent.com/world/" ref="nofollow noopener noreferrer">3d-models.hunyuan.tencent.com/world/</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2F3d.hunyuan.tencent.com%2FsceneTo3D%25E3%2580%2582" target="_blank" title="https://3d.hunyuan.tencent.com/sceneTo3D%E3%80%82" ref="nofollow noopener noreferrer">3d.hunyuan.tencent.com/sceneTo3Dã€‚</a></p>
<h2 data-id="heading-11">Video Reality Test: Can AI-Generated ASMR Videos fool VLMs and Humans?</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13281" target="_blank" title="https://arxiv.org/abs/2512.13281" ref="nofollow noopener noreferrer">è§†é¢‘çœŸå®æ€§æµ‹è¯•ï¼šAI ç”Ÿæˆçš„ ASMR è§†é¢‘èƒ½æ¬ºéª—è§†è§‰è¯­è¨€æ¨¡å‹å’Œäººç±»å—ï¼Ÿ</a></p>
<p>è§†é¢‘ç”ŸæˆæŠ€æœ¯çš„æœ€æ–°è¿›å±•å·²èƒ½äº§å‡ºæä¸ºç”ŸåŠ¨ã€å¸¸ä¸çœŸå®è§†é¢‘éš¾ä»¥åŒºåˆ†çš„å†…å®¹ï¼Œè¿™ä½¿å¾— AI ç”Ÿæˆè§†é¢‘æ£€æµ‹æˆä¸ºä¸€ä¸ªæ–°å…´çš„ç¤¾ä¼šæŒ‘æˆ˜ã€‚ç°æœ‰çš„ AIGC (AI-Generated Content) æ£€æµ‹åŸºå‡†å¤§å¤šé’ˆå¯¹æ— éŸ³é¢‘è§†é¢‘è¿›è¡Œè¯„ä¼°ï¼Œè¦†ç›–å®½æ³›çš„å™äº‹é¢†åŸŸï¼Œä¸”ä»…ä¾§é‡äºåˆ†ç±»ä»»åŠ¡ã€‚ç„¶è€Œï¼Œå½“å‰æœ€å…ˆè¿›çš„è§†é¢‘ç”Ÿæˆæ¨¡å‹èƒ½å¦åˆ¶ä½œå‡ºæ²‰æµ¸å¼ã€éŸ³ç”»åŒæ­¥çš„è§†é¢‘ï¼Œä»è€Œå¯é åœ°æ¬ºéª—äººç±»å’Œè§†è§‰è¯­è¨€æ¨¡å‹ (Vision-Language Models, VLMs)ï¼Œä»æ˜¯ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é—®é¢˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†è§†é¢‘çœŸå®æ€§æµ‹è¯• (Video Reality Test)ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº ASMR (Autonomous Sensory Meridian Response) æºæ„å»ºçš„è§†é¢‘åŸºå‡†å¥—ä»¶ï¼Œç”¨äºåœ¨å¼ºè§†å¬å…³è”æ¡ä»¶ä¸‹æµ‹è¯•æ„ŸçŸ¥çœŸå®æ€§ï¼Œå…¶ç‰¹ç‚¹åŒ…æ‹¬ä»¥ä¸‹ä¸¤ä¸ªç»´åº¦ï¼š(i) æ²‰æµ¸å¼ ASMR éŸ³è§†é¢‘æºã€‚è¯¥åŸºå‡†åŸºäºç²¾å¿ƒç­›é€‰çš„çœŸå® ASMR è§†é¢‘æ„å»ºï¼Œä¸“æ³¨äºç»†ç²’åº¦çš„åŠ¨ä½œ-ç‰©ä½“äº¤äº’ï¼Œå¹¶åœ¨ç‰©ä½“ã€åŠ¨ä½œå’ŒèƒŒæ™¯æ–¹é¢å…·æœ‰å¤šæ ·æ€§ã€‚(ii) åŒè¡Œè¯„å®¡å¼è¯„ä¼°ã€‚é‡‡ç”¨ä¸€ç§å¯¹æŠ—æ€§çš„åˆ›ä½œè€…-è¯„å®¡è€…åè®®ï¼šè§†é¢‘ç”Ÿæˆæ¨¡å‹æ‰®æ¼”åˆ›ä½œè€…ï¼Œæ—¨åœ¨æ¬ºéª—è¯„å®¡è€…ï¼›è€Œ VLMs åˆ™æ‰®æ¼”è¯„å®¡è€…ï¼Œè‡´åŠ›äºè¯†åˆ«è™šå‡å†…å®¹ã€‚æˆ‘ä»¬çš„å®éªŒç»“æœè¡¨æ˜ï¼šè¡¨ç°æœ€ä½³çš„åˆ›ä½œè€…æ¨¡å‹ Veo3.1-Fast ç”šè‡³èƒ½æˆåŠŸæ¬ºéª—å¤§å¤šæ•° VLM è¯„å®¡è€…ï¼šæœ€å¼ºçš„è¯„å®¡è€…æ¨¡å‹ (Gemini 2.5-Pro) ä»…è¾¾åˆ° 56% çš„å‡†ç¡®ç‡ (éšæœºåŸºçº¿ä¸º 50%)ï¼Œè¿œä½äºäººç±»ä¸“å®¶ 81.25% çš„å‡†ç¡®ç‡ã€‚æ·»åŠ éŸ³é¢‘æœ‰åŠ©äºæå‡çœŸå‡è¾¨åˆ«èƒ½åŠ›ï¼Œä½†è¯¸å¦‚æ°´å°ç­‰è¡¨é¢çº¿ç´¢ä»ä¼šæ˜¾è‘—è¯¯å¯¼æ¨¡å‹ã€‚è¿™äº›å‘ç°ç•Œå®šäº†å½“å‰è§†é¢‘ç”ŸæˆçœŸå®æ€§çš„è¾¹ç•Œï¼Œå¹¶æ­ç¤ºäº† VLMs åœ¨æ„ŸçŸ¥ä¿çœŸåº¦ä¸è§†å¬ä¸€è‡´æ€§æ–¹é¢çš„å±€é™æ€§ã€‚æˆ‘ä»¬çš„ä»£ç å¯åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvideo-reality-test%2Fvideo-reality-test" target="_blank" title="https://github.com/video-reality-test/video-reality-test" ref="nofollow noopener noreferrer">github.com/video-realiâ€¦</a> è·å–ã€‚</p>
<h2 data-id="heading-12">Next-Embedding Prediction Makes Strong Vision Learners</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.16922" target="_blank" title="https://arxiv.org/abs/2512.16922" ref="nofollow noopener noreferrer">ä¸‹ä¸€åµŒå…¥é¢„æµ‹æ„å»ºå¼ºå¤§çš„è§†è§‰å­¦ä¹ æ¨¡å‹</a></p>
<p>å—è‡ªç„¶è¯­è¨€ä¸­ç”Ÿæˆå¼é¢„è®­ç»ƒæˆåŠŸçš„å¯å‘ï¼Œæˆ‘ä»¬æ¢ç©¶åŒæ ·çš„åŸç†èƒ½å¦æ„å»ºå‡ºå¼ºå¤§çš„è‡ªç›‘ç£è§†è§‰å­¦ä¹ æ¨¡å‹ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¸æ˜¯è®­ç»ƒæ¨¡å‹è¾“å‡ºç”¨äºä¸‹æ¸¸ä»»åŠ¡çš„ç‰¹å¾ï¼Œè€Œæ˜¯è®­ç»ƒå…¶ç”ŸæˆåµŒå…¥ (embedding) æ¥ç›´æ¥æ‰§è¡Œé¢„æµ‹ä»»åŠ¡ã€‚æœ¬å·¥ä½œæ¢ç´¢äº†ä»å­¦ä¹ è¡¨å¾ (representation) åˆ°å­¦ä¹ é¢„æµ‹æ¨¡å‹è¿™ä¸€è½¬å˜ã€‚å…·ä½“è€Œè¨€ï¼Œæ¨¡å‹å­¦ä¹ åœ¨ç»™å®šå†å²è¡¥ä¸åµŒå…¥çš„æ¡ä»¶ä¸‹é¢„æµ‹æœªæ¥çš„è¡¥ä¸åµŒå…¥ï¼Œè¯¥æ–¹æ³•ç»“åˆäº†å› æœæ©ç  (causal masking) å’Œåœæ­¢æ¢¯åº¦ (stop gradient)ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºä¸‹ä¸€åµŒå…¥é¢„æµ‹è‡ªå›å½’ (Next-Embedding Predictive Autoregression, NEPA)ã€‚æˆ‘ä»¬è¯æ˜ï¼Œåœ¨ ImageNet-1k ä¸Šä»…ä»¥ä¸‹ä¸€åµŒå…¥é¢„æµ‹ä¸ºå­¦ä¹ ç›®æ ‡é¢„è®­ç»ƒä¸€ä¸ªç®€å•çš„ Transformer æ¨¡å‹å³å¯å–å¾—è‰¯å¥½æ•ˆæœâ€”â€”æ— éœ€åƒç´ é‡å»ºã€ç¦»æ•£ Tokenã€å¯¹æ¯”æŸå¤±æˆ–ä»»ä½•ä»»åŠ¡ç‰¹å®šçš„å¤´éƒ¨ (head)ã€‚è¯¥æ–¹æ¡ˆä¿æŒäº†æ¶æ„çš„ç®€æ´æ€§å’Œå¯æ‰©å±•æ€§ï¼Œæ— éœ€å¼•å…¥é¢å¤–çš„è®¾è®¡å¤æ‚åº¦ã€‚NEPA åœ¨å¤šé¡¹ä»»åŠ¡ä¸Šè¡¨ç°å¼ºåŠ²ï¼šä½¿ç”¨ ViT-B å’Œ ViT-L éª¨å¹²ç½‘ç»œè¿›è¡Œå¾®è°ƒåï¼Œåœ¨ ImageNet-1K ä¸Šåˆ†åˆ«è¾¾åˆ°äº† 83.8% å’Œ 85.3% çš„ top-1 å‡†ç¡®ç‡ï¼Œå¹¶èƒ½æœ‰æ•ˆè¿ç§»è‡³ ADE20K æ•°æ®é›†çš„è¯­ä¹‰åˆ†å‰²ä»»åŠ¡ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼ŒåŸºäºåµŒå…¥çš„ç”Ÿæˆå¼é¢„è®­ç»ƒä¸ºè§†è§‰è‡ªç›‘ç£å­¦ä¹ æä¾›äº†ä¸€ç§ç®€å•ã€å¯æ‰©å±•ä¸”å¯èƒ½æ¨¡æ€æ— å…³ (modality-agnostic) çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-13">LLaDA2.0: Scaling Up Diffusion Language Models to 100B</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.15745" target="_blank" title="https://arxiv.org/abs/2512.15745" ref="nofollow noopener noreferrer">LLaDA2.0: å°†æ‰©æ•£è¯­è¨€æ¨¡å‹è§„æ¨¡æ‰©å±•è‡³ 100B å‚æ•°</a></p>
<p>æœ¬æ–‡æå‡ºäº† LLaDA2.0â€”â€”ä¸€ç³»åˆ—é€šè¿‡ç³»ç»ŸåŒ–è½¬æ¢è‡ªå›å½’ (Auto-Regressive, AR) æ¨¡å‹è€Œæ„å»ºçš„ç¦»æ•£æ‰©æ•£å¤§è¯­è¨€æ¨¡å‹ (Discrete Diffusion Large Language Model, dLLM)ï¼Œå…¶æ€»å‚æ•°é‡æ‰©å±•è‡³ 100Bï¼Œä»è€Œä¸ºå‰æ²¿çº§åˆ«çš„æ¨¡å‹éƒ¨ç½²ç¡®ç«‹äº†æ–°èŒƒå¼ã€‚LLaDA2.0 å¹¶éæˆæœ¬é«˜æ˜‚çš„ä»å¤´è®­ç»ƒï¼Œè€Œæ˜¯éµå¾ªçŸ¥è¯†ç»§æ‰¿ã€æ¸è¿›é€‚åº”ä¸æ³¨é‡æ•ˆç‡çš„è®¾è®¡åŸåˆ™ï¼Œå¹¶é‡‡ç”¨ä¸€ç§æ–°é¢–çš„ã€åŸºäºä¸‰é˜¶æ®µå—çº§ WSD çš„è®­ç»ƒæ–¹æ¡ˆï¼Œå°†é¢„è®­ç»ƒçš„ AR æ¨¡å‹æ— ç¼è½¬æ¢ä¸º dLLMã€‚è¯¥æ–¹æ¡ˆåŒ…æ‹¬ï¼šå—æ‰©æ•£ä¸­é€æ­¥å¢å¤§å—å°ºå¯¸ï¼ˆé¢„çƒ­é˜¶æ®µï¼‰ã€å¤§è§„æ¨¡å…¨åºåˆ—æ‰©æ•£ï¼ˆç¨³å®šé˜¶æ®µï¼‰ä»¥åŠå›é€€è‡³ç´§å‡‘å°ºå¯¸çš„å—æ‰©æ•£ï¼ˆè¡°å‡é˜¶æ®µï¼‰ã€‚ç»“åˆç›‘ç£å¾®è°ƒ (SFT) å’Œç›´æ¥åå¥½ä¼˜åŒ– (DPO) è¿›è¡Œè®­ç»ƒåå¯¹é½ï¼Œæˆ‘ä»¬å¾—åˆ°äº† LLaDA2.0-mini (16B) å’Œ LLaDA2.0-flash (100B)ï¼Œè¿™æ˜¯ä¸¤ä¸ªä¸ºå®é™…éƒ¨ç½²ä¼˜åŒ–çš„ã€ç»è¿‡æŒ‡ä»¤è°ƒä¼˜çš„æ··åˆä¸“å®¶ (Mixture-of-Experts, MoE) å˜ä½“ã€‚é€šè¿‡ä¿æŒå¹¶è¡Œè§£ç çš„ä¼˜åŠ¿ï¼Œè¿™äº›æ¨¡å‹åœ¨è¾¾åˆ°å‰æ²¿è§„æ¨¡æ—¶ï¼Œèƒ½æä¾›å“è¶Šçš„æ€§èƒ½ä¸æ•ˆç‡ã€‚ä¸¤ä¸ªæ¨¡å‹å‡å·²å¼€æºã€‚</p>
<h2 data-id="heading-14">Finch: Benchmarking Finance &amp; Accounting across Spreadsheet-Centric Enterprise Workflows</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.13168" target="_blank" title="https://arxiv.org/abs/2512.13168" ref="nofollow noopener noreferrer">Finch: é¢å‘ä»¥ç”µå­è¡¨æ ¼ä¸ºæ ¸å¿ƒçš„ä¼ä¸šå·¥ä½œæµçš„è´¢åŠ¡ä¸ä¼šè®¡åŸºå‡†æµ‹è¯•</a></p>
<p>æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªè´¢åŠ¡ä¸ä¼šè®¡åŸºå‡†æµ‹è¯• (Finch)ï¼Œç”¨äºè¯„ä¼° AI æ™ºèƒ½ä½“åœ¨çœŸå®ä¼ä¸šçº§ä¸“ä¸šå·¥ä½œæµä¸Šçš„æ€§èƒ½ã€‚è¿™äº›å·¥ä½œæµèåˆäº†æ•°æ®å½•å…¥ã€ç»“æ„åŒ–ã€æ ¼å¼åŒ–ã€ç½‘ç»œæœç´¢ã€è·¨æ–‡ä»¶æ£€ç´¢ã€è®¡ç®—ã€å»ºæ¨¡ã€éªŒè¯ã€ç¿»è¯‘ã€å¯è§†åŒ–åŠæŠ¥å‘Šç­‰å¤šç§ä»»åŠ¡ã€‚Finch çš„æ•°æ®æºåŒ…æ‹¬å®‰ç„¶å…¬å¸ (åŒ…å«æ¥è‡ª 150 åå‘˜å·¥çš„ 15,000 ä»½ç”µå­è¡¨æ ¼å’Œ 50 ä¸‡å°ç”µå­é‚®ä»¶) åŠå…¶ä»–é‡‘èæœºæ„çš„çœŸå®å·¥ä½œç¯å¢ƒï¼Œå®Œæ•´ä¿ç•™äº†å®é™…å·¥ä½œä¸­è·¨å¤šæ¨¡æ€å·¥ä»¶ (æ–‡æœ¬ã€è¡¨æ ¼ã€å…¬å¼ã€å›¾è¡¨ã€ä»£ç å’Œå›¾åƒ) çš„æ‚ä¹±ç‰¹æ€§ï¼Œå¹¶è¦†ç›–äº†é¢„ç®—ã€äº¤æ˜“å’Œèµ„äº§ç®¡ç†ç­‰å¤šä¸ªé¢†åŸŸã€‚
æˆ‘ä»¬æå‡ºäº†ä¸€ç§ç»“åˆå¤§è¯­è¨€æ¨¡å‹ (LLM) è¾…åŠ©å‘ç°ä¸ä¸“å®¶æ ‡æ³¨çš„å·¥ä½œæµæ„å»ºæ–¹æ³•ï¼š(1) ä»çœŸå®çš„ç”µå­é‚®ä»¶çº¿ç¨‹å’Œç”µå­è¡¨æ ¼æ–‡ä»¶ç‰ˆæœ¬å†å²ä¸­ï¼Œé€šè¿‡ LLM è¾…åŠ©å¹¶ç»ç”±ä¸“å®¶éªŒè¯æ¥æ¨å¯¼å·¥ä½œæµï¼›(2) å¯¹å·¥ä½œæµè¿›è¡Œç»†è‡´çš„ä¸“å®¶æ ‡æ³¨ï¼Œæ­¤è¿‡ç¨‹è€—è´¹äº†è¶…è¿‡ 700 å°æ—¶çš„é¢†åŸŸä¸“å®¶å·¥æ—¶ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬æ„å»ºäº† 172 ä¸ªå¤åˆå·¥ä½œæµï¼ŒåŒ…å« 384 é¡¹ä»»åŠ¡ï¼Œæ¶‰åŠ 1,710 ä¸ªç”µå­è¡¨æ ¼ (æ€»è®¡ 2,700 ä¸‡ä¸ªå•å…ƒæ ¼) ä»¥åŠ PDF ç­‰å…¶ä»–æ–‡ä»¶ï¼Œä»è€Œæ•æ‰äº†çœŸå®ä¼ä¸šå·¥ä½œæ‰€å›ºæœ‰çš„æ··ä¹±æ€§ã€é•¿æœŸæ€§ã€çŸ¥è¯†å¯†é›†æ€§ä¸åä½œæ€§ã€‚
æˆ‘ä»¬å¯¹åŒ…æ‹¬ GPT 5.1ã€Claude Sonnet 4.5ã€Gemini 3 Proã€Grok 4 å’Œ Qwen 3 Max åœ¨å†…çš„å‰æ²¿ AI ç³»ç»Ÿè¿›è¡Œäº†äººå·¥ä¸è‡ªåŠ¨åŒ–è¯„ä¼°ã€‚ç»“æœæ˜¾ç¤ºï¼ŒGPT 5.1 Pro æ€»è®¡è€—æ—¶ 48 å°æ—¶ï¼Œä»…èƒ½é€šè¿‡ 38.4% çš„å·¥ä½œæµï¼Œè€Œ Claude Sonnet 4.5 çš„é€šè¿‡ç‡ä»…ä¸º 25.0%ã€‚è¿›ä¸€æ­¥çš„å…¨é¢æ¡ˆä¾‹åˆ†ææ­ç¤ºäº†çœŸå®ä¼ä¸šå·¥ä½œæµç»™ AI æ™ºèƒ½ä½“å¸¦æ¥çš„å…·ä½“æŒ‘æˆ˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JobFlow å®æˆ˜ï¼šæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšåˆ°çš„]]></title>    <link>https://juejin.cn/post/7585727457472823296</link>    <guid>https://juejin.cn/post/7585727457472823296</guid>    <pubDate>2025-12-21T14:43:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472823296" data-draft-id="7585850609015685135" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JobFlow å®æˆ˜ï¼šæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšåˆ°çš„"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-21T14:43:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JobFlow å®æˆ˜ï¼šæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšåˆ°çš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T14:43:51.000Z" title="Sun Dec 21 2025 14:43:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ç»è¿‡ä¸¤å‘¨ç´§å¯†çš„å¼€å‘ï¼ŒJobFlow ç¬¬ä¸€ä¸ªç‰ˆæœ¬å·²ç»å®Œæˆã€‚è¿™ç¯‡æ–‡ç« ç”¨ä»£ç è¯´è¯ï¼Œå±•ç¤ºæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p>
<p><strong>JobFlow ç¬¬ä¸€ç‰ˆæ ¸å¿ƒåŠŸèƒ½ï¼š</strong></p>
<ul>
<li>æ— é”è°ƒåº¦ï¼šHash åˆ†åŒº + Owner åˆ¤å®šï¼Œé¿å…åˆ†å¸ƒå¼é”</li>
<li>çˆ¶å­åˆ†ç‰‡ï¼šå›è°ƒé©±åŠ¨åŠ¨æ€åˆ†é…ï¼Œæ”¯æŒå¤§ä»»åŠ¡å¹¶è¡Œå¤„ç†</li>
<li>å»¶æ—¶é˜Ÿåˆ—ï¼šå¤ç”¨ JobFlow åŸºç¡€è®¾æ–½ï¼ˆNacosã€HTTPè°ƒç”¨ã€TraceIdç­‰ï¼‰</li>
<li>å…¨é“¾è·¯è¿½è¸ªï¼šTraceId è´¯ç©¿è°ƒåº¦åˆ°æ‰§è¡Œ</li>
<li>å·¡æ£€è¡¥å¿ï¼šè¶…æ—¶æ£€æµ‹ã€åˆ†ç‰‡è¡¥å¿ã€ä½é¢‘ä»»åŠ¡æ¼è°ƒæ£€æµ‹</li>
</ul>
<p>è¿™ç¯‡æ–‡ç« é‡ç‚¹è®²<strong>æ— é”è°ƒåº¦</strong>ï¼Œå…¶ä»–åŠŸèƒ½åç»­æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆè¦åš JobFlow</h2>
<p>è¿™ä¸ªé—®é¢˜åœ¨å‰ä¸¤ç¯‡æ–‡ç« é‡Œå·²ç»è¯¦ç»†åˆ†æè¿‡äº†ï¼Œè¿™é‡Œç®€å•å›é¡¾ä¸€ä¸‹æ ¸å¿ƒç‚¹ã€‚</p>
<p><strong>JobFlow çš„å®šä½ï¼šè½»é‡çº§åˆ†å¸ƒå¼è°ƒåº¦æ¡†æ¶ï¼Œä¸“ä¸º Nacos ä½“ç³»è®¾è®¡</strong></p>
<p>æ ¸å¿ƒç†å¿µï¼š<strong>å¤ç”¨ä¼˜äºé‡é€ </strong></p>













































<table><thead><tr><th>ç»´åº¦</th><th>XXL-Job</th><th>JobFlow</th></tr></thead><tbody><tr><td>æœåŠ¡å‘ç°</td><td>è‡ªå»ºæ³¨å†Œä¸­å¿ƒï¼ˆæ‰‹åŠ¨æ³¨å†Œï¼‰</td><td>å¤ç”¨ Nacos</td></tr><tr><td>é…ç½®ç®¡ç†</td><td>Admin é¡µé¢é…ç½®</td><td>Nacos Config</td></tr><tr><td>è°ƒåº¦ä¸­å¿ƒ</td><td>ç‹¬ç«‹éƒ¨ç½² Admin + Executor</td><td>åªéœ€ Schedulerï¼ˆæ™®é€šå¾®æœåŠ¡ï¼‰</td></tr><tr><td>ç®¡ç†åå°</td><td>å®Œæ•´çš„ Web UI</td><td>æš‚æ—  UIï¼ˆé…ç½®æ–‡ä»¶ + æ•°æ®åº“ï¼‰</td></tr><tr><td>ç›‘æ§æ—¥å¿—</td><td>éœ€è¦å•ç‹¬æ¥å…¥</td><td>å¤ç”¨ç°æœ‰ä½“ç³»</td></tr><tr><td>è¿ç»´æˆæœ¬</td><td>ä¸­ç­‰ï¼ˆç‹¬ç«‹å¹³å°ï¼‰</td><td>ä½ï¼ˆä¸šåŠ¡å›¢é˜Ÿè‡ªå·±ç»´æŠ¤ï¼‰</td></tr><tr><td>å­¦ä¹ æˆæœ¬</td><td>ä¸­ç­‰</td><td>ä½ï¼ˆå¤ç”¨ Spring Boot ç”Ÿæ€ï¼‰</td></tr></tbody></table>
<p><strong>ç®€å•è¯´ï¼š</strong></p>
<ul>
<li>XXL-Job æ˜¯åŠŸèƒ½å®Œæ•´çš„ç‹¬ç«‹å¹³å°ï¼Œæœ‰ Web ç®¡ç†åå°ï¼Œé€‚åˆé€šç”¨åœºæ™¯</li>
<li>JobFlow æ˜¯è½»é‡çº§æ¡†æ¶ï¼Œå¤ç”¨ Nacos ç”Ÿæ€ï¼Œé€‚åˆå·²æœ‰ Nacos çš„å¾®æœåŠ¡ä½“ç³»</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¦‚æœä½ çš„æŠ€æœ¯æ ˆæ˜¯ Spring Cloud Alibaba + Nacosï¼ŒJobFlow é›¶é¢å¤–ä¾èµ–</li>
<li>å¦‚æœä½ éœ€è¦ Web ç®¡ç†åå°æˆ–æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒXXL-Job æ›´åˆé€‚</li>
</ul>
<p>å¥½ï¼Œå›é¡¾å®Œæ¯•ï¼Œè¿›å…¥æ­£é¢˜ã€‚</p>
<h2 data-id="heading-2">äºŒã€æ— é”è°ƒåº¦æ€ä¹ˆåšåˆ°çš„</h2>
<h3 data-id="heading-3">2.1 ä¼ ç»Ÿæ–¹æ¡ˆçš„é—®é¢˜</h3>
<p>å…ˆçœ‹ä¼ ç»Ÿæ–¹æ¡ˆæ˜¯æ€ä¹ˆåšçš„ã€‚</p>
<p>å‡è®¾ä½ éƒ¨ç½²äº† 3 ä¸ªè°ƒåº¦å™¨å®ä¾‹ï¼ˆé«˜å¯ç”¨ï¼‰ï¼Œæœ‰ 50 ä¸ªä»»åŠ¡ï¼Œæ¯åˆ†é’Ÿéƒ½è¦æ‰§è¡Œã€‚</p>
<pre><code class="hljs language-diff" lang="diff">æ¯åˆ†é’Ÿä¼šå‘ç”Ÿä»€ä¹ˆï¼š
<span class="hljs-deletion">- 3 ä¸ªå®ä¾‹åŒæ—¶é†’æ¥</span>
<span class="hljs-deletion">- æ¯ä¸ªå®ä¾‹éƒ½æ‰«æè¿™ 50 ä¸ªä»»åŠ¡</span>
<span class="hljs-deletion">- æ¯ä¸ªä»»åŠ¡éƒ½è¦å»æ•°æ®åº“æŠ¢é”</span>
<span class="hljs-deletion">- 3 Ã— 50 = 150 æ¬¡ UPDATE</span>
<span class="hljs-deletion">- ä½†åªæœ‰ 50 æ¬¡æ˜¯æœ‰æ•ˆçš„</span>
<span class="hljs-deletion">- å¦å¤– 100 æ¬¡ç™½è·‘äº†</span>
</code></pre>
<p><strong>é—®é¢˜ä¸€ï¼šæ•°æ®åº“å‹åŠ›å¤§</strong></p>
<p>ä¸€å¤©ä¸‹æ¥ï¼š100 æ¬¡/åˆ†é’Ÿ Ã— 1440 åˆ†é’Ÿ = 144,000 æ¬¡æ— æ•ˆ UPDATEã€‚</p>
<p><strong>é—®é¢˜äºŒï¼šæ—¶é—´ç²¾åº¦å·®</strong></p>
<p>æ¯”å¦‚æ¯å¤©å‡Œæ™¨ 2 ç‚¹çš„å¯¹è´¦ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">02:00:00.010 å®ä¾‹ A æŠ¢åˆ°é”ï¼Œå¼€å§‹æ‰§è¡Œ</span>
<span class="hljs-section">02:00:00.050 å®ä¾‹ B å‘ç°è¢«æŠ¢äº†</span>
<span class="hljs-section">02:00:00.100 å®ä¾‹ C å‘ç°è¢«æŠ¢äº†</span>

å¦‚æœå®ä¾‹ A æ‰§è¡Œåˆ°ä¸€åŠæŒ‚äº†ï¼Ÿ
â†’ ä»»åŠ¡ä¸¢äº†ï¼Œè¦ç­‰æ˜å¤©å‡Œæ™¨ 2 ç‚¹
</code></pre>
<h3 data-id="heading-4">2.2 JobFlow çš„æ–¹æ¡ˆ</h3>
<p>æ ¸å¿ƒæ€æƒ³ï¼š<strong>æ¯ä¸ªå®ä¾‹è‡ªå·±ç®—å‡ºè¯¥ä¸è¯¥æ‰§è¡Œï¼Œä¸éœ€è¦å»æŠ¢é”ã€‚</strong></p>
<h4 data-id="heading-5">æ€è·¯å¯¹æ¯”</h4>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼ ç»Ÿä¹è§‚é”</th><th>JobFlow æ— é”è®¾è®¡</th></tr></thead><tbody><tr><td>åˆ¤æ–­æ–¹å¼</td><td>å»æ•°æ®åº“æŠ¢é”</td><td>æœ¬åœ°è®¡ç®— Hash åˆ†åŒº</td></tr><tr><td>å†²çªæ¦‚ç‡</td><td>100% å†²çªï¼ˆ3 å®ä¾‹åŒæ—¶æŠ¢ï¼‰</td><td>æä½å†²çª</td></tr><tr><td>æ•°æ®åº“æ“ä½œ</td><td>æ¯æ¬¡ 3 ä¸ª UPDATE</td><td>æ¯æ¬¡ 1 ä¸ª INSERT</td></tr><tr><td>æ€§èƒ½</td><td>å·®ï¼ˆå¤§é‡æ— æ•ˆæ“ä½œï¼‰</td><td>å¥½ï¼ˆå‡ ä¹æ— æµªè´¹ï¼‰</td></tr><tr><td>å…œåº•æœºåˆ¶</td><td>æ— </td><td>å”¯ä¸€ç´¢å¼• + å·¡æ£€è¡¥å¿</td></tr><tr><td>æ¼è°ƒé£é™©</td><td>ä½ï¼ˆæœ‰é”ä¿è¯ï¼‰</td><td>æœ‰ï¼ˆé€šè¿‡å·¡æ£€è¡¥å¿è§£å†³ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-6">å·¥ä½œåŸç†</h4>
<p>ç®€å•è¯´å°±æ˜¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ä» Nacos è·å–æ‰€æœ‰è°ƒåº¦å™¨å®ä¾‹åˆ—è¡¨
<span class="hljs-bullet">2.</span> å¯¹å®ä¾‹åˆ—è¡¨æ’åºï¼ˆç¡®ä¿æ‰€æœ‰å®ä¾‹çœ‹åˆ°çš„é¡ºåºä¸€è‡´ï¼‰
<span class="hljs-bullet">3.</span> ç”¨ä»»åŠ¡åç®— Hashï¼šhash % å®ä¾‹æ•° = ç›®æ ‡ç´¢å¼•
<span class="hljs-bullet">4.</span> å¦‚æœç›®æ ‡ç´¢å¼•æ˜¯æˆ‘ï¼Œå°±æ‰§è¡Œï¼›ä¸æ˜¯æˆ‘ï¼Œå°±è·³è¿‡
</code></pre>
<p>è¿™å°±æ˜¯ <strong>Hash åˆ†åŒº + Owner åˆ¤å®š</strong>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">å®ä¾‹åˆ—è¡¨ï¼ˆå·²æ’åºï¼‰ï¼š
<span class="hljs-deletion">- ç´¢å¼• 0: 192.168.1.10:8080</span>
<span class="hljs-deletion">- ç´¢å¼• 1: 192.168.1.11:8080</span>
<span class="hljs-deletion">- ç´¢å¼• 2: 192.168.1.12:8080</span>

ä»»åŠ¡åˆ—è¡¨ï¼š
<span class="hljs-deletion">- orderSync</span>
<span class="hljs-deletion">- userClean</span>
<span class="hljs-deletion">- reportGen</span>

Hash åˆ†é…ï¼š
<span class="hljs-deletion">- "orderSync".hashCode() % 3 = 0 â†’ 192.168.1.10:8080 è´Ÿè´£</span>
<span class="hljs-deletion">- "userClean".hashCode() % 3 = 2 â†’ 192.168.1.12:8080 è´Ÿè´£</span>
<span class="hljs-deletion">- "reportGen".hashCode() % 3 = 1 â†’ 192.168.1.11:8080 è´Ÿè´£</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>æ‰€æœ‰å®ä¾‹å¯¹å®ä¾‹åˆ—è¡¨çš„æ’åºç»“æœä¸€è‡´</li>
<li>åŒä¸€ä¸ªä»»åŠ¡ç®—å‡ºçš„ Hash ç»“æœä¸€è‡´</li>
<li>æ‰€ä»¥åŒä¸€ä¸ªä»»åŠ¡åœ¨æ‰€æœ‰å®ä¾‹çœ¼é‡Œï¼Œowner æ˜¯å”¯ä¸€çš„</li>
</ul>
<h4 data-id="heading-7">æ ¸å¿ƒä»£ç </h4>
<p>ä»£ç å¾ˆç®€å•ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isOwner</span><span class="hljs-params">(String jobName)</span> {
    <span class="hljs-comment">// 1. ä» Nacos è·å–æ‰€æœ‰è°ƒåº¦å™¨å®ä¾‹</span>
    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="hljs-string">"jobflow-scheduler"</span>);
    
    <span class="hljs-keyword">if</span> (instances == <span class="hljs-literal">null</span> || instances.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// 2. æ’åºï¼ˆå…³é”®ï¼æ‰€æœ‰å®ä¾‹å¿…é¡»çœ‹åˆ°ç›¸åŒçš„é¡ºåºï¼‰</span>
    instances.sort(Comparator.comparing(instance -&gt; 
        instance.getHost() + <span class="hljs-string">":"</span> + instance.getPort()));
    
    <span class="hljs-comment">// 3. æ‰¾åˆ°å½“å‰å®ä¾‹åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">currentKey</span> <span class="hljs-operator">=</span> localHost + <span class="hljs-string">":"</span> + localPort;
    <span class="hljs-type">int</span> <span class="hljs-variable">currentIndex</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; instances.size(); i++) {
        <span class="hljs-type">ServiceInstance</span> <span class="hljs-variable">inst</span> <span class="hljs-operator">=</span> instances.get(i);
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> inst.getHost() + <span class="hljs-string">":"</span> + inst.getPort();
        <span class="hljs-keyword">if</span> (key.equals(currentKey)) {
            currentIndex = i;
            <span class="hljs-keyword">break</span>;
        }
    }
    
    <span class="hljs-keyword">if</span> (currentIndex == -<span class="hljs-number">1</span>) {
        log.warn(<span class="hljs-string">"å½“å‰å®ä¾‹ä¸åœ¨ Nacos æ³¨å†Œåˆ—è¡¨ä¸­"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// 4. è®¡ç®—ä»»åŠ¡åº”è¯¥å½’è°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Math.abs(jobName.hashCode());
    <span class="hljs-type">int</span> <span class="hljs-variable">targetIndex</span> <span class="hljs-operator">=</span> hash % instances.size();
    
    <span class="hljs-comment">// 5. åˆ¤æ–­æ˜¯ä¸æ˜¯æˆ‘</span>
    <span class="hljs-keyword">return</span> currentIndex == targetIndex;
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦æ’åºï¼Ÿ</strong></p>
<p>å¦‚æœä¸æ’åºï¼ŒNacos è¿”å›çš„å®ä¾‹é¡ºåºå¯èƒ½æ˜¯éšæœºçš„ï¼š</p>
<pre><code class="hljs language-css" lang="css">å®ä¾‹ <span class="hljs-selector-tag">A</span> çœ‹åˆ°ï¼š<span class="hljs-selector-attr">[B, A, C]</span>
å®ä¾‹ <span class="hljs-selector-tag">B</span> çœ‹åˆ°ï¼š<span class="hljs-selector-attr">[C, B, A]</span>
å®ä¾‹ C çœ‹åˆ°ï¼š<span class="hljs-selector-attr">[A, C, B]</span>

â†’ åŒä¸€ä¸ªä»»åŠ¡ï¼Œä¸åŒå®ä¾‹ç®—å‡ºçš„ owner ä¸ä¸€æ ·
â†’ å¯èƒ½éƒ½ä¸æ‰§è¡Œï¼Œä¹Ÿå¯èƒ½é‡å¤æ‰§è¡Œ
</code></pre>
<p>æ’åºåï¼Œæ‰€æœ‰å®ä¾‹çœ‹åˆ°çš„éƒ½æ˜¯ <code>[A, B, C]</code>ï¼Œè®¡ç®—ç»“æœå°±ä¸€è‡´äº†ã€‚</p>
<h3 data-id="heading-8">2.3 é‡ç‚¹è¯´æ˜ï¼šè¿™æ˜¯"æ— é”è®¾è®¡"ï¼Œä¸æ˜¯çœŸçš„å®Œå…¨æ— é”</h3>
<p><strong>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç¡®å®æ— é”ï¼š</strong></p>
<ul>
<li>æ‰€æœ‰å®ä¾‹ä» Nacos æ‹¿åˆ°ç›¸åŒçš„å®ä¾‹åˆ—è¡¨</li>
<li>æ’åºåé¡ºåºä¸€è‡´</li>
<li>Hash è®¡ç®—ç»“æœä¸€è‡´</li>
<li>åŒä¸€ä»»åŠ¡åªæœ‰ä¸€ä¸ª owner</li>
<li>é›¶å†²çªï¼Œé›¶æµªè´¹</li>
</ul>
<p><strong>æå°‘æ•°çš„æç«¯æƒ…å†µï¼š</strong></p>
<p><strong>æƒ…å†µ 1ï¼šç½‘ç»œåˆ†åŒº</strong></p>
<pre><code class="hljs">æ­£å¸¸ï¼šæ‰€æœ‰å®ä¾‹éƒ½èƒ½è®¿é—®åŒä¸€ä¸ª Nacos
å¼‚å¸¸ï¼šæœºæˆ¿é—´ç½‘ç»œä¸­æ–­ï¼Œå®ä¾‹çœ‹åˆ°ä¸åŒçš„ Nacos æ•°æ®

ç»“æœï¼šå¯èƒ½æœ‰ä¸¤ä¸ªå®ä¾‹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ owner
</code></pre>
<p><strong>æƒ…å†µ 2ï¼šNacos æ•°æ®å»¶è¿Ÿ</strong></p>
<pre><code class="hljs language-css" lang="css">å®ä¾‹åˆšä¸Šçº¿æˆ–ä¸‹çº¿ï¼ŒNacos çš„æœåŠ¡åˆ—è¡¨å¯èƒ½æœ‰å‡ ç§’å»¶è¿Ÿ

å®ä¾‹ <span class="hljs-selector-tag">A</span> æ‹‰å–ï¼šæ²¡æœ‰æ–°å®ä¾‹
å®ä¾‹ <span class="hljs-selector-tag">B</span> æ‹‰å–ï¼šæœ‰æ–°å®ä¾‹

ç»“æœï¼šå¯èƒ½æœ‰ä¸¤ä¸ªå®ä¾‹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ owner
</code></pre>
<p>è™½ç„¶æ¦‚ç‡å¾ˆä½ï¼ˆå®æµ‹ &lt; 0.1%ï¼‰ï¼Œä½†ä¸€æ—¦å‘ç”Ÿå°±æ˜¯äº‹æ•…ã€‚æ‰€ä»¥æˆ‘ä»¬åŠ äº†å…œåº•æœºåˆ¶ã€‚</p>
<p><strong>è®¾è®¡å–èˆï¼š</strong></p>
<p>æ— é”è®¾è®¡æ˜¯ä¸€ç§æƒè¡¡ï¼š</p>
<ul>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ€§èƒ½å¥½ã€å“åº”å¿«ã€æ•°æ®åº“å‹åŠ›å°</li>
<li><strong>ä»£ä»·</strong>ï¼šæç«¯æƒ…å†µä¸‹å¯èƒ½é‡å¤æ‰§è¡Œï¼ˆé€šè¿‡æ•°æ®åº“å”¯ä¸€ç´¢å¼•é˜²æŠ¤ï¼‰</li>
</ul>
<p>è¿™ç¬¦åˆ JobFlow çš„è®¾è®¡ç†å¿µï¼š<strong>è½»é‡çº§ä¼˜å…ˆï¼Œé«˜æ€§ä»·æ¯”å®¹é”™</strong>ã€‚</p>
<h3 data-id="heading-9">2.4 æ•°æ®åº“å…œåº•æœºåˆ¶</h3>
<h4 data-id="heading-10">execution_id å”¯ä¸€ç´¢å¼•</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> job_execution (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    execution_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    <span class="hljs-comment">-- ... å…¶ä»–å­—æ®µ</span>
    
    <span class="hljs-keyword">UNIQUE</span> KEY uk_execution_id (execution_id)
);
</code></pre>
<p><strong>execution_id çš„æ ¼å¼ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ä»»åŠ¡å:è§¦å‘æ—¶é—´:åˆ†ç‰‡èŒƒå›´</span>

ç¤ºä¾‹ï¼š
<span class="hljs-section">orderSync:202412211030:0-99</span>
</code></pre>
<p><strong>å…œåº•é€»è¾‘ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// æ’å…¥æ‰§è¡Œè®°å½•</span>
    jobRepository.insert(execution);
    
    <span class="hljs-comment">// æˆåŠŸï¼Œç»§ç»­è°ƒåº¦</span>
    callExecutor(...);
    
} <span class="hljs-keyword">catch</span> (DuplicateKeyException e) {
    <span class="hljs-comment">// å”¯ä¸€ç´¢å¼•å†²çªï¼Œè¯´æ˜å…¶ä»–å®ä¾‹å·²ç»åœ¨æ‰§è¡Œäº†</span>
    log.info(<span class="hljs-string">"ä»»åŠ¡å·²è¢«å…¶ä»–å®ä¾‹æ‰§è¡Œï¼Œè·³è¿‡"</span>);
}
</code></pre>
<p><strong>å·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">æç«¯æƒ…å†µï¼šscheduler-001 å’Œ scheduler-002 éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ owner

scheduler-001: INSERT <span class="hljs-attr">execution_id</span> = <span class="hljs-string">"orderSync:202412211030:0-99"</span>
â†’ æˆåŠŸï¼ˆç¬¬ä¸€ä¸ªåˆ°è¾¾ï¼‰

scheduler-002: INSERT <span class="hljs-attr">execution_id</span> = <span class="hljs-string">"orderSync:202412211030:0-99"</span>
â†’ å¤±è´¥ï¼ˆå”¯ä¸€ç´¢å¼•å†²çªï¼‰

æœ€ç»ˆï¼šåªæœ‰ scheduler-001 ç»§ç»­æ‰§è¡Œ
</code></pre>
<h4 data-id="heading-11">æ€§èƒ½å¯¹æ¯”</h4>
<p>è™½ç„¶åŠ äº†æ•°æ®åº“å…œåº•ï¼Œä½†æ€§èƒ½ä»ç„¶æ¯”ä¹è§‚é”å¥½å¾ˆå¤šï¼š</p>






























<table><thead><tr><th>ç»´åº¦</th><th>ä¹è§‚é”æ–¹æ¡ˆ</th><th>JobFlow æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ•°æ®åº“æ“ä½œ</td><td>3 å®ä¾‹ Ã— 50 ä»»åŠ¡ = 150 æ¬¡ UPDATE</td><td>50 æ¬¡ INSERT</td></tr><tr><td>æœ‰æ•ˆæ“ä½œ</td><td>50 æ¬¡</td><td>50 æ¬¡</td></tr><tr><td>æ— æ•ˆæ“ä½œ</td><td>100 æ¬¡</td><td>0 æ¬¡ï¼ˆå¶å°”æœ‰å†²çª &lt; 0.1%ï¼‰</td></tr><tr><td>æ“ä½œç±»å‹</td><td>UPDATEï¼ˆåŠ é”ï¼‰</td><td>INSERTï¼ˆæ— é”ï¼‰</td></tr></tbody></table>
<p><strong>æ˜¾è‘—å‡å°‘æ•°æ®åº“å‹åŠ›ï¼ŒCPU ä½¿ç”¨ç‡å¤§å¹…ä¸‹é™ã€‚</strong></p>
<h2 data-id="heading-12">ä¸‰ã€å®ä¾‹å˜åŒ–æ—¶æ€ä¹ˆåŠ</h2>
<p>å‰é¢è¯´çš„æ˜¯é™æ€åœºæ™¯ï¼Œé‚£å®ä¾‹ä¸Šçº¿æˆ–ä¸‹çº¿å‘¢ï¼Ÿ</p>
<h3 data-id="heading-13">3.1 ç›‘å¬ Nacos äº‹ä»¶</h3>
<p>è°ƒåº¦å™¨å¯åŠ¨æ—¶ï¼Œä¼šç›‘å¬ Nacos çš„å®ä¾‹å˜åŒ–äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@PostConstruct</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
    namingService.subscribe(serviceName, event -&gt; {
        log.info(<span class="hljs-string">"è°ƒåº¦å™¨å®ä¾‹å‘ç”Ÿå˜åŒ–"</span>);
        <span class="hljs-comment">// è§¦å‘ä¸€æ¬¡ç«‹å³æ‰«æ</span>
        jobScheduler.scanNow();
    });
}
</code></pre>
<h3 data-id="heading-14">3.2 å˜åŒ–åœºæ™¯</h3>
<p><strong>åœºæ™¯ï¼š3 å®ä¾‹ â†’ åœæ‰ä¸€ä¸ª â†’ 2 å®ä¾‹</strong></p>
<pre><code class="hljs language-diff" lang="diff">åˆå§‹çŠ¶æ€ï¼ˆ3 ä¸ªå®ä¾‹ï¼‰ï¼š
<span class="hljs-deletion">- scheduler-001 è´Ÿè´£ orderSync, reportGen</span>
<span class="hljs-deletion">- scheduler-002 è´Ÿè´£ paymentSync</span>
<span class="hljs-deletion">- scheduler-003 è´Ÿè´£ userClean</span>

åœæ‰ scheduler-002ï¼š
<span class="hljs-deletion">- Nacos æ£€æµ‹åˆ°å¿ƒè·³ä¸¢å¤±ï¼ˆçº¦ 15 ç§’ï¼‰</span>
<span class="hljs-deletion">- è§¦å‘äº‹ä»¶é€šçŸ¥å…¶ä»–å®ä¾‹</span>
<span class="hljs-deletion">- scheduler-001 å’Œ 003 é‡æ–°è®¡ç®— Hash</span>

é‡æ–°åˆ†é…ï¼ˆ2 ä¸ªå®ä¾‹ï¼‰ï¼š
<span class="hljs-deletion">- scheduler-001 è´Ÿè´£ orderSync, paymentSync</span>
<span class="hljs-deletion">- scheduler-003 è´Ÿè´£ userClean, reportGen</span>

æ€»è€—æ—¶ï¼š15-20 ç§’å®Œæˆåˆ‡æ¢
</code></pre>
<p><strong>å¯¹æ¯”ä¼ ç»Ÿæ–¹æ¡ˆï¼š</strong></p>
<p>ä¼ ç»Ÿæ–¹æ¡ˆéœ€è¦ç­‰è¡¥å¿ä»»åŠ¡æ‰«æåˆ°è¶…æ—¶è®°å½•ï¼Œé€šå¸¸ 2-3 åˆ†é’Ÿã€‚</p>
<p>JobFlow çš„åˆ‡æ¢é€Ÿåº¦å¿« 8-10 å€ã€‚</p>
<h3 data-id="heading-15">3.3 å®æµ‹æ—¥å¿—</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åœæ‰ scheduler-002 å‰</span>
<span class="hljs-section">[scheduler-001]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=orderSync
<span class="hljs-section">[scheduler-002]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=paymentSync
<span class="hljs-section">[scheduler-003]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=userClean

<span class="hljs-comment"># scheduler-002 åœæ­¢</span>
<span class="hljs-section">[scheduler-001]</span> è°ƒåº¦å™¨å®ä¾‹å‘ç”Ÿå˜åŒ–ï¼Œå½“å‰å®ä¾‹æ•°ï¼š2
<span class="hljs-section">[scheduler-003]</span> è°ƒåº¦å™¨å®ä¾‹å‘ç”Ÿå˜åŒ–ï¼Œå½“å‰å®ä¾‹æ•°ï¼š2

<span class="hljs-comment"># 15 ç§’å</span>
<span class="hljs-section">[scheduler-001]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=orderSync
<span class="hljs-section">[scheduler-001]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=paymentSync  â† æ¥ç®¡äº†
<span class="hljs-section">[scheduler-003]</span> è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=userClean
</code></pre>
<h2 data-id="heading-16">å››ã€å®Œæ•´çš„è°ƒåº¦æµç¨‹</h2>
<p>ç”¨ä¸€ä¸ªç®€å•çš„å›¾å±•ç¤ºæ ¸å¿ƒæµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å®šæ—¶æ‰«æ] --&gt; B{Owner?}
    B --&gt;|å¦| F[è·³è¿‡]
    B --&gt;|æ˜¯| C{åˆ°æœŸ?}
    C --&gt;|å¦| F
    C --&gt;|æ˜¯| D[INSERT]
    D --&gt;|æˆåŠŸ| E[è°ƒåº¦]
    D --&gt;|å†²çª| F
    E --&gt; G[å®Œæˆ]
</code></pre>
<p><strong>å…³é”®æ­¥éª¤ï¼š</strong></p>
<ol>
<li><strong>isOwner åˆ¤å®š</strong>ï¼šHash åˆ†åŒºï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹é¿å…å†²çª</li>
<li><strong>Cron åˆ¤æ–­</strong>ï¼šæ—¶é—´åˆ°äº†æ‰è§¦å‘</li>
<li><strong>åˆ›å»ºçˆ¶å­è®°å½•</strong>ï¼šæ”¯æŒåˆ†ç‰‡å¹¶è¡Œ</li>
<li><strong>INSERT æ‰§è¡Œè®°å½•</strong>ï¼šå”¯ä¸€ç´¢å¼•å…œåº•ï¼Œå¤„ç†æç«¯æƒ…å†µ</li>
<li><strong>è°ƒç”¨æ‰§è¡Œå™¨</strong>ï¼šHTTP å¼‚æ­¥è°ƒç”¨ï¼Œå›è°ƒé©±åŠ¨åˆ†ç‰‡åˆ†é…</li>
</ol>
<p><strong>å…³äºåˆ†ç‰‡è°ƒåº¦ï¼š</strong> è¿™é‡Œåªå±•ç¤ºäº†è°ƒåº¦è§¦å‘éƒ¨åˆ†ã€‚å®Œæ•´çš„åˆ†ç‰‡è°ƒåº¦æœºåˆ¶ï¼ˆçˆ¶å­è®°å½•ã€å›è°ƒé©±åŠ¨ã€åŠ¨æ€åˆ†é…ï¼‰è¯·å‚è€ƒç¬¬äºŒç¯‡æ–‡ç« ã€‚</p>
<h2 data-id="heading-17">äº”ã€å»¶æ—¶é˜Ÿåˆ—ä¹Ÿç”¨äº†æ— é”è°ƒåº¦</h2>
<p>æ—¢ç„¶è®²åˆ° JobFlow çš„æ— é”è°ƒåº¦ï¼Œè¿™é‡Œè¡¥å……è¯´æ˜ä¸€ä¸‹ï¼š<strong>å»¶æ—¶é˜Ÿåˆ—ä¹Ÿå¤ç”¨äº†è¿™å¥—æœºåˆ¶</strong>ã€‚</p>
<p><strong>å»¶æ—¶é˜Ÿåˆ—çš„ Owner åˆ¤å®šï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// DelayTaskService.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispatchDelayTask</span><span class="hljs-params">(JobDelayTask task)</span> {
    <span class="hljs-comment">// 1. æ— é” owner åˆ¤å®šï¼ˆæŒ‰æœåŠ¡ååˆ†åŒºï¼‰</span>
    <span class="hljs-keyword">if</span> (!clusterInstanceService.isOwner(task.getServiceName())) {
        <span class="hljs-keyword">if</span> (log.isDebugEnabled()) {
            log.debug(<span class="hljs-string">"å½“å‰å®ä¾‹ä¸æ˜¯å»¶æ—¶ä»»åŠ¡ownerï¼Œè·³è¿‡ï¼ŒserviceName={}"</span>, 
                    task.getServiceName());
        }
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 2. CAS æŠ¢å ï¼ˆæ•°æ®åº“ä¹è§‚é”ï¼‰</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> delayTaskRepository.tryMarkSending(
        task.getId(), task.getStatus(), task.getRetryCount());
    
    <span class="hljs-keyword">if</span> (!locked) {
        log.warn(<span class="hljs-string">"å»¶æ—¶ä»»åŠ¡CASæŠ¢å å¤±è´¥ï¼Œå¯èƒ½è¢«å…¶ä»–å®ä¾‹å¤„ç†"</span>);
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 3. å‘é€ HTTP è°ƒç”¨</span>
    callExecutor(...);
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå»¶æ—¶é˜Ÿåˆ—ç”¨ serviceName è€Œä¸æ˜¯ taskIdï¼Ÿ</strong></p>
<ul>
<li>å‘¨æœŸä»»åŠ¡ï¼šç”¨ jobName åˆ†åŒºï¼ˆä»»åŠ¡å›ºå®šï¼‰</li>
<li>å»¶æ—¶ä»»åŠ¡ï¼šç”¨ serviceName åˆ†åŒºï¼ˆä»»åŠ¡åŠ¨æ€ï¼ŒæŒ‰ç›®æ ‡æœåŠ¡åˆ†ç»„ï¼‰</li>
</ul>
<p>è¿™æ ·å¯ä»¥è®©åŒä¸€ä¸ªæœåŠ¡çš„å»¶æ—¶ä»»åŠ¡é›†ä¸­åœ¨åŒä¸€ä¸ªè°ƒåº¦å™¨å®ä¾‹å¤„ç†ï¼Œå‡å°‘ç½‘ç»œå¼€é”€ã€‚</p>
<p><strong>å»¶æ—¶é˜Ÿåˆ—çš„åŒé‡ä¿æŠ¤ï¼š</strong></p>
<ol>
<li><strong>Owner åˆ¤å®š</strong>ï¼šé¿å…å¤šå®ä¾‹é‡å¤æ‰«æ</li>
<li><strong>CAS æŠ¢å </strong>ï¼šé¿å…åŒä¸€ä»»åŠ¡è¢«é‡å¤è°ƒåº¦</li>
</ol>
<p>è¿™å’Œå‘¨æœŸä»»åŠ¡çš„ Owner + å”¯ä¸€ç´¢å¼•æ˜¯ä¸€æ ·çš„æ€è·¯ã€‚</p>
<h2 data-id="heading-18">å…­ã€å…³äº"æ¼è°ƒ"çš„é—®é¢˜</h2>
<p>æœ‰æœ‹å‹å¯èƒ½ä¼šé—®ï¼šæ¯ä¸ªå®ä¾‹åªå–è‡ªå·±çš„ä»»åŠ¡ï¼Œé‚£ä¼šä¸ä¼šæ¼è°ƒï¼Ÿ</p>
<p><strong>ç¡®å®æœ‰è¿™ä¸ªå¯èƒ½ã€‚</strong></p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼š3 ä¸ªå®ä¾‹ï¼Œscheduler-001 è´Ÿè´£ orderSync

å¦‚æœ scheduler-001 æŒ‚äº†ï¼š
<span class="hljs-deletion">- Nacos 15 ç§’åæ£€æµ‹åˆ°</span>
<span class="hljs-deletion">- å…¶ä»–å®ä¾‹æ¥ç®¡ä»»åŠ¡</span>
<span class="hljs-deletion">- ä½†è¿™ 15 ç§’å†…åˆ°æœŸçš„ä»»åŠ¡ï¼Œå¯èƒ½æ¼è°ƒ</span>

å¦‚æœ 3 ä¸ªå®ä¾‹åŒæ—¶æŒ‚äº†ï¼š
<span class="hljs-deletion">- æ‰€æœ‰ä»»åŠ¡éƒ½æ¼è°ƒ</span>
<span class="hljs-deletion">- ç›´åˆ°æœ‰æ–°å®ä¾‹ä¸Šçº¿</span>
</code></pre>
<p><strong>JobFlow æ€ä¹ˆè§£å†³ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å·¡æ£€ä¸è¡¥å¿æœºåˆ¶</strong>ã€‚</p>
<p>å…·ä½“æ€ä¹ˆåšï¼Œæˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€ç¯‡æ–‡ç« è¯¦ç»†è®²ã€‚è¿™é‡Œå…ˆç®€å•è¯´æ˜ä¸€ä¸‹æ€è·¯ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">JobFlow çš„ä¸‰å±‚ä¿éšœæœºåˆ¶ï¼š

ç¬¬ä¸€å±‚ï¼ˆæ­£å¸¸æµç¨‹ï¼‰ï¼š
<span class="hljs-deletion">- æ— é”è°ƒåº¦å¿«é€Ÿè§¦å‘</span>
<span class="hljs-deletion">- 99.9% çš„ä»»åŠ¡éƒ½èµ°è¿™æ¡è·¯</span>

ç¬¬äºŒå±‚ï¼ˆå·¡æ£€è¡¥å¿ï¼‰ï¼š
<span class="hljs-deletion">- åˆ†ç‰‡è¶…æ—¶å·¡æ£€ï¼ˆ3åˆ†é’Ÿä¸€æ¬¡ï¼‰</span>
<span class="hljs-deletion">- æ£€æµ‹ PENDING/RUNNING è¶…æ—¶çš„åˆ†ç‰‡</span>
<span class="hljs-deletion">- è‡ªåŠ¨é‡è¯•æˆ–æ ‡è®°å¤±è´¥</span>

ç¬¬ä¸‰å±‚ï¼ˆæ¼è°ƒæ£€æµ‹ï¼‰ï¼š
<span class="hljs-deletion">- ä½é¢‘ä»»åŠ¡å·¡æ£€ï¼ˆ10åˆ†é’Ÿä¸€æ¬¡ï¼‰</span>
<span class="hljs-deletion">- ä¸“é—¨æ£€æµ‹å°æ—¶çº§ä»»åŠ¡çš„æ¼è°ƒ</span>
<span class="hljs-deletion">- æŸ¥è¯¢æ—¶é—´çª—å£å†…æ˜¯å¦æœ‰æ‰§è¡Œè®°å½•</span>
</code></pre>
<p>è¿™æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¸¸è§åšæ³•ï¼š<strong>æ­£å¸¸æµç¨‹è¿½æ±‚æ•ˆç‡ï¼Œå¼‚å¸¸æµç¨‹è¿½æ±‚å¯é æ€§ã€‚</strong></p>
<h2 data-id="heading-19">ä¸ƒã€å®é™…è¿è¡Œæ•ˆæœ</h2>
<h3 data-id="heading-20">7.1 TraceId å…¨é“¾è·¯è¿½è¸ª</h3>
<p>è¿™æ˜¯ä¸€æ¬¡å®Œæ•´çš„ä»»åŠ¡æ‰§è¡Œæ—¥å¿—ï¼š</p>
<p><strong>è°ƒåº¦å™¨æ—¥å¿—ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">2025-12-21 10:00:00.123 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
è§¦å‘ä»»åŠ¡æ‰§è¡Œï¼Œ<span class="hljs-attr">jobName</span>=orderSync

2025-12-21 10:00:00.456 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
è°ƒç”¨æ‰§è¡Œå™¨ï¼Œ<span class="hljs-attr">url</span>=http://<span class="hljs-number">192.168</span>.<span class="hljs-number">1.20</span>:<span class="hljs-number">8081</span>/internal/job/orderSync

2025-12-21 10:00:05.678 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
æ¥æ”¶åˆ°å›è°ƒï¼Œ<span class="hljs-attr">success</span>=<span class="hljs-literal">true</span>
</code></pre>
<p><strong>æ‰§è¡Œå™¨æ—¥å¿—ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">2025-12-21 10:00:00.600 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
æ¥æ”¶åˆ°ä»»åŠ¡è¯·æ±‚ï¼Œ<span class="hljs-attr">handler</span>=orderSync

2025-12-21 10:00:01.800 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
æŸ¥è¯¢è®¢å•æ•°æ®ï¼Œ<span class="hljs-attr">count</span>=<span class="hljs-number">1523</span>

2025-12-21 10:00:05.000 <span class="hljs-section">[traceId=20241221100000-a1b2c3d4]</span> 
ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œ<span class="hljs-attr">duration</span>=<span class="hljs-number">4300</span>ms
</code></pre>
<p><strong>åœ¨ ELK ä¸­æœç´¢ traceIdï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æœç´¢ï¼štraceId="20251221100000-a1b2c3d4"

ç»“æœï¼š
<span class="hljs-deletion">- è°ƒåº¦å™¨çš„ 3 æ¡æ—¥å¿—</span>
<span class="hljs-deletion">- æ‰§è¡Œå™¨çš„ 3 æ¡æ—¥å¿—</span>
<span class="hljs-deletion">- æŒ‰æ—¶é—´æ’åºï¼Œå®Œæ•´è¿˜åŸæ‰§è¡Œè¿‡ç¨‹</span>
</code></pre>
<p>å¯¹æ¯”ä¼ ç»Ÿæ–¹æ¡ˆï¼šéœ€è¦å»ä¸¤ä¸ªç³»ç»Ÿåˆ†åˆ«æŸ¥æ—¥å¿—ï¼Œé æ—¶é—´æˆ³å¯¹ï¼Œå®¹æ˜“å‡ºé”™ã€‚</p>
<h3 data-id="heading-21">7.2 æ€§èƒ½è¡¨ç°</h3>
<p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong></p>
<ul>
<li>è°ƒåº¦å™¨ï¼š3 ä¸ªå®ä¾‹</li>
<li>ä»»åŠ¡æ•°é‡ï¼š100 ä¸ª</li>
<li>æ‰§è¡Œé¢‘ç‡ï¼šæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</li>
<li>æµ‹è¯•æ—¶é•¿ï¼š1 å°æ—¶</li>
</ul>
<p><strong>å¯¹æ¯”ç»“æœï¼š</strong></p>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>ä¹è§‚é”æ–¹æ¡ˆ</th><th>JobFlow æ–¹æ¡ˆ</th><th>æå‡</th></tr></thead><tbody><tr><td>æ¯åˆ†é’Ÿæ•°æ®åº“æ“ä½œ</td><td>300 æ¬¡ UPDATE</td><td>100 æ¬¡ INSERT</td><td>67% â†“</td></tr><tr><td>1 å°æ—¶æ“ä½œæ€»æ•°</td><td>18,000 æ¬¡</td><td>6,000 æ¬¡</td><td>67% â†“</td></tr><tr><td>æ•°æ®åº“ CPU</td><td>è¾ƒé«˜</td><td>æ˜¾è‘—é™ä½</td><td>-</td></tr><tr><td>å”¯ä¸€ç´¢å¼•å†²çª</td><td>-</td><td>5 æ¬¡ï¼ˆ0.083%ï¼‰</td><td>-</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ•°æ®åº“æ“ä½œå‡å°‘ 67%</li>
<li>CPU ä½¿ç”¨ç‡æ˜¾è‘—é™ä½</li>
<li>æä½çš„å†²çªç‡ï¼ˆ&lt; 0.1%ï¼‰</li>
</ul>
<h2 data-id="heading-22">å…«ã€å¸¸è§é—®é¢˜</h2>
<p><strong>Q1ï¼šHash åˆ†åŒºçœŸçš„èƒ½ä¿è¯ä¸é‡å¤å—ï¼Ÿ</strong></p>
<p>Aï¼šç»å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ã€‚æç«¯æƒ…å†µä¸‹æœ‰æ•°æ®åº“å”¯ä¸€ç´¢å¼•å…œåº•ã€‚å®æµ‹å†²çªç‡ &lt; 0.1%ã€‚</p>
<p><strong>Q2ï¼šæ•°æ®åº“å”¯ä¸€ç´¢å¼•ä¼šä¸ä¼šå½±å“æ€§èƒ½ï¼Ÿ</strong></p>
<p>Aï¼šä¸ä¼šï¼Œåè€Œæ¯”ä¹è§‚é”æ–¹æ¡ˆæ€§èƒ½æ›´å¥½ã€‚å› ä¸ºï¼š</p>
<ul>
<li>ä¹è§‚é”ï¼šæ¯æ¬¡ 3 ä¸ª UPDATEï¼ˆæŠ¢é”ï¼‰</li>
<li>JobFlowï¼šæ¯æ¬¡ 1 ä¸ª INSERTï¼ˆè®°å½•ï¼‰</li>
<li>INSERT æ¯” UPDATE æ›´è½»é‡</li>
</ul>
<p><strong>Q3ï¼šå®ä¾‹ä¸‹çº¿åï¼Œæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ä¼šä¸¢å—ï¼Ÿ</strong></p>
<p>Aï¼šä¸ä¼šã€‚ä»»åŠ¡å·²ç»åœ¨æ‰§è¡Œå™¨ä¸Šè¿è¡Œäº†ï¼Œè°ƒåº¦å™¨æŒ‚äº†ä¸å½±å“ã€‚å¦‚æœå›è°ƒå¤±è´¥ï¼Œæœ‰å·¡æ£€è¡¥å¿æœºåˆ¶ï¼ˆä¸‹ä¸€ç¯‡æ–‡ç« ä¼šè®²ï¼‰ã€‚</p>
<p><strong>Q4ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ ä»»åŠ¡å—ï¼Ÿ</strong></p>
<p>Aï¼šæ”¯æŒã€‚é€šè¿‡ API æˆ–ç›´æ¥æ“ä½œæ•°æ®åº“æ·»åŠ ä»»åŠ¡ï¼Œä¸‹ä¸€ä¸ªæ‰«æå‘¨æœŸï¼ˆ5 ç§’åï¼‰è‡ªåŠ¨ç”Ÿæ•ˆï¼Œä¸éœ€è¦é‡å¯è°ƒåº¦å™¨ã€‚</p>
<p><strong>Q5ï¼šå’Œ XXL-Job æ¯”ï¼ŒJobFlow ç¼ºå°‘ä»€ä¹ˆï¼Ÿ</strong></p>
<p>Aï¼šJobFlow æ˜¯è½»é‡çº§æ¡†æ¶ï¼Œä¸æä¾›ï¼š</p>
<ul>
<li>Web ç®¡ç†åå°ï¼ˆé€šè¿‡æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶ç®¡ç†,åæœŸè€ƒè™‘è¡¥ä¸Šï¼‰</li>
<li>å¯è§†åŒ–ç›‘æ§é¢æ¿ï¼ˆå¤ç”¨ Prometheus + Grafanaï¼‰</li>
<li>ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼ˆä¸“æ³¨äºåˆ†ç‰‡å¹¶è¡Œï¼‰</li>
</ul>
<p>JobFlow çš„å®šä½æ˜¯ï¼šåœ¨ Nacos ä½“ç³»ä¸‹ï¼Œæä¾›é›¶é¢å¤–ä¾èµ–çš„è°ƒåº¦èƒ½åŠ›ã€‚</p>
<p><strong>Q6ï¼šå·¡æ£€é¢‘ç‡æ˜¯å¤šå°‘ï¼Ÿä¼šä¸ä¼šæ¼æ‰ä»»åŠ¡ï¼Ÿ</strong></p>
<p>Aï¼šåˆ†ç‰‡å·¡æ£€ 3 åˆ†é’Ÿä¸€æ¬¡ï¼Œä½é¢‘ä»»åŠ¡å·¡æ£€ 10 åˆ†é’Ÿä¸€æ¬¡ã€‚æ­£å¸¸æµç¨‹æ˜¯ç§’çº§å“åº”ï¼Œå·¡æ£€åªæ˜¯å…œåº•ã€‚å®æµ‹æ¼è°ƒç‡ &lt; 0.01%ã€‚</p>
<h2 data-id="heading-23">ä¹ã€æ€»ç»“</h2>
<p><strong>JobFlow æ— é”è°ƒåº¦çš„æ ¸å¿ƒï¼š</strong></p>
<ol>
<li><strong>Hash åˆ†åŒº + Owner åˆ¤å®š</strong>ï¼šæ¯ä¸ªå®ä¾‹è‡ªå·±ç®—å‡ºè¯¥ä¸è¯¥æ‰§è¡Œï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹æ— å†²çª</li>
<li><strong>æ•°æ®åº“å…œåº•</strong>ï¼šå”¯ä¸€ç´¢å¼•ä¿æŠ¤ï¼Œå¤„ç†æç«¯æƒ…å†µ</li>
<li><strong>å¿«é€Ÿåˆ‡æ¢</strong>ï¼šå®ä¾‹ä¸‹çº¿ 15-20 ç§’å†…è‡ªåŠ¨åˆ‡æ¢ï¼Œæ¯”ä¼ ç»Ÿæ–¹æ¡ˆå¿« 8-10 å€</li>
<li><strong>æ€§èƒ½æå‡</strong>ï¼šæ•°æ®åº“å‹åŠ›é™ä½ 67%ï¼ŒCPU ä½¿ç”¨ç‡æ˜¾è‘—é™ä½</li>
</ol>
<p><strong>è®¾è®¡ç†å¿µï¼š</strong></p>
<p>JobFlow çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼š<strong>å¤ç”¨ä¼˜äºé‡é€ ï¼Œè½»é‡çº§ä¼˜å…ˆ</strong></p>
<ul>
<li>å¤ç”¨ Nacos æœåŠ¡å‘ç°ï¼Œä¸é‡å¤é€ è½®å­</li>
<li>å¤ç”¨ HTTP è°ƒç”¨ï¼Œæ— éœ€è‡ªå®šä¹‰åè®®</li>
<li>å¤ç”¨ç›‘æ§æ—¥å¿—ä½“ç³»ï¼Œé›¶é¢å¤–æˆæœ¬</li>
<li>æ•°æ®åº“å…œåº•ï¼Œæ— éœ€å¼•å…¥åˆ†å¸ƒå¼é”</li>
<li>å·¡æ£€è¡¥å¿ï¼Œé«˜æ€§ä»·æ¯”å®¹é”™</li>
</ul>
<p><strong>é‡è¦æé†’ï¼š</strong></p>
<p>è¿™æ˜¯"æ— é”è®¾è®¡"ï¼Œè€Œä¸æ˜¯çœŸçš„å®Œå…¨æ— é”ã€‚æˆ‘ä»¬è¿½æ±‚çš„æ˜¯ï¼š</p>
<ul>
<li>æ­£å¸¸æƒ…å†µä¸‹é«˜æ•ˆï¼ˆHash åˆ†åŒºï¼‰</li>
<li>æç«¯æƒ…å†µä¸‹å¯é ï¼ˆæ•°æ®åº“å…œåº• + å·¡æ£€è¡¥å¿ï¼‰</li>
</ul>
<p><strong>é—ç•™é—®é¢˜ï¼š</strong></p>
<p>æ— é”è°ƒåº¦è§£å†³äº†é‡å¤æ‰§è¡Œçš„é—®é¢˜ï¼Œä½†å¸¦æ¥äº†æ–°é—®é¢˜ï¼š<strong>æ¼è°ƒæ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å·¡æ£€ä¸è¡¥å¿æœºåˆ¶</strong>ã€‚</p>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä¼šæ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>å¦‚ä½•æ£€æµ‹è¶…æ—¶ä»»åŠ¡</li>
<li>å¦‚ä½•æ™ºèƒ½ç¡®è®¤ä»»åŠ¡çŠ¶æ€ï¼ˆä¸æ˜¯ç®€å•çš„ timeout = å¤±è´¥ï¼‰</li>
<li>å¦‚ä½•è¡¥å¿ PENDING å’Œ RUNNING çš„åˆ†ç‰‡</li>
<li>å¦‚ä½•æ£€æµ‹ä½é¢‘ä»»åŠ¡çš„æ¼è°ƒï¼ˆå°æ—¶çº§ä»»åŠ¡ï¼‰</li>
</ul>
<p>æ•¬è¯·æœŸå¾…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»å¤¯åˆ°æ‹‰ï¼Œé”è¯„13ä¸ªJava Webæ¡†æ¶]]></title>    <link>https://juejin.cn/post/7585727457472593920</link>    <guid>https://juejin.cn/post/7585727457472593920</guid>    <pubDate>2025-12-21T13:06:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472593920" data-draft-id="7585693761532805154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»å¤¯åˆ°æ‹‰ï¼Œé”è¯„13ä¸ªJava Webæ¡†æ¶"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-21T13:06:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åªå«ç…¤çƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/1732486058745054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»å¤¯åˆ°æ‹‰ï¼Œé”è¯„13ä¸ªJava Webæ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486058745054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åªå«ç…¤çƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T13:06:52.000Z" title="Sun Dec 21 2025 13:06:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å…ˆå ä¸ªç”² ğŸ¤£</h2>
<p>ä»¥ä¸‹è¯„ä»·åŸºäºæŠ€æœ¯ç‰¹æ€§ã€ç”Ÿæ€æˆç†Ÿåº¦ã€å¸‚åœºé‡‡ç”¨æƒ…å†µç­‰å®¢è§‚ç»´åº¦ï¼Œä¸ä»£è¡¨å¯¹ä»»ä½•æ¡†æ¶çš„è´¬ä½ã€‚</p>
<p>æŠ€æœ¯é€‰å‹åº”æ ¹æ®å…·ä½“åœºæ™¯ï¼Œæ²¡æœ‰é“¶å¼¹ã€‚</p>
<p>ä¸åŒé¡¹ç›®æœ‰ä¸åŒéœ€æ±‚ï¼Œåˆé€‚çš„æ‰æ˜¯æœ€å¥½çš„ã€‚</p>
<h2 data-id="heading-1">è¯„ä»·ç»´åº¦è¯´æ˜</h2>
<ol>
<li><strong>æ€§èƒ½è¡¨ç°</strong>ï¼šååé‡ã€å“åº”æ—¶é—´ã€èµ„æºå ç”¨</li>
<li><strong>ç”Ÿæ€æˆç†Ÿåº¦</strong>ï¼šç¤¾åŒºæ´»è·ƒåº¦ã€æ–‡æ¡£è´¨é‡ã€ç¬¬ä¸‰æ–¹åº“æ”¯æŒ</li>
<li><strong>å­¦ä¹ æ›²çº¿</strong>ï¼šä¸Šæ‰‹éš¾åº¦ã€æ¦‚å¿µå¤æ‚åº¦</li>
<li><strong>å¼€å‘æ•ˆç‡</strong>ï¼šä»£ç é‡ã€å¼€å‘é€Ÿåº¦ã€ç»´æŠ¤æˆæœ¬</li>
<li><strong>ä¼ä¸šé‡‡ç”¨åº¦</strong>ï¼šå¸‚åœºå æœ‰ç‡ã€å¤§å‚ä½¿ç”¨æƒ…å†µ</li>
<li><strong>åˆ›æ–°æ€§</strong>ï¼šæŠ€æœ¯å…ˆè¿›æ€§ã€æ¶æ„ç†å¿µ</li>
</ol>
<h2 data-id="heading-2">ğŸ”¥ å¤¯ï¼ˆé¡¶æµï¼Œç¡¬é€šè´§ï¼‰</h2>
<h3 data-id="heading-3"><strong>Spring Boot</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šJava Webæ¡†æ¶çš„ç»å¯¹éœ¸ä¸»ï¼Œåœ¨Azulã€ŠState of Java 2025ã€‹è°ƒç ”ä¸­ï¼Œå¾®æœåŠ¡æ¡†æ¶é‡Œ Spring Boot ä½¿ç”¨ç‡ä¸º <strong>42%</strong> ï¼ˆä»å±…é¦–ï¼‰ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevclass.com%2F2025%2F01%2F30%2Fstate-of-java-report-shows-strong-migration-from-java-8-rise-of-apache-spark%2F" title="https://devclass.com/2025/01/30/state-of-java-report-shows-strong-migration-from-java-8-rise-of-apache-spark/" target="_blank" ref="nofollow noopener noreferrer">DEVCLASS</a>)</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šçº¦å®šä¼˜äºé…ç½®ã€è‡ªåŠ¨è£…é…æœºåˆ¶ã€å¾®æœåŠ¡å…¨å®¶æ¡¶ï¼ˆSpring Cloudï¼‰ã€æ–‡æ¡£æå…¶å®Œå–„ã€æ‹›äººå®¹æ˜“</li>
<li><strong>é€‚ç”¨</strong>ï¼šä¼ä¸šçº§åº”ç”¨ã€å¾®æœåŠ¡æ¶æ„ã€ä»»ä½•éœ€è¦ç¨³å®šæ€§çš„åœºæ™¯</li>
<li><strong>å®¢è§‚æ•°æ®</strong>ï¼šGitHub <strong>79k+</strong> starsï¼ŒStack Overflow <strong>spring-boot</strong> æ ‡ç­¾é—®é¢˜æ•° <strong>150,650</strong> (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fspring-projects%2Fspring-boot%3Futm_source%3Dchatgpt.com" title="https://github.com/spring-projects/spring-boot?utm_source=chatgpt.com" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</li>
</ul>
<h2 data-id="heading-4">ğŸ’ é¡¶çº§ï¼ˆä¸€çº¿æˆ˜åŠ›ï¼Œèƒ½æ‰“ï¼‰</h2>
<h3 data-id="heading-5"><strong>Quarkus</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šäº‘åŸç”Ÿæ—¶ä»£çš„æ–°è´µï¼Œå¯åŠ¨é€Ÿåº¦å’Œå†…å­˜å ç”¨åŠæ‰“ä¼ ç»Ÿæ¡†æ¶</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šåŸç”Ÿæ”¯æŒGraalVMï¼Œå†·å¯åŠ¨æ¯«ç§’çº§ï¼Œå®¹å™¨åŒ–åœºæ™¯å®Œç¾é€‚é…ï¼Œå¼€å‘ä½“éªŒæ¥è¿‘Spring Boot</li>
<li><strong>é€‚ç”¨</strong>ï¼šKubernetesç¯å¢ƒã€Serverlessã€å¾®æœåŠ¡ã€è¿½æ±‚æè‡´æ€§èƒ½</li>
<li><strong>å®¢è§‚æ•°æ®</strong>ï¼šå¯åŠ¨æ—¶é—´ <strong>0.049sï¼ˆQuarkus Nativeï¼‰ vs Spring Boot JVM 1.909s</strong>ï¼ŒMax RSS <strong>70.5MB vs 388.9MBï¼ˆçº¦å‡å°‘82%ï¼‰</strong> (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgillius.org%2Fblog%2F2025%2F10%2Fjava-25-framework-startup.html" title="https://gillius.org/blog/2025/10/java-25-framework-startup.html" target="_blank" ref="nofollow noopener noreferrer">gillius.org</a>)</li>
</ul>
<h3 data-id="heading-6"><strong>Micronaut</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šç¼–è¯‘æ—¶ä¾èµ–æ³¨å…¥ï¼Œæ€§èƒ½ä¼˜ç§€ï¼Œæ— åå°„å¼€é”€</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¯åŠ¨å¿«ã€å†…å­˜ä½ã€æ”¯æŒGraalVMã€å“åº”å¼ç¼–ç¨‹å‹å¥½</li>
<li><strong>é€‚ç”¨</strong>ï¼šå¾®æœåŠ¡ã€äº‘åŸç”Ÿåº”ç”¨ã€æ€§èƒ½æ•æ„Ÿåœºæ™¯</li>
<li><strong>å®¢è§‚æ•°æ®</strong>ï¼šå¯åŠ¨æ—¶é—´ <strong>0.656sï¼ˆMicronaut JVMï¼‰ vs Spring Boot JVM 1.909sï¼ˆçº¦å¿«2.9å€ï¼‰</strong> ï¼ŒMax RSS <strong>253.2MB vs 388.9MBï¼ˆçº¦å°‘35%ï¼‰</strong> (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgillius.org%2Fblog%2F2025%2F10%2Fjava-25-framework-startup.html" title="https://gillius.org/blog/2025/10/java-25-framework-startup.html" target="_blank" ref="nofollow noopener noreferrer">gillius.org</a>)</li>
</ul>
<h3 data-id="heading-7"><strong>Vert.x</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šå¼‚æ­¥éé˜»å¡çš„ç¡¬æ ¸æ¡†æ¶ï¼Œé«˜å¹¶å‘åœºæ™¯ç‹è€…</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šäº‹ä»¶é©±åŠ¨ã€Reactoræ¨¡å¼ã€æ€§èƒ½æè‡´ã€æ”¯æŒå¤šè¯­è¨€</li>
<li><strong>é€‚ç”¨</strong>ï¼šé«˜å¹¶å‘ã€å®æ—¶ç³»ç»Ÿã€WebSocketã€IoT</li>
<li><strong>å®¢è§‚æ•°æ®</strong>ï¼šTechEmpower Framework Benchmarks çš„å…¬å¼€ç»“æœç›®å½•ä¸­æŒç»­åŒ…å« <strong>vertx/</strong> ã€<strong>vertx-web/</strong> ç­‰å®ç° (<a href="https://link.juejin.cn?target=https%3A%2F%2Ftfb-status.techempower.com%2Funzip%2Fresults.2025-02-05-22-40-37-331.zip%2Fresults%2F20250130184741" title="https://tfb-status.techempower.com/unzip/results.2025-02-05-22-40-37-331.zip/results/20250130184741" target="_blank" ref="nofollow noopener noreferrer">tfb-status.techempower.com</a>)</li>
</ul>
<h2 data-id="heading-8">ğŸ‘¤ äººä¸Šäººï¼ˆæœ‰ç‰¹è‰²ï¼Œèƒ½ç«‹è¶³ï¼‰</h2>
<h3 data-id="heading-9"><strong>Helidon</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šOracleå‡ºå“ï¼ŒMicroProfileæ ‡å‡†å®ç°ï¼Œè½»é‡çº§å¾®æœåŠ¡æ¡†æ¶</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ã€å“åº”å¼æ”¯æŒã€GraalVMåŸç”Ÿã€æ–‡æ¡£è§„èŒƒ</li>
<li><strong>é€‚ç”¨</strong>ï¼šå¾®æœåŠ¡ã€äº‘åŸç”Ÿã€åå¥½æ ‡å‡†åŒ–çš„å›¢é˜Ÿ</li>
<li><strong>å¸‚åœº</strong>ï¼šçŸ¥ååº¦ä¸å¦‚å‰é¢å‡ ä½ï¼Œä½†æŠ€æœ¯æ‰å®</li>
</ul>
<h3 data-id="heading-10"><strong>Javalin</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šæç®€ä¸»ä¹‰ï¼ŒKotlinå’ŒJavaéƒ½å¥½ç”¨çš„è½»é‡çº§æ¡†æ¶</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå­¦ä¹ æ›²çº¿å¹³ç¼“ã€ä»£ç ç®€æ´ã€æ€§èƒ½ä¸é”™ã€é€‚åˆå°å‹é¡¹ç›®</li>
<li><strong>é€‚ç”¨</strong>ï¼šRESTful APIã€åŸå‹å¼€å‘ã€æ•™å­¦é¡¹ç›®</li>
<li><strong>å®šä½</strong>ï¼šç±»ä¼¼Node.jsçš„Expressï¼Œä½†ç”Ÿæ€æ¯”ä¸ä¸ŠSpringç³»</li>
</ul>
<h3 data-id="heading-11"><strong>Dropwizard</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šè€ç‰Œå¾®æœåŠ¡æ¡†æ¶ï¼Œæ•´åˆäº†Jettyã€Jerseyã€Jacksonç­‰æˆç†Ÿç»„ä»¶</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¼€ç®±å³ç”¨ã€è¿ç»´å‹å¥½ï¼ˆå†…ç½®Metricsï¼‰ã€ç¨³å®šå¯é </li>
<li><strong>é€‚ç”¨</strong>ï¼šRESTfulæœåŠ¡ã€éœ€è¦å¿«é€Ÿä¸Šçº¿çš„é¡¹ç›®</li>
<li><strong>ç°çŠ¶</strong>ï¼šæ›¾ç»è¾‰ç…Œï¼Œç°åœ¨è¢«Spring Bootå’Œæ–°ç§€æŒ¤å‹</li>
</ul>
<h2 data-id="heading-12">ğŸ¤– NPCï¼ˆèƒ½ç”¨ï¼Œä½†ä¸å¤Ÿå‡ºå½©ï¼‰</h2>
<h3 data-id="heading-13"><strong>Play Framework</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šScala/JavaåŒæ –ï¼Œå“åº”å¼æ¶æ„ï¼Œä½†Javaç”Ÿæ€é‡Œå­˜åœ¨æ„Ÿå¼±</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¼‚æ­¥éé˜»å¡ã€çƒ­é‡è½½ã€RESTfulå‹å¥½</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šå­¦ä¹ æ›²çº¿é™¡ã€ç¤¾åŒºä¸å¦‚Scalaåœˆæ´»è·ƒã€Javaä½¿ç”¨è€…å°‘</li>
<li><strong>å®šä½</strong>ï¼šæ›´é€‚åˆScalaå¼€å‘è€…</li>
</ul>
<h3 data-id="heading-14"><strong>Grails</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šåŸºäºGroovyçš„å…¨æ ˆæ¡†æ¶ï¼Œçº¦å®šä¼˜äºé…ç½®</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¼€å‘é€Ÿåº¦å¿«ã€é€‚åˆå¿«é€ŸåŸå‹</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šGroovyæœ¬èº«å°ä¼—ã€æ€§èƒ½ä¸€èˆ¬ã€ä¼ä¸šé‡‡ç”¨åº¦ä½</li>
<li><strong>ç°çŠ¶</strong>ï¼šè¢«Spring Bootå…¨é¢æ›¿ä»£</li>
</ul>
<h3 data-id="heading-15"><strong>Apache Wicket</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šç»„ä»¶åŒ–Webæ¡†æ¶ï¼Œé¢å‘å¯¹è±¡æ€ç»´</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šä¸éœ€è¦å†™JavaScriptã€é€‚åˆä¼ ç»ŸJavaå¼€å‘è€…</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šå‰åç«¯ä¸åˆ†ç¦»çš„æ€è·¯å·²è¿‡æ—¶ã€å­¦ä¹ èµ„æºå°‘</li>
<li><strong>ç°çŠ¶</strong>ï¼šç»´æŠ¤çŠ¶æ€ï¼Œæ–°é¡¹ç›®å¾ˆå°‘é€‰æ‹©</li>
</ul>
<h2 data-id="heading-16">ğŸ’€ æ‹‰å®Œäº†ï¼ˆæ—¶ä»£çš„çœ¼æ³ªï¼‰</h2>
<h3 data-id="heading-17"><strong>Struts 2</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šæ›¾ç»çš„ç‹è€…ï¼Œç°åœ¨å·²æ˜¯æ˜æ—¥é»„èŠ±</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šå®‰å…¨æ¼æ´é¢‘å‘ã€æ¶æ„è€æ—§ã€ç¤¾åŒºåŸºæœ¬åœæ»</li>
<li><strong>ç°çŠ¶</strong>ï¼šåªåœ¨è€é¡¹ç›®ç»´æŠ¤ï¼Œæ–°é¡¹ç›®ç¦æ­¢ä½¿ç”¨</li>
<li><strong>å†å²åœ°ä½</strong>ï¼šSSHä¸‰å‰‘å®¢ä¹‹ä¸€ï¼Œä½†å·²è¢«æ·˜æ±°</li>
</ul>
<h3 data-id="heading-18"><strong>JSF (JavaServer Faces)</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šJava EEæ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œä½†ä½“éªŒç³Ÿç³•</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šç¬¨é‡ã€å¼€å‘æ•ˆç‡ä½ã€å‰åç«¯è€¦åˆä¸¥é‡</li>
<li><strong>ç°çŠ¶</strong>ï¼šé™¤äº†æŸäº›æ”¿åºœ/é“¶è¡Œè€ç³»ç»Ÿï¼ŒåŸºæœ¬æ— äººé—®æ´¥</li>
</ul>
<h3 data-id="heading-19"><strong>åŸç”ŸServlet + JSP</strong></h3>
<ul>
<li><strong>ç†ç”±</strong>ï¼šåŸå§‹æŠ€æœ¯æ ˆï¼Œçº¯æ‰‹æ“</li>
<li><strong>åŠ£åŠ¿</strong>ï¼šå•¥éƒ½è¦è‡ªå·±å†™ï¼Œæ•ˆç‡æä½ï¼Œç»´æŠ¤å›°éš¾</li>
<li><strong>ç°çŠ¶</strong>ï¼šåªé€‚åˆæ•™å­¦å’Œé¢è¯•å…«è‚¡æ–‡</li>
</ul>
<h2 data-id="heading-20">ç›´æ¥çœ‹ç»“æœ</h2>









































<table><thead><tr><th>åˆ†å±‚</th><th>æ¡†æ¶</th><th>æ¡†æ¶</th><th>æ¡†æ¶</th></tr></thead><tbody><tr><td>å¤¯</td><td>Spring Boot</td><td/><td/></tr><tr><td>é¡¶çº§</td><td>Quarkus</td><td>Micronaut</td><td>Vert.x</td></tr><tr><td>äººä¸Šäºº</td><td>Helidon</td><td>Javalin</td><td>Dropwizard</td></tr><tr><td>NPC</td><td>Play Framework</td><td>Grails</td><td>Apache Wicket</td></tr><tr><td>æ‹‰å®Œäº†</td><td>Struts 2</td><td>JSF (JavaServer Faces)</td><td>åŸç”ŸServlet + JSP</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C# æ­£åˆ™è¡¨è¾¾å¼ï¼šé‡è¯ä¸é”šç‚¹â€”â€”ä»â€œ.*â€åˆ°ç²¾ç¡®åŒ¹é…]]></title>    <link>https://juejin.cn/post/7585645111876141083</link>    <guid>https://juejin.cn/post/7585645111876141083</guid>    <pubDate>2025-12-21T13:59:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585645111876141083" data-draft-id="7585474459776139300" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C# æ­£åˆ™è¡¨è¾¾å¼ï¼šé‡è¯ä¸é”šç‚¹â€”â€”ä»â€œ.*â€åˆ°ç²¾ç¡®åŒ¹é…"/> <meta itemprop="keywords" content="å‰ç«¯,C#,æ­£åˆ™è¡¨è¾¾å¼"/> <meta itemprop="datePublished" content="2025-12-21T13:59:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çƒ›é˜´"/> <meta itemprop="url" content="https://juejin.cn/user/950397795841032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C# æ­£åˆ™è¡¨è¾¾å¼ï¼šé‡è¯ä¸é”šç‚¹â€”â€”ä»â€œ.*â€åˆ°ç²¾ç¡®åŒ¹é…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/950397795841032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çƒ›é˜´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T13:59:25.000Z" title="Sun Dec 21 2025 13:59:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é‡è¯ï¼šå‘Šè¯‰å¼•æ“â€œè¦é‡å¤å¤šå°‘æ¬¡â€</h2>
<p>é‡è¯å‡ºç°åœ¨ä¸€ä¸ªâ€œå•å…ƒâ€åé¢ï¼Œè¡¨ç¤ºè¿™ä¸ªå•å…ƒè¦é‡å¤å¤šå°‘æ¬¡ã€‚</p>
<p>å•å…ƒå¯ä»¥æ˜¯ï¼š</p>
<ul>
<li>ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼š<code>a</code></li>
<li>ä¸€ä¸ªå­—ç¬¦ç±»ï¼š<code>\d</code>ã€<code>[A-Z]</code></li>
<li>ä¸€ä¸ªåˆ†ç»„ï¼š<code>(ab)</code></li>
</ul>
<h3 data-id="heading-1">1. å¸¸è§é‡è¯ä¸€è§ˆ</h3>
<ul>
<li><code>?</code>ï¼š0 æˆ– 1 æ¬¡</li>
<li><code>*</code>ï¼š0 æ¬¡æˆ–å¤šæ¬¡</li>
<li><code>+</code>ï¼š1 æ¬¡æˆ–å¤šæ¬¡</li>
<li><code>{n}</code>ï¼šæ°å¥½ n æ¬¡</li>
<li><code>{n,}</code>ï¼šè‡³å°‘ n æ¬¡</li>
<li><code>{n,m}</code>ï¼šn åˆ° m æ¬¡ä¹‹é—´</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System.Text.RegularExpressions;

<span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"^\d{3,5}$"</span>; 
<span class="hljs-built_in">bool</span> ok = Regex.IsMatch(<span class="hljs-string">"1234"</span>, pattern); <span class="hljs-comment">// True</span>
</code></pre>
<h3 data-id="heading-2">2. é‡è¯æ˜¯ä½œç”¨åœ¨â€œå‰ä¸€é¡¹â€ä¸Šçš„</h3>
<p>æ³¨æ„ï¼š<code>ab+</code> åªä¼šæŠŠ <code>+</code> ä½œç”¨åˆ° <code>b</code> ä¸Šï¼š</p>
<ul>
<li>æ¨¡å¼ï¼š<code>ab+</code>
<ul>
<li>åŒ¹é…ï¼š"ab"ã€"abb"ã€"abbbb"...</li>
</ul>
</li>
<li>æ¨¡å¼ï¼š<code>(ab)+</code>
<ul>
<li>åŒ¹é…ï¼š"ab"ã€"abab"ã€"ababab"...</li>
</ul>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ æƒ³å¯¹ä¸€â€œä¸²â€ä¸œè¥¿ä½¿ç”¨é‡è¯ï¼Œä¸€å®šè¦ç”¨æ‹¬å·åˆ†ç»„ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€è´ªå©ª vs æ‡’æƒ°ï¼š<code>*</code> å’Œ <code>*?</code> çš„æ ¹æœ¬åŒºåˆ«</h2>
<blockquote>
<p>é‡è¯åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯â€œè´ªå©ªâ€çš„ï¼š</p>
</blockquote>
<ul>
<li>åœ¨ä¸å½±å“åŒ¹é…æˆåŠŸçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å¤šåœ°åƒå­—ç¬¦ã€‚</li>
</ul>
<h3 data-id="heading-4">1. è´ªå©ªåŒ¹é…ï¼š<code>.*</code></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> input = <span class="hljs-string">"&lt;tag&gt;content&lt;/tag&gt;&lt;tag&gt;more&lt;/tag&gt;"</span>;
<span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"&lt;tag&gt;.*&lt;/tag&gt;"</span>;

Match m = Regex.Match(input, pattern);
Console.WriteLine(m.Value);
</code></pre>
<p><strong>åŒ¹é…ç»“æœï¼š</strong></p>
<pre><code class="hljs language-text" lang="text">&lt;tag&gt;content&lt;/tag&gt;&lt;tag&gt;more&lt;/tag&gt;
</code></pre>
<ul>
<li><code>.*</code> ä¼šå°½å¯èƒ½å¤šåœ°åƒå­—ç¬¦ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ <code>&lt;/tag&gt;</code>ã€‚</li>
</ul>
<h3 data-id="heading-5">2. æ‡’æƒ°åŒ¹é…ï¼š<code>.*?</code></h3>
<p>åœ¨é‡è¯åé¢å†åŠ ä¸€ä¸ª <code>?</code>ï¼Œå°±å˜æˆâ€œæ‡’æƒ°â€(<strong>å³æœ€å¤šæ»¡è¶³ä¸€æ¬¡</strong>)ï¼š</p>
<ul>
<li><code>*?</code>ï¼šå°½å¯èƒ½å°‘çš„ 0 æ¬¡æˆ–å¤šæ¬¡</li>
<li><code>+?</code>ï¼šå°½å¯èƒ½å°‘çš„ 1 æ¬¡æˆ–å¤šæ¬¡</li>
<li><code>??</code>ï¼šå°½å¯èƒ½å°‘çš„ 0 æˆ– 1 æ¬¡</li>
<li><code>{n,m}?</code>ï¼šåœ¨ n~m ä¹‹é—´ï¼Œå°½é‡å°‘</li>
</ul>
<p>æ”¹å†™ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"&lt;tag&gt;.*?&lt;/tag&gt;"</span>;

Match m = Regex.Match(input, pattern);
Console.WriteLine(m.Value);
</code></pre>
<p>åŒ¹é…ç»“æœï¼š</p>
<pre><code class="hljs language-text" lang="text">&lt;tag&gt;content&lt;/tag&gt;
</code></pre>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ç”¨é‡è¯å†™å‡ ä¸ªå¸¸è§â€œæ ¼å¼â€ï¼š</h2>
<h3 data-id="heading-7">1. ç®€å•æ—¥æœŸï¼šyyyy-MM-dd</h3>
<pre><code class="hljs language-regex" lang="regex">^\d{4}-\d{2}-\d{2}$
</code></pre>
<ul>
<li>ä¸è€ƒè™‘åˆæ³•æ€§ï¼Œåªçœ‹æ ¼å¼</li>
</ul>
<h3 data-id="heading-8">2. ç”¨æˆ·åï¼šå­—æ¯å¼€å¤´ï¼Œåé¢ 3~15 ä½å­—æ¯æ•°å­—ä¸‹åˆ’çº¿</h3>
<pre><code class="hljs language-regex" lang="regex">^[A-Za-z]\w{3,15}$
</code></pre>
<ul>
<li><code>[A-Za-z]</code>ï¼šé¦–å­—ç¬¦å¿…é¡»æ˜¯å­—æ¯</li>
<li><code>\w{3,15}</code>ï¼šåé¢ 3~15 ä¸ªå­—æ¯æ•°å­—ä¸‹åˆ’çº¿</li>
<li>æ€»é•¿åº¦ï¼š4~16</li>
</ul>
<p>C#ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"^[A-Za-z]\w{3,15}$"</span>;
<span class="hljs-built_in">bool</span> ok = Regex.IsMatch(<span class="hljs-string">"User_001"</span>, pattern);
</code></pre>
<h3 data-id="heading-9">3. æ•´æ•°å’Œå°æ•°</h3>
<p>ç®€å•ç‰ˆæœ¬çš„â€œéè´Ÿæ•´æ•°æˆ–å°æ•°â€ï¼š</p>
<pre><code class="hljs language-regex" lang="regex">^\d+(\.\d+)?$
</code></pre>
<ul>
<li><code>\d+</code>ï¼šè‡³å°‘ä¸€ä½æ•°å­—</li>
<li><code>(\.\d+)?</code>ï¼šå¯é€‰çš„å°æ•°éƒ¨åˆ†ï¼ˆ<code>.</code> + è‡³å°‘ä¸€ä½æ•°å­—ï¼‰</li>
</ul>
<p>åŒ¹é…ï¼š<code>0</code>ã€<code>123</code>ã€<code>3.14</code>ã€<code>0.5</code>
ä¸åŒ¹é…ï¼š<code>.</code>ã€<code>.5</code>ã€<code>3.</code>ï¼ˆå¦‚æœä½ æƒ³æ”¾å®½ï¼Œå¯ä»¥è°ƒæ•´ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€é”šç‚¹ï¼šå†³å®šâ€œåŒ¹é…çš„æ˜¯ä¸æ˜¯æ•´ä¸²â€</h2>
<p>é”šç‚¹ï¼ˆAnchorï¼‰æ˜¯ä¸€ç±»ç‰¹æ®Šçš„â€œé›¶å®½â€åŒ¹é…ï¼ŒåªåŒ¹é…â€œä½ç½®â€ï¼Œä¸æ¶ˆè€—å­—ç¬¦ã€‚</p>
<p>1ï¼‰<code>^</code>ï¼šå¼€å¤´ï¼Œ<code>$</code>ï¼šç»“å°¾</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li><code>^</code> åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ï¼›</li>
<li><code>$</code> åŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-regex" lang="regex">^abc      // åŒ¹é…ä»¥ "abc" å¼€å¤´çš„å­—ç¬¦ä¸²
abc$      // åŒ¹é…ä»¥ "abc" ç»“å°¾çš„å­—ç¬¦ä¸²
^abc$     // å­—ç¬¦ä¸²åªèƒ½æ˜¯ "abc"
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp">Regex.IsMatch(<span class="hljs-string">"abc123"</span>, <span class="hljs-string">@"^abc"</span>);   <span class="hljs-comment">// True</span>
Regex.IsMatch(<span class="hljs-string">"123abc"</span>, <span class="hljs-string">@"abc$"</span>);   <span class="hljs-comment">// True</span>
Regex.IsMatch(<span class="hljs-string">"xabcx"</span>, <span class="hljs-string">@"^abc$"</span>);   <span class="hljs-comment">// False</span>
</code></pre>
<h3 data-id="heading-11">2. è¡¨å•æ ¡éªŒä¸€å®šè¦å†™ <code>^</code> å’Œ <code>$</code></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä¸ä¸¥è°¨</span>
Regex.IsMatch(<span class="hljs-string">"abc2025-12-18xyz"</span>, <span class="hljs-string">@"\d{4}-\d{2}-\d{2}"</span>); 
<span class="hljs-comment">// Trueï¼Œåªè¦â€œåŒ…å«â€ç¬¦åˆæ ¼å¼çš„å­ä¸²å°±é€šè¿‡</span>

<span class="hljs-comment">// ä¸¥è°¨</span>
Regex.IsMatch(<span class="hljs-string">"abc2025-12-18xyz"</span>, <span class="hljs-string">@"^\d{4}-\d{2}-\d{2}$"</span>);
<span class="hljs-comment">// Falseï¼Œæ•´ä¸ªå­—ç¬¦ä¸²ä¸æ˜¯å®Œæ•´æ—¥æœŸ</span>
</code></pre>
<h3 data-id="heading-12">3. å­—ç¬¦ç±»é‡Œçš„ <code>^</code> æ„ä¹‰å®Œå…¨ä¸åŒ</h3>
<pre><code class="hljs language-regex" lang="regex">^abc        // é”šç‚¹ï¼šå¼€å¤´
[^abc]      // å–åï¼šåŒ¹é…ä»»ä½•ä¸æ˜¯aã€bã€cçš„å­—ç¬¦
</code></pre>
<ul>
<li><code>^</code> åœ¨ <code>[]</code> å¤–ï¼šå¼€å¤´é”šç‚¹</li>
<li><code>^</code> åœ¨ <code>[]</code> é‡Œä¸”åœ¨é¦–ä½ï¼šè¡¨ç¤ºâ€œå–åâ€ï¼Œæ–¹æ‹¬å·å†…çš„å­—ç¬¦ä»»æ„ç»„åˆçš„åé¢</li>
</ul>
<hr/>
<h2 data-id="heading-13">äº”ã€å•è¯è¾¹ç•Œï¼š<code>\b</code></h2>
<p><code>\b</code> æ˜¯â€œå•è¯è¾¹ç•Œâ€ï¼ˆword boundaryï¼‰ï¼ŒåŒ¹é…â€œä»ä¸€ä¸ª <code>\w</code> å­—ç¬¦åˆ°ä¸€ä¸ªé <code>\w</code> å­—ç¬¦çš„è¾¹ç•Œâ€ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> text = <span class="hljs-string">"cat scat category"</span>;
<span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"\bcat\b"</span>;

MatchCollection matches = Regex.Matches(text, pattern);
<span class="hljs-keyword">foreach</span> (Match m <span class="hljs-keyword">in</span> matches)
{
    Console.WriteLine(m.Value);
}
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-text" lang="text">cat
</code></pre>
<p>è§£æï¼š</p>
<ul>
<li><code>"cat"</code> å‰åéƒ½æ˜¯è¾¹ç•Œï¼ˆå·¦è¾¹æ˜¯å¼€å¤´ï¼Œå³è¾¹æ˜¯ç©ºæ ¼ï¼‰ï¼Œæ»¡è¶³ <code>\b</code>ã€‚</li>
<li><code>"scat"</code> ä¸­çš„ <code>cat</code> å·¦è¾¹æ˜¯ <code>s</code>ï¼Œå±äº <code>\w</code>ï¼Œä¸ä¼šè¢« <code>\bcat\b</code> åŒ¹é…ã€‚</li>
<li><code>"category"</code> ä¸­çš„ <code>cat</code> å³è¾¹æ˜¯ <code>e</code>ï¼Œä¹Ÿæ˜¯ <code>\w</code>ï¼Œä¹Ÿä¸ç¬¦åˆã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-14">å…­ã€å¤šè¡Œæ¨¡å¼ï¼ˆMultilineï¼‰ä¸å•è¡Œæ¨¡å¼ï¼ˆSinglelineï¼‰</h2>
<p>C# ä¸­ç”¨ <code>RegexOptions</code> å¯ä»¥æ§åˆ¶ <code>^</code> / <code>$</code> å’Œ <code>.</code> çš„è¡Œä¸ºã€‚</p>
<h3 data-id="heading-15">1. <code>RegexOptions.Multiline</code>ï¼šå¤šè¡Œæ¨¡å¼</h3>
<p>é»˜è®¤æƒ…å†µï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> text = <span class="hljs-string">"first\nsecond\nthird"</span>;
<span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@"^second$"</span>;

Console.WriteLine(Regex.IsMatch(text, pattern)); <span class="hljs-comment">// False</span>
</code></pre>
<p>å› ä¸ºï¼š</p>
<ul>
<li><code>^</code> å’Œ <code>$</code> åœ¨é»˜è®¤æ¨¡å¼ä¸‹åªåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²èµ·å§‹å’Œç»“å°¾ï¼Œä¸ä¼šæ„ŸçŸ¥è¡Œã€‚</li>
</ul>
<p>å¤šè¡Œæ¨¡å¼å¼€å¯åï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">bool</span> ok = Regex.IsMatch(
    text,
    pattern,
    RegexOptions.Multiline
);
Console.WriteLine(ok); <span class="hljs-comment">// True</span>
</code></pre>
<p>æ­¤æ—¶ï¼š</p>
<ul>
<li><code>^</code> / <code>$</code> ä¼šåŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´/ç»“å°¾ï¼ˆä»¥ <code>\n</code> ä½œä¸ºæ¢è¡Œï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-16">2. <code>RegexOptions.Singleline</code>ï¼šå•è¡Œæ¨¡å¼ / DOTALL</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼š</p>
<ul>
<li><code>.</code> ä¸åŒ¹é…æ¢è¡Œç¬¦ã€‚</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> text = <span class="hljs-string">"line1\nline2"</span>;
<span class="hljs-built_in">string</span> pattern = <span class="hljs-string">@".*"</span>;

Match m1 = Regex.Match(text, pattern);
Console.WriteLine(m1.Value);    <span class="hljs-comment">// "line1"</span>
</code></pre>
<p>å¼€å¯ <code>Singleline</code> åï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">Match m2 = Regex.Match(text, pattern, RegexOptions.Singleline);
Console.WriteLine(m2.Value);    <span class="hljs-comment">// "line1\nline2"</span>
</code></pre>
<p>æ­¤æ—¶ï¼š</p>
<ul>
<li><code>.</code> ä¼šåŒ¹é…åŒ…æ‹¬æ¢è¡Œåœ¨å†…çš„ä»»ä½•å­—ç¬¦ã€‚</li>
</ul>
<p>æ€»ç»“ä¸€ä¸‹ï¼š</p>
<ul>
<li><code>Multiline</code>ï¼šå½±å“ <code>^</code> / <code>$</code>ï¼Œè®©å®ƒä»¬æ„ŸçŸ¥â€œè¡Œâ€</li>
<li><code>Singleline</code>ï¼šå½±å“ <code>.</code>ï¼Œè®© <code>.</code> èƒ½åŒ¹é…æ¢è¡Œ</li>
</ul>
<p>å®ƒä»¬å¯ä»¥ä¸€èµ·ç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> Regex(
    pattern,
    RegexOptions.Multiline | RegexOptions.Singleline
);
</code></pre>
<h2 data-id="heading-17">ç»“è¯­</h2>
<p><strong>ç‚¹ä¸ªèµï¼Œå…³æ³¨æˆ‘è·å–æ›´å¤šå®ç”¨ C# æŠ€æœ¯å¹²è´§ï¼å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œè®°å¾—æ”¶è—æœ¬æ–‡</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹]]></title>    <link>https://juejin.cn/post/7585758163435601926</link>    <guid>https://juejin.cn/post/7585758163435601926</guid>    <pubDate>2025-12-21T12:01:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435601926" data-draft-id="7585751355592507411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-21T12:01:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰å¤´è€çŸ³"/> <meta itemprop="url" content="https://juejin.cn/user/2963939077135006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»ç¡¬ç¼–ç åˆ° Schema æ¨æ–­ï¼šå‰ç«¯è¡¨å•å¼€å‘çš„å·¥ç¨‹åŒ–è½¬å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939077135006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰å¤´è€çŸ³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:01:14.000Z" title="Sun Dec 21 2025 12:01:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä½ çš„è¡¨å•ï¼Œæ˜¯å¦æ­£åœ¨å¤±æ§ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªâ€œä¼ä¸šè´·æ¬¾ç”³è¯·â€æˆ–â€œä¿é™©ç†èµ”â€ç³»ç»Ÿã€‚</p>
<p>æœ€åˆï¼Œé¡µé¢åªæœ‰ 5 ä¸ªå­—æ®µï¼Œä½ å†™å¾—ä¼˜é›…ä»å®¹ã€‚éšç€ä¸šåŠ¡è¿­ä»£ï¼Œè¡¨å•åƒå¹æ°”çƒä¸€æ ·è†¨èƒ€åˆ°äº† 50 å¤šä¸ªå­—æ®µï¼š <strong>â€œå¦‚æœç”¨æˆ·é€‰äº†â€˜ä¸ªä½“å·¥å•†æˆ·â€™ï¼Œä¸ä»…è¦éšè—â€˜ä¼ä¸šæ³•äººâ€™å­—æ®µï¼Œè¿˜å¾—å»åŠ¨æ€è¯·æ±‚â€˜ç»è¥åœ°â€™çš„ä¸‹æ‹‰åˆ—è¡¨ï¼ŒåŒæ—¶â€˜æ³¨å†Œèµ„æœ¬â€™çš„æ ¡éªŒè§„åˆ™è¿˜è¦ä»â€˜å¿…å¡«â€™å˜æˆâ€˜é€‰å¡«â€™â€¦â€¦â€</strong></p>
<p>äºæ˜¯ï¼Œä½ çš„ Vue æ–‡ä»¶å˜æˆäº†è¿™æ ·ï¼š</p>
<ul>
<li><code>&lt;template&gt;</code> é‡Œå¡æ»¡äº†æ·±å±‚åµŒå¥—çš„ <code>v-if</code> å’Œ <code>v-show</code>ã€‚</li>
<li><code>&lt;script&gt;</code> é‡Œåˆ°å¤„æ˜¯ç›‘å¬è”åŠ¨é€»è¾‘çš„ <code>watch</code> å’Œå†—é•¿çš„ <code>if-else</code>ã€‚</li>
<li><strong>æœ€ç—›è‹¦çš„æ˜¯ï¼š</strong> å½“åç«¯å†³å®šè°ƒæ•´å­—æ®µåï¼Œæˆ–è€…å…¬å¸è¦æ±‚æŠŠè¿™å¥—é€»è¾‘å¤ç”¨åˆ°å°ç¨‹åºæ—¶ï¼Œä½ å‘ç°é€»è¾‘å’Œ UI å·²ç»åƒéº»ç»³ä¸€æ ·æ­»æ­»ç¼ åœ¨ä¸€èµ·ï¼Œæ‹†ä¸å¼€äº†ã€‚</li>
</ul>
<p><strong>â€œéš¾é“å†™è¡¨å•ï¼ŒçœŸçš„åªèƒ½é ä½“åŠ›æ´»å—ï¼Ÿâ€</strong></p>
<p>ä¸ºäº†æ‘†è„±è¿™ç§ä½æ•ˆç‡é‡å¤ï¼Œæˆ‘ä»¬å°è¯•å°† <strong>ä¸­é—´ä»¶æ€æƒ³</strong> å¼•å…¥ Vue 3ï¼ŒæŠŠå¤æ‚çš„ä¸šåŠ¡è§„åˆ™ä» UI æ¡†æ¶ä¸­å‰¥ç¦»å‡ºæ¥ã€‚ä»Šå¤©ï¼Œæˆ‘å°±æŠŠè¿™å¥—â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„å¤ç”¨â€çš„å·¥ç¨‹åŒ–æ–¹æ¡ˆåˆ†äº«ç»™ä½ ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ æ ¸å¿ƒæ€æƒ³ï¼šè®©æ•°æ®è‡ªå¸¦â€œè¯´æ˜ä¹¦â€</h2>
<p>ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå‰ç«¯åƒæ˜¯ä¸€ä¸ª**â€œæ¬è¿å·¥â€ï¼šæ‹¿åˆ°åç«¯æ•°æ®ï¼Œæ‰‹åŠ¨åˆ¤æ–­å“ªä¸ªè¯¥æ˜¾ã€å“ªä¸ªè¯¥éšã€‚</p>
<p>è€Œå·¥ç¨‹åŒ–æ¨¡å¼ä¸‹ï¼Œå‰ç«¯æ›´åƒæ˜¯ä¸€ä¸ªâ€œç»„è£…å‚â€**ï¼šæ•°æ®åœ¨è¿›å…¥ UI å±‚ä¹‹å‰ï¼Œå…ˆç»è¿‡ä¸€å¥—â€œä¸­é—´ä»¶æµæ°´çº¿â€ï¼Œæ•°æ®ä¼šè¢«è‡ªåŠ¨æ ‡æ³¨ä¸Š UI æè¿°ä¿¡æ¯ï¼ˆSchemaï¼‰ã€‚</p>
<h3 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ Schema æ¨æ–­ï¼Ÿ</h3>
<p>æ•°æ®ä¸å†æ˜¯å†·å†°å†°çš„é”®å€¼å¯¹ï¼Œè€Œæ˜¯å˜æˆäº†ä¸€ä¸ªåŒ…å«â€œå…ƒæ•°æ®â€çš„å¯¹è±¡ã€‚é€šè¿‡ TypeScript çš„ç±»å‹æ¨æ–­ï¼Œæˆ‘ä»¬è®©æ•°æ®è‡ªå·±å‘Šè¯‰é¡µé¢ï¼š</p>
<ul>
<li>æˆ‘åº”è¯¥ç”¨ä»€ä¹ˆç»„ä»¶æ¸²æŸ“ï¼ˆ<code>componentType</code>ï¼‰</li>
<li>æˆ‘æ˜¯å¦åº”è¯¥è¢«æ˜¾ç¤ºï¼ˆ<code>visible</code>ï¼‰</li>
<li>æˆ‘ä¾èµ–å“ªäº›å­—æ®µï¼ˆ<code>dependencies</code>ï¼‰</li>
<li>æˆ‘çš„ä¸‹æ‹‰é€‰é¡¹å»å“ªé‡Œæ‹‰å–ï¼ˆ<code>request</code>ï¼‰</li>
</ul>
<h3 data-id="heading-3">2. UI æ¡†æ¶åªæ˜¯â€œçš®è‚¤â€</h3>
<p>æ—¢ç„¶é€»è¾‘éƒ½æŠ½ç¦»åˆ°äº†æ¡†æ¶æ— å…³çš„ä¸­é—´ä»¶é‡Œï¼Œé‚£ä¹ˆ UI å±‚æ— è®ºæ˜¯ç”¨ Ant Design è¿˜æ˜¯ Element Plusï¼Œéƒ½åªæ˜¯æ¢ä¸ªâ€œè§£æå™¨â€è€Œå·²ã€‚</p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€ å®æˆ˜ï¼šæ„å»º Vue 3 è‡ªåŠ¨åŒ–æ¸²æŸ“å¼•æ“</h2>
<h3 data-id="heading-5">1. ç»„ä»¶æ³¨å†Œè¡¨</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªç»„ä»¶æ˜ å°„è¡¨ï¼ŒæŠŠæŠ½è±¡çš„å­—ç¬¦ä¸²ç±»å‹æ˜ å°„ä¸ºå…·ä½“çš„ Vue ç»„ä»¶ã€‚</p>
<p>TypeScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src-vue/components/FormRenderer/componentRegistry.ts</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">NumberField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/NumberField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SelectField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/SelectField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TextField</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/TextField.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ModeToggle</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../FieldRenderers/ModeToggle.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> componentRegistry = {
  <span class="hljs-attr">number</span>: <span class="hljs-title class_">NumberField</span>,
  <span class="hljs-attr">select</span>: <span class="hljs-title class_">SelectField</span>,
  <span class="hljs-attr">text</span>: <span class="hljs-title class_">TextField</span>,
  <span class="hljs-attr">modeToggle</span>: <span class="hljs-title class_">ModeToggle</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>
</code></pre>
<h3 data-id="heading-6">2. ç»„è£…çº¿ï¼šè‡ªåŠ¨æ¸²æŸ“å™¨ï¼ˆAutoFormRendererï¼‰</h3>
<p>è¿™æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒå¼•æ“ã€‚å®ƒä¸å…³å¿ƒä¸šåŠ¡ï¼Œåªè´Ÿè´£æŒ‰ç…§åŠ å·¥å¥½çš„ <code>_fieldOrder</code> å’Œ <code>_schema</code> è¿›è¡Œéå†ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;template&gt;
  &lt;a-row :<span class="hljs-attr">gutter</span>=<span class="hljs-string">"[16,16]"</span>&gt;
    &lt;template <span class="hljs-attr">v-for</span>=<span class="hljs-string">"key in orderedKeys"</span> :key=<span class="hljs-string">"key"</span>&gt;
      &lt;component
        <span class="hljs-attr">v-if</span>=<span class="hljs-string">"shouldRender(key)"</span>
        :<span class="hljs-attr">is</span>=<span class="hljs-string">"resolveComponent(key)"</span>
        :<span class="hljs-attr">value</span>=<span class="hljs-string">"data[key]"</span>
        :<span class="hljs-attr">config</span>=<span class="hljs-string">"schema[key].fieldConfig"</span>
        :<span class="hljs-attr">dependencies</span>=<span class="hljs-string">"collectDeps(schema[key])"</span>
        :<span class="hljs-attr">request</span>=<span class="hljs-string">"schema[key].request"</span>
        @update:<span class="hljs-attr">value</span>=<span class="hljs-string">"onFieldChange(key, $event)"</span>
      /&gt;
    &lt;/template&gt;
  &lt;/a-row&gt;
&lt;/template&gt;

&lt;script setup <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;
const <span class="hljs-attr">props</span> = defineProps&lt;{ data: any }&gt;()<span class="hljs-comment">;</span>
const <span class="hljs-attr">schema</span> = computed(() =&gt; props.data?._schema || {})<span class="hljs-comment">;</span>
const <span class="hljs-attr">orderedKeys</span> = computed(() =&gt; props.data?._fieldOrder || Object.keys(props.data))<span class="hljs-comment">;</span>

// æ ¹æ®ä¸­é—´ä»¶æ³¨å…¥çš„ visible å‡½æ•°åˆ¤æ–­æ˜¾éš
function shouldRender(key: string) {
  const <span class="hljs-attr">s</span> = schema.value[key]<span class="hljs-comment">;</span>
  if (!s || s.fieldConfig?.hidden) return false<span class="hljs-comment">;</span>
  return s.visible ? s.visible(props.data) : true<span class="hljs-comment">;</span>
}

function resolveComponent(key: string) {
  const <span class="hljs-attr">type</span> = schema.value[key]?.componentType || <span class="hljs-string">'text'</span><span class="hljs-comment">;</span>
  return componentRegistry<span class="hljs-section">[type]</span><span class="hljs-comment">;</span>
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-7">3. åŸå­åŒ–ï¼šä¼šâ€œæ€è€ƒâ€çš„å­—æ®µç»„ä»¶</h3>
<p>ä»¥ <code>SelectField</code> ä¸ºä¾‹ï¼Œå®ƒä¸å†æ˜¯è¢«åŠ¨ç­‰å¾…èµ‹å€¼ï¼Œè€Œæ˜¯èƒ½æ„ŸçŸ¥ä¾èµ–ã€‚å½“å®ƒä¾èµ–çš„å­—æ®µï¼ˆå¦‚â€œçœä»½â€ï¼‰å˜åŒ–æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨é‡æ–°è°ƒç”¨ <code>request</code>ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'value'</span>, <span class="hljs-string">'dependencies'</span>, <span class="hljs-string">'request'</span>]);
<span class="hljs-keyword">const</span> options = <span class="hljs-title function_">ref</span>([]);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadOptions</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">request</span>) {
    options.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> props.<span class="hljs-title function_">request</span>(props.<span class="hljs-property">dependencies</span> || {});
  }
}

<span class="hljs-comment">// æ·±åº¦ç›‘å¬ä¾èµ–å˜åŒ–ï¼Œå®ç°è”åŠ¨æ•ˆæœ</span>
<span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">dependencies</span>, loadOptions, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-8">å››ã€ æ–¹æ¡ˆçš„â€œçœŸé¦™â€æ—¶åˆ»</h2>
<h3 data-id="heading-9">1. é€»è¾‘ä¸ UI çš„å½»åº•è§£è€¦</h3>
<p>æ‰€æœ‰çš„è”åŠ¨è§„åˆ™ã€æ ¡éªŒé€»è¾‘ã€æ¥å£è¯·æ±‚éƒ½å®šä¹‰åœ¨ç‹¬ç«‹äºæ¡†æ¶çš„ <code>src/core</code> ä¸‹ã€‚å¦‚æœä½ æ˜å¤©æƒ³æŠŠé¡¹ç›®ä» Vue 3 è¿åˆ° Reactï¼Œä½ åªéœ€è¦é‡å†™é‚£å‡ ä¸ªåŸºç¡€å­—æ®µç»„ä»¶ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ <strong>ä¸€è¡Œéƒ½ä¸ç”¨åŠ¨</strong>ã€‚</p>
<h3 data-id="heading-10">2. â€œæ´ç™–å‹â€æäº¤</h3>
<p>å¾ˆå¤šåŠ¨æ€è¡¨å•æ–¹æ¡ˆä¼šå°† <code>visible</code>ã€<code>options</code> ç­‰ UI çŠ¶æ€æ··å…¥ä¸šåŠ¡æ•°æ®ï¼Œå¯¼è‡´ä¼ ç»™åç«¯çš„ JSON æå…¶æ··ä¹±ã€‚æˆ‘ä»¬çš„æ–¹æ¡ˆåœ¨æäº¤å‰ä¼šè¿è¡Œä¸€æ¬¡â€œæ¸…æ´—ä¸­é—´ä»¶â€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">cleanPayload</span> = submitCompileOutputs(formData.compileOutputs)<span class="hljs-comment">;</span>
// è‡ªåŠ¨å‰”é™¤æ‰€æœ‰ä»¥ _ å¼€å¤´çš„è¾…åŠ©å­—æ®µå’Œä¸´æ—¶çŠ¶æ€
</code></pre>
<p>åç«¯æ‹¿åˆ°çš„æ°¸è¿œæ˜¯å¹²å‡€ã€çº¯ç²¹çš„ä¸šåŠ¡æ¨¡å‹ã€‚</p>
<h3 data-id="heading-11">3. å¼€å‘ä½“éªŒçš„é£è·ƒ</h3>
<p>ç°åœ¨ï¼Œå½“åç«¯æ–°å¢ä¸€ä¸ªå­—æ®µæ—¶ï¼Œä½ çš„å·¥ä½œæµå˜æˆäº†ï¼š</p>
<ol>
<li>
<p>åœ¨ç±»å‹æ¨æ–­å¼•æ“é‡ŒåŠ ä¸€è¡Œè§„åˆ™ã€‚</p>
</li>
<li>
<p>åˆ·æ–°é¡µé¢ï¼Œå­—æ®µå·²ç»æŒ‰é¢„å®šçš„ä½ç½®å’Œæ ·å¼é•¿å¥½äº†ã€‚</p>
<p>ä½ ä¸å†éœ€è¦å» .vue æ–‡ä»¶é‡Œç¿»æ‰¾å‡ ç™¾è¡Œå¤„çš„ template æ’å…¥ HTMLï¼Œæ›´ä¸éœ€è¦æ‹…å¿ƒæ¼æ‰äº†å“ªä¸ª v-ifã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">ç»“è¯­ï¼šä¸è¦ä¸ºäº†ç”¨æ¡†æ¶è€Œç”¨æ¡†æ¶</h2>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬è§‰å¾— Vue æˆ– React éš¾ç»´æŠ¤ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å°†<strong>è¿‡é‡çš„ä¸šåŠ¡å†³ç­–</strong>äº¤ç»™äº†<strong>è§†å›¾å±‚</strong>ã€‚</p>
<p>é€šè¿‡å¼•å…¥ä¸­é—´ä»¶å’Œ Schema æ¨æ–­ï¼Œæˆ‘ä»¬å®é™…ä¸Šåœ¨ UI æ¡†æ¶ä¹‹ä¸Šå»ºç«‹äº†ä¸€ä¸ªâ€œä¸šåŠ¡é€»è¾‘é˜²ç«å¢™â€ã€‚Vue åªè´Ÿè´£ç›‘å¬äº¤äº’å’Œæ¸²æŸ“ç»“æœï¼Œè€Œå˜å¹»è«æµ‹çš„ä¸šåŠ¡è§„åˆ™è¢«å…³åœ¨äº†çº¯ TypeScript ç¼–å†™çš„æ²™ç›’é‡Œã€‚</p>
<p><strong>è¿™ç§â€œå·¥ç¨‹åŒ–â€çš„æ€ç»´ï¼Œä¸ä»…æ˜¯ä¸ºäº†ä»Šå¤©èƒ½å¿«é€Ÿå¤åˆ»åŠŸèƒ½ï¼Œæ›´æ˜¯ä¸ºäº†æ˜å¤©ä¸šåŠ¡å˜åŠ¨æ—¶ï¼Œæˆ‘ä»¬èƒ½ä¼˜é›…åœ°â€œé…ç½®å‡çº§â€ï¼Œè€Œä¸æ˜¯â€œæ¨å€’é‡æ¥â€ã€‚</strong></p>
<hr/>
<p><strong>ä½ æ˜¯å¦‚ä½•å¤„ç†å¤æ‚è¡¨å•è”åŠ¨çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„â€œé¿å‘â€æŒ‡å—ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼]]></title>    <link>https://juejin.cn/post/7585743487258705929</link>    <guid>https://juejin.cn/post/7585743487258705929</guid>    <pubDate>2025-12-21T12:15:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487258705929" data-draft-id="7584861353805135908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,ä»£ç è§„èŒƒ,å›¢é˜Ÿç®¡ç†"/> <meta itemprop="datePublished" content="2025-12-21T12:15:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="gyx_è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·é™"/> <meta itemprop="url" content="https://juejin.cn/user/958429872534056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸Šçº¿å‰ä¸åš Code Reviewï¼Ÿä½ å¯èƒ½æ­£åœ¨ç»™å›¢é˜ŸåŸ‹é›·ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/958429872534056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    gyx_è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·é™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:15:55.000Z" title="Sun Dec 21 2025 12:15:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€ä½å‰ç«¯åŒäº‹èŠ±ä¸€å‘¨æ—¶é—´é‡æ„äº†ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œè‡ªæµ‹é€šè¿‡ã€æ€§èƒ½ä¼˜åŒ–ã€UI å®Œç¾ã€‚<br/>
ä¸Šçº¿ 2 å°æ—¶åï¼Œç”¨æˆ·åé¦ˆâ€œé¡µé¢ç™½å±â€â€”â€”åŸæ¥æ¼æ‰äº†ç©ºçŠ¶æ€å¤„ç†ã€‚<br/>
ç´§æ€¥å›æ»šã€åŠ ç­ä¿®å¤ã€äº§å“ä¿¡ä»»å—æŸâ€¦â€¦<br/>
è€Œè¿™ä¸€åˆ‡ï¼Œæœ¬å¯ä»¥åœ¨ä¸€æ¬¡ 15 åˆ†é’Ÿçš„ Code Review ä¸­é¿å…ã€‚</p>
</blockquote>
<p>Code Reviewï¼ˆä»£ç å®¡æŸ¥ï¼‰ä»æ¥ä¸æ˜¯â€œæ‰¾èŒ¬â€ï¼Œè€Œæ˜¯ç»™<strong>å‰ç«¯å›¢é˜Ÿä¸Šäº†ä¸€ä¸ªæœ€é«˜æ•ˆçš„è´¨é‡ä¿é™©</strong>ã€‚å®ƒä¸ä»…èƒ½æå‰æ‹¦æˆª Bugï¼Œæ›´æ˜¯çŸ¥è¯†å…±äº«ã€è§„èŒƒè½åœ°ã€æ–°äººæˆé•¿çš„åŠ é€Ÿå™¨ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Code Review</h2>
<h3 data-id="heading-1">1.1 Code Review çš„æ ¸å¿ƒä»·å€¼å’Œç›®æ ‡</h3>
<p>Code Review ç¿»è¯‘æˆä¸­æ–‡ï¼Œå°±æ˜¯<strong>ä»£ç å®¡æŸ¥</strong>ã€‚åœ¨å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå®ƒä¸ä»…æ˜¯<strong>ä¿è¯ä»£ç è´¨é‡</strong>çš„å…³é”®ç¯èŠ‚ï¼Œæ›´æ˜¯<strong>å›¢é˜ŸçŸ¥è¯†å…±äº«</strong>ã€<strong>æŠ€æœ¯ç»Ÿä¸€</strong>å’Œ<strong>å·¥ç¨‹è§„èŒƒè½åœ°</strong>çš„é‡è¦æœºåˆ¶ã€‚å›¢é˜Ÿæˆå‘˜é€šè¿‡è§„åˆ’åŒ–çš„ä»£ç å®¡æŸ¥æµç¨‹ï¼Œèƒ½å¤Ÿæå‰<strong>å‘ç°æ½œåœ¨é—®é¢˜</strong>ï¼Œ<strong>æå‡ä»£ç çš„å¯ä»¥ç»´æŠ¤æ€§</strong>ã€‚</p>
<h3 data-id="heading-2">1.2 Code Review å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™</h3>
<p>é€šå¸¸å‘ç”Ÿåœ¨ï¼š</p>
<ul>
<li>å¼€å‘è€…å®Œæˆä¸€ä¸ªåŠŸèƒ½ã€ä¿®å¤ä¸€ä¸ª bug æˆ–è¿›è¡Œé‡æ„å</li>
<li>å°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“å¹¶å‘èµ·Â <strong>Pull Requestï¼ˆPRï¼‰</strong> Â æˆ–Â <strong>Merge Requestï¼ˆMRï¼‰</strong></li>
<li>åœ¨ä»£ç åˆå¹¶åˆ°ä¸»å¹²åˆ†æ”¯ï¼ˆå¦‚Â <code>master</code>Â /Â <code>main</code>ï¼‰<strong>ä¹‹å‰</strong></li>
</ul>
<h2 data-id="heading-3">äºŒã€ä¸ºä»€ä¹ˆè¦ Code Review</h2>
<p>ä»£ç å®¡æŸ¥çœŸçš„ä¸æ˜¯ä¸ºäº†æ‰¾èŒ¬ï¼Œè€Œæ˜¯ä¸ºäº†è®©<strong>å›¢é˜Ÿ</strong>èƒ½èµ°å¾—<strong>æ›´è¿œã€æ›´ç¨³</strong>çš„å…³é”®ä¸€ç¯ã€‚æƒ³ä¸€æƒ³ï¼Œå¦‚æœèŠ±äº†ä¸€å‘¨æ—¶é—´ï¼Œä¼˜åŒ–äº†å„ç§æ€§èƒ½ï¼Œå†™äº†ä¸€å¤§å †ä»£ç ï¼Œç»“æœä¸Šçº¿åå‘ç°äº†ä¸€ä¸ªä¸¥é‡ bugï¼Œéœ€è¦ç´§æ€¥ä¿®å¤ã€‚è¿™ä¸ä»…æµªè´¹äº†æ—¶é—´ï¼Œè¿˜å¯èƒ½å½±å“ç”¨æˆ·å¯¹äº§å“å›¢é˜Ÿå’Œå¼€å‘å›¢é˜Ÿçš„ä¿¡ä»»ã€‚</p>
<p>ä¸‹é¢åˆ—ä¸¾å‡ ä¸ª Code Review çš„ä½œç”¨ï¼š</p>
<ul>
<li><strong>æå‰å‘ç°ç¼ºé™·</strong><br/>
åœ¨ Code Review é˜¶æ®µå‘ç°çš„é€»è¾‘é”™è¯¯ã€ä¸šåŠ¡ç†è§£åå·®ã€æ€§èƒ½éšæ‚£ç­‰æ—¶æœ‰å‘ç”Ÿï¼Œå¯ä»¥æå‰å‘ç°é—®é¢˜</li>
<li><strong>æé«˜ä»£ç è´¨é‡</strong><br/>
ä¸»è¦ä½“ç°åœ¨ä»£ç å¥å£®æ€§ã€è®¾è®¡åˆç†æ€§ã€ä»£ç ä¼˜é›…æ€§ç­‰æ–¹é¢ï¼ŒæŒç»­ Code Review å¯ä»¥æå‡å›¢é˜Ÿæ•´ä½“ä»£ç è´¨é‡</li>
<li><strong>ç»Ÿä¸€è§„èŒƒå’Œé£æ ¼</strong><br/>
é›†å›¢ç¼–ç è§„èŒƒè‡ªä¸å¿…è¯´ï¼Œå¯¹äºä»£ç é£æ ¼è¦ä¸è¦ç»Ÿä¸€ï¼Œå¯èƒ½ä¼šæœ‰ä¸åŒçš„çœ‹æ³•ï¼Œä¸ªäººè§‚ç‚¹å¯¹äºé£æ ¼ä¹Ÿä¸å¼ºæ±‚ã€‚ä¸è¿‡ä»£ç é£æ ¼çš„ç»Ÿä¸€æ›´æœ‰åŠ©äºæå‡ä»£ç çš„å¯è¯»æ€§åŠè®©ç»§ä»»è€…å¿«é€Ÿä¸Šæ‰‹</li>
<li><strong>å›¢é˜Ÿå…±è¯†</strong><br/>
é€šè¿‡å¤šæ¬¡è®¨è®ºä¸äº¤æµï¼Œé€æ­¥è¾¾æˆå›¢é˜Ÿå…±è¯†ï¼Œç‰¹åˆ«æ˜¯å¯¹æ¶æ„ç†è§£å’Œè®¾è®¡åŸåˆ™çš„è®¤çŸ¥ï¼Œåœ¨å…±è¯†çš„åŸºç¡€ä¸Šå›¢é˜Ÿä¹Ÿä¼šæ›´æœ‰å‡èšåŠ›ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾ƒå¤šæ–°äººåŠ å…¥æ—¶å°¤ä¸ºé‡è¦</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€æ€ä¹ˆåš Code Review</h2>
<h3 data-id="heading-5">3.1 ä»£ç æäº¤è€…</h3>
<h5 data-id="heading-6">3.1.1 ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·</h5>
<ul>
<li>ESLint + Prettier</li>
</ul>
<p>ä¸‹é¢æ˜¯ VS Code å…³äº Prettier çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"editor.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[vue]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[javascript]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[html]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[jsonc]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[json]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"[javascriptreact]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"esbenp.prettier-vscode"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint.codeActionsOnSave.mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"problems"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eslint.validate"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"typescript"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"javascript"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"javascriptreact"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"typescriptreact"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"editor.codeActionsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-comment">// æŒ‡å®šæ˜¯å¦åœ¨ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨æ•´ç†å¯¼å…¥</span>
        <span class="hljs-attr">"source.organizeImports"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åˆ©ç”¨ Ctrl + S è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç </p>
<ul>
<li>Husky + Lint-staged</li>
</ul>
<p>å®‰è£…ä¾èµ–</p>
<pre><code class="hljs language-csharp" lang="csharp">yarn <span class="hljs-keyword">add</span> -D husky
yarn <span class="hljs-keyword">add</span> -D lint-staged
</code></pre>
<p><strong>husky</strong></p>
<p>ä¸€ä¸ªä¸º git å®¢æˆ·ç«¯å¢åŠ  hook çš„å·¥å…·ã€‚å®‰è£…åï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨ä»“åº“ä¸­çš„ .husky/ ç›®å½•ä¸‹å¢åŠ ç›¸åº”çš„é’©å­ï¼›æ¯”å¦‚ pre-commit é’©å­å°±ä¼šåœ¨ä½ æ‰§è¡Œ git commit çš„è§¦å‘ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ pre-commit ä¸­å®ç°ä¸€äº›æ¯”å¦‚ lint æ£€æŸ¥ã€å•å…ƒæµ‹è¯•ã€ä»£ç ç¾åŒ–ç­‰æ“ä½œã€‚</p>
<p>package.json éœ€è¦æ·»åŠ  prepare è„šæœ¬</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepare"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"husky install"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åšå®Œä»¥ä¸Šå·¥ä½œï¼Œå°±å¯ä»¥ä½¿ç”¨ husky åˆ›å»ºä¸€ä¸ª hook äº†</p>
<pre><code class="hljs language-sql" lang="sql">npx husky <span class="hljs-keyword">add</span> .husky<span class="hljs-operator">/</span>pre<span class="hljs-operator">-</span><span class="hljs-keyword">commit</span> "npx lint-staged"
</code></pre>
<p><strong>lint-staged</strong></p>
<p>ä¸€ä¸ªä»…ä»…è¿‡æ»¤å‡º Git ä»£ç æš‚å­˜åŒºæ–‡ä»¶(è¢« git add çš„æ–‡ä»¶)çš„å·¥å…·ï¼›è¿™ä¸ªå¾ˆå®ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¦‚æœå¯¹æ•´ä¸ªé¡¹ç›®çš„ä»£ç åšä¸€ä¸ªæ£€æŸ¥ï¼Œå¯èƒ½è€—æ—¶å¾ˆé•¿ï¼Œå¦‚æœæ˜¯è€é¡¹ç›®ï¼Œè¦å¯¹ä¹‹å‰çš„ä»£ç åšä¸€ä¸ªä»£ç è§„èŒƒæ£€æŸ¥å¹¶ä¿®æ”¹çš„è¯ï¼Œè¿™å¯èƒ½å°±éº»çƒ¦äº†ï¼Œå¯èƒ½å¯¼è‡´é¡¹ç›®æ”¹åŠ¨å¾ˆå¤§ã€‚æ‰€ä»¥è¿™ä¸ª lint-stagedï¼Œå¯¹å›¢é˜Ÿé¡¹ç›®å’Œå¼€æºé¡¹ç›®æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå®ƒæ˜¯å¯¹ä¸ªäººè¦æäº¤çš„ä»£ç çš„ä¸€ä¸ªè§„èŒƒå’Œçº¦æŸã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬å·²ç»å®ç°äº†ç›‘å¬ Git hooksï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ pre-commit è¿™ä¸ª hook ä½¿ç”¨ Lint-staged å¯¹ä»£ç è¿›è¡Œ prettier çš„è‡ªåŠ¨åŒ–ä¿®å¤å’Œ ESLint çš„æ£€æŸ¥ï¼Œå¦‚æœå‘ç°ä¸ç¬¦åˆä»£ç è§„èŒƒçš„æ–‡ä»¶åˆ™ç›´æ¥é€€å‡º commitã€‚</p>
<p>å¹¶ä¸” Lint-staged åªä¼šå¯¹ Git æš‚å­˜åŒº(git add çš„ä»£ç )å†…çš„ä»£ç è¿›è¡Œæ£€æŸ¥è€Œä¸æ˜¯å…¨é‡ä»£ç ï¼Œä¸”ä¼šè‡ªåŠ¨å°† prettier æ ¼å¼åŒ–åçš„ä»£ç æ·»åŠ åˆ°æ­¤æ¬¡ commit ä¸­ã€‚</p>
<p>åœ¨ package.json ä¸­é…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 <span class="hljs-attr">"husky"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"pre-commit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lint-staged"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"lint-staged"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"*.{ts,tsx,js}"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"eslint --fix"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"prettier --write"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"git add"</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunmh207%2FAI-Codereview-Gitlab" target="_blank" title="https://github.com/sunmh207/AI-Codereview-Gitlab" ref="nofollow noopener noreferrer">AI-Codereview-Gitlab</a></li>
</ul>
<p>åˆå¹¶ä»£ç çš„æ—¶å€™è‡ªåŠ¨è§¦å‘æ‰§è¡ŒåŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨åŒ–ä»£ç å®¡æŸ¥å·¥å…·ã€‚å¯ä»¥å…ˆæ ¹æ® AI æç¤ºé€‰æ‹©æ€§çš„æ•´æ”¹ä¸€æ³¢ï¼Œç„¶åå†æ‰¾è¯„å®¡çš„äºº CRã€‚æ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡»<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsunmh207%2FAI-Codereview-Gitlab" target="_blank" title="https://github.com/sunmh207/AI-Codereview-Gitlab" ref="nofollow noopener noreferrer">é“¾æ¥</a>äº†è§£ä¸€ä¸‹ã€‚</p>
<p>åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<ol>
<li>ğŸš€ å¤šæ¨¡å‹æ”¯æŒ
<ul>
<li>å…¼å®¹DeepSeekã€ZhipuAIã€OpenAIã€Anthropicã€é€šä¹‰åƒé—®å’ŒOllamaï¼Œæƒ³ç”¨å“ªä¸ªå°±ç”¨å“ªä¸ªã€‚</li>
</ul>
</li>
<li>ğŸ“¢æ¶ˆæ¯å³æ—¶ä¸»åŠ¨
<ul>
<li>ç»“æœå®¡æŸ¥ä¸€é”®ç›´è¾¾é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡æˆ–é£ä¹¦ï¼Œä»£ç é—®é¢˜æ— å¤„å¯è—ï¼</li>
</ul>
</li>
<li>ğŸ“…è‡ªåŠ¨åŒ–æ—¥æŠ¥ç”Ÿæˆ
<ul>
<li>åŸºäº GitLab &amp; GitHub &amp; Gitea Commit è®°å½•ï¼Œè‡ªåŠ¨æ•´ç†æ¯æ—¥å¼€å‘è¿›åº¦ï¼Œè°åœ¨æ‘¸é±¼ã€è°åœ¨å·ï¼Œä¸€ç›®äº†ç„¶ ğŸ˜¼ã€‚</li>
</ul>
</li>
<li>ğŸ“Šå¯è§†åŒ–ä»ªè¡¨æ¿
<ul>
<li>é›†ä¸­å±•ç¤ºæ‰€æœ‰ä»£ç å®¡æŸ¥è®°å½•ï¼Œé¡¹ç›®ç»Ÿè®¡ã€å¼€å‘è€…ç»Ÿè®¡ï¼Œæ•°æ®è¯´è¯ï¼Œç”©é”…æ— é—¨ï¼</li>
</ul>
</li>
<li>ğŸ­ è¯„è®ºé£æ ¼ä»»ä½ é€‰
<ul>
<li>ä¸“ä¸šå‹ğŸ¤µï¼šä¸¥è°¨ä¸¥è°¨ï¼Œæ­£å¼ä¸“ä¸šã€‚</li>
<li>è®ºå‹ğŸ˜ˆï¼šæ¯’èˆŒåæ§½ï¼Œä¸“æ²»ä¸æœï¼ˆâ€œè¿™ä»£ç æ˜¯ç”¨è„šå†™çš„å—ï¼Ÿâ€ï¼‰</li>
<li>ç»…å£«å‹ğŸ˜ï¼šæ¸©æŸ”å»ºè®®ï¼Œå¦‚æ²æ˜¥é£ï¼ˆâ€œä¹Ÿè®¸è¿™é‡Œå¯ä»¥å†ä¼˜åŒ–ä¸€ä¸‹å‘¢~â€ï¼‰</li>
<li>å¹½é»˜å‹ğŸ¤ªï¼šæç¬‘ç‚¹è¯„ï¼Œå¿«ä¹æ”¹ç ï¼ˆâ€œbe if-elseæ¯”æˆ‘çš„ç›¸äº²ç»å†è¿˜æ›²æŠ˜ï¼â€ï¼‰</li>
</ul>
</li>
</ol>
<h5 data-id="heading-7">3.1.2 å‘èµ· Code Review æ—¶é—´å’Œä»£ç é‡</h5>
<ul>
<li>æ—¶é—´ï¼šå°½é‡<strong>ä¸Šçº¿å‰ä¸€å¤©</strong>å‘èµ·è¯„å®¡</li>
<li>ä»£ç é‡ï¼šæœ€å¥½åœ¨ 400 è¡Œä»¥ä¸‹ã€‚æ ¹æ®æ•°æ®åˆ†æå‘ç°ï¼Œä»ä»£ç è¡Œæ•°æ¥çœ‹ï¼Œè¶…è¿‡ 400 è¡Œçš„ CRï¼Œç¼ºé™·å‘ç°ç‡ä¼šæ€¥å‰§ä¸‹é™ï¼›ä» CR é€Ÿåº¦æ¥çœ‹ï¼Œè¶…è¿‡500 è¡Œ/å°æ—¶åï¼ŒReview è´¨é‡ä¹Ÿä¼šå¤§å¤§é™ä½ï¼Œä¸€ä¸ªé«˜è´¨é‡çš„ CR æœ€å¥½æ§åˆ¶åœ¨ä¸€ä¸ªå°æ—¶ä»¥å†…ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 ä»£ç è¯„å®¡è€…</h3>
<h5 data-id="heading-9">3.2.1 è¯„å®¡æ—¶é‡ç‚¹å…³æ³¨å†…å®¹</h5>
<p>ä½œä¸ºå‰ç«¯è¯„å®¡è€…ï¼Œå¯ä»¥æ£€æŸ¥ä»¥ä¸‹ç»´åº¦ï¼š</p>













































<table><thead><tr><th>ç»´åº¦</th><th>æ£€æŸ¥ç‚¹ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>åŠŸèƒ½æ­£ç¡®æ€§</strong></td><td>é€»è¾‘æ˜¯å¦è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼Ÿè¾¹ç•Œæ¡ä»¶ï¼ˆç©ºå€¼ã€é”™è¯¯çŠ¶æ€ï¼‰æ˜¯å¦å¤„ç†ï¼Ÿ</td></tr><tr><td><strong>å¯è¯»æ€§ &amp; å¯ç»´æŠ¤æ€§</strong></td><td>å˜é‡/å‡½æ•°å‘½åæ˜¯å¦æ¸…æ™°ï¼Ÿç»„ä»¶èŒè´£æ˜¯å¦å•ä¸€ï¼Ÿé‡å¤ä»£ç æ˜¯å¦å¯å¤ç”¨ï¼Ÿ</td></tr><tr><td><strong>TypeScript å®‰å…¨</strong></td><td>æ˜¯å¦æ»¥ç”¨Â <code>any</code>Â /Â <code>@ts-ignore</code>ï¼Ÿç±»å‹å®šä¹‰æ˜¯å¦å‡†ç¡®ï¼Ÿ</td></tr><tr><td><strong>æ¡†æ¶è§„èŒƒ</strong></td><td>Reactï¼š<code>key</code>Â æ˜¯å¦åˆç†ï¼Ÿ<code>useEffect</code>Â ä¾èµ–æ˜¯å¦å®Œæ•´ï¼ŸVueï¼šå“åº”å¼ä½¿ç”¨æ˜¯å¦æ­£ç¡®ï¼Ÿ</td></tr><tr><td><strong>æ ·å¼ &amp; UI</strong></td><td>æ˜¯å¦é¿å…å…¨å±€ CSS æ±¡æŸ“ï¼Ÿæ˜¯å¦é€‚é…ç§»åŠ¨ç«¯ï¼Ÿæ˜¯å¦ç¬¦åˆè®¾è®¡ç³»ç»Ÿï¼Ÿ</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Ÿå›¾ç‰‡/èµ„æºæ˜¯å¦ä¼˜åŒ–ï¼Ÿç¬¬ä¸‰æ–¹åº“æ˜¯å¦æŒ‰éœ€å¼•å…¥ï¼Ÿ</td></tr><tr><td><strong>å¯è®¿é—®æ€§ (a11y)</strong></td><td>æ˜¯å¦ä½¿ç”¨è¯­ä¹‰åŒ–æ ‡ç­¾ï¼Ÿè¡¨å•æ˜¯å¦æœ‰ labelï¼Ÿé”®ç›˜å¯¼èˆªæ˜¯å¦æ”¯æŒï¼Ÿ</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>ç”¨æˆ·è¾“å…¥æ˜¯å¦è½¬ä¹‰ï¼Ÿæ˜¯å¦é¿å… XSSï¼ˆå¦‚Â <code>dangerouslySetInnerHTML</code>ï¼‰ï¼Ÿ</td></tr><tr><td><strong>æµ‹è¯•è¦†ç›–</strong></td><td>å…³é”®é€»è¾‘æ˜¯å¦æœ‰å•å…ƒæµ‹è¯•ï¼Ÿç”¨æˆ·è·¯å¾„æ˜¯å¦æœ‰ E2E æµ‹è¯•ï¼Ÿ</td></tr></tbody></table>
<h5 data-id="heading-10">3.2.2 æ€ä¹ˆå†™ Review è¯„è®º</h5>
<p>é¦–å…ˆï¼Œä¸è¦åå•¬ä½ çš„èµç¾ã€‚<strong>ä»£ç å†™çš„å¥½çš„åœ°æ–¹è¦è¡¨æ‰¬ï¼ï¼</strong></p>
<p>åŒºåˆ†ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>ğŸ”´Â <strong>å¿…é¡»æ”¹</strong>ï¼šBugã€å®‰å…¨æ¼æ´ã€ç ´åæ€§å˜æ›´</li>
<li>ğŸŸ¡Â <strong>å»ºè®®æ”¹</strong>ï¼šå¯è¯»æ€§ã€æ€§èƒ½ä¼˜åŒ–ã€æœ€ä½³å®è·µ</li>
<li>ğŸŸ¢Â <strong>å¯è®¨è®º</strong>ï¼šé£æ ¼åå¥½ï¼ˆåº”ç”± Lint å·¥å…·ç»Ÿä¸€ï¼‰</li>
</ul>
<p>ç”¨å¥½ â€œWhat-Why-Howâ€ æ³•åˆ™</p>
<p>âœ… æ­£ç¡®ç¤ºèŒƒï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">What: è¿™é‡Œç›´æ¥æ“ä½œ DOM (`document.getElementById`)  </span>
<span class="hljs-section">Why: åœ¨ React ä¸­ç»•è¿‡è™šæ‹Ÿ DOM ä¼šå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ï¼Œä¸”éš¾ä»¥æµ‹è¯•  </span>
<span class="hljs-section">How: å»ºè®®æ”¹ç”¨ `useRef` è·å–å…ƒç´ å¼•ç”¨ï¼Œæˆ–é€šè¿‡çŠ¶æ€é©±åŠ¨ UI æ›´æ–°</span>
</code></pre>
<p>âŒ é¿å…ï¼š</p>
<pre><code class="hljs">â€œè¿™é‡Œå†™å¾—ä¸å¥½â€ â†’ å¤ªæ¨¡ç³Š
â€œä½ åº”è¯¥ç”¨ Hooks é‡å†™â€ â†’ æ²¡è¯´æ˜åŸå› 
â€œæˆ‘ä»¥å‰éƒ½è¿™ä¹ˆå†™çš„â€ â†’ ä¸»è§‚ç»éªŒï¼Œç¼ºä¹ä¾æ®
</code></pre>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>å¥½çš„ Code Review æ˜¯å›¢é˜Ÿè¿›æ­¥çš„æ”¾å¤§å™¨ï¼Œå®ƒå¯ä»¥ï¼š</p>
<ul>
<li>è®©æ–°äººæˆé•¿å¾—æ›´å¿«</li>
<li>è®©ç³»ç»Ÿå˜å¾—æ›´ç¨³å®š</li>
<li>è®©"æŠ€æœ¯å€º"æ›´å°‘</li>
<li>è®©åä½œæ›´é«˜æ•ˆ</li>
</ul>
<h2 data-id="heading-12">å‚è€ƒæ–‡ç« </h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.aliyun.com%2Farticle%2F1164854" target="_blank" title="https://developer.aliyun.com/article/1164854" ref="nofollow noopener noreferrer">ä¸€æ–‡æ¢³ç†Code Reviewæ–¹æ³•è®ºä¸å®è·µæ€»ç»“</a></li>
</ul>
<h2 data-id="heading-13">æ„Ÿè°¢</h2>
<ul>
<li>æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæ‰¹è¯„æŒ‡æ­£ã€‚</li>
<li>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå°±<strong>ç‚¹èµã€æ”¶è—</strong>æ”¯æŒä¸‹å§ï¼æ„Ÿè°¢é˜…è¯»ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7585727457472561152</link>    <guid>https://juejin.cn/post/7585727457472561152</guid>    <pubDate>2025-12-21T12:52:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585727457472561152" data-draft-id="7585555806668046370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,GitHub"/> <meta itemprop="datePublished" content="2025-12-21T12:52:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é‘«åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685871694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue-pdf-interactor æŠ€æœ¯ç™½çš®ä¹¦ï¼šä¸ºç°ä»£ Web åº”ç”¨æ³¨å…¥äº¤äº’å¼ PDF èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685871694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é‘«åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:52:15.000Z" title="Sun Dec 21 2025 12:52:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å†…å®¹æ¥è‡ªï¼šNotebookLM å¯¹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOSpoon%2Fvue-pdf-interactor" target="_blank" title="https://github.com/OSpoon/vue-pdf-interactor" ref="nofollow noopener noreferrer">vue-pdf-interactor</a> é¡¹ç›®åˆ†æåè‡ªåŠ¨ç”Ÿæˆ</strong></p>
<h2 data-id="heading-0">1.0 å¼•è¨€ï¼šé‡æ–°å®šä¹‰ Web ä¸­çš„ PDF äº¤äº’</h2>
<p>åœ¨ç°ä»£ Web åº”ç”¨çš„ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒPDF æ–‡æ¡£ä»ç„¶æ˜¯ä¿¡æ¯åˆ†å‘å’Œå½’æ¡£çš„æ ¸å¿ƒåª’ä»‹ã€‚ç„¶è€Œï¼Œå®ƒä»¬é€šå¸¸ä»¥é™æ€ã€ä¸å¯äº¤äº’çš„å½¢å¼å­˜åœ¨ï¼Œæå¤§åœ°é™åˆ¶äº†ç”¨æˆ·ä¸æ–‡æ¡£å†…å®¹è¿›è¡Œæ·±åº¦äº’åŠ¨çš„èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®æå–å’ŒåŠ¨æ€æ“ä½œæ–¹é¢ã€‚è¿™ç§å±€é™æ€§å¯¼è‡´äº†ç”¨æˆ·ä½“éªŒçš„æ–­å±‚ï¼Œä½¿å¾—ä»åˆåŒã€æŠ¥å‘Šåˆ°æ‰«ææ¡£æ¡ˆç­‰å…³é”®æ–‡æ¡£çš„ä»·å€¼æ— æ³•è¢«å……åˆ†å‘æ˜ã€‚</p>
<p><code>vue-pdf-interactor</code> çš„é—®ä¸–æ­£æ˜¯ä¸ºäº†å¼¥åˆè¿™ä¸€å·®è·ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ PDF æŸ¥çœ‹å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªæˆ˜ç•¥æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œæ—¨åœ¨é€šè¿‡ä¸º PDF æ–‡æ¡£å åŠ ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„äº¤äº’å±‚ï¼Œå½»åº•æ”¹å˜ç”¨æˆ·ä¸ PDF å†…å®¹çš„äº’åŠ¨æ–¹å¼ã€‚è¯¥ç»„ä»¶åº“å…è®¸å¼€å‘è€…å°†é™æ€çš„ã€ç”šè‡³æ˜¯åŸºäºå›¾åƒçš„ PDF è½¬åŒ–ä¸ºå¯æ“ä½œã€å¯å“åº”çš„æ•°æ®æºï¼Œä»è€Œè§£é”å…¨æ–°çš„åº”ç”¨å¯èƒ½æ€§ã€‚</p>
<p>æœ¬æ–‡æ¡£å°†ä»æ ¸å¿ƒåŠŸèƒ½ã€æŠ€æœ¯æ¶æ„ã€å®æ–½æŒ‡å—åŠå…¸å‹åº”ç”¨åœºæ™¯ç­‰å¤šä¸ªç»´åº¦ï¼Œå…¨é¢è§£æ <code>vue-pdf-interactor</code> ç»„ä»¶åº“çš„è®¾è®¡ç†å¿µä¸å•†ä¸šä»·å€¼ï¼Œä¸ºæŠ€æœ¯å†³ç­–è€…å’Œå¼€å‘è€…æä¾›ä¸€ä»½æ˜ç¡®çš„æŠ€æœ¯æŒ‡å—ã€‚</p>
<h2 data-id="heading-1">2.0 æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼ä¸»å¼ </h2>
<p>æœ¬ç« èŠ‚æ—¨åœ¨æ·±å…¥å‰–æ <code>vue-pdf-interactor</code> çš„æ ¸å¿ƒåŠŸèƒ½é›†ã€‚æ­£æ˜¯è¿™äº›ç²¾å¿ƒè®¾è®¡çš„åŠŸèƒ½ï¼Œå…±åŒæ„æˆäº†å…¶ç‹¬ç‰¹çš„ä»·å€¼ä¸»å¼ â€”â€”å°†ä¼ ç»Ÿçš„ PDF æŸ¥çœ‹å™¨ï¼Œå‡çº§ä¸ºä¸€ä¸ªå¼ºå¤§ã€å¯æ‰©å±•çš„äº¤äº’å¼æ–‡æ¡£å·¥å…·ï¼Œä¸ºå¤æ‚çš„ä¸šåŠ¡æµç¨‹èµ‹èƒ½ã€‚</p>
<h3 data-id="heading-2">2.1 åŸºäº vue-pdf-embed çš„åšå®æ¸²æŸ“åŸºç¡€</h3>
<p><code>vue-pdf-interactor</code> çš„ä¸€ä¸ªå…³é”®æ¶æ„å†³ç­–æ˜¯æ„å»ºäºæˆç†Ÿçš„ <code>vue-pdf-embed</code> ç»„ä»¶ä¹‹ä¸Šã€‚è¿™ä¸€é€‰æ‹©ä½“ç°äº†æ·±æ€ç†Ÿè™‘çš„æ¶æ„å®¡æ…æ€§ï¼Œå…¶æ ¸å¿ƒç›®æ ‡åœ¨äº<strong>é¡¹ç›®å»é£é™©åŒ–</strong>ã€‚é€šè¿‡å°†å¤æ‚ä¸”æ˜“é”™çš„åº•å±‚ PDF è§£æä¸æ¸²æŸ“å±‚å§”æ‰˜ç»™ä¸€ä¸ªç»è¿‡ç¤¾åŒºå¹¿æ³›éªŒè¯çš„æˆç†Ÿåº“ï¼Œ<code>vue-pdf-interactor</code> å¾—ä»¥å°†å…¶å…¨éƒ¨çš„å¼€å‘é¢„ç®—å’Œç²¾åŠ›èšç„¦äºè‡ªèº«çš„æ ¸å¿ƒç«äº‰åŠ›â€”â€”æ„å»ºç¨³å®šã€é«˜æ•ˆä¸”åŠŸèƒ½ä¸°å¯Œçš„äº¤äº’å±‚ã€‚</p>
<h3 data-id="heading-3">2.2 æ ¸å¿ƒäº¤äº’èƒ½åŠ›ï¼šOCR æ–‡æœ¬é«˜äº®ä¸é€‰æ‹©</h3>
<p><code>vue-pdf-interactor</code> æœ€å…·å·®å¼‚åŒ–çš„ç‰¹æ€§ï¼Œåœ¨äºå…¶é›†æˆäº† OCR (å…‰å­¦å­—ç¬¦è¯†åˆ«) æ–‡æœ¬è¯†åˆ«ã€é«˜äº®æ˜¾ç¤ºå’Œäº¤äº’å¼æ–‡æœ¬å—é€‰æ‹©çš„èƒ½åŠ›ã€‚è¿™ä¸€åŠŸèƒ½ç»„åˆæ˜¯å…¶ä»·å€¼çš„æ ¸å¿ƒæ‰€åœ¨ï¼Œå¯¹äºæ•°æ®æ ‡æ³¨ã€å†…å®¹å¼•ç”¨ã€æ–‡æ¡£å®¡æŸ¥ç­‰å·¥ä½œæµç¨‹è€Œè¨€ï¼Œå…·æœ‰é©å‘½æ€§çš„å½±å“ã€‚å®ƒæœ‰æ•ˆåœ°å°†æ–‡æ¡£ä»ä¸€ä¸ªå•ä¸€çš„è§†è§‰åŒºå—ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªå¯æŸ¥è¯¢çš„ã€ç”±æ–‡æœ¬èŠ‚ç‚¹æ„æˆçš„æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰ï¼Œä»è€Œè§£é”äº†å¯¹å…¶å†…å®¹çš„ç¨‹åºåŒ–è®¿é—®èƒ½åŠ›ã€‚è¿™ä½¿å¾—é™æ€çš„ã€åŸºäºå›¾åƒçš„ PDF æ–‡æ¡£ï¼ˆå°¤å…¶æ˜¯æ‰«æä»¶ï¼‰å¾—ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå¯è¢«ç¨‹åºç†è§£å’Œæ“ä½œçš„ç»“æ„åŒ–æ•°æ®æºã€‚</p>
<h3 data-id="heading-4">2.3 é«˜åº¦å¯æ‰©å±•çš„äº¤äº’æ¥å£</h3>
<p>ç»„ä»¶åº“é€šè¿‡æä¾›â€œå¯è‡ªå®šä¹‰çš„å·¥å…·æ æŒ‰é’®â€åŠŸèƒ½ï¼Œä¸ºå¼€å‘è€…æ‰“å¼€äº†é€šå¾€æ— é™äº¤äº’å¯èƒ½çš„å¤§é—¨ã€‚åˆ©ç”¨ Vue çš„æ’æ§½ï¼ˆSlotï¼‰æœºåˆ¶ï¼Œç‰¹åˆ«æ˜¯ <code>&lt;template #toolbar&gt;</code>ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°å°†è‡ªå®šä¹‰çš„ä¸šåŠ¡é€»è¾‘ä¸ç”¨æˆ·é€‰æ‹©çš„ PDF æ–‡æœ¬å—è¿›è¡Œç»‘å®šã€‚</p>
<p>å¦‚ä¸‹æ–¹ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“ç”¨æˆ·é€‰ä¸­ä¸€ä¸ªæ–‡æœ¬å—æ—¶ï¼Œå¼€å‘è€…å¯ä»¥å®šä¹‰ä¸€ä¸ªâ€œæ“ä½œâ€æŒ‰é’®ï¼Œå…¶ç‚¹å‡»äº‹ä»¶èƒ½å¤Ÿè·å–åˆ°å½“å‰é€‰ä¸­æ–‡æœ¬å—ï¼ˆ<code>block</code>ï¼‰çš„å…¨éƒ¨ä¿¡æ¯ã€‚æ— è®ºæ˜¯å°†é€‰å®šå†…å®¹ä¿å­˜åˆ°æ•°æ®åº“ã€è°ƒç”¨ç¬¬ä¸‰æ–¹ API è¿›è¡Œç¿»è¯‘ï¼Œè¿˜æ˜¯è§¦å‘å…¶ä»–å¤æ‚çš„ä¸šåŠ¡æµç¨‹ï¼Œéƒ½å˜å¾—å¼‚å¸¸ç®€å•å’Œç›´è§‚ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">&lt;<span class="hljs-keyword">template</span> <span class="hljs-meta">#toolbar=<span class="hljs-string">"{ block }"</span>&gt;</span>
  &lt;ToolbarButton
    label=<span class="hljs-string">"æ“ä½œ"</span>
    @click=<span class="hljs-string">"() =&gt; handleAction(block)"</span>
  /&gt;
&lt;/<span class="hljs-keyword">template</span>&gt;
</code></pre>
<h3 data-id="heading-5">2.4 é¢å‘ç°ä»£åŒ–å¼€å‘çš„å·¥ç¨‹è®¾è®¡</h3>
<p><code>vue-pdf-interactor</code> åœ¨å·¥ç¨‹è®¾è®¡ä¸Šç´§è·Ÿç°ä»£å‰ç«¯å¼€å‘çš„æœ€ä½³å®è·µï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>ES Module æ”¯æŒ</strong>: ç»„ä»¶åº“ä»¥ ES Module æ ¼å¼åˆ†å‘ï¼Œç¡®ä¿äº†ä¸ Viteã€Webpack ç­‰ç°ä»£æ„å»ºå·¥å…·çš„æ— ç¼é›†æˆã€‚è¿™ä¸ä»…ä¼˜åŒ–äº†å¼€å‘æµç¨‹ï¼Œè¿˜ä½¿å¾— Tree-shaking ç­‰æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆè¿ä½œï¼Œå‡å°‘æœ€ç»ˆæ‰“åŒ…ä½“ç§¯ã€‚</li>
<li><strong>TypeScript æ”¯æŒ</strong>: é¡¹ç›®æä¾›äº†å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼ˆ<code>index.d.ts</code>ï¼‰ã€‚è¿™å¯¹äºå¤§å‹é¡¹ç›®è‡³å…³é‡è¦ï¼Œå®ƒæå¤§åœ°æå‡äº†å¼€å‘ä½“éªŒï¼Œé€šè¿‡é™æ€ç±»å‹æ£€æŸ¥å¢å¼ºäº†ä»£ç çš„å¥å£®æ€§ï¼Œå¹¶ä½¿å¾—ç»„ä»¶åº“åœ¨å¤æ‚åº”ç”¨ä¸­çš„å¯ç»´æŠ¤æ€§å¾—åˆ°ä¿éšœã€‚</li>
</ul>
<p>è¿™äº›å¼ºå¤§çš„åŠŸèƒ½èƒŒåï¼Œæ˜¯ä¸€å¥—æ¸…æ™°ã€é«˜æ•ˆçš„æŠ€æœ¯æ¶æ„ã€‚</p>
<h2 data-id="heading-6">3.0 æŠ€æœ¯æ¶æ„ä¸è®¾è®¡ç†å¿µ</h2>
<p>æœ¬ç« èŠ‚å°†æ·±å…¥æ¢è®¨ <code>vue-pdf-interactor</code> çš„å†…éƒ¨æ„é€ ã€‚å¯¹äºå¸Œæœ›é«˜æ•ˆé›†æˆã€æ·±åº¦å®šåˆ¶æˆ–è¿›è¡Œé—®é¢˜æ’æŸ¥çš„å¼€å‘è€…è€Œè¨€ï¼Œç†è§£å…¶æŠ€æœ¯é€‰å‹ã€æ ¸å¿ƒä¾èµ–ä»¥åŠæ„å»ºäº§ç‰©æ˜¯è‡³å…³é‡è¦çš„ç¬¬ä¸€æ­¥ã€‚</p>
<h3 data-id="heading-7">3.1 æ ¸å¿ƒä¾èµ–æ ˆè§£æ</h3>
<p><code>vue-pdf-interactor</code> çš„åŠŸèƒ½å®ç°ä¾èµ–äºä¸€ä¸ªç²¾å¿ƒæŒ‘é€‰çš„å°è€Œç²¾çš„æ ¸å¿ƒä¾èµ–æ ˆï¼Œæ¯ä¸ªåº“éƒ½åœ¨å…¶ä¸­æ‰®æ¼”ç€ä¸å¯æˆ–ç¼ºçš„è§’è‰²ï¼š</p>
<ul>
<li><code>vue (^3.5.24) </code>: ä½œä¸ºæ•´ä¸ªç»„ä»¶åº“çš„åŸºçŸ³ï¼Œæä¾›äº†å¼ºå¤§çš„å“åº”å¼ç³»ç»Ÿå’Œç»„ä»¶åŒ–æ¨¡å‹ï¼Œæ˜¯å®ç°å£°æ˜å¼ UI å’Œå¤æ‚çŠ¶æ€ç®¡ç†çš„åŸºç¡€ã€‚</li>
<li><code>vue-pdf-embed (^2.1.3) </code>: æ‰¿æ‹…äº†åº•å±‚çš„ PDF æ–‡æ¡£æ¸²æŸ“å·¥ä½œï¼Œæ˜¯å®ç°æ–‡æ¡£å¯è§†åŒ–çš„æ ¸å¿ƒå¼•æ“ï¼Œä¿è¯äº†ç¨³å®šå’Œé«˜è´¨é‡çš„æ¸²æŸ“æ•ˆæœã€‚</li>
<li><code>@floating-ui/vue (^1.1.9) </code>: ä¸“ç”¨äºè§£å†³æµ®åŠ¨ UI å…ƒç´ çš„å®šä½é—®é¢˜ã€‚å®ƒä¼˜é›…åœ°å¤„ç†äº†åœ¨ä¸€ä¸ªå¯æ»šåŠ¨ä¸”å¯èƒ½å‘ç”Ÿå˜æ¢çš„è§†å£ä¸­ï¼Œå°† UI å…ƒç´ ï¼ˆå¦‚å·¥å…·æ ï¼‰ç²¾ç¡®å®šä½åˆ°ç›®æ ‡å…ƒç´ ï¼ˆå¦‚é€‰ä¸­æ–‡æœ¬ï¼‰æ—çš„å¤æ‚è®¡ç®—å‡ ä½•éš¾é¢˜ã€‚</li>
<li><code>@vueuse/core (^14.1.0) </code>: ä¸€ä¸ªæä¾›é«˜è´¨é‡ã€ç»è¿‡å®æˆ˜æ£€éªŒçš„ Vue ç»„åˆå¼å‡½æ•°ï¼ˆComposablesï¼‰å·¥å…·é›†ã€‚é€šè¿‡åˆ©ç”¨å…¶ä¸­å°è£…å¥½çš„ DOM äº‹ä»¶å¤„ç†å’Œå“åº”å¼çŠ¶æ€ç®¡ç†ç­‰å‡½æ•°ï¼Œé¿å…äº†â€œé‡å¤é€ è½®å­â€ï¼Œæ˜¾è‘—å‡å°‘äº†äº¤äº’é€»è¾‘ä¸­çš„æ½œåœ¨é”™è¯¯ï¼Œå¹¶æå‡äº†ä»£ç çš„å¯è¯»æ€§ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 æŠ€æœ¯æ ˆæ„æˆ</h3>
<p>ä»é¡¹ç›®çš„è¯­è¨€æ„æˆæ¥çœ‹ï¼Œå…¶æŠ€æœ¯æ ˆçš„é€‰æ‹©éå¸¸æ˜ç¡®å’Œç°ä»£åŒ–ï¼š</p>
<ul>
<li><strong>Vue (64.1%)</strong></li>
<li><strong>TypeScript (34.6%)</strong></li>
<li><strong>HTML (1.3%)</strong></li>
</ul>
<p>è¿™ç§ä»¥ Vue å’Œ TypeScript ä¸ºä¸»å¯¼çš„ç»„åˆï¼Œæ˜¯æ„å»ºç±»å‹å®‰å…¨ã€ç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤çš„ç°ä»£å‰ç«¯åº“çš„ç†æƒ³é€‰æ‹©ã€‚Vue æä¾›äº†å“è¶Šçš„å¼€å‘ä½“éªŒå’Œæ€§èƒ½ï¼ŒTypeScript é€šè¿‡é™æ€ç±»å‹ç³»ç»Ÿä¸ºå¤§å‹åº”ç”¨å¸¦æ¥äº†ä»£ç å±‚é¢çš„å¯é æ€§ä¿éšœï¼Œè€Œå°‘é‡çš„ HTML åˆ™ä¸»è¦ç”¨äºå¼€å‘ç¯å¢ƒçš„å®¿ä¸»é¡µé¢ã€‚</p>
<h3 data-id="heading-9">3.3 æ„å»ºä¸åˆ†å‘</h3>
<p>å½“å¼€å‘è€…æ‰§è¡Œ <code>pnpm build</code> å‘½ä»¤åï¼Œä¼šç”Ÿæˆä¸€å¥—æ ‡å‡†åŒ–çš„ã€æ˜“äºé›†æˆçš„äº§ç‰©æ–‡ä»¶ã€‚è¿™å¥—æ–‡ä»¶ç»“æ„æ¸…æ™°åœ°åæ˜ äº†ç»„ä»¶åº“çš„è®¾è®¡ç†å¿µï¼š</p>
<ul>
<li><code>dist/index.js</code>: è¿™æ˜¯ä¸ºç°ä»£æµè§ˆå™¨å’Œæ„å»ºå·¥å…·å‡†å¤‡çš„ ES Module å…¥å£æ–‡ä»¶ï¼Œæ”¯æŒæœ€æ–°çš„ JavaScript ç‰¹æ€§ï¼Œå¹¶ä¸ºæ‰“åŒ…ä¼˜åŒ–åšå¥½äº†å‡†å¤‡ã€‚</li>
<li><code>dist/index.d.ts</code>: ä¸º TypeScript é¡¹ç›®æä¾›å®Œæ•´çš„ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œç¡®ä¿å¼€å‘è€…åœ¨ä½¿ç”¨ç»„ä»¶åº“æ—¶èƒ½äº«å—åˆ°ä»£ç æç¤ºã€ç±»å‹æ£€æŸ¥ç­‰æ‰€æœ‰ä¾¿åˆ©ã€‚</li>
<li><code>dist/vue-pdf-interactor.css</code>: ç»„ä»¶åº“æ‰€éœ€çš„å…¨éƒ¨æ ·å¼æ–‡ä»¶ã€‚å¼€å‘è€…éœ€è¦åœ¨ä½¿ç”¨æ—¶æ‰‹åŠ¨å¼•å…¥æ­¤æ–‡ä»¶ï¼Œä»¥ä¿è¯ç»„ä»¶çš„æ­£ç¡®æ˜¾ç¤ºã€‚</li>
</ul>
<p>äº†è§£å…¶æ¶æ„åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­å¿«é€Ÿé›†æˆå¹¶ä½¿ç”¨å®ƒã€‚</p>
<h2 data-id="heading-10">4.0 å¿«é€Ÿä¸Šæ‰‹ä¸å®æ–½æŒ‡å—</h2>
<p>æœ¬ç« èŠ‚æ—¨åœ¨æä¾›ä¸€ä¸ªæ¸…æ™°ã€å¯æ“ä½œçš„æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…å°† <code>vue-pdf-interactor</code> å¿«é€Ÿã€é¡ºåˆ©åœ°é›†æˆåˆ°ç°æœ‰çš„ Vue 3 é¡¹ç›®ä¸­ï¼Œå¹¶å‘æŒ¥å…¶æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-11">4.1 ç¯å¢ƒå‡†å¤‡ä¸å®‰è£…</h3>
<p>åœ¨å®‰è£…ç»„ä»¶åº“ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„é¡¹ç›®å·²å…·å¤‡ä»¥ä¸‹ç¯å¢ƒã€‚</p>
<ol>
<li>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®‰è£…æ ¸å¿ƒä¾èµ–</strong> <code>vue-pdf-interactor</code> å°†å…¶æ ¸å¿ƒä¾èµ–å£°æ˜ä¸º<strong>å¯¹ç­‰ä¾èµ–ï¼ˆpeer dependenciesï¼‰</strong> ã€‚è¿™æ„å‘³ç€å®ƒä¸ä¼šå°† <code>vue</code>ã€<code>vue-pdf-embed</code> ç­‰åº“æ‰“åŒ…è¿›è‡ªèº«ï¼Œä»¥é¿å…åœ¨æ‚¨çš„æœ€ç»ˆåº”ç”¨ä¸­äº§ç”Ÿç‰ˆæœ¬å†²çªå’Œä¸å¿…è¦çš„ä½“ç§¯è†¨èƒ€ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦ç¡®ä¿é¡¹ç›®ä¸­å·²ç»å®‰è£…äº†ä»¥ä¸‹å››ä¸ªæ ¸å¿ƒåŒ…ï¼š</p>
<ul>
<li><code>vue</code></li>
<li><code>vue-pdf-embed</code></li>
<li><code>@floating-ui/vue</code></li>
<li><code>@vueuse/core</code></li>
</ul>
</li>
<li>
<p><strong>ç¬¬äºŒæ­¥ï¼šå®‰è£…ç»„ä»¶åº“</strong> ä½¿ç”¨æ‚¨åå¥½çš„åŒ…ç®¡ç†å™¨ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… <code>vue-pdf-interactor</code>ï¼š</p>
<ul>
<li><strong>Using pnpm</strong></li>
<li><strong>Using npm</strong></li>
<li><strong>Using yarn</strong></li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">4.2 åŸºç¡€ç”¨æ³•ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹ä»£ç ç¤ºä¾‹å±•ç¤ºäº† <code>vue-pdf-interactor</code> çš„å…¸å‹ç”¨æ³•ï¼Œæˆ‘ä»¬å°†å¯¹å…¶å…³é”®éƒ¨åˆ†è¿›è¡Œæ‹†è§£è¯´æ˜ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Interactor</span>, <span class="hljs-title class_">ToolbarButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-interactor'</span>
  <span class="hljs-keyword">import</span> type { <span class="hljs-title class_">OCRDocument</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-interactor'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-title class_">VuePdfEmbed</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-pdf-embed'</span>

  <span class="hljs-comment">// å¯¼å…¥æ ·å¼æ–‡ä»¶</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-interactor/vue-pdf-interactor.css'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-embed/dist/styles/annotationLayer.css'</span>
  <span class="hljs-keyword">import</span> <span class="hljs-string">'vue-pdf-embed/dist/styles/textLayer.css'</span>

  <span class="hljs-keyword">const</span> pdfSource = <span class="hljs-string">'https://example.com/document.pdf'</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">ocrDocument</span>: <span class="hljs-title class_">OCRDocument</span> = {
    <span class="hljs-attr">pages</span>: [
      {
        <span class="hljs-attr">pageNumber</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">width</span>: <span class="hljs-number">1788</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-number">2527</span>,
        <span class="hljs-attr">blocks</span>: [
          <span class="hljs-comment">// OCR æ–‡æœ¬å—æ•°æ®</span>
        ]
      }
    ]
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">VuePdfEmbed</span>
    <span class="hljs-attr">:source</span>=<span class="hljs-string">"pdfSource"</span>
    <span class="hljs-attr">annotation-layer</span>
    <span class="hljs-attr">text-layer</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">after-page</span>=<span class="hljs-string">"{ page }"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Interactor</span>
        <span class="hljs-attr">:ocr-document</span>=<span class="hljs-string">"ocrDocument"</span>
        <span class="hljs-attr">:page</span>=<span class="hljs-string">"page"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">toolbar</span>=<span class="hljs-string">"{ block }"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ToolbarButton</span>
            <span class="hljs-attr">label</span>=<span class="hljs-string">"æ“ä½œ"</span>
            @<span class="hljs-attr">click</span>=<span class="hljs-string">"() =&gt; handleAction(block)"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Interactor</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">VuePdfEmbed</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">é€»è¾‘æ‹†è§£ï¼š</h4>
<ol>
<li>
<p><strong>å¯¼å…¥æ¨¡å—</strong>: é¦–å…ˆï¼Œä» <code>vue-pdf-interactor</code> å’Œ <code>vue-pdf-embed</code> ä¸­å¯¼å…¥æ‰€éœ€çš„ç»„ä»¶ã€ç±»å‹å’Œæ ·å¼æ–‡ä»¶ã€‚<strong>è¯·åŠ¡å¿…å¯¼å…¥</strong> <code>.css</code> <strong>æ ·å¼æ–‡ä»¶</strong>ï¼Œå¦åˆ™ç»„ä»¶å°†æ— æ³•æ­£å¸¸æ¸²æŸ“ã€‚</p>
</li>
<li>
<p><strong>ç»„ä»¶ç»“æ„</strong>: æ­¤å¤„é‡‡ç”¨äº†ä¸€ç§<strong>åŸºäºæ’æ§½çš„ç»„åˆæ¨¡å¼</strong>ã€‚<code>&lt;Interactor&gt;</code> ç»„ä»¶ä½œä¸ºä¸€ç§â€œæ— å¤´ï¼ˆheadlessï¼‰â€å¢å¼ºåŠŸèƒ½ï¼Œè¢«æ³¨å…¥åˆ° <code>&lt;VuePdfEmbed&gt;</code> çš„ <code>#after-page</code> æ’æ§½ä¸­ã€‚è¿™ç§è®¾è®¡å°†äº¤äº’é€»è¾‘ä¸æ¸²æŸ“ç»„ä»¶å®Œå…¨è§£è€¦ï¼Œéµå¾ªäº†å•ä¸€èŒè´£åŸåˆ™ï¼š<code>&lt;VuePdfEmbed&gt;</code> è´Ÿè´£æ¸²æŸ“ï¼Œè€Œ <code>&lt;Interactor&gt;</code> ä¸“æ³¨äº¤äº’ï¼Œä»è€Œå®ç°äº†æé«˜çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®ç»‘å®š</strong>:</p>
<ul>
<li><code>pdfSource</code>: æŒ‡å‘æ‚¨éœ€è¦å±•ç¤ºçš„ PDF æ–‡ä»¶ URLã€‚</li>
<li><code>ocrDocument</code>: è¿™æ˜¯æ ¸å¿ƒæ•°æ® <code>prop</code>ã€‚éœ€è¦ç‰¹åˆ«æŒ‡å‡ºï¼Œæ­¤æ•°æ®ç»“æ„<strong>åº”ç”±å¤–éƒ¨çš„å…‰å­¦å­—ç¬¦è¯†åˆ«ï¼ˆOCRï¼‰å¼•æ“ç”Ÿæˆ</strong>ã€‚æœ¬ç»„ä»¶åº“ä¸æ‰§è¡Œ OCRï¼Œè€Œæ˜¯æ¶ˆè´¹å…¶ç»“æœï¼Œä¾æ®å…¶ä¸­åŒ…å«çš„é¡µé¢å°ºå¯¸å’Œæ‰€æœ‰æ–‡æœ¬å—ï¼ˆ<code>blocks</code>ï¼‰çš„ä½ç½®åŠå†…å®¹ä¿¡æ¯æ¥æ¸²æŸ“å¯äº¤äº’åŒºåŸŸã€‚</li>
</ul>
</li>
<li>
<p><strong>è‡ªå®šä¹‰äº¤äº’</strong>: é€šè¿‡ <code>#toolbar</code> æ’æ§½ï¼Œæ‚¨å¯ä»¥å®šä¹‰å½“ç”¨æˆ·é€‰ä¸­ä¸€ä¸ªæ–‡æœ¬å—æ—¶æµ®ç°çš„å·¥å…·æ å†…å®¹ã€‚è¯¥æ’æ§½ä¼šå›ä¼ å½“å‰é€‰ä¸­çš„ <code>block</code> å¯¹è±¡ï¼Œæ‚¨å¯ä»¥ç»“åˆ <code>&lt;ToolbarButton&gt;</code> æˆ–å…¶ä»–è‡ªå®šä¹‰ç»„ä»¶ï¼Œæ¥å®ç°å…·ä½“çš„äº¤äº’é€»è¾‘ï¼Œä¾‹å¦‚è°ƒç”¨ <code>handleAction</code> å‡½æ•°å¤„ç†è¯¥æ–‡æœ¬å—çš„æ•°æ®ã€‚</p>
</li>
</ol>
<p>æŒæ¡äº†åŸºæœ¬ç”¨æ³•åï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥æ¢ç´¢ <code>vue-pdf-interactor</code> åœ¨çœŸå®ä¸šåŠ¡åœºæ™¯ä¸­çš„å·¨å¤§æ½œåŠ›ã€‚</p>
<h2 data-id="heading-14">5.0 å…¸å‹åº”ç”¨åœºæ™¯åˆ†æ</h2>
<p>æœ¬ç« èŠ‚å°†è¶…è¶ŠæŠ€æœ¯å®ç°çš„ç»†èŠ‚ï¼Œæ¢è®¨ <code>vue-pdf-interactor</code> åœ¨å®é™…ä¸šåŠ¡åº”ç”¨ä¸­èƒ½å¤Ÿè§£å†³çš„å…·ä½“é—®é¢˜å’Œåˆ›é€ çš„ä»·å€¼ã€‚å…¶æ ¸å¿ƒçš„ OCR æ–‡æœ¬äº¤äº’èƒ½åŠ›ï¼Œä½¿å…¶æˆä¸ºå¤šä¸ªè¡Œä¸šæ•°å­—åŒ–è½¬å‹çš„æœ‰åŠ›å·¥å…·ã€‚</p>
<ul>
<li><strong>æ™ºèƒ½æ–‡æ¡£å®¡æŸ¥ä¸æ ‡æ³¨</strong> åœ¨æ³•å¾‹ã€é‡‘èã€ç§‘ç ”ç­‰é¢†åŸŸï¼Œä¸“ä¸šäººå£«éœ€è¦å¤„ç†å¤§é‡çš„åˆåŒã€è´¢æŠ¥æˆ–å­¦æœ¯è®ºæ–‡ã€‚åˆ©ç”¨ <code>vue-pdf-interactor</code>ï¼Œå¯ä»¥å°†è¿™äº›é™æ€æ–‡æ¡£è½¬åŒ–ä¸ºåŠ¨æ€çš„å®¡æŸ¥å·¥å…·ã€‚ç”¨æˆ·å¯ä»¥ç²¾ç¡®é«˜äº®å…³é”®æ¡æ¬¾ã€æ•°æ®ç‚¹æˆ–å‚è€ƒæ–‡çŒ®ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰å·¥å…·æ ä¸€é”®è§¦å‘åŠ¨ä½œï¼ˆå¦‚æ·»åŠ æ‰¹æ³¨æˆ–æå–æ•°æ®ï¼‰ï¼Œä»è€Œæå¤§åœ°å‡å°‘äººå·¥å®¡æŸ¥æ—¶é—´ï¼Œå¹¶é™ä½é«˜é£é™©ç¯å¢ƒä¸­çš„äººä¸ºé”™è¯¯é£é™©ã€‚</li>
<li><strong>äº¤äº’å¼åœ¨çº¿æ•™è‚²ææ–™</strong> ä¼ ç»Ÿçš„ PDF æ•™ææˆ–æ‰«æç‰ˆè¯•å·ç¼ºä¹äº’åŠ¨æ€§ã€‚é›†æˆ <code>vue-pdf-interactor</code> åï¼Œè¿™äº›é™æ€ææ–™å¯ä»¥è¢«èµ‹äºˆæ–°çš„ç”Ÿå‘½ã€‚æ•™å¸ˆå¯ä»¥é¢„è®¾ç‰¹å®šçš„æ–‡æœ¬å—ä¸ºé—®é¢˜è§¦å‘ç‚¹ï¼›å­¦ç”Ÿä¹Ÿå¯ä»¥è‡ªç”±é€‰æ‹©æ–‡æœ¬æ®µè½ï¼Œé€šè¿‡è‡ªå®šä¹‰å·¥å…·æ è¿›è¡Œåœ¨çº¿æŸ¥è¯æˆ–ç”Ÿæˆç¬”è®°ã€‚è¿™å°†é™æ€çš„å†…å®¹æ¶ˆè´¹è½¬å˜ä¸ºä¸€ç§ä¸»åŠ¨çš„å­¦ä¹ ä½“éªŒï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å­¦ç”Ÿçš„å‚ä¸åº¦å’ŒçŸ¥è¯†ä¿ç•™ç‡ã€‚</li>
<li><strong>æ•°å­—åŒ–æ¡£æ¡ˆä¸çŸ¥è¯†åº“</strong> è®¸å¤šä¼ä¸šå’Œæœºæ„æ‹¥æœ‰æµ·é‡çš„å†å²æ‰«æä»¶æ¡£æ¡ˆï¼Œè¿™äº›ä¿¡æ¯èµ„äº§ç”±äºéš¾ä»¥æ£€ç´¢å’Œåˆ©ç”¨è€Œå¤„äºâ€œæ²‰ç¡â€çŠ¶æ€ã€‚é€šè¿‡ <code>vue-pdf-interactor</code> çš„ OCR äº¤äº’åŠŸèƒ½ï¼Œå‘˜å·¥å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å¯¹æ‰«æçš„åˆåŒã€å›¾çº¸æˆ–æŠ¥å‘Šè¿›è¡Œæ–‡æœ¬é€‰æ‹©ã€å¤åˆ¶å’Œå†…å®¹å…³è”ï¼Œä»è€Œæœ‰æ•ˆåœ°å°†ä¼‘çœ çš„æ•°æ®èµ„äº§è´§å¸åŒ–ï¼Œå¹¶æ„å»ºä¸€ä¸ªå¯æœç´¢ã€é«˜ä»·å€¼çš„ä¼ä¸šçŸ¥è¯†åº“ã€‚</li>
</ul>
<h2 data-id="heading-15">6.0 å¼€å‘è€…ç”Ÿæ€ä¸è®¸å¯</h2>
<p>ä¸€ä¸ªæˆåŠŸçš„å¼€æºé¡¹ç›®ä¸ä»…éœ€è¦å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ›´ä¾èµ–äºä¸€ä¸ªå¥åº·ã€å¼€æ”¾çš„å¼€å‘è€…ç”Ÿæ€ç³»ç»Ÿã€‚<code>vue-pdf-interactor</code> åœ¨é¡¹ç›®ç®¡ç†å’Œè®¸å¯åè®®æ–¹é¢éƒ½ä¸ºç¤¾åŒºå‚ä¸å’Œå•†ä¸šåº”ç”¨æä¾›äº†ä¾¿åˆ©ã€‚</p>
<h3 data-id="heading-16">6.1 å¼€å‘ä¸è´¡çŒ®</h3>
<p>é¡¹ç›®æä¾›äº†ä¸€å¥—æ ‡å‡†åŒ–çš„å¼€å‘è„šæœ¬ï¼Œä¸ºç¤¾åŒºè´¡çŒ®è€…æä¾›äº†ä¸€ä¸ªä½é—¨æ§›çš„å¼€å‘ç¯å¢ƒï¼Œç¡®ä¿ä»»ä½•å¼€å‘è€…éƒ½èƒ½å¿«é€Ÿæ­å»ºç¯å¢ƒå¹¶éµå¾ªç»Ÿä¸€æ ‡å‡†è¿›è¡Œè´¡çŒ®ã€‚</p>
<ul>
<li><code>pnpm install</code>: å®‰è£…æ‰€æœ‰é¡¹ç›®ä¾èµ–ã€‚</li>
<li><code>pnpm dev</code>: å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼Œè¿›è¡Œå®æ—¶è°ƒè¯•ã€‚</li>
<li><code>pnpm type-check</code>: è¿è¡Œ TypeScript ç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚</li>
<li><code>pnpm build</code>: æ‰§è¡Œæ„å»ºæµç¨‹ï¼Œç”Ÿæˆæœ€ç»ˆçš„åˆ†å‘æ–‡ä»¶ã€‚</li>
<li><code>pnpm preview</code>: åœ¨æœ¬åœ°é¢„è§ˆæ„å»ºåçš„äº§ç‰©ã€‚</li>
</ul>
<h3 data-id="heading-17">6.2 ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ</h3>
<p><code>vue-pdf-interactor</code> é‡‡ç”¨äº†ä¸€å¥—è§„èŒƒåŒ–çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒå‘½ä»¤ï¼Œä¾‹å¦‚ <code>pnpm version:patch</code>ï¼ˆç”¨äºæ›´æ–° <code>package.json</code> å¹¶åˆ›å»ºç›¸åº”çš„ git æ ‡ç­¾ï¼‰å’Œ <code>pnpm release:patch</code>ã€‚è¿™å¥—æµç¨‹ç¡®ä¿äº†ï¼š</p>
<ul>
<li><strong>ç‰ˆæœ¬å·è§„èŒƒ</strong>: ä¸¥æ ¼éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ï¼ˆSemVerï¼‰ï¼Œä½¿ç‰ˆæœ¬è¿­ä»£æ¸…æ™°å¯è¿½æº¯ã€‚</li>
<li><strong>å‘å¸ƒå¯é æ€§</strong>: å‘å¸ƒæµç¨‹ä¸­é›†æˆäº† <code>prepublishOnly</code> é’©å­ï¼Œå®ƒä¼šåœ¨å‘å¸ƒåˆ° npm å‰è‡ªåŠ¨æ‰§è¡Œæ„å»ºå’Œç±»å‹æ£€æŸ¥ã€‚è¿™ç¡®ä¿äº†åªæœ‰æˆåŠŸæ„å»ºä¸”é€šè¿‡ç±»å‹æ£€æŸ¥çš„ä»£ç æ‰èƒ½è¢«å‘å¸ƒï¼Œæ˜¯ä¿éšœå‘å¸ƒå¯é æ€§çš„å…³é”®æ”¯æŸ±ã€‚</li>
</ul>
<h3 data-id="heading-18">6.3 å¼€æºè®¸å¯è¯</h3>
<p>è¯¥é¡¹ç›®é‡‡ç”¨ <strong>MIT è®¸å¯è¯</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªå¯¹å•†ä¸šåº”ç”¨æä¸ºå‹å¥½çš„å®½æ¾å¼€æºåè®®ï¼Œå®ƒèµ‹äºˆäº†ä½¿ç”¨è€…æå¤§çš„è‡ªç”±ï¼ŒåŒ…æ‹¬è‡ªç”±åœ°ä¿®æ”¹ä»£ç ã€äºŒæ¬¡åˆ†å‘ä»¥åŠåœ¨å•†ä¸šäº§å“ä¸­ä½¿ç”¨ï¼Œè€Œæ— é¡»æ‹…å¿ƒå¤æ‚çš„è®¸å¯é™åˆ¶æˆ–è´¹ç”¨ã€‚é€‰æ‹© MIT è®¸å¯è¯ï¼Œæ¶ˆé™¤äº†ä¼ä¸šå’Œä¸ªäººå¼€å‘è€…åœ¨æŠ€æœ¯é€‰å‹æ—¶çš„åé¡¾ä¹‹å¿§ï¼Œé¼“åŠ±äº†æ›´å¹¿æ³›çš„åº”ç”¨å’Œç¤¾åŒºè´¡çŒ®ã€‚</p>
<h2 data-id="heading-19">7.0 ç»“è®º</h2>
<p><code>vue-pdf-interactor</code> ä¸ä»…ä»…æ˜¯å¯¹ç°æœ‰ PDF æŸ¥çœ‹æ–¹æ¡ˆçš„ç®€å•è¡¥å……ï¼Œå®ƒæ›´æ˜¯ä¸€ä¸ªåˆ›æ–°çš„è¿æ¥å™¨ï¼Œä¸€åº§è¿æ¥é™æ€æ–‡æ¡£ä¸–ç•Œä¸åŠ¨æ€ Web åº”ç”¨çš„æ¡¥æ¢ã€‚é€šè¿‡å…¶ç‹¬ç‰¹çš„è®¾è®¡ï¼Œå®ƒæˆåŠŸåœ°å°†åŸæœ¬åªè¯»çš„ PDF å†…å®¹è½¬åŒ–ä¸ºäº†å¯äº¤äº’ã€å¯ç¼–ç¨‹çš„æ•°æ®æºã€‚</p>
<p>ç»¼åˆæ¥çœ‹ï¼Œè¯¥ç»„ä»¶åº“çš„æ ¸å¿ƒä¼˜åŠ¿ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½åˆ›æ–°</strong>: ä»¥ OCR æ–‡æœ¬äº¤äº’ä¸ºæ ¸å¿ƒï¼Œè§£å†³äº†æ‰«æç‰ˆ PDF ç­‰â€œç¡¬éª¨å¤´â€çš„äº¤äº’éš¾é¢˜ã€‚</li>
<li><strong>æ¶æ„ç¨³å¥</strong>: ä¾æ‰˜äº <code>vue-pdf-embed</code> çš„åšå®åŸºç¡€ï¼Œå¹¶é€‰ç”¨ç°ä»£åŒ–ã€é«˜è´¨é‡çš„ä¾èµ–æ ˆï¼Œä¿è¯äº†å…¶ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚</li>
<li><strong>å¼€å‘è€…å‹å¥½</strong>: å®Œæ•´çš„ TypeScript æ”¯æŒã€æ ‡å‡†çš„å·¥ç¨‹åŒ–è„šæœ¬ä»¥åŠå®½æ¾çš„ MIT è®¸å¯è¯ï¼Œå…±åŒæ„å»ºäº†ä¸€ä¸ªå¯¹å¼€å‘è€…å’Œå•†ä¸šåº”ç”¨éƒ½æä¸ºå‹å¥½çš„ç”Ÿæ€ç³»ç»Ÿã€‚</li>
</ul>
<p>å±•æœ›æœªæ¥ï¼Œéšç€ Web åº”ç”¨å¯¹æ–‡æ¡£å¤„ç†èƒ½åŠ›çš„è¦æ±‚æ—¥ç›Šæé«˜ï¼Œ<code>vue-pdf-interactor</code> æœ‰æ½œåŠ›æˆä¸ºå„ç±»æ™ºèƒ½æ–‡æ¡£å¤„ç†ã€æ•°æ®æ ‡æ³¨å’Œåœ¨çº¿åä½œå¹³å°çš„å…³é”®åŸºç¡€è®¾æ–½ï¼ŒæŒç»­æ¨åŠ¨ Web æ–‡æ¡£äº¤äº’ä½“éªŒå‘å‰å‘å±•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7585789195868733476</link>    <guid>https://juejin.cn/post/7585789195868733476</guid>    <pubDate>2025-12-21T12:57:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585789195868733476" data-draft-id="7576369868418957348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T12:57:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¨é¡µé¢é€šè®¯ç»ˆææŒ‡å—â‘§ï¼šCookie ç”¨æ³•å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T12:57:27.000Z" title="Sun Dec 21 2025 12:57:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¹‹å‰ä»‹ç»äº†å¾ˆå¤šå‰ç«¯è·¨é¡µé¢é€šè®¯çš„æ–¹æ¡ˆï¼Œä»Šå¤©ä»‹ç»ä¸‹Cookieï¼ŒCookieè‡ªèº«æœ‰â€œåŒæºå…±äº«â€çš„ç‰¹æ€§ï¼Œä½†å› ä¸ºç¼ºå°‘æ•°æ®å˜åŒ–çš„ä¸»åŠ¨é€šçŸ¥æœºåˆ¶ï¼Œåªèƒ½ä½¿ç”¨â€œè½®è¯¢â€å¼¥è¡¥è¿™ä¸€ç¼ºé™·ã€‚</p>
<p>æœ¬æ–‡å°†ä½¿ç”¨Cookieè½®è¯¢ï¼Œè¿›è¡Œè·¨é¡µé¢é€šè®¯ã€‚</p>
<h2 data-id="heading-1">1. Cookie è½®è¯¢åŸºæœ¬åŸç†</h2>
<p>Cookieè½®è¯¢é€šè¿‡â€œå­˜å‚¨-å®šæœŸæ£€æŸ¥-å·®å¼‚å¤„ç†â€çš„æ ¸å¿ƒé€»è¾‘å®ç°è·¨é¡µé¢é€šè®¯ï¼Œå…·ä½“æµç¨‹ä¸ºï¼š</p>
<ol>
<li>ä¸€ä¸ªé¡µé¢å°†æ¶ˆæ¯ï¼ˆå¦‚çŠ¶æ€ã€æŒ‡ä»¤ç­‰ï¼‰ç»“æ„åŒ–åå­˜å‚¨åˆ°Cookieä¸­ï¼›</li>
<li>å…¶ä»–åŒæºé¡µé¢é€šè¿‡å®šæ—¶ä»»åŠ¡å®šæœŸè¯»å–ç›®æ ‡Cookieï¼›</li>
<li>å¯¹æ¯”å½“å‰Cookieå€¼ä¸å†å²åŸºå‡†å€¼ï¼Œè‹¥å‘ç°å†…å®¹å˜åŒ–åˆ™è¯»å–å¹¶å¤„ç†æ¶ˆæ¯ï¼›</li>
<li>æ›´æ–°åŸºå‡†å€¼ï¼Œå®Œæˆä¸€æ¬¡è·¨é¡µé¢é€šè®¯é—­ç¯ã€‚</li>
</ol>
<p>éœ€ç‰¹åˆ«æ³¨æ„ï¼šCookieçš„<code>domain</code>å’Œ<code>path</code>é…ç½®æ˜¯è½®è¯¢ç”Ÿæ•ˆçš„å‰æâ€”â€”å†™å…¥æ–¹ä¸è½®è¯¢æ–¹éœ€é…ç½®ä¸€è‡´çš„ä½œç”¨åŸŸï¼ˆå¦‚æ ¹è·¯å¾„<code>/</code>ã€æ ¹åŸŸå<code>example.com</code>ï¼‰ï¼Œå¦åˆ™è½®è¯¢æ–¹æ— æ³•è¯»å–ç›®æ ‡Cookieï¼Œå¯¼è‡´é€šè®¯å¤±æ•ˆã€‚</p>
<h3 data-id="heading-2">2. æ¡ˆä¾‹ä»£ç </h3>
<h3 data-id="heading-3">2.1 Cookie è½®è¯¢å®Œæ•´å®ç°</h3>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è®¾ç½® Cookie
function setCookie(name, value, <span class="hljs-attr">days</span> = <span class="hljs-number">1</span>) {
    const <span class="hljs-attr">date</span> = new Date()<span class="hljs-comment">;</span>
    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000))<span class="hljs-comment">;</span>
    const <span class="hljs-attr">expires</span> = &amp;<span class="hljs-comment">#34;expires=&amp;#34; + date.toUTCString();</span>
    <span class="hljs-attr">document.cookie</span> = name + &amp;<span class="hljs-comment">#34;=&amp;#34; + encodeURIComponent(value) + &amp;#34;;&amp;#34; + expires + &amp;#34;;path=/&amp;#34;;</span>
    updateCookieDisplay()<span class="hljs-comment">;</span>
}

// è·å– Cookie
function getCookie(name) {
    const <span class="hljs-attr">nameEQ</span> = name + &amp;<span class="hljs-comment">#34;=&amp;#34;;</span>
    const <span class="hljs-attr">ca</span> = document.cookie.split(<span class="hljs-string">';'</span>)<span class="hljs-comment">;</span>
    for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; ca.length; i++) {</span>
        let <span class="hljs-attr">c</span> = ca[i]<span class="hljs-comment">;</span>
        while (c.charAt(0) === ' ') <span class="hljs-attr">c</span> = c.substring(<span class="hljs-number">1</span>, c.length)<span class="hljs-comment">;</span>
        if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length))<span class="hljs-comment">;</span>
    }
    return null<span class="hljs-comment">;</span>
}

// åˆ é™¤ Cookie
function deleteCookie(name) {
    <span class="hljs-attr">document.cookie</span> = name + &amp;<span class="hljs-comment">#34;=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;&amp;#34;;</span>
    updateCookieDisplay()<span class="hljs-comment">;</span>
}

// å‘é€æ¶ˆæ¯ï¼ˆCookie æ–¹å¼ï¼‰
function sendMessageByCookie(content) {
    // ç¡®å®šé€šè®¯ç±»å‹
    let <span class="hljs-attr">communicationType</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
    if (isChild) {
        <span class="hljs-attr">communicationType</span> = <span class="hljs-string">'å­çˆ¶é€šè®¯'</span><span class="hljs-comment">;</span>
    } else {
        <span class="hljs-attr">communicationType</span> = <span class="hljs-string">'çˆ¶å­é€šè®¯'</span><span class="hljs-comment">;</span>
    }
    
    const <span class="hljs-attr">message</span> = {
        id: Date.now(),
        content: content,
        sender: clientId,
        timestamp: Date.now(),
        method: 'cookie',
        communicationType: communicationType
    }<span class="hljs-comment">;</span>
    
    const <span class="hljs-attr">cookieValue</span> = JSON.stringify(message)<span class="hljs-comment">;</span>
    setCookie(COOKIE_NAME, cookieValue)<span class="hljs-comment">;</span>
    addLog(`é€šè¿‡ Cookie å‘é€æ¶ˆæ¯: ${content}`, 'å‘é€', communicationType)<span class="hljs-comment">;</span>
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7699e133af4841c19ad68f2808ca6043~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766926647&amp;x-signature=RzCQYN68GokqSfgrKKVeO8mh0FM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">3.2 æ€»ç»“</h3>
<p>Cookieè½®è¯¢æ˜¯ä¸€ç§å…¼å®¹æ€§æå¼ºçš„è·¨é¡µé¢é€šè®¯æ–¹æ¡ˆï¼Œæ— éœ€ä¾èµ–ç°ä»£APIï¼Œå¯åœ¨è€æ—§æµè§ˆå™¨ä¸­ç¨³å®šè¿è¡Œã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿æ˜¯å®ç°ç®€å•ã€é…ç½®çµæ´»ï¼Œé€‚ç”¨äºä½é¢‘ç‡æ¶ˆæ¯åŒæ­¥åœºæ™¯ï¼ˆå¦‚ç™»å½•çŠ¶æ€ã€ç”¨æˆ·åå¥½è®¾ç½®ï¼‰ã€‚ä½¿ç”¨æ—¶éœ€é‡ç‚¹å…³æ³¨Cookieä½œç”¨åŸŸé…ç½®å’Œè½®è¯¢æ€§èƒ½å¹³è¡¡ï¼Œé€šè¿‡ç»“æ„åŒ–æ¶ˆæ¯è®¾è®¡å’Œå¼‚å¸¸å¤„ç†æå‡æ–¹æ¡ˆå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ]]></title>    <link>https://juejin.cn/post/7585743487258607625</link>    <guid>https://juejin.cn/post/7585743487258607625</guid>    <pubDate>2025-12-21T11:06:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585743487258607625" data-draft-id="7585534343562756146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-21T11:06:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:06:28.000Z" title="Sun Dec 21 2025 11:06:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šæœ¬æ–‡è¯¦è§£AIæµå¼å“åº”ä¸­æ–­æœºåˆ¶ï¼šå½“å®¢æˆ·ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥ï¼ˆå¦‚å–æ¶ˆè¯·æ±‚æˆ–å…³é—­æµï¼‰ï¼ŒæœåŠ¡å™¨ä¼šç«‹å³åœæ­¢ç”Ÿæˆtokenï¼Œé¿å…èµ„æºæµªè´¹ã€‚ç»“åˆPythonç¤ºä¾‹ï¼Œä»‹ç»å¦‚ä½•åœ¨å¤šçº¿ç¨‹ã€å¼‚æ­¥ç­‰åœºæ™¯ä¸‹ä¼˜é›…å®ç°ä¸­æ–­ï¼Œå¹¶æ¾„æ¸…å¸¸è§è¯¯åŒºã€‚</p>
<h2 data-id="heading-0"><strong>æµå¼å“åº”ä¸­æ–­ï¼šå¦‚ä½•ä¼˜é›…åœæ­¢AIæ¨¡å‹çš„æµå¼ç”Ÿæˆ</strong></h2>
<p>åœ¨AIæ¨¡å‹çš„æµå¼å“åº”ï¼ˆStreaming APIï¼‰è°ƒç”¨ä¸­ï¼Œç”¨æˆ·å¸¸å¸¸éœ€è¦åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ä¸»åŠ¨ä¸­æ–­å“åº”ã€‚ä¾‹å¦‚ï¼Œåœ¨èŠå¤©æœºå™¨äººä¸­ï¼Œç”¨æˆ·å¯èƒ½ç‚¹å‡»â€œåœæ­¢â€æŒ‰é’®ï¼Œæˆ–åœ¨ä»£ç ä¸­å‘ç°é”™è¯¯æ—¶éœ€è¦ç«‹å³ç»ˆæ­¢æµå¼è¾“å‡ºã€‚ç„¶è€Œï¼Œ<strong>æµå¼ä¸­æ–­æ˜¯å¦çœŸçš„èƒ½ç«‹å³åœæ­¢æœåŠ¡å™¨ç«¯çš„ç”Ÿæˆï¼Ÿä¸­æ–­ååå°æ˜¯å¦ä»åœ¨ç»§ç»­è®¡ç®—ï¼Ÿ</strong> è¿™æ˜¯å¼€å‘è€…åœ¨å®é™…åº”ç”¨ä¸­å¿…é¡»æ˜ç¡®çš„å…³é”®é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†ä»<strong>æŠ€æœ¯åŸç†</strong>ã€<strong>å®ç°æ–¹å¼</strong>å’Œ<strong>æœ€ä½³å®è·µ</strong>ä¸‰ä¸ªç»´åº¦ï¼Œæ·±å…¥è§£ææµå¼å“åº”ä¸­æ–­çš„æœºåˆ¶ï¼Œå¹¶æä¾›å¯è½åœ°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€æµå¼ä¸­æ–­çš„æœ¬è´¨ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„ååŒ</h3>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯æµå¼å“åº”ï¼Ÿ</h4>
<p>æµå¼å“åº”ï¼ˆStreaming APIï¼‰å…è®¸æœåŠ¡å™¨åœ¨æ¨¡å‹ç”Ÿæˆå†…å®¹çš„åŒæ—¶é€æ­¥è¿”å›ç»“æœï¼Œè€Œéç­‰å¾…å®Œæ•´è¾“å‡ºã€‚ä¾‹å¦‚ï¼ŒOpenAI çš„ <code>stream=True</code> å‚æ•°ä¼šé€šè¿‡ <strong>Server-Sent Events (SSE)</strong> åè®®ï¼Œå°†ç”Ÿæˆçš„ token åˆ†æ‰¹æ¬¡æ¨é€åˆ°å®¢æˆ·ç«¯ã€‚</p>
<h4 data-id="heading-3">1.2 ä¸­æ–­çš„è§¦å‘æœºåˆ¶</h4>
<p>å½“å®¢æˆ·ç«¯ä¸»åŠ¨ä¸­æ–­æµå¼è¯·æ±‚ï¼ˆå¦‚å…³é—­è¿æ¥ã€å–æ¶ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šæ£€æµ‹åˆ°è¿æ¥çŠ¶æ€çš„å˜åŒ–å¹¶<strong>ç«‹å³åœæ­¢ç”Ÿæˆ</strong>ã€‚OpenAI å®˜æ–¹æ–‡æ¡£æ˜ç¡®è¯´æ˜ï¼š</p>
<blockquote>
<p><em>"If the client disconnects from the stream before the response is complete, the server will stop generating tokens and close the connection."</em><br/>
ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference%2Fchat%2Fcreate%23chat-create-stream" target="_blank" title="https://platform.openai.com/docs/api-reference/chat/create#chat-create-stream" ref="nofollow noopener noreferrer">OpenAI API Docs</a>ï¼‰</p>
</blockquote>
<p>è¿™æ„å‘³ç€ï¼Œ<strong>ä¸­æ–­æ“ä½œä¼šåŒæ­¥å½±å“æœåŠ¡å™¨ç«¯çš„è®¡ç®—è¡Œä¸º</strong>ï¼Œè€Œéä»…åœ¨å®¢æˆ·ç«¯â€œå‡è£…â€åœæ­¢ã€‚</p>
<hr/>
<h3 data-id="heading-4">äºŒã€ä¸­æ–­åçš„è¡Œä¸ºéªŒè¯ï¼šä»£ç å®éªŒ</h3>
<h4 data-id="heading-5">2.1 Python ä¸­çš„æµå¼è°ƒç”¨</h4>
<p>ä»¥ OpenAI Python SDK ä¸ºä¾‹ï¼Œä»¥ä¸‹ä»£ç æ¼”ç¤ºäº†ä¸­æ–­æµå¼å“åº”çš„è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> AsyncOpenAI
<span class="hljs-keyword">import</span> asyncio

client = AsyncOpenAI()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">stream_response</span>():
    stream = <span class="hljs-keyword">await</span> client.chat.completions.create(
        model=<span class="hljs-string">"gpt-4o-mini"</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·é‡å¤è¾“å‡º 'Hello' åæ¬¡"</span>}],
        stream=<span class="hljs-literal">True</span>
    )
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> stream:
        <span class="hljs-built_in">print</span>(chunk.choices[<span class="hljs-number">0</span>].delta.content, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-string">"Hello"</span> <span class="hljs-keyword">in</span> chunk.choices[<span class="hljs-number">0</span>].delta.content:
            <span class="hljs-keyword">break</span>  <span class="hljs-comment"># æ‰‹åŠ¨ä¸­æ–­å¾ªç¯</span>

<span class="hljs-keyword">try</span>:
    asyncio.run(stream_response())
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸­æ–­å¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h5 data-id="heading-6">è¡Œä¸ºåˆ†æï¼š</h5>
<ul>
<li>å½“ <code>break</code> ä¸­æ–­å¾ªç¯åï¼Œåº•å±‚ HTTP è¿æ¥ä¼šè¢«å…³é—­ã€‚</li>
<li>OpenAI æœåŠ¡å™¨æ£€æµ‹åˆ°è¿æ¥æ–­å¼€ï¼Œç«‹å³åœæ­¢ç”Ÿæˆåç»­ tokenã€‚</li>
<li><strong>éªŒè¯æ–¹å¼</strong>ï¼šé€šè¿‡ç›‘æ§ API è°ƒç”¨çš„ token ä½¿ç”¨é‡ï¼Œè‹¥ä¸­æ–­åä¸å†è®¡è´¹ï¼Œåˆ™è¯æ˜ç”Ÿæˆå·²åœæ­¢ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-7">2.2 æµå¼ä¸­æ–­çš„åº•å±‚åŸç†</h4>
<p>æµå¼ä¸­æ–­ä¾èµ–äº <strong>HTTP åè®®çš„è¿æ¥çŠ¶æ€</strong>ï¼š</p>
<ol>
<li><strong>å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥</strong>ï¼šå‘é€ <code>FIN</code> åŒ…æˆ– <code>RST</code> åŒ…ã€‚</li>
<li><strong>æœåŠ¡å™¨ç«¯ç›‘å¬è¿æ¥çŠ¶æ€</strong>ï¼šæ£€æµ‹åˆ°è¿æ¥å…³é—­åï¼Œç»ˆæ­¢æ¨¡å‹æ¨ç†ä»»åŠ¡ã€‚</li>
<li><strong>èµ„æºé‡Šæ”¾</strong>ï¼šGPU/CPU è®¡ç®—èµ„æºè¢«å›æ”¶ï¼Œé¿å…æµªè´¹ã€‚</li>
</ol>
<p>è¿™ä¸€æœºåˆ¶åœ¨ OpenAI çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fgpt" target="_blank" title="https://platform.openai.com/docs/guides/gpt" ref="nofollow noopener noreferrer">æŠ€æœ¯ç™½çš®ä¹¦</a> ä¸­è¢«æè¿°ä¸º <strong>â€œæµå¼å“åº”çš„ä¼˜é›…ç»ˆæ­¢â€</strong> ã€‚</p>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€å®ç°æµå¼ä¸­æ–­çš„æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-9">3.1 Python ä¸­çš„å¼‚æ­¥ä¸­æ–­</h4>
<p>ä½¿ç”¨ <code>asyncio.Task</code> å¯å®‰å…¨å–æ¶ˆæµå¼ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> AsyncOpenAI

client = AsyncOpenAI()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">stream_task</span>():
    stream = <span class="hljs-keyword">await</span> client.chat.completions.create(
        model=<span class="hljs-string">"gpt-4o-mini"</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·ç”Ÿæˆä¸€æ®µé•¿æ–‡æœ¬"</span>}],
        stream=<span class="hljs-literal">True</span>
    )
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> stream:
        <span class="hljs-built_in">print</span>(chunk.choices[<span class="hljs-number">0</span>].delta.content, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿå¤„ç†å»¶è¿Ÿ</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    task = asyncio.create_task(stream_task())
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿç­‰å¾…2ç§’åä¸­æ–­</span>
    task.cancel()  <span class="hljs-comment"># å–æ¶ˆä»»åŠ¡</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">await</span> task
    <span class="hljs-keyword">except</span> asyncio.CancelledError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næµå¼ä»»åŠ¡å·²å–æ¶ˆ"</span>)

asyncio.run(main())
</code></pre>
<h5 data-id="heading-10">å…³é”®ç‚¹ï¼š</h5>
<ul>
<li><code>task.cancel()</code> ä¼šè§¦å‘ <code>CancelledError</code>ï¼Œç¡®ä¿èµ„æºé‡Šæ”¾ã€‚</li>
<li>éœ€åœ¨ <code>except</code> å—ä¸­å¤„ç†å¼‚å¸¸ï¼Œé¿å…ç¨‹åºå´©æºƒã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-11">3.2 å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„ä¸­æ–­ï¼ˆPythonï¼‰</h4>
<p>åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå¯ä½¿ç”¨ <code>threading.Event</code> åè°ƒä¸­æ–­é€»è¾‘ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import threading
import time
from openai import OpenAI

<span class="hljs-attr">client</span> = OpenAI()
<span class="hljs-attr">stop_event</span> = threading.Event()

def stream_worker():
    <span class="hljs-attr">stream</span> = client.chat.completions.create(
        <span class="hljs-attr">model</span>=<span class="hljs-string">"gpt-4o-mini"</span>,
        <span class="hljs-attr">messages</span>=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¯·ç”Ÿæˆä¸€æ®µé•¿æ–‡æœ¬"</span>}],
        <span class="hljs-attr">stream</span>=<span class="hljs-literal">True</span>
    )
    for chunk in stream:
        if stop_event.is_set():
            break
        print(chunk.choices<span class="hljs-section">[0]</span>.delta.content, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)

<span class="hljs-attr">thread</span> = threading.Thread(target=stream_worker)
thread.start()
time.sleep(3)  <span class="hljs-comment"># æ¨¡æ‹Ÿç­‰å¾…3ç§’åä¸­æ–­</span>
stop_event.set()  <span class="hljs-comment"># è®¾ç½®åœæ­¢ä¿¡å·</span>
thread.join()
</code></pre>
<h5 data-id="heading-12">ä¼˜åŠ¿ï¼š</h5>
<ul>
<li><code>Event</code> æä¾›çº¿ç¨‹å®‰å…¨çš„ä¸­æ–­æ ‡å¿—ã€‚</li>
<li>æ— éœ€ç›´æ¥æ“ä½œåº•å±‚è¿æ¥ï¼Œé€»è¾‘æ›´æ¸…æ™°ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13">å››ã€å¸¸è§è¯¯åŒºä¸è§£å†³æ–¹æ¡ˆ</h3>





















<table><thead><tr><th>è¯¯åŒº</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>ä¸­æ–­åæœåŠ¡å™¨ä»åœ¨ç”Ÿæˆ</strong></td><td>ç¡®ä¿å®¢æˆ·ç«¯æ­£ç¡®å…³é—­è¿æ¥ï¼ˆå¦‚ <code>resp.close()</code> æˆ– <code>controller.abort()</code>ï¼‰ã€‚</td></tr><tr><td><strong>ä¸­æ–­åæ— æ³•æ¢å¤</strong></td><td>æµå¼å“åº”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œéœ€é‡æ–°å‘èµ·è¯·æ±‚ã€‚</td></tr><tr><td><strong>å¤šçº¿ç¨‹ä¸­æ–­ä¸ç”Ÿæ•ˆ</strong></td><td>ä½¿ç”¨ <code>threading.Event</code> æˆ– <code>asyncio</code> åè°ƒçº¿ç¨‹/åç¨‹çŠ¶æ€ã€‚</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-14">äº”ã€æ€»ç»“</h3>
<p>æµå¼å“åº”çš„ä¸­æ–­æœºåˆ¶æ˜¯ AI åº”ç”¨å¼€å‘ä¸­çš„å…³é”®èƒ½åŠ›ã€‚é€šè¿‡å®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼ŒæœåŠ¡å™¨ä¼šç«‹å³åœæ­¢ç”Ÿæˆ tokenï¼Œä»è€ŒèŠ‚çœè®¡ç®—èµ„æºå¹¶æå‡ç”¨æˆ·ä½“éªŒã€‚å¼€å‘è€…éœ€æ ¹æ®æ‰€é€‰è¯­è¨€/æ¡†æ¶ï¼ˆå¦‚ Pythonã€JavaScriptï¼‰é€‰æ‹©åˆé€‚çš„ä¸­æ–­å·¥å…·ï¼ˆå¦‚ <code>asyncio.Task</code>ã€<code>AbortController</code>ï¼‰ï¼Œå¹¶éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong>ï¼šä¸­æ–­åå…³é—­è¿æ¥ï¼Œé¿å…èµ„æºæ³„æ¼ã€‚</li>
<li><strong>å¤„ç†å¼‚å¸¸</strong>ï¼šæ•è·ä¸­æ–­å¼‚å¸¸ï¼Œç¡®ä¿ç¨‹åºå¥å£®æ€§ã€‚</li>
<li><strong>ç”¨æˆ·äº¤äº’å‹å¥½</strong>ï¼šä¸ºç”¨æˆ·æä¾›â€œåœæ­¢â€æŒ‰é’®ï¼Œå“åº”ç”¨æˆ·æ„å›¾ã€‚</li>
</ol>
<p>æŒæ¡è¿™äº›æŠ€æœ¯ï¼Œå°†å¸®åŠ©ä½ åœ¨æ„å»ºå®æ—¶ AI åº”ç”¨æ—¶ï¼Œå®ç°æ›´é«˜æ•ˆã€æ›´å¯é çš„æµå¼äº¤äº’ä½“éªŒã€‚</p>
<hr/>
</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7585534343562821682</link>    <guid>https://juejin.cn/post/7585534343562821682</guid>    <pubDate>2025-12-21T11:16:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562821682" data-draft-id="7585645111875846171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2025-12-21T11:16:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[GammaToLinearSpaceExactèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:16:10.000Z" title="Sun Dec 21 2025 11:16:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>GammaToLinearSpaceExactèŠ‚ç‚¹æ˜¯Unity URP Shader Graphä¸­ç”¨äºè‰²å½©ç©ºé—´è½¬æ¢çš„é‡è¦å·¥å…·ï¼Œä¸“é—¨å¤„ç†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„ç²¾ç¡®è½¬æ¢ã€‚åœ¨ç°ä»£å®æ—¶æ¸²æŸ“ç®¡çº¿ä¸­ï¼Œæ­£ç¡®çš„è‰²å½©ç©ºé—´ç®¡ç†å¯¹äºå®ç°ç‰©ç†å‡†ç¡®çš„æ¸²æŸ“æ•ˆæœè‡³å…³é‡è¦ã€‚</p>
<h2 data-id="heading-0">è‰²å½©ç©ºé—´åŸºç¡€æ¦‚å¿µ</h2>
<p>åœ¨æ·±å…¥äº†è§£GammaToLinearSpaceExactèŠ‚ç‚¹ä¹‹å‰ï¼Œéœ€è¦ç†è§£ä¼½é©¬ç©ºé—´å’Œçº¿æ€§ç©ºé—´çš„åŸºæœ¬æ¦‚å¿µã€‚ä¼½é©¬ç©ºé—´æ˜¯æŒ‡ç»è¿‡ä¼½é©¬æ ¡æ­£çš„éçº¿æ€§è‰²å½©ç©ºé—´ï¼Œè€Œçº¿æ€§ç©ºé—´åˆ™æ˜¯æœªç»æ ¡æ­£çš„ã€ä¸ç‰©ç†å…‰ç…§è®¡ç®—ç›¸åŒ¹é…çš„è‰²å½©ç©ºé—´ã€‚</p>
<h3 data-id="heading-1">ä¼½é©¬æ ¡æ­£çš„å†å²èƒŒæ™¯</h3>
<ul>
<li>ä¼½é©¬æ ¡æ­£æœ€åˆæ˜¯ä¸ºäº†è¡¥å¿CRTæ˜¾ç¤ºå™¨çš„éçº¿æ€§å“åº”ç‰¹æ€§è€Œå¼•å…¥çš„</li>
<li>äººç±»è§†è§‰ç³»ç»Ÿå¯¹æš—éƒ¨ç»†èŠ‚çš„æ„ŸçŸ¥æ›´ä¸ºæ•æ„Ÿï¼Œä¼½é©¬ç¼–ç å¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨æœ‰é™çš„å­˜å‚¨å¸¦å®½</li>
<li>ç°ä»£æ•°å­—å›¾åƒå’Œçº¹ç†é€šå¸¸é»˜è®¤å­˜å‚¨åœ¨ä¼½é©¬ç©ºé—´ä¸­</li>
</ul>
<h3 data-id="heading-2">çº¿æ€§ç©ºé—´çš„é‡è¦æ€§</h3>
<ul>
<li>ç‰©ç†å…‰ç…§è®¡ç®—åŸºäºçº¿æ€§å…³ç³»ï¼Œä½¿ç”¨çº¿æ€§ç©ºé—´å¯ä»¥ç¡®ä¿å…‰ç…§è®¡ç®—çš„å‡†ç¡®æ€§</li>
<li>çº¹ç†è¿‡æ»¤ã€æ··åˆå’ŒæŠ—é”¯é½¿åœ¨çº¿æ€§ç©ºé—´ä¸­è¡¨ç°æ›´åŠ æ­£ç¡®</li>
<li>ç°ä»£æ¸²æŸ“ç®¡çº¿æ™®éé‡‡ç”¨çº¿æ€§ç©ºé—´å·¥ä½œæµä»¥è·å¾—æ›´çœŸå®çš„æ¸²æŸ“ç»“æœ</li>
</ul>
<h2 data-id="heading-3">GammaToLinearSpaceExactèŠ‚ç‚¹æŠ€æœ¯ç»†èŠ‚</h2>
<p>GammaToLinearSpaceExactèŠ‚ç‚¹å®ç°äº†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„ç²¾ç¡®æ•°å­¦è½¬æ¢ï¼Œå…¶æ ¸å¿ƒç®—æ³•åŸºäºæ ‡å‡†çš„ä¼½é©¬è§£ç å‡½æ•°ã€‚</p>
<h3 data-id="heading-4">è½¬æ¢ç®—æ³•åŸç†</h3>
<p>è¯¥èŠ‚ç‚¹ä½¿ç”¨çš„è½¬æ¢å…¬å¼åŸºäºsRGBæ ‡å‡†çš„é€†ä¼½é©¬æ ¡æ­£ï¼š</p>
<pre><code class="hljs"/></pre>
<p>å¦‚æœè¾“å…¥å€¼ &lt;= 0.04045
çº¿æ€§å€¼ = è¾“å…¥å€¼ / 12.92
å¦åˆ™
çº¿æ€§å€¼ = ((è¾“å…¥å€¼ + 0.055) / 1.055)^2.4</p>
<pre><code class="hljs language-markdown" lang="markdown">è¿™ä¸ªç²¾ç¡®çš„è½¬æ¢å…¬å¼ç¡®ä¿äº†ä»ä¼½é©¬ç©ºé—´åˆ°çº¿æ€§ç©ºé—´çš„æ•°å­¦å‡†ç¡®æ€§ï¼Œä¸ç®€å•çš„å¹‚å‡½æ•°è¿‘ä¼¼ç›¸æ¯”ï¼Œåœ¨ä½äº®åº¦åŒºåŸŸæä¾›äº†æ›´é«˜çš„ç²¾åº¦ã€‚

<span class="hljs-section">### æ•°å€¼èŒƒå›´å¤„ç†</span>

GammaToLinearSpaceExactèŠ‚ç‚¹è®¾è®¡ç”¨äºå¤„ç†æ ‡å‡†åŒ–çš„æ•°å€¼èŒƒå›´ï¼š

<span class="hljs-bullet">-</span> è¾“å…¥å€¼é€šå¸¸åº”åœ¨[0,1]èŒƒå›´å†…ï¼Œä½†èŠ‚ç‚¹ä¹Ÿèƒ½å¤„ç†è¶…å‡ºæ­¤èŒƒå›´çš„å€¼
<span class="hljs-bullet">-</span> è¾“å‡ºå€¼ä¿æŒä¸è¾“å…¥ç›¸åŒçš„æ•°å€¼èŒƒå›´ï¼Œä½†åˆ†å¸ƒç‰¹æ€§å‘ç”Ÿäº†å˜åŒ–
<span class="hljs-bullet">-</span> å¯¹äºHDRï¼ˆé«˜åŠ¨æ€èŒƒå›´ï¼‰å†…å®¹ï¼ŒèŠ‚ç‚¹åŒæ ·é€‚ç”¨ï¼Œä½†éœ€è¦æ³¨æ„è‰²è°ƒæ˜ å°„çš„åç»­å¤„ç†

<span class="hljs-section">## ç«¯å£è¯¦ç»†è¯´æ˜</span>

![](<span class="hljs-link">https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/GammaToLinearSpaceExactNodeThumb.png</span>)

<span class="hljs-section">### è¾“å…¥ç«¯å£(In)</span>

è¾“å…¥ç«¯å£æ¥å—Floatç±»å‹çš„æ•°å€¼ï¼Œä»£è¡¨éœ€è¦è½¬æ¢çš„ä¼½é©¬ç©ºé—´æ•°å€¼ã€‚è¿™ä¸ªè¾“å…¥å¯ä»¥æ˜¯å•ä¸ªæ ‡é‡å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å‘é‡å½¢å¼çš„è‰²å½©å€¼ï¼ˆå½“è¿æ¥åˆ°è‰²å½©è¾“å‡ºæ—¶ï¼‰ã€‚

è¾“å…¥æ•°å€¼çš„ç‰¹æ€§ï¼š

<span class="hljs-bullet">-</span> é€šå¸¸æ¥è‡ªçº¹ç†é‡‡æ ·ã€å¸¸é‡å‚æ•°æˆ–å…¶ä»–Shader GraphèŠ‚ç‚¹çš„è¾“å‡º
<span class="hljs-bullet">-</span> å¦‚æœè¾“å…¥å·²ç»æ˜¯çº¿æ€§ç©ºé—´çš„æ•°å€¼ï¼Œä½¿ç”¨æ­¤èŠ‚ç‚¹ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„æ¸²æŸ“ç»“æœ
<span class="hljs-bullet">-</span> æ”¯æŒåŠ¨æ€è¾“å…¥ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®ä¸åŒçš„æ¡ä»¶æ”¹å˜è¾“å…¥æº

<span class="hljs-section">### è¾“å‡ºç«¯å£(Out)</span>

è¾“å‡ºç«¯å£æä¾›è½¬æ¢åçš„çº¿æ€§ç©ºé—´æ•°å€¼ï¼Œç±»å‹åŒæ ·ä¸ºFloatã€‚è¿™ä¸ªè¾“å‡ºå¯ä»¥ç›´æ¥ç”¨äºåç»­çš„å…‰ç…§è®¡ç®—ã€æè´¨å±æ€§å®šä¹‰æˆ–å…¶ä»–éœ€è¦çº¿æ€§ç©ºé—´æ•°æ®çš„æ“ä½œã€‚

è¾“å‡ºæ•°å€¼çš„ç‰¹æ€§ï¼š

<span class="hljs-bullet">-</span> ä¿æŒäº†è¾“å…¥æ•°å€¼çš„ç›¸å¯¹äº®åº¦å…³ç³»ï¼Œä½†æ•°å€¼åˆ†å¸ƒå‘ç”Ÿäº†å˜åŒ–
<span class="hljs-bullet">-</span> æš—éƒ¨åŒºåŸŸçš„æ•°å€¼è¢«æ‰©å±•ï¼Œäº®éƒ¨åŒºåŸŸçš„æ•°å€¼è¢«å‹ç¼©
<span class="hljs-bullet">-</span> è¾“å‡ºå¯ä»¥ç›´æ¥ç”¨äºç‰©ç†å…‰ç…§è®¡ç®—ï¼Œå¦‚æ¼«åå°„ã€é«˜å…‰åå°„ç­‰

<span class="hljs-section">## å®é™…åº”ç”¨åœºæ™¯</span>

GammaToLinearSpaceExactèŠ‚ç‚¹åœ¨URP Shader Graphä¸­æœ‰å¤šç§é‡è¦åº”ç”¨åœºæ™¯ï¼Œæ­£ç¡®ä½¿ç”¨è¯¥èŠ‚ç‚¹å¯ä»¥æ˜¾è‘—æå‡æ¸²æŸ“è´¨é‡ã€‚

<span class="hljs-section">### çº¹ç†è‰²å½©æ ¡æ­£</span>

å½“ä½¿ç”¨å­˜å‚¨åœ¨ä¼½é©¬ç©ºé—´ä¸­çš„çº¹ç†æ—¶ï¼Œå¿…é¡»å°†å…¶è½¬æ¢åˆ°çº¿æ€§ç©ºé—´æ‰èƒ½è¿›è¡Œæ­£ç¡®çš„å…‰ç…§è®¡ç®—ã€‚

åº”ç”¨ç¤ºä¾‹æ­¥éª¤ï¼š

<span class="hljs-bullet">-</span> ä»çº¹ç†é‡‡æ ·èŠ‚ç‚¹è·å–é¢œè‰²å€¼
<span class="hljs-bullet">-</span> å°†é‡‡æ ·ç»“æœè¿æ¥åˆ°GammaToLinearSpaceExactèŠ‚ç‚¹çš„è¾“å…¥
<span class="hljs-bullet">-</span> ä½¿ç”¨è½¬æ¢åçš„çº¿æ€§é¢œè‰²å€¼è¿›è¡Œå…‰ç…§è®¡ç®—
<span class="hljs-bullet">-</span> åœ¨æœ€ç»ˆè¾“å‡ºå‰ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨LinearToGammaSpaceExactèŠ‚ç‚¹è½¬æ¢å›ä¼½é©¬ç©ºé—´ç”¨äºæ˜¾ç¤º

è¿™ç§å·¥ä½œæµç¨‹ç¡®ä¿äº†çº¹ç†é¢œè‰²åœ¨å…‰ç…§è®¡ç®—ä¸­çš„ç‰©ç†å‡†ç¡®æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ¼«åå°„è´´å›¾ã€è‡ªå‘å…‰è´´å›¾ç­‰å½±å“åœºæ™¯å…‰ç…§çš„çº¹ç†æ—¶å°¤ä¸ºé‡è¦ã€‚

<span class="hljs-section">### ç‰©ç†å…‰ç…§è®¡ç®—</span>

æ‰€æœ‰åŸºäºç‰©ç†çš„æ¸²æŸ“è®¡ç®—éƒ½åº”åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹åœ¨æ­¤è¿‡ç¨‹ä¸­æ‰®æ¼”å…³é”®è§’è‰²ã€‚

å…‰ç…§è®¡ç®—åº”ç”¨ï¼š

<span class="hljs-bullet">-</span> å°†è¾“å…¥çš„ç¯å…‰é¢œè‰²ä»ä¼½é©¬ç©ºé—´è½¬æ¢åˆ°çº¿æ€§ç©ºé—´
<span class="hljs-bullet">-</span> å¤„ç†ç¯å¢ƒå…‰ç…§å’Œåå°„æ¢é’ˆæ•°æ®
<span class="hljs-bullet">-</span> è®¡ç®—æ¼«åå°„å’Œé«˜å…‰åå°„æ—¶ç¡®ä¿é¢œè‰²å€¼çš„çº¿æ€§ç‰¹æ€§

é€šè¿‡åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œå…‰ç…§è®¡ç®—ï¼Œå¯ä»¥é¿å…ä¼½é©¬ç©ºé—´ä¸­çš„éçº¿æ€§å åŠ å¯¼è‡´çš„å…‰ç…§è¿‡äº®æˆ–è¿‡æš—é—®é¢˜ï¼Œå®ç°æ›´åŠ è‡ªç„¶çš„æ˜æš—è¿‡æ¸¡å’Œè‰²å½©æ··åˆã€‚

<span class="hljs-section">### åæœŸå¤„ç†æ•ˆæœ</span>

åœ¨å®ç°å±å¹•åå¤„ç†æ•ˆæœæ—¶ï¼Œæ­£ç¡®ç®¡ç†è‰²å½©ç©ºé—´å¯¹äºä¿æŒæ•ˆæœçš„ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚

åæœŸå¤„ç†ä¸­çš„åº”ç”¨ï¼š

<span class="hljs-bullet">-</span> è‰²å½©åˆ†çº§å’Œè‰²è°ƒæ˜ å°„
<span class="hljs-bullet">-</span> æ³›å…‰å’Œç»½æ”¾æ•ˆæœ
<span class="hljs-bullet">-</span> è‰²å½©æ ¡æ­£å’Œæ»¤é•œæ•ˆæœ

åœ¨è¿™äº›åº”ç”¨ä¸­ï¼Œéœ€è¦å…ˆå°†è¾“å…¥å›¾åƒä»ä¼½é©¬ç©ºé—´è½¬æ¢åˆ°çº¿æ€§ç©ºé—´è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæˆåå†è½¬æ¢å›ä¼½é©¬ç©ºé—´ç”¨äºæ˜¾ç¤ºï¼Œç¡®ä¿å¤„ç†è¿‡ç¨‹ä¸­çš„è‰²å½©æ“ä½œç¬¦åˆçº¿æ€§å…³ç³»ã€‚

<span class="hljs-section">## ä¸å…¶ä»–è‰²å½©ç©ºé—´èŠ‚ç‚¹çš„å¯¹æ¯”</span>

Unity Shader Graphæä¾›äº†å¤šä¸ªä¸è‰²å½©ç©ºé—´ç›¸å…³çš„èŠ‚ç‚¹ï¼Œäº†è§£å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å¯¹äºæ­£ç¡®é€‰æ‹©å’Œä½¿ç”¨è‡³å…³é‡è¦ã€‚

<span class="hljs-section">### GammaToLinearSpaceExactä¸GammaToLinearSpace</span>

GammaToLinearSpaceèŠ‚ç‚¹æä¾›äº†ç±»ä¼¼çš„ä¼½é©¬åˆ°çº¿æ€§è½¬æ¢åŠŸèƒ½ï¼Œä½†ä½¿ç”¨çš„æ˜¯è¿‘ä¼¼ç®—æ³•ï¼š
</code></pre>
<p>çº¿æ€§å€¼ â‰ˆ è¾“å…¥å€¼^2.2</p>
<pre><code class="hljs language-markdown" lang="markdown">å¯¹æ¯”åˆ†æï¼š

<span class="hljs-bullet">-</span> GammaToLinearSpaceExactä½¿ç”¨ç²¾ç¡®çš„sRGBæ ‡å‡†è½¬æ¢ï¼Œåœ¨ä½äº®åº¦åŒºåŸŸæ›´åŠ å‡†ç¡®
<span class="hljs-bullet">-</span> GammaToLinearSpaceä½¿ç”¨ç®€åŒ–è¿‘ä¼¼ï¼Œè®¡ç®—æ•ˆç‡æ›´é«˜ä½†ç²¾åº¦ç¨ä½
<span class="hljs-bullet">-</span> åœ¨éœ€è¦æœ€é«˜è§†è§‰è´¨é‡çš„åœºåˆæ¨èä½¿ç”¨Exactç‰ˆæœ¬ï¼Œåœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿‘ä¼¼ç‰ˆæœ¬

<span class="hljs-section">### ä¸LinearToGammaSpaceExactçš„å…³ç³»</span>

LinearToGammaSpaceExactèŠ‚ç‚¹æ‰§è¡Œç›¸åçš„è½¬æ¢è¿‡ç¨‹ï¼Œå°†çº¿æ€§ç©ºé—´å€¼è½¬æ¢å›ä¼½é©¬ç©ºé—´ã€‚

è½¬æ¢å…³ç³»å¯¹åº”ï¼š

<span class="hljs-bullet">-</span> GammaToLinearSpaceExactå’ŒLinearToGammaSpaceExactæ˜¯äº’é€†æ“ä½œ
<span class="hljs-bullet">-</span> åœ¨æ¸²æŸ“ç®¡çº¿çš„å¼€å§‹é˜¶æ®µä½¿ç”¨GammaToLinearSpaceExactï¼Œåœ¨æœ€ç»ˆè¾“å‡ºå‰ä½¿ç”¨LinearToGammaSpaceExact
<span class="hljs-bullet">-</span> è¿™ç§é…å¯¹ä½¿ç”¨ç¡®ä¿äº†æ•´ä¸ªæ¸²æŸ“æµç¨‹çš„è‰²å½©ç©ºé—´ä¸€è‡´æ€§

<span class="hljs-section">## æ€§èƒ½è€ƒé‡ä¸æœ€ä½³å®è·µ</span>

è™½ç„¶GammaToLinearSpaceExactèŠ‚ç‚¹çš„è®¡ç®—å¼€é”€ç›¸å¯¹è¾ƒå°ï¼Œä½†åœ¨å¤§è§„æ¨¡ä½¿ç”¨æ—¶ä»éœ€è€ƒè™‘æ€§èƒ½å½±å“ã€‚

<span class="hljs-section">### æ€§èƒ½ä¼˜åŒ–å»ºè®®</span>

åˆç†ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹å¯ä»¥å¹³è¡¡è§†è§‰è´¨é‡å’Œæ¸²æŸ“æ€§èƒ½ï¼š

<span class="hljs-bullet">-</span> å¯¹äºå·²ç»åœ¨çº¿æ€§ç©ºé—´ä¸­çš„çº¹ç†ï¼ˆå¦‚HDRiç¯å¢ƒè´´å›¾ï¼‰ï¼Œä¸éœ€è¦ä½¿ç”¨æ­¤èŠ‚ç‚¹
<span class="hljs-bullet">-</span> åœ¨ä¸éœ€è¦æœ€é«˜ç²¾åº¦çš„åœºåˆï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨GammaToLinearSpaceè¿‘ä¼¼èŠ‚ç‚¹
<span class="hljs-bullet">-</span> é¿å…åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­é‡å¤æ‰§è¡Œç›¸åŒçš„è½¬æ¢ï¼Œå°½å¯èƒ½åœ¨é¡¶ç‚¹ç€è‰²å™¨æˆ–é¢„å¤„ç†é˜¶æ®µå®Œæˆ
<span class="hljs-bullet">-</span> åˆ©ç”¨Unityçš„çº¹ç†å¯¼å…¥è®¾ç½®ï¼Œç›´æ¥å°†çº¹ç†æ ‡è®°ä¸ºçº¿æ€§ç©ºé—´ï¼Œé¿å…è¿è¡Œæ—¶è½¬æ¢

<span class="hljs-section">### å¸¸è§é”™è¯¯ä¸è°ƒè¯•</span>

ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹æ—¶å¸¸è§çš„é”™è¯¯å’Œè°ƒè¯•æ–¹æ³•ï¼š

è‰²å½©è¿‡æš—æˆ–è¿‡äº®é—®é¢˜ï¼š

<span class="hljs-bullet">-</span> æ£€æŸ¥æ˜¯å¦é‡å¤åº”ç”¨äº†ä¼½é©¬æ ¡æ­£
<span class="hljs-bullet">-</span> ç¡®è®¤è¾“å…¥çº¹ç†çš„æ­£ç¡®çš„è‰²å½©ç©ºé—´è®¾ç½®
<span class="hljs-bullet">-</span> éªŒè¯æ•´ä¸ªæ¸²æŸ“ç®¡çº¿ä¸­è‰²å½©ç©ºé—´è½¬æ¢çš„ä¸€è‡´æ€§

æ€§èƒ½é—®é¢˜è¯Šæ–­ï¼š

<span class="hljs-bullet">-</span> ä½¿ç”¨Unityçš„Frame Debuggeråˆ†æç€è‰²å™¨æ‰§è¡Œå¼€é”€
<span class="hljs-bullet">-</span> æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„é‡å¤è½¬æ¢æ“ä½œ
<span class="hljs-bullet">-</span> è¯„ä¼°ä½¿ç”¨çº¹ç†å¯¼å…¥æ—¶é¢„è½¬æ¢çš„å¯è¡Œæ€§

<span class="hljs-section">## å®Œæ•´ç¤ºä¾‹ï¼šå®ç°ç‰©ç†å‡†ç¡®çš„æ¼«åå°„ç€è‰²</span>

ä¸‹é¢é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹å±•ç¤ºGammaToLinearSpaceExactèŠ‚ç‚¹åœ¨å®é™…ç€è‰²å™¨ä¸­çš„åº”ç”¨ã€‚

<span class="hljs-section">### åœºæ™¯è®¾ç½®</span>

åˆ›å»ºä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼ŒåŒ…å«ï¼š

<span class="hljs-bullet">-</span> ä¸€ä¸ªå®šå‘å…‰æº
<span class="hljs-bullet">-</span> å‡ ä¸ªå…·æœ‰ä¸åŒé¢œè‰²çš„ç‰©ä½“
<span class="hljs-bullet">-</span> ä½¿ç”¨æ ‡å‡†URPæ¸²æŸ“ç®¡çº¿

<span class="hljs-section">### ç€è‰²å™¨å›¾æ„å»º</span>

æ„å»ºä¸€ä¸ªä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹çš„åŸºæœ¬æ¼«åå°„ç€è‰²å™¨ï¼š

èŠ‚ç‚¹è¿æ¥æµç¨‹ï¼š

<span class="hljs-bullet">-</span> ä½¿ç”¨Texture2DèŠ‚ç‚¹é‡‡æ ·æ¼«åå°„è´´å›¾
<span class="hljs-bullet">-</span> å°†é‡‡æ ·ç»“æœè¿æ¥åˆ°GammaToLinearSpaceExactèŠ‚ç‚¹çš„è¾“å…¥
<span class="hljs-bullet">-</span> å°†è½¬æ¢åçš„çº¿æ€§é¢œè‰²è¿æ¥åˆ°URP LitèŠ‚ç‚¹çš„Base Colorè¾“å…¥
<span class="hljs-bullet">-</span> é…ç½®é€‚å½“çš„å…‰ç…§å’Œæè´¨å‚æ•°

<span class="hljs-section">### å¯¹æ¯”æµ‹è¯•</span>

åˆ›å»ºä¸¤ä¸ªç‰ˆæœ¬çš„ç€è‰²å™¨è¿›è¡Œå¯¹æ¯”ï¼š

<span class="hljs-bullet">-</span> ç‰ˆæœ¬Aï¼šæ­£ç¡®ä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹
<span class="hljs-bullet">-</span> ç‰ˆæœ¬Bï¼šç›´æ¥ä½¿ç”¨ä¼½é©¬ç©ºé—´çš„çº¹ç†é¢œè‰²

è§‚å¯Ÿä¸¤ä¸ªç‰ˆæœ¬åœ¨ç›¸åŒå…‰ç…§æ¡ä»¶ä¸‹çš„è¡¨ç°å·®å¼‚ï¼š

<span class="hljs-bullet">-</span> ç‰ˆæœ¬Aæä¾›æ›´åŠ çœŸå®çš„å…‰ç…§å“åº”å’Œé¢œè‰²é¥±å’Œåº¦
<span class="hljs-bullet">-</span> ç‰ˆæœ¬Bå¯èƒ½å‡ºç°ä¸æ­£ç¡®çš„äº®åº¦ç§¯ç´¯å’Œè‰²å½©åç§»
<span class="hljs-bullet">-</span> åœ¨é«˜å…‰åŒºåŸŸå’Œé˜´å½±è¿‡æ¸¡åŒºåŸŸï¼Œç‰ˆæœ¬Açš„è¡¨ç°æ›´åŠ è‡ªç„¶

<span class="hljs-section">## é«˜çº§åº”ç”¨æŠ€å·§</span>

é™¤äº†åŸºæœ¬ç”¨æ³•ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹è¿˜å¯ä»¥ä¸å…¶ä»–Shader GraphåŠŸèƒ½ç»“åˆï¼Œå®ç°æ›´å¤æ‚çš„æ•ˆæœã€‚

<span class="hljs-section">### ä¸è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹ç»“åˆ</span>

åœ¨å®ç°è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹æ—¶ï¼Œæ­£ç¡®ç®¡ç†è‰²å½©ç©ºé—´è‡³å…³é‡è¦ï¼š

å®ç°æ­¥éª¤ï¼š

<span class="hljs-bullet">-</span> å°†æ‰€æœ‰è¾“å…¥çš„é¢œè‰²æ•°æ®è½¬æ¢åˆ°çº¿æ€§ç©ºé—´
<span class="hljs-bullet">-</span> åœ¨çº¿æ€§ç©ºé—´ä¸­æ‰§è¡Œå…‰ç…§è®¡ç®—
<span class="hljs-bullet">-</span> å°†æœ€ç»ˆç»“æœè½¬æ¢å›ä¼½é©¬ç©ºé—´è¾“å‡º
<span class="hljs-bullet">-</span> ç¡®ä¿æ‰€æœ‰ä¸­é—´è®¡ç®—ä¿æŒçº¿æ€§å…³ç³»

è¿™ç§æ–¹æ³•ç¡®ä¿äº†è‡ªå®šä¹‰å…‰ç…§æ¨¡å‹ä¸URPå†…ç½®å…‰ç…§çš„ä¸€è‡´æ€§ï¼Œé¿å…äº†å› è‰²å½©ç©ºé—´ä¸åŒ¹é…å¯¼è‡´çš„è§†è§‰å¼‚å¸¸ã€‚

<span class="hljs-section">### HDRå†…å®¹å¤„ç†</span>

å¤„ç†é«˜åŠ¨æ€èŒƒå›´å†…å®¹æ—¶ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹çš„ä½¿ç”¨éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š

HDRå·¥ä½œæµè€ƒè™‘ï¼š

<span class="hljs-bullet">-</span> HDRçº¹ç†é€šå¸¸å·²ç»åœ¨çº¿æ€§ç©ºé—´ä¸­ï¼Œä¸éœ€è¦é¢å¤–è½¬æ¢
<span class="hljs-bullet">-</span> å½“æ··åˆLDRå’ŒHDRå†…å®¹æ—¶ï¼Œéœ€è¦ç¡®ä¿ç»Ÿä¸€çš„è‰²å½©ç©ºé—´
<span class="hljs-bullet">-</span> åœ¨è‰²è°ƒæ˜ å°„é˜¶æ®µå‰ï¼Œæ‰€æœ‰è®¡ç®—åº”åœ¨çº¿æ€§ç©ºé—´ä¸­è¿›è¡Œ

é€šè¿‡æ­£ç¡®åº”ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹ï¼Œå¯ä»¥ç¡®ä¿HDRå’ŒLDRå†…å®¹çš„æ— ç¼èåˆï¼Œå®ç°æ›´é«˜å“è´¨çš„è§†è§‰è¡¨ç°ã€‚

<span class="hljs-section">## å¹³å°å…¼å®¹æ€§è¯´æ˜</span>

GammaToLinearSpaceExactèŠ‚ç‚¹åœ¨ä¸åŒå¹³å°å’Œæ¸²æŸ“APIä¸Šçš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ï¼Œä½†ä»æœ‰å°‘é‡æ³¨æ„äº‹é¡¹ã€‚

<span class="hljs-section">### ç§»åŠ¨å¹³å°ä¼˜åŒ–</span>

åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨GammaToLinearSpaceExactèŠ‚ç‚¹æ—¶ï¼š

<span class="hljs-bullet">-</span> å¤§éƒ¨åˆ†ç°ä»£ç§»åŠ¨GPUèƒ½å¤Ÿé«˜æ•ˆå¤„ç†sRGBè½¬æ¢
<span class="hljs-bullet">-</span> åœ¨æ€§èƒ½è¾ƒä½çš„è®¾å¤‡ä¸Šï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿‘ä¼¼ç‰ˆæœ¬
<span class="hljs-bullet">-</span> åˆ©ç”¨ç§»åŠ¨å¹³å°çš„sRGBçº¹ç†æ ¼å¼ï¼Œå¯ä»¥å‡å°‘æ˜¾å¼è½¬æ¢çš„éœ€è¦

<span class="hljs-section">### ä¸åŒå›¾å½¢APIçš„è¡¨ç°</span>

åœ¨å„ç§å›¾å½¢APIä¸­ï¼ŒGammaToLinearSpaceExactèŠ‚ç‚¹çš„è¡Œä¸ºï¼š

<span class="hljs-bullet">-</span> åœ¨æ”¯æŒsRGBå¸§ç¼“å†²çš„APIä¸Šï¼ˆå¦‚OpenGL ES 3.0+ï¼ŒMetalï¼ŒVulkanï¼‰ï¼ŒUnityä¼šè‡ªåŠ¨å¤„ç†å¸§ç¼“å†²çš„ä¼½é©¬æ ¡æ­£
<span class="hljs-bullet">-</span> åœ¨æ—§ç‰ˆAPIä¸Šï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨ç®¡ç†æœ€ç»ˆçš„è‰²å½©ç©ºé—´è½¬æ¢
<span class="hljs-bullet">-</span> èŠ‚ç‚¹æœ¬èº«çš„æ•°å­¦è®¡ç®—åœ¨æ‰€æœ‰APIä¸Šä¿æŒä¸€è‡´

äº†è§£è¿™äº›å¹³å°ç‰¹æ€§æœ‰åŠ©äºç¼–å†™è·¨å¹³å°å…¼å®¹çš„ç€è‰²å™¨ï¼Œç¡®ä¿åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„ä¸€è‡´è§†è§‰è¡¨ç°ã€‚

<span class="hljs-section">## æ€»ç»“</span>

GammaToLinearSpaceExactèŠ‚ç‚¹æ˜¯Unity URP Shader Graphä¸­å®ç°ç‰©ç†å‡†ç¡®æ¸²æŸ“çš„å…³é”®ç»„ä»¶ã€‚é€šè¿‡æ­£ç¡®ç†è§£å’Œä½¿ç”¨è¯¥èŠ‚ç‚¹ï¼Œå¼€å‘è€…å¯ä»¥ï¼š

<span class="hljs-bullet">-</span> ç¡®ä¿çº¹ç†å’Œé¢œè‰²æ•°æ®åœ¨å…‰ç…§è®¡ç®—ä¸­çš„ç‰©ç†å‡†ç¡®æ€§
<span class="hljs-bullet">-</span> å®ç°æ›´åŠ çœŸå®å’Œä¸€è‡´çš„è§†è§‰è¡¨ç°
<span class="hljs-bullet">-</span> é¿å…å¸¸è§çš„è‰²å½©ç©ºé—´ç›¸å…³æ¸²æŸ“é—®é¢˜
<span class="hljs-bullet">-</span> æ„å»ºé«˜è´¨é‡ã€è·¨å¹³å°å…¼å®¹çš„ç€è‰²å™¨æ•ˆæœ

---
<span class="hljs-quote">&gt; [<span class="hljs-string">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</span>](<span class="hljs-link">https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link</span>)<span class="hljs-strong">**ä¸“æ -ç›´è¾¾**</span></span>
ï¼ˆæ¬¢è¿<span class="hljs-emphasis">*ç‚¹èµç•™è¨€*</span>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨]]></title>    <link>https://juejin.cn/post/7585758163435438086</link>    <guid>https://juejin.cn/post/7585758163435438086</guid>    <pubDate>2025-12-21T11:31:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435438086" data-draft-id="7585758163435421702" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T11:31:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®è›‹å°ç²¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TanStack Router è·¯å¾„å‚æ•°ï¼ˆPath Paramsï¼‰é€ŸæŸ¥è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®è›‹å°ç²¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T11:31:55.000Z" title="Sun Dec 21 2025 11:31:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è·¯å¾„å‚æ•°æ˜¯ URL ä¸­ä»¥ <code>$</code> å¼€å¤´çš„å˜é‡ï¼Œç”¨äºæ•è·åŠ¨æ€å†…å®¹ã€‚</p>









































<table><thead><tr><th><strong>åŠŸèƒ½</strong></th><th><strong>è¯­æ³•ç¤ºä¾‹</strong></th><th><strong>URL åŒ¹é…ç¤ºä¾‹</strong></th><th><strong>æ•è·åˆ°çš„å˜é‡</strong></th></tr></thead><tbody><tr><td><strong>æ ‡å‡†å‚æ•°</strong></td><td><code>$postId</code></td><td><code>/posts/123</code></td><td><code>{ postId: '123' }</code></td></tr><tr><td><strong>å¸¦å‰ç¼€</strong></td><td><code>post-{$id}</code></td><td><code>/posts/post-abc</code></td><td><code>{ id: 'abc' }</code></td></tr><tr><td><strong>å¸¦åç¼€</strong></td><td><code>{$name}.pdf</code></td><td><code>/files/cv.pdf</code></td><td><code>{ name: 'cv' }</code></td></tr><tr><td><strong>é€šé…ç¬¦ (Splat)</strong></td><td><code>$</code></td><td><code>/files/a/b/c.txt</code></td><td><code>{ _splat: 'a/b/c.txt' }</code></td></tr><tr><td><strong>å¯é€‰å‚æ•°</strong></td><td><code>{-$lang}</code></td><td><code>/about</code> æˆ– <code>/en/about</code></td><td><code>{ lang: undefined }</code> æˆ– <code>'en'</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-0">è¯¦ç»†åŠŸèƒ½è§£æ</h3>
<h4 data-id="heading-1">1. åŸºç¡€ç”¨æ³• (Standard Usage)</h4>
<p>åœ¨æ–‡ä»¶è·¯ç”±ä¸­ï¼Œæ–‡ä»¶åå³è·¯å¾„ã€‚ä½¿ç”¨ <code>$</code> å£°æ˜å˜é‡ã€‚</p>
<ul>
<li>
<p><strong>è·å–å‚æ•°</strong>ï¼š</p>
<ul>
<li>
<p>åœ¨ <strong>Loader</strong> ä¸­ï¼šé€šè¿‡å‚æ•°å¯¹è±¡ <code>params</code> è®¿é—®ã€‚</p>
</li>
<li>
<p>åœ¨ <strong>ç»„ä»¶</strong> ä¸­ï¼šä½¿ç”¨ <code>Route.useParams()</code> é’©å­ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ä»£ç åˆ†å‰²æŠ€å·§</strong>ï¼šå¦‚æœç»„ä»¶æ˜¯å•ç‹¬å®šä¹‰çš„ï¼Œå¯ç”¨ <code>getRouteApi('/path').useParams()</code> æ¥ä¿æŒç±»å‹å®‰å…¨ã€‚</p>
</li>
</ul>
<h4 data-id="heading-2">2. å‰ç¼€ä¸åç¼€ (Prefixes and Suffixes)</h4>
<p>è¿™æ˜¯ TanStack Router çš„ä¸€å¤§ç‰¹è‰²ï¼Œå…è®¸ä½ åœ¨åŠ¨æ€éƒ¨åˆ†å‰åæ·»åŠ å›ºå®šæ–‡æœ¬ã€‚</p>
<ul>
<li>
<p><strong>è¯­æ³•</strong>ï¼šç”¨èŠ±æ‹¬å· <code>{}</code> åŒ…è£¹å˜é‡åã€‚</p>
</li>
<li>
<p><strong>åœºæ™¯</strong>ï¼šæ¯”å¦‚æ–‡ä»¶ååŒ¹é… <code>{$id}.json</code>ï¼Œæˆ–è€…å¸¦ç‰¹å®šæ ‡è¯†çš„ ID <code>user-{$userId}</code>ã€‚</p>
</li>
<li>
<p><strong>é€šé…ç¬¦ç»„åˆ</strong>ï¼šä½ ç”šè‡³å¯ä»¥å†™ <code>storage-{$}/$</code> æ¥åŒ¹é…æå…¶å¤æ‚çš„è·¯å¾„ç»“æ„ã€‚</p>
</li>
</ul>
<h4 data-id="heading-3">3. å¯é€‰è·¯å¾„å‚æ•° (Optional Path Parameters) âœ¨ <strong>é‡ç‚¹</strong></h4>
<p>ä½¿ç”¨ <code>{-$variable}</code> è¯­æ³•ã€‚è¿™æ„å‘³ç€è¯¥æ®µè·¯å¾„<strong>å¯ä»¥å­˜åœ¨ä¹Ÿå¯ä»¥ä¸å­˜åœ¨</strong>ã€‚</p>
<ul>
<li>
<p><strong>åŒ¹é…é€»è¾‘</strong>ï¼š<code>/posts/{-$category}</code> æ—¢èƒ½åŒ¹é… <code>/posts</code>ï¼ˆå‚æ•°ä¸º <code>undefined</code>ï¼‰ï¼Œä¹Ÿèƒ½åŒ¹é… <code>/posts/tech</code>ã€‚</p>
</li>
<li>
<p><strong>å¯¼èˆª</strong>ï¼šåœ¨ <code>Link</code> ä¸­ï¼Œå¦‚æœæƒ³å»æ‰å¯é€‰å‚æ•°ï¼Œå°†å€¼è®¾ä¸º <code>undefined</code> å³å¯ã€‚</p>
</li>
</ul>
<h4 data-id="heading-4">4. å›½é™…åŒ– (i18n) åº”ç”¨åœºæ™¯</h4>
<p>å¯é€‰å‚æ•°æœ€å¼ºå¤§çš„åœ°æ–¹åœ¨äºå¤„ç†è¯­è¨€å‰ç¼€ã€‚</p>
<ul>
<li>
<p><strong>è®¾è®¡</strong>ï¼š<code>/{-$locale}/about</code></p>
</li>
<li>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>
<p>ç”¨æˆ·è®¿é—® <code>/about</code> -&gt; é»˜è®¤è¯­è¨€ï¼ˆå¦‚ä¸­æ–‡ï¼‰ã€‚</p>
</li>
<li>
<p>ç”¨æˆ·è®¿é—® <code>/en/about</code> -&gt; è‹±æ–‡ã€‚</p>
</li>
</ul>
</li>
<li>
<p>è¿™æ ·ä½ ä¸éœ€è¦ä¸ºæ¯ç§è¯­è¨€åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œåªéœ€ä¸€ä¸ªè·¯ç”±é€»è¾‘å³å¯æå®šã€‚</p>
</li>
</ul>
<h4 data-id="heading-5">5. ç±»å‹å®‰å…¨ (Type Safety)</h4>
<p>TanStack Router çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</p>
<ul>
<li>
<p>å½“ä½ è·³è½¬ï¼ˆ<code>Link</code> æˆ– <code>Maps</code>ï¼‰åˆ°ä¸€ä¸ªå¸¦å‚æ•°çš„è·¯ç”±æ—¶ï¼ŒTypeScript ä¼š<strong>å¼ºåˆ¶è¦æ±‚</strong>ä½ æä¾›è¯¥å‚æ•°ã€‚</p>
</li>
<li>
<p>å¦‚æœæ˜¯å¯é€‰å‚æ•°ï¼ŒTS ä¼šè‡ªåŠ¨æ¨æ–­å…¶ç±»å‹ä¸º <code>string | undefined</code>ï¼Œæé†’ä½ åšç©ºå€¼å¤„ç†ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-6">å¸¸è§ç–‘é—®è§£ç­”</h3>
<p>Q: æ€ä¹ˆåœ¨ç»„ä»¶å¤–è·å–å‚æ•°ï¼Ÿ</p>
<p>ä½¿ç”¨å…¨å±€çš„ <code>useParams({ strict: false })</code>ã€‚ä½†å»ºè®®å°½å¯èƒ½åœ¨è·¯ç”±å†…éƒ¨ä½¿ç”¨ï¼Œä»¥è·å¾—å®Œæ•´çš„ç±»å‹æç¤ºã€‚</p>
<p>Q: å‚æ•°é‡Œèƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ @ï¼‰å—ï¼Ÿ</p>
<p>é»˜è®¤ä¼šè¿›è¡Œ URL ç¼–ç ã€‚å¦‚æœä½ æƒ³è®©å®ƒç›´æ¥æ˜¾ç¤ºï¼Œéœ€è¦åœ¨ createRouter çš„é…ç½®ä¸­è®¾ç½® <code>pathParamsAllowedCharacters: ['@']</code>ã€‚</p>
<p>Q: å¯¼èˆªæ—¶å¦‚ä½•ä¿ç•™ç°æœ‰çš„å‚æ•°ï¼Ÿ</p>
<p>åœ¨ Link æˆ– Maps çš„ params ä¸­ä½¿ç”¨å‡½æ•°å¼å†™æ³•ï¼š</p>
<p><code>params={(prev) =&gt; ({ ...prev, newParam: 'value' })}</code></p>
<hr/>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<p>è·¯å¾„å‚æ•°ä¸ä»…æ˜¯ $id è¿™ä¹ˆç®€å•ï¼Œé€šè¿‡ å‰ç¼€/åç¼€ã€å¯é€‰æ ‡å¿— å’Œ å¼ºç±»å‹æ ¡éªŒï¼Œä½ å¯ä»¥æå…¶ä¼˜é›…åœ°å¤„ç†å¤æ‚çš„ URL ç»“æ„ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿé¢„è§ˆæˆ–å¤šè¯­è¨€ç«™ç‚¹ï¼‰ï¼Œä¸”å®Œå…¨ä¸ä¼šå†™é”™è·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°]]></title>    <link>https://juejin.cn/post/7585778343350894655</link>    <guid>https://juejin.cn/post/7585778343350894655</guid>    <pubDate>2025-12-21T10:16:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585778343350894655" data-draft-id="7585751355592359955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-21T10:16:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç„¡é‡"/> <meta itemprop="url" content="https://juejin.cn/user/1116759546145086"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIå·¥ç¨‹åŒ–å®è·µæŒ‡å—ï¼šä»å…¥é—¨åˆ°è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759546145086/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç„¡é‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:16:55.000Z" title="Sun Dec 21 2025 10:16:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€ä½Javaå¼€å‘è€…çš„AIä¹‹æ—…ï¼šä»AI Codingåˆ°AIå·¥ç¨‹åŒ–åº”ç”¨</p>
</blockquote>
<h2 data-id="heading-0">ç›®å½•</h2>
<ul>
<li><a href="#1-%E5%BC%95%E8%A8%80ai%E6%97%B6%E4%BB%A3java%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%96%B0%E6%9C%BA%E9%81%87" title="#1-%E5%BC%95%E8%A8%80ai%E6%97%B6%E4%BB%A3java%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%96%B0%E6%9C%BA%E9%81%87">1. å¼•è¨€ï¼šAIæ—¶ä»£ï¼ŒJavaå¼€å‘è€…çš„æ–°æœºé‡</a></li>
<li><a href="#2-ai%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E7%9A%84%E6%BC%94%E8%BF%9B" title="#2-ai%E5%8F%91%E5%B1%95%E5%8E%86%E7%A8%8B%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E7%9A%84%E6%BC%94%E8%BF%9B">2. AIå‘å±•å†ç¨‹ï¼šä»ç†è®ºåˆ°å®è·µçš„æ¼”è¿›</a></li>
<li><a href="#3-ai%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9C%B0%E5%9B%BE" title="#3-ai%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB%E6%9E%84%E5%BB%BA%E5%AE%8C%E6%95%B4%E7%9A%84%E8%AE%A4%E7%9F%A5%E5%9C%B0%E5%9B%BE">3. AIçŸ¥è¯†ä½“ç³»ï¼šæ„å»ºå®Œæ•´çš„è®¤çŸ¥åœ°å›¾</a></li>
<li><a href="#4-ai-coding%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%99%BA%E8%83%BD%E5%8A%A9%E6%89%8B" title="#4-ai-coding%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%99%BA%E8%83%BD%E5%8A%A9%E6%89%8B">4. AI Codingå·¥å…·ï¼šå¼€å‘è€…çš„æ™ºèƒ½åŠ©æ‰‹</a></li>
<li><a href="#5-ai%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5%E4%BB%8E%E6%A6%82%E5%BF%B5%E5%88%B0%E8%90%BD%E5%9C%B0" title="#5-ai%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5%E4%BB%8E%E6%A6%82%E5%BF%B5%E5%88%B0%E8%90%BD%E5%9C%B0">5. AIå·¥ç¨‹åŒ–å®è·µï¼šä»æ¦‚å¿µåˆ°è½åœ°</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">1. å¼•è¨€ï¼šAIæ—¶ä»£ï¼ŒJavaå¼€å‘è€…çš„æ–°æœºé‡</h2>
<h3 data-id="heading-2">1.1 ä¸ºä»€ä¹ˆæ˜¯ç°åœ¨ï¼Ÿ</h3>
<p>2022å¹´11æœˆï¼ŒChatGPTçš„å‘å¸ƒæ ‡å¿—ç€æˆ‘ä»¬è¿›å…¥äº†å¤§æ¨¡å‹æ—¶ä»£ã€‚ä½œä¸ºJavaå¼€å‘è€…ï¼Œæˆ‘ä»¬æ­£å¤„äºä¸€ä¸ªå†å²æ€§çš„è½¬æŠ˜ç‚¹ï¼š</p>
<ul>
<li><strong>å¼€å‘æ–¹å¼çš„é©å‘½</strong>ï¼šAI Codingå·¥å…·æ­£åœ¨æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼</li>
<li><strong>åº”ç”¨å½¢æ€çš„åˆ›æ–°</strong>ï¼šAIèƒ½åŠ›æ­£åœ¨è¢«é›†æˆåˆ°å„ç±»åº”ç”¨ä¸­</li>
<li><strong>æŠ€æœ¯æ ˆçš„æ‰©å±•</strong>ï¼šJavaç”Ÿæ€æ­£åœ¨å¿«é€Ÿæ‹¥æŠ±AIæŠ€æœ¯</li>
</ul>
<h3 data-id="heading-3">1.2 Javaå¼€å‘è€…çš„ä¼˜åŠ¿</h3>
<p>ä½œä¸ºJavaå¼€å‘è€…ï¼Œæˆ‘ä»¬åœ¨AIå·¥ç¨‹åŒ–è½åœ°æ–¹é¢æœ‰å¤©ç„¶ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Javaå¼€å‘è€…ä¼˜åŠ¿] --&gt; B[ä¼ä¸šçº§å¼€å‘ç»éªŒ]
    A --&gt; C[å·¥ç¨‹åŒ–æ€ç»´]
    A --&gt; D[æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿ]

    B --&gt; E[å¤§å‹é¡¹ç›®æ¶æ„èƒ½åŠ›]
    B --&gt; F[é«˜å¹¶å‘å¤„ç†ç»éªŒ]

    C --&gt; G[ä»£ç è§„èŒƒ]
    C --&gt; H[æµ‹è¯•é©±åŠ¨]
    C --&gt; I[DevOpså®è·µ]

    D --&gt; J[Springç”Ÿæ€]
    D --&gt; K[å¾®æœåŠ¡æ¡†æ¶]
    D --&gt; L[ä¸­é—´ä»¶é›†æˆ]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#fff4e1
</code></pre>
<hr/>
<h2 data-id="heading-4">2. AIå‘å±•å†ç¨‹ï¼šä»ç†è®ºtoå®è·µçš„æ¼”è¿›</h2>
<h3 data-id="heading-5">2.1 AIå‘å±•æ—¶é—´çº¿</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">timeline
    title AIå‘å±•å…³é”®èŠ‚ç‚¹
    1956 : è¾¾ç‰¹èŒ…æ–¯ä¼šè®®
         : AIæ¦‚å¿µè¯ç”Ÿ
    1997 : æ·±è“æˆ˜èƒœå¡æ–¯å¸•ç½—å¤«
         : ç¬¦å·AIå·…å³°
    2012 : ImageNetçªç ´
         : æ·±åº¦å­¦ä¹ å´›èµ·
    2016 : AlphaGoæˆ˜èƒœæä¸–çŸ³
         : å¼ºåŒ–å­¦ä¹ é‡Œç¨‹ç¢‘
    2017 : Transformeræ¶æ„
         : æ³¨æ„åŠ›æœºåˆ¶é©å‘½
    2018 : BERTå‘å¸ƒ
         : é¢„è®­ç»ƒæ¨¡å‹æ—¶ä»£
    2020 : GPT-3å‘å¸ƒ
         : å¤§æ¨¡å‹æ—¶ä»£å¼€å¯
    2022 : ChatGPTå‘å¸ƒ
         : AIåº”ç”¨å¤§çˆ†å‘
    2023 : GPT-4/Claude 3
         : å¤šæ¨¡æ€èƒ½åŠ›é£è·ƒ
    2024 : Claude 3.5 Sonnet
         : AI Codingæˆç†Ÿ
    2025 : AIå·¥ç¨‹åŒ–æ™®åŠ
         : ä¼ä¸šçº§åº”ç”¨è½åœ°
</code></pre>
<h3 data-id="heading-6">2.2 ä¸‰ä¸ªé‡è¦é˜¶æ®µ</h3>
<h4 data-id="heading-7"><strong>é˜¶æ®µä¸€ï¼šä¼ ç»ŸAIæ—¶ä»£ï¼ˆ1956-2010ï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>åŸºäºè§„åˆ™å’Œä¸“å®¶ç³»ç»Ÿ</li>
<li>ç¬¦å·ä¸»ä¹‰å’Œé€»è¾‘æ¨ç†</li>
<li>åº”ç”¨åœºæ™¯æœ‰é™</li>
</ul>
<p>å…¸å‹ä»£è¡¨ï¼š</p>
<ul>
<li>ä¸“å®¶ç³»ç»Ÿï¼ˆMYCINã€DENDRALï¼‰</li>
<li>æœç´¢ç®—æ³•ï¼ˆA*ã€åšå¼ˆæ ‘ï¼‰</li>
<li>æ—©æœŸè‡ªç„¶è¯­è¨€å¤„ç†</li>
</ul>
<h4 data-id="heading-8"><strong>é˜¶æ®µäºŒï¼šæ·±åº¦å­¦ä¹ é©å‘½ï¼ˆ2012-2020ï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>æ•°æ®é©±åŠ¨çš„å­¦ä¹ æ–¹å¼</li>
<li>ç¥ç»ç½‘ç»œçš„å¤å…´</li>
<li>åœ¨ç‰¹å®šé¢†åŸŸè¶…è¶Šäººç±»</li>
</ul>
<p>å…³é”®æŠ€æœ¯ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[æ·±åº¦å­¦ä¹ æŠ€æœ¯æ ˆ] --&gt; B[å·ç§¯ç¥ç»ç½‘ç»œ CNN]
    A --&gt; C[å¾ªç¯ç¥ç»ç½‘ç»œ RNN/LSTM]
    A --&gt; D[Transformeræ¶æ„]

    B --&gt; E[å›¾åƒè¯†åˆ«]
    B --&gt; F[è®¡ç®—æœºè§†è§‰]

    C --&gt; G[åºåˆ—å»ºæ¨¡]
    C --&gt; H[æœºå™¨ç¿»è¯‘]

    D --&gt; I[è‡ªç„¶è¯­è¨€å¤„ç†]
    D --&gt; J[å¤§è¯­è¨€æ¨¡å‹]

    style A fill:#e1f5ff
    style D fill:#ffe1e1
</code></pre>
<h4 data-id="heading-9"><strong>é˜¶æ®µä¸‰ï¼šå¤§æ¨¡å‹æ—¶ä»£ï¼ˆ2020è‡³ä»Šï¼‰</strong></h4>
<p>ç‰¹å¾ï¼š</p>
<ul>
<li>è§„æ¨¡åŒ–é¢„è®­ç»ƒæ¨¡å‹</li>
<li>æ¶Œç°èƒ½åŠ›ï¼ˆEmergent Abilitiesï¼‰</li>
<li>é€šç”¨äººå·¥æ™ºèƒ½çš„é›å½¢</li>
</ul>
<p>æ ¸å¿ƒç†å¿µï¼š</p>
<ol>
<li><strong>Scale Law</strong>ï¼šæ¨¡å‹è¶Šå¤§ï¼Œèƒ½åŠ›è¶Šå¼º</li>
<li><strong>Few-shot Learning</strong>ï¼šå°‘æ ·æœ¬ç”šè‡³é›¶æ ·æœ¬å­¦ä¹ </li>
<li><strong>Instruction Following</strong>ï¼šç†è§£å¹¶æ‰§è¡Œå¤æ‚æŒ‡ä»¤</li>
</ol>
<hr/>
<h2 data-id="heading-10">3. AIçŸ¥è¯†ä½“ç³»ï¼šæ„å»ºå®Œæ•´çš„è®¤çŸ¥åœ°å›¾</h2>
<h3 data-id="heading-11">3.1 æ•´ä½“çŸ¥è¯†æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;åº”ç”¨å±‚&amp;#34;
        A1[AI Coding]
        A2[æ™ºèƒ½å®¢æœ]
        A3[æ–‡æ¡£é—®ç­”]
        A4[ä»£ç åŠ©æ‰‹]
        A5[æ•°æ®åˆ†æ]
    end

    subgraph &amp;#34;å·¥ç¨‹å±‚&amp;#34;
        B1[LangChain4j]
        B2[Spring AI]
        B3[LlamaIndex]
        B4[Semantic Kernel]
    end

    subgraph &amp;#34;èƒ½åŠ›å±‚&amp;#34;
        C1[Prompt Engineering]
        C2[RAGæ£€ç´¢å¢å¼º]
        C3[Agentæ™ºèƒ½ä½“]
        C4[Function Calling]
        C5[Fine-tuningå¾®è°ƒ]
    end

    subgraph &amp;#34;æ¨¡å‹å±‚&amp;#34;
        D1[GPT-4/GPT-4o]
        D2[Claude 3.5]
        D3[Gemini]
        D4[Llama 3]
        D5[é€šä¹‰åƒé—®]
    end

    subgraph &amp;#34;åŸºç¡€å±‚&amp;#34;
        E1[Transformer]
        E2[Attentionæœºåˆ¶]
        E3[Tokenæœºåˆ¶]
        E4[Embedding]
    end

    A1 &amp; A2 &amp; A3 &amp; A4 &amp; A5 --&gt; B1 &amp; B2 &amp; B3 &amp; B4
    B1 &amp; B2 &amp; B3 &amp; B4 --&gt; C1 &amp; C2 &amp; C3 &amp; C4 &amp; C5
    C1 &amp; C2 &amp; C3 &amp; C4 &amp; C5 --&gt; D1 &amp; D2 &amp; D3 &amp; D4 &amp; D5
    D1 &amp; D2 &amp; D3 &amp; D4 &amp; D5 --&gt; E1 &amp; E2 &amp; E3 &amp; E4

    style A1 fill:#e1f5ff
    style B1 fill:#fff4e1
    style C1 fill:#e1ffe1
    style D1 fill:#ffe1f5
    style E1 fill:#f5e1ff
</code></pre>
<h3 data-id="heading-12">3.2 æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h3>
<h4 data-id="heading-13"><strong>3.2.1 å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯LLMï¼Ÿ</strong></p>
<p>å¤§è¯­è¨€æ¨¡å‹æ˜¯é€šè¿‡åœ¨æµ·é‡æ–‡æœ¬æ•°æ®ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œå­¦ä¹ è¯­è¨€æ¨¡å¼å’ŒçŸ¥è¯†çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹å¾ï¼š</strong></p>






























<table><thead><tr><th>ç‰¹å¾</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>å¤§è§„æ¨¡å‚æ•°</strong></td><td>æ•°åäº¿åˆ°æ•°åƒäº¿å‚æ•°</td><td>GPT-4: ~1.7T, Claude 3.5: æœªå…¬å¼€</td></tr><tr><td><strong>é¢„è®­ç»ƒ</strong></td><td>åœ¨å¤§è§„æ¨¡è¯­æ–™ä¸Šè‡ªç›‘ç£å­¦ä¹ </td><td>äº’è”ç½‘æ–‡æœ¬ã€ä¹¦ç±ã€ä»£ç ç­‰</td></tr><tr><td><strong>æ¶Œç°èƒ½åŠ›</strong></td><td>æ¨¡å‹è§„æ¨¡è¾¾åˆ°ä¸´ç•Œç‚¹åå‡ºç°çš„èƒ½åŠ›</td><td>æ¨ç†ã€ä»£ç ç”Ÿæˆã€å¤šè¯­è¨€ç†è§£</td></tr><tr><td><strong>ä¸Šä¸‹æ–‡å­¦ä¹ </strong></td><td>ä»æç¤ºè¯ä¸­å­¦ä¹ ä»»åŠ¡</td><td>Few-shotã€Zero-shotå­¦ä¹ </td></tr></tbody></table>
<p><strong>å·¥ä½œåŸç†ç®€åŒ–ç†è§£ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ç”¨æˆ·è¾“å…¥ â†’ TokenåŒ– â†’ Embedding â†’ Transformerå¤„ç† â†’ æ¦‚ç‡é¢„æµ‹ â†’ ç”Ÿæˆè¾“å‡º
   â†“          â†“           â†“              â†“              â†“           â†“
<span class="hljs-string">"ä½ å¥½"</span>   â†’ [<span class="hljs-number">101</span>,<span class="hljs-number">203</span>] â†’ å‘é‡åŒ– â†’ å¤šå±‚æ³¨æ„åŠ›è®¡ç®— â†’ ä¸‹ä¸€ä¸ªToken â†’ <span class="hljs-string">"æ‚¨å¥½"</span>
</code></pre>
<h4 data-id="heading-14"><strong>3.2.2 Prompt Engineeringï¼ˆæç¤ºè¯å·¥ç¨‹ï¼‰</strong></h4>
<p><strong>å®šä¹‰ï¼š</strong> è®¾è®¡å’Œä¼˜åŒ–è¾“å…¥æç¤ºè¯ï¼Œä»¥è·å¾—æ›´å¥½çš„æ¨¡å‹è¾“å‡ºã€‚</p>
<p><strong>æ ¸å¿ƒæŠ€å·§ï¼š</strong></p>
<ol>
<li><strong>æ˜ç¡®è§’è‰²å’Œä»»åŠ¡</strong></li>
</ol>

<pre><code class="hljs">ä½ æ˜¯ä¸€ä½èµ„æ·±çš„Javaæ¶æ„å¸ˆï¼Œæ“…é•¿Spring Bootå’Œå¾®æœåŠ¡è®¾è®¡ã€‚
è¯·å¸®æˆ‘è®¾è®¡ä¸€ä¸ªè®¢å•ç³»ç»Ÿçš„æ•°æ®åº“è¡¨ç»“æ„ã€‚
</code></pre>
<p>2.  <strong>æä¾›ä¸Šä¸‹æ–‡å’Œçº¦æŸ</strong></p>

<pre><code class="hljs language-diff" lang="diff">èƒŒæ™¯ï¼šç”µå•†ç³»ç»Ÿï¼Œæ—¥è®¢å•é‡10ä¸‡
è¦æ±‚ï¼š
<span class="hljs-deletion">- æ”¯æŒè®¢å•æ‹†åˆ†</span>
<span class="hljs-deletion">- éœ€è¦è®°å½•å®Œæ•´çš„çŠ¶æ€æµè½¬</span>
<span class="hljs-deletion">- è€ƒè™‘åˆ†åº“åˆ†è¡¨</span>
</code></pre>
<p>3.  <strong>ä½¿ç”¨ç¤ºä¾‹å¼•å¯¼</strong></p>

<pre><code class="hljs language-diff" lang="diff">å‚è€ƒä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š
è¡¨åï¼št_order
å­—æ®µï¼š
<span class="hljs-deletion">- id: bigint, ä¸»é”®</span>
<span class="hljs-deletion">- user_id: bigint, ç”¨æˆ·ID</span>
...
</code></pre>
<p>4.  <strong>åˆ†æ­¥éª¤æ€è€ƒï¼ˆChain of Thoughtï¼‰</strong></p>

<pre><code class="hljs language-markdown" lang="markdown">è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤åˆ†æï¼š
<span class="hljs-bullet">1.</span> è¯†åˆ«æ ¸å¿ƒå®ä½“
<span class="hljs-bullet">2.</span> ç¡®å®šè¡¨å…³ç³»
<span class="hljs-bullet">3.</span> è®¾è®¡å­—æ®µ
<span class="hljs-bullet">4.</span> æ·»åŠ ç´¢å¼•
<span class="hljs-bullet">5.</span> è€ƒè™‘æ‰©å±•æ€§
</code></pre>
<p><strong>Promptæ¨¡å¼æ€»ç»“ï¼š</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edf1443b120241d38ca8eb0d53cc6ac1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Sh6YeP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917015&amp;x-signature=U1hGOywBy1eSnxpZuTIn68CIpWw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-15"><strong>3.2.3 RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong></h4>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦RAGï¼Ÿ</strong></p>
<p>å¤§æ¨¡å‹è™½ç„¶å¼ºå¤§ï¼Œä½†å­˜åœ¨å±€é™ï¼š</p>
<ul>
<li>âŒ çŸ¥è¯†æˆªæ­¢æ—¥æœŸé™åˆ¶</li>
<li>âŒ æ— æ³•è®¿é—®ç§æœ‰æ•°æ®</li>
<li>âŒ å¯èƒ½äº§ç”Ÿå¹»è§‰ï¼ˆHallucinationï¼‰</li>
<li>âŒ ç¼ºä¹ç‰¹å®šé¢†åŸŸçŸ¥è¯†</li>
</ul>
<p><strong>RAGå¦‚ä½•è§£å†³ï¼Ÿ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as ç³»ç»Ÿ
    participant V as å‘é‡æ•°æ®åº“
    participant L as LLM

    U-&gt;&gt;S: æé—®ï¼š&amp;#34;å…¬å¸Q3è´¢æŠ¥å¦‚ä½•ï¼Ÿ&amp;#34;
    S-&gt;&gt;S: Queryæ”¹å†™ä¸ä¼˜åŒ–
    S-&gt;&gt;V: å‘é‡æ£€ç´¢ç›¸ä¼¼å†…å®¹
    V--&gt;&gt;S: è¿”å›Top-Kç›¸å…³æ–‡æ¡£
    Note over S: æ–‡æ¡£1: Q3è¥æ”¶100äº¿&lt;br/&gt;æ–‡æ¡£2: åŒæ¯”å¢é•¿25%&lt;br/&gt;æ–‡æ¡£3: å‡€åˆ©æ¶¦15äº¿
    S-&gt;&gt;L: æ„å»ºPromptï¼ˆé—®é¢˜+æ£€ç´¢æ–‡æ¡£ï¼‰
    Note over L: Prompt:&lt;br/&gt;åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”...&lt;br/&gt;[ç›¸å…³æ–‡æ¡£]&lt;br/&gt;é—®é¢˜: å…¬å¸Q3è´¢æŠ¥å¦‚ä½•ï¼Ÿ
    L--&gt;&gt;S: ç”Ÿæˆç­”æ¡ˆ
    S--&gt;&gt;U: &amp;#34;Q3è¥æ”¶100äº¿ï¼ŒåŒæ¯”å¢é•¿25%...&amp;#34;
</code></pre>
<p><strong>RAGæŠ€æœ¯æ¶æ„ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;æ•°æ®å‡†å¤‡&amp;#34;
        A[åŸå§‹æ–‡æ¡£] --&gt; B[æ–‡æ¡£åˆ†å—]
        B --&gt; C[å‘é‡åŒ–Embedding]
        C --&gt; D[å­˜å…¥å‘é‡æ•°æ®åº“]
    end

    subgraph &amp;#34;æ£€ç´¢é˜¶æ®µ&amp;#34;
        E[ç”¨æˆ·æŸ¥è¯¢] --&gt; F[Query Embedding]
        F --&gt; G[ç›¸ä¼¼åº¦æ£€ç´¢]
        D --&gt; G
        G --&gt; H[Top-Kæ–‡æ¡£]
    end

    subgraph &amp;#34;ç”Ÿæˆé˜¶æ®µ&amp;#34;
        H --&gt; I[Promptæ„å»º]
        E --&gt; I
        I --&gt; J[LLMç”Ÿæˆ]
        J --&gt; K[ç­”æ¡ˆè¾“å‡º]
    end

    style A fill:#e1f5ff
    style E fill:#e1f5ff
    style K fill:#e1ffe1
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹ï¼š</strong></p>



































<table><thead><tr><th>ç¯èŠ‚</th><th>æŠ€æœ¯é€‰æ‹©</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ–‡æ¡£åˆ‡åˆ†</strong></td><td>å›ºå®šé•¿åº¦ã€è¯­ä¹‰åˆ‡åˆ†ã€é€’å½’åˆ‡åˆ†</td><td>å¹³è¡¡ä¸Šä¸‹æ–‡å®Œæ•´æ€§å’Œæ£€ç´¢ç²¾åº¦</td></tr><tr><td><strong>Embeddingæ¨¡å‹</strong></td><td>OpenAIã€BGEã€M3E</td><td>ä¸­æ–‡æ¨èBGEæˆ–M3E</td></tr><tr><td><strong>å‘é‡æ•°æ®åº“</strong></td><td>Milvusã€Qdrantã€Pinecone</td><td>è€ƒè™‘æ€§èƒ½å’Œéƒ¨ç½²æ–¹å¼</td></tr><tr><td><strong>æ£€ç´¢ç­–ç•¥</strong></td><td>å¯†é›†æ£€ç´¢ã€ç¨€ç–æ£€ç´¢ã€æ··åˆæ£€ç´¢</td><td>æå‡å¬å›ç‡å’Œå‡†ç¡®ç‡</td></tr><tr><td><strong>é‡æ’åº</strong></td><td>Rerankæ¨¡å‹</td><td>ä¼˜åŒ–Top-Kç»“æœè´¨é‡</td></tr></tbody></table>
<h4 data-id="heading-16"><strong>3.2.4 Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ</strong></p>
<p>å…·å¤‡è‡ªä¸»å†³ç­–å’Œå·¥å…·ä½¿ç”¨èƒ½åŠ›çš„AIç³»ç»Ÿï¼Œèƒ½å¤Ÿç†è§£ä»»åŠ¡ã€åˆ¶å®šè®¡åˆ’ã€æ‰§è¡ŒåŠ¨ä½œã€å¹¶æ ¹æ®åé¦ˆè°ƒæ•´ç­–ç•¥ã€‚</p>
<p><strong>Agentæ ¸å¿ƒç»„ä»¶ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Agentæ ¸å¿ƒ] --&gt; B[æ„ŸçŸ¥ Perception]
    A --&gt; C[è§„åˆ’ Planning]
    A --&gt; D[è®°å¿† Memory]
    A --&gt; E[å·¥å…· Tools]
    A --&gt; F[æ‰§è¡Œ Action]

    B --&gt; B1[ç†è§£ä»»åŠ¡]
    B --&gt; B2[ç¯å¢ƒæ„ŸçŸ¥]

    C --&gt; C1[ä»»åŠ¡åˆ†è§£]
    C --&gt; C2[åˆ¶å®šè®¡åˆ’]
    C --&gt; C3[å†³ç­–æ¨ç†]

    D --&gt; D1[çŸ­æœŸè®°å¿†]
    D --&gt; D2[é•¿æœŸè®°å¿†]
    D --&gt; D3[ç»éªŒç§¯ç´¯]

    E --&gt; E1[æœç´¢å·¥å…·]
    E --&gt; E2[ä»£ç æ‰§è¡Œ]
    E --&gt; E3[APIè°ƒç”¨]
    E --&gt; E4[æ•°æ®åº“æŸ¥è¯¢]

    F --&gt; F1[æ‰§è¡Œæ“ä½œ]
    F --&gt; F2[è·å–åé¦ˆ]
    F --&gt; F3[è°ƒæ•´ç­–ç•¥]

    style A fill:#e1f5ff
</code></pre>
<p><strong>Agentå·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; æ¥æ”¶ä»»åŠ¡
    æ¥æ”¶ä»»åŠ¡ --&gt; ç†è§£åˆ†æ
    ç†è§£åˆ†æ --&gt; åˆ¶å®šè®¡åˆ’
    åˆ¶å®šè®¡åˆ’ --&gt; é€‰æ‹©å·¥å…·
    é€‰æ‹©å·¥å…· --&gt; æ‰§è¡ŒåŠ¨ä½œ
    æ‰§è¡ŒåŠ¨ä½œ --&gt; è§‚å¯Ÿç»“æœ
    è§‚å¯Ÿç»“æœ --&gt; åˆ¤æ–­å®Œæˆ: ä»»åŠ¡å®Œæˆï¼Ÿ
    åˆ¤æ–­å®Œæˆ --&gt; è¿”å›ç»“æœ: æ˜¯
    åˆ¤æ–­å®Œæˆ --&gt; è°ƒæ•´è®¡åˆ’: å¦
    è°ƒæ•´è®¡åˆ’ --&gt; é€‰æ‹©å·¥å…·
    è¿”å›ç»“æœ --&gt; [*]
</code></pre>
<p><strong>å…¸å‹Agentæ¨¡å¼ï¼š</strong></p>
<ol>
<li><strong>ReActæ¨¡å¼</strong>ï¼ˆReasoning + Actingï¼‰</li>
</ol>

<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">Thought:</span> ç”¨æˆ·æƒ³æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼Œæˆ‘éœ€è¦å…ˆè·å–è®¢å•ID
<span class="hljs-symbol">Action:</span> è°ƒç”¨getUserOrderså·¥å…·
<span class="hljs-symbol">Observation:</span> è¿”å›è®¢å•åˆ—è¡¨[#<span class="hljs-number">12345</span>, #<span class="hljs-number">12346</span>]
<span class="hljs-symbol">Thought:</span> ç”¨æˆ·æœ€è¿‘çš„è®¢å•æ˜¯#<span class="hljs-number">12346</span>ï¼ŒæŸ¥è¯¢å…¶çŠ¶æ€
<span class="hljs-symbol">Action:</span> è°ƒç”¨getOrderStatus(#<span class="hljs-number">12346</span>)
<span class="hljs-symbol">Observation:</span> è®¢å•çŠ¶æ€ä¸º<span class="hljs-string">"å·²å‘è´§"</span>
<span class="hljs-symbol">Thought:</span> æˆ‘å·²ç»å¾—åˆ°ç­”æ¡ˆ
<span class="hljs-symbol">Answer:</span> æ‚¨çš„è®¢å•#<span class="hljs-number">12346</span>å·²å‘è´§
</code></pre>
<p>2.  <strong>Plan-and-Executeæ¨¡å¼</strong></p>

<pre><code class="hljs language-ini" lang="ini">Plan:
1. æœç´¢Spring AI Alibabaå®˜æ–¹æ–‡æ¡£
2. æå–æ ¸å¿ƒç‰¹æ€§ä¿¡æ¯
3. å¯¹æ¯”LangChain4jçš„å·®å¼‚
4. ç”Ÿæˆå¯¹æ¯”è¡¨æ ¼

Execute:
<span class="hljs-section">[æ‰§è¡Œæ­¥éª¤1]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤2]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤3]</span> â†’ <span class="hljs-section">[æ‰§è¡Œæ­¥éª¤4]</span>
</code></pre>
<h4 data-id="heading-17"><strong>3.2.5 Function Callingï¼ˆå‡½æ•°è°ƒç”¨ï¼‰</strong></h4>
<p><strong>å®šä¹‰ï¼š</strong> è®©LLMèƒ½å¤Ÿä¸»åŠ¨è°ƒç”¨å¤–éƒ¨å‡½æ•°/APIæ¥å®Œæˆä»»åŠ¡ã€‚</p>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant L as LLM
    participant S as ç³»ç»Ÿ
    participant API as å¤–éƒ¨API

    U-&gt;&gt;L: &amp;#34;æŸ¥è¯¢åŒ—äº¬æ˜å¤©å¤©æ°”&amp;#34;
    L-&gt;&gt;L: åˆ†æéœ€è¦è°ƒç”¨å¤©æ°”API
    L-&gt;&gt;S: è¿”å›å‡½æ•°è°ƒç”¨è¯·æ±‚
    Note over S: {&lt;br/&gt;  &amp;#34;function&amp;#34;: &amp;#34;getWeather&amp;#34;,&lt;br/&gt;  &amp;#34;parameters&amp;#34;: {&lt;br/&gt;    &amp;#34;city&amp;#34;: &amp;#34;åŒ—äº¬&amp;#34;,&lt;br/&gt;    &amp;#34;date&amp;#34;: &amp;#34;æ˜å¤©&amp;#34;&lt;br/&gt;  }&lt;br/&gt;}
    S-&gt;&gt;API: è°ƒç”¨å¤©æ°”API
    API--&gt;&gt;S: è¿”å›å¤©æ°”æ•°æ®
    S-&gt;&gt;L: å°†ç»“æœè¿”å›ç»™LLM
    L-&gt;&gt;U: &amp;#34;åŒ—äº¬æ˜å¤©æ™´ï¼Œ15-25â„ƒ&amp;#34;
</code></pre>
<p><strong>Javaå®ç°ç¤ºä¾‹ï¼ˆLangChain4jï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰å·¥å…·å‡½æ•°</span>
<span class="hljs-meta">@Tool("æŸ¥è¯¢è®¢å•çŠ¶æ€")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrderStatus</span><span class="hljs-params">(<span class="hljs-meta">@P("è®¢å•ID")</span> String orderId)</span> {
    <span class="hljs-comment">// å®é™…ä¸šåŠ¡é€»è¾‘</span>
    <span class="hljs-keyword">return</span> orderService.queryStatus(orderId);
}

<span class="hljs-comment">// é…ç½®Agent</span>
<span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
    .apiKey(apiKey)
    .modelName(<span class="hljs-string">"gpt-4"</span>)
    .build();

<span class="hljs-type">Assistant</span> <span class="hljs-variable">assistant</span> <span class="hljs-operator">=</span> AiServices.builder(Assistant.class)
    .chatLanguageModel(model)
    .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderTools</span>())
    .build();

<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> assistant.chat(<span class="hljs-string">"å¸®æˆ‘æŸ¥è¯¢è®¢å•12345çš„çŠ¶æ€"</span>);
</code></pre>
<h4 data-id="heading-18"><strong>3.2.6 Fine-tuningï¼ˆå¾®è°ƒï¼‰</strong></h4>
<p><strong>ä»€ä¹ˆæ˜¯å¾®è°ƒï¼Ÿ</strong></p>
<p>åœ¨é¢„è®­ç»ƒæ¨¡å‹åŸºç¡€ä¸Šï¼Œä½¿ç”¨ç‰¹å®šé¢†åŸŸæ•°æ®è¿›è¡Œè¿›ä¸€æ­¥è®­ç»ƒï¼Œä½¿æ¨¡å‹é€‚åº”ç‰¹å®šä»»åŠ¡ã€‚</p>
<p><strong>å¾®è°ƒ vs RAG vs Prompt Engineeringï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ä»»åŠ¡éœ€æ±‚] --&gt; B{æ•°æ®é‡}
    B --&gt;|å°‘é‡æ•°æ®&lt;br/&gt;å¿«é€Ÿè¿­ä»£| C[Prompt Engineering]
    B --&gt;|ä¸­ç­‰æ•°æ®&lt;br/&gt;çŸ¥è¯†å¢å¼º| D[RAG]
    B --&gt;|å¤§é‡æ•°æ®&lt;br/&gt;è¡Œä¸ºå®šåˆ¶| E[Fine-tuning]

    C --&gt; C1[ä¼˜ç‚¹: é›¶æˆæœ¬å¿«é€ŸéªŒè¯]
    C --&gt; C2[ç¼ºç‚¹: å—é™äºæ¨¡å‹èƒ½åŠ›]

    D --&gt; D1[ä¼˜ç‚¹: åŠ¨æ€çŸ¥è¯†æ›´æ–°]
    D --&gt; D2[ç¼ºç‚¹: éœ€è¦ç»´æŠ¤æ£€ç´¢ç³»ç»Ÿ]

    E --&gt; E1[ä¼˜ç‚¹: æ·±åº¦å®šåˆ¶]
    E --&gt; E2[ç¼ºç‚¹: æˆæœ¬é«˜å‘¨æœŸé•¿]

    style C fill:#e1ffe1
    style D fill:#fff4e1
    style E fill:#ffe1e1
</code></pre>
<p><strong>é€‰æ‹©å†³ç­–æ ‘ï¼š</strong></p>



































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>æ ¼å¼åŒ–è¾“å‡º</td><td>Prompt</td><td>ç®€å•æœ‰æ•ˆ</td></tr><tr><td>ä¼ä¸šçŸ¥è¯†é—®ç­”</td><td>RAG</td><td>çŸ¥è¯†å¯æ›´æ–°</td></tr><tr><td>ç‰¹å®šé¢†åŸŸå¯¹è¯é£æ ¼</td><td>Fine-tuning</td><td>æ·±åº¦å®šåˆ¶</td></tr><tr><td>å¤šè½®å¯¹è¯</td><td>Prompt + RAG</td><td>ç»„åˆä½¿ç”¨</td></tr><tr><td>ä¸“ä¸šæœ¯è¯­ç¿»è¯‘</td><td>Fine-tuning</td><td>ä¸“ä¸šæ€§å¼º</td></tr></tbody></table>
<h3 data-id="heading-19">3.3 æŠ€æœ¯æ ˆå…¨æ™¯å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;å‰ç«¯å±‚&amp;#34;
        UI1[Webç•Œé¢]
        UI2[ç§»åŠ¨ç«¯]
        UI3[IDEæ’ä»¶]
    end

    subgraph &amp;#34;åº”ç”¨å±‚&amp;#34;
        APP1[Spring Bootåº”ç”¨]
        APP2[å¾®æœåŠ¡]
        APP3[Serverless]
    end

    subgraph &amp;#34;AIæ¡†æ¶å±‚&amp;#34;
        FW1[Spring AI Alibaba]
        FW2[LangChain4j]
        FW3[Semantic Kernel]
    end

    subgraph &amp;#34;AIèƒ½åŠ›å±‚&amp;#34;
        CAP1[Chatå¯¹è¯]
        CAP2[Embeddingå‘é‡åŒ–]
        CAP3[Imageç”Ÿæˆ]
        CAP4[Audioå¤„ç†]
    end

    subgraph &amp;#34;æ¨¡å‹æ¥å…¥å±‚&amp;#34;
        MOD1[OpenAI API]
        MOD2[Anthropic API]
        MOD3[é˜¿é‡Œäº‘ç™¾ç‚¼]
        MOD4[æœ¬åœ°æ¨¡å‹Ollama]
    end

    subgraph &amp;#34;æ•°æ®å±‚&amp;#34;
        DATA1[å‘é‡æ•°æ®åº“]
        DATA2[å…³ç³»æ•°æ®åº“]
        DATA3[ç¼“å­˜Redis]
        DATA4[å¯¹è±¡å­˜å‚¨]
    end

    UI1 &amp; UI2 &amp; UI3 --&gt; APP1 &amp; APP2 &amp; APP3
    APP1 &amp; APP2 &amp; APP3 --&gt; FW1 &amp; FW2 &amp; FW3
    FW1 &amp; FW2 &amp; FW3 --&gt; CAP1 &amp; CAP2 &amp; CAP3 &amp; CAP4
    CAP1 &amp; CAP2 &amp; CAP3 &amp; CAP4 --&gt; MOD1 &amp; MOD2 &amp; MOD3 &amp; MOD4
    FW1 &amp; FW2 &amp; FW3 --&gt; DATA1 &amp; DATA2 &amp; DATA3 &amp; DATA4

    style FW1 fill:#e1f5ff
    style FW2 fill:#e1f5ff
</code></pre>
<hr/>
<h2 data-id="heading-20">4. AI Codingå·¥å…·ï¼šå¼€å‘è€…çš„æ™ºèƒ½åŠ©æ‰‹</h2>
<h3 data-id="heading-21">4.1 AI Codingçš„æœ¬è´¨</h3>
<p>AI Codingä¸æ˜¯æ›¿ä»£ç¨‹åºå‘˜ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>âœ… æå‡å¼€å‘æ•ˆç‡ï¼ˆ2-5å€ï¼‰</li>
<li>âœ… å‡å°‘é‡å¤æ€§å·¥ä½œ</li>
<li>âœ… è¾…åŠ©å­¦ä¹ æ–°æŠ€æœ¯</li>
<li>âœ… æ”¹å–„ä»£ç è´¨é‡</li>
</ul>
<h3 data-id="heading-22">4.2 ä¸»æµå·¥å…·å…¨æ™¯å¯¹æ¯”</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86c7eb1721b541afa7a1643c3878656b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Sh6YeP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917015&amp;x-signature=IXvdRjJrpn0VzJjc81u%2BccWe9rQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-23">4.3 é‡ç‚¹å·¥å…·è¯¦è§£</h3>
<h4 data-id="heading-24"><strong>4.3.1 Claude Code</strong></h4>
<p><strong>å®šä½ï¼š</strong> å®˜æ–¹CLIå·¥å…·ï¼Œæ·±åº¦é›†æˆClaude 3.5 Sonnetï¼Œä¸“æ³¨äºä»£ç ç”Ÿæˆå’Œå·¥ç¨‹å®è·µã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>






























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th><th>ä¼˜åŠ¿</th></tr></thead><tbody><tr><td><strong>é•¿ä¸Šä¸‹æ–‡</strong></td><td>æ”¯æŒ200K tokens</td><td>å¯ä»¥ç†è§£æ•´ä¸ªä»£ç åº“</td></tr><tr><td><strong>Artifacts</strong></td><td>ç‹¬ç«‹çš„ä»£ç é¢„è§ˆ</td><td>æ‰€è§å³æ‰€å¾—</td></tr><tr><td><strong>å·¥å…·é›†æˆ</strong></td><td>Bashã€æ–‡ä»¶æ“ä½œã€æœç´¢</td><td>å®Œæ•´çš„å¼€å‘ç¯å¢ƒ</td></tr><tr><td><strong>æ€ç»´é“¾</strong></td><td>å¯è§çš„æ¨ç†è¿‡ç¨‹</td><td>ç†è§£AIçš„å†³ç­–é€»è¾‘</td></tr></tbody></table>
<p><strong>å…¸å‹ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä»£ç é‡æ„</span>
claude <span class="hljs-string">"å°†è¿™ä¸ªControlleræ”¹é€ ä¸ºRESTfulé£æ ¼ï¼Œå¹¶æ·»åŠ å‚æ•°æ ¡éªŒ"</span>

<span class="hljs-comment"># 2. å•å…ƒæµ‹è¯•ç”Ÿæˆ</span>
claude <span class="hljs-string">"ä¸ºUserServiceç”Ÿæˆå®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–ç‡è¾¾åˆ°80%"</span>

<span class="hljs-comment"># 3. ä»£ç å®¡æŸ¥</span>
claude <span class="hljs-string">"å®¡æŸ¥è¿™æ®µä»£ç çš„å®‰å…¨æ€§å’Œæ€§èƒ½é—®é¢˜"</span>

<span class="hljs-comment"># 4. æ¶æ„è®¾è®¡</span>
claude <span class="hljs-string">"è®¾è®¡ä¸€ä¸ªæ”¯æŒç™¾ä¸‡çº§ç”¨æˆ·çš„ç§’æ€ç³»ç»Ÿæ¶æ„"</span>
</code></pre>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä½¿ç”¨Claude Code] --&gt; B[å‡†å¤‡å……åˆ†çš„ä¸Šä¸‹æ–‡]
    B --&gt; C[æ˜ç¡®çš„éœ€æ±‚æè¿°]
    C --&gt; D[è¿­ä»£å¼äº¤äº’]
    D --&gt; E[ä»£ç å®¡æŸ¥éªŒè¯]

    B --&gt; B1[é¡¹ç›®README]
    B --&gt; B2[ç›¸å…³ä»£ç æ–‡ä»¶]
    B --&gt; B3[æŠ€æœ¯æ ˆè¯´æ˜]

    C --&gt; C1[åŠŸèƒ½éœ€æ±‚]
    C --&gt; C2[æŠ€æœ¯çº¦æŸ]
    C --&gt; C3[æœŸæœ›è¾“å‡ºæ ¼å¼]

    D --&gt; D1[å…ˆæ•´ä½“åç»†èŠ‚]
    D --&gt; D2[åŠæ—¶åé¦ˆè°ƒæ•´]

    E --&gt; E1[è¿è¡Œæµ‹è¯•]
    E --&gt; E2[ä»£ç review]
    E --&gt; E3[æ€§èƒ½éªŒè¯]
</code></pre>
<h4 data-id="heading-25"><strong>4.3.2 Cursor</strong></h4>
<p><strong>å®šä½ï¼š</strong> AI-firstçš„IDEï¼ŒåŸºäºVS Codeæ·±åº¦å®šåˆ¶ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<ol>
<li>
<p><strong>Cmd+Kï¼šå†…è”ç¼–è¾‘</strong></p>
<ul>
<li>é€‰ä¸­ä»£ç ï¼Œæè¿°éœ€æ±‚</li>
<li>AIç›´æ¥ä¿®æ”¹ä»£ç </li>
<li>æ”¯æŒå¤šå¤„åŒæ—¶ç¼–è¾‘</li>
</ul>
</li>
<li>
<p><strong>Composerï¼šå¤šæ–‡ä»¶ç¼–è¾‘</strong></p>
<ul>
<li>è·¨æ–‡ä»¶é‡æ„</li>
<li>ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªç›¸å…³æ–‡ä»¶</li>
<li>ä¿æŒä»£ç ä¸€è‡´æ€§</li>
</ul>
</li>
<li>
<p><strong>Chatï¼šå¯¹è¯å¼ç¼–ç¨‹</strong></p>
<ul>
<li><code>@Codebase</code> æœç´¢æ•´ä¸ªä»£ç åº“</li>
<li><code>@Web</code> æœç´¢ç½‘ç»œèµ„æ–™</li>
<li><code>@Docs</code> æŸ¥è¯¢æ–‡æ¡£</li>
</ul>
</li>
<li>
<p><strong>Tabï¼šä»£ç è¡¥å…¨</strong></p>
<ul>
<li>ä¸Šä¸‹æ–‡æ„ŸçŸ¥è¡¥å…¨</li>
<li>å­¦ä¹ ä¸ªäººç¼–ç é£æ ¼</li>
</ul>
</li>
</ol>
<p><strong>Cursor vs Claude Codeï¼š</strong></p>








































<table><thead><tr><th>ç»´åº¦</th><th>Cursor</th><th>Claude Code</th></tr></thead><tbody><tr><td><strong>ç•Œé¢</strong></td><td>å›¾å½¢åŒ–IDE</td><td>å‘½ä»¤è¡ŒCLI</td></tr><tr><td><strong>é›†æˆåº¦</strong></td><td>æ·±åº¦é›†æˆVS Code</td><td>ç‹¬ç«‹å·¥å…·</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>å¹³ç¼“</td><td>ç¨é™¡å³­</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>ä¸­ç­‰</td><td>é«˜</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ—¥å¸¸å¼€å‘</td><td>å¤æ‚ä»»åŠ¡ã€è‡ªåŠ¨åŒ–</td></tr><tr><td><strong>ä»·æ ¼</strong></td><td>$20/æœˆ</td><td>æŒ‰APIè®¡è´¹</td></tr></tbody></table>
<p><strong>ç»„åˆä½¿ç”¨å»ºè®®ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">æ—¥å¸¸å¼€å‘ï¼š<span class="hljs-attribute">Cursor</span>ï¼ˆå¿«é€Ÿè¿­ä»£ï¼‰
å¤æ‚é‡æ„ï¼šClaude <span class="hljs-selector-tag">Code</span>ï¼ˆæ·±åº¦æ€è€ƒï¼‰
å­¦ä¹ æ¢ç´¢ï¼šä¸¤è€…ç»“åˆä½¿ç”¨
</code></pre>
<h4 data-id="heading-26"><strong>4.3.3 GitHub Copilot</strong></h4>
<p><strong>å®šä½ï¼š</strong> GitHubå®˜æ–¹ï¼Œé›†æˆåº¦æœ€é«˜ã€‚</p>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… æ— ç¼é›†æˆGitHubç”Ÿæ€</li>
<li>âœ… æ”¯æŒå‡ ä¹æ‰€æœ‰IDE</li>
<li>âœ… ä¼ä¸šç‰ˆå®‰å…¨åˆè§„</li>
<li>âœ… ChatåŠŸèƒ½å¢å¼º</li>
</ul>
<p><strong>é€‚åˆï¼š</strong></p>
<ul>
<li>ä½¿ç”¨VS Code/JetBrainsçš„å›¢é˜Ÿ</li>
<li>éœ€è¦ä¼ä¸šçº§å®‰å…¨çš„å…¬å¸</li>
<li>GitHubæ·±åº¦ç”¨æˆ·</li>
</ul>
<h4 data-id="heading-27"><strong>4.3.4 å…¶ä»–å·¥å…·ç®€ä»‹</strong></h4>






























<table><thead><tr><th>å·¥å…·</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Codeium</strong></td><td>å…è´¹ã€éšç§ä¿æŠ¤</td><td>ä¸ªäººå¼€å‘è€…ã€åˆå­¦è€…</td></tr><tr><td><strong>Tabnine</strong></td><td>æœ¬åœ°è¿è¡Œã€ä¼ä¸šçº§</td><td>å¯¹æ•°æ®å®‰å…¨è¦æ±‚é«˜çš„ä¼ä¸š</td></tr><tr><td><strong>Amazon Q</strong></td><td>AWSç”Ÿæ€é›†æˆ</td><td>ä½¿ç”¨AWSæœåŠ¡çš„å›¢é˜Ÿ</td></tr><tr><td><strong>Windsurf</strong></td><td>æ–°å…´å·¥å…·ï¼Œæµå¼ä½“éªŒ</td><td>å°é²œç”¨æˆ·</td></tr></tbody></table>
<h3 data-id="heading-28">4.4 å·¥å…·é€‰æ‹©å†³ç­–æ ‘</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[é€‰æ‹©AI Codingå·¥å…·] --&gt; B{é¢„ç®—?}
    B --&gt;|æœ‰é™| C{éœ€è¦IDEé›†æˆ?}
    B --&gt;|å……è¶³| D{ä¸»è¦ç”¨é€”?}

    C --&gt;|æ˜¯| E[Codeiumå…è´¹ç‰ˆ]
    C --&gt;|å¦| F[Claude Code API]

    D --&gt;|æ—¥å¸¸å¼€å‘| G{ä½¿ç”¨VS Code?}
    D --&gt;|å¤æ‚ä»»åŠ¡| H[Claude Code]
    D --&gt;|å›¢é˜Ÿåä½œ| I[GitHub Copilotä¼ä¸šç‰ˆ]

    G --&gt;|æ˜¯| J[Cursor]
    G --&gt;|å¦| K[JetBrains AI]

    E --&gt; L[å¼€å§‹ä½¿ç”¨]
    F --&gt; L
    H --&gt; L
    I --&gt; L
    J --&gt; L
    K --&gt; L

    style L fill:#e1ffe1
</code></pre>
<h3 data-id="heading-29">4.5 AI Codingæœ€ä½³å®è·µ</h3>
<h4 data-id="heading-30"><strong>4.5.1 æç¤ºè¯æŠ€å·§</strong></h4>
<p><strong>1. æä¾›è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡</strong></p>
<p>âŒ ä¸å¥½çš„æç¤ºï¼š</p>
<pre><code class="hljs">å¸®æˆ‘å†™ä¸ªç”¨æˆ·æœåŠ¡
</code></pre>
<p>âœ… å¥½çš„æç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">é¡¹ç›®ï¼šSpring Boot 3.2 + MyBatis Plus
éœ€æ±‚ï¼šåˆ›å»ºUserServiceï¼ŒåŒ…å«CRUDæ“ä½œ
è¦æ±‚ï¼š
<span class="hljs-bullet">1.</span> ä½¿ç”¨@Serviceæ³¨è§£
<span class="hljs-bullet">2.</span> é›†æˆRedisç¼“å­˜
<span class="hljs-bullet">3.</span> æ·»åŠ äº‹åŠ¡ç®¡ç†
<span class="hljs-bullet">4.</span> å‚æ•°æ ¡éªŒä½¿ç”¨JSR-303
<span class="hljs-bullet">5.</span> ç»Ÿä¸€å¼‚å¸¸å¤„ç†
</code></pre>
<p><strong>2. æ˜ç¡®æŠ€æœ¯æ ˆå’Œçº¦æŸ</strong></p>
<pre><code class="hljs language-diff" lang="diff">æŠ€æœ¯æ ˆï¼š
<span class="hljs-deletion">- JDK 17</span>
<span class="hljs-deletion">- Spring Boot 3.2</span>
<span class="hljs-deletion">- MySQL 8.0</span>
<span class="hljs-deletion">- Redis 7.0</span>

çº¦æŸï¼š
<span class="hljs-deletion">- éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘è§„èŒƒ</span>
<span class="hljs-deletion">- ä½¿ç”¨Lombokå‡å°‘æ ·æ¿ä»£ç </span>
<span class="hljs-deletion">- æ—¥å¿—ä½¿ç”¨SLF4J</span>
<span class="hljs-deletion">- è¿”å›ç»Ÿä¸€çš„Resultå¯¹è±¡</span>
</code></pre>
<p><strong>3. ä½¿ç”¨ç¤ºä¾‹é©±åŠ¨</strong></p>
<pre><code class="hljs language-less" lang="less">å‚è€ƒä»¥ä¸‹ä»£ç é£æ ¼ï¼š

<span class="hljs-variable">@Service</span>
<span class="hljs-variable">@Slf4j</span>
public class OrderService {

    <span class="hljs-variable">@Resource</span>
    private OrderMapper orderMapper;

    <span class="hljs-variable">@Cacheable</span>(value = <span class="hljs-string">"order"</span>, key = <span class="hljs-string">"#id"</span>)
    public OrderDTO <span class="hljs-built_in">getById</span>(Long id) {
        <span class="hljs-comment">// ...</span>
    }
}

è¯·æŒ‰ç›¸åŒé£æ ¼å®ç°UserService
</code></pre>
<h4 data-id="heading-31"><strong>4.5.2 ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•</strong></h4>
<p>AIç”Ÿæˆä»£ç åï¼Œå¿…é¡»æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((ä»£ç å®¡æŸ¥))
    åŠŸèƒ½æ­£ç¡®æ€§
      é€»è¾‘æ˜¯å¦æ­£ç¡®
      è¾¹ç•Œæ¡ä»¶å¤„ç†
      å¼‚å¸¸å¤„ç†
    å®‰å…¨æ€§
      SQLæ³¨å…¥
      XSSæ”»å‡»
      æ•æ„Ÿä¿¡æ¯æ³„éœ²
    æ€§èƒ½
      æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
      ç¼“å­˜ä½¿ç”¨
      èµ„æºé‡Šæ”¾
    ä»£ç è´¨é‡
      å‘½åè§„èŒƒ
      æ³¨é‡Šå®Œæ•´æ€§
      å¯è¯»æ€§
    å·¥ç¨‹è§„èŒƒ
      æ—¥å¿—è®°å½•
      äº‹åŠ¡ç®¡ç†
      é”™è¯¯ç ç»Ÿä¸€
</code></pre>
<h4 data-id="heading-32"><strong>4.5.3 è¿­ä»£å¼å¼€å‘æµç¨‹</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant D as å¼€å‘è€…
    participant AI as AIå·¥å…·
    participant C as ä»£ç åº“
    participant T as æµ‹è¯•

    D-&gt;&gt;AI: 1. æè¿°éœ€æ±‚ï¼ˆé«˜å±‚æ¬¡ï¼‰
    AI--&gt;&gt;D: 2. ç”Ÿæˆæ¶æ„è®¾è®¡
    D-&gt;&gt;D: 3. Reviewè®¾è®¡ï¼Œæå‡ºè°ƒæ•´
    D-&gt;&gt;AI: 4. ç»†åŒ–å…·ä½“æ¨¡å—
    AI--&gt;&gt;C: 5. ç”Ÿæˆä»£ç 
    D-&gt;&gt;T: 6. è¿è¡Œæµ‹è¯•
    T--&gt;&gt;D: 7. æµ‹è¯•ç»“æœ
    alt æµ‹è¯•å¤±è´¥
        D-&gt;&gt;AI: 8a. åé¦ˆé”™è¯¯ä¿¡æ¯
        AI--&gt;&gt;C: 9a. ä¿®å¤ä»£ç 
    else æµ‹è¯•é€šè¿‡
        D-&gt;&gt;AI: 8b. è¦æ±‚ä¼˜åŒ–
        AI--&gt;&gt;C: 9b. é‡æ„ä¼˜åŒ–
    end
    D-&gt;&gt;D: 10. æœ€ç»ˆReview
</code></pre>
<hr/>
<h2 data-id="heading-33">5. AIå·¥ç¨‹åŒ–å®è·µï¼šä»æ¦‚å¿µåˆ°è½åœ°</h2>
<h3 data-id="heading-34">5.1 AIåº”ç”¨æ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-35"><strong>5.1.1 æ•´ä½“æ¶æ„</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;ç”¨æˆ·å±‚&amp;#34;
        U1[Webå‰ç«¯]
        U2[ç§»åŠ¨ç«¯]
        U3[APIè°ƒç”¨]
    end

    subgraph &amp;#34;åº”ç”¨å±‚ - Spring Boot&amp;#34;
        A1[Controllerå±‚]
        A2[Serviceå±‚]
        A3[AI Serviceå±‚]
    end

    subgraph &amp;#34;AIæ¡†æ¶å±‚&amp;#34;
        F1[Spring AI Alibaba]
        F2[LangChain4j]
    end

    subgraph &amp;#34;AIèƒ½åŠ›å±‚&amp;#34;
        C1[Chatå¯¹è¯]
        C2[RAGæ£€ç´¢]
        C3[Agentæ‰§è¡Œ]
        C4[Embedding]
    end

    subgraph &amp;#34;æ¨¡å‹å±‚&amp;#34;
        M1[é€šä¹‰åƒé—®]
        M2[Claude]
        M3[GPT-4]
    end

    subgraph &amp;#34;æ•°æ®å±‚&amp;#34;
        D1[(MySQL)]
        D2[(å‘é‡æ•°æ®åº“)]
        D3[(Redis)]
    end

    U1 &amp; U2 &amp; U3 --&gt; A1
    A1 --&gt; A2
    A2 --&gt; A3
    A3 --&gt; F1 &amp; F2
    F1 &amp; F2 --&gt; C1 &amp; C2 &amp; C3 &amp; C4
    C1 &amp; C2 &amp; C3 &amp; C4 --&gt; M1 &amp; M2 &amp; M3
    A2 &amp; A3 --&gt; D1 &amp; D2 &amp; D3

    style A3 fill:#e1f5ff
    style F1 fill:#fff4e1
    style F2 fill:#fff4e1
</code></pre>
<h4 data-id="heading-36"><strong>5.1.2 åˆ†å±‚è®¾è®¡åŸåˆ™</strong></h4>
<p><strong>1. æ§åˆ¶å±‚ï¼ˆControllerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/ai/chat")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatService chatService;

    <span class="hljs-meta">@PostMapping("/stream")</span>
    <span class="hljs-keyword">public</span> SseEmitter <span class="hljs-title function_">chatStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest request)</span> {
        <span class="hljs-comment">// å¤„ç†æµå¼å“åº”</span>
        <span class="hljs-keyword">return</span> chatService.streamChat(request);
    }

    <span class="hljs-meta">@PostMapping("/sync")</span>
    <span class="hljs-keyword">public</span> Result&lt;ChatResponse&gt; <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ChatRequest request)</span> {
        <span class="hljs-comment">// åŒæ­¥å“åº”</span>
        <span class="hljs-keyword">return</span> Result.success(chatService.chat(request));
    }
}
</code></pre>
<p><strong>2. æœåŠ¡å±‚ï¼ˆServiceï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;  <span class="hljs-comment">// Spring AI</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ConversationService conversationService;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> RagService ragService;

    <span class="hljs-keyword">public</span> ChatResponse <span class="hljs-title function_">chat</span><span class="hljs-params">(ChatRequest request)</span> {
        <span class="hljs-comment">// 1. åŠ è½½å†å²å¯¹è¯</span>
        List&lt;Message&gt; history = conversationService.getHistory(request.getSessionId());

        <span class="hljs-comment">// 2. RAGæ£€ç´¢</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> ragService.retrieve(request.getQuestion());

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> buildPrompt(request.getQuestion(), context);

        <span class="hljs-comment">// 4. è°ƒç”¨å¤§æ¨¡å‹</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(prompt);

        <span class="hljs-comment">// 5. ä¿å­˜å¯¹è¯</span>
        conversationService.save(request.getSessionId(), request.getQuestion(), response);

        <span class="hljs-keyword">return</span> ChatResponse.builder()
            .answer(response)
            .sessionId(request.getSessionId())
            .build();
    }
}
</code></pre>
<h3 data-id="heading-37">5.2 Javaç”Ÿæ€AIæ¡†æ¶æ·±åº¦å¯¹æ¯”</h3>
<h4 data-id="heading-38"><strong>5.2.1 Spring AI Alibabaè¯¦è§£</strong></h4>
<p><strong>å®šä½ï¼š</strong> é˜¿é‡Œäº‘å®˜æ–¹AIæ¡†æ¶ï¼Œæ·±åº¦é›†æˆé˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°ï¼Œä¹Ÿæ”¯æŒOpenAIç­‰ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((Spring AI Alibaba))
    ç»Ÿä¸€æŠ½è±¡
      ChatClient
      ImageClient
      AudioClient
      EmbeddingClient
    æ¨¡å‹æ”¯æŒ
      é€šä¹‰åƒé—®
      é€šä¹‰ä¸‡ç›¸
      ç™¾ç‚¼å¹³å°
      OpenAIå…¼å®¹
    RAGæ”¯æŒ
      DocumentReader
      VectorStore
      Retriever
    Springé›†æˆ
      è‡ªåŠ¨é…ç½®
      ä¾èµ–æ³¨å…¥
      é…ç½®å±æ€§
    ä¼ä¸šç‰¹æ€§
      å¯è§‚æµ‹æ€§
      é™æµé™çº§
      å®‰å…¨å®¡è®¡
</code></pre>
<p><strong>å¿«é€Ÿå¼€å§‹ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- Mavenä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-ai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0-M2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">dashscope:</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">${DASHSCOPE_API_KEY}</span>
      <span class="hljs-attr">chat:</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">qwen-max</span>
          <span class="hljs-attr">temperature:</span> <span class="hljs-number">0.7</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">return</span> chatClient.call(message);
    }

    <span class="hljs-comment">// æµå¼å“åº”</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">streamChat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">return</span> chatClient.stream(message)
            .map(ChatResponse::getResult)
            .map(result -&gt; result.getOutput().getContent());
    }
}
</code></pre>
<p><strong>RAGå®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RagConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> VectorStore <span class="hljs-title function_">vectorStore</span><span class="hljs-params">(EmbeddingClient embeddingClient)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleVectorStore</span>(embeddingClient);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DocumentReader <span class="hljs-title function_">pdfReader</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagePdfDocumentReader</span>(<span class="hljs-string">"classpath:docs/manual.pdf"</span>);
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RagService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> VectorStore vectorStore;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">ragChat</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        List&lt;Document&gt; docs = vectorStore.similaritySearch(
            SearchRequest.query(question).withTopK(<span class="hljs-number">3</span>)
        );

        <span class="hljs-comment">// 2. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> docs.stream()
            .map(Document::getContent)
            .collect(Collectors.joining(<span class="hljs-string">"\n"</span>));

        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> <span class="hljs-string">"""
            åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š

            %s

            é—®é¢˜ï¼š%s
            """</span>.formatted(context, question);

        <span class="hljs-comment">// 3. è°ƒç”¨å¤§æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> chatClient.call(prompt);
    }
}
</code></pre>
<h4 data-id="heading-39"><strong>5.2.2 LangChain4jè¯¦è§£</strong></h4>
<p><strong>å®šä½ï¼š</strong> Javaç‰ˆLangChainï¼ŒåŠŸèƒ½æœ€å…¨é¢çš„Java AIæ¡†æ¶ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[LangChain4j] --&gt; B[æ¨¡å‹æŠ½è±¡]
    A --&gt; C[AI Services]
    A --&gt; D[Tools/Agents]
    A --&gt; E[RAGé“¾è·¯]
    A --&gt; F[Memoryç®¡ç†]

    B --&gt; B1[20+æ¨¡å‹æ”¯æŒ]
    B --&gt; B2[ç»Ÿä¸€æ¥å£]

    C --&gt; C1[æ¥å£å¼AI]
    C --&gt; C2[è‡ªåŠ¨Prompt]

    D --&gt; D1[å‡½æ•°è°ƒç”¨]
    D --&gt; D2[ReAct Agent]

    E --&gt; E1[æ–‡æ¡£åŠ è½½å™¨]
    E --&gt; E2[å‘é‡å­˜å‚¨]
    E --&gt; E3[æ£€ç´¢å™¨]

    F --&gt; F1[å¯¹è¯è®°å¿†]
    F --&gt; F2[Tokenç®¡ç†]
</code></pre>
<p><strong>å¿«é€Ÿå¼€å§‹ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.35.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>dev.langchain4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>langchain4j-open-ai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.35.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AI Services - æ¥å£å¼ç¼–ç¨‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Assistant</span> {

    <span class="hljs-meta">@SystemMessage("ä½ æ˜¯ä¸€ä¸ªJavaä¸“å®¶ï¼Œå¸®åŠ©å¼€å‘è€…è§£å†³æŠ€æœ¯é—®é¢˜")</span>
    String <span class="hljs-title function_">chat</span><span class="hljs-params">(String userMessage)</span>;

    <span class="hljs-meta">@UserMessage("""
        åˆ†æä»¥ä¸‹ä»£ç çš„é—®é¢˜ï¼š
        ```java
        {{code}}
        ```
        """)</span>
    String <span class="hljs-title function_">analyzeCode</span><span class="hljs-params">(<span class="hljs-meta">@V("code")</span> String code)</span>;
}

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LangChain4jConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Assistant <span class="hljs-title function_">assistant</span><span class="hljs-params">(<span class="hljs-meta">@Value("${openai.api.key}")</span> String apiKey)</span> {
        <span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(apiKey)
            .modelName(GPT_4_O)
            .temperature(<span class="hljs-number">0.7</span>)
            .build();

        <span class="hljs-keyword">return</span> AiServices.create(Assistant.class, model);
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeReviewService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> Assistant assistant;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">reviewCode</span><span class="hljs-params">(String code)</span> {
        <span class="hljs-keyword">return</span> assistant.analyzeCode(code);
    }
}
</code></pre>
<p><strong>Toolsï¼ˆå‡½æ•°è°ƒç”¨ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰å·¥å…·</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseTools</span> {

    <span class="hljs-meta">@Tool("æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserInfo</span><span class="hljs-params">(<span class="hljs-meta">@P("ç”¨æˆ·ID")</span> Long userId)</span> {
        <span class="hljs-comment">// å®é™…æ•°æ®åº“æŸ¥è¯¢</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userMapper.selectById(userId);
        <span class="hljs-keyword">return</span> JSON.toJSONString(user);
    }

    <span class="hljs-meta">@Tool("æ›´æ–°ç”¨æˆ·çŠ¶æ€")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">updateUserStatus</span><span class="hljs-params">(
        <span class="hljs-meta">@P("ç”¨æˆ·ID")</span> Long userId,
        <span class="hljs-meta">@P("çŠ¶æ€")</span> String status)</span> {
        userMapper.updateStatus(userId, status);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ›´æ–°æˆåŠŸ"</span>;
    }
}

<span class="hljs-comment">// é…ç½®Agent</span>
<span class="hljs-meta">@Bean</span>
<span class="hljs-keyword">public</span> Assistant <span class="hljs-title function_">agentAssistant</span><span class="hljs-params">()</span> {
    <span class="hljs-type">ChatLanguageModel</span> <span class="hljs-variable">model</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
        .apiKey(apiKey)
        .modelName(GPT_4_O)
        .build();

    <span class="hljs-keyword">return</span> AiServices.builder(Assistant.class)
        .chatLanguageModel(model)
        .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseTools</span>())  <span class="hljs-comment">// æ³¨å†Œå·¥å…·</span>
        .chatMemory(MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>))
        .build();
}
</code></pre>
<p><strong>RAGå®Œæ•´å®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentRagService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmbeddingStore&lt;TextSegment&gt; embeddingStore;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmbeddingModel embeddingModel;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatLanguageModel chatModel;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DocumentRagService</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. åˆå§‹åŒ–Embeddingæ¨¡å‹</span>
        <span class="hljs-built_in">this</span>.embeddingModel = OpenAiEmbeddingModel.builder()
            .apiKey(apiKey)
            .modelName(<span class="hljs-string">"text-embedding-3-small"</span>)
            .build();

        <span class="hljs-comment">// 2. åˆå§‹åŒ–å‘é‡æ•°æ®åº“</span>
        <span class="hljs-built_in">this</span>.embeddingStore = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryEmbeddingStore</span>&lt;&gt;();

        <span class="hljs-comment">// 3. åˆå§‹åŒ–Chatæ¨¡å‹</span>
        <span class="hljs-built_in">this</span>.chatModel = OpenAiChatModel.builder()
            .apiKey(apiKey)
            .modelName(GPT_4_O)
            .build();

        <span class="hljs-comment">// 4. åŠ è½½æ–‡æ¡£</span>
        loadDocuments();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadDocuments</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¯»å–æ–‡æ¡£</span>
        <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> FileSystemDocumentLoader.loadDocument(
            <span class="hljs-string">"docs/knowledge.pdf"</span>,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApachePdfBoxDocumentParser</span>()
        );

        <span class="hljs-comment">// æ–‡æ¡£åˆ†å—</span>
        <span class="hljs-type">DocumentSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> DocumentSplitters.recursive(
            <span class="hljs-number">500</span>,  <span class="hljs-comment">// chunk size</span>
            <span class="hljs-number">50</span>    <span class="hljs-comment">// overlap</span>
        );
        List&lt;TextSegment&gt; segments = splitter.split(document);

        <span class="hljs-comment">// å‘é‡åŒ–å¹¶å­˜å‚¨</span>
        List&lt;Embedding&gt; embeddings = embeddingModel.embedAll(segments).content();
        embeddingStore.addAll(embeddings, segments);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">ragQuery</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        <span class="hljs-type">Embedding</span> <span class="hljs-variable">questionEmbedding</span> <span class="hljs-operator">=</span> embeddingModel.embed(question).content();
        List&lt;EmbeddingMatch&lt;TextSegment&gt;&gt; matches = embeddingStore.findRelevant(
            questionEmbedding,
            <span class="hljs-number">3</span>,  <span class="hljs-comment">// top-k</span>
            <span class="hljs-number">0.7</span> <span class="hljs-comment">// æœ€å°ç›¸ä¼¼åº¦</span>
        );

        <span class="hljs-comment">// 2. æ„å»ºä¸Šä¸‹æ–‡</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> matches.stream()
            .map(match -&gt; match.embedded().text())
            .collect(Collectors.joining(<span class="hljs-string">"\n\n"</span>));

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> PromptTemplate.from(<span class="hljs-string">"""
            åŸºäºä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š

            {{context}}

            é—®é¢˜ï¼š{{question}}

            è¦æ±‚ï¼š
            1. åªåŸºäºæä¾›çš„ä¿¡æ¯å›ç­”
            2. å¦‚æœä¿¡æ¯ä¸è¶³ï¼Œæ˜ç¡®è¯´æ˜
            3. ç»™å‡ºä¿¡æ¯æ¥æº
            """</span>)
            .apply(Map.of(
                <span class="hljs-string">"context"</span>, context,
                <span class="hljs-string">"question"</span>, question
            ))
            .text();

        <span class="hljs-comment">// 4. ç”Ÿæˆç­”æ¡ˆ</span>
        <span class="hljs-keyword">return</span> chatModel.generate(prompt);
    }
}
</code></pre>
<h4 data-id="heading-40"><strong>5.2.3 æ¡†æ¶å¯¹æ¯”æ€»ç»“</strong></h4>























































<table><thead><tr><th>ç»´åº¦</th><th>Spring AI Alibaba</th><th>LangChain4j</th></tr></thead><tbody><tr><td><strong>å®šä½</strong></td><td>Springç”Ÿæ€é›†æˆï¼Œå›½å†…ä¼˜åŒ–</td><td>åŠŸèƒ½å…¨é¢ï¼Œç¤¾åŒºæ´»è·ƒ</td></tr><tr><td><strong>ä¸Šæ‰‹éš¾åº¦</strong></td><td>ç®€å•ï¼ˆSpringå¼€å‘è€…ï¼‰</td><td>ä¸­ç­‰</td></tr><tr><td><strong>æ–‡æ¡£</strong></td><td>ä¸­æ–‡æ–‡æ¡£å®Œå–„</td><td>è‹±æ–‡ä¸ºä¸»ï¼Œç¤ºä¾‹ä¸°å¯Œ</td></tr><tr><td><strong>æ¨¡å‹æ”¯æŒ</strong></td><td>ä¾§é‡é˜¿é‡Œäº‘ã€OpenAIå…¼å®¹</td><td>20+ä¸»æµæ¨¡å‹</td></tr><tr><td><strong>åŠŸèƒ½ä¸°å¯Œåº¦</strong></td><td>æ ¸å¿ƒåŠŸèƒ½</td><td>éå¸¸å…¨é¢ï¼ˆToolsã€Agentç­‰ï¼‰</td></tr><tr><td><strong>ç”Ÿæ€é›†æˆ</strong></td><td>Spring Bootæ·±åº¦é›†æˆ</td><td>å¤šæ¡†æ¶æ”¯æŒ</td></tr><tr><td><strong>ä¼ä¸šç‰¹æ€§</strong></td><td>å¯è§‚æµ‹æ€§ã€é™æµç­‰</td><td>éœ€è‡ªè¡Œé›†æˆ</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ä½¿ç”¨é˜¿é‡Œäº‘ã€Springé¡¹ç›®</td><td>å¤æ‚AIåº”ç”¨ã€å¤šæ¨¡å‹åˆ‡æ¢</td></tr><tr><td><strong>å¼€æºæ´»è·ƒåº¦</strong></td><td>è¾ƒæ–°ï¼Œå¿«é€Ÿè¿­ä»£</td><td>éå¸¸æ´»è·ƒ</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[é€‰æ‹©æ¡†æ¶] --&gt; B{ä½¿ç”¨é˜¿é‡Œäº‘?}
    B --&gt;|æ˜¯| C[Spring AI Alibaba]
    B --&gt;|å¦| D{éœ€è¦å¤æ‚Agent?}

    D --&gt;|æ˜¯| E[LangChain4j]
    D --&gt;|å¦| F{å›¢é˜Ÿç†Ÿæ‚‰Spring?}

    F --&gt;|æ˜¯| G[Spring AI Alibaba]
    F --&gt;|å¦| E

    C --&gt; H[å¼€å§‹å¼€å‘]
    E --&gt; H
    G --&gt; H

    style H fill:#e1ffe1
</code></pre>
<h3 data-id="heading-41">5.3 AIå·¥ç¨‹åŒ–æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-42"><strong>5.3.1 é¡¹ç›®ç»“æ„è®¾è®¡</strong></h4>
<pre><code class="hljs language-bash" lang="bash">my-ai-application/
â”œâ”€â”€ src/main/java/
â”‚   â”œâ”€â”€ config/                 <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚   â”‚   â”œâ”€â”€ AiConfig.java      <span class="hljs-comment"># AIæ¡†æ¶é…ç½®</span>
â”‚   â”‚   â”œâ”€â”€ VectorStoreConfig.java
â”‚   â”‚   â””â”€â”€ PromptConfig.java
â”‚   â”œâ”€â”€ controller/            <span class="hljs-comment"># æ§åˆ¶å™¨</span>
â”‚   â”‚   â”œâ”€â”€ ChatController.java
â”‚   â”‚   â””â”€â”€ RagController.java
â”‚   â”œâ”€â”€ service/               <span class="hljs-comment"># ä¸šåŠ¡æœåŠ¡</span>
â”‚   â”‚   â”œâ”€â”€ ChatService.java
â”‚   â”‚   â”œâ”€â”€ RagService.java
â”‚   â”‚   â””â”€â”€ AgentService.java
â”‚   â”œâ”€â”€ ai/                    <span class="hljs-comment"># AIæ ¸å¿ƒ</span>
â”‚   â”‚   â”œâ”€â”€ prompt/           <span class="hljs-comment"># Promptç®¡ç†</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ PromptTemplate.java
â”‚   â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚   â”‚       â”œâ”€â”€ chat.txt
â”‚   â”‚   â”‚       â””â”€â”€ rag.txt
â”‚   â”‚   â”œâ”€â”€ tools/            <span class="hljs-comment"># AIå·¥å…·</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ DatabaseTool.java
â”‚   â”‚   â”‚   â””â”€â”€ ApiTool.java
â”‚   â”‚   â”œâ”€â”€ chain/            <span class="hljs-comment"># æ‰§è¡Œé“¾</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ RagChain.java
â”‚   â”‚   â”‚   â””â”€â”€ AgentChain.java
â”‚   â”‚   â””â”€â”€ memory/           <span class="hljs-comment"># è®°å¿†ç®¡ç†</span>
â”‚   â”‚       â””â”€â”€ ConversationMemory.java
â”‚   â”œâ”€â”€ domain/               <span class="hljs-comment"># é¢†åŸŸæ¨¡å‹</span>
â”‚   â”œâ”€â”€ repository/           <span class="hljs-comment"># æ•°æ®è®¿é—®</span>
â”‚   â””â”€â”€ utils/                <span class="hljs-comment"># å·¥å…·ç±»</span>
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ prompts/              <span class="hljs-comment"># Promptæ¨¡æ¿</span>
â”‚   â”‚   â”œâ”€â”€ system.txt
â”‚   â”‚   â”œâ”€â”€ user.txt
â”‚   â”‚   â””â”€â”€ rag.txt
â”‚   â”œâ”€â”€ documents/            <span class="hljs-comment"># çŸ¥è¯†åº“æ–‡æ¡£</span>
â”‚   â””â”€â”€ application.yml
â””â”€â”€ src/test/
</code></pre>
<h4 data-id="heading-43"><strong>5.3.2 Promptç®¡ç†</strong></h4>
<p><strong>1. æ¨¡æ¿åŒ–ç®¡ç†</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptTemplateManager</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, String&gt; templates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadTemplates</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä»æ–‡ä»¶åŠ è½½</span>
        templates.put(<span class="hljs-string">"chat"</span>, loadFromFile(<span class="hljs-string">"prompts/chat.txt"</span>));
        templates.put(<span class="hljs-string">"rag"</span>, loadFromFile(<span class="hljs-string">"prompts/rag.txt"</span>));
        templates.put(<span class="hljs-string">"code_review"</span>, loadFromFile(<span class="hljs-string">"prompts/code_review.txt"</span>));
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPrompt</span><span class="hljs-params">(String templateName, Map&lt;String, String&gt; variables)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">template</span> <span class="hljs-operator">=</span> templates.get(templateName);
        <span class="hljs-keyword">return</span> replaceVariables(template, variables);
    }
}
</code></pre>
<p><strong>2. Promptç‰ˆæœ¬æ§åˆ¶</strong></p>
<pre><code class="hljs language-rust" lang="rust">prompts/
â”œâ”€â”€ v1/
â”‚   â”œâ”€â”€ chat.txt
â”‚   â””â”€â”€ rag.txt
â”œâ”€â”€ v2/
â”‚   â”œâ”€â”€ chat.txt
â”‚   â””â”€â”€ rag.txt
â””â”€â”€ current <span class="hljs-punctuation">-&gt;</span> v2/
</code></pre>
<p><strong>3. A/Bæµ‹è¯•æ¡†æ¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptExperimentService</span> {

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithExperiment</span><span class="hljs-params">(String message, String userId)</span> {
        <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·åˆ†ç»„é€‰æ‹©ä¸åŒPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">promptVersion</span> <span class="hljs-operator">=</span> getUserGroup(userId);
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> promptManager.getPrompt(promptVersion, Map.of(<span class="hljs-string">"message"</span>, message));

        <span class="hljs-comment">// è®°å½•å®éªŒæ•°æ®</span>
        experimentTracker.track(userId, promptVersion, message);

        <span class="hljs-keyword">return</span> chatClient.call(prompt);
    }
}
</code></pre>
<h4 data-id="heading-44"><strong>5.3.3 æ¨¡å‹ç®¡ç†</strong></h4>
<p><strong>1. å¤šæ¨¡å‹ç­–ç•¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelRouter</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient gpt4Client;     <span class="hljs-comment">// å¤æ‚ä»»åŠ¡</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient gpt35Client;    <span class="hljs-comment">// ç®€å•ä»»åŠ¡</span>

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient qwenClient;     <span class="hljs-comment">// å¤‡ç”¨æ¨¡å‹</span>

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// æ ¹æ®å¤æ‚åº¦è·¯ç”±</span>
        <span class="hljs-keyword">if</span> (isComplexQuery(message)) {
            <span class="hljs-keyword">return</span> gpt4Client.call(message);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> gpt35Client.call(message);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isComplexQuery</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// ç®€å•åˆ¤æ–­é€»è¾‘</span>
        <span class="hljs-keyword">return</span> message.length() &gt; <span class="hljs-number">200</span> ||
               message.contains(<span class="hljs-string">"åˆ†æ"</span>) ||
               message.contains(<span class="hljs-string">"è®¾è®¡"</span>);
    }
}
</code></pre>
<p><strong>2. é™çº§ç­–ç•¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FallbackService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ModelRouter modelRouter;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> CacheManager cacheManager;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chatWithFallback</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä¸»æ¨¡å‹</span>
            <span class="hljs-keyword">return</span> modelRouter.chat(message);
        } <span class="hljs-keyword">catch</span> (RateLimitException e) {
            <span class="hljs-comment">// é™çº§åˆ°å¤‡ç”¨æ¨¡å‹</span>
            log.warn(<span class="hljs-string">"ä¸»æ¨¡å‹é™æµï¼Œåˆ‡æ¢å¤‡ç”¨æ¨¡å‹"</span>);
            <span class="hljs-keyword">return</span> qwenClient.call(message);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è¿”å›ç¼“å­˜ç»“æœ</span>
            <span class="hljs-keyword">return</span> cacheManager.getCachedResponse(message)
                .orElse(<span class="hljs-string">"æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•"</span>);
        }
    }
}
</code></pre>
<h4 data-id="heading-45"><strong>5.3.4 ç›‘æ§ä¸å¯è§‚æµ‹</strong></h4>
<p><strong>1. æŒ‡æ ‡ç›‘æ§</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiMetricsAspect</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> MeterRegistry meterRegistry;

    <span class="hljs-meta">@Around("@annotation(AiMonitored)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">monitor</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable {
        Timer.<span class="hljs-type">Sample</span> <span class="hljs-variable">sample</span> <span class="hljs-operator">=</span> Timer.start(meterRegistry);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> pjp.proceed();

            <span class="hljs-comment">// è®°å½•æˆåŠŸ</span>
            sample.stop(Timer.builder(<span class="hljs-string">"ai.call"</span>)
                .tag(<span class="hljs-string">"method"</span>, pjp.getSignature().getName())
                .tag(<span class="hljs-string">"status"</span>, <span class="hljs-string">"success"</span>)
                .register(meterRegistry));

            <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è®°å½•å¤±è´¥</span>
            sample.stop(Timer.builder(<span class="hljs-string">"ai.call"</span>)
                .tag(<span class="hljs-string">"method"</span>, pjp.getSignature().getName())
                .tag(<span class="hljs-string">"status"</span>, <span class="hljs-string">"error"</span>)
                .tag(<span class="hljs-string">"error"</span>, e.getClass().getSimpleName())
                .register(meterRegistry));
            <span class="hljs-keyword">throw</span> e;
        }
    }
}
</code></pre>
<p><strong>2. æ—¥å¿—è®°å½•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiLogger</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> AiLogRepository logRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInteraction</span><span class="hljs-params">(String sessionId, String input, String output,
                               <span class="hljs-type">long</span> latency, <span class="hljs-type">int</span> tokens)</span> {
        <span class="hljs-type">AiLog</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> AiLog.builder()
            .sessionId(sessionId)
            .input(input)
            .output(output)
            .latency(latency)
            .tokens(tokens)
            .cost(calculateCost(tokens))
            .timestamp(LocalDateTime.now())
            .build();

        logRepository.save(log);
    }

    <span class="hljs-keyword">private</span> BigDecimal <span class="hljs-title function_">calculateCost</span><span class="hljs-params">(<span class="hljs-type">int</span> tokens)</span> {
        <span class="hljs-comment">// æ ¹æ®Tokenæ•°è®¡ç®—æˆæœ¬</span>
        <span class="hljs-keyword">return</span> BigDecimal.valueOf(tokens)
            .multiply(BigDecimal.valueOf(<span class="hljs-number">0.00001</span>));
    }
}
</code></pre>
<p><strong>3. é“¾è·¯è¿½è¸ª</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TracedChatService</span> {

    <span class="hljs-meta">@NewSpan("ai.chat")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">chat</span><span class="hljs-params">(<span class="hljs-meta">@SpanTag("session.id")</span> String sessionId,
                       <span class="hljs-meta">@SpanTag("input")</span> String message)</span> {

        <span class="hljs-type">Span</span> <span class="hljs-variable">currentSpan</span> <span class="hljs-operator">=</span> tracer.currentSpan();

        <span class="hljs-comment">// æ£€ç´¢é˜¶æ®µ</span>
        currentSpan.tag(<span class="hljs-string">"stage"</span>, <span class="hljs-string">"retrieve"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> ragService.retrieve(message);
        currentSpan.tag(<span class="hljs-string">"retrieved.docs"</span>, String.valueOf(context.split(<span class="hljs-string">"\n"</span>).length));

        <span class="hljs-comment">// ç”Ÿæˆé˜¶æ®µ</span>
        currentSpan.tag(<span class="hljs-string">"stage"</span>, <span class="hljs-string">"generate"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(buildPrompt(message, context));
        currentSpan.tag(<span class="hljs-string">"response.length"</span>, String.valueOf(response.length()));

        <span class="hljs-keyword">return</span> response;
    }
}
</code></pre>
<h4 data-id="heading-46"><strong>5.3.5 æµ‹è¯•ç­–ç•¥</strong></h4>
<p><strong>1. å•å…ƒæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatServiceTest</span> {

    <span class="hljs-meta">@MockBean</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatService chatService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testChat</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Mock</span>
        when(chatClient.call(anyString()))
            .thenReturn(<span class="hljs-string">"è¿™æ˜¯æµ‹è¯•å›å¤"</span>);

        <span class="hljs-comment">// æ‰§è¡Œ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatService.chat(<span class="hljs-string">"æµ‹è¯•é—®é¢˜"</span>);

        <span class="hljs-comment">// éªŒè¯</span>
        assertThat(response).isEqualTo(<span class="hljs-string">"è¿™æ˜¯æµ‹è¯•å›å¤"</span>);
        verify(chatClient).call(anyString());
    }
}
</code></pre>
<p><strong>2. Promptæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testPromptQuality</span><span class="hljs-params">()</span> {
    List&lt;TestCase&gt; testCases = loadTestCases();

    <span class="hljs-keyword">for</span> (TestCase testCase : testCases) {
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatService.chat(testCase.getInput());

        <span class="hljs-comment">// è¯„ä¼°å›å¤è´¨é‡</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> evaluateResponse(response, testCase.getExpectedKeywords());

        assertThat(score).isGreaterThan(<span class="hljs-number">0.8</span>);
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-type">double</span> <span class="hljs-title function_">evaluateResponse</span><span class="hljs-params">(String response, List&lt;String&gt; keywords)</span> {
    <span class="hljs-type">long</span> <span class="hljs-variable">matchCount</span> <span class="hljs-operator">=</span> keywords.stream()
        .filter(response::contains)
        .count();
    <span class="hljs-keyword">return</span> (<span class="hljs-type">double</span>) matchCount / keywords.size();
}
</code></pre>
<p><strong>3. é›†æˆæµ‹è¯•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatControllerIntegrationTest</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> TestRestTemplate restTemplate;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testChatEndpoint</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ChatRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatRequest</span>();
        request.setMessage(<span class="hljs-string">"æµ‹è¯•é—®é¢˜"</span>);
        request.setSessionId(<span class="hljs-string">"test-session"</span>);

        ResponseEntity&lt;ChatResponse&gt; response = restTemplate.postForEntity(
            <span class="hljs-string">"/ai/chat"</span>,
            request,
            ChatResponse.class
        );

        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody().getAnswer()).isNotEmpty();
    }
}
</code></pre>
<h3 data-id="heading-47">5.4 å…¸å‹åº”ç”¨åœºæ™¯å®æˆ˜</h3>
<h4 data-id="heading-48"><strong>5.4.1 åœºæ™¯ä¸€ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ</strong></h4>
<p><strong>æ¶æ„è®¾è®¡ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    U[ç”¨æˆ·] --&gt; W[Web/App]
    W --&gt; G[API Gateway]
    G --&gt; CS[å®¢æœService]

    CS --&gt; IT[æ„å›¾è¯†åˆ«]
    CS --&gt; RAG[çŸ¥è¯†åº“æ£€ç´¢]
    CS --&gt; WF[å·¥å•æµè½¬]

    IT --&gt; LLM[å¤§æ¨¡å‹]
    RAG --&gt; VS[(å‘é‡æ•°æ®åº“)]
    WF --&gt; DB[(MySQL)]

    CS --&gt; Cache[(Redisç¼“å­˜)]
    CS --&gt; MQ[æ¶ˆæ¯é˜Ÿåˆ—]

    style CS fill:#e1f5ff
</code></pre>
<p><strong>æ ¸å¿ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerServiceAI</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> KnowledgeBaseService knowledgeBase;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> IntentClassifier intentClassifier;

    <span class="hljs-keyword">public</span> CustomerServiceResponse <span class="hljs-title function_">handle</span><span class="hljs-params">(String userMessage, String sessionId)</span> {
        <span class="hljs-comment">// 1. æ„å›¾è¯†åˆ«</span>
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> intentClassifier.classify(userMessage);

        <span class="hljs-comment">// 2. æ ¹æ®æ„å›¾è·¯ç”±</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (intent) {
            <span class="hljs-keyword">case</span> FAQ -&gt; handleFAQ(userMessage);
            <span class="hljs-keyword">case</span> COMPLAINT -&gt; handleComplaint(userMessage, sessionId);
            <span class="hljs-keyword">case</span> ORDER_QUERY -&gt; handleOrderQuery(userMessage);
            <span class="hljs-keyword">default</span> -&gt; handleGeneral(userMessage);
        };
    }

    <span class="hljs-keyword">private</span> CustomerServiceResponse <span class="hljs-title function_">handleFAQ</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// RAGæ£€ç´¢çŸ¥è¯†åº“</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> knowledgeBase.search(question);

        <span class="hljs-keyword">if</span> (answer != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> CustomerServiceResponse.builder()
                .answer(answer)
                .source(<span class="hljs-string">"knowledge_base"</span>)
                .confidence(<span class="hljs-number">0.9</span>)
                .build();
        }

        <span class="hljs-comment">// é™çº§åˆ°å¤§æ¨¡å‹</span>
        <span class="hljs-keyword">return</span> handleGeneral(question);
    }

    <span class="hljs-keyword">private</span> CustomerServiceResponse <span class="hljs-title function_">handleComplaint</span><span class="hljs-params">(String message, String sessionId)</span> {
        <span class="hljs-comment">// åˆ›å»ºå·¥å•</span>
        <span class="hljs-type">Ticket</span> <span class="hljs-variable">ticket</span> <span class="hljs-operator">=</span> ticketService.create(message, sessionId);

        <span class="hljs-comment">// AIç”Ÿæˆå®‰æŠšè¯æœ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatClient.call(
            <span class="hljs-string">"ç”¨æˆ·æŠ•è¯‰ï¼š"</span> + message + <span class="hljs-string">"\nè¯·ç”Ÿæˆä¸“ä¸šçš„å®‰æŠšå›å¤"</span>
        );

        <span class="hljs-keyword">return</span> CustomerServiceResponse.builder()
            .answer(response)
            .ticketId(ticket.getId())
            .needHumanIntervention(<span class="hljs-literal">true</span>)
            .build();
    }
}
</code></pre>
<h4 data-id="heading-49"><strong>5.4.2 åœºæ™¯äºŒï¼šä»£ç åŠ©æ‰‹</strong></h4>
<p><strong>åŠŸèƒ½æ¨¡å—ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
  root((ä»£ç åŠ©æ‰‹))
    ä»£ç ç”Ÿæˆ
      æ ¹æ®éœ€æ±‚ç”Ÿæˆä»£ç 
      å•å…ƒæµ‹è¯•ç”Ÿæˆ
      æ–‡æ¡£ç”Ÿæˆ
    ä»£ç å®¡æŸ¥
      å®‰å…¨æ¼æ´æ£€æµ‹
      æ€§èƒ½é—®é¢˜åˆ†æ
      ä»£ç è§„èŒƒæ£€æŸ¥
    ä»£ç è§£é‡Š
      é€è¡Œè§£é‡Š
      æ¶æ„åˆ†æ
      ä¾èµ–å…³ç³»
    é‡æ„å»ºè®®
      è®¾è®¡æ¨¡å¼åº”ç”¨
      ä»£ç ç®€åŒ–
      æ€§èƒ½ä¼˜åŒ–
</code></pre>
<p><strong>å®ç°ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CodeAssistant</span> {

    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Assistant</span> {
        <span class="hljs-meta">@SystemMessage("""
            ä½ æ˜¯ä¸€ä½èµ„æ·±Javaæ¶æ„å¸ˆï¼Œæ“…é•¿ï¼š
            1. ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–å»ºè®®
            2. è®¾è®¡æ¨¡å¼åº”ç”¨
            3. æ€§èƒ½ä¼˜åŒ–
            4. å®‰å…¨æ¼æ´æ£€æµ‹
            """)</span>
        String <span class="hljs-title function_">reviewCode</span><span class="hljs-params">(<span class="hljs-meta">@UserMessage</span> String code)</span>;

        <span class="hljs-meta">@UserMessage("""
            è¯·ä¸ºä»¥ä¸‹æ–¹æ³•ç”Ÿæˆå•å…ƒæµ‹è¯•ï¼š
            ```java
            {{code}}
            ```
            è¦æ±‚ï¼š
            - ä½¿ç”¨JUnit 5å’ŒMockito
            - è¦†ç›–æ­£å¸¸å’Œå¼‚å¸¸æƒ…å†µ
            - åŒ…å«è¾¹ç•Œæ¡ä»¶æµ‹è¯•
            """)</span>
        String <span class="hljs-title function_">generateTest</span><span class="hljs-params">(<span class="hljs-meta">@V("code")</span> String code)</span>;
    }

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> Assistant assistant;

    <span class="hljs-keyword">public</span> CodeReviewResult <span class="hljs-title function_">review</span><span class="hljs-params">(String code)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">review</span> <span class="hljs-operator">=</span> assistant.reviewCode(code);
        <span class="hljs-keyword">return</span> parseReviewResult(review);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generateUnitTest</span><span class="hljs-params">(String methodCode)</span> {
        <span class="hljs-keyword">return</span> assistant.generateTest(methodCode);
    }
}
</code></pre>
<h4 data-id="heading-50"><strong>5.4.3 åœºæ™¯ä¸‰ï¼šæ–‡æ¡£é—®ç­”ç³»ç»Ÿ</strong></h4>
<p><strong>ç³»ç»Ÿæ¶æ„ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph &amp;#34;æ•°æ®å‡†å¤‡&amp;#34;
        D[æ–‡æ¡£ä¸Šä¼ ] --&gt; P[è§£æ]
        P --&gt; S[åˆ†å—]
        S --&gt; E[Embedding]
        E --&gt; V[(å‘é‡åº“)]
    end

    subgraph &amp;#34;æŸ¥è¯¢æµç¨‹&amp;#34;
        Q[ç”¨æˆ·æé—®] --&gt; QE[Query Embedding]
        QE --&gt; R[æ£€ç´¢]
        V --&gt; R
        R --&gt; F[è¿‡æ»¤é‡æ’]
        F --&gt; G[ç”Ÿæˆç­”æ¡ˆ]
        G --&gt; A[è¿”å›]
    end

    style V fill:#e1f5ff
    style G fill:#ffe1e1
</code></pre>
<p><strong>å®Œæ•´å®ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentQAService</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> EmbeddingModel embeddingModel;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> VectorStore vectorStore;

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-comment">/**
     * æ–‡æ¡£å¯¼å…¥
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">importDocuments</span><span class="hljs-params">(List&lt;MultipartFile&gt; files)</span> {
        files.forEach(file -&gt; {
            <span class="hljs-comment">// 1. è§£ææ–‡æ¡£</span>
            <span class="hljs-type">Document</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> parseDocument(file);

            <span class="hljs-comment">// 2. æ–‡æ¡£åˆ†å—</span>
            List&lt;TextSegment&gt; segments = splitDocument(doc);

            <span class="hljs-comment">// 3. å‘é‡åŒ–</span>
            List&lt;Embedding&gt; embeddings = embeddingModel.embedAll(segments).content();

            <span class="hljs-comment">// 4. å­˜å‚¨</span>
            vectorStore.addAll(embeddings, segments);
        });
    }

    <span class="hljs-comment">/**
     * é—®ç­”
     */</span>
    <span class="hljs-keyword">public</span> QAResponse <span class="hljs-title function_">query</span><span class="hljs-params">(String question)</span> {
        <span class="hljs-comment">// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£</span>
        List&lt;Document&gt; relevantDocs = retrieveRelevantDocs(question, <span class="hljs-number">5</span>);

        <span class="hljs-comment">// 2. é‡æ’åº</span>
        List&lt;Document&gt; rerankedDocs = rerank(question, relevantDocs);

        <span class="hljs-comment">// 3. æ„å»ºPrompt</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> buildQAPrompt(question, rerankedDocs);

        <span class="hljs-comment">// 4. ç”Ÿæˆç­”æ¡ˆ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatClient.call(prompt);

        <span class="hljs-comment">// 5. æå–å¼•ç”¨</span>
        List&lt;Citation&gt; citations = extractCitations(rerankedDocs);

        <span class="hljs-keyword">return</span> QAResponse.builder()
            .answer(answer)
            .citations(citations)
            .confidence(calculateConfidence(rerankedDocs))
            .build();
    }

    <span class="hljs-keyword">private</span> List&lt;Document&gt; <span class="hljs-title function_">retrieveRelevantDocs</span><span class="hljs-params">(String query, <span class="hljs-type">int</span> topK)</span> {
        <span class="hljs-type">Embedding</span> <span class="hljs-variable">queryEmbedding</span> <span class="hljs-operator">=</span> embeddingModel.embed(query).content();

        <span class="hljs-keyword">return</span> vectorStore.findRelevant(queryEmbedding, topK, <span class="hljs-number">0.7</span>)
            .stream()
            .map(EmbeddingMatch::embedded)
            .map(segment -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(segment.text()))
            .collect(Collectors.toList());
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">buildQAPrompt</span><span class="hljs-params">(String question, List&lt;Document&gt; docs)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> docs.stream()
            .map(Document::text)
            .collect(Collectors.joining(<span class="hljs-string">"\n\n---\n\n"</span>));

        <span class="hljs-keyword">return</span> <span class="hljs-string">"""
            # ä»»åŠ¡
            åŸºäºä»¥ä¸‹æ–‡æ¡£å†…å®¹å›ç­”ç”¨æˆ·é—®é¢˜ã€‚

            # æ–‡æ¡£å†…å®¹
            %s

            # ç”¨æˆ·é—®é¢˜
            %s

            # è¦æ±‚
            1. ä»…åŸºäºæä¾›çš„æ–‡æ¡£å†…å®¹å›ç­”
            2. å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œæ˜ç¡®è¯´æ˜
            3. ç»™å‡ºå…·ä½“çš„æ–‡æ¡£å¼•ç”¨
            4. å›ç­”è¦å‡†ç¡®ã€ç®€æ´
            """</span>.formatted(context, question);
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—]]></title>    <link>https://juejin.cn/post/7585706951603650586</link>    <guid>https://juejin.cn/post/7585706951603650586</guid>    <pubDate>2025-12-21T02:39:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585706951603650586" data-draft-id="7585463195202404402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—"/> <meta itemprop="keywords" content="PostgreSQL,Docker"/> <meta itemprop="datePublished" content="2025-12-21T02:39:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€èµµ"/> <meta itemprop="url" content="https://juejin.cn/user/3208848015890347"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Supabase Postgres Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3208848015890347/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€èµµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T02:39:19.000Z" title="Sun Dec 21 2025 02:39:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>Supabase Postgres æ˜¯ä¸€æ¬¾åŸºäºPostgreSQLå®˜æ–¹é•œåƒæ„å»ºçš„å®¹å™¨åŒ–åº”ç”¨ï¼Œé›†æˆäº†å¤šç§å®ç”¨æ’ä»¶ï¼Œæ—¨åœ¨ä¸ºå¼€å‘è€…æä¾›ä¾¿æ·ã€å¯é çš„æ•°æ®åº“æœåŠ¡ã€‚è¯¥é•œåƒä¿æŒäº†PostgreSQLçš„åŸç”ŸåŠŸèƒ½ç‰¹æ€§ï¼ŒåŒæ—¶é¢„è£…äº†PostGISã€pg_cronã€pgAuditç­‰å¸¸ç”¨æ‰©å±•ï¼Œæ»¡è¶³åœ°ç†ä¿¡æ¯å¤„ç†ã€å®šæ—¶ä»»åŠ¡ã€å®¡è®¡æ—¥å¿—ç­‰å¤šæ ·åŒ–éœ€æ±‚ã€‚</p>
<p>æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡Dockerå®¹å™¨åŒ–æ–¹å¼éƒ¨ç½²Supabase Postgresï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€å®¹å™¨é…ç½®ã€åŠŸèƒ½æµ‹è¯•åŠç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ­å»ºç¨³å®šçš„Supabase Postgresæ•°æ®åº“æœåŠ¡ã€‚æ¨èä½¿ç”¨æ ‡ç­¾<code>17.6.0.023-orioledb</code>è¿›è¡Œéƒ¨ç½²ï¼Œæ›´å¤šç‰ˆæœ¬ä¿¡æ¯å¯å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fxuanyuan.cloud%2Fr%2Fsupabase%2Fpostgres%2Ftags" title="https://xuanyuan.cloud/r/supabase/postgres/tags" target="_blank" ref="nofollow noopener noreferrer">Postgres é•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰</a>ã€‚</p>
<h2 data-id="heading-1">ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">Dockerç¯å¢ƒå®‰è£…</h3>
<p>éƒ¨ç½²Supabase Postgreså®¹å™¨å‰ï¼Œéœ€å…ˆç¡®ä¿æœåŠ¡å™¨å·²å®‰è£…Dockerç¯å¢ƒã€‚æ¨èä½¿ç”¨ä»¥ä¸‹ä¸€é”®å®‰è£…è„šæœ¬ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">bash</span> &lt;(wget -qO- <span class="hljs-attribute">https</span>:<span class="hljs-comment">//xuanyuan.cloud/docker.sh)</span>
</code></pre>
<p>è„šæœ¬æ‰§è¡Œå®Œæˆåï¼Œå¯é€šè¿‡<code>docker --version</code>å‘½ä»¤éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼Œå‡ºç°ç±»ä¼¼<code>Docker version 20.10.xx, build xxxxxxx</code>çš„è¾“å‡ºå³è¡¨ç¤ºDockerç¯å¢ƒå°±ç»ªã€‚</p>
<p>è½©è¾•é•œåƒè®¿é—®æ”¯æŒå¯æ”¹å–„é•œåƒè®¿é—®ä½“éªŒï¼›é•œåƒæ¥æºäºå®˜æ–¹å…¬å…±ä»“åº“ï¼Œå¹³å°ä¸å­˜å‚¨ä¸ä¿®æ”¹é•œåƒå†…å®¹ã€‚</p>
<h2 data-id="heading-3">é•œåƒå‡†å¤‡</h2>
<h3 data-id="heading-4">æ‹‰å–Supabase Postgresé•œåƒ</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€šè¿‡è½©è¾•é•œåƒè®¿é—®æ”¯æŒåŸŸåæ‹‰å–æ¨èç‰ˆæœ¬çš„POSTGRESé•œåƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">docker pull xxx.xuanyuan.run/supabase/postgres:<span class="hljs-number">17.6</span><span class="hljs-number">.0</span><span class="hljs-number">.023</span>-orioledb
</code></pre>
<p>æ‹‰å–å®Œæˆåï¼Œå¯é€šè¿‡<code>docker images | grep supabase/postgres</code>å‘½ä»¤éªŒè¯é•œåƒæ˜¯å¦æˆåŠŸè·å–ï¼Œè¾“å‡ºåº”åŒ…å«<code>xxx.xuanyuan.run/supabase/postgres</code>åŠå¯¹åº”æ ‡ç­¾ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-5">å®¹å™¨éƒ¨ç½²</h2>
<h3 data-id="heading-6">åŸºç¡€éƒ¨ç½²å‘½ä»¤</h3>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨Supabase Postgreså®¹å™¨ï¼ŒåŒ…å«åŸºç¡€çš„ç«¯å£æ˜ å°„ã€æ•°æ®æŒä¹…åŒ–åŠç¯å¢ƒå˜é‡é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \  --name postgres-container \  -p 5432:5432 \  -v postgres-data:/var/lib/postgresql/data \  -e POSTGRES_PASSWORD=your_secure_password \  --<span class="hljs-built_in">command</span> <span class="hljs-string">"postgres -c config_file=/etc/postgresql/postgresql.conf"</span> \  xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb
</code></pre>
<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li>â€¢ <code>-d</code>ï¼šåå°è¿è¡Œå®¹å™¨</li>
<li>â€¢ <code>--name postgres-container</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ä¸º<code>postgres-container</code>ï¼Œä¾¿äºåç»­ç®¡ç†</li>
<li>â€¢ <code>-p 5432:5432</code>ï¼šå°†å®¹å™¨å†…5432ç«¯å£æ˜ å°„åˆ°ä¸»æœº5432ç«¯å£ï¼ˆPostgreSQLé»˜è®¤ç«¯å£ï¼‰</li>
<li>â€¢ <code>-v postgres-data:/var/lib/postgresql/data</code>ï¼šä½¿ç”¨å‘½åå·<code>postgres-data</code>æŒä¹…åŒ–æ•°æ®åº“æ•°æ®ï¼Œé¿å…å®¹å™¨åˆ é™¤å¯¼è‡´æ•°æ®ä¸¢å¤±</li>
<li>â€¢ <code>-e POSTGRES_PASSWORD=your_secure_password</code>ï¼šè®¾ç½®æ•°æ®åº“è¶…çº§ç”¨æˆ·å¯†ç ï¼Œå»ºè®®ä½¿ç”¨å¼ºå¯†ç å¹¶å¦¥å–„ä¿ç®¡</li>
<li>â€¢ <code>--command</code>ï¼šæŒ‡å®šå¯åŠ¨å‘½ä»¤ï¼ŒåŠ è½½è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼ˆé€‚ç”¨äº14.1.0åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰</li>
</ul>
<h3 data-id="heading-7">è‡ªå®šä¹‰é…ç½®éƒ¨ç½²</h3>
<p>å¦‚éœ€è°ƒæ•´æ•°æ®åº“é…ç½®ï¼ˆå¦‚å†…å­˜åˆ†é…ã€è¿æ¥æ•°é™åˆ¶ç­‰ï¼‰ï¼Œå¯é€šè¿‡æŒ‚è½½æœ¬åœ°é…ç½®æ–‡ä»¶å®ç°ï¼š</p>
<ol>
<li>
<p>1. ä»å®¹å™¨ä¸­å¤åˆ¶é»˜è®¤é…ç½®æ–‡ä»¶åˆ°æœ¬åœ°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">cp</span> postgres-container:/etc/postgresql/postgresql.conf ./postgresql.conf
</code></pre>
</li>
<li>
<p>2. ç¼–è¾‘æœ¬åœ°<code>postgresql.conf</code>æ–‡ä»¶ï¼Œæ ¹æ®éœ€æ±‚è°ƒæ•´å‚æ•°ï¼ˆå¦‚<code>max_connections</code>ã€<code>shared_buffers</code>ç­‰ï¼‰</p>
</li>
<li>
<p>3. ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¯åŠ¨å®¹å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d \  --name postgres-container \  -p 5432:5432 \  -v $(<span class="hljs-built_in">pwd</span>)/postgresql.conf:/etc/postgresql/postgresql.conf \  -v postgres-data:/var/lib/postgresql/data \  -e POSTGRES_PASSWORD=your_secure_password \  xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb
</code></pre>
</li>
</ol>
<h2 data-id="heading-8">åŠŸèƒ½æµ‹è¯•</h2>
<h3 data-id="heading-9">å®¹å™¨çŠ¶æ€æ£€æŸ¥</h3>
<p>éƒ¨ç½²å®Œæˆåï¼Œé¦–å…ˆæ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-python" lang="python">docker ps --<span class="hljs-built_in">filter</span> <span class="hljs-string">"name=postgres-container"</span>
</code></pre>
<p>è‹¥è¾“å‡ºä¸­<code>STATUS</code>å­—æ®µæ˜¾ç¤ºä¸º<code>Up</code>ï¼Œè¡¨ç¤ºå®¹å™¨æ­£å¸¸è¿è¡Œã€‚</p>
<h3 data-id="heading-10">æ—¥å¿—éªŒè¯</h3>
<p>é€šè¿‡æŸ¥çœ‹å®¹å™¨æ—¥å¿—ç¡®è®¤æœåŠ¡å¯åŠ¨çŠ¶æ€åŠæ˜¯å¦å­˜åœ¨å¼‚å¸¸ï¼š</p>
<pre><code class="hljs">docker logs postgres-container
</code></pre>
<p>æ­£å¸¸å¯åŠ¨æ—¶ï¼Œæ—¥å¿—æœ«å°¾åº”åŒ…å«ç±»ä¼¼<code>database system is ready to accept connections</code>çš„æç¤ºä¿¡æ¯ã€‚</p>
<h3 data-id="heading-11">æ•°æ®åº“è¿æ¥æµ‹è¯•</h3>
<p>ä½¿ç”¨<code>psql</code>å®¢æˆ·ç«¯è¿æ¥æ•°æ®åº“ï¼ˆéœ€å…ˆå®‰è£…PostgreSQLå®¢æˆ·ç«¯å·¥å…·ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css">psql -h localhost -<span class="hljs-selector-tag">p</span> <span class="hljs-number">5432</span> -U postgres
</code></pre>
<p>è¾“å…¥éƒ¨ç½²æ—¶è®¾ç½®çš„å¯†ç <code>your_secure_password</code>ï¼ŒæˆåŠŸç™»å½•åè¿›å…¥PostgreSQLå‘½ä»¤è¡Œç•Œé¢ï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ•°æ®åº“ç‰ˆæœ¬åŠæ‰©å±•ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">-- æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬<span class="hljs-keyword">SELECT</span> version();-- éªŒè¯é¢„è£…æ‰©å±•ï¼ˆä»¥pg_stat_statementsä¸ºä¾‹ï¼‰<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> pg_extension <span class="hljs-keyword">WHERE</span> extname = <span class="hljs-comment">'pg_stat_statements';</span>
</code></pre>
<p>è‹¥ç‰ˆæœ¬ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®ä¸”æ‰©å±•è®°å½•å­˜åœ¨ï¼Œè¡¨æ˜æ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œã€‚</p>
<h2 data-id="heading-12">ç”Ÿäº§ç¯å¢ƒå»ºè®®</h2>
<h3 data-id="heading-13">æ•°æ®å®‰å…¨ä¸æŒä¹…åŒ–</h3>
<ul>
<li>
<p>â€¢ <strong>ä½¿ç”¨å¤–éƒ¨å­˜å‚¨å·</strong>ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ç»‘å®šæŒ‚è½½ï¼ˆ<code>-v /host/path:/container/path</code>ï¼‰è€Œéå‘½åå·ï¼Œä¾¿äºæ•°æ®å¤‡ä»½å’Œè¿ç§»ï¼Œç¡®ä¿æ•°æ®è·¯å¾„æƒé™è®¾ç½®æ­£ç¡®ï¼ˆå»ºè®®PostgreSQLç”¨æˆ·IDä¸º999ï¼‰</p>
</li>
<li>
<p>â€¢ <strong>å®šæœŸå¤‡ä»½</strong>ï¼šé€šè¿‡<code>pg_dump</code>å·¥å…·æˆ–<code>docker exec</code>æ‰§è¡Œå¤‡ä»½å‘½ä»¤ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">exec</span> postgres-container pg_dump -U postgres -Fc mydatabase &gt; backup_$(<span class="hljs-built_in">date</span> +%Y%m%d).dump
</code></pre>
</li>
<li>
<p>â€¢ <strong>å¯ç”¨SSL</strong>ï¼šé…ç½®<code>ssl = on</code>åŠç›¸å…³è¯ä¹¦å‚æ•°ï¼Œå¼ºåˆ¶å®¢æˆ·ç«¯ä½¿ç”¨SSLè¿æ¥ï¼Œé˜²æ­¢æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è¢«çªƒå¬</p>
</li>
</ul>
<h3 data-id="heading-14">æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>
<p>â€¢ <strong>èµ„æºé™åˆ¶</strong>ï¼šæ ¹æ®æœåŠ¡å™¨é…ç½®å’Œä¸šåŠ¡éœ€æ±‚ï¼Œé€šè¿‡<code>--memory</code>å’Œ<code>--cpus</code>å‚æ•°é™åˆ¶å®¹å™¨èµ„æºä½¿ç”¨ï¼Œé¿å…èµ„æºè€—å°½ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-css" lang="css">docker run -d \  <span class="hljs-attr">--name</span> postgres-container \  <span class="hljs-attr">--memory</span>=<span class="hljs-number">4</span>g \  <span class="hljs-attr">--cpus</span>=<span class="hljs-number">2</span> \  ...ï¼ˆå…¶ä»–å‚æ•°ï¼‰
</code></pre>
</li>
<li>
<p>â€¢ <strong>é…ç½®è°ƒä¼˜</strong>ï¼šæ ¹æ®æœåŠ¡å™¨å†…å­˜è°ƒæ•´<code>shared_buffers</code>ï¼ˆé€šå¸¸è®¾ä¸ºç‰©ç†å†…å­˜çš„25%ï¼‰ã€<code>work_mem</code>ã€<code>maintenance_work_mem</code>ç­‰å‚æ•°ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½</p>
</li>
<li>
<p>â€¢ <strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šé’ˆå¯¹é¢‘ç¹æŸ¥è¯¢çš„å­—æ®µåˆ›å»ºåˆé€‚ç´¢å¼•ï¼Œå®šæœŸä½¿ç”¨<code>EXPLAIN</code>åˆ†ææŸ¥è¯¢è®¡åˆ’</p>
</li>
</ul>
<h3 data-id="heading-15">é«˜å¯ç”¨é…ç½®</h3>
<ul>
<li>
<p>â€¢ <strong>ä¸»ä»å¤åˆ¶</strong>ï¼šéƒ¨ç½²å¤šèŠ‚ç‚¹ä¸»ä»æ¶æ„ï¼Œé€šè¿‡PostgreSQLæµå¤åˆ¶å®ç°æ•°æ®åŒæ­¥ï¼Œæé«˜æœåŠ¡å¯ç”¨æ€§</p>
</li>
<li>
<p>â€¢ <strong>å®¹å™¨ç¼–æ’</strong>ï¼šä½¿ç”¨Kubernetesæˆ–Docker Composeç®¡ç†å¤šå®¹å™¨åº”ç”¨ï¼Œé…ç½®å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯ç­–ç•¥ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">docker-compose.ymlç¤ºä¾‹ç‰‡æ®µservices:  postgres:    image: xxx.xuanyuan.run/supabase/postgres:17.6.0.023-orioledb    restart: always    healthcheck:      <span class="hljs-built_in">test</span>: [<span class="hljs-string">"CMD-SHELL"</span>, <span class="hljs-string">"pg_isready -U postgres"</span>]      interval: 10s      <span class="hljs-built_in">timeout</span>: 5s      retries: 5</span>
</code></pre>
</li>
</ul>
<h2 data-id="heading-16">æ•…éšœæ’æŸ¥</h2>
<h3 data-id="heading-17">å®¹å™¨æ— æ³•å¯åŠ¨</h3>
<ul>
<li>â€¢ <strong>ç«¯å£å†²çª</strong>ï¼šæ£€æŸ¥ä¸»æœº5432ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Œä½¿ç”¨<code>netstat -tulpn | grep 5432</code>æˆ–<code>ss -tulpn | grep 5432</code>æŸ¥çœ‹å ç”¨è¿›ç¨‹ï¼Œå…³é—­å†²çªè¿›ç¨‹æˆ–ä¿®æ”¹æ˜ å°„ç«¯å£</li>
<li>â€¢ <strong>æ•°æ®å·æƒé™</strong>ï¼šè‹¥ä½¿ç”¨ç»‘å®šæŒ‚è½½ï¼Œç¡®ä¿ä¸»æœºç›®å½•æƒé™å…è®¸å®¹å™¨å†…ç”¨æˆ·è®¿é—®ï¼Œå¯é€šè¿‡<code>chmod 700 /host/path</code>åŠ<code>chown -R 999:999 /host/path</code>è°ƒæ•´æƒé™</li>
<li>â€¢ <strong>é…ç½®æ–‡ä»¶é”™è¯¯</strong>ï¼šæ£€æŸ¥è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è¯­æ³•ï¼Œå¯é€šè¿‡<code>docker run</code>ä¸åŠ <code>-d</code>å‚æ•°å‰å°å¯åŠ¨å®¹å™¨ï¼Œç›´æ¥æŸ¥çœ‹é”™è¯¯æ—¥å¿—</li>
</ul>
<h3 data-id="heading-18">è¿æ¥å¤±è´¥</h3>
<ul>
<li>â€¢ <strong>ç½‘ç»œé—®é¢˜</strong>ï¼šéªŒè¯ä¸»æœºé˜²ç«å¢™æ˜¯å¦å¼€æ”¾5432ç«¯å£ï¼ˆå¦‚<code>ufw allow 5432</code>ï¼‰ï¼Œè¿œç¨‹è¿æ¥éœ€ç¡®ä¿<code>postgresql.conf</code>ä¸­<code>listen_addresses = '*'</code>åŠ<code>pg_hba.conf</code>ä¸­å…è®¸å¯¹åº”IPæ®µè®¿é—®</li>
<li>â€¢ <strong>å¯†ç é”™è¯¯</strong>ï¼šé€šè¿‡<code>docker exec -it postgres-container psql -U postgres</code>ç›´æ¥ç™»å½•å®¹å™¨å†…æ•°æ®åº“ï¼Œä½¿ç”¨<code>ALTER USER postgres PASSWORD 'new_password';</code>é‡ç½®å¯†ç </li>
<li>â€¢ <strong>å®¹å™¨çŠ¶æ€</strong>ï¼šç¡®è®¤å®¹å™¨å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè‹¥å·²åœæ­¢å¯é€šè¿‡<code>docker start postgres-container</code>é‡å¯</li>
</ul>
<h3 data-id="heading-19">æ‰©å±•åŠ è½½å¼‚å¸¸</h3>
<ul>
<li>â€¢ <strong>æ—¥å¿—æ£€æŸ¥</strong>ï¼šæŸ¥çœ‹å®¹å™¨æ—¥å¿—ä¸­æ˜¯å¦æœ‰æ‰©å±•åŠ è½½å¤±è´¥æç¤ºï¼Œå¦‚<code>could not load library</code></li>
<li>â€¢ <strong>ä¾èµ–ç¼ºå¤±</strong>ï¼šéƒ¨åˆ†æ‰©å±•å¯èƒ½éœ€è¦é¢å¤–ç³»ç»Ÿåº“ï¼Œå¯é€šè¿‡<code>docker exec -it postgres-container apt update &amp;&amp; apt install -y [ä¾èµ–åŒ…]</code>å®‰è£…ç¼ºå¤±ä¾èµ–</li>
<li>â€¢ <strong>ç‰ˆæœ¬å…¼å®¹æ€§</strong>ï¼šç¡®è®¤ä½¿ç”¨çš„é•œåƒæ ‡ç­¾ä¸æ‰©å±•ç‰ˆæœ¬å…¼å®¹ï¼Œå¯å‚è€ƒ POSTGRESé•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres</code> æŸ¥çœ‹æ‰©å±•æ”¯æŒä¿¡æ¯</li>
</ul>
<h2 data-id="heading-20">å‚è€ƒèµ„æº</h2>
<ul>
<li>â€¢ Postgres é•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres</code></li>
<li>â€¢ Postgres é•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres/tags</code></li>
<li>â€¢ Supabase Postgres GitHubä»“åº“ <code>https://github.com/supabase/postgres</code></li>
<li>â€¢ PostgreSQLå®˜æ–¹æ–‡æ¡£ <code>https://www.postgresql.org/docs</code></li>
<li>â€¢ Dockerå®¹å™¨æœ€ä½³å®è·µ <code>https://docs.docker.com/develop/develop-images/dockerfile_best-practices</code></li>
</ul>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†Supabase Postgresçš„Dockerå®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€åŸºç¡€ä¸è‡ªå®šä¹‰éƒ¨ç½²ã€åŠŸèƒ½æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–åŠæ•…éšœæ’æŸ¥ç­‰å†…å®¹ã€‚é€šè¿‡å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç”¨æˆ·å¯å¿«é€Ÿæ­å»ºåŒ…å«å¤šç§å®ç”¨æ’ä»¶çš„PostgreSQLæ•°æ®åº“æœåŠ¡ï¼Œæ»¡è¶³å¼€å‘ä¸ç”Ÿäº§éœ€æ±‚ã€‚</p>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ul>
<li>â€¢ ä½¿ç”¨ä¸€é”®è„šæœ¬å¿«é€Ÿéƒ¨ç½²Dockerç¯å¢ƒï¼Œç®€åŒ–å‰æœŸå‡†å¤‡å·¥ä½œ</li>
<li>â€¢ é€šè¿‡è½©è¾•é•œåƒè®¿é—®æ”¯æŒæ‹‰å–Supabase Postgresé•œåƒï¼Œæ”¹å–„è®¿é—®ä½“éªŒ</li>
<li>â€¢ å®¹å™¨éƒ¨ç½²éœ€æ³¨æ„æ•°æ®æŒä¹…åŒ–ï¼ˆä½¿ç”¨å·æŒ‚è½½ï¼‰ã€å¯†ç å®‰å…¨åŠé…ç½®æ–‡ä»¶åŠ è½½</li>
<li>â€¢ ç”Ÿäº§ç¯å¢ƒä¸­åº”é‡è§†èµ„æºé™åˆ¶ã€æ•°æ®å¤‡ä»½ã€SSLé…ç½®åŠé«˜å¯ç”¨æ¶æ„è®¾è®¡</li>
<li>â€¢ æ•…éšœæ’æŸ¥ä»¥æ—¥å¿—åˆ†æä¸ºæ ¸å¿ƒï¼Œé‡ç‚¹å…³æ³¨ç«¯å£å†²çªã€æƒé™é—®é¢˜åŠé…ç½®é”™è¯¯</li>
</ul>
<p><strong>åç»­å»ºè®®</strong>ï¼š</p>
<ul>
<li>â€¢ æ·±å…¥å­¦ä¹ Supabase Postgresé¢„è£…æ‰©å±•çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¦‚PostGISåœ°ç†ä¿¡æ¯å¤„ç†ã€pg_cronå®šæ—¶ä»»åŠ¡ç­‰é«˜çº§ç‰¹æ€§</li>
<li>â€¢ æ ¹æ®ä¸šåŠ¡è´Ÿè½½æƒ…å†µæŒç»­ä¼˜åŒ–æ•°æ®åº“é…ç½®å‚æ•°ï¼Œå®šæœŸç›‘æ§æ€§èƒ½æŒ‡æ ‡ï¼ˆå¯ç»“åˆPrometheus+Grafanaï¼‰</li>
<li>â€¢ å…³æ³¨ Supabase Postgresé•œåƒæ ‡ç­¾åˆ—è¡¨ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/supabase/postgres/tags</code>ï¼ŒåŠæ—¶æ›´æ–°é•œåƒç‰ˆæœ¬ä»¥è·å–å®‰å…¨è¡¥ä¸å’ŒåŠŸèƒ½æ›´æ–°</li>
<li>â€¢ å¯¹äºå¤§è§„æ¨¡éƒ¨ç½²åœºæ™¯ï¼Œå»ºè®®å‚è€ƒå®˜æ–¹æ–‡æ¡£è®¾è®¡åŸºäºKubernetesçš„å®¹å™¨ç¼–æ’æ–¹æ¡ˆï¼Œå®ç°è‡ªåŠ¨åŒ–è¿ç»´ä¸å¼¹æ€§ä¼¸ç¼©</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼]]></title>    <link>https://juejin.cn/post/7585534343562166322</link>    <guid>https://juejin.cn/post/7585534343562166322</guid>    <pubDate>2025-12-21T05:42:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562166322" data-draft-id="7584286241488977960" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T05:42:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetbrains è¿™ä¸ªçŸ¥åè½¯ä»¶åå¹´äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T05:42:23.000Z" title="Sun Dec 21 2025 05:42:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ğŸ“… 2025 å¹´ 12 æœˆ 16 æ—¥æ˜¯ DataGrip çš„ 10 å‘¨å²ç”Ÿæ—¥ï¼<br/>
åœ¨è¿™åå¹´ä¸­ï¼Œå®ƒä»ä»£å· <code>0xdbe</code> çš„åŸå‹æˆé•¿ä¸ºä¸“ä¸šæ•°æ®åº“ IDE çš„æ ‡æ†ã€‚\</p>
</blockquote>
<h2 data-id="heading-0">ä»Šå¤©å°±æ¥è®²è®²å†DataGripä¸­éšè—çš„æ»¡åˆ†æŠ€å·§</h2>
<hr/>
<h2 data-id="heading-1">âœ¨ 1. è·¨æ–‡ä»¶å•è¯è¡¥å…¨ï¼š<code>Alt/Opt + /</code></h2>
<p>ä¸æ­¢æ˜¯ SQL å…³é”®å­—æˆ–å­—æ®µåâ€”â€”è¿™ä¸ªåŠŸèƒ½èƒ½ä»<strong>å½“å‰æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶ä¸­</strong>æ™ºèƒ½åŒ¹é…ä»»æ„å•è¯ï¼ˆç±»ä¼¼â€œHippie Completionâ€ï¼‰ã€‚</p>
<p>âœ… é€‚ç”¨åœºæ™¯ï¼šåœ¨ <code>INSERT</code> è¯­å¥ä¸­å¿«é€Ÿè¡¥å…¨æšä¸¾å€¼ï¼ˆä¾‹å¦‚å°†æ‰€æœ‰å€™é€‰å€¼é¢„å­˜åœ¨ä¸€ä¸ª Scratch æ–‡ä»¶é‡Œï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4db52a476e042dfbfa2ebba9e58f83d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=UdgKQzCHK6pqU3yX181nxGZN6Gs%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ’¡ å°æŠ€å·§ï¼šè¿ç»­æŒ‰ <code>Alt+/</code> å¯å¾ªç¯åˆ‡æ¢åŒ¹é…é¡¹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ” 2. æœ€è¿‘ä½ç½®å¯¼èˆªï¼š<code>Ctrl/Cmd + Shift + E</code></h2>
<p>æ¯” â€œRecent Filesâ€ï¼ˆ<code>Ctrl/Cmd + E</code>ï¼‰æ›´å¼ºå¤§ï¼š</p>
<ul>
<li>æ˜¾ç¤ºæœ€è¿‘<strong>æŸ¥çœ‹æˆ–ç¼–è¾‘è¿‡çš„ä½ç½®</strong>ï¼ˆå¸¦ä¸Šä¸‹æ–‡ä»£ç ç‰‡æ®µï¼‰</li>
<li>å†æŒ‰ä¸€æ¬¡å¿«æ·é”®ï¼Œä»…æ˜¾ç¤º<strong>å·²ä¿®æ”¹æ–‡ä»¶</strong></li>
<li>æ”¯æŒ<strong>è¾“å…¥ä»£ç ç‰‡æ®µå®æ—¶è¿‡æ»¤</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a804be8df84427ab54a2d56fcce9f7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bGvikb9E1NRybEKjN%2B3k9iEpDJM%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¯ ç‰¹åˆ«é€‚åˆï¼šå¿«é€Ÿæ‰¾å›â€œåˆšåˆšå†™åˆ°å“ªäº†â€çš„å¤æ‚æŸ¥è¯¢ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ–¼ï¸ 3. è‡ªå®šä¹‰èƒŒæ™¯å›¾ï¼ˆä¸åªæ˜¯ç¾åŒ–ï¼ï¼‰</h2>
<p>å‰å¾€ï¼š<br/>
<code>Settings | Appearance &amp; Behavior | Appearance | UI Options â†’ Background Image</code></p>
<p>å¯ä¸º<strong>ç¼–è¾‘å™¨ + æ‰€æœ‰å·¥å…·çª—å£</strong>è®¾ç½®èƒŒæ™¯å›¾ï¼Œæ”¯æŒç¼©æ”¾ã€é€æ˜åº¦è°ƒèŠ‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0010cecd73604016b84879b915284801~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=b5Tmo%2BD37ntYXamKR%2B%2BoDhoDO%2F8%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¨ ç”¨é€”å»ºè®®ï¼š</p>
<ul>
<li>æš—è‰²ä¸»é¢˜ä¸‹åŠ ä½é€æ˜åº¦æ°´å° logoï¼ˆå›¢é˜Ÿè§„èŒƒæé†’ï¼‰</li>
<li>æ˜¾ç¤º ER å›¾ä½œä¸ºè§†è§‰å‚è€ƒï¼ˆå¼€å‘æ—¶å¯¹ç…§ç»“æ„ï¼‰</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-4">ğŸ—ƒï¸ 4. ä¸€é”®å¯¼å‡ºæ•´ä¸ª Schema çš„ DDLï¼ˆå¸¦æ–‡ä»¶ç»“æ„ï¼‰</h2>
<p>ä½¿ç”¨ <strong>SQL Generator</strong>ï¼ˆ<code>Ctrl/Cmd + Alt + G</code>ï¼‰ä¸ä»…å¯ç”Ÿæˆå•è¡¨ DDLï¼Œè¿˜èƒ½ï¼š</p>
<p>âœ… å¯¹æ•´ä¸ª <strong>Schema èŠ‚ç‚¹</strong>è°ƒç”¨ â†’ åˆ‡æ¢åˆ° <code>File Output Options</code><br/>
âœ… è‡ªå®šä¹‰æ–‡ä»¶ç»„ç»‡æ–¹å¼ï¼ˆå¦‚â€œæ¯ä¸ªè¡¨ä¸€ä¸ªæ–‡ä»¶â€ã€â€œæŒ‰å¯¹è±¡ç±»å‹åˆ†ç›®å½•â€ï¼‰<br/>
âœ… ç‚¹å‡» <code>Dump</code> ç›´æ¥ç”Ÿæˆç‰©ç†æ–‡ä»¶ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/190e4fae0d64412180db58669dc4234d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=Q2YLxKlg6Sk7GaH%2FwtWlvJ5y36U%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ› ï¸ åœºæ™¯ï¼šç‰ˆæœ¬æ§åˆ¶ schema å˜æ›´ã€ç¾å¤‡é‡å»ºã€è·¨ç¯å¢ƒè¿ç§»ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ“‹ 5. å¤åˆ¶æ•°æ®æº = å¤åˆ¶é…ç½®ï¼ˆè·¨æœºå™¨/IDE å…±äº«ï¼ï¼‰</h2>
<ul>
<li>åœ¨ Database é¢æ¿ä¸­é€‰ä¸­æ•°æ®æº â†’ <code>Ctrl/Cmd + C</code></li>
<li>ç²˜è´´åˆ°ä»»æ„ä½ç½®ï¼ˆç”šè‡³å¦ä¸€å°ç”µè„‘çš„ DataGrip / IntelliJ IDEAï¼‰â†’ <code>Ctrl/Cmd + V</code></li>
</ul>
<p>ğŸ” åº•å±‚åŸç†ï¼šå‰ªè´´æ¿å­˜çš„æ˜¯ <strong>XML é…ç½®ç‰‡æ®µ</strong>ï¼ˆä¸å«å¯†ç ï¼‰ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/798cf569efaf4363897bd127ab814afa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=7wdy9D54aQOU7AK3gfQ1pUtkRwc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¤ å›¢é˜Ÿåä½œåˆ©å™¨ï¼šSlack å‘ä¸€æ®µ XMLï¼ŒåŒäº‹ç§’è¿åŒæ¬¾æ•°æ®åº“ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">ğŸ•°ï¸ 6. æ–‡ä»¶å¤¹çº§æœ¬åœ°å†å²ï¼ˆè¯¯åˆ æ–‡ä»¶ï¼Ÿç§’æ¢å¤ï¼ï¼‰</h2>
<p>ä¸ä»…å•ä¸ªæ–‡ä»¶æœ‰ <code>Local History</code>ï¼Œ<strong>æ•´ä¸ªæ–‡ä»¶å¤¹</strong>ä¹Ÿå¯ä»¥ï¼š</p>
<ol>
<li>åœ¨ <code>Files</code> å·¥å…·çª—å£å³é”®æ–‡ä»¶å¤¹</li>
<li><code>Show History â†’ Local History</code></li>
<li>æŸ¥çœ‹/æ¢å¤ä»»æ„æ—¶é—´ç‚¹çš„ç›®å½•æ ‘ &amp; æ–‡ä»¶å†…å®¹</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/560ca6d96be243868a0102b5c989055b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bIJeoB4JexX9Cw5eGRNHbu3w77s%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šé Git å†å²ï¼æ˜¯ IDE è‡ªåŠ¨ä¿å­˜çš„æœ¬åœ°å¿«ç…§ï¼ˆé‡å¯/æ–­ç”µä¹Ÿä¸ä¸¢ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ“‘ 7. SQL è‡ªå®šä¹‰åŒºåŸŸæŠ˜å  + ç»“æ„å¯¼èˆª</h2>
<p>ç”¨ç‰¹æ®Šæ³¨é‡Šå®šä¹‰å¯æŠ˜å åŒºåŸŸï¼ˆæ”¯æŒ <code>--region</code> / <code>--endregion</code> æˆ– <code>#region</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--region Sales Report</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> orders <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">YEAR</span>(order_date) <span class="hljs-operator">=</span> <span class="hljs-number">2025</span>;
<span class="hljs-comment">--endregion</span>
</code></pre>
<ul>
<li>æŠ˜å /å±•å¼€ï¼š<code>Ctrl/Cmd + - / +</code></li>
<li>åœ¨ <code>File Structure</code>ï¼ˆ<code>Ctrl/Cmd + F12</code>ï¼‰ä¸­æ¸…æ™°åˆ—å‡ºæ‰€æœ‰åŒºåŸŸ</li>
<li>âš¡ <strong>å¯ç›´æ¥ä»ç»“æ„çª—å£æ‰§è¡ŒæŸåŒºåŸŸ SQLï¼</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b11b89bbc8aa471bb02dd77aa0bff2ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=bITnxkfACuCte0p8SqNfLh%2FKPCA%3D" alt="" loading="lazy"/><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff526beff2b14d6fadfa561f6297d4f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=90pA%2BiHLnEUvrjXRXpy8u74F3eo%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ§© é€‚åˆï¼šå·¨å‹ SQL è„šæœ¬åˆ†åŒºç®¡ç†ï¼ˆETLã€æŠ¥è¡¨ã€è¿ç§»è„šæœ¬ç­‰ï¼‰</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ğŸ“Š 8. æŠŠâ€œèŠ‚ç‚¹â€å½“è¡¨æŸ¥ï¼ˆå…ƒæ•°æ®å³æ•°æ®ï¼ï¼‰</h2>
<p>åœ¨ Database æ ‘ä¸­é€‰ä¸­ä»»æ„èŠ‚ç‚¹ï¼ˆå¦‚ <code>tables</code>, <code>functions</code>, <code>indices</code>ï¼‰â†’ æŒ‰ <code>F4</code>ï¼š</p>
<p>â†’ ç«‹å³ä»¥<strong>è¡¨æ ¼å½¢å¼å±•ç¤ºè¯¥ç±»å¯¹è±¡åˆ—è¡¨</strong>ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>åˆ—ç­›é€‰ã€æ’åº</li>
<li>æ–‡æœ¬æœç´¢ï¼ˆ<code>Ctrl+F</code>ï¼‰</li>
<li>å¯¼å‡ºä¸º CSV/Excel</li>
<li><strong>æœ¬åœ°è¿‡æ»¤</strong>ï¼ˆæ— éœ€å†™ SQLï¼ï¼‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/320e7323215c4323a3aca545fbaaeb0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=SzMMbsfnICeK0zzfUsLTqXd8GwU%3D" alt="" loading="lazy"/><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab9e908b369a4ab58cd81c0d290326d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=UrOlDLJXVgTtoYEaiLgs%2FmSldW4%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ¯ å®æˆ˜æ¡ˆä¾‹ï¼šæŸ¥ PostgreSQL ä¸­æ‰€æœ‰ <code>VOLATILE</code> å‡½æ•°ï¼Ÿæ‰“å¼€ <code>functions</code> èŠ‚ç‚¹ â†’ ç­› <code>volatility = 'volatile'</code></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ğŸ§® 9. éšè—è®¡ç®—å™¨ï¼ˆSearch Everywhere é‡Œçš„å½©è›‹ï¼‰</h2>
<ol>
<li><code>Double Shift</code> å‘¼å‡º <code>Search Everywhere</code></li>
<li>åˆ‡æ¢åˆ° <code>All</code> æ ‡ç­¾é¡µ</li>
<li>ç›´æ¥è¾“å…¥ç®—å¼ï¼ˆå¦‚ <code>1024 * 8 + 512</code>ï¼‰â†’ ç»“æœå®æ—¶æ˜¾ç¤ºï¼</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01fc435f21b64bb997e06f4d400e7826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=ACUr6fkQzHku1mFVkN9X%2BnVeics%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ˜„ çº¯è¶£å‘³åŠŸèƒ½ï¼Ÿä¸ï¼å†™åˆ†é¡µ SQL æ—¶å¿«é€Ÿç®— <code>OFFSET</code> / <code>LIMIT</code> å€¼è¶…æ–¹ä¾¿ï½</p>
</blockquote>
<hr/>
<h2 data-id="heading-10">ğŸ¤– 10. AI èŠå¤©ä¸­â€œ@â€é™„æ•°æ®åº“å¯¹è±¡ï¼ˆ2025 å¿…å¤‡ï¼ï¼‰</h2>
<p>åœ¨ DataGrip å†…ç½® AI èŠå¤©æ¡†ä¸­ï¼š</p>
<ol>
<li>è¾“å…¥ <code>@</code> æˆ– <code>#</code></li>
<li>è¾“å…¥ <code>dbObject:</code></li>
<li>é€‰æ‹©è¡¨/è§†å›¾/å‡½æ•°ç­‰ â†’ è‡ªåŠ¨é™„åŠ å…¶å®Œæ•´å…ƒæ•°æ®ï¼ˆç»“æ„ã€æ³¨é‡Šã€æ ·ä¾‹æ•°æ®ï¼‰</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df17db341c5f471892c3250a0e2906a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766900543&amp;x-signature=VSYGLdsMS8kFcBJXxLM0wjfTaYA%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸŒŸ ä¼˜åŠ¿ï¼šé¿å…â€œå¤§æ¨¡å‹å¹»è§‰â€ï¼Œè®© AI ç²¾å‡†ç†è§£ä½ å½“å‰æ“ä½œçš„è¡¨ç»“æ„ï¼Œç”Ÿæˆå¯é  SQL / æ³¨é‡Š / ä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ğŸ ç»“è¯­ï¼šåå¹´ç£¨ä¸€å‰‘ï¼Œæ·±è—åŠŸä¸å</h2>
<p>DataGrip å·²ä¸åªæ˜¯â€œå†™ SQL çš„å·¥å…·â€ï¼Œå®ƒé›†æˆäº†ï¼š</p>
<ul>
<li>âš¡ å¼€å‘æ•ˆç‡åŠ é€Ÿå™¨</li>
<li>ğŸ›¡ï¸ æ•°æ®å®‰å…¨å®ˆé—¨äºº</li>
<li>ğŸ¤– AI å¢å¼ºç”Ÿäº§åŠ›ä¼™ä¼´</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘]]></title>    <link>https://juejin.cn/post/7585553799298334766</link>    <guid>https://juejin.cn/post/7585553799298334766</guid>    <pubDate>2025-12-21T09:48:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585553799298334766" data-draft-id="7585534343562297394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘"/> <meta itemprop="keywords" content="Unreal Engine"/> <meta itemprop="datePublished" content="2025-12-21T09:48:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¤°å­ä¸æ˜¯åŸå­"/> <meta itemprop="url" content="https://juejin.cn/user/661238026361450"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/661238026361450/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¤°å­ä¸æ˜¯åŸå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:48:44.000Z" title="Sun Dec 21 2025 09:48:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€UE5 å­¦ä¹ ç¬”è®°ã€‘ç¬¬ä¸€äººç§°æ¨¡æ¿é¡¹ç›®è§£æï¼ˆä¸€ï¼‰ï¼šé¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé€»è¾‘</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/511c7d807a6a4a9fa0c11e09e2b76ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=ltmw53OKTVflxxKyixKZkTJf9ao%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>åœ¨ç¬¬ä¸€äººç§°æ¸¸æˆä¸­ï¼Œç©å®¶ä»å…¶æ‰€æ‰®æ¼”è§’è‰²çš„è§†ç‚¹æ¥æŸ¥çœ‹æ¸¸æˆã€‚ä¸€äº›ç¬¬ä¸€äººç§°æ¸¸æˆä¼šæ˜¾ç¤ºè§’è‰²æ¨¡å‹çš„æŸéƒ¨åˆ†ï¼Œä¾‹å¦‚è§’è‰²çš„æ‰‹è‡‚æˆ–æ­¦å™¨ã€‚è¿™ä¸<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.epicgames.com%2Fdocumentation%2Fzh-cn%2Funreal-engine%2Fthird-person-template-in-unreal-engine" target="_blank" title="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/third-person-template-in-unreal-engine" ref="nofollow noopener noreferrer">ç¬¬ä¸‰äººç§°æ¸¸æˆ</a>ä¸åŒï¼Œåœ¨åè€…ä¸­ï¼Œä½ å¯ä»¥ä»è§’è‰²èƒŒåç•¥ä¸Šæ–¹çš„ä½ç½®çœ‹åˆ°è§’è‰²åŠ¨ä½œã€‚</p>
</blockquote>
<h3 data-id="heading-1">1. é¡¹ç›®æ¦‚è§ˆ</h3>
<p>å¯ä»¥çœ‹åˆ°<code>Content</code>ç›®å½•ä¸‹æœ‰å¦‚ä¸‹å››ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6df34881e4b4273bce3f96792f9c11a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=adf7QG7vEP5qi3xMlDzqS0Uta7w%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥é€ä¸€åˆ†ææ¯ä¸€ä¸ªæ–‡ä»¶å¤¹çš„å†…éƒ¨ç»“æ„</p>
<h4 data-id="heading-2">1.1 â­ è§’è‰² <code>Characters</code></h4>
<p>è§’è‰²æ–‡ä»¶å¤¹é‡Œé¢åªæœ‰ä¸€ä¸ªè§’è‰²<code>Mannequins</code>ï¼Œæ„ä¸ºâ€œæ¨¡ç‰¹â€ï¼Œå¯ä»¥ç†è§£ä¸º<strong>å…¶ä»–è§’è‰²çš„åŸºç¡€ç±»</strong>ã€‚<code>Mannequins</code>åŒ…å«äº”ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddd28e066e6c4c6d9fd778d734eebfc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=6hMVa%2B9HlNhSSN8vLxIZ8GQYuN8%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<h4 data-id="heading-3"><code>Anims</code>ï¼šå­˜æ”¾è§’è‰²çš„åŠ¨ç”»åºåˆ—</h4>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒçš„åŠ¨ç”»è¢«åˆ†é—¨åˆ«ç±»ï¼Œæ”¾åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹é‡Œ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfbe3f1354cd4b0bbb57c36be725ee61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=0K47HV7lMozWvQzBLAe4TRraWvY%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬é€‰æ‹©å…¶ä¸­çš„<code>Unarmed</code>ï¼ˆæœªæ‰‹æŒæ­¦å™¨ï¼‰çš„åŠ¨ç”»é›†åˆä¸ºä¾‹è¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ç§ä¸åŒçš„æ–‡ä»¶ï¼š</p>
<ul>
<li><strong>åŠ¨ç”»è“å›¾ï¼š</strong> <strong>è¿æ¥æ¸¸æˆé€»è¾‘å’Œæ‰€æœ‰åŠ¨ç”»èµ„æº</strong>ï¼ˆåŠ¨ç”»åºåˆ—ã€æ··åˆç©ºé—´ï¼‰ï¼Œæ ¹æ®æ¸¸æˆçŠ¶æ€è¾“å‡ºæœ€ç»ˆçš„è§’è‰²åŠ¨ç”»</li>
<li><strong>æ··åˆç©ºé—´ï¼š</strong> åŸºäºæŒ‡å®šå‚æ•°ï¼ˆå¦‚é€Ÿåº¦ã€è½¬å‘è§’åº¦ï¼‰ï¼Œè‡ªåŠ¨å¹³æ»‘æ··åˆå¤šä¸ªç›¸ä¼¼åŠ¨ç”»åºåˆ—çš„èµ„æºï¼Œ<strong>è§£å†³å¤šä¸ªåŠ¨ç”»ä¹‹é—´å¡é¡¿åˆ‡æ¢çš„é—®é¢˜</strong></li>
<li><strong>åŠ¨ç”»åºåˆ—ï¼š</strong> <strong>å­˜å‚¨å•ä¸€ã€ç‹¬ç«‹åŠ¨ç”»åŠ¨ä½œçš„åŸºç¡€èµ„æº</strong>ï¼Œç›¸å½“äºåŠ¨ä½œç‰‡æ®µï¼Œæ˜¯è§’è‰²åŠ¨ç”»çš„åŸææ–™</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecdbc18e89c8418fbc69eb4e7d7afda3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=zwZBWAW64pXn6flB5xvzqEyGI3U%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dc30c1642884c6f9271845b1321d740~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=FdsL%2FFPCmjl5WX%2FGgsM0JoD6d6k%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä½ éœ€è¦ä¿®æ”¹æ¨¡å‹çš„è¡Œèµ°åŠ¨ç”»ï¼Œæ¯”å¦‚å°†æ‘†è‡‚çš„å¹…åº¦åŠ å¤§ï¼Œä½ å¯ä»¥ä¿®æ”¹å¯¹åº”çš„åŠ¨ç”»åºåˆ—æ–‡ä»¶ï¼Œä½†è¿™æ˜¯æ¸¸æˆç¾æœ¯éœ€è¦è€ƒè™‘çš„äº‹æƒ…ã€‚</p>
<ul>
<li>
<h4 data-id="heading-4"><code>Materials</code>ï¼šå­˜æ”¾è§’è‰²çš„æè´¨</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c264873f5406421e8c9740e9b5b1a968~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=0o8p8f3U1ni4mHqjntwK9I7r4a4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6fbf6c253e141c48a38cab0d6eb5940~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=mWeor91LAMqWFBXjizB3C9RnY8Y%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>æ–‡ä»¶å¤¹<code>Manny</code>/<code>Quinn</code>ï¼šåˆ†åˆ«å¯¹åº”é»˜è®¤çš„ä¸¤ä¸ªäººä½“æ¨¡ç‰¹ï¼ˆç”·æ€§/å¥³æ€§ï¼‰çš„ä¸“å±æè´¨èµ„æº</li>
<li><code>M_Mannequin</code>ï¼šæ˜¯<strong>äººä½“æ¨¡ç‰¹çš„åŸºç¡€æè´¨</strong>ï¼ˆæˆ–æè´¨å®ä¾‹ï¼‰ï¼Œç›´æ¥æ§åˆ¶äººä½“æ¨¡ç‰¹çš„è§†è§‰è¡¨ç°ï¼ˆæ¯”å¦‚é»˜è®¤çš„ç°ç™½çº¹ç†å¤–è§‚ï¼‰</li>
</ul>
<blockquote>
<p>Qï¼š<strong>æè´¨å’Œæè´¨å®ä¾‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>Aï¼š<strong>Materialæ˜¯æè´¨çš„æ¯ç‰ˆ</strong>ï¼Œå¯ä»¥ç¼–è¾‘Shaderç½‘ç»œã€è®¾ç½®åŸºç¡€æ¸²æŸ“å±æ€§ï¼ˆæ¯”å¦‚æ˜¯å¦é€æ˜ã€å…‰ç…§å“åº”æ–¹å¼ï¼‰ï¼›è€Œ<strong>Material Instanceæ˜¯åŸºäºåŸºç¡€æè´¨åˆ›å»ºçš„å­èµ„æº</strong>ï¼Œç»§æ‰¿åŸºç¡€æè´¨çš„æ‰€æœ‰å±æ€§ï¼Œä½†å¯ä»¥å•ç‹¬ä¿®æ”¹éƒ¨åˆ†å‚æ•°ï¼ˆæ¯”å¦‚é¢œè‰²ã€çº¹ç†ã€ç²—ç³™åº¦ï¼‰ï¼Œä¸ç”¨é‡æ–°åšæ•´ä¸ªæè´¨ï¼Œèƒ½å¤§å¹…æå‡èµ„æºå¤ç”¨å’Œè°ƒæ•´æ•ˆç‡ã€‚</p>
</blockquote>
<ul>
<li>
<h4 data-id="heading-5"><code>Mesh</code>ï¼šè§’è‰²çš„ç½‘æ ¼å›¾å½¢</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d853789ce9f4bdbb42eba35cd822d38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=WfenMUT4coG4toj7BSI1Ww%2Beagw%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>Meshå­˜å‚¨äº†ç‰©ä½“çš„é¡¶ç‚¹ã€é¢ã€æ³•çº¿ç­‰å‡ ä½•æ•°æ®ï¼Œå†³å®šäº†è§’è‰²åœ¨æ¸¸æˆé‡Œå‘ˆç°å‡ºçš„å½¢çŠ¶ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°<code>Mesh</code>æ–‡ä»¶å¤¹é‡Œé¢æœ‰ä¸¤ç§æ–‡ä»¶ï¼š</p>
<ul>
<li>
<p><strong>Skeleton</strong> ï¼š<strong>è§’è‰²çš„åŠ¨ç”»éª¨æ¶</strong>,å®šä¹‰äº†è§’è‰²èƒ½æ´»åŠ¨çš„å…³èŠ‚é€»è¾‘</p>
</li>
<li>
<p><strong>Skeletal Mesh</strong> ï¼šè¿™æ˜¯<strong>ç»‘å®šäº†éª¨éª¼çš„Mesh</strong>ï¼Œæ—¢åŒ…å«è§’è‰²çš„å‡ ä½•å½¢çŠ¶ï¼Œåˆå’Œéª¨éª¼èµ„æºå…³è”ï¼Œèƒ½é©±åŠ¨éª¨éª¼åŠ¨ç”»</p>
</li>
<li>
<h4 data-id="heading-6"><code>Rigs</code>ï¼šè§’è‰²çš„åŠ¨ç”»æ§åˆ¶ä¸ç‰©ç†äº¤äº’è¾…åŠ©</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1429dbcbdeaf47fcabfd12ed66a7016f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=1TsNCFD80Dj%2B73EgdiWdAStPc68%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°<code>Rigs</code>é‡ŒåŒ…å«ä¸¤ç±»æ ¸å¿ƒèµ„æºï¼š</p>
<ul>
<li><strong>Control Rig</strong>ï¼šå¯è§†åŒ–çš„éª¨éª¼æ§åˆ¶å·¥å…·ï¼Œè´Ÿè´£è°ƒæ•´è§’è‰²å§¿æ€ã€è¡¥å…¨åŠ¨ç”»ç»†èŠ‚ï¼›</li>
<li><strong>Physical Asset</strong>ï¼šç»‘å®šéª¨éª¼çš„ç¢°æ’é…ç½®èµ„æºï¼Œè´Ÿè´£å¤„ç†è§’è‰²çš„ç‰©ç†ç¢°æ’ã€å—åŠ›åé¦ˆã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯¹æ–‡ä»¶å¤¹é‡Œçš„æ¯ä¸ªæ–‡ä»¶è¿›è¡Œè§£æï¼š</p>
<ol>
<li><strong><code>CR_Mannequin_Body</code></strong>ï¼š<strong>èº«ä½“æ§åˆ¶</strong>ï¼Œè°ƒæ•´è§’è‰²èº«ä½“å„å…³èŠ‚çš„å§¿æ€ï¼Œä¹Ÿèƒ½ç»™ç°æœ‰åŠ¨ç”»å åŠ ç»†èŠ‚ï¼Œè®©åŠ¨ç”»æ›´ç”ŸåŠ¨</li>
<li><strong><code>CR_Mannequin_FootIK</code></strong>ï¼š<strong>è„šéƒ¨IKæ§åˆ¶</strong>ï¼Œè§£å†³åŠ¨ç”»ç©¿æ¨¡é—®é¢˜ï¼Œè®©è„šéƒ¨è‡ªåŠ¨è´´åˆåœ°é¢ï¼Œä½¿ç§»åŠ¨åŠ¨ç”»æ›´çœŸå®è‡ªç„¶</li>
<li><strong><code>CR_Mannequin_Procedural</code></strong>ï¼š<strong>ç¨‹åºåŒ–æ§åˆ¶</strong>ï¼Œæ ¹æ®è§’è‰²çš„è¿åŠ¨çŠ¶æ€è‡ªåŠ¨è°ƒæ•´è‚¢ä½“ç»†èŠ‚ï¼Œä¸ç”¨æ‰‹åŠ¨é€å¸§ç¼–è¾‘åŠ¨ç”»ï¼Œæå‡åŠ¨ç”»åˆ¶ä½œæ•ˆç‡</li>
<li><strong><code>PA_Mannequin</code></strong>ï¼š<strong>è§’è‰²ç‰©ç†èµ„äº§</strong>ï¼Œç»™è§’è‰²éª¨éª¼ç»‘å®šäº†å¯¹åº”çš„ç¢°æ’ä½“ï¼Œè®©è§’è‰²èƒ½å’Œåœºæ™¯ç‰©ä½“äº§ç”Ÿç¢°æ’ã€å—åˆ°ç‰©ç†åŠ›æ—¶äº§ç”Ÿåé¦ˆç­‰</li>
</ol>
<ul>
<li>
<h4 data-id="heading-7"><code>Textures</code>ï¼šè§’è‰²çš„çº¹ç†</h4>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c140529a55bf4ca9ab3ecf134ab4b53a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=hbU%2B%2FxPzlaKu%2BEcKiZhp4jOXXL0%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ä¸ªå­æ–‡ä»¶å¤¹ï¼Œå…¶ä½œç”¨ä¹Ÿå¾ˆæ¸…æ™°ï¼š</p>
<ul>
<li><strong><code>Manny</code></strong>ï¼šç”·æ€§æ¨¡ç‰¹çš„ä¸“å±çº¹ç†æ–‡ä»¶å¤¹</li>
<li><strong><code>Quinn</code></strong>ï¼šå¥³æ€§æ¨¡ç‰¹çš„ä¸“å±çº¹ç†æ–‡ä»¶å¤¹</li>
<li><strong><code>Shared</code></strong>ï¼šä¸¤ä¸ªæ¨¡ç‰¹å…±ç”¨çš„çº¹ç†æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚é€šç”¨çš„å¸ƒæ–™åº•è‰²ã€é‡‘å±è£…é¥°çº¹ç†ç­‰</li>
</ul>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åˆ†æäº†è§’è‰²æ–‡ä»¶å¤¹<code>Characters</code>å†…çš„æ‰€æœ‰å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªUEå®˜æ–¹ç»™å‡ºçš„åŠŸèƒ½ç›¸å¯¹å®Œå–„çš„è§’è‰²åŸºç¡€æ¨¡æ¿ï¼Œæˆ‘ä»¬åç»­å¯ä»¥<strong>åœ¨å…¶åŸºç¡€ä¸Šæ‹“å±•å‡ºä¸åŒç±»å‹çš„è§’è‰²</strong>ã€‚</p>
<h4 data-id="heading-8">1.2 è¾“å…¥é…ç½® <code>Input</code></h4>
<p>å…ˆé€šè§ˆä¸€ä¸‹<code>Input</code>æ–‡ä»¶å¤¹å†…çš„å†…å®¹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24071fd6cbc5433bb40f3e05f5c7aa07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=QLWibas1mdmXE8WeEPhisP3Rd7c%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f23c15999dd345dd920090b4a3d636cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=%2BJReXUNSxzCNNvdAWJaGkB16Fu8%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53d0f13247c24ea8a347dcf1b5fe52d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=AgBQtd6%2BWdBSwHyZtgNhYGau6oY%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡</strong>æ˜¯è¾“å…¥çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œ<code>IMC_Default</code>/<code>IMC_MouseLook</code>ç”¨æ¥åˆ‡æ¢ä¸åŒçš„è¾“å…¥è§„åˆ™ï¼ˆæ¯”å¦‚<code>IMC_Default</code>æ˜¯é»˜è®¤å…¨æ“ä½œï¼Œ<code>IMC_MouseLook</code>æ˜¯ä»…å…è®¸é¼ æ ‡æ§åˆ¶è§†è§’çš„ç®€åŒ–æ“ä½œï¼‰ã€‚</li>
<li><code>Actions</code>æ˜¯<strong>åŠ¨ä½œè¾“å…¥çš„æ˜ å°„åº“</strong>ï¼ŒåŒ…å«â€œæ“ä½œâ€”â€”æ¸¸æˆåŠ¨ä½œâ€çš„å…·ä½“ç»‘å®šé…ç½®ï¼ŒæŠŠç©å®¶çš„æŒ‰é”®æˆ–æ“ä½œå¯¹åº”åˆ°å…·ä½“çš„æ¸¸æˆåŠŸèƒ½
<ul>
<li><code>IA_Jump</code>ï¼šè§¦å‘è§’è‰²è·³è·ƒ</li>
<li><code>IA_Move</code>ï¼šæ§åˆ¶è§’è‰²ç§»åŠ¨</li>
<li><code>IA_Look</code>/<code>IA_MouseLook</code>ï¼šç»‘å®šè§†è§’æ“ä½œå¹¶è½¬åŠ¨è§’è‰²è§†è§’</li>
</ul>
</li>
<li><code>Touch</code>æ˜¯<strong>è§¦å±è®¾å¤‡çš„ä¸“å±è¾“å…¥é…ç½®</strong>
<ul>
<li><code>UI_Thumbstick</code>ï¼šè™šæ‹Ÿæ‘‡æ†æ§ä»¶ï¼Œå¯¹åº”æ‰‹æŸ„å·¦æ‘‡æ†ï¼ˆè§¦å±æ—¶æ‹–åŠ¨æ‘‡æ†æ§åˆ¶ç§»åŠ¨ï¼‰</li>
<li><code>BP_TouchInterface</code>ï¼šè§¦æ‘¸äº¤äº’çš„é€»è¾‘è“å›¾ï¼Œç®¡ç†è§¦å±æ“ä½œçš„è¯†åˆ«è§„åˆ™</li>
<li><code>UI_TouchSimple</code>ï¼šç®€å•è§¦æ‘¸æŒ‰é’®é…ç½®</li>
</ul>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†ç»™è§’è‰²åŠ å…¥ä¸€ä¸ª<strong>ç„å‡†</strong>åŠ¨ä½œï¼Œæˆ‘éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼š</p>
<ol>
<li>æ–°å»ºä¸€ä¸ª<code>IA_Aim</code>åŠ¨ä½œ</li>
<li>å°†é¼ æ ‡å³é”®ç‚¹å‡»äº‹ä»¶ç»‘å®šåˆ°<code>IA_Aim</code>åŠ¨ä½œ</li>
<li>åœ¨è§’è‰²è“å›¾ä¸­æ·»åŠ ç›¸å…³äº‹ä»¶çš„å¤„ç†é€»è¾‘ï¼Œå¦‚æ›´æ”¹FOVã€å‡å°‘æŠ–åŠ¨ç­‰</li>
</ol>
<h4 data-id="heading-9">1.3 å…³å¡åŸå‹ <code>LevelPrototyping</code></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2048c49cbec4a3ab47569693d84cb7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=zBAJ0%2FUDbwzZWu%2BnkjAmzufqqwk%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨äºå­˜æ”¾æ­å»ºæµ‹è¯•å…³å¡æ‰€éœ€çš„èµ„æº</p>
<ul>
<li><code>Interactable</code>ï¼š<strong>å…³å¡åŸå‹çš„äº¤äº’ç‰©ä½“åº“</strong>ï¼Œå­˜æ”¾å…³å¡ä¸­èƒ½å’Œç©å®¶äº§ç”Ÿäº’åŠ¨çš„ç‰©ä½“èµ„æºï¼ˆæ¯”å¦‚å¯æ‹¾å–çš„é“å…·ã€å¯è§¦å‘çš„æœºå…³ã€å¯æ‰“å¼€çš„é—¨ï¼‰</li>
<li><code>Materials</code>ï¼šå…³å¡åŸå‹çš„åŸºç¡€æè´¨åŒ…</li>
<li><code>Meshes</code>ï¼šå…³å¡åŸå‹çš„åœºæ™¯å‡ ä½•ä½“</li>
<li><code>Textures</code>ï¼šå…³å¡åŸå‹çš„ç®€åŒ–çº¹ç†ç´ æ</li>
</ul>
<p>åŸºäºè¿™äº›åŸå‹èµ„æºï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºä¾›æµ‹è¯•ç”¨çš„åœ°å›¾ä»¥éªŒè¯æ ¸å¿ƒç©æ³•ï¼Œæ— éœ€ç­‰å¾…ç¾æœ¯èµ„æºå…¨éƒ¨åˆ¶ä½œå®Œæ¯•ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p>
<h4 data-id="heading-10">1.4 â­ ç¬¬ä¸€äººç§°æ¨¡æ¿ <code>FirstPerson</code></h4>
<p>è¿™æ˜¯æœ¬èŠ‚çš„é‡ä¸­ä¹‹é‡ï¼ŒåŒ…å«äº†ç¬¬ä¸€äººç§°è§’è‰²çš„æ§åˆ¶ç›¸å…³çš„åŠŸèƒ½ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8d40ab3979c45c981fd2eba6710eb9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=i%2FB1ZA%2FjXFZ8Ps1rQcT5T9mNDpw%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªç‹¬ç«‹æ–‡ä»¶ï¼š</p>
<ul>
<li><code>Lvl_FirstPerson</code>æ˜¯<strong>ç¬¬ä¸€äººç§°ç©æ³•çš„æ¼”ç¤ºåœºæ™¯</strong>ï¼Œå·²ç»æ­å¥½é€‚é…ç¬¬ä¸€äººç§°è§†è§’çš„åŸºç¡€å…³å¡ï¼ˆæ¯”å¦‚ç®€å•çš„æˆ¿é—´ã€å¯äº¤äº’çš„é“å…·ï¼‰ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥æµ‹è¯•ç¬¬ä¸€äººç§°çš„ç§»åŠ¨ã€äº¤äº’ç­‰æ ¸å¿ƒç©æ³•</li>
<li><code>MI_FirstPersonColorway</code>æ˜¯<strong>ç¬¬ä¸€äººç§°å¯è§ç‰©ä½“ï¼ˆæ¯”å¦‚æ­¦å™¨ã€æ‰‹è‡‚æ¨¡å‹ï¼‰çš„å¤–è§‚é…ç½®èµ„æº</strong>ï¼Œèƒ½å•ç‹¬è°ƒæ•´è¿™äº›å…ƒç´ çš„é¢œè‰²ã€è´¨æ„Ÿï¼ˆæ¯”å¦‚æŠŠæ­¦å™¨æ”¹æˆé»„è‰²ã€è°ƒæ•´æ‰‹è‡‚æ¨¡å‹çš„å…‰æ³½åº¦ï¼‰ï¼Œä¸ç”¨ä¿®æ”¹åŸºç¡€æè´¨å°±èƒ½å¿«é€Ÿåˆ‡æ¢å¤–è§‚é£æ ¼</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b98bcfad26349a2a99ffbcd439622e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=fCF92CxycADTKmut57VN%2B%2FtoBsY%3D" alt="image.png" loading="lazy"/></p>
<p><code>Anims</code>æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾è§’è‰²çš„åŠ¨ç”»åºåˆ—ï¼Œç›¸æ¯”åŸºç¡€æ¨¡ç‰¹ï¼Œè¿™é‡Œçš„åŠ¨ç”»åºåˆ—å¤šäº†ä»¥ä¸‹ä¸¤ä¸ªï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4c5f1e6a9e9427ca40f023957795810~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=YvQp0YZTQedE1fsbji%2FN69batro%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong><code>ABP_FP_Copy</code>ï¼ˆåŠ¨ç”»è“å›¾ï¼‰</strong> ï¼šè´Ÿè´£æ¥æ”¶ç¬¬ä¸€äººç§°çš„æ“ä½œè¾“å…¥ï¼Œè°ƒç”¨å¯¹åº”çš„åŠ¨ç”»èµ„æºï¼Œ<strong>è¾“å‡ºæœ€ç»ˆçš„ç¬¬ä¸€äººç§°åŠ¨ç”»è¡¨ç°</strong></li>
<li><strong><code>CtrlRig_FPWarp</code>ï¼ˆControl Rigï¼‰</strong> ï¼šè´Ÿè´£<strong>ç²¾ç»†è°ƒæ•´ç¬¬ä¸€äººç§°å¯è§éƒ¨åˆ†çš„å§¿æ€</strong>ï¼Œè®©åŠ¨ä½œæ›´çœŸå®è‡ªç„¶</li>
</ul>
<p><code>Blueprints</code>æ–‡ä»¶å¤¹ä¸‹æœ‰å››ä¸ªè“å›¾æ–‡ä»¶ï¼Œè¿™å››ä¸ªè“å›¾æ˜¯æ”¯æ’‘ç¬¬ä¸€äººç§°ç©æ³•çš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œåˆ†å·¥è¦†ç›–äº† <strong>è§’è‰²å®ä½“ã€æ“ä½œæ§åˆ¶ã€è§†è§’ç®¡ç†ã€å…³å¡è§„åˆ™</strong>ã€‚</p>
<ul>
<li><strong><code>BP_FirstPersonCharacter</code>ï¼ˆè§’è‰²è“å›¾ï¼‰</strong>
<ul>
<li>å¤„ç†ç§»åŠ¨ã€è·³è·ƒç­‰åŸºç¡€åŠ¨ä½œé€»è¾‘</li>
<li>ç®¡ç†è§’è‰²çš„çŠ¶æ€ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€äº¤äº’çŠ¶æ€ï¼‰</li>
<li>ç»‘å®šç¬¬ä¸€äººç§°è§†è§’ä¸‹çš„å¯è§å…ƒç´ ï¼ˆå¦‚æ‰‹è‡‚ã€æ‰‹æŒé“å…·ï¼‰</li>
</ul>
</li>
<li><strong><code>BP_FirstPersonPlayerController</code>ï¼ˆç©å®¶æ§åˆ¶å™¨è“å›¾ï¼‰</strong>
<ul>
<li>æ¥æ”¶ç©å®¶çš„è¾“å…¥å¹¶ä¼ é€’ç»™è§’è‰²è“å›¾</li>
<li>ç®¡ç†ç¬¬ä¸€äººç§°è§†è§’çš„æ§åˆ¶é€»è¾‘</li>
<li>ä¼ é€’UIä¸è§’è‰²ä¹‹é—´çš„äº¤äº’æŒ‡ä»¤</li>
</ul>
</li>
<li><strong><code>BP_FP_CameraManager</code>ï¼ˆç›¸æœºç®¡ç†å™¨è“å›¾ï¼‰</strong>
<ul>
<li>æ§åˆ¶ç›¸æœºçš„è·Ÿéšè§„åˆ™</li>
<li>å®ç°è§†è§’çš„åŠ¨æ€æ•ˆæœ</li>
<li>é™åˆ¶è§†è§’çš„è½¬åŠ¨èŒƒå›´</li>
</ul>
</li>
<li><strong><code>GM_FirstPerson</code>ï¼ˆæ¸¸æˆæ¨¡å¼è“å›¾ï¼‰</strong>
<ul>
<li>å®šä¹‰å…³å¡çš„æ ¸å¿ƒè§„åˆ™</li>
<li>ç®¡ç†å…³å¡å†…çš„èµ„æºåˆ·æ–°ã€æ•Œäººé…ç½®ç­‰å…¨å±€é€»è¾‘</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class GM_FirstPerson {
        +å®šä¹‰å…³å¡çš„æ ¸å¿ƒè§„åˆ™
        +ç®¡ç†å…³å¡å†…çš„èµ„æºåˆ·æ–°ã€æ•Œäººé…ç½®ç­‰å…¨å±€é€»è¾‘
    }
    class BP_FirstPersonPlayerController {
        +æ¥æ”¶ç©å®¶çš„è¾“å…¥å¹¶ä¼ é€’ç»™è§’è‰²è“å›¾
        +ç®¡ç†ç¬¬ä¸€äººç§°è§†è§’çš„æ§åˆ¶é€»è¾‘
        +ä¼ é€’UIä¸è§’è‰²ä¹‹é—´çš„äº¤äº’æŒ‡ä»¤
    }
    class BP_FirstPersonCharacter {
        +å¤„ç†ç§»åŠ¨ã€è·³è·ƒç­‰åŸºç¡€åŠ¨ä½œé€»è¾‘
        +ç®¡ç†è§’è‰²çš„çŠ¶æ€ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€äº¤äº’çŠ¶æ€ï¼‰
        +ç»‘å®šç¬¬ä¸€äººç§°è§†è§’ä¸‹çš„å¯è§å…ƒç´ ï¼ˆå¦‚æ‰‹è‡‚ã€æ‰‹æŒé“å…·ï¼‰
    }
    class BP_FP_CameraManager {
        +æ§åˆ¶ç›¸æœºçš„è·Ÿéšè§„åˆ™
        +å®ç°è§†è§’çš„åŠ¨æ€æ•ˆæœ
        +é™åˆ¶è§†è§’çš„è½¬åŠ¨èŒƒå›´
    }

    GM_FirstPerson &lt;|-- BP_FirstPersonPlayerController : ä½¿ç”¨
    BP_FirstPersonPlayerController --&gt; BP_FirstPersonCharacter : æ§åˆ¶/Possess
    BP_FirstPersonCharacter --&gt; BP_FP_CameraManager : åŒ…å«/ä½¿ç”¨
    BP_FirstPersonCharacter --&gt; ABP_FP_Copy : ä½¿ç”¨åŠ¨ç”»è“å›¾
    BP_FirstPersonCharacter --&gt; CtrlRig_FPWarp : ä½¿ç”¨Control Rig
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£äº†è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ç»“æ„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å¯¹ç¨‹åºçš„æ ¸å¿ƒâ€”â€”<code>FirstPerson</code>æ–‡ä»¶å¤¹ä¸‹çš„å››ä¸ªè“å›¾è¿›è¡Œåˆ†æï¼Œäº†è§£æ¸¸æˆæ ¸å¿ƒé€»è¾‘æ˜¯å¦‚ä½•ç¼–å†™çš„ã€‚</p>
<h3 data-id="heading-11">2. <code>FirstPerson</code> æ ¸å¿ƒé€»è¾‘åˆ†æ</h3>
<h4 data-id="heading-12">2.1 â­ <code>BP_FirstPersonCharacter</code></h4>
<p>å…ˆå¯¹è¯¥è“å›¾æ‰€æ‹¥æœ‰çš„ç»„ä»¶è¿›è¡Œæ¦‚è§ˆï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c8d58b5fbc0466d97ed7b8fa60650c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=789WePbzeDyUrFE0RxpKvdZr8Vg%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>èƒ¶å›Šä½“ç»„ä»¶ (CollisionCylinder)</strong> ï¼šè§’è‰²æ ¹ç»„ä»¶ï¼Œç”¨äº<strong>å¤„ç†åŸºæœ¬ç¢°æ’æ£€æµ‹</strong>å’Œ<strong>é˜²æ­¢è§’è‰²ç©¿é€ä¸–ç•Œç‰©ä½“</strong></li>
<li><strong>ç®­å¤´ç»„ä»¶ (Arrow)</strong> ï¼šå¯è§†åŒ–æ–¹å‘ç®­å¤´ï¼Œç”¨äºåœ¨ç¼–è¾‘å™¨ä¸­<strong>è¡¨ç¤ºè§’è‰²æœå‘</strong>ï¼Œä¾¿äºè°ƒè¯•å’Œå®šä½</li>
<li><strong>ç½‘æ ¼ä½“ (CharacterMesh0)</strong> ï¼šç¬¬ä¸‰äººç§°è§†å›¾ä¸‹çš„<strong>å®Œæ•´è§’è‰²éª¨éª¼ç½‘æ ¼</strong>ï¼ˆSkeletal Meshï¼‰ï¼Œåœ¨ç¬¬ä¸€äººç§°æ¨¡å¼ä¸‹é€šå¸¸éšè—ï¼Œä»…ä»–äººå¯è§</li>
<li><strong>FirstPersonMesh</strong>ï¼šç¬¬ä¸€äººç§°è§†å›¾ä¸‹çš„<strong>æ‰‹è‡‚/æ­¦å™¨éª¨éª¼ç½‘æ ¼</strong>ï¼Œä»…æ‹¥æœ‰ç©å®¶å¯è§ï¼Œéšç›¸æœºç§»åŠ¨</li>
<li><strong>FirstPersonCamera</strong>ï¼šç¬¬ä¸€äººç§°ç›¸æœºç»„ä»¶ï¼Œæä¾›<strong>ç©å®¶è§†è§’</strong>è§†å›¾ï¼Œå¹¶æ§åˆ¶<strong>å¤´éƒ¨è½¬åŠ¨</strong></li>
<li><strong>è§’è‰²ç§»åŠ¨ (CharMoveComp)</strong> ï¼š<code>CharacterMovementComponent</code>çš„ç®€ç§°ï¼Œè´Ÿè´£<strong>å¤„ç†è§’è‰²ç§»åŠ¨ã€è·³è·ƒã€é‡åŠ›ã€ç¢°æ’å“åº”ç­‰ç‰©ç†é€»è¾‘</strong></li>
</ul>
<p>æœ‰äº†è¿™äº›ç»„ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™å…·ä½“çš„æ§åˆ¶é€»è¾‘ã€‚é€»è¾‘å†™åœ¨è“å›¾çš„äº‹ä»¶å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå¤æ‚çš„æµç¨‹æ‹†è§£æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>
<h5 data-id="heading-13">æµç¨‹å…¥å£</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3ba6b9442c644289399daba2c716fab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=kSkRIlkeUJlyCQkFFq7kyA6vOg0%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åœ¨Pawnè¢«ä»»ä½•Controllerï¼ˆç©å®¶æˆ– AIï¼‰æ¥ç®¡æ—¶è§¦å‘</strong>ï¼Œç”¨äºåŒºåˆ†ç©å®¶æ§åˆ¶ï¼ˆPlayerControllerï¼‰ä¸ AI æ§åˆ¶ï¼ˆAIControllerï¼‰ï¼Œä»¥æ‰§è¡Œä¸åŒé€»è¾‘ï¼ˆå¦‚ä»…ç©å®¶å¯è§çš„ UIã€è¾“å…¥æ˜ å°„ã€ç›¸æœºè®¾ç½®ç­‰ï¼‰ã€‚</p>
<ul>
<li>
<h5 data-id="heading-14">è·¨å¹³å°è¾“å…¥è‡ªé€‚åº”</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05f2052d6f9b45e6a794e0e8defffaf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=dtTAwxotvoazJ3QG731csyqTV4Q%3D" alt="image.png" loading="lazy"/></p>
<p>æ ¹æ®å½“å‰è¿è¡Œå¹³å°æœ‰æ¡ä»¶åœ°æ·»åŠ ä¸€ä¸ªä¸“é—¨ç”¨äºé¼ æ ‡ç„å‡†çš„è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡ï¼ˆIMC_MouseLookï¼‰ï¼ŒåŒæ—¶åœ¨ç§»åŠ¨å¹³å°ä¸Šåˆ›å»ºå¹¶æ˜¾ç¤ºä¸€ä¸ªè§¦æ‘¸UIæ§ä»¶ï¼ˆTarget Touch UIï¼‰ï¼Œä»¥<strong>é¿å…é¼ æ ‡è¾“å…¥ä¸è§¦æ‘¸è¾“å…¥å†²çª</strong>ã€‚</p>
<blockquote>
<p>å¦‚æœä¸æ˜¯è§¦æ‘¸è®¾å¤‡ï¼Œåˆ™æ·»åŠ ç„å‡†æ˜ å°„ä¸Šä¸‹æ–‡ï¼Œå¦åˆ™é¼ æ ‡è¾“å…¥ä¼šå¹²æ‰°è§¦æ‘¸æ“ä½œã€‚å¦‚æœæƒ³åœ¨ Windows ä¸Šæµ‹è¯•è§¦æ‘¸ UIï¼Œå¯ä»¥å¼€å¯â€œUse mouse for touchâ€é€‰é¡¹ï¼Œå¹¶å°† Windows åˆ†æ”¯è®¾ç½®ä¸ºåˆ›å»ºè§¦æ‘¸ UIã€‚</p>
</blockquote>
<ul>
<li>
<h5 data-id="heading-15">è§†è§’æ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71d7619265b140a6be051271a0422f9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=9oze5TWHEqwZuTns14HDEkBnhXM%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ˜¯ä¸€å¥—å…¸å‹çš„<strong>å¤„ç†è§†è§’è¾“å…¥</strong>çš„è“å›¾é€»è¾‘ï¼Œä¸ä¸Šæ–‡è·¨å¹³å°è¾“å…¥çš„é€‚é…å®Œç¾é…åˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æè¿°é€»è¾‘è¦ç‚¹ï¼š</p>

































<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è¾“å…¥åŠ¨ä½œ/äº‹ä»¶</th><th>Xè½´ â†’</th><th>Yè½´ â†’</th><th>æœ€ç»ˆå¤„ç†å‡½æ•°</th></tr></thead><tbody><tr><td>é¼ æ ‡ï¼ˆPCï¼‰</td><td>IA_Lookï¼ˆTriggeredï¼‰</td><td>Yawï¼ˆå·¦å³ï¼‰</td><td>Pitchï¼ˆä¸Šä¸‹ï¼‰</td><td>Aim</td></tr><tr><td>é¼ æ ‡ï¼ˆå¤‡ç”¨/è¡¥å……ï¼‰</td><td>IA_MouseLookï¼ˆTriggeredï¼‰</td><td>Yaw</td><td>Pitch</td><td>Aim</td></tr><tr><td>è§¦æ‘¸å³æ‘‡æ†ï¼ˆç§»åŠ¨ç«¯ï¼‰</td><td>Event Secondary Thumbstick</td><td>Yaw</td><td>Pitch</td><td>Aim</td></tr></tbody></table>
<p>è¿™ä¸€å¥—é€»è¾‘æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p>
<ol>
<li>æ— è®ºé¼ æ ‡è¿˜æ˜¯è§¦æ‘¸æ‘‡æ†ï¼Œ<strong>æœ€ç»ˆéƒ½è°ƒç”¨åŒä¸€ä¸ªAimå‡½æ•°</strong>ï¼Œå¯ä»¥ç¡®ä¿è§†è§’æ§åˆ¶é€»è¾‘ä¸€è‡´</li>
<li>å®Œç¾é…åˆäº†å‰ä¸€å¼ å›¾çš„é€»è¾‘â€”â€”ç§»åŠ¨ç«¯å¼¹å‡ºè§¦æ‘¸UIå¹¶è§¦å‘æ­¤äº‹ä»¶ï¼ŒPCç«¯ä½¿ç”¨é¼ æ ‡è¾“å…¥åŠ¨ä½œã€‚</li>
<li><strong>æ‰€æœ‰è¾“å…¥éƒ½é€šè¿‡Input Actionå®šä¹‰</strong>ï¼Œä¾¿äºåœ¨Project Settingsä¸­ç»Ÿä¸€ç»‘å®šé”®ä½ã€è°ƒæ•´æ›²çº¿ã€æ·»åŠ ä¿®é¥°å™¨ï¼ˆå¦‚æ­»åŒºã€çµæ•åº¦ï¼‰ã€‚</li>
</ol>
<ul>
<li>
<h5 data-id="heading-16">ç§»åŠ¨æ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3db3fca1569c40caaca4d723dab21284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=M91hFMr8D9LLjMqZr9fJNhCiOnI%3D" alt="image.png" loading="lazy"/></p>
<p>å®ç°äº†<strong>é”®ç›˜ä¸è§¦æ‘¸æ‘‡æ†çš„ç»Ÿä¸€ç§»åŠ¨æ§åˆ¶</strong>ï¼Œä¸¤ç§è¾“å…¥æºçš„X/Yè½´å€¼éƒ½æ±‡å…¥Moveå‡½æ•°ï¼Œé©±åŠ¨ç¬¬ä¸€äººç§°è§’è‰²çš„å‰åå·¦å³å¹³ç§»ã€‚</p>
<p>åŒæ ·æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¯ é‡Šè¿™ä¸€å¥—é€»è¾‘ï¼š</p>


























<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è¾“å…¥åŠ¨ä½œ/äº‹ä»¶</th><th>Xè½´ â†’</th><th>Yè½´ â†’</th><th>æœ€ç»ˆå¤„ç†å‡½æ•°</th></tr></thead><tbody><tr><td><strong>é”®ç›˜ï¼ˆPCï¼‰</strong></td><td>IA_Moveï¼ˆTriggeredï¼‰</td><td>Left/Right</td><td>Forward/Backward</td><td>Move</td></tr><tr><td><strong>è§¦æ‘¸å·¦æ‘‡æ†ï¼ˆç§»åŠ¨ç«¯ï¼‰</strong></td><td>Event Primary Thumbstick</td><td>Left/Right</td><td>Forward/Backward</td><td>Move</td></tr></tbody></table>
<ul>
<li>
<h5 data-id="heading-17">è·³è·ƒæ§åˆ¶</h5>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa39a873e83c497ea97d3aefcc70c037~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=ODEynVtlV28oPzza1mvGi1pabpo%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ®µè“å›¾å®ç°äº†<strong>é”®ç›˜ä¸è§¦æ‘¸æŒ‰é’®çš„ç»Ÿä¸€è·³è·ƒæ§åˆ¶</strong>ã€‚</p>
<p>ä½¿ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¯ é‡Šè¿™ä¸€å¥—é€»è¾‘ï¼š</p>




















<table><thead><tr><th>è¾“å…¥æ¥æº</th><th>è·³è·ƒå¼€å§‹ï¼ˆJumpï¼‰</th><th>è·³è·ƒç»“æŸï¼ˆStop Jumpingï¼‰</th></tr></thead><tbody><tr><td><strong>é”®ç›˜/æ‰‹æŸ„ï¼ˆPCï¼‰</strong></td><td>IA_Jump Started</td><td>IA_Jump Completed</td></tr><tr><td><strong>è§¦æ‘¸æŒ‰é’®ï¼ˆç§»åŠ¨ç«¯ï¼‰</strong></td><td>Event Touch Jump Start</td><td>Event Touch Jump End</td></tr></tbody></table>
<p>å¦å¤–ï¼Œè¿™ä¸ªè“å›¾ä¸­è¿˜æœ‰ä¸¤ä¸ªé‡è¦çš„å‡½æ•°ï¼š<code>Move</code>å’Œ<code>Aim</code>ï¼Œä»¥ä¸‹ä¸¤å¼ å›¾åˆ†åˆ«å±•ç¤ºäº†è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ¸å¿ƒé€»è¾‘ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0ceacdeee6741868bc12b2867ebde3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=QuZrUh%2BRjFtXqTNd0KPVKRV7bYc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/109f4429f1834df393277c8986dd42cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=8jxVCzqdYa5o%2FPq5PQ6E5mP3fGE%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™äº›å‡½æ•°å°è£…äº†<strong>è§’è‰²ç§»åŠ¨</strong>å’Œ<strong>è§†è§’è½¬æ¢</strong>çš„APIï¼Œä½¿å¼€å‘è€…æ‰§è¡Œè¿™ä¸¤ä¸ªæ“ä½œå˜å¾—æå…¶ç®€å•ã€‚</p>
<p>ä½¿ç”¨ä¼ªä»£ç æè¿°é€»è¾‘é“¾ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// BP_FirstPersonCharacter - è¾“å…¥å¤„ç†éƒ¨åˆ†</span>

<span class="hljs-comment">// è§†è§’æ§åˆ¶ï¼ˆCamera Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Look <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    <span class="hljs-built_in">Aim</span>(Yaw = ValueX, Pitch = ValueY)

On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_MouseLook <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    <span class="hljs-built_in">Aim</span>(Yaw = ValueX, Pitch = ValueY)

On Event Secondary Thumbstick From Touch <span class="hljs-built_in">Interface</span>(AxisX, AxisY)
    <span class="hljs-built_in">Aim</span>(Yaw = AxisX, Pitch = AxisY)

<span class="hljs-comment">// ç§»åŠ¨æ§åˆ¶ï¼ˆMovement Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Move <span class="hljs-built_in">Triggered</span>(ValueX, ValueY)
    Move(LeftRight = ValueX, ForwardBackward = ValueY)

On Event Primary Thumbstick From Touch <span class="hljs-built_in">Interface</span>(AxisX, AxisY)
    Move(LeftRight = AxisX, ForwardBackward = AxisY)

<span class="hljs-comment">// è·³è·ƒæ§åˆ¶ï¼ˆJump Inputï¼‰</span>
On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Jump Started
    <span class="hljs-built_in">Jump</span>()

On Enhanced <span class="hljs-selector-tag">Input</span> Action IA_Jump Completed
    Stop <span class="hljs-built_in">Jumping</span>()

On Event Touch Jump Start From Touch Interface
    <span class="hljs-built_in">Jump</span>()

On Event Touch Jump End From Touch Interface
    Stop <span class="hljs-built_in">Jumping</span>()

<span class="hljs-comment">// å†…éƒ¨å‡½æ•°ï¼ˆé€šå¸¸åœ¨è“å›¾å‡½æ•°ä¸­å®ç°ï¼‰</span>
Function <span class="hljs-built_in">Aim</span>(Yaw, Pitch)
    Add Controller Yaw <span class="hljs-selector-tag">Input</span>(Yaw * MouseSensitivity)
    Add Controller Pitch <span class="hljs-selector-tag">Input</span>(Pitch * MouseSensitivity)

Function Move(LeftRight, ForwardBackward)
    Add Movement <span class="hljs-selector-tag">Input</span>(Get Actor Forward Vector(), ForwardBackward)
    Add Movement <span class="hljs-selector-tag">Input</span>(Get Actor Right Vector(), LeftRight)
</code></pre>
<h4 data-id="heading-18">2.2 <code>BP_FirstPersonPlayerController</code></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/905299d82136429b9b5161b80b0e533a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=7oGHJUxLKjzfjZDKVyS82lkUrZ0%3D" alt="image.png" loading="lazy"/></p>
<p>ä½œä¸ºç¬¬ä¸€äººç§°é¡¹ç›®çš„<strong>ç©å®¶æ§åˆ¶å™¨</strong>ï¼Œè´Ÿè´£ç®¡ç†ç©å®¶è¾“å…¥ç³»ç»Ÿçš„åˆå§‹åŒ–ã€è·¨å¹³å°é€‚é…ã€è§¦æ‘¸UIçš„åˆ›å»ºä¸æ˜¾ç¤ºï¼Œä»¥åŠå…¶ä»–ç©å®¶ä¸“å±é€»è¾‘ï¼ˆå¦‚ HUDã€è¾“å…¥æ¨¡å¼åˆ‡æ¢ï¼‰ã€‚</p>
<p>å®ƒä¸»è¦ä¸ä¹‹å‰çš„<code>BP_FirstPersonCharacter</code>é…åˆï¼š<code>Character</code>å¤„ç†ç§»åŠ¨/è§†è§’/è·³è·ƒçš„å…·ä½“å®ç°ï¼Œ<code>PlayerController</code>å¤„ç†è¾“å…¥æ˜ å°„å’ŒUIçš„å¹³å°å·®å¼‚ã€‚</p>
<p>ä½¿ç”¨ä¼ªä»£ç æè¿°é€»è¾‘é“¾ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// BP_FirstPersonPlayerController - Event Graph (ä¸»è¦åœ¨ Event BeginPlay ä¸­æ‰§è¡Œ)</span>

<span class="hljs-function">Event <span class="hljs-title">BeginPlay</span>()</span>
{
    <span class="hljs-comment">// è·å–å½“å‰æœ¬åœ°ç©å®¶çš„ Enhanced Input å­ç³»ç»Ÿ</span>
    EnhancedInputSubsystem = <span class="hljs-function">Get Enhanced Input Local Player <span class="hljs-title">Subsystem</span>()

    <span class="hljs-comment">// æ·»åŠ åŸºç¡€è¾“å…¥æ˜ å°„ä¸Šä¸‹æ–‡ï¼ˆåŒ…å«ç§»åŠ¨ã€è§†è§’ã€è·³è·ƒç­‰æ‰€æœ‰ Input Actionï¼‰</span>
    EnhancedInputSubsystem.Add Mapping <span class="hljs-title">Context</span>(<span class="hljs-params">IMC_Default, Priority = <span class="hljs-number">0</span></span>)

    <span class="hljs-comment">// è·å–å½“å‰è¿è¡Œå¹³å°åç§°ï¼ˆè¿”å›å­—ç¬¦ä¸²ï¼Œå¦‚ "Windows"ã€"Android"ã€"iOS" ç­‰ï¼‰</span>
    PlatformName</span> = <span class="hljs-function">Get Platform <span class="hljs-title">Name</span>()

    <span class="hljs-comment">// æ ¹æ®å¹³å°è¿›è¡Œåˆ†æ”¯åˆ¤æ–­</span>
    <span class="hljs-title">Switch</span> (<span class="hljs-params">PlatformName</span>)</span>
    {
        Case <span class="hljs-string">"Windows"</span>:
            <span class="hljs-comment">// PC å¹³å°ï¼šä»…ä½¿ç”¨é”®ç›˜é¼ æ ‡ï¼Œæ— éœ€è§¦æ‘¸ UI</span>
            <span class="hljs-comment">// ä¸æ‰§è¡Œä»»ä½•é¢å¤–æ“ä½œï¼ˆé¼ æ ‡è¾“å…¥å·²ç”± IMC_Default è¦†ç›–ï¼‰</span>
            Break

        Case <span class="hljs-string">"Android"</span>:
        Case <span class="hljs-string">"iOS"</span>:
            <span class="hljs-comment">// ç§»åŠ¨å¹³å°ï¼šåˆ›å»ºå¹¶æ˜¾ç¤ºè™šæ‹Ÿè§¦æ‘¸æ§ä»¶ UI</span>
            TouchUIWidget = <span class="hljs-function">Create <span class="hljs-title">Widget</span>(<span class="hljs-params">Class = TargetTouchUI, OwningPlayer = Self</span>)
            <span class="hljs-title">if</span> (<span class="hljs-params">TouchUIWidget != <span class="hljs-literal">null</span></span>)</span>
            {
                TouchUIWidget.<span class="hljs-function">Add To <span class="hljs-title">Viewport</span>()  <span class="hljs-comment">// æ·»åŠ åˆ°å±å¹•è§†å£ï¼Œä½¿å…¶å¯è§</span>
                <span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®è¾“å…¥æ¨¡å¼ä¸º Game and UIï¼Œå…è®¸è§¦æ‘¸æŒ‰é’®æ¥æ”¶è¾“å…¥</span>
                Set Input Mode Game And <span class="hljs-title">UI</span>()
                Show Mouse <span class="hljs-title">Cursor</span>(<span class="hljs-params"><span class="hljs-literal">false</span></span>)  <span class="hljs-comment">// é€šå¸¸éšè—é¼ æ ‡å…‰æ ‡</span>
            }
            Break

        Default:
            <span class="hljs-comment">// å…¶ä»–å¹³å°ï¼ˆå¦‚ Editor æµ‹è¯•ã€Console ç­‰ï¼‰ï¼šé»˜è®¤åŒ PC å¤„ç†</span>
            <span class="hljs-comment">// ä¸åˆ›å»ºè§¦æ‘¸ UI</span>
            Break
    }
}
</span></code></pre>
<h4 data-id="heading-19">2.3 <code>GM_FirstPerson</code></h4>
<p>è¿™æ˜¯ä¸€ä¸ªçº¯æ•°æ®çš„è“å›¾ï¼Œå®šä¹‰äº†<strong>æ¸¸æˆçš„è¿è¡Œæ¨¡å¼</strong>ï¼Œä»¥ä¸‹å±•ç¤ºäº†å‡ ä¸ªé‡è¦çš„è®¾ç½®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0216028cdca141c293d108bf9eb53118~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=BF%2B%2F5o2isMhuX6QBPLl74Derons%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨<strong>ä¸–ç•Œåœºæ™¯è®¾ç½®</strong>ä¸­é€‰æ‹©è¯¥è“å›¾ï¼Œå³å¯åº”ç”¨å¯¹åº”çš„æ¸¸æˆæ¨¡å¼ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcfc00e01fc9419197eee6a319959ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=bEK2fFc%2B3u7q8vC69xgKp0s5lLY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-20">2.4 <code>BP_FP_CameraManager</code></h4>
<p>å¯ç”¨äº<strong>è‡ªå®šä¹‰ç©å®¶ç›¸æœºè¡Œä¸º</strong>ï¼Œç”¨äºå¢å¼ºç¬¬ä¸€äººç§°ä½“éªŒã€‚æ ‡å‡†ç¬¬ä¸€äººç§°æ¨¡æ¿ä¸­é€šå¸¸ä¸éœ€è¦é‡åº¦è‡ªå®šä¹‰ï¼Œæˆ‘ä»¬ä¹‹åå¯ä»¥å°†å…¶ç”¨äºå®ç°<strong>ç›¸æœºæŠ–åŠ¨</strong>ã€<strong>ç„å‡†æ—¶FOVå˜åŒ–</strong>ã€<strong>å¤´éƒ¨é²å‹ƒ</strong>æˆ–å…¶ä»–å¹³æ»‘ç›¸æœºæ•ˆæœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6befa16820e04cf2a337e1d8a9593174~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qSw5a2Q5LiN5piv5Y6f5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766915832&amp;x-signature=K64PIefA1yD%2FaiPQ9806Vs9PDdQ%3D" alt="image.png" loading="lazy"/></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬åˆ†æäº†è¿™ä¸ªé¡¹ç›®çš„<strong>ç»“æ„</strong>ä»¥åŠ<strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼ˆå››ä¸ªè“å›¾ï¼‰ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹é¡¹ç›®ç»“æ„è¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¾¿äºæˆ‘ä»¬åç»­çš„æ‹“å±•å¼€å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€]]></title>    <link>https://juejin.cn/post/7585555806667866146</link>    <guid>https://juejin.cn/post/7585555806667866146</guid>    <pubDate>2025-12-21T10:14:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585555806667866146" data-draft-id="7585727457472397312" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€"/> <meta itemprop="keywords" content="Vue.js,Vite,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-21T10:14:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaoxue_"/> <meta itemprop="url" content="https://juejin.cn/user/4065372122398027"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç°ä»£å‰ç«¯å¼€å‘å·¥ç¨‹åŒ–ï¼šVue3 + Vite å¸¦ä½ ä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›®ğŸš€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4065372122398027/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiaoxue_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:14:35.000Z" title="Sun Dec 21 2025 10:14:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç°ä»£å‰ç«¯å¼€å‘<strong>å·¥ç¨‹åŒ–</strong>ï¼šä» 0 åˆ° 1 æ­å»º Vue3 é¡¹ç›® ğŸš€</h2>
<p>åœ¨å‰ç«¯å¼€å‘é£é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œâ€œå·¥ç¨‹åŒ–â€ å·²ç»æˆä¸ºæå‡å¼€å‘æ•ˆç‡ã€ä¿è¯é¡¹ç›®è´¨é‡çš„æ ¸å¿ƒå…³é”®è¯ã€‚ä¸å†æ˜¯æ‹¿ç€ç¼–è¾‘å™¨å†™å‡ è¡Œ HTMLã€CSSã€JS å°±èƒ½æå®šçš„æ—¶ä»£ï¼Œç°ä»£å‰ç«¯å¼€å‘éœ€è¦ä¸€å¥—å®Œæ•´çš„å·¥å…·é“¾å’Œæ¶æ„è§„èŒƒã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä»¥ Vue3 + Vite ä¸ºä¾‹ï¼Œå‚ç…§ä¸‹é¢è¿™å¹… <strong>Vue3 å‰ç«¯æŠ€æœ¯æ ˆæ¶æ„å›¾</strong> ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ èµ°è¿›ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„ä¸–ç•Œï¼Œä»åˆå§‹åŒ–é¡¹ç›®åˆ°å®ç°å¤šé¡µé¢å¼€å‘ï¼Œè®©ä½ æ„Ÿå—åˆ°è§„èŒƒæ¶æ„å¸¦æ¥çš„ä¸æ»‘ä½“éªŒï½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52d6a21e45f94e8abf740bf07d43171f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766916874&amp;x-signature=D0TQNvGX%2FEhilj5f5vzKo7oLZ0w%3D" alt="QQ20251221-174448.png" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€åˆå§‹åŒ–ä¸€ä¸ª Vue é¡¹ç›® ğŸ”§</h3>
<p>æƒ³è¦å¼€å¯ Vue3 é¡¹ç›®å¼€å‘ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªè§„èŒƒçš„é¡¹ç›®ç»“æ„ã€‚è¿™é‡Œæˆ‘ä»¬å¼ºçƒˆæ¨èä½¿ç”¨<code>vite</code>ä½œä¸ºæ„å»ºå·¥å…·ï¼Œæ“ä½œç®€å•åˆé«˜æ•ˆï¼</p>
<h4 data-id="heading-2">1.é¡¹ç›®åˆå§‹åŒ–æ­¥éª¤</h4>
<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œè·Ÿç€æŒ‡å¼•ä¸€æ­¥æ­¥æ“ä½œå³å¯ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-csharp" lang="csharp">npm <span class="hljs-keyword">init</span> vite
</code></pre>
<p>æ‰§è¡Œå‘½ä»¤åï¼Œä¼šå‡ºç°å‡ ä¸ªå…³é”®é€‰é¡¹éœ€è¦ä½ å†³ç­–ï¼š</p>
<ul>
<li>ç»™é¡¹ç›®èµ·ä¸ªåå­—ï¼šæˆ‘ä»¬è¿™é‡Œå‘½åä¸º<code>all-vue</code>ï¼ˆæ–¹ä¾¿åç»­ç»Ÿä¸€ç®¡ç†ï¼‰</li>
<li>é€‰æ‹©æ¡†æ¶ï¼šç›´æ¥é€‰ä¸­<code>vue</code>ï¼ˆæ¯•ç«Ÿæˆ‘ä»¬è¦å¼€å‘ Vue é¡¹ç›®å‘€ï½ï¼‰</li>
<li>é€‰æ‹©ç‰ˆæœ¬ï¼šæ¨èé€‰<code>javascript</code>ï¼ˆå¯¹æ–°æ‰‹æ›´å‹å¥½ï¼Œä¸Šæ‰‹æˆæœ¬ä½ï¼‰</li>
</ul>
<p>ä¸åˆ° 10 ç§’ï¼Œä¸€ä¸ªåŸºç¡€çš„ Vue é¡¹ç›®æ¡†æ¶å°±æ­å»ºå®Œæˆäº†ï¼æ˜¯ä¸æ˜¯æ¯”ä¼ ç»Ÿçš„<code>vue create</code>å¿«å¾ˆå¤šï¼Ÿè¿™å°±è¦å½’åŠŸäºæˆ‘ä»¬ä½¿ç”¨çš„æ„å»ºå·¥å…· â€”â€”vite äº†ï½</p>
<h4 data-id="heading-3">2.å…³äº Vite çš„é‚£äº›äº‹å„¿ ğŸ¤”</h4>
<p>å¾ˆå¤šå°ä¼™ä¼´å¯èƒ½ä¼šé—®ï¼šâ€œvite åˆ°åº•æ˜¯ä¸ªå•¥ï¼Ÿå’Œ Vue åˆæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿâ€</p>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>vite æ˜¯ Vue ä½œè€…å°¤é›¨æºªå¼€å‘çš„ç°ä»£å‰ç«¯æ„å»ºå·¥å…·</strong>ï¼Œå®ƒæœ€ç‰›çš„åœ°æ–¹åœ¨äºåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿçš„ ES æ¨¡å—ï¼ˆESMï¼‰å®ç°äº†ä¸¤å¤§é»‘ç§‘æŠ€ï¼š</p>
<ul>
<li><strong>æé€Ÿå†·å¯åŠ¨</strong>ï¼šä¼ ç»Ÿæ„å»ºå·¥å…·ä¼šå…ˆæ‰“åŒ…æ‰€æœ‰æ–‡ä»¶å†å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œè€Œ vite ç›´æ¥è®©æµè§ˆå™¨å»è§£ææ¨¡å—ï¼Œå¯åŠ¨é€Ÿåº¦å¿«åˆ°é£èµ·ï¼</li>
<li><strong>çƒ­æ›´æ–°</strong>ï¼šä¿®æ”¹æ–‡ä»¶åï¼Œvite åªä¼šæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œä¸ä¼šé‡æ–°æ‰“åŒ…æ•´ä¸ªé¡¹ç›®ï¼Œæµè§ˆå™¨ç¬é—´åˆ·æ–°ï¼Œå¼€å‘ä½“éªŒç›´æ¥æ‹‰æ»¡ï½</li>
</ul>
<p>è€Œ Vue å’Œ vite çš„å…³ç³»ï¼Œå¯ä»¥ç”¨ â€œå†…å®¹â€ å’Œ â€œå·¥å…·â€ æ¥æ¦‚æ‹¬ï¼š</p>
<ul>
<li><strong>Vue</strong>ï¼šæ˜¯ä¸€å¥—ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript æ¡†æ¶ï¼Œä¸“æ³¨äºè§†å›¾å±‚ï¼Œæä¾›äº†ç»„ä»¶åŒ–ã€å“åº”å¼ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼ˆè´Ÿè´£ â€œåšä»€ä¹ˆâ€ï¼‰ï¼›</li>
<li><strong>Vite</strong>ï¼šæ˜¯æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œè´Ÿè´£æŠŠä½ å†™çš„ Vue ä»£ç è¿›è¡Œæ‰“åŒ…ã€ç¼–è¯‘ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆè´Ÿè´£ â€œæ€ä¹ˆåšâ€ï¼‰ã€‚</li>
<li>æ€»ç»“æ¥è¯´ï¼švue æ˜¯å‰ç«¯æ¡†æ¶ï¼ˆè´Ÿè´£å†™ä¸šåŠ¡é€»è¾‘ã€ç»„ä»¶ã€ç•Œé¢ï¼‰ï¼Œè€Œ vite æ˜¯æ„å»ºå·¥å…·ï¼ˆè´Ÿè´£æŠŠä½ å†™çš„ vue ä»£ç  â€œæ‰“åŒ…ã€ç¼–è¯‘ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨â€ï¼‰ã€‚</li>
</ul>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼šå¦‚æœ Vue æ˜¯ç”»ç¬”ï¼Œé‚£ vite å°±æ˜¯è°ƒè‰²ç›˜å’Œç”»æ¿ï¼Œå¸®ä½ æ›´é«˜æ•ˆåœ°åˆ›ä½œï½</p>
<h4 data-id="heading-4">3.å¯åŠ¨é¡¹ç›®ï¼šä¸€è¡Œå‘½ä»¤çš„äº‹å„¿ ğŸš€</h4>
<p>é¡¹ç›®åˆå§‹åŒ–å®Œæˆåï¼Œè¿˜éœ€è¦å®‰è£…ä¾èµ–å¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> all-vue
<span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm i
<span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
npm run dev
</code></pre>
<p>è¿™é‡Œçš„<code>npm i</code>ä¼šæ ¹æ®é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code>package.json</code>æ–‡ä»¶å®‰è£…ä¾èµ–ã€‚æ‰“å¼€<code>package.json</code>çœ‹çœ‹ï¼Œé‡Œé¢è®°å½•äº†é¡¹ç›®çš„æ ¸å¿ƒä¿¡æ¯ï¼š</p>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"all-vue"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// é¡¹ç›®åç§°</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.5.24"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// Vueæ ¸å¿ƒä¾èµ–</span>
    <span class="hljs-attr">"vue-router"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.6.4"</span> <span class="hljs-comment">// è·¯ç”±ä¾èµ–ï¼ˆåé¢ä¼šç”¨åˆ°ï¼‰</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vite"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^7.2.4"</span> <span class="hljs-comment">// å¼€å‘ç¯å¢ƒä¾èµ–ï¼šviteæ„å»ºå·¥å…·</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¯åŠ¨å¼€å‘æœåŠ¡å™¨çš„è„šæœ¬</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite build"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// æ‰“åŒ…é¡¹ç›®çš„è„šæœ¬</span>
    <span class="hljs-attr">"preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite preview"</span> <span class="hljs-comment">// é¢„è§ˆæ‰“åŒ…åé¡¹ç›®çš„è„šæœ¬</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æ‰§è¡Œ<code>npm run dev</code>åï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºé¡¹ç›®å¯åŠ¨ä¿¡æ¯ï¼Œé€šå¸¸ä¼šåœ¨<code>localhost:5173</code>å¯åŠ¨æœåŠ¡ï¼Œç”šè‡³ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼ˆè¿™æ˜¯ vite å€ŸåŠ© Node çš„ OS æ¨¡å—å®ç°çš„å°ç»†èŠ‚ï½ï¼‰ã€‚æ›´çˆ½çš„æ˜¯ï¼Œå½“ä½ ä¿®æ”¹ä»»ä½•æ–‡ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°å±•ç¤ºæœ€æ–°æ•ˆæœï¼Œè¿™å°±æ˜¯å‰é¢æåˆ°çš„ â€œçƒ­æ›´æ–°â€ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ F5 å•¦ï¼</p>
<h3 data-id="heading-5">äºŒã€ä¼˜ç§€æ¶æ„ï¼šé¡¹ç›®çš„ â€œéª¨æ¶â€ æœ‰å¤šé‡è¦ï¼Ÿ ğŸ“</h3>
<p>ä¸€ä¸ªä¼˜ç§€çš„é¡¹ç›®æ¶æ„å°±åƒä¸€æ ‹å¤§æ¥¼çš„éª¨æ¶ï¼Œå†³å®šäº†å®ƒçš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§ã€‚Vite åˆå§‹åŒ–çš„ Vue é¡¹ç›®ï¼Œè‡ªå¸¦ä¸€å¥—éå¸¸è§„èŒƒçš„æ¶æ„ï¼Œæˆ‘ä»¬æ¥ä¸€ä¸€æ‹†è§£ï½</p>
<p>Vue é¡¹ç›®ç»“æ„é¢„è§ˆï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-vue-app/
â”œâ”€â”€ node_modules/    <span class="hljs-comment"># ä¾èµ–åŒ…</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.vue      <span class="hljs-comment"># Vue æ ¹ç»„ä»¶ï¼ˆæ ¸å¿ƒï¼‰</span>
â”‚   â”œâ”€â”€ main.js      <span class="hljs-comment"># å…¥å£æ–‡ä»¶ï¼šåˆ›å»º Vue å®ä¾‹å¹¶æŒ‚è½½</span>
â”‚   â”œâ”€â”€ components/  <span class="hljs-comment"># ç»„ä»¶ç›®å½•</span>
â”‚   â””â”€â”€ style.css    <span class="hljs-comment"># å…¨å±€æ ·å¼</span>
â”œâ”€â”€ index.html       <span class="hljs-comment"># Vite å…¥å£ï¼ˆåŒºåˆ«äº Webpackï¼ŒVite ä»¥ HTML ä¸ºå…¥å£ï¼‰</span>
â”œâ”€â”€ package.json     <span class="hljs-comment"># è„šæœ¬å’Œä¾èµ–ï¼ˆå« Viteã€Vue æ ¸å¿ƒä¾èµ–ï¼‰</span>
â””â”€â”€ vite.config.js   <span class="hljs-comment"># Vite é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œè‡ªå®šä¹‰ç«¯å£ã€æ’ä»¶ç­‰ï¼‰</span>
</code></pre>
<h4 data-id="heading-6">1.æ ¹ç›®å½•çš„ â€œçµé­‚æ–‡ä»¶â€ï¼šindex.html</h4>
<p>æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•ï¼Œä½ ä¼šçœ‹åˆ°<code>index.html</code>ï¼Œå®ƒæ˜¯æ•´ä¸ªåº”ç”¨çš„å…¥å£é¡µé¢ï¼Œç›¸å½“äºå¤§æ¥¼çš„ â€œåœ°åŸºâ€ï¼š</p>
<p>html</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"icon"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/svg+xml"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/vite.svg"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>all-vue<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç»„ä»¶çš„æŒ‚è½½ç‚¹ï¼šVueåº”ç”¨ä¼šåœ¨è¿™é‡Œâ€œç”Ÿæ ¹å‘èŠ½â€ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŠ è½½Vueåº”ç”¨çš„å…¥å£è„šæœ¬ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/src/main.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li><strong>æŒ‚è½½ç‚¹</strong>ï¼š<code>&lt;div id="app"&gt;&lt;/div&gt;</code>æ˜¯ Vue åº”ç”¨çš„ â€œè½è„šç‚¹â€ï¼Œåç»­æ‰€æœ‰çš„ Vue ç»„ä»¶éƒ½ä¼šè¢«æ¸²æŸ“åˆ°è¿™ä¸ªå…ƒç´ é‡Œï¼Œå®ƒæ˜¯ Vue ä¸åŸç”Ÿ DOM çš„å”¯ä¸€è¿æ¥ç‚¹ã€‚</li>
<li><strong>ES æ¨¡å—è„šæœ¬</strong>ï¼š<code>&lt;script type="module" src="/src/main.js"&gt;&lt;/script&gt;</code>ä¸­çš„<code>type="module"</code>æ˜¯ Vite å®ç°æé€Ÿå¯åŠ¨çš„æ ¸å¿ƒï¼å®ƒå‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯ä¸€ä¸ª ES æ¨¡å—è„šæœ¬ï¼Œæ”¯æŒ<code>import/export</code>è¯­æ³•ï¼Œæµè§ˆå™¨ä¼šç›´æ¥æŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œä¸ç”¨ç­‰å¾…å…¨é‡æ‰“åŒ…ã€‚</li>
</ol>
<h4 data-id="heading-7">2.src ç›®å½•ï¼šå‰ç«¯å¼€å‘çš„ â€œä¸»æˆ˜åœºâ€ ğŸ“‚</h4>
<p>æ‰€æœ‰çš„ä¸šåŠ¡ä»£ç éƒ½é›†ä¸­åœ¨<code>src</code>ç›®å½•ä¸‹ï¼Œå°±åƒå¤§æ¥¼é‡Œçš„å„ä¸ªæˆ¿é—´ï¼Œåˆ†å·¥æ˜ç¡®ï¼š</p>
<ul>
<li><code>main.js</code>ï¼šåº”ç”¨å…¥å£æ–‡ä»¶ï¼ˆç›¸å½“äº â€œå¤§é—¨â€ï¼Œæ‰€æœ‰èµ„æºä»è¿™é‡Œè¿›å…¥ï¼‰</li>
<li><code>App.vue</code>ï¼šæ ¹ç»„ä»¶ï¼ˆç›¸å½“äº â€œå®¢å…â€ï¼Œæ˜¯æ‰€æœ‰é¡µé¢çš„å…±åŒå®¹å™¨ï¼‰</li>
<li><code>style.css</code>ï¼šå…¨å±€æ ·å¼æ–‡ä»¶ï¼ˆç»Ÿä¸€ç®¡ç†æ•´ä¸ªåº”ç”¨çš„æ ·å¼é£æ ¼ï¼‰</li>
<li><code>components/</code>ï¼šç»„ä»¶ç›®å½•ï¼ˆå­˜æ”¾å¯å¤ç”¨çš„ UI ç»„ä»¶ï¼Œæ¯”å¦‚æŒ‰é’®ã€å¡ç‰‡ç­‰ï¼‰</li>
</ul>
<h5 data-id="heading-8">ï¼ˆ1ï¼‰å…¥å£æ–‡ä»¶ï¼šmain.js çš„ â€œæ€»æŒ‡æŒ¥â€ è§’è‰²</h5>
<p><code>main.js</code>æ˜¯æ•´ä¸ª Vue åº”ç”¨çš„å¯åŠ¨å…¥å£ï¼Œå°±åƒä¹é˜Ÿçš„æŒ‡æŒ¥ï¼Œè´Ÿè´£æŠŠæ‰€æœ‰èµ„æºæ•´åˆèµ·æ¥ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»Vueæ ¸å¿ƒåº“ä¸­å¯¼å…¥åˆ›å»ºåº”ç”¨å®ä¾‹çš„æ–¹æ³•</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å¯¼å…¥å…¨å±€æ ·å¼ï¼ˆè®©æ•´ä¸ªåº”ç”¨éƒ½èƒ½ç”¨ä¸Šè¿™äº›æ ·å¼ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./style.css'</span>
<span class="hljs-comment">// å¯¼å…¥æ ¹ç»„ä»¶Appï¼ˆæ•´ä¸ªåº”ç”¨çš„â€œæ€»å®¹å™¨â€ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-comment">// å¯¼å…¥è·¯ç”±æ¨¡å—ï¼ˆåé¢å®ç°å¤šé¡µé¢ä¼šç”¨åˆ°ï¼‰</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;

<span class="hljs-comment">// åˆ›å»ºVueåº”ç”¨å®ä¾‹ â†’ å¯ç”¨è·¯ç”± â†’ æŒ‚è½½åˆ°#appä¸Š</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
  .<span class="hljs-title function_">use</span>(router) <span class="hljs-comment">// è®©åº”ç”¨æ‹¥æœ‰è·¯ç”±èƒ½åŠ›</span>
  .<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>) <span class="hljs-comment">// æŠŠAppç»„ä»¶æ¸²æŸ“åˆ°index.htmlçš„#appå…ƒç´ é‡Œ</span>
</code></pre>
<p>è¿™å‡ è¡Œä»£ç çœ‹ä¼¼ç®€å•ï¼Œå´å®Œæˆäº†ä» â€œåˆ›å»ºåº”ç”¨â€ åˆ° â€œå¯åŠ¨åº”ç”¨â€ çš„å…¨æµç¨‹ï¼šå…ˆåˆ›å»º Vue å®ä¾‹ï¼Œå…³è”æ ¹ç»„ä»¶<code>App.vue</code>ï¼Œå†é€šè¿‡<code>mount('#app')</code>æŠŠç»„ä»¶æ¸²æŸ“åˆ°<code>index.html</code>çš„æŒ‚è½½ç‚¹ä¸Šï¼Œä¸€ä¸ª Vue åº”ç”¨å°±æ­£å¼å¯åŠ¨äº†ï¼</p>
<h5 data-id="heading-9">ï¼ˆ2ï¼‰æ ¹ç»„ä»¶ï¼šApp.vue çš„ â€œæ€»å®¹å™¨â€ ä½œç”¨</h5>
<p><code>App.vue</code>æ˜¯ Vue åº”ç”¨çš„æ ¹ç»„ä»¶ï¼Œæ‰€æœ‰é¡µé¢å’Œç»„ä»¶éƒ½ä¼šåµŒå¥—åœ¨å®ƒé‡Œé¢ï¼Œå°±åƒä¸€ä¸ªå¤§ç¤¼ç›’ï¼Œè£…ç€åº”ç”¨çš„æ‰€æœ‰å†…å®¹ã€‚å®ƒçš„ç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ¨¡æ¿ï¼ˆHTMLï¼‰ã€è„šæœ¬ï¼ˆJSï¼‰ã€æ ·å¼ï¼ˆCSSï¼‰ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è¿™é‡Œå¯ä»¥å†™ç»„ä»¶çš„é€»è¾‘ä»£ç ï¼ˆç›®å‰æˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦å¤æ‚é€»è¾‘ï¼‰</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å¤´éƒ¨å¯¼èˆª --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- è·¯ç”±å¯¼èˆªé“¾æ¥ï¼švue-routeræä¾›çš„å…¨å±€ç»„ä»¶ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é¡µé¢å†…å®¹åŒºåŸŸï¼šè·¯ç”±å‡ºå£ï¼Œé¡µé¢ç»„ä»¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é¡µè„š --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* scopedè¡¨ç¤ºæ ·å¼åªä½œç”¨äºå½“å‰ç»„ä»¶ï¼Œé¿å…æ ·å¼å†²çª */</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>App.vue</code>å®šä¹‰äº†åº”ç”¨çš„æ•´ä½“å¸ƒå±€ï¼ˆå¤´éƒ¨ã€ä¸»ä½“ã€åº•éƒ¨ï¼‰ï¼Œå…¶ä¸­<code>&lt;router-view&gt;</code>æ˜¯è·¯ç”±å‡ºå£ï¼ˆåé¢è®²å¤šé¡µé¢å¼€å‘æ—¶ä¼šè¯¦ç»†è¯´ï¼‰ï¼Œ<code>&lt;router-link&gt;</code>æ˜¯è·¯ç”±å¯¼èˆªé“¾æ¥ï¼Œè¿™äº›éƒ½æ˜¯<code>vue-router</code>æä¾›çš„èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-10">3.å¼€å‘å·¥å…·ï¼šæ•ˆç‡æå‡çš„ â€œç¥å™¨â€ âœ¨</h4>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚å¼€å‘ Vue3 é¡¹ç›®ï¼Œè¿™ä¸¤ä¸ªå·¥å…·ä¸€å®šè¦å®‰æ’ä¸Šï¼š</p>
<ol>
<li><strong>Volar æ’ä»¶</strong>ï¼ˆVS Codeï¼‰ï¼šVue å®˜æ–¹æ¨å‡ºçš„è¯­æ³•æç¤ºå·¥å…·ï¼Œèƒ½è¯†åˆ« Vue3 çš„æ–°è¯­æ³•ï¼ˆæ¯”å¦‚<code>&lt;script setup&gt;</code>ï¼‰ï¼Œæä¾›ç²¾å‡†çš„ä»£ç è¡¥å…¨å’Œé”™è¯¯æç¤ºï¼Œæ¯”ä»¥å‰çš„ Vetur å¥½ç”¨å¤ªå¤šï¼å®‰è£…åï¼Œå†™ Vue ä»£ç å°±åƒ â€œå¼€äº†æŒ‚â€ï¼Œå†ä¹Ÿä¸ç”¨æ­»è®°ç¡¬èƒŒ API äº†ï½</li>
<li><strong>Vue Devtools æ’ä»¶</strong>ï¼ˆChrome æµè§ˆå™¨ï¼‰ï¼šè°ƒè¯• Vue åº”ç”¨çš„ â€œæ˜¾å¾®é•œâ€ã€‚å®‰è£…åï¼Œåœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·é‡Œä¼šå¤šå‡ºä¸€ä¸ª â€œVueâ€ æ ‡ç­¾ï¼Œèƒ½æŸ¥çœ‹ç»„ä»¶æ ‘ã€ç»„ä»¶çŠ¶æ€ã€è·¯ç”±ä¿¡æ¯ç­‰ï¼Œå¸®ä½ å¿«é€Ÿå®šä½é—®é¢˜ã€‚æ¯”å¦‚ä¿®æ”¹ç»„ä»¶æ•°æ®åï¼Œèƒ½å®æ—¶çœ‹åˆ°ç•Œé¢å˜åŒ–ï¼Œè°ƒè¯•æ•ˆç‡ç¿»å€ï¼</li>
</ol>
<h3 data-id="heading-11">ä¸‰ã€å¦‚ä½•è¿›è¡Œå¤šä¸ªé¡µé¢å¼€å‘å‘¢ï¼Ÿ ğŸ“„â†’ğŸ“‘</h3>
<p>å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰æ˜¯ç°ä»£å‰ç«¯çš„ä¸»æµï¼Œä½† â€œå•é¡µé¢â€ ä¸ä»£è¡¨åªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œè€Œæ˜¯é€šè¿‡è·¯ç”±å®ç°å¤šä¸ªé¡µé¢çš„åˆ‡æ¢ï¼ˆæ— éœ€åˆ·æ–°æµè§ˆå™¨ï¼‰ã€‚Vue é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>vue-router</code>æ¥å®ç°è·¯ç”±åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-12">ç¬¬ä¸€æ­¥ï¼šå®‰è£… vue-router</h4>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…è·¯ç”±ä¾èµ–ï¼š</p>
<p>bash</p>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> vue-router
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œ<code>package.json</code>çš„<code>dependencies</code>é‡Œä¼šå¤šå‡º<code>"vue-router": "^4.6.4"</code>ï¼Œè¡¨ç¤ºè·¯ç”±æ’ä»¶å·²æˆåŠŸå¼•å…¥ã€‚</p>
<h4 data-id="heading-13">ç¬¬äºŒæ­¥ï¼šé…ç½®è·¯ç”±è§„åˆ™</h4>
<p>è·¯ç”±å°±åƒ â€œåœ°å›¾â€ï¼Œå‘Šè¯‰åº”ç”¨ â€œè®¿é—®å“ªä¸ªè·¯å¾„è¯¥æ˜¾ç¤ºå“ªä¸ªé¡µé¢â€ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªè·¯ç”±é…ç½®æ–‡ä»¶ï¼š</p>
<ol>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>router</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»º<code>index.js</code>ï¼ˆè·¯ç”±é…ç½®çš„æ ¸å¿ƒæ–‡ä»¶ï¼‰ï¼›</li>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>views</code>æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾é¡µé¢ç»„ä»¶ï¼ˆ<code>Home.vue</code>å’Œ<code>About.vue</code>ï¼‰ã€‚</li>
</ol>
<p>å…ˆçœ‹é¡µé¢ç»„ä»¶çš„ä»£ç ï¼Œéå¸¸ç®€å•ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- src/views/Home.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Home Page ğŸ <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- src/views/About.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>About Page ğŸ”<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>å†æ¥çœ‹è·¯ç”±é…ç½®æ–‡ä»¶<code>src/router/index.js</code>ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»vue-routerä¸­å¯¼å…¥æ ¸å¿ƒæ–¹æ³•</span>
<span class="hljs-keyword">import</span> {
  createRouter, <span class="hljs-comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span>
  createWebHashHistory <span class="hljs-comment">// è·¯ç”±æ¨¡å¼ï¼ˆhashæ¨¡å¼ï¼Œè·¯å¾„å¸¦#ï¼‰</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-comment">// å¯¼å…¥é¡µé¢ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/Home.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/About.vue'</span>

<span class="hljs-comment">// è·¯ç”±è§„åˆ™ï¼šè·¯å¾„å’Œç»„ä»¶çš„å¯¹åº”å…³ç³»</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-comment">// è®¿é—®æ ¹è·¯å¾„ï¼ˆhttp://localhost:5173/#/ï¼‰</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Home</span> <span class="hljs-comment">// æ˜¾ç¤ºHomeç»„ä»¶</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>, <span class="hljs-comment">// è®¿é—®/aboutè·¯å¾„ï¼ˆhttp://localhost:5173/#/aboutï¼‰</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">About</span> <span class="hljs-comment">// æ˜¾ç¤ºAboutç»„ä»¶</span>
  }
];

<span class="hljs-comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHashHistory</span>(), <span class="hljs-comment">// ä½¿ç”¨hashæ¨¡å¼ï¼ˆè·¯å¾„å¸¦#ï¼Œå…¼å®¹æ€§å¥½ï¼‰</span>
  routes <span class="hljs-comment">// å…³è”è·¯ç”±è§„åˆ™</span>
})

<span class="hljs-comment">// å¯¼å‡ºè·¯ç”±å®ä¾‹ï¼Œä¾›main.jsä½¿ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;
</code></pre>
<p>è¿™é‡Œçš„<code>createWebHashHistory</code>è¡¨ç¤ºä½¿ç”¨ hash æ¨¡å¼ï¼Œè·¯å¾„ä¸­ä¼šå¸¦<code>#</code>ï¼ˆæ¯”å¦‚<code>#/about</code>ï¼‰ï¼Œå¥½å¤„æ˜¯éƒ¨ç½²æ—¶ä¸éœ€è¦æœåŠ¡å™¨é¢å¤–é…ç½®ï¼›å¦‚æœæƒ³å»æ‰<code>#</code>ï¼Œå¯ä»¥ç”¨<code>createWebHistory</code>ï¼ˆéœ€è¦æœåŠ¡å™¨æ”¯æŒï¼‰ã€‚</p>
<h4 data-id="heading-14">ç¬¬ä¸‰æ­¥ï¼šè®©åº”ç”¨ â€œæ‹¥æœ‰â€ è·¯ç”±èƒ½åŠ›</h4>
<p>é…ç½®å¥½è·¯ç”±åï¼Œéœ€è¦åœ¨<code>main.js</code>ä¸­æ³¨å†Œè·¯ç”±ï¼Œè®©æ•´ä¸ªåº”ç”¨éƒ½èƒ½ä½¿ç”¨è·¯ç”±åŠŸèƒ½ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¼å…¥è·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;

<span class="hljs-comment">// åˆ›å»ºåº”ç”¨æ—¶ï¼Œé€šè¿‡.use(router)å¯ç”¨è·¯ç”±</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
  .<span class="hljs-title function_">use</span>(router) 
  .<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼Œç›¸å½“äºç»™åº”ç”¨ â€œè£…ä¸Šå¯¼èˆªç³»ç»Ÿâ€ï¼Œæ²¡æœ‰å®ƒï¼Œ<code>&lt;router-link&gt;</code>å’Œ<code>&lt;router-view&gt;</code>éƒ½æ— æ³•ç”Ÿæ•ˆã€‚</p>
<h4 data-id="heading-15">ç¬¬å››æ­¥ï¼šåœ¨ App.vue ä¸­ä½¿ç”¨è·¯ç”±</h4>
<p>æœ€åï¼Œåœ¨æ ¹ç»„ä»¶<code>App.vue</code>ä¸­æ·»åŠ è·¯ç”±å¯¼èˆªå’Œè·¯ç”±å‡ºå£ï¼š</p>
<ul>
<li><code>&lt;router-link to="è·¯å¾„"&gt;</code>ï¼šè·¯ç”±å¯¼èˆªé“¾æ¥ï¼ˆç›¸å½“äº<code>&lt;a&gt;</code>æ ‡ç­¾ï¼Œä½†ä¸ä¼šåˆ·æ–°é¡µé¢ï¼‰ï¼›</li>
<li><code>&lt;router-view&gt;</code>ï¼šè·¯ç”±å‡ºå£ï¼ˆåŒ¹é…çš„é¡µé¢ç»„ä»¶ä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºï¼‰ã€‚</li>
</ul>
<p>ä»£ç æˆ‘ä»¬å‰é¢å·²ç»è§è¿‡äº†ï¼Œå†é‡ç‚¹çœ‹ä¸€ä¸‹æ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç‚¹å‡»è·³è½¬åˆ°é¦–é¡µ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç‚¹å‡»è·³è½¬åˆ°å…³äºé¡µ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é¡µé¢å†…å®¹ä¼šåœ¨è¿™é‡Œæ˜¾ç¤º --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>æ­¤æ—¶å¯åŠ¨é¡¹ç›®ï¼Œç‚¹å‡»å¯¼èˆªé“¾æ¥ï¼Œé¡µé¢ä¼šåœ¨<code>Home</code>å’Œ<code>About</code>ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œåœ°å€æ çš„è·¯å¾„ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼Œè¿™å°±æ˜¯å•é¡µé¢åº”ç”¨çš„è·¯ç”±æ•ˆæœï½</p>
<p>æ•ˆæœäº®ä¸ªç›¸ï¼š
è§‚å¯Ÿç•Œé¢ä¸­å¤®å’Œåœ°å€æ çš„å˜åŒ–</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ce06ece9be74b63839da07402e27c82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766916874&amp;x-signature=tEZayKdyiDQmBGV37c%2BaIQmzBhI%3D" alt="QQ20251221-18326.gif" loading="lazy"/></p>
<h3 data-id="heading-16">ç»“è¯­ ğŸŒŸ</h3>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´èµ°é€šäº† â€œç”¨ Vite åˆå§‹åŒ– Vue3 é¡¹ç›®â†’ç†è§£é¡¹ç›®æ¶æ„â†’å®ç°å¤šé¡µé¢è·¯ç”±â€ çš„å…¨æµç¨‹ã€‚å›é¡¾æ•´ä¸ªè¿‡ç¨‹ï¼Œä½ ä¼šå‘ç°ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å·¥å…·é“¾ç®€åŒ–å¼€å‘</strong>ï¼šVite çš„æé€Ÿå¯åŠ¨å’Œçƒ­æ›´æ–°ï¼Œè®©å¼€å‘æ•ˆç‡æå‡æ•°å€ï¼›</li>
<li><strong>æ¶æ„è§„èŒƒæ¸…æ™°</strong>ï¼šä»<code>index.html</code>åˆ°<code>src</code>ç›®å½•ï¼Œæ¯ä¸ªæ–‡ä»¶çš„èŒè´£æ˜ç¡®ï¼Œé¡¹ç›®å†å¤§ä¹Ÿä¸ä¼šä¹±ï¼›</li>
<li><strong>ç”Ÿæ€å®Œå–„</strong>ï¼š<code>vue-router</code>ç­‰å®˜æ–¹æ’ä»¶æ— ç¼è¡”æ¥ï¼Œè½»æ¾å®ç°å¤æ‚åŠŸèƒ½ã€‚</li>
</ul>
<p>å‰ç«¯å¼€å‘ä¸å†æ˜¯ â€œå†™å‡ è¡Œä»£ç â€ é‚£ä¹ˆç®€å•ï¼Œè€Œæ˜¯ä¸€å¥— â€œå·¥å…· + è§„èŒƒ + ç”Ÿæ€â€ çš„ååŒä½“ç³»ã€‚æŒæ¡è¿™äº›åŸºç¡€ï¼Œä½ å°±å·²ç»è·¨è¿›äº†ç°ä»£å‰ç«¯å¼€å‘çš„å¤§é—¨ï½ æ¥ä¸‹æ¥ï¼Œä¸å¦¨è¯•è¯•åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ·»åŠ æ›´å¤šé¡µé¢ã€ç»„ä»¶å’Œäº¤äº’ï¼Œæ„Ÿå— Vue3+Vite çš„é­…åŠ›å§ï¼ğŸ’ª</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹]]></title>    <link>https://juejin.cn/post/7585466235662270516</link>    <guid>https://juejin.cn/post/7585466235662270516</guid>    <pubDate>2025-12-20T20:16:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585466235662270516" data-draft-id="7585574047074025472" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2025-12-20T20:16:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tinero"/> <meta itemprop="url" content="https://juejin.cn/user/332513186430804"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain çš„æ ¸å¿ƒæ¦‚å¿µä¸å®ç°æ¡ˆä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/332513186430804/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tinero
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T20:16:34.000Z" title="Sat Dec 20 2025 20:16:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘è®¤ä¸º LangChain æ¡†æ¶ä¸»è¦åˆ†ä¸ºè¿™å‡ ä¸ªéƒ¨åˆ†:</p>
<ol>
<li>å¯¹æ¨¡å‹ I/O çš„å°è£…</li>
<li>æ•°æ®è¿æ¥å°è£…</li>
<li>å¯¹è¯å†å²ç®¡ç†</li>
<li>æ¶æ„å°è£…ï¼ˆé’ˆå¯¹ Chain å’Œ Agentï¼‰</li>
</ol>
<h2 data-id="heading-0">ä¸€ã€å¯¹æ¨¡å‹ I/O çš„å°è£…</h2>
<p>è¯¥æ¨¡å—ä¸»è¦æ˜¯ç”¨äºæ›´å¥½çš„è®¿é—® LLM è¿›è¡Œæ¨ç†ã€åµŒå…¥ä»»åŠ¡ã€‚æ‰€ä»¥å¯¹è®¿é—® LLM çš„è¯·æ±‚ã€å‘é€è¯·æ±‚çš„æ•°æ®ä»¥åŠæ¥æ”¶ LLM ç”Ÿæˆçš„æ•°æ®è¿›è¡Œå°è£…</p>
<h3 data-id="heading-1">1.1 Prompt æ¨¡æ¿</h3>
<p>è¿™ä¸ªæ˜¯ç”¨æ¥å°è£…å‘ LLM å‘é€è¯·æ±‚çš„æç¤ºè¯ï¼Œæ¯”å¦‚å¸¸è§çš„ SystemMessageï¼ˆå‘Šè¯‰æ¨¡å‹å¦‚ä½•è¡Œä¸ºå¹¶ä¸ºäº¤äº’æä¾›ä¸Šä¸‹æ–‡ï¼‰ï¼ŒHumanMessageï¼ˆè¡¨ç¤ºç”¨æˆ·è¾“å…¥å’Œä¸æ¨¡å‹çš„äº¤äº’ï¼‰ å’Œ AIMessageï¼ˆæ¨¡å‹ç”Ÿæˆçš„å“åº”ï¼ŒåŒ…æ‹¬æ–‡æœ¬å†…å®¹ã€å·¥å…·è°ƒç”¨å’Œå…ƒæ•°æ®ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage, AIMessage, SystemMessage

<span class="hljs-comment"># æ¨¡æ‹Ÿå¤šè½®å¯¹è¯</span>
messages = [  
    <span class="hljs-comment"># å‘Šè¯‰æ¨¡å‹ä½ çš„èº«ä»½</span>
    SystemMessage(content=<span class="hljs-string">"ä½ æ˜¯ JoJo çš„ç§äººå°åŠ©ç†"</span>),  
    <span class="hljs-comment"># ç”¨æˆ·è¾“å…¥çš„é—®é¢˜</span>
    HumanMessage(content=<span class="hljs-string">"æˆ‘æ˜¯ JoJo çš„æœ‹å‹ï¼Œæˆ‘å« Tinero"</span>),  
    <span class="hljs-comment"># AI çš„å›ç­”</span>
    AIMessage(content=<span class="hljs-string">"ä½ å¥½ï¼"</span>),  
    <span class="hljs-comment"># ç”¨æˆ·å†é—®</span>
    HumanMessage(content=<span class="hljs-string">"æˆ‘æ˜¯è°ï¼Ÿ"</span>)  
]  
<span class="hljs-comment"># å°±èƒ½è·å– AI çš„å›ç­”</span>
<span class="hljs-comment">#   llm æ˜¯ç”¨æ¥å’Œå¤§æ¨¡å‹è¿›è¡Œäº¤äº’çš„å¯¹è±¡ï¼Œåé¢ä¼šè¯´åˆ°</span>
ret = llm.invoke(messages)  
<span class="hljs-built_in">print</span>(ret.content)  

<span class="hljs-comment"># è¿˜å¯ä»¥ç»§ç»­å†é—®</span>
response = llm.invoke([  
    HumanMessage(<span class="hljs-string">"ä½ æ˜¯è°?"</span>)  
])  
<span class="hljs-built_in">print</span>(response.content)
</code></pre>
<p>ä¸Šé¢çš„è¿™ç§æ–¹å¼ï¼Œæ˜¯æ•´ä¸ª Prompt éƒ½éœ€è¦ç¨‹åºå‘˜ç¼–å†™ï¼ŒLangChain ä¸ºäº†æ›´æ–¹ä¾¿çš„è°ƒç”¨ï¼Œä¹Ÿæ”¯æŒé€šè¿‡è‡ªå®šä¹‰çš„æ¨¡æ¿ï¼Œæ¥æ„å»º Prompt</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate

<span class="hljs-comment"># å®šä¹‰æ¨¡æ¿</span>
template = PromptTemplate.from_template(<span class="hljs-string">"ç»™æˆ‘è®²ä¸ªå…³äº{subject}çš„ç¬‘è¯"</span>)  
<span class="hljs-built_in">print</span>(template)  
<span class="hljs-built_in">print</span>(template.<span class="hljs-built_in">format</span>(subject=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>))  
template = PromptTemplate.from_template(<span class="hljs-string">"ç»™æˆ‘è®²ä¸ªå…³äº{subject}çš„ç¬‘è¯ï¼Œå†…å®¹è¦ç¬¦åˆ{style}è¿™ä¸ªé£æ ¼"</span>)  
<span class="hljs-comment"># æ­¤æ—¶å¦‚æœä¸ä¼ å…¥ style ä¼šç›´æ¥æŠ¥é”™  </span>
<span class="hljs-comment"># print(template.format(subject="å°çŒ«çƒçƒ"))  </span>
ret = llm.invoke(template.<span class="hljs-built_in">format</span>(subject=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>, style=<span class="hljs-string">"ç”œç”œçš„"</span>))  
<span class="hljs-built_in">print</span>(ret.content)
</code></pre>
<p>è¿˜å¯ä»¥é€šè¿‡æ¨¡æ¿æ¥è¡¨ç¤ºä¸Šä¸‹æ–‡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage, AIMessage
<span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate, ChatPromptTemplate, MessagesPlaceholder

<span class="hljs-comment"># è¯¥æ¨¡æ¿ç”¨äºè¡¨ç¤ºä¸Šä¸‹æ–‡ï¼Œè€Œä¸‹é¢çš„ history åˆ™æ˜¯ç”¨äºè¡¨ç¤ºå¯¹è¯å†å²</span>
human_prompt = <span class="hljs-string">"Translate your answer to {language}"</span>  
<span class="hljs-comment"># è¿™ä¸ª prompt å¯ä»¥ç†è§£ä¸ºå¸¦æœ‰å‚æ•°çš„å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦å»ä¼ å…¥å‚æ•°  </span>
human_message_template = HumanMessagePromptTemplate.from_template(human_prompt)  
chat_prompt = ChatPromptTemplate.from_messages([  
    <span class="hljs-comment"># history æ˜¯ MessagesPlaceholder åœ¨æ¨¡æ¿ä¸­çš„å˜é‡åï¼Œç”¨äºåœ¨èµ‹å€¼æ—¶ä½¿ç”¨</span>
    <span class="hljs-comment"># è¿™é‡Œæ”¹å˜é¡ºåºçš„è¯ï¼Œä¼šå½±å“ä¸‹é¢æç¤ºè¯ç”Ÿäº§çš„é¡ºåº  </span>
    <span class="hljs-comment"># ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœé¡ºåºå˜ä¸º human_message_template, MessagesPlaceholder("history") é‚£ä¹ˆä¸‹é¢èµ‹å€¼çš„æ—¶å€™ï¼Œé¡ºåºä¹Ÿéœ€è¦å¯¹åº”çš„è¿›è¡Œè°ƒæ•´ </span>
    MessagesPlaceholder(<span class="hljs-string">"history"</span>), human_message_template
    
])
<span class="hljs-comment"># æ„å»ºå¯¹è¯å†å²</span>
human_message = HumanMessage(content=<span class="hljs-string">"Who is JoJo?"</span>)  
ai_message = AIMessage(content=<span class="hljs-string">"JoJo is a billionaire entrepreneur, inventor, and industrial designer"</span>)  
messages = chat_prompt.format_prompt(  
    <span class="hljs-comment"># å¯¹ history å’Œ language è¿›è¡Œèµ‹å€¼  </span>
    history=[human_message, ai_message], language=<span class="hljs-string">"ä¸­æ–‡"</span>  
)
<span class="hljs-comment"># è®¿é—® LLM</span>
ret = llm.invoke(messages)  
<span class="hljs-built_in">print</span>(ret.content)
</code></pre>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä»æ–‡ä»¶ä¸­å»åŠ è½½ Prompt æ¨¡æ¿</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate

<span class="hljs-string">"""
./prompt_template.txt æ–‡ä»¶çš„å†…å®¹ä¸ºï¼š
ç»™æˆ‘è®²ä¸ªå…³äº{topic}çš„ç¬‘è¯
"""</span>

template = PromptTemplate.from_file(<span class="hljs-string">"./prompt_template.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>)  
<span class="hljs-built_in">print</span>(template.format_prompt(topic=<span class="hljs-string">"å°çŒ«çƒçƒ"</span>))
</code></pre>
<h3 data-id="heading-2">1.2 è®¿é—® LLMs</h3>
<p>å¥½çš„ï¼Œæœ‰äº†æƒ³è¦è®¿é—® LLM çš„ Promptï¼Œæˆ‘ä»¬å°±éœ€è¦å°†å…¶å‘é€ç»™ LLMï¼Œè®©å®ƒå»ç»™æˆ‘ä»¬ç”Ÿæˆå›ç­”ï¼Œè€Œ LLM çš„å›ç­”ï¼Œæ ¹æ®ä»»åŠ¡çš„ä¸åŒï¼ˆåˆ†ä¸ºæ¨ç†ã€åµŒå…¥ç­‰ï¼‰ï¼Œä¼šæœ‰ä¸åŒçš„è¿”å›ç»“æœ</p>
<p>LangChain å°è£…äº† OpenAIï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼å»è®¿é—®æ¨¡å‹ï¼Œå…ˆè¯´ä½¿ç”¨æ¨¡å‹è¿›è¡Œæ¨ç†ä»»åŠ¡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-comment"># è¿™é‡Œè®¿é—®çš„æ˜¯ Qwen æ¨¡å‹ï¼Œå¯¹åº”çš„ API å’Œ Token æˆ‘éƒ½å­˜å‚¨åˆ°ç¯å¢ƒå˜é‡é‡Œå»äº†</span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># ç„¶åå°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ¨ç†ä»»åŠ¡äº†</span>
response = llm.invoke(<span class="hljs-string">"ä½ æ˜¯è°?"</span>)

<span class="hljs-comment"># è¿˜å¯ä»¥é€šè¿‡ llm è¿›è¡Œæµå¼è¾“å‡ºï¼Œè·å–å¯¹åº”çš„ chunks</span>
<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> llm.stream(<span class="hljs-string">"ä½ æ˜¯è°"</span>):  
    <span class="hljs-built_in">print</span>(chunk)
</code></pre>
<p>é™¤äº†å®ç°æ¨ç†ä»»åŠ¡ï¼Œè¿˜å¯ä»¥å¯¹å…¶è¿›è¡Œè¯åµŒå…¥ä»»åŠ¡</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings

<span class="hljs-comment"># è¿™é‡ŒåŒæ ·è®¿é—®çš„æ˜¯ Qwen çš„è¯åµŒå…¥æ¨¡å‹ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢ä¸€å †æµ®ç‚¹å‹æ•°æ®ï¼Œè¯åµŒå…¥é€šå¸¸å’Œæ£€ç´¢ä¸€å—å„¿ä½¿ç”¨</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)
<span class="hljs-built_in">print</span>(embeddings.embed_query(<span class="hljs-string">"ä½ æ˜¯è°ï¼Ÿ"</span>))
</code></pre>
<h3 data-id="heading-3">1.3 æ ¼å¼åŒ– LLMs çš„å“åº”ç»“æœ</h3>
<p>è®¿é—® LLMs åï¼Œæˆ‘ä»¬ä¼šè·å–åˆ°å…¶æ¨ç†ç”Ÿæˆçš„ç»“æœï¼ˆè¿™é‡Œä¸è¯´åµŒå…¥ï¼‰ï¼Œä½†æ˜¯å“åº”çš„ç»“æœé€šå¸¸éƒ½æ˜¯æ–‡æœ¬ï¼ˆLangChain æ”¯æŒå¯¹ LLMs å“åº”ç»“æœçš„å„ç§è§£æï¼Œå¯ä»¥ä½¿ç”¨ JsonOutputParser å»è§£æ LLMs ç”Ÿæˆçš„ Json æ•°æ®ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ StrOutputParser è§£æ LLMs ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œä»¥åŠå…¶ä»–çš„è§£æå™¨ã€‚å› ä¸ºè°ƒç”¨ llm å¯¹è±¡ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨è¿™å‡ ä¸ªå°†å…¶ç»“æœå…¨éƒ¨è§£æé™¤äº†ï¼Œæ¯”å¦‚è°ƒç”¨ StrOutputParser åï¼Œè·å–åˆ°çš„ç»“æœæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºå¾ˆç®€å•å°±ä¸ä¸¾ä¾‹äº†ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œé‡ç‚¹è¯´ä¸‹å¦‚ä½•è§£ææˆ Json å’Œ Pydanticï¼‰ï¼Œè¿™ä¸ªä¸æ–¹ä¾¿æˆ‘ä»¬è§£æï¼Œæˆ‘ä»¬æƒ³è¦å°†å…¶æ ¼å¼åŒ–ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> JsonOutputParser, PydanticOutputParser

<span class="hljs-comment"># ç›´æ¥è¾“å‡º pydantic å¯¹è±¡  </span>
<span class="hljs-comment"># å®šä¹‰è¾“å‡ºå¯¹è±¡  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Date</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):  
    year: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Year"</span>)  
    month: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Month"</span>)  
    day: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"Day"</span>)  
    era: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"BC or AD"</span>)  
  
  
<span class="hljs-comment"># å®šä¹‰ç»“æ„åŒ–è¾“å‡ºçš„æ¨¡å‹  </span>
structured_llm = llm.with_structured_output(Date)  
<span class="hljs-comment"># ä¸‹é¢çš„æ¨¡æ¿ä¸­ï¼Œå¿…é¡»è¦åŒ…å« "è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡" è¿™å¥è¯ï¼Œè¦ä¸ç„¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿”å›çš„ä¸æ˜¯ Json å¯¹è±¡ï¼Œæ— æ³•å°†å…¶è½¬æ¢ä¸º pydantic å¯¹è±¡</span>
template = <span class="hljs-string">"""  
æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ  
ç”¨æˆ·è¾“å…¥ï¼š  
{query}  
è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡  
"""</span>  
prompt = PromptTemplate(template=template)  
<span class="hljs-comment"># è¿˜å¯ä»¥è¿™æ ·å­</span>
<span class="hljs-comment"># prompt = PromptTemplate.from_template(template)  </span>
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_query = prompt.format_prompt(query=query)  
ret = structured_llm.invoke(input_query)  
<span class="hljs-built_in">print</span>(ret)


<span class="hljs-comment"># è¾“å‡ºæŒ‡å®šæ ¼å¼çš„ Json</span>
json_schema = {  
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Date"</span>,  
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Formated date expression"</span>,  
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,  
    <span class="hljs-string">"properties"</span>: {  
        <span class="hljs-string">"year"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"year YYYY"</span>  
        },  
        <span class="hljs-string">"month"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"month MM"</span>  
        },  
        <span class="hljs-string">"day"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"day DD"</span>  
        },  
        <span class="hljs-string">"era"</span>: {  
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,  
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"BC or AD"</span>  
        }  
    }  
}  
structured_llm = llm.with_structured_output(json_schema)  
<span class="hljs-comment"># è¿˜æ˜¯å¿…é¡»åŠ ä¸Šæœ€åä¸€å¥è¯ï¼Œè¦ä¸ç„¶ä¼šæŠ¥é”™  </span>
template = <span class="hljs-string">"""  
æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ  
ç”¨æˆ·è¾“å…¥ï¼š  
{query}  
è¿”å›çš„ç»“æœæ˜¯åŒ…å« year, month, day, å’Œ era çš„ Json å¯¹è±¡  
"""</span>  
prompt = PromptTemplate.from_template(template)  
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_query = prompt.format_prompt(query=query)  
ret = structured_llm.invoke(input_query)  
<span class="hljs-built_in">print</span>(ret)


<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨ JsonOutputParser  </span>
<span class="hljs-comment"># parser = JsonOutputParser(pydantic_object=Date)  </span>
<span class="hljs-comment"># ä½¿ç”¨ PydanticOutputParser ä¹Ÿæ˜¯å¯ä»¥çš„  </span>
parser = PydanticOutputParser(pydantic_object=Date)  
prompt = PromptTemplate(  
    template=<span class="hljs-string">"æå–ç”¨æˆ·è¾“å…¥ä¸­çš„æ—¥æœŸ \n ç”¨æˆ·è¾“å…¥ï¼š\n{query}\n{format_instructions}"</span>,  
    input_variables=[<span class="hljs-string">"query"</span>],  
    <span class="hljs-comment"># æŒ‡å®šå“åº”æ ¼å¼</span>
    partial_variables={  
        <span class="hljs-string">"format_instructions"</span>: parser.get_format_instructions()  
    }  
)  
query = <span class="hljs-string">"2025å¹´åä¸€æœˆ30æ—¥å¤©æ°”æ™´ã€‚ã€‚ã€‚"</span>  
input_prompt = prompt.format_prompt(query=query) 
ret = llm.invoke(input_prompt)  
<span class="hljs-built_in">print</span>(ret.content)  
<span class="hljs-built_in">print</span>(parser.invoke(ret))

</code></pre>
<p>å½“ç„¶ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœæœ‰æ—¶å€™å¤§æ¨¡å‹å“åº”çš„ç»“æœä¸æ­£ç¡®ï¼Œæˆ–ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä»–ç›´æ¥æŠ¥é”™ï¼Œè€Œæ˜¯è‡ªåŠ¨çº é”™ä¸‹ï¼Œç„¶åå†è¿”å›ç»™æˆ‘ä»¬ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¾ˆè€ƒéªŒå¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä¸Šé¢æ¡ˆä¾‹çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ ä¸€ä¸ªçº é”™çš„åŠŸèƒ½</span>
<span class="hljs-keyword">from</span> langchain.output_parsers <span class="hljs-keyword">import</span> OutputFixingParser

<span class="hljs-comment"># åˆ©ç”¨å¤§æ¨¡å‹åšæ ¼å¼è‡ªåŠ¨çº é”™</span>
parser = PydanticOutputParser(pydantic_object=Date)  
new_parser = OutputFixingParser.from_llm(parser=parser, llm=llm)  
bad_output = ret.content.replace(<span class="hljs-string">"5"</span>, <span class="hljs-string">"å››"</span>)  
<span class="hljs-comment"># bad_output = ret.content.replace("5", "å…­")  </span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"PydanticOutputParser: "</span>)  
<span class="hljs-keyword">try</span>:  
    parser.invoke(bad_output)  
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  
    <span class="hljs-built_in">print</span>(e)  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"OutputFixingParserï¼š"</span>)  
<span class="hljs-built_in">print</span>(new_parser.invoke(bad_output))  
<span class="hljs-string">"""  
ä½†æ˜¯çº é”™åçš„ç»“æœï¼Œä¸º year=2023 month=11 day=30 era='AD'ï¼Œ  
æˆ‘ä»¬æƒ³è¦çš„ç»“æœæ˜¯ year=2025 month=11 day=30 era='AD'  
è¿™ä¸ªé—®é¢˜å’Œæ¨¡å‹èƒ½åŠ›æœ‰å…³ç³»ï¼Œåªèƒ½è¯´ä»˜è´¹æœ‰ä»˜è´¹çš„é“ç†  
ä½¿ç”¨ qwen3-max å¼ºçš„ä¸€ç‚¹åœ¨äºï¼Œå¦‚æœæ›¿æ¢ä¸ºå››ï¼Œçº é”™åä¸º 2024ï¼Œå¦‚æœæ›¿æ¢ä¸ºå…­ï¼Œçº é”™åä¸º 2026  
ä½¿ç”¨ qwen-plusï¼Œä¸ç®¡æ˜¯æ›¿æ¢ä¸ºå››è¿˜æ˜¯æ›¿ä¸ºå…­ï¼Œçº é”™åéƒ½æ˜¯ 2024ï¼Œåªèƒ½è¯´èƒ½åŠ›æå‡äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸å¤š
å¦‚æœæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›ä»˜è´¹çš„æ¨¡å‹å»è¯•è¯•ï¼Œæˆ‘æ¯”è¾ƒç©·ï¼Œå°±å…ˆä¸å°è¯•äº†
"""</span>

</code></pre>
<p>ç»è¿‡ä¸Šé¢çš„å¯¹ Promptã€è¯·æ±‚ LLMs ä»¥åŠ Parser Outputï¼Œæ•´ä¸ªå¯¹æ¨¡å‹ I/O çš„å°è£…å·²ç»å®ç°äº†ï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šé‡åˆ° Function Calling çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨ Agent é‡Œï¼Œæ‰€ä»¥ä»‹ç»ä¸‹è¿™ä¸ª</p>
<h3 data-id="heading-4">1.4 Function Calling</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæƒ³è¦å„ç§ä¸šåŠ¡æ¥å£äº’ç›¸è°ƒç”¨çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨è¿™ä¸ªï¼Œæˆ‘ç†è§£è¿™ä¸ªä¸»è¦æ˜¯ç”¨äºå’Œ MCP è¿›è¡Œå¯¹æ¥çš„</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.tools <span class="hljs-keyword">import</span> tool

<span class="hljs-comment"># è‡ªå®šä¹‰ä¸¤ä¸ªå·¥å…·å‡½æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€å®šè¦åœ¨å‡½æ•°é‡Œæ·»åŠ æ³¨é‡Šï¼ï¼ï¼ï¼Œå¦åˆ™è¯†åˆ«ä¸äº†ä½ è¿™ä¸ªå·¥å…·æ˜¯å¹²å•¥çš„</span>
<span class="hljs-comment"># æ·»åŠ ä¸ªè£…é¥°å™¨ï¼Œè¡¨æ˜è¿™ä¸ªä½¿ç”¨è°ƒç”¨çš„å·¥å…·å‡½æ•°</span>
<span class="hljs-meta">@tool  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    Add two integers.  
    :param a: First integer  
    :param b: Second integer  
    :return:  
    """</span>  
    <span class="hljs-keyword">return</span> a + b  
  
  
<span class="hljs-meta">@tool  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">multiply</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    Multiply two integers.  
    :param a: First integer  
    :param b: Second integer  
    :return:  
    """</span>  
    <span class="hljs-keyword">return</span> a * b  
  

<span class="hljs-comment"># ç»‘å®šè‡ªå®šä¹‰å·¥å…·</span>
llm_with_tools = llm.bind_tools([add, multiply])  
query = <span class="hljs-string">"3 çš„ 4 å€æ˜¯å¤šå°‘ï¼Ÿ"</span>  
messages = [HumanMessage(query)]  
output = llm_with_tools.invoke(messages)  
<span class="hljs-built_in">print</span>(json.dumps(output.tool_calls, indent=<span class="hljs-number">4</span>))  
<span class="hljs-built_in">print</span>()  
<span class="hljs-comment"># å°† AI å“åº”çš„ç»“æœï¼Œæ”¾åˆ°å¯¹è¯å†å²é‡Œ</span>
messages.append(output)  
available_tools = {  
    <span class="hljs-string">"add"</span>: add,  
    <span class="hljs-string">"multiply"</span>: multiply  
}  
<span class="hljs-comment"># çœ‹æ¨¡å‹è°ƒç”¨å“ªä¸ªå·¥å…·ï¼Œå°±æ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œç„¶åå°†ç»“æœå­˜æ”¾åˆ°å¯¹è¯å†å²é‡Œ</span>
<span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> output.tool_calls:  
    selected_tool = available_tools[tool_call[<span class="hljs-string">"name"</span>].lower()]  
    tool_msg = selected_tool.invoke(tool_call)  
    messages.append(tool_msg)  

<span class="hljs-comment"># æŠŠæ•´ä¸ªå¯¹è¯å†å²å†å‘é€ç»™æ¨¡å‹</span>
new_output = llm_with_tools.invoke(messages)  
<span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages:  
    <span class="hljs-built_in">print</span>(json.dumps(message.model_dump(), indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))  
    <span class="hljs-built_in">print</span>()  
<span class="hljs-built_in">print</span>(new_output.content)
</code></pre>
<h2 data-id="heading-5">äºŒã€æ•°æ®è¿æ¥å°è£…</h2>
<p>ä½¿ç”¨ LangChain åœ¨åš RAG çš„æ—¶å€™ï¼Œç»å¸¸ä¼šç”¨åˆ°æ•´ä¸ªï¼Œç°åœ¨é€šè¿‡æ„å»ºä¸ªç®€å•çš„ RAG æ¡ˆä¾‹ï¼Œæ¥è¿›è¡Œä»‹ç»</p>
<h3 data-id="heading-6">2.1 Document Loaders</h3>
<p>LangChain æ”¯æŒå¯¹å„ç§æ ¼å¼æ–‡ä»¶è¿›è¡ŒåŠ è½½ï¼Œå¦‚ä½•åŠ è½½å°±æ˜¯ä½¿ç”¨ä¸åŒçš„åŠ è½½å™¨ï¼Œè¿™é‡Œæˆ‘æ˜¯å¯¹ PDF è¿›è¡ŒåŠ è½½ï¼Œå…¶ä»–çš„å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£è¿›è¡Œä½¿ç”¨</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> PyMuPDFLoader

<span class="hljs-comment"># æå–æ–‡æ¡£å†…å®¹  </span>
loader = PyMuPDFLoader(<span class="hljs-string">"./resource/2307.09288v2.pdf"</span>)  
<span class="hljs-comment"># è¿›è¡Œåˆ†é¡µï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªåªèƒ½æå–å‡ºæ–‡å­—ï¼Œå›¾ç‰‡è¯†åˆ«ä¸å‡ºæ¥</span>
pages = loader.load_and_split() 
</code></pre>
<h3 data-id="heading-7">2.2 Document Transformers</h3>
<p>å°†ä¸åŒçš„æ ¼å¼æ–‡ä»¶åŠ è½½è¿›æ¥åï¼Œéœ€è¦å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²ï¼Œåˆ†å‰²çš„è¯ï¼Œæ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚æŒ‰æ®µè½å•¦ï¼Œæˆ–æ˜¯é€šè¿‡ AI è¾…åŠ©ï¼Œå°†å†…å®¹æŒ‰ç›¸è¿‘è¯­ä¹‰è¿›è¡Œåˆ†å‰²å•¦ç­‰ç­‰ï¼Œè¿™é‡Œåªä¸¾ä¾‹æœ€ç®€å•çš„ä¾‹å­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter


<span class="hljs-comment"># å¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†å‰²  </span>
<span class="hljs-comment"># è¿™ä¸ªç±»ï¼Œåªèƒ½å¯¹ç®€å•çš„æ–‡æœ¬è¿›è¡Œåˆ‡å‰²ï¼Œä½†æ˜¯å¯¹å›¾ç‰‡ï¼Œè¡¨æ ¼è¿™ç§ï¼Œæ˜¯åˆ‡åˆ†ä¸äº†çš„  </span>
text_splitter = RecursiveCharacterTextSplitter(  
    <span class="hljs-comment"># chunk çš„å¤§å°  </span>
    chunk_size=<span class="hljs-number">200</span>,  
    <span class="hljs-comment"># é‡å¤çš„å¤§å°  </span>
    chunk_overlap=<span class="hljs-number">100</span>,  
    <span class="hljs-comment"># ç»Ÿè®¡ chunk é•¿åº¦çš„å‡½æ•°</span>
    length_function=<span class="hljs-built_in">len</span>,  
    add_start_index=<span class="hljs-literal">True</span>  
)  
paragraphs = text_splitter.create_documents([  
    page.page_content <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages[:<span class="hljs-number">4</span>]  
])
<span class="hljs-keyword">for</span> para <span class="hljs-keyword">in</span> paragraphs:  
    <span class="hljs-built_in">print</span>(para.page_content)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"</span>)
</code></pre>
<h3 data-id="heading-8">2.3 Text Embedding Models</h3>
<p>å¯¹æ–‡æ¡£è¿›è¡Œåˆ‡å‰²åï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ–‡æœ¬è¿›è¡Œå‘é‡åŒ–è¡¨ç¤ºï¼Œç”¨äºæ£€ç´¢ç­‰æ“ä½œï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨åˆ°ä¸Šé¢è¯´çš„è¯åµŒå…¥æ–¹å¼äº†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings

<span class="hljs-comment"># æˆ‘ä½¿ç”¨çš„æ˜¯ é˜¿é‡Œäº‘ç™¾ç‚¼çš„æ¨¡å‹ï¼Œå¹¶ä¸æ˜¯å®˜æ–¹çš„ openai çš„æ¨¡å‹ã€‚</span>
<span class="hljs-comment"># è°ƒç”¨é OpenAI æ¨¡å‹æ—¶ï¼Œ  </span>
<span class="hljs-comment"># LangChain é»˜è®¤ä¼šå¯¹æ–‡æœ¬è¿›è¡Œ Token åŒ–é¢„å¤„ç†ï¼Œ</span>
<span class="hljs-comment"># å¯¼è‡´å®é™…å‘é€ç»™æ¨¡å‹çš„ä¸æ˜¯åŸå§‹å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ Token åˆ—è¡¨ï¼Œä»è€Œè§¦å‘æ ¼å¼é”™è¯¯  </span>
<span class="hljs-comment"># æ‰€ä»¥è¦åŠ ä¸Š check_embedding_ctx_length=False</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)  
<span class="hljs-built_in">print</span>(embeddings.embed_query(<span class="hljs-string">"ä½ æ˜¯è°ï¼Ÿ"</span>))
</code></pre>
<h3 data-id="heading-9">2.4 Vectorstores</h3>
<p>è·å–åˆ°è¯åµŒå…¥æ¨¡å‹å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªè¯åµŒå…¥æ¨¡å‹ï¼Œå°†ä¹‹å‰åˆ‡åˆ†çš„ chunk åˆ†åˆ«è¿›è¡Œå‘é‡åŒ–è¡¨ç¤ºï¼Œç„¶åå°†å…¶å…¨éƒ¨å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS

<span class="hljs-comment"># æˆ‘ä»¬å°†å‘é‡å­˜å‚¨åˆ° FAISS æ•°æ®åº“ä¸­</span>
<span class="hljs-comment"># text-embedding-v4 å¯èƒ½å­˜åœ¨å•æ–‡æœ¬å­—ç¬¦æ•°ä¸Šé™ï¼ˆå¦‚ 8192 å­—ç¬¦ï¼‰å’Œæ‰¹é‡å¤§å°é™åˆ¶ï¼ˆå¦‚å•æ¬¡ä¸è¶…è¿‡ 10 æ¡ï¼‰ã€‚  </span>
<span class="hljs-comment"># paragraphs åˆ—è¡¨è‹¥åŒ…å«è¶…é•¿æ–‡æœ¬æˆ–æ‰¹æ¬¡è¿‡å¤§ï¼Œä¼šè¿›ä¸€æ­¥å¼•å‘ç±»ä¼¼é”™è¯¯ï¼Œæ‰€ä»¥é‡‡ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼Œè¿›è¡Œæ‰¹æ¬¡å¤„ç†</span>
BATCH_SIZE = <span class="hljs-number">1</span> <span class="hljs-comment"># æ ¹æ®æ¨¡å‹æ–‡æ¡£è°ƒæ•´  </span>
db = <span class="hljs-literal">None</span>  
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(paragraphs), BATCH_SIZE):  
    batch_docs = paragraphs[i:i+BATCH_SIZE]  
    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:  
        db = FAISS.from_documents(batch_docs, embeddings)  
    <span class="hljs-keyword">else</span>:  
        db.add_documents(batch_docs)
        
<span class="hljs-comment"># å¦‚æœæ²¡æœ‰é™åˆ¶çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä¸€æ­¥æå®š</span>
db = FAISS.from_documents(paragraphs, embeddings)
</code></pre>
<h3 data-id="heading-10">2.5 Retrievers</h3>
<p>å…¨éƒ¨å‘é‡åŒ–åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæé—®äº†ï¼Œæé—®çš„æ—¶å€™ï¼Œä¼šå»å‘é‡åº“ä¸­å»æ£€ç´¢æœ€ç›¸ä¼¼çš„å‘é‡ï¼Œä¸€å—å„¿å‘é€ç»™ LLMsï¼Œè®© LLMs ç»™æˆ‘ä»¬åšæ€»ç»“å½’çº³</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ£€ç´¢ top-3 çš„ç»“æœ  </span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})  
docs = retriever.invoke(<span class="hljs-string">"llama2 æœ‰å¤šå°‘å‚æ•°"</span>)  
  
<span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> docs:  
    <span class="hljs-built_in">print</span>(doc.page_content)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"================"</span>)
</code></pre>
<p>æ­¤æ—¶ï¼Œä¸€ä¸ªç®€å•çš„ RAG å°±å·²ç»å¼€å‘å®Œäº†</p>
<h2 data-id="heading-11">ä¸‰ã€å¯¹è¯å†å²ç®¡ç†</h2>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ä¼šä½¿ç”¨ LangChain å’Œ LLMs è¿›è¡Œäº¤äº’äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ä¹Ÿéœ€è¦æˆ‘ä»¬å»æ³¨æ„ï¼Œå°±æ˜¯å¦‚ä½•ç®¡ç†ç”¨æˆ·å’Œ AI çš„å¯¹è¯å†å²ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„è¿›è¡Œäº†å‡ æ¬¡äº¤äº’ï¼Œå€’ä¹Ÿç½¢äº†ï¼Œå¦‚æœæ˜¯å¥½å‡ åæ¡ï¼Œç™¾æ¡å‘¢ï¼Ÿ</p>
<p>åœ¨ LangChain é‡Œå¯ä»¥ä½¿ç”¨ trim_messages å»ç®¡ç†å†å²å¯¹è¯ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆå£°æ˜ä¸€ä¸ª ChatOpenAI çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å’Œä¸Šé¢çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼Œå»è‡ªå®šä¹‰ä¸€ä¸ª Token çš„è®¡æ•°é€»è¾‘ï¼Œç”¨æ¥ç»Ÿè®¡ AI ç”Ÿæˆäº†å¤šå°‘ Tokenï¼Œä»è€Œå¯ä»¥è®©æˆ‘ä»¬å»å†³å®šï¼Œä»€ä¹ˆæ—¶å€™å»è§¦å‘å¯¹ä¼šè¯å†å²è¿›è¡Œç®¡ç†</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> tiktoken  
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>  
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI

<span class="hljs-keyword">class</span> <span class="hljs-title class_">QwenChatOpenAI</span>(<span class="hljs-title class_ inherited__">ChatOpenAI</span>):  
<span class="hljs-string">"""å¦‚æœä¸è‡ªå®šä¹‰å®ç°çš„è¯ï¼Œä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸æ”¯æŒ"""</span>  
  
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_num_tokens_from_messages</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[BaseMessage], tools=<span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">int</span>:  
    <span class="hljs-string">"""  
    è‡ªå®šä¹‰ qwen3-max çš„ token è®¡æ•°é€»è¾‘  
    æ ¹æ® qwen3-max çš„å®é™… token è§„åˆ™ï¼Œé‡å†™  get_num_tokens_from_messages æ–¹æ³•ã€‚å›½å†…æ¨¡å‹é€šå¸¸ä½¿ç”¨ä¸ GPT å…¼å®¹çš„ BPE ç¼–ç ï¼Œå¯å€ŸåŠ© tiktoken åº“æ¨¡æ‹Ÿè®¡ç®—  
    :param messages:  
    :param tools:  
    :return:  
    """</span>  
    <span class="hljs-comment"># 1. é€‰æ‹©ä¸ qwen3-max å…¼å®¹çš„ç¼–ç æ¨¡å‹ï¼ˆå¦‚ gpt-3.5-turboï¼‰  </span>
    encoding = tiktoken.get_encoding(<span class="hljs-string">"cl100k_base"</span>)  
    <span class="hljs-comment"># 2. æŒ‰æ¨¡å‹è§„åˆ™è®¡ç®—tokenæ•°ï¼ˆå‚è€ƒæ–‡æ¡£ï¼‰  </span>
    num_tokens = <span class="hljs-number">0</span>  
    <span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages:  
    num_tokens += <span class="hljs-number">4</span> <span class="hljs-comment"># æ¯ä¸ªæ¶ˆæ¯å›ºå®šå‰ç¼€ï¼š&lt;|im_start|&gt;role\ncontent&lt;|im_end|&gt;  </span>
    num_tokens += <span class="hljs-built_in">len</span>(encoding.encode(message.content))  
    num_tokens += <span class="hljs-number">2</span> <span class="hljs-comment"># å¯¹è¯ç»“æŸæ ‡è®°  </span>
    <span class="hljs-keyword">return</span> num_tokens  
  
  
llm = QwenChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))
</code></pre>
<p>å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†æ¨¡å‹å¯¹è±¡äº†ï¼Œå†å£°æ˜ä¸€ä¸ªå¤šè½®å¯¹è¯çš„åˆ—è¡¨ï¼Œæ¨¡æ‹Ÿå¯¹è¯å†å²</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> AIMessage, HumanMessage, SystemMessage

messages = [  
    SystemMessage(<span class="hljs-string">"You're a good assistant, you always respond with a joke"</span>),  
    HumanMessage(<span class="hljs-string">"I wonder why it's called langchain"</span>),  
    <span class="hljs-comment"># å¯ä½¿ç”¨è¿™ç§æ¥æŒ‡å®š ID  </span>
    <span class="hljs-comment"># HumanMessage("I wonder why it's called langchain", id="3"),  </span>
    AIMessage(<span class="hljs-string">"Well, I guess they thought 'WordRope' and 'SentenceString' just didn't have the same thing to it!"</span>),  
    <span class="hljs-comment"># HumanMessage("and who is harrison chasing anyways"),  </span>
    <span class="hljs-comment"># å¯ä½¿ç”¨è¿™ç§æ¥æŒ‡å®š name å±æ€§  </span>
    HumanMessage(<span class="hljs-string">"and who is harrison chasing anyways"</span>, name=<span class="hljs-string">"example_user"</span>),  
    <span class="hljs-comment"># AIMessage("Hmm let me think. \n\n Why, he's probably chasing after the last cup of coffee in the office!"),  </span>
    AIMessage(<span class="hljs-string">"Hmm let me think. \n\n Why, he's probably chasing after the last cup of coffee in the office!"</span>,  
    name=<span class="hljs-string">"aaa"</span>),  
    HumanMessage(<span class="hljs-string">"what do you call a speechless parrot"</span>)  
]
</code></pre>
<h3 data-id="heading-12">3.1 trim_messages</h3>
<p>ç°åœ¨å¯ä»¥é€šè¿‡ trim_messages æ¥ç®¡ç†å¯¹è¯ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> trim_messages

<span class="hljs-comment"># åªä¿ç•™æœ€åä¸€æ¬¡å¯¹è¯ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥</span>
<span class="hljs-comment"># result = trim_messages(messages, max_tokens=45, strategy="last", token_counter=llm.get_num_tokens_from_messages)  </span>
result = trim_messages(messages, max_tokens=<span class="hljs-number">45</span>, strategy=<span class="hljs-string">"last"</span>, token_counter=llm)  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<p>ä¸Šé¢çš„æ¡ˆä¾‹å¯ä»¥è·‘è·‘çœ‹ï¼Œæœ‰äº†å¤§æ¦‚çš„å½±å“ï¼Œæ¥ä»‹ç»ä¸‹ trim_messages é‡Œçš„å‚æ•°</p>
<pre><code class="hljs language-python" lang="python">result = trim_messages(messages,  
    <span class="hljs-comment"># å…è®¸çš„æœ€å¤§ token æ€»æ•°  </span>
    <span class="hljs-comment"># é™åˆ¶ messages åˆ—è¡¨çš„æ€» token æ•°ä¸Šé™ï¼Œè¶…è¿‡æ­¤å€¼æ—¶è§¦å‘æˆªæ–­é€»è¾‘  </span>
    max_tokens=<span class="hljs-number">45</span>, 
    <span class="hljs-comment"># æˆªæ–­ç­–ç•¥  </span>
    <span class="hljs-comment"># å†³å®šå¦‚ä½•ä¿ç•™æ¶ˆæ¯ä»¥æ»¡è¶³ max_tokens é™åˆ¶ï¼Œé»˜è®¤å€¼å¸¸ä¸º "last"ï¼ˆä¿ç•™æœ€æ–°æ¶ˆæ¯ï¼‰ã€‚  </span>
    strategy=<span class="hljs-string">"last"</span>,  
    <span class="hljs-comment"># token è®¡æ•°å·¥å…·  </span>
    <span class="hljs-comment"># è´Ÿè´£è®¡ç®—å•æ¡/å¤šæ¡æ¶ˆæ¯çš„ token æ•°é‡ï¼Œç¡®ä¿æˆªæ–­åæ€» token ä¸¥æ ¼æ§åˆ¶åœ¨ max_tokens å†…ã€‚  </span>
    token_counter=llm,  
    <span class="hljs-comment"># æ˜¯å¦ ä¿ç•™ç³»ç»Ÿæç¤ºæ¶ˆæ¯  </span>
    include_system=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># å½“å•æ¡æ¶ˆæ¯è¿‡é•¿ï¼ˆå¦‚è¶…é•¿ç”¨æˆ·è¾“å…¥ï¼‰æ—¶ï¼Œæ˜¯å¦å…è®¸ æˆªæ–­è¯¥æ¶ˆæ¯æœ¬èº«ï¼ˆè€Œéæ•´æ®µä¸¢å¼ƒï¼‰  </span>
    <span class="hljs-comment"># Trueï¼ˆé»˜è®¤ï¼‰ï¼šæˆªå–æ¶ˆæ¯çš„å‰ N ä¸ª tokensï¼ˆä¿ç•™éƒ¨åˆ†å†…å®¹ï¼‰  </span>
    <span class="hljs-comment"># âŒ åŸæ¶ˆæ¯ï¼š"è¿™æ˜¯ä¸€æ®µ 100 tokens çš„è¶…é•¿æ–‡æœ¬..."  </span>
    <span class="hljs-comment"># âœ… æˆªæ–­åï¼š"è¿™æ˜¯ä¸€æ®µ 30 tokens çš„è¶…..."ï¼ˆå‡è®¾å‰©ä½™ tokens ä»… 30ï¼‰  </span>
    <span class="hljs-comment"># Falseï¼šè‹¥å•æ¡æ¶ˆæ¯ tokens &gt; max_tokensï¼Œç›´æ¥ä¸¢å¼ƒæ•´æ¡æ¶ˆæ¯ï¼ˆå¯èƒ½ä¸¢å¤±å…³é”®ä¿¡æ¯ï¼‰  </span>
    allow_partial=<span class="hljs-literal">True</span>)  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h3 data-id="heading-13">3.2 filter_messages</h3>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ filter_messages å»è¿‡æ»¤å¸¦æ ‡è¯†çš„å†å²ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> filter_messages

<span class="hljs-comment"># include_types ç”¨äº æŒ‡å®šéœ€è¦ä¿ç•™çš„æ¶ˆæ¯ç±»å‹ï¼Œä¸ç¬¦åˆç±»å‹çš„æ¶ˆæ¯ä¼šè¢«è¿‡æ»¤æ‰  </span>
<span class="hljs-comment"># æ”¯æŒ å­—ç¬¦ä¸²ï¼ˆå•ä¸ªç±»å‹ï¼‰æˆ– åˆ—è¡¨ï¼ˆå¤šä¸ªç±»å‹ï¼‰ï¼Œä¾‹å¦‚ include_types=["human", "ai"] ä¼šåŒæ—¶ä¿ç•™äººç±»å’ŒAIçš„æ¶ˆæ¯  </span>
result = filter_messages(messages, include_types=<span class="hljs-string">"human"</span>)

<span class="hljs-comment"># exclude_names ç”¨äº æŒ‡å®šéœ€è¦æ’é™¤çš„å‘é€è€…åç§°ï¼ŒåŒ¹é…åç§°çš„æ¶ˆæ¯ä¼šè¢«è¿‡æ»¤æ‰  </span>
<span class="hljs-comment"># ["example_user", "example_assistant"]ï¼šæ’é™¤åç§°ä¸ºâ€œç¤ºä¾‹ç”¨æˆ·â€å’Œâ€œç¤ºä¾‹åŠ©æ‰‹â€çš„æ¶ˆæ¯ï¼ˆé€šå¸¸ç”¨äºè¿‡æ»¤æ¼”ç¤ºæ•°æ®æˆ–æµ‹è¯•æ¶ˆæ¯ï¼‰ã€‚  </span>
<span class="hljs-comment"># åç§°åŒ¹é…åŒºåˆ†å¤§å°å†™ï¼ˆå¦‚ Example_User ä¸ example_user è§†ä¸ºä¸åŒåç§°ï¼‰  </span>
<span class="hljs-comment"># ç­›é€‰é€»è¾‘ï¼šéå† messagesï¼Œæ’é™¤ name å±æ€§åœ¨ exclude_names åˆ—è¡¨ä¸­çš„æ¶ˆæ¯ï¼Œä¿ç•™å…¶ä»–æ‰€æœ‰æ¶ˆæ¯ã€‚  </span>
result = filter_messages(messages, exclude_names=[<span class="hljs-string">"example_user"</span>, <span class="hljs-string">"example_assistant"</span>])

<span class="hljs-comment"># exclude_ids  </span>
<span class="hljs-comment"># æ’é™¤ æŒ‡å®šå”¯ä¸€ID çš„æ¶ˆæ¯ã€‚id é€šå¸¸æ˜¯æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¦‚UUIDæˆ–è‡ªå¢ç¼–å·ï¼‰ï¼Œç”¨äºç²¾å‡†å®šä½å•æ¡æ¶ˆæ¯  </span>
result = filter_messages(messages, include_types=[HumanMessage, AIMessage], exclude_ids=[<span class="hljs-string">"3"</span>])
</code></pre>
<h3 data-id="heading-14">3.3 å­˜å‚¨å¯¹è¯å†å²</h3>
<p>ä¸Šé¢è¯´åˆ°çš„æ–¹æ³•ï¼Œéƒ½æ˜¯å¯¹å¯¹è¯å†å²è¿›è¡Œè£å‰ªã€è¿‡æ»¤ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å°†å¯¹è¯å†å²è¿›è¡Œå­˜å‚¨</p>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ redisï¼Œmongodb è¿™ç§ç¼“å­˜æ•°æ®åº“ï¼Œä½†æ˜¯æ¨èä½¿ç”¨ redisã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ sqlite è¿›è¡Œä¸€ä¸ªç®€å•çš„ä¸¾ä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡ session id æ¥åŒºåˆ†å¯¹è¯å†å²ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ° sqlite ä¸­</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_session_history</span>(<span class="hljs-params">session_id</span>):  
    <span class="hljs-comment"># é€šè¿‡ session_id åŒºåˆ†å¯¹è¯å†å²ï¼Œå¹¶å­˜å‚¨åœ¨ sqlite æ•°æ®åº“ä¸­  </span>
    <span class="hljs-comment"># SQLiteæ˜¯æ–‡ä»¶å‹æ•°æ®åº“ï¼ŒPythonæ ‡å‡†åº“å·²å†…ç½®åŸºç¡€æ”¯æŒï¼Œé€šè¿‡sqlalchemyå³å¯ç›´æ¥æ“ä½œï¼Œæ— éœ€é¢å¤–éƒ¨ç½²æœåŠ¡  </span>
    <span class="hljs-comment"># LangChainé€šè¿‡å®ƒå®ç°ä¸SQLiteçš„è¿æ¥å’Œæ“ä½œ  </span>
    <span class="hljs-keyword">return</span> SQLChatMessageHistory(session_id, <span class="hljs-string">"sqlite:///memory.db"</span>)
</code></pre>
<p>å£°æ˜ LLMs å¯¹è±¡ï¼Œå¹¶æ„å»ºä¸€ä¸ªç®€å•çš„ lcel å¯¹è±¡ï¼ˆåé¢ä¼šè¯´åˆ°ï¼Œå°±æ˜¯ä¸€ä¸ªé“¾å¼è°ƒç”¨ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

model = ChatOpenAI(model=<span class="hljs-string">"qwen-plus"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  
base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>), temperature=<span class="hljs-number">0</span>)

runnable = model | StrOutputParser()
</code></pre>
<p>æ„å»ºç®¡ç†å†å²å¯¹è¯çš„ runnableï¼ˆè¯¥å¯¹è±¡é™¤äº†å¯ä»¥æ­£å¸¸è°ƒç”¨å¤–ï¼Œè¿˜å¯ä»¥ä¼ å…¥å¯¹åº”çš„é…ç½®ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables.history <span class="hljs-keyword">import</span> RunnableWithMessageHistory

runnable_width_history = RunnableWithMessageHistory(  
    runnable,  
    <span class="hljs-comment"># æŒ‡å®šè‡ªå®šä¹‰çš„å†å²ç®¡ç†æ–¹æ³•  </span>
    get_session_history  
)
</code></pre>
<p>ç°åœ¨æ„å»ºå®Œæˆäº†ï¼Œä½¿ç”¨ç®€å•çš„ä¾‹å­æ¥éªŒè¯ä¸‹</p>
<pre><code class="hljs language-python" lang="python">ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘å« JoJoï¼Œä¸­æ–‡åå­—å«å•µå•µ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"jojo"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()  
ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ çŸ¥é“æˆ‘å«ä»€ä¹ˆåå­—å—ï¼Ÿ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"jojo"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()  
ret = runnable_width_history.invoke(  
    [  
        HumanMessage(content=<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘å« JoJoï¼Œä¸­æ–‡åå­—å«å•µå•µ"</span>)  
    ],  
    config={  
        <span class="hljs-string">"configurable"</span>: {  
            <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"test"</span>  
        }  
    }  
)  
<span class="hljs-built_in">print</span>(ret)  
<span class="hljs-built_in">print</span>()
</code></pre>
<h2 data-id="heading-15">å››ã€æ¶æ„å°è£…</h2>
<p>æœ‰äº†ä¸Šé¢çš„çŸ¥è¯†ï¼Œå…¶å® LangChain åŸºæœ¬çš„çŸ¥è¯†éƒ½å·²ç»æŒæ¡äº†ï¼Œè€Œåœ¨æ¶æ„å°è£…é‡Œï¼Œä¸»è¦ä»‹ç»åˆ°ä¸¤ä¸ªä¸œè¥¿ï¼Œåˆ†åˆ«æ˜¯ Chain å’Œ Agent</p>
<h3 data-id="heading-16">4.1 Chain</h3>
<p>Chain å…¶å®å°±æ˜¯ä¸Šé¢è¯´åˆ°çš„ lcelï¼ˆLangChain Expression Languageï¼Œé“¾å¼è°ƒç”¨ï¼‰ï¼Œä¸»è¦æ˜¯å°±æ˜¯å¯¹ä¸€ä¸ªåŠŸèƒ½æˆ–ä¸€ç³»åˆ—é¡ºåºåŠŸèƒ½ç»„åˆ</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨ PromptTemplateï¼ŒLLM å’Œ OutputParser</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough


<span class="hljs-comment"># å®šä¹‰è¾“å‡ºç»“æ„  </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SortEnum</span>(<span class="hljs-built_in">str</span>, Enum):  
    data = <span class="hljs-string">"data"</span>  
    price = <span class="hljs-string">"price"</span>  
  
  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderingEnum</span>(<span class="hljs-built_in">str</span>, Enum):  
    ascend = <span class="hljs-string">"ascend"</span>  
    descend = <span class="hljs-string">"descend"</span>  
  
  
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Semantics</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):  
    name: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(description=<span class="hljs-string">"æµé‡åŒ…åç§°"</span>, default=<span class="hljs-literal">None</span>)  
    price_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)  
    price_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"ä»·æ ¼ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)  
    data_lower: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸‹é™"</span>, default=<span class="hljs-literal">None</span>)  
    data_upper: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(description=<span class="hljs-string">"æµé‡ä¸Šé™"</span>, default=<span class="hljs-literal">None</span>)  
    sort_by: <span class="hljs-type">Optional</span>[SortEnum] = Field(description=<span class="hljs-string">"æŒ‰ä»·æ ¼æˆ–æµé‡æ’åº"</span>, default=<span class="hljs-literal">None</span>)  
    ordering: <span class="hljs-type">Optional</span>[OrderingEnum] = Field(description=<span class="hljs-string">"å‡åºæˆ–é™åºæ’åº"</span>, default=<span class="hljs-literal">None</span>)  
  
  
<span class="hljs-comment"># Prompt æ¨¡æ¿  </span>
prompt = ChatPromptTemplate.from_messages(  
    [  
        (<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªè¯­ä¹‰è§£æå™¨ï¼Œä½ çš„ä»»åŠ¡æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥è§£ææˆ Json è¡¨ç¤ºï¼Œä¸è¦å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚"</span>),  
        (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{text}"</span>)  
    ]  
)

<span class="hljs-comment"># ç›´æ¥è·å–ç»“æœ</span>
structured_llm = llm.with_structured_output(Semantics)  

<span class="hljs-comment"># LCEL è¡¨è¾¾å¼  </span>
<span class="hljs-comment"># æ•°æ®ä»å·¦å¾€å³ä¼ è¾“ï¼Œç±»ä¼¼äº Linux ä¸­çš„ ç®¡é“ å‘½ä»¤</span>
runnable = (  
    {  
        <span class="hljs-comment"># RunnablePassthrough å°†è¾“å…¥æ•°æ®åŸæ ·ä¼ é€’åˆ°ä¸‹æ¸¸æ­¥éª¤ï¼Œè¯´ç™½äº†å°±æ˜¯è·å–è¾“å…¥çš„æ–‡æœ¬ï¼Œå¯ä»¥å°†å…¶ç†è§£ä¸º Python ä¸­çš„ input</span>
        <span class="hljs-string">"text"</span>: RunnablePassthrough()  
    } | prompt | structured_llm  
)  

ret = runnable.invoke(<span class="hljs-string">"ä¸è¶…è¿‡ 100 å…ƒçš„æµé‡å¤§çš„å¥—é¤æœ‰å“ªäº›"</span>)  
<span class="hljs-built_in">print</span>(json.dumps(ret.model_dump(), indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))

<span class="hljs-comment"># æµå¼è¾“å‡º</span>
prompt = PromptTemplate.from_template(<span class="hljs-string">"è®²ä¸ªå…³äº{topic}çš„ç¬‘è¯"</span>)  
runnable = (  
    {  
        <span class="hljs-string">"topic"</span>: RunnablePassthrough()  
    } | prompt | llm | StrOutputParser()  
)  
<span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> runnable.stream(<span class="hljs-string">"å°çŒ«çƒçƒ"</span>):  
    <span class="hljs-built_in">print</span>(s, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
</code></pre>
<p>è€Œä¸”åœ¨é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥æ”¯æŒå·¥å‚æ¨¡å¼ï¼Œå³å¯ä»¥è‡ªç”±é€‰æ‹©è¦æ¨ç†çš„æ¨¡å‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate, HumanMessagePromptTemplate  
<span class="hljs-keyword">from</span> langchain_core.runnables.utils <span class="hljs-keyword">import</span> ConfigurableField  
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser  
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> RunnablePassthrough  
  
<span class="hljs-comment"># æ¨¡å‹1  </span>
llm_max = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  
<span class="hljs-comment"># æ¨¡å‹2  </span>
llm_plus = ChatOpenAI(model=<span class="hljs-string">"qwen-plus"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>), temperature=<span class="hljs-number">0</span>)  
  
<span class="hljs-comment"># é€šè¿‡ configurable_alternatives æŒ‰æŒ‡å®šå­—æ®µé€‰æ‹©æ¨¡å‹  </span>
<span class="hljs-comment"># å°†ä¸¤ä¸ªæ¨¡å‹åŒ…è£…ä¸ºå¯åˆ‡æ¢é€‰é¡¹  </span>
llm = llm_plus.configurable_alternatives(  
    <span class="hljs-comment"># é…ç½®å­—æ®µ IDï¼ˆç”¨äºè¿è¡Œæ—¶åˆ‡æ¢ï¼‰  </span>
    ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"llm"</span>),  
    <span class="hljs-comment"># é»˜è®¤ä½¿ç”¨ qwen3 plus æ¨¡å‹  </span>
    default_key=<span class="hljs-string">"plus"</span>,  
    <span class="hljs-comment"># æ³¨å†Œ qwen3 maxï¼Œé”®åä¸º "max"  </span>
    <span class="hljs-built_in">max</span>=llm_max  
)  
  
<span class="hljs-comment"># prompt æ¨¡æ¿  </span>
prompt = ChatPromptTemplate.from_messages([  
    HumanMessagePromptTemplate.from_template(<span class="hljs-string">"{query}"</span>)  
])  
  
<span class="hljs-comment"># LCEL  </span>
chain = {  
<span class="hljs-string">"query"</span>: RunnablePassthrough()  
} | prompt | llm | StrOutputParser()  
  
<span class="hljs-comment"># è¿è¡Œæ—¶æŒ‡å®š â€œplusâ€ æˆ– â€œmaxâ€  </span>
ret = chain.with_config(configurable={  
    <span class="hljs-comment"># "llm": "plus"  </span>
    <span class="hljs-string">"llm"</span>: <span class="hljs-string">"max"</span>  
}).invoke(<span class="hljs-string">"ä½ å«ä»€ä¹ˆåå­—ï¼Œè¯·è‡ªæˆ‘ä»‹ç»ä¸‹"</span>)  
<span class="hljs-built_in">print</span>(ret)
</code></pre>
<p>è€Œä¸”ä½¿ç”¨é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥ç›´æ¥å®ç°ä¸€ä¸ª RAG</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.embeddings <span class="hljs-keyword">import</span> OpenAIEmbeddings
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> PyMuPDFLoader  
<span class="hljs-keyword">from</span> langchain.text_splitter <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter  
<span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_core.output_parsers <span class="hljs-keyword">import</span> StrOutputParser

<span class="hljs-comment"># åŠ è½½æ–‡æ¡£  </span>
loader = PyMuPDFLoader(<span class="hljs-string">"./resource/2307.09288v2.pdf"</span>)  
pages = loader.load_and_split()

<span class="hljs-comment"># æ–‡æ¡£åˆ‡åˆ†  </span>
text_splitter = RecursiveCharacterTextSplitter(  
    chunk_size=<span class="hljs-number">300</span>,  
    chunk_overlap=<span class="hljs-number">100</span>,  
    length_function=<span class="hljs-built_in">len</span>,  
    add_start_index=<span class="hljs-literal">True</span>  
)  
texts = text_splitter.create_documents(  
    [  
        page.page_content <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> pages[:<span class="hljs-number">1</span>]  
    ]  
)

<span class="hljs-comment"># çŒåº“  </span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"text-embedding-v4"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>),  check_embedding_ctx_length=<span class="hljs-literal">False</span>)  
db = <span class="hljs-literal">None</span>  
<span class="hljs-keyword">for</span> i, text <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(texts):  
    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:  
        db = FAISS.from_documents([text], embeddings)  
    <span class="hljs-keyword">else</span>:  
        db.add_documents([text])
        
<span class="hljs-comment"># æ£€ç´¢ top 2 çš„ç»“æœ  </span>
retriever = db.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">2</span>})

<span class="hljs-comment"># prompt æ¨¡æ¿  </span>
template = <span class="hljs-string">"""  
Answer the question based only on the following context:  
{context}  
  
Questions: {question}  
"""</span>  
prompt = ChatPromptTemplate.from_template(template)

<span class="hljs-comment"># chainï¼Œå…¨éƒ¨å£°æ˜å¥½åï¼Œç›´æ¥å…¨éƒ¨ä¸²è”èµ·æ¥äº†</span>
rag_chain = (  
    {  
        <span class="hljs-string">"question"</span>: RunnablePassthrough(),  
        <span class="hljs-string">"context"</span>: retriever  
    } | prompt | llm | StrOutputParser()  
)  
ret = rag_chain.invoke(<span class="hljs-string">"Llama 2 çš„æœ‰å¤šå°‘å‚æ•°ï¼Ÿ"</span>)  
<span class="hljs-built_in">print</span>(ret)
</code></pre>
<h3 data-id="heading-17">4.2 Agent</h3>
<p>è€Œ Agent å°±æ˜¯æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼Œè‡ªåŠ¨è§„åˆ’æ‰§è¡Œæ­¥éª¤ï¼Œè‡ªåŠ¨é€‰æ‹©æ¯ä¸€æ­¥éœ€è¦çš„å·¥å…·ï¼Œæœ€ç»ˆå®Œæˆç”¨æˆ·æŒ‡å®šçš„åŠŸèƒ½</p>
<p>LangChain å®ç° Agentï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œè¿™ä¸¤ç±»çš„åç§°ï¼Œå®˜æ–¹æ˜¯æ²¡æœ‰è¿™ä¸ªè¯´æ³•çš„ï¼Œåªæ˜¯æˆ‘ç”¨æ¥æ–¹ä¾¿åŒºåˆ†</p>
<h4 data-id="heading-18">4.2.1 ä¼ ç»Ÿæ–¹å¼</h4>
<p>ä½¿ç”¨ AgentTypeï¼Œè¿›è¡ŒæŒ‡å®šï¼Œæç¤ºè¯å†…ç½®ä¸å¯è§</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain_core.tools <span class="hljs-keyword">import</span> StructuredTool, Tool

<span class="hljs-comment"># 1. è·å– Tavily æœç´¢å·¥å…·çš„å®ä¾‹</span>
<span class="hljs-comment"># ä½¿ç”¨ä¹‹å‰è¦é…ç½®å¥½ TAVILY_API_KEY ç¯å¢ƒå˜é‡</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)
<span class="hljs-comment"># ç”±äº TavilySearchResults ç±»æ˜¯ç»§æ‰¿äº† BaseTool åŸºç±»çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å°è£…ä¸€å±‚ï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å¿…é¡»å†å°è£…ä¸€å±‚ï¼Œå¦‚ä½•å°è£…ï¼Œæ¥ä¸‹æ¥ä¼šä¸¾ä¾‹</span>

<span class="hljs-comment"># 2. å®šä¹‰ä¸€ä¸ªè®¡ç®—å·¥å…·</span>
<span class="hljs-comment"># Langchain å°è£…çš„å·¥å…·ç±»ï¼Œå¯ä»¥è¿›è¡Œæ•°å­¦è®¡ç®—ï¼Œè¿™ä¸ªé›†æˆçš„åŸºç±»ä¸æ˜¯ BaseToolï¼Œæ‰€ä»¥å¿…é¡»å¾—åŒ…ä¸€å±‚æ‰è¡Œ  </span>
python_repl = PythonREPL()  
<span class="hljs-comment"># å°è£…çš„è¯ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ Tool</span>
calc_tool = Tool(  
    name=<span class="hljs-string">"calculator"</span>,  
    <span class="hljs-comment"># æŒ‡å®šå…¥å£å‡½æ•°</span>
    func=python_repl.run,  
    description=<span class="hljs-string">"ç”¨äºæ‰§è¡Œæ•°å­¦è®¡ç®—ï¼Œä¾‹å¦‚è®¡ç®—ç™¾åˆ†æ¯”å˜åŒ–"</span>  
)
<span class="hljs-comment"># å¦ä¸€ç§åˆ™æ˜¯ä½¿ç”¨ StructuredTool</span>
calc_tool = StructuredTool.from_function(
    func=python_repl.run,  
    name=<span class="hljs-string">"Search"</span>,  
    description=<span class="hljs-string">"ç”¨äºæ£€ç´¢äº’è”ç½‘ä¸Šçš„ä¿¡æ¯"</span>  
)


<span class="hljs-comment"># 3. å†å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å·¥å…·</span>
<span class="hljs-comment"># è‡ªå®šä¹‰å·¥å…·å‡½æ•°  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">simple_calculator</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:  
    <span class="hljs-string">"""  
    åŸºç¡€æ•°å­¦è®¡ç®—å·¥å…·ï¼Œæ”¯æŒåŠ å‡ä¹˜é™¤å’Œå¹‚è¿ç®—  
    :param expression: æ•°å­¦è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ â€œ3+5â€ æˆ– â€œ2**3â€  
    :return: è®¡ç®—ç»“æœå­—ç¬¦ä¸²æˆ–é”™è¯¯ä¿¡æ¯  
    """</span>  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[å·¥å…·è°ƒç”¨] è®¡ç®—è¡¨è¾¾å¼ï¼š<span class="hljs-subst">{expression}</span>"</span>)  
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"mua ~"</span>)  
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(<span class="hljs-built_in">eval</span>(expression))  
  
  
<span class="hljs-comment"># åŒ…è£…ä¸€ä¸‹ï¼Œä¸€å®šè¦åŒ…å« name å’Œ description</span>
base_cal_tool = Tool(  
    func=simple_calculator,  
    name=<span class="hljs-string">"math_calculator"</span>,  
    description=<span class="hljs-string">"ç”¨äºåŸºç¡€æ•°å­¦è®¡ç®—ï¼Œè¾“å…¥å¿…é¡»æ˜¯çº¯æ•°å­¦è¡¨è¾¾å¼ï¼ˆå¦‚â€œ3+5â€æˆ–â€œ2**3â€è¡¨ç¤ºå¹³æ–¹ï¼‰ï¼Œä¸æ”¯æŒå­—æ¯æˆ–ç‰¹æ®Šç¬¦å·"</span>  
)

<span class="hljs-comment"># 4. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># 5. è·å– Agent å®ä¾‹</span>
<span class="hljs-comment"># å¯ä»¥ä½¿ç”¨ ReAct æ¨¡å‹  </span>
<span class="hljs-comment"># agent = AgentType.ZERO_SHOT_REACT_DESCRIPTION  </span>
<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨ function callï¼Œé€‰æ‹©å…¶ä»–çš„æ¨¡å‹ï¼Œéœ€è¦çœ‹å®˜æ–¹æ–‡æ¡£</span>
agent = AgentType.OPENAI_FUNCTIONS

<span class="hljs-comment"># 6. è·å– AgentExecutor å®ä¾‹  </span>
agent_executor = initialize_agent(
    <span class="hljs-comment"># è¿˜å¯ä»¥ç›´æ¥å»å­˜æ”¾å·¥å…·ç±»ï¼Œå› ä¸ºéƒ½ç»§æ‰¿çš„æ˜¯ä¸€ä¸ªçˆ¶ç±»ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çœç•¥æ‰  </span>
    <span class="hljs-comment"># åŒºåˆ«åœ¨äºï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå¯ä»¥è‡ªå®šä¹‰ nameï¼Œdescription è¿™äº›ï¼Œè€Œä½¿ç”¨è¿™ç§æ–¹å¼åˆ™æ˜¯å·²ç»å†…éƒ¨å†™æ­»ï¼Œä¸èƒ½è‡ªå®šä¹‰äº†  </span>
    <span class="hljs-comment"># name å’Œ description æ˜¯å¿…è¦çš„ï¼Œllm ä¼šæ ¹æ®è¿™äº›æ¥å†³å®šæ˜¯å¦è°ƒç”¨  </span>
    tools=[search, calc_tool, base_cal_tool],  
    llm=llm,  
    agent=agent,  
    <span class="hljs-comment"># æ˜¾ç¤ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯  </span>
    verbose=<span class="hljs-literal">True</span>  
)

<span class="hljs-comment"># 6. é€šè¿‡ AgentExecutor è°ƒç”¨ invokeï¼Œå¾—åˆ°å“åº”  </span>
<span class="hljs-comment"># result = agent_executor.invoke("ç‰¹æ–¯æ‹‰ Model Y çš„è½¦ä»·ï¼Œè¿‘å‡ å¹´æœ‰æ²¡æœ‰é™ä½è¶‹åŠ¿ï¼Ÿ")  </span>
<span class="hljs-comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼å»è°ƒç”¨  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"ç‰¹æ–¯æ‹‰ Model Y çš„è½¦ä»·ï¼Œè¿‘å‡ å¹´æœ‰æ²¡æœ‰é™ä½è¶‹åŠ¿ï¼Ÿ"</span>
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h4 data-id="heading-19">4.2.2 é€šç”¨æ–¹å¼</h4>
<p>ä½¿ç”¨ AgentExecutor æ„é€ æ–¹æ³•ï¼Œå¯ä»¥è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain <span class="hljs-keyword">import</span> hub
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹</span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))

<span class="hljs-comment"># 3. æä¾›æç¤ºè¯æ¨¡æ¿</span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼ï¼Œæ¨èä½¿ç”¨ ChatPromptTemplate  </span>
<span class="hljs-comment"># prompt_template = ChatPromptTemplate.from_messages([  </span>
<span class="hljs-comment"># SystemMessage("ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ AI åŠ©æ‰‹ï¼Œæ ¹æ®ç”¨æˆ·çš„æé—®ï¼Œå¿…è¦æ—¶è°ƒç”¨ Search å·¥å…·ï¼Œä½¿ç”¨äº’è”ç½‘æ£€ç´¢æ•°æ®"),  </span>
<span class="hljs-comment"># # å¦‚æœä½¿ç”¨ HumanMessage ç±»ï¼Œ{input} ä¼šè¢«å½“ä½œçº¯æ–‡æœ¬ï¼Œè€Œééœ€è¦æ›¿æ¢çš„å˜é‡å ä½ç¬¦ï¼Œä¸æ™“å¾—ä¸ºå•¥ï¼Œè¿˜æ˜¯ä¸å¤ªç†Ÿå“‡  </span>
<span class="hljs-comment"># # HumanMessage("{input}"),  </span>
<span class="hljs-comment"># ("human", "{input}"),  </span>
<span class="hljs-comment"># # è¿™ä¸ªå¿…é¡»å£°æ˜ï¼Œç”¨äºå­˜å‚¨å’Œä¼ é€’ Agent çš„æ€è€ƒè¿‡ç¨‹ï¼Œ  </span>
<span class="hljs-comment"># # æ¯”å¦‚åœ¨é“¾å¼è°ƒç”¨å·¥å…·æ—¶ï¼ˆå¦‚å…ˆæœå¤©æ°”å†æ¨èè¡Œç¨‹ï¼‰ï¼Œè¯¥å­—æ®µä¼šä¿ç•™å†å²æ­¥éª¤ï¼Œé¿å…ä¸Šä¸‹æ–‡ä¸¢å¤±ï¼Œä¸ä¼ å…¥ä¼šæŠ¥é”™  </span>
<span class="hljs-comment"># # ä½¿ç”¨ä¸‹é¢è¿™ä¸‰ä¸ªæ–¹å¼å£°æ˜éƒ½æ˜¯å¯ä»¥çš„  </span>
<span class="hljs-comment"># # MessagesPlaceholder(variable_name="agent_scratchpad"),  </span>
<span class="hljs-comment"># # ("system", "{agent_scratchpad}")  </span>
<span class="hljs-comment"># ("placeholder", "{agent_scratchpad}")  </span>
<span class="hljs-comment"># ])  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼ï¼Œæ¨èç›´æ¥ä½¿ç”¨ hubï¼Œæˆ–è€… copy ä¸‹æ¥ï¼Œä½¿ç”¨ PromptTemplateï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›´æ¥å®Œæ•´ç‰ˆçš„ prompt æ¯”åˆ‡å—çš„æ•ˆæœè¦å¥½ä¸€äº›  </span>
<span class="hljs-comment"># ä½¿ç”¨ä¸Šé¢çš„ prompt æ¨¡æ¿ï¼Œä¼šæŠ¥é”™ï¼Œæ˜¾ç¤ºç¼ºå°‘ {'tools', 'tool_names'}ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨ç°æˆçš„ react æ¨¡æ¿  </span>
<span class="hljs-comment"># å› ä¸ºæ‰‹åŠ¨é…ç½®çš„è¯ï¼Œä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå¿…é¡»å¾—åŒ…å« tools tool_names agent_scratchpadï¼Œå¤ªéº»çƒ¦äº†ï¼Œæ‹¼æ¥èµ·æ¥  </span>
prompt_template = hub.pull(<span class="hljs-string">"hwchase17/react"</span>)  
<span class="hljs-built_in">print</span>(prompt_template.input_variables)

<span class="hljs-comment"># 4. è·å– Agent å®ä¾‹</span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼  </span>
<span class="hljs-comment"># agent = create_tool_calling_agent(  </span>
<span class="hljs-comment"># llm=llm,  </span>
<span class="hljs-comment"># prompt=prompt_template,  </span>
<span class="hljs-comment"># tools=[search_tool],  </span>
<span class="hljs-comment"># )  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼  </span>
agent = create_react_agent(  
    llm=llm,  
    prompt=prompt_template,  
    tools=[search_tool],  
)

<span class="hljs-comment"># 5. è·å– AgentExecutor å®ä¾‹</span>
agent_executor = AgentExecutor(  
    agent=agent,  
    tools=[search_tool],  
    verbose=<span class="hljs-literal">True</span>  
)  

<span class="hljs-comment"># 6. é€šè¿‡ AgentExecutor è°ƒç”¨ invoke å¾—åˆ°å“åº”  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æŸ¥è¯¢æ­å·ä¸‹å‘¨çš„å¤©æ°”æƒ…å†µ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<h4 data-id="heading-20">4.2.3 åµŒå…¥è®°å¿†</h4>
<p>åœ¨æ„é€  Agent çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åµŒå…¥è®°å¿†ï¼Œä½œä¸ºä¸€ä¸ªä¼šè¯å»è¿›è¡Œå¯¹è¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼ï¼Œè¿›è¡ŒåµŒå…¥è®°å¿†ï¼Œä»¥ ReAct æ¨¡å¼ä¸ºä¾‹</span>
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain.memory <span class="hljs-keyword">import</span> ConversationBufferMemory

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)  

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  
  
<span class="hljs-comment"># 3. è·å–ä¸€ä¸ªè®°å¿†çš„å®ä¾‹ï¼Œä½¿ç”¨ ConversationBufferMemory æ¥å­˜å‚¨ä¸Šä¸‹æ–‡  </span>
memory = ConversationBufferMemory(  
    <span class="hljs-comment"># æƒ³è¿”å›ä¸€ä¸ªæ¶ˆæ¯  </span>
    return_messages=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># ç”¨æ¥å­˜æ”¾å†å²è®°å½•ï¼Œkey å€¼è¦å’Œ prompt ä¸­çš„è¦ä¿æŒä¸€ç›´  </span>
    memory_key=<span class="hljs-string">"chat_history"</span>  
)  
  
<span class="hljs-comment"># 4. è·å– Agent å®ä¾‹  </span>
<span class="hljs-comment"># è¦æƒ³å­˜å‚¨ä¸Šä¸‹æ–‡å°±ä¸èƒ½ä½¿ç”¨è¿™ä¸ªäº†ï¼Œè¿™é‡Œé¢æ²¡æœ‰ç±»ä¼¼ chat_history çš„å­—æ®µå»å­˜å‚¨ä¸Šä¸‹æ–‡  </span>
<span class="hljs-comment"># agent = AgentType.ZERO_SHOT_REACT_DESCRIPTION  </span>
<span class="hljs-comment"># è¿™ä¸ª Agent å®ä¾‹é‡Œé¢ï¼Œæœ‰ chat_history å­—æ®µï¼Œä¸“é—¨å»å­˜å‚¨ä¸Šä¸‹æ–‡</span>
agent = AgentType.CONVERSATIONAL_REACT_DESCRIPTION  
  
<span class="hljs-comment"># 5. è·å– AgentExecutor  </span>
agent_executor = initialize_agent(  
    agent=agent,  
    llm=llm,  
    tools=[search],  
    memory=memory,  
    verbose=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># Qwen3-Max æ¨¡å‹è¾“å‡ºæ ¼å¼ä¸ CONVERSATIONAL_REACT_DESCRIPTION ä»£ç†æ¨¡æ¿ä¸å…¼å®¹ï¼Œå¯¼è‡´è§£æå™¨æ— æ³•è¯†åˆ«å·¥å…·è°ƒç”¨æŒ‡ä»¤ï¼Œä¸€ç›´æŠ¥é”™ï¼Œéœ€è¦æ·»åŠ è¿™ä¸ª</span>
    handle_parsing_errors=<span class="hljs-literal">True</span>  
)  

<span class="hljs-comment"># 6. æ‰§è¡Œ  </span>
<span class="hljs-comment"># ä½¿ç”¨äºŒæ¬¡å¯¹è¯çš„æ–¹å¼æ¥è¿›è¡Œæµ‹è¯•  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æ­å·æ˜å¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)  
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"å±±è¥¿å‘¢ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ é€šç”¨æ–¹å¼å»åµŒå…¥è®°å¿†</span>
<span class="hljs-keyword">from</span> langchain_openai.chat_models <span class="hljs-keyword">import</span> ChatOpenAI  
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType, create_react_agent, AgentExecutor, create_tool_calling_agent  
<span class="hljs-keyword">from</span> langchain_community.tools.tavily_search <span class="hljs-keyword">import</span> TavilySearchResults
<span class="hljs-keyword">from</span> langchain.memory <span class="hljs-keyword">import</span> ConversationBufferMemory
<span class="hljs-keyword">from</span> langchain <span class="hljs-keyword">import</span> hub

<span class="hljs-comment"># 1. è·å–å·¥å…·å®ä¾‹</span>
search = TavilySearchResults(max_results=<span class="hljs-number">10</span>)

<span class="hljs-comment"># 2. è·å–å¤§è¯­è¨€æ¨¡å‹  </span>
llm = ChatOpenAI(model=<span class="hljs-string">"qwen3-max"</span>, api_key=os.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>),  base_url=os.getenv(<span class="hljs-string">"OPENAI_API_BASE"</span>))  

<span class="hljs-comment"># 3. æä¾›æç¤ºè¯æ¨¡æ¿  </span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼ï¼Œæ¨èä½¿ç”¨ ChatPromptTemplate  </span>
<span class="hljs-comment"># prompt_template = ChatPromptTemplate.from_messages([  </span>
    <span class="hljs-comment"># SystemMessage("ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ AI åŠ©æ‰‹ï¼Œæ ¹æ®ç”¨æˆ·çš„æé—®ï¼Œå¿…è¦æ—¶è°ƒç”¨ Search å·¥å…·ï¼Œä½¿ç”¨äº’è”ç½‘æ£€ç´¢æ•°æ®"),  </span>
    <span class="hljs-comment"># # é¡ºåºä¸å›ºå®šï¼Œä½†æ˜¯æ¨¡æ¿ä¸­å¿…é¡»åŒ…å«è¿™å‡ ä¸ªé”®å€¼</span>
    <span class="hljs-comment"># ("human", "{input}"),  </span>
    <span class="hljs-comment"># ("placeholder", "{agent_scratchpad}"),  </span>
    <span class="hljs-comment"># # å­˜å‚¨ä¸Šä¸‹æ–‡çš„è®°å¿†  </span>
    <span class="hljs-comment"># ("system", "{history}")  </span>
<span class="hljs-comment"># ])  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼ï¼Œæ¨èç›´æ¥ä½¿ç”¨ hubï¼Œæˆ–è€… copy ä¸‹æ¥ï¼Œä½¿ç”¨ PromptTemplate  </span>
prompt_template = hub.pull(<span class="hljs-string">"hwchase17/react-chat"</span>)  
<span class="hljs-built_in">print</span>(prompt_template.input_variables)  

<span class="hljs-comment"># 4. æä¾›è®°å¿†çš„å®ä¾‹</span>
memory = ConversationBufferMemory(  
    return_messages=<span class="hljs-literal">True</span>,  
    <span class="hljs-comment"># è¯¥å€¼è¦ä¸ prompt ä¸­çš„åŒå  </span>
    <span class="hljs-comment"># Function Call æ¨¡å¼  </span>
    <span class="hljs-comment"># memory_key="history"  </span>
    <span class="hljs-comment"># ReAct æ¨¡å¼ï¼Œå› ä¸º prompt ä¸­çš„å˜é‡åä¸º chat_historyï¼Œæ‰€ä»¥è¦è¿›è¡Œæ›¿æ¢ </span>
    memory_key=<span class="hljs-string">"chat_history"</span>  
)

<span class="hljs-comment"># 5. è·å– Agent å®ä¾‹  </span>
<span class="hljs-comment"># ä½¿ç”¨ Function Call æ¨¡å¼  </span>
<span class="hljs-comment"># agent = create_tool_calling_agent(  </span>
<span class="hljs-comment"># llm=llm,  </span>
<span class="hljs-comment"># prompt=prompt_template,  </span>
<span class="hljs-comment"># tools=[search],  </span>
<span class="hljs-comment"># )  </span>
<span class="hljs-comment"># ä½¿ç”¨ ReAct æ¨¡å¼  </span>
agent = create_react_agent(  
    llm=llm,  
    prompt=prompt_template,  
    tools=[search],  
)  

<span class="hljs-comment"># 6. è·å– AgentExecutor å®ä¾‹  </span>
agent_executor = AgentExecutor(  
    agent=agent,  
    tools=[search],  
    verbose=<span class="hljs-literal">True</span>,  
    memory=memory  
)

<span class="hljs-comment"># 7. é€šè¿‡ AgentExecutor è°ƒç”¨ invoke å¾—åˆ°å“åº”  </span>
<span class="hljs-comment"># ä½¿ç”¨äºŒæ¬¡å¯¹è¯çš„æ–¹å¼æ¥è¿›è¡Œæµ‹è¯•  </span>
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"æ­å·æ˜å¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)  
result = agent_executor.invoke({  
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"å±±è¥¿å‘¢ï¼Ÿ"</span>  
})  
<span class="hljs-built_in">print</span>(result)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯]]></title>    <link>https://juejin.cn/post/7585758163435061254</link>    <guid>https://juejin.cn/post/7585758163435061254</guid>    <pubDate>2025-12-21T06:50:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435061254" data-draft-id="7585485074038947846" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T06:50:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java Scannerå®Œå…¨æŒ‡å—ï¼šè®©ç¨‹åºä¸ç”¨æˆ·å¯¹è¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T06:50:58.000Z" title="Sun Dec 21 2025 06:50:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>åœ¨Javaç¼–ç¨‹ä¸­ï¼ŒScannerå°±åƒç¨‹åºçš„"è€³æœµ"ï¼Œè®©ç¨‹åºèƒ½å¤Ÿå¬åˆ°ç”¨æˆ·çš„å£°éŸ³ï¼Œå®ç°çœŸæ­£çš„äº¤äº’å¼ç¨‹åºã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å­¦ä¹ è¿™ä¸ªè®©Javaç¨‹åº"æ´»"èµ·æ¥çš„å…³é”®å·¥å…·ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ScanneråŸºç¡€ï¼šåˆ›å»ºä¸ä½¿ç”¨</h2>
<h3 data-id="heading-1">1.1 å¯¼å…¥å’Œåˆ›å»ºScanner</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ScannerBasic</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šåˆ›å»ºScannerå¯¹è±¡</span>
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨Scanner</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥ä½ çš„åå­—ï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();
        System.out.println(<span class="hljs-string">"ä½ å¥½ï¼Œ"</span> + name + <span class="hljs-string">"ï¼"</span>);
        
        <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šå…³é—­Scannerï¼ˆé‡è¦ï¼ï¼‰</span>
        scanner.close();
    }
}
</code></pre>
<h3 data-id="heading-2">1.2 è¯»å–ä¸åŒç±»å‹çš„æ•°æ®</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReadDifferentTypes</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// è¯»å–æ•´æ•°</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        <span class="hljs-comment">// è¯»å–å°æ•°</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥èº«é«˜ï¼ˆç±³ï¼‰ï¼š"</span>);
        <span class="hljs-type">double</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> scanner.nextDouble();
        
        <span class="hljs-comment">// è¯»å–å­—ç¬¦ä¸²</span>
        scanner.nextLine();  <span class="hljs-comment">// é‡è¦ï¼šå…ˆæ¸…ç©ºç¼“å†²åŒº</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥åŸå¸‚ï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">city</span> <span class="hljs-operator">=</span> scanner.nextLine();
        
        System.out.println(<span class="hljs-string">"å¹´é¾„ï¼š"</span> + age);
        System.out.println(<span class="hljs-string">"èº«é«˜ï¼š"</span> + height);
        System.out.println(<span class="hljs-string">"åŸå¸‚ï¼š"</span> + city);
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-3">äºŒã€æœ€é‡è¦çš„ä¸¤ä¸ªæ–¹æ³•ï¼šnext() vs nextLine()</h2>
<h3 data-id="heading-4">2.1 å…³é”®åŒºåˆ«ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NextVsNextLine</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();  <span class="hljs-comment">// è¿™é‡Œä¼šå‡ºé—®é¢˜ï¼</span>
        System.out.println(<span class="hljs-string">"ä½ å¥½ï¼Œ"</span> + name);
        
        <span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•</span>
        System.out.print(<span class="hljs-string">"\nè¯·é‡æ–°è¾“å…¥å¹´é¾„ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">age2</span> <span class="hljs-operator">=</span> scanner.nextInt();
        scanner.nextLine();  <span class="hljs-comment">// å…³é”®ï¼šæ¸…ç©ºç¼“å†²åŒº</span>
        
        System.out.print(<span class="hljs-string">"è¯·é‡æ–°è¾“å…¥å§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name2</span> <span class="hljs-operator">=</span> scanner.nextLine();
        System.out.println(<span class="hljs-string">"è¿™æ¬¡å¯¹äº†ï¼Œä½ å¥½ï¼Œ"</span> + name2);
        
        scanner.close();
    }
}
</code></pre>
<h3 data-id="heading-5">2.2 è®°å¿†æŠ€å·§</h3>
<ul>
<li><strong>next()</strong> ï¼šè¯»å–ä¸€ä¸ª"å•è¯"ï¼ˆé‡åˆ°ç©ºæ ¼å°±åœæ­¢ï¼‰</li>
<li><strong>nextLine()</strong> ï¼šè¯»å–æ•´è¡Œï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</li>
<li><strong>é‡è¦</strong>ï¼šä½¿ç”¨nextInt()ã€nextDouble()ç­‰åï¼Œè¦ç”¨<code>scanner.nextLine()</code>æ¸…ç©ºç¼“å†²åŒº</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€å®æˆ˜åº”ç”¨ï¼šå­¦ç”Ÿæˆç»©è®¡ç®—å™¨</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StudentGradeCalculator</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        System.out.println(<span class="hljs-string">"=== å­¦ç”Ÿæˆç»©è®¡ç®—å™¨ ===\n"</span>);
        
        <span class="hljs-comment">// è¾“å…¥å­¦ç”Ÿä¿¡æ¯</span>
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å­¦ç”Ÿå§“åï¼š"</span>);
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> scanner.nextLine();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥è¯­æ–‡æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">chinese</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥æ•°å­¦æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">math</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        System.out.print(<span class="hljs-string">"è¯·è¾“å…¥è‹±è¯­æˆç»©ï¼š"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">english</span> <span class="hljs-operator">=</span> scanner.nextInt();
        
        scanner.nextLine();  <span class="hljs-comment">// æ¸…ç©ºç¼“å†²åŒº</span>
        
        <span class="hljs-comment">// è®¡ç®—</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> chinese + math + english;
        <span class="hljs-type">double</span> <span class="hljs-variable">average</span> <span class="hljs-operator">=</span> total / <span class="hljs-number">3.0</span>;
        
        <span class="hljs-comment">// è¾“å‡ºç»“æœ</span>
        System.out.println(<span class="hljs-string">"\n=== æˆç»©æŠ¥å‘Š ==="</span>);
        System.out.println(<span class="hljs-string">"å§“åï¼š"</span> + name);
        System.out.println(<span class="hljs-string">"æ€»åˆ†ï¼š"</span> + total);
        System.out.printf(<span class="hljs-string">"å¹³å‡åˆ†ï¼š%.2f\n"</span>, average);
        
        <span class="hljs-comment">// åˆ¤æ–­ç­‰çº§</span>
        <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">90</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šä¼˜ç§€"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">80</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šè‰¯å¥½"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (average &gt;= <span class="hljs-number">60</span>) {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šåŠæ ¼"</span>);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"ç­‰çº§ï¼šä¸åŠæ ¼"</span>);
        }
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-7">å››ã€é”™è¯¯å¤„ç†å’Œè¾“å…¥éªŒè¯</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputValidation</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        
        <span class="hljs-comment">// éªŒè¯å¹´é¾„è¾“å…¥ï¼ˆå¿…é¡»æ˜¯1-100ä¹‹é—´çš„æ•´æ•°ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">boolean</span> <span class="hljs-variable">valid</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">while</span> (!valid) {
            System.out.print(<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„ï¼ˆ1-100ï¼‰ï¼š"</span>);
            
            <span class="hljs-keyword">if</span> (scanner.hasNextInt()) {
                age = scanner.nextInt();
                <span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">1</span> &amp;&amp; age &lt;= <span class="hljs-number">100</span>) {
                    valid = <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">else</span> {
                    System.out.println(<span class="hljs-string">"é”™è¯¯ï¼šå¹´é¾„å¿…é¡»åœ¨1-100ä¹‹é—´ï¼"</span>);
                }
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"é”™è¯¯ï¼šè¯·è¾“å…¥æ•´æ•°ï¼"</span>);
                scanner.next();  <span class="hljs-comment">// æ¸…é™¤é”™è¯¯çš„è¾“å…¥</span>
            }
        }
        
        scanner.nextLine();  <span class="hljs-comment">// æ¸…ç©ºç¼“å†²åŒº</span>
        System.out.println(<span class="hljs-string">"å¹´é¾„éªŒè¯é€šè¿‡ï¼š"</span> + age);
        
        scanner.close();
    }
}
</code></pre>
<h2 data-id="heading-8">äº”ã€æœ€é‡è¦çŸ¥è¯†ç‚¹æ€»ç»“</h2>
<h3 data-id="heading-9">1. æ ¸å¿ƒä¸‰æ­¥éª¤</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å¯¼å…¥</span>
<span class="hljs-keyword">import</span> java.util.Scanner;

<span class="hljs-comment">// 2. åˆ›å»º</span>
<span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);

<span class="hljs-comment">// 3. ä½¿ç”¨</span>
<span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> scanner.nextLine();

<span class="hljs-comment">// 4. å…³é—­ï¼ˆä¸è¦å¿˜ï¼ï¼‰</span>
scanner.close();
</code></pre>
<h3 data-id="heading-10">2. é»„é‡‘æ³•åˆ™</h3>
<ul>
<li><strong>æ··åˆä½¿ç”¨nextXXX()å’ŒnextLine()æ—¶</strong>ï¼šå…ˆç”¨<code>scanner.nextLine()</code>æ¸…ç©ºç¼“å†²åŒº</li>
<li><strong>è¾“å…¥éªŒè¯</strong>ï¼šç”¨<code>hasNextInt()</code>ã€<code>hasNextDouble()</code>æ£€æŸ¥è¾“å…¥ç±»å‹</li>
<li><strong>å…³é—­Scanner</strong>ï¼šç”¨å®Œä¸€å®šè¦å…³é—­ï¼Œé‡Šæ”¾èµ„æº</li>
</ul>
<h3 data-id="heading-11">3. ä¸€å¥è¯è®°ä½</h3>
<p><strong>Scanneræ˜¯Javaç¨‹åºçš„"éº¦å…‹é£"â€”â€”nextXXX()æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼ŒnextLine()æ¸…ç©ºç¼“å†²åŒºï¼Œè®°å¾—ç”¨å®Œè¦å…³é—­ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7585758163435094022</link>    <guid>https://juejin.cn/post/7585758163435094022</guid>    <pubDate>2025-12-21T07:01:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435094022" data-draft-id="7585485074039013382" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-21T07:01:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šå°è£…ã€ç»§æ‰¿ä¸å¤šæ€æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T07:01:40.000Z" title="Sun Dec 21 2025 07:01:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ˜¯Javaçš„æ ¸å¿ƒæ€æƒ³ï¼Œå®ƒè®©ä»£ç æ›´åŠ æ¨¡å—åŒ–ã€å¯é‡ç”¨å’Œæ˜“ç»´æŠ¤ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨OOPçš„ä¸‰å¤§æ”¯æŸ±ï¼šå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ï¼Œè¿™æ˜¯æ¯ä¸ªJavaç¨‹åºå‘˜å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h2 data-id="heading-0">å¼•å…¥ï¼šä¸ºä»€ä¹ˆéœ€è¦é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªæ¸¸æˆç³»ç»Ÿï¼š</p>
<ul>
<li>æ¸¸æˆä¸­æœ‰ç©å®¶ï¼ˆPlayerï¼‰ã€æ•Œäººï¼ˆEnemyï¼‰ã€é“å…·ï¼ˆItemï¼‰ç­‰å¤šç§è§’è‰²</li>
<li>è¿™äº›è§’è‰²éƒ½æœ‰å…±åŒçš„ç‰¹å¾ï¼ˆå¦‚ä½ç½®ã€è¡€é‡ï¼‰ï¼Œä½†ä¹Ÿæœ‰å„è‡ªçš„ç‰¹æ®Šèƒ½åŠ›</li>
<li>å¦‚æœä¸ä½¿ç”¨OOPï¼Œä»£ç ä¼šå˜å¾—æ··ä¹±ä¸å ªï¼Œéš¾ä»¥ç»´æŠ¤</li>
</ul>
<p>ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç°å®ä¸–ç•Œçš„å®ä½“æŠ½è±¡ä¸º"å¯¹è±¡"ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„æ•°æ®å’Œè¡Œä¸ºï¼Œå°±åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œå¯ä»¥çµæ´»ç»„åˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€å°è£…ï¼šä¿æŠ¤æ•°æ®çš„"ä¿é™©ç®±"</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ</h3>
<p><strong>å°è£…</strong>å°±æ˜¯å°†æ•°æ®å’Œå¯¹æ•°æ®çš„æ“ä½œåŒ…è£…åœ¨ä¸€èµ·ï¼Œå¹¶éšè—å®ç°ç»†èŠ‚ã€‚å°±åƒé“¶è¡Œçš„ATMæœºï¼š</p>
<ul>
<li>ä½ åªèƒ½é€šè¿‡ç•Œé¢æŒ‰é’®ï¼ˆå…¬å…±æ–¹æ³•ï¼‰æ“ä½œ</li>
<li>ä¸èƒ½ç›´æ¥æ¥è§¦å†…éƒ¨çš„ç°é‡‘ï¼ˆç§æœ‰æ•°æ®ï¼‰</li>
<li>ATMå†…éƒ¨çš„è¿ä½œæœºåˆ¶å¯¹ä½ éšè—ï¼ˆå®ç°ç»†èŠ‚ï¼‰</li>
</ul>
<h3 data-id="heading-3">1.2 å°è£…çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EncapsulationDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºé“¶è¡Œè´¦æˆ·</span>
        <span class="hljs-type">BankAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankAccount</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"123456"</span>);
        
        <span class="hljs-comment">// âœ… æ­£ç¡®çš„è®¿é—®æ–¹å¼ï¼šé€šè¿‡å…¬å…±æ–¹æ³•</span>
        account.deposit(<span class="hljs-number">1000</span>);      <span class="hljs-comment">// å­˜æ¬¾</span>
        account.withdraw(<span class="hljs-number">500</span>);      <span class="hljs-comment">// å–æ¬¾</span>
        account.displayBalance();   <span class="hljs-comment">// æŸ¥çœ‹ä½™é¢</span>
        
        <span class="hljs-comment">// âŒ é”™è¯¯çš„æ–¹å¼ï¼šç›´æ¥è®¿é—®ç§æœ‰æ•°æ®</span>
        <span class="hljs-comment">// account.balance = 1000000;  // ç¼–è¯‘é”™è¯¯ï¼æ— æ³•ç›´æ¥è®¿é—®</span>
        <span class="hljs-comment">// account.password = "hack";  // ç¼–è¯‘é”™è¯¯ï¼æ— æ³•ç›´æ¥è®¿é—®</span>
        
        System.out.println(<span class="hljs-string">"\nå°è¯•éæ³•æ“ä½œï¼š"</span>);
        account.withdraw(<span class="hljs-number">10000</span>);    <span class="hljs-comment">// ä½™é¢ä¸è¶³ï¼Œå®‰å…¨è¢«æ‹’ç»</span>
        
        System.out.println(<span class="hljs-string">"\nå°è¯•ç ´è§£å¯†ç ï¼š"</span>);
        <span class="hljs-comment">// æ— æ³•ç›´æ¥ä¿®æ”¹å¯†ç ï¼Œåªèƒ½é€šè¿‡éªŒè¯æµç¨‹</span>
        account.changePassword(<span class="hljs-string">"wrong"</span>, <span class="hljs-string">"new123"</span>);  <span class="hljs-comment">// å¤±è´¥</span>
        account.changePassword(<span class="hljs-string">"123456"</span>, <span class="hljs-string">"new123"</span>); <span class="hljs-comment">// æˆåŠŸ</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-comment">// ç§æœ‰å±æ€§ï¼šå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®ï¼ˆå°è£…çš„ç²¾é«“ï¼‰</span>
    <span class="hljs-keyword">private</span> String accountHolder;  <span class="hljs-comment">// è´¦æˆ·æŒæœ‰äºº</span>
    <span class="hljs-keyword">private</span> String password;       <span class="hljs-comment">// å¯†ç </span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> balance;        <span class="hljs-comment">// ä½™é¢</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String accountNumber; <span class="hljs-comment">// è´¦å·ï¼ˆfinalè¡¨ç¤ºä¸å¯å˜ï¼‰</span>
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BankAccount</span><span class="hljs-params">(String holder, String pwd)</span> {
        <span class="hljs-built_in">this</span>.accountHolder = holder;
        <span class="hljs-built_in">this</span>.password = pwd;
        <span class="hljs-built_in">this</span>.balance = <span class="hljs-number">0.0</span>;
        <span class="hljs-built_in">this</span>.accountNumber = generateAccountNumber();
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå­˜æ¬¾</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deposit</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
            balance += amount;
            System.out.println(<span class="hljs-string">"æˆåŠŸå­˜æ¬¾ï¼š"</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
            logTransaction(<span class="hljs-string">"å­˜æ¬¾"</span>, amount);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"å­˜æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
        }
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå–æ¬¾</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">withdraw</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            System.out.println(<span class="hljs-string">"å–æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (amount &gt; balance) {
            System.out.println(<span class="hljs-string">"ä½™é¢ä¸è¶³ï¼å½“å‰ä½™é¢ï¼š"</span> + balance);
        } <span class="hljs-keyword">else</span> {
            balance -= amount;
            System.out.println(<span class="hljs-string">"æˆåŠŸå–æ¬¾ï¼š"</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
            logTransaction(<span class="hljs-string">"å–æ¬¾"</span>, amount);
        }
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šæ˜¾ç¤ºä½™é¢</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayBalance</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"è´¦æˆ·ï¼š"</span> + accountNumber);
        System.out.println(<span class="hljs-string">"æŒæœ‰äººï¼š"</span> + accountHolder);
        System.out.println(<span class="hljs-string">"å½“å‰ä½™é¢ï¼š"</span> + balance + <span class="hljs-string">"å…ƒ"</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šä¿®æ”¹å¯†ç ï¼ˆéœ€è¦éªŒè¯åŸå¯†ç ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">changePassword</span><span class="hljs-params">(String oldPwd, String newPwd)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.password.equals(oldPwd)) {
            <span class="hljs-built_in">this</span>.password = newPwd;
            System.out.println(<span class="hljs-string">"å¯†ç ä¿®æ”¹æˆåŠŸ"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"åŸå¯†ç é”™è¯¯ï¼Œä¿®æ”¹å¤±è´¥"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ï¼šåªèƒ½åœ¨ç±»å†…éƒ¨ä½¿ç”¨ï¼ˆå°è£…çš„å®ç°ç»†èŠ‚ï¼‰</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">generateAccountNumber</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç”Ÿæˆè´¦å·ï¼šæ—¶é—´æˆ³ + éšæœºæ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ACC"</span> + System.currentTimeMillis() % <span class="hljs-number">10000</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logTransaction</span><span class="hljs-params">(String type, <span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-comment">// è®°å½•äº¤æ˜“æ—¥å¿—</span>
        System.out.println(<span class="hljs-string">"[æ—¥å¿—] "</span> + type + <span class="hljs-string">" "</span> + amount + <span class="hljs-string">"å…ƒ"</span>);
    }
    
    <span class="hljs-comment">// Getteræ–¹æ³•ï¼šæä¾›å¯¹ç§æœ‰å±æ€§çš„å—æ§è®¿é—®</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getAccountHolder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> accountHolder;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getBalance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> balance;
    }
    
    <span class="hljs-comment">// æ²¡æœ‰æä¾›passwordçš„getterï¼Œä¿æŠ¤å¯†ç å®‰å…¨</span>
    
    <span class="hljs-comment">// Setteræ–¹æ³•ï¼šæä¾›å¯¹ç§æœ‰å±æ€§çš„å—æ§ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAccountHolder</span><span class="hljs-params">(String holder)</span> {
        <span class="hljs-keyword">if</span> (holder != <span class="hljs-literal">null</span> &amp;&amp; !holder.trim().isEmpty()) {
            <span class="hljs-built_in">this</span>.accountHolder = holder;
        }
    }
}
</code></pre>
<h3 data-id="heading-4">1.3 å°è£…çš„å¥½å¤„</h3>
<ol>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼šé˜²æ­¢å¤–éƒ¨ä»£ç éšæ„ä¿®æ”¹å¯¹è±¡çŠ¶æ€</li>
<li><strong>æ˜“äºç»´æŠ¤</strong>ï¼šå†…éƒ¨å®ç°å¯ä»¥æ”¹å˜è€Œä¸å½±å“å¤–éƒ¨ä»£ç </li>
<li><strong>ä»£ç æ¸…æ™°</strong>ï¼šæ˜ç¡®åŒºåˆ†"å¯ä»¥åšä»€ä¹ˆ"å’Œ"å¦‚ä½•å®ç°"</li>
<li><strong>å‡å°‘è€¦åˆ</strong>ï¼šç±»ä¹‹é—´çš„å…³ç³»æ›´æ¸…æ™°ï¼Œæ›´æ˜“äºä¿®æ”¹</li>
</ol>
<h2 data-id="heading-5">äºŒã€ç»§æ‰¿ï¼šä»£ç å¤ç”¨çš„"åŸºå› ä¼ é€’"</h2>
<h3 data-id="heading-6">2.1 ä»€ä¹ˆæ˜¯ç»§æ‰¿ï¼Ÿ</h3>
<p><strong>ç»§æ‰¿</strong>å…è®¸ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ã€‚å°±åƒç”Ÿç‰©å­¦ä¸­çš„é—ä¼ ï¼š</p>
<ul>
<li>å­©å­ç»§æ‰¿çˆ¶æ¯çš„ç‰¹å¾</li>
<li>ä½†å­©å­ä¹Ÿå¯ä»¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„ç‰¹å¾</li>
<li>ç»§æ‰¿å»ºç«‹äº†ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»</li>
</ul>
<h3 data-id="heading-7">2.2 ç»§æ‰¿çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritanceDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== ç»§æ‰¿ç¤ºä¾‹ï¼šè½¦è¾†ç³»ç»Ÿ ===\n"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºä¸åŒç±»å‹çš„è½¦è¾†</span>
        <span class="hljs-type">Vehicle</span> <span class="hljs-variable">genericVehicle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vehicle</span>(<span class="hljs-string">"é€šç”¨è½¦è¾†"</span>, <span class="hljs-number">2020</span>);
        <span class="hljs-type">Car</span> <span class="hljs-variable">myCar</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">"ä¸°ç”°å¡ç½—æ‹‰"</span>, <span class="hljs-number">2022</span>, <span class="hljs-number">4</span>);
        <span class="hljs-type">Motorcycle</span> <span class="hljs-variable">myBike</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Motorcycle</span>(<span class="hljs-string">"æœ¬ç”°CBR"</span>, <span class="hljs-number">2023</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-type">ElectricCar</span> <span class="hljs-variable">tesla</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElectricCar</span>(<span class="hljs-string">"ç‰¹æ–¯æ‹‰Model 3"</span>, <span class="hljs-number">2023</span>, <span class="hljs-number">4</span>, <span class="hljs-number">75</span>);
        
        <span class="hljs-comment">// å±•ç¤ºå¤šæ€æ€§ï¼šçˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</span>
        Vehicle[] vehicles = {genericVehicle, myCar, myBike, tesla};
        
        <span class="hljs-keyword">for</span> (Vehicle vehicle : vehicles) {
            vehicle.displayInfo();
            vehicle.start();  <span class="hljs-comment">// å¤šæ€ï¼šåŒä¸€ä¸ªæ–¹æ³•ï¼Œä¸åŒè¡Œä¸º</span>
            System.out.println();
        }
        
        <span class="hljs-comment">// è®¿é—®å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"=== å­ç±»ç‰¹æœ‰æ–¹æ³• ==="</span>);
        myCar.openSunroof();
        myBike.doWheelie();
        tesla.chargeBattery();
    }
}

<span class="hljs-comment">// çˆ¶ç±»ï¼šè½¦è¾†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// å—ä¿æŠ¤å±æ€§ï¼šå­ç±»å¯ä»¥è®¿é—®ï¼Œå¤–éƒ¨ä¸èƒ½</span>
    <span class="hljs-keyword">protected</span> String brand;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> year;
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Vehicle</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year)</span> {
        <span class="hljs-built_in">this</span>.brand = brand;
        <span class="hljs-built_in">this</span>.year = year;
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šå¯åŠ¨è½¦è¾†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨å¯åŠ¨..."</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šåœæ­¢è½¦è¾†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" å·²åœæ­¢"</span>);
    }
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•ï¼šæ˜¾ç¤ºä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å“ç‰Œï¼š"</span> + brand);
        System.out.println(<span class="hljs-string">"å¹´ä»½ï¼š"</span> + year);
    }
    
    <span class="hljs-comment">// è®¡ç®—å¹´é¾„</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculateAge</span><span class="hljs-params">(<span class="hljs-type">int</span> currentYear)</span> {
        <span class="hljs-keyword">return</span> currentYear - year;
    }
}

<span class="hljs-comment">// å­ç±»ï¼šæ±½è½¦ï¼ˆç»§æ‰¿Vehicleï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-comment">// å­ç±»ç‰¹æœ‰çš„å±æ€§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> doorCount;
    
    <span class="hljs-comment">// å­ç±»æ„é€ æ–¹æ³•ï¼šä½¿ç”¨superè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Car</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">int</span> doorCount)</span> {
        <span class="hljs-built_in">super</span>(brand, year);  <span class="hljs-comment">// å¿…é¡»é¦–å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</span>
        <span class="hljs-built_in">this</span>.doorCount = doorCount;
    }
    
    <span class="hljs-comment">// é‡å†™çˆ¶ç±»æ–¹æ³•ï¼ˆæ–¹æ³•è¦†ç›–ï¼‰</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ±½è½¦å¯åŠ¨ï¼šé’¥åŒ™è½¬åŠ¨ï¼Œå¼•æ“è½°é¸£ï¼"</span>);
    }
    
    <span class="hljs-comment">// å­ç±»ç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openSunroof</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" çš„å¤©çª—å·²æ‰“å¼€"</span>);
    }
    
    <span class="hljs-comment">// é‡å†™æ˜¾ç¤ºä¿¡æ¯æ–¹æ³•ï¼Œæ·»åŠ å­ç±»ç‰¹æœ‰ä¿¡æ¯</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();  <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"ç±»å‹ï¼šæ±½è½¦"</span>);
        System.out.println(<span class="hljs-string">"è½¦é—¨æ•°é‡ï¼š"</span> + doorCount);
    }
}

<span class="hljs-comment">// å­ç±»ï¼šæ‘©æ‰˜è½¦ï¼ˆç»§æ‰¿Vehicleï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Motorcycle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Vehicle</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> hasSidecar;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Motorcycle</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">boolean</span> hasSidecar)</span> {
        <span class="hljs-built_in">super</span>(brand, year);
        <span class="hljs-built_in">this</span>.hasSidecar = hasSidecar;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ‘©æ‰˜è½¦å¯åŠ¨ï¼šè¸©ä¸‹å¯åŠ¨æ†ï¼Œå¼•æ“å’†å“®ï¼"</span>);
    }
    
    <span class="hljs-comment">// æ‘©æ‰˜è½¦ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWheelie</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨æŠ¬å¤´ç‰¹æŠ€ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.println(<span class="hljs-string">"ç±»å‹ï¼šæ‘©æ‰˜è½¦"</span>);
        System.out.println(<span class="hljs-string">"æ˜¯å¦æœ‰è¾¹è½¦ï¼š"</span> + (hasSidecar ? <span class="hljs-string">"æ˜¯"</span> : <span class="hljs-string">"å¦"</span>));
    }
}

<span class="hljs-comment">// å­ç±»çš„å­ç±»ï¼šç”µåŠ¨æ±½è½¦ï¼ˆç»§æ‰¿Carï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ElectricCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Car</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> batteryCapacity;  <span class="hljs-comment">// ç”µæ± å®¹é‡ï¼ˆåƒç“¦æ—¶ï¼‰</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ElectricCar</span><span class="hljs-params">(String brand, <span class="hljs-type">int</span> year, <span class="hljs-type">int</span> doorCount, <span class="hljs-type">double</span> batteryCapacity)</span> {
        <span class="hljs-built_in">super</span>(brand, year, doorCount);
        <span class="hljs-built_in">this</span>.batteryCapacity = batteryCapacity;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" ç”µåŠ¨æ±½è½¦å¯åŠ¨ï¼šæ— å£°å¯åŠ¨ï¼Œé›¶æ’æ”¾ï¼"</span>);
    }
    
    <span class="hljs-comment">// ç”µåŠ¨æ±½è½¦ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">chargeBattery</span><span class="hljs-params">()</span> {
        System.out.println(brand + <span class="hljs-string">" æ­£åœ¨å……ç”µï¼Œç”µæ± å®¹é‡ï¼š"</span> + batteryCapacity + <span class="hljs-string">"kWh"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();  <span class="hljs-comment">// è°ƒç”¨Carçš„displayInfo</span>
        System.out.println(<span class="hljs-string">"åŠ¨åŠ›ç±»å‹ï¼šç”µåŠ¨"</span>);
        System.out.println(<span class="hljs-string">"ç”µæ± å®¹é‡ï¼š"</span> + batteryCapacity + <span class="hljs-string">"kWh"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8">2.3 ç»§æ‰¿çš„å…³é”®ç‚¹</h3>
<ol>
<li>
<p><strong>superå…³é”®å­—</strong>ï¼šç”¨äºè®¿é—®çˆ¶ç±»çš„å±æ€§ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•</p>
</li>
<li>
<p><strong>æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰</strong> ï¼šå­ç±»é‡æ–°å®ç°çˆ¶ç±»çš„æ–¹æ³•</p>
</li>
<li>
<p><strong>è®¿é—®ä¿®é¥°ç¬¦</strong>ï¼š</p>
<ul>
<li><strong>private</strong>ï¼šåªæœ‰æœ¬ç±»èƒ½è®¿é—®</li>
<li><strong>protected</strong>ï¼šæœ¬ç±»ã€å­ç±»å’ŒåŒåŒ…ç±»èƒ½è®¿é—®</li>
<li><strong>public</strong>ï¼šæ‰€æœ‰ç±»éƒ½èƒ½è®¿é—®</li>
</ul>
</li>
<li>
<p><strong>finalå…³é”®å­—</strong>ï¼š</p>
<ul>
<li><strong>finalç±»</strong>ï¼šä¸èƒ½è¢«ç»§æ‰¿</li>
<li><strong>finalæ–¹æ³•</strong>ï¼šä¸èƒ½è¢«å­ç±»é‡å†™</li>
<li><strong>finalå˜é‡</strong>ï¼šå¸¸é‡ï¼Œä¸èƒ½è¢«ä¿®æ”¹</li>
</ul>
</li>
</ol>
<h2 data-id="heading-9">ä¸‰ã€å¤šæ€ï¼šçµæ´»å¤šå˜çš„"å˜å½¢é‡‘åˆš"</h2>
<h3 data-id="heading-10">3.1 ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ</h3>
<p><strong>å¤šæ€</strong>ï¼ˆPolymorphismï¼‰æ„ä¸º"å¤šç§å½¢æ€"ã€‚åœ¨Javaä¸­ï¼Œå¤šæ€å…è®¸æˆ‘ä»¬ä½¿ç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼ŒåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ä¼šæ ¹æ®å®é™…å¯¹è±¡ç±»å‹äº§ç”Ÿä¸åŒçš„è¡Œä¸ºã€‚</p>
<h3 data-id="heading-11">3.2 å¤šæ€çš„å®ç°ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolymorphismDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¤šæ€ç¤ºä¾‹ï¼šå‡ ä½•å›¾å½¢è®¡ç®— ===\n"</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘ä¸åŒçš„å­ç±»å¯¹è±¡</span>
        Shape[] shapes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Shape</span>[<span class="hljs-number">4</span>];
        
        shapes[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5.0</span>);
        shapes[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">4.0</span>, <span class="hljs-number">6.0</span>);
        shapes[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>, <span class="hljs-number">5.0</span>);
        shapes[<span class="hljs-number">3</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">7.0</span>);
        
        <span class="hljs-comment">// å¤šæ€çš„é­…åŠ›ï¼šåŒä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¸åŒçš„è¡Œä¸º</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">totalArea</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">double</span> <span class="hljs-variable">totalPerimeter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">for</span> (Shape shape : shapes) {
            System.out.println(shape.getShapeName() + <span class="hljs-string">":"</span>);
            System.out.printf(<span class="hljs-string">"  é¢ç§¯: %.2f\n"</span>, shape.calculateArea());
            System.out.printf(<span class="hljs-string">"  å‘¨é•¿: %.2f\n"</span>, shape.calculatePerimeter());
            
            totalArea += shape.calculateArea();
            totalPerimeter += shape.calculatePerimeter();
            
            <span class="hljs-comment">// æ£€æŸ¥å…·ä½“ç±»å‹å¹¶è¿›è¡Œç‰¹æ®Šå¤„ç†</span>
            <span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> Circle) {
                <span class="hljs-type">Circle</span> <span class="hljs-variable">circle</span> <span class="hljs-operator">=</span> (Circle) shape;  <span class="hljs-comment">// å‘ä¸‹è½¬å‹</span>
                System.out.printf(<span class="hljs-string">"  åŠå¾„: %.2f\n"</span>, circle.getRadius());
            }
            
            System.out.println();
        }
        
        System.out.printf(<span class="hljs-string">"æ€»é¢ç§¯: %.2f\n"</span>, totalArea);
        System.out.printf(<span class="hljs-string">"æ€»å‘¨é•¿: %.2f\n"</span>, totalPerimeter);
        
        <span class="hljs-comment">// å¤šæ€åœ¨æ–¹æ³•å‚æ•°ä¸­çš„åº”ç”¨</span>
        System.out.println(<span class="hljs-string">"\n=== å¤šæ€åœ¨æ–¹æ³•å‚æ•°ä¸­çš„åº”ç”¨ ==="</span>);
        displayShapeInfo(shapes[<span class="hljs-number">0</span>]);
        displayShapeInfo(shapes[<span class="hljs-number">1</span>]);
    }
    
    <span class="hljs-comment">// æ–¹æ³•æ¥æ”¶çˆ¶ç±»ç±»å‹å‚æ•°ï¼Œå¯ä»¥æ¥å—ä»»ä½•å­ç±»å¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayShapeInfo</span><span class="hljs-params">(Shape shape)</span> {
        System.out.println(<span class="hljs-string">"å½¢çŠ¶ä¿¡æ¯ï¼š"</span>);
        shape.displayInfo();
        System.out.println();
    }
}

<span class="hljs-comment">// æŠ½è±¡ç±»ï¼šå½¢çŠ¶ï¼ˆä¸èƒ½å®ä¾‹åŒ–ï¼‰</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">protected</span> String color;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.color = <span class="hljs-string">"é»‘è‰²"</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">(String color)</span> {
        <span class="hljs-built_in">this</span>.color = color;
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šå­ç±»å¿…é¡»å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// å…·ä½“æ–¹æ³•ï¼šå­ç±»å¯ä»¥ç»§æ‰¿æˆ–é‡å†™</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å½¢çŠ¶: "</span> + getShapeName());
        System.out.println(<span class="hljs-string">"é¢œè‰²: "</span> + color);
        System.out.printf(<span class="hljs-string">"é¢ç§¯: %.2f\n"</span>, calculateArea());
        System.out.printf(<span class="hljs-string">"å‘¨é•¿: %.2f\n"</span>, calculatePerimeter());
    }
    
    <span class="hljs-comment">// Getterå’ŒSetter</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getColor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> color;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setColor</span><span class="hljs-params">(String color)</span> {
        <span class="hljs-built_in">this</span>.color = color;
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šåœ†å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> radius;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> {
        <span class="hljs-built_in">super</span>();
        <span class="hljs-built_in">this</span>.radius = radius;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius, String color)</span> {
        <span class="hljs-built_in">super</span>(color);
        <span class="hljs-built_in">this</span>.radius = radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Math.PI * radius * radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * Math.PI * radius;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"åœ†å½¢"</span>;
    }
    
    <span class="hljs-comment">// Circleç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getRadius</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> radius;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRadius</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> {
        <span class="hljs-keyword">if</span> (radius &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">this</span>.radius = radius;
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"åŠå¾„: %.2f\n"</span>, radius);
        System.out.printf(<span class="hljs-string">"ç›´å¾„: %.2f\n"</span>, <span class="hljs-number">2</span> * radius);
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šçŸ©å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> width;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> height;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">double</span> width, <span class="hljs-type">double</span> height)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"è“è‰²"</span>);
        <span class="hljs-built_in">this</span>.width = width;
        <span class="hljs-built_in">this</span>.height = height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> width * height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * (width + height);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"çŸ©å½¢"</span>;
    }
    
    <span class="hljs-comment">// Rectangleç‰¹æœ‰çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getWidth</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> width;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getHeight</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> height;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"å®½åº¦: %.2f\n"</span>, width);
        System.out.printf(<span class="hljs-string">"é«˜åº¦: %.2f\n"</span>, height);
    }
}

<span class="hljs-comment">// å…·ä½“ç±»ï¼šä¸‰è§’å½¢</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideA;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideB;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> sideC;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Triangle</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b, <span class="hljs-type">double</span> c)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"ç»¿è‰²"</span>);
        <span class="hljs-built_in">this</span>.sideA = a;
        <span class="hljs-built_in">this</span>.sideB = b;
        <span class="hljs-built_in">this</span>.sideC = c;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateArea</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä½¿ç”¨æµ·ä¼¦å…¬å¼è®¡ç®—ä¸‰è§’å½¢é¢ç§¯</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> (sideA + sideB + sideC) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">return</span> Math.sqrt(s * (s - sideA) * (s - sideB) * (s - sideC));
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculatePerimeter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sideA + sideB + sideC;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getShapeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ä¸‰è§’å½¢"</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.displayInfo();
        System.out.printf(<span class="hljs-string">"è¾¹é•¿: %.2f, %.2f, %.2f\n"</span>, sideA, sideB, sideC);
    }
}
</code></pre>
<h3 data-id="heading-12">3.3 å¤šæ€çš„ä¸¤ç§å½¢å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PolymorphismForms</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å¤šæ€çš„ä¸¤ç§å½¢å¼ ===\n"</span>);
        
        <span class="hljs-comment">// å½¢å¼1ï¼šç¼–è¯‘æ—¶å¤šæ€ï¼ˆæ–¹æ³•é‡è½½ï¼‰</span>
        <span class="hljs-type">Calculator</span> <span class="hljs-variable">calc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>();
        System.out.println(<span class="hljs-string">"åŠ æ³•é‡è½½ç¤ºä¾‹ï¼š"</span>);
        System.out.println(<span class="hljs-string">"ä¸¤ä¸ªæ•´æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>));
        System.out.println(<span class="hljs-string">"ä¸‰ä¸ªæ•´æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>));
        System.out.println(<span class="hljs-string">"ä¸¤ä¸ªå°æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5.5</span>, <span class="hljs-number">3.3</span>));
        System.out.println(<span class="hljs-string">"æ•´æ•°å’Œå°æ•°ç›¸åŠ : "</span> + calc.add(<span class="hljs-number">5</span>, <span class="hljs-number">3.3</span>));
        
        <span class="hljs-comment">// å½¢å¼2ï¼šè¿è¡Œæ—¶å¤šæ€ï¼ˆæ–¹æ³•é‡å†™ï¼‰</span>
        System.out.println(<span class="hljs-string">"\nåŠ¨ç‰©å«å£°ç¤ºä¾‹ï¼š"</span>);
        Animal myAnimal;
        
        <span class="hljs-comment">// è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•</span>
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šæ±ªæ±ªæ±ªï¼</span>
        
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šå–µå–µå–µï¼</span>
        
        myAnimal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
        myAnimal.makeSound();  <span class="hljs-comment">// è¾“å‡ºï¼šå½å½å–³å–³ï¼</span>
        
        <span class="hljs-comment">// å®é™…åº”ç”¨ï¼šå·¥å‚æ¨¡å¼</span>
        System.out.println(<span class="hljs-string">"\n=== å·¥å‚æ¨¡å¼ç¤ºä¾‹ ==="</span>);
        <span class="hljs-type">AnimalFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnimalFactory</span>();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal1</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"dog"</span>);
        animal1.makeSound();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal2</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"cat"</span>);
        animal2.makeSound();
        
        <span class="hljs-type">Animal</span> <span class="hljs-variable">animal3</span> <span class="hljs-operator">=</span> factory.createAnimal(<span class="hljs-string">"bird"</span>);
        animal3.makeSound();
    }
}

<span class="hljs-comment">// ç¼–è¯‘æ—¶å¤šæ€ï¼šæ–¹æ³•é‡è½½</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Calculator</span> {
    <span class="hljs-comment">// åŒä¸€ä¸ªæ–¹æ³•åï¼Œä¸åŒçš„å‚æ•°åˆ—è¡¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> c)</span> {
        <span class="hljs-keyword">return</span> a + b + c;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">double</span> a, <span class="hljs-type">double</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">double</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
}

<span class="hljs-comment">// è¿è¡Œæ—¶å¤šæ€ï¼šæ–¹æ³•é‡å†™</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"åŠ¨ç‰©æ­£åœ¨ç¡è§‰..."</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ±ªæ±ªæ±ªï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fetch</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç‹—ç‹—å¼å›äº†é£ç›˜"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å–µå–µå–µï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scratch</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çŒ«åœ¨æŠ“æ²™å‘"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Bird</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSound</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å½å½å–³å–³ï¼"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"é¸Ÿåœ¨é£ç¿”"</span>);
    }
}

<span class="hljs-comment">// å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å¤šæ€åˆ›å»ºå¯¹è±¡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimalFactory</span> {
    <span class="hljs-keyword">public</span> Animal <span class="hljs-title function_">createAnimal</span><span class="hljs-params">(String type)</span> {
        <span class="hljs-keyword">switch</span> (type.toLowerCase()) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"dog"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"cat"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"bird"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æœªçŸ¥çš„åŠ¨ç‰©ç±»å‹: "</span> + type);
        }
    }
}
</code></pre>
<h3 data-id="heading-13">3.4 å¤šæ€çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>ä»£ç çµæ´»æ€§</strong>ï¼šå¯ä»¥ç¼–å†™æ›´é€šç”¨çš„ä»£ç </li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ·»åŠ æ–°çš„å­ç±»æ—¶ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç </li>
<li><strong>æ¥å£ç»Ÿä¸€</strong>ï¼šä¸åŒå¯¹è±¡å¯ä»¥é€šè¿‡ç»Ÿä¸€æ¥å£æ“ä½œ</li>
<li><strong>è§£è€¦åˆ</strong>ï¼šé™ä½æ¨¡å—é—´çš„ä¾èµ–å…³ç³»</li>
</ol>
<h2 data-id="heading-14">å››ã€ä¸‰å¤§ç‰¹æ€§ç»¼åˆå®æˆ˜ï¼šå‘˜å·¥ç®¡ç†ç³»ç»Ÿ</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.ArrayList;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeManagementSystem</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== å‘˜å·¥ç®¡ç†ç³»ç»Ÿ ===\n"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºå…¬å¸</span>
        <span class="hljs-type">Company</span> <span class="hljs-variable">company</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Company</span>(<span class="hljs-string">"ç§‘æŠ€æ— é™å…¬å¸"</span>);
        
        <span class="hljs-comment">// åˆ›å»ºä¸åŒç±»å‹çš„å‘˜å·¥</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Manager</span>(<span class="hljs-string">"å¼ ç»ç†"</span>, <span class="hljs-number">50000</span>, <span class="hljs-number">20000</span>, <span class="hljs-number">10</span>);
        <span class="hljs-type">Employee</span> <span class="hljs-variable">developer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Developer</span>(<span class="hljs-string">"ç‹ç¨‹åºå‘˜"</span>, <span class="hljs-number">30000</span>, <span class="hljs-string">"Java"</span>, <span class="hljs-number">5</span>);
        <span class="hljs-type">Employee</span> <span class="hljs-variable">sales</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Salesperson</span>(<span class="hljs-string">"æé”€å”®"</span>, <span class="hljs-number">25000</span>, <span class="hljs-number">1000000</span>);
        
        <span class="hljs-comment">// æ·»åŠ å‘˜å·¥åˆ°å…¬å¸</span>
        company.hireEmployee(manager);
        company.hireEmployee(developer);
        company.hireEmployee(sales);
        
        <span class="hljs-comment">// ä¸´æ—¶å·¥</span>
        company.hireEmployee(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intern</span>(<span class="hljs-string">"èµµå®ä¹ ç”Ÿ"</span>, <span class="hljs-number">5000</span>, <span class="hljs-number">6</span>));
        
        <span class="hljs-comment">// å±•ç¤ºæ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span>
        company.displayAllEmployees();
        
        <span class="hljs-comment">// è®¡ç®—æ€»å·¥èµ„æ”¯å‡º</span>
        System.out.println(<span class="hljs-string">"\n=== æœˆåº¦å·¥èµ„æŠ¥å‘Š ==="</span>);
        company.calculateMonthlyPayroll();
        
        <span class="hljs-comment">// å‘˜å·¥å·¥ä½œ</span>
        System.out.println(<span class="hljs-string">"\n=== å‘˜å·¥å·¥ä½œ ==="</span>);
        company.makeEmployeesWork();
        
        <span class="hljs-comment">// æ™‹å‡å‘˜å·¥</span>
        System.out.println(<span class="hljs-string">"\n=== å‘˜å·¥æ™‹å‡ ==="</span>);
        company.promoteEmployee(<span class="hljs-string">"ç‹ç¨‹åºå‘˜"</span>, <span class="hljs-string">"Senior Developer"</span>);
        
        <span class="hljs-comment">// å±•ç¤ºæ™‹å‡åä¿¡æ¯</span>
        company.displayAllEmployees();
    }
}

<span class="hljs-comment">// æŠ½è±¡å‘˜å·¥ç±»</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">protected</span> String name;
    <span class="hljs-keyword">protected</span> <span class="hljs-type">double</span> baseSalary;
    <span class="hljs-keyword">protected</span> String employeeId;
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">nextId</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;  <span class="hljs-comment">// é™æ€å˜é‡ï¼Œç”¨äºç”ŸæˆID</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Employee</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.baseSalary = baseSalary;
        <span class="hljs-built_in">this</span>.employeeId = <span class="hljs-string">"EMP"</span> + nextId++;
    }
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šè®¡ç®—å·¥èµ„ï¼ˆä¸åŒå‘˜å·¥è®¡ç®—æ–¹å¼ä¸åŒï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// æŠ½è±¡æ–¹æ³•ï¼šå·¥ä½œï¼ˆä¸åŒå‘˜å·¥å·¥ä½œå†…å®¹ä¸åŒï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// å…·ä½“æ–¹æ³•ï¼šæ‰€æœ‰å‘˜å·¥å…±äº«</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendMeeting</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ ä¼šè®®"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">takeBreak</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨ä¼‘æ¯"</span>);
    }
    
    <span class="hljs-comment">// æ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ID: "</span> + employeeId);
        System.out.println(<span class="hljs-string">"å§“å: "</span> + name);
        System.out.println(<span class="hljs-string">"èŒä½: "</span> + getPosition());
        System.out.printf(<span class="hljs-string">"åŸºæœ¬å·¥èµ„: Â¥%.2f\n"</span>, baseSalary);
        System.out.printf(<span class="hljs-string">"å®å‘å·¥èµ„: Â¥%.2f\n"</span>, calculateSalary());
    }
    
    <span class="hljs-comment">// è·å–èŒä½åç§°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span>;
    
    <span class="hljs-comment">// Getteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getEmployeeId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> employeeId;
    }
    
    <span class="hljs-comment">// Setteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; !name.trim().isEmpty()) {
            <span class="hljs-built_in">this</span>.name = name;
        }
    }
}

<span class="hljs-comment">// ç»ç†ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Manager</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> bonus;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> teamSize;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Manager</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">double</span> bonus, <span class="hljs-type">int</span> teamSize)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.bonus = bonus;
        <span class="hljs-built_in">this</span>.teamSize = teamSize;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç»ç†å·¥èµ„ = åŸºæœ¬å·¥èµ„ + å¥–é‡‘</span>
        <span class="hljs-keyword">return</span> baseSalary + bonus;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" ç»ç†æ­£åœ¨åˆ¶å®šé¡¹ç›®è®¡åˆ’å’Œåˆ†é…ä»»åŠ¡"</span>);
        System.out.println(<span class="hljs-string">"ç®¡ç†å›¢é˜Ÿå¤§å°: "</span> + teamSize + <span class="hljs-string">"äºº"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ç»ç†"</span>;
    }
    
    <span class="hljs-comment">// ç»ç†ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">conductReview</span><span class="hljs-params">(Employee employee)</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å¯¹å‘˜å·¥ "</span> + employee.getName() + <span class="hljs-string">" è¿›è¡Œç»©æ•ˆè¯„ä¼°"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBonus</span><span class="hljs-params">(<span class="hljs-type">double</span> bonus)</span> {
        <span class="hljs-keyword">if</span> (bonus &gt;= <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">this</span>.bonus = bonus;
        }
    }
}

<span class="hljs-comment">// å¼€å‘äººå‘˜ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Developer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> String programmingLanguage;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> yearsOfExperience;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Developer</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, String language, <span class="hljs-type">int</span> experience)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.programmingLanguage = language;
        <span class="hljs-built_in">this</span>.yearsOfExperience = experience;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¼€å‘äººå‘˜å·¥èµ„ = åŸºæœ¬å·¥èµ„ + ç»éªŒæ´¥è´´ï¼ˆæ¯å¹´ç»éªŒ+5%ï¼‰</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">experienceBonus</span> <span class="hljs-operator">=</span> baseSalary * <span class="hljs-number">0.05</span> * yearsOfExperience;
        <span class="hljs-keyword">return</span> baseSalary + experienceBonus;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" å¼€å‘äººå‘˜æ­£åœ¨ç”¨ "</span> + programmingLanguage + <span class="hljs-string">" ç¼–å†™ä»£ç "</span>);
        System.out.println(<span class="hljs-string">"ç»éªŒ: "</span> + yearsOfExperience + <span class="hljs-string">"å¹´"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼€å‘äººå‘˜ ("</span> + programmingLanguage + <span class="hljs-string">")"</span>;
    }
    
    <span class="hljs-comment">// å¼€å‘äººå‘˜ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debugCode</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨è°ƒè¯•ä»£ç "</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendTechMeeting</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ æŠ€æœ¯ä¼šè®®"</span>);
    }
}

<span class="hljs-comment">// é”€å”®äººå‘˜ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Salesperson</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salesAmount;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Salesperson</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">double</span> salesAmount)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.salesAmount = salesAmount;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// é”€å”®äººå‘˜å·¥èµ„ = åŸºæœ¬å·¥èµ„ + é”€å”®ææˆï¼ˆé”€å”®é¢çš„10%ï¼‰</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">commission</span> <span class="hljs-operator">=</span> salesAmount * <span class="hljs-number">0.10</span>;
        <span class="hljs-keyword">return</span> baseSalary + commission;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" é”€å”®äººå‘˜æ­£åœ¨è”ç³»å®¢æˆ·ï¼Œå®Œæˆé”€å”®ç›®æ ‡"</span>);
        System.out.printf(<span class="hljs-string">"æœ¬æœˆé”€å”®é¢: Â¥%.2f\n"</span>, salesAmount);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"é”€å”®äººå‘˜"</span>;
    }
    
    <span class="hljs-comment">// é”€å”®äººå‘˜ç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeSale</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        salesAmount += amount;
        System.out.println(name + <span class="hljs-string">" å®Œæˆä¸€ç¬”é”€å”®: Â¥"</span> + amount);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attendSalesTraining</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å‚åŠ é”€å”®åŸ¹è®­"</span>);
    }
}

<span class="hljs-comment">// å®ä¹ ç”Ÿç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Intern</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> internshipDuration;  <span class="hljs-comment">// å®ä¹ æ—¶é•¿ï¼ˆæœˆï¼‰</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Intern</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> baseSalary, <span class="hljs-type">int</span> duration)</span> {
        <span class="hljs-built_in">super</span>(name, baseSalary);
        <span class="hljs-built_in">this</span>.internshipDuration = duration;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®ä¹ ç”Ÿåªæœ‰åŸºæœ¬å·¥èµ„ï¼Œæ²¡æœ‰å¥–é‡‘</span>
        <span class="hljs-keyword">return</span> baseSalary;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">work</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" å®ä¹ ç”Ÿæ­£åœ¨å­¦ä¹ å¹¶ååŠ©å®Œæˆç®€å•ä»»åŠ¡"</span>);
        System.out.println(<span class="hljs-string">"å®ä¹ æ—¶é•¿: "</span> + internshipDuration + <span class="hljs-string">"ä¸ªæœˆ"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPosition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"å®ä¹ ç”Ÿ"</span>;
    }
    
    <span class="hljs-comment">// å®ä¹ ç”Ÿç‰¹æœ‰æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">learn</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" æ­£åœ¨å­¦ä¹ æ–°æŠ€èƒ½"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestMentor</span><span class="hljs-params">()</span> {
        System.out.println(name + <span class="hljs-string">" è¯·æ±‚å¯¼å¸ˆæŒ‡å¯¼"</span>);
    }
}

<span class="hljs-comment">// å…¬å¸ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Company</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> ArrayList&lt;Employee&gt; employees;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Company</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.employees = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    }
    
    <span class="hljs-comment">// é›‡ä½£å‘˜å·¥ï¼ˆå¤šæ€ï¼šå¯ä»¥æ¥æ”¶ä»»ä½•Employeeå­ç±»ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hireEmployee</span><span class="hljs-params">(Employee employee)</span> {
        employees.add(employee);
        System.out.println(<span class="hljs-string">"å·²é›‡ä½£: "</span> + employee.getName() + <span class="hljs-string">" ("</span> + employee.getPosition() + <span class="hljs-string">")"</span>);
    }
    
    <span class="hljs-comment">// å±•ç¤ºæ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">displayAllEmployees</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"=== "</span> + name + <span class="hljs-string">" å‘˜å·¥åˆ—è¡¨ ==="</span>);
        System.out.println(<span class="hljs-string">"="</span>.repeat(<span class="hljs-number">50</span>));
        
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            emp.displayInfo();
            System.out.println(<span class="hljs-string">"-"</span>.repeat(<span class="hljs-number">50</span>));
        }
    }
    
    <span class="hljs-comment">// è®¡ç®—æœˆåº¦å·¥èµ„æ”¯å‡º</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">calculateMonthlyPayroll</span><span class="hljs-params">()</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            total += emp.calculateSalary();
        }
        
        System.out.printf(<span class="hljs-string">"å‘˜å·¥æ€»æ•°: %däºº\n"</span>, employees.size());
        System.out.printf(<span class="hljs-string">"æœˆåº¦å·¥èµ„æ€»æ”¯å‡º: Â¥%.2f\n"</span>, total);
        
        <span class="hljs-comment">// æŒ‰èŒä½ç»Ÿè®¡</span>
        System.out.println(<span class="hljs-string">"\næŒ‰èŒä½ç»Ÿè®¡:"</span>);
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            System.out.printf(<span class="hljs-string">"%-20s: Â¥%.2f\n"</span>, 
                emp.getPosition(), emp.calculateSalary());
        }
    }
    
    <span class="hljs-comment">// è®©æ‰€æœ‰å‘˜å·¥å·¥ä½œï¼ˆå¤šæ€ï¼šè°ƒç”¨å„è‡ªçš„å·¥ä½œæ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeEmployeesWork</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            System.out.print(<span class="hljs-string">"&gt; "</span>);
            emp.work();
        }
    }
    
    <span class="hljs-comment">// æ™‹å‡å‘˜å·¥</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">promoteEmployee</span><span class="hljs-params">(String employeeName, String newPosition)</span> {
        <span class="hljs-keyword">for</span> (Employee emp : employees) {
            <span class="hljs-keyword">if</span> (emp.getName().equals(employeeName)) {
                System.out.println(emp.getName() + <span class="hljs-string">" æ™‹å‡ä¸º: "</span> + newPosition);
                
                <span class="hljs-comment">// æ ¹æ®æ™‹å‡è°ƒæ•´å·¥èµ„</span>
                <span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">instanceof</span> Developer) {
                    <span class="hljs-type">Developer</span> <span class="hljs-variable">dev</span> <span class="hljs-operator">=</span> (Developer) emp;
                    System.out.println(<span class="hljs-string">"å·¥èµ„å¢åŠ 20%"</span>);
                    <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­ä¼šæœ‰æ›´å¤æ‚çš„é€»è¾‘</span>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (emp <span class="hljs-keyword">instanceof</span> Manager) {
                    <span class="hljs-type">Manager</span> <span class="hljs-variable">mgr</span> <span class="hljs-operator">=</span> (Manager) emp;
                    System.out.println(<span class="hljs-string">"å¥–é‡‘å¢åŠ 30%"</span>);
                }
                <span class="hljs-keyword">return</span>;
            }
        }
        System.out.println(<span class="hljs-string">"æœªæ‰¾åˆ°å‘˜å·¥: "</span> + employeeName);
    }
}
</code></pre>
<h2 data-id="heading-15">äº”ã€æ€»ç»“ï¼šä¸‰å¤§ç‰¹æ€§çš„æ ¸å¿ƒè¦ç‚¹</h2>
<h3 data-id="heading-16">ğŸ¯ æ ¸å¿ƒè¦ç‚¹æ€»ç»“ï¼š</h3>
<ol>
<li>
<p><strong>å°è£…ï¼ˆEncapsulationï¼‰</strong> ï¼šæŠŠæ•°æ®å’Œè¡Œä¸ºåŒ…è£…åœ¨ç±»ä¸­ï¼Œéšè—å®ç°ç»†èŠ‚</p>
<ul>
<li>ä½¿ç”¨<code>private</code>ä¿æŠ¤æ•°æ®</li>
<li>é€šè¿‡<code>public</code>æ–¹æ³•æä¾›è®¿é—®æ¥å£</li>
<li>å¥½å¤„ï¼šå®‰å…¨æ€§ã€æ˜“ç»´æŠ¤ã€ä½è€¦åˆ</li>
</ul>
</li>
<li>
<p><strong>ç»§æ‰¿ï¼ˆInheritanceï¼‰</strong> ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</p>
<ul>
<li>ä½¿ç”¨<code>extends</code>å…³é”®å­—</li>
<li><code>super</code>è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</li>
<li>æ–¹æ³•é‡å†™ï¼ˆ<code>@Override</code>ï¼‰</li>
<li>å¥½å¤„ï¼šä»£ç å¤ç”¨ã€å»ºç«‹å±‚æ¬¡å…³ç³»</li>
</ul>
</li>
<li>
<p><strong>å¤šæ€ï¼ˆPolymorphismï¼‰</strong> ï¼šåŒä¸€æ¥å£ï¼Œä¸åŒå®ç°</p>
<ul>
<li>ç¼–è¯‘æ—¶å¤šæ€ï¼šæ–¹æ³•é‡è½½</li>
<li>è¿è¡Œæ—¶å¤šæ€ï¼šæ–¹æ³•é‡å†™</li>
<li>çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡</li>
<li>å¥½å¤„ï¼šçµæ´»æ€§ã€æ‰©å±•æ€§ã€è§£è€¦åˆ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-17">ğŸ’¡ å®æˆ˜å»ºè®®ï¼š</h3>
<ol>
<li><strong>åˆç†è®¾è®¡ç±»å±‚æ¬¡</strong>ï¼šä¸è¦è®©ç»§æ‰¿å±‚æ¬¡å¤ªæ·±ï¼ˆé€šå¸¸ä¸è¶…è¿‡3å±‚ï¼‰</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿</strong>ï¼šé™¤éæœ‰æ˜æ˜¾çš„"is-a"å…³ç³»</li>
<li><strong>ä¸ºæ‰©å±•è€Œè®¾è®¡</strong>ï¼šä½¿ç”¨æŠ½è±¡ç±»å’Œæ¥å£å®šä¹‰å¥‘çº¦</li>
<li><strong>éµå®ˆé‡Œæ°æ›¿æ¢åŸåˆ™</strong>ï¼šå­ç±»åº”è¯¥èƒ½å¤Ÿæ›¿æ¢çˆ¶ç±»è€Œä¸å½±å“ç¨‹åºåŠŸèƒ½</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨]]></title>    <link>https://juejin.cn/post/7585502118460473363</link>    <guid>https://juejin.cn/post/7585502118460473363</guid>    <pubDate>2025-12-21T08:10:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585502118460473363" data-draft-id="7585468725333557302" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨"/> <meta itemprop="keywords" content="Python,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-21T08:10:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èµ·é£äº†___"/> <meta itemprop="url" content="https://juejin.cn/user/3298190615395896"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python æ‰¹é‡å‘é‚®ä»¶è„šæœ¬ï¼šExcel åå• + Jinja2 æ¨¡æ¿ï¼Œå¸¦æ—¥å¿—ä¸é˜²é™æµï¼Œ163 é‚®ç®±å®æµ‹å¯ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3298190615395896/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èµ·é£äº†___
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:10:29.000Z" title="Sun Dec 21 2025 08:10:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ–‡ç« ç®€ä»‹</h2>
<p>é—²æ¥æ— äº‹ï¼Œå¸®æœ‹å‹å†™ä¸ªé‚®ä»¶å‘é€è„šæœ¬ï¼Œé¡ºä¾¿æ‹¿æ¥å†™ç¯‡æŠ€æœ¯æ–‡ï¼Œä¸€ä¸¾ä¸¤å¾—ã€‚è„šæœ¬ä»æŒ‡å®šçš„ excel æ–‡ä»¶è¯»å–å®¢æˆ·å§“åã€é‚®ç®±ç­‰ä¿¡æ¯ï¼Œä½¿ç”¨æŒ‡å®šçš„é‚®ä»¶æ¨¡ç‰ˆæ‰¹é‡å‘é€é‚®ä»¶ã€‚ç”±äºæœ‹å‹ä½¿ç”¨æ–‡æœ¬æ¨¡ç‰ˆå°±èƒ½è¾¾æˆè¦æ±‚ï¼Œæ‰€ä»¥è„šæœ¬è™½ç„¶æ”¯æŒ Html é‚®ä»¶æ¨¡ç‰ˆï¼Œä½†å¹¶æœªæµ‹è¯•ã€‚æœ‰è‡ªå®šä¹‰æ ·å¼çš„æœ‹å‹è¿˜éœ€è‡ªè¡Œè°ƒè¯•ä»£ç ã€‚
å¤‡æ³¨ï¼šæœ¬äººæµ‹è¯•æ˜¯ä½¿ç”¨ 163 é‚®ç®±</p>
<h2 data-id="heading-1">ä¾èµ–</h2>
<ul>
<li>yagmail==0.15.293
<ul>
<li>ç”¨æ¥å‘é€é‚®ä»¶</li>
</ul>
</li>
<li>pandas==2.3.1
<ul>
<li>ç”¨æ¥è¯»å– Excel æ–‡ä»¶</li>
</ul>
</li>
<li>jinja2==3.1.6
<ul>
<li>ç”¨æ¥ç¼–å†™ Html æ¨¡ç‰ˆ</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">é…ç½®ä¿¡æ¯</h2>
<ul>
<li>é‚®ç®±é…ç½®
<ul>
<li>passwordï¼šéƒ¨åˆ†é‚®ç®±ï¼ˆå¦‚163ã€QQï¼‰éœ€è¦ä½¿ç”¨æˆæƒç è€Œä¸æ˜¯ç™»å½•å¯†ç ï¼Œè¯·å¤§å®¶æŒ‰éœ€ä»é‚®ç®±è®¾ç½®ä¸­å¼€å¯SMTPæœåŠ¡å¹¶è·å–æˆæƒç ã€‚</li>
<li>hostï¼šå¯¹ä¸åŒçš„é‚®ç®±è¯·ä½¿ç”¨ä¸åŒçš„é‚®ç®±æœåŠ¡å™¨ï¼Œè®°å¾—é€‰æ‹© SMTP é‚®ç®±æœåŠ¡å™¨</li>
<li>portï¼šç«¯å£å·å¯ä½¿ç”¨ 465 ç«¯å£ï¼ˆSSLåŠ å¯†ï¼‰å’Œ 587 ç«¯å£ï¼ˆSTARTTLSï¼‰ï¼Œé¿å…ä½¿ç”¨ 25 ç«¯å£ï¼ˆæ— åŠ å¯†ï¼Œä¸å®‰å…¨ï¼‰</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailConfig</span>:
    <span class="hljs-string">"""
    é‚®ç®±é…ç½®
    """</span>
    <span class="hljs-comment"># ä½ çš„é‚®ç®±</span>
    user: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># é‚®ç®±æˆæƒç </span>
    password: <span class="hljs-built_in">str</span> = <span class="hljs-string">'TXYuclse932VzHJ'</span>
    <span class="hljs-comment"># é‚®ç®±æœåŠ¡å™¨</span>
    host: <span class="hljs-built_in">str</span> = <span class="hljs-string">'smtp.163.com'</span>
    <span class="hljs-comment"># ç«¯å£</span>
    port: <span class="hljs-built_in">int</span> = <span class="hljs-string">'587'</span>
</code></pre>
<ul>
<li>å‘ä»¶äººä¿¡æ¯
<ul>
<li>å‘ä»¶äººä¿¡æ¯æ˜¯ç”¨åœ¨é‚®ä»¶æ¨¡ç‰ˆä¸­çš„ï¼Œå¯æŒ‰éœ€æ·»åŠ ã€åˆ é™¤</li>
<li>get_subjectï¼šåœ¨è¿™é‡Œé…ç½®é€šç”¨çš„é‚®ä»¶ä¸»é¢˜ï¼Œclient æ˜¯ä» excel æ–‡ä»¶ä¸­è¯»å–å‡ºçš„å®¢æˆ·ä¿¡æ¯ï¼Œä½¿ç”¨è¯¥ä¿¡æ¯è¯·å’Œ excel æ–‡ä»¶ä¸­çš„æ ‡é¢˜ä¸€è‡´</li>
<li>to_jsonï¼šè¿”å›çš„æ•°æ®æ˜¯ç”¨åœ¨ Html æ¨¡ç‰ˆä¸­çš„æ•°æ®ï¼Œå¯æŒ‰éœ€æ·»åŠ ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderInfo</span>:
    <span class="hljs-string">"""
    å‘ä»¶äººä¿¡æ¯
    """</span>
    <span class="hljs-comment"># æ˜¾ç¤ºç»™å®¢æˆ·çš„å‘ä»¶äººåç§°</span>
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">'èµ·é£äº†-dev'</span>
    <span class="hljs-comment"># èŒä½</span>
    position: <span class="hljs-built_in">str</span> = <span class="hljs-string">'å¼€å‘äººå‘˜'</span>
    <span class="hljs-comment"># å…¬å¸</span>
    company: <span class="hljs-built_in">str</span> = <span class="hljs-string">'xxxç§‘æŠ€æœ‰é™è´£ä»»å…¬å¸'</span>
    <span class="hljs-comment"># é‚®ç®±</span>
    email: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># ç­¾å</span>
    signature: <span class="hljs-built_in">str</span> = <span class="hljs-string">'ç­¾åæµ‹è¯•'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_subject</span>(<span class="hljs-params">self, client: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-string">"""
        è·å–é‚®ä»¶ä¸»é¢˜
        :param client: å®¢æˆ·ä¿¡æ¯, ä¸å®¢æˆ·ä¿¡æ¯æ–‡ä»¶å†…ä¸€è‡´
        :return: é‚®ä»¶ä¸»é¢˜
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>è‡´<span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>çš„é‚®ä»¶"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_json</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'name'</span>: self.name,
            <span class="hljs-string">'position'</span>: self.position,
            <span class="hljs-string">'company'</span>: self.company,
            <span class="hljs-string">'email'</span>: self.email,
            <span class="hljs-string">'signature'</span>: self.signature
        }
</code></pre>
<ul>
<li>å‘é€è®¾ç½®
<ul>
<li>å‘é€é…ç½®å¯ä»¥è°ƒæ•´é‚®ä»¶çš„å‘é€é€Ÿåº¦ï¼Œé¿å…è¢«é‚®ä»¶æœåŠ¡å™¨é™åˆ¶ï¼Œå°†é‚®ä»¶å½“ä½œåƒåœ¾é‚®ä»¶</li>
<li>delay_between_emailsï¼šæ¯å°é‚®ä»¶ä¹‹é—´çš„é—´éš”æ—¶é—´</li>
<li>test_modeï¼šåœ¨æ¨¡ç‰ˆæµ‹è¯•æ—¶å¯ä»¥å…ˆå°†é‚®ä»¶å‘é€ç»™è‡ªå·±ï¼Œæ£€æŸ¥å®Œæ¯•åå†ç»™å®¢æˆ·å‘é€</li>
<li>max_emails_per_batchï¼šå‘é€é‚®ä»¶æ¯æ¬¡è¾¾åˆ°è¯¥æ•°ç›®æ—¶æš‚åœ 1 åˆ†é’Ÿï¼Œæœ‰å…¶ä»–éœ€æ±‚çš„æœ‹å‹å¯ä»¥è‡ªè¡Œä¿®æ”¹ä»£ç </li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendSettings</span>:
    <span class="hljs-string">"""
    å‘é€è®¾ç½®
    """</span>
    <span class="hljs-comment"># é‚®ä»¶é—´éš”(ç§’)ï¼Œé¿å…è¢«é™åˆ¶</span>
    delay_between_emails: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>
    <span class="hljs-comment"># æµ‹è¯•æ¨¡å¼ï¼ˆåªå‘ç»™è‡ªå·±ï¼‰</span>
    test_mode: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    <span class="hljs-comment"># æ¯æ‰¹æœ€å¤šå‘é€é‡</span>
    max_emails_per_batch: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span>
</code></pre>
<h2 data-id="heading-3">åŠ è½½å®¢æˆ·æ•°æ®</h2>
<ul>
<li>excel æ–‡ä»¶æ ¼å¼















<table><thead><tr><th align="center">index</th><th align="center">name</th><th align="center">email</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">èµ·é£äº†</td><td align="center"><a href="https://link.juejin.cn?target=mailto%3Axxxx%40qq.com" target="_blank" title="mailto:xxxx@qq.com" ref="nofollow noopener noreferrer">xxxx@qq.com</a></td></tr></tbody></table>
</li>
<li>åŠ è½½å®¢æˆ·æ•°æ®æ—¶ä¼šæ£€éªŒå®¢æˆ·å§“åå’Œé‚®ç®±æ˜¯å¦å­˜åœ¨</li>
<li>è¿”å›æ•°æ®ç»“æ„: [{index: 1,name:'èµ·é£äº†', email: '<a href="https://link.juejin.cn?target=mailto%3Axxxx%40qq.com" target="_blank" title="mailto:xxxx@qq.com" ref="nofollow noopener noreferrer">xxxx@qq.com</a>'},{index: 2, name:'', email: ''}]</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_clients</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">dict</span>]:
        <span class="hljs-string">"""åŠ è½½å®¢æˆ·æ•°æ®"""</span>
        df = pd.read_excel(self.client_data_file)
        client_list = df.to_dict(orient=<span class="hljs-string">'records'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client_list:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"å®¢æˆ·æ•°æ®ä¸ºç©º"</span>)
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ ¡éªŒå¹¶æ¸…æ´—</span>
        <span class="hljs-keyword">for</span> client <span class="hljs-keyword">in</span> client_list:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'email'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„é‚®ç®±ä¸ºç©º"</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'name'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„å§“åä¸ºç©º"</span>)
            client[<span class="hljs-string">'name'</span>] = client[<span class="hljs-string">'name'</span>].strip()
            client[<span class="hljs-string">'email'</span>] = client[<span class="hljs-string">'email'</span>].strip()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(client_list)}</span> ä¸ªå®¢æˆ·æ•°æ®"</span>)
        <span class="hljs-keyword">return</span> client_list
</code></pre>
<h2 data-id="heading-4">åŠ è½½æ¨¡ç‰ˆæ•°æ®</h2>
<p>æ¨¡ç‰ˆä»æ–‡ä»¶å†…åŠ è½½</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_template</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åŠ è½½é‚®ä»¶æ¨¡æ¿"""</span>
        template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                template = Template(f.read())
        txt_template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.txt_template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.txt_template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                txt_template = f.read()
        <span class="hljs-keyword">return</span> template, txt_template
</code></pre>
<h2 data-id="heading-5">è½¬æ¢ HTML åˆ°çº¯æ–‡æœ¬</h2>
<p>å¦‚æœåªæŒ‡å®šäº† HTML æ¨¡ç‰ˆï¼Œä¼šä½¿ç”¨è¿™ä¸ªå‡½æ•°è½¬æ¢ä¸€ä»½çº¯æ–‡æœ¬é‚®ä»¶å‡ºæ¥ï¼ŒHTML æ¨¡ç‰ˆæœ¬äººå¹¶æœªæµ‹è¯•ï¼Œæœ‰ç›¸åº”éœ€æ±‚çš„æœ‹å‹å¯è‡ªè¡Œè°ƒè¯•ä»£ç </p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_convert_html_to_text</span>(<span class="hljs-params">self, html</span>):
        <span class="hljs-string">"""
        æ™ºèƒ½è½¬æ¢HTMLåˆ°çº¯æ–‡æœ¬
        ä¿ç•™é‡è¦æ ¼å¼ï¼ˆåˆ—è¡¨ã€æ®µè½ã€å¼ºè°ƒç­‰ï¼‰
        """</span>
        <span class="hljs-comment"># è‡ªå®šä¹‰è½¬æ¢è§„åˆ™</span>
        replacements = [
            (<span class="hljs-string">r'&lt;br\s*/?&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;p.*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/p&gt;'</span>, <span class="hljs-string">''</span>),
            (<span class="hljs-string">r'&lt;li.*?&gt;'</span>, <span class="hljs-string">'â€¢ '</span>),
            (<span class="hljs-string">r'&lt;/li&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;strong.*?&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;/strong&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;em.*?&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;/em&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;h[1-6].*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/h[1-6]&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;[^&gt;]+&gt;'</span>, <span class="hljs-string">''</span>),  <span class="hljs-comment"># ç§»é™¤å…¶ä»–æ‰€æœ‰HTMLæ ‡ç­¾</span>
        ]

        text = html
        <span class="hljs-keyword">for</span> pattern, replacement <span class="hljs-keyword">in</span> replacements:
            text = re.sub(pattern, replacement, text)

        <span class="hljs-comment"># æ¸…ç†å¤šä½™çš„ç©ºè¡Œ</span>
        text = re.sub(<span class="hljs-string">r'\n\s*\n\s*\n'</span>, <span class="hljs-string">'\n\n'</span>, text)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'_convert_html_to_text:<span class="hljs-subst">{text}</span>'</span>)
        <span class="hljs-keyword">return</span> text.strip()
</code></pre>
<h2 data-id="heading-6">é‚®ä»¶å†…å®¹ç»„ç»‡</h2>
<ul>
<li>åœ¨è¿™ä¸ªå‡½æ•°ä¸­å°†æ¨¡ç‰ˆä¸­çš„å ä½ç¬¦æ›¿æ¢ä¸ºæŒ‡å®šæ•°æ®
<ul>
<li>çº¯æ–‡æœ¬æ¨¡ç‰ˆä½¿ç”¨ {client_key} ç»“æ„çš„å‚æ•°ä½œä¸ºå®¢æˆ·ä¿¡æ¯å ä½ç¬¦</li>
<li>{sender_key}ä¸ºå‘é€è€…ä¿¡æ¯å ä½ç¬¦</li>
<li>å…¶ä¸­ key æ˜¯å®¢æˆ· excel æ–‡ä»¶æ ‡é¢˜å’Œé…ç½®ä¸­ SenderInfo å¯¹è±¡ to_json å‡½æ•°è¿”å›çš„å¯¹è±¡ key</li>
</ul>
</li>
<li>Html æ¨¡ç‰ˆå†…å®¹æ›¿æ¢æ–¹å¼è¯·ç§»æ­¥å­¦ä¹  jinja2 åº“</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">personalize_content</span>(<span class="hljs-params">self, client, template, txt_template: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""ä¸ªæ€§åŒ–é‚®ä»¶å†…å®¹"""</span>

        html_content = template.render(client=client, sender=self.sender_info.to_json()) <span class="hljs-keyword">if</span> template <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

        <span class="hljs-keyword">if</span> txt_template:
            txt_content = txt_template
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> client.keys():
                txt_content = txt_content.replace(<span class="hljs-string">'{client_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(client[key]))
            sender_json = self.sender_info.to_json()
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> sender_json:
                txt_content = txt_content.replace(<span class="hljs-string">'{sender_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(sender_json[key]))
        <span class="hljs-keyword">else</span>:
            txt_content = self._convert_html_to_text(html_content)

        <span class="hljs-keyword">return</span> html_content, txt_content
</code></pre>
<h2 data-id="heading-7">å‘é€é‚®ä»¶</h2>
<p>è¿™éƒ¨åˆ†æ˜¯é‚®ä»¶å‘é€çš„æ ¸å¿ƒä»£ç ï¼Œé‚®ä»¶ä¸»é¢˜ä» SenderInfo é…ç½®ä¸­è·å–ï¼Œå®ç°ç»Ÿä¸€é…ç½®ã€‚
å‘é€æˆåŠŸæˆ–å¤±è´¥éƒ½è¦è®°å½•æ—¥å¿—ï¼Œå·²å¤‡åç»­æŸ¥çœ‹ã€æ ¸å¯¹</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_to_client</span>(<span class="hljs-params">self, client, content</span>):
        <span class="hljs-string">"""å‘é€ç»™å•ä¸ªå®¢æˆ·"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºé‚®ä»¶</span>
            subject = self.sender_info.get_subject(client=client)

            <span class="hljs-comment"># å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œå‘ç»™è‡ªå·±</span>
            to_email = client[<span class="hljs-string">'email'</span>]
            <span class="hljs-keyword">if</span> self.send_settings.test_mode:
                to_email = self.email_config.user
                subject = <span class="hljs-string">f"[æµ‹è¯•] <span class="hljs-subst">{subject}</span>"</span>

            <span class="hljs-comment"># å‘é€</span>
            self.yag.send(
                to=to_email,
                subject=subject,
                contents=content,
                <span class="hljs-comment"># attachments=['attachments/sample.pdf'],  # å¯é€‰é™„ä»¶</span>
                headers={
                    <span class="hljs-comment"># 'X-Priority': '1',  #  é«˜ä¼˜å…ˆçº§ âš ï¸ï¼ˆæ˜¾ç¤ºæ„Ÿå¹å·ï¼‰</span>
                    <span class="hljs-string">'X-Priority'</span>: <span class="hljs-string">'3'</span>,  <span class="hljs-comment"># æ™®é€šä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼Œä¸æ˜¾ç¤ºç‰¹æ®Šæ ‡è®°ï¼‰</span>
                    <span class="hljs-comment"># 'X-Priority': '5',  # ä½ä¼˜å…ˆçº§</span>
                    <span class="hljs-string">'X-Mailer'</span>: <span class="hljs-string">'PersonalEmailSender'</span>
                }
            )

            <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
            log_entry = {
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'æˆåŠŸ'</span>
            }
            self.sent_log.append(log_entry)

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ å·²å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span> &lt;<span class="hljs-subst">{client[<span class="hljs-string">'email'</span>]}</span>&gt;"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— å‘é€å¤±è´¥ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>: <span class="hljs-subst">{e}</span>"</span>)
            self.sent_log.append({
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">f'å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>'</span>
            })
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h2 data-id="heading-8">å­˜å‚¨æ—¥å¿—</h2>
<p>è¿è¡Œå®Œæ¯•å°†æ—¥å¿—å†™å…¥æ–‡ä»¶</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_log</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¿å­˜å‘é€è®°å½•"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.sent_log:
            <span class="hljs-keyword">return</span>

        log_df = pd.DataFrame(self.sent_log)
        timestamp = datetime.now().strftime(<span class="hljs-string">'%Y%m%d_%H%M%S'</span>)
        log_file = <span class="hljs-string">f'sent_logs/sent_<span class="hljs-subst">{timestamp}</span>.csv'</span>

        <span class="hljs-comment"># ç¡®ä¿ç›®å½•å­˜åœ¨</span>
        os.makedirs(<span class="hljs-string">'sent_logs'</span>, exist_ok=<span class="hljs-literal">True</span>)

        log_df.to_csv(log_file, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ“‹ å‘é€è®°å½•å·²ä¿å­˜: <span class="hljs-subst">{log_file}</span>"</span>)
</code></pre>
<h2 data-id="heading-9">åŠŸèƒ½ç»„åˆåçš„ä¸»è¿è¡Œå‡½æ•°</h2>
<p>åœ¨æ­¤å¤„æ•´åˆä»¥ä¸Šä»‹ç»çš„å„éƒ¨åˆ†åŠŸèƒ½ã€‚</p>
<ul>
<li>æµç¨‹ï¼šåŠ è½½å®¢æˆ· --&gt; åŠ è½½æ¨¡ç‰ˆ --&gt; åˆ†åˆ«ä¸ºå®¢æˆ·ç”Ÿæˆé‚®ä»¶å†…å®¹ --&gt; å†…å®¹æ ¡éªŒ --&gt; å‘é€é‚®ä»¶ --&gt; å‘é€å»¶è¿Ÿ --&gt; ä¿å­˜æ—¥å¿— --&gt; å‘é€ç»“æŸ</li>
</ul>
<pre><code class="hljs language-python" lang="python">
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¸»è¿è¡Œå‡½æ•°"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹å‘é€ä¸ªæ€§åŒ–é‚®ä»¶...\n"</span>)

        <span class="hljs-comment"># åŠ è½½æ•°æ®</span>
        client_list = self.load_clients()
        template, txt_template = self.load_template()

        sent_count = <span class="hljs-number">0</span>
        total_clients = <span class="hljs-built_in">len</span>(client_list)

        <span class="hljs-keyword">for</span> i, client <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(client_list, <span class="hljs-number">1</span>):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[<span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_clients}</span>] å¤„ç†: <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)

            <span class="hljs-comment"># ä¸ªæ€§åŒ–å†…å®¹</span>
            html_content, text_content = self.personalize_content(client, template, txt_template)

            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> text_content:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— æ— å†…å®¹å¯å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)
                <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
                log_entry = {
                    <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                    <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                    <span class="hljs-string">'status'</span>: <span class="hljs-string">'å¤±è´¥'</span>,
                    <span class="hljs-string">'åŸå› '</span>: <span class="hljs-string">'æ— å†…å®¹'</span>
                }
                self.sent_log.append(log_entry)
                <span class="hljs-keyword">continue</span>

            content = [text_content, html_content] <span class="hljs-keyword">if</span> html_content <span class="hljs-keyword">else</span> text_content
            <span class="hljs-comment"># å‘é€</span>
            <span class="hljs-keyword">if</span> self.send_to_client(client, content):
                sent_count += <span class="hljs-number">1</span>

            <span class="hljs-comment"># å»¶è¿Ÿï¼Œé¿å…è¢«é™åˆ¶</span>
            <span class="hljs-keyword">if</span> i &lt; total_clients:
                delay = self.send_settings.delay_between_emails
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­‰å¾… <span class="hljs-subst">{delay}</span> ç§’..."</span>)
                time.sleep(delay)

            <span class="hljs-comment"># åˆ†æ‰¹æš‚åœï¼ˆå¦‚æœå‘é€é‡å¤§ï¼‰</span>
            <span class="hljs-keyword">if</span> i % self.send_settings.max_emails_per_batch == <span class="hljs-number">0</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå·²å‘é€ <span class="hljs-subst">{i}</span> å°ï¼Œæš‚åœ 60 ç§’..."</span>)
                time.sleep(<span class="hljs-number">60</span>)

        <span class="hljs-comment"># ä¿å­˜æ—¥å¿—</span>
        self.save_log()

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nâœ… å®Œæˆï¼æˆåŠŸå‘é€ <span class="hljs-subst">{sent_count}</span>/<span class="hljs-subst">{total_clients}</span> å°é‚®ä»¶"</span>)

        <span class="hljs-comment"># å…³é—­è¿æ¥</span>
        <span class="hljs-keyword">if</span> self.yag:
            self.yag.close()
</code></pre>
<h2 data-id="heading-10">è¿è¡Œç¤ºä¾‹</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ–‡ä»¶</span>
    client_data_file = <span class="hljs-string">'./clients/clients.xlsx'</span>
    <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿æ–‡ä»¶</span>
    txt_template_file = <span class="hljs-string">'./templates/christmas.txt'</span>
    sender = EmailSender(client_data_file=client_data_file,
                         txt_template_file=txt_template_file)
    sender.run()
</code></pre>
<h2 data-id="heading-11">é™„æºç </h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é…ç½®ä¿¡æ¯</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailConfig</span>:
    <span class="hljs-string">"""
    é‚®ç®±é…ç½®
    """</span>
    <span class="hljs-comment"># ä½ çš„é‚®ç®±</span>
    user: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># é‚®ç®±æˆæƒç </span>
    password: <span class="hljs-built_in">str</span> = <span class="hljs-string">'TXYuclse932VzHJ'</span>
    <span class="hljs-comment"># é‚®ç®±æœåŠ¡å™¨</span>
    host: <span class="hljs-built_in">str</span> = <span class="hljs-string">'smtp.163.com'</span>
    <span class="hljs-comment"># ç«¯å£</span>
    port: <span class="hljs-built_in">int</span> = <span class="hljs-string">'587'</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderInfo</span>:
    <span class="hljs-string">"""
    å‘ä»¶äººä¿¡æ¯
    """</span>
    <span class="hljs-comment"># æ˜¾ç¤ºç»™å®¢æˆ·çš„å‘ä»¶äººåç§°</span>
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">'èµ·é£äº†-dev'</span>
    <span class="hljs-comment"># èŒä½</span>
    position: <span class="hljs-built_in">str</span> = <span class="hljs-string">'å¼€å‘äººå‘˜'</span>
    <span class="hljs-comment"># å…¬å¸</span>
    company: <span class="hljs-built_in">str</span> = <span class="hljs-string">'xxxç§‘æŠ€æœ‰é™è´£ä»»å…¬å¸'</span>
    <span class="hljs-comment"># é‚®ç®±</span>
    email: <span class="hljs-built_in">str</span> = <span class="hljs-string">'138xxxx8888@163.com'</span>
    <span class="hljs-comment"># ç­¾å</span>
    signature: <span class="hljs-built_in">str</span> = <span class="hljs-string">'ç­¾åæµ‹è¯•'</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_subject</span>(<span class="hljs-params">self, client: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-string">"""
        è·å–é‚®ä»¶ä¸»é¢˜
        :param client: å®¢æˆ·ä¿¡æ¯, ä¸å®¢æˆ·ä¿¡æ¯æ–‡ä»¶å†…ä¸€è‡´
        :return: é‚®ä»¶ä¸»é¢˜
        """</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>è‡´<span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>çš„é‚®ä»¶"</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_json</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'name'</span>: self.name,
            <span class="hljs-string">'position'</span>: self.position,
            <span class="hljs-string">'company'</span>: self.company,
            <span class="hljs-string">'email'</span>: self.email,
            <span class="hljs-string">'signature'</span>: self.signature
        }
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SendSettings</span>:
    <span class="hljs-string">"""
    å‘é€è®¾ç½®
    """</span>
    <span class="hljs-comment"># é‚®ä»¶é—´éš”(ç§’)ï¼Œé¿å…è¢«é™åˆ¶</span>
    delay_between_emails: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span>
    <span class="hljs-comment"># æµ‹è¯•æ¨¡å¼ï¼ˆåªå‘ç»™è‡ªå·±ï¼‰</span>
    test_mode: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    <span class="hljs-comment"># æ¯æ‰¹æœ€å¤šå‘é€é‡</span>
    max_emails_per_batch: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span>

<span class="hljs-comment"># ä¸»åŠŸèƒ½ä»£ç </span>
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> re

<span class="hljs-keyword">import</span> yagmail
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template
<span class="hljs-keyword">from</span> config.config <span class="hljs-keyword">import</span> EmailConfig, SenderInfo, SendSettings


<span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSender</span>:
    <span class="hljs-string">"""é‚®ä»¶å‘é€å™¨"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, client_data_file: <span class="hljs-built_in">str</span>, txt_template_file: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""åˆå§‹åŒ–"""</span>
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®</span>
        self.client_data_file = client_data_file
        <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿</span>
        self.template_file = <span class="hljs-literal">None</span>
        self.txt_template_file = txt_template_file
        <span class="hljs-comment"># é‚®ä»¶é…ç½®</span>
        self.email_config = EmailConfig()
        self.sender_info = SenderInfo()
        self.send_settings = SendSettings()
        self.yag = yagmail.SMTP(
            user=self.email_config.user,
            password=self.email_config.password,
            host=self.email_config.host,
            port=self.email_config.port
        )
        self.sent_log = []

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_clients</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">dict</span>]:
        <span class="hljs-string">"""åŠ è½½å®¢æˆ·æ•°æ®"""</span>
        df = pd.read_excel(self.client_data_file)
        client_list = df.to_dict(orient=<span class="hljs-string">'records'</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client_list:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"å®¢æˆ·æ•°æ®ä¸ºç©º"</span>)
        <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ ¡éªŒå¹¶æ¸…æ´—</span>
        <span class="hljs-keyword">for</span> client <span class="hljs-keyword">in</span> client_list:
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'email'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„é‚®ç®±ä¸ºç©º"</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> client[<span class="hljs-string">'name'</span>]:
                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"å®¢æˆ· <span class="hljs-subst">{json.dumps(client, ensure_ascii=<span class="hljs-literal">False</span>)}</span> çš„å§“åä¸ºç©º"</span>)
            client[<span class="hljs-string">'name'</span>] = client[<span class="hljs-string">'name'</span>].strip()
            client[<span class="hljs-string">'email'</span>] = client[<span class="hljs-string">'email'</span>].strip()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²åŠ è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(client_list)}</span> ä¸ªå®¢æˆ·æ•°æ®"</span>)
        <span class="hljs-keyword">return</span> client_list

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">load_template</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åŠ è½½é‚®ä»¶æ¨¡æ¿"""</span>
        template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                template = Template(f.read())
        txt_template = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">if</span> self.txt_template_file:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.txt_template_file, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                txt_template = f.read()
        <span class="hljs-keyword">return</span> template, txt_template

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_convert_html_to_text</span>(<span class="hljs-params">self, html</span>):
        <span class="hljs-string">"""
        æ™ºèƒ½è½¬æ¢HTMLåˆ°çº¯æ–‡æœ¬
        ä¿ç•™é‡è¦æ ¼å¼ï¼ˆåˆ—è¡¨ã€æ®µè½ã€å¼ºè°ƒç­‰ï¼‰
        """</span>
        <span class="hljs-comment"># è‡ªå®šä¹‰è½¬æ¢è§„åˆ™</span>
        replacements = [
            (<span class="hljs-string">r'&lt;br\s*/?&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;p.*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/p&gt;'</span>, <span class="hljs-string">''</span>),
            (<span class="hljs-string">r'&lt;li.*?&gt;'</span>, <span class="hljs-string">'â€¢ '</span>),
            (<span class="hljs-string">r'&lt;/li&gt;'</span>, <span class="hljs-string">'\n'</span>),
            (<span class="hljs-string">r'&lt;strong.*?&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;/strong&gt;'</span>, <span class="hljs-string">'*'</span>),
            (<span class="hljs-string">r'&lt;em.*?&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;/em&gt;'</span>, <span class="hljs-string">'_'</span>),
            (<span class="hljs-string">r'&lt;h[1-6].*?&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;/h[1-6]&gt;'</span>, <span class="hljs-string">'\n\n'</span>),
            (<span class="hljs-string">r'&lt;[^&gt;]+&gt;'</span>, <span class="hljs-string">''</span>),  <span class="hljs-comment"># ç§»é™¤å…¶ä»–æ‰€æœ‰HTMLæ ‡ç­¾</span>
        ]

        text = html
        <span class="hljs-keyword">for</span> pattern, replacement <span class="hljs-keyword">in</span> replacements:
            text = re.sub(pattern, replacement, text)

        <span class="hljs-comment"># æ¸…ç†å¤šä½™çš„ç©ºè¡Œ</span>
        text = re.sub(<span class="hljs-string">r'\n\s*\n\s*\n'</span>, <span class="hljs-string">'\n\n'</span>, text)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'_convert_html_to_text:<span class="hljs-subst">{text}</span>'</span>)
        <span class="hljs-keyword">return</span> text.strip()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">personalize_content</span>(<span class="hljs-params">self, client, template, txt_template: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""ä¸ªæ€§åŒ–é‚®ä»¶å†…å®¹"""</span>

        html_content = template.render(client=client, sender=self.sender_info.to_json()) <span class="hljs-keyword">if</span> template <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

        <span class="hljs-keyword">if</span> txt_template:
            txt_content = txt_template
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> client.keys():
                txt_content = txt_content.replace(<span class="hljs-string">'{client_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(client[key]))
            sender_json = self.sender_info.to_json()
            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> sender_json:
                txt_content = txt_content.replace(<span class="hljs-string">'{sender_'</span> + key + <span class="hljs-string">'}'</span>, <span class="hljs-built_in">str</span>(sender_json[key]))
        <span class="hljs-keyword">else</span>:
            txt_content = self._convert_html_to_text(html_content)

        <span class="hljs-keyword">return</span> html_content, txt_content

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_to_client</span>(<span class="hljs-params">self, client, content</span>):
        <span class="hljs-string">"""å‘é€ç»™å•ä¸ªå®¢æˆ·"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºé‚®ä»¶</span>
            subject = self.sender_info.get_subject(client=client)

            <span class="hljs-comment"># å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œå‘ç»™è‡ªå·±</span>
            to_email = client[<span class="hljs-string">'email'</span>]
            <span class="hljs-keyword">if</span> self.send_settings.test_mode:
                to_email = self.email_config.user
                subject = <span class="hljs-string">f"[æµ‹è¯•] <span class="hljs-subst">{subject}</span>"</span>

            <span class="hljs-comment"># å‘é€</span>
            self.yag.send(
                to=to_email,
                subject=subject,
                contents=content,
                <span class="hljs-comment"># attachments=['attachments/sample.pdf'],  # å¯é€‰é™„ä»¶</span>
                headers={
                    <span class="hljs-comment"># 'X-Priority': '1',  #  é«˜ä¼˜å…ˆçº§ âš ï¸ï¼ˆæ˜¾ç¤ºæ„Ÿå¹å·ï¼‰</span>
                    <span class="hljs-string">'X-Priority'</span>: <span class="hljs-string">'3'</span>,  <span class="hljs-comment"># æ™®é€šä¼˜å…ˆçº§ï¼ˆé»˜è®¤ï¼Œä¸æ˜¾ç¤ºç‰¹æ®Šæ ‡è®°ï¼‰</span>
                    <span class="hljs-comment"># 'X-Priority': '5',  # ä½ä¼˜å…ˆçº§</span>
                    <span class="hljs-string">'X-Mailer'</span>: <span class="hljs-string">'PersonalEmailSender'</span>
                }
            )

            <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
            log_entry = {
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'æˆåŠŸ'</span>
            }
            self.sent_log.append(log_entry)

            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ å·²å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span> &lt;<span class="hljs-subst">{client[<span class="hljs-string">'email'</span>]}</span>&gt;"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— å‘é€å¤±è´¥ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>: <span class="hljs-subst">{e}</span>"</span>)
            self.sent_log.append({
                <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                <span class="hljs-string">'status'</span>: <span class="hljs-string">f'å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>'</span>
            })
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_log</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¿å­˜å‘é€è®°å½•"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.sent_log:
            <span class="hljs-keyword">return</span>

        log_df = pd.DataFrame(self.sent_log)
        timestamp = datetime.now().strftime(<span class="hljs-string">'%Y%m%d_%H%M%S'</span>)
        log_file = <span class="hljs-string">f'sent_logs/sent_<span class="hljs-subst">{timestamp}</span>.csv'</span>

        <span class="hljs-comment"># ç¡®ä¿ç›®å½•å­˜åœ¨</span>
        os.makedirs(<span class="hljs-string">'sent_logs'</span>, exist_ok=<span class="hljs-literal">True</span>)

        log_df.to_csv(log_file, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ“‹ å‘é€è®°å½•å·²ä¿å­˜: <span class="hljs-subst">{log_file}</span>"</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ä¸»è¿è¡Œå‡½æ•°"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹å‘é€ä¸ªæ€§åŒ–é‚®ä»¶...\n"</span>)

        <span class="hljs-comment"># åŠ è½½æ•°æ®</span>
        client_list = self.load_clients()
        template, txt_template = self.load_template()

        sent_count = <span class="hljs-number">0</span>
        total_clients = <span class="hljs-built_in">len</span>(client_list)

        <span class="hljs-keyword">for</span> i, client <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(client_list, <span class="hljs-number">1</span>):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[<span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_clients}</span>] å¤„ç†: <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)

            <span class="hljs-comment"># ä¸ªæ€§åŒ–å†…å®¹</span>
            html_content, text_content = self.personalize_content(client, template, txt_template)

            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> text_content:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ— æ— å†…å®¹å¯å‘é€ç»™ <span class="hljs-subst">{client[<span class="hljs-string">'name'</span>]}</span>"</span>)
                <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
                log_entry = {
                    <span class="hljs-string">'client'</span>: client[<span class="hljs-string">'name'</span>],
                    <span class="hljs-string">'email'</span>: client[<span class="hljs-string">'email'</span>],
                    <span class="hljs-string">'time'</span>: datetime.now().isoformat(),
                    <span class="hljs-string">'status'</span>: <span class="hljs-string">'å¤±è´¥'</span>,
                    <span class="hljs-string">'åŸå› '</span>: <span class="hljs-string">'æ— å†…å®¹'</span>
                }
                self.sent_log.append(log_entry)
                <span class="hljs-keyword">continue</span>

            content = [text_content, html_content] <span class="hljs-keyword">if</span> html_content <span class="hljs-keyword">else</span> text_content
            <span class="hljs-comment"># å‘é€</span>
            <span class="hljs-keyword">if</span> self.send_to_client(client, content):
                sent_count += <span class="hljs-number">1</span>

            <span class="hljs-comment"># å»¶è¿Ÿï¼Œé¿å…è¢«é™åˆ¶</span>
            <span class="hljs-keyword">if</span> i &lt; total_clients:
                delay = self.send_settings.delay_between_emails
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­‰å¾… <span class="hljs-subst">{delay}</span> ç§’..."</span>)
                time.sleep(delay)

            <span class="hljs-comment"># åˆ†æ‰¹æš‚åœï¼ˆå¦‚æœå‘é€é‡å¤§ï¼‰</span>
            <span class="hljs-keyword">if</span> i % self.send_settings.max_emails_per_batch == <span class="hljs-number">0</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå·²å‘é€ <span class="hljs-subst">{i}</span> å°ï¼Œæš‚åœ 60 ç§’..."</span>)
                time.sleep(<span class="hljs-number">60</span>)

        <span class="hljs-comment"># ä¿å­˜æ—¥å¿—</span>
        self.save_log()

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nâœ… å®Œæˆï¼æˆåŠŸå‘é€ <span class="hljs-subst">{sent_count}</span>/<span class="hljs-subst">{total_clients}</span> å°é‚®ä»¶"</span>)

        <span class="hljs-comment"># å…³é—­è¿æ¥</span>
        <span class="hljs-keyword">if</span> self.yag:
            self.yag.close()


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># å®¢æˆ·æ•°æ®æ–‡ä»¶</span>
    client_data_file = <span class="hljs-string">'./clients/clients.xlsx'</span>
    <span class="hljs-comment"># é‚®ä»¶æ¨¡æ¿æ–‡ä»¶</span>
    txt_template_file = <span class="hljs-string">'./templates/christmas.txt'</span>
    sender = EmailSender(client_data_file=client_data_file,
                         txt_template_file=txt_template_file)
    sender.run()
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰]]></title>    <link>https://juejin.cn/post/7585553799298416686</link>    <guid>https://juejin.cn/post/7585553799298416686</guid>    <pubDate>2025-12-21T10:31:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585553799298416686" data-draft-id="7585743487258542089" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-21T10:31:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åå­—è¢«ä½ ä»¬æƒ³å®Œäº†"/> <meta itemprop="url" content="https://juejin.cn/user/3065854916834782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3065854916834782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åå­—è¢«ä½ ä»¬æƒ³å®Œäº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T10:31:52.000Z" title="Sun Dec 21 2025 10:31:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆå…­ï¼‰</h2>
<p>Flutter: 3.35.6</p>
<p>å‰é¢æœ‰äººæåˆ°åœ¨å…ƒç´ å†…éƒ¨çš„é‚£å—åˆ¤æ–­æ€ä¹ˆé‚£ä¹ˆå†™çš„ï¼Œçœ‹æ¥å¯¹çŸ¥è¯†æ¸´æœ›çš„å°ä¼™ä¼´è¿˜æ˜¯æœ‰ï¼Œè¿™æ ·æŒºå¥½çš„ã€‚ä¸è‡³äºè¯´ç‰¢è®°éƒ¨åˆ†çŸ¥è¯†ï¼Œåªéœ€è¦å¤§è‡´äº†è§£ä¸€ä¸‹æœ‰ä¸ªå°è±¡åé¢å¦‚æœå“ªé‡Œå†ç”¨åˆ°äº†å°±å¯ä»¥æ ¹æ®è¿™ä¸ªå°è±¡å»æŸ¥é˜…èµ„æ–™ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯´ä¸€ä¸‹åˆ¤æ–­åŸç†ã€‚å½“æˆ‘ä»¬çŸ¥æ™“çŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹åæ ‡(åŒ…æ‹¬ä»»æ„æ—‹è½¬å)ï¼Œå¯ä»¥ä½¿ç”¨å‘é‡å‰ä¹˜æ³•æ¥åˆ¤æ–­æ˜¯å¦åœ¨çŸ©å½¢å†…éƒ¨ã€‚</p>
<p>å‘é‡å‰ä¹˜æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå¦‚æœä¸€ä¸ªç‚¹åœ¨å‡¸å¤šè¾¹å½¢å†…éƒ¨ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å§‹ç»ˆä½äºè¯¥å¤šè¾¹å½¢æ¯æ¡è¾¹çš„åŒä¸€ä¾§ã€‚</p>
<p>æ³¨ï¼šå‡¸å¤šè¾¹å½¢å®šä¹‰ä¸ºæ‰€æœ‰å†…è§’å‡å°äº180åº¦ï¼Œå¹¶ä¸”ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è¿çº¿éƒ½å®Œå…¨ä½äºå¤šè¾¹å½¢å†…éƒ¨æˆ–è¾¹ç•Œã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨å‘é‡å‰ä¹˜æ³•æ¥åˆ¤æ–­ç‚¹ä½äºçº¿çš„å“ªä¸€ä¾§ã€‚å‡è®¾çŸ©å½¢é¡¶ç‚¹æŒ‰<strong>é¡ºæ—¶é’ˆ</strong>æˆ–<strong>é€†æ—¶é’ˆ</strong>é¡ºåºä¸º Aï¼ŒBï¼ŒCï¼ŒDï¼š</p>
<ul>
<li>å¯¹äºè¾¹ ABï¼Œè®¡ç®—å‘é‡ AB å’Œ AP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ BCï¼Œè®¡ç®—å‘é‡ BC å’Œ BP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ CDï¼Œè®¡ç®—å‘é‡ CD å’Œ CP çš„å‰ç§¯ã€‚</li>
<li>å¯¹äºè¾¹ DAï¼Œè®¡ç®—å‘é‡ DA å’Œ DP çš„å‰ç§¯ã€‚</li>
</ul>
<p>å¦‚æœç‚¹ P åœ¨æ‰€æœ‰è¾¹çš„â€ŒåŒä¸€ä¾§â€Œï¼ˆå³æ‰€æœ‰å‰ç§¯ç»“æœçš„ç¬¦å·ç›¸åŒï¼‰ï¼Œé‚£ä¹ˆç‚¹ P å°±åœ¨çŸ©å½¢å†…éƒ¨ã€‚æˆ‘ä»¬å‡è®¾çŸ©å½¢æŸæ¡è¾¹çš„é¡¶ç‚¹ä¸º(x1, y1), (x2, y2), åˆ¤æ–­çš„ç‚¹åæ ‡ä¸º(x, y)ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š</p>
<p>(x2 - x1) * (y - y1) - (y2 - y1) * (x - x1) &gt; 0</p>
<p>è¿™æ ·å°±å¯ä»¥åˆ¤æ–­åœ¨æŸä¾§ï¼Œå¦‚æœå…¶ä»–ä¸‰æ¡è¾¹ä¹Ÿæ»¡è¶³ï¼Œé‚£å°±æ˜¯å†…ä¾§äº†ï¼Œè¦è½¬æ¢ä¸ºä¸‹é¢ä»£ç ä¸­çš„å½¢å¼ï¼Œé‚£å°±åšä¸€ä¸‹åŠ å‡ä¹˜é™¤å°±è¡Œäº†ï¼š</p>
<ol>
<li>(x2 - x1) * (y - y1) - (y2 - y1) * (x - x1) &gt; 0: åˆå§‹</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) - (x - x1) &gt; 0: ä¸¤è¾¹åŒæ—¶é™¤ä»¥(y2 - y1)</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) - x + x1 &gt; 0: å±•å¼€æ‹¬å·</li>
<li>(x2 - x1) * (y - y1) / (y2 - y1) + x1 &gt; x: å°†xç§»é¡¹</li>
</ol>
<p>è¿™æ ·å°±å¾—åˆ°äº†ä»£ç ä¸­çš„åˆ¤æ–­ä¾æ®ï¼Œè‡³äºå¾ªç¯éå†é¡¶ç‚¹çš„å†™æ³•ï¼Œå°±æ˜¯ä¸ºäº†è·å–ç›¸é‚»ä¸¤ä¸ªé¡¶ç‚¹ï¼Œè¿™ä¸ªå°±å¯ä»¥å¸¦å…¥squareåæ ‡å’Œå¾ªç¯å»ç®—ä¸€ä¸‹å°±è¡Œäº†ï¼Œä¿è¯æ¯æ¬¡å¾ªç¯éƒ½æ˜¯ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨çš„é¡¶ç‚¹åæ ‡é¡ºåºæ˜¯é¡ºæ—¶é’ˆï¼Œç¬¬ä¸€æ¬¡å¾ªç¯ i = 0ï¼Œj = 3ï¼Œé‚£ä¹ˆiå°±æ˜¯å·¦ä¸Šé¡¶ç‚¹ï¼Œjå°±æ˜¯å·¦ä¸‹é¡¶ç‚¹ï¼Œä¸¤ä¸ªé¡¶ç‚¹åˆšå¥½æ„æˆçŸ©å½¢å·¦è¾¹ï¼›ç¬¬äºŒæ¬¡å¾ªç¯ j = i++ï¼Œæ­¤æ—¶ j = 0ï¼Œi = 1åç»­å–œæ¬¢ä»¥æ­¤ç±»æ¨å³å¯ã€‚</p>
<p>è¿™æ ·åˆ¤æ–­åœ¨å†…ä¾§å·®ä¸å¤šå°±è§£é‡Šå®Œäº†ã€‚æ¥ä¸‹æ¥å¼€å§‹æˆ‘ä»¬ä»Šå¤©æ­£æ–‡ã€‚å‰é¢æˆ‘ä»¬å°±ç®€å•å®Œæˆäº†å¤šä¸ªå…ƒç´ çš„ç›¸åº”æ“ä½œï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸€äº›ä¼˜åŒ–å’Œä¸€äº›ç®€å•çš„æ‰©å±•åŠŸèƒ½ã€‚</p>
<p>æ—¢ç„¶æ˜¯å¤šä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆè‚¯å®šå°±æ¶‰åŠåˆ°æ–°å¢å’Œåˆ é™¤ï¼Œä¹‹å‰çš„æ–°å¢éƒ½æ˜¯åœ¨åˆ—è¡¨é‡Œé¢ç›´æ¥æ·»åŠ ï¼Œç°åœ¨æˆ‘ä»¬å•ç‹¬æå–ä¸€ä¸ªæ–¹æ³•ç”¨äºæ–°å¢ã€‚è‡³äºåˆ é™¤åŠŸèƒ½æˆ‘ä»¬å°±å®šä¹‰åœ¨å…ƒç´ å·¦ä¸Šè§’ä¸ºåˆ é™¤åŒºåŸŸï¼Œè§¦å‘æ–¹å¼ä¸ºç‚¹å‡»ã€‚ä¹‹å‰æˆ‘ä»¬å¯¹çƒ­åŒºçš„æ•°æ®æ¨¡å‹ä¸­æ·»åŠ äº† trigger å­—æ®µï¼Œç”¨äºè¡¨ç¤ºå½“å‰åŒºåŸŸè§¦å‘æ“ä½œçš„æ–¹å¼æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å¯¹ç‚¹å‡»æ–¹æ³•è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä¸”åœ¨ä¸´æ—¶ä¸­é—´å˜é‡ä¸Šé¢å­˜å‚¨ trigger å­—æ®µï¼Œç”¨äºåˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponseAreaModel</span> </span>{
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-comment">/// <span class="markdown">å½“å‰å“åº”æ“ä½œçš„è§¦å‘æ–¹å¼</span></span>
  <span class="hljs-keyword">final</span> TriggerMethod trigger;
}

<span class="hljs-comment">/// <span class="markdown">æ–°å¢è¿”å›Recordsï¼Œç”¨äºè®°å½•çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span></span>
(ElementStatus, TriggerMethod)? _onDownZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-comment">// å…ˆåˆ¤æ–­æ˜¯å¦åœ¨å“åº”å¯¹åº”æ“ä½œçš„åŒºåŸŸ</span>
  <span class="hljs-keyword">final</span> (ElementStatus, TriggerMethod)? areaStatus = _getElementZone(x: x, y: y, item: item);
  <span class="hljs-keyword">if</span> (areaStatus != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">return</span> areaStatus;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_insideElement(x: x, y: y, item: item)) {
    <span class="hljs-comment">// å› ä¸ºåŠ å…¥æ—‹è½¬ï¼Œæ‰€ä»¥å•ç‹¬æŠ½å–è½ç‚¹æ˜¯å¦åœ¨å…ƒç´ å†…éƒ¨çš„æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> (ElementStatus.move, TriggerMethod.move);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-comment">/// <span class="markdown">æ–°å¢è¿”å›Recordsï¼Œç”¨äºè®°å½•çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span></span>
(ElementStatus, TriggerMethod)? _getElementZone({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y,
  <span class="hljs-keyword">required</span> ElementModel item,
}) {
  <span class="hljs-comment">// æ–°å¢Recordsè®°å½•è¿”å›çš„çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span>
  (ElementStatus, TriggerMethod)? tempStatus;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ConstantsConfig.baseAreaList.length; i++) {
    <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

    <span class="hljs-keyword">if</span> (
      x &gt;= dx - areaCW &amp;&amp;
      x &lt;= dx + areaCW &amp;&amp;
      y &gt;= dy - areaCH &amp;&amp;
      y &lt;= dy + areaCH
    ) {
      tempStatus = (currentArea.status, currentArea.trigger);
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-keyword">return</span> tempStatus;
}
</code></pre>
<p>è¿™æ ·è§¦å‘æ–¹å¼å’ŒçŠ¶æ€éƒ½è®°å½•äº†ï¼Œæˆ‘ä»¬å°±å¼€å§‹å®ç°åˆ é™¤åŠŸèƒ½ï¼Œä¾ç„¶æŒ‰ç…§ä¹‹å‰çš„æ­¥éª¤å¿«é€Ÿå®ç°ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æ–°å¢åˆ é™¤</span>
ResponseAreaModel(
  areaWidth: <span class="hljs-number">20</span>,
  areaHeight: <span class="hljs-number">20</span>,
  xRatio: <span class="hljs-number">0</span>,
  yRatio: <span class="hljs-number">0</span>,
  status: ElementStatus.deleteStatus,
  icon: <span class="hljs-string">'assets/images/icon_delete.png'</span>,
  trigger: TriggerMethod.down,
),
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">å¤„ç†åˆ é™¤å…ƒç´ </span></span>
<span class="hljs-keyword">void</span> _onDelete() {
  <span class="hljs-keyword">if</span> (_currentElement == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span>;

  _elementList.removeWhere((item) =&gt; item.id == _currentElement?.id);
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æŒ‰ä¸‹äº‹ä»¶</span></span>
<span class="hljs-keyword">void</span> _onPanDown(DragDownDetails details) {
  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-comment">// éå†åˆ¤æ–­å½“å‰ç‚¹å‡»çš„ä½ç½®æ˜¯å¦è½åœ¨äº†æŸä¸ªå…ƒç´ çš„å“åº”åŒºåŸŸ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> _elementList) {
    <span class="hljs-comment">// æ–°å¢Recordsæ•°æ®ï¼Œå­˜å‚¨å…ƒç´ çŠ¶æ€å’Œè§¦å‘æ–¹å¼</span>
    <span class="hljs-keyword">final</span> (ElementStatus, TriggerMethod)? status = _onDownZone(x: dx, y: dy, item: item);

    <span class="hljs-keyword">if</span> (status != <span class="hljs-keyword">null</span>) {
      currentElement = item;
      temp = temp.copyWith(status: status.$<span class="hljs-number">1</span>, trigger: status.$<span class="hljs-number">2</span>);
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-comment">// æ–°å¢åˆ¤æ–­</span>
  <span class="hljs-comment">// å¦‚æœå½“å‰æœ‰é€‰ä¸­çš„å…ƒç´ ä¸”å’Œç‚¹å‡»åŒºåŸŸçš„currentElementæ˜¯ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-comment">// å¹¶ä¸” temp çš„ statuså¯¹åº”çš„è§¦å‘æ–¹å¼ä¸ºç‚¹å‡»ï¼Œé‚£ä¹ˆå°±å“åº”å¯¹åº”çš„ç‚¹å‡»äº‹ä»¶</span>
  <span class="hljs-keyword">if</span> (currentElement?.id == _currentElement?.id &amp;&amp; temp.trigger == TriggerMethod.down) {
    <span class="hljs-keyword">if</span> (temp.status == ElementStatus.deleteStatus) {
      _onDelete();
      <span class="hljs-comment">// å› ä¸ºæ˜¯åˆ é™¤ï¼Œå°±ç½®ç©ºé€‰ä¸­ï¼Œè®©ä¸‹é¢ä»£ç æ‰§è¡Œæœ€åçš„æ¸…é™¤</span>
      currentElement = <span class="hljs-keyword">null</span>;
    }
  }

  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>
}
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c31a7b32d93495e96cd5dc3d0ba960b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917912&amp;x-signature=QlV%2B7Tyl83Ib0ywhrpUNPvC8fi4%3D" alt="image01.gif" loading="lazy"/></p>
<p>è¿™æ ·å°±ç®€å•å®ç°äº†å…ƒç´ çš„åˆ é™¤åŠŸèƒ½ã€‚åˆ°æ­¤æ“ä½œåŒºåŸŸå¸¸ç”¨çš„åŠŸèƒ½å·®ä¸å¤šå°±å®Œæˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ä¸€äº›åŒºåŸŸçš„è‡ªå®šä¹‰ï¼›ä¾‹å¦‚æˆ‘å¸Œæœ›æ—‹è½¬çš„åŒºåŸŸåœ¨å³ä¸‹è§’ï¼ˆç°åœ¨åœ¨å³ä¸Šè§’ï¼‰ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ç¼©æ”¾åŠŸèƒ½ï¼Œè¿˜æƒ³è‡ªå®šä¹‰ä¸€ä¸ªåŒºåŸŸï¼Œè¿™æ—¶å€™è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p>å…è®¸ä¼ é€’é…ç½®ï¼Œé€šè¿‡è¿™ä»½é…ç½®æ¥å†³å®šå…ƒç´ åº”è¯¥æœ‰ä»€ä¹ˆå“åº”åŒºåŸŸå¹¶ä¸”æ˜¯å¦ä½¿ç”¨è¿™äº›å“åº”åŒºåŸŸï¼Œç„¶è€Œæ“ä½œè¿™äº›å†…ç½®çš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰å®šä¹‰çš„ <strong>final ElementStatus status;</strong> å­—æ®µæ¥ç¡®å®šè¦ä¿®æ”¹å“ªä¸ªåŒºåŸŸï¼Œæ¯•ç«Ÿä¸€ä¸ªæ“ä½œåº”è¯¥æ˜¯å¯¹åº”ä¸€ä¸ªåŒºåŸŸï¼›å¯¹äºè‡ªå®šä¹‰åŒºåŸŸï¼Œæˆ‘ä»¬çš„ElementStatusæ˜¯ä¸ªæšä¸¾ç±»å‹ä¸”ä¸ºå¿…ä¼ ï¼Œè¿™å°±é™åˆ¶äº†è‡ªå®šä¹‰åŒºåŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ”¹é€ ä¸€ä¸‹ï¼Œç”¨æˆ·ä¼ é€’çš„è‡ªå®šä¹‰åŒºåŸŸï¼Œstatusä¸ºè‡ªè¡Œè®¾ç½®çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å†…éƒ¨ä¹ŸåŒæ—¶æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ï¼ˆæ¶‰åŠæ›´æ”¹çš„åœ°æ–¹æœ‰ä¸€äº›ï¼Œè¿™é‡Œä¸åšè¿‡å¤šçš„è¯´æ˜ï¼Œåç»­å¯ä»¥æŸ¥é˜…æºç ï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">å…ƒç´ å½“å‰æ“ä½œçŠ¶æ€</span></span>
<span class="hljs-comment">/// <span class="markdown">æ›´æ”¹æ–°å¢å­—ç¬¦ä¸²çš„valueå±æ€§</span></span>
<span class="hljs-keyword">enum</span> ElementStatus {
  move(value: <span class="hljs-string">'move'</span>),
  rotate(value: <span class="hljs-string">'rotate'</span>),
  scale(value: <span class="hljs-string">'scale'</span>),
  deleteStatus(value: <span class="hljs-string">'deleteStatus'</span>),;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> value;

  <span class="hljs-keyword">const</span> ElementStatus({<span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.value});
}

<span class="hljs-comment">/// <span class="markdown">å¤§è‡´è¯´ä¸€äº›éœ€è¦æ›´æ”¹çš„åœ°æ–¹</span></span>
<span class="hljs-comment">/// <span class="markdown">TemporaryModel çš„ status æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ç±»å‹</span></span>
<span class="hljs-comment">/// <span class="markdown">ResponseAreaModel çš„ status æ›´æ”¹ä¸ºå­—ç¬¦ä¸²ç±»å‹</span></span>
<span class="hljs-comment">/// <span class="markdown"><span class="hljs-emphasis">_onDownZone æ–¹æ³•ä¸­ Records ç¬¬ä¸€é¡¹ä¹Ÿè¿”å› String</span></span></span>
<span class="hljs-comment">/// <span class="markdown"><span class="hljs-emphasis">_</span>getElementZone æ–¹æ³•ä¸­ Records ç¬¬ä¸€é¡¹ä¹Ÿè¿”å› String</span></span>
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¡®å®šè‡ªå®šä¹‰åŒºåŸŸé…ç½®ä¸­éœ€è¦çš„å­—æ®µï¼š</p>
<ul>
<li>statusï¼šç”¨äºæ˜ å°„å†…ç½®çš„åŒºåŸŸï¼Œæ–¹ä¾¿åšæ›´æ”¹ï¼ˆString å¿…é¡»ï¼‰</li>
<li>useï¼šç”¨äºç¡®å®šè¯¥ status å¯¹åº”çš„å†…ç½®åŒºåŸŸæ˜¯å¦ä½¿ç”¨ï¼ˆbool éå¿…é¡»ï¼‰</li>
<li>xRatioï¼šç”¨äºç¡®å®šåŒºåŸŸä½ç½®ï¼ˆdouble éå¿…é¡»ï¼Œå¦‚æœéå†…ç½®çš„é»˜è®¤å°±æ˜¯0ï¼‰</li>
<li>yRatioï¼šç”¨äºç¡®å®šåŒºåŸŸä½ç½®ï¼ˆdouble éå¿…é¡»ï¼Œå¦‚æœéå†…ç½®çš„é»˜è®¤å°±æ˜¯0ï¼‰</li>
<li>triggerï¼šç”¨äºç¡®å®šåŒºåŸŸçš„è§¦å‘æ–¹å¼ï¼ˆTriggerMethod éå¿…é¡»ï¼Œé»˜è®¤TriggerMethod.downï¼‰</li>
<li>iconï¼šç”¨äºç¡®å®šæ“ä½œåŒºåŸŸçš„å±•ç¤ºiconï¼ˆString å¦‚æœæ˜¯å†…ç½®çš„ status å°±æ˜¯éå¿…é¡»ï¼Œå¦‚æœä¸æ˜¯å†…ç½®çš„å°±æ˜¯å¿…é¡»ï¼‰</li>
<li>fnï¼šè‡ªå®šä¹‰åŒºåŸŸéœ€è¦æ‰§è¡Œçš„æ–¹æ³•ï¼ˆFunction({required double x, required double y}) å¦‚æœæ˜¯å†…ç½®çš„å°±æ˜¯éå¿…é¡»ï¼Œå¦‚æœä¸æ˜¯å†…ç½®çš„å°±å¿…é¡»ï¼‰</li>
</ul>
<p>åŸºäºä¸Šè¿°å¼€å§‹è¿›è¡Œç¼–ç ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æ–°å¢è‡ªå®šä¹‰åŒºåŸŸé…ç½®</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomAreaConfig</span> </span>{
  <span class="hljs-keyword">const</span> CustomAreaConfig({
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.status,
    <span class="hljs-keyword">this</span>.use,
    <span class="hljs-keyword">this</span>.xRatio,
    <span class="hljs-keyword">this</span>.yRatio,
    <span class="hljs-keyword">this</span>.trigger = TriggerMethod.down,
    <span class="hljs-keyword">this</span>.icon,
    <span class="hljs-keyword">this</span>.fn,
  });

  <span class="hljs-comment">/// <span class="markdown">åŒºåŸŸçš„æ“ä½œçŠ¶æ€å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯å†…ç½®çš„ï¼Œå¦‚æœæ˜¯å†…ç½®çš„å°±è¦†ç›–å†…ç½®çš„å±æ€§</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> status;
  <span class="hljs-comment">/// <span class="markdown">æ˜¯å¦å¯ç”¨</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool?</span> use;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰ä½ç½®</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double?</span> xRatio;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double?</span> yRatio;
  <span class="hljs-comment">/// <span class="markdown">åŒºåŸŸå“åº”æ“ä½œçš„è§¦å‘æ–¹å¼</span></span>
  <span class="hljs-keyword">final</span> TriggerMethod trigger;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰åŒºåŸŸå°±æ˜¯å¿…ä¼ </span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String?</span> icon;
  <span class="hljs-comment">/// <span class="markdown">è‡ªå®šä¹‰åŒºåŸŸå°±æ˜¯å¿…ä¼ ï¼Œç‚¹å‡»å¯¹åº”çš„å“åº”åŒºåŸŸå°±æ‰§è¡Œè‡ªå®šä¹‰çš„æ–¹æ³•</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">Function</span>({<span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> x, <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> y})? fn;
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">æ–°å¢è‡ªå®šä¹‰åŒºåŸŸé…ç½®</span></span>
<span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;CustomAreaConfig&gt; _customAreaList = [
  <span class="hljs-comment">// ä¸ä½¿ç”¨ç¼©æ”¾åŒºåŸŸ</span>
  CustomAreaConfig(
    status: ElementStatus.scale.value,
    use: <span class="hljs-keyword">false</span>,
  ),
  <span class="hljs-comment">// å°†æ—‹è½¬ç§»åˆ°å³ä¸‹è§’</span>
  CustomAreaConfig(
    status: ElementStatus.rotate.value,
    xRatio: <span class="hljs-number">1</span>,
    yRatio: <span class="hljs-number">1</span>,
  ),
];
<span class="hljs-comment">/// <span class="markdown">å®¹å™¨å“åº”æ“ä½œåŒºåŸŸï¼Œä¹‹å‰æ˜¯ç›´æ¥ä½¿ç”¨çš„å¸¸é‡é‡Œé¢çš„é…ç½®</span></span>
<span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; _areaList = [];

<span class="hljs-comment">/// <span class="markdown">åˆå§‹åŒ–å“åº”åŒºåŸŸ</span></span>
<span class="hljs-keyword">void</span> _initArea() {
  <span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; areaList = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> area <span class="hljs-keyword">in</span> ConstantsConfig.baseAreaList) {
    <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> index = _customAreaList.indexWhere((item) =&gt; item.status == area.status);

    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">final</span> CustomAreaConfig customArea = _customAreaList[index];

      <span class="hljs-comment">// å¦‚æœæ˜¯ä¸ä½¿ç”¨ï¼Œåˆ™è·³å‡ºæœ¬æ¬¡å¾ªç¯</span>
      <span class="hljs-keyword">if</span> (customArea.use == <span class="hljs-keyword">false</span>) {
        <span class="hljs-keyword">continue</span>;
      }

      areaList.add(area.copyWith(
        xRatio: customArea.xRatio,
        yRatio: customArea.yRatio,
        icon: customArea.icon,
        fn: customArea.fn,
      ));
    } <span class="hljs-keyword">else</span> {
      areaList.add(area);
    }
  }

  setState(() {
    _areaList = areaList;
  });
}
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

<span class="hljs-comment">/// <span class="markdown">æŠ½å–æ¸²æŸ“çš„å…ƒç´ </span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TransformItem</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> TransformItem({
    <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.areaList,
  });

  <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;ResponseAreaModel&gt; areaList;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Positioned(
      left: elementItem.x,
      top: elementItem.y,
      <span class="hljs-comment">// æ–°å¢æ—‹è½¬åŠŸèƒ½</span>
      child: Transform.rotate(
        angle: elementItem.rotationAngle,
        child: Container(
          <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

          <span class="hljs-comment">// æ–°å¢åŒºåŸŸçš„æ¸²æŸ“</span>
          child: selected ? Stack(
            clipBehavior: Clip.none,
            children: [
              <span class="hljs-comment">// ä¿®æ”¹ä»å¤–ç•Œä¼ é€’åŒºåŸŸåˆ—è¡¨</span>
              ...areaList.map((item) =&gt; Positioned(
                <span class="hljs-comment">// å…¶ä»–çœç•¥...</span>
              )),
            ],
          ) : <span class="hljs-keyword">null</span>,
        ),
      )
    );
  }
}
</code></pre>
<p>å…¶ä»–ç¼–ç ä¸ç®—æ ¸å¿ƒï¼Œå°±ä¸å†å±•ç¤ºäº†ï¼Œåæ­£å°±ä¸€ä¸ªï¼Œä¹‹å‰ä» ConstantsConfig.baseAreaList æ‹¿çš„æ•°æ®ç°åœ¨éƒ½ç›´æ¥ä½¿ç”¨ _areaListã€‚</p>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/919333907ca8484ea4ad7b32d225334d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766917912&amp;x-signature=8uNMV4cVZOMorlQloFL7GA19lk4%3D" alt="image02.gif" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å°†æ—‹è½¬åŒºåŸŸç§»åˆ°å³ä¸‹è§’äº†ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ç¼©æ”¾åŒºåŸŸï¼Œè¿™æ ·å°±ç®€å•å®Œæˆäº†åŒºåŸŸè‡ªå®šä¹‰çš„é…ç½®ã€‚</p>
<p>æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ã€å‰ç«¯å­¦ä¹ å°è¥åœ°ã€‘ï¼Œä¸å®šæ—¶ä¼šåˆ†äº«ä¸€äº›å°åŠŸèƒ½ï½</p>
<p>ä»Šå¤©çš„åˆ†äº«å°±åˆ°æ­¤ç»“æŸäº†ï¼Œæ„Ÿè°¢é˜…è¯»ï½æ‹œæ‹œï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust çš„CPUå’ŒIOæ“ä½œ]]></title>    <link>https://juejin.cn/post/7585534343562149938</link>    <guid>https://juejin.cn/post/7585534343562149938</guid>    <pubDate>2025-12-21T05:29:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585534343562149938" data-draft-id="7585686247268876297" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust çš„CPUå’ŒIOæ“ä½œ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T05:29:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²æ£®"/> <meta itemprop="url" content="https://juejin.cn/user/4455643804079608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust çš„CPUå’ŒIOæ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4455643804079608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²æ£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T05:29:44.000Z" title="Sun Dec 21 2025 05:29:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">çº¯ CPU â€”â€” å¹¶è¡Œè´¨æ•°å¯»æ‰¾å™¨ (Parallel Prime Finder)</h3>
<p><strong>ç›®æ ‡ï¼š</strong> Â æ‰¾å‡º 1 åˆ° 10,000,000 (ä¸€åƒä¸‡) ä¹‹é—´çš„æ‰€æœ‰è´¨æ•°ã€‚Â <strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong> Â è¿™æ˜¯ä¸€ä¸ªçº¯è®¡ç®—ä»»åŠ¡ã€‚åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯è´¨æ•°ï¼Œéœ€è¦å¤§é‡çš„é™¤æ³•è¿ç®—ï¼ŒCPU å¿…é¡»ä¸€ç›´åœ¨è½¬ã€‚Â <strong>å·¥å…·ï¼š</strong> Â è¿™é‡Œæˆ‘ä»¬<strong>ä¸ç”¨ Tokio</strong>ã€‚å¯¹äºçº¯ CPU ä»»åŠ¡ï¼ŒRust ç¤¾åŒºæœ€å¸¸ç”¨çš„åº“æ˜¯Â <strong><code>Rayon</code></strong>ã€‚å®ƒèƒ½æŠŠä½ çš„Â <code>for</code>Â å¾ªç¯è‡ªåŠ¨å˜æˆå¹¶è¡Œçš„ã€‚</p>
<p><strong>Cargo.toml:</strong></p>
<p>Ini, TOML</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">rayon</span> = <span class="hljs-string">"1.8"</span> 
</code></pre>
<p><strong>main.rs:</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> rayon::prelude::*; <span class="hljs-comment">// å¼•å…¥ Rayon çš„å¹¶è¡Œè¿­ä»£å™¨åŠŸèƒ½</span>

<span class="hljs-comment">// ä¸€ä¸ªéå¸¸ç¬¨é‡ã€è€—è´¹ CPU çš„å‡½æ•°ï¼šåˆ¤æ–­ n æ˜¯å¦ä¸ºè´¨æ•°</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">is_prime</span>(n: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">if</span> n &lt;= <span class="hljs-number">1</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
    <span class="hljs-comment">// ç¬¨åŠæ³•ï¼šä» 2 éå†åˆ° sqrt(n)ï¼Œç–¯ç‹‚åšé™¤æ³•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">limit</span> = (n <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>).<span class="hljs-title function_ invoke__">sqrt</span>() <span class="hljs-keyword">as</span> <span class="hljs-type">u32</span>;
    <span class="hljs-keyword">for</span> <span class="hljs-variable">i</span> <span class="hljs-keyword">in</span> <span class="hljs-number">2</span>..=limit {
        <span class="hljs-keyword">if</span> n % i == <span class="hljs-number">0</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-literal">true</span>
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">limit</span> = <span class="hljs-number">10_000_000</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- å¼€å§‹å¯»æ‰¾ 1 åˆ° {} ä¹‹é—´çš„è´¨æ•° ---"</span>, limit);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start_time</span> = std::time::Instant::<span class="hljs-title function_ invoke__">now</span>();

    <span class="hljs-comment">// æ–¹å¼ A: å•çº¿ç¨‹å†™æ³• (å¯¹æ¯”ç»„)</span>
    <span class="hljs-comment">// åªè¦æŠŠä¸‹é¢çš„ par_iter() æ”¹æˆ iter() å°±æ˜¯å•çº¿ç¨‹</span>
    <span class="hljs-comment">// let count = (1..limit).filter(|&amp;n| is_prime(n)).count();</span>

    <span class="hljs-comment">// æ–¹å¼ B: å¹¶è¡Œå†™æ³• (Rayon)</span>
    <span class="hljs-comment">// par_iter() ä¼šè‡ªåŠ¨æŠŠ 1..limit åˆ‡æˆå¥½å‡ å—ï¼Œåˆ†å‘ç»™æ‰€æœ‰çš„ CPU æ ¸</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">count</span> = (<span class="hljs-number">1</span>..limit)
        .<span class="hljs-title function_ invoke__">into_par_iter</span>() <span class="hljs-comment">// &lt;--- é­”æ³•åœ¨è¿™é‡Œï¼å˜æˆå¹¶è¡Œè¿­ä»£å™¨</span>
        .<span class="hljs-title function_ invoke__">filter</span>(|&amp;n| <span class="hljs-title function_ invoke__">is_prime</span>(n)) <span class="hljs-comment">// è¿™ä¼šåœ¨å¤šä¸ªæ ¸ä¸ŠåŒæ—¶è·‘</span>
        .<span class="hljs-title function_ invoke__">count</span>();

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰¾åˆ° {} ä¸ªè´¨æ•°"</span>, count);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- è®¡ç®—ç»“æŸï¼Œè€—æ—¶: {:?} ---"</span>, start_time.<span class="hljs-title function_ invoke__">elapsed</span>());
}
</code></pre>
<p><strong>ç»ƒä¹ é‡ç‚¹ï¼š</strong></p>
<ol>
<li>
<p><strong>è§‚å¯Ÿ CPUï¼š</strong> Â è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œæ‰“å¼€ä½ çš„ä»»åŠ¡ç®¡ç†å™¨/æ´»åŠ¨ç›‘è§†å™¨ã€‚ä½ ä¼šçœ‹åˆ° CPU å ç”¨ç‡ç¬é—´é£™å‡åˆ° 100%ï¼ˆæ‰€æœ‰æ ¸éƒ½è¢«åƒæ»¡äº†ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯¹æ¯”è¯•éªŒï¼š</strong> Â è¯•ç€æŠŠÂ <code>.into_par_iter()</code>Â æ”¹å›æ™®é€šçš„Â <code>.into_iter()</code>ã€‚</p>
<ul>
<li><strong>å¹¶è¡Œç‰ˆï¼š</strong> Â å¯èƒ½åªè¦ 1-2 ç§’ï¼ˆå–å†³äºä½ çš„æ ¸æ•°ï¼‰ã€‚</li>
<li><strong>å•çº¿ç¨‹ç‰ˆï¼š</strong> Â å¯èƒ½éœ€è¦ 5-8 ç§’ã€‚</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2882d6c1cddf4a63bdf3659c3d5cb5f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=qbDWERjXdN9FOPjni8N%2FDMdEG4I%3D" alt="8939d65c92a156e0b5e8a1b94ae6908e.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db4eebb2ecc74979a4297e16b0c73f93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=OXQRF516Hd6jEqlQht%2BLNVm5wV8%3D" alt="0be753bfd229fe6d3bac6a63e6febe04.jpg" loading="lazy"/></p>
<h2 data-id="heading-1">ç£ç›˜ I/O æ˜¯<strong>å®æ‰“å®èƒ½çœ‹åˆ°ç¡¬ç›˜è¯»å†™é£™å‡</strong>çš„ã€‚</h2>
<p>æˆ‘ä»¬æ¥åšä¸€ä¸ªÂ  <strong>â€œæé€Ÿæ–‡ä»¶å¤‡ä»½å¼•æ“â€ (Async File Replicator)</strong> ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒç›®æ ‡</h3>
<ol>
<li><strong>åœºæ™¯ï¼š</strong> Â æ¨¡æ‹Ÿä½ æœ‰ä¸€å †å·¨å¤§çš„æ—¥å¿—æ–‡ä»¶ï¼ˆæ¯”å¦‚ 50 ä¸ª 100MB çš„æ–‡ä»¶ï¼‰ï¼Œéœ€è¦ä» A æ–‡ä»¶å¤¹å¤‡ä»½åˆ° B æ–‡ä»¶å¤¹ã€‚</li>
<li><strong>æŒ‘æˆ˜ï¼š</strong> Â ä¹Ÿå°±æ˜¯é€šå¸¸è¯´çš„â€œæ‹·è´æ–‡ä»¶â€ã€‚å¦‚æœæ˜¯å•çº¿ç¨‹ï¼Œæ˜¯ä¸€ä¸ªä¸ªæ‹·ï¼›æˆ‘ä»¬è¦ç”¨Â <code>tokio</code>Â å¹¶å‘æ‹·ï¼Œçœ‹èƒ½ä¸èƒ½æŠŠä½ çš„ SSD ååé‡æ‰“æ»¡ã€‚</li>
<li><strong>è§‚æµ‹ï¼š</strong> Â æ•™ä½ å¦‚ä½•ç”¨ç³»ç»Ÿå·¥å…·ç›‘æ§è¿™ä¸ªè¿‡ç¨‹ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šå…ˆå­¦ä¼šâ€œçœ‹â€ I/O (ç›‘æ§å·¥å…·)</h3>
<p>åœ¨è·‘ä»£ç ä¹‹å‰ï¼Œå…ˆæŠŠç›‘æ§é¢æ¿æ‰“å¼€ï¼Œè¿™æ ·ä»£ç ä¸€è·‘ï¼Œä½ å°±èƒ½çœ‹åˆ°æ³¢å½¢å›¾è·³èµ·æ¥ã€‚</p>
<h4 data-id="heading-4">1. Windows ç”¨æˆ·</h4>
<ul>
<li><strong>åŸºç¡€ç‰ˆï¼š</strong> Â æ‰“å¼€Â <strong>ä»»åŠ¡ç®¡ç†å™¨ (Task Manager)</strong> Â -&gt;Â <strong>æ€§èƒ½ (Performance)</strong> Â -&gt; ç‚¹å‡»Â <strong>ç£ç›˜ (Disk)</strong> ã€‚å…³æ³¨Â  <strong>â€œæ´»åŠ¨æ—¶é—´ (Active time)â€</strong> Â å’ŒÂ  <strong>â€œç£ç›˜ä¼ è¾“é€Ÿç‡ (Transfer Rate)â€</strong> ã€‚</li>
<li><strong>è¿›é˜¶ç‰ˆ (æ¨è)ï¼š</strong> Â Win + R è¾“å…¥Â <code>resmon</code>Â æ‰“å¼€Â <strong>èµ„æºç›‘è§†å™¨</strong>ã€‚ç‚¹å‡»Â <strong>ç£ç›˜</strong>Â é€‰é¡¹å¡ã€‚è¿™é‡Œèƒ½çœ‹åˆ°å…·ä½“æ˜¯å“ªä¸ªÂ <code>exe</code>Â åœ¨è¯»å†™ï¼Œä»¥åŠè¯»å†™äº†å“ªä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<h4 data-id="heading-5">2. macOS ç”¨æˆ·</h4>
<ul>
<li>æ‰“å¼€Â <strong>æ´»åŠ¨ç›‘è§†å™¨ (Activity Monitor)</strong> Â (Cmd + Space æœç´¢ Activity Monitor)ã€‚</li>
<li>ç‚¹å‡»åº•éƒ¨çš„Â  <strong>â€œç£ç›˜ (Disk)â€</strong> Â æ ‡ç­¾é¡µã€‚</li>
<li>å…³æ³¨åº•éƒ¨çš„Â  <strong>â€œæ•°æ®è¯»å–/ç§’ (Data read/sec)â€</strong> Â å’ŒÂ  <strong>â€œæ•°æ®å†™å…¥/ç§’ (Data written/sec)â€</strong> ã€‚ä½ ä¼šçœ‹åˆ°è¿™ä¸¤ä¸ªæ•°å­—ç¬é—´é£™å‡ã€‚</li>
</ul>
<h4 data-id="heading-6">3. Linux ç”¨æˆ·</h4>
<ul>
<li>åœ¨ç»ˆç«¯è¾“å…¥Â <code>iotop</code>Â (éœ€è¦ sudo)ã€‚ä½ ä¼šçœ‹åˆ°å®æ—¶çš„ç£ç›˜ I/O æ’è¡Œæ¦œã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šé¡¹ç›®ä»£ç  â€”â€” æé€Ÿå¤‡ä»½å¼•æ“</h3>
<p>è¿™ä¸ªé¡¹ç›®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li><strong>ç”Ÿæˆå™¨ï¼š</strong> Â å¿«é€Ÿç”Ÿæˆä¸€å †åƒåœ¾æ–‡ä»¶ç”¨æ¥æµ‹è¯•ã€‚</li>
<li><strong>å¤‡ä»½å™¨ï¼š</strong> Â ä½¿ç”¨ Tokio å¹¶å‘å¤åˆ¶ã€‚</li>
</ol>
<p><strong>Cargo.toml:</strong></p>
<p>Ini, TOML</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"full"</span>] }
<span class="hljs-attr">rand</span> = <span class="hljs-string">"0.8"</span> <span class="hljs-comment"># ç”¨æ¥ç”Ÿæˆéšæœºæ–‡ä»¶åæˆ–å†…å®¹ï¼ˆå¯é€‰ï¼Œè¿™é‡Œå…¶å®åªç”¨0å¡«å……ä¹Ÿè¡Œï¼‰</span>
</code></pre>
<p><strong>main.rs:</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::path::Path;
<span class="hljs-keyword">use</span> tokio::fs;
<span class="hljs-keyword">use</span> tokio::io::AsyncWriteExt;
<span class="hljs-keyword">use</span> tokio::time::Instant;
<span class="hljs-keyword">use</span> std::sync::Arc;
<span class="hljs-keyword">use</span> tokio::sync::Semaphore;

<span class="hljs-comment">// è®¾å®šæµ‹è¯•è§„æ¨¡</span>
<span class="hljs-keyword">const</span> FILE_COUNT: <span class="hljs-type">usize</span> = <span class="hljs-number">20</span>;       <span class="hljs-comment">// æ–‡ä»¶æ•°é‡</span>
<span class="hljs-keyword">const</span> FILE_SIZE_MB: <span class="hljs-type">usize</span> = <span class="hljs-number">50</span>;     <span class="hljs-comment">// æ¯ä¸ªæ–‡ä»¶ 50MB (æ€»å…± 1GB)</span>
<span class="hljs-keyword">const</span> SOURCE_DIR: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"./source_data"</span>;
<span class="hljs-keyword">const</span> TARGET_DIR: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"./backup_data"</span>;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; {
    <span class="hljs-comment">// --- å‡†å¤‡å·¥ä½œ ---</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- é˜¶æ®µ 1: å‡†å¤‡æµ‹è¯•æ•°æ® ---"</span>);
    <span class="hljs-title function_ invoke__">prepare_directories</span>().<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">generate_dummy_files</span>().<span class="hljs-keyword">await</span>?;

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"\nè¯·ç°åœ¨æ‰“å¼€ä½ çš„ã€æ´»åŠ¨ç›‘è§†å™¨/ä»»åŠ¡ç®¡ç†å™¨/iotopã€‘... 3ç§’åå¼€å§‹ç–¯ç‹‚æ‹·è´"</span>);
    tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(tokio::time::Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">3</span>)).<span class="hljs-keyword">await</span>;

    <span class="hljs-comment">// --- æ ¸å¿ƒå·¥ä½œ: å¼‚æ­¥å¹¶å‘æ‹·è´ ---</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"--- é˜¶æ®µ 2: å¼€å§‹æé€Ÿå¤‡ä»½ ---"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start</span> = Instant::<span class="hljs-title function_ invoke__">now</span>();

    <span class="hljs-comment">// é™åˆ¶å¹¶å‘æ•°ï¼šè™½ç„¶æ˜¯ I/Oï¼Œä½†å¦‚æœä¸é™åˆ¶ï¼Œç¬é—´æ‰“å¼€å‡ åƒä¸ªæ–‡ä»¶å¥æŸ„ä¼šæŠ¥é”™</span>
    <span class="hljs-comment">// åŒæ—¶ä¹Ÿä¸ºäº†è§‚å¯ŸæŒç»­çš„ I/O å‹åŠ›ï¼Œè€Œä¸æ˜¯ä¸€ç¬é—´ç»“æŸ</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">semaphore</span> = Arc::<span class="hljs-title function_ invoke__">new</span>(Semaphore::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">5</span>)); 
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">tasks</span> = <span class="hljs-built_in">vec!</span>[];

    <span class="hljs-comment">// è¯»å–æºç›®å½•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">entries</span> = fs::<span class="hljs-title function_ invoke__">read_dir</span>(SOURCE_DIR).<span class="hljs-keyword">await</span>?;

    <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(entry) = entries.<span class="hljs-title function_ invoke__">next_entry</span>().<span class="hljs-keyword">await</span>? {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">path</span> = entry.<span class="hljs-title function_ invoke__">path</span>();
        <span class="hljs-keyword">if</span> path.<span class="hljs-title function_ invoke__">is_file</span>() {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sem_clone</span> = semaphore.<span class="hljs-title function_ invoke__">clone</span>();
            
            <span class="hljs-comment">// å¼€å¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å»æ‹·è´è¿™ä¸ªæ–‡ä»¶</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">task</span> = tokio::<span class="hljs-title function_ invoke__">spawn</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
                <span class="hljs-comment">// è·å–ä»¤ç‰Œ</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_permit</span> = sem_clone.<span class="hljs-title function_ invoke__">acquire</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap</span>();
                
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">file_name</span> = path.<span class="hljs-title function_ invoke__">file_name</span>().<span class="hljs-title function_ invoke__">unwrap</span>().<span class="hljs-title function_ invoke__">to_str</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">target_path</span> = Path::<span class="hljs-title function_ invoke__">new</span>(TARGET_DIR).<span class="hljs-title function_ invoke__">join</span>(file_name);

                <span class="hljs-comment">// âš ï¸ æ ¸å¿ƒ I/O æ“ä½œï¼štokio::fs::copy</span>
                <span class="hljs-comment">// è¿™è¡Œä»£ç åº•å±‚ä¼šåˆ©ç”¨ OS çš„å¼‚æ­¥æ–‡ä»¶æ¥å£</span>
                <span class="hljs-keyword">match</span> fs::<span class="hljs-title function_ invoke__">copy</span>(&amp;path, &amp;target_path).<span class="hljs-keyword">await</span> {
                    <span class="hljs-title function_ invoke__">Ok</span>(bytes) =&gt; {
                        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"âœ… å·²å¤‡ä»½: {} ({:.2} MB)"</span>, file_name, bytes <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span> / <span class="hljs-number">1024.0</span> / <span class="hljs-number">1024.0</span>);
                    }
                    <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; eprintln!(<span class="hljs-string">"âŒ å¤±è´¥ {}: {}"</span>, file_name, e),
                }
                <span class="hljs-comment">// ä»¤ç‰Œè‡ªåŠ¨é‡Šæ”¾</span>
            });
            tasks.<span class="hljs-title function_ invoke__">push</span>(task);
        }
    }

    <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰æ‹·è´ä»»åŠ¡å®Œæˆ</span>
    <span class="hljs-keyword">for</span> <span class="hljs-variable">task</span> <span class="hljs-keyword">in</span> tasks {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_</span> = task.<span class="hljs-keyword">await</span>;
    }

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">duration</span> = start.<span class="hljs-title function_ invoke__">elapsed</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">total_size_mb</span> = (FILE_COUNT * FILE_SIZE_MB) <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">speed</span> = total_size_mb / duration.<span class="hljs-title function_ invoke__">as_secs_f64</span>();

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"\n--- å¤‡ä»½å®Œæˆ ---"</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è€—æ—¶: {:.2?}"</span>, duration);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¹³å‡ååé‡: {:.2} MB/s"</span>, speed);
    
    <span class="hljs-comment">// æ¸…ç†ç°åœºï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-comment">// fs::remove_dir_all(SOURCE_DIR).await?;</span>
    <span class="hljs-comment">// fs::remove_dir_all(TARGET_DIR).await?;</span>

    <span class="hljs-title function_ invoke__">Ok</span>(())
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šç”Ÿæˆåƒåœ¾æ–‡ä»¶</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">generate_dummy_files</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª å…¨æ˜¯ 0 çš„ 50MB ç¼“å†²åŒº</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">buffer</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0u8</span>; FILE_SIZE_MB * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>];

    <span class="hljs-keyword">for</span> <span class="hljs-variable">i</span> <span class="hljs-keyword">in</span> <span class="hljs-number">0</span>..FILE_COUNT {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">file_path</span> = Path::<span class="hljs-title function_ invoke__">new</span>(SOURCE_DIR).<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"log_{}.dat"</span>, i));
        <span class="hljs-keyword">if</span> !file_path.<span class="hljs-title function_ invoke__">exists</span>() {
            <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç”Ÿæˆæµ‹è¯•æ–‡ä»¶: log_{}.dat ..."</span>, i);
            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">file</span> = fs::File::<span class="hljs-title function_ invoke__">create</span>(file_path).<span class="hljs-keyword">await</span>?;
            file.<span class="hljs-title function_ invoke__">write_all</span>(&amp;buffer).<span class="hljs-keyword">await</span>?;
        }
    }
    <span class="hljs-title function_ invoke__">Ok</span>(())
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šåˆ›å»ºç›®å½•</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">prepare_directories</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-keyword">if</span> !Path::<span class="hljs-title function_ invoke__">new</span>(SOURCE_DIR).<span class="hljs-title function_ invoke__">exists</span>() {
        fs::<span class="hljs-title function_ invoke__">create_dir</span>(SOURCE_DIR).<span class="hljs-keyword">await</span>?;
    }
    <span class="hljs-keyword">if</span> Path::<span class="hljs-title function_ invoke__">new</span>(TARGET_DIR).<span class="hljs-title function_ invoke__">exists</span>() {
        fs::<span class="hljs-title function_ invoke__">remove_dir_all</span>(TARGET_DIR).<span class="hljs-keyword">await</span>?;
    }
    fs::<span class="hljs-title function_ invoke__">create_dir</span>(TARGET_DIR).<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ee40f4912764679a82ee919d0289abd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKQ5qOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766899784&amp;x-signature=8LhsYkw3gwAGB3chTJX0gwA%2FAMM%3D" alt="69632d5619c1d1413d2d3a8d3f0a7618.jpg" loading="lazy"/></p>
<ol>
<li>
<p><strong>æ–‡ä»¶ç³»ç»Ÿçš„ Async I/O:</strong></p>
<ul>
<li><code>tokio::fs</code>Â æ¨¡å—é‡Œçš„ API (<code>read_dir</code>,Â <code>copy</code>,Â <code>File::create</code>) å’Œæ ‡å‡†åº“Â <code>std::fs</code>Â é•¿å¾—å‡ ä¹ä¸€æ ·ï¼Œä½†å®ƒä»¬å…¨æ˜¯Â <strong>éé˜»å¡</strong>Â çš„ã€‚</li>
<li>å½“ä½ è°ƒç”¨Â <code>fs::copy</code>Â æ—¶ï¼Œå¦‚æœç¡¬ç›˜å¿™ä¸è¿‡æ¥ï¼ŒTokio çº¿ç¨‹ä¼šå»å¤„ç†åˆ«çš„ä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¹²ç­‰ç€ã€‚</li>
</ul>
</li>
<li>
<p><strong>è§‚å¯Ÿç³»ç»Ÿç“¶é¢ˆ:</strong></p>
<ul>
<li>å½“ä½ è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œç›¯ç€ä½ çš„ä»»åŠ¡ç®¡ç†å™¨ã€‚</li>
<li><strong>å¦‚æœæ˜¯æœºæ¢°ç¡¬ç›˜ (HDD):</strong> Â ä½ çš„ååé‡å¯èƒ½åªæœ‰ 100MB/sï¼Œè€Œä¸”ä½ ä¼šå¬åˆ°ç¡¬ç›˜ç–¯ç‹‚å¯»é“çš„å£°éŸ³ï¼ˆç£å¤´åœ¨æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶ä¹‹é—´æ¥å›è·³ï¼‰ã€‚</li>
<li><strong>å¦‚æœæ˜¯å›ºæ€ç¡¬ç›˜ (NVMe SSD):</strong> Â ä½ å¯èƒ½ä¼šçœ‹åˆ° 1GB/s - 2GB/s çš„æƒŠäººé€Ÿåº¦ï¼Œç¬é—´è·‘å®Œã€‚</li>
</ul>
</li>
<li>
<p><strong>å¹¶å‘æ§åˆ¶ (Semaphore) çš„é‡è¦æ€§:</strong></p>
<ul>
<li>è¯•ç€æŠŠÂ <code>Semaphore::new(5)</code>Â æ”¹æˆÂ <code>Semaphore::new(100)</code>ã€‚</li>
<li>å¦‚æœåœ¨æœºæ¢°ç¡¬ç›˜ä¸Šï¼Œé€Ÿåº¦<strong>åè€Œä¼šå˜æ…¢</strong>ã€‚å› ä¸ºç£å¤´æ¥å›è·³è·ƒï¼ˆéšæœºè¯»å†™ï¼‰çš„å¼€é”€å¤ªå¤§äº†ï¼Œä¸å¦‚æ’é˜Ÿé¡ºåºè¯»å†™ï¼ˆé¡ºåº I/Oï¼‰å¿«ã€‚</li>
<li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä¾¿ç”¨äº†å¼‚æ­¥ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦<strong>é™æµ</strong>ã€‚</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„]]></title>    <link>https://juejin.cn/post/7585412203979030571</link>    <guid>https://juejin.cn/post/7585412203979030571</guid>    <pubDate>2025-12-20T09:51:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585412203979030571" data-draft-id="7585397173023195155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Go,åç«¯"/> <meta itemprop="datePublished" content="2025-12-20T09:51:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹ä¸­é˜³è®²AIç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2189882892232029"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            12 Go Eino AIåº”ç”¨å¼€å‘å®æˆ˜ | æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2189882892232029/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹ä¸­é˜³è®²AIç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T09:51:17.000Z" title="Sat Dec 20 2025 09:51:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,æ€æºé»‘ä½“ CN,æ€æºé»‘ä½“,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><blockquote>
<p>å£°æ˜ï¼šæœ¬AIåº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹é¦–å‘åœ¨åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5DYsyMKh9cDJdVvs_Mn9_Q" target="_blank" title="https://mp.weixin.qq.com/s/5DYsyMKh9cDJdVvs_Mn9_Q" ref="nofollow noopener noreferrer">ç‹ä¸­é˜³</a>ï¼Œæœªç»æˆæƒç¦æ­¢è½¬è½½ã€‚</p>
</blockquote>
<p>Go-Eino Interview Agent å¹³å°ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„å®ç°äº†ä¸€ä¸ªå¼‚æ­¥å¤„ç†ç³»ç»Ÿï¼Œæ—¨åœ¨å¤„ç†è¯„ä¼°æŠ¥å‘Šç”Ÿæˆå’Œä¸»é¢˜è¯„ä¼°ä»»åŠ¡ã€‚è¯¥æ¶æ„æä¾›å¯é çš„æ¶ˆæ¯ä¼ é€’ã€å¯æ‰©å±•çš„å¤„ç†èƒ½åŠ›ä»¥åŠçµæ´»çš„åç«¯å®ç°ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ¶æ„æ¦‚è¿°</h2>
<p>æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿé‡‡ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ”¯æŒå¯æ’æ‹”çš„åç«¯å®ç°ã€‚å®ƒæ—¢æ”¯æŒç”¨äºå¼€å‘/æµ‹è¯•çš„å†…å­˜é˜Ÿåˆ—ï¼Œä¹Ÿæ”¯æŒç”¨äºç”Ÿäº§ç¯å¢ƒçš„ Redis é˜Ÿåˆ—ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5570ebf622a74be6ab42619e23940e10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Lit6Ziz6K6yQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766829077&amp;x-signature=oJG%2F4tAgZA7VWroKdDqXnfdnXbk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">æ¶ˆæ¯é˜Ÿåˆ—æ¥å£è®¾è®¡</h2>
<p>ç³»ç»Ÿé€šè¿‡Â <code>MessageQueue</code>Â æ¥å£Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L40-L48" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L40-L48" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L40-L48</a>Â å®šä¹‰äº†æ¸…æ™°çš„æŠ½è±¡ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> MessageQueue <span class="hljs-keyword">interface</span> {
    Publish(ctx context.Context, message *Message) <span class="hljs-type">error</span>
    Subscribe(ctx context.Context, handler MessageHandler) <span class="hljs-type">error</span>
    Close() <span class="hljs-type">error</span>
}
</code></pre>
<p>è¯¥æ¥å£å®ç°äº†ä¸åŒé˜Ÿåˆ—å®ç°ä¹‹é—´çš„æ— ç¼åˆ‡æ¢ï¼ŒåŒæ—¶ä¿æŒæ•´ä¸ªåº”ç”¨ç¨‹åºçš„è¡Œä¸ºä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-2">æ¶ˆæ¯ç±»å‹å’Œç»“æ„</h2>
<p>ç³»ç»Ÿæ”¯æŒä¸¤ç§ä¸»è¦æ¶ˆæ¯ç±»å‹Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L12-L20" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L12-L20" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L12-L20</a>ï¼š</p>




















<table><thead><tr><th>æ¶ˆæ¯ç±»å‹</th><th>ç”¨é€”</th><th>è´Ÿè½½ç»“æ„</th></tr></thead><tbody><tr><td><code>evaluation_report</code></td><td>ç”Ÿæˆç»¼åˆè¯„ä¼°æŠ¥å‘Š</td><td><code>EvaluationReportPayload{UserID, ReportID}</code></td></tr><tr><td><code>topic_evaluation</code></td><td>å¤„ç†ç‰¹å®šä¸»é¢˜è¯„ä¼°</td><td><code>TopicEvaluationPayload{UserID, ReportID}</code></td></tr></tbody></table>
<p>æ¯æ¡æ¶ˆæ¯éµå¾ªæ ‡å‡†åŒ–ç»“æ„Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L22-L27" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L22-L27" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L22-L27</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Message <span class="hljs-keyword">struct</span> {
    Type    MessageType            <span class="hljs-string">`json:"type"`</span>
    Payload <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{} <span class="hljs-string">`json:"payload"`</span>
}
</code></pre>
<h2 data-id="heading-3">å®ç°ç­–ç•¥</h2>
<h3 data-id="heading-4">å†…å­˜é˜Ÿåˆ—å®ç°</h3>
<p><code>InMemoryQueue</code>Â ä¸ºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒæä¾›äº†è½»é‡çº§è§£å†³æ–¹æ¡ˆÂ <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L53-L125" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L53-L125" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L53-L125</a>ã€‚ä¸»è¦ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>ç¼“å†²åŒºç®¡ç†</strong>ï¼šå¯é…ç½®çš„ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤ä¸º 100 æ¡æ¶ˆæ¯</li>
<li><strong>å¹¶å‘å¤„ç†</strong>ï¼šå¤šä¸ªå¤„ç†å™¨å¼‚æ­¥å¤„ç†æ¶ˆæ¯</li>
<li><strong>ä¼˜é›…å…³é—­</strong>ï¼šæ­£ç¡®æ¸…ç†é€šé“å’Œ goroutine</li>
</ul>
<p>å†…å­˜å®ç°ä½¿ç”¨ç¼“å†²é€šé“é˜²æ­¢é«˜é¢‘æ¶ˆæ¯å‘å¸ƒæ—¶çš„é˜»å¡ï¼Œè€ŒåŸºäº goroutine çš„å¤„ç†ç¡®ä¿äº†éé˜»å¡çš„æ¶ˆæ¯å¤„ç†ã€‚</p>
<h3 data-id="heading-5">Redis é˜Ÿåˆ—å®ç°</h3>
<p>å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œ<code>RedisQueue</code>Â åˆ©ç”¨ Redis Pub/Sub å®ç°åˆ†å¸ƒå¼æ¶ˆæ¯å¤„ç†Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fredis_queue.go%23L13-L132" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/redis_queue.go#L13-L132" ref="nofollow noopener noreferrer">backend/internal/mq/redis_queue.go#L13-L132</a>ï¼š</p>
<p><strong>ä¸»è¦ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>åŸºäºé€šé“çš„è·¯ç”±</strong>ï¼šæ¶ˆæ¯æ ¹æ®ç±»å‹è·¯ç”±åˆ°ç‰¹å®šé€šé“</li>
<li><strong>å¤šä¸ªè®¢é˜…è€…</strong>ï¼šæ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…å®ä¾‹</li>
<li><strong>æŒä¹…è¿æ¥</strong>ï¼šé€šè¿‡æ­£ç¡®æ¸…ç†ç»´æŒç¨³å®šçš„ Redis è¿æ¥</li>
</ul>
<h2 data-id="heading-6">æ¶ˆè´¹è€…å¤„ç†æ¶æ„</h2>
<p>æ¶ˆè´¹è€…ç³»ç»Ÿé€šè¿‡Â <code>ConsumerHandler</code>Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L10-L89" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L10-L89" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L10-L89</a>Â å®ç°äº†å¥å£®çš„æ¶ˆæ¯å¤„ç†ç®¡é“ï¼š</p>
<h3 data-id="heading-7">æ¶ˆæ¯å¤„ç†æµç¨‹</h3>
<ol>
<li><strong>æ¶ˆæ¯è·¯ç”±</strong>ï¼šä½¿ç”¨ switch è¯­å¥æ ¹æ®ç±»å‹è·¯ç”±æ¶ˆæ¯</li>
<li><strong>è´Ÿè½½éªŒè¯</strong>ï¼šä»è´Ÿè½½ä¸­ç±»å‹å®‰å…¨åœ°æå– userID å’Œ reportID</li>
<li><strong>æœåŠ¡é›†æˆ</strong>ï¼šè°ƒç”¨è¯„ä¼°æœåŠ¡è¿›è¡Œå®é™…å¤„ç†</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå…¨é¢çš„æ—¥å¿—è®°å½•å’Œé”™è¯¯ä¼ æ’­</li>
</ol>
<h3 data-id="heading-8">è¯„ä¼°æœåŠ¡é›†æˆ</h3>
<p>æ¶ˆè´¹è€…ä¸ä¸¤ä¸ªå…³é”®è¯„ä¼°æœåŠ¡é›†æˆï¼š</p>
<ul>
<li><strong>GenerateRecordEvaluation</strong>ï¼šç”Ÿæˆç»¼åˆé¢è¯•è¯„ä¼°Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L42" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L42" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L42</a></li>
<li><strong>GenerateAnswerRecordEvaluation</strong>ï¼šå¤„ç†ä¸»é¢˜ç‰¹å®šè¯„ä¼°Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fconsumer.go%23L71" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/consumer.go#L71" ref="nofollow noopener noreferrer">backend/internal/mq/consumer.go#L71</a></li>
</ul>
<h2 data-id="heading-9">åˆå§‹åŒ–å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</h2>
<p>ç³»ç»Ÿåœ¨ä¸»åº”ç”¨ç¨‹åºä¸­å®ç°äº†æ­£ç¡®çš„åˆå§‹åŒ–æ¨¡å¼Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Fmain.go%23L79-L95" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/main.go#L79-L95" ref="nofollow noopener noreferrer">backend/main.go#L79-L95</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆå§‹åŒ– Redis æ¶ˆæ¯é˜Ÿåˆ—</span>
messageQueue := mq.NewRedisQueue(redisClient)
mq.InitMessageQueue(messageQueue)
 
<span class="hljs-comment">// åœ¨å•ç‹¬çš„ goroutine ä¸­å¯åŠ¨æ¶ˆè´¹è€…</span>
<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> err := mq.StartConsumer(consumerCtx); err != <span class="hljs-literal">nil</span> {
        log.Printf(<span class="hljs-string">"Error starting consumer: %v"</span>, err)
    }
}()
</code></pre>
<p>æ¶ˆè´¹è€…åœ¨å•ç‹¬çš„ goroutine ä¸­è¿è¡Œï¼Œä½¿ç”¨å¯å–æ¶ˆçš„ä¸Šä¸‹æ–‡ï¼Œåœ¨åº”ç”¨ç¨‹åºç»ˆæ­¢æ—¶å®ç°ä¼˜é›…å…³é—­å’Œæ­£ç¡®çš„èµ„æºæ¸…ç†ã€‚</p>
<h2 data-id="heading-10">å‘å¸ƒæ¨¡å¼</h2>
<p>ç³»ç»Ÿæä¾›äº†ä¾¿æ·çš„å‘å¸ƒå‡½æ•°ï¼ŒæŠ½è±¡äº†é˜Ÿåˆ—å®ç°ç»†èŠ‚ï¼š</p>
<h3 data-id="heading-11">è¯„ä¼°æŠ¥å‘Šå‘å¸ƒ</h3>
<p><code>PublishEvaluationReport</code>Â å‡½æ•°å¤„ç†å®Œæ•´çš„å‘å¸ƒå·¥ä½œæµÂ <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L155-L186" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L155-L186" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L155-L186</a>ï¼š</p>
<ol>
<li><strong>è´Ÿè½½æ„å»º</strong>ï¼šåˆ›å»ºç±»å‹åŒ–è´Ÿè½½ç»“æ„</li>
<li><strong>åºåˆ—åŒ–</strong>ï¼šè½¬æ¢ä¸º JSON ç„¶åè½¬æ¢ä¸ºé€šç”¨æ˜ å°„</li>
<li><strong>æ¶ˆæ¯åˆ›å»º</strong>ï¼šåŒ…è£…åœ¨æ ‡å‡† Message ç»“æ„ä¸­</li>
<li><strong>é˜Ÿåˆ—å‘å¸ƒ</strong>ï¼šé€šè¿‡å…¨å±€æ¶ˆæ¯é˜Ÿåˆ—å®ä¾‹è·¯ç”±</li>
</ol>
<h3 data-id="heading-12">ä¸»é¢˜è¯„ä¼°å‘å¸ƒ</h3>
<p>ç±»ä¼¼åœ°ï¼Œ<code>PublishTopicEvaluation</code>Â ä¸ºä¸»é¢˜è¯„ä¼°æ¶ˆæ¯æä¾›äº†ä¸“é—¨çš„æ¥å£Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L188-L209" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L188-L209" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L188-L209</a>ã€‚</p>
<h2 data-id="heading-13">é”™è¯¯å¤„ç†å’Œç›‘æ§</h2>
<p>ç³»ç»Ÿåœ¨æ•´ä¸ªæ¶ˆæ¯ç®¡é“ä¸­å®ç°äº†å…¨é¢çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•ï¼š</p>
<ul>
<li><strong>å‘å¸ƒæ—¶éªŒè¯</strong>ï¼šæ£€æŸ¥é˜Ÿåˆ—å¯ç”¨æ€§å’Œåºåˆ—åŒ–é”™è¯¯</li>
<li><strong>æ¶ˆè´¹è€…é”™è¯¯éš”ç¦»</strong>ï¼šå•ä¸ªæ¶ˆæ¯å¤„ç†å¤±è´¥ä¸å½±å“å…¶ä»–æ¶ˆæ¯</li>
<li><strong>è¯¦ç»†æ—¥å¿—</strong>ï¼šåœ¨æ¶ˆæ¯å¤„ç†çš„æ¯ä¸ªé˜¶æ®µè¿›è¡Œå…¨é¢æ—¥å¿—è®°å½•</li>
<li><strong>ä¼˜é›…é™çº§</strong>ï¼šå¦‚æœ Redis ä¸å¯ç”¨åˆ™å›é€€åˆ°å†…å­˜é˜Ÿåˆ—</li>
</ul>
<h2 data-id="heading-14">æ€§èƒ½è€ƒè™‘</h2>
<h3 data-id="heading-15">å¹¶å‘å¤„ç†</h3>
<p>ä¸¤ç§å®ç°éƒ½é€šè¿‡åŸºäº goroutine çš„å¤„ç†å™¨æ‰§è¡Œæ”¯æŒå¹¶å‘æ¶ˆæ¯å¤„ç†Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fwangzhongyang.com%2Fgo-eino-interview-agent%2Fbackend%2Finternal%2Fmq%2Fmq.go%23L108-L113" target="_blank" title="http://wangzhongyang.com/go-eino-interview-agent/backend/internal/mq/mq.go#L108-L113" ref="nofollow noopener noreferrer">backend/internal/mq/mq.go#L108-L113</a>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">for</span> _, handler := <span class="hljs-keyword">range</span> q.handlers {
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(h MessageHandler, msg *Message)</span></span> {
        <span class="hljs-keyword">if</span> err := h(ctx, msg); err != <span class="hljs-literal">nil</span> {
            log.Printf(<span class="hljs-string">"[MQ] Error processing message: %v, type: %s"</span>, err, msg.Type)
        }
    }(handler, message)
}
</code></pre>
<h3 data-id="heading-16">èµ„æºç®¡ç†</h3>
<p>ç³»ç»Ÿå®ç°äº†æ­£ç¡®çš„èµ„æºæ¸…ç†æ¨¡å¼ï¼š</p>
<ul>
<li><strong>é€šé“ç®¡ç†</strong>ï¼šç¼“å†²é€šé“é˜²æ­¢å†…å­˜æ³„æ¼</li>
<li><strong>ä¸Šä¸‹æ–‡å–æ¶ˆ</strong>ï¼šä¸ºé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæä¾›æ­£ç¡®çš„å…³é—­ä¿¡å·</li>
<li><strong>Redis è¿æ¥ç®¡ç†</strong>ï¼šå¤–éƒ¨ Redis å®¢æˆ·ç«¯ç”Ÿå‘½å‘¨æœŸå•ç‹¬ç®¡ç†</li>
</ul>
<h2 data-id="heading-17">é›†æˆç‚¹</h2>
<p>æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„ä¸å‡ ä¸ªå…³é”®ç³»ç»Ÿç»„ä»¶é›†æˆï¼š</p>
<ul>
<li><strong>API å±‚</strong>ï¼šREST ç«¯ç‚¹è§¦å‘æ¶ˆæ¯å‘å¸ƒ</li>
<li><strong>è¯„ä¼°æœåŠ¡</strong>ï¼šé¢è¯•è¯„ä¼°çš„å¼‚æ­¥å¤„ç†</li>
<li><strong>æ•°æ®åº“å±‚</strong>ï¼šè¯„ä¼°ç»“æœçš„æŒä¹…åŒ–å­˜å‚¨</li>
<li><strong>é…ç½®ç³»ç»Ÿ</strong>ï¼šé˜Ÿåˆ—ç±»å‹é€‰æ‹©å’Œè¿æ¥å‚æ•°</li>
</ul>
<p>è¯¥æ¶æ„ä¸ºå¯æ‰©å±•çš„å¼‚æ­¥å¤„ç†æä¾›äº†åšå®çš„åŸºç¡€ï¼ŒåŒæ—¶ä¸ºä¸åŒçš„éƒ¨ç½²åœºæ™¯å’Œæœªæ¥å¢å¼ºä¿æŒäº†çµæ´»æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ]]></title>    <link>https://juejin.cn/post/7585390679399333894</link>    <guid>https://juejin.cn/post/7585390679399333894</guid>    <pubDate>2025-12-20T07:02:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585390679399333894" data-draft-id="7585382553290686500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ"/> <meta itemprop="keywords" content="AIGC,LangChain"/> <meta itemprop="datePublished" content="2025-12-20T07:02:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘¨æœ«ç¨‹åºçŒ¿"/> <meta itemprop="url" content="https://juejin.cn/user/3245414056989757"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAGå®æˆ˜|8ç§RAGæ¶æ„æµ…æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3245414056989757/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘¨æœ«ç¨‹åºçŒ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T07:02:08.000Z" title="Sat Dec 20 2025 07:02:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å› ä¸ºé¡¹ç›®çš„éœ€è¦ï¼Œä¹‹å‰ç ”ç©¶äº†ä¸€æ®µæ—¶é—´çš„<code>RAG</code>ï¼Œäºæ˜¯æœ¬æ–‡æ€»ç»“ 8 ç§Â <code>RAG</code>Â æ¶æ„ï¼Œå¯¹æ¯ç§æ¶æ„è¿›è¡Œç®€è¦ä»‹ç»ï¼Œå¹¶ç”¨Â <code>langchain</code>Â å®ç°å…¶å‚è€ƒä»£ç ã€‚</p>
<h2 data-id="heading-0">1. Naive RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Naive RAG æ˜¯æœ€åŸºç¡€çš„æ£€ç´¢å¢å¼ºç”Ÿæˆæ¶æ„ï¼Œé‡‡ç”¨â€œç´¢å¼•-æ£€ç´¢-ç”Ÿæˆâ€çš„ç»å…¸æµç¨‹ã€‚<strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a791bbe7f4524e51b74053ad63de110f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=ku0AJbn3D7xRqqygvjDvDp5jEfs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æ•°æ®åŠ è½½ ï¼šæ”¶é›†æ•°æ®å¹¶è¿›è¡Œæ¸…æ´—ï¼Œæ¯”å¦‚å„ä¸ªæ–‡æ¡£æ ¼å¼çš„è½¬æ¢ï¼ŒOCR æ–‡å­—æå–ç­‰</li>
<li>åˆ†å—å’Œ embedding ï¼šå°†æ–‡æ¡£æ‹†åˆ†æ›´å°çš„ chunkï¼Œä¸€æ–¹é¢è®© embedding æ›´å¥½è½¬æ¢è¯­ä¹‰ä¿¡æ¯ï¼Œå¦ä¸€æ–¹é¢è§£å†³LLMçš„ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶é—®é¢˜</li>
<li>å‘é‡å­˜å‚¨ï¼šå°† embedding å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ä¸­ï¼Œæ–¹ä¾¿å¿«é€Ÿæœç´¢</li>
<li>search å’Œ Promptå·¥ç¨‹ï¼šå¯¹äºæŸ¥æ‰¾çš„é—®é¢˜å…ˆé€šè¿‡å‘é‡æ•°æ®åº“æ£€ç´¢ï¼Œç„¶åå°†å¬å›çš„æ–‡ä»¶åŸæ–‡ï¼Œé€šè¿‡ Prompt åŠ å·¥æä¾›ç»™LLM</li>
<li>è¾“å‡ºç­”æ¡ˆï¼šLLM æ ¹æ® Prompt ç”Ÿæˆç­”æ¡ˆè¾“å‡º</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.chainsÂ <span class="hljs-keyword">import</span>Â RetrievalQA
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â PromptTemplate
<span class="hljs-keyword">import</span>Â lancedb

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NaiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_naive_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-built_in">list</span></span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"naive_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ‰§è¡Œæ£€ç´¢å¹¶ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># åˆ›å»ºæ£€ç´¢é“¾</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">3</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt_template = PromptTemplate(
Â  Â  Â  Â  Â  Â  input_variables=[<span class="hljs-string">"context"</span>,Â <span class="hljs-string">"question"</span>],
Â  Â  Â  Â  Â  Â  template=<span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â  qa_chain = RetrievalQA.from_chain_type(
Â  Â  Â  Â  Â  Â  llm=self.llm,
Â  Â  Â  Â  Â  Â  chain_type=<span class="hljs-string">"stuff"</span>,
Â  Â  Â  Â  Â  Â  retriever=retriever,
Â  Â  Â  Â  Â  Â  chain_type_kwargs={<span class="hljs-string">"prompt"</span>: prompt_template}
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â qa_chain.invoke({<span class="hljs-string">"query"</span>: question})[<span class="hljs-string">"result"</span>]

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
naive_rag = NaiveRAG()
naive_rag.build_index([<span class="hljs-string">"æ–‡æ¡£1å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3å†…å®¹..."</span>])
answer = naive_rag.query(<span class="hljs-string">"What is issue date of lease?"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-1">2. Multi-Head RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Multi-Head RAG å€Ÿé‰´äº† Transformer çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼Œåˆ©ç”¨æ¨¡å‹ä¸åŒæ³¨æ„åŠ›å¤´æ•è·çš„å¤šæ ·åŒ–è¯­ä¹‰ç‰¹å¾è¿›è¡Œå¹¶è¡Œæ£€ç´¢ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2d889c3e8cf46d9a2bf9be204b3dbec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=YUXFtx%2FXAO9Q0PjbKx6buyMl9UY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>å¤šå¤´æ³¨æ„åŠ›Embeddingï¼šåˆ©ç”¨ Transformer æ¨¡å‹çš„å¤šå¤´æ³¨æ„åŠ›å±‚ï¼ˆè€Œéæœ€åä¸€å±‚ï¼‰ç”Ÿæˆå¤šä¸ªembeddingï¼Œæ¯ä¸ªå¤´æ•è·ä¸åŒçš„è¯­ä¹‰ç‰¹å¾</li>
<li>å¤šå‘é‡ç´¢å¼•æ„å»ºï¼šä¸ºæ¯ä¸ªæ³¨æ„åŠ›å¤´æ„å»ºç‹¬ç«‹çš„å‘é‡ç´¢å¼•ï¼Œå­˜å‚¨ä¸åŒç»´åº¦çš„è¯­ä¹‰ä¿¡æ¯</li>
<li>å¹¶è¡Œæ£€ç´¢ï¼šé’ˆå¯¹æŸ¥è¯¢ï¼Œåœ¨å¤šä¸ªç´¢å¼•ä¸Šå¹¶è¡Œæ£€ç´¢ï¼Œæ¯ä¸ªå¤´è¿”å›æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ</li>
<li>ç»“æœèåˆï¼šå°†å¤šä¸ªå¤´çš„æ£€ç´¢ç»“æœè¿›è¡Œå»é‡å’Œèåˆï¼Œç»¼åˆè€ƒè™‘ä¸åŒè¯­ä¹‰ç»´åº¦çš„ç›¸å…³æ€§</li>
<li>ä¸Šä¸‹æ–‡ç”Ÿæˆï¼šå°†èåˆåçš„æ–‡æ¡£ç‰‡æ®µç»„è£…æˆä¸Šä¸‹æ–‡ï¼Œè¾“å…¥LLMç”Ÿæˆç­”æ¡ˆ</li>
</ul>
<p><strong>ç›¸å…³å‚è€ƒå¦‚ä¸‹ï¼š</strong></p>
<p>è®ºæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2406.05085" target="_blank" title="https://arxiv.org/pdf/2406.05085" ref="nofollow noopener noreferrer">arxiv.org/pdf/2406.05â€¦</a></p>
<p>ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fspcl%2FMRAG" target="_blank" title="https://github.com/spcl/MRAG" ref="nofollow noopener noreferrer">github.com/spcl/MRAG</a></p>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.embeddings.baseÂ <span class="hljs-keyword">import</span>Â Embeddings
<span class="hljs-keyword">from</span>Â transformersÂ <span class="hljs-keyword">import</span>Â AutoModel, AutoTokenizer
<span class="hljs-keyword">import</span>Â torch
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">MultiHeadEmbeddings</span>(<span class="hljs-title class_ inherited__">Embeddings</span>):
Â  Â Â <span class="hljs-string">"""è‡ªå®šä¹‰å¤šå¤´æ³¨æ„åŠ›Embeddingï¼Œç»§æ‰¿LangChainçš„EmbeddingsåŸºç±»"""</span>
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name=<span class="hljs-string">"bert-base-uncased"</span>, head_index=<span class="hljs-number">0</span>, num_heads=<span class="hljs-number">12</span></span>):
Â  Â  Â  Â  self.tokenizer = AutoTokenizer.from_pretrained(model_name)
Â  Â  Â  Â  self.model = AutoModel.from_pretrained(model_name, output_hidden_states=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  self.head_index = head_index
Â  Â  Â  Â  self.num_heads = num_heads
Â  Â  Â  Â  self.head_dim =Â <span class="hljs-number">768</span>Â // num_heads Â <span class="hljs-comment"># BERT hidden size / num_heads</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">_get_head_embedding</span>(<span class="hljs-params">self, texts: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]]:
Â  Â  Â  Â Â <span class="hljs-string">"""è·å–æŒ‡å®šå¤´çš„embedding"""</span>
Â  Â  Â  Â  inputs = self.tokenizer(texts, return_tensors=<span class="hljs-string">"pt"</span>, padding=<span class="hljs-literal">True</span>, truncation=<span class="hljs-literal">True</span>)
Â  Â  Â  Â Â <span class="hljs-keyword">with</span>Â torch.no_grad():
Â  Â  Â  Â  Â  Â  outputs = self.model(**inputs, output_hidden_states=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  hidden_states = outputs.hidden_states[-<span class="hljs-number">2</span>] Â <span class="hljs-comment"># å€’æ•°ç¬¬äºŒå±‚</span>
Â  Â  Â  Â  start = self.head_index * self.head_dim
Â  Â  Â  Â  end = (self.head_index +Â <span class="hljs-number">1</span>) * self.head_dim
Â  Â  Â  Â  head_emb = hidden_states[:,Â <span class="hljs-number">0</span>, start:end].numpy()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â head_emb.tolist()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">embed_documents</span>(<span class="hljs-params">self, texts: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]]:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self._get_head_embedding(texts)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">embed_query</span>(<span class="hljs-params">self, text: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self._get_head_embedding([text])[<span class="hljs-number">0</span>]

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">MultiHeadRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, num_heads=<span class="hljs-number">12</span></span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.num_heads = num_heads
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_multihead_rag"</span>)
Â  Â  Â  Â  self.vectorstores = [] Â <span class="hljs-comment"># æ¯ä¸ªå¤´ä¸€ä¸ªå‘é‡å­˜å‚¨</span>
Â  Â  Â  Â  self.documents = []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºæ¯ä¸ªå¤´æ„å»ºç‹¬ç«‹çš„LanceDBå‘é‡å­˜å‚¨"""</span>
Â  Â  Â  Â  self.documents = documents
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â head_idxÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(self.num_heads):
Â  Â  Â  Â  Â  Â  embeddings = MultiHeadEmbeddings(head_index=head_idx, num_heads=self.num_heads)
Â  Â  Â  Â  Â  Â  vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  Â  Â  embeddings,
Â  Â  Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">f"head_<span class="hljs-subst">{head_idx}</span>_docs"</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  self.vectorstores.append(vectorstore)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">search</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">3</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""å¤šå¤´å¹¶è¡Œæ£€ç´¢å¹¶èåˆç»“æœ"""</span>
Â  Â  Â  Â  all_results = <span class="hljs-built_in">set</span>()
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â vectorstoreÂ <span class="hljs-keyword">in</span>Â self.vectorstores:
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=top_k)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â  Â  Â  all_results.add(doc.page_content)
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">list</span>(all_results)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ£€ç´¢å¹¶ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  retrieved_docs = self.search(question)
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n\n"</span>.join(retrieved_docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹å¤šç»´åº¦æ£€ç´¢çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â response.content

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
mrag = MultiHeadRAG(num_heads=<span class="hljs-number">12</span>)
documents = [<span class="hljs-string">"æ–‡æ¡£1çš„å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2çš„å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3çš„å†…å®¹..."</span>]
mrag.build_index(documents)
answer = mrag.query(<span class="hljs-string">"æŸ¥è¯¢é—®é¢˜"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-2">3. Corrective RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Corrective RAG åœ¨ä¼ ç»Ÿ RAG åŸºç¡€ä¸Šå¼•å…¥äº†æ–‡æ¡£è´¨é‡è¯„ä¼°å’Œè‡ªæˆ‘ä¿®æ­£æœºåˆ¶ã€‚å¯¹æ£€ç´¢åˆ°çš„æ¯ä¸ªæ–‡æ¡£è¿›è¡Œç›¸å…³æ€§è¯„åˆ†ï¼ˆCorrect/Incorrect/Ambiguousï¼‰ï¼Œå¯¹äºè´¨é‡ä¸è¶³çš„æ£€ç´¢ç»“æœï¼Œæœç´¢å¤–éƒ¨çŸ¥è¯†æºè¿›è¡Œè¡¥å……ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe0109c62e3e43f68ce49846a9450b74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=Wei8vQwsNIC1FczlF8K80NbNPsE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>åˆå§‹æ£€ç´¢ï¼šä½¿ç”¨å‘é‡æ£€ç´¢è·å–ä¸æŸ¥è¯¢ç›¸å…³çš„å€™é€‰æ–‡æ¡£</li>
<li>ç›¸å…³æ€§è¯„ä¼°ï¼šä½¿ç”¨LLMæˆ–ä¸“é—¨çš„è¯„ä¼°æ¨¡å‹å¯¹æ¯ä¸ªæ£€ç´¢åˆ°çš„æ–‡æ¡£è¿›è¡Œç›¸å…³æ€§è¯„åˆ†ï¼ˆCorrect/Incorrect/Ambiguousï¼‰</li>
<li>çŸ¥è¯†ä¿®æ­£ï¼šå¯¹äºè¯„ä¼°ä¸ºä¸ç›¸å…³æˆ–æ¨¡ç³Šçš„æ–‡æ¡£ï¼Œè§¦å‘çŸ¥è¯†ä¿®æ­£æœºåˆ¶</li>
<li>ç½‘ç»œæœç´¢å¢å¼ºï¼šå½“æœ¬åœ°çŸ¥è¯†åº“æ–‡æ¡£è´¨é‡ä¸è¶³æ—¶ï¼Œè°ƒç”¨å¤–éƒ¨æœç´¢å¼•æ“è·å–è¡¥å……ä¿¡æ¯</li>
<li>æ–‡æ¡£é‡ç»„ï¼šå°†è¯„ä¼°ä¸ºç›¸å…³çš„æ–‡æ¡£å’Œè¡¥å……æœç´¢ç»“æœé‡æ–°ç»„ç»‡ï¼Œå»é™¤å†—ä½™ä¿¡æ¯</li>
<li>ç­”æ¡ˆç”Ÿæˆï¼šåŸºäºä¿®æ­£åçš„é«˜è´¨é‡ä¸Šä¸‹æ–‡ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain_community.toolsÂ <span class="hljs-keyword">import</span>Â TavilySearchResults
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">CorrectiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_corrective_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨Tavilyè¿›è¡Œç½‘ç»œæœç´¢</span>
Â  Â  Â  Â  self.web_search = TavilySearchResults(max_results=<span class="hljs-number">3</span>)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"corrective_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_relevance</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ä»¥ä¸‹æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§ã€‚
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·å›ç­”: CORRECT(ç›¸å…³), INCORRECT(ä¸ç›¸å…³), æˆ– AMBIGUOUS(æ¨¡ç³Š)
Â  Â  Â  Â  Â  Â  åªè¿”å›ä¸€ä¸ªè¯ã€‚"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â response.strip().upper()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">search_web</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""å½“æœ¬åœ°æ–‡æ¡£ä¸è¶³æ—¶è¿›è¡Œç½‘ç»œæœç´¢"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  results = self.web_search.invoke(query)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â [r[<span class="hljs-string">"content"</span>]Â <span class="hljs-keyword">for</span>Â rÂ <span class="hljs-keyword">in</span>Â resultsÂ <span class="hljs-keyword">if</span><span class="hljs-string">"content"</span><span class="hljs-keyword">in</span>Â r]
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">retrieve_and_correct</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">5</span></span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""æ£€ç´¢å¹¶ä¿®æ­£æ–‡æ¡£"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆå§‹æ£€ç´¢</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: top_k})
Â  Â  Â  Â  docs = retriever.invoke(query)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. è¯„ä¼°æ¯ä¸ªæ–‡æ¡£çš„ç›¸å…³æ€§</span>
Â  Â  Â  Â  correct_docs = []
Â  Â  Â  Â  need_web_search =Â <span class="hljs-literal">True</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â  relevance = self.evaluate_relevance(query, doc.page_content)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â relevance ==Â <span class="hljs-string">"CORRECT"</span>:
Â  Â  Â  Â  Â  Â  Â  Â  correct_docs.append(doc.page_content)
Â  Â  Â  Â  Â  Â  Â  Â  need_web_search =Â <span class="hljs-literal">False</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">elif</span>Â relevance ==Â <span class="hljs-string">"AMBIGUOUS"</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å¯¹æ¨¡ç³Šæ–‡æ¡£è¿›è¡ŒçŸ¥è¯†ç²¾ç‚¼</span>
Â  Â  Â  Â  Â  Â  Â  Â  refined = self.refine_document(query, doc.page_content)
Â  Â  Â  Â  Â  Â  Â  Â  correct_docs.append(refined)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. å¿…è¦æ—¶è¿›è¡Œç½‘ç»œæœç´¢è¡¥å……</span>
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â need_web_searchÂ <span class="hljs-keyword">or</span>Â <span class="hljs-built_in">len</span>(correct_docs) &lt;Â <span class="hljs-number">2</span>:
Â  Â  Â  Â  Â  Â  web_results = self.search_web(query)
Â  Â  Â  Â  Â  Â  correct_docs.extend(web_results)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â correct_docs
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">refine_document</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç²¾ç‚¼æ–‡æ¡£ï¼Œæå–ä¸æŸ¥è¯¢ç›¸å…³çš„éƒ¨åˆ†"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä»ä»¥ä¸‹æ–‡æ¡£ä¸­æå–ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„ä¿¡æ¯ï¼š
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·åªè¿”å›ç›¸å…³çš„ç²¾ç‚¼å†…å®¹ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  corrected_docs = self.retrieve_and_correct(question)
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n\n"</span>.join(corrected_docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ç»è¿‡ä¿®æ­£çš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
crag = CorrectiveRAG()
crag.build_index([<span class="hljs-string">"æ–‡æ¡£1..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3..."</span>])
answer = crag.query(<span class="hljs-string">"ä½ çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-3">4. Agentic RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Agentic RAGï¼ˆæ™ºèƒ½ä½“RAGï¼‰å°† AI Agent çš„è§„åˆ’å’Œæ¨ç†èƒ½åŠ›ä¸ RAG ç›¸ç»“åˆã€‚<br/>
Agent å¯ä»¥è‡ªä¸»åˆ†ææŸ¥è¯¢ã€åˆ¶å®šæ£€ç´¢ç­–ç•¥ã€é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆè¯­ä¹‰æœç´¢ã€å…³é”®è¯æœç´¢ã€è®¡ç®—å™¨ç­‰ï¼‰ï¼Œå¹¶æ ¹æ®ä¸­é—´ç»“æœè¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2d4ac2fafbf4f2f8a4549436c5adc3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=nzUF6IDJ6xHC4IINPGVnM04N3Ig%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>Agentåˆå§‹åŒ–ï¼šåˆ›å»ºå…·æœ‰æ¨ç†å’Œè§„åˆ’èƒ½åŠ›çš„AI Agentï¼Œé…å¤‡æ£€ç´¢å·¥å…·</li>
<li>ä»»åŠ¡åˆ†è§£ï¼šAgentåˆ†æç”¨æˆ·æŸ¥è¯¢ï¼Œå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå­ä»»åŠ¡</li>
<li>å·¥å…·é€‰æ‹©ï¼šAgentæ ¹æ®å­ä»»åŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼ˆæ£€ç´¢ã€è®¡ç®—ã€APIè°ƒç”¨ç­‰ï¼‰</li>
<li>è¿­ä»£æ£€ç´¢ï¼šAgentå¯ä»¥æ ¹æ®ä¸­é—´ç»“æœå†³å®šæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æ£€ç´¢æˆ–è°ƒæ•´æŸ¥è¯¢ç­–ç•¥</li>
<li>æ¨ç†æ•´åˆï¼šAgentå¯¹å¤šè½®æ£€ç´¢å’Œå·¥å…·è°ƒç”¨çš„ç»“æœè¿›è¡Œæ¨ç†å’Œæ•´åˆ</li>
<li>è‡ªæˆ‘åæ€ï¼šAgentè¯„ä¼°ç­”æ¡ˆè´¨é‡ï¼Œå¿…è¦æ—¶è¿›è¡Œè‡ªæˆ‘ä¿®æ­£</li>
<li>æœ€ç»ˆè¾“å‡ºï¼šç”Ÿæˆå®Œæ•´ã€å‡†ç¡®çš„ç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.agentsÂ <span class="hljs-keyword">import</span>Â AgentExecutor, create_tool_calling_agent
<span class="hljs-keyword">from</span>Â langchain.toolsÂ <span class="hljs-keyword">import</span>Â tool
<span class="hljs-keyword">from</span>Â langchain_core.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate, MessagesPlaceholder
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AgenticRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_agentic_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â  self.agent_executor =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"agentic_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">setup_agent</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""é…ç½®Agentå’Œå·¥å…·"""</span>
Â  Â  Â  Â  vectorstore = self.vectorstore Â <span class="hljs-comment"># é—­åŒ…å¼•ç”¨</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">semantic_search</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºè¯­ä¹‰æœç´¢ï¼Œå½“éœ€è¦ç†è§£é—®é¢˜å«ä¹‰å¹¶æŸ¥æ‰¾ç›¸å…³æ–‡æ¡£æ—¶ä½¿ç”¨"""</span>
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=<span class="hljs-number">3</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">keyword_search</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºå…³é”®è¯æœç´¢ï¼Œå½“éœ€è¦ç²¾ç¡®åŒ¹é…ç‰¹å®šæœ¯è¯­æ—¶ä½¿ç”¨"""</span>
Â  Â  Â  Â  Â  Â  docs = vectorstore.similarity_search(query, k=<span class="hljs-number">2</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  @tool
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">calculator</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ç”¨äºæ•°å­¦è®¡ç®—ï¼Œè¾“å…¥æ•°å­¦è¡¨è¾¾å¼"""</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">str</span>(<span class="hljs-built_in">eval</span>(expression))
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"è®¡ç®—é”™è¯¯"</span>
Â  Â  Â  Â Â 
Â  Â  Â  Â  tools = [semantic_search, keyword_search, calculator]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨æ–°ç‰ˆæœ¬çš„Agentæç¤ºæ¨¡æ¿</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_messages([
Â  Â  Â  Â  Â  Â  (<span class="hljs-string">"system"</span>,Â <span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ¥å›ç­”é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  å¯ç”¨å·¥å…·ï¼š
Â  Â  Â  Â  Â  Â  - semantic_search: ç”¨äºè¯­ä¹‰æœç´¢ï¼ŒæŸ¥æ‰¾ç›¸å…³æ–‡æ¡£
Â  Â  Â  Â  Â  Â  - keyword_search: ç”¨äºå…³é”®è¯ç²¾ç¡®åŒ¹é…
Â  Â  Â  Â  Â  Â  - calculator: ç”¨äºæ•°å­¦è®¡ç®—
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·æ ¹æ®é—®é¢˜é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨å·¥å…·æ¥è·å–å®Œæ•´ä¿¡æ¯ã€‚"""</span>),
Â  Â  Â  Â  Â  Â  (<span class="hljs-string">"human"</span>,Â <span class="hljs-string">"{input}"</span>),
Â  Â  Â  Â  Â  Â  MessagesPlaceholder(variable_name=<span class="hljs-string">"agent_scratchpad"</span>)
Â  Â  Â  Â  ])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># åˆ›å»ºTool Calling Agent</span>
Â  Â  Â  Â  agent = create_tool_calling_agent(self.llm, tools, prompt)
Â  Â  Â  Â  self.agent_executor = AgentExecutor(
Â  Â  Â  Â  Â  Â  agent=agent,Â 
Â  Â  Â  Â  Â  Â  tools=tools,Â 
Â  Â  Â  Â  Â  Â  verbose=<span class="hljs-literal">True</span>,
Â  Â  Â  Â  Â  Â  max_iterations=<span class="hljs-number">5</span>,
Â  Â  Â  Â  Â  Â  handle_parsing_errors=<span class="hljs-literal">True</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""æ‰§è¡ŒæŸ¥è¯¢"""</span>
Â  Â  Â  Â Â ifnotÂ self.agent_executor:
Â  Â  Â  Â  Â  Â  self.setup_agent()
Â  Â  Â  Â  result = self.agent_executor.invoke({<span class="hljs-string">"input"</span>: question})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â result[<span class="hljs-string">"output"</span>]

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
arag = AgenticRAG()
arag.build_index([<span class="hljs-string">"äº§å“Aä»·æ ¼100å…ƒ..."</span>,Â <span class="hljs-string">"äº§å“Bä»·æ ¼200å…ƒ..."</span>,Â <span class="hljs-string">"ä¼˜æƒ æ”¿ç­–..."</span>])
answer = arag.query(<span class="hljs-string">"äº§å“Aå’Œäº§å“Bçš„æ€»ä»·æ˜¯å¤šå°‘ï¼Ÿæœ‰ä»€ä¹ˆä¼˜æƒ ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-4">5. Graph RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Graph RAG å°†çŸ¥è¯†å›¾è°±æŠ€æœ¯ä¸ RAG ç›¸ç»“åˆï¼Œé€šè¿‡ä»æ–‡æ¡£ä¸­æŠ½å–å®ä½“å’Œå…³ç³»æ„å»ºçŸ¥è¯†å›¾è°±ï¼Œå¹¶è¿›è¡Œç¤¾åŒºæ£€æµ‹å’Œæ‘˜è¦ç”Ÿæˆã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/156a00f8228c4cd6ad9d9a913b14922b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=1qbByKhMhrVkeQ42ZSiqfMkGUbc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>å®ä½“æŠ½å–ï¼šä½¿ç”¨NERæˆ–LLMä»æ–‡æ¡£ä¸­æŠ½å–å®ä½“ï¼ˆäººç‰©ã€åœ°ç‚¹ã€æ¦‚å¿µç­‰ï¼‰</li>
<li>å…³ç³»æŠ½å–ï¼šè¯†åˆ«å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œæ„å»ºä¸‰å…ƒç»„ï¼ˆå®ä½“-å…³ç³»-å®ä½“ï¼‰</li>
<li>çŸ¥è¯†å›¾è°±æ„å»ºï¼šå°†å®ä½“å’Œå…³ç³»å­˜å‚¨åˆ°å›¾æ•°æ®åº“ä¸­ï¼ˆå¦‚Neo4jï¼‰</li>
<li>ç¤¾åŒºæ£€æµ‹ï¼šå¯¹å›¾è¿›è¡Œç¤¾åŒºåˆ’åˆ†ï¼Œè¯†åˆ«ä¸»é¢˜èšç±»</li>
<li>ç¤¾åŒºæ‘˜è¦ï¼šä¸ºæ¯ä¸ªç¤¾åŒºç”Ÿæˆæ‘˜è¦æè¿°</li>
<li>å›¾æ£€ç´¢ï¼šæ ¹æ®æŸ¥è¯¢åœ¨çŸ¥è¯†å›¾è°±ä¸­æ£€ç´¢ç›¸å…³å­å›¾å’Œç¤¾åŒºæ‘˜è¦</li>
<li>ç­”æ¡ˆç”Ÿæˆï¼šç»“åˆå›¾ç»“æ„ä¿¡æ¯å’Œç¤¾åŒºæ‘˜è¦ç”Ÿæˆæ›´å…¨é¢çš„ç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.graphsÂ <span class="hljs-keyword">import</span>Â Neo4jGraph
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser, JsonOutputParser
<span class="hljs-keyword">import</span>Â networkxÂ <span class="hljs-keyword">as</span>Â nx
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>
<span class="hljs-keyword">import</span>Â json

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">GraphRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, neo4j_uri=<span class="hljs-string">"bolt://localhost:7687"</span>,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â neo4j_user=<span class="hljs-string">"neo4j"</span>, neo4j_password=<span class="hljs-string">"password"</span></span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨LangChainçš„Neo4jé›†æˆ</span>
Â  Â  Â  Â  self.graph_db = Neo4jGraph(
Â  Â  Â  Â  Â  Â  url=neo4j_uri,Â 
Â  Â  Â  Â  Â  Â  username=neo4j_user,Â 
Â  Â  Â  Â  Â  Â  password=neo4j_password
Â  Â  Â  Â  )
Â  Â  Â  Â  self.nx_graph = nx.Graph()
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">extract_entities_and_relations</span>(<span class="hljs-params">self, text: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä½¿ç”¨LLMæŠ½å–å®ä½“å’Œå…³ç³»"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä»ä»¥ä¸‹æ–‡æœ¬ä¸­æŠ½å–å®ä½“å’Œå…³ç³»ï¼Œè¿”å›JSONæ ¼å¼ï¼š
Â  Â  Â  Â  Â  Â  æ–‡æœ¬: {text}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼(åªè¿”å›JSON):
Â  Â  Â  Â  Â  Â  {{
Â  Â  Â  Â  Â  Â  Â  Â  "entities": ["å®ä½“1", "å®ä½“2", ...],
Â  Â  Â  Â  Â  Â  Â  Â  "relations": [["å®ä½“1", "å…³ç³»", "å®ä½“2"], ...]
Â  Â  Â  Â  Â  Â  }}"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"text"</span>: text})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â json.loads(response)
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {<span class="hljs-string">"entities"</span>: [],Â <span class="hljs-string">"relations"</span>: []}
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_knowledge_graph</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºçŸ¥è¯†å›¾è°±"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â documents:
Â  Â  Â  Â  Â  Â  extracted = self.extract_entities_and_relations(doc)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ·»åŠ åˆ°NetworkXå›¾</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â entityÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"entities"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  self.nx_graph.add_node(entity)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â relÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"relations"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(rel) ==Â <span class="hljs-number">3</span>:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  self.nx_graph.add_edge(rel[<span class="hljs-number">0</span>], rel[<span class="hljs-number">2</span>], relation=rel[<span class="hljs-number">1</span>])
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å­˜å‚¨åˆ°Neo4j</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â entityÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"entities"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  self.graph_db.query(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"MERGE (e:Entity {name: $name})"</span>,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"name"</span>: entity}
Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â relÂ <span class="hljs-keyword">in</span>Â extracted[<span class="hljs-string">"relations"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(rel) ==Â <span class="hljs-number">3</span>:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  self.graph_db.query(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""MATCH (a:Entity {name: $from})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â MATCH (b:Entity {name: $to})
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â MERGE (a)-[r:RELATED {type: $rel}]-&gt;(b)"""</span>,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"from"</span>: rel[<span class="hljs-number">0</span>],Â <span class="hljs-string">"to"</span>: rel[<span class="hljs-number">2</span>],Â <span class="hljs-string">"rel"</span>: rel[<span class="hljs-number">1</span>]}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">detect_communities</span>(<span class="hljs-params">self</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]]:
Â  Â  Â  Â Â <span class="hljs-string">"""ç¤¾åŒºæ£€æµ‹"""</span>
Â  Â  Â  Â Â <span class="hljs-keyword">from</span>Â networkx.algorithmsÂ <span class="hljs-keyword">import</span>Â community
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(self.nx_graph.nodes()) ==Â <span class="hljs-number">0</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â []
Â  Â  Â  Â  communities = community.louvain_communities(self.nx_graph)
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â [<span class="hljs-built_in">list</span>(c)Â <span class="hljs-keyword">for</span>Â cÂ <span class="hljs-keyword">in</span>Â communities]
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_community_summaries</span>(<span class="hljs-params">self, communities: <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]]</span>)Â -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºæ¯ä¸ªç¤¾åŒºç”Ÿæˆæ‘˜è¦"""</span>
Â  Â  Â  Â  summaries = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â i, commÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">enumerate</span>(communities):
Â  Â  Â  Â  Â  Â  subgraph = self.nx_graph.subgraph(comm)
Â  Â  Â  Â  Â  Â  edges_info = [(u, v, d.get(<span class="hljs-string">'relation'</span>,Â <span class="hljs-string">''</span>))Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span>Â u, v, dÂ <span class="hljs-keyword">in</span>Â subgraph.edges(data=<span class="hljs-literal">True</span>)]
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ºä»¥ä¸‹å®ä½“ç¾¤ç»„ç”Ÿæˆç®€çŸ­æ‘˜è¦ï¼š
Â  Â  Â  Â  Â  Â  Â  Â  å®ä½“: {entities}
Â  Â  Â  Â  Â  Â  Â  Â  å…³ç³»: {relations}
Â  Â  Â  Â  Â  Â  Â  Â  æ‘˜è¦:"""</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  Â  Â  summary = chain.invoke({<span class="hljs-string">"entities"</span>: comm,Â <span class="hljs-string">"relations"</span>: edges_info})
Â  Â  Â  Â  Â  Â  summaries.append({<span class="hljs-string">"community"</span>: i,Â <span class="hljs-string">"entities"</span>: comm,Â <span class="hljs-string">"summary"</span>: summary})
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â summaries
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºå›¾çš„æ£€ç´¢å’Œå›ç­”"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. ä»é—®é¢˜ä¸­æå–å…³é”®å®ä½“</span>
Â  Â  Â  Â  entities = self.extract_entities_and_relations(question)[<span class="hljs-string">"entities"</span>]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. åœ¨Neo4jä¸­æŸ¥æ‰¾ç›¸å…³å­å›¾</span>
Â  Â  Â  Â  graph_context = self.graph_db.query(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""MATCH (e:Entity)-[r]-(related)
Â  Â  Â  Â  Â  Â  Â  Â WHERE e.name IN $entities
Â  Â  Â  Â  Â  Â  Â  Â RETURN e.name AS entity, type(r) AS rel_type,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.type AS relation, related.name AS related_entity
Â  Â  Â  Â  Â  Â  Â  Â LIMIT 20"""</span>,
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"entities"</span>: entities}
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. è·å–ç¤¾åŒºæ‘˜è¦</span>
Â  Â  Â  Â  communities = self.detect_communities()
Â  Â  Â  Â  summaries = self.generate_community_summaries(communities[:<span class="hljs-number">3</span>])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. ç”Ÿæˆç­”æ¡ˆ</span>
Â  Â  Â  Â  context =Â <span class="hljs-string">f"å›¾å…³ç³»:Â <span class="hljs-subst">{graph_context}</span>\nç¤¾åŒºæ‘˜è¦:Â <span class="hljs-subst">{summaries}</span>"</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹çŸ¥è¯†å›¾è°±ä¿¡æ¯å›ç­”é—®é¢˜ï¼š
Â  Â  Â  Â  Â  Â  {context}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: question})

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
grag = GraphRAG()
grag.build_knowledge_graph([
Â  Â Â <span class="hljs-string">"å¼ ä¸‰æ˜¯ABCå…¬å¸çš„CEOï¼Œè¯¥å…¬å¸ä½äºåŒ—äº¬"</span>,
Â  Â Â <span class="hljs-string">"æå››æ˜¯ABCå…¬å¸çš„CTOï¼Œä»–ä¸å¼ ä¸‰æ˜¯å¤§å­¦åŒå­¦"</span>,
Â  Â Â <span class="hljs-string">"ABCå…¬å¸å¼€å‘äº†äº§å“Xï¼Œå¸‚åœºä»½é¢é¢†å…ˆ"</span>
])
answer = grag.query(<span class="hljs-string">"ABCå…¬å¸çš„é¢†å¯¼å±‚æœ‰å“ªäº›äººï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-5">6. Self RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Self RAG æä¾›ç»™æ¨¡å‹è‡ªæˆ‘è¯„ä¼°å’Œå†³ç­–èƒ½åŠ›ï¼Œå®ƒé€šè¿‡å››ä¸ªåæ€æ ‡è®°ï¼ˆRetrieve/ISREL/ISSUP/ISUSEï¼‰æ¥åˆ¤æ–­ï¼šæ˜¯å¦éœ€è¦æ£€ç´¢ã€æ–‡æ¡£æ˜¯å¦ç›¸å…³ã€ç­”æ¡ˆæ˜¯å¦è¢«æ”¯æŒã€ç­”æ¡ˆæ˜¯å¦æœ‰ç”¨ï¼Œæ¨¡å‹ä¼šç”Ÿæˆå¤šä¸ªå€™é€‰ç­”æ¡ˆå¹¶ç»¼åˆè¯„åˆ†ï¼Œé€‰æ‹©æœ€ä¼˜ç»“æœè¾“å‡ºã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f305a7dcc64a4d119b93fc171c739451~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=568LwX2VOeLFWFTprYECRBOGzH0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æ£€ç´¢å†³ç­–ï¼šæ¨¡å‹é¦–å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ£€ç´¢ï¼ˆç”ŸæˆRetrieveæ ‡è®°ï¼‰</li>
<li>æŒ‰éœ€æ£€ç´¢ï¼šå¦‚æœéœ€è¦æ£€ç´¢ï¼Œä»çŸ¥è¯†åº“ä¸­è·å–ç›¸å…³æ–‡æ¡£</li>
<li>ç›¸å…³æ€§è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°æ£€ç´¢åˆ°çš„æ–‡æ¡£æ˜¯å¦ä¸æŸ¥è¯¢ç›¸å…³ï¼ˆç”ŸæˆISRELæ ‡è®°ï¼‰</li>
<li>æ”¯æŒåº¦è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°ç”Ÿæˆçš„å†…å®¹æ˜¯å¦è¢«æ£€ç´¢æ–‡æ¡£æ”¯æŒï¼ˆç”ŸæˆISSUPæ ‡è®°ï¼‰</li>
<li>æœ‰ç”¨æ€§è¯„ä¼°ï¼šæ¨¡å‹è¯„ä¼°ç”Ÿæˆçš„å›ç­”æ˜¯å¦å¯¹ç”¨æˆ·æœ‰ç”¨ï¼ˆç”ŸæˆISUSEæ ‡è®°ï¼‰</li>
<li>è‡ªé€‚åº”ç”Ÿæˆï¼šåŸºäºä»¥ä¸Šè¯„ä¼°æ ‡è®°ï¼Œæ¨¡å‹å†³å®šæ˜¯å¦ä½¿ç”¨æ£€ç´¢å†…å®¹ã€é‡æ–°æ£€ç´¢æˆ–ç›´æ¥ç”Ÿæˆ</li>
<li>è¾“å‡ºæœ€ä¼˜ç­”æ¡ˆï¼šé€‰æ‹©è¯„åˆ†æœ€é«˜çš„ç”Ÿæˆç»“æœä½œä¸ºæœ€ç»ˆè¾“å‡º</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Tuple</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SelfRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_self_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"self_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">should_retrieve</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">bool</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ¤æ–­æ˜¯å¦éœ€è¦æ£€ç´¢ (Retrieveæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åˆ¤æ–­ä»¥ä¸‹é—®é¢˜æ˜¯å¦éœ€è¦æ£€ç´¢å¤–éƒ¨çŸ¥è¯†æ¥å›ç­”ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  å¦‚æœé—®é¢˜éœ€è¦äº‹å®æ€§çŸ¥è¯†ã€æœ€æ–°ä¿¡æ¯æˆ–ç‰¹å®šé¢†åŸŸçŸ¥è¯†ï¼Œå›ç­”YESã€‚
Â  Â  Â  Â  Â  Â  å¦‚æœé—®é¢˜æ˜¯é€šç”¨é—®é¢˜æˆ–æ¨ç†é—®é¢˜ï¼Œå›ç­”NOã€‚
Â  Â  Â  Â  Â  Â  åªå›ç­”YESæˆ–NO:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query}).strip().upper()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"YES"</span><span class="hljs-keyword">in</span>Â response
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_relevance</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, document: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ç›¸å…³æ€§ (ISRELæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°æ–‡æ¡£ä¸é—®é¢˜çš„ç›¸å…³æ€§ï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±
Â  Â  Â  Â  Â  Â  ç¤ºä¾‹: 4|æ–‡æ¡£ç›´æ¥å›ç­”äº†é—®é¢˜çš„æ ¸å¿ƒå†…å®¹"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"document"</span>: document})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_support</span>(<span class="hljs-params">self, document: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£æ”¯æŒ (ISSUPæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£å†…å®¹æ”¯æŒï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  æ–‡æ¡£: {document}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"document"</span>: document,Â <span class="hljs-string">"answer"</span>: answer})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_usefulness</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">float</span>]:
Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆæœ‰ç”¨æ€§ (ISUSEæ ‡è®°)"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ç­”æ¡ˆå¯¹ç”¨æˆ·é—®é¢˜çš„æœ‰ç”¨ç¨‹åº¦ï¼Œæ‰“åˆ†1-5åˆ†ã€‚
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: åˆ†æ•°|ç†ç”±"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"answer"</span>: answer})
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  score = <span class="hljs-built_in">int</span>(response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">0</span>].strip())
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â score &gt;=Â <span class="hljs-number">3</span>, score /Â <span class="hljs-number">5.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â returnTrue,Â <span class="hljs-number">0.6</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_with_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä¸Šä¸‹æ–‡ç”Ÿæˆç­”æ¡ˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚å¦‚æœä¸Šä¸‹æ–‡ä¸è¶³ä»¥å›ç­”ï¼Œè¯·è¯´æ˜ã€‚
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ:"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_without_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸ä½¿ç”¨æ£€ç´¢ç›´æ¥ç”Ÿæˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"è¯·å›ç­”ä»¥ä¸‹é—®é¢˜: {query}"</span>)
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""Self-RAGä¸»æµç¨‹"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. æ£€ç´¢å†³ç­–</span>
Â  Â  Â  Â  need_retrieval = self.should_retrieve(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â ifnotÂ need_retrieval:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç›´æ¥ç”Ÿæˆ</span>
Â  Â  Â  Â  Â  Â  answer = self.generate_without_context(question)
Â  Â  Â  Â  Â  Â  _, usefulness = self.evaluate_usefulness(question, answer)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â answer
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. æ£€ç´¢æ–‡æ¡£</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">3</span>})
Â  Â  Â  Â  docs = retriever.invoke(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. å¯¹æ¯ä¸ªæ–‡æ¡£ç”Ÿæˆå€™é€‰ç­”æ¡ˆå¹¶è¯„åˆ†</span>
Â  Â  Â  Â  candidates = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°ç›¸å…³æ€§ (ISREL)</span>
Â  Â  Â  Â  Â  Â  is_relevant, rel_score = self.evaluate_relevance(question, doc.page_content)
Â  Â  Â  Â  Â  Â Â ifnotÂ is_relevant:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">continue</span>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç”Ÿæˆç­”æ¡ˆ</span>
Â  Â  Â  Â  Â  Â  answer = self.generate_with_context(question, doc.page_content)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°æ”¯æŒåº¦ (ISSUP)</span>
Â  Â  Â  Â  Â  Â  is_supported, sup_score = self.evaluate_support(doc.page_content, answer)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è¯„ä¼°æœ‰ç”¨æ€§ (ISUSE)</span>
Â  Â  Â  Â  Â  Â  is_useful, use_score = self.evaluate_usefulness(question, answer)
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># ç»¼åˆè¯„åˆ†</span>
Â  Â  Â  Â  Â  Â  total_score = rel_score *Â <span class="hljs-number">0.3</span>Â + sup_score *Â <span class="hljs-number">0.4</span>Â + use_score *Â <span class="hljs-number">0.3</span>
Â  Â  Â  Â  Â  Â  candidates.append((answer, total_score))
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. é€‰æ‹©æœ€ä½³ç­”æ¡ˆ</span>
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â candidates:
Â  Â  Â  Â  Â  Â  candidates.sort(key=<span class="hljs-keyword">lambda</span>Â x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â candidates[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]
Â  Â  Â  Â Â <span class="hljs-keyword">else</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># å¦‚æœæ²¡æœ‰åˆé€‚çš„æ£€ç´¢ç»“æœï¼Œç›´æ¥ç”Ÿæˆ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â self.generate_without_context(question)

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
srag = SelfRAG()
srag.build_index([<span class="hljs-string">"æ–‡æ¡£1å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£2å†…å®¹..."</span>,Â <span class="hljs-string">"æ–‡æ¡£3å†…å®¹..."</span>])
answer = srag.query(<span class="hljs-string">"ä½ çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-6">7. Adaptive RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>Adaptive RAG æ ¹æ®æŸ¥è¯¢çš„ç±»å‹å’Œå¤æ‚åº¦åŠ¨æ€é€‰æ‹©æœ€ä¼˜çš„å¤„ç†ç­–ç•¥ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/867cf90ae2aa496eb94c184bbfc132a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=n8LHCBmrPpc99fZg4kO7JcJl4h0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>æŸ¥è¯¢åˆ†ç±»ï¼šåˆ†æç”¨æˆ·æŸ¥è¯¢çš„ç±»å‹å’Œå¤æ‚åº¦ï¼ˆç®€å•äº‹å®/å¤šè·³æ¨ç†/å¼€æ”¾æ€§é—®é¢˜ï¼‰</li>
<li>ç­–ç•¥é€‰æ‹©ï¼šæ ¹æ®æŸ¥è¯¢ç±»å‹é€‰æ‹©æœ€ä¼˜çš„RAGç­–ç•¥</li>
<li>
<ul>
<li>ç®€å•æŸ¥è¯¢ï¼šç›´æ¥LLMå›ç­”æˆ–å•æ¬¡æ£€ç´¢</li>
<li>å¤æ‚æŸ¥è¯¢ï¼šå¤šè½®è¿­ä»£æ£€ç´¢</li>
<li>å¼€æ”¾æ€§é—®é¢˜ï¼šç»“åˆç½‘ç»œæœç´¢</li>
</ul>
</li>
<li>åŠ¨æ€è·¯ç”±ï¼šå°†æŸ¥è¯¢è·¯ç”±åˆ°å¯¹åº”çš„å¤„ç†æµç¨‹</li>
<li>è‡ªé€‚åº”æ£€ç´¢ï¼šæ ¹æ®ä¸­é—´ç»“æœåŠ¨æ€è°ƒæ•´æ£€ç´¢æ·±åº¦å’ŒèŒƒå›´</li>
<li>ç»“æœæ•´åˆï¼šæ•´åˆä¸åŒç­–ç•¥çš„ç»“æœç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_huggingfaceÂ <span class="hljs-keyword">import</span>Â HuggingFaceEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">from</span>Â langchain_core.runnablesÂ <span class="hljs-keyword">import</span>Â RunnableLambda, RunnablePassthrough
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â enumÂ <span class="hljs-keyword">import</span>Â Enum
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">QueryType</span>(<span class="hljs-title class_ inherited__">Enum</span>):
Â  Â  SIMPLE =Â <span class="hljs-string">"simple"</span>Â  Â  Â  Â  Â  Â <span class="hljs-comment"># ç®€å•äº‹å®æŸ¥è¯¢</span>
Â  Â  MULTI_HOP =Â <span class="hljs-string">"multi_hop"</span>Â  Â  Â <span class="hljs-comment"># å¤šè·³æ¨ç†æŸ¥è¯¢</span>
Â  Â  OPEN_ENDED =Â <span class="hljs-string">"open_ended"</span>Â  Â <span class="hljs-comment"># å¼€æ”¾æ€§é—®é¢˜</span>
Â  Â  NO_RETRIEVAL =Â <span class="hljs-string">"no_retrieval"</span><span class="hljs-comment"># ä¸éœ€è¦æ£€ç´¢</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AdaptiveRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-4"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨è½»é‡çº§çš„all-MiniLM-L6-v2æ¨¡å‹ï¼Œä»…80MB</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"sentence-transformers/all-MiniLM-L6-v2"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>}
Â  Â  Â  Â  )
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"/tmp/lancedb_adaptive_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºå‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"adaptive_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">classify_query</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; QueryType:
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ†ç±»æŸ¥è¯¢ç±»å‹"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åˆ†æä»¥ä¸‹æŸ¥è¯¢çš„ç±»å‹ï¼Œè¿”å›å¯¹åº”ç±»åˆ«ï¼š
Â  Â  Â  Â  Â  Â  æŸ¥è¯¢: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ç±»åˆ«è¯´æ˜:
Â  Â  Â  Â  Â  Â  - SIMPLE: ç®€å•çš„äº‹å®æ€§é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥ä»å•ä¸ªæ–‡æ¡£æ‰¾åˆ°ç­”æ¡ˆ
Â  Â  Â  Â  Â  Â  - MULTI_HOP: éœ€è¦ç»¼åˆå¤šä¸ªä¿¡æ¯æºè¿›è¡Œæ¨ç†çš„å¤æ‚é—®é¢˜
Â  Â  Â  Â  Â  Â  - OPEN_ENDED: å¼€æ”¾æ€§é—®é¢˜ï¼Œéœ€è¦å¹¿æ³›çš„çŸ¥è¯†å’Œåˆ›é€ æ€§æ€è€ƒ
Â  Â  Â  Â  Â  Â  - NO_RETRIEVAL: é€šç”¨çŸ¥è¯†é—®é¢˜ï¼Œä¸éœ€è¦æ£€ç´¢å³å¯å›ç­”
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  åªè¿”å›ç±»åˆ«åç§°(SIMPLE/MULTI_HOP/OPEN_ENDED/NO_RETRIEVAL):"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({<span class="hljs-string">"query"</span>: query}).strip().upper()
Â  Â  Â  Â  mapping = {
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"SIMPLE"</span>: QueryType.SIMPLE,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"MULTI_HOP"</span>: QueryType.MULTI_HOP,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"OPEN_ENDED"</span>: QueryType.OPEN_ENDED,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"NO_RETRIEVAL"</span>: QueryType.NO_RETRIEVAL
Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â mapping.get(response, QueryType.SIMPLE)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">simple_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç®€å•RAGï¼šå•æ¬¡æ£€ç´¢"""</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"åŸºäºä»¥ä¸‹å†…å®¹å›ç­”é—®é¢˜ï¼š\n{context}\n\né—®é¢˜ï¼š{question}\nç­”æ¡ˆï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">format_docs</span>(<span class="hljs-params">docs</span>):
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span><span class="hljs-string">"\n"</span>.join([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â  chain = (
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"context"</span>: retriever | format_docs,Â <span class="hljs-string">"question"</span>: RunnablePassthrough()}
Â  Â  Â  Â  Â  Â  | prompt
Â  Â  Â  Â  Â  Â  | self.llm
Â  Â  Â  Â  Â  Â  | StrOutputParser()
Â  Â  Â  Â  )
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke(query)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">multi_hop_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, max_hops: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">3</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""å¤šè·³RAGï¼šè¿­ä»£æ£€ç´¢"""</span>
Â  Â  Â  Â  accumulated_context = []
Â  Â  Â  Â  current_query = query
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â hopÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(max_hops):
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ£€ç´¢</span>
Â  Â  Â  Â  Â  Â  docs = retriever.invoke(current_query)
Â  Â  Â  Â  Â  Â  accumulated_context.extend([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å·²æœ‰è¶³å¤Ÿä¿¡æ¯</span>
Â  Â  Â  Â  Â  Â  context =Â <span class="hljs-string">"\n"</span>.join(accumulated_context)
Â  Â  Â  Â  Â  Â  check_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºå½“å‰æ”¶é›†çš„ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦è¶³å¤Ÿå›ç­”é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  æ”¶é›†çš„ä¿¡æ¯: {context}
Â  Â  Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  å›ç­”YESå¦‚æœä¿¡æ¯è¶³å¤Ÿï¼Œå›ç­”NOå¦‚æœéœ€è¦æ›´å¤šä¿¡æ¯ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  å¦‚æœå›ç­”NOï¼Œè¯·æä¾›ä¸‹ä¸€æ­¥åº”è¯¥æœç´¢çš„å­é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â  Â  Â  æ ¼å¼: YES æˆ– NO|å­é—®é¢˜"""</span>
Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  check_chain = check_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  Â  Â  check_response = check_chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â check_response.strip().upper().startswith(<span class="hljs-string">"YES"</span>):
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">break</span>
Â  Â  Â  Â  Â  Â Â eli<span class="hljs-string">f"|"</span><span class="hljs-keyword">in</span>Â check_response:
Â  Â  Â  Â  Â  Â  Â  Â  current_query = check_response.split(<span class="hljs-string">"|"</span>)[<span class="hljs-number">1</span>].strip()
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</span>
Â  Â  Â  Â  final_context =Â <span class="hljs-string">"\n"</span>.join(accumulated_context)
Â  Â  Â  Â  final_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ç»¼åˆä»¥ä¸‹ä¿¡æ¯å›ç­”é—®é¢˜ï¼š\n{context}\n\né—®é¢˜ï¼š{question}\nç­”æ¡ˆï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  final_chain = final_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â final_chain.invoke({<span class="hljs-string">"context"</span>: final_context,Â <span class="hljs-string">"question"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">open_ended_rag</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""å¼€æ”¾æ€§RAGï¼šå¹¿æ³›æ£€ç´¢+åˆ›é€ æ€§ç”Ÿæˆ"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># æ‰©å±•æŸ¥è¯¢</span>
Â  Â  Â  Â  expand_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"ä¸ºä»¥ä¸‹é—®é¢˜ç”Ÿæˆ3ä¸ªç›¸å…³çš„æœç´¢æŸ¥è¯¢ï¼š\n{query}\næŸ¥è¯¢åˆ—è¡¨ï¼š"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  expand_chain = expand_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  expanded = expand_chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â  Â  Â  queries = [query] + [q.strip()Â <span class="hljs-keyword">for</span>Â qÂ <span class="hljs-keyword">in</span>Â expanded.split(<span class="hljs-string">"\n"</span>)Â <span class="hljs-keyword">if</span>Â q.strip()][:<span class="hljs-number">3</span>]
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># å¤šæŸ¥è¯¢æ£€ç´¢</span>
Â  Â  Â  Â  retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">2</span>})
Â  Â  Â  Â  all_docs = []
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â qÂ <span class="hljs-keyword">in</span>Â queries:
Â  Â  Â  Â  Â  Â  docs = retriever.invoke(q)
Â  Â  Â  Â  Â  Â  all_docs.extend([d.page_contentÂ <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â docs])
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># å»é‡</span>
Â  Â  Â  Â  unique_docs = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(all_docs))
Â  Â  Â  Â  context =Â <span class="hljs-string">"\n"</span>.join(unique_docs[:<span class="hljs-number">5</span>])
Â  Â  Â  Â Â 
Â  Â  Â  Â  final_prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¿¡æ¯ï¼Œå¯¹é—®é¢˜ç»™å‡ºå…¨é¢ã€æœ‰è§åœ°çš„å›ç­”ï¼š
Â  Â  Â  Â  Â  Â  ä¿¡æ¯: {context}
Â  Â  Â  Â  Â  Â  é—®é¢˜: {question}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·æä¾›è¯¦ç»†çš„åˆ†æå’Œè§è§£ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  final_chain = final_prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â final_chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"question"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">no_retrieval_generate</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç›´æ¥ç”Ÿæˆï¼šä¸ä½¿ç”¨æ£€ç´¢"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(<span class="hljs-string">"è¯·å›ç­”ï¼š{query}"</span>)
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""è‡ªé€‚åº”æŸ¥è¯¢ä¸»æµç¨‹ - ä½¿ç”¨LangChainè·¯ç”±"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆ†ç±»æŸ¥è¯¢</span>
Â  Â  Â  Â  query_type = self.classify_query(question)
Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŸ¥è¯¢ç±»å‹:Â <span class="hljs-subst">{query_type.value}</span>"</span>)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. è·¯ç”±åˆ°å¯¹åº”ç­–ç•¥</span>
Â  Â  Â  Â  routing_map = {
Â  Â  Â  Â  Â  Â  QueryType.SIMPLE: self.simple_rag,
Â  Â  Â  Â  Â  Â  QueryType.MULTI_HOP: self.multi_hop_rag,
Â  Â  Â  Â  Â  Â  QueryType.OPEN_ENDED: self.open_ended_rag,
Â  Â  Â  Â  Â  Â  QueryType.NO_RETRIEVAL: self.no_retrieval_generate
Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â routing_map[query_type](question)

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
arag = AdaptiveRAG()
arag.build_index([<span class="hljs-string">"å…¬å¸è´¢æŠ¥æ•°æ®..."</span>,Â <span class="hljs-string">"å¸‚åœºåˆ†ææŠ¥å‘Š..."</span>,Â <span class="hljs-string">"è¡Œä¸šè¶‹åŠ¿..."</span>])
answer = arag.query(<span class="hljs-string">"åˆ†æå…¬å¸æœªæ¥çš„å‘å±•å‰æ™¯"</span>) Â <span class="hljs-comment"># ä¼šè¢«è¯†åˆ«ä¸ºOPEN_ENDED</span>
<span class="hljs-built_in">print</span>(answer)
</code></pre>
<h2 data-id="heading-7">8. SFR RAG</h2>
<p><strong>ç®€ä»‹ï¼š</strong></p>
<p>SFR RAGï¼ˆSalesforce Research RAGï¼‰æ˜¯å·¥ä¸šçº§é«˜è´¨é‡ RAG çš„æœ€ä½³å®è·µã€‚å®ƒé‡‡ç”¨ç»è¿‡æŒ‡ä»¤å¾®è°ƒçš„é«˜æ€§èƒ½ embedding æ¨¡å‹ï¼ˆå¦‚ BGEï¼‰ï¼Œç»“åˆ Cross-Encoder é‡æ’åºã€ä¸Šä¸‹æ–‡å‹ç¼©ã€å¼•ç”¨ç”Ÿæˆå’Œè´¨é‡éªŒè¯ç­‰å¤šé¡¹ä¼˜åŒ–æŠ€æœ¯ã€‚</p>
<p><strong>æ¶æ„ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad02654af9d646f2854979047c43080d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZGo5pyr56iL5bqP54y_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766818928&amp;x-signature=zLZu5nudCscefZbhgOBpnlaA%2BKA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ul>
<li>é«˜è´¨é‡Embeddingï¼šä½¿ç”¨SFRï¼ˆSalesforce Researchï¼‰çš„é«˜æ€§èƒ½embeddingæ¨¡å‹è¿›è¡Œæ–‡æ¡£å’ŒæŸ¥è¯¢ç¼–ç </li>
<li>æŒ‡ä»¤å¾®è°ƒæ£€ç´¢ï¼šä½¿ç”¨æŒ‡ä»¤å¾®è°ƒçš„æ£€ç´¢æ¨¡å‹ï¼Œæ”¯æŒå¤šç§æ£€ç´¢ä»»åŠ¡ï¼ˆé—®ç­”ã€æ‘˜è¦ã€äº‹å®æ ¸æŸ¥ç­‰ï¼‰</li>
<li>ä¸Šä¸‹æ–‡å‹ç¼©ï¼šå¯¹æ£€ç´¢åˆ°çš„æ–‡æ¡£è¿›è¡Œæ™ºèƒ½å‹ç¼©ï¼Œå»é™¤å†—ä½™ä¿¡æ¯</li>
<li>é‡æ’åºï¼šä½¿ç”¨ä¸“é—¨çš„é‡æ’åºæ¨¡å‹å¯¹å€™é€‰æ–‡æ¡£è¿›è¡Œç²¾ç»†æ’åº</li>
<li>å¼•ç”¨ç”Ÿæˆï¼šç”Ÿæˆç­”æ¡ˆæ—¶é™„å¸¦å¼•ç”¨æ¥æºï¼Œæé«˜å¯ä¿¡åº¦</li>
<li>è´¨é‡æ§åˆ¶ï¼šå¯¹ç”Ÿæˆç»“æœè¿›è¡Œäº‹å®æ€§æ£€éªŒå’Œè´¨é‡è¯„ä¼°</li>
</ul>
<p><strong>å‚è€ƒä»£ç ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span>Â langchain_openaiÂ <span class="hljs-keyword">import</span>Â ChatOpenAI
<span class="hljs-keyword">from</span>Â langchain_community.embeddingsÂ <span class="hljs-keyword">import</span>Â HuggingFaceBgeEmbeddings
<span class="hljs-keyword">from</span>Â langchain_community.vectorstoresÂ <span class="hljs-keyword">import</span>Â LanceDB
<span class="hljs-keyword">from</span>Â langchain_community.cross_encodersÂ <span class="hljs-keyword">import</span>Â HuggingFaceCrossEncoder
<span class="hljs-keyword">from</span>Â langchain.retrievers.document_compressorsÂ <span class="hljs-keyword">import</span>Â CrossEncoderReranker
<span class="hljs-keyword">from</span>Â langchain.retrieversÂ <span class="hljs-keyword">import</span>Â ContextualCompressionRetriever
<span class="hljs-keyword">from</span>Â langchain.schemaÂ <span class="hljs-keyword">import</span>Â Document
<span class="hljs-keyword">from</span>Â langchain.promptsÂ <span class="hljs-keyword">import</span>Â ChatPromptTemplate
<span class="hljs-keyword">from</span>Â langchain_core.output_parsersÂ <span class="hljs-keyword">import</span>Â StrOutputParser
<span class="hljs-keyword">import</span>Â lancedb
<span class="hljs-keyword">from</span>Â typingÂ <span class="hljs-keyword">import</span>Â <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SFRRAG</span>:
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
Â  Â  Â  Â Â <span class="hljs-comment"># ä½¿ç”¨BGEé«˜è´¨é‡Embeddingæ¨¡å‹</span>
Â  Â  Â  Â  self.embeddings = HuggingFaceBgeEmbeddings(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"BAAI/bge-large-en-v1.5"</span>,
Â  Â  Â  Â  Â  Â  model_kwargs={<span class="hljs-string">"device"</span>:Â <span class="hljs-string">"cpu"</span>},
Â  Â  Â  Â  Â  Â  encode_kwargs={<span class="hljs-string">"normalize_embeddings"</span>:Â <span class="hljs-literal">True</span>},
Â  Â  Â  Â  Â  Â  query_instruction=<span class="hljs-string">"ä¸ºæ£€ç´¢ä»»åŠ¡ç”ŸæˆæŸ¥è¯¢è¡¨ç¤º: "</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â <span class="hljs-comment"># é‡æ’åºæ¨¡å‹</span>
Â  Â  Â  Â  self.reranker_model = HuggingFaceCrossEncoder(
Â  Â  Â  Â  Â  Â  model_name=<span class="hljs-string">"cross-encoder/ms-marco-MiniLM-L-6-v2"</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  self.llm = ChatOpenAI(model=<span class="hljs-string">"gpt-5"</span>, temperature=<span class="hljs-number">0</span>)
Â  Â  Â  Â  self.db = lancedb.connect(<span class="hljs-string">"./lancedb_sfr_rag"</span>)
Â  Â  Â  Â  self.vectorstore =Â <span class="hljs-literal">None</span>
Â  Â  Â  Â  self.documents = []
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">build_index</span>(<span class="hljs-params">self, documents: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>):
Â  Â  Â  Â Â <span class="hljs-string">"""æ„å»ºé«˜è´¨é‡å‘é‡ç´¢å¼•"""</span>
Â  Â  Â  Â  self.documents = documents
Â  Â  Â  Â  docs = [Document(page_content=d)Â <span class="hljs-keyword">for</span>Â dÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  self.vectorstore = LanceDB.from_documents(
Â  Â  Â  Â  Â  Â  docs,Â 
Â  Â  Â  Â  Â  Â  self.embeddings,
Â  Â  Â  Â  Â  Â  connection=self.db,
Â  Â  Â  Â  Â  Â  table_name=<span class="hljs-string">"sfr_rag_docs"</span>
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_retriever_with_reranker</span>(<span class="hljs-params">self, top_k: <span class="hljs-built_in">int</span> =Â <span class="hljs-number">5</span></span>):
Â  Â  Â  Â Â <span class="hljs-string">"""åˆ›å»ºå¸¦é‡æ’åºçš„æ£€ç´¢å™¨"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># åŸºç¡€æ£€ç´¢å™¨</span>
Â  Â  Â  Â  base_retriever = self.vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">10</span>})
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># é‡æ’åºå‹ç¼©å™¨</span>
Â  Â  Â  Â  reranker = CrossEncoderReranker(
Â  Â  Â  Â  Â  Â  model=self.reranker_model,Â 
Â  Â  Â  Â  Â  Â  top_n=top_k
Â  Â  Â  Â  )
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># ç»„åˆæ£€ç´¢å™¨</span>
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â ContextualCompressionRetriever(
Â  Â  Â  Â  Â  Â  base_compressor=reranker,
Â  Â  Â  Â  Â  Â  base_retriever=base_retriever
Â  Â  Â  Â  )
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">compress_context</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, documents: <span class="hljs-type">List</span>[Document]</span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ä¸Šä¸‹æ–‡å‹ç¼©"""</span>
Â  Â  Â  Â  doc_texts =Â <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"[<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>]Â <span class="hljs-subst">{doc.page_content}</span>"</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â i, docÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">enumerate</span>(documents)])
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""æå–ä»¥ä¸‹æ–‡æ¡£ä¸­ä¸é—®é¢˜ç›¸å…³çš„å…³é”®ä¿¡æ¯ï¼š
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  æ–‡æ¡£:
Â  Â  Â  Â  Â  Â  {documents}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯·è¿”å›å‹ç¼©åçš„å…³é”®ä¿¡æ¯ï¼Œä¿ç•™æ–‡æ¡£ç¼–å·ä»¥ä¾¿å¼•ç”¨ï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"query"</span>: query,Â <span class="hljs-string">"documents"</span>: doc_texts})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">generate_with_citations</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-built_in">str</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""ç”Ÿæˆå¸¦å¼•ç”¨çš„ç­”æ¡ˆ"""</span>
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ï¼Œå¹¶æ ‡æ³¨å¼•ç”¨æ¥æº[1][2]ç­‰ã€‚
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ä¸Šä¸‹æ–‡: {context}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¦æ±‚ï¼š
Â  Â  Â  Â  Â  Â  1. å‡†ç¡®å›ç­”é—®é¢˜
Â  Â  Â  Â  Â  Â  2. åœ¨ç›¸å…³é™ˆè¿°åæ ‡æ³¨å¼•ç”¨æ¥æº
Â  Â  Â  Â  Â  Â  3. å¦‚æœä¸Šä¸‹æ–‡ä¸è¶³ä»¥å›ç­”ï¼Œè¯·è¯´æ˜
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆï¼š"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â chain.invoke({<span class="hljs-string">"context"</span>: context,Â <span class="hljs-string">"query"</span>: query})
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">verify_answer</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, answer: <span class="hljs-built_in">str</span>, documents: <span class="hljs-type">List</span>[Document]</span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""éªŒè¯ç­”æ¡ˆè´¨é‡"""</span>
Â  Â  Â  Â  doc_contents = [doc.page_contentÂ <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â documents]
Â  Â  Â  Â  prompt = ChatPromptTemplate.from_template(
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"""è¯„ä¼°ä»¥ä¸‹ç­”æ¡ˆçš„è´¨é‡ï¼š
Â  Â  Â  Â  Â  Â  é—®é¢˜: {query}
Â  Â  Â  Â  Â  Â  ç­”æ¡ˆ: {answer}
Â  Â  Â  Â  Â  Â  å‚è€ƒæ–‡æ¡£: {documents}
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¯„ä¼°ç»´åº¦(1-5åˆ†)ï¼š
Â  Â  Â  Â  Â  Â  1. å‡†ç¡®æ€§ï¼šç­”æ¡ˆæ˜¯å¦è¢«æ–‡æ¡£æ”¯æŒ
Â  Â  Â  Â  Â  Â  2. å®Œæ•´æ€§ï¼šç­”æ¡ˆæ˜¯å¦å…¨é¢å›ç­”äº†é—®é¢˜
Â  Â  Â  Â  Â  Â  3. ç›¸å…³æ€§ï¼šç­”æ¡ˆæ˜¯å¦ç´§æ‰£é—®é¢˜
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  è¿”å›æ ¼å¼: å‡†ç¡®æ€§åˆ†æ•°|å®Œæ•´æ€§åˆ†æ•°|ç›¸å…³æ€§åˆ†æ•°|æ€»è¯„"""</span>
Â  Â  Â  Â  )
Â  Â  Â  Â  chain = prompt | self.llm | StrOutputParser()
Â  Â  Â  Â  response = chain.invoke({
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"query"</span>: query,Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"answer"</span>: answer,Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"documents"</span>: doc_contents
Â  Â  Â  Â  })
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  parts = response.split(<span class="hljs-string">"|"</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"accuracy"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">0</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"completeness"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">1</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"relevance"</span>: <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">2</span>].strip()),
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"summary"</span>: parts[<span class="hljs-number">3</span>].strip()Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">len</span>(parts) &gt;Â <span class="hljs-number">3</span><span class="hljs-keyword">else</span><span class="hljs-string">""</span>
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {<span class="hljs-string">"accuracy"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"completeness"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"relevance"</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-string">"summary"</span>:Â <span class="hljs-string">""</span>}
Â  Â Â 
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">query</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>)Â -&gt; <span class="hljs-type">Dict</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""SFR-RAGä¸»æµç¨‹"""</span>
Â  Â  Â  Â Â <span class="hljs-comment"># 1. åˆå§‹æ£€ç´¢ + é‡æ’åº</span>
Â  Â  Â  Â  retriever = self.get_retriever_with_reranker(top_k=<span class="hljs-number">5</span>)
Â  Â  Â  Â  docs = retriever.invoke(question)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 2. ä¸Šä¸‹æ–‡å‹ç¼©</span>
Â  Â  Â  Â  compressed_context = self.compress_context(question, docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 3. ç”Ÿæˆå¸¦å¼•ç”¨çš„ç­”æ¡ˆ</span>
Â  Â  Â  Â  answer = self.generate_with_citations(question, compressed_context)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment"># 4. è´¨é‡éªŒè¯</span>
Â  Â  Â  Â  quality = self.verify_answer(question, answer, docs)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"answer"</span>: answer,
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"sources"</span>: [{<span class="hljs-string">"content"</span>: doc.page_content[:<span class="hljs-number">100</span>]}Â <span class="hljs-keyword">for</span>Â docÂ <span class="hljs-keyword">in</span>Â docs],
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"quality"</span>: quality
Â  Â  Â  Â  }

<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
sfr_rag = SFRRAG()
sfr_rag.build_index([
Â  Â Â <span class="hljs-string">"äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯..."</span>,
Â  Â Â <span class="hljs-string">"æœºå™¨å­¦ä¹ æ˜¯AIçš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€..."</span>,
Â  Â Â <span class="hljs-string">"æ·±åº¦å­¦ä¹ ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œå­¦ä¹ ..."</span>
])
result = sfr_rag.query(<span class="hljs-string">"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç­”æ¡ˆ:Â <span class="hljs-subst">{result[<span class="hljs-string">'answer'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è´¨é‡è¯„ä¼°:Â <span class="hljs-subst">{result[<span class="hljs-string">'quality'</span>]}</span>"</span>)
</code></pre>
<h2 data-id="heading-8">å‚è€ƒ</h2>
<p>ï¼ˆ1ï¼‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flangchain%2Foverview" target="_blank" title="https://docs.langchain.com/oss/python/langchain/overview" ref="nofollow noopener noreferrer">docs.langchain.com/oss/python/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€]]></title>    <link>https://juejin.cn/post/7585377128490532916</link>    <guid>https://juejin.cn/post/7585377128490532916</guid>    <pubDate>2025-12-19T16:19:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377128490532916" data-draft-id="7585385309891526656" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-19T16:19:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenAI ç”©å‡ºç‹ç‚¸ï¼šGPT-5.2-Codex ä¸Šçº¿ï¼Œè¿™æ¬¡å®ƒæƒ³åšä½ çš„â€œèµ›åšåˆä¼™äººâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T16:19:15.000Z" title="Fri Dec 19 2025 16:19:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è€å®è¯´ï¼Œåœ¨ AI æ¨¡å‹åƒä¸‹é¥ºå­ä¸€æ ·å‘å¸ƒçš„ 2025 å¹´å¹´åº•ï¼Œå¤§å®¶å¯¹â€œé¢ è¦†æ€§å‡çº§â€è¿™ä¸ªè¯æ—©å°±è„±æ•äº†ã€‚ä½† OpenAI åˆšåˆšåœ¨ 12 æœˆ 18 æ—¥æ‚„æ‚„æ”¾å‡ºçš„ GPT-5.2-Codexï¼Œè¿˜æ˜¯è®©ä¸å°‘ç†¬å¤œå†™ä»£ç çš„å·¥ç¨‹å¸ˆè™èº¯ä¸€éœ‡ã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯ GPT-5.2 çš„ä¸€ä¸ªå¾®è°ƒç‰ˆæœ¬ï¼Œæ›´åƒæ˜¯ä¸€æ¬¡é’ˆå¯¹ç¨‹åºå‘˜ç—›ç‚¹çš„â€œç²¾å‡†çˆ†ç ´â€ã€‚å¦‚æœè¯´ä»¥å‰çš„ AI æ˜¯å¸®ä½ è¡¥å…¨ä»£ç çš„å®ä¹ ç”Ÿï¼Œé‚£ä¹ˆè¿™æ¬¡ä¸Šçº¿çš„ Codexï¼Œæ›´åƒæ˜¯ä¸€ä¸ªèƒ½æ‰›äº‹å„¿çš„â€œé«˜çº§åˆä¼™äººâ€ã€‚</p>
<p>æˆ‘èŠ±äº†ä¸€ç‚¹æ—¶é—´æ‰’äº†æ‰’è¿™èƒŒåçš„æŠ€æœ¯ç»†èŠ‚å’Œå®æµ‹æ•°æ®ï¼Œæœ‰äº›ä¸œè¥¿ç¡®å®å€¼å¾—èŠèŠã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Feergertg-1024x468.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/eergertg-1024x468.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/355f433ab89041c0b69fbedcb6314329~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=%2B43n99d%2FOVt16Kd3ZC2FB%2FjRY8Q%3D" alt="eergertg" loading="lazy"/></a></p>
<h3 data-id="heading-0">å‘Šåˆ«â€œé‡‘é±¼è®°å¿†â€ï¼šä¸Šä¸‹æ–‡å‹ç¼©æŠ€æœ¯</h3>
<p>ä»¥å‰ç”¨ AI å†™ä»£ç ï¼Œæœ€å¤§çš„å´©æºƒç¬é—´æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä½ æŠŠæ•´ä¸ªé¡¹ç›®æ‰”ç»™å®ƒï¼ŒèŠåˆ°ç¬¬åè½®å¯¹è¯æ—¶ï¼Œå®ƒçªç„¶å¿˜è®°äº†å¼€å¤´å®šä¹‰çš„å˜é‡ã€‚</p>
<p>GPT-5.2-Codex æœ€å¤§çš„çœ‹ç‚¹å°±åœ¨äº**â€œä¸Šä¸‹æ–‡å‹ç¼©â€æŠ€æœ¯**ã€‚è¿™å¬èµ·æ¥å¾ˆå­¦æœ¯ï¼Œä½†ç”¨å¤§ç™½è¯è§£é‡Šå°±æ˜¯ï¼šå®ƒå­¦ä¼šäº†åˆ’é‡ç‚¹ã€‚</p>
<p>åœ¨å¤„ç†é‚£äº›æŒç»­æ•°å‘¨ã€ä»£ç é‡å·¨å¤§çš„å¤æ‚ä»»åŠ¡æ—¶ï¼Œå®ƒä¸å†æ˜¯å‚»å‚»åœ°æŠŠæ‰€æœ‰ Token å¡è¿›å†…å­˜ï¼Œè€Œæ˜¯èƒ½åŠ¨æ€å‹ç¼©æ¨ç†è¿‡ç¨‹ï¼Œä¿ç•™æ ¸å¿ƒé€»è¾‘ã€‚å®˜æ–¹æ•°æ®æ˜¾ç¤ºï¼Œè¿™ç§æœºåˆ¶è®© Token çš„ä½¿ç”¨æ•ˆç‡æå‡äº† 30%ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½ è¿›è¡Œå¤§è§„æ¨¡é‡æ„æˆ–è€…è·¨è¯­è¨€è¿ç§»è¿™ç§â€œé•¿è·‘â€ä»»åŠ¡æ—¶ï¼Œå®ƒä¸ä¼šè·‘åˆ°ä¸€åŠå°±æ–­ç‰‡å„¿ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Ferhgrth-1024x683.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/erhgrth-1024x683.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b3be86eeb07468e8d767efeaee43239~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=P9NbElypS3RM9w4sxLAojjMCRs0%3D" alt="erhgrth" loading="lazy"/></a></p>
<h3 data-id="heading-1">çœŸå®çš„å·¥ç¨‹èƒ½åŠ›ï¼Œè€Œä¸åªæ˜¯åˆ·é¢˜</h3>
<p>å¾ˆå¤šæ¨¡å‹åœ¨åš LeetCode ç®—æ³•é¢˜æ—¶çŒ›å¦‚è™ï¼Œä¸€åˆ°çœŸå®çš„ä¸šåŠ¡ä»£ç é‡Œå°±æ­‡èœã€‚OpenAI è¿™æ¬¡ä¼¼ä¹å¬åˆ°äº†å¼€å‘è€…çš„åæ§½ï¼Œä¸“é—¨å¼ºåŒ–äº† GPT-5.2-Codex çš„<strong>å·¥ç¨‹å®æˆ˜èƒ½åŠ›</strong>ã€‚</p>
<p>ä¸¤ä¸ªæ•°æ®å¾ˆæœ‰æ„æ€ï¼š</p>
<ol>
<li><strong>SWE-Bench Pro</strong>ï¼ˆè½¯ä»¶å·¥ç¨‹ä»»åŠ¡ï¼‰çš„å®Œæˆç‡å†²åˆ°äº† <strong>56.4%</strong>ã€‚åˆ«è§‰å¾—è¿™ä¸ªæ•°å­—ä½ï¼Œåœ¨å…¨æ˜¯å‘çš„çœŸå®è½¯ä»¶å¼€å‘ç¯å¢ƒä¸­ï¼Œèƒ½è¿‡åŠæ•°ä»»åŠ¡ä¸å‡ºé”™ï¼Œå·²ç»æ˜¯ç›®å‰çš„è¡Œä¸šå¤©èŠ±æ¿ã€‚</li>
<li><strong>Terminal-Bench 2.0</strong>ï¼ˆç»ˆç«¯æ“ä½œï¼‰å‡†ç¡®ç‡è¾¾åˆ°äº† <strong>64%</strong>ã€‚</li>
</ol>
<p>æ›´è´´å¿ƒçš„æ˜¯ï¼Œå®ƒç»ˆäºä¸å†åªæ˜¯ Linux ä¼˜å…ˆäº†ã€‚OpenAI ä¸“é—¨ä¼˜åŒ–äº†å®ƒåœ¨ <strong>åŸç”Ÿ Windows 10/11 ç¯å¢ƒ</strong>ä¸‹çš„è¡¨ç°ã€‚å¯¹äºé‚£äº›åœ¨è¿™ä¸ªç”Ÿæ€é‡Œæ‘¸çˆ¬æ»šæ‰“çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ç»å¯¹æ˜¯ä¸ªè¿Ÿæ¥çš„å¥½æ¶ˆæ¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Ffsdfsdg.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/fsdfsdg.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3962bef769b047538897b321eab0ce8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=EJYuxjqFNKMdBm8sWkHn4dPbYEs%3D" alt="fsdfsdg" loading="lazy"/></a></p>
<h3 data-id="heading-2">çœ‹åˆ°â€œè‰å›¾â€å°±èƒ½å†™ä»£ç </h3>
<p>è™½ç„¶æˆ‘ä»¬å¼ºè°ƒå®ƒæ˜¯ä¸ªåç«¯å¼ºæ‰‹ï¼Œä½†è¿™æ¬¡çš„è§†è§‰ç†è§£èƒ½åŠ›ä¹Ÿè®©äººå°è±¡æ·±åˆ»ã€‚</p>
<p>ä½ ç°åœ¨å¯ä»¥æŠŠä¸€å¼ ç”»åœ¨é¤å·¾çº¸ä¸Šçš„ UI è‰å›¾ï¼Œæˆ–è€…ä¸€å¼ å¤æ‚çš„æŠ€æœ¯æ¶æ„å›¾æ‰”ç»™å®ƒï¼Œå®ƒèƒ½ç›´æ¥ç†è§£å¹¶è½¬åŒ–ä¸ºåŸå‹çš„ä»£ç ã€‚è¿™å¯¹äºäº§å“ç»ç†æˆ–è€…å…¨æ ˆå¼€å‘è€…æ¥è¯´ï¼Œä»â€œæƒ³æ³•â€åˆ°â€œDemoâ€çš„æ—¶é—´è¢«æåº¦å‹ç¼©äº†ã€‚</p>
<h3 data-id="heading-3">ä¸€æŠŠåŒåˆƒå‰‘ï¼šå¼ºæ‚çš„å®‰å…¨æ”»é˜²èƒ½åŠ›</h3>
<p>è¿™é‡Œå¿…é¡»å¾—æä¸ªé†’ã€‚GPT-5.2-Codex çš„ä»£ç å®¡è®¡èƒ½åŠ›å¼ºå¾—æœ‰ç‚¹è®©äººå®³æ€•ã€‚</p>
<p>æœ‰ä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ï¼šå®‰å…¨ç ”ç©¶å‘˜ç”¨å®ƒçš„å‰ä»£æ¨¡å‹ï¼Œåœ¨ä¸€å‘¨å†…å°±æŒ–å‡ºäº† React æ¡†æ¶é‡Œçš„ä¸‰ä¸ªå®‰å…¨æ¼æ´ã€‚åˆ°äº†è¿™ä¸€ä»£ï¼Œå®ƒçš„é˜²å¾¡æ€§ç¼–ç¨‹å’Œæ¼æ´æŒ–æ˜èƒ½åŠ›æ›´ä¸Šäº†ä¸€å±‚æ¥¼ã€‚</p>
<p>æ­£å› ä¸ºè¿™æŠŠâ€œåˆ€â€å¤ªå¿«ï¼ŒOpenAI ç›®å‰é‡‡å–äº†éå¸¸è°¨æ…çš„å‘å¸ƒç­–ç•¥ã€‚è™½ç„¶ä»˜è´¹çš„ ChatGPT ç”¨æˆ·å·²ç»åœ¨ Codex ç•Œé¢é‡Œç”¨ä¸Šäº†ï¼Œä½† API æ¥å£è¿˜å¾—ç­‰å‡ å‘¨æ‰ä¼šé€æ­¥å¼€æ”¾ã€‚ç‰¹åˆ«æ˜¯é’ˆå¯¹é«˜é˜¶çš„ç½‘ç»œå®‰å…¨åŠŸèƒ½ï¼ŒOpenAI æäº†ä¸ªâ€œå¯ä¿¡è®¿é—®è¯•ç‚¹è®¡åˆ’â€ï¼Œç”Ÿæ€•è¢«åäººæ‹¿å»æç ´åã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fhryjytj-1024x809.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/hryjytj-1024x809.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc68bf1514f24b909f3fcd69852c463b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=4hPO1f%2FsW50MKfDhmCeuh%2FsfNCw%3D" alt="hryjytj" loading="lazy"/></a></p>
<h3 data-id="heading-4">å†™åœ¨æœ€å</h3>
<p>ç°åœ¨çš„ GPT-5.2-Codex å®Œç¾å—ï¼Ÿè‚¯å®šä¸ã€‚å®ƒä¾ç„¶æ˜‚è´µï¼Œä¾ç„¶éœ€è¦äººå·¥ Code Reviewï¼Œä¾ç„¶å¯èƒ½åœ¨ä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“ã€‚</p>
<p>ä½†å®ƒçš„å‡ºç°æ ‡å¿—ç€ä¸€ä¸ªè½¬å˜ï¼šAI æ­£åœ¨ä»ä¸€ä¸ªâ€œè¢«åŠ¨å“åº”â€çš„å·¥å…·ï¼Œå˜æˆä¸€ä¸ªèƒ½å¤Ÿâ€œä¸»åŠ¨æ‰§è¡Œâ€é•¿é“¾è·¯ä»»åŠ¡çš„æ™ºèƒ½ä½“ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬è¿™äº›å¼€å‘è€…æ¥è¯´ï¼Œå¥½æ¶ˆæ¯æ˜¯å¦‚æœä½ æœ‰â€œæ‹–å»¶ç—‡â€ï¼Œä¸çŸ¥é“å¤æ‚é¡¹ç›®ä»ä½•ä¸‹æ‰‹ï¼ŒæŠŠå®ƒå½“æˆæ€ç»´é™ªç»ƒå’Œèµ·æ­¥å·¥å…·ä¼šéå¸¸é¡ºæ‰‹ï¼›åæ¶ˆæ¯æ˜¯ï¼Œç•™ç»™åªä¼šå†™ CRUD çš„â€œä»£ç æ¬è¿å·¥â€çš„æ—¶é—´ï¼ŒçœŸçš„ä¸å¤šäº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2025%2F12%2Fsdgfdgdfh-1024x496.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2025/12/sdgfdgdfh-1024x496.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/986c94a5c40b42b08d4c6c3407b09b6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766765955&amp;x-signature=Lgt1JkThVJ6JIUKig0%2BTWDs9Tcc%3D" alt="sdgfdgdfh" loading="lazy"/></a></p>
<p>ç›®å‰è¿™ä¸ªæ¨¡å‹å·²ç»å‘æ‰€æœ‰ Plus ç”¨æˆ·å…¨é‡æ¨é€ã€‚å»ºè®®ä½ å»è¯•ç€ç”¨å®ƒè·‘ä¸€ä¸ªè¿˜æ²¡å¡«å®Œçš„å‘ï¼Œä¹Ÿè®¸ä¼šæœ‰æƒŠå–œã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº]]></title>    <link>https://juejin.cn/post/7571060853354283018</link>    <guid>https://juejin.cn/post/7571060853354283018</guid>    <pubDate>2025-11-10T15:58:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571060853354283018" data-draft-id="7570903763722436618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº"/> <!----> <meta itemprop="datePublished" content="2025-11-10T15:58:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¦å°”æ‘©æ–¯çš„å¼Ÿå­"/> <meta itemprop="url" content="https://juejin.cn/user/622743759107883"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/622743759107883/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¦å°”æ‘©æ–¯çš„å¼Ÿå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T15:58:40.000Z" title="Mon Nov 10 2025 15:58:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äº’è”ç½‘å¤§å‚é¢è¯•å®å½•ï¼šå½“ä¸¥è°¨é¢è¯•å®˜é‡ä¸Šæç¬‘ç¨‹åºå‘˜è°¢é£æœº</h2>
<h3 data-id="heading-1">é¢è¯•åœºæ™¯ï¼šæŸå¤§å‚æŠ€æœ¯äºŒé¢ç°åœºï¼Œä¼šè®®å®¤é‡Œåç€ä¸€ä½ç¥æƒ…ä¸¥è‚ƒçš„é¢è¯•å®˜ï¼Œå¯¹é¢æ˜¯æ»¡è„¸å†™ç€"æˆ‘å¯èƒ½è¦å‡‰äº†"çš„ç¨‹åºå‘˜è°¢é£æœºã€‚</h3>
<h4 data-id="heading-2"><strong>ç¬¬ä¸€è½®æé—®ï¼šåŸºç¡€å¤¯å®</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šè°¢é£æœºï¼Œå…ˆèŠèŠä½ å¯¹Javaå†…å­˜æ¨¡å‹çš„ç†è§£å§ã€‚æˆ‘ä»¬å…¬å¸ç”¨çš„æ˜¯JDK17ï¼Œä½ èƒ½è¯´è¯´å®ƒå’ŒJDK8åœ¨å†…å­˜æ¨¡å‹ä¸Šçš„ä¸»è¦åŒºåˆ«å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼ˆæŒ å¤´ï¼‰ï¼šå‘ƒâ€¦â€¦æˆ‘è®°å¾—å¥½åƒæœ‰å †ã€æ ˆã€æ–¹æ³•åŒºï¼Œè¿˜æœ‰ä¸ªå…ƒç©ºé—´å¯¹å§ï¼Ÿä»¥å‰å«æ°¸ä¹…ä»£ï¼Œç°åœ¨æ”¹åå«å…ƒç©ºé—´äº†ï¼Œå› ä¸ºâ€¦â€¦å—¯â€¦â€¦æ›´é«˜çº§äº†ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆå¾®å¾®ç‚¹å¤´ï¼‰ï¼šä¸é”™ï¼Œå›ç­”å¾—æŒºå‡†ç¡®ã€‚é‚£ä½ çŸ¥é“ä¸ºä»€ä¹ˆè¦æŠŠæ°¸ä¹…ä»£æ¢æˆå…ƒç©ºé—´å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå› ä¸ºâ€¦â€¦æ°¸ä¹…ä»£å®¹æ˜“å†…å­˜æº¢å‡ºï¼Œè€Œä¸”ä¸èƒ½åŠ¨æ€æ‰©å®¹ï¼Œè€Œå…ƒç©ºé—´æ˜¯æ”¾åœ¨æœ¬åœ°å†…å­˜é‡Œçš„ï¼Œä¸ä¼šå—å †å¤§å°é™åˆ¶ï¼Œæ‰€ä»¥æ›´ç¨³ï¼</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆå¾®ç¬‘ï¼‰ï¼šå¾ˆå¥½ï¼Œå›ç­”å¾—å¾ˆåˆ°ä½ã€‚ç»§ç»­ï¼Œè¯´è¯´volatileå…³é”®å­—çš„ä½œç”¨ï¼Œä»¥åŠå®ƒå¦‚ä½•ä¿è¯å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼Œvolatileå°±æ˜¯è®©å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œæ¯æ¬¡è¯»éƒ½ä»ä¸»å†…å­˜æ‹¿ï¼Œå†™ä¹Ÿç›´æ¥å†™åˆ°ä¸»å†…å­˜ï¼Œè¿™æ ·å°±ä¿è¯äº†å¯è§æ€§ã€‚è‡³äºæŒ‡ä»¤é‡æ’åºï¼Œå®ƒä¼šåŠ ä¸€ä¸ªå†…å­˜å±éšœï¼Œé˜»æ­¢ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¹±åºæ‰§è¡Œï¼Œå¯¹å§ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå®Œå…¨æ­£ç¡®ï¼Œçœ‹æ¥ä½ ç¡®å®æŒæ¡äº†æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h4 data-id="heading-3"><strong>ç¬¬äºŒè½®æé—®ï¼šå¹¶å‘ä¸çº¿ç¨‹æ± </strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥å¤šçº¿ç¨‹éƒ¨åˆ†ã€‚ä½ èƒ½ä¸èƒ½è§£é‡Šä¸€ä¸‹çº¿ç¨‹æ± çš„æ ¸å¿ƒå‚æ•°æœ‰å“ªäº›ï¼Ÿå®ƒä»¬å„è‡ªçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€å·¥ä½œé˜Ÿåˆ—ã€æ‹’ç»ç­–ç•¥ã€çº¿ç¨‹å·¥å‚ã€è¶…æ—¶æ—¶é—´â€¦â€¦å•Šï¼Œè¿˜æœ‰ä¸ªçº¿ç¨‹å­˜æ´»æ—¶é—´ã€‚æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯æœ€ä½ä¿æŒçš„çº¿ç¨‹æ•°é‡ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ˜¯ä¸Šé™ï¼Œå·¥ä½œé˜Ÿåˆ—æ”¾ä»»åŠ¡ï¼Œæ‹’ç»ç­–ç•¥å¤„ç†æ¥ä¸åŠçš„ä»»åŠ¡ï¼Œçº¿ç¨‹å·¥å‚ç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œå­˜æ´»æ—¶é—´æ˜¯ç©ºé—²çº¿ç¨‹ç­‰å¾…ä»»åŠ¡çš„æ—¶é—´ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸æ¸…æ™°ï¼Œé€»è¾‘å®Œæ•´ã€‚é‚£ä¹ˆï¼Œå¦‚æœä½¿ç”¨ThreadPoolExecutorï¼Œä½ å¦‚ä½•åˆç†è®¾ç½®è¿™äº›å‚æ•°æ¥åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Ÿæ¯”å¦‚ä¸€ä¸ªç§’æ€ç³»ç»Ÿã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼šå—¯â€¦â€¦æˆ‘è§‰å¾—å¯ä»¥è®¾æ ¸å¿ƒçº¿ç¨‹æ•°ä¸ºæœåŠ¡å™¨æ ¸æ•°çš„ä¸¤å€ï¼Œæœ€å¤§çº¿ç¨‹æ•°å¯ä»¥å†ç¿»å€ï¼Œå·¥ä½œé˜Ÿåˆ—ç”¨é˜»å¡é˜Ÿåˆ—ï¼Œæ¯”å¦‚LinkedBlockingQueueï¼Œæ‹’ç»ç­–ç•¥ç”¨CallerRunsPolicyï¼Œè¿™æ ·èƒ½é˜²æ­¢ç³»ç»Ÿé›ªå´©ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šæ€è·¯å¾ˆæ¸…æ™°ã€‚ä½†æœ‰æ²¡æœ‰è€ƒè™‘è¿‡é˜Ÿåˆ—é•¿åº¦è¿‡å¤§å¸¦æ¥çš„å†…å­˜å‹åŠ›ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå•Šâ€¦â€¦è¿™ä¸ªâ€¦â€¦æˆ‘è¿˜æ²¡æƒ³é‚£ä¹ˆæ·±â€¦â€¦ä¸è¿‡åæ­£æœ‰æ‹’ç»ç­–ç•¥å…œåº•å˜›ï¼Œåº”è¯¥æ²¡é—®é¢˜å§ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆè½»ç¬‘ï¼‰ï¼šå»ºè®®ä½ è®°ä½ä¸€å¥è¯ï¼š<strong>é˜Ÿåˆ—ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒåªæ˜¯å»¶è¿Ÿé—®é¢˜ï¼Œä¸æ˜¯è§£å†³é—®é¢˜</strong>ã€‚ç»§ç»­ï¼Œè¯´è¯´ä½ å¯¹ThreadLocalçš„ç†è§£ï¼Œå®ƒæœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼ŒThreadLocalå°±æ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å‰¯æœ¬ï¼Œäº’ä¸å¹²æ‰°ï¼Œé€‚åˆåšçº¿ç¨‹éš”ç¦»ï¼Œæ¯”å¦‚ä¿å­˜ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€äº‹åŠ¡ä¸Šä¸‹æ–‡ä»€ä¹ˆçš„ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚ä½†è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå•Šâ€¦â€¦è¦è®°å¾—åœ¨finallyé‡Œremoveæ‰ï¼Œä¸ç„¶å¯èƒ½å†…å­˜æ³„æ¼â€¦â€¦</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¯¹ï¼Œè¿™æ˜¯å…³é”®ç‚¹ï¼Œå¾ˆå¤šæ–°äººä¼šå¿½ç•¥ã€‚</p>
<h4 data-id="heading-4"><strong>ç¬¬ä¸‰è½®æé—®ï¼šæ¡†æ¶ä¸ä¸­é—´ä»¶</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ã€‚ç°åœ¨æˆ‘ä»¬è¿›å…¥æ¡†æ¶éƒ¨åˆ†ã€‚ä½ ç”¨è¿‡Spring Bootï¼Œèƒ½è¯´è¯´å®ƒçš„è‡ªåŠ¨è£…é…æœºåˆ¶æ˜¯æ€ä¹ˆå·¥ä½œçš„å—ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå“¦ï¼Œè‡ªåŠ¨è£…é…å°±æ˜¯é€šè¿‡@Importã€@ConditionalOnClassè¿™äº›æ³¨è§£ï¼Œæ ¹æ®ç±»è·¯å¾„æ˜¯å¦å­˜åœ¨æŸäº›ç±»æ¥å†³å®šæ˜¯å¦åŠ è½½é…ç½®ç±»ã€‚æ¯”å¦‚ä½ å¼•å…¥äº†Redisä¾èµ–ï¼Œå°±ä¼šè‡ªåŠ¨é…ç½®RedisTemplateã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸å‡†ç¡®ã€‚é‚£Springçš„Beanç”Ÿå‘½å‘¨æœŸæœ‰å‡ ä¸ªé˜¶æ®µï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå®ä¾‹åŒ–ã€å±æ€§èµ‹å€¼ã€åˆå§‹åŒ–ã€é”€æ¯â€¦â€¦å•Šï¼Œè¿˜æœ‰ä¸ªAwareæ¥å£å›è°ƒï¼Œæ¯”å¦‚ApplicationContextAwareï¼Œè¿˜æœ‰InitializingBeanæ¥å£ï¼Œç„¶åæ‰æ˜¯postConstructâ€¦â€¦</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ï¼Œä½ æŠŠæ•´ä¸ªæµç¨‹éƒ½è¯´æ¸…æ¥šäº†ã€‚é‚£ä½ è¯´è¯´MyBatisçš„ç¼“å­˜æœºåˆ¶ï¼Œä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ï¼ŒåŒä¸€ä¸ªSqlSessioné‡ŒæŸ¥è¯¢æ•°æ®ä¼šå‘½ä¸­ï¼›äºŒçº§ç¼“å­˜æ˜¯Mapperçº§åˆ«çš„ï¼Œè·¨SqlSessionå…±äº«ï¼Œä½†éœ€è¦æ‰‹åŠ¨å¼€å¯ï¼Œå¹¶ä¸”å®ä½“ç±»è¦å®ç°Serializableã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šéå¸¸å‡†ç¡®ã€‚é‚£åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼ŒäºŒçº§ç¼“å­˜æ€ä¹ˆè§£å†³ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šè¿™ä¸ªâ€¦â€¦æˆ‘å¥½åƒæ²¡é‡åˆ°è¿‡â€¦â€¦ä¹Ÿè®¸å¯ä»¥ç”¨Redisåšåˆ†å¸ƒå¼ç¼“å­˜ï¼Ÿæˆ–è€…â€¦â€¦åŠ ä¸ªç‰ˆæœ¬å·ï¼Ÿ</p>
<p><strong>é¢è¯•å®˜</strong>ï¼ˆç‚¹å¤´ï¼‰ï¼šä¸é”™ï¼Œæ€è·¯æ‰“å¼€äº†ã€‚æœ€åä¸€ä¸ªé—®é¢˜ï¼Œè°ˆè°ˆä½ å¯¹DDDé¢†åŸŸé©±åŠ¨è®¾è®¡çš„ç†è§£ï¼Œå®ƒå’Œä¼ ç»Ÿçš„åˆ†å±‚æ¶æ„æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>
<p><strong>è°¢é£æœº</strong>ï¼šå—¯â€¦â€¦å°±æ˜¯æŠŠä¸šåŠ¡é€»è¾‘æ‹†æˆä¸€ä¸ªä¸ªé¢†åŸŸï¼Œç”¨å®ä½“ã€å€¼å¯¹è±¡ã€èšåˆæ ¹æ¥å»ºæ¨¡ï¼Œç„¶åç”¨é¢†åŸŸæœåŠ¡æ¥å¤„ç†å¤æ‚é€»è¾‘ã€‚ç›¸æ¯”ä¼ ç»Ÿæ¶æ„ï¼Œå®ƒæ›´è´´è¿‘ä¸šåŠ¡ï¼Œä»£ç æ›´æœ‰å±‚æ¬¡æ„Ÿï¼Œä¸å®¹æ˜“æ··ä¹±ã€‚</p>
<p><strong>é¢è¯•å®˜</strong>ï¼šå¾ˆå¥½ï¼Œå›ç­”å¾—å¾ˆæœ‰æ·±åº¦ã€‚è™½ç„¶æœ‰äº›åœ°æ–¹ç•¥æ˜¾ç²—ç³™ï¼Œä½†æ•´ä½“ç†è§£åˆ°ä½ã€‚</p>
<h4 data-id="heading-5"><strong>ç»“æŸè¯­</strong></h4>
<p><strong>é¢è¯•å®˜</strong>ï¼šè°¢é£æœºï¼Œä»Šå¤©çš„é¢è¯•å°±åˆ°è¿™é‡Œã€‚ä½ çš„åŸºç¡€çŸ¥è¯†æ‰å®ï¼Œå¯¹ä¸»æµæ¡†æ¶æœ‰è¾ƒæ·±ç†è§£ï¼Œè™½ç„¶åœ¨ä¸€äº›ç»†èŠ‚ä¸Šè¿˜ç•¥æœ‰æ¬ ç¼ºï¼Œä½†æ½œåŠ›å¾ˆå¤§ã€‚è¯·å›å»ç­‰é€šçŸ¥ï¼Œæˆ‘ä»¬ä¼šåœ¨3ä¸ªå·¥ä½œæ—¥å†…ç»™ä½ ç­”å¤ã€‚</p>
<p><strong>è°¢é£æœº</strong>ï¼ˆæ¾äº†ä¸€å£æ°”ï¼‰ï¼šè°¢è°¢é¢è¯•å®˜ï¼æˆ‘å›å»å¥½å¥½è¡¥è¯¾ï¼Œäº‰å–ä¸‹æ¬¡åˆ«å†è¢«é—®æ‡µäº†ï¼</p>
<hr/>
<h3 data-id="heading-6">ç­”æ¡ˆè¯¦è§£ï¼šæ ¸å¿ƒæŠ€æœ¯ç‚¹è§£æï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰</h3>
<h4 data-id="heading-7">1. Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</h4>
<ul>
<li><strong>å †</strong>ï¼šå­˜æ”¾æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œåƒåœ¾å›æ”¶çš„ä¸»è¦åŒºåŸŸã€‚</li>
<li><strong>æ ˆ</strong>ï¼šå­˜æ”¾å±€éƒ¨å˜é‡ã€æ–¹æ³•è°ƒç”¨æ ˆå¸§ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹ã€‚</li>
<li><strong>æ–¹æ³•åŒº</strong>ï¼šå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰ï¼ŒJDK8åæ›´åä¸º<strong>å…ƒç©ºé—´</strong>ï¼ˆMetaspaceï¼‰ï¼Œä½äºæœ¬åœ°å†…å­˜ï¼Œä¸å†å—é™äºå †å¤§å°ã€‚</li>
<li><strong>å…ƒç©ºé—´æ›¿ä»£æ°¸ä¹…ä»£çš„åŸå› </strong>ï¼šæ°¸ä¹…ä»£åœ¨å †ä¸­ï¼Œå®¹æ˜“å¯¼è‡´<code>OutOfMemoryError</code>ï¼›å…ƒç©ºé—´ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œå¯åŠ¨æ€æ‰©å±•ï¼Œé¿å…å†…å­˜æº¢å‡ºã€‚</li>
</ul>
<h4 data-id="heading-8">2. volatileå…³é”®å­—</h4>
<ul>
<li><strong>å¯è§æ€§</strong>ï¼šå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹volatileå˜é‡ï¼Œå…¶ä»–çº¿ç¨‹èƒ½ç«‹å³çœ‹åˆ°æœ€æ–°å€¼ï¼ˆé€šè¿‡å†…å­˜å±éšœåˆ·æ–°ä¸»å†…å­˜ï¼‰ã€‚</li>
<li><strong>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</strong>ï¼šæ’å…¥å†…å­˜å±éšœï¼Œé˜²æ­¢ç¼–è¯‘å™¨æˆ–å¤„ç†å™¨å¯¹ä»£ç è¿›è¡Œä¹±åºä¼˜åŒ–ï¼Œç¡®ä¿æ‰§è¡Œé¡ºåºç¬¦åˆé¢„æœŸã€‚</li>
<li><strong>å…¸å‹åº”ç”¨</strong>ï¼šå•ä¾‹æ¨¡å¼ä¸­çš„åŒé‡æ£€æŸ¥é”ã€çŠ¶æ€æ ‡å¿—ä½ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-9">3. çº¿ç¨‹æ± æ ¸å¿ƒå‚æ•° &amp; è°ƒä¼˜</h4>
<ul>
<li><code>corePoolSize</code>ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå³ä½¿ç©ºé—²ä¹Ÿä¸ä¼šè¢«å›æ”¶ã€‚</li>
<li><code>maximumPoolSize</code>ï¼šæœ€å¤§çº¿ç¨‹æ•°ï¼Œè¶…è¿‡æ ¸å¿ƒæ•°åæ‰åˆ›å»ºæ–°çº¿ç¨‹ã€‚</li>
<li><code>workQueue</code>ï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œå¦‚<code>LinkedBlockingQueue</code>ï¼ˆæ— ç•Œï¼‰ã€<code>ArrayBlockingQueue</code>ï¼ˆæœ‰ç•Œï¼‰ã€<code>SynchronousQueue</code>ï¼ˆç›´æ¥æäº¤ï¼‰ã€‚</li>
<li><code>rejectedExecutionHandler</code>ï¼šæ‹’ç»ç­–ç•¥ï¼Œå¦‚<code>AbortPolicy</code>ï¼ˆæŠ›å¼‚å¸¸ï¼‰ã€<code>CallerRunsPolicy</code>ï¼ˆç”±è°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>è°ƒä¼˜å»ºè®®</strong>ï¼š
<ul>
<li>CPUå¯†é›†å‹ä»»åŠ¡ï¼š<code>corePoolSize = CPUæ ¸æ•° + 1</code></li>
<li>I/Oå¯†é›†å‹ä»»åŠ¡ï¼š<code>corePoolSize = 2 * CPUæ ¸æ•°</code></li>
<li>é˜Ÿåˆ—é€‰æ‹©ï¼šé¿å…æ— ç•Œé˜Ÿåˆ—å¯¼è‡´å†…å­˜æº¢å‡ºï¼Œå»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—é…åˆæ‹’ç»ç­–ç•¥ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-10">4. ThreadLocalä½¿ç”¨æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹å‰¯æœ¬ï¼Œé€‚ç”¨äºçº¿ç¨‹éš”ç¦»åœºæ™¯ï¼ˆå¦‚ç”¨æˆ·ç™»å½•ä¸Šä¸‹æ–‡ã€äº‹åŠ¡ç®¡ç†ï¼‰ã€‚</li>
<li><strong>å¿…é¡»æ‰‹åŠ¨æ¸…ç†</strong>ï¼šåœ¨<code>finally</code>å—ä¸­è°ƒç”¨<code>threadLocal.remove()</code>ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆå› ThreadLocalMapæŒæœ‰å¼ºå¼•ç”¨ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-11">5. Spring Bootè‡ªåŠ¨è£…é…åŸç†</h4>
<ul>
<li>åŸºäº<code>@EnableAutoConfiguration</code>æ³¨è§£ï¼Œæ‰«æ<code>META-INF/spring.factories</code>æ–‡ä»¶ï¼ŒåŠ è½½<code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>æŒ‡å®šçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li>
<li>ä½¿ç”¨<code>@ConditionalOnClass</code>ã€<code>@ConditionalOnMissingBean</code>ç­‰æ¡ä»¶æ³¨è§£æ§åˆ¶æ˜¯å¦ç”Ÿæ•ˆï¼Œå®ç°â€œæŒ‰éœ€åŠ è½½â€æœºåˆ¶ã€‚</li>
</ul>
<h4 data-id="heading-12">6. Spring Beanç”Ÿå‘½å‘¨æœŸ</h4>
<ol>
<li><strong>å®ä¾‹åŒ–</strong>ï¼šé€šè¿‡æ„é€ å‡½æ•°æˆ–å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡ã€‚</li>
<li><strong>å±æ€§èµ‹å€¼</strong>ï¼šæ³¨å…¥ä¾èµ–ï¼ˆ@Autowiredï¼‰ã€‚</li>
<li><strong>Awareæ¥å£å›è°ƒ</strong>ï¼šå¦‚ApplicationContextAwareã€BeanNameAwareç­‰ã€‚</li>
<li><strong>InitializingBeanæ¥å£</strong>ï¼šè°ƒç”¨<code>afterPropertiesSet()</code>æ–¹æ³•ã€‚</li>
<li><strong>@PostConstructæ³¨è§£æ–¹æ³•</strong>ï¼šæ‰§è¡Œè‡ªå®šä¹‰åˆå§‹åŒ–é€»è¾‘ã€‚</li>
<li><strong>Beanåˆå§‹åŒ–å®Œæˆ</strong>ï¼šæ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚</li>
<li><strong>é”€æ¯</strong>ï¼šè°ƒç”¨<code>@PreDestroy</code>æˆ–<code>DisposableBean</code>æ¥å£æ–¹æ³•ã€‚</li>
</ol>
<h4 data-id="heading-13">7. MyBatisç¼“å­˜æœºåˆ¶</h4>
<ul>
<li><strong>ä¸€çº§ç¼“å­˜</strong>ï¼šé»˜è®¤å¼€å¯ï¼Œä½œç”¨åŸŸä¸ºSqlSessionï¼ŒåŒä¸€ä¼šè¯å†…é‡å¤æŸ¥è¯¢å‘½ä¸­ç¼“å­˜ã€‚</li>
<li><strong>äºŒçº§ç¼“å­˜</strong>ï¼šä½œç”¨åŸŸä¸ºMapperçº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼ˆ<code>&lt;cache /&gt;</code>æ ‡ç­¾ï¼‰ï¼Œè·¨ä¼šè¯å…±äº«ï¼Œä½†éœ€å®ä½“ç±»å®ç°<code>Serializable</code>æ¥å£ã€‚</li>
<li><strong>ä¸€è‡´æ€§é—®é¢˜</strong>ï¼šç”±äºç¼“å­˜å¼‚æ­¥æ›´æ–°ï¼Œå¯èƒ½å‡ºç°è„è¯»ã€‚è§£å†³æ–¹æ¡ˆï¼š
<ul>
<li>ç”¨Redisç­‰åˆ†å¸ƒå¼ç¼“å­˜æ›¿ä»£ã€‚</li>
<li>å¯ç”¨<code>@CacheNamespaceRef</code>å’Œ<code>@Options(flushCache = true)</code>å¼ºåˆ¶åˆ·æ–°ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-14">8. DDDé¢†åŸŸé©±åŠ¨è®¾è®¡æ ¸å¿ƒæ€æƒ³</h4>
<ul>
<li><strong>é¢†åŸŸæ¨¡å‹</strong>ï¼šä»¥ä¸šåŠ¡ä¸ºæ ¸å¿ƒï¼Œå°†å¤æ‚ä¸šåŠ¡æŠ½è±¡ä¸ºå®ä½“ï¼ˆEntityï¼‰ã€å€¼å¯¹è±¡ï¼ˆValue Objectï¼‰ã€èšåˆæ ¹ï¼ˆAggregate Rootï¼‰ã€‚</li>
<li><strong>åˆ†å±‚æ¶æ„</strong>ï¼š
<ul>
<li><strong>è¡¨ç°å±‚</strong>ï¼šå¤„ç†å‰ç«¯è¯·æ±‚ã€‚</li>
<li><strong>åº”ç”¨å±‚</strong>ï¼šåè°ƒé¢†åŸŸæœåŠ¡ï¼Œå¤„ç†ç”¨ä¾‹ã€‚</li>
<li><strong>é¢†åŸŸå±‚</strong>ï¼šåŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å’Œè§„åˆ™ã€‚</li>
<li><strong>åŸºç¡€è®¾æ–½å±‚</strong>ï¼šæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰å¤–éƒ¨ä¾èµ–ã€‚</li>
</ul>
</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤ï¼Œä¸šåŠ¡ä¸æŠ€æœ¯åˆ†ç¦»ï¼Œé€‚åˆå¤æ‚ç³»ç»Ÿé•¿æœŸæ¼”è¿›ã€‚</li>
</ul>
<hr/>
<blockquote>
<p>ğŸ“Œ <strong>æ€»ç»“</strong>ï¼šæœ¬æ¬¡é¢è¯•è™½æœ‰ç¬‘ç‚¹ï¼Œä½†å†…å®¹æ‰å®ã€‚æŒæ¡è¿™äº›æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæ˜¯ä½ å†²å‡»å¤§å‚çš„å…³é”®ä¸€æ­¥ã€‚æŒç»­å­¦ä¹ ï¼Œæœªæ¥å¯æœŸï¼</p>
</blockquote>
<p><strong>æ–‡ç« æ ‡ç­¾</strong>ï¼šJava, é¢è¯•, å¤šçº¿ç¨‹, SpringBoot, Redis, MySQL, JVM</p>
<p><strong>æ–‡ç« ç®€è¿°</strong>ï¼šä¸€åœºå……æ»¡ç¬‘ç‚¹ä¸å¹²è´§çš„é¢è¯•ç°åœºï¼Œä»åŸºç¡€åˆ°æ¡†æ¶ï¼Œä»å¹¶å‘åˆ°æ¶æ„ï¼Œå¸¦ä½ æ·±åº¦å¤ç›˜å¤§å‚é«˜é¢‘æŠ€æœ¯é—®é¢˜ã€‚é€šè¿‡æ•…äº‹åŒ–åœºæ™¯è¿˜åŸçœŸå®é¢è¯•æµç¨‹ï¼Œç­”æ¡ˆéƒ¨åˆ†è¯¦ç»†è§£ææ¯ä¸ªæŠ€æœ¯ç‚¹ï¼Œå°ç™½ä¹Ÿèƒ½è½»æ¾æŒæ¡æ ¸å¿ƒçŸ¥è¯†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡]]></title>    <link>https://juejin.cn/post/7585446706326781961</link>    <guid>https://juejin.cn/post/7585446706326781961</guid>    <pubDate>2025-12-20T05:10:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585446706326781961" data-draft-id="7585463258690273289" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡"/> <meta itemprop="keywords" content="Android,APP"/> <meta itemprop="datePublished" content="2025-12-20T05:10:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„¤æ€’çš„ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/4125023358426190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£æAndroidå†…å­˜åˆ†æçš„æŒ‡æ ‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023358426190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„¤æ€’çš„ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T05:10:11.000Z" title="Sat Dec 20 2025 05:10:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Android ç³»ç»Ÿå¼€å‘ä¸­ï¼Œä¸ºäº†ç²¾å‡†è¡¡é‡è¿›ç¨‹çš„å†…å­˜æ¶ˆè€—ï¼Œé€šå¸¸ä¼šä½¿ç”¨ <strong>VSSã€RSSã€PSSã€USS</strong> è¿™å››ä¸ªæŒ‡æ ‡ã€‚ç”±äºå†…å­˜å…±äº«æœºåˆ¶çš„å­˜åœ¨ï¼Œå•ä¸€çš„â€œå†…å­˜å ç”¨â€æ•°å­—å¾€å¾€æ— æ³•çœŸå®åæ˜ è¿›ç¨‹å¯¹ç³»ç»Ÿçš„å½±å“ï¼Œå› æ­¤è¿™å››ä¸ªæŒ‡æ ‡æä¾›äº†ä¸åŒç»´åº¦çš„è§‚å¯Ÿè§†è§’ã€‚</p>
<h2 data-id="heading-0">0x00 æ ¸å¿ƒå«ä¹‰è¯¦è§£</h2>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¨¡å‹æ¥ç†è§£ï¼šå‡è®¾è¿›ç¨‹ A ä½¿ç”¨äº† <strong>50MB ç§æœ‰å†…å­˜</strong>ï¼Œå¹¶ä¸è¿›ç¨‹ B å…±äº«ä¸€ä¸ª <strong>20MB çš„åŠ¨æ€åº“</strong>ã€‚</p>
<h3 data-id="heading-1"><strong>VSS (Virtual Set Size) - è™šæ‹Ÿè€—ç”¨å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹èƒ½è®¿é—®åˆ°çš„å…¨éƒ¨è™šæ‹Ÿåœ°å€ç©ºé—´å¤§å°ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šå·²åˆ†é…ä½†æœªå®é™…ä½¿ç”¨çš„å†…å­˜ã€æ˜ å°„åˆ°ç£ç›˜çš„æ–‡ä»¶ã€å…±äº«åº“å ç”¨çš„å…¨éƒ¨ç©ºé—´ç­‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ•°å€¼æœ€å¤§ã€‚å®ƒä¸ä»£è¡¨çœŸå®çš„ç‰©ç†å†…å­˜æ¶ˆè€—ï¼Œå¯¹äº<strong>æ€§èƒ½åˆ†ææ„ä¹‰è¾ƒå°</strong>ã€‚</li>
</ul>
<h3 data-id="heading-2"><strong>RSS (Resident Set Size) - å®é™…ä½¿ç”¨ç‰©ç†å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹å½“å‰å®é™…å ç”¨çš„ç‰©ç†å†…å­˜ï¼ˆRAMï¼‰ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šè¿›ç¨‹çš„ç§æœ‰å†…å­˜ + <strong>å…±äº«åº“çš„å…¨éƒ¨å¤§å°</strong>ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šå­˜åœ¨â€œé‡å¤è®¡ç®—â€ã€‚å¦‚æœæœ‰ 10 ä¸ªè¿›ç¨‹éƒ½ç”¨äº†é‚£ä¸ª 20MB çš„å…±äº«åº“ï¼Œæ¯ä¸ªè¿›ç¨‹çš„ RSS éƒ½ä¼šè®¡å…¥è¿™ 20MBã€‚å°†æ‰€æœ‰è¿›ç¨‹çš„ RSS ç›¸åŠ ï¼Œä¼šè¿œå¤§äºç³»ç»Ÿæ€»å†…å­˜ã€‚</li>
</ul>
<h3 data-id="heading-3"><strong>PSS (Proportional Set Size) - æ¯”ä¾‹åˆ†é…å†…å­˜</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šå°†å…±äº«åº“çš„å¤§å°æŒ‰å…±äº«è¿›ç¨‹çš„æ•°é‡<strong>å‡æ‘Š</strong>ã€‚</li>
<li><strong>è®¡ç®—</strong>ï¼šç§æœ‰å†…å­˜ + (å…±äº«åº“å¤§å° / å…±äº«è¯¥åº“çš„è¿›ç¨‹æ•°)ã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<strong>æœ€å®¢è§‚çš„æŒ‡æ ‡</strong>ã€‚å¦‚æœå°†ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹çš„ PSS ç›¸åŠ ï¼Œç»“æœå‡ ä¹ç­‰äºç³»ç»Ÿå®é™…æ¶ˆè€—çš„æ€»å†…å­˜ã€‚å®ƒæ˜¯è¡¡é‡è¿›ç¨‹ç³»ç»Ÿçº§è´Ÿæ‹…çš„æœ€ä½³æ ‡å‡†ã€‚</li>
</ul>
<h3 data-id="heading-4"><strong>USS (Unique Set Size) - è¿›ç¨‹ç‹¬å å†…å­˜ï¼ˆæœ€å¸¸ç”¨ï¼‰</strong></h3>
<ul>
<li><strong>å«ä¹‰</strong>ï¼šè¿›ç¨‹å®Œå…¨ç‹¬å çš„ç‰©ç†å†…å­˜ã€‚</li>
<li><strong>åŒ…å«</strong>ï¼šåªæœ‰è¯¥è¿›ç¨‹èƒ½è®¿é—®åˆ°çš„ RAM åŒºåŸŸã€‚</li>
<li><strong>ä¼˜ç‚¹</strong>ï¼š<strong>åˆ†æå†…å­˜æ³„éœ²çš„æ ¸å¿ƒæŒ‡æ ‡</strong>ã€‚å®ƒè¡¨ç¤ºå¦‚æœæ€æ­»è¯¥è¿›ç¨‹ï¼Œç³»ç»Ÿèƒ½ç«‹åˆ»å›æ”¶çš„å†…å­˜é‡ã€‚</li>
</ul>
<h2 data-id="heading-5">0x01 æ ¸å¿ƒåˆ¤æ–­æ ‡å‡†ï¼šä¸ºä»€ä¹ˆ USS æ˜¯â€œé‡‘æ ‡å‡†â€ï¼Ÿ</h2>
<p>åœ¨åˆ†ææ³„æ¼æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸éµå¾ªè¿™ä¸ªä¼˜å…ˆçº§ï¼š<strong>USS &gt; PSS &gt; RSS &gt; VSS</strong>ã€‚</p>
<ul>
<li><strong>VSS å’Œ RSS çš„å±€é™æ€§</strong>ï¼šç”±äº RSS åŒ…å«äº†å…±äº«åº“å†…å­˜ï¼Œå½“ç³»ç»Ÿå…¶ä»–è¿›ç¨‹åŠ è½½æˆ–å¸è½½å…±äº«åº“æ—¶ï¼Œä½ çš„è¿›ç¨‹ RSS å¯èƒ½ä¼šæ³¢åŠ¨ï¼Œè¿™ä¼šäº§ç”Ÿâ€œä¼ªæ³„æ¼â€çš„å¹²æ‰°ã€‚</li>
<li><strong>PSS çš„å‚è€ƒæ„ä¹‰</strong>ï¼šPSS èƒ½å¤Ÿåæ˜ ä½ çš„è¿›ç¨‹å¯¹ç³»ç»Ÿæ€»å†…å­˜çš„çœŸå®è´¡çŒ®ã€‚å¦‚æœ PSS æŒç»­ä¸Šæ¶¨ï¼Œè¯´æ˜ä½ çš„åº”ç”¨æ­£åœ¨æ‹–æ…¢ç³»ç»Ÿã€‚</li>
<li><strong>USS çš„å†³å®šæ€§ä½œç”¨</strong>ï¼š<strong>USS åªåŒ…å«è¿›ç¨‹å®Œå…¨ç‹¬å çš„å†…å­˜ã€‚</strong> å†…å­˜æ³„æ¼æœ¬è´¨ä¸Šæ˜¯è¿›ç¨‹å†…éƒ¨çš„å¯¹è±¡æ— æ³•è¢«å›æ”¶ï¼Œå› æ­¤<strong>å†…å­˜æ³„æ¼ä¸€å®šä¼šç›´æ¥åæ˜ åœ¨ USS çš„ä¸Šæ¶¨ä¸Š</strong>ã€‚</li>
</ul>
<h2 data-id="heading-6">0x02 åˆ†æå†…å­˜æ³„æ¼åˆ†æçš„æµç¨‹</h2>
<h3 data-id="heading-7">ç¬¬ä¸€æ­¥ï¼šå»ºç«‹åŸºå‡†çº¿ (Baseline)</h3>
<p>åœ¨åº”ç”¨å¯åŠ¨å¹¶è¿›å…¥ä¸»ç•Œé¢ç¨³å®šåï¼Œè®°å½•å½“å‰çš„å†…å­˜çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">adb shell dumpsys meminfo &lt;your_package_name&gt;
</code></pre>
<p>é‡ç‚¹è®°å½•ï¼š<code>TOTAL Pss</code> å’Œ <code>Private Dirty</code>ï¼ˆåè€…éå¸¸æ¥è¿‘ USSï¼‰ã€‚</p>
<h3 data-id="heading-8">ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œé‡å¤æ€§æ“ä½œ (Stress Test)</h3>
<p>å†…å­˜æ³„æ¼é€šå¸¸å‘ç”Ÿåœ¨ Activity é”€æ¯æˆ–é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ï¼ˆå¦‚ Singletonã€Threadï¼‰ä¸­ã€‚æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>è¿›å…¥ä¸€ä¸ªæ€€ç–‘æœ‰æ³„æ¼çš„é¡µé¢ï¼Œå†é€€å‡ºã€‚</li>
<li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ <strong>10 æ¬¡ä»¥ä¸Š</strong>ã€‚</li>
<li>æ‰‹åŠ¨è§¦å‘å‡ æ¬¡ GCï¼ˆåœ¨ Android Studio Profiler ä¸­ç‚¹å‡»å°åƒåœ¾æ¡¶å›¾æ ‡ï¼Œæˆ–é€šè¿‡ <code>adb shell cmd activity gc</code>ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-9">ç¬¬ä¸‰æ­¥ï¼šå¯¹æ¯”è§‚æµ‹</h3>
<p>å†æ¬¡è¿è¡Œ <code>adb shell dumpsys meminfo &lt;your_package_name&gt;</code>ï¼Œè§‚å¯Ÿæ•°æ®å˜åŒ–ï¼š</p>
<ul>
<li><strong>å¦‚æœ USS (Private Dirty) é˜¶æ¢¯å¼ä¸Šå‡</strong>ï¼šè¯´æ˜å­˜åœ¨<strong>ç§æœ‰å†…å­˜æ³„æ¼</strong>ï¼ˆé€šå¸¸æ˜¯ Java å¯¹è±¡ã€Bitmap æˆ– Native å †å†…å­˜ï¼‰ã€‚</li>
<li><strong>å¦‚æœ PSS ä¸Šå‡ä½† USS ç¨³å®š</strong>ï¼šè¿™ç§æƒ…å†µæå°‘è§ï¼Œå¯èƒ½æ„å‘³ç€ä½ è°ƒç”¨çš„ç³»ç»Ÿå…±äº«èµ„æºï¼ˆå¦‚æŸäº›ç³»ç»ŸæœåŠ¡çš„ç¼“å­˜ï¼‰åœ¨å¢åŠ ï¼Œè€Œä¸æ˜¯ä½ è¿›ç¨‹å†…éƒ¨çš„æ³„æ¼ã€‚</li>
<li><strong>å¦‚æœ PSS/USS å‡ä¸å¢åŠ ï¼Œä½† VSS ç–¯ç‹‚å¢é•¿</strong>ï¼šè¯´æ˜ä½ åœ¨ä¸æ–­åœ°ç”³è¯·è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚åˆ›å»ºäº†å¤§é‡çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å ç”¨ 1MB è™šæ‹Ÿæ ˆç©ºé—´ï¼Œä½†å®é™…è¿˜æ²¡å¼€å§‹ä½¿ç”¨ç‰©ç†å†…å­˜ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-shell" lang="shell">Applications Memory Usage (in Kilobytes):
Uptime: 102275 Realtime: 102275

** MEMINFO in pid 3069 [com.android.launcher3] **
                   Pss  Private  Private     Swap      Rss     Heap     Heap     Heap
                 Total    Dirty    Clean    Dirty    Total     Size    Alloc     Free
                ------   ------   ------   ------   ------   ------   ------   ------
  Native Heap    11128    11060        0        0    13796    19812    13511     2600
  Dalvik Heap     2316     2188        0        0     6620    27729     3153    24576
 Dalvik Other     2587     2264        0        0     3528                           
        Stack      736      736        0        0      740                           
       Ashmem        2        0        0        0        8                           
      Gfx dev     1244     1244        0        0     1244                           
    Other dev       36        0       36        0      284                           
     .so mmap     6076      212      128        0    54512                           
    .jar mmap     1922        0        0        0    26648                           
    .apk mmap    14824        0    13900        0    38756                           
    .ttf mmap       54        0        0        0      228                           
    .dex mmap      213        4        0        0      504                           
    .oat mmap       55        0        0        0     2044                           
    .art mmap     7794     7404        4        0    20040                           
   Other mmap     1179        4       32        0     4984                           
   EGL mtrack    40288    40288        0        0    40288                           
    GL mtrack     6104     6104        0        0     6104                           
      Unknown      466      448        0        0     1100                           
        TOTAL    97024    71956    14100        0    97024    47541    16664    27176
 
 App Summary
                       Pss(KB)                        Rss(KB)
                        ------                         ------
           Java Heap:     9596                          26660
         Native Heap:    11060                          13796
                Code:    14256                         123424
               Stack:      736                            740
            Graphics:    47636                          47636
       Private Other:     2772
              System:    10968
             Unknown:                                    9172
 
           TOTAL PSS:    97024            TOTAL RSS:   221428      TOTAL SWAP (KB):        0
 
...

</code></pre>
<h2 data-id="heading-10">0x03 é’ˆå¯¹ä¸åŒç±»å‹çš„æ³„æ¼åˆ†æ</h2>
<h3 data-id="heading-11">A. Java å±‚æ³„æ¼ (Activity/Fragment)</h3>
<ul>
<li>
<p><strong>ç°è±¡</strong>ï¼š<code>TOTAL Pss</code> å’Œ <code>Java Heap</code> æŒç»­å¢é•¿ã€‚</p>
</li>
<li>
<p><strong>åˆ†æ</strong>ï¼šæŸ¥çœ‹ <code>dumpsys meminfo</code> æœ€åçš„ <code>Objects</code> éƒ¨åˆ†ã€‚</p>
<ul>
<li><code>Views</code> å’Œ <code>Activities</code> çš„æ•°é‡ã€‚å¦‚æœä½ é€€å‡ºäº†é¡µé¢ï¼Œ<code>Activities</code> æ•°é‡æ²¡æœ‰å‡å°‘ï¼Œé‚£å°±æ˜¯å…¸å‹çš„ Activity æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-12">B. Native å±‚æ³„æ¼ (C++/JNI)</h3>
<ul>
<li><strong>ç°è±¡</strong>ï¼š<code>Native Heap</code> æŒ‡æ ‡æŒç»­å¢é•¿ï¼Œä¸” <code>USS</code> åŒæ­¥ä¸Šæ¶¨ã€‚</li>
<li><strong>åˆ†æ</strong>ï¼šå¦‚æœä½ åœ¨ JNI ä¸­ä½¿ç”¨äº† <code>malloc</code> æˆ– <code>new</code> ä½†æ²¡æœ‰ <code>free</code>ï¼Œè¿™éƒ¨åˆ†å†…å­˜ä¼šä½“ç°åœ¨ <code>Native Heap</code> ä¸­ã€‚</li>
</ul>
<h3 data-id="heading-13">C. å…±äº«å†…å­˜/æ–‡ä»¶æè¿°ç¬¦æ³„æ¼ (SharedMemory/FD)</h3>
<p>å¦‚æœ SharedMemory æ²¡æœ‰è¢«æ­£ç¡®å…³é—­ï¼š</p>
<ul>
<li>
<p><strong>ç°è±¡</strong>ï¼š<code>USS</code> å¯èƒ½ä¸ä¼šæ˜¾è‘—å¢é•¿ï¼ˆå¦‚æœä½ å·²ç» <code>munmap</code> äº†ï¼‰ï¼Œä½†<strong>æ–‡ä»¶æè¿°ç¬¦ (FD)</strong> ä¼šè€—å°½ã€‚</p>
</li>
<li>
<p><strong>æ£€æŸ¥æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">adb shell <span class="hljs-built_in">ls</span> -l /proc/&lt;pid&gt;/fd | <span class="hljs-built_in">wc</span> -l
</code></pre>
<p>ä¾‹å¦‚æ£€æŸ¥<code>3069</code>å·è¿›ç¨‹(<code>com.android.launcher3</code>)</p>
<pre><code class="hljs language-shell" lang="shell">adb root
adb shell ls -l /proc/3069/fd | wc -l
<span class="hljs-meta prompt_">
# </span><span class="bash">è¾“å‡º</span>
<span class="hljs-meta prompt_"># </span><span class="bash">82</span>
</code></pre>
<p>é‡å¤æ“ä½œåï¼Œå¦‚æœ FD æ•°é‡ä¸æ–­å¢åŠ ï¼Œè¯´æ˜ä½ çš„ <code>SharedMemory</code> æˆ– <code>ParcelFileDescriptor</code> æ²¡æœ‰æ‰§è¡Œ <code>close()</code>ã€‚</p>
</li>
</ul>
<h2 data-id="heading-14">0x04 è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·æ¨è</h2>
<p>è™½ç„¶æ‰‹åŠ¨åˆ†æ <code>dumpsys</code> å¾ˆæœ‰å¸®åŠ©ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®é…åˆä»¥ä¸‹å·¥å…·ï¼š</p>





















<table><thead><tr><th><strong>å·¥å…·</strong></th><th><strong>ä¼˜åŠ¿</strong></th></tr></thead><tbody><tr><td><strong>LeakCanary</strong></td><td>è‡ªåŠ¨åŒ–ç¨‹åº¦æœ€é«˜ï¼Œç›´æ¥åœ¨æ‰‹æœºç«¯å¼¹çª—å‘ŠçŸ¥ Java æ³„æ¼å¼•ç”¨é“¾ã€‚</td></tr><tr><td><strong>Android Studio Profiler</strong></td><td>å¯è§†åŒ–å®æ—¶æŸ¥çœ‹ PSS åˆ†å¸ƒï¼Œæ”¯æŒ Capture Heap Dump åˆ†æå †å¿«ç…§ã€‚</td></tr><tr><td><strong>Perfetto / Systrace</strong></td><td>é€‚åˆåˆ†æ Native å±‚å’Œç³»ç»Ÿçº§çš„å†…å­˜åˆ†é…è¡Œä¸ºã€‚</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†]]></title>    <link>https://juejin.cn/post/7585446706327126025</link>    <guid>https://juejin.cn/post/7585446706327126025</guid>    <pubDate>2025-12-20T06:25:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585446706327126025" data-draft-id="7585463258690650121" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Java"/> <meta itemprop="datePublished" content="2025-12-20T06:25:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="9å·è¾¾äºº"/> <meta itemprop="url" content="https://juejin.cn/user/2450136052270077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ”¯ä»˜æˆåŠŸè®¢å•å´æ²¡äº†ï¼ŸMyBatisè¿æ¥æ± çš„å‘æˆ‘è¸©äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2450136052270077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    9å·è¾¾äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T06:25:35.000Z" title="Sat Dec 20 2025 06:25:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äº‹æ•…ç°åœº</h2>
<p>ä¸Šå‘¨çº¿ä¸Šç‚¸äº†ã€‚</p>
<p>æ”¯ä»˜ä¸šåŠ¡å‡ºäº†é—®é¢˜ï¼Œç”¨æˆ·æ”¯ä»˜æˆåŠŸï¼Œä½†è®¢å•è¡¨æ²¡æ•°æ®ã€‚æ›´è¯¡å¼‚çš„æ˜¯ï¼Œä¿®æ”¹è®¢å•æ—¶æœ‰æ—¶ä¹Ÿä¼šæç¤ºè·å–é”è¶…æ—¶ã€‚</p>
<p>DBAçœ‹äº†ä¸€çœ¼æ•°æ®åº“è¿æ¥ï¼Œå‘ç°å‡ ä¸ªäº‹åŠ¡ä¸€ç›´æ²¡æäº¤ï¼Œé”ç€è®¢å•è¡¨çš„å‡ è¡Œæ•°æ®ã€‚</p>
<p>æ’æŸ¥åŠå¤©ï¼Œæœ€åå‘ç°æ˜¯æŸä¸ªä¸šåŠ¡æ¥å£å¿˜äº†æäº¤äº‹åŠ¡ã€‚</p>
<p>æŒ‰ç†è¯´,äº‹åŠ¡æ²¡æäº¤åº”è¯¥å¾ˆå®¹æ˜“å‘ç°ã€‚ä½†è¿™ä¸ªbugå°±æ¯”è¾ƒéšè”½ã€‚</p>
<p><strong>4ä¸ªåå¸¸è¯†çš„ç°è±¡ï¼š</strong></p>
<ol>
<li><strong>ä¸šåŠ¡ä»£ç æ­£å¸¸æ‰§è¡Œå®Œæ¯•</strong> æ²¡æœ‰ä»»ä½•æŠ¥é”™ï¼Œæ—¥å¿—ä¹Ÿæ­£å¸¸æ‰“å°ã€‚</li>
<li><strong>æ—¥å¿—æ˜¾ç¤ºäº‹åŠ¡å·²æäº¤</strong> commitæ–¹æ³•è¢«è°ƒç”¨äº†ï¼Œä½†æ•°æ®åº“é‡Œæ²¡æ•°æ®ã€‚</li>
<li><strong>å¶å°”ä¼šæˆåŠŸ</strong> å¤§éƒ¨åˆ†æ—¶å€™å¤±è´¥ï¼Œä½†å¶å°”èƒ½æ­£å¸¸æ’å…¥è®¢å•ã€‚</li>
</ol>
<p>è¿™ç§æƒ…å†µè®©äººæ‘¸ä¸ç€å¤´è„‘ã€‚ä»£ç æ²¡æŠ¥é”™ï¼Œæ—¥å¿—ä¹Ÿæ­£å¸¸ï¼Œä¸ºå•¥æ•°æ®å°±æ˜¯ä¸å…¥åº“?</p>
<h2 data-id="heading-1">åº”æ€¥å¤„ç†</h2>
<p>çº¿ä¸Šå‡ºé—®é¢˜ï¼Œé‚£è‚¯å®šå…ˆæ¢å¤ä¸šåŠ¡å†è¯´ã€‚</p>
<p>æœ€å¿«çš„åŠæ³•å°±æ˜¯é‡å¯åº”ç”¨ï¼Œå¼ºåˆ¶é‡Šæ”¾è¿™äº›è¿æ¥ã€‚</p>
<p>é‡å¯å®Œï¼Œæ”¯ä»˜åŠŸèƒ½æ¢å¤æ­£å¸¸ã€‚ä½†é—®é¢˜è¿˜æ˜¯è¦æ‰¾åˆ°</p>
<p>é‡å¯åªèƒ½æš‚æ—¶ç¼“è§£ï¼Œå¾—æ‰¾åˆ°åˆ°åº•å“ªä¸ªä¸šåŠ¡å‡ºäº†é—®é¢˜ã€‚</p>
<p>å¯¹æ¯”äº†æœ€è¿‘çš„ä¸Šçº¿è®°å½•ï¼Œå‘ç°æœ‰ä¸ªæ–°ä¸šåŠ¡åˆšä¸Šçº¿ã€‚æ£€æŸ¥ä»£ç ï¼Œæœç„¶å‘ç°äº†é—®é¢˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â voidÂ handleSpecialCase()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â sqlSession.connection.setAutoCommit(<span class="hljs-literal">false</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡ŒSQL</span>
Â Â Â Â Â Â Â Â mapper.insert(<span class="hljs-keyword">data</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¿˜è®°commitäº†ï¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŸäº›æƒ…å†µä¸‹ä¼šreturnï¼Œä½†æ²¡commit</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â sqlSession.commit();
Â Â Â Â }
}
</code></pre>
<p>ç‰¹æ®Šåˆ†æ”¯ç›´æ¥returnäº†ï¼Œcommitæ²¡æ‰§è¡Œã€‚</p>
<h3 data-id="heading-2">å¿«é€Ÿä¿®å¤</h3>
<p>ç«‹å³è¡¥ä¸Šcommitï¼Œé‡æ–°ä¸Šçº¿ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â voidÂ handleSpecialCase()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.connection.setAutoCommit(<span class="hljs-literal">false</span>);
Â Â Â Â Â Â Â Â Â Â Â Â mapper.insert(<span class="hljs-keyword">data</span>);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.commit();Â <span class="hljs-comment">//Â è¡¥ä¸Šï¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.commit();
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â sqlSession.rollback();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>ä¸Šçº¿åéªŒè¯ï¼Œé—®é¢˜è§£å†³ã€‚</p>
<h2 data-id="heading-3">äº‹åå¤ç›˜</h2>
<p>é—®é¢˜è™½ç„¶è§£å†³äº†ï¼Œä½†è¿˜æ˜¯å¾ˆå¥‡æ€ªï¼šä¸ºå•¥ä¸€ä¸ªä¸šåŠ¡çš„äº‹åŠ¡æ²¡æäº¤ï¼Œä¼šå½±å“åˆ°å…¶ä»–å®Œå…¨ä¸ç›¸å…³çš„æ”¯ä»˜ä¸šåŠ¡ï¼Ÿ</p>
<p>å‘¨æœ«èŠ±äº†åŠå¤©debugæºç ï¼Œç»ˆäºææ¸…æ¥šäº†ã€‚</p>
<h3 data-id="heading-4">æ–­ç‚¹æ‰“åœ¨getTransaction</h3>
<p>é¦–å…ˆåœ¨Springçš„<code>getTransaction</code>æ–¹æ³•æ‰“æ–­ç‚¹ï¼Œå‘ç°å‡ºé—®é¢˜çš„è¯·æ±‚éƒ½ä¼šèµ°åˆ°è¿™é‡Œï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">final</span>Â <span class="hljs-selector-tag">TransactionStatus</span>Â <span class="hljs-selector-tag">getTransaction</span>(<span class="hljs-variable">@Nullable</span>Â TransactionDefinitionÂ definition)
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">throws</span>Â <span class="hljs-selector-tag">TransactionException</span>Â {

Â Â Â Â <span class="hljs-comment">//Â ä½¿ç”¨é»˜è®¤çš„äº‹åŠ¡å®šä¹‰</span>
Â Â Â Â <span class="hljs-selector-tag">TransactionDefinition</span>Â <span class="hljs-selector-tag">def</span>Â =Â (definitionÂ !=Â nullÂ ?Â <span class="hljs-attribute">definitionÂ </span>:Â TransactionDefinition.<span class="hljs-built_in">withDefaults</span>());

Â Â Â Â <span class="hljs-comment">//Â å…³é”®ï¼šè·å–å½“å‰äº‹åŠ¡å¯¹è±¡</span>
Â Â Â Â <span class="hljs-selector-tag">Object</span>Â <span class="hljs-selector-tag">transaction</span>Â =Â <span class="hljs-selector-tag">doGetTransaction</span>();
Â Â Â Â <span class="hljs-selector-tag">boolean</span>Â <span class="hljs-selector-tag">debugEnabled</span>Â =Â <span class="hljs-selector-tag">logger</span><span class="hljs-selector-class">.isDebugEnabled</span>();

Â Â Â Â <span class="hljs-comment">//Â åˆ¤æ–­æ˜¯å¦æ˜¯å·²å­˜åœ¨çš„äº‹åŠ¡</span>
Â Â Â Â <span class="hljs-selector-tag">if</span>Â (<span class="hljs-built_in">isExistingTransaction</span>(transaction))Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘ç°å·²å­˜åœ¨çš„äº‹åŠ¡ï¼Œç›´æ¥è¿”å›</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">handleExistingTransaction</span>(def,Â transaction,Â debugEnabled);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºæ–°äº‹åŠ¡çš„é€»è¾‘...</span>
}
</code></pre>
<p>é—®é¢˜å°±å‡ºåœ¨<code>doGetTransaction</code>è¿™ä¸ªæ–¹æ³•ã€‚</p>
<h3 data-id="heading-5">doGetTransactionä¼šå¤ç”¨è¿æ¥</h3>
<p>ç‚¹å¼€<code>doGetTransaction</code>ï¼Œä¼šå‘ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span>Â ObjectÂ <span class="hljs-title function_">doGetTransaction</span><span class="hljs-params">()</span>Â {
Â Â Â Â <span class="hljs-type">DataSourceTransactionObject</span>Â <span class="hljs-variable">txObject</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DataSourceTransactionObject</span>();
Â Â Â Â txObject.setSavepointAllowed(<span class="hljs-built_in">this</span>.isNestedTransactionAllowed());

Â Â Â Â <span class="hljs-comment">//Â å…³é”®ï¼šä»TransactionSynchronizationManagerè·å–è¿æ¥</span>
Â Â Â Â <span class="hljs-type">ConnectionHolder</span>Â <span class="hljs-variable">conHolder</span>Â <span class="hljs-operator">=</span>Â (ConnectionHolder)Â TransactionSynchronizationManager.getResource(<span class="hljs-built_in">this</span>.obtainDataSource());

Â Â Â Â txObject.setConnectionHolder(conHolder,Â <span class="hljs-literal">false</span>);
Â Â Â Â <span class="hljs-keyword">return</span>Â txObject;
}
</code></pre>
<p><code>TransactionSynchronizationManager.getResource</code>ä¼šä»è¿æ¥æ± æ‹¿è¿æ¥ã€‚å¦‚æœæ‹¿åˆ°ä¸€ä¸ªè¢«æ±¡æŸ“çš„è¿æ¥ï¼ˆä¸Šä¸€ä¸ªäº‹åŠ¡æ²¡æäº¤ï¼‰ï¼Œ<code>ConnectionHolder</code>é‡Œå°±å¸¦ç€ä¸Šä¸€ä¸ªäº‹åŠ¡çš„çŠ¶æ€ã€‚</p>
<h3 data-id="heading-6">isExistingTransactionçš„åˆ¤æ–­</h3>
<p>ç„¶å<code>isExistingTransaction</code>ä¼šæ£€æŸ¥è¿™ä¸ªè¿æ¥ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">protectedÂ booleanÂ <span class="hljs-built_in">isExistingTransaction</span>(ObjectÂ transaction)Â {
Â Â Â Â DataSourceTransactionObjectÂ txObjectÂ =Â (DataSourceTransactionObject)transaction;
Â Â Â Â returnÂ txObject<span class="hljs-selector-class">.hasConnectionHolder</span>()Â &amp;&amp;Â txObject<span class="hljs-selector-class">.getConnectionHolder</span>()<span class="hljs-selector-class">.isTransactionActive</span>();
}
</code></pre>
<p>å¦‚æœè¿æ¥ä¸Šæœ‰äº‹åŠ¡æ ‡è®°(<code>isTransactionActive()</code>)ï¼Œå°±è®¤ä¸ºæ˜¯å·²å­˜åœ¨çš„äº‹åŠ¡ï¼Œä¸ä¼šåˆ›å»ºæ–°äº‹åŠ¡ã€‚</p>
<p>é—®é¢˜æ¥äº†ï¼šå¦‚æœä¸Šä¸€ä¸ªä¸šåŠ¡ç”¨å®Œè¿æ¥åï¼Œäº‹åŠ¡æ²¡æäº¤ä¹Ÿæ²¡å›æ»šï¼Œ<code>ConnectionHolder</code>çš„äº‹åŠ¡æ ‡è®°è¿˜åœ¨ã€‚ä¸‹ä¸€ä¸ªä¸šåŠ¡é€šè¿‡<code>doGetTransaction</code>ä»<code>TransactionSynchronizationManager</code>æ‹¿åˆ°è¿™ä¸ª<code>ConnectionHolder</code>ï¼Œå°±è¢«å½“æˆå·²å­˜åœ¨çš„äº‹åŠ¡äº†ã€‚</p>
<h3 data-id="heading-7">è¢«æ±¡æŸ“çš„è¿æ¥æ˜¯æ€ä¹ˆæ¥çš„</h3>
<p>å›é¡¾å‰é¢åº”æ€¥å¤„ç†æ—¶æ‰¾åˆ°çš„é‚£æ®µdemoä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SomeService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">handleSpecialCase</span><span class="hljs-params">()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">TransactionStatus</span>Â <span class="hljs-variable">status</span>Â <span class="hljs-operator">=</span>Â transactionManager.getTransaction(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DefaultTransactionDefinition</span>());

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡ŒSQL</span>
Â Â Â Â Â Â Â Â Â Â Â Â mapper.insert(data);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç‰¹æ®Šåˆ†æ”¯ï¼šç›´æ¥returnï¼Œæ²¡commitï¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (specialCondition)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.commit(status);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.rollback(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>å½“èµ°åˆ°ç‰¹æ®Šåˆ†æ”¯returnæ—¶ï¼š</p>
<ul>
<li><code>ConnectionHolder</code>å·²ç»è¢«æ ‡è®°ä¸ºæœ‰äº‹åŠ¡ï¼ˆ<code>isTransactionActive() = true</code>ï¼‰</li>
<li>ä½†äº‹åŠ¡æ—¢æ²¡commitï¼Œä¹Ÿæ²¡rollback</li>
<li>æ–¹æ³•ç»“æŸåï¼Œè¿æ¥å½’è¿˜åˆ°<code>TransactionSynchronizationManager</code></li>
<li><code>ConnectionHolder</code>çš„äº‹åŠ¡æ ‡è®°è¿˜åœ¨</li>
</ul>
<p>è¿™ä¸ªè¿æ¥å°±è¢«æ±¡æŸ“äº†ã€‚</p>
<h3 data-id="heading-8">å¤ç”¨å¯¼è‡´çš„é—®é¢˜</h3>
<p>å…¶ä»–ä¸šåŠ¡åˆšå¥½å¤ç”¨åˆ°äº†è¿™ä¸ªè¢«æ±¡æŸ“çš„è¿æ¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">PaymentService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderÂ order)</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰‹åŠ¨å¼€å¯äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">TransactionStatus</span>Â <span class="hljs-variable">status</span>Â <span class="hljs-operator">=</span>Â transactionManager.getTransaction(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">DefaultTransactionDefinition</span>());

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ’å…¥è®¢å•</span>
Â Â Â Â Â Â Â Â Â Â Â Â orderMapper.insert(order);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æäº¤äº‹åŠ¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.commit(status);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â transactionManager.rollback(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Œå¯¹å§ï¼Ÿä½†å½“è¿™ä¸ªæ–¹æ³•è·å–åˆ°è¢«æ±¡æŸ“çš„è¿æ¥æ—¶ï¼š</p>
<ol>
<li><code>getTransaction</code>åˆ¤æ–­<code>isExistingTransaction</code>ä¸ºtrue</li>
<li>èµ°è¿›<code>handleExistingTransaction</code>æ–¹æ³•</li>
<li>æ ¹æ®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œå¯èƒ½ä¼šåŠ å…¥ç°æœ‰äº‹åŠ¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°äº‹åŠ¡</li>
<li>æœ€åcommitæ—¶ï¼Œå› ä¸ºä¸æ˜¯äº‹åŠ¡å‘èµ·è€…ï¼Œä¸ä¼šçœŸæ­£æäº¤</li>
</ol>
<h3 data-id="heading-9">processCommitçš„åˆ¤æ–­</h3>
<p>ç»§ç»­debugåˆ°commitæ–¹æ³•ï¼Œå‘ç°ä¼šæ‰§è¡ŒprocessCommitå»å®Œæˆæäº¤ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">privateÂ voidÂ <span class="hljs-built_in">processCommit</span>(DefaultTransactionStatusÂ status)Â throwsÂ TransactionExceptionÂ {
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â booleanÂ beforeCompletionInvokedÂ =Â false;

Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">prepareForCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">triggerBeforeCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">triggerBeforeCompletion</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â beforeCompletionInvokedÂ =Â true;

Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (status.hasSavepoint())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â status<span class="hljs-selector-class">.releaseHeldSavepoint</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…³é”®åˆ¤æ–­ï¼šåªæœ‰æ–°äº‹åŠ¡æ‰çœŸæ­£æäº¤</span>
Â Â Â Â Â Â Â Â Â Â Â Â elseÂ ifÂ (status.isNewTransaction())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (status.isDebug())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â logger<span class="hljs-selector-class">.debug</span>("InitiatingÂ transactionÂ commit");
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â çœŸæ­£æ‰§è¡Œæ•°æ®åº“commit</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">doCommit</span>(status);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¦‚æœä¸æ˜¯æ–°äº‹åŠ¡ï¼Œä»€ä¹ˆéƒ½ä¸åšï¼</span>

Â Â Â Â Â Â Â Â }Â catchÂ (UnexpectedRollbackExceptionÂ ex)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ...</span>
Â Â Â Â Â Â Â Â }

Â Â Â Â }Â finallyÂ {
Â Â Â Â Â Â Â Â <span class="hljs-built_in">cleanupAfterCompletion</span>(status);
Â Â Â Â }
}
</code></pre>
<p>å› ä¸º<code>status.isNewTransaction()</code>è¿”å›falseï¼ˆè¿™æ˜¯ä¸ªåŠ å…¥çš„äº‹åŠ¡ï¼Œä¸æ˜¯æ–°äº‹åŠ¡ï¼‰ï¼Œæ‰€ä»¥<code>doCommit(status)</code>æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>çœŸæ­£çš„<code>connection.commit()</code>æ ¹æœ¬æ²¡æ‰§è¡Œã€‚</p>
<h3 data-id="heading-10">å®Œæ•´çš„é—®é¢˜é“¾è·¯</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/949f8bc5fad646ce99fe08ea931a121b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOeWPt-i-vuS6ug==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766816735&amp;x-signature=eaui1jMxdtT2JMmKe2B7tW5yA9M%3D" alt="" loading="lazy"/></p>
<ol>
<li><code>SomeService.handleSpecialCase()</code>ç‰¹æ®Šåˆ†æ”¯æ²¡æäº¤äº‹åŠ¡</li>
<li>æ–¹æ³•ç»“æŸï¼Œ<code>ConnectionHolder</code>å½’è¿˜åˆ°<code>TransactionSynchronizationManager</code>ï¼Œä½†äº‹åŠ¡æ ‡è®°<code>isTransactionActive()</code>è¿˜æ˜¯true</li>
<li><code>PaymentService.createOrder()</code>è°ƒç”¨<code>doGetTransaction()</code></li>
<li><code>doGetTransaction</code>ä»<code>TransactionSynchronizationManager</code>æ‹¿åˆ°è¢«æ±¡æŸ“çš„<code>ConnectionHolder</code></li>
<li><code>isExistingTransaction</code>åˆ¤æ–­ä¸ºtrueï¼Œè®¤ä¸ºå·²æœ‰äº‹åŠ¡</li>
<li>èµ°<code>handleExistingTransaction</code>æµç¨‹ï¼ŒåŠ å…¥ç°æœ‰äº‹åŠ¡ï¼ˆ<code>isNewTransaction = false</code>ï¼‰</li>
<li>ä¸šåŠ¡ä»£ç æ‰§è¡Œå®Œï¼Œè°ƒç”¨<code>commit</code></li>
<li><code>processCommit</code>ä¸­åˆ¤æ–­<code>isNewTransaction()</code>ä¸ºfalseï¼Œè·³è¿‡<code>doCommit</code></li>
<li>æ•°æ®æ²¡å…¥åº“ï¼Œ<code>ConnectionHolder</code>ç»§ç»­å¾…åœ¨<code>TransactionSynchronizationManager</code>ï¼Œç»§ç»­æ±¡æŸ“ä¸‹ä¸€ä¸ªä¸šåŠ¡</li>
</ol>
<h2 data-id="heading-11">ä¸ºä»€ä¹ˆå¶å°”ä¼šæˆåŠŸï¼Ÿ</h2>
<p>å› ä¸º<code>TransactionSynchronizationManager</code>æ˜¯ThreadLocalå®ç°çš„ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„èµ„æºã€‚</p>
<p>å¦‚æœæ”¯ä»˜è¯·æ±‚åˆ†é…åˆ°ä¸€ä¸ªå¹²å‡€çš„çº¿ç¨‹ï¼ˆæ²¡æœ‰è¢«æ±¡æŸ“çš„<code>ConnectionHolder</code>ï¼‰ï¼Œå°±èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†åªè¦åˆ†é…åˆ°è¢«æ±¡æŸ“çš„çº¿ç¨‹ï¼Œå°±ä¼šå‡ºé—®é¢˜ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªbugè¿™ä¹ˆéš¾å‘ç°ï¼š</p>
<ul>
<li>ä¸æ˜¯100%å¤ç°ï¼ˆå–å†³äºçº¿ç¨‹æ± è°ƒåº¦ï¼‰</li>
<li>æ²¡æœ‰æŠ¥é”™ä¿¡æ¯</li>
<li>æ—¥å¿—çœ‹èµ·æ¥æ­£å¸¸</li>
</ul>
<h2 data-id="heading-12">é¢„é˜²æªæ–½</h2>
<p>ç»è¿‡è¿™æ¬¡äº‹æ•…ï¼Œæˆ‘ä»¬åŠ äº†å‡ ä¸ªé¢„é˜²æªæ–½ã€‚</p>
<h3 data-id="heading-13">1. è¿æ¥æ± å¥åº·æ£€æŸ¥</h3>
<p>é…ç½®è¿æ¥æ± çš„è¿æ¥æ ¡éªŒï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
Â Â <span class="hljs-attr">datasource:</span>
Â Â Â Â <span class="hljs-attr">hikari:</span>
Â Â Â Â Â Â <span class="hljs-string">connection-test-query:</span>Â <span class="hljs-string">SELECT</span>Â <span class="hljs-number">1</span>
Â Â Â Â Â Â <span class="hljs-string">validation-timeout:</span>Â <span class="hljs-number">3000</span>
Â Â Â Â Â Â <span class="hljs-comment">#Â ä»æ± å­å–è¿æ¥å‰å…ˆæµ‹è¯•</span>
Â Â Â Â Â Â <span class="hljs-string">connection-init-sql:</span>Â <span class="hljs-string">SET</span>Â <span class="hljs-string">autocommit=1</span>
</code></pre>
<p><code>connection-init-sql</code>ä¼šåœ¨æ¯æ¬¡ä»æ± å­å–è¿æ¥æ—¶é‡ç½®çŠ¶æ€ï¼Œé¿å…è¢«æ±¡æŸ“çš„è¿æ¥å½±å“ä¸šåŠ¡ã€‚</p>
<h3 data-id="heading-14">2. ç›‘æ§å‘Šè­¦</h3>
<p>å¢åŠ æ•°æ®åº“é•¿äº‹åŠ¡ç›‘æ§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">--Â æŸ¥æ‰¾æ‰§è¡Œè¶…è¿‡30ç§’çš„äº‹åŠ¡</span>
<span class="hljs-keyword">SELECT</span>Â <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span>Â information_schema.innodb_trx
<span class="hljs-keyword">WHERE</span>Â TIME_TO_SEC(TIMEDIFF(NOW(),Â trx_started))Â <span class="hljs-operator">&gt;</span>Â <span class="hljs-number">30</span>;
</code></pre>
<p>é…ç½®å‘Šè­¦è§„åˆ™ï¼Œè¶…è¿‡30ç§’çš„äº‹åŠ¡ç«‹å³æŠ¥è­¦ã€‚</p>
<h2 data-id="heading-15">è¸©å‘æ€»ç»“</h2>
<p>è¿™æ¬¡äº‹æ•…è®©æˆ‘æ˜ç™½äº†å‡ ç‚¹ã€‚</p>
<h3 data-id="heading-16">1. è¿æ¥æ± ä¸åªæ˜¯æ€§èƒ½ä¼˜åŒ–</h3>
<p>ä¹‹å‰æˆ‘ä¸€ç›´è§‰å¾—è¿æ¥æ± å°±æ˜¯æå‡æ€§èƒ½çš„ã€‚è¿™æ¬¡æ‰æ‡‚ï¼Œè¿æ¥æ± è¿˜ä¼šå¸¦æ¥çŠ¶æ€å¤ç”¨çš„å‘ã€‚</p>
<p>ä¸€ä¸ªè¿æ¥çš„é—®é¢˜ï¼Œä¼šå½±å“åé¢æ‰€æœ‰å¤ç”¨è¿™ä¸ªè¿æ¥çš„ä¸šåŠ¡ã€‚</p>
<h3 data-id="heading-17">2. äº‹åŠ¡ç®¡ç†è¦å†™æ¸…æ¥š</h3>
<p>æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼Œä¸€å®šè¦å†™æ¸…æ¥šcommitå’Œrollbackï¼š</p>
<ul>
<li>commitå†™åœ¨tryå—æœ«å°¾</li>
<li>rollbackå†™åœ¨catchå—</li>
<li>finallyå—å…³é—­èµ„æº</li>
</ul>
<p>åˆ«å·æ‡’çœè¿™å‡ è¡Œä»£ç ã€‚ä¸€ä¸ªé—æ¼çš„commitï¼Œå°±å¯èƒ½å¯¼è‡´çº¿ä¸Šäº‹æ•…ã€‚</p>
<h3 data-id="heading-18">3. ç›‘æ§è¦è¦†ç›–åˆ°æ•°æ®åº“å±‚</h3>
<p>åº”ç”¨å±‚æ—¥å¿—æ­£å¸¸ï¼Œä¸ä»£è¡¨æ•°æ®åº“å±‚æ²¡é—®é¢˜ã€‚</p>
<p>å¿…é¡»è¦æœ‰æ•°æ®åº“å±‚é¢çš„ç›‘æ§ï¼š</p>
<ul>
<li>æ…¢æŸ¥è¯¢</li>
<li>é•¿äº‹åŠ¡</li>
<li>é”ç­‰å¾…</li>
<li>è¿æ¥æ•°</li>
</ul>
<h3 data-id="heading-19">4. æºç ä¸èƒ½åªçœ‹ï¼Œè¦è°ƒè¯•</h3>
<p>çœ‹æºç å¾ˆå¤šæ—¶å€™çœ‹ä¸å‡ºé—®é¢˜ã€‚è¿™æ¬¡æ˜¯çœŸçš„æ‰“æ–­ç‚¹ä¸€æ­¥æ­¥èµ°ï¼Œæ‰å‘ç°<code>getTransaction</code>æ–¹æ³•é‡Œæœ‰ä¸ª<code>isExistingTransaction</code>çš„åˆ¤æ–­ã€‚</p>
<p>é‡åˆ°è¯¡å¼‚é—®é¢˜ï¼Œç›´æ¥ä¸Šæ–­ç‚¹è°ƒè¯•ã€‚çœ‹è°ƒç”¨æ ˆï¼Œçœ‹å˜é‡å€¼ï¼Œæ¯”çœ‹æ–‡æ¡£å¿«å¤šäº†ã€‚</p>
<h2 data-id="heading-20">å†™åœ¨æœ€å</h2>
<p>è¿™ä¸ªbugä¿®å¤åï¼Œæˆ‘è·ŸåŒäº‹ä¹Ÿåˆ†äº«äº†ä¸€ä¸‹ã€‚è®°å½•äº†é—®é¢˜ç°è±¡ã€æ’æŸ¥è¿‡ç¨‹ã€æ ¹æœ¬åŸå› ã€è§£å†³æ–¹æ¡ˆå’Œé¢„é˜²æªæ–½ã€‚</p>
<p>ä¸æ˜¯ä¸ºäº†ç”©é”…ï¼Œæ˜¯ä¸ºäº†è®©å›¢é˜Ÿå…¶ä»–äººé¿å…è¸©åŒæ ·çš„å‘ã€‚</p>
<p>æŠ€æœ¯å€ºä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯è¸©å‘äº†è¿˜ä¸æ€»ç»“ã€‚</p>
<p>ç”Ÿäº§ç¯å¢ƒçš„æ¯ä¸€æ¬¡äº‹æ•…ï¼Œéƒ½æ˜¯å­¦ä¹ çš„æœºä¼šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ]]></title>    <link>https://juejin.cn/post/7585463195200946226</link>    <guid>https://juejin.cn/post/7585463195200946226</guid>    <pubDate>2025-12-20T05:47:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585463195200946226" data-draft-id="7490783352842207259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ"/> <meta itemprop="keywords" content="Redis,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-20T05:47:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisä¸MySQLåŒå‰‘åˆç’§ï¼šç¼“å­˜æ›´æ–°ç­–ç•¥ä¸æ•°æ®ä¸€è‡´æ€§ä¿éšœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-20T05:47:47.000Z" title="Sat Dec 20 2025 05:47:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">ä¸€ã€å‰è¨€</h4>
<p>åœ¨ç°ä»£é«˜å¹¶å‘ç³»ç»Ÿä¸­ï¼Œæ€§èƒ½å’Œæ•°æ®ä¸€è‡´æ€§å¸¸å¸¸æ˜¯ä¸€å¯¹â€œæ¬¢å–œå†¤å®¶â€ï¼šè¿½æ±‚æè‡´æ€§èƒ½å¯èƒ½ç‰ºç‰²ä¸€è‡´æ€§ï¼Œè€Œè¿‡äºå¼ºè°ƒä¸€è‡´æ€§åˆå®¹æ˜“æ‹–æ…¢ç³»ç»Ÿå“åº”ã€‚Rediså’ŒMySQLä½œä¸ºä¸¤ç§æˆªç„¶ä¸åŒçš„æ•°æ®åº“æŠ€æœ¯ï¼Œå°±åƒæ­¦ä¾ å°è¯´ä¸­çš„åŒå‰‘ï¼Œä¸€ä¸ªå¿«å¦‚é—ªç”µï¼Œä¸€ä¸ªç¨³å¦‚ç£çŸ³ã€‚å¦‚ä½•è®©å®ƒä»¬æºæ‰‹ä½œæˆ˜ï¼Œæ—¢æå‡æ€§èƒ½åˆä¿éšœæ•°æ®ä¸€è‡´æ€§ï¼Œæ˜¯è®¸å¤šå¼€å‘è€…é¢ä¸´çš„ç°å®æŒ‘æˆ˜ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå•†ç³»ç»Ÿï¼Œå•†å“è¯¦æƒ…é¡µæ¯ç§’è¢«è®¿é—®ä¸Šä¸‡æ¬¡ï¼Œæ•°æ®åº“ä¸å ªé‡è´Ÿï¼›æˆ–è€…åœ¨ç§’æ€æ´»åŠ¨ä¸­ï¼Œåº“å­˜æ•°æ®ç¨æœ‰å»¶è¿Ÿå°±å¯èƒ½å¼•å‘è¶…å–ã€‚å•é MySQLï¼ŒæŸ¥è¯¢æ…¢ã€å‹åŠ›å¤§ï¼›å•é Redisï¼Œåˆéš¾ä»¥ä¿è¯æŒä¹…åŒ–å’Œå¤æ‚æŸ¥è¯¢ã€‚è¿™æ—¶ï¼ŒRedisä¸MySQLçš„ç»“åˆå°±æˆäº†â€œæ•‘å‘½ç¨»è‰â€ã€‚Redisè´Ÿè´£ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼ŒMySQLä¿éšœæ•°æ®æŒä¹…åŒ–å’Œäº‹åŠ¡æ”¯æŒï¼Œä¸¤è€…åˆ†å·¥æ˜ç¡®ï¼Œä¼˜åŠ¿äº’è¡¥ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« é¢å‘æœ‰1-2å¹´Redisä½¿ç”¨ç»éªŒçš„å¼€å‘è€…ã€‚ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰åŸºæœ¬çš„<code>SET</code>ã€<code>GET</code>æ“ä½œï¼Œä¹Ÿå°è¯•è¿‡ç”¨Redisä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ï¼Œä½†é¢å¯¹ç¼“å­˜æ›´æ–°ç­–ç•¥å’Œä¸€è‡´æ€§é—®é¢˜æ—¶ï¼Œéš¾å…æœ‰äº›è¿·é›¾é‡é‡ã€‚æˆ‘çš„ç›®æ ‡æ˜¯é€šè¿‡å®æˆ˜ç»éªŒï¼Œå¸¦ä½ æ¢³ç†Redisä¸MySQLååŒå·¥ä½œçš„æ ¸å¿ƒç­–ç•¥ï¼Œå‰–æå¸¸è§é—®é¢˜ï¼Œå¹¶åˆ†äº«è§£å†³æ–¹æ¡ˆå’Œæ³¨æ„äº‹é¡¹ã€‚æ— è®ºä½ æ˜¯æƒ³æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œè¿˜æ˜¯è§£å†³â€œç¼“å­˜å’Œæ•°æ®åº“ä¸åŒæ­¥â€çš„å¤´ç–¼é—®é¢˜ï¼Œè¿™é‡Œéƒ½æœ‰ä½ éœ€è¦çš„ç­”æ¡ˆã€‚</p>
<h5 data-id="heading-1">æˆ‘çš„æ•…äº‹ä¸ç»éªŒ</h5>
<p>æˆ‘ä»äº‹åç«¯å¼€å‘å·²æœ‰10å¹´ï¼Œå…¶ä¸­Rediså‡ ä¹æ˜¯æˆ‘æ¯ä¸ªé¡¹ç›®çš„â€œè€æ­æ¡£â€ã€‚ä»æ—©æœŸçš„é«˜å¹¶å‘ç”µå•†å¹³å°ï¼Œåˆ°åæ¥çš„å®æ—¶æ•°æ®åˆ†æç³»ç»Ÿï¼Œå†åˆ°æœ€è¿‘çš„åˆ†å¸ƒå¼æ—¥å¿—æœåŠ¡ï¼ŒRedisä¸MySQLçš„ç»„åˆè´¯ç©¿å§‹ç»ˆã€‚æ¯”å¦‚åœ¨æŸç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Redisç¼“å­˜å•†å“è¯¦æƒ…é¡µï¼ŒQPSä»å‡ ç™¾æå‡åˆ°ä¸Šä¸‡ï¼Œæ•°æ®åº“è´Ÿè½½é™ä½äº†80%ï¼›åœ¨å®æ—¶ç›‘æ§é¡¹ç›®ä¸­ï¼ŒRedisçš„ä½å»¶è¿Ÿè®©æˆ‘ä»¬èƒ½ç§’çº§æ›´æ–°æ•°æ®ï¼Œè€ŒMySQLåˆ™é»˜é»˜å®ˆæŠ¤ç€æ•°æ®çš„å®Œæ•´æ€§ã€‚è¿™äº›ç»éªŒå‘Šè¯‰æˆ‘ï¼Œç¼“å­˜ä¸æ•°æ®åº“çš„åä½œä¸ä»…ä»…æ˜¯æŠ€æœ¯é€‰å‹ï¼Œæ›´æ˜¯ä¸šåŠ¡éœ€æ±‚ä¸æ¶æ„è®¾è®¡çš„å¹³è¡¡ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¸€è·¯å¹¶éå¦é€”ã€‚ç¼“å­˜å¤±æ•ˆå¯¼è‡´çš„è„æ•°æ®ã€é«˜å¹¶å‘ä¸‹çš„çƒ­ç‚¹Keyé—®é¢˜ã€ç”šè‡³Rediså®•æœºå¼•å‘çš„è¿é”ååº”ï¼Œéƒ½è®©æˆ‘è¸©è¿‡ä¸å°‘å‘ã€‚æ­£æ˜¯è¿™äº›â€œæ‘”æ‰“â€ï¼Œè®©æˆ‘æ·±åˆ»è®¤è¯†åˆ°ç¼“å­˜æ›´æ–°ç­–ç•¥å’Œæ•°æ®ä¸€è‡´æ€§ä¿éšœçš„é‡è¦æ€§ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†ç»“åˆè¿™äº›å®æˆ˜ç»éªŒï¼Œå¸¦ä½ ä¸€æ­¥æ­¥è§£é”Redisä¸MySQLåŒå‰‘åˆç’§çš„å¥¥ç§˜ã€‚</p>
<hr/>
<h4 data-id="heading-2">äºŒã€Redisä¸MySQLåŒå‰‘åˆç’§çš„æ ¸å¿ƒä¼˜åŠ¿</h4>
<p>Rediså’ŒMySQLçš„ç»„åˆï¼Œå°±åƒä¸€åœºç²¾å¿ƒç¼–æ’çš„â€œåŒäººèˆâ€ï¼šRedisä»¥è¿…é›·ä¸åŠæ©è€³ä¹‹åŠ¿å¤„ç†é«˜é¢‘è¯·æ±‚ï¼ŒMySQLåˆ™ç¨³æ‰ç¨³æ‰“å®ˆæŠ¤æ•°æ®çš„å®Œæ•´æ€§ã€‚å•ç‹¬ä½¿ç”¨å®ƒä»¬éƒ½æœ‰å±€é™ï¼Œä½†ç»“åˆèµ·æ¥å´èƒ½è¿¸å‘å‡ºæƒŠäººçš„èƒ½é‡ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å‰–æä¸¤è€…çš„äº’è¡¥æ€§ï¼Œæ¢è®¨å…¸å‹åº”ç”¨åœºæ™¯ï¼Œå¹¶èŠèŠæ€§èƒ½ä¸ä¸€è‡´æ€§ä¹‹é—´çš„å¾®å¦™æƒè¡¡ã€‚</p>
<h5 data-id="heading-3">1. Redisä¸MySQLçš„äº’è¡¥æ€§</h5>
<p>MySQLæ˜¯å…³ç³»å‹æ•°æ®åº“çš„â€œè€å¤§å“¥â€ï¼Œæ“…é•¿æŒä¹…åŒ–å­˜å‚¨å’Œå¤æ‚æŸ¥è¯¢ã€‚å®ƒçš„å¼ºä¸€è‡´æ€§ï¼ˆACIDç‰¹æ€§ï¼‰å’Œä¸°å¯Œçš„äº‹åŠ¡æ”¯æŒï¼Œè®©å®ƒæˆä¸ºæ•°æ®å¯é æ€§çš„åŸºçŸ³ã€‚ç„¶è€Œï¼Œé¢å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Œç£ç›˜I/Oå’Œé”æœºåˆ¶å¾€å¾€è®©å®ƒâ€œå–˜ä¸è¿‡æ°”æ¥â€ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒRediså°±åƒä¸€ä½â€œè½»åŠŸé«˜æ‰‹â€ï¼ŒåŸºäºå†…å­˜æ“ä½œï¼Œè¯»å†™å»¶è¿Ÿä½è‡³äºšæ¯«ç§’çº§ï¼Œå•æœºQPSè½»æ¾çªç ´åä¸‡ï¼Œéå¸¸é€‚åˆç¼“å­˜çƒ­ç‚¹æ•°æ®æˆ–ä¸´æ—¶çŠ¶æ€ã€‚ä½†Redisä¹Ÿæœ‰çŸ­æ¿ï¼šæ•°æ®æŒä¹…åŒ–èƒ½åŠ›æœ‰é™ï¼Œå¤æ‚æŸ¥è¯¢æ›´æ˜¯å®ƒçš„â€œè½¯è‚‹â€ã€‚</p>
<p>ä¸¤è€…çš„ç»“åˆï¼Œæ°å¥½å¼¥è¡¥äº†å½¼æ­¤çš„ä¸è¶³ã€‚åœ¨æˆ‘å‚ä¸çš„ä¸€ä¸ªç”µå•†é¡¹ç›®ä¸­ï¼Œå•†å“è¯¦æƒ…é¡µçš„è®¿é—®é‡æ¿€å¢æ—¶ï¼Œæˆ‘ä»¬ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼ŒQPSä»500æå‡åˆ°2ä¸‡ï¼ŒMySQLçš„æŸ¥è¯¢å‹åŠ›éª¤é™80%ã€‚è€Œåº“å­˜æ›´æ–°ç­‰å…³é”®æ“ä½œä¾ç„¶äº¤ç»™MySQLï¼Œç¡®ä¿æ•°æ®ä¸ä¼šå› Rediså®•æœºè€Œä¸¢å¤±ã€‚è¿™ç§â€œå¿«æ…¢æ­é…â€çš„æ¨¡å¼ï¼Œæ—¢æå‡äº†æ€§èƒ½ï¼Œåˆä¿éšœäº†å¯é æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ä¸€è§ˆè¡¨ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>MySQL</th><th>Redis</th><th>ç»“åˆåæ•ˆæœ</th></tr></thead><tbody><tr><td>æ•°æ®å­˜å‚¨</td><td>ç£ç›˜ï¼ŒæŒä¹…åŒ–</td><td>å†…å­˜ï¼Œä¸´æ—¶</td><td>çƒ­ç‚¹æ•°æ®åŠ é€Ÿï¼Œæ ¸å¿ƒæ•°æ®å®‰å…¨</td></tr><tr><td>è®¿é—®é€Ÿåº¦</td><td>æ¯«ç§’çº§</td><td>äºšæ¯«ç§’çº§</td><td>æ€§èƒ½æå‡10å€ä»¥ä¸Š</td></tr><tr><td>æŸ¥è¯¢èƒ½åŠ›</td><td>å¤æ‚SQLæ”¯æŒ</td><td>ç®€å•Key-Value</td><td>æ»¡è¶³å¤šæ ·åŒ–éœ€æ±‚</td></tr><tr><td>ä¸€è‡´æ€§</td><td>å¼ºä¸€è‡´æ€§</td><td>å¼±ä¸€è‡´æ€§</td><td>å¯æ ¹æ®ä¸šåŠ¡çµæ´»è°ƒæ•´</td></tr></tbody></table>
<h5 data-id="heading-4">2. å…¸å‹åº”ç”¨åœºæ™¯</h5>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒRedisä¸MySQLçš„ç»„åˆæ— å¤„ä¸åœ¨ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå¸¸è§çš„ä¾‹å­ï¼š</p>
<ul>
<li>
<p><strong>ç”µå•†å•†å“è¯¦æƒ…é¡µ</strong><br/>
å•†å“ä¿¡æ¯ï¼ˆå¦‚åç§°ã€ä»·æ ¼ï¼‰å˜åŒ–é¢‘ç‡ä½ï¼Œä½†è®¿é—®é‡æé«˜ã€‚æˆ‘ä»¬ç”¨Redisç¼“å­˜è¿™äº›æ•°æ®ï¼Œè®¾ç½®TTLä¸º1å°æ—¶ï¼Œæå¤§å‡å°‘MySQLçš„æŸ¥è¯¢å‹åŠ›ã€‚è€Œåº“å­˜æ•°æ®å› å®æ—¶æ€§è¦æ±‚é«˜ï¼Œæ›´æ–°æ—¶ç›´æ¥å†™MySQLï¼Œå†åŒæ­¥å¤±æ•ˆRedisç¼“å­˜ã€‚è¿™ç§åˆ†å·¥è®©ç³»ç»Ÿæ—¢å¿«åˆç¨³ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·ä¼šè¯ç®¡ç†</strong><br/>
åœ¨ä¸€ä¸ªç¤¾äº¤åº”ç”¨ä¸­ï¼Œç”¨æˆ·ç™»å½•çŠ¶æ€ç”¨Rediså­˜å‚¨ï¼ŒTTLè®¾ä¸º30åˆ†é’Ÿï¼Œå¿«é€Ÿå“åº”ä¼šè¯æŸ¥è¯¢ã€‚ç”¨æˆ·çš„é•¿æœŸæ•°æ®ï¼ˆå¦‚æ³¨å†Œä¿¡æ¯ï¼‰åˆ™ä¿å­˜åœ¨MySQLä¸­ï¼Œç¡®ä¿å³ä½¿Redisé‡å¯ï¼Œä¼šè¯è¿‡æœŸåä¹Ÿèƒ½ä»MySQLæ¢å¤ã€‚è¿™ç§æ­é…è®©ä¼šè¯ç®¡ç†é«˜æ•ˆåˆå¯é ã€‚</p>
</li>
</ul>
<h5 data-id="heading-5">3. ä¸€è‡´æ€§ä¸æ€§èƒ½çš„æƒè¡¡</h5>
<p>Redisä¸MySQLåä½œæ—¶ï¼Œæ€§èƒ½å’Œä¸€è‡´æ€§å°±åƒå¤©å¹³çš„ä¸¤ç«¯ï¼Œå¾ˆéš¾ä¸¤å…¨å…¶ç¾ã€‚æˆ‘ä»¬å¸¸å¬åˆ°â€œæœ€ç»ˆä¸€è‡´æ€§â€å’Œâ€œå¼ºä¸€è‡´æ€§â€è¿™ä¸¤ä¸ªè¯ï¼Œå®ƒä»¬è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿç­”æ¡ˆè—åœ¨ä¸šåŠ¡éœ€æ±‚é‡Œã€‚</p>
<p>ä»¥ç§’æ€åœºæ™¯ä¸ºä¾‹ï¼Œåº“å­˜æ‰£å‡å¿…é¡»å®æ—¶å‡†ç¡®ï¼Œä»»ä½•å»¶è¿Ÿæˆ–ä¸ä¸€è‡´éƒ½å¯èƒ½å¯¼è‡´è¶…å–ã€‚è¿™æ—¶éœ€è¦å¼ºä¸€è‡´æ€§ï¼Œé€šå¸¸é€šè¿‡åˆ†å¸ƒå¼é”æˆ–äº‹åŠ¡ç¡®ä¿Rediså’ŒMySQLåŒæ­¥æ›´æ–°ã€‚è€Œåœ¨æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çœ‹åˆ°çš„å•†å“åˆ—è¡¨å¯èƒ½åŸºäºå‡ åˆ†é’Ÿå‰çš„æ•°æ®ï¼ŒçŸ­æš‚çš„ä¸ä¸€è‡´æ— ä¼¤å¤§é›…ï¼Œæœ€ç»ˆä¸€è‡´æ€§å°±å¤Ÿç”¨äº†â€”â€”å…ˆæ›´æ–°MySQLï¼Œå†å¼‚æ­¥åˆ·æ–°Rediså³å¯ã€‚</p>
<p><strong>æƒè¡¡é€‰æ‹©ç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">é«˜ä¸€è‡´æ€§éœ€æ±‚       ä¸­é—´åœ°å¸¦       é«˜æ€§èƒ½éœ€æ±‚
|<span class="hljs-comment">-------|-------|-------|-------|</span>
å¼ºä¸€è‡´æ€§         æœ€ç»ˆä¸€è‡´æ€§
&lt;<span class="hljs-comment">-- ç§’æ€ã€æ”¯ä»˜ --&gt; &lt;-- æ¨èã€æ—¥å¿— --&gt;</span>
</code></pre>
<p>åœ¨æˆ‘çš„ç»éªŒä¸­ï¼Œä¸€ä¸ªå®æ—¶æ•°æ®åˆ†æé¡¹ç›®è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°è¿™ç§æƒè¡¡ã€‚åˆæœŸæˆ‘ä»¬è¿½æ±‚å¼ºä¸€è‡´æ€§ï¼Œæ‰€æœ‰æ•°æ®éƒ½åŒæ­¥å†™Rediså’ŒMySQLï¼Œç»“æœæ€§èƒ½ç“¶é¢ˆæ˜æ˜¾ã€‚åæ¥è°ƒæ•´ä¸ºå¼‚æ­¥å†™å›ç­–ç•¥ï¼Œååé‡æå‡äº†3å€ï¼Œç”¨æˆ·ä¹Ÿèƒ½æ¥å—ç§’çº§çš„å»¶è¿Ÿã€‚è¿™æé†’æˆ‘ä»¬ï¼šæŠ€æœ¯æ–¹æ¡ˆæ²¡æœ‰ç»å¯¹çš„å¥½åï¼Œåªæœ‰é€‚ä¸é€‚åˆã€‚</p>
<hr/>
<h4 data-id="heading-6">ä¸‰ã€ç¼“å­˜æ›´æ–°ç­–ç•¥è¯¦è§£</h4>
<p>Redisä¸MySQLçš„åä½œå¥½æ¯”ä¸€åœºç²¾å¯†çš„â€œæ¥åŠ›èµ›â€ï¼Œç¼“å­˜æ›´æ–°ç­–ç•¥å°±æ˜¯æ¥åŠ›æ£’äº¤æ¥çš„è§„åˆ™ã€‚äº¤æ¥é¡ºç•…ï¼Œç³»ç»Ÿè·‘å¾—åˆå¿«åˆç¨³ï¼›ç¨æœ‰å¤±è¯¯ï¼Œå°±å¯èƒ½æ‘”ä¸ªè·Ÿå¤´ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸‰ç§ä¸»æµç¼“å­˜æ›´æ–°ç­–ç•¥ï¼šCache-Asideã€Write-Throughå’ŒWrite-Behindï¼Œå‰–æå®ƒä»¬çš„åŸç†ã€ä¼˜ç¼ºç‚¹ï¼Œå¹¶ç»“åˆå®æˆ˜ç»éªŒåˆ†äº«ä»£ç å’Œè¸©å‘æ•™è®­ï¼Œæœ€åç»™å‡ºé€‰æ‹©å»ºè®®ã€‚</p>
<h5 data-id="heading-7">1. å¸¸è§çš„ç¼“å­˜æ›´æ–°ç­–ç•¥</h5>
<h6 data-id="heading-8">Cache-Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šè¿™æ˜¯æœ€ç»å…¸çš„ç¼“å­˜ç­–ç•¥ã€‚è¯»å–æ—¶ï¼Œå…ˆæŸ¥Redisï¼Œè‹¥æœªå‘½ä¸­åˆ™æŸ¥MySQLå¹¶å›å†™ç¼“å­˜ï¼›å†™å…¥æ—¶ï¼Œå…ˆæ›´æ–°MySQLï¼Œå†ä¸»åŠ¨å¤±æ•ˆï¼ˆåˆ é™¤ï¼‰Redisç¼“å­˜ã€‚è¿™ç§â€œæ‡’åŠ è½½â€çš„æ–¹å¼è®©ç¼“å­˜æŒ‰éœ€å¡«å……ï¼Œéå¸¸çµæ´»ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å®ç°ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½ã€‚</li>
<li>é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜æ—¶æ€§èƒ½æå‡æ˜¾è‘—ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span>
String <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user:"</span> + userId;
    <span class="hljs-type">String</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> redis.get(cacheKey); <span class="hljs-comment">// å…ˆæŸ¥Redis</span>
    <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) { <span class="hljs-comment">// æœªå‘½ä¸­</span>
        user = mysql.query(<span class="hljs-string">"SELECT * FROM users WHERE id = ?"</span>, userId); <span class="hljs-comment">// æŸ¥MySQL</span>
        <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) {
            redis.setex(cacheKey, <span class="hljs-number">3600</span>, user); <span class="hljs-comment">// å›å†™Redisï¼ŒTTLä¸º1å°æ—¶</span>
        }
    }
    <span class="hljs-keyword">return</span> user;
}

<span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">updateUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId, String data)</span> {
    mysql.update(<span class="hljs-string">"UPDATE users SET data = ? WHERE id = ?"</span>, data, userId); <span class="hljs-comment">// å…ˆæ›´æ–°MySQL</span>
    redis.del(<span class="hljs-string">"user:"</span> + userId); <span class="hljs-comment">// å†åˆ é™¤Redisç¼“å­˜</span>
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨ä¸€ä¸ªç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å‘ç°éƒ¨åˆ†ç”¨æˆ·æ•°æ®æ›´æ–°åï¼Œç¼“å­˜æœªåŠæ—¶å¤±æ•ˆï¼Œå¯¼è‡´å‰ç«¯æ˜¾ç¤ºè„æ•°æ®ã€‚åæ¥åˆ†æå‘ç°ï¼ŒæŸäº›åœºæ™¯ä¸‹<code>redis.del</code>å› ç½‘ç»œæŠ–åŠ¨å¤±è´¥ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥TTLè‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œå³ä½¿åˆ é™¤å¤±è´¥ï¼Œç¼“å­˜ä¹Ÿä¼šåœ¨åˆ°æœŸåå¤±æ•ˆï¼Œé¿å…é•¿æœŸä¸ä¸€è‡´ã€‚</p>
<h6 data-id="heading-9">Write-Throughï¼ˆç›´å†™ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šå†™å…¥æ—¶åŒæ—¶æ›´æ–°MySQLå’ŒRedisï¼Œç¡®ä¿ä¸¤è€…æ•°æ®æ—¶åˆ»ä¸€è‡´ã€‚å°±åƒâ€œåŒç®¡é½ä¸‹â€ï¼Œæ¯æ¬¡å†™æ“ä½œéƒ½ä¸¤è¾¹åŒæ­¥ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¸€è‡´æ€§å¼ºï¼Œè¯»æ“ä½œæ— éœ€æ‹…å¿ƒè„æ•°æ®ã€‚</li>
<li>é€‚åˆå†™é¢‘ç¹ä¸”ä¸€è‡´æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>æ€§èƒ½å¼€é”€å¤§ï¼ŒåŒå†™å¢åŠ äº†å»¶è¿Ÿã€‚</li>
<li>Rediså’ŒMySQLçš„åŒæ­¥å¯èƒ½å› å¼‚å¸¸ä¸­æ–­ã€‚</li>
</ul>
<p><strong>å®é™…åœºæ™¯</strong>ï¼š<br/>
åœ¨é‡‘èç³»ç»Ÿçš„è´¦æˆ·ä½™é¢æ›´æ–°ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨Write-Throughã€‚æ¯æ¬¡è½¬è´¦æ“ä½œå…ˆå†™MySQLï¼Œå†åŒæ­¥æ›´æ–°Redisï¼Œç¡®ä¿ä½™é¢å®æ—¶å‡†ç¡®ã€‚è™½ç„¶æ€§èƒ½ç•¥æœ‰ä¸‹é™ï¼Œä½†ä¸€è‡´æ€§å¾—åˆ°äº†ä¿éšœã€‚</p>
<h6 data-id="heading-10">Write-Behindï¼ˆå¼‚æ­¥å†™å›ï¼‰</h6>
<p><strong>åŸç†</strong>ï¼šå…ˆå¿«é€Ÿå†™å…¥Redisï¼Œå†é€šè¿‡å¼‚æ­¥ä»»åŠ¡ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—æˆ–å®šæ—¶ä»»åŠ¡ï¼‰æ‰¹é‡æ›´æ–°MySQLã€‚å°±åƒâ€œå…ˆè®°è´¦ï¼Œåå¯¹è´¦â€ï¼Œä¼˜å…ˆä¿è¯å†™æ€§èƒ½ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>é«˜ååé‡ï¼Œé€‚åˆé«˜å¹¶å‘å†™åœºæ™¯ã€‚</li>
<li>å¼‚æ­¥æ‰¹é‡æ“ä½œå‡å°‘æ•°æ®åº“å‹åŠ›ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateProductStock</span><span class="hljs-params">(<span class="hljs-type">int</span> productId, <span class="hljs-type">int</span> stock)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"stock:"</span> + productId;
    redis.set(cacheKey, stock); <span class="hljs-comment">// å…ˆå†™Redis</span>
    messageQueue.send(<span class="hljs-string">"update_stock"</span>, productId, stock); <span class="hljs-comment">// å¼‚æ­¥å‘MQæ›´æ–°MySQL</span>
}

<span class="hljs-comment">// MQæ¶ˆè´¹è€…</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String productId, <span class="hljs-type">int</span> stock)</span> {
    mysql.update(<span class="hljs-string">"UPDATE products SET stock = ? WHERE id = ?"</span>, stock, productId);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨å®æ—¶ç›‘æ§ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç”¨Write-Behindå¤„ç†æŒ‡æ ‡æ•°æ®ã€‚æŸæ¬¡MQæ¶ˆè´¹å¤±è´¥ï¼Œå¯¼è‡´MySQLæœªæ›´æ–°ï¼Œæ•°æ®ä¸¢å¤±äº†è¿‘1å°æ—¶ã€‚å¸å–æ•™è®­åï¼Œæˆ‘ä»¬å¼•å…¥é‡è¯•æœºåˆ¶å’Œæ—¥å¿—è¡¥å¿ï¼šå¤±è´¥çš„ä»»åŠ¡é‡è¯•3æ¬¡ä»ä¸æˆåŠŸåˆ™è®°å½•æ—¥å¿—ï¼Œè¿ç»´äººå‘˜æ‰‹åŠ¨ä¿®å¤ã€‚</p>
<h5 data-id="heading-11">2. å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç­–ç•¥</h5>
<p>é€‰æ‹©ç¼“å­˜ç­–ç•¥å°±åƒæŒ‘é€‰æ­¦åŠŸæ‹›å¼ï¼Œæ²¡æœ‰æœ€å¼ºï¼Œåªæœ‰æœ€åˆé€‚ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„ç»éªŒæ€»ç»“ï¼š</p>
<p><strong>é€‰æ‹©ä¾æ®å¯¹æ¯”è¡¨ï¼š</strong></p>

































<table><thead><tr><th>ç­–ç•¥</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¸€è‡´æ€§</th><th>æ€§èƒ½</th><th>å¤æ‚åº¦</th></tr></thead><tbody><tr><td>Cache-Aside</td><td>è¯»å¤šå†™å°‘ï¼ˆå¦‚å•†å“è¯¦æƒ…ï¼‰</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>é«˜</td><td>ä½</td></tr><tr><td>Write-Through</td><td>å†™é¢‘ç¹ä¸€è‡´æ€§é«˜ï¼ˆå¦‚é‡‘èï¼‰</td><td>å¼ºä¸€è‡´æ€§</td><td>ä¸­</td><td>ä¸­</td></tr><tr><td>Write-Behind</td><td>é«˜å¹¶å‘å†™ï¼ˆå¦‚æ—¥å¿—ï¼‰</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>æé«˜</td><td>é«˜</td></tr></tbody></table>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼š</p>
<ul>
<li><strong>ç”µå•†åº“å­˜ç®¡ç†</strong>ï¼šæˆ‘ä»¬ç”¨Cache-Asideç»“åˆå»¶è¿ŸåŒåˆ ï¼ˆåæ–‡è¯¦è¿°ï¼‰ï¼Œåº”å¯¹è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç¡®ä¿åº“å­˜æ›´æ–°åç¼“å­˜åŠæ—¶åˆ·æ–°ã€‚</li>
<li><strong>å®æ—¶ç›‘æ§</strong>ï¼šWrite-Throughä¿è¯æŒ‡æ ‡æ•°æ®å®æ—¶åŒæ­¥ï¼Œæ»¡è¶³å¼ºä¸€è‡´æ€§éœ€æ±‚ã€‚</li>
<li><strong>æ—¥å¿—ç³»ç»Ÿ</strong>ï¼šWrite-Behindé…åˆæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè½»æ¾åº”å¯¹æ¯ç§’ç™¾ä¸‡çº§çš„å†™è¯·æ±‚ã€‚</li>
</ul>
<p>é€‰æ‹©æ—¶ï¼Œå»ºè®®ä»ä¸šåŠ¡ç‰¹ç‚¹å‡ºå‘ï¼š</p>
<ol>
<li><strong>è¯»å†™æ¯”ä¾‹</strong>ï¼šè¯»å¤šå†™å°‘é€‰Cache-Asideï¼Œå†™å¤šè¯»å°‘é€‰Write-Throughã€‚</li>
<li><strong>ä¸€è‡´æ€§è¦æ±‚</strong>ï¼šå¼ºä¸€è‡´æ€§é€‰Write-Throughï¼Œæœ€ç»ˆä¸€è‡´æ€§å¯è€ƒè™‘å…¶ä»–ä¸¤è€…ã€‚</li>
<li><strong>ç³»ç»Ÿå¤æ‚åº¦</strong>ï¼šèµ„æºæœ‰é™æ—¶ï¼Œä¼˜å…ˆç®€å•æ˜“ç”¨çš„Cache-Asideã€‚</li>
</ol>
<p><strong>ç­–ç•¥é€‰æ‹©æµç¨‹å›¾ï¼š</strong></p>
<pre><code class="hljs language-rust" lang="rust">å¼€å§‹
  |
è¯»å¤šå†™å°‘? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Cache-Aside
  |             å¦
å¼ºä¸€è‡´æ€§? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Write-Through
  |             å¦
é«˜å¹¶å‘å†™? -<span class="hljs-punctuation">-&gt;</span> æ˜¯ -<span class="hljs-punctuation">-&gt;</span> Write-Behind
  |
å…¶ä»–åœºæ™¯ -<span class="hljs-punctuation">-&gt;</span> æ ¹æ®å¤æ‚åº¦è°ƒæ•´
</code></pre>
<hr/>
<h4 data-id="heading-12">å››ã€æ•°æ®ä¸€è‡´æ€§ä¿éšœçš„å®æˆ˜æŠ€å·§</h4>
<p>ç¼“å­˜æ›´æ–°ç­–ç•¥ä¸ºRedisä¸MySQLçš„åä½œæ­å¥½äº†èˆå°ï¼Œä½†ä¸€è‡´æ€§é—®é¢˜å°±åƒèˆå°ä¸‹çš„â€œæš—æµâ€ï¼Œç¨ä¸ç•™ç¥å°±ä¼šè®©è¡¨æ¼”ç¿»è½¦ã€‚æ— è®ºæ˜¯ç¼“å­˜æœªåŠæ—¶åˆ·æ–°ï¼Œè¿˜æ˜¯å¹¶å‘æ›´æ–°å¯¼è‡´çš„è„æ•°æ®ï¼Œè¿™äº›é—®é¢˜éƒ½å¯èƒ½è®©ç”¨æˆ·ä½“éªŒå¤§æ‰“æŠ˜æ‰£ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ç›´é¢ä¸€è‡´æ€§é—®é¢˜çš„æ ¹æºï¼Œåˆ†äº«æˆ‘åœ¨é¡¹ç›®ä¸­æ€»ç»“çš„å®æˆ˜æŠ€å·§ï¼Œå¸®åŠ©ä½ æ‰“é€ ä¸€ä¸ªæ—¢å¿«åˆå‡†çš„ç³»ç»Ÿã€‚</p>
<h5 data-id="heading-13">1. ä¸€è‡´æ€§é—®é¢˜çš„æ ¹æº</h5>
<p>ä¸€è‡´æ€§é—®é¢˜é€šå¸¸æºäºä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>æ›´æ–°é¡ºåºå¼‚å¸¸</strong>ï¼šæ¯”å¦‚å…ˆå†™MySQLååˆ Redisï¼Œä½†Rediså®•æœºæˆ–ç½‘ç»œå»¶è¿Ÿå¯¼è‡´åˆ é™¤å¤±è´¥ï¼Œç¼“å­˜ä¿ç•™äº†æ—§æ•°æ®ã€‚</li>
<li><strong>å¹¶å‘å†²çª</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶æ›´æ–°åŒä¸€æ•°æ®ï¼Œæ¯”å¦‚ç§’æ€åœºæ™¯ä¸‹å¤šäººæŠ¢è´­åº“å­˜ï¼Œå¯èƒ½å‡ºç°Rediså’ŒMySQLçš„æ•°æ®â€œæ‰“æ¶â€ã€‚</li>
</ul>
<p>åœ¨ä¸€æ¬¡ç”µå•†æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬å°±é‡åˆ°è¿‡ç±»ä¼¼é—®é¢˜ï¼šåº“å­˜æ›´æ–°åï¼ŒRedisç¼“å­˜æœªåŠæ—¶åˆ é™¤ï¼Œå¯¼è‡´å‰ç«¯æ˜¾ç¤ºçš„åº“å­˜æ¯”å®é™…å¤šï¼Œæœ€ç»ˆå¼•å‘è¶…å–ã€‚åˆ†æåå‘ç°ï¼Œæ ¹æºåœ¨äºé«˜å¹¶å‘ä¸‹æ“ä½œé¡ºåºä¸å¯æ§å’Œå¼‚å¸¸å¤„ç†ä¸è¶³ã€‚</p>
<h5 data-id="heading-14">2. è§£å†³æ–¹æ¡ˆä¸æœ€ä½³å®è·µ</h5>
<p>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œæˆ‘æ€»ç»“äº†ä¸‰ç§å®ç”¨æ–¹æ¡ˆï¼Œä¸‹é¢é€ä¸€å±•å¼€ã€‚</p>
<h6 data-id="heading-15">å»¶è¿ŸåŒåˆ ç­–ç•¥</h6>
<p><strong>åŸç†</strong>ï¼šå†™MySQLåç«‹å³åˆ é™¤Redisç¼“å­˜ï¼Œç­‰å‡ ç§’åå†åˆ ä¸€æ¬¡ï¼Œç¡®ä¿å³ä½¿æœ‰å¹¶å‘è¯»å›å†™äº†æ—§æ•°æ®ï¼Œä¹Ÿèƒ½è¢«æ¸…ç†æ‰ã€‚è¿™å°±åƒâ€œåŒé‡ä¿é™©â€ï¼Œç‰ºç‰²ä¸€ç‚¹å»¶è¿Ÿæ¢å–ä¸€è‡´æ€§ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJava+Springï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(<span class="hljs-type">int</span> productId, String data)</span> {
    <span class="hljs-comment">// æ›´æ–°MySQL</span>
    mysql.update(<span class="hljs-string">"UPDATE products SET data = ? WHERE id = ?"</span>, data, productId);
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + productId;
    redis.del(cacheKey); <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åˆ é™¤</span>
    <span class="hljs-comment">// å»¶è¿Ÿ2ç§’å†æ¬¡åˆ é™¤</span>
    taskScheduler.schedule(() -&gt; redis.del(cacheKey), <span class="hljs-number">2000</span>);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨æŸé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å›ºå®šå»¶è¿Ÿ2ç§’ï¼Œç»“æœå‘ç°é«˜å³°æœŸQPSè¿‡é«˜æ—¶ï¼Œ2ç§’ä¸å¤Ÿè¦†ç›–æ‰€æœ‰å¹¶å‘è¯»ï¼Œå¯¼è‡´éƒ¨åˆ†è„æ•°æ®æ®‹ç•™ã€‚åæ¥æ”¹ä¸ºåŠ¨æ€è°ƒæ•´å»¶è¿Ÿæ—¶é—´ï¼ˆæ ¹æ®ä¸šåŠ¡QPSï¼ŒèŒƒå›´1-5ç§’ï¼‰ï¼Œé—®é¢˜æ˜¾è‘—å‡å°‘ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šè¯»å¤šå†™å°‘ï¼Œä¸”èƒ½å®¹å¿çŸ­æš‚ä¸ä¸€è‡´ã€‚</p>
<h6 data-id="heading-16">åˆ†å¸ƒå¼é”</h6>
<p><strong>åŸç†</strong>ï¼šåœ¨é«˜å¹¶å‘æ›´æ–°æ—¶ï¼Œç”¨Redisåˆ†å¸ƒå¼é”ç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ“ä½œæ•°æ®ï¼Œé¿å…å†²çªã€‚å°±åƒç»™èµ„æºåŠ äº†æŠŠâ€œå®‰å…¨é”â€ï¼Œè°æ‹¿åˆ°é’¥åŒ™è°æ“ä½œã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆRedisåˆ†å¸ƒå¼é”ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">lockKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"lock:product:"</span> + productId;
<span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"product:"</span> + productId;
<span class="hljs-keyword">if</span> (redis.setnx(lockKey, <span class="hljs-string">"1"</span>)) { <span class="hljs-comment">// å°è¯•åŠ é”</span>
    redis.expire(lockKey, <span class="hljs-number">10</span>); <span class="hljs-comment">// è®¾ç½®10ç§’è¶…æ—¶</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ›´æ–°MySQL</span>
        mysql.update(<span class="hljs-string">"UPDATE products SET stock = stock - 1 WHERE id = ?"</span>, productId);
        redis.del(cacheKey); <span class="hljs-comment">// åŒæ­¥åˆ é™¤ç¼“å­˜</span>
    } <span class="hljs-keyword">finally</span> {
        redis.del(lockKey); <span class="hljs-comment">// é‡Šæ”¾é”</span>
    }
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–é”å¤±è´¥ï¼Œé‡è¯•"</span>);
}
</code></pre>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li><strong>è¶…æ—¶è®¾ç½®</strong>ï¼šé”è¶…æ—¶å¤ªçŸ­å¯èƒ½æå‰é‡Šæ”¾ï¼Œå¤ªé•¿å¯èƒ½é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œå»ºè®®æ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼ˆ5-30ç§’ï¼‰ã€‚</li>
<li><strong>ç»­æœŸæœºåˆ¶</strong>ï¼šè‹¥æ“ä½œè€—æ—¶é•¿ï¼Œå¯ç”¨watchdogçº¿ç¨‹è‡ªåŠ¨ç»­æœŸï¼Œé¿å…æ­»é”ã€‚</li>
<li><strong>è¸©å‘ç»éªŒ</strong>ï¼šä¸€æ¬¡ç§’æ€æ´»åŠ¨ä¸­ï¼Œå¿˜è®°é‡Šæ”¾é”ï¼Œå¯¼è‡´åç»­è¯·æ±‚å…¨è¢«é˜»å¡ã€‚åæ¥ç”¨<code>finally</code>å—ç¡®ä¿é‡Šæ”¾ï¼Œæ‰è§£å†³é—®é¢˜ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç§’æ€ã€åº“å­˜æ‰£å‡ç­‰é«˜å¹¶å‘å¼ºä¸€è‡´æ€§åœºæ™¯ã€‚</p>
<h6 data-id="heading-17">æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦</h6>
<p><strong>åŸç†</strong>ï¼šå†™æ“ä½œé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰è§£è€¦ï¼Œå…ˆå¿«é€Ÿå†™Redisï¼Œå†ç”±æ¶ˆè´¹è€…å¼‚æ­¥æ›´æ–°MySQLã€‚è¿™å°±åƒâ€œå¿«é€’ä»£å‘â€ï¼Œå‰ç«¯å¿«é€Ÿå“åº”ï¼Œåç«¯æ…¢æ…¢å¤„ç†ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆJavaä¼ªä»£ç ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateLog</span><span class="hljs-params">(String logData)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"log:"</span> + UUID.randomUUID();
    redis.set(cacheKey, logData); <span class="hljs-comment">// å…ˆå†™Redis</span>
    messageQueue.send(<span class="hljs-string">"update_log"</span>, logData); <span class="hljs-comment">// å‘MQå¼‚æ­¥æ›´æ–°</span>
}

<span class="hljs-comment">// MQæ¶ˆè´¹è€…</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String logData)</span> {
    mysql.insert(<span class="hljs-string">"INSERT INTO logs (data) VALUES (?)"</span>, logData);
}
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š<br/>
åœ¨æ—¥å¿—ç³»ç»Ÿä¸­ï¼ŒMQæ¶ˆè´¹è€…å®•æœºå¯¼è‡´ç§¯å‹ï¼ŒMySQLæœªåŠæ—¶æ›´æ–°ã€‚åæ¥å¼•å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ‰€æœ‰æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯è½¬å…¥å¤‡ç”¨é˜Ÿåˆ—ï¼Œç”±å®šæ—¶ä»»åŠ¡é‡è¯•ï¼Œç¡®ä¿ä¸ä¸¢æ•°æ®ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé«˜å¹¶å‘å†™ï¼Œä¸”ä¸€è‡´æ€§è¦æ±‚ä¸é«˜ï¼ˆå¦‚æ—¥å¿—ã€ç»Ÿè®¡æ•°æ®ï¼‰ã€‚</p>
<h5 data-id="heading-18">3. ä¸€è‡´æ€§éªŒè¯</h5>
<p>æ— è®ºç”¨å“ªç§ç­–ç•¥ï¼Œå¼‚å¸¸æ€»å¯èƒ½å‘ç”Ÿã€‚ä¸ºé˜²ä¸‡ä¸€ï¼Œæˆ‘ä»¬éœ€è¦â€œæŸ¥æ¼è¡¥ç¼ºâ€ï¼š</p>
<ul>
<li><strong>å®šæœŸæ¯”å¯¹</strong>ï¼šç”¨å®šæ—¶ä»»åŠ¡å¯¹æ¯”Redisä¸MySQLæ•°æ®ï¼Œå‘ç°ä¸ä¸€è‡´æ—¶è‡ªåŠ¨ä¿®å¤ã€‚</li>
<li><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåœ¨ç”µå•†åº“å­˜ç®¡ç†ä¸­ï¼Œæˆ‘ä»¬æ¯å¤©å‡Œæ™¨è·‘è„šæœ¬æ¯”å¯¹ï¼Œä¿®å¤äº†99%çš„è„æ•°æ®é—®é¢˜ã€‚ä¿®å¤è¿‡ç¨‹è®°å½•æ—¥å¿—ï¼Œä¾¿äºè¿½æº¯ã€‚</li>
</ul>
<p><strong>éªŒè¯æµç¨‹ç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-rust" lang="rust">å®šæ—¶ä»»åŠ¡å¯åŠ¨
    |
è·å–Redisæ•°æ® -<span class="hljs-punctuation">-&gt;</span> ä¸MySQLæ¯”å¯¹ -<span class="hljs-punctuation">-&gt;</span> ä¸ä¸€è‡´?
    |                              æ˜¯ -<span class="hljs-punctuation">-&gt;</span> æ›´æ–°Redisæˆ–MySQL -<span class="hljs-punctuation">-&gt;</span> è®°å½•æ—¥å¿—
    |                              å¦
ç»“æŸ
</code></pre>
<p><strong>ä¸€è‡´æ€§ä¿éšœæ–¹æ¡ˆå¯¹æ¯”è¡¨ï¼š</strong></p>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¸€è‡´æ€§</th><th>æ€§èƒ½å½±å“</th><th>å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>å»¶è¿ŸåŒåˆ </td><td>è¾ƒé«˜</td><td>å°</td><td>ä¸­</td><td>è¯»å¤šå†™å°‘</td></tr><tr><td>åˆ†å¸ƒå¼é”</td><td>æé«˜</td><td>ä¸­</td><td>é«˜</td><td>é«˜å¹¶å‘å¼ºä¸€è‡´æ€§</td></tr><tr><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>æœ€ç»ˆä¸€è‡´æ€§</td><td>ä½</td><td>é«˜</td><td>é«˜å¹¶å‘å†™</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-19">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸è¸©å‘ç»éªŒ</h4>
<p>Redisä¸MySQLçš„åä½œå°±åƒä¸€è¾†è·‘è½¦ï¼Œç¼“å­˜ç­–ç•¥å’Œä¸€è‡´æ€§ä¿éšœæ˜¯å¼•æ“ï¼Œè€Œæ€§èƒ½ä¼˜åŒ–åˆ™æ˜¯è®©å®ƒè·‘å¾—æ›´å¿«æ›´ç¨³çš„â€œè°ƒæ ¡â€ã€‚ä½†è¿™æ¡èµ›é“ä¸Šä¹ŸåŸ‹äº†ä¸å°‘â€œé™·é˜±â€ï¼Œç¨ä¸ç•™ç¥å°±å¯èƒ½ç¿»è½¦ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†åˆ†äº«æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæŠ€å·§ï¼Œä»¥åŠæˆ‘åœ¨å®æˆ˜ä¸­è¸©è¿‡çš„å‘å’Œåº”å¯¹ä¹‹é“ï¼Œå¸Œæœ›å¸®ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<h5 data-id="heading-20">1. æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ç‚¹</h5>
<p>è¦æƒ³è®©ç³»ç»Ÿè·‘å¾—å¿«ï¼Œç»†èŠ‚å†³å®šæˆè´¥ã€‚ä»¥ä¸‹æ˜¯ä¸‰ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>
<p><strong>Redisé”®è®¾è®¡</strong><br/>
é”®åè¦çŸ­å°ç²¾æ‚ï¼Œé¿å…â€œå¤§Keyâ€æ‹–æ…¢æ€§èƒ½ã€‚æ¯”å¦‚å­˜å‚¨å¤æ‚æ•°æ®æ—¶ï¼Œåˆ«ç”¨ä¸€ä¸ªStringå­˜JSONï¼Œè€Œæ˜¯ç”¨Hashç»“æ„åˆ†å­—æ®µå­˜å‚¨ã€‚åœ¨ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·ä¿¡æ¯ä»<code>user:123:info</code>çš„å•ä¸€Stringæ”¹ä¸º<code>HSET user:123 name "Tom" age "25"</code>ï¼Œå†…å­˜å ç”¨å‡å°‘30%ï¼ŒæŸ¥è¯¢æ•ˆç‡ä¹Ÿæ›´é«˜ã€‚</p>
</li>
<li>
<p><strong>æ‰¹é‡æ“ä½œ</strong><br/>
Redisçš„å•æ¬¡æ“ä½œå¾ˆå¿«ï¼Œä½†ç½‘ç»œRTTï¼ˆå¾€è¿”æ—¶é—´ï¼‰å¯èƒ½æ˜¯ç“¶é¢ˆã€‚ä½¿ç”¨Pipelineæ‰¹é‡æäº¤å‘½ä»¤ï¼Œèƒ½å¤§å¹…é™ä½å»¶è¿Ÿã€‚åœ¨å®æ—¶ç›‘æ§é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†æ¯ç§’100æ¬¡<code>SET</code>æ”¹ä¸ºPipelineæ‰¹é‡æ“ä½œï¼ŒRTTä»50msé™åˆ°5msï¼Œæ€§èƒ½æå‡10å€ã€‚</p>
</li>
<li>
<p><strong>ç¼“å­˜é¢„çƒ­</strong><br/>
ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œåˆ«è®©Redisâ€œè£¸å¥”â€ã€‚æå‰åŠ è½½çƒ­ç‚¹æ•°æ®ï¼Œèƒ½é¿å…å†·å¯åŠ¨æ—¶çš„æ•°æ®åº“å‹åŠ›ã€‚åœ¨ç”µå•†æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬åœ¨æ´»åŠ¨å‰å°†Top 100å•†å“æ•°æ®é¢„çƒ­åˆ°Redisï¼Œé¦–æ³¢æµé‡ç›´æ¥å‘½ä¸­ç¼“å­˜ï¼ŒMySQLæ¯«å‘æ— æŸã€‚</p>
</li>
</ul>
<p><strong>æ€§èƒ½ä¼˜åŒ–æ•ˆæœç¤ºæ„å›¾ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">ä¼˜åŒ–å‰ï¼šé«˜RTT + å¤§Key + å†·å¯åŠ¨
  |<span class="hljs-comment">----&gt; æ•°æ®åº“å‹åŠ›æ¿€å¢</span>
ä¼˜åŒ–åï¼šPipeline + Hash + é¢„çƒ­
  |<span class="hljs-comment">----&gt; QPSæå‡ï¼Œç¨³å®šè¿è¡Œ</span>
</code></pre>
<h5 data-id="heading-21">2. è¸©å‘ç»éªŒåˆ†äº«</h5>
<p>å®æˆ˜ä¸­ï¼Œæ€§èƒ½é—®é¢˜å¾€å¾€ä¼´éšç€â€œå‘â€ã€‚ä»¥ä¸‹æ˜¯æˆ‘é‡åˆ°çš„ä¸‰å¤§å…¸å‹é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š</p>
<h6 data-id="heading-22">ç¼“å­˜ç©¿é€</h6>
<p><strong>é—®é¢˜</strong>ï¼šæŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼ˆå¦‚ç”¨æˆ·IDä¸º-1ï¼‰ï¼ŒRedisæœªå‘½ä¸­ï¼Œè¯·æ±‚ç›´è¾¾MySQLï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›æš´å¢ã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šæŸæ¬¡æ¥å£è¢«æ¶æ„è¯·æ±‚åˆ·çˆ†ï¼ŒQPSä»1ä¸‡é£™åˆ°10ä¸‡ï¼ŒMySQLå·®ç‚¹æŒ‚æ‰ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šé¢„å…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­Keyæ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥è¿”å›ã€‚</li>
<li><strong>ç¼“å­˜ç©ºå€¼</strong>ï¼šæŸ¥ä¸åˆ°æ•°æ®æ—¶ï¼Œç¼“å­˜ç©ºå¯¹è±¡ï¼ˆå¦‚<code>null</code>ï¼‰ï¼ŒTTLè®¾çŸ­äº›ï¼ˆå¦‚5åˆ†é’Ÿï¼‰ã€‚
<pre><code class="hljs language-java" lang="java">String <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user:"</span> + userId;
    <span class="hljs-type">String</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> redis.get(cacheKey);
    <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> user;
    <span class="hljs-keyword">if</span> (bloomFilter.mightContain(cacheKey)) {
        user = mysql.query(<span class="hljs-string">"SELECT * FROM users WHERE id = ?"</span>, userId);
        redis.setex(cacheKey, user == <span class="hljs-literal">null</span> ? <span class="hljs-number">300</span> : <span class="hljs-number">3600</span>, user); <span class="hljs-comment">// ç©ºå€¼TTL 5åˆ†é’Ÿ</span>
    }
    <span class="hljs-keyword">return</span> user;
}
</code></pre>
</li>
</ol>
<p><strong>ç»éªŒ</strong>ï¼šå¸ƒéš†è¿‡æ»¤å™¨é€‚åˆå¤§æ•°æ®é‡åœºæ™¯ï¼Œç©ºå€¼ç¼“å­˜æ›´ç®€å•ä½†éœ€æ§åˆ¶å†…å­˜ã€‚</p>
<h6 data-id="heading-23">ç¼“å­˜é›ªå´©</h6>
<p><strong>é—®é¢˜</strong>ï¼šå¤§é‡ç¼“å­˜KeyåŒæ—¶å¤±æ•ˆï¼Œè¯·æ±‚å…¨æ‰“åˆ°MySQLï¼Œå¯¼è‡´å®•æœºã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šä¸€æ¬¡æ´»åŠ¨ç»“æŸåï¼Œæ‰€æœ‰å•†å“ç¼“å­˜TTLç»Ÿä¸€åˆ°æœŸï¼ŒMySQLç¬é—´ç˜«ç—ªã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>TTLéšæœºåŒ–</strong>ï¼šç»™æ¯ä¸ªKeyçš„TTLåŠ éšæœºåç§»ï¼ˆå¦‚1å°æ—¶Â±10åˆ†é’Ÿï¼‰ã€‚
<pre><code class="hljs language-java" lang="java">redis.setex(cacheKey, <span class="hljs-number">3600</span> + random.nextInt(<span class="hljs-number">600</span>), data);
</code></pre>
</li>
<li><strong>çƒ­ç‚¹ç¼“å­˜éš”ç¦»</strong>ï¼šå°†é«˜é¢‘Keyå•ç‹¬å»¶é•¿TTLæˆ–æ°¸ä¸è¿‡æœŸï¼Œæ‰‹åŠ¨åˆ·æ–°ã€‚<br/>
<strong>ç»éªŒ</strong>ï¼šéšæœºåŒ–ç®€å•æœ‰æ•ˆï¼Œçƒ­ç‚¹éš”ç¦»æ›´é€‚åˆæ ¸å¿ƒæ•°æ®ã€‚</li>
</ol>
<h6 data-id="heading-24">çƒ­ç‚¹Keyé—®é¢˜</h6>
<p><strong>é—®é¢˜</strong>ï¼šå•ä¸ªKeyï¼ˆå¦‚æ´»åŠ¨é¡µæ•°æ®ï¼‰QPSè¿‡é«˜ï¼ŒRediså•èŠ‚ç‚¹å‹åŠ›çˆ†æ£šã€‚<br/>
<strong>æ¡ˆä¾‹</strong>ï¼šæŸç”µå•†æ´»åŠ¨é¡µKeyæ¯ç§’10ä¸‡æ¬¡è¯·æ±‚ï¼ŒRedisé›†ç¾¤å“åº”å˜æ…¢ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ol>
<li><strong>åˆ†ç‰‡å­˜å‚¨</strong>ï¼šå°†æ•°æ®æ‹†æˆå¤šä¸ªKeyï¼ˆå¦‚<code>activity:1:part1</code>ã€<code>part2</code>ï¼‰ï¼Œåˆ†æ•£å‹åŠ›ã€‚</li>
<li><strong>æœ¬åœ°ç¼“å­˜</strong>ï¼šå‰ç«¯æˆ–åº”ç”¨å±‚ç”¨Guava Cacheåˆ†æ‹…æµé‡ã€‚æˆ‘ä»¬åœ¨Nginxå±‚åŠ äº†æœ¬åœ°ç¼“å­˜ï¼ŒRediså‹åŠ›é™åˆ°20%ã€‚
<pre><code class="hljs language-java" lang="java">Cache&lt;String, String&gt; localCache = CacheBuilder.newBuilder()
    .expireAfterWrite(<span class="hljs-number">10</span>, TimeUnit.SECONDS).build();
String <span class="hljs-title function_">getActivityData</span><span class="hljs-params">(String key)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> localCache.getIfPresent(key);
    <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
        data = redis.get(key);
        localCache.put(key, data);
    }
    <span class="hljs-keyword">return</span> data;
}
</code></pre>
</li>
</ol>
<p><strong>ç»éªŒ</strong>ï¼šåˆ†ç‰‡é€‚åˆRediså±‚ä¼˜åŒ–ï¼Œæœ¬åœ°ç¼“å­˜æ›´çµæ´»ä½†éœ€æ³¨æ„å†…å­˜ã€‚</p>
<p><strong>è¸©å‘é—®é¢˜å¯¹æ¯”è¡¨ï¼š</strong></p>





























<table><thead><tr><th>é—®é¢˜</th><th>è¡¨ç°</th><th>è§£å†³æ–¹æ³•</th><th>å®æ–½éš¾åº¦</th></tr></thead><tbody><tr><td>ç¼“å­˜ç©¿é€</td><td>æ•°æ®åº“å‹åŠ›å¤§</td><td>å¸ƒéš†è¿‡æ»¤å™¨/ç©ºå€¼ç¼“å­˜</td><td>ä¸­</td></tr><tr><td>ç¼“å­˜é›ªå´©</td><td>æ•°æ®åº“ç¬æ—¶è¿‡è½½</td><td>TTLéšæœºåŒ–/çƒ­ç‚¹éš”ç¦»</td><td>ä½</td></tr><tr><td>çƒ­ç‚¹Key</td><td>Rediså“åº”æ…¢</td><td>åˆ†ç‰‡/æœ¬åœ°ç¼“å­˜</td><td>é«˜</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-25">å…­ã€æ€»ç»“ä¸å±•æœ›</h4>
<p>Redisä¸MySQLçš„åä½œå°±åƒä¸€åœºç²¾å½©çš„â€œåŒäººèˆâ€ï¼Œä»ç¼“å­˜ç­–ç•¥åˆ°ä¸€è‡´æ€§ä¿éšœï¼Œå†åˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œæ¯ä¸€æ­¥éƒ½è€ƒéªŒç€å¼€å‘è€…çš„æ™ºæ…§å’Œç»éªŒã€‚èµ°å®Œè¿™æ®µæ—…ç¨‹ï¼Œæˆ‘ä»¬ä¸ä»…çœ‹åˆ°äº†ä¸¤è€…çš„é»˜å¥‘é…åˆï¼Œä¹Ÿæ”¶è·äº†å®æˆ˜ä¸­çš„å®è´µæ•™è®­ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†æ€»ç»“æ ¸å¿ƒè¦ç‚¹ï¼Œåˆ†äº«å®è·µå»ºè®®ï¼Œå¹¶å±•æœ›æœªæ¥çš„æŠ€æœ¯è¶‹åŠ¿ï¼Œå¸Œæœ›ä¸ºä½ ç‚¹äº®å‰è¡Œçš„è·¯ã€‚</p>
<h5 data-id="heading-26">1. æ€»ç»“</h5>
<p>Redisä¸MySQLåŒå‰‘åˆç’§çš„æ ¸å¿ƒåœ¨äºä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>åˆç†é€‰æ‹©ç¼“å­˜ç­–ç•¥</strong>ï¼šCache-Asideé€‚åˆè¯»å¤šå†™å°‘ï¼ŒWrite-Throughä¿éšœå¼ºä¸€è‡´æ€§ï¼ŒWrite-Behindåº”å¯¹é«˜å¹¶å‘å†™ã€‚ç­–ç•¥æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œå…³é”®æ˜¯åŒ¹é…ä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li><strong>ä¿éšœæ•°æ®ä¸€è‡´æ€§</strong>ï¼šå»¶è¿ŸåŒåˆ ã€åˆ†å¸ƒå¼é”å’Œæ¶ˆæ¯é˜Ÿåˆ—å„æœ‰åƒç§‹ï¼Œé…åˆå®šæœŸéªŒè¯ï¼Œèƒ½è®©ç³»ç»Ÿæ—¢å¿«åˆç¨³ã€‚</li>
</ul>
<p>æˆ‘çš„æ ¸å¿ƒç»éªŒæ˜¯ï¼šä¸€åˆ‡ä»ä¸šåŠ¡å‡ºå‘ã€‚é«˜å¹¶å‘ç”µå•†éœ€è¦æ€§èƒ½ä¼˜å…ˆï¼Œé‡‘èç³»ç»Ÿå¼ºè°ƒä¸€è‡´æ€§ï¼Œæ—¥å¿—æœåŠ¡è¿½æ±‚ååé‡ã€‚æŠ€æœ¯æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ï¼Œè„±ç¦»éœ€æ±‚çš„ä¼˜åŒ–éƒ½æ˜¯â€œç©ºä¸­æ¥¼é˜â€ã€‚æ¯”å¦‚åœ¨ç”µå•†é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Cache-AsideåŠ å»¶è¿ŸåŒåˆ ï¼ŒQPSæå‡10å€çš„åŒæ—¶ä¿è¯äº†åº“å­˜å‡†ç¡®ï¼›åœ¨å®æ—¶ç›‘æ§ä¸­ï¼ŒWrite-Throughè®©æ•°æ®é›¶å»¶è¿Ÿï¼Œæ»¡è¶³äº†å®¢æˆ·éœ€æ±‚ã€‚è¿™äº›æˆåŠŸéƒ½æºäºå¯¹ä¸šåŠ¡çš„æ·±åˆ»ç†è§£ã€‚</p>
<p><strong>å®è·µå»ºè®®</strong>ï¼š</p>
<ol>
<li><strong>ä»å°å¤„ç€æ‰‹</strong>ï¼šå…ˆç”¨Cache-Asideè¯•æ°´ï¼Œç®€å•æ˜“ä¸Šæ‰‹ï¼Œå†æ ¹æ®éœ€æ±‚è°ƒæ•´ã€‚</li>
<li><strong>å…³æ³¨å¼‚å¸¸</strong>ï¼šä¸ºæ¯ç§ç­–ç•¥è®¾è®¡å…œåº•æ–¹æ¡ˆï¼ˆå¦‚é‡è¯•ã€æ—¥å¿—è¡¥å¿ï¼‰ã€‚</li>
<li><strong>ç›‘æ§å…ˆè¡Œ</strong>ï¼šéƒ¨ç½²Rediså’ŒMySQLçš„ç›‘æ§ï¼Œå®æ—¶æŒæ¡å‘½ä¸­ç‡ã€å»¶è¿Ÿå’Œä¸€è‡´æ€§é—®é¢˜ã€‚</li>
<li><strong>è¿­ä»£ä¼˜åŒ–</strong>ï¼šæ€§èƒ½å’Œä¸€è‡´æ€§æ˜¯ä¸ªåŠ¨æ€å¹³è¡¡ï¼Œå®šæœŸå¤ç›˜è°ƒæ•´ã€‚</li>
</ol>
<h5 data-id="heading-27">2. å±•æœ›</h5>
<p>Redisä¸MySQLçš„åä½œä»åœ¨è¿›åŒ–ã€‚Redis 7.0å¢å¼ºäº†é›†ç¾¤åŠŸèƒ½ï¼Œæ”¯æŒå¤šçº¿ç¨‹I/Oå’Œæ›´çµæ´»çš„æ•°æ®ç»“æ„ï¼Œæœªæ¥å¯èƒ½åœ¨ä¸€è‡´æ€§åœºæ™¯ä¸­æ‰®æ¼”æ›´é‡è¦è§’è‰²ã€‚MySQL 8.0åˆ™ä¼˜åŒ–äº†JSONæ”¯æŒå’Œé«˜å¯ç”¨æ€§ï¼Œä¸Redisçš„é…åˆå°†æ›´ç´§å¯†ã€‚æ¯”å¦‚ï¼ŒRedisçš„Streamæ•°æ®ç»“æ„å¯ä»¥ä¸MySQLçš„binlogé›†æˆï¼Œå®ç°æ›´é«˜æ•ˆçš„å¼‚æ­¥åŒæ­¥ã€‚</p>
<p>æœªæ¥è¶‹åŠ¿å¯èƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½åŒ–ç¼“å­˜</strong>ï¼šAIé©±åŠ¨çš„ç¼“å­˜é¢„çƒ­å’Œæ·˜æ±°ç­–ç•¥ï¼Œè®©Redisæ›´â€œèªæ˜â€ã€‚</li>
<li><strong>äº‘åŸç”Ÿèåˆ</strong>ï¼šServerlessæ¶æ„ä¸‹ï¼ŒRediså’ŒMySQLå¯èƒ½ä»¥æ‰˜ç®¡æœåŠ¡å½¢å¼æ— ç¼é›†æˆã€‚</li>
<li><strong>ä¸€è‡´æ€§æ–°è§£æ³•</strong>ï¼šåˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚TiDB+Redisçš„ç»“åˆï¼‰æˆ–å°†ç®€åŒ–å¼ºä¸€è‡´æ€§å®ç°ã€‚</li>
</ul>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘é¼“åŠ±ä½ å¤šå®è·µã€å¤šåˆ†äº«ã€‚Redisä¸MySQLçš„ç»„åˆçœ‹ä¼¼ç®€å•ï¼Œå®åˆ™è•´è—æ— é™å¯èƒ½ã€‚æ¯æ¬¡è¸©å‘å’Œä¼˜åŒ–ï¼Œéƒ½æ˜¯æˆé•¿çš„å¥‘æœºã€‚æˆ‘çš„10å¹´ç»éªŒå‘Šè¯‰æˆ‘ï¼ŒæŠ€æœ¯æ²¡æœ‰ç»ˆç‚¹ï¼Œåªæœ‰ä¸æ–­æ¢ç´¢çš„ä¹è¶£ã€‚</p>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼š<br/>
æˆ‘æœ€å–œæ¬¢Redisçš„è½»å¿«å’ŒMySQLçš„ç¨³é‡ï¼Œå®ƒä»¬å°±åƒæˆ‘çš„å·¦å³æ‰‹ï¼Œç¼ºä¸€ä¸å¯ã€‚æ¯æ¬¡è§£å†³ä¸€ä¸ªä¸€è‡´æ€§éš¾é¢˜æˆ–ä¼˜åŒ–ä¸€æ¬¡æ€§èƒ½ç“¶é¢ˆï¼Œéƒ½è®©æˆ‘å¯¹è¿™å¯¹â€œé»„é‡‘æ­æ¡£â€æ›´æœ‰ä¿¡å¿ƒã€‚å¸Œæœ›ä½ ä¹Ÿèƒ½åœ¨å®è·µä¸­æ‰¾åˆ°å±äºè‡ªå·±çš„èŠ‚å¥ã€‚</p>
<hr/>
<p><strong>æ–‡ç« å°¾å£°ï¼š</strong><br/>
è‡³æ­¤ï¼Œæˆ‘ä»¬ä»Redisä¸MySQLçš„ä¼˜åŠ¿è®²åˆ°ç¼“å­˜ç­–ç•¥ï¼Œå†åˆ°ä¸€è‡´æ€§å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œèµ°äº†ä¸€æ¡å®Œæ•´çš„å®æˆ˜ä¹‹è·¯ã€‚å¸¦ç€è¿™äº›ç»éªŒå’Œå»ºè®®ï¼Œå»è¯•è¯•å§ï¼æœ‰ä»€ä¹ˆå¿ƒå¾—æˆ–é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶äº¤æµï¼Œæ¯•ç«ŸæŠ€æœ¯çš„é­…åŠ›å°±åœ¨äºåˆ†äº«ä¸æˆé•¿ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7585397173022736403</link>    <guid>https://juejin.cn/post/7585397173022736403</guid>    <pubDate>2025-12-19T23:46:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585397173022736403" data-draft-id="7585382553289916452" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-12-19T23:46:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T23:46:30.000Z" title="Fri Dec 19 2025 23:46:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–</h2>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented Programming, OOPï¼‰ä¸åªæ˜¯â€œå¦‚ä½•å†™ classâ€çš„è¯­æ³•è§„åˆ™ã€‚å®ƒæ›´åƒä¸€ç§ç»„ç»‡è½¯ä»¶ç³»ç»Ÿçš„æ€ç»´æ–¹å¼ï¼šé€šè¿‡æ¸…æ™°çš„è¾¹ç•Œã€èŒè´£æ‹†åˆ†ä¸å¯¹è±¡åä½œï¼Œè®©ç³»ç»Ÿæ›´å®¹æ˜“ç†è§£ã€æ‰©å±•å’Œç»´æŠ¤ã€‚</p>
<p>å½“ä½ å·²ç»æŒæ¡äº†ç±»ã€å¯¹è±¡ã€å±æ€§ã€æ–¹æ³•è¿™äº›åŸºç¡€æ¦‚å¿µä¹‹åï¼Œå°±å¯ä»¥æŠŠè§†è§’å¾€æ›´æ·±ä¸€å±‚æŒªä¸€æŒªï¼šè®¾è®¡æ¨¡å¼ã€SOLID åŸåˆ™ï¼Œä»¥åŠåœ¨å¤§å‹ç³»ç»Ÿé‡Œç»•ä¸å¼€çš„æ€§èƒ½ä¸å†…å­˜é—®é¢˜ã€‚</p>
<p>æœ¬æ–‡ä¼šå›´ç»•å‡ ä¸ªå¸¸è§ä¸»é¢˜å±•å¼€ï¼šç­–ç•¥æ¨¡å¼ä¸å•ä¾‹æ¨¡å¼ã€SOLID äº”åŸåˆ™ï¼Œä»¥åŠä¸å¯å˜å¯¹è±¡ä¸å†…å­˜ç®¡ç†ç›¸å…³çš„æ€§èƒ½è€ƒè™‘ã€‚å®ƒä»¬çš„ç›®çš„ä¸æ˜¯â€œç‚«æŠ€â€ï¼Œè€Œæ˜¯è®©çœŸå®é¡¹ç›®åœ¨åç»­è¿­ä»£ä¸­æ›´ç¨³ã€æ›´å¥½æ”¹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2025-12%2Fadvanced-object-oriented-programming-design-patterns-solid-performance" target="_blank" title="https://catchadmin.com/post/2025-12/advanced-object-oriented-programming-design-patterns-solid-performance" ref="nofollow noopener noreferrer">åŸæ–‡é“¾æ¥ PHP ä¹‹é«˜çº§é¢å‘å¯¹è±¡ç¼–ç¨‹ æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ã€åŸåˆ™ä¸æ€§èƒ½ä¼˜åŒ–</a></p>
<h3 data-id="heading-1">é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„è®¾è®¡æ¨¡å¼</h3>
<p>è®¾è®¡æ¨¡å¼æ˜¯å¯¹è½¯ä»¶è®¾è®¡ä¸­å¸¸è§é—®é¢˜çš„å¯å¤ç”¨è§£å†³æ–¹æ¡ˆã€‚å®ƒä»¬ä¸æ˜¯ä»£ç æ¨¡æ¿ï¼Œè€Œæ˜¯å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹è°ƒæ•´å’Œè½åœ°çš„ä¸€ç»„è®¾è®¡æ€è·¯ã€‚</p>
<h4 data-id="heading-2">ç­–ç•¥æ¨¡å¼ï¼šå°†ç®—æ³•ä¸ç±»è§£è€¦</h4>
<p>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰å¯ä»¥æŠŠä¸€ç»„å¯äº’æ¢çš„ç®—æ³•æŠ½å‡ºæ¥ï¼Œç”¨ç»Ÿä¸€çš„æ¥å£å¯¹å¤–æš´éœ²ï¼Œè®©ä½¿ç”¨æ–¹åœ¨è¿è¡Œæ—¶è‡ªç”±é€‰æ‹©å®ç°ï¼Œè€Œä¸éœ€è¦æŠŠå…·ä½“ç®—æ³•ç¡¬ç¼–ç è¿›ä¸šåŠ¡ç±»ã€‚</p>
<p>å½“ä½ å¸Œæœ›â€œæ ¹æ®æ¡ä»¶åˆ‡æ¢ç®—æ³•â€ï¼Œåˆä¸å¸Œæœ›è®©ä¸€ä¸ªç±»è†¨èƒ€åˆ°å¡æ»¡ <code>if/else</code> æ—¶ï¼Œç­–ç•¥æ¨¡å¼é€šå¸¸å¾ˆå¥½ç”¨ã€‚</p>
<p>ä»¥ç”µå•†æŠ˜æ‰£ä¸ºä¾‹ï¼šå¯èƒ½æœ‰â€œæ‰“æŠ˜â€â€œä¹°ä¸€é€ä¸€â€ç­‰ä¸åŒæŠ˜æ‰£ç­–ç•¥ã€‚å¦‚æœæŠŠæ‰€æœ‰æŠ˜æ‰£è§„åˆ™éƒ½å †åœ¨ <code>Cart</code> é‡Œï¼Œ<code>Cart</code> ä¼šè¶Šæ¥è¶Šéš¾ç»´æŠ¤ã€‚ç”¨ç­–ç•¥æ¨¡å¼åˆ™å¯ä»¥æŠŠæŠ˜æ‰£è®¡ç®—æ‹†åˆ°ä¸åŒç­–ç•¥ç±»é‡Œã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PercentDiscount</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$percent</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$total</span> * (<span class="hljs-number">1</span> - <span class="hljs-variable language_">$this</span>-&gt;percent);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BuyOneGetOneFree</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">DiscountStrategy</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$total</span></span>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-comment">// ç®€å•æ¨¡æ‹Ÿï¼šä¹°ä¸€é€ä¸€å³æ€»ä»·å‡åŠ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$total</span> / <span class="hljs-number">2</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cart</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$items</span> = [];

    <span class="hljs-comment">// ä¾èµ–æ³¨å…¥ï¼šæ³¨å…¥ç­–ç•¥æ¥å£è€Œéå…·ä½“å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> DiscountStrategy <span class="hljs-variable">$strategy</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addItem</span>(<span class="hljs-params"><span class="hljs-keyword">float</span> <span class="hljs-variable">$price</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;items[] = <span class="hljs-variable">$price</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">total</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-variable">$subtotal</span> = <span class="hljs-title function_ invoke__">array_sum</span>(<span class="hljs-variable">$this</span>-&gt;items);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;strategy-&gt;<span class="hljs-title function_ invoke__">apply</span>(<span class="hljs-variable">$subtotal</span>);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable">$cart</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cart</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PercentDiscount</span>(<span class="hljs-number">0.1</span>)); <span class="hljs-comment">// æ‰“ä¹æŠ˜</span>
<span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">addItem</span>(<span class="hljs-number">100</span>);
<span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">addItem</span>(<span class="hljs-number">200</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$cart</span>-&gt;<span class="hljs-title function_ invoke__">total</span>(); <span class="hljs-comment">// è¾“å‡º: 270</span>
</code></pre>
<p>è¿™é‡Œ <code>Cart</code> ä¸éœ€è¦çŸ¥é“â€œæŠ˜æ‰£æ€ä¹ˆç®—â€ï¼Œå®ƒåªä¾èµ–ä¸€ä¸ªæŠ½è±¡çš„ <code>DiscountStrategy</code>ã€‚æƒ³æ›´æ¢æŠ˜æ‰£è§„åˆ™ï¼Œåªè¦ä¼ å…¥ä¸åŒçš„ç­–ç•¥å®ç°å³å¯ï¼Œæ— éœ€ä¿®æ”¹ <code>Cart</code>ã€‚</p>
<h4 data-id="heading-3">å•ä¾‹æ¨¡å¼ï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹</h4>
<p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ç”¨äºä¿è¯æŸä¸ªç±»åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚</p>
<p>å®ƒå¸¸ç”¨äºç®¡ç†å…±äº«èµ„æºï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ã€é…ç½®å¯¹è±¡ç­‰ï¼šè¿™ç±»å¯¹è±¡é€šå¸¸ä¸å¸Œæœ›è¢«é¢‘ç¹åˆ›å»ºï¼Œä¹Ÿä¸å¸Œæœ›å‡ºç°å¤šä¸ªå®ä¾‹å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseConnection</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> ?DatabaseConnection <span class="hljs-variable">$instance</span> = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// ç§æœ‰åŒ–æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨ new</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"/>) </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"è¿æ¥åˆ°æ•°æ®åº“...\n"</span>;
    }

    <span class="hljs-comment">// é˜²æ­¢å…‹éš†</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"/>) </span>{}

    <span class="hljs-comment">// é˜²æ­¢ååºåˆ—åŒ–</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"/>) </span>{
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">\Exception</span>(<span class="hljs-string">"Cannot unserialize singleton"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInstance</span>(<span class="hljs-params"/>): <span class="hljs-title">DatabaseConnection</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span> === <span class="hljs-literal">null</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">self</span>::<span class="hljs-variable">$instance</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable">$db1</span> = <span class="hljs-title class_">DatabaseConnection</span>::<span class="hljs-title function_ invoke__">getInstance</span>();
<span class="hljs-variable">$db2</span> = <span class="hljs-title class_">DatabaseConnection</span>::<span class="hljs-title function_ invoke__">getInstance</span>();

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$db1</span> === <span class="hljs-variable">$db2</span>); <span class="hljs-comment">// è¾“å‡º: bool(true)</span>
</code></pre>
<p>ä¸Šé¢ <code>DatabaseConnection</code> é€šè¿‡é‡å†™ <code>__new__</code> æ¥ç¡®ä¿æ— è®ºå®ä¾‹åŒ–å¤šå°‘æ¬¡ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>
<h3 data-id="heading-4">SOLID åŸåˆ™</h3>
<p>SOLID æ˜¯ä¸€ç»„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼Œç›®æ ‡æ˜¯è®©ç³»ç»Ÿæ›´æ˜“ç»´æŠ¤ã€å¯æ‰©å±•ã€å¯æµ‹è¯•ã€‚æŠŠè¿™äº›åŸåˆ™è½åˆ°æ—¥å¸¸ç¼–ç é‡Œï¼Œèƒ½å‡å°‘å¾ˆå¤šå¸¸è§çš„â€œé¢å‘å¯¹è±¡å†™ç€å†™ç€å°±å˜æˆä¸€å›¢â€çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-5">å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</h4>
<p>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰å¼ºè°ƒï¼šä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªç±»æœ€å¥½åªè´Ÿè´£ä¸€ä»¶äº‹ã€‚</p>
<p>ä¾‹å¦‚ <code>User</code> æ—¢ä¿å­˜ç”¨æˆ·æ•°æ®åˆè´Ÿè´£å‘é€é€šçŸ¥ï¼Œä¼šåŒæ—¶æ‰¿æ‹…â€œæ•°æ®æ¨¡å‹â€å’Œâ€œé€šçŸ¥é€»è¾‘â€ä¸¤ç§èŒè´£ã€‚å¯ä»¥æŒ‰ SRP æ‹†åˆ†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span></span>) </span>{}
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserNotification</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendWelcomeEmail</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"æ­£åœ¨å‘ <span class="hljs-subst">{$user-&gt;name}</span> å‘é€æ¬¢è¿é‚®ä»¶ã€‚\n"</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);
<span class="hljs-variable">$notifier</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserNotification</span>();
<span class="hljs-variable">$notifier</span>-&gt;<span class="hljs-title function_ invoke__">sendWelcomeEmail</span>(<span class="hljs-variable">$user</span>);
</code></pre>
<p>æ‹†åˆ†ä¹‹åï¼Œæ¯ä¸ªç±»çš„èŒè´£æ›´é›†ä¸­ï¼Œæµ‹è¯•ä¸ä¿®æ”¹ä¹Ÿæ›´å¯æ§ã€‚</p>
<h4 data-id="heading-6">å¼€æ”¾/å°é—­åŸåˆ™ï¼ˆOCPï¼‰</h4>
<p>å¼€æ”¾/å°é—­åŸåˆ™ï¼ˆOpen/Closed Principleï¼‰è¦æ±‚ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚ä¹Ÿå°±æ˜¯åœ¨ä¸æ”¹åŠ¨æ—¢æœ‰ä»£ç çš„å‰æä¸‹ï¼Œèƒ½å¤Ÿé€šè¿‡æ‰©å±•æ¥å¼•å…¥æ–°è¡Œä¸ºã€‚</p>
<p>ä¸‹é¢ç”¨å½¢çŠ¶é¢ç§¯ç¤ºä¾‹è¯´æ˜ï¼š<code>Shape</code> å®šä¹‰æ¥å£ï¼Œä¸åŒå½¢çŠ¶é€šè¿‡ç»§æ‰¿å®ç° <code>area()</code>ï¼Œè°ƒç”¨æ–¹ä¸éœ€è¦çŸ¥é“å…·ä½“ç±»å‹ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$radius</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">pi</span>() * <span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-variable">$this</span>-&gt;radius, <span class="hljs-number">2</span>);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Shape</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$width</span>, <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-variable">$height</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">area</span>(<span class="hljs-params"/>): <span class="hljs-title">float</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;width * <span class="hljs-variable language_">$this</span>-&gt;height;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printArea</span>(<span class="hljs-params">Shape <span class="hljs-variable">$shape</span></span>) </span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"é¢ç§¯: "</span> . <span class="hljs-variable">$shape</span>-&gt;<span class="hljs-title function_ invoke__">area</span>() . <span class="hljs-string">"\n"</span>;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_ invoke__">printArea</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5</span>));
<span class="hljs-title function_ invoke__">printArea</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>));
</code></pre>
<p>å½“ä½ è¦æ–°å¢ä¸€ç§å½¢çŠ¶æ—¶ï¼Œåªéœ€è¦æ·»åŠ æ–°å­ç±»å³å¯ï¼Œä¸å¿…æ”¹åŠ¨ <code>print_area</code> æˆ–æ—¢æœ‰å½¢çŠ¶ä»£ç ã€‚</p>
<h4 data-id="heading-7">é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼‰</h4>
<p>é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰æŒ‡å‡ºï¼šåŸºç±»èƒ½å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¹Ÿåº”è¯¥èƒ½æ›¿æ¢è¿›å»ï¼Œå¹¶ä¸”ä¸å½±å“ç¨‹åºæ­£ç¡®æ€§ã€‚å®ƒè¦æ±‚å­ç±»æ˜¯å¯¹çˆ¶ç±»èƒ½åŠ›çš„â€œçœŸå®æ‰©å±•â€ï¼Œè€Œä¸æ˜¯â€œè¡¨é¢ç»§æ‰¿â€ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>Penguin</code> ç»§æ‰¿ <code>Bird</code> ä½†æ— æ³•é£è¡Œï¼Œå¯¼è‡´æ›¿æ¢å¤±è´¥ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bird</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fly</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"æ­£åœ¨é£è¡Œ...\n"</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Penguin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Bird</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fly</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-comment">// ä¼é¹…ä¸ä¼šé£ï¼Œè¿åäº†çˆ¶ç±» Bird çš„è¡Œä¸ºé¢„æœŸ</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"ä¼é¹…ä¸ä¼šé£ï¼"</span>);
    }
}

<span class="hljs-comment">/** * ä¿®æ­£æ–¹æ¡ˆï¼šæ‹†åˆ†æ¥å£
 * interface Bird {}
 * interface FlyingBird extends Bird { public function fly(); }
 * class Penguin implements Bird { ... }
 */</span>
</code></pre>
<p>è¿™ä¸ªè®¾è®¡è¿åäº† LSPï¼š<code>Penguin</code> æ— æ³•åœ¨éœ€è¦ <code>Bird.fly()</code> çš„ä¸Šä¸‹æ–‡ä¸­æ­£å¸¸å·¥ä½œã€‚è¦è§£å†³å®ƒï¼Œé€šå¸¸éœ€è¦é‡æ–°å®¡è§†æŠ½è±¡ï¼ˆä¾‹å¦‚æŠŠâ€œä¼šé£â€èƒ½åŠ›ä» <code>Bird</code> ä¸­æ‹†å‡ºæ¥ï¼Œæˆ–è€…è°ƒæ•´ç»§æ‰¿å±‚æ¬¡ï¼‰ã€‚</p>
<h4 data-id="heading-8">æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰</h4>
<p>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰å¼ºè°ƒï¼šå®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–è‡ªå·±ç”¨ä¸åˆ°çš„æ–¹æ³•ã€‚ä¸å…¶åšä¸€ä¸ªâ€œå¾ˆå¤§å¾ˆå…¨â€çš„æ¥å£ï¼Œä¸å¦‚æ‹†æˆå¤šä¸ªå°è€Œèšç„¦çš„æ¥å£ï¼Œè®©ä½¿ç”¨æ–¹æŒ‰éœ€ç»„åˆã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Workable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Eatable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eat</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HumanWorker</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Workable</span>, <span class="hljs-title">Eatable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"äººç±»åœ¨å·¥ä½œ\n"</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">eat</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"äººç±»åœ¨åƒé¥­\n"</span>; }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RobotWorker</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Workable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">work</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"æœºå™¨äººåœ¨å·¥ä½œ\n"</span>; }
    <span class="hljs-comment">// æœºå™¨äººä¸éœ€è¦å®ç° eat() æ¥å£</span>
}
</code></pre>
<p>è¿™é‡Œ <code>Worker</code> ä¸ <code>Eater</code> æ‹†æˆä¸¤ä¸ªæ¥å£ï¼Œé¿å…äº†è®©æ‰€æœ‰å®ç°è€…éƒ½èƒŒä¸Šä¸éœ€è¦çš„èŒè´£ã€‚</p>
<h4 data-id="heading-9">ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰</h4>
<p>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ä¸»å¼ ï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ï¼ˆæ¥å£/æŠ½è±¡ç±»ï¼‰ã€‚è¿™æ ·å¯ä»¥é™ä½è€¦åˆï¼Œè®©æ›¿æ¢å®ç°æ›´å®¹æ˜“ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Switchable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOn</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOff</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LightBulb</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Switchable</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOn</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"ç¯äº®äº†\n"</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnOff</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{ <span class="hljs-keyword">echo</span> <span class="hljs-string">"ç¯ç­äº†\n"</span>; }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Switcher</span> </span>{
    <span class="hljs-comment">// ä¾èµ–äºæ¥å£ï¼Œè€Œä¸æ˜¯å…·ä½“çš„ LightBulb ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> Switchable <span class="hljs-variable">$device</span></span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">operate</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span> </span>{
        <span class="hljs-variable language_">$this</span>-&gt;device-&gt;<span class="hljs-title function_ invoke__">turnOn</span>();
    }
}

<span class="hljs-variable">$bulb</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LightBulb</span>();
<span class="hljs-variable">$switch</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Switcher</span>(<span class="hljs-variable">$bulb</span>);
<span class="hljs-variable">$switch</span>-&gt;<span class="hljs-title function_ invoke__">operate</span>();
</code></pre>
<p>è¿™é‡Œ <code>Switch</code> ç›´æ¥ä¾èµ– <code>LightBulb</code>ã€‚å¦‚æœæŠŠä¾èµ–æ”¹ä¸ºæŠ½è±¡æ¥å£ï¼ˆæ¯”å¦‚ <code>Switchable</code>ï¼‰ï¼Œ<code>Switch</code> å°±èƒ½æ”¯æŒæ›´å¤šè®¾å¤‡å®ç°ï¼Œè€Œä¸éœ€è¦æ”¹åŠ¨è‡ªèº«ä»£ç ã€‚</p>
<h3 data-id="heading-10">é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æ€§èƒ½ä¼˜åŒ–ä¸å†…å­˜è€ƒé‡</h3>
<p>OOP é€šå¸¸æ›´å¼ºè°ƒæ¸…æ™°ä¸å¯ç»´æŠ¤ï¼Œä½†åœ¨å¤§å‹ç³»ç»Ÿé‡Œï¼Œæ€§èƒ½ä¸å†…å­˜å¼€é”€åŒæ ·éœ€è¦è¢«è€ƒè™‘ã€‚ç†è§£å¯¹è±¡åˆ›å»ºã€å†…å­˜åˆ†é…ä»¥åŠä¸å¯å˜æ€§å¸¦æ¥çš„å½±å“ï¼Œæœ‰åŠ©äºåœ¨â€œå¯è¯»æ€§â€å’Œâ€œæ•ˆç‡â€ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ã€‚</p>
<h4 data-id="heading-11">ä¸ºå€¼å¯¹è±¡å¼•å…¥ä¸å¯å˜æ€§</h4>
<p>PHP 8.2 å¼•å…¥äº† readonly classï¼Œè¿™éå¸¸é€‚åˆå®ç°ä¸å¯å˜çš„å€¼å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡åœ¨å¤„ç†å€¼ç±»å‹ï¼ˆValue Objectï¼‰æ—¶å¾ˆå¸¸è§ï¼Œä¾‹å¦‚ <code>Money</code>ã€<code>DateRange</code>ã€<code>Coordinate</code>ã€‚æŠŠå¯¹è±¡è®¾è®¡æˆä¸å¯å˜ï¼Œå¯ä»¥å‡å°‘å…±äº«çŠ¶æ€å¸¦æ¥çš„å‰¯ä½œç”¨ï¼Œä¹Ÿæ›´åˆ©äºæ¨ç†ä¸å¹¶å‘åœºæ™¯ä¸‹çš„å®‰å…¨æ€§ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Money</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$currency</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$amount</span>
    </span>) </span>{}

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">Money <span class="hljs-variable">$other</span></span>): <span class="hljs-title">Money</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;currency !== <span class="hljs-variable">$other</span>-&gt;currency) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"å¸ç§ä¸åŒ¹é…"</span>);
        }
        <span class="hljs-comment">// è¿”å›æ–°å®ä¾‹ï¼Œè€Œä¸æ˜¯ä¿®æ”¹å½“å‰å¯¹è±¡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-variable language_">$this</span>-&gt;currency, <span class="hljs-variable language_">$this</span>-&gt;amount + <span class="hljs-variable">$other</span>-&gt;amount);
    }
}

<span class="hljs-variable">$m1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-string">"CNY"</span>, <span class="hljs-number">100</span>);
<span class="hljs-variable">$m2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(<span class="hljs-string">"CNY"</span>, <span class="hljs-number">50</span>);
<span class="hljs-variable">$result</span> = <span class="hljs-variable">$m1</span>-&gt;<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-variable">$m2</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>-&gt;amount; <span class="hljs-comment">// 150</span>
<span class="hljs-comment">// $m1-&gt;amount = 200; // ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ˜¯ readonly</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>Money</code> æ˜¯ä¸å¯å˜çš„ï¼šæ¯æ¬¡è¿ç®—éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°å®ä¾‹ï¼ŒåŸå¯¹è±¡ä¿æŒä¸å˜ã€‚</p>
<h4 data-id="heading-12">é¿å…å¯¹è±¡æŠ–åŠ¨ï¼ˆObject Churnï¼‰</h4>
<p>åœ¨ç´§å¯†å¾ªç¯é‡Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œä¼šå¸¦æ¥æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜ï¼šæ›´å¤šçš„å†…å­˜åˆ†é…ã€æ›´é«˜çš„åƒåœ¾å›æ”¶ï¼ˆGCï¼‰å‹åŠ›ã€‚</p>
<p>é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘å¯¹è±¡æ± ï¼ˆobject poolï¼‰æˆ–å¤ç”¨å¯¹è±¡ï¼Œå‡å°‘ä¸å¿…è¦çš„åˆ›å»ºä¸å›æ”¶å¼€é”€ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“ï¼šæŠŠåŸåˆ™ä¸æ¨¡å¼è½åˆ°ä»£ç é‡Œ</h3>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹æä¾›äº†ä¸€å¥—ç»„ç»‡å¤æ‚ç³»ç»Ÿçš„å·¥å…·ã€‚è®¾è®¡æ¨¡å¼ï¼ˆä¾‹å¦‚ Strategyã€Singletonï¼‰å¸®åŠ©ä½ å¤ç”¨æˆç†Ÿçš„ç»“æ„ï¼›SOLID åŸåˆ™æé†’ä½ å¦‚ä½•åˆ’åˆ†èŒè´£ã€æ§åˆ¶ä¾èµ–ï¼›è€Œä¸å¯å˜å¯¹è±¡ã€å¯¹è±¡åˆ›å»ºæˆæœ¬ç­‰æ€§èƒ½è§†è§’åˆ™è®©ç³»ç»Ÿåœ¨è§„æ¨¡åŒ–åœºæ™¯ä¸‹æ›´ç¨³ã€‚</p>
<p>OOP çš„é‡ç‚¹ä¸åœ¨â€œæœ‰å¤šå°‘ç±»â€ï¼Œè€Œåœ¨æŠ½è±¡æ˜¯å¦æ¸…æ™°ã€è¾¹ç•Œæ˜¯å¦æ˜ç¡®ã€å®ç°æ˜¯å¦å¯æ›¿æ¢ã€å˜åŒ–æ˜¯å¦è¢«é™åˆ¶åœ¨å¯æ§çš„èŒƒå›´å†…ã€‚æŠŠè¿™äº›è¦ç‚¹åšæŒä¸‹æ¥ï¼Œä»£ç é€šå¸¸ä¼šæ›´å¥½è¯»ï¼Œä¹Ÿæ›´å¥½ç»´æŠ¤ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7585706951604355098</link>    <guid>https://juejin.cn/post/7585706951604355098</guid>    <pubDate>2025-12-21T09:16:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585706951604355098" data-draft-id="7585743487258378249" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-21T09:16:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰¾é†’"/> <meta itemprop="url" content="https://juejin.cn/user/708512558088669"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹åŸç†å‰–æâ€”â€”æ‹†è§£é¢„è®­ç»ƒã€å¾®è°ƒã€å¥–åŠ±å»ºæ¨¡ä¸å¼ºåŒ–å­¦ä¹ å››é˜¶æ®µï¼ˆä»¥ChatGPTæ„å»ºæµç¨‹ä¸ºä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/708512558088669/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰¾é†’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:16:50.000Z" title="Sun Dec 21 2025 09:16:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ChatGPTï¼‰çš„â€œæ™ºèƒ½â€å¹¶éä¸€è¹´è€Œå°±ï¼Œè€Œæ˜¯é€šè¿‡åˆ†é˜¶æ®µçš„ç²¾ç»†åŒ–è®­ç»ƒé€æ­¥å®ç°çš„ã€‚æœ¬æ–‡åŸºäºè¯¾ç¨‹å†…å®¹ï¼Œæ‹†è§£ChatGPTçš„å››é˜¶æ®µæ„å»ºæµç¨‹ï¼Œè§£ææ¯ä¸ªç¯èŠ‚çš„æ ¸å¿ƒé€»è¾‘ä¸æŠ€æœ¯ç»†èŠ‚ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41444af6d95f4f2fbe829b203ee1cc06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Im-6YaS:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766913410&amp;x-signature=rZn%2B0TUmRXfzfopgGz0enDYPDWo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">ä¸€ã€é˜¶æ®µä¸€ï¼šè‡ªç›‘ç£é¢„è®­ç»ƒâ€”â€”ç»™æ¨¡å‹â€œæ‰“çŸ¥è¯†åº•å­â€</h2>
<p>è¿™æ˜¯å¤§æ¨¡å‹çš„<strong>åŸºç¡€èƒ½åŠ›å¥ åŸºé˜¶æ®µ</strong>ï¼Œæ ¸å¿ƒæ˜¯è®©æ¨¡å‹å­¦ä¹ è¯­è¨€è§„å¾‹ä¸ä¸–ç•ŒçŸ¥è¯†ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šåˆ©ç”¨æ–‡æœ¬çš„å‰kä¸ªè¯ï¼ˆtokenï¼‰ï¼Œé¢„æµ‹ç¬¬k+1ä¸ªè¯ï¼Œå®ç°â€œè‡ªç›‘ç£å­¦ä¹ â€ï¼ˆæ— éœ€äººå·¥æ ‡æ³¨æ ‡ç­¾ï¼‰ã€‚</li>
<li><strong>è®­ç»ƒæ•°æ®</strong>ï¼šè¦†ç›–äº’è”ç½‘ç½‘é¡µã€ç»´åŸºç™¾ç§‘ã€ä¹¦ç±ã€GitHubä»£ç ã€è®ºæ–‡ç­‰å¤šæºè¯­æ–™ï¼Œæ€»é‡è¾¾æ•°åƒäº¿è‡³æ•°ä¸‡äº¿å•è¯ï¼Œç¡®ä¿å†…å®¹çš„å¤šæ ·æ€§ä¸çŸ¥è¯†è¦†ç›–åº¦ã€‚</li>
<li><strong>è®­ç»ƒç›®æ ‡</strong>ï¼šæœ€å¤§åŒ–é¢„æµ‹æ¦‚ç‡ï¼Œæ•°å­¦è¡¨è¾¾ä¸ºï¼š
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Max</mtext><msub><mo>âˆ‘</mo><mi>i</mi></msub><mi>log</mi><mo>â¡</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>u</mi><mrow><mi>i</mi><mo>âˆ’</mo><mi>k</mi></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">;</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Max} \sum_{i} \log P(u_i|u_{i-k}, ..., u_{i-1}; \theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.2997em;"/><span class="mord text"><span class="mord">Max</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span></span>
ï¼ˆå…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">u_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯è¯­æ–™ä¸­çš„è¯ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span>æ˜¯æ¨¡å‹å‚æ•°ï¼‰</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œåŸºç¡€æ¨¡å‹â€ï¼Œéœ€<strong>1000+GPU/æœˆ</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-2">äºŒã€é˜¶æ®µäºŒï¼šæœ‰ç›‘ç£å¾®è°ƒï¼ˆæŒ‡ä»¤å¾®è°ƒï¼‰â€”â€”è®©æ¨¡å‹â€œå¬æ‡‚äººç±»æŒ‡ä»¤â€</h2>
<p>é¢„è®­ç»ƒæ¨¡å‹èƒ½â€œç»­å†™æ–‡æœ¬â€ï¼Œä½†è¿˜ä¸æ‡‚â€œæŒ‡ä»¤â€ï¼›è¿™ä¸€é˜¶æ®µçš„ç›®æ ‡æ˜¯è®©æ¨¡å‹ç†è§£äººç±»éœ€æ±‚ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šåœ¨é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œç”¨ <strong>â€œç”¨æˆ·æŒ‡ä»¤+ç†æƒ³è¾“å‡ºâ€çš„æ ‡æ³¨æ•°æ®</strong> ç»§ç»­è®­ç»ƒã€‚</li>
<li><strong>è®­ç»ƒæ•°æ®</strong>ï¼šæ•°ä¸‡çº§æ ‡æ³¨ç”¨æˆ·æŒ‡ä»¤+å¯¹åº”é«˜è´¨é‡è¾“å‡ºï¼Œèšç„¦å¼€æ”¾é—®é¢˜ã€é˜…è¯»ç†è§£ã€ä»£ç ç”Ÿæˆç­‰åœºæ™¯ã€‚</li>
<li><strong>èƒ½åŠ›æå‡</strong>ï¼šæ¨¡å‹å…·å¤‡åˆæ­¥çš„æŒ‡ä»¤ç†è§£èƒ½åŠ›ï¼Œèƒ½å®Œæˆå¼€æ”¾é¢†åŸŸé—®ç­”ã€ç¿»è¯‘ã€ä»£ç ç¼–å†™ï¼Œè¿˜èƒ½æ³›åŒ–åˆ°æœªçŸ¥ä»»åŠ¡ã€‚</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œSFTæ¨¡å‹ï¼ˆæœ‰ç›‘ç£å¾®è°ƒæ¨¡å‹ï¼‰â€ï¼Œéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-3">ä¸‰ã€é˜¶æ®µä¸‰ï¼šå¥–åŠ±å»ºæ¨¡â€”â€”ç»™æ¨¡å‹â€œç«‹è¯„ä»·æ ‡å‡†â€</h2>
<p>è¿™ä¸€é˜¶æ®µçš„æ ¸å¿ƒæ˜¯<strong>æ„å»ºâ€œæ–‡æœ¬è´¨é‡è¯„ä¼°ä½“ç³»â€</strong>ï¼Œä¸ºåç»­ä¼˜åŒ–æä¾›â€œå¥–åŠ±ä¿¡å·â€ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç›®æ ‡</strong>ï¼šè®­ç»ƒä¸€ä¸ªâ€œå¥–åŠ±æ¨¡å‹ï¼ˆRMï¼‰â€ï¼Œç”¨äºè¯„ä¼°SFTæ¨¡å‹è¾“å‡ºå†…å®¹çš„è´¨é‡é«˜ä½ã€‚</li>
<li><strong>è®­ç»ƒæ–¹å¼</strong>ï¼šäººå·¥æ ‡æ³¨ç™¾ä¸‡çº§æ ·æœ¬â€”â€”å°†åŒä¸€ä¸ªæŒ‡ä»¤è¾“å…¥SFTæ¨¡å‹å¾—åˆ°å¤šä¸ªè¾“å‡ºï¼Œç”±æ ‡æ³¨äººå‘˜å¯¹è¿™äº›è¾“å‡ºæŒ‰è´¨é‡æ’åºï¼Œä»¥æ­¤è®­ç»ƒRMæ¨¡å‹ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šRMæ¨¡å‹ä¼šæˆä¸ºåç»­å¼ºåŒ–å­¦ä¹ çš„â€œè£åˆ¤â€ï¼Œä¸ºæ¨¡å‹çš„è¾“å‡ºæ‰“åˆ†ã€‚</li>
<li><strong>è¾“å‡ºä¸èµ„æº</strong>ï¼šå¾—åˆ°â€œRMæ¨¡å‹ï¼ˆå¥–åŠ±æ¨¡å‹ï¼‰â€ï¼Œéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-4">å››ã€é˜¶æ®µå››ï¼šå¼ºåŒ–å­¦ä¹ â€”â€”è®©æ¨¡å‹â€œè¶Šç­”è¶Šè´´åˆéœ€æ±‚â€</h2>
<p>è¿™æ˜¯ChatGPTçš„<strong>æœ€ç»ˆä¼˜åŒ–é˜¶æ®µ</strong>ï¼Œæ ¸å¿ƒæ˜¯ç”¨å¥–åŠ±ä¿¡å·è®©æ¨¡å‹æŒç»­è¿­ä»£ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š
<ol>
<li>è¾“å…¥åä¸‡çº§ç”¨æˆ·æŒ‡ä»¤ï¼Œè®©SFTæ¨¡å‹ç”Ÿæˆè¾“å‡ºï¼›</li>
<li>ç”¨RMæ¨¡å‹å¯¹è¾“å‡ºæ‰“åˆ†ï¼ˆå³â€œå¥–åŠ±â€ï¼‰ï¼›</li>
<li>æ ¹æ®å¥–åŠ±ç»“æœè°ƒæ•´SFTæ¨¡å‹çš„å‚æ•°ï¼Œè®©æ¨¡å‹æ›´å€¾å‘äºç”Ÿæˆé«˜åˆ†å†…å®¹ã€‚</li>
</ol>
</li>
<li><strong>æœ€ç»ˆè¾“å‡º</strong>ï¼šç»è¿‡æ­¤é˜¶æ®µè®­ç»ƒåï¼Œå¾—åˆ°æœ€ç»ˆçš„ChatGPTæ¨¡å‹ã€‚</li>
<li><strong>èµ„æºéœ€æ±‚</strong>ï¼šéœ€<strong>1-100GPU/å¤©</strong>çš„è®­ç»ƒèµ„æºã€‚</li>
</ul>
<h2 data-id="heading-5">æ€»ç»“ï¼šChatGPTæ„å»ºçš„â€œå››æ­¥é€»è¾‘â€</h2>
<p>ChatGPTçš„è®­ç»ƒæ˜¯ä¸€ä¸ªâ€œä»åŸºç¡€åˆ°ä¼˜åŒ–â€çš„é€’è¿›è¿‡ç¨‹ï¼š</p>
<ol>
<li>é¢„è®­ç»ƒï¼šå­¦è¯­è¨€ã€æ”’çŸ¥è¯† â†’ åŸºç¡€æ¨¡å‹ï¼›</li>
<li>æœ‰ç›‘ç£å¾®è°ƒï¼šå­¦æŒ‡ä»¤ã€æ‡‚éœ€æ±‚ â†’ SFTæ¨¡å‹ï¼›</li>
<li>å¥–åŠ±å»ºæ¨¡ï¼šå®šæ ‡å‡†ã€åšè£åˆ¤ â†’ RMæ¨¡å‹ï¼›</li>
<li>å¼ºåŒ–å­¦ä¹ ï¼šé åé¦ˆã€è¿­ä»£ä¼˜ â†’ ChatGPTã€‚</li>
</ol>
<p>å„é˜¶æ®µçš„<strong>æ•°æ®è§„æ¨¡ã€ç®—æ³•ç±»å‹ã€è®¡ç®—èµ„æº</strong>éœ€ç²¾å‡†åŒ¹é…ï¼Œæ‰èƒ½æœ€ç»ˆå®ç°æ¨¡å‹çš„â€œæ™ºèƒ½è¡¨ç°â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥]]></title>    <link>https://juejin.cn/post/7585574047075418112</link>    <guid>https://juejin.cn/post/7585574047075418112</guid>    <pubDate>2025-12-21T08:51:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585574047075418112" data-draft-id="7585693761532543010" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-21T08:51:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Charlie_Byte"/> <meta itemprop="url" content="https://juejin.cn/user/1968540037686224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ MurmurHash + Base62 ç”ŸæˆçŸ­é“¾æ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1968540037686224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Charlie_Byte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:51:08.000Z" title="Sun Dec 21 2025 08:51:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çŸ­é“¾æ¥ï¼Ÿ</h2>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Ÿ</p>
<blockquote>
<p>æƒ³åœ¨æœ‹å‹åœˆåˆ†äº«ä¸€ä¸ªé“¾æ¥ï¼Œç»“æœä¸€ç²˜è´´â€”â€”å¥½å®¶ä¼™ï¼Œä¸€é•¿ä¸²å‚æ•°ï¼Œå äº†åŠå±ï¼Œè¿˜å¸¦ä¸€å † <code>?utm_source=xxx&amp;ref=yyyâ€¦â€¦</code> åˆ«äººä¸€çœ‹å°±çƒ¦ï¼Œè‡ªå·±éƒ½æ‡’å¾—ç‚¹ã€‚æ›´åˆ«è¯´åœ¨çŸ­ä¿¡ã€æµ·æŠ¥ã€äºŒç»´ç ç­‰ç©ºé—´æœ‰é™çš„åœºæ™¯ä¸‹äº†ã€‚</p>
</blockquote>
<p>è¿™æ—¶å€™ï¼Œå°±éœ€è¦ä¸€ä¸ª<strong>çŸ­é“¾æ¥</strong>ï¼Œæ¯”å¦‚æŠŠï¼š</p>
<pre><code class="hljs language-text" lang="text">https://example.com/article?id=12345&amp;source=wechat&amp;utm_campaign=spring_sale
</code></pre>
<p>å˜æˆ</p>
<pre><code class="hljs language-text" lang="text">https://ex.co/aB3k9
</code></pre>
<p>è¿™ç±»çŸ­é“¾æ¥ç®€æ´ç¾è§‚ï¼Œæ˜“äºä¼ æ’­å¹¶ä¸”å¯éšè—åŸå§‹é€»è¾‘ï¼Œç”¨èµ·æ¥è¿˜æ˜¯æŒºæ–¹ä¾¿çš„ã€‚</p>
<h2 data-id="heading-1">å“ˆå¸Œ + ç¼–ç Â = çŸ­ç </h2>
<p>è¦ç”ŸæˆçŸ­é“¾æ¥ï¼Œå…³é”®åœ¨äºå°†ä»»æ„é•¿åº¦çš„åŸå§‹ URL æ˜ å°„ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦ã€å”¯ä¸€ä¸”ç´§å‡‘çš„å­—ç¬¦ä¸²æ ‡è¯†ç¬¦ï¼ˆå³â€œçŸ­ç â€ï¼‰ã€‚</p>
<p>è¿™é‡Œé‡‡ç”¨ä¸¤æ­¥æ³•ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå“ˆå¸Œ</strong></p>
<p>ä½¿ç”¨<strong>éåŠ å¯†å‹å“ˆå¸Œå‡½æ•°</strong>ï¼ˆå¦‚ MurmurHashï¼‰å°†åŸå§‹ URL è½¬æ¢ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ•´æ•°ï¼ˆé€šå¸¸æ˜¯ 32 ä½ï¼‰ã€‚<br/>
ä¸ºä»€ä¹ˆä¸ç”¨ MD5 æˆ– SHAï¼Ÿå› ä¸ºå®ƒä»¬è¾“å‡ºå¤ªé•¿ï¼ˆMD5 æ˜¯ 32 ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„æ˜¯çŸ­</p>
<p><strong>MurmurHash çš„ä¼˜åŠ¿</strong></p>
<ul>
<li>é«˜æ€§èƒ½ï¼šè®¡ç®—é€Ÿåº¦å¿«ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯</li>
<li>å‡åŒ€åˆ†å¸ƒï¼šå†²çªç‡ä½ï¼Œä¿è¯ä¸åŒ URL ç”Ÿæˆä¸åŒå“ˆå¸Œå€¼</li>
<li>å›ºå®šç§å­ï¼šGuava æä¾›çš„Â <code>murmur3_32_fixed()</code>Â ä½¿ç”¨å›ºå®šç§å­ï¼Œç¡®ä¿è·¨ JVMã€è·¨æœºå™¨ç»“æœä¸€è‡´</li>
<li>éåŠ å¯†ï¼šä¸ç”¨äºå®‰å…¨åœºæ™¯ï¼Œæ­£é€‚åˆåš ID ç”Ÿæˆ</li>
</ul>
<p><strong>ç¬¬äºŒæ­¥ï¼šç¼–ç </strong></p>
<p>å°†å“ˆå¸Œå¾—åˆ°çš„æ•´æ•°ï¼ˆå¯èƒ½ä¸ºè´Ÿæ•°ï¼‰è½¬æ¢ä¸º<strong>Base62 å­—ç¬¦ä¸²</strong>ã€‚</p>
<p><strong>Base62 æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>å­—ç¬¦é›†ï¼š<code>0â€“9</code>ï¼ˆ10ä¸ªï¼‰ +Â <code>Aâ€“Z</code>ï¼ˆ26ä¸ªï¼‰ +Â <code>aâ€“z</code>ï¼ˆ26ä¸ªï¼‰ = å…± 62 ä¸ªå­—ç¬¦</li>
<li>ä¼˜ç‚¹ï¼šURL å®‰å…¨ï¼ˆä¸å«Â <code>+</code>,Â <code>/</code>,Â <code>=</code>Â ç­‰ç‰¹æ®Šå­—ç¬¦ï¼‰ï¼Œå¯ç›´æ¥æ‹¼æ¥åˆ°åŸŸåå</li>
<li>å¯¹æ¯” Base64ï¼šBase64 å«Â <code>+</code>Â å’ŒÂ <code>/</code>ï¼Œåœ¨ URL ä¸­éœ€è½¬ä¹‰ï¼Œä¸é€‚åˆåšçŸ­é“¾</li>
</ul>
<p><strong>æœ€ç»ˆæµç¨‹</strong></p>
<pre><code class="hljs language-text" lang="text">é•¿ URL â†’ MurmurHash â†’ 32ä½æ•´æ•° â†’ è½¬æ— ç¬¦å· long â†’ Base62 ç¼–ç  â†’ 5~6ä½çŸ­ç 
</code></pre>
<h2 data-id="heading-2">æ ¸å¿ƒä»£ç </h2>
<p>é¦–å…ˆï¼Œåœ¨ Maven é¡¹ç›®ä¸­å¼•å…¥ Google Guava åº“ï¼ˆæä¾›äº†ç¨³å®šé«˜æ•ˆçš„ MurmurHash å®ç°ï¼‰</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.google.guava/guava --&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>33.5.0-jre<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å“ˆå¸Œæµ‹è¯•ï¼Œçœ‹ MurmurHash è¾“å‡ºä»€ä¹ˆ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// import com.google.common.hash.Hashing;</span>
<span class="hljs-comment">// import java.nio.charset.StandardCharsets;</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {  
    <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://tse1-mm.cn.bing.net/th/id/OIP-C.wb-bFBTpIZDy_1jcvMY_5QHaE8?w=286&amp;h=191&amp;c=7&amp;r=0&amp;o=7&amp;cb=ucfimg2&amp;dpr=1.1&amp;pid=1.7&amp;rm=3&amp;ucfimg=1"</span>;  
  
    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
            .hashString(url, StandardCharsets.UTF_8)  
            .asInt();  
    System.out.println(<span class="hljs-string">"hash: "</span> + hash); <span class="hljs-comment">// å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œå¦‚ -904567778</span>
  
    <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>; <span class="hljs-comment">// è½¬ä¸ºæ— ç¬¦å· longï¼Œå¦‚ 3390399518</span>
    System.out.println(<span class="hljs-string">"unsignedHash: "</span> + unsignedHash);  
}
</code></pre>
<pre><code class="hljs language-text" lang="text">hash: -904567778
unsignedHash: 3390399518
</code></pre>
<p>Java çš„ int æ˜¯æœ‰ç¬¦å·çš„ï¼Œç›´æ¥å¯¹è´Ÿæ•°åš Base62 ç¼–ç ä¼šå¯¼è‡´é”™è¯¯ï¼ˆæ¯”å¦‚æ¨¡è¿ç®—å¼‚å¸¸æˆ–ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œå› æ­¤é¡»å…ˆè½¬ä¸ºæ— ç¬¦å· long</p>
<p>åœ¨å¾ˆå¤šä¸šåŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªé“¾æ¥å¯¹ä¸åŒç”¨æˆ·å¯èƒ½æœ‰ä¸åŒçš„è¡Œä¸ºæˆ–æƒé™ï¼Œå°±éœ€è¦å¯¹çŸ­ç è¿›è¡ŒåŒºåˆ†ç”Ÿæˆï¼Œå› æ­¤å¯ä»¥åœ¨ç”ŸæˆçŸ­ç æ—¶ï¼Œå°†ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ user_idã€è®¾å¤‡ IDï¼‰ä¸åŸå§‹ URL æ‹¼æ¥ï¼Œå†è¿›è¡Œå“ˆå¸Œï¼š</p>
<pre><code class="hljs language-java" lang="java">create(url + <span class="hljs-string">"|"</span> + userId)
</code></pre>
<p>å› ä¸ºè¾“å…¥å˜äº†ï¼Œå“ˆå¸Œç»“æœå°±å˜äº†ï¼ŒçŸ­ç è‡ªç„¶ä¹Ÿä¸åŒã€‚</p>
<h2 data-id="heading-3">å®Œæ•´ä»£ç </h2>
<blockquote>
<p>å¸¦æ³¨é‡Šï¼Œæ”¾å¿ƒæŠ„</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> io.jiangbyte.app.biz.urls.utils;  
  
<span class="hljs-keyword">import</span> com.google.common.hash.Hashing;  
  
<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;  
  
<span class="hljs-comment">/**  
 * 1. ä½¿ç”¨ Guava çš„ Murmur3_32_fixed å“ˆå¸Œç®—æ³•å¯¹è¾“å…¥å­—ç¬¦ä¸²è®¡ç®— 32 ä½å“ˆå¸Œå€¼  
 * 2. å°†æœ‰ç¬¦å· int è½¬æ¢ä¸ºæ— ç¬¦å· longï¼ˆé¿å…è´Ÿæ•°é—®é¢˜ï¼‰  
 * 3. å°†è¯¥æ•°å€¼ä½¿ç”¨ Base62 ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼š0-9, A-Z, a-zï¼‰è¾“å‡ºä¸ºç´§å‡‘å­—ç¬¦ä¸²  
 */</span>  
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MurmurHashUtils</span> {  
  
    <span class="hljs-comment">/**  
     * Base62 ç¼–ç å­—ç¬¦é›†ï¼ŒæŒ‰æ ‡å‡†é¡ºåºæ’åˆ—  
     * - æ•°å­— '0' åˆ° '9'ï¼ˆ10 ä¸ªï¼‰  
     * - å¤§å†™å­—æ¯ 'A' åˆ° 'Z'ï¼ˆ26 ä¸ªï¼‰  
     * - å°å†™å­—æ¯ 'a' åˆ° 'z'ï¼ˆ26 ä¸ªï¼‰  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">char</span>[] CHARS = buildBase62Chars();  
  
    <span class="hljs-comment">/**  
     * Base62 çš„åŸºæ•°ï¼Œå€¼ä¸º 62  
     * ç”¨äºè¿›åˆ¶è½¬æ¢è®¡ç®—  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BASE</span> <span class="hljs-operator">=</span> CHARS.length;  
  
    <span class="hljs-comment">/**  
     * æ„å»º Base62 å­—ç¬¦æ•°ç»„  
     * æŒ‰ç…§æ ‡å‡†é¡ºåºä¾æ¬¡å¡«å……æ•°å­—ã€å¤§å†™å­—æ¯ã€å°å†™å­—æ¯  
     *  
     * <span class="hljs-doctag">@return</span> é•¿åº¦ä¸º 62 çš„å­—ç¬¦æ•°ç»„ï¼Œç´¢å¼•å³å¯¹åº”æ•°å€¼ï¼ˆå¦‚ CHARS[0]='0', CHARS[10]='A'ï¼‰  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">char</span>[] buildBase62Chars() {  
        <span class="hljs-type">char</span>[] chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">62</span>];  
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  
  
        <span class="hljs-comment">// å¡«å……æ•°å­— '0' ~ '9'        for (char c = '0'; c &lt;= '9'; c++) {  </span>
            chars[index++] = c;  
        }  
        <span class="hljs-comment">// å¡«å……å¤§å†™å­—æ¯ 'A' ~ 'Z'        for (char c = 'A'; c &lt;= 'Z'; c++) {  </span>
            chars[index++] = c;  
        }  
        <span class="hljs-comment">// å¡«å……å°å†™å­—æ¯ 'a' ~ 'z'        for (char c = 'a'; c &lt;= 'z'; c++) {  </span>
            chars[index++] = c;  
        }  
  
        <span class="hljs-keyword">return</span> chars;  
    }  
  
    <span class="hljs-comment">/**  
     * å°†ä¸€ä¸ªéè´Ÿé•¿æ•´å‹æ•°å€¼è½¬æ¢ä¸º Base62 ç¼–ç å­—ç¬¦ä¸²  
     * ä¸æ–­å¯¹ BASE å–æ¨¡è·å–æœ€ä½ä½å­—ç¬¦ï¼Œå†é™¤ä»¥ BASEï¼Œç›´åˆ°æ•°å€¼ä¸º 0, æœ€åå°†å­—ç¬¦åºåˆ—åè½¬ï¼Œå¾—åˆ°é«˜ä½åœ¨å‰çš„æ ‡å‡†è¡¨ç¤º  
     *  
     * <span class="hljs-doctag">@param</span> n å¾…ç¼–ç çš„éè´Ÿ long å€¼  
     * <span class="hljs-doctag">@return</span> Base62 ç¼–ç åçš„å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">base62</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span> {  
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) {  
            <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>; <span class="hljs-comment">// ç‰¹æ®Šæƒ…å†µï¼š0 ç¼–ç ä¸º "0"        }  </span>
  
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();  
        <span class="hljs-keyword">while</span> (n &gt; <span class="hljs-number">0</span>) {  
            sb.append(CHARS[(<span class="hljs-type">int</span>) (n % BASE)]); <span class="hljs-comment">// å–æ¨¡å¾—åˆ°å½“å‰æœ€ä½ä½å¯¹åº”çš„å­—ç¬¦ç´¢å¼•  </span>
            n /= BASE;  <span class="hljs-comment">// æ•´é™¤è¿›å…¥ä¸‹ä¸€ä½  </span>
        }  
  
        <span class="hljs-comment">// ç”±äºæ˜¯ä»ä½ä½åˆ°é«˜ä½è¿½åŠ ï¼Œéœ€åè½¬å¾—åˆ°æ­£ç¡®é¡ºåº  </span>
        <span class="hljs-keyword">return</span> sb.reverse().toString();  
    }  
  
    <span class="hljs-comment">/**  
     * å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œå“ˆå¸Œå¹¶ç”Ÿæˆ Base62 çŸ­å­—ç¬¦ä¸²ã€‚  
     * ä½¿ç”¨ Murmur3_32_fixed ç®—æ³•ï¼ˆGuava æä¾›çš„å›ºå®šç§å­ç‰ˆæœ¬ï¼Œä¿è¯è·¨ JVM ä¸€è‡´æ€§ï¼‰  
     * å°†ç»“æœè½¬ä¸ºæ— ç¬¦å· 32 ä½æ•´æ•°ï¼Œå†è¿›è¡Œ Base62 ç¼–ç   
     *  
     * <span class="hljs-doctag">@param</span> input åŸå§‹è¾“å…¥å­—ç¬¦ä¸²  
     * <span class="hljs-doctag">@return</span> Base62 ç¼–ç çš„çŸ­å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">create</span><span class="hljs-params">(String input)</span> {  
        <span class="hljs-comment">// ä½¿ç”¨ UTF-8 ç¼–ç è®¡ç®— Murmur3_32 å“ˆå¸Œå€¼ï¼ˆå›ºå®šç§å­ï¼‰  </span>
        <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
                .hashString(input, StandardCharsets.UTF_8)  
                .asInt();  
  
        <span class="hljs-comment">// å°†æœ‰ç¬¦å· int è½¬æ¢ä¸ºæ— ç¬¦å· longï¼ˆé¿å…è´Ÿæ•°å¯¼è‡´ base62 é€»è¾‘å¼‚å¸¸ï¼‰  </span>
        <span class="hljs-comment">// -1 â†’ 0xFFFFFFFFL = 4294967295  </span>
        <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>;  
  
        <span class="hljs-keyword">return</span> base62(unsignedHash);  
    }  
  
    <span class="hljs-comment">/**  
     * ç”Ÿæˆå¸¦ç”¨æˆ·éš”ç¦»çš„çŸ­é“¾æ ‡è¯†ã€‚  
     * è‹¥æä¾› userIdï¼Œåˆ™å°† URL ä¸ userId æ‹¼æ¥åå†å“ˆå¸Œ  
     * ä½¿å¾—åŒä¸€ URL å¯¹ä¸åŒç”¨æˆ·ç”Ÿæˆä¸åŒçŸ­é“¾  
     * è‹¥ userId ä¸º nullï¼Œåˆ™é€€åŒ–ä¸ºæ™®é€šæ¨¡å¼  
     *  
     * <span class="hljs-doctag">@param</span> url    åŸå§‹é•¿é“¾æ¥  
     * <span class="hljs-doctag">@param</span> userId ç”¨æˆ·å”¯ä¸€æ ‡è¯†  
     * <span class="hljs-doctag">@return</span> ç”¨æˆ·éš”ç¦»æˆ–é€šç”¨çš„ Base62 çŸ­å­—ç¬¦ä¸²  
     */</span>  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">create</span><span class="hljs-params">(String url, String userId)</span> {  
        <span class="hljs-keyword">if</span> (userId != <span class="hljs-literal">null</span>) {  
            <span class="hljs-comment">// æ‹¼æ¥æ ¼å¼ï¼šåŸå§‹URL + åˆ†éš”ç¬¦ "|" + ç”¨æˆ·ID  </span>
            <span class="hljs-keyword">return</span> create(url + <span class="hljs-string">"|"</span> + userId);  
        } <span class="hljs-keyword">else</span> {  
            <span class="hljs-comment">// æ— ç”¨æˆ·éš”ç¦»ï¼Œç›´æ¥å“ˆå¸ŒåŸå§‹ URL</span>
            <span class="hljs-keyword">return</span> create(url);  
        }  
    }  
}
</code></pre>
<p><strong>æµ‹è¯•è¾“å‡º</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {  
    <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://tse1-mm.cn.bing.net/th/id/OIP-C.wb-bFBTpIZDy_1jcvMY_5QHaE8?w=286&amp;h=191&amp;c=7&amp;r=0&amp;o=7&amp;cb=ucfimg2&amp;dpr=1.1&amp;pid=1.7&amp;rm=3&amp;ucfimg=1"</span>;  
  
    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> Hashing.murmur3_32_fixed()  
            .hashString(url, StandardCharsets.UTF_8)  
            .asInt();  
    System.out.println(<span class="hljs-string">"hash: "</span> + hash); <span class="hljs-comment">// æœ‰ç¬¦å· intï¼Œé€»è¾‘å‡ºé”™ï¼Œä¸ºç©º  </span>
  
    <span class="hljs-type">String</span> <span class="hljs-variable">base62_hash</span> <span class="hljs-operator">=</span> base62(hash);  
    System.out.println(<span class="hljs-string">"base62_hash: "</span> + base62_hash);  
  
    <span class="hljs-type">long</span> <span class="hljs-variable">unsignedHash</span> <span class="hljs-operator">=</span> hash &amp; <span class="hljs-number">0xFFFFFFFFL</span>;  
    System.out.println(<span class="hljs-string">"unsignedHash: "</span> + unsignedHash);  
  
    <span class="hljs-type">String</span> <span class="hljs-variable">base62_unsignedHash</span> <span class="hljs-operator">=</span> base62(unsignedHash);  
    System.out.println(<span class="hljs-string">"base62_unsignedHash: "</span> + base62_unsignedHash);  
  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url));  
  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"1234"</span>));  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"1234"</span>));  
    System.out.println(<span class="hljs-string">"create: "</span> + create(url, <span class="hljs-string">"12345"</span>));  
}
</code></pre>
<pre><code class="hljs language-text" lang="text">hash: -904567778
base62_hash: 
unsignedHash: 3390399518
base62_unsignedHash: 3hRlnC
create: 3hRlnC
create: 4YmoRu
create: 4YmoRu
create: GsQoj
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7585758163435372550</link>    <guid>https://juejin.cn/post/7585758163435372550</guid>    <pubDate>2025-12-21T09:06:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585758163435372550" data-draft-id="7585758163435356166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-21T09:06:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åæœˆå—åŸ"/> <meta itemprop="url" content="https://juejin.cn/user/3456520290576862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç›‘æ§æŒ‡æ ‡ä¸å®¹é‡é¢„è­¦â€”â€”å»¶è¿Ÿã€å‘½ä¸­ç‡ã€æ…¢æŸ¥è¯¢ä¸å†…å­˜ç¢ç‰‡çš„è§£è¯»æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520290576862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åæœˆå—åŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T09:06:08.000Z" title="Sun Dec 21 2025 09:06:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å†™åœ¨å‰é¢ï¼Œæœ¬äººç›®å‰å¤„äºæ±‚èŒä¸­ï¼Œå¦‚æœ‰åˆé€‚å†…æ¨å²—ä½ï¼Œè¯·åŠ å¾®ä¿¡ï¼šlpshiyue æ„Ÿè°¢</strong></p>
<blockquote>
<p>åœ¨ Redis è¿ç»´ä¸­ï¼Œç›‘æ§æ˜¯æŒ‡æ•°çº§æŠ•å…¥å›æŠ¥æ¯”çš„æŠ•èµ„ï¼šæ¯å¢åŠ ä¸€ä¸ªå…³é”®æŒ‡æ ‡ç›‘æ§ï¼Œå¯èƒ½é¢„é˜²åå€ä»¥ä¸Šçš„æ•…éšœæŸå¤±</p>
</blockquote>
<p>åœ¨è§£å†³çƒ­ç‚¹ Key ä¸å¤§ Key çš„æ²»ç†æŒ‘æˆ˜åï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ›´ä¸ºåŸºç¡€ä¸”å…³é”®çš„é—®é¢˜ï¼šå¦‚ä½•æå‰å‘ç°å¹¶é¢„é˜²è¿™äº›é—®é¢˜çš„å‘ç”Ÿã€‚å®Œå–„çš„ç›‘æ§ä½“ç³»ä¸ä»…èƒ½å®æ—¶åæ˜  Redis å¥åº·çŠ¶æ€ï¼Œæ›´èƒ½é€šè¿‡è¶‹åŠ¿åˆ†æé¢„æµ‹æ½œåœ¨é£é™©ï¼Œå®ç°ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²çš„è½¬å˜ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æ Redis æ ¸å¿ƒç›‘æ§æŒ‡æ ‡ï¼Œå»ºç«‹å®Œæ•´çš„å®¹é‡é¢„è­¦ä½“ç³»ï¼Œè®©ç¼“å­˜ç³»ç»Ÿè¿è¡Œåœ¨å¯è§†ã€å¯æ§ã€å¯é¢„æµ‹çš„è½¨é“ä¸Šã€‚</p>
<h3 data-id="heading-0">1 ç›‘æ§ä½“ç³»çš„ä»·å€¼ä¸æ„å»ºåŸåˆ™</h3>
<h4 data-id="heading-1">1.1 ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²</h4>
<p>Redis ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œå¯¹èµ„æºå¼‚å¸¸æ•æ„Ÿï¼Œâ€‹<strong>æ— ç›‘æ§çš„ Redis å¦‚åŒç›²äººé©¾é©¶é«˜é€Ÿèµ›è½¦</strong>â€‹â€”â€”çœ‹ä¼¼è¿è¡Œæ­£å¸¸ï¼Œå®åˆ™å±æœºå››ä¼ã€‚å®Œå–„çš„ç›‘æ§ä½“ç³»èƒ½å®ç°ä¸‰ä¸ªæ ¸å¿ƒä»·å€¼ï¼š<strong>å®æ—¶æ•…éšœå‘ç°</strong>å°†æ•…éšœå‘ç°æ—¶é—´ä»å°æ—¶çº§ç¼©çŸ­åˆ°åˆ†é’Ÿçº§ï¼Œ<strong>æ ¹å› åˆ†æ</strong>é€šè¿‡å†å²æ•°æ®è¿½æº¯é—®é¢˜æºå¤´ï¼Œ<strong>å®¹é‡è§„åˆ’</strong>åŸºäºè¶‹åŠ¿é¢„æµ‹æå‰æ‰©å®¹é¿å…èµ„æºè€—å°½ã€‚</p>
<p>ç›‘æ§ç³»ç»Ÿçš„ç¼ºå¤±ä¼šå¯¼è‡´æ•…éšœæ”¾å¤§æ•ˆåº”ã€‚å½“ç”¨æˆ·é¦–å…ˆæ„ŸçŸ¥é—®é¢˜è€Œéè¿ç»´äººå‘˜æ—¶ï¼Œæ•…éšœå½±å“å·²æ‰©æ•£ã€‚å¦‚æ‰€è¿°ï¼Œè‹¥ç”±ç”¨æˆ·é€šè¿‡å®¢æœåé¦ˆå†æ’æŸ¥åˆ° Redis æ•…éšœï¼Œæ•´ä¸ªå‘ç°ã€å®šä½å’Œè§£å†³æ—¶é—´è¢«æ‹‰é•¿ï¼Œå°æ•…éšœè¢«â€œæ— é™â€æ”¾å¤§ã€‚</p>
<h4 data-id="heading-2">1.2 ç›‘æ§ä½“ç³»æ„å»ºçš„é»„é‡‘æ³•åˆ™</h4>
<p>æœ‰æ•ˆçš„ Redis ç›‘æ§åº”éµå¾ªâ€‹<strong>SMART åŸåˆ™</strong>â€‹ï¼šç›‘æ§æŒ‡æ ‡éœ€â€‹<strong>å…·ä½“</strong>â€‹ï¼ˆSpecificï¼‰ã€â€‹<strong>å¯è¡¡é‡</strong>â€‹ï¼ˆMeasurableï¼‰ã€â€‹<strong>å¯è¾¾æˆ</strong>â€‹ï¼ˆAttainableï¼‰ã€â€‹<strong>ç›¸å…³</strong>â€‹ï¼ˆRelevantï¼‰å’Œâ€‹<strong>æœ‰æ—¶æ•ˆ</strong>â€‹ï¼ˆTime-boundï¼‰ã€‚ç›‘æ§ä¸æ˜¯æ•°æ®å †ç Œï¼Œè€Œæ˜¯å…³é”®ä¿¡å·æå–ã€‚</p>
<p><strong>åˆ†å±‚ç›‘æ§</strong>ç†å¿µè‡³å…³é‡è¦ï¼š<strong>åŸºç¡€å±‚</strong>å…³æ³¨æœåŠ¡å™¨èµ„æºï¼ˆCPUã€å†…å­˜ã€ç½‘ç»œï¼‰ï¼›<strong>Redis å®ä¾‹å±‚</strong>è·Ÿè¸ªè¿æ¥ã€å†…å­˜ã€æŒä¹…åŒ–çŠ¶æ€ï¼›<strong>ä¸šåŠ¡å±‚</strong>èšç„¦å‘½ä¸­ç‡ã€å»¶è¿Ÿç­‰ä¸šåŠ¡ç›¸å…³æŒ‡æ ‡ã€‚è¿™ç§åˆ†å±‚ç»“æ„ç¡®ä¿é—®é¢˜å®šä½æ•ˆç‡ã€‚</p>
<h3 data-id="heading-3">2 æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡æ·±åº¦è§£è¯»</h3>
<h4 data-id="heading-4">2.1 å»¶è¿Ÿï¼ˆLatencyï¼‰ï¼šç”¨æˆ·ä½“éªŒçš„ç›´æ¥ä½“ç°</h4>
<p>å»¶è¿Ÿæ˜¯ Redis æ€§èƒ½æœ€ç›´è§‚çš„æŒ‡æ ‡ï¼Œè¡¡é‡ä»å‘½ä»¤å‘é€åˆ°æ”¶åˆ°å“åº”çš„æ€»æ—¶é—´ã€‚å•çº¿ç¨‹æ¶æ„ä½¿ Redis å¯¹å»¶è¿Ÿå¼‚å¸¸æ•æ„Ÿï¼Œä»»ä½•å¾®å°å»¶è¿Ÿéƒ½å¯èƒ½ç´¯ç§¯æˆä¸¥é‡ç“¶é¢ˆã€‚</p>
<p>â€‹<strong>å»¶è¿Ÿç›‘æ§çš„å¤šç»´åº¦å®ç°</strong>â€‹ï¼š</p>
<ul>
<li>
<p>â€‹<strong>å†…åœ¨å»¶è¿Ÿ</strong>â€‹ï¼šä½¿ç”¨ <code>redis-cli --intrinsic-latency</code> æµ‹é‡ Redis æœåŠ¡å™¨è‡ªèº«å»¶è¿Ÿ</p>
</li>
<li>
<p>â€‹<strong>ç½‘ç»œå»¶è¿Ÿ</strong>â€‹ï¼šé€šè¿‡ <code>redis-cli --latency -h host -p port</code> æµ‹è¯•å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„å¾€è¿”å»¶è¿Ÿ</p>
</li>
<li>
<p>â€‹<strong>å‘½ä»¤å»¶è¿Ÿ</strong>â€‹ï¼šé…ç½® <code>latency-monitor-threshold</code> å¯ç”¨å»¶è¿Ÿç›‘æ§æ¡†æ¶</p>
<h2 data-id="heading-5">è®¾ç½®å»¶è¿Ÿç›‘æ§é˜ˆå€¼ä¸º100æ¯«ç§’</h2>
<p>CONFIG SET latency-monitor-threshold 100</p>
<h2 data-id="heading-6">æŸ¥çœ‹æœ€æ–°å»¶è¿Ÿäº‹ä»¶</h2>
<p>LATENCY LATEST</p>
<h2 data-id="heading-7">è·å–å»¶è¿Ÿå†å²æ•°æ®</h2>
<p>LATENCY HISTORY command
â€‹</p>
</li>
</ul>
<p>åŸºäºçš„å»¶è¿Ÿç›‘æ§é…ç½®</p>
<p>â€‹<strong>å»¶è¿Ÿçš„å…¸å‹é˜ˆå€¼å‚è€ƒ</strong>â€‹ï¼š</p>
<ul>
<li>ç†æƒ³å»¶è¿Ÿï¼š&lt;1msï¼ˆå†…å­˜æ“ä½œï¼‰</li>
<li>å¯æ¥å—å»¶è¿Ÿï¼š1-5msï¼ˆæ­£å¸¸ç½‘ç»œå¼€é”€ï¼‰</li>
<li>éœ€å…³æ³¨å»¶è¿Ÿï¼š5-10msï¼ˆå¯èƒ½å­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼‰</li>
<li>é—®é¢˜å»¶è¿Ÿï¼š&gt;10msï¼ˆéœ€ç«‹å³æ’æŸ¥ï¼‰</li>
</ul>
<h4 data-id="heading-8">2.2 å‘½ä¸­ç‡ï¼ˆHit Rateï¼‰ï¼šç¼“å­˜æ•ˆç‡çš„æ ¸å¿ƒæŒ‡æ ‡</h4>
<p>å‘½ä¸­ç‡è¡¡é‡ç¼“å­˜æœ‰æ•ˆæ€§ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š<code>keyspace_hits / (keyspace_hits + keyspace_misses)</code>ã€‚ä½å‘½ä¸­ç‡æ„å‘³ç€ç¼“å­˜æ•ˆç‡ä½ä¸‹ï¼Œå¤§é‡è¯·æ±‚ç›´æ¥ç©¿é€åˆ°åç«¯æ•°æ®åº“ã€‚</p>
<p>â€‹<strong>å‘½ä¸­ç‡è§£è¯»ä¸ä¼˜åŒ–ç­–ç•¥</strong>â€‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å‘½ä¸­ç‡è®¡ç®—ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> <span class="hljs-title">calculateHitRate</span>()</span> {
    <span class="hljs-built_in">long</span> hits = redis.info(<span class="hljs-string">"stats"</span>).getLong(<span class="hljs-string">"keyspace_hits"</span>);
    <span class="hljs-built_in">long</span> misses = redis.info(<span class="hljs-string">"stats"</span>).getLong(<span class="hljs-string">"keyspace_misses"</span>);
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">double</span>)hits / (hits + misses);
}
â€‹
</code></pre>
<p>åŸºäºçš„å‘½ä¸­ç‡è®¡ç®—é€»è¾‘</p>
<p>â€‹<strong>å‘½ä¸­ç‡é˜ˆå€¼æŒ‡å—</strong>â€‹ï¼š</p>
<ul>
<li>ä¼˜ç§€ï¼š&gt;95%ï¼ˆç¼“å­˜æ•ˆæœæä½³ï¼‰</li>
<li>è‰¯å¥½ï¼š90%-95%ï¼ˆç¼“å­˜æ•ˆæœè‰¯å¥½ï¼‰</li>
<li>éœ€å…³æ³¨ï¼š80%-90%ï¼ˆéœ€è¦ä¼˜åŒ–ï¼‰</li>
<li>è¾ƒå·®ï¼š&lt;80%ï¼ˆç¼“å­˜ç­–ç•¥éœ€é‡æ„ï¼‰</li>
</ul>
<p>ä½å‘½ä¸­ç‡é€šå¸¸ç”±ä»¥ä¸‹åŸå› å¯¼è‡´ï¼š<strong>å†…å­˜ä¸è¶³</strong>å¯¼è‡´é¢‘ç¹æ•°æ®æ·˜æ±°ï¼Œ<strong>æ•°æ®è®¿é—®æ¨¡å¼å˜åŒ–</strong>ä½¿çƒ­ç‚¹æ•°æ®å¤±æ•ˆï¼Œ<strong>TTL è®¾ç½®è¿‡çŸ­</strong>å¯¼è‡´æ•°æ®è¿‡æ—©å¤±æ•ˆã€‚</p>
<h4 data-id="heading-9">2.3 å†…å­˜ç¢ç‰‡ï¼ˆMemory Fragmentationï¼‰ï¼šéšè—çš„æ€§èƒ½æ€æ‰‹</h4>
<p>å†…å­˜ç¢ç‰‡ç‡é€šè¿‡ <code>mem_fragmentation_ratio</code>ï¼ˆused_memory_rss/used_memoryï¼‰è®¡ç®—ï¼Œåæ˜ å†…å­˜ä½¿ç”¨æ•ˆç‡ã€‚</p>
<p>â€‹<strong>ç¢ç‰‡ç‡è§£è¯»ä¸è¡ŒåŠ¨æŒ‡å—</strong>â€‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æŸ¥çœ‹å†…å­˜ç¢ç‰‡ç‡</span>
redis-cli info memory | <span class="hljs-keyword">grep</span> mem_fragmentation_ratio
â€‹
</code></pre>
<p>â€‹</p>
<p>ç¢ç‰‡ç‡åˆ¤æ–­æ ‡å‡†</p>
<p>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>ç†æƒ³çŠ¶æ€</strong>â€‹ï¼ˆ1.0-1.5ï¼‰ï¼šå†…å­˜åˆ†é…ç´§å‡‘ï¼Œæ— æ˜¾è‘—ç¢ç‰‡</li>
<li>â€‹<strong>éœ€å…³æ³¨</strong>â€‹ï¼ˆ1.5-2.0ï¼‰ï¼šå­˜åœ¨ä¸€å®šç¢ç‰‡ï¼Œè€ƒè™‘ç›‘æ§ä¼˜åŒ–</li>
<li>â€‹<strong>é—®é¢˜çŠ¶æ€</strong>â€‹ï¼ˆ&gt;2.0ï¼‰ï¼šç¢ç‰‡ä¸¥é‡ï¼Œéœ€è¦é‡å¯æˆ–å†…å­˜ä¼˜åŒ–</li>
<li>â€‹<strong>å±é™©ä¿¡å·</strong>â€‹ï¼ˆ&lt;1.0ï¼‰ï¼šå†…å­˜äº¤æ¢åˆ°ç£ç›˜ï¼Œæ€§èƒ½ä¸¥é‡ä¸‹é™</li>
</ul>
<p>é«˜ç¢ç‰‡ç‡é€šå¸¸ç”±â€‹<strong>é¢‘ç¹ä¿®æ”¹ä¸åŒå¤§å°æ•°æ®</strong>â€‹ã€<strong>å¤§é‡é”®è¿‡æœŸ</strong>å¯¼è‡´ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬é‡å¯å®ä¾‹ã€ä½¿ç”¨ <code>MEMORY PURGE</code>ï¼ˆéœ€ Jemallocï¼‰æˆ–ä¼˜åŒ–æ•°æ®è®¿é—®æ¨¡å¼ã€‚</p>
<h3 data-id="heading-10">3 å®¹é‡é¢„è­¦æŒ‡æ ‡ä½“ç³»</h3>
<h4 data-id="heading-11">3.1 å†…å­˜å®¹é‡è§„åˆ’ä¸é¢„è­¦</h4>
<p>å†…å­˜æ˜¯ Redis æœ€å…³é”®çš„èµ„æºï¼Œéœ€å»ºç«‹å¤šçº§é¢„è­¦æœºåˆ¶ï¼š</p>
<p>â€‹<strong>å†…å­˜ä½¿ç”¨ç‡é¢„è­¦é˜ˆå€¼</strong>â€‹ï¼š</p>
<p>ä½¿ç”¨ç‡</p>
<p>å‘Šè­¦çº§åˆ«</p>
<p>å¤„ç†åŠ¨ä½œ</p>
<p>â‰¤70%</p>
<p>æ­£å¸¸</p>
<p>æŒç»­ç›‘æ§</p>
<p>70%-85%</p>
<p>è­¦å‘Š</p>
<p>æ£€æŸ¥å¤§ Keyï¼Œä¼˜åŒ–æ•°æ®</p>
<p>85%-95%</p>
<p>ä¸¥é‡</p>
<p>å‡†å¤‡æ‰©å®¹ï¼Œä¼˜åŒ–è¿‡æœŸç­–ç•¥</p>
<p>â‰¥95%</p>
<p>ç´§æ€¥</p>
<p>ç«‹å³æ‰©å®¹ï¼Œå¯èƒ½å·²æ‹’ç»å†™å…¥</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ</span>
<span class="hljs-string">redis-cli</span> <span class="hljs-string">info</span> <span class="hljs-string">memory</span>
<span class="hljs-attr">used_memory:</span> <span class="hljs-number">1000000</span>       <span class="hljs-comment"># Redisåˆ†é…å†…å­˜æ€»é‡</span>
<span class="hljs-attr">used_memory_rss:</span> <span class="hljs-number">1500000</span>   <span class="hljs-comment"># æ“ä½œç³»ç»Ÿè§†è§’å†…å­˜å ç”¨</span>
<span class="hljs-attr">used_memory_peak:</span> <span class="hljs-number">1200000</span>  <span class="hljs-comment"># å†å²å³°å€¼å†…å­˜</span>
<span class="hljs-attr">maxmemory:</span> <span class="hljs-number">2000000</span>        <span class="hljs-comment"># æœ€å¤§å†…å­˜é™åˆ¶</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„å†…å­˜ç›‘æ§æŒ‡æ ‡</p>
<p>â€‹<strong>å†…å­˜ä¼˜åŒ–ç­–ç•¥</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>æ•°æ®åˆ†ç‰‡</strong>â€‹ï¼šå°†å¤§æ•°æ®é›†åˆ†å¸ƒåˆ°å¤šä¸ªå®ä¾‹</li>
<li>â€‹<strong>å‹ç¼©å­˜å‚¨</strong>â€‹ï¼šå¯¹é€‚åˆæ•°æ®å¯ç”¨å‹ç¼©</li>
<li>â€‹<strong>è¿‡æœŸç­–ç•¥</strong>â€‹ï¼šè®¾ç½®åˆç†çš„ TTL å’Œæ·˜æ±°ç­–ç•¥</li>
</ul>
<h4 data-id="heading-12">3.2 è¿æ¥æ•°å®¹é‡ç®¡ç†</h4>
<p>è¿æ¥æ•°è¶…é™ä¼šå¯¼è‡´æ–°è¿æ¥è¢«æ‹’ç»ï¼Œç›‘æ§ <code>connected_clients</code> å¹¶è®¾ç½®åˆç†é˜ˆå€¼è‡³å…³é‡è¦ï¼š</p>
<p>â€‹<strong>è¿æ¥æ•°ç›‘æ§è¦ç‚¹</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># æŸ¥çœ‹è¿æ¥æ•°ä¿¡æ¯</span>
<span class="hljs-string">redis-cli</span> <span class="hljs-string">info</span> <span class="hljs-string">clients</span>
<span class="hljs-attr">connected_clients:</span> <span class="hljs-number">100</span>        <span class="hljs-comment"># å½“å‰è¿æ¥æ•°</span>
<span class="hljs-attr">maxclients:</span> <span class="hljs-number">10000</span>            <span class="hljs-comment"># æœ€å¤§è¿æ¥æ•°é™åˆ¶</span>
<span class="hljs-attr">blocked_clients:</span> <span class="hljs-number">0</span>           <span class="hljs-comment"># é˜»å¡è¿æ¥æ•°</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„è¿æ¥æ•°ç›‘æ§</p>
<p>â€‹<strong>è¿æ¥æ•°é¢„è­¦é˜ˆå€¼</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>æ­£å¸¸</strong>â€‹ï¼š&lt;80% maxclients</li>
<li>â€‹<strong>è­¦å‘Š</strong>â€‹ï¼š80%-95% maxclients</li>
<li>â€‹<strong>ç´§æ€¥</strong>â€‹ï¼š&gt;95% maxclients æˆ–å‡ºç° <code>rejected_connections</code></li>
</ul>
<p>è¿æ¥æ•°çªå¢é€šå¸¸ç”±â€‹<strong>è¿æ¥æ± é…ç½®é”™è¯¯</strong>â€‹ã€<strong>å®¢æˆ·ç«¯æœªæ­£ç¡®å…³é—­è¿æ¥</strong>æˆ–<strong>æ…¢æŸ¥è¯¢é˜»å¡</strong>å¯¼è‡´ã€‚åº”ç›‘æ§ <code>blocked_clients</code> äº†è§£é˜»å¡å‘½ä»¤æƒ…å†µã€‚</p>
<h4 data-id="heading-13">3.3 ç½‘ç»œå¸¦å®½ä¸ååé‡ç›‘æ§</h4>
<p>ç½‘ç»œå¸¦å®½å½±å“ Redis ååèƒ½åŠ›ï¼Œéœ€ç›‘æ§ç½‘ç»œè¾“å…¥è¾“å‡ºï¼š</p>
<p>â€‹<strong>å…³é”®ç½‘ç»œæŒ‡æ ‡</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>instantaneous_input_kbps</strong>â€‹ï¼šç¬æ—¶è¾“å…¥å¸¦å®½</li>
<li>â€‹<strong>instantaneous_output_kbps</strong>â€‹ï¼šç¬æ—¶è¾“å‡ºå¸¦å®½</li>
<li>â€‹<strong>total_net_input_bytes</strong>â€‹ï¼šç´¯è®¡è¾“å…¥æµé‡</li>
<li>â€‹<strong>total_net_output_bytes</strong>â€‹ï¼šç´¯è®¡è¾“å‡ºæµé‡</li>
</ul>
<p>åƒå…†ç½‘å¡ç†è®ºæé™çº¦ 125MB/sï¼Œå½“ç½‘ç»œååæ¥è¿‘æé™æ—¶éœ€è€ƒè™‘åˆ†ç‰‡æˆ–å‡çº§ç½‘ç»œã€‚</p>
<h3 data-id="heading-14">4 æ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-15">4.1 æ…¢æŸ¥è¯¢è¯Šæ–­æ¡†æ¶</h4>
<p>æ…¢æŸ¥è¯¢æ˜¯ Redis æ€§èƒ½çš„å¸¸è§ç“¶é¢ˆï¼Œé€šè¿‡æ…¢æ—¥å¿—åŠŸèƒ½è¯†åˆ«ï¼š</p>
<p>â€‹<strong>æ…¢æŸ¥è¯¢é…ç½®ä¸æŸ¥çœ‹</strong>â€‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è®¾ç½®æ…¢æŸ¥è¯¢é˜ˆå€¼ï¼ˆå¾®ç§’ï¼‰</span>
CONFIG SET slowlog-log-slower-than <span class="hljs-number">10000</span>

<span class="hljs-comment"># è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—é•¿åº¦</span>
CONFIG SET slowlog-<span class="hljs-built_in">max</span>-<span class="hljs-built_in">len</span> <span class="hljs-number">128</span>

<span class="hljs-comment"># æŸ¥çœ‹æ…¢æŸ¥è¯¢</span>
SLOWLOG GET <span class="hljs-number">10</span>
â€‹
</code></pre>
<p>åŸºäºçš„æ…¢æŸ¥è¯¢é…ç½®</p>
<p>â€‹<strong>æ…¢æŸ¥è¯¢åˆ†æç»´åº¦</strong>â€‹ï¼š</p>
<ol>
<li>â€‹<strong>å‘½ä»¤ç±»å‹</strong>â€‹ï¼šè¯†åˆ«è€—æ—¶æœ€é«˜çš„å‘½ä»¤æ¨¡å¼</li>
<li>â€‹<strong>æ‰§è¡Œæ—¶é—´</strong>â€‹ï¼šåˆ†æå‘½ä»¤æ‰§è¡Œæ—¶é—´åˆ†å¸ƒ</li>
<li>â€‹<strong>å‘ç”Ÿé¢‘ç‡</strong>â€‹ï¼šç»Ÿè®¡æ…¢æŸ¥è¯¢å‘ç”Ÿé¢‘ç‡</li>
<li>â€‹<strong>æ—¶é—´è§„å¾‹</strong>â€‹ï¼šå¯»æ‰¾æ…¢æŸ¥è¯¢çš„æ—¶é—´è§„å¾‹</li>
</ol>
<h4 data-id="heading-16">4.2 å¸¸è§æ…¢æŸ¥è¯¢åœºæ™¯ä¸è§£å†³æ–¹æ¡ˆ</h4>
<p>â€‹<strong>å¤§ Key æ“ä½œ</strong>â€‹ï¼šæ‹†åˆ†è¶…è¿‡ 10KB çš„ String æˆ–å…ƒç´ è¶… 1000 çš„é›†åˆ</p>
<p>â€‹<strong>å¤æ‚è¿ç®—</strong>â€‹ï¼šé¿å…åœ¨ Redis å†…æ‰§è¡Œ O(N)å¤æ‚åº¦çš„æ“ä½œ</p>
<p>â€‹<strong>é˜»å¡å‘½ä»¤</strong>â€‹ï¼šè°¨æ…ä½¿ç”¨ BLPOPã€BRPOP ç­‰é˜»å¡å‘½ä»¤</p>
<p>ä¼˜åŒ–æ–¹æ¡ˆåŒ…æ‹¬â€‹<strong>æ•°æ®åˆ†ç‰‡</strong>â€‹ã€<strong>ç®¡é“åŒ–æ“ä½œ</strong>å‡å°‘ç½‘ç»œå¾€è¿”ï¼Œ<strong>Lua è„šæœ¬ä¼˜åŒ–</strong>å°†å¤šä¸ªæ“ä½œåˆå¹¶ã€‚</p>
<h3 data-id="heading-17">5 æŒä¹…åŒ–ä¸å¤åˆ¶ç›‘æ§</h3>
<h4 data-id="heading-18">5.1 æŒä¹…åŒ–å¥åº·åº¦æ£€æŸ¥</h4>
<p>æŒä¹…åŒ–å½±å“æ•°æ®å®‰å…¨ï¼Œéœ€å…³æ³¨å…³é”®æŒ‡æ ‡ï¼š</p>
<p>â€‹<strong>RDB æŒä¹…åŒ–ç›‘æ§</strong>â€‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥RDBçŠ¶æ€</span>
redis-cli info persistence
rdb_last_bgsave_status:ok    <span class="hljs-comment"># ä¸Šæ¬¡bgsaveçŠ¶æ€</span>
rdb_last_bgsave_time_sec:2    <span class="hljs-comment"># ä¸Šæ¬¡bgsaveè€—æ—¶</span>
latest_fork_usec:500          <span class="hljs-comment"># æœ€è¿‘forkè€—æ—¶(å¾®ç§’)</span>
â€‹
</code></pre>
<p>åŸºäºçš„æŒä¹…åŒ–ç›‘æ§</p>
<p>â€‹<strong>AOF æŒä¹…åŒ–ç›‘æ§</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>aof_last_bgrewrite_status</strong>â€‹ï¼šAOF é‡å†™çŠ¶æ€</li>
<li>â€‹<strong>aof_current_size</strong>â€‹ï¼šAOF å½“å‰å¤§å°</li>
<li>â€‹<strong>aof_base_size</strong>â€‹ï¼šAOF åŸºç¡€å¤§å°</li>
</ul>
<p>æŒä¹…åŒ–æ•…éšœé¢„è­¦ç‚¹åŒ…æ‹¬ bgsave å¤±è´¥ã€fork è€—æ—¶è¿‡é•¿ï¼ˆ&gt;1 ç§’ï¼‰ã€AOF é‡å†™å¼‚å¸¸ç­‰ã€‚</p>
<h4 data-id="heading-19">5.2 ä¸»ä»å¤åˆ¶å¥åº·ç›‘æ§</h4>
<p>å¤åˆ¶å»¶è¿Ÿå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œéœ€å¯†åˆ‡ç›‘æ§ï¼š</p>
<p>â€‹<strong>å¤åˆ¶çŠ¶æ€ç›‘æ§</strong>â€‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å¤åˆ¶ä¿¡æ¯</span>
redis-cli info replication
role:master                    <span class="hljs-comment"># å®ä¾‹è§’è‰²</span>
master_repl_offset:1000       <span class="hljs-comment"># ä¸»èŠ‚ç‚¹å¤åˆ¶åç§»é‡</span>
slave_repl_offset:980         <span class="hljs-comment"># ä»èŠ‚ç‚¹å¤åˆ¶åç§»é‡</span>
replica_backlog_histlen:100   <span class="hljs-comment"># å¤åˆ¶ç§¯å‹ç¼“å†²åŒºé•¿åº¦</span>
â€‹
</code></pre>
<p>åŸºäºçš„å¤åˆ¶ç›‘æ§</p>
<p>â€‹<strong>å¤åˆ¶å»¶è¿Ÿè®¡ç®—ä¸å‘Šè­¦</strong>â€‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è®¡ç®—å¤åˆ¶å»¶è¿Ÿ</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title">getReplicationLag</span><span class="hljs-params">(<span class="hljs-type">String</span> masterHost, <span class="hljs-type">int</span> masterPort)</span> </span>{
    <span class="hljs-type">long</span> masterOffset = <span class="hljs-built_in">getMasterOffset</span>(masterHost, masterPort);
    <span class="hljs-type">long</span> slaveOffset = <span class="hljs-built_in">getSlaveOffset</span>();
    <span class="hljs-keyword">return</span> masterOffset - slaveOffset;  <span class="hljs-comment">// å»¶è¿Ÿåç§»é‡</span>
}
â€‹
</code></pre>
<p>åŸºäºçš„å¤åˆ¶å»¶è¿Ÿè®¡ç®—</p>
<p>å¤åˆ¶å»¶è¿Ÿå‘Šè­¦é˜ˆå€¼å»ºè®®ï¼šâ€‹<strong>è­¦å‘Š</strong>â€‹&gt;10MBï¼Œâ€‹<strong>ä¸¥é‡</strong>â€‹&gt;100MBï¼Œâ€‹<strong>ç´§æ€¥</strong>â€‹&gt;1GBï¼ˆå¯èƒ½è§¦å‘å…¨é‡åŒæ­¥ï¼‰ã€‚</p>
<h3 data-id="heading-20">6 ç›‘æ§ç³»ç»Ÿå®æˆ˜éƒ¨ç½²</h3>
<h4 data-id="heading-21">6.1 Prometheus + Grafana ç›‘æ§æ ˆ</h4>
<p>ç°ä»£ç›‘æ§æ¨èä½¿ç”¨ Prometheus é‡‡é›†æ•°æ®ï¼ŒGrafana å±•ç¤ºï¼š</p>
<p>â€‹<strong>éƒ¨ç½² Redis Exporter</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.ymlç¤ºä¾‹</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">redis-exporter:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">oliver006/redis_exporter</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9121:9121"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">REDIS_ADDR=redis://redis:6379</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„ Exporter éƒ¨ç½²</p>
<p>â€‹<strong>Prometheus é…ç½®</strong>â€‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'redis'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'redis-exporter:9121'</span>]
    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„ Prometheus é…ç½®</p>
<h4 data-id="heading-22">6.2 å…³é”®å‘Šè­¦è§„åˆ™é…ç½®</h4>
<p>åŸºäº Prometheus çš„å‘Šè­¦è§„åˆ™ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">groups:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">redis.rules</span>
  <span class="hljs-attr">rules:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisDown</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">up{job="redis"}</span> <span class="hljs-string">==</span> <span class="hljs-number">0</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">1m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">critical</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Rediså®ä¾‹ä¸‹çº¿"</span>
      
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisMemoryUsageHigh</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">(redis_memory_used_bytes</span> <span class="hljs-string">/</span> <span class="hljs-string">redis_memory_max_bytes)</span> <span class="hljs-string">*</span> <span class="hljs-number">100</span> <span class="hljs-string">&gt;</span> <span class="hljs-number">85</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">2m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Rediså†…å­˜ä½¿ç”¨ç‡è¿‡é«˜"</span>
      
  <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">RedisHitRateLow</span>
    <span class="hljs-attr">expr:</span> <span class="hljs-string">(rate(redis_keyspace_hits_total[5m])</span> <span class="hljs-string">/</span> <span class="hljs-string">(rate(redis_keyspace_hits_total[5m])</span> <span class="hljs-string">+</span> <span class="hljs-string">rate(redis_keyspace_misses_total[5m])))</span> <span class="hljs-string">*</span> <span class="hljs-number">100</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">90</span>
    <span class="hljs-attr">for:</span> <span class="hljs-string">5m</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
    <span class="hljs-attr">annotations:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">"Redisç¼“å­˜å‘½ä¸­ç‡è¿‡ä½"</span>
<span class="hljs-string">â€‹</span>
</code></pre>
<p>åŸºäºçš„å‘Šè­¦è§„åˆ™</p>
<h3 data-id="heading-23">7 å®¹é‡è§„åˆ’ä¸é¢„è­¦å®æˆ˜</h3>
<h4 data-id="heading-24">7.1 å®¹é‡è§„åˆ’æ–¹æ³•è®º</h4>
<p>æœ‰æ•ˆçš„å®¹é‡è§„åˆ’åŸºäºå†å²æ•°æ®è¶‹åŠ¿åˆ†æï¼Œéœ€è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p>
<p>â€‹<strong>æ•°æ®å¢é•¿è¶‹åŠ¿</strong>â€‹ï¼šåˆ†ææ—¥å¸¸æ•°æ®å¢é‡ï¼Œé¢„æµ‹æœªæ¥å®¹é‡éœ€æ±‚</p>
<p>â€‹<strong>ä¸šåŠ¡å¢é•¿é¢„æœŸ</strong>â€‹ï¼šç»“åˆä¸šåŠ¡è§„åˆ’ï¼Œé¢„ä¼°è®¿é—®é‡å¢é•¿</p>
<p>â€‹<strong>å­£èŠ‚æ€§æ³¢åŠ¨</strong>â€‹ï¼šè¯†åˆ«ä¸šåŠ¡é«˜å³°æœŸï¼Œé¢„ç•™è¶³å¤Ÿç¼“å†²å®¹é‡</p>
<p>å®¹é‡è§„åˆ’å…¬å¼ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">æ‰€éœ€å®¹é‡ = å½“å‰æ•°æ®é‡ Ã— (<span class="hljs-number">1</span> + æœˆå¢é•¿ç‡)^æœˆä»½ + å®‰å…¨ä½™é‡(<span class="hljs-number">20%</span>)
â€‹
</code></pre>
<h4 data-id="heading-25">7.2 é¢„è­¦ç­‰çº§ä¸å“åº”æœºåˆ¶</h4>
<p>å»ºç«‹å¤šçº§é¢„è­¦æœºåˆ¶ï¼Œç¡®ä¿åŠæ—¶å“åº”ï¼š</p>
<p>â€‹<strong>ä¸‰çº§é¢„è­¦ä½“ç³»</strong>â€‹ï¼š</p>
<ul>
<li>â€‹<strong>é»„è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;80%ï¼‰ï¼šç›‘æ§å…³æ³¨ï¼Œæ¯å‘¨å›é¡¾</li>
<li>â€‹<strong>æ©™è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;90%ï¼‰ï¼šç«‹å³åˆ†æï¼Œ3 å¤©å†…å¤„ç†</li>
<li>â€‹<strong>çº¢è‰²é¢„è­¦</strong>â€‹ï¼ˆä½¿ç”¨ç‡ &gt;95%ï¼‰ï¼šç´§æ€¥å¤„ç†ï¼Œç«‹å³æ‰©å®¹</li>
</ul>
<h3 data-id="heading-26">æ€»ç»“</h3>
<p>Redis ç›‘æ§ä¸æ˜¯ç®€å•çš„æ•°æ®æ”¶é›†ï¼Œè€Œæ˜¯é€šè¿‡å…³é”®æŒ‡æ ‡æ´å¯Ÿç³»ç»ŸçŠ¶æ€çš„è‰ºæœ¯ã€‚æœ‰æ•ˆçš„ç›‘æ§ä½“ç³»åº”èšç„¦<strong>å»¶è¿Ÿã€å‘½ä¸­ç‡ã€å†…å­˜ç¢ç‰‡ã€æ…¢æŸ¥è¯¢</strong>ç­‰æ ¸å¿ƒæŒ‡æ ‡ï¼Œå»ºç«‹<strong>å¤šçº§é¢„è­¦</strong>æœºåˆ¶ï¼Œå®ç°ä»è¢«åŠ¨æ•‘ç«åˆ°ä¸»åŠ¨é¢„é˜²çš„è½¬å˜ã€‚</p>
<p>ç›‘æ§çš„ä»·å€¼ä¸ä»…åœ¨äºå®æ—¶å‘Šè­¦ï¼Œæ›´åœ¨äºæä¾›<strong>å®¹é‡è§„åˆ’</strong>çš„æ•°æ®æ”¯æ’‘å’Œ<strong>æ€§èƒ½ä¼˜åŒ–</strong>çš„å†³ç­–ä¾æ®ã€‚é€šè¿‡å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼ŒRedis è¿ç»´å›¢é˜Ÿèƒ½å¤Ÿæå‰å‘ç°æ½œåœ¨é£é™©ï¼Œä¼˜åŒ–èµ„æºé…ç½®ï¼Œç¡®ä¿ç¼“å­˜ç³»ç»ŸæŒç»­ç¨³å®šè¿è¡Œã€‚</p>
<p><strong>ç›‘æ§çš„ç»ˆæç›®æ ‡ä¸æ˜¯æ”¶é›†æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®é©±åŠ¨å†³ç­–ï¼Œå°†é—®é¢˜æ¶ˆç­åœ¨å‘ç”Ÿä¹‹å‰ã€‚</strong></p>
<p><strong>ğŸ“š ä¸‹ç¯‡é¢„å‘Š</strong>â€‹</p>
<p>ã€ŠMQ é€‰å‹æ¡†æ¶â€”â€”Kafka/RabbitMQ/RocketMQ çš„æ¨¡å‹å·®å¼‚ä¸ä¸šåŠ¡åŒ¹é…æ¸…å•ã€‹â€”â€” æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>ğŸ“¨ â€‹<strong>æ¶ˆæ¯æ¨¡å‹å¯¹æ¯”</strong>â€‹ï¼šå‘å¸ƒ-è®¢é˜…ã€ç‚¹å¯¹ç‚¹ã€äº‹åŠ¡æ¶ˆæ¯çš„é€‚ç”¨åœºæ™¯åˆ†æ</li>
<li>ğŸš€ â€‹<strong>ååæ€§èƒ½åŸºå‡†</strong>â€‹ï¼šç™¾ä¸‡çº§æ¶ˆæ¯ååçš„æ¶æ„è®¾è®¡ä¸ä¼˜åŒ–ç­–ç•¥</li>
<li>ğŸ’¾ â€‹<strong>å¯é æ€§ä¿éšœ</strong>â€‹ï¼šæ¶ˆæ¯æŒä¹…åŒ–ã€å‰¯æœ¬åŒæ­¥ä¸æ•…éšœæ¢å¤æœºåˆ¶</li>
<li>ğŸ“Š â€‹<strong>è¿ç»´å¤æ‚åº¦è¯„ä¼°</strong>â€‹ï¼šé›†ç¾¤ç®¡ç†ã€ç›‘æ§å‘Šè­¦ä¸æ‰©å±•æ€§å¯¹æ¯”</li>
<li>ğŸ¯ â€‹<strong>é€‰å‹å†³ç­–çŸ©é˜µ</strong>â€‹ï¼šä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹çš„æŠ€æœ¯é€‰å‹æ ‡å‡†æŒ‡å—</li>
</ul>
<p><strong>â€‹ç‚¹å‡»å…³æ³¨ï¼ŒæŒæ¡æ¶ˆæ¯ä¸­é—´ä»¶é€‰å‹çš„æ ¸å¿ƒæ–¹æ³•è®ºï¼â€‹</strong>â€‹</p>
<blockquote>
<p>â€‹<strong>ä»Šæ—¥è¡ŒåŠ¨å»ºè®®</strong>â€‹ï¼š</p>
<ol>
<li>æ£€æŸ¥ç°æœ‰ Redis ç›‘æ§è¦†ç›–åº¦ï¼Œç¡®ä¿å…³é”®æŒ‡æ ‡æ— é—æ¼</li>
<li>é…ç½®å¤šçº§é¢„è­¦é˜ˆå€¼ï¼Œå»ºç«‹é¢„è­¦å“åº”æµç¨‹</li>
<li>åˆ†æå†å²å®¹é‡æ•°æ®ï¼Œåˆ¶å®šæœªæ¥ 3-6 ä¸ªæœˆæ‰©å®¹è§„åˆ’</li>
<li>å»ºç«‹æ…¢æŸ¥è¯¢å®šæœŸåˆ†ææœºåˆ¶ï¼ŒæŒç»­ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ</li>
</ol>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²]]></title>    <link>https://juejin.cn/post/7585555806667653154</link>    <guid>https://juejin.cn/post/7585555806667653154</guid>    <pubDate>2025-12-21T08:07:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585555806667653154" data-draft-id="7585555806667472930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-21T08:07:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­¦é«˜æ•°å°±çŠ¯å›°"/> <meta itemprop="url" content="https://juejin.cn/user/54353143012724"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React + Viteï¼šç”¨Fetchå°†.csvå¤§æ–‡ä»¶æ•°æ®è½¬æˆJSONå­—ç¬¦ä¸²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/54353143012724/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­¦é«˜æ•°å°±çŠ¯å›°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-21T08:07:11.000Z" title="Sun Dec 21 2025 08:07:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-21
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ React + Viteï¼šç”¨ Fetch å°† CSV æ–‡ä»¶æ•°æ®è½¬æˆ JSON å­—ç¬¦ä¸²</h2>
<h4 data-id="heading-1">ğŸ• èƒŒæ™¯</h4>
<p>åœ¨ä¸€äº›å°å‹é¡¹ç›®ä¸­ï¼Œå‰ç«¯å¯èƒ½éœ€è¦ç›´æ¥å¤„ç† CSV æ–‡ä»¶æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²åå†è¿›è¡Œé€»è¾‘æ“ä½œå’Œå±•ç¤ºã€‚æœ¬æ–‡å°†ä¼šä»‹ç»ä¸¤ç§æ–¹æ³•ã€‚</p>
<h4 data-id="heading-2">ğŸŒ„ æ–¹æ³•1ï¼šå°† CSV æ”¾åœ¨<code>public</code>ç›®å½•ä¸‹ï¼Œç”¨<code>fetch</code>è¯»å–</h4>
<h5 data-id="heading-3">ä»£ç å®ç°</h5>
<p>å·¥å…·å‡½æ•°ï¼šcsv -&gt; json</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/utils/csvParser.jsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">csvParser</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">{ file }</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> resp = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(file);
    <span class="hljs-keyword">if</span> (!resp.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${resp.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> resp.<span class="hljs-title function_">text</span>(); <span class="hljs-comment">// è½¬æˆæ–‡æœ¬</span>
    <span class="hljs-keyword">const</span> lines = text.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/\r?\n/</span>); <span class="hljs-comment">// æ¯ä¸€è¡Œä½œä¸ºæ•°ç»„ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">const</span> header = lines[<span class="hljs-number">0</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">","</span>); <span class="hljs-comment">// æŠŠè¡¨å¤´å•ç‹¬æå–å‡ºæ¥</span>

    <span class="hljs-keyword">const</span> data = lines.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">line</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> values = line.<span class="hljs-title function_">split</span>(<span class="hljs-string">","</span>); <span class="hljs-comment">// å…·ä½“æ¯ä¸€è¡Œæ•°æ®çš„å€¼</span>
      <span class="hljs-keyword">const</span> row = {}; <span class="hljs-comment">// æœ€ç»ˆæ•°æ®ä¸‹çš„é€è¡Œçš„è½½ä½“</span>
      header.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">h, i</span>) =&gt;</span> {
        row[h] = values[i] ?? <span class="hljs-string">""</span>;
      });
      <span class="hljs-keyword">return</span> row;
    });
    <span class="hljs-keyword">return</span> data;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);
    <span class="hljs-keyword">return</span> [];
  }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> csvParser;
</code></pre>
<p>åœ¨ React ä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/pages/Home.jsx</span>
<span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { csvParser } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadcsv</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">csvParser</span>({ <span class="hljs-attr">file</span>: <span class="hljs-string">"/testInfo.csv"</span> });
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
  };
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">loadcsv</span>();
  }, []);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Home</span>;
</code></pre>
<h5 data-id="heading-4">æ³¨æ„äº‹é¡¹</h5>
<p>æˆ‘ä»¬åº”è¯¥å°†æ‰€éœ€è¦çš„ CSV æ–‡ä»¶æ”¾åœ¨<code>public</code>ç›®å½•ä¸‹è€Œé<code>src/assets</code>ç›®å½•ä¸‹ï¼Œé‡‡å–ç›´æ¥è°ƒç”¨ã€‚</p>
<blockquote>
<p>å½“ CSV æ”¾åœ¨<code>src/assets</code>ä¸‹å¹¶é€šè¿‡<code>import</code>æˆ–æ¨¡å—æ–¹å¼åŠ è½½æ—¶ï¼Œ Vite ä¼šå°†å…¶æ‰“åŒ…æˆæ¨¡å—è·¯å¾„ï¼Œ<code>fetch</code>å®é™…è¯·æ±‚çš„æ˜¯å¼€å‘æœåŠ¡å™¨çš„æ¨¡å—å…¥å£ã€‚å¯¹äºå¤§æ–‡ä»¶ï¼Œè¿™ä¼šå¯¼è‡´è¯·æ±‚å¤´ä¸­åŒ…å«è¿‡å¤šä¿¡æ¯ï¼Œä»è€Œè§¦å‘ 431 é”™è¯¯ã€‚</p>
</blockquote>
<p>P.S. å¦‚æœå¿˜è®°äº†<code>fetch</code>çš„å…·ä½“ç”¨æ³•...<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1ahBwBWEa9%3Fvd_source%3D5efd67697f12ad6e7903bc924c0815ba" target="_blank" title="https://www.bilibili.com/video/BV1ahBwBWEa9?vd_source=5efd67697f12ad6e7903bc924c0815ba" ref="nofollow noopener noreferrer">ä¼ é€é—¨</a></p>
<h4 data-id="heading-5">ğŸŒ„ æ–¹æ³•2ï¼šåˆ©ç”¨ Rollup æ’ä»¶ç›´æ¥ <code>import</code> CSV</h4>
<p>ç”±äº Vite çš„åº•å±‚æ„å»ºå¼•æ“åŒ…å« Rollupï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ Rollup çš„å®˜æ–¹æ’ä»¶ç”Ÿæ€æ¥æ‰©å±•åŠŸèƒ½ï¼Œç›´æ¥å°† CSV æ–‡ä»¶ä½œä¸ºæ¨¡å—å¯¼å…¥ã€‚</p>
<h5 data-id="heading-6">ä»£ç å®ç°</h5>
<p>å®‰è£…å¼€å‘ä¾èµ–ï¼š</p>
<pre><code class="hljs language-css" lang="css">npm <span class="hljs-selector-tag">i</span> -D <span class="hljs-keyword">@rollup</span>/plugin-dsv
</code></pre>
<p>é…ç½®vite</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> react <span class="hljs-keyword">from</span> <span class="hljs-string">"@vitejs/plugin-react"</span>;
<span class="hljs-keyword">import</span> dsv <span class="hljs-keyword">from</span> <span class="hljs-string">"@rollup/plugin-dsv"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;

<span class="hljs-comment">// https://vite.dev/config/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">react</span>(), <span class="hljs-title function_">dsv</span>()],
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">"@"</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"src"</span>),
    },
  },
});
</code></pre>
<p>åœ¨ React ä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/pages/Home.jsx</span>
<span class="hljs-keyword">import</span> data <span class="hljs-keyword">from</span> <span class="hljs-string">"@/assets/testInfo.csv"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Home</span>;
</code></pre>
<h5 data-id="heading-7">æ³¨æ„äº‹é¡¹</h5>
<p>é€‚ç”¨äºå°æ–‡ä»¶ï¼Œè¾ƒå¤§æ–‡ä»¶ã€å…³æ³¨æ€§èƒ½çš„è¯è¿˜æ˜¯æ›´æ¨èä½¿ç”¨ç¬¬ä¸€ç§ã€‚</p>
<h4 data-id="heading-8">ğŸš‰ ç»“è¯­</h4>
<p>åœ¨ React + Vite é¡¹ç›®ä¸­å¤„ç† CSV æ–‡ä»¶æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„åŠ è½½æ–¹å¼éå¸¸é‡è¦ï¼š</p>
<ul>
<li>å°æ–‡ä»¶ï¼šå¯ä»¥ç›´æ¥é€šè¿‡ <code>import</code> å¯¼å…¥ï¼Œå¼€å‘å¿«é€Ÿæ–¹ä¾¿ã€‚</li>
<li>å¤§æ–‡ä»¶ï¼šæ¨èæ”¾åœ¨ <code>public</code> ç›®å½•ï¼Œç”¨ <code>fetch</code> å¼‚æ­¥åŠ è½½ï¼Œå¹¶ç»“åˆåˆ†é¡µæˆ–è™šæ‹Ÿæ¸²æŸ“ï¼Œä¿è¯æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</li>
</ul>
<p>æŒæ¡è¿™ä¸¤ç§æ–¹æ³•åï¼Œä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚çµæ´»å¤„ç†ä¸åŒè§„æ¨¡çš„ CSV æ•°æ®ï¼Œè®©å‰ç«¯æ•°æ®å¤„ç†æ—¢é«˜æ•ˆåˆå®‰å…¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>