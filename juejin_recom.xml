<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Docker å…¥é—¨å®æˆ˜ï¼šç”¨10ä¸ªæ¡ˆä¾‹å¸¦ä½ ç©è½¬å®¹å™¨åŒ–]]></title>    <link>https://juejin.cn/post/7571840220703064110</link>    <guid>https://juejin.cn/post/7571840220703064110</guid>    <pubDate>2025-11-13T04:07:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571840220703064110" data-draft-id="7570940025580994600" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Docker å…¥é—¨å®æˆ˜ï¼šç”¨10ä¸ªæ¡ˆä¾‹å¸¦ä½ ç©è½¬å®¹å™¨åŒ–"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-11-13T04:07:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LCGå…ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/3097802498120889"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Docker å…¥é—¨å®æˆ˜ï¼šç”¨10ä¸ªæ¡ˆä¾‹å¸¦ä½ ç©è½¬å®¹å™¨åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097802498120889/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LCGå…ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T04:07:55.000Z" title="Thu Nov 13 2025 04:07:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. Docker ç¯å¢ƒå®‰è£…ä¸é…ç½®</h2>
<h3 data-id="heading-1">1.1 åœ¨ Ubuntu ç³»ç»Ÿä¸Šå®‰è£… Docker</h3>
<p>åˆ›å»ºå®‰è£…è„šæœ¬æ–‡ä»¶ï¼š<code>install_docker.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># æ›´æ–°ç³»ç»ŸåŒ…åˆ—è¡¨</span>
sudo apt-get update

<span class="hljs-comment"># å®‰è£…å¿…è¦çš„ä¾èµ–åŒ…</span>
sudo apt-get install -y \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

<span class="hljs-comment"># æ·»åŠ  Docker å®˜æ–¹ GPG å¯†é’¥</span>
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

<span class="hljs-comment"># æ·»åŠ  Docker ç¨³å®šç‰ˆä»“åº“</span>
<span class="hljs-built_in">echo</span> \
  <span class="hljs-string">"deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
  <span class="hljs-subst">$(lsb_release -cs)</span> stable"</span> | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null

<span class="hljs-comment"># æ›´æ–°åŒ…åˆ—è¡¨ï¼ˆåŒ…å« Docker ä»“åº“ï¼‰</span>
sudo apt-get update

<span class="hljs-comment"># å®‰è£… Docker Engine</span>
sudo apt-get install -y docker-ce docker-ce-cli containerd.io

<span class="hljs-comment"># å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ° docker ç»„ï¼ˆé¿å…æ¯æ¬¡ä½¿ç”¨ sudoï¼‰</span>
sudo usermod -aG docker <span class="hljs-variable">$USER</span>

<span class="hljs-comment"># å¯åŠ¨ Docker æœåŠ¡</span>
sudo systemctl start docker
sudo systemctl <span class="hljs-built_in">enable</span> docker

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
docker --version
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Docker å®‰è£…å®Œæˆï¼è¯·é‡æ–°ç™»å½•ä»¥ä½¿ç»„æƒé™ç”Ÿæ•ˆã€‚"</span>
</code></pre>
<h3 data-id="heading-2">1.2 Docker åŸºç¡€é…ç½®</h3>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š<code>docker_daemon.json</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"registry-mirrors"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"https://docker.mirrors.ustc.edu.cn"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"https://hub-mirror.c.163.com"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"log-driver"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"json-file"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"log-opts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"max-size"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"100m"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"max-file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data-root"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/var/lib/docker"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"storage-driver"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"overlay2"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åº”ç”¨é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»º docker é…ç½®ç›®å½•</span>
sudo <span class="hljs-built_in">mkdir</span> -p /etc/docker

<span class="hljs-comment"># å¤åˆ¶é…ç½®æ–‡ä»¶</span>
sudo <span class="hljs-built_in">cp</span> docker_daemon.json /etc/docker/daemon.json

<span class="hljs-comment"># é‡å¯ docker æœåŠ¡</span>
sudo systemctl daemon-reload
sudo systemctl restart docker

<span class="hljs-comment"># éªŒè¯é…ç½®</span>
docker info
</code></pre>
<h2 data-id="heading-3">2. Docker åŸºç¡€æ¦‚å¿µä¸å‘½ä»¤</h2>
<h3 data-id="heading-4">2.1 Docker æ ¸å¿ƒç»„ä»¶ç†è§£</h3>
<p>åˆ›å»ºå­¦ä¹ æ–‡æ¡£ï¼š<code>docker_concepts.md</code></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Docker æ ¸å¿ƒæ¦‚å¿µ</span>

<span class="hljs-section">## é•œåƒ (Image)</span>
<span class="hljs-bullet">-</span> åªè¯»æ¨¡æ¿ï¼Œç”¨äºåˆ›å»ºå®¹å™¨
<span class="hljs-bullet">-</span> åˆ†å±‚å­˜å‚¨ç»“æ„
<span class="hljs-bullet">-</span> åŒ…å«è¿è¡Œåº”ç”¨æ‰€éœ€çš„æ‰€æœ‰å†…å®¹

<span class="hljs-section">## å®¹å™¨ (Container)</span>
<span class="hljs-bullet">-</span> é•œåƒçš„è¿è¡Œå®ä¾‹
<span class="hljs-bullet">-</span> å…·æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå’Œè¿›ç¨‹ç©ºé—´
<span class="hljs-bullet">-</span> å¯å†™å±‚åœ¨åªè¯»é•œåƒå±‚ä¹‹ä¸Š

<span class="hljs-section">## ä»“åº“ (Registry)</span>
<span class="hljs-bullet">-</span> å­˜å‚¨å’Œåˆ†å‘é•œåƒçš„åœ°æ–¹
<span class="hljs-bullet">-</span> Docker Hub æ˜¯å®˜æ–¹å…¬å…±ä»“åº“
<span class="hljs-bullet">-</span> å¯ä»¥æ­å»ºç§æœ‰ä»“åº“
</code></pre>
<h3 data-id="heading-5">2.2 åŸºç¡€å‘½ä»¤ç»ƒä¹ </h3>
<p>åˆ›å»ºç»ƒä¹ è„šæœ¬ï¼š<code>basic_commands.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># æŸ¥çœ‹ Docker ç‰ˆæœ¬ä¿¡æ¯</span>
docker version

<span class="hljs-comment"># æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</span>
docker info

<span class="hljs-comment"># æœç´¢é•œåƒ</span>
docker search nginx

<span class="hljs-comment"># æ‹‰å–é•œåƒ</span>
docker pull nginx:latest

<span class="hljs-comment"># æŸ¥çœ‹æœ¬åœ°é•œåƒ</span>
docker images

<span class="hljs-comment"># è¿è¡Œå®¹å™¨ï¼ˆå‰å°è¿è¡Œï¼‰</span>
docker run -it --name my-nginx nginx:latest

<span class="hljs-comment"># è¿è¡Œå®¹å™¨ï¼ˆåå°è¿è¡Œï¼‰</span>
docker run -d --name my-nginx-background -p 8080:80 nginx:latest

<span class="hljs-comment"># æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span>
docker ps

<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢çš„ï¼‰</span>
docker ps -a

<span class="hljs-comment"># åœæ­¢å®¹å™¨</span>
docker stop my-nginx-background

<span class="hljs-comment"># å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨</span>
docker start my-nginx-background

<span class="hljs-comment"># é‡å¯å®¹å™¨</span>
docker restart my-nginx-background

<span class="hljs-comment"># è¿›å…¥å®¹å™¨å†…éƒ¨</span>
docker <span class="hljs-built_in">exec</span> -it my-nginx-background bash

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨æ—¥å¿—</span>
docker logs my-nginx-background

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</span>
docker inspect my-nginx-background

<span class="hljs-comment"># åˆ é™¤å®¹å™¨</span>
docker <span class="hljs-built_in">rm</span> my-nginx-background

<span class="hljs-comment"># åˆ é™¤é•œåƒ</span>
docker rmi nginx:latest
</code></pre>
<h2 data-id="heading-6">3. ç¬¬ä¸€ä¸ª Docker åº”ç”¨ï¼šHello World</h2>
<h3 data-id="heading-7">3.1 åˆ›å»ºç®€å•çš„ Web åº”ç”¨</h3>
<p>åˆ›å»ºåº”ç”¨æ–‡ä»¶ï¼š<code>app.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> socket

app = Flask(__name__)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">hello</span>():
    container_id = socket.gethostname()
    <span class="hljs-keyword">return</span> <span class="hljs-string">f'''
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Docker Hello World&lt;/title&gt;
        &lt;style&gt;
            body {{
                font-family: Arial, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                margin: 0;
                padding: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                color: white;
            }}
            .container {{
                text-align: center;
                background: rgba(255, 255, 255, 0.1);
                padding: 40px;
                border-radius: 15px;
                backdrop-filter: blur(10px);
            }}
            h1 {{
                font-size: 2.5em;
                margin-bottom: 20px;
            }}
            p {{
                font-size: 1.2em;
                margin: 10px 0;
            }}
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class="container"&gt;
            &lt;h1&gt;ğŸš€ Docker Hello World!&lt;/h1&gt;
            &lt;p&gt;&lt;strong&gt;å®¹å™¨ID:&lt;/strong&gt; <span class="hljs-subst">{container_id}</span>&lt;/p&gt;
            &lt;p&gt;&lt;strong&gt;ç¯å¢ƒ:&lt;/strong&gt; Python Flask in Docker&lt;/p&gt;
            &lt;p&gt;ğŸ‰ æ­å–œï¼ä½ çš„ç¬¬ä¸€ä¸ªDockeråº”ç”¨è¿è¡ŒæˆåŠŸï¼&lt;/p&gt;
        &lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    '''</span>

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/health'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">health</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'status'</span>: <span class="hljs-string">'healthy'</span>, <span class="hljs-string">'service'</span>: <span class="hljs-string">'hello-world'</span>}

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">True</span>)
</code></pre>
<h3 data-id="heading-8">3.2 åˆ›å»º Dockerfile</h3>
<p>åˆ›å»º Dockerfile æ–‡ä»¶ï¼š<code>Dockerfile</code></p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># ä½¿ç”¨å®˜æ–¹ Python è¿è¡Œæ—¶ä½œä¸ºåŸºç¡€é•œåƒ
FROM python:3.9-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶å½“å‰ç›®å½•å†…å®¹åˆ°å®¹å™¨çš„ /app ç›®å½•
COPY . /app

# å®‰è£…ä¾èµ–
RUN pip install --no-cache-dir flask

# æš´éœ²ç«¯å£
EXPOSE 5000

# å®šä¹‰ç¯å¢ƒå˜é‡
ENV NAME World

# å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œåº”ç”¨
CMD ["python", "app.py"]
</code></pre>
<h3 data-id="heading-9">3.3 æ„å»ºå’Œè¿è¡Œåº”ç”¨</h3>
<p>åˆ›å»ºæ„å»ºè„šæœ¬ï¼š<code>build_and_run.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># æ„å»º Docker é•œåƒ</span>
docker build -t hello-world-app .

<span class="hljs-comment"># è¿è¡Œå®¹å™¨</span>
docker run -d -p 5000:5000 --name hello-container hello-world-app

<span class="hljs-comment"># æ£€æŸ¥å®¹å™¨çŠ¶æ€</span>
docker ps

<span class="hljs-comment"># æŸ¥çœ‹æ—¥å¿—</span>
docker logs hello-container

<span class="hljs-built_in">echo</span> <span class="hljs-string">"åº”ç”¨å·²å¯åŠ¨ï¼è®¿é—® http://localhost:5000 æŸ¥çœ‹ç»“æœ"</span>
</code></pre>
<h2 data-id="heading-10">4. Docker å®¹å™¨ç½‘ç»œé…ç½®</h2>
<h3 data-id="heading-11">4.1 ç½‘ç»œåŸºç¡€æ“ä½œ</h3>
<p>åˆ›å»ºç½‘ç»œæ“ä½œè„šæœ¬ï¼š<code>network_demo.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># æŸ¥çœ‹ç½‘ç»œåˆ—è¡¨</span>
docker network <span class="hljs-built_in">ls</span>

<span class="hljs-comment"># åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ</span>
docker network create --driver bridge my-custom-network

<span class="hljs-comment"># æŸ¥çœ‹ç½‘ç»œè¯¦æƒ…</span>
docker network inspect my-custom-network

<span class="hljs-comment"># åœ¨è‡ªå®šä¹‰ç½‘ç»œä¸­è¿è¡Œå®¹å™¨</span>
docker run -d --name web1 --network my-custom-network nginx:alpine
docker run -d --name web2 --network my-custom-network nginx:alpine

<span class="hljs-comment"># æµ‹è¯•å®¹å™¨é—´é€šä¿¡</span>
docker <span class="hljs-built_in">exec</span> web1 ping web2

<span class="hljs-comment"># åˆ›å»ºå¦ä¸€ä¸ªç½‘ç»œ</span>
docker network create --driver bridge another-network

<span class="hljs-comment"># å°†å®¹å™¨è¿æ¥åˆ°å¤šä¸ªç½‘ç»œ</span>
docker network connect another-network web1

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨çš„ç½‘ç»œé…ç½®</span>
docker inspect web1 | grep -A 10 <span class="hljs-string">"Networks"</span>

<span class="hljs-comment"># æ–­å¼€ç½‘ç»œè¿æ¥</span>
docker network disconnect another-network web1

<span class="hljs-comment"># æ¸…ç†</span>
docker stop web1 web2
docker <span class="hljs-built_in">rm</span> web1 web2
docker network <span class="hljs-built_in">rm</span> my-custom-network another-network
</code></pre>
<h3 data-id="heading-12">4.2 å¤šå®¹å™¨åº”ç”¨ç½‘ç»œé…ç½®</h3>
<p>åˆ›å»ºå¤šå®¹å™¨åº”ç”¨æ–‡ä»¶ï¼š<code>docker-compose-network.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">web:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">nginx-web</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:80"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">frontend</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">api</span>

  <span class="hljs-attr">api:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">python:3.9-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">python-api</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">python</span> <span class="hljs-string">-m</span> <span class="hljs-string">http.server</span> <span class="hljs-number">8000</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">frontend</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>
    <span class="hljs-attr">working_dir:</span> <span class="hljs-string">/app</span>

  <span class="hljs-attr">database:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:13-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">postgres-db</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">POSTGRES_DB:</span> <span class="hljs-string">myapp</span>
      <span class="hljs-attr">POSTGRES_USER:</span> <span class="hljs-string">user</span>
      <span class="hljs-attr">POSTGRES_PASSWORD:</span> <span class="hljs-string">password</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db_data:/var/lib/postgresql/data</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">frontend:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
  <span class="hljs-attr">backend:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">db_data:</span>
</code></pre>
<p>è¿è¡Œå¤šå®¹å™¨åº”ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker-compose -f docker-compose-network.yml up -d
docker network <span class="hljs-built_in">ls</span>
docker-compose -f docker-compose-network.yml down
</code></pre>
<h2 data-id="heading-13">5. Docker æ•°æ®æŒä¹…åŒ–</h2>
<h3 data-id="heading-14">5.1 æ•°æ®å·æ“ä½œ</h3>
<p>åˆ›å»ºæ•°æ®å·ç®¡ç†è„šæœ¬ï¼š<code>volume_management.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># åˆ›å»ºæ•°æ®å·</span>
docker volume create my-data

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®å·åˆ—è¡¨</span>
docker volume <span class="hljs-built_in">ls</span>

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®å·è¯¦æƒ…</span>
docker volume inspect my-data

<span class="hljs-comment"># ä½¿ç”¨æ•°æ®å·è¿è¡Œå®¹å™¨</span>
docker run -d \
  --name mysql-container \
  -e MYSQL_ROOT_PASSWORD=password \
  -e MYSQL_DATABASE=testdb \
  -v my-data:/var/lib/mysql \
  mysql:8.0

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®å·ä½¿ç”¨æƒ…å†µ</span>
docker <span class="hljs-built_in">exec</span> mysql-container <span class="hljs-built_in">df</span> -h

<span class="hljs-comment"># åˆ›å»ºå¤‡ä»½å·</span>
docker volume create backup-data

<span class="hljs-comment"># ä½¿ç”¨ä¸´æ—¶å®¹å™¨å¤‡ä»½æ•°æ®</span>
docker run --<span class="hljs-built_in">rm</span> \
  -v my-data:/source \
  -v backup-data:/backup \
  alpine tar czf /backup/mysql-backup.tar.gz -C /source .

<span class="hljs-comment"># æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶</span>
docker run --<span class="hljs-built_in">rm</span> -v backup-data:/backup alpine <span class="hljs-built_in">ls</span> -lh /backup

<span class="hljs-comment"># æ¸…ç†</span>
docker stop mysql-container
docker <span class="hljs-built_in">rm</span> mysql-container
docker volume <span class="hljs-built_in">rm</span> my-data backup-data
</code></pre>
<h3 data-id="heading-15">5.2 ç»‘å®šæŒ‚è½½å®æˆ˜</h3>
<p>åˆ›å»ºç»‘å®šæŒ‚è½½ç¤ºä¾‹ï¼š<code>bind_mount_demo.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># åˆ›å»ºæœ¬åœ°ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p /home/<span class="hljs-variable">$USER</span>/docker-data/website
<span class="hljs-built_in">mkdir</span> -p /home/<span class="hljs-variable">$USER</span>/docker-data/config

<span class="hljs-comment"># åˆ›å»ºç¤ºä¾‹ç½‘ç«™æ–‡ä»¶</span>
<span class="hljs-built_in">cat</span> &gt; /home/<span class="hljs-variable">$USER</span>/docker-data/website/index.html &lt;&lt; <span class="hljs-string">'EOF'</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;<span class="hljs-built_in">head</span>&gt;
    &lt;title&gt;Bind Mount Demo&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(45deg, <span class="hljs-comment">#ff6b6b, #4ecdc4);</span>
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
        }
        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=<span class="hljs-string">"container"</span>&gt;
        &lt;h1&gt;ğŸ¯ Bind Mount æ¼”ç¤º&lt;/h1&gt;
        &lt;p&gt;è¿™ä¸ªé¡µé¢æ¥è‡ªå®¿ä¸»æœºçš„ç›®å½•ï¼&lt;/p&gt;
        &lt;p&gt;å®æ—¶ä¿®æ”¹ host çš„æ–‡ä»¶ä¼šç«‹å³åæ˜ åœ¨å®¹å™¨ä¸­&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
EOF

<span class="hljs-comment"># ä½¿ç”¨ç»‘å®šæŒ‚è½½è¿è¡Œ Nginx</span>
docker run -d \
  --name nginx-bind-mount \
  -p 8081:80 \
  -v /home/<span class="hljs-variable">$USER</span>/docker-data/website:/usr/share/nginx/html \
  nginx:alpine

<span class="hljs-built_in">echo</span> <span class="hljs-string">"è®¿é—® http://localhost:8081 æŸ¥çœ‹ç»‘å®šæŒ‚è½½çš„ç½‘ç«™"</span>

<span class="hljs-comment"># å®æ—¶ä¿®æ”¹æµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"&lt;p&gt;ğŸš€ å®æ—¶æ›´æ–°æµ‹è¯•æˆåŠŸï¼&lt;/p&gt;"</span> &gt;&gt; /home/<span class="hljs-variable">$USER</span>/docker-data/website/index.html

<span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨ä¸­çš„æ–‡ä»¶å˜åŒ–</span>
docker <span class="hljs-built_in">exec</span> nginx-bind-mount <span class="hljs-built_in">cat</span> /usr/share/nginx/html/index.html

<span class="hljs-comment"># æ¸…ç†</span>
docker stop nginx-bind-mount
docker <span class="hljs-built_in">rm</span> nginx-bind-mount
</code></pre>
<h2 data-id="heading-16">6. Dockerfile æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-17">6.1 ä¼˜åŒ– Dockerfile</h3>
<p>åˆ›å»ºä¼˜åŒ–åçš„ Dockerfileï¼š<code>optimized.Dockerfile</code></p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># å¤šé˜¶æ®µæ„å»ºç¤ºä¾‹
# é˜¶æ®µ1: æ„å»ºé˜¶æ®µ
FROM python:3.9-slim as builder

WORKDIR /app

# å¤åˆ¶ requirements æ–‡ä»¶
COPY requirements.txt .

# å®‰è£…æ„å»ºä¾èµ–å’Œ Python åŒ…
RUN apt-get update &amp;&amp; apt-get install -y \
    gcc \
    g++ \
    &amp;&amp; pip install --user -r requirements.txt \
    &amp;&amp; apt-get remove -y gcc g++ \
    &amp;&amp; apt-get autoremove -y \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# é˜¶æ®µ2: è¿è¡Œé˜¶æ®µ
FROM python:3.9-slim

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1 \
    PIP_NO_CACHE_DIR=1

WORKDIR /app

# åˆ›å»ºérootç”¨æˆ·
RUN groupadd -r appuser &amp;&amp; useradd -r -g appuser appuser

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶å·²å®‰è£…çš„åŒ…
COPY --from=builder /root/.local /home/appuser/.local
COPY --chown=appuser:appuser . .

# è®¾ç½®è·¯å¾„å’Œérootç”¨æˆ·
ENV PATH=/home/appuser/.local/bin:$PATH
USER appuser

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:5000/health || exit 1

# æš´éœ²ç«¯å£
EXPOSE 5000

# å¯åŠ¨å‘½ä»¤
CMD ["python", "app.py"]
</code></pre>
<p>åˆ›å»º requirements æ–‡ä»¶ï¼š<code>requirements.txt</code></p>
<pre><code class="hljs language-txt" lang="txt">Flask==2.3.3
requests==2.31.0
gunicorn==21.2.0
</code></pre>
<h3 data-id="heading-18">6.2 å¤šé˜¶æ®µæ„å»ºå®æˆ˜</h3>
<p>åˆ›å»ºå¤šé˜¶æ®µæ„å»ºç¤ºä¾‹ï¼š<code>multi-stage.Dockerfile</code></p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># å¤šé˜¶æ®µæ„å»ºï¼šGo åº”ç”¨ç¤ºä¾‹

# é˜¶æ®µ1: æ„å»ºé˜¶æ®µ
FROM golang:1.19-alpine as builder

WORKDIR /app

# ä¸‹è½½ä¾èµ–
COPY go.mod go.sum ./
RUN go mod download

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨
RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .

# é˜¶æ®µ2: è¿è¡Œé˜¶æ®µ
FROM alpine:latest

RUN apk --no-cache add ca-certificates

WORKDIR /root/

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶
COPY --from=builder /app/main .

# åˆ›å»ºérootç”¨æˆ·
RUN adduser -D -g '' appuser
USER appuser

# æš´éœ²ç«¯å£
EXPOSE 8080

# å¯åŠ¨åº”ç”¨
CMD ["./main"]
</code></pre>
<p>åˆ›å»º Go åº”ç”¨ç¤ºä¾‹ï¼š<code>main.go</code></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"os"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    http.HandleFunc(<span class="hljs-string">"/"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {
        hostname, _ := os.Hostname()
        fmt.Fprintf(w, <span class="hljs-string">`
        &lt;!DOCTYPE html&gt;
        &lt;html&gt;
        &lt;head&gt;
            &lt;title&gt;Go Docker App&lt;/title&gt;
            &lt;style&gt;
                body {
                    font-family: Arial, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    margin: 0;
                    padding: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    height: 100vh;
                    color: white;
                }
                .container {
                    text-align: center;
                    background: rgba(255, 255, 255, 0.1);
                    padding: 40px;
                    border-radius: 15px;
                    backdrop-filter: blur(10px);
                }
            &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
            &lt;div class="container"&gt;
                &lt;h1&gt;ğŸ¹ Go + Docker&lt;/h1&gt;
                &lt;p&gt;&lt;strong&gt;å®¹å™¨ID:&lt;/strong&gt; %s&lt;/p&gt;
                &lt;p&gt;å¤šé˜¶æ®µæ„å»ºæˆåŠŸï¼&lt;/p&gt;
            &lt;/div&gt;
        &lt;/body&gt;
        &lt;/html&gt;
        `</span>, hostname)
    })

    log.Println(<span class="hljs-string">"Server starting on :8080..."</span>)
    log.Fatal(http.ListenAndServe(<span class="hljs-string">":8080"</span>, <span class="hljs-literal">nil</span>))
}
</code></pre>
<p>åˆ›å»º Go æ¨¡å—æ–‡ä»¶ï¼š<code>go.mod</code></p>
<pre><code class="hljs language-go" lang="go">module docker-<span class="hljs-keyword">go</span>-app

<span class="hljs-keyword">go</span> <span class="hljs-number">1.19</span>
</code></pre>
<h2 data-id="heading-19">7. Docker Compose å®æˆ˜</h2>
<h3 data-id="heading-20">7.1 å®Œæ•´çš„ Web åº”ç”¨æ ˆ</h3>
<p>åˆ›å»º Docker Compose æ–‡ä»¶ï¼š<code>docker-compose-fullstack.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-comment"># å‰ç«¯æœåŠ¡</span>
  <span class="hljs-attr">frontend:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">.</span>
      <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">frontend.Dockerfile</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">vue-frontend</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3000:80"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">API_URL=http://backend:8000</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># åç«¯ API æœåŠ¡</span>
  <span class="hljs-attr">backend:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">.</span>
      <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">backend.Dockerfile</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">flask-backend</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8000:8000"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">database</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_URL=postgresql://user:password@database:5432/myapp</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">REDIS_URL=redis://redis:6379</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend-logs:/app/logs</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># æ•°æ®åº“æœåŠ¡</span>
  <span class="hljs-attr">database:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:13-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">postgres-db</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">POSTGRES_DB:</span> <span class="hljs-string">myapp</span>
      <span class="hljs-attr">POSTGRES_USER:</span> <span class="hljs-string">user</span>
      <span class="hljs-attr">POSTGRES_PASSWORD:</span> <span class="hljs-string">password</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">postgres-data:/var/lib/postgresql/data</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./init.sql:/docker-entrypoint-initdb.d/init.sql</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># Redis ç¼“å­˜æœåŠ¡</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:6.2-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis-cache</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">redis-server</span> <span class="hljs-string">--appendonly</span> <span class="hljs-literal">yes</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis-data:/data</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># Nginx åå‘ä»£ç†</span>
  <span class="hljs-attr">nginx:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">nginx-proxy</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"80:80"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"443:443"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">frontend</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./nginx.conf:/etc/nginx/nginx.conf</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./ssl:/etc/nginx/ssl</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># ç›‘æ§æœåŠ¡</span>
  <span class="hljs-attr">monitor:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">portainer/portainer-ce:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">portainer</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9000:9000"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/run/docker.sock:/var/run/docker.sock</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">portainer-data:/data</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">app-network:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
    <span class="hljs-attr">ipam:</span>
      <span class="hljs-attr">config:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">subnet:</span> <span class="hljs-number">172.20</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">/16</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">postgres-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
  <span class="hljs-attr">redis-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
  <span class="hljs-attr">backend-logs:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
  <span class="hljs-attr">portainer-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
</code></pre>
<h3 data-id="heading-21">7.2 åˆ›å»ºç›¸å…³é…ç½®æ–‡ä»¶</h3>
<p>åˆ›å»º Nginx é…ç½®ï¼š<code>nginx.conf</code></p>
<pre><code class="hljs language-nginx" lang="nginx">events {
    worker_connections 1024;
}

http {
    upstream backend {
        server backend:8000;
    }

    upstream frontend {
        server frontend:80;
    }

    server {
        listen 80;
        server_name localhost;

        # å‰ç«¯é™æ€æ–‡ä»¶
        location / {
            proxy_pass http://frontend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # åç«¯ API ä»£ç†
        location /api/ {
            proxy_pass http://backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            
            # CORS å¤´
            add_header Access-Control-Allow-Origin *;
            add_header Access-Control-Allow-Methods "GET, POST, OPTIONS, PUT, DELETE";
            add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization";
        }

        # å¥åº·æ£€æŸ¥ç«¯ç‚¹
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }
}
</code></pre>
<p>åˆ›å»ºæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š<code>init.sql</code></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºç¤ºä¾‹è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> users (
    id SERIAL <span class="hljs-keyword">PRIMARY</span> KEY,
    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> products (
    id SERIAL <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    price <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    description TEXT,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- æ’å…¥ç¤ºä¾‹æ•°æ®</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users (username, email) <span class="hljs-keyword">VALUES</span> 
(<span class="hljs-string">'admin'</span>, <span class="hljs-string">'admin@example.com'</span>),
(<span class="hljs-string">'user1'</span>, <span class="hljs-string">'user1@example.com'</span>)
<span class="hljs-keyword">ON</span> CONFLICT (username) DO NOTHING;

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> products (name, price, description) <span class="hljs-keyword">VALUES</span> 
(<span class="hljs-string">'Docker Book'</span>, <span class="hljs-number">39.99</span>, <span class="hljs-string">'Learn Docker from scratch'</span>),
(<span class="hljs-string">'Kubernetes Guide'</span>, <span class="hljs-number">49.99</span>, <span class="hljs-string">'Master container orchestration'</span>)
<span class="hljs-keyword">ON</span> CONFLICT (id) DO NOTHING;
</code></pre>
<h2 data-id="heading-22">8. Docker å®‰å…¨å®è·µ</h2>
<h3 data-id="heading-23">8.1 å®‰å…¨æ‰«æä¸æœ€ä½³å®è·µ</h3>
<p>åˆ›å»ºå®‰å…¨æ‰«æè„šæœ¬ï¼š<code>security_scan.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># å®‰è£… Docker å®‰å…¨æ‰«æå·¥å…·</span>
sudo apt-get update
sudo apt-get install -y trivy

<span class="hljs-comment"># æ‰«ææœ¬åœ°é•œåƒ</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ‰«æ nginx é•œåƒçš„å®‰å…¨æ¼æ´..."</span>
trivy image nginx:latest

<span class="hljs-comment"># ä½¿ç”¨é root ç”¨æˆ·è¿è¡Œå®¹å™¨</span>
docker run -d \
  --name security-demo \
  --user 1000:1000 \
  -p 8082:80 \
  nginx:alpine

<span class="hljs-comment"># æ£€æŸ¥å®¹å™¨è¿è¡Œç”¨æˆ·</span>
docker <span class="hljs-built_in">exec</span> security-demo <span class="hljs-built_in">whoami</span>

<span class="hljs-comment"># åªè¯»æ–‡ä»¶ç³»ç»Ÿç¤ºä¾‹</span>
docker run -d \
  --name read-only-demo \
  --read-only \
  --tmpfs /tmp \
  -p 8083:80 \
  nginx:alpine

<span class="hljs-comment"># å®‰å…¨é€‰é¡¹ç¤ºä¾‹</span>
docker run -d \
  --name secure-container \
  --security-opt=no-new-privileges:<span class="hljs-literal">true</span> \
  --cap-drop=ALL \
  --cap-add=NET_BIND_SERVICE \
  -p 8084:80 \
  nginx:alpine

<span class="hljs-comment"># æ£€æŸ¥å®¹å™¨å®‰å…¨æ€§</span>
docker inspect secure-container | grep -A 5 SecurityOpt

<span class="hljs-built_in">echo</span> <span class="hljs-string">"å®‰å…¨æ¼”ç¤ºå®Œæˆï¼"</span>
</code></pre>
<h3 data-id="heading-24">8.2 åˆ›å»ºå®‰å…¨åŠ å›ºçš„ Dockerfile</h3>
<p>åˆ›å»ºå®‰å…¨åŠ å›ºçš„ Dockerfileï¼š<code>secure.Dockerfile</code></p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„åŸºç¡€é•œåƒ
FROM nginx:1.23-alpine

# è®¾ç½®ç”¨æˆ·å’Œç»„
RUN addgroup -g 1000 -S www-group &amp;&amp; \
    adduser -S -D -H -u 1000 -h /var/cache/nginx -s /sbin/nologin -G www-group -g www-user www-user

# ç§»é™¤ä¸å¿…è¦çš„æ–‡ä»¶
RUN rm -rf /etc/nginx/conf.d/* &amp;&amp; \
    rm -rf /usr/share/nginx/html/*

# å¤åˆ¶è‡ªå®šä¹‰é…ç½®
COPY nginx-secure.conf /etc/nginx/nginx.conf
COPY html/ /usr/share/nginx/html/

# è®¾ç½®æ­£ç¡®çš„æƒé™
RUN chown -R www-user:www-group /var/cache/nginx &amp;&amp; \
    chown -R www-user:www-group /var/log/nginx &amp;&amp; \
    chown -R www-user:www-group /etc/nginx/nginx.conf &amp;&amp; \
    chmod -R 755 /usr/share/nginx/html &amp;&amp; \
    chmod 644 /etc/nginx/nginx.conf

# åˆ‡æ¢åˆ°érootç”¨æˆ·
USER www-user

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:80/ || exit 1

# æš´éœ²ç«¯å£
EXPOSE 80

# å¯åŠ¨å‘½ä»¤
CMD ["nginx", "-g", "daemon off;"]
</code></pre>
<p>åˆ›å»ºå®‰å…¨ Nginx é…ç½®ï¼š<code>nginx-secure.conf</code></p>
<pre><code class="hljs language-nginx" lang="nginx">worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # å®‰å…¨å¤´
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
    add_header Referrer-Policy "strict-origin-when-cross-origin";

    # éšè—æœåŠ¡å™¨ç‰ˆæœ¬
    server_tokens off;

    # é™åˆ¶è¯·æ±‚å¤§å°
    client_max_body_size 1m;

    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;

    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;

    # Gzip å‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    server {
        listen 80;
        server_name _;

        # æ ¹ç›®å½•é…ç½®
        location / {
            root /usr/share/nginx/html;
            index index.html index.htm;
            
            # å®‰å…¨é™åˆ¶
            limit_except GET {
                deny all;
            }
        }

        # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
        location ~ /\. {
            deny all;
            access_log off;
            log_not_found off;
        }

        # å¥åº·æ£€æŸ¥
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }
}
</code></pre>
<h2 data-id="heading-25">9. Docker ç›‘æ§ä¸æ—¥å¿—ç®¡ç†</h2>
<h3 data-id="heading-26">9.1 å®¹å™¨ç›‘æ§å®æˆ˜</h3>
<p>åˆ›å»ºç›‘æ§è„šæœ¬ï¼š<code>monitoring_setup.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># ä½¿ç”¨ Docker Stats ç›‘æ§</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å®æ—¶å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ:"</span>
docker stats --format <span class="hljs-string">"table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}\t{{.BlockIO}}"</span>

<span class="hljs-comment"># è®¾ç½®å®¹å™¨èµ„æºé™åˆ¶</span>
docker run -d \
  --name limited-container \
  --memory=512m \
  --cpus=1.0 \
  --memory-reservation=256m \
  --blkio-weight=500 \
  nginx:alpine

<span class="hljs-comment"># æ£€æŸ¥èµ„æºé™åˆ¶</span>
docker inspect limited-container | grep -A 10 <span class="hljs-string">"HostConfig"</span>

<span class="hljs-comment"># å®‰è£… cAdvisor è¿›è¡Œè¯¦ç»†ç›‘æ§</span>
docker run -d \
  --name=cadvisor \
  --volume=/:/rootfs:ro \
  --volume=/var/run:/var/run:ro \
  --volume=/sys:/sys:ro \
  --volume=/var/lib/docker/:/var/lib/docker:ro \
  --volume=/dev/disk/:/dev/disk:ro \
  --publish=8080:8080 \
  --detach=<span class="hljs-literal">true</span> \
  --privileged \
  --device=/dev/kmsg \
  gcr.io/cadvisor/cadvisor:v0.47.0

<span class="hljs-built_in">echo</span> <span class="hljs-string">"cAdvisor ç›‘æ§é¢æ¿: http://localhost:8080"</span>

<span class="hljs-comment"># æ—¥å¿—ç®¡ç†ç¤ºä¾‹</span>
docker run -d \
  --name logging-demo \
  --log-driver=json-file \
  --log-opt max-size=10m \
  --log-opt max-file=3 \
  -p 8085:80 \
  nginx:alpine

<span class="hljs-comment"># æŸ¥çœ‹æ—¥å¿—</span>
docker logs logging-demo

<span class="hljs-comment"># æ—¥å¿—å¯¼å‡º</span>
docker logs logging-demo &gt; nginx.log

<span class="hljs-comment"># æ¸…ç†</span>
docker stop cadvisor limited-container logging-demo
docker <span class="hljs-built_in">rm</span> cadvisor limited-container logging-demo
</code></pre>
<h3 data-id="heading-27">9.2 ä½¿ç”¨ Prometheus å’Œ Grafana</h3>
<p>åˆ›å»ºç›‘æ§æ ˆé…ç½®ï¼š<code>docker-compose-monitoring.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-comment"># Node Exporter - ç³»ç»ŸæŒ‡æ ‡æ”¶é›†</span>
  <span class="hljs-attr">node-exporter:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">prom/node-exporter:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">node-exporter</span>
    <span class="hljs-attr">command:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--path.rootfs=/host'</span>
    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span>
    <span class="hljs-attr">pid:</span> <span class="hljs-string">host</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'/:/host:ro,rslave'</span>
    <span class="hljs-attr">user:</span> <span class="hljs-string">root</span>

  <span class="hljs-comment"># cAdvisor - å®¹å™¨æŒ‡æ ‡æ”¶é›†</span>
  <span class="hljs-attr">cadvisor:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">gcr.io/cadvisor/cadvisor:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">cadvisor</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/:/rootfs:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/run:/var/run:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/sys:/sys:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/lib/docker/:/var/lib/docker:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/dev/disk/:/dev/disk:ro</span>
    <span class="hljs-attr">devices:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/dev/kmsg</span>
    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span>

  <span class="hljs-comment"># Prometheus - æŒ‡æ ‡å­˜å‚¨å’ŒæŸ¥è¯¢</span>
  <span class="hljs-attr">prometheus:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">prom/prometheus:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">prometheus</span>
    <span class="hljs-attr">command:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--config.file=/etc/prometheus/prometheus.yml'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--storage.tsdb.path=/prometheus'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--web.console.libraries=/etc/prometheus/console_libraries'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--web.console.templates=/etc/prometheus/consoles'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--storage.tsdb.retention.time=200h'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--web.enable-lifecycle'</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./prometheus.yml:/etc/prometheus/prometheus.yml:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">prometheus-data:/prometheus</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9090:9090"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">monitoring</span>

  <span class="hljs-comment"># Grafana - æ•°æ®å¯è§†åŒ–</span>
  <span class="hljs-attr">grafana:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">grafana/grafana:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">grafana</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">grafana-data:/var/lib/grafana</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./grafana/provisioning:/etc/grafana/provisioning</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">GF_SECURITY_ADMIN_PASSWORD=admin123</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">GF_USERS_ALLOW_SIGN_UP=false</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3000:3000"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">monitoring</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">prometheus</span>

  <span class="hljs-comment"># Alertmanager - å‘Šè­¦ç®¡ç†</span>
  <span class="hljs-attr">alertmanager:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">prom/alertmanager:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">alertmanager</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./alertmanager.yml:/etc/alertmanager/alertmanager.yml:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">alertmanager-data:/alertmanager</span>
    <span class="hljs-attr">command:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--config.file=/etc/alertmanager/alertmanager.yml'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--storage.path=/alertmanager'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'--web.external-url=http://localhost:9093'</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9093:9093"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">monitoring</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">monitoring:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">prometheus-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
  <span class="hljs-attr">grafana-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
  <span class="hljs-attr">alertmanager-data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
</code></pre>
<p>åˆ›å»º Prometheus é…ç½®ï¼š<code>prometheus.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">global:</span>
  <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span>
  <span class="hljs-attr">evaluation_interval:</span> <span class="hljs-string">15s</span>

<span class="hljs-attr">rule_files:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">"alert_rules.yml"</span>

<span class="hljs-attr">alerting:</span>
  <span class="hljs-attr">alertmanagers:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">static_configs:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">alertmanager:9093</span>

<span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'prometheus'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'localhost:9090'</span>]

  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'node-exporter'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'node-exporter:9100'</span>]

  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'cadvisor'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'cadvisor:8080'</span>]

  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'docker-containers'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'localhost:9323'</span>]
</code></pre>
<h2 data-id="heading-28">10. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å®æˆ˜</h2>
<h3 data-id="heading-29">10.1 å®Œæ•´çš„ç”Ÿäº§çº§é…ç½®</h3>
<p>åˆ›å»ºç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è„šæœ¬ï¼š<code>production_deploy.sh</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-built_in">set</span> -e

<span class="hljs-comment"># ç¯å¢ƒå˜é‡é…ç½®</span>
<span class="hljs-built_in">export</span> COMPOSE_PROJECT_NAME=<span class="hljs-string">"myapp"</span>
<span class="hljs-built_in">export</span> DEPLOY_ENV=<span class="hljs-string">"production"</span>
<span class="hljs-built_in">export</span> DOCKER_REGISTRY=<span class="hljs-string">"registry.mycompany.com"</span>
<span class="hljs-built_in">export</span> APP_VERSION=<span class="hljs-string">"1.0.0"</span>

<span class="hljs-comment"># åˆ›å»ºå¿…è¦çš„ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p {logs,data,config,backups}

<span class="hljs-comment"># æ‹‰å–æœ€æ–°é•œåƒ</span>
docker-compose -f docker-compose-prod.yml pull

<span class="hljs-comment"># åœæ­¢ç°æœ‰æœåŠ¡</span>
docker-compose -f docker-compose-prod.yml down

<span class="hljs-comment"># å¤‡ä»½æ•°æ®åº“</span>
docker run --<span class="hljs-built_in">rm</span> \
  -v <span class="hljs-variable">${COMPOSE_PROJECT_NAME}</span>_db_data:/source \
  -v $(<span class="hljs-built_in">pwd</span>)/backups:/backup \
  alpine tar czf /backup/db-backup-$(<span class="hljs-built_in">date</span> +%Y%m%d-%H%M%S).tar.gz -C /source .

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
docker-compose -f docker-compose-prod.yml up -d

<span class="hljs-comment"># å¥åº·æ£€æŸ¥</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¿›è¡Œå¥åº·æ£€æŸ¥..."</span>
<span class="hljs-built_in">sleep</span> 30

<span class="hljs-comment"># æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€</span>
docker-compose -f docker-compose-prod.yml ps

<span class="hljs-comment"># æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€</span>
<span class="hljs-keyword">for</span> service <span class="hljs-keyword">in</span> $(docker-compose -f docker-compose-prod.yml ps --services); <span class="hljs-keyword">do</span>
    container_id=$(docker-compose -f docker-compose-prod.yml ps -q <span class="hljs-variable">$service</span>)
    health_status=$(docker inspect --format=<span class="hljs-string">'{{.State.Health.Status}}'</span> <span class="hljs-variable">$container_id</span> 2&gt;/dev/null || <span class="hljs-built_in">echo</span> <span class="hljs-string">"no health check"</span>)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æœåŠ¡ <span class="hljs-variable">$service</span>: <span class="hljs-variable">$health_status</span>"</span>
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># æ—¥å¿—æ£€æŸ¥</span>
docker-compose -f docker-compose-prod.yml logs --<span class="hljs-built_in">tail</span>=50

<span class="hljs-built_in">echo</span> <span class="hljs-string">"éƒ¨ç½²å®Œæˆï¼"</span>
</code></pre>
<p>åˆ›å»ºç”Ÿäº§ç¯å¢ƒ Docker Composeï¼š<code>docker-compose-prod.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">x-common-variables:</span> <span class="hljs-string">&amp;common-vars</span>
  <span class="hljs-attr">DEPLOY_ENV:</span> <span class="hljs-string">production</span>
  <span class="hljs-attr">LOG_LEVEL:</span> <span class="hljs-string">info</span>
  <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-comment"># åº”ç”¨æœåŠ¡</span>
  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">${DOCKER_REGISTRY}/myapp:${APP_VERSION}</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">${COMPOSE_PROJECT_NAME}-app</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-string">&lt;&lt;:</span> <span class="hljs-string">*common-vars</span>
      <span class="hljs-attr">DATABASE_URL:</span> <span class="hljs-string">postgresql://${DB_USER}:${DB_PASSWORD}@database:5432/${DB_NAME}</span>
      <span class="hljs-attr">REDIS_URL:</span> <span class="hljs-string">redis://redis:6379</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-attr">database:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">service_healthy</span>
      <span class="hljs-attr">redis:</span>
        <span class="hljs-attr">condition:</span> <span class="hljs-string">service_healthy</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"curl"</span>, <span class="hljs-string">"-f"</span>, <span class="hljs-string">"http://localhost:8080/health"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">3</span>
      <span class="hljs-attr">start_period:</span> <span class="hljs-string">40s</span>
    <span class="hljs-attr">logging:</span>
      <span class="hljs-attr">driver:</span> <span class="hljs-string">"json-file"</span>
      <span class="hljs-attr">options:</span>
        <span class="hljs-attr">max-size:</span> <span class="hljs-string">"10m"</span>
        <span class="hljs-attr">max-file:</span> <span class="hljs-string">"3"</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">frontend</span>

  <span class="hljs-comment"># æ•°æ®åº“</span>
  <span class="hljs-attr">database:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:13-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">${COMPOSE_PROJECT_NAME}-database</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-string">&lt;&lt;:</span> <span class="hljs-string">*common-vars</span>
      <span class="hljs-attr">POSTGRES_DB:</span> <span class="hljs-string">${DB_NAME}</span>
      <span class="hljs-attr">POSTGRES_USER:</span> <span class="hljs-string">${DB_USER}</span>
      <span class="hljs-attr">POSTGRES_PASSWORD:</span> <span class="hljs-string">${DB_PASSWORD}</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db_data:/var/lib/postgresql/data</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./config/postgres.conf:/etc/postgresql/postgresql.conf</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">postgres</span> <span class="hljs-string">-c</span> <span class="hljs-string">config_file=/etc/postgresql/postgresql.conf</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD-SHELL"</span>, <span class="hljs-string">"pg_isready -U ${DB_USER} -d ${DB_NAME}"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>
      <span class="hljs-attr">start_period:</span> <span class="hljs-string">40s</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>

  <span class="hljs-comment"># Redis</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:6.2-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">${COMPOSE_PROJECT_NAME}-redis</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">command:</span> <span class="hljs-string">redis-server</span> <span class="hljs-string">/usr/local/etc/redis/redis.conf</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_data:/data</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./config/redis.conf:/usr/local/etc/redis/redis.conf</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"redis-cli"</span>, <span class="hljs-string">"ping"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">5</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">backend</span>

  <span class="hljs-comment"># Nginx</span>
  <span class="hljs-attr">nginx:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.23-alpine</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">${COMPOSE_PROJECT_NAME}-nginx</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"80:80"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"443:443"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./config/nginx.conf:/etc/nginx/nginx.conf:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./ssl:/etc/nginx/ssl:ro</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./logs/nginx:/var/log/nginx</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app</span>
    <span class="hljs-attr">healthcheck:</span>
      <span class="hljs-attr">test:</span> [<span class="hljs-string">"CMD"</span>, <span class="hljs-string">"curl"</span>, <span class="hljs-string">"-f"</span>, <span class="hljs-string">"http://localhost/health"</span>]
      <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
      <span class="hljs-attr">timeout:</span> <span class="hljs-string">10s</span>
      <span class="hljs-attr">retries:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">frontend</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">frontend:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
    <span class="hljs-attr">driver_opts:</span>
      <span class="hljs-attr">com.docker.network.driver.mtu:</span> <span class="hljs-number">1500</span>
  <span class="hljs-attr">backend:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>
    <span class="hljs-attr">internal:</span> <span class="hljs-literal">false</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">db_data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
    <span class="hljs-attr">driver_opts:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">none</span>
      <span class="hljs-attr">o:</span> <span class="hljs-string">bind</span>
      <span class="hljs-attr">device:</span> <span class="hljs-string">${PWD}/data/db</span>
  <span class="hljs-attr">redis_data:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">local</span>
    <span class="hljs-attr">driver_opts:</span>
      <span class="hljs-attr">type:</span> <span class="hljs-string">none</span>
      <span class="hljs-attr">o:</span> <span class="hljs-string">bind</span>
      <span class="hljs-attr">device:</span> <span class="hljs-string">${PWD}/data/redis</span>
</code></pre>
<p>åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š<code>.env.production</code></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åº”ç”¨é…ç½®</span>
COMPOSE_PROJECT_NAME=myapp-production
APP_VERSION=1.0.0
DOCKER_REGISTRY=registry.mycompany.com

<span class="hljs-comment"># æ•°æ®åº“é…ç½®</span>
DB_NAME=myapp
DB_USER=app_user
DB_PASSWORD=secure_password_123

<span class="hljs-comment"># ç½‘ç»œé…ç½®</span>
DOMAIN=myapp.com
SSL_EMAIL=admin@myapp.com

<span class="hljs-comment"># èµ„æºé™åˆ¶</span>
APP_MEMORY_LIMIT=1g
DB_MEMORY_LIMIT=2g
REDIS_MEMORY_LIMIT=512m
</code></pre>
<h2 data-id="heading-30">Docker å­¦ä¹ æµç¨‹å›¾</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[Docker å­¦ä¹ è·¯å¾„] --&gt; B[ç¯å¢ƒå®‰è£…]
    A --&gt; C[åŸºç¡€æ¦‚å¿µ]
    A --&gt; D[å®æˆ˜æ¡ˆä¾‹]
    
    B --&gt; B1[ç³»ç»Ÿå®‰è£…]
    B --&gt; B2[ç¯å¢ƒé…ç½®]
    B --&gt; B3[æƒé™è®¾ç½®]
    
    C --&gt; C1[é•œåƒç®¡ç†]
    C --&gt; C2[å®¹å™¨æ“ä½œ]
    C --&gt; C3[ç½‘ç»œé…ç½®]
    C --&gt; C4[æ•°æ®æŒä¹…åŒ–]
    
    D --&gt; D1[Hello World]
    D --&gt; D2[Web åº”ç”¨]
    D --&gt; D3[å¤šå®¹å™¨åº”ç”¨]
    D --&gt; D4[ç”Ÿäº§éƒ¨ç½²]
    
    B1 --&gt; E[å®Œæˆå®‰è£…]
    B2 --&gt; E
    B3 --&gt; E
    
    C1 --&gt; F[æŒæ¡åŸºç¡€]
    C2 --&gt; F
    C3 --&gt; F
    C4 --&gt; F
    
    D1 --&gt; G[å®æˆ˜èƒ½åŠ›]
    D2 --&gt; G
    D3 --&gt; G
    D4 --&gt; G
    
    E --&gt; H[Docker ç²¾é€š]
    F --&gt; H
    G --&gt; H
    
    style A fill:#4CAF50,color:white
    style B fill:#2196F3,color:white
    style C fill:#2196F3,color:white
    style D fill:#2196F3,color:white
    style H fill:#FF9800,color:white
    style E fill:#9C27B0,color:white
    style F fill:#9C27B0,color:white
    style G fill:#9C27B0,color:white
</code></pre>
<h2 data-id="heading-31">æ€»ç»“</h2>
<p>é€šè¿‡è¿™10ä¸ªè¯¦ç»†çš„å®æˆ˜æ¡ˆä¾‹ï¼Œæ‚¨å·²ç»å…¨é¢æŒæ¡äº† Docker çš„æ ¸å¿ƒæ¦‚å¿µå’Œå®é™…åº”ç”¨æŠ€èƒ½ã€‚ä»åŸºç¡€çš„ç¯å¢ƒå®‰è£…åˆ°ç”Ÿäº§çº§éƒ¨ç½²ï¼Œæ¯ä¸ªæ¡ˆä¾‹éƒ½æä¾›äº†å®Œæ•´çš„ä»£ç å’Œé…ç½®ï¼Œç¡®ä¿æ‚¨å¯ä»¥ç«‹å³åœ¨å®è·µä¸­åº”ç”¨è¿™äº›çŸ¥è¯†ã€‚</p>
<p>å…³é”®å­¦ä¹ è¦ç‚¹ï¼š</p>
<ol>
<li>Docker åŸºç¡€å‘½ä»¤å’Œæ¦‚å¿µç†è§£</li>
<li>å®¹å™¨ç½‘ç»œå’Œæ•°æ®ç®¡ç†</li>
<li>Dockerfile æœ€ä½³å®è·µå’Œå¤šé˜¶æ®µæ„å»º</li>
<li>Docker Compose ç¼–æ’å¤æ‚åº”ç”¨</li>
<li>å®¹å™¨å®‰å…¨åŠ å›ºå’Œç›‘æ§</li>
<li>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ç­–ç•¥</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PostGreSQL docker æ‹‰å–ä»¥åŠéƒ¨ç½²æµç¨‹]]></title>    <link>https://juejin.cn/post/7571781196298207241</link>    <guid>https://juejin.cn/post/7571781196298207241</guid>    <pubDate>2025-11-13T05:17:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571781196298207241" data-draft-id="7571786149590679603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PostGreSQL  docker æ‹‰å–ä»¥åŠéƒ¨ç½²æµç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-13T05:17:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·96999628157"/> <meta itemprop="url" content="https://juejin.cn/user/3845409933637289"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PostGreSQL  docker æ‹‰å–ä»¥åŠéƒ¨ç½²æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3845409933637289/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·96999628157
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:17:51.000Z" title="Thu Nov 13 2025 05:17:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h3 data-id="heading-0">1. æ‹‰å–é•œåƒï¼ˆå›½å†…åŠ é€Ÿï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 2025-10 å·²æ¨é€çš„ 18 æœ€æ–°ç‰ˆ </span>
docker pull docker.1ms.run/postgres:18
</code></pre>
<hr/>
<h3 data-id="heading-1">2. åˆ›å»ºå®¿ä¸»æœºç›®å½•ï¼ˆçˆ¶ç›®å½•æŒ‚è½½æ–¹æ¡ˆï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$HOME</span>/pg18
<span class="hljs-comment"># èµ‹äºˆå®¹å™¨å†… 999 ç”¨æˆ·å†™æƒé™ï¼ˆé•œåƒé»˜è®¤ uidï¼‰</span>
sudo <span class="hljs-built_in">chown</span> -R 999:999 <span class="hljs-variable">$HOME</span>/pg18
</code></pre>
<hr/>
<h3 data-id="heading-2">3. å¯åŠ¨å®¹å™¨ï¼ˆå…³é”®ï¼šæŒ‚è½½çˆ¶ç›®å½• <code>/var/lib/postgresql</code>ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">docker run -d --name postgres \
  -e POSTGRES_PASSWORD=Root@123 \
  -v <span class="hljs-variable">$HOME</span>/pg18:/var/lib/postgresql \
  -p 5432:5432 \
  --restart unless-stopped \
  docker.1ms.run/postgres:18
</code></pre>

















<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>-v $HOME/pg18:/var/lib/postgresql</code></td><td><strong>åªæŒ‚çˆ¶ç›®å½•</strong>ï¼Œé•œåƒä¼šåœ¨å…¶ä¸‹è‡ªåŠ¨åˆ›å»º <code>18/main</code> ç‰ˆæœ¬å­ç›®å½•ï¼Œå…¼å®¹ 18+ çš„ <code>pg_ctlcluster</code> ç»“æ„</td></tr><tr><td>ä¸å†æŒ‚ <code>/var/lib/postgresql/data</code></td><td>é¿å…ä¸æ–°ç‰ˆç›®å½•å†²çªï¼Œé˜²æ­¢å‡ºç°ã€Œunused mountã€é”™è¯¯</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-3">4. éªŒè¯éƒ¨ç½²</h3>
<pre><code class="hljs language-bash" lang="bash">docker ps | grep postgres
<span class="hljs-comment"># çŠ¶æ€ Up å³å¯</span>

docker <span class="hljs-built_in">exec</span> -it postgres psql -U postgres
<span class="hljs-comment"># å‡ºç° postgres=# è¡¨ç¤ºæ­£å¸¸è¿æ¥</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">5. åç»­å‡çº§å°ç‰ˆæœ¬ï¼ˆ18.x â†’ 18.yï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">docker pull docker.1ms.run/postgres:18
docker restart postgres
</code></pre>
<p>æ•°æ®ç›®å½•ç»“æ„ä¸å˜ï¼Œè‡ªåŠ¨å…¼å®¹ ã€‚</p>
<hr/>
<h3 data-id="heading-5">6. ä¸€é”®åœ/åˆ ï¼ˆå¯é€‰ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">docker stop postgres &amp;&amp; docker <span class="hljs-built_in">rm</span> postgres
</code></pre>
<p>å®¿ä¸»æœº <code>$HOME/pg18</code> ä»ä¼šä¿ç•™ï¼Œé‡æ–°è¿è¡Œç¬¬ 3 æ­¥å³å¯å¤ç”¨æ•°æ®ã€‚</p>
<p>æŒ‰ç…§ä»¥ä¸Š 5 æ­¥ï¼Œå³å¯åœ¨æœ¬åœ°å®Œæˆ PostgreSQL 18 çš„æ‹‰å–ä¸éƒ¨ç½²ï¼Œå¹¶è§„é¿å› ç›®å½•ç»“æ„å˜æ›´å¯¼è‡´çš„é‡å¯å¾ªç¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[goé¡¹ç›®é€‚é…DTMï¼Œgozeroå·²ç»é€‚é…dtmäº†ï¼Œgoframeé¡¹ç›®è¦æ€ä¹ˆé€‚é…ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7571722835658440738</link>    <guid>https://juejin.cn/post/7571722835658440738</guid>    <pubDate>2025-11-13T03:41:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571722835658440738" data-draft-id="7571753301897756712" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="goé¡¹ç›®é€‚é…DTMï¼Œgozeroå·²ç»é€‚é…dtmäº†ï¼Œgoframeé¡¹ç›®è¦æ€ä¹ˆé€‚é…ï¼Ÿ"/> <meta itemprop="keywords" content="å¾®æœåŠ¡,Go"/> <meta itemprop="datePublished" content="2025-11-13T03:41:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="maoæ¯›"/> <meta itemprop="url" content="https://juejin.cn/user/1146138854949790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            goé¡¹ç›®é€‚é…DTMï¼Œgozeroå·²ç»é€‚é…dtmäº†ï¼Œgoframeé¡¹ç›®è¦æ€ä¹ˆé€‚é…ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1146138854949790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    maoæ¯›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:41:34.000Z" title="Thu Nov 13 2025 03:41:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰€è°“çš„gozeroé€‚é…dtm</h2>
<p>ä»¥ä¸‹æ˜¯gozeroçš„ç¤ºä¾‹ï¼Œæœ¬è´¨ä¸å°±æ˜¯ç»´æŠ¤äº†dtmé…ç½®</p>
<h3 data-id="heading-1">go-zeroæ”¯æŒ</h3>
<p>dtmä¸go-zeroè¿›è¡Œäº†æ·±åº¦åˆä½œï¼Œæ‰“é€ äº†go-zeroåŸç”Ÿæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼Œæä¾›äº†æç®€çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>dtmä»v1.6.0å¼€å§‹åŸç”Ÿæ”¯æŒgo-zeroå¾®æœåŠ¡æ¡†æ¶ï¼Œgo-zeroçš„ç‰ˆæœ¬éœ€è¦v1.2.4ä»¥ä¸Š</p>
<h3 data-id="heading-2">è¿è¡Œä¸€ä¸ªå·²æœ‰çš„ç¤ºä¾‹</h3>
<p>æˆ‘ä»¬ä»¥etcdä½œä¸ºæ³¨å†ŒæœåŠ¡ä¸­å¿ƒä¸ºä¾‹ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è¿è¡Œä¸€ä¸ªgo-zeroçš„ç¤ºä¾‹ï¼š</p>
<ul>
<li>å¯åŠ¨etcd</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‰æï¼šå·²å®‰è£…etcd</span>
etcd
</code></pre>
<ul>
<li>é…ç½®dtm</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">MicroService:</span>
  <span class="hljs-attr">Driver:</span> <span class="hljs-string">'dtm-driver-gozero'</span> <span class="hljs-comment"># é…ç½®dtmä½¿ç”¨go-zeroçš„å¾®æœåŠ¡åè®®</span>
  <span class="hljs-attr">Target:</span> <span class="hljs-string">'etcd://localhost:2379/dtmservice'</span> <span class="hljs-comment"># æŠŠdtmæ³¨å†Œåˆ°etcdçš„è¿™ä¸ªåœ°å€</span>
  <span class="hljs-attr">EndPoint:</span> <span class="hljs-string">'localhost:36790'</span> <span class="hljs-comment"># dtmçš„æœ¬åœ°åœ°å€</span>
</code></pre>
<ul>
<li>å¯åŠ¨dtm</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‰æï¼šé…ç½®å¥½conf.yml</span>
go run app/main.go -c conf.yml
</code></pre>
<ul>
<li>è¿è¡Œä¸€ä¸ªgo-zeroçš„æœåŠ¡</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/dtm-labs/dtmdriver-clients &amp;&amp; <span class="hljs-built_in">cd</span> dtmdriver-clients
<span class="hljs-built_in">cd</span> gozero/trans &amp;&amp; go run trans.go
</code></pre>
<ul>
<li>å‘èµ·ä¸€ä¸ªgo-zeroä½¿ç”¨dtmçš„äº‹åŠ¡</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨dtmdriver-clientsçš„ç›®å½•ä¸‹</span>
<span class="hljs-built_in">cd</span> gozero/app &amp;&amp; go run main.go
</code></pre>
<p>å½“æ‚¨åœ¨transçš„æ—¥å¿—ä¸­çœ‹åˆ°</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-number">2021</span>/<span class="hljs-number">12</span>/<span class="hljs-number">03</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">05</span> transfer <span class="hljs-keyword">out</span> <span class="hljs-number">30</span> cents <span class="hljs-keyword">from</span> <span class="hljs-number">1</span>
<span class="hljs-number">2021</span>/<span class="hljs-number">12</span>/<span class="hljs-number">03</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">05</span> transfer <span class="hljs-keyword">in</span> <span class="hljs-number">30</span> cents to <span class="hljs-number">2</span>
<span class="hljs-number">2021</span>/<span class="hljs-number">12</span>/<span class="hljs-number">03</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">05</span> transfer <span class="hljs-keyword">out</span> <span class="hljs-number">30</span> cents <span class="hljs-keyword">from</span> <span class="hljs-number">1</span>
<span class="hljs-number">2021</span>/<span class="hljs-number">12</span>/<span class="hljs-number">03</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">05</span> transfer <span class="hljs-keyword">out</span> <span class="hljs-number">30</span> cents <span class="hljs-keyword">from</span> <span class="hljs-number">1</span>
</code></pre>
<p>é‚£å°±æ˜¯äº‹åŠ¡æ­£å¸¸å®Œæˆäº†</p>
<h3 data-id="heading-3">å¼€å‘æ¥å…¥</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä¸‹é¢è¿™è¡Œå¯¼å…¥gozeroçš„dtmé©±åŠ¨</span>
<span class="hljs-keyword">import</span> _ <span class="hljs-string">"github.com/dtm-labs/driver-gozero"</span>

<span class="hljs-comment">// dtmå·²ç»é€šè¿‡å‰é¢çš„é…ç½®ï¼Œæ³¨å†Œåˆ°ä¸‹é¢è¿™ä¸ªåœ°å€ï¼Œå› æ­¤åœ¨dtmgrpcä¸­ä½¿ç”¨è¯¥åœ°å€</span>
<span class="hljs-keyword">var</span> dtmServer = <span class="hljs-string">"etcd://localhost:2379/dtmservice"</span>

<span class="hljs-comment">// ä¸‹é¢ä»é…ç½®æ–‡ä»¶ä¸­Loadé…ç½®ï¼Œç„¶åé€šè¿‡BuildTargetè·å¾—ä¸šåŠ¡æœåŠ¡çš„åœ°å€</span>
<span class="hljs-keyword">var</span> c zrpc.RpcClientConf
conf.MustLoad(*configFile, &amp;c)
busiServer, err := c.BuildTarget()

  <span class="hljs-comment">// ä½¿ç”¨dtmgrpcç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯å‹åˆ†å¸ƒå¼äº‹åŠ¡å¹¶æäº¤</span>
	gid := dtmgrpc.MustGenGid(dtmServer)
	msg := dtmgrpc.NewMsgGrpc(dtmServer, gid).
    <span class="hljs-comment">// äº‹åŠ¡çš„ç¬¬ä¸€æ­¥ä¸ºè°ƒç”¨trans.TransSvcClient.TransOut</span>
    <span class="hljs-comment">// å¯ä»¥ä»trans.pb.goä¸­æ‰¾åˆ°ä¸Šè¿°æ–¹æ³•å¯¹åº”çš„Methodåç§°ä¸º"/trans.TransSvc/TransOut"</span>
    <span class="hljs-comment">// dtméœ€è¦ä»dtmæœåŠ¡å™¨è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èµ°å¼ºç±»å‹</span>
    <span class="hljs-comment">// è€Œæ˜¯èµ°åŠ¨æ€çš„url: busiServer+"/trans.TransSvc/TransOut"</span>
		Add(busiServer+<span class="hljs-string">"/trans.TransSvc/TransOut"</span>, &amp;busi.BusiReq{Amount: <span class="hljs-number">30</span>, UserId: <span class="hljs-number">1</span>}).
		Add(busiServer+<span class="hljs-string">"/trans.TransSvc/TransIn"</span>, &amp;busi.BusiReq{Amount: <span class="hljs-number">30</span>, UserId: <span class="hljs-number">2</span>})
	err := msg.Submit()
</code></pre>
<p>æ•´ä¸ªå¼€å‘æ¥å…¥çš„è¿‡ç¨‹å¾ˆå°‘ï¼Œå‰é¢çš„æ³¨é‡Šå·²ç»å¾ˆæ¸…æ™°ï¼Œå°±ä¸å†èµ˜è¿°äº†</p>
<h2 data-id="heading-4">æ­£ç¡®çš„åšæ³•ï¼Œä»»ä½•goé¡¹ç›®éƒ½å¯ä»¥å»é€‚é…dtm</h2>
<p>è¯´ç™½äº†å°±æ˜¯è®©æœåŠ¡æ‰¾åˆ°dtmçš„è°ƒç”¨å…¥å£</p>
<h3 data-id="heading-5">1. ä½¿ç”¨dtm,ä¼ å‚dtm serveråœ°å€</h3>
<pre><code class="hljs language-go" lang="go">gid := dtmgrpc.MustGenGid(l.svcCtx.Config.DtmServerAddr)
</code></pre>
<h3 data-id="heading-6">2. tccäº‹åŠ¡ä¸Šä¸‹æ–‡ä¸¢å¤±è§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> dtmtool

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"violet/common"</span>

	<span class="hljs-string">"github.com/dtm-labs/client/dtmcli/dtmimp"</span>
	<span class="hljs-string">"github.com/dtm-labs/client/dtmgrpc"</span>
	<span class="hljs-string">"github.com/dtm-labs/client/dtmgrpc/dtmgimp"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TccGlobalTransactionWithContext</span><span class="hljs-params">(ctx context.Context, dtm <span class="hljs-type">string</span>, gid <span class="hljs-type">string</span>, tccFunc dtmgrpc.TccGlobalFunc)</span></span> (rerr <span class="hljs-type">error</span>) {
	headers := <span class="hljs-built_in">make</span>(common.BranchHeaders)
	propagator := otel.GetTextMapPropagator()
	propagator.Inject(ctx, headers)

	tcc := &amp;dtmgrpc.TccGrpc{TransBase: *dtmimp.NewTransBase(gid, <span class="hljs-string">"tcc"</span>, dtm, <span class="hljs-string">""</span>)}

	tcc.Context = ctx
	tcc.BranchHeaders = headers

	rerr = dtmgimp.DtmGrpcCall(&amp;tcc.TransBase, <span class="hljs-string">"Prepare"</span>)
	<span class="hljs-keyword">if</span> rerr != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> rerr
	}
	<span class="hljs-keyword">defer</span> dtmimp.DeferDo(&amp;rerr, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">return</span> dtmgimp.DtmGrpcCall(&amp;tcc.TransBase, <span class="hljs-string">"Submit"</span>)
	}, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
		tcc.RollbackReason = rerr.Error()
		<span class="hljs-keyword">return</span> dtmgimp.DtmGrpcCall(&amp;tcc.TransBase, <span class="hljs-string">"Abort"</span>)
	})
	rerr = tccFunc(tcc)
	<span class="hljs-keyword">return</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SagaTransactionWithContext</span><span class="hljs-params">(ctx context.Context, dtm <span class="hljs-type">string</span>, gid <span class="hljs-type">string</span>)</span></span> *dtmgrpc.SagaGrpc {
	headers := <span class="hljs-built_in">make</span>(common.BranchHeaders)
	propagator := otel.GetTextMapPropagator()
	propagator.Inject(ctx, headers)

	saga := dtmgrpc.NewSagaGrpc(dtm, gid)

	saga.Context = ctx
	saga.BranchHeaders = headers

	<span class="hljs-keyword">return</span> saga
}
</code></pre>
<h3 data-id="heading-7">3. å®Œæ•´ç¤ºä¾‹</h3>
<pre><code class="hljs language-go" lang="go">gid := dtmgrpc.MustGenGid(l.svcCtx.Config.DtmServerAddr)
	err = dtmtool.TccGlobalTransactionWithContext(l.ctx, l.svcCtx.Config.DtmServerAddr, gid, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tcc *dtmgrpc.TccGrpc)</span></span> <span class="hljs-type">error</span> {
		financeRpcFullAddr := k8stool.CombineFullAddr(l.svcCtx.Config.Namespace, l.svcCtx.Config.FinanceRpcAddr)
		userRpcFullAddr := k8stool.CombineFullAddr(l.svcCtx.Config.Namespace, l.svcCtx.Config.UserRpcAddr)

		transferRequest := &amp;financeRpc.CreateTransferApplyReq{
			UserId:      userId,
			UserName:    userName,
			OutPlatform: req.FromAccountPlatform,
			InPlatform:  req.ToAccountPlatform,
			OutAmount:   amount.String(),
			InAmount:    inAmount,
			OutCurrency: fromCurrency,
			InCurrency:  toCurrency,
			OutAccount:  req.FromAccount,
			InAccount:   req.ToAccount,
			OrderSource: orderSource,
			Rate:        rate,
		}
		<span class="hljs-keyword">var</span> transferResp financeRpc.CreateTransferApplyRes
		err = tcc.CallBranch(transferRequest,
			financeRpcFullAddr+financeRpc.TransferApplication_TccTryCreateTransferApply_FullMethodName,
			financeRpcFullAddr+financeRpc.TransferApplication_TccConfirmCreateTransferApply_FullMethodName,
			financeRpcFullAddr+financeRpc.TransferApplication_TccCancelCreateTransferApply_FullMethodName,
			&amp;transferResp)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"åˆ’è½¬è®°å½•å¤±è´¥,err:%v"</span>, err)
			<span class="hljs-keyword">return</span> err
		}
		<span class="hljs-keyword">if</span> transferResp.Status.Code != <span class="hljs-number">0</span> {
			<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(transferResp.Status.Code), transferResp.Status.Message)
		}

		resp = &amp;types.TransactionResponse{
			Amount:         amount.String(),
			AmountReceived: inAmount,
			OrderId:        transferResp.OrderId,
			OrderTime:      transferResp.CreateTime,
		}

		<span class="hljs-keyword">if</span> req.FromAccountPlatform == comment.AccountWallet {
			<span class="hljs-comment">// é’±åŒ…è°ƒæ•´è®°å½•</span>
			walletAdjustmentReq := &amp;walletAdjust.CreateWalletAdjustmentReq{
				UserId:             userId,
				UserName:           userName,
				UserType:           userType,
				ChangeBeforeAmount: fromBalance.String(),
				AdminUser:          comment.AdminUser,
				ChangeType:         <span class="hljs-type">int32</span>(comment.OUT_Amount),
				Wallet:             req.FromAccount,
				WalletCurrency:     fromCurrency,
				ChangeAmount:       amount.String(),
				ChangeMethod:       <span class="hljs-type">int32</span>(comment.INNER_TRANS),
				TradeOrder:         &amp;transferResp.OrderId,
			}
			<span class="hljs-keyword">var</span> walletAdjustmentRes walletAdjust.Status
			err = tcc.CallBranch(walletAdjustmentReq,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccTryCreateWalletAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccConfirmCreateWalletAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccCancelCreateWalletAdjustment_FullMethodName,
				&amp;walletAdjustmentRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"é’±åŒ…è°ƒæ•´è®°å½•å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> walletAdjustmentRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(walletAdjustmentRes.Status.Code), walletAdjustmentRes.Status.Message)
			}
			<span class="hljs-comment">// é’±åŒ…æµæ°´</span>
			walletTransHisReq := &amp;walletAdjust.WalletTransactionHistory{
				UserId:             userId,
				UserName:           userName,
				UserType:           userType,
				WalletId:           req.FromAccount,
				Currency:           fromCurrency,
				Amount:             req.Amount,
				ChangeBeforeAmount: fromBalance.String(),
				ChangeType:         <span class="hljs-type">int32</span>(comment.OUT_Amount),
				Remark:             <span class="hljs-string">"åˆ’è½¬,è½¬å‡ºåˆ°äº¤æ˜“è´¦æˆ·"</span>,
				ChangeMethod:       common.TransactionTypeTransferOut,
				OrderId:            transferResp.OrderId,
			}
			<span class="hljs-keyword">var</span> walletTransHisRes walletAdjust.WalletTransactionHistoryID
			err = tcc.CallBranch(walletTransHisReq,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccTryCreateWalletTransactionHistory_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccConfirmCreateWalletTransactionHistory_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccCancelCreateWalletTransactionHistory_FullMethodName,
				&amp;walletTransHisRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"tcc write wallet transaction history error: %v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> walletTransHisRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(walletTransHisRes.Status.Code), walletTransHisRes.Status.Message)
			}
			<span class="hljs-comment">// é’±åŒ…å‡é’±</span>
			<span class="hljs-keyword">var</span> adjustWalletBalance userRpc.Status
			err = tcc.CallBranch(&amp;userRpc.RWalletBalanceAdjustRequest{
				WalletId: req.FromAccount,
				Type:     <span class="hljs-number">2</span>,
				Amount:   amount.String(),
			},
				userRpcFullAddr+userRpc.RWallet_TccTryAdjustRWalletBalance_FullMethodName,
				userRpcFullAddr+userRpc.RWallet_TccConfirmAdjustRWalletBalance_FullMethodName,
				userRpcFullAddr+userRpc.RWallet_TccCancelCreateRWallet_FullMethodName,
				&amp;adjustWalletBalance)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"é’±åŒ…ä½™é¢è°ƒæ•´å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> adjustWalletBalance.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(adjustWalletBalance.Status.Code), adjustWalletBalance.Status.Message)
			}
			<span class="hljs-comment">// è´¦æˆ·è°ƒæ•´è®°å½•</span>
			accountAdjustmentReq := &amp;accountAdjust.CreateAccountAdjustmentReq{
				UserId:          userId,
				UserName:        userName,
				UserType:        userType,
				ChangeType:      <span class="hljs-type">int32</span>(comment.IN_Amount),
				AdminUser:       comment.AdminUser,
				Account:         req.ToAccount,
				AccountPlatform: req.ToAccountPlatform,
				Currency:        toCurrency,
				BeforeAmount:    toBalance.String(),
				ChangeAmount:    inAmount,
				ChangeMethod:    <span class="hljs-type">int32</span>(comment.INNER_TRANS),
				TradeOrder:      &amp;transferResp.OrderId,
			}

			<span class="hljs-keyword">var</span> accountAdjustmentRes accountAdjust.CreateAccountAdjustmentRes
			err = tcc.CallBranch(accountAdjustmentReq,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccTryCreateAccountAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccConfirmCreateAccountAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccCancelCreateAccountAdjustment_FullMethodName,
				&amp;accountAdjustmentRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"è´¦æˆ·è°ƒæ•´è®°å½•å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> accountAdjustmentRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(accountAdjustmentRes.Status.Code), accountAdjustmentRes.Status.Message)
			}
			<span class="hljs-comment">// è´¦æˆ·åŠ é’±</span>
			payload := &amp;finance_task.AccountAdjustBalance{
				ApplyId:      transferResp.OrderId,
				AdjustmentID: accountAdjustmentRes.OrderId,
			}
			taskInfo, _ := l.svcCtx.StaskClient.EnqueueContext(l.ctx, payload.CreateTransactionTaskFactory())
			logx.WithContext(l.ctx).Infof(<span class="hljs-string">"task id: %+v"</span>, taskInfo.ID)
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-comment">// é’±åŒ…è°ƒæ•´è®°å½•</span>
			walletAdjustmentReq := &amp;walletAdjust.CreateWalletAdjustmentReq{
				UserId:             userId,
				UserName:           userName,
				UserType:           userType,
				ChangeBeforeAmount: toBalance.String(),
				AdminUser:          comment.AdminUser,
				ChangeType:         <span class="hljs-type">int32</span>(comment.IN_Amount),
				Wallet:             req.ToAccount,
				WalletCurrency:     toCurrency,
				ChangeAmount:       inAmount,
				ChangeMethod:       <span class="hljs-type">int32</span>(comment.INNER_TRANS),
				TradeOrder:         &amp;transferResp.OrderId,
			}
			<span class="hljs-keyword">var</span> walletAdjustmentRes walletAdjust.Status
			err = tcc.CallBranch(walletAdjustmentReq,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccTryCreateWalletAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccConfirmCreateWalletAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccCancelCreateWalletAdjustment_FullMethodName,
				&amp;walletAdjustmentRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"é’±åŒ…è°ƒæ•´è®°å½•å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> walletAdjustmentRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(walletAdjustmentRes.Status.Code), walletAdjustmentRes.Status.Message)
			}
			<span class="hljs-comment">// é’±åŒ…æµæ°´</span>
			walletTransHisReq := &amp;walletAdjust.WalletTransactionHistory{
				OrderId:            transferResp.OrderId,
				UserId:             userId,
				UserName:           userName,
				UserType:           userType,
				WalletId:           req.ToAccount,
				Currency:           toCurrency,
				Amount:             inAmount,
				ChangeBeforeAmount: toBalance.String(),
				ChangeType:         <span class="hljs-type">int32</span>(comment.IN_Amount),
				Remark:             <span class="hljs-string">"åˆ’è½¬,äº¤æ˜“è´¦æˆ·è½¬å…¥"</span>,
				ChangeMethod:       common.TransactionTypeTransferIn,
			}
			<span class="hljs-keyword">var</span> walletTransHisRes walletAdjust.WalletTransactionHistoryID
			err = tcc.CallBranch(walletTransHisReq,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccTryCreateWalletTransactionHistory_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccConfirmCreateWalletTransactionHistory_FullMethodName,
				financeRpcFullAddr+financeRpc.WalletAdjustment_TccCancelCreateWalletTransactionHistory_FullMethodName,
				&amp;walletTransHisRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"tcc write wallet transaction history error: %v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> walletTransHisRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(walletTransHisRes.Status.Code), walletTransHisRes.Status.Message)
			}
			<span class="hljs-comment">// é’±åŒ…åŠ é’±</span>
			<span class="hljs-keyword">var</span> adjustWalletBalance userRpc.Status
			err = tcc.CallBranch(&amp;userRpc.RWalletBalanceAdjustRequest{
				WalletId: req.ToAccount,
				Type:     <span class="hljs-number">1</span>,
				Amount:   inAmount,
			},
				userRpcFullAddr+userRpc.RWallet_TccTryAdjustRWalletBalance_FullMethodName,
				userRpcFullAddr+userRpc.RWallet_TccConfirmAdjustRWalletBalance_FullMethodName,
				userRpcFullAddr+userRpc.RWallet_TccCancelCreateRWallet_FullMethodName,
				&amp;adjustWalletBalance)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"é’±åŒ…ä½™é¢è°ƒæ•´å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> adjustWalletBalance.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(adjustWalletBalance.Status.Code), adjustWalletBalance.Status.Message)
			}

			<span class="hljs-comment">// è´¦æˆ·è°ƒæ•´è®°å½•</span>
			accountAdjustmentReq := &amp;accountAdjust.CreateAccountAdjustmentReq{
				UserId:          userId,
				UserName:        userName,
				UserType:        userType,
				ChangeType:      <span class="hljs-type">int32</span>(comment.OUT_Amount),
				AdminUser:       comment.AdminUser,
				Account:         req.FromAccount,
				AccountPlatform: req.FromAccountPlatform,
				Currency:        fromCurrency,
				BeforeAmount:    fromBalance.String(),
				ChangeAmount:    amount.String(),
				ChangeMethod:    <span class="hljs-type">int32</span>(comment.INNER_TRANS),
				TradeOrder:      &amp;transferResp.OrderId,
			}
			<span class="hljs-keyword">var</span> accountAdjustmentRes accountAdjust.CreateAccountAdjustmentRes
			err = tcc.CallBranch(accountAdjustmentReq,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccTryCreateAccountAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccConfirmCreateAccountAdjustment_FullMethodName,
				financeRpcFullAddr+financeRpc.AccountAdjustment_TccCancelCreateAccountAdjustment_FullMethodName,
				&amp;accountAdjustmentRes)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				logx.WithContext(l.ctx).Errorf(<span class="hljs-string">"è´¦æˆ·è°ƒæ•´è®°å½•å¤±è´¥,err:%v"</span>, err)
				<span class="hljs-keyword">return</span> err
			}
			<span class="hljs-keyword">if</span> accountAdjustmentRes.Status.Code != <span class="hljs-number">0</span> {
				<span class="hljs-keyword">return</span> common.NewErr(<span class="hljs-type">int</span>(accountAdjustmentRes.Status.Code), accountAdjustmentRes.Status.Message)
			}
			payload := &amp;finance_task.AccountAdjustBalance{
				ApplyId:      transferResp.OrderId,
				AdjustmentID: accountAdjustmentRes.OrderId,
			}
			taskInfo, _ := l.svcCtx.StaskClient.EnqueueContext(l.ctx, payload.CreateTransactionTaskFactory())
			logx.WithContext(l.ctx).Infof(<span class="hljs-string">"task id: %+v"</span>, taskInfo.ID)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})
</code></pre>
<h3 data-id="heading-8">4. ä¸ºä»€ä¹ˆè¦æ³¨å†Œä¸Šä¸‹æ–‡ï¼Ÿ</h3>
<p>ä¸ºçš„æ˜¯å­äº‹åŠ¡å±éšœå¯ä»¥ä½¿ç”¨æ­£ç¡®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå­äº‹åŠ¡å±éšœå¦‚ä½•ä½¿ç”¨å‘¢?è¦ä»dbå…¥æ‰‹</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> sql

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"database/sql"</span>
	<span class="hljs-string">"fmt"</span>

	<span class="hljs-string">"github.com/dtm-labs/client/dtmcli"</span>
	<span class="hljs-string">"github.com/dtm-labs/client/dtmcli/dtmimp"</span>
	<span class="hljs-string">"github.com/dtm-labs/client/dtmgrpc/dtmgimp"</span>
	<span class="hljs-string">"github.com/zeromicro/go-zero/core/logx"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/attribute"</span>
	oteltrace <span class="hljs-string">"go.opentelemetry.io/otel/trace"</span>
	<span class="hljs-string">"gorm.io/gorm"</span>

	<span class="hljs-string">"violet/common"</span>
)

<span class="hljs-keyword">type</span> barrierDBWrapper <span class="hljs-keyword">struct</span> {
	ctx context.Context
	DB  *gorm.DB
}

<span class="hljs-keyword">type</span> sqlResult <span class="hljs-keyword">struct</span> {
	rowsAffected <span class="hljs-type">int64</span>
	err          <span class="hljs-type">error</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ss *sqlResult)</span></span> LastInsertId() (<span class="hljs-type">int64</span>, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// RowsAffected dtm_barrier åªä¼šç”¨äº†RowsAffected,æ²¡æœ‰ä½¿ç”¨ LastInsertId æ‰€ä»¥æ²¡æœ‰å®ç° LastInsertId</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ss *sqlResult)</span></span> RowsAffected() (<span class="hljs-type">int64</span>, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">return</span> ss.rowsAffected, ss.err
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewDBWrapper</span><span class="hljs-params">(ctx context.Context, db *gorm.DB)</span></span> *barrierDBWrapper {
	<span class="hljs-keyword">return</span> &amp;barrierDBWrapper{
		ctx: ctx,
		DB:  db,
	}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *barrierDBWrapper)</span></span> Exec(query <span class="hljs-type">string</span>, args ...<span class="hljs-keyword">interface</span>{}) (sql.Result, <span class="hljs-type">error</span>) {
	result := bb.DB.Exec(query, args...)
	<span class="hljs-keyword">return</span> &amp;sqlResult{
		rowsAffected: result.RowsAffected,
		err:          result.Error,
	}, result.Error
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *barrierDBWrapper)</span></span> QueryRow(query <span class="hljs-type">string</span>, args ...<span class="hljs-keyword">interface</span>{}) *sql.Row {
	<span class="hljs-keyword">return</span> bb.DB.WithContext(bb.ctx).Raw(query, args...).Row()
}

<span class="hljs-keyword">type</span> BarrierGormFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(gtx *gorm.DB)</span></span> <span class="hljs-type">error</span>

<span class="hljs-keyword">type</span> DtmBarrier <span class="hljs-keyword">struct</span> {
	ctx              context.Context
	TransType        <span class="hljs-type">string</span>
	Gid              <span class="hljs-type">string</span>
	BranchID         <span class="hljs-type">string</span>
	Op               <span class="hljs-type">string</span>
	BarrierID        <span class="hljs-type">int</span>
	DBType           <span class="hljs-type">string</span> <span class="hljs-comment">// DBTypeMysql | DBTypePostgres</span>
	BarrierTableName <span class="hljs-type">string</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewBarrierFromGRPC</span><span class="hljs-params">(ctx context.Context)</span></span> (*DtmBarrier, <span class="hljs-type">error</span>) {
	tb := dtmgimp.TransBaseFromGrpc(ctx)
	barrier := &amp;DtmBarrier{
		TransType: tb.TransType,
		Gid:       tb.Gid,
		BranchID:  tb.BranchID,
		Op:        tb.Op,
		ctx:       ctx,
	}

	<span class="hljs-keyword">if</span> barrier.TransType == <span class="hljs-string">""</span> || barrier.Gid == <span class="hljs-string">""</span> || barrier.BranchID == <span class="hljs-string">""</span> || barrier.Op == <span class="hljs-string">""</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"invalid trans info: %v"</span>, barrier)
	}

	<span class="hljs-keyword">return</span> barrier, <span class="hljs-literal">nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *DtmBarrier)</span></span> String() <span class="hljs-type">string</span> {
	<span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"transInfo: %s %s %s %s"</span>, bb.TransType, bb.Gid, bb.BranchID, bb.Op)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *DtmBarrier)</span></span> newBarrierID() <span class="hljs-type">string</span> {
	bb.BarrierID++
	<span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%02d"</span>, bb.BarrierID)
}

<span class="hljs-comment">// CallWithDB ç»“åˆgorm å¯¹dtm barrier çš„å°è£…</span>
<span class="hljs-comment">// æ³¨æ„ï¼š</span>
<span class="hljs-comment">//  1. BarrierGormFuncä¸­å¯¹æ•°æ®åº“çš„CREATEã€UPDATEã€DELETEå¿…é¡»ä½¿ç”¨å‚æ•°gtxè€Œä¸æ˜¯d.DB, SELECT ä¸¤è€…éƒ½å¯ä»¥</span>
<span class="hljs-comment">//  2. CallWithDB å‡½æ•°ä¸­ä½¿ç”¨gdbå·²ç»å¯åŠ¨äº†ä¸€ä¸ªäº‹åŠ¡,è€Œä¸”ä¼šè‡ªåŠ¨æäº¤ï¼Œæ‰€ä»¥ä¸å¿…å†BarrierGormFuncå¯åŠ¨æ–°äº‹ç‰©</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *DtmBarrier)</span></span> CallWithDB(db *gorm.DB, busiCall BarrierGormFunc) (rerr <span class="hljs-type">error</span>) {
	tx := db.WithContext(bb.ctx).Begin()
	<span class="hljs-keyword">defer</span> dtmimp.DeferDo(&amp;rerr, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">return</span> tx.Commit().Error
	}, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">return</span> tx.Rollback().Error
	})

	rerr = bb.Call(db, busiCall)
	<span class="hljs-keyword">return</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *DtmBarrier)</span></span> CallWithDBandTracing(db *gorm.DB, operationName <span class="hljs-type">string</span>, busiCall BarrierGormFunc) (rerr <span class="hljs-type">error</span>) {
	c, span := common.StartSpan(bb.ctx, <span class="hljs-string">"sql"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(r oteltrace.Span)</span></span> {
		r.SetAttributes(attribute.Key(<span class="hljs-string">"sql.method"</span>).String(operationName))
	})
	<span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
	<span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		common.EndSpan(span, err)
	}()

	bb.ctx = c

	<span class="hljs-comment">// æ‰§è¡Œæ•°æ®åº“æ“ä½œå¹¶è®°å½•é”™è¯¯</span>
	err = bb.CallWithDB(db, busiCall)

	<span class="hljs-keyword">return</span> err
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bb *DtmBarrier)</span></span> Call(gtx *gorm.DB, busiCall BarrierGormFunc) (rerr <span class="hljs-type">error</span>) {
	bid := bb.newBarrierID()
	originOp := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{
		dtmimp.OpCancel:     dtmimp.OpTry,    <span class="hljs-comment">// tcc</span>
		dtmimp.OpCompensate: dtmimp.OpAction, <span class="hljs-comment">// saga</span>
		dtmimp.OpRollback:   dtmimp.OpAction, <span class="hljs-comment">// workflow</span>
	}[bb.Op]

	originAffected, oerr := dtmimp.InsertBarrier(NewDBWrapper(bb.ctx, gtx), bb.TransType, bb.Gid, bb.BranchID, originOp, bid, bb.Op, bb.DBType, bb.BarrierTableName)
	currentAffected, rerr := dtmimp.InsertBarrier(NewDBWrapper(bb.ctx, gtx), bb.TransType, bb.Gid, bb.BranchID, bb.Op, bid, bb.Op, bb.DBType, bb.BarrierTableName)

	logx.WithContext(bb.ctx).Debugf(<span class="hljs-string">"originAffected: %d currentAffected: %d"</span>, originAffected, currentAffected)

	<span class="hljs-keyword">if</span> rerr == <span class="hljs-literal">nil</span> &amp;&amp; bb.Op == dtmimp.MsgDoOp &amp;&amp; currentAffected == <span class="hljs-number">0</span> { <span class="hljs-comment">// for msg's DoAndSubmit, repeated insert should be rejected.</span>
		<span class="hljs-keyword">return</span> dtmcli.ErrDuplicated
	}

	<span class="hljs-keyword">if</span> rerr == <span class="hljs-literal">nil</span> {
		rerr = oerr
	}

	<span class="hljs-keyword">if</span> (bb.Op == dtmimp.OpCancel || bb.Op == dtmimp.OpCompensate || bb.Op == dtmimp.OpRollback) &amp;&amp; originAffected &gt; <span class="hljs-number">0</span> || <span class="hljs-comment">// null compensate</span>
		currentAffected == <span class="hljs-number">0</span> { <span class="hljs-comment">// repeated request or dangled request</span>
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-keyword">if</span> rerr == <span class="hljs-literal">nil</span> {
		rerr = busiCall(gtx)
	}

	<span class="hljs-keyword">return</span>
}
</code></pre>
<h3 data-id="heading-9">5. ä½¿ç”¨å­äº‹åŠ¡å±éšœ</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *DAO)</span></span> ConfirmCreateDepositApply(ctx context.Context, apply *DepositApplication) (*DepositApplication, <span class="hljs-type">error</span>) {
	barrier, err := sql.NewBarrierFromGRPC(ctx)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		logx.WithContext(ctx).Error(err)
		<span class="hljs-comment">// codes.Internal é”™è¯¯ä¼šé‡è¯•</span>
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}
	<span class="hljs-comment">//åªä¿®æ”¹çŠ¶æ€</span>
	err = barrier.CallWithDBandTracing(d.DB, <span class="hljs-string">"ConfirmCreateDepositApply"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(gtx *gorm.DB)</span></span> <span class="hljs-type">error</span> {
		err = gtx.Model(&amp;DepositApplication{}).Where(<span class="hljs-string">"gid = ? and trans_status = ?"</span>, barrier.Gid, common.DtmTransactionStatusPending).
			Update(<span class="hljs-string">"trans_status"</span>, common.DtmTransactionStatusCompleted).Error
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> err
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		logx.Errorw(<span class="hljs-string">"ConfirmCreateDepositApply error"</span>, logx.Field(<span class="hljs-string">"err"</span>, err))
	}
	<span class="hljs-keyword">return</span> apply, err
}
</code></pre>
<p>æœ¬æ•™ç¨‹åˆ°æ­¤ä¸ºæ­¢ï¼Œæœ‰ä»€ä¹ˆä¸æ‡‚çš„è¯·ç§ä¿¡ï¼Œæœ‰æ—¶é—´é€ä¸€è§£ç­”</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[seataè¦æ”¯æŒOracleæ‰¹é‡æ’å…¥çš„è¯­æ³•äº†å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7571829822340268083</link>    <guid>https://juejin.cn/post/7571829822340268083</guid>    <pubDate>2025-11-13T04:54:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571829822340268083" data-draft-id="7571662618055376922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="seataè¦æ”¯æŒOracleæ‰¹é‡æ’å…¥çš„è¯­æ³•äº†å—ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,å¼€æº"/> <meta itemprop="datePublished" content="2025-11-13T04:54:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æƒ³ç”¨offeræ‰“ç‰Œ"/> <meta itemprop="url" content="https://juejin.cn/user/578781641968972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            seataè¦æ”¯æŒOracleæ‰¹é‡æ’å…¥çš„è¯­æ³•äº†å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578781641968972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æƒ³ç”¨offeræ‰“ç‰Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T04:54:44.000Z" title="Thu Nov 13 2025 04:54:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>å¤§å®¶å¥½ï¼å¤§å®¶éƒ½çŸ¥é“seataæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ï¼Œå®ƒä¸ä»…ä½¿æ‚¨è½»æ¾å¿«æ·åœ°é€šè¿‡æ³¨è§£å°±å¯ä»¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè€Œä¸”è¿˜æœ‰AT,XA,TCC,Sagaå››ç§æ¨¡å¼å¯ä»¥é€‰æ‹©ï¼Œå¯ä»¥ä¸ºæ‚¨çš„é¡¹ç›®æä¾›æœ€é€‚åˆçš„æ–¹æ¡ˆã€‚éšç€seataä¸æ–­å‘å±•ï¼Œå®ƒä¹Ÿåœ¨ä¸æ–­åœ°è¦†ç›–æ›´å¤šçš„ä¸šåŠ¡åœºæ™¯ã€‚åœ¨æœªå‘å¸ƒçš„2.6.0ç‰ˆæœ¬ä¸­ï¼Œseataå°±å¯ä»¥æ”¯æŒOracleçš„æ‰¹é‡æ’å…¥è¯­æ³•äº†ï¼æ¥ä¸‹æ¥è®©æˆ‘ä»¬è§£æä¸€ä¸‹å®ƒåˆ°åº•æ˜¯æ€ä¹ˆåšåˆ°çš„å§â¤ï¸</p>
<h2 data-id="heading-1">é—®é¢˜èµ·æº</h2>
<p>ç°åœ¨æœ‰ä¸€ä¸ªSQLè¯­å¥ï¼š<strong>insert all into a (id) values(1) into a (id) values(2) SELECT 1 FROM DUAL</strong>
è¿›å…¥seataå°±ä¼šè¢«è§£ææˆ<code>OracleMultiInsertStatement</code>è¿™ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯åœ¨åŸæ¥seataçš„ä»£ç ä¸­,<code>DruidSQLRecognizerFactoryImpl</code>è¿™ä¸ªå·¥å‚å®ç°ç±»ï¼Œå¹¶ä¸æ”¯æŒè§£æè·å–åˆ°<code>OracleMultiInsertStatement</code>è¿™ä¸ªå¯¹è±¡ï¼ˆåªæ”¯æŒæœ€é€šç”¨çš„å¢åˆ æ”¹æŸ¥ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f26e1be50b34e908704326169749ffc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oOz55Sob2ZmZXLmiZPniYw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763614484&amp;x-signature=3ZsHa7d5i2E%2Fred9fpoz4IRjLNE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">è§£å†³æ­¥éª¤</h2>
<h3 data-id="heading-3">é—®é¢˜åˆ†æ</h3>
<p>è¦æ”¯æŒè¿™ä¸ªè¯­æ³•ï¼Œæˆ‘ä»¬å°±å¿…é¡»å…ˆæ˜ç™½ï¼ŒOracle Insert Batchè¯­æ³•åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿä»¥åŠæˆ‘ä»¬seataåˆ°åº•è¦æ”¯æŒè¿™ä¸ªè¯­æ³•åˆ°å“ªä¸€æ­¥ï¼Ÿæ²¡æœ‰å…¨æ”¯æŒçš„åŸå› åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¸‰ä¸ªé—®é¢˜æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢ä¸€ä¸€è§£ç­”ã€‚</p>
<h4 data-id="heading-4">ä»€ä¹ˆæ˜¯ Oracle Multi-Insertï¼Ÿ</h4>
<p>Oracle æ”¯æŒä¸€ç§ç‰¹æ®Šçš„ <code>INSERT</code> è¯­æ³•ï¼Œå¯ä»¥åœ¨<strong>ä¸€æ¡è¯­å¥ä¸­å‘å¤šä¸ªè¡¨æ’å…¥æ•°æ®</strong>ï¼Œæ ¹æ®æ¡ä»¶å†³å®šæ’å…¥åˆ°å“ªä¸ªï¼ˆæˆ–å“ªäº›ï¼‰è¡¨ã€‚ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªSQLè¯­å¥ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/906082cd0a4f4cd2a63ad3776a46653a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oOz55Sob2ZmZXLmiZPniYw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763614484&amp;x-signature=Setuzab%2F9ht2x3jyDxHikL6Pmy8%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä»€ä¹ˆæ˜¯INSERT ALL / FIRSTï¼Ÿ</strong></p>
<p>1.<code>INSERT FIRST</code> ï¼Œå®ƒæ ¹æ®æ¡ä»¶ï¼Œå°†ä¸€æ¡æºæ•°æ®æ’å…¥åˆ°å¤šä¸ªç›®æ ‡è¡¨ä¸­çš„â€œç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶â€çš„è¡¨ä¸­ï¼ˆä»…æ’å…¥ä¸€æ¬¡ï¼‰ï¼Œ<strong>ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡åˆ¤æ–­Â <code>WHEN</code>Â æ¡ä»¶</strong>ï¼Œ<strong>ä¸€æ—¦æŸä¸ªæ¡ä»¶ä¸ºçœŸï¼Œå°±æ‰§è¡Œå¯¹åº”çš„Â <code>INTO</code>ï¼Œç„¶åè·³è¿‡åç»­æ‰€æœ‰åˆ†æ”¯</strong>ï¼Œ<strong>æ¯è¡Œæºæ•°æ®æœ€å¤šåªè¢«æ’å…¥ä¸€æ¬¡</strong>ï¼ˆå³ä½¿å¤šä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼‰ï¼Œ<code>ELSE</code>Â æ˜¯å¯é€‰çš„ï¼›å¦‚æœæ²¡æœ‰Â <code>ELSE</code>Â ä¸”æ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåˆ™è¯¥è¡Œè¢«ä¸¢å¼ƒã€‚</p>
<p>2.<code>INSERT ALL</code>å’Œ<code>INSERT FIRST</code>ç›¸åï¼Œæ»¡è¶³å¤šä¸ªæ¡ä»¶å°±æ’å…¥å¤šæ¬¡</p>
<p>ps:è¿™ç§è¯­æ³•åœ¨æ ‡å‡† SQL ä¸­<strong>ä¸å­˜åœ¨</strong>ï¼Œæ˜¯ Oracle çš„æ‰©å±•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OracleMultiInsertStatement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">OracleStatementImpl</span>
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ª <strong>ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰èŠ‚ç‚¹ç±»</strong>ï¼Œç”¨äºè¡¨ç¤ºä¸Šè¿° <code>INSERT ALL / FIRST</code> è¯­å¥</p>
<p><strong>æ ¸å¿ƒå­—æ®µè§£é‡Š</strong></p>






























<table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>option</code></td><td><code>Option</code>Â enum (<code>ALL</code>,Â <code>FIRST</code>)</td><td>è¡¨ç¤ºæ˜¯Â <code>INSERT ALL</code>Â è¿˜æ˜¯Â <code>INSERT FIRST</code></td></tr><tr><td><code>subQuery</code></td><td><code>SQLSelect</code></td><td>æœ€åçš„Â <code>SELECT ...</code>Â å­æŸ¥è¯¢ï¼Œæä¾›æ•°æ®æº</td></tr><tr><td><code>entries</code></td><td><code>List&lt;Entry&gt;</code></td><td>æ’å…¥è§„åˆ™åˆ—è¡¨ï¼Œæ¯ä¸ªÂ <code>Entry</code>Â æ˜¯ä¸€ä¸ªæ’å…¥åˆ†æ”¯ï¼ˆå¯èƒ½æ˜¯æ¡ä»¶åˆ†æ”¯æˆ–æ— æ¡ä»¶æ’å…¥ï¼‰</td></tr><tr><td><code>hints</code></td><td><code>List&lt;SQLHint&gt;</code></td><td>Oracle çš„ä¼˜åŒ–å™¨æç¤ºï¼ˆå¦‚Â <code>/*+ APPEND */</code>ï¼‰</td></tr></tbody></table>
<p><strong>å†…éƒ¨ç±»è¯¦è§£</strong></p>
<p>1.<strong>Entryæ¥å£</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">OracleSQLObject</span>
</code></pre>
<p>è¿™æ˜¯ <code>entries</code> åˆ—è¡¨ä¸­å…ƒç´ çš„é€šç”¨æ¥å£ã€‚ç›®å‰æœ‰ä¸¤ä¸ªå®ç°ï¼š</p>
<ul>
<li><code>ConditionalInsertClause</code>ï¼ˆå¸¦Â <code>WHEN/ELSE</code>Â çš„æ¡ä»¶æ’å…¥ï¼‰</li>
<li><code>InsertIntoClause</code>ï¼ˆæ— æ¡ä»¶ç›´æ¥æ’å…¥ï¼‰</li>
</ul>
<p>è¿™æ ·å†™æ˜¯ä¸ºäº†å¯ä»¥æ”¯æŒæ··åˆå†™æ³•</p>
<ol start="2">
<li><strong>ConditionalInsertClauseItem</strong></li>
</ol>
<p>ä»£è¡¨ä¸€ä¸ª <code>WHEN ... THEN ...</code> åˆ†æ”¯ã€‚</p>
<ul>
<li><code>when</code>:Â <code>SQLExpr</code>Â â†’ æ¡ä»¶è¡¨è¾¾å¼ï¼ˆå¦‚Â <code>dept = 'IT'</code>ï¼‰</li>
<li><code>then</code>:Â <code>InsertIntoClause</code>Â â†’ æ»¡è¶³æ¡ä»¶æ—¶è¦æ‰§è¡Œçš„Â <code>INSERT INTO ...</code></li>
</ul>
<p>è¦è®°ä½çš„æ˜¯ï¼Œ<code>ConditionalInsertClause</code>åŒ…å«äº†<code>ConditionalInsertClauseItem</code>å…¨éƒ¨ã€‚</p>
<h4 data-id="heading-5">seataæ”¯æŒè¯¥è¯­æ³•åˆ°å“ªä¸€æ­¥å‘¢ï¼Ÿ</h4>
<p>ç›®å‰ï¼Œseataåªæ”¯æŒåŒä¸€ä¸ªè¡¨çš„å¤šæ’å…¥(åˆ—ä¸€è‡´)ï¼Œè€Œä¸”ä¹Ÿä¸æ”¯æŒæ¡ä»¶æ’å…¥ä¸Insert Firstè¯­æ³•ã€‚
é‚£è¿™æ ·è¯»è€…å°±ä¼šæœ‰ç–‘é—®äº†ï¼Œé‚£è¿™æ ·å²‚ä¸æ˜¯å’ŒSQLå¤šæ’å…¥è¯­æ³•å·®ä¸å¤šå—ï¼Ÿæ˜¯çš„ï¼Œä½ çš„çŒœæµ‹ä¸é”™ã€‚</p>
<p>å¯¹äºä¸Šè¿°ä¸æ”¯æŒçš„æƒ…å†µï¼Œseataä¼šæŠ›å‡º<code>NotSupportYetException</code>è¿™ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ç»™ä¸Šæ¸¸åº”ç”¨å±‚æ•è·ï¼Œä»£è¡¨seataä¸æ”¯æŒè¿™ç§æƒ…å†µã€‚</p>
<h4 data-id="heading-6">æ²¡æœ‰å…¨æ”¯æŒOracleæ‰¹é‡æ’å…¥çš„è¯­æ³•åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<p>é¦–å…ˆæˆ‘ä»¬ä¸æ˜¯ä¸ºäº†æ”¯æŒè€Œæ”¯æŒï¼Œseataæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸­é—´ä»¶ï¼Œå¦‚æœæ˜¯æ¶‰åŠåˆ°ä¸åŒè¡¨çš„æ›´æ”¹ï¼Œæˆ‘ä»¬æ›´åŠ æ¨èåœ¨åˆ†æ”¯äº‹åŠ¡æ¥è¿›è¡Œæ›´æ”¹ï¼Œè€Œä¸æ˜¯åœ¨åŒä¸€ä¸ªSQLè¯­å¥é‡Œé¢è¿›è¡Œæ›´æ”¹ã€‚<strong>æ‹†æˆå¤šä¸ªå•è¡¨ SQLï¼Œåœ¨å¤šä¸ªåˆ†æ”¯äº‹åŠ¡ä¸­æ‰§è¡Œ</strong>ï¼Œæ˜¯æ›´å®‰å…¨ã€å¯å›æ»šçš„åšæ³•ã€‚</p>
<p>å…³äºæ¡ä»¶æ’å…¥å’ŒInsert Firstè¯­æ³•ï¼Œæˆ‘ä»¬æ›´æ¨èæ˜¯åœ¨æœåŠ¡å±‚å¤„ç†æ¡ä»¶é€»è¾‘ï¼Œè€Œä¸æ˜¯ç•™åˆ°æ•°æ®å±‚å†è¿›è¡Œå¤„ç†ã€‚æ•°æ®åº“åº”èšç„¦äº<strong>é«˜æ•ˆå­˜å‚¨ä¸æŸ¥è¯¢</strong>ï¼Œè€Œéå¤æ‚ä¸šåŠ¡é€»è¾‘</p>
<p>è¿™æ ·åšçš„æ ¸å¿ƒè€ƒé‡åŒ…æ‹¬ï¼š<strong>ä¿éšœåˆ†å¸ƒå¼äº‹åŠ¡çš„å¯é æ€§ã€æå‡ä»£ç å¯ç»´æŠ¤æ€§ã€é¿å…æ•°æ®åº“æ–¹è¨€ç»‘å®šï¼Œä»¥åŠç¡®ä¿ä¸šåŠ¡é€»è¾‘çš„ç»Ÿä¸€ç®¡æ§</strong>ï¼Œè€Œä¸ä»…ä»…æ˜¯æ‰§è¡Œæ•ˆç‡ã€‚</p>
<h3 data-id="heading-7">æ”¯æŒæ­¥éª¤ä¸€: OracleMultiInsertRecognizer</h3>
<p>okï¼Œè®²å®Œäº†å®šä¹‰ä¸åŸå› ï¼Œæ¥ä¸‹æ¥å°±åº”è¯¥æ¥è®²å¦‚ä½•å®ç°äº†è¿™ç§ç®€åŒ–çš„Oracleæ‰¹é‡æ’å…¥è¯­æ³•äº†ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆåº”è¯¥å®ç°<code>OracleMultiInsertRecognizer</code>è¿™ä¸ªè¯†åˆ«å™¨ç±»ï¼Œè¿™é‡Œè¿ç”¨äº†ç­–ç•¥æ¨¡å¼ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå•ä¸€èŒè´£ç­‰å¤šç§è®¾è®¡æ¨¡å¼ä¸åŸåˆ™ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OracleMultiInsertRecognizer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseOracleRecognizer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SQLInsertRecognizer</span>
</code></pre>
<h4 data-id="heading-8">è®¾è®¡æ¨¡å¼</h4>
<p><strong>ç­–ç•¥æ¨¡å¼çš„ä½“ç°</strong></p>
<ul>
<li><code>OracleMultiInsertRecognizer</code>Â å®ç°äº†Â <code>SQLInsertRecognizer</code>Â æ¥å£ã€‚</li>
<li>Seata åœ¨è¿è¡Œæ—¶ä¼šæ ¹æ® SQL çš„ AST ç±»å‹ï¼ˆå¦‚Â <code>SQLInsertStatement</code>ï¼Œ<code>OracleMultiInsertStatement</code>Â ç­‰ï¼‰<strong>åŠ¨æ€é€‰æ‹©å¯¹åº”çš„ Recognizer å®ç°ç±»</strong></li>
</ul>
<p><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä½“ç°</strong></p>
<ul>
<li>ç»§æ‰¿è‡ªÂ <code>BaseOracleRecognizer</code>ï¼ˆåŸºç±»ï¼‰ï¼Œè¯¥åŸºç±»å®šä¹‰äº†é€šç”¨è§£ææµç¨‹ï¼Œå­ç±»å¯ä»¥ç›´æ¥ç»§æ‰¿å¤ç”¨æŠ½è±¡çˆ¶ç±»çš„æ–¹æ³•ã€‚</li>
</ul>
<p><strong>å•ä¸€èŒè´£åŸåˆ™ + æ¥å£éš”ç¦»</strong></p>
<ul>
<li><code>SQLInsertRecognizer</code>Â æ¥å£åªå®šä¹‰ INSERT ç›¸å…³çš„æ–¹æ³•ï¼ˆ<code>getTableName</code>,Â <code>getInsertColumns</code>,Â <code>getInsertRows</code>Â ç­‰ï¼‰ï¼›</li>
<li><code>OracleMultiInsertRecognizer</code>Â <strong>åªè´Ÿè´£è¯†åˆ«ä¸€ç§ç‰¹å®šè¯­æ³•</strong>ï¼Œä¸å¤„ç† UPDATE/DELETEï¼›</li>
<li>æ ¡éªŒé€»è¾‘ï¼ˆ<code>validateSingleTableConsistency</code>ï¼‰ä¸æ•°æ®æå–é€»è¾‘ï¼ˆ<code>getInsertRows</code>ï¼‰åˆ†ç¦»ã€‚</li>
</ul>
<h4 data-id="heading-9">å…·ä½“é€»è¾‘</h4>
<p>è¿™é‡ŒæŒ‘å‡ ä¸ªé‡è¦çš„è®²å³å¯ï¼Œå‰©ä¸‹å¤§å®¶å»çœ‹æºç å³å¯ã€‚</p>
<p>1.Â <code>validateSingleTableConsistency()</code></p>
<p>è¿™æ˜¯<strong>æœ€æ ¸å¿ƒçš„æ ¡éªŒé€»è¾‘</strong>ï¼š</p>
<ul>
<li>
<p>éå†æ‰€æœ‰Â <code>Entry</code>ï¼ˆæ¯ä¸ªÂ <code>INTO ...</code>Â å­å¥ï¼‰ï¼›</p>
</li>
<li>
<p>å¦‚æœé‡åˆ°Â <code>ConditionalInsertClause</code>ï¼ˆå³Â <code>WHEN...THEN</code>ï¼‰â†’Â <strong>æŠ›å‡ºå¼‚å¸¸</strong>ï¼Œè¯´æ˜å¹¶ä¸æ”¯æŒè¿™ç§è¯­æ³•ï¼›</p>
</li>
<li>
<p>å¯¹æ¯ä¸ªÂ <code>InsertIntoClause</code>ï¼š</p>
<ul>
<li>æå–è¡¨åï¼ˆé€šè¿‡Â <code>OracleOutputVisitor</code>Â æ¸²æŸ“ AST å¾—åˆ°å­—ç¬¦ä¸²ï¼‰ï¼›</li>
<li>æå–åˆ—åï¼ˆåªæ”¯æŒÂ <code>SQLIdentifierExpr</code>ï¼Œå³æ™®é€šåˆ—åï¼‰ï¼›</li>
<li>ä¸ç¬¬ä¸€ä¸ªå­å¥å¯¹æ¯”ï¼š<strong>è¡¨åå¿…é¡»ç›¸åŒï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Œåˆ—åˆ—è¡¨å¿…é¡»å®Œå…¨ä¸€è‡´</strong>ï¼›</li>
</ul>
</li>
<li>
<p>æˆåŠŸåç¼“å­˜Â <code>validatedTableName</code>Â å’ŒÂ <code>validatedColumns</code></p>
</li>
</ul>
<p>2.<code>getInsertRows(...)</code></p>
<p>ç”¨äºæå–æ‰€æœ‰è¦æ’å…¥çš„<strong>å…·ä½“å€¼ï¼ˆç”¨äºç”Ÿæˆ undo logï¼‰</strong> ï¼š</p>
<ul>
<li>
<p>éå†æ¯ä¸ªÂ <code>InsertIntoClause</code>Â çš„Â <code>VALUES</code>Â åˆ—è¡¨ï¼›</p>
</li>
<li>
<p>å¯¹æ¯ä¸ªè¡¨è¾¾å¼åšç±»å‹åˆ¤æ–­ï¼š</p>
<ul>
<li><code>SQLNullExpr</code>Â â†’ è½¬ä¸ºÂ <code>Null.get()</code>ï¼ˆSeata å†…éƒ¨ç©ºå€¼è¡¨ç¤ºï¼‰</li>
<li><code>SQLValuableExpr</code>ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°å­—ï¼‰â†’ å–Â <code>.getValue()</code></li>
<li><code>SQLVariantRefExpr</code>ï¼ˆå¦‚Â <code>:var</code>Â ç»‘å®šå˜é‡ï¼‰â†’ ä¿ç•™å˜é‡å</li>
<li><code>SQLMethodInvokeExpr</code>ï¼ˆå¦‚Â <code>SYSDATE</code>ï¼‰â†’ æ ‡è®°ä¸ºÂ <code>SqlMethodExpr.get()</code></li>
<li><code>SQLSequenceExpr</code>ï¼ˆå¦‚Â <code>seq.nextval</code>ï¼‰â†’ å°è£…ä¸ºÂ <code>SqlSequenceExpr</code></li>
<li>å…¶ä»–å¤æ‚è¡¨è¾¾å¼ â†’ è‹¥è¯¥ä½ç½®æ˜¯ä¸»é”®ï¼Œåˆ™æŠ¥é”™ï¼›å¦åˆ™æ ‡è®°ä¸ºÂ <code>NotPlaceholderExpr.get()</code></li>
</ul>
</li>
</ul>
<h3 data-id="heading-10">æ”¯æŒæ­¥éª¤äºŒï¼šOracleOperateRecognizerHolder</h3>
<p>è¿™ä¸ªå®¹å™¨å¯ä»¥æ ¹æ®astè¯­æ³•çš„ä¸åŒï¼Œä»è€Œè¿”å›ä¸åŒçš„è¯†åˆ«å™¨ï¼Œæœ‰ç­–ç•¥æ¨¡å¼çš„æ€æƒ³åœ¨é‡Œé¢ã€‚
æˆ‘ä»¬åœ¨è¿™æ–°æ·»ä¸€ä¸ªå¯ä»¥è¿”å›æˆ‘ä»¬ç¬¬ä¸€æ­¥åšçš„æ‰¹é‡æ’å…¥çš„è¯†åˆ«å™¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> SQLRecognizer <span class="hljs-title function_">getMultiInsertRecognizer</span><span class="hljs-params">(String sql, SQLStatement ast)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OracleMultiInsertRecognizer</span>(sql, ast);
}
</code></pre>
<h3 data-id="heading-11">æ”¯æŒæ­¥éª¤ä¸‰ï¼šDruidSQLRecognizerFactoryImpl</h3>
<p>å½“åœ¨druidè¯†åˆ«å™¨å·¥å‚ç±»è¯†åˆ«åˆ°ç›¸å…³çš„sqlStatementï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹åº”å…¥åº§ï¼Œä¸åŒçš„sqlStatementåˆ†é…ä¸åŒçš„è¯†åˆ«å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sqlStatement <span class="hljs-keyword">instanceof</span> OracleMultiInsertStatement) {
    <span class="hljs-type">OracleMultiInsertStatement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> (OracleMultiInsertStatement) sqlStatement;
    <span class="hljs-keyword">if</span> (stmt.getOption() == OracleMultiInsertStatement.Option.FIRST) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NotSupportYetException</span>(<span class="hljs-string">"INSERT FIRST not supported yet"</span>);
    }
    <span class="hljs-comment">// Use specialized methods to handle Oracle bulk inserts</span>
    recognizer =
            ((OracleOperateRecognizerHolder) recognizerHolder).getMultiInsertRecognizer(sql, sqlStatement);
}
</code></pre>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>é‚£ä¹ˆä»¥ä¸Šå°±æ˜¯seataå°†è¦æ”¯æŒçš„oracleæ‰¹é‡æ’å…¥çš„è§£æäº†ï¼Œåé¢æˆ‘å°†æ›´æ–°æ›´å¤šæœ‰å…³äºseataçš„è§£æï¼Œå–œæ¬¢çš„å¯ä»¥ç‚¹ä¸ªå…³æ³¨ï¼Œè°¢è°¢ä½ ä»¬</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ª"New Chat"æŒ‰é’®ï¼Œä¸ºä»€ä¹ˆè¦é‡æ„æ•´ä¸ªæ¶æ„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7571731181198262308</link>    <guid>https://juejin.cn/post/7571731181198262308</guid>    <pubDate>2025-11-13T03:38:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571731181198262308" data-draft-id="7571747061385707539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ª&quot;New Chat&quot;æŒ‰é’®ï¼Œä¸ºä»€ä¹ˆè¦é‡æ„æ•´ä¸ªæ¶æ„ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Next.js"/> <meta itemprop="datePublished" content="2025-11-13T03:38:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´å°˜"/> <meta itemprop="url" content="https://juejin.cn/user/3389172758899188"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ª"New Chat"æŒ‰é’®ï¼Œä¸ºä»€ä¹ˆè¦é‡æ„æ•´ä¸ªæ¶æ„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3389172758899188/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´å°˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:38:40.000Z" title="Thu Nov 13 2025 03:38:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªçœŸå®çš„çº¿ä¸Šæ•…éšœï¼šç”¨æˆ·ç‚¹å‡»"New Chat"æŒ‰é’®åï¼Œç¬¬ä¸€æ¡æ¶ˆæ¯ç»å¸¸å‘åˆ°æ—§ä¼šè¯é‡Œã€‚çœ‹èµ·æ¥æ˜¯ä¸ªå° bugï¼Œå®é™…ä¸Šæš´éœ²äº†æ•´ä¸ªå¤šä¼šè¯ç®¡ç†æ¶æ„çš„æ ¹æœ¬ç¼ºé™·ã€‚</p>
</blockquote>
<h2 data-id="heading-0">æ•…éšœç°åœº</h2>
<p>ç”¨æˆ·æ“ä½œå¾ˆç®€å•ï¼š</p>
<ol>
<li>åœ¨ä¼šè¯ A é‡ŒèŠäº†å‡ è½®</li>
<li>ç‚¹å‡»"New Chat"æŒ‰é’®</li>
<li>è¾“å…¥ç¬¬ä¸€å¥è¯ï¼Œå›è½¦</li>
</ol>
<p><strong>é¢„æœŸ</strong>ï¼šæ¶ˆæ¯å‡ºç°åœ¨æ–°ä¼šè¯é‡Œ</p>
<p><strong>å®é™…</strong>ï¼šæ¶ˆæ¯è·‘åˆ°ä¼šè¯ A é‡Œäº†</p>
<p>æˆ–è€…æ›´è¯¡å¼‚çš„æƒ…å†µï¼š</p>
<ol>
<li>ç‚¹"New Chat"</li>
<li>ç•Œé¢è¿˜æ˜¾ç¤ºç€æ—§æ¶ˆæ¯</li>
<li>è¾“å…¥æ¡†æ˜¯ç°è‰²çš„ï¼Œæç¤º"ç³»ç»Ÿç¹å¿™"</li>
</ol>
<p>åŸå› æ˜¯ä¸Šä¸ªä¼šè¯è¿˜åœ¨æµå¼è¾“å‡ºï¼ŒæŠŠæ–°ä¼šè¯çš„è¾“å…¥æ¡†ä¹Ÿé”ä½äº†ã€‚</p>
<h2 data-id="heading-1">æ ¹å› ï¼šä¸‰æœ¬è´¦æœ¬çš„æˆ˜äº‰</h2>
<h3 data-id="heading-2">è´¦æœ¬ä¸€ï¼šæœåŠ¡å™¨ç”Ÿæˆçš„ ID</h3>
<p><code>app/(chat)/page.tsx</code> æ˜¯æœåŠ¡å™¨ç»„ä»¶ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ UUIDï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ChatPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> sessionId = <span class="hljs-title function_">generateUUID</span>(); <span class="hljs-comment">// æœåŠ¡å™¨è¯´ï¼šè¿™æ˜¯æ–°ä¼šè¯çš„ ID</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ChatClient</span> <span class="hljs-attr">initialSessionId</span>=<span class="hljs-string">{sessionId}</span> /&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-3">è´¦æœ¬äºŒï¼šå®¢æˆ·ç«¯ç»„ä»¶çš„çŠ¶æ€</h3>
<p><code>components/chat.tsx</code> ç»´æŠ¤è‡ªå·±çš„ <code>currentSessionId</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> [currentSessionId, setCurrentSessionId] = <span class="hljs-title function_">useState</span>(initialSessionId);
</code></pre>
<p>åŒæ—¶è¿˜ç»´æŠ¤äº†ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨çš„å‰¯æœ¬ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> [messagesState, setMessagesState] = useState&lt;<span class="hljs-title class_">Message</span>[]&gt;([]);
<span class="hljs-keyword">const</span> storeMessages = <span class="hljs-title function_">useChatStore</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">messages</span>[currentSessionId]);

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setMessagesState</span>(storeMessages); <span class="hljs-comment">// æ‰‹åŠ¨åŒæ­¥</span>
}, [storeMessages]);
</code></pre>
<h3 data-id="heading-4">è´¦æœ¬ä¸‰ï¼šZustand å…¨å±€ store</h3>
<p>Store é‡Œå­˜ç€æ‰€æœ‰ä¼šè¯æ•°æ®ï¼Œè¿˜æœ‰ä¸€ä¸ªå…¨å±€çš„ <code>isStreaming</code> æ ‡å¿—ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatStore</span> {
  <span class="hljs-attr">sessions</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Session</span>&gt;;
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Message</span>[]&gt;;
  <span class="hljs-attr">isStreaming</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// å…¨å±€å…±äº«</span>
}
</code></pre>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆä¼šå‡ºé—®é¢˜</h3>
<p>å½“ç”¨æˆ·ç‚¹"New Chat"æ—¶ï¼š</p>
<ol>
<li><code>router.push('/')</code> è§¦å‘è·¯ç”±è·³è½¬</li>
<li>æœåŠ¡å™¨ç”Ÿæˆæ–° IDï¼š<code>uuid-123</code></li>
<li>å®¢æˆ·ç«¯ç»„ä»¶æŒ‚è½½ï¼Œ<code>currentSessionId</code> è¢«è®¾ç½®ä¸º <code>uuid-123</code></li>
<li>ä½†ç”¨æˆ·å¿«é€Ÿè¾“å…¥æ¶ˆæ¯ï¼Œæ­¤æ—¶ <code>handleSubmit</code> é—­åŒ…é‡Œæ•è·çš„å¯èƒ½è¿˜æ˜¯æ—§ IDï¼š<code>uuid-456</code></li>
<li>æ¶ˆæ¯å‘åˆ°äº†é”™è¯¯çš„ä¼šè¯</li>
</ol>
<p>æˆ–è€…å¦ä¸€ç§æƒ…å†µï¼š</p>
<ol>
<li>ä¼šè¯ A æ­£åœ¨æµå¼è¾“å‡ºï¼Œ<code>isStreaming = true</code></li>
<li>ç”¨æˆ·ç‚¹"New Chat"åˆ‡æ¢åˆ°ä¼šè¯ B</li>
<li>ä¼šè¯ B çš„è¾“å…¥æ¡†æ£€æŸ¥ <code>isStreaming</code>ï¼Œå‘ç°æ˜¯ <code>true</code></li>
<li>è¾“å…¥æ¡†è¢«ç¦ç”¨</li>
</ol>
<p>ä¸‰æœ¬è´¦æœ¬å„è¯´å„è¯ï¼Œç³»ç»Ÿè¡Œä¸ºå˜å¾—ä¸å¯é¢„æµ‹ã€‚</p>
<h2 data-id="heading-6">é‡æ„ç­–ç•¥ï¼šç¡®ç«‹å”¯ä¸€ä¸»æƒ</h2>
<p>ä¸æ˜¯ä¿®ä¿®è¡¥è¡¥ï¼Œè€Œæ˜¯æ˜ç¡®å›ç­”ä¸€ä¸ªé—®é¢˜ï¼š<strong>è°æ‹¥æœ‰ session ID çš„ç”Ÿæˆå’Œç®¡ç†æƒï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å®¢æˆ·ç«¯</strong>ã€‚</p>
<p>æœåŠ¡å™¨åªè´Ÿè´£æŒä¹…åŒ–æ•°æ®ï¼Œä¸å‚ä¸ ID çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚æ‰€æœ‰çŠ¶æ€çš„å˜æ›´éƒ½ä»¥å®¢æˆ·ç«¯çš„ <code>currentSessionId</code> ä¸ºå‡†ã€‚</p>
<h2 data-id="heading-7">é‡æ„æ­¥éª¤</h2>
<h3 data-id="heading-8">ç¬¬ä¸€æ­¥ï¼šID ä¸»æƒæ”¶å½’å®¢æˆ·ç«¯</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> [currentSessionId, setCurrentSessionId] = useState&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
<span class="hljs-keyword">const</span> { chatId } = <span class="hljs-title function_">useParams</span>(); <span class="hljs-comment">// ä» URL è¯»å–</span>

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (chatId) {
    <span class="hljs-comment">// URL æœ‰ IDï¼Œå°±ç”¨å®ƒ</span>
    <span class="hljs-title function_">setCurrentSessionId</span>(chatId);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ²¡æœ‰ IDï¼Œå®¢æˆ·ç«¯è‡ªå·±ç”Ÿæˆ</span>
    <span class="hljs-keyword">const</span> newId = <span class="hljs-title function_">generateUUID</span>();
    <span class="hljs-title function_">setCurrentSessionId</span>(newId);
  }
}, [chatId]);
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<p>å®¢æˆ·ç«¯åœ¨æŒ‚è½½æ—¶ç«‹å³å†³å®šç”¨å“ªä¸ª IDï¼Œä¸ç­‰æœåŠ¡å™¨ï¼Œä¸ä¾èµ– propsã€‚URL æ˜¯å”¯ä¸€çš„çœŸç›¸æ¥æºã€‚</p>
<p>åŒæ—¶è°ƒç”¨ <code>ensureSessionExists(newId)</code>ï¼Œåœ¨ store é‡Œåˆ›å»ºä¼šè¯è®°å½•ï¼ˆæ ‡é¢˜"New Chat"ã€é»˜è®¤æ¨¡å‹ã€ç§æœ‰å¯è§æ€§ï¼‰ã€‚è¿™æ˜¯åŸå­æ“ä½œï¼Œä¸ä¼šå‡ºç°"ID æœ‰äº†ä½†æ•°æ®è¿˜æ²¡å‡†å¤‡å¥½"çš„ä¸­é—´çŠ¶æ€ã€‚</p>
<h3 data-id="heading-9">ç¬¬äºŒæ­¥ï¼šåˆ é™¤çŠ¶æ€å‰¯æœ¬</h3>
<p>ç›´æ¥åˆ æ‰ <code>messagesState</code> å’ŒåŒæ­¥çš„ <code>useEffect</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// âŒ åˆ æ‰</span>
<span class="hljs-comment">// const [messagesState, setMessagesState] = useState&lt;Message[]&gt;([]);</span>
<span class="hljs-comment">// useEffect(() =&gt; { setMessagesState(storeMessages); }, [storeMessages]);</span>

<span class="hljs-comment">// âœ… ç›´æ¥ä» store è¯»</span>
<span class="hljs-keyword">const</span> messages = <span class="hljs-title function_">useChatStore</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-title function_">getSessionMessages</span>(currentSessionId));
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åš</strong>ï¼š</p>
<p>ç»´æŠ¤ä¸¤ä»½æ•°æ®ï¼ˆstore + local stateï¼‰å¿…ç„¶ä¼šå‡ºç°åŒæ­¥é—®é¢˜ã€‚<code>useEffect</code> çš„æ‰§è¡Œæ—¶æœºç”± React è°ƒåº¦ï¼Œåˆ‡æ¢ä¼šè¯æ—¶å¯èƒ½å»¶è¿Ÿï¼Œå¯¼è‡´ UI æ˜¾ç¤ºæ—§æ•°æ®ã€‚</p>
<p>ç°åœ¨ <code>getSessionMessages</code> æ˜¯ä¸€ä¸ª selectorï¼Œä» store ç›´æ¥è¯»å–ã€‚Store æ›´æ–° â†’ ç»„ä»¶è‡ªåŠ¨é‡æ¸²æŸ“ã€‚å•å‘æ•°æ®æµï¼Œæ²¡æœ‰ä¸­é—´çŠ¶æ€ã€‚</p>
<p>åŒæ—¶ <code>sendChatMessage</code>ï¼ˆ<code>lib/services/chat-service.ts</code>ï¼Œ64-91 è¡Œï¼‰ç›´æ¥å¾€ store å†™æ¶ˆæ¯ï¼š</p>
<ol>
<li>æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</li>
<li>æ·»åŠ  assistant å ä½æ¶ˆæ¯ï¼ˆcontent ä¸ºç©ºï¼‰</li>
<li>æµå¼æ•°æ®åˆ°è¾¾æ—¶ï¼Œé€å­—è¿½åŠ åˆ°å ä½æ¶ˆæ¯</li>
</ol>
<h3 data-id="heading-10">ç¬¬ä¸‰æ­¥ï¼šçŠ¶æ€éš”ç¦»åˆ°ä¼šè¯çº§</h3>
<p>æŠŠå…¨å±€çš„ <code>isStreaming</code> æ”¹æˆä¼šè¯çº§çš„ <code>streamingStatus</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Session</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">streamingStatus</span>: <span class="hljs-string">'idle'</span> | <span class="hljs-string">'streaming'</span> | <span class="hljs-string">'awaiting_message'</span>;
}

<span class="hljs-comment">// æ–° API</span>
<span class="hljs-title function_">setStreaming</span>(<span class="hljs-attr">sessionId</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">isStreaming</span>: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">void</span>;
</code></pre>
<p><strong>ä½¿ç”¨ä½ç½®</strong>ï¼š</p>
<ul>
<li>Line 506ï¼š<code>handleSubmit</code> å¼€å§‹æ—¶è°ƒç”¨ <code>setStreaming(currentSessionId, true)</code></li>
<li>Line 643ï¼šæµå¼ç»“æŸæ—¶è°ƒç”¨ <code>setStreaming(currentSessionId, false)</code></li>
<li>Line 678ï¼šå¼‚å¸¸å¤„ç†æ—¶ä¹Ÿä¼šé‡ç½®çŠ¶æ€</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åš</strong>ï¼š</p>
<p>ä¼šè¯ A çš„æµå¼çŠ¶æ€ä¸åº”è¯¥å½±å“ä¼šè¯ Bã€‚æ¯ä¸ªä¼šè¯æ˜¯ç‹¬ç«‹çš„çŠ¶æ€æœºã€‚</p>
<p>è¾“å…¥æ¡†çš„ç¦ç”¨é€»è¾‘æ”¹æˆï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> status = <span class="hljs-title function_">useChatStore</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">sessions</span>[currentSessionId]?.<span class="hljs-property">streamingStatus</span>);
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{status</span> === <span class="hljs-string">'streaming'</span>} /&gt;</span></span>
</code></pre>
<h3 data-id="heading-11">ç¬¬å››æ­¥ï¼šæ•°æ®æµåŠ¨æ€ç»‘å®š</h3>
<p>æŠŠ <code>DataStreamHandler</code> çš„åˆå§‹åŒ–æŒªè¿› <code>useEffect</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (!currentSessionId) <span class="hljs-keyword">return</span>;
  
  <span class="hljs-keyword">const</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataStreamHandler</span>({
    <span class="hljs-attr">sessionId</span>: currentSessionId,
    <span class="hljs-attr">onArtifact</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      useChatStore.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">addArtifact</span>(currentSessionId, data);
    },
    <span class="hljs-attr">onGuardrail</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      useChatStore.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">addGuardrail</span>(currentSessionId, data);
    }
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> handler.<span class="hljs-title function_">cleanup</span>(); <span class="hljs-comment">// æ¸…ç†æ—§ handler</span>
}, [currentSessionId]); <span class="hljs-comment">// ä¾èµ–å½“å‰ ID</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åš</strong>ï¼š</p>
<p>AI å“åº”ä¸åªæœ‰æ–‡æœ¬ï¼Œè¿˜æœ‰ artifactsï¼ˆä»£ç å—ï¼‰ã€guardrailsï¼ˆå®‰å…¨æ£€æŸ¥ï¼‰ã€suggestionsï¼ˆæ¨èé—®é¢˜ï¼‰ã€‚è¿™äº›æ•°æ®é€šè¿‡ SSE æµå¼ä¼ è¾“ï¼Œå¿…é¡»å†™å…¥æ­£ç¡®çš„ä¼šè¯ã€‚</p>
<p>ä¹‹å‰ <code>DataStreamHandler</code> åœ¨æ¨¡å—åŠ è½½æ—¶åˆ›å»ºï¼Œç»‘å®šçš„æ˜¯é™æ€ IDã€‚åˆ‡æ¢ä¼šè¯åï¼Œæ–‡æœ¬å†…å®¹æ˜¯å¯¹çš„ï¼ˆå› ä¸º <code>sendMessage</code> ç”¨çš„æ˜¯æ–° IDï¼‰ï¼Œä½†é™„åŠ æ•°æ®è¿˜åœ¨å¾€æ—§ä¼šè¯å†™ã€‚</p>
<p>ç°åœ¨ <code>useEffect</code> ç›‘å¬ <code>currentSessionId</code>ï¼ŒID å˜åŒ–æ—¶ï¼š</p>
<ol>
<li>æ—§ handler æ‰§è¡Œ <code>cleanup()</code></li>
<li>æ–° handler åˆ›å»ºï¼Œé—­åŒ…æ•è·æœ€æ–° ID</li>
<li>æ‰€æœ‰å›è°ƒéƒ½å†™å…¥æ­£ç¡®çš„ä¼šè¯</li>
</ol>
<h2 data-id="heading-12">ä¿®å¤åçš„å®Œæ•´æµç¨‹</h2>
<p>ç”¨æˆ·ç‚¹"New Chat"ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p>
<p><strong>T1</strong>ï¼šç‚¹å‡»æŒ‰é’® â†’ <code>router.push('/')</code></p>
<p><strong>T2</strong>ï¼šURL å˜æˆæ ¹è·¯å¾„ â†’ <code>chatId</code> å˜ä¸º <code>undefined</code></p>
<p><strong>T3</strong>ï¼š<code>useEffect</code> æ£€æµ‹åˆ° <code>chatId</code> ä¸ºç©º â†’ ç”Ÿæˆæ–° ID <code>abc-123</code> â†’ <code>setCurrentSessionId('abc-123')</code> â†’ <code>ensureSessionExists('abc-123')</code> åœ¨ store åˆ›å»ºç©ºä¼šè¯</p>
<p><strong>T4</strong>ï¼šç”¨æˆ·è¾“å…¥æ¶ˆæ¯ï¼Œç‚¹å‡»å‘é€</p>
<p><strong>T5</strong>ï¼š<code>handleSubmit</code> æ‰§è¡Œ â†’ æ£€æŸ¥ <code>sessions['abc-123'].streamingStatus</code> æ˜¯ <code>'idle'</code> â†’ <code>setStreaming('abc-123', true)</code> â†’ <code>router.replace('/chat/abc-123')</code> æ›´æ–° URL â†’ <code>sendChatMessage({ sessionId: 'abc-123', content: '...' })</code></p>
<p><strong>T6</strong>ï¼š<code>sendChatMessage</code> å†…éƒ¨ â†’ æ·»åŠ ç”¨æˆ·æ¶ˆæ¯ â†’ æ·»åŠ  assistant å ä½ â†’ å‘èµ· API è¯·æ±‚</p>
<p><strong>T7</strong>ï¼šSSE æ•°æ®åˆ°è¾¾ â†’ <code>DataStreamHandler</code> äº‹ä»¶è§¦å‘ â†’ <code>onText</code> è¿½åŠ æ–‡æœ¬ â†’ <code>onArtifact</code> æ·»åŠ ä»£ç å— â†’ éƒ½å†™å…¥ <code>'abc-123'</code></p>
<p><strong>T8</strong>ï¼šæµå¼ç»“æŸ â†’ <code>setStreaming('abc-123', false)</code></p>
<p>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼ŒID å§‹ç»ˆæ˜¯ <code>'abc-123'</code>ã€‚æ²¡æœ‰ç«æ€ï¼Œæ²¡æœ‰æ•°æ®å†™é”™ã€‚</p>
<h2 data-id="heading-13">å¯¹æ¯”ï¼šé‡æ„å‰åçš„æ¶æ„å·®å¼‚</h2>
<h3 data-id="heading-14">é‡æ„å‰</h3>
<pre><code class="hljs language-css" lang="css">æœåŠ¡å™¨ç”Ÿæˆ ID-<span class="hljs-selector-tag">A</span>
    â†“
å®¢æˆ·ç«¯ç»´æŠ¤ ID-<span class="hljs-selector-tag">B</span>ï¼ˆå¯èƒ½ä¸åŒæ­¥ï¼‰
    â†“
handleSubmit ç”¨ ID-<span class="hljs-selector-tag">B</span> å‘é€
    â†“
æ¶ˆæ¯å†™å…¥ storeï¼Œä½† UI æ¸²æŸ“ local stateï¼ˆå¯èƒ½å»¶è¿Ÿï¼‰
    â†“
å…¨å±€ isStreaming é”ä½æ‰€æœ‰ä¼šè¯
    â†“
DataStreamHandler ç»‘å®šé™æ€ ID-Cï¼ˆä¸ä¼šæ›´æ–°ï¼‰
</code></pre>
<p>æ¯ä¸€å±‚éƒ½å¯èƒ½æ‹¿åˆ°ä¸åŒçš„ IDï¼ŒçŠ¶æ€åˆ†æ•£åœ¨å¤šä¸ªåœ°æ–¹ã€‚</p>
<h3 data-id="heading-15">é‡æ„å</h3>
<pre><code class="hljs language-markdown" lang="markdown">å®¢æˆ·ç«¯ç”Ÿæˆ IDï¼ˆå”¯ä¸€çœŸç›¸æºï¼‰
<span class="hljs-code">    â†“
æ‰€æœ‰æ“ä½œéƒ½ç”¨è¿™ä¸ª ID
    â†“
Store æ˜¯å”¯ä¸€æ•°æ®æº
    â†“
UI è®¢é˜… storeï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
    â†“
ä¼šè¯çº§çŠ¶æ€ï¼ˆäº’ä¸å½±å“ï¼‰
    â†“
DataStreamHandler åŠ¨æ€ç»‘å®šï¼ˆè·Ÿéš IDï¼‰
</span></code></pre>
<p>å•å‘æ•°æ®æµï¼Œæ¯ä¸€å±‚éƒ½ä»ä¸Šä¸€å±‚è·å– IDã€‚</p>
<p>ä»¥å‰çš„ä»£ç åœ¨Â components/chat.tsxÂ é‡Œè¿™æ ·åšï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> [messages, setMessagesState] = <span class="hljs-title function_">useState</span>(initialMessages); 
<span class="hljs-comment">// ... </span>
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> { 
    <span class="hljs-keyword">if</span> (autoResume) { 
        <span class="hljs-keyword">const</span> latestStoreMessages = <span class="hljs-title function_">getSessionMessages</span>(currentSessionId); 
        <span class="hljs-keyword">if</span> (latestStoreMessages.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-title function_">setMessagesState</span>(latestStoreMessages); } } 
        <span class="hljs-keyword">else</span> { <span class="hljs-title function_">setStoreMessages</span>(currentSessionId, []); 
        } 
     }, [...]);
</code></pre>
<p>messagesÂ æ˜¯ç»„ä»¶ç§æœ‰ stateï¼Œè€ŒçœŸæ­£çš„çœŸç›¸è¿˜åœ¨Â useChatStoreÂ é‡Œã€‚React çš„Â useEffectÂ å—è°ƒåº¦å½±å“ï¼šåˆ‡æ¢åˆ°æ–°ä¼šè¯åï¼Œåœ¨ effect å°† store æ•°æ®å†™å›æœ¬åœ° state ä¹‹å‰ï¼ŒUI ä»ç„¶æ¸²æŸ“æ—§çš„Â messagesï¼Œäºæ˜¯â€œæ–°å¯¹è¯â€çŸ­æš‚æ˜¾ç¤ºä¸Šä¸€åœºçš„å†…å®¹ï¼›å¦‚æœ effect è¢«æ‰“æ–­æˆ–ä¾èµ–å˜åŒ–é¡ºåºä¸ä¸€è‡´ï¼Œè¿˜ä¼šå‡ºç° store å’Œ UI äº’ç›¸è¦†ç›–çš„é—®é¢˜ã€‚</p>
<p>ç°åœ¨çš„ç‰ˆæœ¬åˆ æ‰äº†è¿™å±‚æœ¬åœ° stateï¼Œåœ¨Â components/chat.tsx (lines 145-188)Â ç›´æ¥ç”¨ selectorï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> messages = <span class="hljs-title function_">useChatStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> <span class="hljs-title function_">getSessionMessages</span>(currentSessionId), );
</code></pre>
<p>getSessionMessagesÂ è‡ªèº«å°±æ˜¯ store æ–¹æ³•ï¼Œå†…éƒ¨è¿”å›Â sessions.get(id)?.messages ?? []ï¼Œæ‰€ä»¥â€œstore æ›´æ–° â†’ selector è§¦å‘ â†’ React é‡æ¸²æŸ“â€ï¼Œæ•°æ®æµæ˜¯å•å‘çš„ï¼Œæ²¡æœ‰ä»»ä½•Â useEffectÂ è´Ÿè´£åŒæ­¥ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ä¼šå‡ºç°â€œçŸ­æš‚æ˜¾ç¤ºæ—§ä¼šè¯â€çš„çª—å£ã€‚</p>
<p>é…åˆè¿™ä¸€ç‚¹ï¼Œæ¶ˆæ¯çš„å†™å…¥å…¨éƒ¨é›†ä¸­åœ¨Â lib/services/chat-service.tsÂ çš„Â sendChatMessageï¼ˆ64-91 è¡Œå¼€å¤´ï¼‰ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-attr">userMessage</span>: <span class="hljs-title class_">UIMessage</span> = { ... }; 
<span class="hljs-title function_">addMessage</span>(sessionId, userMessage); 
<span class="hljs-keyword">const</span> <span class="hljs-attr">assistantMessage</span>: <span class="hljs-title class_">UIMessage</span> = { 
    <span class="hljs-attr">id</span>: <span class="hljs-title function_">generateUUID</span>(), 
    <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, 
    <span class="hljs-attr">content</span>: <span class="hljs-string">''</span>, 
    <span class="hljs-attr">parts</span>: [], 
}; 
<span class="hljs-title function_">addMessage</span>(sessionId, assistantMessage); 
<span class="hljs-title function_">setStreaming</span>(sessionId, <span class="hljs-literal">true</span>, assistantMessage.<span class="hljs-property">id</span>);
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<ol>
<li>ç”¨æˆ·æäº¤è¡¨å•ï¼ŒsendChatMessageÂ å…ˆÂ addMessageÂ ä¸€æ¡Â role: 'user'Â çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥ UI ä¼šç«‹åˆ»æ˜¾ç¤ºâ€œæˆ‘â€åˆšè¾“å…¥çš„æ–‡å­—ã€‚</li>
<li>ç´§æ¥ç€å†æ’å…¥ä¸€æ¡Â role: 'assistant'Â ä¸”Â contentÂ ä¸ºç©ºçš„å ä½æ°”æ³¡ï¼ŒUI ä¸Šä¼šçœ‹åˆ°ä¸€ä¸ªç©ºçš„åŠ©æ‰‹æ¶ˆæ¯ï¼ˆå³â€œThinkingâ€¦â€ï¼‰ã€‚</li>
<li>SSE æµå›æ¥çš„æ¯ä¸ªå¢é‡åœ¨Â for (const line of lines)Â é‡Œè§£æåï¼Œé€šè¿‡Â updateMessage(sessionId, assistantMessage.id, { parts: [...] })Â é€æ­¥æŠŠæ–‡æœ¬è¿½åŠ åˆ°åŒä¸€ä¸ªæ¶ˆæ¯å¯¹è±¡ä¸Šï¼Œç›´åˆ°æµç»“æŸå†Â setStreaming(sessionId, false)ã€‚</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹ä¸­ç»„ä»¶ä¸å†ç»´æŠ¤æœ¬åœ°å‰¯æœ¬ï¼Œæ‰€æœ‰å˜æ›´éƒ½é€šè¿‡ store çš„Â addMessageÂ /Â updateMessageÂ /Â setStreamingÂ å®Œæˆã€‚è¿™æ ·â€œæ–°å¯¹è¯â€ä¸€åˆ›å»ºï¼Œstore é‡Œå°±æ˜¯ä¸€ä»½å¹²å‡€çš„æ¶ˆæ¯æ•°ç»„ï¼›è€Œ UI åªéœ€è¦è®¢é˜…Â getSessionMessagesï¼Œæ— éœ€ç­‰å¾…Â useEffectï¼Œä¹Ÿå°±å½»åº•é¿å…äº†â€œåŒæ­¥æ—¶æœºâ€å¸¦æ¥çš„è„è¯»ã€‚</p>
<h2 data-id="heading-16">ä¸‰ä¸ªå¯å¤ç”¨çš„æ¶æ„åŸåˆ™</h2>
<h3 data-id="heading-17">åŸåˆ™ä¸€ï¼šå®¢æˆ·ç«¯æ‹¥æœ‰ ID ä¸»æƒ</h3>
<p>æœåŠ¡å™¨åªè´Ÿè´£æŒä¹…åŒ–ï¼Œä¸å‚ä¸ ID çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚URL æ˜¯å”¯ä¸€çœŸç›¸æºï¼Œ<code>useEffect</code> ç›‘å¬ URL å‚æ•°å˜åŒ–ï¼ŒåŠ¨æ€åˆ›å»ºæˆ–æ¿€æ´»å®ä¾‹ã€‚</p>
<h3 data-id="heading-18">åŸåˆ™äºŒï¼šä¸ç»´æŠ¤çŠ¶æ€å‰¯æœ¬</h3>
<p>å¦‚æœä½ å‘ç°è‡ªå·±åœ¨å†™ <code>const [localData, setLocalData] = useState(storeData)</code>ï¼Œåœä¸‹æ¥æƒ³æƒ³ï¼šä¸ºä»€ä¹ˆéœ€è¦å‰¯æœ¬ï¼Ÿç›´æ¥ä» store è¯»ï¼Œç”¨ selector æˆ– memoization ä¼˜åŒ–æ€§èƒ½ï¼Œè€Œä¸æ˜¯å¤åˆ¶æ•°æ®ã€‚</p>
<h3 data-id="heading-19">åŸåˆ™ä¸‰ï¼šå¼‚æ­¥çŠ¶æ€ç»‘å®šåˆ°å®ä¾‹</h3>
<p><code>isLoading</code>ã€<code>isError</code>ã€<code>progress</code> ä¸èƒ½æ˜¯å…¨å±€çš„ã€‚å­˜åœ¨å®ä¾‹å¯¹è±¡é‡Œï¼ˆ<code>instances[id].isLoading</code>ï¼‰ï¼Œæˆ–ç”¨ Map ç»“æ„ï¼ˆ<code>loadingStates.get(id)</code>ï¼‰ï¼Œæ€»ä¹‹è¦èƒ½åŒºåˆ†"å“ªä¸ªå®ä¾‹åœ¨åŠ è½½"ã€‚</p>
<blockquote>
<p>ä»»ä½•éœ€è¦ç®¡ç†"å¤šå®ä¾‹"çš„ç³»ç»Ÿéƒ½ä¼šé‡åˆ°ï¼š</p>
</blockquote>
<p><strong>å¤šæ–‡æ¡£ç¼–è¾‘å™¨</strong>ï¼ˆGoogle Docsã€Notionï¼‰ï¼šåœ¨æ–‡æ¡£ A è¾“å…¥ï¼Œå†…å®¹å‡ºç°åœ¨æ–‡æ¡£ B</p>
<p><strong>å¤šæ ‡ç­¾æµè§ˆå™¨</strong>ï¼šåœ¨æ ‡ç­¾ A æäº¤è¡¨å•ï¼Œæ•°æ®å‘åˆ°æ ‡ç­¾ B çš„ API</p>
<p><strong>æ¸¸æˆæˆ¿é—´</strong>ï¼šåœ¨æˆ¿é—´ A å‘æ¶ˆæ¯ï¼Œæ¶ˆæ¯å‡ºç°åœ¨æˆ¿é—´ B</p>
<p><strong>å®æ—¶åä½œç™½æ¿</strong>ï¼šåœ¨ç”»å¸ƒ A ç”»å›¾ï¼Œç¬”è¿¹å‡ºç°åœ¨ç”»å¸ƒ B</p>
<p>æ ¸å¿ƒé—®é¢˜ä¸€æ ·ï¼š<strong>å®ä¾‹ ID çš„ç®¡ç†æƒä¸æ¸…æ™°ï¼ŒçŠ¶æ€å½’å±æ··ä¹±ï¼Œæ•°æ®æµç»‘å®šæ˜¯é™æ€çš„è€ŒéåŠ¨æ€çš„</strong>ã€‚</p>
<h2 data-id="heading-20">æœ€åä¸€ä¸ªç»†èŠ‚</h2>
<p>ä½ å¯èƒ½æ³¨æ„åˆ° <code>handleSubmit</code> é‡Œæœ‰ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  router.<span class="hljs-title function_">replace</span>(<span class="hljs-string">`/chat/<span class="hljs-subst">${currentSessionId}</span>`</span>);
});
</code></pre>
<p>ä¸ºä»€ä¹ˆç”¨ <code>startTransition</code>ï¼Ÿ</p>
<p>å› ä¸ºå®ƒå‘Šè¯‰ Reactï¼š"è¿™ä¸ªæ›´æ–°ä¸ç€æ€¥ï¼Œåˆ«é˜»å¡ç”¨æˆ·è¾“å…¥"ã€‚URL æ›´æ–°æ˜¯æ¬¡è¦çš„ï¼Œæ¶ˆæ¯å‘é€æ‰æ˜¯ä¸»è¦çš„ã€‚<code>startTransition</code> è®© React æŠŠè¿™æ¬¡æ›´æ–°æ ‡è®°ä¸º"å¯ä¸­æ–­"ï¼Œä¼˜å…ˆå¤„ç†ç”¨æˆ·æ“ä½œã€‚</p>
<p>è¿™æ˜¯ React 18 å¹¶å‘ç‰¹æ€§çš„å…¸å‹ç”¨æ³•ï¼Œä¸èµ·çœ¼ä½†èƒ½æ˜¾è‘—æ”¹å–„ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è·¯ç”±åŠ¨æ€Titleå®ç°è¯´æ˜(å·¥ä½œé—®é¢˜å¤„ç†æ€»ç»“)]]></title>    <link>https://juejin.cn/post/7571734313923428386</link>    <guid>https://juejin.cn/post/7571734313923428386</guid>    <pubDate>2025-11-13T04:07:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571734313923428386" data-draft-id="7571722835658522658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è·¯ç”±åŠ¨æ€Titleå®ç°è¯´æ˜(å·¥ä½œé—®é¢˜å¤„ç†æ€»ç»“)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-13T04:07:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="168æ¸…çº¯å¥³é«˜"/> <meta itemprop="url" content="https://juejin.cn/user/1130724256919159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è·¯ç”±åŠ¨æ€Titleå®ç°è¯´æ˜(å·¥ä½œé—®é¢˜å¤„ç†æ€»ç»“)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1130724256919159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    168æ¸…çº¯å¥³é«˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T04:07:57.000Z" title="Thu Nov 13 2025 04:07:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è·¯ç”±åŠ¨æ€Titleå®ç°è¯´æ˜</h2>
<h3 data-id="heading-1">ğŸ“‹ éœ€æ±‚èƒŒæ™¯</h3>
<p>åœ¨ç­–ç•¥é…ç½®ä¸­å¿ƒï¼ˆ<code>configuration-center</code>ï¼‰ä¸­ï¼ŒåŒä¸€ä¸ªè·¯ç”± <code>/strategy/configuration-center/add</code> éœ€è¦æ ¹æ®ä¸åŒçš„ç­–ç•¥ç±»å‹ï¼ˆ<code>strategyName</code>ï¼‰æ˜¾ç¤ºä¸åŒçš„æ ‡é¢˜ï¼š</p>
<ul>
<li><code>strategyName=app</code> â†’ "æ·»åŠ åº”ç”¨ç­–ç•¥"</li>
<li><code>strategyName=placement</code> â†’ "æ·»åŠ å¹¿å‘Šä½ç­–ç•¥"</li>
<li><code>strategyName=placement-firm</code> â†’ "æ·»åŠ å¹¿å‘Šä½å¹¿å‘Šå¹³å°ç­–ç•¥"</li>
<li><code>strategyName=placement-advanced</code> â†’ "æ·»åŠ å¼€å‘è€…åå°å¹¿å‘Šä½é«˜çº§ç­–ç•¥"</li>
</ul>
<p>åŒæ ·é€‚ç”¨äº <code>edit</code> å’Œ <code>copy</code> é¡µé¢ã€‚</p>
<h3 data-id="heading-2">ğŸ“‹åŸæ¥é…ç½®</h3>
<p>æ˜¯é€šè¿‡è·¯ç”±é…ç½®æ–‡ä»¶ï¼Œtitleé…ç½®é¡¹å»åŒ¹é…ã€‚ä½†æ˜¯å››ä¸ªç­–ç•¥çš„æ·»åŠ ã€ç¼–è¾‘ã€å¤åˆ¶ï¼Œå…¶å®æ˜¯åŒä¸€ä¸ªURLã€‚å¯¼è‡´éƒ½åªèƒ½æ˜¾ç¤ºâ€œæ·»åŠ ç­–ç•¥â€ â€œç¼–è¾‘ç­–ç•¥â€ â€œå¤åˆ¶ç­–ç•¥â€ã€‚ä¸èƒ½æ˜ç¡®å…·ä½“æ˜¯ä»€ä¹ˆç­–ç•¥
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a4848d5a3cb4b4ab4ffeaa9ac0272f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY45riF57qv5aWz6auY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617232&amp;x-signature=kOTMZpoMZohAgl0obxPGSfmG0ZU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">ğŸ“‹ æœ€ç»ˆæ•ˆæœ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2b58a49479a43dfb4e24e3be3f79172~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgMTY45riF57qv5aWz6auY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617232&amp;x-signature=pQiTHtHg51RPcwVwxKwJ81zlk6Y%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">ğŸ” é—®é¢˜åˆ†æ</h3>
<h4 data-id="heading-5">åŸæœ‰å®ç°çš„é—®é¢˜</h4>
<ol>
<li><strong>è·¯ç”±é…ç½®æ˜¯é™æ€çš„</strong>ï¼šè·¯ç”±çš„ <code>meta.title</code> åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­æ˜¯å›ºå®šçš„ï¼Œæ— æ³•æ ¹æ®å‚æ•°åŠ¨æ€å˜åŒ–</li>
<li><strong>å¤šä¸ªåœ°æ–¹éœ€è¦æ˜¾ç¤ºtitle</strong>ï¼š
<ul>
<li>æµè§ˆå™¨æ ‡ç­¾é¡µï¼ˆ<code>document.title</code>ï¼‰</li>
<li>é¢åŒ…å±‘å¯¼èˆªï¼ˆä½¿ç”¨ <code>route.matched[].meta.title</code>ï¼‰</li>
<li>æ ‡ç­¾é¡µç»„ä»¶ï¼ˆä½¿ç”¨ <code>route.meta.title</code>ï¼‰</li>
</ul>
</li>
<li><strong>Titleæ¥æºåˆ†æ•£</strong>ï¼šä¸åŒç»„ä»¶ä»ä¸åŒåœ°æ–¹è¯»å–titleï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†</li>
</ol>
<h4 data-id="heading-6">æŠ€æœ¯æŒ‘æˆ˜</h4>
<ul>
<li>Vue Router çš„è·¯ç”±é…ç½®æ˜¯é™æ€çš„ï¼Œ<code>meta.title</code> åœ¨å®šä¹‰æ—¶å°±å·²ç»ç¡®å®š</li>
<li>éœ€è¦åœ¨è·¯ç”±è·³è½¬æ—¶åŠ¨æ€ä¿®æ”¹ <code>meta.title</code>ï¼Œä½†åˆè¦ä¿è¯ä¸å½±å“å…¶ä»–åŠŸèƒ½</li>
<li>éœ€è¦åŒæ­¥æ›´æ–°å¤šä¸ªä½¿ç”¨ title çš„åœ°æ–¹</li>
</ul>
<h3 data-id="heading-7">ğŸ’¡ å®ç°æ€è·¯</h3>
<h4 data-id="heading-8">æ ¸å¿ƒæ€è·¯</h4>
<p><strong>åœ¨è·¯ç”±å®ˆå«ä¸­åŠ¨æ€ä¿®æ”¹è·¯ç”±å¯¹è±¡çš„ <code>meta.title</code></strong>ï¼Œè¿™æ ·æ‰€æœ‰ä¾èµ– <code>route.meta.title</code> çš„ç»„ä»¶éƒ½èƒ½è‡ªåŠ¨è·å–åˆ°æ­£ç¡®çš„å€¼ã€‚</p>
<h4 data-id="heading-9">ä¸ºä»€ä¹ˆé€‰æ‹©è·¯ç”±å®ˆå«ï¼Ÿ</h4>
<ol>
<li><strong>ç»Ÿä¸€å…¥å£</strong>ï¼šæ‰€æœ‰è·¯ç”±è·³è½¬éƒ½ä¼šç»è¿‡è·¯ç”±å®ˆå«ï¼Œå¯ä»¥ç»Ÿä¸€å¤„ç†</li>
<li><strong>æ—¶æœºåˆé€‚</strong>ï¼šåœ¨è·¯ç”±è·³è½¬å‰ä¿®æ”¹ï¼Œç¡®ä¿ç»„ä»¶è·å–åˆ°çš„æ˜¯æ­£ç¡®çš„å€¼</li>
<li><strong>ä¸å½±å“ç°æœ‰é€»è¾‘</strong>ï¼šåªéœ€è¦åœ¨ç‰¹å®šè·¯ç”±ä¸Šåº”ç”¨ï¼Œå…¶ä»–è·¯ç”±ä¸å—å½±å“</li>
</ol>
<h4 data-id="heading-10">å®ç°æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-css" lang="css">è·¯ç”±è·³è½¬
  â†“
beforeEach å®ˆå«
  â†“
æ£€æµ‹æ˜¯å¦æ˜¯ç­–ç•¥é…ç½®ä¸­å¿ƒè·¯ç”±
  â†“
ä» query<span class="hljs-selector-class">.strategyName</span> è·å–ç­–ç•¥ç±»å‹
  â†“
åŠ¨æ€ç”Ÿæˆ title key
  â†“
ä¿®æ”¹ <span class="hljs-selector-tag">to</span><span class="hljs-selector-class">.meta</span><span class="hljs-selector-class">.title</span> å’Œ <span class="hljs-selector-tag">to</span><span class="hljs-selector-class">.matched</span><span class="hljs-selector-attr">[]</span><span class="hljs-selector-class">.meta</span><span class="hljs-selector-class">.title</span>
  â†“
è®¾ç½® document<span class="hljs-selector-class">.title</span>
  â†“
ç»„ä»¶æ¸²æŸ“ï¼ˆè‡ªåŠ¨ä½¿ç”¨æ›´æ–°åçš„ meta<span class="hljs-selector-class">.title</span>ï¼‰
  â†“
afterEach å®ˆå«
  â†“
æ›´æ–°å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ title
</code></pre>
<h3 data-id="heading-11">ğŸ› ï¸ å…·ä½“å®ç°æ­¥éª¤</h3>
<h4 data-id="heading-12">ç¬¬ä¸€æ­¥ï¼šæ·»åŠ è¯­è¨€æ–‡ä»¶ä¸­çš„ title key</h4>
<p><strong>æ–‡ä»¶</strong>ï¼š<code>src/lang/modules/zh/route-text.js</code> å’Œ <code>src/lang/modules/en/route-text.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ·»åŠ äº†æ‰€æœ‰ç­–ç•¥ç±»å‹çš„ title key</span>
<span class="hljs-attr">addAppStrategyConfigurationCenter</span>: <span class="hljs-string">'æ·»åŠ åº”ç”¨ç­–ç•¥'</span>,
<span class="hljs-attr">editAppStrategyConfigurationCenter</span>: <span class="hljs-string">'ç¼–è¾‘åº”ç”¨ç­–ç•¥'</span>,
<span class="hljs-attr">copyAppStrategyConfigurationCenter</span>: <span class="hljs-string">'å¤åˆ¶åº”ç”¨ç­–ç•¥'</span>,
<span class="hljs-attr">addPlacementStrategyConfigurationCenter</span>: <span class="hljs-string">'æ·»åŠ å¹¿å‘Šä½ç­–ç•¥'</span>,
<span class="hljs-comment">// ... ç­‰ç­‰</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸€æ­¥ï¼Ÿ</strong></p>
<ul>
<li><code>getPageTitle</code> å‡½æ•°ä»è¯­è¨€æ–‡ä»¶ä¸­è¯»å–ç¿»è¯‘</li>
<li>éœ€è¦æå‰å®šä¹‰å¥½æ‰€æœ‰å¯èƒ½çš„ title keyï¼Œæ‰èƒ½æ­£ç¡®æ˜¾ç¤º</li>
</ul>
<h4 data-id="heading-13">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåŠ¨æ€è·å– title çš„å‡½æ•°</h4>
<p><strong>æ–‡ä»¶</strong>ï¼š<code>src/permission.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDynamicStrategyTitle</span> (route) {
  <span class="hljs-comment">// 1. æ£€æŸ¥æ˜¯å¦æ˜¯ç­–ç•¥é…ç½®ä¸­å¿ƒç›¸å…³çš„è·¯ç”±</span>
  <span class="hljs-keyword">const</span> configCenterPaths = [
    <span class="hljs-string">'/strategy/configuration-center/add'</span>,
    <span class="hljs-string">'/strategy/configuration-center/edit'</span>,
    <span class="hljs-string">'/strategy/configuration-center/copy'</span>
  ]
  
  <span class="hljs-comment">// 2. å¦‚æœä¸æ˜¯ï¼Œè¿”å›åŸå§‹ title</span>
  <span class="hljs-keyword">if</span> (!isConfigCenterRoute) {
    <span class="hljs-keyword">return</span> route.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>
  }
  
  <span class="hljs-comment">// 3. ä» query å‚æ•°è·å– strategyName</span>
  <span class="hljs-keyword">const</span> strategyName = route.<span class="hljs-property">query</span>.<span class="hljs-property">strategyName</span>
  
  <span class="hljs-comment">// 4. ç¡®å®šé¡µé¢ç±»å‹ï¼ˆadd/edit/copyï¼‰</span>
  <span class="hljs-keyword">let</span> actionType = <span class="hljs-string">'add'</span>
  <span class="hljs-keyword">if</span> (route.<span class="hljs-property">path</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/edit/'</span>)) {
    actionType = <span class="hljs-string">'edit'</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (route.<span class="hljs-property">path</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/copy/'</span>)) {
    actionType = <span class="hljs-string">'copy'</span>
  }
  
  <span class="hljs-comment">// 5. ç­–ç•¥ç±»å‹æ˜ å°„</span>
  <span class="hljs-keyword">const</span> strategyNameMap = {
    <span class="hljs-string">'app'</span>: <span class="hljs-string">'App'</span>,
    <span class="hljs-string">'placement'</span>: <span class="hljs-string">'Placement'</span>,
    <span class="hljs-string">'placement-firm'</span>: <span class="hljs-string">'PlacementFirm'</span>,
    <span class="hljs-string">'placement-advanced'</span>: <span class="hljs-string">'PlacementAdvanced'</span>
  }
  
  <span class="hljs-comment">// 6. ç”Ÿæˆ title key</span>
  <span class="hljs-keyword">const</span> titleKey = <span class="hljs-string">`<span class="hljs-subst">${actionType}</span><span class="hljs-subst">${strategyKey}</span>StrategyConfigurationCenter`</span>
  <span class="hljs-keyword">return</span> titleKey
}
</code></pre>
<p><strong>è®¾è®¡è¦ç‚¹ï¼š</strong></p>
<ul>
<li><strong>å‡½æ•°å¼è®¾è®¡</strong>ï¼šç‹¬ç«‹å‡½æ•°ï¼Œä¾¿äºæµ‹è¯•å’Œç»´æŠ¤</li>
<li><strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong>ï¼šæ¯ä¸€æ­¥éƒ½æœ‰æ£€æŸ¥ï¼Œé¿å…é”™è¯¯</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ–°å¢ç­–ç•¥ç±»å‹åªéœ€ä¿®æ”¹æ˜ å°„è¡¨</li>
</ul>
<h4 data-id="heading-14">ç¬¬ä¸‰æ­¥ï¼šåœ¨ beforeEach ä¸­åŠ¨æ€ä¿®æ”¹ meta.title</h4>
<p><strong>æ–‡ä»¶</strong>ï¼š<code>src/permission.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript">router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> (to, <span class="hljs-keyword">from</span>, next) =&gt; {
  <span class="hljs-comment">// 1. è·å–åŠ¨æ€ title</span>
  <span class="hljs-keyword">const</span> dynamicTitle = <span class="hljs-title function_">getDynamicStrategyTitle</span>(to)
  
  <span class="hljs-comment">// 2. ä¿®æ”¹ to.meta.titleï¼ˆå½±å“æ ‡ç­¾é¡µç»„ä»¶ï¼‰</span>
  <span class="hljs-keyword">if</span> (dynamicTitle !== to.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>) {
    to.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span> = dynamicTitle
    
    <span class="hljs-comment">// 3. ä¿®æ”¹ to.matched[].meta.titleï¼ˆå½±å“é¢åŒ…å±‘ï¼‰</span>
    <span class="hljs-keyword">if</span> (to.<span class="hljs-property">matched</span> &amp;&amp; to.<span class="hljs-property">matched</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> lastMatched = to.<span class="hljs-property">matched</span>[to.<span class="hljs-property">matched</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
      <span class="hljs-keyword">if</span> (lastMatched &amp;&amp; lastMatched.<span class="hljs-property">meta</span>) {
        lastMatched.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span> = dynamicTitle
      }
    }
  }
  
  <span class="hljs-comment">// 4. è®¾ç½®æµè§ˆå™¨æ ‡ç­¾é¡µ title</span>
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-title function_">getPageTitle</span>(dynamicTitle)
  
  <span class="hljs-comment">// ... å…¶ä»–é€»è¾‘</span>
})
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹ï¼Ÿ</strong></p>
<ol>
<li>
<p><strong><code>to.meta.title</code></strong>ï¼š</p>
<ul>
<li>TagsView ç»„ä»¶ä½¿ç”¨ <code>route.meta.title</code> æ˜¾ç¤ºæ ‡ç­¾é¡µæ ‡é¢˜</li>
<li>éœ€è¦ä¿®æ”¹è¿™é‡Œæ‰èƒ½è®©æ ‡ç­¾é¡µæ˜¾ç¤ºæ­£ç¡®</li>
</ul>
</li>
<li>
<p><strong><code>to.matched[].meta.title</code></strong>ï¼š</p>
<ul>
<li>Breadcrumb ç»„ä»¶ä½¿ç”¨ <code>route.matched[].meta.title</code> æ˜¾ç¤ºé¢åŒ…å±‘</li>
<li><code>matched</code> æ˜¯è·¯ç”±åŒ¹é…æ•°ç»„ï¼ŒåŒ…å«å½“å‰è·¯ç”±åŠå…¶æ‰€æœ‰çˆ¶è·¯ç”±</li>
<li>éœ€è¦ä¿®æ”¹æœ€åä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆå½“å‰è·¯ç”±ï¼‰çš„ title</li>
</ul>
</li>
<li>
<p><strong><code>document.title</code></strong>ï¼š</p>
<ul>
<li>æµè§ˆå™¨æ ‡ç­¾é¡µçš„æ ‡é¢˜</li>
<li>é€šè¿‡ <code>getPageTitle</code> å‡½æ•°è·å–ç¿»è¯‘åçš„æ–‡æœ¬</li>
</ul>
</li>
</ol>
<h4 data-id="heading-15">ç¬¬å››æ­¥ï¼šåœ¨ afterEach ä¸­æ›´æ–°å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ</h4>
<p><strong>æ–‡ä»¶</strong>ï¼š<code>src/permission.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript">router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> dynamicTitle = <span class="hljs-title function_">getDynamicStrategyTitle</span>(to)
  <span class="hljs-keyword">const</span> visitedViews = store.<span class="hljs-property">state</span>.<span class="hljs-property">tagsView</span>?.<span class="hljs-property">visitedViews</span> || []
  <span class="hljs-keyword">const</span> currentView = visitedViews.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v.<span class="hljs-property">path</span> === to.<span class="hljs-property">path</span>)
  
  <span class="hljs-comment">// å¦‚æœæ ‡ç­¾é¡µå·²å­˜åœ¨ä½† title ä¸åŒï¼Œæ›´æ–°å®ƒ</span>
  <span class="hljs-keyword">if</span> (currentView &amp;&amp; currentView.<span class="hljs-property">title</span> !== dynamicTitle) {
    <span class="hljs-keyword">const</span> updatedView = {
      ...to,
      <span class="hljs-attr">title</span>: dynamicTitle,
      <span class="hljs-attr">meta</span>: {
        ...to.<span class="hljs-property">meta</span>,
        <span class="hljs-attr">title</span>: dynamicTitle
      }
    }
    store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">'tagsView/updateVisitedView'</span>, updatedView)
  }
})
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸€æ­¥ï¼Ÿ</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç”¨æˆ·å·²ç»æ‰“å¼€è¿‡æŸä¸ªè·¯ç”±çš„æ ‡ç­¾é¡µï¼Œç„¶åå†æ¬¡è®¿é—®åŒä¸€ä¸ªè·¯ç”±ä½† <code>strategyName</code> ä¸åŒ</li>
<li><strong>é—®é¢˜</strong>ï¼šæ ‡ç­¾é¡µå·²ç»å­˜åœ¨ï¼Œ<code>beforeEach</code> ä¸­çš„ä¿®æ”¹ä¸ä¼šå½±å“å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ</li>
<li><strong>è§£å†³</strong>ï¼šåœ¨ <code>afterEach</code> ä¸­æ£€æŸ¥å¹¶æ›´æ–°å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ</li>
</ul>
<h4 data-id="heading-16">ç¬¬äº”æ­¥ï¼šä¿®å¤ TagsView Store çš„ mutation</h4>
<p><strong>æ–‡ä»¶</strong>ï¼š<code>src/store/modules/tagsView.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰</span>
<span class="hljs-attr">UPDATE_VISITED_VIEW</span>: <span class="hljs-function">(<span class="hljs-params">state, view</span>) =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v <span class="hljs-keyword">of</span> state.<span class="hljs-property">visitedViews</span>) {
    <span class="hljs-keyword">if</span> (v.<span class="hljs-property">path</span> === view.<span class="hljs-property">path</span>) {
      v = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(v, view)  <span class="hljs-comment">// âŒ è¿™æ ·ä¸ä¼šçœŸæ­£æ›´æ–°æ•°ç»„ä¸­çš„å¯¹è±¡</span>
      <span class="hljs-keyword">break</span>
    }
  }
}

<span class="hljs-comment">// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰</span>
<span class="hljs-attr">UPDATE_VISITED_VIEW</span>: <span class="hljs-function">(<span class="hljs-params">state, view</span>) =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; state.<span class="hljs-property">visitedViews</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">if</span> (state.<span class="hljs-property">visitedViews</span>[i].<span class="hljs-property">path</span> === view.<span class="hljs-property">path</span>) {
      state.<span class="hljs-property">visitedViews</span>[i] = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, state.<span class="hljs-property">visitedViews</span>[i], view)  <span class="hljs-comment">// âœ… æ­£ç¡®æ›´æ–°</span>
      <span class="hljs-keyword">break</span>
    }
  }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¿®å¤ï¼Ÿ</strong></p>
<ul>
<li><strong>åŸé—®é¢˜</strong>ï¼šä½¿ç”¨ <code>for...of</code> å¾ªç¯æ—¶ï¼Œ<code>v</code> åªæ˜¯æ•°ç»„å…ƒç´ çš„å¼•ç”¨ï¼Œç›´æ¥èµ‹å€¼ä¸ä¼šæ›´æ–°æ•°ç»„</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ç´¢å¼•è®¿é—®ï¼Œç›´æ¥æ›¿æ¢æ•°ç»„ä¸­çš„å¯¹è±¡</li>
<li><strong>Vue å“åº”å¼</strong>ï¼šè¿™æ ·ä¿®æ”¹æ‰èƒ½è§¦å‘ Vue çš„å“åº”å¼æ›´æ–°</li>
</ul>
<h3 data-id="heading-17">ğŸ¯ å…³é”®è®¾è®¡å†³ç­–</h3>
<h4 data-id="heading-18">1. ä¸ºä»€ä¹ˆä¸åœ¨ç»„ä»¶ä¸­å¤„ç†ï¼Ÿ</h4>
<p><strong>ä¸é€‰æ‹©ç»„ä»¶æ–¹æ¡ˆçš„åŸå› ï¼š</strong></p>
<ul>
<li>âŒ éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­é‡å¤ä»£ç </li>
<li>âŒ é¢åŒ…å±‘å’Œæ ‡ç­¾é¡µç»„ä»¶æ— æ³•ç›´æ¥è®¿é—®ä¸šåŠ¡é€»è¾‘</li>
<li>âŒ éš¾ä»¥ç»Ÿä¸€ç®¡ç†</li>
</ul>
<p><strong>é€‰æ‹©è·¯ç”±å®ˆå«çš„åŸå› ï¼š</strong></p>
<ul>
<li>âœ… ç»Ÿä¸€å…¥å£ï¼Œæ‰€æœ‰è·¯ç”±è·³è½¬éƒ½ä¼šç»è¿‡</li>
<li>âœ… åœ¨ç»„ä»¶æ¸²æŸ“å‰å°±ä¿®æ”¹å¥½ï¼Œç»„ä»¶æ— éœ€å…³å¿ƒ</li>
<li>âœ… ç¬¦åˆå…³æ³¨ç‚¹åˆ†ç¦»åŸåˆ™</li>
</ul>
<h4 data-id="heading-19">2. ä¸ºä»€ä¹ˆåŒæ—¶ä¿®æ”¹ meta.title å’Œ matchedï¼Ÿ</h4>
<p><strong>Vue Router çš„è·¯ç”±å¯¹è±¡ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">route = {
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/strategy/configuration-center/add'</span>,
  <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'...'</span> },  <span class="hljs-comment">// æ ‡ç­¾é¡µä½¿ç”¨è¿™ä¸ª</span>
  <span class="hljs-attr">matched</span>: [
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'/strategy'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'ç­–ç•¥ç®¡ç†'</span> } },
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'/strategy/configuration-center'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'ç­–ç•¥é…ç½®ä¸­å¿ƒ'</span> } },
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'/strategy/configuration-center/add'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'...'</span> } }  <span class="hljs-comment">// é¢åŒ…å±‘ä½¿ç”¨è¿™ä¸ª</span>
  ]
}
</code></pre>
<ul>
<li><strong><code>route.meta.title</code></strong>ï¼šTagsView ç»„ä»¶ä½¿ç”¨</li>
<li><strong><code>route.matched[].meta.title</code></strong>ï¼šBreadcrumb ç»„ä»¶ä½¿ç”¨æœ€åä¸€ä¸ªåŒ¹é…é¡¹</li>
</ul>
<h4 data-id="heading-20">3. ä¸ºä»€ä¹ˆéœ€è¦ afterEachï¼Ÿ</h4>
<p><strong>åœºæ™¯åˆ†æï¼š</strong></p>
<ol>
<li>
<p>ç”¨æˆ·è®¿é—® <code>/strategy/configuration-center/add?strategyName=app</code></p>
<ul>
<li><code>beforeEach</code> ä¿®æ”¹ <code>to.meta.title = 'addAppStrategyConfigurationCenter'</code></li>
<li>TagsView æ·»åŠ æ–°æ ‡ç­¾é¡µï¼Œtitle ä¸º "æ·»åŠ åº”ç”¨ç­–ç•¥"</li>
</ul>
</li>
<li>
<p>ç”¨æˆ·å†æ¬¡è®¿é—® <code>/strategy/configuration-center/add?strategyName=placement</code></p>
<ul>
<li><code>beforeEach</code> ä¿®æ”¹ <code>to.meta.title = 'addPlacementStrategyConfigurationCenter'</code></li>
<li>ä½† TagsView å‘ç°è·¯å¾„ç›¸åŒï¼Œä¸ä¼šæ·»åŠ æ–°æ ‡ç­¾é¡µï¼ˆå·²æœ‰é€»è¾‘ï¼‰</li>
<li><strong>é—®é¢˜</strong>ï¼šå·²å­˜åœ¨çš„æ ‡ç­¾é¡µ title è¿˜æ˜¯ "æ·»åŠ åº”ç”¨ç­–ç•¥"</li>
</ul>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ <code>afterEach</code> ä¸­æ£€æŸ¥å¹¶æ›´æ–°å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ</p>
</li>
</ol>
<h3 data-id="heading-21">ğŸ“Š æ•°æ®æµå›¾</h3>
<pre><code class="hljs language-php" lang="php">ç”¨æˆ·ç‚¹å‡»<span class="hljs-string">"æ·»åŠ "</span>æŒ‰é’®
  â†“
router.<span class="hljs-title function_ invoke__">push</span>({ <span class="hljs-attr">path</span>: <span class="hljs-string">'/strategy/configuration-center/add'</span>, <span class="hljs-attr">query</span>: { <span class="hljs-attr">strategyName</span>: <span class="hljs-string">'app'</span> } })
  â†“
beforeEach å®ˆå«è§¦å‘
  â†“
<span class="hljs-title function_ invoke__">getDynamicStrategyTitle</span>(to)
  â”œâ”€ æ£€æµ‹è·¯ç”±è·¯å¾„ â†’ æ˜¯é…ç½®ä¸­å¿ƒè·¯ç”±
  â”œâ”€ è¯»å– query.strategyName â†’ <span class="hljs-string">'app'</span>
  â”œâ”€ åˆ¤æ–­é¡µé¢ç±»å‹ â†’ <span class="hljs-string">'add'</span>
  â””â”€ ç”Ÿæˆ title key â†’ <span class="hljs-string">'addAppStrategyConfigurationCenter'</span>
  â†“
ä¿®æ”¹ to.meta.title = <span class="hljs-string">'addAppStrategyConfigurationCenter'</span>
ä¿®æ”¹ to.matched[].meta.title = <span class="hljs-string">'addAppStrategyConfigurationCenter'</span>
è®¾ç½® document.title = <span class="hljs-string">'æ·»åŠ åº”ç”¨ç­–ç•¥ - è¿è¥ç®¡ç†åå°'</span>
  â†“
è·¯ç”±è·³è½¬å®Œæˆï¼Œç»„ä»¶æ¸²æŸ“
  â”œâ”€ Breadcrumb ç»„ä»¶è¯»å– route.matched[].meta.title â†’ <span class="hljs-string">"æ·»åŠ åº”ç”¨ç­–ç•¥"</span>
  â”œâ”€ TagsView ç»„ä»¶è¯»å– route.meta.title â†’ <span class="hljs-string">"æ·»åŠ åº”ç”¨ç­–ç•¥"</span>
  â””â”€ æµè§ˆå™¨æ ‡ç­¾é¡µæ˜¾ç¤º â†’ <span class="hljs-string">"æ·»åŠ åº”ç”¨ç­–ç•¥ - è¿è¥ç®¡ç†åå°"</span>
  â†“
afterEach å®ˆå«è§¦å‘
  â†“
æ£€æŸ¥æ ‡ç­¾é¡µæ˜¯å¦éœ€è¦æ›´æ–° â†’ å¦‚æœæ˜¯æ–°æ ‡ç­¾é¡µï¼Œæ— éœ€æ›´æ–°ï¼›å¦‚æœæ˜¯å·²å­˜åœ¨çš„ï¼Œæ›´æ–°å®ƒ
</code></pre>
<h3 data-id="heading-22">âœ… æœ€ç»ˆæ•ˆæœ</h3>
<h4 data-id="heading-23">å®ç°å‰</h4>
<ul>
<li>æ‰€æœ‰ç­–ç•¥ç±»å‹éƒ½æ˜¾ç¤º "æ·»åŠ ç­–ç•¥"ï¼ˆå›ºå®šæ ‡é¢˜ï¼‰</li>
</ul>
<h4 data-id="heading-24">å®ç°å</h4>
<ul>
<li><code>strategyName=app</code> â†’ "æ·»åŠ åº”ç”¨ç­–ç•¥"</li>
<li><code>strategyName=placement</code> â†’ "æ·»åŠ å¹¿å‘Šä½ç­–ç•¥"</li>
<li><code>strategyName=placement-firm</code> â†’ "æ·»åŠ å¹¿å‘Šä½å¹¿å‘Šå¹³å°ç­–ç•¥"</li>
<li><code>strategyName=placement-advanced</code> â†’ "æ·»åŠ å¼€å‘è€…åå°å¹¿å‘Šä½é«˜çº§ç­–ç•¥"</li>
</ul>
<h4 data-id="heading-25">åŒæ­¥æ›´æ–°çš„åœ°æ–¹</h4>
<ol>
<li>âœ… æµè§ˆå™¨æ ‡ç­¾é¡µï¼ˆ<code>document.title</code>ï¼‰</li>
<li>âœ… é¢åŒ…å±‘å¯¼èˆªï¼ˆ<code>route.matched[].meta.title</code>ï¼‰</li>
<li>âœ… æ ‡ç­¾é¡µç»„ä»¶ï¼ˆ<code>route.meta.title</code>ï¼‰</li>
</ol>
<h3 data-id="heading-26">ğŸ“ æ€»ç»“</h3>
<h4 data-id="heading-27">æ ¸å¿ƒæ€æƒ³</h4>
<p><strong>åœ¨è·¯ç”±å®ˆå«ä¸­ç»Ÿä¸€å¤„ç†åŠ¨æ€ titleï¼Œè®©æ‰€æœ‰ä¾èµ– <code>route.meta.title</code> çš„ç»„ä»¶è‡ªåŠ¨è·å–æ­£ç¡®çš„å€¼ã€‚</strong></p>
<h4 data-id="heading-28">ä¼˜åŠ¿</h4>
<ol>
<li><strong>é›†ä¸­ç®¡ç†</strong>ï¼šæ‰€æœ‰ title é€»è¾‘åœ¨ä¸€ä¸ªåœ°æ–¹</li>
<li><strong>è‡ªåŠ¨åŒæ­¥</strong>ï¼šä¿®æ”¹ <code>meta.title</code> åï¼Œæ‰€æœ‰ä½¿ç”¨å®ƒçš„ç»„ä»¶è‡ªåŠ¨æ›´æ–°</li>
<li><strong>æ˜“äºç»´æŠ¤</strong>ï¼šæ–°å¢ç­–ç•¥ç±»å‹åªéœ€ä¿®æ”¹æ˜ å°„è¡¨</li>
<li><strong>ä¸å½±å“å…¶ä»–åŠŸèƒ½</strong>ï¼šåªé’ˆå¯¹ç‰¹å®šè·¯ç”±ï¼Œå…¶ä»–è·¯ç”±ä¸å—å½±å“</li>
</ol>
<h4 data-id="heading-29">æ³¨æ„äº‹é¡¹</h4>
<ol>
<li><strong>è·¯ç”±å®ˆå«æ‰§è¡Œé¡ºåº</strong>ï¼š<code>beforeEach</code> â†’ ç»„ä»¶æ¸²æŸ“ â†’ <code>afterEach</code></li>
<li><strong>Vue å“åº”å¼</strong>ï¼šç›´æ¥ä¿®æ”¹å¯¹è±¡å±æ€§æ‰èƒ½è§¦å‘å“åº”å¼æ›´æ–°</li>
<li><strong>æ ‡ç­¾é¡µæ›´æ–°</strong>ï¼šéœ€è¦åœ¨ <code>afterEach</code> ä¸­å¤„ç†å·²å­˜åœ¨çš„æ ‡ç­¾é¡µ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚æœºåˆ¶ï¼šProxyå¦‚ä½•å®ç°ä¾èµ–è¿½è¸ªä¸è‡ªåŠ¨æ›´æ–°ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7571751304626044974</link>    <guid>https://juejin.cn/post/7571751304626044974</guid>    <pubDate>2025-11-13T03:16:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571751304626044974" data-draft-id="7571830282848927795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Vue 3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚æœºåˆ¶ï¼šProxyå¦‚ä½•å®ç°ä¾èµ–è¿½è¸ªä¸è‡ªåŠ¨æ›´æ–°ï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,Trae,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-11-13T03:16:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Vue 3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚æœºåˆ¶ï¼šProxyå¦‚ä½•å®ç°ä¾èµ–è¿½è¸ªä¸è‡ªåŠ¨æ›´æ–°ï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:16:01.000Z" title="Thu Nov 13 2025 03:16:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å“åº”å¼çš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯å“åº”å¼ï¼Ÿ</h3>
<p>å“åº”å¼æ˜¯ä¸€ç§**â€œæ•°æ®å˜åŒ–è‡ªåŠ¨è§¦å‘æ›´æ–°â€**çš„ç¼–ç¨‹èŒƒå¼ï¼Œæœ€ç›´è§‚çš„ä¾‹å­æ˜¯Excelè¡¨æ ¼ï¼šå¦‚æœå•å…ƒæ ¼A1æ˜¯<code>=B1+C1</code>ï¼Œå½“B1æˆ–C1å˜åŒ–æ—¶ï¼ŒA1ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ä½†æ™®é€šJavaScriptå˜é‡ä¸å…·å¤‡è¿™ç§èƒ½åŠ›â€”â€”æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> <span class="hljs-variable constant_">B1</span> = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> <span class="hljs-variable constant_">C1</span> = <span class="hljs-number">2</span>;
<span class="hljs-keyword">let</span> <span class="hljs-variable constant_">A1</span> = <span class="hljs-variable constant_">B1</span> + <span class="hljs-variable constant_">C1</span>; <span class="hljs-comment">// A1=3</span>
<span class="hljs-variable constant_">B1</span> = <span class="hljs-number">3</span>; <span class="hljs-comment">// A1è¿˜æ˜¯3ï¼Œä¸ä¼šè‡ªåŠ¨æ›´æ–°</span>
</code></pre>
<p>è¦è®©A1è‡ªåŠ¨æ›´æ–°ï¼Œéœ€è¦<strong>æ‹¦æˆªB1/C1çš„è®¿é—®</strong>ï¼ˆçŸ¥é“è°ä¾èµ–äº†å®ƒä»¬ï¼‰å’Œ<strong>æ‹¦æˆªB1/C1çš„ä¿®æ”¹</strong>ï¼ˆé€šçŸ¥ä¾èµ–è€…æ›´æ–°ï¼‰ã€‚è¿™å°±æ˜¯Vueå“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒç›®æ ‡ã€‚</p>
<h3 data-id="heading-2">1.2 ä¸ºä»€ä¹ˆJavaScriptéœ€è¦å“åº”å¼ç³»ç»Ÿï¼Ÿ</h3>
<p>Vueç»„ä»¶çš„<strong>è§†å›¾ä¸çŠ¶æ€ç»‘å®š</strong>ä¾èµ–å“åº”å¼ï¼šå½“ç»„ä»¶çš„<code>data</code>æˆ–<code>state</code>å˜åŒ–æ—¶ï¼ŒVueéœ€è¦è‡ªåŠ¨æ›´æ–°DOMã€‚å¦‚æœæ²¡æœ‰å“åº”å¼ç³»ç»Ÿï¼Œæˆ‘ä»¬å¾—æ‰‹åŠ¨è°ƒç”¨<code>render()</code>å‡½æ•°â€”â€”è¿™ä¼šè®©ä»£ç å˜å¾—å†—ä½™ä¸”æ˜“å‡ºé”™ã€‚</p>
<h2 data-id="heading-3">2. Vue 3å“åº”å¼çš„æ ¸å¿ƒï¼šProxyä¸Reflect</h2>
<h3 data-id="heading-4">2.1 ä¸ºä»€ä¹ˆé€‰Proxyè€Œä¸æ˜¯Object.definePropertyï¼Ÿ</h3>
<p>Vue 2ç”¨<code>Object.defineProperty</code>æ‹¦æˆªå¯¹è±¡å±æ€§ï¼Œä½†å®ƒæœ‰<strong>ä¸‰å¤§å±€é™</strong>ï¼š</p>
<ol>
<li><strong>æ— æ³•ç›‘å¬æ•°ç»„å˜åŒ–</strong>ï¼šéœ€é‡å†™<code>push</code>/<code>pop</code>ç­‰æ•°ç»„æ–¹æ³•æ‰èƒ½è§¦å‘æ›´æ–°ï¼›</li>
<li><strong>æ— æ³•ç›‘å¬æ–°å¢/åˆ é™¤å±æ€§</strong>ï¼šéœ€ç”¨<code>Vue.set</code>/<code>Vue.delete</code>æ‰‹åŠ¨è§¦å‘ï¼›</li>
<li><strong>åªèƒ½ç›‘å¬å·²å­˜åœ¨çš„å±æ€§</strong>ï¼šåˆå§‹åŒ–æ—¶æœªå®šä¹‰çš„å±æ€§æ— æ³•è¿½è¸ªã€‚</li>
</ol>
<p>Vue 3ç”¨<strong>ES6 Proxy</strong>è§£å†³äº†è¿™äº›é—®é¢˜ã€‚Proxyæ˜¯**â€œå¯¹è±¡çš„ä»£ç†å™¨â€**ï¼Œèƒ½æ‹¦æˆªå¯¹è±¡çš„å‡ ä¹æ‰€æœ‰æ“ä½œï¼ˆå¦‚<code>get</code>/<code>set</code>/<code>deleteProperty</code>ç­‰ï¼‰ï¼Œä¸”å¤©ç„¶æ”¯æŒæ•°ç»„å’Œæ–°å¢å±æ€§ã€‚</p>
<h3 data-id="heading-5">2.2 Proxyçš„å·¥ä½œåŸç†</h3>
<p>Proxyé€šè¿‡<code>new Proxy(target, handler)</code>åˆ›å»ºï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><code>target</code>ï¼šè¢«ä»£ç†çš„åŸå§‹å¯¹è±¡ï¼ˆå¦‚ç»„ä»¶çš„<code>state</code>ï¼‰ï¼›</li>
<li><code>handler</code>ï¼š**é™·é˜±ï¼ˆTrapsï¼‰**å¯¹è±¡ï¼Œå®šä¹‰æ‹¦æˆªæ“ä½œçš„é€»è¾‘ï¼ˆå¦‚<code>get</code>æ‹¦æˆªå±æ€§è®¿é—®ï¼Œ<code>set</code>æ‹¦æˆªå±æ€§ä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">å…³é”®é™·é˜±ï¼š<code>get</code>ä¸<code>set</code></h4>
<ul>
<li><strong><code>get(target, key, receiver)</code></strong>ï¼šå½“è®¿é—®<code>target[key]</code>æ—¶è§¦å‘ï¼Œç”¨äº<strong>è¿½è¸ªä¾èµ–</strong>ï¼ˆè®°å½•â€œè°ç”¨åˆ°äº†è¿™ä¸ªå±æ€§â€ï¼‰ï¼›</li>
<li><strong><code>set(target, key, value, receiver)</code></strong>ï¼šå½“ä¿®æ”¹<code>target[key]</code>æ—¶è§¦å‘ï¼Œç”¨äº<strong>è§¦å‘æ›´æ–°</strong>ï¼ˆé€šçŸ¥â€œä¾èµ–è¿™ä¸ªå±æ€§çš„å‡½æ•°é‡æ–°æ‰§è¡Œâ€ï¼‰ã€‚</li>
</ul>
<p><strong>ç®€å•Proxyç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> };
<span class="hljs-keyword">const</span> proxyUser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(user, {
  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è®¿é—®äº†<span class="hljs-subst">${key}</span>ï¼š<span class="hljs-subst">${target[key]}</span>`</span>);
    <span class="hljs-keyword">return</span> target[key];
  },
  <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä¿®æ”¹äº†<span class="hljs-subst">${key}</span>ï¼šä»<span class="hljs-subst">${target[key]}</span>åˆ°<span class="hljs-subst">${value}</span>`</span>);
    target[key] = value;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¡¨ç¤ºæ“ä½œæˆåŠŸ</span>
  }
});

proxyUser.<span class="hljs-property">name</span>; <span class="hljs-comment">// è¾“å‡ºï¼šè®¿é—®äº†nameï¼šAlice</span>
proxyUser.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// è¾“å‡ºï¼šä¿®æ”¹äº†nameï¼šä»Aliceåˆ°Bob</span>
</code></pre>
<h3 data-id="heading-7">2.3 Reflectï¼šä¿æŒåŸç”Ÿæ—¥å¿—çš„â€œå·¥å…·åº“â€</h3>
<p><code>Reflect</code>æ˜¯ES6çš„å†…ç½®å¯¹è±¡ï¼Œæä¾›äº†<strong>æ“ä½œå¯¹è±¡çš„åŸç”Ÿæ–¹æ³•</strong>ï¼ˆå¦‚<code>Reflect.get</code>/<code>Reflect.set</code>ï¼‰ã€‚Vueç”¨å®ƒçš„åŸå› æœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li><strong>ä¿æŒ<code>this</code>æŒ‡å‘æ­£ç¡®</strong>ï¼š<code>Reflect.get(target, key, receiver)</code>ä¼šè®©<code>target</code>çš„<code>getter</code>æ–¹æ³•ä¸­çš„<code>this</code>æŒ‡å‘<code>receiver</code>ï¼ˆå³Proxyå®ä¾‹ï¼‰ï¼Œè€Œç›´æ¥<code>target[key]</code>ä¼šæŒ‡å‘<code>target</code>æœ¬èº«ï¼›</li>
<li><strong>è¿”å›æ“ä½œç»“æœ</strong>ï¼š<code>Reflect.set</code>ä¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºä¿®æ”¹æ˜¯å¦æˆåŠŸï¼ˆå¯¹ä¸¥æ ¼æ¨¡å¼å¾ˆé‡è¦ï¼‰ã€‚</li>
</ol>
<p><strong>å¯¹æ¯”ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">fullName</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>; <span class="hljs-comment">// è¿™é‡Œçš„thisæŒ‡å‘è°ï¼Ÿ</span>
  }
};

<span class="hljs-comment">// ä¸ç”¨Reflectï¼šthisæŒ‡å‘userï¼ˆåŸå§‹å¯¹è±¡ï¼‰</span>
<span class="hljs-keyword">const</span> proxy1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(user, {
  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key</span>) {
    <span class="hljs-keyword">return</span> target[key]; <span class="hljs-comment">// fullNameçš„thisæ˜¯user</span>
  }
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(proxy1.<span class="hljs-property">fullName</span>); <span class="hljs-comment">// Aliceï¼ˆæ­£ç¡®ï¼‰</span>

<span class="hljs-comment">// ç”¨Reflectï¼šthisæŒ‡å‘proxy2ï¼ˆProxyå®ä¾‹ï¼‰</span>
<span class="hljs-keyword">const</span> proxy2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(user, {
  <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver); <span class="hljs-comment">// fullNameçš„thisæ˜¯proxy2</span>
  }
});
proxy2.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(proxy2.<span class="hljs-property">fullName</span>); <span class="hljs-comment">// Bobï¼ˆæ­£ç¡®ï¼Œå› ä¸ºthisæŒ‡å‘proxy2ï¼‰</span>
</code></pre>
<h2 data-id="heading-8">3. Vueå“åº”å¼ç³»ç»Ÿçš„å…·ä½“å®ç°</h2>
<h3 data-id="heading-9">3.1 æ ¸å¿ƒå‡½æ•°ï¼š<code>reactive</code>çš„å®ç°</h3>
<p>Vueçš„<code>reactive</code>å‡½æ•°æ˜¯Proxyçš„<strong>å°è£…</strong>ï¼Œç”¨äºåˆ›å»ºå“åº”å¼å¯¹è±¡ã€‚å…¶ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">target</span>) {
  <span class="hljs-comment">// ä»…ä»£ç†å¯¹è±¡/æ•°ç»„ï¼ˆåŸºæœ¬ç±»å‹ç”¨refï¼‰</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isObject</span>(target)) <span class="hljs-keyword">return</span> target;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, {
    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) {
      <span class="hljs-comment">// 1. è·å–åŸå§‹å€¼</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);
      <span class="hljs-comment">// 2. è¿½è¸ªä¾èµ–ï¼šè®°å½•â€œå½“å‰å‡½æ•°ç”¨åˆ°äº†target[key]â€</span>
      <span class="hljs-title function_">track</span>(target, key);
      <span class="hljs-comment">// 3. é€’å½’ä»£ç†ï¼šå¦‚æœresultæ˜¯å¯¹è±¡ï¼Œç»§ç»­ç”¨reactiveåŒ…è£¹</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isObject</span>(result) ? <span class="hljs-title function_">reactive</span>(result) : result;
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, value, receiver</span>) {
      <span class="hljs-comment">// 1. è·å–æ—§å€¼</span>
      <span class="hljs-keyword">const</span> oldValue = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);
      <span class="hljs-comment">// 2. ä¿®æ”¹å€¼</span>
      <span class="hljs-keyword">const</span> success = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, value, receiver);
      <span class="hljs-comment">// 3. è§¦å‘æ›´æ–°ï¼šå¦‚æœå€¼å˜åŒ–ï¼Œé€šçŸ¥ä¾èµ–è€…é‡æ–°æ‰§è¡Œ</span>
      <span class="hljs-keyword">if</span> (success &amp;&amp; oldValue !== value) {
        <span class="hljs-title function_">trigger</span>(target, key);
      }
      <span class="hljs-keyword">return</span> success;
    }
  });
}
</code></pre>
<h3 data-id="heading-10">3.2 ä¾èµ–è¿½è¸ªï¼š<code>track</code>å‡½æ•°</h3>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ffc4ef84559e04693a620d0714cb30787%2F" target="_blank" title="https://blog.cmdragon.cn/posts/fc4ef84559e04693a620d0714cb30787/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨Git Hookå’ŒCIæµæ°´çº¿ä¸ºFastAPIé¡¹ç›®ä¿é©¾æŠ¤èˆªï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F02b0c96842d1481c72dab63a149ce0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/02b0c96842d1481c72dab63a149ce0dd/" ref="nofollow noopener noreferrer">FastAPIå¦‚ä½•ç”¨å¥‘çº¦æµ‹è¯•ç¡®ä¿APIçš„ã€Œèœå•ã€ä¸ã€Œèœå“ã€ä¸€è‡´ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc9c1e3bb0fdc15303b9b3b1f20124b0b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c9c1e3bb0fdc15303b9b3b1f20124b0b/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆTDDèƒ½è®©ä½ çš„FastAPIå¼€å‘é£èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbfa0447a5d0d6f9af12e7a6b206f70%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbfa0447a5d0d6f9af12e7a6b206f70/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨FastAPIç©è½¬å¤šæ¨¡å—æµ‹è¯•ä¸å¼‚æ­¥ä»»åŠ¡ï¼Œè®©ä»£ç ä¸å†â€œé—¹è„¾æ°”â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf9883a75ffa46b523a03b16ec56ce48%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf9883a75ffa46b523a03b16ec56ce48/" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨FastAPIä¸­ç©è½¬â€œæ—¶å…‰å€’æµâ€çš„æ•°æ®åº“äº‹åŠ¡å›æ»šæµ‹è¯•ï¼Ÿ</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<p><code>track</code>çš„ä½œç”¨æ˜¯<strong>è®°å½•â€œè°ä¾èµ–äº†è¿™ä¸ªå±æ€§â€</strong>ã€‚Vueç”¨<strong>å…¨å±€WeakMap</strong>å­˜å‚¨ä¾èµ–å…³ç³»ï¼š</p>
<ul>
<li><code>targetMap</code>ï¼š<code>WeakMap&lt;target, Map&lt;key, Set&lt;effect&gt;&gt;&gt;</code>ï¼Œé”®æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼Œå€¼æ˜¯â€œå±æ€§â†’ä¾èµ–å‡½æ•°â€çš„æ˜ å°„ï¼›</li>
<li><code>activeEffect</code>ï¼šå½“å‰æ­£åœ¨è¿è¡Œçš„<strong>Effectå‡½æ•°</strong>ï¼ˆä¾èµ–å“åº”å¼æ•°æ®çš„å‡½æ•°ï¼‰ã€‚</li>
</ul>
<p><code>track</code>çš„ä¼ªä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€å­˜å‚¨ï¼štarget -&gt; key -&gt; effects</span>
<span class="hljs-keyword">const</span> targetMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
<span class="hljs-comment">// å½“å‰è¿è¡Œçš„Effectï¼ˆå…¨å±€å˜é‡ï¼‰</span>
<span class="hljs-keyword">let</span> activeEffect = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">track</span>(<span class="hljs-params">target, key</span>) {
  <span class="hljs-keyword">if</span> (!activeEffect) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„Effectï¼Œè·³è¿‡</span>
  <span class="hljs-comment">// 1. è·å–targetçš„ä¾èµ–Map</span>
  <span class="hljs-keyword">let</span> depsMap = targetMap.<span class="hljs-title function_">get</span>(target);
  <span class="hljs-keyword">if</span> (!depsMap) {
    depsMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    targetMap.<span class="hljs-title function_">set</span>(target, depsMap);
  }
  <span class="hljs-comment">// 2. è·å–keyçš„Effecté›†åˆ</span>
  <span class="hljs-keyword">let</span> deps = depsMap.<span class="hljs-title function_">get</span>(key);
  <span class="hljs-keyword">if</span> (!deps) {
    deps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    depsMap.<span class="hljs-title function_">set</span>(key, deps);
  }
  <span class="hljs-comment">// 3. æ·»åŠ å½“å‰Effectåˆ°é›†åˆ</span>
  deps.<span class="hljs-title function_">add</span>(activeEffect);
}
</code></pre>
<h3 data-id="heading-11">3.3 æ›´æ–°è§¦å‘ï¼š<code>trigger</code>å‡½æ•°</h3>
<p><code>trigger</code>çš„ä½œç”¨æ˜¯<strong>æ‰§è¡Œæ‰€æœ‰ä¾èµ–è¯¥å±æ€§çš„Effectå‡½æ•°</strong>ï¼Œè§¦å‘æ›´æ–°ã€‚å…¶ä¼ªä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">trigger</span>(<span class="hljs-params">target, key</span>) {
  <span class="hljs-comment">// 1. è·å–targetçš„ä¾èµ–Map</span>
  <span class="hljs-keyword">const</span> depsMap = targetMap.<span class="hljs-title function_">get</span>(target);
  <span class="hljs-keyword">if</span> (!depsMap) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ²¡æœ‰ä¾èµ–ï¼Œè·³è¿‡</span>
  <span class="hljs-comment">// 2. è·å–keyçš„Effecté›†åˆ</span>
  <span class="hljs-keyword">const</span> deps = depsMap.<span class="hljs-title function_">get</span>(key);
  <span class="hljs-keyword">if</span> (!deps) <span class="hljs-keyword">return</span>;
  <span class="hljs-comment">// 3. æ‰§è¡Œæ‰€æœ‰Effect</span>
  deps.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">effect</span> =&gt;</span> <span class="hljs-title function_">effect</span>());
}
</code></pre>
<h3 data-id="heading-12">3.4 Effectï¼šå“åº”å¼çš„â€œå‰¯ä½œç”¨â€</h3>
<p><strong>Effect</strong>æ˜¯<strong>ä¾èµ–å“åº”å¼æ•°æ®çš„å‡½æ•°</strong>ï¼Œå½“æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚Vueçš„<code>watchEffect</code>å’Œ<code>computed</code>éƒ½æ˜¯åŸºäºEffectå®ç°çš„ã€‚</p>
<h4 data-id="heading-13">Effectçš„ä¼ªä»£ç ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">effect</span>(<span class="hljs-params">fn</span>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">reactiveEffect</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
      activeEffect = reactiveEffect; <span class="hljs-comment">// æ ‡è®°å½“å‰Effect</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(); <span class="hljs-comment">// æ‰§è¡Œfnï¼Œè§¦å‘track</span>
    } <span class="hljs-keyword">finally</span> {
      activeEffect = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ¸…é™¤æ ‡è®°</span>
    }
  };
  <span class="hljs-title function_">reactiveEffect</span>(); <span class="hljs-comment">// ç«‹å³æ‰§è¡Œä¸€æ¬¡</span>
  <span class="hljs-keyword">return</span> reactiveEffect;
}
</code></pre>
<h4 data-id="heading-14">ä¾‹å­ï¼šç”¨<code>watchEffect</code>å®ç°è®¡æ•°å™¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, watchEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> });

<span class="hljs-comment">// åˆ›å»ºEffectï¼šä¾èµ–state.count</span>
<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Count: <span class="hljs-subst">${state.count}</span>`</span>);
});

state.<span class="hljs-property">count</span>++; <span class="hljs-comment">// è¾“å‡ºï¼šCount: 1</span>
state.<span class="hljs-property">count</span>++; <span class="hljs-comment">// è¾“å‡ºï¼šCount: 2</span>
</code></pre>
<h2 data-id="heading-15">4. åº”ç”¨åœºæ™¯ï¼šå“åº”å¼åœ¨Vueç»„ä»¶ä¸­çš„ä½¿ç”¨</h2>
<h3 data-id="heading-16">4.1 ç»„ä»¶çŠ¶æ€ç®¡ç†ï¼š<code>reactive</code>ä¸<code>ref</code></h3>
<ul>
<li><strong><code>reactive</code></strong>ï¼šç”¨äº<strong>å¤æ‚å¯¹è±¡/æ•°ç»„</strong>ï¼ˆå¦‚<code>user</code>ã€<code>list</code>ï¼‰ï¼Œè¿”å›Proxyå®ä¾‹ï¼›</li>
<li><strong><code>ref</code></strong>ï¼šç”¨äº<strong>åŸºæœ¬ç±»å‹</strong>ï¼ˆå¦‚<code>count</code>ã€<code>message</code>ï¼‰ï¼Œå› ä¸ºProxyä¸èƒ½ä»£ç†åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ç”¨<code>ref</code>çš„<code>value</code>å±æ€§åŒ…è£¹ï¼ˆVueæ¨¡æ¿ä¼šè‡ªåŠ¨è§£åŒ…ï¼‰ã€‚</li>
</ul>
<p><strong>ç»„ä»¶ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { reactive, ref } from 'vue';

// å¤æ‚å¯¹è±¡ç”¨reactive
const user = reactive({
  name: 'Alice',
  age: 25
});

// åŸºæœ¬ç±»å‹ç”¨ref
const count = ref(0);

// ç‚¹å‡»äº‹ä»¶ï¼šä¿®æ”¹çŠ¶æ€
const increment = () =&gt; {
  count.value++; // reféœ€ç”¨.value
  user.age++; // reactiveç›´æ¥ä¿®æ”¹
};
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;{{ user.name }} ({{ user.age }})&lt;/h1&gt;
    &lt;p&gt;Count: {{ count }}&lt;/p&gt; &lt;!-- æ¨¡æ¿è‡ªåŠ¨è§£åŒ…ref --&gt;
    &lt;button @click="increment"&gt;Increment&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-17">4.2 ä¿æŒå“åº”å¼ï¼š<code>toRefs</code>ä¸<code>toRef</code></h3>
<p><strong>é—®é¢˜</strong>ï¼šè§£æ„<code>reactive</code>å¯¹è±¡ä¼šå¤±å»å“åº”å¼â€”â€”å› ä¸ºè§£æ„å‡ºæ¥çš„æ˜¯æ™®é€šå˜é‡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> });
<span class="hljs-keyword">const</span> { name, age } = user; <span class="hljs-comment">// name/ageæ˜¯æ™®é€šå˜é‡ï¼Œä¸æ˜¯Proxy</span>
name = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// ä¸ä¼šè§¦å‘æ›´æ–°</span>
</code></pre>
<p><strong>è§£å†³</strong>ï¼šç”¨<code>toRefs</code>å°†<code>reactive</code>å¯¹è±¡çš„æ‰€æœ‰å±æ€§è½¬ä¸º<code>ref</code>ï¼Œæˆ–ç”¨<code>toRef</code>è½¬ä¸ºå•ä¸ª<code>ref</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, toRefs, toRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> });
<span class="hljs-keyword">const</span> { name, age } = <span class="hljs-title function_">toRefs</span>(user); <span class="hljs-comment">// name/ageæ˜¯ref</span>
<span class="hljs-keyword">const</span> ageRef = <span class="hljs-title function_">toRef</span>(user, <span class="hljs-string">'age'</span>); <span class="hljs-comment">// å•ä¸ªref</span>
</code></pre>
<h3 data-id="heading-18">4.3 æ•°ç»„çš„å“åº”å¼å¤„ç†</h3>
<p>Proxyå¤©ç„¶æ”¯æŒæ•°ç»„çš„<strong>æ‰€æœ‰æ“ä½œ</strong>ï¼ˆå¦‚<code>push</code>/<code>pop</code>/<code>splice</code>ã€ç´¢å¼•ä¿®æ”¹ã€<code>length</code>å˜åŒ–ï¼‰ï¼Œæ— éœ€åƒVue 2é‚£æ ·é‡å†™æ•°ç»„æ–¹æ³•ã€‚</p>
<p><strong>ä¾‹å­</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> list = <span class="hljs-title function_">reactive</span>([<span class="hljs-string">'apple'</span>, <span class="hljs-string">'banana'</span>]);

<span class="hljs-comment">// pushè§¦å‘æ›´æ–°</span>
list.<span class="hljs-title function_">push</span>(<span class="hljs-string">'orange'</span>); <span class="hljs-comment">// è§†å›¾è‡ªåŠ¨æ›´æ–°</span>

<span class="hljs-comment">// ç´¢å¼•ä¿®æ”¹è§¦å‘æ›´æ–°</span>
list[<span class="hljs-number">0</span>] = <span class="hljs-string">'grape'</span>; <span class="hljs-comment">// è§†å›¾è‡ªåŠ¨æ›´æ–°</span>

<span class="hljs-comment">// lengthä¿®æ”¹è§¦å‘æ›´æ–°</span>
list.<span class="hljs-property">length</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// è§†å›¾è‡ªåŠ¨æ›´æ–°</span>
</code></pre>
<h2 data-id="heading-19">5. å“åº”å¼è°ƒè¯•ä¸å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-20">5.1 è°ƒè¯•å·¥å…·ï¼š<code>onRenderTracked</code>ä¸<code>onRenderTriggered</code></h3>
<p>Vueæä¾›äº†<strong>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­</strong>ï¼Œç”¨äºè°ƒè¯•æ¸²æŸ“æ—¶çš„ä¾èµ–è¿½è¸ªå’Œè§¦å‘ï¼š</p>
<ul>
<li><code>onRenderTracked</code>ï¼šç»„ä»¶æ¸²æŸ“æ—¶ï¼Œè¿½è¸ªåˆ°ä¾èµ–çš„å“åº”å¼æ•°æ®æ—¶è§¦å‘ï¼›</li>
<li><code>onRenderTriggered</code>ï¼šç»„ä»¶æ›´æ–°æ—¶ï¼Œè§¦å‘æ›´æ–°çš„å“åº”å¼æ•°æ®å˜åŒ–æ—¶è§¦å‘ã€‚</li>
</ul>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { onRenderTracked, onRenderTriggered } from 'vue';

onRenderTracked((event) =&gt; {
  console.log('Tracked:', event); // æ‰“å°ä¾èµ–ä¿¡æ¯
  debugger; // æ–­ç‚¹è°ƒè¯•
});

onRenderTriggered((event) =&gt; {
  console.log('Triggered:', event); // æ‰“å°è§¦å‘æ›´æ–°çš„ä¿¡æ¯
  debugger;
});
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-21">5.2 <code>computed</code>ä¸<code>watch</code>çš„è°ƒè¯•</h3>
<ul>
<li><strong><code>computed</code></strong>ï¼šç”¨<code>onTrack</code>ï¼ˆè¿½è¸ªä¾èµ–ï¼‰å’Œ<code>onTrigger</code>ï¼ˆè§¦å‘æ›´æ–°ï¼‰é€‰é¡¹ï¼›</li>
<li><strong><code>watch</code></strong>ï¼šåŒæ ·æ”¯æŒ<code>onTrack</code>å’Œ<code>onTrigger</code>é€‰é¡¹ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> doubleCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>, {
  <span class="hljs-title function_">onTrack</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Computed tracked:'</span>, event); <span class="hljs-comment">// è¿½è¸ªåˆ°count.value</span>
  },
  <span class="hljs-title function_">onTrigger</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Computed triggered:'</span>, event); <span class="hljs-comment">// count.valueå˜åŒ–è§¦å‘</span>
  }
});

count.<span class="hljs-property">value</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// è§¦å‘onTrigger</span>
</code></pre>
<h2 data-id="heading-22">6. è¯¾åQuiz</h2>
<h3 data-id="heading-23">6.1 é—®é¢˜1ï¼šä¸ºä»€ä¹ˆVue 3ç”¨Proxyè€Œä¸æ˜¯Vue 2çš„Object.definePropertyï¼Ÿ</h3>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<br/>
Proxyè§£å†³äº†Object.definePropertyçš„ä¸‰å¤§å±€é™ï¼š</p>
<ol>
<li><strong>å¤©ç„¶æ”¯æŒæ•°ç»„</strong>ï¼šæ— éœ€é‡å†™<code>push</code>/<code>pop</code>ç­‰æ–¹æ³•ï¼›</li>
<li><strong>æ”¯æŒæ–°å¢/åˆ é™¤å±æ€§</strong>ï¼šæ— éœ€<code>Vue.set</code>/<code>Vue.delete</code>ï¼›</li>
<li><strong>æ›´å…¨é¢çš„æ‹¦æˆª</strong>ï¼šèƒ½æ‹¦æˆª<code>deleteProperty</code>/<code>ownKeys</code>ç­‰æ“ä½œã€‚</li>
</ol>
<h3 data-id="heading-24">6.2 é—®é¢˜2ï¼šè§£æ„<code>reactive</code>å¯¹è±¡åå¦‚ä½•ä¿æŒå“åº”å¼ï¼Ÿ</h3>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<br/>
ç”¨<code>toRefs</code>å°†<code>reactive</code>å¯¹è±¡çš„æ‰€æœ‰å±æ€§è½¬ä¸º<code>ref</code>ï¼Œæˆ–ç”¨<code>toRef</code>è½¬ä¸ºå•ä¸ª<code>ref</code>ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { name, age } = <span class="hljs-title function_">toRefs</span>(user); <span class="hljs-comment">// name/ageæ˜¯refï¼Œä¿æŒå“åº”å¼</span>
</code></pre>
<h3 data-id="heading-25">6.3 é—®é¢˜3ï¼š<code>ref</code>çš„<code>value</code>å±æ€§åœ¨æ¨¡æ¿ä¸­ä¸ºä»€ä¹ˆä¸éœ€è¦æ‰‹åŠ¨å†™ï¼Ÿ</h3>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<br/>
Vueåœ¨æ¨¡æ¿ç¼–è¯‘æ—¶ä¼š<strong>è‡ªåŠ¨è§£åŒ…<code>ref</code></strong>â€”â€”å°†<code>{{ count }}</code>è½¬ä¸º<code>{{ count.value }}</code>ï¼Œæ‰€ä»¥æ— éœ€æ‰‹åŠ¨å†™<code>value</code>ã€‚</p>
<h2 data-id="heading-26">7. å¸¸è§æŠ¥é”™è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-27">7.1 æŠ¥é”™1ï¼š<code>TypeError: Cannot read property 'value' of undefined</code></h3>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li><code>ref</code>æœªåˆå§‹åŒ–ï¼š<code>const count = ref()</code>ï¼ˆ<code>count.value</code>æ˜¯<code>undefined</code>ï¼‰ï¼›</li>
<li>è§£æ„<code>reactive</code>å¯¹è±¡æ—¶æœªç”¨<code>toRefs</code>ï¼š<code>const { count } = user</code>ï¼ˆ<code>count</code>æ˜¯æ™®é€šå˜é‡ï¼Œæ— <code>value</code>å±æ€§ï¼‰ã€‚</li>
</ul>
<p><strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>åˆå§‹åŒ–<code>ref</code>ï¼š<code>const count = ref(0)</code>ï¼›</li>
<li>è§£æ„ç”¨<code>toRefs</code>ï¼š<code>const { count } = toRefs(user)</code>ã€‚</li>
</ul>
<h3 data-id="heading-28">7.2 æŠ¥é”™2ï¼šæ–°å¢å±æ€§ä¸è§¦å‘æ›´æ–°</h3>
<p><strong>åŸå› </strong>ï¼š<br/>
Proxyèƒ½ç›‘å¬æ–°å¢å±æ€§ï¼Œä½†<strong>åµŒå¥—å¯¹è±¡æœªç”¨<code>reactive</code>åŒ…è£¹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({});
user.<span class="hljs-property">address</span> = { <span class="hljs-attr">city</span>: <span class="hljs-string">'Beijing'</span> }; <span class="hljs-comment">// addressæ˜¯æ™®é€šå¯¹è±¡ï¼Œä¸æ˜¯å“åº”å¼</span>
user.<span class="hljs-property">address</span>.<span class="hljs-property">city</span> = <span class="hljs-string">'Shanghai'</span>; <span class="hljs-comment">// ä¸ä¼šè§¦å‘æ›´æ–°</span>
</code></pre>
<p><strong>è§£å†³</strong>ï¼š<br/>
ç”¨<code>reactive</code>åŒ…è£¹åµŒå¥—å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">user.<span class="hljs-property">address</span> = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">city</span>: <span class="hljs-string">'Beijing'</span> });
user.<span class="hljs-property">address</span>.<span class="hljs-property">city</span> = <span class="hljs-string">'Shanghai'</span>; <span class="hljs-comment">// è§¦å‘æ›´æ–°</span>
</code></pre>
<h3 data-id="heading-29">7.3 æŠ¥é”™3ï¼šæ•°ç»„ç´¢å¼•ä¿®æ”¹ä¸è§¦å‘æ›´æ–°</h3>
<p><strong>åŸå› </strong>ï¼š<br/>
ç›´æ¥ä¿®æ”¹ç´¢å¼•æ—¶ï¼Œè‹¥æ•°ç»„æ˜¯<strong>æ™®é€šæ•°ç»„</strong>ï¼ˆé<code>reactive</code>ï¼‰ï¼Œåˆ™æ— æ³•è§¦å‘æ›´æ–°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> list = [<span class="hljs-string">'apple'</span>, <span class="hljs-string">'banana'</span>]; <span class="hljs-comment">// æ™®é€šæ•°ç»„</span>
list[<span class="hljs-number">0</span>] = <span class="hljs-string">'grape'</span>; <span class="hljs-comment">// ä¸ä¼šè§¦å‘æ›´æ–°</span>
</code></pre>
<p><strong>è§£å†³</strong>ï¼š<br/>
ç”¨<code>reactive</code>åˆ›å»ºæ•°ç»„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> list = <span class="hljs-title function_">reactive</span>([<span class="hljs-string">'apple'</span>, <span class="hljs-string">'banana'</span>]);
list[<span class="hljs-number">0</span>] = <span class="hljs-string">'grape'</span>; <span class="hljs-comment">// è§¦å‘æ›´æ–°</span>
</code></pre>
<h2 data-id="heading-30">å‚è€ƒé“¾æ¥</h2>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fextras%2Freactivity-in-depth.html" target="_blank" title="https://vuejs.org/guide/extras/reactivity-in-depth.html" ref="nofollow noopener noreferrer">vuejs.org/guide/extraâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°ä¸€æ¬¡ Next.js + K8s + CDN ç¼“å­˜å¯¼è‡´ RSC æ³„æ¼çš„æ’æŸ¥ä¸ä¿®å¤]]></title>    <link>https://juejin.cn/post/7571747061386084371</link>    <guid>https://juejin.cn/post/7571747061386084371</guid>    <pubDate>2025-11-13T03:50:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571747061386084371" data-draft-id="7571753301897838632" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°ä¸€æ¬¡ Next.js + K8s + CDN ç¼“å­˜å¯¼è‡´ RSC æ³„æ¼çš„æ’æŸ¥ä¸ä¿®å¤"/> <meta itemprop="keywords" content="å‰ç«¯,ç¨‹åºå‘˜,React.js"/> <meta itemprop="datePublished" content="2025-11-13T03:50:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ERIC_s"/> <meta itemprop="url" content="https://juejin.cn/user/3202241515503000"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°ä¸€æ¬¡ Next.js + K8s + CDN ç¼“å­˜å¯¼è‡´ RSC æ³„æ¼çš„æ’æŸ¥ä¸ä¿®å¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3202241515503000/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ERIC_s
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:50:27.000Z" title="Thu Nov 13 2025 03:50:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>æœ¬æ–‡è®°å½•äº†æˆ‘åœ¨ä¸€ä¸ª Next.jsï¼ˆApp Routerï¼‰é¡¹ç›®éƒ¨ç½²åˆ° K8sï¼Œå¹¶é€šè¿‡äº‘å‚å•† CDN åŠ é€Ÿæ—¶ï¼Œé‡åˆ°çš„ä¸€ä¸ªç”Ÿäº§é—®é¢˜ï¼šé¡µé¢å¶å‘æ€§â€œå˜æˆä¸€å †å¥‡æ€ªçš„ä»£ç â€ï¼Œæ¯”å¦‚ <code>$Sreact.fragment</code>ã€<code>OutletBoundary</code> ç­‰æ–‡æœ¬ç›´æ¥æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚</p>
<p>æœ€ç»ˆç¡®è®¤ä¸º CDN çš„ç¼“å­˜ç­–ç•¥ä¸ RSC å“åº”å˜ä½“ä¸å…¼å®¹æ‰€è‡´ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„æ’æŸ¥è·¯å¾„ä¸ä¿®å¤æ–¹æ¡ˆï¼ŒæœŸæœ›å¯¹ç±»ä¼¼åœºæ™¯æœ‰æ‰€å‚è€ƒã€‚</p>
<hr/>
<h2 data-id="heading-0">èƒŒæ™¯ä¸æ¶æ„</h2>
<ul>
<li>å‰ç«¯æ¡†æ¶ï¼šNext.jsï¼ˆApp Routerï¼‰</li>
<li>éƒ¨ç½²ç¯å¢ƒï¼šKubernetesï¼ˆK8sï¼‰</li>
<li>åŠ é€Ÿï¼šäº‘å‚å•† CDNï¼ˆä»…æ”¯æŒâ€œç›®å½•æˆ–åç¼€â€è§„åˆ™é…ç½®ï¼Œä¸æ”¯æŒæŒ‰è¯·æ±‚å¤´ç»´åº¦çš„ç¼“å­˜é”®è‡ªå®šä¹‰ï¼‰</li>
</ul>
<p>é¡¹ç›®åŒ…å«ï¼š</p>
<ul>
<li>App Router é¡µé¢ä¸é™æ€èµ„æºï¼›</li>
</ul>
<hr/>
<h2 data-id="heading-1">ç°è±¡ä¸çº¿ç´¢</h2>
<p>é¡µé¢â€œå˜æˆä»£ç â€</p>
<ul>
<li>éƒ¨åˆ†é¡µé¢åœ¨åˆ·æ–°é¢„çƒ­åçŸ­æ—¶é—´å†…æ­£å¸¸ï¼Œä½†è¿‡ä¸€æ®µæ—¶é—´å°±ä¼šå‡ºç°é¡µé¢è¿”å› <code>text/x-component</code>ï¼Œæ­£æ–‡ç±»ä¼¼ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-variable">$Sreact</span>.fragment
OutletBoundary
ClientPageRoot
...
</code></pre>
<ul>
<li>å“åº”å¤´åŒ…å«ï¼š</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-attribute">Content-Type</span>: text/x-component
<span class="hljs-attribute">Vary</span>: rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch, Accept-Encoding
<span class="hljs-attribute">x-nextjs-cache</span>: HIT
<span class="hljs-attribute">x-nextjs-prerender</span>: <span class="hljs-number">1</span>
<span class="hljs-attribute">x-nextjs-stale-time</span>: <span class="hljs-number">300</span>
</code></pre>
<p>è¿™å…¶å®æ˜¯ Next.js çš„ RSCï¼ˆReact Server Componentsï¼‰æµå¼å“åº”ï¼Œç”¨äºå®¢æˆ·ç«¯è·¯ç”±å’Œé¢„å–ï¼›ä¸åº”è¯¥è¢« CDN ç»™æ™®é€šé¡µé¢è¯·æ±‚å¤ç”¨ã€‚</p>
<p>å¿«é€Ÿè‡ªæ£€ï¼ˆå¯å¤åˆ¶ç²˜è´´ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1) çœ‹å“åº”æ˜¯å¦ä¸º text/x-componentï¼ˆåº”ä¸º text/htmlï¼‰</span>
curl -s -I https://your-domain/zh-cn/company | grep -i content-type
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 2) çœ‹ CDN æ˜¯å¦å‘½ä¸­ï¼ˆä¸åŒå‚å•†å­—æ®µç•¥æœ‰å·®å¼‚ï¼‰</span>
curl -s -I https://your-domain/zh-cn/company | grep -iE <span class="hljs-string">'age|x-cache|cdn-cache'</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 3) æ¨¡æ‹Ÿ RSC è¯·æ±‚ï¼ˆNext.js 13+ é€šç”¨ï¼‰</span>
curl -s \
  -H <span class="hljs-string">"rsc: 1"</span> \
  -H <span class="hljs-string">"accept: text/x-component"</span> \
  https://your-domain/zh-cn/company | <span class="hljs-built_in">head</span> -c 200
</code></pre>
<hr/>
<h2 data-id="heading-2">æ ¹å› åˆ†æ</h2>
<p>CDN é”™è¯¯ç¼“å­˜äº† RSC å“åº”å˜ä½“</p>
<ul>
<li>App Router ä¸‹ï¼ŒNext.js å¯¹é¡µé¢å’Œ RSC æµé‡‡ç”¨ä¸åŒçš„å“åº”å½¢æ€ï¼›RSC å“åº”ä»¥ <code>text/x-component</code> è¿”å›ï¼Œå¹¶é€šè¿‡ <code>Vary</code> æ§åˆ¶ä¸åŒçš„è¯·æ±‚å¤´å˜ä½“ï¼ˆå¦‚ <code>rsc</code>ã€<code>next-router-prefetch</code> ç­‰ï¼‰ã€‚</li>
<li>å½“ CDN ä»…æ”¯æŒâ€œç›®å½•æˆ–åç¼€â€ç­–ç•¥ã€æ— æ³•å°†è¿™äº›è¯·æ±‚å¤´å¹¶å…¥ç¼“å­˜é”®æ—¶ï¼Œå°±ä¼šå‘ç”Ÿâ€œå¸¦é¢„å–/è·¯ç”±å¤´çš„ RSC å“åº”è¢«ç¼“å­˜â€ï¼Œéšåè¢«è¯¯ç”¨äºæ™®é€šé¡µé¢è¯·æ±‚ï¼Œå¯¼è‡´é¡µé¢æ˜¾ç¤º RSC æµæ–‡æœ¬ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">ä¿®å¤æ–¹æ¡ˆ</h2>
<h3 data-id="heading-4">1. CDN åªç¼“å­˜â€œé™æ€ç™½åå•â€ï¼Œé¡µé¢è·¯å¾„ä¸ç¼“å­˜</h3>
<p>ç”±äº CDN ä¸æ”¯æŒæŒ‰è¯·æ±‚å¤´åŒºåˆ†ç¼“å­˜é”®ï¼Œé‡‡ç”¨â€œç™½åå•ç¼“å­˜é™æ€ã€é»‘åå•ä¸ç¼“å­˜é¡µé¢â€çš„ç­–ç•¥æœ€ç¨³å¦¥ï¼š</p>
<ul>
<li>ç¼“å­˜åç¼€ç™½åå•ï¼ˆTTL å»ºè®® 7â€“30 å¤©ï¼‰ï¼š
<ul>
<li><code>*.js</code>, <code>*.css</code>, <code>*.png</code>, <code>*.jpg</code>, <code>*.svg</code>, <code>*.webp</code>, <code>*.ico</code>, <code>*.woff</code>, <code>*.woff2</code></li>
</ul>
</li>
<li>ç¼“å­˜ç›®å½•ç™½åå•ï¼ˆTTL å»ºè®® 30 å¤©ï¼‰ï¼š
<ul>
<li><code>/_next/static/*</code>ï¼ˆNext æ„å»ºäº§ç‰©è·¯å¾„ï¼Œå¸¦æ„å»ºæŒ‡çº¹ï¼Œé•¿ TTL å®‰å…¨ï¼‰</li>
</ul>
</li>
<li>é¡µé¢ç›®å½•ä¸ç¼“å­˜ï¼ˆæˆ– TTL=0ï¼‰ï¼š
<ul>
<li><code>/zh-cn/*</code>, <code>/zh-hk/*</code>, <code>/en-us/*</code>ï¼ˆé¡¹ç›®é¡µé¢å‡ä½äºè¯­è¨€å‰ç¼€è·¯å¾„ä¸‹ï¼‰</li>
</ul>
</li>
<li>é»˜è®¤è§„åˆ™ï¼šä¸ç¼“å­˜ï¼ˆæˆ–éµå¾ªæºç«™ï¼‰ã€‚</li>
</ul>
<p>åŒæ—¶ï¼Œé¢„çƒ­ï¼ˆprewarmï¼‰åªé¢„çƒ­é™æ€èµ„æºï¼›ä¸è¦é¢„çƒ­é¡µé¢è·¯å¾„ï¼Œé¿å…å°† RSC å˜ä½“æ¨å…¥ CDN ç¼“å­˜ã€‚</p>
<h3 data-id="heading-5">2. æºç«™ä¸­é—´ä»¶ä¸º RSC/é¢„å–è¯·æ±‚è®¾ç½® <code>no-store</code></h3>
<p>åœ¨ <code>src/middleware.ts</code> ä¸­å¯¹å¸¦æœ‰ RSC/é¢„å–ç‰¹å¾çš„è¯·æ±‚å¤´æ·»åŠ  <code>Cache-Control: private, no-store</code>ï¼Œå‡å°‘è¢« CDN è¯¯ç¼“å­˜çš„å‡ ç‡ã€‚æ ¸å¿ƒé€»è¾‘ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span>, <span class="hljs-title class_">NextResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/server'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">matcher</span>: [<span class="hljs-string">'/((?!api|_next/static|_next/image|assets|favicon.ico|sw.js).*)'</span>],
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">middleware</span>(<span class="hljs-params">req: NextRequest</span>) {
  <span class="hljs-keyword">const</span> isRSCRequest =
    req.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'rsc'</span>) === <span class="hljs-string">'1'</span> ||
    req.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'next-router-prefetch'</span>) === <span class="hljs-string">'1'</span> ||
    req.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'next-router-segment-prefetch'</span>) === <span class="hljs-string">'1'</span> ||
    (req.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'accept'</span>) || <span class="hljs-string">''</span>).<span class="hljs-title function_">includes</span>(<span class="hljs-string">'text/x-component'</span>) ||
    (req.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'accept'</span>) || <span class="hljs-string">''</span>).<span class="hljs-title function_">includes</span>(<span class="hljs-string">'application/vnd.nextjs.router+json'</span>)

  <span class="hljs-keyword">const</span> res = <span class="hljs-title class_">NextResponse</span>.<span class="hljs-title function_">next</span>()
  <span class="hljs-keyword">if</span> (isRSCRequest) res.<span class="hljs-property">headers</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'private, no-store'</span>)
  <span class="hljs-keyword">return</span> res
}
</code></pre>
<p>æ³¨æ„ï¼šCDN å¿…é¡»â€œéµå¾ªæºç«™ç¼“å­˜æŒ‡ä»¤â€ï¼Œè¯¥ç­–ç•¥æ‰ä¼šç”Ÿæ•ˆï¼›å¦åˆ™è¿˜æ˜¯è¦é è§„åˆ™å±‚é¢çš„â€œé¡µé¢ä¸ç¼“å­˜â€ã€‚</p>
<p>æé†’ï¼šåŠ¡å¿…ç¡®è®¤ CDN æ§åˆ¶å°â€œç¼“å­˜è§„åˆ™â€â†’â€œéµå¾ªæºç«™ Cache-Controlâ€å¤„äºå¼€å¯çŠ¶æ€ï¼Œå¦åˆ™ä¸­é—´ä»¶ä¸‹å‘çš„ <code>no-store</code> ä¼šè¢« CDN ç›´æ¥å¿½ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-6">å‘å¸ƒä¸éªŒè¯</h2>
<ol>
<li>åº”ç”¨æºç«™ä¸­é—´ä»¶å˜æ›´</li>
</ol>
<ul>
<li>éƒ¨ç½²æ›´æ–°å¹¶æ»šåŠ¨é‡å¯åº”ç”¨ï¼Œä½¿ä¸­é—´ä»¶çš„ <code>Cache-Control: private, no-store</code> ç”Ÿæ•ˆã€‚</li>
<li>ç¡®è®¤æºç«™å“åº”å·²åŒ…å«é¢„æœŸçš„ <code>Cache-Control</code> ä¸ <code>Content-Type</code>ï¼ˆé¡µé¢ä¸º <code>text/html</code>ï¼‰ã€‚</li>
</ul>
<ol start="2">
<li>æ¸…ç†å¹¶é¢„çƒ­ CDN</li>
</ol>
<ul>
<li>æ¸…ç†ç¼“å­˜åï¼Œåªé¢„çƒ­é™æ€èµ„æºç›®å½•ï¼ˆå¦‚ <code>/_next/static/*</code>ï¼‰ã€‚</li>
<li>ä¸é¢„çƒ­é¡µé¢ç›®å½•ï¼ˆå¦‚ <code>/zh-cn/*</code>ï¼‰ï¼Œé¿å…è¯¯ç¼“å­˜ RSCã€‚</li>
</ul>
<ol start="3">
<li>éªŒè¯é¡µé¢ä¸é™æ€èµ„æº</li>
</ol>
<ul>
<li>é¡µé¢ URLï¼ˆä¾‹å¦‚ <code>/zh-cn/company</code>ï¼‰ï¼š
<ul>
<li>æœŸæœ› <code>Content-Type</code> ä¸º <code>text/html</code>ï¼ˆè€Œé <code>text/x-component</code>ï¼‰ã€‚</li>
<li>è§‚å¯Ÿ <code>Age</code> ä¸ç¼“å­˜å‘½ä¸­æ˜¯å¦ç¬¦åˆâ€œä¸ç¼“å­˜é¡µé¢â€çš„é¢„æœŸã€‚</li>
</ul>
</li>
<li>é™æ€èµ„æºï¼ˆå¦‚ <code>/_next/static/...</code>ï¼‰ï¼š
<ul>
<li>æœŸæœ›å¤§ TTL ä¸”ç»å¸¸å‘½ä¸­ CDNã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-7">å…¼å®¹æ€§ä¸æƒè¡¡</h2>
<ul>
<li>
<p>ISRï¼ˆå¢é‡é™æ€å†ç”Ÿæˆï¼‰ï¼š</p>
<ul>
<li>å“åº”å¤´å¯èƒ½å« <code>x-nextjs-prerender</code>ã€<code>x-nextjs-stale-time</code> ç­‰æç¤ºï¼›è‹¥ CDN ä¸éµå¾ªæºç«™ç­–ç•¥ä¸”æ˜“è¯¯ç¼“å­˜ï¼Œå»ºè®®å¯¹å®¹æ˜“å‡ºé—®é¢˜çš„é¡µé¢å…³é—­ ISRï¼ˆåœ¨é¡µé¢å¯¼å‡º <code>revalidate = 0</code>ï¼‰ï¼Œä»…è®©æºç«™äº«å—ç¼“å­˜ï¼›å°† CDN ç¼“å­˜æ”¶ç›Šä¿ç•™ç»™é™æ€èµ„æºã€‚</li>
</ul>
</li>
<li>
<p>å›¾ç‰‡ä¼˜åŒ–ï¼š</p>
<ul>
<li>å¦‚æœå¯ç”¨ Next å›¾ç‰‡ä¼˜åŒ–ï¼ˆ<code>/_next/image/*</code>ï¼‰ï¼Œå¯ä»¥ä¸ºè¯¥ç›®å½•è®¾ç½®åˆé€‚çš„ TTLï¼›è‹¥é¡¹ç›®é…ç½®äº† <code>images.unoptimized: true</code>ï¼Œåˆ™ç›´æ¥èµ°é™æ€ç™½åå•å³å¯ã€‚</li>
</ul>
</li>
<li>
<p>ä¸­é—´ä»¶ä¸å›½é™…åŒ–é‡å®šå‘ï¼š</p>
<ul>
<li>ä¸­é—´ä»¶ <code>matcher</code> æ’é™¤äº† <code>api</code>ã€<code>_next/static</code> ç­‰è·¯å¾„ï¼Œä¸ä¼šå½±å“å†…éƒ¨ API ä¸é™æ€èµ„æºï¼›</li>
<li>å›½é™…åŒ–æŒ‰è¯­è¨€å‰ç¼€ï¼ˆ<code>/zh-cn</code>, <code>/zh-hk</code>, <code>/en-us</code>ï¼‰é‡å®šå‘çš„åœºæ™¯ï¼Œä»åº”éµå¾ªâ€œé¡µé¢ä¸ç¼“å­˜â€çš„ CDN è§„åˆ™ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-8">æœ€ç»ˆæ¸…å•ï¼ˆChecklistï¼‰</h2>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> CDNï¼šåªç¼“å­˜é™æ€åç¼€ä¸ <code>/_next/static/*</code>ï¼Œé¡µé¢ç›®å½•ä¸ç¼“å­˜ï¼Œé»˜è®¤ä¸ç¼“å­˜ã€‚</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> æºç«™ï¼šä¸­é—´ä»¶ä¸º RSC/é¢„å–è¯·æ±‚è®¾ç½® <code>Cache-Control: private, no-store</code>ã€‚</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> éƒ¨ç½²ï¼šæ›´æ–°é…ç½®å¹¶é‡å¯ï¼Œæ¸…ç† CDN ç¼“å­˜å¹¶ä»…é¢„çƒ­é™æ€èµ„æºã€‚</li>
<li class="task-list-item"><input type="checkbox" checked="checked" disabled="disabled"/> éªŒè¯ï¼šç¡®è®¤é¡µé¢è¿”å› HTMLã€é™æ€èµ„æºç¼“å­˜å‘½ä¸­ï¼Œä¸”ä¸å†å‡ºç° RSC æ–‡æœ¬ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">ç»“è¯­ä¸æé—®</h2>
<p>æœ¬æ–‡çš„è§£å†³æ–¹æ¡ˆåŸºäºâ€œCDN ä»…æ”¯æŒç›®å½•/åç¼€è§„åˆ™â€çš„ç°å®çº¦æŸï¼Œé€šè¿‡ç™½åå•ç¼“å­˜é™æ€ä¸ç¦æ­¢é¡µé¢ç¼“å­˜ï¼Œè¾…ä»¥ä¸­é—´ä»¶ <code>no-store</code> å°†é—®é¢˜æœ€å°æˆæœ¬åŒ–è§£å†³ã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„æ€è·¯ï¼ˆæ¯”å¦‚åœ¨ä¸æ”¯æŒè¯·æ±‚å¤´ç¼“å­˜é”®çš„ CDN ä¸Šï¼Œä»èƒ½ä¼˜é›…åœ°åŒºåˆ† RSC å˜ä½“ï¼‰ï¼Œæˆ–è€…é‡åˆ°è¿‡ç±»ä¼¼ä½†æ›´å¤æ‚çš„åœºæ™¯ï¼Œæ¬¢è¿äº¤æµåˆ†äº«ï¼š</p>
<ul>
<li>ä½ æ˜¯å¦ä¹Ÿé‡åˆ°è¿‡ RSC å“åº”è¢« CDN è¯¯ç¼“å­˜å¯¼è‡´é¡µé¢æ¸²æŸ“å¼‚å¸¸ï¼Ÿ</li>
<li>åœ¨ä»…æ”¯æŒç›®å½•/åç¼€è§„åˆ™çš„ CDN ä¸Šï¼Œä½ è¿˜æœ‰å“ªäº›æ›´ç¨³å¦¥æˆ–æ›´é«˜æ•ˆçš„åšæ³•ï¼Ÿ</li>
</ul>
<p>ï¼ˆæœ¬æ–‡æœªåŒ…å«ä»»ä½•çœŸå®åŸŸåæˆ–é“¾æ¥ï¼Œç¤ºä¾‹è·¯å¾„ä»…ç”¨äºè¯´æ˜ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£å‰–OkHttpï¼šé‚£äº›ä¸»æµæ•™ç¨‹æœªæ›¾æ·±å…¥çš„è®¾è®¡ç²¾é«“]]></title>    <link>https://juejin.cn/post/7571758212474404915</link>    <guid>https://juejin.cn/post/7571758212474404915</guid>    <pubDate>2025-11-13T03:42:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571758212474404915" data-draft-id="7569488854836101166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£å‰–OkHttpï¼šé‚£äº›ä¸»æµæ•™ç¨‹æœªæ›¾æ·±å…¥çš„è®¾è®¡ç²¾é«“"/> <meta itemprop="keywords" content="OKHttp,Android"/> <meta itemprop="datePublished" content="2025-11-13T03:42:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Entropless"/> <meta itemprop="url" content="https://juejin.cn/user/3518885279826078"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£å‰–OkHttpï¼šé‚£äº›ä¸»æµæ•™ç¨‹æœªæ›¾æ·±å…¥çš„è®¾è®¡ç²¾é«“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3518885279826078/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Entropless
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:42:03.000Z" title="Thu Nov 13 2025 03:42:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-cave-dark">.hljs-comment,.hljs-quote{color:#7e7887}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#be4678}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa573c}.hljs-bullet,.hljs-string,.hljs-symbol{color:#2a9292}.hljs-section,.hljs-title{color:#576ddb}.hljs-keyword,.hljs-selector-tag{color:#955ae7}.hljs-addition,.hljs-deletion{color:#19171c;display:inline-block;width:100%}.hljs-deletion{background-color:#be4678}.hljs-addition{background-color:#2a9292}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#19171c;color:#8b8792}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>OkHttp æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶ï¼Œå‡ ä¹æ¯ä¸ª Android å¼€å‘äººå‘˜åº”è¯¥éƒ½ä½¿ç”¨è¿‡å®ƒã€‚</p>
<p>æœ¬æ–‡æ·±å…¥ä»‹ç»äº† Okhttp çš„æ•´ä½“æ¡†æ¶ç»“æ„ï¼ŒOkhttpClienté‡ç‚¹å±æ€§æ·±åº¦è§£é‡Šï¼Œå¹¶ä¸”<strong>æ·±åº¦åˆ†æ</strong>äº†<strong>ä¸€æ¬¡å®Œæ•´çš„çš„ Http è¯·æ±‚åœ¨Okhttpä¸­æ˜¯å¦‚ä½•å®ç°çš„</strong>ï¼Œæˆ‘ä¸ªäººä¹ æƒ¯ç³»ç»Ÿæ€§äº†è§£ä¸€é¡¹æŠ€æœ¯è€Œä¸æ˜¯å•çº¯çš„ç½—åˆ—æºç é€šç¯‡è®²è§£ï¼Œå› ä¸ºåªæœ‰å»ºç«‹å‡ºç³»ç»Ÿï¼Œæ‰èƒ½ç†è§£çš„æ›´é€å½»ï¼Œè¿™æ ·è®°å¿†ä¼šéå¸¸æ·±åˆ»ã€‚å› æ­¤æˆ‘ä¾§é‡ä½¿ç”¨ç”»å›¾çš„æ–¹å¼æ¥åˆ†æ Okhttpï¼ˆåªæœ‰å…³é”®æºç ï¼‰ï¼Œ<strong>å›¾æ˜¯é‡ç‚¹</strong>ï¼Œæ–‡å­—æ˜¯è¾…åŠ©</p>
<p>è¿™ç¯‡æ–‡ç« åº”è¯¥æ˜¯ä½ ä»æœªè§è¿‡çš„OkHttp å…¨æµç¨‹ç½‘ç»œè¯·æ±‚çš„æ·±å…¥è§£è¯»ï¼Œå®ƒåŒæ—¶ä¹Ÿå¯èƒ½è§£æƒ‘ä½ åœ¨å…¶å®ƒåšå®¢ä¸­æ‰¾ä¸åˆ°ç­”æ¡ˆçš„ç–‘é—®ã€‚</p>
<h2 data-id="heading-1">OkHttp å‘å±•èƒŒæ™¯</h2>
<ul>
<li>
<p>è¯ç”ŸèƒŒæ™¯</p>
<p>åœ¨OkHttpå‡ºç°ä¹‹å‰ï¼ŒAndroidå¼€å‘è€…ä¸»è¦ä½¿ç”¨Apacheçš„<code>HttpClient</code>å’ŒGoogleè‡ªå®¶çš„<code>HttpURLConnection</code>è¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚ä½†è¿™ä¸¤è€…å¤šå°‘éƒ½ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚ç¾å›½çš„ç§»åŠ¨æ”¯ä»˜å…¬å¸Squareåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ·±æ„Ÿè¿™äº›åŸç”Ÿç½‘ç»œåº“éš¾ä»¥æ»¡è¶³å…¶éœ€æ±‚ï¼Œä¾¿åœ¨2013å¹´å¼€æºäº†<strong>OkHttp</strong>ã€‚</p>
</li>
<li>
<p>å‘å±•ä¹‹è·¯: <strong>ä»åŒ…è£…åˆ°æ›¿ä»£</strong></p>
<p>OkHttpå¹¶éä¸€å¼€å§‹å°±å®Œå…¨å¦èµ·ç‚‰ç¶ï¼Œå…¶å‘å±•ç»å†äº†å‡ ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>åˆæœŸåŒ…è£…</strong>ï¼šæœ€åˆï¼ŒOkHttpæ˜¯å¯¹åŸç”Ÿ<code>HttpClient</code>å’Œ<code>HttpURLConnection</code>çš„å°è£…ï¼Œæ—¨åœ¨æä¾›æ›´å‹å¥½ã€ç»Ÿä¸€çš„APIã€‚</li>
<li><strong>å‰¥ç¦»ä¸ç‹¬ç«‹</strong>ï¼šéšç€Apacheå®£å¸ƒå¼ƒç”¨<code>HttpClient</code>ï¼ŒOkHttpä¹Ÿç§»é™¤äº†å¯¹å…¶çš„æ”¯æŒã€‚åæ¥ï¼ŒSquareå›¢é˜Ÿè®¤ä¸º<code>HttpURLConnection</code>ä¹Ÿä¸å¤Ÿå¥½ç”¨ï¼Œç´¢æ€§å»æ‰äº†å¯¹å®ƒçš„ä¾èµ–ï¼Œè½¬è€Œç›´æ¥ä» Socket å±‚å®Œå…¨é‡å†™æ•´ä¸ª Http ç½‘ç»œè¯·æ±‚**ï¼Œå®ç°äº†çœŸæ­£çš„ç‹¬ç«‹ã€‚</li>
<li><strong>åå‘å½±å“</strong>ï¼šOkHttpå› å…¶å‡ºè‰²çš„è®¾è®¡å’Œæ€§èƒ½ï¼Œå—åˆ°äº†å¹¿å¤§å¼€å‘è€…çš„æ¬¢è¿ã€‚Googleä¹Ÿæ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹ï¼Œå¹¶åœ¨Android 4.4 (KitKat) ç³»ç»Ÿä¸­ï¼Œå°†<code>HttpURLConnection</code>çš„åº•å±‚å®ç°æ›¿æ¢æˆäº†OkHttp**ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿ä½ åœ¨ä»£ç ä¸­ä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„<code>HttpURLConnection</code>ï¼Œå…¶åº•å±‚å®é™…ä½¿ç”¨çš„ Okhttpçš„ä»£ç ã€‚</li>
<li><strong>å‘Kotlinè¿ˆè¿›</strong>ï¼šä»OkHttp 4ç‰ˆæœ¬å¼€å§‹ï¼ŒSquareå¼€å§‹ä½¿ç”¨Kotlinè¯­è¨€è¿›è¡Œé‡å†™</li>
</ol>
</li>
</ul>
<h2 data-id="heading-2">OkHttp æ•´ä½“æ¡†æ¶</h2>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä½¿ç”¨ Okhttp å¦‚ä½•å®Œæˆä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//okhttp ç½‘ç»œè¯·æ±‚ç¤ºä¾‹(å¼‚æ­¥)</span>
<span class="hljs-keyword">val</span> client = OkHttpClient()
<span class="hljs-keyword">val</span> request = Request.Builder()
    .url(<span class="hljs-string">""</span>)
    .build()
client.newCall(request)
    .enqueue(<span class="hljs-keyword">object</span> : Callback {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(call: <span class="hljs-type">Call</span>, e: <span class="hljs-type">IOException</span>)</span></span> {
            <span class="hljs-comment">//å¤„ç†é”™è¯¯</span>
        }
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(call: <span class="hljs-type">Call</span>, response: <span class="hljs-type">Response</span>)</span></span> {
            <span class="hljs-comment">//å¤„ç† response</span>
        }
    })
</code></pre>
<p>ä»£ç éå¸¸ç®€å•ï¼Œè¿™å¾—ç›Šäº Okhttp ä¼˜ç§€çš„æ¡†æ¶è®¾è®¡ï¼Œä»¥ä¸‹æ˜¯ä»¥ä¸€æ¬¡ç½‘ç»œè¯·æ±‚æµç¨‹çš„è§†è§’æ¥ç³»ç»Ÿçš„äº†è§£ Okhttp çš„æ•´ä½“ç»“æ„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf81327cc5f346898b226a478b80aeaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRW50cm9wbGVzcw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610909&amp;x-signature=NhAR8O2dfmDMqV9iN9VKU8rCzAg%3D" alt="OkHttpæ•´ä½“æ¡†æ¶å›¾ï¼ˆè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼‰@Entropless" loading="lazy"/></p>
<p>æ–‡å­—è¯´æ˜ï¼š</p>
<ol>
<li>
<p>é€šè¿‡ OkHttpClient.Builder æ¥æ„é€ å‡ºä¸€ä¸ª OkHttpClient å®ä¾‹ï¼ˆè¿™ä¸ªå®ä¾‹åœ¨ç»å¤§éƒ¨åˆ†åœºæ™¯éƒ½åº”è¯¥æ˜¯å•ä¾‹çš„ï¼‰,åé¢ä¼šè¯¦ç»†ä»‹ç» OkHttpClient ä¸­å„ä¸ªå±æ€§é…ç½®çš„ä½œç”¨</p>
</li>
<li>
<p>é€šè¿‡ Request.Builder æ¥æ„é€ å‡ºä¸€ä¸ª Request å®ä¾‹ï¼Œè¿™è¡¨ç¤ºä¸€ä¸ª originalRequest(åŸå§‹è¯·æ±‚)ï¼Œå¼€å‘è€…éœ€è¦é…ç½®ä¸€ä¸ªè¯·æ±‚çš„åŸºç¡€å‚æ•°</p>
</li>
<li>
<p>é€šè¿‡ newCall æ–¹æ³•ï¼ˆæºå¸¦ request å‚æ•°ï¼‰åˆ›å»ºä¸€ä¸ª Call å¯¹è±¡ï¼Œå®é™…ä¸º RealCall å®ä¾‹ï¼Œå®ƒåŒ…å«äº†ä»¥ä¸‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RealCall</span>(
  <span class="hljs-keyword">val</span> client: OkHttpClient,<span class="hljs-comment">//å¼€å‘è€…åˆ›å»ºå‡ºæ¥çš„ OkHttp Client å®ä¾‹</span>
  <span class="hljs-comment">/** ä¸€ä¸ªæœªç»é‡å®šå‘æˆ–è€…æ²¡æœ‰æ·»åŠ è®¤è¯å¤´çš„åŸå§‹è¯·æ±‚ï¼Œ
	  ä¹Ÿå°±æ˜¯æœªç»OkHttpå†…éƒ¨å¤„ç†çš„è¯·æ±‚ï¼Œå¹¶ä¸æ˜¯å®é™…å‘ç»™æœåŠ¡å™¨çš„è¯·æ±‚ 
  */</span>
  <span class="hljs-keyword">val</span> originalRequest: Request,
  <span class="hljs-keyword">val</span> forWebSocket: <span class="hljs-built_in">Boolean</span> <span class="hljs-comment">//å‘èµ·çš„æ˜¯å¦æ˜¯ä¸€ä¸ªWebSocketè¯·æ±‚ï¼Œå› ä¸ºWebSocketä¹Ÿæ˜¯åŸºäºHttpçš„åè®®</span>
) : Call {
	......
}
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åˆ›å»ºçš„è¿™ä¸ªåŸå§‹è¯·æ±‚å¯¹è±¡ï¼Œè¢«è½¬åŒ–ä¸º äº†ä¸€ä¸ª RealCallï¼Œåé¢çš„æ¯ä¸ª RealCall å°±ä»£è¡¨äº†ä¸€ä¸ªè¯·æ±‚</p>
</li>
<li>
<p>å¼€å§‹ä½¿ç”¨ execute(åŒæ­¥)/enqueue(å¼‚æ­¥)çš„æ–¹å¼å‘èµ·ä¸€ä¸ª Http è¯·æ±‚</p>
</li>
<li>
<p>enqueue æ–¹å¼ï¼š enqueue éœ€è¦ä¼ å…¥ä¸€ä¸ª callback å¯¹è±¡æ¥æ¥æ”¶è¿”å›ç»“æœï¼Œæ•´ä½“é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enqueue</span><span class="hljs-params">(responseCallback: <span class="hljs-type">Callback</span>)</span></span> {
	<span class="hljs-comment">//æ£€æŸ¥è¯·æ±‚çš„æ‰§è¡ŒçŠ¶æ€</span>
  check(executed.compareAndSet(<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)) { <span class="hljs-string">"Already Executed"</span> }
  <span class="hljs-comment">//äº‹ä»¶è®°å½•ï¼Œæ ‡è®°å¼€å§‹æ‰§è¡Œè¯·æ±‚</span>
  callStart()
  <span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªå¼‚æ­¥çš„ Callï¼Œå¹¶å…¥é˜Ÿ</span>
  client.dispatcher.enqueue(AsyncCall(responseCallback))
}
</code></pre>
<blockquote>
<p>ğŸ’¡
PS: å…³äºcheck æ–¹æ³•ï¼Œè¿™æ˜¯ Kotlin æ ‡å‡†åº“ä¸­çš„æ–¹æ³•ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨çš„æ˜¯ Kotlin Contract è¿™ä¸ªé«˜çº§ç‰¹æ€§</p>
<p>æ­¤å¤„ç®€å•ä»‹ç»ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºåœ¨ Okhttp ä¸­å¤§é‡ä½¿ç”¨åˆ°äº†å®ƒ</p>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-meta">@kotlin</span>.<span class="hljs-keyword">internal</span>.InlineOnly

<span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">check</span><span class="hljs-params">(value: <span class="hljs-type">Boolean</span>, lazyMessage: () -&gt; <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Unit</span> {

contract {

returns() implies value

}

<span class="hljs-keyword">if</span> (!value) {

<span class="hljs-keyword">val</span> message = lazyMessage()

<span class="hljs-keyword">throw</span> IllegalStateException(message.toString())

}

}

</code></pre>
<p>contract è¡¨ç¤ºå¥‘çº¦ï¼Œimplies è¡¨ç¤º æš—ç¤ºï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯ <strong>å¼€å‘è€… å‘Šè¯‰ ç¼–è¯‘å™¨</strong> å¦‚æœ check æ–¹æ³•èƒ½å¤Ÿæ­£å¸¸è¿”å›(ä¹Ÿå°±æ˜¯ä¸ä¼šæŠ›å‡ºå¼‚å¸¸)ï¼Œåˆ™æš—ç¤ºæ£€æŸ¥æˆåŠŸï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚</p>
<p>enqueue æ–¹æ³•ä¸­ check çš„ä½œç”¨å°±æ˜¯è¯·æ±‚æ‰§è¡ŒçŠ¶æ€çš„æ£€æŸ¥</p>
<ul>
<li>
<p>**<code>executed</code>**æ˜¯ä¸€ä¸ª <code>AtomicBoolean</code>ï¼Œç”¨äºæ ‡è®°è¿™ä¸ª <code>Call</code>æ˜¯å¦å·²è¢«æ‰§è¡Œè¿‡ã€‚<code>compareAndSet(false, true)</code>å°è¯•å°†å…¶å€¼ä» <code>false</code>è®¾ç½®ä¸º <code>true</code>ã€‚</p>
</li>
<li>
<p><strong><code>check</code>å‡½æ•°</strong>ï¼šå¦‚æœä¼ å…¥çš„è¡¨è¾¾å¼ç»“æœä¸º <code>false</code>ï¼ˆå³è®¾ç½®å¤±è´¥ï¼Œè¯´æ˜ <code>executed</code>å·²ç»æ˜¯ <code>true</code>ï¼Œæ„å‘³ç€è¿™ä¸ª <code>Call</code>å·²ç»è¢«æ‰§è¡Œè¿‡ï¼‰ï¼Œ<code>check</code>å‡½æ•°å°±ä¼šæŠ›å‡ºä¸€ä¸ª <code>IllegalStateException</code>ï¼Œå¼‚å¸¸ä¿¡æ¯ä¸º "Already Executed"ã€‚</p>
</li>
<li>
<p><strong>è¿™ä¿è¯äº†</strong>ä¸€ä¸ª <code>Call</code>å®ä¾‹åªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ˜¯ OkHttp é˜²æ­¢é‡å¤è¯·æ±‚çš„é‡è¦è®¾è®¡ã€‚</p>
</li>
</ul>
<p>ğŸ”‘
å…³äº Contract çš„æ›´æ·±å…¥ç†è§£ï¼Œåé¢ä¼šå•å†™ä¸€ç¯‡æ–‡ç« </p>
</blockquote>
<p>keep on :</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enqueue</span><span class="hljs-params">(call: <span class="hljs-type">AsyncCall</span>)</span></span> {
    synchronized(<span class="hljs-keyword">this</span>) {
	    <span class="hljs-comment">//å°†è¿™ä¸ªè¯·æ±‚æ·»åŠ åˆ°å‡†å¤‡æ‰§è¡Œçš„é˜Ÿåˆ—ä¸­</span>
      readyAsyncCalls.add(call)
			<span class="hljs-comment">/**ä¸‹é¢è¿™ä¸¤è¡Œä»£ç çš„æ„æ€æ˜¯ï¼šæ‰¾åˆ°ä¸å½“å‰çš„è¿™ä¸ªè¯·æ±‚ä¸»æœºåç›¸åŒçš„Call,
				ç„¶åä½¿å®ƒä»¬å…±äº«ã€ŒåŒä¸€ä¸ªä¸»æœºè¯·æ±‚ä¸ªæ•°ã€è¿™ä¸ªå˜é‡ã€‚
				ä¸ºä½•å…±äº«ï¼Ÿå› ä¸º Okhttp è¦æ±‚åŒä¸€ä¸ªä¸»æœºçš„è¯·æ±‚ä¸ªæ•°ä¸èƒ½å¤§äº5ä¸ªï¼ˆé»˜è®¤ï¼‰
			*/</span>
      <span class="hljs-keyword">if</span> (!call.call.forWebSocket) {
        <span class="hljs-keyword">val</span> existingCall = findExistingCallWithHost(call.host)
        <span class="hljs-keyword">if</span> (existingCall != <span class="hljs-literal">null</span>) call.reuseCallsPerHostFrom(existingCall)
      }
    }
    <span class="hljs-comment">//å¼€å§‹æ¨ä¸¾å¹¶æ‰§è¡Œè¯·æ±‚</span>
    promoteAndExecute()
  }
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//promote è¡¨ç¤ºæ¨åŠ¨ï¼Œæ„æ€å°±æ˜¯å¯¹readyAsyncCallsä¸­ Call è¿›è¡Œè¿›ä¸€æ­¥çš„æŒ‘é€‰ï¼Œç„¶åæ‰§è¡Œ</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">promoteAndExecute</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">this</span>.assertThreadDoesntHoldLock()
		<span class="hljs-comment">//éå† readyAsyncCalls,æŒ‘é€‰å‡ºä¸ä¼šå¯¼è‡´è¶…è´Ÿè½½çš„ Call æ¥æ·»åŠ è‡³ executableCalls</span>
		<span class="hljs-comment">//åŒæ—¶ä¹Ÿä¼šæ·»åŠ åˆ° runningAsyncCallsä¸­(runningAsyncCallsä¸­ä¹ŸåŒ…å«å·²å–æ¶ˆå•ä½†æœªæ‰§è¡Œå®Œçš„Call)</span>
		<span class="hljs-comment">//runningAsyncCalls ä¸»è¦ç”¨äºè®°å½•æ­£åœ¨è¿è¡Œçš„ Call</span>
    <span class="hljs-keyword">val</span> executableCalls = mutableListOf&lt;AsyncCall&gt;()
    <span class="hljs-keyword">val</span> isRunning: <span class="hljs-built_in">Boolean</span>
    synchronized(<span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">val</span> i = readyAsyncCalls.iterator()
      <span class="hljs-keyword">while</span> (i.hasNext()) {
        <span class="hljs-keyword">val</span> asyncCall = i.next()

        <span class="hljs-keyword">if</span> (runningAsyncCalls.size &gt;= <span class="hljs-keyword">this</span>.maxRequests) <span class="hljs-keyword">break</span> <span class="hljs-comment">// Max capacity.</span>
        <span class="hljs-keyword">if</span> (asyncCall.callsPerHost.<span class="hljs-keyword">get</span>() &gt;= <span class="hljs-keyword">this</span>.maxRequestsPerHost) <span class="hljs-keyword">continue</span> <span class="hljs-comment">// Host max capacity.</span>

        i.remove()
        asyncCall.callsPerHost.incrementAndGet()
        executableCalls.add(asyncCall)
        runningAsyncCalls.add(asyncCall)
      }
      isRunning = runningCallsCount() &gt; <span class="hljs-number">0</span>
    }
		<span class="hljs-comment">//å¼€å§‹éå† executableCalls ç„¶åæ‰§è¡Œæ¯ä¸ª AsyncCall</span>
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until executableCalls.size) {
      <span class="hljs-keyword">val</span> asyncCall = executableCalls[i]
      asyncCall.executeOn(executorService)
    }
    <span class="hljs-keyword">return</span> isRunning
  }
</code></pre>
<p>ç”±äº AsyncCall ç»§æ‰¿äº† Runnable ï¼Œå› æ­¤å®ƒè¡¨ç¤ºä¸€ä¸ªéœ€è¦æ”¾è¿›çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„å…·ä½“ä»»åŠ¡ï¼Œè¿™æ˜¯å¼‚æ­¥è¯·æ±‚çš„æ ¸å¿ƒï¼ˆæ­¤å¤„ä»…è´´å‡ºæ ¸å¿ƒä»£ç ï¼‰</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">inner</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncCall</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> responseCallback: Callback
  ) : Runnable {
    <span class="hljs-meta">@Volatile</span> <span class="hljs-keyword">var</span> callsPerHost = AtomicInteger(<span class="hljs-number">0</span>)
      <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">reuseCallsPerHostFrom</span><span class="hljs-params">(other: <span class="hljs-type">AsyncCall</span>)</span></span> {
      <span class="hljs-keyword">this</span>.callsPerHost = other.callsPerHost
    }
    ...
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">executeOn</span><span class="hljs-params">(executorService: <span class="hljs-type">ExecutorService</span>)</span></span> {
      ...
      executorService.execute(<span class="hljs-keyword">this</span>)
      ...
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> {
      ...
      <span class="hljs-comment">//è¿™æ˜¯å¼‚æ­¥ä»»åŠ¡çš„æ ¸å¿ƒï¼Œé€šè¿‡æ‹¦æˆªå™¨é“¾çš„é“¾å¼è°ƒç”¨æ–¹å¼æ‰§è¡Œä¸€ä¸ªè¯·æ±‚å¹¶è¿”å›ç»“æœ</span>
      <span class="hljs-keyword">val</span> response = getResponseWithInterceptorChain()
      ...
      <span class="hljs-comment">//æŠŠè¿”å›çš„ response ä¼ ç»™ callback</span>
      responseCallback.onResponse(<span class="hljs-keyword">this</span><span class="hljs-symbol">@RealCall</span>, response)
      ...
    }
  }
</code></pre>
</li>
</ol>
<h2 data-id="heading-3">OkHttpClientè¯¦è§£</h2>
<p>OkHttpClient ä¸­ç®¡ç†çš„æ˜¯Okhttp ç½‘ç»œè¯·æ±‚ä¸­å„ç§å‚æ•°é…ç½®ï¼Œå› æ­¤äº†è§£å®ƒé‡Œé¢çš„æ¯ä¸ªå‚æ•°å«ä¹‰åŠä½œç”¨éå¸¸é‡è¦</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> <span class="hljs-keyword">constructor</span>() {
	<span class="hljs-comment">// åŸºäºçº¿ç¨‹æ± çš„ç®¡ç†å’Œåˆ†é…è¯·æ±‚ä»»åŠ¡çš„è°ƒåº¦å™¨</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> dispatcher: Dispatcher = Dispatcher()
	<span class="hljs-comment">//è¿æ¥æ± ï¼Œè´Ÿè´£æ‰¹é‡ç®¡ç†è¿æ¥å¯¹è±¡ï¼ŒåŠŸèƒ½ï¼šæŸ¥æ‰¾ã€åˆ›å»ºã€å¤ç”¨ã€å­˜å‚¨è¿æ¥ï¼Œå®é™…å·¥ä½œå¯¹è±¡æ˜¯ RealConnectionPool</span>
	<span class="hljs-comment">//æ ¸å¿ƒæ˜¯é€šè¿‡ ConcurrentLinkedQueue å®ç°çš„</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> connectionPool: ConnectionPool = ConnectionPool()
	<span class="hljs-comment">//è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œç”¨äºæ·»åŠ è¯·æ±‚å¤´ï¼Œä¿®æ”¹ URL æ‰“å°æ—¥å¿—ç­‰</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">val</span> interceptors: MutableList&lt;Interceptor&gt; = mutableListOf()
	<span class="hljs-comment">//ç½‘ç»œæ‹¦æˆªå™¨ï¼Œä¸»è¦ç”¨äºè°ƒè¯•æœåŠ¡è¿”å›çš„åŸå§‹æ•°æ®</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">val</span> networkInterceptors: MutableList&lt;Interceptor&gt; = mutableListOf()
	<span class="hljs-comment">//ç½‘ç»œè¯·æ±‚è¿‡ç¨‹ä¸­å„ç§äº‹ä»¶çš„ç›‘å¬å™¨</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> eventListenerFactory: EventListener.Factory = EventListener.NONE.asFactory()
	<span class="hljs-comment">//è¿æ¥å¤±è´¥é‡è¯•ï¼Œé‡è¯•æŒ‡çš„æ˜¯åœ¨æœ‰å…¶å®ƒå¯è¡Œçš„è·¯çº¿ä¸‹æ‰ä¼šé‡è¯•ï¼Œæ¯”å¦‚å¤šIPä¸»æœºä¸€ä¸ªIPå¤±è´¥ä¼šé‡è¯•å…¶å®ƒçš„IPï¼Œ</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> retryOnConnectionFailure = <span class="hljs-literal">true</span>
	<span class="hljs-comment">//è®¤è¯å™¨ï¼Œå½“æœåŠ¡å™¨è¿”å›è®¤è¯å¤±è´¥ 401 or 407 æ—¶ï¼Œä¼šå›è°ƒè¿™ä¸ªè®¤è¯å™¨ï¼Œå¦‚æœéœ€è¦åˆ·æ–°Tokenåˆ™éœ€è¦é‡å†™å¹¶åœ¨å›è°ƒä¸­å¤„ç†</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> authenticator: Authenticator = Authenticator.NONE
	<span class="hljs-comment">//æ˜¯å¦é‡å®šå‘</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> followRedirects = <span class="hljs-literal">true</span>
	<span class="hljs-comment">//æ˜¯å¦å…è®¸åè®®åˆ‡æ¢çš„é‡å®šå‘ï¼ˆHttp &lt;=&gt; Httpsï¼‰</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> followSslRedirects = <span class="hljs-literal">true</span>
	<span class="hljs-comment">//cookieJarè¡¨ç¤ºcookieå­˜å‚¨å™¨,ç”¨äºåœ¨å®¢æˆ·ç«¯ä¿å­˜ä¸€äº›è¯·æ±‚çŠ¶æ€ä¿¡æ¯ï¼Œé»˜è®¤å®ç°æ˜¯ç©ºï¼Œç§»åŠ¨ç«¯ä¸€èˆ¬ä¸ä½¿ç”¨</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> cookieJar: CookieJar = CookieJar.NO_COOKIES
	<span class="hljs-comment">//æœåŠ¡ç«¯æ•°æ®çš„ç¼“å­˜</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> cache: Cache? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//åŸŸåè§£æ</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> dns: Dns = Dns.SYSTEM
	<span class="hljs-comment">//æ­£å‘ä»£ç†é…ç½®:DIRECT,HTTP,SOCKS</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> proxy: Proxy? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//ä»£ç†é€‰æ‹©å™¨ï¼Œå®ƒçš„é»˜è®¤é…ç½®æ˜¯ï¼šå½“ proxy ä¸ºç©ºæ—¶ï¼ŒProxySelectorä¼šè¿”å›NullProxySelectorï¼Œä¹Ÿå°±æ˜¯ç›´è¿</span>
	<span class="hljs-comment">//å½“ proxyä¸ä¸ºç©ºæ—¶ï¼ŒNullProxySelectorä¹Ÿä¼šè¿”å›NullProxySelectorï¼Œå› ä¸ºèµ·ä½œç”¨çš„æ˜¯proxy,ä¹Ÿå°±æ˜¯ProxySelectorå±æ€§å¤±æ•ˆ</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> proxySelector: ProxySelector? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//ä¸authenticatorç›¸åŒï¼Œå½“é…ç½®çš„ä»£ç†æœåŠ¡å™¨è¦æ±‚è®¤è¯æ—¶ä¹Ÿä¼šå›è°ƒauthenticateå‡½æ•°</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> proxyAuthenticator: Authenticator = Authenticator.NONE
	<span class="hljs-comment">//ç”¨äºåˆ›å»º Socket è¿æ¥çš„å·¥å‚ç±»</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> socketFactory: SocketFactory = SocketFactory.getDefault()
	<span class="hljs-comment">//ç”¨äºåˆ›å»º TLSè¿æ¥çš„å·¥å‚ç±»</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> sslSocketFactoryOrNull: SSLSocketFactory? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//è¯ä¹¦ç®¡ç†å™¨ï¼ŒéªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§ï¼Œx509 è¡¨ç¤ºè¯ä¹¦æ ¼å¼</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> x509TrustManagerOrNull: X509TrustManager? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//è¿æ¥è§„èŒƒï¼Œç”¨äºè®°å½•æ”¯æŒçš„TLSåè®®ç‰ˆæœ¬å’ŒåŠ å¯†å¥—ä»¶(cipherSuites)</span>
	<span class="hljs-comment">//é»˜è®¤è¿æ¥è§„èŒƒ:Httpsä½¿ç”¨MODERN_TLS(æœ€åˆé€‚çš„TLSé…ç½®)ï¼ŒHttp ä½¿ç”¨æ˜æ–‡ä¼ è¾“</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> connectionSpecs: List&lt;ConnectionSpec&gt; = DEFAULT_CONNECTION_SPECS
	<span class="hljs-comment">//æ”¯æŒçš„åè®® Http 1.0/1.1/2ï¼›SPDY(åºŸå¼ƒï¼ŒHttp2 çš„å‰èº«)ï¼›H2_PRIOR_KNOWLEDGE(HTTP2çš„æ˜æ–‡ç‰ˆ)ï¼›QUIC(HTTP3 æ²¡æœ‰å®ç°åªæä¾›æ‹¦æˆªå™¨å…¥å£)</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> protocols: List&lt;Protocol&gt; = DEFAULT_PROTOCOLS
	<span class="hljs-comment">//ä¸»æœºåéªŒè¯å™¨ï¼Œç”¨äºéªŒè¯è¯ä¹¦ä¸»æœºåä¸è¯·æ±‚ä¸­çš„ä¸»æœºåæ˜¯å¦ä¸€è‡´ï¼Œæ— ç‰¹æ®Šè¦æ±‚ä¸å¯è‡ªå®šä¹‰è¿™ä¸ªå±æ€§</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> hostnameVerifier: HostnameVerifier = OkHostnameVerifier
	<span class="hljs-comment">//è¯ä¹¦å›ºå®šå™¨ï¼Œé€šè¿‡ç¡¬ç¼–ç æ–¹å¼å°†è¯ä¹¦å›ºå®šï¼Œä¹Ÿå°±æ˜¯é™¤äº†éªŒè¯è¯ä¹¦åˆæ³•æ€§ä¹‹å¤–ï¼Œè¿˜éœ€è¦ç¡®å®šæ˜¯æŒ‡å®šçš„é‚£ä¸ªè¯ä¹¦</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> certificatePinner: CertificatePinner = CertificatePinner.DEFAULT
	<span class="hljs-comment">//è¯ä¹¦é“¾æ¸…ç†å‘˜ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š1.æ“ä½œX509TrustManager è¿”å›è¯ä¹¦é“¾åˆ—è¡¨ 2. æ¸…ç†ä¸TLSæ¡æ‰‹æ— å…³çš„è¯ä¹¦</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> certificateChainCleaner: CertificateChainCleaner? = <span class="hljs-literal">null</span>
	<span class="hljs-comment">//æ•´ä¸ªè°ƒç”¨å‘¨æœŸçš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸é™åˆ¶ï¼Œä½†å†…éƒ¨çš„è¿æ¥ï¼Œè¯»å†™æœ‰è¶…æ—¶é™åˆ¶</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> callTimeout = <span class="hljs-number">0</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> connectTimeout = <span class="hljs-number">10_000</span><span class="hljs-comment">//è¿æ¥è¶…æ—¶</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> readTimeout = <span class="hljs-number">10_000</span><span class="hljs-comment">//è¯»è¶…æ—¶</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> writeTimeout = <span class="hljs-number">10_000</span><span class="hljs-comment">//å†™è¶…æ—¶</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> pingInterval = <span class="hljs-number">0</span><span class="hljs-comment">//http2 å’Œ websocket çš„å¿ƒè·³é—´éš”</span>
	<span class="hljs-comment">//websocket ä¸­è¢«å‹ç¼©çš„æœ€å°çš„æ¶ˆæ¯å¤§å°ï¼Œé»˜è®¤ 1024ï¼Œå³å½“æ¶ˆæ¯&gt;=1024æ—¶ä¼šè¢«å‹ç¼©</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> minWebSocketMessageToCompress = RealWebSocket.DEFAULT_MINIMUM_DEFLATE_SIZE
	<span class="hljs-comment">//è·¯ç”±æ•°æ®åº“ï¼Œç”¨äºè®°å½•æœ‰æ•…éšœçš„è·¯ç”±ï¼Œä¾¿äºå¯»æ‰¾å¤‡ç”¨è·¯ç”±</span>
	<span class="hljs-keyword">internal</span> <span class="hljs-keyword">var</span> routeDatabase: RouteDatabase? = <span class="hljs-literal">null</span>
	
}
</code></pre>
<p>é‡ç‚¹è¯´æ˜çš„å‡ ä¸ªå±æ€§ï¼š</p>
<ul>
<li>
<p><code>connectionPool</code></p>
<p>è¿æ¥æ± çš„åŸç†ï¼š</p>
<p>RealConnectionPoolæ˜¯å®é™…çš„è¿æ¥æ± ç®¡ç†ç±»ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨
<code>ConcurrentLinkedQueue&lt;RealConnection&gt;</code> çš„æ¥å­˜å‚¨è¿æ¥å¯¹è±¡ï¼Œè¿™è¡¨æ˜å¯¹äºè¿æ¥æ± çš„<strong>å•ä¸ªæ“ä½œ</strong>æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿æ¥æ± è´Ÿè´£ OkHttpClient å®ä¾‹æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…TCP è¿æ¥çš„æŸ¥æ‰¾ã€å¤ç”¨ã€åˆ›å»ºã€å­˜å‚¨ã€æ¸…ç†ç­‰å·¥ä½œ</p>
<blockquote>
<p>PS : <code>ConcurrentLinkedQueue</code> åªèƒ½ä¿è¯å¤šçº¿ç¨‹æ“ä½œä¸­å¯¹å®ƒçš„å•ä¸ªæ“ä½œæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœæ˜¯å¤åˆæ“ä½œä»ç„¶éœ€è¦åŠ é”ï¼Œè¿™æ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­è¦æ³¨æ„çš„ç‚¹ï¼ŒOkHttp æºç æ³¨é‡Šä¸­ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
* Holding the lock of the connection being added or removed when mutating this, and check its
* [RealConnection.noNewExchanges] property. This defends against races where a connection is
* simultaneously adopted and removed.
*/</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> connections = ConcurrentLinkedQueue&lt;RealConnection&gt;()
</code></pre>
</blockquote>
<p>å…¶ä¸­ OkHttp çš„è¿æ¥å¤ç”¨æœºåˆ¶æ˜¯ä½“ç° OkHttp æ€§èƒ½çš„é‡ç‚¹æŠ€æœ¯ï¼Œå®ƒçš„å¤ç”¨é€»è¾‘ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>å¯¹äº Http1.1 ï¼Œç”±äº Http 1.1 å¼€å§‹æ”¯æŒ <code>Keep-Alive</code> ï¼Œå› æ­¤ä¸€ä¸ªå½“ä¸€ä¸ª Http è¯·æ±‚ç»“æŸæ—¶ï¼ŒTCP è¿æ¥å¹¶ä¸ä¼šç«‹å³é‡Šæ”¾ï¼Œå¦‚æœæœ‰æ–°çš„è¯·æ±‚å‘èµ·ï¼Œä¼šç»è¿‡ä¸€ç³»åˆ—æ¡ä»¶åˆ¤æ–­æ˜¯å¦å¯ä»¥å¤ç”¨å·²æœ‰çš„è¿æ¥ï¼Œå¦‚æœç¬¦åˆå¤ç”¨æ¡ä»¶ï¼Œè¿™æ ·å°±å‡å°‘äº†ä¸€æ¬¡ TCP çš„æ¡æ‰‹åŠ¨ä½œï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†è¿æ¥å¯¹è±¡çš„åˆ›å»ºï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ã€‚</li>
<li>å¯¹äº Http2ï¼Œç”±äº Http2 æ”¯æŒMultiplexingï¼ˆå¤šè·¯å¤ç”¨ï¼‰ï¼Œä¹Ÿå°±æ˜¯Http2æ”¯æŒåœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸ŠåŒæ—¶å¯ä»¥å‘èµ·å¤šä¸ª Http è¯·æ±‚ï¼Œè¿™æ ·æ–°è¯·æ±‚ä¹Ÿå¯ä»¥å¤ç”¨ç¬¦åˆæ¡ä»¶çš„TCP è¿æ¥ï¼Œå¹¶ä¸”ä¸éœ€è¦ç­‰å¾…è¿æ¥ç©ºé—²(ä¸è¶…è´Ÿè½½)</li>
</ol>
</li>
<li>
<p><code>followRedirects</code> ä¸ <code>followSslRedirects</code> çš„å…³ç³»</p>
<p><code>followRedirects</code> è¡¨ç¤ºæ˜¯å¦å…è®¸é‡å®šå‘ï¼Œé»˜è®¤å€¼æ˜¯ <code>true</code>, <code>followSslRedirects</code> è¡¨ç¤ºåœ¨<code>followRedirects=true</code> çš„å‰æä¸‹ï¼Œæ˜¯å¦å…è®¸è¿›è¡Œåè®®åˆ‡æ¢ï¼ˆHttp â†” Httpsï¼‰çš„é‡å®šå‘ï¼Œé»˜è®¤å€¼ä¹Ÿæ˜¯ trueï¼Œä½†æ˜¯åœ¨ä¸€äº›é«˜å®‰å…¨åœºæ™¯è¦æ±‚ä¸‹ï¼Œéœ€è¦å°† <code>followSslRedirects</code> è®¾ç½®ä¸º falseï¼Œä»¥é˜²æ­¢åè®®æ”»å‡»</p>
</li>
<li>
<p><code>certificatePinner</code></p>
<p>è¯ä¹¦å›ºå®šå™¨ï¼Œé€šè¿‡ç¡¬ç¼–ç æ–¹å¼å°†è¯ä¹¦çš„å“ˆå¸Œä¿¡æ¯å›ºå®šï¼Œä¹Ÿå°±æ˜¯é™¤äº†éªŒè¯è¯ä¹¦åˆæ³•æ€§ä¹‹å¤–ï¼Œè¿˜éœ€è¦ç¡®å®šæ˜¯æŒ‡å®šçš„é‚£ä¸ªè¯ä¹¦ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½é€šè¿‡éªŒè¯</p>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//1. å…ˆä½¿ç”¨é”™è¯¯çš„å“ˆå¸Œå€¼æµ‹è¯•ä¸€ä¸‹ï¼ŒæŠŠæœåŠ¡å™¨è¯ä¹¦æ­£ç¡®çš„å“ˆå¸Œå€¼æ‰“å°å‡ºæ¥</span>
<span class="hljs-type">String</span> <span class="hljs-variable">hostname</span> <span class="hljs-operator">=</span> <span class="hljs-string">"publicobject. com"</span>; 
<span class="hljs-type">CertificatePinner</span> <span class="hljs-variable">certificatePinner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CertificatePinner</span>.Builder()     
	.add(hostname, <span class="hljs-string">"sha256/ AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="</span>)     
	.build(); 
<span class="hljs-type">OkHttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> OkHttpClient. Builder()     
	.certificatePinner(certificatePinner)     
	.build();
<span class="hljs-type">Request</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>. Builder()     
	.url(<span class="hljs-string">"https://"</span> + hostname)     
	.build(); 
client.newCall(request).execute();
<span class="hljs-comment">//2.æ‰“å°å‡ºæ­£ç¡®å“ˆå¸Œå€¼</span>
<span class="hljs-comment">//3.å†æŠŠæ­£ç¡®çš„å“ˆå¸Œå€¼æ›¿æ¢è¿‡å»</span>
</code></pre>
<blockquote>
<p>âš ï¸æ³¨æ„ï¼šä½¿ç”¨å®ƒæ¯”è¾ƒå±é™©ï¼Œå¦‚æœæœåŠ¡å™¨è¯ä¹¦æ›´æ¢äº†ï¼Œå¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯æ— æ³•ä½¿ç”¨ï¼Œå› ä¸ºç”±äºæ˜¯ç¡¬ç¼–ç äº†è¯ä¹¦å“ˆå¸Œï¼Œ
æ‰€ä»¥æ— æ³•è®¿é—®æœåŠ¡å™¨äº†</p>
</blockquote>
<blockquote>
<p>PS: CertificatePinner ä¹Ÿå¯ä»¥ç”¨äºé˜²æ­¢é‚£äº›åŸºäº VPN çš„æŠ“åŒ…è½¯ä»¶(å¦‚ Drony)ï¼Œå› ä¸ºæŠ“åŒ…è½¯ä»¶ åŸç†æ˜¯è®©ç”¨æˆ·ä¸»åŠ¨ä¿¡ä»»è¯ä¹¦ï¼Œå¦‚æœå›ºå®šäº†è¯ä¹¦ç­¾åï¼Œä¹Ÿå°±æ— æ³•é€šè¿‡å®ƒä»¬ç›´æ¥æŠ“åŒ…äº†</p>
</blockquote>
</li>
<li>
<p><code>pingInterval</code></p>
<p>Qï¼šä¸ºä»€ä¹ˆH2 &amp; ws åè®®æ‰éœ€è¦å¿ƒè·³é—´éš”ï¼ŒHttp1.1 ä¹Ÿæ˜¯é•¿è¿æ¥ï¼Œä¸ºä»€ä¹ˆä¸éœ€è¦ï¼Ÿ</p>
<p>Aï¼šå› ä¸º Http1.1 ä¸­çš„è¯·æ±‚æ˜¯å•ä¸ªæ‰§è¡Œçš„ï¼ŒåŒä¸€ä¸ª TCP è¿æ¥ä¸Šä¸¤ä¸ªè¯·æ±‚ä¹‹é—´çš„é—´éš”æ—¶é—´è¶…è¿‡é™åˆ¶ï¼Œè¿æ¥å…è®¸è¢«é‡Šæ”¾ï¼Œä½†åœ¨H2 ä¸­ç”±äºå¤šä¸ªè¯·æ±‚æ˜¯å¹¶è¡Œçš„ï¼ŒTCP é•¿è¿æ¥ç»´æŒæ—¶é—´éœ€è¦æ›´ä¹…</p>
</li>
</ul>
<h2 data-id="heading-4">OkHttp ç½‘ç»œè¯·æ±‚å…¨è¿‡ç¨‹æ·±åº¦è§£æ„</h2>
<h3 data-id="heading-5">okhttpæ‹¦æˆªå™¨è¿è¡ŒåŸç†</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯·æ±‚è¿‡ç¨‹ä¸­æ‹¦æˆªå™¨çš„è¿è¡Œæœºåˆ¶ï¼Œç”¨æ—¶åºå›¾çš„æ–¹å¼è§£é‡Šæ‹¦æˆªå™¨åŸç†ï¼Œä¸€ç›®äº†ç„¶ï¼Œè¿‡ç›®ä¸å¿˜ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63bbc9ef2b1947bcbaf1184c052bc081~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRW50cm9wbGVzcw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610909&amp;x-signature=q4wpH3FQ%2B4mrQGvPhv0XHDSeVxo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">æ‹¦æˆªå™¨è¿è¡ŒåŸç†è¯¦è§£</h3>
<ul>
<li>
<p>RealInterceptorChain</p>
<p>å®ƒæ˜¯ç®¡ç†æ‰€æœ‰æ‹¦æˆªå™¨çš„çš„ç±»ï¼Œé“¾å¼è°ƒç”¨å°±æ˜¯ç”±å®ƒå®ç°çš„ï¼Œ<code>getResponseWithInterceptorChain</code> æ˜¯æ‹¦æˆªå™¨è¿è¡Œçš„æ ¸å¿ƒæ–¹æ³•ï¼Œå†…éƒ¨å°†æ‰€æœ‰çš„æ‹¦æˆªå™¨éƒ½æ”¾åœ¨äº†ä¸€ä¸ª list ä¸­ï¼Œç„¶ååˆå§‹åŒ–äº†<code>RealInterceptorChain</code>çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶å°†æ‹¦æˆªå™¨åˆ—è¡¨æ·»åŠ è¿›å»ï¼Œæœ€åé€šè¿‡ <code>chain.proceed(originalRequest)</code>  æ–¹æ³•ä¼ å…¥åŸå§‹è¯·æ±‚ï¼Œå¯åŠ¨è¿™ä¸ªé“¾æ¡ï¼Œç„¶åç»è¿‡æ‹¦æˆªå™¨å¯¹è¿™ä¸ª <code>originalRequest</code>çš„å±‚å±‚å¤„ç†ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‘å¾€æœåŠ¡å™¨çš„targetRequest</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Throws(IOException::class)</span>
internal fun <span class="hljs-title function_">getResponseWithInterceptorChain</span><span class="hljs-params">()</span>: Response {
  <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„æ‹¦æˆªå™¨å †æ ˆ</span>
  <span class="hljs-type">val</span> <span class="hljs-variable">interceptors</span> <span class="hljs-operator">=</span> mutableListOf&lt;Interceptor&gt;()
  interceptors += client.interceptors
  interceptors += RetryAndFollowUpInterceptor(client)
  interceptors += BridgeInterceptor(client.cookieJar)
  interceptors += CacheInterceptor(client.cache)
  interceptors += ConnectInterceptor
  <span class="hljs-title function_">if</span> <span class="hljs-params">(!forWebSocket)</span> {
    interceptors += client.networkInterceptors
  }
  interceptors += CallServerInterceptor(forWebSocket)

  <span class="hljs-type">val</span> <span class="hljs-variable">chain</span> <span class="hljs-operator">=</span> RealInterceptorChain(
      call = <span class="hljs-built_in">this</span>,
      interceptors = interceptors,<span class="hljs-comment">//å°†æ‹¦æˆªå™¨åˆ—è¡¨æ·»åŠ åˆ°æ‹¦æˆªå™¨é“¾</span>
      index = <span class="hljs-number">0</span>,
      exchange = <span class="hljs-literal">null</span>,
      request = originalRequest,
      connectTimeoutMillis = client.connectTimeoutMillis,
      readTimeoutMillis = client.readTimeoutMillis,
      writeTimeoutMillis = client.writeTimeoutMillis
  )

  <span class="hljs-type">var</span> <span class="hljs-variable">calledNoMoreExchanges</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
  <span class="hljs-keyword">try</span> {
	  <span class="hljs-comment">//å¯åŠ¨æ‹¦æˆªå™¨é“¾</span>
    <span class="hljs-type">val</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chain.proceed(originalRequest)
    <span class="hljs-keyword">if</span> (isCanceled()) {
      response.closeQuietly()
      <span class="hljs-keyword">throw</span> IOException(<span class="hljs-string">"Canceled"</span>)
    }
    <span class="hljs-keyword">return</span> response
  } <span class="hljs-keyword">catch</span> (e: IOException) {
    calledNoMoreExchanges = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">throw</span> noMoreExchanges(e) as Throwable
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-keyword">if</span> (!calledNoMoreExchanges) {
      noMoreExchanges(<span class="hljs-literal">null</span>)
    }
  }
}
</code></pre>
<p>é¦–æ¬¡æ‰§è¡Œproceed æ–¹æ³•æ—¶ï¼Œä»ä¼ å…¥çš„ interceptors ä¸­æ‹¿åˆ° index = 0çš„ Interceptorï¼Œç„¶åè°ƒç”¨å®ƒçš„ <code>intercept</code>æ–¹æ³•æ‰§è¡Œç¬¬ä¸€ä¸ªæ‹¦æˆªå™¨ï¼ŒåŒæ—¶å°†index + 1 ï¼Œcopy å‡ºä¸€ä¸ªæ–°çš„ RealInterceptorChainï¼Œä¼ å…¥ intercept æ–¹æ³•ä¸­ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæ¨åŠ¨æ•´ä¸ªé“¾æ¡è¿ç»­æ‰§è¡Œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Throws(IOException::class)</span>
  override fun <span class="hljs-title function_">proceed</span><span class="hljs-params">(request: Request)</span>: Response {
    check(index &lt; interceptors.size)

    calls++

    <span class="hljs-keyword">if</span> (exchange != <span class="hljs-literal">null</span>) {
      check(exchange.finder.sameHostAndPort(request.url)) {
        <span class="hljs-string">"network interceptor ${interceptors[index - 1]} must retain the same host and port"</span>
      }
      check(calls == <span class="hljs-number">1</span>) {
        <span class="hljs-string">"network interceptor ${interceptors[index - 1]} must call proceed() exactly once"</span>
      }
    }

    <span class="hljs-comment">//å°† index+1 å¹¶æ‹·è´ä¸€ä¸ªæ–°çš„ RealInterceptorChain å¯¹è±¡</span>
    <span class="hljs-type">val</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> copy(index = index + <span class="hljs-number">1</span>, request = request)
    <span class="hljs-comment">//æ‰¾åˆ°å½“å‰éœ€è¦æ‰§è¡Œçš„æ‹¦æˆªå™¨å¯¹è±¡</span>
    <span class="hljs-type">val</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> interceptors[index]

    <span class="hljs-meta">@Suppress("USELESS_ELVIS")</span>
    <span class="hljs-type">val</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> interceptor.intercept(next) ?: <span class="hljs-keyword">throw</span> NullPointerException(
        <span class="hljs-string">"interceptor $interceptor returned null"</span>)

    <span class="hljs-keyword">if</span> (exchange != <span class="hljs-literal">null</span>) {
      check(index + <span class="hljs-number">1</span> &gt;= interceptors.size || next.calls == <span class="hljs-number">1</span>) {
        <span class="hljs-string">"network interceptor $interceptor must call proceed() exactly once"</span>
      }
    }

    check(response.body != <span class="hljs-literal">null</span>) { <span class="hljs-string">"interceptor $interceptor returned a response with no body"</span> }

    <span class="hljs-keyword">return</span> response
  }
</code></pre>
</li>
<li>
<p>æ‹¦æˆªå™¨å®ä¾‹ï¼šæ¯ä¸ªæ‹¦æˆªå™¨å®ä¾‹å¯ä»¥åˆ†ä¸ºä¸‰éƒ¨åˆ†å·¥ä½œ</p>
<ul>
<li>Before Proceedï¼šè¿™æ˜¯æ‹¦æˆªå™¨å¯¹<strong>è¯·æ±‚</strong>è¿›è¡Œå¤„ç†çš„é˜¶æ®µã€‚æ¯ä¸ªæ‹¦æˆªå™¨åœ¨è°ƒç”¨ <code>chain.proceed(request)</code>æ–¹æ³•å°†è¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ä¹‹å‰ï¼Œä¼šæ‰§è¡Œè‡ªå·±ä¸“å±çš„ä»»åŠ¡ã€‚è¿™é€šå¸¸åŒ…æ‹¬å¯¹è¯·æ±‚çš„ä¿®æ”¹æˆ–å¢å¼º</li>
<li>Call Proceedï¼šè¿™æ˜¯è´£ä»»é“¾çš„<strong>æ¨åŠ¨ç¯èŠ‚</strong>ã€‚é€šè¿‡è°ƒç”¨ <code>chain.proceed(request)</code>ï¼Œå½“å‰æ‹¦æˆªå™¨å°†è¯·æ±‚æ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¹¶ç­‰å¾…å…¶è¿”å›<strong>å“åº”</strong>ã€‚è¿™ä¸ªè°ƒç”¨æ˜¯æ‹¦æˆªå™¨é“¾æ‰§è¡Œçš„æ¢çº½ ã€‚</li>
<li>After Proceedï¼šå½“ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨è¿”å›å“åº”åï¼Œå½“å‰æ‹¦æˆªå™¨å¯¹<strong>å“åº”</strong>è¿›è¡Œå¤„ç†çš„é˜¶æ®µã€‚æ‹¦æˆªå™¨å¯ä»¥æ£€æŸ¥ã€ä¿®æ”¹ç”šè‡³å®Œå…¨æ›¿æ¢è¿”å›çš„å“åº”æ•°æ®ï¼Œç„¶åå†å°†å…¶è¿”å›ç»™ä¸Šä¸€ä¸ªæ‹¦æˆªå™¨ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-7">æ‹¦æˆªå™¨æ‹†è§£åˆ†æ</h3>
<ul>
<li>
<p>RetryAndFollowupInterceptor</p>
<p>é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥é‡è¯•å’Œé‡å®šå‘çš„æ‹¦æˆªå™¨ï¼Œå‰ç½®å·¥ä½œä¸»è¦æ˜¯åˆå§‹åŒ–ä¸€ä¸ª <code>ExchangeFinder</code> å®ä¾‹ï¼Œç”¨äºåç»­æŸ¥æ‰¾å¯ç”¨çš„ TCP è¿æ¥ï¼Œåç½®å·¥ä½œæ˜¯åˆ¤æ–­æ˜¯å¦æœ‰é”™è¯¯æˆ–è€…æ˜¯å¦éœ€è¦é‡å®šå‘</p>
</li>
<li>
<p>BridgeInterceptor</p>
<p>å¾ˆç®€å•ï¼ŒBridge æ˜¯æ¡¥ï¼Œè¡¨ç¤ºè¿™æ˜¯åŸå§‹è¯·æ±‚ä¸å®é™…è¯·æ±‚æ¡¥æ¥çš„æ‹¦æˆªå™¨ï¼Œå‰ç½®å·¥ä½œæ˜¯ç”¨äºè¡¥å…¨å„ç§è¯·æ±‚å¤´ï¼Œå…¶ä¸­ä¼šé»˜è®¤æ·»åŠ è¦æ±‚æœåŠ¡å™¨å¯¹ è¿”å›å†…å®¹è¿›è¡Œ gzip å‹ç¼©çš„è¯·æ±‚å¤´ï¼›åç½®å·¥ä½œæ˜¯å¯¹å“åº”å¤´åšå¤„ç†ï¼ŒåŒ…æ‹¬è§£å‹ç¼©å“åº”å†…å®¹</p>
</li>
<li>
<p>CacheInterceptor</p>
<p>å‰ç½®å·¥ä½œï¼šé¦–å…ˆæŸ¥çœ‹æœ‰æ²¡æœ‰æœ¬åœ°ç¼“å­˜ï¼Œæœ‰åˆ™æŸ¥çœ‹æ˜¯å¦è¿‡æœŸ(æ ¹æ® Expires/max-age) , å¦‚æœæ²¡æœ‰è¿‡æœŸå¹¶ä¸”å¯ç”¨ï¼Œåˆ™ç›´æ¥è¿”å›ä¸å†æ‰§è¡Œåç»­çš„æ‹¦æˆªå™¨ï¼Œå¦‚æœæ²¡æœ‰æˆ–è€…è¿‡æœŸå°±æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ã€‚
åç½®å·¥ä½œï¼šå¦‚æœæœåŠ¡ç«¯è¿”å›çš„æ˜¯304(æœåŠ¡å™¨æ ¹æ® Etag æˆ–è€… Last-Modified) è¡¨ç¤ºä¹‹å‰ç¼“å­˜çš„æœ¬åœ°è¯·æ±‚ä¾ç„¶æœ‰æ•ˆå¯ä»¥ä½¿ç”¨ï¼Œæˆ–è€…åˆ¤æ–­æ˜¯å¦éœ€è¦ç¼“å­˜æ–°çš„è¯·æ±‚ä¿¡æ¯</p>
</li>
<li>
<p>ConnectInterceptor</p>
<p>è¿™æ˜¯å®é™…æŸ¥æ‰¾å’Œå»ºç«‹ TCP è¿æ¥çš„æ‹¦æˆªå™¨
å‰ç½®å·¥ä½œå°±æ˜¯ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„ExchangeFinder æ¥æŸ¥æ‰¾è¿æ¥æ± ä¸­æ˜¯å¦æœ‰å¯ç”¨è¿æ¥(æ²¡æœ‰åç½®å·¥ä½œ)ï¼š</p>
<ul>
<li>
<p>å¯¹äºå…¨æ–°è¯·æ±‚(æœªé‡å®šå‘æˆ–é‡è¯•)ï¼š</p>
</li>
</ul>
<ol>
<li>
<p>ç”±äºæ¯ä¸ª Call éƒ½å…³è”äº†ä¸€ä¸ªè¿æ¥å¯¹è±¡ï¼Œæ‰€ä»¥å…ˆå°è¯•é‡ç”¨è¿™ä¸ªè¿æ¥ï¼Œç”±äºæ˜¯å…¨æ–°è¯·æ±‚ï¼Œå› æ­¤è‚¯å®šæ˜¯ null</p>
</li>
<li>
<p>ç„¶åä»¥æœ€å¿«çš„é€Ÿåº¦åœ¨è¿æ¥æ± ä¸­æŸ¥æ‰¾ä¸‹æœ‰æ²¡æœ‰å¯ç”¨è¿æ¥(ä¸ä½¿ç”¨ Route)ï¼Œä¸ä½¿ç”¨ Route è¡¨ç¤ºåªéœ€è¦è¿æ¥æ²¡æœ‰è¶…è¿‡è´Ÿè½½ï¼Œå¹¶ä¸”Address ä¸­çš„æ‰€æœ‰é…ç½®ä¸€è‡´ï¼ˆåŒ…æ‹¬Hostã€portã€proxyã€protocolã€è¯ä¹¦ç­‰ç­‰ï¼‰å°±å¯é‡ç”¨ï¼Œ<code>requireMultiplexed=false</code> è¡¨ç¤ºhttp1.1å’Œ Http2éƒ½åŒ…æ‹¬</p>
</li>
<li>
<p>å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£å°±é€šè¿‡ Route æ¥æ·±åº¦æŸ¥æ‰¾ï¼ŒOkHttpé€šè¿‡è§£æ DNS æ¥è·å–åˆ° IP åœ°å€åˆ—è¡¨(List)ï¼Œè¿™æ¬¡æŸ¥æ‰¾çš„ç›®çš„æ˜¯æ‰¾åˆ°å¯ä»¥æ”¯æŒcoalescing(è¿æ¥åˆå¹¶) çš„è¿æ¥ï¼Œè¿™æ¬¡<code>requireMultiplexed</code> ä¾ç„¶æ˜¯ false</p>
</li>
<li>
<p>å¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œé‚£å°±åªèƒ½æ–°å»ºä¸€ä¸ª TCP è¿æ¥</p>
</li>
<li>
<p>åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯èƒ½æœ‰å¤šä¸ªè¯·æ±‚åœ¨æçŸ­æ—¶é—´å†…åŒæ—¶å‘èµ·ï¼Œå¹¶ä¸”åŒæ—¶åˆ›å»ºäº†æ–°çš„è¿æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹å¦‚æœéƒ½æ˜¯ Http2çš„è¯·æ±‚ï¼Œé‚£è¿™ä¸¤ä¸ªè¯·æ±‚å¯ä»¥åˆå¹¶æ”¾åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸­æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥çœå»ä¸€ä¸ªè¿æ¥ï¼Œå› æ­¤ï¼Œéœ€è¦å†æ¬¡æŸ¥æ‰¾ä¸€éï¼Œè¿™æ¬¡è¦æ±‚<code>requireMultiplexed=true</code> ,ä¹Ÿå°±æ˜¯åªæŸ¥æ‰¾Http2 çš„è¿æ¥</p>
</li>
</ol>
<ul>
<li>
<p>å¯¹äºé‡å®šå‘æˆ–è€…é‡è¯•çš„è¿æ¥</p>
<p>ç”±äº Call ä¸­å¯èƒ½å·²ç»æœ‰äº†ä¸€ä¸ªè¿æ¥ï¼Œå› æ­¤å…ˆæ£€æŸ¥ä¸‹æ˜¯å¦å¯ä»¥é‡ç”¨ï¼Œåç»­æ­¥éª¤ä¸ğŸ‘†ä¸€è‡´</p>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯findConnection å‡½æ•°çš„ä»£ç ï¼ˆä»…å±•ç¤ºæ ¸å¿ƒä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findConnection</span><span class="hljs-params">(...)</span></span>: RealConnection {
    <span class="hljs-comment">// ... å‚æ•°å’Œåˆå§‹æ£€æŸ¥å·²çœç•¥ ...</span>

    <span class="hljs-comment">// 1. å°è¯•å¤ç”¨å½“å‰è¯·æ±‚ä¸­å·²æœ‰çš„è¿æ¥(å¦‚æœæ˜¯é‡è¯•æˆ–è€…é‡å®šå‘çš„è¯·æ±‚)</span>
    <span class="hljs-keyword">val</span> callConnection = call.connection
    <span class="hljs-keyword">if</span> (callConnection != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-comment">/* ... å¤ç”¨æ¡ä»¶æ£€æŸ¥ ... */</span>) {
        <span class="hljs-keyword">return</span> callConnection <span class="hljs-comment">// å¤ç”¨æˆåŠŸ</span>
    }

    <span class="hljs-comment">// 2. å°è¯•ä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªå¯ç”¨è¿æ¥ï¼ˆHttp1.1 æˆ–è€… Http2çš„è¿æ¥ä½†ä¸ä¼šæ‹¿åˆ°**coalescing** çš„è¿æ¥ï¼‰</span>
    <span class="hljs-keyword">if</span> (connectionPool.callAcquirePooledConnection(address, call, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>)) {
        <span class="hljs-keyword">return</span> call.connection!!
    }

    <span class="hljs-comment">// 3. è¿›è¡Œè·¯ç”±é€‰æ‹©</span>
    <span class="hljs-comment">// ... è·¯ç”±é€‰æ‹©é€»è¾‘ï¼ˆå¯èƒ½é˜»å¡ï¼‰...</span>
    <span class="hljs-keyword">val</span> route = <span class="hljs-comment">// ... ç¡®å®šæœ€ç»ˆè¦å°è¯•çš„è·¯çº¿ (Route) ...</span>

    <span class="hljs-comment">// 4. å‰ä¸¤ç§æ–¹å¼éƒ½å¤±è´¥ï¼Œå°±åˆ›å»ºæ–°çš„ TCP è¿æ¥</span>
    <span class="hljs-keyword">val</span> newConnection = RealConnection(connectionPool, route)
    newConnection.connect(...) <span class="hljs-comment">// å…³é”®çš„è¿æ¥å»ºç«‹è¿‡ç¨‹</span>

    <span class="hljs-comment">// 5. è¿æ¥å»ºç«‹åï¼Œé’ˆå¯¹ç‰¹æ®Šç«äº‰çŠ¶æ€ï¼Œå†æ¬¡å°è¯•æŸ¥è¯¢ä¸€æ¬¡è¿æ¥æ± ï¼ˆè¿æ¥åˆå¹¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (!connectionPool.callAcquirePooledConnection(address, call, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>)) {
        connectionPool.put(newConnection) <span class="hljs-comment">// å°†æ–°è¿æ¥æ”¾å…¥æ± ä¸­</span>
        call.acquireConnectionNoEvents(newConnection)
    }

    <span class="hljs-keyword">return</span> call.connection ?: newConnection
}
</code></pre>
<p>ä»¥ä¸Šæ˜¯ OKHttp çš„è¿æ¥æ± æ ¸å¿ƒæœºåˆ¶çš„ä»‹ç»ï¼Œå®ƒç¡®ä¿äº†è¿æ¥å¤ç”¨æ•ˆç‡çš„æœ€å¤§åŒ–ï¼</p>
<p>å…¶ä¸­ä»è¿æ¥æ± è·å–è¿æ¥çš„æ ¸å¿ƒæ–¹æ³•æ˜¯ <code>connectionPool.callAcquirePooledConnection</code></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">callAcquirePooledConnection</span><span class="hljs-params">(
  address: <span class="hljs-type">Address</span>,
  call: <span class="hljs-type">RealCall</span>,
  routes: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Route</span>&gt;?,
  requireMultiplexed: <span class="hljs-type">Boolean</span>
)</span></span>: <span class="hljs-built_in">Boolean</span> {
  <span class="hljs-keyword">for</span> (connection <span class="hljs-keyword">in</span> connections) {
    synchronized(connection) {
	    <span class="hljs-comment">//å¸Œæœ›æŸ¥æ‰¾å¤šè·¯å¤ç”¨è¿æ¥ä½†è¿™ä¸ªè¿æ¥ä¸æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œå°±æ”¾å¼ƒæ‰</span>
      <span class="hljs-keyword">if</span> (requireMultiplexed &amp;&amp; !connection.isMultiplexed) <span class="hljs-keyword">return</span><span class="hljs-symbol">@synchronized</span>
      <span class="hljs-comment">//è¿™ä¸ªè¿æ¥æ˜¯å¯ç”¨çš„</span>
      <span class="hljs-keyword">if</span> (!connection.isEligible(address, routes)) <span class="hljs-keyword">return</span><span class="hljs-symbol">@synchronized</span>
      <span class="hljs-comment">//è·å¾—è¿™ä¸ªç¬¦åˆè¦æ±‚çš„è¿æ¥</span>
      call.acquireConnectionNoEvents(connection)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
</code></pre>
<p>å…¶ä¸­çš„ <code>isEligible</code> æ–¹æ³•æ˜¯æ ¹æ®ä¼ å…¥çš„ address ä»¥åŠ route æ¥åˆ¤æ–­æ˜¯å¦ç¬¦åˆè¦æ±‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEligible</span><span class="hljs-params">(address: <span class="hljs-type">Address</span>, routes: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Route</span>&gt;?)</span></span>: <span class="hljs-built_in">Boolean</span> {

    <span class="hljs-comment">// If this connection is not accepting new exchanges, we're done.</span>
    <span class="hljs-keyword">if</span> (calls.size &gt;= allocationLimit || noNewExchanges) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

    <span class="hljs-comment">// If the non-host fields of the address don't overlap, we're done.</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.route.address.equalsNonHost(address)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

    <span class="hljs-comment">// If the host exactly matches, we're done: this connection can carry the address.</span>
    <span class="hljs-keyword">if</span> (address.url.host == <span class="hljs-keyword">this</span>.route().address.url.host) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// This connection is a perfect match.</span>
    }

    <span class="hljs-comment">// At this point we don't have a hostname match. But we still be able to carry the request if</span>
    <span class="hljs-comment">// our connection coalescing requirements are met. See also:</span>
    <span class="hljs-comment">// https://hpbn.co/optimizing-application-delivery/#eliminate-domain-sharding</span>
    <span class="hljs-comment">// https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing/</span>

    <span class="hljs-comment">// 1. This connection must be HTTP/2.</span>
    <span class="hljs-keyword">if</span> (http2Connection == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

    <span class="hljs-comment">// 2. The routes must share an IP address.</span>
    <span class="hljs-keyword">if</span> (routes == <span class="hljs-literal">null</span> || !routeMatchesAny(routes)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

    <span class="hljs-comment">// 3. This connection's server certificate's must cover the new host.</span>
    <span class="hljs-keyword">if</span> (address.hostnameVerifier !== OkHostnameVerifier) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    <span class="hljs-keyword">if</span> (!supportsUrl(address.url)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

    <span class="hljs-comment">// 4. Certificate pinning must match the host.</span>
    <span class="hljs-keyword">try</span> {
      address.certificatePinner!!.check(address.url.host, handshake()!!.peerCertificates)
    } <span class="hljs-keyword">catch</span> (_: SSLPeerUnverifiedException) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// The caller's address can be carried by this connection.</span>
  }
</code></pre>
<p>æˆ‘ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šè¿™ä¸ªæ–¹æ³•çš„åˆ¤æ–­é€»è¾‘ï¼š</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b3cabe0858e4ef896eae03779b96345~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRW50cm9wbGVzcw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610909&amp;x-signature=SEeu8LxdZzj1y4FzjgPWoZqGcB0%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>PSï¼šå…³äº <strong>coalescing</strong></p>
<p>å®ƒè¡¨ç¤ºè¿æ¥åˆå¹¶ï¼Œä¹Ÿå°±æ˜¯å…è®¸ä¸åŒä¸»æœºåçš„è¯·æ±‚åˆå¹¶åˆ°åŒä¸€ä¸ª TCP è¿æ¥ä¸­ï¼Œè¿™æ˜¯é’ˆå¯¹ã€Œè™šæ‹Ÿä¸»æœºã€çš„ä¸€é¡¹ä¼˜åŒ–ç­–ç•¥ï¼Œæ‰€è°“è™šæ‹Ÿä¸»æœºå°±æ˜¯åœ¨ä¸€å°ç‰©ç†ä¸»æœºä¸Šæœ‰å¤šä¸ªè™šæ‹Ÿçš„æœåŠ¡,å®ƒä»¬ IP åœ°å€ç›¸åŒï¼Œä½†åŸŸåä¸åŒï¼Œå› æ­¤åœ¨ isEligible æ–¹æ³•ä¸­ä¼šåˆ¤æ–­å½“ä¸»æœºåä¸ä¸€è‡´æ—¶ï¼Œä»ç„¶å°è¯•å»æŸ¥æ‰¾åˆé€‚çš„è¿æ¥ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§é™åº¦çš„å¤ç”¨ TCP è¿æ¥ã€‚</p>
<p>å¯èƒ½æœ‰äººä¼šäº§ç”Ÿç–‘é—®ï¼šHttp1.1ä¹Ÿæ”¯æŒè™šæ‹Ÿä¸»æœºï¼Œä¸ºä»€ä¹ˆ OkHttp ä¸­è¦æ±‚åªæœ‰ Http2 çš„è¿æ¥æ‰å¯ä»¥å°è¯• coalescingï¼Œ è¿™æ˜¯å› ä¸º Http1.1 ä¸­åŒä¸€ä¸ª TCP è¿æ¥ä¸æ”¯æŒè·¨ä¸»æœºåçš„è¿æ¥åˆå¹¶ï¼Œå› ä¸ºè¿™ä¼šäº§ç”Ÿå¾ˆå¤šé—®é¢˜(å…·ä½“åŸå› è¾ƒå¤š)ï¼Œå› æ­¤è™½ç„¶ Http1.1çš„åè®®ä¸­å¹¶æœªæ˜ç¡®ç¦æ­¢è¿æ¥åˆå¹¶ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­æ‰€æœ‰çš„å®¢æˆ·ç«¯çš„å®ç°ä¸­éƒ½ä¼šç¦ç”¨ Http1.1 çš„è¿æ¥åˆå¹¶ç­–ç•¥ã€‚</p>
</blockquote>
<ul>
<li>
<p>CallServerInterceptor</p>
<p>è¿™æ˜¯æ•´ä¸ªæ‹¦æˆªå™¨é“¾çš„æœ€åä¸€ç¯ï¼Œå› æ­¤å®ƒæ˜¯å®é™…è´Ÿè´£æ‰§è¡Œç½‘ç»œ I/O çš„ï¼Œå†™å…¥è¯·æ±‚å¤´/ä½“ï¼Œè¯»å–å“åº”å¤´/ä½“ï¼Œå®ƒæ²¡æœ‰ä¸­ç½®å’Œåç½®å·¥ä½œã€‚</p>
</li>
</ul>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘å¯¹ OkHttp çš„å…¨éƒ¨è§£è¯»ï¼Œå¸Œæœ›å¯ä»¥å¸®åˆ°å¤§å®¶ï¼Œå¦‚æœ‰ç–‘é—®æˆ–è€…é—®é¢˜æ¬¢è¿æŒ‡æ­£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Ajax å®ç°å¼‚æ­¥æ•°æ®è¯·æ±‚ï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7571840220703309870</link>    <guid>https://juejin.cn/post/7571840220703309870</guid>    <pubDate>2025-11-13T05:11:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571840220703309870" data-draft-id="7571837786250182702" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Ajax å®ç°å¼‚æ­¥æ•°æ®è¯·æ±‚ï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="JavaScript,HTML,Ajax"/> <meta itemprop="datePublished" content="2025-11-13T05:11:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="www_stdio"/> <meta itemprop="url" content="https://juejin.cn/user/631558156323657"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Ajax å®ç°å¼‚æ­¥æ•°æ®è¯·æ±‚ï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/631558156323657/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    www_stdio
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:11:18.000Z" title="Thu Nov 13 2025 05:11:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ Ajax å®ç°å¼‚æ­¥æ•°æ®è¯·æ±‚ï¼šä»åŸç†åˆ°å®è·µ</h2>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼ŒåŠ¨æ€è·å–å’Œå±•ç¤ºæ•°æ®å·²æˆä¸ºæå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®ã€‚Ajaxï¼ˆAsynchronous JavaScript and XMLï¼‰æŠ€æœ¯æ­£æ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„æ ¸å¿ƒæ‰‹æ®µä¹‹ä¸€ã€‚å°½ç®¡åå­—ä¸­åŒ…å« XMLï¼Œä½†å¦‚ä»Š Ajax æ›´å¸¸ç”¨äºå¤„ç† JSON æ ¼å¼çš„æ•°æ®ã€‚æœ¬æ–‡å°†å¸¦ä½ äº†è§£ Ajax çš„åŸºæœ¬åŸç†ã€æ ¸å¿ƒæµç¨‹ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹å±•ç¤ºå¦‚ä½•ä½¿ç”¨åŸç”Ÿ JavaScript å‘èµ·å¼‚æ­¥è¯·æ±‚å¹¶æ›´æ–°é¡µé¢å†…å®¹ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ Ajaxï¼Ÿ</h3>
<p>Ajax æ˜¯ä¸€ç§åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„å‰æä¸‹ï¼Œé€šè¿‡ JavaScript ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®å¹¶æ›´æ–°éƒ¨åˆ†ç½‘é¡µå†…å®¹çš„æŠ€æœ¯ã€‚å®ƒå…è®¸å‰ç«¯åº”ç”¨ä»¥â€œå¼‚æ­¥â€æ–¹å¼å‘åç«¯å‘èµ· HTTP è¯·æ±‚ï¼Œä»è€Œå®ç°æ›´æµç•…ã€å“åº”æ›´å¿«çš„ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p>
<h3 data-id="heading-2">Ajax çš„å·¥ä½œæµç¨‹</h3>
<p>ä½¿ç”¨åŸç”Ÿ JavaScript å®ç° Ajax è¯·æ±‚é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>
<p><strong>åˆ›å»º XMLHttpRequest å¯¹è±¡</strong><br/>
è¿™æ˜¯æµè§ˆå™¨æä¾›çš„å†…ç½®å¯¹è±¡ï¼Œç”¨äºä¸æœåŠ¡å™¨é€šä¿¡ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">xhr</span> = new XMLHttpRequest()<span class="hljs-comment">;</span>
</code></pre>
</li>
<li>
<p><strong>é…ç½®è¯·æ±‚ï¼ˆopen æ–¹æ³•ï¼‰</strong><br/>
æŒ‡å®šè¯·æ±‚æ–¹æ³•ï¼ˆå¦‚ GET æˆ– POSTï¼‰ã€ç›®æ ‡ URL ä»¥åŠæ˜¯å¦é‡‡ç”¨å¼‚æ­¥æ–¹å¼ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://api.example.com/data'</span>, <span class="hljs-literal">true</span>);
</code></pre>
<p>ç¬¬ä¸‰ä¸ªå‚æ•° <code>true</code> è¡¨ç¤ºå¼‚æ­¥è¯·æ±‚ï¼ˆæ¨èï¼‰ï¼Œ<code>false</code> è¡¨ç¤ºåŒæ­¥ï¼ˆä¼šé˜»å¡é¡µé¢ï¼Œä¸æ¨èä½¿ç”¨ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å‘é€è¯·æ±‚ï¼ˆsend æ–¹æ³•ï¼‰</strong><br/>
è°ƒç”¨ <code>send()</code> æ–¹æ³•æ­£å¼å‘å‡ºè¯·æ±‚ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">xhr.send()<span class="hljs-comment">;</span>
</code></pre>
</li>
<li>
<p><strong>ç›‘å¬çŠ¶æ€å˜åŒ–ï¼ˆreadystatechange äº‹ä»¶ï¼‰</strong><br/>
é€šè¿‡ç›‘å¬ <code>readystatechange</code> äº‹ä»¶ï¼Œå¯ä»¥å®æ—¶è·Ÿè¸ªè¯·æ±‚çš„çŠ¶æ€å˜åŒ–ã€‚<code>readyState</code> å±æ€§è¡¨ç¤ºå½“å‰è¯·æ±‚çš„é˜¶æ®µï¼š</p>
<ul>
<li><code>0</code>ï¼šæœªåˆå§‹åŒ–ï¼ˆå°šæœªè°ƒç”¨ openï¼‰</li>
<li><code>1</code>ï¼šå·²è°ƒç”¨ open()</li>
<li><code>2</code>ï¼šå·²è°ƒç”¨ send()</li>
<li><code>3</code>ï¼šæ­£åœ¨æ¥æ”¶å“åº”æ•°æ®</li>
<li><code>4</code>ï¼šå“åº”å®Œæˆï¼Œå¯ä»¥è¯»å–æ•°æ®</li>
</ul>
<p>å½“ <code>readyState === 4</code> ä¸” <code>status === 200</code> æ—¶ï¼Œè¯´æ˜è¯·æ±‚æˆåŠŸï¼Œå¯ä»¥å®‰å…¨åœ°è§£æå“åº”å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>å¤„ç†å“åº”æ•°æ®</strong><br/>
é€šå¸¸æœåŠ¡å™¨è¿”å›çš„æ˜¯ JSON å­—ç¬¦ä¸²ï¼Œéœ€ä½¿ç”¨ <code>JSON.parse()</code> è½¬æ¢ä¸º JavaScript å¯¹è±¡ï¼Œå†æ“ä½œ DOM æ›´æ–°é¡µé¢ã€‚</p>
</li>
</ol>
<h3 data-id="heading-3">å®æˆ˜ç¤ºä¾‹ï¼šè·å– GitHub ç»„ç»‡æˆå‘˜åˆ—è¡¨</h3>
<p>å‡è®¾æˆ‘ä»¬è¦ä» GitHub API è·å–æŸä¸ªç»„ç»‡ï¼ˆä¾‹å¦‚ <code>lemoncode</code>ï¼‰çš„æˆå‘˜åˆ—è¡¨ï¼Œå¹¶å°†å…¶åŠ¨æ€æ¸²æŸ“åˆ°ç½‘é¡µä¸Šã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Ajax æ•°æ®è¯·æ±‚<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"members"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();

        <span class="hljs-comment">// é…ç½® GET è¯·æ±‚ï¼ˆå¼‚æ­¥ï¼‰</span>
        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://api.github.com/orgs/lemoncode/members'</span>, <span class="hljs-literal">true</span>);

        <span class="hljs-comment">// ç›‘å¬çŠ¶æ€å˜åŒ–</span>
        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
                <span class="hljs-keyword">const</span> members = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);
                <span class="hljs-keyword">const</span> listItems = members.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">member</span> =&gt;</span> <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${member.login}</span>&lt;/li&gt;`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);
                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'members'</span>).<span class="hljs-property">innerHTML</span> = listItems;
            }
        };

        <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
        xhr.<span class="hljs-title function_">send</span>();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li>æˆ‘ä»¬å‘ <code>https://api.github.com/orgs/lemoncode/members</code> å‘èµ· GET è¯·æ±‚ï¼›</li>
<li>æˆåŠŸè·å–æ•°æ®åï¼Œå°†æ¯ä¸ªæˆå‘˜çš„ç”¨æˆ·åï¼ˆ<code>login</code>ï¼‰æ¸²æŸ“ä¸º <code>&lt;li&gt;</code> å…ƒç´ ï¼›</li>
<li>é¡µé¢æ— éœ€åˆ·æ–°å³å¯æ˜¾ç¤ºæœ€æ–°æˆå‘˜åˆ—è¡¨ã€‚</li>
</ul>
<h3 data-id="heading-4">åŒæ­¥ vs å¼‚æ­¥ï¼šä¸ºä½•æ¨èå¼‚æ­¥ï¼Ÿ</h3>
<p>è™½ç„¶ <code>XMLHttpRequest</code> æ”¯æŒåŒæ­¥è¯·æ±‚ï¼ˆå°† <code>open</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°è®¾ä¸º <code>false</code>ï¼‰ï¼Œä½†è¿™ä¼šå¯¼è‡´ JavaScript ä¸»çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°è¯·æ±‚å®Œæˆã€‚åœ¨æ­¤æœŸé—´ï¼Œé¡µé¢æ— æ³•å“åº”ç”¨æˆ·æ“ä½œï¼Œé€ æˆâ€œå¡æ­»â€ç°è±¡ã€‚å› æ­¤ï¼Œåœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œåº”å§‹ç»ˆä½¿ç”¨<strong>å¼‚æ­¥è¯·æ±‚</strong>ï¼ˆ<code>true</code>ï¼‰ã€‚</p>
<h3 data-id="heading-5">å°ç»“</h3>
<p>Ajax æ˜¯è¿æ¥å‰ç«¯ä¸åç«¯çš„æ¡¥æ¢ï¼Œä½¿ Web åº”ç”¨å…·å¤‡æ›´å¼ºçš„äº¤äº’æ€§å’ŒåŠ¨æ€æ€§ã€‚å°½ç®¡ç°ä»£å¼€å‘ä¸­æˆ‘ä»¬æ›´å¤šä½¿ç”¨ <code>fetch</code> API æˆ– Axios ç­‰å°è£…åº“ï¼Œä½†ç†è§£åŸç”Ÿ <code>XMLHttpRequest</code> çš„å·¥ä½œæœºåˆ¶ï¼Œæœ‰åŠ©äºæ·±å…¥æŒæ¡ç½‘ç»œè¯·æ±‚çš„æœ¬è´¨ã€‚é€šè¿‡åˆç†è¿ç”¨ Ajax æŠ€æœ¯ï¼Œå¼€å‘è€…å¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€æµç•…ä¸”ç”¨æˆ·å‹å¥½çš„ Web åº”ç”¨ã€‚</p>
<blockquote>
<p>æç¤ºï¼šéšç€æŠ€æœ¯æ¼”è¿›ï¼Œ<code>fetch</code> å·²é€æ¸æˆä¸ºç°ä»£æµè§ˆå™¨ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚çš„é¦–é€‰æ–¹å¼ï¼Œå®ƒåŸºäº Promiseï¼Œè¯­æ³•æ›´ç®€æ´ï¼Œé”™è¯¯å¤„ç†æ›´æ¸…æ™°ã€‚ä½†åœ¨å­¦ä¹ é˜¶æ®µï¼ŒæŒæ¡åŸç”Ÿ Ajax ä»æ˜¯å¤¯å®åŸºç¡€çš„é‡è¦ä¸€æ­¥ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ Ajaxï¼šä»åŸç†åˆ°å®æˆ˜ï¼Œé™„å¤§å‚é«˜é¢‘é¢è¯•é¢˜]]></title>    <link>https://juejin.cn/post/7571830282849550387</link>    <guid>https://juejin.cn/post/7571830282849550387</guid>    <pubDate>2025-11-13T05:38:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571830282849550387" data-draft-id="7571837786250379310" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ Ajaxï¼šä»åŸç†åˆ°å®æˆ˜ï¼Œé™„å¤§å‚é«˜é¢‘é¢è¯•é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,Ajax"/> <meta itemprop="datePublished" content="2025-11-13T05:38:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹–æ‹‰æ–¯æ—‹é£"/> <meta itemprop="url" content="https://juejin.cn/user/951508170179208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ Ajaxï¼šä»åŸç†åˆ°å®æˆ˜ï¼Œé™„å¤§å‚é«˜é¢‘é¢è¯•é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/951508170179208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹–æ‹‰æ–¯æ—‹é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:38:50.000Z" title="Thu Nov 13 2025 05:38:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Ajaxï¼Ÿ</h2>
<p><strong>Ajaxï¼ˆAsynchronous JavaScript and XMLï¼‰</strong> æ˜¯ä¸€ç§åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ JavaScript å¼‚æ­¥ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®å¹¶æ›´æ–°éƒ¨åˆ†ç½‘é¡µå†…å®¹çš„æŠ€æœ¯ã€‚è™½ç„¶åå­—ä¸­åŒ…å« XMLï¼Œä½†ç°ä»£ Ajax æ›´å¸¸ä½¿ç”¨ <strong>JSON</strong> æ ¼å¼è¿›è¡Œæ•°æ®äº¤äº’ã€‚</p>
<blockquote>
<p>âœ… æ ¸å¿ƒä»·å€¼ï¼š<strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>ï¼Œå®ç°â€œå±€éƒ¨åˆ·æ–°â€ï¼Œé¿å…æ•´é¡µè·³è½¬ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€Ajax çš„æ ¸å¿ƒæµç¨‹ï¼ˆåŸºäº XMLHttpRequestï¼‰</h2>
<p><code>XMLHttpRequest</code>ï¼ˆç®€ç§° XHRï¼‰æ˜¯æµè§ˆå™¨åŸç”Ÿæä¾›çš„ç”¨äºå‘èµ· HTTP è¯·æ±‚çš„ APIã€‚ä»¥ä¸‹æ˜¯å…¶æ ‡å‡†ä½¿ç”¨æµç¨‹ï¼š</p>
<h3 data-id="heading-2">1. åˆ›å»ºè¯·æ±‚å¯¹è±¡</h3>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
const <span class="hljs-attr">xhr</span> = new XMLHttpRequest()<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-3">2. é…ç½®è¯·æ±‚ï¼ˆopenï¼‰</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">javascript
ç¼–è¾‘
xhr.<span class="hljs-keyword">open</span>(method, url, async);
<span class="hljs-comment">// ç¤ºä¾‹ï¼š</span>
xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://api.github.com/orgs/lemoncode/members'</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// æ¨èå¼‚æ­¥</span>
</code></pre>
<ul>
<li><code>method</code>ï¼šè¯·æ±‚æ–¹æ³•ï¼ˆGETã€POST ç­‰ï¼‰</li>
<li><code>url</code>ï¼šç›®æ ‡æ¥å£åœ°å€</li>
<li><code>async</code>ï¼šæ˜¯å¦å¼‚æ­¥ï¼ˆ<strong>å¼ºçƒˆå»ºè®®è®¾ä¸ºÂ <code>true</code></strong>ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼‰</li>
</ul>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šä½ çš„åŸå§‹ä»£ç ä¸­ä½¿ç”¨äº† <code>false</code>ï¼ˆåŒæ­¥ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´æµè§ˆå™¨å¡æ­»ï¼Œ<strong>ç”Ÿäº§ç¯å¢ƒä¸¥ç¦ä½¿ç”¨åŒæ­¥è¯·æ±‚</strong>ï¼</p>
</blockquote>
<h3 data-id="heading-4">3. è®¾ç½®äº‹ä»¶ç›‘å¬å™¨ï¼ˆonreadystatechangeï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
<span class="hljs-attr">xhr.onreadystatechange</span> = function() {
    if (<span class="hljs-attr">xhr.readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.status === <span class="hljs-number">200</span>) {
        const <span class="hljs-attr">data</span> = JSON.parse(xhr.responseText)<span class="hljs-comment">;</span>
        // æ›´æ–° DOM
    }
}<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-5">readyState çŠ¶æ€è¯´æ˜ï¼š</h4>



































<table><thead><tr><th>å€¼</th><th>çŠ¶æ€</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>0</td><td>UNSENT</td><td>è¯·æ±‚æœªåˆå§‹åŒ–ï¼ˆåˆšåˆ›å»ºï¼‰</td></tr><tr><td>1</td><td>OPENED</td><td>open() å·²è°ƒç”¨</td></tr><tr><td>2</td><td>HEADERS_RECEIVED</td><td>send() å·²è°ƒç”¨ï¼Œå“åº”å¤´å·²æ¥æ”¶</td></tr><tr><td>3</td><td>LOADING</td><td>å“åº”ä½“æ­£åœ¨æ¥æ”¶ä¸­</td></tr><tr><td>4</td><td>DONE</td><td>è¯·æ±‚å®Œæˆï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰</td></tr></tbody></table>
<blockquote>
<p>âœ… åªæœ‰å½“ <code>readyState === 4</code> ä¸” <code>status === 200</code> æ—¶ï¼Œæ‰è¡¨ç¤ºè¯·æ±‚æˆåŠŸå®Œæˆã€‚</p>
</blockquote>
<h3 data-id="heading-6">4. å‘é€è¯·æ±‚ï¼ˆsendï¼‰</h3>
<pre><code class="hljs language-scss" lang="scss">javascript
ç¼–è¾‘
xhr<span class="hljs-selector-class">.send</span>(); <span class="hljs-comment">// GET è¯·æ±‚é€šå¸¸æ— å‚æ•°ï¼›POST å¯ä¼  body æ•°æ®</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€å®Œæ•´ç¤ºä¾‹ä¿®æ­£ç‰ˆï¼ˆæ¨èå†™æ³•ï¼‰</h2>
<pre><code class="hljs language-xml" lang="xml">html
é¢„è§ˆ
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Ajax æ•°æ®è¯·æ±‚ï¼ˆä¿®æ­£ç‰ˆï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"members"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
        
        <span class="hljs-comment">// æ¨èï¼šä½¿ç”¨å¼‚æ­¥è¯·æ±‚ï¼ˆasync = trueï¼‰</span>
        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://api.github.com/orgs/lemoncode/members'</span>, <span class="hljs-literal">true</span>);

        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-keyword">const</span> members = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);
                        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'members'</span>).<span class="hljs-property">innerHTML</span> = 
                            members.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${m.login}</span>&lt;/li&gt;`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);
                    } <span class="hljs-keyword">catch</span> (e) {
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'JSON è§£æå¤±è´¥:'</span>, e);
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç :'</span>, xhr.<span class="hljs-property">status</span>);
                }
            }
        };

        xhr.<span class="hljs-title function_">send</span>();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<blockquote>
<p>âœ… ä¿®æ­£ç‚¹ï¼š</p>
<ul>
<li>æ”¹ä¸ºÂ <strong>å¼‚æ­¥è¯·æ±‚</strong>ï¼ˆ<code>true</code>ï¼‰</li>
<li>å¢åŠ Â <strong>é”™è¯¯å¤„ç†</strong>ï¼ˆçŠ¶æ€ç é 200ã€JSON è§£æå¼‚å¸¸ï¼‰</li>
<li>ç§»é™¤å†—ä½™çš„Â <code>console.log</code>ï¼Œèšç„¦æ ¸å¿ƒé€»è¾‘</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-8">å››ã€ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼šfetch API</h2>
<p>è™½ç„¶ XHR ä»å¹¿æ³›ä½¿ç”¨ï¼Œä½†ç°ä»£å¼€å‘æ›´æ¨èä½¿ç”¨ <strong><code>fetch</code></strong> â€”â€” åŸºäº Promise çš„æ–°æ ‡å‡†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">javascript
ç¼–è¾‘
fetch('https://api.github.com/orgs/lemoncode/members')
  .then(<span class="hljs-attr">response</span> =&gt; {
    if (!response.ok) throw new Error('ç½‘ç»œå“åº”å¤±è´¥')<span class="hljs-comment">;</span>
    return response.json()<span class="hljs-comment">;</span>
  })
  .then(<span class="hljs-attr">members</span> =&gt; {
    document.getElementById('members').<span class="hljs-attr">innerHTML</span> = 
      members.map(<span class="hljs-attr">m</span> =&gt; `&lt;li&gt;<span class="hljs-variable">${m.login}</span>&lt;/li&gt;`).join(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>
  })
  .catch(<span class="hljs-attr">err</span> =&gt; console.error(<span class="hljs-string">'è¯·æ±‚å‡ºé”™:'</span>, err))<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>âœ… ä¼˜åŠ¿ï¼šè¯­æ³•ç®€æ´ã€å¤©ç„¶æ”¯æŒ Promiseã€æ›´æ˜“é“¾å¼è°ƒç”¨<br/>
âŒ åŠ£åŠ¿ï¼šå¯¹ IE ä¸å‹å¥½ï¼ˆéœ€ polyfillï¼‰</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">äº”ã€å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ</h2>

























<table><thead><tr><th>é—®é¢˜</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>è·¨åŸŸè¯·æ±‚å¤±è´¥</td><td>åç«¯é…ç½® CORSï¼Œæˆ–ä½¿ç”¨ä»£ç†</td></tr><tr><td>åŒæ­¥è¯·æ±‚å¡æ­»é¡µé¢</td><td><strong>æ°¸è¿œä¸è¦ç”¨Â <code>async: false</code></strong></td></tr><tr><td>JSON è§£æé”™è¯¯</td><td>ä½¿ç”¨Â <code>try...catch</code>Â åŒ…è£¹Â <code>JSON.parse</code></td></tr><tr><td>å†…å­˜æ³„æ¼</td><td>åœ¨ SPA ä¸­æ³¨æ„å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚ï¼ˆå¯ç”¨ AbortControllerï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10">å…­ã€å¤§å‚é«˜é¢‘ Ajax é¢è¯•é¢˜ï¼ˆé™„ç­”æ¡ˆï¼‰</h2>
<h3 data-id="heading-11">1.Â <strong>Ajax å’Œ fetch çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š</p>
<ul>
<li><code>XMLHttpRequest</code>Â æ˜¯ä¼ ç»Ÿ APIï¼Œå›è°ƒé£æ ¼ï¼Œéœ€æ‰‹åŠ¨ç›‘å¬çŠ¶æ€ï¼›</li>
<li><code>fetch</code>Â æ˜¯åŸºäº Promise çš„ç°ä»£ APIï¼Œè¯­æ³•æ›´ç®€æ´ï¼Œä½†é»˜è®¤ä¸å¤„ç† 4xx/5xx é”™è¯¯ï¼ˆéœ€æ‰‹åŠ¨æ£€æŸ¥Â <code>response.ok</code>ï¼‰ï¼›</li>
<li><code>fetch</code>Â ä¸æ”¯æŒè¶…æ—¶æ§åˆ¶ï¼ˆéœ€é…åˆÂ <code>AbortController</code>ï¼‰ï¼Œè€Œ XHR å¯é€šè¿‡Â <code>timeout</code>Â å±æ€§è®¾ç½®ã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-12">2.Â <strong>ä¸ºä»€ä¹ˆ Ajax é»˜è®¤ä¸èƒ½è·¨åŸŸï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š å‡ºäº<strong>æµè§ˆå™¨åŒæºç­–ç•¥</strong>å®‰å…¨é™åˆ¶ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ï¼š</p>
<ul>
<li>åç«¯è®¾ç½® CORS å¤´ï¼ˆå¦‚Â <code>Access-Control-Allow-Origin: *</code>ï¼‰</li>
<li>å¼€å‘é˜¶æ®µä½¿ç”¨ Webpack/Vite ä»£ç†</li>
<li>JSONPï¼ˆä»…é™ GETï¼Œå·²è¿‡æ—¶ï¼‰</li>
<li>Nginx åå‘ä»£ç†</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-13">3.Â <strong>å¦‚ä½•å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„ Ajax è¯·æ±‚ï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š</p>
<ul>
<li>
<p><strong>XHR</strong>ï¼šè°ƒç”¨Â <code>xhr.abort()</code>ï¼›</p>
</li>
<li>
<p><strong>fetch</strong>ï¼šä½¿ç”¨Â <code>AbortController</code>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">js
ç¼–è¾‘
const controller = new <span class="hljs-built_in">AbortController</span>();
<span class="hljs-built_in">fetch</span>(url, { signal: controller.signal });
<span class="hljs-comment">// å–æ¶ˆ</span>
controller<span class="hljs-selector-class">.abort</span>();
</code></pre>
</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-14">4.Â <strong>Ajax è¯·æ±‚ä¸­ï¼ŒreadyState å’Œ status çš„åŒºåˆ«ï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š</p>
<ul>
<li><code>readyState</code>Â è¡¨ç¤º<strong>è¯·æ±‚ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ</strong>ï¼ˆ0~4ï¼‰ï¼›</li>
<li><code>status</code>Â è¡¨ç¤º<strong>HTTP å“åº”çŠ¶æ€ç </strong>ï¼ˆå¦‚ 200ã€404ã€500ï¼‰ï¼›</li>
<li>å¿…é¡»åŒæ—¶æ»¡è¶³Â <code>readyState === 4</code>Â ä¸”Â <code>status === 200</code>Â æ‰ç®—æˆåŠŸã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-15">5.Â <strong>åŒæ­¥ Ajax æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆç¦æ­¢ä½¿ç”¨ï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š åŒæ­¥è¯·æ±‚ä¼š<strong>é˜»å¡æµè§ˆå™¨ä¸»çº¿ç¨‹</strong>ï¼Œå¯¼è‡´é¡µé¢â€œå‡æ­»â€ï¼Œç”¨æˆ·æ— æ³•äº¤äº’ï¼Œä¸¥é‡æŸå®³ä½“éªŒã€‚ç°ä»£æµè§ˆå™¨å·²åºŸå¼ƒåŒæ­¥ XHRï¼ˆå°¤å…¶åœ¨ä¸»çº¿ç¨‹ä¸­ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-16">6.Â <strong>å¦‚ä½•å¤„ç† Ajax çš„é”™è¯¯ï¼Ÿ</strong></h3>
<blockquote>
<p><strong>ç­”</strong>ï¼š</p>
<ul>
<li>XHRï¼šç›‘å¬Â <code>onerror</code>Â äº‹ä»¶ + æ£€æŸ¥Â <code>status !== 200</code></li>
<li>fetchï¼š<code>.catch()</code>Â æ•è·ç½‘ç»œé”™è¯¯ + æ£€æŸ¥Â <code>response.ok</code></li>
<li>ç»Ÿä¸€é”™è¯¯æç¤ºã€é‡è¯•æœºåˆ¶ã€æ—¥å¿—ä¸ŠæŠ¥</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-17">ä¸ƒã€æ€»ç»“</h2>
<p>Ajax æ˜¯å‰ç«¯ä¸åç«¯é€šä¿¡çš„åŸºçŸ³æŠ€æœ¯ã€‚æŒæ¡ <code>XMLHttpRequest</code> çš„åº•å±‚åŸç†ï¼Œæœ‰åŠ©äºç†è§£ç°ä»£ <code>fetch</code>ã€<code>axios</code> ç­‰å°è£…åº“çš„è®¾è®¡æ€æƒ³ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼š</p>
<p>âœ… <strong>åšæŒå¼‚æ­¥</strong><br/>
âœ… <strong>åšå¥½é”™è¯¯å¤„ç†</strong><br/>
âœ… <strong>ä¼˜å…ˆä½¿ç”¨ fetch æˆ– axios</strong><br/>
âœ… <strong>ç†è§£è·¨åŸŸä¸å®‰å…¨æœºåˆ¶</strong></p>
<p>åªæœ‰å¤¯å®åŸºç¡€ï¼Œæ‰èƒ½åœ¨å¤æ‚åœºæ™¯ä¸­æ¸¸åˆƒæœ‰ä½™ï¼Œè½»æ¾åº”å¯¹å¤§å‚é¢è¯•æŒ‘æˆ˜ï¼</p>
<hr/>
<blockquote>
<p>ğŸ“Œ <strong>å»¶ä¼¸å­¦ä¹ </strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">MDN: XMLHttpRequest</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">Fetch API è§„èŒƒ</a></li>
<li>Axios æºç è§£æï¼ˆåŸºäº XHR å°è£…ï¼‰</li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS ç¤¾æ‹› - Runtime ç›¸å…³çŸ¥è¯†ç‚¹]]></title>    <link>https://juejin.cn/post/7571722835658391586</link>    <guid>https://juejin.cn/post/7571722835658391586</guid>    <pubDate>2025-11-13T03:28:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571722835658391586" data-draft-id="7571722835658375202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS ç¤¾æ‹› - Runtime ç›¸å…³çŸ¥è¯†ç‚¹"/> <meta itemprop="keywords" content="é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-13T03:28:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é½ç”Ÿ1"/> <meta itemprop="url" content="https://juejin.cn/user/942699496080123"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS ç¤¾æ‹› - Runtime ç›¸å…³çŸ¥è¯†ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/942699496080123/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é½ç”Ÿ1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:28:14.000Z" title="Thu Nov 13 2025 03:28:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<p><strong>æœ¬è´¨</strong>ï¼š<code>runtime</code>æ˜¯ oc çš„ä¸€ä¸ªè¿è¡Œæ—¶åº“ï¼ˆ<code>libobjc.A,dylib</code>ï¼‰ï¼Œå®ƒä¸º oc æ·»åŠ äº† <strong>é¢å‘å¯¹è±¡çš„èƒ½åŠ›</strong> ä»¥åŠ <strong>è¿è¡Œæ—¶çš„åŠ¨æ€ç‰¹æ€§</strong>ã€‚</p>
<ul>
<li><strong>é¢å‘å¯¹è±¡çš„èƒ½åŠ›</strong>ï¼š<code>rutime</code>ç”¨ C è¯­è¨€å®ç°äº†ç±»ã€å¯¹è±¡ã€å°è£…ã€ç»§æ‰¿ã€å¤šæ€ç­‰é¢å‘å¯¹è±¡çš„æ ¸å¿ƒæ¦‚å¿µã€‚</li>
<li><strong>è¿è¡Œæ—¶çš„åŠ¨æ€ç‰¹æ€§</strong>ï¼š<code>runtime</code>å¯ä»¥è®©å¾ˆå¤šæ“ä½œå¯ä»¥åœ¨ <strong>è¿è¡Œæ—¶</strong> ç¡®å®šï¼Œå¦‚ åŠ¨æ€æ–¹æ³•è°ƒç”¨ã€åŠ¨æ€ç±»å‹æ£€æŸ¥ã€åŠ¨æ€æ–¹æ³•æ·»åŠ ã€åŠ¨æ€å±æ€§è®¿é—®ã€åŠ¨æ€ç±»åˆ›å»ºæ¶ˆæ¯è½¬å‘æœºåˆ¶ç­‰ã€‚
<ul>
<li><strong>åŠ¨æ€è¯­è¨€</strong> çš„ä¼˜åŠ£åŠ¿
<ul>
<li><strong>ä¼˜åŠ¿</strong>ï¼š
<ol>
<li><strong>çµæ´»æ€§</strong>ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹ç¨‹åºçš„è¡Œä¸º</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ åŠŸèƒ½</li>
<li><strong>åå°„èƒ½åŠ›</strong>ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œæ“ä½œå¯¹è±¡</li>
</ol>
</li>
<li><strong>ä»£ä»·</strong>ï¼š
<ol>
<li><strong>æ€§èƒ½å¼€é”€</strong>ï¼šè¿è¡Œæ—¶æŸ¥æ‰¾æ¯”ç¼–è¯‘æ—¶ç¡®å®šæ…¢</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå¯ç¼–è¯‘æ—¶æ— æ³•æ£€æŸ¥æ‰€æœ‰é”™è¯¯</li>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šåŠ¨æ€è¡Œä¸ºéš¾ä»¥è¿½è¸ª</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-1"><code>Runtime</code>æ•°æ®ç»“æ„</h2>
<p>é¦–å…ˆæˆ‘ä»¬è¦æ¸…æ™°ï¼Œæ‰€æœ‰çš„ OC å¯¹è±¡ï¼ˆåŒ…æ‹¬ NSObject è‡ªèº«ï¼‰åœ¨å†…å­˜ä¸­ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ª objc_object ç»“æ„ä½“å®ä¾‹ã€‚ç„¶åäº†è§£å¯¹è±¡ä½“ç³»ä¹‹é—´çš„å…³ç³»ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">/// æ ¸å¿ƒæ•°æ®ç»“æ„</span>
<span class="hljs-comment">/// </span>
<span class="hljs-comment">/// 1. ä»»ä½•å®ä¾‹ï¼ˆ`id` å°±æ˜¯ objc_object * ç±»å‹ï¼‰</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">objc_object</span> {
  <span class="hljs-type">Class</span> _Nonnull isa;    <span class="hljs-comment">// isa æŒ‡é’ˆï¼ŒæŒ‡å‘å¯¹è±¡çš„ç±»</span>
};

<span class="hljs-comment">/// 2. ç±»å¯¹è±¡ / å…ƒç±»å¯¹è±¡</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">objc_class</span> {
    <span class="hljs-type">Class</span> _Nonnull isa;  <span class="hljs-comment">// ç»§æ‰¿è‡ª objc_object</span>
    <span class="hljs-type">Class</span> _Nullable super_class;
    cache_t cache;           <span class="hljs-comment">// æ–¹æ³•ç¼“å­˜</span>
    class_data_bits_t bits;  <span class="hljs-comment">// ç±»çš„å…·ä½“ä¿¡æ¯ -&gt; class_rw_t</span>
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">class_rw_t</span> {
    method_array_t methods;     <span class="hljs-comment">// -&gt; objc_method[]ï¼ˆå…ƒç±»å¯¹è±¡å­˜å‚¨ç±»æ–¹æ³•ã€ç±»å¯¹è±¡å­˜å‚¨å®ä¾‹æ–¹æ³•ï¼‰</span>
    property_array_t properties;  <span class="hljs-comment">// -&gt; objc_property[]</span>
    ivar_array_t ivars;                <span class="hljs-comment">// -&gt; objc_ivar[]</span>
    const class_ro_t <span class="hljs-operator">*</span>ro; <span class="hljs-comment">// ç¼–è¯‘æœŸåªè¯»ä¿¡æ¯</span>
};

<span class="hljs-comment">/// 3. æ–¹æ³•æè¿°</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">objc_method</span> {
    <span class="hljs-type">SEL</span> name;      <span class="hljs-comment">// æ–¹æ³•åï¼ˆæ–¹æ³•é€‰æ‹©å­ï¼‰</span>
    const char <span class="hljs-operator">*</span>types;  <span class="hljs-comment">// æ–¹æ³•ç±»å‹ç¼–ç </span>
    <span class="hljs-type">IMP</span> imp;        <span class="hljs-comment">// æ–¹æ³•å®ç°ï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰</span>
};

<span class="hljs-comment">/// 4. å±æ€§æè¿°</span>
<span class="hljs-keyword">struct</span>   <span class="hljs-title class_">objc_property</span> {
    const char <span class="hljs-operator">*</span> _Nonnull name;           <span class="hljs-comment">// å±æ€§å</span>
    const char <span class="hljs-operator">*</span> _Nullable attributes;    <span class="hljs-comment">// å±æ€§ç‰¹æ€§</span>
};

<span class="hljs-comment">/// 5. å®ä¾‹å˜é‡</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">objc_ivar</span> {
    char <span class="hljs-operator">*</span> _Nullable name;     <span class="hljs-comment">// å˜é‡å</span>
    char <span class="hljs-operator">*</span> _Nullable type;      <span class="hljs-comment">// å˜é‡ç±»å‹</span>
    int offset;                      <span class="hljs-comment">// å˜é‡åç§»é‡</span>
    uint32_t alignment_raw;         <span class="hljs-comment">// å¯¹é½ä¿¡æ¯</span>
    uint32_t size;                  <span class="hljs-comment">// å˜é‡å¤§å°</span>
}; 

</code></pre>
<h3 data-id="heading-2">1. <code>isa</code> æŒ‡é’ˆ</h3>
<p><strong>å«ä¹‰</strong>ï¼š<code>isa</code>æŒ‡é’ˆæ˜¯ OC å¯¹è±¡ä¸­ï¼ŒæŒ‡å‘å…¶ç±»å¯¹è±¡å’Œå…ƒç±»å¯¹è±¡çš„æŒ‡é’ˆã€‚å½“å¯¹è±¡æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œç³»ç»Ÿé€šè¿‡<code>isa</code>å®šä½ç±»å¯¹è±¡ï¼Œä»è€ŒæŸ¥æ‰¾æ–¹æ³•å®ç°ã€‚
<strong>ä½œç”¨</strong>ï¼šå†³å®šå¯¹è±¡çš„ç±»å‹ã€ä»¥åŠæ–¹æ³•æŸ¥æ‰¾èµ·ç‚¹ã€‚æ¯”å¦‚å®ä¾‹å¯¹è±¡çš„<code>isa</code>å†³å®šå®ƒå±äºå“ªä¸ªç±»ï¼Œç±»æ–¹æ³•çš„æŸ¥æ‰¾ä»å…ƒç±»å¯¹è±¡å¼€å§‹ã€‚</p>
<p><strong>ä¼˜åŒ– (64-bit)</strong>ï¼šåœ¨ 64 ä½ç³»ç»Ÿä¸­ï¼Œ<code>isa</code>è¢«è®¾è®¡ä¸ºäº†å«åšã€Œä½åŸŸ (bitfield)ã€çš„ç»“æ„ã€‚é™¤äº†å­˜æ”¾ç±»æŒ‡é’ˆå¤–ï¼Œè¿˜å†…åµŒäº†ä¸€äº›çŠ¶æ€ä½ï¼ˆå¼•ç”¨è®¡æ•°ã€å¼±å¼•ç”¨ã€ææ„æ ‡å¿—ç­‰ï¼‰ï¼Œè¿™æ ·åšå¯ä»¥å°†å°å¯¹è±¡çš„æ•°æ®ç›´æ¥ç¼–ç è¿›æŒ‡é’ˆæœ¬èº«ï¼ŒèŠ‚çœäº†å°å¯¹è±¡çš„å†…å­˜ä¸è®¿é—®å¼€é”€ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">union</span> <span class="hljs-title class_">isa_t</span> {
    Class cls;
    <span class="hljs-type">uintptr_t</span> bits;
    <span class="hljs-keyword">struct</span> {
        <span class="hljs-type">uintptr_t</span> nonpointer        : <span class="hljs-number">1</span>; <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ä¼˜åŒ–</span>
        <span class="hljs-type">uintptr_t</span> has_assoc         : <span class="hljs-number">1</span>;
        <span class="hljs-type">uintptr_t</span> has_cxx_dtor      : <span class="hljs-number">1</span>;
        <span class="hljs-type">uintptr_t</span> shiftcls          : <span class="hljs-number">33</span>; <span class="hljs-comment">// å­˜çœŸæ­£çš„ç±»æŒ‡é’ˆ</span>
        <span class="hljs-type">uintptr_t</span> magic             : <span class="hljs-number">6</span>;
        <span class="hljs-type">uintptr_t</span> weakly_referenced : <span class="hljs-number">1</span>;
        <span class="hljs-type">uintptr_t</span> deallocating      : <span class="hljs-number">1</span>;
        <span class="hljs-type">uintptr_t</span> has_sidetable_rc  : <span class="hljs-number">1</span>;
        <span class="hljs-type">uintptr_t</span> extra_rc          : <span class="hljs-number">19</span>;
    };
};
</code></pre>
<h2 data-id="heading-3"><strong>å¯¹è±¡æ¨¡å‹</strong></h2>
<p>å¯¹è±¡ã€ç±»ã€å…ƒç±»å…³ç³»ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38a13c0dd1c146ab9a3f787d4d277b3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b2Q55SfMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609294&amp;x-signature=oysTVTpLqdu%2BZIHErJ13%2B5bAnGA%3D" alt="image" loading="lazy"/></p>
<p>æ‹¿<code>Person</code>ç±»ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">Person</span> : <span class="hljs-title">NSObject</span></span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">strong</span>) <span class="hljs-built_in">NSString</span> *name;
- (<span class="hljs-type">void</span>)changeNameWith:(<span class="hljs-built_in">NSString</span> *)newName;
+ (<span class="hljs-keyword">instancetype</span>)mockPerson;
<span class="hljs-keyword">@end</span>

Person *p1 = [Person new];
</code></pre>
<p>å®é™…çš„å¯¹è±¡ä½“ç³»é“¾è·¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å®ä¾‹å¯¹è±¡ï¼šobject_object (p1) 
            _____
           | isa | ---&gt; ç±»å¯¹è±¡ï¼šobject_class (Person.class)
            _____             ____________
                             | isa         | -------------
c_object (NSObject.class) &lt;- | super_class |              |         methods<span class="hljs-selector-attr">[]</span> (-changeNameWith:)
                             | bits        |  ------------------&gt; { properties<span class="hljs-selector-attr">[]</span> (name)
                              ____________                |         ivars<span class="hljs-selector-attr">[]</span> (_name)
                                                          â–¼
                                           å…ƒç±»å¯¹è±¡ï¼šobject_class (Person.meta)
                                    ____________
                                   | isa         | ---------
     objc_class (NSObject.meta) &lt;- | super_class |          |            methods<span class="hljs-selector-attr">[]</span> (+allocã€+mockPerson)
                                   | bits        |  ------------------&gt;{ properties<span class="hljs-selector-attr">[]</span> (æ— )
                                    ____________            |            ivars<span class="hljs-selector-attr">[]</span> (æ— ) 
                                                            â–¼
                                              æ ¹å…ƒç±»å¯¹è±¡ï¼šobjc_class (NSObject.meta)
                                                      ____________
                                                     | isa         | ---&gt; æŒ‡å‘è‡ªå·±
                      objc_class (NSObject.class) &lt;- | super_class |       
                                                     | bits        |  
                                                      ____________  
</code></pre>
<hr/>
<h2 data-id="heading-4">æ¶ˆæ¯ä¼ é€’æœºåˆ¶</h2>
<h3 data-id="heading-5">1. æ¶ˆæ¯å‘é€æœºåˆ¶</h3>
<p>å½“ä»£ç å†™ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[p sayHello]</span><span class="hljs-comment">;</span>
</code></pre>
<p>ç¼–è¯‘å™¨ä¼šè½¬åŒ–æˆï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">objc_msgSend</span>(p, <span class="hljs-variable">@selector</span>(sayHello));
</code></pre>
<p>objc_msgSend æŸ¥æ‰¾æµç¨‹ï¼š</p>
<ol>
<li>æ£€æŸ¥ <strong>å®ä¾‹å¯¹è±¡</strong> æ˜¯å¦ä¸º <code>nil</code></li>
<li>ä» <strong>å®ä¾‹å¯¹è±¡</strong> çš„ <code>isa</code>æŒ‡é’ˆæ‰¾åˆ° <strong>ç±»å¯¹è±¡</strong></li>
<li>åœ¨ <strong>ç±»å¯¹è±¡</strong> çš„<code>cache_t</code>ä¸­æŸ¥æ‰¾æ–¹æ³•</li>
<li>æ²¡å‘½ä¸­ç¼“å­˜ï¼Œåˆ™åœ¨ <strong>ç±»å¯¹è±¡</strong> çš„æ–¹æ³•åˆ—è¡¨ä¸­æŸ¥æ‰¾</li>
<li>æ²¡æ‰¾åˆ°ï¼Œæ²¿ç€ç»§æ‰¿é“¾å‘ä¸ŠæŸ¥æ‰¾</li>
<li>å¦‚æœéƒ½æœªæ‰¾åˆ°ï¼Œè¿›å…¥æ¶ˆæ¯è½¬å‘æµç¨‹</li>
</ol>
<p>ç¼“å­˜æœºåˆ¶ï¼ˆcache_tï¼‰:å“ˆå¸ŒæŸ¥æ‰¾ SEL</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">cache_t</span> {
    explicit_atomic&lt;<span class="hljs-type">uintptr_t</span>&gt; _bucketsAndMaybeMask; <span class="hljs-comment">// å“ˆå¸Œè¡¨</span>
    <span class="hljs-keyword">union</span> {
        <span class="hljs-keyword">struct</span> {
            explicit_atomic&lt;<span class="hljs-type">mask_t</span>&gt; _maybeMask;      <span class="hljs-comment">// æ©ç </span>
            <span class="hljs-type">uint16_t</span> _flags;                         <span class="hljs-comment">// æ ‡å¿—ä½</span>
            <span class="hljs-type">uint16_t</span> _occupied;                      <span class="hljs-comment">// å·²å ç”¨æ•°é‡</span>
        };
        explicit_atomic&lt;<span class="hljs-type">preopt_cache_t</span> *&gt; _originalPreoptCache;
    };
    
    <span class="hljs-comment">// å“ˆå¸ŒæŸ¥æ‰¾ç®—æ³•</span>
    <span class="hljs-function"><span class="hljs-type">bucket_t</span> *<span class="hljs-title">find</span><span class="hljs-params">(SEL s, id receiver)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(SEL sel, IMP imp, id receiver)</span></span>;
};
</code></pre>
<h3 data-id="heading-6">2. æ¶ˆæ¯è½¬å‘æœºåˆ¶</h3>
<ol>
<li>
<p>é˜¶æ®µä¸€ï¼š<strong>åŠ¨æ€æ–¹æ³•è§£æ</strong>
a. è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ  <strong>å®ä¾‹æ–¹æ³•</strong> å®ç°ï¼š<code>+ (BOOL)resolveInstanceMethod:(SEL)sel</code>
b. åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ  <strong>ç±»æ–¹æ³•</strong> å®ç°ï¼š<code>+ (BOOL)resolveClassMethod:(SEL)sel</code>
ã€ŒæˆåŠŸè¿”å› YESï¼›å¤±è´¥è¿”å› NOï¼Œç»§ç»­å¿«é€Ÿè½¬å‘ã€</p>
</li>
<li>
<p>é˜¶æ®µäºŒï¼š<strong>å¿«é€Ÿè½¬å‘</strong>
a. è¿”å›ä¸€ä¸ªèƒ½å¤„ç†è¯¥æ¶ˆæ¯çš„å¯¹è±¡ï¼ŒRuntime ä¼šå°†æ¶ˆæ¯è½¬å‘ç»™è¯¥å¯¹è±¡ï¼š<code>- (id)forwardingTargetForSelector:(SEL)aSelector</code>
ã€ŒæˆåŠŸè¿”å›å¯¹è±¡ï¼›å¤±è´¥è¿”å›nilï¼Œç»§ç»­å®Œæ•´è½¬å‘ã€</p>
</li>
<li>
<p>é˜¶æ®µä¸‰ï¼š<strong>å®Œæ•´è½¬å‘</strong>
a. è¿”å›æ–¹æ³•ç­¾åï¼š<code>- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector</code>
b. æ‰§è¡Œå®é™…çš„æ¶ˆæ¯è½¬å‘é€»è¾‘ï¼š<code>- (void)forwardInvocation:(NSInvocation *)anInvocation</code>
ã€Œå¤±è´¥æŠ›å‡ºå¼‚å¸¸ã€</p>
</li>
<li>
<p><strong>æŠ›å‡ºå¼‚å¸¸</strong>
a. <code>- (void)doesNotRecognizeSelector:(SEL)aSelector</code></p>
</li>
</ol>
<h4 data-id="heading-7">å¿«é€Ÿè½¬å‘ vs å®Œæ•´è½¬å‘</h4>








































<table><thead><tr><th/><th>å¿«é€Ÿè½¬å‘</th><th>å®Œæ•´è½¬å‘</th></tr></thead><tbody><tr><td>è°ƒç”¨æ—¶æœº</td><td>åŠ¨æ€æ–¹æ³•è§£æå¤±è´¥</td><td>å¿«é€Ÿè½¬å‘å¤±è´¥</td></tr><tr><td>è¿”å›å€¼</td><td>ç›®æ ‡å¯¹è±¡</td><td>void</td></tr><tr><td>è°ƒç”¨æœºåˆ¶</td><td>é‡æ–°è°ƒç”¨ objc_msgSend(newTarget, sel)</td><td>æ‰‹åŠ¨é€šè¿‡ NSInvocation è°ƒç”¨</td></tr><tr><td>æ€§èƒ½</td><td>ğŸš€ å¿«</td><td>ğŸ¢æ…¢</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>ç®€å•è½¬å‘ç»™å¦ä¸€ä¸ªå¯¹è±¡</td><td>å¤æ‚æ¶ˆæ¯è·¯ç”±ï¼ˆåŠ¨æ€ä¿®æ”¹è°ƒç”¨ï¼‰</td></tr><tr><td>å¸¸è§ç”¨é€”</td><td>ä»£ç†ã€ä»£ç†è½¬å‘</td><td>æ¶ˆæ¯åˆ†å‘ä¸­å¿ƒã€AOP</td></tr></tbody></table>
<h4 data-id="heading-8"><code>NSInvocation</code> ä»‹ç»</h4>
<p>å®Œæ•´è½¬å‘æœ€åä¼šç”¨åˆ°çš„ç±»ï¼Œ<code>NSInvocation</code>æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>å°è£…æ–¹æ³•è°ƒç”¨çš„å¯¹è±¡</li>
<li>å­˜å‚¨ç›®æ ‡å¯¹è±¡ã€é€‰æ‹©å™¨ã€å‚æ•°ã€è¿”å›å€¼</li>
<li>å¯ä»¥å»¶è¿Ÿæ‰§è¡Œæˆ–å¤šæ¬¡æ‰§è¡Œ</li>
</ul>
<hr/>
<h2 data-id="heading-9">Runtime API ä¸åŠ¨æ€èƒ½åŠ›</h2>
<h3 data-id="heading-10">1. æ–¹æ³•äº¤æ¢ï¼ˆMethod Swizzingï¼‰</h3>
<p><strong>æœ¬è´¨</strong>ï¼šä¿®æ”¹æ–¹æ³•åˆ—è¡¨ä¸­ <code>SEL</code> å’Œ <code>IMP</code> çš„å¯¹åº”å…³ç³»
<strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ol>
<li>åœ¨ +load æ–¹æ³•ä¸­è¿›è¡Œï¼Œç¡®ä¿ç±»åŠ è½½æ—¶æ‰§è¡Œã€‚
<ul>
<li>åŸå› ï¼š+load åœ¨ç±»åŠ è½½åˆ°å†…å­˜æ—¶è°ƒç”¨ï¼Œæ—©äºä»»ä½•æ¶ˆæ¯å‘é€ï¼Œé¿å…ç«æ€ã€‚</li>
</ul>
</li>
<li>ä½¿ç”¨ <code>dispatch_once</code> ç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡ã€‚
<ul>
<li>åŸå› ï¼šé¿å…é‡å¤äº¤æ¢ï¼Œå¯¼è‡´æ–¹æ³•å®ç°è¢«æ¢å›åŸæ ·ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li>
</ul>
</li>
<li>è€ƒè™‘ç»§æ‰¿å…³ç³»ï¼Œé¿å…é‡å¤äº¤æ¢ã€‚
<ul>
<li>åŸå› ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³•ï¼Œå¦‚æœçˆ¶å­äº¤æ¢åŒä¸€ä¸ªæ–¹æ³•ï¼Œä¼šå¯¼è‡´é‡å¤äº¤æ¢ï¼Œäº¤æ¢å¤±è´¥ã€‚</li>
</ul>
</li>
<li>æ–¹æ³•ç­¾åè¦åŒ¹é…ã€‚
<ul>
<li>åŸå› ï¼šæ–¹æ³•ç­¾åä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´å‚æ•°ä¼ é€’é”™è¯¯ã€è¿”å›å€¼é”™è¯¯ã€å†…å­˜é—®é¢˜ç­‰ã€‚</li>
</ul>
</li>
<li>åœ¨äº¤æ¢çš„æ–¹æ³•ä¸­è°ƒç”¨åŸæ–¹æ³•
<ul>
<li>åŸå› ï¼šä¿æŒåŸæœ‰åŠŸèƒ½ï¼Œé¿å…åŠŸèƒ½ä¸¢å¤±ï¼›ä¿è¯è°ƒç”¨é“¾å®Œæ•´ï¼›é¿å…ç ´åå…¶ä»–ä¾èµ–ã€‚</li>
</ul>
</li>
</ol>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@implementation</span> UIViewController (Swizzling)

+ (void)load {
    static dispatch_once_t onceToken;
    <span class="hljs-built_in">dispatch_once</span>(&amp;onceToken, ^{
        [self swizzleMethod:@selector(viewDidLoad) 
                 withMethod:@<span class="hljs-built_in">selector</span>(swizzled_viewDidLoad)];
    });
}

+ (void)swizzleMethod:(SEL)originalSelector withMethod:(SEL)swizzledSelector {
    Class class = <span class="hljs-selector-attr">[self class]</span>;
    
    Method originalMethod = <span class="hljs-built_in">class_getInstanceMethod</span>(class, originalSelector);
    Method swizzledMethod = <span class="hljs-built_in">class_getInstanceMethod</span>(class, swizzledSelector);
    
    <span class="hljs-comment">// å°è¯•æ·»åŠ åŸæ–¹æ³•ï¼Œå¦‚æœå·²å­˜åœ¨åˆ™è¿”å› NO</span>
    BOOL didAddMethod = <span class="hljs-built_in">class_addMethod</span>(class,
                                       originalSelector,
                                       method_getImplementation(swizzledMethod),
                                       <span class="hljs-built_in">method_getTypeEncoding</span>(swizzledMethod));
    
    if (didAddMethod) {
        <span class="hljs-comment">// åŸæ–¹æ³•ä¸å­˜åœ¨ï¼Œæ›¿æ¢æ–°æ–¹æ³•çš„å®ç°</span>
        <span class="hljs-built_in">class_replaceMethod</span>(class,
                           swizzledSelector,
                           method_getImplementation(originalMethod),
                           <span class="hljs-built_in">method_getTypeEncoding</span>(originalMethod));
    } else {
        <span class="hljs-comment">// åŸæ–¹æ³•å­˜åœ¨ï¼Œç›´æ¥äº¤æ¢å®ç°</span>
        <span class="hljs-built_in">method_exchangeImplementations</span>(originalMethod, swizzledMethod);
    }
}

- (void)swizzled_viewDidLoad {
    <span class="hljs-comment">// è°ƒç”¨åŸå§‹å®ç°ï¼ˆæ­¤æ—¶å·²ç»äº¤æ¢ï¼Œæ‰€ä»¥è°ƒç”¨è‡ªå·±å°±æ˜¯è°ƒç”¨åŸæ–¹æ³•ï¼‰</span>
    <span class="hljs-selector-attr">[self swizzled_viewDidLoad]</span>;
    
    <span class="hljs-comment">// æ·»åŠ è‡ªå®šä¹‰é€»è¾‘</span>
    <span class="hljs-built_in">NSLog</span>(@"viewDidLoad called for %@", NSStringFromClass([self class]));
}

<span class="hljs-keyword">@end</span>
</code></pre>
<h3 data-id="heading-11">2. åŠ¨æ€ç‰¹æ€§åº”ç”¨</h3>
<h4 data-id="heading-12">2.1. åŠ¨æ€æ·»åŠ æ–¹æ³•</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">dynamicRun</span>(id self, SEL _cmd) {
    <span class="hljs-selector-tag">NSLog</span>(@<span class="hljs-string">"åŠ¨æ€æ·»åŠ äº† run æ–¹æ³• âœ…"</span>);
}

@<span class="hljs-selector-tag">implementation</span> <span class="hljs-selector-tag">Dog</span>
+ (BOOL)<span class="hljs-selector-tag">resolveInstanceMethod</span>:(SEL)<span class="hljs-selector-tag">sel</span> {
    <span class="hljs-selector-tag">if</span> (sel == <span class="hljs-variable">@selector</span>(run)) {
        <span class="hljs-selector-tag">class_addMethod</span>(self, sel, (IMP)dynamicRun, <span class="hljs-string">"v@:"</span>);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">YES</span>;
    }
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">[super resolveInstanceMethod:sel]</span>;
}
@<span class="hljs-selector-tag">end</span>

<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-selector-tag">Dog</span> *<span class="hljs-selector-tag">d</span> = <span class="hljs-selector-attr">[Dog new]</span>;
<span class="hljs-selector-attr">[d run]</span>; <span class="hljs-comment">// è¾“å‡ºï¼šåŠ¨æ€æ·»åŠ äº† run æ–¹æ³• âœ…</span>
</code></pre>
<p><strong>ğŸ“åº”ç”¨ï¼š</strong>
â€¢	åŠ¨æ€æ¡¥æ¥ï¼ˆæ¯”å¦‚ JS â†” OC äº¤äº’ï¼‰
â€¢	æ¨¡å—åŒ–æ¶æ„ä¸‹çš„å»¶è¿ŸåŠ è½½æ–¹æ³•
â€¢	åŠ¨æ€ç”Ÿæˆä»£ç†ç±» / Mock ç±»
â€¢	åºåˆ—åŒ–æˆ–æ¨¡å‹è‡ªåŠ¨è§£æï¼ˆæ ¹æ®å­—æ®µåŠ¨æ€æ·»åŠ è®¿é—®æ–¹æ³•ï¼‰</p>
<h4 data-id="heading-13">2.2. å…³è”å¯¹è±¡</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">objc_setAssociatedObject</span>(self, <span class="hljs-variable">@selector</span>(name), @<span class="hljs-string">"é½ç”Ÿ"</span>, OBJC_ASSOCIATION_COPY_NONATOMIC);
<span class="hljs-selector-tag">NSString</span> *<span class="hljs-selector-tag">name</span> = <span class="hljs-selector-tag">objc_getAssociatedObject</span>(self, <span class="hljs-variable">@selector</span>(name));
</code></pre>
<p><strong>ğŸ“åº”ç”¨ï¼š</strong>
â€¢	åœ¨ Category ä¸­ã€Œæ¨¡æ‹Ÿæ·»åŠ å±æ€§ã€
â€¢	é™„åŠ å…ƒæ•°æ®ï¼ˆç¼“å­˜ã€tagã€çŠ¶æ€ï¼‰
â€¢	æ›¿ä»£ç»§æ‰¿å®ç°æ‰©å±•</p>
<h4 data-id="heading-14">2.3. åŠ¨æ€åˆ›å»ºç±»</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Class</span> <span class="hljs-selector-tag">MyClass</span> = <span class="hljs-selector-tag">objc_allocateClassPair</span>([NSObject class], <span class="hljs-string">"MyDynamicClass"</span>, <span class="hljs-number">0</span>);
<span class="hljs-selector-tag">class_addMethod</span>(MyClass, <span class="hljs-variable">@selector</span>(sayHi), (IMP)sayHiIMP, <span class="hljs-string">"v@:"</span>);
<span class="hljs-selector-tag">objc_registerClassPair</span>(MyClass);
<span class="hljs-selector-tag">id</span> <span class="hljs-selector-tag">obj</span> = <span class="hljs-selector-attr">[[MyClass alloc]</span> <span class="hljs-selector-tag">init</span>];
<span class="hljs-selector-attr">[obj performSelector:@selector(sayHi)]</span>;
</code></pre>
<p><strong>ğŸ“åº”ç”¨ï¼š</strong></p>
<ol>
<li>Runtime è‡ªåŠ¨ç”Ÿæˆ model</li>
<li>Mock æµ‹è¯•</li>
<li>åŠ¨æ€ä»£ç†
<ul>
<li><strong>å«ä¹‰</strong>ï¼šåœ¨è¿è¡Œæ—¶æŠŠæ¶ˆæ¯è½¬å‘ç»™å¦ä¸€ä¸ªå¯¹è±¡æ¥å¤„ç†ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-15">3. Category è§£æ</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// Category çš„æ•°æ®ç»“æ„</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">category_t</span> {
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *name;                    <span class="hljs-comment">// ç±»å</span>
    <span class="hljs-type">classref_t</span> cls;                      <span class="hljs-comment">// ç±»å¯¹è±¡</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">method_list_t</span> *instanceMethods; <span class="hljs-comment">// å®ä¾‹æ–¹æ³•åˆ—è¡¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">method_list_t</span> *classMethods;    <span class="hljs-comment">// ç±»æ–¹æ³•åˆ—è¡¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">protocol_list_t</span> *protocols;     <span class="hljs-comment">// åè®®åˆ—è¡¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">property_list_t</span> *instanceProperties; <span class="hljs-comment">// å±æ€§åˆ—è¡¨</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">property_list_t</span> *_classProperties;   <span class="hljs-comment">// ç±»å±æ€§åˆ—è¡¨</span>
};

<span class="hljs-comment">// Category åŠ è½½è¿‡ç¨‹</span>
<span class="hljs-number">1.</span> ç¼–è¯‘æ—¶ï¼šCategory è¢«ç¼–è¯‘æˆ <span class="hljs-type">category_t</span> ç»“æ„ä½“
<span class="hljs-number">2.</span> è¿è¡Œæ—¶ï¼šé€šè¿‡ Runtime åŠ è½½åˆ°ç±»å¯¹è±¡ä¸­
<span class="hljs-number">3.</span> åˆå¹¶ï¼šCategory çš„æ–¹æ³•ã€å±æ€§ã€åè®®åˆå¹¶åˆ°ç±»çš„ rw æ•°æ®ä¸­
</code></pre>
<p><strong>å¤šä¸ª <code>Category</code> çš„åŠ è½½é¡ºåºï¼Ÿ</strong></p>
<ol>
<li>ç¼–è¯‘é¡ºåºå†³å®šåŠ è½½é¡ºåº</li>
<li>åç¼–è¯‘çš„ Category æ–¹æ³•ä¼š"è¦†ç›–"å…ˆç¼–è¯‘çš„</li>
<li>å®é™…ä¸Šæ˜¯æ’å…¥åˆ°æ–¹æ³•åˆ—è¡¨å‰é¢ï¼Œä¼˜å…ˆè¢«æŸ¥æ‰¾åˆ°</li>
</ol>
<p><strong><code>+load</code> æ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Ÿ</strong></p>
<ol>
<li>å…ˆè°ƒç”¨ç±»çš„ <code>+load</code> æ–¹æ³•ï¼ˆæŒ‰ç»§æ‰¿å…³ç³»ï¼Œçˆ¶ç±»ä¼˜å…ˆï¼‰</li>
<li>å†è°ƒç”¨ <code>Category</code> çš„ <code>+load</code> æ–¹æ³•ï¼ˆæŒ‰ç¼–è¯‘é¡ºåºï¼‰</li>
<li>æ¯ä¸ª <code>+load</code> æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</li>
</ol>
<p><strong><code>+initialize</code> æ–¹æ³•çš„è°ƒç”¨é¡ºåºï¼Ÿ</strong></p>
<ol>
<li>ç±»ç¬¬ä¸€æ¬¡æ¥æ”¶æ¶ˆæ¯æ—¶è°ƒç”¨</li>
<li>æŒ‰ç»§æ‰¿å…³ç³»è°ƒç”¨ï¼Œçˆ¶ç±»ä¼˜å…ˆ</li>
<li>Category çš„ <code>+initialize</code> ä¼š"è¦†ç›–"ç±»çš„ <code>+initialize</code></li>
</ol>
<h4 data-id="heading-16">Category vs Extension</h4>








































<table><thead><tr><th/><th>Category</th><th>Extension</th></tr></thead><tbody><tr><td>å®šä¹‰ä½ç½®</td><td>ä»»æ„æ–‡ä»¶</td><td>å¿…é¡»å’Œç±»çš„å£°æ˜åœ¨åŒä¸€ä¸ªç¼–è¯‘å•å…ƒ(.m)</td></tr><tr><td>æ—¶æœº</td><td>è¿è¡Œæ—¶åŠ è½½</td><td>ç¼–è¯‘å™¨æœŸå¤„ç†</td></tr><tr><td>æ€§èƒ½</td><td>ä¸å¦‚ <code>Extension</code></td><td>å¥½ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æœŸåˆå¹¶ï¼Œä¸éœ€è¦<code>runtime</code>æ³¨å†Œ</td></tr><tr><td>æ˜¯å¦èƒ½æ·»åŠ æˆå‘˜å˜é‡</td><td>âŒ ä¸è¡Œ</td><td>âœ… å¯ä»¥</td></tr><tr><td>æ˜¯å¦èƒ½é‡å†™åŸæ–¹æ³•</td><td>âœ… å¯ä»¥ï¼Œä½†å®¹æ˜“å¼•å‘å†²çª</td><td>âœ… å¯ä»¥</td></tr><tr><td>åº”ç”¨åœºæ™¯</td><td>æ·»åŠ æ–¹æ³•ã€æ‹†åˆ†ç±»å®ç°ã€mockç³»ç»Ÿç±»</td><td>å£°æ˜ç§æœ‰å±æ€§</td></tr></tbody></table>
<p><strong><code>Category</code> å¯ä»¥æ·»åŠ å®ä¾‹å˜é‡å—ï¼Ÿ</strong></p>
<ul>
<li>ä¸è¡ŒğŸ™…ï¼Œå› ä¸ºç±»ç»“æ„ï¼ˆ<code>class_ro_t</code>ï¼‰å·²ç»åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œ<code>runtime</code> åŠ¨æ€åŠ è½½<code>Category</code>æ—¶æ— æ³•ä¿®æ”¹å¯¹è±¡çš„å†…å­˜å¸ƒå±€ã€‚</li>
</ul>
<p><code>Category</code>ä¸­å¯ä»¥æ·»åŠ å±æ€§å—ï¼Ÿ</p>
<ul>
<li>å¯ä»¥âœ…ï¼Œå¯ä»¥å£°æ˜ï¼Œå¹¶é€šè¿‡å…³è”å¯¹è±¡æ¥å®ç°ã€‚</li>
</ul>
<h3 data-id="heading-17">4. KVO å®ç°åŸç†</h3>
<h4 data-id="heading-18">4.1. KVO çš„ isa-swizzling æœºåˆ¶</h4>
<p><strong>å®ç°åŸç†</strong>ï¼š</p>
<ol>
<li>åŠ¨æ€åˆ›å»ºå­ç±»</li>
<li>ä¿®æ”¹å¯¹è±¡çš„ isa æŒ‡é’ˆï¼ŒæŒ‡å‘æ–°å­ç±»</li>
<li>é‡å†™å­ç±»çš„ setterï¼Œæ·»åŠ é€šçŸ¥é€»è¾‘</li>
<li>é‡å†™ class æ–¹æ³•ï¼Œè¿”å›åŸå§‹ç±»</li>
</ol>

<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> KVO å­ç±»çš„æ–¹æ³•å®ç°ä¼ªä»£ç </span>
- (<span class="hljs-keyword">void</span>)setProperty:(id)<span class="hljs-keyword">value</span> {
    [<span class="hljs-meta">self willChangeValueForKey:@<span class="hljs-string">"property"</span></span>];
    [<span class="hljs-meta">super setProperty:value</span>];  <span class="hljs-comment">// è°ƒç”¨åŸå§‹å®ç°</span>
    [<span class="hljs-meta">self didChangeValueForKey:@<span class="hljs-string">"property"</span></span>];
}

- (Class)<span class="hljs-keyword">class</span> {
    <span class="hljs-keyword">return</span> [OriginalClass <span class="hljs-keyword">class</span>];  <span class="hljs-comment">// éšè—å­ç±»çš„å­˜åœ¨</span>
}

- (<span class="hljs-keyword">void</span>)dealloc {
    <span class="hljs-comment">// æ¸…ç† KVO ç›¸å…³èµ„æº</span>
    [<span class="hljs-meta">super dealloc</span>];
}
</code></pre>
<h4 data-id="heading-19">ç›¸ä¼¼åè¯ <code>KVC</code></h4>
<p><strong>å®šä¹‰</strong>ï¼šé€šè¿‡ <strong>å­—ç¬¦ä¸²é”®å(key)</strong> è®¿é—®å¯¹è±¡å±æ€§çš„æœºåˆ¶ã€‚</p>
<p><strong>åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>ç›´æ¥è®¿é—®å±æ€§ï¼Œä¸ç»è¿‡ setter/getterã€‚</li>
<li>å¯ä»¥é€šè¿‡ <code>keyPath</code> è®¿é—®åµŒå¥—å¯¹è±¡ã€‚</li>
<li>æ”¯æŒå­—å…¸ä¸æ¨¡å‹çš„åŠ¨æ€æ˜ å°„ï¼ˆJSON -&gt; Modelï¼‰ã€‚</li>
</ul>
<p><strong>æµç¨‹</strong>ï¼šå½“è°ƒç”¨ <code>[person setValue:@"é½ç”Ÿ" forKey:@"name"];</code></p>
<ol>
<li>æŸ¥æ‰¾ setter æ–¹æ³•</li>
<li>å¦‚æœæ²¡æœ‰ setterï¼ŒæŸ¥çœ‹æœ‰æ— æˆå‘˜å˜é‡<code>_name</code>ã€<code>_isName</code>ã€<code>name</code>ã€<code>isName</code>ã€‚</li>
<li>å¦‚æœæ²¡æœ‰ç›¸ä¼¼æˆå‘˜å˜é‡ï¼Œè°ƒç”¨<code> - (void)setValue:forUndefinedKey:</code> æŠ›å¼‚å¸¸æˆ–è‡ªå®šä¹‰å¤„ç†ã€‚</li>
</ol>
<p><strong>æ³¨æ„âš ï¸</strong>ï¼š</p>
<ul>
<li>KVC ä¼šç»•è¿‡å°è£…ï¼Œç›´æ¥è®¿é—® ivarï¼Œè¿åå°è£…æ€§</li>
<li>å¯ç”¨äºâ€œåŠ¨æ€èµ‹å€¼â€ã€â€œç§æœ‰å±æ€§è®¿é—®â€ç­‰</li>
</ul>
<h3 data-id="heading-20">åº”ç”¨åœºæ™¯</h3>
<ol>
<li>JSON è½¬ Modelï¼ˆå±æ€§éå†ã€KVCï¼‰</li>
<li>æ–¹æ³•è€—æ—¶ç»Ÿè®¡ï¼ˆæ–¹æ³•äº¤æ¢ï¼‰</li>
<li>ç®€å•çš„ AOP (é¢å‘åˆ‡é¢ç¼–ç¨‹) æ¡†æ¶ï¼ˆNSInvocationã€å…³è”å¯¹è±¡ã€Around Adviceï¼‰</li>
</ol>
<h4 data-id="heading-21">å…³è”çŸ¥è¯†ç‚¹ <code>AOP</code> (é¢å‘åˆ‡é¢ç¼–ç¨‹)</h4>
<p><strong>å«ä¹‰</strong>ï¼šä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œèƒ½å¤Ÿåœ¨ã€Œä¸æ”¹åŠ¨åŸæœ‰ä»£ç é€»è¾‘ã€çš„å‰æä¸‹ï¼Œåœ¨æŒ‡å®šçš„â€œåˆ‡é¢ç‚¹â€ä¸Šæ’å…¥é¢å¤–é€»è¾‘ï¼ˆå¦‚åŸ‹ç‚¹ã€æ—¥å¿—ã€ç›‘æ§ã€æƒé™æ ¡éªŒç­‰ï¼‰ã€‚</p>

























<table><thead><tr><th>æ ¸å¿ƒæ¦‚å¿µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>åˆ‡ç‚¹ï¼ˆPointcutï¼‰</td><td>æƒ³â€œåˆ‡å…¥â€çš„ä½ç½®ï¼Œæ¯”å¦‚æ–¹æ³•è°ƒç”¨å‰/å</td></tr><tr><td>é€šçŸ¥ï¼ˆAdviceï¼‰</td><td>åœ¨åˆ‡ç‚¹æ‰§è¡Œçš„é¢å¤–é€»è¾‘ï¼ˆbeforeã€afterã€aroundï¼‰</td></tr><tr><td>åˆ‡é¢ï¼ˆAspectï¼‰</td><td>åˆ‡ç‚¹ + é€šçŸ¥ çš„ç»„åˆ</td></tr><tr><td>ç»‡å…¥ï¼ˆWeavingï¼‰</td><td>æŠŠè¿™äº›é€»è¾‘åŠ¨æ€æ’å…¥ä»£ç æ‰§è¡Œæµç¨‹çš„è¿‡ç¨‹</td></tr></tbody></table>
<p><strong>iOS å®ç° AOP çš„æ–¹æ³•</strong></p>
<ol>
<li>æ–¹æ³•äº¤æ¢ï¼šåœ¨äº¤æ¢æ–¹æ³•ä¸­å®ç°æ–°çš„é€»è¾‘</li>
<li>æ¶ˆæ¯è½¬å‘ï¼šåˆ©ç”¨ <code>forwardInvocation:</code> æˆ– <code>resolveInstanceMethod:</code>
åœ¨è¿è¡Œæ—¶æ‹¦æˆªæ¶ˆæ¯ï¼Œå†â€œè½¬å‘â€åˆ°è‡ªå·±çš„å¤„ç†é€»è¾‘ã€‚</li>
<li>ä¸‰æ–¹åº“ï¼šAspects</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain1.0æ™ºèƒ½ä½“å¼€å‘ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)]]></title>    <link>https://juejin.cn/post/7571840220703162414</link>    <guid>https://juejin.cn/post/7571840220703162414</guid>    <pubDate>2025-11-13T04:29:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571840220703162414" data-draft-id="7571747061385920531" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain1.0æ™ºèƒ½ä½“å¼€å‘ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)"/> <meta itemprop="keywords" content="Agent,LangChain,Python"/> <meta itemprop="datePublished" content="2025-11-13T04:29:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FreeCode"/> <meta itemprop="url" content="https://juejin.cn/user/1282499717900794"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain1.0æ™ºèƒ½ä½“å¼€å‘ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1282499717900794/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FreeCode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T04:29:39.000Z" title="Thu Nov 13 2025 04:29:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><blockquote>
<p>æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)æ˜¯ä¸€ç§å¸¸è§çš„æ™ºèƒ½ä½“åº”ç”¨ã€‚é˜…è¯»æœ¬æ–‡æ‚¨å°†è·å¾—ï¼š</p>
<ul>
<li>æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)åŸºç¡€çŸ¥è¯†</li>
<li>LangChainå®ç°RAGçš„ç¯å¢ƒæ­å»º</li>
<li>LangChainå¦‚ä½•æ„å»ºç´¢å¼•</li>
<li>LangChainå®ç°Agentic RAG</li>
<li>LangChainå®ç°Two-Step RAG</li>
<li>å¤šç§æ¶æ„çš„RAGçš„ç‰¹ç‚¹åŠé€‚ç”¨åœºæ™¯</li>
</ul>
</blockquote>
<h2 data-id="heading-0">1ã€æ¦‚è¿°</h2>
<p>å¤§æ¨¡å‹èµ‹èƒ½çš„æœ€å¼ºå¤§åº”ç”¨ä¹‹ä¸€ï¼Œä¾¿æ˜¯åŠŸèƒ½å®Œå–„çš„é—®ç­”ï¼ˆQ&amp;Aï¼‰èŠå¤©æœºå™¨äººã€‚è¿™ç±»åº”ç”¨èƒ½å¤Ÿé’ˆå¯¹ç‰¹å®šæ¥æºçš„ä¿¡æ¯å›ç­”é—®é¢˜ï¼Œå…¶æ ¸å¿ƒæŠ€æœ¯æ˜¯æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval Augmented Generationï¼Œç®€ç§° RAGï¼‰ã€‚<br/>
æœ¬æ–‡å°†å±•ç¤ºå¦‚ä½•åŸºäºéç»“æ„åŒ–æ–‡æœ¬æ•°æ®æºæ„å»ºä¸€ä¸ªç®€æ˜“çš„é—®ç­”åº”ç”¨ï¼Œå¹¶æ¼”ç¤ºä»¥ä¸‹ä¸¤ç§å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>Agentic RAGï¼šé€šè¿‡å·¥å…·æ‰§è¡Œæœç´¢çš„RAGæ™ºèƒ½ä½“ï¼Œè¿™æ˜¯ä¸€ç§é€šç”¨æ€§è¾ƒå¼ºçš„å®ç°æ–¹æ¡ˆã€‚</li>
<li>Two-Step RAGï¼šæ¯æ¬¡æŸ¥è¯¢ä»…éœ€è°ƒç”¨ä¸€æ¬¡å¤§æ¨¡å‹çš„ä¸¤æ­¥å¼RAGé“¾ï¼Œè¯¥æ–¹æ¡ˆé€Ÿåº¦å¿«ã€æ•ˆæœå¥½ï¼Œé€‚ç”¨äºå¤„ç†ç®€å•æŸ¥è¯¢ã€‚</li>
</ul>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<ul>
<li>ç´¢å¼•æ„å»ºï¼ˆIndexingï¼‰ï¼šä»æ•°æ®æºè·å–æ•°æ®å¹¶ä¸ºå…¶åˆ›å»ºç´¢å¼•çš„æµç¨‹ï¼Œè¯¥æµç¨‹é€šå¸¸åœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡Œã€‚</li>
<li>æ£€ç´¢ä¸ç”Ÿæˆï¼ˆRetrieval and generationï¼‰ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰çš„å®é™…æ‰§è¡Œè¿‡ç¨‹ï¼Œåœ¨è¿è¡Œæ—¶æ¥æ”¶ç”¨æˆ·æŸ¥è¯¢ï¼Œä»ç´¢å¼•ä¸­æ£€ç´¢ç›¸å…³æ•°æ®ï¼Œå†å°†è¿™äº›æ•°æ®ä¼ é€’ç»™æ¨¡å‹ã€‚å®Œæˆæ•°æ®ç´¢å¼•æ„å»ºåï¼Œæˆ‘ä»¬å°†ä»¥æ™ºèƒ½ä½“ä½œä¸ºä»»åŠ¡ç¼–æ’æ¡†æ¶ï¼Œå®ç°æ£€ç´¢ä¸ç”Ÿæˆæ­¥éª¤ã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 åº”ç”¨åœºæ™¯</h3>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªèƒ½å¤Ÿé’ˆå¯¹æŸç½‘ç«™å†…å®¹å›ç­”é—®é¢˜çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†ä½¿ç”¨çš„ç‰¹å®šç½‘ç«™æ˜¯ Lilian Weng æ’°å†™çš„ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Flilianweng.github.io%2Fposts%2F2023-06-23-agent%2F" target="_blank" title="https://lilianweng.github.io/posts/2023-06-23-agent/" ref="nofollow noopener noreferrer">LLM Powered Autonomous Agents</a>ã€‹åšå®¢æ–‡ç« ã€‚é€šè¿‡è¿™ä¸ªåº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°±è¯¥åšå®¢æ–‡ç« çš„å†…å®¹æå‡ºé—®é¢˜å¹¶è·å¾—è§£ç­”ã€‚
æˆ‘ä»¬åªéœ€çº¦40è¡Œä»£ç ï¼Œå°±èƒ½åˆ›å»ºä¸€ä¸ªç®€æ˜“çš„ç´¢å¼•æ„å»ºæµç¨‹å’Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰é“¾æ¥å®ç°ä¸Šè¿°åŠŸèƒ½ã€‚å®Œæ•´ä»£ç è§ç¬¬4.1éƒ¨åˆ†å’Œ4.2éƒ¨åˆ†ã€‚</p>
<h2 data-id="heading-3">2ã€ç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-4">2.1 å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">pip install langchain langchain-text-splitters langchain-community bs4
</code></pre>
<h3 data-id="heading-5">2.2 LangSmith</h3>
<p>ä½¿ç”¨LangChainæ„å»ºçš„è®¸å¤šåº”ç”¨ç¨‹åºï¼Œéƒ½ä¼šåŒ…å«å¤šä¸ªæ­¥éª¤ï¼Œä¸”è¿™äº›æ­¥éª¤ä¸­ä¼šå¤šæ¬¡è°ƒç”¨å¤§æ¨¡å‹ã€‚éšç€è¿™äº›åº”ç”¨ç¨‹åºå¤æ‚åº¦çš„æå‡ï¼Œèƒ½å¤ŸæŸ¥çœ‹æ™ºèƒ½ä½“å†…éƒ¨å…·ä½“çš„è¿è¡Œæƒ…å†µï¼Œä¼šå˜å¾—è‡³å…³é‡è¦ã€‚è€Œå®ç°è¿™ä¸€éœ€æ±‚çš„æœ€ä½³æ–¹å¼ï¼Œå°±æ˜¯å€ŸåŠ©LangSmithå·¥å…·ã€‚åœ¨æ³¨å†ŒLangSmithè´¦å·åï¼Œå¯ä»¥è®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡ï¼Œä»¥å¼€å¯è¿½è¸ªæ—¥å¿—è®°å½•åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os

os.environ[<span class="hljs-string">"LANGSMITH_TRACING"</span>] = <span class="hljs-string">"true"</span>
os.environ[<span class="hljs-string">"LANGSMITH_API_KEY"</span>] = <span class="hljs-string">"your-langsmith-api-key"</span>
</code></pre>
<h3 data-id="heading-6">2.3 ç»„ä»¶</h3>
<p>æˆ‘ä»¬éœ€è¦ä»LangChainçš„é›†æˆç»„ä»¶é›†ä¸­é€‰æ‹©ä¸‰ä¸ªç»„ä»¶ã€‚</p>
<ul>
<li>é€‰æ‹©ä¸€ä¸ªèŠå¤©æ¨¡å‹ï¼šæœ¬æ–‡ä½¿ç”¨Qwen/Qwen3-8Bæ¨¡å‹ï¼Œç”±ç¡…åŸºæµåŠ¨æä¾›çš„OpenAIæ¥å£ã€‚</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">pip install -U <span class="hljs-string">"langchain-openai"</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_modeldef init_model():
model = init_chat_model(api_key = api_key,base_url = api_base,model = <span class="hljs-string">"Qwen/Qwen3-8B"</span>,model_provider = <span class="hljs-string">"openai"</span>,temperature = <span class="hljs-number">0.7</span>,)
</code></pre>
<ul>
<li>é€‰æ‹©ä¸€ä¸ªåµŒå…¥æ¨¡å‹ï¼šæœ¬æ–‡ä½¿ç”¨BAAI/bge-m3æ¨¡å‹ï¼Œç”±ç¡…åŸºæµåŠ¨æä¾›çš„OpenAIæ¥å£ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"BAAI/bge-m3"</span>, api_key=api_key, base_url=api_base)
</code></pre>
<ul>
<li>é€‰æ‹©ä¸€ä¸ªå‘é‡å­˜å‚¨ï¼ˆæ•°æ®åº“ï¼‰ï¼šæœ¬æ–‡ä½¿ç”¨å†…å­˜å‘é‡å­˜å‚¨ã€‚</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">pip install -U <span class="hljs-string">"langchain-core"</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.vectorstores <span class="hljs-keyword">import</span> InMemoryVectorStore
vector_store = InMemoryVectorStore(embeddings)
</code></pre>
<h2 data-id="heading-7">3ã€æ„å»ºç´¢å¼•</h2>
<p>ç´¢å¼•æ„å»ºçš„å¸¸è§æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŠ è½½ï¼ˆLoadï¼‰ï¼šé¦–å…ˆéœ€è¦åŠ è½½æ•°æ®ï¼Œè¿™ä¸€æ­¥é€šè¿‡æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocument Loadersï¼‰å®Œæˆã€‚</li>
<li>åˆ†å‰²ï¼ˆSplitï¼‰ï¼šæ–‡æœ¬åˆ†å‰²å™¨ï¼ˆText splittersï¼‰å°†å¤§å‹æ–‡æ¡£ï¼ˆDocumentsï¼‰æ‹†åˆ†ä¸ºæ›´å°çš„æ–‡æœ¬å—ï¼ˆchunksï¼‰ã€‚è¿™ä¸€æ­¥å¯¹æ•°æ®ç´¢å¼•æ„å»ºå’Œå°†æ•°æ®ä¼ å…¥æ¨¡å‹å‡æœ‰å¸®åŠ© â€”â€” å› ä¸ºå¤§å‹æ–‡æœ¬å—ä¸ä»…éš¾ä»¥æ£€ç´¢ï¼Œè¿˜æ— æ³•é€‚é…æ¨¡å‹æœ‰é™çš„ä¸Šä¸‹æ–‡çª—å£ã€‚</li>
<li>å­˜å‚¨ï¼ˆStoreï¼‰ï¼šéœ€è¦ä¸€ä¸ªä½ç½®æ¥å­˜å‚¨å’Œç´¢å¼•è¿™äº›åˆ†å‰²åçš„æ–‡æœ¬å—ï¼Œä»¥ä¾¿åç»­è¿›è¡Œæ£€ç´¢ã€‚è¿™ä¸€æ­¥é€šå¸¸é€šè¿‡å‘é‡å­˜å‚¨ï¼ˆVectorStoreï¼‰å’ŒåµŒå…¥æ¨¡å‹ï¼ˆEmbeddings modelï¼‰å®ç°ã€‚</li>
</ul>
<h3 data-id="heading-8">3.1 åŠ è½½æ–‡æ¡£</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½è¯¥åšå®¢æ–‡ç« çš„å†…å®¹ã€‚è¿™ä¸€æ­¥å¯ä»¥å€ŸåŠ©æ–‡æ¡£åŠ è½½å™¨ï¼ˆDocumentLoadersï¼‰å®Œæˆã€‚æ–‡æ¡£åŠ è½½å™¨æ˜¯ä¸€ç±»èƒ½ä»æ•°æ®æºè¯»å–æ•°æ®ï¼Œå¹¶è¿”å›æ–‡æ¡£å¯¹è±¡ï¼ˆDocument objectsï¼‰åˆ—è¡¨çš„ç»„ä»¶ã€‚
æœ¬æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç½‘ç»œåŸºç¡€åŠ è½½å™¨ï¼ˆWebBaseLoaderï¼‰ã€‚è¯¥åŠ è½½å™¨é€šè¿‡urllibåº“ä»ç½‘é¡µé“¾æ¥ï¼ˆURLï¼‰åŠ è½½ HTML å†…å®¹ï¼Œå¹¶å€ŸåŠ©BeautifulSoupåº“å°† HTML è§£æä¸ºçº¯æ–‡æœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡bs_kwargså‚æ•°å‘BeautifulSoupè§£æå™¨ä¼ å…¥é…ç½®ï¼Œä»è€Œè‡ªå®šä¹‰HTMLè½¬æ–‡æœ¬çš„è§£æè§„åˆ™ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œä»…åŒ…å« â€œpost-contentâ€â€œpost-titleâ€ æˆ– â€œpost-headerâ€ ç±»çš„HTMLæ ‡ç­¾æ˜¯ç›¸å…³çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¼šç§»é™¤æ‰€æœ‰å…¶ä»–æ ‡ç­¾ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> bs4
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> WebBaseLoader

<span class="hljs-comment"># Only keep post title, headers, and content from the full HTML.</span>
bs4_strainer = bs4.SoupStrainer(class_=(<span class="hljs-string">"post-title"</span>, <span class="hljs-string">"post-header"</span>, <span class="hljs-string">"post-content"</span>))
loader = WebBaseLoader(
    web_paths=(<span class="hljs-string">"https://lilianweng.github.io/posts/2023-06-23-agent/"</span>,),
    bs_kwargs={<span class="hljs-string">"parse_only"</span>: bs4_strainer},
)
docs = loader.load()

<span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(docs) == <span class="hljs-number">1</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Total characters: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(docs[<span class="hljs-number">0</span>].page_content)}</span>"</span>)
</code></pre>
<h3 data-id="heading-9">3.2 åˆ†å‰²æ–‡æ¡£</h3>
<p>æˆ‘ä»¬åŠ è½½çš„æ–‡æ¡£å­—ç¬¦æ•°è¶…è¿‡4.2ä¸‡ï¼Œå¯¹äºè®¸å¤šæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£è€Œè¨€ï¼Œè¿™ä¸ªé•¿åº¦è¿‡é•¿ï¼Œæ— æ³•å®Œæ•´å®¹çº³ã€‚å³ä¾¿æŸäº›æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£èƒ½è£…ä¸‹æ•´ç¯‡åšæ–‡ï¼Œæ¨¡å‹åœ¨å¤„ç†æé•¿è¾“å…¥æ—¶ï¼Œä¹Ÿéš¾ä»¥ä»ä¸­ç²¾å‡†å®šä½æ‰€éœ€ä¿¡æ¯ã€‚
ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šå°†è¯¥æ–‡æ¡£åˆ†å‰²æˆå¤šä¸ªæ–‡æœ¬å—ï¼Œä»¥ä¾¿è¿›è¡ŒåµŒå…¥å¤„ç†å’Œå‘é‡å­˜å‚¨ã€‚è¿™æ ·åšæœ‰åŠ©äºæˆ‘ä»¬åœ¨è¿è¡Œæ—¶ï¼Œä»…æ£€ç´¢å‡ºåšæ–‡ä¸­ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„éƒ¨åˆ†å†…å®¹ã€‚
æˆ‘ä»¬å°†ä½¿ç”¨<code>RecursiveCharacterTextSplitter</code>ï¼ˆé€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨ï¼‰ã€‚è¯¥åˆ†å‰²å™¨ä¼šä½¿ç”¨æ¢è¡Œç¬¦ç­‰å¸¸è§åˆ†éš”ç¬¦ï¼Œå¯¹æ–‡æ¡£è¿›è¡Œé€’å½’åˆ†å‰²ï¼Œç›´åˆ°æ¯ä¸ªæ–‡æœ¬å—çš„å¤§å°è¾¾åˆ°åˆé€‚èŒƒå›´ã€‚å¯¹äºé€šç”¨æ–‡æœ¬åœºæ™¯ï¼Œè¿™æ˜¯æ¨èä½¿ç”¨çš„æ–‡æœ¬åˆ†å‰²å™¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter

text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=<span class="hljs-number">1000</span>,  <span class="hljs-comment"># chunk size (characters)</span>
    chunk_overlap=<span class="hljs-number">200</span>,  <span class="hljs-comment"># chunk overlap (characters)</span>
    add_start_index=<span class="hljs-literal">True</span>,  <span class="hljs-comment"># track index in original document</span>
)
all_splits = text_splitter.split_documents(docs)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Split blog post into <span class="hljs-subst">{<span class="hljs-built_in">len</span>(all_splits)}</span> sub-documents."</span>)
</code></pre>
<h3 data-id="heading-10">3.3 å­˜å‚¨æ–‡æ¡£</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè¿™äº›åˆ†å‰²åçš„æ–‡æœ¬å—å»ºç«‹ç´¢å¼•ï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶å¯¹å®ƒä»¬è¿›è¡Œæ£€ç´¢ã€‚æ„å»ºæ€è·¯æ˜¯ï¼šå¯¹æ¯ä¸ªåˆ†å‰²åçš„æ–‡æ¡£å†…å®¹è¿›è¡ŒåµŒå…¥å¤„ç†ï¼Œç„¶åå°†ç”Ÿæˆçš„åµŒå…¥å‘é‡å­˜å…¥å‘é‡å­˜å‚¨ï¼ˆæ•°æ®åº“ï¼‰ã€‚å½“æ¥æ”¶åˆ°è¾“å…¥æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡å‘é‡æœç´¢æ¥æ£€ç´¢ç›¸å…³æ–‡æ¡£ã€‚
å€ŸåŠ©2.3èŠ‚æ‰€é€‰çš„å‘é‡å­˜å‚¨å’ŒåµŒå…¥æ¨¡å‹ï¼Œæˆ‘ä»¬åªéœ€ä¸€æ¡å‘½ä»¤ï¼Œå³å¯å®Œæˆæ‰€æœ‰åˆ†å‰²åæ–‡æ¡£çš„åµŒå…¥å¤„ç†ä¸å­˜å‚¨æ“ä½œã€‚</p>
<pre><code class="hljs language-python" lang="python">document_ids = vector_store.add_documents(documents=all_splits)

<span class="hljs-built_in">print</span>(document_ids[:<span class="hljs-number">3</span>])
</code></pre>
<p>è‡³æ­¤ï¼Œæµç¨‹ä¸­çš„ç´¢å¼•æ„å»ºéƒ¨åˆ†å·²å®Œæˆã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ªå¯æŸ¥è¯¢çš„å‘é‡å­˜å‚¨ï¼ˆvector_storeï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†æˆ‘ä»¬å°†åšå®¢æ–‡ç« åˆ†å‰²åå¾—åˆ°çš„æ–‡æœ¬å—å†…å®¹ã€‚å½“æ¥æ”¶åˆ°ç”¨æˆ·çš„é—®é¢˜æ—¶ï¼Œç†è®ºä¸Šæˆ‘ä»¬åº”å½“èƒ½å¤Ÿè¿”å›è¯¥åšå®¢æ–‡ç« ä¸­å¯è§£ç­”æ­¤é—®é¢˜çš„ç‰‡æ®µã€‚</p>
<h2 data-id="heading-11">4ã€æ£€ç´¢ä¸ç”Ÿæˆ</h2>
<p>æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰åº”ç”¨çš„å·¥ä½œæµç¨‹é€šå¸¸å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ£€ç´¢ï¼ˆRetrieveï¼‰ï¼šæ¥æ”¶ç”¨æˆ·è¾“å…¥åï¼Œé€šè¿‡æ£€ç´¢å™¨ï¼ˆRetrieverï¼‰ä»å­˜å‚¨ç³»ç»Ÿä¸­æ£€ç´¢å‡ºç›¸å…³çš„æ–‡æœ¬å—ã€‚</li>
<li>ç”Ÿæˆï¼ˆGenerateï¼‰ï¼šæ¨¡å‹ä»¥åŒ…å« â€œç”¨æˆ·é—®é¢˜â€ å’Œ â€œæ£€ç´¢åˆ°çš„æ•°æ®â€ çš„æç¤ºè¯ä¸ºè¾“å…¥ï¼Œç”Ÿæˆå¯¹åº”çš„å›ç­”ã€‚</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬æ¥ç¼–å†™å®é™…çš„åº”ç”¨ç¨‹åºé€»è¾‘ã€‚æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªç®€æ˜“åº”ç”¨ï¼Œè¯¥åº”ç”¨èƒ½æ¥æ”¶ç”¨æˆ·çš„é—®é¢˜ï¼Œæœç´¢ä¸è¯¥é—®é¢˜ç›¸å…³çš„æ–‡æ¡£ï¼Œå°†æ£€ç´¢åˆ°çš„æ–‡æ¡£å’Œåˆå§‹é—®é¢˜ä¼ é€’ç»™æ¨¡å‹ï¼Œç„¶åè¿”å›ç­”æ¡ˆã€‚
æˆ‘ä»¬å°†æ¼”ç¤ºä»¥ä¸‹ä¸¤ç§å®ç°æ¨¡å¼ï¼š</p>
<ul>
<li>Agentic RAGï¼šä¸€ä¸ªå¯é€šè¿‡ç®€æ˜“å·¥å…·æ‰§è¡Œæœç´¢çš„RAGæ™ºèƒ½ä½“ï¼Œè¿™æ˜¯ä¸€ç§é€šç”¨æ€§è¾ƒå¼ºçš„å®ç°æ–¹æ¡ˆã€‚</li>
<li>Two-Step RAGï¼šä¸€ä¸ªæ¯æ¬¡æŸ¥è¯¢ä»…éœ€è°ƒç”¨ä¸€æ¬¡å¤§æ¨¡å‹çš„ä¸¤æ­¥å¼RAGé“¾ï¼Œè¯¥æ–¹æ¡ˆé€Ÿåº¦å¿«ã€æ•ˆæœå¥½ï¼Œé€‚ç”¨äºå¤„ç†ç®€å•æŸ¥è¯¢ã€‚</li>
</ul>
<h3 data-id="heading-12">4.1 Agentic RAG</h3>
<p>RAGåº”ç”¨çš„ä¸€ç§å®ç°æ¨¡å¼ï¼Œæ˜¯å°†å…¶è®¾è®¡ä¸ºä¸€ä¸ªé…å¤‡ä¿¡æ¯æ£€ç´¢å·¥å…·çš„ç®€æ˜“æ™ºèƒ½ä½“ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼€å‘ä¸€ä¸ªå°è£…äº†å‘é‡å­˜å‚¨çš„å·¥å…·ï¼Œæ¥æ„å»ºä¸€ä¸ªåŸºç¡€çš„RAGæ™ºèƒ½ä½“ã€‚<br/>
å®Œæ•´ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-comment"># è®¾ç½®USER_AGENTç¯å¢ƒå˜é‡</span>
os.environ[<span class="hljs-string">"USER_AGENT"</span>] = <span class="hljs-string">"langchain-course-agent"</span>

<span class="hljs-keyword">import</span> bs4
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> WebBaseLoader
<span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter
<span class="hljs-keyword">from</span> langchain_core.vectorstores <span class="hljs-keyword">import</span> InMemoryVectorStore
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> api_key, api_base, langsmith_api_key


<span class="hljs-comment"># åˆå§‹åŒ–LangSmithè¿½è¸ª</span>
os.environ[<span class="hljs-string">"LANGSMITH_TRACING"</span>] = <span class="hljs-string">"true"</span>
os.environ[<span class="hljs-string">"LANGSMITH_API_KEY"</span>] = langsmith_api_key
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡åµŒå…¥æ¨¡å‹</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"BAAI/bge-m3"</span>, api_key=api_key, base_url=api_base)
<span class="hljs-comment"># åˆå§‹åŒ–æ™ºèƒ½ä½“æ¨¡å‹</span>
model = init_chat_model(api_key=api_key, base_url=api_base, model=<span class="hljs-string">"Qwen/Qwen3-8B"</span>, model_provider=<span class="hljs-string">"openai"</span>, temperature=<span class="hljs-number">0.7</span>,)
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡å­˜å‚¨</span>
vector_store = InMemoryVectorStore(embeddings)


<span class="hljs-comment"># åŠ è½½å¹¶ç²—åˆ†åšå®¢æ–‡ç« </span>
loader = WebBaseLoader(
    web_paths=(<span class="hljs-string">"https://lilianweng.github.io/posts/2023-06-23-agent/"</span>,),
    bs_kwargs=<span class="hljs-built_in">dict</span>(parse_only=bs4.SoupStrainer(class_=(<span class="hljs-string">"post-content"</span>, <span class="hljs-string">"post-title"</span>, <span class="hljs-string">"post-header"</span>)))
)
docs = loader.load()

<span class="hljs-comment"># åˆ‡åˆ†æ–‡æ¡£</span>
text_splitter = RecursiveCharacterTextSplitter(chunk_size=<span class="hljs-number">1000</span>, chunk_overlap=<span class="hljs-number">200</span>)
all_splits = text_splitter.split_documents(docs)

<span class="hljs-comment"># ç´¢å¼•æ–‡æœ¬å—</span>
vector_store = InMemoryVectorStore(embeddings)
_ = vector_store.add_documents(documents=all_splits)


<span class="hljs-comment"># æ„å»ºç”¨äºæ£€ç´¢çš„å·¥å…·</span>
<span class="hljs-meta">@tool(<span class="hljs-params">response_format=<span class="hljs-string">"content_and_artifact"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">retrieve_context</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""Retrieve information to help answer a query."""</span>
    retrieved_docs = vector_store.similarity_search(query, k=<span class="hljs-number">2</span>)
    serialized = <span class="hljs-string">"\n\n"</span>.join(
        (<span class="hljs-string">f"Source: <span class="hljs-subst">{doc.metadata}</span>\nContent: <span class="hljs-subst">{doc.page_content}</span>"</span>)
        <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> retrieved_docs
    )
    <span class="hljs-keyword">return</span> serialized, retrieved_docs

<span class="hljs-comment">#å·¥å…·åˆ—è¡¨</span>
tools = [retrieve_context]
<span class="hljs-comment"># ç³»ç»Ÿæç¤ºè¯</span>
prompt = (
    <span class="hljs-string">"You have access to a tool that retrieves context from a blog post. "</span>
    <span class="hljs-string">"Use the tool to help answer user queries."</span>
)
<span class="hljs-comment">#åˆ›å»ºæ™ºèƒ½ä½“</span>
agent = create_agent(model, tools, system_prompt=prompt)
<span class="hljs-comment">#æŸ¥è¯¢</span>
query = (<span class="hljs-string">"What is the standard method for Task Decomposition?\n\n"</span>
    <span class="hljs-string">"Once you get the answer, look up common extensions of that method."</span>)
<span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> agent.stream({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}]},stream_mode=<span class="hljs-string">"values"</span>):
    step[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].pretty_print()
</code></pre>
<p>è¯·æ³¨æ„ï¼Œè¯¥æ™ºèƒ½ä½“çš„æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”ŸæˆæŸ¥è¯¢è¯­å¥ï¼Œä»¥æœç´¢ä»»åŠ¡åˆ†è§£çš„æ ‡å‡†æ–¹æ³•ï¼›</li>
<li>æ¥æ”¶æŸ¥è¯¢ç»“æœåï¼Œç”Ÿæˆç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥ï¼Œä»¥æœç´¢è¯¥æ ‡å‡†æ–¹æ³•çš„å¸¸è§æ‰©å±•å½¢å¼ï¼›</li>
<li>è·å–æ‰€æœ‰å¿…è¦çš„èƒŒæ™¯ä¿¡æ¯åï¼Œå¯¹åŸé—®é¢˜è¿›è¡Œè§£ç­”ã€‚
æˆ‘ä»¬å¯ä»¥åœ¨LangSmithçš„è¿½è¸ªæ—¥å¿—ä¸­æŸ¥çœ‹å®Œæ•´çš„æ­¥éª¤åºåˆ—ï¼Œä»¥åŠå»¶è¿Ÿæ•°æ®å’Œå…¶ä»–å…ƒæ•°æ®ã€‚</li>
</ul>
<h3 data-id="heading-13">4.2 Two-Step RAG</h3>
<p>åœ¨4.1èŠ‚æ™ºèƒ½ä½“é©±åŠ¨å¼RAGçš„å®ç°å½¢å¼ä¸­ï¼Œæˆ‘ä»¬å…è®¸å¤§æ¨¡å‹è‡ªä¸»åˆ¤æ–­æ˜¯å¦ç”Ÿæˆå·¥å…·è°ƒç”¨ï¼Œä»¥è¾…åŠ©è§£ç­”ç”¨æˆ·æŸ¥è¯¢ã€‚è¿™æ˜¯ä¸€ç§ä¸é”™çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›æƒè¡¡å–èˆï¼š</p>





















<table><thead><tr><th>âœ… ä¼˜åŠ¿ï¼ˆBenefitsï¼‰</th><th>âš ï¸ åŠ£åŠ¿ï¼ˆDrawbacksï¼‰</th></tr></thead><tbody><tr><td>æŒ‰éœ€æ£€ç´¢ â€”â€” å¤§æ¨¡å‹å¯å¤„ç†é—®å€™è¯­ã€è¿½é—®åŠç®€å•æŸ¥è¯¢ï¼Œæ— éœ€è§¦å‘ä¸å¿…è¦çš„æ£€ç´¢æ“ä½œã€‚</td><td>ä¸¤æ¬¡æ¨ç†è°ƒç”¨ â€”â€” æ‰§è¡Œæ£€ç´¢æ—¶ï¼Œéœ€è°ƒç”¨ä¸€æ¬¡æ¨¡å‹ç”ŸæˆæŸ¥è¯¢è¯­å¥ï¼Œå†è°ƒç”¨ä¸€æ¬¡ç”Ÿæˆæœ€ç»ˆå›å¤ã€‚</td></tr><tr><td>è¯­å¢ƒåŒ–æ£€ç´¢æŸ¥è¯¢ â€”â€” å°†æ£€ç´¢è§†ä¸ºéœ€è¾“å…¥æŸ¥è¯¢è¯­å¥çš„å·¥å…·ï¼Œå¤§æ¨¡å‹ä¼šç»“åˆå¯¹è¯è¯­å¢ƒè‡ªè¡Œæ„å»ºæ£€ç´¢æŸ¥è¯¢è¯­å¥ã€‚</td><td>å¯æ§æ€§é™ä½ â€”â€” å¤§æ¨¡å‹å¯èƒ½åœ¨å®é™…éœ€è¦æ£€ç´¢æ—¶è·³è¿‡æ£€ç´¢æ­¥éª¤ï¼Œæˆ–åœ¨æ— éœ€æ£€ç´¢æ—¶å‘èµ·å¤šä½™çš„æ£€ç´¢æ“ä½œã€‚</td></tr><tr><td>æ”¯æŒå¤šè½®æ£€ç´¢ â€”â€” é’ˆå¯¹å•ä¸ªç”¨æˆ·æŸ¥è¯¢ï¼Œå¤§æ¨¡å‹å¯æ‰§è¡Œå¤šæ¬¡æ£€ç´¢ä»¥è·å–è¶³å¤Ÿä¿¡æ¯ã€‚</td><td>-</td></tr></tbody></table>
<p>å¦ä¸€ç§å¸¸è§å®ç°æ¨¡å¼æ˜¯ä¸¤æ­¥å¼é“¾ï¼ˆtwo-step chainï¼‰ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä¼šå§‹ç»ˆæ‰§è¡Œæ£€ç´¢æ“ä½œï¼Œå¹¶å°†æ£€ç´¢ç»“æœä½œä¸ºä¸Šä¸‹æ–‡ï¼Œä¼ å…¥å•æ¬¡å¤§æ¨¡å‹æŸ¥è¯¢ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªç”¨æˆ·æŸ¥è¯¢ä»…éœ€ä¸€æ¬¡æ¨ç†è°ƒç”¨ï¼Œä»¥ç‰ºç‰²çµæ´»æ€§ä¸ºä»£ä»·ï¼Œæ¢å–äº†æ›´ä½çš„å»¶è¿Ÿã€‚
åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸å†ä»¥å¾ªç¯æ–¹å¼è°ƒç”¨æ¨¡å‹ï¼Œè€Œæ˜¯ä»…æ‰§è¡Œå•æ¬¡å¤„ç†æµç¨‹ã€‚
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°è¯¥é“¾ï¼šä»æ™ºèƒ½ä½“ä¸­ç§»é™¤å·¥å…·ç»„ä»¶ï¼Œè½¬è€Œå°†æ£€ç´¢æ­¥éª¤æ•´åˆåˆ°è‡ªå®šä¹‰æç¤ºè¯ä¸­ã€‚<br/>
å®Œæ•´ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-comment"># è®¾ç½®USER_AGENTç¯å¢ƒå˜é‡</span>
os.environ[<span class="hljs-string">"USER_AGENT"</span>] = <span class="hljs-string">"langchain-course-agent"</span>

<span class="hljs-keyword">import</span> bs4
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> dynamic_prompt, ModelRequest
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> WebBaseLoader
<span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter
<span class="hljs-keyword">from</span> langchain_core.vectorstores <span class="hljs-keyword">import</span> InMemoryVectorStore
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> OpenAIEmbeddings
<span class="hljs-keyword">from</span> config <span class="hljs-keyword">import</span> api_key, api_base, langsmith_api_key


<span class="hljs-comment"># åˆå§‹åŒ–LangSmithè¿½è¸ª</span>
os.environ[<span class="hljs-string">"LANGSMITH_TRACING"</span>] = <span class="hljs-string">"true"</span>
os.environ[<span class="hljs-string">"LANGSMITH_API_KEY"</span>] = langsmith_api_key
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡åµŒå…¥æ¨¡å‹</span>
embeddings = OpenAIEmbeddings(model=<span class="hljs-string">"BAAI/bge-m3"</span>, api_key=api_key, base_url=api_base)
<span class="hljs-comment"># åˆå§‹åŒ–æ™ºèƒ½ä½“æ¨¡å‹</span>
model = init_chat_model(api_key = api_key,base_url = api_base,model = <span class="hljs-string">"Qwen/Qwen3-8B"</span>,model_provider = <span class="hljs-string">"openai"</span>,temperature = <span class="hljs-number">0.7</span>,)
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡å­˜å‚¨</span>
vector_store = InMemoryVectorStore(embeddings)

<span class="hljs-comment"># åŠ è½½å¹¶ç²—åˆ†åšå®¢æ–‡ç« </span>
loader = WebBaseLoader(
    web_paths=(<span class="hljs-string">"https://lilianweng.github.io/posts/2023-06-23-agent/"</span>,),
    bs_kwargs=<span class="hljs-built_in">dict</span>(parse_only=bs4.SoupStrainer(class_=(<span class="hljs-string">"post-content"</span>, <span class="hljs-string">"post-title"</span>, <span class="hljs-string">"post-header"</span>)))
)
docs = loader.load()

<span class="hljs-comment"># åˆ‡åˆ†æ–‡æ¡£</span>
text_splitter = RecursiveCharacterTextSplitter(chunk_size=<span class="hljs-number">1000</span>, chunk_overlap=<span class="hljs-number">200</span>)
all_splits = text_splitter.split_documents(docs)

<span class="hljs-comment"># ç´¢å¼•æ–‡æœ¬å—</span>
vector_store = InMemoryVectorStore(embeddings)
_ = vector_store.add_documents(documents=all_splits)

<span class="hljs-comment">#æ„å»ºåŠ¨æ€ç³»ç»Ÿæç¤ºè¯ï¼ŒåŠ å…¥æ£€ç´¢æ–‡æœ¬å—</span>
<span class="hljs-meta">@dynamic_prompt</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">prompt_with_context</span>(<span class="hljs-params">request: ModelRequest</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""Inject context into state messages."""</span>
    last_query = request.state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].text
    retrieved_docs = vector_store.similarity_search(last_query)

    docs_content = <span class="hljs-string">"\n\n"</span>.join(doc.page_content <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> retrieved_docs)

    system_message = (
        <span class="hljs-string">"You are a helpful assistant. Use the following context in your response:"</span>
        <span class="hljs-string">f"\n\n<span class="hljs-subst">{docs_content}</span>"</span>
    )
    <span class="hljs-keyword">return</span> system_message
<span class="hljs-comment">#åˆ›å»ºæ™ºèƒ½ä½“</span>
agent = create_agent(model, tools=[], middleware=[prompt_with_context])
<span class="hljs-comment">#æŸ¥è¯¢</span>
query = (<span class="hljs-string">"What is the standard method for Task Decomposition?\n\n"</span>
    <span class="hljs-string">"Once you get the answer, look up common extensions of that method."</span>)
<span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> agent.stream({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}]},stream_mode=<span class="hljs-string">"values"</span>):
    step[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].pretty_print()
</code></pre>
<p>åœ¨å—é™ç¯å¢ƒä¸‹ï¼Œå¯¹äºç®€å•æŸ¥è¯¢è€Œè¨€ï¼Œè¿™æ˜¯ä¸€ç§å¿«é€Ÿä¸”é«˜æ•ˆçš„æ–¹æ³• â€”â€” æ­¤æ—¶æˆ‘ä»¬é€šå¸¸å¸Œæœ›é€šè¿‡æ£€ç´¢ç”¨æˆ·æŸ¥è¯¢ï¼Œä»¥è·å–æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-14">5ã€RAGæ¶æ„æ¯”è¾ƒ</h2>
<p>æ ¹æ®ç³»ç»Ÿéœ€æ±‚ï¼ŒRAGå¯é€šè¿‡å¤šç§æ–¹å¼å®ç°ã€‚ä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ¶æ„çš„RAGçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ï¼š</p>





































<table><thead><tr><th>æ¶æ„ï¼ˆArchitectureï¼‰</th><th>æè¿°ï¼ˆDescriptionï¼‰</th><th>å¯æ§æ€§ï¼ˆControlï¼‰</th><th>çµæ´»æ€§ï¼ˆFlexibilityï¼‰</th><th>å»¶è¿Ÿï¼ˆLatencyï¼‰</th><th>é€‚ç”¨åœºæ™¯ï¼ˆUse Caseï¼‰</th></tr></thead><tbody><tr><td>ä¸¤æ­¥å¼ RAGï¼ˆ2-Step RAGï¼‰</td><td>æ£€ç´¢è¿‡ç¨‹å§‹ç»ˆåœ¨ç”Ÿæˆè¿‡ç¨‹ä¹‹å‰è¿›è¡Œï¼Œæµç¨‹ç®€å•ä¸”å¯é¢„æµ‹</td><td>âœ… é«˜</td><td>âŒ ä½</td><td>âš¡ å¿«</td><td>å¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQsï¼‰ã€æ–‡æ¡£é—®ç­”æœºå™¨äºº</td></tr><tr><td>æ™ºèƒ½ä½“é©±åŠ¨å¼ RAGï¼ˆAgentic RAGï¼‰</td><td>ç”±å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰é©±åŠ¨çš„æ™ºèƒ½ä½“ï¼Œåœ¨æ¨ç†è¿‡ç¨‹ä¸­å†³å®šä½•æ—¶æ£€ç´¢ã€å¦‚ä½•æ£€ç´¢</td><td>âŒ ä½</td><td>âœ… é«˜</td><td>â³ å¯å˜</td><td>å¯è°ƒç”¨å¤šç§å·¥å…·çš„ç ”ç©¶åŠ©æ‰‹</td></tr><tr><td>æ··åˆå¼ RAGï¼ˆHybridï¼‰</td><td>èåˆå‰ä¸¤ç§æ¶æ„çš„ç‰¹ç‚¹ï¼Œå¹¶åŠ å…¥éªŒè¯ç¯èŠ‚</td><td>âš–ï¸ ä¸­ç­‰</td><td>âš–ï¸ ä¸­ç­‰</td><td>â³ å¯å˜</td><td>éœ€è´¨é‡éªŒè¯çš„ç‰¹å®šé¢†åŸŸé—®ç­”ï¼ˆå¦‚åŒ»ç–—ã€æ³•å¾‹é¢†åŸŸé—®ç­”ï¼‰</td></tr></tbody></table>
<p>ä¸¤æ­¥å¼ RAGï¼ˆ2-Step RAGï¼‰çš„å»¶è¿Ÿé€šå¸¸æ›´å…·å¯é¢„æµ‹æ€§ï¼Œå› ä¸ºå¤§æ¨¡å‹è°ƒç”¨çš„æœ€å¤§æ¬¡æ•°æ˜¯å·²çŸ¥ä¸”å›ºå®šçš„ï¼ˆä¸€æ¬¡é—®ç­”ä»…è°ƒç”¨ä¸€æ¬¡å¤§æ¨¡å‹ï¼‰ã€‚è¿™ç§å¯é¢„æµ‹æ€§çš„å‰ææ˜¯ï¼ŒLLM æ¨ç†æ—¶é—´æ˜¯å½±å“å»¶è¿Ÿçš„ä¸»å¯¼å› ç´ ã€‚ä½†åœ¨å®é™…åœºæ™¯ä¸­ï¼Œå»¶è¿Ÿè¿˜å¯èƒ½å—åˆ°æ£€ç´¢ç¯èŠ‚æ€§èƒ½çš„å½±å“ï¼Œä¾‹å¦‚æ¥å£ï¼ˆAPIï¼‰å“åº”æ—¶é—´ã€ç½‘ç»œå»¶è¿Ÿæˆ–æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡ï¼Œè¿™äº›å› ç´ ä¼šå› æ‰€ä½¿ç”¨çš„å·¥å…·å’ŒåŸºç¡€è®¾æ–½ä¸åŒè€Œå­˜åœ¨å·®å¼‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å›¾çœ‹æ‡‚LangChain-AIæ¡†æ¶å…³ç³»ï¼Œå¿«é€Ÿé€‰å¯¹åˆé€‚åº“ï¼Œè½»æ¾å¼€å‘æ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7571726099690045459</link>    <guid>https://juejin.cn/post/7571726099690045459</guid>    <pubDate>2025-11-13T05:39:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571726099690045459" data-draft-id="7571726099690029075" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å›¾çœ‹æ‡‚LangChain-AIæ¡†æ¶å…³ç³»ï¼Œå¿«é€Ÿé€‰å¯¹åˆé€‚åº“ï¼Œè½»æ¾å¼€å‘æ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="LangChain,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-13T05:39:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å›¾çœ‹æ‡‚LangChain-AIæ¡†æ¶å…³ç³»ï¼Œå¿«é€Ÿé€‰å¯¹åˆé€‚åº“ï¼Œè½»æ¾å¼€å‘æ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:39:10.000Z" title="Thu Nov 13 2025 05:39:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>LangChain-AIæ˜¯ä¸€ä¸ªç”±å¤šä¸ªå¼€æºæ¡†æ¶ç»„æˆçš„ç”Ÿæ€ç³»ç»Ÿï¼Œä½†è¿™äº›æ¡†æ¶ä¹‹é—´çš„å…³ç³»å¯¹äºè®¸å¤šäººæ¥è¯´ä»ç„¶ä¸å¤Ÿæ˜ç¡®ï¼Œå¯¼è‡´åœ¨ä½¿ç”¨æ—¶éš¾ä»¥åˆ¤æ–­è¯¥é€‰æ‹©å“ªä¸ªæ¡†æ¶ã€‚ä¸ºäº†å¸®åŠ©å¤§å®¶æ›´æ¸…æ™°åœ°ç†è§£è¿™äº›æ¡†æ¶çš„å®šä½ï¼Œä»Šå¤©æˆ‘ä»¬é€šè¿‡ä¸€å¼ å›¾æ¥å±•ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶è¯¦ç»†è¯´æ˜æ¯ä¸ªæ¡†æ¶é€‚ç”¨çš„åœºæ™¯ã€‚</p>
<p>LangChain-AIçš„æ ¸å¿ƒå¼€æºåº“åŒ…æ‹¬ä¸‰ä¸ªï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ªå•†ä¸šåŒ–å¹³å°ã€‚å¼€æºåº“æ˜¯å…è´¹çš„ï¼Œä»»ä½•åº”ç”¨éƒ½å¯ä»¥é›†æˆè¿™ä¸‰ä¸ªåº“æ¥å¼€å‘æ™ºèƒ½ä½“å’Œå·¥ä½œæµï¼Œå¹¶è‡ªè¡Œå®ç°éƒ¨ç½²å’Œç›‘æ§ç­‰åŠŸèƒ½ã€‚</p>
<p>å½“ç„¶ï¼Œç”Ÿæ€ç³»ç»Ÿè¿˜æä¾›äº†ä¸€ä¸ªå•†ä¸šåŒ–å¹³å°æ¥æ”¯æŒæ™ºèƒ½ä½“çš„æ„å»ºã€éƒ¨ç½²å’Œç›‘æ§ï¼Œè¿™äº›åŠŸèƒ½éœ€è¦ä»˜è´¹ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªå•†ä¸šåŒ–å¹³å°æ˜¯äº‘æœåŠ¡çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>åœ¨å¼€æºç”Ÿæ€ä¸­ï¼Œä¸‰ä¸ªæ ¸å¿ƒåº“ä¹‹é—´çš„å…³ç³»æ˜¯é€å±‚æŠ½è±¡çš„ã€‚æœ€é«˜å±‚æ˜¯LangChainåº“ï¼Œå…¶æ¬¡æ˜¯Deep Agentsåº“ï¼Œæœ€ä½å±‚æ˜¯LangGraphåº“ã€‚</p>
<p>å…·ä½“å…³ç³»å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b00ec2224fb494fbb98eb6fdcb1040b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617150&amp;x-signature=mWxy007ZPR9yQxNJAuzbpDiltK8%3D" alt="" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒå¼€æºåº“ï¼š</strong></p>
<p><strong>LangChain</strong></p>
<p><strong>LangChainÂ ä¸Â LangChain.js</strong>Â æä¾›å¯å¤ç”¨çš„ç»„ä»¶ä¸é›†æˆæ–¹æ¡ˆï¼ŒåŠ©åŠ›å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘ã€‚</p>
<p><em>LangChainä»£ç†æ„å»ºäºLangGraphä¹‹ä¸Šï¼Œæä¾›é¢„æ„å»ºçš„æ™ºèƒ½ä½“æ¶æ„å’Œæ¨¡å‹é›†æˆï¼Œå¹¶å°†Â LLMÂ æ— ç¼é›†æˆåˆ°æ™ºèƒ½ä½“å’Œåº”ç”¨ç¨‹åºä¸­ï¼Œæ—¨åœ¨æä¾›æŒä¹…æ‰§è¡Œã€æµå¼å¤„ç†ã€äººæœºäº¤äº’ã€æŒä¹…åŒ–ç­‰åŠŸèƒ½ï¼ŒåŒæ—¶å¯ä»¥å’ŒDeep Agentsåº“æ— ç¼é›†æˆå®ç°è‡ªè§„åˆ’çš„æ·±åº¦ä»£ç†ã€‚</em></p>
<p><em>ä»¥ä¸‹åœºæ™¯æœ€é€‚åˆä½¿ç”¨LangChainï¼š</em></p>
<ul>
<li><em>ç®€å•çš„å¯¹è¯å‹ç”Ÿæˆå¼æ™ºèƒ½ä½“ï¼Œåˆ©ç”¨LLMè¿›è¡Œå¯¹è¯ï¼›</em></li>
<li><em>å¿«é€Ÿæ„å»ºç»“åˆå·¥å…·ã€LLMä¸RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„å¯¹è¯æ™ºèƒ½ä½“ï¼›</em></li>
<li><em>éœ€è¦å‘å¸ƒMCPæœåŠ¡çš„æ™ºèƒ½ä½“ï¼›</em></li>
<li><em>å¤šAgentååŒå·¥ä½œçš„æ™ºèƒ½ä½“ï¼›</em></li>
</ul>
<p><em>åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œæ™ºèƒ½ä½“å¯ä»¥ç›´æ¥åˆ©ç”¨LangChainæä¾›çš„ç°æˆåŒ…ï¼Œå°½ç®¡ä½¿ç”¨è¿™äº›åŒ…ä¸æ˜¯å¼ºåˆ¶è¦æ±‚ã€‚å¦‚æœæ‚¨è®¤åŒLangChainçš„ä»£ç é£æ ¼ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªç†æƒ³é€‰æ‹©ã€‚å¦‚æœä¸è®¤åŒï¼Œå¯ä»¥é€‰æ‹©å…¶ä»–å¼€æºæ¡†æ¶æ¥å®ç°ç±»ä¼¼åŠŸèƒ½ã€‚</em></p>
<h2 data-id="heading-0"><em>Deep Agents</em></h2>
<p>Deep Agentså’ŒDeep Agents.jså…·å¤‡è§„åˆ’èƒ½åŠ›ï¼Œèƒ½å¤Ÿè°ƒç”¨å­æ™ºèƒ½ä½“å¹¶é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå¤„ç†å¤æ‚ä»»åŠ¡çš„æ™ºèƒ½ä½“ç³»ç»Ÿã€‚</p>
<p><em>Deep Agentsæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº“ï¼Œç”¨äºæ„å»ºå¯ä»¥å¤„ç†å¤æ‚å¤šæ­¥éª¤ä»»åŠ¡çš„æ™ºèƒ½ä½“ã€‚å®ƒåŸºäºLangGraphæ„å»ºï¼Œå¹¶èƒ½å¤Ÿå®ç°åƒClaude Codeã€Deep Researchå’ŒManusç­‰åº”ç”¨ç¨‹åºçš„è‡ªè§„åˆ’ã€ä¸Šä¸‹æ–‡ç®¡ç†åŠç”Ÿæˆå­æ™ºèƒ½ä½“çš„èƒ½åŠ›ã€‚</em></p>
<p><em>å½“æ‚¨éœ€è¦å…·å¤‡ä»¥ä¸‹åŠŸèƒ½çš„ä»£ç†æ—¶ï¼Œè¯·ä½¿ç”¨æ·±åº¦ä»£ç†ï¼š</em></p>
<ul>
<li><em>å¤„ç†éœ€è¦è®¡åˆ’å’Œåˆ†è§£çš„<strong>å¤æ‚ã€å¤šæ­¥éª¤ä»»åŠ¡</strong></em></li>
<li><em>é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå·¥å…·<strong>ç®¡ç†å¤§é‡ä¸Šä¸‹æ–‡ä¿¡æ¯</strong></em></li>
<li><em><strong>å°†å·¥ä½œå§”æ´¾</strong>**ç»™ä¸“é—¨çš„å­ä»£ç†ä»¥å®ç°ä¸Šä¸‹æ–‡éš”ç¦»</em></li>
<li><em>åœ¨å¯¹è¯å’Œä¸»é¢˜ä¹‹é—´<strong>ä¿æŒè®°å¿†</strong></em></li>
</ul>
<p><strong>LangGraph</strong></p>
<p><strong>LangGraphÂ ä¸Â LangGraph.js</strong>Â æ”¯æŒä»¥å›¾ç»“æ„æ„å»ºæ™ºèƒ½ä½“å·¥ä½œæµã€‚</p>
<p><em>LangGraphä¸ºä»»ä½•éœ€è¦é•¿æ—¶é—´è¿è¡Œä¸”å…·æœ‰çŠ¶æ€ç®¡ç†çš„å·¥ä½œæµæˆ–ä»£ç†æä¾›åº•å±‚æ”¯æŒï¼Œè¿™äº›ä»£ç†ä¸ä¸€å®šç”±LangChainåˆ›å»ºï¼Œä¹Ÿå¯ä»¥æ˜¯æ‚¨è‡ªå·±åœ¨åº”ç”¨ä¸­å®ç°çš„ä»£ç†ç¨‹åºã€‚</em></p>
<p><strong>ä»¥ä¸‹åœºæ™¯æœ€é€‚åˆä½¿ç”¨LangGraphï¼š</strong></p>
<p>å¦‚æœä½ çš„éœ€æ±‚ç»“åˆäº†ç¡®å®šæ€§çš„å·¥ä½œæµã€ä»£ç†å·¥ä½œæµã€é«˜åº¦å®šåˆ¶åŒ–å’Œä¸¥æ ¼çš„å»¶è¿Ÿæ§åˆ¶ï¼Œå¯ä»¥é€‰æ‹©LangGraphä½œä¸ºç”Ÿæ€ä¸­æœ€åº•å±‚çš„ä»£ç†ç¼–æ’ä¸è¿è¡Œæ—¶æ¡†æ¶ã€‚</p>
<p>LangGraphä¸“æ³¨äºä¸ºä»£ç†ç¼–æ’æä¾›å…³é”®çš„åº•å±‚åŠŸèƒ½ï¼Œå¦‚æŒä¹…æ‰§è¡Œã€æµå¼ä¼ è¾“å’Œäººæœºäº¤äº’ç­‰ï¼Œæ”¯æŒDeep Agentsæ·±åº¦ä»£ç†çš„å›¾æ‰§è¡Œå’ŒçŠ¶æ€ç®¡ç†ã€‚</p>
<p>é€šå¸¸ï¼ŒLangChainå’ŒLangGraphçš„ç»“åˆæ˜¯æ„å»ºå®šåˆ¶åŒ–æ™ºèƒ½ä½“çš„ä¼˜é€‰æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">å†™åœ¨æœ€å</h2>
<p>LangChain-AIç”Ÿæ€å¼€æºäº†ä¸‰ä¸ªåº“ï¼Œè¿™ä¸€æƒ³æ³•éå¸¸æœ‰å‰æ™¯ï¼Œä½†ä¹Ÿç¡®å®ç»™ä½¿ç”¨è€…å¸¦æ¥äº†ä¸å°‘å›°æƒ‘ã€‚å¦‚æœä¸èƒ½æ˜ç¡®åŒºåˆ†è¿™äº›åº“çš„æ ¸å¿ƒåŠŸèƒ½å’Œä¼˜åŠ¿ï¼Œç”¨æˆ·åœ¨é€‰æ‹©æ—¶å¯èƒ½ä¼šæ„Ÿåˆ°è¿·èŒ«ï¼Œä»è€Œå¢åŠ å­¦ä¹ çš„éš¾åº¦ã€‚ç›®å‰ï¼Œå¾ˆå¤šäººå› æ­¤æ”¾å¼ƒäº†æ·±å…¥å­¦ä¹ ã€‚ç„¶è€Œï¼Œè¿™ç§æ¶æ„æœ¬èº«æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¾è€¦åˆç»“æ„ï¼Œå…·å¤‡å¾ˆé«˜çš„çµæ´»æ€§ï¼Œç‰¹åˆ«é€‚åˆé‚£äº›æœ‰å®šåˆ¶åŒ–å¼€å‘éœ€æ±‚çš„åœºæ™¯ã€‚</p>
<p>é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åï¼Œå¸Œæœ›ä½ èƒ½æ›´æ¸…æ™°åœ°ç†è§£LangChain-AIç”Ÿæ€ï¼Œé‡æ–°æŠ•å…¥åˆ°è¯¥ç”Ÿæ€çš„å®è·µä¸­ï¼Œæ‰“é€ æ›´å¼ºå¤§ã€æ›´å¥å£®ã€æ›´çµæ´»çš„æ™ºèƒ½ä½“ï¼Œä»¥æ»¡è¶³å„ç§å¤æ‚éœ€æ±‚çš„å®ç°ã€‚</p>
<h2 data-id="heading-2">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„åŠ¨æ€å†…å­˜ç®¡ç†]]></title>    <link>https://juejin.cn/post/7571726099689898003</link>    <guid>https://juejin.cn/post/7571726099689898003</guid>    <pubDate>2025-11-13T03:53:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571726099689898003" data-draft-id="7571726099689308179" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„åŠ¨æ€å†…å­˜ç®¡ç†"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-11-13T03:53:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç…¤çƒç‹å­"/> <meta itemprop="url" content="https://juejin.cn/user/4088439235949739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„åŠ¨æ€å†…å­˜ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4088439235949739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç…¤çƒç‹å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:53:58.000Z" title="Thu Nov 13 2025 03:53:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŠ¨æ€å†…å­˜ç®¡ç†</h2>
<p>C++ å…è®¸é€šè¿‡æŒ‡é’ˆä»¥åŠåŠ¨æ€å†…å­˜åˆ†é…/é‡Šæ”¾è¿ç®—ç¬¦è¿›è¡Œåº•å±‚å†…å­˜æ“ä½œã€‚</p>
<h3 data-id="heading-1">new ä¸ delete è¿ç®—ç¬¦</h3>
<p>C++ ä¸­çš„ new ä¸ delete è¿ç®—ç¬¦ï¼šåŠ¨æ€å†…å­˜ç®¡ç†</p>
<p>åœ¨ C++ ä¸­ï¼Œæ ˆå†…å­˜ä¼šåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨åˆ†é…ç»™å˜é‡ï¼Œå¤§å°å›ºå®šã€‚è‹¥æƒ³è·å¾—æ›´å¤§çš„çµæ´»æ€§ä¸æ§åˆ¶æƒï¼Œå¯ä½¿ç”¨ <strong>å †ï¼ˆheapï¼‰ä¸Šçš„åŠ¨æ€å†…å­˜åˆ†é…</strong>ï¼šç”¨ <strong><code>new</code></strong> æ‰‹åŠ¨ç”³è¯·ï¼Œç”¨ <strong><code>delete</code></strong> æ‰‹åŠ¨é‡Šæ”¾ã€‚</p>
<p>è¿™æ ·ï¼Œç¨‹åºå°±èƒ½åœ¨è¿è¡Œæ—¶å‘ç³»ç»Ÿè¯·æ±‚å†…å­˜ï¼Œé€‚ç”¨äºç¼–è¯‘æ—¶å°šä¸çŸ¥å¤§å°çš„åœºæ™¯ï¼Œä¾‹å¦‚å˜é•¿æ•°ç»„ã€é“¾è¡¨ã€æ ‘ç­‰åŠ¨æ€æ•°æ®ç»“æ„ã€‚</p>
<h4 data-id="heading-2">1.new è¿ç®—ç¬¦</h4>
<p><code>new</code> ä» <strong>è‡ªç”±å­˜å‚¨åŒºï¼ˆFree Storeï¼Œå †çš„ä¸€éƒ¨åˆ†ï¼‰</strong> åˆ†é…å†…å­˜ã€‚è‹¥å†…å­˜å……è¶³ï¼Œå®ƒä¼šæŒ‰ç±»å‹é»˜è®¤å€¼åˆå§‹åŒ–è¯¥å†…å­˜ï¼Œå¹¶è¿”å›å…¶åœ°å€ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// å£°æ˜æŒ‡é’ˆï¼Œç”¨äºä¿å­˜ç”³è¯·åˆ°çš„å†…å­˜åœ°å€</span>
    <span class="hljs-type">int</span> *nptr;

    <span class="hljs-comment">// ç”³è¯·å¹¶åˆå§‹åŒ–å†…å­˜</span>
    nptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">6</span>);

    <span class="hljs-comment">// æ‰“å°å€¼</span>
    cout &lt;&lt; *nptr &lt;&lt; endl;  <span class="hljs-comment">// è¾“å‡º 6</span>

    <span class="hljs-comment">// æ‰“å°å†…å­˜å—åœ°å€</span>
    cout &lt;&lt; nptr;           <span class="hljs-comment">// è¾“å‡º 0xb52dc20ï¼ˆç¤ºä¾‹åœ°å€ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h4 data-id="heading-3">2.åˆ†é…å†…å­˜å—ï¼ˆæ•°ç»„ï¼‰</h4>
<p><code>new</code> è¿ç®—ç¬¦ä¹Ÿå¯ç”¨æ¥<strong>åŠ¨æ€åˆ†é…ä¸€æ•´å—å†…å­˜</strong>ï¼ˆå³æ•°ç»„ï¼‰ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">new</span> æ•°æ®ç±»å‹[å…ƒç´ ä¸ªæ•°];
</code></pre>
<p>è¯¥è¯­å¥ä¼šåœ¨å †ä¸Šä¸ºæŒ‡å®šç±»å‹åˆ†é…å¯å®¹çº³ <code>n</code> ä¸ªå…ƒç´ çš„è¿ç»­ç©ºé—´ã€‚<br/>
åˆ†é…æ—¶è¿˜å¯ä»¥<strong>ç›´æ¥åˆå§‹åŒ–</strong>æ•°ç»„ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// å£°æ˜æŒ‡é’ˆï¼Œç”¨äºä¿å­˜ç”³è¯·åˆ°çš„å†…å­˜åœ°å€</span>
    <span class="hljs-type">int</span> *nptr;

    <span class="hljs-comment">// åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªåŒ…å« 5 ä¸ªæ•´æ•°çš„æ•°ç»„</span>
    nptr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">5</span>]{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>};

    <span class="hljs-comment">// æ‰“å°æ•°ç»„</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
        cout &lt;&lt; nptr[i] &lt;&lt; <span class="hljs-string">" "</span>;  <span class="hljs-comment">// è¾“å‡ºï¼š1 2 3 4 5</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<pre><code class="hljs">1 2 3 4 5 
</code></pre>
<h4 data-id="heading-4">3.å¦‚æœåœ¨è¿è¡Œæ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ€ä¹ˆåŠï¼Ÿ</h4>
<p>å¦‚æœè¿è¡Œæ—¶å †ç©ºé—´ä¸è¶³ï¼Œæ— æ³•åˆ†é…å†…å­˜ï¼Œ<code>new</code> ä¼š<strong>æŠ›å‡º <code>std::bad_alloc</code> ç±»å‹çš„å¼‚å¸¸</strong>æ¥è¡¨ç¤ºåˆ†é…å¤±è´¥ã€‚<br/>
ä¸è¿‡ï¼Œè‹¥ç»™ <code>new</code> åŠ ä¸Š <strong><code>nothrow</code></strong> å‚æ•°ï¼Œå®ƒå°±ä¸ä¼šå†æŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯<strong>è¿”å›ç©ºæŒ‡é’ˆ <code>nullptr</code></strong>ã€‚å› æ­¤ï¼Œä½¿ç”¨å‰æœ€å¥½å…ˆæ£€æŸ¥è¿”å›çš„æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-type">int</span> *p = <span class="hljs-built_in">new</span> (nothrow) <span class="hljs-type">int</span>;
<span class="hljs-keyword">if</span> (!p) {
    cout &lt;&lt; <span class="hljs-string">"å†…å­˜åˆ†é…å¤±è´¥\n"</span>;
}
</code></pre>
<h4 data-id="heading-5">4.delete è¿ç®—ç¬¦</h4>
<p>åœ¨ C++ ä¸­ï¼Œ<code>delete</code> è¿ç®—ç¬¦ç”¨äº<strong>é‡Šæ”¾</strong>ç”± <code>new</code> åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚<br/>
å®ƒæŠŠå…ˆå‰ <code>new</code> ç”³è¯·åˆ°çš„å†…å­˜å½’è¿˜ç»™ç³»ç»Ÿã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">delete</span> æŒ‡é’ˆ;          <span class="hljs-comment">// é‡Šæ”¾å•ä¸ªå¯¹è±¡</span>
<span class="hljs-keyword">delete</span>[] æ•°ç»„æŒ‡é’ˆ;     <span class="hljs-comment">// é‡Šæ”¾æ•°ç»„</span>
</code></pre>
<ul>
<li><code>æŒ‡é’ˆ</code>ï¼šæŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜</li>
<li><code>æ•°ç»„æŒ‡é’ˆ</code>ï¼šæŒ‡å‘åŠ¨æ€åˆ†é…çš„æ•°ç»„</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">int</span> *ptr = <span class="hljs-literal">NULL</span>;

    <span class="hljs-comment">// ç”¨ new ç”³è¯·ä¸€ä¸ªæ•´æ•°çš„å†…å­˜</span>
    ptr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (!ptr) {
        cout &lt;&lt; <span class="hljs-string">"å†…å­˜åˆ†é…å¤±è´¥"</span>;
        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);
    }

    cout &lt;&lt; <span class="hljs-string">"*p çš„å€¼: "</span> &lt;&lt; *ptr &lt;&lt; endl;

    <span class="hljs-comment">// ä½¿ç”¨å®Œåé‡Šæ”¾</span>
    <span class="hljs-keyword">delete</span> ptr;

    <span class="hljs-comment">// å†ç”³è¯·ä¸€ä¸ªåŒ…å« 3 ä¸ªå…ƒç´ çš„æ•°ç»„</span>
    ptr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">3</span>];
    ptr[<span class="hljs-number">2</span>] = <span class="hljs-number">11</span>;
    ptr[<span class="hljs-number">1</span>] = <span class="hljs-number">22</span>;
    ptr[<span class="hljs-number">0</span>] = <span class="hljs-number">33</span>;
    cout &lt;&lt; <span class="hljs-string">"æ•°ç»„: "</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++)
        cout &lt;&lt; ptr[i] &lt;&lt; <span class="hljs-string">" "</span>;

    <span class="hljs-comment">// ä½¿ç”¨å®Œåé‡Šæ”¾æ•°ç»„</span>
    <span class="hljs-keyword">delete</span>[] ptr;

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<pre><code class="hljs language-css" lang="css">*<span class="hljs-selector-tag">p</span> çš„å€¼: <span class="hljs-number">10</span>
æ•°ç»„: <span class="hljs-number">33</span> <span class="hljs-number">22</span> <span class="hljs-number">11</span>
</code></pre>
<h4 data-id="heading-6">5.åŠ¨æ€å†…å­˜å¸¸è§é”™è¯¯</h4>
<p>å°½ç®¡åŠ¨æ€å†…å­˜åˆ†é…åŠŸèƒ½å¼ºå¤§ï¼Œå®ƒä¹Ÿæ˜¯ C++ ä¸­æœ€å®¹æ˜“å¼•å…¥ä¸¥é‡é—®é¢˜çš„ç¯èŠ‚ä¹‹ä¸€ã€‚ä¸»è¦é”™è¯¯åŒ…æ‹¬ï¼š</p>
<p>(1). <strong>å†…å­˜æ³„æ¼ï¼ˆMemory Leaksï¼‰</strong><br/>
åˆ†é…çš„å†…å­˜ä½¿ç”¨å®Œåæœªè¢«é‡Šæ”¾ï¼Œä¸”è‹¥æŒ‡å‘è¯¥å†…å­˜çš„æŒ‡é’ˆä¸¢å¤±ï¼Œåˆ™è¿™å—å†…å­˜ä¼šä¸€ç›´å ç”¨åˆ°ç¨‹åºç»“æŸã€‚<br/>
<strong>è§£å†³æ–¹æ³•</strong>ï¼šå°½é‡ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆ<code>std::unique_ptr</code> / <code>std::shared_ptr</code>ï¼‰ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚</p>
<p>(2). <strong>æ‚¬å‚æŒ‡é’ˆï¼ˆDangling Pointersï¼‰</strong><br/>
å†…å­˜å·²è¢« <code>delete</code>ï¼Œä½†æŒ‡é’ˆä»è¢«ç»§ç»­ä½¿ç”¨ï¼Œå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆå´©æºƒã€è„æ•°æ®ç­‰ï¼‰ã€‚<br/>
<strong>è§£å†³æ–¹æ³•</strong>ï¼šæŒ‡é’ˆå®šä¹‰æ—¶åˆå§‹åŒ–ä¸º <code>nullptr</code>ï¼Œé‡Šæ”¾åç«‹åˆ»å†èµ‹ <code>nullptr</code>ã€‚</p>
<p>(3). <strong>é‡å¤é‡Šæ”¾ï¼ˆDouble Deletionï¼‰</strong><br/>
å¯¹åŒä¸€å—å†…å­˜æ‰§è¡Œä¸¤æ¬¡ <code>delete</code>ï¼Œç¨‹åºå¯èƒ½ç›´æ¥å´©æºƒæˆ–å†…å­˜æŸåã€‚<br/>
<strong>è§£å†³æ–¹æ³•</strong>ï¼šé‡Šæ”¾åç«‹å³å°†æŒ‡é’ˆç½®ä¸º <code>nullptr</code>ã€‚</p>
<p>(4). <strong>æ··ç”¨ new/delete ä¸ malloc/free</strong><br/>
C++ å…¼å®¹ C çš„ <code>malloc()/calloc()/free()</code>ï¼Œä½†å®ƒä»¬ä¸ new/delete <strong>ä¸èƒ½æ··ç”¨</strong>ï¼š<br/>
ç”¨ <code>new</code> ç”³è¯·çš„å†…å­˜ä¸å¯ç”¨ <code>free()</code> é‡Šæ”¾ï¼›ç”¨ <code>malloc()</code> ç”³è¯·çš„å†…å­˜ä¸å¯ç”¨ <code>delete</code> é‡Šæ”¾ã€‚</p>
<blockquote>
<p><strong>æ‹“å±•ï¼š</strong></p>
<p><code>new</code>/<code>delete</code> æ˜¯ <strong>C++ çš„è¿ç®—ç¬¦</strong>ï¼Œè´Ÿè´£ <strong>åˆ†é…å†…å­˜ + æ„é€ /ææ„å¯¹è±¡</strong>ï¼›<br/>
<code>malloc</code>/<code>calloc</code>/<code>free</code> æ˜¯ <strong>C çš„åº“å‡½æ•°</strong>ï¼Œåªè´Ÿè´£ <strong>åˆ†é…/é‡Šæ”¾åŸå§‹å†…å­˜</strong>ï¼Œ<strong>ä¸ç®¡å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</p>
</blockquote>
<p>ğŸ” åŒºåˆ«ä¸€è§ˆè¡¨ï¼š</p>























































<table><thead><tr><th>ç‰¹æ€§</th><th><code>new</code> / <code>delete</code></th><th><code>malloc</code> / <code>calloc</code> / <code>free</code></th></tr></thead><tbody><tr><td><strong>è¯­è¨€å±‚çº§</strong></td><td>C++ è¿ç®—ç¬¦</td><td>C åº“å‡½æ•°</td></tr><tr><td><strong>æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°</strong></td><td>âœ… ä¼šè°ƒç”¨</td><td>âŒ ä¸ä¼š</td></tr><tr><td><strong>è¿”å›ç±»å‹</strong></td><td>å…·ä½“ç±»å‹æŒ‡é’ˆï¼ˆå¦‚ <code>int*</code>ï¼‰</td><td><code>void*</code>ï¼ˆéœ€æ‰‹åŠ¨å¼ºè½¬ï¼‰</td></tr><tr><td><strong>å†…å­˜å¤§å°è®¡ç®—</strong></td><td>è‡ªåŠ¨è®¡ç®—ï¼ˆå¦‚ <code>new int[5]</code>ï¼‰</td><td>æ‰‹åŠ¨è®¡ç®—ï¼ˆå¦‚ <code>malloc(5 * sizeof(int))</code>ï¼‰</td></tr><tr><td><strong>å¤±è´¥æ—¶è¡Œä¸º</strong></td><td>æŠ›å‡º <code>std::bad_alloc</code>ï¼ˆæˆ– <code>nullptr</code> è‹¥ç”¨ <code>nothrow</code>ï¼‰</td><td>è¿”å› <code>nullptr</code></td></tr><tr><td><strong>æ˜¯å¦æ”¯æŒé‡è½½</strong></td><td>âœ… å¯ä»¥å…¨å±€æˆ–ç±»ä½œç”¨åŸŸé‡è½½</td><td>âŒ ä¸æ”¯æŒ</td></tr><tr><td><strong>æ˜¯å¦æ”¯æŒæ•°ç»„æ„é€ </strong></td><td>âœ… <code>new Type[n]</code> ä¼šè°ƒç”¨ <code>n</code> æ¬¡æ„é€ å‡½æ•°</td><td>âŒ åªåˆ†é…åŸå§‹å†…å­˜</td></tr><tr><td><strong>æ˜¯å¦æ”¯æŒåˆå§‹åŒ–</strong></td><td>âœ… å¯ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼ˆå¦‚ <code>new int{5}</code>ï¼‰</td><td>âŒ <code>malloc</code> ä¸åˆå§‹åŒ–ï¼Œ<code>calloc</code> æ¸…é›¶</td></tr><tr><td><strong>æ˜¯å¦å¯æ··ç”¨</strong></td><td>âŒ <strong>ç»å¯¹ç¦æ­¢</strong> æ··ç”¨ï¼ˆ<code>new</code> é… <code>free</code>ï¼Œ<code>malloc</code> é… <code>delete</code>ï¼‰</td><td/></tr></tbody></table>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Foo</span> {
    <span class="hljs-built_in">Foo</span>()  { std::cout &lt;&lt; <span class="hljs-string">"æ„é€ \n"</span>; }
    ~<span class="hljs-built_in">Foo</span>() { std::cout &lt;&lt; <span class="hljs-string">"ææ„\n"</span>; }
};

Foo* p1 = <span class="hljs-keyword">new</span> Foo;      <span class="hljs-comment">// è¾“å‡ºï¼šæ„é€ </span>
<span class="hljs-keyword">delete</span> p1;              <span class="hljs-comment">// è¾“å‡ºï¼šææ„</span>

Foo* p2 = (Foo*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Foo)); <span class="hljs-comment">// æ— è¾“å‡ºï¼Œä¸ä¼šæ„é€ </span>
<span class="hljs-built_in">free</span>(p2);                            <span class="hljs-comment">// æ— è¾“å‡ºï¼Œä¸ä¼šææ„</span>
</code></pre>
<p>(5). <strong>å®šä½ newï¼ˆPlacement newï¼‰</strong><br/>
æ™®é€š <code>new</code> ä¼š <strong>å…ˆåˆ†é…å†…å­˜å†æ„é€ å¯¹è±¡</strong>ï¼›è€Œ placement new æŠŠè¿™ä¸¤æ­¥åˆ†å¼€ï¼š<br/>
ç¨‹åºå‘˜å…ˆå‡†å¤‡å¥½ä¸€å—å·²å­˜åœ¨çš„å†…å­˜å—ï¼Œå†ç”¨ placement new åœ¨è¯¥ <strong>æŒ‡å®šåœ°å€</strong> ä¸Šæ„é€ å¯¹è±¡ã€‚</p>
<h3 data-id="heading-7">å†…å­˜æ³„æ¼</h3>
<p>C++ ä¸­çš„å†…å­˜æ³„æ¼ï¼Œ<strong>å†…å­˜æ³„æ¼</strong>æ˜¯æŒ‡ï¼šç¨‹åºä¸ºæŸé¡¹ä»»åŠ¡åŠ¨æ€åˆ†é…äº†å†…å­˜ï¼Œä½†åœ¨ä½¿ç”¨å®Œæ¯•å<strong>æ²¡æœ‰é‡Šæ”¾</strong>ï¼Œå¯¼è‡´è¿™å—å†…å­˜ç›´åˆ°ç¨‹åºç»“æŸéƒ½æ— æ³•å†è¢«ä½¿ç”¨ï¼Œä»è€Œé€ æˆ<strong>å†…å­˜æµªè´¹</strong>ã€‚</p>
<h4 data-id="heading-8">1.ä¸ºä»€ä¹ˆ C++ ä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Ÿ</h4>
<p>C++ <strong>æ²¡æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶</strong>ã€‚ æ‰€æœ‰ç”¨ <code>new</code>/<code>malloc</code> ç­‰æ‰‹åŠ¨ç”³è¯·çš„å†…å­˜ï¼Œéƒ½å¿…é¡»ç”±ç¨‹åºå‘˜<strong>æ˜¾å¼é‡Šæ”¾</strong>ï¼ˆ<code>delete</code>/<code>free</code>ï¼‰ã€‚  ä¸€æ—¦å¿˜è®°é‡Šæ”¾ï¼Œè¿™å—å†…å­˜å°±<strong>æ°¸è¿œä¸¢å¤±</strong>â€”â€”ç¨‹åºè¿è¡ŒæœŸé—´æ— æ³•å†è¢«å…¶ä»–ä»£ç ä½¿ç”¨ï¼Œè¿™å°±æ˜¯<strong>å†…å­˜æ³„æ¼</strong>ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// ç”³è¯·å†…å­˜</span>
    <span class="hljs-type">int</span>* ptr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>];

    <span class="hljs-comment">// å‡½æ•°ç›´æ¥è¿”å›ï¼Œæ²¡æœ‰ delete[] ptr</span>
    <span class="hljs-keyword">return</span>;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// æ‰§è¡Œä¸€äº›ä»»åŠ¡</span>
}
</code></pre>
<p><strong>ç»“æœ</strong>ï¼š<br/>
ä¸º 10 ä¸ªæ•´æ•°åˆ†é…çš„å†…å­˜æ—¢<strong>æ²¡æœ‰è¢«é‡Šæ”¾</strong>ï¼Œä¹Ÿ<strong>æ— æ³•å†è¢«è®¿é—®</strong>ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚</p>
<h4 data-id="heading-9">2.å†…å­˜æ³„æ¼çš„åæœ</h4>
<p>å½“å‘ç”Ÿå†…å­˜æ³„æ¼æ—¶ï¼Œä¼šå¼•å‘ä¸€ç³»åˆ—é—®é¢˜ï¼š</p>
<p>(1). <strong>æ€§èƒ½ä¸‹é™</strong><br/>
æ³„æ¼çš„å†…å­˜æ— æ³•å†è¢«ç¨‹åºå…¶ä»–éƒ¨åˆ†æˆ–ç³»ç»Ÿå…¶ä»–è¿›ç¨‹ä½¿ç”¨ã€‚è‹¥æ³„æ¼é‡å¤§ã€æ—¶é—´é•¿ï¼Œç¨‹åºç”šè‡³æ•´ä¸ªç³»ç»Ÿéƒ½ä¼šå› å¯ç”¨å†…å­˜ä¸è¶³è€Œå˜æ…¢ã€‚</p>
<p>(2). <strong>ç¨‹åºå´©æºƒ</strong><br/>
å¦‚æœç¨‹åºæŒç»­æ³„æ¼ï¼Œæœ€ç»ˆå¯èƒ½è€—å°½æ‰€æœ‰ç‰©ç†å†…å­˜ï¼Œå¯¼è‡´è¿›ç¨‹ä¸ç¨³å®šã€è¡Œä¸ºå¼‚å¸¸æˆ–ç›´æ¥å´©æºƒã€‚</p>
<p>(3). <strong>èµ„æºæ¯ç«­</strong><br/>
å†…å­˜æ˜¯æœ‰é™çš„ç³»ç»Ÿèµ„æºï¼Œé•¿æœŸæ³„æ¼ä¼šé€ æˆèµ„æºæ¯ç«­ï¼Œå½±å“åŒä¸€å°æœºå™¨ä¸Šçš„æ‰€æœ‰ä»»åŠ¡ã€‚</p>
<p>(4). <strong>é•¿ç”Ÿå‘½å‘¨æœŸç¨‹åºå—å®³æœ€æ·±</strong><br/>
çŸ­æ—¶é—´è¿è¡Œçš„å°ç¨‹åºæ³„æ¼ä¸€ç‚¹å†…å­˜å½±å“æœ‰é™ï¼›ä½†æœåŠ¡å™¨ã€å®ˆæŠ¤è¿›ç¨‹ç­‰<strong>é•¿æ—¶é—´è¿è¡Œ</strong>çš„ç¨‹åºï¼Œæ³„æ¼çš„å†…å­˜ä¼š<strong>ç´¯ç§¯å¹¶é•¿æœŸå ç”¨</strong>ï¼Œæœ€ç»ˆæˆä¸ºè‡´å‘½é—®é¢˜ã€‚</p>
<h4 data-id="heading-10">3.å¦‚ä½•å‘ç°å†…å­˜æ³„æ¼ï¼Ÿ</h4>
<p>C++ æ²¡æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼ŒæŸ¥æ‰¾æ³„æ¼ç›¸å¯¹å›°éš¾ã€‚ä¸»è¦æœ‰ä¸¤ç±»æ–¹æ³•ï¼š</p>
<ol>
<li>
<p><strong>äººå·¥å®¡æŸ¥</strong><br/>
é€šè¯»ä»£ç ï¼Œæ‰¾å‡ºæ‰€æœ‰ <code>new</code>/<code>malloc</code> å<strong>æœªé…å¯¹</strong> <code>delete</code>/<code>free</code> çš„åœ°æ–¹ã€‚</p>
</li>
<li>
<p><strong>å€ŸåŠ©å·¥å…·</strong><br/>
ä½¿ç”¨ Valgrindã€AddressSanitizerã€Dr.Memory ç­‰å·¥å…·ï¼Œå¯<strong>è‡ªåŠ¨å®šä½</strong>æ³„æ¼ç‚¹ï¼Œæ— éœ€é€è¡Œå®¡è®¡ã€‚</p>
</li>
</ol>
<h2 data-id="heading-11">C++ å¦‚ä½•æ£€æµ‹å†…å­˜æ³„æ¼</h2>
<p>å†…å­˜æ³„æ¼æ˜¯ C++ å¼€å‘ä¸­æœ€å¸¸è§ã€ä¹Ÿæœ€è‡´å‘½çš„é—®é¢˜ä¹‹ä¸€ï¼šç”¨ <code>new</code>/<code>malloc</code> ä»å †ç”³è¯·äº†å†…å­˜ï¼Œå´å¿˜äº†ç”¨ <code>delete</code>/<code>free</code> å½’è¿˜ï¼Œå¯¼è‡´èµ„æºè€—å°½ã€æ€§èƒ½ä¸‹é™ç”šè‡³ç¨‹åºå´©æºƒã€‚æœ¬æ–‡ä»‹ç»å¦‚ä½•<strong>ç³»ç»ŸåŒ–åœ°æ£€æµ‹</strong>è¿™ç±»æ³„æ¼ã€‚</p>
<p>æ³„æ¼æ ¹å› å…ˆç†æ¸…, åœ¨åŠ¨æ‰‹æ’æŸ¥å‰ï¼Œå…ˆå›é¡¾å¯¼è‡´æ³„æ¼çš„å…¸å‹åŸå› ï¼š</p>
<p>(1). <strong>åª new ä¸ delete</strong>  ç”³è¯·åå‹æ ¹å„¿æ²¡æœ‰é‡Šæ”¾ã€‚</p>
<p>(2). <strong>é…å¯¹çš„å½¢å¼å†™é”™</strong>  ç”¨ <code>delete</code> é‡Šæ”¾ <code>new[]</code> ç”³è¯·çš„æ•°ç»„ï¼Œæˆ–ç”¨ <code>free</code> é‡Šæ”¾ <code>new</code> çš„å¯¹è±¡ã€‚</p>
<p>(3). <strong>æŒ‡é’ˆä¸¢å¤±</strong>  æŒ‡é’ˆè¢«è¦†ç›–æˆ–æå‰å‡ºä½œç”¨åŸŸï¼Œå†ä¹Ÿæ‰¾ä¸åˆ°é‚£å—å†…å­˜ã€‚</p>
<p>(4). <strong>å¼‚å¸¸è·¯å¾„é—æ¼</strong>   <code>try/catch</code> åå¿˜è®°åœ¨æ‰€æœ‰åˆ†æ”¯é‡Œé‡Šæ”¾èµ„æºã€‚</p>
<p>(5). <strong>æ™ºèƒ½æŒ‡é’ˆè¯¯ç”¨</strong>  <code>shared_ptr</code> å½¢æˆå¾ªç¯å¼•ç”¨ï¼Œå¯¼è‡´å¼•ç”¨è®¡æ•°æ°¸è¿œé™ä¸åˆ° 0ã€‚</p>
<h3 data-id="heading-12">æ£€æµ‹æ‰‹æ®µæ¦‚è§ˆ</h3>



































<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th><th>æ¨èå·¥å…·</th></tr></thead><tbody><tr><td><strong>é™æ€æ£€æŸ¥</strong></td><td>ç¼–è¯‘æœŸè§„åˆ™æ‰«æ</td><td>Clang Static Analyzerã€Cppcheck</td></tr><tr><td><strong>è¿è¡Œæ—¶æ’æ¡©</strong></td><td>ç¨‹åºè·‘èµ·æ¥åè·Ÿè¸ªæ¯ä¸€æ¬¡ç”³è¯·/é‡Šæ”¾</td><td>Valgrindã€AddressSanitizer (ASan)ã€Dr.Memory</td></tr><tr><td><strong>é‡è½½å…¨å±€ new/delete</strong></td><td>è‡ªå·±è®°è´¦ï¼šåœ¨å…¨å±€è¿ç®—ç¬¦é‡Œè®°å½•è°ƒç”¨æ ˆã€å¤§å°ã€æ˜¯å¦é…å¯¹</td><td>é€‚åˆå•å…ƒæµ‹è¯•é›†æˆ</td></tr><tr><td><strong>CRT è°ƒè¯•å †ï¼ˆWindowsï¼‰</strong></td><td><code>_CrtDumpMemoryLeaks()</code> è¾“å‡ºæ³„æ¼æ¸…å•</td><td>Visual Studio è°ƒè¯•å™¨</td></tr><tr><td><strong>æ™ºèƒ½æŒ‡é’ˆå®¡è®¡</strong></td><td>ç”¨ <code>weak_ptr</code> æ‰“ç ´å¾ªç¯å¼•ç”¨ï¼›å¼€å¯ <code>shared_ptr</code> è‡ªå®šä¹‰ deleter æ—¥å¿—</td><td>ç»“åˆä»£ç å®¡æŸ¥</td></tr></tbody></table>
<h4 data-id="heading-13">1.å¿«é€Ÿä¸Šæ‰‹ï¼šAddressSanitizerï¼ˆLinux / macOSï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">g++ -fsanitize=address -g leak.cpp -o leak
./leak
</code></pre>
<p>è¿è¡Œç»“æŸå³ç»™å‡º<strong>ç²¾ç¡®è¡Œå·</strong>ã€<strong>æ³„æ¼å¤§å°</strong>ä¸<strong>ç”³è¯·æ ˆå›æº¯</strong>ï¼Œæ— éœ€æ”¹åŠ¨æºç ã€‚</p>
<h4 data-id="heading-14">2.å¿«é€Ÿä¸Šæ‰‹ï¼šValgrind</h4>
<pre><code class="hljs language-bash" lang="bash">valgrind --leak-check=full ./your_program
</code></pre>
<p>ä¼šæŠ¥å‘Šï¼š</p>
<ul>
<li>ç»å¯¹æ³„æ¼ï¼ˆdefinitely lostï¼‰</li>
<li>é—´æ¥æ³„æ¼ï¼ˆindirectly lostï¼‰</li>
<li>å¯èƒ½æ³„æ¼ï¼ˆpossibly lostï¼‰</li>
</ul>
<h3 data-id="heading-15">C++ å†…å­˜æ³„æ¼æ£€æµ‹å·¥å…·ä¸€è§ˆ</h3>
<p>ä»¥ä¸‹å·¥å…·å‡å¯ç”¨äºå®šä½ C++ ç¨‹åºä¸­çš„å†…å­˜æ³„æ¼ï¼š</p>
<ol>
<li>
<p><strong>Valgrind</strong><br/>
å¼€æºã€è·¨å¹³å°çš„å†…å­˜è°ƒè¯•ä¸æ€§èƒ½åˆ†æåˆ©å™¨ã€‚å¯æ£€æµ‹æ³„æ¼ã€è¶Šç•Œè®¿é—®ã€ä½¿ç”¨å·²é‡Šæ”¾å†…å­˜ç­‰é—®é¢˜ï¼Œå¹¶ç»™å‡º<strong>è¯¦ç»†æºç çº§æŠ¥å‘Š</strong>ï¼ˆæ³„æ¼å¤§å°ã€ç”³è¯·æ ˆã€è°ƒç”¨é“¾ï¼‰ã€‚</p>
</li>
<li>
<p><strong>AddressSanitizerï¼ˆASanï¼‰</strong><br/>
ç°ä»£ GCC/Clang å†…ç½®çš„å¿«é€Ÿå†…å­˜é”™è¯¯æ£€æµ‹å™¨ã€‚<br/>
æ— éœ€é¢å¤–å®‰è£…ï¼Œåªè¦ç¼–è¯‘å™¨ç‰ˆæœ¬å¤Ÿæ–°ï¼ŒåŠ  <code>-fsanitize=address</code> å³å¯åœ¨è¿è¡Œæ—¶æ•è·æ³„æ¼åŠå…¶æ ˆå›æº¯ã€‚</p>
</li>
<li>
<p><strong>LeakSanitizerï¼ˆLSanï¼‰</strong><br/>
ä¸“æ³¨äºâ€œä»…æ³„æ¼â€åœºæ™¯çš„ç¼–è¯‘å™¨å·¥å…·ï¼Œé€šå¸¸ä¸ ASan ä¸€èµ·å·¥ä½œã€‚<br/>
GCC 4.9+ é»˜è®¤é›†æˆï¼ŒåŠ  <code>-fsanitize=leak</code> å³å¯å¯ç”¨ï¼ŒæŠ¥å‘Šç®€æ´ã€å®šä½ç²¾å‡†ã€‚</p>
</li>
<li>
<p><strong>Visual Studio è¯Šæ–­å·¥å…·</strong><br/>
VS è‡ªå¸¦â€œè¯Šæ–­å·¥å…·â€çª—å£ï¼Œå¯å¯¹è¿›ç¨‹æ‹å†…å­˜å¿«ç…§ï¼Œ<strong>å¯¹æ¯”ä¸¤æ¬¡å¿«ç…§</strong>çš„å †å—å·®å¼‚ï¼Œä¸€é”®å®šä½å¢é•¿æœ€å¿«çš„æ³„æ¼ç‚¹ã€‚</p>
</li>
<li>
<p><strong>Deleaker</strong><br/>
å•†ä¸šæ’ä»¶ï¼Œæ·±åº¦é›†æˆåˆ° Visual Studioã€‚åœ¨è°ƒè¯•è¿è¡ŒæœŸé—´å®æ—¶åˆ†æå †åˆ†é…ï¼Œ<strong>å¯è§†åŒ–</strong>å±•ç¤ºæ³„æ¼æ¨¡å—ã€å¤§å°ã€è°ƒç”¨æ ˆï¼Œæ”¯æŒåŸç”Ÿ C++ ä¸ .NET æ··åˆé¡¹ç›®ã€‚</p>
</li>
</ol>
<p>ä¸€å¥è¯é€‰å‹ï¼š</p>
<ul>
<li>Linux / macOSï¼š<strong>Valgrind</strong> æˆ– <strong>ASan</strong>ï¼ˆç¼–è¯‘å™¨è‡ªå¸¦ï¼Œé›¶æˆæœ¬ï¼‰</li>
<li>Windowsï¼š<strong>VS è¯Šæ–­å·¥å…·</strong> æ—¥å¸¸å¤Ÿç”¨ï¼Œ<strong>Deleaker</strong> æ·±åº¦å¯ä»˜è´¹</li>
<li>CI é›†æˆï¼š<strong>ASan + LSan</strong> æœ€å¿«æœ€è½»ï¼ŒæŠ¥é”™å³ä¸­æ­¢æ„å»º</li>
</ul>
<h4 data-id="heading-16">1.ä½¿ç”¨ Valgrind æ£€æµ‹ C++ å†…å­˜æ³„æ¼ç¤ºä¾‹</h4>
<p>ä¸‹é¢è¿™æ®µä»£ç åŠ¨æ€ç”³è¯·äº†ä¸€ä¸ªæ•°ç»„ï¼Œå´<strong>å¿˜äº† <code>delete[]</code></strong>ï¼Œé€ æˆæ˜æ˜¾æ³„æ¼ã€‚æˆ‘ä»¬ç”¨ Valgrind ä¸€æ­¥æ­¥æªå‡ºå®ƒã€‚</p>
<p>æºæ–‡ä»¶ï¼šmemory_leak.cpp</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">createLeak</span><span class="hljs-params">()</span>          <span class="hljs-comment">// æ•…æ„æ³„æ¼å‡½æ•°</span>
</span>{
    <span class="hljs-type">int</span>* arr = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">10</span>]; <span class="hljs-comment">// ç”³è¯· 10 ä¸ª intï¼ˆ40 B Ã— 10 = 400 Bï¼‰</span>
    <span class="hljs-comment">// å¿˜è®° delete[] arr;</span>
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-built_in">createLeak</span>();
    cout &lt;&lt; <span class="hljs-string">"Program finished."</span> &lt;&lt; endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>æ£€æµ‹æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰. ç¼–è¯‘ï¼ˆå¸¦è°ƒè¯•ä¿¡æ¯ï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">g++ -g -o memory_leak memory_leak.cpp
</code></pre>
<p>ï¼ˆ2ï¼‰. è¿è¡Œ Valgrind</p>
<pre><code class="hljs language-bash" lang="bash">valgrind --leak-check=full ./memory_leak
</code></pre>
<p>Valgrind è¾“å‡ºä¸­æ–‡è§£è¯»ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">==12345==</span> <span class="hljs-string">Memcheck,</span> <span class="hljs-string">a</span> <span class="hljs-string">memory</span> <span class="hljs-string">error</span> <span class="hljs-string">detector</span>
<span class="hljs-string">==12345==</span> <span class="hljs-string">Copyright</span> <span class="hljs-string">(C)</span> <span class="hljs-number">2002</span><span class="hljs-number">-2017</span><span class="hljs-string">,</span> <span class="hljs-string">and</span> <span class="hljs-string">GNU</span> <span class="hljs-string">GPL'd,</span> <span class="hljs-string">by</span> <span class="hljs-string">Julian</span> <span class="hljs-string">Seward</span> <span class="hljs-string">et</span> <span class="hljs-string">al.</span>
<span class="hljs-string">==12345==</span> <span class="hljs-string">Using</span> <span class="hljs-string">Valgrind-3.14.0</span> <span class="hljs-string">and</span> <span class="hljs-string">LibVEX;</span> <span class="hljs-string">rerun</span> <span class="hljs-string">with</span> <span class="hljs-string">-h</span> <span class="hljs-string">for</span> <span class="hljs-string">copyright</span> <span class="hljs-string">info</span>
<span class="hljs-string">==12345==</span> <span class="hljs-attr">Command:</span> <span class="hljs-string">./leaky_program</span>
<span class="hljs-string">==12345==</span> 
<span class="hljs-string">==12345==</span> 
<span class="hljs-string">==12345==</span> <span class="hljs-attr">HEAP SUMMARY:</span> <span class="hljs-string">å †æ‘˜è¦</span>
<span class="hljs-string">==12345==</span>     <span class="hljs-attr">in use at exit:</span> <span class="hljs-number">400</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">1</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span>   <span class="hljs-attr">total heap usage:</span> <span class="hljs-number">1</span> <span class="hljs-string">allocs,</span> <span class="hljs-number">0</span> <span class="hljs-string">frees,</span> <span class="hljs-number">400</span> <span class="hljs-string">bytes</span> <span class="hljs-string">allocated</span>
<span class="hljs-string">==12345==</span> 
<span class="hljs-string">==12345==</span> <span class="hljs-number">400</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">1</span> <span class="hljs-string">blocks</span> <span class="hljs-string">are</span> <span class="hljs-string">definitely</span> <span class="hljs-string">lost</span> <span class="hljs-string">in</span> <span class="hljs-string">loss</span> <span class="hljs-string">record</span> <span class="hljs-number">1</span> <span class="hljs-string">of</span> <span class="hljs-number">1</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">at 0x4C2AB80:</span> <span class="hljs-string">operator</span> <span class="hljs-string">new[](unsigned</span> <span class="hljs-string">long)</span> <span class="hljs-string">(vg_replace_malloc.c:423)</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">by 0x1091A9:</span> <span class="hljs-string">createMemoryLeak()</span> <span class="hljs-string">(leaky_program.cpp:7)</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">by 0x1091BF:</span> <span class="hljs-string">main</span> <span class="hljs-string">(leaky_program.cpp:11)</span>
<span class="hljs-string">==12345==</span> 
<span class="hljs-string">==12345==</span> <span class="hljs-attr">LEAK SUMMARY:</span> <span class="hljs-string">æ³„æ¼æ±‡æ€»</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">definitely lost:</span> <span class="hljs-number">400</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">1</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">indirectly lost:</span> <span class="hljs-number">0</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">0</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span>      <span class="hljs-attr">possibly lost:</span> <span class="hljs-number">0</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">0</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span>    <span class="hljs-attr">still reachable:</span> <span class="hljs-number">0</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">0</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span>         <span class="hljs-attr">suppressed:</span> <span class="hljs-number">0</span> <span class="hljs-string">bytes</span> <span class="hljs-string">in</span> <span class="hljs-number">0</span> <span class="hljs-string">blocks</span>
<span class="hljs-string">==12345==</span> 
<span class="hljs-string">==12345==</span> <span class="hljs-string">For</span> <span class="hljs-string">counts</span> <span class="hljs-string">of</span> <span class="hljs-string">detected</span> <span class="hljs-string">and</span> <span class="hljs-string">suppressed</span> <span class="hljs-string">errors,</span> <span class="hljs-attr">rerun with:</span> <span class="hljs-string">-v</span>
<span class="hljs-string">==12345==</span> <span class="hljs-attr">ERROR SUMMARY:</span> <span class="hljs-number">1</span> <span class="hljs-string">errors</span> <span class="hljs-string">from</span> <span class="hljs-number">1</span> <span class="hljs-string">contexts</span> <span class="hljs-string">(suppressed:</span> <span class="hljs-number">0</span> <span class="hljs-string">from</span> <span class="hljs-number">0</span><span class="hljs-string">)</span>

</code></pre>
<p>ç»“è®ºï¼š</p>
<ul>
<li><strong>400 å­—èŠ‚</strong> è¢«<strong>ç¡®å®šä¸¢å¤±</strong> â†’ 100% æ³„æ¼</li>
<li>æ³„æ¼ç‚¹ç²¾ç¡®æŒ‡å‘ <code>createLeak()</code> ç¬¬ 7 è¡Œ</li>
<li>ä¿®å¤æ–¹æ³•ï¼šåœ¨å‡½æ•°æœ«å°¾åŠ  <code>delete[] arr;</code> å³å¯è®© Valgrind æŠ¥å‘Š <strong>â€œ0 errorsâ€</strong>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ AI åä½œçš„æ–°èŒƒå¼ï¼šä»¥æ–‡æ¡£ä¸ºä¸­å¿ƒçš„å¼€å‘å®è·µ]]></title>    <link>https://juejin.cn/post/7571892340877459494</link>    <guid>https://juejin.cn/post/7571892340877459494</guid>    <pubDate>2025-11-13T05:43:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571892340877459494" data-draft-id="7571829822340448307" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ AI åä½œçš„æ–°èŒƒå¼ï¼šä»¥æ–‡æ¡£ä¸ºä¸­å¿ƒçš„å¼€å‘å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-13T05:43:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹–æ‹‰æ–¯æ—‹é£"/> <meta itemprop="url" content="https://juejin.cn/user/951508170179208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ AI åä½œçš„æ–°èŒƒå¼ï¼šä»¥æ–‡æ¡£ä¸ºä¸­å¿ƒçš„å¼€å‘å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/951508170179208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹–æ‹‰æ–¯æ—‹é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:43:05.000Z" title="Thu Nov 13 2025 05:43:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€”â€”å¦‚ä½•é«˜æ•ˆä½¿ç”¨ Trae ç­‰ AI ç¼–ç¨‹æ‰©å±•æ’ä»¶</p>
<blockquote>
<p><strong>æ ¸å¿ƒç†å¿µ</strong>ï¼šåœ¨ AI æ—¶ä»£ï¼Œ<strong>coding ä¸å†æ˜¯ç“¶é¢ˆï¼Œä¸Šä¸‹æ–‡æ‰æ˜¯ç”Ÿäº§åŠ›</strong>ã€‚<br/>
æˆ‘ä»¬ä¸å†â€œå†™ä»£ç â€ï¼Œè€Œæ˜¯â€œå¼•å¯¼ AI å†™å‡ºæ­£ç¡®çš„ä»£ç â€â€”â€”è€Œè¿™ä¸€åˆ‡ï¼Œå§‹äº<strong>é«˜è´¨é‡çš„æ–‡æ¡£</strong>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆæ–‡æ¡£æ¯”ä»£ç æ›´é‡è¦ï¼Ÿ</h2>
<p>è¿‡å»ï¼Œå¼€å‘è€…çš„æ ¸å¿ƒèƒ½åŠ›æ˜¯â€œæŠŠé€»è¾‘å˜æˆä»£ç â€ã€‚<br/>
å¦‚ä»Šï¼ŒAIï¼ˆå¦‚ GitHub Copilotã€Traeã€Cursorï¼‰èƒ½ç¬é—´ç”Ÿæˆåƒè¡Œä»£ç ï¼Œä½†å‰ææ˜¯â€”â€”<strong>ä½ å¾—å‘Šè¯‰å®ƒâ€œè¦ä»€ä¹ˆâ€å’Œâ€œä¸è¦ä»€ä¹ˆâ€</strong> ã€‚</p>
<p>è€Œè¿™ä¸ªâ€œå‘Šè¯‰â€çš„è¿‡ç¨‹ï¼Œå°±æ˜¯<strong>æ„å»ºæ¸…æ™°ã€ç»“æ„åŒ–çš„ä¸Šä¸‹æ–‡</strong>ï¼Œå…¶è½½ä½“æ­£æ˜¯ï¼š</p>
<ul>
<li>âœ… æŠ€æœ¯æ–‡æ¡£ï¼ˆæ¶æ„è¯´æ˜ã€æŠ€æœ¯é€‰å‹ï¼‰</li>
<li>âœ… éœ€æ±‚æ–‡æ¡£ï¼ˆç”¨æˆ·æ•…äº‹ã€åŠŸèƒ½æ¸…å•ï¼‰</li>
<li>âœ… è®¾è®¡ç¨¿ / çº¿æ¡†å›¾ï¼ˆUI ç»“æ„ã€äº¤äº’æµç¨‹ï¼‰</li>
<li>âœ… æ¥å£æ–‡æ¡£ï¼ˆAPI å®šä¹‰ã€å­—æ®µè¯´æ˜ï¼‰</li>
<li>âœ… æµ‹è¯•æ–‡æ¡£ï¼ˆéªŒæ”¶æ ‡å‡†ã€è¾¹ç•Œç”¨ä¾‹ï¼‰</li>
</ul>
<blockquote>
<p>ğŸŒŸ <strong>å…³é”®è½¬å˜</strong>ï¼š<br/>
ä» â€œHow to codeâ€ â†’ è½¬å‘ â€œWhat to build &amp; Whyâ€</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€Trae æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå¦‚ä½•å·¥ä½œï¼Ÿ</h2>
<p><strong>Trae</strong> æ˜¯ä¸€æ¬¾åŸºäºå¤§æ¨¡å‹çš„æ™ºèƒ½ç¼–ç¨‹åŠ©æ‰‹ï¼ˆç±»ä¼¼ Cursor æˆ– CodeWhispererï¼‰ï¼Œå¯é›†æˆåˆ° VS Code ç­‰ç¼–è¾‘å™¨ä¸­ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>æ ¹æ®è‡ªç„¶è¯­è¨€ç”Ÿæˆå®Œæ•´åŠŸèƒ½æ¨¡å—</li>
<li>è‡ªåŠ¨è¡¥å…¨ç»„ä»¶ã€API è°ƒç”¨ã€æµ‹è¯•ç”¨ä¾‹</li>
<li>ç†è§£é¡¹ç›®ä¸Šä¸‹æ–‡å¹¶ä¿æŒä¸€è‡´æ€§</li>
</ul>
<p>ä½†å®ƒ<strong>ä¸æ“…é•¿</strong>ï¼š</p>
<ul>
<li>æ¨¡ç³Šä¸æ¸…çš„éœ€æ±‚</li>
<li>ç¼ºä¹çº¦æŸçš„è‡ªç”±å‘æŒ¥</li>
<li>å¤æ‚ä¸šåŠ¡é€»è¾‘çš„è‡ªä¸»æ¨ç†</li>
<li>å¯¹â€œç”¨æˆ·ä½“éªŒâ€â€œäº§å“æ„å›¾â€çš„ç†è§£</li>
</ul>
<blockquote>
<p>ğŸ”§ å› æ­¤ï¼Œ<strong>æˆ‘ä»¬çš„è§’è‰²å˜äº†</strong>ï¼š<br/>
ä¸å†æ˜¯â€œç¼–ç è€…â€ï¼Œè€Œæ˜¯â€œ<strong>AI çš„äº§å“ç»ç† + æ¶æ„å¸ˆ + QA</strong>â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€é«˜æ•ˆä½¿ç”¨ Trae çš„åä½œæ–¹æ³•è®ºï¼ˆVibe åä½œï¼‰</h2>
<h3 data-id="heading-3">Step 1ï¼šå…ˆå»ºæ–‡æ¡£ï¼Œå†å”¤ AI</h3>
<p>åœ¨æ‰“å¼€ Trae å‰ï¼Œè¯·å…ˆå‡†å¤‡å¥½ä»¥ä¸‹ä»»ä¸€å½¢å¼çš„ä¸Šä¸‹æ–‡ï¼š</p>





























<table><thead><tr><th>æ–‡æ¡£ç±»å‹</th><th>ç¤ºä¾‹å†…å®¹</th></tr></thead><tbody><tr><td><strong>éœ€æ±‚æ–‡æ¡£</strong></td><td>â€œç”¨æˆ·ç™»å½•é¡µéœ€æ”¯æŒæ‰‹æœºå·+éªŒè¯ç ï¼Œé”™è¯¯æç¤ºå®æ—¶æ˜¾ç¤ºâ€</td></tr><tr><td><strong>çº¿æ¡†å›¾</strong></td><td>ç”¨ Figma/Excalidraw ç”»å‡ºå¸ƒå±€ï¼šè¾“å…¥æ¡†ã€æŒ‰é’®ã€é”™è¯¯åŒºåŸŸä½ç½®</td></tr><tr><td><strong>ç›®å½•æ¶æ„</strong></td><td><code>src/pages/Login/</code>Â ä¸‹åŒ…å«Â <code>index.tsx</code>,Â <code>useLogin.ts</code>,Â <code>styles.css</code></td></tr><tr><td><strong>æ¥å£æ–‡æ¡£</strong></td><td><code>POST /api/login { phone: string, code: string } â†’ { token: string }</code></td></tr><tr><td><strong>æµ‹è¯•è¦ç‚¹</strong></td><td>â€œéªŒè¯ç ä¸ºç©ºæ—¶ï¼Œåº”é˜»æ­¢æäº¤å¹¶é«˜äº®è¾“å…¥æ¡†â€</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>æŠ€å·§</strong>ï¼šæŠŠè¿™äº›æ–‡æ¡£æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆå¦‚ <code>/docs</code>ï¼‰ï¼Œæˆ–ç›´æ¥ç²˜è´´åˆ° Trae çš„èŠå¤©çª—å£ä½œä¸ºä¸Šä¸‹æ–‡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">Step 2ï¼šç”¨â€œæŒ‡ä»¤ + çº¦æŸâ€å¼•å¯¼ç”Ÿæˆ</h3>
<p>âŒ é”™è¯¯ç¤ºèŒƒï¼š</p>
<blockquote>
<p>â€œå¸®æˆ‘å†™ä¸ªç™»å½•é¡µé¢â€</p>
</blockquote>
<p>âœ… æ­£ç¡®ç¤ºèŒƒï¼š</p>
<blockquote>
<p>â€œåŸºäºä»¥ä¸‹éœ€æ±‚ï¼Œç”¨ React + TypeScript å®ç°ç™»å½•é¡µï¼š</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥æ‰‹æœºå·ï¼ˆ11ä½æ ¡éªŒï¼‰å’Œ6ä½éªŒè¯ç </li>
<li>ç‚¹å‡»â€˜è·å–éªŒè¯ç â€™åå€’è®¡æ—¶60ç§’</li>
<li>æäº¤æ—¶è°ƒç”¨Â <code>/api/login</code>ï¼Œå¤±è´¥æ—¶æ˜¾ç¤ºçº¢è‰²é”™è¯¯æç¤º</li>
<li>ä½¿ç”¨ Tailwind CSS æ ·å¼ï¼Œå‚è€ƒçº¿æ¡†å›¾å¸ƒå±€ï¼ˆè§é™„ä»¶ï¼‰</li>
<li>æ–‡ä»¶ç»“æ„ï¼š<code>Login/index.tsx</code>,Â <code>Login/useLoginHook.ts</code>â€</li>
</ul>
</blockquote>
<blockquote>
<p>ğŸ¯ <strong>æ•ˆæœ</strong>ï¼šAI è¾“å‡ºæ›´ç²¾å‡†ã€å¯ç›´æ¥ä½¿ç”¨çš„ä»£ç ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">Step 3ï¼šäººç±»è´Ÿè´£â€œç›‘ç£â€ä¸â€œå†³ç­–â€</h3>
<p>AI ç”Ÿæˆçš„ä»£ç éœ€è¦æˆ‘ä»¬é‡ç‚¹æ£€æŸ¥ï¼š</p>

























<table><thead><tr><th>æ£€æŸ¥é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å®‰å…¨æ€§</strong></td><td>æ˜¯å¦æœ‰ XSSã€CSRF é£é™©ï¼Ÿå¯†ç æ˜¯å¦æ˜æ–‡ä¼ è¾“ï¼Ÿ</td></tr><tr><td><strong>å¥å£®æ€§</strong></td><td>è¾¹ç•Œæƒ…å†µå¤„ç†äº†å—ï¼Ÿç½‘ç»œå¤±è´¥æœ‰é‡è¯•å—ï¼Ÿ</td></tr><tr><td><strong>ä¸€è‡´æ€§</strong></td><td>å‘½åé£æ ¼ã€çŠ¶æ€ç®¡ç†æ–¹å¼æ˜¯å¦ç¬¦åˆé¡¹ç›®è§„èŒƒï¼Ÿ</td></tr><tr><td><strong>å¯ç»´æŠ¤æ€§</strong></td><td>é€»è¾‘æ˜¯å¦è¿‡äºè€¦åˆï¼Ÿæ˜¯å¦éœ€è¦æ‹†åˆ† Hookï¼Ÿ</td></tr></tbody></table>
<blockquote>
<p>ğŸ‘©â€ğŸ’» <strong>æˆ‘ä»¬çš„ä»·å€¼</strong>ï¼šä¸æ˜¯å†™æ¯ä¸€è¡Œä»£ç ï¼Œè€Œæ˜¯<strong>ç¡®ä¿ AI å†™å¯¹äº†æ–¹å‘</strong>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">Step 4ï¼šæŒç»­è¿­ä»£æ–‡æ¡£ï¼Œå½¢æˆé—­ç¯</h3>
<ul>
<li>å½“ AI äº§å‡ºä¸ç¬¦åˆé¢„æœŸ â†’Â <strong>è¡¥å……æ–‡æ¡£ç»†èŠ‚</strong></li>
<li>å½“å‘ç°æ–°éœ€æ±‚ â†’Â <strong>æ›´æ–°éœ€æ±‚æ–‡æ¡£ + é€šçŸ¥ AI</strong></li>
<li>å½“æ¶æ„è°ƒæ•´ â†’Â <strong>åŒæ­¥ä¿®æ”¹ç›®å½•è¯´æ˜å’ŒæŠ€æœ¯å†³ç­–è®°å½•</strong></li>
</ul>
<blockquote>
<p>ğŸ”„ <strong>æ–‡æ¡£å³å¥‘çº¦</strong>ï¼šå®ƒæ˜¯äººä¸ AI ä¹‹é—´çš„â€œæ²Ÿé€šåè®®â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">å››ã€å®æˆ˜æ¡ˆä¾‹ï¼šç”¨ Trae å¼€å‘ä¸€ä¸ª Todo List</h2>
<h3 data-id="heading-8">1. å…ˆå†™éœ€æ±‚æ–‡æ¡£ï¼ˆ<code>/docs/todo-requirements.md</code>ï¼‰</h3>
<pre><code class="hljs language-markdown" lang="markdown">md
ç¼–è¾‘
<span class="hljs-section">## åŠŸèƒ½æ¸…å•</span>
<span class="hljs-bullet">-</span> [ ] æ˜¾ç¤ºå¾…åŠäº‹é¡¹åˆ—è¡¨ï¼ˆæ ‡é¢˜ + å®ŒæˆçŠ¶æ€ï¼‰
<span class="hljs-bullet">-</span> [ ] å¯æ·»åŠ æ–°ä»»åŠ¡ï¼ˆè¾“å…¥æ¡† + å›è½¦æäº¤ï¼‰
<span class="hljs-bullet">-</span> [ ] ç‚¹å‡»å¤é€‰æ¡†åˆ‡æ¢å®ŒæˆçŠ¶æ€
<span class="hljs-bullet">-</span> [ ] æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageï¼‰ï¼Œåˆ·æ–°ä¸ä¸¢å¤±
<span class="hljs-bullet">-</span> [ ] åˆ é™¤å•ä¸ªä»»åŠ¡

<span class="hljs-section">## æŠ€æœ¯æ ˆ</span>
<span class="hljs-bullet">-</span> React 18 + TypeScript
<span class="hljs-bullet">-</span> æ— å¤–éƒ¨çŠ¶æ€åº“ï¼ˆç”¨ useState + useEffectï¼‰
<span class="hljs-bullet">-</span> æ ·å¼ï¼šTailwind CSS
</code></pre>
<h3 data-id="heading-9">2. åœ¨ Trae ä¸­è¾“å…¥ï¼š</h3>
<blockquote>
<p>â€œè¯·æ ¹æ® <code>/docs/todo-requirements.md</code> å®ç° Todo List ç»„ä»¶ï¼Œæ–‡ä»¶æ”¾åœ¨ <code>src/components/TodoList/</code>ï¼ŒåŒ…å« index.tsx å’Œ types.tsã€‚â€</p>
</blockquote>
<h3 data-id="heading-10">3. å®¡æŸ¥å¹¶å¾®è°ƒ</h3>
<ul>
<li>æ£€æŸ¥ localStorage æ˜¯å¦æ­£ç¡®åºåˆ—åŒ–</li>
<li>è¡¥å……é”®ç›˜äº‹ä»¶ï¼ˆEnter æäº¤ï¼‰</li>
<li>è°ƒæ•´ Tailwind ç±»åå¯¹é½è®¾è®¡</li>
</ul>
<hr/>
<h2 data-id="heading-11">äº”ã€ç»™å¼€å‘è€…çš„è¡ŒåŠ¨å»ºè®®</h2>
<ol>
<li><strong>å…»æˆå…ˆå†™æ–‡æ¡£çš„ä¹ æƒ¯</strong>ï¼šå“ªæ€•åªæœ‰ 5 è¡Œéœ€æ±‚è¯´æ˜ã€‚</li>
<li><strong>å–„ç”¨è‰å›¾å·¥å…·</strong>ï¼šExcalidrawã€Whimsical å¿«é€Ÿç”»çº¿æ¡†å›¾ã€‚</li>
<li><strong>ç»“æ„åŒ–ä½ çš„æŒ‡ä»¤</strong>ï¼šæ˜ç¡®æŠ€æœ¯æ ˆã€æ–‡ä»¶è·¯å¾„ã€äº¤äº’ç»†èŠ‚ã€‚</li>
<li><strong>ä¸è¦ç›²ç›®ä¿¡ä»» AI</strong>ï¼šå§‹ç»ˆåšâ€œæœ€åä¸€é“é˜²çº¿â€ã€‚</li>
<li><strong>æŠŠæ–‡æ¡£çº³å…¥ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šè®©å›¢é˜Ÿå’Œ AI å…±äº«åŒä¸€ä»½ä¸Šä¸‹æ–‡ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-12">ç»“è¯­ï¼šæœªæ¥çš„å¼€å‘è€…ï¼Œæ˜¯â€œä¸Šä¸‹æ–‡å·¥ç¨‹å¸ˆâ€</h2>
<blockquote>
<p>Coding is cheap. Context is king.</p>
</blockquote>
<p>åœ¨ AI æ—¶ä»£ï¼Œ<strong>æœ€ç¨€ç¼ºçš„èƒ½åŠ›ä¸å†æ˜¯è¯­æ³•ç†Ÿç»ƒåº¦ï¼Œè€Œæ˜¯æ¸…æ™°è¡¨è¾¾æ„å›¾ã€æ„å»ºæœ‰æ•ˆä¸Šä¸‹æ–‡çš„èƒ½åŠ›</strong>ã€‚<br/>
å­¦ä¼šç”¨æ–‡æ¡£â€œå–‚å…»â€AIï¼Œä½ å°±èƒ½ä»é‡å¤åŠ³åŠ¨ä¸­è§£æ”¾ï¼Œä¸“æ³¨åœ¨çœŸæ­£åˆ›é€ ä»·å€¼çš„åœ°æ–¹â€”â€”äº§å“è®¾è®¡ã€ç”¨æˆ·ä½“éªŒã€ç³»ç»Ÿæ¶æ„ã€‚</p>
<p>è€Œè¿™ï¼Œæ‰æ˜¯<strong>ä¸‹ä¸€ä»£å¼€å‘è€…çš„æ ¸å¿ƒç«äº‰åŠ›</strong>ã€‚</p>
<hr/>
<blockquote>
<p>ğŸ“š <strong>å»¶ä¼¸é˜…è¯»</strong></p>
<ul>
<li>ã€ŠPrompt Engineering for Developersã€‹</li>
<li>Googleâ€™s â€œAI Readinessâ€ æ–‡æ¡£è§„èŒƒæŒ‡å—</li>
<li>Trae å®˜æ–¹æœ€ä½³å®è·µï¼š<a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">trae.ai/docs/best-pâ€¦</a></li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MessageChannel-é€šä¿¡æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7571830282849566771</link>    <guid>https://juejin.cn/post/7571830282849566771</guid>    <pubDate>2025-11-13T05:50:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571830282849566771" data-draft-id="7571829822340415539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MessageChannel-é€šä¿¡æœºåˆ¶"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-13T05:50:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åº“å…‹è¡¨ç¤º"/> <meta itemprop="url" content="https://juejin.cn/user/888061128105479"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MessageChannel-é€šä¿¡æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/888061128105479/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åº“å…‹è¡¨ç¤º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:50:55.000Z" title="Thu Nov 13 2025 05:50:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">MessageChannel - å‰ç«¯æŠ€æœ¯</h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è¿›è¡Œä¸åŒçº¿ç¨‹ã€çª—å£æˆ–æ¡†æ¶ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ã€‚ä¼ ç»Ÿçš„ <code>postMessage</code> æä¾›äº†è·¨æ–‡æ¡£é€šä¿¡çš„èƒ½åŠ›ï¼Œä½†å½“æˆ‘ä»¬éœ€è¦æ›´åŠ é«˜æ•ˆçš„åŒå‘é€šä¿¡æ—¶ï¼Œ<code>MessageChannel</code> å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ <code>MessageChannel</code> çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¼˜ç¼ºç‚¹ï¼Œå…¼å®¹æ€§ä»¥åŠè§£å†³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-2">MessageChannel åŸºç¡€</h3>
<h4 data-id="heading-3">ä»€ä¹ˆæ˜¯ <code>MessageChannel</code></h4>
<p><code>MessageChannel</code> æ˜¯ä¸€ç§ç”¨äºåœ¨ JavaScript çº¿ç¨‹ä¹‹é—´è¿›è¡ŒåŒå‘é€šä¿¡çš„æœºåˆ¶ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒçº¿ç¨‹ï¼ˆå¦‚ä¸»çº¿ç¨‹å’Œ Web Workerï¼‰æˆ–ä¸åŒçª—å£ã€iframe ä¹‹é—´å‘é€æ¶ˆæ¯ã€‚ä¸ä¼ ç»Ÿçš„ <code>postMessage</code> ä¸åŒï¼Œ<code>MessageChannel</code> æä¾›äº†æ›´é«˜æ•ˆçš„é€šä¿¡æ–¹å¼ï¼Œå°¤å…¶é€‚åˆåŒå‘ã€ä½å»¶è¿Ÿçš„æ•°æ®ä¼ è¾“åœºæ™¯ã€‚</p>
<h4 data-id="heading-4">åˆ›å»º <code>MessageChannel</code> å¯¹è±¡</h4>
<p>è¦åˆ›å»ºä¸€ä¸ª <code>MessageChannel</code> å¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ <code>new MessageChannel()</code>ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªç«¯å£çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
<span class="hljs-keyword">const</span> port1 = channel.<span class="hljs-property">port1</span>;
<span class="hljs-keyword">const</span> port2 = channel.<span class="hljs-property">port2</span>;
</code></pre>
<h4 data-id="heading-5">å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„åŸºæœ¬ç”¨æ³•</h4>
<p>æ¯ä¸ªç«¯å£ï¼ˆ<code>port1</code> æˆ– <code>port2</code>ï¼‰å¯ä»¥ç”¨æ¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚æ¶ˆæ¯çš„å‘é€é€šè¿‡ <code>postMessage</code> æ–¹æ³•ï¼Œæ¥æ”¶æ¶ˆæ¯åˆ™é€šè¿‡ <code>onmessage</code> äº‹ä»¶å¤„ç†å™¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">port1.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥æ”¶åˆ°æ¶ˆæ¯ï¼š'</span>, event.<span class="hljs-property">data</span>);
};

port2.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello from port2'</span>);
</code></pre>
<h3 data-id="heading-6">é«˜çº§ç”¨æ³•</h3>
<h4 data-id="heading-7">ä½¿ç”¨ <code>MessageChannel</code> åœ¨ Web Workers ä¸­é€šä¿¡</h4>
<p><code>MessageChannel</code> å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸»çº¿ç¨‹å’Œ Web Worker ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚é€šè¿‡åˆ›å»ºä¸¤ä¸ªç«¯å£ï¼Œä¸€ä¸ªåœ¨ä¸»çº¿ç¨‹ï¼Œä¸€ä¸ªåœ¨ Worker ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°é«˜æ•ˆçš„åŒå‘é€šä¿¡ã€‚</p>
<h5 data-id="heading-8">ä¸»çº¿ç¨‹ä»£ç ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸»çº¿ç¨‹ä»£ç </span>
<span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>);

<span class="hljs-comment">// å‘ Worker å‘é€æ¶ˆæ¯ï¼Œå¹¶é€šè¿‡ port2 ä¼ é€’é€šä¿¡ç«¯å£</span>
worker.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'å¼€å§‹å·¥ä½œ'</span>, [channel.<span class="hljs-property">port2</span>]);

<span class="hljs-comment">// ç›‘å¬æ¥è‡ª Worker çš„æ¶ˆæ¯</span>
channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸»çº¿ç¨‹æ¥æ”¶åˆ°æ¥è‡ª Worker çš„æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
};
</code></pre>
<h5 data-id="heading-9">Worker ä»£ç ï¼ˆ<code>worker.js</code>ï¼‰ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Worker ä»£ç </span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥æ”¶åˆ°ä¸»çº¿ç¨‹æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">const</span> port = event.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>]; <span class="hljs-comment">// è·å– port2</span>
  port.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Worker å¤„ç†å®Œçš„æ¶ˆæ¯'</span>);  <span class="hljs-comment">// å‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯</span>
};
</code></pre>
<h4 data-id="heading-10">ä½¿ç”¨ <code>MessageChannel</code> åœ¨å¤šä¸ª Web Workers ä¹‹é—´è¿›è¡Œé€šä¿¡</h4>
<p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦å’Œå¤šä¸ª Web Workers è¿›è¡Œé€šä¿¡ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡åˆ›å»ºå¤šä¸ª <code>MessageChannel</code> ç«¯å£è¿›è¡Œç‹¬ç«‹çš„åŒå‘é€šä¿¡ã€‚</p>
<h5 data-id="heading-11">ä¸»çº¿ç¨‹ä»£ç ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºå¤šä¸ª MessageChannel å®ä¾‹</span>
<span class="hljs-keyword">const</span> channel1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
<span class="hljs-keyword">const</span> channel2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();

<span class="hljs-comment">// åˆ›å»ºä¸¤ä¸ª Worker</span>
<span class="hljs-keyword">const</span> worker1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker1.js'</span>);
<span class="hljs-keyword">const</span> worker2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker2.js'</span>);

<span class="hljs-comment">// å‘ Worker å‘é€æ¶ˆæ¯å¹¶ä¼ é€’ç«¯å£</span>
worker1.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'å¯åŠ¨ worker1'</span>, [channel1.<span class="hljs-property">port2</span>]);
worker2.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'å¯åŠ¨ worker2'</span>, [channel2.<span class="hljs-property">port2</span>]);

<span class="hljs-comment">// ç›‘å¬ Worker è¿”å›çš„æ¶ˆæ¯</span>
channel1.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸»çº¿ç¨‹æ¥æ”¶åˆ° worker1 çš„æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
};

channel2.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸»çº¿ç¨‹æ¥æ”¶åˆ° worker2 çš„æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
};
</code></pre>
<h5 data-id="heading-12">worker1.jsï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript">self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Worker1 æ¥æ”¶åˆ°æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">const</span> port = event.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
  port.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Worker1 æ‰§è¡Œå®Œæ¯•'</span>);
};
</code></pre>
<h5 data-id="heading-13">worker2.jsï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript">self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Worker2 æ¥æ”¶åˆ°æ¶ˆæ¯:'</span>, event.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">const</span> port = event.<span class="hljs-property">ports</span>[<span class="hljs-number">0</span>];
  port.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Worker2 æ‰§è¡Œå®Œæ¯•'</span>);
};
</code></pre>
<h3 data-id="heading-14">å…¼å®¹æ€§å’Œä¼˜ç¼ºç‚¹</h3>
<h4 data-id="heading-15">æµè§ˆå™¨å…¼å®¹æ€§</h4>
<p><code>MessageChannel</code> æ˜¯ä¸€ç§ç›¸å¯¹è¾ƒæ–°çš„ APIï¼Œè™½ç„¶ç°ä»£æµè§ˆå™¨æ™®éæ”¯æŒå®ƒï¼Œä½†åœ¨æ—§ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­å¯èƒ½ä¸å®Œå…¨å…¼å®¹ã€‚è¯·å‚è€ƒä»¥ä¸‹è¡¨æ ¼ä»¥äº†è§£å…¶å…¼å®¹æ€§ï¼š</p>





























<table><thead><tr><th>æµè§ˆå™¨</th><th>ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Chrome</td><td>49+</td></tr><tr><td>Firefox</td><td>44+</td></tr><tr><td>Safari</td><td>10+</td></tr><tr><td>Edge</td><td>14+</td></tr><tr><td>IE</td><td>ä¸æ”¯æŒ</td></tr></tbody></table>
<h4 data-id="heading-16"><code>MessageChannel</code> çš„ä¼˜ç¼ºç‚¹</h4>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>é«˜æ•ˆçš„åŒå‘é€šä¿¡ã€‚</li>
<li>æä¾›äº†ä¸ <code>postMessage</code> ç›¸æ¯”æ›´ä½çš„å»¶è¿Ÿã€‚</li>
<li>æ”¯æŒè·¨çº¿ç¨‹ã€è·¨çª—å£é€šä¿¡ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ä¸æ”¯æŒæ‰€æœ‰æµè§ˆå™¨ï¼Œç‰¹åˆ«æ˜¯ IE å’Œä¸€äº›è€ç‰ˆæœ¬çš„æµè§ˆå™¨ã€‚</li>
<li>å¯¹äºç®€å•çš„é€šä¿¡åœºæ™¯ï¼Œå¯èƒ½ä¸å¦‚ <code>postMessage</code> æ›´æ–¹ä¾¿ã€‚</li>
</ul>
<h3 data-id="heading-17">è§£å†³çš„é—®é¢˜</h3>
<p><code>MessageChannel</code> è§£å†³äº† <code>postMessage</code> åœ¨åŒå‘é€šä¿¡æ—¶çš„å»¶è¿Ÿé—®é¢˜ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦ä½å»¶è¿Ÿã€é«˜é¢‘æ¬¡çš„æ¶ˆæ¯ä¼ è¾“åœºæ™¯ã€‚æ­¤å¤–ï¼Œå®ƒä¸ºå¤šçº¿ç¨‹å’Œ Web Worker ä¹‹é—´çš„é€šä¿¡æä¾›äº†æ›´ç®€å•ã€æ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-18">æ€»ç»“</h3>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º <code>MessageChannel</code> æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆåŒå‘ã€ä½å»¶è¿Ÿé€šä¿¡çš„ APIã€‚å®ƒè§£å†³äº† <code>postMessage</code> çš„ä¸€äº›å±€é™æ€§ï¼Œå°¤å…¶æ˜¯åœ¨ Web Worker æˆ–å¤šçº¿ç¨‹é€šä¿¡ä¸­çš„åº”ç”¨ã€‚è™½ç„¶åœ¨å…¼å®¹æ€§æ–¹é¢è¿˜éœ€è¦è¿›ä¸€æ­¥è€ƒè™‘ï¼Œä½†å¯¹äºç°ä»£æµè§ˆå™¨ï¼Œå®ƒæä¾›äº†æ›´é«˜æ•ˆã€çµæ´»çš„é€šä¿¡æ–¹å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰¯ä¸šæä¸ª 100 ä¸‡ï¼Œè¿™ 5 ä¸ª GitHub é¡¹ç›®ä¸èƒ½é”™è¿‡ã€‚]]></title>    <link>https://juejin.cn/post/7571753301898117160</link>    <guid>https://juejin.cn/post/7571753301898117160</guid>    <pubDate>2025-11-13T05:51:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571753301898117160" data-draft-id="7571702660933959695" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰¯ä¸šæä¸ª 100 ä¸‡ï¼Œè¿™ 5 ä¸ª GitHub é¡¹ç›®ä¸èƒ½é”™è¿‡ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-11-13T05:51:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰¯ä¸šæä¸ª 100 ä¸‡ï¼Œè¿™ 5 ä¸ª GitHub é¡¹ç›®ä¸èƒ½é”™è¿‡ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:51:29.000Z" title="Thu Nov 13 2025 05:51:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">01ã€ä¸€äººä¼ä¸šæ–¹æ³•è®º</h2>
<p>å¼€æºé¡¹ç›®åå­—å«åšã€Šä¸€äººä¼ä¸šæ–¹æ³•è®ºã€‹ï¼Œç›®å‰å·²ç»æ›´æ–°åˆ°ç¬¬äºŒç‰ˆã€‚ä¸“é—¨ä¸ºæƒ³è¦ç‹¬ç«‹åˆ›ä¸šæˆ–å¼€å±•å‰¯ä¸šçš„ä¸ªäººæä¾›å®ç”¨æŒ‡å¯¼ã€‚</p>
<p>æ— è®ºæ˜¯åšè‡ªåª’ä½“ã€ç”µå•†è¿˜æ˜¯æ•°å­—å•†å“ï¼Œå³ä½¿æ²¡æœ‰æŠ€æœ¯èƒŒæ™¯ï¼Œä¹Ÿèƒ½ä»ä¸­è·å¾—å¯å‘ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1efc85e417c84604bace595e6176db4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=jZg4yCNgfHiZoaTMJ6%2Fai21Bg%2Fc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘è¯»ä¸‹æ¥ï¼Œè¿™ä¸ªå¼€æºé¡¹ç›®çš„æ ¸å¿ƒæ€æƒ³å’Œæˆ‘çš„æƒ³æ³•éå¸¸å¥‘åˆã€‚å®ƒå€¡å¯¼ä¸€ç§<strong>ä»¥ä¸ªäººä¸ºæ ¸å¿ƒã€ç²¾ç›ŠåŒ–ã€å¯æŒç»­çš„å•†ä¸šæ¨¡å¼</strong>ã€‚Â </p>
<p>å®ƒä¸è¿½æ±‚è§„æ¨¡åŒ–å¢é•¿å’Œèµ„æœ¬é©±åŠ¨ï¼Œè€Œæ˜¯ä¸“æ³¨äºåˆ©ç”¨ç°ä»£æŠ€æœ¯å·¥å…·å’Œç³»ç»ŸåŒ–æ–¹æ³•è®ºï¼Œè®©ä¸ªäººèƒ½å¤Ÿç‹¬ç«‹æ„å»ºå¹¶è¿è¥ä¸€ä¸ªå¥åº·ã€ç›ˆåˆ©çš„å¾®å‹ä¼ä¸šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff7dccfcceda47279d92e0627782d32b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=VUQ7JL1cQXjFEgthp46s8zg0P9g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦‚æœä½ åŒå€¦äº†å¤§å‚çš„æ’•é€¼ï¼Œæ— æ•ˆäº†çš„å†…å·ï¼Œæƒ³æ‰¾å¯»ä¸€ä»½é è°±çš„å‰¯ä¸šã€‚å»ºè®®å¯ä»¥å…ˆæµè§ˆä¸‹è¿™ä¸ªå¼€æºé¡¹ç›®ã€‚å°¤å…¶æ˜¯è‡ªç”±èŒä¸šè€…ï¼Œæƒ³è¦å°†ä¸ªäººæœåŠ¡äº§å“åŒ–ï¼Œå»ºç«‹å¯æŒç»­çš„æ”¶å…¥æ¨¡å¼çš„è¯»è€…ã€‚è€Œä¸”å¼€å‘è€…è¿˜å‘æ˜äº†ä¸€ä¸ªåˆ›ä¸šæ¨¡æ‹Ÿå™¨ï¼Œè¿˜æŒºæœ‰æ„æ€çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e77a21fe7e5044f8b1f6fff1e2dfc1c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=dS6a%2F5BQQIoljJTNHy%2FMtMUa6KI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªæ¨¡æ‹Ÿå™¨æ˜¯ä¸€ä¸ªå¤æ‚çš„<strong>æç¤ºè¯</strong>ï¼Œå‘ç»™ AI åï¼ŒAI ä¼šæ‰®æ¼”ä¸€ä¸ªã€Œåˆ›ä¸šå‹åŠ›æµ‹è¯•å‘˜ã€ï¼Œæ ¹æ®ä½ æä¾›çš„åˆ›ä¸šæƒ³æ³•ï¼Œè¿›è¡Œä¸€åœºé«˜åº¦ç°å®ã€æ•°æ®é©±åŠ¨çš„æ¨æ¼”ã€‚åœ¨ä½ æŠ•å…¥å¤§é‡æ—¶é—´å’Œé‡‘é’±è¿›è¡Œå®é™…åˆ›ä¸šä¹‹å‰ï¼Œ</p>
<p><strong>é€šè¿‡ AI æ¨¡æ‹Ÿæ¥é¢„æ¼”åˆ›ä¸šè¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„å„ç§æŒ‘æˆ˜å’Œç»“æœ</strong>ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/easychen/one-person-businesses-methodology-v2.0</span>
</code></pre>
<h2 data-id="heading-1">02ã€ç¨‹åºå‘˜å‰¯ä¸šæŒ‡å—</h2>
<p>è¿™ä¸ªä¹Ÿæ˜¯ @easychen å¼€æºçš„ï¼Œå¼€æºé¡¹ç›®åå­—å°±å¾ˆéªšã€‚ç²¾ç›Šå‰¯ä¸šï¼šç¨‹åºå‘˜å¦‚ä½•ä¼˜é›…åœ°åšå‰¯ä¸šã€‚ç›®å‰å·²ç»è·å¾—äº† 10.7K æ˜Ÿæ ‡ï¼Œå¯è§å…¶å—æ¬¢è¿ç¨‹åº¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2da82ecbf852458b9273166cbe9a848f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=RmlAC1I2mBzDqZIsXR%2FAoMddSic%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®é™…ä¸Šæ˜¯ä¸€æœ¬å¼€æºçš„ç”µå­ä¹¦ï¼Œè¿™æœ¬ä¹¦ä¸“é—¨ä¸ºç¨‹åºå‘˜ç¾¤ä½“é‡èº«æ‰“é€ ï¼Œæ—¨åœ¨è§£å†³æŠ€æœ¯äººå‘˜åœ¨å¼€å±•å‰¯ä¸šè¿‡ç¨‹ä¸­é‡åˆ°çš„å®é™…é—®é¢˜ã€‚ä¹¦ä¸­å†…å®¹åˆ†ä¸ºå‡ ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š</p>
<p>é¦–å…ˆæ˜¯å‰¯ä¸šçš„é‡è¦æ€§åˆ†æï¼Œå¸®åŠ©è¯»è€…å»ºç«‹æ­£ç¡®çš„å‰¯ä¸šè§‚å¿µã€‚</p>
<p>æ¥ç€æ˜¯å…·ä½“çš„å˜ç°æ¨¡å¼ä»‹ç»ï¼ŒåŒ…æ‹¬çŸ¥è¯†å˜ç°ã€äº§å“å˜ç°ç­‰å¤šç§é€”å¾„ã€‚æœ€åæ˜¯è¯¦ç»†çš„å®æ“æŒ‡å—ï¼Œå¦‚ç‹¬ç«‹å¼€å‘æµç¨‹å’Œç½‘è¯¾åˆ¶ä½œæ–¹æ³•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62f0501436164d3fb758667e190e3210~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=DOSuX4a%2FwsXBa%2B34QNlk%2BDOW0us%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ae8760eb05442e789391b1d16757c8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=SR8sNlg%2BqJkkf95u4FjNiN%2F7Dxs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/easychen/lean-side-bussiness</span>
</code></pre>
<h2 data-id="heading-2">03ã€ç‹¬ç«‹å¼€å‘è€…å‡ºæµ·æŒ‡å—</h2>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®å«ã€Šç‹¬ç«‹å¼€å‘è€…çš„è‰ºæœ¯ã€‹ï¼Œè¿™æ˜¯ä¸€ä»½å…¨é¢çš„ç‹¬ç«‹å¼€å‘è€…æŒ‡å—ã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®è®°å½•äº†ä½œè€…ä»é›¶å¼€å§‹æˆä¸ºç‹¬ç«‹å¼€å‘è€…çš„å®Œæ•´å†ç¨‹ï¼Œæ³¨é‡æµ·å¤–å®æˆ˜ï¼Œå‡ºæµ·èµšåˆ€ä¹ï¼Œå ªç§°æ˜¯ä¸€äººå…¬å¸çš„å®æˆ˜æ‰‹å†Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8314c63766aa412aa410df07933f9794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=Tp7amY%2F1bksqlcNLqpUtqyyHLUo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é¡¹ç›®ä»æœ€åŸºç¡€çš„ç¾å›½å…¬å¸æ³¨å†Œå¼€å§‹ï¼Œè¯¦ç»†åˆ°é€‰æ‹©æ€€ä¿„æ˜å·æ³¨å†Œçš„åŸå› ï¼ˆå…å…¬å¸ç¨å’Œä¸ªäººç¨ï¼‰ã€å…¬å¸ç±»å‹é€‰æ‹©å»ºè®®ï¼Œä»¥åŠå…·ä½“çš„ç”³è¯·æ­¥éª¤å’Œè€—æ—¶ã€‚</p>
<p>ä½œè€…è¿˜å…¬å¼€äº†å„é¡¹èŠ±è´¹ï¼Œå¦‚å…¬å¸æ³¨å†Œ 150 ç¾å…ƒã€EIN ç”³è¯· 35 ç¾å…ƒç­‰çœŸå®æ•°æ®ã€‚</p>
<p>åœ¨é‡‘èæ–¹é¢ï¼Œé¡¹ç›®ä¸ä»…ä»‹ç»äº†æ°´æ˜Ÿé“¶è¡Œçš„ç”³è¯·æµç¨‹ï¼Œè¿˜ç‰¹åˆ«æåˆ°äº†å¯èƒ½é‡åˆ°çš„åœ°å€è¯æ˜é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼Œè¿™äº›ç»†èŠ‚å¯¹æµ·å¤–å¼€å‘è€…æå…·å‚è€ƒä»·å€¼ã€‚</p>
<p>Stripe æ”¶æ¬¾éƒ¨åˆ†çš„æŒ‡å¯¼ç›´æ¥è§£å†³äº†ç‹¬ç«‹å¼€å‘è€…æœ€å…³å¿ƒçš„èµ„é‡‘å›æ”¶é—®é¢˜ã€‚</p>
<p>æŠ€æœ¯åŸºç¡€è®¾æ–½éƒ¨åˆ†ï¼Œä½œè€…æ•´ç†äº†å„å¤§äº‘æœåŠ¡å•†çš„å…è´¹é¢åº¦ç”³è¯·æ”»ç•¥ï¼ŒåŒ…æ‹¬ Azure çš„ 15 ä¸‡ç¾å…ƒä¿¡ç”¨é¢åº¦ã€AWS çš„ 1.5 ä¸‡ç¾å…ƒé¢åº¦ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ç‹¬ç«‹å¼€å‘è€…åœ¨èµ·æ­¥é˜¶æ®µæœ€éœ€è¦çš„èµ„æºã€‚</p>
<p><strong>å½“ç„¶è¿˜åŒ…æ‹¬å¢é•¿è¥é”€å…¨å¥—ç­–ç•¥ï¼Œ</strong> æ¶µç›– SEOã€ProductHunt æ¨å¹¿ç­‰æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">å¼€æºåœ°å€ï¼šhttps://github.com/hua1995116/indiehackers-steps
</code></pre>
<h2 data-id="heading-3">04ã€ä¸­å›½ç‹¬ç«‹å¼€å‘è€…é¡¹ç›®åˆ—è¡¨</h2>
<p>æƒ³æç‹¬ç«‹å¼€å‘ä¸çŸ¥é“æå•¥ã€‚</p>
<p>å¯ä»¥å»è¿™ä¸ªä¸“é—¨èšåˆäº†ä¸­å›½ç‹¬ç«‹å¼€å‘è€…çš„ä½œå“æ¸…å•ç§ç§ï¼Œå ªç§°å›½å†…ç‹¬ç«‹å¼€å‘è€…çš„æ˜Ÿå…‰å¤§é“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/636dac13bd1c495eaa6ba91533149ba8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=e77s9tLW8TcHTQyyZvWMjOUcBUo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®æ”¶å½•äº†ä¸Šåƒä¸ªä¸­å›½ç‹¬ç«‹å¼€å‘è€…çš„äº§å“ï¼Œæ¯æ—¥æ›´æ–°ï¼Œä¿æŒå†…å®¹æ–°é²œåº¦ã€‚å†…å®¹æ¶µç›– AIã€å·¥å…·ã€å°ç¨‹åºã€App ç­‰å¤šä¸ªé¢†åŸŸã€‚</p>
<p><strong>å¯¹äºå¼€å‘è€…è€Œè¨€</strong>ï¼Œè¿™ä¸ªé¡¹ç›®åº“æ˜¯ç»ä½³çš„çµæ„Ÿæ¥æºã€‚å½“ä½ æƒ³è¦å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®ä½†ç¼ºä¹åˆ›æ„æ—¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¯»æ‰¾æ–¹å‘ã€‚çœ‹åˆ°å…¶ä»–å¼€å‘è€…æ­£åœ¨è§£å†³çš„é—®é¢˜å’Œå®ç°çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿæ¿€å‘æ–°çš„æƒ³æ³•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50f00f0a88b044f7bd861cf92da28dcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=Hl%2B5LxjygvrCuXLrxAQbnhKPtss%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash">å¼€æºåœ°å€ï¼šhttps://github.com/1c7/chinese-independent-developer
</code></pre>
<h2 data-id="heading-4">05ã€1000 ä¸ªç§å­ç”¨æˆ·</h2>
<p>åˆšåˆšçš„å¼€æºé¡¹ç›®ä»‹ç»äº†æ€ä¹ˆæå‡ºæµ·ã€ç‹¬ç«‹å¼€å‘ã€‚è¿˜çœ‹äº†å¾ˆå¤šå›½å†…æœ‰è¶£çš„ç‹¬ç«‹å¼€å‘è€…æ¡ˆä¾‹ã€‚å¦‚æœä½ æŠ“ä½ç”¨æˆ·ç—›ç‚¹ï¼Œä¸Šçº¿äº†è‡ªå·±çš„åº”ç”¨ã€‚è·å–æ—©æœŸç”¨æˆ·å¯èƒ½æ¯”è¾ƒéš¾ï¼Œè¿™ä¸ªå«Â 1000UserGuide çš„å¼€æºé¡¹ç›®æ­£å¥½è§£å†³äº†è¿™ä¸ªç—›ç‚¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/161946e42fdd42fbb398e244a2e59ee0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=vPOp7kwyY%2BcunoIxIIfLDW2XzhU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®ç³»ç»Ÿæ€§åœ°æ•´ç†äº† 300 å¤šä¸ªé€‚åˆäº§å“æ¨å¹¿çš„æ¸ é“ï¼Œå¸®åŠ©å¼€å‘è€…è§£å†³ä» 0 åˆ° 1 ç”¨æˆ·è·å–çš„éš¾é¢˜ã€‚</p>
<p>ç‰¹åˆ«æ³¨é‡æ¸ é“çš„å®ç”¨æ€§å’Œå¯æ“ä½œæ€§ï¼Œæ¯ä¸ªæ”¶å½•çš„æ¸ é“éƒ½ç»è¿‡ç­›é€‰ï¼Œç¡®ä¿ç¡®å®èƒ½ä¸ºæ—©æœŸäº§å“å¸¦æ¥æ›å…‰æœºä¼šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfbb77fe2223414d8bb4a2d280ce4974~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=rmta8F2KeZ%2B1gqiwuUin71baeEw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é¡¹ç›®å†…å®¹ååˆ†ä¸°å¯Œï¼Œä¸ä»…åŒ…å«å¸¸è§çš„ Product Huntã€Hacker News ç­‰å›½é™…å¹³å°ï¼Œè¿˜æ”¶å½•äº†å¤§é‡å›½å†…ç‰¹æœ‰çš„æ¨å¹¿æ¸ é“ï¼Œå¦‚å³åˆ»ã€æ˜é‡‘ã€V2EXç­‰æœ¬åœŸç¤¾åŒºã€‚</p>
<p>æ›´éš¾å¾—çš„æ˜¯ï¼Œé¡¹ç›®è¿˜ç»†åˆ†ä¸º AI å·¥å…·å¯¼èˆªã€ç›®å½•ç«™ç‚¹ã€è¡Œä¸šè®ºå›ç­‰ä¸åŒç±»åˆ«ï¼Œæ–¹ä¾¿ç”¨æˆ·æ ¹æ®äº§å“ç‰¹æ€§ç²¾å‡†é€‰æ‹©æ¨å¹¿æ¸ é“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cde7c3b0f3e54613bfec0d87dc6ae7a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617889&amp;x-signature=LTJo5HyTL2XEN8ClO%2BZmKyoaaOc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/naxiaoduo/1000UserGuide</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android ä¿®æ”¹é¡¹ç›®åŒ…å,ä¸€é”®è§£å†³.]]></title>    <link>https://juejin.cn/post/7571726099690094611</link>    <guid>https://juejin.cn/post/7571726099690094611</guid>    <pubDate>2025-11-13T05:54:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571726099690094611" data-draft-id="7571742703534178340" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android  ä¿®æ”¹é¡¹ç›®åŒ…å,ä¸€é”®è§£å†³."/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-13T05:54:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²¡æœ‰äº†é‡è§"/> <meta itemprop="url" content="https://juejin.cn/user/1521379826212983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android  ä¿®æ”¹é¡¹ç›®åŒ…å,ä¸€é”®è§£å†³.
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379826212983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²¡æœ‰äº†é‡è§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:54:36.000Z" title="Thu Nov 13 2025 05:54:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">éœ€æ±‚:</h2>
<p>é¡¹ç›®éœ€è¦  éœ€è¦æ”¹å˜åŒ…åå’Œç­¾å.</p>
<h2 data-id="heading-1">ç‰ˆæœ¬</h2>
<p>Windows 10</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73668618880d44379979e2feaa56bbfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5pyJ5LqG6YGH6KeB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763618077&amp;x-signature=ne2TzFXNKSRE7xNQNqdIw4TNC%2F0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">å®ç°</h2>
<h4 data-id="heading-3">1.ä¿®æ”¹è®¾ç½®</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e12b3d5dd0b04588becc9163f7f7a75d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5pyJ5LqG6YGH6KeB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763618077&amp;x-signature=Nh8BjK4kTxZyLLdfZ1pD4bdLX3c%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">2:shift+F6</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7070b6e84ffe4a7d809cfa084619c01e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5pyJ5LqG6YGH6KeB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763618077&amp;x-signature=H8oChMO0KiRHktKDyx8Pp%2FvdFCg%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">3: ç¡®è®¤ä¿®æ”¹</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90212e94adf34a289a8736ed6f62d57c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5pyJ5LqG6YGH6KeB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763618077&amp;x-signature=nmaYpkBEQi9iRqwua0YsvqVtlJM%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain & LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰]]></title>    <link>https://juejin.cn/post/7571731181198475300</link>    <guid>https://juejin.cn/post/7571731181198475300</guid>    <pubDate>2025-11-13T05:50:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571731181198475300" data-draft-id="7571731181198426148" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰"/> <meta itemprop="keywords" content="LLM,Agent,LangChain"/> <meta itemprop="datePublished" content="2025-11-13T05:50:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T05:50:03.000Z" title="Thu Nov 13 2025 05:50:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>æœ€è¿‘ä¹±ä¸ƒå…«ç³Ÿçš„äº‹å¤ªå¤šï¼Œä»Šå¤©æ¥ç‚¹åæŠ€æœ¯å®æˆ˜çš„ï¼Œå¸¦å¤§å®¶ç”¨LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨ç”¨ç¼–ç¨‹åˆ›å»ºæ™ºèƒ½ä½“ï¼Œç”¨LangSmithè¿›è¡Œè¿½è¸ªï¼ŒAgent-Chatæ„å»ºAgent UIã€‚</p>
<p>åŸºæœ¬æ¦‚å¿µ</p>
<p>ç›¸ä¿¡å¤§å®¶ç›¸æ¯”äºLangGraphï¼ŒLangChainèƒ½æ›´ç†Ÿæ‚‰ä¸€äº›ï¼Œæ¯•ç«ŸLangChainå‡ºç°çš„æ›´æ—©ï¼Œä¸‹é¢å…ˆæ¥ç®€å•ä»‹ç»ä¸‹è¿™ä¸¤ä¸ªæ¡†æ¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0d0f58a08024e6681ff69f9c63bb803~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=DYrpYV%2FC0rL4JlfPz8N9oghhw64%3D" alt="" loading="lazy"/></p>
<p>LangChainï¼šå®ƒæ˜¯ä¸€ä¸ªå¼€å‘AIåº”ç”¨çš„åŸºç¡€æ¡†æ¶ï¼Œä¸»è¦æä¾›äº†å¼€å‘AIåº”ç”¨çš„å„ç§æ¥å£å’Œå·¥å…·ï¼Œä¾‹å¦‚è°ƒç”¨å¤§æ¨¡å‹çš„ç»Ÿä¸€æ¥å£ï¼Œæä¾›äº†æœç´¢ã€æ–‡æ¡£å¤„ç†ã€å‘é‡æ•°æ®åº“å¤„ç†ç­‰å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬éå¸¸å¿«é€Ÿè°ƒç”¨å®ç°åŠŸèƒ½ï¼ŒåŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œå¦åˆ™æˆ‘ä»¬è¿˜å¾—è‡ªå·±å»å°è£…ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒLangChainè¿˜æä¾›äº†é“¾å¼è°ƒç”¨ï¼ˆChainsï¼‰ã€è®°å¿†ç®¡ç†å’Œæç¤ºè¯æ¨¡ç‰ˆç­‰åŸºç¡€åŠŸèƒ½ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpython.langchain.com%2Fdocs%2Fintroduction%2F" target="_blank" title="https://python.langchain.com/docs/introduction/" ref="nofollow noopener noreferrer">python.langchain.com/docs/introdâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e78ac4fd5c1c43618c0586aa6bcaf7d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=vMKCPSL42b0gt%2FP%2BD71S8XpTox4%3D" alt="" loading="lazy"/></p>
<p>LangGraphï¼šå®ƒæ›´é«˜çº§ä¸€äº›ï¼Œå®ƒåœ¨LangChainä¸Šé¢ï¼Œæ˜¯ä¸€ä¸ªåŸºäºLangChainçš„å·¥ä½œæµç¼–æ’æ¡†æ¶ï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„å·¥ä½œæµç¼–æ’å’Œå¤šæ™ºèƒ½ä½“ç¼–æ’ã€‚æ‰€ä»¥ä»åå­—ä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼ŒLangChainè¿˜æ˜¯åœç•™åœ¨é“¾å¼ï¼ˆChainï¼‰çš„è°ƒç”¨ï¼Œè€ŒLangGraphåˆ™æ˜¯æŠŠå¤æ‚çš„æ™ºèƒ½ä½“å·¥ä½œæµæŠ½è±¡æˆä¸€ä¸ªå›¾ï¼ˆGraphï¼‰äº†ã€‚LangGraphçš„æ ¸å¿ƒåŠŸèƒ½åŒ…å«äº†æœ‰çŠ¶æ€çš„å·¥ä½œæµå¤„ç†ã€æ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ã€å¹¶è¡Œæ‰§è¡Œã€æ£€æŸ¥ç‚¹ï¼ˆCheckpointsï¼‰å’ŒçŠ¶æ€ç®¡ç†ç­‰å¤„ç†ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flangchain-ai.github.io%2Flanggraph%2F" target="_blank" title="https://langchain-ai.github.io/langgraph/" ref="nofollow noopener noreferrer">langchain-ai.github.io/langgraph/</a></p>
<p>PSï¼šå¯èƒ½æœ‰äº›äººå¯¹äºä¸Šé¢æåˆ°çš„LangGraphçŠ¶æ€ç®¡ç†è¿™ä¸ªæ¦‚å¿µæœ‰äº›æ¨¡ç³Šï¼Œåœ¨æ­¤è¡¥å……è§£é‡Šä¸‹ã€‚çŠ¶æ€ç®€å•ç†è§£ï¼Œå°±æ˜¯å·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ä¿å­˜å’Œä¼ é€’çš„æ•°æ®ï¼Œæ¯ä¸ªæ­¥éª¤çš„ç»“æœéƒ½ä¼šä¿å­˜ï¼Œåç»­æ­¥éª¤å¯ä»¥è®¿é—®å‰é¢æ­¥éª¤çš„ç»“æœå’Œæ•°æ®ï¼Œå¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥ï¼Œå¯ä»¥ä»å¤±è´¥ç‚¹é‡æ–°å¼€å§‹ã€‚</p>
<p>å®æˆ˜</p>
<p>æ¥ä¸‹æ¥å¸¦å¤§å®¶å®æˆ˜ä¸€ä¸ªé¡¹ç›®ï¼Œè®©å¤§å®¶å¿«é€Ÿå…¥é—¨LangChain &amp; LangGraphç”Ÿæ€ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¼€å‘å·¥å…·å°±é€‰æ‹©ç”¨Curosräº†ã€‚</p>
<h2 data-id="heading-0">1ã€åˆ›å»ºç©ºé¡¹ç›®ï¼Œç”¨cursoræ‰“å¼€</h2>
<p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬åœ¨å¤–å¤´åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å«ã€lang-demoã€‘ï¼Œç„¶åç”¨Cursoræ‰“å¼€è¯¥æ–‡ä»¶å¤¹ã€‚</p>
<h2 data-id="heading-1">2ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h2>
<p>ä¸ºäº†å’Œå…¶ä»–pythoné¡¹ç›®çš„ç¯å¢ƒè¿›è¡Œéš”ç¦»ï¼Œæˆ‘ä»¬ç”¨cursorçš„ç»ˆç«¯ï¼Œä½¿ç”¨condaå‘½ä»¤å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè¿™é‡Œæˆ‘åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒå«clxï¼Œç„¶åè¿›å…¥åˆ°è¯¥è™šæ‹Ÿç¯å¢ƒä¸­ã€‚ï¼ˆæ³¨æ„ï¼Œå»ºè®®pythonç‰ˆæœ¬è¦3.11ä»¥ä¸Šï¼Œå› ä¸ºåç»­éœ€è¦å®‰è£…langgraph-cli[inmem]ï¼Œæœ€ä½ç‰ˆæœ¬è¦æ±‚3.11ï¼‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">conda create -n clx <span class="hljs-attr">python</span>=<span class="hljs-number">3.12</span>
conda activate clx
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/452ff90672784622abb55bb716f67f85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=%2FksQtwgxuue%2BZcyzrH7vtfNh92o%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä½•åˆ¤æ–­æ˜¯ä¸æ˜¯å·²ç»è¿›å…¥åˆ°äº†ä¸Šé¢åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­å‘¢ï¼Ÿè¿›å…¥åï¼Œç»ˆç«¯çš„å‘½ä»¤è¡Œå‰ä¼šæœ‰è™šæ‹Ÿç¯å¢ƒçš„åç§°ã€‚</p>
<h2 data-id="heading-2">3ã€åˆ›å»ºrequirements.txtï¼Œå®‰è£…ä¾èµ–</h2>
<p>é¡¹ç›®ä¸­åˆ›å»ºrequirements.txtæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18586b78edd34f58a8ba80b01c88ccf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=ll2DkuSWe0z%2FDjgGrQA0GuviSlI%3D" alt="" loading="lazy"/></p>
<p>ç„¶ååœ¨cursorç»ˆç«¯è¾“å…¥å‘½ä»¤å®‰è£…ä¾èµ–ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">pip3 install -r requirements.txt
</code></pre>
<h2 data-id="heading-3">4ã€åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶</h2>
<p>æ¥ä¸‹æ¥åˆ›å»ºã€.envã€‘æ–‡ä»¶ï¼Œé‡Œé¢é…ç½®å„å¤„ç”³è¯·çš„keyã€‚å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48751bfe454640a9831d149a149d5efe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=%2BjGC4zHJ%2B35WUi2qOAPs3UBHDMA%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­deepseekçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e86c81e054843aba6e7a4db81ecb4a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=w9P7baOhnOvH7ei9UVtmHawiXRA%3D" alt="" loading="lazy"/></p>
<p>TAVILYçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b885114eb934cec98bdbddae4b01137~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=hpBqsZeL1lSrgQ7KdNi0fRXI%2FQ8%3D" alt="" loading="lazy"/></p>
<p>LangSmithçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecb1a69f257a42cb88df32f2c80c6b34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=Y6qVvMjTXJhy6VqSgh0jEhe4d5w%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">5ã€ä½¿ç”¨cursorç”Ÿæˆä¸€ä¸ªLangChain &amp; LangGraphçš„demo</h2>
<p>å¯¹ï¼Œä½ æ²¡çœ‹é”™ï¼Œè¿™é‡Œä¸æ˜¯ç»™å¤§å®¶è®²æˆ‘æœ¬åœ°çš„é¡¹ç›®å¦‚ä½•åšçš„ï¼Œè€Œæ˜¯è®©å¤§å®¶ç”¨Cursorå»ç»™è‡ªå·±ç”Ÿæˆä¸€ä¸ªï¼Œå¹¶è°ƒè¯•é€šï¼Œæ‰€ä»¥æœ€åæ¯ä¸ªäººçš„Demoè‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ã€‚æˆ‘ç”ŸæˆDemoçš„Promptå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">è¯·ç»™æˆ‘ç”Ÿæˆä¸€ä¸ªLangChainå’ŒLangGraphçš„Demoï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
1ã€å°½å¯èƒ½å¤šçš„ç”¨ä¸Šã€requirements.txtã€‘å’Œã€.<span class="hljs-built_in">env</span>ã€‘çš„æŠ€æœ¯å†…å®¹è¿›è¡Œè®¾è®¡ã€‚
2ã€Demoå°½é‡ç®€å•ï¼Œé€‚åˆå­¦ä¹ ç”¨ï¼Œæ–¹ä¾¿ç†è§£ã€‚
3ã€éœ€è¦åŒ…å«ã€README.mdã€‘æ–‡ä»¶ï¼Œå¯¹é¡¹ç›®ç»“æ„å’Œæ ¸å¿ƒä»£ç è¿›è¡Œè¯´æ˜ã€‚
4ã€åŒ…å«è¿è¡ŒDemoçš„å¿«æ·å…¥å£æ–‡ä»¶ã€‚
</code></pre>
<p>ç„¶åå°±çœ‹Cursorå‘æŒ¥äº†ï¼Œç¬¬ä¸€æ¬¡ç”Ÿæˆåè‚¯å®šè·‘ä¸é€šï¼Œéœ€è¦ä¸åœçš„è®©cursorè¿›è¡Œè°ƒè¯•ï¼Œå› ä¸ºæ˜¯Demoæ€§è´¨çš„ï¼Œç›¸å¯¹ç®€å•ï¼Œé€»è¾‘ä¹Ÿä¸ä¼šå¤ªå¤æ‚ï¼Œä¸€èˆ¬åœ¨10è½®Promptäº¤äº’ä¹‹å†…å³å¯å¾—åˆ°Cursoråˆ›å»ºçš„å¯æ­£ç¡®è¿è¡Œçš„é¡¹ç›®ã€‚</p>
<p>æœ€åç»™å¤§å®¶æ¼”ç¤ºä¸‹ï¼Œç»™æˆ‘ç”Ÿæˆçš„é¡¹ç›®æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼š</p>
<p>ç»™æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªã€run_demo.pyã€‘å…¥å£æ–‡ä»¶ï¼Œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f68614484604b258e3636c1a159df27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=u3C6lYaklCBGL8A6Sq%2B7JabZNEM%3D" alt="" loading="lazy"/></p>
<p>ç”¨pythonå‘½ä»¤è¿è¡Œï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a6970406299440cb53a9a7ff3ba1c29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=15egL38xXIuuDrTxdJpKoMxR2uU%3D" alt="" loading="lazy"/></p>
<p>æˆ‘é€‰æ‹©ã€1ã€‘ï¼Œç„¶åè¾“å…¥æˆ‘çš„é—®é¢˜ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/907a72d972d34afcba411344cb6c504e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=ttsgHwqGdAFBukvR4n4hQTH4MmE%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæ ¹æ®æˆ‘çš„é—®é¢˜ï¼ŒDemoä¼šè¯†åˆ«ä¸»é¢˜æ˜¯æˆ‘çš„é—®é¢˜æ˜¯ä¸€ä¸ªç®€å•çš„é—®ç­”ã€general_chatã€‘ï¼Œè°ƒç”¨æ¨¡å‹ç»™æˆ‘å›å¤äº†ç­”æ¡ˆã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯¹æ•°æ®è¿›è¡Œäº†åˆ†æï¼Œæœ€åç”Ÿæˆäº†ä¸€ä¸ªå¯è§†åŒ–å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f6fffd508414669ad45b3dee397ef92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=g20YUWXCyQpLLn5i%2BfpWot3B4dE%3D" alt="" loading="lazy"/></p>
<p>å›¾è¡¨ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5aa89d1bcf1497897b107d9d5b949d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=CKZMys%2FqFVOe%2FQNGYLEn3pWEI7w%3D" alt="" loading="lazy"/></p>
<p>ç„¶åï¼Œæˆ‘ç»§ç»­æµ‹è¯•ï¼Œæ¢ä¸€ä¸ªé—®é¢˜ï¼Œé—®ä¸€ä¸ªéœ€è¦è”ç½‘æœç´¢çš„ï¼Œä¾‹å¦‚æˆ‘æé—®ï¼šè¯·å¸®æˆ‘æœç´¢ä»Šå¤©çš„çƒ­ç‚¹AIæ–°é—»æœ‰å“ªäº›ã€‚ç„¶åä»–å°±ä¼šè¯†åˆ«ä¸ºã€Searchã€‘ä¸»é¢˜ï¼Œç»™æˆ‘è”ç½‘æœç´¢ç”Ÿæˆç»“æœï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†æåç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90bbb53bda794b1985af38e5f6409a9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=XU2klQQZaVIlMB7nj7j%2BqH3d0TI%3D" alt="" loading="lazy"/></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘çš„Demoå°±æ¼”ç¤ºå®Œäº†ï¼Œç„¶åå‘¢ï¼Œå¦‚ä½•æ–¹ä¾¿ä½ å¿«é€Ÿäº†è§£é¡¹ç›®å‘¢ï¼Œå½“ç„¶ä»è®©å…¶ç”Ÿæˆçš„ã€README.mdã€‘æ–‡ä»¶äº†ã€‚</p>
<p>Readmeä¸­ä»‹ç»äº†é¡¹ç›®çš„åŸºæœ¬åŠŸèƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21a833c58dcb4a078c0250b3fcf10234~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=SBB7Q2l5a%2FQu8RDdSVqvmnYxNJU%3D" alt="" loading="lazy"/></p>
<p>å¯¹é¡¹ç›®çš„è°ƒç”¨æµç¨‹è¿›è¡Œäº†è¯´æ˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40f3df97f67d4d1d94b107fd4741a058~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=%2Bbcqk9bQMHVpg7yJoLQIy6weQpU%3D" alt="" loading="lazy"/></p>
<p>è¯´æ˜äº†é¡¹ç›®åœ¨å“ªä½¿ç”¨äº†LangChainï¼Œéƒ½åšäº†ä»€ä¹ˆï¼Œå¹¶ä¸”å¯¹åº”çš„ä»£ç æ˜¯å¤šå°‘è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/249891bc96554f8a940f4244c8e3580b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=r4gbJrAvhktb8NLju9w1%2F8ER7co%3D" alt="" loading="lazy"/></p>
<p>è¿˜è¯´æ˜äº†é¡¹ç›®å“ªé‡Œä½¿ç”¨äº†LangGraphï¼Œéƒ½åšäº†ä»€ä¹ˆï¼Œå¹¶ä¸”å¯¹åº”çš„ä»£ç æ˜¯å¤šå°‘è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72691b955a084549a93f82d1744e66e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=Ju%2F8TygTggl3D1V1Qzdk8%2Fm49I4%3D" alt="" loading="lazy"/></p>
<p>å…·ä½“ä¸è¯¦ç»†ä»‹ç»äº†ï¼Œç»™æˆ‘ç”Ÿæˆçš„Readmeä¸­å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œå®Œå…¨å¯ä»¥çœ‹æ‡‚ï¼Œä¸‹é¢æ€»ç»“è¯´æ˜ä¸‹ï¼Œç»™æˆ‘ç”Ÿæˆçš„Demoä»£ç å“ªäº›åœ°æ–¹ç”¨åˆ°äº†LangChainï¼Œå“ªäº›åœ°æ–¹ç”¨åˆ°äº†LangGraphã€‚</p>
<p>LangChainç›¸å…³ï¼š</p>
<ul>
<li>ä½¿ç”¨LangChainä¸­ChatDeepSeekä¸æ¨¡å‹è¿›è¡Œäº¤äº’ã€‚</li>
<li>é›†æˆLangChainä¸­TavilySearchå·¥å…·è¿›è¡Œæœç´¢ã€‚</li>
<li>ä½¿ç”¨langchain_core.messagesç»Ÿä¸€æ¶ˆæ¯æ ¼å¼ã€‚</li>
</ul>
<p>LangGraphç›¸å…³ï¼š</p>
<ul>
<li>è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚</li>
<li>è¿›è¡Œå·¥ä½œæµç¼–æ’ã€‚</li>
<li>è¿›è¡ŒçŠ¶æ€ä¼ é€’ã€‚</li>
</ul>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œç»™å¤§å®¶æ¼”ç¤ºäº†Cursorç»™æˆ‘ç”Ÿæˆçš„LangChain&amp;LangGraph Demoã€‚</p>
<h2 data-id="heading-5">6ã€Langgraph-cliå’ŒLangSmithçš„ä½¿ç”¨</h2>
<p>ä¸‹é¢æˆ‘ä»¬ç»§ç»­ï¼Œåœ¨æ§åˆ¶å°å®‰è£…åº“langgraph-cliï¼Œæ–¹ä¾¿åç»­è°ƒè¯•å’Œç”¨LangSmithæ¥è¿½è¸ªæˆ‘ä»¬çš„é¡¹ç›®ã€‚å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">pip3 install -U <span class="hljs-string">"langgraph-cli[inmem]"</span>
</code></pre>
<p>å®‰è£…åè¾“å…¥ä¸‹é¢å‘½ä»¤å¯åŠ¨é¡¹ç›®ï¼š</p>
<pre><code class="hljs">langgraph dev
</code></pre>
<p>å¯åŠ¨åä¼šå‘ç°æœ‰ä¸‰ä¸ªé‡è¦çš„è·¯å¾„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯å¯ä»¥æ‰“å¼€çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e84fed3d444f449e86437266c49718e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=0lrG4R6I0iOA84Lje8GS77FxIGw%3D" alt="" loading="lazy"/></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯é¡¹ç›®APIçš„Endpointï¼Œæ‰“å¼€åæ˜¾ç¤ºNot Foundï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚å› ä¸ºé»˜è®¤æ²¡æœ‰è¿™ä¸ªgetè¯·æ±‚ï¼Œä¸ä¼šé‡å®šå‘åˆ°ä»»ä½•åœ°æ–¹ï¼Œä½†æ˜¯æ—¢ç„¶æœ‰ç»“æœè¿”å›ï¼Œè¯´æ˜APIçš„Endpointæ˜¯é€šçš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A2024%2F" target="_blank" title="http://127.0.0.1:2024/" ref="nofollow noopener noreferrer">http://127.0.0.1:2024</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b3dff3a16b2402d812a0d97b59955da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=8Y4xTyNbd61ZX%2FwXoe6oVoMxw2M%3D" alt="" loading="lazy"/></p>
<p>ç¬¬ä¸‰ä¸ªå¯ä»¥æ‰“å¼€ï¼Œæ‰“å¼€åæ˜¯LangGraphçš„APIæ–‡æ¡£è¯´æ˜ï¼Œå¹¶ä¸”å¯ä»¥åœ¨çº¿æµ‹è¯•APIï¼Œè¿™é‡Œå°±ä¸ç»™å¤§å®¶æ¼”ç¤ºäº†ï¼Œå¾ˆç®€å•ã€‚</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A2024%2Fdocs" target="_blank" title="http://127.0.0.1:2024/docs" ref="nofollow noopener noreferrer">http://127.0.0.1:2024/docs</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bacc7820a1cc441ca4d14e236b70c5e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=Xdh1DUt5t2%2B2f1A3nfibGJusI%2F4%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯ç¬¬äºŒä¸ªéœ€è¦ç‰¹æ®Šè¯´æ˜ï¼Œæˆ‘ä»¬è·¯å¾„å¯ä»¥æ‰“å¼€ï¼Œä½†æ˜¯è·å–ä¸åˆ°é¡¹ç›®çš„å†…å®¹ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯ä¸æ­£å¸¸çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttp%3A%2F%2F127.0.0.1%3A2024" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:2024" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24499be65a8941aca625ac7474fba2dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=FcvwWljwsENXWBx024bGDaGJ1%2B0%3D" alt="" loading="lazy"/></p>
<p>æœ‰ä¸€å®šè½¯ä»¶åŸºç¡€èƒ½åŠ›çš„äººå¾ˆå®¹æ˜“å¯ä»¥åˆ¤æ–­å‡ºæ¥ï¼Œå› ä¸ºä¸‹é¢è¿™ä¸ªè·¯å¾„è·¨åŸŸäº†ï¼Œsmithå¹³å°æ˜¯ä¸å¯èƒ½è·å–ä½ æœ¬åœ°æœåŠ¡API EndPointçš„ï¼Œè®¿é—®ä¸äº†å¾ˆæ­£å¸¸ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttp%3A%2F%2F127.0.0.1%3A2024" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:2024" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸€ä¸‹å¯åŠ¨çš„å‘½ä»¤ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-css" lang="css">langgraph dev <span class="hljs-attr">--tunnel</span>
</code></pre>
<p>è¿™æ¬¡å¯åŠ¨åå¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè·¯å¾„æ›´é•¿äº†ï¼Œè€Œä¸”å¹¶ä¸æ˜¯ä¹‹å‰æœ¬åœ°çš„ipäº†ï¼Œè€Œæ˜¯æ¢æˆå…¬ç½‘å¯è®¿é—®çš„cloudflareçš„åœ°å€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttps%3A%2F%2Fjournalists-utilities-magnetic-seemed.trycloudflare.com" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=https://journalists-utilities-magnetic-seemed.trycloudflare.com" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14b7f82e54aa49e6861fd846107e936f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=6Q8Ska7g%2BAW0Qt0mBv9naO4KW9E%3D" alt="" loading="lazy"/></p>
<p>è¿™æ ·ï¼Œlangsmithå¹³å°å°±å¯ä»¥æ­£å¸¸åœ°åŠ è½½äº†ã€‚åŠ è½½åå¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œä½ ä¹Ÿçš„ä¸šåŠ¡æµç¨‹å®Œå…¨å˜æˆäº†å¯è¿½è¸ªçš„å¯è§†åŒ–å·¥ä½œæµã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41b3dc0461a745958d69c49e21e887ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=XQLNyJSw4nybe1HVoftuTajUBc0%3D" alt="" loading="lazy"/></p>
<p>ç„¶åï¼Œæˆ‘å°±å¯ä»¥è¾“å…¥é—®é¢˜ï¼Œåœ¨è¿™ä¸ªå¹³å°ä¸Šè¿›è¡Œè°ƒè¯•ï¼Œä¾‹å¦‚åœ¨å¯¹åº”çš„ä¼ é€’å‚æ•°çš„åœ°æ–¹ï¼Œæˆ‘æé—®ï¼šå¤©ä¸ºä»€ä¹ˆä¼šä¸‹é›¨ï¼Œåœ¨æ­¤å¹³å°å°±å¯ä»¥è¿æ¥åˆ°ä½ æœ¬åœ°çš„å·¥ç¨‹ï¼Œè¿›è¡Œå¯è§†åŒ–è°ƒè¯•å’Œè¾“å‡ºäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f16e576116da4217b1475b5ed9ee64d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=WQyrg9penFiizoyRfzTOI85yVPQ%3D" alt="" loading="lazy"/></p>
<p>å¹¶ä¸”å¯ä»¥åˆ‡æ¢åˆ°ã€Traceã€‘é€‰é¡¹å¡æŸ¥çœ‹å…¶è¿è¡Œè½¨è¿¹ï¼Œè¿›è¡Œè¿½è¸ªã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0de3aa8a3490406eb66ffeb7092a2f9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=CmVCsNg1OeWgCLIfQeQ9mgC%2B3Ik%3D" alt="" loading="lazy"/></p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œç°åœ¨ä½ æŠŠè¿™ä¸ªé¡µé¢å…³é—­ã€‚ç„¶åå†æ¬¡è¿›å…¥åˆ°LangSmithçš„ä¸»é¡µï¼Œç‚¹å‡»ã€Tracing Projectsã€‘ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ä¹‹å‰è¿è¡Œè¿½è¸ªçš„è®°å½•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71b51239e13b4ee28706871ed6ad6588~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=drNicR9I5lgyYTFKpEs7Kv6UEB4%3D" alt="" loading="lazy"/></p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿè¿™æ„å‘³ç€åªè¦ä½ ç”¨ã€langgraph devã€‘å¯åŠ¨äº†ä½ æœ¬åœ°çš„å·¥ç¨‹ï¼Œä½ åœ¨ä½•å¤„è®¿é—®ä½ çš„é¡¹ç›®ï¼Œéƒ½ä¼šè‡ªåŠ¨è¿›è¡Œè¡Œä¸ºè¿½è¸ªå¹¶ä¸”åœ¨LangSmithå¹³å°ä¸Šè¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<p>è§£æƒ‘ï¼š</p>
<p>å¤§å®¶é€šè¿‡æˆ‘ä¸Šé¢çš„æ“ä½œï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œéƒ½ä¼šå­˜åœ¨è¿™ç§ç–‘é—®ï¼Œä¸æ˜¯ä¸€ç›´åœ¨è®²LangChainå—ï¼Œæ€ä¹ˆçªç„¶æ¥äº†LangSmithï¼Œå®ƒæ˜¯å¹²å˜›çš„ï¼Œæ„Ÿè§‰åƒå¯ä»¥è¿½è¸ªè¡Œä¸ºç”¨çš„ï¼Œé‚£æˆ‘çš„é¡¹ç›®ï¼Œåˆæ˜¯ä½•æ—¶ä¸LangSmithå¹³å°è¿›è¡Œçš„è”ç³»å‘¢ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81254035ca9747e39e61fa218fb67eb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=NMRVqJPGccAPKd1z9XDCAwyvEBE%3D" alt="" loading="lazy"/></p>
<p>LangSmithï¼šå…¶å®æˆ‘ä¸ç”¨è¿‡å¤šè§£é‡Šï¼Œé€šè¿‡ä¸Šé¢çš„æ¼”ç¤ºå¤§å®¶ä¹Ÿèƒ½å¤Ÿæ„Ÿå—åˆ°ã€‚LangSmithå¤§å®¶ç†è§£æˆä¸€ä¸ªåœ¨çº¿ç›‘æ§å’Œè°ƒè¯•å¹³å°å³å¯ï¼Œæä¾›äº†åœ¨çº¿è°ƒè¯•Debugï¼ˆä¸Šé¢æ¼”ç¤ºçš„å·¥ä½œæµåœ¨çº¿è¾“å…¥ä¸ºä»€ä¹ˆä¼šä¸‹é›¨çš„ä¾‹å­ï¼Œå¯çœ‹åˆ°æµç¨‹ä¸­æ¯ä¸€æ­¥çš„ç»“æœï¼‰ã€Traceè¿½è¸ªï¼ˆä¸Šé¢ä¾‹å­ä¸­çš„è°ƒç”¨é“¾è·¯ï¼Œå¯è¿½æº¯ï¼‰ã€è¿˜æœ‰ç”Ÿäº§ç›‘æ§Monitoringï¼ˆä¸Šçº¿åè¿½è¸ªç”¨æˆ·çœŸå®äº¤äº’ï¼Œæ–¹ä¾¿åç»­ä¼˜åŒ–æ™ºèƒ½ä½“ï¼‰å’Œè¯„ä¼°Evaluationï¼ˆæ”¯æŒå¯¹ä¸ç”¨çš„Prompt/æ¨¡å‹/ABæµ‹è¯•/è´¨é‡ç­‰è¿›è¡Œè¯„ä¼°ï¼‰ã€‚</p>
<p>é‚£å¦‚ä½•å»ºç«‹çš„è”ç³»å‘¢ï¼Œå¤§å®¶æœ€æ—©åœ¨ä¸Šé¢è¿˜æœ‰å°è±¡å§ï¼Œè®©å¤§å®¶åœ¨ã€.envã€‘ä¸­é…ç½®äº†LangSmithçš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œä¸”Tracingè¿˜è®¾ç½®ä¸ºäº†Trueã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0f52561d77641a3a52ff408861a5da3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=Jo85XXPO4d4mxKeR%2BxcYG7pr1uA%3D" alt="" loading="lazy"/></p>
<p>åœ¨ç”Ÿæˆçš„ä»£ç é€»è¾‘ä¸­ï¼Œé€šè¿‡è¿™äº›å‚æ•°ï¼Œå°±è®©ä½ çš„å·¥ç¨‹ä¸LangSmithå¹³å°å…³è”ä¸Šäº†ã€‚</p>
<p>ä»£ç ä¸­å¼•å…¥è¿½è¸ªçš„æ³¨è§£ï¼Œåœ¨æƒ³è¿½è¸ªçš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£çš†å¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71063c0eadb241c4bf47d253d63edc8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=G4uKj8dK1TsfM%2FkhwTyBZgEkF30%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/331be0e9c5c04357b9a8012174091600~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=vKUIA9%2FjlAVnmLdDSo5QzgDOn2g%3D" alt="" loading="lazy"/></p>
<p>å®˜ç½‘å†™çš„æ›´æ˜¯è¯¦ç»†å¦‚ä½•æ¥å…¥ï¼ŒåŒ…æ‹¬æœªç»™å¤§å®¶æ¼”ç¤ºçš„è¯„ä¼°EvaluationåŠŸèƒ½ï¼Œåœ¨æ­¤ä¸è¯¦ç»†è§£é‡Šäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8000956a5d2347f8adc7210f2f4a54e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=b4iXgoLcOQWbDjDfAEH4Ro03BbQ%3D" alt="" loading="lazy"/></p>
<p>åˆ°è¿™é‡Œï¼Œæ‰ç®—æ˜¯ï¼ŒLangChainã€LangGraphå’ŒLangSmithè®²å®Œäº†ã€‚</p>
<h2 data-id="heading-6">7ã€æ‰©å±•éƒ¨åˆ†ï¼šagent-chat UIçš„ä½¿ç”¨</h2>
<p>è¿™ä¸€éƒ¨åˆ†å±äºæ‹“å±•éƒ¨åˆ†ï¼Œåˆšæ‰æˆ‘ä»¬å†™çš„Agentäº‹å®ä¸Šæ˜¯æ²¡æœ‰UIçš„ã€‚LangChainç”Ÿæ€ä¹Ÿæ˜¯æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥å®˜æ–¹è¿˜æ¨å‡ºäº†ä¸€ä¸ªAgent-Chatå¼€æºé¡¹ç›®ï¼Œå¯ä»¥å¿«é€Ÿæ„ç­‘UIï¼Œå…³è”åˆ°æˆ‘ä»¬åˆšæ‰æœ¬åœ°åˆ›å»ºçš„æ™ºèƒ½ä½“ã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Fagent-chat-ui" target="_blank" title="https://github.com/langchain-ai/agent-chat-ui" ref="nofollow noopener noreferrer">github.com/langchain-aâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c4a23a5cbe41918452236a535c22b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=c2Bq4G3BVQMan%2Fh1GbCFQF1xE2k%3D" alt="" loading="lazy"/></p>
<p>ä½¿ç”¨å’Œå®‰è£…ä¹Ÿæ˜¯éå¸¸çš„ç®€å•ï¼Œå®˜ç½‘ä¸Šå†™çš„å¾ˆæ¸…æ¥šï¼Œå…ˆcloneé¡¹ç›®åˆ°æœ¬åœ°ï¼Œç„¶åè¿›å…¥åˆ°é¡¹ç›®ç›®å½•åï¼Œé€šè¿‡ã€pnpm installã€‘è¿›è¡Œå®‰è£…ï¼Œé€šè¿‡ã€pnpm devã€‘å¯åŠ¨è¯¥é¡¹ç›®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7419c0799ff7422d911e881604672905~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=LA1vb9ceEyXzt%2B7EtAw3yzKATzQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1f1aab09e3646938720f8d21d40e80b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=cxgUlPz9gBPln3c59Xo49V16TXk%3D" alt="" loading="lazy"/></p>
<p>å¯åŠ¨æˆåŠŸåï¼Œå³å¯é€šè¿‡3000ç«¯å£è¿›è¡Œè®¿é—®ã€‚è®¿é—®åï¼Œä¸»é¡µé¢ä¸Šé…ç½®å¯åŠ¨æœ¬åœ°æœåŠ¡åœ°å€ã€é¡¹ç›®IDä¸LangSmith API Keyå³å¯è¿æ¥åˆ°æœ¬åœ°å¯åŠ¨çš„æ™ºèƒ½ä½“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ac4540741ca4acdbea95904add385f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=PPC3%2BtamdkGJrzj7QbyyJINI3Uo%3D" alt="" loading="lazy"/></p>
<p>é…ç½®æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸æé—®äº†ï¼Œä¾‹å¦‚æˆ‘ä¸‹é¢é—®çš„ï¼šåœ°çƒä¸ºä»€ä¹ˆæ˜¯åœ†çš„ã€‚ç»™æˆ‘æ­£å¸¸å“åº”ï¼Œå¹¶ä¸”åœ¨åå°å·¥ç¨‹ä¸­ä¹Ÿè¿›è¡Œäº†æ•°æ®åˆ†æå’Œç”Ÿæˆäº†å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e1bc779fd344dad879fac8479069328~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763617802&amp;x-signature=u8Zhkcv4Is3XUXM3cxCft8C%2BWnI%3D" alt="" loading="lazy"/></p>
<hr/>
<p>æ€»ç»“ä¸‹ä»Šå¤©çš„å†…å®¹ï¼Œæˆ‘ä»¬ä»0åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„é¡¹ç›®ï¼Œå¹¶ä¸”å€ŸåŠ©äºCursorï¼Œè®©å…¶ç»™æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªLangChainå’ŒLangGraphçš„Demoï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å…³è”åˆ°äº†LangSmithå¹³å°è¿›è¡Œè°ƒè¯•å’Œè¿½è¸ªï¼Œæœ€åé€šè¿‡Agent-Chatå¿«é€Ÿæ„å»ºäº†UIå»ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-7">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java 17å®æˆ˜ï¼šæˆ‘ä»è€æ—§Springé¡¹ç›®è¿ç§»ä¸­æ€»ç»“çš„7ä¸ªå…³é”®é¿å‘ç‚¹]]></title>    <link>https://juejin.cn/post/7571722835658571810</link>    <guid>https://juejin.cn/post/7571722835658571810</guid>    <pubDate>2025-11-13T04:17:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571722835658571810" data-draft-id="7571734313923493922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java 17å®æˆ˜ï¼šæˆ‘ä»è€æ—§Springé¡¹ç›®è¿ç§»ä¸­æ€»ç»“çš„7ä¸ªå…³é”®é¿å‘ç‚¹"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-13T04:17:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="IT_é™ˆå¯’"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java 17å®æˆ˜ï¼šæˆ‘ä»è€æ—§Springé¡¹ç›®è¿ç§»ä¸­æ€»ç»“çš„7ä¸ªå…³é”®é¿å‘ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    IT_é™ˆå¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T04:17:17.000Z" title="Thu Nov 13 2025 04:17:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Java 17å®æˆ˜ï¼šæˆ‘ä»è€æ—§Springé¡¹ç›®è¿ç§»ä¸­æ€»ç»“çš„7ä¸ªå…³é”®é¿å‘ç‚¹</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨å½“ä»Šå¿«é€Ÿå‘å±•çš„Javaç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œä¿æŒæŠ€æœ¯æ ˆçš„ç°ä»£æ€§è‡³å…³é‡è¦ã€‚éšç€Java 17ï¼ˆLTSç‰ˆæœ¬ï¼‰çš„å‘å¸ƒå’ŒSpringæ¡†æ¶çš„æŒç»­æ¼”è¿›ï¼Œè®¸å¤šä¼ä¸šæ­£é¢ä¸´å°†è€æ—§Springé¡¹ç›®è¿ç§»åˆ°æ–°ç‰ˆæœ¬çš„æŠ€æœ¯æŒ‘æˆ˜ã€‚æœ¬æ–‡åŸºäºç¬”è€…å®é™…å‚ä¸çš„å¤§å‹é—ç•™ç³»ç»Ÿè¿ç§»ç»éªŒï¼Œæ€»ç»“äº†7ä¸ªå…³é”®é¿å‘ç‚¹ï¼Œæ¶µç›–ä»ä¾èµ–ç®¡ç†åˆ°è¿è¡Œæ—¶è¡Œä¸ºçš„å„ä¸ªæ–¹é¢ã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“å†…å®¹</h2>
<h3 data-id="heading-3">1. Javaæ¨¡å—ç³»ç»Ÿ(JPMS)ä¸è€å¼ç±»åŠ è½½æœºåˆ¶çš„å†²çª</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å…¸å‹é—®é¢˜ç¤ºä¾‹ï¼šéæ¨¡å—åŒ–ä¾èµ–åœ¨modulepathä¸‹çš„è¡Œä¸ºå˜åŒ–</span>
<span class="hljs-keyword">requires</span> spring.context; <span class="hljs-comment">// æ˜¾å¼å£°æ˜æ¨¡å—ä¾èµ–</span>
</code></pre>
<p>è¿ç§»åˆ°Java 17æ—¶æœ€å¤§çš„æ¶æ„çº§å˜åŒ–è«è¿‡äºJava Platform Module System(JPMS)ã€‚æˆ‘ä»¬å‘ç°ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨æ¨¡å—</strong>ï¼šè®¸å¤šè€æ—§Springåº“å°šæœªæä¾›æ˜ç¡®çš„<code>module-info.java</code>ï¼Œå¯¼è‡´åœ¨æ¨¡å—è·¯å¾„ä¸‹è¿è¡Œæ—¶å‡ºç°æ„å¤–è¡Œä¸º</li>
<li><strong>èµ„æºåŠ è½½</strong>ï¼š<code>ClassLoader.getResource()</code>çš„è¡Œä¸ºåœ¨æ¨¡å—åŒ–ç¯å¢ƒä¸‹å‘ç”Ÿå˜åŒ–ï¼Œç‰¹åˆ«å½±å“Springçš„èµ„æºé…ç½®åŠ è½½</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
<ol>
<li>æš‚æ—¶ä½¿ç”¨classpathè€Œémodulepathè¿è¡Œï¼ˆé€šè¿‡<code>--class-path</code>å‚æ•°ï¼‰</li>
<li>ä¸ºå…³é”®ä¾èµ–åˆ›å»ºè‡ªåŠ¨æ¨¡å—æè¿°ç¬¦</li>
<li>å…¨é¢æµ‹è¯•èµ„æºåŠ è½½é€»è¾‘</li>
</ol>
</li>
</ul>
<h3 data-id="heading-4">2. Spring XMLé…ç½®ä¸ç°ä»£æ³¨è§£é©±åŠ¨çš„å·®å¼‚</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- é—ç•™é…ç½®ç¤ºä¾‹ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"oldService"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.OldServiceImpl"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dependency"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"legacyDao"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
</code></pre>
<p>åœ¨è€é¡¹ç›®ä¸­å¸¸è§çš„XMLé…ç½®æ–¹å¼éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<ul>
<li><strong>Beanè¦†ç›–è¡Œä¸º</strong>ï¼šSpring Booté»˜è®¤ç¦æ­¢Beanå®šä¹‰è¦†ç›–ï¼Œè€Œè€é¡¹ç›®å¸¸å¸¸ä¾èµ–æ­¤ç‰¹æ€§</li>
<li><strong>å»¶è¿Ÿåˆå§‹åŒ–</strong>ï¼šç°ä»£Springé»˜è®¤æ€¥åˆ‡åˆå§‹åŒ–å•ä¾‹Beanï¼Œå¯èƒ½æš´éœ²éšè—çš„å¾ªç¯ä¾èµ–é—®é¢˜</li>
<li><strong>åº”å¯¹ç­–ç•¥</strong>ï¼š
<ul>
<li>æ˜¾å¼è®¾ç½®<code>spring.main.allow-bean-definition-overriding=true</code></li>
<li>ä½¿ç”¨<code>@Lazy</code>æ³¨è§£åŒ¹é…åŸæœ‰åˆå§‹åŒ–è¡Œä¸º</li>
<li>é€æ­¥å°†XMLé…ç½®è¿ç§»ä¸º<code>@Configuration</code>ç±»</li>
</ul>
</li>
</ul>
<h3 data-id="heading-5">3. Javaè¯­æ³•å…¼å®¹æ€§é—®é¢˜å¤„ç†</h3>





























<table><thead><tr><th>Javaç‰ˆæœ¬</th><th>Lambda</th><th>var</th><th>Switchè¡¨è¾¾å¼</th></tr></thead><tbody><tr><td>Java 8</td><td>âœ“</td><td>Ã—</td><td>Ã—</td></tr><tr><td>Java 11</td><td>âœ“</td><td>âœ“</td><td>Ã—</td></tr><tr><td>Java 17</td><td>âœ“</td><td>âœ“</td><td>âœ“</td></tr></tbody></table>
<p>å¸¸è§çš„è¯­æ³•é™·é˜±åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ¥å£é»˜è®¤æ–¹æ³•</strong>ï¼šè€é¡¹ç›®ä¸­å¯èƒ½åŒ…å«æœªè€ƒè™‘é»˜è®¤æ–¹æ³•å†²çªçš„å®ç°</li>
<li><strong>ç±»å‹æ¨æ–­å˜åŒ–</strong>ï¼šJavaæ”¹è¿›çš„ç±»å‹æ¨æ–­å¯èƒ½å¯¼è‡´æ³›å‹æ–¹æ³•è°ƒç”¨è¡Œä¸ºå˜åŒ–</li>
<li><strong>æ¨èåšæ³•</strong>ï¼š
<ol>
<li>ä½¿ç”¨JDK Migrationå·¥å…·åˆ†ææºä»£ç å·®å¼‚</li>
<li><code>javac -Xlint:unchecked</code>å…¨é¢æ£€æŸ¥æ³›å‹é—®é¢˜</li>
<li>IDEé™æ€åˆ†æå·¥å…·æ£€æµ‹è¯­æ³•å…¼å®¹æ€§</li>
</ol>
</li>
</ul>
<h3 data-id="heading-6">4. Hibernate/JPAæŒä¹…å±‚å‡çº§é™·é˜±</h3>
<p>å®ä½“æ˜ å°„ä¸­çš„æ½œåœ¨é—®é¢˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LegacyEntity</span> {
    <span class="hljs-meta">@Column(name = "USER_ID")</span> <span class="hljs-comment">// Oracleä¿ç•™å­—é—®é¢˜å¯èƒ½åœ¨æ–°ç‰ˆæœ¬å‡¸æ˜¾</span>
    <span class="hljs-keyword">private</span> String userId;
    
    <span class="hljs-meta">@Temporal(TemporalType.DATE)</span> <span class="hljs-comment">// JAVA8+åº”ä½¿ç”¨java.timeç±»å‹</span>
    <span class="hljs-keyword">private</span> Date oldDate;
}
</code></pre>
<p>å…³é”®æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><strong>æ–¹è¨€å˜åŒ–</strong>ï¼šHibernateæ–°ç‰ˆæ–¹è¨€å¯èƒ½ç”Ÿæˆä¸åŒçš„SQLè¯­å¥ï¼ˆç‰¹åˆ«æ˜¯åˆ†é¡µæŸ¥è¯¢ï¼‰</li>
<li><strong>N+1æŸ¥è¯¢é—®é¢˜</strong>ï¼šåŸæœ¬èƒ½å¿å—çš„æ€§èƒ½é—®é¢˜åœ¨æ–°ç‰ˆè¿æ¥æ± ä¸­å¯èƒ½è¢«æ”¾å¤§</li>
<li><strong>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºç»†å¾®å˜åŒ–</strong></li>
</ul>
<p>è§£å†³æ–¹æ¡ˆè·¯å¾„ï¼š</p>
<ol>
<li>SQLæ—¥å¿—æ¯”å¯¹ï¼ˆå¼€å¯<code>spring.jpa.show-sql=true</code>)</li>
<li>Flyway/Liquibaseè„šæœ¬å…¼å®¹æ€§æµ‹è¯•</li>
<li>JDBCè¿æ¥æ± å‚æ•°è°ƒä¼˜ï¼ˆå»ºè®®HikariCPï¼‰</li>
</ol>
<h3 data-id="heading-7">5. Spring Securityçš„ç ´åæ€§å˜æ›´</h3>
<p>å®‰å…¨é…ç½®çš„é‡å¤§å˜åŒ–æ—¶é—´çº¿ï¼š</p>
<pre><code class="hljs language-css" lang="css">Spring Security â‰¤<span class="hljs-number">4</span> â†’ CSRFé»˜è®¤å…³é—­ 
Spring Security â‰¥<span class="hljs-number">5</span> â†’ CSRFé»˜è®¤å¼€å¯ 

OAuth â‰¤<span class="hljs-number">1</span><span class="hljs-selector-class">.x</span> â†’ <span class="hljs-keyword">@EnableOAuth2Client</span> 
OAuth â‰¥<span class="hljs-number">2</span>.x â†’å…¨æ–°å®¢æˆ·ç«¯æ³¨å†Œä½“ç³»
</code></pre>
<p>è¿ç§»æ—¶å¿…é¡»æ³¨æ„ï¼š</p>
<ol>
<li>WebSecurityConfigurerAdapterå·²è¢«å¼ƒç”¨ï¼ˆéœ€é‡æ„ä¸ºLambda DSLé£æ ¼ï¼‰</li>
<li>PasswordEncoderå¼ºåˆ¶è¦æ±‚ï¼ˆåŸæ˜æ–‡å¯†ç å­˜å‚¨å¿…é¡»æ˜¾å¼å¤„ç†ï¼‰</li>
<li>CSRFä¿æŠ¤ç­–ç•¥è°ƒæ•´å»ºè®®ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Overrideprotected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception {
    http.csrf(csrf -&gt; csrf 
        .ignoringAntMatchers(<span class="hljs-string">"/api/legacy/**"</span>));
}
</code></pre>
<h3 data-id="heading-8">6. Loggingæ¡†æ¶æ¡¥æ¥çš„æ­£ç¡®å§¿åŠ¿</h3>
<p>æ—¥å¿—å †æ ˆçš„å…¸å‹æ··ä¹±æƒ…å†µï¼š</p>
<pre><code class="hljs language-scss" lang="scss">åº”ç”¨ä»£ç  â†’ SLF4J API 
â†“ 
log4j-over-slf4j â†’ Logback (æœŸæœ›è·¯å¾„)
â†‘ 
ç›´æ¥è°ƒç”¨Log4j (æ„å¤–è·¯å¾„)
</code></pre>
<p>ç¡®ä¿æ—¥å¿—ç»Ÿä¸€çš„å…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li>Mavenä¾èµ–æ£€æŸ¥ï¼š</li>
</ol>
<pre><code class="hljs language-xml&lt;dependency&gt;" lang="xml&lt;dependency&gt;">    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;jul-to-slf4j&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ol start="2">
<li>JVMå‚æ•°éªŒè¯ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-Djava.util.logging.config.file</span>=/dev/null  
<span class="hljs-attr">-Dlog4j2.configurationFactory</span>=...
</code></pre>
<p>3.AOPåˆ‡é¢æ—¥å¿—é€‚é…æµ‹è¯•ï¼ˆç‰¹åˆ«æ˜¯CGLIBä»£ç†åœºæ™¯ï¼‰</p>
<p>###7.Javaå†…éƒ¨APIçš„æœ€åé˜²çº¿</p>
<p>Sun.misc.BASE64Encoderç­‰å†…éƒ¨APIåœ¨Java17å·²å®Œå…¨ç§»é™¤</p>
<p>åº”æ€¥æ–¹æ¡ˆå¯¹æ¯”è¡¨ï¼š</p>

























<table><thead><tr><th>Â åœºæ™¯Â </th><th>Â ä¸´æ—¶æ–¹æ¡ˆÂ </th><th>Â é•¿æœŸæ–¹æ¡ˆÂ </th></tr></thead><tbody><tr><td>Unsafeè®¿é—®</td><td>--add-opens</td><td>VarHandle</td></tr><tr><td>XMLè§£æå™¨</td><td>JAXBç‹¬ç«‹ä¾èµ–(Jakarta)Â </td><td>javax.xmlç§»æ¤åŒ…</td></tr><tr><td>Nashornè„šæœ¬Â Â </td><td>GraalVM JSå¼•æ“Â Â ç§»æ¤åˆ°RhinoÂ Â </td><td/></tr></tbody></table>
<p>æ¨èæ‰§è¡Œé¡ºåºï¼š
1.JDKå‡çº§å‰å…ˆç”¨jdepsåˆ†æ(--jdk-internals)
2.Gradle/Mavenæ’ä»¶è¾…åŠ©æ£€æµ‹ï¼š</p>
<pre><code class="hljs language-groovycompileJava" lang="groovycompileJava"/></pre>
<p>3.Runtime.version()åšç‰ˆæœ¬é€‚é…å…œåº•</p>
<p>##æ€»ç»“</p>
<p>æœ¬æ¬¡è¿ç§»å®è·µä¸­æˆ‘ä»¬æ·±åˆ»ä½“ä¼šåˆ°ï¼š"æ²¡æœ‰ç®€å•çš„å‡çº§åªæœ‰æƒè¡¡çš„è‰ºæœ¯"ã€‚Java17å¸¦æ¥çš„ä¸ä»…æ˜¯è¯­è¨€ç‰¹æ€§çš„æå‡æ›´é‡è¦çš„æ˜¯æ¨åŠ¨æ¶æ„ç°ä»£åŒ–æ”¹é€ çš„æœºä¼šçª—å£ã€‚éµå¾ªä»¥ä¸‹åŸåˆ™å¯é™ä½é£é™©:</p>
<p>â€¢å¢é‡å¼è¿ç§»(å¤šé˜¶æ®µå‘å¸ƒ)
â€¢å¼ºåŒ–å¥‘çº¦æµ‹è¯•(ç‰¹åˆ«æ˜¯å¯¹ä¸‹æ¸¸ç³»ç»Ÿ)
â€¢å»ºç«‹æ€§èƒ½åŸºå‡†çº¿(é¿å…éšæ€§é€€åŒ–)</p>
<p>æœ€ç»ˆæˆ‘ä»¬çš„ç³»ç»Ÿè·å¾—äº†40%çš„GCæ•ˆç‡æå‡å’Œæ–°è¯­è¨€ç‰¹æ€§çš„å¼€å‘æ•ˆç‡å¢ç›Šè¯æ˜è¿™äº›åŠªåŠ›æ˜¯å€¼å¾—çš„ã€‚å¸Œæœ›è¿™äº›å®æˆ˜ç»éªŒèƒ½å¸®åŠ©è¯»è€…é¿å¼€æˆ‘ä»¬æ›¾ç»è¸©è¿‡çš„é‚£äº›"æ·±å‘"ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°ç™½ä¹Ÿèƒ½è®­å¤§æ¨¡å‹ï¼Hugging Faceç”¨ã€Œ200é¡µæ‰‹å†Œã€äº²è‡ªæ•™å­¦ï¼Œè¿è¸©çš„å‘éƒ½å‘Šè¯‰ä½ äº†...]]></title>    <link>https://juejin.cn/post/7571742703533899812</link>    <guid>https://juejin.cn/post/7571742703533899812</guid>    <pubDate>2025-11-13T03:29:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571742703533899812" data-draft-id="7571747061385904147" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°ç™½ä¹Ÿèƒ½è®­å¤§æ¨¡å‹ï¼Hugging Faceç”¨ã€Œ200é¡µæ‰‹å†Œã€äº²è‡ªæ•™å­¦ï¼Œè¿è¸©çš„å‘éƒ½å‘Šè¯‰ä½ äº†..."/> <meta itemprop="keywords" content="LLM,ç¨‹åºå‘˜,Agent"/> <meta itemprop="datePublished" content="2025-11-13T03:29:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°ç™½ä¹Ÿèƒ½è®­å¤§æ¨¡å‹ï¼Hugging Faceç”¨ã€Œ200é¡µæ‰‹å†Œã€äº²è‡ªæ•™å­¦ï¼Œè¿è¸©çš„å‘éƒ½å‘Šè¯‰ä½ äº†...
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:29:25.000Z" title="Thu Nov 13 2025 03:29:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58566b11f6f64110ab7486a258b0320f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609365&amp;x-signature=1iVOt4dVsjMvOo6zpP30a2PNVuE%3D" alt="" loading="lazy"/></p>
<p>å¯¹äºæŠ€æœ¯å°ç™½è€Œè¨€ï¼Œèƒ½å¦å¿«é€Ÿä»é›¶å¼€å§‹è®­ç»ƒä¸€ä¸ªä¸–ç•Œçº§çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæˆ–è®¸æ˜¯ï¼šå¯ä»¥çš„ã€‚</p>
<p>æ—¥å‰ï¼ŒHugging FaceÂ åœ¨æŠ€æœ¯åšå®¢ã€ŠThe Smol Training Playbook: The Secrets to Building World-Class LLMsã€‹ä¸­ï¼Œä»¥è®­ç»ƒ 3B å‚æ•°å¤§å°çš„ SmoILM3 ä¸ºä¸»çº¿ï¼Œç³»ç»Ÿå‰–æäº†æ„å»º SOTA è¯­è¨€æ¨¡å‹çš„å…¨è¿‡ç¨‹ï¼ŒåŒ…æ‹¬é¢„è®­ç»ƒã€åè®­ç»ƒå’Œ infraï¼Œè¶³è¶³ 200 å¤šé¡µå†…å®¹ï¼Œè¯¦ç»†è®°å½•äº†å“ªäº›æ–¹æ³•æœ‰æ•ˆã€å“ªäº›æ— æ•ˆï¼Œä»¥åŠå¦‚ä½•ç¡®ä¿å…¶å¯é è¿è¡Œã€‚</p>
<p>æ— è®ºä½ æ˜¯åˆå…¥äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰é¢†åŸŸçš„å­¦ç”Ÿã€å¸Œæœ›äº†è§£å…¨æµç¨‹çš„å·¥ç¨‹å¸ˆï¼Œè¿˜æ˜¯æ­£åœ¨è§„åˆ’ä¸‹ä¸€ä¸ªå¤§æ¨¡å‹é¡¹ç›®çš„å›¢é˜Ÿï¼Œè¿™ä»½æ‰‹å†Œéƒ½æä¾›äº†å¯å‚è€ƒçš„å®æˆ˜ç»éªŒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ece956cca89240358538640f6450ae63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609365&amp;x-signature=cI7x%2BAdG97KCnr35CWzia%2BIz%2Bu8%3D" alt="" loading="lazy"/></p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fspaces%2FHuggingFaceTB%2Fsmol-training-playbook%23introduction" target="_blank" title="https://huggingface.co/spaces/HuggingFaceTB/smol-training-playbook#introduction" ref="nofollow noopener noreferrer">huggingface.co/spaces/Huggâ€¦</a></p>
<h2 data-id="heading-0">è®­ç»ƒæŒ‡å—é’ˆâ€”â€”ä»â€œè¦ä¸è¦åšâ€å¼€å§‹</h2>
<p>åœ¨è¿‡å»å‡ å¹´ä¸­ï¼Œå¤§é‡å›¢é˜Ÿåœ¨æ‹¥æœ‰ç®—åŠ›åä¾¿ç›´æ¥å¼€å§‹è®­ç»ƒæ¨¡å‹ï¼Œä½†å¤§å¤šæ•°é¡¹ç›®æ— æœè€Œç»ˆã€‚è¿™äº›å¤±è´¥çš„æ ¹æºå¹¶éç®—æ³•ä¸è¶³ï¼Œè€Œæ˜¯åŠ¨æœºä¸æ¸…ã€‚</p>
<p>Hugging Face å›¢é˜Ÿç”¨ä¸‰ä¸ªé—®é¢˜ï¼ŒæŠŠæ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å˜æˆä¸€æ¡æ¸…æ™°çš„æ€è€ƒé“¾æ¡ï¼šä¸ºä»€ä¹ˆè¦è®­ç»ƒï¼ˆWhyï¼‰ â†’ è®­ç»ƒä»€ä¹ˆï¼ˆWhatï¼‰ â†’ æ€ä¹ˆè®­ç»ƒï¼ˆHowï¼‰ã€‚è¿™ä¸‰ä¸ªé—®é¢˜çœ‹ä¼¼ç®€å•ï¼Œå´èƒ½åŒºåˆ†â€œç†æ€§è®­ç»ƒâ€å’Œâ€œç›²ç›®çƒ§ç®—åŠ›â€çš„å·®åˆ«ã€‚</p>
<p><strong>Why â€”â€” ä¸ºä»€ä¹ˆè¦è®­ç»ƒ</strong></p>
<p>çœŸæ­£å€¼å¾—è®­ç»ƒçš„åŸå› åªæœ‰ä¸‰ç§ï¼šä¸€æ˜¯ç§‘ç ”æ¢ç´¢ï¼Œæ¯”å¦‚éªŒè¯æ–°æ¶æ„ã€æ–°ç®—æ³•ï¼›äºŒæ˜¯ç”Ÿäº§éœ€æ±‚ï¼Œä¸ºç‰¹å®šåœºæ™¯æˆ–å®‰å…¨è¦æ±‚å®šåˆ¶æ¨¡å‹ï¼› ä¸‰æ˜¯æˆ˜ç•¥æ€§å¼€æºï¼Œä¸ºå¤§æ¨¡å‹é¢†åŸŸè¡¥è¶³ç©ºç™½ã€‚å›¢é˜Ÿè¦åˆ¤æ–­å·²æœ‰æ¨¡å‹æ˜¯å¦èƒ½é€šè¿‡æç¤ºå·¥ç¨‹ï¼ˆPrompting Engineeringï¼‰æˆ–å¾®è°ƒï¼ˆFine-tuningï¼‰æ¥è§£å†³é—®é¢˜ï¼›è‹¥ä¸èƒ½ï¼Œå†è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚</p>
<p><strong>What â€”â€” è¦è®­ç»ƒä»€ä¹ˆ</strong></p>
<p>å½“è®­ç»ƒåŠ¨æœºæ˜ç¡®åï¼Œæ¥ä¸‹æ¥è¦è®¾è®¡æ¨¡å‹ã€‚è¿™ä¸€é˜¶æ®µåŒ…æ‹¬æ¨¡å‹æ¶æ„ã€è§„æ¨¡ã€æ•°æ®æ¥æºã€ä¸Šä¸‹æ–‡é•¿åº¦ã€è¯è¡¨è®¾è®¡ç­‰ã€‚ä¾‹å¦‚ï¼Œè¦åœ¨æ‰‹æœºç«¯éƒ¨ç½²ï¼Œå°±å¾—è¿½æ±‚â€œå°è€Œé«˜æ•ˆâ€ï¼›è¦åšå¤šè¯­è¨€æ¨¡å‹ï¼Œå°±å¾—æœ‰å¤§å‹åˆ†è¯å™¨è¯æ±‡è¡¨ï¼ˆtokenizer vocabï¼‰ã€‚</p>
<p><strong>How â€”â€” æ€ä¹ˆè®­ç»ƒ</strong></p>
<p>æ‰§è¡Œé˜¶æ®µæ°¸è¿œæ’åœ¨è®­ç»ƒåŠ¨æœºå’Œè®¾è®¡æ¨¡å‹ä¹‹åã€‚å¦‚æœå‰ä¸¤æ­¥æ²¡æœ‰è¶³å¤Ÿçš„æ€è€ƒï¼Œä»»ä½•â€œæ€ä¹ˆåšâ€çš„è®¨è®ºéƒ½æ˜¯ç©ºè°ˆã€‚ å¾ˆå¤šç ”ç©¶å›¢é˜Ÿå¾€å¾€å…ˆé€‰æ‹©è®­ç»ƒæ¡†æ¶ã€ç¡®å®šè¶…å‚æ•°ï¼Œå†å›å¤´è¿½é—®â€œä¸ºä½•è¦åšâ€ã€‚è€Œ Hugging Face å€¡å¯¼çš„é€»è¾‘æ˜¯åå‘çš„ï¼šåªæœ‰åœ¨æ˜ç¡®â€œWhyâ€ä¸â€œWhatâ€ä¹‹åï¼Œè®¨è®ºâ€œHowâ€æ‰å…·æœ‰æ–¹å‘æ€§å’Œå¯æ“ä½œæ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c84fa96fe9194d77ba3eee433f2405e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609365&amp;x-signature=t%2F8qTsHQpHD3%2FPBBHadvvwPAgi0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">é¢„è®­ç»ƒâ€”â€”æ¯ä¸ªæ¨¡å‹éƒ½å§‹äºä¸€æ¬¡å°çš„æ¶ˆèå®éªŒ</h2>
<p>å¾ˆå¤šäººè®¤ä¸ºï¼Œç”¨ arXiv è®ºæ–‡è®­ç»ƒæ¨¡å‹ï¼Œæ¨¡å‹åº”è¯¥ä¼šæ›´èªæ˜ã€‚ä½†è¿™ç§æ•°æ®è¿‡äºä¸“ä¸šåŒ–è€Œç¼ºå°‘æ—¥å¸¸æ€§ã€å¤šæ ·æ€§ï¼Œåè€Œä¼šæŸå®³æ¨¡å‹çš„é€šç”¨æ€§èƒ½ã€‚åœ¨ LLM é¢†åŸŸï¼Œé‚£äº›äººç±»è®¤ä¸ºâ€œå¥½â€çš„è¾“å…¥ï¼Œä¸ä¸€å®šå¸¦æ¥â€œå¥½â€çš„è¾“å‡ºã€‚</p>
<p>æœºå™¨å­¦ä¹ å®é™…æ˜¯ä¸€é—¨å®éªŒçš„ç§‘å­¦ã€‚æˆ‘ä»¬æ— æ³•åªé æ¨ç†æˆ–å¸¸è¯†åˆ¤æ–­â€œä»€ä¹ˆæœ‰æ•ˆâ€ï¼Œåªèƒ½ä¸æ–­è¿›è¡Œå®éªŒï¼ˆå³æ¶ˆèå®éªŒï¼‰æ¥å¯¹æ¯”å’ŒéªŒè¯ã€‚</p>
<h3 data-id="heading-2">Hugging Face å›¢é˜Ÿè®¤ä¸ºï¼Œæ¶ˆèå®éªŒè®¾ç½®åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªæµç¨‹ï¼š</h3>
<p><strong>1.é€‰æ‹©åŸºçº¿</strong></p>
<p>æ¨¡å‹è®­ç»ƒï¼Œéœ€è¦ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œåªæœ‰ä»ä¸€ä¸ªå¼ºå¤§ã€æˆç†Ÿçš„åŸºçº¿å¼€å§‹ï¼Œæ‰èƒ½æŠŠæœ‰é™æ—¶é—´å’Œé‡‘é’±é›†ä¸­åœ¨çœŸæ­£é‡è¦çš„åˆ›æ–°å’Œä¼˜åŒ–ä¸Šï¼Œè€Œä¸æ˜¯æµªè´¹åœ¨è§£å†³åˆ«äººå·²ç»è§£å†³è¿‡çš„é—®é¢˜ä¸Šã€‚</p>
<p>é€‰æ‹©åŸºçº¿æ—¶è¦ç¬¦åˆå®é™…ç”¨ä¾‹å’Œéƒ¨ç½²ç¯å¢ƒ <strong>ï¼›</strong> å¿…é¡»æ˜¯ç»å†è¿‡å¤§è§„æ¨¡è®­ç»ƒï¼ˆä¸‡äº¿ token çº§åˆ«ï¼‰çš„ <strong>ï¼›</strong> æœ‰å…¬å¼€çš„ã€å¯å¤ç°çš„è¶…å‚æ•°å’Œè®¾ç½®ï¼›ä¸»æµçš„è®­ç»ƒå’Œæ¨ç†æ¡†æ¶éƒ½æ”¯æŒå®ƒç­‰ã€‚</p>
<p><strong>2.é€‰æ‹©è®­ç»ƒæ¡†æ¶</strong></p>
<p>è®­ç»ƒ LLM çš„æ ¸å¿ƒæ˜¯è¿­ä»£é€Ÿåº¦ã€‚å½“æ¨¡å‹å’Œæ•°æ®è§„æ¨¡è¶³å¤Ÿå¤§æ—¶ï¼Œé™åˆ¶å›¢é˜Ÿè¿­ä»£é€Ÿåº¦çš„å¾€å¾€ä¸æ˜¯æƒ³æ³•ï¼Œè€Œæ˜¯è®­ç»ƒæ¡†æ¶ã€‚</p>
<p>ä¸€ä¸ªå¥½çš„ LLM è®­ç»ƒæ¡†æ¶åº”è¯¥æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<p>é«˜æ€§èƒ½æ•°æ®åŠ è½½å™¨ï¼šå¿…é¡»æä¾›ä¸€ä¸ªå¯ä»¥åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šé«˜æ•ˆå·¥ä½œã€å¹¶ä¸”ä¸ä¼šæˆä¸ºç“¶é¢ˆçš„æ•°æ®åŠ è½½å™¨ã€‚</p>
<p>é²æ£’çš„åˆ†å¸ƒå¼è®¾ç½®ï¼šæ¡†æ¶åº”è¯¥èƒ½å¤Ÿå¤„ç†æ‰€æœ‰å¹¶è¡ŒåŒ–æ–¹æ¡ˆï¼ˆæ•°æ®å¹¶è¡Œã€å¼ é‡å¹¶è¡Œã€æµæ°´çº¿å¹¶è¡Œï¼‰ä»¥åŠå®ƒä»¬çš„ç»„åˆã€‚</p>
<p>å¯è°ƒè¯•æ€§å’Œå¯æ‰©å±•æ€§ï¼šä¸€ä¸ªæ¸…æ™°çš„æ¡†æ¶æœ‰åŠ©äºè°ƒè¯•ï¼Œå¹¶å…è®¸æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</p>
<p>æ”¯æŒæœ€æ–°çš„ç¡¬ä»¶ï¼šå®ƒåº”è¯¥æ”¯æŒæœ€æ–°çš„ GPU æ¶æ„ï¼Œå¹¶åˆ©ç”¨ç‰¹å®šçš„ç¡¬ä»¶åŠŸèƒ½ï¼ˆå¦‚ Hopper æ¶æ„ä¸Šçš„ Transformer Engine æˆ– FP8 æ ¼å¼ï¼‰ã€‚</p>
<p>æˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿï¼šæ´»è·ƒçš„ç¤¾åŒºã€å®šæœŸç»´æŠ¤å’Œå¤§é‡ç°æœ‰ä»£ç åº“ï¼Œå¯ä»¥æ›´å¿«åœ°è§£å†³é—®é¢˜å¹¶åˆ©ç”¨ç°æœ‰çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>3.è®¾ç½®æ¶ˆèå®éªŒæ¡†æ¶</strong></p>
<p>æ¶ˆèå®éªŒçš„ç›®çš„æ˜¯åœ¨å°è§„æ¨¡ä¸Šè¿è¡Œå®éªŒï¼Œå¹¶è·å¾—å¯ä»¥è‡ªä¿¡åœ°å¤–æ¨åˆ°æœ€ç»ˆç”Ÿäº§ç¯å¢ƒè¿è¡Œçš„ç»“æœã€‚ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<p>æ–¹æ³•ä¸€ï¼šå‡å°‘ token æ•°é‡ã€‚å¯ä»¥é‡‡ç”¨ç›®æ ‡æ¨¡å‹è§„æ¨¡ï¼Œä½†åªç”¨è¾ƒå°‘çš„ token è¿›è¡Œè®­ç»ƒã€‚ä¾‹å¦‚ï¼ŒHugging Face åœ¨ SmolLM3 çš„æ¶ˆèå®éªŒä¸­ï¼Œè®­ç»ƒäº†å®Œæ•´çš„ 3B æ¨¡å‹ï¼Œä½†åªç”¨äº† 100B tokenï¼Œè€Œé 11T tokenã€‚</p>
<p>æ–¹æ³•äºŒï¼šä½¿ç”¨ä»£ç†ï¼ˆProxyï¼‰æ¨¡å‹ã€‚å¦‚æœç›®æ ‡æ¨¡å‹å¤ªå¤§ï¼Œå¯ä»¥è®­ç»ƒä¸€ä¸ªæ›´å°çš„ä»£ç†æ¨¡å‹æ¥è¿›è¡Œæ¶ˆèå®éªŒã€‚</p>
<p>è¿‡ç¨‹ä¸­â€”â€”é©¬æ‹‰æ¾å¼çš„é•¿å‘¨æœŸè®­ç»ƒ</p>
<p>è®­ç»ƒ LLM æ˜¯ä¸€åœºé•¿æœŸçš„ã€å……æ»¡å˜æ•°çš„â€œé©¬æ‹‰æ¾â€ï¼Œè€ŒéçŸ­æœŸçš„â€œå†²åˆºâ€ã€‚è®¸å¤šé—®é¢˜åªåœ¨é•¿æ—¶é—´ã€å¤§è§„æ¨¡ã€é«˜è´Ÿè·çš„çœŸå®ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­æ‰ä¼šæš´éœ²ï¼Œè¿™æ˜¯å°è§„æ¨¡æ¶ˆèå®éªŒæ— æ³•å®Œå…¨æ¨¡æ‹Ÿçš„ã€‚</p>
<h3 data-id="heading-3">Hugging Face å›¢é˜Ÿè§£å†³äº†ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š</h3>
<p><strong>1.æ¶ˆå¤±çš„ååé‡</strong></p>
<p>ååé‡ï¼ˆTokens/ç§’ï¼‰è¡¡é‡ç€ç³»ç»Ÿåœ¨è®­ç»ƒæœŸé—´æ¯ç§’å¤„ç†çš„ token æ•°é‡ï¼Œå®ƒç›´æ¥å½±å“è®­ç»ƒæ—¶é—´ï¼›ååé‡ä¸‹é™ 50% æ„å‘³ç€åŸæœ¬ä¸€ä¸ªæœˆçš„è¿è¡Œå°†å˜æˆä¸¤ä¸ªæœˆã€‚è®­ç»ƒå¯åŠ¨åçš„å‡ å°æ—¶å†…ï¼Œååé‡éª¤é™ã€‚</p>
<p>æœ€ç»ˆé€šè¿‡æ£€æŸ¥èŠ‚ç‚¹ç›‘æ§æŒ‡æ ‡ï¼Œå‘ç°ååé‡éª¤é™ä¸ç£ç›˜è¯»å–å»¶è¿Ÿå°–å³°ç›¸å…³ã€‚é—®é¢˜åœ¨äºæ•°æ®å­˜å‚¨ï¼Œ Hugging Face å›¢é˜Ÿçš„ 24TB æ•°æ®é›†å­˜å‚¨åœ¨ FSx (Weka) ä¸Šï¼Œç”±äºå­˜å‚¨æ¨åˆ°äº†æé™ï¼Œå®ƒåœ¨è®­ç»ƒä¸­é€”å¼€å§‹é©±é€ï¼ˆevictingï¼‰æ•°æ®é›†åˆ†ç‰‡ï¼Œè¿«ä½¿å›¢é˜Ÿå¿…é¡»é‡æ–°æŠ“å–å®ƒä»¬ï¼Œä»è€Œé€ æˆåœé¡¿ï¼Œè¿™è§£é‡Šäº†ååé‡çš„å·¨å¤§æ³¢åŠ¨ã€‚</p>
<p><strong>2.æ½œä¼çš„å¹¶è¡ŒåŒ– Bug</strong></p>
<p>è®­ç»ƒä¸­è¿˜å‡ºç°äº†å…¶ä»–æ„å¤–æŒ‘æˆ˜ï¼Œä¾‹å¦‚ä¸€ä¸ªéšè”½çš„å¼ é‡å¹¶è¡Œï¼ˆTensor Parallelismï¼ŒTPï¼‰Bugã€‚å›¢é˜Ÿå‘ç°ï¼Œæ¯ä¸ª TP è¿›ç¨‹ä½¿ç”¨çš„éšæœºç§å­æ˜¯ç›¸åŒçš„ï¼Œè¿™å¯¼è‡´äº†ç»“æœä¸é TP è¿è¡Œä¸åŒ¹é…ã€‚</p>
<p>ç”±äºä¹‹å‰é€šè¿‡æ¶ˆèå®éªŒéªŒè¯äº†è®­ç»ƒä¸­çš„æ¯ä¸€ä¸ªå…¶ä»–ç»„ä»¶ï¼Œæ‰€ä»¥å›¢é˜Ÿèƒ½å¾ˆå¿«åœ°å°† TP è¯†åˆ«ä¸ºå”¯ä¸€å¯èƒ½çš„åŸå› ï¼Œå¹¶åœ¨å‘ç°æ€§èƒ½å·®è·çš„ä¸€å¤©å†…ä¿®å¤äº†è¿™ä¸ª Bugã€‚</p>
<h2 data-id="heading-4">åè®­ç»ƒâ€”â€”æ‰“ç£¨æ¨¡å‹</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7f85b3b24f94b7a8957606eb707f0f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609365&amp;x-signature=eIjT%2FLa8X2p376Gm2aWMAjvoQCI%3D" alt="" loading="lazy"/></p>
<p>å›¾ï½œLLM åè®­ç»ƒæµç¨‹å›¾</p>
<p>éšç€åŸºç¡€æ¨¡å‹çš„è§„æ¨¡å’Œè´¨é‡ä¸æ–­æå‡ï¼Œåè®­ç»ƒâ€”â€”å³å¯¹é¢„è®­ç»ƒå®Œæˆçš„æ¨¡å‹è¿›è¡Œçš„åç»­å¾®è°ƒå’Œå¯¹é½æ­¥éª¤â€”â€”å·²æˆä¸º LLM ä»·å€¼é“¾ä¸­æœ€å¤§çš„å·®å¼‚åŒ–å› ç´ ã€‚</p>
<p>å¦‚æœè¯´é¢„è®­ç»ƒæ˜¯ç”¨è›®åŠ›æŠŠçŸ¥è¯†çŒè¿›æ¨¡å‹çš„æƒé‡é‡Œï¼Œåè®­ç»ƒå°±æ˜¯æŠŠè¿™äº›åŸå§‹èƒ½åŠ›é›•ç¢æˆå¯é ã€å¯æ§çš„å½¢æ€ã€‚åè®­ç»ƒçš„å…·ä½“åšæ³•ä¸ºï¼š</p>
<ul>
<li>ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰ï¼šç”¨äºæ³¨å…¥æ ¸å¿ƒèƒ½åŠ›ï¼›</li>
<li>åå¥½ä¼˜åŒ–ï¼ˆPOï¼‰ï¼šç”¨äºç›´æ¥ä»äººç±»æˆ– AI åå¥½ä¸­å­¦ä¹ ï¼›</li>
<li>å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ï¼šç”¨äºè¶…è¶Šç›‘ç£æ•°æ®ï¼Œæç‚¼å¯é æ€§å’Œæ¨ç†èƒ½åŠ›ï¼›</li>
<li>æ•°æ®æ•´ç†ï¼ˆData curationï¼‰ï¼šç”¨äºåœ¨å¤šæ ·æ€§å’Œè´¨é‡ä¹‹é—´å–å¾—æ­£ç¡®çš„å¹³è¡¡ï¼›</li>
<li>è¯„ä¼°ï¼ˆEvaluationï¼‰ï¼šç”¨äºè·Ÿè¸ªè¿›åº¦ï¼Œå¹¶åŠæ—¶å‘ç°èƒ½åŠ›é€€æ­¥ç°è±¡ã€‚</li>
</ul>
<p>Hugging Face å›¢é˜Ÿæåˆ°ï¼Œæ„å»ºä¸€ä¸ªä¸–ç•Œçº§ LLM éœ€è¦çš„ä¸ä»…æ˜¯è›®åŠ›ï¼Œæ›´æ˜¯ä¸€å¥—ç³»ç»ŸåŒ–çš„æ–¹æ³•è®ºã€‚ä»–ä»¬å¸Œæœ›ï¼Œè¿™æœ¬å·¥å…·ä¹¦å¯ä»¥ç»™æ¯ä¸€ä¸ªå¯¹å¤§æ¨¡å‹æ„Ÿå…´è¶£çš„äººæä¾›å®ç”¨å¸®åŠ©ã€‚</p>
<h2 data-id="heading-5">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜è§£æï½œé˜¿é‡Œäº‘ FunctionAIï¼šServerless æ¶æ„ä¸‹çš„ AI åŸç”Ÿåº”ç”¨å…¨æ ˆå¼€å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7571678763782848546</link>    <guid>https://juejin.cn/post/7571678763782848546</guid>    <pubDate>2025-11-13T03:49:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571678763782848546" data-draft-id="7571655979255808040" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜è§£æï½œé˜¿é‡Œäº‘ FunctionAIï¼šServerless æ¶æ„ä¸‹çš„ AI åŸç”Ÿåº”ç”¨å…¨æ ˆå¼€å‘æŒ‡å—"/> <meta itemprop="keywords" content="Serverless"/> <meta itemprop="datePublished" content="2025-11-13T03:49:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜è§£æï½œé˜¿é‡Œäº‘ FunctionAIï¼šServerless æ¶æ„ä¸‹çš„ AI åŸç”Ÿåº”ç”¨å…¨æ ˆå¼€å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:49:42.000Z" title="Thu Nov 13 2025 03:49:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šåˆ˜å®‡</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/560f5bd2a639495bb9d664326c17785c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=ci6AfMyU5rbvyxKocjkiMWfXKmk%3D" alt="image.png" loading="lazy"/></p>
<p><em>æœ¬æ–‡æ•´ç†è‡ª 2025 äº‘æ –å¤§ä¼šï¼Œ</em> <em>é˜¿é‡Œäº‘æ™ºèƒ½é›†å›¢äº§å“ä¸“å®¶ï¼Œåˆ˜å®‡æ¼”è®²è®®é¢˜ã€Šå‡½æ•°è®¡ç®—å‘å¸ƒ FunctionAl:serverless Al åŸç”Ÿåº”ç”¨åŸºç¡€è®¾æ–½ã€‹</em></p>
<p>åœ¨ AI æŠ€æœ¯åº”ç”¨è½åœ°è¿›ç¨‹ä¸­ï¼Œç›®å‰é¢ä¸´ç€äº”å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼šå¼€å‘/å­¦ä¹ é—¨æ§›è¿‡é«˜ï¼Œéƒ¨ç½²è¿ç»´é˜¶æ®µå¤æ‚ï¼ŒAI åº”ç”¨å®‰å…¨å¤‡å—æŒ‘æˆ˜ï¼Œç”Ÿæ€èƒ½åŠ›æ–¹é¢å­˜åœ¨ä¸¥é‡çš„å‰²è£‚ä¸é”å®šç°è±¡ï¼ŒåŒæ—¶èµ„æºæˆæœ¬é«˜æ˜‚ä¸”åˆ©ç”¨ç‡ä½ä¸‹ã€‚è¿™äº›æŒ‘æˆ˜æå¤§åœ°é˜»ç¢äº† AI æŠ€æœ¯çš„å¹¿æ³›æ™®åŠä»¥åŠåº”ç”¨æ•ˆç‡çš„æœ‰æ•ˆæå‡ã€‚</p>
<p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ˆFCï¼‰ä¾æ‰˜ Serverless AI åŸºç¡€è®¾æ–½ä¸å…¨æ ˆèƒ½åŠ›çš„åˆ›æ–°çªç ´ï¼Œæ¨å‡º Function AIï¼ˆå‡½æ•°æ™ºèƒ½ï¼‰ï¼Œç²¾å‡†æ”»å…‹ä¸Šè¿°ç—›ç‚¹é—®é¢˜ï¼Œå…¨é¢æ¨åŠ¨ AI åº”ç”¨åœ¨å¼€å‘è‡³è¿ç»´çš„å…¨æµç¨‹ä¸­å®ç°é™æœ¬å¢æ•ˆã€‚ä»¥ä¸‹å°†ä»å››ä¸ªå…³é”®ç»´åº¦ï¼Œè¯¦ç»†é˜è¿°é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ˆFCï¼‰çš„æ ¸å¿ƒè§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">å‡½æ•°è®¡ç®— FCï¼šServerless å½¢æ€çš„ AI åŸºç¡€è®¾æ–½</h2>
<p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ˆFCï¼‰å…¨æ–°æ¨å‡ºÂ <strong>Serverless AI åŸºç¡€è®¾æ–½</strong>ï¼Œä»¥â€œé«˜å¯ç”¨ã€ä½æˆæœ¬ã€é›¶/ä½è¿ç»´â€ä¸ºæ ¸å¿ƒï¼Œä¸ºä¼ä¸šæä¾›ä»æ¨¡å‹éƒ¨ç½²åˆ° Agent å¼€å‘çš„å…¨æ ˆè§£å†³æ–¹æ¡ˆã€‚è¯¥å¹³å°é€šè¿‡ Serverless æ¶æ„çš„å¼¹æ€§ç‰¹æ€§ä¸æ™ºèƒ½åŒ–èµ„æºç®¡ç†ï¼Œæ˜¾è‘—é™ä½ AI åº”ç”¨çš„å¼€å‘å¤æ‚åº¦ä¸èµ„æºæˆæœ¬ï¼ŒåŠ©åŠ›ä¼ä¸šå¿«é€Ÿå®ç° AI è½åœ°ã€‚</p>
<p><strong>1. å¼€å‘æ•ˆç‡æå‡ï¼š</strong> æ— éœ€å…³æ³¨åº•å±‚èµ„æºï¼Œå¼€å‘è€…å¯ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œæ¨¡å‹ä¸€é”®è½¬æ¢ä¸º Serverless APIã€‚</p>
<p><strong>2. å¼¹æ€§èµ„æºè°ƒåº¦ï¼š</strong> æŒ‰éœ€ä»˜è´¹ + N åˆ†ä¹‹ä¸€å¡èµ„æºåˆ†é…ï¼ˆå¦‚ 1/16 å¡ï¼‰ï¼ŒGPU éƒ¨ç½²æˆæœ¬é™ä½ 90% ä»¥ä¸Šã€‚</p>
<p><strong>3. å…è¿ç»´ç‰¹æ€§ï¼š</strong> å®ä¾‹é—²ç½®æ—¶è‡ªåŠ¨ç¼©å®¹è‡³ 0ï¼Œèµ„æºåˆ©ç”¨ç‡ä¼˜åŒ– 60%ï¼Œå®ç°ä¸šåŠ¡è¿ç»´è½¬å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48c7c8cff5e346619b4a1dfb2f1695c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=NoTKHJjYVYQyurghp6n7dWfkREY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">æ ¸å¿ƒèƒ½åŠ›å‘å¸ƒï¼šAgentRun ä¸æ¨¡å‹æœåŠ¡ã€æ–‡ç”Ÿå›¾æœåŠ¡</h2>
<p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—å…¨æ–°å‘å¸ƒ FunctionAIï¼ŒåŸºäº Serverless æ¶æ„çš„ä¼ä¸šçº§ AI åº”ç”¨åŸºç¡€è®¾æ–½å¹³å°ï¼Œå®ç°ä»æ¨¡å‹æ‰˜ç®¡åˆ° Agent å¼€å‘çš„å…¨æµç¨‹è¦†ç›–ï¼Œæ˜¾è‘—é™ä½æŠ€æœ¯é—¨æ§›å¹¶æå‡è·¨å¹³å°é€‚é…æ€§ã€‚</p>
<h3 data-id="heading-2">AgentRun å…¨æµç¨‹è§£å†³æ–¹æ¡ˆ</h3>
<p>Agent Run <strong>[</strong> <strong>1]</strong> é€šè¿‡é«˜ä»£ç ä¸ä½ä»£ç ç»“åˆï¼Œæå‡ AI å¼€å‘æ•ˆç‡ï¼Œæ”¯æŒä¸»æµå¼€å‘ç”Ÿæ€ã€‚åœ¨éƒ¨ç½²é˜¶æ®µï¼Œæä¾›è½»é‡ã€çµæ´»ã€å®‰å…¨éš”ç¦»çš„ AI è¿è¡Œæ—¶ï¼Œæ”¯æŒå¤šç§æ¨¡å‹å’Œå·¥å…·è¿è¡Œæ—¶ï¼Œç¡®ä¿åº”ç”¨å®‰å…¨ä¸æ‰©å±•æ€§ã€‚è¿ç»´æ–¹é¢ï¼ŒAgent Run å…·å¤‡å…¨é“¾è·¯ç›‘æ§èƒ½åŠ›ï¼Œå…èµ„æºè¿ç»´ï¼Œå®ç°ä¸šåŠ¡è¿ç»´è½¬å‹ã€‚å…«å¤§ç»„ä»¶å…±åŒæ„å»ºï¼ŒåŠ©åŠ›å¼€å‘è€…è½»æ¾æ„å»ºä¼ä¸šçº§ AI åº”ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47d255bd34b34a83a0dd4b27f07d0d77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=35wpEa0EWrsTqcLZfn9psi83qrc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>1. å…¨ç”Ÿå‘½å‘¨æœŸèƒ½åŠ›</strong></p>
<ul>
<li>å¼€å‘é˜¶æ®µï¼šé«˜ä»£ç  + ä½ä»£ç æ¨¡å¼ï¼Œå…¼å®¹é˜¿é‡Œäº‘ç™¾ç‚¼ã€CloudFlowã€Dify ç­‰ç”Ÿæ€ï¼Œå¼€å‘è€…å¯è‡ªç”±é€‰æ‹©æ¡†æ¶ï¼›</li>
<li>éƒ¨ç½²é˜¶æ®µï¼šè½»é‡ã€çµæ´»ã€å®‰å…¨éš”ç¦»çš„è¿è¡Œæ—¶ï¼Œæ”¯æŒå¤§æ¨¡å‹/å‚ç±»æ¨¡å‹è°ƒç”¨ï¼Œæä¾›å®‰å…¨æ²™ç®±éš”ç¦»æœºåˆ¶ä¸ MCP/Function Call åè®®åŒä¿éšœï¼›</li>
<li>è¿ç»´é˜¶æ®µï¼šå…¨é“¾è·¯ç›‘æ§ + ç«¯åˆ°ç«¯å¯è§‚æµ‹æ€§ï¼Œå®šä½é—®é¢˜å¹¶æä¾›ä¼˜åŒ–å»ºè®®ï¼Œå®ç°å…èµ„æºè¿ç»´ã€‚</li>
</ul>
<p><strong>2. æŠ€æœ¯æ¶æ„ä¼˜åŠ¿</strong></p>
<ul>
<li>ç™¾ä¸‡çº§å¹¶å‘ï¼šåŸºäº Session äº²å’Œä¸å¤šè¯­è¨€å¼•æ“ï¼Œæä¾›ä¼ä¸šçº§æ²™ç®±æœåŠ¡èƒ½åŠ›ï¼›</li>
<li>æ¯«ç§’çº§å¼¹æ€§ï¼šå†…å­˜å¿«ç…§æŠ€æœ¯å®ç° CPU æ¯«ç§’å¯åŠ¨ã€GPU ç§’çº§å“åº”ï¼›</li>
<li>æˆæœ¬é™ä½ 60%ï¼šæ”¯æŒ GPU/CPU/å†…å­˜è§£è€¦é…ç½®ï¼ˆæœ€å° 0.25 CPUï¼‰ï¼Œå®ä¾‹é—²ç½®æ—¶è‡ªåŠ¨ç¼©å®¹è‡³ 0ï¼ŒæŒ‰éœ€ä»˜è´¹ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98348c639ba44559a4fe4cedea42516e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=EYw9W3tEAe8SxNRaLb0JFuwYeb4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-3">å¤§è¯­è¨€æ¨¡å‹ä»£ç†æœºåˆ¶</h4>
<p><strong>å¤šæ¨¡å‹ç»Ÿä¸€æ¥å…¥</strong></p>
<ul>
<li>æ”¯æŒ Cloudã€GPTã€é€šä¹‰åƒé—®ç­‰ 20 å®¶ä¸»æµå¤§æ¨¡å‹ï¼Œå®ç°å¼€æºæ¨¡å‹ä¸€é”®éƒ¨ç½²ï¼›</li>
<li>é€šè¿‡ç»Ÿä¸€è§„èŒƒç®¡ç†æ‰€æœ‰æ¨¡å‹ï¼Œè§£å†³ First Token å»¶è¿Ÿä¸è´Ÿè½½å‡è¡¡é—®é¢˜ã€‚</li>
</ul>
<p><strong>åŠ¨æ€æ¨¡å‹æ²»ç†</strong></p>
<ul>
<li>è‡ªåŠ¨åˆ‡æ¢æœºåˆ¶ï¼šå½“ä¸»æ¨¡å‹ First Token æ—¶é—´è¿‡é•¿æˆ–è´Ÿè½½è¿‡é«˜æ—¶ï¼Œå¿«é€Ÿå¯ç”¨å¤‡ç”¨æ¨¡å‹ï¼›</li>
<li>å¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼šå¤šæ¨¡å‹å¹¶è¡Œæ‰§è¡Œï¼Œé¦–ä¸ªè¿”å›ç»“æœçš„æ¨¡å‹ä¼˜å…ˆä½œä¸ºä¸»æ¨¡å‹ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1deb59059040413ab301e0205779786f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=T%2BGpz45P8c5bA1ecE%2F7h2JQtiAs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-4">å·¥å…·ç”Ÿæ€è”åŠ¨</h4>
<p><strong>1. ç»Ÿä¸€å·¥å…·æ¥å£</strong></p>
<ul>
<li>å…¼å®¹ MCP/Function Call åè®®ï¼Œé€‚é…ä¸»æµå·¥å…·ä¸ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ŒAPI é›†æˆæ—¶é—´ä»å¤©çº§é™è‡³åˆ†é’Ÿçº§ã€‚</li>
</ul>
<p><strong>2. æ™ºèƒ½å·¥å…·ç®¡ç†</strong></p>
<ul>
<li>Tool Hub æ’ä»¶å¸‚åœºï¼šæµ·é‡æ’ä»¶ä¸€é”®éƒ¨ç½²ï¼Œå¿«é€Ÿæ„å»ºä¸šåŠ¡åœºæ™¯ï¼›</li>
<li>æ™ºèƒ½è·¯ç”±ä¼˜åŒ–ï¼šé€šè¿‡è¯­ä¹‰åˆ†æå‰ç½®ç­›é€‰å·¥å…·ï¼Œé™ä½è°ƒç”¨æ—¶é—´ï¼ˆä» 60 ç§’é™è‡³ç§’çº§ï¼‰ä¸ Token æ¶ˆè€—ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a39f669f99eb446b81da83b7ba7b0848~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=ULUZoJpMC2xx71bBUrrIITQKB84%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-5">æ¨¡å‹æœåŠ¡ï¼šAI æ¨¡å‹ä¸€é”®è½¬åŒ–ä¸º Serverless API</h3>
<p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—æ¨å‡ºçš„<strong>æ¨¡å‹æœåŠ¡[2]</strong> ï¼Œä»¥ Serverless æ¶æ„ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡ç”Ÿæ€å…¼å®¹æ€§ã€æŠ€æœ¯èƒ½åŠ›ä¸æˆæœ¬ä¼˜åŒ–ä¸‰ä½ä¸€ä½“ï¼Œä¸ºä¼ä¸šæä¾›ä»æ¨¡å‹éƒ¨ç½²åˆ°æœåŠ¡è°ƒç”¨çš„å…¨é“¾è·¯è§£å†³æ–¹æ¡ˆã€‚è¯¥æœåŠ¡æ˜¾è‘—é™ä½ AI åº”ç”¨å¼€å‘é—¨æ§›ï¼ŒåŒæ—¶ä¿éšœé«˜å¯ç”¨æ€§ä¸èµ„æºé«˜æ•ˆåˆ©ç”¨ï¼ŒåŠ©åŠ›ä¼ä¸šå¿«é€Ÿæ„å»ºç”Ÿäº§çº§æ¨¡å‹æœåŠ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1361223193f44487a28733a2939853c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=J8TVQpHVCovvV0tab5irXNU%2FF7Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>
<p><strong>ç”Ÿæ€å…¼å®¹æ€§</strong></p>
<ul>
<li>è¦†ç›–å¤§è¯­è¨€æ¨¡å‹ä¸å‚ç±»æ¨¡å‹ï¼Œå…¼å®¹ ModelScopeã€HuggingFace ç­‰ä¸»æµå¹³å°ï¼›</li>
<li>æ”¯æŒ vLLMã€SGLangã€Ollamaã€Transformer ç­‰æŠ€æœ¯æ¶æ„çš„ä¸€é”®éƒ¨ç½²ã€‚</li>
</ul>
</li>
<li>
<p><strong>æŠ€æœ¯èƒ½åŠ›</strong></p>
<ul>
<li>æä¾› 100+ æ¨¡å‹åœ¨çº¿ä½“éªŒï¼Œ200+ æ¨¡å‹ä¸€é”®éƒ¨ç½²ï¼›</li>
<li>å…­å¤§æ¡†æ¶ä¸€é”®æ‰˜ç®¡ï¼Œä¸ Agent æœåŠ¡æ— ç¼é›†æˆï¼›</li>
<li>DevPod åœ¨çº¿ç¯å¢ƒæ”¯æŒä»£ç è°ƒè¯•ä¸é•œåƒè‡ªåŠ¨æ„å»ºï¼Œæ— éœ€æŒæ¡ Dockerfileã€‚</li>
</ul>
</li>
<li>
<p><strong>æˆæœ¬ä¼˜åŒ–</strong></p>
<ul>
<li>Serverless GPU æŠ€æœ¯ç»“åˆæŒ‰é‡ä»˜è´¹æ¨¡å¼ï¼ŒN åˆ†ä¹‹ä¸€å¡èµ„æºåˆ†é…ï¼ˆå¦‚ 1/16 å¡ï¼‰ï¼›</li>
<li>éƒ¨ç½²æˆæœ¬é™ä½ 90% ä»¥ä¸Šï¼Œèµ„æºé—²ç½®æ—¶ä¸è®¡è´¹ï¼Œæ”¯æŒç™¾ä¸‡çº§å¹¶å‘ä¸æ¯«ç§’çº§å¼¹æ€§ï¼›</li>
<li>ä¸ ComfyUIã€Dify ç­‰ç”Ÿæ€å®ç°ä¸€é”®è”åŠ¨ï¼Œæ¶ˆé™¤èµ„æºé¢„ç½®é¡¾è™‘ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-6">æ–‡ç”Ÿå›¾/å£°éŸ³/è§†é¢‘ï¼šå¤šæ¨¡æ€ AI åˆ›ä½œå¹³å°</h3>
<p><strong>å¤šæ¨¡æ€ AI åˆ›ä½œå¹³å°[3]</strong> ä»¥â€œé›¶é—¨æ§›ç”Ÿæˆâ€ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡å…¨é“¾è·¯å·¥å…·ä¸ç”Ÿæ€è”åŠ¨ï¼Œè¦†ç›–ç”µå•†è®¾è®¡ã€æ¸¸æˆæ¸²æŸ“ã€è¥é”€ç‰©æ–™ã€æ•™è‚²åŸ¹è®­ç­‰å…¨è¡Œä¸šåœºæ™¯ã€‚å¹³å°æä¾›å¼€ç®±å³ç”¨çš„æ–‡ç”Ÿå›¾/è§†é¢‘/å£°éŸ³èƒ½åŠ›ï¼Œç»“åˆé«˜æ€§ä»·æ¯”ç®—åŠ›ä¸è‡ªåŠ¨åŒ–èµ„æºç®¡ç†ï¼Œæ˜¾è‘—é™ä½åˆ›ä½œé—¨æ§›ä¸æˆæœ¬ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d5896b81c7a47cda95416beab89187c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=S3%2BA4jkOsj7KMJCMeD3bKJBII7k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>1. æ–‡ç”Ÿå›¾ä¸æ–‡ç”Ÿè§†é¢‘</strong></p>
<ul>
<li>é›†æˆ ComfyUI ä¸ Stable Diffusion å·¥å…·ï¼Œè§£å†³æœ¬åœ°éƒ¨ç½²å¤æ‚åº¦ä¸æ˜¾å­˜èµ„æºé™åˆ¶ï¼›</li>
<li>æ”¯æŒå…¨åœºæ™¯å†…å®¹ç”Ÿæˆï¼Œä»è®¾è®¡åˆ°æ¸²æŸ“å®ç°ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–ã€‚</li>
</ul>
<p><strong>2. Lora æ¨¡å‹è®­ç»ƒ</strong></p>
<ul>
<li>æä¾› Muse Lora ç­‰ä¸“ä¸šè®­ç»ƒå™¨ï¼Œè¦†ç›–æ•°æ®æ ‡æ³¨åˆ°æ¨¡å‹è®­ç»ƒçš„å…¨æµç¨‹ï¼›</li>
<li>é€‚é…å‚ç±»åœºæ™¯éœ€æ±‚ï¼Œå¿«é€Ÿç”Ÿæˆå®šåˆ¶åŒ–æ¨¡å‹ã€‚</li>
</ul>
<p><strong>3. ä¼ä¸šçº§ Serverless API è°ƒç”¨</strong></p>
<ul>
<li>ä¸€é”®éƒ¨ç½² Stable Diffusionã€ComfyUI ç­‰æ¨¡å‹ï¼Œè‡ªåŠ¨è½¬æ¢ä¸º Serverless APIï¼›</li>
<li>é«˜æ€§ä»·æ¯” GPU å¼¹æ€§ç®—åŠ› + è‡ªåŠ¨æ‰©å®¹ï¼Œæ”¯æŒåŒæ­¥/å¼‚æ­¥çµæ´»åˆ‡æ¢ã€‚</li>
</ul>
<h2 data-id="heading-7">Agent æœ€ä½³å…¨æ ˆå®è·µï¼šFunction Qï¼Œä½ çš„äº‘ä¸ŠåŠ©ç†</h2>
<p>Function Q æ˜¯ä¸“ä¸šçš„å‡½æ•°è®¡ç®—æ™ºèƒ½åŠ©æ‰‹ï¼Œé›†æˆäº†åŸºäºå¤§æ¨¡å‹çš„ä»£ç è‡ªåŠ¨ç”Ÿæˆã€æ™ºèƒ½è¿ç»´è¯Šæ–­å’Œç³»ç»Ÿæ¶æ„è®¾è®¡ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼Œæ˜¾è‘—æå‡ Serverless åº”ç”¨çš„å¼€å‘æ•ˆç‡ã€‚æ•´ä½“æŠ€æœ¯æ ˆåŸºäºå‡½æ•°è®¡ç®— FCã€API ç½‘å…³ã€RocketMQã€SLS ç­‰é˜¿é‡Œäº‘æˆç†ŸåŸºç¡€æœåŠ¡æ„å»ºï¼Œéµå¾ªäº‘åŸç”Ÿè®¾è®¡åŸåˆ™ï¼Œæä¾›ä¼ä¸šçº§çš„é«˜å¯ç”¨æ€§ã€å®‰å…¨æ€§å’Œå¯è§‚æµ‹æ€§ä¿éšœã€‚Â </p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c2564f647a84607b8a03f4fc122b870~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763610582&amp;x-signature=sQSdPP73BIo0EMFn6r5EMPi18ws%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>1. æ™ºèƒ½å¼€å‘åŠ©æ‰‹</strong></p>
<ul>
<li>æ„å›¾é©±åŠ¨éƒ¨ç½²ï¼šç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼ˆå¦‚â€œè·å–æœ¬åœ°å¤©æ°”â€ï¼‰ï¼ŒFunction Q è‡ªåŠ¨ç”Ÿæˆä»£ç å¹¶éƒ¨ç½²è‡³å‡½æ•°è®¡ç®—ï¼Œæä¾›æŒ‰é‡ä»˜è´¹çš„ API æ¥å£ï¼›</li>
<li>ç¤ºä¾‹åœºæ™¯ï¼šè¾“å…¥â€œè·å–æœ¬åœ° IPâ€ï¼ŒFunction Q è‡ªåŠ¨æŸ¥è¯¢ API å¹¶ç”Ÿæˆå¯è°ƒç”¨æœåŠ¡ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ Dockerfile æˆ–é…ç½®èµ„æºã€‚</li>
</ul>
<p><strong>2. è¿ç»´è¯Šæ–­ä¸“å®¶</strong></p>
<ul>
<li>é—®é¢˜è‡ªåŠ¨åˆ†æï¼šé’ˆå¯¹èµ„æºè´¹ç”¨å¼‚å¸¸ã€å‡½æ•°è¿è¡Œé”™è¯¯ç­‰é—®é¢˜ï¼Œè°ƒç”¨ MCP å·¥å…·é“¾å®šä½æ ¹æºå¹¶æä¾›è§£å†³æ–¹æ¡ˆï¼›</li>
<li>å®æ—¶ç›‘æ§æ”¯æŒï¼šæ”¯æŒå…¨é“¾è·¯å¯è§‚æµ‹æ€§ï¼Œç¼©çŸ­æ•…éšœæ’æŸ¥å‘¨æœŸï¼Œæå‡è¿ç»´æ•ˆç‡ã€‚</li>
</ul>
<p><strong>3. æ¶æ„è®¾è®¡é¡¾é—®</strong></p>
<ul>
<li>ä¸šåŠ¡è¿ç§»æŒ‡å¯¼ï¼šé€šè¿‡ä¸šåŠ¡æè¿°åˆ†æï¼Œæ¨èåˆ‡åˆ†æ–¹æ³•æˆ–æ•´ä½“æ‰“åŒ…ç­–ç•¥ï¼Œé€‚é…å‡½æ•°è®¡ç®—æ¶æ„éœ€æ±‚ï¼›</li>
<li>åœºæ™¯è¦†ç›–ï¼šè§£å†³å¼€å‘è€…å¯¹ Serverless æ¶æ„è¿ç§»è·¯å¾„çš„å›°æƒ‘ï¼Œå®ç°é›¶é—¨æ§›ä¸Šäº‘ã€‚</li>
</ul>
<h2 data-id="heading-8">æ‹¥æŠ±å¼€æºï¼Œä¸å¼€æºå…±æˆé•¿</h2>
<p>é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—å°†åšå®šæ‹¥æŠ±å¼€æºã€ä¸å¼€æºå…±æˆé•¿ã€‚AI å¹¶éå•çº¯å•†ä¸šåŒ–äº§å“ï¼Œè€Œæ˜¯å¼€æ”¾å…±èµ¢çš„æŠ€æœ¯ç”Ÿæ€å¹³å°ã€‚å½“ä¸‹ï¼Œæˆ‘ä»¬å·²ä¸ Agentscopeã€LangChainã€dify ç­‰å¹³å°å¼€å±•å¼€æºæ‰˜ç®¡åŠä»£ç é›†æˆå·¥ä½œã€‚</p>
<p>æœªæ¥ï¼Œè¿˜æœ‰ä¸¤å¤§å…³é”®åŠ¨ä½œï¼šä¸€æ˜¯å¼€æº AgentRun SDKï¼ŒåŠ©åŠ›å¿«é€Ÿé›†æˆä¸Šå±‚å¼€æºæ¡†æ¶ï¼›äºŒæ˜¯æ¨å‡º model pluginï¼Œè®©æ‰€æœ‰å‚ç±»æ¨¡å‹å¯åƒæ’ä»¶èˆ¬ï¼Œå¿«é€Ÿæ¥å…¥ difyã€N8Nã€Stable Diffusion\ComfyUI ç­‰ç°æœ‰ç”Ÿæ€ã€‚æˆ‘ä»¬æœŸæœ›å€Ÿæ­¤ä¸ä»…æ‹¥æŠ±å¼€æºï¼Œæ›´èƒ½åå“ºå¼€æºï¼Œæºæ‰‹å…±è¿›ã€‚</p>
<p><strong>ç›¸å…³é“¾æ¥ï¼š</strong></p>
<p>[1]Â Agent Run</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffcnext.console.aliyun.com%2Fagent-run" target="_blank" title="https://fcnext.console.aliyun.com/agent-run" ref="nofollow noopener noreferrer">fcnext.console.aliyun.com/agent-run</a></p>
<p>[2]Â æ¨¡å‹æœåŠ¡</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffcnext.console.aliyun.com%2Ffun-model" target="_blank" title="https://fcnext.console.aliyun.com/fun-model" ref="nofollow noopener noreferrer">fcnext.console.aliyun.com/fun-model</a></p>
<p>[3]Â å¤šæ¨¡æ€ AI åˆ›ä½œå¹³å°</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffcnext.console.aliyun.com%2Ffun-art%2Fexplore" target="_blank" title="https://fcnext.console.aliyun.com/fun-art/explore" ref="nofollow noopener noreferrer">fcnext.console.aliyun.com/fun-art/expâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vibe Coding å®æˆ˜ï¼èŠ±äº†ä¸¤å¤©æ—¶é—´ï¼Œè®© AI å†™äº†ä¸€ä¸ªå¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“ï¼]]></title>    <link>https://juejin.cn/post/7571695634942394395</link>    <guid>https://juejin.cn/post/7571695634942394395</guid>    <pubDate>2025-11-12T15:58:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571695634942394395" data-draft-id="7571725550709440539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vibe Coding å®æˆ˜ï¼èŠ±äº†ä¸¤å¤©æ—¶é—´ï¼Œè®© AI å†™äº†ä¸€ä¸ªå¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“ï¼"/> <meta itemprop="keywords" content="Claude,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-11-12T15:58:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éä¸“ä¸šç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1968539883540688"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vibe Coding å®æˆ˜ï¼èŠ±äº†ä¸¤å¤©æ—¶é—´ï¼Œè®© AI å†™äº†ä¸€ä¸ªå¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1968539883540688/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éä¸“ä¸šç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T15:58:37.000Z" title="Wed Nov 12 2025 15:58:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å…ˆä¸Šæ•ˆæœå›¾</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/520d9c2c2023492aa95592613d76adde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=Ue4CRoIHL5IRXtWneBINOrbG4%2BQ%3D" alt="" loading="lazy"/></p>
<p>æœ€è¿‘åŠ¨æ‰‹å®è·µäº†ä¸‹ Vibe Codingï¼Œæƒ³å°è¯•â€‹<strong>ä¸€è¡Œä»£ç ä¸å†™ï¼Œçº¯é€šè¿‡ Prompt è®© AI å†™äº†ä¸€ä¸ªå¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“</strong>â€‹ã€‚</p>
<p>æ•´ä½“èŠ±äº†ä¸¤å¤©æ—¶é—´ä¸åˆ°ï¼Œæ•ˆæœå¦‚ä¸Šå›¾ï¼Œæ”¯æŒçš„ç‰¹æ€§æœ‰ï¼š</p>
<ul>
<li>ç±»ä¼¼å‰ç«¯çš„ Blockã€InlineBlockã€Inline å¸ƒå±€</li>
<li>æ–‡æœ¬æ ·å¼ï¼šåŠ ç²—ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€åˆ é™¤çº¿ï¼Œå‰æ™¯è‰²ï¼ŒèƒŒæ™¯è‰²ï¼ŒåŒä¸€è¡Œä¸åŒå­—ä½“å¤§å°æ··æ’ç­‰</li>
<li>Attachmentï¼šå›¾æ–‡æ··æ’æˆ–æ’å…¥è‡ªå®šä¹‰ View ç­‰</li>
<li>å¼‚æ­¥æ’ç‰ˆå’Œç®—é«˜ï¼šåŸºäº CoreText APIï¼Œæ”¯æŒå­çº¿ç¨‹å¸ƒå±€ç®—é«˜ï¼Œä¸»çº¿ç¨‹æ¸²æŸ“</li>
<li>å•æµ‹è¦†ç›–</li>
</ul>
<p>é¡¹ç›®ç”¨çš„ Claude AIï¼Œå·®ä¸å¤šè€—è´¹äº† 50$ï¼ˆæ˜¯çœŸçš„è´µï¼ä½†ä¹Ÿæ˜¯çœŸçš„å¼ºï¼ï¼‰ï¼Œæœ¬æ–‡å°†è®°å½•æ•´ä¸ªè¿‡ç¨‹å’Œä¸€äº›ç»éªŒæ€»ç»“ã€‚</p>
<h2 data-id="heading-1">äºŒã€è¿‡ç¨‹è®°å½•</h2>
<h2 data-id="heading-2">2.1 Claude å®‰è£…å’Œé¡¹ç›®åˆå§‹åŒ–</h2>
<p>Claude å®‰è£…å’Œä½¿ç”¨åœ¨ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œç»†èŠ‚è¿™é‡Œä¸å†èµ˜è¿°ï¼Œæ¨èç›´æ¥ä½¿ç”¨ VSCode çš„ Claude AI æ’ä»¶ï¼›åæ–‡ã€Œç»éªŒæ€»ç»“ã€éƒ¨åˆ†ä¹Ÿä¼šæ€»ç»“ Claude AI çš„å¸¸ç”¨å‘½ä»¤ï¼Œæ„Ÿå…´è¶£å¯ä»¥ç›´æ¥è·³è½¬ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªç©ºçš„ iOS é¡¹ç›®å’Œå¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“çš„ podï¼ˆè¿™é‡Œæˆ‘ä»¬å« RichViewï¼‰ï¼Œåˆ›å»ºå®Œæˆä¹‹ååœ¨ VSCode ä¸­æ‰“å¼€ï¼Œç‚¹å‡»å³ä¸Šè§’ Claude AI çš„å›¾æ ‡å¼€å¯ä¼šè¯ï¼Œè¾“å…¥<code>/init</code> å‘½ä»¤åˆå§‹åŒ–å·¥ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6e2f2e28efa451fbed4cc8476ecfd4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=C4lUbo%2B4R6urf2jPMwEtbAuepCE%3D" alt="" loading="lazy"/></p>
<p><strong><code>/init</code><strong>â€‹</strong>å‘½ä»¤çš„ä½œç”¨æ˜¯è®© Claude ç†è§£æ•´ä¸ªé¡¹ç›®ï¼Œè¿™æ˜¯åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Claude çš„ç¬¬ä¸€æ­¥ï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¬¡å°±å¥½ã€‚</strong></p>
<p><code>/init</code>ä¼šåœ¨æ ¹ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>CLAUDE.md</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç†è§£æˆâ€‹<strong>å…¨å±€ä¸Šä¸‹æ–‡</strong>â€‹ï¼Œå³æ¯æ¬¡æ–°å¼€ Claude ä¼šè¯éƒ½ä¼šè‡ªåŠ¨åŠ è½½å…¶ä¸­çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œè®°å½•ä¸€äº›å¦‚ä¿®æ”¹å†å²ã€å…¨å±€è¯´æ˜ç­‰å†…å®¹ã€‚</p>
<h2 data-id="heading-3">2.2 æŠ€æœ¯é€‰å‹ã€æ¶æ„</h2>
<p>è®© AI å†™ä»£ç ï¼Œå’Œæˆ‘ä»¬è‡ªå·±å†™ä»£ç åŸºæœ¬ç±»ä¼¼ï¼Œä¸è¿‡æ˜¯å°†æˆ‘ä»¬çš„æ€è·¯è½¬æ¢æˆ Prompt å‘Šè¯‰ AIã€‚</p>
<p>ç¼–ç ä¹‹å‰éœ€è¦å…ˆç¡®å®šå‡ ä»¶äº‹æƒ…ï¼šè¿™äº›ç¡®å®šå¥½ä¹‹åï¼Œæˆ‘ä»¬åç»­çš„ä»»åŠ¡æ‹†åˆ†æ‰ä¼šæ›´é¡ºåˆ©ã€‚</p>
<p><strong>1ï¼‰éœ€è¦æ”¯æŒå“ªäº› Feature</strong></p>
<ul>
<li>æ”¯æŒæ–‡æœ¬æ ·å¼ï¼šåŠ ç²—ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€åˆ é™¤çº¿ï¼Œå‰æ™¯è‰²ï¼ŒèƒŒæ™¯è‰²ï¼ŒåŒä¸€è¡Œä¸åŒå­—ä½“å¤§å°æ··æ’ç­‰</li>
<li>æ”¯æŒ Attachmentï¼šå›¾æ–‡æ··æ’æˆ–æ’å…¥è‡ªå®šä¹‰ View ç­‰</li>
<li>æ”¯æŒå­çº¿ç¨‹æ’ç‰ˆç®—é«˜</li>
<li>æ”¯æŒå•å…ƒæµ‹è¯•</li>
</ul>
<p><strong>2ï¼‰æŠ€æœ¯é€‰å‹</strong></p>
<p>è‡ªå®šä¹‰å¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“ï¼Œæœ€éš¾çš„ç‚¹åœ¨äºå¦‚ä½•å®ç°ç²¾ç¡®çš„æ–‡æœ¬åˆ†è¯æ’ç‰ˆï¼ˆåŸç†å¯ä»¥å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfcL6if52qYQUTChEjntHJg" target="_blank" title="https://mp.weixin.qq.com/s/fcL6if52qYQUTChEjntHJg" ref="nofollow noopener noreferrer">ä» 0 åˆ° 1 è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“ï¼šåŸç†ç¯‡</a>ï¼‰ï¼ŒiOS æœ‰å†…ç½®çš„ CoreText APIï¼ˆè§<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfQiB4sYtqdlSEbu8UhspIA" target="_blank" title="https://mp.weixin.qq.com/s/fQiB4sYtqdlSEbu8UhspIA" ref="nofollow noopener noreferrer">é“¾æ¥</a>ï¼‰ç”¨äºæ–‡æœ¬åˆ†è¯æ’ç‰ˆï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŸºäºå¼€æºçš„è·¨ç«¯æ’ç‰ˆå¼•æ“ HarfBuzzï¼ˆè§<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNxBfP4MJ0Y67trIVh39tag" target="_blank" title="https://mp.weixin.qq.com/s/NxBfP4MJ0Y67trIVh39tag" ref="nofollow noopener noreferrer">é“¾æ¥</a>ï¼‰è¿›è¡Œå¤„ç†ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œä¸éœ€è¦è·¨ç«¯ï¼Œå› æ­¤é€‰æ‹© CoreText ä½œä¸ºæ–¹æ¡ˆé€‰å‹ã€‚</p>
<p>å®˜æ–¹å°è£…çš„ NSAttributedString å½“ç„¶ä¹Ÿèƒ½åšè¿™ä»¶äº‹æƒ…ï¼Œä½†æ˜¯ä»å·¥ç¨‹å®è·µçœ‹ï¼ŒNSAttributedString åœ¨æ‰©å±•æ€§ï¼ˆæ¯”å¦‚æ”¯æŒåˆ—è¡¨ã€è¡¨æ ¼ç­‰è‡ªå®šä¹‰å¸ƒå±€ï¼‰ã€ä½¿ç”¨æ–¹ä¾¿æ€§ï¼Œä»¥åŠé•¿æ–‡æœ¬çš„æ€§èƒ½æ–¹é¢ä¸å°½å¦‚äººæ„ã€‚</p>
<p><strong>3ï¼‰æŠ€æœ¯æ¶æ„</strong></p>
<p>æ–‡æœ¬åˆ†è¯ä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡Œå¸ƒå±€æ’ç‰ˆï¼Œä¸ºæ–¹ä¾¿åç»­æ‹“å±•å¸ƒå±€ï¼Œæˆ‘ä»¬è¿™é‡Œå‚è€ƒå‰ç«¯çš„å¸ƒå±€æ¨¡å‹ï¼Œå¼•å…¥ Blockã€InlineBlockã€Inline çš„æ¦‚å¿µã€‚</p>
<p>åŒæ—¶å‚è€ƒæµè§ˆå™¨çš„å¸ƒå±€æ¸²æŸ“è¿‡ç¨‹ï¼Œå¼•å…¥ä¸‰æ£µæ ‘çš„æ¦‚å¿µï¼š</p>
<ul>
<li>ElementTreeï¼šç”¨æˆ·è¾“å…¥ï¼Œæ•´ä¸ªå¯Œæ–‡æœ¬å¯ä»¥é€šè¿‡ä¸€é¢— ElementTree æ¥è¡¨ç¤º</li>
<li>LayoutTreeï¼šè´Ÿè´£å¸ƒå±€æ’ç‰ˆï¼Œä¼šåœ¨è¿™ä¸€å±‚å¤„ç†å¥½æ–‡æœ¬çš„åˆ†è¯ã€å›¾æ–‡æ··æ’æ—¶å„è‡ªçš„ä½ç½®ç­‰</li>
<li>RenderTreeï¼šè´Ÿè´£æ¸²æŸ“ï¼Œè¿™ä¸€å±‚æ¥æ”¶å¸ƒå±€å®Œæˆçš„ç»“æœï¼Œè¿›è¡Œæœ€ç»ˆçš„ä¸Šå±ç»˜åˆ¶</li>
</ul>
<p>æ•²å®šæŠ€æœ¯é€‰å‹ã€æŠ€æœ¯æ¶æ„ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰æ€è·¯æ‹†åˆ†å­ä»»åŠ¡äº†ã€‚</p>
<h2 data-id="heading-4">2.3 å­ä»»åŠ¡ï¼šElementTree</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbd659f377ab4c9f9b2850a1a58962e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=drWJODgfv5a%2BcvD2%2Fiyc0GqiW7Q%3D" alt="" loading="lazy"/></p>
<p>ç”±äºæˆ‘ä»¬å‚è€ƒäº†å‰ç«¯çš„å¸ƒå±€æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å‘Šè¯‰ AI åœ¨ CSS ä¸­ Blockã€InlineBlockã€Inline çš„å¸ƒå±€è§„èŒƒï¼Œè¿™ä¸ªåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2FGuides%2FDisplay%2FBlock_and_inline_layout" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/CSS/Guides/Display/Block_and_inline_layout" ref="nofollow noopener noreferrer"> MDN </a>ä¸­å¯ä»¥ç›´æ¥æ‘˜å½•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è®© AI å¸®æˆ‘ä»¬ç”Ÿæˆï¼ˆå¦‚ä¸Šå›¾ï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf9f97ac2a8c4d5c9fd2d28a97400b1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=BMCsyI802gmOKHn%2BEZchExebbIg%3D" alt="" loading="lazy"/></p>
<p>æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ AI æ€ä¹ˆæ„å»º ElementTreeï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾æ‰€ç¤º Promptã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥è®© AI å‚ç…§ Promptï¼Œç”Ÿæˆ ElementTree äº†ã€‚</p>
<p>ElementTree ç”Ÿæˆå®Œæˆåï¼Œæˆ‘ä»¬å‘ç°é—æ¼äº†å•æµ‹ç¯èŠ‚ï¼Œç»§ç»­å®Œå–„ ElementTree çš„ Promptï¼Œç„¶åâ€‹<strong>æ˜ç¡®å‘Šè¯‰ AI xx æ–‡ä»¶æ–°å¢äº† xx ä»»åŠ¡</strong>â€‹ï¼Œè®© AI ç»§ç»­å®Œæˆä»»åŠ¡ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7d031cb1e8949ce8b93e97add008d19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=5I38q4kf7N4WFlMRvupmuA4wYKM%3D" alt="" loading="lazy"/></p>
<p>ElementTree çš„åˆ›å»ºè¿˜ç®—æ¯”è¾ƒé¡ºåˆ©ï¼ŒAI ç†è§£ä¹Ÿæ¯”è¾ƒåˆ°ä½ï¼Œç”Ÿæˆçš„ä»£ç åŸºæœ¬ç¬¦åˆé¢„æœŸã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/953fcaa194a646418f38f4772612a721~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=cz1gojje7CSIWaqmVOSPcT9lAUE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">2.4 å­ä»»åŠ¡ï¼šLayoutTree</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92810dfad40045f3913074c2f5c50508~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=Zx%2FgxFRPe8zOFdQkFVsTjwDoOk8%3D" alt="" loading="lazy"/></p>
<p>åŒæ ·ï¼Œæˆ‘ä»¬å®šä¹‰å¥½ Promptï¼Œè®© AI ç”Ÿæˆ LayoutTreeã€‚</p>
<p>LayoutTree çš„ç”Ÿæˆä¸å¤ªé¡ºåˆ©ï¼Œè€Œä¸”ä»æœ€åçš„æµ‹è¯•æ•ˆæœçœ‹ä¹Ÿæœ‰å¾ˆå¤š Bugï¼Œä¸»è¦å¦‚ä¸‹ï¼š</p>
<ul>
<li>AI å°†ç»˜åˆ¶ç›¸å…³é€»è¾‘ä¹ŸåŠ åˆ°äº† LayoutTree ä¸­ï¼Œä½†é¢„æœŸç»˜åˆ¶æ˜¯å•ç‹¬çš„ RenderTree</li>
<li>å¸ƒå±€é—®é¢˜ï¼šInlineBlock æ— æ³•æ•´ä½“æ¢è¡Œï¼Œå¤šä¸ª Inline åœ¨åŒä¸€è¡Œæ—¶è¢«æ¢è¡Œå±•ç¤ºï¼Œmarginã€padding ä¸ç”Ÿæ•ˆç­‰</li>
<li>å¯¹é½é—®é¢˜ï¼šåŒä¸€è¡ŒåŒ…å«ä¸åŒå­—å·çš„æ–‡æœ¬æ—¶ï¼Œå¯¹é½æ–¹å¼ä¸å¯¹</li>
<li>attachment æ— æ³•æ˜¾ç¤º</li>
<li>â€¦</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39d5d4ad1aa542f8a8b74ed6b03e8bf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=nWLC3qQPX%2Fnix1UOMJtQht%2FUKw4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">2.5 å­ä»»åŠ¡ï¼šRenderTree</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b588d169cbd344a7b174ece81dc036b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=o381XCic0zsKqCkKB%2FsJEYhms0g%3D" alt="" loading="lazy"/></p>
<p>ç”±äº LayoutTree è¿™ä¸ªåº•å±‚åŸºç¡€æ²¡æ‰å®ï¼ŒRenderTree çš„æ­å»ºä¹Ÿä¸é¡ºåˆ©ï¼ŒRenderTree çš„ Prompt å¦‚ä¸Šã€‚</p>
<h2 data-id="heading-7">2.6 BugFix</h2>
<p>è‡³æ­¤ï¼ŒAI ç”Ÿæˆäº†åˆç‰ˆçš„å¯Œæ–‡æœ¬æ¸²æŸ“å¼•æ“ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®© AI å†™ä¸ª Demo è¯•ç”¨ä¸€ä¸‹ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç°äº†å¾ˆå¤šä¸Šé¢ç½—åˆ—çš„ Bugï¼Œé’ˆå¯¹è¿™äº› Bugï¼Œä¹Ÿå¯ä»¥è®© AI æ¥ä¿®å¤ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/343d19cdcc904d76a022a9a20943ab75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=A6m2dPlUyMznZDhWISTjsShIIBE%3D" alt="" loading="lazy"/></p>
<p>åœ¨è®© AI ä¿® Bug è¿‡ç¨‹ä¸­ï¼Œä¹Ÿè¸©äº†ä¸€äº›å‘ï¼Œå‚è§ä¸‹æ–‡ç»éªŒæ€»ç»“ã€‚</p>
<h2 data-id="heading-8">ä¸‰ã€ä¸€äº›ç»éªŒæ€»ç»“</h2>
<h2 data-id="heading-9">3.1 Claude AI å¸¸ç”¨å‘½ä»¤</h2>
<ul>
<li><code>/init</code>ï¼šé¡¹ç›®åˆå§‹åŒ–ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨ Claude AI æ—¶æ‰§è¡Œï¼Œâ€‹<strong>æ¯ä¸ªé¡¹ç›®åªéœ€è¦æ‰§è¡Œä¸€æ¬¡å³å¯</strong>â€‹ï¼›ä¼šç”Ÿæˆä¸€ä¸ª<code>CLAUDE.md</code>æ–‡ä»¶ï¼Œè¿™æ˜¯â€‹<strong>é¡¹ç›®çš„å…¨å±€ä¸Šä¸‹æ–‡</strong>â€‹ï¼Œæ¯æ¬¡æ–°å»º Claude ä¼šè¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¯»å–å…¶ä¸­çš„å†…å®¹ï¼›å¯ä»¥åœ¨<code>CLAUDE.md</code>æ–‡ä»¶ä¸­è¡¥å……ä¿®æ”¹å†å²ã€å…¨å±€è¯´æ˜ç­‰</li>
<li><code>@</code>ï¼šå¯ä»¥è¾“å…¥<code>@</code>æ¥æ·»åŠ æ–‡ä»¶åˆ°ä¼šè¯çª—å£ï¼Œå°†æ–‡ä»¶ä½œä¸ºä¸Šä¸‹æ–‡ç»™ AI</li>
<li><code>/exit</code>ï¼šå…³é—­å½“å‰ä¼šè¯</li>
<li><code>/clear</code>ï¼šæ¸…é™¤å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ï¼Œå’Œé€€å‡ºä¼šè¯ç„¶åæ–°å¼€ä¸€ä¸ªä¼šè¯æ•ˆæœä¸€æ ·</li>
<li><code>/compact</code>ï¼šå‹ç¼©å’Œæ€»ç»“å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ï¼Œå’Œ<code>/clear</code>çš„åŒºåˆ«æ˜¯ï¼Œ<code>/compact</code>ä¼šå°†å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡æ€»ç»“åä½œä¸ºå½“å‰ä¼šè¯çš„æ–°ä¸Šä¸‹æ–‡ï¼Œ<code>/clear</code>ä¼šç›´æ¥æ¸…é™¤æ‰€æœ‰ä¸Šä¸‹æ–‡</li>
<li><code>/resume</code>ï¼šæ˜¾ç¤ºå’Œæ¢å¤å†å²ä¸Šä¸‹æ–‡</li>
<li>è‡ªå®šä¹‰ commandï¼šå¯ä»¥å°†é€šç”¨çš„ Prompt åšæˆè‡ªå®šä¹‰ commandï¼Œæ–‡ä»¶ä½ç½®åœ¨<code>.claude/commands/</code>ï¼›è¿˜å¯ä»¥é€šè¿‡ <code>$ARGUMENUTS</code> æ¥æ¥æ”¶è‡ªå®šä¹‰å‚æ•°</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5e4f70c3c0b42caa221de1cb0bf2032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=%2FvsfdGwhw8oGvs9ivfWvZ%2FSGnSs%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><code>/agents</code>ï¼šæœ‰çš„ä»»åŠ¡æ¯”è¾ƒå¤æ‚ï¼Œæˆ–ä¸Šä¸‹æ–‡è¾ƒå¤šï¼Œé‚£å¯ä»¥æ‹†åˆ†æˆå¤šä¸ª agents è¿›è¡Œç»„åˆï¼Œæ¯”å¦‚å†™ä¸šåŠ¡é€»è¾‘ -&gt; æ„å»ºå•å…ƒæµ‹è¯• -&gt; CI/CD ç­‰ï¼Œå¯ä»¥æ‹†åˆ†å¤šä¸ª agents ç»„åˆä½¿ç”¨</p>
</li>
<li>
<p>ä¼šè¯æ¨¡å¼ï¼šåœ¨æœ€æ–°ç‰ˆæœ¬çš„ Claude AI æ’ä»¶ä¸­ï¼Œé™¤äº†ä¹‹å‰å‘½ä»¤è¡Œé£æ ¼çš„ GUI ä»¥å¤–ï¼Œè¿˜æä¾›äº†ä¼šè¯æ¡†é£æ ¼çš„ GUIï¼Œåˆ‡æ¢ä¼šè¯æ¨¡å¼ï¼ŒæŸ¥çœ‹å†å²ä¼šè¯ç­‰ä¼šæ›´æ–¹ä¾¿ï¼›å¦‚ä¸‹ï¼Œä¼šè¯æ¨¡å¼å¯ä»¥åœ¨è¾“å…¥æ¡†å·¦ä¸‹è§’åˆ‡æ¢</p>
</li>
<li>
<ul>
<li>Edit automaticallyï¼šAI æ ¹æ®è¾“å…¥ Prompt è¿›è¡Œç†è§£å¹¶ç›´æ¥ç¼–è¾‘æ–‡ä»¶ï¼Œä¸€èˆ¬ä½¿ç”¨è¯¥æ¨¡å¼å³å¯</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa3f8eea9b364d41a119159a316cb12f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=8AIVFCT%2BakGCI5Rp1w1DwQ0isfw%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<ul>
<li>Plan modeï¼šAI æ ¹æ®è¾“å…¥ Prompt åˆ—å‡ºä¿®æ”¹è®¡åˆ’ï¼Œä½ å¯ä»¥è¿›ä¸€æ­¥æ ¡éªŒå’Œä¿®æ”¹ Plan</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edccef995e484d3da5629c1a054a025a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=DhaJOjtHdBTLI6ssR8pdyhW2GN8%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<ul>
<li>Ask before editsï¼šAI ä¿®æ”¹æ–‡ä»¶å‰è¯¢é—®</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/283093f7ef1d4001be269832fbaac12d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=7L8MljGnrzrIJLTZZx9%2BrYR6MeE%3D" alt="" loading="lazy"/></p>
<ul>
<li>MCPï¼šå¸¸ç”¨çš„ MCP æ˜¯<code>context7</code>ï¼Œ<code>context7</code>æ˜¯ç”¨äºå¸®åŠ© AI æŸ¥æ‰¾æœ€æ–°æ–‡æ¡£çš„ï¼Œé¿å…ä½¿ç”¨è¿‡æ—¶ API</li>
</ul>
<h2 data-id="heading-10">3.2 ç»éªŒæ€»ç»“</h2>
<p>ä¸å¾—ä¸æ„Ÿå¹ï¼ŒAI ç¼–ç¨‹å®åœ¨å¤ªå¼ºå¤§äº†ï¼Œç›¸ä¿¡åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œä¸€ä¸ªåªä¼šå†™ Prompt çš„éä¸“ä¸šç¨‹åºå‘˜ï¼Œä¹Ÿèƒ½å®Œæ•´äº¤ä»˜ä¸€ä¸ª App äº†ã€‚</p>
<p>è®© AI ç¼–ç¨‹ï¼Œå¹¶ä¸æ˜¯è¯´ç»™ä¸€å¥è¯å°±èƒ½è®© AI å®Œæˆä»£ç ï¼Œå„ç§ç»†èŠ‚è¿˜æ˜¯éœ€è¦äººæ¥æå‰æƒ³æ¸…æ¥šï¼Œæ¯•ç«Ÿæœ€ç»ˆç»´æŠ¤ä»£ç å’Œè§£å†³é—®é¢˜çš„è¿˜æ˜¯æˆ‘ä»¬è‡ªå·±ï¼ŒAI åªæ˜¯å¸®æˆ‘ä»¬<strong>ææ•ˆå’Œæ‰©å±•æ€è·¯</strong>çš„å·¥å…·ï¼›æœ‰å¥è¯æ€»ç»“çš„è›®å¥½ï¼šä½ å¯ä»¥å°† AI è§†ä¸ºä¸€ä¸ªéå¸¸èªæ˜ï¼Œç”šè‡³èµ„æ·±ï¼Œä½†æ˜¯æ²¡æœ‰ä¸šåŠ¡ç»éªŒçš„ç¨‹åºå‘˜ã€‚</p>
<p>ä¸‹é¢æˆ‘æƒ³æ€»ç»“ä¸‹æœ€è¿‘å®æˆ˜çš„ä¸€äº›ç»éªŒï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ï¼š</p>
<p><strong>1ï¼‰æ¶æ„è®¾è®¡éœ€è¦æå‰è§„åˆ’å¥½ï¼Œå°½é‡æƒ³æ¸…æ¥šç»†èŠ‚</strong></p>
<p>è°‹å®šè€ŒååŠ¨ï¼Œä¸ç®¡æ˜¯æˆ‘ä»¬è‡ªå·±å†™ä»£ç ï¼Œè¿˜æ˜¯è®© AI å†™ä»£ç ï¼Œæˆ‘è§‰å¾—æå‰æƒ³å¥½è¦åšä»€ä¹ˆï¼Œæ€ä¹ˆåšæ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>æ¶æ„è®¾è®¡å¥½äº†ï¼Œç»†èŠ‚æƒ³æ¸…æ¥šäº†ï¼Œé‚£æ€ä¹ˆæ‹†åˆ†å­ä»»åŠ¡ï¼Œå…¶å®ä¹Ÿå°±æ˜ç¡®äº†ã€‚</p>
<p><strong>2ï¼‰ä»»åŠ¡æ‹†åˆ†è¶Šå°è¶Šå¥½ï¼Œä¸Šä¸‹æ–‡è¶Šæ˜ç¡®è¶Šå¥½</strong></p>
<p>AI æœ€é€‚åˆåšæœ‰æ˜ç¡®è¾“å…¥è¾“å‡ºçš„äº‹æƒ…ï¼Œç»™çš„ä¸Šä¸‹æ–‡è¶Šæ˜ç¡®ï¼ŒAI äº§ç”Ÿå¹»è§‰çš„æ¦‚ç‡è¶Šä½ï¼Œè¾“å‡ºç»“æœä¹Ÿä¼šè¶Šå‡†ç¡®ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæ˜¯è¾“å…¥è¾“å‡ºæ˜ç¡®çš„ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥è®© AI å…ˆè¾“å‡ºæµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ç”¨ä¾‹äººå·¥æ£€æµ‹å®Œå¤‡ä¹‹åï¼Œå†è®© AI ç¼–ç ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘/TDDï¼‰ã€‚</p>
<p><strong>3ï¼‰æ¯ä¸€é¡¹ç›®ä»»åŠ¡åšå¥½ä¹‹åå†è¿›è¡Œä¸‹ä¸€é¡¹ä»»åŠ¡</strong></p>
<p>åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ï¼</p>
<p>æ¨èæ‰“ç£¨å¥½æ¯ä¸€é¡¹å­ä»»åŠ¡å†ç»§ç»­ä¸‹ä¸€é¡¹ä»»åŠ¡ï¼Œå¦åˆ™åƒé‡Œä¹‹å ¤æ¯äºèšç©´ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½ç•™ä¸€ç‚¹å‘ï¼Œæœ€ç»ˆå¯èƒ½å¸¦æ¥ç¾éš¾æ€§çš„ç»“æœï¼</p>
<p>å¦å¤–ï¼Œâ€‹<strong>å•æµ‹æ˜¯ä¸ªå¥½ä¸œè¥¿</strong>â€‹ï¼Œå¯¹æ¯é¡¹ä»»åŠ¡è¡¥é½å•æµ‹ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢åç»­ AI æ”¹å‡ºé—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4a64db6938248e5b313b171bb50e5d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=whw7TRt%2BIfIVobCVwtBGbluOiAk%3D" alt="" loading="lazy"/></p>
<p><strong>4ï¼‰å–„ç”¨ Gitï¼Œé˜²æ­¢ä»£ç æ±¡æŸ“</strong></p>
<p>Claude åœ¨ Edit automatically æ¨¡å¼ä¸‹ä¼šç›´æ¥ä¿®æ”¹æ–‡ä»¶ï¼Œä¸ºäº†é˜²æ­¢æ±¡æŸ“å…¶ä»–ä»£ç ï¼Œæ¯æ¬¡è®© AI ä¿®æ”¹å‰å°½é‡ä¿è¯å·¥ä½œåŒºå¹²å‡€ï¼Œè¿™æ ·ä¹Ÿèƒ½æ–¹ä¾¿æˆ‘ä»¬ Review ä»£ç ã€‚</p>
<p><strong>5ï¼‰å†™ Prompt å°½é‡ç”¨æ˜ç¡®çš„è¯æ±‡ï¼Œä¸è¦è¡¨æ„ä¸æ¸…</strong></p>
<p>æ¯”å¦‚åœ¨æ„å»º ElementTree æ—¶ï¼Œæˆ‘ä¼šæ˜ç¡®å‘Šè¯‰ AI è¦æ”¯æŒå“ªäº› Styleï¼Œå¯ä»¥æœ‰æ•ˆé¿å… AI è‡†æµ‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b33f7e09eb3c4519a868e829d0284c65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=Ny01xR%2F%2Bdzs4EDf6kOsdWTUyVkI%3D" alt="" loading="lazy"/></p>
<p>ä¸ä¹‹ç›¸åçš„åä¾‹æ˜¯ï¼Œåœ¨æ„å»º LayoutTree æ—¶ï¼Œé™å®šä¸è¶³ï¼Œå¯¼è‡´ AI è‡ªç”±å‘æŒ¥ï¼Œæœ€ç»ˆå®ç°å‡ºå¾ˆå¤š Bugã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27596abffd0e4051b3a8fa31044a6747~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=m3rTFDpOgS8CFo7JI4o0Qlyp%2B%2BM%3D" alt="" loading="lazy"/></p>
<p><strong>6ï¼‰å–„ç”¨æç¤ºè¯ï¼šthink &lt; think hard &lt; think harder &lt; ultrathink</strong></p>
<p>å¯ä»¥åœ¨ Prompt ä¸­è¿½åŠ  think hard / think harder ç­‰è¯æ±‡ï¼Œæ¥è®© AI è¿›å…¥â€‹<strong>æ·±åº¦æ€è€ƒ</strong>â€‹ï¼Œè¿™å¹¶ä¸æ˜¯ä»€ä¹ˆé»‘é­”æ³•ï¼Œè€Œæ˜¯ Claude AI å®˜æ–¹è®¤è¯çš„ï¼Œå‚è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fclaude-code-best-practices" target="_blank" title="https://www.anthropic.com/engineering/claude-code-best-practices" ref="nofollow noopener noreferrer">www.anthropic.com/engineeringâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b75eebc1e18e4de98a0ff568b298ea45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=qqh1dhpbg5jy7PKuIBYrLyZIKt0%3D" alt="" loading="lazy"/></p>
<p>å®è·µä¸‹æ¥ï¼Œç¡®å®è¿˜æ˜¯æœ‰æ•ˆæœçš„ï¼Œå¦‚ä¸‹æ˜¯è®© AI ä¿®å¤æ–‡æœ¬å¯¹é½é—®é¢˜ï¼ŒåŠ äº† think hard AI ä¼šæ›´æ·±å…¥ç†è§£ä»£ç ï¼Œæ‰¾åˆ°é—®é¢˜åŸå› ï¼›å½“ç„¶ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæœ‰å¼Šç«¯ï¼Œå°±æ˜¯ä¼šè€—è´¹æ›´å¤šçš„ tokenï¼ˆmoneyï¼‰ğŸ‘º</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a5d6e88778941a287d6e4f9fcd765eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=Vc1%2BQ8XH%2Bc1vZBPW7QBM%2FjsSzNg%3D" alt="" loading="lazy"/></p>
<p>â€‹<strong>7ï¼‰å–„ç”¨</strong>â€‹ <strong><code>/compact</code><strong>â€‹â€‹</strong>â€‹ â€‹</strong>â€‹ <strong><code>/clear</code><strong>â€‹</strong>å‘½ä»¤ï¼Œå‡å°‘æ¨¡å‹å¹»è§‰</strong></p>
<p>å¦‚æœä¸ä¸»åŠ¨æ¸…é™¤ï¼ŒClaude AI ä¼šè¯ä¸­çš„ä¸Šä¸‹æ–‡æ˜¯ä¼šä¸€ç›´ä¿å­˜çš„ï¼Œå½“ä¸€ä¸ªä¼šè¯ä¸­é—®ç­”è½®æ¬¡è¿‡å¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´ AI ç†è§£ä¸å‡†ç¡®ï¼ˆå¹»è§‰ï¼‰ã€‚</p>
<p>å¯ä»¥é€šè¿‡<code>/compact</code> æˆ–<code>/clear</code>å‘½ä»¤ï¼Œæ¥å‹ç¼©/æ¸…é™¤ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä¸€èˆ¬æˆ‘åœ¨ä¿®å¤æœ‰å…³è”æ€§çš„ Bug æ—¶ï¼Œä¼šä½¿ç”¨<code>/compact</code>å‘½ä»¤ï¼Œè¿™æ · AI å°±ä¸éœ€è¦é‡æ–°ç†è§£å·¥ç¨‹ï¼Œç†è§£ Bug äº†ï¼Œå¯ä»¥æé«˜æ•ˆç‡ã€‚</p>
<p><strong>8ï¼‰BugFix å°½é‡æ„é€ æœ€å°å¯å¤ç° Demo</strong></p>
<p>BugFix å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªå­ä»»åŠ¡ï¼Œæœ€å°å¯å¤ç° Demo å‡å°‘ AI çš„ç†è§£è´Ÿæ‹…ã€‚</p>
<p><strong>9ï¼‰åŠæ—¶äººå·¥ä»‹å…¥ï¼Œé¿å…åœ¨ä¸€ä¸ªé—®é¢˜ä¸Šæ­»ç£•</strong></p>
<p>æœ‰æ—¶å€™è®© AI ä¿®å¤ Bug æ—¶ï¼Œå¯èƒ½åå¤ä¿®æ”¹éƒ½è§£å†³ä¸äº†ï¼Œè¿™æ—¶å€™å¤§æ¦‚ç‡æ˜¯ AI æ²¡æœ‰çœŸæ­£ç†è§£é—®é¢˜ï¼Œæˆ–è€…å°±æ˜¯è¾“å…¥çš„ Prompt æœ‰é—®é¢˜ï¼Œè¿™ç§æƒ…å†µä¸‹å°±æ²¡å¿…è¦è®© AI æ­»ç£•é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¯ä»¥åŠæ—¶äººå·¥ä»‹å…¥ï¼Œé¿å…æµªè´¹æ—¶é—´ã€‚</p>
<p><strong>10ï¼‰å–„ç”¨ Plan æ¨¡å¼</strong></p>
<p>åœ¨ä»»åŠ¡æ‹†åˆ†æ—¶ï¼Œæˆ‘ä»¬è‡ªå·±å¯èƒ½ä¹Ÿæ²¡æƒ³æ˜ç™½åº”è¯¥æ€ä¹ˆåšï¼Œé‚£å¯ä»¥åˆ‡æ¢åˆ° Plan æ¨¡å¼ï¼Œè®© AI å’Œæˆ‘ä»¬ä¸€èµ·æ‹†ä»»åŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e358edcca7a247efbef6bcb0bbb55c4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2e5LiT5Lia56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763567916&amp;x-signature=KfXAhLqmFtg9DTncfLV622jGg%2FA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-11">3.3 Vibe Coding çš„ä¸€äº›å¼Šç«¯</h2>
<p><strong>1ï¼‰ä»˜è´¹ï¼Œè€Œä¸”è¿˜æŒºè´µï¼</strong></p>
<p>è¿™æ˜¯ä¸€ä¸ªæŒºç°å®çš„é—®é¢˜ï¼Œä¸€äº›å¥½çš„æ¨¡å‹éƒ½æŒºè´µï¼Œè€Œä¸”è¿˜æ˜¯æ¶ˆè€—çš„åˆ€ä¹ï¼Œå›½å†…å‚å•†çš„æ¨¡å‹è´¨é‡åˆä¸å°½å¦‚äººæ„ã€‚</p>
<p><strong>2ï¼‰ç¼–ç é£æ ¼é—®é¢˜ &amp; æ‰©å±•æ€§ã€æ˜“ç”¨æ€§ã€é²æ£’æ€§ä¸è¶³</strong></p>
<p>AI å†™çš„ä»£ç è¿˜æ˜¯æŒºå®¹æ˜“çœ‹å‡ºæ¥çš„ï¼Œæ„Ÿè§‰å¾ˆéš¾å¸¦æœ‰ç¨‹åºå‘˜çš„ä¸ªäººé£æ ¼ï¼Œä¸€ä¸ªæ˜æ˜¾çš„è¡¨ç°æ˜¯ä¼šç”¨ä¸€äº›æ¯”è¾ƒå°‘è§çš„ APIï¼Œè™½ç„¶ï¼Œè¿™å¯èƒ½ä¹Ÿæ˜¯ AI çš„å‰å®³ä¹‹å¤„ã€‚</p>
<p>å¦å¤–ï¼ŒAI åœ¨ä¸€äº›å‡½æ•°å¤ç”¨æ€§ã€æ‰©å±•æ€§ã€ä½¿ç”¨æ–¹ä¾¿æ€§ä¸Šæœ‰æ—¶å€™å·®å¼ºäººæ„ï¼Œæ¯”å¦‚ AI ç”Ÿæˆä»£ç å¦‚ä¸‹ï¼šå¦‚æœè¦é…ç½® Element çš„ Styleï¼Œéœ€è¦ä¸æ–­çš„è°ƒç”¨<code>text.style.xxx</code>ï¼Œä½†å…¶å®å†™æˆé“¾å¼è°ƒç”¨ä½¿ç”¨èµ·æ¥ä¼šæ›´èˆ’æœï¼Œå¦‚ä¸‹æ³¨é‡Šéƒ¨åˆ†</p>
<pre><code class="hljs language-scss" lang="scss">let text = <span class="hljs-built_in">TextElement</span>(text: "ä¸€ã€æ™¨å…‰åˆç…§")
text<span class="hljs-selector-class">.style</span><span class="hljs-selector-class">.color</span> = <span class="hljs-selector-class">.red</span>
text<span class="hljs-selector-class">.style</span><span class="hljs-selector-class">.font</span> = UIFont<span class="hljs-selector-class">.systemFont</span>(ofSize: <span class="hljs-number">17</span>)

<span class="hljs-comment">// æ›´å¥½çš„å†™æ³•</span>
<span class="hljs-comment">// text.style.setColor(xxx).setFont(xxx)</span>
</code></pre>
<p>é²æ£’æ€§æ–¹é¢ï¼ŒAI ä¸ä¼šä¸»åŠ¨è€ƒè™‘è°ƒç”¨åœºæ™¯ï¼Œæ¯”å¦‚æˆ‘è™½ç„¶å‘Šè¯‰äº† AI æˆ‘è¦æ”¯æŒå­çº¿ç¨‹å¸ƒå±€ï¼Œä½†æ˜¯ AI ç”Ÿæˆçš„ä»£ç å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<p>å½“ç„¶ï¼Œä¸Šè¿°è¿™äº›ï¼Œå¯ä»¥é€šè¿‡å®Œå–„ Prompt æ¥éƒ¨åˆ†å¼¥è¡¥ã€‚</p>
<p><strong>3ï¼‰é—®é¢˜å®šä½å¹»è§‰</strong></p>
<p>æœ‰æ—¶å€™è®© AI æ’æŸ¥ä¸€äº› Bugï¼Œå®ƒæ— æ³•æ‰¾åˆ°çœŸæ­£çš„åŸå› ï¼Œåå¤ä¿®æ”¹åè¿˜æ˜¯æœ‰é—®é¢˜ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦äººå·¥ä»‹å…¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä½é—®é¢˜ï¼Œå†å‘Šè¯‰ AI æ€ä¹ˆä¿®æ”¹ï¼Œè€Œä¸è¦è®© AI æ­»ç£•é—®é¢˜ï¼Œé¿å…æµªè´¹æ—¶é—´ã€‚</p>
<h2 data-id="heading-12">å››ã€è´´ä¸‹æºç  &amp; Prompt</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FHusterYP%2FRichView%2Ftree%2Fmain" target="_blank" title="https://github.com/HusterYP/RichView/tree/main" ref="nofollow noopener noreferrer">github.com/HusterYP/Riâ€¦</a></p>
<blockquote>
<p>å†…å®¹é¦–å‘åœ¨å…¬ä¼—å·ã€Œéä¸“ä¸šç¨‹åºå‘˜Pingã€ï¼Œè§‰å¾—æœ‰ç”¨çš„è¯ï¼Œä¸‰è¿å†èµ°å§ï½ (âËƒá´—Ë‚â)<br/>
å¯Œæ–‡æœ¬ç›¸å…³ï¼Œä½ å¯èƒ½æ„Ÿå…´è¶£ï¼š</p>
</blockquote>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FEYPO3sSjtIstD3RmlRCs9w" target="_blank" title="https://mp.weixin.qq.com/s/EYPO3sSjtIstD3RmlRCs9w" ref="nofollow noopener noreferrer">ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ä¸ç¼–ç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F96YJGYKLoxENC4qT9tYNoQ" target="_blank" title="https://mp.weixin.qq.com/s/96YJGYKLoxENC4qT9tYNoQ" ref="nofollow noopener noreferrer">ä¸€æ–‡è¯»æ‡‚å­—ç¬¦ã€å­—å½¢ã€å­—ä½“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FD0A8HAQaQNart7KAdWXyJg" target="_blank" title="https://mp.weixin.qq.com/s/D0A8HAQaQNart7KAdWXyJg" ref="nofollow noopener noreferrer">ä¸€æ–‡è¯»æ‡‚å­—ä½“æ–‡ä»¶</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfcL6if52qYQUTChEjntHJg" target="_blank" title="https://mp.weixin.qq.com/s/fcL6if52qYQUTChEjntHJg" ref="nofollow noopener noreferrer">ä»0åˆ°1è‡ªå®šä¹‰æ–‡å­—æ’ç‰ˆå¼•æ“ï¼šåŸç†ç¯‡</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FEpaNjLcG6DZBc128A2gdIQ" target="_blank" title="https://mp.weixin.qq.com/s/EpaNjLcG6DZBc128A2gdIQ" ref="nofollow noopener noreferrer">é€†å‘åˆ†æCoreTextä¸­çš„å­—ä½“çº§è”/Font Fallbackæœºåˆ¶</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F1oOSJkTIJ8njV49B6PsfgA" target="_blank" title="https://mp.weixin.qq.com/s/1oOSJkTIJ8njV49B6PsfgA" ref="nofollow noopener noreferrer">æ–°æ‰‹å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„LLDBæŠ€å·§/é€†å‘æŠ€å·§</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fo0Uv0b4MpXJA5Pa_tuM_IQ" target="_blank" title="https://mp.weixin.qq.com/s/o0Uv0b4MpXJA5Pa_tuM_IQ" ref="nofollow noopener noreferrer">HarfBuzzæ¦‚è§ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqaEfPkmFYRgbOJXqctJPDg" target="_blank" title="https://mp.weixin.qq.com/s/qaEfPkmFYRgbOJXqctJPDg" ref="nofollow noopener noreferrer">HarfBuzzæ ¸å¿ƒæ¦‚å¿µ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNxBfP4MJ0Y67trIVh39tag" target="_blank" title="https://mp.weixin.qq.com/s/NxBfP4MJ0Y67trIVh39tag" ref="nofollow noopener noreferrer">HarfBuzzå®æˆ˜ï¼šäº”å¤§æ ¸å¿ƒAPIå®ä¾‹è¯¦è§£ã€é™„iOS/Swiftç¤ºä¾‹ã€‘</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§© Argon2 å¯†ç å“ˆå¸Œ]]></title>    <link>https://juejin.cn/post/7571747061385691155</link>    <guid>https://juejin.cn/post/7571747061385691155</guid>    <pubDate>2025-11-13T03:02:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571747061385691155" data-draft-id="7571729676344197183" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§© Argon2 å¯†ç å“ˆå¸Œ"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-13T03:02:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€èµ·å…»æ¡é±¼å§"/> <meta itemprop="url" content="https://juejin.cn/user/2515334721186663"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§© Argon2 å¯†ç å“ˆå¸Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2515334721186663/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€èµ·å…»æ¡é±¼å§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:02:43.000Z" title="Thu Nov 13 2025 03:02:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“˜ æ¦‚è¿°</h2>
<p><code>argon2</code> æ˜¯ä¸€ç§<strong>ç°ä»£ã€å®‰å…¨çš„å¯†ç å“ˆå¸Œç®—æ³•</strong>ï¼Œç”¨äºå®‰å…¨å­˜å‚¨ç”¨æˆ·å¯†ç æˆ–å…¶ä»–æ•æ„Ÿè®¤è¯ä¿¡æ¯ã€‚
å®ƒä¸æ˜¯åŠ å¯†ï¼ˆencryptionï¼‰ï¼Œè€Œæ˜¯<strong>å•å‘å“ˆå¸Œï¼ˆhashingï¼‰</strong> â€”â€” æ— æ³•è§£å¯†ã€‚</p>
<p>Argon2 æ˜¯ 2015 å¹´å¯†ç å“ˆå¸Œç«èµ›ï¼ˆPHCï¼‰çš„è·èƒœç®—æ³•ï¼Œç›®å‰å…¬è®¤ä¸ºä¸šç•Œæœ€å®‰å…¨ã€æœ€å…ˆè¿›çš„å“ˆå¸Œæ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ§  æ ¸å¿ƒæ€æƒ³</h2>

























<table><thead><tr><th>æ¦‚å¿µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å“ˆå¸Œï¼ˆHashï¼‰</td><td>å°†æ˜æ–‡å¯†ç è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ï¼ˆä¸å¯é€†ï¼‰</td></tr><tr><td>åŠ ç›ï¼ˆSaltï¼‰</td><td>åœ¨å“ˆå¸Œå‰åŠ å…¥éšæœºæ•°æ®ï¼Œä½¿æ¯ä¸ªç»“æœå”¯ä¸€</td></tr><tr><td>éªŒè¯ï¼ˆVerifyï¼‰</td><td>ç”¨è¾“å…¥å¯†ç é‡æ–°è®¡ç®—å“ˆå¸Œå¹¶æ¯”å¯¹æ˜¯å¦ä¸€è‡´</td></tr><tr><td>ä¸å¯é€†</td><td>æ— æ³•â€œè§£å¯†â€å¾—åˆ°åŸå§‹å¯†ç </td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ğŸ§° Node.js ç¤ºä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> argon2 <span class="hljs-keyword">from</span> <span class="hljs-string">"argon2"</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> password = <span class="hljs-string">"123456"</span>;

  <span class="hljs-comment">// 1ï¸âƒ£ ç”Ÿæˆå“ˆå¸Œ</span>
  <span class="hljs-keyword">const</span> hash = <span class="hljs-keyword">await</span> argon2.<span class="hljs-title function_">hash</span>(password);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å“ˆå¸Œç»“æœï¼š"</span>, hash);
  <span class="hljs-comment">// ç¤ºä¾‹è¾“å‡º: $argon2id$v=19$m=65536,t=3,p=4$YWFh...ZGRk</span>

  <span class="hljs-comment">// 2ï¸âƒ£ éªŒè¯å¯†ç </span>
  <span class="hljs-keyword">const</span> isValid = <span class="hljs-keyword">await</span> argon2.<span class="hljs-title function_">verify</span>(hash, <span class="hljs-string">"123456"</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"éªŒè¯ç»“æœï¼š"</span>, isValid); <span class="hljs-comment">// true</span>

  <span class="hljs-comment">// 3ï¸âƒ£ é”™è¯¯ç¤ºä¾‹</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> argon2.<span class="hljs-title function_">verify</span>(hash, <span class="hljs-string">"wrong"</span>)); <span class="hljs-comment">// false</span>
}

<span class="hljs-title function_">example</span>();
</code></pre>
<hr/>
<h2 data-id="heading-3">ğŸ§© Python ç­‰ä»·å®ç°ï¼ˆargon2-cffiï¼‰</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> argon2 <span class="hljs-keyword">import</span> PasswordHasher

ph = PasswordHasher()
<span class="hljs-built_in">hash</span> = ph.<span class="hljs-built_in">hash</span>(<span class="hljs-string">"123456"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hash</span>)

<span class="hljs-comment"># éªŒè¯å¯†ç </span>
ph.verify(<span class="hljs-built_in">hash</span>, <span class="hljs-string">"123456"</span>)  <span class="hljs-comment"># âœ… æ­£ç¡®</span>
</code></pre>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install argon2-cffi
</code></pre>
<hr/>
<h2 data-id="heading-4">ğŸ§© è‡ªåŠ¨åŠ ç›æœºåˆ¶ï¼ˆSaltï¼‰</h2>
<p>Argon2 åœ¨ç”Ÿæˆå“ˆå¸Œæ—¶ä¼š<strong>è‡ªåŠ¨åŠ å…¥éšæœºç›ï¼ˆsaltï¼‰</strong>ã€‚
æ¯æ¬¡è°ƒç”¨ <code>argon2.hash()</code>ï¼Œå³ä½¿è¾“å…¥çš„å¯†ç ç›¸åŒï¼Œç”Ÿæˆçš„å“ˆå¸Œä¹Ÿä¸åŒã€‚</p>
<p>ä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> hash1 = <span class="hljs-keyword">await</span> argon2.<span class="hljs-title function_">hash</span>(<span class="hljs-string">"123456"</span>);
<span class="hljs-keyword">const</span> hash2 = <span class="hljs-keyword">await</span> argon2.<span class="hljs-title function_">hash</span>(<span class="hljs-string">"123456"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hash1);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hash2);
</code></pre>
<p>è¾“å‡ºï¼ˆæ³¨æ„ä¸åŒï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">$argon2id$<span class="hljs-attr">v</span>=<span class="hljs-number">19</span><span class="hljs-variable">$m</span>=<span class="hljs-number">65536</span>,t=<span class="hljs-number">3</span>,p=<span class="hljs-number">4</span><span class="hljs-variable">$4tYpH</span>...<span class="hljs-variable">$1mSw</span>...
$argon2id$<span class="hljs-attr">v</span>=<span class="hljs-number">19</span><span class="hljs-variable">$m</span>=<span class="hljs-number">65536</span>,t=<span class="hljs-number">3</span>,p=<span class="hljs-number">4</span><span class="hljs-variable">$kqC6z</span>...<span class="hljs-variable">$TnsA</span>...
</code></pre>
<p>âœ… <strong>åŸå› </strong>ï¼šæ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ªéšæœºç›ã€‚
ç›ä¼šè‡ªåŠ¨åŒ…å«åœ¨å“ˆå¸Œå­—ç¬¦ä¸²ä¸­ï¼Œæ— éœ€æ‰‹åŠ¨ä¿å­˜æˆ–ç®¡ç†ã€‚</p>
<hr/>
<h3 data-id="heading-5">éªŒè¯æ—¶çš„å·¥ä½œåŸç†</h3>
<p><code>argon2.verify(stored_hash, input_password)</code> ä¼šè‡ªåŠ¨ï¼š</p>
<ol>
<li>ä»å“ˆå¸Œå­—ç¬¦ä¸²ä¸­è§£æç›å’Œç®—æ³•å‚æ•°ï¼›</li>
<li>ç”¨è¾“å…¥å¯†ç å’Œè§£æå‡ºçš„ç›é‡æ–°è®¡ç®—å“ˆå¸Œï¼›</li>
<li>æ¯”å¯¹ç»“æœæ˜¯å¦ä¸€è‡´ã€‚</li>
</ol>
<p>ğŸ‘‰ æ‰€ä»¥åªè¦ä¿å­˜è¿™ä¸€æ•´ä¸²å“ˆå¸Œå­—ç¬¦ä¸²ï¼Œå°±è¶³å¤ŸéªŒè¯å¯†ç ï¼Œæ— éœ€é¢å¤–å­˜ç›ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸ”’ å“ˆå¸Œç»“æœç»“æ„è§£æ</h2>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-variable">$argon</span>2id<span class="hljs-variable">$v</span>=<span class="hljs-number">19</span><span class="hljs-variable">$m</span>=<span class="hljs-number">65536</span>,t=<span class="hljs-number">3</span>,p=<span class="hljs-number">4</span><span class="hljs-variable">$&lt;</span>salt&gt;<span class="hljs-variable">$&lt;</span>hash&gt;
</code></pre>





































<table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>argon2id</td><td>ä½¿ç”¨çš„ Argon2 ç±»å‹ï¼ˆæ¨èï¼‰</td></tr><tr><td>v=19</td><td>ç®—æ³•ç‰ˆæœ¬</td></tr><tr><td>m=65536</td><td>å†…å­˜æˆæœ¬ï¼ˆè¶Šå¤§è¶Šå®‰å…¨ï¼‰</td></tr><tr><td>t=3</td><td>è¿­ä»£æ¬¡æ•°</td></tr><tr><td>p=4</td><td>å¹¶è¡Œåº¦</td></tr><tr><td>salt</td><td>éšæœºç›</td></tr><tr><td>hash</td><td>å“ˆå¸Œç»“æœ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">âš ï¸ é‡è¦ç‰¹æ€§</h2>





























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>è‡ªåŠ¨åŠ ç›</td><td>âœ… å†…ç½®éšæœºç›ï¼Œæ¯æ¬¡ä¸åŒ</td></tr><tr><td>ä¸å¯é€†</td><td>âŒ ä¸èƒ½è§£å¯†è¿˜åŸåŸæ–‡</td></tr><tr><td>å¯éªŒè¯</td><td>âœ… å¯ç”¨ <code>verify()</code> æ£€æŸ¥å¯†ç æ˜¯å¦åŒ¹é…</td></tr><tr><td>æŠ—æš´åŠ›ç ´è§£</td><td>âœ… éœ€è¦å¤§é‡å†…å­˜å’Œ CPU æ—¶é—´</td></tr><tr><td>å¯é…ç½®</td><td>å¯è°ƒæ•´å†…å­˜æˆæœ¬ï¼ˆmï¼‰ã€è¿­ä»£æ¬¡æ•°ï¼ˆtï¼‰ã€å¹¶è¡Œåº¦ï¼ˆpï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">ğŸ“ å°ç»“</h2>





























<table><thead><tr><th>æ“ä½œ</th><th>æ–¹æ³•</th></tr></thead><tbody><tr><td>ç”Ÿæˆå“ˆå¸Œ</td><td><code>await argon2.hash(password)</code></td></tr><tr><td>éªŒè¯å¯†ç </td><td><code>await argon2.verify(hash, inputPassword)</code></td></tr><tr><td>æ˜¯å¦è‡ªåŠ¨åŠ ç›</td><td>âœ… æ˜¯</td></tr><tr><td>ç›éœ€ä¿å­˜å—</td><td>âŒ ä¸éœ€è¦ï¼ˆå“ˆå¸Œä¸­å·²åŒ…å«ï¼‰</td></tr><tr><td>Python å®ç°</td><td><code>argon2-cffi</code></td></tr></tbody></table>
<hr/>
<blockquote>
<p>ğŸ—’ï¸ è®°ä½ï¼š
Argon2 æ˜¯å¯†ç å“ˆå¸Œç®—æ³•ï¼Œä¸æ˜¯åŠ å¯†ç®—æ³•ã€‚
å®ƒçš„ç›®æ ‡æ˜¯è®©å¯†ç <strong>æ— æ³•è¢«è¿˜åŸ</strong>ï¼Œä½†èƒ½è¢«å®‰å…¨åœ°éªŒè¯ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nettyæºç åˆ†æï¼ˆç»ˆï¼‰--å…³äºWriteAndFlush]]></title>    <link>https://juejin.cn/post/7571722835658014754</link>    <guid>https://juejin.cn/post/7571722835658014754</guid>    <pubDate>2025-11-13T02:21:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571722835658014754" data-draft-id="7571237750731128866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nettyæºç åˆ†æï¼ˆç»ˆï¼‰--å…³äºWriteAndFlush"/> <meta itemprop="keywords" content="Netty,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2025-11-13T02:21:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="9527å‡ºåˆ—"/> <meta itemprop="url" content="https://juejin.cn/user/882280885387789"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nettyæºç åˆ†æï¼ˆç»ˆï¼‰--å…³äºWriteAndFlush
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/882280885387789/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    9527å‡ºåˆ—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:21:18.000Z" title="Thu Nov 13 2025 02:21:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ Netty ç¼–ç¨‹ä¸­ï¼Œ<code>writeAndFlush()</code> æ˜¯æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ–¹æ³•ä¹‹ä¸€ã€‚å®ƒä»£è¡¨ç€ä»ç”¨æˆ·å±‚åˆ°å†…æ ¸ç¼“å†²åŒºçš„ä¸€æ•´æ¡å‡ºç«™ï¼ˆOutboundï¼‰æ•°æ®è·¯å¾„ã€‚æœ¬ç« å°†ä»æºç å±‚é¢ï¼Œæ·±å…¥åˆ†æ <code>writeAndFlush()</code> çš„æ‰§è¡Œæµç¨‹ä¸å…³é”®æœºåˆ¶ã€‚</p>
<h3 data-id="heading-1">writeæ–¹æ³•</h3>
<p>åœ¨å‰é¢è®²è§£ç¼–è§£ç å™¨æ—¶ï¼Œæˆ‘ä»¬æåˆ°è¿‡â€œç¼–ç â€çš„æ¦‚å¿µã€‚ç¼–ç æŒ‡çš„æ˜¯<strong>å°†æœåŠ¡å™¨å¤„ç†å®Œçš„ä¸šåŠ¡å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚ç </strong>çš„è¿‡ç¨‹ã€‚<br/>
å› ä¸ºæ•°æ®å†™å‡ºå±äº <strong>Outbound äº‹ä»¶</strong>ï¼Œæ‰€ä»¥è´Ÿè´£ç¼–ç çš„ <code>Handler</code> ä¸€èˆ¬ä½äºç®¡é“å°¾éƒ¨ï¼ˆ<code>TailHandler</code>ï¼‰ä¹‹å‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/419f6c73b9db42b885192ccc345273d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOTUyN-WHuuWIlw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605277&amp;x-signature=kmUH8VBF1Tn42tquyHAsEtrcdfs%3D" alt="image.png" loading="lazy"/></p>
<p>å…¸å‹çš„ç¼–ç å™¨ï¼ˆEncoderï¼‰é€šå¸¸ç»§æ‰¿è‡ª <code>MessageToByteEncoder</code>ã€‚<br/>
å½“æˆ‘ä»¬è°ƒç”¨ <code>ctx.channel().write()</code> æ—¶ï¼ŒNetty ä¼šä»ç®¡é“å°¾éƒ¨ï¼ˆTailï¼‰å¼€å§‹ï¼Œä¾æ¬¡è°ƒç”¨æ‰€æœ‰ <strong>Outbound ç±»å‹çš„ Handler</strong>ã€‚</p>
<h4 data-id="heading-2">1. MessageToByteEncoder.write()</h4>
<pre><code class="hljs"/></pre>
<pre><code class="hljs language-ini" lang="ini">MessageToByteEncoder

public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception {
    ByteBuf <span class="hljs-attr">buf</span> = null<span class="hljs-comment">;</span>
    try {
        if (acceptOutboundMessage(msg)) {
            I <span class="hljs-attr">cast</span> = (I) msg<span class="hljs-comment">;</span>
            <span class="hljs-attr">buf</span> = allocateBuffer(ctx, cast, preferDirect)<span class="hljs-comment">;</span>
            try {
                encode(ctx, cast, buf)<span class="hljs-comment">;</span>
            } finally {
                ReferenceCountUtil.release(cast)<span class="hljs-comment">;</span>
            }

            if (buf.isReadable()) {
                ctx.write(buf, promise)<span class="hljs-comment">;</span>
            } else {
                buf.release()<span class="hljs-comment">;</span>
                ctx.write(Unpooled.EMPTY_BUFFER, promise)<span class="hljs-comment">;</span>
            }
            <span class="hljs-attr">buf</span> = null<span class="hljs-comment">;</span>
        } else {
            ctx.write(msg, promise)<span class="hljs-comment">;</span>
        }
    } catch (Throwable e) {
        throw new EncoderException(e)<span class="hljs-comment">;</span>
    } finally {
        if (buf != null) {
            buf.release()<span class="hljs-comment">;</span>
        }
    }
}

</code></pre>
<p>è¿™ä¸€è¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li><strong>åˆ¤æ–­æ¶ˆæ¯ç±»å‹</strong>ï¼šè‹¥å½“å‰ <code>Handler</code> èƒ½å¤„ç†è¯¥æ¶ˆæ¯ï¼Œåˆ™è¿›å…¥åç»­æµç¨‹ï¼Œå¦åˆ™ç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li><strong>ç±»å‹è½¬æ¢</strong>ï¼šå°†æ¶ˆæ¯å¼ºåˆ¶è½¬æ¢ä¸ºç¼–ç å™¨å¯å¤„ç†çš„ç±»å‹ã€‚</li>
<li><strong>åˆ†é… ByteBuf</strong>ï¼šä¸ºç¼–ç åçš„å­—èŠ‚æ•°æ®åˆ†é…ç¼“å†²åŒºã€‚</li>
<li><strong>ç¼–ç è¿‡ç¨‹</strong>ï¼šè°ƒç”¨ <code>encode()</code> æ–¹æ³•ï¼ˆç”¨æˆ·è‡ªå®šä¹‰é€»è¾‘ï¼‰ï¼Œå°†å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚ã€‚</li>
<li><strong>é‡Šæ”¾åŸå¯¹è±¡</strong>ï¼šæ•°æ®å·²è¢«å†™å…¥ ByteBufï¼ŒåŸæ¶ˆæ¯å¯¹è±¡ä¸å†éœ€è¦ã€‚</li>
<li><strong>ä¼ é€’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</strong>ï¼šè‹¥ <code>buf</code> ä¸­æœ‰æ•°æ®åˆ™ç»§ç»­ä¼ é€’ï¼Œå¦åˆ™é‡Šæ”¾ã€‚</li>
<li><strong>æœ€ç»ˆé‡Šæ”¾èµ„æº</strong>ï¼šåœ¨ Pipeline ä¸­å¤„ç†å®Œæ¯•åé‡Šæ”¾ ByteBufã€‚</li>
</ol>
<h4 data-id="heading-3">2. HeadContext.write()</h4>
<p>æ‰€æœ‰ Outbound Handler æ‰§è¡Œå®Œåï¼ŒByteBuf ä¼šè¿›å…¥ç®¡é“é¦–éƒ¨ï¼ˆHeadï¼‰ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">HeadContext

@<span class="hljs-function">Override
<span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">write</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg, ChannelPromise promise)</span> throws Exception </span>{
    unsafe.<span class="hljs-built_in">write</span>(msg, promise);
}
</code></pre>
<p>è¿™é‡Œçš„ <code>unsafe.write()</code> å®é™…ç”± <code>AbstractUnsafe</code> å®ç°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">public final void write(Object msg, ChannelPromise promise) {
    assertEventLoop()<span class="hljs-comment">;</span>

    ChannelOutboundBuffer <span class="hljs-attr">outboundBuffer</span> = this.outboundBuffer<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">outboundBuffer</span> == null) {
        safeSetFailure(promise, WRITE_CLOSED_CHANNEL_EXCEPTION)<span class="hljs-comment">;</span>
        ReferenceCountUtil.release(msg)<span class="hljs-comment">;</span>
        return<span class="hljs-comment">;</span>
    }

    int size<span class="hljs-comment">;</span>
    try {
        <span class="hljs-attr">msg</span> = filterOutboundMessage(msg)<span class="hljs-comment">;</span>
        <span class="hljs-attr">size</span> = pipeline.estimatorHandle().size(msg)<span class="hljs-comment">;</span>
        if (size &lt; 0) <span class="hljs-attr">size</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    } catch (Throwable t) {
        safeSetFailure(promise, t)<span class="hljs-comment">;</span>
        ReferenceCountUtil.release(msg)<span class="hljs-comment">;</span>
        return<span class="hljs-comment">;</span>
    }

    outboundBuffer.addMessage(msg, size, promise)<span class="hljs-comment">;</span>
}

</code></pre>
<p>æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>ç¡®ä¿çº¿ç¨‹å®‰å…¨</strong>ï¼š<code>assertEventLoop()</code> ç¡®è®¤å½“å‰æ“ä½œåœ¨ Reactor çº¿ç¨‹ä¸­ã€‚</li>
<li><strong>è¿‡æ»¤æ¶ˆæ¯ç±»å‹</strong>ï¼šé€šè¿‡ <code>filterOutboundMessage()</code> å¤„ç†ä¸åŒç±»å‹çš„æ¶ˆæ¯ã€‚</li>
<li><strong>ä¼°ç®—å†™å…¥å­—èŠ‚æ•°</strong>ï¼šç”¨äºæµæ§ä¸ç»Ÿè®¡ã€‚</li>
<li><strong>åŠ å…¥å†™ç¼“å†²åŒº</strong>ï¼šè°ƒç”¨ <code>ChannelOutboundBuffer.addMessage()</code> å­˜å…¥å¾…å†™é“¾è¡¨ã€‚</li>
</ol>
<h3 data-id="heading-4">ChannelOutboundBuffer</h3>
<p><code>ChannelOutboundBuffer</code> å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª<strong>å•å‘é“¾è¡¨ç»“æ„</strong>ï¼Œç”¨æ¥ä¿å­˜å¾…å†™çš„ ByteBuf èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">public void addMessage(Object msg, int size, ChannelPromise promise) {
    Entry <span class="hljs-attr">entry</span> = Entry.newInstance(msg, size, total(msg), promise)<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">tailEntry</span> == null) {
        <span class="hljs-attr">flushedEntry</span> = null<span class="hljs-comment">;</span>
        <span class="hljs-attr">tailEntry</span> = entry<span class="hljs-comment">;</span>
    } else {
        <span class="hljs-attr">tailEntry.next</span> = entry<span class="hljs-comment">;</span>
        <span class="hljs-attr">tailEntry</span> = entry<span class="hljs-comment">;</span>
    }
    if (<span class="hljs-attr">unflushedEntry</span> == null) {
        <span class="hljs-attr">unflushedEntry</span> = entry<span class="hljs-comment">;</span>
    }
    incrementPendingOutboundBytes(size, false)<span class="hljs-comment">;</span>
}
</code></pre>
<p>è¯¥é“¾è¡¨åŒ…å«ä¸‰ä¸ªé‡è¦æŒ‡é’ˆï¼š</p>





















<table><thead><tr><th>æŒ‡é’ˆ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><strong>flushedEntry</strong></td><td>å·²åˆ·æ–°ï¼ˆå†™å…¥æ“ä½œç³»ç»Ÿç¼“å†²åŒºï¼‰çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</td></tr><tr><td><strong>unflushedEntry</strong></td><td>å°šæœªåˆ·æ–°åˆ°å†…æ ¸ç¼“å†²åŒºçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</td></tr><tr><td><strong>tailEntry</strong></td><td>é“¾è¡¨å°¾èŠ‚ç‚¹</td></tr></tbody></table>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0460f83a21df44eebba40d1ec6c731e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOTUyN-WHuuWIlw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605277&amp;x-signature=Vi3LqHHHKqmlOrdcXiOEWCMU1qQ%3D" alt="image.png" loading="lazy"/>
æ¯æ¬¡ <code>addMessage()</code> è°ƒç”¨ï¼Œéƒ½ä¼šåœ¨ <code>unflushedEntry</code> å’Œ <code>tailEntry</code> ä¹‹é—´æ’å…¥æ–°çš„å¾…å†™èŠ‚ç‚¹ã€‚</p>
<h3 data-id="heading-5">flushæ–¹æ³•</h3>
<p><code>flush()</code>æ–¹æ³•å…¶å®å’Œ<code>write()</code>çš„æ‰§è¡Œæµç¨‹æ¯”è¾ƒç›¸ä¼¼ã€‚<br/>
<code>ctx.flush()</code>å’Œ<code>ctx.channel().flush()</code>æœ€ç»ˆéƒ½ä¼šè°ƒç”¨åˆ°HeadèŠ‚ç‚¹çš„flushæ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java">HeadContext  
  
<span class="hljs-meta">@Override</span>  
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">flush</span><span class="hljs-params">(ChannelHandlerContextÂ ctx)</span>Â <span class="hljs-keyword">throws</span>Â ExceptionÂ ï½›  
Â Â Â Â unsafe.flush()ï¼›  
ï½
</code></pre>
<p><code>unsafe.flush()</code>æ–¹æ³•ç”±AbstractUnsafeå®ç°</p>
<pre><code class="hljs language-ini" lang="ini">HeadContext

@Override
public final void flush() {
    assertEventLoop()<span class="hljs-comment">;</span>
    ChannelOutboundBuffer <span class="hljs-attr">outboundBuffer</span> = this.outboundBuffer<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">outboundBuffer</span> == null) {
        return<span class="hljs-comment">;</span>
    }
    outboundBuffer.addFlush()<span class="hljs-comment">;</span>
    flush0()<span class="hljs-comment">;</span>
}
</code></pre>
<p>å…¶ä¸­<code>outboundBuffer.addFlush()</code>è´Ÿè´£ç§»åŠ¨<strong>outboundBuffer</strong>ä¸­çš„ä¸‰ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆæœ€ç»ˆä¼šå˜æˆä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0129eede58344ecc926f2e12d7ee6fb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOTUyN-WHuuWIlw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605277&amp;x-signature=XKjDNo3SyuyutBwm3uSFXymN6kY%3D" alt="image.png" loading="lazy"/></p>
<p><code>flush0()</code>æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨<code>AbstractNioByteChannel</code>çš„<code>doWrite()</code>æ–¹æ³•ï¼Œ
<code>doWrite()</code>æ–¹æ³•å–å‡º<strong>outboundBuffer</strong>ä¸­å•é“¾è¡¨çš„èŠ‚ç‚¹ï¼Œåˆ©ç”¨<strong>è‡ªæ—‹é”</strong>å°†èŠ‚ç‚¹å†™åˆ°åè®®æ ˆçš„ç¼“å†²åŒºã€‚<br/>
ä¹‹åç§»é™¤å½“å‰æ¥èŠ‚ç‚¹å¹¶å°†<code>flushedEntry</code>æŒ‡å‘ä¸€ä¸‹ä¸ªèŠ‚ç‚¹ã€‚å¦‚å›¾</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec00be2cbaec46c3849aa053954ef6c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOTUyN-WHuuWIlw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605277&amp;x-signature=OC6myQT6%2B9N6a%2Bd5r7VIrFrM1cY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">writeAndFlush æ–¹æ³•</h2>
<p><code>writeAndFlush()</code> æœ¬è´¨ä¸Šç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">write</span>(msg);
<span class="hljs-built_in">flush</span>();
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š<br/>
<strong>å…ˆå°†æ¶ˆæ¯åŠ å…¥å‡ºç«™ç¼“å†²åŒºï¼Œå†ç«‹å³è§¦å‘åˆ·å…¥å†…æ ¸ç¼“å†²åŒºçš„åŠ¨ä½œã€‚</strong></p>
<h2 data-id="heading-7">å°ç»“</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæ•´åˆ†æäº† <code>writeAndFlush()</code> çš„å†…éƒ¨æ‰§è¡Œè·¯å¾„ï¼š</p>
<ol>
<li><strong>write é˜¶æ®µ</strong>ï¼šå¯¹è±¡ â†’ ByteBuf â†’ OutboundPipeline â†’ ChannelOutboundBuffer</li>
<li><strong>flush é˜¶æ®µ</strong>ï¼šå‡ºç«™ç¼“å†²åŒº â†’ æ“ä½œç³»ç»Ÿå†…æ ¸ç¼“å†²åŒº</li>
</ol>
<p>æœ¬ç³»åˆ—ä» Netty çš„å¯åŠ¨æµç¨‹ã€Reactor çº¿ç¨‹æ¨¡å‹ã€å®¢æˆ·ç«¯æ¥å…¥ã€æ•°æ®è§£ç ï¼Œåˆ°æœ¬ç« çš„å†™å‡ºæµç¨‹ï¼Œç³»ç»Ÿåœ°å±•ç¤ºäº† Netty åœ¨ç½‘ç»œé€šä¿¡ä¸­çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<p>Netty ä½œä¸ºä¸€æ¬¾é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œå†…éƒ¨è•´å«äº†å¤§é‡ä¼˜ç§€è®¾è®¡ï¼š</p>
<ul>
<li>å¯¹ <code>SelectionKey</code> çš„ç»“æ„ä¼˜åŒ–ï¼ˆç”±é›†åˆæ”¹ä¸ºæ•°ç»„ï¼‰ï¼›</li>
<li>Selector é‡å»ºæœºåˆ¶ï¼Œè§„é¿ JDK ç©ºè½®è¯¢ Bugï¼›</li>
<li>ç²¾ç»†åŒ–å†…å­˜ç®¡ç†ä¸çº¿ç¨‹æ¨¡å‹ä¼˜åŒ–ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ ä»â€œHulkâ€æ‰©å±•å¼€å‘å®æˆ˜ï¼ŒèŠèŠæˆ‘æ‰¾åˆ°çš„â€œVibe Codingâ€æœ€ä½³å§¿åŠ¿]]></title>    <link>https://juejin.cn/post/7571657746346917942</link>    <guid>https://juejin.cn/post/7571657746346917942</guid>    <pubDate>2025-11-12T16:46:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571657746346917942" data-draft-id="7571657746346901558" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ ä»â€œHulkâ€æ‰©å±•å¼€å‘å®æˆ˜ï¼ŒèŠèŠæˆ‘æ‰¾åˆ°çš„â€œVibe Codingâ€æœ€ä½³å§¿åŠ¿"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,è®¾è®¡"/> <meta itemprop="datePublished" content="2025-11-12T16:46:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—å±±å®‰"/> <meta itemprop="url" content="https://juejin.cn/user/1795929588117962"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ ä»â€œHulkâ€æ‰©å±•å¼€å‘å®æˆ˜ï¼ŒèŠèŠæˆ‘æ‰¾åˆ°çš„â€œVibe Codingâ€æœ€ä½³å§¿åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1795929588117962/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—å±±å®‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T16:46:19.000Z" title="Wed Nov 12 2025 16:46:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>ä½œä¸ºä¸€åå‰ç«¯å­¦ä¹ è€…ï¼Œæˆ‘æ›¾æ²‰è¿·äºåœ¨æ¯ä¸€ä¸ªåƒç´ å’Œæ¯ä¸€è¡Œä»£ç ä¸Šç²¾ç›Šæ±‚ç²¾ã€‚</p>
<p>ä½†æœ€è¿‘ï¼Œä¸€ç§åä¸ºÂ  <strong>â€œVibe Codingâ€</strong> â€‹ çš„åä½œæ¨¡å¼å½»åº•æ”¹å˜äº†æˆ‘çš„å·¥ä½œæµã€‚å®ƒå¹¶éé¼“å¹â€œé›¶ä»£ç â€ï¼Œè€Œæ˜¯å¼ºè°ƒä¸€ç§æ–°çš„åˆ†å·¥ï¼š<strong>å¼€å‘è€…ä½œä¸ºâ€œå¯¼æ¼”â€ï¼Œè€ŒAIä½œä¸ºâ€œé¦–å¸­å·¥ç¨‹å¸ˆâ€</strong> ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜é¡¹ç›®â€”â€”å¼€å‘ä¸€æ¬¾åä¸ºÂ  <strong>â€œHulkâ€çš„Chromeæ‰©å±•</strong>ï¼ˆåŠŸèƒ½å¾ˆç®€å•ï¼šä¸€é”®å°†ç½‘é¡µèƒŒæ™¯å˜ç»¿ï¼‰ï¼Œæ¥å±•ç¤ºè¿™ç§é«˜æ•ˆã€æ„‰æ‚¦çš„åä½œæ¨¡å¼ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç†å¿µå…ˆè¡Œï¼šä»€ä¹ˆæ˜¯ Vibe Codingï¼Ÿ</h3>
<p>ä¸€å¥è¯è§£é‡Š<strong>Vibe Coding</strong>ï¼šVibeCoding æ˜¯ä¸€ç§å¼ºè°ƒå¼€å‘è€…åœ¨è‰¯å¥½æ°›å›´ï¼ˆvibeï¼‰ä¸­é«˜æ•ˆã€æ„‰æ‚¦åœ°ç¼–å†™ä»£ç çš„ç¼–ç¨‹ç†å¿µæˆ–å·¥ä½œçŠ¶æ€ï¼Œé€šå¸¸èåˆäº†åˆé€‚çš„éŸ³ä¹ã€ç¯å¢ƒã€å·¥å…·å’Œå¿ƒæµä½“éªŒã€‚</p>
<p>åœ¨å¼€å§‹æ•²ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç»Ÿä¸€ä¸€ä¸‹â€œæ€æƒ³â€ã€‚æ ¹æ®æˆ‘çš„ç†è§£ï¼Œ<strong>Vibe Coding çš„æ ¸å¿ƒ</strong>æ˜¯ï¼š</p>
<ul>
<li>
<p><strong>ç›®æ ‡å¯¼å‘</strong>ï¼šå…³æ³¨â€œåšä»€ä¹ˆâ€å’Œâ€œä¸ºä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±é™·å…¥â€œæ€ä¹ˆåšâ€ã€‚</p>
</li>
<li>
<p><strong>æ–‡æ¡£å³ä¸Šä¸‹æ–‡</strong>ï¼šæ¸…æ™°ã€ç»“æ„åŒ–çš„æ–‡æ¡£æ˜¯ä¸AIï¼ˆå¦‚ Trae, Cursor, GPTç­‰ï¼‰é«˜æ•ˆåä½œçš„åŸºçŸ³ã€‚AIä¸æ“…é•¿çŒœä½ çš„å¿ƒæ€ï¼Œä½†å®ƒæå…¶æ“…é•¿åœ¨æ¸…æ™°çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»»åŠ¡ã€‚</p>
</li>
<li>
<p><strong>äººæœºååŒ</strong>ï¼šå¼€å‘è€…è´Ÿè´£æ¶æ„è®¾è®¡ã€è¾¹ç•Œåˆ’å®šã€é€»è¾‘å®¡æŸ¥å’Œâ€œ vibe â€ï¼ˆæ„Ÿè§‰ï¼‰æŠŠæ§ï¼›AIè´Ÿè´£å¿«é€Ÿç”Ÿæˆæ¨¡æ¿ä»£ç ã€å®ç°åŸºç¡€åŠŸèƒ½ã€‚</p>
</li>
<li>
<p><strong>ä½ä»£ç æ˜¯ç»“æœï¼Œè€Œä¸æ˜¯æ‰‹æ®µ</strong>ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é«˜è´¨é‡ã€å¿«é€Ÿåœ°äº¤ä»˜äº§å“ï¼Œè‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆæ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„å¼ºå¤§å·¥å…·ã€‚</p>
</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬ä¸å†æ˜¯<strong>ä»0åˆ°1</strong>çš„ç ç –å·¥ï¼Œè€Œæ˜¯<strong>ä»0.5åˆ°1.5</strong>çš„æ¶æ„å¸ˆå’Œè´¨æ£€å‘˜ã€‚</p>
<h3 data-id="heading-2">äºŒã€é¡¹ç›®å®æˆ˜ï¼šHulk æ‰©å±•çš„ Vibe å¼€å‘æµ</h3>
<p>æˆ‘ä»¬çš„äº§å“éœ€æ±‚éå¸¸æ˜ç¡®ï¼š</p>
<ol>
<li>ä¸€ä¸ªåä¸º Hulk çš„æ‰©å±•ï¼Œä½¿ç”¨æŒ‡å®šå›¾æ ‡ã€‚</li>
<li>ç‚¹å‡»æ‰©å±•å›¾æ ‡ï¼Œå¼¹å‡ºçª—å£æ˜¾ç¤ºæç¤ºä¿¡æ¯å’Œâ€œæ”¹å˜é¢œè‰²â€æŒ‰é’®ã€‚</li>
<li>ç‚¹å‡»æŒ‰é’®ï¼Œå½“å‰ç½‘é¡µèƒŒæ™¯å˜ä¸ºç»¿è‰²ã€‚</li>
</ol>
<h4 data-id="heading-3">Step 1: å¥ å®šåŸºçŸ³ - é¡¹ç›®æ¸…å•ä¸æ¶æ„</h4>
<p>ä¼ ç»Ÿçš„åšæ³•æ˜¯ç›´æ¥æ‰“å¼€ç¼–è¾‘å™¨åˆ›å»ºÂ <code>manifest.json</code>ã€‚ä½†åœ¨ Vibe Coding æ¨¡å¼ä¸‹ï¼Œæˆ‘é¦–å…ˆåˆ›å»ºäº†ä¸€ä»½â€œéœ€æ±‚æ–‡æ¡£â€ï¼ˆinstruct.txtï¼‰ï¼Œè¿™å°†æˆä¸ºæˆ‘ç»™AIçš„â€œå·¥ä½œä»»åŠ¡ä¹¦â€ã€‚</p>
<pre><code class="hljs language-instruct.txt" lang="instruct.txt">ä½ æ˜¯ä¸€ä¸ªç»éªŒä¸°å¯Œçš„Chrome æ‰©å±•ç¨‹åºå¼€å‘è€…ï¼Œè¯·å¸®æˆ‘å¼€å‘ä¸€ä¸ªåä¸ºHulkçš„æ‰©å±•ç¨‹åºã€‚
UX è®¾è®¡å›¾å‚è€ƒux.jpg

å…·ä½“äº¤äº’æ­¥éª¤å¦‚ä¸‹ï¼š
Step1:ç‚¹å‡»ç¨‹åºå›¾æ ‡æ‰“å¼€å¼¹å‡ºçª—å£ï¼Œåœ¨çª—å£ä¸­é»˜è®¤æç¤ºï¼šâ€œæ”¹å˜èƒŒæ™¯é¢œè‰²â€ã€â€œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å°†å½“å‰é¡µé¢èƒŒæ™¯è‰²æ”¹ä¸ºç»¿è‰²â€ï¼Œå’Œç”Ÿæˆä¸€ä¸ªâ€œæ”¹å˜é¢œè‰²â€æŒ‰é’®

Step2:ç‚¹å‡»æŒ‰é’®ï¼Œç½‘é¡µèƒŒæ™¯æ”¹å˜ä¸ºç»¿è‰²

æ³¨æ„ä»¥ä¸‹ï¼š
è¯·ä½¿ç”¨iconsæ–‡ä»¶å¤¹çš„å›¾æ ‡ä½œä¸ºå›¾æ ‡
</code></pre>
<p><code>ux.jpg</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0234413ff55c4b2e9a45545b4fdb781e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=LVkQW%2FDWeuNsi6TwIO6d07Bt7aM%3D" alt="image.png" loading="lazy"/></p>
<p><code>icons</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a46769d73d524177a6267973ed686289~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=MiFjvcxo5FuQMhLlG7CCrzgFvss%3D" alt="image.png" loading="lazy"/></p>
<p>æä¾›å¥½å¯¹åº”æ–‡ä»¶å¤¹ä¸­çš„å‚é æ–‡ä»¶åï¼Œå°±å¯ä»¥è®©AIå¸®æˆ‘ä»¬ç”Ÿæˆäº†</p>
<p>åœ¨å³ä¾§å¯¹è¯æ¡†ä¸­è¾“å…¥ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bf0fd9338b740f9a87ae20c5f160336~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=rM8nl1QOPqssnktI4R7KTMxhTzg%3D" alt="image.png" loading="lazy"/></p>
<p>å¾ˆå¿«ï¼ŒAIç»™äº†æˆ‘ä¸€ä»½å®Œç¾çš„Â <code>manifest.json</code>ã€‚å®ƒæ­£ç¡®åœ°å£°æ˜äº†Â <code>activeTab</code>å’ŒÂ <code>scripting</code>æƒé™ï¼Œè¿™æ­£æ˜¯MV3ä¸­æ³¨å…¥è„šæœ¬æ‰€éœ€çš„å…³é”®é…ç½®ã€‚çœ‹ï¼Œå¥½çš„æ–‡æ¡£ï¼ˆéœ€æ±‚ï¼‰ç›´æ¥äº§å‡ºäº†æ­£ç¡®çš„æ ¸å¿ƒé…ç½®ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨Chromeæ’ä»¶ç®¡ç†ä¸­æ‰‹åŠ¨æ·»åŠ ä¸€ä¸‹ï¼ŒæŸ¥çœ‹æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d8619f8343d4183965fbed2cc439bc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=CDPEOEkiB7t3adl5cuP%2BB5%2BuKRc%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ’ä»¶è®¾è®¡æ•ˆæœ</strong>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35f077385f8f457fb2e7c719d8ba092f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=M2yOxJp7rP08gaHWGaHlYdUlSOI%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä½¿ç”¨æ•ˆæœ</strong>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c4188ce3716469bbb0b6b3de54c84a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570779&amp;x-signature=fIaPW5laG%2BH18A0uzBrIExk6%2FaQ%3D" alt="image.png" loading="lazy"/></p>
<p><strong>è‡³æ­¤ï¼Œä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„Chromeæ‰©å±•å·²ç»è¯ç”Ÿã€‚</strong> â€‹ æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘æ›´åƒæ˜¯ä¸€ä¸ªäº§å“ç»ç†å’Œæ¶æ„å¸ˆï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€å‘AIä¸‹è¾¾ç²¾ç¡®çš„æŒ‡ä»¤ï¼Œè€ŒAIåˆ™å®Œç¾åœ°æ‰®æ¼”äº†æ‰§è¡Œè€…çš„è§’è‰²ã€‚</p>
<h3 data-id="heading-4">ä¸‰ã€Vibe Coding çš„å¿ƒæ³•ï¼šè€å¿ƒä¸æ–‡æ¡£</h3>
<p>é€šè¿‡Hulkæ‰©å±•çš„å¼€å‘ï¼Œæˆ‘æ·±åˆ»ä½“ä¼šåˆ°Vibe Codingçš„æˆåŠŸå…³é”®ï¼š</p>
<ol>
<li>
<p><strong>æ¸…æ™°çš„ä¸Šä¸‹æ–‡ï¼ˆæ–‡æ¡£ï¼‰æ˜¯ç”Ÿå‘½çº¿</strong>ï¼šéœ€æ±‚æ–‡æ¡£ã€æŠ€æœ¯é€‰å‹ï¼ˆMV3ï¼‰ã€è®¾è®¡ç¨¿ï¼ˆux.jpgï¼‰å…±åŒæ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„ä¸Šä¸‹æ–‡ã€‚è¿™è®©AIèƒ½ç”Ÿæˆé«˜åº¦å‡†ç¡®çš„ä»£ç ï¼Œå‡å°‘è¿”å·¥ã€‚</p>
</li>
<li>
<p><strong>åšAIä¸æ“…é•¿çš„äº‹</strong>ï¼šAIå¯èƒ½ä¼šåœ¨å¤æ‚çš„ä¸šåŠ¡é€»è¾‘æˆ–éå¸¸è§„äº¤äº’ä¸ŠçŠ¯é”™ã€‚æˆ‘çš„å·¥ä½œæ˜¯<strong>åˆ’å®šè¾¹ç•Œã€è®¾è®¡æ¶æ„ã€å¹¶è¿›è¡Œæœ€ç»ˆçš„è´¨é‡æŠŠå…³</strong>ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä¼šå®¡æŸ¥AIç”Ÿæˆçš„Â <code>manifest.json</code>ä¸­çš„æƒé™æ˜¯å¦åˆç†ï¼Œ<code>popup.js</code>ä¸­çš„APIè°ƒç”¨æ˜¯å¦ç¬¦åˆMV3è§„èŒƒã€‚</p>
</li>
<li>
<p><strong>è€å¿ƒè¿­ä»£</strong>ï¼šVibe Coding ä¸æ˜¯ä¸€è¹´è€Œå°±çš„é­”æ³•ã€‚æœ‰æ—¶éœ€è¦æ ¹æ®ç”Ÿæˆç»“æœï¼Œåè¿‡æ¥è°ƒæ•´ä½ çš„æç¤ºè¯å’Œæ–‡æ¡£ï¼Œè¿›è¡Œå¤šæ¬¡è¿­ä»£ã€‚è¿™æ˜¯ä¸€ç§å¯¹è¯ï¼Œè€Œä¸æ˜¯å•æ¬¡å‘½ä»¤ã€‚</p>
</li>
</ol>
<h3 data-id="heading-5">å››ã€æ•ˆæœå±•ç¤ºä¸æºç </h3>
<p>è¿™å°±æ˜¯æˆ‘ä»¬çš„Hulkæ‰©å±•ï¼šï¼ˆ<em>æ­¤å¤„åº”æ›¿æ¢ä¸ºux.jpgçš„å®é™…æ•ˆæœå›¾</em>ï¼‰<strong>æœ€ç»ˆé¡¹ç›®ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">hulk-extension/
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon16<span class="hljs-selector-class">.png</span>
â”‚   â”œâ”€â”€ icon48<span class="hljs-selector-class">.png</span>
â”‚   â””â”€â”€ icon128<span class="hljs-selector-class">.png</span>
â”œâ”€â”€ manifest<span class="hljs-selector-class">.json</span>  (æ¥è‡ªAIç”Ÿæˆ)
â”œâ”€â”€ popup<span class="hljs-selector-class">.html</span>     (æ¥è‡ªAIç”Ÿæˆ)
â””â”€â”€ popup<span class="hljs-selector-class">.js</span>       (æ¥è‡ªAIç”Ÿæˆ)
â””â”€â”€ ux<span class="hljs-selector-class">.jpg</span>
â””â”€â”€ instruction<span class="hljs-selector-class">.txt</span>

</code></pre>
<h3 data-id="heading-6">äº”ã€ç»“è¯­ï¼šæ‹¥æŠ±å¼€å‘èŒƒå¼çš„è½¬å˜</h3>
<p>å¼€å‘Hulkè¿™ä¸ªç®€å•çš„æ‰©å±•ï¼Œå¦‚æœæ‰‹åŠ¨ç¼–å†™ï¼Œå¯èƒ½ä¹Ÿéœ€è¦15-20åˆ†é’Ÿã€‚ä½†åœ¨Vibe Codingæ¨¡å¼ä¸‹ï¼Œæˆ‘ä»…ä»…é€šè¿‡<strong>ç¼–å†™éœ€æ±‚å’Œå®¡æŸ¥ä»£ç </strong>ï¼Œåœ¨5åˆ†é’Ÿå†…å°±å®Œæˆäº†åŠŸèƒ½ã€‚</p>
<p>è¿™èŠ‚çœçš„ä¸ä»…ä»…æ˜¯æ—¶é—´ï¼Œæ›´æ˜¯å°†æˆ‘çš„å¿ƒæ™ºè´Ÿæ‹…ä»â€œè¯­æ³•ç»†èŠ‚â€å’Œâ€œAPIè®°å¿†â€ä¸­è§£æ”¾å‡ºæ¥ï¼ŒæŠ•å…¥åˆ°æ›´é‡è¦çš„<strong>äº§å“è®¾è®¡å’Œæ¶æ„å†³ç­–</strong>ä¸Šã€‚</p>
<p>æœªæ¥ï¼Œç¼–ç èƒ½åŠ›å¯èƒ½ä¸å†å±€é™äºâ€œæ‰‹å†™ä»£ç çš„è¡Œæ•°â€ï¼Œè€Œåœ¨äº<strong>æ¸…æ™°å®šä¹‰é—®é¢˜çš„èƒ½åŠ›ã€æ¶æ„è®¾è®¡çš„èƒ½åŠ›ï¼Œä»¥åŠä¸AIæ™ºèƒ½ä½“é«˜æ•ˆåä½œçš„èƒ½åŠ›</strong>ã€‚<strong>Vibe Codingï¼Œå°±æ˜¯è¿™ç§æœªæ¥å·¥ä½œæ¨¡å¼çš„ç°åœ¨è¿›è¡Œæ—¶ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flink çš„ RocksDB çŠ¶æ€åç«¯åœ¨ vivo çš„å®è·µ]]></title>    <link>https://juejin.cn/post/7571731181198032932</link>    <guid>https://juejin.cn/post/7571731181198032932</guid>    <pubDate>2025-11-13T03:02:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571731181198032932" data-draft-id="7571726099689521171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flink çš„ RocksDB çŠ¶æ€åç«¯åœ¨ vivo çš„å®è·µ"/> <meta itemprop="keywords" content="å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2025-11-13T03:02:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vivoäº’è”ç½‘æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/993614243303053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flink çš„ RocksDB çŠ¶æ€åç«¯åœ¨ vivo çš„å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614243303053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vivoäº’è”ç½‘æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:02:02.000Z" title="Thu Nov 13 2025 03:02:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<blockquote>
<p>ä½œè€…ï¼š äº’è”ç½‘å¤§æ•°æ®å›¢é˜Ÿ- Chen Rui</p>
<p>æœ¬æ–‡ç®€è¦ä»‹ç»äº†ç‰¹å¾æ‹¼æ¥åœ¨å®æ—¶æ¨èä¸­çš„é‡è¦ä½œç”¨ï¼Œå¹¶è®²è¿°äº†vivoå®æ—¶æ¨èç³»ç»Ÿä¸­ç‰¹å¾æ‹¼æ¥æ¨¡å—çš„æ¶æ„æ¼”è¿›è¿‡ç¨‹ä»¥åŠé‡‡ç”¨ç°æœ‰çš„â€œåŸºäºRocksDBçš„å¤§çŠ¶æ€è§£å†³æ–¹æ¡ˆâ€çš„åŸå› ï¼Œé‡ç‚¹å™è¿°äº†è¯¥æ–¹æ¡ˆæ‰€é‡åˆ°çš„ä¸€ç³»åˆ—é—®é¢˜ï¼ŒåŒ…æ‹¬TM Lostã€RocksDBæ€§èƒ½è°ƒä¼˜é—¨æ§›é«˜ã€TMåˆå§‹åŒ–æ…¢ã€çŠ¶æ€è¿œç¨‹å­˜å‚¨HDFS RPCé£™é«˜ç­‰ï¼Œå¹¶ç»™å‡ºäº†è¿™äº›é—®é¢˜çš„ç°è±¡ä»¥åŠè§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<p>1åˆ†é’Ÿçœ‹å›¾æŒæ¡æ ¸å¿ƒè§‚ç‚¹ğŸ‘‡</p>
<p><img src="https://static001.geekbang.org/infoq/38/382f0104f6e8e8a42bda19405b12bc92.gif" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œæ ·æœ¬æ‹¼æ¥æ˜¯è¡”æ¥åœ¨çº¿æœåŠ¡ä¸ç®—æ³•æ¨¡å‹çš„é‡è¦ä¸€ä¸ªç¯èŠ‚ï¼Œä¸»è¦èŒè´£æ˜¯æ ·æœ¬æ‹¼æ¥å’Œä¸šåŠ¡ç›¸å…³çš„ETLå¤„ç†ç­‰ï¼Œæ¨¡å—ä½ç½®å¦‚ä¸‹å›¾çº¢æ¡†æ‰€ç¤ºã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/5d/5d6e6d948770d82b730057114ee3f098.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¨èç³»ç»Ÿé€šè¿‡å­¦ä¹ åŸ‹ç‚¹æ•°æ®æ¥è¾¾åˆ°ä¸ªæ€§åŒ–ç²¾å‡†æ¨èçš„ç›®çš„ï¼Œå› æ­¤éœ€è¦çŸ¥é“æœåŠ¡ç«¯æ¨èä¸‹å‘çš„å†…å®¹ï¼Œæ˜¯å¦æœ‰ä¸€ç³»åˆ—çš„è¡Œä¸º(æ›å…‰ï¼Œç‚¹å‡»ï¼Œæ’­æ”¾ï¼Œç‚¹èµï¼Œæ”¶è—ï¼ŒåŠ è´­ç­‰ç­‰)ï¼ŒæŠŠè¢«æ¨èå†…å®¹çš„åŸ‹ç‚¹æ•°æ®ä¸å½“ä¸‹çš„ç‰¹å¾æ‹¼æ¥èµ·æ¥çš„è¿‡ç¨‹ï¼Œä¸€èˆ¬ç§°ä¸ºæ ·æœ¬æ‹¼æ¥ï¼Œä¸€ä¸ªç®€åŒ–çš„æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/f8/f8fa426d9a1ee10b6bb46dab2dcf15e5.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¨èçš„è¿‡ç¨‹å¯ä»¥æ£€éªŒæ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<blockquote>
<ul>
<li>
<p>åå°æœåŠ¡rank æ¨èå†…å®¹ç»™appå®¢æˆ·ç«¯ï¼ŒåŒæ—¶æŠŠå†…å®¹å¯¹åº”çš„ç‰¹å¾å¿«ç…§ä¿å­˜èµ·æ¥ï¼›</p>
</li>
<li>
<p>appæ¥æ”¶åˆ°å†…å®¹åï¼ŒåŸ‹ç‚¹æ—¥å¿—è¢«ä¸ŠæŠ¥åˆ°æ¶ˆæ¯ä¸­é—´ä»¶ï¼›</p>
</li>
<li>
<p>æ ·æœ¬æ‹¼æ¥è´Ÿè´£å°†ç‰¹å¾ä¸åŸ‹ç‚¹æ—¥å¿—æ‹¼æ¥èµ·æ¥ï¼Œå®šä¹‰æ­£è´Ÿæ ·æœ¬ï¼Œæ ¼å¼è½¬æ¢ï¼›</p>
</li>
<li>
<p>æ¨¡å‹æ¥æ”¶æ ·æœ¬è®­ç»ƒï¼Œå°†ä½¿ç”¨æœ€æ–°çš„æ¨¡å‹åšæ¨èã€‚</p>
</li>
</ul>
</blockquote>
<p>ä¸ºäº†ä¿è¯è¾ƒé«˜çš„æ‹¼æ¥ç‡å’Œç¨³å®šæ€§ï¼Œæˆ‘ä»¬çš„æ‹¼æ¥æ¶æ„ä¹Ÿç»è¿‡äº†é•¿æ—¶é—´çš„è¿­ä»£ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘å°†ç»™å¤§å®¶ä»‹ç»vivoç‰¹å¾æ‹¼æ¥æ¶æ„çš„å‘å±•å†ç¨‹ã€å½“å‰æ–¹æ¡ˆã€å½“å‰æ–¹æ¡ˆé‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œä»¥åŠæœªæ¥çš„è§„åˆ’å’Œå±•æœ›ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°ä¸šå†…çš„åŒå­¦ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ‹¼æ¥æ–¹æ¡ˆé€‰å‹</h2>
<h3 data-id="heading-2">2.1 å°æ—¶ç²’åº¦æ‹¼æ¥</h3>
<p>å°æ—¶æ‹¼æ¥æ˜¯å°†åŸ‹ç‚¹æ—¥å¿—å’Œç‰¹å¾å¿«ç…§éƒ½ä¿å­˜åˆ°Hiveå¹¶ä»¥å°æ—¶åˆ†åŒºï¼Œæ¯å°æ—¶è°ƒåº¦ä¸€ä¸ªSparkä»»åŠ¡æ¥å¤„ç†ä¸¤ä¸ªè¡¨ç›¸åº”åˆ†åŒºçš„æ•°æ®åšæ‹¼æ¥ï¼Œç”±äºæ˜¯å°æ—¶æ‹¼æ¥ï¼Œå®æ—¶æ€§è¾ƒä½ï¼ŒSparkä½œä¸šæœ¬èº«ä¹Ÿä¾èµ–äºä¸Šæ¸¸Hiveè¡¨å°æ—¶åˆ†åŒºç”Ÿæˆï¼Œæ¯ä¸ªå°æ—¶æœ«å°¾çš„è¯·æ±‚åŸ‹ç‚¹æœ‰å¯èƒ½æ˜¯è½åœ¨å½“å‰å°æ—¶ï¼Œä¹Ÿæœ‰å¯èƒ½è½åœ¨ä¸‹ä¸ªå°æ—¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼š19ç‚¹50åˆ†ä¸‹å‘äº†ä¸€ä¸ªè§†é¢‘ï¼Œå®¢æˆ·ç«¯åœ¨19:59åˆ†ç‚¹å‡»äº†ï¼Œä½†æ˜¯è§†é¢‘æ’­æ”¾å´æ˜¯åœ¨20ç‚¹03åˆ†å®Œæˆçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå­˜åœ¨æ‹¼æ¥ä¸ä¸Šçš„é—®é¢˜ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/28/280de17f347240ab7ba7ec4c7d4ce15f.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">2.2 åŸºäº Redis çš„æµå¼æ‹¼æ¥</h3>
<p>ä¸ºäº†æå‡æ‹¼æ¥ç‡ï¼Œä¸”è¾¾åˆ°å®æ—¶æ‹¼æ¥ï¼ŒèŠ‚ç‚¹æ•…éšœå®¹ç¾ï¼Œå®Œå¤‡ç›‘æ§ç­‰ç‰¹æ€§ï¼ŒFlinkæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯æœ€è¿‘å‡ å¹´æ¯”è¾ƒä¸»æµçš„å®ç°ã€‚æœ€åˆåœ¨å®æ—¶æ¨èåœºæ™¯ä¸­ï¼ŒKafkaä¸­çš„ç‰¹å¾å¿«ç…§é€šè¿‡Flinkä»»åŠ¡å†™å…¥åˆ°Redisï¼Œå¦ä¸€ä¸ªFlinkä»»åŠ¡æ¶ˆè´¹æ›å…‰åŸ‹ç‚¹æ•°æ®å’Œç‚¹å‡»åŸ‹ç‚¹æ•°æ®å¹¶è¯»å–å­˜åœ¨Redisä¸­çš„ç‰¹å¾å¿«ç…§æ•°æ®åšæ‹¼æ¥ï¼Œæ‹¼æ¥åçš„æ•°æ®ä½œä¸ºæ‹¼æ¥ç‰¹å¾è¢«å†™å…¥åˆ°ä¸‹æ¸¸çš„Kafkaä¸­ï¼Œæä¾›ç»™åç»­çš„ç®—æ³•åšæ¨¡å‹çš„è®­ç»ƒï¼Œæ¶æ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/4a/4a8bee8298f47869bc7732caf8960550.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç»è¿‡ä¸€æ®µæ—¶é—´å®è·µï¼Œä»¥ä¸Šçš„æ–¹æ¡ˆå‡ºç°äº†<strong>ä¸¤ä¸ªç—›ç‚¹ï¼š</strong></p>
<blockquote>
<ul>
<li>
<p>Redisä¸­å­˜å‚¨äº†å‡ åTçš„æ•°æ®ï¼ŒRedisçš„æˆæœ¬é«˜ï¼›</p>
</li>
<li>
<p>ä¸šåŠ¡æ•°æ®æµé‡ä¼šæ³¢åŠ¨ï¼Œç»å¸¸éœ€è¦DBAå¯¹Redisé›†ç¾¤è¿›è¡Œæ‰©å®¹ï¼Œæ¶‰åŠå¤§é‡æ•°æ®çš„è¿ç§»ï¼Œè¿ç»´æˆæœ¬é«˜ã€‚</p>
</li>
</ul>
</blockquote>
<h3 data-id="heading-4">2.3 åŸºäº RocksDB å¤§çŠ¶æ€æµå¼æ‹¼æ¥</h3>
<p>ä¸ºäº†è§£å†³åŸºäºRedisçš„ä½œä¸ºä¸­é—´æ•°æ®çš„å­˜å‚¨å­˜åœ¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨FlinkçŠ¶æ€æ¥å­˜å‚¨ç‰¹å¾å¿«ç…§ï¼Œæ•´ä¸ªæ¶æ„ä¸­ä¸å†éœ€è¦å¤–éƒ¨çš„Redisï¼Œç”±äºæˆ‘ä»¬éœ€è¦å­˜å‚¨çš„æ•°æ®é‡è¾¾å‡ åTï¼Œè¿™é‡Œæˆ‘ä»¬é€‰ç”¨é€‚åˆå¤§æ•°æ®é‡å­˜å‚¨çš„RocksDBç±»å‹çš„çŠ¶æ€åç«¯ï¼Œè°ƒæ•´åæ¶æ„æ›´åŠ ç®€æ´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/01/01317bf13236b42f1a7d450fe1fdca74.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æµç¨‹å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>
<p>é¦–å…ˆå°†æ›å…‰æµç‚¹ç‚¹å‡»æµä»¥åŠç‰¹å¾åœ¨Flink ä»»åŠ¡ä¸­åšunionå¹¶åškeybyï¼›</p>
</li>
<li>
<p>åœ¨processElementæ–¹æ³•ä¸­å¦‚æœæ¥æ”¶åˆ°æ›å…‰æµå°±å°†æ•°æ®ä¿å­˜åˆ°stateä¸­ï¼Œå¦‚æœæ¥æ”¶åˆ°æ›å…‰æµå°±å°†æ•°æ®ä¿å­˜åˆ°stateä¸­ï¼Œå¦‚æœæ¥æ”¶åˆ°ç‰¹å¾å°±å»stateä¸­æŸ¥è¯¢ç›¸åº”çš„æ›å…‰å’Œç‚¹å‡»æ•°æ®ï¼›</p>
</li>
<li>
<p>å¦‚æœèƒ½æ‰¾åˆ°å°±å‘é€åˆ°ä¸‹æ¸¸å¹¶å°†çŠ¶æ€æ•°æ®æ¸…ç†æ‰ï¼Œæ²¡æ‰¾åˆ°å°±å°†ç‰¹å¾ä¿å­˜åˆ°stateä¸­ï¼Œå¹¶æ³¨å†Œä¸€ä¸ªå®šæ—¶å™¨ï¼›</p>
</li>
<li>
<p>å®šæ—¶å™¨è§¦å‘æ—¶å»stateä¸­æŸ¥è¯¢ç›¸åº”çš„æ›å…‰å’Œç‚¹å‡»æ•°æ®ï¼Œå¦‚æœæ‰¾åˆ°å°±å‘åˆ°ä¸‹æ¸¸ï¼Œå¹¶å°†çŠ¶æ€æ•°æ®æ¸…ç†æ‰ã€‚</p>
</li>
</ul>
</blockquote>
<p>ç”±äºRocksDBå¯ä»¥åŒæ—¶åˆ©ç”¨å†…å­˜å’Œç£ç›˜æ¥å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥å¯¹äºå†…å­˜çš„ä½¿ç”¨é‡å¤§å¹…ä¸‹é™ï¼Œç”±äºRocksDBæ˜¯åµŒå…¥å¼çš„æ•°æ®åº“ï¼Œæ¯ä¸ªTMä¸Šçš„RocksDBæ•°æ®åº“åªå­˜å‚¨shuffeåˆ°è¯¥TMä¸Šçš„æ•°æ®ï¼Œæ— éœ€å†å…³æ³¨æ‰©ç¼©å®¹çš„é—®é¢˜ã€‚å½“ç„¶éšç€æ•°æ®ä¸Šæ¶¨ï¼ŒFlinkæµå¼æ‹¼æ¥åœ¨å®é™…çš„ç”Ÿäº§è¿‡ç¨‹ä¸­ä¹Ÿé‡åˆ°äº†ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œä¸ºäº†ä¿è¯ä¸šåŠ¡çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬èŠ±äº†è¾ƒé•¿çš„æ—¶é—´å¯¹è¿™äº›é—®é¢˜è¿›è¡Œæ”»å…‹ï¼Œç›®å‰ä»»åŠ¡ç¨³å®šæ€§è¾¾åˆ°99.99% ï¼Œæ‹¼æ¥ç‡é•¿æœŸç¨³å®šåœ¨99%ä»¥ä¸Šï¼Œå¯¹æ‹¼æ¥æ•ˆæœæå‡è¾ƒå¤§ã€‚ä¸‹é¢æˆ‘å°†åˆ—ä¸¾æˆ‘ä»¬é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°ä¸šå†…çš„å…¶ä»–å›¢é˜Ÿã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-6">3.1 TM Losté—®é¢˜</h3>
<h4 data-id="heading-7">3.1.1 ç°è±¡</h4>
<p>åœ¨æ–¹æ¡ˆå®æ–½ä¹‹åˆï¼Œæˆ‘ä»¬å‘ç°è¿™äº›ç‰¹å¾æ‹¼æ¥çš„ä»»åŠ¡é¢‘ç¹å‡ºç°TM was Lostå¼‚å¸¸å¯¼è‡´ä»»åŠ¡é‡å¯ï¼Œæˆ‘ä»¬çœ‹äº†æ—¥å¿—ï¼Œå‘ç°éƒ½æ˜¯TMå†…å­˜è¶…å‡ºäº†YARNçš„å†…å­˜é™åˆ¶è¢«killã€‚</p>
<h4 data-id="heading-8">3.1.2 é—®é¢˜åˆ†æ</h4>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„ç–‘é—®å°±æ¥äº†ï¼Œä¸ºå•¥è¿™éƒ¨åˆ†ä»»åŠ¡çš„å†…å­˜å¾ˆå®¹æ˜“è¶…å‡ºï¼Œè¶…å‡ºçš„é‚£éƒ¨åˆ†å†…å­˜åˆæ˜¯è°åœ¨ç”¨å‘¢ï¼Ÿä¸‹é¢è¿™å¼ å›¾æ˜¯æ¥è‡ªFlinkçš„å®˜ç½‘ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å¹³å°ä½¿ç”¨Flinkçš„æ—¶ï¼Œæˆ‘ä»¬åªè®¾ç½®äº†æ€»çš„å†…å­˜ï¼Œå¹¶æ²¡æœ‰å…³æ³¨å…¶ä»–å„ä¸ªå±€éƒ¨çš„å†…å­˜ï¼Œé‚£ä¹ˆè¿™äº›éƒ¨ä½çš„å†…å­˜æ˜¯å¦‚ä½•åˆ†é…çš„ï¼Ÿä¸ºäº†ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œæœ‰å¿…è¦æ¢³ç†ä¸€ä¸‹æ¯ä¸ªæ¨¡å—å†…å­˜è®¡ç®—çš„é€»è¾‘ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/dd/ddc1ee12f23304a440712c0aba4b0dba.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnightlies.apache.org%2Fflink%2Fflink-docs-master%2Fdocs%2Fdeployment%2Fmemory%2Fmem_setup_tm" target="_blank" title="https://nightlies.apache.org/flink/flink-docs-master/docs/deployment/memory/mem_setup_tm" ref="nofollow noopener noreferrer">å›¾ç‰‡å¼•ç”¨è‡ªFlink</a></p>
<p><strong>Flinkå†…å­˜åˆ†é…é€»è¾‘</strong></p>
<p>ä¸€èˆ¬åœ¨YARNä¸Šæäº¤çš„ä»»åŠ¡æ˜¯å«æœ‰taskmanager.memory.process.size å‚æ•°çš„é…ç½®çš„ï¼Œæ‰€ä»¥Flinkåœ¨åˆ†é…å†…å­˜æ—¶ï¼Œä¼šä»¥è°ƒç”¨deriveProcessSpecWithTotalProcessMemory æ–¹æ³•åˆ†é…ã€‚</p>
<p>é€šè¿‡é…ç½®å‚æ•°è·å¾—meatspace çš„å¤§å°ï¼Œé€šè¿‡jobmanager.memory.jvm-overhead.fraction çš„æ¯”ä¾‹è®¡ç®—overheadçš„å†…å­˜ï¼ŒtotalFlinkMemoryé€šè¿‡æ€»çš„è¿›ç¨‹çš„å†…å­˜å‡å»meatspace + overheadçš„å†…å­˜å¾—åˆ°ã€‚</p>
<p>é€šè¿‡é…ç½®ä¸­çš„å‚æ•°è·å– frameworkHeapMemory-</p>
<p>Sizeã€frameworkOffHeapMemorySize ã€task-</p>
<p>OffHeapMemorySize çš„å¤§å°ã€‚</p>
<p>é€šè¿‡managedmemoryçš„é…ç½®è·å–æ‰˜ç®¡å†…å­˜çš„å€¼ï¼Œ é€šè¿‡networkbufferçš„é…ç½®è·å–networkbufferçš„å€¼ ã€‚totalFlinkMemory å‡å»æ‰€æœ‰éœ€è¦æ’é™¤çš„å†…å­˜ï¼Œå‰©ä¸‹çš„å†…å­˜åˆ†é…ç»™å †ã€‚å†…å­˜åˆ†é…é€»è¾‘ï¼Œä»¥åŠæ¯å—å†…å­˜çš„è®¾ç½®æ–¹æ³•å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/98/9850896065a8e3bb60a78aa433f45e1d.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åˆ°æ­¤TMçš„å„ä¸ªå†…å­˜æ¨¡å—çš„å†…å­˜å·²ç»åˆ’åˆ†å®Œæˆã€‚æœ‰ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹çš„ç»“è®ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">totalProcessMemorySize</span> = totalFlinkMemorySize + JvmMetaspaceSize + JvmOverheadSize
<span class="hljs-attr">totalFlinkMemorySize</span>  = framework<span class="hljs-literal">Off</span>HeapMemorySize + task<span class="hljs-literal">Off</span>HeapMemorySize + managedMemorySize + networkMemorySize + frameworkHeapMemorySize + taskHeapMemorySize
</code></pre>
<p><img alt="" src="" loading="lazy"/><img alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" src="" loading="lazy"/></p>
<p>è¿™é‡Œé‡ç‚¹å°†ä¸€ä¸‹JVMOverheadï¼ŒJVMOverheadå¹¶æ²¡æœ‰å…·ä½“çš„ä½œç”¨ï¼Œæ˜¯ä¸€ä¸ªé¢„ç•™å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªç¼“å†²åŒºï¼Œå¯ä»¥é¿å…åœ¨Flinkè¿è¡Œåœ¨å®¹å™¨ä¸­æ˜¯å› ä¸ºçŸ­æ—¶æ—¶é—´çš„å†…å­˜è¶…å‡ºäº†å®¹å™¨çš„é™åˆ¶è€Œè¢«killã€‚</p>
<p>frameworkOffHeapMemorySizeå’ŒtaskOff-</p>
<p>HeapMemorySize ä¹Ÿæ˜¯é¢„ç•™å€¼ï¼Œoffheapåœ¨æ¦‚å¿µä¸Šçš„ä¸»è¦æ˜¯æŒ‡nativeå†…å­˜ã€‚frameworkHeap-</p>
<p>MemorySize ä¹Ÿæ˜¯é¢„ç•™å€¼ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºè™½ç„¶Flinkå®˜æ–¹å°†TMçš„å†…å­˜åˆ’åˆ†çš„è¾ƒç»†è‡´ï¼Œä½†æ˜¯åƒJvmOverheadSize frameworkOffHeap-</p>
<p>MemorySizeï¼ŒtaskOffHeapMemorySizeï¼Œ</p>
<p>frameworkHeapMemorySize éƒ½åªæ˜¯é€»è¾‘ä¸Šçš„é¢„ç•™ï¼Œå¹¶æ²¡æœ‰ä»æ“ä½œç³»ç»Ÿå±‚é¢å®ç°éš”ç¦»ã€‚</p>
<p><strong>RocksDBå†…å­˜åˆ†é…é€»è¾‘</strong></p>
<p>å› ä¸ºå †å†…å­˜ä¸è¶³æ—¶ä¸€èˆ¬ä¼šæŠ¥out of memoryçš„å¼‚å¸¸ï¼Œæ‰€ä»¥åˆ°è¿™ä¸€æ­¥æˆ‘ä»¬æ¨æµ‹åº”è¯¥æ˜¯å †å¤–å†…å­˜æº¢å‡ºäº†ï¼Œè€Œå †å¤–å†…å­˜æœ€å¤§çš„ä¸€å—å°±æ˜¯RocksDBä½¿ç”¨çš„ï¼Œè€Œä»Flinkçš„å®˜ç½‘çš„ä»‹ç»å¯ä»¥çŸ¥é“æ‰˜ç®¡å†…å­˜å°±æ˜¯ç»™RocksDBä½¿ç”¨çš„ï¼Œä¸‹é¢æˆ‘ä»¬å†çœ‹ä¸€ä¸‹æ‰˜ç®¡å†…å­˜æ˜¯å¦‚ä½•åˆ†é…ç»™RocksDBçš„ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">cacheMemory</span> = ï¼ˆ<span class="hljs-number">1</span>-ï¼ˆ<span class="hljs-number">1</span>/<span class="hljs-number">3</span>ï¼‰*ï¼ˆwriteBufferRatioï¼‰ï¼‰* managedMemory
<span class="hljs-attr">bufferMemory</span> = ï¼ˆ<span class="hljs-number">2</span>/<span class="hljs-number">3</span>ï¼‰*ï¼ˆwriteBufferRatioï¼‰* managedMemory
è¯»å†™ç¼“å­˜æ€»å†…å­˜ =  bufferMemory + <span class="hljs-attr">cacheMemory</span> = ï¼ˆ<span class="hljs-number">1</span> +ï¼ˆ<span class="hljs-number">1</span>/<span class="hljs-number">3</span>ï¼‰*ï¼ˆwriteBufferRatioï¼‰ï¼‰* managedMemory
</code></pre>
<p><img alt="" src="" loading="lazy"/><img alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" src="" loading="lazy"/></p>
<p>ç”±ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œmanaged memory æ˜¯é€šè¿‡ä¸€å®šçš„æ¯”ä¾‹ç»™RocksDBçš„å„ä¸ªéƒ¨åˆ†æ¥åˆ†é…å†…å­˜çš„ï¼ŒwriteBufferRatioä¼šå½±å“è¯»ç¼“å­˜å’Œå†™ç¼“å­˜çš„å¤§å°ï¼Œç†è®ºä¸Šè¯»å†™ç¼“å­˜æ€»å†…å­˜æœ‰å¯èƒ½ä¼šè¶…è¿‡managedMemoryçš„å¤§å°ã€‚é€šè¿‡ä¸Šé¢çš„å…¬å¼å¯ä»¥çœ‹å‡ºè¯»å†™ç¼“å­˜æ€»å†…å­˜æœ€å¤šè¶…å‡ºmanagedMemoryçš„1/3ï¼Œè¿™é‡Œå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ’æŸ¥overheadçš„æ—¶å€™é…ç½®å¤§äºmanagedMemoryçš„1/3ä¸å°±èƒ½ä½ é¢å†…å­˜æº¢å‡ºäº†ï¼Œä½†æ˜¯åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬è¿™æ ·é…ç½®å¹¶å¹¶æ²¡æœ‰å®Œå…¨çš„è§£å†³ç‰©ç†å†…å­˜æº¢å‡ºçš„é—®é¢˜ï¼Œä¸‹é¢å…³äºRocksDBå†…å­˜çš„èµ„æ–™ï¼Œç»ˆäºæ‰¾åˆ°äº†æ˜¯è¿˜æœ‰å“ªéƒ¨åˆ†å†…å­˜å®¹æ˜“æº¢å‡ºäº†ï¼Œæ˜¯å› ä¸ºéƒ¨åˆ†åŒºåŸŸçš„å†…å­˜éš¾ä»¥é™åˆ¶å¯¼è‡´çš„ã€‚</p>
<p>RocksDB çš„å†…å­˜å ç”¨æœ‰ 4 ä¸ªéƒ¨åˆ†:</p>
<blockquote>
<ul>
<li>
<p>Block Cache: OS PageCache ä¹‹ä¸Šçš„ä¸€å±‚ç¼“å­˜ï¼Œç¼“å­˜æœªå‹ç¼©çš„æ•°æ® Blockï¼›</p>
</li>
<li>
<p>Indexes and filter blocks: ç´¢å¼•åŠå¸ƒéš†è¿‡æ»¤å™¨ï¼Œç”¨äºä¼˜åŒ–è¯»æ€§èƒ½ï¼›</p>
</li>
<li>
<p>MemTable: ç±»ä¼¼å†™ç¼“å­˜ï¼›</p>
</li>
<li>
<p>Blocks pinned by Iterator: è§¦å‘ RocksDB éå†æ“ä½œï¼ˆæ¯”å¦‚éå† RocksDBMapState çš„æ‰€æœ‰ keyï¼‰æ—¶ï¼ŒIterator åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ä¼šé˜»æ­¢å…¶å¼•ç”¨åˆ°çš„ Block å’Œ MemTable è¢«é‡Šæ”¾ï¼Œå¯¼è‡´é¢å¤–çš„å†…å­˜å ç”¨ã€‚</p>
</li>
</ul>
</blockquote>
<p>å‰ä¸‰ä¸ªåŒºåŸŸçš„å†…å­˜éƒ½æ˜¯å¯é…ç½®çš„ï¼Œä½† Iterator é”å®šçš„èµ„æºåˆ™è¦å–å†³äºåº”ç”¨ä¸šåŠ¡ä½¿ç”¨æ¨¡å¼ï¼Œä¸”æ²¡æœ‰æä¾›ä¸€ä¸ªç¡¬é™åˆ¶ï¼Œå› æ­¤ Flink åœ¨è®¡ç®— RocksDB StateBackend å†…å­˜æ—¶æ²¡æœ‰å°†è¿™éƒ¨åˆ†çº³å…¥è€ƒè™‘ï¼Œå…¶æ¬¡æ˜¯ RocksDB Block Cache çš„ä¸€ä¸ª bugï¼Œå®ƒä¼šå¯¼è‡´ Cache å¤§å°æ— æ³•ä¸¥æ ¼æ§åˆ¶ï¼Œæœ‰å¯èƒ½çŸ­æ—¶é—´å†…è¶…å‡ºè®¾ç½®çš„å†…å­˜å®¹é‡ï¼Œç›¸å½“äºè½¯é™åˆ¶ï¼ŒåŸæ¥æ˜¯è¿­ä»£å™¨çš„å†…å­˜é™åˆ¶çš„ä¸å¥½ï¼Œå¯¼è‡´çš„å†…å­˜æº¢å‡ºã€‚</p>
<h4 data-id="heading-9">3.1.3 è§£å†³æ–¹æ¡ˆ</h4>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨Flink çš„RocksDBçŠ¶æ€åç«¯æ—¶ï¼Œæ˜¯é€šè¿‡managed memoryæ¥æ§åˆ¶RocksDBå„ä¸ªéƒ¨åˆ†çš„å†…å­˜çš„ï¼Œæ‰€ä»¥managed memoryå†…å­˜è¶Šå°åˆ†é…ç»™å„ä¸ªéƒ¨åˆ†çš„å†…å­˜ä¹Ÿå°±è¶Šå°ï¼Œè¿­ä»£å™¨å†…å­˜è¶Šä¸å®¹æ˜“æº¢å‡ºã€‚åˆ°æ­¤æˆ‘ä»¬å¯¹Flinkçš„RocksDBçŠ¶æ€åç«¯çš„å†…å­˜æœ‰äº†ä¸€å®šçš„è®¤çŸ¥ï¼šå½“æ€§èƒ½å¯ä»¥æ»¡è¶³çš„æƒ…å†µä¸‹ï¼ŒFlinkçš„Manaed memoryåº”è¯¥è¶Šå°è¶Šå¥½ã€‚ä½†æ˜¯ä¸Šæ»¡å½¢æˆçš„ç»éªŒå¾ˆéš¾é«˜æ•ˆçš„åœ¨ä¸šåŠ¡ä¸Šè½åœ°ï¼ŒåŸå› æ˜¯â€œFlinkçš„Manaed memoryåº”è¯¥è¶Šå°è¶Šå¥½â€å¾ˆéš¾å»ç¡®å®šã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬è”æƒ³åˆ°äº†ä¹‹å‰çš„JVMoverheadï¼Œåœ¨æˆ‘ä»¬çš„å®é™…å®è·µä¸­è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡è°ƒå¤§JVMoverheadï¼Œå’Œjemallocå†…å­˜åˆ†é…å™¨æ¥è§£å†³å†…å­˜æº¢å‡ºé—®é¢˜çš„ã€‚åœ¨Flink1.12ä¹‹åFlink on k8sçš„å†…å­˜åˆ†é…å™¨å·²ç»é»˜è®¤æ”¹æˆäº†jemallocï¼Œå¯ä»¥é¿å…å†…å­˜çš„åˆ†é…è¿‡ç¨‹ä¸­å‡ºç°64Mé—®é¢˜ã€‚</p>
<p>ä½†æ˜¯è¦æ³¨æ„ï¼šç”±äºæˆ‘ä»¬çš„Javaç‰ˆæœ¬æ˜¯JAVA8å°ç‰ˆæœ¬æ˜¯192ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬çš„jemalloc5.3ä¸Šå‡ºç°äº†æ­»é”çš„é—®é¢˜ï¼Œåæ¥æˆ‘ä»¬é‡‡ç”¨jemalloc4.5 å°±æ²¡æœ‰é—®é¢˜äº†ã€‚æ®äº†è§£ä¸šç•Œæœ‰äº›å…¬å¸ä½¿ç”¨çš„JAVA8å°ç‰ˆæœ¬æ˜¯256é‡‡ç”¨jemalloc5.3æ²¡æœ‰é‡åˆ°æ­»é”é—®é¢˜ã€‚</p>
<h3 data-id="heading-10">3.2 RocksDB çš„æ€§èƒ½ç›‘æ§é—®é¢˜</h3>
<h4 data-id="heading-11">3.2.1 ç°è±¡</h4>
<p>Flink RocksDBå¤§çŠ¶æ€çš„ä»»åŠ¡ç»å¸¸å‡ºç°å»¶è¿Ÿï¼Œä½†æ˜¯æˆ‘ä»¬å¾ˆéš¾çŸ¥é“æ€§èƒ½çš„ç“¶é¢ˆåœ¨å“ªå—ï¼Œä»è€Œä¼˜åŒ–å“åº”çš„ç¯èŠ‚ã€‚</p>
<h4 data-id="heading-12">3.2.2 è§£å†³æ–¹æ¡ˆ</h4>
<p>å…¶å®Flinkæä¾›äº†ä¸€ç³»åˆ—å¯¹äºRocksDBçš„æ€§èƒ½çš„ç›‘æ§æŒ‡æ ‡ï¼Œæˆ‘ä»¬åªéœ€è¦åŠ ä¸Šå‚æ•°å¼€å¯å³å¯ï¼Œè¿™é‡Œæˆ‘åªç»“å±€æˆ‘è§‰å¾—æœ€æœ‰å‚è€ƒæ„ä¹‰çš„æŒ‡æ ‡å¼€å¯çš„å‚æ•°ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/e0/e01cb49221cf60f362090e0e2801cd44.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸‹é¢æ˜¯ç›¸å…³æŒ‡æ ‡çš„ç›‘æ§é¡µé¢ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/d1/d1404b9aa08dcae8ea3aaff068872d6e.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://static001.geekbang.org/infoq/39/39ca400998d4d6222ac7b82e0695d72e.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-13">3.3 ä»»åŠ¡å‡ºç°å»¶è¿Ÿ</h3>
<h4 data-id="heading-14">3.3.1 ç°è±¡</h4>
<p>Flink RocksDBå¤§çŠ¶æ€çš„ä»»åŠ¡ç»å¸¸å‡ºç°å»¶è¿Ÿï¼Œè°ƒä¼˜å‚æ•°é«˜è¾¾è¿‘ç™¾ä¸ªï¼Œå¦‚ä½•ç³»ç»Ÿæ€§çš„è°ƒä¼˜ï¼Œéš¾åº¦è¾ƒå¤§ã€‚</p>
<h4 data-id="heading-15">3.3.2 è§£å†³æ–¹æ¡ˆ</h4>
<p>è¦æƒ³å¯¹RocksDBçš„æ€§èƒ½åšä¼˜åŒ–ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆäº†è§£ä¸€ä¸‹RocksDBçš„è¯»å†™æµç¨‹ã€‚</p>
<p><strong>RocksDBçš„è¯»æµç¨‹</strong></p>
<p><img src="https://static001.geekbang.org/infoq/3f/3f67f6e900780ee1fc52bccd62e2e359.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>
<p>è·å–å½“å‰æ—¶åˆ»çš„SuperVersionï¼ŒSuperVersionæ˜¯RocksDBå†…é’ˆå¯¹äºæ‰€æœ‰SSTæ–‡ä»¶åˆ—è¡¨ä»¥åŠå†…å­˜ä¸­çš„MemTableå’ŒImmutable MemTableçš„ä¸€ä¸ªç‰ˆæœ¬ï¼›</p>
</li>
<li>
<p>è·å–å½“å‰çš„åºå·æ¥å†³å®šå½“å‰è¯»æ“ä½œä¾èµ–çš„æ•°æ®å¿«ç…§ï¼›</p>
</li>
<li>
<p>å°è¯•ä»ç¬¬ä¸€æ­¥SuperVersionä¸­å¼•ç”¨çš„MemTableä»¥åŠImmutable MemTableä¸­è·å–å¯¹åº”çš„å€¼ã€‚é¦–å…ˆä¼šç»è¿‡å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå‡å¦‚ä¸å­˜åœ¨åˆ™ä¸€å®šä¸å­˜åœ¨ï¼Œåä¹‹å‡å¦‚è¿”å›å­˜åœ¨åˆ™ä¸ä¸€å®šå­˜åœ¨ï¼›</p>
</li>
<li>
<p>å°è¯•ä»Block Cacheä¸­è¯»å–ï¼›</p>
</li>
<li>
<p>å°è¯•ä»SSTæ–‡ä»¶ä¸­è·å–ã€‚</p>
</li>
</ul>
<p><strong>RocksDBçš„å†™æµç¨‹</strong></p>
<p><img src="https://static001.geekbang.org/infoq/29/29664abe3274655acc4ae42695f9f142.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>
<p>å°†å†™å…¥æ“ä½œé¡ºåºå†™å…¥WALæ—¥å¿—ä¸­ï¼Œæ¥ä¸‹æ¥æŠŠæ•°æ®å†™åˆ° MemTableä¸­ï¼ˆé‡‡ç”¨SkipListç»“æ„å®ç°ï¼‰</p>
<p>MemTableè¾¾åˆ°ä¸€å®šå¤§å°åï¼Œå°†è¿™ä¸ª MemTable åˆ‡æ¢ä¸ºä¸å¯æ›´æ”¹çš„ immutable MemTableï¼Œå¹¶æ–°å¼€ä¸€ä¸ª MemTable æ¥æ”¶æ–°çš„å†™å…¥è¯·æ±‚ï¼›</p>
</li>
<li>
<p>è¿™ä¸ª immutable MemTableè¿›è¡ŒæŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæˆä¸ºL0 å±‚çš„ SSTable æ–‡ä»¶ï¼›</p>
</li>
<li>
<p>æ¯ä¸€å±‚çš„æ‰€æœ‰æ–‡ä»¶æ€»å¤§å°æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ¯ä¸‹ä¸€å±‚å¤§åå€ã€‚ä¸€æ—¦æŸä¸€å±‚çš„æ€»å¤§å°è¶…è¿‡é˜ˆå€¼äº†ï¼Œå°±é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å’Œä¸‹ä¸€å±‚çš„æ–‡ä»¶åˆå¹¶ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> æ‰€æœ‰ä¸‹ä¸€å±‚è¢«å½±å“åˆ°çš„æ–‡ä»¶éƒ½ä¼šå‚ä¸ Compactionã€‚åˆå¹¶ä¹‹åï¼Œä¿è¯ L1 åˆ° L6 å±‚çš„æ¯ä¸€å±‚çš„æ•°æ®éƒ½æ˜¯åœ¨ key ä¸Šå…¨å±€æœ‰åºçš„ï¼Œè€Œ L0 å±‚æ˜¯å¯ä»¥æœ‰é‡å çš„ï¼Œå†™æµç¨‹çš„çº¦æŸï¼›</p>
</li>
<li>
<p>æ—¥å¿—æ–‡ä»¶ç”¨äºå´©æºƒæ¢å¤ï¼›</p>
</li>
<li>
<p>æ¯ä¸ªMemTableåŠSSTæ–‡ä»¶ä¸­çš„Keyéƒ½æ˜¯æœ‰åºçš„ï¼ˆå­—ç¬¦é¡ºåºçš„å‡åºï¼‰ï¼›</p>
</li>
<li>
<p>æ—¥å¿—æ–‡ä»¶ä¸­çš„Keyæ˜¯æ— åºçš„ï¼›</p>
</li>
<li>
<p>åˆ é™¤æ“ä½œæ˜¯æ ‡è®°åˆ é™¤ï¼Œæ˜¯æ’å…¥æ“ä½œçš„ä¸€ç§ï¼ŒçœŸæ­£çš„åˆ é™¤è¦åœ¨Compactionçš„æ—¶å€™å®ç°ï¼›</p>
</li>
<li>
<p>æ— æ›´æ–°å®ç°ï¼Œè®°å½•æ›´æ–°é€šè¿‡æ’å…¥ä¸€æ¡æ–°è®°å½•å®ç°ï¼›</p>
</li>
</ul>
<p>å½“ä»»åŠ¡å‡ºç°å»¶è¿Ÿæ—¶ï¼Œç”±äºæˆ‘ä»¬å·²ç»æœ‰äº†RocksDBæ€§èƒ½æŒ‡æ ‡çš„ç›‘æ§ä¹Ÿäº†è§£RocksDBçš„åŸç†ï¼Œæˆ‘ä»¬åœ¨åšæ€§èƒ½ä¼˜åŒ–æ—¶å°±å¯ä»¥å¯¹ç—‡ä¸‹è¯äº†ã€‚</p>
<p><strong>è¯»æ€§èƒ½ä¼˜åŒ–</strong></p>
<p>å½“ä»»åŠ¡å‡ºç°å»¶è¿Ÿä¸”å—ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™æ—¶ï¼Œè¯´æ˜æ˜¯è¯»çš„æ€§èƒ½ä¸‹é™å¯¼è‡´å»¶è¿Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æå‡ç¼“å­˜å‘½ä¸­ç‡çš„æ–¹å¼æ¥æå‡è¯»æ€§èƒ½ï¼ŒRocksDBä»»åŠ¡ç¼“å­˜å‘½ä¸­ç‡çš„ä¼˜åŒ–<strong>æ€è·¯å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<p>æ‰˜ç®¡å†…å­˜å°äºTMå†…å­˜20%ï¼Œå¯ä»¥è°ƒå¤§æ‰˜ç®¡å†…å­˜ï¼šstate.backend.rocksdb.memory.managed åˆ° 20%ï¼›</p>
</li>
<li>
<p>Flinkå†…éƒ¨å¯¹RocksDBçš„ä¼˜åŒ–å·²ç»æ²‰æ·€äº†å¤šç»„å‚æ•°ï¼Œå»ºè®®ä½¿ç”¨é…ç½®ï¼š</p>
</li>
</ul>
<p>state.backend.rocksdb.predefined-options =</p>
<p>SPINNING_DISK_OPTIMIZED_HIGH_MEMï¼›</p>
<ul>
<li>Flinkä¸­ä½¿ç”¨state.backend.rocksdb.memory</li>
</ul>
<p>.write-buffer-ratioå‚æ•°æ¥ç®¡ç†å†™ç¼“å­˜ï¼Œè°ƒå°è¯¥å‚æ•°ï¼Œèƒ½å¤Ÿæå‡è¯»ç¼“å­˜ï¼Œè¯¥å‚æ•°é»˜è®¤0.5ï¼›</p>
<ul>
<li>RocksDB ä¼šæœ‰ä¸€å†™ç´¢å¼•å’Œè¿‡æ»¤å™¨æ”¾åœ¨å†…å­˜ä¸­ï¼Œç”¨è¿™ä¸ªå‚æ•°å¼€å¯ï¼šstate.backend.rocksdb</li>
</ul>
<p>.memory.partitioned-index-filters é»˜è®¤ falseï¼Œå¹¶ä¸”å¯ä»¥è°ƒèŠ‚ç´¢å¼•å’Œè¿‡æ»¤å™¨å ç”¨çš„å†…å­˜æ¯”ä¾‹ï¼Œå‚æ•°æ˜¯ï¼šstate.backend.rocksdb.memory</p>
<p>.high-prio-pool-ratioé»˜è®¤ä¸º0.1ã€‚</p>
<p><strong>å†™æ€§èƒ½ä¼˜åŒ–</strong></p>
<p>å½“ä»»åŠ¡å»¶è¿Ÿï¼Œå¦‚æœå‡ºç°ç­‰å¾…flushçš„å†…å­˜è¡¨çš„å¤§å°å¢åŠ ï¼Œæˆ–è€…ç­‰å¾…åˆå¹¶çš„ä¸ªæ•°å¢åŠ ï¼Œå› ä¸ºç­‰å¸¦flushä¸ªæ•°è¾¾åˆ°ä¸€å®šçš„ä¸ªæ•°æ—¶å†™å°†ä¼šè¢«é˜»å¡ï¼Œå¯ä»¥å…ˆå…³æ³¨ä¸€ä¸‹ç£ç›˜ioæ˜¯å¦æ‰“æ»¡ï¼Œå¦‚æœå·²ç»å¤„äºé«˜ä½ï¼Œå»ºè®®æå‡ä»»åŠ¡çš„å¹¶å‘ã€‚å¦‚æœæ­¤ç£ç›˜ioå¤„äºä½ä½ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´flushå’Œcompationçš„çº¿ç¨‹æ•°æ¥ä½¿å†™çš„æ•°æ®ä¸å†ç§¯å‹ã€‚æå‡å†™å†™æ€§èƒ½ã€‚Flinkä¼šå°†flushå’Œcompationçš„çº¿ç¨‹æ•°é€šè¿‡ä¸€ä¸ªå‚æ•°ç»Ÿä¸€ç®¡ç†ï¼Œå‚æ•°æ˜¯ï¼šstate.backend</p>
<p>.rocksdb.thread.numï¼Œé»˜è®¤å€¼æ˜¯1ã€‚</p>
<h3 data-id="heading-16">3.4 ä»»åŠ¡å¯åŠ¨æ…¢çš„é—®é¢˜</h3>
<h4 data-id="heading-17">3.4.1 ç°è±¡</h4>
<p>ç”±äºFlinkä»»åŠ¡åœ¨ä»çŠ¶æ€å¯åŠ¨æ—¶éœ€è¦å°†å­˜å‚¨åœ¨è¿œç¨‹HDFSçš„çŠ¶æ€æ–‡ä»¶è¯»åˆ°æœ¬åœ°ï¼Œå½“TMè¾ƒé›†ä¸­æ—¶å•å°æœºå™¨çš„ç£ç›˜ioå¾ˆå®¹æ˜“è¢«æ‰“æ»¡ï¼Œå¯¼è‡´æŸäº›sub task é•¿æ—¶é—´å¤„äºINITIALIZINGçš„çŠ¶æ€ã€‚</p>
<h4 data-id="heading-18">3.4.2 è§£å†³æ–¹æ¡ˆ</h4>
<p><strong>YARNå‚æ•°çš„ä¼˜åŒ–</strong></p>
<p>YARNé»˜è®¤çš„yarn.scheduler.fair.assignmultipleå‚æ•°ä¸ºflaseï¼Œå³ä¸€æ¬¡åªåˆ†é…ä¸€ä¸ªcontainerï¼Œä½†æ˜¯CDHå°†è¿™ä¸ªå‚æ•°è®¾ç½®æˆäº†trueï¼Œyarn.scheduler.fair.max.assigré»˜è®¤ä¸º-1ï¼Œè¡¨ç¤ºä¸é™åˆ¶ï¼Œæ‰€ä»¥å¯¼è‡´ä¸€æ¬¡è°ƒåº¦åˆ°å•ä¸ªèŠ‚ç‚¹ä¸Šçš„containerè¾ƒå¤šã€‚æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†YARNé…ç½®ä¸­çš„yarn.scheduler.fair.assignmultipleå‚æ•°è®¾ä¸ºfalseï¼Œä¸€æ¬¡åªè°ƒåº¦ä¸€ä¸ªcontainerï¼Œè§£å†³äº†TMåˆ†é…è¾ƒé›†ä¸­çš„é—®é¢˜ã€‚</p>
<p><strong>Flinkè°ƒåº¦ç­–ç•¥çš„ä¼˜åŒ–</strong></p>
<p>ç”±äºåªæ˜¯é™åˆ¶äº†æ¯æ¬¡åˆ†é…TMçš„ä¸ªæ•°ï¼Œè¿˜ä¸èƒ½å®Œå…¨é¿å…åˆ†é…é›†ä¸­çš„é—®é¢˜ï¼Œäºæ˜¯æˆ‘ä»¬å¯¹Flinkå¼•æ“å†…éƒ¨åšäº†ä¼˜åŒ–ï¼Œå¯ä»¥ç¡¬é™åˆ¶åœ¨æŸå°æœºå™¨ä¸Šè°ƒåº¦TMçš„ä¸ªæ•°ï¼Œå…·ä½“åšæ³•æ˜¯ï¼Œæ˜¯å½“YARNè¿”å›ç»™Flink ResourceManager containerä¿¡æ¯æ—¶ï¼Œåˆ¤æ–­containeræ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå¦‚æœä¸ç¬¦åˆå¯ä»¥éƒ¨åˆ†æ‹’æ”¶ï¼Œå†æ¬¡ç”³è¯·èµ„æºï¼Œè¯¥åŠŸèƒ½ç”±å‚æ•°å¼€å¯ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/16/16a7fa6dc4c5ac2babd329e3c41c33c9.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-19">3.5 ç£ç›˜æ‰“æ»¡çš„é—®é¢˜</h3>
<h4 data-id="heading-20">3.5.1 ç°è±¡</h4>
<p>ç”±äºæˆ‘ä»¬å®æ—¶é›†ç¾¤çš„ç£ç›˜è¾ƒå°ï¼Œå¤§çŠ¶æ€ä»»åŠ¡çš„çŠ¶æ€è¾¾å‡ åä¸Šç™¾Tï¼Œé¢‘ç¹å‡ºç°ç£ç›˜ä½¿ç”¨ç‡è¾¾åˆ°90%çš„å‘Šè­¦ã€‚</p>
<h4 data-id="heading-21">3.5.2 è§£å†³æ–¹æ¡ˆ</h4>
<p>æˆ‘ä»¬å°†å¤§çŠ¶æ€çš„ä»»åŠ¡çš„Checkpointæ•°æ®å­˜å‚¨åˆ°ç£ç›˜èµ„æºè¾ƒå®½è£•çš„ç¦»çº¿çš„é›†ç¾¤ï¼Œéå¤§çŠ¶æ€çš„ä»»åŠ¡çš„Checkpointæ•°æ®å­˜å‚¨åœ¨å®æ—¶é›†ç¾¤ã€‚</p>
<h3 data-id="heading-22">3.6 HDFS RPC é£™é«˜é—®é¢˜</h3>
<h4 data-id="heading-23">3.6.1 ç°è±¡</h4>
<p>åœ¨ä¸šåŠ¡æ–°ä¸Šä¸€æ‰¹ä»»åŠ¡åï¼Œæˆ‘ä»¬å‘ç°ç¦»çº¿é›†ç¾¤HDFSçš„RPCæœ‰æ˜æ˜¾çš„å¢åŠ ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/4c/4ca61c00d9c2bc4484c5b10302c79c41.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-24">3.6.2 è§£å†³æ–¹æ¡ˆ</h4>
<p>ç”±äºæˆ‘ä»¬é»˜è®¤åªä¼šä¿å­˜æœ€è¿‘çš„3ä¸ªCheckpointï¼Œæ‰€ä»¥å¯¹äºå¢é‡Checkpointè€Œè¨€ï¼Œè‚¯å®šä¼šæœ‰æ–‡ä»¶çš„ä¿®æ”¹å’Œåˆ é™¤ï¼Œæ®äº†è§£ä¿®æ”¹å’Œåˆ é™¤æ˜¯å¯¹HDFSæ€§èƒ½å½±å“è¾ƒå¤§çš„æ“ä½œã€‚æˆ‘ä»¬å¯¹æ¯”è¿™ä¸€æ‰¹ä»»åŠ¡ä»»åŠ¡åœ¨HDFSä¸Šçš„Checkpointæ–‡ä»¶å’Œä¹‹å‰çš„ä»»åŠ¡å¯¹æ¯”å‘ç°ï¼Œæ–‡ä»¶æ•°é‡å¤§å¾ˆå¤šï¼Œä½†æ˜¯æ¯ä¸ªæ–‡ä»¶å°å¾ˆå¤šï¼Œäºæ˜¯æˆ‘ä»¬è°ƒæ•´äº†å‚æ•°ï¼šstate.backend.rocksdb.compaction.level.target-file-size-baseå‚æ•°ä¸º256MBï¼Œè¿™ä¸ªå‚æ•°é»˜è®¤æ˜¯64MBï¼Œå‚æ•°çš„ä½œç”¨æ§åˆ¶å‹ç¼©åçš„æ–‡ä»¶çš„å¤§å°ã€‚é…ç½®æ”¹å‚æ•°åRPCå›å½’æ­£å¸¸ã€‚</p>
<p>æ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/b9/b9ebfdd95264553025698df649ce31ad.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-25">å››ã€æ€»ç»“</h2>
<h3 data-id="heading-26">4.1 é—ç•™é—®é¢˜</h3>
<h4 data-id="heading-27">4.1.1.RocksDBçš„è°ƒä¼˜çš„é—¨æ§›è¾ƒé«˜</h4>
<p>è™½ç„¶æˆ‘ä»¬åœ¨ä»»åŠ¡ä¸Šä½¿ç”¨äº†ç§¯ç´¯é€šç”¨ç»éªŒè¿›è¡Œä¼˜åŒ–ï¼Œä½†æ˜¯æœ‰äº›æ•°æ®é‡è¾ƒå¤§çš„ä»»åŠ¡åœ¨æµé‡é«˜å³°æœŸä¾ç„¶å®¹æ˜“å‡ºç°å»¶è¿Ÿï¼ŒRocksDBçš„å‚æ•°æœ‰å‡ åä¸ªï¼Œè¦æƒ³æŠŠæ€§èƒ½è°ƒä¼˜åšåˆ°æ¯”è¾ƒæè‡´éœ€è¦æ·±å…¥äº†è§£å…¶åŸç†ï¼Œè¿˜æœ‰å¯¹ä¸šåŠ¡ç‰¹ç‚¹æœ‰æ·±å…¥çš„äº†è§£ï¼Œå¯¹äºåº”ç”¨å¼€å‘è€Œè¨€ï¼Œé—¨æ§›è¾ƒé«˜ã€‚</p>
<h4 data-id="heading-28">4.1.2.ä»»åŠ¡æ¢å¤æ…¢</h4>
<p>ç”±äºæœ‰äº›ä»»åŠ¡çš„çŠ¶æ€é«˜è¾¾å‡ åTï¼Œåœ¨é‡å¯ä»»åŠ¡æˆ–è€…å¼‚å¸¸é‡å¯æ—¶è¦ä»Checkpointæ¢å¤ï¼Œéœ€è¦ä»è¿œç¨‹çš„HDFSä¸‹è½½çŠ¶æ€åˆ°æœ¬åœ°ç£ç›˜ï¼Œå•æœºçš„ioå¾ˆå®¹æ˜“è¢«æ‰“æ»¡ï¼Œè™½ç„¶æˆ‘ä»¬åšäº†TMæ‰“æ•£ï¼Œä½†æ˜¯æœ‰äº›å•ä¸ªTMæ¢å¤çŠ¶æ€å°±éœ€è¦å‡ ååˆ†é’Ÿï¼Œè¿™å¯¹äºç‰¹å¾æ‹¼æ¥ä»»åŠ¡æ¥è®²æ˜¯ä¸å¯æ¥å—çš„ã€‚</p>
<h4 data-id="heading-29">4.1.3.SSDå¯¿å‘½æ¶ˆè€—åŠ é€Ÿ</h4>
<p>æˆ‘ä»¬çš„å®æ—¶é›†ç¾¤ç£ç›˜ä½¿ç”¨çš„æ˜¯å•å—çš„SSDï¼ŒSSDå¯¿å‘½æ˜¯æœ‰é™çš„ï¼Œç„¶è€ŒRcoksDBçš„å†™æ”¾å¤§çš„ç‰¹ç‚¹åŠ é€Ÿäº†SSDçš„å¯¿å‘½çš„æ¶ˆè€—ã€‚</p>
<h3 data-id="heading-30">4.2 è§„åˆ’</h3>
<p>ç»è¿‡è¾ƒé•¿æ—¶é—´çš„å®è·µæˆ‘ä»¬ç†è§£äº†æ ·æœ¬æ‹¼æ¥çš„æœ¬è´¨æ˜¯å°†ä¸åŒæ¥æºã€ä¸åŒæ›´æ–°é¢‘ç‡ã€ä¸åŒè§„æ¨¡çš„ç‰¹å¾ï¼ˆå¦‚åŸºç¡€ç‰¹å¾ã€å®æ—¶åŸ‹ç‚¹ç‰¹å¾ã€å†å²ç‰¹å¾ï¼‰ç»„åˆæˆå®Œæ•´æ ·æœ¬ï¼Œè€Œå•ä¸€ç»„ä»¶å¾€å¾€åœ¨ â€œå»¶è¿Ÿã€å­˜å‚¨è§„æ¨¡ã€æ›´æ–°é¢‘ç‡â€ ç­‰ç»´åº¦å­˜åœ¨çŸ­æ¿ï¼Œå¿…é¡»é€šè¿‡æ··åˆæ¶æ„å®ç° â€œä¼˜åŠ¿äº’è¡¥â€ã€‚</p>
<h4 data-id="heading-31">ä¸šç•Œæ··åˆæ¶æ„çš„æ¡ˆä¾‹</h4>
<p><strong>ç»„ä»¶åˆ†å·¥</strong></p>
<p><img src="https://static001.geekbang.org/infoq/df/dfa6fcb45b26fb78bb36157c40d3f9a3.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ‹¼æ¥æµç¨‹</strong></p>
<p><strong>â‘  å®æ—¶æ—¥å¿—é‡‡é›†ï¼š</strong> ç”¨æˆ·ç‚¹å‡»å•†å“çš„æ—¥å¿—é€šè¿‡Kafkaæ¥å…¥Flinkå®æ—¶ä½œä¸šï¼›</p>
<p><strong>â‘¡ å®æ—¶æ•°æ®å­˜å‚¨ï¼š</strong> å°†æ›å…‰æµçš„æ•°æ®å­˜åˆ°RocksDBå’ŒHBaseä¸­ï¼ŒRocksDBçš„TTLè®¾ç½®æˆ1å°æ—¶ï¼›</p>
<p><strong>â‘¢ ç®—å­å†…å®æ—¶æ‹¼æ¥ï¼š</strong> Flinkç®—å­ä»RocksDBè¯»å–ç”¨æˆ·æœ€è¿‘1å°æ—¶åŸ‹ç‚¹ç‰¹å¾ï¼Œä»HBaseè¯»å–åŸºç¡€ç‰¹å¾ï¼Œåˆæ­¥æ‹¼æ¥æˆâ€œå®æ—¶+åŸºç¡€â€ç‰¹å¾ï¼›</p>
<p><strong>â‘£ å†å²ç‰¹å¾èåˆï¼š</strong> Flinkä½œä¸šå°†åˆæ­¥æ‹¼æ¥ç»“æœå†™å…¥Paimonï¼Œä¸Paimonä¸­å­˜å‚¨çš„â€œ7å¤©å†å²ç‰¹å¾â€èåˆï¼Œç”Ÿæˆå®Œæ•´æ ·æœ¬ï¼›</p>
<p><strong>â‘¤ æ ·æœ¬åˆ†å‘ï¼š</strong></p>
<ul>
<li>
<p>å®æ—¶æ¨èï¼šå®Œæ•´æ ·æœ¬é€šè¿‡Flinkå†™å…¥åˆ°HDFSæä¾›ç»™åœ¨çº¿è®­ç»ƒæœåŠ¡ä½¿ç”¨ï¼›</p>
</li>
<li>
<p>ç¦»çº¿è®­ç»ƒï¼šSparkä½œä¸šä»Paimonè¯»å–å…¨é‡å®Œæ•´æ ·æœ¬ï¼Œç”¨äºæ¨èæ¨¡å‹çš„ç¦»çº¿è¿­ä»£ã€‚</p>
</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè°ƒç”¨æ—¶åºå›¾ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/b6/b63abfc2ba44c1bd027c331aef9fb4a0.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong></p>
<ul>
<li>
<p><strong>ä½å»¶è¿Ÿï¼š</strong> RocksDB æ”¯æ’‘ç®—å­å†…æ¯«ç§’çº§æ‹¼æ¥ï¼Œæ»¡è¶³å®æ—¶æ¨èçš„ â€œç§’çº§å“åº”â€ éœ€æ±‚ï¼›</p>
</li>
<li>
<p><strong>å¤§è§„æ¨¡ï¼š</strong> HBase+Paimon å¯æ”¯æ’‘äº¿çº§ç”¨æˆ·çš„PBçº§ç‰¹å¾å­˜å‚¨ï¼›</p>
</li>
<li>
<p><strong>æµæ‰¹ååŒï¼š</strong> åŒä¸€å¥—æ ·æœ¬æ—¢ä¾›å®æ—¶æ¨èï¼Œåˆä¾›ç¦»çº¿è®­ç»ƒï¼Œå®ç°æµæ‰¹æ¶æ„ç»Ÿä¸€ï¼›</p>
</li>
<li>
<p><strong>æ˜“äºæ‰©å±•ï¼š</strong> PaimonåŠ¨æ€åˆ—æ”¯æŒç‰¹å¾è¿­ä»£ã€‚</p>
</li>
</ul>
<h3 data-id="heading-32">4.3 å±•æœ›</h3>
<p>è¿‘å‡ å¹´å¤§æ•°æ®æ¶æ„å·²ç»ä»è®¡ç®—-å­˜å‚¨ç´§å¯†è€¦åˆçš„Map-Reduceæ—¶ä»£ï¼Œè¿›å…¥åˆ°äº†ä»¥Kuberneteså®¹å™¨åŒ–éƒ¨ç½²ä¸ºæ ‡å‡†çš„äº‘åŸç”Ÿä¸–ç•Œã€‚æœªæ¥Flinkå°†å¼•å…¥åŸºäºè¿œç¨‹å­˜å‚¨çš„å­˜ç®—åˆ†ç¦»çŠ¶æ€ç®¡ç†æ¶æ„ï¼Œæ–°æ¶æ„ä¸»è¦ä¸ºäº†è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<blockquote>
<ul>
<li>
<p>å®¹å™¨åŒ–ç¯å¢ƒä¸‹è®¡ç®—èŠ‚ç‚¹å—æœ¬åœ°ç£ç›˜å¤§å°é™åˆ¶çš„é—®é¢˜ï¼›</p>
</li>
<li>
<p>ç”±äºRocksDBä¸­LSMç»“æ„çš„å‘¨æœŸæ€§ Compaction å¯¼è‡´è®¡ç®—èµ„æºå°–å³°çš„é—®é¢˜ï¼›</p>
</li>
<li>
<p>å¤§è§„æ¨¡çŠ¶æ€å¿«é€Ÿæ‰©ç¼©å®¹çš„æŒ‘æˆ˜ã€‚</p>
</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬ä¹Ÿå°†æŒç»­å…³æ³¨Flinkç¤¾åŒºçš„å‘å±•ï¼Œå°è¯•é‡‡ç”¨è¿œç¨‹å­˜å‚¨çŠ¶æ€åç«¯æ¥åšä¸ºç‰¹å¾æ‹¼æ¥çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Markdown å°†æˆä¸º AI æ—¶ä»£çš„é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7571655979256840232</link>    <guid>https://juejin.cn/post/7571655979256840232</guid>    <pubDate>2025-11-13T00:48:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571655979256840232" data-draft-id="7571672422689767476" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Markdown å°†æˆä¸º AI æ—¶ä»£çš„é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-13T00:48:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç£Šç£Šè½è½"/> <meta itemprop="url" content="https://juejin.cn/user/3054882885469577"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Markdown å°†æˆä¸º AI æ—¶ä»£çš„é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3054882885469577/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç£Šç£Šè½è½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T00:48:48.000Z" title="Thu Nov 13 2025 00:48:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç£Šç£Šè½è½ï¼Œç›®å‰æˆ‘åœ¨æŠ€æœ¯ä¸Šä¸»è¦å…³æ³¨ï¼šJavaã€Golangã€AIã€æ¶æ„è®¾è®¡ã€äº‘åŸç”Ÿå’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚æ¬¢è¿æ¥æˆ‘çš„åšå®¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fleileiluoluo.com%2Fposts%2Fthe-universal-programming-language-of-the-ai-era.html" target="_blank" title="https://leileiluoluo.com/posts/the-universal-programming-language-of-the-ai-era.html" ref="nofollow noopener noreferrer">leileiluoluo.com</a>ï¼‰è·å–æˆ‘çš„æœ€è¿‘æ›´æ–°ï¼</p>
</blockquote>
<p>åœ¨ AI ç¼–ç åŠ©æ‰‹æ—¥æ¸ç››è¡Œçš„å½“ä¸‹ï¼Œä¸€ä¸ªå€¼å¾—å…³æ³¨çš„æŠ€æœ¯è¶‹åŠ¿æ­£æ‚„ç„¶æµ®ç°ï¼šç¼–ç¨‹è¯­è¨€çš„æŠ½è±¡å±‚çº§æ­£ä¸æ–­ä¸Šç§»ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚ä»Šæˆ‘ä»¬ä¹ ä»¥ä¸ºå¸¸çš„ Javaã€TypeScriptã€Pythonã€Swift ç­‰å…·ä½“ç¼–ç¨‹è¯­è¨€ï¼Œæˆ–å°†éšç€ AI æ—¶ä»£çš„åˆ°æ¥ï¼Œè¢«ä¸€ç§æ›´æ¥è¿‘äººç±»è‡ªç„¶è¯­è¨€çš„é€šç”¨ç¼–ç¨‹èŒƒå¼æ‰€å–ä»£ã€‚</p>
<p>å¦‚æœä¸Šé¢çš„è¶‹åŠ¿å˜ä¸ºç°å®çš„è¯ï¼ŒAI æ—¶ä»£çš„è½¯ä»¶äº¤ä»˜å°±ä¼šç”±ã€Œä»£ç äº¤ä»˜ã€å˜æˆæ˜¯ã€Œè§„èŒƒæ–‡æ¡£ã€äº¤ä»˜ã€‚æˆ‘ä»¬æ¯ä¸ªå¼€å‘è€…éœ€è¦ä»ä¸“æ³¨äºä»£ç å®ç°æå‡ä¸ºä¸“æ³¨äºè®¾è®¡å’Œæ¶æ„ï¼Œå¼€å‘è½¯ä»¶çš„è§†è§’éœ€è¦ä»å¼€å‘è€…è§†è§’æå‡ä¸ºæ¶æ„å¸ˆè§†è§’å’Œäº§å“ç»ç†è§†è§’ï¼Œæ‰€äº¤ä»˜çš„åˆ¶å“ä¹Ÿéœ€è¦ä»ä»£ç å˜ä¸ºç»“æ„åŒ–çš„æ–‡æ¡£ã€‚è€Œ AI ä¼šå–ä»£äººè´Ÿè´£é‚£ã€Œæœ€åä¸€å…¬é‡Œã€ï¼Œå°†æ–‡æ¡£è½¬æ¢ä¸ºä»£ç ã€‚</p>
<h3 data-id="heading-0">1 å½“å‰ AI è¾…åŠ©ç¼–ç ç°çŠ¶</h3>
<p>ä¸‹é¢æ˜¯ç½‘å‹æ€»ç»“çš„ AI æ—¶ä»£åå¤§çƒ­é—¨ã€Œç¼–ç¨‹è¯­è¨€ã€ï¼š</p>
<pre><code class="hljs language-text" lang="text">ç»™æˆ‘ç”Ÿæˆå®Œæ•´å¯è¿è¡Œçš„ä»£ç 
å°±æ”¹è¿™é‡Œï¼Œåˆ«çš„åœ°æ–¹åˆ«åŠ¨
è¯·ç”¨ä¸­æ–‡å›ç­”æˆ‘
è¿™ä¸ªé”™è¯¯ä½ ä¸Šæ¬¡å°±çŠ¯è¿‡
åˆ«è‡ªä½œèªæ˜ä¼˜åŒ–
ä½ è¿™ä»£ç æ ¹æœ¬ç¼–è¯‘ä¸è¿‡
èƒ½ä¸èƒ½æœ‰ç‚¹è®°å¿†åŠ›
æŒ‰ç…§æˆ‘ç»™çš„ä¾‹å­å†™
è¿˜æ˜¯æŠ¥é”™
èƒ½å…ˆè·‘èµ·æ¥å†è¯´å—
</code></pre>
<p>ä¸Šé¢çš„ã€Œçƒ­é—¨è¯­ã€å°±æ˜¯æˆ‘ä»¬å½“ä¸‹ä½¿ç”¨ AI åŠ©æ‰‹çš„æ—¥å¸¸ï¼Œæ˜¯å¦æˆ³ä¸­äº†æ‚¨çš„ç¬‘ç‚¹ã€‚ç”±æ­¤å¯çŸ¥ï¼Œç›®å‰æˆ‘ä»¬ä½¿ç”¨ AI åŠ©æ‰‹æ—¶è¿˜å¤§å¤šåœç•™åœ¨å‡­æ„Ÿè§‰ç¼–ç¨‹çš„é˜¶æ®µï¼ˆVibe Codingï¼‰ï¼Œæœªè¾¾åˆ°çœŸæ­£çš„å·¥ç¨‹åŒ–ã€‚</p>
<p>è¿™ä¸ªå…¶å®ä¸æ€ª AIï¼Œå½“è€æ¿è¯´ä¸€å¥ã€Œä½ æŠŠè¿™ä¸ªç»™å®ç°äº†ã€ï¼Œæˆ‘ä»¬ä½œä¸ºäººç±»ä¹Ÿä¼šæ‡µã€‚æ‰€ä»¥è¦æƒ³è®© AI æœ‰é«˜è´¨é‡ã€è§„èŒƒåŒ–ã€å¯å¤ç°çš„äº§å‡ºï¼Œæˆ‘ä»¬éœ€è¦ç»™ AI æä¾›ç²’åº¦é€‚ä¸­çš„æŒ‡å¯¼æ–‡æ¡£ï¼Œè€å¿ƒçš„æ•™ AI æ€ä¹ˆåšï¼Œè€Œä¸æ˜¯æ³›æ³›ä¸€å¥ã€ŒæŠŠè¿™ä¸ªç»™æˆ‘å®ç°äº†ã€å°±å®Œäº†ã€‚</p>
<h3 data-id="heading-1">2 è§„èŒƒé©±åŠ¨å¼€å‘</h3>
<p>æ‰€ä»¥ç›®å‰ä¸šç•Œé¦–æ¨çš„æ˜¯è§„èŒƒé©±åŠ¨å¼€å‘ï¼ˆSpec-Driven Developmentï¼‰ï¼šå³è®© AI ç¼–ç ä¹‹å‰ï¼Œé¦–å…ˆæˆ‘ä»¬è‡ªå·±è¦æ„æ€å¥½ä¸€ä¸ªã€Œè§„èŒƒã€ï¼Œç„¶åç”¨ç»“æ„åŒ–çš„æ–‡æ¡£å‘Šè¯‰ AIã€Œåšä»€ä¹ˆã€å’Œã€Œæ€ä¹ˆåšã€ã€‚è¿™ä¸ªè§„èŒƒå¾ˆé‡è¦ï¼Œè§„èŒƒå³ä»£ç ï¼Œè¿™æ˜¯äººç±»å’Œ AI ä¹‹é—´çš„å¥‘çº¦ï¼ˆå”¯ä¸€äº‹å®æ¥æºï¼ŒSource of Truthï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f36afb95a1b74a2a95e23e04c40f21eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763599728&amp;x-signature=C7qie0UzeLsMfMRQMyiH65yAvIQ%3D" alt="è§„èŒƒé©±åŠ¨å¼€å‘çš„å±‚çº§" loading="lazy"/></p>
<h3 data-id="heading-2">3 AI æ—¶ä»£çš„ç¼–ç¨‹è¯­è¨€é•¿ä»€ä¹ˆæ ·ï¼Ÿ</h3>
<p>é‚£ä¹ˆè¿™ä¸ªæŒ‡å¯¼ AI ç¼–ç åŠ©æ‰‹çš„è§„èŒƒé•¿ä»€ä¹ˆæ ·å‘¢ï¼Ÿç»åˆæ­¥è°ƒæŸ¥ï¼Œç›®å‰ä¸šç•Œæ¨å‡ºçš„ã€Œè§„èŒƒé©±åŠ¨å¼€å‘ã€çš„å·¥ä½œæµåŸºæœ¬éƒ½åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼šéœ€æ±‚ -&gt; è®¾è®¡ -&gt; å®ç°ï¼ˆæˆ–ä»»åŠ¡ï¼‰ã€‚å³è®© AI ç¼–ç åŠ©æ‰‹ç€æ‰‹ç¼–ç å‰éœ€è¦ç”¨æ–‡æ¡£çš„æ–¹å¼å‘ŠçŸ¥å®ƒä¸šåŠ¡éœ€æ±‚ã€æ¦‚è¦è®¾è®¡å’Œå®ç°æ­¥éª¤ã€‚è€Œä¸”ä¸šç•Œæ‰€ä½¿ç”¨çš„ã€Œè§„èŒƒé©±åŠ¨å¼€å‘ã€æ–‡æ¡£å¤§å¤šç”¨ Markdown æ ¼å¼ç¼–å†™ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ä»¥å®ç°ä¸€ä¸ªåšå®¢èšåˆç½‘ç«™ä¸ºä¾‹ï¼Œåˆæ­¥æ¢ç´¢ä¸€ä¸‹è¿™ä¸ªè§„èŒƒæ–‡æ¡£å…·ä½“è¯¥æ€ä¹ˆå†™ï¼Ÿ</p>
<p><strong>éœ€æ±‚æ–‡æ¡£æ ·ä¾‹ï¼š</strong></p>
<p>éœ€è¦æ–‡æ¡£è¦å°†ã€Œåšä»€ä¹ˆã€è¯´æ¸…æ¥šï¼Œå³ä¸šåŠ¡åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿé’ˆå¯¹æ¯ä¸ªéœ€æ±‚çš„ç”¨æˆ·æ•…äº‹å’ŒéªŒæ”¶æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Œéƒ½è¦ä¸€ä¸€æè¿°æ¸…æ¥šã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># éœ€æ±‚æ–‡æ¡£</span>

<span class="hljs-section">## æ¦‚è¿°</span>

éœ€è¦å®ç°ä¸€ä¸ªåšå®¢èšåˆ Web ç½‘ç«™ï¼Œè¯¥ç½‘ç«™åŒ…å«åšå®¢å¹¿åœºã€åšå®¢è¯¦æƒ…ã€åšå®¢æäº¤ã€å’Œåšå®¢å®¡æ ¸å‡ ä¸ªä¸»è¦é¡µé¢ã€‚

<span class="hljs-section">## éœ€æ±‚</span>

<span class="hljs-section">### åšå®¢å¹¿åœºé¡µé¢</span>

åšå®¢å¹¿åœºæ˜¯æ‰€æœ‰å·²æ”¶å½•åšå®¢çš„é›†ä¸­å±•ç¤ºé¡µé¢ï¼Œ

<span class="hljs-strong">**ç”¨æˆ·æ•…äº‹ï¼š**</span>

ä½œä¸ºç½‘ç«™è®¿å®¢ï¼Œæˆ‘å¸Œæœ›èƒ½çœ‹åˆ°æ‰€æœ‰å·²å‘å¸ƒçš„åšå®¢ï¼Œä»¥ä¾¿äº†è§£æ˜¯å¦æœ‰æˆ‘æ‰€æ„Ÿå…´è¶£çš„ã€‚

<span class="hljs-strong">**éªŒæ”¶æ ‡å‡†ï¼š**</span>

<span class="hljs-bullet">-</span> é¡µé¢åŠ è½½åï¼Œæ˜¾ç¤ºåšå®¢åˆ—è¡¨ï¼ˆåç§°ã€ç®€ä»‹ã€å‘å¸ƒæ—¶é—´ã€æµè§ˆæ•°ï¼‰ï¼›

<span class="hljs-bullet">-</span> æ¯é¡µé»˜è®¤æ˜¾ç¤º 10 ç¯‡åšå®¢ï¼›

<span class="hljs-bullet">-</span> åˆ—è¡¨æŒ‰ç…§å‘å¸ƒæ—¶é—´é™åºæ’åˆ—ï¼ˆæœ€æ–°ä¼˜å…ˆï¼‰ï¼›

<span class="hljs-bullet">-</span> æ•°æ®æ¥æºäºåç«¯ API ï¼ˆGET /api/blogs?page={page}&amp;size={size}ï¼‰ï¼›

<span class="hljs-bullet">-</span> å½“æ— æ•°æ®æ—¶ï¼Œæ˜¾ç¤ºã€Œæš‚æ— åšå®¢ã€æç¤ºã€‚

...

<span class="hljs-section">### åšå®¢è¯¦æƒ…é¡µé¢</span>

...
</code></pre>
<p><strong>è®¾è®¡æ–‡æ¡£æ ·ä¾‹ï¼š</strong></p>
<p>è®¾è®¡æ–‡æ¡£å³æ˜¯åŸºäºä¸Šè¿°éœ€æ±‚æ–‡æ¡£çš„å…·ä½“è®¾è®¡ï¼Œæ˜¯åœ¨å‘Šè¯‰ AIã€Œæ€ä¹ˆåšã€ä¹‹å‰å‘ŠçŸ¥å®ƒçš„å¿…è¦å‚è€ƒçŸ¥è¯†ã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼šæ¶æ„å›¾ã€å‰åç«¯äº¤äº’æ–¹å¼ã€å‰ç«¯ç»„ä»¶è®¾è®¡ã€åç«¯ API è®¾è®¡ã€é”™è¯¯å¤„ç†ã€æµ‹è¯•ç­–ç•¥ç­‰ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># è®¾è®¡æ–‡æ¡£</span>

<span class="hljs-section">## ç½‘ç«™æ¶æ„</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åšå®¢èšåˆç½‘ç«™                                 â”‚
â”‚ (Blog Aggregation Web)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯å±‚ï¼ˆWebï¼‰            â”‚
â”‚ React + Axios + Router â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡µé¢ç»“æ„                          â”‚
â”‚----------------------------------â”‚
â”‚ é¦–é¡µï¼ˆBlog Plaza Pageï¼‰           â”‚
â”‚ - æ˜¾ç¤ºæ‰€æœ‰åšå®¢åˆ—è¡¨                  â”‚
â”‚ - æœç´¢ / ç­›é€‰ / æ’åº / åˆ†é¡µ         â”‚
â”‚ - ç‚¹å‡»åè¿›å…¥è¯¦æƒ…é¡µ                  â”‚
â”‚----------------------------------â”‚
â”‚ åšå®¢è¯¦æƒ…é¡µï¼ˆBlog Detail Pageï¼‰     â”‚
â”‚ - æ˜¾ç¤ºå•ç¯‡åšå®¢å®Œæ•´å†…å®¹              â”‚
â”‚ - æ”¯æŒç‚¹èµ / è¯„è®º / åˆ†äº«           â”‚
â”‚----------------------------------â”‚
â”‚ åšå®¢æäº¤é¡µï¼ˆBlog Submit Pageï¼‰     â”‚
â”‚ - ç”¨æˆ·æäº¤åšå®¢å†…å®¹                 â”‚
â”‚ - å¡«å†™æ ‡é¢˜ã€ç®€ä»‹ã€æ ‡ç­¾              â”‚
â”‚----------------------------------â”‚
â”‚ åšå®¢å®¡æ ¸é¡µï¼ˆBlog Review Pageï¼‰     â”‚
â”‚ - ç®¡ç†å‘˜å®¡æ ¸ç”¨æˆ·æäº¤çš„åšå®¢           â”‚
â”‚ - å®¡æ ¸é€šè¿‡æˆ–é€€å›ä¿®æ”¹                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯å±‚ï¼ˆAPIï¼‰                      â”‚
â”‚ Spring Boot 3.3.5                â”‚
â”‚----------------------------------â”‚
â”‚ æ§åˆ¶å™¨ï¼ˆControllersï¼‰              â”‚
â”‚ - BlogController                 â”‚
â”‚ - AdminController                â”‚
â”‚----------------------------------â”‚
â”‚ æœåŠ¡å±‚ï¼ˆServicesï¼‰                 â”‚
â”‚ - BlogService (åˆ—è¡¨/è¯¦æƒ…/æäº¤)     â”‚
â”‚ - ReviewService (å®¡æ ¸é€»è¾‘)        â”‚
â”‚----------------------------------â”‚
â”‚ æ•°æ®è®¿é—®å±‚ï¼ˆRepositoriesï¼‰         â”‚
â”‚ - BlogRepository (JPA)           â”‚
â”‚ - AuthorRepository               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®å±‚ï¼ˆDBï¼‰                       â”‚
â”‚----------------------------------â”‚
â”‚ blogs â† åšå®¢ä¸»è¡¨                  â”‚
â”‚ authors â† ä½œè€…ä¿¡æ¯                â”‚
â”‚ categories â† åˆ†ç±»ä¿¡æ¯             â”‚
â”‚ tags â† æ ‡ç­¾ä¿¡æ¯                   â”‚
â”‚ review<span class="hljs-emphasis">_logs â† å®¡æ ¸æ—¥å¿—            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤–éƒ¨ä¾èµ–ä¸é›†æˆæ¨¡å—                  â”‚
â”‚----------------------------------â”‚
â”‚ RSS / API èšåˆï¼ˆå…¶ä»–åšå®¢æºï¼‰        â”‚
â”‚ AI è‡ªåŠ¨åˆ†ç±»ä¸æ‘˜è¦ç”Ÿæˆ               â”‚
â”‚ åˆ†ææœåŠ¡ï¼ˆè®¿é—®ç»Ÿè®¡ / çƒ­åº¦ï¼‰          â”‚
â”‚ é‚®ä»¶é€šçŸ¥æœåŠ¡ï¼ˆæ–°åšå®¢æé†’ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

## ç»„ä»¶è®¾è®¡

...

## é”™è¯¯å¤„ç†

...

## æµ‹è¯•ç­–ç•¥

...
</span></code></pre>
<p><strong>å®ç°æ–‡æ¡£æ ·ä¾‹</strong>ï¼š</p>
<p>å®ç°æ–‡æ¡£ä¸æ˜¯å…·ä½“åˆ°æ¯è¡Œä»£ç è¯¥æ€ä¹ˆå†™ï¼Œè€Œæ˜¯ä»‹äºè®¾è®¡æ–‡æ¡£å’Œç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„ä¸€ä¸ªæ°å½“ç²’åº¦çš„ã€Œæ€ä¹ˆåšã€æ–‡æ¡£ã€‚æ¯”å¦‚éœ€è¦ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€å‰åç«¯äº¤äº’çš„å…·ä½“ JSON ç»“æ„ã€é’ˆå¯¹æ¯ä¸ªéœ€æ±‚çš„å®ç°æ­¥éª¤ç­‰éœ€è¦åœ¨å®ç°æ–‡æ¡£æè¿°æ¸…æ¥šã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># å®ç°è®¡åˆ’</span>

<span class="hljs-section">## åšå®¢å¹¿åœºé¡µé¢</span>

ç›®æ ‡ï¼šå±•ç¤ºæ‰€æœ‰å·²å‘å¸ƒçš„åšå®¢ï¼Œæ”¯æŒæœç´¢ã€ç­›é€‰ã€æ’åºã€åˆ†é¡µã€‚

<span class="hljs-section">### å‰ç«¯ä»»åŠ¡</span>

<span class="hljs-bullet">-</span> ä½¿ç”¨ React + React Router åˆ›å»º /blogs é¡µé¢ï¼›

<span class="hljs-bullet">-</span> å®ç°åšå®¢åˆ—è¡¨ç»„ä»¶ï¼ˆBlogList + BlogCardï¼‰ï¼›

<span class="hljs-bullet">-</span> æ·»åŠ æœç´¢æ¡†ã€åˆ†ç±»ç­›é€‰ã€æ’åºä¸‹æ‹‰æ¡†ç»„ä»¶ï¼›

<span class="hljs-bullet">-</span> æ”¯æŒåˆ†é¡µåˆ‡æ¢ä¸ URL åŒæ­¥ï¼ˆQuery å‚æ•°ï¼‰ï¼›

<span class="hljs-bullet">-</span> æ¥å…¥åç«¯ APIï¼šGET /api/blogsã€‚

<span class="hljs-section">### åç«¯ä»»åŠ¡</span>

<span class="hljs-bullet">-</span> åˆ›å»º BlogController#getBlogs()ï¼›

<span class="hljs-bullet">-</span> æ”¯æŒåˆ†é¡µã€æ’åºã€å…³é”®å­—ä¸åˆ†ç±»è¿‡æ»¤å‚æ•°ï¼›

<span class="hljs-bullet">-</span> å®šä¹‰ DTOï¼šBlogSummaryResponseï¼›

<span class="hljs-bullet">-</span> å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯•ï¼Œ

...
</code></pre>
<p>å¦‚ä¸Šå³æ˜¯å®ç°ä¸€ä¸ªåšå®¢èšåˆç½‘ç«™çš„ã€Œè§„èŒƒé©±åŠ¨å¼€å‘ã€æ ·ä¾‹æ–‡æ¡£ã€‚æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ç¼–å†™è¿™äº›æ–‡æ¡£æ¥æŒ‡å¯¼ AI åšå®ç°ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©å¸‚é¢ä¸Šè¯¸å¦‚ Spec Kitã€Open Spec ç­‰å·¥å…·æ¥è‡ªåŠ¨ç”Ÿæˆå’Œç»´æŠ¤è¿™äº›è§„èŒƒæ–‡æ¡£ã€‚è¿™æ ·ï¼Œåœ¨æœ‰äº†è§„åˆ™ã€éœ€æ±‚ã€è®¾è®¡ä»¥åŠæŒ‡å¯¼æ­¥éª¤çš„æƒ…å†µä¸‹ï¼ŒAI ç¼–ç åŠ©æ‰‹çš„å®ç°æ‰ä¼šæ›´åŠ å¯é å’Œé«˜æ•ˆã€‚</p>
<h3 data-id="heading-3">4 å°ç»“</h3>
<p>ç»¼ä¸Šï¼Œè¿™ä¹ˆçœ‹ä¸‹æ¥ï¼Œåœ¨ AI æ—¶ä»£ï¼Œå¼€å‘è€…å¯èƒ½ä¼šä»ä¹‹å‰çš„ä»£ç å®ç°ä¸Šè§£è„±å‡ºæ¥ï¼Œè€Œä¼šå°†æ—¶é—´æ›´å¤šçš„æ”¾åœ¨è®¾è®¡ã€æ¶æ„å’Œç¼–å†™è§„èŒƒæ–‡æ¡£ä¸Šã€‚è€Œè‰¯å¥½çš„è§„èŒƒæ–‡æ¡£ä¼šå¸®åŠ© AI æ¶ˆé™¤æ­§ä¹‰ã€å‡å°‘å¹»è§‰ï¼Œä»è€Œå®ç°å‡†ç¡®å¯é çš„ä»£ç ã€‚</p>
<p>å½“ç„¶ã€Œè§„èŒƒé©±åŠ¨å¼€å‘ã€è¿™ä¸ªæ¨¡å¼ä¹Ÿä¸æ˜¯ä¸‡èƒ½é’¥åŒ™ï¼Œå…¶è·ç¦»çœŸæ­£è½åœ°è¿˜é¢ä¸´ä¸å°‘é—®é¢˜ã€‚æ€ä¹ˆæŠŠæ¡æ–‡æ¡£çš„ç²’åº¦ï¼Ÿä½•ä¸ºä¸€ä¸ªå¥½çš„è§„èŒƒæ–‡æ¡£ï¼Ÿé’ˆå¯¹åŒä¸€ä¸ªè§„èŒƒæ–‡æ¡£ AI ç”Ÿæˆçš„ä»£ç å°±å®Œå…¨ä¸€è‡´å—ï¼Ÿè§„èŒƒæ–‡æ¡£å¦‚ä½•éšç€è¿­ä»£ä¸€èµ·æ¼”è¿›ï¼Ÿé’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œä¸šç•Œæ­£åœ¨æ¢ç´¢å¦‚ä½•è§£å†³ã€‚</p>
<p>ä½†ä¸ç®¡æ€ä¹ˆè¯´ï¼ŒAI æ”¹å˜è½¯ä»¶å¼€å‘æ˜¯å¿…ç„¶çš„è¶‹åŠ¿ï¼Œå¼€å‘è€…ä»¥åæ˜¯å¦å¯ä»¥å½»åº•å‘Šåˆ«ç¼–å†™ä»£ç ï¼Œè€Œå°†æ—¥å¸¸å·¥ä½œå®Œå…¨æ”¾åœ¨ç¼–å†™è¯¸å¦‚ Markdown ç­‰è§„èŒƒæ–‡æ¡£ä¸Šï¼Œç›¸ä¿¡ä¸è¿œçš„å°†æ¥å³ä¼šæœ‰ç­”æ¡ˆã€‚</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™</p>
<p>[1] YouTube: Spec-Driven Development in the Real World - <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D3le-v1Pme44" target="_blank" title="https://www.youtube.com/watch?v=3le-v1Pme44" ref="nofollow noopener noreferrer">www.youtube.com/watch?v=3leâ€¦</a></p>
<p>[2] Medium: Spec-Driven Development: Designing Before You Code (Again) - <a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2F%40dave-patten%2Fspec-driven-development-designing-before-you-code-again-21023ac91180" target="_blank" title="https://medium.com/@dave-patten/spec-driven-development-designing-before-you-code-again-21023ac91180" ref="nofollow noopener noreferrer">medium.com/@dave-patteâ€¦</a></p>
<p>[3] Martin Fowler: Understanding Spec-Driven-Development: Kiro, spec-kit, and Tessl - <a href="https://link.juejin.cn?target=https%3A%2F%2Fmartinfowler.com%2Farticles%2Fexploring-gen-ai%2Fsdd-3-tools.html" target="_blank" title="https://martinfowler.com/articles/exploring-gen-ai/sdd-3-tools.html" ref="nofollow noopener noreferrer">martinfowler.com/articles/exâ€¦</a></p>
<p>[4] GitHub Blog: Spec-driven development with AI: Get started with a new open source toolkit - <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgenerative-ai%2Fspec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit%2F" target="_blank" title="https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/" ref="nofollow noopener noreferrer">github.blog/ai-and-ml/gâ€¦</a></p>
<p>[5] å¾®ä¿¡å…¬ä¼—å·ï¼šSpec-Driven Development - AI æ—¶ä»£çš„è½¯ä»¶å¼€å‘æ–°èŒƒå¼ - <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FnrJyR5EgvTwp3wAXTM0L3w" target="_blank" title="https://mp.weixin.qq.com/s/nrJyR5EgvTwp3wAXTM0L3w" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/nrJyR5Egvâ€¦</a></p>
<p>[6] Wikipedia: Vibe coding - <a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FVibe_coding" target="_blank" title="https://en.wikipedia.org/wiki/Vibe_coding" ref="nofollow noopener noreferrer">en.wikipedia.org/wiki/Vibe_câ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº LangGraph æ„å»ºæç®€å¯¹è¯å¼ AI æ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7571731181197738020</link>    <guid>https://juejin.cn/post/7571731181197738020</guid>    <pubDate>2025-11-13T02:15:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571731181197738020" data-draft-id="7571758212473651251" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº LangGraph æ„å»ºæç®€å¯¹è¯å¼ AI æ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="Python,LangChain,Agent"/> <meta itemprop="datePublished" content="2025-11-13T02:15:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§‹åˆ€å¥ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2066737590439079"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº LangGraph æ„å»ºæç®€å¯¹è¯å¼ AI æ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2066737590439079/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§‹åˆ€å¥ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:15:24.000Z" title="Thu Nov 13 2025 02:15:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    16
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäºLangGraphæ„å»ºæç®€å¯¹è¯å¼AIæ™ºèƒ½ä½“ï¼šClean Graphå·¥ç¨‹æ­å»ºæŒ‡å—</h2>
<ul>
<li>è§†é¢‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1PwCHBCEkV" target="_blank" title="https://www.bilibili.com/video/BV1PwCHBCEkV" ref="nofollow noopener noreferrer">LangGraph æœ€ç®€å·¥ç¨‹æ­å»º_å“”å“©å“”å“©_bilibili</a></li>
<li>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fslow-coding%2Fclean_graph" target="_blank" title="https://github.com/slow-coding/clean_graph" ref="nofollow noopener noreferrer">GitHub - slow-coding/clean_graph: A LangGraph v1.0 Minimal Quick Starter for Agents</a></li>
</ul>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>LangGraphä½œä¸ºåŸºäºå›¾ç»“æ„çš„AIåº”ç”¨æ¡†æ¶ï¼Œä¸ºæ„å»ºå¤æ‚æ™ºèƒ½ä½“æä¾›äº†çµæ´»çš„èŠ‚ç‚¹ç¼–æ’èƒ½åŠ›ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•æ­å»ºä¸€ä¸ªæœ€å°åŒ–çš„LangGraphå·¥ç¨‹ï¼ˆClean Graphï¼‰ï¼Œè¯¥å·¥ç¨‹å¯ä½œä¸ºæ™ºèƒ½ä½“å¼€å‘çš„è„šæ‰‹æ¶æˆ–å®éªŒåœºï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€ŸæŒæ¡LangGraphçš„æ ¸å¿ƒç”¨æ³•ï¼Œå¹¶é€šè¿‡LangGraph Studioå®ç°æ™ºèƒ½ä½“è¡Œä¸ºçš„å¯è§†åŒ–è°ƒè¯•ã€‚</p>
<h3 data-id="heading-2">é¡¹ç›®æ¦‚è¿°</h3>
<p>Clean Graphæ˜¯ä¸€ä¸ªåŸºäºLangGraphæ„å»ºçš„æç®€å¯¹è¯å¼AIæ™ºèƒ½ä½“ï¼Œæ—¨åœ¨ä¸ºå­¦ä¹ ã€æ„å»ºå’Œå®éªŒé«˜çº§æ™ºèƒ½ä½“æŠ€æœ¯æä¾›å®ç”¨èµ·ç‚¹ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li>æç®€ç»“æ„ï¼šå»é™¤å†—ä½™ä»£ç ï¼Œèšç„¦LangGraphæ ¸å¿ƒé€»è¾‘</li>
<li>å¯è§†åŒ–è°ƒè¯•ï¼šé›†æˆLangGraph Studioï¼Œæ”¯æŒæ™ºèƒ½ä½“è¡Œä¸ºçš„å®æ—¶è¿½è¸ª</li>
<li>ç¯å¢ƒå…¼å®¹ï¼šæ”¯æŒæœ¬åœ°æ¨¡å‹ï¼ˆå¦‚LM Studioã€Ollamaï¼‰åŠåœ¨çº¿APIï¼ˆå¦‚OpenAIï¼‰</li>
<li>å¯æ‰©å±•æ€§ï¼šæ¸…æ™°çš„æ¨¡å—åˆ’åˆ†ä¾¿äºåŠŸèƒ½æ‰©å±•</li>
</ul>
<h3 data-id="heading-3">å‰ç½®è¦æ±‚</h3>
<h4 data-id="heading-4">å¿…éœ€å·¥å…·</h4>
<ul>
<li><strong>Python</strong>ï¼šç¼–ç¨‹è¯­è¨€ç¯å¢ƒï¼ˆæ¨è3.12ç‰ˆæœ¬ï¼‰</li>
<li><strong>pip</strong>ï¼šPythonåŒ…ç®¡ç†å™¨</li>
<li><strong>Miniconda</strong>ï¼šè½»é‡çº§ç¯å¢ƒç®¡ç†å™¨ï¼Œç”¨äºéš”ç¦»é¡¹ç›®ä¾èµ–</li>
<li><strong>VSCode</strong>ï¼šæ¨èçš„å¼€å‘ç¯å¢ƒï¼Œä¾¿äºé…ç½®è™šæ‹Ÿç¯å¢ƒåŠä»£ç è°ƒè¯•</li>
</ul>
<h4 data-id="heading-5">å·¥å…·å®‰è£…æŒ‡å—</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python.org%2Fdownloads%2Fmacos%2F" target="_blank" title="https://www.python.org/downloads/macos/" ref="nofollow noopener noreferrer">Python for MacOS</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anaconda.com%2Fdocs%2Fgetting-started%2Fminiconda%2Finstall%23macos-2" target="_blank" title="https://www.anaconda.com/docs/getting-started/miniconda/install#macos-2" ref="nofollow noopener noreferrer">Miniconda installation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fpip.pypa.io%2Fen%2Fstable%2Finstallation%2F%23" target="_blank" title="https://pip.pypa.io/en/stable/installation/#" ref="nofollow noopener noreferrer">pip Installation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.visualstudio.com%2Fdocs%2Fsetup%2Fmac" target="_blank" title="https://code.visualstudio.com/docs/setup/mac" ref="nofollow noopener noreferrer">Visual Studio Code on macOS</a></li>
</ul>
<h3 data-id="heading-6">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-7">1. ç¯å¢ƒè®¾ç½®</h4>
<p>é¦–å…ˆåˆ›å»ºå¹¶æ¿€æ´»ç‹¬ç«‹çš„Condaè™šæ‹Ÿç¯å¢ƒï¼Œé¿å…ä¾èµ–å†²çªï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºåä¸ºclean_graphçš„è™šæ‹Ÿç¯å¢ƒï¼ŒæŒ‡å®šPython 3.12</span>
conda create -n clean_graph python=3.12

<span class="hljs-comment"># æ¿€æ´»ç¯å¢ƒ</span>
conda activate clean_graph
</code></pre>
<blockquote>
<p>è‹¥ä½¿ç”¨VSCodeå¼€å‘ï¼Œå¯é€šè¿‡å³ä¸‹è§’Pythonç¯å¢ƒé€‰æ‹©å™¨å…³è”è¯¥è™šæ‹Ÿç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨æ¿€æ´»ã€‚</p>
</blockquote>
<h4 data-id="heading-8">2. å®‰è£…ä¾èµ–</h4>
<p>é¡¹ç›®ä¾èµ–å·²æ•´ç†è‡³<code>requirements.txt</code>ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰¹é‡å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install -r requirements.txt
</code></pre>
<p>æ ¸å¿ƒä¾èµ–è¯´æ˜ï¼š</p>
<ul>
<li><code>langgraph~=1.0</code>ï¼šLangGraphæ¡†æ¶æ ¸å¿ƒ</li>
<li><code>langchain~=1.0</code>ï¼šAIåº”ç”¨å¼€å‘å·¥å…·é“¾</li>
<li><code>langchain_openai</code>ï¼šOpenAIå…¼å®¹APIå®¢æˆ·ç«¯</li>
<li><code>python-dotenv</code>ï¼šç¯å¢ƒå˜é‡ç®¡ç†</li>
<li><code>langgraph-cli</code>ï¼šLangGraph Studioå¼€å‘å·¥å…·</li>
</ul>
<h4 data-id="heading-9">3. ç¯å¢ƒé…ç½®</h4>
<p>ç¼–è¾‘é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code>.env</code>æ–‡ä»¶ï¼Œé…ç½®æ¨¡å‹åŠè¿½è¸ªæœåŠ¡å‚æ•°ï¼š</p>
<pre><code class="hljs language-env" lang="env"># å¿…éœ€ï¼šLLM APIé…ç½®ï¼ˆæ”¯æŒæ‰€æœ‰OpenAIå…¼å®¹æ¥å£ï¼‰
LLM_API_BASE=http://localhost:1234/v1  # æœ¬åœ°æ¨¡å‹æœåŠ¡åœ°å€ï¼ˆå¦‚LM Studioã€Ollamaï¼‰
LLM_MODEL=qwen/qwen3-next-80b          # æ¨¡å‹åç§°ï¼ˆéœ€ä¸æœåŠ¡ç«¯ä¸€è‡´ï¼‰
LLM_API_KEY=your-api-key-here          # APIå¯†é’¥ï¼ˆæœ¬åœ°æ¨¡å‹å¯å¡«ä»»æ„å€¼ï¼‰

# å¯é€‰ï¼šLangSmithè¿½è¸ªé…ç½®ï¼ˆç”¨äºè°ƒè¯•ä¸åˆ†æï¼‰
LANGSMITH_TRACING=false                # æ˜¯å¦å¯ç”¨è¿½è¸ªï¼ˆå¼€å‘é˜¶æ®µå»ºè®®è®¾ä¸ºfalseï¼‰
LANGSMITH_API_KEY=your-langsmith-key   # LangSmithå¯†é’¥ï¼ˆéœ€åœ¨å®˜ç½‘æ³¨å†Œè·å–ï¼‰
</code></pre>
<blockquote>
<p>LangSmithæ˜¯LangChainæä¾›çš„åœ¨çº¿è¿½è¸ªæœåŠ¡ï¼Œç”¨äºè®°å½•æ™ºèƒ½ä½“æ‰§è¡Œè¿‡ç¨‹ï¼Œæ³¨å†Œåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2F" target="_blank" title="https://smith.langchain.com/" ref="nofollow noopener noreferrer">LangSmithå®˜ç½‘</a>ã€‚</p>
</blockquote>
<h4 data-id="heading-10">4. å¯åŠ¨LangGraph Studio</h4>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨å¯è§†åŒ–è°ƒè¯•ç•Œé¢ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">langgraph dev --no-reload
</code></pre>
<ul>
<li><code>--no-reload</code>ï¼šç¦ç”¨çƒ­æ›´æ–°ï¼ˆé¿å…é¢‘ç¹ä»£ç æ”¹åŠ¨å¯¼è‡´ç•Œé¢å‡æ­»ï¼‰</li>
<li>å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®<code>http://localhost:2024</code>å³å¯æ‰“å¼€LangGraph Studioç•Œé¢</li>
</ul>
<h3 data-id="heading-11">é¡¹ç›®ç»“æ„è§£æ</h3>
<p>Clean Graphé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ ¸å¿ƒç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">clean_graph/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py      <span class="hljs-comment"># åŒ…åˆå§‹åŒ–æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ graph.py         <span class="hljs-comment"># LangGraphå›¾ç»“æ„å®šä¹‰ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰</span>
â”‚   â””â”€â”€ llms.py          <span class="hljs-comment"># LLMå®ä¾‹é…ç½®ï¼ˆåŠ è½½.envå‚æ•°ï¼‰</span>
â”œâ”€â”€ .<span class="hljs-built_in">env</span>                 <span class="hljs-comment"># ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ¨¡å‹åœ°å€ã€å¯†é’¥ç­‰ï¼‰</span>
â”œâ”€â”€ langgraph.json       <span class="hljs-comment"># LangGraphåº”ç”¨å®šä¹‰ï¼ˆå…³è”Studioï¼‰</span>
â”œâ”€â”€ requirements.txt     <span class="hljs-comment"># é¡¹ç›®ä¾èµ–æ¸…å•</span>
â”œâ”€â”€ README.md            <span class="hljs-comment"># è‹±æ–‡ç‰ˆè¯´æ˜æ–‡æ¡£</span>
â””â”€â”€ README_CN.md         <span class="hljs-comment"># ä¸­æ–‡ç‰ˆè¯´æ˜æ–‡æ¡£</span>
</code></pre>
<h4 data-id="heading-12">æ ¸å¿ƒæ–‡ä»¶è¯´æ˜</h4>
<ol>
<li>
<p><strong>src/llms.py</strong><br/>
è´Ÿè´£åŠ è½½<code>.env</code>é…ç½®ï¼Œåˆ›å»ºLLMè°ƒç”¨å®ä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">import</span> os

load_dotenv()  <span class="hljs-comment"># åŠ è½½.envæ–‡ä»¶</span>

llm = ChatOpenAI(
    base_url=os.getenv(<span class="hljs-string">"LLM_API_BASE"</span>),
    model=os.getenv(<span class="hljs-string">"LLM_MODEL"</span>),
    api_key=os.getenv(<span class="hljs-string">"LLM_API_KEY"</span>)
)
</code></pre>
</li>
<li>
<p><strong>src/graph.py</strong><br/>
å®šä¹‰LangGraphå›¾ç»“æ„ï¼ŒåŒ…å«ä¸€ä¸ªæç®€çš„å¯¹è¯é“¾è·¯ï¼ˆ<code>start â†’ agent â†’ end</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> Graph, StateGraph
<span class="hljs-keyword">from</span> langgraph.graph.message <span class="hljs-keyword">import</span> add_messages
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> src.llms <span class="hljs-keyword">import</span> llm

<span class="hljs-comment"># å®šä¹‰çŠ¶æ€ç»“æ„ï¼ˆå­˜å‚¨å¯¹è¯æ¶ˆæ¯åˆ—è¡¨ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    messages: <span class="hljs-built_in">list</span> = Field(default_factory=<span class="hljs-built_in">list</span>)

<span class="hljs-comment"># å®šä¹‰AgentèŠ‚ç‚¹é€»è¾‘ï¼ˆè°ƒç”¨LLMç”Ÿæˆå›å¤ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">agent</span>(<span class="hljs-params">state: State</span>):
    response = llm.invoke(state.messages)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>: [response]}

<span class="hljs-comment"># æ„å»ºå›¾ç»“æ„</span>
builder = StateGraph(State)
builder.add_node(<span class="hljs-string">"agent"</span>, agent)  <span class="hljs-comment"># æ·»åŠ AgentèŠ‚ç‚¹</span>
builder.set_entry_point(<span class="hljs-string">"agent"</span>)   <span class="hljs-comment"># å…¥å£ç‚¹ä¸ºAgent</span>
builder.set_finish_point(<span class="hljs-string">"agent"</span>) <span class="hljs-comment"># å‡ºå£ç‚¹ä¸ºAgent</span>
graph = builder.<span class="hljs-built_in">compile</span>()         <span class="hljs-comment"># ç¼–è¯‘ä¸ºå¯æ‰§è¡Œå›¾</span>

<span class="hljs-comment"># æš´éœ²åº”ç”¨å®ä¾‹ï¼ˆä¾›Studioè°ƒç”¨ï¼‰</span>
app = graph
</code></pre>
</li>
<li>
<p><strong>langgraph.json</strong><br/>
å…³è”LangGraph Studioä¸åº”ç”¨å®ä¾‹ï¼Œç¡®ä¿Studioèƒ½æ­£ç¡®åŠ è½½å›¾ç»“æ„ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"graphs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"default"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src.graph:app"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Clean Graph"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-13">LangGraph Studioä½¿ç”¨æŒ‡å—</h3>
<p>LangGraph Studioæ˜¯å¯è§†åŒ–è°ƒè¯•æ™ºèƒ½ä½“çš„æ ¸å¿ƒå·¥å…·ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>çŠ¶æ€è¿½è¸ª</strong><br/>
å®æ—¶å±•ç¤º<code>State</code>ä¸­<code>messages</code>åˆ—è¡¨çš„å˜åŒ–ï¼Œæ¸…æ™°æŸ¥çœ‹å¯¹è¯æ¶ˆæ¯çš„ç´¯åŠ è¿‡ç¨‹ã€‚</p>
</li>
<li>
<p><strong>èŠ‚ç‚¹æ‰§è¡Œå¯è§†åŒ–</strong><br/>
ä»¥æµç¨‹å›¾å½¢å¼å±•ç¤ºæ™ºèƒ½ä½“æ‰§è¡Œè·¯å¾„ï¼ˆå½“å‰ä¸º<code>start â†’ agent â†’ end</code>ï¼‰ï¼Œå¤æ‚é“¾è·¯å¯ç›´è§‚å‘ˆç°èŠ‚ç‚¹è·³è½¬é€»è¾‘ã€‚</p>
</li>
<li>
<p><strong>äº¤äº’æ¨¡å¼</strong></p>
<ul>
<li><strong>Graphæ¨¡å¼</strong>ï¼šå±•ç¤ºå®Œæ•´æ‰§è¡Œé“¾è·¯åŠä¸­é—´çŠ¶æ€ï¼Œé€‚åˆè°ƒè¯•ã€‚</li>
<li><strong>Chatæ¨¡å¼</strong>ï¼šéšè—ä¸­é—´è¿‡ç¨‹ï¼Œä»…å±•ç¤ºäººæœºäº¤äº’ç»“æœï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-14">åŸºæœ¬æ“ä½œæ­¥éª¤</h4>
<ol>
<li>åœ¨Studioç•Œé¢å·¦ä¾§è¾“å…¥æ¡†é€‰æ‹©<code>human</code>è§’è‰²ï¼Œè¾“å…¥å¯¹è¯å†…å®¹å¹¶æäº¤ã€‚</li>
<li>ç³»ç»Ÿä¼šè§¦å‘<code>agent</code>èŠ‚ç‚¹é€»è¾‘ï¼Œè°ƒç”¨LLMç”Ÿæˆå›å¤å¹¶æ›´æ–°<code>messages</code>çŠ¶æ€ã€‚</li>
<li>å¤šè½®å¯¹è¯æ—¶ï¼Œ<code>messages</code>åˆ—è¡¨ä¼šè‡ªåŠ¨ç´¯åŠ å†å²æ¶ˆæ¯ï¼Œå®ç°ä¸Šä¸‹æ–‡è¿è´¯ã€‚</li>
</ol>
<h3 data-id="heading-15">æ€»ç»“</h3>
<p>Clean Graphé€šè¿‡æç®€è®¾è®¡é™ä½äº†LangGraphçš„å­¦ä¹ é—¨æ§›ï¼Œå¼€å‘è€…å¯åŸºäºæ­¤æ¡†æ¶ï¼š</p>
<ul>
<li>å¿«é€Ÿç†è§£LangGraphçš„å›¾ç»“æ„ä¸èŠ‚ç‚¹ç¼–æ’é€»è¾‘</li>
<li>å€ŸåŠ©LangGraph Studioå¯è§†åŒ–è°ƒè¯•æ™ºèƒ½ä½“è¡Œä¸º</li>
<li>æ‰©å±•èŠ‚ç‚¹ä¸é“¾è·¯ï¼Œå®éªŒå¤æ‚æ™ºèƒ½ä½“åŠŸèƒ½ï¼ˆå¦‚å·¥å…·è°ƒç”¨ã€å¤šæ™ºèƒ½ä½“åä½œç­‰ï¼‰</li>
</ul>
<p>å¦‚éœ€è¿›ä¸€æ­¥å­¦ä¹ ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flanggraph%2Fstudio" target="_blank" title="https://docs.langchain.com/oss/python/langgraph/studio" ref="nofollow noopener noreferrer">LangGraph Studio Doc</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flanggraph%2Foverview" target="_blank" title="https://docs.langchain.com/oss/python/langgraph/overview" ref="nofollow noopener noreferrer">LangGraph Doc</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å¼€å§‹çš„ Godot ä¹‹æ—… â€” EP10ï¼šæœ‰é™çŠ¶æ€æœºï¼ˆäºŒï¼‰]]></title>    <link>https://juejin.cn/post/7571702660933517327</link>    <guid>https://juejin.cn/post/7571702660933517327</guid>    <pubDate>2025-11-13T02:38:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571702660933517327" data-draft-id="7571722835658113058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å¼€å§‹çš„ Godot ä¹‹æ—… â€” EP10ï¼šæœ‰é™çŠ¶æ€æœºï¼ˆäºŒï¼‰"/> <meta itemprop="keywords" content="Godot,æ¸¸æˆå¼€å‘"/> <meta itemprop="datePublished" content="2025-11-13T02:38:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆå°•å…­"/> <meta itemprop="url" content="https://juejin.cn/user/1392435974647373"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å¼€å§‹çš„ Godot ä¹‹æ—… â€” EP10ï¼šæœ‰é™çŠ¶æ€æœºï¼ˆäºŒï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1392435974647373/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆå°•å…­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:38:18.000Z" title="Thu Nov 13 2025 02:38:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶å¼€å§‹çš„ Godot ä¹‹æ—… â€” EP10ï¼šæœ‰é™çŠ¶æ€æœºï¼ˆäºŒï¼‰</h2>
<blockquote>
<p>åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†è®¾è®¡äº†æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰çš„åº•å±‚æ¶æ„ã€‚ç†è®ºç»ˆé¡»å®è·µï¼Œæœ¬èŠ‚æˆ‘ä»¬å°†æ­£å¼åœ¨é¡¹ç›®ä¸­åº”ç”¨è¿™å¥—çŠ¶æ€æœºï¼Œå¹¶é€šè¿‡æ”¹é€ ç©å®¶ï¼ˆPlayerï¼‰åœºæ™¯ï¼Œå°†æ¯ç‡¥çš„ä»£ç è®¾è®¡åŒ–ä¸ºç”ŸåŠ¨çš„è§’è‰²è¡Œä¸ºã€‚</p>
</blockquote>
<h3 data-id="heading-1">æ–°å»ºç›®å½•</h3>
<p>æˆ‘ä»¬é¦–å…ˆæ¥è°ƒæ•´ä¸€ä¸‹é¡¹ç›®ç»“æ„ï¼Œä¸ºæ¥ä¸‹æ¥çš„çŠ¶æ€æœºå®ç°åšå¥½å‡†å¤‡ã€‚</p>
<p>åœ¨<code>res://common/</code>ç›®å½•ä¸‹åˆ›å»º<code>state_machine/</code>ç›®å½•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01e21083b4474abfa85c74a629d0d1fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=Y50TUlmTToRKOuTzRaZGTlERg7U%3D" alt="alt text" loading="lazy"/></p>
<blockquote>
<p>æ²¡é”™ï¼Œæˆ‘ç¡®å®åˆ é™¤äº†åŸå…ˆçš„ script æ ¹ç›®å½•ã€‚è‡ªä»åœ¨ EP8 ä¸­å°†ç©å®¶ç›¸å…³çš„è„šæœ¬å’Œèµ„æºæ•´åˆåˆ°å…¶åœºæ™¯ç›®å½•ä¸‹åï¼Œæˆ‘æ„ˆå‘è§‰å¾—ä¸€ä¸ªç¬¼ç»Ÿçš„ <code>script</code> ç›®å½•æ„ä¹‰ä¸å¤§ã€‚Godot ä¸ Java æˆ– C# ä¸åŒï¼Œå®ƒä¸ä»¥è„šæœ¬ä¸ºæ ¸å¿ƒï¼Œè„šæœ¬æœ¬èº«ä¹Ÿä¸å…·å¤‡ä¸¥æ ¼çš„â€œåŒ…ï¼ˆpackageï¼‰â€æ¦‚å¿µã€‚å› æ­¤ï¼Œå°†æ‰€æœ‰è„šæœ¬é›†ä¸­å­˜æ”¾ï¼Œåè€Œä¼šå¯¼è‡´æˆ‘ä»¬åœ¨åœºæ™¯å’Œè„šæœ¬ç›®å½•é—´é¢‘ç¹åˆ‡æ¢ï¼Œæ—¢æµªè´¹æ—¶é—´ä¹Ÿä¸åˆ©äºç»„ä»¶çš„è¿ç§»ã€‚æ‰€ä»¥ï¼Œåç»­æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å¯èƒ½ä¼šæ›´å¤šåœ°ä»¥â€œåœºæ™¯â€ä¸ºæ ¸å¿ƒï¼Œè€Œéâ€œæ–‡ä»¶ç±»å‹â€ã€‚ï¼ˆè‡³å°‘ç›®å‰æ˜¯è¿™ä¹ˆæƒ³çš„ï¼‰</p>
</blockquote>
<p>åœ¨<code>state_machine</code>ç›®å½•ä¸­ï¼Œæˆ‘ä»¬ä¾æ¬¡åˆ›å»º<code>state_machine.gd</code>ã€<code>state.gd</code>ã€<code>state_transition.gd</code>ã€<code>state_loader.gd</code>è¿™å››ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†ä¸Šä¸€èŠ‚ä¸­æä¾›çš„ä»£ç åˆ†åˆ«ç²˜è´´è¿›å»ã€‚</p>
<p>è¯·ç‰¹åˆ«æ³¨æ„å®ƒä»¬çš„åŸºç±»ï¼š<code>state_machine</code> å’Œ <code>state</code> ç»§æ‰¿è‡ª <code>Node</code>ï¼Œè€Œ <code>state_transition</code> å’Œ <code>state_loader</code> ç»§æ‰¿è‡ª <code>RefCounted</code>ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆåŸºç±»ä¸åŒï¼Ÿè¿™æ˜¯å› ä¸º <code>StateMachine</code> å’Œ <code>State</code> ä½œä¸ºåœºæ™¯çš„ä¸€éƒ¨åˆ†éœ€è¦è¢«æŒ‚è½½åˆ°èŠ‚ç‚¹æ ‘ä¸Šï¼Œè€Œ <code>StateTransition</code> å’Œ <code>StateLoader</code> åªæ˜¯ç”¨äºæ‰¿è½½é€»è¾‘å’Œæ•°æ®çš„è¾…åŠ©ç±»ï¼Œæ— éœ€æˆä¸ºåœºæ™¯èŠ‚ç‚¹ï¼Œä½¿ç”¨è½»é‡çº§çš„ <code>RefCounted</code> å¯ä»¥æœ‰æ•ˆç®¡ç†å†…å­˜ã€‚</p>
</blockquote>
<p>åœ¨æ–°å»º <code>state_transition</code> è„šæœ¬æ—¶ï¼Œå¯ä»¥ç›´æ¥åœ¨Godotçš„åˆ›å»ºè„šæœ¬çª—å£é€‰æ‹©å…¶åŸºç±» <code>RefCounted</code>:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c2473a3cd07475b9e85137bf4607f4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=Vfa7qLdb%2FMicgfVbcXyC6q5MtEU%3D" alt="alt text" loading="lazy"/></p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬é€šç”¨çš„çŠ¶æ€æœºæ¨¡å—å°±åˆ›å»ºå¥½äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1a4ce7f617a4c66bac8a2719fdc6e63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=cDt%2BpSBi8KfbqOrvt9bcvZ%2BHpVA%3D" alt="alt text" loading="lazy"/></p>
<blockquote>
<p>æœ€æ–°çš„ä»£ç è¯·æŸ¥é˜…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fcy4ever%2Fsimple_rag" target="_blank" title="https://gitee.com/cy4ever/simple_rag" ref="nofollow noopener noreferrer">Gitee</a>ã€‚æˆ‘æœ‰æ—¶å¯èƒ½æ›´æ–°äº†ä»£ç ä½†æœªèƒ½åŠæ—¶åŒæ­¥åšå®¢ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯ä»¥Giteeä¸Šçš„ä¸ºå‡†ã€‚</p>
</blockquote>
<h3 data-id="heading-2">æ”¹é€ ç©å®¶åœºæ™¯</h3>
<p>åŸºç¡€çš„çŠ¶æ€æœºæ¡†æ¶æ­å»ºå®Œæ¯•ï¼Œç°åœ¨æ˜¯æ—¶å€™æ”¹é€ æˆ‘ä»¬çš„ç©å®¶åœºæ™¯ï¼Œè®©å®ƒçœŸæ­£â€œåŠ¨â€èµ·æ¥äº†ã€‚</p>
<p>æˆ‘ä»¬æ‰“å¼€ç©å®¶åœºæ™¯ï¼Œåœ¨æ ¹èŠ‚ç‚¹ï¼ˆ<code>CharacterBody2D</code>ï¼‰ä¸‹æ·»åŠ ä¸€ä¸ª <code>StateMachine</code> èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶å‘½åä¸º<code>StateMachine</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7af8072cb634dd78e69e0e9cb358cea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=AA1YhuLwiErNPP9IMY2A7AN2qOs%3D" alt="alt text" loading="lazy"/></p>
<p>åœ¨æ£€æŸ¥å™¨ä¸­è®¾ç½®è¯¥ <code>StateMachine</code> èŠ‚ç‚¹çš„å±æ€§ï¼š</p>
<ul>
<li>å°† <code>Auto Load Mode</code> è®¾ç½®ä¸º <code>NODE</code>ï¼Œè¿™æ ·çŠ¶æ€æœºä¼šè‡ªåŠ¨åŠ è½½å…¶å­èŠ‚ç‚¹ä½œä¸ºçŠ¶æ€ã€‚</li>
<li>å°† <code>Initial State</code> è®¾ç½®ä¸º <code>idle</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬å¸Œæœ›çš„åˆå§‹çŠ¶æ€ã€‚</li>
</ul>
<blockquote>
<p>ä½ å¯èƒ½ä¼šå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è‡ªå·±å†™çš„è„šæœ¬ç±»ï¼ˆStateMachineï¼‰èƒ½åƒå†…ç½®èŠ‚ç‚¹ä¸€æ ·è¢«æ·»åŠ åˆ°åœºæ™¯ä¸­ï¼Ÿç­”æ¡ˆå°±åœ¨äºç»§æ‰¿ã€‚å› ä¸ºæˆ‘ä»¬çš„ <code>StateMachine</code> ç±»ç»§æ‰¿è‡ª <code>Node</code>ï¼Œè€Œ Godot ä¸­æ‰€æœ‰ <code>Node</code> éƒ½å¯ä»¥è¢«æ·»åŠ åˆ°åœºæ™¯æ ‘é‡Œã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿ Godot æä¾›çš„ä»»æ„èŠ‚ç‚¹ç±»æ¥åˆ›é€ åŠŸèƒ½ä¸°å¯Œçš„è‡ªå®šä¹‰èŠ‚ç‚¹ï¼</p>
</blockquote>
<h4 data-id="heading-3">åˆ›å»ºçŠ¶æ€èŠ‚ç‚¹</h4>
<p>æˆ‘ä»¬ä¹‹å‰ä¸ºç©å®¶è®¾è®¡äº† <code>idle</code>ã€<code>walk</code>ã€<code>attack</code> ä¸‰ä¸ªåŠ¨ç”»ï¼Œç°åœ¨éœ€è¦ä¸ºå®ƒä»¬åˆ†åˆ«åˆ›å»ºå¯¹åº”çš„çŠ¶æ€èŠ‚ç‚¹ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆ›å»º <code>idle</code> çŠ¶æ€ã€‚åœ¨ <code>StateMachine</code> èŠ‚ç‚¹ä¸‹æ·»åŠ ä¸€ä¸ª <code>State</code> èŠ‚ç‚¹ï¼Œå°†å…¶å‘½åä¸º <code>idle</code>ï¼Œå¹¶åœ¨æ£€æŸ¥å™¨ä¸­å°†å®ƒçš„ <code>State Name</code> å±æ€§ä¹Ÿè®¾ç½®ä¸º <code>idle</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c836647d7204b1fb0e291a7664f475e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=BYm9T6wva6YhAKZp1HzwbFa0nSY%3D" alt="alt text" loading="lazy"/></p>
<p>æ¥ç€ï¼Œç”¨åŒæ ·çš„æ–¹æ³•åˆ›å»º <code>walk</code> å’Œ <code>attack</code> ä¸¤ä¸ªçŠ¶æ€èŠ‚ç‚¹ï¼Œå¹¶åˆ†åˆ«è®¾ç½®å¥½å®ƒä»¬çš„å‘½åå’Œ <code>State Name</code> å±æ€§ã€‚</p>
<p>åˆ›å»ºå®Œæˆåçš„èŠ‚ç‚¹ç»“æ„åº”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e56be5a997d45b1989b66502ee6b72e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=o%2BBnrkmS9etaS7YXaN8A8YNncNU%3D" alt="alt text" loading="lazy"/></p>
<h4 data-id="heading-4">å¯åŠ¨çŠ¶æ€æœº</h4>
<p>å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæˆ‘ä»¬å›åˆ° <code>player.gd</code> è„šæœ¬ã€‚æŒ‰ä½ <code>Ctrl (Cmd)</code> é”®ï¼Œå°†åœºæ™¯æ ‘ä¸­çš„ <code>StateMachine</code> èŠ‚ç‚¹æ‹–æ‹½åˆ°è„šæœ¬ç¼–è¾‘å™¨ä¸­ã€‚Godot ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª <code>@onready</code> å˜é‡ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°è¯¥èŠ‚ç‚¹ä¸Šï¼Œéå¸¸æ–¹ä¾¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75c19873a62b43249901c5e1aea39b82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=N1%2BWRnNIhXJUyRp5qMpTALXYznk%3D" alt="alt text" loading="lazy"/></p>
<p>ç„¶åï¼Œåœ¨ <code>player.gd</code> ä¸­æ·»åŠ  <code>_ready</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šåœ¨ Player èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹éƒ½å‡†å¤‡å°±ç»ªåè¢«è°ƒç”¨ã€‚æˆ‘ä»¬åœ¨å…¶ä¸­å¯åŠ¨çŠ¶æ€æœºï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript">## çŠ¶æ€æœº
@onready var state_machine: StateMachine = $StateMachine

func _ready() -&gt; void:
	# å¯åŠ¨çŠ¶æ€æœº
	state_machine.start()
</code></pre>
<p>ç°åœ¨å¯åŠ¨æ¸¸æˆï¼Œä½ å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°çŠ¶æ€æœºå·²æˆåŠŸåŠ è½½äº†ä¸‰ä¸ªçŠ¶æ€ï¼Œå¹¶è¿›å…¥äº†æˆ‘ä»¬è®¾å®šçš„é»˜è®¤çŠ¶æ€ <code>idle</code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70ec232a78dc41d3aec5600e5f180893~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=N3Y%2BaZ1zA9lTlWNBM4IJ1bjrrLU%3D" alt="alt text" loading="lazy"/></p>
<h3 data-id="heading-5">æ›´æ–°è„šæœ¬</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ï¼š</p>
<ul>
<li>é€šç”¨çŠ¶æ€æœºèŠ‚ç‚¹çš„åˆ›å»º</li>
<li>ç©å®¶åœºæ™¯ç»“æ„çš„æ”¹é€ </li>
<li>çŠ¶æ€æœºçš„åˆæ­¥å¯åŠ¨</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¼€å§‹ç¼–å†™å„ä¸ªçŠ¶æ€çš„å…·ä½“é€»è¾‘ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦å…ˆå¯¹ <code>player.gd</code> åšä¸€äº›æ¸…ç†å’Œè°ƒæ•´ï¼Œç§»é™¤æ—§çš„ã€å°†è¢«çŠ¶æ€æœºæ›¿ä»£çš„é€»è¾‘ã€‚</p>
<ol>
<li><strong>æ¸…ç©º <code>_physics_process</code> å‡½æ•°</strong>ï¼šå…¶ä¸­çš„é€»è¾‘å°†ç”±å„ä¸ªçŠ¶æ€è„šæœ¬æ¥ç®¡ã€‚
<pre><code class="hljs language-GDScript" lang="GDScript">func _physics_process(_delta: float) -&gt; void:
	pass
</code></pre>
</li>
<li><strong>ç§»é™¤æ—§çš„æ”»å‡»ç›¸å…³å˜é‡</strong>ï¼š<code>attack_duration</code>ã€<code>attack_timer</code>ã€<code>is_attacking</code> å°†è¢«ç§»å…¥æ”»å‡»çŠ¶æ€ï¼ˆAttack Stateï¼‰ä¸­ç®¡ç†ã€‚</li>
<li><strong>æ›´æ–° <code>update_animation</code> å‡½æ•°</strong>ï¼šè®©å®ƒä»çŠ¶æ€æœºè·å–å½“å‰çŠ¶æ€åç§°ã€‚
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">- var current_state: String = "idle" # æˆ–è€… "walk"</span>
<span class="hljs-addition">+ var current_state: String = state_machine.get_current_state_name()</span>
</code></pre>
</li>
</ol>
<p>è°ƒæ•´åçš„ <code>player.gd</code> å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript">extends CharacterBody2D

# å¯åœ¨æ£€æŸ¥å™¨é‡Œè°ƒæ•´çš„ç§»åŠ¨é€Ÿåº¦
@export var speed: float = 100.0

# å½“å‰è¾“å…¥æ–¹å‘å‘é‡ï¼ˆå•ä½åŒ–å‰çš„åŸå§‹è¾“å…¥ï¼‰
var move_direction: Vector2 = Vector2.ZERO

# ç©å®¶æœå‘ï¼Œé»˜è®¤æœä¸‹
var player_direction: Vector2 = Vector2.DOWN

# ç»„ä»¶å¼•ç”¨
## åŠ¨ç”»å­èŠ‚ç‚¹
@onready var animation_player: AnimationPlayer = $AnimationPlayer
## ç²¾çµ
@onready var sprite: Sprite2D = $Sprite2D
## çŠ¶æ€æœº
@onready var state_machine: StateMachine = $StateMachine

func _ready() -&gt; void:
	# å¯åŠ¨çŠ¶æ€æœº
	state_machine.start()

func _process(_delta: float) -&gt; void:
	pass

func _physics_process(_delta: float) -&gt; void:
	pass

# æ›´æ–°æœå‘å’ŒåŠ¨ç”»
# @return æ— è¿”å›å€¼
func update_direction_and_animation() -&gt; void:
	# æ›´æ–°æœå‘ï¼ˆåªåœ¨æœ‰ç§»åŠ¨æ—¶æ›´æ–°ï¼Œä½¿ç”¨æ ‡å‡†æ–¹å‘ï¼‰
	if move_direction != Vector2.ZERO:
		var new_direction: Vector2
		if abs(move_direction.x) &gt; abs(move_direction.y):
			new_direction = Vector2.RIGHT if move_direction.x &gt; 0 else Vector2.LEFT
		else:
			new_direction = Vector2.DOWN if move_direction.y &gt; 0 else Vector2.UP
		
		# å¦‚æœæœå‘å‘ç”Ÿå˜åŒ–,æ›´æ–°ç©å®¶æœå‘
		if new_direction != player_direction:
			player_direction = new_direction
	# æ›´æ–°åŠ¨ç”»
	update_animation()


# æ›´æ–°è§’è‰²åŠ¨ç”»
# @return æ— è¿”å›å€¼
func update_animation() -&gt; void:
	var current_state: String = state_machine.get_current_state_name()
	var direction: String = get_anim_direction()
	var animation_name: String = current_state + "_" + direction

	if animation_player.has_animation(animation_name):
		animation_player.play(animation_name)
	else:
		print_debug("åŠ¨ç”»ä¸å­˜åœ¨: ", animation_name)


# è·å–åŠ¨ç”»æ–¹å‘å­—ç¬¦ä¸²
# @return æ–¹å‘å­—ç¬¦ä¸²ï¼ˆ"down", "up", æˆ– "side"ï¼‰
func get_anim_direction() -&gt; String:
	if abs(player_direction.x) &gt; abs(player_direction.y):
		sprite.flip_h = player_direction.x &lt; 0
		return "side"
	if player_direction.y &lt; 0:
		return "up"
	return "down"

</code></pre>
<h4 data-id="heading-6">å¾…æœºçŠ¶æ€ï¼ˆIdle Stateï¼‰</h4>
<p>æˆ‘ä»¬å…ˆæ¥æ¢³ç†ä¸€ä¸‹å¾…æœºçŠ¶æ€çš„é€»è¾‘ï¼š</p>
<ul>
<li><strong>è¿›å…¥æ—¶</strong>ï¼šæ’­æ”¾å¾…æœºåŠ¨ç”»ã€‚</li>
<li><strong>æŒç»­æ—¶</strong>ï¼š
<ul>
<li>ç¡®ä¿ç©å®¶é€Ÿåº¦ä¸ºé›¶ï¼Œä¿æŒé™æ­¢ã€‚</li>
<li>æŒç»­æ›´æ–°åŠ¨ç”»ä»¥å“åº”ç©å®¶çš„æœå‘å˜åŒ–ã€‚</li>
</ul>
</li>
<li><strong>é€€å‡ºæ¡ä»¶</strong>ï¼šç”±çŠ¶æ€è½¬æ¢è§„åˆ™è‡ªåŠ¨å¤„ç†ï¼ˆä¾‹å¦‚ï¼Œæ£€æµ‹åˆ°ç§»åŠ¨è¾“å…¥ï¼‰ã€‚</li>
</ul>
<p>ç°åœ¨ï¼Œä¸º <code>idle</code> çŠ¶æ€èŠ‚ç‚¹é™„åŠ ä¸€ä¸ªæ–°è„šæœ¬ã€‚æˆ‘å°†å…¶å‘½åä¸º <code>player_idle_state.gd</code> å¹¶å­˜æ”¾åœ¨ <code>res://scenes/entities/player/scripts/states/</code> ç›®å½•ä¸‹ã€‚è¯·æ³¨æ„ï¼Œå®ƒéœ€è¦ç»§æ‰¿è‡ªæˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ <code>State</code> åŸºç±»ã€‚</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># PlayerIdleState.gd
# ç©å®¶ç©ºé—²çŠ¶æ€
# @author chenrui
# @date 2025-08-31
class_name PlayerIdleState
extends State


# è¿›å…¥çŠ¶æ€æ—¶è°ƒç”¨
func enter(_previous_state: String = "", _data: Dictionary = {}) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		printerr("é”™è¯¯: æ— æ³•è·å–ç©å®¶èŠ‚ç‚¹")
		return

	if player.has_method("update_animation"):
		player.update_animation()


# ç‰©ç†å¸§æ›´æ–°
func physics_update(_delta: float) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		printerr("é”™è¯¯: æ— æ³•è·å–ç©å®¶èŠ‚ç‚¹")
		return

	# ä¿æŒé™æ­¢ - è½¬æ¢ç”±è‡ªåŠ¨è½¬æ¢è§„åˆ™å¤„ç†
	player.velocity = Vector2.ZERO
	player.move_and_slide()
	# æ›´æ–°è§’è‰²æœå‘å’ŒåŠ¨ç”»
	player.update_direction_and_animation()
</code></pre>
<blockquote>
<p>åœ¨çŠ¶æ€è„šæœ¬ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>get_state_owner()</code> æ–¹æ³•æ–¹ä¾¿åœ°è·å–åˆ°ç©å®¶èŠ‚ç‚¹ï¼ˆCharacterBody2Dï¼‰çš„å®ä¾‹ï¼Œä»è€Œç›´æ¥è°ƒç”¨å…¶èº«ä¸Šçš„æ–¹æ³•å’Œå±æ€§ã€‚</p>
</blockquote>
<h4 data-id="heading-7">è¡Œèµ°çŠ¶æ€ï¼ˆWalk Stateï¼‰</h4>
<p>æ¥ç€æ˜¯è¡Œèµ°çŠ¶æ€çš„é€»è¾‘ï¼š</p>
<ul>
<li><strong>è¿›å…¥æ—¶</strong>ï¼šæ’­æ”¾è¡Œèµ°åŠ¨ç”»ã€‚</li>
<li><strong>æŒç»­æ—¶</strong>ï¼š
<ul>
<li>æ¥æ”¶ç©å®¶çš„ç§»åŠ¨è¾“å…¥ã€‚</li>
<li>æ ¹æ®è¾“å…¥è®¡ç®—å½’ä¸€åŒ–çš„ç§»åŠ¨æ–¹å‘ã€‚</li>
<li>æ›´æ–° <code>player</code> çš„é€Ÿåº¦å±æ€§å¹¶è°ƒç”¨ <code>move_and_slide()</code> ä½¿å…¶ç§»åŠ¨ã€‚</li>
<li>æŒç»­æ›´æ–°è§’è‰²æœå‘å’ŒåŠ¨ç”»ã€‚</li>
</ul>
</li>
<li><strong>é€€å‡ºæ¡ä»¶</strong>ï¼šç”±çŠ¶æ€è½¬æ¢è§„åˆ™è‡ªåŠ¨å¤„ç†ï¼ˆä¾‹å¦‚ï¼Œä¸å†æœ‰ç§»åŠ¨è¾“å…¥ï¼‰ã€‚</li>
</ul>
<p>æˆ‘ä»¬ä¸º <code>walk</code> çŠ¶æ€èŠ‚ç‚¹æ–°å¢ä¸€ä¸ªè„šæœ¬ï¼Œå‘½åä¸º<code>player_walk_state.gd</code>ï¼ŒåŒæ ·ç»§æ‰¿è‡ª <code>State</code> åŸºç±»ï¼Œå¹¶å­˜æ”¾åœ¨ç›¸åŒçš„çŠ¶æ€è„šæœ¬ç›®å½•ä¸‹ã€‚</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># PlayerWalkState.gd
# ç©å®¶è¡Œèµ°çŠ¶æ€
# @author chenrui
# @date 2025-08-31
class_name PlayerWalkState
extends State

# è¿›å…¥çŠ¶æ€æ—¶è°ƒç”¨
func enter(_previous_state: String = "", _data: Dictionary = {}) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		printerr("é”™è¯¯: æ— æ³•è·å–ç©å®¶èŠ‚ç‚¹")
		return
	
	# æ’­æ”¾è¡Œèµ°åŠ¨ç”»
	if player.has_method("update_animation"):
		player.update_animation()

# é€»è¾‘å¸§æ›´æ–°
func update(_delta: float) -&gt; void:
	pass


# ç‰©ç†å¸§æ›´æ–°
func physics_update(_delta: float) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		printerr("é”™è¯¯: æ— æ³•è·å–ç©å®¶èŠ‚ç‚¹")
		return
		
	# æ¥æ”¶è¾“å…¥,è®¡ç®—ç§»åŠ¨æ–¹å‘
	var x_axis: float = Input.get_axis("left", "right")
	var y_axis: float = Input.get_axis("up", "down")
	var move_direction = Vector2(x_axis, y_axis)
	# ç§»åŠ¨æ–¹å‘å¤§äº1æ—¶å½’ä¸€åŒ–
	if move_direction.length() &gt; 1.0:
		move_direction = move_direction.normalized()

	player.move_direction = move_direction
	# ä½¿ç”¨Playerä¸­çš„move_directionå’Œspeed
	player.velocity = player.move_direction * player.speed
	player.move_and_slide()
	# æ›´æ–°è§’è‰²æœå‘å’ŒåŠ¨ç”»
	player.update_direction_and_animation()
</code></pre>
<h4 data-id="heading-8">æ”»å‡»çŠ¶æ€ï¼ˆAttack Stateï¼‰</h4>
<p>æœ€åæ˜¯æ”»å‡»çŠ¶æ€çš„é€»è¾‘ï¼š</p>
<ul>
<li><strong>è¿›å…¥æ—¶</strong>:
<ul>
<li>é‡ç½®æ”»å‡»è®¡æ—¶å™¨ã€‚</li>
<li>æ’­æ”¾æ”»å‡»åŠ¨ç”»ã€‚</li>
</ul>
</li>
<li><strong>æŒç»­æ—¶</strong>:
<ul>
<li>è®¡æ—¶å™¨ç´¯åŠ æ”»å‡»æ—¶é•¿ã€‚</li>
<li>ç¡®ä¿è§’è‰²åœ¨æ”»å‡»æ—¶ä¿æŒé™æ­¢ã€‚</li>
<li>æ›´æ–°ç©å®¶æœå‘å’ŒåŠ¨ç”»ã€‚</li>
</ul>
</li>
<li><strong>å®Œæˆæ¡ä»¶ (<code>is_finished</code>)</strong>:
<ul>
<li>å½“æ”»å‡»è®¡æ—¶å™¨è¶…è¿‡é¢„è®¾çš„æ”»å‡»æ—¶é•¿åï¼Œæ­¤å‡½æ•°è¿”å› <code>true</code>ï¼Œå‘ŠçŸ¥çŠ¶æ€æœºè¯¥çŠ¶æ€å·²å®Œæˆï¼Œå¯ä»¥è¿›è¡Œè½¬æ¢ã€‚</li>
</ul>
</li>
</ul>
<p>æ”»å‡»çŠ¶æ€ä¸å¾…æœºã€è¡Œèµ°çŠ¶æ€ç•¥æœ‰ä¸åŒã€‚ä¸ºäº†ç¡®ä¿æ”»å‡»åŠ¨ä½œçš„å®Œæ•´æ€§ï¼Œè§’è‰²çš„æ”»å‡»çŠ¶æ€éœ€è¦ç­‰å¾…åŠ¨ç”»æ’­æ”¾å®Œæ¯•åæ‰èƒ½é€€å‡ºã€‚åœ¨æ­¤æœŸé—´ï¼Œå®ƒä¸åº”è¯¥è¢«å…¶ä»–çŠ¶æ€ï¼ˆå¦‚ç§»åŠ¨ï¼‰æ‰“æ–­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ”»å‡»çŠ¶æ€ä¸­å®ç° <code>is_finished()</code> å‡½æ•°æ¥å‘ŠçŸ¥çŠ¶æ€æœºè¯¥çŠ¶æ€ä½•æ—¶â€œå®Œæˆâ€ã€‚</p>
<p>æˆ‘ä»¬ä¸º <code>attack</code> çŠ¶æ€èŠ‚ç‚¹æ–°å¢ä¸€ä¸ªè„šæœ¬ï¼Œå‘½åä¸º <code>player_attack_state.gd</code>ï¼Œå¹¶å­˜æ”¾åœ¨çŠ¶æ€è„šæœ¬ç›®å½•ä¸‹ã€‚</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># PlayerAttackState.gd
# ç©å®¶æ”»å‡»çŠ¶æ€
# @author chenrui
# @date 2025-08-31
class_name PlayerAttackState
extends State

## æ”»å‡»æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰
@export var attack_duration: float = 0.3

## æ”»å‡»è®¡æ—¶å™¨ï¼Œç”¨äºè·Ÿè¸ªæ”»å‡»è¿›åº¦
var attack_timer: float = 0.0

# è¿›å…¥çŠ¶æ€æ—¶è°ƒç”¨
func enter(_previous_state: String = "", _data: Dictionary = {}) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		printerr("é”™è¯¯: æ— æ³•è·å–ç©å®¶èŠ‚ç‚¹")
		return

	attack_timer = 0.0

	# æ’­æ”¾æ”»å‡»åŠ¨ç”»
	if player.has_method("update_animation"):
		player.update_animation()


# é€»è¾‘å¸§æ›´æ–°
func update(delta: float) -&gt; void:
	attack_timer += delta
	# æ”»å‡»ç»“æŸçš„è½¬æ¢ç”±è‡ªåŠ¨è½¬æ¢è§„åˆ™å¤„ç†


# ç‰©ç†å¸§æ›´æ–°
func physics_update(_delta: float) -&gt; void:
	var player: CharacterBody2D = get_state_owner()
	if player == null:
		return

	# æ”»å‡»æ—¶ä¿æŒé™æ­¢
	player.velocity = Vector2.ZERO
	player.move_and_slide()
	
	# æ›´æ–°è§’è‰²æœå‘å’ŒåŠ¨ç”»
	player.update_direction_and_animation()


# æ£€æŸ¥çŠ¶æ€æ˜¯å¦å®Œæˆ
# @return æ˜¯å¦å®Œæˆ
func is_finished() -&gt; bool:
	return attack_timer &gt;= attack_duration
</code></pre>
<h4 data-id="heading-9">å®ç°çŠ¶æ€åˆ‡æ¢</h4>
<p>ç°åœ¨ï¼Œå„ä¸ªçŠ¶æ€çš„ç‹¬ç«‹é€»è¾‘å·²ç»å®Œæˆã€‚ä½†è§’è‰²è¿˜æ— æ³•åœ¨ä¸åŒçŠ¶æ€é—´åˆ‡æ¢ï¼Œå› ä¸ºæˆ‘ä»¬å°šæœªå®šä¹‰åˆ‡æ¢çš„â€œè§„åˆ™â€ã€‚</p>
<p>æˆ‘ä»¬è®¾è®¡çš„çŠ¶æ€æœºæä¾›äº†ä¸€å¥—åŸºäºè§„åˆ™çš„è‡ªåŠ¨è½¬æ¢æœºåˆ¶ã€‚æˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ç³»åˆ— <code>StateTransition</code> å®ä¾‹ï¼Œå¹¶å‘ŠçŸ¥çŠ¶æ€æœºâ€œåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Œä»å“ªä¸ªçŠ¶æ€è½¬æ¢åˆ°å“ªä¸ªçŠ¶æ€â€ï¼Œå®ƒå°±ä¼šåœ¨æ¯ä¸€å¸§è‡ªåŠ¨æ£€æŸ¥å¹¶æ‰§è¡Œç¬¦åˆæ¡ä»¶çš„è½¬æ¢ã€‚</p>
<p>ä¸€ä¸ª <code>StateTransition</code> å®ä¾‹éœ€è¦ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li><code>_from_state: String</code> - æºçŠ¶æ€åç§°</li>
<li><code>_to_state: String</code> - ç›®æ ‡çŠ¶æ€åç§°</li>
<li><code>_condition: Callable</code> - è½¬æ¢æ¡ä»¶å‡½æ•°</li>
<li><code>_priority: int</code> - è½¬æ¢ä¼˜å…ˆçº§</li>
</ul>
<p>å…¶ä¸­ï¼Œè½¬æ¢æ¡ä»¶ï¼ˆ<code>condition</code>ï¼‰æ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”å€¼çš„ <code>Callable</code>ï¼ˆé€šå¸¸æ˜¯åŒ¿åå‡½æ•°ï¼‰ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æ»¡è¶³è½¬æ¢æ—¶æœºã€‚ä¼˜å…ˆçº§ï¼ˆ<code>priority</code>ï¼‰åˆ™ç”¨äºè§£å†³å½“å¤šä¸ªè½¬æ¢è§„åˆ™åŒæ—¶æ»¡è¶³æ—¶ï¼Œåº”ä¼˜å…ˆæ‰§è¡Œå“ªä¸€ä¸ªçš„é—®é¢˜ï¼ˆæ•°å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰ã€‚</p>
<p>æˆ‘ä»¬ä»¥ <code>idle</code> åˆ° <code>walk</code> çš„è½¬æ¢ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># ä» idle åˆ° walkï¼šæœ‰ç§»åŠ¨è¾“å…¥æ—¶
var idle_to_walk_condition: Callable = func():
	return Input.is_action_pressed("up") or Input.is_action_pressed("down") or Input.is_action_pressed("left") or Input.is_action_pressed("right")
var idle_to_walk_transition: StateTransition = StateTransition.new(PlayerConsts.STATE_IDLE, PlayerConsts.STATE_WALK, idle_to_walk_condition, 5)
state_machine.add_transition(idle_to_walk_transition)
</code></pre>
<p>è¿™é‡Œçš„ <code>idle_to_walk_condition</code> å°±æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå®ƒæ£€æŸ¥æ˜¯å¦æœ‰ç§»åŠ¨é”®è¢«æŒ‰ä¸‹ã€‚<code>StateTransition</code> å®šä¹‰äº†ä» <code>idle</code> åˆ° <code>walk</code> çš„è½¬æ¢ï¼Œä¼˜å…ˆçº§ä¸º <code>5</code>ã€‚æœ€åï¼Œé€šè¿‡ <code>add_transition</code> å°†è¿™ä¸ªè§„åˆ™æ³¨å†Œåˆ°çŠ¶æ€æœºä¸­ã€‚</p>
<p>ä¸ºäº†é¿å…åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¤§é‡çš„çŠ¶æ€åå­—ç¬¦ä¸²ï¼ˆè¿™å¾ˆå®¹æ˜“å› æ‹¼å†™é”™è¯¯è€Œå‡ºé—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬æœ€å¥½åˆ›å»ºä¸€ä¸ªç©å®¶å¸¸é‡è„šæœ¬æ¥ç»Ÿä¸€ç®¡ç†è¿™äº›åç§°ã€‚</p>
<p>åœ¨<code>res://scenes/entities/player/scripts/</code>ç›®å½•ä¸‹åˆ›å»º<code>player_consts.gd</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># PlayerConsts.gd
# ç©å®¶å¸¸é‡å®šä¹‰
# @author chenrui
# @date 2025-08-31
class_name PlayerConsts
extends RefCounted

# çŠ¶æ€å¸¸é‡
const STATE_IDLE: String = "idle"
const STATE_WALK: String = "walk"
const STATE_ATTACK: String = "attack"
const STATE_HURT: String = "hurt"
const STATE_DIE: String = "die"

</code></pre>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨ <code>player.gd</code> ä¸­ç¼–å†™ä¸€ä¸ª <code>_setup_transitions</code> å‡½æ•°ï¼Œé›†ä¸­å®šä¹‰æ‰€æœ‰çŠ¶æ€çš„è½¬æ¢è§„åˆ™ï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># è®¾ç½®çŠ¶æ€è½¬æ¢è§„åˆ™
func _setup_transitions() -&gt; void:
	# ä»ä»»æ„çŠ¶æ€åˆ°æ”»å‡»çŠ¶æ€ï¼šæŒ‰ä¸‹æ”»å‡»é”®æ—¶
	var attack_condition: Callable = func(): return Input.is_action_just_pressed("attack")
	var attack_transition: StateTransition = StateTransition.new("*", PlayerConsts.STATE_ATTACK, attack_condition, 10)  # é«˜ä¼˜å…ˆçº§ï¼Œç¡®ä¿æ”»å‡»èƒ½æ‰“æ–­å…¶ä»–çŠ¶æ€
	state_machine.add_transition(attack_transition)

	# ä» idle åˆ° walkï¼šæœ‰ç§»åŠ¨è¾“å…¥æ—¶
	var idle_to_walk_condition: Callable = func():
		return Input.is_action_pressed("up") or Input.is_action_pressed("down") or Input.is_action_pressed("left") or Input.is_action_pressed("right")
	var idle_to_walk_transition: StateTransition = StateTransition.new(PlayerConsts.STATE_IDLE, PlayerConsts.STATE_WALK, idle_to_walk_condition, 5)
	state_machine.add_transition(idle_to_walk_transition)

	# ä» walk åˆ° idleï¼šæ²¡æœ‰ç§»åŠ¨è¾“å…¥æ—¶
	var walk_to_idle_condition: Callable = func():
		return not (Input.is_action_pressed("up") or Input.is_action_pressed("down") or Input.is_action_pressed("left") or Input.is_action_pressed("right"))
	var walk_to_idle_transition: StateTransition = StateTransition.new(PlayerConsts.STATE_WALK, PlayerConsts.STATE_IDLE, walk_to_idle_condition, 5)
	state_machine.add_transition(walk_to_idle_transition)

	# ä» attack åˆ° walkï¼šæ”»å‡»ç»“æŸä¸”æœ‰ç§»åŠ¨è¾“å…¥æ—¶
	var attack_to_walk_condition: Callable = func(): return  move_direction != Vector2.ZERO
	var attack_to_walk_transition: StateTransition = StateTransition.new(PlayerConsts.STATE_ATTACK, PlayerConsts.STATE_WALK, attack_to_walk_condition, 5)
	state_machine.add_transition(attack_to_walk_transition)

	# ä» attack åˆ° idleï¼šæ”»å‡»ç»“æŸä¸”æ²¡æœ‰ç§»åŠ¨è¾“å…¥æ—¶
	var attack_to_idle_condition: Callable = func(): return  move_direction == Vector2.ZERO
	var attack_to_idle_transition: StateTransition = StateTransition.new(PlayerConsts.STATE_ATTACK, PlayerConsts.STATE_IDLE, attack_to_idle_condition, 5)
	state_machine.add_transition(attack_to_idle_transition)
</code></pre>
<p>æœ€åï¼Œåˆ«å¿˜äº†åœ¨ <code>_ready</code> å‡½æ•°ä¸­è°ƒç”¨è¿™ä¸ªè®¾ç½®æ–¹æ³•ï¼Œç¡®ä¿åœ¨çŠ¶æ€æœºå¯åŠ¨å‰æ‰€æœ‰è§„åˆ™éƒ½å·²æ³¨å†Œï¼š</p>
<pre><code class="hljs language-GDScript" lang="GDScript"># åˆå§‹åŒ–å‡½æ•°
func _ready() -&gt; void:
	# æ·»åŠ è½¬æ¢è§„åˆ™
	_setup_transitions()

	# å¯åŠ¨çŠ¶æ€æœº
	state_machine.start()
</code></pre>
<h3 data-id="heading-10">æœ€ç»ˆæµ‹è¯•</h3>
<p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼ç°åœ¨è¿è¡Œæ¸¸æˆï¼Œä½ ä¼šå‘ç°è§’è‰²çš„è¡Œä¸ºå’Œä¹‹å‰å®Œå…¨ä¸€æ ·ï¼Œå¯ä»¥æµç•…åœ°ç§»åŠ¨ã€ç«™ç«‹å’Œæ”»å‡»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fc6bf62047b4e0788a0045233677e68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=A1nkyaTzFaixKSGasrZGTel7rl8%3D" alt="alt text" loading="lazy"/></p>
<p>ä½†è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬çš„ä»£ç ç»“æ„å·²ç»ç„•ç„¶ä¸€æ–°ã€‚æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°è§’è‰²æ­£åœ¨æˆ‘ä»¬å®šä¹‰çš„è§„åˆ™ä¸‹ï¼Œäºå„ä¸ªçŠ¶æ€é—´ç²¾å‡†åœ°åˆ‡æ¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/975558b1a72a46129ea4bbc42c1856a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmI5bCV5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763606298&amp;x-signature=lyMDyVrvukUJfhuBRcV3k3qu9h8%3D" alt="alt text" loading="lazy"/></p>
<h3 data-id="heading-11">æœ¬èŠ‚å°ç»“</h3>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸Šä¸€ç« è®¾è®¡çš„æœ‰é™çŠ¶æ€æœºæ¶æ„æˆåŠŸåº”ç”¨åˆ°äº†é¡¹ç›®ä¸­ï¼Œå½»åº•é‡æ„äº†ç©å®¶çš„æ§åˆ¶é€»è¾‘ã€‚æˆ‘ä»¬ä¸ä»…å®Œæˆäº†ä»£ç å±‚é¢çš„è¿ç§»ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€å¥—æ¸…æ™°ã€å¯æ‰©å±•çš„è§’è‰²è¡Œä¸ºç®¡ç†æ¡†æ¶ã€‚</p>
<h4 data-id="heading-12">æ ¸å¿ƒå®è·µå›é¡¾</h4>
<ol>
<li><strong>çŠ¶æ€æœºé›†æˆ</strong>ï¼šå°†é€šç”¨çš„çŠ¶æ€æœºè„šæœ¬å’ŒèŠ‚ç‚¹é›†æˆåˆ°ç©å®¶åœºæ™¯ä¸­ï¼Œå¹¶å®Œæˆäº†åˆå§‹åŒ–é…ç½®ã€‚</li>
<li><strong>çŠ¶æ€å®ç°</strong>ï¼šä¸ºâ€œå¾…æœºâ€ã€â€œè¡Œèµ°â€å’Œâ€œæ”»å‡»â€åˆ›å»ºäº†å„è‡ªç‹¬ç«‹çš„çŠ¶æ€è„šæœ¬ï¼Œå°†åŸæœ¬è€¦åˆåœ¨ <code>player.gd</code> ä¸­çš„é€»è¾‘è¿›è¡Œäº†è§£è€¦å’Œæ‹†åˆ†ã€‚</li>
<li><strong>è§„åˆ™é©±åŠ¨çš„è½¬æ¢</strong>ï¼šåˆ©ç”¨ <code>StateTransition</code> å®šä¹‰äº†æ¸…æ™°çš„çŠ¶æ€åˆ‡æ¢è§„åˆ™ï¼Œå®ç°äº†çŠ¶æ€çš„è‡ªåŠ¨ã€æ™ºèƒ½åˆ‡æ¢ï¼Œå½»åº•å‘Šåˆ«äº†å¤æ‚çš„ <code>if-else</code> åµŒå¥—ã€‚</li>
<li><strong>ä»£ç é‡æ„</strong>ï¼šé€šè¿‡ç§»é™¤æ—§çš„é€»è¾‘å’Œå˜é‡ï¼Œè®© <code>player.gd</code> å˜å¾—æ›´åŠ è½»é‡ï¼Œåªè´Ÿè´£ç»´æŠ¤é€šç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œè€Œå°†å…·ä½“çš„çŠ¶æ€è¡Œä¸ºå…¨æƒå§”æ‰˜ç»™çŠ¶æ€æœºã€‚</li>
</ol>
<p>é€šè¿‡è¿™æ¬¡å®è·µï¼Œæˆ‘ä»¬ä¸ä»…è®©ä»£ç å˜å¾—æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ï¼Œä¹Ÿä¸ºæœªæ¥æ·»åŠ æ›´å¤šå¤æ‚åŠŸèƒ½ï¼ˆå¦‚å—ä¼¤ã€æ­»äº¡ã€ç¿»æ»šç­‰ï¼‰æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ã€‚</p>
<h4 data-id="heading-13">ä¸‹ä¸€æ­¥</h4>
<p>è§’è‰²æ§åˆ¶å·²ç»æ­¥å…¥æ­£è½¨ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠç›®å…‰æŠ•å‘æ¸¸æˆä¸–ç•Œçš„æ„å»ºã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€åŒå­¦ä¹  Godot å¼ºå¤§çš„ <code>TileMap</code>ï¼ˆç“¦ç‰‡åœ°å›¾ï¼‰ç³»ç»Ÿï¼Œç”¨å®ƒæ¥æ­å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¸¸æˆåœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java: ä¸ºPDFæ‰¹é‡æ·»åŠ å›¾ç‰‡æ°´å°å®ç”¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7571672422690193460</link>    <guid>https://juejin.cn/post/7571672422690193460</guid>    <pubDate>2025-11-13T02:02:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571672422690193460" data-draft-id="7571672422690144308" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java: ä¸ºPDFæ‰¹é‡æ·»åŠ å›¾ç‰‡æ°´å°å®ç”¨æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,Java,API"/> <meta itemprop="datePublished" content="2025-11-13T02:02:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¼ºç‚¹å†…å‘"/> <meta itemprop="url" content="https://juejin.cn/user/3414438228006112"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java: ä¸ºPDFæ‰¹é‡æ·»åŠ å›¾ç‰‡æ°´å°å®ç”¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3414438228006112/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¼ºç‚¹å†…å‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:02:31.000Z" title="Thu Nov 13 2025 02:02:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Java: ä¸ºPDFæ‰¹é‡æ·»åŠ å›¾ç‰‡æ°´å°å®ç”¨æŒ‡å—</h2>
<p>åœ¨æ•°å­—åŒ–åŠå…¬æ—¥ç›Šæ™®åŠçš„ä»Šå¤©ï¼ŒPDFæ–‡æ¡£ä½œä¸ºä¿¡æ¯ä¼ è¾“å’Œå…±äº«çš„é‡è¦è½½ä½“ï¼Œå…¶å®‰å…¨æ€§å’Œç‰ˆæƒä¿æŠ¤å˜å¾—å°¤ä¸ºå…³é”®ã€‚ä½ æ˜¯å¦æ›¾ä¸ºæ‰‹åŠ¨ç»™å¤§é‡PDFæ–‡ä»¶æ·»åŠ æ°´å°è€Œæ„Ÿåˆ°å¤´ç–¼ï¼Ÿæˆ–è€…ï¼Œå½“ä½ çš„é‡è¦æ–‡æ¡£åœ¨æœªç»æˆæƒçš„æƒ…å†µä¸‹è¢«ä¼ æ’­ï¼Œå´è‹¦äºæ²¡æœ‰æœ‰æ•ˆçš„æ ‡è¯†æ–¹æ³•ï¼Ÿ</p>
<p>ä¼ ç»Ÿçš„æ–‡å­—æ°´å°è™½ç„¶èƒ½èµ·åˆ°ä¸€å®šä½œç”¨ï¼Œä½†åœ¨å“ç‰Œè¯†åˆ«åº¦ã€é˜²ç¯¡æ”¹æ€§å’Œè§†è§‰æ•ˆæœæ–¹é¢å¾€å¾€ä¸å¦‚å›¾ç‰‡æ°´å°ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå°†ä½ çš„å…¬å¸Logoã€ç‰ˆæƒå£°æ˜ç”šè‡³æ˜¯â€œç»å¯†â€å­—æ ·çš„å›¾ç‰‡æ°´å°åµŒå…¥åˆ°PDFä¸­ï¼Œæ—¢èƒ½æœ‰æ•ˆå®£ç¤ºä¸»æƒï¼Œåˆèƒ½æå‡æ–‡æ¡£çš„ä¸“ä¸šæ€§ã€‚ç„¶è€Œï¼Œå¦‚ä½•é«˜æ•ˆã€è‡ªåŠ¨åŒ–åœ°åœ¨Javaé¡¹ç›®ä¸­å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œæˆä¸ºäº†è®¸å¤šå¼€å‘è€…é¢ä¸´çš„ç—›ç‚¹ã€‚</p>
<p>åˆ«æ‹…å¿ƒï¼æœ¬æ–‡å°†ä¸ºä½ æ­ç¤ºä¸€ä¸ªå¼ºå¤§è€Œä¾¿æ·çš„è§£å†³æ–¹æ¡ˆâ€”â€”Spire.PDF for Javaã€‚é€šè¿‡å®ƒï¼Œä½ å°†èƒ½å¤Ÿè½»æ¾åœ°åœ¨Javaåº”ç”¨ç¨‹åºä¸­ä¸ºPDFæ–‡æ¡£æ·»åŠ å›¾ç‰‡æ°´å°ï¼Œå‘Šåˆ«ç¹ççš„æ‰‹åŠ¨æ“ä½œï¼Œå®ç°æ–‡æ¡£å¤„ç†çš„è‡ªåŠ¨åŒ–ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©å›¾ç‰‡æ°´å°ï¼Ÿ</h3>
<p>åœ¨ä¼—å¤šçš„æ–‡æ¡£ä¿æŠ¤å’Œæ ‡è¯†ç­–ç•¥ä¸­ï¼Œå›¾ç‰‡æ°´å°ä»¥å…¶ç‹¬ç‰¹çš„ä¼˜åŠ¿è„±é¢–è€Œå‡ºï¼š</p>
<ul>
<li>é˜²ç¯¡æ”¹æ€§æ›´å¼ºï¼šå›¾ç‰‡æ°´å°ä½œä¸ºæ–‡æ¡£å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œç›¸æ¯”æ–‡æœ¬æ°´å°ï¼Œå…¶ä¿®æ”¹å’Œå»é™¤éš¾åº¦æ›´å¤§ï¼Œæœ‰æ•ˆæé«˜äº†æ–‡æ¡£çš„å®‰å…¨æ€§ã€‚</li>
<li>å“ç‰Œè¯†åˆ«åº¦é«˜ï¼šä¼ä¸šLogoã€å“ç‰Œæ ‡è¯†ç­‰å›¾ç‰‡æ°´å°èƒ½å¤Ÿç›´è§‚åœ°ä¼ è¾¾å“ç‰Œä¿¡æ¯ï¼Œå¢å¼ºæ–‡æ¡£çš„ä¸“ä¸šæ€§å’Œæƒå¨æ€§ï¼Œæœ‰åŠ©äºå“ç‰Œå½¢è±¡çš„å»ºè®¾ã€‚</li>
<li>è§†è§‰æ•ˆæœæ›´ä½³ï¼šç²¾å¿ƒè®¾è®¡çš„å›¾ç‰‡æ°´å°èƒ½å¤Ÿä¸æ–‡æ¡£å†…å®¹å’Œè°å…±å­˜ï¼Œæ—¢ä¸å½±å“é˜…è¯»ï¼Œåˆèƒ½èµ·åˆ°æ ‡è¯†ä½œç”¨ï¼Œæå‡æ–‡æ¡£æ•´ä½“çš„è§†è§‰ä½“éªŒã€‚</li>
<li>åº”ç”¨åœºæ™¯å¹¿æ³›ï¼š
<ul>
<li>ç‰ˆæƒå£°æ˜ï¼šå°†ç‰ˆæƒç¬¦å·ã€å…¬å¸åç§°ä½œä¸ºå›¾ç‰‡æ°´å°ï¼Œæ˜ç¡®æ–‡æ¡£æ‰€æœ‰æƒã€‚</li>
<li>å…¬å¸Logoï¼šåœ¨å¯¹å¤–å‘å¸ƒçš„æ–‡æ¡£ä¸­åµŒå…¥å…¬å¸Logoï¼Œæå‡ä¼ä¸šå½¢è±¡ã€‚</li>
<li>ä¿å¯†æ ‡è¯†ï¼šå¯¹äºå†…éƒ¨æ•æ„Ÿæ–‡æ¡£ï¼Œæ·»åŠ â€œç»å¯†â€ã€â€œå†…éƒ¨èµ„æ–™â€ç­‰å›¾ç‰‡æ°´å°è¿›è¡Œè­¦ç¤ºã€‚</li>
<li>è‰ç¨¿/æ ·å“æ ‡è¯†ï¼šåœ¨æœªå®šç¨¿æˆ–æ ·å“æ–‡æ¡£ä¸­æ·»åŠ â€œDraftâ€ã€â€œSampleâ€ç­‰å­—æ ·ï¼Œé¿å…è¯¯ç”¨ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-2">Spire.PDF for Javaï¼šå›¾ç‰‡æ°´å°çš„åˆ©å™¨</h3>
<p>åœ¨Javaç”Ÿæ€ä¸­ï¼Œå¤„ç†PDFçš„åº“æœ‰å¾ˆå¤šï¼Œä½†Spire.PDF for Javaå‡­å€Ÿå…¶å¼ºå¤§çš„åŠŸèƒ½ã€æ˜“äºé›†æˆçš„ç‰¹æ€§ä»¥åŠå¯¹å„ç§PDFæ“ä½œçš„å…¨é¢æ”¯æŒï¼Œæˆä¸ºäº†å¼€å‘è€…ä»¬çš„ä¼˜é€‰ä¹‹ä¸€ã€‚å°¤å…¶åœ¨æ°´å°å¤„ç†æ–¹é¢ï¼Œå®ƒæä¾›äº†çµæ´»çš„APIï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬è½»æ¾å®ç°å›¾ç‰‡æ°´å°çš„æ·»åŠ ã€å®šä½ã€é€æ˜åº¦è®¾ç½®ç­‰å¤æ‚æ“ä½œã€‚</p>
<p>åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†Spire.PDF for Javaåº“é›†æˆåˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Mavenæˆ–Gradleï¼Œåªéœ€åœ¨<code>pom.xml</code>æˆ–<code>build.gradle</code>æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”çš„ä¾èµ–å³å¯ã€‚</p>
<p><strong>Mavenä¾èµ–é…ç½®:</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>com.e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.e-iceblue.cn/repository/maven-public/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>e-iceblue<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spire.pdf.free<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- è¯·ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<p><strong>Gradleä¾èµ–é…ç½®:</strong></p>
<pre><code class="hljs language-gradle" lang="gradle">repositories {
    maven { url "https://repo.e-iceblue.cn/repository/maven-public/" }
}
dependencies {
    implementation 'e-iceblue:spire.pdf.free:5.1.0' // è¯·ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
}
</code></pre>
<blockquote>
<p><strong>æç¤º</strong>ï¼šä¸ºäº†ç¡®ä¿ä»£ç çš„å…¼å®¹æ€§å’Œè·å–æœ€æ–°çš„åŠŸèƒ½ï¼Œå»ºè®®å§‹ç»ˆä½¿ç”¨Spire.PDF for Javaçš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">Javaä»£ç å®æˆ˜ï¼šä¸ºPDFæ·»åŠ å›¾ç‰‡æ°´å°</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„Javaä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Spire.PDF for Javaä¸ºPDFæ–‡æ¡£æ·»åŠ å›¾ç‰‡æ°´å°ï¼Œå¹¶è¯¦ç»†è§£é‡Šäº†æ¯ä¸€æ­¥çš„ä½œç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.spire.pdf.*;
<span class="hljs-keyword">import</span> com.spire.pdf.graphics.*;
<span class="hljs-keyword">import</span> java.awt.geom.Rectangle2D;
<span class="hljs-keyword">import</span> java.awt.image.BufferedImage;
<span class="hljs-keyword">import</span> javax.imageio.ImageIO;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AddImageWatermarkToPDF</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. åŠ è½½PDFæ–‡æ¡£</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">inputPdfPath</span> <span class="hljs-operator">=</span> <span class="hljs-string">"input.pdf"</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„è¾“å…¥PDFæ–‡ä»¶è·¯å¾„</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">watermarkImagePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">"watermark.png"</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„æ°´å°å›¾ç‰‡æ–‡ä»¶è·¯å¾„</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">outputPdfPath</span> <span class="hljs-operator">=</span> <span class="hljs-string">"output_with_watermark.pdf"</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„è¾“å‡ºPDFæ–‡ä»¶è·¯å¾„</span>

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">PdfDocument</span> <span class="hljs-variable">pdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PdfDocument</span>();
            pdf.loadFromFile(inputPdfPath);

            <span class="hljs-comment">// 2. åŠ è½½å›¾ç‰‡æ°´å°</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">image</span> <span class="hljs-operator">=</span> ImageIO.read(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(watermarkImagePath));
            <span class="hljs-keyword">if</span> (image == <span class="hljs-literal">null</span>) {
                System.err.println(<span class="hljs-string">"é”™è¯¯ï¼šæ— æ³•åŠ è½½æ°´å°å›¾ç‰‡ï¼Œè¯·æ£€æŸ¥è·¯å¾„å’Œæ–‡ä»¶æ ¼å¼ã€‚"</span>);
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// éå†PDFä¸­çš„æ¯ä¸€é¡µ</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; pdf.getPages().getCount(); i++) {
                <span class="hljs-type">PdfPageBase</span> <span class="hljs-variable">page</span> <span class="hljs-operator">=</span> pdf.getPages().get(i);

                <span class="hljs-comment">// è·å–é¡µé¢å°ºå¯¸</span>
                <span class="hljs-type">float</span> <span class="hljs-variable">pageWidth</span> <span class="hljs-operator">=</span> page.getActualSize().getWidth();
                <span class="hljs-type">float</span> <span class="hljs-variable">pageHeight</span> <span class="hljs-operator">=</span> page.getActualSize().getHeight();

                <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªPdfImageå¯¹è±¡</span>
                <span class="hljs-type">PdfImage</span> <span class="hljs-variable">pdfImage</span> <span class="hljs-operator">=</span> PdfImage.fromImage(image);

                <span class="hljs-comment">// 3. å®šä¹‰æ°´å°çš„ä½ç½®å’Œå¤§å°</span>
                <span class="hljs-comment">// è¿™é‡Œæˆ‘ä»¬ä»¥é¡µé¢ä¸­å¿ƒä¸ºä¾‹ï¼Œå¹¶è®¾ç½®æ°´å°å®½åº¦ä¸ºé¡µé¢å®½åº¦çš„1/2ï¼Œé«˜åº¦æŒ‰æ¯”ä¾‹ç¼©æ”¾</span>
                <span class="hljs-type">float</span> <span class="hljs-variable">watermarkWidth</span> <span class="hljs-operator">=</span> pageWidth * <span class="hljs-number">0.5f</span>;
                <span class="hljs-type">float</span> <span class="hljs-variable">watermarkHeight</span> <span class="hljs-operator">=</span> watermarkWidth * pdfImage.getHeight() / pdfImage.getWidth();

                <span class="hljs-comment">// è®¡ç®—æ°´å°çš„Xã€Yåæ ‡ï¼Œä½¿å…¶å±…ä¸­</span>
                <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (pageWidth - watermarkWidth) / <span class="hljs-number">2</span>;
                <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> (pageHeight - watermarkHeight) / <span class="hljs-number">2</span>;

                <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªçŸ©å½¢ï¼Œå®šä¹‰æ°´å°çš„æ”¾ç½®åŒºåŸŸ</span>
                Rectangle2D.<span class="hljs-type">Float</span> <span class="hljs-variable">watermarkRect</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle2D</span>.Float(x, y, watermarkWidth, watermarkHeight);

                <span class="hljs-comment">// 4. è®¾ç½®æ°´å°çš„é€æ˜åº¦</span>
                <span class="hljs-comment">// PdfTransparency ç±»ç”¨äºè®¾ç½®é€æ˜åº¦ï¼Œå€¼èŒƒå›´ä¸º0.0ï¼ˆå®Œå…¨é€æ˜ï¼‰åˆ°1.0ï¼ˆå®Œå…¨ä¸é€æ˜ï¼‰</span>
                <span class="hljs-type">PdfTransparency</span> <span class="hljs-variable">transparency</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PdfTransparency</span>(<span class="hljs-number">0.3f</span>); <span class="hljs-comment">// è®¾ç½®ä¸º30%ä¸é€æ˜åº¦</span>

                <span class="hljs-comment">// 5. å°†å›¾ç‰‡æ°´å°ç»˜åˆ¶åˆ°é¡µé¢ä¸Š</span>
                <span class="hljs-comment">// ä½¿ç”¨ PdfPageBase çš„ drawImage æ–¹æ³•</span>
                page.getCanvas().drawImage(pdfImage, watermarkRect, transparency);

                <span class="hljs-comment">// å¦‚æœéœ€è¦å°†æ°´å°æ”¾ç½®åœ¨æ–‡æœ¬ä¸‹æ–¹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ PdfWatermarkAnnotation</span>
                <span class="hljs-comment">// ä½†å¯¹äºç®€å•çš„å›¾ç‰‡æ°´å°ï¼Œç›´æ¥ç»˜åˆ¶åˆ°Canvasä¸Šé€šå¸¸è¶³å¤Ÿ</span>
            }

            <span class="hljs-comment">// 6. ä¿å­˜ä¿®æ”¹åçš„PDFæ–‡æ¡£</span>
            pdf.saveToFile(outputPdfPath, FileFormat.PDF);
            pdf.close();

            System.out.println(<span class="hljs-string">"å›¾ç‰‡æ°´å°å·²æˆåŠŸæ·»åŠ åˆ°PDFæ–‡æ¡£ï¼š"</span> + outputPdfPath);

        } <span class="hljs-keyword">catch</span> (IOException e) {
            System.err.println(<span class="hljs-string">"æ–‡ä»¶æ“ä½œå¼‚å¸¸ï¼š"</span> + e.getMessage());
            e.printStackTrace();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"å¤„ç†PDFæ—¶å‘ç”Ÿé”™è¯¯ï¼š"</span> + e.getMessage());
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>ä»£ç è§£æ:</strong></p>
<ul>
<li><code>pdf.loadFromFile(inputPdfPath)</code>: åŠ è½½éœ€è¦æ·»åŠ æ°´å°çš„PDFæ–‡ä»¶ã€‚</li>
<li><code>ImageIO.read(new File(watermarkImagePath))</code>: è¯»å–æœ¬åœ°çš„æ°´å°å›¾ç‰‡æ–‡ä»¶ï¼ˆæ”¯æŒPNG, JPGç­‰å¸¸è§æ ¼å¼ï¼‰ã€‚</li>
<li><code>pdf.getPages().get(i)</code>: è·å–PDFæ–‡æ¡£çš„æ¯ä¸€é¡µè¿›è¡Œå¤„ç†ï¼Œç¡®ä¿æ°´å°åº”ç”¨åˆ°æ‰€æœ‰é¡µé¢ã€‚</li>
<li><code>PdfImage.fromImage(image)</code>: å°†<code>BufferedImage</code>å¯¹è±¡è½¬æ¢ä¸ºSpire.PDFå¯è¯†åˆ«çš„<code>PdfImage</code>å¯¹è±¡ã€‚</li>
<li><code>Rectangle2D.Float(x, y, watermarkWidth, watermarkHeight)</code>: å®šä¹‰æ°´å°åœ¨é¡µé¢ä¸Šçš„ä½ç½®å’Œå¤§å°ã€‚ä½ å¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´<code>x</code>, <code>y</code>åæ ‡ä»¥åŠ<code>watermarkWidth</code>, <code>watermarkHeight</code>æ¥æ§åˆ¶æ°´å°çš„å¸ƒå±€ã€‚</li>
<li><code>PdfTransparency(0.3f)</code>: è®¾ç½®æ°´å°çš„é€æ˜åº¦ã€‚<code>0.3f</code>è¡¨ç¤º30%çš„ä¸é€æ˜åº¦ï¼Œå¯ä»¥æ ¹æ®å®é™…æ•ˆæœè°ƒæ•´è¿™ä¸ªå€¼ã€‚</li>
<li><code>page.getCanvas().drawImage(pdfImage, watermarkRect, transparency)</code>: è¿™æ˜¯æ ¸å¿ƒæ­¥éª¤ï¼Œå°†<code>PdfImage</code>ä»¥æŒ‡å®šçš„é€æ˜åº¦å’Œä½ç½®ç»˜åˆ¶åˆ°å½“å‰é¡µé¢çš„ç”»å¸ƒä¸Šã€‚</li>
<li><code>pdf.saveToFile(outputPdfPath, FileFormat.PDF)</code>: å°†ä¿®æ”¹åçš„PDFæ–‡æ¡£ä¿å­˜åˆ°æ–°çš„æ–‡ä»¶ä¸­ã€‚</li>
<li><code>pdf.close()</code>: é‡Šæ”¾èµ„æºï¼Œè¿™æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">ç»“è¯­</h3>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»å’Œå®æˆ˜ä»£ç ï¼Œç›¸ä¿¡ä½ å·²ç»æŒæ¡äº†å¦‚ä½•åœ¨Javaä¸­åˆ©ç”¨Spire.PDF for Javaåº“ä¸ºPDFæ–‡æ¡£æ·»åŠ å›¾ç‰‡æ°´å°çš„æ–¹æ³•ã€‚æ— è®ºæ˜¯ä¸ºäº†ä¿æŠ¤æ–‡æ¡£ç‰ˆæƒï¼Œæå‡å“ç‰Œå½¢è±¡ï¼Œè¿˜æ˜¯å®ç°å†…éƒ¨æ–‡æ¡£çš„æ ‡è¯†ç®¡ç†ï¼Œå›¾ç‰‡æ°´å°éƒ½æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”çµæ´»çš„å·¥å…·ã€‚</p>
<p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™å°†è¿™äº›çŸ¥è¯†åº”ç”¨åˆ°ä½ çš„é¡¹ç›®ä¸­äº†ï¼å°è¯•è¿è¡Œä¸Šè¿°ä»£ç ï¼Œæ„Ÿå—è‡ªåŠ¨åŒ–å¤„ç†PDFçš„ä¾¿æ·ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºä½ æ‰“å¼€ä¸€æ‰‡æ–°çš„å¤§é—¨ï¼Œæ¢ç´¢æ›´å¤šPDFå¤„ç†çš„æ½œåŠ›ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»0åˆ°1å®ç°ï¼šAIç‰ˆä½ ç”»æˆ‘çŒœå°æ¸¸æˆ]]></title>    <link>https://juejin.cn/post/7569150490798899206</link>    <guid>https://juejin.cn/post/7569150490798899206</guid>    <pubDate>2025-11-06T02:27:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569150490798899206" data-draft-id="7569055467803033642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»0åˆ°1å®ç°ï¼šAIç‰ˆä½ ç”»æˆ‘çŒœå°æ¸¸æˆ"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,TensorFlow"/> <meta itemprop="datePublished" content="2025-11-06T02:27:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vivoäº’è”ç½‘æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/993614243303053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»0åˆ°1å®ç°ï¼šAIç‰ˆä½ ç”»æˆ‘çŒœå°æ¸¸æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614243303053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vivoäº’è”ç½‘æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-06T02:27:42.000Z" title="Thu Nov 06 2025 02:27:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼š vivo äº’è”ç½‘å‰ç«¯å›¢é˜Ÿ- Wei Xing</p>
<p>å…¨æ°‘AIæ—¶ä»£ï¼Œå‰ç«¯erè¯¥å¦‚ä½•è¹­ä¸Šè¿™æ³¢çƒ­åº¦ï¼Ÿæœ¬æ–‡å°†ä¸€æ­¥æ­¥å¸¦å¤§å®¶äº†è§£å‰ç«¯åº”è¯¥å¦‚ä½•ç»“åˆç«¯ä¾§AIæ¨¡å‹ï¼Œå®ç°ä¸€ä¸ªAIç‰ˆä½ ç”»æˆ‘çŒœå°æ¸¸æˆã€‚</p>
</blockquote>
<p>1åˆ†é’Ÿçœ‹å›¾æŒæ¡æ ¸å¿ƒè§‚ç‚¹ğŸ‘‡</p>
<p><img src="https://static001.geekbang.org/infoq/38/38dbb50453bfb2fb8e723763598eda8f.gif" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ¬æ–‡æä¾›é…å¥—æ¼”ç¤ºä»£ç ï¼Œå¯ä¸‹è½½ä½“éªŒï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw" ref="nofollow noopener noreferrer">Github | vivo-</a><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw" ref="nofollow noopener noreferrer">ai-quickdraw</a></p>
<h2 data-id="heading-0">ä¸€ã€å¼•è¨€</h2>
<p>è¿‘å‡ å¹´AIçš„è¿›åŒ–é€Ÿåº¦å ªæ¯”ç§‘å¹»ç‰‡â€”â€”æ˜¨å¤©è¿˜åœ¨è°ƒæ•™ChatGPTå†™è¯—ï¼Œä»Šå¤©Soraå·²ç»èƒ½ç”Ÿæˆç”µå½±çº§ç”»é¢äº†ã€‚æŠ€æœ¯åœˆä»¿ä½›è¢«AIâ€œè…Œå…¥å‘³â€äº†ï¼Œè¯´ä¸å®šè¿è¿™ç¯‡æ–‡ç« éƒ½æ˜¯DeepSeekå¸®å¿™å†™çš„ï¼ˆç‹—å¤´ï¼‰ã€‚</p>
<p>**å‰ç«¯erçš„é‡æœ›ï¼š**å½“å…¶ä»–è¡Œä¸šå¿™ç€ç”¨AIé€ ç«ç®­æ—¶ï¼Œæˆ‘ä»¬è¿™ç¾¤å’Œæµè§ˆå™¨â€œæ–—æ™ºæ–—å‹‡â€çš„æ‰‹è‰ºäººï¼Œè¯¥æ€ä¹ˆè¹­ä¸Šè¿™æ³¢çƒ­åº¦ï¼Ÿ</p>
<p>åœ¨æ·±å…¥æ€è€ƒå¦‚ä½•è¹­ä¸Šçƒ­åº¦ä¹‹å‰ï¼Œ<strong>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆç®€å•äº†è§£ä¸‹AIæ¨¡å‹çš„åˆ†ç±»ã€‚</strong></p>
<h3 data-id="heading-1">1.1 äº‘ç«¯æ¨¡å‹å’Œç«¯ä¾§æ¨¡å‹</h3>
<p>ä»æ¨¡å‹çš„éƒ¨ç½²æ–¹å¼ä¸Šæ¥çœ‹ï¼ŒAIæ¨¡å‹å¯ä»¥ç®€å•åˆ†ä¸ºäº‘ç«¯æ¨¡å‹ï¼ˆCloud Modelï¼‰å’Œç«¯ä¾§æ¨¡å‹ï¼ˆOn-Device Modelï¼‰ä¸¤ç§ã€‚</p>
<ul>
<li>
<p>**äº‘ç«¯æ¨¡å‹ï¼š**å°†æ¨¡å‹éƒ¨ç½²åœ¨æœåŠ¡é›†ç¾¤ä¸Šï¼Œæä¾›ä¸€äº›APIèƒ½åŠ›ä¾›ç«¯ä¾§æ¥è°ƒç”¨ï¼Œç«¯ä¾§æ— éœ€å¤„ç†è®¡ç®—éƒ¨åˆ†ï¼Œåªéœ€è°ƒç”¨APIè·å–è®¡ç®—ç»“æœå³å¯ã€‚æ¯”å¦‚OpenAIçš„å®˜æ–¹APIå°±æ˜¯å¦‚æ­¤ã€‚</p>
</li>
<li>
<p>**ç«¯ä¾§æ¨¡å‹ï¼š**ç›´æ¥å°†æ¨¡å‹éƒ¨ç½²åœ¨ç»ˆç«¯è®¾å¤‡ä¸Šï¼Œæ¨¡å‹çš„è®¡ç®—ã€æ¨ç†å®Œå…¨ä¾èµ–ç»ˆç«¯è®¾å¤‡ï¼Œå…·æœ‰æ›´é«˜çš„å®æ—¶æ€§ã€ç§å¯†æ€§ã€å®‰å…¨æ€§ï¼Œä½†åŒæ—¶å¯¹ç»ˆç«¯è®¾å¤‡ç­‰ç¡¬ä»¶è¦æ±‚ä¹Ÿè¾ƒé«˜ã€‚</p>
</li>
</ul>
<p>å¯¹äºå‰ç«¯æ¥è¯´ï¼Œç”±äºå…¶éå¸¸ä¾èµ–æµè§ˆå™¨å’Œç»ˆç«¯è®¾å¤‡æ€§èƒ½ï¼Œæ‰€ä»¥åŸæœ¬æœ€é€‚åˆå‰ç«¯çš„æ–¹å¼å…¶å®æ˜¯ç›´æ¥è°ƒç”¨äº‘ç«¯æ¨¡å‹APIï¼ŒæŠŠè®¡ç®—çš„è´Ÿæ‹…è½¬å«ç»™æœåŠ¡é›†ç¾¤ï¼Œé¡µé¢åªéœ€è´Ÿè´£å±•ç¤ºç»“æœå³å¯ã€‚ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œæ­å»ºé›†ç¾¤ã€è®­ç»ƒæ¨¡å‹ã€å®šåˆ¶APIæœ‰å¾ˆé«˜çš„èµ„æºé—¨æ§›å’Œæˆæœ¬ï¼Œç°å®æ¡ä»¶å¾€å¾€ä¸å…è®¸æˆ‘ä»¬è¿™æ ·åšã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è½¬è€Œè€ƒè™‘<strong>åˆ©ç”¨ç«¯ä¾§æ¨¡å‹æ¥èµ‹èƒ½ã€‚</strong></p>
<h3 data-id="heading-2">1.2 å¤§è¯­è¨€æ¨¡å‹å’Œç‰¹å®šé¢†åŸŸæ¨¡å‹</h3>
<p>ç«¯ä¾§æ¨¡å‹ä»æ¦‚å¿µä¸Šæ¥åŒºåˆ†ï¼Œåˆå¯ä»¥ç®€å•åˆ†ä¸ºå¤§è¯­è¨€æ¨¡å‹å’Œç‰¹å®šé¢†åŸŸæ¨¡å‹ã€‚</p>
<p><strong>å¤§è¯­è¨€æ¨¡å‹</strong></p>
<p>å…¶ä¸­å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Modelï¼ŒLLMï¼‰å°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„ChatGPTã€DeepSeekã€Grokè¿™ç±»æ¨¡å‹ï¼Œå®ƒä»¬åŠŸèƒ½å¼ºå¤§ï¼Œä½†å¯¹è®¾å¤‡çš„æ€§èƒ½è¦æ±‚å¾ˆé«˜ï¼Œä»¥DeepSeekä¸ºä¾‹ï¼Œå³ä½¿æ˜¯æœ€å°çš„1.5Bç‰ˆæœ¬æ¨¡å‹ï¼Œä¹Ÿè‡³å°‘éœ€è¦RTX 3060+çº§åˆ«çš„æ˜¾å¡æ‰èƒ½å¸¦å¾—åŠ¨ï¼Œå¹¶ä¸”æ¨¡å‹æœ¬èº«çš„å¤§å°å·²ç»è¾¾åˆ°1.1GBï¼Œå¹¶ä¸é€‚åˆéƒ¨ç½²åœ¨å‰ç«¯é¡¹ç›®ä¸­ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/d5/d5a1f9cadeb203b661c8f1f7528a8598.png" alt="" loading="lazy"/></p>
<p><strong>ç‰¹å®šé¢†åŸŸæ¨¡å‹</strong></p>
<p>æ‰€ä»¥ï¼Œæœ€ç»ˆç•™ç»™æˆ‘ä»¬çš„é€‰é¡¹å°±æ˜¯åˆ©ç”¨ä¸€äº›ç‰¹å®šé¢†åŸŸæ¨¡å‹æ¥èµ‹èƒ½å‰ç«¯ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥å¤„ç†æŸäº›ç‰¹å®šé¢†åŸŸçš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œ<strong>åˆ©ç”¨è§†è§‰ï¼ˆCNNã€MobileNetï¼‰æ¨¡å‹å®ç°å›¾åƒåˆ†ç±»ã€äººè„¸æ£€æµ‹ï¼Œæˆ–è€…åˆ©ç”¨è‡ªç„¶è¯­è¨€æ¨¡å‹ï¼ˆNLPï¼‰å®ç°é—®ç­”æœºå™¨äººã€æ–‡æœ¬æ¶æ„æ£€æµ‹ç­‰ã€‚</strong></p>
<p>è¿™äº›æ¨¡å‹ç­‰ç‰¹å¾æ˜¯å°ºå¯¸è¾ƒå°ï¼Œå¹¶ä¸”å¯¹è®¾å¤‡æ€§èƒ½è¦æ±‚ä¸é«˜ï¼Œéå¸¸é€‚åˆç›´æ¥éƒ¨ç½²åœ¨å‰ç«¯å¹¶å®ç°ä¸€äº›AIäº¤äº’ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œ<strong>å¦‚ä½•ä»0åˆ°1è®­ç»ƒä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹ï¼ˆDoodle Classifier based on CNNï¼‰</strong>ï¼Œå¹¶å°†æ¨¡å‹é›†æˆè‡³å‰ç«¯é¡µé¢ï¼Œå®ç°ä¸€ä¸ªç»å…¸<strong>ä½ ç”»æˆ‘çŒœå°æ¸¸æˆ-ç«¯ä¾§AIç‰ˆã€‚</strong></p>
<h2 data-id="heading-3">äºŒã€ä½ ç”»æˆ‘çŒœAIç‰ˆ-ç©æ³•ç®€ä»‹</h2>
<p>åŠ¨æ‰‹å®è·µä¹‹å‰ï¼Œå…ˆæ¥ç®€å•ä»‹ç»ä¸‹ä½ ç”»æˆ‘çŒœAIç‰ˆçš„ç©æ³•ï¼Œå®ƒå’Œæ™®é€šç‰ˆæœ¬ä½ ç”»æˆ‘çŒœçš„åŒºåˆ«åœ¨äºï¼šç©å®¶æ ¹æ®æç¤ºè¯è¿›è¡Œæ¶‚é¸¦ï¼Œ<strong>ç”±AIæ¥é¢„æµ‹ç©å®¶ç”»çš„è¯æ˜¯ä»€ä¹ˆï¼Œå¦‚æœAIé¡ºåˆ©çŒœå¯¹ç©å®¶ç”»çš„è¯ï¼Œåˆ™ç©å®¶å¾—åˆ†ã€‚</strong></p>
<p><img src="https://static001.geekbang.org/infoq/e0/e030938e11971e605ab4b3677de93b74.gif" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¾‹å¦‚ï¼Œæç¤ºè¯æ˜¯â€œé•¿åŸâ€ï¼Œåˆ™ç©å®¶éœ€è¦é€šè¿‡ç”»æ¿æ‰‹ç»˜ä¸€ä¸ªé•¿åŸï¼Œå°½é‡ç”»çš„åƒä¸€äº›ï¼Œè®©AIçŒœå‡ºæ­£ç¡®ç­”æ¡ˆå°±èƒ½å¾—åˆ†ã€‚</p>
<p>äº†è§£äº†åŸºç¡€ç©æ³•ä¹‹åï¼Œæ¥ä¸‹æ¥æ­£ç‰‡å¼€å§‹ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶åˆ°ä¸€å¼€å§‹å®ç°å®ƒã€‚</p>
<p>æˆ‘ä»¬æä¾›äº†ç®€åŒ–ç‰ˆçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fh5.vivo.com.cn%2Fcasual%2Fquickdraw%2Findex.html%23%2Fdoodle" target="_blank" title="https://h5.vivo.com.cn/casual/quickdraw/index.html#/doodle" ref="nofollow noopener noreferrer">live demo</a>ï¼Œä½ å¯ä»¥è®¿é—®é“¾æ¥è¯•è¯•çœ‹ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿæä¾›äº†ç›¸å…³çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw" ref="nofollow noopener noreferrer">demoä»£ç </a>ï¼Œä½ å¯ä»¥éšæ—¶è®¿é—®githubä»“åº“ï¼Œä¸‹è½½å’Œå°è¯•è¿è¡Œå®ƒã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€è®­ç»ƒæ¨¡å‹</h2>
<p>é¦–å…ˆï¼Œç¬¬ä¸€æ­¥æ˜¯è®­ç»ƒæ¨¡å‹ã€‚</p>
<p>æ ¹æ®ä¸Šé¢çš„ç©æ³•ç®€ä»‹ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>åŸºäºè§†è§‰çš„å›¾ç‰‡åˆ†ç±»AIæ¨¡å‹</strong>ï¼Œè€Œè¿™ä¸ªæ¨¡å‹çš„åŠŸèƒ½æ˜¯ï¼šè¾“å…¥å›¾ç‰‡æ•°æ®åï¼Œæ¨¡å‹å¯ä»¥è®¡ç®—å‡ºå›¾ç‰‡çš„åˆ†ç±»ç½®ä¿¡ç»“æœã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ä¸€å¼ å°çŒ«çš„å›¾ç‰‡ï¼Œæ¨¡å‹çš„åˆ†ç±»è®¡ç®—ç»“æœå¯èƒ½ä¸ºï¼š[çŒ« 90%ï¼Œç‹—8%ï¼ŒçŒª2%]ï¼Œè¡¨ç¤ºæ¨¡å‹è®¤ä¸ºè¿™å¼ å›¾æœ‰90%çš„æ¦‚ç‡æ˜¯åªçŒ«ï¼Œ8%çš„æ¦‚ç‡æ˜¯æ¡ç‹—ï¼Œ2%æ¦‚ç‡æ˜¯åªçŒªã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬é€šè¿‡å°†ç”¨æˆ·æ‰‹ç»˜çš„canvasä¸­çš„å›¾ç‰‡æ•°æ®ä¸¢ç»™æ¨¡å‹ï¼Œå¹¶æŠŠæ¨¡å‹è¾“å‡ºçš„ç½®ä¿¡æ¦‚ç‡æœ€å¤§çš„åˆ†ç±»å½“ä½œAIçš„çŒœæµ‹ç»“æœï¼Œå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºAIçŒœè¯çš„äº’åŠ¨äº†ã€‚</p>
<p>è€Œå®ç°è¿™ä¸ªæ¨¡å‹ä¹Ÿå¾ˆç®€å•ï¼Œä½†æˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œçš„çŸ¥è¯†ä»¥åŠtensorflow.jsçš„åŸºç¡€ç”¨æ³•ã€‚å¦‚æœå¯¹è¿™ä¸¤è€…ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯èƒ½éœ€è¦å…ˆè‡ªè¡Œgoogleä¸€ä¸‹ï¼Œåšç‚¹çŸ¥è¯†å‚¨å¤‡ã€‚</p>
<p>é‚£ä¹ˆå‡è®¾å¤§å®¶å·²ç»æœ‰äº†ä¸€äº›åŸºç¡€çš„ç¥ç»ç½‘ç»œã€TensorFlow.jsåŸºç¡€çŸ¥è¯†ï¼Œå°±å¯ä»¥åˆ©ç”¨TensorFlow.jsè½»æ¾æ­å»ºä¸€ä¸ªåŸºäºCNNçš„å›¾ç‰‡åˆ†ç±»æ¨¡å‹ã€‚</p>
<h3 data-id="heading-5">3.1 è·å–æ•°æ®é›†</h3>
<p>åœ¨è¿›å…¥æ¨¡å‹è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å–æ•°æ®é›†ã€‚</p>
<p>æ•°æ®é›†æ˜¯è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºæ•°æ®é›†ï¼ˆè¿™å¾ˆå›°éš¾ã€è´¹æ—¶ï¼‰ï¼Œæˆ–è€…å¯»æ‰¾ä¸€äº›å¼€æºæ•°æ®é›†ã€‚åˆšå¥½Google Labæä¾›äº†ä¸€å¥—å®Œæ•´çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fquickdraw.withgoogle.com%2Fdata" target="_blank" title="https://quickdraw.withgoogle.com/data" ref="nofollow noopener noreferrer">å¼€æºæ¶‚é¸¦æ•°æ®é›†ï¼ˆThe Quick Draw Datasetï¼‰</a>ï¼Œæ•°æ®é›†ä¸­åŒ…å«äº†345ä¸ªä¸åŒç±»åˆ«çš„æ¶‚é¸¦æ•°æ®é›†åˆï¼Œæ€»å…±æœ‰5000ä¸‡ä»½æ¶‚é¸¦æ•°æ®ï¼Œè¶³å¤Ÿæˆ‘ä»¬æŒ‘é€‰ä½¿ç”¨ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/5b/5b0b47d45a504e148ec442b4d11b849e.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®<a href="https://link.juejin.cn?target=https%3A%2F%2Fquickdraw.withgoogle.com%2Fdata" target="_blank" title="https://quickdraw.withgoogle.com/data" ref="nofollow noopener noreferrer">å¼€æºæ¶‚é¸¦æ•°æ®é›†ï¼ˆThe Quick Draw Datasetï¼‰</a>ä¸‹è½½æ‰€éœ€çš„æ•°æ®ã€‚ç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgooglecreativelab%2Fquickdraw-dataset" target="_blank" title="https://github.com/googlecreativelab/quickdraw-dataset" ref="nofollow noopener noreferrer">Get the Data</a> è·³è½¬githubä»“åº“ï¼Œå¯ä»¥çœ‹åˆ°æ–‡æ¡£ä¸­åˆ—å‡ºäº†å¤šç§æ•°æ®ç±»å‹ï¼š</p>
<p><img src="https://static001.geekbang.org/infoq/6c/6cd335b509ae7fb9e9179272fd0d6849.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥é€‰æ‹©ä¸‹è½½<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.cloud.google.com%2Fstorage%2Fbrowser%2Fquickdraw_dataset%2Ffull%2Fnumpy_bitmap" target="_blank" title="https://console.cloud.google.com/storage/browser/quickdraw_dataset/full/numpy_bitmap" ref="nofollow noopener noreferrer">Numpy bitmap files</a>ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/57/574bc7918d605cef5c1ab085de0106ff.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>**æ³¨æ„ï¼š**è¿™é‡Œçš„æ•°æ®é›†æœ‰345ç§ç±»åˆ«ï¼Œå¦‚æœå…¨éƒ¨è¿›è¡Œè®­ç»ƒçš„è¯ï¼Œè®­ç»ƒæ—¶é—´ä¼šå¾ˆé•¿å¹¶ä¸”æœ€ç»ˆçš„æ¨¡å‹å¤§å°è¾ƒå¤§ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è§†æƒ…å†µæŒ‘é€‰å…¶ä¸­çš„éƒ¨åˆ†è¯æ±‡ï¼Œä¾‹å¦‚é€‰æ‹©80ä¸ªè¯æ±‡è¿›è¡Œè®­ç»ƒï¼Œå¯¹äºä¸€æ¬¾å°æ¸¸æˆæ¥è¯´ï¼Œè¯æ±‡é‡ä¹Ÿè¶³å¤Ÿäº†ã€‚</p>
<h3 data-id="heading-6">3.2 æ­å»ºæ¨¡å‹å’Œè®­ç»ƒæ¨¡å‹</h3>
<p>ä¸‹è½½å®Œè®­ç»ƒæ•°æ®ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ­å»ºæ¨¡å‹ç»“æ„å¹¶è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä¸‹è½½äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw" ref="nofollow noopener noreferrer">demoä»£ç </a>ï¼Œå¯ä»¥çœ‹åˆ°é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼Œä¸»è¦å†…å®¹ä¸º3ä¸ªéƒ¨åˆ†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">é¡¹ç›®ç›®å½•/
â”œâ”€â”€ ğŸ“ src/                    
â”‚   â”œâ”€â”€ ğŸ“„ index.ts            <span class="hljs-comment"># ç¨‹åºå…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ ğŸ“ data/               <span class="hljs-comment"># æ•°æ®é›†</span>
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Apple.npy
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ The Great Wall.npy  
â”‚   â”‚   â””â”€â”€ ğŸ“„ ...       
â”‚   â””â”€â”€ ğŸ“ model/              <span class="hljs-comment"># è®­ç»ƒæ¨¡å‹ç›¸å…³</span>
â”‚       â”œâ”€â”€ ğŸ“„ doodle-data.model.ts  <span class="hljs-comment"># æ•°æ®åŠ è½½</span>
â”‚       â””â”€â”€ ğŸ“„ classifier.model.ts   <span class="hljs-comment"># æ¨¡å‹ç»“æ„</span>
â”œâ”€â”€ ğŸ“„ package.json
</code></pre>
<p>**-dataç›®å½•ï¼š**å­˜æ”¾è®­ç»ƒæ•°æ®é›†</p>
<p><strong>-modelç›®å½•ï¼š</strong></p>
<ul>
<li>
<p>doodle-data.model.tsï¼šæ•°æ®åŠ è½½é¢„å¤„ç†</p>
</li>
<li>
<p>classifier.model.tsï¼šå®šä¹‰æ¨¡å‹ç»“æ„</p>
</li>
</ul>
<p>**-index.tsï¼š**è®­ç»ƒç¨‹åºå…¥å£</p>
<p>å…ˆæ¥çœ‹é¡¹ç›®çš„index.tså…¥å£æ–‡ä»¶ï¼ŒåŠŸèƒ½éå¸¸ç®€å•ï¼Œä¸»è¦é€»è¾‘å°±æ˜¯å››æ­¥ï¼š</p>
<ul>
<li>
<p>åŠ è½½è®­ç»ƒæ•°æ®</p>
</li>
<li>
<p>åˆ›å»ºæ¨¡å‹</p>
</li>
<li>
<p>è®­ç»ƒæ¨¡å‹</p>
</li>
<li>
<p>ä¿å­˜æ¨¡å‹å‚æ•°</p>
<p>import { Classifier } from './model/classifier.model';
import { DoodleData } from './model/doodle-data.model';</p>
<p>async function main(){
const data = new DoodleData({
directoryData: 'src/data',
maxImageClass: 20000
});</p>
<p>// 1. åŠ è½½è®­ç»ƒæ•°æ®
data.loadData();
// 2. åˆ›å»ºæ¨¡å‹
const model = new Classifier(data);
// 3. è®­ç»ƒæ¨¡å‹
await model.train();
// 4. ä¿å­˜æ¨¡å‹å‚æ•°
await model.save();
}</p>
<p>main();</p>
</li>
</ul>
<p>äº†è§£äº†æ ¸å¿ƒæµç¨‹ä¹‹åï¼Œå†æ¥è¯¦ç»†çœ‹ä¸‹modelç›®å½•ä¸‹çš„ä¸¤ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼šdoodle-data.model.tså’Œclassifier.model.tsã€‚</p>
<p><strong>é¦–å…ˆæ˜¯doodle-data.model.ts</strong> ï¼Œå®ƒçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯åŠ è½½dataç›®å½•ä¸‹çš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®é¢„å¤„ç†ä¸ºtensorå¼ é‡ï¼Œåç»­å¯äºè®­ç»ƒæ¨¡å‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŠ è½½dataç›®å½•ä¸‹çš„æ•°æ®</span>
<span class="hljs-title function_">loadData</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">classes</span> = fs.<span class="hljs-title function_">readdirSync</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">directoryData</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.npy'</span>))
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'.npy'</span>, <span class="hljs-string">''</span>));
}

<span class="hljs-comment">// æ•°æ®ç”Ÿæˆå™¨ï¼Œé¢„å¤„ç†æ•°æ®ä¸ºtensorå¼ é‡</span>
*<span class="hljs-title function_">dataGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; bytes.<span class="hljs-property">length</span>; j = j + <span class="hljs-variable language_">this</span>.<span class="hljs-property">IMAGE_SIZE</span>) {
    <span class="hljs-keyword">const</span> singleImage = bytes.<span class="hljs-title function_">slice</span>(j, j + <span class="hljs-variable language_">this</span>.<span class="hljs-property">IMAGE_SIZE</span>);
    <span class="hljs-keyword">const</span> image = tf
      .<span class="hljs-title function_">tensor</span>(singleImage)
      .<span class="hljs-title function_">reshape</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">IMAGE_WIDTH</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">IMAGE_HEIGHT</span>, <span class="hljs-number">1</span>])
      .<span class="hljs-title function_">toFloat</span>();
    <span class="hljs-keyword">const</span> xs = image.<span class="hljs-title function_">div</span>(offset);
    <span class="hljs-keyword">const</span> ys = tf.<span class="hljs-title function_">tensor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">classes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> (x === label ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>)));
    <span class="hljs-keyword">yield</span> { xs, ys };
  }
}
</code></pre>
<p>**å…¶æ¬¡æ˜¯ï¼Œclassifier.model.tsã€‚**å®ƒçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼Œä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š</p>
<p>æ„å»ºäº†ä¸€ä¸ªåŸºäºCNNçš„å›¾åƒåˆ†ç±»æ¨¡å‹ã€‚é€šè¿‡tf.layers.conv3d()æ„é€ äº†å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ã€‚</p>
<p>æä¾›äº†train()æ–¹æ³•ï¼Œç”¨äºè®­ç»ƒæ¨¡å‹ã€‚è¿™é‡Œå®šä¹‰äº†æ¨¡å‹è®­ç»ƒçš„è¿­ä»£æ¬¡æ•°ï¼ˆepochsï¼‰ã€è®­ç»ƒçš„æ‰¹æ¬¡å¤§å°ï¼ˆbatchSizeï¼‰ï¼Œè¿™äº›å‚æ•°ä¼šå½±å“æ¨¡å‹è®­ç»ƒçš„æœ€ç»ˆç»“æœï¼Œå°±æ˜¯é€šå¸¸æˆ‘ä»¬æ‰€è¯´çš„â€œæ¨¡å‹è°ƒå‚â€ï¼Œå½“ä½ è§‰å¾—æ¨¡å‹è®­ç»ƒæ•ˆæœä¸ä½³æ—¶ï¼Œå¯ä»¥è°ƒæ•´è¿™äº›å‚æ•°é‡æ–°è®­ç»ƒï¼Œç›´åˆ°è¾¾æˆä¸é”™çš„å‡†ç¡®ç‡ã€‚</p>
<p>æä¾›äº†save()æ–¹æ³•ï¼Œç”¨äºä¿å­˜æ¨¡å‹å‚æ•°ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> tf from <span class="hljs-string">"@tensorflow/tfjs-node"</span>;
<span class="hljs-keyword">import</span> { DoodleData } from <span class="hljs-string">"./doodle-data.model"</span>;

exportclassClassifier {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-comment">// å®šä¹‰æ¨¡å‹ç»“æ„</span>
  <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">data</span>: DoodleData) {
    <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span> = <span class="hljs-keyword">data</span>;
    <span class="hljs-keyword">this</span>.model = tf.sequential();
    <span class="hljs-keyword">this</span>.model.add(
      tf.layers.conv2d({
        inputShape: [<span class="hljs-keyword">data</span>.IMAGE_WIDTH, <span class="hljs-keyword">data</span>.IMAGE_HEIGHT, <span class="hljs-number">1</span>],
        kernelSize: <span class="hljs-number">3</span>,
        filters: <span class="hljs-number">16</span>,
        strides: <span class="hljs-number">1</span>,
        activation: <span class="hljs-string">"relu"</span>,
        kernelInitializer: <span class="hljs-string">"varianceScaling"</span>,
      })
    );
    <span class="hljs-keyword">this</span>.model.add(
      tf.layers.maxPooling2d({
        poolSize: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
        strides: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
      })
    );
    <span class="hljs-keyword">this</span>.model.add(
      tf.layers.conv2d({
        kernelSize: <span class="hljs-number">3</span>,
        filters: <span class="hljs-number">32</span>,
        strides: <span class="hljs-number">1</span>,
        activation: <span class="hljs-string">"relu"</span>,
        kernelInitializer: <span class="hljs-string">"varianceScaling"</span>,
      })
    );
    <span class="hljs-keyword">this</span>.model.add(
      tf.layers.maxPooling2d({
        poolSize: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
        strides: [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>],
      })
    );
    <span class="hljs-keyword">this</span>.model.add(tf.layers.flatten());
    <span class="hljs-keyword">this</span>.model.add(
      tf.layers.dense({
        units: <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.totalClasses,
        kernelInitializer: <span class="hljs-string">"varianceScaling"</span>,
        activation: <span class="hljs-string">"softmax"</span>,
      })
    );

    <span class="hljs-keyword">const</span> optimizer = tf.train.adam();
    <span class="hljs-keyword">this</span>.model.compile({
      optimizer,
      loss: <span class="hljs-string">"categoricalCrossentropy"</span>,
      metrics: [<span class="hljs-string">"accuracy"</span>],
    });
  }

  <span class="hljs-comment">// æ¨¡å‹è®­ç»ƒ</span>
  async train(){
    <span class="hljs-keyword">const</span> trainingData = tf.<span class="hljs-keyword">data</span>
      .generator(() =&gt; <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.dataGenerator(<span class="hljs-string">"train"</span>))
      .shuffle(<span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.maxImageClass * <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.totalClasses)
      .batch(<span class="hljs-number">64</span>);

    <span class="hljs-keyword">const</span> testData = tf.<span class="hljs-keyword">data</span>
      .generator(() =&gt; <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.dataGenerator(<span class="hljs-string">"test"</span>))
      .shuffle(<span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.maxImageClass * <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.totalClasses)
      .batch(<span class="hljs-number">64</span>);

    await <span class="hljs-keyword">this</span>.model.fitDataset(trainingData, {
      epochs: <span class="hljs-number">5</span>,
      validationData: testData,
      callbacks: {
        onEpochEnd: async (epoch, logs) =&gt; {
          <span class="hljs-keyword">this</span>.logger.debug(
            `Epoch: ${epoch} - acc: ${logs?.acc.toFixed(
              <span class="hljs-number">3</span>
            )} - loss: ${logs?.loss.toFixed(<span class="hljs-number">3</span>)}`
          );
        },
        onBatchBegin: async (epoch, logs) =&gt; {
          console.log(<span class="hljs-string">"onBatchBegin"</span> + epoch + JSON.stringify(logs));
        },
      },
    });
  }

  <span class="hljs-comment">// ä¿å­˜æ¨¡å‹</span>
  async save(){
    fs.mkdirSync(<span class="hljs-string">"doodle-model"</span>, { recursive: <span class="hljs-literal">true</span> });
    fs.writeFileSync(
      <span class="hljs-string">"doodle-model/classes.json"</span>,
      JSON.stringify({ classes: <span class="hljs-keyword">this</span>.<span class="hljs-keyword">data</span>.classes })
    );
    await <span class="hljs-keyword">this</span>.model.save(<span class="hljs-string">"file://./doodle-model"</span>);
  }
}
</code></pre>
<p>å¦‚æœæˆ‘ä»¬ä»githubä»“åº“ä¸‹è½½äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw" ref="nofollow noopener noreferrer">demo</a>ä»£ç ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npm run start
</code></pre>
<p>å¼€å¯æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ï¼Œä¼šæœ‰ä¸€äº›è¾“å‡ºå¦‚ä¸‹ï¼Œè¡¨ç¤ºå½“å‰çš„è®­ç»ƒè½®æ¬¡ã€è¯†åˆ«å‡†ç¡®ç‡ã€æŸå¤±ç­‰ã€‚</p>
<pre><code class="hljs language-erlang" lang="erlang">onBatchBegin0{<span class="hljs-string">"batch"</span>:<span class="hljs-number">0</span>,<span class="hljs-string">"size"</span>:<span class="hljs-number">512</span>}
onBatchBegin1{<span class="hljs-string">"batch"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"size"</span>:<span class="hljs-number">512</span>}
onBatchBegin2{<span class="hljs-string">"batch"</span>:<span class="hljs-number">2</span>,<span class="hljs-string">"size"</span>:<span class="hljs-number">512</span>}
onBatchBegin3{<span class="hljs-string">"batch"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"size"</span>:<span class="hljs-number">512</span>}
onBatchBegin4{<span class="hljs-string">"batch"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"size"</span>:<span class="hljs-number">192</span>}
...
[Classifier] Epoch: <span class="hljs-number">0</span> - acc: <span class="hljs-number">0.078</span> - loss: <span class="hljs-number">2.632</span>
...
</code></pre>
<p>è€å¿ƒç­‰å¾…æ—¥å¿—æ‰“å®Œï¼Œæ¨¡å‹è®­ç»ƒå®Œæˆä¹‹åï¼Œæˆ‘ä»¬çš„é¡¹ç›®ç›®å½•ä¸‹å°±ä¼šäº§å‡ºä¸€ä¸ªé¢å¤–çš„ç›®å½•ï¼Œå­˜æ”¾æ¨¡å‹çš„è®­ç»ƒç»“æœã€‚</p>
<ul>
<li>
<p>**classes.jsonï¼š**å›¾ç‰‡çš„æ‰€æœ‰åˆ†ç±»ï¼Œæ ¹æ®dataç›®å½•ä¸­çš„æ•°æ®æ–‡ä»¶åç§°ç”Ÿæˆ</p>
</li>
<li>
<p>**model.jsonï¼š**æ¨¡å‹çš„æè¿°æ–‡ä»¶</p>
</li>
<li>
<p>**weights.binï¼š**æ¨¡å‹çš„å‚æ•°æ–‡ä»¶</p>
<p>é¡¹ç›®ç›®å½•/
â”œâ”€â”€ ğŸ“ doodle-model/           # è®­ç»ƒç»“æœï¼ˆæœ€ç»ˆæ¨¡å‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ classes.json    # å›¾ç‰‡åˆ†ç±»<br/>
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ model.json      # æ¨¡å‹æè¿°æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ ğŸ“„ weights.bin     # æ¨¡å‹å‚æ•°</p>
</li>
</ul>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°±è®­ç»ƒå®Œæˆäº†ã€‚</p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•åœ¨é¡µé¢ä¸­é›†æˆæ¨¡å‹ï¼Œå®ç°ä»ç»˜åˆ¶canvaså›¾ç‰‡åˆ°æ¨¡å‹åˆ†ç±»é¢„æµ‹çš„æ•ˆæœã€‚</p>
<h2 data-id="heading-7">å››ã€é›†æˆè‡³é¡µé¢</h2>
<p>åœ¨é¡µé¢ä¸­çš„é›†æˆæ¨¡å‹ä¹Ÿéå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºä¸€ä¸ªå¯ä»¥ç»˜å›¾çš„canvasï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å°±å°†å½“å‰canvasçš„å›¾åƒæ•°æ®ä¼ è¾“ç»™æ¨¡å‹ï¼Œè§¦å‘ä¸€æ¬¡æ¨¡å‹é¢„æµ‹å³å¯ã€‚</p>
<p>å…ˆæ¥çœ‹ä¸‹é¡¹ç›®çš„æ ¸å¿ƒç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">é¡¹ç›®ç›®å½•/
â”œâ”€â”€ ğŸ“ public/assets/doodle-modle/   <span class="hljs-comment"># å°†è®­ç»ƒç”Ÿæˆçš„æ¨¡å‹æ”¾ç½®åœ¨publicç›®å½•ä¸‹</span>
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ classes.json    <span class="hljs-comment"># å›¾ç‰‡åˆ†ç±»     </span>
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ model.json      <span class="hljs-comment"># æ¨¡å‹æè¿°æ–‡ä»¶</span>
â”‚   â”‚   â””â”€â”€ ğŸ“„ weights.bin     <span class="hljs-comment"># æ¨¡å‹å‚æ•°</span>
â”œâ”€â”€ ğŸ“ src   
â”‚   â”œâ”€â”€ ğŸ“ models/               
â”‚   â”‚   â””â”€â”€ ğŸ“„ DoodleClassifier.js  <span class="hljs-comment"># å›¾ç‰‡åˆ†ç±»å™¨</span>
â”‚   â”œâ”€â”€ ğŸ“ views/               
â”‚   â”‚   â””â”€â”€ ğŸ“„ DoodleView.vue   <span class="hljs-comment"># é¡µé¢è§†å›¾ï¼ˆcanvasç”»å¸ƒï¼‰</span>
</code></pre>
<p><strong>å…¶ä¸­ï¼ŒDoodleClassifier.jsçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<p>**loadModelï¼š**åŠ è½½æ¨¡å‹ï¼ŒåŒ…æ‹¬model.jsonã€classes.jsonï¼Œåœ¨model.jsonä¸­ä¼šè‡ªåŠ¨åŠ è½½weights.bin</p>
</li>
<li>
<p>**predictTopNï¼š**è¾“å…¥å›¾ç‰‡æ•°æ®ï¼Œè°ƒç”¨model.predict() é¢„æµ‹æœ€æœ‰å¯èƒ½çš„TopNä¸ªåˆ†ç±»ç»“æœï¼Œå¹¶æŒ‰ç…§ç½®ä¿¡åº¦æ’åº</p>
<p>import * as tf from "@tensorflow/tfjs";
import apiClient from "@/services/http";</p>
<p>// åŠ è½½æ¨¡å‹
async loadModel(){
this.model = await tf.loadLayersModel("assets/doodle-model/model.json");
const response = await apiClient.get("assets/doodle-model/classes.json");
this.classes = response.data.classes;
}</p>
<p>// é¢„æµ‹æœ€æœ‰å¯èƒ½çš„TopNä¸ªåˆ†ç±»ï¼Œå¹¶æŒ‰ç…§ç½®ä¿¡åº¦æ’åº
async predictTopN(data, n){
const predictions = Array.from(await this.model.predict(data).data());</p>
<p>const indexedPredictions = predictions.map((probability, index) =&gt; ({
probability,
index,
}));</p>
<p>indexedPredictions.sort((a, b) =&gt; b.probability - a.probability);</p>
<p>const topNPredictions = indexedPredictions.slice(0, n);</p>
<p>return topNPredictions.map((p) =&gt; ({
label: this.classes[p.index],
accuracy: p.probability,
}));
}</p>
<p>// é¢„æµ‹åˆ†ç±»ç»“æœ
async predict(data){
const argMax = await this.model.predict(data).argMax(-1).data();
returnthis.classes[argMax[0]];
}</p>
</li>
</ul>
<p><strong>DoodleView.vueçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<p>è°ƒç”¨new DoodleClassifier()æ„é€ å›¾ç‰‡åˆ†ç±»å™¨</p>
</li>
<li>
<p>è°ƒç”¨loadModel()åŠ è½½æ¨¡å‹</p>
</li>
<li>
<p>é¢„å¤„ç†canvasçš„å›¾ç‰‡æ•°æ®</p>
</li>
<li>
<p>å°†é¢„å¤„ç†çš„æ•°æ®ä¼ è¾“ç»™model.predictTopN()ï¼Œé¢„æµ‹å›¾ç‰‡åˆ†ç±»</p>
<p>// æ„é€ å›¾ç‰‡åˆ†ç±»å™¨
this.model = new DoodleClassifier()</p>
<p>// åŠ è½½æ¨¡å‹
this.model.loadModel()</p>
<p>// é¢„å¤„ç†canvaså›¾ç‰‡æ•°æ®
const tensor = tf.browser.fromPixels(imgData, 1);
const resized = tf.image
.resizeBilinear(tensor, [28, 28])
.reshape([1, 28, 28, 1]) // Reshape to [1, 28, 28, 1] for batch and single channel
.toFloat();
const normalized = tf.scalar(1.0).sub(resized.div(tf.scalar(255.0)));</p>
<p>// é¢„æµ‹å›¾ç‰‡åˆ†ç±»
this.model.predictTopN(normalized, 5).then((predictions) =&gt; {
if (predictions) {
this.predictions = predictions;
}
});</p>
</li>
</ul>
<p>åˆ°è¿™ä¸ºæ­¢ï¼Œä½ ç”»æˆ‘çŒœ-AIç‰ˆå°±å·²ç»åŸºæœ¬æ­å»ºå®Œæˆäº†ã€‚å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚</p>
<p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå¹¶ä¸”ä½ æŒ‰ç…§æˆ‘ä»¬æä¾›çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvivo%2FBlueSnippets%2Ftree%2Fmain%2Fdemos%2Fai-quickdraw%2Fquickdraw-app" target="_blank" title="https://github.com/vivo/BlueSnippets/tree/main/demos/ai-quickdraw/quickdraw-app" ref="nofollow noopener noreferrer">demo</a>æ„å»ºé¡µé¢ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨é¡¹ç›®ä¸­è¿è¡Œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npm run serve
</code></pre>
<p>ä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„ä½ ç”»æˆ‘çŒœAIç‰ˆå°±è¿è¡ŒæˆåŠŸäº†ï¼Œè¯•è¯•çœ‹å§ã€‚</p>
<p><img src="https://static001.geekbang.org/infoq/2c/2c7b2070f587bec6c7ce03a58c21aaf2.jpeg" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-8">äº”ã€ä¼˜åŒ–æªæ–½</h2>
<p>é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å®Œæˆäº†æ¨¡å‹è®­ç»ƒå’Œcanvaså›¾ç‰‡åˆ†ç±»é¢„æµ‹çš„å…¨æµç¨‹ï¼ŒæˆåŠŸå®ç°äº†ä½ ç”»æˆ‘çŒœAIç‰ˆã€‚ä½†å®é™…ä¸Šå¯èƒ½ä¼šé‡åˆ°ä¸¤ä¸ªæ¯”è¾ƒå…³é”®çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-9">5.1 æ•°æ®æ ‡å‡†åŒ–</h3>
<p>å½“æˆ‘ä»¬å»è°ƒæ•´canvasç”»å¸ƒå¤§å°ã€ç”»ç¬”ç²—ç»†åï¼Œå¯èƒ½ä¼šå‡ºç°é¢„æµ‹ç»“æœä¸å‡†ç¡®çš„æƒ…å†µï¼Œæ­¤æ—¶ä»canvasè·å–çš„å›¾åƒæ•°æ®å’Œæˆ‘ä»¬å–‚ç»™æ¨¡å‹çš„è®­ç»ƒæ•°æ®äº§ç”Ÿäº†å·®å¼‚ã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨è·å–åˆ°canvasæ•°æ®åï¼Œé¢å¤–åšä¸€äº›æ•°æ®é¢„å¤„ç†ï¼Œå°†æ•°æ®æ ‡å‡†åŒ–ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>
<p>å°†ç”»å¸ƒçš„å†…å®¹åŒºåŸŸè£å‰ªä¸ºæ­£æ–¹å½¢ï¼Œå¹¶å±…ä¸­æ˜¾ç¤º</p>
</li>
<li>
<p>å°†ç”»å¸ƒçš„çº¿æ¡é€‚å½“å˜ç²—ï¼Œä½¿æ¨¡å‹æ›´å®¹æ˜“è¯†åˆ«</p>
</li>
</ul>
<h3 data-id="heading-10">5.2 åˆ©ç”¨ webworker ä¼˜åŒ–æ€§èƒ½</h3>
<p>æ¨¡å‹çš„è®¡ç®—è¿‡ç¨‹æ˜¯ååˆ†è€—æ—¶çš„ï¼Œå°†è®¡ç®—è¿‡ç¨‹æ”¾åœ¨ä¸»çº¿ç¨‹ä¼šå¯¼è‡´é¡µé¢å¡é¡¿ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªæ¨¡å‹çš„é¢„æµ‹éƒ¨åˆ†æ”¾å…¥webworkerä¸­ï¼Œä»¥æ­¤æ¥æå‡è®¡ç®—æ€§èƒ½ï¼Œä¸å½±å“é¡µé¢æ¸²æŸ“ã€‚</p>
<h2 data-id="heading-11">å…­ã€æ€»ç»“</h2>
<p>ä½ ç”»æˆ‘çŒœ-ç«¯ä¾§AIç‰ˆæ˜¯å‰ç«¯ç»“åˆAIçš„ä¸€ä¸ªç®€å•æ¡ˆä¾‹ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†å‰ç«¯åˆ©ç”¨AIèµ‹èƒ½çš„å¤§è‡´æ€è·¯å’ŒåŸºæœ¬å®ç°é€»è¾‘ã€‚æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©äº‘ç«¯æ¨¡å‹æ¥æ‹“å±•å‰ç«¯ä¸šåŠ¡ã€‚ä½†å¦‚æœç¼ºä¹èµ„æºï¼Œæˆ‘ä»¬åˆ™è½¬è€Œè€ƒè™‘ä½¿ç”¨ç«¯ä¾§çš„ç‰¹å®šé¢†åŸŸæ¨¡å‹æ¥äº§å‡ºä¸€äº›æ–°ç©æ³•ã€æ–°äº¤äº’ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç«¯ä¾§AIå…·æœ‰æ›´å¼ºçš„çµæ´»æ€§ã€å®‰å…¨æ€§å’Œæ›´ä½çš„é›†æˆæˆæœ¬ã€‚å¤§å®¶å¯ä»¥è¯•ç€åœ¨å„è‡ªçš„ä¸šåŠ¡ä¸­æ¢ç´¢å’Œä½¿ç”¨ç«¯ä¾§AIï¼Œæˆ–è®¸æ— æ³•äº§å‡ºå¤ªå¤§çš„æ•ˆç›Šï¼Œä½†ä¹Ÿæ˜¯åœ¨å…¨æ°‘AIæ—¶ä»£ä¸‹ï¼Œä¸€äº›ç§¯æçš„å°è¯•å’Œæ²‰æ·€ã€‚</p>
<h2 data-id="heading-12">ä¸ƒã€å‚è€ƒ</h2>
<p>éƒ¨åˆ†ä»£ç å‚è€ƒè‡ªï¼š</p>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FRiccardoGai%2Fdoddle-classifier-model" target="_blank" title="https://github.com/RiccardoGai/doddle-classifier-model" ref="nofollow noopener noreferrer">Gihuthub | RiccardoGai | doddle-classifier-model</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FRiccardoGai%2Fdoddle-classifier-app" target="_blank" title="https://github.com/RiccardoGai/doddle-classifier-app" ref="nofollow noopener noreferrer">Gihuthub | RiccardoGai | doddle-classifier-app</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyining1023%2FdoodleNet%2Ftree%2Fmaster" target="_blank" title="https://github.com/yining1023/doodleNet/tree/master" ref="nofollow noopener noreferrer">Gihuthub |</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyining1023%2FdoodleNet%2Ftree%2Fmaster" target="_blank" title="https://github.com/yining1023/doodleNet/tree/master" ref="nofollow noopener noreferrer">yining1023 | doodleNet</a></p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ å…±ç»©ç®—åŠ›ï¼š3åˆ†é’Ÿæ‹¥æœ‰è‡ªå·±çš„å›¾åƒä¼˜åŒ–æœåŠ¡-CodeFormerï¼šå…ˆè¿›çš„å›¾åƒç®—æ³•ä¼˜åŒ–ã€ä¿®å¤é©¬èµ›å…‹ã€æå‡å›¾ç‰‡æ¸…æ™°åº¦ç­‰]]></title>    <link>https://juejin.cn/post/7571743311520350217</link>    <guid>https://juejin.cn/post/7571743311520350217</guid>    <pubDate>2025-11-13T02:24:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571743311520350217" data-draft-id="7571729682678972466" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ å…±ç»©ç®—åŠ›ï¼š3åˆ†é’Ÿæ‹¥æœ‰è‡ªå·±çš„å›¾åƒä¼˜åŒ–æœåŠ¡-CodeFormerï¼šå…ˆè¿›çš„å›¾åƒç®—æ³•ä¼˜åŒ–ã€ä¿®å¤é©¬èµ›å…‹ã€æå‡å›¾ç‰‡æ¸…æ™°åº¦ç­‰"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-11-13T02:24:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ å…±ç»©ç®—åŠ›ï¼š3åˆ†é’Ÿæ‹¥æœ‰è‡ªå·±çš„å›¾åƒä¼˜åŒ–æœåŠ¡-CodeFormerï¼šå…ˆè¿›çš„å›¾åƒç®—æ³•ä¼˜åŒ–ã€ä¿®å¤é©¬èµ›å…‹ã€æå‡å›¾ç‰‡æ¸…æ™°åº¦ç­‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:24:29.000Z" title="Thu Nov 13 2025 02:24:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ğŸŒŒ å…±ç»©ç®—åŠ›æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>å½“æˆ‘ä»¬è°ˆè®ºâ€œç®—åŠ›â€ï¼Œå…¶å®æ˜¯åœ¨è°ˆè®ºäººç±»ä¸æ™ºèƒ½çš„æ²Ÿé€šé€Ÿåº¦ã€‚<br/>
è€Œ <strong>å…±ç»©ç®—åŠ›</strong>ï¼Œæ­£æ˜¯è¿™åœºé€Ÿåº¦é©å‘½çš„å¼•æ“ã€‚</p>
<p>å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ª GPU æœåŠ¡å¹³å°ï¼Œæ›´æ˜¯ AI å¼€å‘è€…ã€ç§‘ç ”å›¢é˜Ÿä¸åˆ›æ–°ä¼ä¸šçš„â€œæ™ºä½œå·¥åŠâ€ã€‚<br/>
æ— è®ºä½ æ˜¯åœ¨è®­ç»ƒå¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œè¿˜æ˜¯åœ¨éƒ¨ç½²å®æ—¶æ¨ç†ä»»åŠ¡ï¼Œå…±ç»©éƒ½èƒ½ç”¨çµæ´»ã€é«˜æ€§èƒ½çš„ç®—åŠ›ï¼Œè®©åˆ›æ„è½åœ°çš„è¿‡ç¨‹ä¸å†å—é™ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ§© æ ¸å¿ƒæœåŠ¡èƒ½åŠ›</h3>
<h4 data-id="heading-2">âš™ï¸ äº‘ä¸»æœºï¼šAI å¼€å‘è€…çš„è¶…ç®—ä¼™ä¼´</h4>
<p>ï¼ˆ<strong>æ­¤å¤„é¢„ç•™äº‘ä¸»æœºå›¾ç‰‡åŒºåŸŸ</strong>ï¼‰</p>
<p><strong>å…±ç»©ç§‘æŠ€äº‘ä¸»æœº</strong> é¢å‘ AIã€ç§‘ç ”ä¸ä¼ä¸šçº§åœºæ™¯ï¼Œ<br/>
æä¾› <strong>é«˜æ€§èƒ½ GPU ç®—åŠ›ã€æé€Ÿéƒ¨ç½²ä½“éªŒ</strong> ä¸ <strong>ä¼ä¸šçº§å®‰å…¨ä¿éšœ</strong>ã€‚</p>
<p><strong>ä¼˜åŠ¿ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>æ”¯æŒå¤šç§ä¸»æµ GPU å‹å·ï¼Œç®—åŠ›â€œéšå«éšåˆ°â€ï¼›</li>
<li>ä¸€é”®åˆ›å»ºå®ä¾‹ï¼Œåˆ†é’Ÿçº§å¯åŠ¨ï¼›</li>
<li>ç¨³å®šç½‘ç»œä¸å®‰å…¨éš”ç¦»æœºåˆ¶ï¼Œä¿éšœè®­ç»ƒä¸æ¨ç†è¿‡ç¨‹é«˜æ•ˆå¯é ã€‚</li>
</ul>
<blockquote>
<p>ä»æ¨¡å‹è®­ç»ƒåˆ°æ¨ç†éƒ¨ç½²ï¼Œä½ åªéœ€ä¸€æ¬¡ç‚¹å‡»ï¼Œå…¶ä»–äº¤ç»™å…±ç»©ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-3">ğŸª„ å¼¹æ€§éƒ¨ç½²ï¼šç®—åŠ›åƒå‘¼å¸ä¸€æ ·è‡ªç„¶</h4>
<p>ï¼ˆ<strong>æ­¤å¤„é¢„ç•™å¼¹æ€§éƒ¨ç½²å›¾ç‰‡åŒºåŸŸ</strong>ï¼‰</p>
<p>å½“æ¨¡å‹è®­ç»ƒè¿›å…¥é«˜å³°æœŸï¼Œç®—åŠ›éœ€æ±‚ç¬é—´æš´æ¶¨ï¼›è€Œå½“å®éªŒç»“æŸï¼Œåˆä¸æƒ³è¢«é—²ç½®èµ„æºâ€œåƒæ‰é¢„ç®—â€â€”â€”è¿™æ—¶ä½ éœ€è¦çš„æ­£æ˜¯ <strong>å…±ç»©ç§‘æŠ€çš„å¼¹æ€§éƒ¨ç½²æœåŠ¡</strong>ã€‚</p>
<p><strong>æˆ‘ä»¬æä¾›ï¼š</strong></p>
<ul>
<li>â± ç§’çº§æ‰©ç¼©å®¹ï¼šå®æ—¶å“åº”ç®—åŠ›éœ€æ±‚å˜åŒ–ï¼›</li>
<li>ğŸ’° æŒ‰éœ€è®¡è´¹ï¼šè®©æ¯ä¸€åˆ†ç®—åŠ›éƒ½ç‰©æœ‰æ‰€å€¼ï¼›</li>
<li>ğŸ”„ æ— ç¼æ‰©å±•ï¼šè®­ç»ƒé«˜å³°ä¸å†å¡é¡¿ï¼Œæ¨ç†ä½è°·è‡ªåŠ¨é™è½½ã€‚</li>
</ul>
<blockquote>
<p>ç®—åŠ›ä¸æµªè´¹ï¼Œæ€§èƒ½è¿˜åœ¨çº¿ï¼Œç§‘ç ”æ•ˆç‡è½»ç›ˆå¦‚é£ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-4">ğŸ”© è£¸é‡‘å± GPUï¼šä¸ºæé™ä»»åŠ¡å‡†å¤‡çš„ç¡¬æ ¸æ­¦å™¨</h4>
<p>ï¼ˆ<strong>æ­¤å¤„é¢„ç•™è£¸é‡‘å±å›¾ç‰‡åŒºåŸŸ</strong>ï¼‰</p>
<p>é¢å¯¹å¤æ‚çš„ AI æ¨¡å‹è®­ç»ƒã€é«˜æ€§èƒ½è®¡ç®—ï¼ˆHPCï¼‰æˆ–æ ¸å¿ƒä¸šåŠ¡åœºæ™¯ï¼Œ<br/>
<strong>å…±ç»©è£¸é‡‘å±æœåŠ¡å™¨</strong> æä¾›ç‰©ç†çº§åˆ«çš„ç®—åŠ›ä½“éªŒâ€”â€”æ— è™šæ‹ŸåŒ–æŸè€—ã€å…¨ç¡¬ä»¶éš”ç¦»ã€æè‡´æ€§èƒ½é‡Šæ”¾ã€‚</p>
<p><strong>ä½ çš„æ”¶ç›Šï¼š</strong></p>
<ul>
<li>100% ç¡¬ä»¶æ€§èƒ½å æœ‰ï¼›</li>
<li>ä¸“å± GPU ç‰©ç†æœºéš”ç¦»ï¼Œå®‰å…¨æ— å¹²æ‰°ï¼›</li>
<li>æ»¡è¶³é‡‘èçº§ä¸ç§‘ç ”çº§æ•°æ®å®‰å…¨æ ‡å‡†ã€‚</li>
</ul>
<blockquote>
<p>æ¯ä¸€æ¬¡è®­ç»ƒï¼Œéƒ½æ˜¯åœ¨ç‰©ç†æ€§èƒ½çš„æé™ä¸Šå¥”è·‘ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">ğŸ”— å¹³å°ä¼˜åŠ¿ï¼šå¤šæºèåˆï¼Œä¸€ç«™åˆ°ä½</h3>
<p>å…±ç»©æ•´åˆå¤šå®¶ç®—åŠ›èµ„æºä¾›åº”å•†ï¼Œé€šè¿‡æ ‡å‡†åŒ–è´¨æ£€è®¤è¯ï¼Œç¡®ä¿æ¯ä¸€å°æœåŠ¡å™¨éƒ½èƒ½ç¨³å®šè¾“å‡ºé«˜æ€§èƒ½è®¡ç®—åŠ›ã€‚</p>
<p>æ— è®ºæ˜¯ AI æ¨¡å‹è®­ç»ƒã€å¤§æ•°æ®åˆ†æï¼Œè¿˜æ˜¯ HPC åº”ç”¨ï¼Œ<br/>
<strong>â€œå…±ç»©â€éƒ½èƒ½ä¸ºä½ è®¾è®¡æœ€ä¼˜ç®—åŠ›ç»„åˆï¼Œè®©è®¡ç®—ï¼Œæ›´ç®€å•ã€æ›´èªæ˜ã€‚</strong></p>
<hr/>
<h4 data-id="heading-6">ğŸ§© ä¸€ã€è‡ªå»º AI æ–‡ç”Ÿå›¾çš„ä¸»è¦æŒ‘æˆ˜</h4>
<ol>
<li>
<p><strong>ç¯å¢ƒé…ç½®åœ°ç‹±</strong></p>
<ul>
<li>ä¸åŒæ“ä½œç³»ç»Ÿã€Python ç‰ˆæœ¬ã€CUDA é©±åŠ¨ã€PyTorch ä¾èµ–ä¹‹é—´æ€»æœ‰ä¸€å¯¹å½¼æ­¤â€œæ°´ç«ä¸å®¹â€ã€‚</li>
<li>ä¸€ä¸å°å¿ƒç‰ˆæœ¬é”™äº†åŠä¸ªå°æ•°ç‚¹ï¼Œæ§åˆ¶å°å°±å˜æˆçº¢è‰²åœ£ç»ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ˜¾å¡èµ„æºåƒç´§</strong></p>
<ul>
<li>æ–‡ç”Ÿå›¾ä»»åŠ¡é€šå¸¸éœ€è¦ 8GB~24GB æ˜¾å­˜ï¼Œè€Œå¤§å¤šæ•°æ™®é€šç”µè„‘æ ¹æœ¬â€œå–‚ä¸é¥±æ¨¡å‹â€ã€‚</li>
<li>ä½ å¯èƒ½ä¼šä¸€è¾¹çœ‹ç”Ÿæˆè¿›åº¦æ¡ï¼Œä¸€è¾¹ç¥ˆç¥·æ˜¾å­˜åˆ«ç‚¸ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç½‘ç»œä¸é•œåƒé€Ÿåº¦</strong></p>
<ul>
<li>ä¸‹è½½æ¨¡å‹æƒé‡å¾€å¾€æ˜¯â€œæ…¢é€ŸæŠ˜ç£¨æ¨¡å¼â€ï¼Œå‡ GBçš„æ¨¡å‹æ–‡ä»¶åƒä¹Œé¾Ÿçˆ¬ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨ä¸æœåŠ¡ç»´æŠ¤</strong></p>
<ul>
<li>è‡ªå»ºWebUIæœåŠ¡éœ€è¦è‡ªå·±é…ç½®è®¿é—®æƒé™ã€é˜²æ­¢ç«¯å£æš´éœ²ã€è¯ä¹¦æ›´æ–°ç­‰é—®é¢˜ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h4 data-id="heading-7">ğŸš€ äºŒã€3åˆ†é’Ÿæ‹¥æœ‰è‡ªå·±çš„å›¾åƒä¼˜åŒ–æœåŠ¡-CodeFormer</h4>
<h5 data-id="heading-8">ğŸ§  ä¼ ç»Ÿå›¾åƒä¼˜åŒ–æœåŠ¡çš„å…­å¤§éš¾ç‚¹</h5>
<hr/>
<h6 data-id="heading-9">1. æ¨¡ç³Šä¸æ˜¯ä¸€å›äº‹ï¼šé™å™ªã€å»æ¨¡ç³Šä¸ç»†èŠ‚æ¢å¤çš„åšå¼ˆ ğŸ­</h6>
<p>ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚åŒè¾¹æ»¤æ³¢ã€éå±€éƒ¨å‡å€¼ã€é”åŒ–æ ¸å·ç§¯ç­‰ï¼‰å¾€å¾€æŠŠæ¸…æ™°å’Œå™ªå£°æ”¾åœ¨åŒä¸€ä¸ªå¤©å¹³ä¸Šã€‚</p>
<ul>
<li><strong>é™å™ªå¤ªç‹ </strong> â†’ äººåƒå˜æˆâ€œèœ¡åƒâ€</li>
<li><strong>é”åŒ–å¤ªçŒ›</strong> â†’ å™ªç‚¹å˜æˆâ€œæ˜Ÿç©ºâ€</li>
</ul>
<p>åº•å±‚åŸç†ä¸Šï¼Œè¿™äº›ç®—æ³•åªä¾èµ–åƒç´ é‚»åŸŸçš„ç»Ÿè®¡ç‰¹æ€§ï¼Œå¹¶ä¸ä¼šç†è§£äººè„¸ã€çº¹ç†è¿™äº›â€œç»“æ„è¯­ä¹‰â€ã€‚<br/>
äºæ˜¯ï¼Œâ€œé¼»å­”â€è¢«è¯¯è®¤æˆé˜´å½±ï¼Œâ€œå¤´å‘ä¸â€è¢«å½“å™ªç‚¹æ¸…ç†æ‰äº†â€”â€”è¿™ä¸æ˜¯AIï¼Œåªæ˜¯æ•°å­¦çš„æ‚²å‰§ã€‚</p>
<hr/>
<h6 data-id="heading-10">2. åƒç´ ä¿®å¤çš„â€œç›²äººæ‘¸è±¡â€ï¼šç¼ºä¹è¯­ä¹‰ç†è§£ ğŸ§</h6>
<p>å¤šæ•°ä¼ ç»Ÿä¼˜åŒ–æ–¹æ³•æ ¹æœ¬<strong>ä¸â€œæ‡‚â€å›¾ç‰‡çš„å†…å®¹</strong>ã€‚<br/>
å®ƒä»¬åªæ˜¯æ ¹æ®å±€éƒ¨ä¿¡æ¯ä¿®å¤åƒç´ ï¼Œå®Œå…¨ä¸çŸ¥é“â€œè¿™æ˜¯çœ¼ç›â€è¿˜æ˜¯â€œè¿™æ˜¯çª—æˆ·â€ã€‚</p>
<p>å½“å±€éƒ¨åƒç´ ç¼ºå¤±ï¼ˆæ¯”å¦‚é©¬èµ›å…‹ã€å‹ç¼©å—ï¼‰æ—¶ï¼Œè¿™ç±»ç®—æ³•åªèƒ½æ ¹æ®é‚»è¿‘åƒç´ æ’å€¼è¡¥å…¨ã€‚<br/>
ç»“æœå‘¢ï¼Ÿä¿®å‡ºä¸€ä¸ªæ­ªè„¸ï¼Œæˆ–è€…â€œå¹½çµçœ¼ç¥â€ã€‚</p>
<p>è¿™å°±åƒè®©ä¸ä¼šç”»ç”»çš„äººé çŒœæƒ³è¡¥å®Œã€Šè’™å¨œä¸½èã€‹çš„å˜´è§’â€”â€”æ³¨å®šè¾£çœ¼ç›ã€‚</p>
<hr/>
<h6 data-id="heading-11">3. ğŸ“ ç®—æ³•é€šç”¨æ€§å·®ï¼šå¯¹ä¸åŒç±»å‹å›¾åƒâ€œä¸€æ‹›é²œåƒä¸éå¤©â€</h6>
<p>ä¼ ç»Ÿå›¾åƒä¼˜åŒ–ç®—æ³•é€šå¸¸æ˜¯<strong>æ‰‹å·¥è°ƒå‚çš„äº§ç‰©</strong>ã€‚<br/>
ä¸åŒå›¾åƒç±»å‹â€”â€”æ¯”å¦‚æ‰«ææ–‡æ¡£ã€äººåƒã€é£æ™¯ã€æ’ç”»â€”â€”æ‰€éœ€çš„æ»¤æ³¢æ ¸æƒé‡å’Œé”åŒ–å¼ºåº¦å®Œå…¨ä¸åŒã€‚</p>
<blockquote>
<p>å·¥ç¨‹å¸ˆå¿ƒå£°ï¼šè°ƒä¸ªå‚æ•°ï¼Œè¦å‘½ä¸‰å°æ—¶ã€‚<br/>
ç»“æœï¼šå¯¹æ–‡æ¡£æ¸…æ™°äº†ï¼Œå¯¹äººè„¸å´©åäº†ã€‚</p>
</blockquote>
<p>ç¼ºä¹ç«¯åˆ°ç«¯ã€è‡ªé€‚åº”æœºåˆ¶ï¼Œæ˜¯ä¼ ç»Ÿæ–¹æ³•åœ¨å¤šåœºæ™¯é€‚é…ä¸Šæœ€è‡´å‘½çš„çŸ­æ¿ã€‚</p>
<hr/>
<h6 data-id="heading-12">4. ğŸ“¶ è®¡ç®—æ•ˆç‡ä¸å¯æ‰©å±•æ€§</h6>
<p>å¾ˆå¤šä¼ ç»Ÿç®—æ³•ï¼ˆç‰¹åˆ«æ˜¯åŸºäºæ•°å­¦æœ€ä¼˜åŒ–çš„ï¼‰å¯¹èµ„æºè¦æ±‚é«˜ã€å¹¶è¡Œæ€§å·®ã€‚<br/>
ä¾‹å¦‚ï¼š</p>
<ul>
<li>å·ç§¯æ ¸åƒç´ çº§æ‰«ææ•ˆç‡ä½ï¼›</li>
<li>å¤šæ­¥è¿­ä»£å¼å»æ¨¡ç³Šç®—æ³•ï¼ˆå¦‚Richardson-Lucyåå·ç§¯ï¼‰è€—æ—¶é•¿ï¼›</li>
<li>ä¸€æ—¦æ¢æ›´é«˜åˆ†è¾¨ç‡å›¾åƒï¼Œå¤„ç†æ—¶é—´æˆå€æš´æ¶¨ã€‚</li>
</ul>
<p>åœ¨Webç¯å¢ƒä¸‹ï¼Œè¿™ç§â€œCPUé£æ‰‡ç‹‚è½¬ï¼Œæµè§ˆå™¨éƒ½å“è·ªâ€çš„æƒ…å†µéå¸¸å¸¸è§ã€‚<br/>
è€Œç°ä»£AIGCæ¨¡å‹ï¼ˆå¦‚CodeFormerï¼‰å¯ä»¥ç”¨GPUå’Œæ™ºèƒ½æ‰¹å¤„ç†ï¼Œæå¤§ç¼“è§£äº†è¿™ä¸€é—®é¢˜ã€‚</p>
<hr/>
<h6 data-id="heading-13">5. ğŸ§© å¤šæ¨¡æ€æ•°æ®é€‚é…æ€§å·®ï¼šæ— æ³•å…¼å®¹æ–°å¼æ•°æ®æ¥æº</h6>
<p>éšç€AIGCã€Web3Dã€æ‰‹æœºRAWæ ¼å¼æ•°æ®çˆ†å‘ï¼Œç°ä»£å›¾åƒçš„æ¥æºå’Œç¼–ç æ–¹å¼è¶Šæ¥è¶Šå¤šæ ·ã€‚<br/>
ä½†ä¼ ç»Ÿä¼˜åŒ–æœåŠ¡å¾€å¾€ï¼š</p>
<ul>
<li>ä»…æ”¯æŒé™æ€2Då›¾åƒï¼›</li>
<li>ä¸ç†è§£æ·±åº¦å›¾ã€æ³•çº¿å›¾ã€é€æ˜é€šé“ï¼›</li>
<li>æ— æ³•ä¸APIæˆ–WebAppå®æ—¶äº¤äº’ã€‚</li>
</ul>
<p>è¿™ä½¿å¾—ä¼ ç»Ÿå›¾åƒä¼˜åŒ–åªèƒ½å……å½“â€œç¦»çº¿å·¥å…·â€ï¼Œéš¾ä»¥åµŒå…¥åˆ°AIGCå·¥ä½œæµæˆ–è‡ªåŠ¨åŒ–å¹³å°ä¸­ã€‚</p>
<hr/>
<h6 data-id="heading-14">6. ğŸ“‰ å¯è§£é‡Šæ€§ä¸è´¨é‡è¯„ä¼°å›°éš¾</h6>
<p>ä¼ ç»Ÿä¼˜åŒ–çš„å¦ä¸€å¤§ç—›ç‚¹æ˜¯â€”â€”æ²¡æœ‰ä¸€å¥—æ ‡å‡†åŒ–çš„<strong>è§†è§‰è´¨é‡è¯„ä»·æœºåˆ¶</strong>ã€‚</p>
<p>æŒ‡æ ‡å¦‚ï¼š</p>
<ul>
<li><strong>PSNRï¼ˆä¿¡å™ªæ¯”ï¼‰</strong> è¿‡äºç†æƒ³åŒ–ï¼›</li>
<li><strong>SSIMï¼ˆç»“æ„ç›¸ä¼¼åº¦ï¼‰</strong> å¿½ç•¥æ„ŸçŸ¥å·®å¼‚ï¼›</li>
<li><strong>äººçœ¼ä¸»è§‚è¯„ä»·</strong> åˆä¸å¯é‡åŒ–ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œå³ä½¿å›¾åƒåœ¨æ•°æ®æŒ‡æ ‡ä¸Šâ€œæ›´æ¸…æ™°â€ï¼Œè‚‰çœ¼çœ‹ä¸Šå»å¯èƒ½åè€Œâ€œæ›´ç³Šâ€ã€‚<br/>
äººçœ¼å’Œæ•°å­¦çš„â€œå®¡ç¾è§‚â€å¸¸å¸¸äº’ç›¸çœ‹ä¸é¡ºçœ¼ã€‚</p>
<hr/>
<h6 data-id="heading-15">ğŸ“š å°ç»“è¡¨æ ¼ï¼ˆç»™ç€æ€¥çš„ä½ ï¼‰</h6>








































<table><thead><tr><th>éš¾ç‚¹</th><th>æŠ€æœ¯ç—‡ç»“</th><th>å…¸å‹åæœ</th></tr></thead><tbody><tr><td>å™ªå£°ä¸é”åŒ–æƒè¡¡</td><td>æ»¤æ³¢ç®—æ³•æ¬ æ™ºèƒ½</td><td>é¢éƒ¨ç»†èŠ‚ä¸¢å¤±ã€ä¼ªå½±</td></tr><tr><td>ç¼ºä¹è¯­ä¹‰ç†è§£</td><td>çº¯åƒç´ è®¡ç®—</td><td>ä¿®å¤å½¢æ€é”™è¯¯</td></tr><tr><td>é€šç”¨æ€§å·®</td><td>æ— è‡ªé€‚åº”å‚æ•°</td><td>å„åœºæ™¯è¡¨ç°ä¸ç¨³</td></tr><tr><td>æ•ˆç‡ç“¶é¢ˆ</td><td>è¿­ä»£ä¼˜åŒ–å¤æ‚</td><td>å“åº”æ…¢ã€æ— æ³•å®æ—¶</td></tr><tr><td>æ¨¡æ€å…¼å®¹å·®</td><td>æ¥å£ä¸æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€</td><td>ä¸Web/Appç”Ÿæ€è„±èŠ‚</td></tr><tr><td>è¯„ä»·æ ‡å‡†ä¸ç»Ÿä¸€</td><td>æ„ŸçŸ¥åº¦éš¾é‡åŒ–</td><td>éš¾ä»¥ç›‘æ§æ•ˆæœ</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-16">ğŸª„ CodeFormerç­‰æ–°ä¸€ä»£æœåŠ¡çš„ä¼˜åŠ¿ç®€è¿°</h4>
<p>åƒ <strong>CodeFormer</strong> è¿™æ ·çš„æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç³»ç»Ÿè§£å†³äº†ä¸Šè¿°ç—›ç‚¹ï¼š</p>
<ul>
<li>âœ… åˆ©ç”¨ Transformer ç»“æ„ç†è§£<strong>å…¨å±€è¯­ä¹‰</strong>ï¼ˆçŸ¥é“é‚£æ˜¯äººè„¸è¿˜æ˜¯èƒŒæ™¯ï¼‰ï¼›</li>
<li>âœ… ç«¯åˆ°ç«¯è®­ç»ƒå¯åŒæ—¶ä¿®å¤ä¸å¢å¼ºï¼›</li>
<li>âœ… æ”¯æŒ <strong>WebUIå¯è§†åŒ– + APIæœåŠ¡åŒ–é›†æˆ</strong>ï¼›</li>
<li>âœ… é«˜å¹¶å‘ GPU æ¨ç†ï¼Œå¤„ç†æ•ˆç‡æå‡æ•°åå€ï¼›</li>
<li>âœ… å¯è‡ªåŠ¨æ ¹æ®å›¾åƒå†…å®¹è°ƒèŠ‚ä¿®å¤ä¸é”åŒ–ç¨‹åº¦â€”â€”é›¶å‚æ•°æš´åŠ›è°ƒè¯•ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-17">å®ç°æµç¨‹</h4>
<h6 data-id="heading-18">1ã€æ‰“å¼€å…±ç»©ç®—åŠ›-å¼¹æ€§éƒ¨ç½²æœåŠ¡</h6>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5706e801681a49f5bf59f05328ccfdea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVvbkdhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605468&amp;x-signature=5wLDIWLaTVVP%2FPWDAVbfO4Zl%2FI0%3D" alt="image.png" loading="lazy"/></p>
<h6 data-id="heading-19">2ã€ä¸‹æ»‘æ‰¾åˆ°æœåŠ¡é¡¹ã€å¹¶æ»‘åŠ¨åˆ°åº•éƒ¨éƒ¨ç½²æœåŠ¡</h6>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b43abb53eb34020a90be0968f605671~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVvbkdhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605468&amp;x-signature=Tw3cTOyZpCzRfbvlyT9guJqz4%2BY%3D" alt="image.png" loading="lazy"/></p>
<h6 data-id="heading-20">3ã€ç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œè®¿é—®éƒ¨ç½²çš„webUiæœåŠ¡ä½“éªŒã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹æ–‡æ¡£ï¼Œé›†æˆapiè°ƒç”¨æ–¹å¼åˆ°é¡¹ç›®ä¸­</h6>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3ea128c39d94005bbba4a78c75d6638~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVvbkdhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605468&amp;x-signature=lfE8dA3BCJFZsqYVJlhxI0HZvYs%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-21">ç»“æœæ¼”ç¤º</h3>
<p>æ•ˆæœæ æ çš„</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34ce33f3f178480aa4dad809bb89d922~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVvbkdhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605468&amp;x-signature=jtBpp7SCIQBYJEKTdVA6CDJUVvI%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-22">ç›¸å…³åˆ†äº«</h2>
<p><a href="https://juejin.cn/post/7569825640852357155" target="_blank" title="https://juejin.cn/post/7569825640852357155">å…±ç»©ç®—åŠ›-çƒ­æ¦œæ•°æ®å®æˆ˜</a><br/>
<a href="https://juejin.cn/post/7570247858869043252" target="_blank" title="https://juejin.cn/post/7570247858869043252">å…±ç»©ç®—åŠ›-æ–‡ç”Ÿå›¾AIæœåŠ¡</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Šæ‹’ç»é‡å¤ä»£ç ï¼æ¨¡æ¿æ¨¡å¼æ•™ä½ ä¼˜é›…å¤ç”¨ç®—æ³•éª¨æ¶ã€‹]]></title>    <link>https://juejin.cn/post/7571648135586103339</link>    <guid>https://juejin.cn/post/7571648135586103339</guid>    <pubDate>2025-11-13T00:34:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571648135586103339" data-draft-id="7571402480966991908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Šæ‹’ç»é‡å¤ä»£ç ï¼æ¨¡æ¿æ¨¡å¼æ•™ä½ ä¼˜é›…å¤ç”¨ç®—æ³•éª¨æ¶ã€‹"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼,åç«¯"/> <meta itemprop="datePublished" content="2025-11-13T00:34:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¨å¤©çš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/563421030396568"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Šæ‹’ç»é‡å¤ä»£ç ï¼æ¨¡æ¿æ¨¡å¼æ•™ä½ ä¼˜é›…å¤ç”¨ç®—æ³•éª¨æ¶ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/563421030396568/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¨å¤©çš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T00:34:56.000Z" title="Thu Nov 13 2025 00:34:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ ä¸‹æ¨¡æ¿æ¨¡å¼ï¼Œä»¥åŠåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨</h2>
<h3 data-id="heading-1">01 æ¨¡æ¿æ¨¡å¼ç®€ä»‹</h3>
<p>æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ“ä½œä¸­çš„<code>ç®—æ³•éª¨æ¶</code>ï¼Œå°†æŸäº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­å®ç°ã€‚æ¨¡æ¿æ¨¡å¼ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•ä¸­çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p>
<blockquote>
<p>ä¸»è¦è§’è‰²</p>
<ul>
<li><strong>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰</strong> ï¼šå®šä¹‰ç®—æ³•éª¨æ¶å’ŒæŠ½è±¡æ“ä½œ</li>
<li><strong>å…·ä½“ç±»ï¼ˆConcrete Classï¼‰</strong> ï¼šå®ç°æŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ“ä½œ</li>
</ul>
</blockquote>
<h3 data-id="heading-2">02 åŸºç¡€ä»£ç å®ç°</h3>
<p>ä»¥æ³¡èŒ¶ä¸ºä¾‹ï¼Œæ•´ä¸ªæµç¨‹å¯ä»¥ç®€åŒ–ä¸ºä¸‰ä¸ªæ­¥éª¤ çƒ§å¼€æ°´ã€æ”¾èŒ¶å¶ã€å€’å…¥å¼€æ°´ï¼Œæˆ‘ä»¬å°†æ”¾èŒ¶å¶å®šä¹‰ä¸ºå¯å˜çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚æœ‰äººå–œæ¬¢ç»¿èŒ¶ã€æœ‰äººå–œæ¬¢çº¢èŒ¶ã€æœ‰äººå–œæ¬¢ç«ç‘°èŠ±èŒ¶ã€‚</p>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæŠ½è±¡æ¨¡æ¿ï¼Œå®šä¹‰æ³¡èŒ¶æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> æ³¡èŒ¶æŠ½è±¡æ¨¡æ¿
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractMakeTeaTemplate</span> {

    <span class="hljs-comment">/**
     * æ³¡èŒ¶
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">makeTea</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. çƒ§å¼€æ°´</span>
        boilWater();
        <span class="hljs-comment">// 2. æ”¾å…¥èŒ¶å¶</span>
        putTea();
        <span class="hljs-comment">// 3. åŠ å…¥æ°´</span>
        addWater();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">boilWater</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çƒ§å¼€æ°´"</span>);
    }

    <span class="hljs-comment">/**
     * æ”¾å…¥èŒ¶å¶
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putTea</span><span class="hljs-params">()</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addWater</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"åŠ å…¥æ°´"</span>);
    }
}
</code></pre>
<p>makeTea() æ–¹æ³•å°±æ˜¯æ³¡èŒ¶æ–¹æ³•ï¼Œçƒ§å¼€æ°´ã€æ·»åŠ å¼€æ°´æ˜¯å¿…éœ€çš„æ­¥éª¤ï¼Œå”¯æœ‰æ”¾å…¥èŒ¶å¶æ˜¯å¯å˜çš„ï¼Œä¸‹é¢æˆ‘ä»¬åˆ†åˆ«å®ç°ä½¿ç”¨ä¸åŒèŒ¶å¶æ³¡èŒ¶çš„ä¸šåŠ¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> ç»¿èŒ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GreenTea</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractMakeTeaTemplate</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putTea</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ”¾å…¥é¾™äº•èŒ¶å¶"</span>);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> çº¢èŒ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedTea</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractMakeTeaTemplate</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putTea</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ”¾å…¥æ™®å°”èŒ¶å¶"</span>);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> ç«ç‘°èŒ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoseTea</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractMakeTeaTemplate</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putTea</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"æ”¾å…¥ç«ç‘°èŠ±èŒ¶å¶"</span>);
    }
}
</code></pre>
<p>ä½¿ç”¨mainæ–¹æ³•æµ‹è¯•ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-comment">// 1. åˆ¶ä½œç»¿èŒ¶</span>
    <span class="hljs-type">AbstractMakeTeaTemplate</span> <span class="hljs-variable">greenTea</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GreenTea</span>();
    greenTea.makeTea();
}
</code></pre>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">çƒ§å¼€æ°´
æ”¾å…¥ç»¿èŒ¶
åŠ å…¥æ°´
</code></pre>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡æ¨¡æ¿æ–¹å¼ï¼Œå°è£…äº†ä¸€ä¸ªæ³¡èŒ¶çš„æµç¨‹ï¼Œä½†å¯¹äºå…¶ä¸­å¯å˜çš„éƒ¨åˆ†æ”¾åˆ°å­ç±»å»å®ç°ã€‚åç»­å¦‚æœæœ‰æ–°ä¸šåŠ¡åˆ°æ¥ï¼Œæ¯”å¦‚è¦æ³¡å…¶ä»–èŒ¶å¶ï¼Œåªéœ€è¦å®ç°æ³¡èŒ¶æ¨¡æ¿ï¼Œé‡å†™èŒ¶å¶ç›¸å…³çš„æ–¹æ³•å³å¯ã€‚</p>
<h3 data-id="heading-3">03 é¡¹ç›®å®æˆ˜</h3>
<p>ä»¥ä¸Šåªæ˜¯ä¸€ä¸ªç®€å•çš„å°demoï¼ŒçœŸå®ä¸šåŠ¡ä¸­å¾ˆå°‘ä¼šæœ‰æ³¡èŒ¶çš„æƒ…å†µã€‚é¡¹ç›®å®æˆ˜ä¸­æˆ‘ä»¬ä»¥æ•°æ®å¯¼å‡ºä¸ºä¾‹ï¼Œçœ‹ä¸‹å¯¼å‡ºæ¨¡æ¿çš„è®¾è®¡å’Œå®ç°ï¼ˆæ•°æ®å¯¼å‡ºå€ŸåŠ©easy-excelå®Œæˆï¼‰ã€‚
é¦–å…ˆå®šä¹‰å¯¼å‡ºæµç¨‹ï¼šå‚æ•°æ ¡éªŒ-ã€‹è¯»å–æ•°æ®-ã€‹å¯¼å‡º-ã€‹å¯¼å‡ºåé€»è¾‘å¤„ç†
<br/></p>
<h4 data-id="heading-4">æŠ½è±¡æ¨¡æ¿ï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> æ•°æ®å¯¼å‡ºæ¨¡æ¿
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractExportTemplate</span>&lt;P, T&gt; {

    <span class="hljs-comment">/**
     * å¯¼å‡ºæ•°æ®
     * &lt;p&gt;å£°æ˜ä¸ºfinalç±»å‹ï¼Œé˜²æ­¢å­ç±»é‡å†™ï¼Œç¡®ä¿å¯¼å‡ºæµç¨‹çš„ä¸€è‡´æ€§&lt;/p&gt;
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">export</span><span class="hljs-params">(BaseExportParam&lt;P&gt; baseExportParam)</span> {
        <span class="hljs-comment">// 1. æ ¡éªŒå‚æ•°</span>
        validateParams(baseExportParam.getParams());
        <span class="hljs-comment">// 2. è¯»å–æ•°æ®</span>
        List&lt;T&gt; data = readData(baseExportParam.getParams());
        <span class="hljs-comment">// 3. å¯¼å‡ºæ•°æ®</span>
        doExport(baseExportParam, data);
        <span class="hljs-comment">// 4. å¯¼å‡ºå®Œæˆåå¤„ç†</span>
        afterExport();
    }

    <span class="hljs-comment">/**
     * è·å–å¯¼å‡ºå®ä½“çš„Classå¯¹è±¡
     * &lt;p&gt;å­ç±»å¿…é¡»å®ç°æ­¤æ–¹æ³•æä¾›å…·ä½“çš„å®ä½“ç±»å‹&lt;/p&gt;
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> Class&lt;T&gt; <span class="hljs-title function_">getEntityClass</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">/**
     * è¯»å–æ•°æ®
     * &lt;p&gt;å£°æ˜ä¸ºabstractç±»å‹ï¼Œå¼ºåˆ¶è¦æ±‚å­ç±»å®ç°ï¼Œç¡®ä¿æ•°æ®è¯»å–çš„ä¸€è‡´æ€§&lt;/p&gt;
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> List&lt;T&gt; <span class="hljs-title function_">readData</span><span class="hljs-params">(P params)</span>;

    <span class="hljs-comment">/**
     * æ ¡éªŒå‚æ•°
     * &lt;p&gt;å­ç±»æ ¹æ®è‡ªèº«ä¸šåŠ¡æƒ…å†µï¼Œçœ‹æ˜¯å¦éœ€è¦è¿›è¡Œå‚æ•°æ ¡éªŒ&lt;/p&gt;
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validateParams</span><span class="hljs-params">(P params)</span> {
    }

    <span class="hljs-comment">/**
     * å¯¼å‡ºæ•°æ®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doExport</span><span class="hljs-params">(BaseExportParam&lt;P&gt; baseExportParam, List&lt;T&gt; data)</span> {
        <span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> baseExportParam.getResponse();
        response.setContentType(<span class="hljs-string">"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"</span>);
        response.setCharacterEncoding(<span class="hljs-string">"utf-8"</span>);
        <span class="hljs-comment">// è¿™é‡ŒURLEncoder.encodeå¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç </span>
        <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> URLEncoder.encode(baseExportParam.getFileName() + <span class="hljs-string">"_"</span> + System.currentTimeMillis(), StandardCharsets.UTF_8);
        response.setHeader(<span class="hljs-string">"Content-disposition"</span>, <span class="hljs-string">"attachment;filename="</span> + fileName + <span class="hljs-string">".xlsx"</span>);

        <span class="hljs-keyword">try</span> {
            EasyExcelFactory.write(response.getOutputStream(), getEntityClass())
                    .sheet(baseExportParam.getFileName())
                    .doWrite(data);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å‡ºæ•°æ®å¤±è´¥"</span>, e);
        }
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterExport</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¯¼å‡ºå®Œæˆåå¤„ç†é€»è¾‘ï¼ˆå¯ç©ºï¼‰</span>
    }
}
</code></pre>
<h4 data-id="heading-5">æ¨¡æ¿å…¥å‚åŸºç±»ï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> å¯¼å‡ºåŸºç±»
 */</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseExportParam</span>&lt;P&gt; {

    <span class="hljs-comment">/**
     * å¯¼å‡ºå‚æ•°
     */</span>
    <span class="hljs-keyword">protected</span> P params;
    <span class="hljs-comment">/**
     * å¯¼å‡ºæ–‡ä»¶å
     */</span>
    <span class="hljs-keyword">protected</span> String fileName;
    <span class="hljs-comment">/**
     * å¯¼å‡ºå“åº”
     */</span>
    <span class="hljs-keyword">protected</span> HttpServletResponse response;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BaseExportParam</span><span class="hljs-params">(P params, String fileName, HttpServletResponse response)</span> {
        <span class="hljs-built_in">this</span>.params = params;
        <span class="hljs-built_in">this</span>.fileName = fileName;
        <span class="hljs-built_in">this</span>.response = response;
    }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å¯¼å‡ºçš„æµç¨‹æ–¹æ³•æ˜¯exportï¼Œé»˜è®¤æ·»åŠ äº†finalä¿®é¥°ï¼Œé˜²æ­¢å­ç±»é‡å†™ä»è€Œæ”¹å˜å¯¼å‡ºæµç¨‹å®šä¹‰ã€‚çœŸæ­£æ‰§è¡Œçš„å¯¼å‡ºçš„æ–¹æ³•æ˜¯doExportã€‚å­ç±»éœ€è¦å®ç°getEntityClassã€readDataæ–¹æ³•ï¼Œå¦å¤–ä¸¤ä¸ªæ–¹æ³•ï¼ˆvalidateParamsã€afterExportï¼‰æ¨¡æ¿ç±»å·²ç»åšäº†é»˜è®¤å®ç°ï¼Œå­ç±»è§†æƒ…å†µé€‰æ‹©æ˜¯å¦å®ç°ã€‚</p>
<h4 data-id="heading-6">ç”¨æˆ·å¯¼å‡º</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> ç”¨æˆ·å¯¼å‡ºæŸ¥è¯¢å‚æ•°
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserQo</span> {
    <span class="hljs-comment">/**
     * ç”¨æˆ·id
     */</span>
    <span class="hljs-keyword">private</span> Long id;
     <span class="hljs-comment">/**
     * ç”¨æˆ·å
     */</span>
    <span class="hljs-keyword">private</span> String name;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> ç”¨æˆ·å¯¼å‡ºVO
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserVo</span> {
    <span class="hljs-meta">@ExcelProperty("ç”¨æˆ·id")</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-meta">@ExcelProperty("ç”¨æˆ·å")</span>
    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-meta">@ExcelProperty("æ‰‹æœºå·")</span>
    <span class="hljs-keyword">private</span> String phone;
}
</code></pre>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">/**
 * @description ç”¨æˆ·å¯¼å‡ºä¸šåŠ¡ç±»
 */</span>
<span class="hljs-meta">@Component</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserExportService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractExportTemplate&lt;UserQo</span>, <span class="hljs-title">UserVo&gt;</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">Class</span>&lt;<span class="hljs-type">UserVo</span>&gt; getEntityClass() {
        <span class="hljs-keyword">return</span> <span class="hljs-type">UserVo</span>.<span class="hljs-keyword">class</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">List</span>&lt;<span class="hljs-type">UserVo</span>&gt; readData(<span class="hljs-type">UserQo</span> params) {
        <span class="hljs-comment">// 1. æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·æ•°æ®</span>
        <span class="hljs-type">UserVo</span> userVo = <span class="hljs-keyword">new</span> <span class="hljs-type">UserVo</span>();
        userVo.setId(params.getId());
        userVo.setUsername(<span class="hljs-string">"zhangsan"</span>);
        userVo.setPhone(<span class="hljs-string">"13800000000"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-type">List</span>.of(userVo);
    }
}
</code></pre>
<p>ç”¨æˆ·å¯¼å‡ºserviceæ·»åŠ äº†@Componentæ³¨è§£ï¼Œæ­£å¸¸æƒ…å†µå¯¼å‡ºæ•°æ®ä»æ•°æ®åº“ä¸­æŸ¥è¯¢è€Œæ¥ï¼Œæ‰€ä»¥çœŸå®ä¸šåŠ¡ä¸­éœ€è¦å°†æ¨¡æ‹Ÿæ•°æ®æ”¹ä¸ºä»æ•°æ®åº“æŸ¥è¯¢å³å¯ã€‚
<br/>
æˆ‘ä»¬å†™ä¸ªæµ‹è¯•ç±»æ¥è¯•ä¸‹:</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/template"</span>)
public class TemplateController {

    <span class="hljs-variable">@Resource</span>
    private UserExportService userExportService;

    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/user"</span>)
    public void <span class="hljs-built_in">export</span>(UserQo params, HttpServletResponse response) {
        <span class="hljs-comment">// 1. å¯¼å‡ºç”¨æˆ·æ•°æ®</span>
        <span class="hljs-selector-tag">userExportService</span><span class="hljs-selector-class">.export</span>(new <span class="hljs-built_in">BaseExportParam</span>(params, <span class="hljs-string">"user-info"</span>, response));
    }
}
</code></pre>
<p>ç»“æœï¼šå¯ä»¥æ­£å¸¸å¯¼å‡ºexcelã€‚
<br/></p>
<blockquote>
<p>å¦‚æœæœ‰æ–°çš„ä¸šåŠ¡ä¹Ÿéœ€è¦å¯¼å‡ºï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°å¯¼å‡ºæ¨¡æ¿å³å¯ï¼Œæ¯”å¦‚åŸå¸‚ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<h4 data-id="heading-7">åŸå¸‚ä¿¡æ¯</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> åŸå¸‚å¯¼å‡ºæŸ¥è¯¢å‚æ•°
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CityQo</span> {
    <span class="hljs-comment">/**
     * åŸå¸‚id
     */</span>
    <span class="hljs-keyword">private</span> Long id;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> åŸå¸‚ä¿¡æ¯å¯¼å‡ºVO
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CityVo</span> {
    <span class="hljs-meta">@ExcelProperty("åŸå¸‚id")</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-meta">@ExcelProperty("åŸå¸‚åç§°")</span>
    <span class="hljs-keyword">private</span> String cityName;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@description</span> åŸå¸‚å¯¼å‡ºä¸šåŠ¡ç±»
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CityExportService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExportTemplate</span>&lt;CityQo, CityVo&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Class&lt;CityVo&gt; <span class="hljs-title function_">getEntityClass</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CityVo.class;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> List&lt;CityVo&gt; <span class="hljs-title function_">readData</span><span class="hljs-params">(CityQo params)</span> {
        <span class="hljs-comment">// 1. æ¨¡æ‹Ÿä»æ•°æ®åº“æŸ¥è¯¢åŸå¸‚æ•°æ®</span>
        <span class="hljs-type">CityVo</span> <span class="hljs-variable">cityVo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CityVo</span>();
        cityVo.setId(params.getId());
        cityVo.setCityName(<span class="hljs-string">"beijing"</span>);
        <span class="hljs-keyword">return</span> List.of(cityVo);
    }
}
</code></pre>
<p>æ–°å¢ä¸€ä¸ªæµ‹è¯•æ–¹æ³•è¯•è¯•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/template")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TemplateController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> UserExportService userExportService;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> CityExportService cityExportService;

    <span class="hljs-meta">@GetMapping("/user")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">export</span><span class="hljs-params">(UserQo params, HttpServletResponse response)</span> {
        <span class="hljs-comment">// 1. å¯¼å‡ºç”¨æˆ·æ•°æ®</span>
        userExportService.export(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BaseExportParam</span>(params, <span class="hljs-string">"user-info"</span>, response));
    }

    <span class="hljs-meta">@GetMapping("/city")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exportCity</span><span class="hljs-params">(CityQo params, HttpServletResponse response)</span> {
        <span class="hljs-comment">// 1. å¯¼å‡ºåŸå¸‚æ•°æ®</span>
        cityExportService.export(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BaseExportParam</span>(params, <span class="hljs-string">"city-info"</span>, response));
    }
}
</code></pre>
<p>å¯¼å‡ºåŠŸèƒ½å®Œå…¨OKğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€</p>
<h3 data-id="heading-8">æ¨¡å¼ä¼˜åŠ¿</h3>
<ol>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼šå°†å…¬å…±ä»£ç æ”¾åœ¨æŠ½è±¡ç±»ä¸­ï¼Œé¿å…ä»£ç é‡å¤</li>
<li><strong>æ‰©å±•æ€§å¥½</strong>ï¼šé€šè¿‡å­ç±»æ‰©å±•æ–°çš„å®ç°ï¼Œç¬¦åˆå¼€é—­åŸåˆ™</li>
<li><strong>ä¾¿äºç»´æŠ¤</strong>ï¼šç®—æ³•ç»“æ„å›ºå®šï¼Œä¿®æ”¹åªéœ€è¦åœ¨ç‰¹å®šä½ç½®è¿›è¡Œ</li>
<li><strong>æ§åˆ¶åè½¬</strong>ï¼šçˆ¶ç±»æ§åˆ¶æ•´ä½“æµç¨‹ï¼Œå­ç±»å®ç°å…·ä½“ç»†èŠ‚</li>
</ol>
<h3 data-id="heading-9">é€‚ç”¨åœºæ™¯</h3>
<ol>
<li>å¤šä¸ªç±»æœ‰ç›¸åŒçš„æ–¹æ³•ï¼Œä½†å…·ä½“å®ç°ä¸åŒ</li>
<li>éœ€è¦æ§åˆ¶å­ç±»çš„æ‰©å±•ï¼Œåªå…è®¸æ‰©å±•ç‰¹å®šæ­¥éª¤</li>
<li>é‡è¦å¤æ‚çš„ç®—æ³•ï¼Œéœ€è¦åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤</li>
<li>æ¡†æ¶è®¾è®¡ï¼Œå®šä¹‰æµç¨‹éª¨æ¶ï¼Œè®©ç”¨æˆ·å®ç°å…·ä½“æ­¥éª¤</li>
</ol>
<h3 data-id="heading-10">æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>æ¨¡æ¿æ–¹æ³•åº”è¯¥å£°æ˜ä¸ºfinalï¼Œé˜²æ­¢å­ç±»é‡å†™ç®—æ³•éª¨æ¶</li>
<li>åˆç†ä½¿ç”¨é’©å­æ–¹æ³•ï¼Œæä¾›çµæ´»çš„æ‰©å±•ç‚¹</li>
<li>é¿å…è¿‡å¤šçš„æŠ½è±¡æ–¹æ³•ï¼Œä¼šå¢åŠ å­ç±»çš„å®ç°è´Ÿæ‹…</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„æšä¸¾]]></title>    <link>https://juejin.cn/post/7571729676343918655</link>    <guid>https://juejin.cn/post/7571729676343918655</guid>    <pubDate>2025-11-13T02:08:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571729676343918655" data-draft-id="7571729682679513138" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„æšä¸¾"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-11-13T02:08:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç…¤çƒç‹å­"/> <meta itemprop="url" content="https://juejin.cn/user/4088439235949739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦è€Œæ—¶ä¹ ä¹‹ï¼šC++ä¸­çš„æšä¸¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4088439235949739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç…¤çƒç‹å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:08:02.000Z" title="Thu Nov 13 2025 02:08:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>C++ ä¸­çš„æšä¸¾</strong></h2>
<p>åœ¨ C++ ä¸­ï¼Œæšä¸¾æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå®ƒç”±ä¸€ç»„å‘½åçš„æ•´å‹å¸¸é‡ç»„æˆã€‚</p>
<p>å®ƒæœ‰åŠ©äºä¸ºæ•´æ•°å€¼èµ‹äºˆæœ‰æ„ä¹‰çš„åç§°ï¼Œä»è€Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯èƒ½å€¼æ•°é‡è¾ƒå°‘çš„é›†åˆï¼ˆä¾‹å¦‚æ–¹å‘ã€æ˜ŸæœŸå‡ ç­‰ï¼‰æ—¶ï¼Œå®ƒå°¤å…¶æœ‰ç”¨ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-comment">// å®šä¹‰æšä¸¾</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">direction</span>
{
    EAST,  <span class="hljs-comment">// ä¸œ</span>
    NORTH, <span class="hljs-comment">// åŒ—</span>
    WEST,  <span class="hljs-comment">// è¥¿</span>
    SOUTH  <span class="hljs-comment">// å—</span>
};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// åˆ›å»ºæšä¸¾å˜é‡</span>
    direction dir = NORTH;

    cout &lt;&lt; dir;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<pre><code class="hljs">1
</code></pre>
<h3 data-id="heading-1">1.åˆ›å»ºæšä¸¾ç±»å‹</h3>
<p>åœ¨åˆ›å»ºæšä¸¾ç±»å‹çš„å˜é‡ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆå®šä¹‰è¿™ä¸ªæšä¸¾ç±»å‹ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">enum_name</span> { 
    name1, name2, name3, ... 
};
</code></pre>
<p>å…¶ä¸­ <code>name1</code>ã€<code>name2</code>ã€â€¦ æ˜¯å‘½åå¸¸é‡ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚<br/>
é»˜è®¤æƒ…å†µä¸‹ï¼Œæšä¸¾ä¸­çš„ç¬¬ä¸€ä¸ªåç§°è¢«èµ‹äºˆæ•´æ•°å€¼ 0ï¼Œåé¢çš„åç§°ä¾æ¬¡é€’å¢ 1ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºè¯¥æšä¸¾ç±»å‹çš„å˜é‡ï¼Œå¹¶æŠŠæšä¸¾ä¸­å®šä¹‰çš„æŸä¸ªå‘½åå¸¸é‡èµ‹ç»™å®ƒï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">enum_name var;
</code></pre>
<h3 data-id="heading-2">2.ä¿®æ”¹å‘½åå¸¸é‡çš„å€¼</h3>
<p>å¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç»™æšä¸¾æˆå‘˜èµ‹å€¼ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">enum_name</span> { 
    name1 = val1, name2 = val2, name3, ... 
};
</code></pre>
<p><code>val1</code>ã€<code>val2</code> â€¦ å¿…é¡»æ˜¯æ•´æ•°ã€‚<br/>
ä¸éœ€è¦ç»™æ‰€æœ‰å‘½åå¸¸é‡éƒ½æŒ‡å®šå€¼ï¼›å¦‚æœå½“å‰å‘½åå¸¸é‡çš„å€¼æ˜¯ xï¼Œé‚£ä¹ˆåç»­çš„å€¼ä¼šä¾æ¬¡é€’å¢ 1ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-comment">// å®šä¹‰æšä¸¾</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">fruit</span>
{
    APPLE,      <span class="hljs-comment">// é»˜è®¤ 0</span>
    BANANA = <span class="hljs-number">5</span>, <span class="hljs-comment">// æ‰‹åŠ¨è®¾ä¸º 5</span>
    ORANGE      <span class="hljs-comment">// è‡ªåŠ¨ä¸º 6</span>
};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// åˆ›å»ºæšä¸¾å˜é‡</span>
    fruit f = BANANA;
    cout &lt;&lt; f &lt;&lt; endl;  <span class="hljs-comment">// è¾“å‡º 5</span>

    <span class="hljs-comment">// æ”¹å˜å€¼</span>
    f = ORANGE;
    cout &lt;&lt; f;          <span class="hljs-comment">// è¾“å‡º 6</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<pre><code class="hljs">5
6
</code></pre>
<p>æšä¸¾ç±»ï¼ˆEnum Classesï¼‰<br/>
C++11 å¼•å…¥äº† <strong>enum class</strong>ï¼Œæä¾›äº†æ›´å¼ºçš„ç±»å‹å®‰å…¨æ€§ã€‚å®ƒé€šè¿‡ç»™å¸¸é‡åå¢åŠ ä½œç”¨åŸŸæ¥è§£å†³å‘½åå†²çªï¼ŒåŒæ—¶ä¹Ÿè¦æ±‚ <strong>æ‰‹åŠ¨å¼ºåˆ¶ç±»å‹è½¬æ¢</strong> æ‰èƒ½å°†æšä¸¾å€¼è½¬ä¸ºæ•´æ•°ã€‚</p>
<h3 data-id="heading-3">3.åˆ›å»ºæšä¸¾ç±»</h3>
<p>åªéœ€åœ¨æ™®é€š enum å£°æ˜å‰åŠ ä¸Šå…³é”®å­— <strong>class</strong> å³å¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">enum class</span> <span class="hljs-title class_">Day</span>
{
    Sunday = <span class="hljs-number">1</span>,
    Monday,
    Tuesday,
    Wednesday,
    Thursday,
    Friday,
    Saturday
};
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-comment">// å®šä¹‰æšä¸¾ç±»</span>
<span class="hljs-keyword">enum class</span> <span class="hljs-title class_">Day</span>
{
    Sunday = <span class="hljs-number">1</span>,
    Monday,
    Tuesday,
    Wednesday,
    Thursday,
    Friday,
    Saturday
};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    Day today = Day::Thursday;

    <span class="hljs-comment">// æ‰“å°æšä¸¾å€¼ï¼ˆéœ€å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼‰</span>
    cout &lt;&lt; <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>&gt;(today);  <span class="hljs-comment">// è¾“å‡º 5</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>é”™è¯¯ç¤ºä¾‹ï¼š<br/>
å¦‚æœç›´æ¥å†™å¸¸é‡åè€Œä¸åŠ ä½œç”¨åŸŸï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">Day today = Thursday;  <span class="hljs-comment">// âŒ é”™è¯¯</span>
</code></pre>
<p><strong>ç¼–è¯‘é”™è¯¯ä¿¡æ¯ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">main.cpp: <span class="hljs-keyword">In</span> <span class="hljs-keyword">function</span> â€˜<span class="hljs-type">int</span> main()â€™:
main.cpp:<span class="hljs-number">12</span>:<span class="hljs-number">17</span>: error: â€˜Thursdayâ€™ was <span class="hljs-keyword">not</span> declared <span class="hljs-keyword">in</span> this <span class="hljs-keyword">scope</span>; did you mean â€˜<span class="hljs-keyword">Day</span>::Thursdayâ€™?
   <span class="hljs-number">12</span> <span class="hljs-operator">|</span>     <span class="hljs-keyword">Day</span> today <span class="hljs-operator">=</span> Thursday;
      <span class="hljs-operator">|</span>                 <span class="hljs-operator">^</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span>
      <span class="hljs-operator">|</span>                 <span class="hljs-keyword">Day</span>::Thursday
main.cpp:<span class="hljs-number">6</span>:<span class="hljs-number">28</span>: note: â€˜<span class="hljs-keyword">Day</span>::Thursdayâ€™ declared here
    <span class="hljs-number">6</span> <span class="hljs-operator">|</span>                 Wednesday, Thursday, Friday,
      <span class="hljs-operator">|</span>                            <span class="hljs-operator">^</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span><span class="hljs-operator">~</span>
</code></pre>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>enum class</code> å¯ä»¥é¿å…å‘½åå†²çªã€‚</li>
<li>æšä¸¾å€¼å¿…é¡»é€šè¿‡ <code>EnumName::Value</code> çš„å½¢å¼è®¿é—®ã€‚</li>
<li>è½¬æ¢ä¸ºæ•´æ•°æ—¶éœ€è¦ä½¿ç”¨ <code>static_cast&lt;int&gt;(...)</code>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[NocoBase æœ¬å‘¨æ›´æ–°æ±‡æ€»ï¼šä¼˜åŒ–åŠç¼ºé™·ä¿®å¤]]></title>    <link>https://juejin.cn/post/7571726099689685011</link>    <guid>https://juejin.cn/post/7571726099689685011</guid>    <pubDate>2025-11-13T03:18:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571726099689685011" data-draft-id="7571726099689668627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="NocoBase æœ¬å‘¨æ›´æ–°æ±‡æ€»ï¼šä¼˜åŒ–åŠç¼ºé™·ä¿®å¤"/> <meta itemprop="keywords" content="å¼€æº,èµ„è®¯,ä½ä»£ç "/> <meta itemprop="datePublished" content="2025-11-13T03:18:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NocoBase"/> <meta itemprop="url" content="https://juejin.cn/user/180779873743566"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            NocoBase æœ¬å‘¨æ›´æ–°æ±‡æ€»ï¼šä¼˜åŒ–åŠç¼ºé™·ä¿®å¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180779873743566/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NocoBase
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:18:07.000Z" title="Thu Nov 13 2025 03:18:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fweekly-updates-20251113" target="_blank" title="https://www.nocobase.com/cn/blog/weekly-updates-20251113" ref="nofollow noopener noreferrer">www.nocobase.com/cn/blog/weeâ€¦</a></p>
<p>æ±‡æ€»ä¸€å‘¨äº§å“æ›´æ–°æ—¥å¿—ï¼Œæœ€æ–°å‘å¸ƒå¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Ftimeline" target="_blank" title="https://www.nocobase.com/cn/blog/timeline" ref="nofollow noopener noreferrer">å‰å¾€æˆ‘ä»¬çš„åšå®¢æŸ¥çœ‹</a>ã€‚</p>
<p><strong>NocoBase ç›®å‰æ›´æ–°åŒ…æ‹¬çš„ç‰ˆæœ¬æ›´æ–°åŒ…æ‹¬ä¸‰ä¸ªåˆ†æ”¯ï¼š<code>main</code> ï¼Œ<code>next</code>å’Œ <code>develop</code>ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed1ee51ad5f644db988e99b36b5e2385~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608687&amp;x-signature=jDFPoduo6kK3yOqpVrkrpABp0%2F8%3D" alt="version.png" loading="lazy"/></p>
<p><code>main</code> ï¼šæˆªæ­¢ç›®å‰æœ€ç¨³å®šçš„ç‰ˆæœ¬ï¼Œæ¨èå®‰è£…æ­¤ç‰ˆæœ¬ã€‚</p>
<p><code>next</code>ï¼šåŒ…å«å³å°†å‘å¸ƒçš„æ–°åŠŸèƒ½ï¼Œç»è¿‡åˆæ­¥æµ‹è¯•çš„ç‰ˆæœ¬ï¼Œå¯èƒ½å­˜åœ¨éƒ¨åˆ†å·²çŸ¥æˆ–æœªçŸ¥é—®é¢˜ã€‚ä¸»è¦é¢å‘æµ‹è¯•ç”¨æˆ·ï¼Œç”¨äºæ”¶é›†åé¦ˆå’Œè¿›ä¸€æ­¥ä¼˜åŒ–åŠŸèƒ½ã€‚é€‚åˆæ„¿æ„æå‰ä½“éªŒæ–°åŠŸèƒ½å¹¶æä¾›åé¦ˆçš„æµ‹è¯•ç”¨æˆ·ã€‚</p>
<p><code>develop</code>ï¼šå¼€å‘ä¸­çš„ç‰ˆæœ¬ï¼ŒåŒ…å«æœ€æ–°çš„åŠŸèƒ½ä»£ç ï¼Œå¯èƒ½å°šæœªå®Œæˆæˆ–å­˜åœ¨è¾ƒå¤šä¸ç¨³å®šå› ç´ ï¼Œä¸»è¦ç”¨äºå†…éƒ¨å¼€å‘å’Œå¿«é€Ÿè¿­ä»£ã€‚é€‚åˆå¯¹äº§å“åŠŸèƒ½å‰æ²¿å‘å±•æ„Ÿå…´è¶£çš„æŠ€æœ¯ç”¨æˆ·ï¼Œä½†å¯èƒ½å­˜åœ¨è¾ƒå¤šé—®é¢˜æˆ–ä¸å®Œæ•´åŠŸèƒ½ï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-0">main</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d633a58f233142449a9998317877ce06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608687&amp;x-signature=pOlyTTwI6OhHH8edoT6dGutlwIo%3D" alt="main.png" loading="lazy"/></p>
<h3 data-id="heading-1"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv1.9.6" target="_blank" title="https://www.nocobase.com/cn/blog/v1.9.6" ref="nofollow noopener noreferrer">v1.9.6</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-12</em></p>
<h3 data-id="heading-2">ğŸ› ä¿®å¤</h3>
<ul>
<li><strong>[client]</strong> ä¿®å¤æ‹–æ‹½å¼•ç”¨æ¨¡æ¿åå†åˆ é™¤å¼•ç”¨æ¨¡æ¿è€Œå¯¼è‡´çš„å¤åˆ¶æ¨¡æ¿ä¸æ˜¾ç¤ºçš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7847" target="_blank" title="https://github.com/nocobase/nocobase/pull/7847" ref="nofollow noopener noreferrer">#7847</a>) by @zhangzhonghe</li>
<li><strong>[utils]</strong> ä¸º intersect ç­–ç•¥å¢åŠ å¯¹è±¡ç±»å‹æ”¯æŒ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7840" target="_blank" title="https://github.com/nocobase/nocobase/pull/7840" ref="nofollow noopener noreferrer">#7840</a>) by @chenos</li>
<li><strong>[æ•°æ®å¯è§†åŒ–ï¼šEChrats]</strong> ä¿®å¤ ECharts é€‰é¡¹é…ç½® labelType ä¸ç”Ÿæ•ˆçš„é—®é¢˜ by @heziqiang</li>
<li><strong>[é‚®ä»¶ç®¡ç†]</strong> æ²¡æœ‰æ—¶é—´æˆ³çš„æƒ…å†µä¸‹åŒæ­¥å¾®è½¯é‚®ä»¶å·²è¯»çŠ¶æ€ by @jiannx</li>
</ul>
<h3 data-id="heading-3"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv1.9.5" target="_blank" title="https://www.nocobase.com/cn/blog/v1.9.5" ref="nofollow noopener noreferrer">v1.9.5</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-10</em></p>
<h3 data-id="heading-4">ğŸ› ä¿®å¤</h3>
<ul>
<li><strong>[å·¥ä½œæµï¼šå®¡æ‰¹]</strong> ä¿®å¤é‡æŸ¥å…³ç³»æ•°æ®æ—¶æœªå±è”½ä¸»è¡¨å­—æ®µçš„é—®é¢˜ by @mytharcher</li>
<li><strong>[é‚®ä»¶ç®¡ç†]</strong> ä¿®å¤ Outlook å†…æ•›å›¾ç‰‡å’ŒåŒæ­¥é—®é¢˜ by @jiannx</li>
</ul>
<h3 data-id="heading-5"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv1.9.4" target="_blank" title="https://www.nocobase.com/cn/blog/v1.9.4" ref="nofollow noopener noreferrer">v1.9.4</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-10</em></p>
<h3 data-id="heading-6">ğŸš€ ä¼˜åŒ–</h3>
<ul>
<li><strong>[æƒé™æ§åˆ¶]</strong> ä¼˜åŒ–å…³ç³»å­—æ®µå…³è”æ“ä½œçš„æƒé™æ§åˆ¶é€»è¾‘ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7800" target="_blank" title="https://github.com/nocobase/nocobase/pull/7800" ref="nofollow noopener noreferrer">#7800</a>) by @2013xile</li>
<li><strong>[å·¥ä½œæµï¼šJavaScript èŠ‚ç‚¹]</strong> ä¿®å¤ä¼ é€’åˆ°æ‰§è¡Œç¯å¢ƒä¸­çš„ä¸Šå±‚å‡½æ•°å¯¼è‡´çš„å®‰å…¨æ¼æ´ï¼Œé¿å…é€šè¿‡åˆ©ç”¨æ¼æ´è®¿é—®ä¸Šå±‚æ‰§è¡Œç¯å¢ƒçš„é—®é¢˜ by @mytharcher</li>
<li><strong>[è®¤è¯ï¼šOIDC]</strong> å¢åŠ è¯·æ±‚è¶…æ—¶æ—¶é—´ by @2013xile</li>
</ul>
<h3 data-id="heading-7">ğŸ› ä¿®å¤</h3>
<ul>
<li>
<p><strong>[server]</strong> ä¿®å¤æ¶ˆæ¯é˜Ÿåˆ—åœ¨å¯ç”¨æœåŠ¡æ‹†åˆ†æ¨¡å¼åï¼Œå·¥ä½œè¿›ç¨‹å‘æ¶ˆæ¯å¯¼è‡´æŠ¥é”™çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7797" target="_blank" title="https://github.com/nocobase/nocobase/pull/7797" ref="nofollow noopener noreferrer">#7797</a>) by @mytharcher</p>
</li>
<li>
<p><strong>[client]</strong> ä¿®å¤è¯¦æƒ…åŒºå—ç®€å•åˆ†é¡µå‡ºç°ç©ºæ•°æ®ä¸‹ä¸€é¡µçš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7784" target="_blank" title="https://github.com/nocobase/nocobase/pull/7784" ref="nofollow noopener noreferrer">#7784</a>) by @katherinehhh</p>
</li>
<li>
<p><strong>[å·¥ä½œæµ]</strong></p>
<ul>
<li>ä¸ºå·¥ä½œæµçš„æ—¥å¿—å¢åŠ  <code>workflowId</code> çš„æ•°æ®æ ‡è¯† (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7789" target="_blank" title="https://github.com/nocobase/nocobase/pull/7789" ref="nofollow noopener noreferrer">#7789</a>) by @mytharcher</li>
<li>ä¿®å¤æœåŠ¡æ‹†åˆ†æ¨¡å¼ä¸‹ï¼Œå·¥ä½œæµæ’ä»¶ä¸å¤„äºæœåŠ¡æ¨¡å¼æ—¶ä»ç„¶æ¶ˆè´¹é˜Ÿåˆ—çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7820" target="_blank" title="https://github.com/nocobase/nocobase/pull/7820" ref="nofollow noopener noreferrer">#7820</a>) by @mytharcher</li>
</ul>
</li>
<li>
<p><strong>[ç”¨æˆ·]</strong> å­—æ®µåä¸º snake_case é£æ ¼æ—¶ï¼Œç´¢å¼•å­—æ®µé‡ç½®ä¸æ­£ç¡®çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7785" target="_blank" title="https://github.com/nocobase/nocobase/pull/7785" ref="nofollow noopener noreferrer">#7785</a>) by @2013xile</p>
</li>
<li>
<p><strong>[å·¥ä½œæµï¼šè‡ªå®šä¹‰å˜é‡èŠ‚ç‚¹]</strong> ä¿®å¤å˜é‡èŠ‚ç‚¹ç¼ºå¤± config æ—¶æŠ¥é”™çš„é—®é¢˜ by @mytharcher</p>
</li>
</ul>
<h2 data-id="heading-8">develop</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74becc056007440b9fc4a4f10a13aad8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTm9jb0Jhc2U=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608687&amp;x-signature=l2JjoXH7jprpdddeRCuOkpQ7H%2BQ%3D" alt="develop.png" loading="lazy"/></p>
<h3 data-id="heading-9"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv2.0.0-alpha.38" target="_blank" title="https://www.nocobase.com/cn/blog/v2.0.0-alpha.38" ref="nofollow noopener noreferrer">v2.0.0-alpha.38</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-12</em></p>
<h3 data-id="heading-10">ğŸ‰ æ–°ç‰¹æ€§</h3>
<ul>
<li><strong>[client]</strong> æ”¯æŒè¡¨æ ¼åˆ—æ“ä½œçš„æ‹–åŠ¨ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7842" target="_blank" title="https://github.com/nocobase/nocobase/pull/7842" ref="nofollow noopener noreferrer">#7842</a>) by @zhangzhonghe</li>
<li><strong>[æ•°æ®å¯è§†åŒ–]</strong> æ–°å¢å›¾è¡¨ SQL æ•°æ®æº (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7830" target="_blank" title="https://github.com/nocobase/nocobase/pull/7830" ref="nofollow noopener noreferrer">#7830</a>) by @heziqiang</li>
</ul>
<h3 data-id="heading-11">ğŸš€ ä¼˜åŒ–</h3>
<ul>
<li><strong>[client]</strong> åœ¨ RunJS è„šæœ¬ä¸Šä¸‹æ–‡ä¸­æ–°å¢å¯¹ Day.js åº“çš„æ”¯æŒï¼Œä¾¿äºè¿›è¡Œæ—¥æœŸå’Œæ—¶é—´çš„æ“ä½œã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7841" target="_blank" title="https://github.com/nocobase/nocobase/pull/7841" ref="nofollow noopener noreferrer">#7841</a>) by @gchust</li>
</ul>
<h3 data-id="heading-12">ğŸ› ä¿®å¤</h3>
<ul>
<li>
<p><strong>[utils]</strong></p>
<ul>
<li>ä¿®å¤ç­›é€‰æŒ‰é’®æŠ¥é”™ â€œInvalid filter item typeâ€  (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7838" target="_blank" title="https://github.com/nocobase/nocobase/pull/7838" ref="nofollow noopener noreferrer">#7838</a>) by @zhangzhonghe</li>
<li>ä¸º intersect ç­–ç•¥å¢åŠ å¯¹è±¡ç±»å‹æ”¯æŒ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7840" target="_blank" title="https://github.com/nocobase/nocobase/pull/7840" ref="nofollow noopener noreferrer">#7840</a>) by @chenos</li>
<li>ä¿®å¤äº‹ä»¶æµæŠ¥ â€œUnrecognized operationâ€ çš„é”™è¯¯ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7835" target="_blank" title="https://github.com/nocobase/nocobase/pull/7835" ref="nofollow noopener noreferrer">#7835</a>) by @zhangzhonghe</li>
</ul>
</li>
<li>
<p><strong>[client]</strong></p>
<ul>
<li>ä¿®å¤äº†è¡¨æ ¼ä¸­è¡Œè®°å½•æ•°æ®æ›´æ–°åï¼Œè¡Œæ“ä½œæŒ‰é’®çš„è”åŠ¨è§„åˆ™æœªé‡æ–°æ‰§è¡Œçš„é—®é¢˜ï¼Œç°åœ¨åœ¨æ•°æ®å˜æ›´æ—¶è”åŠ¨è§„åˆ™èƒ½å¤Ÿæ­£ç¡®é‡æ–°åº”ç”¨ã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7832" target="_blank" title="https://github.com/nocobase/nocobase/pull/7832" ref="nofollow noopener noreferrer">#7832</a>) by @gchust</li>
<li>ä¿®å¤ä»£ç ç¼–è¾‘å™¨ä¸­é¢„è§ˆä»£ç æ—¶å¦‚æœä½¿ç”¨äº† jsx è¯­æ³•ä¼šæŠ¥é”™çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7836" target="_blank" title="https://github.com/nocobase/nocobase/pull/7836" ref="nofollow noopener noreferrer">#7836</a>) by @gchust</li>
</ul>
</li>
<li>
<p><strong>[undefined]</strong> ä¿®å¤æš—é»‘æ¨¡å¼ä¸‹çš„æ’ä»¶æ–‡æ¡£é¦–é¡µæ ·å¼ä¸æ­£ç¡®çš„é—®é¢˜ã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7839" target="_blank" title="https://github.com/nocobase/nocobase/pull/7839" ref="nofollow noopener noreferrer">#7839</a>) by @gchust</p>
</li>
<li>
<p><strong>[æ–‡ä»¶ç®¡ç†å™¨]</strong> ä¿®å¤è¡¨æ ¼åŒºå—é…ç½®å­—æ®µç›¸å…³ç¼ºé™· (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7843" target="_blank" title="https://github.com/nocobase/nocobase/pull/7843" ref="nofollow noopener noreferrer">#7843</a>) by @katherinehhh</p>
</li>
<li>
<p><strong>[AI å‘˜å·¥]</strong> åœ¨ v1 é¡µé¢éšè— AI å‘˜å·¥å¯¹è¯æŒ‰é’® (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7829" target="_blank" title="https://github.com/nocobase/nocobase/pull/7829" ref="nofollow noopener noreferrer">#7829</a>) by @cgyrock</p>
</li>
<li>
<p><strong>[æ•°æ®å¯è§†åŒ–ï¼šEChrats]</strong> ä¿®å¤ ECharts é€‰é¡¹é…ç½® labelType ä¸ç”Ÿæ•ˆçš„é—®é¢˜ by @heziqiang</p>
</li>
<li>
<p><strong>[é‚®ä»¶ç®¡ç†]</strong></p>
<ul>
<li>ä¿®å¤è‰ç¨¿é—®é¢˜ by @jiannx</li>
<li>æ²¡æœ‰æ—¶é—´æˆ³çš„æƒ…å†µä¸‹åŒæ­¥å¾®è½¯é‚®ä»¶å·²è¯»çŠ¶æ€ by @jiannx</li>
</ul>
</li>
</ul>
<h3 data-id="heading-13"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv2.0.0-alpha.37" target="_blank" title="https://www.nocobase.com/cn/blog/v2.0.0-alpha.37" ref="nofollow noopener noreferrer">v2.0.0-alpha.37</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-11</em></p>
<h3 data-id="heading-14">ğŸš€ ä¼˜åŒ–</h3>
<ul>
<li>
<p><strong>[client]</strong></p>
<ul>
<li>æ–°å¢é¡µé¢ç‰ˆæœ¬åˆ° flow engine ä¸Šä¸‹æ–‡é‡Œ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7826" target="_blank" title="https://github.com/nocobase/nocobase/pull/7826" ref="nofollow noopener noreferrer">#7826</a>) by @gchust</li>
<li>ä¼˜åŒ– Markdown ç¼–è¾‘å™¨ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7793" target="_blank" title="https://github.com/nocobase/nocobase/pull/7793" ref="nofollow noopener noreferrer">#7793</a>) by @katherinehhh</li>
<li>2.0 åŒºå—é€‚é… tableoid å­—æ®µ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7809" target="_blank" title="https://github.com/nocobase/nocobase/pull/7809" ref="nofollow noopener noreferrer">#7809</a>) by @katherinehhh</li>
</ul>
</li>
<li>
<p><strong>[æ•°æ®å¯è§†åŒ–]</strong> æ›´æ–°å›¾è¡¨æç¤ºæ å’Œäº‹ä»¶ä»£ç æ¨¡æ¿æ³¨é‡Š (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7814" target="_blank" title="https://github.com/nocobase/nocobase/pull/7814" ref="nofollow noopener noreferrer">#7814</a>) by @heziqiang</p>
</li>
<li>
<p><strong>[æƒé™æ§åˆ¶]</strong> ä¼˜åŒ–å…³ç³»å­—æ®µå…³è”æ“ä½œçš„æƒé™æ§åˆ¶é€»è¾‘ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7800" target="_blank" title="https://github.com/nocobase/nocobase/pull/7800" ref="nofollow noopener noreferrer">#7800</a>) by @2013xile</p>
</li>
<li>
<p><strong>[è®¤è¯ï¼šOIDC]</strong> å¢åŠ è¯·æ±‚è¶…æ—¶æ—¶é—´ by @2013xile</p>
</li>
</ul>
<h3 data-id="heading-15">ğŸ› ä¿®å¤</h3>
<ul>
<li>
<p><strong>[server]</strong> ä¿®å¤æ¶ˆæ¯é˜Ÿåˆ—åœ¨å¯ç”¨æœåŠ¡æ‹†åˆ†æ¨¡å¼åï¼Œå·¥ä½œè¿›ç¨‹å‘æ¶ˆæ¯å¯¼è‡´æŠ¥é”™çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7797" target="_blank" title="https://github.com/nocobase/nocobase/pull/7797" ref="nofollow noopener noreferrer">#7797</a>) by @mytharcher</p>
</li>
<li>
<p><strong>[client]</strong></p>
<ul>
<li>å½“å‰æ•°æ®è¡¨å˜é‡ä¸åº”è¯¥å¯ä»¥ä»ç­›é€‰ç»„ä»¶çš„å˜é‡é€‰æ‹©å™¨ä¸­è¢«é€‰æ‹© (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7818" target="_blank" title="https://github.com/nocobase/nocobase/pull/7818" ref="nofollow noopener noreferrer">#7818</a>) by @gchust</li>
<li>ä¿®å¤ç­›é€‰è¡¨å•å…³ç³»å­—æ®µæŠ¥é”™ â€œvalue.replace is not a functionâ€ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7824" target="_blank" title="https://github.com/nocobase/nocobase/pull/7824" ref="nofollow noopener noreferrer">#7824</a>) by @zhangzhonghe</li>
<li>ä¿®å¤ onChange å›è°ƒä¼ å‚é”™è¯¯ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7807" target="_blank" title="https://github.com/nocobase/nocobase/pull/7807" ref="nofollow noopener noreferrer">#7807</a>) by @zhangzhonghe</li>
</ul>
</li>
<li>
<p><strong>[flow-engine]</strong> ä¿®å¤äº‹ä»¶æµä¿®æ”¹åéœ€è¦åˆ·æ–°é¡µé¢æ‰ä¼šç”Ÿæ•ˆçš„é—®é¢˜ã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7811" target="_blank" title="https://github.com/nocobase/nocobase/pull/7811" ref="nofollow noopener noreferrer">#7811</a>) by @gchust</p>
</li>
<li>
<p><strong>[å·¥ä½œæµ]</strong> ä¿®å¤æœåŠ¡æ‹†åˆ†æ¨¡å¼ä¸‹ï¼Œå·¥ä½œæµæ’ä»¶ä¸å¤„äºæœåŠ¡æ¨¡å¼æ—¶ä»ç„¶æ¶ˆè´¹é˜Ÿåˆ—çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7820" target="_blank" title="https://github.com/nocobase/nocobase/pull/7820" ref="nofollow noopener noreferrer">#7820</a>) by @mytharcher</p>
</li>
<li>
<p><strong>[å·¥ä½œæµï¼šå®¡æ‰¹]</strong> ä¿®å¤é‡æŸ¥å…³ç³»æ•°æ®æ—¶æœªå±è”½ä¸»è¡¨å­—æ®µçš„é—®é¢˜ by @mytharcher</p>
</li>
<li>
<p><strong>[é‚®ä»¶ç®¡ç†]</strong> ä¿®å¤ Outlook å†…æ•›å›¾ç‰‡å’ŒåŒæ­¥é—®é¢˜ by @jiannx</p>
</li>
</ul>
<h3 data-id="heading-16"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv2.0.0-alpha.36" target="_blank" title="https://www.nocobase.com/cn/blog/v2.0.0-alpha.36" ref="nofollow noopener noreferrer">v2.0.0-alpha.36</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-10</em></p>
<h3 data-id="heading-17">ğŸš€ ä¼˜åŒ–</h3>
<ul>
<li><strong>[flow-engine]</strong> ä¼˜åŒ–é¡µé¢æ ‡ç­¾çš„å·¥å…·æ æ ·å¼ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7795" target="_blank" title="https://github.com/nocobase/nocobase/pull/7795" ref="nofollow noopener noreferrer">#7795</a>) by @zhangzhonghe</li>
</ul>
<h3 data-id="heading-18">ğŸ› ä¿®å¤</h3>
<ul>
<li>
<p><strong>[flow-engine]</strong></p>
<ul>
<li>ä¿®å¤äº†å­è¡¨å•å…³ç³»å­—æ®µé€šè¿‡ç”¨æˆ·ç•Œé¢ä¿®æ”¹åï¼Œå…¶å˜é‡æ— æ³•æ­£ç¡®è§£æçš„é—®é¢˜ã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7799" target="_blank" title="https://github.com/nocobase/nocobase/pull/7799" ref="nofollow noopener noreferrer">#7799</a>) by @gchust</li>
<li>å¤šä¸»é”®è®°å½•ç¼–è¾‘è¡¨å•æŠ¥é”™ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7798" target="_blank" title="https://github.com/nocobase/nocobase/pull/7798" ref="nofollow noopener noreferrer">#7798</a>) by @gchust</li>
<li>ä¿®å¤äº†â€œæ‰“å¼€è§†å›¾â€æ“ä½œçš„éƒ¨åˆ†é…ç½®æœªæ­£å¸¸åº”ç”¨çš„é—®é¢˜ï¼Œç°åœ¨æ‰€æœ‰ç›¸å…³é…ç½®å‡èƒ½æŒ‰é¢„æœŸæ­£å¸¸è¿è¡Œã€‚ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7790" target="_blank" title="https://github.com/nocobase/nocobase/pull/7790" ref="nofollow noopener noreferrer">#7790</a>) by @gchust</li>
</ul>
</li>
<li>
<p><strong>[client]</strong></p>
<ul>
<li>ä¿®å¤æ•°æ®è¡¨é€‰æ‹©å™¨å­—æ®µæ— æ³•æ­£ç¡®é€‰æ‹©æ•°æ®çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7794" target="_blank" title="https://github.com/nocobase/nocobase/pull/7794" ref="nofollow noopener noreferrer">#7794</a>) by @katherinehhh</li>
<li>è¡¨æ ¼åŒºå—æ“ä½œåˆ—æ— æ³•è¢«éšè— (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7804" target="_blank" title="https://github.com/nocobase/nocobase/pull/7804" ref="nofollow noopener noreferrer">#7804</a>) by @gchust</li>
<li>æ”¯æŒåœ¨ AI å‘˜å·¥æŒ‡ä»¤é‡Œé€‰æ‹©æ•´ä¸ªå˜é‡å¯¹è±¡ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7791" target="_blank" title="https://github.com/nocobase/nocobase/pull/7791" ref="nofollow noopener noreferrer">#7791</a>) by @gchust</li>
</ul>
</li>
<li>
<p><strong>[ç”¨æˆ·]</strong> å­—æ®µåä¸º snake_case é£æ ¼æ—¶ï¼Œç´¢å¼•å­—æ®µé‡ç½®ä¸æ­£ç¡®çš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7785" target="_blank" title="https://github.com/nocobase/nocobase/pull/7785" ref="nofollow noopener noreferrer">#7785</a>) by @2013xile</p>
</li>
</ul>
<h3 data-id="heading-19"><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nocobase.com%2Fcn%2Fblog%2Fv2.0.0-alpha.35" target="_blank" title="https://www.nocobase.com/cn/blog/v2.0.0-alpha.35" ref="nofollow noopener noreferrer">v2.0.0-alpha.35</a></h3>
<p><em>å‘å¸ƒæ—¶é—´ï¼š2025-11-06</em></p>
<h3 data-id="heading-20">ğŸš€ ä¼˜åŒ–</h3>
<ul>
<li><strong>[flow-engine]</strong> æ”¯æŒå»¶è¿Ÿæ“ä½œ flow model (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7786" target="_blank" title="https://github.com/nocobase/nocobase/pull/7786" ref="nofollow noopener noreferrer">#7786</a>) by @gchust</li>
<li><strong>[å·¥ä½œæµï¼šJavaScript èŠ‚ç‚¹]</strong> ä¿®å¤ä¼ é€’åˆ°æ‰§è¡Œç¯å¢ƒä¸­çš„ä¸Šå±‚å‡½æ•°å¯¼è‡´çš„å®‰å…¨æ¼æ´ï¼Œé¿å…é€šè¿‡åˆ©ç”¨æ¼æ´è®¿é—®ä¸Šå±‚æ‰§è¡Œç¯å¢ƒçš„é—®é¢˜ by @mytharcher</li>
</ul>
<h3 data-id="heading-21">ğŸ› ä¿®å¤</h3>
<ul>
<li>
<p><strong>[client]</strong></p>
<ul>
<li>ä¿®å¤è¯¦æƒ…åŒºå—ç®€å•åˆ†é¡µå‡ºç°ç©ºæ•°æ®ä¸‹ä¸€é¡µçš„é—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7784" target="_blank" title="https://github.com/nocobase/nocobase/pull/7784" ref="nofollow noopener noreferrer">#7784</a>) by @katherinehhh</li>
<li>ä¿®å¤è¡¨æ ¼æ“ä½œåˆ—å’Œ jsColumn åˆ—å®½åº¦è®¾ç½®ä¸ç”Ÿæ•ˆé—®é¢˜ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7777" target="_blank" title="https://github.com/nocobase/nocobase/pull/7777" ref="nofollow noopener noreferrer">#7777</a>) by @katherinehhh</li>
<li>é¡µé¢çš„äº‹ä»¶æµè®¾ç½®é¡µé¢åŒºå—æ•°æ®èŒƒå›´ä¸ç”Ÿæ•ˆ (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7788" target="_blank" title="https://github.com/nocobase/nocobase/pull/7788" ref="nofollow noopener noreferrer">#7788</a>) by @gchust</li>
</ul>
</li>
<li>
<p><strong>[å·¥ä½œæµ]</strong> ä¸ºå·¥ä½œæµçš„æ—¥å¿—å¢åŠ  <code>workflowId</code> çš„æ•°æ®æ ‡è¯† (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnocobase%2Fnocobase%2Fpull%2F7789" target="_blank" title="https://github.com/nocobase/nocobase/pull/7789" ref="nofollow noopener noreferrer">#7789</a>) by @mytharcher</p>
</li>
<li>
<p><strong>[å·¥ä½œæµï¼šè‡ªå®šä¹‰å˜é‡èŠ‚ç‚¹]</strong> ä¿®å¤å˜é‡èŠ‚ç‚¹ç¼ºå¤± config æ—¶æŠ¥é”™çš„é—®é¢˜ by @mytharcher</p>
</li>
<li>
<p><strong>[é‚®ä»¶ç®¡ç†]</strong> MailMessages æ·»åŠ ç´¢å¼• by @jiannx</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GPT-5.1å‘å¸ƒï¼ŒOpenAIå¼€å§‹æ‹¼æƒ…å•†]]></title>    <link>https://juejin.cn/post/7571781196297797641</link>    <guid>https://juejin.cn/post/7571781196297797641</guid>    <pubDate>2025-11-13T03:20:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571781196297797641" data-draft-id="7571829822340055091" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GPT-5.1å‘å¸ƒï¼ŒOpenAIå¼€å§‹æ‹¼æƒ…å•†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,OpenAI"/> <meta itemprop="datePublished" content="2025-11-13T03:20:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœºå™¨ä¹‹å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GPT-5.1å‘å¸ƒï¼ŒOpenAIå¼€å§‹æ‹¼æƒ…å•†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœºå™¨ä¹‹å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:20:54.000Z" title="Thu Nov 13 2025 03:20:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ·±å¤œï¼ŒGPT-5 ç³»åˆ—è¿æ¥å¤§æ›´æ–°ï¼šä¸Šçº¿ GPT-5.1 Instant ä»¥åŠ GPT-5.1 Thinking æ¨¡å‹ï¼š</p>
<ul>
<li>
<p>GPT-5.1 Instantï¼šChatGPT æœ€å¸¸ç”¨çš„æ¨¡å‹ï¼Œæ›´æ¸©æš–ã€æ›´æ™ºèƒ½ï¼Œä¹Ÿæ›´å–„äºéµå¾ªæŒ‡ä»¤çš„æ¨¡å‹ã€‚</p>
</li>
<li>
<p>GPT-5.1 Thinkingï¼šé«˜çº§æ¨ç†æ¨¡å‹ï¼Œåœ¨ç®€å•ä»»åŠ¡ä¸Šæ›´å¿«ï¼Œåœ¨å¤æ‚ä»»åŠ¡ä¸Šæ›´æŒä¹…ï¼Œä¹Ÿæ›´å®¹æ˜“ç†è§£ã€‚</p>
</li>
</ul>
<p>å¯¹äºæ–°ä¸Šçº¿çš„æ¨¡å‹ï¼ŒOpenAI è¡¨ç¤ºå‡ºè‰²çš„ AI ä¸ä»…è¦èªæ˜ï¼Œè¿˜è¦è®©äººä¸ä¹‹å¯¹è¯å˜å¾—æ„‰æ‚¦ã€‚GPT-5.1 åœ¨æ™ºèƒ½å’Œæ²Ÿé€šé£æ ¼ä¸Šéƒ½æœ‰äº†æ˜¾è‘—æå‡ã€‚</p>
<p>Sam Altman è¡¨ç¤ºï¼šè¿™æ˜¯ä¸€æ¬¡ä¸é”™çš„æ¨¡å‹å‡çº§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a74e6e51b1c4edcbf8fba25ffb85911~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=3CUrJ9%2FNMch0FrTfZ6uNRq5biI0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>GPT-5.1 Instant</p>
<p>æ ¹æ®æ—©æœŸæµ‹è¯•ï¼ŒGPT-5.1 Instant å¸¸å¸¸ä»¥ä¿çš®åˆæ¸…æ™°å®ç”¨çš„æ–¹å¼è®©äººæ„Ÿåˆ°æƒŠå–œã€‚</p>
<p>å¯¹äºç›¸åŒçš„é—®é¢˜ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸¤è€…çš„å·®è·ã€‚ä¾‹å¦‚ã€Œæˆ‘æ„Ÿè§‰å‹åŠ›å¾ˆå¤§ï¼Œéœ€è¦ä¸€äº›æ”¾æ¾æŠ€å·§ã€‚ã€</p>
<p>GPT-5 å’ŒÂ GPT-5.1 Instant å›ç­”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d49098c2f6224c3dbe1901f2959e7dc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=LMU%2BkshRufjHSfZooWNPXxaICdQ%3D" alt="Image" loading="lazy"/></p>
<p>æ­¤å¤–ï¼Œæ–°æ¨¡å‹çš„æŒ‡ä»¤æ‰§è¡Œèƒ½åŠ›æ›´å¼ºäº†ï¼Œèƒ½å¤Ÿæ›´å¯é åœ°å›ç­”ç”¨æˆ·é—®é¢˜ã€‚ä¾‹å¦‚å¯¹äºæŒ‡ä»¤è¦æ±‚ï¼šã€Œå§‹ç»ˆç”¨å…­ä¸ªå­—å›å¤ã€ã€‚</p>
<p>GPT-5 å›ç­”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2c556c2f1844e39a6a5dc0bc518ebb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=WRfMUgICPLvmEJVImS1pRy6O4cY%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a557712bf6414596bacee49e6bd8540e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=urc%2F%2Bss1R%2BJeF969wFRM9vcBxDY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>GPT-5.1 Instant å›ç­”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e52b69c7a43f4e139164c3b53f556e2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=B9h8s%2BtTHs3%2BQsQMOzA6OLxRIAI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ­¤å¤–ï¼ŒGPT-5.1 Instant èƒ½å¤Ÿä½¿ç”¨è‡ªé€‚åº”æ¨ç†ï¼Œåœ¨é¢å¯¹æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜æ—¶è‡ªè¡Œå†³å®šæ˜¯å¦éœ€è¦åœ¨å›ç­”å‰è¿›è¡Œæ€è€ƒï¼Œä»è€Œæä¾›æ›´å…¨é¢ã€æ›´å‡†ç¡®çš„ç­”æ¡ˆï¼ŒåŒæ—¶ä¾ç„¶ä¿æŒå¿«é€Ÿå“åº”ã€‚</p>
<p>è¿™ä¸€ç‚¹ä¹Ÿä½“ç°åœ¨æ•°å­¦å’Œç¼–ç¨‹è¯„æµ‹ä¸Šçš„æ˜¾è‘—æå‡ï¼Œä¾‹å¦‚ AIME 2025 å’Œ Codeforcesã€‚</p>
<p>GPTâ€‘5.1 Thinking</p>
<p>ä¸æ­¤åŒæ—¶ï¼ŒOpenAI ä¹Ÿåœ¨å‡çº§ GPT-5 Thinking æ¨¡å¼ï¼Œä½¿å…¶åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­æ›´åŠ é«˜æ•ˆä¸”æ˜“äºç†è§£ã€‚ç°åœ¨ï¼Œå®ƒèƒ½æ›´ç²¾å‡†åœ°æ ¹æ®é—®é¢˜è°ƒæ•´æ€è€ƒæ—¶é—´ â€”â€” åœ¨å¤„ç†å¤æ‚é—®é¢˜æ—¶æŠ•å…¥æ›´å¤šæ—¶é—´ï¼Œè€Œåœ¨å¤„ç†ç®€å•é—®é¢˜æ—¶åˆ™æ›´å¿«å“åº”ã€‚å®é™…åº”ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€å¯¹äºéš¾é¢˜ï¼Œå®ƒèƒ½ç»™å‡ºæ›´è¯¦å°½çš„ç­”æ¡ˆï¼›è€Œå¯¹äºç®€å•é—®é¢˜ï¼Œå®ƒåˆ™èƒ½æ›´å¿«åœ°ç»™å‡ºå“åº”ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae15197bf4c24fc2a91e4e9ff4cdd416~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=uXEUh1ge4WMX7cEYbQUHUbaD0Eo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>GPT-5.1 Thinking çš„å“åº”ä¹Ÿæ›´æ¸…æ™°ï¼Œä½¿ç”¨çš„æœ¯è¯­æ›´å°‘ã€æ›´é€šä¿—ï¼Œå¹¶å‡å°‘äº†æœªå®šä¹‰ä¸“ä¸šè¯æ±‡çš„è¾“å‡ºã€‚è¿™å¯¹å¤„ç†å¤æ‚ä»»åŠ¡æˆ–è§£é‡ŠæŠ€æœ¯æ¦‚å¿µæ—¶å°¤å…¶é‡è¦ã€‚ä¸¾ä¾‹æ¥è¯´ï¼šè§£é‡Š BABIP å’Œ wRC+ã€‚</p>
<p>GPT-5 Thinkingã€GPT-5.1 ThinkingÂ å›ç­”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fab301ce57a8486a94a35530f91f43ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=CnxNT2pcTKcGCbTO2kziIuPFyr4%3D" alt="Image" loading="lazy"/></p>
<p>å®Œæ•´å›ç­”è¯·å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenai.com%2Findex%2Fgpt-5-1%2F" target="_blank" title="https://openai.com/index/gpt-5-1/" ref="nofollow noopener noreferrer">openai.com/index/gpt-5â€¦</a></p>
<p>GPT-5.1 Thinking çš„é»˜è®¤è¯­æ°”ä¹Ÿæ›´åŠ æ¸©æš–å’Œå¯Œæœ‰åŒç†å¿ƒã€‚</p>
<p>å¯ä»¥è¯´ï¼Œæ­¤æ¬¡å‘å¸ƒçš„æ¨¡å‹åœ¨èƒ½åŠ›å’Œå¯ç”¨æ€§ä¸Šéƒ½è¿ˆå‡ºäº†ä¸€å¤§æ­¥ã€‚GPT-5.1 Auto å°†ç»§ç»­æŠŠæ¯ä¸ªè¯·æ±‚è·¯ç”±åˆ°æœ€é€‚åˆçš„æ¨¡å‹ï¼Œå› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹ç”¨æˆ·æ— éœ€æ‰‹åŠ¨é€‰æ‹©æ¨¡å‹ã€‚ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šæ˜æ˜¾æ„Ÿå—åˆ°ï¼ŒGPT-5.1 ç³»åˆ—çš„å›ç­”æ•´ä½“ä¸Šæ›´èªæ˜ï¼Œä¹Ÿæ›´è‡ªç„¶ã€‚</p>
<p>GPT-5.1 Instant å’Œ GPT-5.1 Thinking å°†ä»ä»Šå¤©å¼€å§‹é€æ­¥æ¨å‡ºï¼Œé¦–å…ˆé¢å‘ä»˜è´¹ç”¨æˆ·ï¼ˆProã€Plusã€Goã€Businessï¼‰ï¼Œéšåè¦†ç›–å…è´¹ç”¨æˆ·å’Œæœªç™»å½•ç”¨æˆ·ã€‚Enterprise å’Œ Edu è®¢é˜…å¯ä»¥æå‰ä¸ƒå¤©å¼€å¯æ—©æœŸè®¿é—®å¼€å…³ï¼ˆé»˜è®¤å…³é—­ï¼‰ã€‚åœ¨æ­¤çª—å£æœŸç»“æŸåï¼ŒGPT-5.1 å°†æˆä¸ºå”¯ä¸€çš„é»˜è®¤æ¨¡å‹ã€‚</p>
<p>å¦‚æœä½ ç°åœ¨æ‰“å¼€ ChatGPTï¼Œå·²ç»å¯ä»¥ä½¿ç”¨ GPT-5.1 äº†ã€‚è¿˜æ²¡ä¸Šçº¿çš„å°ä¼™ä¼´ï¼Œå¯ä»¥å†ç­‰ç­‰ï¼Œæ¥ä¸‹æ¥çš„å‡ å¤©å°†é€æ­¥ä¸Šçº¿ã€‚å¾ˆå¿« GPT-5 Pro ä¹Ÿä¼šæ›´æ–°åˆ° GPT-5.1 Proã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c08341332064ee3b9faf21c402479c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=KwB0tUtrLOvWbblxFOeKg2IMepI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦å¤–ï¼Œæœ¬å‘¨æ™šäº›æ—¶å€™ï¼Œ GPT-5.1 Instant å’Œ GPT-5.1 Thinking ä¸¤ä¸ªæ¨¡å‹åœ¨ API ä¸­å¯ç”¨ã€‚GPT-5.1 Instant å°†ä½œä¸º gpt-5.1-chat-latest åŠ å…¥ï¼ŒGPT-5.1 Thinking åˆ™å°†ä½œä¸º GPT-5.1 åœ¨ API ä¸­å‘å¸ƒï¼Œä¸¤è€…éƒ½æ”¯æŒè‡ªé€‚åº”æ¨ç†ã€‚</p>
<p>GPT-5ï¼ˆInstant å’Œ Thinkingï¼‰å°†åœ¨æ¥ä¸‹æ¥çš„ä¸‰ä¸ªæœˆå†…ç»§ç»­é€šè¿‡ ChatGPT ä¸­çš„æ—§ç‰ˆæ¨¡å‹ä¸‹æ‹‰èœå•å‘ä»˜è´¹è®¢é˜…ç”¨æˆ·æä¾›ï¼Œä»¥ä¾¿å¤§å®¶æœ‰è¶³å¤Ÿæ—¶é—´è¿›è¡Œå¯¹æ¯”å’Œé€æ­¥é€‚åº”ã€‚GPT-5 çš„ä¸‹çº¿è¿‡æ¸¡æœŸä¸ä¼šå½±å“å…¶ä»–æ—§ç‰ˆæ¨¡å‹çš„å¯ç”¨æ€§ã€‚</p>
<p>æœªæ¥ï¼Œæ¨å‡ºæ–°çš„ ChatGPT æ¨¡å‹æ—¶ï¼ŒOpenAI éƒ½ä¼šä¸ºç”¨æˆ·é¢„ç•™å……è¶³çš„è¯„ä¼°ç©ºé—´ï¼Œè®©å¤§å®¶äº†è§£å˜åŒ–ã€åˆ†äº«åé¦ˆï¼Œå®ç°å¹³ç¨³è¿‡æ¸¡ã€‚ä¸‹çº¿è¿‡æ¸¡æœŸä¼šæå‰å……åˆ†ã€æ¸…æ™°åœ°è¿›è¡Œæ²Ÿé€šã€‚</p>
<p>å…³äºå‘½åæ–¹å¼çš„è¯´æ˜ï¼šæ­¤æ¬¡æ›´æ–°è¢«ç§°ä¸º GPT-5.1ï¼Œæ˜¯ä¸ºäº†ä½“ç°æœ‰æ„ä¹‰çš„æ”¹è¿›ï¼ŒåŒæ—¶ä»ç„¶å±äº GPT-5 ç³»åˆ—ã€‚æœªæ¥å¯¹ GPT-5 çš„è¿­ä»£å‡çº§å°†éµå¾ªç›¸åŒçš„å‘½åæ¨¡å¼ã€‚</p>
<p>OpenAI è¿˜åŒæ—¶å‘å¸ƒäº† GPT-5.1 Instantã€ GPT-5.1 Thinking ç³»ç»Ÿå¡é™„å½•ã€‚æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ï¼Œå¯ä»¥å‰å»æŸ¥çœ‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35cd403b4daf40ef9349e4068204e916~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763608853&amp;x-signature=xFk6ceek5T4OcPpnKgsZ6Unn%2FlU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.openai.com%2Fpdf%2F4173ec8d-1229-47db-96de-06d87147e07e%2F5_1_system_card.pdf" target="_blank" title="https://cdn.openai.com/pdf/4173ec8d-1229-47db-96de-06d87147e07e/5_1_system_card.pdf" ref="nofollow noopener noreferrer">cdn.openai.com/pdf/4173ec8â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ollama Ã— é­”æ­ç¤¾åŒºï¼šè¶…ç®€å•çš„å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7571731181198245924</link>    <guid>https://juejin.cn/post/7571731181198245924</guid>    <pubDate>2025-11-13T03:35:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571731181198245924" data-draft-id="7571731181198180388" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ollama Ã— é­”æ­ç¤¾åŒºï¼šè¶…ç®€å•çš„å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-13T03:35:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ollama Ã— é­”æ­ç¤¾åŒºï¼šè¶…ç®€å•çš„å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T03:35:56.000Z" title="Thu Nov 13 2025 03:35:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>éšç€å¤§æ¨¡å‹çš„ä¸æ–­å‘å±•ï¼Œå°å‚æ•°æ¨¡å‹çš„èƒ½åŠ›ä¹Ÿåœ¨é€æ¸è¿›æ­¥ï¼Œå°±æ‹¿é˜¿é‡Œæœ€æ–°å¼€æºçš„qwen3æ¥è¯´ï¼Œå…¶ä¸­æœ‰è´Ÿè´£å¤šæ¨¡æ€çš„qwen3-vlç³»åˆ—å’Œä¸“ä¸ºä»£ç ä¼˜åŒ–çš„qwen3-codeç³»åˆ—ç­‰ï¼Œè¿™äº›ä¸åŒä½¿ç”¨åœºæ™¯ä¸­éƒ½æœ‰å¼€æºçš„å°å‚æ•°æ¨¡å‹æ¥æ–¹ä¾¿æˆ‘ä»¬æœ¬åœ°éƒ¨ç½²ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ab16477dfad4076b55d225510cf7c94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=L%2BdoUdz5ne9NX%2FAlOquCX0Z1%2F7s%3D" alt="" loading="lazy"/></p>
<p>é‚£å¼€æºéƒ¨ç½²å°æ¨¡å‹çš„å¥½å¤„æœ‰ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘è®¤ä¸ºè‡³å°‘æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li>æ•°æ®ç§æœ‰åŒ–ï¼šæ•°æ®ä¸å‡ºç½‘ï¼Œé€‚åˆæ”¿ä¼ã€å­¦ä¹ æˆ–åŒ»é™¢ç­‰å¯¹éšç§è¦æ±‚é«˜çš„åœºæ™¯ã€‚</li>
<li>æ— ç½‘ç»œä¾èµ–ï¼šç¦»çº¿å³å¯ä½¿ç”¨ï¼Œä¸ä¾èµ–ç½‘ç»œã€‚</li>
<li>æˆæœ¬å¤§å¹…ä¸‹é™ï¼šæœ¬åœ°æ¨ç†æˆæœ¬é™åˆ°æœ€ä½ï¼ˆç”µè´¹ï¼‰ï¼Œæ¯”è°ƒç”¨å¤§æ¨¡å‹apiè¦çœé’±å¤ªå¤šäº†ã€‚</li>
<li>å¾®è°ƒé—¨æ§›ä½ï¼šå°æ¨¡å‹æ¯”èµ·å¤§æ¨¡å‹æ‰€éœ€çš„åºå¤§çš„èµ„æºæ¥è¯´æ›´é€‚åˆå¾®è°ƒï¼Œå°æ¨¡å‹å¾®è°ƒä¹‹ååœ¨ç‰¹å®šé¢†åŸŸçš„èƒ½åŠ›å¯ä»¥åª²ç¾ç”šè‡³è¶…è¿‡å¤§æ¨¡å‹ã€‚ï¼ˆå¾®è°ƒå¯ä»¥ç†è§£ä¸ºï¼šç”¨å•ç‹¬é¢†åŸŸçš„æ•°æ®é›†å¯¹æ¨¡å‹å†æ¬¡è®­ç»ƒä½¿å…¶ä¸“ä¸šåŒ–ï¼‰</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79eb18cac2ae48b28356098d46ee7481~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=b8lqhh5r4QGtVz%2FYC5eP5D1vhLc%3D" alt="" loading="lazy"/></p>
<p>åœ¨åº”ç”¨è½åœ°æ–¹é¢ï¼Œæ¯”å¦‚ä¸€äº›agentåº”ç”¨çš„è½åœ°ï¼Œæ›´ç¦»ä¸å¼€æœ¬åœ°æ¨¡å‹çš„éƒ¨ç½²ï¼Œé‚£è¯´äº†è¿™ä¹ˆå¤šï¼Œå¦‚ä½•æ­£ç¡®çš„æœ¬åœ°éƒ¨ç½²ä¸€ä¸ªå¤§æ¨¡å‹å‘¢ï¼Ÿè¿™é‡Œåªæ¨èä¸¤ç§æ–¹æ³•ï¼Œè¿™ä¸¤ç§æ–¹æ³•ä¹Ÿæ˜¯å½“ä¸‹æ¯”è¾ƒæ­£ç¡®å’Œå¸¸ç”¨çš„ã€‚</p>
<ol>
<li>é€šè¿‡Ollamaå·¥å…·å¿«æ·éƒ¨ç½²</li>
<li>é€šè¿‡vLLMé«˜æ€§èƒ½æ¨ç†æ¡†æ¶éƒ¨ç½²</li>
</ol>
<p>æœ¬ç¯‡æ–‡ç« å…ˆè®²é€šè¿‡ollamaéƒ¨ç½²æœ¬åœ°æ¨¡å‹çš„æ–¹æ³•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7e1519d30e643febafef874f58a1110~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=8bZ09%2BIswxsHzwxvJA50KQvSc%2FE%3D" alt="" loading="lazy"/></p>
<p>é‚£åœ¨æœ¬åœ°éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆæ˜ç™½å½“å‰çš„ç”µè„‘é…ç½®èƒ½å¤Ÿè¿è¡Œä»€ä¹ˆå‚æ•°çš„æ¨¡å‹ï¼Œä¸ç„¶æˆ‘ä»¬è¾›è¾›è‹¦è‹¦ä¸‹è½½äº†å‡ åGçš„æ¨¡å‹æ–‡ä»¶åï¼Œå‘ç°æ ¹æœ¬è·‘ä¸åŠ¨å°±å°´å°¬äº†ã€‚</p>
<p>è¿™é‡Œç»™å¤§å®¶ä¸€ä¸ªå¯ä»¥å¿«é€Ÿä¼°ç®—çš„å…¬å¼ï¼ˆæœ€å¥½è‡ªå·±ç”µè„‘æ˜¾å­˜æ¯”è¿™ä¸ªç»“æœå¤šä¸€äº›ï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ad9ab2c297443f58e8af157f9bb20ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=IQdn%2FcRDuaqlfaAyP3cHjnIQEzc%3D" alt="" loading="lazy"/></p>
<p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ¨¡å‹ï¼Œéƒ¨ç½²å®ƒå¤§æ¦‚éœ€è¦çš„æ˜¾å­˜çš„è®¡ç®—é€»è¾‘ä¸ºï¼š(8x8)/ 8x1.2=9.6Gï¼Œä¹Ÿå°±æ˜¯3060 12Gæ˜¾å¡å°±å¯ä»¥è·‘ï¼Œè€Œä¸”è¿™ä¸ªå¤šæ¨¡æ€çš„å°æ¨¡å‹èƒ½åŠ›ä¹Ÿæ˜¯ç›¸å½“ä¸é”™ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/602e214002514f38b08c8dc9d4780b8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=AED5jwbdlxYcAx8ae2DfddCz14k%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªæ¦‚å¿µï¼š1.æ¨¡å‹å‚æ•°é‡ 2.å‚æ•°ä½å®½ã€‚è¿™ä¿©ä¸ªæ¦‚å¿µå¯¹äºæœ¬åœ°éƒ¨ç½²æ¨¡å‹æ¥è¯´æå…¶çš„é‡è¦ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æœ‰å¿…è¦è¯´ä¸€ä¸‹ã€‚</p>
<p>è¯´ä¹‹å‰å¤§å®¶è¦å…ˆäº†è§£ä¸€ä¸‹é­”æ­ç¤¾åŒºï¼Œé­”æ­ç¤¾åŒºæ˜¯é˜¿é‡Œäº‘çš„ä¸€ä¸ªå¼€æºæ¨¡å‹å¸‚åœºï¼Œé‡Œé¢æœ‰å„ç§å¯ä¸‹è½½çš„é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä»¥åŠæ•°æ®é›†ç­‰ï¼Œå°±åƒæ˜¯ä¸­å›½ç‰ˆçš„Hugging Faceã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7774a8e64e84a09b6f46c978287559d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=FrHR8J8%2FVGuQ9389Ah2hTPS4h4o%3D" alt="" loading="lazy"/></p>
<p>é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.modelscope.cn%2Fhome" target="_blank" title="https://www.modelscope.cn/home" ref="nofollow noopener noreferrer">www.modelscope.cn/home</a></p>
<p>æˆ‘ä»¬å¯ä»¥æ‰“å¼€å›½å†…çš„æ¨¡å‹å¸‚åœºâ€”â€”é­”æ­ç¤¾åŒºï¼Œç„¶åæœç´¢qwen3ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b92143485014f90898e12ba090ad02b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=Q9rl5gVYAkurubrau1%2F8kJ2t85I%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™äº›éƒ½æœ‰ä¸€ä¸ªxxBçš„ç›¸å…³å­—æ ·ï¼Œæ¯”å¦‚30Bã€8Bã€235Bè¿™äº›å­—æ ·ï¼Œè¿™äº›å°±æ˜¯æŒ‡å¾—å‚æ•°é‡ï¼Œå‚æ•°é‡è¶Šå¤§å°±ä»£è¡¨å…¶æŒæ¡çš„çŸ¥è¯†è¶Šå¤šï¼ŒåŒæ—¶éœ€è¦çš„æ˜¾å­˜è¶Šå¤§ï¼å°±æ¯”å¦‚å›¾ç‰‡ä¸Šé‚£ä¸ª235Bçš„æ¨¡å‹éœ€è¦çš„æ˜¾å­˜æ˜¯500å¤šGã€‚è¿™ä¹ˆå¤§çš„æ˜¾å­˜ï¼Œéƒ¨ç½²æˆæœ¬æ˜¯ç›¸å½“å¤§çš„ã€‚</p>
<p>æˆ‘ä»¬ç‚¹è¿›å»ä¸€ä¸ªé€šä¹‰åƒé—®3-32Bçš„æ¨¡å‹ä¸­ï¼Œåœ¨å³ä¾§éƒ¨åˆ†å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ¨¡å‹çš„ç³»è°±ï¼Œå…¶ä¸­å¯ä»¥æ‰¾åˆ°é‡åŒ–è¿™ä¸€ä¸ªåˆ†ç±»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c039d672e1ef49d2861a34d6c18f09b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=kdRnODMWAlzliCzEQxNVQjfn098%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡»è¿™ä¸ªåˆ†ç±»ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ¨¡å‹çš„é‡åŒ–ç‰ˆæœ¬ï¼Œæ‰€è°“é‡åŒ–å…¶å®å°±æ˜¯æŒ‡çš„æ˜¯è®©æ¨¡å‹å°½é‡ä¸å˜ç¬¨çš„æƒ…å†µä¸‹ï¼ŒèŠ‚çœéƒ¨ç½²æ˜¾å­˜ã€‚æ¯”å¦‚åˆšåˆšè¯´çš„235Bçš„æ¨¡å‹ç»è¿‡4bité‡åŒ–åï¼Œéœ€è¦çš„æ˜¾å­˜å°±ä»500Gé™ä¸ºäº†150Gå·¦å³ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2312b420fd0048e697856c868f5f4b7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=9EjDCAuU8m3JM%2FII9cSqHShFuKM%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡ä¸Šå›¾åœˆèµ·æ¥çš„éƒ¨åˆ†ï¼Œå¯ä»¥çœ‹åˆ°32Bå‚æ•°çš„qwen3æ–‡æœ¬å¯¹è¯æ¨¡å‹çš„åç§°ä¸­åŒ…å«ï¼ŒAWQã€FP8ã€GGUFã€GPTQï¼Œè¿™äº›æ¨¡å‹æ ‡è¯†ï¼Œå¯¹åº”çš„å«ä¹‰å¤§å®¶å¯ä»¥çœ‹ä¸‹é¢è¿™å¹…å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68709261c2794c5da54e92e835d43dc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=Ei4SclizIVq2cqS%2BRBC234TaYKQ%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­AWQæ˜¯é˜¿é‡Œæœ€æ¨èçš„é‡åŒ–æ–¹æ³•ï¼Œä½ å¯ä»¥çœ‹åˆ°AWQé‡åŒ–åçš„æ¨¡å‹ä¸‹è½½é‡ä¸€èˆ¬éƒ½æ˜¯æœ€å¤šçš„ï¼Œè€ŒGGUFçš„æ¨¡å‹æ ¼å¼åˆ™æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®²çš„ollamaä¸»è¦æ”¯æŒçš„æ¨¡å‹æ ¼å¼ã€‚è¿™é‡Œè¦æ³¨æ„ollamaä¸»è¦æ”¯æŒçš„æ˜¯ggufæ ¼å¼ï¼Œè€Œvllmå¯ä»¥æ”¯æŒç»å¤§å¤šæ•°çš„æ¨¡å‹æ ¼å¼ï¼Œæ‰€ä»¥ä¼ä¸šåº”ç”¨ä¸­å¤§éƒ½æ˜¯ä½¿ç”¨vllméƒ¨ç½²æ¨¡å‹è€Œollamaå¤šç”¨äºä¸ªäººåº”ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43ed6d91d33043f0a8f36e23eb785bf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=oKsfMUkTbvWOw4UPEgdPtfZw2LQ%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢è¿™äº›å‚æ•°å°±ä»£è¡¨äº†æ¨¡å‹ çš„ä½å®½ï¼Œæ¯”å¦‚FP8å°±æ˜¯8bitçš„ï¼ŒGPTQ-Int4å°±æ˜¯4bitçš„ï¼ŒåŒç†GPTQ-Int8ä¹Ÿæ˜¯8bitçš„ï¼ŒINT4å°±æ˜¯4bitçš„ã€‚é»˜è®¤çš„AWQå’ŒGGUFæ–¹æ³•åˆ™æ˜¯4bitçš„ä½å®½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/847b21166dda44beba285e43e5626abf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=hs79XWoHyU49ebzaoFIOD8MvO2E%3D" alt="" loading="lazy"/></p>
<p>å¯èƒ½ç¬¬ä¸€æ—¶é—´æœ‰ç‚¹ä¸å¥½ç†è§£æ‰€ä»¥ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ï¼Œæ˜¾å­˜èµ„æºæœ‰é™æƒ…å†µä¸‹ï¼Œä¸€èˆ¬vLLMæ¡†æ¶æ¥è¯´ä½¿ç”¨AWQé‡åŒ–åå³å¯ï¼Œä½†å¦‚æœä½ è¦ä½¿ç”¨ollamaå°±ç”¨GGUFæ ¼å¼çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46ba4a51651e4600966510151a055b98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=x8BbH7VnosVnZv%2FeT8SmpQ9SDPI%3D" alt="" loading="lazy"/></p>
<p>è¿™æ—¶å€™å¤§å®¶æ ¹æ®ä¸Šé¢çš„å…¬å¼å†æ¬¡ä¼°ç®—ä¸€æ¬¡ä¸‹é¢çš„æ¨¡å‹éœ€è¦çš„ç°å­˜æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa715bd87f8746378acf7edf1d8f885d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=0Ysb1cjiBDGCYpTGMdvLKd29gwU%3D" alt="" loading="lazy"/></p>
<p>æ¨¡å‹çš„å‚æ•°æ˜¯8Bï¼Œæ‰€ä»¥På°±æ˜¯8ï¼ŒGGUFé»˜è®¤ollamaæ‹‰å–çš„æ˜¯4bité‡åŒ–çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥Qå°±æ˜¯4ï¼Œé‚£ä¹ˆæœ€åçš„æ˜¾å­˜æ‰€éœ€å¤§æ¦‚å°±æ˜¯4.8Gã€‚</p>
<p><strong>ollamaéƒ¨ç½²æ•™ç¨‹</strong></p>
<p>æˆ‘ä»¬æ‹¿è£…æœ‰Nå¡çš„windowsæ¥ä¸¾ä¾‹å­ï¼Œmacå’Œlinuxçš„å®‰è£…æ–¹æ³•éƒ½å·®ä¸å¤šï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹å®˜ç½‘ï¼Œollamaçš„å®˜ç½‘å¦‚ä¸‹ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2Fdownload" target="_blank" title="https://ollama.com/download" ref="nofollow noopener noreferrer">ollama.com/download</a></p>
<p>å®‰è£…ollamaä¹‹å‰ä½ éœ€è¦ç¡®ä¿ä½ çš„Nå¡æœ‰è‹±ä¼Ÿè¾¾çš„cudaé©±åŠ¨ï¼Œå¯ä»¥è¿è¡Œï¼šnvidia-smi æ¥æŸ¥çœ‹æ˜¯å¦æœ‰ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb1c43d606494527b75167acd3ab6b68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=GZYW0GLpQK1t9Ld6E0oSKLVzZFY%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœæ²¡æœ‰çš„è¯éœ€è¦åˆ°å®˜æ–¹ä¸‹è½½æœ€æ–°çš„æ˜¾å¡é©±åŠ¨ï¼Œæ²¡æœ‰gpuä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºollamaå¯ä»¥å°†æ¨¡å‹æ¨ç†æ”¾åœ¨cpuä¸Šã€‚é©±åŠ¨ä¸‹è½½åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nvidia.cn%2Fsoftware%2Fnvidia-app%2F" target="_blank" title="https://www.nvidia.cn/software/nvidia-app/" ref="nofollow noopener noreferrer">www.nvidia.cn/software/nvâ€¦</a></p>
<p>éšåæ‰“å¼€ollamaå®˜ç½‘åï¼Œæ‰¾åˆ°ä½ è¦çš„ç‰ˆæœ¬ç‚¹å‡»ä¸‹è½½å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ede79afd721245d2bb9e34158b7cab3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=65vic8PqaofbN3XdxeSkUkqgC3s%3D" alt="" loading="lazy"/></p>
<p>ä½ éœ€è¦åœ¨Cç›˜ç•™è¶³å¤Ÿçš„ç©ºé—´Â å› ä¸ºollamaä¸‹è½½åæ˜¯å¿…é¡»è¦å®‰è£…åœ¨Cç›˜çš„ã€‚å½“ä½ å®‰è£…å¥½ä¹‹åï¼Œå¯ä»¥è¾“å…¥ï¼šollama -v æ¥æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå‡ºç°ç‰ˆæœ¬å·å°±æ˜¯å®‰è£…æˆåŠŸäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d478318ae4034c1dbb94c34b2efac284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=LM6AGvc5SA0jKIXd%2BKBSPe05yNA%3D" alt="" loading="lazy"/></p>
<p>å®‰è£…å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹æ¨¡å‹æ–‡ä»¶é»˜è®¤å­˜æ”¾çš„è·¯å¾„ï¼Œä¸ç„¶ä½ ä¸è®¾ç½®ä»–å°±æŠŠæ¨¡å‹å…¨æ”¾åœ¨cç›˜äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è®¾ç½®ollamaçš„æ¨¡å‹å®‰è£…è·¯å¾„ï¼ˆéœ€è¦å…ˆåˆ›å»ºå¯¹åº”æ–‡ä»¶å¤¹ï¼‰ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">setx /M OLLAMA_MODELS <span class="hljs-string">"D:\Ollama\models"</span>
</code></pre>
<p>æˆ–è€…é€šè¿‡ollamaæœ€æ–°ç‰ˆçš„å‰ç«¯ç•Œé¢è®¾ç½®æ¨¡å‹å®‰è£…è·¯å¾„ä¹Ÿå¯ä»¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/523cb18e3e14413196abb9c4555ad610~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=TCDfwq7c6h2uM%2FnwGPutru5ZttA%3D" alt="" loading="lazy"/></p>
<p>æ³¨æ„è¿è¡Œä¹‹åéœ€è¦å…³é—­ollamaåé‡æ–°å¼€ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ã€‚è¿™æ ·æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p>æ¨¡å‹çš„å®‰è£…ä¹Ÿå¾ˆç®€å•ï¼Œé­”æ­ç¤¾åŒºå°±æ”¯æŒollamaçš„å‘½ä»¤è¡Œä¸€é”®ä¸‹è½½æ¨¡å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾ä¸€ä¸ªggufæ ¼å¼çš„æ¨¡å‹ï¼Œå¤åˆ¶è¿™ä¸ªç½‘å€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e94d2c1cf31846b68ecc1c32a6dad1c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=k9w9A4LVuHUZja8G8AJ4aNANhT4%3D" alt="" loading="lazy"/></p>
<p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f532df8f149447aa4478423b034fad0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=6A1GZLBtiZVBsfjuNzM%2BLXfWC8k%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œè¦æ³¨æ„çš„ollama run åé¢çš„æ¨¡å‹åœ°å€æ˜¯æˆ‘ä»¬åˆšåˆšå¤åˆ¶çš„åœ°å€å»æ‰<a href="https://link.juejin.cn?target=http%3A%2F%2F%25E4%25BB%25A5%25E5%258F%258A" target="_blank" title="http://%E4%BB%A5%E5%8F%8A" ref="nofollow noopener noreferrer">http://ä»¥åŠ</a> models/ çš„ç»“æœå“¦ï¼ˆå¯¹äºqwenæ¥è¯´ï¼‰ã€‚</p>
<p>åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­å¯ä»¥çœ‹åˆ°æ²¡æœ‰è¯¢é—®æ¨¡å‹çš„cpuå’Œgpuå ç”¨æƒ…å†µï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c1808951b3243efa16de40b38ea6e89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=S30lBBNabJrwcK%2BvnoezQD4oRQY%3D" alt="" loading="lazy"/></p>
<p>aiåœ¨æ¨ç†çš„è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°cpuå’Œgpuçš„ä½¿ç”¨åº¦éƒ½æ˜æ˜¾åœ°å˜é«˜äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41845c14b024400388b84bec7b9f9808~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=EiD%2B3gUnZAAs9R3qxZ6E%2BasTXoQ%3D" alt="" loading="lazy"/></p>
<p>é™¤äº†åœ¨å‘½ä»¤è¡Œé€šè¿‡ollama runè¿›è¡Œæ¨¡å‹æé—®ä¹‹å¤–ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ollamaçš„å‰ç«¯ç•Œé¢ä¸­å¯¹è‡ªå·±éƒ¨ç½²çš„æœ¬åœ°æ¨¡å‹è¿›è¡Œæé—®ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Open WebUIç­‰å·¥å…·ä½œä¸ºæœ¬åœ°æ¨¡å‹çš„å¯è§†åŒ–ç•Œé¢ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad5919af61364ea0b7bead178c18baaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=hmXggsZR01%2FvNA%2BdsF1%2BvqZvoiw%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ æƒ³è®©ollamaä¸‹è½½ä¸æ˜¯é»˜è®¤4bité‡åŒ–çš„æ¨¡å‹çš„è¯ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œè¿˜æ˜¯åœ¨é­”æ­ç¤¾åŒºGGUFæ ¼å¼æ¨¡å‹é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒçš„é‡åŒ–æƒ…å†µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db529cbc502b4087ba7b91a3fabd2f9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=WRCdTgMxKiM6bPxaV%2Bw0lbyC2Wk%3D" alt="" loading="lazy"/></p>
<p>æ¯”å¦‚æˆ‘æƒ³<strong>è®©ollamaæ‹‰å»8bité‡åŒ–çš„ï¼Œå°±åœ¨æ¨¡å‹æ‹‰å–åœ°å€ä¸­åŠ ä¸Š:Q8_0å³å¯</strong>ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ddd4c3003dc4f1d9ff55836ab9240a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763609756&amp;x-signature=A0G4YuEh0x5e7i7M4v4wuMh3Wis%3D" alt="" loading="lazy"/></p>
<p>æ‹‰å–å‘½ä»¤ä¸ºï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ollama run modelscope.cn/Qwen/Qwen3<span class="hljs-number">-8B</span>-GGUF:Q8_0
</code></pre>
<p>è‡³æ­¤ï¼Œä½ å·²åœ¨æœ¬åœ°å®Œæˆ AI éƒ¨ç½²ï¼Œå®ç°ç¦»çº¿æ¨ç†ã€‚ä½† Ollama è¿˜èƒ½æ›´å¼ºå¤§ï¼Œæ¯”å¦‚éƒ¨ç½²å¤šæ¨¡æ€æ¨¡å‹ã€é€šè¿‡æ¥å£å¼€æ”¾æ¨¡å‹æœåŠ¡ã€çµæ´»æ§åˆ¶ CPU/GPU åˆ†å±‚åŠ è½½ã€è°ƒæ•´ä¸Šä¸‹æ–‡ä¸æ‰¹é‡å‚æ•°ç­‰ï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œä¸€åˆ‡éƒ½æ˜¯è¦å¾ªåºæ¸è¿›çš„æ¥ï¼Œè¿™äº›æˆ‘ä»¬åœ¨åç»­çš„æ–‡ç« ä¼šè¯´ã€‚</p>
<p>å¦‚æœå¤§å®¶åˆ°è¿™é‡ŒæˆåŠŸçš„éƒ¨ç½²äº†è‡ªå·±çš„æ¨¡å‹ï¼Œåç»­ä¼šç»™å¤§å®¶æ¨å‡ºæ›´è¿›ä¸€æ­¥çš„æ•™ç¨‹å’Œåº”ç”¨æ–¹æ³•ã€‚</p>
<h2 data-id="heading-0">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CompletableFutureçš„5å¤§å‘ï¼]]></title>    <link>https://juejin.cn/post/7571693273729286180</link>    <guid>https://juejin.cn/post/7571693273729286180</guid>    <pubDate>2025-11-13T02:29:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571693273729286180" data-draft-id="7571678388955332627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CompletableFutureçš„5å¤§å‘ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-13T02:29:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ä¸‰è¯´æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/465848661970824"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CompletableFutureçš„5å¤§å‘ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848661970824/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ä¸‰è¯´æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:29:15.000Z" title="Thu Nov 13 2025 02:29:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>CompletableFutureåœ¨å¹¶å‘ç¼–ç¨‹ä¸­éå¸¸å®ç”¨ï¼Œä½†å¦‚æœç”¨ä¸å¥½ï¼Œä¹Ÿå¾ˆå®¹æ˜“è¸©å‘ã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« è·Ÿå¤§å®¶ä¸€èµ·èŠèŠï¼ŒCompletableFutureåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æœ€å¸¸è§çš„é‚£äº›å‘ï¼Œå¸Œæœ›å¯¹ä½ ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p><a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%3Frefer%3Djuejin" title="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%3Frefer%3Djuejin" target="_blank">æœ€è¿‘å‡†å¤‡é¢è¯•çš„å°ä¼™ä¼´ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªå®è—ç½‘ç«™ï¼ˆJavaçªå‡»é˜Ÿï¼‰ï¼šwww.susan.net.cnï¼Œé‡Œé¢ï¼šé¢è¯•å…«è‚¡æ–‡ã€åœºæ™¯è®¾è®¡é¢˜ã€é¢è¯•çœŸé¢˜ã€7ä¸ªé¡¹ç›®å®æˆ˜ã€å·¥ä½œå†…æ¨ä»€ä¹ˆéƒ½æœ‰</a>ã€‚</p>
<p><a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%2Fcontact%2Fneitui.html" title="https://link.juejin.cn/?target=http%3A%2F%2Fwww.susan.net.cn%2Fcontact%2Fneitui.html" target="_blank">åŠ è‹ä¸‰çš„å·¥ä½œå†…æ¨ç¾¤</a></p>
<h2 data-id="heading-1">ä¸€ã€CompletableFutureç®€ä»‹</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å·¥ä½œä¸­åˆšå¼€å§‹æ¥è§¦CompletableFutureæ—¶ï¼Œå¯èƒ½ä¼šè¢«å®ƒå¼ºå¤§çš„åŠŸèƒ½æ‰€å¸å¼•ã€‚</p>
<p>ç¡®å®ï¼ŒCompletableFutureä¸ºæˆ‘ä»¬æä¾›äº†éå¸¸ä¼˜é›…çš„å¼‚æ­¥ç¼–ç¨‹æ–¹å¼ï¼Œä½†æ­£å¦‚æ­¦ä¾ å°è¯´ä¸­çš„ç¥å…µåˆ©å™¨ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œåè€Œä¼šä¼¤åˆ°è‡ªå·±ã€‚</p>
<h3 data-id="heading-2">CompletableFutureçš„åŸºæœ¬ç”¨æ³•</h3>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„CompletableFutureä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicCompletableFutureDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// ç®€å•çš„å¼‚æ­¥è®¡ç®—</span>
        CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">1000</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, CompletableFuture!"</span>;
        });
        
        <span class="hljs-comment">// è·å–ç»“æœï¼ˆé˜»å¡ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> future.get();
        System.out.println(result);
    }
}
</code></pre>
<p>çœ‹èµ·æ¥å¾ˆç®€å•å¯¹å§ï¼Ÿä½†æ­£æ˜¯è¿™ç§è¡¨é¢ä¸Šçš„ç®€å•ï¼Œæ©ç›–äº†å¾ˆå¤šæ½œåœ¨çš„å¤æ‚æ€§ã€‚</p>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ¶æ„å›¾æ¥ç†è§£CompletableFutureçš„å®Œæ•´ç”Ÿæ€ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7f127463bd94c2fb8a3c19c585e4fbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=PExu2mOkUWYr4biwfx1m66%2FA8Fo%3D" alt="" loading="lazy"/></p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ·±å…¥æ¢è®¨å„ä¸ªå‘ç‚¹ã€‚</p>
<h2 data-id="heading-3">äºŒã€çº¿ç¨‹æ± ä½¿ç”¨ä¸å½“</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨ä½¿ç”¨CompletableFutureæ—¶ï¼Œå¾€å¾€å¿½ç•¥äº†çº¿ç¨‹æ± çš„é…ç½®ï¼Œè¿™å¯èƒ½æ˜¯æœ€å®¹æ˜“è¢«å¿½è§†ä½†å½±å“æœ€å¤§çš„å‘ã€‚</p>
<h3 data-id="heading-4">é»˜è®¤çº¿ç¨‹æ± çš„é™·é˜±</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolPitfall</span> {
    
    <span class="hljs-comment">// å±é™©çš„ç”¨æ³•ï¼šå¤§é‡ä½¿ç”¨é»˜è®¤çº¿ç¨‹æ± </span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processBatchData</span><span class="hljs-params">(List&lt;String&gt; dataList)</span> {
        List&lt;CompletableFuture&lt;String&gt;&gt; futures = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (String data : dataList) {
            <span class="hljs-comment">// ä½¿ç”¨é»˜è®¤çš„ForkJoinPool.commonPool()</span>
            CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; {
                <span class="hljs-keyword">return</span> processData(data);
            });
            futures.add(future);
        }
        
        <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
        CompletableFuture.allOf(fatures.toArray(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CompletableFuture</span>[<span class="hljs-number">0</span>]))
                        .join();
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">processData</span><span class="hljs-params">(String data)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®å¤„ç†</span>
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">100</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        <span class="hljs-keyword">return</span> data.toUpperCase();
    }
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>é»˜è®¤çº¿ç¨‹æ± å¤§å°æ˜¯CPUæ ¸å¿ƒæ•°-1</li>
<li>åœ¨IOå¯†é›†å‹ä»»åŠ¡ä¸­ï¼Œè¿™ä¼šå¯¼è‡´å¤§é‡ä»»åŠ¡æ’é˜Ÿç­‰å¾…</li>
<li>å¦‚æœä»»åŠ¡æäº¤é€Ÿåº¦ &gt; ä»»åŠ¡å¤„ç†é€Ÿåº¦ï¼Œä¼šé€ æˆå†…å­˜æº¢å‡º</li>
</ul>
<h3 data-id="heading-5">æ­£ç¡®çš„çº¿ç¨‹æ± ä½¿ç”¨æ–¹å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProperThreadPoolUsage</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ExecutorService ioBoundExecutor;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ExecutorService cpuBoundExecutor;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProperThreadPoolUsage</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// IOå¯†é›†å‹ä»»åŠ¡ - ä½¿ç”¨è¾ƒå¤§çš„çº¿ç¨‹æ± </span>
        <span class="hljs-built_in">this</span>.ioBoundExecutor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">50</span>, <span class="hljs-comment">// æ ¸å¿ƒçº¿ç¨‹æ•°</span>
            <span class="hljs-number">100</span>, <span class="hljs-comment">// æœ€å¤§çº¿ç¨‹æ•°</span>
            <span class="hljs-number">60L</span>, TimeUnit.SECONDS, <span class="hljs-comment">// ç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é—´</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">1000</span>), <span class="hljs-comment">// å·¥ä½œé˜Ÿåˆ—</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadFactoryBuilder</span>().setNameFormat(<span class="hljs-string">"io-pool-%d"</span>).build(),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy() <span class="hljs-comment">// æ‹’ç»ç­–ç•¥</span>
        );
        
        <span class="hljs-comment">// CPUå¯†é›†å‹ä»»åŠ¡ - ä½¿ç”¨è¾ƒå°çš„çº¿ç¨‹æ± </span>
        <span class="hljs-built_in">this</span>.cpuBoundExecutor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            Runtime.getRuntime().availableProcessors(), <span class="hljs-comment">// CPUæ ¸å¿ƒæ•°</span>
            Runtime.getRuntime().availableProcessors() * <span class="hljs-number">2</span>,
            <span class="hljs-number">60L</span>, TimeUnit.SECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">100</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadFactoryBuilder</span>().setNameFormat(<span class="hljs-string">"cpu-pool-%d"</span>).build(),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.AbortPolicy()
        );
    }
    
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">processWithProperPool</span><span class="hljs-params">(String data)</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-comment">// IOæ“ä½œï¼Œä½¿ç”¨IOçº¿ç¨‹æ± </span>
            <span class="hljs-keyword">return</span> fetchFromDatabase(data);
        }, ioBoundExecutor);
    }
    
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">computeWithProperPool</span><span class="hljs-params">(String data)</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-comment">// CPUå¯†é›†å‹è®¡ç®—ï¼Œä½¿ç”¨CPUçº¿ç¨‹æ± </span>
            <span class="hljs-keyword">return</span> heavyComputation(data);
        }, cpuBoundExecutor);
    }
    
    <span class="hljs-comment">// èµ„æºæ¸…ç†</span>
    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        ioBoundExecutor.shutdown();
        cpuBoundExecutor.shutdown();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (!ioBoundExecutor.awaitTermination(<span class="hljs-number">5</span>, TimeUnit.SECONDS)) {
                ioBoundExecutor.shutdownNow();
            }
            <span class="hljs-keyword">if</span> (!cpuBoundExecutor.awaitTermination(<span class="hljs-number">5</span>, TimeUnit.SECONDS)) {
                cpuBoundExecutor.shutdownNow();
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            ioBoundExecutor.shutdownNow();
            cpuBoundExecutor.shutdownNow();
            Thread.currentThread().interrupt();
        }
    }
}
</code></pre>
<h3 data-id="heading-6">çº¿ç¨‹æ± å·¥ä½œæµç¨‹å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c38829086cd744bb960248d2eb87f280~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=Wo1WlcxGCfGe7SH92rLYjopVg3E%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">ä¸‰ã€å¼‚å¸¸ä¸ºä»€ä¹ˆç¥ç§˜æ¶ˆå¤±äº†ï¼Ÿ</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨è°ƒè¯•CompletableFutureæ—¶ï¼Œç»å¸¸ä¼šå‘ç°å¼‚å¸¸"ç¥ç§˜æ¶ˆå¤±"äº†ï¼Œè¿™å…¶å®æ˜¯CompletableFutureå¼‚å¸¸å¤„ç†æœºåˆ¶çš„ä¸€ä¸ªç‰¹æ€§ã€‚</p>
<h3 data-id="heading-8">å¼‚å¸¸ä¸¢å¤±çš„å…¸å‹æ¡ˆä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionDisappearance</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testExceptionLost</span><span class="hljs-params">()</span> {
        CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-comment">// è¿™é‡Œä¼šæŠ›å‡ºå¼‚å¸¸</span>
            <span class="hljs-keyword">return</span> dangerousOperation();
        });
        
        <span class="hljs-comment">// æ·»åŠ è½¬æ¢é“¾</span>
        CompletableFuture&lt;String&gt; resultFuture = future.thenApply(result -&gt; {
            System.out.println(<span class="hljs-string">"å¤„ç†ç»“æœ: "</span> + result);
            <span class="hljs-keyword">return</span> result + <span class="hljs-string">" processed"</span>;
        });
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¿™é‡Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> resultFuture.get();
            System.out.println(<span class="hljs-string">"æœ€ç»ˆç»“æœ: "</span> + result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å¼‚å¸¸è¢«åŒ…è£…åœ¨ExecutionExceptionä¸­</span>
            System.out.println(<span class="hljs-string">"æ•è·åˆ°å¼‚å¸¸: "</span> + e.getClass().getName());
            System.out.println(<span class="hljs-string">"æ ¹æœ¬åŸå› : "</span> + e.getCause().getMessage());
        }
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">dangerousOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ä¸šåŠ¡æ“ä½œå¤±è´¥ï¼"</span>);
    }
    
    <span class="hljs-comment">// æ›´éšè”½çš„å¼‚å¸¸ä¸¢å¤±</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testHiddenExceptionLoss</span><span class="hljs-params">()</span> {
        CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"é‡è¦å¼‚å¸¸"</span>);
        }).thenAccept(result -&gt; {
            <span class="hljs-comment">// å¦‚æœä¸Šæ¸¸æœ‰å¼‚å¸¸ï¼Œè¿™é‡Œä¸ä¼šæ‰§è¡Œ</span>
            System.out.println(<span class="hljs-string">"å¤„ç†ç»“æœ: "</span> + result);
        });
        
        <span class="hljs-comment">// ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œå¼‚å¸¸è¢«å¿½ç•¥ï¼</span>
        System.out.println(<span class="hljs-string">"ç¨‹åºæ­£å¸¸ç»“æŸï¼Œä½†å¼‚å¸¸ä¸¢å¤±äº†ï¼"</span>);
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BusinessException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">BusinessException</span><span class="hljs-params">(String message)</span> {
            <span class="hljs-built_in">super</span>(message);
        }
    }
}
</code></pre>
<h3 data-id="heading-9">CompletableFutureå¼‚å¸¸å¤„ç†æœºåˆ¶</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cfdb8e566a349bd8ad1a44b3ddd10b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=hEQQAjLov96H1FV8SZnojs8mg60%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">æ­£ç¡®çš„å¼‚å¸¸å¤„ç†æ–¹å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProperExceptionHandling</span> {
    
    <span class="hljs-comment">// æ–¹æ³•1ï¼šä½¿ç”¨exceptionallyè¿›è¡Œæ¢å¤</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">handleWithRecovery</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> riskyOperation();
        }).exceptionally(throwable -&gt; {
            <span class="hljs-comment">// å¼‚å¸¸æ¢å¤</span>
            System.err.println(<span class="hljs-string">"æ“ä½œå¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤å€¼: "</span> + throwable.getMessage());
            <span class="hljs-keyword">return</span> <span class="hljs-string">"default-value"</span>;
        });
    }
    
    <span class="hljs-comment">// æ–¹æ³•2ï¼šä½¿ç”¨handleç»Ÿä¸€å¤„ç†</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">handleWithUnified</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> riskyOperation();
        }).handle((result, throwable) -&gt; {
            <span class="hljs-keyword">if</span> (throwable != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// å¤„ç†å¼‚å¸¸</span>
                System.err.println(<span class="hljs-string">"æ“ä½œå¼‚å¸¸: "</span> + throwable.getMessage());
                <span class="hljs-keyword">return</span> <span class="hljs-string">"error-value"</span>;
            }
            <span class="hljs-keyword">return</span> result + <span class="hljs-string">"-processed"</span>;
        });
    }
    
    <span class="hljs-comment">// æ–¹æ³•3ï¼šä½¿ç”¨whenCompleteè¿›è¡Œå‰¯ä½œç”¨å¤„ç†</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Void&gt; <span class="hljs-title function_">handleWithSideEffect</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> riskyOperation();
        }).whenComplete((result, throwable) -&gt; {
            <span class="hljs-keyword">if</span> (throwable != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// è®°å½•æ—¥å¿—ã€å‘é€å‘Šè­¦ç­‰</span>
                logError(throwable);
                sendAlert(throwable);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æ­£å¸¸ä¸šåŠ¡å¤„ç†</span>
                processResult(result);
            }
        });
    }
    
    <span class="hljs-comment">// æ–¹æ³•4ï¼šç»„åˆæ“ä½œä¸­çš„å¼‚å¸¸å¤„ç†</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">handleInComposition</span><span class="hljs-params">()</span> {
        CompletableFuture&lt;String&gt; future1 = CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> operation1();
        });
        
        CompletableFuture&lt;String&gt; future2 = future1.thenCompose(result1 -&gt; {
            <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
                <span class="hljs-keyword">return</span> operation2(result1);
            });
        });
        
        <span class="hljs-comment">// åœ¨æ•´ä¸ªé“¾çš„æœ«å°¾å¤„ç†å¼‚å¸¸</span>
        <span class="hljs-keyword">return</span> future2.exceptionally(throwable -&gt; {
            <span class="hljs-type">Throwable</span> <span class="hljs-variable">rootCause</span> <span class="hljs-operator">=</span> getRootCause(throwable);
            <span class="hljs-keyword">if</span> (rootCause <span class="hljs-keyword">instanceof</span> BusinessException) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"business-fallback"</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rootCause <span class="hljs-keyword">instanceof</span> TimeoutException) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"timeout-fallback"</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-string">"unknown-error"</span>;
            }
        });
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(Throwable throwable)</span> {
        <span class="hljs-comment">// è®°å½•é”™è¯¯æ—¥å¿—</span>
        System.err.println(<span class="hljs-string">"é”™è¯¯è®°å½•: "</span> + throwable.getMessage());
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendAlert</span><span class="hljs-params">(Throwable throwable)</span> {
        <span class="hljs-comment">// å‘é€å‘Šè­¦</span>
        System.out.println(<span class="hljs-string">"å‘é€å‘Šè­¦: "</span> + throwable.getMessage());
    }
    
    <span class="hljs-keyword">private</span> Throwable <span class="hljs-title function_">getRootCause</span><span class="hljs-params">(Throwable throwable)</span> {
        <span class="hljs-type">Throwable</span> <span class="hljs-variable">cause</span> <span class="hljs-operator">=</span> throwable;
        <span class="hljs-keyword">while</span> (cause.getCause() != <span class="hljs-literal">null</span>) {
            cause = cause.getCause();
        }
        <span class="hljs-keyword">return</span> cause;
    }
}
</code></pre>
<h2 data-id="heading-11">å››ã€å›è°ƒåœ°ç‹±ï¼šå½“å¼‚æ­¥å˜æˆ"å¼‚ç—›"</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸­ä½¿ç”¨CompletableFutureæ—¶ï¼Œå¾ˆå®¹æ˜“é™·å…¥å›è°ƒåœ°ç‹±ï¼Œä»£ç å˜å¾—éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚</p>
<h3 data-id="heading-12">å›è°ƒåœ°ç‹±çš„å…¸å‹æ¡ˆä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CallbackHell</span> {
    
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">processUserOrder</span><span class="hljs-params">(String userId)</span> {
        <span class="hljs-keyword">return</span> getUserInfo(userId)
            .thenCompose(userInfo -&gt; {
                <span class="hljs-keyword">return</span> getOrderHistory(userInfo.getId())
                    .thenCompose(orderHistory -&gt; {
                        <span class="hljs-keyword">return</span> calculateDiscount(userInfo, orderHistory)
                            .thenCompose(discount -&gt; {
                                <span class="hljs-keyword">return</span> createOrder(userInfo, discount)
                                    .thenCompose(order -&gt; {
                                        <span class="hljs-keyword">return</span> sendConfirmation(userInfo, order);
                                    });
                            });
                    });
            });
    }
    
    <span class="hljs-comment">// ä¸Šè¿°ä»£ç çš„"å¹³é“º"ç‰ˆæœ¬ï¼ŒåŒæ ·éš¾ä»¥é˜…è¯»</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">processUserOrderFlat</span><span class="hljs-params">(String userId)</span> {
        <span class="hljs-keyword">return</span> getUserInfo(userId)
            .thenCompose(userInfo -&gt; getOrderHistory(userInfo.getId()))
            .thenCompose(orderHistory -&gt; getUserInfo(userId))
            .thenCompose(userInfo -&gt; calculateDiscount(userInfo, orderHistory))
            .thenCompose(discount -&gt; getUserInfo(userId))
            .thenCompose(userInfo -&gt; createOrder(userInfo, discount))
            .thenCompose(order -&gt; getUserInfo(userId))
            .thenCompose(userInfo -&gt; sendConfirmation(userInfo, order));
    }
}
</code></pre>
<h3 data-id="heading-13">ç»“æ„åŒ–å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StructuredAsyncProgramming</span> {
    
    <span class="hljs-comment">// å®šä¹‰ä¸šåŠ¡æ•°æ®ç±»</span>
    <span class="hljs-meta">@Data</span>
    <span class="hljs-meta">@AllArgsConstructor</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderContext</span> {
        <span class="hljs-keyword">private</span> String userId;
        <span class="hljs-keyword">private</span> UserInfo userInfo;
        <span class="hljs-keyword">private</span> List&lt;Order&gt; orderHistory;
        <span class="hljs-keyword">private</span> Discount discount;
        <span class="hljs-keyword">private</span> Order order;
        <span class="hljs-keyword">private</span> String result;
    }
    
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">processUserOrderStructured</span><span class="hljs-params">(String userId)</span> {
        <span class="hljs-type">OrderContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderContext</span>(userId, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
        
        <span class="hljs-keyword">return</span> getUserInfo(context.getUserId())
            .thenCompose(userInfo -&gt; {
                context.setUserInfo(userInfo);
                <span class="hljs-keyword">return</span> getOrderHistory(userInfo.getId());
            })
            .thenCompose(orderHistory -&gt; {
                context.setOrderHistory(orderHistory);
                <span class="hljs-keyword">return</span> calculateDiscount(context.getUserInfo(), orderHistory);
            })
            .thenCompose(discount -&gt; {
                context.setDiscount(discount);
                <span class="hljs-keyword">return</span> createOrder(context.getUserInfo(), discount);
            })
            .thenCompose(order -&gt; {
                context.setOrder(order);
                <span class="hljs-keyword">return</span> sendConfirmation(context.getUserInfo(), order);
            })
            .thenApply(result -&gt; {
                context.setResult(result);
                <span class="hljs-keyword">return</span> result;
            })
            .exceptionally(throwable -&gt; {
                <span class="hljs-comment">// ç»Ÿä¸€å¼‚å¸¸å¤„ç†</span>
                <span class="hljs-keyword">return</span> handleOrderError(context, throwable);
            });
    }
    
    <span class="hljs-comment">// ä½¿ç”¨thenCombineå¤„ç†å¹¶è¡Œä»»åŠ¡</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;UserProfile&gt; <span class="hljs-title function_">getUserProfile</span><span class="hljs-params">(String userId)</span> {
        CompletableFuture&lt;UserInfo&gt; userInfoFuture = getUserInfo(userId);
        CompletableFuture&lt;List&lt;Order&gt;&gt; orderHistoryFuture = getOrderHistory(userId);
        CompletableFuture&lt;List&lt;Address&gt;&gt; addressesFuture = getUserAddresses(userId);
        
        <span class="hljs-keyword">return</span> userInfoFuture.thenCombine(orderHistoryFuture, (userInfo, orders) -&gt; {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserProfile</span>(userInfo, orders, <span class="hljs-literal">null</span>);
        }).thenCombine(addressesFuture, (profile, addresses) -&gt; {
            profile.setAddresses(addresses);
            <span class="hljs-keyword">return</span> profile;
        });
    }
    
    <span class="hljs-comment">// ä½¿ç”¨allOfå¤„ç†å¤šä¸ªç‹¬ç«‹ä»»åŠ¡</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Map&lt;String, Object&gt;&gt; <span class="hljs-title function_">getDashboardData</span><span class="hljs-params">(String userId)</span> {
        CompletableFuture&lt;UserInfo&gt; userInfoFuture = getUserInfo(userId);
        CompletableFuture&lt;List&lt;Order&gt;&gt; ordersFuture = getOrderHistory(userId);
        CompletableFuture&lt;List&lt;Notification&gt;&gt; notificationsFuture = getNotifications(userId);
        CompletableFuture&lt;Preferences&gt; preferencesFuture = getPreferences(userId);
        
        CompletableFuture&lt;Void&gt; allFutures = CompletableFuture.allOf(
            userInfoFuture, ordersFuture, notificationsFuture, preferencesFuture
        );
        
        <span class="hljs-keyword">return</span> allFutures.thenApply(v -&gt; {
            Map&lt;String, Object&gt; dashboard = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            <span class="hljs-keyword">try</span> {
                dashboard.put(<span class="hljs-string">"userInfo"</span>, userInfoFuture.get());
                dashboard.put(<span class="hljs-string">"orders"</span>, ordersFuture.get());
                dashboard.put(<span class="hljs-string">"notifications"</span>, notificationsFuture.get());
                dashboard.put(<span class="hljs-string">"preferences"</span>, preferencesFuture.get());
            } <span class="hljs-keyword">catch</span> (Exception e) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompletionException</span>(e);
            }
            <span class="hljs-keyword">return</span> dashboard;
        });
    }
}
</code></pre>
<h3 data-id="heading-14">å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e942e5caf5e483e920c1c10311c14a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=Pr1AU0Uv84vkw3bVQo%2Fv%2BOzOQn8%3D" alt="" loading="lazy"/></p>
<p>æ›´æ¨èçš„æ–¹æ¡ˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef5b3b1c0a4046a392f8edbd0aa4ba2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=XZzYXqQCqO9iyyDxciwC13GC%2F2g%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">äº”ã€å†…å­˜æ³„æ¼ï¼šéšè—çš„èµ„æºæ¶ˆè€—è€…</h2>
<p>æœ‰äº›å°ä¼™ä¼´å¯èƒ½æ²¡æœ‰æ„è¯†åˆ°ï¼Œä¸å½“ä½¿ç”¨CompletableFutureä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œç‰¹åˆ«æ˜¯åœ¨é•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ä¸­ã€‚</p>
<h3 data-id="heading-16">å†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryLeakDemo</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, CompletableFuture&lt;String&gt;&gt; cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">// åœºæ™¯1ï¼šæ— é™å¢é•¿çš„ç¼“å­˜</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">getDataWithLeak</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-keyword">return</span> cache.computeIfAbsent(key, k -&gt; {
            <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; fetchData(k));
        });
    }
    
    <span class="hljs-comment">// åœºæ™¯2ï¼šæœªå®Œæˆçš„Futureç§¯ç´¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processWithUnfinishedFutures</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) {
            CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; {
                <span class="hljs-comment">// æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œæˆ–é˜»å¡çš„ä»»åŠ¡</span>
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(Long.MAX_VALUE); <span class="hljs-comment">// å‡ ä¹æ°¸ä¹…é˜»å¡</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
                <span class="hljs-keyword">return</span> <span class="hljs-string">"result"</span>;
            });
            <span class="hljs-comment">// futureæ°¸è¿œä¸ä¼šå®Œæˆï¼Œä½†ä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­</span>
        }
    }
    
    <span class="hljs-comment">// åœºæ™¯3ï¼šå¾ªç¯å¼•ç”¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskManager</span> {
        <span class="hljs-keyword">private</span> CompletableFuture&lt;String&gt; currentTask;
        <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> <span class="hljs-string">"INIT"</span>;
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startTask</span><span class="hljs-params">()</span> {
            currentTask = CompletableFuture.supplyAsync(() -&gt; {
                <span class="hljs-comment">// ä»»åŠ¡æŒæœ‰Managerçš„å¼•ç”¨</span>
                <span class="hljs-keyword">while</span> (!<span class="hljs-string">"COMPLETED"</span>.equals(status)) {
                    <span class="hljs-comment">// å¤„ç†ä»»åŠ¡</span>
                    processTask();
                }
                <span class="hljs-keyword">return</span> <span class="hljs-string">"done"</span>;
            });
        }
        
        <span class="hljs-comment">// Managerä¹ŸæŒæœ‰ä»»åŠ¡çš„å¼•ç”¨</span>
        <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">getCurrentTask</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> currentTask;
        }
    }
}
</code></pre>
<h3 data-id="heading-17">å†…å­˜æ³„æ¼æ£€æµ‹å’Œé¢„é˜²</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryLeakPrevention</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Cache&lt;String, CompletableFuture&lt;String&gt;&gt; cache;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MemoryLeakPrevention</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä½¿ç”¨Guava Cacheè‡ªåŠ¨æ¸…ç†</span>
        <span class="hljs-built_in">this</span>.cache = CacheBuilder.newBuilder()
            .maximumSize(<span class="hljs-number">1000</span>)
            .expireAfterAccess(<span class="hljs-number">10</span>, TimeUnit.MINUTES)
            .removalListener((RemovalListener&lt;String, CompletableFuture&lt;String&gt;&gt;) notification -&gt; {
                <span class="hljs-keyword">if</span> (notification.getCause() == RemovalCause.SIZE || 
                    notification.getCause() == RemovalCause.EXPIRED) {
                    <span class="hljs-comment">// å–æ¶ˆæœªå®Œæˆçš„ä»»åŠ¡</span>
                    CompletableFuture&lt;String&gt; future = notification.getValue();
                    <span class="hljs-keyword">if</span> (!future.isDone()) {
                        future.cancel(<span class="hljs-literal">true</span>);
                    }
                }
            })
            .build();
    }
    
    <span class="hljs-comment">// å®‰å…¨çš„ç¼“å­˜ç”¨æ³•</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">getDataSafely</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> cache.get(key, () -&gt; {
                CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; fetchData(key));
                
                <span class="hljs-comment">// æ·»åŠ è¶…æ—¶æ§åˆ¶</span>
                <span class="hljs-keyword">return</span> future.orTimeout(<span class="hljs-number">30</span>, TimeUnit.SECONDS)
                           .exceptionally(throwable -&gt; {
                               <span class="hljs-comment">// å‘ç”Ÿå¼‚å¸¸æ—¶ä»ç¼“å­˜ä¸­ç§»é™¤</span>
                               cache.invalidate(key);
                               <span class="hljs-keyword">return</span> <span class="hljs-string">"fallback-data"</span>;
                           });
            });
        } <span class="hljs-keyword">catch</span> (ExecutionException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨WeakReferenceé¿å…å¾ªç¯å¼•ç”¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeTaskManager</span> {
        <span class="hljs-keyword">private</span> WeakReference&lt;CompletableFuture&lt;String&gt;&gt; currentTaskRef;
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startTask</span><span class="hljs-params">()</span> {
            CompletableFuture&lt;String&gt; task = CompletableFuture.supplyAsync(() -&gt; {
                <span class="hljs-keyword">return</span> performTask();
            });
            
            currentTaskRef = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakReference</span>&lt;&gt;(task);
            
            <span class="hljs-comment">// ä»»åŠ¡å®Œæˆåè‡ªåŠ¨æ¸…ç†</span>
            task.whenComplete((result, error) -&gt; {
                currentTaskRef = <span class="hljs-literal">null</span>;
            });
        }
    }
    
    <span class="hljs-comment">// ç›‘æ§å’Œè¯Šæ–­å·¥å…·</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorFutures</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å®šæœŸæ£€æŸ¥æœªå®Œæˆçš„Future</span>
        <span class="hljs-type">Timer</span> <span class="hljs-variable">timer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Timer</span>(<span class="hljs-literal">true</span>);
        timer.scheduleAtFixedRate(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TimerTask</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                <span class="hljs-type">int</span> <span class="hljs-variable">unfinishedCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (CompletableFuture&lt;?&gt; future : cache.asMap().values()) {
                    <span class="hljs-keyword">if</span> (!future.isDone()) {
                        unfinishedCount++;
                        <span class="hljs-comment">// è®°å½•é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</span>
                        <span class="hljs-keyword">if</span> (future.isDoneExceptionally()) {
                            <span class="hljs-comment">// å¤„ç†å¼‚å¸¸ä»»åŠ¡</span>
                            handleExceptionalFuture(future);
                        }
                    }
                }
                
                <span class="hljs-keyword">if</span> (unfinishedCount &gt; <span class="hljs-number">100</span>) {
                    <span class="hljs-comment">// å‘å‡ºè­¦å‘Š</span>
                    System.err.println(<span class="hljs-string">"è­¦å‘Š: æœ‰ "</span> + unfinishedCount + <span class="hljs-string">" ä¸ªæœªå®Œæˆçš„ä»»åŠ¡"</span>);
                }
            }
        }, <span class="hljs-number">0</span>, <span class="hljs-number">60000</span>); <span class="hljs-comment">// æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleExceptionalFuture</span><span class="hljs-params">(CompletableFuture&lt;?&gt; future)</span> {
        <span class="hljs-comment">// å¤„ç†å¼‚å¸¸Futureï¼Œé¿å…å®ƒä»¬ä¸€ç›´å­˜åœ¨</span>
        future.exceptionally(throwable -&gt; {
            <span class="hljs-comment">// è®°å½•å¼‚å¸¸æ—¥å¿—</span>
            System.err.println(<span class="hljs-string">"ä»»åŠ¡å¼‚å¸¸: "</span> + throwable.getMessage());
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        });
    }
}
</code></pre>
<h3 data-id="heading-18">å†…å­˜æ³„æ¼æ£€æµ‹æµç¨‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63241feed2cf4d02b17d4e2acfa69ece~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=pku9xmn6qbZFoM5m2YQ9QABS4PE%3D" alt="" loading="lazy"/></p>
<p>æœ€è¿‘ä¸ºäº†å¸®åŠ©å¤§å®¶æ‰¾å·¥ä½œï¼Œä¸“é—¨å»ºäº†ä¸€äº›å·¥ä½œå†…æ¨ç¾¤ï¼Œå„å¤§åŸå¸‚éƒ½æœ‰ï¼Œæ¬¢è¿å„ä½HRå’Œæ‰¾å·¥ä½œçš„å°ä¼™ä¼´è¿›ç¾¤äº¤æµï¼Œç¾¤é‡Œç›®å‰å·²ç»æ”¶é›†äº†ä¸å°‘çš„å·¥ä½œå†…æ¨å²—ä½ã€‚åŠ è‹ä¸‰çš„å¾®ä¿¡ï¼šli_su223ï¼Œå¤‡æ³¨ï¼šæ˜é‡‘+æ‰€åœ¨åŸå¸‚ï¼Œå³å¯è¿›ç¾¤ã€‚</p>
<h2 data-id="heading-19">å…­ã€è¶…æ—¶æ§åˆ¶ç¼ºå¤±</h2>
<p>æœ‰äº›å°ä¼™ä¼´åœ¨ä½¿ç”¨CompletableFutureæ—¶ï¼Œç»å¸¸ä¼šå¿˜è®°è®¾ç½®è¶…æ—¶æ§åˆ¶ï¼Œè¿™å¯èƒ½å¯¼è‡´çº¿ç¨‹æ°¸è¿œé˜»å¡ã€‚</p>
<h3 data-id="heading-20">è¶…æ—¶é—®é¢˜çš„ä¸¥é‡æ€§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutPitfalls</span> {
    
    <span class="hljs-comment">// å±é™©çš„ä»£ç ï¼šæ²¡æœ‰è¶…æ—¶æ§åˆ¶</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">dangerousGet</span><span class="hljs-params">()</span> {
        CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œé—®é¢˜å¯¼è‡´çš„æ— é™é˜»å¡</span>
            <span class="hljs-keyword">return</span> blockingNetworkCall();
        });
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å¦‚æœä»»åŠ¡æ°¸è¿œä¸å®Œæˆï¼Œè¿™é‡Œä¼šæ°¸è¿œé˜»å¡</span>
            <span class="hljs-keyword">return</span> future.get();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"error"</span>;
        }
    }
    
    <span class="hljs-comment">// èµ„æºæ³„æ¼çš„ç¤ºä¾‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">resourceLeakExample</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">10</span>);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
            CompletableFuture.runAsync(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</span>
                    Thread.sleep(Long.MAX_VALUE);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            }, executor);
        }
        
        <span class="hljs-comment">// çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹éƒ½è¢«å ç”¨ï¼Œæ— æ³•æ‰§è¡Œæ–°ä»»åŠ¡</span>
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">blockingNetworkCall</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œé—®é¢˜</span>
        <span class="hljs-keyword">try</span> {
            Thread.sleep(Long.MAX_VALUE);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">"response"</span>;
    }
}
</code></pre>
<h3 data-id="heading-21">å®Œæ•´çš„è¶…æ—¶æ§åˆ¶æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CompleteTimeoutSolution</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ScheduledExecutorService timeoutExecutor;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CompleteTimeoutSolution</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.timeoutExecutor = Executors.newScheduledThreadPool(<span class="hljs-number">2</span>);
    }
    
    <span class="hljs-comment">// æ–¹æ³•1ï¼šä½¿ç”¨orTimeoutï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">withOrTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> externalServiceCall();
        }).orTimeout(<span class="hljs-number">5</span>, TimeUnit.SECONDS) <span class="hljs-comment">// 5ç§’è¶…æ—¶</span>
          .exceptionally(throwable -&gt; {
              <span class="hljs-keyword">if</span> (throwable <span class="hljs-keyword">instanceof</span> TimeoutException) {
                  <span class="hljs-keyword">return</span> <span class="hljs-string">"timeout-fallback"</span>;
              }
              <span class="hljs-keyword">return</span> <span class="hljs-string">"error-fallback"</span>;
          });
    }
    
    <span class="hljs-comment">// æ–¹æ³•2ï¼šä½¿ç”¨completeOnTimeoutï¼ˆJava 9+ï¼‰</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">withCompleteOnTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> externalServiceCall();
        }).completeOnTimeout(<span class="hljs-string">"timeout-default"</span>, <span class="hljs-number">3</span>, TimeUnit.SECONDS);
    }
    
    <span class="hljs-comment">// æ–¹æ³•3ï¼šæ‰‹åŠ¨è¶…æ—¶æ§åˆ¶ï¼ˆJava 8å…¼å®¹ï¼‰</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">withManualTimeout</span><span class="hljs-params">()</span> {
        CompletableFuture&lt;String&gt; taskFuture = CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> externalServiceCall();
        });
        
        CompletableFuture&lt;String&gt; timeoutFuture = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompletableFuture</span>&lt;&gt;();
        
        <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
        timeoutExecutor.schedule(() -&gt; {
            timeoutFuture.completeExceptionally(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutException</span>(<span class="hljs-string">"æ“ä½œè¶…æ—¶"</span>));
        }, <span class="hljs-number">5</span>, TimeUnit.SECONDS);
        
        <span class="hljs-comment">// å“ªä¸ªå…ˆå®Œæˆå°±è¿”å›å“ªä¸ª</span>
        <span class="hljs-keyword">return</span> taskFuture.applyToEither(timeoutFuture, Function.identity())
                       .exceptionally(throwable -&gt; {
                           <span class="hljs-keyword">if</span> (throwable <span class="hljs-keyword">instanceof</span> TimeoutException) {
                               <span class="hljs-keyword">return</span> <span class="hljs-string">"manual-timeout-fallback"</span>;
                           }
                           <span class="hljs-keyword">return</span> <span class="hljs-string">"other-error-fallback"</span>;
                       });
    }
    
    <span class="hljs-comment">// æ–¹æ³•4ï¼šåˆ†å±‚è¶…æ—¶æ§åˆ¶</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">withLayeredTimeout</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> phase1Operation();
        }).orTimeout(<span class="hljs-number">2</span>, TimeUnit.SECONDS)
          .thenCompose(phase1Result -&gt; {
              <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
                  <span class="hljs-keyword">return</span> phase2Operation(phase1Result);
              }).orTimeout(<span class="hljs-number">3</span>, TimeUnit.SECONDS);
          })
          .thenCompose(phase2Result -&gt; {
              <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
                  <span class="hljs-keyword">return</span> phase3Operation(phase2Result);
              }).orTimeout(<span class="hljs-number">5</span>, TimeUnit.SECONDS);
          })
          .exceptionally(throwable -&gt; {
              <span class="hljs-type">Throwable</span> <span class="hljs-variable">rootCause</span> <span class="hljs-operator">=</span> getRootCause(throwable);
              <span class="hljs-keyword">if</span> (rootCause <span class="hljs-keyword">instanceof</span> TimeoutException) {
                  <span class="hljs-comment">// æ ¹æ®è¶…æ—¶é˜¶æ®µæä¾›ä¸åŒçš„é™çº§ç­–ç•¥</span>
                  <span class="hljs-keyword">return</span> <span class="hljs-string">"timeout-in-phase"</span>;
              }
              <span class="hljs-keyword">return</span> <span class="hljs-string">"general-fallback"</span>;
          });
    }
    
    <span class="hljs-comment">// æ–¹æ³•5ï¼šå¯é…ç½®çš„è¶…æ—¶ç­–ç•¥</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">withConfigurableTimeout</span><span class="hljs-params">(String operationType)</span> {
        <span class="hljs-type">TimeoutConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> getTimeoutConfig(operationType);
        
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; {
            <span class="hljs-keyword">return</span> performOperation(operationType);
        }).orTimeout(config.getTimeout(), config.getTimeUnit())
          .exceptionally(throwable -&gt; {
              <span class="hljs-keyword">return</span> config.getFallbackStrategy().apply(throwable);
          });
    }
    
    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        timeoutExecutor.shutdown();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (!timeoutExecutor.awaitTermination(<span class="hljs-number">5</span>, TimeUnit.SECONDS)) {
                timeoutExecutor.shutdownNow();
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            timeoutExecutor.shutdownNow();
            Thread.currentThread().interrupt();
        }
    }
    
    <span class="hljs-comment">// è¶…æ—¶é…ç½®ç±»</span>
    <span class="hljs-meta">@Data</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutConfig</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> timeout;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> TimeUnit timeUnit;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Function&lt;Throwable, String&gt; fallbackStrategy;
    }
    
    <span class="hljs-keyword">private</span> TimeoutConfig <span class="hljs-title function_">getTimeoutConfig</span><span class="hljs-params">(String operationType)</span> {
        <span class="hljs-keyword">switch</span> (operationType) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"fast"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutConfig</span>(<span class="hljs-number">1</span>, TimeUnit.SECONDS, 
                    t -&gt; <span class="hljs-string">"fast-timeout"</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"normal"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutConfig</span>(<span class="hljs-number">5</span>, TimeUnit.SECONDS,
                    t -&gt; <span class="hljs-string">"normal-timeout"</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"slow"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutConfig</span>(<span class="hljs-number">30</span>, TimeUnit.SECONDS,
                    t -&gt; <span class="hljs-string">"slow-timeout"</span>);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeoutConfig</span>(<span class="hljs-number">10</span>, TimeUnit.SECONDS,
                    t -&gt; <span class="hljs-string">"default-timeout"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-22">è¶…æ—¶æ§åˆ¶ç­–ç•¥</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd0feab08609426dab28ff92e6ac9b7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5LiJ6K-05oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605755&amp;x-signature=y2mZfgiQWKhnvvuBaJn8P%2F9wJ4s%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-23">æ€»ç»“</h2>
<p>é€šè¿‡ä¸Šé¢çš„è¯¦ç»†åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°CompletableFutureè™½ç„¶å¼ºå¤§ï¼Œä½†ä¹Ÿç¡®å®å­˜åœ¨ä¸å°‘é™·é˜±ã€‚</p>
<h3 data-id="heading-24">æœ€åçš„å»ºè®®</h3>
<ol>
<li><strong>ç†è§£åŸç†</strong>ï¼šä¸è¦åªæ˜¯æœºæ¢°åœ°ä½¿ç”¨APIï¼Œè¦ç†è§£CompletableFutureçš„å·¥ä½œåŸç†</li>
<li><strong>é€‚åº¦ä½¿ç”¨</strong>ï¼šä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦å¼‚æ­¥ï¼ŒåŒæ­¥ä»£ç æ›´ç®€å•æ˜“æ‡‚</li>
<li><strong>æµ‹è¯•è¦†ç›–</strong>ï¼šå¼‚æ­¥ä»£ç çš„æµ‹è¯•å¾ˆé‡è¦ï¼Œè¦è¦†ç›–å„ç§è¾¹ç•Œæƒ…å†µ</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¦æœ‰å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶</li>
<li><strong>æŒç»­å­¦ä¹ </strong>ï¼šå…³æ³¨Javaå¹¶å‘ç¼–ç¨‹çš„æ–°ç‰¹æ€§å’Œæœ€ä½³å®è·µ</li>
</ol>
<p>è®°ä½ï¼Œå·¥å…·æ˜¯ä¸ºäº†æé«˜ç”Ÿäº§åŠ›ï¼Œè€Œä¸æ˜¯åˆ¶é€ é—®é¢˜ã€‚</p>
<p>æŒæ¡äº†è¿™äº›é¿å‘æŠ€å·§ï¼ŒCompletableFutureå°†æˆä¸ºä½ æ‰‹ä¸­å¼ºå¤§çš„å¹¶å‘ç¼–ç¨‹åˆ©å™¨ï¼</p>
<h2 data-id="heading-25">æœ€åè¯´ä¸€å¥(æ±‚å…³æ³¨ï¼Œåˆ«ç™½å«–æˆ‘)</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæˆ–è€…æœ‰æ‰€å¯å‘çš„è¯ï¼Œå¸®å¿™å…³æ³¨ä¸€ä¸‹æˆ‘çš„åŒåå…¬ä¼—å·ï¼šè‹ä¸‰è¯´æŠ€æœ¯ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘åšæŒå†™ä½œæœ€å¤§çš„åŠ¨åŠ›ã€‚</p>
<p>æ±‚ä¸€é”®ä¸‰è¿ï¼šç‚¹èµã€è½¬å‘ã€åœ¨çœ‹ã€‚</p>
<p>å…³æ³¨å…¬ä¼—å·ï¼šã€è‹ä¸‰è¯´æŠ€æœ¯ã€‘ï¼Œåœ¨å…¬ä¼—å·ä¸­å›å¤ï¼šè¿›å¤§å‚ï¼Œå¯ä»¥å…è´¹è·å–æˆ‘æœ€è¿‘æ•´ç†çš„10ä¸‡å­—çš„é¢è¯•å®å…¸ï¼Œå¥½å¤šå°ä¼™ä¼´é è¿™ä¸ªå®å…¸æ‹¿åˆ°äº†å¤šå®¶å¤§å‚çš„offerã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Chrome devtoolsäºŒæ¬¡å¼€å‘å‡†å¤‡:è·å–æºç å’Œç¼–è¯‘]]></title>    <link>https://juejin.cn/post/7571678674144870410</link>    <guid>https://juejin.cn/post/7571678674144870410</guid>    <pubDate>2025-11-12T12:48:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571678674144870410" data-draft-id="7571704212850245683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Chrome devtoolsäºŒæ¬¡å¼€å‘å‡†å¤‡:è·å–æºç å’Œç¼–è¯‘"/> <meta itemprop="keywords" content="å‰ç«¯,Google"/> <meta itemprop="datePublished" content="2025-11-12T12:48:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sTone87375"/> <meta itemprop="url" content="https://juejin.cn/user/2946346894764584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Chrome devtoolsäºŒæ¬¡å¼€å‘å‡†å¤‡:è·å–æºç å’Œç¼–è¯‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2946346894764584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sTone87375
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T12:48:47.000Z" title="Wed Nov 12 2025 12:48:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Ubuntu ä¸Šè·å–å¹¶ç¼–è¯‘ Google Chrome DevTools Frontend æºç ï¼Œæœ‰ä¸¤ç§ä¸»æµæ–¹å¼ï¼š</p>
<ol>
<li>ç›´æ¥ä¸‹è½½å®˜æ–¹å·²ç»æ‰“å¥½åŒ…çš„ npm åŒ…ï¼ˆæœ€å¿«ï¼Œå…ç¼–è¯‘ï¼‰</li>
<li>ç”¨ Google çš„ depot_tools å®Œæ•´æ‹‰å– Chromium æºç å¹¶è‡ªè¡Œç¼–è¯‘ï¼ˆæœ€å®Œæ•´ï¼Œå¯äºŒæ¬¡å¼€å‘ï¼‰</li>
</ol>
<p>ä¸‹é¢åˆ†åˆ«ç»™å‡ºæ­¥éª¤ï¼Œä½ å¯ä»¥æŒ‰éœ€æ±‚äºŒé€‰ä¸€ã€‚</p>
<hr/>
<p>ä¸€ã€åªæƒ³â€œæ‹¿åˆ°å°±ç”¨â€â€”â€”ç”¨ npm åŒ…ï¼ˆå…ç¼–è¯‘ï¼‰
å®˜æ–¹å·²ç»æŠŠæ¯å¤©æ„å»ºå¥½çš„å‰ç«¯æ–‡ä»¶å‘å¸ƒåˆ° npmï¼Œè£…å®Œå°±èƒ½è·‘ã€‚</p>
<ol>
<li>
<p>å®‰è£…</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è£…åŒ…ï¼ˆç‰ˆæœ¬å·æ¯å¤©æ›´æ–°ï¼Œå¯å» npm æŸ¥æœ€æ–°ï¼‰</span>
npm i -g chrome-devtools-frontend@latest
<span class="hljs-comment"># è¿›å…¥åŒ…ç›®å½•</span>
<span class="hljs-built_in">cd</span> $(npm root -g)/chrome-devtools-frontend
</code></pre>
</li>
<li>
<p>èµ·é™æ€æœåŠ¡éªŒè¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»»æ„é™æ€æœåŠ¡å™¨å‡å¯</span>
npx http-server . -p 8081
</code></pre>
<p>æµè§ˆå™¨è®¿é—®</p>
<pre><code class="hljs language-bash" lang="bash">http://localhost:8081/front_end/devtools_app.html?ws=localhost:9229
</code></pre>
<p>åªè¦ 9229 ç«¯å£æœ‰ç¬¦åˆ CDP çš„ WebSocket æœåŠ¡ï¼Œå°±èƒ½æ­£å¸¸è°ƒè¯• ã€‚</p>
</li>
</ol>
<hr/>
<p>äºŒã€éœ€è¦â€œæºç çº§äºŒæ¬¡å¼€å‘â€â€”â€”å®Œæ•´æ‹‰å–å¹¶ç¼–è¯‘
é€‚åˆæƒ³æ”¹é¢æ¿ã€åŠ åŠŸèƒ½ã€è¿½æœ€æ–°ä¸»å¹²ä»£ç çš„åŒå­¦ã€‚</p>
<ol start="0">
<li>
<p>ç³»ç»Ÿä¾èµ–ï¼ˆUbuntu 22.04 ç¤ºä¾‹ï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt update
sudo apt install git python3 python3-venv pkg-config \
     build-essential ninja-build nodejs npm curl
</code></pre>
</li>
<li>
<p>å‡†å¤‡ depot_toolsï¼ˆGoogle çš„æ„å»ºå·¥å…·é“¾ï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://chromium.googlesource.com/chromium/tools/depot_tools.git
<span class="hljs-built_in">echo</span> <span class="hljs-string">'export PATH=$PATH:'</span><span class="hljs-string">"<span class="hljs-subst">$(pwd)</span>/depot_tools"</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">source</span> ~/.bashrc
</code></pre>
</li>
<li>
<p>æ‹‰å– DevTools Frontend æºç ï¼ˆçº¦ 1-2 GBï¼‰</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> devtools &amp;&amp; <span class="hljs-built_in">cd</span> devtools
fetch devtools-frontend     <span class="hljs-comment"># è¿™æ¡å‘½ä»¤æ¥è‡ª depot_tools</span>
<span class="hljs-built_in">cd</span> devtools-frontend
</code></pre>
</li>
<li>
<p>åŒæ­¥ä¾èµ–å¹¶ç”Ÿæˆæ„å»ºæ–‡ä»¶</p>
<pre><code class="hljs language-bash" lang="bash">gclient <span class="hljs-built_in">sync</span>                <span class="hljs-comment"># ç¬¬ä¸€æ¬¡ä¼šä¸‹è½½ Nodeã€Java è¿è¡Œæ—¶ç­‰ï¼Œéœ€ç§‘å­¦ä¸Šç½‘</span>
gn gen out/Default          <span class="hljs-comment"># ç”Ÿæˆ Ninja æ„å»ºæ–‡ä»¶</span>
</code></pre>
</li>
<li>
<p>ç¼–è¯‘ï¼ˆUbuntu ä¸Šçº¦ 5-10 åˆ†é’Ÿï¼Œè§† CPU è€Œå®šï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">autoninja -C out/Default    <span class="hljs-comment"># ç­‰ä»·äº ninja -C out/Defaultï¼Œä½†è‡ªåŠ¨å¹¶è¡Œ</span>
</code></pre>
<p>äº§ç‰©åœ¨</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">out</span><span class="hljs-operator">/</span><span class="hljs-keyword">Default</span><span class="hljs-operator">/</span>gen<span class="hljs-operator">/</span>front_end<span class="hljs-operator">/</span>
</code></pre>
<p>å³ä¸ºå¯è¿è¡Œçš„ DevTools å‰ç«¯ ã€‚</p>
</li>
<li>
<p>æœ¬åœ°é¢„è§ˆ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> out/Default/gen/front_end
npx http-server . -p 8081
</code></pre>
<p>æµè§ˆå™¨æ‰“å¼€</p>
<pre><code class="hljs language-bash" lang="bash">http://localhost:8081/devtools_app.html?ws=localhost:9229
</code></pre>
</li>
<li>
<p>è®©æœ¬åœ° Chrome é»˜è®¤ä½¿ç”¨ä½ ç¼–è¯‘çš„ç‰ˆæœ¬<br/>
å…³é—­æ‰€æœ‰ Chrome åå¯åŠ¨</p>
<pre><code class="hljs language-bash" lang="bash">google-chrome --custom-devtools-frontend=file://$(<span class="hljs-built_in">pwd</span>)/out/Default/gen/front_end
</code></pre>
<p>ä»¥åæŒ‰ F12 å°±ä¼šç›´æ¥åŠ è½½ä½ æ”¹è¿‡çš„é¢æ¿ ã€‚</p>
</li>
</ol>
<hr/>
<p>ä¸‰ã€å¸¸è§é—®é¢˜é€ŸæŸ¥</p>
<ul>
<li>
<p>ç½‘ç»œè¶…æ—¶ï¼š<br/>
<code>fetch</code> / <code>gclient</code> é˜¶æ®µéœ€è¦è®¿é—® Google æœåŠ¡å™¨ï¼ŒUbuntu ä¸‹å¯ç»™ç»ˆç«¯èµ°ä»£ç†</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890
</code></pre>
</li>
<li>
<p>ç¼–è¯‘æŠ¥é”™ç¼º headerï¼š<br/>
ä¸€èˆ¬æŠŠ <code>build-essential</code> å’Œ <code>pkg-config</code> è¡¥é½å³å¯ï¼›è‹¥ä»ç¼º <code>java/javac</code>ï¼Œå¯å†è£… <code>openjdk-11-jdk</code>ã€‚</p>
</li>
<li>
<p>åªæƒ³å®šæ—¶æ‹‰æœ€æ–°å®˜æ–¹æ„å»ºï¼Œè€Œä¸è‡ªå·±ç¼–ï¼š<br/>
å…³æ³¨ GitHub ä»“åº“ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faryasaatvik%2Fchrome-devtools-frontend-build" target="_blank" title="https://github.com/aryasaatvik/chrome-devtools-frontend-build" ref="nofollow noopener noreferrer">aryasaatvik/chrome-devtools-frontend-build</a> çš„ releasesï¼Œæ¯å‘¨è‡ªåŠ¨æ›´æ–°å·²ç¼–å¥½çš„åŒ…ï¼Œä¸‹è½½å³ç”¨ ã€‚</p>
</li>
</ul>
<hr/>
<p>ä¸€å¥è¯æ€»ç»“</p>
<ul>
<li>â€œå¿«é€Ÿä½“éªŒâ€ â†’ <code>npm i -g chrome-devtools-frontend</code> å³å¯ï¼›</li>
<li>â€œæ·±åº¦å®šåˆ¶â€ â†’ Ubuntu è£…å¥½ depot_tools â†’ <code>fetch devtools-frontend</code> â†’ <code>gn gen</code> â†’ <code>autoninja</code>ï¼Œå®Œäº‹å <code>out/Default/gen/front_end</code> å°±æ˜¯ä½ çš„ä¸“å±è°ƒè¯•å™¨å‰ç«¯ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿˜åœ¨ä¸ºHTMLè½¬PDFå‘æ„ï¼Ÿå†ä»‹ç»ä¸¤æ¬¾å·¥å…·ï¼Œä¸ºä½ ä¿é©¾æŠ¤èˆªï¼]]></title>    <link>https://juejin.cn/post/7571751304625569838</link>    <guid>https://juejin.cn/post/7571751304625569838</guid>    <pubDate>2025-11-13T02:12:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571751304625569838" data-draft-id="7571758212473749555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿˜åœ¨ä¸ºHTMLè½¬PDFå‘æ„ï¼Ÿå†ä»‹ç»ä¸¤æ¬¾å·¥å…·ï¼Œä¸ºä½ ä¿é©¾æŠ¤èˆªï¼"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-13T02:12:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SimonKing"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056904584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿˜åœ¨ä¸ºHTMLè½¬PDFå‘æ„ï¼Ÿå†ä»‹ç»ä¸¤æ¬¾å·¥å…·ï¼Œä¸ºä½ ä¿é©¾æŠ¤èˆªï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056904584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SimonKing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:12:55.000Z" title="Thu Nov 13 2025 02:12:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šã€ç¼–ç¨‹æœèŠ±å¤•æ‹¾ã€‘ï¼Œå¯è·å–é¦–å‘å†…å®¹ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42b0f46eac5946f38b0d0e83e709783b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=XGfEVYv7IQa%2FVvf9k20KoVYhHjw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">01 å¼•è¨€</h2>
<p>åœ¨ä¹‹å‰ä¸“é—¨å†™äº†ä¸€ç¯‡æ–‡ç« ã€Š<code>SpringBoot</code>é›†æˆï¼š5åˆ†é’Ÿå®ç°<code>HTML</code>è½¬<code>PDF</code>åŠŸèƒ½ã€‹ï¼Œä»‹ç»ä¸‰æ¬¾<code>Html</code>è½¬<code>PDF</code>çš„å·¥å…·ã€‚è¿™ä¸ï¼Œåˆå‘ç°äº†ä¸¤æ¬¾ç±»ä¼¼çš„å·¥å…·ï¼Œæ•´ç†ä¸€ä¸‹åˆ†äº«ç»™å¤§å®¶ã€‚</p>
<h2 data-id="heading-1">02 itext-pdfhtml-java</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/024171cf2f7344d68ee3351459f33583~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=GBk7ynYUKAr20K5UleVzP3Z9T7Q%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">2.1 ç®€ä»‹</h3>
<p><code>iText pdfHTML</code>æ˜¯<code>iText7</code>å¥—ä»¶çš„ä¸€ä¸ªé™„åŠ ç»„ä»¶ï¼Œä¸“é—¨ç”¨äºå°†<code>HTML</code>å’Œ<code>CSS</code>å†…å®¹è½¬æ¢ä¸º<code>PDF</code>æ–‡æ¡£ã€‚å®ƒåŸºäº<code>iText</code>æ ¸å¿ƒ<code>PDF</code>ç”Ÿæˆå¼•æ“ï¼Œæä¾›äº†é«˜è´¨é‡çš„<code>HTML</code>åˆ°<code>PDF</code>è½¬æ¢åŠŸèƒ½ã€‚æ€§èƒ½è¡¨ç°éå¸¸ä¼˜å¼‚ã€‚</p>
<p>ä¸»è¦ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>å®Œæ•´çš„<code>HTML5</code>å’Œ<code>CSS3</code>æ”¯æŒ</strong>ï¼šèƒ½å¤Ÿå¤„ç†ç°ä»£ç½‘é¡µå¸ƒå±€å’Œæ ·å¼</li>
<li><strong>å­—ä½“åµŒå…¥</strong>ï¼šè‡ªåŠ¨å¤„ç†Webå­—ä½“å’Œç³»ç»Ÿå­—ä½“</li>
<li><strong>å“åº”å¼è®¾è®¡</strong>ï¼šæ”¯æŒåª’ä½“æŸ¥è¯¢å’Œå“åº”å¼å¸ƒå±€</li>
<li><strong>é«˜ä¿çœŸè½¬æ¢</strong>ï¼šä¿æŒHTMLå†…å®¹çš„è§†è§‰ä¿çœŸåº¦</li>
<li><strong>JavaåŸç”Ÿ</strong>ï¼šä¸“ä¸ºJavaç”Ÿæ€ç³»ç»Ÿè®¾è®¡</li>
</ul>
<p><code>GitHub</code>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fitext%2Fitext-pdfhtml-java" target="_blank" title="https://github.com/itext/itext-pdfhtml-java" ref="nofollow noopener noreferrer">github.com/itext/itextâ€¦</a></p>
<p>å®˜æ–¹åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fitextpdf.com%2Fproducts%2Fconvert-html-css-to-pdf-pdfhtml" target="_blank" title="https://itextpdf.com/products/convert-html-css-to-pdf-pdfhtml" ref="nofollow noopener noreferrer">itextpdf.com/products/coâ€¦</a></p>
<h3 data-id="heading-3">2.2 æ¡ˆä¾‹</h3>
<p>ä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸ç®€å•ï¼Œä¸‹é¢å®˜æ–¹çš„æ¡ˆä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca4a7ca81d0d437d9377dd672981f93a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=n%2BufL%2FAX17Q1IJJb4bV64o6Je6A%3D" alt="" loading="lazy"/></p>
<p><strong>Mavenä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itextpdf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>html2pdf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>å®è·µä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequestMapping("index6")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">index6</span><span class="hljs-params">(Model model, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
    List&lt;Map&lt;String, Object&gt;&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        Map&lt;String, Object&gt; item = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        item.put(<span class="hljs-string">"image1"</span>, <span class="hljs-string">"http://example.com/2eb97.jpg"</span>);
        item.put(<span class="hljs-string">"image2"</span>, <span class="hljs-string">"http://example.com/2f9c3.jpg"</span>);
        item.put(<span class="hljs-string">"vehicleName"</span>, <span class="hljs-string">"è·¯è™Defenderï¼»å«å£«ï¼½ï¼ˆè¿›å£ï¼‰2023æ¬¾Defender130 48Vï¼»å«å£« 130 48V] 3.0Tæ‰‹è‡ªï¼ä½“P400 HSE"</span>);
        item.put(<span class="hljs-string">"brandName"</span>, <span class="hljs-string">"è·¯è™"</span>);
        item.put(<span class="hljs-string">"seriesName"</span>, <span class="hljs-string">"Defenderï¼»å«å£«ï¼½"</span>);
        item.put(<span class="hljs-string">"modelYear"</span>, <span class="hljs-string">"2023æ¬¾"</span>);
        item.put(<span class="hljs-string">"licenseYear"</span>, SDF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
        item.put(<span class="hljs-string">"displayMileage"</span>, DF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"9657"</span>)));
        item.put(<span class="hljs-string">"dealDate"</span>, SDF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
        item.put(<span class="hljs-string">"dealPrice"</span>, DF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"702400"</span>)));

        item.put(<span class="hljs-string">"licenseCode"</span>, <span class="hljs-string">"æ²ªA952714"</span>);

        list.add(item);
    }
    model.addAttribute(<span class="hljs-string">"list"</span>, list);
    Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    map.put(<span class="hljs-string">"list"</span>, list);

    <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>(Locale.getDefault(), map);
    <span class="hljs-type">String</span> <span class="hljs-variable">htmlContent</span> <span class="hljs-operator">=</span> templateEngine.process(<span class="hljs-string">"index"</span>, context);
    System.out.println(htmlContent);

    <span class="hljs-comment">// ---------------------------------------------------</span>
    <span class="hljs-comment">/*itext-html2pdf*/</span>
    <span class="hljs-type">ConverterProperties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConverterProperties</span>();

    <span class="hljs-type">FontProvider</span> <span class="hljs-variable">fontProvider</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FontProvider</span>();
    fontProvider.addSystemFonts();
<span class="hljs-comment">//        fontProvider.addFont("C:\\Windows\\Fonts\\simhei.ttf");</span>
    <span class="hljs-comment">// æ·»åŠ ç³»ç»Ÿå­—ä½“</span>
    properties.setFontProvider(fontProvider);

    HtmlConverter.convertToPdf(htmlContent, response.getOutputStream(), properties);
}
</code></pre>
<p>åŒæ ·é»˜è®¤æ˜¯ä¸æ”¯æŒä¸­æ–‡çš„ï¼Œéœ€è¦é€šè¿‡<code>FontProvider</code>æ·»åŠ æŒ‡å®šçš„å­—ä½“ã€‚<code>fontProvider.addSystemFonts();</code>ç›´æ¥æ·»åŠ ç³»ç»Ÿå­—ä½“ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>addFont()</code>æ·»åŠ è‡ªå®šä¹‰å­—ä½“ã€‚é¡µé¢å¿…é¡»å£°æ˜å­—ä½“ï¼Œå¦åˆ™ä¼šå‡ºç°ä¹±ç ã€‚</p>
<h2 data-id="heading-4">03 x-easypdf</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f789e0271ef646d08c9ff65b1d160004~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=MzcOsM2iWen1FdY%2FiDzfn9hrK68%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">3.1 ç®€ä»‹</h3>
<p><code>x-easypdf</code>æ˜¯ä¸€ä¸ª<code>java</code>è¯­è¨€ç®€åŒ–å¤„ç†<code>pdf</code>çš„æ¡†æ¶ï¼ŒåŒ…å«<code>fop</code>æ¨¡å—ä¸<code>pdfbox</code>æ¨¡å—ï¼Œ<code>fop</code>æ¨¡å—ä»¥åˆ›å»ºåŠŸèƒ½ä¸ºä¸»ï¼ŒåŸºäº<code>xsl-fo</code>æ¨¡æ¿ç”Ÿæˆ<code>pdf</code>æ–‡æ¡£ï¼Œä»¥æ•°æ®æºçš„æ–¹å¼è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ï¼›<code>pdfbox</code>æ¨¡å—ä»¥ç¼–è¾‘åŠŸèƒ½ä¸ºä¸»ï¼Œå¯¹æ ‡å‡†çš„<code>pdfbox</code>è¿›è¡Œæ‰©å±•ï¼Œæ·»åŠ äº†æˆå¨çš„åŠŸèƒ½ã€‚</p>
<p><code>Html</code>è½¬<code>Pdf</code>æ˜¯<code>pdfbox</code>æ¨¡å—ä¸‹çš„ä¸€ä¸ªè½¬åŒ–å™¨çš„åŠŸèƒ½ï¼Œæ˜¯åŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fjava%2Fdocs%2Fintro" target="_blank" title="https://playwright.dev/java/docs/intro" ref="nofollow noopener noreferrer">playwright</a> å®ç°çš„ã€‚è€Œ<code>playwright</code>çš„ä¾èµ–éœ€è¦æ‰‹åŠ¨å¼•å…¥ã€‚<code>Playwright</code>æ˜¯ä¸€ä¸ªè·¨è¯­è¨€çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–åº“ï¼Œç”±<code>Microsoft</code>å¼€å‘ã€‚è™½ç„¶ä¸»è¦ç”¨äºç«¯åˆ°ç«¯æµ‹è¯•ï¼Œä½†å…¶å¼ºå¤§çš„<code>PDF</code>ç”ŸæˆåŠŸèƒ½ä¹Ÿä½¿å…¶æˆä¸º<code>HTML</code>è½¬<code>PDF</code>çš„ä¼˜ç§€å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92d45b8a6e1b4e38b12f17cd8b94a417~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=auTpCKZiPq%2B8JF%2BTr%2B%2BXDxLnfnE%3D" alt="" loading="lazy"/></p>
<p><code>Gitee</code>åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdromara%2Fx-easypdf" target="_blank" title="https://gitee.com/dromara/x-easypdf" ref="nofollow noopener noreferrer">gitee.com/dromara/x-eâ€¦</a></p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fx-easypdf.cn%2F" target="_blank" title="https://x-easypdf.cn/" ref="nofollow noopener noreferrer">x-easypdf.cn/</a></p>
<h3 data-id="heading-6">3.2 æ¡ˆä¾‹</h3>
<p><code>x-easypdf</code>æ˜¯å¯¹<code>playwrigh</code>çš„åŠŸèƒ½åšäº†ä¸€å±‚åŒ…è£…ï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</p>
<p><strong>Mavenä¾èµ–</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.dromara<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>x-easypdf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.playwright<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>playwright<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.53.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>å®è·µä»£ç 01</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequestMapping("index10")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">index10</span><span class="hljs-params">(HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-comment">// è·å–htmlè½¬æ¢å™¨</span>
    <span class="hljs-type">HtmlConvertor</span> <span class="hljs-variable">convertor</span> <span class="hljs-operator">=</span> PdfHandler.getDocumentConvertor().getHtmlConvertor();
    <span class="hljs-type">Document</span> <span class="hljs-variable">pdf</span> <span class="hljs-operator">=</span> convertor.toPdf(<span class="hljs-string">"http://127.0.0.1:8080/page/index"</span>);
    pdf.save(response.getOutputStream());
}
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<p><code>playwrigh</code>æ˜¯åŸºäºæµè§ˆå™¨å¼•æ“çš„ï¼Œé¦–æ¬¡è°ƒç”¨ä¼šä¸‹è½½é»˜è®¤çš„æµè§ˆå™¨ï¼Œä¸‹è½½å®Œæˆä¹‹åï¼Œåç»­çš„ä½¿ç”¨å°±æµç•…äº†ã€‚è€Œä¸”é»˜è®¤æ”¯æŒä¸­æ–‡ï¼Œå› ä¸ºä½¿ç”¨æµè§ˆå™¨å¼•æ“ï¼Œæ‰€ä»¥å¯¹äº<code>Html</code>å’Œ<code>Css</code>æ”¯æŒè¾ƒå¥½ã€‚ä½†æ˜¯æ¶ˆè€—èµ„æºè¾ƒé«˜ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œ<code>convertor.toPdf()</code>ç›®å‰æ”¯æŒä¼ å…¥åœ°å€å’Œæ–‡ä»¶ã€‚ä¸æ”¯æŒç›´æ¥<code>html</code>å†…å®¹ç›´æ¥è½¬åŒ–çš„ã€‚ä½†æ˜¯<code>playwrigh</code>æœ¬èº«æ˜¯æ”¯æŒçš„ã€‚</p>
<p>å°ç¼–å·²ç»ç»™<code>x-easypdf</code>ä½œè€…æäº†<code>issues</code>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fdromara%2Fx-easypdf%2Fissues%2FID59TK" target="_blank" title="https://gitee.com/dromara/x-easypdf/issues/ID59TK" ref="nofollow noopener noreferrer">gitee.com/dromara/x-eâ€¦</a></p>
<p>**æ³¨æ„ï¼š**æˆªæ­¢å‘ç¨¿ï¼Œå®˜æ–¹å·²ç»åœ¨<code>3.5.0</code>ç‰ˆæœ¬æ”¯æŒäº†<code>html</code>å†…å®¹è½¬<code>Pdf</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d21ec3c6eb54a7daec64c339549b078~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=7kcF1hIUJPoWys6g%2FV4yWOgDTtA%3D" alt="" loading="lazy"/></p>
<p><strong>å®æˆ˜ä»£ç 02</strong></p>
<p>ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„æ–¹å¼ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90c01f3689904b9ab9a5bb5301649a2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763604775&amp;x-signature=2pIfLVnU7TbdmZd1c3Q33%2BohlO4%3D" alt="" loading="lazy"/></p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fx-easypdf.cn%2Fguide%2Fpdfbox%2Fadvance%2Ftemplater%2F%25E6%25A8%25A1%25E6%259D%25BF%25E5%25BC%2595%25E6%2593%258E.html%23thymeleaf" target="_blank" title="https://x-easypdf.cn/guide/pdfbox/advance/templater/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E.html#thymeleaf" ref="nofollow noopener noreferrer">x-easypdf.cn/guide/pdfboâ€¦</a></p>
<p>ä¾ç„¶æ˜¯å»ºç«‹åœ¨<code>playwrigh</code>åŸºç¡€ä¹‹ä¸Šã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequestMapping("index12")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">index12</span><span class="hljs-params">(HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
    List&lt;Map&lt;String, Object&gt;&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        Map&lt;String, Object&gt; item = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        item.put(<span class="hljs-string">"image1"</span>, <span class="hljs-string">"http://example.com/2eb97.jpg"</span>);
        item.put(<span class="hljs-string">"image2"</span>, <span class="hljs-string">"http://example.com/2f9c3.jpg"</span>);
        item.put(<span class="hljs-string">"vehicleName"</span>, <span class="hljs-string">"è·¯è™Defenderï¼»å«å£«ï¼½ï¼ˆè¿›å£ï¼‰2023æ¬¾Defender130 48Vï¼»å«å£« 130 48V] 3.0Tæ‰‹è‡ªï¼ä½“P400 HSE"</span>);
        item.put(<span class="hljs-string">"brandName"</span>, <span class="hljs-string">"è·¯è™"</span>);
        item.put(<span class="hljs-string">"seriesName"</span>, <span class="hljs-string">"Defenderï¼»å«å£«ï¼½"</span>);
        item.put(<span class="hljs-string">"modelYear"</span>, <span class="hljs-string">"2023æ¬¾"</span>);
        item.put(<span class="hljs-string">"licenseYear"</span>, SDF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
        item.put(<span class="hljs-string">"displayMileage"</span>, DF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"9657"</span>)));
        item.put(<span class="hljs-string">"dealDate"</span>, SDF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
        item.put(<span class="hljs-string">"dealPrice"</span>, DF.format(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"702400"</span>)));

        item.put(<span class="hljs-string">"licenseCode"</span>, <span class="hljs-string">"æ²ªA952714"</span>);

        list.add(item);
    }
    Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    map.put(<span class="hljs-string">"list"</span>, list);

    <span class="hljs-type">ThymeleafTemplater</span> <span class="hljs-variable">templater</span> <span class="hljs-operator">=</span> PdfHandler.getDocumentTemplater().getThymeleafTemplater();
    templater.setTemplatePath(<span class="hljs-string">"templates"</span>);
    templater.setTemplateName(<span class="hljs-string">"index.html"</span>);
    templater.setTemplateData(map);

    <span class="hljs-comment">// è·å– html å†…å®¹</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> templater.getHtmlContent();
    System.out.println(content);

    <span class="hljs-comment">// è½¬æ¢æ–‡æ¡£</span>
    <span class="hljs-type">Document</span> <span class="hljs-variable">document</span> <span class="hljs-operator">=</span> templater.transform();
    document.save(response.getOutputStream());
}
</code></pre>
<p>è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼šç”±äº<code>x-easypdf</code>è‡ªè¡Œè§£æäº†<code>Thymeleaf</code>æ¨¡ç‰ˆï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨<code>spring-boot-starter-thymeleaf</code>çš„é…ç½®ã€‚<code>templatePath</code>å’Œ<code>templateName</code>éƒ½éœ€è¦å†™å®Œæ•´ã€‚<code>templatePath</code>æŒ‡<code>classpath</code>ä¸‹çš„è·¯å¾„ã€‚</p>
<p>æ¨¡æ¿å¼•æ“å¯èƒ½ä¼šå‡ºç°<code>nested exception is java.lang.NoClassDefFoundError: ognl/PropertyAccessor</code>çš„é”™è¯¯ï¼Œéœ€è¦å¼•å…¥<code>ognl</code>ï¼Œä¸”ç‰ˆæœ¬ä¸èƒ½è¶…è¿‡<code>3.2</code>ã€‚ä» <code>3.2</code> å¼€å§‹ï¼Œä¼šæŠ¥<code>java.lang.NoClassDefFoundError: ognl/DefaultMemberAccess</code>ã€‚æœ‰æ•ˆç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ognl<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ognl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.28<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>è¾¹è·å¯ä»¥é€šè¿‡æ‰“å°æ ·å¼æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@page</span> {
    size: A4;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span>;
}
</code></pre>
<h3 data-id="heading-7">3.3 <code>playwrigh</code>åŸç”Ÿå†™æ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequestMapping("index11")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">index11</span><span class="hljs-params">(HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">try</span> (<span class="hljs-type">Playwright</span> <span class="hljs-variable">playwright</span> <span class="hljs-operator">=</span> Playwright.create();
         <span class="hljs-type">Browser</span> <span class="hljs-variable">browser</span> <span class="hljs-operator">=</span> playwright.chromium().launch()) {
        <span class="hljs-type">BrowserContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> browser.newContext();
        <span class="hljs-type">Page</span> <span class="hljs-variable">page</span> <span class="hljs-operator">=</span> context.newPage();

        <span class="hljs-comment">// ä»HTMLå†…å®¹ç”ŸæˆPDF</span>
        page.setContent(<span class="hljs-string">"&lt;h1&gt;Hello, Playwright!&lt;/h1&gt;"</span>);
        <span class="hljs-type">byte</span>[] pdf = page.pdf();

        <span class="hljs-type">ByteArrayInputStream</span> <span class="hljs-variable">bais</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(pdf);
        IOUtils.copy(bais, response.getOutputStream());
    }
}
</code></pre>
<h2 data-id="heading-8">04 å°ç»“</h2>
<p><code>iText pdfHTML</code>å†…å­˜å ç”¨ä½ï¼Œè½¬æ¢é€Ÿåº¦å¿«ï¼Œé€‚åˆæœåŠ¡å™¨ç«¯æ‰¹é‡å¤„ç†ã€‚è€Œ<code>Playwright</code>éœ€è¦æ›´å¤šèµ„æºï¼Œä½†æ¸²æŸ“è´¨é‡æé«˜ï¼Œé€‚åˆå¯¹è§†è§‰ä¿çœŸåº¦è¦æ±‚é«˜çš„åœºæ™¯ï¼Œæ‰€ä»¥<code>x-easypdf</code>ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å¦‚æœåªæ˜¯é’ˆå¯¹<code>Html</code>è½¬<code>Pdf</code>çš„æœåŠ¡ç«¯è½¬åŒ–çš„åœºæ™¯<code>iText pdfHTML</code>çš„ä¼˜åŠ¿æ›´æ˜æ˜¾ä¸€ä¸‹ï¼Œå…³é”®å®ƒå¿«ï¼</p>
<p>ä¹Ÿæœ‰ç²‰ä¸æœ‹å‹ç•™è¨€è¯´<code>jasperreports</code>ä¹Ÿå¾ˆå¥½ç”¨ï¼Œå°ç¼–ä¹Ÿè¯•äº†ä¸€ä¸‹ã€‚<code>jasperreports</code>éœ€è¦åŠ è½½ç‰¹å®šçš„æ¨¡æ¿ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œç”¨èµ·æ¥æ„Ÿè§‰æœ‰ç‚¹åˆ«æ‰­ã€‚è¿™é‡Œå°±ä¸æ¨èäº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»è¯•è¯•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Valdiâ€”â€”ä¸€ä¸ªæä¾›åŸç”Ÿæ€§èƒ½çš„è·¨å¹³å° UI æ¡†æ¶]]></title>    <link>https://juejin.cn/post/7571646669201899562</link>    <guid>https://juejin.cn/post/7571646669201899562</guid>    <pubDate>2025-11-12T12:09:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571646669201899562" data-draft-id="7571678388953923603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Valdiâ€”â€”ä¸€ä¸ªæä¾›åŸç”Ÿæ€§èƒ½çš„è·¨å¹³å° UI æ¡†æ¶"/> <meta itemprop="keywords" content="UI Kit"/> <meta itemprop="datePublished" content="2025-11-12T12:09:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿™å„¿æœ‰ä¸€å †èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/3076912575965819"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Valdiâ€”â€”ä¸€ä¸ªæä¾›åŸç”Ÿæ€§èƒ½çš„è·¨å¹³å° UI æ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3076912575965819/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿™å„¿æœ‰ä¸€å †èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T12:09:09.000Z" title="Wed Nov 12 2025 12:09:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffd2aef487764ddea9991cb145d12823~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-Z5YS_5pyJ5LiA5aCG6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763554149&amp;x-signature=hy5qLlMfngLqhsBcuqNTafg%2BSN8%3D" alt="è¿‘è·ç¦»ä»£ç å±å¹•" loading="lazy"/></p>
<p>ä»ä¸€ä¸ªæ—¥æŠ¥èµ·å¤´ï¼šç§»åŠ¨ç«¯å›¢é˜Ÿè¢«è¦æ±‚åœ¨ä¸¤å‘¨é‡ŒæŠŠæ´»åŠ¨é¡µåŒæ—¶ä¸Šçº¿ iOSã€Android å’Œ macOSã€‚æ—¶é—´ç´§ï¼Œäº¤äº’ç»†ï¼ŒåŠ¨ç”»è¿˜ä¸èƒ½æ‰å¸§ã€‚ä¼ ç»Ÿè§£æ³•è¦ä¹ˆå†™ä¸‰å¥—åŸç”Ÿç•Œé¢ï¼Œè¦ä¹ˆèµ°â€œWeb å®¹å™¨â€å–å·§ï¼Œç»“æœè¦ä¹ˆå¼€å‘æ•ˆç‡åƒç´§ï¼Œè¦ä¹ˆæ€§èƒ½æ‰“æŠ˜ã€‚æ­¤æ—¶ï¼Œä¸€ä¸ªåå­—è¿‘ä¹ä½è°ƒçš„æ¡†æ¶é—¯è¿›è§†é‡â€”â€”<strong>Valdi</strong>ã€‚å®ƒæŠŠç•Œé¢çš„å£°æ˜å¼å†™æ³•ç•™åœ¨ TypeScriptï¼ŒæŠŠæ¸²æŸ“æƒäº¤ç»™å¹³å°åŸç”Ÿè§†å›¾ï¼Œè¯•å›¾æŠŠâ€œæ•ˆç‡ä¸æ€§èƒ½åªèƒ½äºŒé€‰ä¸€â€çš„æ—§é€»è¾‘ç¿»è¿‡æ¥ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<h2 data-id="heading-0">å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆ</h2>
<p>å®˜æ–¹ç»™å‡ºçš„å®šä¹‰éå¸¸ç›´æ¥ï¼šä½¿ç”¨ <strong>å£°æ˜å¼ TypeScript/TSX</strong> å†™ UIï¼Œ<strong>ç¼–è¯‘ä¸º iOSã€Androidã€macOS çš„åŸç”Ÿè§†å›¾</strong>ï¼Œ<strong>ä¸ä¾èµ– WebViewï¼Œä¹Ÿæ²¡æœ‰ä¼ ç»Ÿ JS bridge</strong>ã€‚å› æ­¤ï¼Œåˆ—è¡¨æ»šåŠ¨ã€å¤æ‚æ‰‹åŠ¿ã€ç³»ç»Ÿçº§åŠ¨ç”»éƒ½æ²¿ç”¨åŸç”Ÿè¡¨ç°ï¼Œé¿å…â€œè·¨å¹³å°å±‚â€æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚è¯¥æ¡†æ¶åœ¨ Snap çš„ç”Ÿäº§ç¯å¢ƒå·²ç»é•¿æœŸæœå½¹ï¼ˆå†…éƒ¨ä½¿ç”¨è¾¾æ•°å¹´ï¼‰ï¼Œå¦‚ä»Šä»¥ <strong>MIT</strong> è®¸å¯è¯å¼€æºï¼Œå½“å‰å¯¹å¤–æ ‡æ³¨ä¸º <strong>Beta</strong>ï¼ˆä¸»è¦æ˜¯æ–‡æ¡£ä¸å·¥å…·é“¾ä»åœ¨å¯¹å¼€æºç”Ÿæ€æ‰“ç£¨ï¼‰ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<p><strong>Valdi GitHub</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2FK42TvQ" target="_blank" title="https://jovial-fortune.com/K42TvQ" ref="nofollow noopener noreferrer">github.com/Snapchat/Vaâ€¦</a></p>
<h2 data-id="heading-1">å†™æ³•é•¿ä»€ä¹ˆæ ·</h2>
<p>åœ¨ Valdi é‡Œï¼Œç•Œé¢è¢«å†™æˆ TSX ç»„ä»¶ã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†â€œå£°æ˜â€”æ¸²æŸ“â€”å±æ€§â€è¿™ä¸€å¥—ç›´è§‰å¼æµç¨‹ï¼ˆè¯­ä¹‰ä¸å®˜æ–¹ç¤ºä¾‹ä¸€è‡´ï¼Œä½†åšäº†é€‚åº¦è£å‰ªä¸æ³¨é‡Šï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// HelloWorld.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'valdi_core/src/Component'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> {
  <span class="hljs-title function_">onRender</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> message = <span class="hljs-string">'Hello Valdi'</span>;
    <span class="hljs-comment">// è¿™é‡Œçš„ &lt;view&gt;ã€&lt;label&gt; ä¼šè¢«ç¼–è¯‘æˆå¹³å°åŸç”Ÿè§†å›¾ï¼ˆé WebViewï¼‰</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">backgroundColor</span>=<span class="hljs-string">"#FFFC00"</span> <span class="hljs-attr">padding</span>=<span class="hljs-string">{24}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"black"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{message}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>;
  }
}
</code></pre>
<p>è¿™ç§å†™æ³•çš„å…³é”®ä¸åœ¨â€œçœ‹èµ·æ¥åƒ Reactâ€ï¼Œè€Œåœ¨â€œ<strong>æœ€ç»ˆè½åœ°çš„æ˜¯åŸç”Ÿæ§ä»¶</strong>â€ã€‚æ¸²æŸ“å±‚çš„å·¥ä½œäº¤ç»™å¹³å°æœ¬èº«ï¼Œæ¡†æ¶åˆ™åœ¨ç¼–è¯‘æœŸä¸è¿è¡ŒæœŸå¼€å¯ä¸€ç³»åˆ—æ€§èƒ½æ‰‹æ®µï¼ˆè§†å›¾æ± å¤ç”¨ã€æŒ‰å¯è§†åŒºåŸŸå¢é‡æ¸²æŸ“ã€ç»„ä»¶çº§åˆ«çš„ç‹¬ç«‹é‡æ¸²ï¼‰ï¼Œå°½é‡ä¸æŠŠé‡è´Ÿç•™åœ¨è·¨å±‚é€šä¿¡ä¸Šã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<p><strong>Valdi æ–‡æ¡£ä¸å…¥é—¨</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2Fb.3-VN0%2FP%2F3Np%2FvObOmBVmJvZ%2FDA0%2F2HMoD%2FQDw%2FNjDJAH3%2FL%2FTyYzwpNXD%2FA_0rM-Dtgj" target="_blank" title="https://jovial-fortune.com/b.3-VN0/P/3Np/vObOmBVmJvZ/DA0/2HMoD/QDw/NjDJAH3/L/TyYzwpNXD/A_0rM-Dtgj" ref="nofollow noopener noreferrer">github.com/Snapchat/Vaâ€¦</a>**</p>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆåœ¨æ„â€œåŸç”Ÿæ€§èƒ½â€</h2>
<p>è·¨å¹³å° UI çš„å†å²é‡Œï¼Œæ€§èƒ½é—®é¢˜å¾€å¾€æ¥è‡ªä¸¤å¤„ï¼š
å…¶ä¸€æ˜¯ <strong>æ¸²æŸ“å®¹å™¨</strong>â€”â€”WebView æˆ–è‡ªç»˜å¼•æ“åœ¨â€œè´´è¿‘ç³»ç»Ÿâ€ä¸Šå¤©ç”Ÿåƒäºï¼›å…¶äºŒæ˜¯ <strong>æ¡¥æ¥æˆæœ¬</strong>â€”â€”å½“çŠ¶æ€é¢‘ç¹å˜åŠ¨ã€åŠ¨ç”»å¯†é›†ã€åˆ—è¡¨è¶…é•¿æ—¶ï¼Œè·¨è¯­è¨€/è·¨è¿›ç¨‹é€šä¿¡ä¼šå˜æˆéšå½¢ç¨ã€‚Valdi çš„è·¯å¾„æ˜¯**â€œæŠŠ UI ç¼–è¯‘æˆåŸç”Ÿæ§ä»¶â€**ï¼Œå¹¶å›´ç»•è¿™ä¸ªè½ç‚¹åšä¼˜åŒ–ï¼š</p>
<ul>
<li>å…¨å±€ <strong>è§†å›¾æ± </strong> å›æ”¶ä¸å¤ç”¨ï¼Œé™ä½è§†å›¾åˆ›å»º/é”€æ¯æˆæœ¬ï¼›</li>
<li><strong>ç‹¬ç«‹ç»„ä»¶é‡æ¸²</strong>ï¼Œé¿å…ç¥–å…ˆèŠ‚ç‚¹æ— è°“æ›´æ–°ï¼›</li>
<li><strong>å¯è§†åŒºåŸŸæ„ŸçŸ¥</strong> å¸ƒå±€ä¸æ¸²æŸ“ï¼Œå¤©ç”Ÿé€‚é…é•¿åˆ—è¡¨ä¸åˆ†é¡µï¼›</li>
<li>å¸ƒå±€å¼•æ“ä»¥ <strong>C++</strong> å®ç°å¹¶è¿è¡Œåœ¨ä¸»çº¿ç¨‹ï¼Œå‡å°‘è·¨å±‚ç¼–ç»„ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</li>
</ul>
<p>è¿™äº›ç‚¹ä¸æ˜¯èŠ±æ‹³ç»£è…¿ï¼Œè€Œæ˜¯ç§»åŠ¨ç«¯è€—æ—¶çƒ­ç‚¹çš„â€œç›´çº¿çªå‡»â€ã€‚åœ¨ä¿¡æ¯æµã€å•†åŸã€æ¶ˆæ¯ç±»åº”ç”¨ä¸­å°¤å…¶æ˜æ˜¾ï¼šé¦–å±æ›´å¿«å‡ºç°ï¼Œæ»šåŠ¨æ›´ç¨³ï¼Œæ»‘åŠ¨æ‰‹æ„Ÿæ›´æ¥è¿‘ç³»ç»ŸåŸç”Ÿæ§ä»¶ã€‚</p>
<h2 data-id="heading-3">å·¥ç¨‹åŒ–ä¸å¼€å‘ä½“éªŒ</h2>
<p>æ•ˆç‡å±‚é¢ï¼ŒValdi ä¸åªæ˜¯åœ¨è¯­æ³•ä¸Šâ€œåƒ Reactâ€ã€‚å®ƒè¾…ä»¥ <strong>å³æ—¶çƒ­é‡è½½</strong>ï¼ˆæ¯«ç§’çº§è§æ•ˆï¼‰ã€<strong>VS Code è°ƒè¯•ä¸æ€§èƒ½å‰–æ</strong>ã€ä¸ <strong>Bazel</strong> çš„é›†æˆä»¥ä¿éšœæ„å»ºå¤ç”¨ä¸å¯é‡å¤ã€‚éœ€è¦åŸç”Ÿæ¥å£æ—¶ï¼Œå¯é€šè¿‡ <strong>å¤šè¯­è¨€æ¨¡å—ï¼ˆPolyglot Modulesï¼‰</strong> ç”Ÿæˆ <strong>TypeScript â†” Kotlin/Swift/ObjC</strong> çš„ç±»å‹å®‰å…¨ç»‘å®šï¼Œæ—¢èƒ½å¤ç”¨æ—¢æœ‰åŸç”Ÿåº“ï¼Œåˆèƒ½æŠŠæ€§èƒ½å…³é”®è·¯å¾„ç•™åœ¨åŸç”Ÿä¾§å®ç°ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<p><strong>Bazel</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2FK42TvQ" target="_blank" title="https://jovial-fortune.com/K42TvQ" ref="nofollow noopener noreferrer">bazel.build/</a></p>
<h2 data-id="heading-4">è¿ç§»ä¸è½åœ°çš„â€œæ•…äº‹çº¿â€</h2>
<p>ä¸€ä¸ªå¸¸è§è½åœ°é¡ºåºæ˜¯è¿™æ ·çš„ï¼š
å…ˆæŠŠä¸€ä¸ª<strong>ç‹¬ç«‹é¡µé¢</strong>æˆ–<strong>æ–°åŠŸèƒ½å…¥å£</strong>ç”¨ Valdi é‡å†™ï¼Œå†…åµŒåˆ° UIKit/Android View çš„æ ‘é‡Œåš A/Bï¼›æ€§èƒ½éªŒè¯åï¼Œå†é€æ­¥æ‰©å¤§æ¥å…¥é¢ã€‚æ­¤æ—¶ï¼ŒåŸç”Ÿä¸ Valdi çš„<strong>åŒå‘åµŒå…¥</strong>èƒ½åŠ›ï¼ˆâ€œåœ¨åŸç”Ÿé‡Œæ”¾ Valdi è§†å›¾â€ä¸â€œåœ¨ Valdi é‡ŒåµŒåŸç”Ÿæ§ä»¶â€ï¼‰å°±åƒå®‰å…¨å¸¦ï¼Œæ—¢ä¸ç ´åæ—¢æœ‰å·¥ç¨‹ï¼Œåˆç»™æ–°æ ˆè¶³å¤Ÿçš„å‘æŒ¥ç©ºé—´ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<p>åœ¨æ•°æ®é€šè·¯ä¸Šï¼Œå›¢é˜Ÿå¯ä»¥æŠŠç½‘ç»œå±‚ã€å›¾ç‰‡åŠ è½½ã€åŸ‹ç‚¹ç­‰ç»§ç»­ç•™åœ¨åŸç”Ÿæ¨¡å—é‡Œï¼Œé€šè¿‡ç±»å‹å®‰å…¨çš„ç»‘å®šæš´éœ²ç»™ TypeScriptã€‚è¾ƒé‡çš„è®¡ç®—ï¼ˆå¦‚åè®®ç¼–è§£ç ã€å¤æ‚ diffã€åª’ä½“ç®¡çº¿ï¼‰å¯ä»¥èµ° C++ æˆ–å¹³å°åŸç”Ÿè¯­è¨€ï¼›Valdi æä¾›çš„ <strong>worker çº¿ç¨‹</strong> èƒ½è®© JS ä¾§åœ¨ä¸é˜»å¡ UI çš„æƒ…å†µä¸‹å®Œæˆéƒ¨åˆ†å¹¶è¡Œä»»åŠ¡ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<h2 data-id="heading-5">ä¸â€œåˆ«çš„è·¨å¹³å°â€çš„å·®å¼‚</h2>
<ul>
<li>ä¸ <strong>WebView ç³»</strong>ï¼ˆHybrid/H5ï¼‰ä¸åŒï¼šæ¸²æŸ“ä¸æ˜¯ç½‘é¡µï¼ŒUI ä¸æ˜¯ DOMï¼›å› æ­¤æ»šåŠ¨ã€æ‰‹åŠ¿ã€å¯¼èˆªæ¡è¿™ç±»ç³»ç»Ÿå…ƒç´ æ›´è´´è¿‘å¹³å°æœŸæœ›ã€‚</li>
<li>ä¸ <strong>æ¡¥æ¥å¼ JS Runtime</strong>ï¼ˆé‡åº¦ä¾èµ–æ¡¥çš„æ–¹æ¡ˆï¼‰ä¸åŒï¼šValdi é€šè¿‡ç¼–è¯‘æœŸæŠŠâ€œå£°æ˜å¼æ ‘â€é™è§£ä¸ºåŸç”Ÿè§†å›¾ï¼Œå¹¶å°½é‡åœ¨æ¸²æŸ“ä¸å¸ƒå±€é˜¶æ®µå‡å°‘è·¨å±‚é€šä¿¡é¢‘ç‡ã€‚</li>
<li>ä¸ <strong>çº¯è‡ªç»˜å¼•æ“</strong> ä¸åŒï¼šValdi å€¾å‘â€œè°ƒç³»ç»Ÿæ§ä»¶â€ï¼Œä»è€Œç»§æ‰¿å„å¹³å°åœ¨æ— éšœç¢ã€è¾“å…¥æ³•ã€å¯è¾¾æ€§ã€æ‰‹åŠ¿å†²çªå¤„ç†ç­‰æ–¹é¢çš„æˆç†Ÿç»éªŒã€‚ä»¥ä¸Šå·®å¼‚ç‚¹å‡æ¥è‡ªå…¶å®˜æ–¹çš„æ¸²æŸ“è·¯çº¿ä¸æ€§èƒ½è¦ç‚¹æè¿°ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</li>
</ul>
<p><strong>Hacker News è®¨è®ºå¸–</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2Fb.3-VN0%2FP%2F3Np%2FvObOmBVmJvZ%2FDA0%2F2HMoD%2FQDw%2FNjDJAH3%2FL%2FTyYzwpNXD%2FA_0rM-Dtgj" target="_blank" title="https://jovial-fortune.com/b.3-VN0/P/3Np/vObOmBVmJvZ/DA0/2HMoD/QDw/NjDJAH3/L/TyYzwpNXD/A_0rM-Dtgj" ref="nofollow noopener noreferrer">news.ycombinator.com/item?id=458â€¦</a>**</p>
<h2 data-id="heading-6">ä¸€ä¸ªæ›´å®Œæ•´çš„é¡µé¢ä¾‹å­</h2>
<p>ä¸‹é¢æ„é€ ä¸€ä¸ªç¨å¾®â€œåƒæ ·â€çš„åˆ—è¡¨é¡µé¢ï¼šé¡¶éƒ¨æ ‡é¢˜ã€ä¸»é¢˜åˆ‡æ¢ã€å¯å¤ç”¨çš„ Cellï¼Œä»¥åŠä¸€ä¸ªåœ¨å¯è§†åŒºåŸŸå†…æ‰æ¸²æŸ“çš„é•¿åˆ—è¡¨ã€‚é€»è¾‘æ¼”ç¤ºä¸ºä¸»ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// Feed.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, state } <span class="hljs-keyword">from</span> <span class="hljs-string">'valdi_core/src/Component'</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Item</span> = { <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">subtitle</span>: <span class="hljs-built_in">string</span> };

<span class="hljs-keyword">function</span> <span class="hljs-title function_">FeedCell</span>(<span class="hljs-params">props: { item: Item }</span>) {
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">padding</span>=<span class="hljs-string">{16}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{props.item.title}</span> <span class="hljs-attr">fontSize</span>=<span class="hljs-string">{17}</span> <span class="hljs-attr">weight</span>=<span class="hljs-string">"semibold"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{props.item.subtitle}</span> <span class="hljs-attr">color</span>=<span class="hljs-string">"#666"</span> <span class="hljs-attr">marginTop</span>=<span class="hljs-string">{6}</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Feed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> {
  <span class="hljs-meta">@state</span> <span class="hljs-keyword">private</span> dark = <span class="hljs-literal">false</span>;
  <span class="hljs-meta">@state</span> <span class="hljs-keyword">private</span> <span class="hljs-attr">items</span>: <span class="hljs-title class_">Item</span>[] = [];

  <span class="hljs-title function_">onMount</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">2000</span> }).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
      <span class="hljs-attr">id</span>: <span class="hljs-title class_">String</span>(i),
      <span class="hljs-attr">title</span>: <span class="hljs-string">`Card <span class="hljs-subst">${i}</span>`</span>,
      <span class="hljs-attr">subtitle</span>: <span class="hljs-string">`Valdi compiles to native views`</span>,
    }));
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">toggleTheme</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dark</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">dark</span>;
  }

  <span class="hljs-title function_">onRender</span>(<span class="hljs-params"/>) {
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">backgroundColor</span>=<span class="hljs-string">{this.dark</span> ? '#<span class="hljs-attr">111</span>' <span class="hljs-attr">:</span> '#<span class="hljs-attr">fff</span>'}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">padding</span>=<span class="hljs-string">{16}</span> <span class="hljs-attr">direction</span>=<span class="hljs-string">"row"</span> <span class="hljs-attr">align</span>=<span class="hljs-string">"center"</span> <span class="hljs-attr">justify</span>=<span class="hljs-string">"space-between"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Explore"</span> <span class="hljs-attr">fontSize</span>=<span class="hljs-string">{20}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onTap</span>=<span class="hljs-string">{()</span> =&gt;</span> this.toggleTheme()}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{this.dark</span> ? '<span class="hljs-attr">Light</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">Dark</span>'} /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>

      {/* åˆ—è¡¨ä»…å¯¹å¯è§†åŒºåŸŸè¿›è¡Œå¢é‡æ¸²æŸ“ï¼Œé•¿åˆ—è¡¨é»˜è®¤å¯æµç•…æ»šåŠ¨ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">list</span>
        <span class="hljs-attr">data</span>=<span class="hljs-string">{this.items}</span>
        <span class="hljs-attr">keyFor</span>=<span class="hljs-string">{(it:</span> <span class="hljs-attr">Item</span>) =&gt;</span> it.id}
        renderItem={(it: Item) =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">FeedCell</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{it}</span> /&gt;</span>}
        estimatedItemHeight={72}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>;
  }
}
</code></pre>
<p>è¿™ä¸ªä¾‹å­å¯¹åº”äº† Valdi çš„ä¸‰ä»¶â€œæ‹¿æ‰‹æ´»â€ï¼š<strong>è§†å›¾æ± å¤ç”¨</strong>ï¼ˆå¤§é‡ Cell å¾ªç¯åˆ©ç”¨ï¼‰ã€<strong>ç»„ä»¶çº§ç‹¬ç«‹é‡æ¸²</strong>ï¼ˆåˆ‡æ¢æš—é»‘åªè®©å—å½±å“åŒºåŸŸæ›´æ–°ï¼‰ã€ä»¥åŠ<strong>æŒ‰å¯è§†çª—å£æ¸²æŸ“</strong>ï¼ˆå¤§åˆ—è¡¨é»˜è®¤ä¸æ»‘ï¼‰ã€‚è¿™äº›éƒ½åœ¨å…¶ README çš„æ€§èƒ½æ®µè½ä¸­æ˜ç¡®åˆ—å‡ºã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<h2 data-id="heading-7">é£é™©ä¸è¾¹ç•Œ</h2>
<p>ä»»ä½•è·¨å¹³å°æ–¹æ¡ˆéƒ½ä¸æ˜¯â€œé“¶å¼¹â€ã€‚Valdi å½“å‰ä»å¤„ <strong>Beta</strong> å¯¹å¤–é˜¶æ®µï¼Œå¼€æºç”Ÿæ€çš„æ–‡æ¡£ã€ç¬¬ä¸‰æ–¹ç»„ä»¶ã€æœ€ä½³å®è·µæ²‰æ·€éœ€è¦æ—¶é—´ï¼›åŒæ—¶ï¼Œå›¢é˜Ÿéœ€è¦å…·å¤‡åŸç”Ÿä¸ TypeScript å¹¶è¡Œçš„å·¥ç¨‹èƒ½åŠ›ï¼ˆç‰¹åˆ«æ˜¯å½“æ¥å…¥å¹³å°èƒ½åŠ›ã€æ’æŸ¥ç³»ç»Ÿå±‚é—®é¢˜æ—¶ï¼‰ã€‚ä¸è¿‡ï¼Œä»è·¯çº¿é€‰æ‹©çœ‹ï¼Œå®ƒå°†â€œæ€§èƒ½ä¼˜å…ˆâ€çš„çŸ›ç›¾ç‚¹æ‹‰å›åˆ°åŸç”Ÿæ ˆé‡Œï¼Œå‡å°‘äº†â€œè§£é‡Šå±‚/æ¡¥æ¥å±‚â€æŠŠæ§ä½“éªŒçš„å˜é‡ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<hr/>
<p><strong>Valdi GitHub</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2FK42TvQ" target="_blank" title="https://jovial-fortune.com/K42TvQ" ref="nofollow noopener noreferrer">github.com/Snapchat/Vaâ€¦</a>**
<strong>Valdi å…¥é—¨ä¸ç¤ºä¾‹</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2FK42TvQ" target="_blank" title="https://jovial-fortune.com/K42TvQ" ref="nofollow noopener noreferrer">github.com/Snapchat/Vaâ€¦</a>**
<strong>Bazelï¼ˆæ„å»ºå·¥å…·ï¼‰</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjovial-fortune.com%2FK42TvQ" target="_blank" title="https://jovial-fortune.com/K42TvQ" ref="nofollow noopener noreferrer">bazel.build/</a>**</p>
<hr/>
<h3 data-id="heading-8">å°ç»“</h3>
<p>Valdi çš„ä»·å€¼ä¸»å¼ å¹¶ä¸èŠ±å“¨ï¼š<strong>ç”¨ TypeScript å†™å£°æ˜å¼ UIï¼ŒæŠŠæ¸²æŸ“äº¤è¿˜ç»™åŸç”Ÿ</strong>ã€‚è¿™ä¸€å–èˆï¼Œä½¿å…¶åœ¨â€œå¤šç«¯ä¸€è‡´ä¸åŸç”Ÿä½“éªŒâ€ä¹‹é—´å–å¾—å°‘è§çš„å¹³è¡¡ã€‚å¯¹äºæ­£åœ¨å¯»æ‰¾â€œæ€§èƒ½ä¸å¦¥åã€åˆèƒ½å¿«é€Ÿè¿­ä»£â€çš„å›¢é˜Ÿï¼Œè¿™æ˜¯å€¼å¾—ä¸¥è‚ƒè¯„ä¼°çš„ä¸€æ¡æŠ€æœ¯è·¯å¾„ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
<blockquote>
<p>å‚è€ƒä¾æ®ï¼šæ¡†æ¶å®šä½ã€ç¼–è¯‘ä¸ºåŸç”Ÿè§†å›¾ã€æ€§èƒ½ç‰¹æ€§ï¼ˆè§†å›¾æ± ã€å¸ƒå±€å¼•æ“ã€å¯è§†åŒºåŸŸæ¸²æŸ“ï¼‰ã€å·¥ç¨‹åŒ–èƒ½åŠ›ï¼ˆçƒ­é‡è½½ã€VS Code è°ƒè¯•ã€Bazelã€å¤šè¯­è¨€ç»‘å®šï¼‰ã€å¼€æºè®¸å¯ä¸ Beta çŠ¶æ€ç­‰ï¼Œå‡æ‘˜è‡ª Valdi å®˜æ–¹ GitHub ä»“åº“ä¸å¼€æºå‘å¸ƒä¿¡æ¯ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" title="https://github.com/Snapchat/Valdi" target="_blank" ref="nofollow noopener noreferrer">GitHub</a>)</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰‘æŒ‡offer-37ã€æ•°å­—åœ¨å‡åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°]]></title>    <link>https://juejin.cn/post/7571781196297420809</link>    <guid>https://juejin.cn/post/7571781196297420809</guid>    <pubDate>2025-11-13T02:27:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571781196297420809" data-draft-id="7569910533508923411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰‘æŒ‡offer-37ã€æ•°å­—åœ¨å‡åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-13T02:27:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰‘æŒ‡offer-37ã€æ•°å­—åœ¨å‡åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T02:27:28.000Z" title="Thu Nov 13 2025 02:27:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¢˜ç›®æè¿°</h2>
<p>ç»Ÿè®¡â¼€ä¸ªæ•°å­—åœ¨å‡åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</p>
<p>ç¤ºä¾‹1
è¾“â¼Šï¼š[1,2,3,3,3,3,4,5],3
è¿”å›å€¼ï¼š4</p>
<h2 data-id="heading-1">æ€è·¯åŠè§£ç­”</h2>
<h3 data-id="heading-2">çº¿æ€§éå†</h3>
<p>é¡ºåºéå†æ•°ç»„ï¼Œé‡åˆ°ç›®æ ‡å€¼å°±è®¡æ•°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">GetNumberOfK</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span> || array.length == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; array.length; i++) {
            <span class="hljs-keyword">if</span> (array[i] == k) {
                count++;
            }
            <span class="hljs-comment">// ç”±äºæ•°ç»„æœ‰åºï¼Œå¦‚æœå½“å‰å…ƒç´ å·²å¤§äºkï¼Œå¯æå‰ç»“æŸ</span>
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (array[i] &gt; k) {
                <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-keyword">return</span> count;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>â€‹ï¼šO(n)ï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦éå†æ•´ä¸ªæ•°ç»„</li>
<li>â€‹<strong>ç©ºé—´å¤æ‚åº¦</strong>â€‹ï¼šO(1)ï¼Œåªä½¿ç”¨å¸¸æ•°çº§åˆ«é¢å¤–ç©ºé—´</li>
</ul>
<h3 data-id="heading-3">äºŒåˆ†æŸ¥æ‰¾+å·¦å³æ‰«ææ³•</h3>
<p>å…ˆä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®šä½åˆ°ç›®æ ‡å€¼ï¼Œç„¶åå‘ä¸¤è¾¹æ‰©å±•ç»Ÿè®¡ã€‚</p>
<p>ç”±äºæ•°ç»„æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°æ˜¯äºŒåˆ†æ³•ã€‚</p>
<p>ç¬¬1æ­¥æ˜¯æ‰¾å‡ºæ•°å€¼ä¸º k çš„æ•°çš„ç´¢å¼•ï¼š
å‡è®¾æ•°ç»„ä¸º nums[] ï¼Œâ¼€å¼€å§‹çš„å·¦è¾¹ç´¢å¼•ä¸º left = 0 ï¼Œå³è¾¹ç•Œç´¢å¼•ä¸º right = nums.length-1</p>
<ol>
<li>å°†æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸­é—´çš„æ•°ä¸º nums[mid] ã€‚ç¬¬1éƒ¨åˆ†ä¸º [left,mid] ,ç¬¬2éƒ¨åˆ†ä¸º[mid+1,right]ã€‚</li>
<li>å¦‚æœ nums[mid]&gt;k ,åˆ™è¯´æ˜ k åªå¯èƒ½å­˜åœ¨å‰åŠéƒ¨åˆ†ä¸­ï¼Œå¯¹å‰åŠéƒ¨åˆ†æ‰§â¾æ“ä½œ1ã€‚</li>
<li>å¦‚æœ nums[mid]&lt;k ,åˆ™è¯´æ˜ k åªå¯èƒ½å­˜åœ¨ååŠéƒ¨åˆ†ä¸­ï¼Œå¯¹ååŠéƒ¨åˆ†æ‰§â¾æ“ä½œ1ã€‚</li>
<li>å¦‚æœ nums[mid]=k ,ç›´æ¥è¿”å›å½“å‰ç´¢å¼• mid ã€‚</li>
<li>å¦‚æœ left &gt; right ,è¯´æ˜ k ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› -1 ã€‚</li>
</ol>
<p>æ‰¾åˆ°ç´¢å¼•ä¹‹åï¼Œå¾€ä¸¤è¾¹æ‰©å±•ï¼ŒåŒæ—¶ç»Ÿè®¡kçš„ä¸ªæ•°ï¼Œç›´åˆ°å…ƒç´ ä¸ç­‰äº k çš„æ—¶å€™åœâ½Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b060f0fde494c77a3c1f34b60fcc121~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763605647&amp;x-signature=aICGJGvTeAoApVvJr%2F3QY0dIq2w%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">GetNumberOfK</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span> || array.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = array.length - <span class="hljs-number">1</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// äºŒåˆ†æŸ¥æ‰¾</span>
        <span class="hljs-keyword">while</span> (left &lt;= right) {
            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> left + (right - left) / <span class="hljs-number">2</span>;
            
            <span class="hljs-keyword">if</span> (array[mid] &lt; k) {
                left = mid + <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (array[mid] &gt; k) {
                right = mid - <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå‘å·¦å³æ‰©å±•ç»Ÿè®¡</span>
                count = <span class="hljs-number">1</span>;
                <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> mid;
                
                <span class="hljs-comment">// å‘å·¦ç»Ÿè®¡</span>
                <span class="hljs-keyword">while</span> (--temp &gt;= left &amp;&amp; array[temp] == k) {
                    count++;
                }
                
                <span class="hljs-comment">// å‘å³ç»Ÿè®¡</span>
                temp = mid;
                <span class="hljs-keyword">while</span> (++temp &lt;= right &amp;&amp; array[temp] == k) {
                    count++;
                }
                <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-keyword">return</span> count;
    }
}
</code></pre>
<ul>
<li>â€‹<strong>æ—¶é—´å¤æ‚åº¦</strong>â€‹ï¼šO(log n + k)ï¼Œå…¶ä¸­kæ˜¯ç›®æ ‡å€¼å‡ºç°æ¬¡æ•°ã€‚å½“ç›®æ ‡å€¼å‡ºç°æ¬¡æ•°è¾ƒå°‘æ—¶æ•ˆç‡æ¥è¿‘O(log n)ï¼Œä½†æœ€åæƒ…å†µï¼ˆå…¨éƒ¨æ˜¯ç›®æ ‡å€¼ï¼‰é€€åŒ–ä¸ºO(n)</li>
<li>â€‹<strong>ç©ºé—´å¤æ‚åº¦</strong>â€‹ï¼šO(1)</li>
</ul>
<h3 data-id="heading-4">åŒäºŒåˆ†æŸ¥æ‰¾æ³•ï¼ˆæ¨èï¼‰</h3>
<p>åˆ†åˆ«ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°ç›®æ ‡å€¼çš„èµ·å§‹å’Œç»“æŸä½ç½®ï¼Œè®¡ç®—åŒºé—´é•¿åº¦ï¼Œè¿™æ˜¯æœ€ä¼˜è§£æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">GetNumberOfK</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span> || array.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªkçš„ä½ç½®</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">firstIndex</span> <span class="hljs-operator">=</span> findFirstPosition(array, k);
        <span class="hljs-comment">// æ‰¾åˆ°æœ€åä¸€ä¸ªkçš„ä½ç½®</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">lastIndex</span> <span class="hljs-operator">=</span> findLastPosition(array, k);
        
        <span class="hljs-keyword">if</span> (firstIndex == -<span class="hljs-number">1</span> || lastIndex == -<span class="hljs-number">1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// ç›®æ ‡å€¼ä¸å­˜åœ¨</span>
        }
        
        <span class="hljs-keyword">return</span> lastIndex - firstIndex + <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-comment">/**
     * æŸ¥æ‰¾ç›®æ ‡å€¼çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findFirstPosition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = array.length - <span class="hljs-number">1</span>;
        
        <span class="hljs-keyword">while</span> (left &lt;= right) {
            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> left + (right - left) / <span class="hljs-number">2</span>;
            
            <span class="hljs-keyword">if</span> (array[mid] &lt; k) {
                left = mid + <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (array[mid] &gt; k) {
                right = mid - <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// å…³é”®ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®</span>
                <span class="hljs-keyword">if</span> (mid == <span class="hljs-number">0</span> || array[mid - <span class="hljs-number">1</span>] != k) {
                    <span class="hljs-keyword">return</span> mid;
                } <span class="hljs-keyword">else</span> {
                    right = mid - <span class="hljs-number">1</span>; <span class="hljs-comment">// ç»§ç»­åœ¨å·¦åŠéƒ¨åˆ†æŸ¥æ‰¾</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// æœªæ‰¾åˆ°</span>
    }
    
    <span class="hljs-comment">/**
     * æŸ¥æ‰¾ç›®æ ‡å€¼çš„æœ€åä¸€ä¸ªå‡ºç°ä½ç½®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findLastPosition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = array.length - <span class="hljs-number">1</span>;
        
        <span class="hljs-keyword">while</span> (left &lt;= right) {
            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> left + (right - left) / <span class="hljs-number">2</span>;
            
            <span class="hljs-keyword">if</span> (array[mid] &lt; k) {
                left = mid + <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (array[mid] &gt; k) {
                right = mid - <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// å…³é”®ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªå‡ºç°ä½ç½®</span>
                <span class="hljs-keyword">if</span> (mid == array.length - <span class="hljs-number">1</span> || array[mid + <span class="hljs-number">1</span>] != k) {
                    <span class="hljs-keyword">return</span> mid;
                } <span class="hljs-keyword">else</span> {
                    left = mid + <span class="hljs-number">1</span>; <span class="hljs-comment">// ç»§ç»­åœ¨å³åŠéƒ¨åˆ†æŸ¥æ‰¾</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// æœªæ‰¾åˆ°</span>
    }
}
</code></pre>
<ul>
<li>â€‹<strong>æ—¶é—´å¤æ‚åº¦</strong>â€‹ï¼šO(log n)ï¼Œæ‰§è¡Œä¸¤æ¬¡äºŒåˆ†æŸ¥æ‰¾</li>
<li>â€‹<strong>ç©ºé—´å¤æ‚åº¦</strong>â€‹ï¼šO(1)ï¼Œåªä½¿ç”¨å¸¸æ•°ç©ºé—´</li>
</ul>
<h3 data-id="heading-5">kÂ±0.5è¾¹ç•ŒæŸ¥æ‰¾æ³•</h3>
<p>ä¸€ç§å·§å¦™çš„è§£æ³•ï¼Œé€šè¿‡æŸ¥æ‰¾ç›®æ ‡å€¼è¾¹ç•Œçš„æ’å…¥ä½ç½®æ¥è®¡ç®—å‡ºç°æ¬¡æ•°ã€‚</p>
<p>ç”±äºæ•°ç»„å…ƒç´ éƒ½æ˜¯æ•´æ•°ï¼Œk-0.5å’Œk+0.5æ­£å¥½æ˜¯ç›®æ ‡å€¼èŒƒå›´çš„è¾¹ç•Œï¼Œå®ƒä»¬çš„æ’å…¥ä½ç½®å·®å€¼å°±æ˜¯ç›®æ ‡å€¼å‡ºç°æ¬¡æ•°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">GetNumberOfK</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-keyword">if</span> (array == <span class="hljs-literal">null</span> || array.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// æŸ¥æ‰¾k+0.5çš„æ’å…¥ä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå¤§äºkçš„ä½ç½®ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">upperBound</span> <span class="hljs-operator">=</span> findInsertPosition(array, k + <span class="hljs-number">0.5</span>);
        <span class="hljs-comment">// æŸ¥æ‰¾k-0.5çš„æ’å…¥ä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå¤§äºç­‰äºkçš„ä½ç½®ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">lowerBound</span> <span class="hljs-operator">=</span> findInsertPosition(array, k - <span class="hljs-number">0.5</span>);
        
        <span class="hljs-keyword">return</span> upperBound - lowerBound;
    }
    
    <span class="hljs-comment">/**
     * åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾ç›®æ ‡å€¼çš„æ’å…¥ä½ç½®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findInsertPosition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">double</span> target)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, right = array.length - <span class="hljs-number">1</span>;
        
        <span class="hljs-keyword">while</span> (left &lt;= right) {
            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> left + (right - left) / <span class="hljs-number">2</span>;
            
            <span class="hljs-keyword">if</span> (array[mid] &lt; target) {
                left = mid + <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> {
                right = mid - <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-keyword">return</span> left; <span class="hljs-comment">// è¿”å›æ’å…¥ä½ç½®</span>
    }
}
</code></pre>
<ul>
<li>â€‹<strong>æ—¶é—´å¤æ‚åº¦</strong>â€‹ï¼šO(log n)ï¼Œä¸¤æ¬¡äºŒåˆ†æŸ¥æ‰¾</li>
<li>â€‹<strong>ç©ºé—´å¤æ‚åº¦</strong>â€‹ï¼šO(1)</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java + Spring åˆ° Python + FastAPI ï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7571743311519924233</link>    <guid>https://juejin.cn/post/7571743311519924233</guid>    <pubDate>2025-11-13T01:49:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571743311519924233" data-draft-id="7571621555513360438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java + Spring åˆ° Python + FastAPI ï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="Java,Python,Spring"/> <meta itemprop="datePublished" content="2025-11-13T01:49:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java + Spring åˆ° Python + FastAPI ï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T01:49:27.000Z" title="Thu Nov 13 2025 01:49:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Java ç¨‹åºå‘˜è¶Šæ¥è¶Šè¢«å”¾å¼ƒï¼Œæˆ‘çœ‹ BOSS ç›´è˜ä¸Šæœ‰çš„å…¬å¸åœ¨è¦æ±‚é‡Œé¢æ˜æ–‡å†™ä¸è¦ Java ç¨‹åºå‘˜ï¼Œæ„Ÿè§‰è‡ªå·±å—åˆ°äº†ä¾®è¾±ï¼Œä¸€æ€’ä¹‹ä¸‹æ€’äº†ä¸€ä¸‹ï¼Œæ—¢ç„¶å¦‚æ­¤åˆ«æ€ªæˆ‘å¿ƒç‹ æ‰‹è¾£ç”¨ Python + FastAPI æŠŠä¹‹å‰ Java + Spring çš„é¡¹ç›®é‡å†™ä¸€éã€‚</p>
</blockquote>
<p>æ­¤æ–‡æ¶‰åŠ MySQLã€Kafkaã€Redis ç»„ä»¶å’Œç”¨æˆ·ã€èµ„é‡‘ã€è®¢å•æ¨¡å—ï¼Œæ•´ä½“ä» Java è¿ç§»åˆ° Python æ‰€éœ€çš„çŸ¥è¯†ç‚¹ã€‚</p>
<h2 data-id="heading-0">è¯­è¨€æ€ç»´è½¬æ¢</h2>
<p>Java çš„è¯­æ³•å¾ˆè‡ƒè‚¿ï¼Œå¦‚æœä¼š Java å†çœ‹å…¶ä»–è¯­è¨€ç®€ç›´é™ç»´æ‰“å‡»ï¼Œå­¦èµ·æ¥æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œé¡¶å¤šæ˜¯åº•å±‚çš„ä¸€äº›è®¾è®¡ã€æ¶æ„ä¸ä¸€æ ·ã€‚</p>
<p>Python æ˜¯åŠ¨æ€è¯­è¨€ï¼Œæ¯”å¦‚</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-comment"># ä¼ ç»Ÿ Python</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>):
    <span class="hljs-keyword">return</span> a + b

add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)       <span class="hljs-comment"># ç»“æœæ˜¯ 3</span>
add(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>)   <span class="hljs-comment"># ç»“æœæ˜¯ "ab"</span>
</code></pre>
<p>æ²¡æœ‰ç±»å‹æ ¡éªŒï¼Œæ²¡æœ‰è¿è¡Œå‰ç¼–è¯‘ï¼Œçœ‹èµ·æ¥éå¸¸ä¸å®‰å…¨ã€‚äºæ˜¯æœ‰äº† <strong>Pydantic</strong>ã€‚</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_with_hints</span>(<span class="hljs-params">a: <span class="hljs-built_in">int</span>, b: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:
    <span class="hljs-keyword">return</span> a + b
</code></pre>
<p>æ‹¬å·é‡Œé¢æ˜¯å‚æ•°ï¼Œ-&gt; int æ˜¯è¿”å›å€¼ï¼Œç”¨äº† Type Hintsï¼Œç›¸å½“äºä¸€ç§æç¤ºï¼Œè®© Pydantic è¯»å–åˆ°åè¿›è¡Œæ ¡éªŒå’Œè½¬æ¢ã€‚</p>
<p>åˆ—ä¸¾ä¸€ä¸ªæ¥å£çš„ä¾‹å­ï¼Œæ¯”å¦‚ Java</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// 1. DTO ç±» (POJO)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateUserDTO</span> {
    
    <span class="hljs-comment">// 2. Validation (javax.validation)</span>
    <span class="hljs-meta">@NotNull</span>
    <span class="hljs-meta">@Size(min = 3, max = 50)</span>
    <span class="hljs-keyword">private</span> String username;
    
    <span class="hljs-meta">@Min(18)</span>
    <span class="hljs-keyword">private</span> Integer age;
    
    <span class="hljs-comment">// Getters and Setters... (ç”± Jackson ç”¨äºåºåˆ—åŒ–)</span>
}

<span class="hljs-comment">// 3. Controller (Jackson + Validation)</span>
<span class="hljs-meta">@PostMapping("/users")</span>
<span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; createUser(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> CreateUserDTO userDTO) {
    <span class="hljs-comment">// åˆ°äº†è¿™é‡Œï¼ŒuserDTO å·²ç»è¢« Jackson è§£æï¼Œå¹¶è¢« Validation æ ¡éªŒè¿‡äº†</span>
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>è€Œ Python + FastAPI + Pydantic æ˜¯</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span> <span class="hljs-comment"># å¯¹åº” Java çš„ Optional æˆ– null</span>

<span class="hljs-comment"># 1. Pydantic æ¨¡å‹ (è¿™ä¸€ä¸ªä¸œè¥¿ = Java çš„ DTO + Validation + Jackson æ³¨è§£)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateUserDTO</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-comment"># å¯¹åº” @NotNull å’Œ @Size</span>
    username: <span class="hljs-built_in">str</span> = Field(..., min_length=<span class="hljs-number">3</span>, max_length=<span class="hljs-number">50</span>) 
    
    <span class="hljs-comment"># å¯¹åº” @Min(18) å’Œ å¯é€‰ (Integer è€Œé int)</span>
    age: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(<span class="hljs-literal">None</span>, ge=<span class="hljs-number">18</span>) <span class="hljs-comment"># ge = Greater than or Equal</span>
    
    <span class="hljs-comment"># æ³¨æ„ï¼š</span>
    <span class="hljs-comment"># 1. ... (ä¸‰ä¸ªç‚¹) è¡¨ç¤ºè¿™ä¸ªå­—æ®µæ˜¯å¿…å¡«çš„</span>
    <span class="hljs-comment"># 2. Field(None, ...) è¡¨ç¤ºè¿™ä¸ªå­—æ®µæ˜¯å¯é€‰çš„ (é»˜è®¤å€¼ä¸º None)</span>


<span class="hljs-comment"># 2. FastAPI è·¯ç”±</span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/users"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_user</span>(<span class="hljs-params">user_dto: CreateUserDTO</span>):
    <span class="hljs-comment"># åˆ°äº†è¿™é‡Œï¼ŒPydantic å·²ç»è‡ªåŠ¨å®Œæˆäº†ï¼š</span>
    <span class="hljs-comment"># 1. è¯»å– JSON è¯·æ±‚ä½“ (åƒ Jackson)</span>
    <span class="hljs-comment"># 2. æŒ‰ç…§ç±»å‹æç¤º (str, int) æ ¡éªŒå’Œè½¬æ¢æ•°æ®</span>
    <span class="hljs-comment"># 3. è¿è¡Œæ ¡éªŒè§„åˆ™ (min_length, ge) (åƒ javax.validation)</span>
    <span class="hljs-comment"># 4. å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œè‡ªåŠ¨è¿”å›ä¸€ä¸ª 422 é”™è¯¯çš„ JSON å“åº”</span>
    
    <span class="hljs-comment"># ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡</span>
    <span class="hljs-comment"># user_dto.username </span>
    
    <span class="hljs-keyword">return</span> user_dto
</code></pre>
<p>Python é‡Œé¢çš„ <strong>Optional</strong> å’Œ Java é‡Œé¢æ˜¯åŒä¸€ä¸ªæ„æ€ï¼Œå†™æ³•ä¸ä¸€æ ·ï¼ŒPython é‡Œé¢æŠŠå…«å¤§åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»ä¹Ÿç”¨ Optional è¡¨ç¤ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e09813d413aa4300af942eafd2e30064~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763603367&amp;x-signature=Avor%2BvoN0Zvf4%2B%2FRe4EW%2F35%2FhNQ%3D" alt="image.png" loading="lazy"/></p>
<p>Python é‡Œæ²¡æœ‰ Lombokï¼Œç›´æ¥.å±æ€§å°±è¡Œã€‚</p>
<h2 data-id="heading-1">å¹¶å‘æ¨¡å‹</h2>
<p>è¿™æ˜¯ Java å’Œ Python æœ€å¤§çš„ä¸åŒï¼ŒJava æ˜¯å¤šçº¿ç¨‹ï¼Œåœ¨ Spring Web ä¸­ä¸€ä¸ªè¯·æ±‚å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼ˆé WebFluxï¼‰ï¼ŒTomcat é‡Œé¢é…ç½®æœ€å¤§çº¿ç¨‹æ•°å°±è¿™ä¸ªä½œç”¨ã€‚çº¿ç¨‹å†…æ˜¯é˜»å¡çš„ï¼Œæ¯”å¦‚æŸ¥æ•°æ®åº“çº¿ç¨‹å°±åœé‚£äº†ï¼Œç­‰å¾…æ•°æ®å®Œæˆäº†ç»§ç»­æ‰§è¡Œã€‚</p>
<p>Python ç”¨çš„ asyncio å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ã€‚æŸ¥æ•°æ®åº“çš„æ—¶å€™ï¼Œçº¿ç¨‹å»æ‰§è¡Œåˆ«çš„ï¼Œç›´åˆ°æ•°æ®æ‹¿åˆ°äº†å†æ¥ç€æ‰§è¡Œã€‚ï¼ˆå…·ä½“æµç¨‹åé¢è¯¦ç»†åˆ†è§£ï¼‰</p>
<p>æ¯”å¦‚è¿™ä¸ªæ¥å£é€»è¾‘</p>
<ul>
<li>
<p>æŸ¥ç”¨æˆ·</p>
</li>
<li>
<p>æŸ¥å•†å“</p>
</li>
<li>
<p>å†™è®¢å•</p>
</li>
<li>
<p>å†™è®¢å•è¯¦æƒ…</p>
</li>
</ul>
<p>Java æ˜¯</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// çº¿ç¨‹ 1</span>
<span class="hljs-keyword">public</span> Order <span class="hljs-title function_">createOrder</span><span class="hljs-params">(...)</span> {
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRepo.findById(...);      <span class="hljs-comment">// (çº¿ç¨‹ 1 é˜»å¡ï¼Œç­‰å¾… 5ms)</span>
    <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> productRepo.findById(...); <span class="hljs-comment">// (çº¿ç¨‹ 1 é˜»å¡ï¼Œç­‰å¾… 5ms)</span>
    
    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>(...);
    orderRepo.save(order);                   <span class="hljs-comment">// (çº¿ç¨‹ 1 é˜»å¡ï¼Œç­‰å¾… 10ms)</span>
    
    <span class="hljs-type">OrderDetail</span> <span class="hljs-variable">detail</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDetail</span>(...);
    detailRepo.save(detail);                 <span class="hljs-comment">// (çº¿ç¨‹ 1 é˜»å¡ï¼Œç­‰å¾… 10ms)</span>
    
    <span class="hljs-keyword">return</span> order; <span class="hljs-comment">// æ€»è€—æ—¶ï¼š5+5+10+10 = 30ms (çº¿ç¨‹ 1 è¢«ç‹¬å  30ms)</span>
}
</code></pre>
<p>Python æ˜¯</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-comment"># å•ä¸ªäº‹ä»¶å¾ªç¯çº¿ç¨‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_order</span>(<span class="hljs-params">...</span>):
    <span class="hljs-comment"># 'await'ï¼šæˆ‘æŠŠæ§åˆ¶æƒäº¤å›äº‹ä»¶å¾ªç¯</span>
    user = <span class="hljs-keyword">await</span> user_repo.get_by_id(...)      <span class="hljs-comment"># (I/O å¼€å§‹ï¼Œä»»åŠ¡æš‚åœ)</span>
    
    <span class="hljs-comment"># ... æŸä¸ªæœªæ¥çš„æ—¶åˆ»ï¼Œäº‹ä»¶å¾ªç¯æ¢å¤äº†æˆ‘çš„æ‰§è¡Œ ...</span>
    
    product = <span class="hljs-keyword">await</span> product_repo.get_by_id(...) <span class="hljs-comment"># (I/O å¼€å§‹ï¼Œä»»åŠ¡å†æ¬¡æš‚åœ)</span>
    
    <span class="hljs-comment"># ... å†æ¬¡æ¢å¤ ...</span>
    
    order = Order(...)
    <span class="hljs-keyword">await</span> order_repo.save(order)              <span class="hljs-comment"># (I/O å¼€å§‹ï¼Œä»»åŠ¡å†æ¬¡æš‚åœ)</span>
    
    <span class="hljs-comment"># ... å†æ¬¡æ¢å¤ ...</span>
    
    detail = OrderDetail(...)
    <span class="hljs-keyword">await</span> detail_repo.save(detail)            <span class="hljs-comment"># (I/O å¼€å§‹ï¼Œä»»åŠ¡å†æ¬¡æš‚åœ)</span>
    
    <span class="hljs-comment"># ... å†æ¬¡æ¢å¤ ...</span>
    
    <span class="hljs-keyword">return</span> order <span class="hljs-comment"># æ€»è€—æ—¶ï¼šè¿˜æ˜¯ 30ms (I/O æ€»æ—¶é—´)</span>
</code></pre>
<p>è¿™å¯¼è‡´çš„ç¬¬ä¸€é‡å¤§å˜åŒ–æ˜¯ ThreadLocal æ²¡äº†ï¼Œä¹‹å‰ç”¨æˆ·ç™»å½•çš„ token å¯ä»¥ç”¨ AOP ä¸€è·¯å¸¦åˆ°çº¿ç¨‹é‡Œï¼Œåœ¨ Python é‡Œé¢ç”¨ FastAPI çš„ Depends è§£å†³ï¼Œåé¢æƒ³è¯´ã€‚</p>
<p>ç¬¬äºŒä¸ªæ˜¯ async å¿…é¡»å…¨ç¨‹åˆ°åº•ï¼Œä¸€ä¸ªæ–¹æ³•ç”¨äº†ï¼Œæ‰€æœ‰ä¸Šä¸‹æ¸¸è°ƒç”¨éƒ½ç”¨ï¼Œå¤–éƒ¨çš„ MySQLã€Kafka è¿™ç§ç»„ä»¶ä¹Ÿè¦ç”¨ async çš„ç‰ˆæœ¬ã€‚</p>
<h3 data-id="heading-2">é‚£ä¸ºä»€ä¹ˆ Python æ˜¯å•çº¿ç¨‹çš„ï¼Ÿ</h3>
<p>ä¸»è¦æ˜¯ Python çš„ RAM å†…å­˜ç®¡ç†ç”¨çš„ GLCï¼ˆGlobal Interpreter Lockï¼‰ï¼Œä¸åƒ Java æœ‰å¤æ‚çš„ GC åƒåœ¾å›æ”¶æœºåˆ¶ï¼ŒGLC åœ¨ç”¨åˆ°å¯¹è±¡çš„<strong>å¼•ç”¨è®¡æ•°</strong> + 1ï¼Œæ²¡ç”¨åˆ° -1ï¼Œä¸º 0 åˆ™æ¸…ç†ï¼Œä¸ºäº†é˜²æ­¢å¤šçº¿ç¨‹ RAM å†…å­˜å‡ºé—®é¢˜ï¼Œæœ‰äº† GLCã€‚</p>
<p>asyncio å°±æ˜¯ç”¨å•çº¿ç¨‹å¤šè¿›ç¨‹ï¼ˆåç¨‹ï¼‰çš„æ–¹å¼ï¼Œæé«˜å¹¶å‘ã€‚</p>
<h3 data-id="heading-3">è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a689179bade9434cae7cd1f6252b9abe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763603367&amp;x-signature=0raHfLx%2BwpAwgQE2B%2BCEQFa756A%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰“å¼€ Win çš„ä»»åŠ¡ç®¡ç†å™¨ï¼Œæœ€å¤–å±‚çš„ Micosoft Edge å°±ä¸€ä¸ªè¿›ç¨‹ï¼Œæ‹¬å·é‡Œçš„ 18 å°±æ˜¯ 18 çš„çº¿ç¨‹ï¼Œåç¨‹ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹ï¼Œå¯ä»¥å¾ˆå¿«é€Ÿçš„åœ¨ä¸åŒä»»åŠ¡ä¹‹é—´åˆ‡æ¢ï¼Œasyncio é‡Œé¢è¿™ä¹ˆå«ã€‚</p>
<h3 data-id="heading-4">Python + asyncio è¿™ä¹ˆææ•ˆç‡å²‚ä¸æ˜¯å¾ˆä½ï¼Ÿå¤šæ ¸å¤„ç†å™¨æ€ä¹ˆåŠï¼Ÿ</h3>
<p>å…¶å® CPU çš„é€Ÿåº¦æ˜¯è¿œè¶… IO çš„ï¼Œè€æ—©ä¹‹å‰å•æ ¸ CPU å°±æœ‰æ—¶é—´åˆ‡ç‰‡æ¨¡æ‹Ÿæˆå¤šæ ¸ï¼ŒæœåŠ¡å™¨å¤§éƒ½æ˜¯ IO å¯†é›†å‹ï¼Œå¡åœ¨æŸ¥ MySQLã€Kafkaã€Redis ç­‰ï¼Œè¿™æ ·å…¶å®æ›´é«˜æ•ˆã€‚</p>
<p>æ¯ä¸ªçº¿ç¨‹çš„å¯åŠ¨éƒ½è¦æ¶ˆè€—å‡  M çš„ RAMï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿæ¯”è¾ƒè€—èµ„æºï¼Œè¿›ç¨‹ä¹‹é—´æ•ˆç‡é«˜å¾—å¤šã€‚</p>
<p>çº¿ä¸ŠçœŸå®çš„å¤šæ ¸å¤„ç†å™¨æœåŠ¡å™¨ï¼Œä¼šç”¨è¿›ç¨‹ç®¡ç†å™¨ <strong>Gunicorn</strong> æ ¹æ®æœåŠ¡å™¨æ ¸å¿ƒæ•°å¯åŠ¨å¤šä¸ª Python è¿›ç¨‹ï¼Œç”± Gunicorn å°†è¯·æ±‚åˆ†å‘ã€‚</p>
<h3 data-id="heading-5">asyncio çš„åŸç†</h3>
<p>asyncio åº•å±‚æœ‰ä¸¤ä¸ªç»„ä»¶ï¼Œ<strong>Ready Queue</strong> å’Œ <strong>Waiting Map</strong>ã€‚Ready Queue æ˜¯å¯ä»¥ç«‹å³æ‰§è¡Œçš„é˜Ÿåˆ—ï¼ŒWaiting Map æ˜¯å¼‚æ­¥ç­‰å¾…å”¤é†’çš„ä»»åŠ¡ã€‚</p>
<p>ä»¥ä¸ºä¸€ä¸ªè¯·æ±‚æµç¨‹ä¸ºä¾‹</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_order</span>(<span class="hljs-params">...</span>):
    <span class="hljs-comment"># ä½ çš„ä»£ç ä»è¿™é‡Œå¼€å§‹æ‰§è¡Œ</span>
    user_data = <span class="hljs-keyword">await</span> request.json()  <span class="hljs-comment"># å‡è®¾è¿™æ˜¯ç¬¬ä¸€ä¸ª await (I/O)</span>
    ...
</code></pre>
<p>è¿™äº›ä»£ç éƒ½å…ˆå½“åšä»»åŠ¡æ”¾åˆ° Ready Queueï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª await åˆ™æš‚åœï¼ŒæŠŠä»»åŠ¡ç§»åŠ¨åˆ° Waiting Mapï¼Œç„¶åä» Ready Queue å–ä¸‹ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œã€‚ç›´åˆ°æ‰€æœ‰çš„ Ready Queue éƒ½æ‰§è¡Œå®Œæˆã€‚</p>
<p>ä¸€ä¸ªæ˜¯ Queue ä¸€ä¸ªæ˜¯ Mapï¼ŒQueue å­˜çš„æ˜¯ä»»åŠ¡ï¼ŒMap ä¸­å­˜çš„æ˜¯ä»»åŠ¡ + å›è°ƒï¼Œè¿™æ ·æ•°æ®å›è°ƒçš„æ—¶å€™çŸ¥é“å»æ‰§è¡Œå“ªä¸ªä»»åŠ¡ã€‚</p>
<p>await äº¤ç»™æ“ä½œç³»ç»Ÿç³»ç»Ÿ OS å¤„ç†ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­æ¯”å¦‚ä»˜æ¬¾åœºæ™¯ç­‰æ”¯ä»˜å®å›è°ƒï¼Œåœ¨è¿™é‡Œç±»ä¼¼ã€‚</p>
<p>await å‘Šè¯‰æ“ä½œç³»ç»Ÿå¸®æˆ‘æŸ¥ä¸‹ MySQLï¼Œæœ‰ç»“æœäº†é€šçŸ¥æˆ‘ã€‚ä½†ä¸åŒçš„æ“ä½œç³»ç»Ÿé€šçŸ¥æ–¹å¼ä¸ä¸€æ ·ï¼ŒMac UNIX çš„ kqueueã€Linux çš„ epoll å±äº<strong>Reactor çš„å°±ç»ªé€šçŸ¥</strong>ï¼ŒWin çš„ IOPC å±äº<strong>Proactor çš„å›è°ƒ</strong>ã€‚</p>
<p>ä»–ä¿©åŒºåˆ«æ˜¯ç³»ç»Ÿ OS å±‚çš„ï¼Œæ¶‰åŠç½‘å¡ã€æ•°æ®æµé‚£äº›ï¼ŒProactor å¸®å¿™æŠŠæ•°æ®æµå¤åˆ¶äº†ä¸€ä»½ï¼ŒReactor åˆ™è‡ªå·±å» read() write()ï¼Œä»£ç å±‚é¢æ²¡æœ‰åŒºåˆ«ï¼Œasyncio å·²ç»å¸®å¿™å°è£…å¥½äº†ï¼Œæ ¹æ®æ“ä½œç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬äºŒèŠ‚ Node.js é¡¹ç›®å®è·µ - ä½¿ç”¨ nvm å®‰è£… Node.js]]></title>    <link>https://juejin.cn/post/7571695634942492699</link>    <guid>https://juejin.cn/post/7571695634942492699</guid>    <pubDate>2025-11-12T16:38:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571695634942492699" data-draft-id="7571662618056081434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬äºŒèŠ‚ Node.js é¡¹ç›®å®è·µ - ä½¿ç”¨ nvm å®‰è£… Node.js"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-12T16:38:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="undefinedåœ¨æ˜é‡‘39041"/> <meta itemprop="url" content="https://juejin.cn/user/1081575171951485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬äºŒèŠ‚ Node.js é¡¹ç›®å®è·µ - ä½¿ç”¨ nvm å®‰è£… Node.js
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575171951485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    undefinedåœ¨æ˜é‡‘39041
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T16:38:17.000Z" title="Wed Nov 12 2025 16:38:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯¾ç¨‹çš„ç¬¬ 2 å›ï¼šä½¿ç”¨ nvm å®‰è£… Node.jsï¼Œåœ¨è¿™èŠ‚è¯¾é‡Œï¼Œæˆ‘ä»¬å°†æ¢è®¨ï¼š</p>
<ul>
<li>ä¸ºä½•è¦ç”¨ nvmï¼Ÿ</li>
<li>Windows å’Œ macOS å®‰è£… nvm çš„æ–¹å¼</li>
<li>ä½¿ç”¨ nvm å®‰è£… Node.js</li>
<li>å¦‚ä½•åˆ‡æ¢ Node.js çš„ç‰ˆæœ¬</li>
<li>é…ç½® npm ä¸­å›½é•œåƒ</li>
</ul>
<p>å¼€å‘<code>Node.js</code>ï¼Œé¦–å…ˆå°±å¿…é¡»è¦å®‰è£…<code>Node.js</code>è‡ªèº«ã€‚å¦‚æœä½ å·²ç»å®‰è£…å¥½äº†<code>Node.js</code>äº†ï¼Œå¯ä»¥ç•¥è¿‡æœ¬èŠ‚è¯¾ç¨‹ï¼Œç›´æ¥å¼€å§‹å­¦ä¹ å¼€å‘ã€‚</p>
<h2 data-id="heading-0"><em>1.Â ä¸ºä½•è¦ç”¨ nvm ï¼Ÿ</em></h2>
<p>å®‰è£…<code>Node.js</code>ï¼Œæœ€ç®€å•åŠæ³•ï¼Œå°±æ˜¯ç›´æ¥åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2F" target="_blank" title="https://nodejs.org/en/" ref="nofollow noopener noreferrer">å®˜ç½‘</a>ä¸‹è½½äº†å®‰è£…ã€‚ä½†è¿™ç§æ–¹æ³•ï¼Œå´ä¸æ˜¯æœ€å¥½çš„åŠæ³•ã€‚å› ä¸ºå¦‚æœéœ€è¦æ›´æ–°<code>Node.js</code>çš„ç‰ˆæœ¬ï¼Œé‚£å°±éœ€è¦æŠŠä¹‹å‰çš„å¸è½½äº†ï¼Œå†å»ä¸‹è½½å®‰è£…å…¶ä»–ç‰ˆæœ¬ï¼Œè¿™æ ·å°±éå¸¸çš„éº»çƒ¦äº†ã€‚</p>
<p>è¿™é‡Œæ¨èå¤§å®¶ä½¿ç”¨<code>nvm</code>æ¥å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥å®‰è£…å¤šä¸ªä¸åŒç‰ˆæœ¬çš„<code>Node.js</code>ï¼Œå¹¶ä¸”æ ¹æ®éœ€è¦éšæ„çš„åˆ‡æ¢æ‰€éœ€ç‰ˆæœ¬ã€‚</p>
<h2 data-id="heading-1"><em>2.Â Windows å®‰è£… nvm-windows</em></h2>
<p>Windows ä¸ macOS çš„å®‰è£…æ–¹æ³•æœ‰äº›ä¸åŒã€‚Windows çš„åŒå­¦ï¼Œè¯·åœ¨è¿™é‡Œä¸‹è½½<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcoreybutler%2Fnvm-windows%2F" target="_blank" title="https://github.com/coreybutler/nvm-windows/" ref="nofollow noopener noreferrer">github.com/coreybutlerâ€¦</a>äº†ï¼Œç›´æ¥å®‰è£…å°±å¥½ ï¼Œç„¶åç‚¹å‡»å³ä¾§çš„Â <code>Releases</code>ï¼Œè¿™é‡Œå°±æ˜¯ä¸‹è½½çš„åœ°æ–¹äº†ã€‚æ¥ç€ï¼Œæ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œé€‰æ‹©<code>nvm-setup.exe</code>ä¸‹è½½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17ad2cbedddc4a7288f531a2ceda55db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdW5kZWZpbmVk5Zyo5o6Y6YeRMzkwNDE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570297&amp;x-signature=LaPTXUuFwGo3xZ5yXvWPW%2FJys0M%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸‹å¥½åï¼Œå°±å¤§å®¶ç›´æ¥å®‰è£…ä¸Šï¼Œç„¶åå°†è‡ªå·±ç”µè„‘çš„<code>PowerShell</code>æˆ–è€…ç»ˆç«¯æ‰“å¼€ï¼Œè¿è¡Œ<code>nvm</code>ï¼Œåªè¦å‡ºæ¥ä¸œè¥¿äº†ï¼Œå°±æ˜¯å®‰è£…å¥½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0ea5d8ea8114fe7a40b98113ccca2d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdW5kZWZpbmVk5Zyo5o6Y6YeRMzkwNDE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570297&amp;x-signature=bIIQWo8lbRVVDkS52b%2F3s5dfsrQ%3D" alt="image.png" loading="lazy"/></p>
<p>æ³¨æ„ï¼šWindows æœ‰å¯èƒ½ç¢°åˆ°é”™è¯¯æç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b97f58e81fa485d868993283da138c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdW5kZWZpbmVk5Zyo5o6Y6YeRMzkwNDE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763570297&amp;x-signature=O%2F%2F8Yra%2FxNZvvK5ngmJ464j%2BtpU%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœç¢°åˆ°è¿™ä¸ªé”™è¯¯ï¼Œéœ€è¦ç”¨<code>ç®¡ç†å‘˜èº«ä»½</code>æ‰“å¼€<code>PowerShell</code>ï¼Œç„¶åè¿è¡Œï¼š</p>
<p>Set-ExecutionPolicy RemoteSigned</p>
<pre><code class="hljs language-js" lang="js"/></pre>
<p>å†æŒ‰<code>a</code>å³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Springäº‹åŠ¡åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„å®è·µä¸æŒ‘æˆ˜]]></title>    <link>https://juejin.cn/post/7571749988080173065</link>    <guid>https://juejin.cn/post/7571749988080173065</guid>    <pubDate>2025-11-12T19:30:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571749988080173065" data-draft-id="7570984257665957934" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Springäº‹åŠ¡åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„å®è·µä¸æŒ‘æˆ˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-12T19:30:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å¤´an"/> <meta itemprop="url" content="https://juejin.cn/user/618374030438861"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Springäº‹åŠ¡åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„å®è·µä¸æŒ‘æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/618374030438861/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å¤´an
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-12T19:30:18.000Z" title="Wed Nov 12 2025 19:30:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¼ ç»Ÿçš„å•ä½“æ•°æ®åº“äº‹åŠ¡ä¸å†é€‚ç”¨ã€‚æ¯ä¸ªå¾®æœåŠ¡æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ï¼Œå¦‚ä½•ä¿è¯è·¨æœåŠ¡çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿå¦‚ä½•è®¾è®¡å¯é çš„äº‹åŠ¡æ–¹æ¡ˆï¼Ÿæœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¾®æœåŠ¡æ¶æ„ä¸‹çš„äº‹åŠ¡æŒ‘æˆ˜ï¼Œå¹¶ä»‹ç»å¤šç§åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<h2 data-id="heading-1">å¾®æœåŠ¡äº‹åŠ¡çš„æŒ‘æˆ˜</h2>
<h3 data-id="heading-2">1. ä¼ ç»ŸACIDäº‹åŠ¡çš„å±€é™æ€§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å•ä½“åº”ç”¨ä¸­çš„äº‹åŠ¡ - åœ¨å¾®æœåŠ¡ä¸­æ— æ³•å®ç°</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MonolithicOrderService</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// æ‰€æœ‰æ“ä½œåœ¨åŒä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡ä¸­</span>
        orderRepository.save(order);           <span class="hljs-comment">// è®¢å•åº“</span>
        inventoryService.deductStock(order);   <span class="hljs-comment">// åº“å­˜åº“  </span>
        accountService.deductBalance(order);   <span class="hljs-comment">// è´¦æˆ·åº“</span>
        notificationService.sendEmail(order);  <span class="hljs-comment">// é€šçŸ¥æœåŠ¡</span>
        <span class="hljs-comment">// è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»š</span>
    }
}
</code></pre>
<p><strong>å¾®æœåŠ¡ä¸­çš„é—®é¢˜</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæœåŠ¡æœ‰ç‹¬ç«‹çš„æ•°æ®åº“</li>
<li>æ— æ³•ä½¿ç”¨ä¼ ç»Ÿçš„æ•°æ®åº“äº‹åŠ¡</li>
<li>ç½‘ç»œè°ƒç”¨å¯èƒ½å¤±è´¥</li>
<li>æœåŠ¡å¯èƒ½ä¸å¯ç”¨</li>
</ul>
<h3 data-id="heading-3">2. CAPå®šç†çš„å½±å“</h3>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåªèƒ½åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§ (Consistency)</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°ç›¸åŒçš„æ•°æ®</li>
<li><strong>å¯ç”¨æ€§ (Availability)</strong>ï¼šæ¯ä¸ªè¯·æ±‚éƒ½èƒ½è·å¾—å“åº”</li>
<li><strong>åˆ†åŒºå®¹é”™æ€§ (Partition Tolerance)</strong>ï¼šç³»ç»Ÿåœ¨ç½‘ç»œåˆ†åŒºæ—¶ä»èƒ½å·¥ä½œ</li>
</ul>
<p>å¾®æœåŠ¡æ¶æ„é€šå¸¸é€‰æ‹©<strong>AP + æœ€ç»ˆä¸€è‡´æ€§</strong>ã€‚</p>
<h2 data-id="heading-4">åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼</h2>
<h3 data-id="heading-5">1. ä¸¤é˜¶æ®µæäº¤ (2PC)</h3>
<p><strong>æ¨¡å¼æè¿°</strong>ï¼šåè°ƒè€…åè°ƒå¤šä¸ªå‚ä¸è€…ï¼Œåˆ†å‡†å¤‡å’Œæäº¤ä¸¤ä¸ªé˜¶æ®µã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 2PC åè°ƒè€…å®ç°ç¤ºä¾‹</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TwoPhaseCommitCoordinator</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderService orderService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryService inventoryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountService accountService;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrderDistributed</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">transactionId</span> <span class="hljs-operator">=</span> generateTransactionId();
        List&lt;Participant&gt; participants = Arrays.asList(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Participant</span>(<span class="hljs-string">"order"</span>, () -&gt; orderService.prepareCreate(order, transactionId)),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Participant</span>(<span class="hljs-string">"inventory"</span>, () -&gt; inventoryService.prepareDeduct(order, transactionId)),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Participant</span>(<span class="hljs-string">"account"</span>, () -&gt; accountService.prepareDeduct(order, transactionId))
        );
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// é˜¶æ®µä¸€ï¼šå‡†å¤‡é˜¶æ®µ</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">allPrepared</span> <span class="hljs-operator">=</span> preparePhase(participants, transactionId);
            
            <span class="hljs-keyword">if</span> (allPrepared) {
                <span class="hljs-comment">// é˜¶æ®µäºŒï¼šæäº¤é˜¶æ®µ</span>
                commitPhase(participants, transactionId);
                log.info(<span class="hljs-string">"åˆ†å¸ƒå¼äº‹åŠ¡æäº¤æˆåŠŸ: {}"</span>, transactionId);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// é˜¶æ®µäºŒï¼šå›æ»šé˜¶æ®µ</span>
                rollbackPhase(participants, transactionId);
                log.warn(<span class="hljs-string">"åˆ†å¸ƒå¼äº‹åŠ¡å›æ»š: {}"</span>, transactionId);
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            rollbackPhase(participants, transactionId);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DistributedTransactionException</span>(<span class="hljs-string">"åˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œå¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preparePhase</span><span class="hljs-params">(List&lt;Participant&gt; participants, String transactionId)</span> {
        <span class="hljs-keyword">for</span> (Participant participant : participants) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">boolean</span> <span class="hljs-variable">prepared</span> <span class="hljs-operator">=</span> participant.prepare();
                <span class="hljs-keyword">if</span> (!prepared) {
                    log.warn(<span class="hljs-string">"å‚ä¸è€…å‡†å¤‡å¤±è´¥: {}, äº‹åŠ¡: {}"</span>, participant.getName(), transactionId);
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"å‚ä¸è€…å‡†å¤‡å¼‚å¸¸: {}, äº‹åŠ¡: {}"</span>, participant.getName(), transactionId, e);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commitPhase</span><span class="hljs-params">(List&lt;Participant&gt; participants, String transactionId)</span> {
        <span class="hljs-keyword">for</span> (Participant participant : participants) {
            <span class="hljs-keyword">try</span> {
                participant.commit();
            } <span class="hljs-keyword">catch</span> (Exception e) {
                <span class="hljs-comment">// æäº¤é˜¶æ®µå¤±è´¥éœ€è¦äººå·¥å¹²é¢„</span>
                log.error(<span class="hljs-string">"å‚ä¸è€…æäº¤å¤±è´¥: {}, äº‹åŠ¡: {}"</span>, participant.getName(), transactionId, e);
                <span class="hljs-comment">// è®°å½•å¼‚å¸¸ï¼Œéœ€è¦è¡¥å¿</span>
                recordCompensationTask(participant.getName(), transactionId, <span class="hljs-string">"COMMIT"</span>);
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollbackPhase</span><span class="hljs-params">(List&lt;Participant&gt; participants, String transactionId)</span> {
        <span class="hljs-keyword">for</span> (Participant participant : participants) {
            <span class="hljs-keyword">try</span> {
                participant.rollback();
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"å‚ä¸è€…å›æ»šå¤±è´¥: {}, äº‹åŠ¡: {}"</span>, participant.getName(), transactionId, e);
                <span class="hljs-comment">// è®°å½•å¼‚å¸¸ï¼Œéœ€è¦è¡¥å¿</span>
                recordCompensationTask(participant.getName(), transactionId, <span class="hljs-string">"ROLLBACK"</span>);
            }
        }
    }
}

<span class="hljs-comment">// å‚ä¸è€…æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Participant</span> {
    String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">prepare</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollback</span><span class="hljs-params">()</span>;
}
</code></pre>
<h3 data-id="heading-6">2. Sagaæ¨¡å¼</h3>
<p><strong>æ¨¡å¼æè¿°</strong>ï¼šå°†åˆ†å¸ƒå¼äº‹åŠ¡æ‹†åˆ†ä¸ºä¸€ç³»åˆ—æœ¬åœ°äº‹åŠ¡ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰å¯¹åº”çš„è¡¥å¿æ“ä½œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Saga åè°ƒè€…å®ç°</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SagaCoordinator</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> SagaStepExecutor stepExecutor;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> SagaStateRepository stateRepository;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeOrderSaga</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sagaId</span> <span class="hljs-operator">=</span> generateSagaId();
        <span class="hljs-type">SagaState</span> <span class="hljs-variable">sagaState</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaState</span>(sagaId, order);
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å®šä¹‰Sagaæ­¥éª¤</span>
            List&lt;SagaStep&gt; steps = Arrays.asList(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaStep</span>(<span class="hljs-string">"create_order"</span>, 
                    () -&gt; stepExecutor.createOrder(order, sagaId),
                    () -&gt; stepExecutor.compensateOrder(order, sagaId)),
                    
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaStep</span>(<span class="hljs-string">"deduct_inventory"</span>,
                    () -&gt; stepExecutor.deductInventory(order, sagaId), 
                    () -&gt; stepExecutor.compensateInventory(order, sagaId)),
                    
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaStep</span>(<span class="hljs-string">"deduct_balance"</span>,
                    () -&gt; stepExecutor.deductBalance(order, sagaId),
                    () -&gt; stepExecutor.compensateBalance(order, sagaId)),
                    
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaStep</span>(<span class="hljs-string">"send_notification"</span>,
                    () -&gt; stepExecutor.sendNotification(order, sagaId),
                    <span class="hljs-literal">null</span>) <span class="hljs-comment">// æœ€åä¸€æ­¥ä¸éœ€è¦è¡¥å¿</span>
            );
            
            <span class="hljs-comment">// æ‰§è¡ŒSaga</span>
            executeSagaSteps(steps, sagaState);
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"Sagaæ‰§è¡Œå¤±è´¥: {}"</span>, sagaId, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SagaException</span>(<span class="hljs-string">"è®¢å•åˆ›å»ºå¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeSagaSteps</span><span class="hljs-params">(List&lt;SagaStep&gt; steps, SagaState sagaState)</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; steps.size(); i++) {
            <span class="hljs-type">SagaStep</span> <span class="hljs-variable">step</span> <span class="hljs-operator">=</span> steps.get(i);
            sagaState.setCurrentStep(step.getName());
            
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡Œæ­£å‘æ“ä½œ</span>
                step.execute();
                sagaState.recordSuccess(step.getName());
                
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"Sagaæ­¥éª¤æ‰§è¡Œå¤±è´¥: {}, æ­¥éª¤: {}"</span>, sagaState.getSagaId(), step.getName(), e);
                sagaState.recordFailure(step.getName(), e.getMessage());
                
                <span class="hljs-comment">// æ‰§è¡Œè¡¥å¿æ“ä½œ</span>
                compensatePreviousSteps(steps, i, sagaState);
                <span class="hljs-keyword">break</span>;
            }
        }
        
        <span class="hljs-comment">// ä¿å­˜SagaçŠ¶æ€</span>
        stateRepository.save(sagaState);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">compensatePreviousSteps</span><span class="hljs-params">(List&lt;SagaStep&gt; steps, <span class="hljs-type">int</span> failedIndex, SagaState sagaState)</span> {
        <span class="hljs-comment">// ä»å¤±è´¥æ­¥éª¤çš„å‰ä¸€æ­¥å¼€å§‹åå‘è¡¥å¿</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> failedIndex - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-type">SagaStep</span> <span class="hljs-variable">step</span> <span class="hljs-operator">=</span> steps.get(i);
            <span class="hljs-keyword">if</span> (step.getCompensate() != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">try</span> {
                    step.compensate();
                    sagaState.recordCompensation(step.getName());
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    log.error(<span class="hljs-string">"Sagaè¡¥å¿æ“ä½œå¤±è´¥: {}, æ­¥éª¤: {}"</span>, sagaState.getSagaId(), step.getName(), e);
                    sagaState.recordCompensationFailure(step.getName(), e.getMessage());
                    <span class="hljs-comment">// è¡¥å¿å¤±è´¥éœ€è¦äººå·¥å¹²é¢„</span>
                }
            }
        }
    }
}

<span class="hljs-comment">// Sagaæ­¥éª¤å®šä¹‰</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SagaStep</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Runnable execute;
    <span class="hljs-keyword">private</span> Runnable compensate;
}
</code></pre>
<h3 data-id="heading-7">3. TCCæ¨¡å¼ (Try-Confirm-Cancel)</h3>
<p><strong>æ¨¡å¼æè¿°</strong>ï¼šæ¯ä¸ªæœåŠ¡æä¾›Tryã€Confirmã€Cancelä¸‰ä¸ªæ¥å£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// TCC è®¢å•æœåŠ¡å®ç°</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TccOrderService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderRepository orderRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> TccTransactionRepository tccRepository;
    
    <span class="hljs-comment">// Tryé˜¶æ®µï¼šé¢„ç•™èµ„æº</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryCreateOrder</span><span class="hljs-params">(Order order, String transactionId)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ£€æŸ¥ä¸šåŠ¡çº¦æŸ</span>
            validateOrder(order);
            
            <span class="hljs-comment">// åˆ›å»ºé¢„è®¢å•çŠ¶æ€</span>
            <span class="hljs-type">Order</span> <span class="hljs-variable">pendingOrder</span> <span class="hljs-operator">=</span> order.toPending(transactionId);
            orderRepository.save(pendingOrder);
            
            <span class="hljs-comment">// è®°å½•TCCçŠ¶æ€</span>
            <span class="hljs-type">TccTransaction</span> <span class="hljs-variable">tcc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TccTransaction</span>(transactionId, <span class="hljs-string">"order"</span>, <span class="hljs-string">"CREATE"</span>);
            tccRepository.save(tcc);
            
            log.info(<span class="hljs-string">"è®¢å•Tryé˜¶æ®µæˆåŠŸ: {}"</span>, transactionId);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"è®¢å•Tryé˜¶æ®µå¤±è´¥: {}"</span>, transactionId, e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    
    <span class="hljs-comment">// Confirmé˜¶æ®µï¼šç¡®è®¤æ“ä½œ</span>
    <span class="hljs-meta">@Transactional</span> 
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">confirmCreateOrder</span><span class="hljs-params">(String transactionId)</span> {
        <span class="hljs-type">TccTransaction</span> <span class="hljs-variable">tcc</span> <span class="hljs-operator">=</span> tccRepository.findByTransactionIdAndService(transactionId, <span class="hljs-string">"order"</span>);
        <span class="hljs-keyword">if</span> (tcc == <span class="hljs-literal">null</span> || !<span class="hljs-string">"CREATE"</span>.equals(tcc.getAction())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TccException</span>(<span class="hljs-string">"æ— æ•ˆçš„TCCäº‹åŠ¡: "</span> + transactionId);
        }
        
        <span class="hljs-comment">// æ›´æ–°è®¢å•çŠ¶æ€ä¸ºç¡®è®¤</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">pendingOrder</span> <span class="hljs-operator">=</span> orderRepository.findByTransactionId(transactionId);
        <span class="hljs-keyword">if</span> (pendingOrder != <span class="hljs-literal">null</span>) {
            pendingOrder.confirm();
            orderRepository.save(pendingOrder);
            
            <span class="hljs-comment">// åˆ é™¤TCCè®°å½•</span>
            tccRepository.delete(tcc);
        }
        
        log.info(<span class="hljs-string">"è®¢å•Confirmé˜¶æ®µæˆåŠŸ: {}"</span>, transactionId);
    }
    
    <span class="hljs-comment">// Cancelé˜¶æ®µï¼šå–æ¶ˆæ“ä½œ</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelCreateOrder</span><span class="hljs-params">(String transactionId)</span> {
        <span class="hljs-type">TccTransaction</span> <span class="hljs-variable">tcc</span> <span class="hljs-operator">=</span> tccRepository.findByTransactionIdAndService(transactionId, <span class="hljs-string">"order"</span>);
        <span class="hljs-keyword">if</span> (tcc == <span class="hljs-literal">null</span> || !<span class="hljs-string">"CREATE"</span>.equals(tcc.getAction())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TccException</span>(<span class="hljs-string">"æ— æ•ˆçš„TCCäº‹åŠ¡: "</span> + transactionId);
        }
        
        <span class="hljs-comment">// åˆ é™¤é¢„è®¢å•</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">pendingOrder</span> <span class="hljs-operator">=</span> orderRepository.findByTransactionId(transactionId);
        <span class="hljs-keyword">if</span> (pendingOrder != <span class="hljs-literal">null</span>) {
            orderRepository.delete(pendingOrder);
            
            <span class="hljs-comment">// åˆ é™¤TCCè®°å½•</span>
            tccRepository.delete(tcc);
        }
        
        log.info(<span class="hljs-string">"è®¢å•Cancelé˜¶æ®µæˆåŠŸ: {}"</span>, transactionId);
    }
}
</code></pre>
<h2 data-id="heading-8">Spring Cloudåˆ†å¸ƒå¼äº‹åŠ¡å®è·µ</h2>
<h3 data-id="heading-9">1. ä½¿ç”¨Seataæ¡†æ¶</h3>
<p><strong>Seataé…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">seata:</span>
  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">application-id:</span> <span class="hljs-string">order-service</span>
  <span class="hljs-attr">tx-service-group:</span> <span class="hljs-string">my_tx_group</span>
  <span class="hljs-attr">service:</span>
    <span class="hljs-attr">vgroup-mapping:</span>
      <span class="hljs-attr">my_tx_group:</span> <span class="hljs-string">default</span>
    <span class="hljs-attr">disable-global-transaction:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>
</code></pre>
<p><strong>å…¨å±€äº‹åŠ¡ä½¿ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®¢å•æœåŠ¡</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SeataOrderService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryFeignClient inventoryFeignClient;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountFeignClient accountFeignClient;
    
    <span class="hljs-comment">// å¼€å¯å…¨å±€äº‹åŠ¡</span>
    <span class="hljs-meta">@GlobalTransactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrderWithSeata</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºæœ¬åœ°è®¢å•</span>
        orderMapper.insert(order);
        log.info(<span class="hljs-string">"æœ¬åœ°è®¢å•åˆ›å»ºæˆåŠŸ"</span>);
        
        <span class="hljs-comment">// 2. è°ƒç”¨åº“å­˜æœåŠ¡ï¼ˆè¿œç¨‹æœåŠ¡ï¼‰</span>
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">inventoryResult</span> <span class="hljs-operator">=</span> inventoryFeignClient.deductStock(order.getItems());
        <span class="hljs-keyword">if</span> (!Boolean.TRUE.equals(inventoryResult)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åº“å­˜æ‰£å‡å¤±è´¥"</span>);
        }
        log.info(<span class="hljs-string">"åº“å­˜æ‰£å‡æˆåŠŸ"</span>);
        
        <span class="hljs-comment">// 3. è°ƒç”¨è´¦æˆ·æœåŠ¡ï¼ˆè¿œç¨‹æœåŠ¡ï¼‰</span>
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">accountResult</span> <span class="hljs-operator">=</span> accountFeignClient.deductBalance(order.getUserId(), order.getAmount());
        <span class="hljs-keyword">if</span> (!Boolean.TRUE.equals(accountResult)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ä½™é¢æ‰£å‡å¤±è´¥"</span>);
        }
        log.info(<span class="hljs-string">"ä½™é¢æ‰£å‡æˆåŠŸ"</span>);
        
        <span class="hljs-comment">// 4. æ›´æ–°è®¢å•çŠ¶æ€</span>
        order.complete();
        orderMapper.updateStatus(order);
        log.info(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°å®Œæˆ"</span>);
    }
}

<span class="hljs-comment">// Feignå®¢æˆ·ç«¯é…ç½®</span>
<span class="hljs-meta">@FeignClient(name = "inventory-service", path = "/api/inventory")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">InventoryFeignClient</span> {
    
    <span class="hljs-meta">@PostMapping("/deduct")</span>
    Boolean <span class="hljs-title function_">deductStock</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> List&lt;OrderItem&gt; items)</span>;
}

<span class="hljs-meta">@FeignClient(name = "account-service", path = "/api/account")</span>  
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AccountFeignClient</span> {
    
    <span class="hljs-meta">@PostMapping("/deduct")</span>
    Boolean <span class="hljs-title function_">deductBalance</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> Long userId, <span class="hljs-meta">@RequestParam</span> BigDecimal amount)</span>;
}
</code></pre>
<h3 data-id="heading-10">2. äº‹åŠ¡æ¶ˆæ¯æ¨¡å¼</h3>
<p><strong>åŸºäºRocketMQçš„äº‹åŠ¡æ¶ˆæ¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionMessageService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RocketMQTemplate rocketMQTemplate;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderService orderService;
    
    <span class="hljs-comment">// å‘é€äº‹åŠ¡æ¶ˆæ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrderWithTransactionMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// æ‰§è¡Œæœ¬åœ°äº‹åŠ¡</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">savedOrder</span> <span class="hljs-operator">=</span> orderService.createOrderLocal(order);
        
        <span class="hljs-comment">// å‘é€äº‹åŠ¡æ¶ˆæ¯</span>
        <span class="hljs-type">TransactionSendResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> rocketMQTemplate.sendMessageInTransaction(
            <span class="hljs-string">"order-topic"</span>, 
            MessageBuilder.withPayload(order).build(),
            savedOrder.getId() <span class="hljs-comment">// ä¸šåŠ¡å‚æ•°</span>
        );
        
        log.info(<span class="hljs-string">"äº‹åŠ¡æ¶ˆæ¯å‘é€ç»“æœ: {}"</span>, result.getSendStatus());
    }
    
    <span class="hljs-comment">// æœ¬åœ°äº‹åŠ¡æ‰§è¡Œå™¨</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeLocalTransaction</span><span class="hljs-params">(String transactionId, Long orderId)</span> {
        <span class="hljs-comment">// æŸ¥è¯¢è®¢å•çŠ¶æ€</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderService.findById(orderId);
        <span class="hljs-keyword">if</span> (order != <span class="hljs-literal">null</span> &amp;&amp; order.isPending()) {
            <span class="hljs-comment">// æ›´æ–°è®¢å•ä¸ºå¤„ç†ä¸­</span>
            order.processing();
            orderService.updateOrder(order);
            log.info(<span class="hljs-string">"æœ¬åœ°äº‹åŠ¡æ‰§è¡ŒæˆåŠŸ: {}"</span>, transactionId);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è®¢å•çŠ¶æ€å¼‚å¸¸: "</span> + orderId);
        }
    }
    
    <span class="hljs-comment">// äº‹åŠ¡å›æŸ¥</span>
    <span class="hljs-keyword">public</span> LocalTransactionState <span class="hljs-title function_">checkLocalTransaction</span><span class="hljs-params">(Message message)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">transactionId</span> <span class="hljs-operator">=</span> message.getTransactionId();
        <span class="hljs-type">Long</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> Long.valueOf(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.getBody()));
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderService.findById(orderId);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> LocalTransactionState.ROLLBACK_MESSAGE;
            }
            
            <span class="hljs-keyword">if</span> (order.isCompleted() || order.isProcessing()) {
                <span class="hljs-keyword">return</span> LocalTransactionState.COMMIT_MESSAGE;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (order.isFailed()) {
                <span class="hljs-keyword">return</span> LocalTransactionState.ROLLBACK_MESSAGE;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> LocalTransactionState.UNKNOW;
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"äº‹åŠ¡å›æŸ¥å¼‚å¸¸: {}"</span>, transactionId, e);
            <span class="hljs-keyword">return</span> LocalTransactionState.UNKNOW;
        }
    }
}
</code></pre>
<h2 data-id="heading-11">äº‹ä»¶é©±åŠ¨æ¶æ„ä¸æœ€ç»ˆä¸€è‡´æ€§</h2>
<h3 data-id="heading-12">1. åŸºäºäº‹ä»¶çš„Sagaå®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// äº‹ä»¶å‘å¸ƒæœåŠ¡</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DomainEventPublisher</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ApplicationEventPublisher eventPublisher;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> EventStoreRepository eventStoreRepository;
    
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishWithTransaction</span><span class="hljs-params">(DomainEvent event)</span> {
        <span class="hljs-comment">// å­˜å‚¨äº‹ä»¶ï¼ˆä¸ä¸šåŠ¡æ“ä½œåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼‰</span>
        eventStoreRepository.save(event.toEventStore());
        
        <span class="hljs-comment">// å‘å¸ƒäº‹ä»¶</span>
        eventPublisher.publishEvent(event);
        
        log.info(<span class="hljs-string">"é¢†åŸŸäº‹ä»¶å‘å¸ƒ: {}"</span>, event.getEventType());
    }
}

<span class="hljs-comment">// è®¢å•åˆ›å»ºäº‹ä»¶</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderCreatedEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DomainEvent</span> {
    <span class="hljs-keyword">private</span> Long orderId;
    <span class="hljs-keyword">private</span> Long userId;
    <span class="hljs-keyword">private</span> BigDecimal amount;
    <span class="hljs-keyword">private</span> List&lt;OrderItem&gt; items;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderCreatedEvent</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"ORDER_CREATED"</span>, order.getId().toString());
        <span class="hljs-built_in">this</span>.orderId = order.getId();
        <span class="hljs-built_in">this</span>.userId = order.getUserId();
        <span class="hljs-built_in">this</span>.amount = order.getAmount();
        <span class="hljs-built_in">this</span>.items = order.getItems();
    }
}

<span class="hljs-comment">// äº‹ä»¶å¤„ç†å™¨</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderCreatedEventHandler</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryService inventoryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountService accountService;
    
    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        log.info(<span class="hljs-string">"å¤„ç†è®¢å•åˆ›å»ºäº‹ä»¶: {}"</span>, event.getOrderId());
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ‰£å‡åº“å­˜</span>
            inventoryService.deductStock(event.getItems());
            log.info(<span class="hljs-string">"åº“å­˜æ‰£å‡æˆåŠŸ: {}"</span>, event.getOrderId());
            
            <span class="hljs-comment">// æ‰£å‡ä½™é¢</span>
            accountService.deductBalance(event.getUserId(), event.getAmount());
            log.info(<span class="hljs-string">"ä½™é¢æ‰£å‡æˆåŠŸ: {}"</span>, event.getOrderId());
            
            <span class="hljs-comment">// å‘å¸ƒè®¢å•å®Œæˆäº‹ä»¶</span>
            eventPublisher.publish(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderCompletedEvent</span>(event.getOrderId()));
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"è®¢å•å¤„ç†å¤±è´¥: {}"</span>, event.getOrderId(), e);
            
            <span class="hljs-comment">// å‘å¸ƒè®¢å•å¤±è´¥äº‹ä»¶</span>
            eventPublisher.publish(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderFailedEvent</span>(event.getOrderId(), e.getMessage()));
        }
    }
}
</code></pre>
<h3 data-id="heading-13">2. äº‹ä»¶æº¯æºæ¨¡å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// äº‹ä»¶å­˜å‚¨</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "event_store")</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventStore</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-keyword">private</span> String eventId;
    <span class="hljs-keyword">private</span> String aggregateId;
    <span class="hljs-keyword">private</span> String eventType;
    <span class="hljs-keyword">private</span> String eventData;
    <span class="hljs-keyword">private</span> LocalDateTime timestamp;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> version;
}

<span class="hljs-comment">// èšåˆæ ¹åŸºç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AggregateRoot</span> {
    <span class="hljs-keyword">protected</span> String id;
    <span class="hljs-keyword">protected</span> List&lt;DomainEvent&gt; changes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-variable">version</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(DomainEvent event)</span> {
        changes.add(event);
        handle(event);
    }
    
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(DomainEvent event)</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">markChangesAsCommitted</span><span class="hljs-params">()</span> {
        changes.clear();
    }
    
    <span class="hljs-keyword">public</span> List&lt;DomainEvent&gt; <span class="hljs-title function_">getUncommittedChanges</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(changes);
    }
}

<span class="hljs-comment">// è®¢å•èšåˆæ ¹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderAggregate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AggregateRoot</span> {
    <span class="hljs-keyword">private</span> OrderStatus status;
    <span class="hljs-keyword">private</span> BigDecimal amount;
    <span class="hljs-keyword">private</span> Long userId;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderAggregate</span><span class="hljs-params">(String orderId, Long userId, BigDecimal amount)</span> {
        <span class="hljs-built_in">this</span>.id = orderId;
        <span class="hljs-built_in">this</span>.userId = userId;
        <span class="hljs-built_in">this</span>.amount = amount;
        <span class="hljs-built_in">this</span>.status = OrderStatus.CREATED;
        
        apply(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderCreatedEvent</span>(orderId, userId, amount));
    }
    
    <span class="hljs-comment">// é‡å»ºèšåˆæ ¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderAggregate</span><span class="hljs-params">(String orderId, List&lt;DomainEvent&gt; events)</span> {
        <span class="hljs-built_in">this</span>.id = orderId;
        <span class="hljs-keyword">for</span> (DomainEvent event : events) {
            handle(event);
            <span class="hljs-built_in">this</span>.version++;
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">complete</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.status != OrderStatus.CREATED) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"è®¢å•çŠ¶æ€å¼‚å¸¸"</span>);
        }
        <span class="hljs-built_in">this</span>.status = OrderStatus.COMPLETED;
        apply(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderCompletedEvent</span>(<span class="hljs-built_in">this</span>.id));
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fail</span><span class="hljs-params">(String reason)</span> {
        <span class="hljs-built_in">this</span>.status = OrderStatus.FAILED;
        apply(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderFailedEvent</span>(<span class="hljs-built_in">this</span>.id, reason));
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(DomainEvent event)</span> {
        <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> OrderCreatedEvent) {
            handleOrderCreated((OrderCreatedEvent) event);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> OrderCompletedEvent) {
            handleOrderCompleted((OrderCompletedEvent) event);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> OrderFailedEvent) {
            handleOrderFailed((OrderFailedEvent) event);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        <span class="hljs-built_in">this</span>.userId = event.getUserId();
        <span class="hljs-built_in">this</span>.amount = event.getAmount();
        <span class="hljs-built_in">this</span>.status = OrderStatus.CREATED;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCompleted</span><span class="hljs-params">(OrderCompletedEvent event)</span> {
        <span class="hljs-built_in">this</span>.status = OrderStatus.COMPLETED;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderFailed</span><span class="hljs-params">(OrderFailedEvent event)</span> {
        <span class="hljs-built_in">this</span>.status = OrderStatus.FAILED;
    }
}
</code></pre>
<h2 data-id="heading-14">å¾®æœåŠ¡äº‹åŠ¡ç›‘æ§</h2>
<h3 data-id="heading-15">1. åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// äº‹åŠ¡é“¾è·¯è¿½è¸ª</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DistributedTransactionTracingAspect</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> Tracer tracer;
    
    <span class="hljs-meta">@Around("@annotation(globalTransactional)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">traceGlobalTransaction</span><span class="hljs-params">(ProceedingJoinPoint joinPoint, 
                                       GlobalTransactional globalTransactional)</span> <span class="hljs-keyword">throws</span> Throwable {
        
        <span class="hljs-type">Span</span> <span class="hljs-variable">transactionSpan</span> <span class="hljs-operator">=</span> tracer.nextSpan().name(<span class="hljs-string">"global-transaction"</span>).start();
        
        <span class="hljs-keyword">try</span> (Tracer.<span class="hljs-type">SpanInScope</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> tracer.withSpanInScope(transactionSpan)) {
            <span class="hljs-comment">// æ·»åŠ äº‹åŠ¡æ ‡ç­¾</span>
            transactionSpan.tag(<span class="hljs-string">"transaction.type"</span>, <span class="hljs-string">"global"</span>);
            transactionSpan.tag(<span class="hljs-string">"transaction.timeout"</span>, 
                String.valueOf(globalTransactional.timeoutMills()));
            
            <span class="hljs-comment">// è®°å½•äº‹åŠ¡å¼€å§‹</span>
            log.info(<span class="hljs-string">"å…¨å±€äº‹åŠ¡å¼€å§‹: {}"</span>, transactionSpan.context().traceId());
            
            <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> joinPoint.proceed();
            
            <span class="hljs-comment">// è®°å½•äº‹åŠ¡æˆåŠŸ</span>
            transactionSpan.finish();
            log.info(<span class="hljs-string">"å…¨å±€äº‹åŠ¡å®Œæˆ: {}"</span>, transactionSpan.context().traceId());
            
            <span class="hljs-keyword">return</span> result;
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è®°å½•äº‹åŠ¡å¤±è´¥</span>
            transactionSpan.error(e);
            transactionSpan.finish();
            log.error(<span class="hljs-string">"å…¨å±€äº‹åŠ¡å¤±è´¥: {}"</span>, transactionSpan.context().traceId(), e);
            <span class="hljs-keyword">throw</span> e;
        }
    }
}

<span class="hljs-comment">// åœ¨Feignè°ƒç”¨ä¸­ä¼ æ’­è¿½è¸ªä¸Šä¸‹æ–‡</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeignTracingConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Feign.Builder <span class="hljs-title function_">feignBuilder</span><span class="hljs-params">(Tracer tracer)</span> {
        <span class="hljs-keyword">return</span> Feign.builder()
            .client(<span class="hljs-keyword">new</span> <span class="hljs-title class_">feign</span>.Client.Default(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>))
            .requestInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ForwardedHeaderInterceptor</span>(tracer));
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForwardedHeaderInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RequestInterceptor</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Tracer tracer;
        
        ForwardedHeaderInterceptor(Tracer tracer) {
            <span class="hljs-built_in">this</span>.tracer = tracer;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(RequestTemplate template)</span> {
            <span class="hljs-type">Span</span> <span class="hljs-variable">currentSpan</span> <span class="hljs-operator">=</span> tracer.currentSpan();
            <span class="hljs-keyword">if</span> (currentSpan != <span class="hljs-literal">null</span>) {
                template.header(<span class="hljs-string">"X-B3-TraceId"</span>, currentSpan.context().traceIdString());
                template.header(<span class="hljs-string">"X-B3-SpanId"</span>, currentSpan.context().spanIdString());
                template.header(<span class="hljs-string">"X-B3-ParentSpanId"</span>, 
                    currentSpan.context().parentIdString());
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-16">2. äº‹åŠ¡å¥åº·æ£€æŸ¥</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionHealthIndicator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HealthIndicator</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> TransactionMetrics transactionMetrics;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> DataSource dataSource;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Health <span class="hljs-title function_">health</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ£€æŸ¥æ•°æ®åº“è¿æ¥</span>
            checkDatabaseConnection();
            
            <span class="hljs-comment">// æ£€æŸ¥äº‹åŠ¡æŒ‡æ ‡</span>
            Map&lt;String, Object&gt; details = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            details.put(<span class="hljs-string">"activeTransactions"</span>, transactionMetrics.getActiveTransactionCount());
            details.put(<span class="hljs-string">"rollbackRate"</span>, transactionMetrics.getRollbackRate());
            details.put(<span class="hljs-string">"averageDuration"</span>, transactionMetrics.getAverageDuration());
            
            <span class="hljs-comment">// åˆ¤æ–­å¥åº·çŠ¶æ€</span>
            <span class="hljs-keyword">if</span> (transactionMetrics.getRollbackRate() &gt; <span class="hljs-number">0.1</span>) {
                <span class="hljs-keyword">return</span> Health.down()
                    .withDetails(details)
                    .withException(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"äº‹åŠ¡å›æ»šç‡è¿‡é«˜"</span>))
                    .build();
            }
            
            <span class="hljs-keyword">if</span> (transactionMetrics.getAverageDuration() &gt; <span class="hljs-number">5000</span>) {
                <span class="hljs-keyword">return</span> Health.down()
                    .withDetails(details)
                    .withException(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"äº‹åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿"</span>))
                    .build();
            }
            
            <span class="hljs-keyword">return</span> Health.up().withDetails(details).build();
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> Health.down(e).build();
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkDatabaseConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> dataSource.getConnection()) {
            <span class="hljs-keyword">if</span> (!conn.isValid(<span class="hljs-number">5</span>)) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLException</span>(<span class="hljs-string">"æ•°æ®åº“è¿æ¥æ— æ•ˆ"</span>);
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-17">æœ€ä½³å®è·µä¸æ¨¡å¼é€‰æ‹©</h2>
<h3 data-id="heading-18">1. æ¨¡å¼é€‰æ‹©æŒ‡å—</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ¨¡å¼</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>å¼ºä¸€è‡´æ€§è¦æ±‚é«˜</td><td>TCCæ¨¡å¼</td><td>ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œæ€§èƒ½è¾ƒå¥½</td></tr><tr><td>ä¸šåŠ¡æµç¨‹å¤æ‚</td><td>Sagaæ¨¡å¼</td><td>çµæ´»ï¼Œæ”¯æŒé•¿ä¸šåŠ¡æµç¨‹</td></tr><tr><td>ç®€å•ä¸šåŠ¡åœºæ™¯</td><td>äº‹åŠ¡æ¶ˆæ¯</td><td>å®ç°ç®€å•ï¼Œæœ€ç»ˆä¸€è‡´æ€§</td></tr><tr><td>å·²æœ‰Spring Cloudç”Ÿæ€</td><td>Seata</td><td>é›†æˆç®€å•ï¼ŒåŠŸèƒ½å®Œå–„</td></tr><tr><td>äº‹ä»¶é©±åŠ¨æ¶æ„</td><td>äº‹ä»¶æº¯æº</td><td>å¤©ç„¶åŒ¹é…ï¼Œå®¡è®¡å‹å¥½</td></tr></tbody></table>
<h3 data-id="heading-19">2. é™çº§å’Œå®¹é”™ç­–ç•¥</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CircuitBreakerTransactionService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryService inventoryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> AccountService accountService;
    
    <span class="hljs-comment">// ä½¿ç”¨æ–­è·¯å™¨ä¿æŠ¤è¿œç¨‹è°ƒç”¨</span>
    <span class="hljs-meta">@CircuitBreaker(name = "inventoryService", fallbackMethod = "fallbackDeductInventory")</span>
    <span class="hljs-meta">@Retry(name = "inventoryService")</span>
    <span class="hljs-meta">@TimeLimiter(name = "inventoryService")</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Boolean&gt; <span class="hljs-title function_">deductInventoryWithProtection</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; 
            inventoryService.deductStock(order.getItems()));
    }
    
    <span class="hljs-comment">// é™çº§ç­–ç•¥</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;Boolean&gt; <span class="hljs-title function_">fallbackDeductInventory</span><span class="hljs-params">(Order order, Exception e)</span> {
        log.warn(<span class="hljs-string">"åº“å­˜æœåŠ¡é™çº§ï¼Œè®¢å•è¿›å…¥å¾…å¤„ç†çŠ¶æ€: {}"</span>, order.getId());
        
        <span class="hljs-comment">// å°†è®¢å•æ ‡è®°ä¸ºå¾…å¤„ç†ï¼Œåç»­è¡¥å¿</span>
        order.markAsPending();
        orderService.updateOrder(order);
        
        <span class="hljs-comment">// å‘å¸ƒå¾…å¤„ç†äº‹ä»¶</span>
        eventPublisher.publish(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderPendingEvent</span>(order.getId()));
        
        <span class="hljs-keyword">return</span> CompletableFuture.completedFuture(<span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-comment">// å¼‚æ­¥è¡¥å¿ä»»åŠ¡</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-meta">@Scheduled(fixedDelay = 30000)</span> <span class="hljs-comment">// æ¯30ç§’æ‰§è¡Œä¸€æ¬¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">compensatePendingOrders</span><span class="hljs-params">()</span> {
        List&lt;Order&gt; pendingOrders = orderService.findPendingOrders();
        
        <span class="hljs-keyword">for</span> (Order order : pendingOrders) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// é‡è¯•åº“å­˜æ‰£å‡</span>
                <span class="hljs-type">Boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> inventoryService.deductStock(order.getItems());
                <span class="hljs-keyword">if</span> (Boolean.TRUE.equals(result)) {
                    order.complete();
                    orderService.updateOrder(order);
                    log.info(<span class="hljs-string">"è¡¥å¿å¤„ç†æˆåŠŸ: {}"</span>, order.getId());
                }
            } <span class="hljs-keyword">catch</span> (Exception e) {
                log.error(<span class="hljs-string">"è¡¥å¿å¤„ç†å¤±è´¥: {}"</span>, order.getId(), e);
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-20">æ€»ç»“</h2>
<p>å¾®æœåŠ¡æ¶æ„ä¸‹çš„äº‹åŠ¡ç®¡ç†æ˜¯ä¸€ä¸ªå¤æ‚ä½†é‡è¦çš„è¯é¢˜ï¼š</p>
<h3 data-id="heading-21">æ ¸å¿ƒè¦ç‚¹ï¼š</h3>
<ol>
<li><strong>æ”¾å¼ƒå¼ºä¸€è‡´æ€§</strong>ï¼Œæ‹¥æŠ±æœ€ç»ˆä¸€è‡´æ€§</li>
<li><strong>é€‰æ‹©åˆé€‚çš„æ¨¡å¼</strong>åŸºäºä¸šåŠ¡éœ€æ±‚</li>
<li><strong>è®¾è®¡è¡¥å¿æœºåˆ¶</strong>å¤„ç†å¤±è´¥åœºæ™¯</li>
<li><strong>å®æ–½å…¨é¢ç›‘æ§</strong>ç¡®ä¿ç³»ç»Ÿå¯é æ€§</li>
</ol>
<h3 data-id="heading-22">æŠ€æœ¯é€‰æ‹©ï¼š</h3>
<ul>
<li><strong>ç®€å•åœºæ™¯</strong>ï¼šäº‹åŠ¡æ¶ˆæ¯ã€æœ¬åœ°æ¶ˆæ¯è¡¨</li>
<li><strong>å¤æ‚ä¸šåŠ¡</strong>ï¼šSagaæ¨¡å¼ã€TCCæ¨¡å¼</li>
<li><strong>Spring Cloudç”Ÿæ€</strong>ï¼šSeataæ¡†æ¶</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šäº‹ä»¶æº¯æºã€CQRS</li>
</ul>
<h3 data-id="heading-23">æˆåŠŸå…³é”®ï¼š</h3>
<ol>
<li><strong>ä¸šåŠ¡åˆ†æ</strong>ï¼šç†è§£ä¸šåŠ¡çœŸæ­£çš„ä¸€è‡´æ€§éœ€æ±‚</li>
<li><strong>æ¸è¿›å¼å®æ–½</strong>ï¼šä»ç®€å•æ¨¡å¼å¼€å§‹ï¼Œé€æ­¥å¤æ‚åŒ–</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šè·¨å›¢é˜Ÿçš„äº‹åŠ¡åè®®è®¾è®¡</li>
</ol>
<p>è®°ä½ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ²¡æœ‰é“¶å¼¹è§£å†³æ–¹æ¡ˆã€‚æœ€é‡è¦çš„æ˜¯æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯é€‰æ‹©æœ€é€‚åˆçš„äº‹åŠ¡ç­–ç•¥ã€‚</p>
<hr/>
<p><strong>ä¸‹æœŸé¢„å‘Š</strong>ï¼šã€ŠSpring 6 &amp; Spring Boot 3æ–°ç‰¹æ€§ï¼šäº‹åŠ¡ç®¡ç†çš„é©æ–°ã€‹</p>
<p>å¦‚æœè§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ åœ¨å¾®æœåŠ¡äº‹åŠ¡æ–¹é¢çš„å®æˆ˜ç»éªŒå’ŒæŒ‘æˆ˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[.NET 10 æ€§èƒ½çªç ´ï¼šæŒç»­ä¼˜åŒ–æ‰æ˜¯è´¨å˜å…³é”®]]></title>    <link>https://juejin.cn/post/7571751304624799790</link>    <guid>https://juejin.cn/post/7571751304624799790</guid>    <pubDate>2025-11-13T00:41:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571751304624799790" data-draft-id="7571678763781701666" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=".NET 10 æ€§èƒ½çªç ´ï¼šæŒç»­ä¼˜åŒ–æ‰æ˜¯è´¨å˜å…³é”®"/> <meta itemprop="keywords" content="åç«¯,.NET,C#"/> <meta itemprop="datePublished" content="2025-11-13T00:41:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°ç ç¼–åŒ "/> <meta itemprop="url" content="https://juejin.cn/user/1308876155395739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            .NET 10 æ€§èƒ½çªç ´ï¼šæŒç»­ä¼˜åŒ–æ‰æ˜¯è´¨å˜å…³é”®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1308876155395739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°ç ç¼–åŒ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T00:41:19.000Z" title="Thu Nov 13 2025 00:41:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>2025å¹´11æœˆ12æ—¥ï¼Œå¾®è½¯åœ¨.NET Conf 2025ä¸Šæ­£å¼å‘å¸ƒäº†.NET 10ã€‚ä½œä¸ºæ–°ä¸€ä»£é•¿æœŸæ”¯æŒï¼ˆLTSï¼‰ç‰ˆæœ¬ï¼Œå®ƒå°†è·å¾—é•¿è¾¾ä¸‰å¹´çš„å®˜æ–¹å®‰å…¨ä¸æœåŠ¡æ”¯æŒï¼Œç›´è‡³2028å¹´11æœˆ10æ—¥ã€‚</p>
<p>å®˜æ–¹ç§°å…¶ä¸º"è¿„ä»Šä¸ºæ­¢æœ€é«˜æ•ˆã€æœ€ç°ä»£ã€æœ€å®‰å…¨ã€æœ€æ™ºèƒ½ã€æ€§èƒ½æœ€é«˜çš„ .NET ç‰ˆæœ¬"ã€‚è¿™å¹¶éè¥é”€è¯æœ¯â€”â€”ä»åº•å±‚è¿è¡Œæ—¶åˆ°é«˜å±‚è¯­è¨€ç‰¹æ€§ï¼Œ.NET 10é€šè¿‡æ•°ç™¾é¡¹ç»†å¾®è€Œç²¾å‡†çš„ä¼˜åŒ–ï¼Œåœ¨ä¸‡äº¿æ¬¡ä»£ç æ‰§è¡Œä¸­ç´¯ç§¯å‡ºæ˜¾è‘—çš„æ€§èƒ½é£è·ƒã€‚</p>
<p>è½¯ä»¶æ€§èƒ½çš„æå‡ï¼Œå¾€å¾€ä¸æ¥è‡ªæŸä¸ªæƒŠå¤©åŠ¨åœ°çš„çªç ´ï¼Œè€Œæºäºå¯¹ç»†èŠ‚çš„æŒç»­æ‰“ç£¨ã€‚å°±åƒåä¹ä¸–çºªçš„"å†°ç‹"å¼—é›·å¾·é‡Œå…‹ï¼Œé æ”¹è‰¯ç»ç¼˜ææ–™ã€ä¼˜åŒ–åˆ‡å‰²ä¸ç‰©æµï¼Œè®©å†°å—è·¨è¶ŠåŠä¸ªåœ°çƒæŠµè¾¾å°åº¦ã€‚</p>
<p>.NET 10çš„è¿›åŒ–é€»è¾‘äº¦æ˜¯å¦‚æ­¤ï¼šæ²¡æœ‰å•ä¸€é©å‘½ï¼Œåªæœ‰ç³»ç»Ÿæ€§çš„å¾®ä¼˜åŒ–ã€‚è¿™äº›ä¼˜åŒ–çœ‹ä¼¼å¾®å°â€”â€”æ¯æ¬¡èŠ‚çœå‡ çº³ç§’ã€å‡ åå­—èŠ‚â€”â€”å´åœ¨é«˜é¢‘è°ƒç”¨åœºæ™¯ä¸‹äº§ç”Ÿå¤åˆæ•ˆåº”ï¼Œæœ€ç»ˆå¸¦æ¥è´¨çš„é£è·ƒã€‚</p>
<h3 data-id="heading-1">ä¸€ã€LINQ çš„è¯­ä¹‰çº§ä¼˜åŒ–</h3>
<p>ä¼ ç»Ÿ LINQ æ˜¯æœºæ¢°æ‰§è¡Œæ“ä½œé“¾ï¼Œè€Œ .NET 10 è®©å®ƒ"ç†è§£æ„å›¾"ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“å¼€å‘å†™ OrderBy(...).Contains(...) æ—¶ï¼Œè¿è¡Œæ—¶ä¼šæ„è¯†åˆ°"æ’åºåå†æŸ¥æ‰¾"å®å±å¤šä½™ï¼Œç›´æ¥è·³è¿‡æ’åºæ­¥éª¤ï¼Œç›´å¥”æºæ•°æ®æœç´¢ã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// dotnet run -c Release -f net9.0 --filter "*" --runtimes net9.0 net10.0</span>
<span class="hljs-keyword">using</span> BenchmarkDotNet.Attributes;
<span class="hljs-keyword">using</span> BenchmarkDotNet.Running;
BenchmarkSwitcher.FromAssembly(<span class="hljs-keyword">typeof</span>(Tests).Assembly).Run(args);
[<span class="hljs-meta">MemoryDiagnoser(displayGenColumns: false)</span>]
[<span class="hljs-meta">HideColumns(<span class="hljs-string">"Job"</span>, <span class="hljs-string">"Error"</span>, <span class="hljs-string">"StdDev"</span>, <span class="hljs-string">"Median"</span>, <span class="hljs-string">"RatioSD"</span>)</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Tests</span>
{
    <span class="hljs-keyword">private</span> IEnumerable&lt;<span class="hljs-built_in">int</span>&gt; _source = Enumerable.Range(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>).ToArray();
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">AppendContains</span>()</span> =&gt; _source.Append(<span class="hljs-number">100</span>).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">ConcatContains</span>()</span> =&gt; _source.Concat(_source).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">DefaultIfEmptyContains</span>()</span> =&gt; _source.DefaultIfEmpty(<span class="hljs-number">42</span>).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">DistinctContains</span>()</span> =&gt; _source.Distinct().Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">OrderByContains</span>()</span> =&gt; _source.OrderBy(x =&gt; x).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">ReverseContains</span>()</span> =&gt; _source.Reverse().Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">UnionContains</span>()</span> =&gt; _source.Union(_source).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">SelectManyContains</span>()</span> =&gt; _source.SelectMany(x =&gt; _source).Contains(<span class="hljs-number">999</span>);
    [<span class="hljs-meta">Benchmark</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">WhereSelectContains</span>()</span> =&gt; _source.Where(x =&gt; <span class="hljs-literal">true</span>).Select(x =&gt; x).Contains(<span class="hljs-number">999</span>);
}
</code></pre>
<p>ç»“æœä»¤äººéœ‡æ’¼ï¼šDistinctContains è€—æ—¶ä» 16,967 ns é™è‡³ 47 nsï¼Œå†…å­˜ä» 58KB é™è‡³ 64 å­—èŠ‚ï¼›OrderByContains ä» 12,884 ns é™è‡³ 50 nsã€‚è¿™ç§ä¼˜åŒ–æœ¬è´¨æ˜¯ç®—æ³•å¤æ‚åº¦çš„é™ç»´â€”â€”ä» O(N log N) å›å½’ O(N)ã€‚</p>













































<table><thead><tr><th>Method</th><th>Runtime</th><th>Mean</th><th>Ratio</th><th>Allocated</th><th>Alloc Ratio</th></tr></thead><tbody><tr><td>DistinctContains</td><td>.NET 9.0</td><td>16,967.31 ns</td><td>1.000</td><td>58656 B</td><td>1.000</td></tr><tr><td>DistinctContains</td><td>.NET 10.0</td><td>46.72 ns</td><td>0.003</td><td>64 B</td><td>0.001</td></tr><tr><td>OrderByContains</td><td>.NET 9.0</td><td>12,884.28 ns</td><td>1.000</td><td>12280 B</td><td>1.000</td></tr><tr><td>OrderByContains</td><td>.NET 10.0</td><td>50.14 ns</td><td>0.004</td><td>88 B</td><td>0.007</td></tr></tbody></table>
<h4 data-id="heading-2">äºŒã€å§”æ‰˜ä¸å±€éƒ¨å‡½æ•°çš„é›¶åˆ†é…ä¼˜åŒ–</h4>
<p>é—­åŒ…å’Œå§”æ‰˜æ›¾æ˜¯æ€§èƒ½"é»‘æ´"ã€‚.NET 10 çš„ JIT ç¼–è¯‘å™¨é€šè¿‡é€ƒé€¸åˆ†æï¼Œå‘ç°å§”æ‰˜æœªè¢«å¤–éƒ¨å¼•ç”¨æ—¶ï¼Œç›´æ¥å†…è”è°ƒç”¨ï¼Œé¿å…å¯¹è±¡åˆ†é…ã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// dotnet run -c Release -f net9.0 --filter "*" --runtimes net9.0 net10.0</span>
<span class="hljs-keyword">using</span> BenchmarkDotNet.Attributes;
<span class="hljs-keyword">using</span> BenchmarkDotNet.Running;
[<span class="hljs-meta">DisassemblyDiagnoser</span>]
[<span class="hljs-meta">MemoryDiagnoser(displayGenColumns: false)</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Tests</span>
{
    [<span class="hljs-meta">Benchmark</span>]
    [<span class="hljs-meta">Arguments(42)</span>]
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">Sum</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> y</span>)</span>
    {
        Func&lt;<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>&gt; addY = x =&gt; x + y;
        <span class="hljs-keyword">return</span> DoubleResult(addY, y);
    }
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> <span class="hljs-title">DoubleResult</span>(<span class="hljs-params">Func&lt;<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>&gt; func, <span class="hljs-built_in">int</span> arg</span>)</span>
    {
        <span class="hljs-built_in">int</span> result = func(arg);
        <span class="hljs-keyword">return</span> result + result;
    }
}
</code></pre>
<p>æ‰§è¡Œæ—¶é—´ä» 19.53 ns é™è‡³ 6.68 nsï¼Œå†…å­˜ä» 88 B é™è‡³ 24 Bã€‚ç±»ä¼¼åœ°ï¼Œå±€éƒ¨å‡½æ•°ä¸­çš„æ•°ç»„ä¹Ÿè¢«ä¼˜åŒ–ä¸ºæ ˆåˆ†é…ï¼Œå½»åº•æ¶ˆé™¤å †åˆ†é…ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€å»è™šæ‹ŸåŒ–ä¸ç±»å‹ç»†åŒ–</h3>
<p>è¿‡å»ï¼Œæ•°ç»„é€šè¿‡æ¥å£ï¼ˆå¦‚ IList&lt; T&gt;ï¼‰è®¿é—®æ—¶æ— æ³•å»è™šæ‹ŸåŒ–ï¼Œå¯¼è‡´ for å¾ªç¯æ¯” foreach æ›´æ…¢ã€‚.NET 10 ä¿®å¤äº†è¿™ä¸€åç›´è§‰ç°è±¡ã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">private</span> ReadOnlyCollection&lt;<span class="hljs-built_in">int</span>&gt; _list = <span class="hljs-keyword">new</span>(Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>).ToArray());
[<span class="hljs-meta">Benchmark</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">SumForLoop</span>()</span>
{
    <span class="hljs-built_in">int</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; _list.Count; i++)
    {
        sum += _list[i]; <span class="hljs-comment">// .NET 9: 1000 æ¬¡è™šæ‹Ÿè°ƒç”¨</span>
    }
    <span class="hljs-keyword">return</span> sum;
}
</code></pre>
<p>ä¼˜åŒ–åï¼ŒSumForLoop æ€§èƒ½æå‡ 68%ï¼ŒLINQ æŸ¥è¯¢ä¹Ÿå› æ­¤å—ç›Šã€‚SkipTakeSum ä» 3.525 Î¼s é™è‡³ 1.773 Î¼sã€‚</p>
<p>åŒæ—¶ï¼ŒJIT èƒ½è¯†åˆ« IEnumerable&lt; int&gt; å®é™…æ˜¯ int[]ï¼Œä»è€Œç”Ÿæˆå…·ä½“ç±»å‹ä»£ç ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> IEnumerable&lt;<span class="hljs-built_in">int</span>&gt; s_values = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };
[<span class="hljs-meta">Benchmark</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">Sum</span>()</span>
{
    <span class="hljs-built_in">int</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">int</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">in</span> s_values) sum += <span class="hljs-keyword">value</span>;
    <span class="hljs-keyword">return</span> sum;
}
</code></pre>
<p>æ‰§è¡Œæ—¶é—´ä» 16.34 ns é™è‡³ 2.06 nsï¼Œå†…å­˜åˆ†é…å½’é›¶ã€‚</p>
<h4 data-id="heading-4">å››ã€çº¿ç¨‹æ± è°ƒåº¦</h4>
<p>"åŒæ­¥åŒ…è£…å¼‚æ­¥"å¸¸å¯¼è‡´çº¿ç¨‹æ± æ­»é”ã€‚.NET 10 åœ¨çº¿ç¨‹å³å°†é˜»å¡æ—¶ï¼Œä¸»åŠ¨å°†æœ¬åœ°é˜Ÿåˆ—ä»»åŠ¡ç§»äº¤å…¨å±€é˜Ÿåˆ—ï¼Œé¿å…å…³é”®ä»»åŠ¡è¢«æ— é™å»¶è¿Ÿã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// æ¨¡æ‹Ÿé«˜è´Ÿè½½ä¸‹çš„çº¿ç¨‹æ± åƒµå±€</span>
ThreadPool.SetMaxThreads(numThreads, <span class="hljs-number">1</span>);
<span class="hljs-comment">// ... æäº¤é˜»å¡ä»»åŠ¡ä¸å¹²æ‰°ä»»åŠ¡</span>
</code></pre>
<p>åœ¨ .NET 9 ä¸­è¶…æ—¶ 20 ç§’çš„ä»»åŠ¡ï¼Œ.NET 10 ä»…éœ€ 4 æ¯«ç§’å®Œæˆã€‚</p>
<h3 data-id="heading-5">äº”ã€ç¡¬ä»¶çº§å¤§æ•°è¿ç®—ä¸å®¹å™¨éå†ä¼˜åŒ–</h3>
<p>UInt128 é™¤æ³•åˆ©ç”¨ CPU çš„ DivRem æŒ‡ä»¤ï¼Œæ€§èƒ½æå‡è¿‘ 50 å€ï¼š</p>























<table><thead><tr><th>Method</th><th>Runtime</th><th>Mean</th><th>Ratio</th></tr></thead><tbody><tr><td>Divide</td><td>.NET 9.0</td><td>27.3112 ns</td><td>1.00</td></tr><tr><td>Divide</td><td>.NET 10.0</td><td>0.5522 ns</td><td>0.02</td></tr></tbody></table>
<p>Stackã€Queueã€ConcurrentDictionary çš„æšä¸¾å™¨ä¹Ÿå…¨é¢é‡æ„ã€‚ä»¥ Stack ä¸ºä¾‹ï¼ŒMoveNext çš„åˆ†æ”¯ä» 5 ä¸ªå‡è‡³ 1 ä¸ªï¼ŒSumDirect æ€§èƒ½æå‡ 81%ï¼Œä»£ç ä½“ç§¯ç¼©å° 83%ã€‚</p>
<h3 data-id="heading-6">æ€»ç»“</h3>
<p>.NET 10 çš„æ€§èƒ½è¿›æ­¥ï¼Œä¸æ˜¯é ç‚«æŠ€ï¼Œè€Œæ˜¯æºäºå¯¹"ä¸åšæ— ç”¨åŠŸ"çš„æè‡´è¿½æ±‚ã€‚å®ƒè®©ç¼–è¯‘å™¨ä»"ä»£ç æ‰§è¡Œè€…"å˜ä¸º"æ„å›¾ç†è§£è€…"ï¼Œè®©è¿è¡Œæ—¶ä»"è¢«åŠ¨å“åº”"è½¬å‘"ä¸»åŠ¨é¢„æµ‹â€ã€‚è¿™ç§ç³»ç»Ÿæ€§æ€ç»´ï¼Œä¸ä»…æå‡äº†æ•°å­—æŒ‡æ ‡ï¼Œæ›´é‡å¡‘äº†é«˜æ€§èƒ½å¼€å‘çš„é»˜è®¤ä½“éªŒâ€”â€”å¼€å‘æ— éœ€æ‰‹åŠ¨ä¼˜åŒ–ï¼Œå³å¯äº«å—æ¥è¿‘åº•å±‚çš„æ•ˆç‡ã€‚</p>
<p>å¯¹äºå¹¿å¤§ .NET å¼€å‘è€Œè¨€ï¼Œå‡çº§åˆ° .NET 10 ä¸ä»…æ„å‘³ç€æ›´é•¿çš„æ”¯æŒå‘¨æœŸï¼Œæ›´æ˜¯ä¸€æ¬¡"å…è´¹â€çš„æ€§èƒ½çº¢åˆ©ã€‚</p>
<h3 data-id="heading-7">å…³é”®è¯</h3>
<p>.NET 10ã€æ€§èƒ½ä¼˜åŒ–ã€LINQã€å»è™šæ‹ŸåŒ–ã€JITã€çº¿ç¨‹æ± ã€å§”æ‰˜å†…è”ã€æ ˆåˆ†é…ã€UInt128ã€å®¹å™¨éå†</p>
<h3 data-id="heading-8">æœ€å</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸å¦¨ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ï¼ä½ çš„æ”¯æŒæ˜¯æˆ‘ç»§ç»­åˆ†äº«çŸ¥è¯†çš„åŠ¨åŠ›ã€‚å¦‚æœæœ‰ä»»ä½•ç–‘é—®æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œæ¬¢è¿éšæ—¶ç•™è¨€ã€‚</p>
<p>ä¹Ÿå¯ä»¥åŠ å…¥å¾®ä¿¡å…¬ä¼—å· <strong>[DotNetæŠ€æœ¯åŒ ]</strong> ç¤¾åŒºï¼Œä¸å…¶ä»–çƒ­çˆ±æŠ€æœ¯çš„åŒè¡Œä¸€èµ·äº¤æµå¿ƒå¾—ï¼Œå…±åŒæˆé•¿ï¼</p>
<p><strong>ä¼˜ç§€æ˜¯ä¸€ç§ä¹ æƒ¯ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€å­¦ä¹ ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidç³»ç»Ÿä¸­HALå±‚å¼€å‘å®ä¾‹]]></title>    <link>https://juejin.cn/post/7571749988080893961</link>    <guid>https://juejin.cn/post/7571749988080893961</guid>    <pubDate>2025-11-13T01:22:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7571749988080893961" data-draft-id="7571725550710341659" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidç³»ç»Ÿä¸­HALå±‚å¼€å‘å®ä¾‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-13T01:22:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·345947411361"/> <meta itemprop="url" content="https://juejin.cn/user/1118620649271515"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidç³»ç»Ÿä¸­HALå±‚å¼€å‘å®ä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1118620649271515/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·345947411361
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-13T01:22:57.000Z" title="Thu Nov 13 2025 01:22:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aef6165e899c4227a5ae2116bcb69a87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3MzQ1OTQ3NDExMzYx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763601777&amp;x-signature=XT4spgNBTFCRpATMgWTwJo%2FgnVQ%3D" alt="t01bf1f34d94fd74c63.jpg" loading="lazy"/></p>
<p><strong>Androidç³»ç»Ÿä¸­HALå±‚å¼€å‘å®ä¾‹---youkeit.xyz/4706/</strong></p>
<h2 data-id="heading-0">ä»åº•å±‚é‡æ„ä½“éªŒï¼šAndroid Framework å¼•é¢†ç§»åŠ¨å¼€å‘æŠ€æœ¯è¿­ä»£</h2>
<h3 data-id="heading-1">ä¸€ã€Android Framework æ¶æ„æ¼”è¿›</h3>
<p>Android Framework ä½œä¸ºè¿æ¥åº”ç”¨å±‚ä¸Linuxå†…æ ¸çš„æ¡¥æ¢ï¼Œå…¶æ¶æ„è®¾è®¡ç›´æ¥å½±å“ç€ç§»åŠ¨å¼€å‘çš„ä½“éªŒä¸æ•ˆç‡ã€‚è®©æˆ‘ä»¬ä»æ ¸å¿ƒç»„ä»¶å¼€å§‹å‰–æï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å…¸å‹çš„Android Frameworkåˆ†å±‚æ¶æ„</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidFramework</span> {
    <span class="hljs-comment">// åº”ç”¨å±‚ç»„ä»¶</span>
    <span class="hljs-keyword">private</span> ApplicationLayer applicationLayer;
    
    <span class="hljs-comment">// Java APIæ¡†æ¶å±‚</span>
    <span class="hljs-keyword">private</span> FrameworkLayer frameworkLayer;
    
    <span class="hljs-comment">// æœ¬åœ°åº“å’ŒAndroidè¿è¡Œæ—¶</span>
    <span class="hljs-keyword">private</span> NativeLayer nativeLayer;
    
    <span class="hljs-comment">// Linuxå†…æ ¸å±‚</span>
    <span class="hljs-keyword">private</span> KernelLayer kernelLayer;
    
    <span class="hljs-comment">// å…³é”®ç³»ç»ŸæœåŠ¡</span>
    <span class="hljs-keyword">private</span> SystemServiceManager serviceManager;
}
</code></pre>
<h4 data-id="heading-2">1.1 ç»„ä»¶åŒ–æ¼”è¿›</h4>
<p>ä»Android 5.0å¼•å…¥çš„ARTè¿è¡Œæ—¶æ›¿ä»£Dalvikï¼Œåˆ°Android 10æ¨å‡ºçš„Project Mainlineæ¨¡å—åŒ–æ›´æ–°æœºåˆ¶ï¼ŒFrameworkçš„æ ¸å¿ƒå˜åŒ–ä½“ç°åœ¨ï¼š</p>
<ol>
<li><strong>æ¨¡å—è§£è€¦</strong>ï¼šå°†ç³»ç»Ÿç»„ä»¶æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—ï¼ˆå¦‚WiFiã€è“ç‰™ç­‰ï¼‰</li>
<li><strong>åŠ¨æ€æ›´æ–°</strong>ï¼šé€šè¿‡Google Playå•†åº—æ›´æ–°æ ¸å¿ƒç»„ä»¶</li>
<li><strong>æ¥å£ç¨³å®š</strong>ï¼šåŠ å¼ºAPIå…¼å®¹æ€§ä¿è¯</li>
</ol>
<h3 data-id="heading-3">äºŒã€å…³é”®æŠ€æœ¯åˆ›æ–°ç‚¹</h3>
<h4 data-id="heading-4">2.1 å“åº”å¼æ¶æ„æ”¹è¿›</h4>
<p>Android Frameworké€æ­¥å¼•å…¥å“åº”å¼ç¼–ç¨‹èŒƒå¼ï¼Œå…¸å‹å¦‚LiveDataç»„ä»¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LocationViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _location = MutableLiveData&lt;Location&gt;()
    <span class="hljs-keyword">val</span> location: LiveData&lt;Location&gt; = _location
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateLocation</span><span class="hljs-params">(newLocation: <span class="hljs-type">Location</span>)</span></span> {
        _location.value = newLocation
    }
}

<span class="hljs-comment">// Activityä¸­çš„è§‚å¯Ÿè€…</span>
viewModel.location.observe(<span class="hljs-keyword">this</span>) { location -&gt;
    updateUI(location)
}
</code></pre>
<h4 data-id="heading-5">2.2 æ€§èƒ½ä¼˜åŒ–åº•å±‚æœºåˆ¶</h4>
<p>Android 12å¼•å…¥çš„PerformanceClass APIä¸ºå¼€å‘è€…æä¾›äº†è®¾å¤‡æ€§èƒ½åˆ†çº§æ ‡å‡†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ£€æŸ¥è®¾å¤‡æ€§èƒ½ç­‰çº§</span>
<span class="hljs-keyword">if</span> (BuildCompat.isAtLeastS() &amp;&amp; 
    PerformanceClassManager.getPerformanceClass() &gt;= 
    PerformanceClassManager.PERFORMANCE_CLASS_HIGH) {
    <span class="hljs-comment">// å¯ç”¨é«˜çº§åŠŸèƒ½</span>
    enableAdvancedFeatures();
}
</code></pre>
<h3 data-id="heading-6">ä¸‰ã€Framework æ·±åº¦å®šåˆ¶å®è·µ</h3>
<h4 data-id="heading-7">3.1 è‡ªå®šä¹‰ç³»ç»ŸæœåŠ¡</h4>
<p>é€šè¿‡AIDLåˆ›å»ºè·¨è¿›ç¨‹ç³»ç»ŸæœåŠ¡ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰AIDLæ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ICustomService</span> {
    <span class="hljs-type">int</span> <span class="hljs-title function_">getSystemStatus</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setConfiguration</span><span class="hljs-params">(in Bundle config)</span>;
}

<span class="hljs-comment">// æœåŠ¡ç«¯å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ICustomService</span>.Stub {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getSystemStatus</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> SystemProperties.getInt(<span class="hljs-string">"custom.status"</span>, <span class="hljs-number">0</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setConfiguration</span><span class="hljs-params">(Bundle config)</span> {
        <span class="hljs-comment">// å¤„ç†é…ç½®æ›´æ–°</span>
    }
}

<span class="hljs-comment">// æ³¨å†ŒæœåŠ¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerSystemService</span><span class="hljs-params">()</span> {
    ServiceManager.addService(<span class="hljs-string">"custom_service"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomServiceImpl</span>());
}
</code></pre>
<h4 data-id="heading-8">3.2 èµ„æºè¦†ç›–æœºåˆ¶</h4>
<p>åˆ©ç”¨Runtime Resource Overlay (RRO)å®ç°èµ„æºåŠ¨æ€æ›¿æ¢ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- overlay/values/strings.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"app_name"</span>&gt;</span>New App Name<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>

<span class="hljs-comment">&lt;!-- overlay/AndroidManifest.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">package</span>=<span class="hljs-string">"com.example.overlay"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">overlay</span> <span class="hljs-attr">android:targetPackage</span>=<span class="hljs-string">"com.example.app"</span>
             <span class="hljs-attr">android:priority</span>=<span class="hljs-string">"1"</span>
             <span class="hljs-attr">android:isStatic</span>=<span class="hljs-string">"false"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">å››ã€æœªæ¥æŠ€æœ¯æ–¹å‘</h3>
<h4 data-id="heading-10">4.1 æ¨¡å—åŒ–æ¶æ„æ·±å…¥</h4>
<p>Android 13è¿›ä¸€æ­¥å¼ºåŒ–äº†æ¨¡å—åŒ–è®¾è®¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åŠ¨æ€æ¨¡å—åŠ è½½ç¤ºä¾‹</span>
<span class="hljs-type">val</span> <span class="hljs-variable">moduleManager</span> <span class="hljs-operator">=</span> ModuleManager.getInstance(context)
moduleManager.installModule(<span class="hljs-string">"dynamic_feature"</span>, 
    InstallCallback { status -&gt;
        <span class="hljs-keyword">if</span> (status == InstallStatus.SUCCESS) {
            <span class="hljs-comment">// æ¨¡å—åŠ è½½æˆåŠŸ</span>
        }
    })
</code></pre>
<h4 data-id="heading-11">4.2 æœºå™¨å­¦ä¹ é›†æˆ</h4>
<p>ML Kitä¸Frameworkæ·±åº¦æ•´åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨è®¾å¤‡ç«¯æ¨¡å‹è¿›è¡Œå¤„ç†</span>
<span class="hljs-keyword">val</span> recognizer = TextRecognizer.Builder(context)
    .setDeviceMode(MLContext.DEVICE_ONLY)
    .build()

recognizer.process(InputImage.fromBitmap(bitmap))
    .addOnSuccessListener { result -&gt;
        <span class="hljs-comment">// å¤„ç†è¯†åˆ«ç»“æœ</span>
    }
</code></pre>
<h3 data-id="heading-12">äº”ã€æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>å…¼å®¹æ€§å¤„ç†</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
    <span class="hljs-comment">// ä½¿ç”¨æ–°API</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å›é€€æ–¹æ¡ˆ</span>
}
</code></pre>
<ol start="2">
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceMonitor</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startTrace</span><span class="hljs-params">(tag: <span class="hljs-type">String</span>)</span></span> {
        Trace.beginSection(tag)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">endTrace</span><span class="hljs-params">()</span></span> {
        Trace.endSection()
    }
}
</code></pre>
<ol start="3">
<li><strong>èµ„æºä¼˜åŒ–</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨vector drawableæ›¿ä»£ä½å›¾ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">vector</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:width</span>=<span class="hljs-string">"24dp"</span>
    <span class="hljs-attr">android:height</span>=<span class="hljs-string">"24dp"</span>
    <span class="hljs-attr">android:viewportWidth</span>=<span class="hljs-string">"24"</span>
    <span class="hljs-attr">android:viewportHeight</span>=<span class="hljs-string">"24"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">android:fillColor</span>=<span class="hljs-string">"#FF0000"</span>
          <span class="hljs-attr">android:pathData</span>=<span class="hljs-string">"M12,2L4,12l8,10l8-10z"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">vector</span>&gt;</span>
</code></pre>
<h3 data-id="heading-13">ç»“è¯­</h3>
<p>Android Frameworkçš„æŒç»­æ¼”è¿›ä¸ºç§»åŠ¨å¼€å‘å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„çµæ´»æ€§å’Œæ€§èƒ½æ½œåŠ›ã€‚å¼€å‘è€…åº”å½“ï¼š</p>
<ol>
<li>æ·±å…¥ç†è§£Frameworkåº•å±‚æœºåˆ¶</li>
<li>åŠæ—¶é€‚é…æ–°ç‰¹æ€§</li>
<li>åˆç†åˆ©ç”¨æ¨¡å—åŒ–è®¾è®¡</li>
<li>å…³æ³¨æ€§èƒ½ä¸èƒ½æ•ˆå¹³è¡¡</li>
</ol>
<p>é€šè¿‡æŒæ¡è¿™äº›æ ¸å¿ƒæŠ€æœ¯ç‚¹ï¼Œå¼€å‘è€…èƒ½å¤Ÿåœ¨å¿«é€Ÿå˜åŒ–çš„æŠ€æœ¯æµªæ½®ä¸­ä¿æŒç«äº‰åŠ›ï¼Œæ„å»ºå‡ºä½“éªŒå“è¶Šçš„ç§»åŠ¨åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>