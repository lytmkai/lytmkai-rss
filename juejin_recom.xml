<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡]]></title>    <link>https://juejin.cn/post/7603651011978690602</link>    <guid>https://juejin.cn/post/7603651011978690602</guid>    <pubDate>2026-02-07T12:28:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603651011978690602" data-draft-id="7603649945977995283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡"/> <meta itemprop="keywords" content="å¼€æº,Python"/> <meta itemprop="datePublished" content="2026-02-07T12:28:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T12:28:20.000Z" title="Sat Feb 07 2026 12:28:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>"æ¯ä¸€åº§åŸå¸‚éƒ½æœ‰ç‹¬ç‰¹çš„é“è·¯çº¹ç†ï¼Œå°±åƒæŒ‡çº¹ä¸€æ ·ç‹¬ä¸€æ— äºŒã€‚"</p>
</blockquote>
<p>è¿™æ˜¯"ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®"ç³»åˆ—çš„ç¬¬15ç¯‡æ–‡ç« ã€‚ä»Šå¤©å¸¦ä½ äº†è§£çš„é¡¹ç›®æ˜¯ <strong>MapToPoster</strong>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">GitHub</a>ï¼‰ã€‚</p>
<p>ä½ æ˜¯å¦æƒ³è¿‡å°†ä½ å–œæ¬¢çš„åŸå¸‚åœ°å›¾è½¬æ¢æˆä¸€å¼ ç²¾ç¾çš„æµ·æŠ¥ï¼ŸMapToPoster è®©è¿™ä¸ªæƒ³æ³•å˜æˆäº†ç°å®ã€‚å®ƒä½¿ç”¨ OpenStreetMap çš„å¼€æºåœ°å›¾æ•°æ®ï¼Œé€šè¿‡ Python ä»£ç å°†åŸå¸‚é“è·¯ç½‘ç»œè½¬æ¢ä¸ºæç®€ä¸»ä¹‰é£æ ¼çš„ç²¾ç¾æµ·æŠ¥è®¾è®¡ã€‚æ— è®ºæ˜¯å·´é»çš„æµªæ¼«è¡—é“ã€ä¸œäº¬çš„å¯†é›†è·¯ç½‘ï¼Œè¿˜æ˜¯çº½çº¦çš„ç½‘æ ¼å¸ƒå±€ï¼Œéƒ½èƒ½è¢«è½¬æ¢æˆç‹¬ç‰¹çš„è‰ºæœ¯ä½œå“ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé¡¹ç›®ï¼Ÿ</strong></p>
<ul>
<li>ğŸ—ºï¸ <strong>çœŸå®åœ°å›¾æ•°æ®</strong>ï¼šåŸºäº OpenStreetMapï¼Œæ•°æ®å‡†ç¡®ä¸”å…è´¹</li>
<li>ğŸ¨ <strong>17ç§ç²¾ç¾ä¸»é¢˜</strong>ï¼šä»æç®€é»‘ç™½åˆ°éœ“è™¹èµ›åšæœ‹å…‹ï¼Œæ»¡è¶³ä¸åŒå®¡ç¾</li>
<li>ğŸ <strong>çº¯Pythonå®ç°</strong>ï¼šä»£ç ç®€æ´ï¼Œæ˜“äºç†è§£å’Œå®šåˆ¶</li>
<li>ğŸ¯ <strong>æç®€ä¸»ä¹‰è®¾è®¡</strong>ï¼šä¸“æ³¨äºé“è·¯çº¹ç†ï¼Œå‘ˆç°åŸå¸‚ç‹¬ç‰¹ç¾æ„Ÿ</li>
<li>ğŸ“ <strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰è·ç¦»ã€åæ ‡ã€å­—ä½“ã€ä¸»é¢˜ç­‰</li>
<li>ğŸŒ <strong>å…¨çƒåŸå¸‚æ”¯æŒ</strong>ï¼šæ”¯æŒä¸–ç•Œä»»ä½•åŸå¸‚çš„é“è·¯ç½‘ç»œ</li>
</ul>
<h3 data-id="heading-1">ä½ å°†å­¦åˆ°ä»€ä¹ˆ</h3>
<ul>
<li>MapToPoster çš„æ ¸å¿ƒåŸç†å’Œæ¶æ„è®¾è®¡</li>
<li>å¦‚ä½•ä½¿ç”¨ OSMnx è·å–å’Œå¤„ç†åœ°å›¾æ•°æ®</li>
<li>17ç§ä¸»é¢˜çš„è®¾è®¡ç†å¿µå’Œä½¿ç”¨åœºæ™¯</li>
<li>å¦‚ä½•è‡ªå®šä¹‰ä¸»é¢˜å’Œæ ·å¼</li>
<li>å­—ä½“ç®¡ç†å’Œ Google Fonts é›†æˆ</li>
<li>åœ°å›¾æ¸²æŸ“çš„å±‚æ¬¡ç»“æ„å’Œä¼˜åŒ–æŠ€å·§</li>
<li>å®é™…ä½¿ç”¨ä¸­çš„æœ€ä½³å®è·µå’Œå‚æ•°è°ƒä¼˜</li>
</ul>
<h3 data-id="heading-2">å‰ç½®çŸ¥è¯†</h3>
<ul>
<li>Python åŸºç¡€è¯­æ³•å’Œå‘½ä»¤è¡Œä½¿ç”¨</li>
<li>å¯¹åœ°å›¾å’Œåœ°ç†æ•°æ®æœ‰åŸºæœ¬äº†è§£</li>
<li>äº†è§£ JSON é…ç½®æ–‡ä»¶æ ¼å¼</li>
<li>å¯¹æ•°æ®å¯è§†åŒ–æœ‰åŸºæœ¬æ¦‚å¿µï¼ˆå¯é€‰ï¼Œæœ‰åŠ©äºç†è§£æ¸²æŸ“åŸç†ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-3">é¡¹ç›®èƒŒæ™¯</h2>
<h3 data-id="heading-4">é¡¹ç›®ç®€ä»‹</h3>
<p><strong>MapToPoster</strong> æ˜¯ä¸€ä¸ª<strong>ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾æµ·æŠ¥çš„ Python å·¥å…·</strong>ã€‚å®ƒé€šè¿‡ OpenStreetMap çš„å¼€æºåœ°å›¾æ•°æ®ï¼Œä½¿ç”¨ OSMnx åº“è·å–åŸå¸‚é“è·¯ç½‘ç»œï¼Œç„¶åé€šè¿‡ matplotlib æ¸²æŸ“æˆæç®€ä¸»ä¹‰é£æ ¼çš„æµ·æŠ¥è®¾è®¡ã€‚ä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„ä¸»é¢˜ã€è°ƒæ•´è·ç¦»èŒƒå›´ã€è‡ªå®šä¹‰å­—ä½“ï¼Œç”Ÿæˆç‹¬ä¸€æ— äºŒçš„åŸå¸‚åœ°å›¾æµ·æŠ¥ã€‚</p>
<p><strong>é¡¹ç›®è§£å†³çš„æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<ul>
<li>ç¼ºä¹ç®€å•æ˜“ç”¨çš„åœ°å›¾æµ·æŠ¥ç”Ÿæˆå·¥å…·</li>
<li>å•†ä¸šåœ°å›¾æœåŠ¡ API æ˜‚è´µä¸”æœ‰é™åˆ¶</li>
<li>éœ€è¦å¯ç¼–ç¨‹ã€å¯å®šåˆ¶çš„åœ°å›¾å¯è§†åŒ–æ–¹æ¡ˆ</li>
<li>å¸Œæœ›å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºè‰ºæœ¯ä½œå“çš„éœ€æ±‚</li>
<li>éœ€è¦æ‰¹é‡ç”Ÿæˆä¸åŒåŸå¸‚ã€ä¸åŒä¸»é¢˜çš„åœ°å›¾æµ·æŠ¥</li>
</ul>
<p><strong>é¢å‘çš„ç”¨æˆ·ç¾¤ä½“</strong>ï¼š</p>
<ul>
<li>è®¾è®¡å¸ˆå’Œè‰ºæœ¯åˆ›ä½œè€…</li>
<li>åœ°ç†æ•°æ®å¯è§†åŒ–çˆ±å¥½è€…</li>
<li>Python å¼€å‘è€…</li>
<li>åŸå¸‚è§„åˆ’å’Œå»ºç­‘ä¸“ä¸šäººå£«</li>
<li>å¸Œæœ›åˆ¶ä½œä¸ªæ€§åŒ–åŸå¸‚æµ·æŠ¥çš„ç”¨æˆ·</li>
</ul>
<h3 data-id="heading-5">ä½œè€…/å›¢é˜Ÿä»‹ç»</h3>
<p><strong>ä½œè€…ï¼šoriginalankur</strong></p>
<ul>
<li><strong>èƒŒæ™¯</strong>ï¼šä¸“æ³¨äºæ•°æ®å¯è§†åŒ–å’Œè®¾è®¡å·¥å…·çš„å¼€æºè´¡çŒ®è€…</li>
<li><strong>é¡¹ç›®åˆ›å»ºæ—¶é—´</strong>ï¼š2024å¹´ï¼ˆä» GitHub æ´»åŠ¨æ¥çœ‹æ˜¯æŒç»­æ´»è·ƒçš„é¡¹ç›®ï¼‰</li>
<li><strong>ç†å¿µ</strong>ï¼šç”¨ä»£ç åˆ›é€ ç¾ï¼Œè®©åœ°å›¾æ•°æ®æˆä¸ºè‰ºæœ¯</li>
<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šPythonã€OSMnxã€matplotlibã€OpenStreetMap</li>
</ul>
<h3 data-id="heading-6">é¡¹ç›®æ•°æ®</h3>
<ul>
<li>â­ <strong>GitHub Stars</strong>: 9.8k+ï¼ˆæŒç»­å¿«é€Ÿå¢é•¿ï¼‰</li>
<li>ğŸ´ <strong>Forks</strong>: 872+</li>
<li>ğŸ“¦ <strong>ç‰ˆæœ¬</strong>: æŒç»­æ›´æ–°ä¸­ï¼ˆ50+ commitsï¼‰</li>
<li>ğŸ“„ <strong>License</strong>: MITï¼ˆå®Œå…¨å¼€æºï¼Œè‡ªç”±ä½¿ç”¨ï¼‰</li>
<li>ğŸŒ <strong>é¡¹ç›®åœ°å€</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">GitHub</a></li>
<li>ğŸ’¬ <strong>ç¤¾åŒº</strong>: GitHub Issues æ´»è·ƒï¼Œ9ä¸ªå¼€æ”¾ Issuesï¼Œ16ä¸ª Pull Requests</li>
<li>ğŸ‘¥ <strong>è´¡çŒ®è€…</strong>: 15ä½è´¡çŒ®è€…ï¼Œæ´»è·ƒçš„ç¤¾åŒºå‚ä¸</li>
</ul>
<p><strong>é¡¹ç›®å‘å±•å†ç¨‹</strong>ï¼š</p>
<ul>
<li>2024å¹´ï¼šé¡¹ç›®åˆ›å»ºï¼Œå®ç°æ ¸å¿ƒåŠŸèƒ½</li>
<li>2024å¹´ä¸­ï¼šæ·»åŠ å¤šç§ä¸»é¢˜æ”¯æŒ</li>
<li>2024å¹´åº•ï¼šå®Œå–„å­—ä½“ç®¡ç†å’Œ Google Fonts é›†æˆ</li>
<li>2025å¹´ï¼šä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼Œæ·»åŠ æ›´å¤šä¸»é¢˜</li>
<li>æŒç»­ç»´æŠ¤ï¼šé¡¹ç›®æŒç»­æ´»è·ƒï¼Œç¤¾åŒºè´¡çŒ®ä¸æ–­</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸»è¦åŠŸèƒ½</h2>
<h3 data-id="heading-8">æ ¸å¿ƒä½œç”¨</h3>
<p>MapToPoster çš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>å°†åŸå¸‚åœ°å›¾æ•°æ®è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡</strong>ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>åœ°å›¾æ•°æ®è·å–</strong>ï¼šé€šè¿‡ OSMnx ä» OpenStreetMap è·å–åŸå¸‚é“è·¯ç½‘ç»œæ•°æ®</li>
<li><strong>å¤šä¸»é¢˜æ¸²æŸ“</strong>ï¼šæ”¯æŒ17ç§ç²¾å¿ƒè®¾è®¡çš„ä¸»é¢˜ï¼Œä»æç®€åˆ°èµ›åšæœ‹å…‹</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰è·ç¦»èŒƒå›´ã€ä¸­å¿ƒåæ ‡ã€å­—ä½“ã€ä¸»é¢˜ç­‰å‚æ•°</li>
<li><strong>é«˜è´¨é‡è¾“å‡º</strong>ï¼šç”Ÿæˆé«˜åˆ†è¾¨ç‡ PNG å›¾ç‰‡ï¼Œé€‚åˆæ‰“å°å’Œå±•ç¤º</li>
<li><strong>å­—ä½“ç®¡ç†</strong>ï¼šæ”¯æŒæœ¬åœ°å­—ä½“å’Œ Google Fonts è‡ªåŠ¨ä¸‹è½½</li>
<li><strong>è„šæœ¬æ£€æµ‹</strong>ï¼šè‡ªåŠ¨æ£€æµ‹æ–‡æœ¬è„šæœ¬ï¼ˆæ‹‰ä¸/éæ‹‰ä¸ï¼‰ï¼Œåº”ç”¨åˆé€‚çš„æ’ç‰ˆ</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/616dfab3283a4a2fb7717cbf37157f6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=jsiqPgj0cKilqnfyqy7Z6Lt5QOA%3D" alt="15-01-barcelona_warm_beige.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57ae9379062c42038b66968fba64ddc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=mfKK6wdI9OOoBJ7KqLsUTDMFfR8%3D" alt="15-02-dubai_midnight_blue.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/733418e08c2d4330b1f2d7618e22379a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=9KxnLgCOjhiJuz3fVxCMEyX7xF4%3D" alt="15-03-san_francisco_sunset.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65356317f0f24577b5a6ff6a02b5cca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=mNnpsFZmYE72CJ4gpblK91wVhR8%3D" alt="15-04-singapore_neon_cyberpunk.png" loading="lazy"/></p>
<h3 data-id="heading-9">ä½¿ç”¨åœºæ™¯</h3>
<p>MapToPoster é€‚ç”¨äºå¤šç§åœºæ™¯ï¼š</p>
<ol>
<li>
<p><strong>ä¸ªäººæ”¶è—å’Œè£…é¥°</strong></p>
<ul>
<li>åˆ¶ä½œä½ å±…ä½è¿‡æˆ–å–œæ¬¢çš„åŸå¸‚åœ°å›¾æµ·æŠ¥</li>
<li>ä½œä¸ºæˆ¿é—´è£…é¥°æˆ–ç¤¼ç‰©é€ç»™æœ‹å‹</li>
<li>è®°å½•æ—…è¡Œè¶³è¿¹ï¼Œåˆ¶ä½œåŸå¸‚ç³»åˆ—æµ·æŠ¥</li>
</ul>
</li>
<li>
<p><strong>è®¾è®¡å’Œè‰ºæœ¯åˆ›ä½œ</strong></p>
<ul>
<li>è®¾è®¡å¸ˆè·å–åŸå¸‚åœ°å›¾ç´ æ</li>
<li>è‰ºæœ¯é¡¹ç›®ä¸­çš„åœ°å›¾å…ƒç´ </li>
<li>å“ç‰Œè®¾è®¡ä¸­çš„åœ°ç†å…ƒç´ </li>
</ul>
</li>
<li>
<p><strong>æ•™è‚²å’Œå±•ç¤º</strong></p>
<ul>
<li>åœ°ç†æ•™å­¦ä¸­çš„å¯è§†åŒ–å·¥å…·</li>
<li>åŸå¸‚è§„åˆ’å±•ç¤º</li>
<li>æ•°æ®å¯è§†åŒ–é¡¹ç›®</li>
</ul>
</li>
<li>
<p><strong>æ‰¹é‡ç”Ÿæˆ</strong></p>
<ul>
<li>ä¸ºå¤šä¸ªåŸå¸‚ç”Ÿæˆç»Ÿä¸€é£æ ¼çš„æµ·æŠ¥</li>
<li>æµ‹è¯•ä¸åŒä¸»é¢˜æ•ˆæœ</li>
<li>åˆ›å»ºåŸå¸‚å¯¹æ¯”ç³»åˆ—</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-11">å®‰è£…æ–¹å¼</h4>
<p>MapToPoster çš„å®‰è£…éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å…‹éš†é¡¹ç›®</span>
git <span class="hljs-built_in">clone</span> https://github.com/originalankur/maptoposter.git
<span class="hljs-built_in">cd</span> maptoposter

<span class="hljs-comment"># 2. å®‰è£…ä¾èµ–</span>
pip install -r requirements.txt

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ pyproject.toml</span>
pip install -e .
</code></pre>
<p><strong>ä¸»è¦ä¾èµ–</strong>ï¼š</p>
<ul>
<li><code>osmnx</code>ï¼šè·å– OpenStreetMap æ•°æ®</li>
<li><code>matplotlib</code>ï¼šåœ°å›¾æ¸²æŸ“</li>
<li><code>geopy</code>ï¼šåœ°ç†ç¼–ç ï¼ˆé€šè¿‡ Nominatimï¼‰</li>
<li><code>requests</code>ï¼šGoogle Fonts API è°ƒç”¨</li>
</ul>
<h4 data-id="heading-12">æœ€ç®€å•çš„ä½¿ç”¨ç¤ºä¾‹</h4>
<p>ç”Ÿæˆä¸€å¼ å·´é»çš„æç®€é»‘ç™½é£æ ¼æµ·æŠ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> -t noir -d 10000
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šï¼š</p>
<ul>
<li>æŸ¥æ‰¾å·´é»çš„åæ ‡ï¼ˆé€šè¿‡ Nominatim åœ°ç†ç¼–ç ï¼‰</li>
<li>è·å–åŠå¾„10kmèŒƒå›´å†…çš„é“è·¯ç½‘ç»œ</li>
<li>ä½¿ç”¨ <code>noir</code> ä¸»é¢˜ï¼ˆçº¯é»‘èƒŒæ™¯ï¼Œç™½è‰²é“è·¯ï¼‰</li>
<li>ç”Ÿæˆæµ·æŠ¥å¹¶ä¿å­˜åˆ° <code>posters/</code> ç›®å½•</li>
</ul>
<p><strong>è¾“å‡ºæ–‡ä»¶æ ¼å¼</strong>ï¼š<code>Paris_noir_20260208_143022.png</code></p>
<h4 data-id="heading-13">å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆä¸åŒä¸»é¢˜çš„æµ·æŠ¥</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t neon_cyberpunk -d 15000
python create_map_poster.py -c <span class="hljs-string">"London"</span> -C <span class="hljs-string">"UK"</span> -t noir -d 15000
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> -t blueprint -d 12000

<span class="hljs-comment"># ä½¿ç”¨è‡ªå®šä¹‰åæ ‡</span>
python create_map_poster.py --city <span class="hljs-string">"Shanghai"</span> --country <span class="hljs-string">"China"</span> \
  -lat 31.2304 -long 121.4737 -t sunset -d 10000

<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ä¸»é¢˜</span>
python create_map_poster.py --list-themes

<span class="hljs-comment"># ä¸ºåŒä¸€åŸå¸‚ç”Ÿæˆæ‰€æœ‰ä¸»é¢˜</span>
python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> --all-themes -d 10000
</code></pre>
<h3 data-id="heading-14">æ ¸å¿ƒç‰¹æ€§</h3>
<p>MapToPoster çš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>17ç§ç²¾ç¾ä¸»é¢˜</strong></p>
<ul>
<li>ä»æç®€é»‘ç™½ï¼ˆnoirï¼‰åˆ°éœ“è™¹èµ›åšæœ‹å…‹ï¼ˆneon_cyberpunkï¼‰</li>
<li>æ¯ä¸ªä¸»é¢˜éƒ½æœ‰ç‹¬ç‰¹çš„é…è‰²æ–¹æ¡ˆå’Œè®¾è®¡ç†å¿µ</li>
<li>æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜ JSON æ–‡ä»¶</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½é“è·¯åˆ†çº§</strong></p>
<ul>
<li>æ ¹æ® OSM çš„ highway æ ‡ç­¾è‡ªåŠ¨åˆ†çº§</li>
<li>ä¸åŒç­‰çº§é“è·¯ä½¿ç”¨ä¸åŒé¢œè‰²å’Œå®½åº¦</li>
<li>å‘ˆç°æ¸…æ™°çš„é“è·¯å±‚æ¬¡ç»“æ„</li>
</ul>
</li>
<li>
<p><strong>çµæ´»çš„è·ç¦»æ§åˆ¶</strong></p>
<ul>
<li>æ”¯æŒ 4000m åˆ° 20000m+ çš„è·ç¦»èŒƒå›´</li>
<li>æ ¹æ®åŸå¸‚è§„æ¨¡æ¨èåˆé€‚çš„è·ç¦»</li>
<li>å¹³è¡¡ç»†èŠ‚å’Œæ•´ä½“æ•ˆæœ</li>
</ul>
</li>
<li>
<p><strong>å­—ä½“ç®¡ç†</strong></p>
<ul>
<li>é»˜è®¤ä½¿ç”¨ Roboto å­—ä½“</li>
<li>æ”¯æŒ Google Fonts è‡ªåŠ¨ä¸‹è½½</li>
<li>è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬è„šæœ¬ï¼Œåº”ç”¨åˆé€‚çš„æ’ç‰ˆ</li>
</ul>
</li>
<li>
<p><strong>é«˜è´¨é‡æ¸²æŸ“</strong></p>
<ul>
<li>é»˜è®¤ 300 DPIï¼Œé€‚åˆæ‰“å°</li>
<li>æ”¯æŒè‡ªå®šä¹‰ DPI è®¾ç½®</li>
<li>ä¼˜åŒ–çš„æ¸²æŸ“æ€§èƒ½</li>
</ul>
</li>
<li>
<p><strong>åœ°ç†ç¼–ç é›†æˆ</strong></p>
<ul>
<li>é€šè¿‡ Nominatim è‡ªåŠ¨æŸ¥æ‰¾åŸå¸‚åæ ‡</li>
<li>æ”¯æŒåŸå¸‚å+å›½å®¶åç»„åˆ</li>
<li>æ”¯æŒç›´æ¥æŒ‡å®šç»çº¬åº¦åæ ‡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-15">é¡¹ç›®ä¼˜åŠ¿</h3>
<p>ä¸å…¶ä»–åœ°å›¾å¯è§†åŒ–å·¥å…·ç›¸æ¯”ï¼ŒMapToPoster çš„ä¼˜åŠ¿ï¼š</p>





























































<table><thead><tr><th align="left">å¯¹æ¯”é¡¹</th><th align="left">MapToPoster</th><th align="left">Google Maps API</th><th align="left">Mapbox</th><th align="left">å…¶ä»–å¼€æºå·¥å…·</th></tr></thead><tbody><tr><td align="left"><strong>æˆæœ¬</strong></td><td align="left">å®Œå…¨å…è´¹</td><td align="left">æŒ‰ä½¿ç”¨é‡æ”¶è´¹</td><td align="left">æŒ‰ä½¿ç”¨é‡æ”¶è´¹</td><td align="left">å…è´¹ä½†åŠŸèƒ½æœ‰é™</td></tr><tr><td align="left"><strong>æ•°æ®æ¥æº</strong></td><td align="left">OpenStreetMapï¼ˆå¼€æºï¼‰</td><td align="left">Google ä¸“æœ‰</td><td align="left">Mapbox ä¸“æœ‰</td><td align="left">å¤šç§æ¥æº</td></tr><tr><td align="left"><strong>å¯å®šåˆ¶æ€§</strong></td><td align="left">é«˜åº¦å¯å®šåˆ¶</td><td align="left">æœ‰é™å®šåˆ¶</td><td align="left">ä¸­ç­‰å®šåˆ¶</td><td align="left">é€šå¸¸è¾ƒä½</td></tr><tr><td align="left"><strong>ä¸»é¢˜æ”¯æŒ</strong></td><td align="left">17ç§ç²¾ç¾ä¸»é¢˜</td><td align="left">æœ‰é™æ ·å¼</td><td align="left">éœ€è¦è®¾è®¡</td><td align="left">é€šå¸¸æ— ä¸»é¢˜</td></tr><tr><td align="left"><strong>ä»£ç æ§åˆ¶</strong></td><td align="left">å®Œå…¨å¯ç¼–ç¨‹</td><td align="left">API è°ƒç”¨</td><td align="left">API è°ƒç”¨</td><td align="left">éƒ¨åˆ†å¯ç¼–ç¨‹</td></tr><tr><td align="left"><strong>è¾“å‡ºè´¨é‡</strong></td><td align="left">é«˜åˆ†è¾¨ç‡ PNG</td><td align="left">éœ€è¦å¤„ç†</td><td align="left">éœ€è¦å¤„ç†</td><td align="left">é€šå¸¸è¾ƒä½</td></tr><tr><td align="left"><strong>ç¦»çº¿ä½¿ç”¨</strong></td><td align="left">æ”¯æŒï¼ˆéœ€ç¼“å­˜ï¼‰</td><td align="left">ä¸æ”¯æŒ</td><td align="left">ä¸æ”¯æŒ</td><td align="left">éƒ¨åˆ†æ”¯æŒ</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹© MapToPosterï¼Ÿ</strong></p>
<ul>
<li>âœ… <strong>å®Œå…¨å…è´¹</strong>ï¼šåŸºäºå¼€æºæ•°æ®ï¼Œæ—  API è´¹ç”¨</li>
<li>âœ… <strong>é«˜åº¦å¯å®šåˆ¶</strong>ï¼šä»£ç å¼€æºï¼Œå¯ä¿®æ”¹ä»»ä½•ç»†èŠ‚</li>
<li>âœ… <strong>ç²¾ç¾ä¸»é¢˜</strong>ï¼š17ç§ä¸“ä¸šè®¾è®¡çš„ä¸»é¢˜ï¼Œå¼€ç®±å³ç”¨</li>
<li>âœ… <strong>ç®€å•æ˜“ç”¨</strong>ï¼šä¸€æ¡å‘½ä»¤å³å¯ç”Ÿæˆæµ·æŠ¥</li>
<li>âœ… <strong>é«˜è´¨é‡è¾“å‡º</strong>ï¼šé€‚åˆæ‰“å°å’Œå±•ç¤ºçš„é«˜åˆ†è¾¨ç‡å›¾ç‰‡</li>
<li>âœ… <strong>æ´»è·ƒç¤¾åŒº</strong>ï¼š9.8k+ Starsï¼ŒæŒç»­æ›´æ–°å’Œç»´æŠ¤</li>
</ul>
<hr/>
<h2 data-id="heading-16">é¡¹ç›®è¯¦ç»†å‰–æ</h2>
<h3 data-id="heading-17">æ¶æ„è®¾è®¡</h3>
<p>MapToPoster çš„æ•´ä½“æ¶æ„éå¸¸æ¸…æ™°ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI Parser    â”‚â”€â”€â”€â”€â–¶â”‚  Geocoding   â”‚â”€â”€â”€â”€â–¶â”‚  Data Fetching  â”‚
â”‚   (argparse)    â”‚     â”‚  (Nominatim) â”‚     â”‚    (OSMnx)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â–¼
                        â”‚    Output    â”‚â—€â”€â”€â”€â”€â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  (PNG File)  â”‚     â”‚   Rendering     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  (matplotlib)   â”‚
                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š</p>
<ol>
<li><strong>å‘½ä»¤è¡Œè§£æ</strong>ï¼šä½¿ç”¨ <code>argparse</code> è§£æç”¨æˆ·è¾“å…¥çš„åŸå¸‚ã€ä¸»é¢˜ã€è·ç¦»ç­‰å‚æ•°</li>
<li><strong>åœ°ç†ç¼–ç </strong>ï¼šé€šè¿‡ Nominatim API å°†åŸå¸‚åè½¬æ¢ä¸ºç»çº¬åº¦åæ ‡</li>
<li><strong>æ•°æ®è·å–</strong>ï¼šä½¿ç”¨ OSMnx ä» OpenStreetMap è·å–é“è·¯ç½‘ç»œæ•°æ®</li>
<li><strong>ä¸»é¢˜åŠ è½½</strong>ï¼šä» JSON æ–‡ä»¶åŠ è½½ä¸»é¢˜é…ç½®</li>
<li><strong>åœ°å›¾æ¸²æŸ“</strong>ï¼šä½¿ç”¨ matplotlib æŒ‰ç…§ä¸»é¢˜é…ç½®æ¸²æŸ“åœ°å›¾</li>
<li><strong>æ–‡ä»¶ä¿å­˜</strong>ï¼šå°†æ¸²æŸ“ç»“æœä¿å­˜ä¸º PNG æ–‡ä»¶</li>
</ol>
<h3 data-id="heading-18">æ ¸å¿ƒæ¨¡å—åˆ†æ</h3>
<h4 data-id="heading-19">1. åœ°ç†ç¼–ç æ¨¡å—</h4>
<p>MapToPoster ä½¿ç”¨ Nominatimï¼ˆOpenStreetMap çš„åœ°ç†ç¼–ç æœåŠ¡ï¼‰æ¥æŸ¥æ‰¾åŸå¸‚åæ ‡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¸å¿ƒåŠŸèƒ½ï¼šget_coordinates()</span>
<span class="hljs-comment"># è¾“å…¥ï¼šåŸå¸‚åã€å›½å®¶å</span>
<span class="hljs-comment"># è¾“å‡ºï¼šç»çº¬åº¦åæ ‡</span>

<span class="hljs-comment"># ç¤ºä¾‹è°ƒç”¨</span>
coordinates = get_coordinates(<span class="hljs-string">"Paris"</span>, <span class="hljs-string">"France"</span>)
<span class="hljs-comment"># è¿”å›ï¼š(48.8566, 2.3522)</span>
</code></pre>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å…è´¹ä½¿ç”¨ï¼Œæ— éœ€ API Key</li>
<li>æ”¯æŒåŸå¸‚å+å›½å®¶åç»„åˆï¼Œæé«˜å‡†ç¡®æ€§</li>
<li>æ”¯æŒç›´æ¥æŒ‡å®šç»çº¬åº¦ï¼Œè·³è¿‡åœ°ç†ç¼–ç </li>
</ul>
<h4 data-id="heading-20">2. æ•°æ®è·å–æ¨¡å—ï¼ˆOSMnxï¼‰</h4>
<p>OSMnx æ˜¯ MapToPoster çš„æ ¸å¿ƒä¾èµ–ï¼Œç”¨äºè·å– OpenStreetMap æ•°æ®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¸å¿ƒåŠŸèƒ½ï¼šè·å–é“è·¯ç½‘ç»œ</span>
<span class="hljs-keyword">import</span> osmnx <span class="hljs-keyword">as</span> ox

<span class="hljs-comment"># ä»ç‚¹åæ ‡è·å–é“è·¯ç½‘ç»œ</span>
G = ox.graph_from_point(
    point=(lat, lon),
    dist=distance,  <span class="hljs-comment"># è·ç¦»ï¼ˆç±³ï¼‰</span>
    network_type=<span class="hljs-string">'drive'</span>  <span class="hljs-comment"># é“è·¯ç±»å‹</span>
)

<span class="hljs-comment"># è·å–æ°´åŸŸå’Œå…¬å›­æ•°æ®</span>
water = ox.features_from_point(
    point=(lat, lon),
    tags={<span class="hljs-string">'natural'</span>: <span class="hljs-string">'water'</span>},
    dist=distance
)
parks = ox.features_from_point(
    point=(lat, lon),
    tags={<span class="hljs-string">'leisure'</span>: <span class="hljs-string">'park'</span>},
    dist=distance
)
</code></pre>
<p><strong>æ•°æ®å±‚æ¬¡</strong>ï¼š</p>
<ul>
<li><strong>é“è·¯ç½‘ç»œ</strong>ï¼šä¸åŒç­‰çº§çš„é“è·¯ï¼ˆmotorway, primary, secondary, tertiary, residentialï¼‰</li>
<li><strong>æ°´åŸŸ</strong>ï¼šæ²³æµã€æ¹–æ³Šç­‰æ°´ä½“</li>
<li><strong>å…¬å›­</strong>ï¼šç»¿åœ°ã€å…¬å›­ç­‰åŒºåŸŸ</li>
</ul>
<h4 data-id="heading-21">3. ä¸»é¢˜ç³»ç»Ÿ</h4>
<p>MapToPoster çš„ä¸»é¢˜ç³»ç»Ÿéå¸¸çµæ´»ï¼Œæ¯ä¸ªä¸»é¢˜æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Noir"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Pure black background, white roads"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#000000"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFFFFF"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"gradient_color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#000000"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"water"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#1A1A1A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parks"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#0A0A0A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_motorway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFFFFF"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#F0F0F0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_secondary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#E0E0E0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_tertiary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D0D0D0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_residential"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#C0C0C0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_default"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D0D0D0"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ä¸»é¢˜é…ç½®é¡¹</strong>ï¼š</p>
<ul>
<li><code>bg</code>ï¼šèƒŒæ™¯è‰²</li>
<li><code>text</code>ï¼šæ–‡æœ¬é¢œè‰²</li>
<li><code>water</code>ï¼šæ°´åŸŸé¢œè‰²</li>
<li><code>parks</code>ï¼šå…¬å›­é¢œè‰²</li>
<li><code>road_*</code>ï¼šä¸åŒç­‰çº§é“è·¯çš„é¢œè‰²</li>
</ul>
<p><strong>17ç§ä¸»é¢˜æ¦‚è§ˆ</strong>ï¼š</p>































































































<table><thead><tr><th align="left">ä¸»é¢˜åç§°</th><th align="left">é£æ ¼æè¿°</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><code>noir</code></td><td align="left">çº¯é»‘èƒŒæ™¯ï¼Œç™½è‰²é“è·¯</td><td align="left">æç®€ä¸»ä¹‰ï¼Œç°ä»£é£æ ¼</td></tr><tr><td align="left"><code>midnight_blue</code></td><td align="left">æ·±è“èƒŒæ™¯ï¼Œé‡‘è‰²é“è·¯</td><td align="left">ä¼˜é›…ï¼Œå•†åŠ¡é£æ ¼</td></tr><tr><td align="left"><code>blueprint</code></td><td align="left">å»ºç­‘è“å›¾é£æ ¼</td><td align="left">å»ºç­‘ï¼Œå·¥ç¨‹ä¸»é¢˜</td></tr><tr><td align="left"><code>neon_cyberpunk</code></td><td align="left">éœ“è™¹èµ›åšæœ‹å…‹</td><td align="left">ç§‘æŠ€ï¼Œæœªæ¥æ„Ÿ</td></tr><tr><td align="left"><code>gradient_roads</code></td><td align="left">æ¸å˜é“è·¯ç€è‰²</td><td align="left">è‰ºæœ¯ï¼Œåˆ›æ„</td></tr><tr><td align="left"><code>contrast_zones</code></td><td align="left">é«˜å¯¹æ¯”åº¦åŸå¸‚å¯†åº¦</td><td align="left">å¼ºè°ƒåŸå¸‚ç»“æ„</td></tr><tr><td align="left"><code>warm_beige</code></td><td align="left">å¤å¤æ£•è¤è‰²è°ƒ</td><td align="left">æ€€æ—§ï¼Œå¤å¤é£æ ¼</td></tr><tr><td align="left"><code>pastel_dream</code></td><td align="left">æŸ”å’Œç²‰å½©è‰²</td><td align="left">æŸ”å’Œï¼Œæ¢¦å¹»</td></tr><tr><td align="left"><code>japanese_ink</code></td><td align="left">æ—¥å¼æ°´å¢¨é£æ ¼</td><td align="left">ä¸œæ–¹ç¾å­¦</td></tr><tr><td align="left"><code>emerald</code></td><td align="left">ç¿ ç»¿è‰²è°ƒ</td><td align="left">è‡ªç„¶ï¼Œç”Ÿæ€</td></tr><tr><td align="left"><code>forest</code></td><td align="left">æ·±ç»¿å’Œé¼ å°¾è‰ç»¿</td><td align="left">è‡ªç„¶ï¼Œæ£®æ—ä¸»é¢˜</td></tr><tr><td align="left"><code>ocean</code></td><td align="left">è“è‰²å’Œé’ç»¿è‰²</td><td align="left">æ²¿æµ·åŸå¸‚</td></tr><tr><td align="left"><code>terracotta</code></td><td align="left">åœ°ä¸­æµ·æš–è‰²è°ƒ</td><td align="left">åœ°ä¸­æµ·é£æ ¼</td></tr><tr><td align="left"><code>sunset</code></td><td align="left">æš–æ©™å’Œç²‰è‰²</td><td align="left">æ¸©æš–ï¼Œæµªæ¼«</td></tr><tr><td align="left"><code>autumn</code></td><td align="left">ç§‹å¶æ©™çº¢è‰²</td><td align="left">å­£èŠ‚ä¸»é¢˜</td></tr><tr><td align="left"><code>copper_patina</code></td><td align="left">æ°§åŒ–é“œç¾å­¦</td><td align="left">å·¥ä¸šï¼Œé‡‘å±æ„Ÿ</td></tr><tr><td align="left"><code>monochrome_blue</code></td><td align="left">å•è‰²è“è‰²ç³»</td><td align="left">ç»Ÿä¸€ï¼Œç®€æ´</td></tr></tbody></table>
<h4 data-id="heading-22">4. æ¸²æŸ“ç³»ç»Ÿ</h4>
<p>MapToPoster çš„æ¸²æŸ“ç³»ç»Ÿä½¿ç”¨ matplotlibï¼ŒæŒ‰ç…§ç‰¹å®šçš„å±‚æ¬¡é¡ºåºæ¸²æŸ“ï¼š</p>
<p><strong>æ¸²æŸ“å±‚æ¬¡ï¼ˆz-orderï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">z</span>=<span class="hljs-number">11</span>  æ–‡æœ¬æ ‡ç­¾ï¼ˆåŸå¸‚åã€å›½å®¶åã€åæ ‡ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">10</span>  æ¸å˜é®ç½©ï¼ˆé¡¶éƒ¨å’Œåº•éƒ¨æ¸å˜æ•ˆæœï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">3</span>   é“è·¯ç½‘ç»œï¼ˆé€šè¿‡ ox.plot_graphï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">2</span>   å…¬å›­ï¼ˆç»¿è‰²å¤šè¾¹å½¢ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">1</span>   æ°´åŸŸï¼ˆè“è‰²å¤šè¾¹å½¢ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">0</span>   èƒŒæ™¯è‰²
</code></pre>
<p><strong>é“è·¯åˆ†çº§æ¸²æŸ“</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¹æ®é“è·¯ç±»å‹è®¾ç½®é¢œè‰²å’Œå®½åº¦</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_edge_colors_by_type</span>(<span class="hljs-params">edge_types, theme</span>):
    colors = []
    <span class="hljs-keyword">for</span> edge_type <span class="hljs-keyword">in</span> edge_types:
        <span class="hljs-keyword">if</span> <span class="hljs-string">'motorway'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_motorway'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'primary'</span> <span class="hljs-keyword">in</span> edge_type <span class="hljs-keyword">or</span> <span class="hljs-string">'trunk'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_primary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'secondary'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_secondary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'tertiary'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_tertiary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'residential'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_residential'</span>])
        <span class="hljs-keyword">else</span>:
            colors.append(theme[<span class="hljs-string">'road_default'</span>])
    <span class="hljs-keyword">return</span> colors
</code></pre>
<p><strong>é“è·¯å®½åº¦åˆ†çº§</strong>ï¼š</p>
<ul>
<li><code>motorway, motorway_link</code>ï¼šæœ€ç²—ï¼ˆ1.2ï¼‰ï¼Œæœ€æ·±è‰²</li>
<li><code>trunk, primary</code>ï¼šç²—ï¼ˆ1.0ï¼‰</li>
<li><code>secondary</code>ï¼šä¸­ç­‰ï¼ˆ0.8ï¼‰</li>
<li><code>tertiary</code>ï¼šç»†ï¼ˆ0.6ï¼‰</li>
<li><code>residential, living_street</code>ï¼šæœ€ç»†ï¼ˆ0.4ï¼‰ï¼Œæœ€æµ…è‰²</li>
</ul>
<h4 data-id="heading-23">5. å­—ä½“ç®¡ç†ç³»ç»Ÿ</h4>
<p>MapToPoster åŒ…å«ä¸€ä¸ªæ™ºèƒ½çš„å­—ä½“ç®¡ç†ç³»ç»Ÿï¼š</p>
<p><strong>å­—ä½“åŠ è½½é€»è¾‘</strong>ï¼š</p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨æœ¬åœ°å­—ä½“ï¼ˆ<code>fonts/</code> ç›®å½•ï¼‰</li>
<li>å¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œä» Google Fonts ä¸‹è½½</li>
<li>è‡ªåŠ¨ç¼“å­˜ä¸‹è½½çš„å­—ä½“åˆ° <code>fonts/cache/</code> ç›®å½•</li>
</ol>
<p><strong>è„šæœ¬æ£€æµ‹</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬æ˜¯å¦ä¸ºæ‹‰ä¸è„šæœ¬</li>
<li>æ‹‰ä¸è„šæœ¬ï¼šåº”ç”¨å­—æ¯é—´è·ï¼Œå‘ˆç° "P A R I S" æ•ˆæœ</li>
<li>éæ‹‰ä¸è„šæœ¬ï¼ˆä¸­æ–‡ã€æ—¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ç­‰ï¼‰ï¼šä½¿ç”¨è‡ªç„¶é—´è·</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_latin_script</span>(<span class="hljs-params">text</span>):
    <span class="hljs-string">"""æ£€æµ‹æ–‡æœ¬æ˜¯å¦ä¸ºæ‹‰ä¸è„šæœ¬"""</span>
    latin_chars = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> text <span class="hljs-keyword">if</span> <span class="hljs-string">'\u0000'</span> &lt;= c &lt;= <span class="hljs-string">'\u024F'</span>)
    total_chars = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> text <span class="hljs-keyword">if</span> c.isalpha())
    <span class="hljs-keyword">return</span> (latin_chars / total_chars) &gt; <span class="hljs-number">0.8</span> <span class="hljs-keyword">if</span> total_chars &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span>
</code></pre>
<h3 data-id="heading-24">å…³é”®æŠ€æœ¯å®ç°</h3>
<h4 data-id="heading-25">1. æ¸å˜é®ç½©æ•ˆæœ</h4>
<p>MapToPoster åœ¨é¡¶éƒ¨å’Œåº•éƒ¨æ·»åŠ æ¸å˜é®ç½©ï¼Œå¢å¼ºè§†è§‰æ•ˆæœï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_gradient_fade</span>(<span class="hljs-params">ax, position=<span class="hljs-string">'top'</span>, height=<span class="hljs-number">0.15</span></span>):
    <span class="hljs-string">"""åˆ›å»ºæ¸å˜é®ç½©"""</span>
    <span class="hljs-keyword">if</span> position == <span class="hljs-string">'top'</span>:
        y_start, y_end = <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span> - height
    <span class="hljs-keyword">else</span>:
        y_start, y_end = height, <span class="hljs-number">0.0</span>
    
    <span class="hljs-comment"># åˆ›å»ºæ¸å˜</span>
    gradient = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">256</span>).reshape(<span class="hljs-number">256</span>, -<span class="hljs-number">1</span>)
    gradient = np.vstack((gradient, gradient))
    
    ax.imshow(
        gradient,
        aspect=<span class="hljs-string">'auto'</span>,
        extent=[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, y_start, y_end],
        cmap=theme[<span class="hljs-string">'gradient_color'</span>],
        alpha=<span class="hljs-number">0.3</span>,
        zorder=<span class="hljs-number">10</span>
    )
</code></pre>
<h4 data-id="heading-26">2. æ–‡æœ¬å®šä½ç³»ç»Ÿ</h4>
<p>æ‰€æœ‰æ–‡æœ¬ä½¿ç”¨å½’ä¸€åŒ–åæ ‡ï¼ˆ0-1èŒƒå›´ï¼‰ï¼Œç¡®ä¿åœ¨ä¸åŒåˆ†è¾¨ç‡ä¸‹ä½ç½®ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–‡æœ¬ä½ç½®å®šä¹‰</span>
y_city_name = <span class="hljs-number">0.14</span>      <span class="hljs-comment"># åŸå¸‚å</span>
y_decorative_line = <span class="hljs-number">0.125</span>  <span class="hljs-comment"># è£…é¥°çº¿</span>
y_country_name = <span class="hljs-number">0.10</span>    <span class="hljs-comment"># å›½å®¶å</span>
y_coordinates = <span class="hljs-number">0.07</span>     <span class="hljs-comment"># åæ ‡</span>
y_attribution = <span class="hljs-number">0.02</span>     <span class="hljs-comment"># åº•éƒ¨æ ‡æ³¨</span>
</code></pre>
<h4 data-id="heading-27">3. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h4>
<p><strong>è·ç¦»å‚æ•°å»ºè®®</strong>ï¼š</p>
<ul>
<li>4000-6000mï¼šå°å‹/å¯†é›†åŸå¸‚ï¼ˆå¨å°¼æ–¯ã€é˜¿å§†æ–¯ç‰¹ä¸¹å¸‚ä¸­å¿ƒï¼‰</li>
<li>8000-12000mï¼šä¸­ç­‰åŸå¸‚ï¼Œèšç„¦å¸‚ä¸­å¿ƒï¼ˆå·´é»ã€å·´å¡ç½—é‚£ï¼‰</li>
<li>15000-20000mï¼šå¤§å‹éƒ½å¸‚ï¼Œå®Œæ•´åŸå¸‚è§†å›¾ï¼ˆä¸œäº¬ã€å­Ÿä¹°ï¼‰</li>
</ul>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å¤§è·ç¦»å€¼ï¼ˆ&gt;20kmï¼‰ä¼šå¯¼è‡´ä¸‹è½½æ…¢ä¸”å†…å­˜å ç”¨é«˜</li>
<li>ç¼“å­˜åæ ‡æ•°æ®ï¼Œé¿å… Nominatim é€Ÿç‡é™åˆ¶</li>
<li>ä½¿ç”¨ <code>network_type='drive'</code> è€Œä¸æ˜¯ <code>'all'</code> ä»¥åŠ å¿«æ¸²æŸ“</li>
<li>é¢„è§ˆæ—¶å¯å°† DPI ä» 300 é™è‡³ 150</li>
</ul>
<hr/>
<h2 data-id="heading-28">å®é™…ä½¿ç”¨æ¡ˆä¾‹</h2>
<h3 data-id="heading-29">æ¡ˆä¾‹1ï¼šåˆ¶ä½œæ—…è¡Œçºªå¿µæµ·æŠ¥ç³»åˆ—</h3>
<p><strong>åœºæ™¯</strong>ï¼šè®°å½•ä¸€æ¬¡æ¬§æ´²ä¹‹æ—…ï¼Œä¸ºæ¯ä¸ªè®¿é—®çš„åŸå¸‚ç”Ÿæˆæµ·æŠ¥ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè„šæœ¬æ‰¹é‡ç”Ÿæˆ</span>
<span class="hljs-comment">#!/bin/bash</span>
cities=(<span class="hljs-string">"Paris:France"</span> <span class="hljs-string">"London:UK"</span> <span class="hljs-string">"Rome:Italy"</span> <span class="hljs-string">"Barcelona:Spain"</span>)
theme=<span class="hljs-string">"noir"</span>

<span class="hljs-keyword">for</span> city_country <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${cities[@]}</span>"</span>; <span class="hljs-keyword">do</span>
    IFS=<span class="hljs-string">':'</span> <span class="hljs-built_in">read</span> -r city country &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$city_country</span>"</span>
    python create_map_poster.py -c <span class="hljs-string">"<span class="hljs-variable">$city</span>"</span> -C <span class="hljs-string">"<span class="hljs-variable">$country</span>"</span> -t <span class="hljs-string">"<span class="hljs-variable">$theme</span>"</span> -d 10000
<span class="hljs-keyword">done</span>
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šç”Ÿæˆç»Ÿä¸€é£æ ¼çš„åŸå¸‚ç³»åˆ—æµ·æŠ¥ï¼Œé€‚åˆåˆ¶ä½œç›¸å†Œæˆ–è£…é¥°ã€‚</p>
<h3 data-id="heading-30">æ¡ˆä¾‹2ï¼šä¸ºè®¾è®¡é¡¹ç›®åˆ›å»ºåœ°å›¾ç´ æ</h3>
<p><strong>åœºæ™¯</strong>ï¼šè®¾è®¡å¸ˆéœ€è¦ä¸ºå“ç‰Œé¡¹ç›®åˆ›å»ºåŸå¸‚åœ°å›¾å…ƒç´ ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°è¯•ä¸åŒä¸»é¢˜ï¼Œæ‰¾åˆ°æœ€é€‚åˆå“ç‰Œé£æ ¼çš„</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> --all-themes -d 12000

<span class="hljs-comment"># ç„¶åé€‰æ‹©æœ€åˆé€‚çš„ä¸»é¢˜ï¼Œç”Ÿæˆæœ€ç»ˆç‰ˆæœ¬</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> -t blueprint -d 12000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè·å¾—å¤šç§é£æ ¼é€‰æ‹©ï¼Œæ‰¾åˆ°ä¸å“ç‰Œè°ƒæ€§åŒ¹é…çš„åœ°å›¾è®¾è®¡ã€‚</p>
<h3 data-id="heading-31">æ¡ˆä¾‹3ï¼šåŸå¸‚è§„åˆ’å±•ç¤º</h3>
<p><strong>åœºæ™¯</strong>ï¼šåŸå¸‚è§„åˆ’å¸ˆéœ€è¦å±•ç¤ºä¸åŒåŒºåŸŸçš„é“è·¯ç½‘ç»œç»“æ„ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ç²¾ç¡®åæ ‡ï¼Œèšç„¦ç‰¹å®šåŒºåŸŸ</span>
python create_map_poster.py \
  --city <span class="hljs-string">"Shanghai"</span> \
  --country <span class="hljs-string">"China"</span> \
  -lat 31.2304 -long 121.4737 \
  -t contrast_zones \
  -d 8000

<span class="hljs-comment"># å¯¹æ¯”ä¸åŒåŒºåŸŸ</span>
python create_map_poster.py \
  --city <span class="hljs-string">"Shanghai"</span> \
  --country <span class="hljs-string">"China"</span> \
  -lat 31.2000 -long 121.5000 \
  -t contrast_zones \
  -d 8000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šæ¸…æ™°å±•ç¤ºä¸åŒåŒºåŸŸçš„é“è·¯å¯†åº¦å’Œç»“æ„å·®å¼‚ã€‚</p>
<h3 data-id="heading-32">æ¡ˆä¾‹4ï¼šè‰ºæœ¯åˆ›ä½œé¡¹ç›®</h3>
<p><strong>åœºæ™¯</strong>ï¼šè‰ºæœ¯å®¶éœ€è¦ä¸ºå±•è§ˆåˆ›ä½œåŸå¸‚ä¸»é¢˜ä½œå“ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”ŸæˆåŒä¸€åŸå¸‚çš„å¤šç§ä¸»é¢˜ï¼Œç”¨äºå¯¹æ¯”å’Œé€‰æ‹©</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> --all-themes -d 15000

<span class="hljs-comment"># é€‰æ‹©æœ€ç¬¦åˆè‰ºæœ¯ç†å¿µçš„ä¸»é¢˜</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t japanese_ink -d 15000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè·å¾—å…·æœ‰è‰ºæœ¯æ„Ÿçš„åœ°å›¾è®¾è®¡ï¼Œå¯ç›´æ¥ç”¨äºè‰ºæœ¯åˆ›ä½œã€‚</p>
<hr/>
<h2 data-id="heading-33">é«˜çº§å®šåˆ¶æŠ€å·§</h2>
<h3 data-id="heading-34">1. åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜</h3>
<p>åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜éå¸¸ç®€å•ï¼Œåªéœ€åœ¨ <code>themes/</code> ç›®å½•ä¸‹åˆ›å»º JSON æ–‡ä»¶ï¼š</p>
<p><strong>æ­¥éª¤1ï¼šåˆ›å»ºä¸»é¢˜æ–‡ä»¶</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// themes/my_custom_theme.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"My Custom Theme"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"A custom theme with warm colors"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#2C1810"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#F5E6D3"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"gradient_color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#2C1810"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"water"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#1A4A5C"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parks"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#3A5A3A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_motorway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#E8B86D"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D4A574"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_secondary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#C0956A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_tertiary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#AD8560"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_residential"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#9A7556"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_default"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#AD8560"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ­¥éª¤2ï¼šä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜</strong></p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> -t my_custom_theme -d 10000
</code></pre>
<p><strong>ä¸»é¢˜è®¾è®¡å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä¿æŒé“è·¯é¢œè‰²å±‚æ¬¡æ¸…æ™°ï¼ˆmotorway &gt; primary &gt; secondary &gt; tertiary &gt; residentialï¼‰</li>
<li>èƒŒæ™¯è‰²ä¸é“è·¯è‰²å¯¹æ¯”åº¦è¦è¶³å¤Ÿ</li>
<li>è€ƒè™‘æ‰“å°æ•ˆæœï¼Œé¿å…è¿‡äºé²œè‰³çš„é¢œè‰²</li>
<li>å‚è€ƒç°æœ‰ä¸»é¢˜çš„é…è‰²æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-35">2. è°ƒæ•´æ¸²æŸ“å‚æ•°</h3>
<p>MapToPoster æ”¯æŒå¤šç§æ¸²æŸ“å‚æ•°è°ƒæ•´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ create_map_poster.py ä¸­å¯ä»¥è°ƒæ•´çš„å‚æ•°ï¼š</span>

<span class="hljs-comment"># DPI è®¾ç½®ï¼ˆå½±å“è¾“å‡ºåˆ†è¾¨ç‡ï¼‰</span>
dpi = <span class="hljs-number">300</span>  <span class="hljs-comment"># é»˜è®¤300ï¼Œæ‰“å°è´¨é‡</span>
dpi = <span class="hljs-number">150</span>  <span class="hljs-comment"># é¢„è§ˆè´¨é‡ï¼Œç”Ÿæˆæ›´å¿«</span>

<span class="hljs-comment"># å›¾ç‰‡å°ºå¯¸</span>
figsize = (<span class="hljs-number">12</span>, <span class="hljs-number">16</span>)  <span class="hljs-comment"># å®½é«˜æ¯”ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´</span>

<span class="hljs-comment"># å­—ä½“å¤§å°</span>
city_font_size = <span class="hljs-number">72</span>  <span class="hljs-comment"># åŸå¸‚åå­—ä½“</span>
country_font_size = <span class="hljs-number">36</span>  <span class="hljs-comment"># å›½å®¶åå­—ä½“</span>
coord_font_size = <span class="hljs-number">24</span>  <span class="hljs-comment"># åæ ‡å­—ä½“</span>

<span class="hljs-comment"># æ¸å˜é®ç½©é«˜åº¦</span>
gradient_height = <span class="hljs-number">0.15</span>  <span class="hljs-comment"># é¡¶éƒ¨å’Œåº•éƒ¨æ¸å˜åŒºåŸŸé«˜åº¦ï¼ˆ0-1èŒƒå›´ï¼‰</span>
</code></pre>
<h3 data-id="heading-36">3. æ‰¹é‡ç”Ÿæˆè„šæœ¬</h3>
<p>åˆ›å»ºä¸€ä¸ª Python è„šæœ¬æ¥æ‰¹é‡ç”Ÿæˆå¤šä¸ªåŸå¸‚çš„æµ·æŠ¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># batch_generate.py</span>

<span class="hljs-keyword">import</span> subprocess
<span class="hljs-keyword">import</span> sys

cities = [
    (<span class="hljs-string">"Paris"</span>, <span class="hljs-string">"France"</span>, <span class="hljs-string">"noir"</span>, <span class="hljs-number">10000</span>),
    (<span class="hljs-string">"Tokyo"</span>, <span class="hljs-string">"Japan"</span>, <span class="hljs-string">"neon_cyberpunk"</span>, <span class="hljs-number">15000</span>),
    (<span class="hljs-string">"New York"</span>, <span class="hljs-string">"USA"</span>, <span class="hljs-string">"blueprint"</span>, <span class="hljs-number">12000</span>),
    (<span class="hljs-string">"London"</span>, <span class="hljs-string">"UK"</span>, <span class="hljs-string">"midnight_blue"</span>, <span class="hljs-number">10000</span>),
]

<span class="hljs-keyword">for</span> city, country, theme, distance <span class="hljs-keyword">in</span> cities:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Generating <span class="hljs-subst">{city}</span> with <span class="hljs-subst">{theme}</span> theme..."</span>)
    cmd = [
        <span class="hljs-string">"python"</span>, <span class="hljs-string">"create_map_poster.py"</span>,
        <span class="hljs-string">"-c"</span>, city,
        <span class="hljs-string">"-C"</span>, country,
        <span class="hljs-string">"-t"</span>, theme,
        <span class="hljs-string">"-d"</span>, <span class="hljs-built_in">str</span>(distance)
    ]
    subprocess.run(cmd)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ Completed <span class="hljs-subst">{city}</span>\n"</span>)
</code></pre>
<p>è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python batch_generate.py
</code></pre>
<h3 data-id="heading-37">4. é›†æˆåˆ°å…¶ä»–é¡¹ç›®</h3>
<p>MapToPoster å¯ä»¥ä½œä¸º Python æ¨¡å—å¯¼å…¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä½ çš„ Python é¡¹ç›®ä¸­</span>
<span class="hljs-keyword">import</span> sys
sys.path.append(<span class="hljs-string">'/path/to/maptoposter'</span>)

<span class="hljs-keyword">from</span> create_map_poster <span class="hljs-keyword">import</span> create_poster, get_coordinates, load_theme

<span class="hljs-comment"># è·å–åæ ‡</span>
lat, lon = get_coordinates(<span class="hljs-string">"Shanghai"</span>, <span class="hljs-string">"China"</span>)

<span class="hljs-comment"># åŠ è½½ä¸»é¢˜</span>
theme = load_theme(<span class="hljs-string">"noir"</span>)

<span class="hljs-comment"># åˆ›å»ºæµ·æŠ¥</span>
create_poster(
    city=<span class="hljs-string">"Shanghai"</span>,
    country=<span class="hljs-string">"China"</span>,
    lat=lat,
    lon=lon,
    theme_name=<span class="hljs-string">"noir"</span>,
    dist=<span class="hljs-number">10000</span>
)
</code></pre>
<h3 data-id="heading-38">5. æ·»åŠ è‡ªå®šä¹‰åœ°å›¾å…ƒç´ </h3>
<p>å¦‚æœä½ æƒ³æ·»åŠ æ–°çš„åœ°å›¾å…ƒç´ ï¼ˆå¦‚é“è·¯ã€å»ºç­‘ç‰©ç­‰ï¼‰ï¼Œå¯ä»¥ä¿®æ”¹ <code>create_poster()</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ create_poster() å‡½æ•°ä¸­æ·»åŠ é“è·¯</span>
<span class="hljs-keyword">try</span>:
    railways = ox.features_from_point(
        point=(lat, lon),
        tags={<span class="hljs-string">'railway'</span>: <span class="hljs-string">'rail'</span>},
        dist=distance
    )
    <span class="hljs-keyword">if</span> railways <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> railways.empty:
        railways.plot(
            ax=ax,
            color=theme.get(<span class="hljs-string">'railway'</span>, <span class="hljs-string">'#FF0000'</span>),
            linewidth=<span class="hljs-number">0.5</span>,
            zorder=<span class="hljs-number">2.5</span>  <span class="hljs-comment"># åœ¨é“è·¯ä¸‹æ–¹ï¼Œå…¬å›­ä¸Šæ–¹</span>
        )
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Could not fetch railways: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>è®°å¾—åœ¨ä¸»é¢˜ JSON ä¸­æ·»åŠ å¯¹åº”çš„é¢œè‰²é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"railway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF6B6B"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-39">å¸¸è§é—®é¢˜è§£å†³</h2>
<h3 data-id="heading-40">é—®é¢˜1ï¼šåœ°ç†ç¼–ç å¤±è´¥</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šæ— æ³•æ‰¾åˆ°åŸå¸‚åæ ‡ï¼ŒæŠ¥é”™ "Could not geocode city"ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>ä½¿ç”¨æ›´å…·ä½“çš„åŸå¸‚å</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸æ¨è</span>
python create_map_poster.py -c <span class="hljs-string">"NYC"</span> -C <span class="hljs-string">"USA"</span> ...

<span class="hljs-comment"># æ¨è</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> ...
</code></pre>
</li>
<li>
<p><strong>ç›´æ¥æŒ‡å®šåæ ‡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py \
  --city <span class="hljs-string">"Custom Location"</span> \
  --country <span class="hljs-string">"Custom"</span> \
  -lat 40.7128 -long -74.0060 \
  -t noir -d 10000
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥</strong>ï¼šNominatim éœ€è¦ç½‘ç»œè®¿é—®ã€‚</p>
</li>
</ol>
<h3 data-id="heading-41">é—®é¢˜2ï¼šä¸‹è½½æ•°æ®å¤ªæ…¢</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šè·å–åœ°å›¾æ•°æ®éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‡å°è·ç¦»èŒƒå›´</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä» 20000m å‡å°åˆ° 10000m</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t noir -d 10000
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨ç¼“å­˜</strong>ï¼šOSMnx ä¼šè‡ªåŠ¨ç¼“å­˜æ•°æ®ï¼Œç¬¬äºŒæ¬¡ç”Ÿæˆç›¸åŒåŒºåŸŸä¼šæ›´å¿«ã€‚</p>
</li>
<li>
<p><strong>é€‰æ‹©ç½‘ç»œç±»å‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­ä½¿ç”¨ 'drive' è€Œä¸æ˜¯ 'all'</span>
G = ox.graph_from_point(point, dist=distance, network_type=<span class="hljs-string">'drive'</span>)
</code></pre>
</li>
</ol>
<h3 data-id="heading-42">é—®é¢˜3ï¼šç”Ÿæˆçš„æµ·æŠ¥é“è·¯å¤ªå°‘æˆ–å¤ªå¤š</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šé“è·¯å¯†åº¦ä¸åˆé€‚ï¼Œè¦ä¹ˆå¤ªç¨€ç–ï¼Œè¦ä¹ˆå¤ªå¯†é›†ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>è°ƒæ•´è·ç¦»å‚æ•°</strong>ï¼š</p>
<ul>
<li>é“è·¯å¤ªå°‘ï¼šå¢å¤§è·ç¦»ï¼ˆå¦‚ä» 8000m åˆ° 12000mï¼‰</li>
<li>é“è·¯å¤ªå¤šï¼šå‡å°è·ç¦»ï¼ˆå¦‚ä» 15000m åˆ° 10000mï¼‰</li>
</ul>
</li>
<li>
<p><strong>è°ƒæ•´ä¸­å¿ƒç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœå¸‚ä¸­å¿ƒå¤ªå¯†é›†ï¼Œå¯ä»¥ç¨å¾®åç§»ä¸­å¿ƒç‚¹</span>
python create_map_poster.py \
  -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> \
  -lat 35.6762 -long 139.6503 \
  -t noir -d 12000
</code></pre>
</li>
</ol>
<h3 data-id="heading-43">é—®é¢˜4ï¼šå­—ä½“æ˜¾ç¤ºé—®é¢˜</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šä¸­æ–‡å­—ç¬¦æˆ–ç‰¹æ®Šå­—ç¬¦æ˜¾ç¤ºä¸æ­£ç¡®ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥å­—ä½“æ–‡ä»¶</strong>ï¼šç¡®ä¿ <code>fonts/</code> ç›®å½•åŒ…å«æ”¯æŒè¯¥å­—ç¬¦é›†çš„å­—ä½“ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨ Google Fonts</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># font_management.py ä¼šè‡ªåŠ¨ä» Google Fonts ä¸‹è½½å­—ä½“</span>
<span class="hljs-comment"># ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸</span>
</code></pre>
</li>
<li>
<p><strong>æ‰‹åŠ¨æŒ‡å®šå­—ä½“</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­æŒ‡å®šæ”¯æŒä¸­æ–‡çš„å­—ä½“</span>
font_path = <span class="hljs-string">'/path/to/chinese-font.ttf'</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-44">é—®é¢˜5ï¼šå†…å­˜ä¸è¶³</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šç”Ÿæˆå¤§å‹åŸå¸‚åœ°å›¾æ—¶å†…å­˜æº¢å‡ºã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‡å°è·ç¦»èŒƒå›´</strong>ï¼šè¿™æ˜¯æœ€ç›´æ¥çš„æ–¹æ³•ã€‚</p>
</li>
<li>
<p><strong>é™ä½ DPI</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­è®¾ç½®è¾ƒä½çš„ DPI</span>
plt.savefig(output_path, dpi=<span class="hljs-number">150</span>, bbox_inches=<span class="hljs-string">'tight'</span>)
</code></pre>
</li>
<li>
<p><strong>åˆ†æ‰¹å¤„ç†</strong>ï¼šå¯¹äºè¶…å¤§åŒºåŸŸï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªå°åŒºåŸŸçš„æµ·æŠ¥ï¼Œç„¶åæ‹¼æ¥ã€‚</p>
</li>
</ol>
<h3 data-id="heading-45">é—®é¢˜6ï¼šä¸»é¢˜é¢œè‰²ä¸ç†æƒ³</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šç”Ÿæˆçš„æµ·æŠ¥é¢œè‰²å¯¹æ¯”åº¦ä¸å¤Ÿæˆ–ä¸ç¬¦åˆé¢„æœŸã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥ä¸»é¢˜ JSON</strong>ï¼šç¡®ä¿é¢œè‰²å€¼æ ¼å¼æ­£ç¡®ï¼ˆ<code>#RRGGBB</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>è°ƒæ•´é“è·¯é¢œè‰²å±‚æ¬¡</strong>ï¼šç¡®ä¿ motorway &gt; primary &gt; secondary &gt; tertiary &gt; residential çš„äº®åº¦é€’å‡ã€‚</p>
</li>
<li>
<p><strong>æµ‹è¯•ä¸åŒä¸»é¢˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> --all-themes -d 10000
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-46">ä¸å…¶ä»–å·¥å…·çš„é›†æˆ</h2>
<h3 data-id="heading-47">1. ä¸å›¾åƒå¤„ç†å·¥å…·é›†æˆ</h3>
<p>ç”Ÿæˆçš„æµ·æŠ¥å¯ä»¥è¿›ä¸€æ­¥ç”¨å›¾åƒå¤„ç†å·¥å…·ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ ImageMagick è°ƒæ•´å¤§å°</span>
convert Paris_noir_*.png -resize 2000x3000 poster_resized.png

<span class="hljs-comment"># ä½¿ç”¨ ImageMagick æ·»åŠ è¾¹æ¡†</span>
convert Paris_noir_*.png -border 50x50 -bordercolor white poster_bordered.png

<span class="hljs-comment"># æ‰¹é‡å¤„ç†</span>
<span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> posters/*.png; <span class="hljs-keyword">do</span>
    convert <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span> -resize 2000x3000 <span class="hljs-string">"resized_<span class="hljs-subst">$(basename $file)</span>"</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h3 data-id="heading-48">2. ä¸ Web åº”ç”¨é›†æˆ</h3>
<p>å¯ä»¥å°† MapToPoster é›†æˆåˆ° Web åº”ç”¨ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Flask ç¤ºä¾‹</span>
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, send_file
<span class="hljs-keyword">import</span> tempfile
<span class="hljs-keyword">import</span> os

app = Flask(__name__)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/generate/&lt;city&gt;/&lt;country&gt;/&lt;theme&gt;'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_poster</span>(<span class="hljs-params">city, country, theme</span>):
    <span class="hljs-comment"># ç”Ÿæˆæµ·æŠ¥</span>
    output_path = create_poster(city, country, theme_name=theme, dist=<span class="hljs-number">10000</span>)
    
    <span class="hljs-comment"># è¿”å›æ–‡ä»¶</span>
    <span class="hljs-keyword">return</span> send_file(output_path, mimetype=<span class="hljs-string">'image/png'</span>)
</code></pre>
<h3 data-id="heading-49">3. ä¸è‡ªåŠ¨åŒ–å·¥ä½œæµé›†æˆ</h3>
<p>å¯ä»¥é›†æˆåˆ° CI/CD æˆ–å…¶ä»–è‡ªåŠ¨åŒ–æµç¨‹ä¸­ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actions ç¤ºä¾‹</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">City</span> <span class="hljs-string">Posters</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">schedule:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">cron:</span> <span class="hljs-string">'0 0 * * 1'</span>  <span class="hljs-comment"># æ¯å‘¨ä¸€ç”Ÿæˆ</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">generate:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">python-version:</span> <span class="hljs-string">'3.9'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">-r</span> <span class="hljs-string">requirements.txt</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">create_map_poster.py</span> <span class="hljs-string">-c</span> <span class="hljs-string">"Paris"</span> <span class="hljs-string">-C</span> <span class="hljs-string">"France"</span> <span class="hljs-string">-t</span> <span class="hljs-string">noir</span> <span class="hljs-string">-d</span> <span class="hljs-number">10000</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">posters</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">posters/</span>
</code></pre>
<h3 data-id="heading-50">4. ä¸æ•°æ®å¯è§†åŒ–å·¥å…·ç»“åˆ</h3>
<p>å¯ä»¥å°†ç”Ÿæˆçš„æµ·æŠ¥ä¸å…¶ä»–æ•°æ®å¯è§†åŒ–å·¥å…·ç»“åˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ PIL/Pillow æ·»åŠ æ•°æ®å›¾è¡¨</span>
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageDraw, ImageFont

<span class="hljs-comment"># æ‰“å¼€ç”Ÿæˆçš„æµ·æŠ¥</span>
poster = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">'Paris_noir_20260208_143022.png'</span>)
draw = ImageDraw.Draw(poster)

<span class="hljs-comment"># æ·»åŠ è‡ªå®šä¹‰æ ‡æ³¨æˆ–å›¾è¡¨</span>
<span class="hljs-comment"># ... ä½ çš„è‡ªå®šä¹‰ä»£ç  ...</span>

<span class="hljs-comment"># ä¿å­˜</span>
poster.save(<span class="hljs-string">'poster_with_chart.png'</span>)
</code></pre>
<hr/>
<h2 data-id="heading-51">é¡¹ç›®åœ°å€ä¸èµ„æº</h2>
<h3 data-id="heading-52">å®˜æ–¹èµ„æº</h3>
<ul>
<li>ğŸŒŸ <strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">github.com/originalankâ€¦</a></li>
</ul>
<hr/>
<h2 data-id="heading-53">é€‚ç”¨äººç¾¤</h2>
<p>MapToPoster é€‚åˆä»¥ä¸‹äººç¾¤ï¼š</p>
<h3 data-id="heading-54">1. è®¾è®¡å¸ˆå’Œè‰ºæœ¯åˆ›ä½œè€…</h3>
<ul>
<li>âœ… éœ€è¦åŸå¸‚åœ°å›¾ç´ æçš„è®¾è®¡å¸ˆ</li>
<li>âœ… åˆ›ä½œåŸå¸‚ä¸»é¢˜è‰ºæœ¯ä½œå“çš„è‰ºæœ¯å®¶</li>
<li>âœ… éœ€è¦æ‰¹é‡ç”Ÿæˆåœ°å›¾è®¾è®¡çš„åˆ›æ„å·¥ä½œè€…</li>
</ul>
<h3 data-id="heading-55">2. Python å¼€å‘è€…</h3>
<ul>
<li>âœ… å¯¹æ•°æ®å¯è§†åŒ–æ„Ÿå…´è¶£çš„å¼€å‘è€…</li>
<li>âœ… å¸Œæœ›å­¦ä¹ åœ°ç†æ•°æ®å¤„ç†æŠ€æœ¯çš„ç¨‹åºå‘˜</li>
<li>âœ… éœ€è¦å°†åœ°å›¾é›†æˆåˆ°é¡¹ç›®ä¸­çš„å¼€å‘è€…</li>
</ul>
<h3 data-id="heading-56">3. åœ°ç†å’ŒåŸå¸‚è§„åˆ’ä¸“ä¸šäººå£«</h3>
<ul>
<li>âœ… åŸå¸‚è§„åˆ’å¸ˆå’Œå»ºç­‘å¸ˆ</li>
<li>âœ… åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰å·¥ä½œè€…</li>
<li>âœ… éœ€è¦å±•ç¤ºåŸå¸‚ç»“æ„çš„ä¸“ä¸šäººå£«</li>
</ul>
<h3 data-id="heading-57">4. æ™®é€šç”¨æˆ·</h3>
<ul>
<li>âœ… å¸Œæœ›åˆ¶ä½œä¸ªæ€§åŒ–åŸå¸‚æµ·æŠ¥çš„ç”¨æˆ·</li>
<li>âœ… è®°å½•æ—…è¡Œè¶³è¿¹çš„æ—…è¡Œè€…</li>
<li>âœ… å–œæ¬¢åœ°å›¾å’Œåœ°ç†æ•°æ®çš„çˆ±å¥½è€…</li>
</ul>
<h3 data-id="heading-58">5. æ•™è‚²å·¥ä½œè€…</h3>
<ul>
<li>âœ… åœ°ç†æ•™å¸ˆéœ€è¦å¯è§†åŒ–å·¥å…·</li>
<li>âœ… æ•°æ®å¯è§†åŒ–è¯¾ç¨‹çš„æ•™å­¦</li>
<li>âœ… ç¼–ç¨‹å’Œè®¾è®¡è¯¾ç¨‹çš„é¡¹ç›®ç´ æ</li>
</ul>
<hr/>
<h2 data-id="heading-59">æ€»ç»“</h2>
<p>MapToPoster æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼Œå®ƒå°†å¤æ‚çš„åœ°å›¾æ•°æ®å¤„ç†å’Œç²¾ç¾çš„è§†è§‰è®¾è®¡å®Œç¾ç»“åˆã€‚é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä»»ä½•äººéƒ½å¯ä»¥å°†å–œæ¬¢çš„åŸå¸‚è½¬æ¢æˆç‹¬ç‰¹çš„è‰ºæœ¯ä½œå“ã€‚</p>
<p><strong>é¡¹ç›®äº®ç‚¹å›é¡¾</strong>ï¼š</p>
<ul>
<li>ğŸ¨ <strong>17ç§ç²¾ç¾ä¸»é¢˜</strong>ï¼šä»æç®€åˆ°èµ›åšæœ‹å…‹ï¼Œæ»¡è¶³å„ç§å®¡ç¾éœ€æ±‚</li>
<li>ğŸ—ºï¸ <strong>çœŸå®åœ°å›¾æ•°æ®</strong>ï¼šåŸºäº OpenStreetMapï¼Œæ•°æ®å‡†ç¡®ä¸”å…è´¹</li>
<li>ğŸ <strong>çº¯Pythonå®ç°</strong>ï¼šä»£ç æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œå®šåˆ¶</li>
<li>ğŸ¯ <strong>ç®€å•æ˜“ç”¨</strong>ï¼šä¸€æ¡å‘½ä»¤å³å¯ç”Ÿæˆæµ·æŠ¥</li>
<li>ğŸ”§ <strong>é«˜åº¦å¯å®šåˆ¶</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜ã€å­—ä½“ã€å‚æ•°ç­‰</li>
<li>ğŸŒ <strong>å…¨çƒæ”¯æŒ</strong>ï¼šæ”¯æŒä¸–ç•Œä»»ä½•åŸå¸‚çš„é“è·¯ç½‘ç»œ</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ä¸ªäººæ”¶è—å’Œè£…é¥°</li>
<li>è®¾è®¡å’Œè‰ºæœ¯åˆ›ä½œ</li>
<li>æ•™è‚²å’Œå±•ç¤º</li>
<li>æ‰¹é‡ç”Ÿæˆå’Œè‡ªåŠ¨åŒ–</li>
</ul>
<p><strong>æŠ€æœ¯ä»·å€¼</strong>ï¼š</p>
<ul>
<li>å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Python å¤„ç†åœ°ç†æ•°æ®</li>
<li>æä¾›äº†æ•°æ®å¯è§†åŒ–çš„ä¼˜ç§€å®è·µ</li>
<li>å±•ç¤ºäº†å¼€æºå·¥å…·çš„å¼ºå¤§å’Œçµæ´»æ€§</li>
</ul>
<p>æ— è®ºä½ æ˜¯è®¾è®¡å¸ˆã€å¼€å‘è€…ï¼Œè¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼ŒMapToPoster éƒ½èƒ½å¸®åŠ©ä½ åˆ›é€ å‡ºç‹¬ç‰¹è€Œç²¾ç¾çš„åŸå¸‚åœ°å›¾æµ·æŠ¥ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„é¡¹ç›®ï¼Œä½ å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†äº«ã€‚</p>
<hr/>
<p><em>æ¬¢è¿æ¥æˆ‘ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>æ‰¾åˆ°æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†å’Œæœ‰è¶£çš„äº§å“</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”]]></title>    <link>https://juejin.cn/post/7603649945977962515</link>    <guid>https://juejin.cn/post/7603649945977962515</guid>    <pubDate>2026-02-07T11:29:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945977962515" data-draft-id="7399986979729080354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”"/> <meta itemprop="keywords" content="å…¨æ ˆ,AIç¼–ç¨‹,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-07T11:29:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²ˆäºŒåˆ°ä¸è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1319878954855021"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1319878954855021/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²ˆäºŒåˆ°ä¸è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:29:36.000Z" title="Sat Feb 07 2026 11:29:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä¸»é¢˜</h2>
<p>â€‚â€‚â€‚â€‚è¿™æ˜¯ä¸€æ®µä»22å¹´-26ä¹‹é—´çš„é•¿å‘¨æœŸå¤§é¾„è½¯ä»¶å¿ƒå¢ƒé•¿å‘¨æœŸå†…è€—ç‰‡æ®µ,æœŸé—´çš„è¿‡ç¨‹å‡æ˜¯å½“æ—¶çš„æŒ£æ‰,æ­¤æ—¶ä¸€åˆ‡å‡å·²å¹³æ¯,æ­¤æ—¶å†åšå›æº¯ï¼Œ<code>ä»¥æœŸåç»­è¸å®çš„åšå¥½é€€ä¸€æ­¥çš„æµ·é˜”å¤©ç©ºä¸è¿›ä¸€æ­¥çš„å¤©é«˜ä»»é¸Ÿé£æŠ‰æ‹©ã€‚</code></p>
<p>â€‚â€‚â€‚â€‚è¿™æ®µå†…å®¹ä¸€ç›´ä¸¢åœ¨è‰ç¨¿é‡Œ,è¿™æ®µä¹Ÿä¸€ç›´æ²¡æœ‰æ²¡æ›´æ–°ï¼Œæœ€åä¸€æ®µæ›´æ–°å®šæ ¼åœ¨<code>25-03-20</code>,åœ¨<code>03-01</code>~<code>04-20</code>å³æˆ‘ä½“éªŒè£¸è¾å¤§æ»¡è´¯çš„æ—¥å­,è¿™æ—¢æœ‰äº‹å‰çš„æŒ£æ‰,ä¹Ÿæœ‰è½¬è¿‡èº«æ¥çœ‹ç°åœ¨çš„å¹³é™,æœŸæœ›ç°é˜¶æ®µæ­£åœ¨ç»å†æŒ£æ‰çš„<code>é“æ±</code>,èƒ½ç¨å¾®æœ‰ç‚¹å„¿å¯å‘å’Œå…±æƒ…å§ã€‚</p>
   <hr/>
<p><strong>è´´ä¸ª24å¹´çš„åƒç°è‰ç¨¿ç®±</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8e933ca736f4ae98568796bda6ae424~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKI5LqM5Yiw5LiN6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068576&amp;x-signature=9sbO8yhziEtoKTlXtj2JQmQm6DU%3D" alt="b8158f79-867a-4990-911d-c626d4c4c8f0.png" loading="lazy"/></p>
<h2 data-id="heading-1">24 æŒ£æ‰åŠ å‰§</h2>
<p>â€‚â€‚â€‚â€‚ç©¿æ¢­ä¹‹é—´~ï¼Œè·ä¸Šæ¬¡æ›´æ–°å·²ç»4æœˆæœ‰ä½™ï¼Œæœ¬æƒ³ç€å¼€å¼€å¿ƒå¿ƒçš„æŒ£ç€å¤–å¿«,ç»™é™è–ªå›å›è¡€ã€æ²‰ä¸‹æ¥ä¸“æ³¨åšäº‹æƒ…,å¥ˆä½•è¦†å·¢ä¹‹ä¸‹ç„‰æœ‰å®Œåµï¼Œä¸å¾—ä¸åˆèº«ä¸´å…¶å¢ƒçš„é¢ä¸´ä¸Šæ¬¡å·²ç»ç»ˆç»“æ”¾å¼ƒçš„è¯é¢˜,å°±å†åˆ†äº«åˆ†äº«è¿‘æœŸçš„æ€è€ƒå§ï¼Œå› ä¸ºè·¨åº¦æ¥è¿‘äº†5ä¸ªæœˆ,ä¸­é—´ä¸åŒæ—¶é—´æ®µæœ‰äº›é›¶æ˜Ÿçš„è®°å½•ï¼Œå§‘ä¸”å„ä½è¿›æ¥äº†å°±çœ‹ä¸Šä¸€çœ‹ã€‚</p>
<h2 data-id="heading-2">24-7æœˆè·Ÿè¸ªæƒ…å†µ</h2>
   <hr/>
<p><strong>è´´ä¸ª22å¹´çš„åƒç°æ–‡</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cd5340315314fc8a4149d640e892bb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKI5LqM5Yiw5LiN6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068576&amp;x-signature=soRiCUQR%2BdIQEn2ZaqvtT236HQU%3D" alt="image.png" loading="lazy"/></p>
<p>â€‚â€‚â€‚â€‚å…ˆä¸Šä¸ªå›¾,æ—¶é—´å°±æ˜¯è¿™ä¹ˆä¸ç»æ„ä¹‹é—´ï¼Œè®©æˆ‘åšæŒäº†å¿«æ¥è¿‘3å¹´çš„æŠ€æœ¯ç±»å’Œæ„Ÿæ‚Ÿç±»çš„åˆ†äº«ï¼Œå½“ç„¶è¿™ä¸¤å¹´çš„æ—¶é—´ä»è­¦é†’åˆ°ç¨‹åºå‘˜çš„è¡Œå½“é€æ­¥çš„èµ°å‘æ¶åŒ–ä¹ƒè‡³å†°å°,æœŸé—´æ€è€ƒå’Œæ„Ÿæ‚Ÿè›®å¤šçš„,ä¸­é—´æœ‰ä¸€æ®µæ•´ä¸ªæ˜¯è¢«äº‹æƒ…å¡«æ»¡ï¼ŒæŒç»­çš„æ˜¯åšäº‹çš„å¿ƒæ€ä¸ºä¸»,è¿™æ¬¡æœ‰ç‚¹å„¿èº«ä¸´å…¶å¢ƒï¼Œå°±å½“å‰çŠ¶æ€ç†æ€§çš„è¿›è¡Œä¸€ä¸ªæ¼”åŒ–ï¼Œç®—æ˜¯æœ‰ä¸ªå€Ÿé‰´æ„ä¹‰å§ï¼Œå…ˆè¯´ä¸€ä¸‹,å› ä¸ºè¿‘æœŸæœ‰è¿›è¡Œè¿‡æ–°å‘˜å·¥åŸ¹è®­,å› æ­¤åŒºåˆ†ä¸€ä¸‹äººç¾¤ã€‚</p>
<ul>
<li><strong>é’ˆå¯¹å°†æ¯•ä¸šæˆ–è€…å·¥ä½œä¸€æ®µä¸é•¿çš„å¹´è½»äººï¼Œç¨ä½œè¡¥å……,ç»éªŒåªå¯ä»¥å€Ÿé‰´</strong>ï¼Œæ—§çš„ç»å†å¹¶æ— æ³•ä½œä¸ºå½“å‰å„ä½æ‚²è§‚çš„ç†ç”±ï¼Œçœ‹æœªæ¥è¿œä¸å¦‚çœ‹ç°åœ¨æ¥çš„æ¸…æ¥š,å¹´è½»æ˜¯èµ„æœ¬ï¼Œä½ æœ‰æ— æ•°çš„ç²¾åŠ›å’Œæœºä¼šå¯ä»¥å°è¯•ï¼Œçœ‹å‡†äº†å°±å»å°è¯•,å°è¯•è¿‡ä¸é€‚åˆä½ çš„è·¯ï¼Œæ‰èƒ½æ‰¾åˆ°é€‚åˆä½ çš„è·¯ï¼Œä»¥ä¸‹çš„å†…å®¹ä»…ä»…ç®—ä½œèŒä¸šè·¯å¾„å‘å±•çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œæ— æ³•ä½œä¸ºæŒ‡å¯¼ï¼Œå› ä¸ºèƒ½æŒ‡å¯¼ä½ çš„æ˜¯ä½ çš„æœªæ¥ã€‚</li>
</ul>
<p>â€‚â€‚â€‚â€‚å¹´åˆçš„æ—¶å€™å…¶å®ç»å†çš„ä¸€ç³»åˆ—äº‹æƒ…ï¼Œæ¯”å¦‚è°ƒè–ªã€è°ˆè¯ã€æƒè¡¡,ä¸€åˆ‡è¿œæ²¡æœ‰é‚£ä¹ˆé£å¹³æµªé™,æœ€ç›´æ¥çš„åŸå› åªèƒ½æ˜¯å¹´åˆçš„æ‹›è˜å¸‚åœºå†°å°é”å®š,å†…æ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šæœ‰ä¸€äº›ï¼Œä½†åˆ°ä¸€å®šé˜¶æ®µä¹‹åï¼Œå„è‡ªçš„ç»å†å’Œæ“…é•¿çš„è¾¹ç•Œæ˜¯ä¼šæœ‰ä¸åŒçš„ï¼Œä¸ä¼šæœ‰é‚£ä¹ˆå¥‘åˆçš„å²—ä½ç­‰ç€ï¼Œæ¯•ç«Ÿç»å¤§éƒ¨åˆ†ç¨‹åºäººï¼Œæ˜¯è¦é¢å‘é—®é¢˜å»çš„,å› æ­¤ï¼Œå¹¶ä¸æ˜¯çº¯ç²¹çš„é»‘ç™½é—®é¢˜ï¼Œæ˜¯é»‘ç™½ç°çš„å¤¹æ‚é—®é¢˜ã€‚</p>
<p>â€‚â€‚â€‚â€‚ç´§æ¥ç€åˆæ˜¯å¤§æ‰¹é‡è¢«ç–«æƒ…å½±å“çš„è½¬æˆ˜è€ƒç ”è·¯ç»§ç»­å¾€ä¸Šçš„å»¶ç»­,æ¯•ä¸šç”Ÿçš„å†²å‡»ã€å­¦å†å†²å‡»ï¼Œå¯¼è‡´äº†å¾ˆå¤§ç¨‹åº¦çš„å½¢æˆäº†ä¹°æ–¹å¸‚åœºï¼Œåœ¨ç»æµä¸å¥½çš„å¤§ç¯å¢ƒä¸‹,å½¢æˆäº†å´©ç›˜çš„å±€é¢,å› æ­¤æ™®éçš„é™è–ªå’Œç¢¾å‹ä¹Ÿæ˜¯æ„æ–™ä¹‹ä¸­çš„äº‹æƒ…,æ®æˆ‘å°±å‘¨å›´çš„åœˆå­äº†è§£,åŸºæœ¬ä¸Š10ä¸ªäººå½“ä¸­,æœ‰è¿‘ä¹ä¸€åŠçš„äººå—åˆ°äº†å½±å“ï¼Œå½“ç„¶è¿™å…¶ä¸­å¾ˆè£å¹¸çš„åŒ…å«äº†æˆ‘åœ¨å†…ã€‚</p>
<h2 data-id="heading-3">è¿‘é˜¶æ®µå¸‚åœº</h2>
<p>â€‚â€‚â€‚â€‚å°±ä»…ä»¥ç›®å‰æˆéƒ½çš„æƒ…å†µæ¥è¯´,æœºä¼šé›¶æ˜Ÿåœ¨å†’å¤´,å¾…é‡æœ‰æƒ…å†µæœ‰ä¸‹é™ï¼Œä½†æ¯”1-5æœˆä»½æœ‰å›å‡ã€è¦æ±‚æ™®éåœ¨å‡é«˜,å³åˆ†ç«¯çš„è¾¹ç•Œæ„Ÿåœ¨æ¶ˆå¤±ï¼Œå¯èƒ½æ˜¯åŸºäºé™æœ¬ä»¥åŠä¹‹å‰åˆ†ç«¯çš„å¼Šç«¯ç­‰é—®é¢˜æ¼”åŒ–è€Œæ¥çš„ç»“æœ,å› ä¸ºç›®å‰é€‰æ‹©å—â€œé€šå‹¤è·ç¦»â€ã€â€œç¨³å®šæ€§â€ç­‰å› ç´ å½±å“ï¼Œè€Œå—ç›Šäºä¹‹å‰çš„â€œä¸‡é‡‘æ²¹â€æ€è·¯ï¼Œå²—ä½å¯é€‰æ‹©çš„èŒƒç•´æ¯”è¾ƒå¹¿ï¼Œä½†ä¹Ÿé˜¶æ®µæ€§çš„å•å¤©æœ€å¤§5ä¸ªè”ç³»è€Œå·²ï¼Œåˆé€‚æ¯”ç‡ç•¥ä½ï¼Œè€Œä¸”åˆ°å‘é¢è¯•é‚€è¯·ç¯èŠ‚å¾ˆå°‘ã€‚</p>
<h2 data-id="heading-4">ä¸€é¡¿åˆ†æ</h2>
<p>â€‚â€‚â€‚â€‚æ‰¾å·¥ä½œæœ‰æ—¶å€™æ˜¯ä¸ªç„å­¦é—®é¢˜,å¹¶éæ˜¯ä¸€åˆ†è€•è€˜ä¸€ä»½æ”¶è·,å‡†å¤‡åº”è¯¥æœ‰,å¤šç”¨å½“å‰çš„æœ€å¥½å»å°è¯•ï¼Œéš”å²¸è§‚ç«ï¼Œå¾ˆéš¾ä½œä¸ºè‡ªèº«çš„ä»·å€¼å‚è€ƒï¼Œå¦‚æœè¯´åˆé€€ç¼©å›ºå®ˆï¼Œæˆ–è€…æ”¾å¼ƒè‡ªæˆ‘æ¶ˆè€—ï¼Œå¤šå¤šå°‘å°‘æ˜¯æ¸©æ°´ç…®é’è›™çš„å¿ƒæ€ï¼Œç°åœ¨çš„æˆ‘åŸºæœ¬ä¸Šé™·å…¥äº†æ­¤é¡¹è¿·èŒ«ï¼Œè€Œä¸”æ˜¯æ— è§£çš„ï¼Œå› ä¸ºæœ€ç›´æ¥çš„åŠæ³•æ˜¯ä½ æ‰¾åˆ°æ–°çš„åˆé€‚å²—ä½ï¼Œç›´æ¥è„±ç¦»å³å¯ï¼Œä¸éœ€è¦é‚£ä¹ˆå¤šæ€è€ƒå’Œè€ƒé‡,ä½†ç°åœ¨è¿™ä¸ªè¿‡ç¨‹è¢«æ‹‰é•¿äº†å‘¨æœŸå’Œéš¾åº¦ï¼Œå› æ­¤ç…ç†¬çš„åŸå› ä¸æ˜¯å› ä¸ºæ— æ³•å†³æ–­ï¼Œè€Œæ˜¯æ— æ³•æŒæ§ã€‚</p>
<p>â€‚â€‚â€‚â€‚å…³äºå…¶ä»–é€”å¾„ï¼Œç§¯æçš„è”ç³»å‘¨è¾¹ï¼Œè¡¨è¾¾ç°çŠ¶å’Œç§¯ææŒ£æ‰çš„æ€åŠ¿ï¼Œä½†ä¸€èˆ¬ä½œç”¨ä¸ç”šå¤§ï¼Œæ­¤é¡¹æœ¬æ˜¯ä½œä¸ºé¢„å¤‡å½¹è¿›è¡Œå‡†å¤‡çš„ï¼Œé˜²æ­¢çªå‘çŠ¶å†µï¼Œè¿™é‡Œçš„çªå‘çŠ¶å†µæ˜¯æŒ‡åœ¨ç³Ÿç³•è„†å¼±çš„å¿ƒç†é˜²çº¿ä¸‹ï¼Œä¸å‡é‡çš„å·¥ä½œå’Œå‹åŠ›å¸¦æ¥çš„å†²å‡»ï¼Œä¼šå¯¼è‡´é—®é¢˜ã€‚</p>
<p>â€‚â€‚â€‚â€‚å…³äºè‡ªæˆ‘å†…è€—åŠè§¦å‘æ—¶æœºçš„è€ƒé‡ï¼Œæœ¬èº«è€ƒé‡ä¸»è¦åŸºäº3æ–¹é¢</p>
<ul>
<li>å¤§ç¯å¢ƒé—®é¢˜,ç»å†è¿‡å¹´åˆçš„é˜¶æ®µï¼Œå…¶å®å¯¹å¹´åº•çš„é˜¶æ®µä¸æ€ä¹ˆæŠ±æœ‰å¹»æƒ³ï¼Œä¸å…¶ç­‰ç€äº‹æ€è¿›ä¸€æ­¥æ¶åŒ–ï¼Œä¸å¦‚æ—©ç‚¹å‘ç”Ÿï¼Œå€’é€¼é¢å¯¹ã€‚</li>
<li>å¹´é¾„çš„é—®é¢˜ï¼Œ è¿™ä¸ªæ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œè¯´ç‚¹å„¿å…·ä½“çš„åº”å¯¹ï¼Œä¸€ä¸ªæ˜¯è¿™ä¸ªå¹´é¾„é˜¶æ®µçš„è¯‰æ±‚å·²ç»ä¸ä¼šåªè€ƒå¯Ÿè¯­è¨€éƒ¨åˆ†ï¼Œè€Œæ˜¯å¯¹ç»¼åˆèƒ½åŠ›æœ‰è¦æ±‚ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯é•¿ä¿æŒå­¦ä¹ çš„å¿ƒæ€ï¼Œè°¦é€Šä¸€äº›ï¼Œæ€»å½’æ˜¯åœ¨ä¸åŒçš„äº‹æƒ…ä¸Šæœ‰è¿›æ­¥ã€‚</li>
<li>å¾…é‡ä¸ç”Ÿæ´»ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œå¦‚æœå¤§ç¯å¢ƒå·²ç»ä¸èƒ½å¤Ÿæä¾›å……è¶³çš„å¾…é‡æ”¯æŒï¼Œè½¬è€Œå¯¹ç¨³å®šæ€§å’Œèˆ’é€‚åº¦è¿›è¡Œç»¼åˆè€ƒé‡ï¼Œå³è€ƒè™‘æœ‰å®ä½“çš„ä¼ ç»Ÿè¡Œä¸šï¼Œæˆ–è€…æœ‰ç›¸å…³ç§¯ç´¯çš„è¡Œä¸š,å†è¾…åŠ©ä¸€äº›å‰¯ä¸šæ”¯æŒï¼Œä¹Ÿæ˜¯æ¡ä¸é”™çš„é€‰é¡¹ã€‚</li>
</ul>
<p>â€‚â€‚â€‚â€‚å¾ˆå¯èƒ½ä¼šé¢ä¸´ç¬¬å››ç§ç»“å±€ï¼Œå°±æ˜¯çŸ­æ—¶é—´å†…æ— ä»¥ä¸ºç»§ï¼Œè¿™å°±è¦è€ƒè™‘åˆ°ä¸€ä¸ªæ˜¯èµ„é‡‘å‚¨å¤‡ï¼Œä¸€ä¸ªå°±æ˜¯æå‰çš„å¿ƒç†å’Œè§£ï¼ˆå½“å‰çš„ä¸»è¦å› ç´ æ˜¯å¤§ç¯å¢ƒã€ä¸ªä½“çš„è®¡åˆ’å—å¹²æ‰°å¤ªå¤§ï¼‰ï¼Œæœªæˆ˜å…ˆè™‘è´¥ï¼Œè¿™å°±åˆæ¶‰åŠåˆ°ä¸€ä¸ªè‡ªæˆ‘å†…è€—çš„é—®é¢˜ä¸Šäº†ï¼Œæ—¢ç„¶è€ƒè™‘å’Œä¸è€ƒè™‘ï¼Œå·®åˆ«ä¸æ˜¯å¤ªå¤§ï¼Œä¸ºä»€ä¹ˆè¿˜è¦è‡ªæˆ‘æ¶ˆè€—ï¼Œæˆ‘çš„è€ƒè™‘æ˜¯ä¸è½¬å‘çš„é—®é¢˜ï¼Œè£¹èƒä¹‹ä¸‹å†³å®šå¾€å¾€ä¼´éšç€é—æ†¾ï¼Œå°½é‡å‡å°‘é—æ†¾ã€‚</p>
<h2 data-id="heading-5">ç¿»æ¶Œçš„å¿ƒæ€</h2>
<p>â€‚â€‚â€‚â€‚äº‹å®è¯æ˜ï¼Œæ—¶åˆ»å‡†å¤‡ç€ä¸ä¸€å®šèƒ½è§£å†³æœªæ¥çš„é—®é¢˜ï¼Œä½†è‡³å°‘è®©ç°åœ¨çš„æˆ‘å¦ç„¶é¢å¯¹è¿‡å»çš„è‡ªèº«ï¼Œå·²ç„¶å°½åŠ›ã€åªå‰©ä¸‹å¾€å‰çœ‹äº†.</p>
<h2 data-id="heading-6">24-08-06çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚è¿™æ®µè¯ä½œä¸ºåˆ†å‰²ï¼Œè¿™ä¹‹å‰æ˜¯08-06ä¹‹å‰çš„å†…å®¹,è¿™ä¸­é—´å‡ºç°äº†ä¸€äº›åè½¬,å¿ƒå¢ƒä¸Šæœ‰èµ·ä¼ï¼Œä¸»è¦å¯èƒ½æ˜¯ä½ä¼°äº†ç”Ÿæ´»æˆæœ¬çš„å‹åŠ›ï¼Œå†åŠ ä¸ŠåŸºé‡‘å’Œè‚¡ç¥¨çš„èƒŒåˆºï¼Œä½†ä¿¡å¿ƒæ—¶å¥½æ—¶åçš„åœ¨ç¿»æ¶Œï¼Œä¸€æ–¹é¢æ„Ÿè§‰ç°åœ¨çš„é¢è¯•ä¸»è¦é›†ä¸­åœ¨å½¢å¼ä¸Šï¼Œä½†åˆä¸å¾—ä¸é€‚åº”è¿™ç§å½¢å¼ï¼Œç»å¤§å¤šæ•°æ—¶å€™ï¼Œè¦ä¸å°±æ˜¯ä¸åŒ¹é…çš„ä¸šåŠ¡å¾ˆéš¾åœ¨çŸ­æ—¶é—´å†…æ”¹å˜ä¸€ä¸ªäººçš„æ„è¯†å½¢æ€å’Œè®¤çŸ¥ï¼Œè¦ä¸å°±æ˜¯ä¸ªäººåŒ–çš„åé‡å¤ªæ˜æ˜¾ï¼Œä½†åªèƒ½å’±å°±ç€ç¯å¢ƒï¼Œæ²¡é“ç†è¦æ±‚ç¯å¢ƒé¡ºä»è‡ªå·±,æ‰€ä»¥æŠ±æ€¨å½’æŠ±æ€¨ã€‚</p>
<h2 data-id="heading-7">24-08-15çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚æ­¤æ®µçš„å†…å®¹åè½¬,ä¸»è¦æ˜¯ç¬ƒå®šçš„å†é™äº‹ä»¶å¹¶æœªå‘ç”Ÿ,ä¾¥å¹¸å¿ƒç†åœ¨ä½œç¥Ÿ,ä½†å‰æœŸçš„å¿ƒç†å…³å·²ç»å……åˆ†çš„å‘æŒ¥äº†ä½œç”¨,<strong>ä½é¢„æœŸã€ç§¯æåšå¥½å½“ä¸‹ã€å¹³å’Œè§‚æœ›æœªæ¥</strong>ï¼Œä¼¼ä¹è¾¾æˆäº†æŸç§å¹³è¡¡å’Œè§£, ä¸€æ–¹é¢æ˜¯å¯¹äº’è”ç½‘é¡ºé£è½¦10å¹´çš„åº†å¹¸ï¼ŒåŒæ—¶åˆæœ‰æ‰€ç–‘è™‘ï¼Œç–‘è™‘å’Œå®¡è§†çš„æ˜¯è‡ªèº«ä¹‹å‰çš„å†³å®šæ˜¯å¦è¸é”™ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç–‘è™‘çš„å‘ç”Ÿæœ¬èº«å·²ç»èƒ½è¯´æ˜é—®é¢˜,è¿™å°±åˆå›åˆ°äº†è‡ªæˆ‘å†…è€—ä¸Šäº†,è‡³å°‘ç°åœ¨æ¥çœ‹ï¼Œæ¯ä¸€æ­¥éƒ½åšåˆ°äº†æ…é‡å¤„ç½®ã€å› æ­¤æˆ‘å¯¹è‡ªèº«æ— å¯æŒ‡æ‘˜,å¯¹ç¯å¢ƒçš„å˜åŒ–ä¹Ÿåªæœ‰é€‚åº”å˜åŒ–ï¼Œä¸¤ä¸æ€ªç½ªï¼Œä¹Ÿå‡ä¸å¤±æœ›ï¼Œå¯èƒ½æœ‰ç§å¿ƒæ€èººå¹³ï¼Œå´ä¸å¤±æ–—å¿—çš„æ„æ€åœ¨é‡Œé¢ã€‚</p>
<h2 data-id="heading-8">24-09-07çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚è¿™ä¸­é—´ï¼Œç®—æ˜¯é‡æ–°å®¡è§†äº†ç”Ÿæ´»å’Œå·¥ä½œçš„å¹³è¡¡ï¼Œå¦‚æœä¸€ä»½å·¥ä½œå·²ç»è®©â€œå·¥ä½œâ€å……æ–¥äº†ä½ çš„ç”Ÿæ´»ï¼Œé‚£â€œå·¥ä½œâ€çš„æ„ä¹‰åœ¨å“ªé‡Œï¼Œâ€œå·¥ä½œâ€çš„ç›®çš„ä¸æ˜¯ä¸ºäº†æ›´å¥½çš„ç”Ÿæ´»å—?å€’ä¸å¦‚æ‹†è§£å¥½æ¯”ä¾‹ã€‚</p>
<h2 data-id="heading-9">24-12-04 ç–‘ä¼¼ç»ˆå±€</h2>
<p>â€‚â€‚â€‚â€‚é‚ªé£ç»ˆç©¶å¹äº†å‡ºæ¥,è®©è¡¨æ€,è®©å‡ºå·®å»èƒŒä¹¦,è¢«æ— å˜å¤´çš„è¯·å‡ç»ˆç»“,åç»­çš„æ²¡æ€èµ·å•¥é£æµªï¼Œä½†æ‰€æœ‰ç ”å‘å½“äº‹äººçš„è¡¨æ€å‡ºæ¥äº†,<code>å¹´åéƒ½è¦æ’¤</code>ï¼ŒæœŸé—´çš„å°æ’æ›²å¤šå¦‚ç‰›æ¯›ï¼Œè¿˜è¦é¡¶ç€å‹åŠ›å’Œå¿ƒæ€å¼€å‘,ç„¶ååˆæ˜¯é¢†å¯¼å±‚åŠ¨è¡,ä¸€é¡¿æ…·æ…¨æ¿€æ˜‚å’Œå®‰æŠš,ç»ˆäºæ˜¯å¹³ç¨³çš„åˆ°äº†å¹´å…³ï¼Œè§‰å¾—æ¥å¹´å¯ä»¥è½¬ä¸ªå²—å¤§å¹²ä¸€åœºã€‚ </p><hr/><p/>
<h2 data-id="heading-10">25-03-01 å¹´å‰æ€æƒ³å‡†å¤‡ç”¨è„šåšå‡ºäº†æŠ•ç¥¨</h2>
<p>â€‚â€‚â€‚â€‚å£é£åˆå‘ç”Ÿäº†å˜åŒ–,åŠ ä¹‹å‡å‘˜çƒ‚æ‘Šå­ä¸€å †ï¼Œè¿™æœŸé—´<code>deepseek</code>çš„æ¨ªç©ºå‡ºä¸–ï¼Œè®©ä¹‹å‰ä¸€ç›´ä¿æŒè§‚æœ›æ€åº¦çš„å…¬å¸å’Œäººè ¢è ¢æ¬²åŠ¨ï¼Œä½†æœ€å…ˆåŠ¨çš„è¿˜æ˜¯å˜´å·´,ä¸€ç•ªåˆ†æå,<code>AIå‡ºæ¥åï¼Œä½ ä»¬ç¨‹åºå‘˜è‚¯å®šè‚¯å®šæœ€å…ˆè¢«æ·˜æ±°ï¼Œåƒä½ ä»¬è¿™ç§å¹´é¾„å¤§äº†ï¼Œå·åˆå·ä¸åŠ¨,ç»éªŒä¼˜åŠ¿åˆè¢«å¼±åŒ–,å­¦ä¹Ÿå­¦ä¸è¿‡ï¼Œä½ ä»¬éšä¾¿åœ¨å¤–å¤´è¯•è¯•ä½ ä»¬çš„æ–¤ä¸¤ï¼Œçœ‹çœ‹æœ‰äººç†ä½ æ²¡</code>,åœ¨æ— æ„ä¹‰çš„æ­»æ‰›å’Œæ­»çš®èµ–è„¸çš„è‹Ÿä¸”ä¹‹é—´,ç»å†äº†ä¸€é¡¿æœ€æ¶åŒ–åœºæ™¯:<strong>èŒä¸šã€èµ„é‡‘åŒäº†å´</strong>çš„æŒ£æ‰åï¼Œæˆ‘å³åœ¨æ­¤ç§ç°çŠ¶åœºæ™¯ä¸‹åšå‡ºäº†<code>è£¸è¾</code>çš„å†³å®š,å½“æ—¶å®‰æ…°è‡ªå·±è¯´æ˜¯ä¸»åŠ¨æ±‚å˜åŒ–ï¼Œç°åœ¨çœ‹æ¥ï¼Œä¸è¿‡æ˜¯<strong>å±è¯å£®èƒ†è€Œå·²</strong>,ä½†é˜´å·®é˜³é”™çš„ï¼Œç»“æœç®—æ˜¯å¥½çš„ã€‚</p>
<p>â€‚â€‚â€‚â€‚æ­¤æ—¶çš„å¿ƒæ€ä¸»è¦æ˜¯ä¸¤ä¸ªï¼š</p>
<ol>
<li>
<p>æœç»æ¥é›¶æ´»ï¼Œæ¥æ¥å›å›éƒ½æ˜¯è¾›è‹¦é’±ï¼Œå¾—æœ‰â€œæˆé•¿æ€§çš„èµ„äº§â€,å³é•¿æœŸçš„ç²¾åŠ›æŠ•å…¥èƒ½å¸¦æ¥è´¨å˜çš„â€œè½¯ä»¶â€,åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæœ‰å‡ ä¸ªæ–¹å‘ï¼Œåç»­é™†é™†ç»­ç»­ä¹Ÿè¢«å¦äº†ã€‚</p>
</li>
<li>
<p><code>ç¦»å®¶è¿‘æ±‚è‹Ÿç¨³</code>ã€<code>å†²AIæ±‚æ–°</code>ï¼Œä¸¤ä¸ªæç«¯ä¹Ÿåšå¥½äº†è·¨çœçš„é¢„æœŸã€‚</p>
</li>
</ol>
<p>â€‚â€‚â€‚â€‚ç»“æœåŠäº†æ‰‹ç»­çš„å‘¨æœ«å°±è°ˆå¦¥äº†2å®¶,ä¸€å®¶â€œå·¥ä¸šäº’è”ç½‘â€ç®—æ˜¯ä¸šåŠ¡ç»§æ‰¿ï¼Œæ®HRè¯´æˆ‘æ˜¯å…¥å›´çš„100å¤šå·å€™é€‰è€…é‡Œé€‰å®šçš„,å¦å¤–ä¸€å®¶<code>ERP</code>è¡ç”Ÿï¼Œå’Œè€æ¿èŠäº†ä¸€ä¸‹åˆè¡¨è¾¾äº†æ„å‘,æˆ‘è¿™ä¸€æƒ³ï¼Œå¼€é—¨çº¢å‘€è¿™æ˜¯,è¯´æ˜å¸‚åœºè¿˜å¥½å‘€,æ¯•ç«Ÿæˆ‘è¿˜æ²¡ä½“éªŒå¥½<code>è£¸è¾</code>çš„å¿ƒå¢ƒå˜åŒ–,åœ¨æ­¤ç§åœºæ™¯ä¸‹ï¼Œæ‹’äº†ä¸¤å®¶çš„<code>offer</code>,å…¶ä»–è¿˜è¡Œï¼Œé€šå‹¤è·ç¦»ä¸åˆé€‚,è§‰å¾—å¯ä»¥å†²å†²<code>AI</code>ã€‚</p>
<p>â€‚â€‚â€‚â€‚æœŸé—´å°±å¼€å§‹äº†å‡è£…ä¸Šç­çš„å†ç¨‹,å®½æ¾çš„åœºæ™¯ä¸‹,èŠ‚å¥ç»´æŒçš„è¿˜ç®—å¥½,ä¸åœçš„åˆ·ç®€å†ï¼Œåšå‡†å¤‡,ä»¥åŠå’Œå¦å¤–ä¸€ä¸ªå‰å‰åŒäº‹,äº’ç›¸äº¤æµåæ§½é¢è¯•,æœŸé—´ä¸“é—¨ç ”ç©¶äº†<code>BOSS</code>çš„æœºåˆ¶,å¿ä½äº†<code>å……é’±</code>çš„è¯±æƒ‘ï¼Œç»´æŒäº†ä¸€å‘¨é•¿æœŸæœ‰é¢è¯•çš„æƒ…å†µï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‘¨æ²¡æœ‰é¢è¯•é‚€è¯·ï¼Œå¿ƒæ€ä¸Šæœ‰äº›æ…Œ,æˆ‘åŸºæœ¬ç»´æŒäº†ä¸€å‘¨èƒ½æœ‰1-2ä¸ªofferçš„æƒ…å†µ,ä½†æ˜¯é¢è¯•å’Œæ‰“æ‹›å‘¼çš„å°‘ï¼Œä½†æˆ‘çš„å‰å‰åŒäº‹å’Œæˆ‘çš„åœºæ™¯ç›¸åï¼Œæ‰“æ‹›å‘¼é¢è¯•å¤šï¼Œä½†<code>offer</code>åå¤´éƒ½æ²¡äº†ä¸‹æ–‡,æœŸé—´åˆæ‹’äº†6~7ä¸ªä¸å’‹çœ‹å¥½çš„,å‰©ä¸‹æœ€å<code>AI</code>é‚£ä¼šå„¿å†…æ¨çš„ä¸€å®¶æ²¡äº†ä¸‹æ–‡ï¼ŒåŠ ä¹‹ç„¦è™‘å’Œæ‡ˆæ€ æƒ…ç»ªæœ‰ç‚¹å„¿è”“å»¶ï¼Œæœ€ç»ˆè¿›äº†å†³èµ›é€‰2é€‰1,ä½†ç¦»å®¶è¿‘ç¨³å®šçš„ä¼ ç»Ÿè¡Œä¸š2è½®ä¸‹æ¥ï¼Œè¿Ÿè¿Ÿæ²¡å›å¤ï¼Œå°±å…ˆå»äº†å¦å¤–ä¸€å®¶ï¼Œä¸Šäº†3å¤©å¦å¤–ä¸€å®¶ç»™äº†é€šçŸ¥,ä¸€ç•ªè¾åˆ«åï¼Œåˆ°äº†ç›®å‰è¿™å®¶ï¼Œåç»­äº‹æ€æ¯”è¾ƒç†æƒ³ï¼Œå‡åœ¨å¯æ§èŒƒå›´å†…ï¼Œä¸åšå±•å¼€ã€‚ </p><hr/><p/>
<h2 data-id="heading-11">25-05 åç»­</h2>
<p>â€‚â€‚â€‚â€‚AIçš„æµªæ½®åŠ¿ä¸å¯æŒ¡,é™†é™†ç»­ç»­çš„çœ‹åˆ°å¬åˆ°ä¸é è¿‘<code>AI</code>å°±è¦è¢«æ—¶ä»£æ·˜æ±°çš„æ„Ÿè§‰,å¥½å§ï¼Œå½“æ—¶çš„åœºæ™¯ä¸‹ï¼Œååº”åˆè¿Ÿé’äº†ï¼Œé”™è¿‡äº†ä¹°è‚¡ç¥¨ï¼Œäº¦å¦‚18å¹´é”™è¿‡çŸ­è§†é¢‘ä¸€æ ·ã€‚<code>å¾€å›çœ‹ï¼Œå°½æ˜¯æ‹æ–­å¤§è…¿,ä½†æ­¤åœºæ™¯ä¸‹çš„ç»å†çš„ä¸ªäººå†³ç­–æ‰æ˜¯æœ€å¥½çš„</code>ï¼Œè¿™ä¾¿æ˜¯æœ€å¥½çš„å½“ä¸‹,ä¹Ÿåº†å¹¸æå‰æ’•è£‚äº†ä¸ªäººç„¦è™‘,å°†è®¾æƒ³å˜æˆäº†åœºæ™¯,åœ¨åœºæ™¯ä¸‹è°ƒåº¦äº†å†³ç­–ã€‚æ­¤æ—¶ï¼Œå†æ¥è§‚æœ›ï¼Œ<code>è¿™åœºAIå¯¹ç¨‹åºå‘˜å†²å‡»çš„å¤§æˆ</code>ä¹Ÿå¼€å§‹åœ¨ä¼ æ’­ï¼Œå…¶ä¸­å¤¹æ‚ç€<code>åŠåŠå­</code>ã€<code>å¤–è¡Œ</code>çš„é€ åŠ¿ï¼Œå‘ˆç°å‡ºæ¥çš„å†°ç«ä¸¤é‡å¤©,ä¸çŸ¥é“æ¥å¹´ä¼šä¸ä¼šåˆæ˜¯ä¸€åœ°é¸¡æ¯›,<code>AIç¼–ç¨‹</code>å’Œæˆ‘çš„å·¥ä½œç»“åˆæ‰¾å¹³è¡¡æˆ‘ä¹Ÿå·®ä¸å¤šä½“éªŒå¿«ä¸¤å¹´å¤šäº†,ä¸€æ­¥æ­¥çœ‹ç€ä»<code>ç—´å‘†</code>å˜çš„æ…¢æ…¢è¶Šæ¥è¶Š<code>èªæ˜</code>ï¼Œä¸€æ–¹é¢è¦ç§‰æŒå¼€æ”¾çš„å¿ƒæ€å»é€‚åº”ï¼Œä¸€æ–¹é¢è¦é€šè¿‡é€‚åº”æ‰¾åˆ°è‡ªæˆ‘çš„è¾¹ç•Œï¼Œæ‹¥æŠ±ææƒ§ï¼Œæ‰èƒ½ç»½æ”¾æ–°ç”Ÿã€‚</p>
<h2 data-id="heading-12"><code>å¥åº·</code>ã€<code>æ·˜æ±°</code></h2>
<p>â€‚â€‚â€‚â€‚32ç¨‹åºå‘˜çŒæ­»ï¼ŒåˆæŠŠè¿™ä¸ªèŒä¸šçš„ç”Ÿå­˜ç¯å¢ƒå’Œç—›æ”¾å¤§äº†ï¼Œå‰å‡ å¹´æ˜¯<code>35</code>ã€<code>32</code>åœ¨è¿™ä¹‹åå‘¢?ç”Ÿæ´»æ¯•ç«Ÿæ˜¯è‡ªå·±çš„,<code>ä»£ç æ”¹å˜ä¸–ç•Œ</code>çš„ç†æƒ³ï¼Œéœ€è¦æ”¾ä¸€æ”¾ï¼Œè‡³å°‘æ˜¯è®©å®ƒå˜æˆè‡ªå·±çš„ï¼Œè€Œä¸æ˜¯åˆ«äººçš„,è‡³äºç”Ÿå­˜çš„å‹åŠ›,æ€»èƒ½åœ¨åœºæ™¯ä¸‹æ‰¾åˆ°é€‚å½“çš„è½ç‚¹ï¼ŒæœŸæœ›åœ¨åœºæ™¯ä¸‹çš„å„ä½,å°‘äº›å†…è€—ï¼Œå¤šäº›å¦ç„¶å’Œæ…·æ…¨ï¼Œäººç”Ÿä¸è¿‡3wå¤©,ä½“éªŒå¾ˆé‡è¦ã€‚ </p><hr/><p/>
<h2 data-id="heading-13">æœ€å</h2>
<p>â€‚â€‚â€‚â€‚æ–°ä¸€å¹´åˆæœ‰æ–°è¯„ä»·<code>æ–°åœŸæœ¨</code>ã€<code>æ–°å†œæ°‘å·¥</code>,å¯èƒ½å˜åŒ–çš„è¡Œä¸š,æ–°é™ˆä»£è°¢ä¸€ç›´éƒ½è¿™ä¹ˆå¿«å’Œé¢‘ç¹ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢ï¼Œèµ°å¥½å½“ä¸‹ï¼Œè¿‡å¥½è‡ªèº«ï¼ï¼</p>
<p><strong>å¦‚æœ<code>ç¼–ç¨‹</code>æ˜¯å…´è¶£ã€çˆ±å¥½ï¼Œä¸å¦¨å°‘ç‚¹å„¿æ¿€çƒˆï¼Œå¤šäº›é•¿æƒ…ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ]]></title>    <link>https://juejin.cn/post/7603653885602299954</link>    <guid>https://juejin.cn/post/7603653885602299954</guid>    <pubDate>2026-02-07T11:29:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885602299954" data-draft-id="7603627478020538378" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ"/> <meta itemprop="keywords" content="ChatGLM (æ™ºè°±)"/> <meta itemprop="datePublished" content="2026-02-07T11:29:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:29:42.000Z" title="Sat Feb 07 2026 11:29:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘å’Œ AI äº¤æµçš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ç‚¹åŒå€¦çš„æ‰“å­—çš„ä½æ•ˆå’Œæ…¢é€Ÿï¼Œå°è¯•ä½¿ç”¨å„ç§ AI è¯­éŸ³è¾“å…¥ï¼Œæœ€ç»ˆæ¢ç´¢å‡ºä¸€å¥—ç›®å‰æœ€å®Œç¾çš„æ–¹æ¡ˆï¼Œé—ªç”µè¯´ + è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0 + GLM 4.7 Flash æ¶¦è‰²ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè¿™å¥—æ–¹æ¡ˆæ˜¯å…è´¹çš„ï¼Œå¹¶ä¸”æ•ˆæœè¿˜ä¸é”™ã€‚</p>
<p>å¯ä»¥å®ç°çš„æ•ˆæœå°±æ˜¯ä½ åªç®¡è¯´ï¼Œéšä¾¿è¯´æƒ³åˆ°å“ªè¯´åˆ°å“ªï¼Œè±†åŒ…è´Ÿè´£å¸®ä½ è¯†åˆ«æˆæ–‡å­—ï¼ŒGLM è´Ÿè´£å¸®ä½ æ•´ç†æˆç»“æ„åŒ–æœ‰é€»è¾‘æœ‰æ¡ç†çš„æ•°æ®ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸€ä¸ªä¸ªç»†è¯´æ€ä¹ˆé…ç½®ã€‚</p>
<h2 data-id="heading-0">é—ªç”µè¯´</h2>
<p>é¦–å…ˆæ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fshandianshuo.cn%2F" target="_blank" title="https://shandianshuo.cn/" ref="nofollow noopener noreferrer">é—ªç”µè¯´ï¼ŒAIè¯­éŸ³è¾“å…¥æ³•</a>ï¼Œç”¨è¿™ä¸ªçš„æ ¸å¿ƒåŸå› æ˜¯ä¸­å›½å¼€å‘çš„ï¼Œä½“éªŒæ¯”è¾ƒå¥½ï¼Œæœ¬åœ°æ¨¡å‹ 800M å·¦å³ï¼ŒRAM å ç”¨ä¸å¤§ï¼Œè¯†åˆ«æ•ˆæœè¿˜å¯ä»¥ï¼Œè‡ªå¸¦æ ‡ç‚¹ç¬¦å·ï¼Œè¿˜å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ‡æ¢çº¿ä¸Šå¤§æ¨¡å‹ã€‚</p>
<p>ä¹Ÿå’Œ CpsWhisperã€window è‡ªå¸¦çš„ Win+H è¯­éŸ³è¾“å…¥æ³•ï¼ŒMac çš„ superWhisper åšå¯¹æ¯”ï¼Œä»–ä»¬åˆ†åˆ«æœ‰ä»¥ä¸‹é—®é¢˜ã€‚</p>
<p>Win + H è‡ªå¸¦çš„ bug å¾ˆå¤šï¼Œæœ‰æ—¶å€™è¯´åŠå¤©ç»“æœæŠ¥ä¸ªé”™ï¼ŒæŒºè®¨åŒçš„ï¼›é€Ÿåº¦æ¯”è¾ƒæ…¢è¦ç­‰ï¼Œè®¾ç½®ç»å¸¸è‡ªåŠ¨æ¢å¤é»˜è®¤ï¼Œæ¯”å¦‚è‡ªåŠ¨æ·»åŠ æ ‡ç‚¹ç¬¦å·ã€‚</p>
<p>CpsWhisper ç”±äºæˆ‘æ˜¯ AMD 7840H çš„ CPUï¼Œæ¯”è¾ƒæŒ‘æ¨¡å‹å’Œé…ç½®ï¼Œæå¥½åä¸€çœ‹ RAM 4G+ï¼Œå¯åŠ¨è¿˜æŒºéº»çƒ¦ä¸¤ä¸ª exeï¼Œç”¨æˆ·é¡µé¢æ˜¯æ²¡æœ‰çš„å…¨é å‘½ä»¤è¡Œï¼Œè€Œä¸”æ•ˆæœä¹Ÿä¸€èˆ¬èˆ¬ï¼Œæ”¾å¼ƒäº†ã€‚</p>
<p>é¦–æ¬¡ä¸‹è½½å®Œåç”¨æœ¬åœ°å¤§æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹ä¸ª 800M å·¦å³çš„åŒ…ï¼Œå¦‚æœç”¨æœ¬åœ°æ¨¡å‹ï¼Œè¿™æ ·å°±å¤Ÿäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b639169eba84deea8865ab5badd1f30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=KWA9SgX7JyanCywg37qAOqbLLuE%3D" alt="image.png" loading="lazy"/></p>
<p>å¦å¤–æä¸€å˜´è¿™ä¸ªè½¯ä»¶é»˜è®¤æ˜¯å¿«æ·é”®æ˜¯ Ctrl+Winï¼Œæˆ‘è§‰å¾—æŒºä¸å¥½ç”¨çš„æ¢æˆäº†å³è¾¹çš„ Altï¼Œå¯ä»¥åœ¨è®¾ç½®é‡Œé¢è°ƒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4625293b513a46489d4f746e7ca8871b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=NBwEq%2BGYbm3RTStnxM60RmTgpDo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0</h2>
<p>å¦‚æœè§‰å¾—æœ¬åœ°çš„æ¨¡å‹è¯†åˆ«ç‡ä¸å¤Ÿï¼Œå¯ä»¥æ¢æˆçº¿ä¸Šçš„ï¼Œè¿™è¾¹çš„åˆ›å§‹äººæ¨èç”¨ è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0ã€‚æˆ‘è¯•äº†ä¸‹æ•ˆæœè¿˜å¯ä»¥ï¼Œæ–°ç”¨æˆ·æœ‰ 20 ä¸ªå°æ—¶çš„å…è´¹é¢åº¦ã€‚</p>
<h3 data-id="heading-2">è·å–è±†åŒ… Api key</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.volcengine.com%2Fspeech%2Fapp%3FAppID%3D2586725503" target="_blank" title="https://console.volcengine.com/speech/app?AppID=2586725503" ref="nofollow noopener noreferrer">è±†åŒ…è¯­éŸ³</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e4bf011d20d49f8932e8547ffc5624f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=IwseOmnILa31LCEhvz0Zatu7P8w%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20efa2c426e440a7bf40d65ca8a27f90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=s68vkR8%2BLLhb0aqf9axGuen3DrI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">é…ç½®åˆ°é—ªç”µè¯´é‡Œ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6216f720874a4cadb251043580d0dfee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=k95Xe54rLqvYewjCqA0bwL58%2Bfg%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œæ³¨æ„è¦ä¿è¯æœ¬åœ°ç½‘ç»œæ²¡é—®é¢˜ï¼Œæˆ‘ä¹‹å‰ç”¨ Antigravity å¼€äº† TUN æ¨¡å¼ï¼Œè¿™é‡Œè®¿é—®åŠ å¾ˆæ…¢æœ‰é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc946a2eaa534c739d2e793bcf78fb0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=EVKxYdmsVHHBFaJnh2C88urWEKk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">GLM 4.7 Flash æ¶¦è‰²</h2>
<p>GLM çš„ Flash æ¨¡å‹å…¶å®å…è´¹çš„ï¼Œæˆ‘æ›¾ç”¨ Antigravity çš„åä»£ Api åšæ¶¦è‰²ï¼Œä½†æ˜¯é€Ÿåº¦å¤ªæ…¢äº†ï¼Œä¸€å¥è¯éƒ½è¦ 10 sã€‚äºæ˜¯å¯»æ‰¾å›½å†…æœ‰æ²¡æœ‰å…è´¹çš„å°æ¨¡å‹å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œè¿™ä¸ªä¸éœ€è¦èƒ½åŠ›å¤šå¼ºï¼Œåªè¦åšç‚¹ç®€å•çš„æ¶¦è‰²å°±å¥½äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2Fusercenter%2Fproj-mgmt%2Fapikeys" target="_blank" title="https://open.bigmodel.cn/usercenter/proj-mgmt/apikeys" ref="nofollow noopener noreferrer">æ™ºè°±AIå¼€æ”¾å¹³å°</a></p>
<p>æ³¨å†Œä¸€ä¸ª keyã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc9432e4acc24dccaa25b7a03778971f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=VDRLCZKKEGKyrQ9j0bOmEwl7sn8%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è¿™æ¨¡å‹è¾“å…¥ GLM-4.7-Flashï¼Œç„¶åæµ‹è¯•ä¸‹ä¸€èˆ¬å°±æ²¡é—®é¢˜äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d121f7f4b7347a08db8907bbdcf9f33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=54jAFG%2FAo47gXXS3rF5HMmJIPDU%3D" alt="image.png" loading="lazy"/></p>
<p>å†å»æŠ€èƒ½è¿™é‡Œæ·»åŠ æç¤ºè¯ï¼Œæˆ‘çš„æ˜¯</p>
<pre><code class="hljs language-prompt" lang="prompt"># Role
ä½ æ˜¯ä¸€ä½äººå·¥æ™ºèƒ½é¢†åŸŸçš„èµ„æ·±æŠ€æœ¯ç¼–è¾‘ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†è¯†åˆ«æ··ä¹±çš„ä¸­è‹±æ··åˆè¯­éŸ³æ–‡æœ¬ï¼Œé‡å†™ä¸ºä¸€å¥ï¼ˆæˆ–ä¸€æ®µï¼‰é€»è¾‘é€šé¡ºã€æœ¯è¯­å‡†ç¡®çš„çº¯æ–‡æœ¬ã€‚

# Context &amp; Domain
åŸå§‹å†…å®¹æ¶‰åŠ AI å¼€å‘ã€å¤§æ¨¡å‹åŠç›¸å…³æŠ€æœ¯æ ˆã€‚
ä½ å¿…é¡»åŸºäºä¸Šä¸‹æ–‡ï¼Œå¯¹ä»¥ä¸‹é«˜é¢‘è¯¯å¬æœ¯è¯­è¿›è¡Œå¼ºåˆ¶ä¿®æ­£ï¼š
- AI æ¨¡å‹ç±»ï¼šOpen eye -&gt; OpenAI; Jammie/Jimmy -&gt; Gemini; Claude; LLaMA; Transformer
- å¼€å‘å·¥å…·/åè®®ç±»ï¼šCrowd code -&gt; Cloud Code; NCP/NTP -&gt; MCP (Model Context Protocol); Skills; API; SDK
- å¸¸è§åŠ¨è¯/åè¯ï¼šToken; Context Window; Agent; RAG (Retrieval-Augmented Generation)

# Critical Rules (ä¸¥æ ¼æ‰§è¡Œ)
1. **è¾“å‡ºæ ¼å¼**ï¼š
   - **ä¸¥ç¦**ä½¿ç”¨åˆ—è¡¨ã€æ ‡é¢˜ã€Markdown ç¬¦å·ï¼ˆå¦‚ #, -, 1.ï¼‰ã€‚
   - ç»“æœå¿…é¡»æ˜¯**å•è¡Œæ–‡æœ¬**æˆ–**ä¸€ä¸ªè‡ªç„¶æ®µè½**ã€‚
   - é£æ ¼è¦åƒæŠ€æœ¯æ–‡æ¡£ä¸­çš„â€œNoteâ€æˆ–â€œSummaryâ€ï¼Œå¹²ç»ƒã€ä¹¦é¢åŒ–ã€‚

2. **é€»è¾‘æ¸…æ´—**ï¼š
   - **å‰”é™¤å£è¯­**ï¼šåˆ é™¤â€œé‚£ä¸ªâ€ã€â€œé¢â€ã€â€œå°±æ˜¯â€ã€â€œä¹Ÿå°±æ˜¯â€ã€â€œè¿™ç§ä¸œè¥¿â€ã€‚
   - **æ„å›¾ä¿®æ­£**ï¼šé‡åˆ°â€œç”¨ A...ä¸å¯¹ç”¨ Bâ€çš„æƒ…å†µï¼Œç›´æ¥è¾“å‡ºâ€œä½¿ç”¨ Bâ€ã€‚

3. **æœ¯è¯­çº é”™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰**ï¼š
   - å³ä½¿åŸæ–‡å‘éŸ³éå¸¸ç¦»è°±ï¼ˆå¦‚â€œCrowd codeâ€ï¼‰ï¼Œåªè¦ä¸Šä¸‹æ–‡æ˜¯ Google Cloud ç¯å¢ƒï¼Œå¿…é¡»ä¿®æ­£ä¸ºâ€œCloud Codeâ€ã€‚

# Few-Shot Examples (æ ¸å¿ƒå‚ç…§)

=== ç¤ºä¾‹ 1ï¼šæœ¯è¯­ä¿®æ­£ (æ¨¡å‹ä¸æœºæ„) ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
é‚£ä¸ª Open eye çš„æ–°æ¨¡å‹å‘å¸ƒäº†ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ª Jammie 1.5 çš„çª—å£æ›´å¤§ï¼Œæ›´é€‚åˆè·‘é•¿æ–‡æœ¬ã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
OpenAI å‘å¸ƒäº†æ–°æ¨¡å‹ï¼Œä½† Gemini 1.5 å…·å¤‡æ›´å¤§çš„ä¸Šä¸‹æ–‡çª—å£ï¼Œæ›´é€‚åˆå¤„ç†é•¿æ–‡æœ¬ä»»åŠ¡ã€‚

=== ç¤ºä¾‹ 2ï¼šæœ¯è¯­ä¿®æ­£ (åè®®ä¸å·¥å…·) ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
æˆ‘ä»¬ç°åœ¨è¦æ¥é‚£ä¸ª NCP åè®®ï¼Œç„¶ååœ¨ Crowd code é‡Œé¢é…ç½®ä¸€ä¸‹é‚£ä¸ª Skillï¼Œä¸ç„¶è¿ä¸ä¸Šã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
éœ€è¦é€šè¿‡ MCP åè®®å¯¹æ¥ï¼Œå¹¶åœ¨ Cloud Code ä¸­é…ç½®ç›¸åº”çš„ Skills ä»¥ç¡®ä¿è¿æ¥æ­£å¸¸ã€‚

=== ç¤ºä¾‹ 3ï¼šé€»è¾‘è‡ªæˆ‘ä¿®æ­£ ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
æŠŠè¿™ä¸ª temperature è®¾æˆ 0.7...é¢ä¸å¯¹ï¼Œè¿˜æ˜¯è®¾æˆ 0.2 å§ï¼Œæˆ‘ä»¬è¦å‡†ç¡®ä¸€ç‚¹çš„è¾“å‡ºã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
ä¸ºäº†ä¿è¯è¾“å‡ºçš„å‡†ç¡®æ€§ï¼Œè¯·å°† temperature å‚æ•°è®¾ç½®ä¸º 0.2ã€‚

=== ç¤ºä¾‹ 4ï¼šæ··åˆåœºæ™¯ ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
è¿™ä¸ª Agent çš„ååº”å¤ªæ…¢äº†ï¼Œå¯èƒ½æ˜¯é‚£ä¸ª rag çš„æ£€ç´¢åº“å¤ªå¤§äº†ï¼Œæˆ–è€…æ˜¯ token æ•°è¶…äº†ï¼Œä½ æŸ¥ä¸€ä¸‹é‚£ä¸ª prompt æ€ä¹ˆå†™çš„ã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
Agent å“åº”å»¶è¿Ÿå¯èƒ½æ˜¯ç”±äº RAG æ£€ç´¢åº“è¿‡å¤§æˆ– Token è¶…é™æ‰€è‡´ï¼Œè¯·æ£€æŸ¥ Prompt ç¼–å†™é€»è¾‘ã€‚

---

# Input Data
ã€åŸå§‹å£è¯­æ–‡æœ¬ã€‘ï¼š
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2e5137ef1eb4f18a5aa3614ab6f6bcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=B84e8ZP2GmYSf7ff2gn7l48cM2A%3D" alt="image.png" loading="lazy"/></p>
<p>OK é…ç½®å®Œäº†ï¼ŒæŒ‰ä¸‹å³è¾¹ Alt å†è¯´è¯å³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆè¯†Agent]]></title>    <link>https://juejin.cn/post/7603653885601906738</link>    <guid>https://juejin.cn/post/7603653885601906738</guid>    <pubDate>2026-02-07T08:52:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601906738" data-draft-id="7603567912593571867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆè¯†Agent"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹,LangChain"/> <meta itemprop="datePublished" content="2026-02-07T08:52:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è›‡çš®åˆ’æ°´æ€ª"/> <meta itemprop="url" content="https://juejin.cn/user/4301752340323736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆè¯†Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4301752340323736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è›‡çš®åˆ’æ°´æ€ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:52:19.000Z" title="Sat Feb 07 2026 08:52:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AgentåŸºç¡€</h2>
<h3 data-id="heading-1">1.Agentå®šä¹‰</h3>
<p>ä»€ä¹ˆæ˜¯LLM Agentï¼ŸLLM Agentçš„æ ¸å¿ƒåœ¨äºï¼Œç”¨LLMä»£æ›¿ä¼ ç»Ÿçš„å·¥ç¨‹æµç¨‹æ§åˆ¶ï¼Œç”±å¤§æ¨¡å‹è¿›è¡Œæ€è€ƒï¼Œç¡®å®šè§£å†³ç”¨æˆ·Queryçš„æ–¹å¼ï¼Œä¾‹å¦‚ç›´æ¥è¿”å›ã€Search Databaseã€Invoke Tools APIã€æˆ–è€…ä½¿ç”¨å…¶ä»–çš„LLMã€‚ç›¸è¾ƒäºä¼ ç»Ÿçš„å·¥ç¨‹AIï¼ŒAgentå…·æœ‰æ¯”è¾ƒå¤§çš„è‡ªä¸»æƒï¼Œåœ¨è§£å†³é—®é¢˜çš„æ—¶å€™åŸºæœ¬ä¸éœ€è¦äººä¸ºå¹²é¢„ã€‚</p>
<h3 data-id="heading-2">2.LLM Agentå·¥ä½œæµç¨‹</h3>
<p>Agentçš„å·¥ä½œæµç¨‹å¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹çš„æ­¥éª¤ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥Promptæç¤ºè¯ï¼ŒLLMæ¥æ”¶ç”¨æˆ·æ”¶åˆ°çš„Prompt</li>
<li>LLMå¯¹Promptçš„å†…å®¹è¿›è¡Œç†è§£å’Œæ€è€ƒï¼Œå¹¶æŒ‡å®šè§£å†³æ–¹æ¡ˆï¼ŒæœŸé—´ä¼šåŸºäºä¸åŒæ€ç»´æ¨¡å¼è¿›è¡ŒPlaningï¼Œä¾‹å¦‚é“¾å¼æ€ç»´(CoT)ã€ReActã€æ ‘å½¢æ€ç»´ã€å›¾å½¢æ€ç»´GoTç­‰ç­‰</li>
<li>LLMåœ¨æ€è€ƒçš„æ—¶å€™ï¼Œä¼šåŸºäºLTMå’ŒSTMå¯¹ç»“æœåšå‡ºä¿®æ­£ï¼›</li>
<li>Act:åˆ¶å®šå¥½è§£å†³æ–¹æ¡ˆä¹‹åï¼ŒLLMä¼šæŒ‰ç…§è§£å†³æ–¹æ¡ˆè°ƒç”¨å¤–éƒ¨å·¥å…·æˆ–APIæ‰§è¡Œä»»åŠ¡</li>
<li>Observation and Optimization: åŸºäºObservorè§‚æµ‹ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œå¯¹æ‰§è¡Œç»“æœå­¦ä¹ å’Œä¼˜åŒ–</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph Input ["è¾“å…¥é˜¶æ®µ"]
        U([ğŸ‘¤ ç”¨æˆ·è¾“å…¥]) --&gt; P(["ğŸ“ Prompt æç¤ºè¯"])
    end

    subgraph Thinking ["æ€è€ƒé˜¶æ®µ"]
        P --&gt; R(["ğŸ§  LLM æ¥æ”¶ä¸ç†è§£"])
        R --&gt; PL["ğŸ’­ æ€è€ƒä¸è§„åˆ’&lt;br/&gt;CoT / ReAct / ToT / GoT"]
        PL --&gt; M["ğŸ”€ åŸºäºè®°å¿†ä¿®æ­£"]
        M --&gt;|LTM| LTM["é•¿æœŸè®°å¿† LTM"]
        M --&gt;|STM| STM["çŸ­æœŸè®°å¿† STM"]
        LTM --&gt; M
        STM --&gt; M
    end

    subgraph Execution ["æ‰§è¡Œé˜¶æ®µ"]
        M --&gt; A(["âš¡ Act æ‰§è¡ŒåŠ¨ä½œ"])
        A --&gt; T["ğŸ”§ è°ƒç”¨å¤–éƒ¨å·¥å…·/API"]
    end

    subgraph Optimization ["ä¼˜åŒ–é˜¶æ®µ"]
        T --&gt; O(["ğŸ‘ï¸ Observation è§‚æµ‹ç»“æœ"])
        O --&gt; OPT["ğŸ“ˆ å­¦ä¹ ä¸ä¼˜åŒ–"]
        OPT -.-&gt;|åé¦ˆ| PL
        OPT --&gt; RESULT(["âœ… æœ€ç»ˆè¾“å‡º"])
    end

    classDef inputStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    classDef thinkingStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef executionStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef optimizationStyle fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef memoryStyle fill:#fff9c4,stroke:#f57f17,stroke-width:2px,color:#000

    class U,P inputStyle
    class R,PL,M thinkingStyle
    class A,T executionStyle
    class O,OPT,RESULT optimizationStyle
    class LTM,STM memoryStyle
</code></pre>
<h3 data-id="heading-3">3.Agentç»„ç»‡æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    User[User / Request]

    subgraph Agent
        Planner[Planner / Reasoning]
        Executor[Executor]
        Memory[Memory]
    end

    LLM[LLM]
    Tools[Tools / Skills]
    Memo[STM / LTM / Sense]

    User --&gt; Planner
    Planner --&gt; LLM
    LLM --&gt; Planner

    Planner --&gt; Executor
    Executor --&gt; Tools
    Tools --&gt; Executor

    Planner --&gt; Memory
    Memory --&gt; Planner
    Memory --&gt; Memo
    
    classDef agent fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    class Planner,Executor,Memory,LLM agent
</code></pre>
<p><strong>å„ä¸ªç»„ä»¶çš„åŠŸèƒ½</strong></p>
<ol>
<li><strong>Agent</strong>ï¼šAgentå®é™…ä¸Šå¹¶ä¸ç®—å¾—ä¸Šæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªå®¹å™¨ã€‚å®ƒä¸å®ç°å…·ä½“çš„åŠŸèƒ½ï¼Œè€Œæ˜¯è´Ÿè´£æ‰€æœ‰ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œåè°ƒå„ä¸ªç»„ä»¶ã€‚</li>
<li><strong>Planner</strong>ï¼šPlanneræ˜¯æ•´ä¸ªç³»ç»Ÿçš„ä¸­æ¢å¤§è„‘ï¼Œä¸»è¦è¿›è¡Œå†³ç­–ï¼Œè´Ÿè´£å°†æ¨¡ç³Šçš„ã€æŠ½è±¡çš„Promptæ‹†è§£ä¸ºå…·ä½“çš„ã€å¯ä»¥æ‰§è¡Œçš„å­ä»»åŠ¡ã€‚Plannerçš„åŸç†æ˜¯ç»“æ„åŒ–Prompt + LLMæ¨ç†ï¼Œå…·ä½“çš„æ€ç»´æ¨¡å¼æœ‰Chain of Thought, Reflection and Act, Tree of Thought, Graph of Thought</li>
<li><strong>Executor</strong>ï¼šæ‰§è¡Œå™¨çš„ä½œç”¨æ˜¯å°† Planner è§„åˆ’çš„Actionè½¬æ¢ä¸ºçœŸå®çš„è¡Œä¸ºï¼ŒExecutorä¼šæ ¹æ®actionè°ƒç”¨toolsï¼Œæ”¶é›†è°ƒç”¨ç»“æœåfeebackç»™Plannerï¼Œç”¨äºå­¦ä¹ å’ŒçŸ«æ­£ï¼›</li>
<li><strong>Tools</strong>ï¼šä¸»è¦ç”¨äºé“¾æ¥çœŸå®çš„ä¸–ç•Œï¼Œæ‰©å±•Agentèƒ½åŠ›ï¼Œä¾‹å¦‚æœç´¢ã€æŸ¥è¯¢ã€è¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰ç­‰ã€‚Toolæ˜¯å…·ä½“çš„ï¼Œå¯ä»¥æ‰§è¡Œçš„å‡½æ•°ï¼›</li>
<li><strong>Memory</strong>ï¼šåˆ†ä¸ºçŸ­æœŸè®°å¿†ã€é•¿æœŸè®°å¿†ç­‰ç­‰ï¼ŒçŸ­æœŸè®°å¿†æŒ‡çš„æ˜¯ç”¨æˆ·ä¸Šä¸‹æ–‡çš„å†…å®¹ï¼Œé•¿æœŸè®°å¿†å­˜å‚¨åœ¨æ•°æ®åº“ç”¨ï¼Œä»¥çŸ¥è¯†åº“çš„å½¢å¼ä¸ºPlanneræä¾›å‚è€ƒ</li>
</ol>
<h3 data-id="heading-4">4.ChatBotå’ŒAgent</h3>
<h4 data-id="heading-5">4.1 ä»€ä¹ˆæ˜¯Chatbotï¼Ÿ</h4>
<p>ä¸€å¥è¯å®šä¹‰ï¼Œ<strong>èŠå¤©æœºå™¨äººæ˜¯ä¸€ç§æ—¨åœ¨æ¨¡æ‹Ÿäººç±»å¯¹è¯çš„æ•°å­—ç³»ç»Ÿ</strong>ã€‚</p>
<p>æ—©èµ·çš„èŠå¤©æœºå™¨äººé€šå¸¸éœ€è¦äººä¸ºå®šä¹‰å¯¹è¯è§„åˆ™æˆ–è€…å†…å®¹ï¼Œå¦‚æœç”¨æˆ·ç»™å‡ºäº†è§„åˆ™ä¹‹å¤–çš„è¾“å…¥ï¼Œchatbotå¯èƒ½ä¼šæ‹’ç»æœåŠ¡æˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>2022å¹´åº•ï¼ŒOpenAIå‘å¸ƒçš„ChatGPT3.5ä¸€ç»å‘å¸ƒå°±åœ¨ä¸–ç•ŒèŒƒå›´å†…å¼•èµ·äº†ä¸€åœºäººå·¥æ™ºèƒ½çƒ­æ½®ã€‚ç”¨æˆ·äº‰ç›¸ä½“éªŒå’Œæœºå™¨äººå¯¹è¯ï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„Chatbotï¼Œç”±LLMé©±åŠ¨çš„Chatbotå…·æœ‰æ›´é«˜çš„å¯¹è¯è‡ªç”±åº¦ï¼Œå¹¶ä¸”èƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹ç”¨æˆ·åˆé’»çš„é—®é¢˜ã€‚</p>
<p>ä¸è¿‡ï¼Œå’Œä¼ ç»Ÿçš„Chatbotä¸€æ ·ï¼ŒAI Chatbotçš„ä¸»è¦ä½œç”¨æ˜¯å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ€è€ƒï¼Œç”Ÿæˆå“åº”ï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚<strong>Chatbotä¸ä¼šæ›¿ç”¨æˆ·å®Œæˆä»»ä½•ä»»åŠ¡ã€‚</strong></p>
<h4 data-id="heading-6">4.2.Chatbot VS AI Agent</h4>













































<table><thead><tr><th>ç»´åº¦</th><th>Chatbot</th><th>Agent</th></tr></thead><tbody><tr><td>å†³ç­–æ¨¡å¼</td><td>åŸºäºæ—¢å®šè§„åˆ™è¢«åŠ¨ï¼Œéµå¾ªè„šæœ¬</td><td>æ™ºèƒ½ã€ä¸»åŠ¨ï¼Œèƒ½å¤Ÿè¿›è¡Œæ¨ç†ã€ä»»åŠ¡æ‹†è§£ç­‰ï¼Œå¹¶é‡‡å–ç‹¬ç«‹çš„è¡ŒåŠ¨</td></tr><tr><td>è¡Œä¸ºæ¨¡å¼</td><td>å›å¤ç®€å•é—®é¢˜ã€å¼•å¯¼ç”¨æˆ·å®Œæˆæµç¨‹æ­¥éª¤</td><td>æ·±å…¥äº†è§£ç”¨æˆ·æ„å›¾ï¼Œå®Œæˆå¤æ‚çš„å¤šæ­¥éª¤çš„æµç¨‹</td></tr><tr><td>å†³ç­–æƒ</td><td>å®Œå…¨ç”±ç”¨æˆ·æŒæ¡</td><td>ç”¨æˆ·/Agentï¼ˆAgentä¼šè¯·æ±‚èµ‹äºˆç›¸å…³æƒé™ï¼‰</td></tr><tr><td>åé¦ˆèƒ½åŠ›</td><td>ä¸ä¼šå›é¡¾æ‰§è¡Œç»“æœï¼Œç”±ç”¨æˆ·åˆ¤æ–­æ‰§è¡Œç»“æœçš„æ­£ç¡®æ€§</td><td>ä¸»åŠ¨è§‚å¯Ÿæ‰§è¡Œç»“æœï¼Œè‹¥å¤±è´¥åˆ™ä¼šè°ƒæ•´ç­–ç•¥é‡æ–°å°è¯•</td></tr><tr><td>ä¸Šä¸‹æ–‡èƒ½åŠ›</td><td>æ¯”è¾ƒå¼±ï¼Œä¸ä¼šå­˜å‚¨ä¸Šä¸‹æ–‡æˆ–è€…å­˜å‚¨å°‘é‡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</td><td>å¼ºï¼Œä¼šå­˜å‚¨ä¸­é—´ç»“æœå’Œç”¨æˆ·çš„ä¸Šä¸‹æ–‡</td></tr><tr><td>å¯æ§æ€§</td><td>å¼ºï¼Œè¡Œä¸ºå¯æ§ï¼Œå‡ºç°å¹»è§‰çš„é£é™©è¾ƒå°</td><td>å¼±ï¼Œæ‹¥æœ‰è¾ƒé«˜çš„è‡ªç”±åº¦ï¼Œæ¯”è¾ƒå¤§çš„å¹»è§‰é£é™©</td></tr><tr><td>å…¸å‹åœºæ™¯</td><td>å®¢æœé—®ç­”ã€çŸ¥è¯†æŸ¥è¯¢ã€å†…å®¹ç”Ÿæˆã€æ•™å­¦ç­”ç–‘</td><td>è‡ªåŠ¨åŒ–è¿ç»´ã€æ•°æ®åˆ†æä»»åŠ¡ã€ä»£ç ä¿®å¤ã€å¤šæ­¥éª¤ä¸šåŠ¡å¤„ç†</td></tr></tbody></table>
<h3 data-id="heading-7">5.Agentå†…éƒ¨å®ç°</h3>
<h4 data-id="heading-8">5.1.Agentå·¥ä½œæµç¨‹</h4>
<p>é¦–å…ˆæˆ‘ä»¬æ€è€ƒä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆè¦è¿›è¡ŒLoopï¼Ÿä¸èƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åç›´æ¥è¿”å›ç»™ç”¨æˆ·å—ï¼Ÿ</strong></p>
<p><em>ä¸€å¥è¯æ€»ç»“ï¼šAgentéœ€è¦é€šè¿‡Loopï¼Œé€šè¿‡æ‰§è¡Œç»“æœä¿®æ­£æ‰§è¡Œç­–ç•¥ï¼Œä»è€Œè¾¾åˆ°æ»¡æ„çš„æ‰§è¡Œç»“æœã€‚</em></p>
<p>æ‰€æœ‰çš„Agentæ‰§è¡Œæµç¨‹å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹æµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
	Perception --&gt; Reasoning
	Reasoning --&gt; Action
	Action --&gt; Feedback
	Feedback --&gt; Memory[Memory Updat]
</code></pre>
<ol>
<li>**Step1:**åˆå§‹åŒ–ï¼Œè®¾ç½®ç›®æ ‡ï¼Œåˆå§‹åŒ–è®°å¿†ã€ä¸Šä¸‹æ–‡ã€æœ€å¤§æ­¥æ•°ä»¥åŠè¶…æ—¶æ—¶é—´ï¼›</li>
<li>**Step2ï¼š**Observeï¼Œè§‚å¯Ÿå½“å‰çŠ¶æ€ã€‚ä¸»è¦æ˜¯æ”¶é›†ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€Promptä¿¡æ¯ï¼Œå·²ç»æ‰§è¡Œçš„æ­¥éª¤ã€ä¸Šä¸€æ­¥è¿”å›çš„ç»“æœä»¥åŠå½“å‰ç¯å¢ƒçŠ¶æ€ç­‰ï¼›</li>
<li><strong>Step3ï¼šThink / Plan</strong>ã€‚æ ¹æ®å½“å‰çŠ¶æ€è¿›è¡Œæ¨ç†ï¼Œå½“å‰çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿç›®æ ‡ï¼Ÿä¸‹ä¸€æ­¥è°ƒç”¨ä»€ä¹ˆå·¥å…·ï¼Ÿç„¶åè¾“å‡ºç»“æ„åŒ–å†³ç­–ï¼›</li>
<li><strong>Step4ï¼šAct</strong>ã€‚æ‰§è¡Œï¼Œæ ¹æ®LLMè¾“å‡ºçš„å†³ç­–ä¿¡æ¯ï¼Œè°ƒç”¨å¯¹åº”çš„APIæˆ–è€…Toolsï¼Œå¹¶æ•è·æ‰§è¡Œç»“æœæˆ–è€…å¼‚å¸¸ï¼›</li>
<li><strong>Step5ï¼šObserve FeedBack</strong>ã€‚è§‚å¯Ÿæ‰§è¡Œç»“æœã€‚</li>
<li><strong>Step6ï¼šUpdate Memory</strong>ã€‚å°†æœ¬è½®ä¿¡æ¯å†™å…¥åˆ°STMå’ŒLTMä¸­ã€‚</li>
<li><strong>Step7ï¼šStop Decision</strong>ã€‚ç»ˆæ­¢åˆ¤æ–­ï¼Œç›®æ ‡æ˜¯å¦å®Œæˆï¼Œæ˜¯å¦è¾¾åˆ°ç»ˆæ­¢æ¡ä»¶ï¼Ÿæ˜¯å¦å‡ºç°äº†ä¸å¯æ¢å¤çš„é”™è¯¯ï¼Ÿ</li>
<li><strong>Step8ï¼šContinue Loop</strong>ã€‚å¦‚æœæ²¡æœ‰ç»ˆæ­¢å¾ªç¯ï¼Œåˆ™è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯ã€‚</li>
</ol>
<h4 data-id="heading-9">5.2.ä¼ªä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1.åˆå§‹åŒ–</span>
init(context);

<span class="hljs-comment">// 2.ä¸»å¾ªç¯é€»è¾‘</span>
<span class="hljs-keyword">while</span> (AgentContext.state == RUNNING) {
    <span class="hljs-comment">// 2.1.è§‚æµ‹å½“å‰çŠ¶æ€</span>
    <span class="hljs-type">Observation</span> <span class="hljs-variable">curEnv</span> <span class="hljs-operator">=</span> observeEnv(context);
    
    <span class="hljs-comment">// 2.2.è°ƒç”¨LLMè¿›è¡Œåˆ†æå†³ç­–</span>
    <span class="hljs-type">LLMReasonResult</span> <span class="hljs-variable">decisions</span> <span class="hljs-operator">=</span> LLMService.reason(
   		context.goal, context.memory, curEnv);
    
    <span class="hljs-comment">// 2.3.æ ¹æ®å†³ç­–ç±»å‹å‡†å¤‡æ‰§è¡Œ</span>
    <span class="hljs-keyword">if</span> (decisions.type == FINISH) {
        <span class="hljs-comment">// a.ç›´æ¥è¿”å›ç»“æœ</span>
        context.state = DONE;
        context.result = decisions.result;
        <span class="hljs-keyword">break</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (decision.type == ACTION) {
        <span class="hljs-type">Action</span> <span class="hljs-variable">act</span> <span class="hljs-operator">=</span> decisions.getAction();
        <span class="hljs-type">ActionContext</span> <span class="hljs-variable">ac</span> <span class="hljs-operator">=</span> decisions.getInput();
        
        <span class="hljs-comment">// è°ƒç”¨æ‰§è¡Œå™¨æ‰§è¡ŒåŠ¨ä½œ</span>
        <span class="hljs-type">Executor</span> <span class="hljs-variable">exc</span> <span class="hljs-operator">=</span> Executors.builder().action(act).context(ac).build();
        <span class="hljs-type">ActionResult</span> <span class="hljs-variable">ar</span> <span class="hljs-operator">=</span> buildDefaultResult();
        <span class="hljs-keyword">try</span> {
            ar = exc.excute();
        } <span class="hljs-keyword">catch</span> (RuntimeException e) {
            <span class="hljs-comment">// print log</span>
        }
        <span class="hljs-comment">// æ›´æ–°è®°å¿†</span>
        context.updateMemory(act, ac, ar);
    }
    
    <span class="hljs-comment">// æ­¥æ•°è‡ªå¢</span>
    context.increaseStep();
    
    <span class="hljs-comment">// åˆ¤æ–­å¾ªç¯ç»“æŸæ¡ä»¶</span>
    <span class="hljs-keyword">if</span> (context.getStep() &gt;= context.maxStep) {
        context.status = FAILED;
        <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<h4 data-id="heading-10">5.3.Javaå®ç°Agent</h4>
<h5 data-id="heading-11">5.3.1.æ¨¡å‹</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
	class AgentContext {
		+ String goal
		+ int stepCounts
		+ AgentState state
		+ getState() AgentState
		+ incrementStep() void
	}
	
</code></pre>
<h5 data-id="heading-12">5.3.2.æ¥å£è®¾è®¡</h5>
<p><strong>1.AgentæŠ½è±¡ç±»</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Agent</span>{ AgentResult <span class="hljs-title function_">run</span><span class="hljs-params">(AgentInput input)</span>; }
</code></pre>
<p><strong>2.AgentLooper å¾ªç¯ç¼–æ’å™¨</strong></p>
<p>ä¸»è¦è´Ÿè´£<code>while</code>å¾ªç¯çš„æµç¨‹ç¼–æ’ä»¥åŠ<code>context</code>çš„çŠ¶æ€æ¨è¿›ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentLoop</span>{
    AgentResult <span class="hljs-title function_">execute</span><span class="hljs-params">(AgentContext cxt)</span>;
}
</code></pre>
<p><strong>3.AgentObserver è§‚å¯Ÿè€…</strong></p>
<p>ä¸»è¦è´Ÿè´£æ„å»ºä¸Šä¸‹æ–‡ï¼Œåˆ†æå½“å‰æ‰§è¡Œç¯å¢ƒã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentObserver</span> {
    Observation <span class="hljs-title function_">observe</span><span class="hljs-params">(AgentContext ctx)</span>;
}
</code></pre>
<p><strong>4.AgentPlanner å†³ç­–å™¨</strong></p>
<p>è°ƒç”¨LLMå¯¹è¾“å…¥è¿›è¡Œæ€è€ƒå’Œè§„åˆ’ï¼Œå¾—å‡ºå…·ä½“çš„æ‰§è¡Œç­–ç•¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentPlanner</span> {
    AgentDecision <span class="hljs-title function_">decideAfterReasoning</span><span class="hljs-params">(Observation obs, AgentContext ctx)</span>;
}
</code></pre>
<p><strong>5.Executor æ‰§è¡Œå™¨</strong></p>
<p>è·å–æ‰§è¡Œè®¡åˆ’ï¼ŒæŒ‰ç…§æ‰§è¡Œè®¡åˆ’æ‰§è¡Œå¯¹åº”çš„Actionã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentExecutor</span> {
    ActionResult <span class="hljs-title function_">execute</span><span class="hljs-params">(Action ac, AgentState ctx)</span>;
}
</code></pre>
<p><strong>6.Tool å¤–éƒ¨èƒ½åŠ›</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Tool</span> {
    ToolResult <span class="hljs-title function_">run</span><span class="hljs-params">(Map params)</span>;
}
</code></pre>
<p><strong>7.Agent Memory è®°å¿†ç»„ä»¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentMemory</span> {
    <span class="hljs-comment">// ä¿å­˜è®°å¿†</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(MemoryRecord record)</span>;
    
    <span class="hljs-comment">// è·å–è®°å¿†è®°å½•</span>
    List&lt;MemoryRecord&gt; <span class="hljs-title function_">recall</span><span class="hljs-params">(RecallRequest req)</span>;
}
</code></pre>
<h5 data-id="heading-13">5.3.3.è½åœ°å®ç°</h5>




























































<table><thead><tr><th>åŠŸèƒ½ç‚¹</th><th>å®ç°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>LLMæ¥å…¥</td><td>GLM API</td><td>ä¾¿å®œï¼Œç¨³å®š</td></tr><tr><td>éé˜»å¡è°ƒç”¨</td><td>Spring webClient</td><td>ä¸€å®šè¦éé˜»å¡è°ƒç”¨ï¼Œç”¨æˆ·ä½“æ„Ÿå¥½</td></tr><tr><td>ç»“æ„åŒ–è¾“å‡º</td><td>Jackson</td><td/></tr><tr><td>ç”Ÿå‘½å‘¨æœŸç®¡ç†</td><td>SpringBoot</td><td>Beanç®¡ç†ã€é…ç½®ç®¡ç†</td></tr><tr><td>Agentè¿è¡ŒçŠ¶æ€æµè½¬</td><td>æœ‰é™çŠ¶æ€æœº</td><td>é˜²æ­¢å‡ºç°éæ³•çŠ¶æ€çš„æµè½¬ï¼Œæ›´åŠ å®‰å…¨</td></tr><tr><td>æç¤ºè¯æ¨¡æ¿åŠ¨æ€é…ç½®</td><td>Nacos</td><td>é…ç½®ä¸­å¿ƒï¼Œæ”¯æŒé…ç½®çƒ­æ›´æ–°å’Œé…ç½®çš„ç‰ˆæœ¬ç®¡ç†</td></tr><tr><td>Toolæ‰§è¡Œ</td><td>ç­–ç•¥æ¨¡å¼</td><td>é€šè¿‡ç­–ç•¥æ¨¡å¼è·å–Toolçš„æ‰§è¡Œå™¨</td></tr><tr><td>Toolæ³¨å†Œã€å‘ç°</td><td>SPI/Registry</td><td/></tr><tr><td>STM</td><td>Redis / Caffeine</td><td>ä½¿ç”¨ç¼“å­˜æ¥ä¿å­˜ä¸Šä¸‹æ–‡</td></tr><tr><td>LTM</td><td>DB</td><td>é•¿æ—¶è®°å¿†åº”å½“æŒä¹…åŒ–æ•°æ®åº“ä¸­</td></tr></tbody></table>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼]]></title>    <link>https://juejin.cn/post/7603643385815547956</link>    <guid>https://juejin.cn/post/7603643385815547956</guid>    <pubDate>2026-02-07T08:54:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643385815547956" data-draft-id="7603588665567936552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:54:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:54:04.000Z" title="Sat Feb 07 2026 08:54:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šåœ¨ä¸€äº›ç‰¹å®šçš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¯¹è±¡ä¸­çš„Listé›†åˆå±æ€§å­˜å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹‹åæŠŠè¯¥å­—æ®µå–å‡ºæ¥è½¬ä¸ºListé›†åˆçš„å¯¹è±¡ä½¿ç”¨ï¼ˆå¦‚ä¸‹å›¾ï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04738a109bf4470089581f8951c902fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=FkdDLoA%2FH2ar%2BhI3fj1%2FFDLK0S8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è‡ªå®šä¹‰å¯¹è±¡</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {

    <span class="hljs-comment">/**
     * ID
     */</span>
    <span class="hljs-keyword">private</span> Integer id;

    <span class="hljs-comment">/**
     * ç”¨æˆ·å
     */</span>
    <span class="hljs-keyword">private</span> String username;

    <span class="hljs-comment">/**
     * å¯†ç 
     */</span>
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-comment">/**
     * ç”µè¯
     */</span>
    <span class="hljs-keyword">private</span> String phone;

}
</code></pre>
<p>å³æŠŠè‡ªå®šä¹‰å¯¹è±¡çš„Listé›†åˆè½¬ä¸ºJsonå­—ç¬¦ä¸²ï¼Œå†è½¬å›Listé›†åˆï¼Œæœ¬æ–‡ä»‹ç»ä¸¤ç§å®ç°æ–¹å¼ï¼›</p>
<h2 data-id="heading-0">FastJsonä¾èµ–</h2>
<p>FastJsonæ˜¯é˜¿é‡Œå·´å·´æä¾›çš„å°†æ•°æ®è½¬ä¸ºJsonçš„ä¸€ç³»åˆ—æ“ä½œçš„å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„ä¸¤ä¸ªæ–¹æ³•å®ç°</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java">        ArrayList&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3</span>,<span class="hljs-string">"guest"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));

        System.out.println(<span class="hljs-string">"Listé›†åˆtoStringæ ¼å¼ = "</span> + users);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        <span class="hljs-comment">// fastjson</span>
        <span class="hljs-type">JSONArray</span> <span class="hljs-variable">jsonArray</span> <span class="hljs-operator">=</span> JSONArray.parseArray(users.toString());
        System.out.println(<span class="hljs-string">"jsonArray = "</span> + jsonArray);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        List&lt;User&gt; fastJsonList = jsonArray.toJavaList(User.class);
        System.out.println(<span class="hljs-string">"fastJsonList.get(0) = "</span> + fastJsonList.get(<span class="hljs-number">0</span>));
</code></pre>
<p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œéœ€è¦è¦†å†™Userå¯¹è±¡çš„toString()æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"{"</span> +
                <span class="hljs-string">"id:"</span> + id +
                <span class="hljs-string">", username:'"</span> + username + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", password:'"</span> + password + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", phone:'"</span> + phone + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">'}'</span>;
    }
</code></pre>
<p>æ‰§è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°è½¬æ¢å®Œæˆï¼›</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98ff6b1c78a143c08379477fab98df2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=OsN07Vfz%2FmHEEV7ajbOCj5Bfb1s%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">Hutoolä¾èµ–</h2>
<p>Hutoolæä¾›äº†å„ä¸ªæ–¹é¢çš„å·¥å…·ï¼Œå¯ä½¿ç”¨å…¶ä¸­çš„JSONUtilå®ç°ç›®çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java">        ArrayList&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3</span>,<span class="hljs-string">"guest"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));

        System.out.println(<span class="hljs-string">"Listé›†åˆtoStringæ ¼å¼ = "</span> + users);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">jsonStr</span> <span class="hljs-operator">=</span> JSONUtil.toJsonStr(users);
        System.out.println(<span class="hljs-string">"jsonStr = "</span> + jsonStr);

        System.out.println(<span class="hljs-string">"==========================================="</span>);
        List&lt;User&gt; hutoolList = JSONUtil.toList(jsonStr, User.class);
        System.out.println(<span class="hljs-string">"hutoolList.get(0) = "</span> + hutoolList.get(<span class="hljs-number">0</span>));
</code></pre>
<p>æ‰§è¡Œç»“æœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4f52e51ade14f46810525b8a62aa382~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=%2BrR%2FtNF2ynEG31tCkQDvQTv85ig%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-2">æ€»ç»“</h2>
<p>ä½¿ç”¨fastjsonã€hutoolå·¥å…·åŒ…éƒ½å¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œå»ºè®®ä½¿ç”¨hutoolå·¥å…·åŒ…ï¼Œhutoolæä¾›äº†è®¸å¤šæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨åˆ°çš„ä¸€äº›æ“ä½œï¼Œå¦‚ç”Ÿæˆtokenã€æ•°å­—æ ¼å¼è½¬æ¢ã€å¯¹è±¡éç©ºåˆ¤æ–­ã€æ•°å­—åŠ å¯†ç­‰ç­‰ï¼ŒjsonUtilåªæ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</p>
<p>è€Œä¸”å¦‚æœä½¿ç”¨fastjsonï¼Œè¿˜éœ€è¦é‡å†™å¯¹è±¡çš„toString()æ–¹æ³•ï¼Œè¾ƒä¸ºéº»çƒ¦ã€‚</p>
<h2 data-id="heading-3">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F132077704" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/132077704" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨String.valueOf()çš„å‘]]></title>    <link>https://juejin.cn/post/7603616672926892047</link>    <guid>https://juejin.cn/post/7603616672926892047</guid>    <pubDate>2026-02-07T08:55:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672926892047" data-draft-id="7603575399256621096" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨String.valueOf()çš„å‘"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:55:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨String.valueOf()çš„å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:55:36.000Z" title="Sat Feb 07 2026 08:55:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šè®°å½•ä¸€æ¬¡ä½¿ç”¨String.valueOf()çš„å‘ï¼Œä»¥ä¸‹æ˜¯ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-type">String</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> String.valueOf(listData.get(<span class="hljs-number">0</span>).get(<span class="hljs-number">0</span>).get(<span class="hljs-string">"count"</span>);
	<span class="hljs-keyword">if</span> (StringUtils.isBlank(count) || <span class="hljs-string">"0"</span>.equals(count)) {
	    result.setResult(page);
	    <span class="hljs-keyword">return</span> result;
	}
</code></pre>
<h2 data-id="heading-0">é—®é¢˜åˆ†æ</h2>
<p>å…¶ä¸­ï¼ŒlistDataæ˜¯è°ƒç”¨æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹ï¼Œè¿”å›çš„æ•°æ®é›†åˆï¼Œæ˜¯List&lt;List&lt;Map&lt;String,String&gt;ç±»å‹çš„ï¼Œè¡¨ç¤ºå¤šä¸ªç»“æœé›†ï¼Œæ¯ä¸ªç»“æœé›†æœ‰å¤šæ¡æ•°æ®ï¼Œè€Œç»“æœé›†1ï¼Œé€šå¸¸è¡¨ç¤ºè®°å½•çš„æ€»æ¡æ•°ï¼Œå³countï¼›</p>
<p>è¿™æ®µä»£ç å°±æ˜¯å°†ç¬¬1ä¸ªç»“æœé›†ä¸­çš„countå­—æ®µå€¼è·å–å‡ºæ¥ï¼Œå¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>æ­£å¸¸æƒ…å†µï¼Œè¿™æ®µä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œåé¢ä¹Ÿå¯¹countçš„å€¼åšäº†æ ¡éªŒï¼Œå¦‚æœcountå€¼ä¸ºnullæˆ–è€…0ï¼ˆ<code>StringUtils.isBlank(count) </code>ï¼‰ï¼Œéƒ½ä¸ä¼šå¾€ä¸‹èµ°ï¼›</p>
<hr/>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œå½“listDataä¸­ï¼Œç¬¬1ä¸ªç»“æœé›†ä¸­æ²¡æœ‰countæ—¶ï¼Œè¿™æ®µä»£ç å°±æœ‰é—®é¢˜äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff9767aeae24414a971ef4ba45383793~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059340&amp;x-signature=X3Ck0IFy18E4z%2FImF3Lw%2FaqSoZk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>é—®é¢˜æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œå½“è°ƒç”¨å­˜å‚¨è¿‡ç¨‹è¿”å›çš„ç»“æœé›†ä¸­ï¼Œæ²¡æœ‰countè¿™ä¸ªç»“æœé›†ï¼ŒString.valueOf()é‡Œé¢çš„å†…å®¹æ˜¯nullï¼Œæ‰€ä»¥==String countä¼šå¾—åˆ°ä¸€ä¸ªâ€œnullâ€å­—ç¬¦ä¸²ï¼Œè€Œåœ¨ä¸‹é¢çš„ifåˆ¤æ–­ä¸­ï¼ŒStringUtils.isBlank(count)çš„è¿”å›ç»“æœä¼šæ˜¯falseï¼Œè¿™æ ·å°±è·³è¿‡äº†å¯¹countçš„ç©ºå€¼åˆ¤æ–­==ã€‚</p>
<h2 data-id="heading-1">String.valueOf()</h2>
<p>ä¸ºä»€ä¹ˆnullä¼šè¢«è½¬ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿæˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šå°†ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ä¸ºnullï¼Œç„¶åè°ƒç”¨String.valueOf()æ–¹æ³•</span>
	<span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
	System.out.println(String.valueOf(str));
	
	<span class="hljs-comment">// æ–¹å¼äºŒï¼šç›´æ¥å°†nullä½œä¸ºå‚æ•°ä¼ å…¥</span>
	System.out.println(String.valueOf(<span class="hljs-literal">null</span>));
</code></pre>
<p>è¿™ä¸¤ç§æ–¹å¼ï¼Œå‰ä¸€ç§ä¼šæ‰“å°â€œnullâ€ï¼Œåä¸€ç§ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65ab93cc9718453ca8d812e346ce55c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059340&amp;x-signature=20G4GXu5URb27lXsumA%2FXH7qsfg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå£°æ˜äº†çš„å¯¹è±¡ï¼Œèµ‹å€¼ä¸ºnullï¼Œä½œä¸ºå‚æ•°ä¼ å…¥String.valueOf()ä¼šè¿”å›nullå­—ç¬¦ä¸²ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¸èƒ½ä½¿ç”¨String.valueOf()å°†å–å‡ºçš„å€¼å†è½¬ä¸ºStringç±»å‹ã€‚ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-type">String</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> listData.get(<span class="hljs-number">0</span>).get(<span class="hljs-number">0</span>).get(<span class="hljs-string">"count"</span>);
	<span class="hljs-keyword">if</span> (StringUtils.isBlank(count) || <span class="hljs-string">"0"</span>.equals(count)) {
	    result.setResult(page);
	    <span class="hljs-keyword">return</span> result;
	}
</code></pre>
<h2 data-id="heading-2">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F134301560" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/134301560" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶]]></title>    <link>https://juejin.cn/post/7603588665567969320</link>    <guid>https://juejin.cn/post/7603588665567969320</guid>    <pubDate>2026-02-07T08:58:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603588665567969320" data-draft-id="7603575399256653864" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:58:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:58:05.000Z" title="Sat Feb 07 2026 08:58:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨Javaä»£ç å‘é€é‚®ä»¶ï¼›</p>
<h2 data-id="heading-0">å®ç°</h2>
<h3 data-id="heading-1">Step1ï¼šå¼•å…¥ä¾èµ–</h3>
<p>åˆ›å»ºä¸€ä¸ªMavené¡¹ç›®ï¼Œå¼•å…¥ä¸‹é¢ä¸¤ä¸ªä¾èµ–ï¼›</p>
<pre><code class="hljs language-xml" lang="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.27<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.sun.mail<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.6.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">Step2ï¼šç¼–ç </h3>
<p>é¦–å…ˆï¼Œå†™ä¸€ä¸ªå·¥å…·ç±»ï¼Œè¯¥å·¥å…·ç±»æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªç”¨æ¥è·å–é‚®ä»¶å¯¹è±¡ï¼Œä¸€ä¸ªç”¨æ¥å‘é€é‚®ä»¶ï¼›</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> cn.hutool.core.util.StrUtil;
<span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailAccount;
<span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailUtil;

<span class="hljs-comment">/**
 * é‚®ä»¶å‘é€å·¥å…·ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSenderUtil</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">EmailSenderUtil</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-comment">/**
     * è·å–é‚®ç®±å®¢æˆ·ç«¯
     *
     * <span class="hljs-doctag">@param</span> smtpHost      smtpæœåŠ¡å™¨åœ°å€
     * <span class="hljs-doctag">@param</span> smtpPort      smtpæœåŠ¡å™¨ç«¯å£
     * <span class="hljs-doctag">@param</span> emailUsername é‚®ç®±ç”¨æˆ·å
     * <span class="hljs-doctag">@param</span> emailPassword é‚®ç®±æˆæƒç 
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MailAccount <span class="hljs-title function_">getMailClient</span><span class="hljs-params">(String smtpHost, <span class="hljs-type">int</span> smtpPort, String emailUsername, String emailPassword)</span> {
        <span class="hljs-type">MailAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MailAccount</span>();
        account.setHost(smtpHost);
        account.setPort(smtpPort);
        account.setAuth(<span class="hljs-literal">true</span>);
        account.setFrom(emailUsername);
        account.setUser(emailUsername);
        account.setPass(emailPassword);
        <span class="hljs-keyword">return</span> account;
    }

    <span class="hljs-comment">/**
     * å‘é€é‚®ä»¶
     *
     * <span class="hljs-doctag">@param</span> account é‚®ç®±å®¢æˆ·ç«¯
     * <span class="hljs-doctag">@param</span> to      æ¥æ”¶äººé‚®ç®±åœ°å€
     * <span class="hljs-doctag">@param</span> subject é‚®ä»¶ä¸»é¢˜
     * <span class="hljs-doctag">@param</span> content é‚®ä»¶å†…å®¹
     * <span class="hljs-doctag">@param</span> isHtml  æ˜¯å¦æ˜¯htmlæ ¼å¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendEmail</span><span class="hljs-params">(MailAccount account, String to, String subject, String content, <span class="hljs-type">boolean</span> isHtml)</span> {
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(to)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æ”¶ä»¶äººé‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(subject)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ä»¶ä¸»é¢˜ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(content)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ä»¶å†…å®¹ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">try</span> {
            MailUtil.send(account, to, subject, content, isHtml);
            System.out.println(<span class="hljs-string">"é‚®ä»¶å‘é€æˆåŠŸ"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.out.println(<span class="hljs-string">"é‚®ä»¶å‘é€å¤±è´¥"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-3">Step3ï¼šè·å–æˆæƒç </h3>
<p>å‘é€äººçš„é‚®ç®±è´¦æˆ·éœ€è¦å¼€é€šSMTPæœåŠ¡ï¼Œå…è®¸é€šè¿‡å®¢æˆ·ç«¯å‘é€é‚®ä»¶ï¼Œè¿™é‡Œä»‹ç»QQé‚®ç®±ã€ç½‘æ˜“é‚®ç®±å¼€é€šSMTPæœåŠ¡å’Œè·å–æˆæƒç çš„æ­¥éª¤ã€‚</p>
<p>ï¼ˆQQé‚®ç®±ï¼ŒSMTP_HOSTæ˜¯ï¼š<code>smtp.qq.com</code>ï¼ŒPORTç”¨ï¼š<code>465æˆ–587</code>ï¼‰</p>
<p>æ–‡æ¡£å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwx.mail.qq.com%2Flist%2Freadtemplate%3Fname%3Dapp_intro.html%23%2Fagreement%2FauthorizationCode" target="_blank" title="https://wx.mail.qq.com/list/readtemplate?name=app_intro.html#/agreement/authorizationCode" ref="nofollow noopener noreferrer">wx.mail.qq.com/list/readteâ€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a23b8596a1384f079d39fa5867a09071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=ZjOVb%2B0%2FViQabA0VijGQsK0dcyA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ï¼ˆç½‘æ˜“é‚®ç®±ï¼ŒSMTP_HOSTæ˜¯ï¼š<code>smtp.163.com</code>ï¼ŒPORTç”¨ï¼š<code>25</code>ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa2f688fae3544a4a3e7d39a932b8068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=zHoua0gY1TBv99XBWhgKqaC3hlw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è·å–æˆæƒç çš„æ–¹å¼éƒ½å·®ä¸å¤šï¼Œç”¨ç»‘å®šçš„æ‰‹æœºç»™é‚®ä»¶å®˜æ–¹å‘çŸ­ä¿¡ï¼Œç„¶åè·å–æˆæƒç </p>
<h3 data-id="heading-4">Step4ï¼šæµ‹è¯•</h3>
<p>å†™ä¸€ä¸ªmainæ–¹æ³•ï¼Œæµ‹è¯•å‘é€é‚®ä»¶</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailAccount;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSentTest</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é‚®ä»¶æ¥æ”¶äººï¼Œå¤šä¸ªæ¥æ”¶äººä½¿ç”¨é€—å·æˆ–è€…åˆ†å·éš”å¼€</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>;
        <span class="hljs-comment">// é‚®ä»¶ä¸»é¢˜</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æµ‹è¯•é‚®ä»¶"</span>;
        <span class="hljs-comment">// é‚®ä»¶å†…å®¹</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">"è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶"</span>;

        <span class="hljs-comment">// è·å–é‚®ç®±å®¢æˆ·ç«¯</span>
        <span class="hljs-type">MailAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> EmailSendUtil.getMailClient(<span class="hljs-string">"smtp.qq.com"</span>, <span class="hljs-number">587</span>,
                <span class="hljs-string">"å‘é€æ–¹qqè´¦å·"</span>, <span class="hljs-string">"å‘é€æ–¹æˆæƒç "</span>);

        <span class="hljs-comment">// å‘é€é‚®ä»¶</span>
        EmailSendUtil.sendEmail(account, to, subject, content, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<p>å‘é€æˆåŠŸ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7162de05eae45aa851c0f4869fedf54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=h0bwGN3Jezp8FoUQJlkAlIB2FkA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d9fbb66f55b490cb9c16050428a2b68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=E%2FN8qqWRoeiW5MhFKUtIBLUq8L0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ç”¨Hutoolå·¥å…·åŒ…å°è£…çš„MailUtilå‘é€é‚®ä»¶ï¼ŒåŠQQé‚®ç®±ã€ç½‘æ˜“é‚®ç®±å¦‚ä½•å¼€é€šSMTPæœåŠ¡å’Œè·å–æˆæƒç ã€‚</p>
<p>å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_34874784%2Farticle%2Fdetails%2F136237042" target="_blank" title="https://blog.csdn.net/qq_34874784/article/details/136237042" ref="nofollow noopener noreferrer">java ç”¨163é‚®ç®±å‘é€é‚®ä»¶</a></li>
</ul>
<h2 data-id="heading-6">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F139130565" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/139130565" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„]]></title>    <link>https://juejin.cn/post/7603595309232898058</link>    <guid>https://juejin.cn/post/7603595309232898058</guid>    <pubDate>2026-02-07T08:57:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603595309232898058" data-draft-id="7603591775392874523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T08:57:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:57:55.000Z" title="Sat Feb 07 2026 08:57:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„</h2>
<h3 data-id="heading-1">ä»ä¸€è¡Œä»£ç åˆ°ä¸€ä¸ªå®Œæ•´AIèŠå¤©åº”ç”¨</h3>
<p>æœ€è¿‘æˆ‘åœ¨åšä¸€ä¸ªAIèŠå¤©åº”ç”¨æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼š<strong>å¦‚ä½•è®©AIçš„å›å¤åƒçœŸäººæ‰“å­—ä¸€æ ·ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°å‡ºç°ï¼Ÿ</strong> Â ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œæˆ‘å‘ç°äº†æµå¼è¾“å‡º + Bufferçš„ç»„åˆæ–¹æ¡ˆã€‚ä»Šå¤©ï¼Œæˆ‘å°±ç”¨æˆ‘çš„å®é™…ä»£ç ï¼Œå¸¦ä½ å½»åº•ææ‡‚è¿™ä¸ªæŠ€æœ¯ï¼</p>
<h3 data-id="heading-2">è¿™ä¸ªåº”ç”¨æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h3>
<p>æƒ³è±¡ä½ æœ‰ä¸€ä¸ª <strong>æ™ºèƒ½èŠå¤©æœºå™¨äºº</strong>ğŸ¤–ï¼š</p>
<ol>
<li>ä½ è¾“å…¥ä¸€ä¸ªé—®é¢˜ï¼ˆæ¯”å¦‚ï¼š"è®²ä¸€ä¸ªç¬‘è¯"ï¼‰</li>
<li>ç‚¹å‡»"æäº¤"æŒ‰é’®</li>
<li>æœºå™¨äººå¼€å§‹æ€è€ƒå¹¶å›å¤ä½ </li>
<li>å›å¤å¯ä»¥<strong>ä¸€ä¸ªå­—ä¸€ä¸ªå­—å‡ºç°</strong>ï¼ˆæµå¼æ¨¡å¼ï¼‰ï¼Œæˆ–è€…<strong>ä¸€ä¸‹å­å…¨éƒ¨å‡ºç°</strong></li>
</ol>
<h3 data-id="heading-3">ç¬¬ä¸€éƒ¨åˆ†ï¼šç†è§£ Vue 3 çš„åŸºç¡€</h3>
<h4 data-id="heading-4">1.1 ä»€ä¹ˆæ˜¯å“åº”å¼æ•°æ®ï¼Ÿ</h4>
<p><strong>ç”Ÿæ´»ä¾‹å­</strong>ğŸ“ºï¼š
æƒ³è±¡ä½ å®¶ç”µè§†çš„é¥æ§å™¨ï¼š</p>
<ul>
<li>æŒ‰"éŸ³é‡+" â†’ ç”µè§†éŸ³é‡å˜å¤§</li>
<li>æŒ‰"é¢‘é“+" â†’ ç”µè§†æ¢å°</li>
</ul>
<p>è¿™é‡Œçš„ <strong>å“åº”å¼</strong> å°±æ˜¯ï¼šæŒ‰é¥æ§å™¨ï¼ˆæ”¹å˜æ•°æ®ï¼‰ï¼Œç”µè§†ç«‹å³å“åº”ï¼ˆé¡µé¢æ›´æ–°ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºå“åº”å¼æ•°æ®å°±åƒç»™æ•°æ®è£…ä¸Š"é¥æ§å™¨"</span>
<span class="hljs-keyword">const</span> question = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'ä½ å¥½'</span>);  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªèƒ½"é¥æ§"çš„æ•°æ®</span>

<span class="hljs-comment">// åœ¨æ¨¡æ¿ä¸­æ˜¾ç¤º</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ question }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  &lt;!-- æ˜¾ç¤ºï¼šä½ å¥½ --&gt;

<span class="hljs-comment">// å¦‚æœæ”¹å˜æ•°æ®</span>
question.<span class="hljs-property">value</span> = <span class="hljs-string">'Hello'</span>;   <span class="hljs-comment">// æŒ‰ä¸‹"é¥æ§å™¨"</span>

<span class="hljs-comment">// é¡µé¢è‡ªåŠ¨å˜æˆ</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>            &lt;!-- é¡µé¢è‡ªåŠ¨æ›´æ–°ï¼ --&gt;
</code></pre>
<h4 data-id="heading-5">1.2 <code>ref</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<p><code>ref</code> å°±æ˜¯æŠŠæ™®é€šæ•°æ®åŒ…è£…æˆä¸€ä¸ªç‰¹æ®Šçš„<strong>ç›’å­</strong>ğŸ“¦ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ™®é€šæ•°æ®</span>
<span class="hljs-keyword">let</span> name = <span class="hljs-string">"å°æ˜"</span>;  
<span class="hljs-comment">// æ”¹å˜æ—¶ï¼ŒVueä¸çŸ¥é“ï¼Œé¡µé¢ä¸ä¼šæ›´æ–°</span>

<span class="hljs-comment">// å“åº”å¼æ•°æ®</span>
<span class="hljs-keyword">const</span> nameRef = <span class="hljs-title function_">ref</span>(<span class="hljs-string">"å°æ˜"</span>);
<span class="hljs-comment">// å®é™…ä¸Šå˜æˆäº†ï¼š{ value: "å°æ˜" }</span>

<span class="hljs-comment">// è®¿é—®æ—¶è¦åŠ  .value</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nameRef.<span class="hljs-property">value</span>);  <span class="hljs-comment">// "å°æ˜"</span>

<span class="hljs-comment">// æ”¹å˜æ•°æ®</span>
nameRef.<span class="hljs-property">value</span> = <span class="hljs-string">"å°çº¢"</span>;      <span class="hljs-comment">// Vue çŸ¥é“æ•°æ®å˜äº†ï¼Œä¼šæ›´æ–°é¡µé¢</span>
</code></pre>
<h3 data-id="heading-6">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¨¡æ¿è¯­æ³•</h3>
<h4 data-id="heading-7">2.1 <code>v-model</code> - åŒå‘ç»‘å®š</h4>
<p><strong>åŒå‘ç»‘å®š</strong> å°±åƒ <strong>åŒæ­¥çš„è®°äº‹æœ¬</strong>ğŸ“ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- åˆ›å»ºä¸€ä¸ªè¾“å…¥æ¡† --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"question"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- è¿™ç›¸å½“äºåšäº†ä¸¤ä»¶äº‹ï¼š
1. è¾“å…¥æ¡†æ˜¾ç¤º question çš„å€¼
2. ä½ åœ¨è¾“å…¥æ¡†æ‰“å­—æ—¶ï¼Œè‡ªåŠ¨æ›´æ–° question çš„å€¼
--&gt;</span>
</code></pre>
<p>å®é™…æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ è¾“å…¥"ä½ å¥½"</span>
question.<span class="hljs-property">value</span> = <span class="hljs-string">"ä½ å¥½"</span>;

<span class="hljs-comment">// é¡µé¢æ˜¾ç¤º</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ä½ å¥½"</span> /&gt;</span></span>

<span class="hljs-comment">// ä½ å†è¾“å…¥"å¤§å®¶å¥½"</span>
<span class="hljs-comment">// question.value è‡ªåŠ¨å˜æˆ "å¤§å®¶å¥½"</span>
</code></pre>
<h4 data-id="heading-8">2.2 <code>@click</code> - äº‹ä»¶ç›‘å¬</h4>
<p>å°±åƒç»™æŒ‰é’®è£…ä¸Š <strong>é—¨é“ƒ</strong>ğŸ””ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"askLLM"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ„æ€æ˜¯ï¼šç‚¹å‡»è¿™ä¸ªæŒ‰é’®æ—¶ï¼Œæ‰§è¡Œ askLLM å‡½æ•° --&gt;</span>
</code></pre>
<h3 data-id="heading-9">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒåŠŸèƒ½ - è°ƒç”¨ AI</h3>
<h4 data-id="heading-10">3.1 åŸºæœ¬æµç¨‹ï¼ˆåƒç‚¹å¤–å–ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">askLLM</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// 1. å‡†å¤‡é—®é¢˜ï¼ˆåƒå†™èœå•ï¼‰</span>
  <span class="hljs-keyword">if</span> (!question.<span class="hljs-property">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é—®é¢˜ä¸èƒ½ä¸ºç©º'</span>);
    <span class="hljs-keyword">return</span>;
  }
  
  <span class="hljs-comment">// 2. æ˜¾ç¤º"æ€è€ƒä¸­..."ï¼ˆåƒæ˜¾ç¤º"å•†å®¶æ¥å•ä¸­"ï¼‰</span>
  content.<span class="hljs-property">value</span> = <span class="hljs-string">"æ€è€ƒä¸­..."</span>;
  
  <span class="hljs-comment">// 3. å‡†å¤‡å¤–å–ä¿¡æ¯</span>
  <span class="hljs-keyword">const</span> endpoint = <span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>;  <span class="hljs-comment">// å¤–å–å¹³å°åœ°å€</span>
  <span class="hljs-keyword">const</span> headers = {
    <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${ä½ çš„APIå¯†é’¥}</span>`</span>,  <span class="hljs-comment">// æ”¯ä»˜å‡­è¯</span>
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,        <span class="hljs-comment">// è¯´è¦é€JSONæ ¼å¼</span>
  };
  
  <span class="hljs-comment">// 4. ä¸‹è®¢å•</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(endpoint, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,      <span class="hljs-comment">// ç‚¹å¤–å–ç”¨POST</span>
    headers,             <span class="hljs-comment">// å‘Šè¯‰å•†å®¶ä¿¡æ¯</span>
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({  <span class="hljs-comment">// å…·ä½“è®¢å•å†…å®¹</span>
      <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
      <span class="hljs-attr">stream</span>: stream.<span class="hljs-property">value</span>,  <span class="hljs-comment">// è¦ä¸è¦æµå¼ï¼ˆåˆ†æ‰¹é€ï¼‰</span>
      <span class="hljs-attr">messages</span>: [{
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: question.<span class="hljs-property">value</span>
      }]
    })
  });
  
  <span class="hljs-comment">// 5. ç­‰å¤–å–é€åˆ°å¹¶å¤„ç†</span>
  <span class="hljs-comment">// ... åé¢è¯¦ç»†è®²</span>
}
</code></pre>
<h3 data-id="heading-11">ç¬¬å››éƒ¨åˆ†ï¼šæµå¼å“åº”è¯¦ç»†è§£é‡Š</h3>
<h4 data-id="heading-12">4.1 ä»€ä¹ˆæ˜¯"æµå¼"ï¼Ÿ</h4>
<p><strong>æ¯”å–»</strong>ğŸ¬ï¼š</p>
<ul>
<li><strong>éæµå¼</strong>ï¼šç­‰ç”µå½±å…¨éƒ¨ä¸‹è½½å®Œï¼ˆ5GBï¼‰æ‰èƒ½çœ‹</li>
<li><strong>æµå¼</strong>ï¼šä¸‹è½½ä¸€ç‚¹ï¼ˆ10MBï¼‰å°±èƒ½å¼€å§‹çœ‹ï¼Œè¾¹ä¸‹è½½è¾¹çœ‹</li>
</ul>
<p>åœ¨è¿™ä¸ªåº”ç”¨ä¸­ï¼š</p>
<ul>
<li><strong>éæµå¼</strong>ï¼šç­‰AIå…¨éƒ¨ç”Ÿæˆå®Œæ–‡å­—ï¼Œä¸€æ¬¡æ€§æ˜¾ç¤º</li>
<li><strong>æµå¼</strong>ï¼šAIç”Ÿæˆä¸€ä¸ªå­—å°±æ˜¾ç¤ºä¸€ä¸ªå­—</li>
</ul>
<h4 data-id="heading-13">4.2 æµå¼å“åº”ä»£ç è¯¦è§£ï¼ˆé€æ­¥è®²è§£ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (stream.<span class="hljs-property">value</span>) {  <span class="hljs-comment">// å¦‚æœç”¨æˆ·é€‰äº†æµå¼æ¨¡å¼</span>
  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šæ¸…ç©ºä¸Šæ¬¡çš„å›ç­”</span>
  content.<span class="hljs-property">value</span> = <span class="hljs-string">""</span>;  <span class="hljs-comment">// æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸ</span>
  
  <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šåˆ›å»º"æ°´ç®¡"å’Œ"æ°´é¾™å¤´"</span>
  <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>?.<span class="hljs-title function_">getReader</span>();  
  <span class="hljs-comment">// reader å°±åƒæ°´é¾™å¤´ï¼Œå¯ä»¥æ§åˆ¶æ°´æµ</span>
  
  <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
  <span class="hljs-comment">// decoder å°±åƒå‡€æ°´å™¨ï¼ŒæŠŠè„æ°´ï¼ˆäºŒè¿›åˆ¶ï¼‰å˜æˆå¹²å‡€æ°´ï¼ˆæ–‡å­—ï¼‰</span>
  
  <span class="hljs-keyword">let</span> done = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è®°å½•æ°´æ˜¯å¦æµå®Œäº†</span>
  <span class="hljs-keyword">let</span> buffer = <span class="hljs-string">''</span>;   <span class="hljs-comment">// ä¸´æ—¶æ°´æ¡¶ï¼Œè£…ä¸å®Œæ•´çš„æ°´</span>
  
  <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šå¼€å§‹æ¥æ°´ï¼ˆå¾ªç¯è¯»å–ï¼‰</span>
  <span class="hljs-keyword">while</span> (!done) {  <span class="hljs-comment">// åªè¦æ°´æ²¡æµå®Œå°±ä¸€ç›´æ¥</span>
    
    <span class="hljs-comment">// æ¥ä¸€ç“¢æ°´ï¼ˆè¯»ä¸€å—æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">const</span> { value, <span class="hljs-attr">done</span>: doneReading } = <span class="hljs-keyword">await</span> reader?.<span class="hljs-title function_">read</span>();
    <span class="hljs-comment">// value: æ¥åˆ°çš„æ°´ï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰</span>
    <span class="hljs-comment">// doneReading: è¿™ä¸€ç“¢æ¥å®Œäº†å—ï¼Ÿ</span>
    
    done = doneReading;  <span class="hljs-comment">// æ›´æ–°æ˜¯å¦æµå®Œçš„çŠ¶æ€</span>
    
    <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šå¤„ç†æ¥åˆ°çš„æ°´</span>
    <span class="hljs-comment">// æŠŠè¿™æ¬¡çš„æ°´å’Œä¸Šæ¬¡æ²¡å¤„ç†å®Œçš„æ°´åˆåœ¨ä¸€èµ·</span>
    <span class="hljs-keyword">const</span> chunkValue = buffer + decoder.<span class="hljs-title function_">decode</span>(value);
    buffer = <span class="hljs-string">''</span>;  <span class="hljs-comment">// æ¸…ç©ºä¸´æ—¶æ°´æ¡¶</span>
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¶åˆ°æ•°æ®:"</span>, chunkValue);
    <span class="hljs-comment">// æ•°æ®æ ¼å¼ç±»ä¼¼ï¼š</span>
    <span class="hljs-comment">// data: {"delta": {"content": "ä½ "}}</span>
    <span class="hljs-comment">// data: {"delta": {"content": "å¥½"}}</span>
    <span class="hljs-comment">// data: [DONE]</span>
    
    <span class="hljs-comment">// ç¬¬äº”æ­¥ï¼šæŠŠä¸€å¤§å—æ°´åˆ†æˆä¸€è¡Œä¸€è¡Œ</span>
    <span class="hljs-keyword">const</span> lines = chunkValue.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>)  <span class="hljs-comment">// æŒ‰æ¢è¡Œåˆ†å‰²</span>
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data: '</span>));  <span class="hljs-comment">// åªä¿ç•™ä»¥"data: "å¼€å¤´çš„è¡Œ</span>
    
    <span class="hljs-comment">// ç¬¬å…­æ­¥ï¼šå¤„ç†æ¯ä¸€è¡Œæ°´</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
      <span class="hljs-keyword">const</span> incoming = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);  <span class="hljs-comment">// å»æ‰å¼€å¤´çš„"data: "</span>
      <span class="hljs-comment">// ç°åœ¨ incoming = '{"delta": {"content": "ä½ "}}'</span>
      
      <span class="hljs-comment">// å¦‚æœæ˜¯ç»“æŸæ ‡å¿—</span>
      <span class="hljs-keyword">if</span> (incoming === <span class="hljs-string">'[DONE]'</span>) {
        done = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// åœæ­¢æ¥æ°´</span>
        <span class="hljs-keyword">break</span>;        <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span>
      }
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ç¬¬ä¸ƒæ­¥ï¼šè§£æJSONï¼ˆæŠŠæ°´å˜æˆèƒ½å–çš„ä¸œè¥¿ï¼‰</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(incoming);
        <span class="hljs-comment">// data = { delta: { content: "ä½ " } }</span>
        
        <span class="hljs-keyword">const</span> delta = data.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">delta</span>.<span class="hljs-property">content</span>;
        <span class="hljs-comment">// delta = "ä½ "</span>
        
        <span class="hljs-keyword">if</span> (delta) {
          <span class="hljs-comment">// ç¬¬å…«æ­¥ï¼šæ˜¾ç¤ºå‡ºæ¥</span>
          content.<span class="hljs-property">value</span> += delta;  <span class="hljs-comment">// æŠŠ"ä½ "åŠ åˆ°æ˜¾ç¤ºå†…å®¹é‡Œ</span>
          <span class="hljs-comment">// ç¬¬ä¸€æ¬¡ï¼šcontent = "ä½ "</span>
          <span class="hljs-comment">// ç¬¬äºŒæ¬¡ï¼šcontent = "ä½ å¥½"</span>
          <span class="hljs-comment">// ç¬¬ä¸‰æ¬¡ï¼šcontent = "ä½ å¥½ä¸–"</span>
          <span class="hljs-comment">// ... ç›´åˆ°å®Œæˆ</span>
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// å¦‚æœJSONè§£æå¤±è´¥ï¼ˆæ¯”å¦‚æ”¶åˆ°äº†ä¸å®Œæ•´çš„JSONï¼‰</span>
        buffer += <span class="hljs-string">`data: <span class="hljs-subst">${incoming}</span>`</span>;  <span class="hljs-comment">// å­˜èµ·æ¥ç­‰ä¸‹ä¸€ç“¢æ°´</span>
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-14">4.3 ä¸ºä»€ä¹ˆéœ€è¦ <code>buffer</code>ï¼Ÿ</h4>
<p><strong>æƒ…æ™¯æ¨¡æ‹Ÿ</strong>ï¼š
å‡è®¾AIè¦å›å¤"ä½ å¥½ä¸–ç•Œ"ï¼Œä½†ç½‘ç»œä¼ è¾“æ—¶å¯èƒ½è¿™æ ·ï¼š</p>
<p><strong>ç¬¬ä¸€æ¬¡æ”¶åˆ°</strong>ï¼š<code>data: {"delta": {"content": "ä½ </code>
ï¼ˆJSONä¸å®Œæ•´ï¼Œå°‘äº†å³æ‹¬å·ï¼‰</p>
<p><strong>ç¬¬äºŒæ¬¡æ”¶åˆ°</strong>ï¼š<code>å¥½ä¸–ç•Œ"}}</code></p>
<p>å¦‚æœç›´æ¥è§£æç¬¬ä¸€æ¬¡çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'{"delta": {"content": "ä½ '</span>);  <span class="hljs-comment">// æŠ¥é”™ï¼JSONä¸å®Œæ•´</span>
</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ¬¡ï¼š<code>buffer = 'data: {"delta": {"content": "ä½ '</code></li>
<li>ç¬¬äºŒæ¬¡ï¼š<code>buffer + æ–°æ•°æ® = 'data: {"delta": {"content": "ä½ å¥½ä¸–ç•Œ"}}'</code></li>
<li>ç°åœ¨å¯ä»¥æ­£ç¡®è§£æäº†</li>
</ol>
<h3 data-id="heading-15">å®Œæ•´å·¥ä½œæµç¨‹æ¼”ç¤º</h3>
<p>è®©æˆ‘ç”¨å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹å±•ç¤ºè¿™ä¸ªç³»ç»Ÿçš„ç²¾å¦™ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ç”¨æˆ·è¾“å…¥ï¼š"ä½ å¥½"</span>
<span class="hljs-comment">// æœåŠ¡å™¨å“åº”æµå¼€å§‹...</span>

<span class="hljs-comment">// ç¬¬1æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ "</span>}}\n
åˆ†å‰²æˆè¡Œ: [<span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ "</span>}}']
è§£ææˆåŠŸï¼â†’ æ˜¾ç¤ºï¼š<span class="hljs-string">"ä½ "</span>

<span class="hljs-comment">// ç¬¬2æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½
åˆ†å‰²æˆè¡Œ: ['data: {"</span>delta<span class="hljs-string">": {"</span>content<span class="hljs-string">": "</span>å¥½']
JSONè§£æå¤±è´¥ï¼â†’ å­˜å…¥buffer: <span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½'

// ç¬¬3æ¬¡å¾ªç¯ï¼š
æ”¶åˆ°æ•°æ®: "</span>}}\n
å½“å‰æ•°æ®: buffer + æ–°æ•°æ® = <span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½"</span>}}'
åˆ†å‰²æˆè¡Œ: [<span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½"</span>}}']
è§£ææˆåŠŸï¼â†’ æ˜¾ç¤ºï¼š<span class="hljs-string">"ä½ å¥½"</span>

<span class="hljs-comment">// ç¬¬4æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: [DONE]\n
æ£€æµ‹åˆ°[DONE] â†’ ç»“æŸå¾ªç¯
</code></pre>
<h3 data-id="heading-16">ç¬¬äº”éƒ¨åˆ†ï¼šå®Œæ•´äº¤äº’æµç¨‹</h3>
<pre><code class="hljs language-erlang" lang="erlang">ä½ æ‰“å¼€é¡µé¢
    â†“
çœ‹åˆ°è¾“å…¥æ¡†ï¼š[è®²ä¸€ä¸ªç¬‘è¯]
    â†“
ç‚¹å‡»<span class="hljs-string">"æäº¤"</span>
    â†“
Vueè°ƒç”¨ askLLM() å‡½æ•°
    â†“
æ˜¾ç¤º<span class="hljs-string">"æ€è€ƒä¸­..."</span>
    â†“
å‘é€è¯·æ±‚åˆ°DeepSeek
    â†“
AIå¼€å§‹æ€è€ƒ
    â†“
ã€æµå¼æ¨¡å¼ã€‘
    â†“
æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—ï¼š<span class="hljs-string">"æœ‰"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰
    â†“
æ”¶åˆ°ç¬¬äºŒä¸ªå­—ï¼š<span class="hljs-string">"ä¸ª"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰ä¸ª
    â†“
æ”¶åˆ°ç¬¬ä¸‰ä¸ªå­—ï¼š<span class="hljs-string">"äºº"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰ä¸ªäºº
    â†“
...ï¼ˆæŒç»­ï¼‰
    â†“
æ”¶åˆ°<span class="hljs-string">"[DONE]"</span>
    â†“
æ˜¾ç¤ºå®Œæ•´ï¼šæœ‰ä¸ªäººå»é¢è¯•...
</code></pre>
<h3 data-id="heading-17">ç¬¬å…­éƒ¨åˆ†ï¼šå…³é”®æ¦‚å¿µæ€»ç»“</h3>













































<table><thead><tr><th>æ¦‚å¿µ</th><th>æ¯”å–»</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>ref()</code></td><td>é¥æ§å™¨ğŸ“±</td><td>è®©æ•°æ®å˜åŒ–æ—¶é¡µé¢è‡ªåŠ¨æ›´æ–°</td></tr><tr><td><code>v-model</code></td><td>åŒå‘é•œå­ğŸª</td><td>è¾“å…¥æ¡†å’Œæ•°æ®çš„åŒå‘åŒæ­¥</td></tr><tr><td><code>@click</code></td><td>é—¨é“ƒğŸ””</td><td>ç‚¹å‡»æ—¶æ‰§è¡Œå‡½æ•°</td></tr><tr><td><code>fetch()</code></td><td>å¤–å–å°å“¥ğŸš´</td><td>å‘é€ç½‘ç»œè¯·æ±‚</td></tr><tr><td><code>getReader()</code></td><td>æ°´é¾™å¤´ğŸš°</td><td>è¯»å–æµå¼æ•°æ®</td></tr><tr><td><code>TextDecoder()</code></td><td>ç¿»è¯‘å®˜ğŸ‘¨â€ğŸ’¼</td><td>æŠŠäºŒè¿›åˆ¶å˜æˆæ–‡å­—</td></tr><tr><td><code>JSON.parse()</code></td><td>æ‹†åŒ…è£¹ğŸ“¦</td><td>æŠŠJSONå­—ç¬¦ä¸²å˜æˆå¯¹è±¡</td></tr></tbody></table>
<h3 data-id="heading-18">ç»™åˆå­¦è€…çš„å»ºè®®</h3>
<ol>
<li><strong>å…ˆç†è§£æ•´ä½“</strong>ï¼šä¸è¦ä¸€å¼€å§‹å°±é™·å…¥ç»†èŠ‚</li>
<li><strong>åˆ†å—å­¦ä¹ </strong>ï¼š
<ul>
<li>å…ˆå­¦ä¼š Vue åŸºç¡€ï¼ˆref, v-modelï¼‰</li>
<li>å†å­¦ç½‘ç»œè¯·æ±‚ï¼ˆfetchï¼‰</li>
<li>æœ€åå­¦æµå¼å¤„ç†</li>
</ul>
</li>
<li><strong>åŠ¨æ‰‹å®è·µ</strong>ï¼šä¿®æ”¹ä»£ç çœ‹çœ‹æ•ˆæœ
<ul>
<li>æŠŠ <code>stream.value</code> æ”¹æˆ <code>false</code> çœ‹çœ‹åŒºåˆ«</li>
<li>åœ¨ <code>console.log</code> é‡Œçœ‹æ•°æ®å˜åŒ–</li>
</ul>
</li>
<li><strong>é‡åˆ°é—®é¢˜</strong>ï¼šç”¨ <code>console.log()</code> æ‰“å°æ¯ä¸€æ­¥çš„ç»“æœ</li>
</ol>
<p>è¿™ä¸ªä»£ç è™½ç„¶çœ‹èµ·æ¥å¤æ‚ï¼Œä½†æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰æ˜ç¡®çš„ä½œç”¨ã€‚å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œæ¯å—ç§¯æœ¨ï¼ˆå‡½æ•°ï¼‰éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½ï¼Œç»„åˆèµ·æ¥å°±å®ç°äº†å¼ºå¤§çš„AIèŠå¤©åŠŸèƒ½ï¼ğŸ˜Š</p>
<h2 data-id="heading-19">é™„å½•ï¼šå®Œæ•´çš„Vue 3 AIæµå¼è¾“å‡ºä»£ç </h2>
<h3 data-id="heading-20">App.vue å®Œæ•´ä»£ç </h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { ref } from 'vue';

const question = ref('è®²ä¸€ä¸ªå…‰å¤´å¼ºå’Œä¸€ä¸ªç™½å¯Œç¾ä¹‹é—´çš„æ•…äº‹,20å­—');
const stream = ref(true);
const content = ref("");

const askLLM = async () =&gt; {
  if (!question.value) {
    console.log('question is empty');
    return;
  }
  
  content.value = "æ€è€ƒä¸­...";
  
  const endpoint = 'https://api.deepseek.com/chat/completions';
  const headers = {
    'Authorization': `Bearer ${import.meta.env.VITE_DEEPSEEK_API_KEY}`,
    'Content-Type': 'application/json',
  };
  
  const response = await fetch(endpoint, {
    method: 'POST',
    headers,
    body: JSON.stringify({
      model: 'deepseek-chat',
      stream: stream.value,
      messages: [{
        role: 'user',
        content: question.value
      }]
    })
  });
  
  if (stream.value) {
    content.value = "";
    const reader = response.body?.getReader();
    const decoder = new TextDecoder();
    let done = false;
    let buffer = '';
    
    while (!done) {
      const { value, done: doneReading } = await reader?.read();
      console.log(value, doneReading);
      done = doneReading;
      
      const chunkValue = buffer + decoder.decode(value);
      console.log(chunkValue);
      buffer = '';
      const lines = chunkValue.split('\n')
        .filter(line =&gt; line.startsWith('data: '));
      
      for (const line of lines) {
        const incoming = line.slice(6);
        if (incoming === '[DONE]') {
          done = true;
          break;
        }
        
        try {
          const data = JSON.parse(incoming);
          const delta = data.choices[0].delta.content;
          if (delta) {
            content.value += delta;
          }
        } catch (error) {
          buffer += `data: ${incoming}`;
        }
      }
    }
  } else {
    const data = await response.json();
    console.log(data);
    content.value = data.choices[0].message.content;
  }
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="container"&gt;
    &lt;div&gt;
      &lt;label&gt;è¾“å…¥ï¼š&lt;/label&gt;
      &lt;input class="input" v-model="question"/&gt;
      &lt;button @click="askLLM"&gt;æäº¤&lt;/button&gt;
    &lt;/div&gt;
   
    &lt;div class="output"&gt;
      &lt;div&gt;
        &lt;label&gt;Streaming&lt;/label&gt;
        &lt;input type="checkbox" v-model="stream"/&gt;
        &lt;div&gt;{{content}}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;  
&lt;/template&gt;

&lt;style scoped&gt;
* {
  margin: 0;
  padding: 0;
}
.container {
  display: flex;
  flex-direction: column;
  align-items: start;
  justify-content: start;
  height: 100vh;
  font-size: 0.85rem;
}
.input {
  width: 200px;
}
button {
  padding: 0 10px;
  margin-left: 6px;
}
.output {
  margin-top: 10px;
  min-height: 300px;
  width: 100%;
  text-align: left;
}
&lt;/style&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7603591775392923675</link>    <guid>https://juejin.cn/post/7603591775392923675</guid>    <pubDate>2026-02-07T09:09:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603591775392923675" data-draft-id="7603595309232947210" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:09:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:09:30.000Z" title="Sat Feb 07 2026 09:09:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹</h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨ JavaScript ä¸­ï¼Œ<code>new</code> æ“ä½œç¬¦æ˜¯æˆ‘ä»¬åˆ›å»ºå¯¹è±¡å®ä¾‹æœ€å¸¸ç”¨çš„æ–¹å¼ä¹‹ä¸€ã€‚ä½†ä½ çœŸçš„äº†è§£ <code>new</code> èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆå—ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥æ·±å…¥æ¢è®¨ä¸€ä¸‹ <code>new</code> çš„å¥¥ç§˜ï¼Œå¹¶äº²æ‰‹å®ç°ä¸€ä¸ªè‡ªå·±çš„ <code>new</code> å‡½æ•°ã€‚</p>
<h3 data-id="heading-2">åœ¨è§£é‡Šæ‰‹å†™newå‡½æ•°çš„ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè§£é‡Šä¸€äº›çŸ¥è¯†ç‚¹æ–¹ä¾¿æˆ‘ä»¬åé¢ç†è§£æ‰‹å†™newçš„è¿‡ç¨‹</h3>
<h3 data-id="heading-3">ä¸€ã€æ„é€ å‡½æ•°è¢«å®ä¾‹åŒ–çš„å®Œæ•´è¿‡ç¨‹</h3>
<h4 data-id="heading-4">ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ</h4>
<p>æ„é€ å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œä½†å½“æˆ‘ä»¬ä½¿ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨å®ƒæ—¶ï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ª"æ„é€ å‡½æ•°"ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</span>
<span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);  <span class="hljs-comment">// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ windowï¼‰</span>

<span class="hljs-comment">// ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span>
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);  <span class="hljs-comment">// this æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</span>
</code></pre>
<h4 data-id="heading-5">new å®ä¾‹åŒ–çš„å®Œæ•´æ­¥éª¤</h4>
<p><strong>æ¯”å–»</strong>ï¼šæƒ³è±¡ä¸€ä¸‹å·¥å‚ç”Ÿäº§äº§å“çš„è¿‡ç¨‹ï¼š</p>
<ol>
<li>å‡†å¤‡åŸææ–™ï¼ˆåˆ›å»ºç©ºå¯¹è±¡ï¼‰</li>
<li>æŒ‰ç…§è®¾è®¡å›¾çº¸åŠ å·¥ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼‰</li>
<li>è´´ä¸Šå“ç‰Œæ ‡ç­¾ï¼ˆè®¾ç½®åŸå‹é“¾ï¼‰</li>
<li>å‡ºå‚æ£€éªŒï¼ˆè¿”å›å¯¹è±¡ï¼‰</li>
</ol>
<p>å…·ä½“æ¥è¯´ï¼Œ<code>new</code> æ“ä½œç¬¦æ‰§è¡Œä»¥ä¸‹4ä¸ªæ­¥éª¤ï¼š</p>
<h5 data-id="heading-6">æ­¥éª¤1ï¼šåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = {};
</code></pre>
<h5 data-id="heading-7">æ­¥éª¤2ï¼šå°†æ–°å¯¹è±¡çš„ <code>__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code></h5>
<pre><code class="hljs language-javascript" lang="javascript">obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
</code></pre>
<h5 data-id="heading-8">æ­¥éª¤3ï¼šå°†æ„é€ å‡½æ•°çš„ <code>this</code> ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
</code></pre>
<h5 data-id="heading-9">æ­¥éª¤4ï¼šå¦‚æœæ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼›å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ˜¾å¼è¿”å›ï¼Œé»˜è®¤è¿”å› this</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person2</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">'object'</span> };  <span class="hljs-comment">// å¦‚æœè¿”å›å¯¹è±¡ï¼Œåˆ™æ›¿ä»£æ–°åˆ›å»ºçš„å¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>);  <span class="hljs-comment">// Person {name: "å¼ ä¸‰"}</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person2</span>(<span class="hljs-string">'æå››'</span>); <span class="hljs-comment">// {custom: "object"}</span>
</code></pre>
<h3 data-id="heading-10">äºŒã€applyã€call å’Œ bind çš„åŒºåˆ«</h3>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½ç”¨äºæ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ <code>this</code> æŒ‡å‘ï¼Œä½†ä½¿ç”¨æ–¹å¼ç•¥æœ‰ä¸åŒã€‚</p>
<h4 data-id="heading-11">æ¯”å–»è¯´æ˜</h4>
<p>æƒ³è±¡ä½ æ˜¯ä¸€å®¶å…¬å¸çš„CEOï¼ˆå‡½æ•°ï¼‰ï¼Œä½ éœ€è¦ç»™å‘˜å·¥ï¼ˆå¯¹è±¡ï¼‰ä¸‹è¾¾æŒ‡ä»¤ï¼š</p>
<ul>
<li><strong>call</strong>ï¼šç›´æ¥å‘Šè¯‰æŸä¸ªå‘˜å·¥è¯¥åšä»€ä¹ˆ</li>
<li><strong>apply</strong>ï¼šå‘Šè¯‰æŸä¸ªå‘˜å·¥è¯¥åšä»€ä¹ˆï¼Œå¹¶ç»™ä»–ä¸€è¢‹èµ„æ–™ï¼ˆæ•°ç»„å‚æ•°ï¼‰</li>
<li><strong>bind</strong>ï¼šé¢„å…ˆå‘Šè¯‰å‘˜å·¥ï¼Œå°†æ¥æŸä¸ªæ—¶é—´ç‚¹éœ€è¦åšä»€ä¹ˆ</li>
</ul>
<h4 data-id="heading-12">1. call æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params">greeting, punctuation</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, æˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span><span class="hljs-subst">${punctuation}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> };

<span class="hljs-comment">// call æ¥å—å‚æ•°åˆ—è¡¨</span>
introduce.<span class="hljs-title function_">call</span>(person, <span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'ï¼'</span>);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-13">2. apply æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// apply æ¥å—å‚æ•°æ•°ç»„</span>
introduce.<span class="hljs-title function_">apply</span>(person, [<span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'ï¼'</span>]);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-14">3. bind æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// bind è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> boundIntroduce = introduce.<span class="hljs-title function_">bind</span>(person, <span class="hljs-string">'ä½ å¥½'</span>);
<span class="hljs-title function_">boundIntroduce</span>(<span class="hljs-string">'ï¼'</span>);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-15">æ€»ç»“å¯¹æ¯”</h4>





























<table><thead><tr><th>æ–¹æ³•</th><th>ç«‹å³æ‰§è¡Œ</th><th>å‚æ•°å½¢å¼</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td>call</td><td>æ˜¯</td><td>å‚æ•°åˆ—è¡¨</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td></tr><tr><td>apply</td><td>æ˜¯</td><td>æ•°ç»„</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td></tr><tr><td>bind</td><td>å¦</td><td>å‚æ•°åˆ—è¡¨</td><td>æ–°å‡½æ•°</td></tr></tbody></table>
<h3 data-id="heading-16">ä¸‰ã€arguments å¯¹è±¡è¯¦è§£</h3>
<h4 data-id="heading-17">ä»€ä¹ˆæ˜¯ argumentsï¼Ÿ</h4>
<p><code>arguments</code> æ˜¯å‡½æ•°å†…éƒ¨çš„ä¸€ä¸ªç‰¹æ®Šå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†å‡½æ•°è°ƒç”¨æ—¶ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showArgs</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
}

<span class="hljs-title function_">showArgs</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// Arguments(3) [1, 2, 3]</span>
<span class="hljs-comment">// 3</span>
<span class="hljs-comment">// 1</span>
</code></pre>
<h4 data-id="heading-18">arguments çš„ç‰¹ç‚¹</h4>
<h5 data-id="heading-19">1. ç±»æ•°ç»„å¯¹è±¡ï¼ˆArray-like Objectï¼‰</h5>
<p><code>arguments</code> çœ‹èµ·æ¥åƒæ•°ç»„ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„æ•°ç»„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">checkArguments</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é•¿åº¦:'</span>, <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¯ç´¢å¼•:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>], <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>]);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ˜¯æ•°ç»„å—?'</span>, <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(<span class="hljs-variable language_">arguments</span>));  <span class="hljs-comment">// false</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç±»å‹:'</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>)); <span class="hljs-comment">// [object Arguments]</span>
}

<span class="hljs-title function_">checkArguments</span>(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>);
</code></pre>
<h5 data-id="heading-20">2. ä¸èƒ½ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tryArrayMethods</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿™äº›ä¼šæŠ¥é”™</span>
    <span class="hljs-comment">// arguments.map(item =&gt; item * 2);  // âŒ é”™è¯¯</span>
    <span class="hljs-comment">// arguments.reduce((sum, num) =&gt; sum + num);  // âŒ é”™è¯¯</span>
    
    <span class="hljs-comment">// ä½†å¯ä»¥è¿™æ ·éå†</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[i]);
    }
    
    <span class="hljs-comment">// æˆ–è€…ç”¨ for...ofï¼ˆES6+ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> arg <span class="hljs-keyword">of</span> <span class="hljs-variable language_">arguments</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg);
    }
}
</code></pre>
<h4 data-id="heading-21">å¦‚ä½•å°† arguments è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Ÿ</h4>
<h5 data-id="heading-22">æ–¹æ³•1ï¼šArray.from (ES6)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments1</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(argsArray.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x * <span class="hljs-number">2</span>));  <span class="hljs-comment">// å¯ä»¥æ­£å¸¸ä½¿ç”¨æ•°ç»„æ–¹æ³•</span>
}
</code></pre>
<h5 data-id="heading-23">æ–¹æ³•2ï¼šæ‰©å±•è¿ç®—ç¬¦ (ES6)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments2</span>(<span class="hljs-params">...args</span>) {  <span class="hljs-comment">// ç›´æ¥åœ¨å‚æ•°ä¸­ä½¿ç”¨</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(args));  <span class="hljs-comment">// true</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments3</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = [...<span class="hljs-variable language_">arguments</span>];
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
}
</code></pre>
<h5 data-id="heading-24">æ–¹æ³•3ï¼šArray.prototype.slice.call (ES5)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments4</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
}
</code></pre>
<h4 data-id="heading-25">arguments çš„æ³¨æ„äº‹é¡¹</h4>
<ol>
<li><strong>ç®­å¤´å‡½æ•°æ²¡æœ‰ arguments</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">arrowFunc</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);  <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šarguments is not defined</span>
};

<span class="hljs-comment">// ç®­å¤´å‡½æ•°åº”è¯¥è¿™æ ·è·å–å‚æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">arrowFunc2</span> = (<span class="hljs-params">...args</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
};
</code></pre>
<ol start="2">
<li><strong>arguments å’Œå‚æ•°å˜é‡è”åŠ¨</strong>ï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">linkedArguments</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
    
    a = <span class="hljs-string">'changed'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¿®æ”¹å a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
    
    <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">'changed again'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å†æ¬¡ä¿®æ”¹å a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
}

<span class="hljs-title function_">linkedArguments</span>(<span class="hljs-string">'original'</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// a: original arguments[0]: original</span>
<span class="hljs-comment">// ä¿®æ”¹å a: changed arguments[0]: changed</span>
<span class="hljs-comment">// å†æ¬¡ä¿®æ”¹å a: changed again arguments[0]: changed again</span>
</code></pre>
<h3 data-id="heading-26">å››ã€å¼€å§‹æ‰‹å†™å®ç° new æ“ä½œç¬¦</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»“åˆä»¥ä¸ŠçŸ¥è¯†ç‚¹ï¼Œä¸€æ­¥æ­¥å®ç°è‡ªå·±çš„ <code>new</code> å‡½æ•°ã€‚</p>
<h4 data-id="heading-27">åŸºç¡€ç‰ˆæœ¬å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</span>
    <span class="hljs-keyword">const</span> obj = {};
    
    <span class="hljs-comment">// 2. å°†æ–°å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹</span>
    obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. å°†æ„é€ å‡½æ•°çš„ this ç»‘å®šåˆ°æ–°å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°</span>
    <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 4. è¿”å›æ–°å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> obj;
}
</code></pre>
<h4 data-id="heading-28">å¢å¼ºç‰ˆæœ¬ï¼ˆå¤„ç†æ„é€ å‡½æ•°è¿”å›å€¼ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¹¶è®¾ç½®åŸå‹é“¾</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®š this</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 3. åˆ¤æ–­æ„é€ å‡½æ•°è¿”å›çš„æ˜¯å¦æ˜¯å¯¹è±¡</span>
    <span class="hljs-comment">// å¦‚æœæ˜¯å¯¹è±¡åˆ™è¿”å›è¯¥å¯¹è±¡ï¼Œå¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span> ? result : obj;
}
</code></pre>
<h4 data-id="heading-29">å®Œæ•´å®ç°ï¼ˆå…¼å®¹ ES5ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. è·å–æ„é€ å‡½æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Constructor</span> = [].<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 2. åˆ›å»ºç©ºå¯¹è±¡ï¼Œå¹¶ç»§æ‰¿æ„é€ å‡½æ•°çš„åŸå‹</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 3. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå°† this æŒ‡å‘æ–°å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, <span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 4. è¿”å›ç»“æœ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> ? result : obj;
}
</code></pre>
<h4 data-id="heading-30">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>ï¼Œä»Šå¹´<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span>å²`</span>);
};

<span class="hljs-comment">// ä½¿ç”¨åŸç”Ÿçš„ new</span>
<span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);
person1.<span class="hljs-title function_">sayHello</span>();  <span class="hljs-comment">// "ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰ï¼Œä»Šå¹´18å²"</span>

<span class="hljs-comment">// ä½¿ç”¨æˆ‘ä»¬æ‰‹å†™çš„ objectFactory</span>
<span class="hljs-keyword">const</span> person2 = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'æå››'</span>, <span class="hljs-number">20</span>);
person2.<span class="hljs-title function_">sayHello</span>();  <span class="hljs-comment">// "ä½ å¥½ï¼Œæˆ‘æ˜¯æå››ï¼Œä»Šå¹´20å²"</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person1.<span class="hljs-property">sayHello</span> === person2.<span class="hljs-property">sayHello</span>);  <span class="hljs-comment">// trueï¼ˆå…±äº«åŸå‹æ–¹æ³•ï¼‰</span>
</code></pre>
<h4 data-id="heading-31">å¤„ç†ç‰¹æ®Šæƒ…å†µ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ„é€ å‡½æ•°è¿”å›å¯¹è±¡çš„æƒ…å†µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">model</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">'special object'</span> };  <span class="hljs-comment">// è¿”å›å¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> car = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Car</span>, <span class="hljs-string">'Tesla'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car);  <span class="hljs-comment">// {custom: "special object"}ï¼Œè€Œä¸æ˜¯ Car å®ä¾‹</span>

<span class="hljs-comment">// 2. æ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹çš„æƒ…å†µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Bike</span>(<span class="hljs-params">brand</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'not an object'</span>;  <span class="hljs-comment">// è¿”å›åŸºæœ¬ç±»å‹ï¼Œä¼šè¢«å¿½ç•¥</span>
}

<span class="hljs-keyword">const</span> bike = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Bike</span>, <span class="hljs-string">'Giant'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bike);  <span class="hljs-comment">// Bike {brand: "Giant"}ï¼Œè¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
</code></pre>
<h3 data-id="heading-32">äº”ã€å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-33">1. åº“æˆ–æ¡†æ¶ä¸­çš„ä½¿ç”¨</h4>
<p>è®¸å¤šåº“ï¼ˆå¦‚æ—©æœŸçš„ jQueryï¼‰ä¼šä½¿ç”¨ç±»ä¼¼çš„æŠ€æœ¯æ¥åˆ›å»ºå¯¹è±¡ï¼Œé¿å…ä½¿ç”¨ <code>new</code> å…³é”®å­—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// jQuery é£æ ¼çš„åˆå§‹åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">jQuery</span>(selector);
}

<span class="hljs-comment">// æˆ–è€…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">objectFactory</span>(jQuery, selector);
}
</code></pre>
<h4 data-id="heading-34">2. åˆ›å»ºå¯¹è±¡æ± </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createObjectPool</span>(<span class="hljs-params">Constructor, count</span>) {
    <span class="hljs-keyword">const</span> pool = [];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
        pool.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Constructor</span>));
    }
    
    <span class="hljs-keyword">return</span> pool;
}

<span class="hljs-comment">// åˆ›å»º 10 ä¸ªé»˜è®¤çš„ Person å¯¹è±¡</span>
<span class="hljs-keyword">const</span> personPool = <span class="hljs-title function_">createObjectPool</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-number">10</span>);
</code></pre>
<h4 data-id="heading-35">3. å®ç°å•ä¾‹æ¨¡å¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">singleton</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-keyword">let</span> instance = <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!instance) {
            instance = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Constructor</span>, ...args);
        }
        <span class="hljs-keyword">return</span> instance;
    };
}

<span class="hljs-keyword">const</span> getSingletonPerson = <span class="hljs-title function_">singleton</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'å•ä¾‹'</span>, <span class="hljs-number">100</span>);
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title function_">getSingletonPerson</span>();
<span class="hljs-keyword">const</span> p2 = <span class="hljs-title function_">getSingletonPerson</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1 === p2);  <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-36">æ€»ç»“</h3>
<p>é€šè¿‡æ‰‹å†™ <code>new</code> æ“ä½œç¬¦ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº† JavaScript å¯¹è±¡å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºç©ºå¯¹è±¡</strong>ï¼šå»ºç«‹å¯¹è±¡çš„"è‚‰èº«"</li>
<li><strong>è®¾ç½®åŸå‹é“¾</strong>ï¼šè¿æ¥å¯¹è±¡çš„"çµé­‚"ï¼ˆç»§æ‰¿ï¼‰</li>
<li><strong>æ‰§è¡Œæ„é€ å‡½æ•°</strong>ï¼šèµ‹äºˆå¯¹è±¡"ä¸ªæ€§"ï¼ˆå±æ€§ï¼‰</li>
<li><strong>è¿”å›å¯¹è±¡</strong>ï¼šå†³å®šæœ€ç»ˆ"å‡ºå‚"çš„æ˜¯ä»€ä¹ˆ</li>
</ol>
<p>ç†è§£è¿™äº›åº•å±‚æœºåˆ¶ï¼Œä¸ä»…å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ä½¿ç”¨ JavaScriptï¼Œè¿˜èƒ½åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ç§"çŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶"çš„å­¦ä¹ æ–¹å¼ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨é¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œæœ‰èƒ½åŠ›ä»åº•å±‚åŸç†å‡ºå‘ï¼Œæ‰¾åˆ°æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>è®°ä½ï¼Œæ¯ä¸ªçœ‹ä¼¼ç®€å•çš„ <code>new</code> èƒŒåï¼Œéƒ½éšè—ç€ JavaScript åŸå‹é“¾ã€<code>this</code> ç»‘å®šã€å‡½æ•°æ‰§è¡Œç­‰å¤šä¸ªæ ¸å¿ƒæ¦‚å¿µçš„å®Œç¾åä½œã€‚æŒæ¡äº†è¿™äº›ï¼Œä½ å°±çœŸæ­£ç†è§£äº† JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç²¾é«“ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…]]></title>    <link>https://juejin.cn/post/7603575763787743258</link>    <guid>https://juejin.cn/post/7603575763787743258</guid>    <pubDate>2026-02-07T09:20:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603575763787743258" data-draft-id="7603567912593653787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº&quot;å®¶æ—ä¼ æ‰¿&quot;çš„ç¼–ç¨‹ä¹‹æ—…"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:20:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:20:52.000Z" title="Sat Feb 07 2026 09:20:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…</h2>
<h3 data-id="heading-1">å¼•è¨€ï¼šJavaScriptçš„"ä¸ä¼—ä¸åŒ"</h3>
<p>åœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œç»§æ‰¿ä¸æ˜¯ç®€å•çš„å¤åˆ¶ç²˜è´´ï¼Œè€Œæ˜¯ä¸€åœºå…³äº"åŸå‹é“¾"çš„å¥‡å¦™å†’é™©ã€‚æƒ³è±¡ä¸€ä¸‹ï¼šåˆ«çš„è¯­è¨€ç»§æ‰¿å°±åƒé¢†å…»å­©å­ï¼Œç›´æ¥ç»™ä¸€å¥—æ–°æˆ¿å­å’Œæ–°è¡£æœï¼›è€ŒJavaScriptçš„ç»§æ‰¿æ›´åƒæ˜¯å®¶æ—ä¼ æ‰¿â€”â€”å­©å­ä¸ä»…æœ‰è‡ªå·±çš„å®¶ï¼Œè¿˜èƒ½éšæ—¶å»ç¥–è¾ˆå®¶é‡Œä¸²é—¨æ‹¿ä¸œè¥¿ï¼</p>
<p>ä»Šå¤©ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·æ­å¼€JavaScriptç»§æ‰¿çš„ç¥ç§˜é¢çº±ï¼Œäº²æ‰‹æ‰“é€ ä¸€ä¸ªå±äºè‡ªå·±çš„"å®¶æ—ä¼ æ‰¿"ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-2">ä¸€ã€åŸå‹é“¾ç»§æ‰¿ï¼šç›´æˆªäº†å½“çš„"å®¶æ—ä¼ä¸š"</h3>
<p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹JavaScriptä¸­æœ€"æœ´å®"çš„ç»§æ‰¿æ–¹å¼ã€‚</p>
<h4 data-id="heading-3">ä¸€ä¸ªåŠ¨ç‰©ç‹å›½çš„æ•…äº‹</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>Animal</code>ï¼ˆåŠ¨ç‰©ï¼‰å®¶æ—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;   <span class="hljs-comment">// åå­—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;     <span class="hljs-comment">// å¹´é¾„</span>
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;  <span class="hljs-comment">// æ‰€æœ‰åŠ¨ç‰©éƒ½æœ‰çš„ç‰©ç§å±æ€§</span>
</code></pre>
<p>ç°åœ¨ï¼Œ<code>Cat</code>ï¼ˆçŒ«ï¼‰å®¶æ—æƒ³è¦ç»§æ‰¿<code>Animal</code>å®¶æ—çš„ä¼˜è‰¯ä¼ ç»Ÿã€‚æœ€ç®€å•çš„åšæ³•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h4 data-id="heading-4">æ–¹æ³•ä¸€ï¼šç›´æ¥"è®¤ç¥–å½’å®—"</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// å…ˆæŠŠAnimalå®¶æ—çš„åŸºæœ¬åŠŸå­¦è¿‡æ¥</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;  <span class="hljs-comment">// çŒ«ç‰¹æœ‰çš„æ¯›è‰²</span>
}

<span class="hljs-comment">// å…³é”®ä¸€æ­¥ï¼šæˆä¸ºAnimalå®¶æ—çš„"äº²ä¼ å¼Ÿå­"</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-comment">// ä½†åˆ«å¿˜äº†æ”¹ä¸ªåï¼Œä¸ç„¶åˆ«äººè¿˜ä»¥ä¸ºä½ æ˜¯Animal</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;

<span class="hljs-keyword">const</span> garfield = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'é»„è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(garfield.<span class="hljs-property">species</span>);  <span class="hljs-comment">// âœ… è¾“å‡ºï¼šåŠ¨ç‰©ï¼ˆæˆåŠŸç»§æ‰¿äº†ç‰©ç§ï¼ï¼‰</span>
</code></pre>
<p><strong>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><code>Cat.prototype = new Animal()</code>ï¼šç›¸å½“äºCatå®¶æ—æŠŠAnimalè¯·æ¥å½“é¡¾é—®</li>
<li>ç°åœ¨æ‰€æœ‰Catéƒ½å¯ä»¥é€šè¿‡"é¡¾é—®"è®¿é—®Animalå®¶æ—çš„èµ„æº</li>
</ul>
<h4 data-id="heading-5">ä½†è¿™ç§åšæ³•æœ‰ä¸ªå¤§é—®é¢˜...</h4>
<p><strong>åœºæ™¯æƒ³è±¡</strong>ï¼šä½ æƒ³è¯·Animalå½“é¡¾é—®ï¼Œç»“æœäººå®¶æ‹–å®¶å¸¦å£ã€æŠŠå…¨éƒ¨å®¶å½“éƒ½æ¬æ¥äº†ï¼<code>new Animal()</code>åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„Animalå®ä¾‹ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„ä»…ä»…æ˜¯Animalçš„"çŸ¥è¯†åº“"ï¼ˆåŸå‹ï¼‰ï¼Œè€Œä¸æ˜¯å®ƒçš„å…¨éƒ¨èº«å®¶ã€‚</p>
<p><strong>ä¸‰å¤§ç—›ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æµªè´¹å†…å­˜</strong>ï¼šAnimalå®ä¾‹å¯èƒ½å¾ˆå¤§ï¼Œä½†Catåªéœ€è¦å®ƒçš„åŸå‹</li>
<li><strong>å‚æ•°å°´å°¬</strong>ï¼š<code>new Animal()</code>æ—¶éœ€è¦å‚æ•°ï¼Œä½†ä½œä¸ºåŸå‹æ—¶ä¸çŸ¥é“ä¼ ä»€ä¹ˆ</li>
<li><strong>æ•ˆç‡ä½ä¸‹</strong>ï¼šæ¯æ¬¡ç»§æ‰¿éƒ½è¦åˆ›å»ºä¸€ä¸ªå¯èƒ½æ°¸è¿œç”¨ä¸ç€çš„å®ä¾‹</li>
</ol>
<h3 data-id="heading-6">äºŒã€èµ°æ·å¾„çš„è¯±æƒ‘ï¼šç›´æ¥"å…±äº«å®¶è°±"</h3>
<p>æœ‰äººå¯èƒ½æƒ³ï¼š"æ—¢ç„¶åªæ˜¯è¦åŸå‹ï¼Œé‚£ç›´æ¥å…±äº«ä¸å°±è¡Œäº†ï¼Ÿ"</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çœ‹ä¼¼èªæ˜çš„å·æ‡’æ–¹æ³•</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;
</code></pre>
<p><strong>å±é™©ï¼è¿™æ˜¯ä¸ªé™·é˜±ï¼</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çŒ«å®¶æ—æƒ³ç»™è‡ªå·±åŠ ä¸ªæŠ€èƒ½</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eatFish</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆ‘çˆ±åƒé±¼ï¼'</span>);
};

<span class="hljs-comment">// ä½†æ„å¤–å‘ç”Ÿäº†...</span>
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">'æ—ºè´¢'</span>, <span class="hljs-number">3</span>);
dog.<span class="hljs-title function_">eatFish</span>();  <span class="hljs-comment">// ğŸ˜± è¾“å‡ºï¼šæˆ‘çˆ±åƒé±¼ï¼ï¼ˆç‹—æ€ä¹ˆçˆ±åƒé±¼äº†ï¼Ÿï¼ï¼‰</span>
</code></pre>
<p><strong>é—®é¢˜æ‰€åœ¨</strong>ï¼š</p>
<ul>
<li><code>Cat.prototype</code>å’Œ<code>Animal.prototype</code>æŒ‡å‘<strong>åŒä¸€ä¸ªå¯¹è±¡</strong></li>
<li>ç»™Catæ·»åŠ æ–¹æ³•ï¼ŒAnimalä¹Ÿä¼š"è¢«å­¦ä¼š"</li>
<li>å°±åƒä¸¤ä¸ªéƒ¨é—¨å…±ç”¨åŒä¸€ä¸ªå°ç« ï¼Œä¸€æ–¹ä¿®æ”¹ï¼Œå¦ä¸€æ–¹é­æ®ƒ</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€ç»ˆææ–¹æ¡ˆï¼šèªæ˜çš„"ä¸­é—´äºº"ç­–ç•¥</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ—¢èƒ½ç»§æ‰¿çŸ¥è¯†ï¼Œåˆä¸é€ æˆæ··ä¹±çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„"ç©ºå‡½æ•°ä¸­ä»‹"æ¨¡å¼â€”â€”ä¸€ä¸ªèªæ˜çš„"ä¼ è¯ç­’"ã€‚</p>
<h4 data-id="heading-8">æ‰‹å†™extendså‡½æ•°ï¼šæ‰“é€ å®Œç¾çš„å®¶æ—ä¼ æ‰¿</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">Parent, Child</span>) {
    <span class="hljs-comment">// 1. è¯·ä¸€ä¸ª"ä¸­é—´äºº"ï¼ˆç©ºå‡½æ•°Fï¼‰</span>
    <span class="hljs-comment">// å®ƒå°±åƒå®¶æ—é—´çš„ä¸“ä¸šç¿»è¯‘ï¼Œåªä¼ è¯ï¼Œä¸æ·»ä¹±</span>
    <span class="hljs-keyword">var</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
    
    <span class="hljs-comment">// 2. è®©ä¸­é—´äººå­¦ä¹ Parentçš„çŸ¥è¯†åº“</span>
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. è®©Childæ‹œä¸­é—´äººä¸ºå¸ˆ</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
    
    <span class="hljs-comment">// 4. ç»™Childæ­£åï¼šä½ å§“Childï¼Œä¸æ˜¯Parent</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
}
</code></pre>
<h4 data-id="heading-9">æ¥çœ‹çœ‹è¿™ä¸ªç²¾å¦™çš„ä¼ æ‰¿ç³»ç»Ÿå¦‚ä½•å·¥ä½œ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨æˆ‘ä»¬çš„extendå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// ç»§æ‰¿Animalçš„"ä¸ªäººèƒ½åŠ›"</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [name, age]);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;  <span class="hljs-comment">// çŒ«çš„ç‹¬æœ‰ç‰¹å¾</span>
}

<span class="hljs-comment">// å¯åŠ¨ä¼ æ‰¿ä»ªå¼ï¼</span>
<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Animal</span>, <span class="hljs-title class_">Cat</span>);

<span class="hljs-comment">// çŒ«å®¶æ—å‘å±•è‡ªå·±çš„ç‰¹è‰²</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">purr</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å–µå‘œ~å‘å‡ºå‘¼å™œå£°'</span>);
};

<span class="hljs-comment">// è§è¯å¥‡è¿¹çš„æ—¶åˆ»</span>
<span class="hljs-keyword">const</span> kitty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°æ©˜'</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(kitty.<span class="hljs-property">species</span>);  <span class="hljs-comment">// âœ… "åŠ¨ç‰©"ï¼ˆç»§æ‰¿äº†Animalçš„ç‰©ç§ï¼‰</span>
kitty.<span class="hljs-title function_">purr</span>();               <span class="hljs-comment">// âœ… "å–µå‘œ~å‘å‡ºå‘¼å™œå£°"ï¼ˆçŒ«çš„ç‹¬æœ‰æŠ€èƒ½ï¼‰</span>

<span class="hljs-keyword">const</span> bird = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">'å°é¸Ÿ'</span>, <span class="hljs-number">0.5</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bird.<span class="hljs-property">purr</span>);     <span class="hljs-comment">// âœ… undefinedï¼ˆå®Œå…¨æ²¡å½±å“åˆ°Animalï¼ï¼‰</span>
</code></pre>
<h4 data-id="heading-10">ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ¡ˆå¦‚æ­¤ä¼˜é›…ï¼Ÿ</h4>
<p><strong>ä¸‰å±‚éš”ç¦»ä¿æŠ¤</strong>ï¼š</p>
<ol>
<li><strong>ç¬¬ä¸€å±‚</strong>ï¼šCatæœ‰è‡ªå·±çš„åŸå‹å¯¹è±¡</li>
<li><strong>ç¬¬äºŒå±‚</strong>ï¼šé€šè¿‡ä¸­é—´äººFè®¿é—®Animalçš„åŸå‹</li>
<li><strong>ç¬¬ä¸‰å±‚</strong>ï¼šå¯¹CatåŸå‹çš„ä¿®æ”¹å®Œå…¨ä¸å½±å“Animal</li>
</ol>
<p><strong>å†…å­˜å…³ç³»å›¾</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">kittyï¼ˆçŒ«å®ä¾‹ï¼‰
    â†“ <span class="hljs-string">"æˆ‘å¯ä»¥æ‰¾æˆ‘çš„å®¶æ—è¦ä¸œè¥¿"</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆçŒ«å®¶æ—çŸ¥è¯†åº“ï¼‰
    â†“ <span class="hljs-string">"æˆ‘å­¦è‡ªä¸­é—´äººF"</span>
F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆ= <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼‰
    â†“ <span class="hljs-string">"æˆ‘æ¥è‡ªAnimalå®¶æ—"</span>
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆåŠ¨ç‰©å®¶æ—çŸ¥è¯†åº“ï¼‰
    â†“ <span class="hljs-string">"æˆ‘æ˜¯æ‰€æœ‰å¯¹è±¡çš„èµ·ç‚¹"</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
</code></pre>
<h3 data-id="heading-11">å››ã€å®Œæ•´å®æˆ˜ï¼šæ‰“é€ åŠ¨ç‰©ä¸–ç•Œçš„ç»§æ‰¿ä½“ç³»</h3>
<p>è®©æˆ‘ä»¬æŠŠç†è®ºå˜æˆå®æˆ˜ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¢å¼ºç‰ˆextendï¼šæ›´æ™ºèƒ½çš„ä¼ æ‰¿ç³»ç»Ÿ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">Child, Parent</span>) {
    <span class="hljs-comment">// 1. è¯·ä¸“ä¸šä¸­é—´äººï¼ˆå¼€é”€æå°ï¼‰</span>
    <span class="hljs-keyword">var</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
    
    <span class="hljs-comment">// 2. ä¸­é—´äººå­¦ä¹ Parentçš„å…¨éƒ¨çŸ¥è¯†</span>
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. Childæ‹œå¸ˆå­¦è‰º</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
    
    <span class="hljs-comment">// 4. ç»™Childä¸€ä¸ª"å®¶è°±"ï¼ˆå¯é€‰ä½†å¾ˆè´´å¿ƒï¼‰</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property">uber</span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 5. ç°ä»£JavaScriptçš„é¢å¤–æ”¯æŒ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property">setPrototypeOf</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    }
}

<span class="hljs-comment">// åŠ¨ç‰©å®¶æ—åŸºç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">breathe</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”'</span>;
};

<span class="hljs-comment">// çŒ«å®¶æ—</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// å…ˆå­¦Animalçš„"ç”Ÿå­˜æŠ€èƒ½"</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// å¯åŠ¨ä¼ æ‰¿</span>
<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Cat</span>, <span class="hljs-title class_">Animal</span>);

<span class="hljs-comment">// çŒ«å®¶æ—çš„ç‹¬é—¨ç»æŠ€</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">climbTree</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼'</span>;
};

<span class="hljs-comment">// çœ‹çœ‹æˆæœ</span>
<span class="hljs-keyword">const</span> tom = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'æ±¤å§†'</span>, <span class="hljs-number">3</span>, <span class="hljs-string">'è“ç°è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-title function_">breathe</span>());    <span class="hljs-comment">// âœ… "æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-title function_">climbTree</span>());  <span class="hljs-comment">// âœ… "æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-property">color</span>);        <span class="hljs-comment">// âœ… "è“ç°è‰²"</span>
</code></pre>
<h3 data-id="heading-12">äº”ã€ç°ä»£JavaScriptï¼šè¯­æ³•ç³–èƒŒåçš„çœŸç›¸</h3>
<p>ES6ç»™äº†æˆ‘ä»¬æ›´ä¼˜é›…çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
    }
    
    <span class="hljs-title function_">breathe</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”'</span>;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age, color</span>) {
        <span class="hljs-variable language_">super</span>(name, age);  <span class="hljs-comment">// è¿™è¡Œç›¸å½“äº Animal.call(this, name, age)</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
    }
    
    <span class="hljs-title function_">climbTree</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼'</span>;
    }
}
</code></pre>
<p><strong>é‡è¦æé†’</strong>ï¼š<code>class</code>åªæ˜¯"è¯­æ³•ç³–"ï¼Œåº•å±‚ä¾ç„¶æ˜¯æˆ‘ä»¬çš„åŸå‹ç»§æ‰¿ã€‚ç†è§£åŸå‹ï¼Œæ‰èƒ½çœŸæ­£æŒæ¡JavaScriptçš„ç»§æ‰¿ç²¾é«“ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“ï¼šç»§æ‰¿çš„æ™ºæ…§</h3>
<p>é€šè¿‡è¿™æ¬¡æ¢ç´¢ï¼Œæˆ‘ä»¬å­¦åˆ°äº†ï¼š</p>
<ol>
<li><strong>åŸå‹å®ä¾‹åŒ–ç»§æ‰¿</strong> â†’ ç®€å•ç²—æš´ä½†ç¬¨é‡ï¼ˆè¯·æ•´ä¸ªå®¶æ—å½“é¡¾é—®ï¼‰</li>
<li><strong>ç›´æ¥åŸå‹ç»§æ‰¿</strong> â†’ å±é™©æ·å¾„ï¼ˆå…±ç”¨å®¶è°±ï¼Œä¸€æŸä¿±æŸï¼‰</li>
<li><strong>ç©ºå‡½æ•°ä¸­ä»‹æ¨¡å¼</strong> â†’ ä¼˜é›…æ–¹æ¡ˆï¼ˆä¸“ä¸šä¸­é—´äººï¼Œéš”ç¦»åˆé«˜æ•ˆï¼‰</li>
</ol>
<p><strong>ç¼–ç¨‹å°±åƒå®¶æ—ä¼ æ‰¿</strong>ï¼š</p>
<ul>
<li>å¥½çš„ç»§æ‰¿åº”è¯¥åƒå®¶è®­ä¼ æ‰¿ï¼šåä»£å­¦ä¹ å‰è¾ˆçš„æ™ºæ…§ï¼Œä½†æœ‰è‡ªå·±çš„å‘å±•</li>
<li>åçš„ç»§æ‰¿å°±åƒè´¢äº§çº çº·ï¼šè¾¹ç•Œä¸æ¸…ï¼Œäº’ç›¸å½±å“</li>
<li>æˆ‘ä»¬çš„<code>extend</code>å‡½æ•°å°±åƒæ˜¯æ‰¾åˆ°äº†å®Œç¾çš„å®¶æ—ä¿¡æ‰˜æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-14">è¿›é˜¶æ€è€ƒ</h3>
<p>å¦‚æœä½ è¦ç»§ç»­ä¼˜åŒ–è¿™ä¸ª<code>extend</code>å‡½æ•°ï¼Œä½ ä¼šæ·»åŠ å“ªäº›åŠŸèƒ½ï¼Ÿ</p>
<ol>
<li><strong>å¤šé‡ç»§æ‰¿</strong>ï¼šåƒç»§æ‰¿å¤šä¸ªå®¶æ—çš„ä¼˜ç§€åŸºå› ï¼Ÿ</li>
<li><strong>æ–¹æ³•æ··å…¥</strong>ï¼šåƒé€‰æ‹©æ€§å­¦ä¹ ä¸åŒå¸ˆçˆ¶çš„ç»æ‹›ï¼Ÿ</li>
<li><strong>é™æ€æ–¹æ³•ç»§æ‰¿</strong>ï¼šè¿å®¶æ—çš„ä¼ ç»Ÿä»ªå¼ä¹Ÿä¸€èµ·ç»§æ‰¿ï¼Ÿ</li>
</ol>
<hr/>
<p><strong>åŠ¨æ‰‹æŒ‘æˆ˜</strong>ï¼šå°è¯•å®ç°ä¸€ä¸ªæ”¯æŒå¤šé‡ç»§æ‰¿çš„<code>extend</code>å‡½æ•°ï¼Œè®©ä¸€ä¸ªç±»å¯ä»¥åŒæ—¶ç»§æ‰¿å¤šä¸ªçˆ¶ç±»çš„ç‰¹æ€§ã€‚æŠŠä½ çš„ä»£ç åˆ†äº«åˆ°è¯„è®ºåŒºï¼Œçœ‹çœ‹è°çš„å®ç°æœ€ä¼˜é›…ï¼</p>
<p><strong>è®°ä½</strong>ï¼šåœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œç†è§£åŸå‹é“¾å°±åƒæŒæ¡å®¶æ—çš„ç§˜å¯†é€šé“ã€‚é€šè¿‡è¿™äº›é€šé“ï¼Œä½ å¯ä»¥åœ¨ä¸ç ´ååŸæœ‰ç»“æ„çš„å‰æä¸‹ï¼Œæ„å»ºå‡ºå¼ºå¤§è€Œçµæ´»çš„ä»£ç "å®¶æ—"ã€‚ç°åœ¨ï¼Œä½ ä¹Ÿæ˜¯æŒæ¡è¿™ä¸ªç§˜å¯†çš„å¼€å‘è€…äº†ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜]]></title>    <link>https://juejin.cn/post/7603616672927088655</link>    <guid>https://juejin.cn/post/7603616672927088655</guid>    <pubDate>2026-02-07T09:57:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672927088655" data-draft-id="7603588665568100392" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜"/> <meta itemprop="keywords" content="Java,JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:57:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="echoVic"/> <meta itemprop="url" content="https://juejin.cn/user/729731451069998"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731451069998/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    echoVic
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:57:09.000Z" title="Sat Feb 07 2026 09:57:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ˜¯ blade-code æŠ€æœ¯æ·±åº¦ç³»åˆ—çš„ç¬¬ 1 ç¯‡ï¼Œæ·±å…¥å‰–æå¦‚ä½•ä»é›¶å®ç°ä¸€ä¸ªç”Ÿäº§çº§çš„ MCPï¼ˆModel Context Protocolï¼‰å®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬è¿æ¥ç®¡ç†ã€OAuth è®¤è¯ã€å¥åº·ç›‘æ§ã€å·¥å…·æ³¨å†Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ç›®å½•</h2>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-mcp" title="#%E4%BB%80%E4%B9%88%E6%98%AF-mcp">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</a></li>
<li><a href="#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1" title="#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">æ¶æ„è®¾è®¡</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0" title="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0">æ ¸å¿ƒå®ç°</a>
<ul>
<li><a href="#1-mcpclient%E8%BF%9E%E6%8E%A5%E4%B8%8E%E9%80%9A%E4%BF%A1" title="#1-mcpclient%E8%BF%9E%E6%8E%A5%E4%B8%8E%E9%80%9A%E4%BF%A1">1. McpClientï¼šè¿æ¥ä¸é€šä¿¡</a></li>
<li><a href="#2-mcpregistry%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86" title="#2-mcpregistry%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86">2. McpRegistryï¼šæœåŠ¡å™¨ç®¡ç†</a></li>
<li><a href="#3-oauth-%E8%AE%A4%E8%AF%81" title="#3-oauth-%E8%AE%A4%E8%AF%81">3. OAuth è®¤è¯</a></li>
<li><a href="#4-%E5%81%A5%E5%BA%B7%E7%9B%91%E6%8E%A7" title="#4-%E5%81%A5%E5%BA%B7%E7%9B%91%E6%8E%A7">4. å¥åº·ç›‘æ§</a></li>
</ul>
</li>
<li><a href="#%E5%B7%A5%E5%85%B7%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C" title="#%E5%B7%A5%E5%85%B7%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C">å·¥å…·åŠ¨æ€æ³¨å†Œ</a></li>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%8E%E9%87%8D%E8%BF%9E" title="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%8E%E9%87%8D%E8%BF%9E">é”™è¯¯å¤„ç†ä¸é‡è¿</a></li>
<li><a href="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">å®æˆ˜æ¡ˆä¾‹</a></li>
<li><a href="#%E6%80%BB%E7%BB%93" title="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</h2>
<p>MCPï¼ˆModel Context Protocolï¼‰æ˜¯ Anthropic æ¨å‡ºçš„å¼€æ”¾åè®®ï¼Œç”¨äº AI åº”ç”¨ä¸å¤–éƒ¨å·¥å…·/æ•°æ®æºçš„æ ‡å‡†åŒ–é€šä¿¡ã€‚å®ƒè§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>å·¥å…·ç¢ç‰‡åŒ–</strong>ï¼šæ¯ä¸ª AI åº”ç”¨éƒ½è¦é‡æ–°å®ç°å·¥å…·é›†æˆ</li>
<li><strong>åè®®ä¸ç»Ÿä¸€</strong>ï¼šæ²¡æœ‰æ ‡å‡†çš„å·¥å…·è°ƒç”¨æ ¼å¼</li>
<li><strong>æ‰©å±•æ€§å·®</strong>ï¼šæ·»åŠ æ–°å·¥å…·éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
</ul>
<p>MCP æä¾›äº†ï¼š</p>
<ul>
<li>ğŸ“¡ <strong>æ ‡å‡†ä¼ è¾“å±‚</strong>ï¼šstdioã€SSEã€HTTP</li>
<li>ğŸ”§ <strong>å·¥å…·å‘ç°æœºåˆ¶</strong>ï¼šåŠ¨æ€è·å–å¯ç”¨å·¥å…·åˆ—è¡¨</li>
<li>ğŸ” <strong>è®¤è¯æ”¯æŒ</strong>ï¼šOAuth 2.0 é›†æˆ</li>
<li>ğŸ“Š <strong>èµ„æºç®¡ç†</strong>ï¼šç»Ÿä¸€çš„èµ„æºè¯»å–æ¥å£</li>
</ul>
<hr/>
<h2 data-id="heading-2">æ¶æ„è®¾è®¡</h2>
<p>blade-code çš„ MCP é›†æˆé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Agent Runtime è°ƒç”¨å±‚] --&gt; B[McpRegistry ç®¡ç†å±‚]
    B --&gt; C[McpClient é€šä¿¡å±‚]
    
    A1[å·¥å…·è°ƒç”¨&lt;br/&gt;å‚æ•°éªŒè¯] -.-&gt; A
    B1[æœåŠ¡å™¨æ³¨å†Œ/æ³¨é”€&lt;br/&gt;å·¥å…·å†²çªå¤„ç†&lt;br/&gt;çŠ¶æ€ç›‘æ§] -.-&gt; B
    C1[è¿æ¥ç®¡ç†&lt;br/&gt;åè®®é€šä¿¡&lt;br/&gt;é”™è¯¯é‡è¯•&lt;br/&gt;OAuth è®¤è¯] -.-&gt; C
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
</code></pre>
<p><strong>è®¾è®¡åŸåˆ™ï¼š</strong></p>
<ol>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯å±‚åªè´Ÿè´£è‡ªå·±çš„æ ¸å¿ƒåŠŸèƒ½</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šé€šè¿‡ EventEmitter è§£è€¦ç»„ä»¶</li>
<li><strong>å®¹é”™ä¼˜å…ˆ</strong>ï¼šç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•ï¼Œæ°¸ä¹…é”™è¯¯å¿«é€Ÿå¤±è´¥</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šå®Œæ•´çš„çŠ¶æ€æœºå’Œäº‹ä»¶æ—¥å¿—</li>
</ol>
<hr/>
<h2 data-id="heading-3">æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-4">1. McpClientï¼šè¿æ¥ä¸é€šä¿¡</h3>
<p><code>McpClient</code> æ˜¯ MCP é›†æˆçš„æ ¸å¿ƒï¼Œè´Ÿè´£ä¸å•ä¸ª MCP æœåŠ¡å™¨çš„é€šä¿¡ã€‚</p>
<h4 data-id="heading-5">1.1 ä¼ è¾“å±‚æŠ½è±¡</h4>
<p>MCP æ”¯æŒä¸‰ç§ä¼ è¾“æ–¹å¼ï¼Œblade-code é€šè¿‡å·¥å‚æ¨¡å¼ç»Ÿä¸€åˆ›å»ºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">createTransport</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Transport</span>&gt; {
  <span class="hljs-keyword">const</span> { <span class="hljs-keyword">type</span>, command, args, env, url, headers } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'stdio'</span>) {
    <span class="hljs-comment">// å­è¿›ç¨‹é€šä¿¡ï¼ˆæœ¬åœ°å·¥å…·ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioClientTransport</span>({
      command,
      <span class="hljs-attr">args</span>: args || [],
      <span class="hljs-attr">env</span>: { ...process.<span class="hljs-property">env</span>, ...env },
      <span class="hljs-attr">stderr</span>: <span class="hljs-string">'ignore'</span>, <span class="hljs-comment">// å¿½ç•¥å­è¿›ç¨‹çš„ stderr è¾“å‡º</span>
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'sse'</span>) {
    <span class="hljs-comment">// Server-Sent Eventsï¼ˆè¿œç¨‹æœåŠ¡ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSEClientTransport</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url), {
      <span class="hljs-attr">requestInit</span>: { headers },
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'http'</span>) {
    <span class="hljs-comment">// HTTP é•¿è½®è¯¢</span>
    <span class="hljs-keyword">const</span> { <span class="hljs-title class_">StreamableHTTPClientTransport</span> } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(
      <span class="hljs-string">'@modelcontextprotocol/sdk/client/streamableHttp.js'</span>
    );
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPClientTransport</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url), {
      <span class="hljs-attr">requestInit</span>: { headers },
    });
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ä¸æ”¯æŒçš„ä¼ è¾“ç±»å‹: <span class="hljs-subst">${<span class="hljs-keyword">type</span>}</span>`</span>);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>stdio</code> é€‚åˆæœ¬åœ°å·¥å…·ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ï¼‰</li>
<li><code>sse</code> é€‚åˆè¿œç¨‹æœåŠ¡ï¼ˆå®æ—¶æ¨é€ï¼‰</li>
<li><code>http</code> é€‚åˆ RESTful API</li>
</ul>
<h4 data-id="heading-6">1.2 è¿æ¥ç®¡ç†ä¸é‡è¯•</h4>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç½‘ç»œä¸ç¨³å®šæ˜¯å¸¸æ€ã€‚blade-code å®ç°äº†æ™ºèƒ½é‡è¯•æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">connectWithRetry</span>(maxRetries = <span class="hljs-number">3</span>, initialDelay = <span class="hljs-number">1000</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">lastError</span>: <span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> attempt = <span class="hljs-number">1</span>; attempt &lt;= maxRetries; attempt++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doConnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// é‡ç½®é‡è¿è®¡æ•°</span>
      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æˆåŠŸè¿æ¥</span>
    } <span class="hljs-keyword">catch</span> (error) {
      lastError = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;
      <span class="hljs-keyword">const</span> classified = <span class="hljs-title function_">classifyError</span>(error);

      <span class="hljs-comment">// å¦‚æœæ˜¯æ°¸ä¹…æ€§é”™è¯¯ï¼Œä¸é‡è¯•</span>
      <span class="hljs-keyword">if</span> (!classified.<span class="hljs-property">isRetryable</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[McpClient] æ£€æµ‹åˆ°æ°¸ä¹…æ€§é”™è¯¯ï¼Œæ”¾å¼ƒé‡è¯•:'</span>, classified.<span class="hljs-property">type</span>);
        <span class="hljs-keyword">throw</span> error;
      }

      <span class="hljs-comment">// æŒ‡æ•°é€€é¿</span>
      <span class="hljs-keyword">if</span> (attempt &lt; maxRetries) {
        <span class="hljs-keyword">const</span> delay = initialDelay * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, attempt - <span class="hljs-number">1</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`[McpClient] è¿æ¥å¤±è´¥ï¼ˆ<span class="hljs-subst">${attempt}</span>/<span class="hljs-subst">${maxRetries}</span>ï¼‰ï¼Œ<span class="hljs-subst">${delay}</span>ms åé‡è¯•...`</span>);
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, delay));
      }
    }
  }

  <span class="hljs-keyword">throw</span> lastError || <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¿æ¥å¤±è´¥'</span>);
}
</code></pre>
<p><strong>é”™è¯¯åˆ†ç±»ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">ErrorType</span> {
  <span class="hljs-variable constant_">NETWORK_TEMPORARY</span> = <span class="hljs-string">'network_temporary'</span>, <span class="hljs-comment">// ä¸´æ—¶ç½‘ç»œé”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰</span>
  <span class="hljs-variable constant_">NETWORK_PERMANENT</span> = <span class="hljs-string">'network_permanent'</span>, <span class="hljs-comment">// æ°¸ä¹…ç½‘ç»œé”™è¯¯</span>
  <span class="hljs-variable constant_">CONFIG_ERROR</span> = <span class="hljs-string">'config_error'</span>,           <span class="hljs-comment">// é…ç½®é”™è¯¯</span>
  <span class="hljs-variable constant_">AUTH_ERROR</span> = <span class="hljs-string">'auth_error'</span>,               <span class="hljs-comment">// è®¤è¯é”™è¯¯</span>
  <span class="hljs-variable constant_">PROTOCOL_ERROR</span> = <span class="hljs-string">'protocol_error'</span>,       <span class="hljs-comment">// åè®®é”™è¯¯</span>
  <span class="hljs-variable constant_">UNKNOWN</span> = <span class="hljs-string">'unknown'</span>,                     <span class="hljs-comment">// æœªçŸ¥é”™è¯¯</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">classifyError</span>(<span class="hljs-params">error: <span class="hljs-built_in">unknown</span></span>): <span class="hljs-title class_">ClassifiedError</span> {
  <span class="hljs-keyword">const</span> msg = error.<span class="hljs-property">message</span>.<span class="hljs-title function_">toLowerCase</span>();

  <span class="hljs-comment">// æ°¸ä¹…æ€§é…ç½®é”™è¯¯ï¼ˆä¸åº”é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">const</span> permanentErrors = [
    <span class="hljs-string">'command not found'</span>,
    <span class="hljs-string">'no such file'</span>,
    <span class="hljs-string">'permission denied'</span>,
    <span class="hljs-string">'invalid configuration'</span>,
  ];

  <span class="hljs-keyword">if</span> (permanentErrors.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">permanent</span>) =&gt;</span> msg.<span class="hljs-title function_">includes</span>(permanent))) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">CONFIG_ERROR</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">originalError</span>: error };
  }

  <span class="hljs-comment">// ä¸´æ—¶ç½‘ç»œé”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">const</span> temporaryErrors = [
    <span class="hljs-string">'timeout'</span>,
    <span class="hljs-string">'connection refused'</span>,
    <span class="hljs-string">'econnreset'</span>,
    <span class="hljs-string">'etimedout'</span>,
    <span class="hljs-string">'503'</span>,
    <span class="hljs-string">'429'</span>,
  ];

  <span class="hljs-keyword">if</span> (temporaryErrors.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">temporary</span>) =&gt;</span> msg.<span class="hljs-title function_">includes</span>(temporary))) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">NETWORK_TEMPORARY</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">originalError</span>: error };
  }

  <span class="hljs-comment">// é»˜è®¤è§†ä¸ºä¸´æ—¶é”™è¯¯ï¼ˆä¿å®ˆç­–ç•¥ï¼šå…è®¸é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">UNKNOWN</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">originalError</span>: error };
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<ul>
<li><strong>å¿«é€Ÿå¤±è´¥</strong>ï¼šé…ç½®é”™è¯¯ç«‹å³æŠ›å‡ºï¼Œé¿å…æ— æ„ä¹‰çš„é‡è¯•</li>
<li><strong>æŒ‡æ•°é€€é¿</strong>ï¼šé¿å…é›ªå´©æ•ˆåº”ï¼Œç»™æœåŠ¡å™¨æ¢å¤æ—¶é—´</li>
<li><strong>ä¿å®ˆç­–ç•¥</strong>ï¼šæœªçŸ¥é”™è¯¯é»˜è®¤å¯é‡è¯•ï¼Œæé«˜å®¹é”™æ€§</li>
</ul>
<h4 data-id="heading-7">1.3 æ„å¤–æ–­è¿å¤„ç†</h4>
<p>MCP æœåŠ¡å™¨å¯èƒ½éšæ—¶æ–­å¼€ï¼ˆè¿›ç¨‹å´©æºƒã€ç½‘ç»œä¸­æ–­ï¼‰ï¼Œblade-code é€šè¿‡ç›‘å¬ <code>onclose</code> äº‹ä»¶è‡ªåŠ¨é‡è¿ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">sdkClient</span>.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleUnexpectedClose</span>();
};

<span class="hljs-keyword">private</span> <span class="hljs-title function_">handleUnexpectedClose</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isManualDisconnect</span>) {
    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ‰‹åŠ¨æ–­å¼€ï¼Œä¸é‡è¿</span>
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[McpClient] æ£€æµ‹åˆ°æ„å¤–æ–­è¿ï¼Œå‡†å¤‡é‡è¿...'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">ERROR</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'MCPæœåŠ¡å™¨è¿æ¥æ„å¤–å…³é—­'</span>));
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleReconnect</span>();
  }
}

<span class="hljs-keyword">private</span> <span class="hljs-title function_">scheduleReconnect</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">MAX_RECONNECT_ATTEMPTS</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[McpClient] è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°ï¼Œæ”¾å¼ƒé‡è¿'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnectFailed'</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æŒ‡æ•°é€€é¿ï¼š1s, 2s, 4s, 8s, 16sï¼ˆæœ€å¤§30sï¼‰</span>
  <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>), <span class="hljs-number">30000</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>++;

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doConnect</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[McpClient] é‡è¿æˆåŠŸ'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnected'</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">const</span> classified = <span class="hljs-title function_">classifyError</span>(error);
      <span class="hljs-keyword">if</span> (classified.<span class="hljs-property">isRetryable</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleReconnect</span>(); <span class="hljs-comment">// ç»§ç»­é‡è¿</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnectFailed'</span>); <span class="hljs-comment">// æ°¸ä¹…å¤±è´¥</span>
      }
    }
  }, delay);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åŒºåˆ†æ‰‹åŠ¨æ–­å¼€å’Œæ„å¤–æ–­è¿</li>
<li>æœ€å¤šé‡è¿ 5 æ¬¡ï¼Œé¿å…æ— é™å¾ªç¯</li>
<li>é‡è¿æˆåŠŸåé‡ç½®è®¡æ•°å™¨</li>
</ul>
<hr/>
<h3 data-id="heading-8">2. McpRegistryï¼šæœåŠ¡å™¨ç®¡ç†</h3>
<p><code>McpRegistry</code> æ˜¯å•ä¾‹æ¨¡å¼çš„æ³¨å†Œä¸­å¿ƒï¼Œç®¡ç†å¤šä¸ª MCP æœåŠ¡å™¨ã€‚</p>
<h4 data-id="heading-9">2.1 æœåŠ¡å™¨æ³¨å†Œ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">registerServer</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">config</span>: <span class="hljs-title class_">McpServerConfig</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>.<span class="hljs-title function_">has</span>(name)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨ "<span class="hljs-subst">${name}</span>" å·²ç»æ³¨å†Œ`</span>);
  }

  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpClient</span>(config, name, config.<span class="hljs-property">healthCheck</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-attr">serverInfo</span>: <span class="hljs-title class_">McpServerInfo</span> = {
    config,
    client,
    <span class="hljs-attr">status</span>: <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">DISCONNECTED</span>,
    <span class="hljs-attr">tools</span>: [],
  };

  <span class="hljs-comment">// è®¾ç½®å®¢æˆ·ç«¯äº‹ä»¶å¤„ç†å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupClientEventHandlers</span>(client, serverInfo, name);

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>.<span class="hljs-title function_">set</span>(name, serverInfo);
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'serverRegistered'</span>, name, serverInfo);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectServer</span>(name);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨ "<span class="hljs-subst">${name}</span>" è¿æ¥å¤±è´¥:`</span>, error);
  }
}
</code></pre>
<h4 data-id="heading-10">2.2 å·¥å…·å†²çªå¤„ç†</h4>
<p>å¤šä¸ª MCP æœåŠ¡å™¨å¯èƒ½æä¾›åŒåå·¥å…·ï¼Œblade-code é€šè¿‡å‰ç¼€è§£å†³å†²çªï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">getAvailableTools</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Tool</span>[]&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">tools</span>: <span class="hljs-title class_">Tool</span>[] = [];
  <span class="hljs-keyword">const</span> nameConflicts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();

  <span class="hljs-comment">// ç¬¬ä¸€éï¼šæ£€æµ‹å†²çª</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [_serverName, serverInfo] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>) {
    <span class="hljs-keyword">if</span> (serverInfo.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mcpTool <span class="hljs-keyword">of</span> serverInfo.<span class="hljs-property">tools</span>) {
        <span class="hljs-keyword">const</span> count = nameConflicts.<span class="hljs-title function_">get</span>(mcpTool.<span class="hljs-property">name</span>) || <span class="hljs-number">0</span>;
        nameConflicts.<span class="hljs-title function_">set</span>(mcpTool.<span class="hljs-property">name</span>, count + <span class="hljs-number">1</span>);
      }
    }
  }

  <span class="hljs-comment">// ç¬¬äºŒéï¼šåˆ›å»ºå·¥å…·ï¼ˆå†²çªæ—¶æ·»åŠ å‰ç¼€ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [serverName, serverInfo] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>) {
    <span class="hljs-keyword">if</span> (serverInfo.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mcpTool <span class="hljs-keyword">of</span> serverInfo.<span class="hljs-property">tools</span>) {
        <span class="hljs-keyword">const</span> hasConflict = (nameConflicts.<span class="hljs-title function_">get</span>(mcpTool.<span class="hljs-property">name</span>) || <span class="hljs-number">0</span>) &gt; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">const</span> toolName = hasConflict
          ? <span class="hljs-string">`<span class="hljs-subst">${serverName}</span>__<span class="hljs-subst">${mcpTool.name}</span>`</span>
          : mcpTool.<span class="hljs-property">name</span>;

        <span class="hljs-keyword">const</span> tool = <span class="hljs-title function_">createMcpTool</span>(serverInfo.<span class="hljs-property">client</span>, serverName, mcpTool, toolName);
        tools.<span class="hljs-title function_">push</span>(tool);
      }
    }
  }

  <span class="hljs-keyword">return</span> tools;
}
</code></pre>
<p><strong>å‘½åç­–ç•¥ï¼š</strong></p>
<ul>
<li>æ— å†²çªï¼š<code>toolName</code></li>
<li>æœ‰å†²çªï¼š<code>serverName__toolName</code></li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æœåŠ¡å™¨</span> <span class="hljs-attr">A:</span> <span class="hljs-string">read_file</span>
<span class="hljs-string">æœåŠ¡å™¨</span> <span class="hljs-attr">B:</span> <span class="hljs-string">read_file</span>
<span class="hljs-string">â†’</span> <span class="hljs-string">æœ€ç»ˆå·¥å…·:</span> <span class="hljs-string">A__read_file,</span> <span class="hljs-string">B__read_file</span>
</code></pre>
<hr/>
<h3 data-id="heading-11">3. OAuth è®¤è¯</h3>
<p>MCP æ”¯æŒ OAuth 2.0 è®¤è¯ï¼Œblade-code å®ç°äº†å®Œæ•´çš„ OAuth æµç¨‹ã€‚</p>
<h4 data-id="heading-12">3.1 ä»¤ç‰Œå­˜å‚¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OAuthTokenStorage</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">tokenFilePath</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> homeDir = os.<span class="hljs-title function_">homedir</span>();
    <span class="hljs-keyword">const</span> configDir = path.<span class="hljs-title function_">join</span>(homeDir, <span class="hljs-string">'.blade'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenFilePath</span> = path.<span class="hljs-title function_">join</span>(configDir, <span class="hljs-string">'mcp-oauth-tokens.json'</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">saveToken</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">token</span>: <span class="hljs-title class_">OAuthToken</span>,
    clientId?: <span class="hljs-built_in">string</span>,
    tokenUrl?: <span class="hljs-built_in">string</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> credentials = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadAllCredentials</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">credential</span>: <span class="hljs-title class_">OAuthCredentials</span> = {
      serverName,
      token,
      clientId,
      tokenUrl,
      <span class="hljs-attr">updatedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    };

    credentials.<span class="hljs-title function_">set</span>(serverName, credential);
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveAllCredentials</span>(credentials);
  }

  <span class="hljs-title function_">isTokenExpired</span>(<span class="hljs-attr">token</span>: <span class="hljs-title class_">OAuthToken</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">if</span> (!token.<span class="hljs-property">expiresAt</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ²¡æœ‰è¿‡æœŸæ—¶é—´ï¼Œè®¤ä¸ºä¸è¿‡æœŸ</span>
    }

    <span class="hljs-comment">// æå‰ 5 åˆ†é’Ÿè§†ä¸ºè¿‡æœŸï¼Œç•™å‡ºåˆ·æ–°æ—¶é—´</span>
    <span class="hljs-keyword">const</span> buffer = <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt;= token.<span class="hljs-property">expiresAt</span> - buffer;
  }
}
</code></pre>
<p><strong>å®‰å…¨æªæ–½ï¼š</strong></p>
<ul>
<li>ä»¤ç‰Œæ–‡ä»¶æƒé™è®¾ç½®ä¸º <code>0o600</code>ï¼ˆä»…æ‰€æœ‰è€…å¯è¯»å†™ï¼‰</li>
<li>æå‰ 5 åˆ†é’Ÿåˆ·æ–°ä»¤ç‰Œï¼Œé¿å…è¿‡æœŸ</li>
<li>æ”¯æŒ refresh_token è‡ªåŠ¨ç»­æœŸ</li>
</ul>
<h4 data-id="heading-13">3.2 OAuth æµç¨‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OAuthProvider</span> {
  <span class="hljs-keyword">private</span> tokenStorage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OAuthTokenStorage</span>();

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getValidToken</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">oauthConfig</span>: <span class="hljs-title class_">OAuthConfig</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>&gt; {
    <span class="hljs-keyword">const</span> credentials = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">getCredentials</span>(serverName);

    <span class="hljs-keyword">if</span> (!credentials) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ²¡æœ‰ä»¤ç‰Œï¼Œéœ€è¦è®¤è¯</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿‡æœŸ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">isTokenExpired</span>(credentials.<span class="hljs-property">token</span>)) {
      <span class="hljs-comment">// å°è¯•åˆ·æ–°</span>
      <span class="hljs-keyword">if</span> (credentials.<span class="hljs-property">token</span>.<span class="hljs-property">refreshToken</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> newToken = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshToken</span>(credentials, oauthConfig);
          <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">saveToken</span>(
            serverName,
            newToken,
            credentials.<span class="hljs-property">clientId</span>,
            credentials.<span class="hljs-property">tokenUrl</span>
          );
          <span class="hljs-keyword">return</span> newToken.<span class="hljs-property">accessToken</span>;
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[OAuthProvider] åˆ·æ–°ä»¤ç‰Œå¤±è´¥:'</span>, error);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// åˆ·æ–°å¤±è´¥ï¼Œéœ€è¦é‡æ–°è®¤è¯</span>
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ²¡æœ‰ refresh_tokenï¼Œéœ€è¦é‡æ–°è®¤è¯</span>
    }

    <span class="hljs-keyword">return</span> credentials.<span class="hljs-property">token</span>.<span class="hljs-property">accessToken</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">authenticate</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">oauthConfig</span>: <span class="hljs-title class_">OAuthConfig</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">OAuthToken</span>&gt; {
    <span class="hljs-comment">// 1. ç”Ÿæˆæˆæƒ URL</span>
    <span class="hljs-keyword">const</span> authUrl = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildAuthUrl</span>(oauthConfig);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¯·è®¿é—®ä»¥ä¸‹ URL è¿›è¡Œæˆæƒ:\n<span class="hljs-subst">${authUrl}</span>`</span>);

    <span class="hljs-comment">// 2. å¯åŠ¨æœ¬åœ°å›è°ƒæœåŠ¡å™¨</span>
    <span class="hljs-keyword">const</span> code = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startCallbackServer</span>(oauthConfig.<span class="hljs-property">redirectUri</span>);

    <span class="hljs-comment">// 3. ç”¨æˆæƒç æ¢å–ä»¤ç‰Œ</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">exchangeCodeForToken</span>(code, oauthConfig);

    <span class="hljs-comment">// 4. ä¿å­˜ä»¤ç‰Œ</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">saveToken</span>(
      serverName,
      token,
      oauthConfig.<span class="hljs-property">clientId</span>,
      oauthConfig.<span class="hljs-property">tokenUrl</span>
    );

    <span class="hljs-keyword">return</span> token;
  }
}
</code></pre>
<p><strong>æµç¨‹å›¾ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ç”¨æˆ·è¯·æ±‚] --&gt; B{æ£€æŸ¥ä»¤ç‰Œ}
    B --&gt;|æœ‰æ•ˆ| C[è¿”å›ä»¤ç‰Œ]
    B --&gt;|æ— æ•ˆ/è¿‡æœŸ| D{æœ‰ refresh_token?}
    D --&gt;|æ˜¯| E[åˆ·æ–°ä»¤ç‰Œ]
    E --&gt; F[è¿”å›æ–°ä»¤ç‰Œ]
    D --&gt;|å¦| G[å¯åŠ¨ OAuth æµç¨‹]
    G --&gt; H[è¿”å›æ–°ä»¤ç‰Œ]
    
    style C fill:#90EE90
    style F fill:#90EE90
    style H fill:#90EE90
</code></pre>
<hr/>
<h3 data-id="heading-14">4. å¥åº·ç›‘æ§</h3>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒMCP æœåŠ¡å™¨å¯èƒ½"åƒµæ­»"ï¼ˆè¿æ¥æ­£å¸¸ä½†ä¸å“åº”ï¼‰ã€‚blade-code å®ç°äº†ä¸»åŠ¨å¥åº·æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HealthMonitor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intervalTimer</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> consecutiveFailures = <span class="hljs-number">0</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> client: McpClient,
    <span class="hljs-keyword">private</span> config: HealthCheckConfig
  </span>) {
    <span class="hljs-variable language_">super</span>();
  }

  <span class="hljs-title function_">start</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalTimer</span>) {
      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// å·²ç»å¯åŠ¨</span>
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalTimer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">performHealthCheck</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// é‡ç½®å¤±è´¥è®¡æ•°</span>
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span>++;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
          <span class="hljs-string">`[HealthMonitor] å¥åº·æ£€æŸ¥å¤±è´¥ (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.consecutiveFailures}</span>/<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.config.maxFailures}</span>):`</span>,
          error
        );

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxFailures</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'unhealthy'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span>, error);
          <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attemptReconnect</span>();
        }
      }
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">intervalMs</span>);
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">performHealthCheck</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> timeout = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeoutMs</span> || <span class="hljs-number">5000</span>;

    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">listTools</span>(), <span class="hljs-comment">// è°ƒç”¨ä¸€ä¸ªè½»é‡çº§æ–¹æ³•</span>
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¥åº·æ£€æŸ¥è¶…æ—¶'</span>)), timeout)
      ),
    ]);
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">attemptReconnect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[HealthMonitor] å°è¯•é‡è¿...'</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">connect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnected'</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[HealthMonitor] é‡è¿å¤±è´¥:'</span>, error);
    }
  }
}
</code></pre>
<p><strong>é…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">intervalMs</span>: <span class="hljs-number">30000</span>,    <span class="hljs-comment">// æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡</span>
  <span class="hljs-attr">timeoutMs</span>: <span class="hljs-number">5000</span>,      <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ 5 ç§’</span>
  <span class="hljs-attr">maxFailures</span>: <span class="hljs-number">3</span>        <span class="hljs-comment">// è¿ç»­å¤±è´¥ 3 æ¬¡è§¦å‘é‡è¿</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-15">å·¥å…·åŠ¨æ€æ³¨å†Œ</h2>
<p>MCP å·¥å…·éœ€è¦è½¬æ¢ä¸º blade-code çš„ <code>Tool</code> æ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMcpTool</span>(<span class="hljs-params">
  client: McpClient,
  serverName: <span class="hljs-built_in">string</span>,
  mcpTool: McpToolDefinition,
  toolName?: <span class="hljs-built_in">string</span>
</span>): <span class="hljs-title class_">Tool</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: toolName || mcpTool.<span class="hljs-property">name</span>,
    <span class="hljs-attr">description</span>: mcpTool.<span class="hljs-property">description</span> || <span class="hljs-string">`MCPå·¥å…·: <span class="hljs-subst">${mcpTool.name}</span>`</span>,
    <span class="hljs-attr">parameters</span>: mcpTool.<span class="hljs-property">inputSchema</span> || { <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>, <span class="hljs-attr">properties</span>: {} },
    <span class="hljs-attr">metadata</span>: {
      <span class="hljs-attr">source</span>: <span class="hljs-string">'mcp'</span>,
      serverName,
      <span class="hljs-attr">originalName</span>: mcpTool.<span class="hljs-property">name</span>,
    },

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-attr">args</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ToolResult</span>&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">callTool</span>(mcpTool.<span class="hljs-property">name</span>, args);

        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">output</span>: <span class="hljs-title function_">formatMcpResponse</span>(response),
          <span class="hljs-attr">metadata</span>: {
            serverName,
            <span class="hljs-attr">toolName</span>: mcpTool.<span class="hljs-property">name</span>,
          },
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">error</span>: error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? error.<span class="hljs-property">message</span> : <span class="hljs-title class_">String</span>(error),
          <span class="hljs-attr">metadata</span>: {
            serverName,
            <span class="hljs-attr">toolName</span>: mcpTool.<span class="hljs-property">name</span>,
          },
        };
      }
    },
  };
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä¿ç•™åŸå§‹å·¥å…·åï¼ˆ<code>originalName</code>ï¼‰ç”¨äºè°ƒè¯•</li>
<li>ç»Ÿä¸€é”™è¯¯å¤„ç†æ ¼å¼</li>
<li>æ”¯æŒå…ƒæ•°æ®ä¼ é€’</li>
</ul>
<hr/>
<h2 data-id="heading-16">é”™è¯¯å¤„ç†ä¸é‡è¿</h2>
<p>blade-code çš„é”™è¯¯å¤„ç†éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<h3 data-id="heading-17">1. é”™è¯¯åˆ†ç±»</h3>
<pre><code class="hljs language-typescript" lang="typescript">ä¸´æ—¶é”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰ï¼š
- ç½‘ç»œè¶…æ—¶
- è¿æ¥è¢«æ‹’ç»
- é€Ÿç‡é™åˆ¶ï¼ˆ<span class="hljs-number">429</span>ï¼‰
- æœåŠ¡ä¸å¯ç”¨ï¼ˆ<span class="hljs-number">503</span>ï¼‰

æ°¸ä¹…é”™è¯¯ï¼ˆä¸é‡è¯•ï¼‰ï¼š
- é…ç½®é”™è¯¯ï¼ˆå‘½ä»¤ä¸å­˜åœ¨ï¼‰
- è®¤è¯å¤±è´¥ï¼ˆ<span class="hljs-number">401</span>ï¼‰
- æƒé™ä¸è¶³ï¼ˆ<span class="hljs-number">403</span>ï¼‰
- åè®®é”™è¯¯ï¼ˆæ ¼å¼é”™è¯¯ï¼‰
</code></pre>
<h3 data-id="heading-18">2. é‡è¯•ç­–ç•¥</h3>
<pre><code class="hljs language-typescript" lang="typescript">æŒ‡æ•°é€€é¿ï¼š
- ç¬¬ <span class="hljs-number">1</span> æ¬¡ï¼š<span class="hljs-number">1</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">2</span> æ¬¡ï¼š<span class="hljs-number">2</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">3</span> æ¬¡ï¼š<span class="hljs-number">4</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">4</span> æ¬¡ï¼š<span class="hljs-number">8</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">5</span> æ¬¡ï¼š<span class="hljs-number">16</span> ç§’åé‡è¯•
- æœ€å¤§å»¶è¿Ÿï¼š<span class="hljs-number">30</span> ç§’
</code></pre>
<h3 data-id="heading-19">3. çŠ¶æ€æœº</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; DISCONNECTED
    DISCONNECTED --&gt; CONNECTING: connect()
    CONNECTING --&gt; CONNECTED: æˆåŠŸ
    CONNECTING --&gt; ERROR: å¤±è´¥
    ERROR --&gt; CONNECTING: é‡è¯•
    CONNECTED --&gt; ERROR: æ„å¤–æ–­è¿
    CONNECTED --&gt; DISCONNECTED: disconnect()
</code></pre>
<hr/>
<h2 data-id="heading-20">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-21">æ¡ˆä¾‹ 1ï¼šé›†æˆæ–‡ä»¶ç³»ç»Ÿ MCP æœåŠ¡å™¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é…ç½®æ–‡ä»¶</span>
{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"filesystem"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"stdio"</span>,
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"npx"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"-y"</span>, <span class="hljs-string">"@modelcontextprotocol/server-filesystem"</span>, <span class="hljs-string">"/path/to/workspace"</span>],
      <span class="hljs-string">"env"</span>: {
        <span class="hljs-string">"NODE_ENV"</span>: <span class="hljs-string">"production"</span>
      }
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> registry = <span class="hljs-title class_">McpRegistry</span>.<span class="hljs-title function_">getInstance</span>();
<span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">registerServer</span>(<span class="hljs-string">'filesystem'</span>, config.<span class="hljs-property">mcpServers</span>.<span class="hljs-property">filesystem</span>);

<span class="hljs-keyword">const</span> tools = <span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">getAvailableTools</span>();
<span class="hljs-comment">// è¾“å‡º: [{ name: 'read_file', ... }, { name: 'write_file', ... }]</span>
</code></pre>
<h3 data-id="heading-22">æ¡ˆä¾‹ 2ï¼šé›†æˆè¿œç¨‹ APIï¼ˆå¸¦ OAuthï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"github"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"sse"</span>,
      <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/mcp"</span>,
      <span class="hljs-string">"oauth"</span>: {
        <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"authUrl"</span>: <span class="hljs-string">"https://github.com/login/oauth/authorize"</span>,
        <span class="hljs-string">"tokenUrl"</span>: <span class="hljs-string">"https://github.com/login/oauth/access_token"</span>,
        <span class="hljs-string">"clientId"</span>: <span class="hljs-string">"your-client-id"</span>,
        <span class="hljs-string">"clientSecret"</span>: <span class="hljs-string">"your-client-secret"</span>,
        <span class="hljs-string">"scopes"</span>: [<span class="hljs-string">"repo"</span>, <span class="hljs-string">"user"</span>],
        <span class="hljs-string">"redirectUri"</span>: <span class="hljs-string">"http://localhost:3000/callback"</span>
      }
    }
  }
}

<span class="hljs-comment">// é¦–æ¬¡ä½¿ç”¨ä¼šè‡ªåŠ¨è§¦å‘ OAuth æµç¨‹</span>
<span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">registerServer</span>(<span class="hljs-string">'github'</span>, config.<span class="hljs-property">mcpServers</span>.<span class="hljs-property">github</span>);
<span class="hljs-comment">// è¾“å‡º: è¯·è®¿é—®ä»¥ä¸‹ URL è¿›è¡Œæˆæƒ: https://github.com/login/oauth/authorize?...</span>
</code></pre>
<h3 data-id="heading-23">æ¡ˆä¾‹ 3ï¼šå¥åº·ç›‘æ§ä¸è‡ªåŠ¨æ¢å¤</h3>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"database"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"stdio"</span>,
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"mcp-database-server"</span>,
      <span class="hljs-string">"healthCheck"</span>: {
        <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"intervalMs"</span>: <span class="hljs-number">30000</span>,
        <span class="hljs-string">"timeoutMs"</span>: <span class="hljs-number">5000</span>,
        <span class="hljs-string">"maxFailures"</span>: <span class="hljs-number">3</span>
      }
    }
  }
}

<span class="hljs-comment">// ç›‘å¬å¥åº·äº‹ä»¶</span>
registry.<span class="hljs-title function_">on</span>(<span class="hljs-string">'serverError'</span>, <span class="hljs-function">(<span class="hljs-params">name, error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æœåŠ¡å™¨ <span class="hljs-subst">${name}</span> å‡ºé”™:`</span>, error);
});

registry.<span class="hljs-title function_">on</span>(<span class="hljs-string">'healthMonitorReconnected'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¥åº·ç›‘æ§è§¦å‘é‡è¿æˆåŠŸ'</span>);
});
</code></pre>
<hr/>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p>blade-code çš„ MCP é›†æˆå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<h3 data-id="heading-25">å·²å®ç°</h3>
<ol>
<li><strong>å¤šä¼ è¾“å±‚æ”¯æŒ</strong>ï¼šstdioã€SSEã€HTTP</li>
<li><strong>æ™ºèƒ½é‡è¯•</strong>ï¼šé”™è¯¯åˆ†ç±» + æŒ‡æ•°é€€é¿</li>
<li><strong>è‡ªåŠ¨é‡è¿</strong>ï¼šæ„å¤–æ–­è¿è‡ªåŠ¨æ¢å¤</li>
<li><strong>OAuth è®¤è¯</strong>ï¼šå®Œæ•´çš„ OAuth 2.0 æµç¨‹</li>
<li><strong>å¥åº·ç›‘æ§</strong>ï¼šä¸»åŠ¨æ£€æµ‹åƒµæ­»è¿æ¥</li>
<li><strong>å·¥å…·å†²çªå¤„ç†</strong>ï¼šè‡ªåŠ¨æ·»åŠ å‰ç¼€</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šå®Œæ•´çš„çŠ¶æ€æœºå’Œäº‹ä»¶ç³»ç»Ÿ</li>
</ol>
<h3 data-id="heading-26">è®¾è®¡äº®ç‚¹</h3>
<ul>
<li><strong>å®¹é”™ä¼˜å…ˆ</strong>ï¼šç½‘ç»œé”™è¯¯ä¸ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒ</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šä¸°å¯Œçš„æ—¥å¿—å’Œäº‹ä»¶ï¼Œä¾¿äºè°ƒè¯•</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šæ–°å¢ MCP æœåŠ¡å™¨åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šä»¤ç‰ŒåŠ å¯†å­˜å‚¨ï¼Œæƒé™æœ€å°åŒ–</li>
</ul>
<hr/>
<p><strong>ç›¸å…³èµ„æºï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FechoVic%2Fblade-code" target="_blank" title="https://github.com/echoVic/blade-code" ref="nofollow noopener noreferrer">blade-code GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io" target="_blank" title="https://modelcontextprotocol.io" ref="nofollow noopener noreferrer">MCP å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fechovic.com" target="_blank" title="https://echovic.com" ref="nofollow noopener noreferrer">ä½œè€…åšå®¢</a></li>
</ul>
<p><strong>è®¨è®º</strong>ï¼šæ¬¢è¿åœ¨ GitHub Issues æˆ–æˆ‘çš„åšå®¢è¯„è®ºåŒºäº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ]]></title>    <link>https://juejin.cn/post/7603595309233160202</link>    <guid>https://juejin.cn/post/7603595309233160202</guid>    <pubDate>2026-02-07T09:32:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603595309233160202" data-draft-id="7603627478020653066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-07T09:32:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·341408199125"/> <meta itemprop="url" content="https://juejin.cn/user/570004686782272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/570004686782272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·341408199125
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:32:33.000Z" title="Sat Feb 07 2026 09:32:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€WakeLock çš„ç±»å‹å’Œé…ç½®</h3>
<p><strong>RIL ä¸­çš„ WakeLock</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// RIL.java å®šä¹‰çš„ä¸¤ç§ç±»å‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">FOR_WAKELOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;        <span class="hljs-comment">// RIL å‘½ä»¤æ‰§è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">FOR_ACK_WAKELOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;    <span class="hljs-comment">// ACK åº”ç­”å‘é€</span>

<span class="hljs-comment">// åˆå§‹åŒ–é…ç½®</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager)context.getSystemService(Context.POWER_SERVICE);

<span class="hljs-comment">// FOR_WAKELOCKï¼šRIL è¯·æ±‚/å“åº”æœŸé—´æŒæœ‰</span>
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, RILJ_WAKELOCK_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);  <span class="hljs-comment">// ä¸æ”¯æŒåµŒå¥—è®¡æ•°</span>

<span class="hljs-comment">// FOR_ACK_WAKELOCKï¼šACK å‘é€æœŸé—´æŒæœ‰</span>
mAckWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, RILJ_ACK_WAKELOCK_NAME);
mAckWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// è¶…æ—¶æ—¶é—´é…ç½®</span>
mWakeLockTimeout = TelephonyProperties.wake_lock_timeout()
        .orElse(DEFAULT_WAKE_LOCK_TIMEOUT_MS);  <span class="hljs-comment">// é»˜è®¤ 25s</span>
mAckWakeLockTimeout = TelephonyProperties.wake_lock_timeout()
        .orElse(DEFAULT_ACK_WAKE_LOCK_TIMEOUT_MS);  <span class="hljs-comment">// é»˜è®¤ 200ms</span>

<span class="hljs-comment">// WakeLock è®¡æ•°å™¨</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mWakeLockCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// æ”¯æŒå¤šä¸ªå¹¶å‘è¯·æ±‚</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mWlSequenceNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;   <span class="hljs-comment">// åºåˆ—å·ç”¨äºè¶…æ—¶æ£€æŸ¥</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mAckWlSequenceNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
</code></pre>
<hr/>
<h3 data-id="heading-1">äºŒã€RIL WakeLock çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p><strong>æµç¨‹ 1ï¼šæ­£å¸¸çš„ RIL è¯·æ±‚æµç¨‹</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. åˆ›å»º RIL è¯·æ±‚
   â†“
RILRequest rr = <span class="hljs-built_in">obtainRequest</span>(RIL_REQUEST_SIGNAL_STRENGTH, result, workSource);
   â†“
<span class="hljs-number">2</span>. <span class="hljs-built_in">addRequest</span>() ä¸­è‡ªåŠ¨è·å– WakeLock
   â†“
<span class="hljs-built_in">acquireWakeLock</span>(rr, FOR_WAKELOCK);
   â†“
   synchronized (mWakeLock) {
       mWakeLock<span class="hljs-selector-class">.acquire</span>();              <span class="hljs-comment">// â† å®é™…è·å–</span>
       mWakeLockCount++;                 <span class="hljs-comment">// è®¡æ•°å¢åŠ </span>
       mWlSequenceNum++;                 <span class="hljs-comment">// åºåˆ—å·å¢åŠ </span>
       
       <span class="hljs-comment">// å…³é”®ï¼šè®¾ç½® WorkSource ç”¨äº BatteryStats è¿½è¸ª</span>
       String clientId = rr<span class="hljs-selector-class">.getWorkSourceClientId</span>();
       if (!mClientWakelockTracker.isClientActive(clientId)) {
           mActiveWakelockWorkSource<span class="hljs-selector-class">.add</span>(rr.mWorkSource);
           mWakeLock<span class="hljs-selector-class">.setWorkSource</span>(mActiveWakelockWorkSource);
       }
       
       <span class="hljs-comment">// å…³é”®ï¼šè®°å½•è¿½è¸ªä¿¡æ¯</span>
       mClientWakelockTracker<span class="hljs-selector-class">.startTracking</span>(rr.mClientId,
               rr.mRequest, rr.mSerial, mWakeLockCount);
       
       <span class="hljs-comment">// å…³é”®ï¼šè®¾ç½®è¶…æ—¶ä¿æŠ¤ï¼ˆ25sï¼‰</span>
       Message msg = mRilHandler<span class="hljs-selector-class">.obtainMessage</span>(EVENT_WAKE_LOCK_TIMEOUT);
       msg<span class="hljs-selector-class">.arg1</span> = mWlSequenceNum;
       mRilHandler<span class="hljs-selector-class">.sendMessageDelayed</span>(msg, mWakeLockTimeout);
   }
   â†“
<span class="hljs-number">3</span>. å‘é€è¯·æ±‚ç»™ Modem
   â†“
<span class="hljs-built_in">radioServiceInvokeHelper</span>(HAL_SERVICE_NETWORK, rr, "getSignalStrength", () -&gt; {
    networkProxy<span class="hljs-selector-class">.getSignalStrength</span>(rr.mSerial);
});
   â†“
<span class="hljs-number">4</span>. æ”¶åˆ° Modem å“åº”
   â†“
<span class="hljs-built_in">onSignalStrengthResponse</span>(RadioResponseInfo responseInfo, SignalStrength signalStrength)
   â†“
<span class="hljs-number">5</span>. <span class="hljs-built_in">decrementWakeLock</span>() é‡Šæ”¾
   â†“
<span class="hljs-built_in">decrementWakeLock</span>(rr);
   â†“
   synchronized (mWakeLock) {
       mClientWakelockTracker<span class="hljs-selector-class">.stopTracking</span>(rr.mClientId,
               rr.mRequest, rr.mSerial,
               (mWakeLockCount &gt; <span class="hljs-number">1</span>) ? mWakeLockCount - <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);
       
       String clientId = rr<span class="hljs-selector-class">.getWorkSourceClientId</span>();
       if (!mClientWakelockTracker.isClientActive(clientId)) {
           <span class="hljs-comment">// è¯¥å®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½å®Œæˆï¼Œç§»é™¤ WorkSource</span>
           mActiveWakelockWorkSource<span class="hljs-selector-class">.remove</span>(rr.mWorkSource);
           mWakeLock<span class="hljs-selector-class">.setWorkSource</span>(mActiveWakelockWorkSource);
       }
       
       if (mWakeLockCount &gt; <span class="hljs-number">1</span>) {
           mWakeLockCount--;  <span class="hljs-comment">// åªå‡è®¡æ•°ï¼Œä¸é‡Šæ”¾</span>
       } else {
           mWakeLockCount = <span class="hljs-number">0</span>;
           mWakeLock<span class="hljs-selector-class">.release</span>();  <span class="hljs-comment">// â† æœ€åä¸€ä¸ªè¯·æ±‚å®Œæˆæ—¶é‡Šæ”¾</span>
       }
   }
   â†“
<span class="hljs-number">6</span>. rr<span class="hljs-selector-class">.release</span>() æ¸…ç†è¯·æ±‚
</code></pre>
<p><strong>æµç¨‹ 2ï¼šè¶…æ—¶å¤„ç†</strong></p>
<pre><code class="hljs language-scss" lang="scss">EVENT_WAKE_LOCK_TIMEOUT è§¦å‘
   â†“
if (msg.arg1 == mWlSequenceNum &amp;&amp; clearWakeLock(FOR_WAKELOCK)) {
    if (mRadioBugDetector != null) {
        mRadioBugDetector<span class="hljs-selector-class">.processWakelockTimeout</span>();  <span class="hljs-comment">// ä¸ŠæŠ¥å¼‚å¸¸</span>
    }
    
    if (RILJ_LOGD) {
        int count = mRequestList<span class="hljs-selector-class">.size</span>();
        <span class="hljs-built_in">riljLog</span>("WAKE_LOCK_TIMEOUT mRequestList=" + count);
        for (int i = <span class="hljs-number">0</span>; i &lt; count; i++) {
            rr = mRequestList<span class="hljs-selector-class">.valueAt</span>(i);
            <span class="hljs-built_in">riljLog</span>(i + ": [" + rr.mSerial + "] "
                    + RILUtils.requestToString(rr.mRequest));
        }
    }
}
   â†“
<span class="hljs-built_in">clearWakeLock</span>(FOR_WAKELOCK)  <span class="hljs-comment">// å¼ºåˆ¶é‡Šæ”¾</span>
   â†“
synchronized (mWakeLock) {
    if (mWakeLockCount == <span class="hljs-number">0</span> &amp;&amp; !mWakeLock.isHeld()) return false;
    
    <span class="hljs-built_in">riljLog</span>("NOTE: mWakeLockCount is " + mWakeLockCount 
            + " at time of clearing");
    
    mWakeLockCount = <span class="hljs-number">0</span>;
    mWakeLock<span class="hljs-selector-class">.release</span>();  <span class="hljs-comment">// å¼ºåˆ¶é‡Šæ”¾</span>
    mClientWakelockTracker<span class="hljs-selector-class">.stopTrackingAll</span>();  <span class="hljs-comment">// æ¸…ç©ºæ‰€æœ‰è¿½è¸ª</span>
    mActiveWakelockWorkSource = new <span class="hljs-built_in">WorkSource</span>();
    return true;
}
</code></pre>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€è®¡æ•°æœºåˆ¶è¯¦è§£</h3>
<p><strong>å¤šä¸ªå¹¶å‘ RIL è¯·æ±‚</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">æ—¶åˆ» <span class="hljs-number">1</span>ï¼šRequest <span class="hljs-selector-tag">A</span>ï¼ˆgetSignalStrengthï¼‰
   mWakeLockCount = <span class="hljs-number">0</span>
   <span class="hljs-built_in">acquireWakeLock</span>(A) â†’ mWakeLock<span class="hljs-selector-class">.acquire</span>()
   mWakeLockCount = <span class="hljs-number">1</span>
   
æ—¶åˆ» <span class="hljs-number">2</span>ï¼šRequest <span class="hljs-selector-tag">B</span>ï¼ˆgetDataCallListï¼‰åˆ°è¾¾ï¼Œ<span class="hljs-selector-tag">A</span> è¿˜æœªå®Œæˆ
   <span class="hljs-built_in">acquireWakeLock</span>(B) â†’ mWakeLock å·²æŒæœ‰ï¼Œä¸å† <span class="hljs-built_in">acquire</span>()
   mWakeLockCount = <span class="hljs-number">2</span>
   
æ—¶åˆ» <span class="hljs-number">3</span>ï¼šRequest Cï¼ˆqueryNetworkSelectionModeï¼‰åˆ°è¾¾
   <span class="hljs-built_in">acquireWakeLock</span>(C)
   mWakeLockCount = <span class="hljs-number">3</span>
   
æ—¶åˆ» <span class="hljs-number">4</span>ï¼šRequest <span class="hljs-selector-tag">A</span> å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(A)
   mWakeLockCount = <span class="hljs-number">3</span> - <span class="hljs-number">1</span> = <span class="hljs-number">2</span>
   <span class="hljs-comment">// ä¸è°ƒç”¨ mWakeLock.release()ï¼Œå› ä¸ºè¿˜æœ‰å…¶ä»–è¯·æ±‚</span>
   
æ—¶åˆ» <span class="hljs-number">5</span>ï¼šRequest <span class="hljs-selector-tag">B</span> å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(B)
   mWakeLockCount = <span class="hljs-number">2</span> - <span class="hljs-number">1</span> = <span class="hljs-number">1</span>
   <span class="hljs-comment">// ä»ä¸é‡Šæ”¾</span>
   
æ—¶åˆ» <span class="hljs-number">6</span>ï¼šRequest C å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(C)
   mWakeLockCount = <span class="hljs-number">1</span> - <span class="hljs-number">1</span> = <span class="hljs-number">0</span>
   mWakeLock<span class="hljs-selector-class">.release</span>()  <span class="hljs-comment">// â† æœ€åä¸€ä¸ªå®Œæˆæ—¶é‡Šæ”¾</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>åªåœ¨æ‰€æœ‰ RIL è¯·æ±‚éƒ½å®Œæˆåæ‰é‡Šæ”¾ WakeLock</li>
<li>CPU æŒç»­æ´»è·ƒï¼Œé¿å…é¢‘ç¹å”¤é†’</li>
<li>å‡å°‘ç”µæ± æ¶ˆè€—</li>
</ul>
<hr/>
<h3 data-id="heading-3">å››ã€WorkSource å’Œ BatteryStats è¿½è¸ª</h3>
<p><strong>æ ¸å¿ƒæœºåˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¯ä¸ª RIL è¯·æ±‚éƒ½å…³è”ä¸€ä¸ª WorkSourceï¼ˆè¡¨ç¤ºå“ªä¸ªåº”ç”¨è§¦å‘çš„ï¼‰</span>
<span class="hljs-type">String</span> <span class="hljs-variable">clientId</span> <span class="hljs-operator">=</span> rr.getWorkSourceClientId();

<span class="hljs-comment">// å¦‚æœè¯¥å®¢æˆ·ç«¯æ˜¯ç¬¬ä¸€æ¬¡ï¼Œæ·»åŠ å…¶ WorkSource</span>
<span class="hljs-keyword">if</span> (!mClientWakelockTracker.isClientActive(clientId)) {
    mActiveWakelockWorkSource.add(rr.mWorkSource);
    mWakeLock.setWorkSource(mActiveWakelockWorkSource);
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼š</span>
App A è°ƒç”¨ TelephonyManager.getSignalStrength()
   â†“ WorkSource = <span class="hljs-string">"App A"</span>
   â†“ setWorkSource(<span class="hljs-string">"App A"</span>)
   â†“ BatteryStats è®°å½•ï¼šApp A å¯¼è‡´ CPU å”¤é†’

App B è°ƒç”¨ TelephonyManager.getDataCallList()
   â†“ åŒæ—¶åˆ°è¾¾ï¼ˆApp A è¿˜æœªå®Œæˆï¼‰
   â†“ WorkSource = <span class="hljs-string">"App A, App B"</span>
   â†“ setWorkSource(<span class="hljs-string">"App A, App B"</span>)
   â†“ BatteryStats è®°å½•ï¼šApp A å’Œ App B å…±åŒå¯¼è‡´ CPU å”¤é†’
</code></pre>
<p><strong>BatteryStats æœ€ç»ˆæ˜¾ç¤º</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Settings â†’ Battery
  â€¢ App <span class="hljs-selector-tag">A</span>ï¼š<span class="hljs-number">5%</span> (åŒ…æ‹¬ RIL å”¤é†’æ¶ˆè€—)
  â€¢ App <span class="hljs-selector-tag">B</span>ï¼š<span class="hljs-number">3%</span> (åŒ…æ‹¬ RIL å”¤é†’æ¶ˆè€—)
  â€¢ System (Telephony)ï¼š<span class="hljs-number">2%</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">äº”ã€ACK WakeLock</h3>
<p><strong>ç›®çš„</strong>ï¼šç¡®ä¿å‘ Modem å‘é€ ACK å“åº”ä¸è¢«ä¸­æ–­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‘é€ ACK æ—¶è·å–</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendAck</span><span class="hljs-params">(<span class="hljs-type">int</span> service)</span> {
    <span class="hljs-type">RILRequest</span> <span class="hljs-variable">rr</span> <span class="hljs-operator">=</span> RILRequest.obtain(RIL_RESPONSE_ACKNOWLEDGEMENT, <span class="hljs-literal">null</span>,
            mRILDefaultWorkSource);
    acquireWakeLock(rr, FOR_ACK_WAKELOCK);
    â†“
    <span class="hljs-keyword">synchronized</span> (mAckWakeLock) {
        mAckWakeLock.acquire();  <span class="hljs-comment">// ç‹¬ç«‹çš„ WakeLock</span>
        mAckWlSequenceNum++;
        
        <span class="hljs-comment">// è¶…æ—¶ä¿æŠ¤ï¼š200msï¼ˆæ¯” FOR_WAKELOCK çš„ 25s çŸ­å¾ˆå¤šï¼‰</span>
        <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mRilHandler.obtainMessage(EVENT_ACK_WAKE_LOCK_TIMEOUT);
        msg.arg1 = mAckWlSequenceNum;
        mRilHandler.sendMessageDelayed(msg, mAckWakeLockTimeout);
    }
}

<span class="hljs-comment">// åŒºåˆ«ï¼š</span>
<span class="hljs-comment">// FOR_WAKELOCKï¼š</span>
<span class="hljs-comment">//   â€¢ ç­‰å¾… Modem å“åº”ï¼ˆå¯èƒ½å¾ˆé•¿ï¼‰</span>
<span class="hljs-comment">//   â€¢ æ”¯æŒè®¡æ•°</span>
<span class="hljs-comment">//   â€¢ è¶…æ—¶ 25s</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// FOR_ACK_WAKELOCKï¼š</span>
<span class="hljs-comment">//   â€¢ ä»…ç”¨äºå‘é€ ACK</span>
<span class="hljs-comment">//   â€¢ ä¸è®¡æ•°ï¼ˆæ¯æ¬¡ç‹¬ç«‹ï¼‰</span>
<span class="hljs-comment">//   â€¢ è¶…æ—¶ 200ms</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">å…­ã€å…¶ä»– WakeLock ä½¿ç”¨åœºæ™¯</h3>
<p><strong>åœºæ™¯ 1ï¼šçŸ­ä¿¡å¤„ç†ï¼ˆInboundSmsHandlerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–å¹¶æŒæœ‰</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) mContext.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, name);
mWakeLock.acquire();    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–</span>
mWakeLock.setReferenceCounted(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// æ”¯æŒåµŒå¥—</span>

<span class="hljs-comment">// è¿›å…¥ WaitingState æ—¶çš„è¶…æ—¶</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaitingState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enter</span><span class="hljs-params">()</span> {
        mWakeLock.acquire();  <span class="hljs-comment">// è‹¥æœªè·å–ï¼Œåˆ™è·å–</span>
        
        <span class="hljs-comment">// 10 åˆ†é’Ÿè¶…æ—¶ä¿æŠ¤</span>
        sendMessageDelayed(obtainMessage(EVENT_RECEIVER_TIMEOUT),
                          SMS_WAKELOCK_TIMEOUT_MS);  <span class="hljs-comment">// 600,000ms</span>
    }
}

<span class="hljs-comment">// æµç¨‹ï¼š</span>
æ”¶åˆ°çŸ­ä¿¡
   â†“ è·å– WakeLockï¼ˆæˆ–å¢åŠ è®¡æ•°ï¼‰
   â†“ è¿›å…¥ WaitingState
   â†“ å¹¿æ’­ SMS_RECEIVED intent
   â†“ åº”ç”¨å¤„ç†çŸ­ä¿¡ï¼ˆå¯èƒ½å¾ˆæ…¢ï¼‰
   â†“ åº”ç”¨è°ƒç”¨ setResultCode(RESULT_OK)
   â†“ è¿›å…¥ä¸‹ä¸€çŠ¶æ€
   â†“ é‡Šæ”¾ WakeLockï¼ˆæˆ–å‡å°‘è®¡æ•°ï¼‰
   
è¶…æ—¶ï¼ˆ<span class="hljs-number">10</span> åˆ†é’Ÿï¼‰ï¼š
   â†“ EVENT_RECEIVER_TIMEOUT è§¦å‘
   â†“ å¼ºåˆ¶é‡Šæ”¾ WakeLock
   â†“ ç»§ç»­å¤„ç†çŸ­ä¿¡ï¼Œä¸ä¼šæ°¸ä¹…é˜»å¡
</code></pre>
<p><strong>åœºæ™¯ 2ï¼šPost-Dial ç­‰å¾…ï¼ˆGsmCdmaConnectionï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç”¨æˆ·æ‹¨å· *123# ç­‰å¾…ç»“æœ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPostDialState</span><span class="hljs-params">(PostDialState s)</span> {
    <span class="hljs-keyword">if</span> (s == PostDialState.STARTED || s == PostDialState.PAUSE) {
        <span class="hljs-keyword">synchronized</span> (mPartialWakeLock) {
            <span class="hljs-keyword">if</span> (mPartialWakeLock.isHeld()) {
                mHandler.removeMessages(EVENT_WAKE_LOCK_TIMEOUT);
            } <span class="hljs-keyword">else</span> {
                acquireWakeLock();  <span class="hljs-comment">// è·å–</span>
            }
            
            <span class="hljs-comment">// 3 åˆ†é’Ÿè¶…æ—¶</span>
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mHandler.obtainMessage(EVENT_WAKE_LOCK_TIMEOUT);
            mHandler.sendMessageDelayed(msg, WAKE_LOCK_TIMEOUT_MILLIS);  <span class="hljs-comment">// 60,000ms</span>
        }
    } <span class="hljs-keyword">else</span> {
        mHandler.removeMessages(EVENT_WAKE_LOCK_TIMEOUT);
        releaseWakeLock();  <span class="hljs-comment">// é‡Šæ”¾</span>
    }
}

<span class="hljs-comment">// è¶…æ—¶ä¿æŠ¤ï¼šé˜²æ­¢ç”¨æˆ·æŒ‰é”™æŒ‰é’®ä½†ä¸ç»§ç»­ï¼Œå¯¼è‡´ WakeLock æ°¸ä¹…æŒæœ‰</span>
</code></pre>
<p><strong>åœºæ™¯ 3ï¼šIMS ç”µè¯ï¼ˆImsPhoneï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getServicesSy <span class="hljs-title function_">stem</span><span class="hljs-params">(Context.POWER_SERVICE)</span>;
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, LOG_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// ç”¨äº IMS ç›¸å…³æ“ä½œä¿æŒè®¾å¤‡å”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 4ï¼šç´§æ€¥é€šè¯ï¼ˆEmergencyStateTrackerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> context.getSystemService(PowerManager.class);
mWakeLock = (pm != <span class="hljs-literal">null</span>) ? pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
        <span class="hljs-string">"telephony:"</span> + TAG) : <span class="hljs-literal">null</span>;

<span class="hljs-comment">// ç´§æ€¥é€šè¯æœŸé—´ç»´æŒ WakeLockï¼Œç¡®ä¿ä¸è¿›å…¥ç¡çœ </span>
</code></pre>
<p><strong>åœºæ™¯ 5ï¼šNITZ æ—¶é—´éªŒè¯</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¿«é€Ÿè¯»å– elapsedRealtime æ—¶éœ€è¦ WakeLock</span>
<span class="hljs-type">WakeLock</span> <span class="hljs-variable">wakeLock</span> <span class="hljs-operator">=</span> powerManager.newWakeLock(
        PowerManager.PARTIAL_WAKE_LOCK, WAKELOCK_TAG);

<span class="hljs-keyword">try</span> {
    wakeLock.acquire();  <span class="hljs-comment">// è·å–</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">elapsedRealtime</span> <span class="hljs-operator">=</span> deviceState.elapsedRealtimeMillis();
    <span class="hljs-comment">// ... éªŒè¯é€»è¾‘</span>
} <span class="hljs-keyword">finally</span> {
    wakeLock.release();  <span class="hljs-comment">// é‡Šæ”¾</span>
}
</code></pre>
<p><strong>åœºæ™¯ 6ï¼šSmsStorageMonitor</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, <span class="hljs-string">"SmsStorageMonitor"</span>);
mWakeLock.setReferenceCounted(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// æ”¯æŒåµŒå¥—è®¡æ•°</span>

<span class="hljs-comment">// å‘é€ SMS å­˜å‚¨çŠ¶æ€æŠ¥å‘Šæ—¶ä¿æŒå”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 7ï¼šå¤šå¡åˆ‡æ¢ï¼ˆProxyControllerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, LOG_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// è®¾ç½®æ— çº¿åŠŸèƒ½é…ç½®æ—¶ä¿æŒå”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 8ï¼šWakeLockStateMachine</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çŠ¶æ€æœºåŸºç¡€ç±»çš„ WakeLock ç®¡ç†</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, debugTag);
mWakeLock.acquire();  <span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–</span>

<span class="hljs-comment">// è¿›å…¥ IdleState æ—¶é‡Šæ”¾</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">releaseWakeLock</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (mWakeLock.isHeld()) {
        mWakeLock.release();
    }
}

<span class="hljs-comment">// ç”¨é€”ï¼šç”¨äºæ¥æ”¶å¹¿æ’­çš„æ¨¡å—ï¼ˆå¦‚ SMSï¼‰ï¼Œéœ€è¦ä» Idle çŠ¶æ€å¿«é€Ÿå”¤é†’</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">ä¸ƒã€WakeLock çš„æ€§èƒ½å½±å“</h3>
<p><strong>CPU åŠŸè€—å¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">CPU çŠ¶æ€         åŠŸè€—      è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ­£å¸¸è¿è¡Œ         1000 mW   å±å¹•äº®ã€åº”ç”¨æ´»è·ƒ
PARTIAL_WAKE_LOCK 20 mW   å±å¹•ç­ã€CPU æ´»è·ƒï¼ˆä»åœ¨å¤„ç†ï¼‰
å®Œå…¨ç¡çœ          5 mW     å±å¹•ç­ã€CPU ç¡çœ 

RIL WakeLock æŒæœ‰æ—¶é—´å…¸å‹å€¼ï¼š
  â€¢ getSignalStrengthï¼š100-500ms
  â€¢ setupDataCallï¼š500ms-5s
  â€¢ è¶…æ—¶é‡Šæ”¾ï¼š25sï¼ˆå¼‚å¸¸æƒ…å†µï¼‰

ç”µæ± æ¶ˆè€—ä¼°ç®—ï¼š
  â€¢ 1000 ä¸ª RIL è¯·æ±‚/å¤©ï¼Œå¹³å‡ <span class="hljs-attr">200ms</span> = <span class="hljs-number">200</span>s Ã— <span class="hljs-number">20</span>mW = <span class="hljs-number">4000</span>mWs = <span class="hljs-number">1.1</span>mAh
  â€¢ ç›¸å¯¹æ€»å®¹é‡ 4000mAhï¼š0.028% ç”µæ± æ¶ˆè€—
</code></pre>
<hr/>
<h3 data-id="heading-7">å…«ã€ç›‘æ§å’Œè°ƒè¯•</h3>
<p><strong>æ—¥å¿—ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// RIL.java ä¸­çš„æ—¥å¿—</span>
<span class="hljs-string">"WAKE_LOCK_TIMEOUT mRequestList="</span> + count
<span class="hljs-comment">// è¡¨ç¤ºæœ‰ count ä¸ª RIL è¯·æ±‚æœªå®Œæˆ</span>

<span class="hljs-string">"ACK_WAKE_LOCK_TIMEOUT"</span>
<span class="hljs-comment">// ACK å‘é€è¶…æ—¶ï¼ˆ200msï¼‰</span>

<span class="hljs-comment">// æ¯ä¸ªè¯·æ±‚çš„è¿½è¸ª</span>
mClientWakelockTracker.startTracking(rr.mClientId, rr.mRequest, rr.mSerial, mWakeLockCount);
<span class="hljs-comment">// è®°å½•ï¼šå“ªä¸ªå®¢æˆ·ç«¯ã€ä»€ä¹ˆè¯·æ±‚ã€åºåˆ—å·ã€å½“å‰è®¡æ•°</span>
</code></pre>
<p><strong>BatteryStats æŸ¥è¯¢</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">adb shell dumpsys battery unreachable
adb shell dumpsys power_profile

<span class="hljs-comment">// æŸ¥çœ‹ WakeLock æŒæœ‰æƒ…å†µ</span>
adb shell dumpsys power_manager | grep WakeLock
</code></pre>
<hr/>
<h3 data-id="heading-8">ä¹ã€æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å§‹ç»ˆä½¿ç”¨ PARTIAL<span class="hljs-emphasis">_WAKE_</span>LOCK
   â€¢ å±å¹•å¯å…³é—­ï¼ŒèŠ‚çœç”µæ± 
   â€¢ å¯¹ç”¨æˆ·æ— æ„ŸçŸ¥

<span class="hljs-bullet">2.</span> è®¾ç½®è¶…æ—¶ä¿æŠ¤
   â€¢ é˜²æ­¢æ­»é”å¯¼è‡´æ°¸ä¹…æŒæœ‰
   â€¢ Telephony ä¸­ç»Ÿä¸€ 25s è¶…æ—¶

<span class="hljs-bullet">3.</span> æ­£ç¡®ä½¿ç”¨ WorkSource
   â€¢ ç”¨äº BatteryStats è¿½è¸ª
   â€¢ å¸®åŠ©è¯Šæ–­é—®é¢˜åº”ç”¨

<span class="hljs-bullet">4.</span> é‡Šæ”¾å‰æ£€æŸ¥ isHeld()
   â€¢ é˜²æ­¢é‡å¤é‡Šæ”¾å¼‚å¸¸
   
<span class="hljs-bullet">5.</span> ä½¿ç”¨ synchronized ä¿æŠ¤
   â€¢ WakeLock éçº¿ç¨‹å®‰å…¨
   â€¢ æ‰€æœ‰è·å–/é‡Šæ”¾éƒ½è¦åŒæ­¥

<span class="hljs-bullet">6.</span> ç›‘æ§è®¡æ•°ä¸€è‡´æ€§
   â€¢ acquire() å’Œ release() è¦é…å¯¹
   â€¢ è®¡æ•°ä¸åŒ¹é…è¡¨ç¤ºæœ‰æ³„æ¼
</code></pre>
<hr/>
<h2 data-id="heading-9">æ€»ç»“</h2>















































<table><thead><tr><th>æ–¹é¢</th><th>RIL WakeLock</th><th>SMS WakeLock</th><th>Post-Dial WakeLock</th></tr></thead><tbody><tr><td><strong>è·å–æ—¶æœº</strong></td><td>RIL è¯·æ±‚å‘é€</td><td>SMS æ”¶åˆ°</td><td>æ‹¨å·åç­‰å¾…</td></tr><tr><td><strong>é‡Šæ”¾æ—¶æœº</strong></td><td>Modem å“åº”</td><td>å¹¿æ’­å¤„ç†å®Œæˆ</td><td>æ‹¨å·å®Œæˆæˆ–è¶…æ—¶</td></tr><tr><td><strong>è¶…æ—¶æ—¶é—´</strong></td><td>25s</td><td>10 åˆ†é’Ÿ</td><td>3 åˆ†é’Ÿ</td></tr><tr><td><strong>è®¡æ•°æ”¯æŒ</strong></td><td>æ˜¯ï¼ˆå¤šè¯·æ±‚å¹¶å‘ï¼‰</td><td>æ˜¯ï¼ˆé‡å…¥ï¼‰</td><td>å¦ï¼ˆå•ä¸ªè¿æ¥ï¼‰</td></tr><tr><td><strong>WorkSource è¿½è¸ª</strong></td><td>æ˜¯ï¼ˆç”¨äº BatteryStatsï¼‰</td><td>å¦</td><td>å¦</td></tr><tr><td><strong>å…³é”®ç”¨é€”</strong></td><td>é˜²æ­¢ Modem é€šä¿¡ä¸­æ–­</td><td>é˜²æ­¢çŸ­ä¿¡å¤„ç†ä¸­æ–­</td><td>é˜²æ­¢ç”¨æˆ·æ‹¨å·ä¸­æ–­</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºLangChain4J]]></title>    <link>https://juejin.cn/post/7603653885601939506</link>    <guid>https://juejin.cn/post/7603653885601939506</guid>    <pubDate>2026-02-07T08:54:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601939506" data-draft-id="7603653885601923122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºLangChain4J"/> <meta itemprop="keywords" content="LangChain,Java,LLM"/> <meta itemprop="datePublished" content="2026-02-07T08:54:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è›‡çš®åˆ’æ°´æ€ª"/> <meta itemprop="url" content="https://juejin.cn/user/4301752340323736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºLangChain4J
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4301752340323736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è›‡çš®åˆ’æ°´æ€ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:54:13.000Z" title="Sat Feb 07 2026 08:54:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥æµ…å‡ºLangChain4J</h2>
<h3 data-id="heading-1">1.èµ°è¿›LangChain</h3>
<h4 data-id="heading-2">1.1.ä»€ä¹ˆæ˜¯LangChain4Jï¼Ÿ</h4>
<blockquote>
<p>The goal of LangChain4J is to simplify integrating LLMs into Java applications.</p>
<p>â€‹													-- ã€ŠLangChain4J Docã€‹</p>
</blockquote>
<p>LangChain4Jå°±åƒJavaçš„Springæ¡†æ¶ä¸€æ ·ï¼Œä¸ºLLMçš„æ¥å…¥æä¾›äº†ä¸€å¥—æ ‡å‡†çš„æ¥å…¥èƒ½åŠ›ã€‚LangChain4Jæ˜¯LangChainåœ¨Javaç”Ÿæ€ä¸‹çš„å…·ä½“å®ç°ï¼Œç”¨äºæ„å»ºåŸºäºLLMçš„åº”ç”¨å’ŒAgentç³»ç»Ÿã€‚</p>
<p>LangChain4Jä¸ºä¸åŒçš„LLMæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„APIï¼Œå±è”½äº†åº•å±‚APIä¾›åº”å•†çš„å®ç°å’Œè°ƒç”¨å·®å¼‚ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨LangChainæ— ç¼åˆ‡æ¢ä¸åŒçš„LLMã€‚</p>
<h3 data-id="heading-3">2.Architecture of LangChain4J</h3>
<p>LangChain4Jçš„æ¶æ„å¯ä»¥åˆ†ä¸ºä¸¤å±‚ï¼Œåˆ†åˆ«ä¸ºé«˜å±‚å’Œåº•å±‚ã€‚</p>
<p>é«˜å±‚AIæœåŠ¡å±è”½äº†åº•å±‚å®ç°çš„ç»†èŠ‚ï¼Œå¼€å‘è€…å¯ä»¥å®ç°ä¸€äº›ä¸šåŠ¡æœåŠ¡çš„APIå’ŒLLMè¿›è¡Œäº¤äº’ã€‚</p>
<p>ä½å±‚å…·æœ‰æ›´é«˜çš„è‡ªç”±åº¦ï¼Œä½ å¯ä»¥ä»»æ„å®šä¹‰ç»„ä»¶çš„å…·ä½“å®ç°ï¼Œæ§åˆ¶ç»„ä»¶çš„ç»„åˆæ–¹å¼ç­‰ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38410b31fa5441a19db46f414a0e5de7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JuH55qu5YiS5rC05oCq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059252&amp;x-signature=QeRuLmB275BYOqtv%2BQEeaGAc5H0%3D" alt="image-20260206114437130" loading="lazy"/></p>
<p>ä¸‹é¢ï¼Œå°±LangChain4Jçš„æ ¸å¿ƒç»„ä»¶ï¼Œä¸€ä¸€è¯¦ç»†ä»‹ç»ã€‚</p>
<h4 data-id="heading-4">2.1.Chat and Language Model</h4>
<p>ä¸€èˆ¬åœ°ï¼ŒLLMsçš„APIå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œ</p>
<ul>
<li><code>LanguageModel</code>ï¼šè¾“å…¥è¾“å‡ºéƒ½ä¸º<code>String</code>ç±»å‹ï¼Œç°åœ¨ä½¿ç”¨çš„è¶Šæ¥è¶Šå°‘äº†</li>
<li><code>ChatModel</code>ï¼šåº”ç”¨å¹¿æ³›çš„ä¸€ç±»APIï¼Œæ¥æ”¶å¤šä¸ª<code>ChatMessage</code>ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ª<code>AiMessage</code>ï¼Œé™¤äº†æ–‡æœ¬ç±»å‹ä¹‹å¤–ï¼Œè¿˜æ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å…¶ä»–æ¨¡å¼ã€‚</li>
</ul>
<p><code>ChatModel</code>æ˜¯LangChain4Jçš„ä½å±‚APIï¼Œæä¾›å¼ºå¤§çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>æ ¹æ®æ¶ˆæ¯æ¥æºè¿›è¡Œåˆ†ç±»ï¼ŒLangChain4Jæ”¯æŒä»¥ä¸‹äº”ç§æ¶ˆæ¯ç±»å‹ï¼š</p>



































<table><thead><tr><th>æ¶ˆæ¯ç±»å‹</th><th>æè¿°</th><th>ä¸»è¦æ–¹æ³•</th></tr></thead><tbody><tr><td>UserMessage</td><td>ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯æ•°æ®</td><td>content(), name(), attributes()</td></tr><tr><td>AiMessage</td><td>AIæ ¹æ®è¾“å…¥æ•°æ®ç”Ÿæˆçš„æ¶ˆæ¯</td><td>text(), thinking(), toolExceptionRequests(), attributes()</td></tr><tr><td>ToolExecutionResultMessage</td><td>å·¥å…·æ‰§è¡Œç»“æœæ¶ˆæ¯</td><td/></tr><tr><td>SystemMessage</td><td>ç³»ç»Ÿå‘é€çš„æ¶ˆæ¯ï¼Œå¯ä»¥ç”±å¼€å‘è€…è‡ªå®šä¹‰</td><td/></tr><tr><td>CustomMessage</td><td>è‡ªå®šä¹‰æ¶ˆæ¯</td><td/></tr></tbody></table>
<h4 data-id="heading-5">2.2.Chat Memory</h4>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤§æ¨¡å‹æ˜¯æ— çŠ¶æ€çš„ï¼Œæ¨¡å‹æœ¬èº«å¹¶ä¸ä¼šè®°å½•å¯¹è¯ä¸Šä¸‹æ–‡ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦åœ¨å¯¹è¯ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡çš„å†…å®¹ï¼Œå°±å¿…é¡»ä¸»åŠ¨ç»´æŠ¤ç®¡ç†<code>ChatMessage</code>ã€‚ä½†æ˜¯æ‰‹åŠ¨ç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œè€ŒLangChain4Jæä¾›äº†<code>ChatMemory</code>ç”¨æ¥ç»´æŠ¤ç®¡ç†chatMessage.</p>
<h5 data-id="heading-6">2.2.1.History VS Memory</h5>
<p>å†å²è®°å½•å’Œè®°å¿†å¬èµ·æ¥ä¼¼ä¹æ˜¯åŒä¸€ç§ä¸œè¥¿ï¼Œä½†æ˜¯å¯¹äºLLM Agentæ¥è¯´ï¼Œhistoryå’Œmemoryå…·æœ‰ä¸¤ç§æˆªç„¶ä¸åŒçš„è¯­ä¹‰ï¼š</p>
<ul>
<li><code>history</code>ä¿ç•™äº†ç”¨æˆ·å’ŒAIçš„æ‰€æœ‰ä¼šè¯è®°å½•ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç•Œé¢ä¸­çœ‹åˆ°</li>
<li><code>memory</code>è®°å½•çš„æ˜¯ä¸“é—¨å‘ˆç°ç»™å¤§æ¨¡å‹ä½¿ç”¨çš„ä¿¡æ¯ï¼Œä½¿å…¶è¡¨ç°å¾—å¥½åƒæ˜¯â€œè®°ä½äº†â€å¯¹è¯çš„å†…å®¹ï¼Œå®é™…åº•å±‚å®ç°æ˜¯æˆªç„¶ä¸åŒçš„ç®—æ³•ã€‚</li>
</ul>
<p>LangChain4Jç›®å‰åªæä¾›<strong>Memroy</strong>ï¼Œè€Œä¸æä¾›<strong>History</strong>ã€‚</p>
<p>ä¸‹é¢ä»‹ç»å…³äºMemoryçš„å‡ ç‚¹é«˜çº§ç‰¹æ€§ã€‚</p>
<h5 data-id="heading-7">2.2.2.Eviction Policy æ·˜æ±°ç­–ç•¥</h5>
<p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·˜æ±°ç­–ç•¥ï¼Ÿ</strong></p>
<ul>
<li><strong>å­˜å‚¨ç©ºé—´å—é™</strong>ï¼šMemoryç»„ä»¶å¯ä»¥ç†è§£ä¸ºç¼“å­˜ï¼Œå½“å­˜æ”¾çš„å†…å®¹è¶…è¿‡å®¹é‡å¤§å°çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ä¸€å®šçš„ç­–ç•¥æ·˜æ±°ä¸€äº›è®°å¿†ï¼›</li>
<li><strong>Tokenæˆæœ¬æ˜‚è´µ</strong>ï¼šæ›´å¤šçš„ä¸Šä¸‹æ–‡è®°å¿†å°±ä»£è¡¨ä½¿ç”¨æ›´å¤šçš„Tokenï¼Œè€Œtokençš„å¢åŠ ä¼šå¢åŠ æ¯æ¬¡è°ƒç”¨LLMçš„æˆæœ¬ï¼›</li>
<li><strong>æ§åˆ¶å»¶è¿Ÿ</strong>ï¼šå‘é€çš„LLMçš„tokenè¶Šå¤šï¼Œå¤„ç†ä»–ä»¬æ‰€éœ€è¦çš„æ—¶é•¿è¶Šé•¿ï¼Œåˆ™ç”¨æˆ·ç­‰å¾…è¾“å‡ºçš„æ—¶é—´è¶Šé•¿</li>
</ul>
<p>LangChain4Jç›®å‰æ”¯æŒä¸¤ç§å¼€ç®±å³ç”¨çš„è®°å¿†æ·˜æ±°ç­–ç•¥ï¼š</p>
<ol>
<li>åŸºäºæ¶ˆæ¯æ»‘åŠ¨çª—å£ï¼šä½¿ç”¨<code>MessageWindowChatMemory</code>ä½œä¸ºæ»‘åŠ¨çª—å£ï¼Œä»…ä¿ç•™æœ€è¿‘çš„Næ¡ä¿¡æ¯ï¼Œæ·˜æ±°çª—å£ä¹‹å¤–çš„æ—§æ¶ˆæ¯ï¼›</li>
<li>åŸºäºtokençš„æ»‘åŠ¨çª—å£ï¼š<code>TokenWindowChatMemory</code>åªä¿ç•™æœ€è¿‘çš„Nä¸ªtokenã€‚ä½†æ˜¯æ¶ˆæ¯æ˜¯ä¸å¯å†åˆ†çš„ï¼Œå› æ­¤å¦‚æœæ¶ˆæ¯ä¸åˆé€‚çš„è¯ï¼Œæ•´æ¡æ¶ˆæ¯ä¼šç›´æ¥è¢«ä¸¢å¼ƒã€‚</li>
</ol>
<h5 data-id="heading-8">2.2.3.Persistence æŒä¹…åŒ–</h5>
<p>é»˜è®¤æƒ…å†µä¸‹Memoryæ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œå¦‚æœéœ€è¦ä¿ç•™æ¶ˆæ¯ï¼Œå¯ä»¥è‡ªå®šä¹‰å®ç°<code>MessageStore</code>ï¼Œå°†<code>chatMessage</code>å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PersistentChatMemroyStore</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChatMemoryStore</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;ChatMessage&gt; <span class="hljs-title function_">getMessages</span><span class="hljs-params">(Object memoryId)</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMessages</span><span class="hljs-params">(Object memoryId, List&lt;ChatMessage&gt; messages)</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteMessages</span><span class="hljs-params">(Object memoryId)</span> {
      <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement deleting all messages in the persistent store by memory ID.</span>
    }
}
</code></pre>
<h5 data-id="heading-9">2.2.4.SystemMessage</h5>
<p>SystemMessageæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¶ˆæ¯ï¼Œå…·æœ‰å¦‚ä¸‹çš„ç‰¹æ€§ï¼š</p>
<ul>
<li>ä¸€æ—¦æ·»åŠ ï¼Œå°±ä¼šä¸€ç›´è¢«ä¿ç•™ï¼Œä¸ä¼šè¢«æ·˜æ±°ç­–ç•¥æ·˜æ±°</li>
<li>ä¸€æ¬¡åªèƒ½æŒæœ‰ä¸€ä¸ª<code>SystemMessage</code></li>
<li><code>SystemMessage</code>å…·æœ‰å”¯ä¸€æ€§ï¼Œé‡å¤çš„SystemMessageä¼šè¢«å¿½ç•¥ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™ä¼šè¦†ç›–æ‰ä¹‹å‰çš„<code>SystemMessage</code></li>
</ul>
<h5 data-id="heading-10">2.2.5.Tool æ¶ˆæ¯é…å¯¹</h5>
<p>AIMessage ä¸­çš„ <code>ToolExecutionRequest</code> å’Œ <code>ToolExecutionResponse</code> æ€»æ˜¯æˆå¯¹å‡ºç°çš„ã€‚å¦‚æœ <code>ToolExecutionRequest</code> è¢«æ·˜æ±°äº†ï¼Œåˆ™å…¶å¯¹åº”çš„ <code>ToolExecutionResponse</code> æ¶ˆæ¯ä¹Ÿä¼šè¢«è‡ªåŠ¨æ·˜æ±°ã€‚</p>
<h4 data-id="heading-11">2.3.Tools(Function Calling)</h4>
<p>å·¥å…·(Tools)å…è®¸LLMåœ¨å¿…è¦çš„æ—¶å€™è°ƒç”¨å¼€å‘è€…å®šä¹‰çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯ç”¨å·¥å…·ï¼Œå·¥å…·æ˜¯ä¸€ä¸ªæ³›ç§°ï¼Œå¯ä»¥è¡¨ç¤ºä»»ä½•ä¸œè¥¿ï¼Œä¾‹å¦‚ç½‘é¡µæœç´¢ã€å¤–éƒ¨APIã€æˆ–è€…æ‰§è¡Œç‰¹å®šçš„ä»£ç ç­‰ç­‰ã€‚</p>
<p>å®é™…ä¸ŠLLMå¹¶ä¸ä¼šå»ä¸»åŠ¨è°ƒç”¨å·¥å…·ï¼Œè€Œæ˜¯é€šè¿‡å¼€å‘äººå‘˜åœ¨ä¸šåŠ¡å±‚æ¥æ”¶LLMçš„å›å¤ï¼Œæ ¹æ®LLMçš„æ„æ„¿è¿›è¡Œå·¥å…·çš„è°ƒç”¨å¹¶å°†æ‰§è¡Œç»“æœåé¦ˆç»™LLMã€‚</p>
<p>ä¸€ä¸ªè‰¯å¥½çš„å·¥å…·åº”å½“å…·æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š</p>
<ol>
<li>æ¸…æ™°æ˜ç¡®çš„å·¥å…·åç§°</li>
<li>å·¥å…·çš„å…·ä½“æè¿°ï¼Œä»¥åŠåº”è¯¥ä½•æ—¶ä½¿ç”¨å·¥å…·ï¼›</li>
<li>æ¯ä¸ªå·¥å…·çš„å…·ä½“å‚æ•°ï¼›</li>
</ol>
<blockquote>
<p>å¦‚æœè¿™ä¸ªå·¥å…·å¯¹äºäººæ¥è¯´ä¸€çœ¼å°±èƒ½ç†è§£åº”è¯¥å¦‚ä½•ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå·¥å…·å¯¹äºLLMä¹Ÿæ˜¯æ˜“äºä½¿ç”¨çš„ã€‚</p>
</blockquote>
<p>Toolsçš„å®šä¹‰å’Œä½¿ç”¨å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain4j.dev%2Ftutorials%2Ftools" target="_blank" title="https://docs.langchain4j.dev/tutorials/tools" ref="nofollow noopener noreferrer">LangChain4J Documents</a></p>
<h4 data-id="heading-12">2.4.Agent</h4>
<h3 data-id="heading-13">3.å®æˆ˜</h3>
<h4 data-id="heading-14">3.1.ChatModel</h4>
<h5 data-id="heading-15">3.1.1.åŸºæœ¬èŠå¤©</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-comment">// 1.åˆ›å»º chatModel</span>
    <span class="hljs-type">OpenAiChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(System.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>))
            .baseUrl(System.getenv(<span class="hljs-string">"OPENAI_BASE_URL"</span>))
            .modelName(System.getenv(<span class="hljs-string">"OPENAI_MODEL"</span>))
            .build();

    <span class="hljs-comment">// 2.ä½¿ç”¨ chat æ–¹æ³•å‘èµ·å¯¹è¯</span>
    <span class="hljs-type">ChatResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatModel.chat(ChatRequest.builder()
            .messages(UserMessage.from(<span class="hljs-string">"Hello, could you introduce yourself ?"</span>))
            .build());


    <span class="hljs-comment">// 3.æ§åˆ¶å°æ‰“å°</span>
    System.out.println(response.aiMessage().text());
}
</code></pre>
<h5 data-id="heading-16">3.1.2.å¤šè½®å¯¹è¯</h5>
<p>å¤šè½®å¯¹è¯å’ŒåŸºæœ¬å¯¹è¯çš„å®ç°æ–¹å¼ç›¸åŒï¼Œåªä¸è¿‡æ„å»ºå¯¹è¯è¯·æ±‚çš„æ—¶å€™ï¼Œéœ€è¦å°†å‰æ–‡ä¼ å…¥åˆ°<code>messages</code>ä¸­ï¼ŒLLMä¼šå‚è€ƒ<code>message</code>å¾—å‡ºåˆç†çš„å“åº”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">chatWithMultipleMessages</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1.æ„å»º User å’ŒAI çš„å¤šè½®å¯¹è¯</span>
    <span class="hljs-type">UserMessage</span> <span class="hljs-variable">firstUserMessage</span> <span class="hljs-operator">=</span> UserMessage.from(<span class="hljs-string">"Hello, My name is shepi, could you introduce yourself ?"</span>);
    <span class="hljs-type">AiMessage</span> <span class="hljs-variable">firstAiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(
            ChatRequest.builder()
                    .messages(firstUserMessage)
                    .build())
            .aiMessage();
    <span class="hljs-type">UserMessage</span> <span class="hljs-variable">secondUserMessage</span> <span class="hljs-operator">=</span> UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
    <span class="hljs-type">AiMessage</span> <span class="hljs-variable">secondAiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(
            ChatRequest.builder()
                    .messages(firstUserMessage, firstAiMessage, secondUserMessage)
                    .build()).aiMessage();

    <span class="hljs-comment">// 2.æ§åˆ¶å°æ‰“å°</span>
    System.out.println(secondAiMessage.text());
}
</code></pre>
<h4 data-id="heading-17">3.2.ChatMemory</h4>
<p><code>ChatMemory</code>å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»´æŠ¤ä¸Šä¸‹æ–‡ï¼ŒLangChain4Jæä¾›äº†ä¸¤ç§å¼€ç®±å³ç”¨çš„çª—å£èŠå¤©è®°å¿†</p>
<ul>
<li><code>MessageWindowChatMemory</code></li>
<li><code>TokenWindowChatMemory</code></li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºæ¶ˆæ¯æ•°é‡çš„çª—å£å¯¹è¯è®°å¿†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {

    <span class="hljs-comment">// 1.æ–°å»º messageWindowï¼Œæ»‘åŠ¨çª—å£æœ€å¤§é•¿åº¦è®¾ç½®ä¸º 3</span>
    <span class="hljs-type">MessageWindowChatMemory</span> <span class="hljs-variable">chatWindow</span> <span class="hljs-operator">=</span> MessageWindowChatMemory.builder()
            .maxMessages(<span class="hljs-number">4</span>)
            .build();
    <span class="hljs-comment">// tryChatWithCommonMessages(chatWindow);</span>
    <span class="hljs-comment">// æµ‹è¯•ç‰¹æ®Šçš„ç³»ç»Ÿæ¶ˆæ¯ systemMessage</span>
    tryChatWithSystemMessage(chatWindow);
}

<span class="hljs-comment">/**
 * ç³»ç»Ÿæ¶ˆæ¯æ°¸è¿œä¸ä¼šè¢«é©±é€
 * <span class="hljs-doctag">@param</span> chatWindow
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tryChatWithSystemMessage</span><span class="hljs-params">(MessageWindowChatMemory chatWindow)</span> {
    <span class="hljs-comment">// åˆ›å»ºç³»ç»Ÿæ¶ˆæ¯</span>
    <span class="hljs-type">SystemMessage</span> <span class="hljs-variable">systemMessage</span> <span class="hljs-operator">=</span> SystemMessage.from(<span class="hljs-string">"The user talking with you is shepi"</span>);
    chatWindow.add(systemMessage);
    System.out.println(systemMessage.text());
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
        <span class="hljs-type">UserMessage</span> <span class="hljs-variable">userMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
        } <span class="hljs-keyword">else</span> {
            userMessage = UserMessage.from(<span class="hljs-string">"let's talk about something interesting"</span>);
        }
        System.out.println(userMessage.contents());
        chatWindow.add(userMessage);
        <span class="hljs-comment">// ä½¿ç”¨ chatMemory å¯¹è¯</span>
        <span class="hljs-type">AiMessage</span> <span class="hljs-variable">aiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(ChatRequest.builder().messages(chatWindow.messages()).build()).aiMessage();
        System.out.println(aiMessage.text());
        chatWindow.add(aiMessage);
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tryChatWithCommonMessages</span><span class="hljs-params">(MessageWindowChatMemory chatWindow)</span> {
    <span class="hljs-comment">// 2.æ¨¡æ‹Ÿè¿›è¡Œå¤šè½®å¯¹è¯</span>
    <span class="hljs-comment">// ç¬¬ä¸€è½®ç»™å‡ºè‡ªå·±çš„åå­—ï¼Œç¬¬å››è½®è¯¢é—®AIæˆ‘çš„åå­—ï¼Œå…¶ä»–ä¸¤è½®éšä¾¿èŠç‚¹ä»€ä¹ˆ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
        <span class="hljs-type">UserMessage</span> <span class="hljs-variable">userMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Hello, My name is shepi, could you introduce yourself ?"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
        } <span class="hljs-keyword">else</span> {
            userMessage = UserMessage.from(<span class="hljs-string">"let's talk about something interesting"</span>);
        }
        System.out.println(userMessage.contents());
        chatWindow.add(userMessage);
        <span class="hljs-comment">// ä½¿ç”¨ chatMemory å¯¹è¯</span>
        <span class="hljs-type">AiMessage</span> <span class="hljs-variable">aiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(ChatRequest.builder().messages(chatWindow.messages()).build()).aiMessage();
        System.out.println(aiMessage.text());
        chatWindow.add(aiMessage);
    }
}
</code></pre>
<h4 data-id="heading-18">3.3.Tools</h4>
<p>LangChainä¸­å®šä¹‰<code>Tool</code>éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å·¥å…·æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ <code>@Tool("Tool description")</code>å³å¯ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€ç­”çš„ä¾‹å­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherService</span> {
    <span class="hljs-meta">@Tool("è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”æƒ…å†µ")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getWeather</span><span class="hljs-params">(String city)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¤©æ°”æ•°æ®</span>
        <span class="hljs-keyword">return</span> MessageFormat.
                format(<span class="hljs-string">"Today's weather in {0} is sunny with a temperature of 22 degrees."</span>, city);
    }
}
</code></pre>
<h4 data-id="heading-19">3.4.AiService (Agent å°è£…)</h4>
<p><strong>AiService æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>AiService æ˜¯ LangChain4J æä¾›çš„é«˜å±‚ APIï¼Œç”¨äºå¿«é€Ÿæ„å»º Agent åº”ç”¨ã€‚å®ƒå±è”½äº†å·¥å…·è°ƒç”¨çš„åº•å±‚ç»†èŠ‚ï¼ˆå¦‚æ£€æµ‹ LLM è¿”å›çš„å‡½æ•°è°ƒç”¨è¯·æ±‚ã€æ‰§è¡Œå·¥å…·ã€å°†ç»“æœåé¦ˆç»™ LLMï¼‰ï¼Œè®©å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚</p>
<p><strong>AiService ä¸ Agent çš„å…³ç³»ï¼š</strong></p>
<ul>
<li>AiService æ˜¯ LangChain4J å¯¹ Agent æ¦‚å¿µçš„å…·ä½“å®ç°</li>
<li>å®ƒè‡ªåŠ¨å®Œæˆäº† Agent Loop ä¸­çš„ï¼šæ¥æ”¶è¾“å…¥ â†’ åˆ¤æ–­æ˜¯å¦éœ€è¦ Tool â†’ è°ƒç”¨ Tool â†’ è§‚å¯Ÿç»“æœ â†’ ç”Ÿæˆå“åº”</li>
<li>å¼€å‘è€…åªéœ€å®šä¹‰æ¥å£å’Œ Toolï¼ŒAiService ä¼šè‡ªåŠ¨å®Œæˆå·¥å…·è°ƒç”¨çš„ç¼–æ’</li>
</ul>
<p>å¦‚æœæƒ³è¦ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ Toolï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®šä¹‰ <code>AiService</code> æ—¶ï¼Œä¼ å…¥ Tool å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">OpenAiChatModel</span> <span class="hljs-variable">CHAT_MODEL</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(System.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>))
            .baseUrl(System.getenv(<span class="hljs-string">"OPENAI_BASE_URL"</span>))
            .modelName(System.getenv(<span class="hljs-string">"OPENAI_MODEL"</span>))
            .build();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {

    <span class="hljs-comment">// æ ¹æ®CHAT_MODELåˆ›å»ºä¸€ä¸ª chatService</span>
    <span class="hljs-type">ChatAssistant</span> <span class="hljs-variable">chatService</span> <span class="hljs-operator">=</span> AiServices.builder(ChatAssistant.class)
            .chatLanguageModel(CHAT_MODEL)
            .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherService</span>())
            .chatMemory(MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>))
            .build();

    <span class="hljs-comment">// é—®é¢˜</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">question</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ä»Šå¤©åŒ—äº¬ä»€ä¹ˆå¤©æ°”?"</span>;
    <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatService.chat(question);
    System.out.println(answer);
}
</code></pre>
<h3 data-id="heading-20">4.æµå¼å“åº” (Streaming)</h3>
<p>LangChain4J æ”¯æŒ<strong>æµå¼å“åº”</strong>ï¼Œå³ LLM åœ¨ç”Ÿæˆå†…å®¹æ—¶å®æ—¶è¿”å›æ¯ä¸ª tokenï¼Œè€Œä¸æ˜¯ç­‰å¾…å®Œæ•´å“åº”åå†è¿”å›ã€‚</p>
<h4 data-id="heading-21">ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li>éœ€è¦å®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿‡ç¨‹çš„åœºæ™¯ï¼ˆå¦‚ ChatGPT çš„æ‰“å­—æœºæ•ˆæœï¼‰</li>
<li>ç”Ÿæˆè¾ƒé•¿å†…å®¹æ—¶æå‡ç”¨æˆ·ä½“éªŒ</li>
<li>éœ€è¦æå‰ç»ˆæ­¢ä¸æ»¡æ„çš„è¾“å‡º</li>
</ul>
<h4 data-id="heading-22">å®ç°æ–¹å¼</h4>
<p>ä½¿ç”¨ <code>StreamingAiServices</code> ä»£æ›¿ <code>AiServices</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">StreamingChatAssistant</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">chat</span><span class="hljs-params">(String message, StreamingResponseHandler handler)</span>;
}

<span class="hljs-type">StreamingChatAssistant</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> StreamingAiServices.builder(StreamingChatAssistant.class)
        .chatLanguageModel(model)
        .build();

agent.chat(<span class="hljs-string">"ä»‹ç»ä¸€ä¸‹ LangChain4J"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamingResponseHandler</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onToken</span><span class="hljs-params">(String token)</span> {
        <span class="hljs-comment">// æ¯æ”¶åˆ°ä¸€ä¸ª token å°±è°ƒç”¨</span>
        System.out.print(token);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onComplete</span><span class="hljs-params">(String fullResponse)</span> {
        System.out.println(<span class="hljs-string">"\nå®Œæˆ!"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Throwable error)</span> {
        System.err.println(<span class="hljs-string">"é”™è¯¯: "</span> + error.getMessage());
    }
});
</code></pre>
<h4 data-id="heading-23">æµå¼ vs éæµå¼</h4>






























<table><thead><tr><th>ç‰¹æ€§</th><th>éæµå¼ (AiServices)</th><th>æµå¼ (StreamingAiServices)</th></tr></thead><tbody><tr><td>å“åº”æ–¹å¼</td><td>ç­‰å¾…å®Œæ•´å“åº”åè¿”å›</td><td>å®æ—¶è¿”å›æ¯ä¸ª token</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>æœ‰ç­‰å¾…æ„Ÿ</td><td>å®æ—¶åé¦ˆï¼Œä½“éªŒæ›´å¥½</td></tr><tr><td>å®ç°å¤æ‚åº¦</td><td>ç®€å•</td><td>ç¨å¤æ‚ï¼ˆéœ€è¦å¤„ç†å›è°ƒï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>çŸ­æ–‡æœ¬ã€åå°ä»»åŠ¡</td><td>é•¿æ–‡æœ¬ã€äº¤äº’å¼å¯¹è¯</td></tr></tbody></table>
<p>å®Œæ•´ç¤ºä¾‹ä»£ç è§ï¼š<code>StreamingAgent.java</code></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯]]></title>    <link>https://juejin.cn/post/7603574149776654388</link>    <guid>https://juejin.cn/post/7603574149776654388</guid>    <pubDate>2026-02-07T09:27:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776654388" data-draft-id="7603673564907864099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-02-07T09:27:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:27:45.000Z" title="Sat Feb 07 2026 09:27:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šé…ç½®äº†SSHç§˜é’¥åï¼Œä½¿ç”¨SSHåœ°å€å…‹éš†ä»£ç ï¼Œä¾æ—§æ— æ³•æ‹‰å–ä»£ç ï¼Œæç¤ºä¸‹é¢è¿™ä¸ªä¿¡æ¯ã€‚
<code>Their offerï¼šssh-rsaï¼Œssh-dss fatalï¼šCould not read from remote repository.</code>
<code>Please make sure you have the correct access rights and the repository exists.</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9c42c57e43a4700a3b9854bbef8bc5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=EMDV%2FtPNXOkKp%2Bhz5IsaSGwCvpo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
æç¤ºè¯´æ˜ï¼Œä»“åº“åœ°å€æ”¯æŒçš„æ˜¯ssh-rsaï¼Œssh-dssç±»å‹çš„ç§˜é’¥ï¼›</p>
<h2 data-id="heading-0">æ£€æŸ¥ç§˜é’¥ç±»å‹</h2>
<p>é¦–å…ˆï¼ŒæŸ¥çœ‹ä¸€ä¸‹æœ¬åœ°é…ç½®çš„ç§˜é’¥æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1263eecea87647158f47524644a84ca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=gEt6xc2H5FZ1U6JnlQiV1jry5e0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿™ä¸ªå°±æ˜¯ssh-rsaç±»å‹çš„ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¯ä»¥æ•²ä¸‹é¢çš„å‘½ä»¤ç”Ÿæˆä¸€ä¸ªè¿™æ ·çš„ç§˜é’¥å¯¹ï¼›</p>
<p><code>ssh-keygen -t rsa -b 4096 -C "your_email@163.com</code></p>
<p>æ¢æˆä½ çš„é‚®ç®±ï¼Œåœ¨gitå‘½ä»¤çª—å£é‡Œè¾“å…¥å‘½ä»¤åè¿ç»­æ•²ä¸‰ä¸‹å›è½¦å³å¯ï¼Œç„¶åå°±å¯ä»¥åœ¨.sshç›®å½•ä¸‹æ‰¾åˆ°ç”Ÿæˆçš„ç§˜é’¥å’Œå…¬é’¥ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/765770a2375b4991981702713ba3458f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=h2Nzd14Hy4yzrHCD7DxCHuAIY3A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">é…ç½®ä»“åº“IP</h2>
<p>å¥½äº†ï¼Œä»¥ä¸Šé…ç½®åï¼Œä½¿ç”¨SSHé“¾æ¥å…‹éš†ä»£ç æŠ¥æœ€å¼€å§‹çš„é”™è¯¯ï¼Œ==éœ€è¦æ‰¾åˆ°Gitå®‰è£…ç›®å½•ä¸‹çš„ssh_configé…ç½®ï¼Œåœ¨é…ç½®çš„æœ€æœ«å°¾åŠ ä¸Šè¿™æ®µé…ç½®==ï¼Œå…¶ä¸­==æ¨¡ç³Šçš„éƒ¨åˆ†æ˜¯è¿œç¨‹ä»“åº“çš„IPåœ°å€ï¼Œä¸åŠ ç«¯å£å·ï¼Œä¸è¦æ‰‹æ•²ï¼Œå¤åˆ¶å‰é¢çš„==ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecac3e51461e4515941d1a1c18959d85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=pRJCCLZ%2BEVM%2F6GcJHVdSI9paBok%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ­¤æ—¶ï¼Œå†å»æ‹‰å–è¿œç¨‹ä»“åº“çš„ä»£ç å°±æ²¡é—®é¢˜äº†ã€‚</p>
<h2 data-id="heading-2">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F132912613" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/132912613" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7603588665568116776</link>    <guid>https://juejin.cn/post/7603588665568116776</guid>    <pubDate>2026-02-07T10:12:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603588665568116776" data-draft-id="7603616672927105039" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨"/> <meta itemprop="keywords" content="ThinkPHP,PHP"/> <meta itemprop="datePublished" content="2026-02-07T10:12:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å®"/> <meta itemprop="url" content="https://juejin.cn/user/187362547083252"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/187362547083252/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:12:06.000Z" title="Sat Feb 07 2026 10:12:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#5f6368;background-image:linear-gradient(90deg,rgba(240,191,213,.1) 3%,transparent 0),linear-gradient(1turn,rgba(240,191,213,.1) 3%,transparent 0);background-size:20px 20px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-left:50px;padding-bottom:5px;color:#5f6368}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:0;display:block;content:""}.markdown-body h1{font-size:32px;margin-bottom:5px}.markdown-body h1:before{top:0;content:"ğŸ¦„";font-size:32px}.markdown-body h2{padding-bottom:24px;border-bottom:1px solid #ececec}.markdown-body h2:before{top:0;left:8px;content:"ğŸ³";font-size:24px}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{top:-2px;left:8px;content:"ğŸ„";font-size:20px}.markdown-body h4{font-size:16px}.markdown-body h4:before{top:-2px;left:8px;content:"ğŸ¦¥";font-size:18px}.markdown-body h5{font-size:14px}.markdown-body h5:before{top:-2px;left:9px;content:"ğŸ¦©";font-size:16px}.markdown-body h6{font-size:12px;margin-top:5px}.markdown-body h6:before{top:-1px;left:10px;content:"ğŸ§";font-size:14px}.markdown-body p{line-height:1.9;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid rgba(253,121,168,.5);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#a6accd;background:#292d3e;border-radius:8px}.markdown-body a{text-decoration:none;color:#fd79a8;border-bottom:1px solid #fd79a8;padding:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(253,121,168,.1);color:#ee69a9}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body th{color:#fd79a8}.markdown-body th,.markdown-body tr:hover{background:rgba(253,121,168,.1)}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;color:#666;padding:23px;margin:22px 0;border-left:4px solid #ee69a9;background-color:rgba(253,121,168,.1)}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;display:block;font-size:27px;color:#fd79a8;opacity:.8}.markdown-body blockquote:before{left:10px;top:0;content:"â"}.markdown-body blockquote:after{right:10px;bottom:0;content:"â"}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body strong{position:relative;color:#fd79a8}.markdown-body strong:before{content:"Â· "}.markdown-body strong:after{content:" Â·"}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#fd79a8}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ee69a9}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å®‰è£…</h2>
<pre><code class="hljs language-bash" lang="bash">composer require workerman/workerman
</code></pre>
<hr/>
<h2 data-id="heading-1">åˆ›å»ºå‘½ä»¤</h2>
<pre><code class="hljs language-text" lang="text">php think make:command å‘½ä»¤æ–‡ä»¶å å‘½ä»¤å
</code></pre>
<h2 data-id="heading-2">å®ä¾‹ä¸€ï¼šç§’çº§å®šæ—¶ä»»åŠ¡</h2>
<h3 data-id="heading-3">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-text" lang="text">app/command/TimerTest.php
</code></pre>
<h3 data-id="heading-4">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Timer</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">common</span>\<span class="hljs-title">model</span>\<span class="hljs-title">Order</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimerTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'timer'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-variable">$worker</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>();
        <span class="hljs-variable">$worker</span>-&gt;onWorkerStart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"/>) </span>{
            <span class="hljs-comment">// æ¯ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">1</span>, function() {
                <span class="hljs-variable">$count</span> = <span class="hljs-title class_">Order</span>::<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'status'</span>, <span class="hljs-number">0</span>)
                    -&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'create_time'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-number">1800</span>)
                    -&gt;<span class="hljs-title function_ invoke__">update</span>([<span class="hljs-string">'status'</span> =&gt; -<span class="hljs-number">1</span>]);
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$count</span>) <span class="hljs-keyword">echo</span> <span class="hljs-string">"è‡ªåŠ¨å…³é—­ <span class="hljs-subst">{$count}</span> ä¸ªè¶…æ—¶è®¢å•\n"</span>;
            });

            <span class="hljs-comment">// æ¯5ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">5</span>, function() {
                <span class="hljs-keyword">echo</span> <span class="hljs-string">"5ç§’ä»»åŠ¡æ‰§è¡Œ: "</span> . <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'Y-m-d H:i:s'</span>) . <span class="hljs-string">"\n"</span>;
            });

            <span class="hljs-comment">// æ¯60ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">60</span>, function() {
                <span class="hljs-title function_ invoke__">cache</span>(<span class="hljs-string">'visit_count'</span>, <span class="hljs-number">0</span>);
                <span class="hljs-keyword">echo</span> <span class="hljs-string">"å·²é‡ç½®è®¿é—®è®¡æ•°\n"</span>;
            });
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-5">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'timer'</span> =&gt; <span class="hljs-string">'app\command\TimerTest'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-6">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Linux åå°è¿è¡Œ</span>
php think timer start -d

<span class="hljs-comment"># Windows å¼€å‘</span>
php think timer start
</code></pre>
<hr/>
<h2 data-id="heading-7">å®ä¾‹äºŒï¼šWebSocket å®æ—¶é€šä¿¡</h2>
<h3 data-id="heading-8">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">app/command/WebSocket.php
</code></pre>
<h3 data-id="heading-9">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebSocket</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'websocket'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-variable">$ws</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'websocket://0.0.0.0:8282'</span>);
        <span class="hljs-variable">$ws</span>-&gt;count = <span class="hljs-number">4</span>;

        <span class="hljs-variable">$ws</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-comment">// å¹¿æ’­æ¶ˆæ¯</span>
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-10">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'websocket'</span> =&gt; <span class="hljs-string">'app\command\WebSocket'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-11">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">php think websocket start -d
</code></pre>
<hr/>
<h2 data-id="heading-12">å®ä¾‹ä¸‰ï¼šTP8 æ¥å£ä¸­è§¦å‘ WebSocket æ¨é€ï¼ˆå†…éƒ¨ Text ç«¯å£ï¼‰</h2>
<h3 data-id="heading-13">è®¾è®¡æ€è·¯</h3>
<p>WebSocket æœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼ŒTP8 HTTP æ¥å£æ— æ³•ç›´æ¥è°ƒç”¨ã€‚è§£å†³æ–¹æ¡ˆï¼šåœ¨åŒä¸€è¿›ç¨‹å†…å†ç›‘å¬ä¸€ä¸ªå†…éƒ¨ç«¯å£ï¼ˆ8281ï¼‰ï¼Œæ¥å£é€šè¿‡ TCP çŸ­è¿æ¥å‘é€æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-text" lang="text">TP8 æ¥å£ â†’ TCP 8281 (Textåè®®: æ¶ˆæ¯+æ¢è¡Œç¬¦) â†’ WebSocket 8282 â†’ å®¢æˆ·ç«¯
</code></pre>
<h3 data-id="heading-14">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-text" lang="text">app/command/PushServer.php
</code></pre>
<h3 data-id="heading-15">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PushServer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'push-server'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-comment">// WebSocket æœåŠ¡ï¼ˆå¯¹å¤–ï¼Œ8282ç«¯å£ï¼‰</span>
        <span class="hljs-variable">$ws</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'websocket://0.0.0.0:8282'</span>);
        <span class="hljs-variable">$ws</span>-&gt;count = <span class="hljs-number">4</span>;

        <span class="hljs-variable">$ws</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }
        };

        <span class="hljs-comment">// å†…éƒ¨æ¨é€æœåŠ¡ï¼ˆå¯¹å†…ï¼Œ8281ç«¯å£ï¼ŒTextåè®®ï¼‰</span>
        <span class="hljs-variable">$internal</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'text://0.0.0.0:8281'</span>);

        <span class="hljs-variable">$internal</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-comment">// æ”¶åˆ°å†…éƒ¨æ¨é€æ¶ˆæ¯ï¼Œå¹¿æ’­ç»™æ‰€æœ‰ WebSocket å®¢æˆ·ç«¯</span>
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }

            <span class="hljs-comment">// å›åº”å®¢æˆ·ç«¯</span>
            <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-string">"OK\n"</span>);
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-16">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'push-server'</span> =&gt; <span class="hljs-string">'app\command\PushServer'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-17">TP8 æ¥å£ä¸­æ¨é€</h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">api</span>\<span class="hljs-title class_">controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">Controller</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">common</span>\<span class="hljs-title">model</span>\<span class="hljs-title">Message</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Api</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'content'</span>);

        <span class="hljs-comment">// è¿æ¥åˆ°å†…éƒ¨æ¨é€ç«¯å£</span>
        <span class="hljs-variable">$socket</span> = <span class="hljs-title function_ invoke__">stream_socket_client</span>(<span class="hljs-string">'tcp://127.0.0.1:8281'</span>,<span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errmsg</span>, <span class="hljs-number">3</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$socket</span>) {
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯ï¼ˆæ¢è¡Œç¬¦ç»“å°¾è¡¨ç¤ºä¸€æ¡å®Œæ•´æ¶ˆæ¯ï¼‰</span>
            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$socket</span>, <span class="hljs-variable">$content</span> . <span class="hljs-string">"\n"</span>);

            <span class="hljs-comment">// è¯»å–å›åº”ï¼ˆå¯é€‰ï¼‰</span>
            <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$socket</span>);
            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$socket</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'code'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'å‘é€æˆåŠŸ'</span>]);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'code'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'æ¨é€å¤±è´¥: '</span> . <span class="hljs-variable">$errstr</span>]);
    }
}
</code></pre>
<h3 data-id="heading-18">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">php think push-server start -d
</code></pre>
<hr/>
<h2 data-id="heading-19">å‘½ä»¤é€ŸæŸ¥</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘</span>
php think timer start

<span class="hljs-comment"># ç”Ÿäº§</span>
php think timer start -d

<span class="hljs-comment"># åœæ­¢</span>
php think timer stop

<span class="hljs-comment"># é‡å¯</span>
php think timer restart

<span class="hljs-comment"># å¹³æ»‘é‡å¯ï¼ˆä¸æ–­è¿ï¼‰</span>
php think timer reload
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……]]></title>    <link>https://juejin.cn/post/7603673564907896867</link>    <guid>https://juejin.cn/post/7603673564907896867</guid>    <pubDate>2026-02-07T09:28:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564907896867" data-draft-id="7603574149776670772" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-02-07T09:28:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:28:36.000Z" title="Sat Feb 07 2026 09:28:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šä¹‹å‰å¯¹Gitæœ¬åœ°ä»“åº“çš„åŸºç¡€ä½¿ç”¨æ€»ç»“è¿‡ä¸€ç¯‡ç¬”è®°ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_42108331%2Farticle%2Fdetails%2F131276233" target="_blank" title="https://blog.csdn.net/qq_42108331/article/details/131276233" ref="nofollow noopener noreferrer">Gitæœ¬åœ°ä»“åº“ä½¿ç”¨</a>ï¼Œæœ¬æ–‡å¯¹Gitçš„ä¸€äº›åŸºç¡€å‘½ä»¤è¿›è¡Œè¡¥å……ã€‚</p>
<h2 data-id="heading-0">ä¸€æ­¥æäº¤</h2>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬æœ¬åœ°ä»“åº“ä½¿ç”¨Gitï¼Œæ–‡ä»¶éƒ½éœ€è¦å…ˆ addï¼Œå°†æ–‡ä»¶ä»å·¥ä½œåŒºåŠ å…¥åˆ°æš‚å­˜åŒºï¼Œç„¶åå†commitï¼Œå°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤è‡³ç‰ˆæœ¬åº“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8e6f4dd11a64f909f74408a39e9ec8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=kooMu7qqZhSaJ4Ykr6cOENw08gg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä½†æ˜¯å¯¹äºå·²ç»åŠ å…¥æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œåç»­å¯¹æ–‡ä»¶å†…å®¹çš„ä¿®æ”¹ã€‚å¯ä»¥è¾“å…¥ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼Œå°†ä¸¤æ­¥åˆæˆä¸€æ­¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">git commit -am 'commentä¿¡æ¯'
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df52659e25fa45df84fb55e1fffd3895~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=rtQsf78lfS3T8BdVYAtcRscPwfM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„ï¼Œä»…å¯¹å·²åŠ å…¥åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶æœ‰æ•ˆï¼Œå¦‚æœæ˜¯æ–°å»ºçš„æ–‡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨ï¼›</p>
<h2 data-id="heading-1">æŸ¥çœ‹å·®å¼‚</h2>
<p>å½“æˆ‘ä»¬commitç‰ˆæœ¬åº“æ—¶ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬åº“ä¸­çš„æœ€æ–°çŠ¶æ€ä¸å½“å‰å·¥ä½œåŒºçš„å·®å¼‚ï¼›</p>
<pre><code class="hljs language-java" lang="java">git diff
</code></pre>
<p>æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b82b88c8c69c4f959f93d0c669d2f2cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=iHUWPdpeYbf0IsVRpqxOpio6jmI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¦å¤–ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š<code>HEAD</code>ï¼ŒæŸ¥çœ‹æš‚å­˜åŒºä¸ç‰ˆæœ¬åº“çš„å·®å¼‚ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25ba804e773843adba4d4c7094f5478f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=%2B%2B3RLV%2FX3983YRi7HkK4p95l9Fg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-2">ä¿®æ”¹æäº¤ä¿¡æ¯</h2>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æäº¤æ—¶ï¼Œå†™çš„commentä¿¡æ¯ä¸å¤ªå‡†ç¡®ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤æ¥ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤çš„commentä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-java" lang="java">git commit --amend -m <span class="hljs-string">'ä¿®æ”¹åçš„commentä¿¡æ¯'</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb2b46350c3f4147869aa22c76251ce4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=1g1pbPNvNH0TFV3j1arlS4aP8n0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-3">æŸ¥çœ‹æ—¥å¿—</h2>
<p>å½“åˆ†æ”¯è¾ƒå¤šæ—¶ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹åˆ†æ”¯çš„æƒ…å†µï¼Œåœ¨å·¦ä¾§ä¼šæœ‰çº¿æ¡æ˜¾ç¤ºåˆ†æ”¯çš„ç»“æ„ï¼›</p>
<pre><code class="hljs language-powershell" lang="powershell">git log --graph
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1208751b6947461cadf1698879897ba2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=f5EPxA5%2BiTagHWKokSf6mhV2JUU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
å¦å¤–ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š<code>--pretty=short</code>ï¼Œè¡¨ç¤ºæŸ¥çœ‹ç®€è¦çš„æ—¥å¿—ä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-powershell" lang="powershell">git log --pretty=short
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f6c7f29968a4369974c7c94149c2826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=MGedXt1jOWHV1n5nkwVdZUsxNu0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿˜å¯ä»¥åœ¨åé¢åŠ <code>-p æ–‡ä»¶å</code>æ¥æŸ¥çœ‹å…³äºæ­¤æ–‡ä»¶çš„æ—¥å¿—ä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-java" lang="java">git log --pretty=<span class="hljs-type">short</span> -p æ–‡ä»¶å
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d7a0e10a1a9411eaf1dd688486c2d96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=NfrchveIwNfQ5f06izxHs22lTEs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-4">ä¿®æ”¹å†å²æäº¤</h2>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†æ–‡ä»¶ï¼Œæäº¤åˆ°äº†ç‰ˆæœ¬åº“ã€‚ä½†æ˜¯å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªå°çš„æ‹¼å†™é—®é¢˜ï¼Œæˆ‘ä»¬ä¿®æ”¹å®Œæˆåï¼Œå†æ¬¡æäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œæ­¤æ—¶å¸Œæœ›ç‰ˆæœ¬åº“é‡Œé¢åªç•™ä¸‹æˆ‘æœ€æ–°çš„è¿™æ¬¡æäº¤ï¼Œå‰ä¸€æ¬¡æäº¤ä»ç‰ˆæœ¬åº“ä¸­å‰”é™¤æ‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27f8933ef9ba47dba05c075aac76b6b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=WbW5t5jQdDDcTxvquYhI9SUP%2Bbc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æœ‰æ‹¼å†™é—®é¢˜çš„æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬åº“ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc72910ceb084d1fa3e09b4e70bf564d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=tLf%2Fcw5J8j2%2BwHpq9ui4hZIZIe0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¹‹åï¼Œä¿®æ”¹å®Œæ–‡ä»¶é‡Œé¢çš„æ‹¼å†™é—®é¢˜åï¼Œå†æ¬¡commitï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8fdd4963eb14c2ea98fcef0c5c5ce2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=F3pMFmb53DsF735MkFx7ED2DVKk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6930eb1d34de48f88afbd244c3b56fee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=TT%2FLj3MUfkMKfIfwADVMTEcuG%2FA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œè¡¨ç¤ºå‹ç¼©æœ€è¿‘2æ¬¡commitè®°å½•ï¼›</p>
<pre><code class="hljs language-java" lang="java">git rebase -i HEAD~<span class="hljs-number">2</span>
</code></pre>
<p>ç„¶åä¼šå‡ºç°ä¸‹é¢çš„çª—å£ï¼Œå°†åé¢çš„ï¼Œä¿®æ”¹æœ‰æ‹¼å†™é”™è¯¯çš„è¿™æ¬¡æäº¤ï¼Œpickæ”¹ä¸ºfixupï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44a6ef3799a94e6cb04d9e0dd9cd9282~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=5EyuueITCO%2BLrNhBIOtq14aD8eQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¿å­˜é€€å‡ºï¼ˆå’ŒVimç¼–è¾‘å™¨ä½¿ç”¨ç›¸åŒï¼‰ï¼Œå†æ¬¡æŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°è¿™å›å°±åªæœ‰ä¸€æ¬¡æäº¤å†…å®¹äº†ã€‚é€šè¿‡æŸ¥çœ‹ç‰ˆæœ¬å·å¯ä»¥å‘ç°è¿™æ¬¡æäº¤ä¸ä¹‹å‰ä¸¤æ¬¡éƒ½ä¸åŒï¼Œæ˜¯åˆå¹¶ä¹‹åçš„ç»“æœã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df4526fb99b84a20b52f3b99929d1d0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=%2B7LCUifxKCBLrE6YAgm11WH%2F5zo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿™å°±è¾¾åˆ°äº†ï¼Œæˆ‘ä»¬å‰é¢æƒ³è¦çš„ç»“æœï¼›</p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>æœ¬æ–‡å‚è€ƒã€ŠGitHubå…¥é—¨ä¸å®è·µã€‹ï¼ˆ[æ—¥]å¤§å¡šå¼˜è®°ï¼‰ç¬¬4ç«  é€šè¿‡å®é™…æ“ä½œå­¦ä¹ Git</p>
<h2 data-id="heading-6">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F135181552" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/135181552" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•]]></title>    <link>https://juejin.cn/post/7603574149776834612</link>    <guid>https://juejin.cn/post/7603574149776834612</guid>    <pubDate>2026-02-07T10:15:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776834612" data-draft-id="7603643385815793716" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T10:15:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024å°ç¥"/> <meta itemprop="url" content="https://juejin.cn/user/70007368988926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/70007368988926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024å°ç¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:15:27.000Z" title="Sat Feb 07 2026 10:15:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯1024å°ç¥ï¼Œæƒ³è¿› æŠ€æœ¯ç¾¤ / ç§æ´»ç¾¤ / è‚¡ç¥¨ç¾¤ æˆ– äº¤æœ‹å‹éƒ½å¯ä»¥ç§ä¿¡æˆ‘ï¼Œå¦‚æœä½ è§‰å¾—æœ¬æ–‡æœ‰ç”¨ï¼Œä¸€é”®ä¸‰è¿ (ç‚¹èµã€è¯„è®ºã€å…³æ³¨)ï¼Œå°±æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒ~</p><p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95994c912c27489cb3d1b8a6965faf01~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1750" loading="lazy"/></p><p/>
<p>å‘å¸ƒGitHub pagesä¼šæœ‰ä¸åŒçš„å‡ ç§çŠ¶æ€ï¼Œå¯ä»¥å‚è€ƒ</p>
<p>409:è¡¨ç¤ºå·²ç»å‘å¸ƒè¿‡äº†</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"message"</span>: <span class="hljs-string">"GitHub Pages is already enabled."</span>,
    <span class="hljs-string">"documentation_url"</span>: <span class="hljs-string">"https://docs.github.com/rest/pages/pages#create-a-apiname-pages-site"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"409"</span>
}</code></pre>
<p>erroredï¼šè¡¨ç¤ºå‘å¸ƒå¤±è´¥</p>
<p>é€šå¸¸æ˜¯å‘å¸ƒè¿‡åçš„pagesé™æ€æ–‡ä»¶æ›´æ–°åï¼Œä¼šè‡ªåŠ¨é‡æ–°å‘å¸ƒï¼Œæ¯”å¦‚æ€»çš„æ›´æ–°æ–‡ä»¶æ˜¯3ä¸ªï¼Œä½†æ˜¯æ›´æ–°äº†1ä¸ªä¹‹åå°±ä¼šå‡ºè§¦å‘è‡ªåŠ¨æ›´æ–°ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªç´§è·Ÿç€å°±æ›´æ–°äº†ï¼Œå°±ä¼šå†æ¬¡è§¦å‘æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªæ›´æ–°çŠ¶æ€å°±ä¼šå˜æˆerrored</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/xxxxxx/xxxxxxx/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"errored"</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://xxxxxxx.github.io/xxxxxxx7/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p>statusï¼šnull è¯´æ˜æ­£åœ¨å‘å¸ƒpages</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/1024xiaoshen/PakePlus-Android-v2.1.6/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://1024xiaoshen.github.io/PakePlus-Android-v2.1.6/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p>builtï¼šè¡¨ç¤ºå·²ç»å‘å¸ƒå¥½äº†</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/1024xiaoshen/PakePlus-Android-v2.1.6/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"built"</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://1024xiaoshen.github.io/PakePlus-Android-v2.1.6/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p/>
å¦‚æœä½ æœ‰å¥½çš„æƒ³æ³•æˆ–éœ€æ±‚ï¼Œéƒ½å¯ä»¥ç§ä¿¡æˆ‘ï¼Œæˆ‘è¿™é‡Œæœ‰å¾ˆå¤šç¨‹åºå‘˜æœ‹å‹å–œæ¬¢ç”¨ä»£ç æ¥åˆ›é€ ä¸°å¯Œå¤šå½©çš„è®¡ç®—æœºä¸–ç•Œ</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor]]></title>    <link>https://juejin.cn/post/7603616672927170575</link>    <guid>https://juejin.cn/post/7603616672927170575</guid>    <pubDate>2026-02-07T10:24:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672927170575" data-draft-id="7603673564908027939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T10:24:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´ä»°æ™–"/> <meta itemprop="url" content="https://juejin.cn/user/277554177507927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/277554177507927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´ä»°æ™–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:24:06.000Z" title="Sat Feb 07 2026 10:24:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>githubæ¨å‡ºäº† copilot chatï¼Œé‡Œé¢æ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯å®ƒå¯ä»¥å¾ˆå¿«é€Ÿåœ°æœç´¢å’Œè·å–å„å¼€æºé¡¹ç›®çš„ä¸Šä¸‹æ–‡ã€‚é™¤äº†å•çº¯çš„Askï¼Œå…¶å®è¿˜æœ‰æ‰§è¡Œä»»åŠ¡çš„Agentï¼ˆä¸è¿‡è¦å¼€copilot proï¼‰ï¼Œä¼¼ä¹ç›®å‰æ˜¯é™åˆ¶äº†æ¯ä¸ªæœˆ50æ¬¡requestã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1c86a01bbfe424aa6088ea888156331~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05Luw5pmW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771064645&amp;x-signature=W1NGZHWEmOJb0o7v8HQldlj1cI4%3D" alt="image.png" loading="lazy"/></p>
<p>å› æ­¤æˆ‘åˆ©ç”¨è¿™ä¸ªæ¥å­¦ä¹ æºç ï¼Œè®©AIå›ç­”å…³äºæºç çš„ä¸œè¥¿ã€‚ä¸‹é¢çš„å†…å®¹æ˜¯å‡ºè‡ªcopilotçš„å›ç­”ï¼ˆæˆ‘è®¤ä¸ºæ¯”è¾ƒå¥½çš„ï¼‰ï¼Œåªæ˜¯ä¸ªäººè¿›è¡Œäº†æ•´ç†ã€‚
è¿™ä¸ªåšå®¢çš„è¥å…»ä»·å€¼å¹¶ä¸é«˜ï¼Œæœ€å¤§çš„ä»·å€¼å¯èƒ½å°±æ˜¯å‘Šè¯‰ä½ æœ‰è¿™ä¸ªæ–¹ä¾¿çš„é€”å¾„å»äº†è§£å’Œå­¦ä¹ æºç ã€‚<strong>å¯ä»¥ç›´æ¥è·³åˆ°å®Œæ•´ç¤ºä¾‹</strong>ï¼Œå‰é¢å¤§æŠµåªæ˜¯ä¸€äº›é“ºå«ã€‚</p>
<h2 data-id="heading-0">Chromium é¡µé¢æ¸²æŸ“çš„æ ¸å¿ƒæ¶æ„</h2>
<h3 data-id="heading-1">1. <strong>Blink æ¸²æŸ“å¼•æ“</strong> (æ ¸å¿ƒç»„ä»¶)</h3>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼ŒBlink æ˜¯ Chromium çš„æ¸²æŸ“å¼•æ“ï¼Œè´Ÿè´£é¡µé¢å†…å®¹çš„æœ€ç»ˆå±•ç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## Blink (Rendering Engine)</span>

Blink å®ç°äº†æ‰€æœ‰åœ¨æµè§ˆå™¨æ ‡ç­¾é¡µå†…æ¸²æŸ“å†…å®¹çš„åŠŸèƒ½ï¼š

<span class="hljs-bullet">*</span> å®ç°ç½‘ç»œå¹³å°è§„èŒƒï¼ˆå¦‚HTMLæ ‡å‡†ï¼‰ï¼ŒåŒ…æ‹¬DOMã€CSSå’ŒWeb IDL
<span class="hljs-bullet">*</span> åµŒå…¥V8å¼•æ“å¹¶è¿è¡ŒJavaScript
<span class="hljs-bullet">*</span> ä»åº•å±‚ç½‘ç»œæ ˆè¯·æ±‚èµ„æº
<span class="hljs-bullet">*</span> <span class="hljs-strong">**æ„å»ºDOMæ ‘**</span>
<span class="hljs-bullet">*</span> <span class="hljs-strong">**è®¡ç®—æ ·å¼å’Œå¸ƒå±€**</span>
<span class="hljs-bullet">*</span> <span class="hljs-strong">**åµŒå…¥Chrome Compositorå¹¶ç»˜åˆ¶å›¾å½¢**</span>
</code></pre>
<h3 data-id="heading-2">2. <strong>å¤šè¿›ç¨‹æ¸²æŸ“ç®¡é“</strong></h3>
<p>Chromium é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼š</p>
<ul>
<li><strong>Browser Process (æµè§ˆå™¨è¿›ç¨‹)</strong>ï¼šç®¡ç†ç”¨æˆ·äº¤äº’ã€ç½‘ç»œè¯·æ±‚ã€æ‰“å°ç­‰</li>
<li><strong>Renderer Process (æ¸²æŸ“è¿›ç¨‹)</strong>ï¼šåœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œæ‰§è¡Œ Blink å¼•æ“è¿›è¡Œé¡µé¢æ¸²æŸ“</li>
<li><strong>Compositor Process</strong>ï¼šè´Ÿè´£æœ€ç»ˆçš„å›¾å½¢åˆæˆå’Œæ˜¾ç¤º</li>
</ul>
<h3 data-id="heading-3">3. <strong>æ¸²æŸ“æµç¨‹çš„å…³é”®æ­¥éª¤</strong></h3>
<h4 data-id="heading-4">a. <strong>é¡µé¢åŠ è½½ä¸DOMæ„å»º</strong></h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// PrintRenderFrameHelper å¤„ç†æ¸²æŸ“ç›¸å…³çš„å·¥ä½œ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintRenderFrameHelper</span>
    : <span class="hljs-keyword">public</span> blink::WebPrintClient,
      <span class="hljs-keyword">public</span> content::RenderFrameObserver {
  <span class="hljs-comment">// ä¸ºæ‰“å°å‡†å¤‡é¡µé¢æ¡†æ¶</span>
  <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnFramePreparedForPrintPages</span><span class="hljs-params">()</span></span>;
  <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrintPages</span><span class="hljs-params">()</span></span>;
  <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">RenderPagesForPrint</span><span class="hljs-params">(blink::WebLocalFrame* frame,
                           <span class="hljs-type">const</span> blink::WebNode&amp; node)</span></span>;
};
</code></pre>
<h4 data-id="heading-5">b. <strong>è®¡ç®—å¸ƒå±€ä¸æ ·å¼</strong></h4>
<p>Blink å¼•æ“åœ¨ DOM æ ‘æ„å»ºåï¼Œè®¡ç®—æ¯ä¸ªå…ƒç´ çš„æ ·å¼ï¼ˆCSSï¼‰å¹¶ç¡®å®šå…¶åœ¨é¡µé¢ä¸­çš„ä½ç½®å’Œå¤§å°ã€‚</p>
<h4 data-id="heading-6">c. <strong>ç»˜åˆ¶ï¼ˆPaintï¼‰ä¸æ …æ ¼åŒ–ï¼ˆRasterizationï¼‰</strong></h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// é¡µé¢å†…å®¹æ¸²æŸ“åˆ°ç”»å¸ƒ</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RenderPageContent</span><span class="hljs-params">(blink::WebLocalFrame* frame,
                       <span class="hljs-type">uint32_t</span> page_index,
                       cc::PaintCanvas* canvas)</span> </span>{
  <span class="hljs-built_in">TRACE_EVENT1</span>(<span class="hljs-string">"print"</span>, <span class="hljs-string">"RenderPageContent"</span>, <span class="hljs-string">"page_index"</span>, page_index);
  frame-&gt;<span class="hljs-built_in">PrintPage</span>(page_index, canvas);
}
</code></pre>
<h4 data-id="heading-7">d. <strong>å›¾å½¢åˆæˆï¼ˆCompositingï¼‰</strong></h4>
<p>Chrome Compositor è´Ÿè´£åˆæˆä¸åŒçš„å›¾å±‚ï¼Œæœ€ç»ˆç”Ÿæˆå¸§ï¼ˆFrameï¼‰ã€‚</p>
<h3 data-id="heading-8">4. <strong>Compositor çš„ä½œç”¨</strong></h3>
<p>Compositor æ˜¯ Chromium çš„å›¾å½¢åˆæˆå™¨ï¼Œç”¨äºï¼š</p>
<ul>
<li>åˆæˆå¤šä¸ªæ¸²æŸ“å±‚</li>
<li>å¤„ç†å¤æ‚çš„å˜æ¢å’Œæ•ˆæœ</li>
<li>ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½</li>
<li>ç®¡ç†ç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“ï¼ˆGPUï¼‰</li>
</ul>
<h3 data-id="heading-9">5. <strong>æ¸²æŸ“å‘¨æœŸï¼ˆFrame Lifecycleï¼‰</strong></h3>
<p>ä¸€ä¸ªå®Œæ•´çš„æ¸²æŸ“å‘¨æœŸåŒ…æ‹¬ï¼š</p>
<pre><code class="hljs">è¾“å…¥äº‹ä»¶ â†’ DOM æ›´æ–° â†’ æ ·å¼è®¡ç®— â†’ å¸ƒå±€è®¡ç®— â†’ ç»˜åˆ¶æ“ä½œ â†’ æ …æ ¼åŒ– â†’ åˆæˆ â†’ æ˜¾ç¤º
</code></pre>
<h3 data-id="heading-10">6. <strong>ä¼˜åŒ–ç­–ç•¥</strong></h3>
<ul>
<li><strong>å¢é‡æ¸²æŸ“</strong>ï¼šåªé‡æ–°æ¸²æŸ“å—å½±å“çš„åŒºåŸŸï¼ˆDirty Regionsï¼‰</li>
<li><strong>åˆ†å±‚æ¸²æŸ“</strong>ï¼šä½¿ç”¨å¤šä¸ªæ¸²æŸ“å±‚æé«˜æ•ˆç‡</li>
<li><strong>GPU åŠ é€Ÿ</strong>ï¼šåˆ©ç”¨ç¡¬ä»¶åŠ é€ŸåŠ å¿«æ¸²æŸ“é€Ÿåº¦</li>
<li><strong>å¼‚æ­¥æ¸²æŸ“</strong>ï¼šå¤šä¸ªè¿›ç¨‹å¹¶è¡Œå¤„ç†ä¸åŒçš„æ¸²æŸ“ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-11">7. <strong>æ€§èƒ½ç›‘æ§</strong></h3>
<p>Chromium å†…ç½®æ€§èƒ½ç›‘æ§ï¼š</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// PDF æ¸²æŸ“çš„æ€§èƒ½æµ‹é‡</span>
<span class="hljs-keyword">if</span> (!first_paint_metric_reported_ &amp;&amp; !client_-&gt;<span class="hljs-built_in">IsPrintPreview</span>()) {
  first_paint_metric_reported_ = <span class="hljs-literal">true</span>;
  base::<span class="hljs-built_in">UmaHistogramMediumTimes</span>(<span class="hljs-string">"PDF.FirstPaintTime"</span>,
                                begin_time - engine_creation_time_);
}
</code></pre>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>Chromium çš„é¡µé¢æ¸²æŸ“æ˜¯ä¸€ä¸ªå¤æ‚çš„åˆ†é˜¶æ®µè¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>è§£æé˜¶æ®µ</strong>ï¼šè§£æ HTML/CSS/JavaScriptï¼Œæ„å»º DOM å’Œæ ·å¼æ ‘</li>
<li><strong>è®¡ç®—é˜¶æ®µ</strong>ï¼šè®¡ç®—å¸ƒå±€ï¼ˆLayoutï¼‰å’Œæ ·å¼ï¼ˆStyleï¼‰</li>
<li><strong>ç»˜åˆ¶é˜¶æ®µ</strong>ï¼šç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ï¼ˆPaint Commandsï¼‰</li>
<li><strong>æ …æ ¼åŒ–é˜¶æ®µ</strong>ï¼šå°†ç»˜åˆ¶æŒ‡ä»¤è½¬æ¢ä¸ºåƒç´ æ•°æ®</li>
<li><strong>åˆæˆé˜¶æ®µ</strong>ï¼šåˆæˆå¤šä¸ªå±‚å¹¶é€åˆ°æ˜¾ç¤ºè®¾å¤‡</li>
<li><strong>æ˜¾ç¤ºé˜¶æ®µ</strong>ï¼šåœ¨å±å¹•ä¸Šå±•ç¤ºæœ€ç»ˆç”»é¢</li>
</ol>
<h2 data-id="heading-13">Compositor çš„å®Œæ•´åˆ†å±‚æ¶æ„å’Œæ•°æ®æµ</h2>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ <code>life_of_a_frame.md</code> å’Œä»£ç åˆ†æï¼ŒCompositor åˆ†ä¸ºä»¥ä¸‹ä¸»è¦éƒ¨åˆ†ï¼š</p>
<h3 data-id="heading-14"><strong>1. BeginFrame åè°ƒå±‚ï¼ˆFrame Coordinationï¼‰</strong></h3>
<pre><code class="hljs language-css" lang="css">è¾“å…¥ï¼šæ¥è‡ª <span class="hljs-attribute">Display</span> Compositor çš„ BeginFrame ä¿¡å·
â†“
è¾“å‡ºï¼šBeginFrameArgsï¼ˆåŒ…å«æ—¶é—´æˆ³ã€å¸§å·ç­‰ï¼‰
</code></pre>
<p><strong>èŒè´£ï¼š</strong></p>
<ul>
<li>åŒæ­¥ä¸»çº¿ç¨‹å’Œåˆæˆçº¿ç¨‹çš„å¸§ç”Ÿæˆ</li>
<li>ç®¡ç†å¸§ç‡å’Œå‚ç›´åŒæ­¥</li>
<li>åˆ†å‘ BeginFrame é€šçŸ¥</li>
</ul>
<hr/>
<h3 data-id="heading-15"><strong>2. ä¸»çº¿ç¨‹é˜¶æ®µï¼ˆMain Thread Pipelineï¼‰</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp">BeginFrame
    â†“
[<span class="hljs-meta">1</span>] BeginMainFrame - åˆæˆçº¿ç¨‹è¯·æ±‚ä¸»çº¿ç¨‹æ›´æ–°
    â†“
    è¾“å…¥ï¼šLayerTreeHost é…ç½®ã€ç”¨æˆ·è¾“å…¥ã€åŠ¨ç”»çŠ¶æ€
    è¾“å‡ºï¼šBeginMainFrameAndCommitState
    â†“
[<span class="hljs-meta">2</span>] Animate - ä¸»çº¿ç¨‹æ›´æ–°åŠ¨ç”»
    â†“
    è¾“å…¥ï¼šå½“å‰æ—¶é—´ã€åŠ¨ç”»çŠ¶æ€
    è¾“å‡ºï¼šæ›´æ–°åçš„å±æ€§å€¼
    â†“
[<span class="hljs-meta">3</span>] UpdateLayers - Blink æ‰§è¡Œå¸ƒå±€å’Œç»˜åˆ¶
    â†“
    è¾“å…¥ï¼šDOM æ ‘ã€æ ·å¼æ ‘
    è¾“å‡ºï¼šDisplayItemListï¼ˆç»˜åˆ¶æ“ä½œï¼‰
    â†“
[<span class="hljs-meta">4</span>] Commit - æ¨é€æ”¹å˜åˆ°åˆæˆçº¿ç¨‹
    â†“
    è¾“å…¥ï¼šLayer æ ‘ã€DisplayItemListã€å±æ€§
    è¾“å‡ºï¼šCommitStateï¼ˆåŸå­æ€§æäº¤çŠ¶æ€ï¼‰
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤ï¼š</strong></p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-number">1.</span> Animate Phase
   è¾“å…¥ï¼š<span class="hljs-built_in">LayerAnimationController</span> (cc/animation<span class="hljs-comment">/*)
   è¾“å‡ºï¼šå˜æ¢ã€ä¸é€æ˜åº¦ç­‰å±æ€§çš„æ–°å€¼

2. UpdateLayers Phase  
   è¾“å…¥ï¼šLayer æ ‘ï¼Œç”± Blink é€šè¿‡ LayerTreeHostClient æ¥å£è§¦å‘
   - client_-&gt;UpdateLayerTreeHost()
   - Blink æ‰§è¡Œå¸ƒå±€è®¡ç®—
   - Blink æ‰§è¡Œç»˜åˆ¶ï¼Œäº§ç”Ÿ DisplayItemList
   è¾“å‡ºï¼šæ›´æ–°åçš„ Layer æ ‘å’Œ DisplayItemList

3. Commit Phase
   - PushPropertiesTo()ï¼šæ¯ä¸ª Layer æ¨é€å±æ€§åˆ° LayerImpl
   - äº¤æ¢ Pending Treeï¼ˆå¾…å®šæ ‘ï¼‰å’Œ Active Treeï¼ˆæ´»åŠ¨æ ‘ï¼‰
   - åŒæ­¥åŠ¨ç”»çŠ¶æ€ã€æ»šåŠ¨çŠ¶æ€ç­‰
</span></code></pre>
<hr/>
<h3 data-id="heading-16"><strong>3. åˆæˆçº¿ç¨‹é˜¶æ®µï¼ˆImpl Thread Pipelineï¼‰</strong></h3>
<p>è¿™æ˜¯ Compositor çš„æ ¸å¿ƒï¼Œåˆ†ä¸ºäº”ä¸ªå…³é”®é˜¶æ®µï¼š</p>
<h4 data-id="heading-17"><strong>é˜¶æ®µ 1ï¼šCommit å®Œæˆï¼ˆFinish Commitï¼‰</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">è¾“å…¥ï¼šCommitState
<span class="hljs-bullet">    -</span> Layer æ ‘ç»“æ„å’Œå±æ€§
<span class="hljs-bullet">    -</span> DisplayItemList
<span class="hljs-bullet">    -</span> Scroll çŠ¶æ€
<span class="hljs-bullet">    -</span> åŠ¨ç”»æ•°æ®
<span class="hljs-code">    
å¤„ç†ï¼š
    - FinishCommit()ï¼šåˆæˆçº¿ç¨‹æ¥æ”¶æäº¤çš„çŠ¶æ€
    - æ›´æ–° LayerImpl æ ‘
    - æ›´æ–°å±æ€§æ ‘ï¼ˆTransform Treeã€Clip Tree ç­‰ï¼‰
    
è¾“å‡ºï¼šLayerTreeImplï¼ˆåˆæˆçº¿ç¨‹çš„æ´»åŠ¨æ ‘ï¼‰
</span></code></pre>
<h4 data-id="heading-18"><strong>é˜¶æ®µ 2ï¼šPrepare Tilesï¼ˆå‡†å¤‡ç“¦ç‰‡ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šLayerTreeImplã€æ˜¾ç¤ºè§†å£ã€ç¼©æ”¾å› å­

å¤„ç†ï¼š
    - <span class="hljs-built_in">CalculateRasterScales</span>()ï¼šè®¡ç®—æ¯ä¸ªå±‚çš„æ …æ ¼åŒ–ç¼©æ”¾
    - <span class="hljs-built_in">PrepareTiles</span>()ï¼š
        â”œâ”€ <span class="hljs-built_in">CalculateLiveRects</span>()ï¼šè®¡ç®—å¯è§ç“¦ç‰‡èŒƒå›´
        â”œâ”€ <span class="hljs-built_in">AssignGpuMemoryToTiles</span>()ï¼šåˆ†é… GPU å†…å­˜é¢„ç®—
        â””â”€ <span class="hljs-built_in">ScheduleRasterTasks</span>()ï¼šå®‰æ’æ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—
    
    - TileManager çš„èŒè´£ï¼š
        â”œâ”€ ä¼˜å…ˆçº§æ’åºï¼ˆè§†å£å†… &gt; è§†å£å¤–ï¼‰
        â”œâ”€ ç®¡ç†è½¯ä»¶å’Œ GPU æ …æ ¼åŒ–
        â”œâ”€ ç®¡ç†å›¾åƒè§£ç 
        â””â”€ ç®¡ç†è›‹ç³•å±‚ï¼ˆcake layersï¼‰

è¾“å‡ºï¼šRaster Tasksï¼ˆæ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼‰
    - æ¯ä¸ªä»»åŠ¡æ˜¯ï¼š(Tile, RasterSource, Priority)
</code></pre>
<h4 data-id="heading-19"><strong>é˜¶æ®µ 3ï¼šRasterizationï¼ˆæ …æ ¼åŒ–ï¼‰</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">è¾“å…¥ï¼šRaster Tasks
<span class="hljs-bullet">    -</span> RasterSourceï¼ˆDisplayItemList çš„åŒ…è£…ï¼‰
<span class="hljs-bullet">    -</span> ç›®æ ‡ï¿½ï¿½ç‰‡å¤§å°
<span class="hljs-bullet">    -</span> ç¼©æ”¾å› å­
<span class="hljs-bullet">    -</span> æ …æ ¼åŒ–ä½ç½®

å¤„ç†è¿‡ç¨‹ï¼ˆåœ¨å·¥ä½œçº¿ç¨‹æ‰§è¡Œï¼‰ï¼š

<span class="hljs-bullet">    1.</span> PaintOpBuffer Playback
<span class="hljs-code">       è¾“å…¥ï¼šDisplayItemList ä¸­çš„ PaintOps
       å¤„ç†ï¼š
           - GetOffsetsOfOpsToRaster()ï¼šä½¿ç”¨ R-Tree æŸ¥è¯¢éœ€è¦çš„æ“ä½œ
           - åˆ›å»º SkCanvasï¼ˆCPU æˆ– GPUï¼‰
           - éå†ç›¸å…³ PaintOpsï¼Œè°ƒç”¨ Raster()
       è¾“å‡ºï¼šåƒç´ æ•°æ®æˆ– GPU å‘½ä»¤
    
    2. Software Rasterï¼ˆè½¯ä»¶æ …æ ¼åŒ–ï¼‰
       è¾“å…¥ï¼šPaintOpsï¼Œè¾“å‡ºå¤§å°
       å¤„ç†ï¼š
           - åœ¨å†…å­˜ä¸­åˆ›å»ºä½å›¾
           - ä½¿ç”¨ Skia çš„ CPU åç«¯ç»˜åˆ¶
           - ä½¿ç”¨ SIMD ä¼˜åŒ–
       è¾“å‡ºï¼šSkBitmapï¼ˆCPU å†…å­˜ä¸­çš„åƒç´ ï¼‰
    
    3. GPU Rasterï¼ˆGPU æ …æ ¼åŒ–ï¼‰
       è¾“å…¥ï¼šPaintOpsï¼ŒGPU ä¸Šä¸‹æ–‡
       å¤„ç†ï¼š
           - åºåˆ—åŒ– PaintOps
           - é€šè¿‡ RasterInterface å‘é€åˆ° GPU
           - GPU å‘½ä»¤ç¼“å†²åŒºæ‰§è¡Œç»˜åˆ¶
           - Skia çš„ GPU åç«¯ï¼ˆGaneshï¼‰å¤„ç†
       è¾“å‡ºï¼šGPU çº¹ç†èµ„æº
</span>
è¾“å‡ºï¼šRasterized Tiles
<span class="hljs-bullet">    -</span> åŒ…å«åƒç´ æ•°æ®ï¼ˆè½¯ä»¶ï¼‰æˆ– GPU çº¹ç†ï¼ˆGPUï¼‰
</code></pre>
<p><strong>å…³é”®ç±»å’Œå‡½æ•°ï¼š</strong></p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// RasterSourceï¼šDisplayItemList çš„åŒ…è£…ï¼Œæä¾›æ …æ ¼åŒ–æ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RasterSource</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PlaybackToCanvas</span><span class="hljs-params">(
        SkCanvas* raster_canvas,
        <span class="hljs-type">const</span> gfx::Rect&amp; canvas_bitmap_rect,  <span class="hljs-comment">// ç›®æ ‡ä½ç½®</span>
        <span class="hljs-type">const</span> gfx::AxisTransform2d&amp; raster_transform,  <span class="hljs-comment">// ç¼©æ”¾</span>
        <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span></span>;
};

<span class="hljs-comment">// TileManagerï¼šåè°ƒæ …æ ¼åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TileManager</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrepareTiles</span><span class="hljs-params">(<span class="hljs-type">const</span> PrepareTilesParams&amp; params)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ScheduleRasterTasks</span><span class="hljs-params">()</span></span>;
};

<span class="hljs-comment">// DisplayItemListï¼šåŒ…å« PaintOps</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DisplayItemList</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Raster</span><span class="hljs-params">(SkCanvas* canvas, <span class="hljs-type">const</span> PlaybackParams&amp; params)</span></span>;
    <span class="hljs-function">std::vector&lt;<span class="hljs-type">size_t</span>&gt; <span class="hljs-title">OffsetsOfOpsToRaster</span><span class="hljs-params">(SkCanvas* canvas)</span></span>;
};
</code></pre>
<h4 data-id="heading-20"><strong>é˜¶æ®µ 4ï¼šActivationï¼ˆæ¿€æ´»ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šPending Treeï¼ˆå¾…å®šæ ‘ï¼Œå·²æ …æ ¼åŒ–ï¼‰

å¤„ç†ï¼š
    - <span class="hljs-built_in">WaitForAllTilesToRasterize</span>()ï¼šç­‰å¾…æ‰€æœ‰å…³é”®ç“¦ç‰‡æ …æ ¼åŒ–å®Œæˆ
    - <span class="hljs-built_in">ActivatePendingTree</span>()ï¼š
        â”œâ”€ Pending Tree â†’ Active Tree
        â”œâ”€ æ›´æ–°åŠ¨ç”»çŠ¶æ€
        â”œâ”€ æ›´æ–°é¡µé¢ç¼©æ”¾
        â””â”€ æ¸…ç©ºå·²å®Œæˆçš„æ …æ ¼åŒ–é˜Ÿåˆ—
    
è¾“å‡ºï¼šActive Treeï¼ˆå·²æ¿€æ´»çš„æ ‘ï¼Œå¯ç”¨äºç»˜åˆ¶ï¼‰
</code></pre>
<h4 data-id="heading-21"><strong>é˜¶æ®µ 5ï¼šDraw Frameï¼ˆç»˜åˆ¶å¸§ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šActive Treeã€BeginFrameArgs

å¤„ç†ï¼š
    <span class="hljs-number">1</span>. <span class="hljs-built_in">CalculateDrawProperties</span>()
       è¾“å…¥ï¼šActive Treeã€è§†å£ã€è®¾å¤‡ç¼©æ”¾å› å­
       è®¡ç®—ï¼š
           - æ¯ä¸ªå±‚çš„æœ€ç»ˆå˜æ¢çŸ©é˜µ
           - å‰ªè£åŒºåŸŸ
           - å¯è§èŒƒå›´
       è¾“ï¿½ï¿½ï¿½ï¼šDrawPropertiesï¼ˆæ¯ä¸ª LayerImpl éƒ½æœ‰ï¼‰
    
    <span class="hljs-number">2</span>. <span class="hljs-built_in">GenerateCompositorFrame</span>()
       è¾“å…¥ï¼šActive Tree with DrawProperties
       å¤„ç†ï¼š
           - éå† Layer æ ‘ï¼Œç”Ÿæˆ Quadsï¼ˆå››è¾¹å½¢ï¼‰
           - æ¯ä¸ª Quad åŒ…å«ï¼š
               â”œâ”€ çº¹ç†/èµ„æº ID
               â”œâ”€ å˜æ¢çŸ©é˜µ
               â”œâ”€ å‰ªè£åŒºåŸŸ
               â”œâ”€ ä¸é€æ˜åº¦
               â””â”€ æ··åˆæ¨¡å¼
           - ä¸ºæ¯ä¸ª Quad åˆ›å»º RenderPass
           - è®¾ç½®ç»„åˆå¸§å…ƒæ•°æ®
       è¾“å‡ºï¼šCompositorFrame
    
    <span class="hljs-number">3</span>. CompositorFrame ç»“æ„
       viz::CompositorFrame {
           vector&lt;RenderPass&gt;ï¼š
               - RenderPass<span class="hljs-selector-attr">[0]</span>ï¼šç¬¬ä¸€ä¸ªç¦»å±æ¸²æŸ“ç›®æ ‡
               - RenderPass<span class="hljs-selector-attr">[1]</span>ï¼šç¬¬äºŒä¸ªç¦»å±æ¸²æŸ“ç›®æ ‡
               - ...
               - RenderPass<span class="hljs-selector-attr">[N]</span>ï¼šæœ€åä¸€ä¸ªè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨çš„æ¸²æŸ“é€šé“
           
           vector&lt;TransferableResource&gt;ï¼šå¼•ç”¨çš„ GPU çº¹ç†
           CompositorFrameMetadataï¼šå…ƒæ•°æ®
               - frame_tokenï¼šå¸§æ ‡è¯†ç¬¦
               - device_scale_factorï¼šè®¾å¤‡åƒç´ æ¯”
               - latency_infoï¼šæ€§èƒ½æŒ‡æ ‡
               - presentation_tokenï¼šå±•ç¤ºä»¤ç‰Œ
       }

è¾“å‡ºï¼šCompositorFrameï¼ˆåŒ…å«æ‰€æœ‰ç»˜åˆ¶æŒ‡ä»¤ï¼‰
</code></pre>
<hr/>
<h3 data-id="heading-22"><strong>4. Frame Sink &amp; Vizï¼ˆæ˜¾ç¤ºåˆæˆå™¨ï¼‰</strong></h3>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šCompositorFrame

å¤„ç†ï¼š
    <span class="hljs-number">1</span>. <span class="hljs-built_in">SubmitCompositorFrame</span>()
       - éªŒè¯èµ„æºæœ‰æ•ˆæ€§
       - åŒæ­¥ä»¤ç‰Œå¤„ç†
       - å¸§ä»¤ç‰Œç”Ÿæˆ
    
    <span class="hljs-number">2</span>. Viz å¤„ç†ï¼ˆviz/service/<span class="hljs-attribute">display</span>/ï¼‰
       - <span class="hljs-built_in">AggregateSurfaces</span>()ï¼šåˆæˆå¤šä¸ª Surface
       - <span class="hljs-built_in">ApplyFilters</span>()ï¼šåº”ç”¨æ»¤é•œæ•ˆæœ
       - <span class="hljs-built_in">Rasterize</span>()ï¼šæœ€åæ …æ ¼åŒ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
       - <span class="hljs-built_in">GenerateDamageRect</span>()ï¼šè®¡ç®—è„åŒºåŸŸ
    
    <span class="hljs-number">3</span>. <span class="hljs-attribute">Display</span> åˆæˆ
       - å°†å¤šä¸ªæ¥æºçš„å¸§åˆæˆåˆ°æœ€ç»ˆè¾“å‡ºè¡¨é¢
       - åº”ç”¨å˜æ¢å’Œæ•ˆæœ

è¾“å‡ºï¼šæœ€ç»ˆçš„å±å¹•æ˜¾ç¤ºå†…å®¹
</code></pre>
<hr/>
<h3 data-id="heading-23"><strong>æ•´ä½“æ•°æ®æµå›¾</strong></h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    <span class="hljs-selector-tag">MAIN</span> THREAD (ä¸»çº¿ç¨‹)                          â”‚
â”‚                                                                   â”‚
â”‚  Layer Tree    BeginMainFrame                                   â”‚
â”‚      â”‚         Animate                                          â”‚
â”‚      â”‚         UpdateLayers (Blink Layout &amp; Paint)              â”‚
â”‚      â”‚         â†’ DisplayItemList (PaintOps)                     â”‚
â”‚      â”‚                                                           â”‚
â”‚      â””â”€â”€â†’ Commit (PushPropertiesTo)                            â”‚
â”‚           CommitState â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                            â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ProxyImpl Bridge  â”‚
                    â”‚  (Main â†” Impl)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               COMPOSITOR THREAD (åˆæˆçº¿ç¨‹)                       â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">FinishCommit</span>()                                              â”‚
â”‚     CommitState â†’ LayerTreeImpl                                  â”‚
â”‚     æ›´æ–° LayerImpl æ ‘ã€å±æ€§æ ‘                                      â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">2</span>. <span class="hljs-built_in">PrepareTiles</span>()  â—„â”€ Scheduler è°ƒåº¦                           â”‚
â”‚     â”œâ”€ è®¡ç®—æ …æ ¼åŒ–ç¼©æ”¾                                             â”‚
â”‚     â”œâ”€ åˆ†é… GPU å†…å­˜                                             â”‚
â”‚     â””â”€ ç”Ÿæˆ RasterTasks é˜Ÿåˆ—                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼ (Post to Worker Threads)                          â”‚
â”‚
â”‚  <span class="hljs-number">3</span>. Rasterization (Worker Threads)                             â”‚
â”‚     â”œâ”€ Software: DisplayItemList â†’ SkBitmap                    â”‚
â”‚     â””â”€ GPU: PaintOps â†’ GPU Textures                            â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚
â”‚  <span class="hljs-number">4</span>. <span class="hljs-built_in">Activation</span>()  â—„â”€ Scheduler è°ƒåº¦                            â”‚
â”‚     Pending Tree (Rasterized) â†’ Active Tree                    â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">5</span>. <span class="hljs-built_in">DrawFrame</span>() / <span class="hljs-built_in">GenerateCompositorFrame</span>()                     â”‚
â”‚     â”œâ”€ <span class="hljs-built_in">CalculateDrawProperties</span>()                               â”‚
â”‚     â”œâ”€ <span class="hljs-built_in">BuildQuads</span>()                                            â”‚
â”‚     â”œâ”€ ç”Ÿæˆ RenderPass åˆ—è¡¨                                     â”‚
â”‚     â””â”€ è¾“å‡º CompositorFrame                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚
â”‚  <span class="hljs-built_in">SubmitCompositorFrame</span>(frame)                                  â”‚
â”‚            â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  LayerTreeFrameSink â”‚
    â”‚  (GPU Channel)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               VIZ DISPLAY COMPOSITOR (æ˜¾ç¤ºåˆæˆå™¨)              â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">MaybeSubmitCompositorFrame</span>()                               â”‚
â”‚     - éªŒè¯å¸§                                                    â”‚
â”‚     - åº”ç”¨åŒæ­¥ä»¤ç‰Œ                                               â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">2</span>. <span class="hljs-built_in">AggregateSurfaces</span>()                                        â”‚
â”‚     - å¤šä¸ª Surface åˆæˆ                                         â”‚
â”‚     - Z-order æ’åº                                             â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">3</span>. Display::<span class="hljs-built_in">Draw</span>()                                            â”‚
â”‚     - GPU é©±åŠ¨ç¨‹åºæŒ‡ä»¤                                          â”‚
â”‚     - åº”ç”¨æ»¤é•œå’Œæ•ˆæœ                                             â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">4</span>. Swap &amp; Present                                            â”‚
â”‚     - ç¼“å†²äº¤æ¢ (Backbuffer â†’ Frontbuffer)                      â”‚
â”‚     - VSync åŒæ­¥                                               â”‚
â”‚     - æ˜¾ç¤ºå™¨æ˜¾ç¤º                                                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-24"><strong>å…³é”®æ¦‚å¿µæ€»ç»“è¡¨</strong></h3>











































































<table><thead><tr><th>é˜¶æ®µ</th><th>è¾“å…¥</th><th>å¤„ç†å™¨</th><th>è¾“å‡º</th><th>æ‰§è¡Œçº¿ç¨‹</th></tr></thead><tbody><tr><td><strong>Animate</strong></td><td>AnimationState</td><td>LayerAnimationController</td><td>å±æ€§å€¼</td><td>Main</td></tr><tr><td><strong>UpdateLayers</strong></td><td>DOM æ ‘ã€æ ·å¼</td><td>Blink</td><td>DisplayItemList</td><td>Main</td></tr><tr><td><strong>Commit</strong></td><td>Layer æ ‘</td><td>LayerTreeHost</td><td>CommitState</td><td>Mainâ†’Impl</td></tr><tr><td><strong>FinishCommit</strong></td><td>CommitState</td><td>LayerTreeHostImpl</td><td>LayerTreeImpl</td><td>Impl</td></tr><tr><td><strong>PrepareTiles</strong></td><td>LayerTreeImpl</td><td>TileManager</td><td>RasterTasks</td><td>Impl</td></tr><tr><td><strong>Rasterization</strong></td><td>RasterTasks</td><td>RasterWorkerPool</td><td>GPU çº¹ç†/ä½å›¾</td><td>Worker</td></tr><tr><td><strong>Activation</strong></td><td>Pending Tree</td><td>LayerTreeHostImpl</td><td>Active Tree</td><td>Impl</td></tr><tr><td><strong>DrawFrame</strong></td><td>Active Tree</td><td>LayerTreeHostImpl</td><td>CompositorFrame</td><td>Impl</td></tr><tr><td><strong>Display</strong></td><td>CompositorFrame</td><td>DisplayCompositor</td><td>å±å¹•è¾“å‡º</td><td>Display</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-25"><strong>ProxyMain/ProxyImpl çš„è§’è‰²</strong></h3>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-built_in">ProxyMain</span> (ä¸»çº¿ç¨‹)
â”œâ”€ è´Ÿè´£ä¸ä¸»çº¿ç¨‹é€šä¿¡
â”œâ”€ æ¥æ”¶ BeginMainFrame ä¿¡å·
â”œâ”€ ç®¡ç† CommitPipelineStage
â””â”€ å›è°ƒä¸»çº¿ç¨‹ç»“æœ

<span class="hljs-built_in">ProxyImpl</span> (åˆæˆçº¿ç¨‹)
â”œâ”€ è´Ÿè´£ä¸åˆæˆçº¿ç¨‹é€šä¿¡
â”œâ”€ æ§åˆ¶ Scheduler
â”œâ”€ ç®¡ç† LayerTreeHostImpl
â””â”€ æäº¤ CompositorFrame åˆ° LayerTreeFrameSink
</code></pre>
<h2 data-id="heading-26">Compositor å®Œæ•´ç¤ºä¾‹ï¼šç»˜åˆ¶ä¸€ä¸ªè“è‰²æ­£æ–¹å½¢</h2>
<p>è®©æˆ‘ä»¬å‡è®¾è¦åœ¨ç½‘é¡µä¸Šç»˜åˆ¶ä¸€ä¸ª<strong>è“è‰²çš„ 200Ã—200 åƒç´ æ­£æ–¹å½¢ï¼Œä½ç½®åœ¨ (100, 100)</strong>ã€‚</p>
<h3 data-id="heading-27"><strong>ç¬¬1æ­¥ï¼šä¸»çº¿ç¨‹ - Blink è®°å½•ç»˜åˆ¶æ“ä½œ</strong></h3>
<p>ç”¨æˆ·åœ¨ HTML/CSS ä¸­å†™äº†ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"
  width: 200px;
  height: 200px;
  background-color: blue;
  position: absolute;
  top: 100px;
  left: 100px;
"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Blink å¸ƒå±€å®Œæˆåï¼ŒçŸ¥é“è¦ç»˜åˆ¶ï¼š</p>
<ul>
<li>ä½ç½®ï¼š(100, 100)</li>
<li>å¤§å°ï¼š200Ã—200</li>
<li>é¢œè‰²ï¼šè“è‰² RGB(0, 0, 255)</li>
</ul>
<p>ç„¶åå®ƒåˆ›å»ºä¸€ä¸ª <strong>DisplayItemList</strong> æ¥è®°å½•è¿™ä¸ªç»˜åˆ¶æ“ä½œï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Blink åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œ</span>
<span class="hljs-keyword">auto</span> display_list = base::<span class="hljs-built_in">MakeRefCounted</span>&lt;cc::DisplayItemList&gt;();

display_list-&gt;<span class="hljs-built_in">StartPaint</span>();

<span class="hljs-comment">// 1. ä¿å­˜å›¾å½¢çŠ¶æ€</span>
display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::SaveOp&gt;();

<span class="hljs-comment">// 2. ç»˜åˆ¶è“è‰²æ­£æ–¹å½¢</span>
cc::PaintFlags blue_flags;
blue_flags.<span class="hljs-built_in">setColor</span>(SK_ColorBLUE);  <span class="hljs-comment">// RGB(0, 0, 255)</span>
blue_flags.<span class="hljs-built_in">setStyle</span>(SkPaint::kFill_Style);

display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::DrawRectOp&gt;(
    SkRect::<span class="hljs-built_in">MakeXYWH</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>),  <span class="hljs-comment">// x, y, width, height</span>
    blue_flags
);

<span class="hljs-comment">// 3. æ¢å¤å›¾å½¢çŠ¶æ€</span>
display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::RestoreOp&gt;();

display_list-&gt;<span class="hljs-built_in">EndPaintOfUnpaired</span>(gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>));

<span class="hljs-comment">// å®Œæˆè®°å½•</span>
display_list-&gt;<span class="hljs-built_in">Finalize</span>();

<span class="hljs-comment">// æ­¤æ—¶ DisplayItemList å†…éƒ¨åŒ…å«ï¼š</span>
<span class="hljs-comment">// </span>
<span class="hljs-comment">// paint_op_buffer_ = [</span>
<span class="hljs-comment">//   SaveOp,</span>
<span class="hljs-comment">//   DrawRectOp(x=100, y=100, w=200, h=200, color=blue),</span>
<span class="hljs-comment">//   RestoreOp</span>
<span class="hljs-comment">// ]</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// visual_rects_ = [</span>
<span class="hljs-comment">//   {100, 100, 200, 200},  // SaveOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">//   {100, 100, 200, 200},  // DrawRectOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">//   {100, 100, 200, 200}   // RestoreOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">// ]</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> ä¸€ä¸ªåŒ…å«"ç»˜åˆ¶æŒ‡ä»¤"çš„å¯¹è±¡ï¼Œè¯´æ˜è¦åœ¨ (100,100) ä½ç½®ç»˜åˆ¶ä¸€ä¸ª 200Ã—200 çš„è“è‰²çŸ©å½¢ã€‚<strong>ä½†è¿™åªæ˜¯æŒ‡ä»¤ï¼Œè¿˜æ²¡æœ‰çœŸæ­£çš„åƒç´ æ•°æ®ï¼</strong></p>
<hr/>
<h3 data-id="heading-28"><strong>ç¬¬2æ­¥ï¼šæäº¤åˆ°åˆæˆçº¿ç¨‹</strong></h3>
<p>ä¸»çº¿ç¨‹æŠŠ DisplayItemList åŒ…è£…åœ¨ <strong>CommitState</strong> ä¸­ï¼Œå‘é€ç»™åˆæˆçº¿ç¨‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä¸»çº¿ç¨‹åˆ›å»º CommitState</span>
<span class="hljs-keyword">auto</span> commit_state = std::<span class="hljs-built_in">make_unique</span>&lt;CommitState&gt;();

<span class="hljs-comment">// æŠŠ DisplayItemList åˆ†é…ç»™å¯¹åº”çš„ Layer</span>
<span class="hljs-comment">// (åœ¨å®é™…ä»£ç ä¸­ï¼ŒDisplayItemList è¢«å­˜å‚¨åœ¨ PictureLayerImpl ä¸­)</span>
commit_state-&gt;source_frame_number = <span class="hljs-number">120</span>;
commit_state-&gt;device_viewport_rect = gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>);
commit_state-&gt;device_scale_factor = <span class="hljs-number">1.0f</span>;  <span class="hljs-comment">// å‡è®¾æ™®é€šå±å¹•</span>
commit_state-&gt;background_color = SK_ColorWHITE;

<span class="hljs-comment">// æ¨é€åˆ°åˆæˆçº¿ç¨‹</span>
layer_tree_host_-&gt;<span class="hljs-built_in">WillCommit</span>(...)
<span class="hljs-comment">// ...</span>
layer_tree_host_-&gt;<span class="hljs-built_in">ActivateCommitState</span>()  <span class="hljs-comment">// åŸå­æ€§æ¨é€</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> CommitState å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ DisplayItemListã€‚</p>
<hr/>
<h3 data-id="heading-29"><strong>ç¬¬3æ­¥ï¼šåˆæˆçº¿ç¨‹ - å‡†å¤‡æ …æ ¼åŒ–</strong></h3>
<p>åˆæˆçº¿ç¨‹æ”¶åˆ° CommitStateï¼Œå¼€å§‹å‡†å¤‡æ …æ ¼åŒ–ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åˆæˆçº¿ç¨‹ä¸Š</span>
LayerTreeHostImpl* host_impl = ...;

<span class="hljs-comment">// 1. æ¥æ”¶ CommitStateï¼Œæ›´æ–° LayerTreeImpl</span>
host_impl-&gt;<span class="hljs-built_in">FinishCommit</span>(commit_state);

<span class="hljs-comment">// 2. å‡†å¤‡ç“¦ç‰‡ï¼ˆTilesï¼‰</span>
TileManager* tile_manager = host_impl-&gt;<span class="hljs-built_in">tile_manager</span>();
tile_manager-&gt;<span class="hljs-built_in">PrepareTiles</span>();

<span class="hljs-comment">// è¿™ä¼šä¸º PictureLayerImpl åˆ›å»º Tiles</span>
<span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬çš„æ­£æ–¹å½¢åªæœ‰ 200Ã—200ï¼Œå¯èƒ½åªéœ€è¦ 1 ä¸ª Tile</span>
<span class="hljs-comment">// å‡è®¾ Tile å¤§å°æ˜¯ 256Ã—256</span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Tile</span> {
    gfx::Rect rect;           <span class="hljs-comment">// ç“¦ç‰‡åœ¨é¡µé¢ä¸Šçš„ä½ç½®</span>
    RasterSource* source;     <span class="hljs-comment">// æŒ‡å‘ DisplayItemList (åŒ…è£…å)</span>
    <span class="hljs-type">float</span> scale;              <span class="hljs-comment">// æ …æ ¼åŒ–ç¼©æ”¾å› å­</span>
    <span class="hljs-type">int</span> x, y;                 <span class="hljs-comment">// ç“¦ç‰‡çš„ç½‘æ ¼åæ ‡</span>
};

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç“¦ç‰‡</span>
Tile tile0{
    .rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),      <span class="hljs-comment">// é¡µé¢åæ ‡</span>
    .source = raster_source,                 <span class="hljs-comment">// åŒ…å«æˆ‘ä»¬çš„ DisplayItemList</span>
    .scale = <span class="hljs-number">1.0f</span>,
    .x = <span class="hljs-number">0</span>,
    .y = <span class="hljs-number">0</span>
};

<span class="hljs-comment">// TileManager ä¼šåˆ›å»ºæ …æ ¼åŒ–ä»»åŠ¡</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">RasterTask</span> {
    Tile* tile;
    RasterSource* raster_source;
    gfx::Rect target_rect;  <span class="hljs-comment">// åœ¨ç“¦ç‰‡ä¸­çš„ä½ç½®</span>
    Priority priority;
};

RasterTask task{
    .tile = &amp;tile0,
    .raster_source = raster_source,
    .target_rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),
    .priority = PRIORITY_NOW  <span class="hljs-comment">// è§†å£å†…ï¼Œéœ€è¦ç«‹å³æ …æ ¼åŒ–</span>
};

<span class="hljs-comment">// æäº¤æ …æ ¼åŒ–ä»»åŠ¡ç»™å·¥ä½œçº¿ç¨‹</span>
tile_manager-&gt;<span class="hljs-built_in">ScheduleRasterTasks</span>(&amp;task);
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> æ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå‘Šè¯‰å·¥ä½œçº¿ç¨‹è¦æ …æ ¼åŒ–å“ªäº›åŒºåŸŸã€‚</p>
<hr/>
<h3 data-id="heading-30"><strong>ç¬¬4æ­¥ï¼šå·¥ä½œçº¿ç¨‹ - æ …æ ¼åŒ–ï¼ˆæœ€å…³é”®çš„éƒ¨åˆ†ï¼ï¼‰</strong></h3>
<p>è¿™æ˜¯æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆ<strong>å®é™…åƒç´ </strong>çš„åœ°æ–¹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å·¥ä½œçº¿ç¨‹ä¸Šæ‰§è¡Œæ …æ ¼åŒ–ä»»åŠ¡</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RasterWorkerPool::RasterizeTask</span><span class="hljs-params">(<span class="hljs-type">const</span> RasterTask&amp; task)</span> </span>{
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç»˜åˆ¶ç›®æ ‡ï¼ˆç”»å¸ƒï¼‰</span>
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª 256Ã—256 çš„ç¼“å†²åŒºï¼Œç”¨æ¥å­˜æ”¾æ …æ ¼åŒ–åçš„åƒç´ </span>
    
    <span class="hljs-comment">// æ–¹æ¡ˆ Aï¼šCPU æ …æ ¼åŒ–ï¼ˆè½¯ä»¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (use_software_raster) {
        <span class="hljs-comment">// åˆ›å»º CPU å†…å­˜ä¸­çš„ä½å›¾</span>
        SkBitmap bitmap;
        bitmap.<span class="hljs-built_in">allocN32Pixels</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>);  <span class="hljs-comment">// 256Ã—256 çš„ 32 ä½ RGBA åƒç´ </span>
        
        <span class="hljs-comment">// åˆ›å»º Skia ï¿½ï¿½å¸ƒï¼ŒæŒ‡å‘è¿™ä¸ªä½å›¾</span>
        <span class="hljs-function">SkCanvas <span class="hljs-title">canvas</span><span class="hljs-params">(bitmap)</span></span>;
        
        <span class="hljs-comment">// ç°åœ¨æˆ‘ä»¬è¦å›æ”¾ DisplayItemList ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤</span>
        RasterSource* source = task.raster_source;
        
        <span class="hljs-comment">// å…³é”®æ­¥éª¤ï¼šå›æ”¾ç»˜åˆ¶æ“ä½œï¼</span>
        source-&gt;<span class="hljs-built_in">PlaybackToCanvas</span>(
            &amp;canvas,                    <span class="hljs-comment">// ç›®æ ‡ç”»å¸ƒ</span>
            gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>),      <span class="hljs-comment">// å†…å®¹å¤§å°</span>
            gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),  <span class="hljs-comment">// ç“¦ç‰‡åœ¨å†…å®¹ä¸­çš„ä½ç½®</span>
            gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),  <span class="hljs-comment">// éœ€è¦æ …æ ¼åŒ–çš„åŒºåŸŸ</span>
            gfx::<span class="hljs-built_in">AxisTransform2d</span>(<span class="hljs-number">1.0f</span>), <span class="hljs-comment">// æ— ç¼©æ”¾</span>
            settings
        );
        
        <span class="hljs-comment">// ç°åœ¨ bitmap ä¸­åŒ…å«äº†æ …æ ¼åŒ–åçš„åƒç´ ï¼</span>
        <span class="hljs-comment">// å…·ä½“æ¥è¯´ï¼š</span>
        <span class="hljs-comment">// - ä½ç½® (100, 100) åˆ° (300, 300) çš„åƒç´ è¢«è®¾ä¸ºè“è‰²</span>
        <span class="hljs-comment">// - å…¶ä»–åƒç´ æ˜¯ç™½è‰²ï¼ˆèƒŒæ™¯è‰²ï¼‰</span>
        
        <span class="hljs-comment">// bitmap çš„å†…å­˜å¸ƒå±€ç¤ºæ„ï¼š</span>
        <span class="hljs-comment">// </span>
        <span class="hljs-comment">// ä½ç½® (0,0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (256,0)</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//  (100,100) å¼€å§‹</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...  â† è“è‰²åƒç´ ï¼</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//  (300,300) ç»“æŸ</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â†“</span>
        <span class="hljs-comment">// (256,256)</span>
        
        <span class="hljs-comment">// ä¸Šä¼ åˆ° GPU</span>
        <span class="hljs-built_in">UploadBitmapToGPU</span>(&amp;bitmap, tile);
    }
    
    <span class="hljs-comment">// æ–¹æ¡ˆ Bï¼šGPU æ …æ ¼åŒ–</span>
    <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// åˆ›å»º GPU çº¹ç†ä½œä¸ºæ¸²æŸ“ç›®æ ‡</span>
        <span class="hljs-comment">// å°ºå¯¸ï¼š256Ã—256ï¼Œæ ¼å¼ï¼šRGBA_8888</span>
        GLuint texture = gl::<span class="hljs-built_in">CreateTexture</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, GL_RGBA8);
        
        <span class="hljs-comment">// ç»‘å®šä¸ºæ¸²æŸ“ç›®æ ‡</span>
        <span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, fbo);
        <span class="hljs-built_in">glFramebufferTexture2D</span>(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, 
                               GL_TEXTURE_2D, texture, <span class="hljs-number">0</span>);
        
        <span class="hljs-comment">// æ¸…é™¤èƒŒæ™¯ï¼ˆç™½è‰²ï¼‰</span>
        <span class="hljs-built_in">glClearColor</span>(<span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>);
        <span class="hljs-built_in">glClear</span>(GL_COLOR_BUFFER_BIT);
        
        <span class="hljs-comment">// åˆ›å»º Skia ç”»å¸ƒï¼ˆç»˜åˆ¶åˆ° GPUï¼‰</span>
        SkSurface* surface = SkSurface::<span class="hljs-built_in">MakeFromBackendTexture</span>(...);
        SkCanvas* canvas = surface-&gt;<span class="hljs-built_in">getCanvas</span>();
        
        <span class="hljs-comment">// å›æ”¾ DisplayItemList çš„ç»˜åˆ¶æ“ä½œ</span>
        <span class="hljs-comment">// è¿™æ¬¡æ˜¯å‘é€ GPU å‘½ä»¤</span>
        DisplayItemList::<span class="hljs-built_in">Raster</span>(canvas, ...);
        
        <span class="hljs-comment">// GPU æ‰§è¡ŒæŒ‡ä»¤ï¼Œåœ¨çº¹ç†ä¸­ç”»å‡ºè“è‰²æ­£æ–¹å½¢</span>
        <span class="hljs-comment">// çº¹ç†å†…å®¹ç°åœ¨æ˜¯ï¼šä½ç½® (100, 100) åˆ° (300, 300) æ˜¯è“è‰²åƒç´ </span>
    }
}
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µå‘ç”Ÿäº†ä»€ä¹ˆï¼š</strong></p>
<ol>
<li><strong>åˆ›å»ºä¸€ä¸ª 256Ã—256 çš„ç¼“å†²åŒº</strong>ï¼ˆå¯ä»¥æ˜¯ CPU å†…å­˜æˆ– GPU çº¹ç†ï¼‰</li>
<li><strong>æ¸…é™¤èƒŒæ™¯</strong>ä¸ºç™½è‰²</li>
<li><strong>å›æ”¾ DisplayItemList</strong> ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤ï¼š
<ul>
<li>SaveOpï¼šä¿å­˜çŠ¶æ€</li>
<li>DrawRectOp(x=100, y=100, w=200, h=200, color=blue)ï¼š<strong>åœ¨åƒç´  (100,100) åˆ° (300,300) ä¹‹é—´å¡«å……è“è‰²</strong></li>
<li>RestoreOpï¼šæ¢å¤çŠ¶æ€</li>
</ul>
</li>
</ol>
<p><strong>å…·ä½“çš„åƒç´ æ•°æ®ç¤ºæ„ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">CPU å†…å­˜ï¼ˆSkBitmapï¼‰æˆ– GPU çº¹ç†çš„å†…å®¹
ï¼ˆæ¯ä¸ªæ–¹å—ä»£è¡¨ä¸€ä¸ªåƒç´ ï¼Œç”¨ 16 è¿›åˆ¶è¡¨ç¤º RGBA é¢œè‰²å€¼ï¼‰

<span class="hljs-attr">y</span>=<span class="hljs-number">0</span>    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (å…¨æ˜¯ç™½è‰²)
<span class="hljs-attr">y</span>=<span class="hljs-number">1</span>    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">99</span>   FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">100</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
       ^                      ^ (100,100) è“è‰²å¼€å§‹      ^ (300,100) è“è‰²ç»“æŸ
<span class="hljs-attr">y</span>=<span class="hljs-number">101</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">102</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">299</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">300</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
       ^                      ^ (100,300) è“è‰²æœ€åä¸€è¡Œ  ^ (300,300) è“è‰²ç»“æŸ
<span class="hljs-attr">y</span>=<span class="hljs-number">301</span>  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">255</span>  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...

å…¶ä¸­ï¼š
- <span class="hljs-attr">FFFFFFFF</span> = ç™½è‰² (RGBA: <span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)
- <span class="hljs-attr">0000FFFF</span> = è“è‰² (RGBA: <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> GPU çº¹ç†æˆ–ä½å›¾ï¼ŒåŒ…å« 256Ã—256 ä¸ªåƒç´ çš„å®é™…é¢œè‰²æ•°æ®ã€‚</p>
<hr/>
<h3 data-id="heading-31"><strong>ç¬¬5æ­¥ï¼šåˆæˆçº¿ç¨‹ - ç”Ÿæˆ CompositorFrame</strong></h3>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æ …æ ¼åŒ–åçš„çº¹ç†ï¼Œåˆæˆçº¿ç¨‹åˆ›å»ºæœ€ç»ˆçš„åˆæˆå¸§ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åˆæˆçº¿ç¨‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">LayerTreeHostImpl::GenerateCompositorFrame</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// åˆ›å»º CompositorFrame</span>
    viz::CompositorFrame frame;
    
    <span class="hljs-comment">// è®¾ç½®å…ƒæ•°æ®</span>
    frame.metadata.frame_token = <span class="hljs-number">0x12345</span>;
    frame.metadata.device_scale_factor = <span class="hljs-number">1.0f</span>;
    frame.metadata.size_in_pixels = gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>);
    frame.metadata.begin_frame_ack = viz::<span class="hljs-built_in">BeginFrameAck</span>(...);
    
    <span class="hljs-comment">// åˆ›å»ºæ¸²æŸ“é€šé“</span>
    <span class="hljs-keyword">auto</span> render_pass = viz::CompositorRenderPass::<span class="hljs-built_in">Create</span>();
    render_pass-&gt;<span class="hljs-built_in">SetNew</span>(
        viz::<span class="hljs-built_in">CompositorRenderPassId</span>(<span class="hljs-number">1</span>),
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>),      <span class="hljs-comment">// è¾“å‡ºçŸ©å½¢ï¼ˆæ•´ä¸ªå±å¹•ï¼‰</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>),    <span class="hljs-comment">// è„åŒºåŸŸï¼ˆåªæœ‰æ­£æ–¹å½¢åŒºåŸŸéœ€è¦é‡ç»˜ï¼‰</span>
        gfx::<span class="hljs-built_in">Transform</span>()                   <span class="hljs-comment">// æ— å˜æ¢</span>
    );
    
    <span class="hljs-comment">// æ·»åŠ  Quadï¼ˆçº¹ç†å››è¾¹å½¢ï¼‰</span>
    <span class="hljs-keyword">auto</span> quad = std::<span class="hljs-built_in">make_unique</span>&lt;viz::TextureDrawQuad&gt;();
    
    <span class="hljs-comment">// ä»æ …æ ¼åŒ–ä»»åŠ¡ä¸­è·å–çº¹ç† ID</span>
    ResourceId texture_id = <span class="hljs-number">0x9999</span>;  <span class="hljs-comment">// GPU çº¹ç†çš„å¥æŸ„</span>
    
    quad-&gt;<span class="hljs-built_in">SetNew</span>(
        <span class="hljs-literal">nullptr</span>,  <span class="hljs-comment">// shared_quad_state (å…±äº«çŠ¶æ€)</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),         <span class="hljs-comment">// Quad åœ¨å±å¹•ä¸Šçš„ä½ç½®ï¼ˆæ³¨æ„ï¼šè¿™æ˜¯ä»¥ç“¦ç‰‡çš„ (0,0) å¼€å§‹ï¼‰</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),         <span class="hljs-comment">// å¯è§åŒºåŸŸ</span>
        <span class="hljs-literal">false</span>,                              <span class="hljs-comment">// ä¸éœ€è¦æ··åˆ</span>
        texture_id,                         <span class="hljs-comment">// çº¹ç† IDï¼ˆæŒ‡å‘æˆ‘ä»¬æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢çº¹ç†ï¼‰</span>
        <span class="hljs-literal">true</span>,                               <span class="hljs-comment">// é¢„ä¹˜ alpha</span>
        gfx::<span class="hljs-built_in">PointF</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),                 <span class="hljs-comment">// UV å·¦ä¸Šè§’</span>
        gfx::<span class="hljs-built_in">PointF</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>),                 <span class="hljs-comment">// UV å³ä¸‹è§’</span>
        SK_ColorWHITE,                      <span class="hljs-comment">// èƒŒæ™¯è‰²</span>
        {<span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>}           <span class="hljs-comment">// æ··åˆé¢œè‰²</span>
    );
    
    <span class="hljs-comment">// é‡è¦ï¼å®é™…ä½ç½®éœ€è¦ä»ç“¦ç‰‡åæ ‡è½¬æ¢</span>
    <span class="hljs-comment">// ç“¦ç‰‡ (0,0) å¯¹åº”å±å¹•ä½ç½® (0,0)</span>
    <span class="hljs-comment">// ä½†æˆ‘ä»¬çš„æ­£æ–¹å½¢åœ¨ DisplayItemList ä¸­æ˜¯ (100, 100)</span>
    <span class="hljs-comment">// æ‰€ä»¥æœ€ç»ˆ Quad çš„ rect åº”è¯¥æ˜¯ (100, 100, 200, 200)</span>
    
    <span class="hljs-comment">// æ›´æ­£ï¼š</span>
    quad-&gt;rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>);  <span class="hljs-comment">// æ­£ç¡®çš„å±å¹•ä½ç½®</span>
    quad-&gt;visible_rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>);
    quad-&gt;opacity = <span class="hljs-number">1.0f</span>;
    
    render_pass-&gt;quad_list.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(quad));
    
    <span class="hljs-comment">// æ·»åŠ èµ„æº</span>
    viz::TransferableResource resource;
    resource.id = texture_id;
    resource.mailbox_holder = gpu::<span class="hljs-built_in">MailboxHolder</span>(mailbox, sync_token, target);
    frame.resource_list.<span class="hljs-built_in">push_back</span>(resource);
    
    <span class="hljs-comment">// æ·»åŠ æ¸²æŸ“é€šé“</span>
    frame.render_pass_list.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(render_pass));
    
    <span class="hljs-keyword">return</span> frame;
}

<span class="hljs-comment">// CompositorFrame ç°åœ¨åŒ…å«ï¼š</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   metadata: {</span>
<span class="hljs-comment">//     frame_token: 0x12345,</span>
<span class="hljs-comment">//     device_scale_factor: 1.0,</span>
<span class="hljs-comment">//     size_in_pixels: (1920, 1080),</span>
<span class="hljs-comment">//     ...</span>
<span class="hljs-comment">//   },</span>
<span class="hljs-comment">//   render_pass_list: [</span>
<span class="hljs-comment">//     {</span>
<span class="hljs-comment">//       output_rect: (0, 0, 1920, 1080),</span>
<span class="hljs-comment">//       damage_rect: (100, 100, 200, 200),</span>
<span class="hljs-comment">//       quad_list: [</span>
<span class="hljs-comment">//         TextureDrawQuad {</span>
<span class="hljs-comment">//           rect: (100, 100, 200, 200),</span>
<span class="hljs-comment">//           texture_id: 0x9999,</span>
<span class="hljs-comment">//           opacity: 1.0,</span>
<span class="hljs-comment">//           ...</span>
<span class="hljs-comment">//         }</span>
<span class="hljs-comment">//       ]</span>
<span class="hljs-comment">//     }</span>
<span class="hljs-comment">//   ],</span>
<span class="hljs-comment">//   resource_list: [</span>
<span class="hljs-comment">//     {</span>
<span class="hljs-comment">//       id: 0x9999,</span>
<span class="hljs-comment">//       mailbox: ...  (æŒ‡å‘åŒ…å«æ …æ ¼åŒ–åƒç´ çš„ GPU çº¹ç†)</span>
<span class="hljs-comment">//     }</span>
<span class="hljs-comment">//   ]</span>
<span class="hljs-comment">// }</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> CompositorFrameï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>è¦ç»˜åˆ¶çš„ Quadsï¼ˆå››è¾¹å½¢ï¼‰</li>
<li>Quad çš„ä½ç½®å’Œå¤§å°</li>
<li>æŒ‡å‘çº¹ç†çš„èµ„æº ID</li>
<li>çº¹ç†ä¸­çš„å®é™…åƒç´ æ•°æ®</li>
</ul>
<hr/>
<h3 data-id="heading-32"><strong>ç¬¬6æ­¥ï¼šViz Display Compositor - æœ€ç»ˆåˆæˆå’Œæ˜¾ç¤º</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Viz Display Compositorï¼ˆæ˜¾ç¤ºåˆæˆå™¨ï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Display::DrawFrame</span><span class="hljs-params">(...)</span> </span>{
    <span class="hljs-comment">// 1. æ¥æ”¶ CompositorFrame</span>
    viz::CompositorFrame frame = ...;
    
    <span class="hljs-comment">// 2. éå†æ‰€æœ‰ Quads</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; render_pass : frame.render_pass_list) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; quad : render_pass-&gt;quad_list) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> texture_quad = quad.<span class="hljs-built_in">As</span>&lt;viz::TextureDrawQuad&gt;()) {
                <span class="hljs-comment">// 3. è·å–çº¹ç†ï¼ˆåŒ…å«æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢åƒç´ ï¼‰</span>
                GLuint texture = <span class="hljs-built_in">GetTextureFromResourceId</span>(texture_quad-&gt;resource_id);
                
                <span class="hljs-comment">// 4. åœ¨å±å¹•ä¸Šç»˜åˆ¶è¿™ä¸ªçº¹ç†</span>
                <span class="hljs-comment">// ä½ç½®ï¼š(100, 100)</span>
                <span class="hljs-comment">// å¤§å°ï¼š200Ã—200</span>
                <span class="hljs-comment">// å†…å®¹ï¼šæˆ‘ä»¬æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢çº¹ç†</span>
                
                <span class="hljs-built_in">glBindTexture</span>(GL_TEXTURE_2D, texture);
                <span class="hljs-built_in">glUniform2f</span>(position_uniform, <span class="hljs-number">100.0f</span>, <span class="hljs-number">100.0f</span>);
                <span class="hljs-built_in">glUniform2f</span>(size_uniform, <span class="hljs-number">200.0f</span>, <span class="hljs-number">200.0f</span>);
                <span class="hljs-built_in">glDrawArrays</span>(GL_TRIANGLE_STRIP, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);  <span class="hljs-comment">// ç»˜åˆ¶å››è¾¹å½¢</span>
            }
        }
    }
    
    <span class="hljs-comment">// 5. äº¤æ¢ç¼“å†²åŒº</span>
    <span class="hljs-built_in">SwapBuffers</span>();
    <span class="hljs-comment">// GPU æŠŠç¼“å†²åŒºä¸­çš„åƒç´ æ˜¾ç¤ºåˆ°å±å¹•ä¸Š</span>
}
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µå‘ç”Ÿäº†ä»€ä¹ˆï¼š</strong></p>
<ol>
<li>Display Compositor æ”¶åˆ° CompositorFrame</li>
<li>è¯»å– Quad çš„ä¿¡æ¯ï¼šä½ç½® (100, 100)ï¼Œå¤§å° 200Ã—200</li>
<li>å‘é€ GPU æŒ‡ä»¤ï¼šåœ¨å±å¹•ä¸Šçš„ (100, 100) ä½ç½®ç»˜åˆ¶çº¹ç†</li>
<li>GPU æ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŠŠçº¹ç†ä¸­çš„åƒç´ ï¼ˆè“è‰²æ­£æ–¹å½¢ï¼‰æ˜¾ç¤ºåˆ°å±å¹•ç¼“å†²åŒº</li>
<li>äº¤æ¢ç¼“å†²åŒºï¼Œå±å¹•æ˜¾ç¤ºæœ€ç»ˆç»“æœ</li>
</ol>
<hr/>
<h3 data-id="heading-33">å®Œæ•´çš„æ•°æ®å˜æ¢æ€»ç»“</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">1</span>. <span class="hljs-selector-tag">HTML</span>/CSS æè¿°                                            â”‚
â”‚    &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>; <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;                  â”‚
â”‚                <span class="hljs-attribute">background-color</span>:blue; <span class="hljs-attribute">top</span>:<span class="hljs-number">100px</span>; <span class="hljs-attribute">left</span>:<span class="hljs-number">100px</span>;"&gt;
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (Blink å¸ƒå±€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">2</span>. DisplayItemList (ç»˜åˆ¶æŒ‡ä»¤ï¼Œä¸æ˜¯åƒç´ )                      â”‚
â”‚    <span class="hljs-selector-attr">[SaveOp,                                                 â”‚â”‚     DrawRectOp(x=100, y=100, w=200, h=200, color=blue),   â”‚â”‚     RestoreOp]</span>                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (æäº¤)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">3</span>. CommitState                                              â”‚
â”‚    (åŒ…å« DisplayItemList å’Œå…¶ä»–å±æ€§)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (æ …æ ¼åŒ–)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">4</span>. GPU çº¹ç†ï¼ˆå®é™…åƒç´ ï¼‰<span class="hljs-number">256</span>Ã—<span class="hljs-number">256</span>                              â”‚
â”‚    FFFFFF... FFFFFF... è“è‰²(<span class="hljs-number">0000</span>FF)... è“è‰²... FFFFFF...   â”‚
â”‚    (<span class="hljs-number">100</span>,<span class="hljs-number">100</span>) åˆ° (<span class="hljs-number">300</span>,<span class="hljs-number">300</span>) çš„åƒç´ æ˜¯è“è‰²ï¼Œå…¶ä»–æ˜¯ç™½è‰²         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (ç”Ÿæˆå¸§)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">5</span>. CompositorFrame                                          â”‚
â”‚    quad: {                                                  â”‚
â”‚      <span class="hljs-attribute">position</span>: (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>),                                  â”‚
â”‚      size: (<span class="hljs-number">200</span>, <span class="hljs-number">200</span>),                                      â”‚
â”‚      texture_id: <span class="hljs-number">0</span>x9999 â†’ æŒ‡å‘åŒ…å«è“è‰²åƒç´ çš„çº¹ç†           â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (GPU ç»˜åˆ¶)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">6</span>. å±å¹•å¸§ç¼“å†²ï¼ˆ<span class="hljs-number">1920</span>Ã—<span class="hljs-number">1080</span>ï¼‰                                   â”‚
â”‚    (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>) åˆ° (<span class="hljs-number">300</span>, <span class="hljs-number">300</span>) çš„åƒç´ ç°åœ¨æ˜¯è“è‰²               â”‚
â”‚    å…¶ä»–åƒç´ æ˜¯ç™½è‰²                                            â”‚
â”‚                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â”‚ ...                              â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚ â† (<span class="hljs-number">100</span>,<span class="hljs-number">100</span>)         â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚                     â”‚
â”‚    â”‚ ...                              â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚ â† (<span class="hljs-number">300</span>,<span class="hljs-number">300</span>)         â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                              â”‚
â”‚    âœ“ æ­£æ–¹å½¢æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-34">å…³é”®æ¦‚å¿µæ€»ç»“</h3>
<ol>
<li><strong>DisplayItemList</strong> = ç»˜åˆ¶æŒ‡ä»¤çš„åˆ—è¡¨ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰</li>
<li><strong>æ …æ ¼åŒ–</strong> = æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ çš„è¿‡ç¨‹</li>
<li><strong>çº¹ç†</strong> = GPU å†…å­˜ä¸­çš„åƒç´ ç¼“å†²åŒº</li>
<li><strong>CompositorFrame</strong> = åŒ…å« Quadsï¼ˆå››è¾¹å½¢ï¼‰çš„åˆæˆå¸§ï¼Œæ¯ä¸ª Quad æŒ‡å‘ä¸€ä¸ªçº¹ç†</li>
<li><strong>æœ€ç»ˆåƒç´ </strong> = ç”± GPU æŠŠçº¹ç†ä¸­çš„åƒç´ é€šè¿‡ Quad ä¿¡æ¯ç»˜åˆ¶åˆ°å±å¹•ä¸Š</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹å°±åƒï¼š</p>
<ul>
<li><strong>æŒ‡ä»¤</strong> â†’ <strong>åƒç´ </strong> â†’ <strong>çº¹ç†</strong> â†’ <strong>Quads</strong> â†’ <strong>å±å¹•æ˜¾ç¤º</strong></li>
</ul>
<p>å¥½é—®é¢˜ï¼æ …æ ¼åŒ–æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€æœ‰è¶£çš„éƒ¨åˆ†ã€‚è®©æˆ‘ç”¨æœ€ç›´è§‚çš„æ–¹å¼è§£é‡Šå®ƒã€‚å¤ªå¥½äº†ï¼ç°åœ¨æˆ‘å¯ä»¥ç”¨å®é™…çš„ä»£ç æ¥è§£é‡Šæ …æ ¼åŒ–çš„åŸç†ã€‚è®©æˆ‘ç”¨ä¸€ä¸ªæœ€ç®€å•çš„è“è‰²æ­£æ–¹å½¢ä¾‹å­è¯¦ç»†è®²è§£ï¼š</p>
<h2 data-id="heading-35">æ …æ ¼åŒ–çš„æœ¬è´¨ï¼šå°†æŒ‡ä»¤è½¬æ¢æˆåƒç´ </h2>
<h3 data-id="heading-36"><strong>æ ¸å¿ƒæ€æƒ³ï¼šä½¿ç”¨ Skia åº“</strong></h3>
<p>æ …æ ¼åŒ–çš„ç§˜å¯†å°±æ˜¯ï¼š<strong>Chromium ä½¿ç”¨ä¸€ä¸ªå« Skia çš„å›¾å½¢åº“ï¼Œå®ƒèƒ½æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ </strong>ã€‚</p>
<p>æƒ³è±¡ Skia å°±åƒä¸€ä¸ª<strong>è™šæ‹Ÿç”»å®¶</strong>ï¼š</p>
<ul>
<li>ä½ ç»™å®ƒä¸€ä¸ª<strong>ç©ºç™½ç”»å¸ƒ</strong>ï¼ˆå†…å­˜ç¼“å†²åŒºï¼‰</li>
<li>ä½ ç»™å®ƒ<strong>ç»˜åˆ¶æŒ‡ä»¤</strong>ï¼ˆ"ç”»è“è‰²çŸ©å½¢"ï¼‰</li>
<li>å®ƒå°±ä¼š<strong>ä¸€æ¡æ¡æŒ‡ä»¤åœ°æ‰§è¡Œ</strong>ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªç”»æ»¡äº†é¢œè‰²çš„ç”»å¸ƒ</li>
</ul>
<hr/>
<h3 data-id="heading-37"><strong>å®Œæ•´çš„æ …æ ¼åŒ–è¿‡ç¨‹ï¼ˆä»¥è“è‰²æ­£æ–¹å½¢ä¸ºä¾‹ï¼‰</strong></h3>
<h4 data-id="heading-38"><strong>æ­¥éª¤ 1ï¼šåˆ›å»ºç©ºç™½ç”»å¸ƒ</strong></h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å·¥ä½œçº¿ç¨‹ä¸Šæ‰§è¡Œ</span>
<span class="hljs-comment">// å‡è®¾æˆ‘ä»¬è¦æ …æ ¼åŒ–ä¸€ä¸ª 256Ã—256 çš„ç“¦ç‰‡</span>

<span class="hljs-comment">// æ–¹æ¡ˆ Aï¼šCPU æ …æ ¼åŒ–ï¼ˆè½¯ä»¶æ–¹å¼ï¼‰</span>
<span class="hljs-comment">// ====================================</span>

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª 256Ã—256 çš„ä½å›¾ï¼ˆåƒç´ ç¼“å†²åŒºï¼‰</span>
SkBitmap bitmap;
bitmap.<span class="hljs-built_in">allocN32Pixels</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>);
<span class="hljs-comment">// ç°åœ¨ bitmap ä¸­æœ‰ 256*256 = 65536 ä¸ªåƒç´ </span>
<span class="hljs-comment">// æ¯ä¸ªåƒç´  4 å­—èŠ‚ï¼ˆRGBAï¼‰ï¼Œå…± 262,144 å­—èŠ‚çš„å†…å­˜</span>

<span class="hljs-comment">// å†…å­˜å¸ƒå±€ç¤ºæ„ï¼š</span>
<span class="hljs-comment">// bitmap.getPixels() è¿”å›ä¸€ä¸ªæŒ‡å‘è¿™å—å†…å­˜çš„æŒ‡é’ˆ</span>
<span class="hljs-comment">// å†…å­˜ä¸­çš„æ•°æ®ï¼š</span>
<span class="hljs-comment">// [åƒç´ (0,0)çš„RGBA] [åƒç´ (1,0)çš„RGBA] [åƒç´ (2,0)çš„RGBA] ...</span>
<span class="hljs-comment">// [åƒç´ (0,1)çš„RGBA] [åƒç´ (1,1)çš„RGBA] [åƒç´ (2,1)çš„RGBA] ...</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-comment">// [åƒç´ (255,255)çš„RGBA]</span>

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª Skia ç”»å¸ƒï¼ŒæŒ‡å‘è¿™ä¸ªä½å›¾</span>
<span class="hljs-function">SkCanvas <span class="hljs-title">canvas</span><span class="hljs-params">(bitmap)</span></span>;

<span class="hljs-comment">// æ–¹æ¡ˆ Bï¼šGPU æ …æ ¼åŒ–</span>
<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª GPU çº¹ç†ä½œä¸ºæ¸²æŸ“ç›®æ ‡</span>
GLuint framebuffer = <span class="hljs-built_in">CreateFramebuffer</span>();
GLuint texture = <span class="hljs-built_in">CreateTexture</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, GL_RGBA8);
<span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, framebuffer);
<span class="hljs-built_in">glFramebufferTexture2D</span>(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
                       GL_TEXTURE_2D, texture, <span class="hljs-number">0</span>);

<span class="hljs-comment">// åˆ›å»ºæŒ‡å‘è¿™ä¸ª GPU çº¹ç†çš„ Skia ç”»å¸ƒ</span>
SkSurface* surface = SkSurface::<span class="hljs-built_in">MakeFromBackendTexture</span>(...);
SkCanvas* canvas = surface-&gt;<span class="hljs-built_in">getCanvas</span>();
</code></pre>
<p><strong>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œæ‰€æœ‰åƒç´ éƒ½æ˜¯æœªåˆå§‹åŒ–çš„ã€‚</strong></p>
<hr/>
<h4 data-id="heading-39"><strong>æ­¥éª¤ 2ï¼šæ¸…é™¤èƒŒæ™¯</strong></h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æŠŠæ‰€æœ‰åƒç´ è®¾ç½®ä¸ºç™½è‰²ï¼ˆèƒŒæ™¯è‰²ï¼‰</span>
canvas-&gt;<span class="hljs-built_in">clear</span>(SK_ColorWHITE);

<span class="hljs-comment">// åº•å±‚å‘ç”Ÿäº†ä»€ä¹ˆï¼š</span>
<span class="hljs-comment">// Skia å¡«å……æ•´ä¸ª 256Ã—256 çš„åƒç´ åŒºåŸŸ</span>
<span class="hljs-comment">// å¯¹äºæ¯ä¸€ä¸ªåƒç´  (x, y)ï¼Œè®¾ç½®å®ƒçš„å€¼ä¸ºï¼š</span>
<span class="hljs-comment">// [R=255, G=255, B=255, A=255]  // ç™½è‰² RGBA</span>

<span class="hljs-comment">// æ¸…é™¤åçš„å†…å­˜ç¤ºæ„ï¼š</span>
<span class="hljs-comment">// [FFFFFFFF] [FFFFFFFF] [FFFFFFFF] ... (å…¨æ˜¯ 0xFFFFFFFF = ç™½è‰²)</span>
<span class="hljs-comment">// æ€»å…± 65536 ä¸ªè¿™æ ·çš„ 4 å­—èŠ‚å€¼</span>
</code></pre>
<p><strong>ç°åœ¨æ‰€æœ‰åƒç´ éƒ½æ˜¯ç™½è‰²ã€‚</strong></p>
<hr/>
<h4 data-id="heading-40"><strong>æ­¥éª¤ 3ï¼šéå† DisplayItemList ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤å¹¶æ‰§è¡Œ</strong></h4>
<p>è¿™æ˜¯æœ€å…³é”®çš„éƒ¨åˆ†ï¼</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// RasterSource::PlaybackDisplayListToCanvas()</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PlaybackDisplayListToCanvas</span><span class="hljs-params">(SkCanvas* raster_canvas,
                                 <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span> </span>{
    <span class="hljs-comment">// è·å– DisplayItemList</span>
    DisplayItemList* display_list = ...;  <span class="hljs-comment">// åŒ…å«æˆ‘ä»¬çš„ç»˜åˆ¶æŒ‡ä»¤</span>
    
    <span class="hljs-comment">// åˆ›å»ºå›æ”¾å‚æ•°</span>
    <span class="hljs-function">PlaybackParams <span class="hljs-title">params</span><span class="hljs-params">(settings.image_provider, SkM44())</span></span>;
    
    <span class="hljs-comment">// å…³é”®æ­¥éª¤ï¼šå›æ”¾ DisplayItemList</span>
    display_list-&gt;<span class="hljs-built_in">Raster</span>(raster_canvas, params);
}

<span class="hljs-comment">// DisplayItemList::Raster() çš„å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DisplayItemList::Raster</span><span class="hljs-params">(SkCanvas* canvas,
                             <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> <span class="hljs-type">const</span> </span>{
    <span class="hljs-comment">// 1. è·å–éœ€è¦ç»˜åˆ¶çš„æ“ä½œçš„åç§»é‡</span>
    <span class="hljs-comment">//    ï¼ˆä½¿ç”¨ R-Tree ä¼˜åŒ–ï¼šåªè·å–ä¸ç”»å¸ƒç›¸äº¤çš„æ“ä½œï¼‰</span>
    std::vector&lt;<span class="hljs-type">size_t</span>&gt; offsets = <span class="hljs-built_in">OffsetsOfOpsToRaster</span>(canvas);
    
    <span class="hljs-comment">// offsets = [0, 8, 24]  // SaveOp, DrawRectOp, RestoreOp çš„åç§»é‡</span>
    
    <span class="hljs-comment">// 2. éå† paint_op_buffer_ ä¸­çš„æ“ä½œï¼Œæ‰§è¡Œå®ƒä»¬</span>
    paint_op_buffer_.<span class="hljs-built_in">Playback</span>(canvas, params, <span class="hljs-literal">true</span>, &amp;offsets);
}

<span class="hljs-comment">// PaintOpBuffer::Playback() çš„å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PaintOpBuffer::Playback</span><span class="hljs-params">(SkCanvas* canvas,
                             <span class="hljs-type">const</span> PlaybackParams&amp; params,
                             <span class="hljs-type">bool</span> local_ctm,
                             <span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">size_t</span>&gt;* offsets)</span> <span class="hljs-type">const</span> </span>{
    <span class="hljs-comment">// éå†æ‰€æœ‰æ“ä½œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> PaintOp&amp; op : PaintOpBuffer::<span class="hljs-built_in">OffsetIterator</span>(*<span class="hljs-keyword">this</span>, offsets)) {
        <span class="hljs-comment">// å¯¹äºæ¯ä¸€ä¸ªæ“ä½œï¼Œè°ƒç”¨å®ƒçš„ Raster() å‡½æ•°</span>
        op.<span class="hljs-built_in">Raster</span>(canvas, params);
        
        <span class="hljs-comment">// è¿™å°±æ˜¯é­”æ³•å‘ç”Ÿçš„åœ°æ–¹ï¼</span>
        <span class="hljs-comment">// Raster() æ˜¯è™šå‡½æ•°ï¼Œæ¯ä¸ª PaintOp å­ç±»æœ‰è‡ªå·±çš„å®ç°</span>
    }
}
</code></pre>
<p><strong>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å…·ä½“çš„æ“ä½œæ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// DisplayItemList ä¸­æœ‰è¿™äº›æ“ä½œï¼ˆåºåˆ—åŒ–çš„å½¢å¼ï¼‰ï¼š</span>
<span class="hljs-comment">// [SaveOp] [DrawRectOp(...)] [RestoreOp]</span>

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 1ï¼šSaveOp::Raster()</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SaveOp::Raster</span><span class="hljs-params">(<span class="hljs-type">const</span> SaveOp* op,
                    SkCanvas* canvas,
                    <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    canvas-&gt;<span class="hljs-built_in">save</span>();
    <span class="hljs-comment">// è¿™ä¿å­˜äº†å½“å‰çš„å›¾å½¢çŠ¶æ€ï¼ˆé¢œè‰²ã€å˜æ¢ã€å‰ªè£ç­‰ï¼‰</span>
}

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 2ï¼šDrawRectOp::Raster()ï¼ˆæœ€å…³é”®ï¼ï¼‰</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawRectOp::RasterWithFlags</span><span class="hljs-params">(<span class="hljs-type">const</span> DrawRectOp* op,
                                 <span class="hljs-type">const</span> PaintFlags* flags,
                                 SkCanvas* canvas,
                                 <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    <span class="hljs-comment">// op-&gt;rect = SkRect{x=100, y=100, w=200, h=200}</span>
    <span class="hljs-comment">// flags-&gt;color = SK_ColorBLUE = 0x0000FFFF (RGBA)</span>
    
    <span class="hljs-comment">// è¿™æ˜¯æœ€å…³é”®çš„è°ƒç”¨ï¼</span>
    canvas-&gt;<span class="hljs-built_in">drawRect</span>(op-&gt;rect, *flags);
    
    <span class="hljs-comment">// Skia ä¼šåœ¨è¿™ä¸€åˆ»åšä»€ä¹ˆï¼Ÿ</span>
    <span class="hljs-comment">// å®ƒä¼šéå†è¦å¡«å……çš„çŸ©å½¢ä¸­çš„æ¯ä¸€ä¸ªåƒç´ ï¼Œè®¾ç½®å®ƒä»¬çš„é¢œè‰²ä¸ºè“è‰²</span>
}

<span class="hljs-comment">// Skia å†…éƒ¨å¦‚ä½•æ‰§è¡Œ drawRectï¼Ÿ</span>
<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">// ä¼ªä»£ç ï¼Œå¤§è‡´æ€è·¯ï¼š</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SkCanvas::drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> </span>{
    <span class="hljs-comment">// 1. å°† SkRect è½¬æ¢ä¸ºåƒç´ åæ ‡</span>
    <span class="hljs-type">int</span> x1 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">left</span>();    <span class="hljs-comment">// 100</span>
    <span class="hljs-type">int</span> y1 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">top</span>();     <span class="hljs-comment">// 100</span>
    <span class="hljs-type">int</span> x2 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">right</span>();   <span class="hljs-comment">// 300</span>
    <span class="hljs-type">int</span> y2 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">bottom</span>();  <span class="hljs-comment">// 300</span>
    
    SkColor color = paint.<span class="hljs-built_in">getColor</span>();  <span class="hljs-comment">// 0x0000FFFF (è“è‰²)</span>
    
    <span class="hljs-comment">// 2. éå†çŸ©å½¢å†…çš„æ‰€æœ‰åƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = y1; y &lt; y2; y++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = x1; x &lt; x2; x++) {
            <span class="hljs-comment">// 3. å¯¹äºæ¯ä¸€ä¸ªåƒç´ ï¼Œå†™å…¥è“è‰²é¢œè‰²å€¼</span>
            <span class="hljs-type">uint32_t</span>* pixel_ptr = bitmap.<span class="hljs-built_in">getAddr32</span>(x, y);
            *pixel_ptr = color;  <span class="hljs-comment">// è®¾ç½®ä¸º 0x0000FFFF</span>
        }
    }
    
    <span class="hljs-comment">// å®é™…ä¸Š Skia åšçš„æ›´å¤æ‚ï¼ˆå¤„ç†åé”¯é½¿ã€æ··åˆç­‰ï¼‰ï¼Œ</span>
    <span class="hljs-comment">// ä½†æ ¸å¿ƒæ€æƒ³å°±æ˜¯è¿™æ ·ï¼šå†™å…¥åƒç´ å€¼</span>
}

<span class="hljs-comment">// æ …æ ¼åŒ–åçš„å†…å­˜çŠ¶æ€ï¼š</span>
<span class="hljs-comment">// y=0    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (å…¨æ˜¯ç™½è‰²)</span>
<span class="hljs-comment">// y=99   FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...</span>
<span class="hljs-comment">// y=100  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF... (å¼€å§‹æœ‰è“è‰²ï¼)</span>
<span class="hljs-comment">//        ^        ^       ^</span>
<span class="hljs-comment">//        0      100    100-300 æ˜¯è“è‰²</span>
<span class="hljs-comment">// y=101  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-comment">// y=299  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// y=300  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// y=301  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (åˆéƒ½æ˜¯ç™½è‰²äº†)</span>

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 3ï¼šRestoreOp::Raster()</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RestoreOp::Raster</span><span class="hljs-params">(<span class="hljs-type">const</span> RestoreOp* op,
                       SkCanvas* canvas,
                       <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    canvas-&gt;<span class="hljs-built_in">restore</span>();
    <span class="hljs-comment">// æ¢å¤ä¹‹å‰ä¿å­˜çš„å›¾å½¢çŠ¶æ€</span>
}
</code></pre>
<p><strong>ç»è¿‡è¿™ä¸‰ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„æ …æ ¼åŒ–ç»“æœï¼</strong></p>
<hr/>
<h3 data-id="heading-41"><strong>å®Œæ•´çš„æ•°æ®å˜æ¢ç¤ºæ„</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¼€å§‹æ …æ ¼åŒ–</span>

<span class="hljs-comment">// è¾“å…¥ 1ï¼šDisplayItemListï¼ˆç»˜åˆ¶æŒ‡ä»¤ï¼‰</span>
DisplayItemList {
    paint_op_buffer: [
        SaveOp,
        <span class="hljs-built_in">DrawRectOp</span>(
            rect={x:<span class="hljs-number">100</span>, y:<span class="hljs-number">100</span>, w:<span class="hljs-number">200</span>, h:<span class="hljs-number">200</span>},
            color=<span class="hljs-number">0x0000FFFF</span>  <span class="hljs-comment">// è“è‰²</span>
        ),
        RestoreOp
    ],
    visual_rects: [{<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">200</span>,<span class="hljs-number">200</span>}, ...]
}

<span class="hljs-comment">// è¾“å…¥ 2ï¼šç©ºç™½ç”»å¸ƒï¼ˆ256Ã—256 çš„ä½å›¾ï¼‰</span>
SkBitmap bitmap {
    width: <span class="hljs-number">256</span>,
    height: <span class="hljs-number">256</span>,
    pixels: [
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 0 è¡Œï¼ˆ256 ä¸ªç™½è‰²åƒç´ ï¼‰</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 1 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>   <span class="hljs-comment">// ç¬¬ 255 è¡Œ</span>
    ]
}

<span class="hljs-comment">// ============================================================</span>
<span class="hljs-comment">// æ‰§è¡Œå›æ”¾</span>
<span class="hljs-comment">// ============================================================</span>

canvas-&gt;<span class="hljs-built_in">save</span>();
canvas-&gt;<span class="hljs-built_in">drawRect</span>(SkRect{<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">200</span>,<span class="hljs-number">200</span>}, blue_paint);
canvas-&gt;<span class="hljs-built_in">restore</span>();

<span class="hljs-comment">// æ …æ ¼åŒ–åçš„è¾“å‡ºï¼šä½å›¾å†…å®¹è¢«ä¿®æ”¹äº†</span>
SkBitmap bitmap {
    width: <span class="hljs-number">256</span>,
    height: <span class="hljs-number">256</span>,
    pixels: [
        <span class="hljs-comment">// y=0 åˆ° y=99ï¼šå…¨æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 0 è¡Œ</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 1 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 99 è¡Œ</span>
        
        <span class="hljs-comment">// y=100 åˆ° y=299ï¼šä¸­é—´æ˜¯è“è‰²ï¼Œè¾¹ç¼˜æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0x0000FFFF</span>, ..., <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ...,
        <span class="hljs-comment">//         |</span>
        <span class="hljs-comment">//    x=0 åˆ° 99  100 åˆ° 299ï¼ˆè“è‰²åŒºåŸŸï¼‰  300 åˆ° 255</span>
        
        <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0x0000FFFF</span>, ..., <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ...,
        <span class="hljs-comment">// ... é‡å¤ 200 æ¬¡ï¼ˆy=100 åˆ° y=299ï¼‰</span>
        
        <span class="hljs-comment">// y=300 åˆ° y=255ï¼šå…¨æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 300 è¡Œ</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 301 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>   <span class="hljs-comment">// ç¬¬ 255 è¡Œ</span>
    ]
}
</code></pre>
<hr/>
<h3 data-id="heading-42"><strong>ä¸ºä»€ä¹ˆèƒ½æŠŠæŒ‡ä»¤è½¬æ¢æˆåƒç´ ï¼Ÿ</strong></h3>
<p>å…³é”®æ˜¯ Skia åº“çš„è®¾è®¡ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Skia çš„æ ¸å¿ƒå°±æ˜¯æä¾›ä¸€ä¸ªè™šæ‹Ÿçš„ SkCanvas</span>
<span class="hljs-comment">// æ— è®ºä½ æ˜¯åœ¨ CPU ä¸Šè¿˜æ˜¯ GPU ä¸Šç»˜åˆ¶ï¼Œæ¥å£éƒ½æ˜¯ä¸€æ ·çš„</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkCanvas</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è¿™äº›æ–¹æ³•æœ‰å¤šç§å®ç°ï¼š</span>
    <span class="hljs-comment">// - CPU å®ç°ï¼šç›´æ¥ä¿®æ”¹åƒç´ ç¼“å†²åŒº</span>
    <span class="hljs-comment">// - GPU å®ç°ï¼šç”Ÿæˆ GPU æŒ‡ä»¤</span>
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawPath</span><span class="hljs-params">(<span class="hljs-type">const</span> SkPath&amp; path, <span class="hljs-type">const</span> SkPaint&amp; paint)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawImage</span><span class="hljs-params">(<span class="hljs-type">const</span> SkImage* image, ...)</span></span>;
    <span class="hljs-comment">// ... ç­‰ç­‰</span>
};

<span class="hljs-comment">// CPU ç‰ˆæœ¬çš„ drawRectï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkRasterCanvas</span> : <span class="hljs-keyword">public</span> SkCanvas {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-comment">// ç›´æ¥æ“ä½œ fBitmap çš„åƒç´ </span>
        <span class="hljs-type">uint32_t</span>* pixels = fBitmap.<span class="hljs-built_in">getPixels</span>();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = rect.<span class="hljs-built_in">top</span>(); y &lt; rect.<span class="hljs-built_in">bottom</span>(); y++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = rect.<span class="hljs-built_in">left</span>(); x &lt; rect.<span class="hljs-built_in">right</span>(); x++) {
                <span class="hljs-type">int</span> index = y * width + x;
                pixels[index] = paint.<span class="hljs-built_in">getColor</span>();  <span class="hljs-comment">// è®¾ç½®åƒç´ é¢œè‰²</span>
            }
        }
    }
};

<span class="hljs-comment">// GPU ç‰ˆæœ¬çš„ drawRectï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkGPUCanvas</span> : <span class="hljs-keyword">public</span> SkCanvas {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-comment">// ç”Ÿæˆ GPU æŒ‡ä»¤</span>
        <span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, fFramebuffer);
        <span class="hljs-built_in">glClearColor</span>(paint.<span class="hljs-built_in">getColor</span>());
        <span class="hljs-built_in">glClear</span>(GL_COLOR_BUFFER_BIT);
        <span class="hljs-comment">// ... ç­‰ç­‰</span>
    }
};
</code></pre>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ol>
<li><strong>DrawRectOp æœ¬è´¨ä¸Šå°±æ˜¯ <code>canvas-&gt;drawRect()</code></strong></li>
<li><strong>drawRect() éå†çŸ©å½¢å†…çš„æ‰€æœ‰åƒç´ </strong></li>
<li><strong>å¯¹äºæ¯ä¸ªåƒç´ ï¼Œè®¾ç½®å®ƒçš„é¢œè‰²ä¸ºæŒ‡å®šçš„é¢œè‰²</strong></li>
<li><strong>ç»“æœæ˜¯ä½å›¾ä¸­çš„åƒç´ è¢«ä¿®æ”¹äº†</strong></li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆèƒ½æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ ï¼</p>
<hr/>
<h3 data-id="heading-43"><strong>å…³é”®ä»£ç ç‰‡æ®µæ€»ç»“</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp">
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RasterSource::PlaybackDisplayListToCanvas</span><span class="hljs-params">(
    SkCanvas* raster_canvas,
    <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span> <span class="hljs-type">const</span> </span>{
  <span class="hljs-built_in">CHECK</span>(display_list_);
  
  <span class="hljs-comment">// åˆ›å»ºå›æ”¾å‚æ•°</span>
  <span class="hljs-function">PlaybackParams <span class="hljs-title">params</span><span class="hljs-params">(settings.image_provider, SkM44())</span></span>;
  params.raster_inducing_scroll_offsets =
      settings.raster_inducing_scroll_offsets;
  params.destination_hdr_headroom = settings.hdr_headroom;
  
  <span class="hljs-comment">// æ ¸å¿ƒï¼šå›æ”¾ DisplayItemList</span>
  <span class="hljs-comment">// è¿™ä¼šéå†æ‰€æœ‰ PaintOps å¹¶æ‰§è¡Œå®ƒä»¬</span>
  display_list_-&gt;<span class="hljs-built_in">Raster</span>(raster_canvas, params);
}

<span class="hljs-comment">// è¿™å°±æ˜¯ä¸€åˆ‡ï¼</span>
<span class="hljs-comment">// display_list_-&gt;Raster() ä¼šï¼š</span>
<span class="hljs-comment">// 1. éå† DisplayItemList ä¸­çš„æ¯ä¸ª PaintOp</span>
<span class="hljs-comment">// 2. å¯¹äºæ¯ä¸ª PaintOpï¼Œè°ƒç”¨å®ƒçš„ Raster() æ–¹æ³•</span>
<span class="hljs-comment">// 3. æ¯ä¸ª Raster() æ–¹æ³•ä½¿ç”¨ Skia canvas ä¿®æ”¹åƒç´ </span>
<span class="hljs-comment">// 4. æœ€åå¾—åˆ°ä¸€ä¸ªå¡«æ»¡é¢œè‰²çš„ä½å›¾</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603653885602218034</link>    <guid>https://juejin.cn/post/7603653885602218034</guid>    <pubDate>2026-02-07T10:46:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885602218034" data-draft-id="7603574149776703540" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-07T10:46:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:46:54.000Z" title="Sat Feb 07 2026 10:46:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯¼è¯­ï½œéšç€æ•°å­—åŒ–è½¬å‹è¿›å…¥æ·±æ°´åŒºï¼ŒAI å·²è¶…è¶Šå·¥å…·å±æ€§ï¼Œæ·±åº¦èå…¥ä¼ä¸šè¿è¥ï¼Œå…¨é“¾è·¯é‡å¡‘ä¸šåŠ¡æµç¨‹ã€‚ä»æ‰“é€šååŒå£å’ã€è‡ªåŠ¨åŒ–é‡å¤å·¥ä½œï¼Œåˆ°è¯Šæ–­æµç¨‹ç“¶é¢ˆã€è¿­ä»£ä¸šåŠ¡æ¨¡å¼ï¼ŒAI æˆä¸ºä¼ä¸šé™æœ¬å¢æ•ˆã€æ„ç­‘æ ¸å¿ƒç«äº‰åŠ›çš„å…³é”®å¼•æ“ã€‚æœ¬æ–‡ç‰¹é‚€ä¸Šæµ·è…¾å±•é•¿èè‘£äº‹ &amp; CTOã€è…¾è®¯äº‘ TVP éŸ©å…‰ç¥–ï¼Œä»–å°†ç»“åˆè‡ªèº«åœ¨é‡‘èä¸åˆ¶é€ ä¸šçš„å®è·µç»éªŒï¼Œæ·±å…¥å‰–æ AI ä¼˜åŒ–æµç¨‹çš„ç°çŠ¶ï¼Œæ¢è®¨ç ´å±€ä¹‹é“ï¼Œä¸ºå•†ä¸šé¢†è¢–æä¾›ä¸€ä»½å®æˆ˜æŒ‡å—ã€‚</p>
<h2 data-id="heading-0"><strong>ä½œè€…ç®€ä»‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2ef8f931c1c4bcfa344c554c5cc1f1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=LwyYiW8naOInT7G1Fdf0RnM2FlU%3D" alt="" loading="lazy"/></p>
<p>éŸ©å…‰ç¥–ï¼Œç°ä»»ä¸Šæµ·è…¾å±•é•¿èè‘£äº‹ &amp; CTOã€‚ç¾å›½å—åŠ å·å¤§å­¦ä¼ç®¡ç¡•å£«ï¼Œæ›¾ä»»å¯Œé‚¦åä¸€éŠ€è¡Œæ€»éƒ¨æ¸ é“ä¸æ•°å­—é“¶è¡Œéƒ¨å‰¯æ€»è£åŠæ€»éƒ¨ä¿¡æ¯ç§‘æŠ€éƒ¨å‰¯æ€»è£ã€çº¬åˆ›é›†å›¢ WistronITS å…¨çƒæ€»éƒ¨é¦–å¸­ä¿¡æ¯å®˜ ã€ä¼ä¸šèµ„å®‰ä¸»å§”ã€å­è¾°å›½é™…å¼€å‘(å¤®ä¼æ¸¯é“¶åšæºåŸºé‡‘)æŠ€æœ¯é¡¾é—®å…¼ä»» COO (æŠ•èµ„ï¼‰ã€æ–°è›‹ç½‘å…¨çƒç§‘æŠ€åŠå§”å¤–æœåŠ¡æ€»ç›‘ã€å¤–èµ„é“¶è¡Œç§‘æŠ€ä¸€çº§éƒ¨(éƒ¨)ä¸»ç®¡ 12 å¹´ ã€‚æœ‰ 20 ä½™å¹´ä¼ä¸š IT/MIS/IS è¥è¿ç»éªŒï¼Œæœ‰ DDã€ç§å‹Ÿå€ºæƒèèµ„ã€å·¥ä¸šåœ°äº§äº¤æ˜“ä¸è‚¡æƒè½¬è®©ã€è·¨å¢ƒé‡‘èè´¢åŠ¡ã€ç§‘æŠ€å‘å±•ä¸åˆ›æ–°ç»éªŒã€‚å¤šå¹´å¤§å‹ç”µå•†è¡Œä¸šä»ä¸šåŠé“¶è¡Œæ ¸å¿ƒç³»ç»Ÿæ›´æ¢ç»éªŒ, ç†Ÿæ‚‰ä¿¡æ¯åŒ–ã€æ•°å®åŒ–ã€å•†ä¸šç³»ç»Ÿåˆ†æã€äº‘æ¶æ„åŠäº‘è¿ç§»ã€ç”µä¿¡å…¬æœ‰äº‘å»ºç½®åŠå¼€å‘ã€æ•´åˆ; å¹¶ç†Ÿæ‚‰ç ”å‘ã€äº§å“ã€å”®å‰ã€äº¤ä»˜ã€å”®åç­‰ä¸šåŠ¡ï¼›åŒ…æ‹¬ä¸“ä¸šçš„æœåŠ¡è§£å†³æ–¹æ¡ˆã€è§„åˆ’ã€å®æ–½ã€å»ºç«‹å¤§å‹èµ„æ–™åˆ†æã€èµ„æ–™é‡‡é›†åŠæ·±åº¦å­¦ä¹ å›¾åƒç‰©ä»¶ä¾¦æµ‹çš„ã€AI å·¥è‰ºè¾…åŠ©å†³ç­–åŠï¼Œç†Ÿæ‚‰ä¼ä¸šæ•´ä½“æˆ˜ç•¥è§„åˆ’ä¸å®æ–½ã€‚</p>
<h2 data-id="heading-1"><strong>å¼•è¨€</strong></h2>
<p>æ ¹æ®éº¦è‚¯é”¡ 2025 å¹´å…¨çƒ AI ç°çŠ¶è°ƒç ”ï¼Œè‡³å°‘åœ¨ä¸€ä¸ªä¸šåŠ¡èŒèƒ½ä¸­å¸¸æ€åŒ–ä½¿ç”¨ AI çš„ä¼ä¸šæ¯”ä¾‹å·²è¾¾åˆ° 88% â½Â¹â¾ã€‚ç„¶è€Œï¼ŒçœŸæ­£çš„æŒ‘æˆ˜åœ¨äºè§„æ¨¡åŒ–åº”ç”¨ï¼Œç›®å‰ä»…çº¦ä¸‰åˆ†ä¹‹ä¸€çš„ä¼ä¸šå®ç°äº† AI åœ¨å…¨å…¬å¸çš„è§„æ¨¡åŒ–éƒ¨ç½² â½Â¹â¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/122d947a6a6540f29a6891cdf85cbc2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=HtM3mcZTWDs8%2FCQpD4bW3cF4UwA%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ•ˆç‡æå‡æ–¹é¢ï¼ŒAI çš„åº”ç”¨æ•ˆæœæ˜¾è‘—ï¼Œä½†å…·ä½“å¢å¹…å› åœºæ™¯è€Œå¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•°æ®åˆ†æå’Œæ™ºèƒ½å†³ç­–é¢†åŸŸï¼Œå¹³å‡æ•ˆç‡æå‡å¯è¾¾ 35% â½Â²â¾ï¼›è€Œåœ¨æ›´å¹¿æ³›çš„æµç¨‹ç®¡ç†ä¸­ï¼Œæ•ˆç‡æå‡å¹…åº¦åœ¨ 30% è‡³ 50% ä¹‹é—´ â½Â³â¾ã€‚ç»¼åˆæ¥çœ‹ï¼Œè‰¾ç‘å’¨è¯¢çš„æ•°æ®æ˜¾ç¤ºï¼Œ2023 å¹´ä¸­å›½ä¼ä¸šé€šè¿‡AIä¸æ•°å­—åŒ–è½¬å‹ï¼Œæ•´ä½“è¿è¥æ•ˆç‡å¹³å‡æå‡äº† 27.5% â½â´â¾ã€‚</p>
<p>ç„¶è€Œï¼Œä»æŠ€æœ¯æ½œåŠ›åˆ°å•†ä¸šä»·å€¼çš„è½¬åŒ–ä¹‹è·¯å¹¶éå¦é€”ã€‚è®¸å¤šä¼ä¸šåœ¨æ»¡æ€€æœŸæœ›åœ°æ‹¥æŠ± AI æ—¶ï¼Œå´é­é‡äº†æŠ€æœ¯ä¸ä¸šåŠ¡â€œä¸¤å¼ çš®â€ã€ç»„ç»‡æ–‡åŒ–é˜»åŠ›ã€æ•°æ®å­¤å²›éš¾å¹³ã€æŠ•èµ„å›æŠ¥ä¸åŠé¢„æœŸç­‰å¤šé‡å›°å¢ƒã€‚æœ¬æ–‡<strong>å°†æ·±å…¥å‰–æ AI é©±åŠ¨æµç¨‹å†é€ çš„ç°çŠ¶ä¸åœºæ™¯ï¼Œæ¢è®¨ä»è¯•ç‚¹åˆ°è§„æ¨¡åŒ–çš„ç ´å±€ä¹‹é“ã€‚</strong></p>
<h2 data-id="heading-2"><strong>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ–°èŒƒå¼å·²è‡³ï¼ŒAIé©±åŠ¨çš„æµç¨‹å†é€ ç°çŠ¶ä¸åœºæ™¯</strong></h2>
<p>AI å¯¹ä¸šåŠ¡æµç¨‹çš„æ”¹é€ ï¼Œå·²ä»è¿‡å»çš„â€œç‚¹çŠ¶â€è¾…åŠ©ï¼Œæ¼”å˜ä¸ºå¦‚ä»Šçš„â€œé“¾å¼â€é‡æ„ã€‚å…¶æ ¸å¿ƒé©±åŠ¨åŠ›æºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€AI æ™ºèƒ½ä½“ï¼ˆAI Agentï¼‰ç­‰æŠ€æœ¯çš„çªç ´ã€‚ä¸ä¼ ç»Ÿè‡ªåŠ¨åŒ–æŠ€æœ¯ä¸åŒï¼Œç°ä»£ AI ä¸ä»…èƒ½æ‰§è¡Œé¢„è®¾è§„åˆ™ï¼Œæ›´å…·å¤‡äº†ä¸Šä¸‹æ–‡ç†è§£ã€é€»è¾‘æ¨ç†ã€è‡ªä¸»è§„åˆ’ä¸è·¨ç³»ç»ŸååŒçš„èƒ½åŠ›ï¼Œä½¿å…¶èƒ½å¤Ÿèƒœä»»è¿‡å»åªæœ‰äººç±»æ‰èƒ½å¤„ç†çš„å¤æ‚æ¨¡ç³Šä»»åŠ¡ã€‚åŸƒæ£®å“²æŠ¥å‘Šæ˜¾ç¤ºï¼Œ53% çš„ä¸­å›½ä¼ä¸šæ­£åˆ©ç”¨ AI è¿æ¥å¹¶èåˆå¤šä¸ªä¸šåŠ¡æµç¨‹ï¼Œè¿™ä¸€æ¯”ä¾‹é«˜å‡ºå…¨çƒå¹³å‡æ°´å¹³ 11 ä¸ªç™¾åˆ†ç‚¹ â½Â²â¾ã€‚</p>
<p>åœ¨æ•°æ®å¯†é›†å‹è¡Œä¸šä¸­ï¼ŒAI çš„ä»·å€¼æ­£ä»ç®€å•çš„â€œä»»åŠ¡æ‰§è¡Œâ€è½¬å‘â€œæ™ºèƒ½å†³ç­–â€ã€‚ä»¥ä¸‹ä¸ºå‡ ä¸ªä»£è¡¨æ€§è¡Œä¸šçš„åº”ç”¨åœºæ™¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3acf0a844a845278c934d9ae1e8354f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=vlnn2DKTWYYFI09cECxmoqQeqZ8%3D" alt="" loading="lazy"/></p>
<p><strong>é“¶è¡Œä¸šï¼šé£é™©ä¸æ•ˆç‡çš„å¹³è¡¡é‡å¡‘</strong></p>
<p>åœ¨æˆ‘çš„ä»ä¸šç»å†ä¸­ï¼Œé“¶è¡Œä¸šå¯¹é£é™©çš„æ•¬ç•æ ¹æ·±è’‚å›ºï¼Œè¿™æ›¾ä¸€åº¦ä½¿å…¶åœ¨æŠ€æœ¯é‡‡ç”¨ä¸Šæ˜¾å¾—ç›¸å¯¹ä¿å®ˆã€‚ç„¶è€Œï¼Œé¢å¯¹æ¿€çƒˆçš„å¸‚åœºç«äº‰ä¸æ—¥ç›Šå¤æ‚çš„é‡‘èé£é™©ï¼ŒAI å·²æˆä¸ºå…¶ä¸å¾—ä¸æ‹¥æŠ±çš„æˆ˜ç•¥é€‰æ‹©ï¼Œæ­£åŠ©åŠ›å…¶é‡æ„æ ¸å¿ƒçš„ä¿¡è´·ä¸é£æ§æµç¨‹ã€‚</p>
<p>å·¥å•†é“¶è¡Œæ‰“é€ çš„â€œè´¢åŠ¡æ™ºèƒ½åˆ†æåŠ©æ‰‹â€ï¼Œèƒ½å¤Ÿæ·±åº¦è§£æä¼ä¸šè´¢æŠ¥ï¼Œè‡ªåŠ¨æå–å…³é”®æŒ‡æ ‡ï¼Œä¸ºå®¡æ‰¹äººå‘˜æä¾›å†³ç­–æ”¯æŒï¼Œä¸ä»…å°†å•ç¬”ä¸šåŠ¡æ•ˆç‡æå‡äº† 20%ï¼Œæ›´å½¢æˆäº†ä¸€ç§â€œæ•°æ®+AI+è¾…åŠ©å†³ç­–â€çš„è¯„å®¡æ–°èŒƒå¼ â½â´â¾ã€‚åŒæ ·ï¼Œæ±‡ä¸°é“¶è¡Œä¹Ÿå·²å°†å¤§æ¨¡å‹æŠ€æœ¯ç”¨äºè‡ªåŠ¨ç”Ÿæˆä¿¡è´·å»ºè®®ä¹¦ï¼Œå®ç°äº†æµç¨‹çš„å†é€  â½â¶â¾ã€‚è¿™èƒŒåæ˜¯ AI å¼ºå¤§çš„éç»“æ„åŒ–æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œå®ƒèƒ½å¿«é€Ÿâ€œé˜…è¯»â€å¹¶ç†è§£è´¢æŠ¥ã€åˆåŒã€æ³•å¾‹æ–‡ä¹¦ç­‰æµ·é‡æ–‡æ¡£ï¼Œå°†ä¿¡å®¡äººå‘˜ä»ç¹ççš„äº‹åŠ¡æ€§å·¥ä½œä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨äºæ›´æ ¸å¿ƒçš„é£é™©åˆ¤æ–­ã€‚</p>
<p>åœ¨åæ´—é’±ï¼ˆAMLï¼‰ç­‰åˆè§„é¢†åŸŸï¼ŒAI çš„åº”ç”¨åˆ™æ›´ä¸ºæ·±åˆ»ã€‚å¾·å‹¤æå‡ºçš„å¤šæ™ºèƒ½ä½“ï¼ˆMulti-Agentï¼‰åä½œç³»ç»Ÿæ„æƒ³ï¼Œæç»˜äº†ä¸€å¹…æœªæ¥é“¶è¡Œåˆè§„çš„è“å›¾ï¼šä¸åŒçš„ AI æ™ºèƒ½ä½“åˆ†åˆ«è´Ÿè´£è­¦æŠ¥å®¡æŸ¥ã€äº¤æ˜“è®°å½•åˆ†æã€è°ƒæŸ¥æŠ¥å‘Šæ’°å†™ï¼Œå®ç°å‡ ä¹æ— éœ€äººå·¥å¹²é¢„çš„å…¨è‡ªåŠ¨åˆè§„ç›‘æµ‹ â½â·â¾ã€‚è¿™ä¸ä»…æ˜¯æ•ˆç‡çš„é£è·ƒï¼Œæ›´æ˜¯é£é™©æ´å¯Ÿèƒ½åŠ›çš„è´¨å˜ï¼ŒAI èƒ½ä»æµ·é‡æ•°æ®ä¸­å‘ç°äººå·¥éš¾ä»¥å¯Ÿè§‰çš„éšè”½éæ³•æ´»åŠ¨æ¨¡å¼ã€‚</p>
<p><strong>ä¿é™©ä¸šï¼šå®¢æˆ·ä½“éªŒä¸è¿è¥æ•ˆç‡çš„åŒé‡é©å‘½</strong></p>
<p>ä¿é™©ä¸šçš„æ ¸å¿ƒåœ¨äºé£é™©å®šä»·ä¸æœåŠ¡æ‰¿è¯ºï¼Œå…¶ä¸šåŠ¡æµç¨‹å¤©ç„¶ä¸æ•°æ®å’Œæ¦‚ç‡ç´§å¯†ç›¸è¿ï¼Œä¸º AI æä¾›äº†å¹¿é˜”çš„åº”ç”¨èˆå°ã€‚å¦‚æœè¯´é“¶è¡Œä¸šçš„ AI åº”ç”¨æ ¸å¿ƒæ˜¯â€œé£æ§â€ï¼Œé‚£ä¹ˆä¿é™©ä¸šçš„æ ¸å¿ƒåˆ™æ˜¯â€œæ•ˆç‡â€ä¸â€œä½“éªŒâ€ã€‚</p>
<p>æ™ºèƒ½ç†èµ”æ˜¯ä¿é™©ä¸š AI åº”ç”¨æœ€æˆç†Ÿã€ä»·å€¼æœ€æ˜¾è‘—çš„é¢†åŸŸã€‚è¿‡å»ï¼Œè½¦é™©ç†èµ”æµç¨‹æ¼«é•¿ï¼Œæ¶‰åŠæŸ¥å‹˜ã€å®šæŸã€æ ¸èµ”ç­‰å¤šä¸ªç¯èŠ‚ï¼Œå®¢æˆ·ä½“éªŒæ™®éä¸ä½³ã€‚å¦‚ä»Šï¼Œä»¥ä¸­å›½å¹³å®‰ä¸ºä»£è¡¨çš„å¤´éƒ¨é™©ä¼ï¼Œé€šè¿‡ AI å›¾åƒè¯†åˆ«æŠ€æœ¯ï¼Œå®ç°äº†â€œæ‹ç…§å³å®šæŸâ€ã€‚å®¢æˆ·åªéœ€ä¸Šä¼ äº‹æ•…ç…§ç‰‡ï¼ŒAI ä¾¿èƒ½å¿«é€Ÿè¯†åˆ«æŸä¼¤éƒ¨ä»¶ã€è¯„ä¼°ç»´ä¿®æˆæœ¬ï¼Œæ•´ä¸ªå®šæŸæµç¨‹å¯åœ¨ 30 åˆ†é’Ÿå†…å®Œæˆ â½âµâ¾ã€‚è¿™ä¸ä»…å¤§å¹…æå‡äº†å®¢æˆ·æ»¡æ„åº¦ï¼Œä¹Ÿæœ‰æ•ˆé™ä½äº†è¿è¥æˆæœ¬ã€‚2025 å¹´ä¸ŠåŠå¹´ï¼Œå¹³å®‰äº§é™©é€šè¿‡ AI æŠ€æœ¯å®ç°çš„æ™ºèƒ½åŒ–åæ¬ºè¯ˆæ‹¦æˆªï¼Œå°±ä¸ºå…¬å¸å‡å°‘äº†é«˜è¾¾ 64.4 äº¿å…ƒçš„æŸå¤± â½âµâ¾ã€‚</p>
<p>åœ¨ç†èµ”ä¹‹å¤–ï¼ŒAI æ­£å‘ä¿é™©ä»·å€¼é“¾çš„å‰ç«¯â€”â€”æ‰¿ä¿ä¸å®šä»·ç¯èŠ‚æ¸—é€ã€‚æ‘©æ ¹å£«ä¸¹åˆ©çš„æŠ¥å‘Šé¢„æµ‹ï¼ŒAI å°†åœ¨ç¬¬äºŒé˜¶æ®µé€šè¿‡ä¼˜åŒ–é£é™©é€‰æ‹©å’Œå®šä»·ç²¾å‡†åº¦ï¼Œæ·±åˆ»æ”¹å˜ä¿é™©å…¬å¸çš„ç›ˆåˆ©æ¨¡å¼ â½â¸â¾ã€‚è¿™æ„å‘³ç€ï¼Œæœªæ¥çš„ä¿é™©äº§å“å°†æ›´åŠ ä¸ªæ€§åŒ–ï¼Œä¿è´¹å°†æ ¹æ®æ¯ä¸ªå®¢æˆ·çš„å®æ—¶é£é™©çŠ¶å†µè¿›è¡ŒåŠ¨æ€è°ƒæ•´ã€‚è¿™ä¸ä»…è¦æ±‚ä¿é™©å…¬å¸å…·å¤‡å¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œæ›´å¯¹å…¶ AI å»ºæ¨¡ä¸æ²»ç†èƒ½åŠ›æå‡ºäº†æé«˜è¦æ±‚ã€‚</p>
<h2 data-id="heading-3"><strong>ç¬¬äºŒéƒ¨åˆ†ï¼šå·¥å…·æ–¹æ³•è®ºï¼ŒBPMNä¸‰éƒ¨æ›²ï¼Œè®©æµç¨‹æ”¹é€ æœ‰ç« å¯å¾ª</strong></h2>
<p>åœ¨ AI é©±åŠ¨çš„æµç¨‹å†é€ ä¸­ï¼Œä¼ä¸šå¾€å¾€é¢ä¸´â€œæ— ä»ä¸‹æ‰‹â€çš„çª˜å¢ƒã€‚æˆ‘ä»¬å¼•å…¥æ ‡å‡†çš„ BPMNï¼ˆä¸šåŠ¡æµç¨‹å»ºæ¨¡ä¸æ ‡æ³¨ï¼‰æ–¹æ³•è®ºï¼Œå°†æ”¹é€ åˆ†ä¸ºä¸‰ä¸ªå…³é”®é˜¶æ®µï¼šè¯„ä¼°ã€è¯†åˆ«ä¸æå‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de2aca27e7e34292973aac50162eb838~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=PvqZoJmwQ2BJd3S8pJ4Wwku9238%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ä¸€é˜¶æ®µï¼šAssess è¯„ä¼°</strong></p>
<p>é€è¿‡æ ‡å‡†æµç¨‹å»ºæ¨¡è¯­è¨€ BPMNï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¸…æ¥šæŒæ¡æµç¨‹æ‰§è¡Œçš„æ­¥éª¤ä¸è´£ä»»å•ä½ã€‚è¿™ä¸ªé˜¶æ®µçš„ç›®çš„æ˜¯è¾¨è¯†ç›®å‰æµç¨‹çš„ç“¶é¢ˆä¸è€—æ—¶æƒ…å½¢ï¼Œè¿›è€Œé‡åŒ–æ•´ä½“çš„å¤‡æ¡ˆæ—¶é—´æˆ–å·¥ä½œè´Ÿè½½ã€‚è¿™ä¸ªé˜¶æ®µç”±æµç¨‹åˆ†æå¸ˆä¸ä¸šåŠ¡éƒ¨é—¨ä»£è¡¨ç‰µå¤´ï¼Œäº§å‡º BPMN æµç¨‹å›¾ä¸é—®é¢˜è¯Šæ–­æŠ¥å‘Šã€‚</p>
<p><strong>ç¬¬äºŒé˜¶æ®µï¼šClarify è¯†åˆ«ä¸æ´å¯Ÿå»ºè®®</strong></p>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šç»“åˆç»Ÿè®¡åˆ†æå’Œå®åŠ¡ç»éªŒæ¥å˜æ¸…æµç¨‹é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œå¹¶åˆ¤æ–­å…¶ä¸€è‡´æ€§ä¸å½±å“ç¨‹åº¦ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼šè‹¥æŸé¡¹ä½œä¸šå¹³å‡å¤„ç†æ—¶æ•ˆä¸ä½³ï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥æ‰¾å‡ºæ˜¯å¦å› ä¸ºç¼ºä¹èµ„è®¯ã€ç­‰å¾…å…¶ä»–å•ä½å¤„ç†ï¼Œæˆ–æ˜¯äººå·¥å¹²é¢„è¿‡å¤šå¯¼è‡´å»¶è¿Ÿã€‚ä¾‹å¦‚ Pending Code è®¾å®šæµç¨‹ä¸­éœ€ç­‰å¾…ä¸»ç®¡ç¡®è®¤ï¼Œè¿™å°±æ˜¯å…¸å‹çš„ç“¶é¢ˆã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µåº”åŠ å…¥æ•°ä½å›¢é˜Ÿä¸ Beyond Lab å…±åŒæ·±æŒ–é—®é¢˜æˆå› ã€æ˜ç¡®æ”¹å–„æ–¹å‘ï¼Œé‡ç‚¹åœ¨äºæ‰¾å‡ºå¯è¡Œçš„å»ºè®®æ–¹å‘ä¸æ•°æ®ä½è¯ï¼Œä¸ºåç»­æ”¹å–„åšå‡†å¤‡ã€‚</p>
<p><strong>ç¬¬ä¸‰é˜¶æ®µï¼šExpedite æå‡ä¸æœ€ç»ˆæ–¹æ¡ˆ</strong></p>
<p>å½“æˆ‘ä»¬æŒæ¡é—®é¢˜æ ¹å› åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æå‡ºæ”¹å–„å¯¹ç­–ï¼Œé€è¿‡ IPA ç­‰æŠ€æœ¯æ‰‹æ®µï¼Œä¼˜åŒ–æµç¨‹è¾¾åˆ°ææ•ˆä¸è‡ªåŠ¨åŒ–çš„ç›®çš„ã€‚å¸¸è§çš„å·¥å…·åŒ…å« AI + RPAã€è‡ªåŠ¨åŒ–è¾“å…¥ã€è¡¨å•ç²¾ç®€ã€èµ„æ–™ç»“æ„é‡æ•´ç­‰ã€‚ è¿™ä¸ªé˜¶æ®µç”±æµç¨‹åˆ†æå¸ˆä¸æŠ€æœ¯éƒ¨é—¨åä½œï¼Œè½åœ°æ”¹å–„æ–¹æ¡ˆå¹¶æ¨åŠ¨è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚</p>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬æœŸæœ›é€è¿‡è¿™æ ·çš„æµç¨‹æ”¹å–„ï¼Œå¯ä»¥æå‡å­é˜¶æ®µçš„å¤„ç†æ•ˆç‡ï¼Œä¾‹å¦‚ C_01 æ—¶æ‰¾é˜¶æ®µè€—æ—¶å‡å°‘ Y%ï¼Œæˆ–æ˜¯æ•´ä½“æµç¨‹çš„æå‡ï¼Œä¾‹å¦‚ C_04 é˜¶æ®µä½œä¸šæ—¶é—´å‡å°‘ Z%ã€‚è¿™äº›æˆæœå¯ä»¥é‡åŒ–å‘ˆç°ï¼Œæœ‰æ•ˆæ”¯æŒä¸šåŠ¡æµç¨‹æŒç»­ä¼˜åŒ–ã€‚</p>
<p>è¿™å¥—ä»¥ BPMN ä¸ºæ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸ä»…æ˜¯æµç¨‹å»ºæ¨¡å·¥å…·ï¼Œæ›´èƒ½ä¸€æ­¥æ­¥ååŠ©ä¸šåŠ¡å•ä½ä»â€œçœ‹è§é—®é¢˜â€èµ°å‘â€œæå‡ºè§£æ–¹â€ï¼Œæ‰å®æ¨è¿›æ•°å­—åŒ–è½¬å‹ä¸æµç¨‹ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-4"><strong>ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æ–½çš„ç†”ç‚‰ï¼Œä¼ä¸šè½åœ°AIæµç¨‹ä¼˜åŒ–çš„ç—›ç‚¹ä¸ç ´å±€ä¹‹é“</strong></h2>
<p>å°½ç®¡ AI æµç¨‹ä¼˜åŒ–çš„å‰æ™¯å¹¿é˜”ï¼Œä½†é€šå¾€æˆåŠŸçš„é“è·¯ä¸Šå¸ƒæ»¡äº†è†æ£˜ã€‚æ³¢å£«é¡¿å’¨è¯¢é›†å›¢çš„ç ”ç©¶æŒ‡å‡ºï¼Œçº¦ 70% çš„ AI é¡¹ç›®æŒ‘æˆ˜æºäºâ€œäººä¸æµç¨‹â€é—®é¢˜ï¼Œè€ŒéæŠ€æœ¯æœ¬èº« â½â¹â¾ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œä¼ä¸šåœ¨è½åœ° AI æ—¶ï¼Œå¾€å¾€ä¼šé™·å…¥ä¸‰å¤§æ ¸å¿ƒç—›ç‚¹ï¼Œè€Œç ´è§£è¿™äº›ç—›ç‚¹ï¼Œéœ€è¦ç³»ç»Ÿæ€§çš„â€œç»„åˆæ‹³â€ã€‚</p>
<p><strong>ç—›ç‚¹ä¸€ï¼šç»„ç»‡ä¸æ–‡åŒ–çš„â€œæƒ¯æ€§ä¹‹å¢™â€</strong></p>
<p>æŠ€æœ¯å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼Œä½†äººçš„è®¤çŸ¥ä¸ç»„ç»‡çš„æ–‡åŒ–å´æ ¹æ¤æ·±åšã€‚è¿™æ˜¯ä¼ä¸šåœ¨AIè½¬å‹ä¸­é¢ä¸´çš„æœ€å¤§ã€ä¹Ÿæœ€éšè”½çš„é˜»åŠ›ã€‚</p>
<p>Gartner çš„è°ƒæŸ¥æ˜¾ç¤ºï¼Œ45% çš„ CEO è¡¨ç¤ºå…¶å¤§éƒ¨åˆ†å‘˜å·¥å¯¹ AI æŒæŠµè§¦æ€åº¦ï¼Œç”šè‡³å…¬å¼€æ•Œè§† â½Â¹â°â¾ã€‚</p>
<p>è¿™ç§ææƒ§æºäºå¯¹â€œè¢«æ›¿ä»£â€çš„æ‹…å¿§ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå³ä¾¿æŠ€æœ¯æ–¹æ¡ˆå®Œç¾ï¼Œå¦‚æœä¸€çº¿å‘˜å·¥ä¸é…åˆæä¾›æ•°æ®æˆ–åœ¨æµç¨‹ä¸­è®¾å¡ï¼Œé¡¹ç›®ä¹Ÿå°†ä¸¾æ­¥ç»´è‰°ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>é¡¶å±‚è®¾è®¡å®šè°ƒâ€œäººæœºååŒâ€ï¼šç®¡ç†å±‚å¿…é¡»æ˜ç¡® AI æ˜¯èµ‹èƒ½å·¥å…·è€Œéäººç±»çš„æ›¿ä»£è€…ï¼Œæˆ˜ç•¥ç›®æ ‡åº”èšç„¦äºåˆ›é€ åŠ›æå‡ï¼Œè€Œéå•çº¯çš„äººåŠ›å‰Šå‡ã€‚</li>
<li>å»ºç«‹â€œç¿»è¯‘å®˜â€ä¸â€œå¸ƒé“è€…â€å›¢é˜Ÿï¼šåœ¨æŠ€æœ¯å›¢é˜Ÿä¸ä¸šåŠ¡å›¢é˜Ÿä¹‹é—´ï¼Œéœ€è¦æ—¢æ‡‚æŠ€æœ¯åˆæ‡‚ä¸šåŠ¡çš„â€œç¿»è¯‘å®˜â€ï¼Œå°†ä¸šåŠ¡ç—›ç‚¹è½¬åŒ–ä¸º AI å¯ä»¥è§£å†³çš„é—®é¢˜ã€‚åŒæ—¶ï¼Œéœ€è¦åœ¨ç»„ç»‡å†…éƒ¨åŸ¹å…»â€œå¸ƒé“è€…â€ï¼Œé€šè¿‡åˆ†äº«æˆåŠŸæ¡ˆä¾‹ã€ç»„ç»‡åŸ¹è®­ï¼Œå°† AI çš„ä»·å€¼æ¸…æ™°åœ°ä¼ é€’ç»™æ¯ä¸€ä½å‘˜å·¥ã€‚</li>
<li>ä»â€œè¾¹ç¼˜â€åˆ°â€œæ ¸å¿ƒâ€çš„æ¸è¿›å¼å˜é©ï¼šä¼˜å…ˆé€‰æ‹©éæ ¸å¿ƒä½†ç—›ç‚¹æ˜ç¡®çš„æµç¨‹ï¼ˆå¦‚è‡ªåŠ¨ç”Ÿæˆä¼šè®®çºªè¦ï¼‰å–å¾—â€œå°å‹èƒœåˆ©â€ï¼ˆQuick Winsï¼‰ï¼Œä»¥æ­¤å»ºç«‹ç»„ç»‡ä¿¡ä»»ã€‚</li>
</ul>
<p><strong>ç—›ç‚¹äºŒï¼šæŠ€æœ¯ä¸ä¸šåŠ¡çš„â€œä»·å€¼é¸¿æ²Ÿâ€</strong></p>
<p>è®¸å¤šä¼ä¸šå®¹æ˜“é™·å…¥â€œä¸ºäº† AI è€Œ AIâ€çš„è¯¯åŒºï¼Œæˆ–æ˜¯é¢ä¸´ä¸¥é‡çš„æ•°æ®å­¤å²›ã€‚æ¸…ç†æ•°æ®çš„æˆæœ¬å¾€å¾€è¿œè¶…æ¨¡å‹å¼€å‘æˆæœ¬ï¼Œå°¤å…¶åœ¨é‡‘èé¢†åŸŸï¼Œæ•°æ®å®‰å…¨åˆè§„æ›´æ˜¯æ‚¬åœ¨å¤´é¡¶çš„â€œè¾¾æ‘©å…‹åˆ©æ–¯ä¹‹å‰‘â€ â½âµâ¾ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>ä¸šåŠ¡é—®é¢˜é©±åŠ¨ï¼Œè€ŒéæŠ€æœ¯é©±åŠ¨ï¼šAI é¡¹ç›®çš„èµ·ç‚¹ï¼Œå¿…é¡»æ˜¯æ˜ç¡®çš„ã€å¯é‡åŒ–çš„ä¸šåŠ¡é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œç›®æ ‡æ˜¯â€œå°†ä¿¡è´·å®¡æ‰¹æ—¶é—´ç¼©çŸ­ 50%â€ï¼Œè€Œä¸æ˜¯â€œåº”ç”¨ä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹â€ã€‚ä»¥ä¸šåŠ¡ä»·å€¼ä¸ºå¯¼å‘ï¼Œå€’æ¨æ‰€éœ€çš„æŠ€æœ¯æ–¹æ¡ˆä¸æ•°æ®æ”¯æŒã€‚</li>
<li>å»ºç«‹ä¼ä¸šçº§æ•°æ®ä¸ AI ä¸­å°ï¼šè¿™æ˜¯ç ´è§£æ•°æ®å­¤å²›ã€å®ç°èƒ½åŠ›å¤ç”¨çš„å…³é”®åŸºç¡€è®¾æ–½ã€‚æ•°æ®ä¸­å°è´Ÿè´£ç»Ÿä¸€æ•°æ®æ²»ç†ã€ä¿è¯æ•°æ®è´¨é‡ä¸å®‰å…¨ï¼›AI ä¸­å°åˆ™æä¾›æ ‡å‡†åŒ–çš„æ¨¡å‹å¼€å‘ã€è®­ç»ƒã€éƒ¨ç½²å·¥å…·ï¼Œå°† AI èƒ½åŠ›ä»¥ API æœåŠ¡çš„å½¢å¼èµ‹èƒ½ç»™å„ä¸ªä¸šåŠ¡éƒ¨é—¨ï¼Œé¿å…é‡å¤â€œé€ è½®å­â€ã€‚</li>
<li>æ„å»ºæ•æ·çš„â€œæµç¨‹-æŠ€æœ¯â€é—­ç¯ï¼šä¼ä¸šåº”å»ºç«‹ä¸€ä¸ªç”±ä¸šåŠ¡ä¸“å®¶ã€æ•°æ®ç§‘å­¦å®¶ã€IT å·¥ç¨‹å¸ˆç»„æˆçš„æ•æ·å›¢é˜Ÿï¼Œå½¢æˆâ€œä¸šåŠ¡åé¦ˆ-æ¨¡å‹è°ƒä¼˜-æµç¨‹æ”¹è¿›â€çš„å¿«é€Ÿè¿­ä»£é—­ç¯ï¼Œç¡®ä¿ AI åº”ç”¨å§‹ç»ˆç´§è´´ä¸šåŠ¡éœ€æ±‚ã€‚</li>
</ul>
<p><strong>ç—›ç‚¹ä¸‰ï¼šæµç¨‹é‡æ„çš„â€œæœ€åä¸€å…¬é‡Œâ€</strong></p>
<p>å³ä¾¿æ‹¥æœ‰äº†å…ˆè¿›çš„æŠ€æœ¯å’Œæ¸…æ™°çš„ä¸šåŠ¡ç›®æ ‡ï¼Œå¦‚æœä¸èƒ½å¯¹ç°æœ‰ä¸šåŠ¡æµç¨‹è¿›è¡Œå½»åº•çš„é‡æ„ï¼ŒAI çš„æ½œåŠ›ä¹Ÿæ— æ³•å®Œå…¨é‡Šæ”¾ã€‚è¿™â€œæœ€åä¸€å…¬é‡Œâ€çš„æ”¹é€ ï¼Œå¾€å¾€æœ€ä¸ºè‰°éš¾ã€‚</p>
<p>ä»¥ä¿é™©ç†èµ”ä¸ºä¾‹ï¼Œå¼•å…¥ AI å›¾åƒå®šæŸæŠ€æœ¯åï¼Œå¦‚æœåç»­çš„æ ¸èµ”ã€æ”¯ä»˜ã€å®¢æˆ·æ²Ÿé€šç­‰ç¯èŠ‚ä¾ç„¶æ²¿ç”¨æ—§çš„æµç¨‹ï¼Œé‚£ä¹ˆæ•´ä½“æ•ˆç‡çš„æå‡å°†éå¸¸æœ‰é™ã€‚çœŸæ­£çš„å˜é©ï¼Œéœ€è¦å°† AI èƒ½åŠ›åµŒå…¥åˆ°ç«¯åˆ°ç«¯çš„å…¨æµç¨‹ä¸­ï¼Œå®ç°ä»æŠ¥æ¡ˆåˆ°æ”¯ä»˜çš„â€œç›´é€šå¼å¤„ç†â€ï¼ˆStraight-Through Processingï¼‰ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>ä»¥â€œé›¶åŸºâ€æ€ç»´é‡æ„æµç¨‹ï¼šæµç¨‹é‡æ„ä¸èƒ½æ»¡è¶³äºåœ¨ç°æœ‰åŸºç¡€ä¸Šä¿®ä¿®è¡¥è¡¥ï¼Œè€Œåº”é‡‡å–â€œé›¶åŸºæ€ç»´â€ï¼ˆZero-Based Thinkingï¼‰ï¼Œå‡è®¾ä»é›¶å¼€å§‹è®¾è®¡ä¸€ä¸ªæµç¨‹ï¼Œæ€è€ƒåœ¨ AI çš„åŠ æŒä¸‹ï¼Œå®ƒåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚è¿™æœ‰åŠ©äºæ‘†è„±å†å²åŒ…è¢±ï¼Œè¿›è¡Œé¢ è¦†å¼åˆ›æ–°ã€‚</li>
<li>æŠ•èµ„äºäººçš„â€œå†æŠ€èƒ½åŒ–â€ï¼šå¯¹å‘˜å·¥è¿›è¡Œâ€œå†æŠ€èƒ½åŒ–â€ï¼ˆReskillingï¼‰åŸ¹è®­ï¼Œä½¿å…¶æŒæ¡ä¸æ–°æµç¨‹ã€æ–°å·¥å…·ç›¸åŒ¹é…çš„èƒ½åŠ›ï¼Œå¦‚æ•°æ®åˆ†æã€äººæœºäº¤äº’ã€AI æ¨¡å‹ç›‘ç£ç­‰ã€‚è¿™ä¸ä»…æ˜¯åŒ–è§£æŠµè§¦çš„æ–¹å¼ï¼Œæ›´æ˜¯äººæ‰å‚¨å¤‡çš„è¿‡ç¨‹ã€‚</li>
<li>å»ºç«‹ç¨³å¥çš„ AI æ²»ç†æ¡†æ¶ï¼šå»ºç«‹è¦†ç›–æ¨¡å‹å…¨ç”Ÿå‘½å‘¨æœŸçš„ AI æ²»ç†æ¡†æ¶ï¼Œç¡®ä¿ AI ç³»ç»Ÿçš„å…¬å¹³æ€§ã€é€æ˜åº¦ã€å¯è§£é‡Šæ€§å’Œå¯å®¡è®¡æ€§ï¼Œè¿™æ—¢æ˜¯æ»¡è¶³ç›‘ç®¡çš„è¦æ±‚ï¼Œä¹Ÿæ˜¯å»ºç«‹å®¢æˆ·ä¸å¸‚åœºä¿¡ä»»çš„åŸºçŸ³ã€‚</li>
</ul>
<h2 data-id="heading-5"><strong>ç¬¬å››éƒ¨åˆ†ï¼šç»„ç»‡ä¸­æ¢ï¼Œæµç¨‹æ•°å­—åŒ–å“è¶Šä¸­å¿ƒ (P.T.C.O.E)</strong></h2>
<p>ä¼ä¸šé«˜å±‚åº”ç»„å»ºè·¨ç»„ç»‡ã€å¤šä¸“ä¸šçš„é•¿æœŸæ²»ç† + èƒ½åŠ›å¹³å°ï¼ˆæµç¨‹æ”¹é€  COEï¼‰ï¼Œé‡‡ç”¨ 7/3 æˆ– 8/2 çŸ©é˜µå¼ KPI ç®¡ç†ï¼Œç¡®ä¿æµç¨‹æ”¹é€ æŒç»­ã€å¯å¤åˆ¶ã€å¯é‡åŒ–â€”â€” å…¶æ ¸å¿ƒä»·å€¼æ˜¯å°†æµç¨‹ä¼˜åŒ–ä»ä¸€æ¬¡æ€§é¡¹ç›®å‡çº§ä¸ºå…¬å¸çº§èƒ½åŠ›ï¼Œé¿å…å•ä¸€éƒ¨é—¨ä¸»å¯¼å¯¼è‡´çš„è½åœ°ä½æ•ˆã€èµ„æºå†…è€—é—®é¢˜ï¼ˆå¦‚ LLM æµç¨‹ä¼˜åŒ–åå¤ POC å´å› äººæ‰ç¼ºå£ã€å®åŠ¡ç»éªŒä¸è¶³é™·å…¥å¾ªç¯ï¼‰ã€‚</p>
<p>ä½œä¸ºå…¬å¸æµç¨‹æ²»ç†ã€æ–¹æ³•è®ºã€æ•°å­—åŒ–ä¸ç»©æ•ˆç®¡ç†çš„ä¸­æ¢ï¼ŒBPMN æµç¨‹æ”¹é€  COE éœ€æ‰¿æ‹…æµç¨‹æ²»ç†ä¸æ ‡å‡†åˆ¶å®šã€æ–¹æ³•è®ºä¸ To-Be è®¾è®¡ã€ç»©æ•ˆ KPI ç®¡ç†ã€æ•°å­—åŒ–è‡ªåŠ¨åŒ–ååŒã€äººæ‰åŸ¹è‚²ä¸å˜é©ç®¡ç†ç­‰æ ¸å¿ƒèŒè´£ï¼Œè§’è‰²é…ç½®åº”æ¶µç›– COE æµç¨‹é•¿ã€æµç¨‹æ¶æ„å¸ˆã€æµç¨‹åˆ†æå¸ˆã€æ•°å­—åŒ–æµç¨‹é¡¾é—®åŠ BU Process Ownerï¼Œæ¨åŠ¨æµç¨‹æ”¹é€ ä»é¡¹ç›®åŒ–èµ°å‘åˆ¶åº¦åŒ–ã€æ•°æ®åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93eb1980877e4576b20e092ed9acb31c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=cRd51ZVTUYSE6fYp61UJI6W8dpg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0015c7ed27ca466e83510596a22a055b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=Zqr89cX3mD%2FGGm%2FaZt40LJ1L6K0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40320d030a1f4239a42f8f8c33a3c70e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=mihSyom58pdYetpZ3Et5rAcaKNY%3D" alt="" loading="lazy"/></p>
<p>å…¸å‹è½¦é™©æµç¨‹</p>
<p>æ€»ä¹‹ï¼ŒBPMN æµç¨‹æ”¹é€  COE å®šä½ä¸ºæµç¨‹æ²»ç†ä¸ EA çš„ä¸­æ¢æ¢çº½ï¼Œä¸Šæ‰¿æˆ˜ç•¥ä¸å†…æ§è¦æ±‚ï¼Œä¸­æ¥ BPMN æµç¨‹è®¾è®¡ï¼Œä¸‹è¿ ITã€æ•°æ®ä¸è‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒè·¯å¾„æ˜¯å…ˆå»ºç«‹å…¨å…¬å¸ç»Ÿä¸€çš„æµç¨‹æ²»ç†æ ‡å‡†ï¼Œå°†æµç¨‹ KPI æ·±åº¦æ¤å…¥å‘˜å·¥è®¤çŸ¥ï¼›å†é€šè¿‡ Process Mining ä¸ AI æŠ€æœ¯ä¼˜åŒ–ï¼Œå…¨æ–¹ä½è¦†ç›–æ•°æ® ASIS-TOBE åˆ†æã€äººå‘˜ç»„ç»‡è°ƒæ•´ã€å…±äº«åº”ç”¨ç³»ç»Ÿè¿­ä»£åŠæ¨¡å—ååŒä¼˜åŒ–ï¼Œæœ€ç»ˆè®©æµç¨‹æˆä¸ºé©±åŠ¨å…¬å¸å¢é•¿çš„æ ¸å¿ƒèµ„äº§ï¼Œè€Œéå±€é™äºå•æ¬¡é¡¹ç›®æˆæœã€‚</p>
<h2 data-id="heading-6"><strong>ç¬¬äº”éƒ¨åˆ†ï¼šæµç¨‹æŒ–æ˜è§„åˆ’è“å›¾ä¸åœºæ™¯åº”ç”¨</strong></h2>
<p>å¦‚æœè¯´å‰æ–‡çš„ BPMN ä¸‰éƒ¨æ›²ä¸ºæˆ‘ä»¬æä¾›äº†é‡å¡‘æµç¨‹çš„æ‰‹æœ¯åˆ€ï¼Œé‚£ä¹ˆæµç¨‹æŒ–æ˜åˆ™æ˜¯æŒ‡å¼•æ‰‹æœ¯è·¯å¾„çš„å¯¼èˆªé›·è¾¾ã€‚</p>
<p>ä¸šåŠ¡æµç¨‹ä¼˜åŒ–ç»éç›²ç›®çš„æŠ€æœ¯å †å ï¼Œè€Œæ˜¯éœ€è¦å°† AI çš„ç®—åŠ›ç²¾å‡†æ³¨å…¥åˆ°ä»·å€¼é“¾çš„æœ€æ·±å¤„ã€‚é€šè¿‡â€œæµç¨‹æŒ–æ˜å…­æ­¥æ³•â€ï¼Œæˆ‘ä»¬å°†æŠ½è±¡çš„æŠ€æœ¯æ–¹æ¡ˆå…·è±¡åŒ–ä¸ºå¯è½åœ°çš„åœºæ™¯ï¼Œç¡®ä¿ AI ä¸ä»…ä»…åœç•™åœ¨å®éªŒå®¤çš„ POC é˜¶æ®µï¼Œè€Œæ˜¯çœŸæ­£è½¬åŒ–ä¸ºæ”¯æ’‘ä¾›åº”é“¾ã€ç†èµ”åŠè¿è¥å„ç¯èŠ‚çš„å¢é•¿é©±åŠ¨åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f509568f8b2244f3aafe610c85aed566~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=j3p%2FT3NaCKFUppO0jwoOICmD%2FuI%3D" alt="" loading="lazy"/></p>
<p>ç”¨é‡‘èè¡Œä¸šä¸¾ä¾‹ï¼Œæµç¨‹æŒ–æ˜ä¸ä»…èƒ½åœ¨ç†èµ”æµç¨‹å‘æŒ¥ä½œç”¨ï¼Œè¿˜èƒ½åœ¨ä¿é™©å…¬å¸è¿è¥çš„å„ä¸ªç¯èŠ‚ä¸­å‘æŒ¥ä½œç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64682a7066e244b284ddc01e1746dd03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=yMkj5nOTVOWMmkcdRmeuLQxCG6U%3D" alt="" loading="lazy"/></p>
<p>é’ˆå¯¹é›†å›¢æµç¨‹ä¸æ•°å­—åŒ–ç®¡ç†éƒ¨ç‰µå¤´çš„ä¸šåŠ¡åœºæ™¯ï¼Œåº”è¯¥ç”±æµç¨‹æŒ–æ˜é¡¹ç›®ç»„ã€æ•°æ®æ¹–å›¢é˜ŸååŒæ”¯æ’‘ï¼Œä¾›åº”é“¾ç­‰å„æµç¨‹å½’å£ä¸šåŠ¡éƒ¨é—¨å‚ä¸ï¼Œä»¥æµç¨‹æŒ–æ˜å…­æ­¥æ³•ä¸ºæ ¸å¿ƒï¼Œç»Ÿç­¹å„æ–¹è½åœ°æµç¨‹ä¼˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c89cc8c82f0f453a92818c7c43f884f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=%2BgGo1fgIaquGkGCXpG7mr3w8vAY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>ç»“è¯­ï¼šæ‹¥æŠ±å˜é©ï¼Œè¡Œç¨³è‡´è¿œ</strong></h2>
<p>AI å·²æˆä¸ºä¼ä¸šåˆ›æ–°çš„æ ¸å¿ƒå¼•æ“ï¼Œä½†è¦å®ç°å¤§è§„æ¨¡æ·±åº¦ä»·å€¼è½¬åŒ–ï¼Œä¼ä¸šéœ€å…·å¤‡å‰ç»æˆ˜ç•¥è§†é‡ä¸ç³»ç»ŸåŒ–æ¨è¿›æœºåˆ¶ï¼Œè€Œéé™·å…¥å„éƒ¨é—¨æ— æ•ˆçš„ LLM POC å†…è€—ã€‚ä¼ä¸šåº”åšå®ˆâ€œä¸šåŠ¡å¼•é¢†ã€ç§‘æŠ€èµ‹èƒ½â€åŸåˆ™ï¼Œä¼˜å…ˆé€‰æ‹©å¢æ”¶åœºæ™¯çªç ´ä»¥è·å–é«˜å±‚ä¿¡ä»»ï¼›å°¤å…¶åˆšä¸Šä»»çš„ CTO/CDO/CIOï¼Œéœ€è¡¥è¶³ä¸šåŠ¡è®¤çŸ¥ï¼Œé¿å…å› è„±ç¦»ä¸šåŠ¡å¯¼è‡´ä¿¡ä»»å†…è€—ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ç§‘æŠ€æ‰“é€šèµ„äº§ç«¯ä¸èµ„é‡‘ç«¯ã€æå‡ç›ˆåˆ©ï¼Œè¿™æ˜¯ä¼ä¸šç”Ÿå­˜çš„æ ¹æœ¬ã€‚å‡¡æ˜¯ä¸èƒ½èµ‹èƒ½è¥æ”¶çš„ç³»ç»Ÿï¼Œéƒ½æ˜¯æ²¡è§„åˆ’å¥½çš„å¤±è´¥ï¼Œåªæœ‰è®© AI èµ‹èƒ½æ ¸å¿ƒè¥æ”¶åœºæ™¯ï¼Œä¼ä¸š AI æ•°å­—åŒ–è½¬å‹æ‰èƒ½å®ç°ä»çƒ§é’±åˆ°é€ è¡€çš„è´¨å˜ã€‚</p>
<p>AI é©±åŠ¨çš„ä¸šåŠ¡æµç¨‹ä¼˜åŒ–ç»éç®€å•æŠ€æœ¯å‡çº§ï¼Œè€Œæ˜¯ä¸€åœºæ·±åˆ»çš„ç³»ç»Ÿæ€§å˜é©ï¼Œè€ƒéªŒä¼ä¸šçš„æŠ€æœ¯å®åŠ›ã€æˆ˜ç•¥è¿œè§ã€ç»„ç»‡éŸ§æ€§ä¸æ–‡åŒ–é­„åŠ›ã€‚ä»æˆ‘ä¸ªäººè§‚å¯Ÿæ¥çœ‹ï¼ŒæˆåŠŸä¼ä¸šæ— ä¸€ä¸æ˜¯å°† AI è§†ä¸ºé‡å¡‘æ ¸å¿ƒç«äº‰åŠ›çš„æˆ˜ç•¥å¼•æ“ï¼Œå¹¶å‹‡äºå½»åº•è‡ªæˆ‘é©æ–°ã€‚å‰è·¯è™½æœ‰æŒ‘æˆ˜ï¼Œä½†æœºé‡æ›´å¤§ã€‚å¯¹ä¸­å›½ä¼ä¸šè€Œè¨€ï¼Œæ— éœ€è§‚æœ›æˆ–ç›²ç›®è·Ÿé£ï¼Œåº”ç»“åˆè‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹ä¸å‘å±•é˜¶æ®µï¼Œæ‰¾å‡†åˆ‡å…¥ç‚¹ï¼Œå°æ­¥å¿«è·‘ã€å¿«é€Ÿè¿­ä»£ï¼Œç¨³å¥å¼€å¯ AI æµç¨‹å†é€ ä¹‹æ—…ï¼šä»è§£å†³å…·ä½“ â€œç—›ç‚¹â€ å…¥æ‰‹ï¼Œé€æ­¥æ‰“é€šä¸šåŠ¡ â€œå µç‚¹â€ï¼Œæœ€ç»ˆå°† AI å†…åŒ–ä¸ºé©±åŠ¨æŒç»­åˆ›æ–°ä¸å¢é•¿çš„ â€œé€šç‚¹â€â€”â€” è¿™æ­£æ˜¯ AI æµªæ½®ä¸‹ä¼ä¸šåŸºä¸šé•¿é’çš„å¿…ç»ä¹‹è·¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·]]></title>    <link>https://juejin.cn/post/7603309951227084850</link>    <guid>https://juejin.cn/post/7603309951227084850</guid>    <pubDate>2026-02-06T07:53:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603309951227084850" data-draft-id="7603393977476890650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-06T07:53:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T07:53:20.000Z" title="Fri Feb 06 2026 07:53:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·</p>
<h2 data-id="heading-0"><strong>1ã€å¯¹æ¥é£ä¹¦èŠå¤©APP</strong></h2>
<h3 data-id="heading-1">openclawé…ç½®</h3>
<p>æ­¤å¤„ä»¥é£ä¹¦ä¸ºä¾‹ï¼Œè¾“å…¥æ’ä»¶ä¸‹è½½å®‰è£…å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclawÂ pluginsÂ installÂ @m1heng-clawd/feishuÂ Â 
<span class="hljs-built_in">cd</span>Â /root/.openclaw/extensions/feishu/Â 
npmÂ installÂ --verboseÂ Â <span class="hljs-comment">#æ­¤æ­¥éª¤å®‰è£…æ—¶é—´è¾ƒå¼ºé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4514ce834424f8e8d1261763a68010f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=tim0A43wIW8etJ3OUbeobTvJPIM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/747da7234bc54720888528bf2091cb83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=MNnU4T6x6rispqa%2FBOo6I8v91IA%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ç­‰ä¸‹è½½å®‰è£…å®Œæˆåã€‚åœ¨å‘½ä»¤è¡Œä¸‹è¿è¡Œopenclawå›¾å½¢é…ç½®ç•Œé¢ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">open</span>Â channelsÂ <span class="hljs-keyword">add</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3c11c79c7754fb1a00f79e40aa06f8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=4oyiQOd17mZFH1F%2BYUroTUtuO8s%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1e3044a666844848b496d5b1c6effd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=hs2bio0WUw4HuH0b%2BHikGtNMi%2FY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦åï¼Œæ ¹æ®æç¤ºè¾“å…¥é£ä¹¦App IDå’ŒApp Secretã€‚</p>
<p>åœ¨é£ä¹¦å¼€æ”¾å¹³å°åº”ç”¨å‡­è¯è·å–ï¼Œæ‰“å¼€é£ä¹¦ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fapp%2F" target="_blank" title="https://open.feishu.cn/app/" ref="nofollow noopener noreferrer">open.feishu.cn/app/</a>ï¼‰ï¼Œç‚¹å‡»å·¦è¾¹å‡­è¯åŸºç¡€ä¿¡æ¯ï¼Œåœ¨é¡µé¢ä¸­æ‰¾åˆ° â€œApp IDâ€ å’Œ â€œApp Secretâ€ ä¸¤ä¸ªæ•°æ®ï¼Œåˆ†åˆ«ç‚¹å‡»å³ä¾§ â€œå¤åˆ¶â€ æŒ‰é’®ï¼Œå°†å…¶å¤åˆ¶åˆ°openclawé…ç½®ç•Œé¢ã€‚é£ä¹¦é…ç½®å‚è€ƒä¸‹ä¸€ç« èŠ‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62d44babed384246ac0b55b478c926cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=hHPBKt8DuZs3HcsYGJEVfl9JK2s%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è¾“å…¥åº”ç”¨å‡­è¯åï¼Œå›è½¦å®Œæˆé…ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27a0f7cc64748b388a4d091fcef6f70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=KOemJopiS%2Bl%2F21ec05R1TVNd4Oo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>openclaw gateway restart ï¼Œé‡å¯ç½‘å…³æœåŠ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f574ab973086452fb93b0d089936ae84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=1B1vejYY3HkoDKE%2FtqwK4iMqx%2BM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è¿è¡Œopenclaw statusï¼ŒæŸ¥çœ‹çŠ¶æ€æ˜¯å¦æ­£å¸¸ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75a9ffdda41d46d2b4b39491d46c549f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=vhvT1dqzfRvy86KdmAo0P9do8Pg%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60ba2cb3573746d697a903ba0142b3fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=vPib4UqRE5aX%2FG0GwOtg%2FsylBjI%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-2"><strong>éªŒè¯é£ä¹¦æ¥å…¥</strong></h3>
<ol>
<li>æ‰“å¼€æ‰‹æœºæˆ–ç”µè„‘ç«¯é£ä¹¦ APPï¼Œç™»å½•ä¸é£ä¹¦å¼€å‘è€…å¹³å°ç›¸åŒçš„è´¦å·ï¼›</li>
<li>åœ¨é£ä¹¦é¦–é¡µï¼Œæ‰¾åˆ° â€œå·¥ä½œå°â€ å…¥å£ï¼Œç‚¹å‡»è¿›å…¥ï¼Œåœ¨å·¥ä½œå°åˆ—è¡¨ä¸­æ‰¾åˆ°å·²å‘å¸ƒçš„ openclaw åº”ç”¨ï¼ˆå¦‚ â€œopenclaw åŠ©æ‰‹â€ï¼‰ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç³»ç»Ÿå°†è‡ªåŠ¨å¯åŠ¨ç§èŠçª—å£ï¼Œå‘é€ä»»æ„æ¶ˆæ¯ï¼ˆå¦‚ â€œä½ å¥½â€â€œæŸ¥è¯¢ä»Šæ—¥æ—¥ç¨‹â€ï¼‰ï¼›</li>
<li>éªŒè¯ç»“æœï¼šå¦‚æœæ”¶åˆ° openclaw çš„å›å¤ï¼Œå³ä¸ºé£ä¹¦æ¥å…¥æˆåŠŸ</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c84335223aa546cf89242b582223d1d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=6VLMJECO2Icr%2B8um5jZU2bpGvZo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ä»¥ä¸Šé…ç½®å®Œæˆåï¼Œå³å¯ä¸Šæ‰‹ä½¿ç”¨ã€‚å¿«ä¸Šäº¬ä¸œäº‘å¼€å¯ä¸€é”®éƒ¨ç½²ï¼Œè®© openclaw æˆä¸ºä½ ä¸“å±çš„ 24 å°æ—¶æ•°å­—å‘˜å·¥ï¼</p>
<h3 data-id="heading-3"><strong>é£ä¹¦æœºå™¨äººé…ç½®</strong></h3>
<p><strong>åˆ›å»ºé£ä¹¦ä¼ä¸šè‡ªå»ºåº”ç”¨</strong></p>
<ol>
<li>è®¿é—®é£ä¹¦å¼€å‘è€…å¹³å°ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fapp%3Flang%3Dzh-CN%25EF%25BC%2589%25EF%25BC%259B" target="_blank" title="https://open.feishu.cn/app?lang=zh-CN%EF%BC%89%EF%BC%9B" ref="nofollow noopener noreferrer">open.feishu.cn/app?lang=zhâ€¦</a></li>
<li>ç™»å½•åï¼Œç‚¹å‡» â€œåˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨â€ï¼›</li>
<li>å¡«å†™åº”ç”¨åŸºç¡€ä¿¡æ¯ï¼šåº”ç”¨åç§°ï¼ˆå¦‚ â€œopenclaw åŠ©æ‰‹â€ï¼‰ï¼Œé€‰æ‹©åº”ç”¨å›¾æ ‡ï¼Œç‚¹å‡» â€œåˆ›å»ºâ€ æŒ‰é’®ï¼Œè¿›å…¥åº”ç”¨ç®¡ç†é¡µé¢ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/070c99d6ea104352a7028380962cc58f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=foNq%2Fa0%2BOuA2iZMAOiEH%2Bt4wzaE%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>æ·»åŠ æœºå™¨äººèƒ½åŠ›ï¼šåœ¨åº”ç”¨ç®¡ç†é¡µå·¦ä¾§å¯¼èˆªæ ï¼Œæ‰¾åˆ°å¹¶ç‚¹å‡» â€œæ·»åŠ åº”ç”¨èƒ½åŠ›â€ï¼Œåœ¨å¼¹å‡ºçš„åˆ—è¡¨ä¸­é€‰æ‹© â€œæœºå™¨äººâ€ï¼Œç‚¹å‡» â€œæ·»åŠ â€ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b36f728ee9664f90aa8c1c90595b20b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=k8LIYe3TPtuTlU9ocCytbbn5sW4%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>ç‚¹å‡»ä¸Šæ–¹çš„åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91e42d5d1948451a84b440caf17ac169~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=6nSYJhVU4LyTVKCbKbBfyXXaV1I%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é£ä¹¦åº”ç”¨æƒé™ä¸äº‹ä»¶é…ç½®</p>
<p>æ­¤æ­¥éª¤åˆ†ä¸ºã€Œäº‹ä»¶é…ç½®ã€ã€Œæƒé™é…ç½®ã€ã€Œåº”ç”¨å‘å¸ƒã€ä¸‰éƒ¨åˆ†ï¼Œå…¨ç¨‹åœ¨é£ä¹¦å¼€å‘è€…å¹³å°æ“ä½œï¼ŒæŒ‰é¡ºåºæ‰§è¡Œï¼š</p>
<h3 data-id="heading-4">ï¼ˆ1ï¼‰äº‹ä»¶é…ç½®</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œäº‹ä»¶ä¸å›è°ƒâ€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>äº‹ä»¶é…ç½®ï¼šåœ¨é¡µé¢ä¸­é€‰æ‹© â€œé•¿è¿æ¥â€ï¼Œç‚¹å‡» â€œä¿å­˜â€ï¼›</li>
</ol>
<p>âš ï¸å¦‚æœè¿™ä¸€æ­¥æç¤º <strong>â€œæœªå»ºç«‹é•¿è¿æ¥â€ï¼Œ</strong> è¯·æ£€æŸ¥è‡ªå·±çš„APP IDå’ŒAPP Secretæ˜¯å¦å·²æ­£ç¡®é…ç½®ã€‚</p>
<p>ï¼ˆæ“ä½œè§ä¸Šä¸€æ­¥ï¼šæ·»åŠ é£ä¹¦channelé…ç½®-é…ç½®APP IDä¸APP Secretï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67eef6305499496a9799fa949d8d755c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=BT9x4K7evtFWcw4%2BAnt5J2FPEGs%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>æ·»åŠ äº‹ä»¶ï¼šç‚¹å‡»é¡µé¢ä¸­çš„ â€œæ·»åŠ äº‹ä»¶â€ï¼Œåœ¨å¼¹å‡ºçš„äº‹ä»¶åˆ—è¡¨ä¸­ï¼Œé€‰æ‹© â€œæ¶ˆæ¯ä¸ç¾¤ç»„â€ åˆ†ç±»ï¼Œå‹¾é€‰ â€œæ¥æ”¶æ¶ˆæ¯â€ï¼Œç‚¹å‡» â€œç¡®å®šâ€ï¼Œå®Œæˆäº‹ä»¶è®¢é˜…ã€‚</li>
</ol>
<p><img src="" alt="" loading="lazy"/></p>
<ol>
<li>å›è°ƒé…ç½®ï¼šè®¢é˜…æ–¹å¼é€‰æ‹© â€œä½¿ç”¨é•¿è¿æ¥â€ï¼Œæ— éœ€å¡«å†™å…¶ä»–åœ°å€ï¼Œé…ç½®è‡ªåŠ¨ç”Ÿæ•ˆã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fe5ac63bfcd4d18a9c70a7aa87736b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=RqgvrOvYZIMXxteaQWPqSGembaI%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-5">ï¼ˆ2ï¼‰æƒé™é…ç½®</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œæƒé™ç®¡ç†â€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç‚¹å‡»é¡µé¢ä¸­çš„ â€œæ‰¹é‡å¯¼å…¥æƒé™â€ æŒ‰é’®ï¼Œå¼¹å‡ºæƒé™å¯¼å…¥çª—å£ï¼›</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69ae719e876b4da1a4547e504a25568d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=Wsb7VJyp9sEa8O3rm6UEj46g0YM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fd5fbc2def840f3930c6188c4827fcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=y7u%2Fe6n1nufGhXykpIo4zqWtwUY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>3.å¤åˆ¶ä»¥ä¸‹ JSON ä»£ç ï¼Œç²˜è´´åˆ°å¯¼å…¥çª—å£çš„è¾“å…¥æ¡†ä¸­ï¼Œç‚¹å‡» â€œå¯¼å…¥â€ æŒ‰é’®ï¼Œç­‰å¾…æƒé™å¯¼å…¥å®Œæˆï¼š</p>
<p>ä»£ç è¯­è¨€ï¼štxt</p>
<p>AIä»£ç è§£é‡Š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>Â Â 
Â <span class="hljs-attr">"scopes"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>Â Â Â Â Â <span class="hljs-attr">"tenant"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span>Â Â Â Â Â Â Â 
Â <span class="hljs-string">"contact:user.base:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat:read"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat:update"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message.group_at_msg:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message.p2p_msg:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message:send_as_bot"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:resource"</span>Â Â Â Â Â <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>Â Â Â Â Â 
Â Â Â Â <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>Â Â Â <span class="hljs-punctuation">}</span>Â <span class="hljs-punctuation">}</span>
</code></pre>
<p>4.å¯¼å…¥éªŒè¯ï¼šé¡µé¢æ˜¾ç¤º â€œå¯¼å…¥æˆåŠŸâ€ï¼Œä¸”æƒé™åˆ—è¡¨ä¸­å‡ºç°ä¸Šè¿°å¯¼å…¥çš„æƒé™ï¼Œå³ä¸ºé…ç½®å®Œæˆã€‚</p>
<h3 data-id="heading-6">ï¼ˆ3ï¼‰å‘å¸ƒåº”ç”¨</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒâ€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç‚¹å‡»å³ä¸Šè§’çš„æ–°å»ºç‰ˆæœ¬ï¼›</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6388d20db1a94e08ab81c921542873da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=svGMizJKfzpOaoNuP9Pbtm4k3%2BU%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¡«å†™ç‰ˆæœ¬å·ä¸æè¿°åï¼Œä¿å­˜å¹¶å‘å¸ƒï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c692fc723b847debe350c84487e4a88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=O2ijQ656quJDuK5vmKBDhcPZQss%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>2ã€æ›´æ¢æ¨¡å‹</strong></h2>
<p>openclaw onboard</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0127aa7b4a534e479c4b9af5af2048a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=zu2HrDMfEDcrud3n3Dyt80kteR8%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>æŒ‰é”®ç›˜ä¸Šå·¦å³æ–¹å‘é”®ï¼Œé€‰æ‹©åˆ°â€œYesâ€åï¼ŒæŒ‰å›è½¦é”®å¼€å§‹é…ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfef0a0591224877bb7bcb41f81bd10d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=O9kGV6w0LmGrkSNrtpivx4ZrIgg%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>Onboarding mode é€‰ QuickStartã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c79076090541f2be845832ee53fd30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=UvQjVbb3bNsS3Pv4lkYARuO1Abw%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é€‰æ‹©Qwenç­‰æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/657e79f4854d4c3d83b61c19747e41eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=4620lqgdmpx%2FbOpfR52qzQWXrrY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦ç¡®è®¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81016332a40a4c22aabe6793cd776e3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=VPaRUvpZlHi%2BmASAj4E7Agu9v8Q%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¤åˆ¶åœ°å€åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œåç™»å½•è´¦å·ç¡®è®¤é€šè¿‡ã€‚ï¼ˆéœ€è¦å…ˆæ³¨å†Œè´¦å·<a href="https://link.juejin.cn?target=https%3A%2F%2Fchat.qwen.ai%2F" target="_blank" title="https://chat.qwen.ai/" ref="nofollow noopener noreferrer">chat.qwen.ai/</a>ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c9243ef4d744f76b7c0aa87535226a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=MgMB8nofYS0L8gU07R9gFyZlrfQ%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61543afed7b04724805708489dd13b47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=JYQJ7BNN8Sr1jviwaIYXMo%2Fksts%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ce5ec2b96f24245b5250b52f1bf5c0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=ys8q3cgIvo8sfX6TPk4O%2FV%2Fj8uo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é€‰æ‹©é»˜è®¤æ¨¡å‹åï¼Œå›è½¦ç¡®è®¤ã€‚é€‰æ‹©é€‰æ‹©é‡å¯ç½‘å…³æœåŠ¡åå³ç”Ÿæ•ˆã€‚</p>
<p>æŠ€èƒ½åŒ…ï¼ˆSkillï¼‰é…ç½®</p>
<p>æ–°æ‰‹æš‚æ—¶æ— éœ€æ·»åŠ é¢å¤–æŠ€èƒ½åŒ…ï¼Œé€‰ä¸­ â€œNoâ€ è·³è¿‡ï¼ŒæŒ‰å›è½¦é”®ç¡®è®¤ï¼›</p>
<p>Hooks é…ç½®</p>
<p>é€‰ä¸­ â€œsession-memoryâ€ï¼ˆå¯ç”¨è®°å¿†åŠŸèƒ½ï¼Œæ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡å…³è”ï¼Œé¿å…æ¯æ¬¡èŠå¤©éƒ½éœ€è¦é‡å¤è¯´æ˜éœ€æ±‚ï¼‰ï¼Œå…¶ä»–ä¸¤é¡¹å¯æ ¹æ®éœ€æ±‚é€‰æ‹©ã€‚æŒ‰å›è½¦é”®ç¡®è®¤ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd10fb1420664b75862d28a0ba7e67ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=QrE4pg%2BpYhB%2F5N0MSsk6dOBAy7I%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-8">3ã€å¸¸ç”¨å‘½ä»¤æ±‡æ€»</h2>





















































<table><thead><tr><th>æŸ¥çœ‹ç‰ˆæœ¬</th><th>openclaw --version</th></tr></thead><tbody><tr><td>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</td><td>openclaw status</td></tr><tr><td>å¯åœBot</td><td>openclaw start/stop/restart</td></tr><tr><td>å¯åŠ¨openclawé…ç½®</td><td>openclaw onboard</td></tr><tr><td>å¯åŠ¨Openclawçš„TUI</td><td>openclaw tui</td></tr><tr><td>é€šè¿‡SSHè¿æ¥TUI</td><td>ssh root@å…¬ç½‘IP</td></tr><tr><td>é‡å¯ç½‘å…³</td><td>openclaw gateway restart</td></tr><tr><td>æŸ¥çœ‹å·²å®‰è£…æ’ä»¶</td><td>openclaw plugins list</td></tr><tr><td>å®‰è£…æ’ä»¶</td><td>openclaw plugins install æ’ä»¶å</td></tr><tr><td>æ›´æ–°æ’ä»¶</td><td>openclaw plugins update æ’ä»¶å</td></tr><tr><td>å¸è½½æ’ä»¶</td><td>openclaw plugins uninstall æ’ä»¶å</td></tr><tr><td>æŸ¥çœ‹å¸®åŠ©</td><td>openclaw --help</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†]]></title>    <link>https://juejin.cn/post/7603054272160120882</link>    <guid>https://juejin.cn/post/7603054272160120882</guid>    <pubDate>2026-02-06T01:08:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603054272160120882" data-draft-id="7603216479836209203" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-06T01:08:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:08:44.000Z" title="Fri Feb 06 2026 01:08:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0"><strong>å¼•è¨€</strong></h2>
<p>åœ¨ç°ä»£å‰åç«¯åˆ†ç¦»çš„ Web åº”ç”¨ä¸­ï¼Œ<strong>æƒé™ç®¡ç†ï¼ˆPermission Controlï¼‰</strong> å·²ä¸å†æ˜¯â€œåç«¯çš„ä¸“å±é—®é¢˜â€ã€‚<br/>
ä¸€ä¸ªæˆç†Ÿçš„ Vue é¡¹ç›®ï¼Œå¾€å¾€éœ€è¦å¯¹ <strong>èœå•ã€è·¯ç”±ã€æŒ‰é’®ã€æ¥å£è°ƒç”¨</strong> ç­‰å¤šä¸ªå±‚é¢è¿›è¡Œå‰ç«¯æƒé™ç®¡æ§ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å®Œå–„çš„æƒé™ä½“ç³»ï¼Œåº”ç”¨å°±å¯èƒ½å‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†é¡µé¢ï¼›</li>
<li>æŒ‰é’®çº§åˆ«çš„åŠŸèƒ½è¯¯æ“ä½œï¼›</li>
<li>å¤šè§’è‰²ç³»ç»Ÿï¼ˆå¦‚ç®¡ç†å‘˜ / å®¡æ ¸å‘˜ / æ™®é€šç”¨æˆ·ï¼‰é€»è¾‘æ··ä¹±ï¼›</li>
<li>ç”šè‡³å‰ç«¯è¢«ç¯¡æ”¹å¯¼è‡´å®‰å…¨æ¼æ´ã€‚</li>
</ul>
<p>æœ¬æ–‡å°†ç³»ç»Ÿè®²è§£ <strong>Vue é¡¹ç›®çš„æƒé™ç®¡ç†æœºåˆ¶</strong>ï¼Œæ¶µç›–ä»è®¾è®¡æ€è·¯ã€æŠ€æœ¯å®ç°åˆ°å·¥ç¨‹æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ æ„å»ºä¸€ä¸ª<strong>é«˜æ‰©å±•ã€é«˜å®‰å…¨æ€§çš„æƒé™æ§åˆ¶ä½“ç³»</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>æ­£æ–‡</strong></h2>
<h3 data-id="heading-2">ğŸ§© ä¸€ã€é—®é¢˜å®šä¹‰ä¸èƒŒæ™¯</h3>
<h4 data-id="heading-3">1. ä»€ä¹ˆæ˜¯å‰ç«¯æƒé™æ§åˆ¶ï¼Ÿ</h4>
<p><strong>å‰ç«¯æƒé™æ§åˆ¶</strong>æ˜¯æŒ‡åœ¨ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œæ ¹æ®å…¶è§’è‰²æˆ–æˆæƒä¿¡æ¯ï¼ŒåŠ¨æ€æ§åˆ¶ï¼š</p>
<ul>
<li>é¡µé¢è·¯ç”±è®¿é—®ï¼›</li>
<li>èœå•å¯¼èˆªå±•ç¤ºï¼›</li>
<li>æŒ‰é’®ä¸ç»„ä»¶æ¸²æŸ“ï¼›</li>
<li>æ¥å£è¯·æ±‚æ ¡éªŒã€‚</li>
</ul>
<p><strong>å…¸å‹åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>SaaSåå°ç®¡ç†ç³»ç»Ÿï¼ˆå¤šè§’è‰²æƒé™ç»“æ„ï¼‰ï¼›</li>
<li>ä¼ä¸šå†…éƒ¨ç³»ç»Ÿï¼ˆåˆ†å±‚å®¡æ‰¹æµï¼‰ï¼›</li>
<li>å¹³å°è¿è¥ç«¯ï¼ˆç§Ÿæˆ·éš”ç¦»æ•°æ®æ§åˆ¶ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-4">2. Vue ä¸­å¸¸è§æƒé™ç±»å‹</h4>






























<table><thead><tr><th align="left">æƒé™ç±»å‹</th><th align="left">æ§åˆ¶å¯¹è±¡</th><th align="left">æŠ€æœ¯å®ç°</th></tr></thead><tbody><tr><td align="left"><strong>è·¯ç”±æƒé™</strong></td><td align="left">é¡µé¢çº§è®¿é—®æ§åˆ¶</td><td align="left">åŠ¨æ€è·¯ç”± / è·¯ç”±å®ˆå«</td></tr><tr><td align="left"><strong>èœå•æƒé™</strong></td><td align="left">å¯¼èˆªå±•ç¤ºé¡¹</td><td align="left">è¿‡æ»¤èœå•æ ‘</td></tr><tr><td align="left"><strong>æŒ‰é’®æƒé™</strong></td><td align="left">ç»„ä»¶ç»†ç²’åº¦æ§åˆ¶</td><td align="left">è‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆv-permissionï¼‰</td></tr><tr><td align="left"><strong>æ•°æ®æƒé™</strong></td><td align="left">æ¥å£æˆ–å­—æ®µè®¿é—®</td><td align="left">è¯·æ±‚æ‹¦æˆªæˆ–åç«¯è¿‡æ»¤</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">âš™ï¸ äºŒã€å®ç°æ–¹æ¡ˆä¸æŠ€æœ¯ç»†èŠ‚</h3>
<h4 data-id="heading-6">1. åç«¯è¿”å›æƒé™ç»“æ„</h4>
<p>åç«¯åœ¨ç”¨æˆ·ç™»å½•åè¿”å›ä¸€ä»½æƒé™æ•°æ®ï¼Œå¸¸è§æ ¼å¼ä¸ºï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"roles"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"admin"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"user:view"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"user:edit"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"order:list"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-7">2. è·¯ç”±åŠ¨æ€åŠ è½½å®ç°</h4>
<p>Vue Router æä¾›äº†åŠ¨æ€æ³¨å†Œè·¯ç”±çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç™»å½•æ—¶åŠ¨æ€æ·»åŠ ç”¨æˆ·å¯è®¿é—®çš„è·¯ç”±ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// permission.js</span>

<span class="hljs-keyword">const</span> allRoutes = [
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'dashboard:view'</span> } },
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/user'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'User'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:view'</span> } },
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/edit'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'UserEdit'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:edit'</span> } }
]

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">filterRoutesByPermission</span>(<span class="hljs-params">userPerms</span>) {
  <span class="hljs-keyword">return</span> allRoutes.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">route</span> =&gt;</span> userPerms.<span class="hljs-title function_">includes</span>(route.<span class="hljs-property">meta</span>.<span class="hljs-property">permission</span>))
}
</code></pre>
<p>åœ¨ç™»å½•æˆåŠŸåï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'@/router'</span>
<span class="hljs-keyword">import</span> { filterRoutesByPermission } <span class="hljs-keyword">from</span> <span class="hljs-string">'./permission'</span>

<span class="hljs-keyword">const</span> userPerms = [<span class="hljs-string">'dashboard:view'</span>, <span class="hljs-string">'user:view'</span>]
<span class="hljs-keyword">const</span> accessRoutes = <span class="hljs-title function_">filterRoutesByPermission</span>(userPerms)
accessRoutes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">route</span> =&gt;</span> router.<span class="hljs-title function_">addRoute</span>(route))
</code></pre>
<p>ğŸ’¡ <strong>æ•ˆæœï¼š</strong><br/>
åªæœ‰è¢«æˆæƒçš„ç”¨æˆ·ï¼Œæ‰èƒ½è®¿é—®å®šä¹‰åœ¨ <code>router</code> ä¸­å¯¹åº” <code>meta.permission</code> çš„é¡µé¢ã€‚</p>
<hr/>
<h4 data-id="heading-8">3. èœå•åŠ¨æ€æ¸²æŸ“</h4>
<p>åŸºäºç›¸åŒçš„æƒé™ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å°†èœå•é…ç½®ä¸è·¯ç”±ä¿¡æ¯ç»“åˆï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// menuConfig.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> menuMap = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'dashboard:view'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'ç”¨æˆ·åˆ—è¡¨'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/user'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:view'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'ç¼–è¾‘ç”¨æˆ·'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/edit'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:edit'</span> }
]

<span class="hljs-comment">// è¿‡æ»¤èœå•</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getVisibleMenus</span>(<span class="hljs-params">perms</span>) {
  <span class="hljs-keyword">return</span> menuMap.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">menu</span> =&gt;</span> perms.<span class="hljs-title function_">includes</span>(menu.<span class="hljs-property">permission</span>))
}
</code></pre>
<p>åœ¨æ¨¡æ¿ä¸­åŠ¨æ€æ¸²æŸ“èœå•ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in visibleMenus"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.path"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"item.path"</span>&gt;</span>{{ item.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { getVisibleMenus } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/config/menuConfig'</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store/user'</span>

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useUserStore</span>()
<span class="hljs-keyword">const</span> visibleMenus = <span class="hljs-title function_">getVisibleMenus</span>(user.<span class="hljs-property">permissions</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<hr/>
<h4 data-id="heading-9">4. <strong>æŒ‰é’®çº§æƒé™æ§åˆ¶ï¼ˆè‡ªå®šä¹‰æŒ‡ä»¤ï¼‰</strong></h4>
<p>åœ¨ Vue 3 ä¸­ï¼Œæˆ‘ä»¬å¯é€šè¿‡è‡ªå®šä¹‰æŒ‡ä»¤å®ç°æŒ‰é’®çº§æƒé™æ§åˆ¶ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// directives/permission.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el, binding</span>) {
    <span class="hljs-keyword">const</span> { value } = binding
    <span class="hljs-keyword">const</span> userPerms = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'permissions'</span>) || <span class="hljs-string">'[]'</span>)
    
    <span class="hljs-keyword">if</span> (value &amp;&amp; !userPerms.<span class="hljs-title function_">includes</span>(value)) {
      el.<span class="hljs-property">parentNode</span> &amp;&amp; el.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(el)
    }
  }
}
</code></pre>
<p>æ³¨å†ŒæŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> permission <span class="hljs-keyword">from</span> <span class="hljs-string">'./directives/permission'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">directive</span>(<span class="hljs-string">'permission'</span>, permission)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>æ¨¡æ¿ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;button <span class="hljs-attr">v-permission</span>=<span class="hljs-string">"'user:edit'"</span>&gt;ç¼–è¾‘ç”¨æˆ·&lt;/button&gt;
</code></pre>
<p>ğŸ‘‰ å½“ç”¨æˆ·æ²¡æœ‰ <code>user:edit</code> æƒé™æ—¶ï¼Œè¯¥æŒ‰é’®å°†ä¸ä¼šè¢«æ¸²æŸ“ã€‚</p>
<hr/>
<h4 data-id="heading-10">5. <strong>æ¥å£ä¸æ•°æ®æƒé™ç­–ç•¥</strong></h4>
<p>åœ¨è¯·æ±‚å±‚é¢æ§åˆ¶è®¿é—®æ•°æ®å®‰å…¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// axios æ‹¦æˆªå™¨</span>
axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">if</span> (token) config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
  <span class="hljs-keyword">return</span> config
})
</code></pre>
<p>åç«¯éªŒè¯æ—¶å†ç»“åˆè§’è‰²æˆ–ç§Ÿæˆ·IDè¿‡æ»¤æŸ¥è¯¢ç»“æœï¼Œå½¢æˆâ€œå‰åç«¯ååŒä¿æŠ¤â€ã€‚</p>
<hr/>
<h3 data-id="heading-11">ğŸ” ä¸‰ã€ä¼˜ç¼ºç‚¹åˆ†æä¸æœ€ä½³å®è·µå»ºè®®</h3>

























<table><thead><tr><th align="left">é¡¹</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>å‰ç«¯æ§åˆ¶</strong></td><td align="left">å“åº”å¿«ã€ä½“éªŒå¥½ã€å¯è§å³æ‰€å¾—</td><td align="left">å®‰å…¨ä¾èµ–åç«¯é…åˆï¼Œæ˜“è¢«ç¯¡æ”¹</td></tr><tr><td align="left"><strong>åç«¯æ§åˆ¶</strong></td><td align="left">æ•°æ®å®‰å…¨æ€§é«˜</td><td align="left">å¢åŠ æ¥å£è®¾è®¡å¤æ‚åº¦</td></tr><tr><td align="left"><strong>å‰åç«¯ååŒ</strong></td><td align="left">å®‰å…¨ä¸ä½“éªŒå…¼é¡¾</td><td align="left">ç³»ç»Ÿæ¶æ„å¤æ‚åº¦æå‡</td></tr></tbody></table>
<h4 data-id="heading-12">ğŸ’¡ å®æˆ˜å»ºè®®ï¼š</h4>
<ol>
<li><strong>æƒé™ç²’åº¦ç”±ç²—åˆ°ç»†ï¼š</strong> å…ˆå®ç°è·¯ç”±çº§ï¼Œå†æ‰©å±•åˆ°æŒ‰é’®çº§ä¸æ•°æ®çº§ï¼›</li>
<li><strong>å‰åç«¯ç»Ÿä¸€æƒé™æ ‡è¯†ç ï¼š</strong> å¦‚ <code>user:view</code>ã€<code>order:delete</code>ï¼›</li>
<li><strong>å°è£…ç»Ÿä¸€æƒé™æ ¡éªŒå‡½æ•°ï¼š</strong> <code>hasPermission(perms, code)</code>ï¼Œä¾¿äºå¤ç”¨ï¼›</li>
<li><strong>åœ¨ CI/CD ä¸­åŠ å…¥æƒé™æ£€æŸ¥è„šæœ¬</strong>ï¼Œé˜²æ­¢æ–°å¢è·¯ç”±é—æ¼æƒé™é…ç½®ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13"><strong>ç»“è®º</strong></h2>
<p>åœ¨ Vue é¡¹ç›®ä¸­æ„å»ºå®Œå–„çš„æƒé™ä½“ç³»ï¼Œæ˜¯å‰ç«¯æ¶æ„æˆç†Ÿåº¦çš„é‡è¦æ ‡å¿—ã€‚<br/>
å®ƒä¸ä»…ä»…æ˜¯â€œé™åˆ¶è®¿é—®â€ï¼Œæ›´æ˜¯â€œæ¸…æ™°å®šä¹‰è§’è‰²èŒè´£â€çš„æ‰‹æ®µã€‚</p>
<p>é€šè¿‡ <strong>åŠ¨æ€è·¯ç”±åŠ è½½ + æŒ‡ä»¤æƒé™éªŒè¯ + åç«¯ååŒç®¡æ§</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>æå‡ç³»ç»Ÿçš„å®‰å…¨æ€§ä¸æ‰©å±•æ€§ï¼›</li>
<li>é™ä½ç»´æŠ¤æˆæœ¬ï¼›</li>
<li>ä¼˜åŒ–ç”¨æˆ·ä½“éªŒä¸æ“ä½œæ„ŸçŸ¥ã€‚</li>
</ul>
<p>æœªæ¥ï¼Œéšç€ Vue ä¸æœåŠ¡ç«¯ååŒæ¡†æ¶ï¼ˆå¦‚ NestJSã€GraphQLï¼‰çš„å‘å±•ï¼Œæƒé™ç®¡ç†å°†æœç€**â€œç­–ç•¥å¼•æ“åŒ–ï¼ˆPolicy Engineï¼‰â€ä¸â€œé…ç½®å³è§„åˆ™åŒ–ï¼ˆConfig-as-Policyï¼‰â€**æ–¹å‘æ¼”è¿›ã€‚</p>
<hr/>
<h2 data-id="heading-14"><strong>å‚è€ƒèµ„æ–™ä¸æ‹“å±•é˜…è¯»</strong></h2>
<ol>
<li>Vue å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide" target="_blank" title="https://vuejs.org/guide" ref="nofollow noopener noreferrer">vuejs.org/guide</a></li>
<li>Vue Router åŠ¨æ€è·¯ç”±æŒ‡å—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frouter.vuejs.org%2F" target="_blank" title="https://router.vuejs.org/" ref="nofollow noopener noreferrer">router.vuejs.org/</a></li>
<li>JSON Web Token (JWT) æƒé™æ¨¡å‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjwt.io%2F" target="_blank" title="https://jwt.io/" ref="nofollow noopener noreferrer">jwt.io/</a></li>
<li>RBAC æƒé™ç®¡ç†ç®—æ³•è§£æ â€“ Martin Fowler</li>
<li>Ant Design Pro + Vue æƒé™å®ç°èŒƒä¾‹</li>
</ol>
<hr/>
<p>ğŸ’¬ <strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong></p>
<blockquote>
<p>æƒé™ç³»ç»Ÿæ˜¯ Vue é¡¹ç›®çš„â€œå®‰å…¨å¤§è„‘â€ã€‚<br/>
æ²¡æœ‰æƒé™æ§åˆ¶çš„å‰ç«¯ï¼Œå°±åƒä¸€ä¸ªæ²¡æœ‰é—¨é”çš„æˆ¿å­ â€”â€” æ¼‚äº®ï¼Œä½†ä¸å®‰å…¨ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7603294029530890291</link>    <guid>https://juejin.cn/post/7603294029530890291</guid>    <pubDate>2026-02-06T02:43:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603294029530890291" data-draft-id="7603283691456626698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T02:43:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘è€…é˜¿è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/4073055974333608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4073055974333608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘è€…é˜¿è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:43:55.000Z" title="Fri Feb 06 2026 02:43:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ</h2>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸è®¾è®¡æ€è·¯</h3>
<p>å¹´ä¼šæŠ½å¥–æ˜¯æ¯ä¸ªä¼ä¸šå¹´æœ«çš„é‡è¦æ´»åŠ¨ï¼Œä½†ä¼ ç»Ÿçš„æŠ½å¥–æ–¹å¼å¾€å¾€å­˜åœ¨å…¬å¹³æ€§ä¸è¶³ã€äº’åŠ¨æ€§å·®çš„é—®é¢˜ã€‚æœ¬æ–‡å°†åŸºäºSpringBootæ¡†æ¶ï¼Œè®¾è®¡å¹¶å®ç°ä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿï¼Œç¡®ä¿æŠ½å¥–è¿‡ç¨‹çš„é€æ˜æ€§å’Œéšæœºæ€§ï¼ŒåŒæ—¶å¢åŠ å¤šç§äº’åŠ¨åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-2">ç³»ç»Ÿæ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š</h4>
<ol>
<li><strong>å…¬æ­£æ€§</strong>ï¼šä½¿ç”¨åŠ å¯†éšæœºç®—æ³•ï¼Œç¡®ä¿ç»“æœä¸å¯é¢„æµ‹</li>
<li><strong>è¶£å‘³æ€§</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼ŒåŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨</li>
<li><strong>å¯é æ€§</strong>ï¼šé«˜å¹¶å‘æ”¯æŒï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œæ“ä½œæ—¥å¿—</li>
<li><strong>æ˜“ç”¨æ€§</strong>ï¼šç®€æ´çš„Webç•Œé¢ï¼Œæ˜“äºéƒ¨ç½²å’Œç®¡ç†</li>
</ol>
<h3 data-id="heading-3">äºŒã€æŠ€æœ¯æ ˆé€‰å‹</h3>
<ul>
<li><strong>åç«¯æ¡†æ¶</strong>ï¼šSpringBoot 2.7.x</li>
<li><strong>å‰ç«¯æŠ€æœ¯</strong>ï¼šThymeleaf + Bootstrap 5 + jQuery</li>
<li><strong>æ•°æ®åº“</strong>ï¼šMySQL 8.0 + Redis 7.0</li>
<li><strong>å®æ—¶é€šä¿¡</strong>ï¼šWebSocket</li>
<li><strong>å®‰å…¨æ¡†æ¶</strong>ï¼šSpring Security</li>
<li><strong>æ„å»ºå·¥å…·</strong>ï¼šMaven 3.8+</li>
</ul>
<h3 data-id="heading-4">ä¸‰ã€é¡¹ç›®ç»“æ„è®¾è®¡</h3>
<pre><code class="hljs language-bash" lang="bash">lottery-system/
â”œâ”€â”€ src/main/java/com/lottery/
â”‚   â”œâ”€â”€ config/          <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚   â”œâ”€â”€ controller/      <span class="hljs-comment"># æ§åˆ¶å™¨å±‚</span>
â”‚   â”œâ”€â”€ service/         <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘å±‚</span>
â”‚   â”œâ”€â”€ repository/      <span class="hljs-comment"># æ•°æ®è®¿é—®å±‚</span>
â”‚   â”œâ”€â”€ model/          <span class="hljs-comment"># å®ä½“ç±»</span>
â”‚   â”œâ”€â”€ utils/          <span class="hljs-comment"># å·¥å…·ç±»</span>
â”‚   â”œâ”€â”€ aspect/         <span class="hljs-comment"># AOPåˆ‡é¢</span>
â”‚   â””â”€â”€ security/       <span class="hljs-comment"># å®‰å…¨é…ç½®</span>
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ static/         <span class="hljs-comment"># é™æ€èµ„æº</span>
â”‚   â””â”€â”€ templates/      <span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶</span>
â””â”€â”€ pom.xml
</code></pre>
<h3 data-id="heading-5">å››ã€æ•°æ®åº“è®¾è®¡</h3>
<h4 data-id="heading-6">4.1 æ ¸å¿ƒè¡¨ç»“æ„</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å‘˜å·¥è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> employee (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    department <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    avatar_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    is_attended <span class="hljs-type">BOOLEAN</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">false</span>,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- å¥–å“è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> prize (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    level <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¥–å“ç­‰çº§ï¼š1-ç‰¹ç­‰å¥–ï¼Œ2-ä¸€ç­‰å¥–ï¼Œ3-äºŒç­‰å¥–...'</span>,
    total_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    remain_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    image_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    description TEXT,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- ä¸­å¥–è®°å½•è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> winning_record (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    prize_id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    draw_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    draw_method <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) COMMENT <span class="hljs-string">'æŠ½å¥–æ–¹å¼'</span>,
    <span class="hljs-keyword">FOREIGN</span> KEY (employee_id) <span class="hljs-keyword">REFERENCES</span> employee(employee_id),
    <span class="hljs-keyword">FOREIGN</span> KEY (prize_id) <span class="hljs-keyword">REFERENCES</span> prize(id)
);

<span class="hljs-comment">-- æŠ½å¥–æ´»åŠ¨è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> lottery_event (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    start_time DATETIME,
    end_time DATETIME,
    status <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'NOT_STARTED'</span>,
    settings JSON COMMENT <span class="hljs-string">'æ´»åŠ¨é…ç½®'</span>
);
</code></pre>
<h3 data-id="heading-7">äº”ã€æ ¸å¿ƒåŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-8">5.1 é¡¹ç›®ä¾èµ–é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Starter --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ•°æ®åº“ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å·¥å…·ç±» --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>31.1-jre<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- JSONå¤„ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-9">5.2 å‘˜å·¥å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "employee")</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-meta">@Column(name = "employee_id", unique = true, nullable = false)</span>
    <span class="hljs-keyword">private</span> String employeeId;
    
    <span class="hljs-meta">@Column(nullable = false)</span>
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-keyword">private</span> String department;
    <span class="hljs-keyword">private</span> String avatarUrl;
    
    <span class="hljs-meta">@Column(name = "is_attended")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isAttended</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-meta">@CreationTimestamp</span>
    <span class="hljs-meta">@Column(name = "created_time", updatable = false)</span>
    <span class="hljs-keyword">private</span> LocalDateTime createdTime;
    
    <span class="hljs-meta">@Transient</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isWinner</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h4 data-id="heading-10">5.3 æŠ½å¥–æœåŠ¡æ ¸å¿ƒå®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> EmployeeRepository employeeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PrizeRepository prizeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WinningRecordRepository winningRecordRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate redisTemplate;
    
    <span class="hljs-comment">/**
     * æ ¸å¿ƒæŠ½å¥–ç®—æ³• - ä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawPrize</span><span class="hljs-params">(Long prizeId, String drawMethod)</span> {
        <span class="hljs-type">Prize</span> <span class="hljs-variable">prize</span> <span class="hljs-operator">=</span> prizeRepository.findById(prizeId)
            .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¥–å“ä¸å­˜åœ¨"</span>));
            
        <span class="hljs-keyword">if</span> (prize.getRemainCount() &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è¯¥å¥–å“å·²æŠ½å®Œ"</span>);
        }
        
        <span class="hljs-comment">// è·å–æ‰€æœ‰æœªä¸­å¥–çš„å‚ä¼šå‘˜å·¥</span>
        List&lt;Employee&gt; candidates = employeeRepository.findByIsAttendedTrueAndIsWinnerFalse();
        <span class="hljs-keyword">if</span> (candidates.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æŠ½å¥–äººå‘˜"</span>);
        }
        
        <span class="hljs-comment">// ä½¿ç”¨SecureRandomç¡®ä¿éšæœºæ€§</span>
        <span class="hljs-type">SecureRandom</span> <span class="hljs-variable">secureRandom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecureRandom</span>();
        <span class="hljs-type">byte</span>[] randomBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">32</span>];
        secureRandom.nextBytes(randomBytes);
        
        <span class="hljs-comment">// åŸºäºå“ˆå¸Œå€¼é€‰æ‹©ä¸­å¥–è€…</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> Math.abs(Arrays.hashCode(randomBytes)) % candidates.size();
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> candidates.get(index);
        
        <span class="hljs-comment">// ä¿å­˜ä¸­å¥–è®°å½•</span>
        <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
        record.setEmployeeId(winner.getEmployeeId());
        record.setPrizeId(prizeId);
        record.setDrawMethod(drawMethod);
        record.setDrawTime(LocalDateTime.now());
        winningRecordRepository.save(record);
        
        <span class="hljs-comment">// æ›´æ–°å¥–å“å‰©ä½™æ•°é‡</span>
        prize.setRemainCount(prize.getRemainCount() - <span class="hljs-number">1</span>);
        prizeRepository.save(prize);
        
        <span class="hljs-comment">// æ ‡è®°å‘˜å·¥ä¸ºä¸­å¥–çŠ¶æ€ï¼ˆå®é™…ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘ï¼‰</span>
        markEmployeeAsWinner(winner.getId());
        
        <span class="hljs-comment">// å‘é€WebSocketé€šçŸ¥</span>
        sendWinningNotification(winner, prize);
        
        <span class="hljs-keyword">return</span> LotteryResult.builder()
                .winner(winner)
                .prize(prize)
                .drawTime(LocalDateTime.now())
                .drawId(record.getId())
                .build();
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¯¼å…¥å‘˜å·¥
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">importEmployees</span><span class="hljs-params">(MultipartFile file)</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Employee&gt; employees = parseEmployeeFile(file);
            employeeRepository.saveAll(employees);
            log.info(<span class="hljs-string">"æˆåŠŸå¯¼å…¥{}åå‘˜å·¥"</span>, employees.size());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å¯¼å…¥å‘˜å·¥å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å…¥å¤±è´¥: "</span> + e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤šç§æŠ½å¥–æ¨¡å¼
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawWithMode</span><span class="hljs-params">(Prize prize, DrawMode mode)</span> {
        <span class="hljs-keyword">switch</span> (mode) {
            <span class="hljs-keyword">case</span> RANDOM:
                <span class="hljs-keyword">return</span> randomDraw(prize);
            <span class="hljs-keyword">case</span> LUCKY_NUMBER:
                <span class="hljs-keyword">return</span> luckyNumberDraw(prize);
            <span class="hljs-keyword">case</span> ROULETTE:
                <span class="hljs-keyword">return</span> rouletteDraw(prize);
            <span class="hljs-keyword">case</span> GRID:
                <span class="hljs-keyword">return</span> gridDraw(prize);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> randomDraw(prize);
        }
    }
    
    <span class="hljs-comment">/**
     * è½®ç›˜æŠ½å¥–ç®—æ³•
     */</span>
    <span class="hljs-keyword">private</span> LotteryResult <span class="hljs-title function_">rouletteDraw</span><span class="hljs-params">(Prize prize)</span> {
        List&lt;Employee&gt; candidates = getValidCandidates();
        
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªå€™é€‰äººåˆ†é…æƒé‡ï¼ˆè¿™é‡Œç®€å•æŒ‰éƒ¨é—¨åˆ†é…ä¸åŒæƒé‡ï¼‰</span>
        Map&lt;Employee, Double&gt; weights = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Employee emp : candidates) {
            <span class="hljs-type">double</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> getDepartmentWeight(emp.getDepartment());
            weights.put(emp, weight);
        }
        
        <span class="hljs-comment">// è½®ç›˜é€‰æ‹©</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> rouletteSelect(weights);
        <span class="hljs-keyword">return</span> createLotteryResult(winner, prize, <span class="hljs-string">"ROULETTE"</span>);
    }
    
    <span class="hljs-keyword">private</span> Employee <span class="hljs-title function_">rouletteSelect</span><span class="hljs-params">(Map&lt;Employee, Double&gt; weights)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">totalWeight</span> <span class="hljs-operator">=</span> weights.values().stream().mapToDouble(Double::doubleValue).sum();
        <span class="hljs-type">double</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> Math.random() * totalWeight;
        
        <span class="hljs-type">double</span> <span class="hljs-variable">cumulativeWeight</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;
        <span class="hljs-keyword">for</span> (Map.Entry&lt;Employee, Double&gt; entry : weights.entrySet()) {
            cumulativeWeight += entry.getValue();
            <span class="hljs-keyword">if</span> (random &lt;= cumulativeWeight) {
                <span class="hljs-keyword">return</span> entry.getKey();
            }
        }
        
        <span class="hljs-keyword">return</span> weights.keySet().iterator().next();
    }
}
</code></pre>
<h4 data-id="heading-11">5.4 WebSocketå®æ—¶é€šä¿¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSocket</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry registry)</span> {
        registry.addHandler(lotteryWebSocketHandler(), <span class="hljs-string">"/ws/lottery"</span>)
                .setAllowedOrigins(<span class="hljs-string">"*"</span>)
                .withSockJS();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> WebSocketHandler <span class="hljs-title function_">lotteryWebSocketHandler</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryWebSocketHandler</span>();
    }
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryWebSocketHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextWebSocketHandler</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, WebSocketSession&gt; sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> session.getId();
        sessions.put(sessionId, session);
        
        <span class="hljs-comment">// å‘é€æ¬¢è¿æ¶ˆæ¯</span>
        sendMessage(session, <span class="hljs-string">"æ¬¢è¿åŠ å…¥å¹´ä¼šæŠ½å¥–ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTextMessage</span><span class="hljs-params">(WebSocketSession session, TextMessage message)</span> {
        <span class="hljs-comment">// å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> message.getPayload();
        <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span>
    }
    
    <span class="hljs-comment">/**
     * å¹¿æ’­ä¸­å¥–æ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcastWinningMessage</span><span class="hljs-params">(Employee winner, Prize prize)</span> {
        Map&lt;String, Object&gt; message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        message.put(<span class="hljs-string">"type"</span>, <span class="hljs-string">"WINNING_NOTIFICATION"</span>);
        message.put(<span class="hljs-string">"winner"</span>, winner.getName());
        message.put(<span class="hljs-string">"prize"</span>, prize.getName());
        message.put(<span class="hljs-string">"department"</span>, winner.getDepartment());
        message.put(<span class="hljs-string">"time"</span>, LocalDateTime.now().format(DateTimeFormatter.ISO_LOCAL_TIME));
        
        <span class="hljs-type">String</span> <span class="hljs-variable">jsonMessage</span> <span class="hljs-operator">=</span> JSON.toJSONString(message);
        
        sessions.values().forEach(session -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (session.isOpen()) {
                    session.sendMessage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(jsonMessage));
                }
            } <span class="hljs-keyword">catch</span> (IOException e) {
                log.error(<span class="hljs-string">"å‘é€WebSocketæ¶ˆæ¯å¤±è´¥"</span>, e);
            }
        });
    }
}
</code></pre>
<h4 data-id="heading-12">5.5 æŠ½å¥–æ§åˆ¶å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Controller</span>
<span class="hljs-meta">@RequestMapping("/lottery")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryController</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryService lotteryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryWebSocketHandler webSocketHandler;
    
    <span class="hljs-comment">/**
     * æŠ½å¥–é¡µé¢
     */</span>
    <span class="hljs-meta">@GetMapping("/draw")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">drawPage</span><span class="hljs-params">(Model model)</span> {
        List&lt;Prize&gt; availablePrizes = lotteryService.getAvailablePrizes();
        List&lt;Employee&gt; attendees = lotteryService.getAttendees();
        
        model.addAttribute(<span class="hljs-string">"prizes"</span>, availablePrizes);
        model.addAttribute(<span class="hljs-string">"attendees"</span>, attendees);
        model.addAttribute(<span class="hljs-string">"totalAttendees"</span>, attendees.size());
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/draw"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ‰§è¡ŒæŠ½å¥–
     */</span>
    <span class="hljs-meta">@PostMapping("/execute")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;LotteryResult&gt; <span class="hljs-title function_">executeDraw</span><span class="hljs-params">(
            <span class="hljs-meta">@RequestParam</span> Long prizeId,
            <span class="hljs-meta">@RequestParam(defaultValue = "RANDOM")</span> String mode)</span> {
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawWithMode(prizeId, mode);
            
            <span class="hljs-comment">// å‘é€å®æ—¶é€šçŸ¥</span>
            webSocketHandler.broadcastWinningMessage(
                result.getWinner(), 
                result.getPrize()
            );
            
            <span class="hljs-keyword">return</span> ApiResponse.success(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> ApiResponse.error(e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤§å±å¹•æ˜¾ç¤º
     */</span>
    <span class="hljs-meta">@GetMapping("/screen")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">bigScreen</span><span class="hljs-params">(Model model)</span> {
        List&lt;WinningRecord&gt; recentWinners = lotteryService.getRecentWinners(<span class="hljs-number">10</span>);
        model.addAttribute(<span class="hljs-string">"winners"</span>, recentWinners);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/screen"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ•°æ®ç»Ÿè®¡
     */</span>
    <span class="hljs-meta">@GetMapping("/statistics")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;Statistics&gt; <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Statistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> lotteryService.getLotteryStatistics();
        <span class="hljs-keyword">return</span> ApiResponse.success(stats);
    }
}
</code></pre>
<h4 data-id="heading-13">5.6 å‰ç«¯æŠ½å¥–é¡µé¢å®ç°</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.lottery-container</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.prize-card</span> {
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
            <span class="hljs-attribute">cursor</span>: pointer;
        }
        
        <span class="hljs-selector-class">.prize-card</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);
        }
        
        <span class="hljs-selector-class">.lottery-wheel</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">position</span>: relative;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
        }
        
        <span class="hljs-selector-class">.wheel-canvas</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
        
        <span class="hljs-selector-class">.winner-display</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.9</span>);
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-keyword">@keyframes</span> slideIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">50px</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
        }
        
        <span class="hljs-selector-class">.confetti</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f00</span>;
            <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>;
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-keyword">@keyframes</span> confetti-fall {
            <span class="hljs-number">0%</span> { <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">100%</span> { <span class="hljs-attribute">top</span>: <span class="hljs-number">100vh</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ ‡é¢˜åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center text-white mb-5"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-3 fw-bold"</span>&gt;</span>ğŸ‰ å¹´ä¼šå¹¸è¿å¤§æŠ½å¥– ğŸ‰<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lead"</span>&gt;</span>æ¢¦æƒ³æˆçœŸï¼Œå¹¸è¿é™ä¸´<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æŠ½å¥–ä¸»åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- å·¦ä¾§ï¼šå¥–å“é€‰æ‹© --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-primary text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-gift"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¥–å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeList"</span>&gt;</span>
                            <span class="hljs-comment">&lt;!-- å¥–å“åˆ—è¡¨åŠ¨æ€åŠ è½½ --&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- æŠ½å¥–æ§åˆ¶ --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>æŠ½å¥–æ¨¡å¼<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-select"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawMode"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"RANDOM"</span>&gt;</span>éšæœºæŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ROULETTE"</span>&gt;</span>å¹¸è¿è½®ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"GRID"</span>&gt;</span>ä¹å®«æ ¼æŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"LUCKY_NUMBER"</span>&gt;</span>å¹¸è¿æ•°å­—<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger btn-lg w-100"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawButton"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-play"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¼€å§‹æŠ½å¥–
                            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- ä¸­é—´ï¼šæŠ½å¥–åŠ¨ç”» --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-wheel"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"wheelCanvas"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"wheel-canvas"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center mt-3"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"winner-display"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerDisplay"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none;"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-success"</span>&gt;</span>ğŸŠ æ­å–œä¸­å¥–ï¼ ğŸŠ<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fw-bold"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è·å¾—ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- å³ä¾§ï¼šä¸­å¥–åå• --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-success text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-trophy"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> ä¸­å¥–åå•<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerList"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list-group"</span>&gt;</span>
                                <span class="hljs-comment">&lt;!-- ä¸­å¥–åå•åŠ¨æ€åŠ è½½ --&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- ç»Ÿè®¡æ•°æ® --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h6</span>&gt;</span>æŠ½å¥–ç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">h6</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row text-center"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalAttendees"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å‚ä¼šäººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalWinners"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å·²ä¸­å¥–äººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- WebSocketè¿æ¥ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/stomp.js/2.3.3/stomp.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySystem</span> {
            <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
            }
            
            <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPrizes</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectWebSocket</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindEvents</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWheel</span>();
            }
            
            <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SockJS</span>(<span class="hljs-string">'/ws/lottery'</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">over</span>(socket);
                
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">connect</span>({}, <span class="hljs-function">(<span class="hljs-params">frame</span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Connected: '</span> + frame);
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'/topic/winners'</span>, <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
                        <span class="hljs-keyword">const</span> notification = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">body</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinningNotification</span>(notification);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                    });
                });
            }
            
            <span class="hljs-title function_">loadPrizes</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/prizes'</span>, <span class="hljs-function">(<span class="hljs-params">prizes</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#prizeList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    prizes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">prize</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> card = <span class="hljs-string">`
                            &lt;div class="card prize-card mb-2" data-prize-id="<span class="hljs-subst">${prize.id}</span>"&gt;
                                &lt;div class="card-body"&gt;
                                    &lt;h6 class="card-title"&gt;<span class="hljs-subst">${prize.name}</span>&lt;/h6&gt;
                                    &lt;p class="card-text text-muted small"&gt;å‰©ä½™: <span class="hljs-subst">${prize.remainCount}</span>/<span class="hljs-subst">${prize.totalCount}</span>&lt;/p&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">append</span>(card);
                    });
                    
                    <span class="hljs-comment">// ç»‘å®šé€‰æ‹©äº‹ä»¶</span>
                    $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                        $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">'border-primary'</span>);
                        $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">'border-primary border-3'</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">data</span>(<span class="hljs-string">'prize-id'</span>);
                    });
                });
            }
            
            <span class="hljs-title function_">loadWinners</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/recent-winners'</span>, <span class="hljs-function">(<span class="hljs-params">winners</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#winnerList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    winners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">record</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> item = <span class="hljs-string">`
                            &lt;div class="list-group-item"&gt;
                                &lt;div class="d-flex w-100 justify-content-between"&gt;
                                    &lt;h6 class="mb-1"&gt;<span class="hljs-subst">${record.employeeName}</span>&lt;/h6&gt;
                                    &lt;small&gt;<span class="hljs-subst">${record.department}</span>&lt;/small&gt;
                                &lt;/div&gt;
                                &lt;p class="mb-1"&gt;<span class="hljs-subst">${record.prizeName}</span>&lt;/p&gt;
                                &lt;small class="text-muted"&gt;<span class="hljs-subst">${record.drawTime}</span>&lt;/small&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">prepend</span>(item);
                    });
                });
            }
            
            <span class="hljs-title function_">loadStatistics</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/statistics'</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {
                    $(<span class="hljs-string">'#totalAttendees'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalAttendees</span>);
                    $(<span class="hljs-string">'#totalWinners'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalWinners</span>);
                });
            }
            
            <span class="hljs-title function_">bindEvents</span>(<span class="hljs-params"/>) {
                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'è¯·å…ˆé€‰æ‹©å¥–å“ï¼'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æ­£åœ¨æŠ½å¥–ä¸­ï¼Œè¯·ç¨å€™...'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">true</span>;
                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt; æŠ½å¥–ä¸­...'</span>);
                    
                    <span class="hljs-keyword">const</span> drawMode = $(<span class="hljs-string">'#drawMode'</span>).<span class="hljs-title function_">val</span>();
                    
                    <span class="hljs-comment">// å¼€å§‹æŠ½å¥–åŠ¨ç”»</span>
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startWheelAnimation</span>();
                    
                    <span class="hljs-comment">// å‘é€æŠ½å¥–è¯·æ±‚</span>
                    $.<span class="hljs-title function_">ajax</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">'/lottery/execute'</span>,
                        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                        <span class="hljs-attr">data</span>: {
                            <span class="hljs-attr">prizeId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>,
                            <span class="hljs-attr">mode</span>: drawMode
                        },
                        <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
                            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) {
                                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinner</span>(response.<span class="hljs-property">data</span>);
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createConfetti</span>();
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                                }, <span class="hljs-number">3000</span>);
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);
                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                            }
                        },
                        <span class="hljs-attr">error</span>: <span class="hljs-function">() =&gt;</span> {
                            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•ï¼'</span>);
                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                            $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                        }
                    });
                });
            }
            
            <span class="hljs-title function_">startWheelAnimation</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
                <span class="hljs-keyword">const</span> centerX = canvas.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> centerY = canvas.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(centerX, centerY) - <span class="hljs-number">10</span>;
                
                <span class="hljs-keyword">let</span> rotation = <span class="hljs-number">0</span>;
                
                <span class="hljs-keyword">const</span> <span class="hljs-title function_">animate</span> = (<span class="hljs-params"/>) =&gt; {
                    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
                    
                    <span class="hljs-comment">// ç»˜åˆ¶è½¬ç›˜</span>
                    rotation += <span class="hljs-number">0.1</span>;
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æ‰‡å½¢</span>
                    <span class="hljs-keyword">const</span> segments = <span class="hljs-number">12</span>;
                    <span class="hljs-keyword">const</span> segmentAngle = (<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / segments;
                    
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; segments; i++) {
                        <span class="hljs-keyword">const</span> startAngle = segmentAngle * i + rotation;
                        <span class="hljs-keyword">const</span> endAngle = segmentAngle * (i + <span class="hljs-number">1</span>) + rotation;
                        
                        ctx.<span class="hljs-title function_">beginPath</span>();
                        ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">arc</span>(centerX, centerY, radius, startAngle, endAngle);
                        ctx.<span class="hljs-title function_">closePath</span>();
                        
                        <span class="hljs-comment">// äº¤æ›¿é¢œè‰²</span>
                        ctx.<span class="hljs-property">fillStyle</span> = i % <span class="hljs-number">2</span> === <span class="hljs-number">0</span> ? <span class="hljs-string">'#FF6B6B'</span> : <span class="hljs-string">'#4ECDC4'</span>;
                        ctx.<span class="hljs-title function_">fill</span>();
                        
                        <span class="hljs-comment">// ç»˜åˆ¶æ–‡å­—</span>
                        ctx.<span class="hljs-title function_">save</span>();
                        ctx.<span class="hljs-title function_">translate</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">rotate</span>(startAngle + segmentAngle / <span class="hljs-number">2</span>);
                        ctx.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'right'</span>;
                        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'white'</span>;
                        ctx.<span class="hljs-property">font</span> = <span class="hljs-string">'bold 14px Arial'</span>;
                        ctx.<span class="hljs-title function_">fillText</span>(<span class="hljs-string">'å¹¸è¿'</span>, radius - <span class="hljs-number">20</span>, <span class="hljs-number">10</span>);
                        ctx.<span class="hljs-title function_">restore</span>();
                    }
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æŒ‡é’ˆ</span>
                    ctx.<span class="hljs-title function_">beginPath</span>();
                    ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY - <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX, centerY - radius + <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX + <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX - <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">closePath</span>();
                    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#FFD93D'</span>;
                    ctx.<span class="hljs-title function_">fill</span>();
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">requestAnimationFrame</span>(animate);
                    }
                };
                
                canvas.<span class="hljs-property">width</span> = <span class="hljs-number">500</span>;
                canvas.<span class="hljs-property">height</span> = <span class="hljs-number">500</span>;
                <span class="hljs-title function_">animate</span>();
            }
            
            <span class="hljs-title function_">showWinner</span>(<span class="hljs-params">result</span>) {
                $(<span class="hljs-string">'#winnerName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">winner</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#prizeName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">prize</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#winnerDisplay'</span>).<span class="hljs-title function_">fadeIn</span>();
                
                <span class="hljs-comment">// æ’­æ”¾éŸ³æ•ˆ</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playSound</span>(<span class="hljs-string">'winning'</span>);
            }
            
            <span class="hljs-title function_">showWinningNotification</span>(<span class="hljs-params">notification</span>) {
                <span class="hljs-comment">// æ˜¾ç¤ºå®æ—¶é€šçŸ¥</span>
                <span class="hljs-keyword">const</span> notificationHtml = <span class="hljs-string">`
                    &lt;div class="toast show" role="alert"&gt;
                        &lt;div class="toast-header bg-success text-white"&gt;
                            &lt;strong class="me-auto"&gt;ğŸ‰ æ­å–œä¸­å¥–ï¼&lt;/strong&gt;
                            &lt;small&gt;åˆšåˆš&lt;/small&gt;
                        &lt;/div&gt;
                        &lt;div class="toast-body"&gt;
                            &lt;strong&gt;<span class="hljs-subst">${notification.winner}</span>&lt;/strong&gt; è·å¾— &lt;strong&gt;<span class="hljs-subst">${notification.prize}</span>&lt;/strong&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                `</span>;
                
                $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                $(<span class="hljs-string">'body'</span>).<span class="hljs-title function_">append</span>(<span class="hljs-string">`&lt;div class="toast-container position-fixed top-0 end-0 p-3"&gt;<span class="hljs-subst">${notificationHtml}</span>&lt;/div&gt;`</span>);
                
                <span class="hljs-comment">// 5ç§’åè‡ªåŠ¨ç§»é™¤</span>
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                }, <span class="hljs-number">5000</span>);
            }
            
            <span class="hljs-title function_">createConfetti</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">'#FF6B6B'</span>, <span class="hljs-string">'#4ECDC4'</span>, <span class="hljs-string">'#FFD93D'</span>, <span class="hljs-string">'#6BCF7F'</span>];
                
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
                    <span class="hljs-keyword">const</span> confetti = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                    confetti.<span class="hljs-property">className</span> = <span class="hljs-string">'confetti'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span> + <span class="hljs-string">'vw'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = colors[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * colors.<span class="hljs-property">length</span>)];
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animation</span> = <span class="hljs-string">`confetti-fall <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>}</span>s linear forwards`</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">1</span> + <span class="hljs-string">'s'</span>;
                    
                    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(confetti);
                    
                    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                        confetti.<span class="hljs-title function_">remove</span>();
                    }, <span class="hljs-number">5000</span>);
                }
            }
            
            <span class="hljs-title function_">playSound</span>(<span class="hljs-params">type</span>) {
                <span class="hljs-keyword">const</span> audio = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Audio</span>();
                <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'winning'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/winning.mp3'</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'draw'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/draw.mp3'</span>;
                }
                audio.<span class="hljs-title function_">play</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'éŸ³é¢‘æ’­æ”¾å¤±è´¥:'</span>, e));
            }
            
            <span class="hljs-title function_">initWheel</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// åˆå§‹åŒ–æŠ½å¥–è½¬ç›˜</span>
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">if</span> (canvas.<span class="hljs-property">getContext</span>) {
                    <span class="hljs-comment">// å·²ç»åœ¨ä¸Šé¢çš„startWheelAnimationä¸­åˆå§‹åŒ–äº†</span>
                }
            }
        }
        
        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–</span>
        $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">window</span>.<span class="hljs-property">lotterySystem</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotterySystem</span>();
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">å…­ã€ç³»ç»Ÿç‰¹è‰²åŠŸèƒ½</h3>
<h4 data-id="heading-15">6.1 å¤šç§æŠ½å¥–æ¨¡å¼</h4>
<ol>
<li><strong>éšæœºæŠ½å¥–</strong>ï¼šå®Œå…¨éšæœºï¼Œç¡®ä¿å…¬å¹³</li>
<li><strong>å¹¸è¿è½®ç›˜</strong>ï¼šè§†è§‰å†²å‡»åŠ›å¼ºï¼Œå¢åŠ è¶£å‘³æ€§</li>
<li><strong>ä¹å®«æ ¼æŠ½å¥–</strong>ï¼šäº’åŠ¨æ€§å¼ºï¼Œé€‚åˆå°å›¢é˜Ÿ</li>
<li><strong>å¹¸è¿æ•°å­—</strong>ï¼šä¸å‘˜å·¥å·¥å·å…³è”ï¼Œå¢åŠ å‚ä¸æ„Ÿ</li>
</ol>
<h4 data-id="heading-16">6.2 å®æ—¶äº’åŠ¨åŠŸèƒ½</h4>
<ul>
<li><strong>WebSocketå®æ—¶é€šçŸ¥</strong>ï¼šä¸­å¥–ç»“æœå®æ—¶æ¨é€åˆ°æ‰€æœ‰å®¢æˆ·ç«¯</li>
<li><strong>å¤§å±å¹•æ˜¾ç¤º</strong>ï¼šä¸“é—¨ä¸ºä¸­å¥–å±•ç¤ºè®¾è®¡çš„å…¨å±ç•Œé¢</li>
<li><strong>å¼¹å¹•äº’åŠ¨</strong>ï¼šå‘˜å·¥å¯ä»¥å‘é€ç¥ç¦å¼¹å¹•</li>
<li><strong>å€’è®¡æ—¶åŠŸèƒ½</strong>ï¼šå¢åŠ ç´§å¼ æ°›å›´</li>
</ul>
<h4 data-id="heading-17">6.3 é˜²ä½œå¼Šæœºåˆ¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySecurityService</span> {
    
    <span class="hljs-comment">/**
     * éªŒè¯æŠ½å¥–è¯·æ±‚çš„åˆæ³•æ€§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateDrawRequest</span><span class="hljs-params">(String sessionId, Long prizeId)</span> {
        <span class="hljs-comment">// é˜²æ­¢é¢‘ç¹è¯·æ±‚</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"draw:limit:"</span> + sessionId;
        <span class="hljs-type">Long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue().increment(key, <span class="hljs-number">1</span>);
        
        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span>) {
            redisTemplate.expire(key, <span class="hljs-number">10</span>, TimeUnit.SECONDS);
        }
        
        <span class="hljs-keyword">return</span> count &lt;= <span class="hljs-number">3</span>; <span class="hljs-comment">// 10ç§’å†…æœ€å¤šè¯·æ±‚3æ¬¡</span>
    }
    
    <span class="hljs-comment">/**
     * éªŒè¯å‘˜å·¥èµ„æ ¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateEmployeeEligibility</span><span class="hljs-params">(String employeeId)</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç­¾åˆ°</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ä¸­å¥–ï¼ˆé™åˆ¶æ¯äººæœ€å¤šä¸­å¥–æ¬¡æ•°ï¼‰</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ç¬¦åˆç‰¹å®šå¥–å“è¦æ±‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–è¿‡ç¨‹å®¡è®¡æ—¥å¿—
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">auditDrawProcess</span><span class="hljs-params">(LotteryResult result, String operator)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">auditLog</span> <span class="hljs-operator">=</span> String.format(
            <span class="hljs-string">"æŠ½å¥–å®¡è®¡ - æ“ä½œäºº:%s, å¥–å“:%s, ä¸­å¥–äºº:%s, æ—¶é—´:%s, éšæœºç§å­:%s"</span>,
            operator,
            result.getPrize().getName(),
            result.getWinner().getName(),
            LocalDateTime.now(),
            generateRandomSeed()
        );
        
        log.info(auditLog);
        saveToBlockchain(auditLog); <span class="hljs-comment">// å¯é€‰ï¼šä¿å­˜åˆ°åŒºå—é“¾ç¡®ä¿ä¸å¯ç¯¡æ”¹</span>
    }
}
</code></pre>
<h4 data-id="heading-18">6.4 æ•°æ®ç»Ÿè®¡ä¸åˆ†æ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatisticsService</span> {
    
    <span class="hljs-keyword">public</span> LotteryStatistics <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">LotteryStatistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryStatistics</span>();
        
        <span class="hljs-comment">// åŸºç¡€ç»Ÿè®¡</span>
        stats.setTotalAttendees(employeeRepository.countByIsAttendedTrue());
        stats.setTotalWinners(winningRecordRepository.count());
        stats.setTotalPrizes(prizeRepository.count());
        
        <span class="hljs-comment">// éƒ¨é—¨ä¸­å¥–åˆ†å¸ƒ</span>
        Map&lt;String, Long&gt; deptDistribution = winningRecordRepository
            .getDepartmentDistribution();
        stats.setDepartmentDistribution(deptDistribution);
        
        <span class="hljs-comment">// æ—¶é—´æ®µåˆ†æ</span>
        List&lt;HourlyDraw&gt; hourlyDraws = winningRecordRepository
            .getHourlyDrawCount();
        stats.setHourlyDraws(hourlyDraws);
        
        <span class="hljs-comment">// å¥–å“çƒ­åº¦</span>
        List&lt;PrizePopularity&gt; prizePopularity = winningRecordRepository
            .getPrizePopularity();
        stats.setPrizePopularity(prizePopularity);
        
        <span class="hljs-keyword">return</span> stats;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–æŠ¥å‘Š
     */</span>
    <span class="hljs-keyword">public</span> Report <span class="hljs-title function_">generateReport</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Report</span> <span class="hljs-variable">report</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Report</span>();
        
        <span class="hljs-comment">// æ€»ä½“æƒ…å†µ</span>
        report.setSummary(getSummary());
        
        <span class="hljs-comment">// è¯¦ç»†æ•°æ®</span>
        report.setDetails(getDetailedData());
        
        <span class="hljs-comment">// å›¾è¡¨æ•°æ®</span>
        report.setCharts(getChartData());
        
        <span class="hljs-comment">// åˆ†æç»“è®º</span>
        report.setAnalysis(getAnalysis());
        
        <span class="hljs-keyword">return</span> report;
    }
}
</code></pre>
<h3 data-id="heading-19">ä¸ƒã€éƒ¨ç½²ä¸é…ç½®</h3>
<h4 data-id="heading-20">7.1 åº”ç”¨é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/lottery_db?useSSL=false&amp;serverTimezone=UTC</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">lottery_admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
    
  <span class="hljs-attr">jpa:</span>
    <span class="hljs-attr">hibernate:</span>
      <span class="hljs-attr">ddl-auto:</span> <span class="hljs-string">update</span>
    <span class="hljs-attr">show-sql:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">properties:</span>
      <span class="hljs-attr">hibernate:</span>
        <span class="hljs-attr">format_sql:</span> <span class="hljs-literal">true</span>
        
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> 
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">5000ms</span>
    
  <span class="hljs-attr">thymeleaf:</span>
    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">HTML</span>
    <span class="hljs-attr">encoding:</span> <span class="hljs-string">UTF-8</span>
    
<span class="hljs-attr">lottery:</span>
  <span class="hljs-attr">security:</span>
    <span class="hljs-attr">admin-username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">admin-password:</span> <span class="hljs-string">${ADMIN_PASSWORD:admin123}</span>
    <span class="hljs-attr">jwt-secret:</span> <span class="hljs-string">${JWT_SECRET:lottery-secret-key}</span>
    
  <span class="hljs-attr">draw:</span>
    <span class="hljs-attr">max-attempts-per-minute:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">cooldown-seconds:</span> <span class="hljs-number">5</span>
    
  <span class="hljs-attr">ui:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">å¹´ä¼šå¹¸è¿å¤§æŠ½å¥–</span>
    <span class="hljs-attr">theme:</span> <span class="hljs-string">gradient-blue</span>
    <span class="hljs-attr">animation-enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-21">7.2 Dockeréƒ¨ç½²</h4>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># Dockerfile
FROM openjdk:11-jre-slim

WORKDIR /app

COPY target/lottery-system-1.0.0.jar app.jar

RUN mkdir -p /app/logs /app/uploads

ENV TZ=Asia/Shanghai
ENV JAVA_OPTS="-Xmx512m -Xms256m"

EXPOSE 8080

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root_password</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">lottery_db</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">lottery_admin</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3306:3306"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql_data:/var/lib/mysql</span>
      
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7-alpine</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6379:6379"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_data:/data</span>
      
  <span class="hljs-attr">lottery-app:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">SPRING_DATASOURCE_URL:</span> <span class="hljs-string">jdbc:mysql://mysql:3306/lottery_db</span>
      <span class="hljs-attr">SPRING_REDIS_HOST:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>
      
<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">mysql_data:</span>
  <span class="hljs-attr">redis_data:</span>
</code></pre>
<h3 data-id="heading-22">å…«ã€ç³»ç»Ÿä¼˜åŒ–ä¸æ‰©å±•</h3>
<h4 data-id="heading-23">8.1 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryOptimizationService</span> {
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨Redisç¼“å­˜çƒ­é—¨æ•°æ®
     */</span>
    <span class="hljs-meta">@Cacheable(value = "prizes", key = "'available'")</span>
    <span class="hljs-keyword">public</span> List&lt;Prize&gt; <span class="hljs-title function_">getAvailablePrizes</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> prizeRepository.findByRemainCountGreaterThan(<span class="hljs-number">0</span>);
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¤„ç†ä¼˜åŒ–
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">batchProcessWinners</span><span class="hljs-params">(List&lt;Long&gt; winnerIds, Long prizeId)</span> {
        <span class="hljs-comment">// ä½¿ç”¨æ‰¹é‡æ’å…¥æé«˜æ€§èƒ½</span>
        List&lt;WinningRecord&gt; records = winnerIds.stream()
            .map(employeeId -&gt; {
                <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
                record.setEmployeeId(employeeId.toString());
                record.setPrizeId(prizeId);
                <span class="hljs-keyword">return</span> record;
            })
            .collect(Collectors.toList());
            
        winningRecordRepository.saveAll(records);
    }
    
    <span class="hljs-comment">/**
     * å¼‚æ­¥å¤„ç†éæ ¸å¿ƒä¸šåŠ¡
     */</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">asyncSendNotification</span><span class="hljs-params">(WinningRecord record)</span> {
        <span class="hljs-comment">// å‘é€é‚®ä»¶é€šçŸ¥</span>
        emailService.sendWinningEmail(record);
        
        <span class="hljs-comment">// å‘é€çŸ­ä¿¡é€šçŸ¥</span>
        smsService.sendWinningSMS(record);
        
        <span class="hljs-comment">// è®°å½•æ—¥å¿—</span>
        auditService.logWinningEvent(record);
    }
}
</code></pre>
<h4 data-id="heading-24">8.2 æ‰©å±•åŠŸèƒ½</h4>
<ol>
<li><strong>å¾®ä¿¡å°ç¨‹åºæ¥å…¥</strong>ï¼šå‘˜å·¥æ‰«ç å‚ä¸</li>
<li><strong>äººè„¸è¯†åˆ«ç­¾åˆ°</strong>ï¼šé˜²æ­¢ä»£ç­¾</li>
<li><strong>è™šæ‹Ÿç¤¼ç‰©ç³»ç»Ÿ</strong>ï¼šå‘˜å·¥äº’é€ç¥ç¦</li>
<li><strong>æŠ½å¥–ç­–ç•¥å¼•æ“</strong>ï¼šå¯é…ç½®çš„æŠ½å¥–è§„åˆ™</li>
<li><strong>å¤šä¼šåœºæ”¯æŒ</strong>ï¼šåˆ†å¸ƒå¼æŠ½å¥–åŒæ­¥</li>
</ol>
<h3 data-id="heading-25">ä¹ã€æµ‹è¯•ä¸éªŒè¯</h3>
<h4 data-id="heading-26">9.1 å•å…ƒæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@AutoConfigureMockMvc</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryServiceTest</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MockMvc mockMvc;
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testRandomDraw</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æµ‹è¯•éšæœºæŠ½å¥–çš„å…¬å¹³æ€§</span>
        Map&lt;Long, Integer&gt; winCount = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-type">int</span> <span class="hljs-variable">totalTests</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; totalTests; i++) {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
            <span class="hljs-type">Long</span> <span class="hljs-variable">winnerId</span> <span class="hljs-operator">=</span> result.getWinner().getId();
            winCount.put(winnerId, winCount.getOrDefault(winnerId, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
        }
        
        <span class="hljs-comment">// éªŒè¯åˆ†å¸ƒæ˜¯å¦å‡åŒ€</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">expectedFrequency</span> <span class="hljs-operator">=</span> totalTests / <span class="hljs-number">100.0</span>; <span class="hljs-comment">// å‡è®¾æœ‰100ä¸ªå€™é€‰äºº</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">chiSquare</span> <span class="hljs-operator">=</span> calculateChiSquare(winCount, expectedFrequency);
        
        assertTrue(chiSquare &lt; <span class="hljs-number">15.0</span>, <span class="hljs-string">"æŠ½å¥–åˆ†å¸ƒä¸å‡åŒ€"</span>);
    }
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConcurrentDraw</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// æµ‹è¯•å¹¶å‘æŠ½å¥–</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">threadCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(threadCount);
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">latch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(threadCount);
        
        List&lt;Future&lt;LotteryResult&gt;&gt; futures = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; threadCount; i++) {
            Future&lt;LotteryResult&gt; future = executor.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
                } <span class="hljs-keyword">finally</span> {
                    latch.countDown();
                }
            });
            futures.add(future);
        }
        
        latch.await(<span class="hljs-number">10</span>, TimeUnit.SECONDS);
        
        <span class="hljs-comment">// éªŒè¯æ²¡æœ‰é‡å¤ä¸­å¥–</span>
        Set&lt;Long&gt; winnerIds = futures.stream()
            .map(f -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> f.get().getWinner().getId();
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
                }
            })
            .filter(Objects::nonNull)
            .collect(Collectors.toSet());
            
        assertEquals(threadCount, winnerIds.size(), <span class="hljs-string">"å­˜åœ¨é‡å¤ä¸­å¥–æƒ…å†µ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-27">åã€æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨SpringBoot + Javaæ„å»ºä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿã€‚ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>å…¬æ­£æ€§ä¿éšœ</strong>ï¼šä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆç®—æ³•ï¼Œæ‰€æœ‰æ“ä½œéƒ½æœ‰å®¡è®¡æ—¥å¿—</li>
<li><strong>è¶£å‘³æ€§ä½“éªŒ</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼Œç‚«é…·çš„åŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨åŠŸèƒ½</li>
<li><strong>é«˜å¯é æ€§</strong>ï¼šæ”¯æŒé«˜å¹¶å‘ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ–¹ä¾¿æ·»åŠ æ–°åŠŸèƒ½å’ŒæŠ½å¥–æ¨¡å¼</li>
<li><strong>éƒ¨ç½²ç®€å•</strong>ï¼šæ”¯æŒDockerå®¹å™¨åŒ–éƒ¨ç½²ï¼Œä¸€é”®å¯åŠ¨</li>
</ol>
<p>ç³»ç»Ÿä¸ä»…æ»¡è¶³äº†åŸºæœ¬çš„æŠ½å¥–éœ€æ±‚ï¼Œè¿˜é€šè¿‡WebSocketå®æ—¶é€šä¿¡ã€å¤šç§æŠ½å¥–æ¨¡å¼ã€æ•°æ®ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ï¼Œå¤§å¤§æå‡äº†å¹´ä¼šçš„äº’åŠ¨æ€§å’Œè¶£å‘³æ€§ã€‚ä¼ä¸šå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œè¿›ä¸€æ­¥æ‰©å±•åŠŸèƒ½ï¼Œå¦‚é›†æˆä¼ä¸šå¾®ä¿¡ã€æ·»åŠ æ›´å¤šäº’åŠ¨æ¸¸æˆç­‰ï¼Œæ‰“é€ ç‹¬ä¸€æ— äºŒçš„å¹´ä¼šæŠ½å¥–ä½“éªŒã€‚</p>
<p>é€šè¿‡æœ¬ç³»ç»Ÿçš„å®æ–½ï¼Œä¼ä¸šå¯ä»¥ç¡®ä¿æŠ½å¥–æ´»åŠ¨çš„å…¬å¹³å…¬æ­£ï¼ŒåŒæ—¶æå‡å‘˜å·¥çš„å‚ä¸æ„Ÿå’Œæ»¡æ„åº¦ï¼Œä¸ºå¹´ä¼šå¢æ·»æ›´å¤šæ¬¢ä¹å’ŒæƒŠå–œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾]]></title>    <link>https://juejin.cn/post/7603267434502340623</link>    <guid>https://juejin.cn/post/7603267434502340623</guid>    <pubDate>2026-02-06T02:53:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603267434502340623" data-draft-id="7603238967291379764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-06T02:53:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ·å°”æ™ºæ…§å®¶æŠ€æœ¯å¹³å°"/> <meta itemprop="url" content="https://juejin.cn/user/3848721122725016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4176c1a2e0b4e1b986f105126840cc9~tplv-k3u1fbpfcp-watermark.image?" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ" class="title" data-v-d326b38e="">ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2026-02-06T02:53:19.000Z" title="Fri Feb 06 2026 02:53:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2026-02-06
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                0
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»10åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @æµ·å°”ä¼˜å®¶æ™ºèƒ½ç§‘æŠ€ï¼ˆåŒ—äº¬ï¼‰æœ‰é™å…¬å¸
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ APISIXï¼ˆäº‘åŸç”Ÿ API ç½‘å…³ï¼‰ä¸­å®ç°<strong>æ¥å£éªŒç­¾é€»è¾‘</strong>ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡å…¶<strong>æ’ä»¶æœºåˆ¶</strong>å®Œæˆ â€”â€” åˆ©ç”¨ APISIX å†…ç½®çš„éªŒç­¾ç›¸å…³æ’ä»¶ï¼ˆå¦‚<code>hmac-auth</code>ã€<code>jwt-auth</code>ï¼‰æˆ–è‡ªå®šä¹‰ Lua æ’ä»¶ï¼Œæ‹¦æˆªè¯·æ±‚å¹¶æ‰§è¡Œç­¾åéªŒè¯æµç¨‹ï¼Œç¡®ä¿è¯·æ±‚æ¥æºåˆæ³•ã€æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚</p>
<h2 data-id="heading-0">1. APISIX éªŒç­¾çš„æ ¸å¿ƒåŸç†</h2>
<p>APISIX çš„è¯·æ±‚å¤„ç†æµç¨‹ä¸ºï¼š<code>è¯·æ±‚è¿›å…¥ â†’ æ’ä»¶æ‰§è¡Œï¼ˆé¡ºåºå¯é…ç½®ï¼‰ â†’ è½¬å‘è‡³ä¸Šæ¸¸æœåŠ¡</code>ã€‚éªŒç­¾é€»è¾‘æœ¬è´¨æ˜¯åœ¨<strong>æ’ä»¶æ‰§è¡Œé˜¶æ®µ</strong>ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<ol>
<li><strong>æå–</strong> <strong>ç­¾å</strong> <strong>ç›¸å…³å‚æ•°</strong>ï¼šä»è¯·æ±‚å¤´ï¼ˆå¦‚<code>X-Signature</code>ã€<code>Authorization</code>ï¼‰ã€è¯·æ±‚å‚æ•°æˆ– Body ä¸­ï¼Œæå–ç­¾åå€¼ã€æ—¶é—´æˆ³ã€éšæœºä¸²ã€AccessKey ç­‰éªŒç­¾å¿…éœ€ä¿¡æ¯ã€‚</li>
<li><strong>ç”Ÿæˆå¾…éªŒç­¾ä¸²</strong>ï¼šæŒ‰ç…§ä¸šåŠ¡çº¦å®šçš„è§„åˆ™ï¼ˆå¦‚ â€œå‚æ•°æŒ‰ ASCII æ’åº + æ‹¼æ¥æ—¶é—´æˆ³ + å¯†é’¥â€ï¼‰ï¼Œé‡ç»„è¯·æ±‚ä¸­çš„å…³é”®æ•°æ®ï¼ˆå¦‚è¯·æ±‚å‚æ•°ã€Bodyã€æ—¶é—´æˆ³ï¼‰ï¼Œç”Ÿæˆ â€œå¾…éªŒç­¾å­—ç¬¦ä¸²â€ã€‚</li>
<li><strong>æ‰§è¡Œ</strong> <strong>ç­¾å</strong> <strong>éªŒè¯</strong>ï¼šä½¿ç”¨ä¸å®¢æˆ·ç«¯çº¦å®šçš„ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ã€RSAï¼‰ï¼Œç»“åˆé¢„è®¾çš„å¯†é’¥ï¼ˆæˆ–å…¬é’¥ï¼‰å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œç­¾åï¼Œå¯¹æ¯”ç”Ÿæˆçš„ç­¾åä¸è¯·æ±‚ä¸­æå–çš„ç­¾åæ˜¯å¦ä¸€è‡´ã€‚</li>
<li><strong>æ‹¦æˆªæˆ–æ”¾è¡Œ</strong>ï¼šéªŒè¯é€šè¿‡åˆ™ç»§ç»­è½¬å‘è¯·æ±‚è‡³ä¸Šæ¸¸ï¼›éªŒè¯å¤±è´¥ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰åˆ™ç›´æ¥è¿”å› 401/403 é”™è¯¯ï¼Œæ‹¦æˆªè¯·æ±‚ã€‚</li>
</ol>
<h2 data-id="heading-1">2. APISIX å®ç°éªŒç­¾çš„ 3 ç§å¸¸è§æ–¹å¼</h2>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚æ˜¯å¦éœ€è¦è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ã€ç­¾åç®—æ³•ç±»å‹ï¼‰ï¼ŒAPISIX æä¾›äº† â€œå†…ç½®æ’ä»¶â€â€œè‡ªå®šä¹‰ Lua æ’ä»¶â€â€œé›†æˆå¤–éƒ¨æœåŠ¡â€ ä¸‰ç§å®ç°æ–¹å¼ï¼Œä»¥ä¸‹è¯¦ç»†è¯´æ˜ï¼š</p>
<h3 data-id="heading-2">æ–¹å¼ 1ï¼šä½¿ç”¨ APISIX å†…ç½®éªŒç­¾æ’ä»¶ï¼ˆæ¨èï¼Œæ— éœ€ç¼–ç ï¼‰</h3>
<p>APISIX æä¾›äº†å¤šä¸ªæˆç†Ÿçš„å†…ç½®æ’ä»¶ï¼Œè¦†ç›–ä¸»æµéªŒç­¾åœºæ™¯ï¼ˆå¦‚ HMAC å¯¹ç§°åŠ å¯†ã€JWT ä»¤ç‰Œã€Basic Authï¼‰ï¼Œæ— éœ€ç¼–å†™ä»£ç ï¼Œä»…éœ€é€šè¿‡é…ç½®å³å¯å¯ç”¨ã€‚</p>
<h4 data-id="heading-3">1.1 HMAC å¯¹ç§°åŠ å¯†éªŒç­¾ï¼ˆ<code>hmac-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>å®¢æˆ·ç«¯ä¸</strong> <strong>ç½‘å…³</strong> <strong>å…±äº«</strong> <strong>å¯†é’¥</strong>çš„åœºæ™¯ï¼ˆå¦‚å†…éƒ¨æœåŠ¡é—´è°ƒç”¨ï¼‰ï¼ŒåŸºäº HMAC ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ï¼‰éªŒè¯ç­¾åï¼Œæ”¯æŒé˜²é‡æ”¾ï¼ˆé€šè¿‡æ—¶é—´æˆ³ + nonceï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumerï¼ˆæ¶ˆè´¹è€…ï¼Œå³å®¢æˆ·ç«¯èº«ä»½ï¼‰</strong> ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯é…ç½®å”¯ä¸€çš„<code>access_key</code>ï¼ˆæ ‡è¯†å®¢æˆ·ç«¯ï¼‰å’Œ<code>secret_key</code>ï¼ˆå¯¹ç§°å¯†é’¥ï¼Œéœ€å®¢æˆ·ç«¯ä¸ç½‘å…³ä¸€è‡´ï¼‰ï¼Œå¹¶ç»‘å®š<code>hmac-auth</code>æ’ä»¶ã€‚ç¤ºä¾‹ï¼ˆé€šè¿‡ APISIX Admin API é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºConsumerå¹¶å¯ç”¨hmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"client_001"</span>,  <span class="hljs-comment"># Consumeråç§°ï¼ˆè‡ªå®šä¹‰ï¼‰</span>
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {
      <span class="hljs-string">"access_key"</span>: <span class="hljs-string">"AK123456"</span>,  <span class="hljs-comment"># å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ï¼ˆå®¢æˆ·ç«¯éœ€æºå¸¦ï¼‰</span>
      <span class="hljs-string">"secret_key"</span>: <span class="hljs-string">"SKabcdef123456"</span>,  <span class="hljs-comment"># å¯¹ç§°å¯†é’¥ï¼ˆå®¢æˆ·ç«¯ä¸ç½‘å…³å…±äº«ï¼Œéœ€ä¿å¯†ï¼‰</span>
      <span class="hljs-string">"sign_header"</span>: <span class="hljs-string">"X-HMAC-Signature"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­ç­¾åçš„å­—æ®µå</span>
      <span class="hljs-string">"clock_skew"</span>: 300,  <span class="hljs-comment"># å…è®¸çš„æ—¶é—´æˆ³åå·®ï¼ˆç§’ï¼Œé˜²é‡æ”¾ï¼‰</span>
      <span class="hljs-string">"nonce_header"</span>: <span class="hljs-string">"X-HMAC-Nonce"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­éšæœºä¸²çš„å­—æ®µå</span>
      <span class="hljs-string">"timestamp_header"</span>: <span class="hljs-string">"X-HMAC-Timestamp"</span>  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­æ—¶é—´æˆ³çš„å­—æ®µå</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route/</strong> <strong>Service</strong> <strong>ç»‘å®š</strong> <strong><code>hmac-auth</code></strong> <strong>æ’ä»¶</strong>å°†æ’ä»¶åº”ç”¨åˆ°éœ€è¦éªŒç­¾çš„è·¯ç”±ï¼ˆRouteï¼‰æˆ–æœåŠ¡ï¼ˆServiceï¼‰ï¼Œç¡®ä¿è¯¥è·¯ç”±çš„æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»é€šè¿‡ HMAC éªŒç­¾ã€‚ç¤ºä¾‹ï¼ˆä¸º Route é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸ºRoute 1ç»‘å®šhmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/routes/1 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/order/*"</span>,  <span class="hljs-comment"># éœ€éªŒç­¾çš„æ¥å£è·¯å¾„</span>
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"roundrobin"</span>,
    <span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.100:8080"</span>: 1}  <span class="hljs-comment"># ä¸Šæ¸¸æœåŠ¡åœ°å€</span>
  },
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {}  <span class="hljs-comment"># å¯ç”¨æ’ä»¶ï¼ˆæ— éœ€é¢å¤–é…ç½®ï¼Œå¤ç”¨Consumerçš„æ’ä»¶å‚æ•°ï¼‰</span>
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<p>Â Â å®¢æˆ·ç«¯éœ€æŒ‰ä»¥ä¸‹è§„åˆ™ç”Ÿæˆç­¾åå¹¶æºå¸¦è¯·æ±‚å¤´ï¼š</p>
<ul>
<li>ç”Ÿæˆ<code>nonce</code>ï¼ˆéšæœºä¸²ï¼Œå¦‚<code>abc123</code>ï¼‰ã€<code>timestamp</code>ï¼ˆå½“å‰æ—¶é—´æˆ³ï¼Œå¦‚<code>1690000000</code>ï¼‰ï¼›</li>
<li>å¾…éªŒç­¾ä¸²è§„åˆ™ï¼š<code>method + uri + timestamp + nonce + body</code>ï¼ˆå…·ä½“è§„åˆ™å¯é€šè¿‡æ’ä»¶å‚æ•°<code>sign_params</code>è‡ªå®šä¹‰ï¼‰ï¼›</li>
<li>ä½¿ç”¨<code>secret_key</code>å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œ HMAC-SHA256 åŠ å¯†ï¼Œå¾—åˆ°ç­¾åå€¼ï¼›</li>
<li>è¯·æ±‚å¤´æºå¸¦ï¼š<code>X-HMAC-AccessKey: AK123456</code>ã€<code>X-HMAC-Timestamp: 1690000000</code>ã€<code>X-HMAC-Nonce: abc123</code>ã€<code>X-HMAC-Signature: ç­¾åå€¼</code>ã€‚</li>
</ul>
<h4 data-id="heading-4">1.2 JWT ä»¤ç‰ŒéªŒç­¾ï¼ˆ<code>jwt-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>åˆ†å¸ƒå¼</strong> <strong>ç³»ç»Ÿã€ç”¨æˆ·è®¤è¯</strong>åœºæ™¯ï¼Œå®¢æˆ·ç«¯å…ˆé€šè¿‡ç™»å½•æ¥å£è·å– JWT ä»¤ç‰Œï¼Œåç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼Œç½‘å…³é€šè¿‡å…¬é’¥éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§ï¼ˆæ”¯æŒå¯¹ç§° / éå¯¹ç§°åŠ å¯†ï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumer å¹¶é…ç½®</strong> <strong>JWT</strong> <strong>å‚æ•°</strong>ç¤ºä¾‹ï¼ˆå¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨<code>secret</code>éªŒè¯ï¼›éå¯¹ç§°åŠ å¯†éœ€é…ç½®<code>public_key</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">curl http:<span class="hljs-comment">//apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"user_001"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"jwt-auth"</span>: {
      <span class="hljs-string">"secret"</span>: <span class="hljs-string">"jwt_secret_123"</span>,  <span class="hljs-meta"># å¯¹ç§°å¯†é’¥ï¼ˆéå¯¹ç§°åŠ å¯†ç”¨public_keyæ›¿ä»£ï¼‰</span>
      <span class="hljs-string">"algorithm"</span>: <span class="hljs-string">"HS256"</span>,  <span class="hljs-meta"># ç®—æ³•ï¼ˆHS256=å¯¹ç§°ï¼ŒRS256=éå¯¹ç§°ï¼‰</span>
      <span class="hljs-string">"exp"</span>: <span class="hljs-number">3600</span>,  <span class="hljs-meta"># ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</span>
      <span class="hljs-string">"token_header"</span>: <span class="hljs-string">"Authorization"</span>,  <span class="hljs-meta"># æºå¸¦ä»¤ç‰Œçš„è¯·æ±‚å¤´ï¼ˆå¦‚Bearer Tokenï¼‰</span>
      <span class="hljs-string">"token_prefix"</span>: <span class="hljs-string">"Bearer "</span>  <span class="hljs-meta"># ä»¤ç‰Œå‰ç¼€ï¼ˆå¦‚"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."ï¼‰</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route ç»‘å®š</strong> <strong><code>jwt-auth</code></strong> <strong>æ’ä»¶</strong>ç¡®ä¿è¯·æ±‚éœ€æºå¸¦æœ‰æ•ˆ JWT ä»¤ç‰Œæ‰èƒ½è®¿é—®ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">curl http://apisix-admin:<span class="hljs-number">9180</span>/apisix/admin/routes/<span class="hljs-number">2</span> -X PUT -d <span class="hljs-comment">'</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/user/*"</span>,
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.101:8080"</span>: <span class="hljs-number">1</span>}},
  <span class="hljs-string">"plugins"</span>: {<span class="hljs-string">"jwt-auth"</span>: {}}
}<span class="hljs-comment">'</span>
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<ul>
<li>ç™»å½•è·å– JWT ä»¤ç‰Œï¼šå®¢æˆ·ç«¯é€šè¿‡ç™»å½•æ¥å£ï¼ˆå¦‚<code>/login</code>ï¼‰æäº¤è´¦å·å¯†ç ï¼Œä¸Šæ¸¸æœåŠ¡ç”Ÿæˆ JWT ä»¤ç‰Œï¼ˆä½¿ç”¨<code>secret</code>ç­¾åï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>åç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼šè¯·æ±‚å¤´æ·»åŠ <code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code>ï¼ŒAPISIX éªŒè¯ä»¤ç‰Œç­¾ååŠè¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<h3 data-id="heading-5">æ–¹å¼ 2ï¼šè‡ªå®šä¹‰ Lua æ’ä»¶ï¼ˆé€‚åˆå¤æ‚è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ï¼‰</h3>
<p>è‹¥å†…ç½®æ’ä»¶æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚ç‰¹æ®Šç­¾åç®—æ³•ã€å¤æ‚éªŒç­¾é€»è¾‘ï¼‰ï¼Œå¯åŸºäº APISIX çš„<strong>Lua æ’ä»¶å¼€å‘æ¡†æ¶</strong>ç¼–å†™è‡ªå®šä¹‰éªŒç­¾æ’ä»¶ï¼Œå®Œå…¨æ§åˆ¶éªŒç­¾æµç¨‹ã€‚</p>
<p>æ ¸å¿ƒå¼€å‘æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»ºæ’ä»¶ç›®å½•ä¸æ–‡ä»¶</strong>APISIX æ’ä»¶é»˜è®¤å­˜æ”¾åœ¨<code>/usr/local/apisix/plugins/</code>ç›®å½•ï¼Œæ–°å»ºè‡ªå®šä¹‰æ’ä»¶æ–‡ä»¶ï¼ˆå¦‚<code>custom-sign.lua</code>ï¼‰ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ç¼–å†™æ’ä»¶æ ¸å¿ƒé€»è¾‘</strong>æ’ä»¶éœ€å®ç°<code>rewrite</code>ï¼ˆè¯·æ±‚è½¬å‘å‰æ‰§è¡Œï¼‰æˆ–<code>access</code>ï¼ˆæƒé™æ ¡éªŒé˜¶æ®µï¼‰æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­ç¼–å†™éªŒç­¾é€»è¾‘ã€‚ç¤ºä¾‹ï¼ˆè‡ªå®šä¹‰ HMAC éªŒç­¾æ’ä»¶æ ¸å¿ƒä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">local <span class="hljs-attr">core</span> = require(<span class="hljs-string">"apisix.core"</span>)local hmac = require(<span class="hljs-string">"resty.hmac"</span>)-- æ’ä»¶Schemaï¼ˆå®šä¹‰é…ç½®å‚æ•°ï¼Œå¦‚secret_keyã€sign_headerï¼‰local schema = {
  <span class="hljs-attr">type</span> = <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">properties</span> = {
    <span class="hljs-attr">secret_key</span> = {type = <span class="hljs-string">"string"</span>},  -- å¯¹ç§°å¯†é’¥
    <span class="hljs-attr">sign_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Sign"</span>},  -- ç­¾åè¯·æ±‚å¤´
    <span class="hljs-attr">timestamp_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Timestamp"</span>}  -- æ—¶é—´æˆ³è¯·æ±‚å¤´},
  <span class="hljs-attr">required</span> = {<span class="hljs-string">"secret_key"</span>}}-- æ’ä»¶ä¸»é€»è¾‘ï¼ˆaccessé˜¶æ®µæ‰§è¡Œï¼‰local function access(conf, ctx)-- <span class="hljs-number">1</span>. æå–è¯·æ±‚ä¸­çš„éªŒç­¾å‚æ•°local req_sign = core.request.header(ctx, conf.sign_header)local req_timestamp = core.request.header(ctx, conf.timestamp_header)local req_method = core.request.get_method(ctx)local req_uri = ctx.var.uri
  local <span class="hljs-attr">req_body</span> = core.request.get_body(ctx)  -- éœ€å¼€å¯bodyè¯»å–ï¼ˆåœ¨APISIXé…ç½®ä¸­è®¾ç½®ï¼‰-- <span class="hljs-number">2</span>. æ ¡éªŒå¿…è¦å‚æ•°æ˜¯å¦å­˜åœ¨if not req_sign or not req_timestamp thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"missing sign or timestamp"</span>}end-- <span class="hljs-number">3</span>. æ ¡éªŒæ—¶é—´æˆ³ï¼ˆé˜²é‡æ”¾ï¼Œå…è®¸<span class="hljs-number">5</span>åˆ†é’Ÿåå·®ï¼‰local current_ts = ngx.time()if math.abs(current_ts - tonumber(req_timestamp)) &gt; <span class="hljs-number">300</span> thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"timestamp expired"</span>}end-- <span class="hljs-number">4</span>. ç”Ÿæˆå¾…éªŒç­¾ä¸²ï¼ˆæŒ‰ä¸šåŠ¡è§„åˆ™æ‹¼æ¥ï¼‰local sign_str = string.format(<span class="hljs-string">"%s%s%s%s"</span>, req_method, req_uri, req_timestamp, req_body or <span class="hljs-string">""</span>)-- <span class="hljs-number">5</span>. è®¡ç®—HMACç­¾åå¹¶å¯¹æ¯”local hmac_obj = hmac:new(conf.secret_key, hmac.ALGOS.SHA256)local computed_sign = hmac_obj:final(sign_str, <span class="hljs-literal">true</span>)  -- <span class="hljs-literal">true</span>è¡¨ç¤ºè¿”å›hexæ ¼å¼if computed_sign ~= req_sign thenreturn <span class="hljs-number">403</span>, {message = <span class="hljs-string">"invalid signature"</span>}end-- <span class="hljs-number">6</span>. éªŒç­¾é€šè¿‡ï¼Œç»§ç»­è½¬å‘è¯·æ±‚returnend-- æ³¨å†Œæ’ä»¶return {
  <span class="hljs-attr">version</span> = <span class="hljs-number">0.1</span>,
  <span class="hljs-attr">priority</span> = <span class="hljs-number">2000</span>,  -- æ’ä»¶æ‰§è¡Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼‰
  <span class="hljs-attr">name</span> = <span class="hljs-string">"custom-sign"</span>,  -- æ’ä»¶åç§°
  <span class="hljs-attr">schema</span> = schema,
  <span class="hljs-attr">access</span> = access  -- ç»‘å®šaccessé˜¶æ®µæ‰§è¡Œ}
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å¯ç”¨è‡ªå®šä¹‰æ’ä»¶</strong></p>
<ul>
<li>åœ¨ APISIX é…ç½®æ–‡ä»¶ï¼ˆ<code>config.yaml</code>ï¼‰ä¸­æ·»åŠ æ’ä»¶åˆ°<code>plugins</code>åˆ—è¡¨ï¼Œç¡®ä¿ APISIX åŠ è½½æ’ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-markdown" lang="markdown">plugins:
<span class="hljs-bullet">  -</span> custom-sign  # æ·»åŠ è‡ªå®šä¹‰æ’ä»¶åç§°
<span class="hljs-bullet">  -</span> hmac-auth
<span class="hljs-bullet">  -</span> jwt-auth
</code></pre>
<ul>
<li>é‡å¯ APISIXï¼š<code>apisix restart</code>ï¼›</li>
<li>ä¸º Consumer å’Œ Route ç»‘å®š<code>custom-sign</code>æ’ä»¶ï¼ˆåŒå†…ç½®æ’ä»¶é…ç½®æ–¹å¼ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">æ–¹å¼ 3ï¼šé›†æˆå¤–éƒ¨éªŒç­¾æœåŠ¡ï¼ˆé€‚åˆéªŒç­¾é€»è¾‘ç‹¬ç«‹éƒ¨ç½²ï¼‰</h3>
<p>è‹¥éªŒç­¾é€»è¾‘å¤æ‚ï¼ˆå¦‚ä¾èµ–æ•°æ®åº“æŸ¥è¯¢å¯†é’¥ã€å¤šç³»ç»Ÿå…±äº«éªŒç­¾æœåŠ¡ï¼‰ï¼Œå¯é€šè¿‡ APISIX çš„<code>ext-plugin</code>ï¼ˆå¤–éƒ¨æ’ä»¶ï¼‰æˆ–<code>http-logger</code>+<code>request-validator</code>ï¼Œå°†éªŒç­¾è¯·æ±‚è½¬å‘åˆ°å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚ Java/Python ç¼–å†™çš„éªŒç­¾æœåŠ¡ï¼‰ï¼Œç”±å¤–éƒ¨æœåŠ¡è¿”å›éªŒç­¾ç»“æœï¼ŒAPISIX æ ¹æ®ç»“æœå†³å®šæ˜¯å¦æ”¾è¡Œã€‚</p>
<p>æ ¸å¿ƒå®ç°æ€è·¯ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰éƒ¨ç½²å¤–éƒ¨éªŒç­¾æœåŠ¡</strong></p>
<p>å¼€å‘ä¸€ä¸ªéªŒç­¾ APIï¼ˆå¦‚<code>http://sign-service:8080/verify</code>ï¼‰ï¼Œæ¥æ”¶ APISIX è½¬å‘çš„è¯·æ±‚å‚æ•°ï¼ˆå¦‚è¯·æ±‚å¤´ã€Bodyã€è·¯å¾„ï¼‰ï¼Œæ‰§è¡ŒéªŒç­¾é€»è¾‘ï¼Œè¿”å›<code>{"success": true/false, "message": "..."}</code>ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰APISIX é…ç½®è½¬å‘ä¸ç»“æœåˆ¤æ–­</strong>ä½¿ç”¨<code>ext-plugin</code>çš„<code>pre-req</code>ï¼ˆè¯·æ±‚å‰è°ƒç”¨å¤–éƒ¨æœåŠ¡ï¼‰åŠŸèƒ½ï¼Œæˆ–é€šè¿‡<code>proxy-rewrite</code>å°†è¯·æ±‚è½¬å‘åˆ°éªŒç­¾æœåŠ¡ï¼Œå†é€šè¿‡<code>response-rewrite</code>åˆ¤æ–­ç»“æœï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># ç¤ºä¾‹ï¼šä¸ºRouteé…ç½®å¤–éƒ¨éªŒç­¾æœåŠ¡curl http://apisix-admin:9180/apisix/admin/routes/3 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/pay/*"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"ext-plugin-pre-req"</span>: {
      <span class="hljs-string">"conf"</span>: [
        {
          <span class="hljs-string">"name"</span>: <span class="hljs-string">"ext-plugin-http"</span>,  <span class="hljs-comment"># è°ƒç”¨å¤–éƒ¨HTTPæœåŠ¡çš„æ’ä»¶</span>
          <span class="hljs-string">"value"</span>: '{<span class="hljs-string">"uri"</span>:<span class="hljs-string">"http://sign-service:8080/verify"</span>,<span class="hljs-string">"method"</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-string">"timeout"</span>:500}'
        }
      ]
    }
  },
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.102:8080"</span>: 1}}
}'
</code></pre>
<p>å¤–éƒ¨éªŒç­¾æœåŠ¡è¿”å›<code>success: false</code>æ—¶ï¼ŒAPISIX ç›´æ¥æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›é”™è¯¯ã€‚</p>
<h2 data-id="heading-7">3. éªŒç­¾é…ç½®çš„æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>å¯†é’¥ç®¡ç†</strong></p>
<ol>
<li>å¯¹ç§°å¯†é’¥ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>secret_key</code>ï¼‰éœ€é€šè¿‡ APISIX çš„<strong>é…ç½®ä¸­å¿ƒ</strong>ï¼ˆå¦‚ etcdã€Nacosï¼‰ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç ï¼›</li>
<li>éå¯¹ç§°åŠ å¯†ï¼ˆå¦‚ JWT RS256ï¼‰éœ€å®šæœŸè½®æ¢å…¬é’¥ / ç§é’¥ï¼Œç¡®ä¿å¯†é’¥å®‰å…¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>é˜²é‡æ”¾æ”»å‡»</strong></p>
<ol>
<li>å¿…é¡»åŠ å…¥ â€œæ—¶é—´æˆ³ + nonceâ€ æœºåˆ¶ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>clock_skew</code>å’Œ<code>nonce_header</code>ï¼‰ï¼Œé˜²æ­¢æ”»å‡»è€…å¤ç”¨æ—§ç­¾åï¼›</li>
<li>å¯é€šè¿‡ APISIX çš„<code>redis</code>æ’ä»¶ç¼“å­˜å·²ä½¿ç”¨çš„<code>nonce</code>ï¼Œé¿å…é‡å¤ä½¿ç”¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p>
<ol>
<li>è‡ªå®šä¹‰æ’ä»¶ä¸­é¿å…é¢‘ç¹ IO æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œå¯å°†å¯†é’¥ç¼“å­˜åˆ° APISIX æœ¬åœ°ï¼ˆå¦‚<code>core.lrucache</code>ï¼‰ï¼›</li>
<li>å¯¹äºå¤§ Body è¯·æ±‚ï¼ŒéªŒç­¾æ—¶å¯ä»…å¯¹ Body çš„å“ˆå¸Œå€¼ï¼ˆå¦‚ MD5ï¼‰è¿›è¡Œç­¾åï¼Œå‡å°‘æ•°æ®å¤„ç†é‡ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ—¥å¿—ä¸ç›‘æ§</strong></p>
<ol>
<li>å¯ç”¨ APISIX çš„<code>error-log-logger</code>å’Œ<code>access-logger</code>ï¼Œè®°å½•éªŒç­¾å¤±è´¥æ—¥å¿—ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰ï¼›</li>
<li>é€šè¿‡ APISIX çš„ç›‘æ§æ’ä»¶ï¼ˆå¦‚<code>prometheus</code>ï¼‰ç»Ÿè®¡éªŒç­¾æˆåŠŸç‡ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è¯·æ±‚ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-8">4. å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<ol>
<li>
<p><strong>éªŒç­¾å¤±è´¥ä½†å®¢æˆ·ç«¯ç¡®è®¤</strong> <strong>ç­¾å</strong> <strong>æ­£ç¡®</strong></p>
<ol>
<li>æ£€æŸ¥ â€œå¾…éªŒç­¾ä¸²â€ çš„æ‹¼æ¥è§„åˆ™æ˜¯å¦ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼ˆå¦‚å‚æ•°æ’åºã€æ˜¯å¦åŒ…å« Bodyã€å¤§å°å†™æ•æ„Ÿï¼‰ï¼›</li>
<li>ç¡®è®¤ APISIX æ˜¯å¦æ­£ç¡®è¯»å–è¯·æ±‚ Bodyï¼ˆéœ€åœ¨<code>config.yaml</code>ä¸­è®¾ç½®<code>proxy_body_temp_path</code>ï¼Œå¹¶ç¡®ä¿æ’ä»¶å¯ç”¨ Body è¯»å–ï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>JWT ä»¤ç‰ŒéªŒè¯å¤±è´¥</strong></p>
<ol>
<li>æ£€æŸ¥<code>algorithm</code>æ˜¯å¦åŒ¹é…ï¼ˆå¦‚å®¢æˆ·ç«¯ç”¨ HS256ï¼Œç½‘å…³é…ç½® RS256ï¼‰ï¼›</li>
<li>ç¡®è®¤ä»¤ç‰Œæœªè¿‡æœŸï¼ˆ<code>exp</code>å­—æ®µï¼‰ï¼Œä¸”<code>secret</code>/<code>public_key</code>ä¸å®¢æˆ·ç«¯ç­¾åæ—¶ä½¿ç”¨çš„å¯†é’¥ä¸€è‡´ã€‚</li>
</ol>
</li>
<li>
<p><strong>è‡ªå®šä¹‰æ’ä»¶ä¸ç”Ÿæ•ˆ</strong></p>
<ol>
<li>æ£€æŸ¥æ’ä»¶æ˜¯å¦æ·»åŠ åˆ° APISIX çš„<code>plugins</code>åˆ—è¡¨ä¸­ï¼›</li>
<li>é€šè¿‡ APISIX æ—¥å¿—ï¼ˆ<code>/usr/local/apisix/logs/error.log</code>ï¼‰æŸ¥çœ‹æ’ä»¶æ‰§è¡ŒæŠ¥é”™ä¿¡æ¯ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-9">5.å›¢é˜Ÿä»‹ç»</h2>
<p>ã€Œ<strong>æ™ºæ…§å®¶æŠ€æœ¯å¹³å°-åº”ç”¨è½¯ä»¶æ¡†æ¶å¼€å‘</strong>ã€ä¸»è¦è´Ÿè´£è®¾è®¡å·¥å…·çš„ç ”å‘ï¼ŒåŒ…æ‹¬è¥é”€è®¾è®¡å·¥å…·ã€å®¶ç”µVRè®¾è®¡å’Œå±•ç¤ºã€æ°´ç”µæš–é€šå‰ç½®è®¾è®¡èƒ½åŠ›ï¼Œç ”å‘å¹¶æ²‰æ·€ç´ æåº“ï¼Œæ„å»ºå®¶å±…å®¶è£…ç´ æåº“ï¼Œé›†æˆæˆ·å‹åº“ã€å…¨å“ç±»äº§å“åº“ã€è®¾è®¡æ–¹æ¡ˆåº“ã€ç”Ÿäº§å·¥è‰ºæ¨¡å‹ï¼Œæ‰“é€ åŸºäºæˆ·å‹å’Œé£æ ¼çš„AIè®¾è®¡èƒ½åŠ›ï¼Œå¿«é€Ÿç”Ÿæˆç®—é‡å’ŒæŠ¥ä»·ï¼›åŒæ—¶ç ”å‘äº†é—¨åº—è®¾è®¡å¸ˆä¸­å¿ƒå’Œé¡¹ç›®ä¸­å¿ƒï¼ŒåŒ…æ‹¬è®¾è®¡å¸ˆç®¡ç†èƒ½åŠ›å’Œé¡¹ç›®ç»ç†ç®¡ç†èƒ½åŠ›ã€‚å®ç°äº†åœºæ™¯å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒæ—¶ä¸ºæ°´ï¼Œç©ºæ°”ï¼Œå¨æˆ¿ç­‰äº§ä¸šæä¾›å•†æœºç®¡ç†å·¥å…·ï¼Œä»è€Œå®ç°äº†ä»¥åœºæ™¯è´¯ç©¿çš„Bç«¯Cç«¯å…¨æµç¨‹ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚]]></title>    <link>https://juejin.cn/post/7603574149776621620</link>    <guid>https://juejin.cn/post/7603574149776621620</guid>    <pubDate>2026-02-07T09:17:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776621620" data-draft-id="7596998306380644402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚"/> <meta itemprop="keywords" content="Spring Boot,Spring,åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T09:17:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æš®è‰²å¦–å¨†ä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/4292946760307655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4292946760307655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æš®è‰²å¦–å¨†ä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:17:57.000Z" title="Sat Feb 07 2026 09:17:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ <code>SpringBoot 3.4.1</code>ã€‚å®é™…ä¸Šåœ¨ç†Ÿæ‚‰ <code>SpringBoot</code> ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå¹¶ä¸èƒ½ç®—æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª <code>Spring</code> é¡¹ç›®çš„å¿«é€Ÿé›†æˆè„šæ‰‹æ¶ã€‚æå‰é…ç½®äº†ä¸€ç³»åˆ—å¯ä»¥å’Œ <code>Spring</code> æ•´åˆçš„ç¬¬ä¸‰æ–¹ç»„ä»¶ã€‚å®ƒåŸºäº <code>Spring</code> æ¡†æ¶åšäº†ä¸€ç³»åˆ—çš„æ‰©å±•ã€‚</p>
<p>æ‰€ä»¥å¦‚æœå·²ç»ç†Ÿæ‚‰ <code>Spring</code> æ ¸å¿ƒç»„ä»¶æºç çš„è¯ï¼Œå­¦ä¹  <code>SpringBoot</code> å°†ä¼šéå¸¸éå¸¸ç®€å•ï¼å¦‚æœå®Œå…¨æ²¡æœ‰ <code>Spring</code> çš„æºç ç»éªŒï¼Œç›´æ¥çœ‹ <code>SpringBoot</code> æºç  ï¼Œå¯èƒ½ä¼šå¾ˆåƒåŠ›ï¼Œå› ä¸ºæ¶‰åŠåˆ°å¤ªå¤š <code>Spring</code> çš„çŸ¥è¯†ï¼Œä¼šæ— æ³•ç†è§£ã€‚åŒ…æ‹¬ä½†ä¸é™äº <code>åç½®å¤„ç†å™¨ã€IOC å®¹å™¨ã€Spring äº‹ä»¶ã€èµ„æºåŠ è½½å™¨</code> ç­‰ï¼Œä¸è¿‡é—®é¢˜å€’ä¹Ÿä¸æ˜¯å¤ªå¤§ï¼Œåªè¦æ—¶é—´è¶³å¤Ÿï¼Œåªè¦çœ‹çš„æ¬¡æ•°å¤Ÿå¤šï¼Œç»ˆç©¶éƒ½èƒ½å¤ŸæŒæ¡ã€‚</p>
<h2 data-id="heading-1">SpringBoot &amp; Spring æ¶æ„å›¾ç¤ºæ¦‚è§ˆ</h2>
<p>è¿™é‡Œæˆ‘ä»¥ <code>SpringBoot</code> æºç å…¥å£ä¸ºèµ·ç‚¹ï¼Œç”»äº†ä¸€ä¸ªç›¸å…³çš„æµç¨‹å›¾ï¼ŒåŒ…å«äº† <code>SpringBootã€Spring äº‹åŠ¡ã€Spring AOPã€Spring äº‹ä»¶ã€BeanFactoryPostProcessorã€BeanPostProcessor</code> ç­‰æ‰€æœ‰ <code>Spring</code> çŸ¥è¯†ï¼Œä»¥åŠç›¸å…³æ¨¡å—ä¹‹é—´çš„äº¤äº’è”ç³»ï¼Œåç»­ä¹Ÿä¼šæŒç»­æ›´æ–°æ­¤å›¾ï¼ˆå› ä¸ºæˆ‘è‡ªå·±è¿˜æ²¡æœ‰å­¦å®Œï¼‰ï¼Œæˆ‘è¯•äº†ä¸‹ä½œè€…ä¾§è¿™è¾¹æ›´æ–°åï¼Œåˆ†äº«çš„åä½œé“¾æ¥ä¹Ÿä¼šå®æ—¶å˜æ›´ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.processon.com%2Fv%2F696465e679c29354e9e50f69" target="_blank" title="https://www.processon.com/v/696465e679c29354e9e50f69" ref="nofollow noopener noreferrer">SpringBoot &amp; Spring æ¶æ„å›¾ æŒç»­æ›´æ–°</a> å¯¹äºå³å°†éœ€è¦é¢è¯•çš„åŒå­¦åº”è¯¥ä¼šæ¯”è¾ƒæœ‰å¸®åŠ©ï¼</p>
<h2 data-id="heading-2">æºç è¯¯åŒº</h2>
<p>æˆ‘ä»¬å­¦ä¹ æºç ç»ä¸æ˜¯ä¸ºäº†ä¸€å¼€å§‹å°±æŠ±ç€ææ‡‚æ¯ä¸€è¡Œä»£ç çš„ç›®çš„ã€‚è€Œæ˜¯å…ˆçœ‹ä¸»è„‰ç»œï¼Œè¿™ä¸ªæµç¨‹å¤§æ¦‚å¹²äº†å“ªå‡ ä»¶å¤§äº‹å„¿ï¼Œ</p>
<div align="center">
  <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a37fbc73f71e42af986645a3e97eaadd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=e4Ekr75yfCaV1B0DPy%2BkSPxzID4%3D" alt="å›¾ç‰‡æè¿°" width="50%" loading="lazy"/>
</div>
<p>å°±åƒè¿™æ£µæ ‘ä¸€æ ·ï¼Œå…ˆæ‘¸æ¸…æ¥šä¸»æ ‘å¹²ï¼Œç„¶åå†ç»“åˆæˆ‘ä»¬å·¥ä½œä¸­çš„ä½¿ç”¨ç»éªŒï¼Œæ‰¾åˆ°ä¸€ä¸ªæ¡ˆä¾‹ï¼Œ<code>debug</code> çœ‹å®ƒå±äºå“ªä¸ªåˆ†æ”¯æµç¨‹ï¼Œå†å»ç»†çœ‹åˆ†æ”¯æµç¨‹ï¼Œ</p>
<p>åº”è¯¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤</p>
<ul>
<li>äº†è§£ä¸€ä¸ªæ¡†æ¶çš„ä¸»æµç¨‹</li>
<li>äº†è§£æŸä¸ªåˆ†æ”¯æµç¨‹</li>
<li>åœ¨è¿™ä¸ªåˆ†æ”¯æµç¨‹ä¸­å¯ä»¥è‡ªå®šä¹‰æ‰©å±•</li>
<li>æ£æ‘©ä½œè€…è¿™æ ·å®ç°çš„å¥½å¤„ï¼Œæœ‰æ²¡æœ‰æ›¿ä»£æ–¹å¼</li>
</ul>
<h2 data-id="heading-3">ä¸»æµç¨‹å›¾</h2>
<p>æˆ‘ä»¬é˜…è¯» <code>SpringApplication#run()</code> æ–¹æ³•å¯ä»¥å‘ç°å®ƒçš„å¤–å±‚ä»£ç å¾ˆç®€å•ã€‚æœ‰ä»¥ä¸‹å‡ ä¸ªå¤§æµç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4ce3789f0834e65a08e5ac3117d5b8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=T0%2FFr5UdBGx65k%2BAsJHmCo4NTHs%3D" alt="7d99e86f-2ac1-44c4-8b63-a70b0bce3778.png" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿™äº›å¤§æµç¨‹é‡Œé¢è¿˜æœ‰å¾ˆå¤šåˆ†æ”¯ã€‚ä¸‹é¢çš„ç« èŠ‚ï¼Œæˆ‘ä»¬ä¸€ä¸€è¯´æ˜è¿™äº›é˜¶æ®µã€‚</p>
<h2 data-id="heading-4">åˆ›å»º BootStrapContext</h2>
<h3 data-id="heading-5">ä»‹ç»</h3>
<p>å¯ä»¥æŸ¥çœ‹è¿™ä¸ªç±»çš„æ³¨é‡Šæˆ–è€… <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Fapi%2Fjava%2Forg%2Fspringframework%2Fboot%2Fbootstrap%2FBootstrapContext.html" target="_blank" title="https://docs.spring.io/spring-boot/api/java/org/springframework/boot/bootstrap/BootstrapContext.html" ref="nofollow noopener noreferrer">å®˜ç½‘ä»‹ç»</a> ï¼Œè¯´å®ƒæ˜¯ä¸€ä¸ªæ—©äº <code>Spring</code> ä¸Šä¸‹æ–‡ <code>ApplicationContext</code> åˆ›å»ºå‰åˆ›å»ºçš„ä¸´æ—¶å®¹å™¨ï¼Œå«åš <strong>å¼•å¯¼ä¸Šä¸‹æ–‡</strong>ï¼Œ<strong>å®ƒçš„å¯ç”¨æ—¶æœºæ˜¯ä» SpringBoot é¡¹ç›®å¯åŠ¨å¼€å§‹åˆ° Spring å®¹å™¨ ApplicationContext åˆ›å»ºä¹‹åï¼Œå‡†å¤‡å¥½ä¹‹å‰</strong></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹æºç ï¼Œç»“åˆæ³¨é‡Šæ¥çœ‹ï¼Œç¡®å®ç±»ä¼¼äºä¸€ä¸ª <code>Spring</code> å®¹å™¨ä¸Šä¸‹æ–‡ <code>ApplicationContext</code>ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * A simple bootstrap context that is available during startup and {<span class="hljs-doctag">@link</span> Environment}
 * post-processing up to the point that the {<span class="hljs-doctag">@link</span> ApplicationContext} is prepared.
 * &lt;p&gt;
 * Provides lazy access to singletons that may be expensive to create, or need to be
 * shared before the {<span class="hljs-doctag">@link</span> ApplicationContext} is available.
 *
 * <span class="hljs-doctag">@author</span> Phillip Webb
 * <span class="hljs-doctag">@since</span> 2.4.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BootstrapContext</span> {
    &lt;T&gt; T <span class="hljs-title function_">get</span><span class="hljs-params">(Class&lt;T&gt; type)</span> <span class="hljs-keyword">throws</span> IllegalStateException;
    &lt;T&gt; T <span class="hljs-title function_">getOrElse</span><span class="hljs-params">(Class&lt;T&gt; type, T other)</span>;
    &lt;T&gt; T <span class="hljs-title function_">getOrElseSupply</span><span class="hljs-params">(Class&lt;T&gt; type, Supplier&lt;T&gt; other)</span>;
    &lt;T, X <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Throwable</span>&gt; T <span class="hljs-title function_">getOrElseThrow</span><span class="hljs-params">(Class&lt;T&gt; type, Supplier&lt;? extends X&gt; exceptionSupplier)</span> <span class="hljs-keyword">throws</span> X;
    &lt;T&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">isRegistered</span><span class="hljs-params">(Class&lt;T&gt; type)</span>;
}
</code></pre>
<p>å¯ä»¥ä»è¿™ä¸ªå®¹å™¨ä¸­è·å–å¯¹è±¡ï¼Œå½“ç„¶æˆ‘ä»¬è¦æå‰é€šè¿‡æ³¨å†Œå™¨ <code>BootStrapResitry</code> å‘å…¶ä¸­æ³¨å†Œå¯¹è±¡ï¼Œå°±åƒ <code>BeanDefinitionRegistry</code> ä¸€æ ·</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BootstrapRegistry</span> {
    &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(Class&lt;T&gt; type, InstanceSupplier&lt;T&gt; instanceSupplier)</span>;
    &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerIfAbsent</span><span class="hljs-params">(Class&lt;T&gt; type, InstanceSupplier&lt;T&gt; instanceSupplier)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCloseListener</span><span class="hljs-params">(ApplicationListener&lt;BootstrapContextClosedEvent&gt; listener)</span>;
}
</code></pre>
<p>å®ƒçš„åˆ›å»ºå¾ˆç®€å•ï¼Œå°±æ˜¯ <code>new</code> äº†ä¸€ä¸ªå®ä¾‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> DefaultBootstrapContext <span class="hljs-title function_">createBootstrapContext</span><span class="hljs-params">()</span> {
    <span class="hljs-type">DefaultBootstrapContext</span> <span class="hljs-variable">bootstrapContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultBootstrapContext</span>();
    <span class="hljs-built_in">this</span>.bootstrapRegistryInitializers.forEach((initializer) -&gt; initializer.initialize(bootstrapContext));
    <span class="hljs-keyword">return</span> bootstrapContext;
}
</code></pre>
<p>ä» <code>createBootstrapContext()</code> çš„ç¬¬äºŒè¡Œä»£ç æˆ‘ä»¬å‘ç°ï¼Œåˆ›å»ºå®Œ <code>DefaultBootstrapContext</code> ä¹‹åä¼šè°ƒç”¨ä¸€ä¸ªåˆå§‹åŒ–å™¨åˆ—è¡¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®ç° <code>BootstrapRegistryInitializer</code> åˆ›å»ºè‡ªå®šä¹‰åˆå§‹åŒ–å™¨ã€‚æ¯”å¦‚ï¼Œåœ¨ <code>SpringBoot</code> å¯åŠ¨åï¼Œ<code>Spring</code> å®¹å™¨åˆ›å»ºå‰ï¼Œå‘ <code>BootStrapContext</code> é‡Œé¢å­˜æ”¾ä¸€äº›è‡ªå®šä¹‰çš„å¯¹è±¡ã€‚</p>
<p><strong>å¼•å¯¼ä¸Šä¸‹æ–‡</strong> åˆ›å»ºæˆåŠŸåä¼šé€šè¿‡ <code>EventPublishingRunListenerï¼ˆä¸‹ä¸€æ®µä¼šä»‹ç»ï¼‰</code> å‘å¸ƒä¸€ä¸ª <code>ApplicationStartingEvent</code> äº‹ä»¶</p>
<h3 data-id="heading-6">ä½¿ç”¨åœºæ™¯</h3>
<blockquote>
<p><strong>ç›®å‰è¿˜æ²¡å‘ç°æœ‰ä»€ä¹ˆå®é™…ä½¿ç”¨åœºæ™¯ï¼Œè¯„è®ºåŒºçŸ¥é“çš„å¯ä»¥åˆ†äº«ä¸€ä¸‹......</strong></p>
</blockquote>
<h3 data-id="heading-7">ä½¿ç”¨æ–¹å¼</h3>
<ul>
<li>ä½¿ç”¨ <code>SpringApplication</code> æ·»åŠ </li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">SpringApplicationBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpringApplicationBuilder</span>(SpringAiDemoApplication.class);
<span class="hljs-type">SpringApplication</span> <span class="hljs-variable">application</span> <span class="hljs-operator">=</span> builder.application();
application.addBootstrapRegistryInitializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyBootstrapRegistryInitializer</span>());
application.run(args);
</code></pre>
<ul>
<li>é…ç½® <code>spring.factories</code></li>
</ul>
<p>åœ¨ <code>resources</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>META-INF/spring.factories</code> ï¼Œç„¶åæ–‡ä»¶é…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">org.springframework.boot.BootstrapRegistryInitializer</span>=\
com.syc.springaidemo.config.MyBootstrapRegistryInitializer
</code></pre>
<p>é¡¹ç›®å¯åŠ¨å°±ä¼šæ‰§è¡Œ <code>MyBootstrapRegistryInitializer.initialize</code> ã€‚å…·ä½“åŸç†ä¸‹ä¸€ç« èŠ‚ä¼šè§£é‡Š</p>
<h2 data-id="heading-8">è·å– SpringApplicationRunListeners</h2>
<p><code>SpringApplicationRunListeners</code> æ˜¯ <code>SpringBoot</code> è¿è¡Œæµç¨‹é˜¶æ®µçš„ç›‘å¬å™¨é›†åˆåŒ…è£…ç±»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringApplicationRunListeners</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;SpringApplicationRunListener&gt; listeners;
    <span class="hljs-comment">//...</span>
}
</code></pre>
<blockquote>
<p>ä½¿ç”¨é›†åˆåŒ…è£…ç±»æ˜¯ä¸ºäº†æ‰©å±•ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é¢å¤–è‡ªå®šä¹‰å¤šä¸ª <code>SpringApplicationRunListener</code> åœ¨ <code>SpringBoot</code> å¯åŠ¨çš„ä¸åŒé˜¶æ®µæ¥åšæˆ‘ä»¬è‡ªå®šä¹‰çš„é€»è¾‘</p>
</blockquote>
<p>åŸå§‹ç±»/æ¥å£æ˜¯ <code>SpringApplicationRunListener</code>ã€‚å½“ <code>SpringBoot</code> æµç¨‹å¯åŠ¨è¿›è¡Œåˆ°ä¸åŒçš„é˜¶æ®µï¼Œéƒ½ä¼šè°ƒç”¨å¯¹åº”çš„é˜¶æ®µæ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SpringApplicationRunListener</span> {

    <span class="hljs-comment">/**
     * SpringBoot å¯åŠ¨ åˆ›å»º BootstrapContext ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">starting</span><span class="hljs-params">(ConfigurableBootstrapContext bootstrapContext)</span> {}
 
    <span class="hljs-comment">/**
     * SpringBoot ç¯å¢ƒå‡†å¤‡å¥½ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">environmentPrepared</span><span class="hljs-params">(ConfigurableBootstrapContext bootstrapContext,
          ConfigurableEnvironment environment)</span> {}
    
    <span class="hljs-comment">/**
     * SpringBoot ä¸Šä¸‹æ–‡å‡†å¤‡å¥½ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextPrepared</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> {}

    <span class="hljs-comment">/**
     * SpringBoot ä¸Šä¸‹æ–‡è¢«åŠ è½½åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoaded</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> {}

    <span class="hljs-comment">/**
     * Spring ä¸Šä¸‹æ–‡è¢«åˆ·æ–°åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">started</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {}

    <span class="hljs-comment">/**
     * Runner è°ƒç”¨å®Œåç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ready</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {}

    <span class="hljs-comment">/**
     * å‘ç”Ÿå¼‚å¸¸ç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">failed</span><span class="hljs-params">(ConfigurableApplicationContext context, Throwable exception)</span> {}

}
</code></pre>
<p>å¯ä»¥å‚è€ƒå®˜ç½‘ä»‹ç» <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Freference%2Ffeatures%2Fspring-application.html" target="_blank" title="https://docs.spring.io/spring-boot/reference/features/spring-application.html" ref="nofollow noopener noreferrer">Application Events and Listeners
</a></p>
<p>å…¶é»˜è®¤å®ç°ç±»æ˜¯ç³»ç»Ÿå†…ç½®çš„ <code>EventPublishingRunListener</code> ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼Œå‘ç°åœ¨è¿™äº›é˜¶æ®µ <code>SpringBoot</code> å‘å‡ºäº†å¯¹åº”çš„äº‹ä»¶</p>
<ul>
<li>
<p><code>ApplicationStartingEvent</code></p>
</li>
<li>
<p><code>ApplicationEnvironmentPreparedEvent</code></p>
</li>
<li>
<p><code>ApplicationContextInitializedEvent</code></p>
</li>
<li>
<p><code>ApplicationPreparedEvent</code></p>
</li>
<li>
<p><code>ApplicationStartedEvent</code></p>
</li>
<li>
<p><code>ApplicationReadyEvent</code></p>
</li>
<li>
<p><code>ApplicationFailedEvent</code></p>
</li>
</ul>
<p>ç„¶åæœ‰å†…ç½®çš„ç›‘å¬å™¨ä¼šç›‘å¬ï¼Œåšä¸€äº›å¯¹åº”çš„é€»è¾‘å¤„ç†</p>
<h3 data-id="heading-9">SpringBoot å†…ç½®çš„äº‹ä»¶ç›‘å¬å™¨</h3>
<p>æ­£å¦‚ä¸Šé¢ä»‹ç»çš„ä¸€æ ·,æœ‰ä¸€ä¸ªç›‘å¬å™¨é›†åˆå»ç›‘å¬ <code>SpringBoot</code> å¯åŠ¨æµç¨‹ä¸åŒé˜¶æ®µå‘å¸ƒçš„äº‹ä»¶,æˆ‘ä»¬ç»§ç»­è§‚å¯Ÿ <code>spring.factories</code> æ–‡ä»¶ï¼Œå‘ç°äº†ä¸‹é¢ä¸€ç³»åˆ—çš„ç›‘å¬å™¨ï¼Œæ³¨æ„çœ‹å®ƒä»¬çš„åŒ…åï¼Œæ˜¯å±äº <code>SpringBoot</code> çš„</p>
<pre><code class="hljs language-factories" lang="factories"># Application Listeners
org.springframework.context.ApplicationListener=\
org.springframework.boot.ClearCachesApplicationListener,\
org.springframework.boot.builder.ParentContextCloserApplicationListener,\
org.springframework.boot.context.FileEncodingApplicationListener,\
org.springframework.boot.context.config.AnsiOutputApplicationListener,\
org.springframework.boot.context.logging.LoggingApplicationListener,\
org.springframework.boot.env.EnvironmentPostProcessorApplicationListener
</code></pre>
<p>æ¯”å¦‚ä¸€ä¸ªå¾ˆé‡è¦çš„é˜¶æ®µå°±æ˜¯ç¯å¢ƒåˆ›å»ºå¹¶ä¸”å‡†å¤‡å¥½ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨ <code>SpringApplicationRunListener.environmentPrepared()</code> å‘å¸ƒ <code>ApplicationEnvironmentPreparedEvent</code> äº‹ä»¶ã€‚<code>EnvironmentPostProcessorApplicationListener</code> ä¼šå¯¹æ­¤äº‹ä»¶ç›‘å¬ï¼Œå¯¹ <code>Environment</code> åšä¸€äº›å¤„ç†ã€‚ä¸‹ä¸€éƒ¨åˆ†ç¯å¢ƒç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»å®ƒåˆ°åº•å¹²äº†ä»€ä¹ˆ</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„æ‰©å±•ç‚¹å°±æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªç›‘å¬å™¨ç±» <code>MyTestListener</code>ï¼Œç„¶åè‡ªå·±åœ¨é¡¹ç›®ç±»è·¯å¾„ä¸‹ä¹Ÿåˆ›å»ºä¸€ä¸ª <code>META-INF/spring.factories</code> æ–‡ä»¶ï¼ŒæŒ‰ç…§å’Œå®ƒä¸€æ ·çš„è§„åˆ™é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç›‘å¬å™¨ä¹Ÿä¼šç”Ÿæ•ˆ</p>
<h2 data-id="heading-10">spring.factories ä»‹ç»</h2>
<p>ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜æ˜¯ <code>EventPublishingRunListener</code> æ˜¯æ€æ ·åœ¨ <code>SpringBoot</code> æµç¨‹ä¸­å‘æŒ¥ä½œç”¨çš„ï¼ŸåŒ…æ‹¬æˆ‘ä»¬ä¸Šé¢é…ç½®è‡ªå®šä¹‰ <code>MyBootstrapRegistryInitializer</code> ã€‚ ä¸ºä»€ä¹ˆé…ç½®åœ¨ <code>spring.factories</code> å°±èƒ½ç”Ÿæ•ˆï¼Ÿæˆ‘ä»¬æ²¡æœ‰æ˜¾ç¤ºçš„ä½¿ç”¨ <code>@Beanã€@Configuration</code> å»æ ‡æ³¨å®ƒä½œä¸ºä¸€ä¸ª <code>Spring Bean</code>ï¼Œæ›´ä½•å†µæ­¤æ—¶ <code>SpringBoot</code> è¿ç¯å¢ƒéƒ½è¿˜æ²¡æœ‰åˆ›å»ºï¼Œæ›´åˆ«è¯´ <code>Spring</code> å®¹å™¨äº†ï¼Œæ‰€ä»¥å³ä½¿ç”¨äº† <code>@Bean ã€@Configuration</code> æ­¤æ—¶ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚</p>
<p>è·Ÿè¸ªæºç æˆ‘ä»¬ä¼šå‘ç° <code>getRunListeners</code> å†…éƒ¨è°ƒç”¨äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java">SpringFactoriesLoader.forDefaultResourceLocation(getClassLoader()).load(type, argumentResolver)
</code></pre>
<p>ç»§ç»­è¿½è¸ªæˆ‘ä»¬ä¼šå‘ç°å®ƒè¯»å–äº†ä¸€ä¸ªå›ºå®šä½ç½®çš„æ–‡ä»¶ <code>FACTORIES_RESOURCE_LOCATION = META-INF/spring.factories</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/135f664f07fe4452aeb3b251c92f705e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=4SlT1zAzr2ATFpgzCXHDhpQaTPg%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_46aab477-c7af-435c-8624-b59431fca8b7.png" loading="lazy"/></p>
<p>è¿™éƒ¨åˆ†å…¶å®æ˜¯ <code>Spring</code> çš„å†…å®¹ï¼Œ<code>SpringFactoriesLoader</code> å°±æ˜¯è¯»å–ç±»è·¯å¾„ä¸‹æ‰€æœ‰ <code>META-INF/spring.factories</code> çš„é…ç½®ï¼Œå®ƒå¹¶ä¸ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ª <code>Bean</code> æ”¾å…¥ <code>Spring å®¹å™¨</code>ã€‚è€Œæ˜¯ä¸ºäº†è§£å†³åœ¨ <code>Spring å®¹å™¨</code> å¯åŠ¨å‰ï¼Œç”¨æˆ·æƒ³è¦é¢å¤–æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„é€»è¾‘ã€‚æ‰€ä»¥ <code>Spring</code> æä¾›äº†è¿™æ ·çš„ä¸€ä¸ªå…¥å£ï¼Œç³»ç»Ÿå†…éƒ¨ä¼šä½¿ç”¨ <code>SpringFactoriesLoader</code> è¯»å–æ”¾åˆ°ç±»è·¯å¾„ä¸‹ <code>spring.factories</code> æ–‡ä»¶é‡Œé¢çš„é…ç½®ç±»ï¼Œæ¥å®ç°åœ¨ <code>Spring</code> å®¹å™¨å‡†å¤‡å¥½ä¹‹å‰çš„ä¸€äº›éœ€è¦æ‰©å±•çš„åŠŸèƒ½ ã€‚</p>
<p><code>BootstrapRegistryInitializer</code> å’Œ <code>SpringApplicationRunListeners</code> éƒ½æ˜¯è¿™ä¸ªåŸç†ï¼Œæºç ä¸­å»æ‰§è¡Œè¿™äº›å¯æ‰©å±•ç»„ä»¶çš„æ—¶å€™ï¼Œéƒ½æ˜¯ä½¿ç”¨ <code>SpringFactoriesLoader</code> ä»é…ç½®æ–‡ä»¶é¢å¤–è¯»å–ï¼Œå…è®¸æˆ‘ä»¬è‡ªå·±æ‰©å±•ã€‚</p>
<h2 data-id="heading-11">spring.factories åŒçº§çš„å…¶ä»–æ–‡ä»¶</h2>
<p>ç›¸æ¯”äº <code>spring.factories</code>ï¼Œ<code>spring-boot-autoconfigure</code> ä¸‹æœ‰ä¸€äº›å…¶ä»–æ–‡ä»¶ä¹Ÿæœ‰ä¸åŒçš„ä½œç”¨</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09c405fd1cc44a3d877b073564140f3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=nsOts9NreI%2BPUTv37syVy8FdPVs%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">additional-spring-configuration-metadata.json</h3>
<p>è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†è®©æˆ‘ä»¬åœ¨ <code>application.yml</code> é‡Œé¢é…ç½®çš„å±æ€§å¯ä»¥è¢«å®šä½åˆ°ï¼Œå‡å¦‚æˆ‘ä»¬è¦åœ¨é…ç½®æ–‡ä»¶é‡Œé¢é…ç½®ä¸€äº›é <code>@ConfigurationPropeties</code> ç»‘å®šçš„å±æ€§ï¼Œé‚£ä¹ˆåœ¨é…ç½®æ–‡ä»¶é‡Œé¢å°±ä¼šæœ‰å‘Šè­¦ï¼Œè€Œä¸”ç‚¹å‡»é…ç½®æ— æ³•å®šä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b2a5d11758340c4b64ad119396dab11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=E1TOYVPP%2BxaYpr6IFeJN4J3Uz7U%3D" alt="image.png" loading="lazy"/></p>
<p>ä½†æ˜¯æˆ‘ä»¬åœ¨ <code>META-INF</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>additional-spring-configuration-metadata.json</code> æ–‡ä»¶ï¼Œé…ç½®ä¸‹é¢è¿™æ®µå†…å®¹</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"aliyun.filePath"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"java.lang.String"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç¬¬ä¸‰æ–¹æœåŠ¡çš„ API æ–‡ä»¶è·¯å¾„"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶åå†å»çœ‹ <code>application.yml</code> é…ç½®æ–‡ä»¶å°±æ²¡æœ‰è¿™ä¸ªå‘Šè­¦äº†ï¼Œå¹¶ä¸”ç‚¹å‡»å·¦é”®ä¹Ÿèƒ½è·³è½¬åˆ°æˆ‘ä»¬å®šä¹‰çš„ <code>json</code> æ–‡ä»¶å†…</p>
<h3 data-id="heading-13">spring-autoconfigure-metadata.properties</h3>
<p>è¿™ä¸ªæ–‡ä»¶æ˜¯æ¯”è¾ƒæœ‰å®é™…æ„ä¹‰çš„ï¼Œç‚¹è¿›å»æˆ‘ä»¬ä¼šå‘ç°è¿™é‡Œé¢é…ç½®äº† <code>SpringBoot</code> æ‰€æœ‰æ”¯æŒçš„ç¬¬ä¸‰æ–¹ç»„ä»¶çš„è‡ªåŠ¨é…ç½®ç±»ã€‚æˆ‘ä»¬ä»¥ <code>Redis</code> ä¸ºä¾‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcd12be433b748b0b25b748bf51eb15e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=CVCIz90%2FlJFOjEZp%2FTNmxabc8Gs%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªæ¡ä»¶é…ç½®ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯åœ¨ <code>SpringBoot</code> å¯åŠ¨çš„æ—¶å€™æ ¹æ®ç›®å‰çš„å®é™…çŠ¶æ€åˆ¤å®šä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»æ˜¯å¦éœ€è¦è¢« <code>JVM</code> åŠ è½½ï¼Œå¦‚æœä¸éœ€è¦å°±è·³è¿‡å»ã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨è¿™ä¸ªåº”ç”¨æ²¡æœ‰å¼•å…¥ <code>redis</code> ï¼Œæ ¹æœ¬ç”¨ä¸ç€ï¼Œé‚£ <code>SpringBoot</code> è¿˜å»è®© <code>JVM</code> åŠ è½½ <code>RedisAutoConfiguration</code> è¿™ä¸ªç±»ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯æµªè´¹èµ„æºï¼Ÿ</p>
<p>åœ¨è·å–æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»çš„è¿‡ç¨‹ä¸­ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åè¿‡æ»¤æ‰å½“å‰ä¸éœ€è¦åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œåªè¿”å›å®é™…éœ€è¦åŠ è½½çš„</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//org.springframework.boot.autoconfigure.AutoConfigurationImportSelector#getAutoConfigurationEntry</span>
<span class="hljs-keyword">protected</span> AutoConfigurationEntry <span class="hljs-title function_">getAutoConfigurationEntry</span><span class="hljs-params">(AnnotationMetadata annotationMetadata)</span> {
    <span class="hljs-keyword">if</span> (!isEnabled(annotationMetadata)) {
       <span class="hljs-keyword">return</span> EMPTY_ENTRY;
    }
    <span class="hljs-type">AnnotationAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> getAttributes(annotationMetadata);
    <span class="hljs-comment">//æ‰«æ imports æ–‡ä»¶ï¼ˆåé¢çš„ç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»ï¼‰</span>
    List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);
    configurations = removeDuplicates(configurations);
    Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);
    checkExcludedClasses(configurations, exclusions);
    configurations.removeAll(exclusions);
    <span class="hljs-comment">//è¯»å– spring-autoconfigure-metadata.properties è¿‡æ»¤å½“å‰ä¸éœ€è¦åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»</span>
    configurations = getConfigurationClassFilter().filter(configurations);
    fireAutoConfigurationImportEvents(configurations, exclusions);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AutoConfigurationEntry</span>(configurations, exclusions);
}
</code></pre>
<h3 data-id="heading-14">spring-configuration-metadata.json</h3>
<p>è¿™ä¸ªæ–‡ä»¶é‡Œé¢é…ç½®äº†æ‰€æœ‰ <code>SpringBoot</code> è‡ªåŠ¨é…ç½®ç»„ä»¶çš„å±æ€§å­—æ®µï¼Œä»…ä»…æ˜¯ä¸€ä¸ªæç¤ºæ–‡æ¡£ï¼Œä¾‹å¦‚å…¶ä¸­å¯¹äº <code>AOP</code> çš„é…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"spring.aop.proxy-target-class"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"java.lang.Boolean"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Whether subclass-based (CGLIB) proxies are to be created (true), as opposed to standard Java interface-based proxies (false)."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"defaultValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å°±æ˜¯å‘Šè¯‰æˆ‘ä»¬å¼€å‘è€…è¿™ä¸ªå­—æ®µé»˜è®¤å€¼æ˜¯ <code>true</code>ï¼Œè¿™ä¸ªå­—æ®µçš„ä½œç”¨æ˜¯ <code>description</code> çš„å†…å®¹ã€‚</p>
<h2 data-id="heading-15">åˆ›å»ºå’Œå‡†å¤‡ç¯å¢ƒ Environment</h2>
<p>åˆ›å»ºä¸€ä¸ª <code>SpringBoot Web</code> ç¯å¢ƒä¸‹çš„ç‰¹å®šç¯å¢ƒå¯¹è±¡ <code>ApplicationServletEnvironment</code>ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡</p>
<ul>
<li>èµ„æºåˆ—è¡¨ ï¼š å­˜å‚¨å½“å‰ç¯å¢ƒä¸­æœ‰å“ªäº›èµ„æº</li>
<li>èµ„æºè§£æå™¨ ï¼š ä»å½“å‰ç¯å¢ƒä¸­è·å–èµ„æºæ—¶æä¾›è§£ææ–¹å¼</li>
</ul>
<p>è¿™é‡Œ <code>debug</code> å»æŸ¥çœ‹åˆ›å»º <code>Environment</code> çš„è°ƒç”¨é“¾ä¼šæœ‰ä¸€ç‚¹å¤æ‚ï¼Œå› ä¸ºèµ°äº†ä¸€ç³»åˆ—çš„çˆ¶ç±»æ„é€ æ–¹æ³•ã€‚é¡ºåºå¦‚ä¸‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationServletEnvironment</span>()  
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardServletEnvironment</span>()
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardEnvironment</span>()
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">AbstractEnvironment</span>() 
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">AbstractEnvironment</span>(MutablePropertySources propertySources)

</code></pre>
<p><code>AbstractEnvironment</code> çš„æ„é€ æ–¹æ³•ä¸­ä¼šç»™èµ„æºåˆ—è¡¨ä¸­æ·»åŠ ä¸€äº›åˆå§‹èµ„æºã€åˆ›å»ºå±æ€§èµ„æºè§£æå™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-title function_">AbstractEnvironment</span><span class="hljs-params">(MutablePropertySources propertySources)</span> {
    <span class="hljs-built_in">this</span>.propertySources = propertySources;
    <span class="hljs-built_in">this</span>.propertyResolver = createPropertyResolver(propertySources);
    customizePropertySources(propertySources);
}
</code></pre>
<h3 data-id="heading-16">å±æ€§èµ„æºåˆ—è¡¨</h3>
<p>ç¯å¢ƒåˆ›å»ºä¹‹åä¼šåˆå§‹åŒ–ä¸€ä¸ªå±æ€§èµ„æºåˆ—è¡¨åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªå†…å®¹ï¼Œçœç•¥ <code>StubPropertySource</code> è¿™æ˜¯ä¸€ä¸ªå ä½çš„æŠ½è±¡èµ„æºç±»ï¼Œåç»­ä¼šè¢«æ›¿æ¢ä¸ºå®é™…èµ„æº</p>
<ul>
<li><code>PropertiesPropertySource</code> ä» <code>System.getProperties()</code> è·å– <code>JVM</code> çº§åˆ«çš„ç³»ç»Ÿå±æ€§</li>
<li><code>SystemEnvironmentPropertySource</code> ä» <code>System.getEnv()</code> è·å–æ“ä½œç³»ç»Ÿçº§åˆ«çš„ç¯å¢ƒå˜é‡</li>
</ul>
<p>å®Œå…¨å¯åŠ¨ä¹‹åï¼Œç¯å¢ƒä¸­æœ‰ä»¥ä¸‹èµ„æº</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0822c919862d441786513ce9ee4ff29c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=i3lDG7tZoKJ5NN531GOBulfDBW8%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_aaa8bfaf-2cb9-4ff7-90ca-381db115627d.png" loading="lazy"/></p>
<p>æ ¹æ®è¿™ä¸ª <code>debug</code> é¢æ¿æˆ‘ä»¬å‡ ä¹å…¨éƒ¨èƒ½çŒœå‡ºä»–ä»¬çš„èµ„æºç±»å‹ã€‚</p>
<h3 data-id="heading-17">å±æ€§èµ„æºè§£æå™¨</h3>
<p>ä¸ºä»€ä¹ˆéœ€è¦èµ„æºè§£æå™¨ï¼Ÿæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ˜¯ <code>${spring.cloud.client.ip-address}</code> è¿™ç§æ ¼å¼ï¼Œèµ„æºè§£æå™¨å°±å¯ä»¥è§£æè¿™ç§æ ¼å¼çš„é…ç½®ï¼Œæ‰¾åˆ°æ­£ç¡®çš„å€¼ã€‚åˆæˆ–è€…æˆ‘ä»¬ä»ç¯å¢ƒé‡Œé¢è·å–èµ„æºçš„æ—¶å€™è·å–çš„ä¸æ˜¯ <code>String</code> ç±»å‹ï¼Œéœ€è¦æ™ºèƒ½è½¬æ¢æˆå®ä½“å¯¹è±¡æˆ–è€…å…¶ä»–ç±»å‹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//org.springframework.core.env.AbstractEnvironment#getProperty()</span>

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key, Class&lt;T&gt; targetType, T defaultValue)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.propertyResolver.getProperty(key, targetType, defaultValue);
}
</code></pre>
<p>å±æ€§è§£æå™¨ <code>this.propertyResolver</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//ConfigurationPropertySourcesPropertyResolver#getProperty() è¿™ä¸ªåå­—çœŸæ˜¯é•¿ï¼</span>

<span class="hljs-keyword">private</span> &lt;T&gt; T <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key, Class&lt;T&gt; targetValueType, <span class="hljs-type">boolean</span> resolveNestedPlaceholders)</span> {
    <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> findPropertyValue(key);<span class="hljs-comment">//éå†èµ„æºåˆ—è¡¨</span>
    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) {
       <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">if</span> (resolveNestedPlaceholders &amp;&amp; value <span class="hljs-keyword">instanceof</span> String string) {
       value = resolveNestedPlaceholders(string);<span class="hljs-comment">//è§£æå ä½ç¬¦ {}ã€[]ã€()</span>
    }
    <span class="hljs-keyword">try</span> {
       <span class="hljs-keyword">return</span> convertValueIfNecessary(value, targetValueType);ã€<span class="hljs-comment">//ç±»å‹è½¬æ¢</span>
    }
    <span class="hljs-keyword">catch</span> (ConversionFailedException ex) {
       <span class="hljs-type">Exception</span> <span class="hljs-variable">wrappedCause</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidConfigurationPropertyValueException</span>(key, value,
             <span class="hljs-string">"Failed to convert to type "</span> + ex.getTargetType(), ex.getCause());
       <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConversionFailedException</span>(ex.getSourceType(), ex.getTargetType(), ex.getValue(), wrappedCause);
    }
}
</code></pre>
<p>è§£æå ä½ç¬¦çš„åŸç†å°±æ˜¯ä»å·²ç»å­˜åœ¨çš„å±æ€§èµ„æºåˆ—è¡¨ä¸­ï¼Œå»æŸ¥è¯¢å ä½ç¬¦é‡Œç»™å®šçš„ <code>key</code> ã€‚æ¯”å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬é…ç½®ä¸€ä¸ª
<code>special-key:${spring.cloud.client.ip-address:192.168.1.1}</code> ã€‚é‚£ <code>special-key</code> æœ€ç»ˆçš„å€¼æ€ä¹ˆæ¥å‘¢ï¼Œå…ˆå»å½“å‰ç¯å¢ƒ <code>Environment</code> çš„æ‰€æœ‰å±æ€§èµ„æºåˆ—è¡¨ä¸­æŸ¥è¯¢å­—æ®µåæ˜¯ <code>spring.cloud.client.ip-address</code> çš„å˜é‡çš„å€¼ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±å–è¿™ä¸ªå€¼ï¼Œæ‰¾ä¸åˆ°å°±å–å†’å·åé¢çš„ä½œä¸ºé»˜è®¤å€¼ã€‚</p>
<h3 data-id="heading-18">ç±»å‹è½¬æ¢æœåŠ¡ ApplicationConversionService</h3>
<p>ç”¨äºç±»å‹è½¬æ¢ã€‚æœ€å…¸å‹çš„ç”¨æ³•å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ <code>@ConfigurationProperties</code> æ¥æ˜ å°„é…ç½®æ–‡ä»¶å’Œé…ç½®å¯¹è±¡ç»‘å®š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ConfigurationProperties(prefix = "syc")</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBindProperty</span> {
    <span class="hljs-keyword">private</span> Duration expireTime;
}
</code></pre>
<p>é…ç½®æ–‡ä»¶é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">syc:</span>
  <span class="hljs-attr">expireTime:</span> <span class="hljs-string">7d</span>
</code></pre>
<p>å°±èƒ½æ­£ç¡®æ˜ å°„åˆ° <code>TestBindProperty Bean</code> å¯¹è±¡ä¸­ï¼Œèµ‹å€¼ç»™ <code>Duration</code> ç±»å‹çš„å­—æ®µï¼Œå®ƒçš„è½¬æ¢æ˜¯é€šè¿‡ <code>ApplicationConversionService</code> å†…éƒ¨çš„è½¬æ¢å™¨å®ç°çš„ï¼Œ<code>org.springframework.core.convert.support</code> åŒ…ä¸‹å®šä¹‰äº†å„ç§ç±»å‹è½¬æ¢å™¨ï¼Œè€Œ <code>SpringBoot</code> åŒ…ä¸‹åˆé¢å¤–æ‰©å±•äº†ä¸€äº›è½¬æ¢å™¨ï¼Œä¾‹å¦‚ <code>org.springframework.boot.convert.StringToDurationConverter</code>ã€‚</p>
<blockquote>
<p><code>SpringMVC</code> ä¸­ï¼Œæˆ‘ä»¬ <code>@Contoller</code> æ ‡æ³¨çš„æ§åˆ¶å™¨ä¸­ï¼Œä»å®¢æˆ·ç«¯ä¼ é€’çš„å‚æ•°ä¹Ÿèƒ½è‡ªåŠ¨è½¬æ¢æˆå¯¹è±¡æˆ–è€…ï¼Œ<code>String</code> è½¬ <code>Longã€Integer</code>ï¼ŒåŸç†æ˜¯é€šè¿‡å„ç§å‚æ•°è§£æå™¨ <code>HandlerMethodArgumentResolver</code>ï¼Œè€Œå‚æ•°è§£æå™¨å†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡ç±»å‹è½¬æ¢æœåŠ¡ï¼Œè¿›è€Œé€šè¿‡å„ç§ <code>Converter</code> æ¥å®ç°çš„ã€‚</p>
</blockquote>
<h3 data-id="heading-19">ç¯å¢ƒåç½®å¤„ç†å™¨</h3>
<p>ç¯å¢ƒåç½®å¤„ç†å™¨ <code>EnvironmentPostProcessor</code>ï¼Œé€šè¿‡ç›‘å¬ç¯å¢ƒå‡†å¤‡å¥½äº‹ä»¶ï¼Œåœ¨è¿™é‡Œä¼šæ‰§è¡Œä¸€äº›åç½®å¤„ç†å™¨ï¼Œå¾€å½“å‰ <code>Environment</code> é‡Œé¢æ·»åŠ æ›´å¤šçš„å±æ€§èµ„æºï¼Œæ¯”å¦‚è§£ææˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ <code>application.yml</code>ï¼Œæ­¤æ—¶å¤šäº†ä¸€ä¸ªé…ç½®æ–‡ä»¶èµ„æºã€‚æ¯”å¦‚å‘ç¯å¢ƒä¸­æ·»åŠ éšæœºæ•°èµ„æºï¼Œä¾¿äºæˆ‘ä»¬åœ¨ <code>application.yml</code> é…ç½®æ–‡ä»¶ä¸­éœ€è¦ç»™æŸä¸ªå€¼é…ç½®éšæœºæ•°ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹ <code>spring.factories</code> æ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Environment Post Processors</span>
<span class="hljs-attr">org.springframework.boot.env.EnvironmentPostProcessor</span>=\
org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\
org.springframework.boot.context.config.ConfigDataEnvironmentPostProcessor,\
org.springframework.boot.env.RandomValuePropertySourceEnvironmentPostProcessor,\
org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\
org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\
org.springframework.boot.reactor.ReactorEnvironmentPostProcessor
</code></pre>
<p>é€šè¿‡è¿™äº›åç½®å¤„ç†å™¨çš„åå­—æˆ‘ä»¬å¤§è‡´èƒ½çŒœåˆ°ä½œç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ <code>debug</code> è°ƒè¯•æºç ã€‚ä¾‹å¦‚ <code>ConfigDataEnvironmentPostProcessor</code> å°±æ˜¯è¯»å– <code>application.yml</code> é…ç½®å†…å®¹çš„ç¯å¢ƒåç½®å¤„ç†å™¨</p>
<h2 data-id="heading-20">æ‰“å° Banner</h2>
<p>åœ¨æ§åˆ¶å°æˆ–è€…æ—¥å¿—æ–‡ä»¶é‡Œé¢æ‰“å°ä¸€ä¸ªæ¨ªå¹…ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">  .   <span class="hljs-strong">____</span>          _            __ _ _
 /\\ / <span class="hljs-strong">__<span class="hljs-emphasis">_'_</span> __</span> _ <span class="hljs-emphasis">_(_</span>)_ __  __ _ \ \ \ \
( ( )\<span class="hljs-strong">___ | '_ | '<span class="hljs-emphasis">_| | '_</span> \/ <span class="hljs-emphasis">_` | \ \ \ \
 \\/  _</span>__</span>)| |<span class="hljs-emphasis">_)| | | | | || (_</span>| |  ) ) ) )
  '  |<span class="hljs-strong">____</span>| .<span class="hljs-strong">__|<span class="hljs-emphasis">_| |_</span>|<span class="hljs-emphasis">_| |_</span>\__</span>, | / / / /
 =========|<span class="hljs-emphasis">_|==============|<span class="hljs-strong">___/=/_/_/_/

 :: Spring Boot ::                (v3.4.1)
</span></span></code></pre>
<p>é€»è¾‘å¾ˆç®€å•ï¼Œè§‚å¯Ÿæºç ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Banner <span class="hljs-title function_">getTextBanner</span><span class="hljs-params">(Environment environment)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> environment.getProperty(BANNER_LOCATION_PROPERTY, DEFAULT_BANNER_LOCATION);
    <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.resourceLoader.getResource(location);
    <span class="hljs-keyword">if</span> (resource.exists()){...}
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>å¦‚æœè¿™ä¸ªä½ç½® <code>DEFAULT_BANNER_LOCATION = banner.txt</code> å­˜åœ¨æŒ‡å®šæ–‡ä»¶ï¼Œå°±æ‰“å°è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨ç³»ç»Ÿå†…ç½®çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„æ–‡æœ¬å›¾æ¡ˆã€‚è§‚å¯Ÿåˆ° <code>location</code> æ˜¯ä»ç¯å¢ƒå˜é‡é‡Œé¢è·å–çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>application.yml</code> ä¸­é…ç½® <code>spring.banner.location</code> æ¥ä»»æ„æŒ‡å®š <code>banner</code> æ–‡ä»¶çš„èµ„æºä½ç½®ã€‚</p>
<h2 data-id="heading-21">åˆ›å»ºå’Œå‡†å¤‡ Spring ä¸Šä¸‹æ–‡</h2>
<p>ç¯å¢ƒå‡†å¤‡å¥½ä¹‹åå°±å¼€å§‹åˆ›å»º <code>Spring</code> ä¸Šä¸‹æ–‡ <code>ApplicationContext</code> äº†ã€‚è¿™é‡Œåœ¨ <code>Web</code> ç¯å¢ƒä¸­åˆ›å»ºçš„æ˜¯<code>AnnotationConfigServletWebServerApplicationContext</code>ï¼Œå®ƒæ˜¯ <code>SpringBoot</code> æ‰©å±•çš„ä¸€ä¸ª <code>ApplicationContext</code> çš„å®ç°ç±»ã€‚</p>
<h3 data-id="heading-22">æ³¨å†Œ BeanFactoryBostProcessorã€BeanBostProcessor</h3>
<p>ä¸Šä¸‹æ–‡çš„æ„é€ æ–¹æ³•ä¸­ä¼šå®ä¾‹åŒ– <code>AnnotatedBeanDefinitionReader</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">AnnotationConfigServletWebServerApplicationContext</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">this</span>.reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnnotatedBeanDefinitionReader</span>(<span class="hljs-built_in">this</span>);
    <span class="hljs-built_in">this</span>.scanner = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathBeanDefinitionScanner</span>(<span class="hljs-built_in">this</span>);
}
</code></pre>
<p>è€Œ <code>AnnotatedBeanDefinitionReader</code> çš„æ„é€ æ–¹æ³•ä¸­ä¼šæ³¨å†Œä¸€äº›å†…ç½®çš„æ³¨è§£åç½®å¤„ç†å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">AnnotatedBeanDefinitionReader</span><span class="hljs-params">(BeanDefinitionRegistry registry, Environment environment)</span> {
    <span class="hljs-comment">//...</span>
    AnnotationConfigUtils.registerAnnotationConfigProcessors(<span class="hljs-built_in">this</span>.registry);
}
</code></pre>
<p>è¿™äº›å¤„ç†å™¨ä¼šåœ¨ <code>Spring</code> å®¹å™¨åˆ·æ–°è¿‡ç¨‹ä¸­è°ƒç”¨ï¼Œé€šè¿‡åç§°æˆ‘ä»¬åŸºæœ¬ä¸Šèƒ½çŒœåˆ°å®ƒçš„ä½œç”¨ï¼Œè¿™éƒ¨åˆ†å±äº <code>Spring</code> çš„å†…å®¹ï¼Œåé¢ <code>Spring</code> æºç æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
<pre><code class="hljs language-java" lang="java">ConfigurationClassPostProcessor  å¤„ç†æ‰€æœ‰é…ç½®æ³¨è§£ <span class="hljs-meta">@Componentscan</span>ã€<span class="hljs-meta">@Import</span>ã€<span class="hljs-meta">@Bean</span>ã€<span class="hljs-meta">@Component</span> ç­‰
AutowiredAnnotationBeanPostProcessor  å¤„ç† <span class="hljs-meta">@Autowired</span>
CommonAnnotationBeanPostProcessor     å¤„ç† <span class="hljs-meta">@PostConstruct</span>ã€<span class="hljs-meta">@Resource</span> ç­‰
PersistenceAnnotationBeanPostProcessor(å¦‚æœç”¨äº† JPA)
EventListenerMethodProcessor    å¤„ç† <span class="hljs-meta">@EventListener</span>
DefaultEventListenerFactory
</code></pre>
<p>åˆ›å»ºå®Œæ¯•åä¼šæ‰§è¡Œä¸€ä¸ªå‡†å¤‡æ–¹æ³• <code>org.springframework.boot.SpringApplication#prepareContext</code>ï¼Œå°±æ˜¯ç»™ <code>AnnotationConfigServletWebServerApplicationContext</code> çš„æˆå‘˜å˜é‡åšä¸€äº›åˆå§‹åŒ–èµ‹å€¼ã€‚</p>
<ul>
<li>è®¾ç½® <code>environment </code></li>
<li>æ‰§è¡Œ <code>ApplicationContextInitializer</code></li>
<li>å‘å¸ƒä¸Šä¸‹æ–‡ å‡†å¤‡ã€åŠ è½½äº‹ä»¶</li>
<li>ç­‰ç­‰</li>
</ul>
<h3 data-id="heading-23">æ‰§è¡Œ ApplicationContextInitializer</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ApplicationContextInitializer</span>&lt;C <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ConfigurableApplicationContext</span>&gt; {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">(C applicationContext)</span>;
}
</code></pre>
<p>è¿™ä¸ªåˆå§‹åŒ–å™¨è¢«è°ƒç”¨çš„æ—¶æœºæ˜¯ <code>Spring</code> ä¸Šä¸‹æ–‡è¢«åˆ·æ–°ä¹‹å‰ï¼Œå¯¹å®¹å™¨ä¸Šä¸‹æ–‡è¿›è¡Œä¸€äº›å¤„ç†æ“ä½œï¼Œæ¯”å¦‚ï¼Œæ·»åŠ  <code>BeanFactoryPostProcessorã€BeanPostProcessor</code> ç­‰ç­‰ã€‚æˆ‘ä»¬ä»¥ <code>SpringBoot</code> å†…ç½®çš„ä¸€ä¸ªåˆå§‹åŒ–å™¨ <code>SharedMetadataReaderFactoryContextInitializer</code> ä¸ºä¾‹ã€‚</p>
<p>åœ¨è¿™ä¸ªåˆå§‹åŒ–å™¨çš„å›è°ƒæ–¹æ³• <code>initialize()</code> ä¸­ï¼Œå‘ <code>ApplicationContext</code> ä¸­æ·»åŠ äº†ä¸€ä¸ª <code>BeanFactoryPostProcessor</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">(ConfigurableApplicationContext applicationContext)</span> {
    <span class="hljs-comment">//...</span>
    <span class="hljs-type">BeanFactoryPostProcessor</span> <span class="hljs-variable">postProcessor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CachingMetadataReaderFactoryPostProcessor</span>(applicationContext);
    applicationContext.addBeanFactoryPostProcessor(postProcessor);
}
</code></pre>
<p>è¿™ä¸ªåç½®å¤„ç†å™¨çš„ä½œç”¨æ˜¯å‘ <code>Spring</code> å®¹å™¨æ³¨å†Œä¸€ä¸ª <code>MetadataReaderFactory</code> çš„ <code>BeanDefinition</code>ã€‚å®ƒæ˜¯ä¸€ä¸ªç±»èµ„æºåŠ è½½çš„ç¼“å­˜ï¼Œ<code>Spring</code> å®¹å™¨å¯åŠ¨å’Œåˆ·æ–°è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªåœ°æ–¹éœ€è¦æ ¹æ® <code>className</code> åŠ è½½ç±»è·¯å¾„ä¸‹çš„èµ„æºï¼Œä¸ºäº†æé«˜æ•´ä½“æ€§èƒ½ï¼Œå·²åŠ è½½çš„èµ„æºå°†ä¼šè¢«ç¼“å­˜ã€‚å…·ä½“å®ç°ç±»æ˜¯ <code>ConcurrentReferenceCachingMetadataReaderFactory</code></p>
<h2 data-id="heading-24">åˆ·æ–° Spring å®¹å™¨</h2>
<p>è¿™éƒ¨åˆ†æ˜¯ <code>Spring</code> æµç¨‹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</p>
<ul>
<li>è°ƒç”¨ <code>BeanFactoryBostProcessor</code></li>
<li>æ³¨å†Œ <code>BeanPostProcessor</code></li>
<li>æå‰æ³¨å†Œä¸€äº›ç³»ç»Ÿå†…ç½®å•ä¾‹ <code>Bean</code></li>
<li>åˆ›å»º <code>Web</code> æœåŠ¡å™¨</li>
<li>å®ä¾‹åŒ–æ‰€æœ‰éå»¶è¿ŸåŠ è½½çš„å•ä¾‹ <code>Bean</code></li>
<li>è°ƒç”¨ <code>BeanPostProcessor</code></li>
<li>è°ƒç”¨ <code>LifecycleProcessor</code></li>
</ul>
<p>è¿™é‡Œå±äº <code>Spring</code> å†…å®¹ï¼Œä¸è¿‡å¤šä»‹ç»ï¼Œæ¯ä¸€æ­¥é‡Œé¢éƒ½æœ‰ä¸€ç³»åˆ—å¤æ‚çš„é€»è¾‘ï¼Œè¿™é‡Œåªæä¸¤ä¸ªé‡ç‚¹ <code>SpringBoot è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒ</code> å’Œ <code>å†…åµŒ Web æœåŠ¡å™¨</code></p>
<h3 data-id="heading-25">SpringBoot è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒ</h3>
<p>è¿™æ˜¯ <code>SpringBoot</code> çš„é«˜é¢‘é¢è¯•é¢˜ï¼Œå¾ˆå¤šäººä¼šå›ç­”è¯´å› ä¸ºæœ‰å¾ˆå¤šå®šåˆ¶å¥½çš„ <code>starter</code>ï¼Œä¹Ÿæœ‰å›ç­”è¯´ <code>@EnableAutoConfiguration</code> å¯ç”¨çš„æ‰€æœ‰è‡ªåŠ¨é…ç½®ï¼Œå…¶å®å¹¶æ²¡æœ‰è¯´åˆ°æ ¸å¿ƒç‚¹ä¸Šã€‚å…¶æ ¸å¿ƒåŸç†å°±æ˜¯ <code>@SpringBootApplication</code> å†…éƒ¨çš„ç»„åˆæ³¨è§£ <code>@Import(AutoConfigurationImportSelector.class)</code>ã€‚</p>
<p>è¿™éœ€è¦ç”¨åˆ° <code>Spring</code> çš„é…ç½®ç±»è§£æåŸç†ï¼Œä¸Šä¸€æ®µåˆ›å»ºä¸Šä¸‹æ–‡ <code>ApplicationContext</code> çš„æ—¶å€™ï¼Œæ³¨å†Œäº†ä¸€ä¸ª <code>BeanFactoryPostProcessor â†’ ConfigurationClassPostProcessor</code> ã€‚åœ¨æ‰§è¡Œå…¶ä¸­ä¸€ä¸ªåç½®å¤„ç†æ–¹æ³• <code>postProcessBeanDefinitionRegistry()</code> æ—¶ï¼Œä¼šæ ¹æ® <code>SpringBoot</code> æä¾›çš„ä¸»ç±»ä¸ºèµ·ç‚¹ï¼Œå¾ªç¯é€’å½’çš„è§£æå„ç§é…ç½®æ³¨è§£ã€‚</p>
<ul>
<li><code>@ComponentScan</code></li>
<li><code>@Componentã€@Service @Configuration</code> ç­‰</li>
<li><code>@Import</code></li>
</ul>
<p>è¿™ä¸ª <code>@Import</code> æ³¨è§£è§£æå°±æ˜¯é‡ç‚¹ã€‚å¦‚æœå‘ç°å€¼æ˜¯ä¸€ä¸ª <code>ImportSelector</code> ç±»å‹ï¼Œè§£æçš„æ—¶å€™ä¼šæ‰§è¡Œ
<code>selectImports</code> æ–¹æ³•è·å–éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ï¼Œ<code>AutoConfigurationImportSelector</code> æ˜¯ä¸€ä¸ªå»¶è¿Ÿå¯¼å…¥å™¨ï¼Œè·å–å¯¼å…¥ç±»çš„æ–¹å¼æ˜¯æ‰§è¡Œå†…éƒ¨ <code>Group</code> çš„ä¸¤ä¸ªæ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Group</span> {

    <span class="hljs-comment">/**
     * è·å–å¯¼å…¥ç±»é€»è¾‘
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">(AnnotationMetadata metadata, DeferredImportSelector selector)</span>;

    <span class="hljs-comment">/**
     * è¿”å›å¯¼å…¥ç±»åˆ—è¡¨
     */</span>
    Iterable&lt;Entry&gt; <span class="hljs-title function_">selectImports</span><span class="hljs-params">()</span>;
</code></pre>
<p>æˆ‘ä»¬ä¸€è·¯å®šä½ä¸‹å»çœ‹çœ‹å¯¼å…¥çš„é…ç½®ç±»åˆ—è¡¨åˆ°åº•æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ImportCandidates <span class="hljs-title function_">load</span><span class="hljs-params">(Class&lt;?&gt; annotation, ClassLoader classLoader)</span> {
    Assert.notNull(annotation, <span class="hljs-string">"'annotation' must not be null"</span>);
    <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoaderToUse</span> <span class="hljs-operator">=</span> decideClassloader(classLoader);
    <span class="hljs-type">String</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> String.format(LOCATION, annotation.getName());
    Enumeration&lt;URL&gt; urls = findUrlsInClasspath(classLoaderToUse, location);
    List&lt;String&gt; importCandidates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">while</span> (urls.hasMoreElements()) {
       <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> urls.nextElement();
       importCandidates.addAll(readCandidateConfigurations(url));
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImportCandidates</span>(importCandidates);
}
</code></pre>
<p><code>LOCATION = "META-INF/spring/%s.imports"</code> æˆ‘ä»¬å‘ç°å®ƒåŠ è½½äº†è¿™ä¸ªè·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œ<code>%s</code> æ˜¯å ä½ç¬¦ï¼Œç„¶åæˆ‘ä»¬å»è§‚å¯Ÿ <code>mybatisplusã€redisTemplate</code> ç­‰ç»„ä»¶çš„ <code>starter</code> ä¾èµ–åº“å°±ä¼šæ˜ç™½äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8e1106f48d14b7ba076dad1e2f99337~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=jhDNaRdvIAnuhqsb937OJyF24j8%3D" alt="df5d8555-167d-4dcd-890c-684d4f4e7062.png" loading="lazy"/></p>
<p>è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢é…ç½®çš„ç±»ä¸Šéƒ½ä½¿ç”¨äº† <code>@Configuration</code> ã€‚<code>Spring</code> å…ˆæŠŠ <code>META-INF/spring/%s.imports</code> æ–‡ä»¶é‡Œé¢çš„ç±»åŠ è½½ä¸ºé…ç½®ç±»ï¼Œç„¶åå†é€’å½’è§£æè¿™äº›é…ç½®ç±»å†…éƒ¨çš„é…ç½®æ³¨è§£ <code>@Importã€@ComponentScanã€@Bean</code> ç­‰ç­‰</p>
<blockquote>
<p>å…³äº Spring é€’å½’è§£æé…ç½®ç±»çš„é€»è¾‘åç»­ Spring ç³»åˆ—æ–‡ç« ä¼šè¯¦ç»†è¯´æ˜</p>
</blockquote>
<h3 data-id="heading-26">å†…åµŒ Web æœåŠ¡å™¨</h3>
<p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ›¾ç»é«˜é¢‘é¢è¯•é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼ ç»Ÿçš„æ–¹å¼è¦å•ç‹¬èµ·ä¸€ä¸ª <code>Tomcat</code> æœåŠ¡ï¼Œè€Œ <code>SpringBoot</code> é€šè¿‡ä¸€ä¸ª <code>main</code> æ–¹æ³•å°±èƒ½æä¾› <code>Web</code> æœåŠ¡ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ª <code>Web</code> æœåŠ¡å™¨ï¼Œæˆ‘ä»¬è‡ªå·±å®šä¹‰ä¸€ä¸ª <code>main</code> æ–¹æ³•ï¼Œå¦‚æœå†…éƒ¨åˆ›å»ºäº† <code>Web</code> æœåŠ¡å™¨ï¼Œé‚£æˆ‘ä»¬è¿™ä¸ªç¨‹åºä¹Ÿå¯ä»¥æä¾› <code>Web</code> æœåŠ¡ã€‚</p>
<p><code>SpringBoot3</code> æä¾›äº†ä¸‰ç§æ”¯æŒçš„ <code>Web</code> æœåŠ¡å™¨</p>
<ul>
<li><code>Tomcat</code></li>
<li><code>Undertow</code></li>
<li><code>Jetty</code></li>
</ul>
<p>é»˜è®¤æ˜¯ä½¿ç”¨ <code>Tomcat</code>ï¼Œå¯ä»¥æŸ¥çœ‹è‡ªåŠ¨é…ç½®ç±»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span>
<span class="hljs-meta">@ConditionalOnClass({ Servlet.class, Tomcat.class, UpgradeProtocol.class })</span>
<span class="hljs-meta">@ConditionalOnMissingBean(value = ServletWebServerFactory.class, search = SearchStrategy.CURRENT)</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmbeddedTomcat</span> {

    <span class="hljs-meta">@Bean</span>
    TomcatServletWebServerFactory <span class="hljs-title function_">tomcatServletWebServerFactory</span><span class="hljs-params">(
          ObjectProvider&lt;TomcatConnectorCustomizer&gt; connectorCustomizers,
          ObjectProvider&lt;TomcatContextCustomizer&gt; contextCustomizers,
          ObjectProvider&lt;TomcatProtocolHandlerCustomizer&lt;?&gt;&gt; protocolHandlerCustomizers)</span> {
       <span class="hljs-type">TomcatServletWebServerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TomcatServletWebServerFactory</span>();
       factory.getTomcatConnectorCustomizers().addAll(connectorCustomizers.orderedStream().toList());
       factory.getTomcatContextCustomizers().addAll(contextCustomizers.orderedStream().toList());
       factory.getTomcatProtocolHandlerCustomizers().addAll(protocolHandlerCustomizers.orderedStream().toList());
       <span class="hljs-keyword">return</span> factory;
    }

}
</code></pre>
<p>åˆ›å»º <code>Web</code> æœåŠ¡å™¨çš„ä»£ç åœ¨ <code>org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext#onRefresh</code> æ–¹æ³•ä¸­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onRefresh</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">super</span>.onRefresh();
    <span class="hljs-keyword">try</span> {
       createWebServer();
    }
    <span class="hljs-keyword">catch</span> (Throwable ex) {
       <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationContextException</span>(<span class="hljs-string">"Unable to start web server"</span>, ex);
    }
}
</code></pre>
<p>è¿™é‡Œæ‰§è¡Œå®Œæ¯•ä¹‹åè¿˜ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿˜éœ€è¦è°ƒç”¨ <code>org.springframework.boot.web.server.WebServer#start</code>ï¼Œè¿™ä¸€æ­¥è°ƒç”¨æ˜¯åœ¨åˆ·æ–° <code>Spring</code> å®¹å™¨çš„æœ€åä¸€æ­¥ï¼Œæ‰§è¡Œ <code>Lifecycle#start</code>ã€‚åç»­ <code>Spring</code> ç³»åˆ—ä¼šè¯¦ç»†è¯´æ˜ã€‚</p>
<h2 data-id="heading-27">è°ƒç”¨ Runner</h2>
<p><code>SpringBoot</code> æä¾›äº†ä¸€ä¸ª <code>Runner</code> æ¥å£ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®å®Œå…¨å¯åŠ¨åï¼Œä¹Ÿå°±æ˜¯ <code>Spring</code> å®¹å™¨å·²ç»åˆ·æ–°å®Œæˆï¼Œä¸‡äº‹å°±ç»ªä¹‹ååšä¸€äº›äº‹æƒ…ã€‚å®ƒæœ‰ä¸¤ä¸ªå­æ¥å£</p>
<ul>
<li><code>CommandLineRunner</code></li>
<li><code>ApplicationRunner</code></li>
</ul>
<p>ä¸¤è€…åŠŸèƒ½å¾ˆåƒï¼Œéƒ½æ˜¯åº”ç”¨å¯¹å¤–æä¾›æµé‡ä¹‹å‰ï¼ˆç†è®ºä¸Šï¼‰åšä¸€äº›äº‹æƒ…ã€‚åŒºåˆ«ç‚¹æ˜¯æ–¹æ³•å…¥å‚ä¸åŒ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestRunner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationRunner</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(ApplicationArguments args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(args);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestRunner2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandLineRunner</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(String... args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"TestRunner2 running..."</span>);
    }
}
</code></pre>
<p><code>ApplicationRunner</code> çš„å…¥å‚æ˜¯è¢« <code>SpringBoot</code> å¤„ç†è¿‡çš„ï¼Œæä¾›äº†ä¸€äº› <code>API</code> æ¥åˆ†åˆ«è·å–é€‰é¡¹å‚æ•°å’Œéé€‰é¡¹å‚æ•°ã€‚</p>
<blockquote>
<p>å…³äºé€‰é¡¹å‚æ•°å’Œéé€‰é¡¹å‚æ•°å¯ä»¥å‚è€ƒè¿™ä¸ªç±» <code>org.springframework.core.env.SimpleCommandLineArgsParser</code> çš„æ³¨é‡Šï¼Œè§„èŒƒå†™çš„å¾ˆæ¸…æ¥š</p>
</blockquote>
<h3 data-id="heading-28">AvailabilityChangeEvent</h3>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>Runner</code> è°ƒç”¨å®Œæ¯•ä¹‹åä¼šæ‰§è¡Œ <code>EventPublishingRunListener#ready</code> ï¼Œåœ¨æ­¤ä¹‹å‰å®¹å™¨åˆ·æ–°å®Œæ¯•è¿˜ä¼šè°ƒç”¨ <code>EventPublishingRunListener#started</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">started</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {
    context.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationStartedEvent</span>(<span class="hljs-built_in">this</span>.application, <span class="hljs-built_in">this</span>.args, context, timeTaken));
    AvailabilityChangeEvent.publish(context, LivenessState.CORRECT);
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ready</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {
    context.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationReadyEvent</span>(<span class="hljs-built_in">this</span>.application, <span class="hljs-built_in">this</span>.args, context, timeTaken));
    AvailabilityChangeEvent.publish(context, ReadinessState.ACCEPTING_TRAFFIC);
}
</code></pre>
<p>å…ˆå‘å¸ƒäº†ä¸€ä¸ª <code>ready</code> äº‹ä»¶ï¼Œç„¶åä¸‹ä¸€æ­¥æˆ‘ä»¬ç‚¹å‡»è¿›å»å‘ç°åˆå‘å¸ƒäº†ä¸€ä¸ªäº‹ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç›‘å¬å™¨
<code>org.springframework.boot.availability.ApplicationAvailabilityBean</code> ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(AvailabilityChangeEvent&lt;?&gt; event)</span> {
    Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AvailabilityState</span>&gt; type = getStateType(event.getState());
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.logger.isDebugEnabled()) {
       <span class="hljs-built_in">this</span>.logger.debug(getLogMessage(type, event));
    }
    <span class="hljs-built_in">this</span>.events.put(type, event);
}
</code></pre>
<p>å…¶ç›‘å¬æ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯å‘ä¸€ä¸ª <code>Map</code> ä¸­è®¾ç½®äº†å­˜æ´»æ ‡è®°å’Œå°±ç»ªæ ‡è®°ã€‚æˆ‘ä»¬æŸ¥çœ‹å°±ç»ªæ ‡è®° <code>org.springframework.boot.availability.ReadinessState</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ReadinessState</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AvailabilityState</span> {

    <span class="hljs-comment">/**
     * The application is ready to receive traffic.
     */</span>
    ACCEPTING_TRAFFIC,

    <span class="hljs-comment">/**
     * The application is not willing to receive traffic.
     */</span>
    REFUSING_TRAFFIC

}
</code></pre>
<p><code>ACCEPTING_TRAFFIC</code> çš„æ³¨é‡Šæ˜¯åº”ç”¨ç¨‹åºå‡†å¤‡æ¥å—æµé‡ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™æˆ‘è¿˜ä»¥ä¸º <code>SpringBoot</code> å†…éƒ¨ç”¨äº†ä»€ä¹ˆç¥ç§˜æœºåˆ¶ï¼Œæ§åˆ¶äº†å¿…é¡»æ‰§è¡Œå®Œæ¯• <code>Runner</code> æ¥å£åæ‰ä¼šè®©å†…åµŒçš„ <code>Tomcat</code> å¯¹å¤–æä¾› <code>web</code> æœåŠ¡ã€‚è€Œæˆ‘æµ‹è¯•ä¹‹åå‘ç°å¹¶ä¸æ˜¯</p>
<p><strong>è°ƒç”¨å®Œ <code>org.springframework.boot.web.embedded.tomcat.TomcatWebServer#start</code> æ–¹æ³•æ—¶å€™ï¼Œç¨‹åºå°±å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ã€‚</strong></p>
<p>åæ¥æŸ¥äº†å®˜ç½‘ä¹‹åå‘ç°ï¼Œè¿™ä¸ªæ ‡è®°æ˜¯ç»™ç±»ä¼¼ <code>K8S</code> è¿™ç§è¿ç»´å·¥å…·ç”¨çš„ã€‚å®ƒæ¨èæˆ‘ä»¬åœ¨å°±ç»ªæ ‡è®°ä¸º <code>ACCEPTING_TRAFFIC</code> ä¹‹åï¼Œå†å¯¹å¤–æä¾›æœåŠ¡ï¼Œå¤„ç†æµé‡ã€‚</p>
<h2 data-id="heading-29">å†è°ˆ SpringBoot</h2>
<p>ç°åœ¨æˆ‘ä»¬å†å›å¤´æ€è€ƒï¼Œ<code>SpringBoot</code> æ‰€æœ‰çš„åŠŸèƒ½éƒ½æ˜¯åŸºäº <code>Spring</code> æ ¸å¿ƒåŸç†è¿›è¡Œæ‰©å±•</p>
<ul>
<li>è‡ªåŠ¨é…ç½® <code>XxxAutoConfiguration</code> åŸºäº <code>Spring</code> çš„ <code>@Import</code> æ³¨è§£</li>
<li><code>ConditionalOnMissingBean</code> ç­‰ä¸€ç³»åˆ—æ¡ä»¶æ³¨è§£ï¼ŒåŸºäº <code>Spring</code> çš„ <code>@Conditional</code></li>
<li><code>@ConfigurationProperties</code> é…ç½®å±æ€§ç»‘å®šï¼ŒåŸºäº <code>Spring</code> çš„ç±»å‹è½¬æ¢å™¨ <code>org.springframework.core.convert.converter.Converter</code></li>
<li>å†…åµŒ <code>Web</code> å®¹å™¨ï¼ŒåŸºäºé‡å†™ <code>AbstractApplicationContext.onRefresh()</code></li>
<li>ç­‰ç­‰</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬æ‰ä¼šè¯´ï¼Œå®ƒä¸èƒ½ç®—æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œè€Œæ˜¯ä¸€ä¸ª <code>Spring</code> é¡¹ç›®çš„å¿«é€Ÿé›†æˆè„šæ‰‹æ¶</p>
<h2 data-id="heading-30">ç»“è¯­</h2>
<p>ç”±äºç¯‡å¹…é—®é¢˜ï¼Œå¾ˆå¤šä¸œè¥¿æ²¡æ³•ç»†èŠ‚çš„å»å±•å¼€è¯´ï¼Œæ¯•ç«Ÿ <code>Spring</code> ç›¸å…³çŸ¥è¯†å¤ªå¤šäº†ï¼Œè€Œä¸”ç¯ç¯ç›¸æ‰£ï¼Œè¿™é‡Œåšä¸»ä¹Ÿæ˜¯åœ¨å‡†å¤‡é¢è¯•æ‰€ä»¥æœ€è¿‘ä¼šæŠŠ <code>Spring</code> ç³»åˆ—çš„æ–‡ç« å…¨éƒ¨å†™å®Œï¼ŒåŒ…æ‹¬ä½†ä¸é™äº</p>
<ul>
<li><strong>BeanFactoryPostProcessor</strong></li>
<li><strong>BeanPostProcessor</strong></li>
<li><strong>Bean çš„ç”Ÿå‘½å‘¨æœŸ</strong></li>
<li><strong>Spring AOP åŸç†</strong></li>
<li><strong>Spring äº‹åŠ¡åŸç†</strong></li>
<li><strong>ç­‰ç­‰</strong></li>
</ul>
<h3 data-id="heading-31">å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹èµåŠ å…³æ³¨ï¼ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘ç»§ç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼</h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Requestsåº“å…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603282168137842707</link>    <guid>https://juejin.cn/post/7603282168137842707</guid>    <pubDate>2026-02-06T05:15:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603282168137842707" data-draft-id="7603352061505650694" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Requestsåº“å…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,Python"/> <meta itemprop="datePublished" content="2026-02-06T05:15:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å¼ è¯´æ•…äº‹"/> <meta itemprop="url" content="https://juejin.cn/user/741501567509111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Requestsåº“å…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/741501567509111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å¼ è¯´æ•…äº‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T05:15:00.000Z" title="Fri Feb 06 2026 05:15:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. åº“çš„æ¦‚è§ˆä¸æ ¸å¿ƒä»·å€¼</h2>
<p>æƒ³è±¡ä¸€ä¸‹,åœ¨ç½‘ç»œä¸–ç•Œä¸­,å¦‚æœä½ æƒ³ä¸å„ç§ç½‘ç«™å’ŒæœåŠ¡è¿›è¡Œé€šä¿¡,å°±åƒæ˜¯ç”¨ä¼ ç»Ÿçš„ä¿¡ä»¶å¾€æ¥ã€‚ä½ éœ€è¦æ‰‹åŠ¨æ‰“åŒ…æ•°æ®ã€ç¼–å†™åœ°å€ã€å¤„ç†å›å¤ç¼–ç ,è¿™äº›ç¹ççš„ç»†èŠ‚ä¼šè®©ç®€å•çš„ä»»åŠ¡å˜å¾—å¤æ‚ã€‚<code>requests</code>åº“æ­£æ˜¯ä¸ºè§£å†³è¿™äº›é—®é¢˜è€Œç”Ÿçš„å·¥å…·ã€‚</p>
<p>Requestsæ˜¯Pythonä¸­æœ€æµè¡Œçš„HTTPå®¢æˆ·ç«¯åº“,å®ƒçš„è®¾è®¡å“²å­¦æ˜¯"ä¸ºäººç±»è®¾è®¡"ã€‚å®ƒå°†å¤æ‚çš„HTTPåè®®ç»†èŠ‚å°è£…åœ¨ç®€æ´çš„APIä¹‹ä¸‹,è®©å¼€å‘è€…èƒ½å¤Ÿç”¨æœ€å°‘çš„ä»£ç å®Œæˆç½‘ç»œè¯·æ±‚ã€‚ä¸Pythonæ ‡å‡†åº“ä¸­çš„<code>urllib</code>ç›¸æ¯”,Requestsçš„ä½¿ç”¨ä½“éªŒæå‡äº†90%ä»¥ä¸Šâ€”â€”ä½ ä¸å†éœ€è¦æ‰‹åŠ¨å¤„ç†URLç¼–ç ã€è¡¨å•æ•°æ®åºåˆ—åŒ–ã€è¿æ¥æ± ç®¡ç†ç­‰åº•å±‚ç»†èŠ‚ã€‚</p>
<p>Requestsåœ¨Pythonç”Ÿæ€ç³»ç»Ÿä¸­å æ®ç€ä¸å¯æˆ–ç¼ºçš„åœ°ä½ã€‚æ®PyPIå®˜æ–¹ç»Ÿè®¡,å®ƒçš„ä¸‹è½½é‡æ¯æœˆè¶…è¿‡10äº¿æ¬¡,è¶…è¿‡50ä¸‡ä¸ªå¼€æºé¡¹ç›®ä¾èµ–å®ƒã€‚æ— è®ºæ˜¯è°ƒç”¨REST APIã€æ„å»ºç½‘ç»œçˆ¬è™«ã€è‡ªåŠ¨åŒ–æµ‹è¯•,è¿˜æ˜¯å¼€å‘å¾®æœåŠ¡å®¢æˆ·ç«¯,Requestséƒ½æ˜¯é¦–é€‰å·¥å…·ã€‚å®ƒæ”¯æŒHTTP/1.1çš„æ‰€æœ‰ç‰¹æ€§,åŒ…æ‹¬è¿æ¥æ± ç®¡ç†ã€CookieæŒä¹…åŒ–ã€SSLéªŒè¯ã€è‡ªåŠ¨å†…å®¹è§£ç ç­‰,è®©HTTPè¯·æ±‚å˜å¾—å‰æ‰€æœªæœ‰çš„ç®€å•ã€‚</p>
<h2 data-id="heading-1">2. ç¯å¢ƒæ­å»ºä¸"Hello, World"</h2>
<h3 data-id="heading-2">å®‰è£…è¯´æ˜</h3>
<p>Requestsä¸æ˜¯Pythonæ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†,éœ€è¦é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨pipå®‰è£…(æ¨è)</span>
pip install requests

<span class="hljs-comment"># ä½¿ç”¨condaå®‰è£…</span>
conda install requests

<span class="hljs-comment"># ä½¿ç”¨Pythonæ¨¡å—æ–¹å¼å®‰è£…</span>
python -m pip install requests
</code></pre>
<p>Requestså®˜æ–¹æ”¯æŒPython 3.9+ç‰ˆæœ¬,åŒæ—¶ä¹Ÿå…¼å®¹PyPyè§£é‡Šå™¨ã€‚å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°æƒé™é—®é¢˜,å¯ä»¥å°è¯•ä½¿ç”¨<code>--user</code>å‚æ•°æˆ–åˆ›å»ºè™šæ‹Ÿç¯å¢ƒã€‚</p>
<h3 data-id="heading-3">æœ€ç®€ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„"Hello, World"ç¤ºä¾‹,å±•ç¤ºå¦‚ä½•å‘é€GETè¯·æ±‚å¹¶è·å–å“åº”:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

<span class="hljs-comment"># å‘é€GETè¯·æ±‚åˆ°GitHub API</span>
response = requests.get(<span class="hljs-string">'https://api.github.com/events'</span>)

<span class="hljs-comment"># æ‰“å°å“åº”çŠ¶æ€ç </span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"çŠ¶æ€ç : <span class="hljs-subst">{response.status_code}</span>"</span>)

<span class="hljs-comment"># æ‰“å°å“åº”å†…å®¹çš„å‰100ä¸ªå­—ç¬¦</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å“åº”å†…å®¹: <span class="hljs-subst">{response.text[:<span class="hljs-number">100</span>]}</span>"</span>)
</code></pre>
<h3 data-id="heading-4">é€è¡Œè§£é‡Š</h3>
<ol>
<li><code>import requests</code> - å¯¼å…¥Requestsåº“,ä½¿å…¶åŠŸèƒ½åœ¨å½“å‰è„šæœ¬ä¸­å¯ç”¨ã€‚</li>
<li><code>response = requests.get('https://api.github.com/events')</code> - è°ƒç”¨<code>get()</code>æ–¹æ³•å‘GitHub APIå‘é€GETè¯·æ±‚,è¿”å›çš„<code>Response</code>å¯¹è±¡åŒ…å«äº†æœåŠ¡å™¨çš„å…¨éƒ¨å“åº”ä¿¡æ¯ã€‚</li>
<li><code>print(f"çŠ¶æ€ç : {response.status_code}")</code> - è®¿é—®<code>Response</code>å¯¹è±¡çš„<code>status_code</code>å±æ€§,è·å–HTTPçŠ¶æ€ç (200è¡¨ç¤ºæˆåŠŸ)ã€‚</li>
<li><code>print(f"å“åº”å†…å®¹: {response.text[:100]}")</code> - é€šè¿‡<code>text</code>å±æ€§è·å–å“åº”çš„æ–‡æœ¬å†…å®¹,å¹¶åˆ‡ç‰‡æ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦ã€‚</li>
</ol>
<h3 data-id="heading-5">è¿è¡Œç»“æœ</h3>
<p>ç¨‹åºè¿è¡Œåä¼šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹:</p>
<pre><code class="hljs language-json" lang="json">çŠ¶æ€ç <span class="hljs-punctuation">:</span> <span class="hljs-number">200</span>
å“åº”å†…å®¹<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"25698765432"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"PushEvent"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"actor"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12345678</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"login"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"userna
</span></code></pre>
<p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†Requestsçš„æ ¸å¿ƒä¼˜åŠ¿:ç”¨ä¸‰è¡Œä»£ç å°±å®Œæˆäº†ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚,è‡ªåŠ¨å¤„ç†äº†è¿æ¥å»ºç«‹ã€æ•°æ®ä¼ è¾“ã€å“åº”è§£ç ç­‰æ‰€æœ‰ç»†èŠ‚ã€‚</p>
<h2 data-id="heading-6">3. æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<p>Requestsåº“å›´ç»•å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µæ„å»º,ç†è§£è¿™äº›æ¦‚å¿µæœ‰åŠ©äºä½ æ›´çµæ´»åœ°ä½¿ç”¨å®ƒã€‚</p>
<h3 data-id="heading-7">3.1 è¯·æ±‚æ–¹æ³•(Request Methods)</h3>
<p>HTTPåè®®å®šä¹‰äº†å¤šç§è¯·æ±‚æ–¹æ³•,Requestsä¸ºæ¯ç§æ–¹æ³•éƒ½æä¾›äº†å¯¹åº”çš„å‡½æ•°:</p>
<ul>
<li><code>requests.get()</code> - è·å–èµ„æº</li>
<li><code>requests.post()</code> - æäº¤æ•°æ®</li>
<li><code>requests.put()</code> - æ›´æ–°èµ„æº(å®Œæ•´æ›¿æ¢)</li>
<li><code>requests.patch()</code> - æ›´æ–°èµ„æº(éƒ¨åˆ†ä¿®æ”¹)</li>
<li><code>requests.delete()</code> - åˆ é™¤èµ„æº</li>
<li><code>requests.head()</code> - è·å–å“åº”å¤´</li>
<li><code>requests.options()</code> - è·å–æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•</li>
</ul>
<h3 data-id="heading-8">3.2 å“åº”å¯¹è±¡(Response Object)</h3>
<p>æ¯æ¬¡è¯·æ±‚å,Requestséƒ½ä¼šè¿”å›ä¸€ä¸ª<code>Response</code>å¯¹è±¡,å®ƒåŒ…å«äº†æœåŠ¡å™¨çš„å®Œæ•´å“åº”ä¿¡æ¯:</p>
<ul>
<li><code>response.status_code</code> - HTTPçŠ¶æ€ç </li>
<li><code>response.text</code> - å“åº”çš„æ–‡æœ¬å†…å®¹(è‡ªåŠ¨è§£ç )</li>
<li><code>response.content</code> - å“åº”çš„å­—èŠ‚å†…å®¹(åŸå§‹äºŒè¿›åˆ¶)</li>
<li><code>response.json()</code> - å°†JSONå“åº”è§£æä¸ºPythonå­—å…¸</li>
<li><code>response.headers</code> - å“åº”å¤´ä¿¡æ¯(å­—å…¸å½¢å¼)</li>
<li><code>response.cookies</code> - æœåŠ¡å™¨è®¾ç½®çš„Cookie</li>
</ul>
<h3 data-id="heading-9">3.3 ä¼šè¯å¯¹è±¡(Session Object)</h3>
<p><code>Session</code>å¯¹è±¡å…è®¸ä½ åœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´ä¿æŒæŸäº›å‚æ•°(å¦‚Cookiesã€è®¤è¯ä¿¡æ¯),å¹¶å¤ç”¨TCPè¿æ¥,æ˜¾è‘—æé«˜æ€§èƒ½:</p>
<pre><code class="hljs language-python" lang="python">session = requests.Session()
session.headers.update({<span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'My App'</span>})

<span class="hljs-comment"># ç¬¬ä¸€ä¸ªè¯·æ±‚ä¼šä¿å­˜Cookies</span>
response1 = session.get(<span class="hljs-string">'https://httpbin.org/cookies/set/sessionid/123'</span>)

<span class="hljs-comment"># ç¬¬äºŒä¸ªè¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦ä¹‹å‰ä¿å­˜çš„Cookies</span>
response2 = session.get(<span class="hljs-string">'https://httpbin.org/cookies'</span>)
</code></pre>
<h3 data-id="heading-10">æ¦‚å¿µå…³ç³»å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[requestsåº“] --&gt; B[è¯·æ±‚æ–¹æ³•]
    A --&gt; C[å“åº”å¯¹è±¡]
    A --&gt; D[ä¼šè¯å¯¹è±¡]
    
    B --&gt; B1[get/post/put/deleteç­‰]
    B --&gt; B2[å‚æ•°ä¼ é€’: params/data/json]
    
    C --&gt; C1[status_code - çŠ¶æ€ç ]
    C --&gt; C2[text/content/json - å“åº”å†…å®¹]
    C --&gt; C3[headers/cookies - å…ƒä¿¡æ¯]
    
    D --&gt; D1[ä¿æŒCookieå’Œè®¤è¯ä¿¡æ¯]
    D --&gt; D2[å¤ç”¨TCPè¿æ¥]
    D --&gt; D3[æé«˜è¯·æ±‚æ€§èƒ½]
    
    B1 --&gt; C
    B2 --&gt; C
    D --&gt; B
</code></pre>
<p>è¿™ä¸ªå›¾è¡¨å±•ç¤ºäº†Requestsåº“çš„æ ¸å¿ƒæ¦‚å¿µåŠå…¶å…³ç³»:è¯·æ±‚æ–¹æ³•ç”¨äºå‘é€è¯·æ±‚,å“åº”å¯¹è±¡ç”¨äºæ¥æ”¶å’Œå¤„ç†æœåŠ¡å™¨çš„å›åº”,è€Œä¼šè¯å¯¹è±¡åˆ™åœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´æä¾›çŠ¶æ€ä¿æŒå’Œè¿æ¥å¤ç”¨ã€‚</p>
<h2 data-id="heading-11">4. å®æˆ˜æ¼”ç»ƒ:è§£å†³ä¸€ä¸ªå…¸å‹é—®é¢˜</h2>
<h3 data-id="heading-12">éœ€æ±‚åˆ†æ</h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢åº”ç”¨,èƒ½å¤Ÿè·å–æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å…è´¹çš„å¤©æ°”API,é€šè¿‡å‘é€HTTPè¯·æ±‚æ¥è·å–æ•°æ®,å¹¶è§£æè¿”å›çš„JSONå“åº”ã€‚</p>
<h3 data-id="heading-13">æ–¹æ¡ˆè®¾è®¡</h3>
<p>è¿™ä¸ªé¡¹ç›®å°†å±•ç¤ºRequestsåº“çš„å‡ ä¸ªæ ¸å¿ƒåŠŸèƒ½:</p>
<ol>
<li>ä½¿ç”¨<code>requests.get()</code>å‘é€å¸¦å‚æ•°çš„GETè¯·æ±‚</li>
<li>é€šè¿‡<code>params</code>å‚æ•°ä¼ é€’æŸ¥è¯¢å‚æ•°(åŸå¸‚åç§°)</li>
<li>ä½¿ç”¨<code>response.json()</code>è§£æJSONå“åº”</li>
<li>å®ç°é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æ•è·</li>
<li>å±•ç¤ºå“åº”æ•°æ®çš„æå–å’Œæ ¼å¼åŒ–</li>
</ol>
<h3 data-id="heading-14">ä»£ç å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> RequestException

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city</span>):
    <span class="hljs-string">"""
    è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯
    
    Args:
        city (str): åŸå¸‚åç§°,ä¾‹å¦‚"Beijing"æˆ–"Shanghai"
    
    Returns:
        dict: åŒ…å«å¤©æ°”ä¿¡æ¯çš„å­—å…¸,å¤±è´¥æ—¶è¿”å›None
    """</span>
    <span class="hljs-comment"># ä½¿ç”¨å…è´¹çš„å¤©æ°”API(ç¤ºä¾‹ä½¿ç”¨httpbin.orgæ¨¡æ‹Ÿ)</span>
    base_url = <span class="hljs-string">"https://httpbin.org/get"</span>
    params = {
        <span class="hljs-string">'city'</span>: city,
        <span class="hljs-string">'units'</span>: <span class="hljs-string">'metric'</span>
    }
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€GETè¯·æ±‚,è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º5ç§’</span>
        response = requests.get(base_url, params=params, timeout=<span class="hljs-number">5</span>)
        
        <span class="hljs-comment"># æ£€æŸ¥å“åº”çŠ¶æ€ç ,å¦‚æœä¸æ˜¯2xxåˆ™æŠ›å‡ºå¼‚å¸¸</span>
        response.raise_for_status()
        
        <span class="hljs-comment"># è§£æJSONå“åº”</span>
        data = response.json()
        
        <span class="hljs-comment"># æå–å¤©æ°”ä¿¡æ¯(è¿™é‡Œæ¨¡æ‹ŸçœŸå®APIçš„æ•°æ®ç»“æ„)</span>
        weather_info = {
            <span class="hljs-string">'city'</span>: data.get(<span class="hljs-string">'args'</span>, {}).get(<span class="hljs-string">'city'</span>, city),
            <span class="hljs-string">'temperature'</span>: <span class="hljs-number">25</span>,  <span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®</span>
            <span class="hljs-string">'condition'</span>: <span class="hljs-string">'æ™´æœ—'</span>,
            <span class="hljs-string">'humidity'</span>: <span class="hljs-number">45</span>,
            <span class="hljs-string">'wind_speed'</span>: <span class="hljs-number">3.2</span>
        }
        
        <span class="hljs-keyword">return</span> weather_info
        
    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: è¯·æ±‚è¶…æ—¶,æ— æ³•è·å–<span class="hljs-subst">{city}</span>çš„å¤©æ°”ä¿¡æ¯"</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.HTTPError <span class="hljs-keyword">as</span> err:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTPé”™è¯¯: <span class="hljs-subst">{err.response.status_code}</span>"</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> err:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚å‡ºé”™: <span class="hljs-subst">{err}</span>"</span>)
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""ä¸»å‡½æ•°:è·å–å¹¶æ˜¾ç¤ºå¤šä¸ªåŸå¸‚çš„å¤©æ°”"""</span>
    cities = [<span class="hljs-string">'Beijing'</span>, <span class="hljs-string">'Shanghai'</span>, <span class="hljs-string">'Guangzhou'</span>]
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å¤©æ°”æŸ¥è¯¢ç³»ç»Ÿ ===\n"</span>)
    
    <span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> cities:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£åœ¨æŸ¥è¯¢ <span class="hljs-subst">{city}</span> çš„å¤©æ°”..."</span>)
        weather = get_weather(city)
        
        <span class="hljs-keyword">if</span> weather:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n<span class="hljs-subst">{weather[<span class="hljs-string">'city'</span>]}</span> å¤©æ°”ä¿¡æ¯:"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ¸©åº¦: <span class="hljs-subst">{weather[<span class="hljs-string">'temperature'</span>]}</span>Â°C"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤©æ°”: <span class="hljs-subst">{weather[<span class="hljs-string">'condition'</span>]}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ¹¿åº¦: <span class="hljs-subst">{weather[<span class="hljs-string">'humidity'</span>]}</span>%"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  é£é€Ÿ: <span class="hljs-subst">{weather[<span class="hljs-string">'wind_speed'</span>]}</span> m/s"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    main()
</code></pre>
<h3 data-id="heading-15">è¿è¡Œè¯´æ˜</h3>
<ol>
<li>ç¡®ä¿å·²å®‰è£…Requestsåº“: <code>pip install requests</code></li>
<li>å°†ä»£ç ä¿å­˜ä¸º<code>weather_app.py</code></li>
<li>è¿è¡Œç¨‹åº: <code>python weather_app.py</code></li>
</ol>
<p>ç¨‹åºä¼šä¾æ¬¡æŸ¥è¯¢ä¸‰ä¸ªåŸå¸‚çš„å¤©æ°”ä¿¡æ¯,å¹¶æ ¼å¼åŒ–è¾“å‡ºç»“æœã€‚è™½ç„¶ç¤ºä¾‹ä½¿ç”¨äº†httpbin.orgæ¨¡æ‹Ÿæ•°æ®,ä½†ä»£ç ç»“æ„å¯ä»¥ç›´æ¥é€‚é…çœŸå®çš„å¤©æ°”API(å¦‚OpenWeatherMapã€å’Œé£å¤©æ°”ç­‰),åªéœ€ä¿®æ”¹<code>base_url</code>å’Œæ•°æ®æå–é€»è¾‘å³å¯ã€‚</p>
<h3 data-id="heading-16">å…³é”®ç‚¹è§£æ</h3>
<ul>
<li><strong>å‚æ•°ä¼ é€’</strong>: ä½¿ç”¨<code>params</code>å­—å…¸ä¼ é€’æŸ¥è¯¢å‚æ•°,Requestsä¼šè‡ªåŠ¨è¿›è¡ŒURLç¼–ç </li>
<li><strong>è¶…æ—¶è®¾ç½®</strong>: <code>timeout=5</code>å‚æ•°é˜²æ­¢è¯·æ±‚æ— é™æœŸç­‰å¾…</li>
<li><strong>é”™è¯¯å¤„ç†</strong>: ä½¿ç”¨<code>raise_for_status()</code>è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€ç ,å¹¶æ•è·å„ç±»å¼‚å¸¸</li>
<li><strong>JSONè§£æ</strong>: <code>response.json()</code>å°†JSONå“åº”ç›´æ¥è½¬æ¢ä¸ºPythonå­—å…¸</li>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>: å°†æ ¸å¿ƒåŠŸèƒ½å°è£…ä¸ºå‡½æ•°,ä¾¿äºå¤ç”¨å’Œæµ‹è¯•</li>
</ul>
<h2 data-id="heading-17">5. æœ€ä½³å®è·µä¸å¸¸è§é™·é˜±</h2>
<h3 data-id="heading-18">å¸¸è§é”™è¯¯åŠè§„é¿æ–¹æ³•</h3>
<h4 data-id="heading-19">é”™è¯¯1:ä¸æ£€æŸ¥çŠ¶æ€ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
data = response.json()  <span class="hljs-comment"># å¦‚æœçŠ¶æ€ç ä¸æ˜¯200,è¿™é‡Œå¯èƒ½æŠ›å‡ºå¼‚å¸¸</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€ç ,é2xxæ—¶æŠ›å‡ºHTTPError</span>
data = response.json()
</code></pre>
<h4 data-id="heading-20">é”™è¯¯2:ä¸è®¾ç½®è¶…æ—¶æ—¶é—´</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
<span class="hljs-comment"># å¦‚æœç½‘ç»œæ•…éšœæˆ–æœåŠ¡å™¨æ— å“åº”,ç¨‹åºä¼šæ— é™æœŸç­‰å¾…</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>, timeout=<span class="hljs-number">10</span>)
<span class="hljs-comment"># 10ç§’åè¶…æ—¶,æŠ›å‡ºTimeoutå¼‚å¸¸</span>
</code></pre>
<h4 data-id="heading-21">é”™è¯¯3:åœ¨å¾ªç¯ä¸­é‡å¤åˆ›å»ºä¼šè¯</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> url_list:
    response = requests.get(url)  <span class="hljs-comment"># æ¯æ¬¡éƒ½å»ºç«‹æ–°è¿æ¥,æ•ˆç‡ä½ä¸‹</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
<span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:
    <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> url_list:
        response = session.get(url)  <span class="hljs-comment"># å¤ç”¨è¿æ¥,æ€§èƒ½æ›´é«˜</span>
</code></pre>
<h3 data-id="heading-22">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li>
<p><strong>å§‹ç»ˆä½¿ç”¨ä¼šè¯(Session)</strong>: å¯¹äºå‘åŒä¸€åŸŸåå‘é€å¤šä¸ªè¯·æ±‚çš„åœºæ™¯,ä½¿ç”¨Sessionå¯ä»¥å¤ç”¨TCPè¿æ¥,å‡å°‘æ¡æ‰‹å¼€é”€,æé«˜æ€§èƒ½ã€‚</p>
</li>
<li>
<p><strong>åˆç†è®¾ç½®è¶…æ—¶</strong>: å»ºè®®ä¸ºæ‰€æœ‰è¯·æ±‚è®¾ç½®è¶…æ—¶å‚æ•°,å¯ä»¥ä½¿ç”¨å…ƒç»„åˆ†åˆ«è®¾ç½®è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶,ä¾‹å¦‚<code>timeout=(3, 10)</code>ã€‚</p>
</li>
<li>
<p><strong>å¤„ç†JSONè§£æå¼‚å¸¸</strong>: å¹¶éæ‰€æœ‰APIå“åº”éƒ½æ˜¯æœ‰æ•ˆçš„JSON,ä½¿ç”¨<code>response.json()</code>æ—¶åº”è¯¥æ•è·<code>JSONDecodeError</code>:</p>
</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json

<span class="hljs-keyword">try</span>:
    data = response.json()
<span class="hljs-keyword">except</span> json.JSONDecodeError:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å“åº”ä¸æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼"</span>)
    data = <span class="hljs-literal">None</span>
</code></pre>
<ol start="4">
<li><strong>ä½¿ç”¨User-Agentæ ‡è¯†</strong>: æŸäº›ç½‘ç«™ä¼šæ£€æŸ¥è¯·æ±‚å¤´ä¸­çš„User-Agent,å»ºè®®è®¾ç½®ä¸€ä¸ªåˆç†çš„æ ‡è¯†:</li>
</ol>
<pre><code class="hljs language-python" lang="python">headers = {
    <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'MyWeatherApp/1.0 (https://myapp.com)'</span>
}
response = requests.get(url, headers=headers)
</code></pre>
<ol start="5">
<li><strong>HTTPSè¯ä¹¦éªŒè¯</strong>: ç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥éªŒè¯SSLè¯ä¹¦,ä»…åœ¨æµ‹è¯•ç¯å¢ƒæˆ–ç‰¹å®šåœºæ™¯ä¸‹ç¦ç”¨:</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒ:éªŒè¯è¯ä¹¦(é»˜è®¤è¡Œä¸º)</span>
response = requests.get(<span class="hljs-string">'https://example.com'</span>)

<span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒ:ç¦ç”¨è¯ä¹¦éªŒè¯</span>
response = requests.get(<span class="hljs-string">'https://example.com'</span>, verify=<span class="hljs-literal">False</span>)
</code></pre>
<ol start="6">
<li><strong>ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯</strong>: APIå¯†é’¥ã€ä»¤ç‰Œç­‰æ•æ„Ÿä¿¡æ¯åº”è¯¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­,è€Œä¸æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç é‡Œ:</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os

api_key = os.environ.get(<span class="hljs-string">'MY_API_KEY'</span>)
headers = {<span class="hljs-string">'Authorization'</span>: <span class="hljs-string">f'Bearer <span class="hljs-subst">{api_key}</span>'</span>}
</code></pre>
<h3 data-id="heading-23">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>Requestsé»˜è®¤ä½¿ç”¨è¿æ¥æ± ,ä¼šè‡ªåŠ¨å¤„ç†Keep-Alive,æ— éœ€æ‰‹åŠ¨ç®¡ç†è¿æ¥</li>
<li>ä¸‹è½½å¤§æ–‡ä»¶æ—¶,ä½¿ç”¨<code>stream=True</code>å‚æ•°é€æ­¥è¯»å–,é¿å…å†…å­˜æº¢å‡º</li>
<li>å¤„ç†é‡å®šå‘æ—¶,å¯ä»¥é€šè¿‡<code>allow_redirects=False</code>ç¦ç”¨è‡ªåŠ¨é‡å®šå‘</li>
<li>å¯¹äºéœ€è¦è®¤è¯çš„API,ä¼˜å…ˆä½¿ç”¨Sessionå¯¹è±¡çš„<code>auth</code>å‚æ•°æˆ–<code>headers</code>å‚æ•°,è€Œä¸æ˜¯åœ¨æ¯ä¸ªè¯·æ±‚ä¸­é‡å¤è®¾ç½®</li>
</ul>
<h2 data-id="heading-24">6. è¿›é˜¶æŒ‡å¼•</h2>
<h3 data-id="heading-25">é«˜çº§åŠŸèƒ½</h3>
<p>Requestsæä¾›äº†è®¸å¤šé«˜çº§åŠŸèƒ½,å¯ä»¥åº”å¯¹å¤æ‚çš„HTTPäº¤äº’åœºæ™¯:</p>
<ul>
<li><strong>è®¤è¯å¤„ç†</strong>: æ”¯æŒBasicè®¤è¯ã€Digestè®¤è¯ã€OAuthç­‰å¤šç§è®¤è¯æ–¹å¼</li>
<li><strong>ä»£ç†é…ç½®</strong>: é€šè¿‡<code>proxies</code>å‚æ•°é…ç½®HTTP/SOCKSä»£ç†</li>
<li><strong>æµå¼ä¸Šä¼ /ä¸‹è½½</strong>: å¤„ç†å¤§æ–‡ä»¶ä¼ è¾“æ—¶é¿å…å†…å­˜é—®é¢˜</li>
<li><strong>äº‹ä»¶é’©å­</strong>: åœ¨è¯·æ±‚çš„ä¸åŒé˜¶æ®µæ³¨å†Œå›è°ƒå‡½æ•°</li>
<li><strong>è‡ªå®šä¹‰é€‚é…å™¨</strong>: å®ç°è‡ªå®šä¹‰çš„ä¼ è¾“åè®®æˆ–è¿æ¥é€»è¾‘</li>
</ul>
<h3 data-id="heading-26">ç”Ÿæ€æ‰©å±•</h3>
<p>Requestsçš„ç”Ÿæ€ä¸°å¯Œ,æœ‰è®¸å¤šæ‰©å±•åº“å¯ä»¥å¢å¼ºå…¶åŠŸèƒ½:</p>
<ul>
<li><code>requests-oauthlib</code>: OAuthè®¤è¯æ”¯æŒ</li>
<li><code>requests-cache</code>: å“åº”ç¼“å­˜,å‡å°‘é‡å¤è¯·æ±‚</li>
<li><code>requests-toolbelt</code>: å®ç”¨å·¥å…·é›†åˆ,å¦‚Multipartä¸Šä¼ ã€æµå¼è¯·æ±‚ç­‰</li>
<li><code>grequests</code>: åŸºäºgeventçš„å¼‚æ­¥è¯·æ±‚</li>
<li><code>requests-threads</code>: å¤šçº¿ç¨‹è¯·æ±‚æ”¯æŒ</li>
</ul>
<h3 data-id="heading-27">å­¦ä¹ è·¯å¾„</h3>
<p>å¦‚æœä½ æƒ³æ·±å…¥å­¦ä¹ Requests,å»ºè®®æŒ‰ä»¥ä¸‹è·¯å¾„è¿›è¡Œ:</p>
<ol>
<li><strong>æŒæ¡åŸºç¡€API</strong>: ç†Ÿæ‚‰æ‰€æœ‰è¯·æ±‚æ–¹æ³•å’ŒResponseå¯¹è±¡çš„å±æ€§</li>
<li><strong>ç†è§£HTTPåè®®</strong>: å­¦ä¹ HTTP/1.1è§„èŒƒ,ç†è§£çŠ¶æ€ç ã€è¯·æ±‚å¤´ã€å“åº”å¤´çš„å«ä¹‰</li>
<li><strong>æ¢ç´¢é«˜çº§ç‰¹æ€§</strong>: ç ”ç©¶Sessionå¯¹è±¡ã€è¿æ¥æ± ã€SSLéªŒè¯ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>é˜…è¯»æºä»£ç </strong>: Requestsçš„ä»£ç ç»“æ„æ¸…æ™°,é˜…è¯»æºç æœ‰åŠ©äºç†è§£å…¶å®ç°åŸç†</li>
<li><strong>å®è·µé¡¹ç›®</strong>: å¼€å‘ä¸€ä¸ªå®Œæ•´çš„çˆ¬è™«æˆ–APIå®¢æˆ·ç«¯é¡¹ç›®</li>
</ol>
<h3 data-id="heading-28">å­¦ä¹ èµ„æº</h3>
<ul>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python-requests.org" target="_blank" title="https://docs.python-requests.org" ref="nofollow noopener noreferrer">docs.python-requests.org</a> (æœ€æƒå¨ã€æœ€å®Œæ•´çš„èµ„æº)</li>
<li><strong>GitHubä»“åº“</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpsf%2Frequests" target="_blank" title="https://github.com/psf/requests" ref="nofollow noopener noreferrer">github.com/psf/requestâ€¦</a> (æºç ã€Issueã€è®¨è®º)</li>
<li><strong>Stack Overflow</strong>: æœç´¢æ ‡ç­¾[python-requests]æ‰¾åˆ°å¸¸è§é—®é¢˜çš„è§£ç­”</li>
<li><strong>ç¤¾åŒºåšå®¢</strong>: è®¸å¤šå¼€å‘è€…åˆ†äº«äº†Requestsçš„å®æˆ˜ç»éªŒå’ŒæŠ€å·§</li>
</ul>
<p>Requestsåº“çš„è®¾è®¡ç†å¿µæ˜¯"ç®€å•å³ç¾",ä½†å®ƒçš„èƒŒåæ˜¯HTTPåè®®çš„å¤æ‚æ€§å’Œç½‘ç»œç¼–ç¨‹çš„æŒ‘æˆ˜ã€‚æŒæ¡äº†Requests,ä½ å°±æŒæ¡äº†ä¸ç½‘ç»œä¸–ç•Œæ²Ÿé€šçš„åŸºæœ¬æŠ€èƒ½ã€‚ç»§ç»­æ¢ç´¢,ä½ ä¼šå‘ç°HTTPè¯·æ±‚çš„ä¸–ç•Œè¿œæ¯”ä½ æƒ³è±¡çš„æ›´åŠ ä¸°å¯Œå’Œæœ‰è¶£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7603263490342862857</link>    <guid>https://juejin.cn/post/7603263490342862857</guid>    <pubDate>2026-02-06T06:36:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490342862857" data-draft-id="7603393977476235290" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T06:36:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥å¥‡å°æ±¤åœ†"/> <meta itemprop="url" content="https://juejin.cn/user/1151943919285431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943919285431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥å¥‡å°æ±¤åœ†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T06:36:28.000Z" title="Fri Feb 06 2026 06:36:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ç°ä»£æœç´¢ä¸æ•°æ®åˆ†æåœºæ™¯ä¸­ï¼ŒElasticsearchï¼ˆä»¥ä¸‹ç®€ç§°ESï¼‰æ—©å·²æˆä¸ºæ ¸å¿ƒç»„ä»¶ï¼Œå¹¿æ³›åº”ç”¨äºæ—¥å¿—åˆ†æã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%2585%25A8%25E6%2596%2587%25E6%25A3%2580%25E7%25B4%25A2%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å…¨æ–‡æ£€ç´¢</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%2595%25B0%25E6%258D%25AE%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ•°æ®å¯è§†åŒ–</a>ç­‰é¢†åŸŸã€‚éšç€ES 9.Xç‰ˆæœ¬çš„æ­£å¼å‘å¸ƒï¼Œå…¶å®˜æ–¹Javaå®¢æˆ·ç«¯APIè¿æ¥äº†é‡å¤§æ›´æ–°â€”â€”<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3DRestHighLevelClient%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=RestHighLevelClient&amp;zhida_source=entity" ref="nofollow noopener noreferrer">RestHighLevelClient</a>è¢«å½»åº•åºŸå¼ƒ</strong>ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…¨æ–°çš„<code>elasticsearch-java</code>å®¢æˆ·ç«¯ã€‚</p>
<p>å¯¹äºä¹ æƒ¯äº†ä½ç‰ˆæœ¬ESä¸æ—§å®¢æˆ·ç«¯çš„å¼€å‘è€…è€Œè¨€ï¼Œè¿™æ¬¡æ›´æ–°æ— ç–‘å¢åŠ äº†ä¸Šæ‰‹æˆæœ¬ã€‚å®˜æ–¹æ–°å®¢æˆ·ç«¯é‡‡ç”¨äº†æ›´ç®€æ´çš„Fluent DSLè¯­æ³•ï¼Œæ›´è½»é‡çš„ä¾èµ–è®¾è®¡ï¼Œä¸”èƒ½ä¸ESæœåŠ¡ç«¯APIå®æ—¶åŒæ­¥æ¼”è¿›ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†æ—§å®¢æˆ·ç«¯ä¾èµ–è€¦åˆé‡ã€è¯·æ±‚æ„å»ºè‡ƒè‚¿ã€ä¸RESTæ–‡æ¡£è„±èŠ‚çš„ç—›ç‚¹ã€‚</p>
<p>æœ¬æ–‡ä¸“ä¸ºES 9.Xæ–°æ‰‹æ‰“é€ ï¼Œæ‘’å¼ƒå¤æ‚ç†è®ºï¼Œèšç„¦å®é™…å¼€å‘åœºæ™¯ï¼Œè¯¦ç»†è®²è§£æ–°Javaå®¢æˆ·ç«¯çš„åŸºç¡€ä¾èµ–é…ç½®ä¸æ ¸å¿ƒAPIä½¿ç”¨ï¼ˆå«æ–‡æ¡£CRUDã€æ£€ç´¢ã€èšåˆã€åˆ†é¡µæ’åºï¼‰ï¼Œæ‰€æœ‰ä»£ç å‡å¯ç›´æ¥å¤åˆ¶è¿è¡Œï¼ŒåŠ©åŠ›å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹æ–°å®¢æˆ·ç«¯ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡ä¸<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D2%26q%3D%25E4%25BE%259D%25E8%25B5%2596%25E9%2585%258D%25E7%25BD%25AE%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=2&amp;q=%E4%BE%9D%E8%B5%96%E9%85%8D%E7%BD%AE&amp;zhida_source=entity" ref="nofollow noopener noreferrer">ä¾èµ–é…ç½®</a></h2>
<p>ä½¿ç”¨ES 9.X Javaå®¢æˆ·ç«¯å‰ï¼Œéœ€ç¡®ä¿æœ¬åœ°/æœåŠ¡å™¨å·²éƒ¨ç½²ES 9.Xç‰ˆæœ¬ï¼ˆå®¢æˆ·ç«¯ç‰ˆæœ¬éœ€ä¸æœåŠ¡ç«¯ç‰ˆæœ¬ä¸¥æ ¼ä¸€è‡´ï¼Œé¿å…ç‰ˆæœ¬å†²çªå¼•å‘å¼‚å¸¸ï¼‰ï¼Œæœ¬æ–‡ä»¥<code>9.1.0</code>ç‰ˆæœ¬ä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºã€‚</p>
<h3 data-id="heading-2">1.1 Mavenä¾èµ–ï¼ˆæ›´æ¨èï¼‰</h3>
<p>åœ¨é¡¹ç›®<code>pom.xml</code>ä¸­å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼Œæ ¸å¿ƒä¾èµ–ä¸º<code>elasticsearch-java</code>ï¼Œé¢å¤–å¼•å…¥<code>lombok</code>ç®€åŒ–å®ä½“ç±»å¼€å‘ï¼ˆå¯é€‰ï¼Œè‹¥ä¸ä½¿ç”¨å¯æ‰‹åŠ¨å®ç°getter/setterï¼‰ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ES 9.X Javaå®¢æˆ·ç«¯æ ¸å¿ƒä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>co.elastic.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elasticsearch-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>9.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Lombokä¾èµ–ï¼ˆç®€åŒ–å®ä½“ç±»ï¼Œå¯é€‰ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å¯é€‰ï¼šJacksonä¾èµ–ï¼ˆè‹¥JSONåºåˆ—åŒ–å¼‚å¸¸å¯æ·»åŠ ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.15.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">1.2 Gradleä¾èµ–</h3>
<p>è‹¥é¡¹ç›®ä½¿ç”¨Gradleæ„å»ºï¼Œæ·»åŠ ä»¥ä¸‹ä¾èµ–è‡³<code>build.gradle</code>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ES 9.X Javaå®¢æˆ·ç«¯æ ¸å¿ƒä¾èµ–</span>
implementation <span class="hljs-string">'co.elastic.clients:elasticsearch-java:9.1.0'</span>
<span class="hljs-comment">// Lombokä¾èµ–ï¼ˆå¯é€‰ï¼‰</span>
compileOnly <span class="hljs-string">'org.projectlombok:lombok:1.18.24'</span>
annotationProcessor <span class="hljs-string">'org.projectlombok:lombok:1.18.24'</span>
<span class="hljs-comment">// å¯é€‰ï¼šJacksonä¾èµ–</span>
implementation <span class="hljs-string">'com.fasterxml.jackson.core:jackson-databind:2.15.2'</span>
</code></pre>
<h3 data-id="heading-4">1.3 ä¾èµ–æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>æ ¸å¿ƒä¾èµ–<code>elasticsearch-java</code>ç‰ˆæœ¬å¿…é¡»ä¸ESæœåŠ¡ç«¯ç‰ˆæœ¬ä¸€è‡´ï¼ˆå¦‚ESæœåŠ¡ç«¯ä¸º9.1.0ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€ä¸º9.1.0ï¼‰ï¼Œå¦åˆ™ä¼šå‡ºç°ç‰ˆæœ¬å…¼å®¹å¼‚å¸¸ï¼ˆå¦‚<code>NoSuchMethodError</code>ã€æœªçŸ¥å‚æ•°å¼‚å¸¸ï¼‰ã€‚</li>
<li>æ— éœ€é¢å¤–å¼•å…¥ESæœåŠ¡ç«¯æ ¸å¿ƒåŒ…ï¼Œæ–°å®¢æˆ·ç«¯å·²å½»åº•è§£è€¦æ—§å®¢æˆ·ç«¯çš„å¼ºä¾èµ–é—®é¢˜ï¼Œä½“ç§¯æ›´è½»é‡ã€‚</li>
<li>å¤šæ¨¡å—é¡¹ç›®ä¸­ï¼Œéœ€ç¡®ä¿æ‰€æœ‰å­æ¨¡å—çš„ESå®¢æˆ·ç«¯ç‰ˆæœ¬ç»Ÿä¸€ï¼Œé¿å…å‡ºç°å¤šä¸ªå®¢æˆ·ç«¯å®ä¾‹å†²çªçš„æƒ…å†µã€‚</li>
</ul>
<h2 data-id="heading-5">äºŒã€æ ¸å¿ƒAPIå®æˆ˜ï¼ˆåŸºç¡€å¿…å­¦ï¼‰</h2>
<p>æœ¬æ–‡ä»¥ã€Œå•†å“ï¼ˆProductï¼‰ã€ä¸ºç¤ºä¾‹å®ä½“ï¼Œæ¨¡æ‹Ÿå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œè®²è§£æ–°å®¢æˆ·ç«¯çš„å„é¡¹åŸºç¡€æ“ä½œã€‚æ‰€æœ‰ä»£ç å‡åŒ…å«å®Œæ•´æ³¨é‡Šï¼Œæ–°æ‰‹å¯ç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®ä¸­æµ‹è¯•ï¼ˆéœ€æ›¿æ¢ESæœåŠ¡ç«¯åœ°å€ã€è´¦å·å¯†ç ï¼‰ã€‚</p>
<h3 data-id="heading-6">2.1 å®šä¹‰ç¤ºä¾‹å®ä½“ç±»</h3>
<p>åˆ›å»ºå•†å“å®ä½“ç±»<code>Product</code>ï¼Œå¯¹åº”ESä¸­çš„<code>products</code>ç´¢å¼•ï¼Œå­—æ®µå«ä¹‰ï¼š<code>sku</code>ï¼ˆå•†å“å”¯ä¸€æ ‡è¯†ï¼‰ã€<code>name</code>ï¼ˆå•†å“åç§°ï¼‰ã€<code>price</code>ï¼ˆå•†å“ä»·æ ¼ï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> lombok.<span class="hljs-property">AllArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">Data</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">NoArgsConstructor</span>;

<span class="hljs-comment">/**
 * å•†å“å®ä½“ç±»ï¼ˆå¯¹åº”ESçš„productsç´¢å¼•ï¼‰
 * æ³¨ï¼š<span class="hljs-doctag">@Data</span>æ³¨è§£ç­‰ä»·äº<span class="hljs-doctag">@Getter</span>+<span class="hljs-doctag">@Setter</span>+<span class="hljs-doctag">@ToString</span>+<span class="hljs-doctag">@EqualsAndHashCode</span>+<span class="hljs-doctag">@RequiredArgsConstructor</span>
 * è‹¥ä¸ä½¿ç”¨Lombokï¼Œéœ€æ‰‹åŠ¨å®ç°getter/setteræ–¹æ³•
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>  <span class="hljs-comment">// å…¨å‚æ„é€ æ–¹æ³•</span>
<span class="hljs-meta">@NoArgsConstructor</span>   <span class="hljs-comment">// æ— å‚æ„é€ æ–¹æ³•ï¼ˆJSONååºåˆ—åŒ–å¿…é¡»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-comment">// å•†å“å”¯ä¸€æ ‡è¯†ï¼ˆå¯¹åº”ESæ–‡æ¡£idï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> sku;
    <span class="hljs-comment">// å•†å“åç§°ï¼ˆå¯ç”¨äºå…¨æ–‡æ£€ç´¢ã€ç²¾ç¡®æ£€ç´¢ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
    <span class="hljs-comment">// å•†å“ä»·æ ¼ï¼ˆå¯ç”¨äºèŒƒå›´æŸ¥è¯¢ã€èšåˆç»Ÿè®¡ï¼‰</span>
    <span class="hljs-keyword">private</span> double price;
}
</code></pre>
<h3 data-id="heading-7">2.2 åˆ›å»ºESå®¢æˆ·ç«¯ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰</h3>
<p>ES 9.X Javaå®¢æˆ·ç«¯é€šè¿‡<code>ElasticsearchClient</code>ç±»å®ç°ä¸æœåŠ¡ç«¯çš„è¿æ¥ï¼Œæ”¯æŒé…ç½®æœåŠ¡ç«¯åœ°å€ã€è´¦å·å¯†ç ã€è¶…æ—¶æ—¶é—´ç­‰å‚æ•°ã€‚å®¢æˆ·ç«¯ä¸ºé‡é‡çº§å¯¹è±¡ï¼Œå»ºè®®å…¨å±€å•ä¾‹åˆ›å»ºï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯å¯¼è‡´èµ„æºæ³„éœ²ã€‚</p>
<p><strong>2.2.1 åŸºç¡€åˆ›å»ºï¼ˆç®€æ´ç‰ˆï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.ElasticsearchClient;
<span class="hljs-keyword">import</span> co.elastic.clients.json.jackson.JacksonJsonpMapper;
<span class="hljs-keyword">import</span> co.elastic.clients.transport.rest_client.RestClientTransport;
<span class="hljs-keyword">import</span> org.elasticsearch.client.RestClient;

<span class="hljs-keyword">import</span> java.net.URI;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsClientUtil</span> {
    <span class="hljs-comment">// å•ä¾‹å®¢æˆ·ç«¯å®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ElasticsearchClient esClient;

    <span class="hljs-comment">// åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆé™æ€ä»£ç å—ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. é…ç½®ESæœåŠ¡ç«¯åœ°å€ï¼ˆå•æœºï¼šå•ä¸ªURIï¼›é›†ç¾¤ï¼šå¤šä¸ªURIç”¨é€—å·åˆ†éš”ï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">serverUrl</span> <span class="hljs-operator">=</span> <span class="hljs-string">"http://127.0.0.1:9200"</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„ESæœåŠ¡ç«¯åœ°å€</span>
            <span class="hljs-comment">// 2. åˆ›å»ºRestClientï¼ˆåº•å±‚HTTPè¿æ¥ï¼‰</span>
            <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> RestClient.builder(URI.create(serverUrl))
                    <span class="hljs-comment">// é…ç½®è´¦å·å¯†ç ï¼ˆè‹¥ESæœªå¼€å¯æƒé™éªŒè¯ï¼Œå¯çœç•¥æ­¤æ­¥éª¤ï¼‰</span>
                    .setBasicAuth(<span class="hljs-string">"elastic"</span>, <span class="hljs-string">"123456"</span>) <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„ESè´¦å·å¯†ç </span>
                    .build();

            <span class="hljs-comment">// 3. åˆ›å»ºä¼ è¾“å±‚ï¼ˆæŒ‡å®šJSONåºåˆ—åŒ–æ–¹å¼ï¼ŒJacksonä¸ºé»˜è®¤æ¨èï¼‰</span>
            <span class="hljs-type">RestClientTransport</span> <span class="hljs-variable">transport</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestClientTransport</span>(
                    restClient, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonJsonpMapper</span>()
            );

            <span class="hljs-comment">// 4. åˆ›å»ºæœ€ç»ˆçš„ESå®¢æˆ·ç«¯</span>
            esClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElasticsearchClient</span>(transport);
            System.out.println(<span class="hljs-string">"ES 9.Xå®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸï¼"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ESå®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡ç«¯åœ°å€å’Œè´¦å·å¯†ç "</span>);
        }
    }

    <span class="hljs-comment">// è·å–å®¢æˆ·ç«¯å®ä¾‹ï¼ˆå¯¹å¤–æä¾›ç»Ÿä¸€è®¿é—®å…¥å£ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ElasticsearchClient <span class="hljs-title function_">getEsClient</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> esClient;
    }

    <span class="hljs-comment">// å…³é—­å®¢æˆ·ç«¯ï¼ˆé¡¹ç›®åœæ­¢æ—¶è°ƒç”¨ï¼Œé‡Šæ”¾èµ„æºï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeClient</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (esClient != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// å…³é—­ä¼ è¾“å±‚å’ŒRestClient</span>
                esClient._transport().close();
                esClient._transport().restClient().close();
                System.out.println(<span class="hljs-string">"ESå®¢æˆ·ç«¯å·²å…³é—­"</span>);
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨æ–¹å¼ï¼ˆä»»ä½•åœ°æ–¹ç›´æ¥è°ƒç”¨ï¼‰</span>
<span class="hljs-comment">// ElasticsearchClient client = EsClientUtil.getEsClient();</span>
</code></pre>
<p><strong>2.2.2 è¿›é˜¶é…ç½®ï¼ˆè¶…æ—¶ã€é›†ç¾¤ï¼‰</strong></p>
<p>è‹¥éœ€é…ç½®è¿æ¥è¶…æ—¶ã€è¯»å–è¶…æ—¶ï¼Œæˆ–è¿æ¥ESé›†ç¾¤ï¼Œå¯ä¿®æ”¹å®¢æˆ·ç«¯åˆå§‹åŒ–é€»è¾‘ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é›†ç¾¤é…ç½®+è¶…æ—¶é…ç½®ï¼ˆæ›¿æ¢ä¸Šé¢çš„é™æ€ä»£ç å—ï¼‰</span>
<span class="hljs-keyword">static</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// é›†ç¾¤åœ°å€ï¼ˆå¤šä¸ªèŠ‚ç‚¹ç”¨é€—å·åˆ†éš”ï¼‰</span>
        String[] serverUrls = {<span class="hljs-string">"http://127.0.0.1:9200"</span>, <span class="hljs-string">"http://127.0.0.1:9201"</span>, <span class="hljs-string">"http://127.0.0.1:9202"</span>};
        <span class="hljs-comment">// æ„å»ºRestClientBuilder</span>
        RestClient.<span class="hljs-type">Builder</span> <span class="hljs-variable">restClientBuilder</span> <span class="hljs-operator">=</span> RestClient.builder(
                Arrays.stream(serverUrls).map(URI::create).toArray(URI[]::<span class="hljs-keyword">new</span>)
        );

        <span class="hljs-comment">// é…ç½®è´¦å·å¯†ç </span>
        restClientBuilder.setBasicAuth(<span class="hljs-string">"elastic"</span>, <span class="hljs-string">"123456"</span>);

        <span class="hljs-comment">// é…ç½®è¶…æ—¶æ—¶é—´ï¼ˆå¯é€‰ï¼Œæ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼‰</span>
        restClientBuilder.setRequestConfigCallback(requestConfigBuilder -&gt; 
                requestConfigBuilder
                        .setConnectTimeout(<span class="hljs-number">5000</span>)  <span class="hljs-comment">// è¿æ¥è¶…æ—¶ï¼š5ç§’</span>
                        .setSocketTimeout(<span class="hljs-number">10000</span>) <span class="hljs-comment">// è¯»å–è¶…æ—¶ï¼š10ç§’</span>
        );

        <span class="hljs-comment">// åç»­æ­¥éª¤ï¼ˆä¼ è¾“å±‚ã€å®¢æˆ·ç«¯åˆ›å»ºï¼‰ä¸åŸºç¡€ç‰ˆä¸€è‡´</span>
        <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> restClientBuilder.build();
        <span class="hljs-type">RestClientTransport</span> <span class="hljs-variable">transport</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestClientTransport</span>(restClient, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonJsonpMapper</span>());
        esClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElasticsearchClient</span>(transport);
        System.out.println(<span class="hljs-string">"ESé›†ç¾¤å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸï¼"</span>);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        e.printStackTrace();
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ESå®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8">2.3 æ–‡æ¡£æ“ä½œï¼ˆCRUDæ ¸å¿ƒï¼‰</h3>
<p>ESæ–‡æ¡£æ“ä½œæ˜¯åŸºç¡€ï¼Œæ–°å®¢æˆ·ç«¯æä¾›ä¸¤ç§è¯·æ±‚æ„å»ºæ–¹å¼ï¼š<strong>Fluent DSL</strong>ï¼ˆç®€æ´ä¼˜é›…ï¼Œæ¨èï¼‰å’Œ<strong>Builderæ¨¡å¼</strong>ï¼ˆçµæ´»ï¼Œé€‚åˆå¤æ‚åœºæ™¯ï¼‰ï¼Œä»¥ä¸‹åˆ†åˆ«æ¼”ç¤ºã€‚</p>
<p><strong>2.3.1 æ’å…¥æ–‡æ¡£ï¼ˆå•æ¡ï¼‰</strong></p>
<p>æ’å…¥æ–‡æ¡£å³å‘ESç´¢å¼•ä¸­æ·»åŠ ä¸€æ¡æ•°æ®ï¼Œå¯æŒ‡å®šæ–‡æ¡£idï¼ˆæ¨èç”¨ä¸šåŠ¡å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å•†å“skuï¼‰ï¼Œä¹Ÿå¯è®©ESè‡ªåŠ¨ç”Ÿæˆidã€‚</p>
<p><strong>æ–¹å¼1ï¼šFluent DSLï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">import co.elastic.clients.elasticsearch.core.IndexRequest;
import co.elastic.clients.elasticsearch.core.IndexResponse;

<span class="hljs-comment">/**
 * å•æ¡æ’å…¥æ–‡æ¡£ï¼ˆFluent DSLæ–¹å¼ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsDocumentInsert</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. è·å–ESå®¢æˆ·ç«¯</span>
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 2. æ„å»ºå•†å“æ•°æ®ï¼ˆæ¨¡æ‹Ÿä¸šåŠ¡æ•°æ®ï¼‰</span>
            Product product = <span class="hljs-keyword">new</span> Product(<span class="hljs-string">"sku001"</span>, <span class="hljs-string">"è‹¹æœ14 Pro"</span>, <span class="hljs-number">7999.0</span>);

            <span class="hljs-comment">// 3. æ„å»ºæ’å…¥è¯·æ±‚ï¼ˆFluent DSLè¯­æ³•ï¼Œé“¾å¼è°ƒç”¨ï¼‰</span>
            IndexRequest&lt;Product&gt; request = IndexRequest.of(i -&gt; i
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•åç§°ï¼ˆè‹¥ç´¢å¼•ä¸å­˜åœ¨ï¼ŒESä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå»ºè®®æå‰åˆ›å»ºï¼‰</span>
                    .id(product.getSku())       <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£idï¼ˆä¸å•†å“skuä¸€è‡´ï¼Œä¾¿äºåç»­æŸ¥è¯¢å’Œä¿®æ”¹ï¼‰</span>
                    .document(product)          <span class="hljs-comment">// ä¼ å…¥è¦æ’å…¥çš„å®ä½“å¯¹è±¡ï¼ˆè‡ªåŠ¨åºåˆ—åŒ–ä¸ºJSONï¼‰</span>
                    .refresh(<span class="hljs-literal">true</span>)              <span class="hljs-comment">// æ’å…¥åç«‹å³åˆ·æ–°ç´¢å¼•ï¼ˆä¾¿äºç«‹å³æŸ¥è¯¢åˆ°ï¼Œç”Ÿäº§ç¯å¢ƒå¯æ ¹æ®æ€§èƒ½è°ƒæ•´ï¼‰</span>
            );

            <span class="hljs-comment">// 4. æ‰§è¡Œæ’å…¥æ“ä½œï¼Œè·å–å“åº”ç»“æœ</span>
            IndexResponse response = client.index(request);

            <span class="hljs-comment">// 5. è§£æå“åº”ç»“æœ</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£æ’å…¥æˆåŠŸï¼"</span>);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç´¢å¼•åç§°ï¼š"</span> + response.index());
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + response.id());
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ’å…¥çŠ¶æ€ï¼š"</span> + response.result()); <span class="hljs-comment">// createdï¼ˆæ–°å¢ï¼‰/ updatedï¼ˆè¦†ç›–ï¼‰</span>

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£æ’å…¥å¤±è´¥ï¼š"</span> + e.getMessage());
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// é¡¹ç›®åœæ­¢æ—¶å…³é—­å®¢æˆ·ç«¯ï¼ˆå®é™…å¼€å‘ä¸­å¯åœ¨Springé”€æ¯æ–¹æ³•ä¸­è°ƒç”¨ï¼‰</span>
            <span class="hljs-comment">// EsClientUtil.closeClient();</span>
        }
    }
}
</code></pre>
<p><strong>æ–¹å¼2ï¼šBuilderæ¨¡å¼</strong></p>
<p>Builderæ¨¡å¼æ›´çµæ´»ï¼Œå¯åŠ¨æ€è®¾ç½®è¯·æ±‚å‚æ•°ï¼ˆå¦‚æ¡ä»¶åˆ¤æ–­åè®¾ç½®refreshã€timeoutç­‰ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.IndexRequest;

<span class="hljs-comment">/**
 * å•æ¡æ’å…¥æ–‡æ¡£ï¼ˆBuilderæ¨¡å¼ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsDocumentInsertByBuilder</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºå•†å“æ•°æ®</span>
            <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku002"</span>, <span class="hljs-string">"åä¸ºMate 60"</span>, <span class="hljs-number">6999.0</span>);

            <span class="hljs-comment">// 2. æ„å»ºæ’å…¥è¯·æ±‚Builder</span>
            IndexRequest.Builder&lt;Product&gt; requestBuilder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>.Builder&lt;Product&gt;();
            requestBuilder.index(<span class="hljs-string">"products"</span>);          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
            requestBuilder.id(product.getSku());       <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£id</span>
            requestBuilder.document(product);          <span class="hljs-comment">// ä¼ å…¥å®ä½“å¯¹è±¡</span>
            requestBuilder.refresh(<span class="hljs-literal">true</span>);              <span class="hljs-comment">// ç«‹å³åˆ·æ–°</span>

            <span class="hljs-comment">// 3. æ„å»ºè¯·æ±‚å¹¶æ‰§è¡Œ</span>
            <span class="hljs-type">IndexResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.index(requestBuilder.build());

            <span class="hljs-comment">// 4. è§£æå“åº”</span>
            System.out.println(<span class="hljs-string">"Builderæ¨¡å¼æ’å…¥æˆåŠŸï¼Œæ–‡æ¡£idï¼š"</span> + response.id());

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>2.3.2 æ‰¹é‡æ’å…¥æ–‡æ¡£</strong></p>
<p>å½“éœ€è¦æ’å…¥å¤šæ¡æ–‡æ¡£æ—¶ï¼ˆå¦‚æ•°æ®å¯¼å…¥ï¼‰ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥å¯å¤§å¹…æå‡æ•ˆç‡ï¼Œé¿å…å•æ¡æ’å…¥é¢‘ç¹è¯·æ±‚ESæœåŠ¡ç«¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.BulkRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.BulkResponse;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.bulk.BulkOperation;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * æ‰¹é‡æ’å…¥æ–‡æ¡£ï¼ˆæ¨èç”¨äºå¤šæ¡æ•°æ®å¯¼å…¥åœºæ™¯ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsDocumentBulkInsert</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ¨¡æ‹Ÿæ‰¹é‡å•†å“æ•°æ®ï¼ˆå®é™…å¼€å‘ä¸­å¯ä»æ•°æ®åº“ã€æ–‡ä»¶ä¸­è¯»å–ï¼‰</span>
            List&lt;Product&gt; productList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku003"</span>, <span class="hljs-string">"å°ç±³14"</span>, <span class="hljs-number">4999.0</span>));
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku004"</span>, <span class="hljs-string">"OPPO Find X7"</span>, <span class="hljs-number">5999.0</span>));
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku005"</span>, <span class="hljs-string">"vivo X100"</span>, <span class="hljs-number">5499.0</span>));

            <span class="hljs-comment">// 2. æ„å»ºæ‰¹é‡è¯·æ±‚Builder</span>
            BulkRequest.<span class="hljs-type">Builder</span> <span class="hljs-variable">bulkBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BulkRequest</span>.Builder();

            <span class="hljs-comment">// 3. éå†å•†å“åˆ—è¡¨ï¼Œæ·»åŠ æ‰¹é‡æ“ä½œï¼ˆæ¯æ¡æ•°æ®å¯¹åº”ä¸€ä¸ªindexæ“ä½œï¼‰</span>
            <span class="hljs-keyword">for</span> (Product product : productList) {
                bulkBuilder.operations(op -&gt; op
                        .index(idx -&gt; idx          <span class="hljs-comment">// æ¯æ¡æ“ä½œéƒ½æ˜¯æ’å…¥æ“ä½œ</span>
                                .index(<span class="hljs-string">"products"</span>)  <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
                                .id(product.getSku()) <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£id</span>
                                .document(product)  <span class="hljs-comment">// ä¼ å…¥å•†å“æ•°æ®</span>
                        )
                );
            }

            <span class="hljs-comment">// 4. æ‰§è¡Œæ‰¹é‡æ’å…¥ï¼Œè·å–å“åº”</span>
            <span class="hljs-type">BulkResponse</span> <span class="hljs-variable">bulkResponse</span> <span class="hljs-operator">=</span> client.bulk(bulkBuilder.build());

            <span class="hljs-comment">// 5. è§£ææ‰¹é‡å“åº”ç»“æœï¼ˆæ‰¹é‡æ“ä½œå¯èƒ½éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥ï¼Œéœ€æ ¡éªŒï¼‰</span>
            <span class="hljs-keyword">if</span> (bulkResponse.errors()) {
                System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å­˜åœ¨å¤±è´¥é¡¹ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š"</span>);
                bulkResponse.items().forEach(item -&gt; {
                    <span class="hljs-keyword">if</span> (item.error() != <span class="hljs-literal">null</span>) {
                        System.out.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + item.id() + <span class="hljs-string">"ï¼Œæ’å…¥å¤±è´¥ï¼š"</span> + item.error().reason());
                    }
                });
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å…¨éƒ¨æˆåŠŸï¼"</span>);
                System.out.println(<span class="hljs-string">"æ’å…¥æ€»æ•°ï¼š"</span> + productList.size());
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å¤±è´¥ï¼š"</span> + e.getMessage());
        }
    }
}
</code></pre>
<p><strong>2.3.3 è¡¥å……ï¼šåˆ›å»ºç´¢å¼•ï¼ˆæ¨èæå‰åˆ›å»ºï¼‰</strong></p>
<p>è™½ç„¶ESä¼šè‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„ç´¢å¼•ï¼Œä½†è‡ªåŠ¨åˆ›å»ºçš„ç´¢å¼•å­—æ®µç±»å‹å¯èƒ½ä¸ç¬¦åˆé¢„æœŸï¼ˆå¦‚priceå¯èƒ½è¢«è¯†åˆ«ä¸ºtextç±»å‹ï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼‰ï¼Œå»ºè®®æå‰æ‰‹åŠ¨åˆ›å»ºç´¢å¼•ï¼ŒæŒ‡å®šå­—æ®µç±»å‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.indices.CreateIndexRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.indices.CreateIndexResponse;

<span class="hljs-comment">/**
 * æ‰‹åŠ¨åˆ›å»ºproductsç´¢å¼•ï¼ˆæŒ‡å®šå­—æ®µç±»å‹ï¼Œæ¨èæå‰åˆ›å»ºï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsIndexCreate</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// æ„å»ºåˆ›å»ºç´¢å¼•è¯·æ±‚ï¼ŒæŒ‡å®šå­—æ®µæ˜ å°„ï¼ˆmappingï¼‰</span>
            <span class="hljs-type">CreateIndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> CreateIndexRequest.of(c -&gt; c
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// ç´¢å¼•åç§°</span>
                    .mappings(m -&gt; m            <span class="hljs-comment">// å­—æ®µæ˜ å°„é…ç½®</span>
                            .properties(<span class="hljs-string">"sku"</span>, p -&gt; p.keyword())  <span class="hljs-comment">// skuï¼škeywordç±»å‹ï¼ˆç²¾ç¡®åŒ¹é…ï¼Œä¸åˆ†è¯ï¼‰</span>
                            .properties(<span class="hljs-string">"name"</span>, p -&gt; p.text())     <span class="hljs-comment">// nameï¼štextç±»å‹ï¼ˆæ”¯æŒå…¨æ–‡æ£€ç´¢ï¼Œåˆ†è¯ï¼‰</span>
                            .properties(<span class="hljs-string">"price"</span>, p -&gt; p.double_()) <span class="hljs-comment">// priceï¼šdoubleç±»å‹ï¼ˆæ”¯æŒæ•°å€¼è¿ç®—ã€èŒƒå›´æŸ¥è¯¢ï¼‰</span>
                    )
            );

            <span class="hljs-comment">// æ‰§è¡Œåˆ›å»ºæ“ä½œ</span>
            <span class="hljs-type">CreateIndexResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.indices().create(request);

            <span class="hljs-keyword">if</span> (response.acknowledged()) {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•åˆ›å»ºæˆåŠŸï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•åˆ›å»ºå¤±è´¥ï¼"</span>);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è‹¥ç´¢å¼•å·²å­˜åœ¨ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¯å¿½ç•¥æˆ–æ•è·å¤„ç†</span>
            <span class="hljs-keyword">if</span> (e.getMessage().contains(<span class="hljs-string">"resource_already_exists_exception"</span>)) {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•å·²å­˜åœ¨ï¼Œæ— éœ€é‡å¤åˆ›å»ºï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                e.printStackTrace();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-9">2.4 æ£€ç´¢æ“ä½œï¼ˆæ ¸å¿ƒé‡ç‚¹ï¼‰</h3>
<p>ESçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæ£€ç´¢ï¼Œæ–°å®¢æˆ·ç«¯æ”¯æŒå…¨æ–‡æ£€ç´¢ã€ç²¾ç¡®æ£€ç´¢ã€ç»„åˆæ£€ç´¢ç­‰å¸¸è§åœºæ™¯ï¼Œä»¥ä¸‹ç»“åˆå•†å“åœºæ™¯è¯¦ç»†æ¼”ç¤ºï¼Œæ‰€æœ‰ç¤ºä¾‹å‡åŸºäº<code>products</code>ç´¢å¼•å’Œæ‰¹é‡æ’å…¥çš„æ•°æ®ã€‚</p>
<p><strong>2.4.1 å…¨æ–‡æ£€ç´¢ï¼ˆmatchAll/matchï¼‰</strong></p>
<p>å…¨æ–‡æ£€ç´¢é€‚ç”¨äºæ¨¡ç³ŠæŸ¥è¯¢åœºæ™¯ï¼ˆå¦‚æ ¹æ®å•†å“åç§°æœç´¢ï¼‰ï¼ŒESä¼šå¯¹æŸ¥è¯¢å…³é”®è¯è¿›è¡Œåˆ†è¯ï¼ŒåŒ¹é…æ‰€æœ‰åŒ…å«åˆ†è¯ç»“æœçš„æ–‡æ¡£ã€‚</p>
<p><strong>åœºæ™¯1ï¼šæŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼ˆmatchAllï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.SearchRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.SearchResponse;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.Hit;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * å…¨æ–‡æ£€ç´¢ - æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼ˆmatchAllï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsSearchMatchAll</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæŸ¥è¯¢productsç´¢å¼•ä¸‹æ‰€æœ‰æ–‡æ¡£ï¼‰</span>
            <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
                    .query(q -&gt; q.matchAll(m -&gt; m)) <span class="hljs-comment">// å…¨æ–‡æ£€ç´¢ - åŒ¹é…æ‰€æœ‰æ–‡æ¡£</span>
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.class);

            <span class="hljs-comment">// 3. è§£æå“åº”ç»“æœï¼ˆè·å–å‘½ä¸­çš„æ–‡æ¡£åˆ—è¡¨ï¼‰</span>
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            System.out.println(<span class="hljs-string">"æŸ¥è¯¢åˆ°çš„æ–‡æ¡£æ€»æ•°ï¼š"</span> + response.hits().total().value());
            System.out.println(<span class="hljs-string">"æŸ¥è¯¢ç»“æœè¯¦æƒ…ï¼š"</span>);

            <span class="hljs-comment">// éå†æ–‡æ¡£åˆ—è¡¨ï¼Œè·å–å•†å“ä¿¡æ¯</span>
            <span class="hljs-keyword">for</span> (Hit&lt;Product&gt; hit : hits) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> hit.source(); <span class="hljs-comment">// ååºåˆ—åŒ–ä¸ºProductå®ä½“</span>
                System.out.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + hit.id() + <span class="hljs-string">"ï¼Œå•†å“ä¿¡æ¯ï¼š"</span> + product);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šæ ¹æ®å…³é”®è¯æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆmatchï¼‰</strong></p>
<p>æ ¹æ®å•†å“åç§°æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆå¦‚æœç´¢â€œ14â€ï¼Œä¼šåŒ¹é…â€œè‹¹æœ14 Proâ€ã€â€œå°ç±³14â€ï¼‰ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * å…¨æ–‡æ£€ç´¢ - å…³é”®è¯æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆmatchï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsSearchMatch</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæ ¹æ®å•†å“åç§°æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå…³é”®è¯ï¼š14ï¼‰</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q
                            .<span class="hljs-built_in">match</span>(m -&gt; m
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"name"</span>)     <span class="hljs-comment">// æ£€ç´¢çš„å­—æ®µï¼ˆå•†å“åç§°ï¼‰</span>
                                    .<span class="hljs-built_in">query</span>(<span class="hljs-string">"14"</span>)       <span class="hljs-comment">// æ£€ç´¢å…³é”®è¯</span>
                                    .<span class="hljs-built_in">fuzziness</span>(<span class="hljs-string">"AUTO"</span>) <span class="hljs-comment">// æ¨¡ç³ŠåŒ¹é…ï¼ˆå…è®¸è½»å¾®æ‹¼å†™é”™è¯¯ï¼Œå¦‚14å†™æˆ15ï¼Œå¯æ ¹æ®éœ€æ±‚å…³é—­ï¼‰</span>
                            )
                    )
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 3. è§£æç»“æœ</span>
            <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">Hit</span>&lt;<span class="hljs-selector-tag">Product</span>&gt;&gt; <span class="hljs-selector-tag">hits</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.hits</span>();
            <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"åŒ¹é…åˆ°çš„å•†å“æ•°é‡ï¼š"</span> + hits.<span class="hljs-built_in">size</span>());
            <span class="hljs-selector-tag">hits</span><span class="hljs-selector-class">.forEach</span>(hit -&gt; {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å•†å“ï¼š"</span> + hit.<span class="hljs-built_in">source</span>().<span class="hljs-built_in">getName</span>() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + hit.<span class="hljs-built_in">source</span>().<span class="hljs-built_in">getPrice</span>());
            });

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
        }
    }
}
</code></pre>
<p><strong>2.4.2 ç²¾ç¡®æ£€ç´¢ï¼ˆterm/rangeï¼‰</strong></p>
<p>ç²¾ç¡®æ£€ç´¢é€‚ç”¨äºæ— éœ€åˆ†è¯ã€ç²¾å‡†åŒ¹é…çš„åœºæ™¯ï¼Œå¸¸è§ä¸¤ç§ç±»å‹ï¼š<code>term</code>ï¼ˆè¯æ¡ç²¾ç¡®åŒ¹é…ï¼‰å’Œ<code>range</code>ï¼ˆèŒƒå›´åŒ¹é…ï¼‰ã€‚</p>
<p><strong>åœºæ™¯1ï¼štermç²¾ç¡®åŒ¹é…ï¼ˆkeywordå­—æ®µæ¨èï¼‰</strong></p>
<p>é€‚ç”¨äºåŒ¹é…å›ºå®šè¯æ¡ï¼ˆå¦‚æ ¹æ®skuæŸ¥è¯¢å•†å“ã€æ ¹æ®å•†å“åç§°ç²¾ç¡®åŒ¹é…ï¼‰ï¼Œæ³¨æ„ï¼štextç±»å‹å­—æ®µä½¿ç”¨termæŸ¥è¯¢å¯èƒ½æ— æ³•åŒ¹é…ï¼ˆå› textä¼šåˆ†è¯ï¼‰ï¼Œæ¨èç”¨äºkeywordå­—æ®µã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
 * ç²¾ç¡®æ£€ç´¢ - termè¯æ¡åŒ¹é…ï¼ˆé€‚ç”¨äºkeywordå­—æ®µï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsSearchTerm</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæ ¹æ®skuç²¾ç¡®æŸ¥è¯¢å•†å“ï¼Œskuä¸ºkeywordå­—æ®µï¼‰</span>
            SearchRequest request = SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .query(q -&gt; q
                            .term(t -&gt; t
                                    .field(<span class="hljs-string">"sku"</span>)      <span class="hljs-comment">// æ£€ç´¢å­—æ®µï¼ˆskuï¼Œkeywordç±»å‹ï¼‰</span>
                                    .<span class="hljs-keyword">value</span>(<span class="hljs-string">"sku001"</span>)   <span class="hljs-comment">// ç²¾ç¡®åŒ¹é…çš„å€¼</span>
                            )
                    )
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.<span class="hljs-keyword">class</span>);

            <span class="hljs-comment">// 3. è§£æç»“æœ</span>
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            <span class="hljs-keyword">if</span> (hits.isEmpty()) {
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°å¯¹åº”å•†å“ï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                Product product = hits.<span class="hljs-keyword">get</span>(<span class="hljs-number">0</span>).source();
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç²¾ç¡®æŸ¥è¯¢åˆ°çš„å•†å“ï¼š"</span> + product);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šrangeèŒƒå›´æŸ¥è¯¢ï¼ˆæ•°å€¼å­—æ®µæ¨èï¼‰</strong></p>
<p>é€‚ç”¨äºæ•°å€¼ã€æ—¥æœŸç­‰å­—æ®µçš„èŒƒå›´åŒ¹é…ï¼ˆå¦‚æŸ¥è¯¢ä»·æ ¼åœ¨5000-8000ä¹‹é—´çš„å•†å“ï¼‰ï¼ŒES 9.Xä¸­æ•°å€¼ç±»å‹çš„rangeæŸ¥è¯¢éœ€ä½¿ç”¨<code>number</code>å‡½æ•°ï¼Œé¿å…è¸©å‘ï¼</p>
<pre><code class="hljs language-ini" lang="ini">import co.elastic.clients.elasticsearch.core.search.RangeQuery<span class="hljs-comment">;</span>

/**
 * ç²¾ç¡®æ£€ç´¢ - rangeèŒƒå›´æŸ¥è¯¢ï¼ˆé€‚ç”¨äºæ•°å€¼ã€æ—¥æœŸå­—æ®µï¼‰
 */
public class EsSearchRange {
    public static void main(String<span class="hljs-section">[]</span> args) {
        try {
            ElasticsearchClient <span class="hljs-attr">client</span> = EsClientUtil.getEsClient()<span class="hljs-comment">;</span>

            // 1. æ„å»ºrangeæŸ¥è¯¢æ¡ä»¶ï¼ˆä»·æ ¼èŒƒå›´ï¼š5000 â‰¤ price â‰¤ 8000ï¼‰
            RangeQuery <span class="hljs-attr">rangeQuery</span> = RangeQuery.of(r -&gt; r
                    .number(n -&gt; n            // å¿…é¡»ä½¿ç”¨numberå‡½æ•°ï¼ˆæ•°å€¼ç±»å‹ä¸“ç”¨ï¼‰ï¼Œä¸å¯ç›´æ¥ç”¨field
                            .field("price")  // æ£€ç´¢å­—æ®µï¼ˆpriceï¼Œdoubleç±»å‹ï¼‰
                            .gte(5000.0)     // å¤§äºç­‰äºï¼ˆ<span class="hljs-attr">gte</span> = greater than or equalï¼‰
                            .lte(8000.0)     // å°äºç­‰äºï¼ˆ<span class="hljs-attr">lte</span> = less than or equalï¼‰
                            // å¯é€‰ï¼šgtï¼ˆå¤§äºï¼‰ã€ltï¼ˆå°äºï¼‰
                    )
            )<span class="hljs-comment">;</span>

            // 2. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œä¼ å…¥rangeæŸ¥è¯¢æ¡ä»¶
            SearchRequest <span class="hljs-attr">request</span> = SearchRequest.of(s -&gt; s
                    .index("products")
                    .query(q -&gt; q.range(rangeQuery)) // æ‰§è¡ŒrangeæŸ¥è¯¢
            )<span class="hljs-comment">;</span>

            // 3. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ
            SearchResponse&lt;Product&gt; <span class="hljs-attr">response</span> = client.search(request, Product.class)<span class="hljs-comment">;</span>
            List&lt;Hit&lt;Product&gt;&gt; <span class="hljs-attr">hits</span> = response.hits().hits()<span class="hljs-comment">;</span>
            System.out.println("ä»·æ ¼åœ¨5000-8000ä¹‹é—´çš„å•†å“æ•°é‡ï¼š" + hits.size())<span class="hljs-comment">;</span>
            hits.forEach(hit -&gt; {
                Product <span class="hljs-attr">product</span> = hit.source()<span class="hljs-comment">;</span>
                System.out.println("å•†å“åç§°ï¼š" + product.getName() + "ï¼Œä»·æ ¼ï¼š" + product.getPrice())<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>

        } catch (Exception e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
    }
}
</code></pre>
<p><strong>2.4.3 ç»„åˆæ£€ç´¢ï¼ˆBool Queryï¼‰</strong></p>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼Œæ£€ç´¢æ¡ä»¶å¾€å¾€æ˜¯å¤šä¸ªæ¡ä»¶çš„ç»„åˆï¼ˆå¦‚â€œå•†å“åç§°åŒ…å«14â€ä¸”â€œä»·æ ¼åœ¨5000ä»¥ä¸Šâ€ä¸”â€œæ’é™¤sku001â€ï¼‰ï¼Œæ­¤æ—¶éœ€ä½¿ç”¨<code>Bool Query</code>ç»„åˆå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚</p>
<p>Bool Queryæ ¸å¿ƒå­å¥ï¼ˆå¿…æ‡‚ï¼‰ï¼š</p>
<ul>
<li><code>must</code>ï¼šå¿…é¡»æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆå‚ä¸è¯„åˆ†ï¼Œå½±å“æŸ¥è¯¢ç»“æœæ’åºï¼‰</li>
<li><code>mustNot</code>ï¼šå¿…é¡»ä¸æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆä¸å‚ä¸è¯„åˆ†ï¼‰</li>
<li><code>filter</code>ï¼šå¿…é¡»æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆä¸å‚ä¸è¯„åˆ†ï¼Œå¯ç¼“å­˜ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰</li>
<li><code>should</code>ï¼šå¯é€‰æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆæ»¡è¶³ä¼šå¢åŠ è¯„åˆ†ï¼Œä¸æ»¡è¶³ä¸å½±å“ï¼‰</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.BoolQuery;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.MatchQuery;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.Query;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.TermQuery;

<span class="hljs-comment">/**
 * ç»„åˆæ£€ç´¢ - Bool Queryï¼ˆå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼Œå®é™…ä¸šåŠ¡é«˜é¢‘ä½¿ç”¨ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsSearchBool</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºå­æŸ¥è¯¢æ¡ä»¶</span>
            <span class="hljs-comment">// å­æŸ¥è¯¢1ï¼šå•†å“åç§°åŒ…å«"14"ï¼ˆmustï¼Œå¿…é¡»æ»¡è¶³ï¼Œå‚ä¸è¯„åˆ†ï¼‰</span>
            <span class="hljs-type">Query</span> <span class="hljs-variable">nameQuery</span> <span class="hljs-operator">=</span> MatchQuery.of(m -&gt; m
                    .field(<span class="hljs-string">"name"</span>)
                    .query(<span class="hljs-string">"14"</span>)
            )._toQuery(); <span class="hljs-comment">// è½¬æ¢ä¸ºé€šç”¨Queryç±»å‹</span>

            <span class="hljs-comment">// å­æŸ¥è¯¢2ï¼šä»·æ ¼å¤§äº5000ï¼ˆfilterï¼Œå¿…é¡»æ»¡è¶³ï¼Œä¸å‚ä¸è¯„åˆ†ï¼Œæå‡æ€§èƒ½ï¼‰</span>
            <span class="hljs-type">RangeQuery</span> <span class="hljs-variable">priceRangeQuery</span> <span class="hljs-operator">=</span> RangeQuery.of(r -&gt; r
                    .number(n -&gt; n
                            .field(<span class="hljs-string">"price"</span>)
                            .gt(<span class="hljs-number">5000.0</span>) <span class="hljs-comment">// å¤§äº5000ï¼ˆgt = greater thanï¼‰</span>
                    )
            );
            <span class="hljs-type">Query</span> <span class="hljs-variable">priceFilterQuery</span> <span class="hljs-operator">=</span> priceRangeQuery._toQuery();

            <span class="hljs-comment">// å­æŸ¥è¯¢3ï¼šæ’é™¤sku001ï¼ˆmustNotï¼Œå¿…é¡»ä¸æ»¡è¶³ï¼‰</span>
            <span class="hljs-type">Query</span> <span class="hljs-variable">excludeSkuQuery</span> <span class="hljs-operator">=</span> TermQuery.of(t -&gt; t
                    .field(<span class="hljs-string">"sku"</span>)
                    .value(<span class="hljs-string">"sku001"</span>)
            )._toQuery();

            <span class="hljs-comment">// 2. ç»„åˆBool Queryï¼ˆå°†å¤šä¸ªå­æŸ¥è¯¢ç»„åˆèµ·æ¥ï¼‰</span>
            <span class="hljs-type">BoolQuery</span> <span class="hljs-variable">boolQuery</span> <span class="hljs-operator">=</span> BoolQuery.of(b -&gt; b
                    .must(nameQuery)           <span class="hljs-comment">// å¿…é¡»æ»¡è¶³ï¼šåç§°åŒ…å«14</span>
                    .filter(priceFilterQuery)  <span class="hljs-comment">// å¿…é¡»æ»¡è¶³ï¼šä»·æ ¼&gt;5000ï¼ˆè¿‡æ»¤ï¼Œä¸è¯„åˆ†ï¼‰</span>
                    .mustNot(excludeSkuQuery)  <span class="hljs-comment">// å¿…é¡»ä¸æ»¡è¶³ï¼šsku != sku001</span>
            );

            <span class="hljs-comment">// 3. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œæ‰§è¡ŒBoolæŸ¥è¯¢</span>
            <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .query(q -&gt; q.bool(boolQuery)) <span class="hljs-comment">// ä¼ å…¥ç»„åˆå¥½çš„BoolæŸ¥è¯¢</span>
            );

            <span class="hljs-comment">// 4. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.class);
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            System.out.println(<span class="hljs-string">"ç»„åˆæŸ¥è¯¢åŒ¹é…åˆ°çš„å•†å“æ•°é‡ï¼š"</span> + hits.size());
            hits.forEach(hit -&gt; {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> hit.source();
                System.out.println(<span class="hljs-string">"å•†å“ï¼š"</span> + product.getName() + <span class="hljs-string">"ï¼Œskuï¼š"</span> + product.getSku() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.getPrice());
            });

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h3 data-id="heading-10">2.5 åˆ†é¡µä¸æ’åº</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œæ£€ç´¢ç»“æœå¾€å¾€éœ€è¦åˆ†é¡µï¼ˆå¦‚å‰ç«¯åˆ—è¡¨åˆ†é¡µï¼‰å’Œæ’åºï¼ˆå¦‚æŒ‰ä»·æ ¼å‡åº/é™åºï¼‰ï¼ŒES 9.Xå®¢æˆ·ç«¯æ”¯æŒçµæ´»çš„åˆ†é¡µæ’åºé…ç½®ï¼Œä»¥ä¸‹ç»“åˆå•†å“åœºæ™¯æ¼”ç¤ºã€‚</p>
<p><strong>2.5.1 åŸºç¡€åˆ†é¡µæ’åºï¼ˆfrom+sizeï¼‰</strong></p>
<p>é€‚ç”¨äºæµ…åˆ†é¡µåœºæ™¯ï¼ˆæ•°æ®é‡è¾ƒå°ï¼Œåˆ†é¡µæ·±åº¦è¾ƒæµ…ï¼‰ï¼Œæ ¸å¿ƒå‚æ•°ï¼š</p>
<ul>
<li><code>from</code>ï¼šèµ·å§‹åç§»é‡ï¼ˆä»ç¬¬å‡ æ¡æ•°æ®å¼€å§‹æŸ¥è¯¢ï¼Œé»˜è®¤0ï¼‰</li>
<li><code>size</code>ï¼šæ¯é¡µæ˜¾ç¤ºæ¡æ•°</li>
<li><code>sort</code>ï¼šæ’åºé…ç½®ï¼ˆæŒ‡å®šæ’åºå­—æ®µå’Œæ’åºæ–¹å‘ï¼‰</li>
</ul>
<p>æ³¨æ„ï¼šfrom+sizeæ–¹å¼åœ¨æ·±åº¦åˆ†é¡µï¼ˆå¦‚from=10000ï¼Œsize=10ï¼‰æ—¶ä¼šå­˜åœ¨ä¸¥é‡æ€§èƒ½ç“¶é¢ˆï¼Œå› ä¸ºESéœ€è¦ä»æ¯ä¸ªåˆ†ç‰‡è¯»å–10010æ¡æ•°æ®ï¼Œå†èšåˆæ’åºåæˆªå–ç»“æœï¼Œå¤§æ•°æ®é‡åœºæ™¯å»ºè®®ä½¿ç”¨Search Afteræˆ–Scroll APIã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">import co.elastic.clients.elasticsearch.core.search.SortOrder;

<span class="hljs-comment">/**
 * åˆ†é¡µä¸æ’åºï¼ˆåŸºç¡€from+sizeæ–¹å¼ï¼Œé€‚ç”¨äºæµ…åˆ†é¡µï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsSearchPageSort</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ¨¡æ‹Ÿå‰ç«¯åˆ†é¡µå‚æ•°ï¼ˆå®é™…å¼€å‘ä¸­ä»å‰ç«¯æ¥æ”¶ï¼‰</span>
            <span class="hljs-built_in">int</span> currentPage = <span class="hljs-number">1</span>;       <span class="hljs-comment">// å½“å‰é¡µç ï¼ˆå‰ç«¯é»˜è®¤ä»1å¼€å§‹ï¼ŒESä»0å¼€å§‹ï¼‰</span>
            <span class="hljs-built_in">int</span> pageSize = <span class="hljs-number">2</span>;          <span class="hljs-comment">// æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span>
            String sortField = <span class="hljs-string">"price"</span>;<span class="hljs-comment">// æ’åºå­—æ®µï¼ˆå•†å“ä»·æ ¼ï¼‰</span>
            String sortOrder = <span class="hljs-string">"desc"</span>; <span class="hljs-comment">// æ’åºæ–¹å‘ï¼ˆdescï¼šé™åºï¼›ascï¼šå‡åºï¼‰</span>

            <span class="hljs-comment">// 2. è®¡ç®—èµ·å§‹åç§»é‡ï¼ˆfrom = (å½“å‰é¡µç -1) * æ¯é¡µæ¡æ•°ï¼‰</span>
            <span class="hljs-built_in">int</span> <span class="hljs-keyword">from</span> = (currentPage - <span class="hljs-number">1</span>) * pageSize;

            <span class="hljs-comment">// 3. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆåˆ†é¡µ+æ’åº+æ¡ä»¶æŸ¥è¯¢ï¼‰</span>
            SearchRequest request = SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-keyword">from</span>(<span class="hljs-keyword">from</span>)                <span class="hljs-comment">// èµ·å§‹åç§»é‡</span>
                    .size(pageSize)            <span class="hljs-comment">// æ¯é¡µæ¡æ•°</span>
                    .sort(so -&gt; so             <span class="hljs-comment">// æ’åºé…ç½®</span>
                            .field(f -&gt; f
                                    .field(sortField)  <span class="hljs-comment">// æ’åºå­—æ®µ</span>
                                    <span class="hljs-comment">// æ’åºæ–¹å‘ï¼šæ ¹æ®å‰ç«¯å‚æ•°åŠ¨æ€è®¾ç½®</span>
                                    .order(<span class="hljs-string">"desc"</span>.<span class="hljs-keyword">equals</span>(sortOrder) ? SortOrder.Desc : SortOrder.Asc)
                            )
                    )
                    .query(q -&gt; q              <span class="hljs-comment">// å¯é€‰ï¼šæ·»åŠ æŸ¥è¯¢æ¡ä»¶ï¼ˆå¦‚ä»·æ ¼&gt;5000ï¼‰</span>
                            .range(r -&gt; r
                                    .number(n -&gt; n
                                            .field(<span class="hljs-string">"price"</span>)
                                            .gt(<span class="hljs-number">5000.0</span>)
                                    )
                            )
                    )
            );

            <span class="hljs-comment">// 4. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.<span class="hljs-keyword">class</span>);
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();

            <span class="hljs-comment">// è§£æåˆ†é¡µç›¸å…³ä¿¡æ¯</span>
            <span class="hljs-built_in">long</span> total = response.hits().total().<span class="hljs-keyword">value</span>(); <span class="hljs-comment">// æ€»æ¡æ•°</span>
            <span class="hljs-built_in">long</span> totalPage = (total + pageSize - <span class="hljs-number">1</span>) / pageSize; <span class="hljs-comment">// æ€»é¡µæ•°</span>

            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åˆ†é¡µæŸ¥è¯¢ç»“æœï¼š"</span>);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ€»æ¡æ•°ï¼š"</span> + total + <span class="hljs-string">"ï¼Œæ€»é¡µæ•°ï¼š"</span> + totalPage + <span class="hljs-string">"ï¼Œå½“å‰é¡µç ï¼š"</span> + currentPage);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å½“å‰é¡µå•†å“ï¼š"</span>);
            hits.forEach(hit -&gt; {
                Product product = hit.source();
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å•†å“ï¼š"</span> + product.getName() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.getPrice());
            });

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>2.5.2 è¡¥å……ï¼šæ·±åº¦åˆ†é¡µè§£å†³æ–¹æ¡ˆ</strong></p>
<p>é’ˆå¯¹å¤§æ•°æ®é‡æ·±åº¦åˆ†é¡µåœºæ™¯ï¼Œæ¨èä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆï¼Œé¿å…from+sizeçš„æ€§èƒ½ç“¶é¢ˆï¼š</p>
<ol>
<li><strong>Search Afterï¼ˆæ¨èå®æ—¶æ·±åº¦åˆ†é¡µï¼‰</strong> ï¼šåŸºäºä¸Šä¸€é¡µæœ€åä¸€æ¡æ•°æ®çš„æ’åºå€¼ä½œä¸ºâ€œé”šç‚¹â€ï¼Œé¿å…è®¡ç®—åç§»é‡ï¼Œæ”¯æŒå®æ—¶æŸ¥è¯¢ï¼Œé€‚åˆå‰ç«¯åˆ—è¡¨åˆ†é¡µï¼ˆå¦‚APPå•†å“åˆ—è¡¨ç¿»é¡µï¼‰ã€‚</li>
<li><strong>Scroll APIï¼ˆé€‚åˆæ‰¹é‡å¯¼å‡º/æ‰¹å¤„ç†ï¼‰</strong> ï¼šåˆ›å»ºæŸ¥è¯¢å¿«ç…§ï¼Œé€šè¿‡æ¸¸æ ‡æ‰¹é‡è·å–ç»“æœï¼Œä¸æ”¯æŒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25AE%259E%25E6%2597%25B6%25E6%2595%25B0%25E6%258D%25AE%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å®æ—¶æ•°æ®</a>ï¼ˆå¿«ç…§åˆ›å»ºåçš„æ•°æ®å˜æ›´ä¸ä¼šä½“ç°ï¼‰ï¼Œé€‚åˆå…¨é‡æ•°æ®å¯¼å‡ºã€ETLæµç¨‹ç­‰ç¦»çº¿åœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-11">2.6 èšåˆæ“ä½œï¼ˆç»Ÿè®¡åˆ†æï¼‰</h3>
<p>èšåˆæ“ä½œé€‚ç”¨äº<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%2595%25B0%25E6%258D%25AE%25E7%25BB%259F%25E8%25AE%25A1%25E5%2588%2586%25E6%259E%2590%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ•°æ®ç»Ÿè®¡åˆ†æ</a>åœºæ™¯ï¼ˆå¦‚å•†å“ä»·æ ¼å¹³å‡å€¼ã€ä¸åŒç±»åˆ«çš„å•†å“æ•°é‡ç»Ÿè®¡ï¼‰ï¼ŒES 9.Xå®¢æˆ·ç«¯æ”¯æŒåŸºç¡€èšåˆå’Œå¤šçº§åµŒå¥—èšåˆï¼Œä»¥ä¸‹ç»“åˆç¤ºä¾‹æ¼”ç¤ºã€‚</p>
<p><strong>2.6.1 åŸºç¡€èšåˆï¼ˆstats/termsï¼‰</strong></p>
<p>å¸¸è§åŸºç¡€èšåˆç±»å‹ï¼š</p>
<ul>
<li><code>stats</code>ï¼šç»Ÿè®¡èšåˆï¼ˆè®¡ç®—å­—æ®µçš„å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ€»å’Œã€è®¡æ•°ï¼‰</li>
<li><code>terms</code>ï¼šåˆ†ç»„èšåˆï¼ˆæ ¹æ®å­—æ®µåˆ†ç»„ï¼Œç»Ÿè®¡æ¯ç»„çš„æ–‡æ¡£æ•°é‡ï¼‰</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.Aggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StatsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsBucket</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;

<span class="hljs-comment">/**
 * åŸºç¡€èšåˆæ“ä½œï¼ˆstatsç»Ÿè®¡èšåˆ + termsåˆ†ç»„èšåˆï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsAggregationBasic</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºåŸºç¡€æŸ¥è¯¢æ¡ä»¶ï¼ˆå¯é€‰ï¼šè¿‡æ»¤éœ€è¦ç»Ÿè®¡çš„æ•°æ®ï¼‰</span>
            <span class="hljs-selector-tag">RangeQuery</span> <span class="hljs-selector-tag">rangeQuery</span> = <span class="hljs-selector-tag">RangeQuery</span><span class="hljs-selector-class">.of</span>(r -&gt; r
                    .<span class="hljs-built_in">number</span>(n -&gt; n
                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)
                            .<span class="hljs-built_in">gte</span>(<span class="hljs-number">5000.0</span>)
                            .<span class="hljs-built_in">lte</span>(<span class="hljs-number">10000.0</span>)
                    )
            );

            <span class="hljs-comment">// 2. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œæ·»åŠ èšåˆæ“ä½œ</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q.<span class="hljs-built_in">range</span>(rangeQuery)) <span class="hljs-comment">// åŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼ˆä»·æ ¼5000-10000ï¼‰</span>
                    .<span class="hljs-built_in">from</span>(<span class="hljs-number">0</span>).<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)               <span class="hljs-comment">// åˆ†é¡µï¼šåªæŸ¥è¯¢å‰10æ¡æ–‡æ¡£ï¼ˆèšåˆç»“æœä¸å—å½±å“ï¼‰</span>
                    <span class="hljs-comment">// èšåˆ1ï¼šä»·æ ¼ç»Ÿè®¡ï¼ˆstatsï¼‰ï¼Œèšåˆåç§°ï¼šprice_stats</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"price_stats"</span>, a -&gt; a
                            .<span class="hljs-built_in">stats</span>(st -&gt; st.<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>))
                    )
                    <span class="hljs-comment">// èšåˆ2ï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsï¼‰ï¼Œèšåˆåç§°ï¼šcategory_termsï¼ˆæ­¤å¤„å‡è®¾å­˜åœ¨categoryå­—æ®µï¼‰</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"category_terms"</span>, a -&gt; a
                            .<span class="hljs-built_in">terms</span>(t -&gt; t
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"category.keyword"</span>) <span class="hljs-comment">// categoryå­—æ®µéœ€ä¸ºkeywordç±»å‹ï¼ˆåˆ†ç»„èšåˆæ¨èï¼‰</span>
                                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)                  <span class="hljs-comment">// åªæ˜¾ç¤ºå‰10ä¸ªåˆ†ç»„</span>
                            )
                    )
            );

            <span class="hljs-comment">// 3. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 4. è§£æèšåˆç»“æœï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰</span>
            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">aggregations</span>() != null) {
                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">aggregations</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.aggregations</span>();

                <span class="hljs-comment">// 4.1 è§£æä»·æ ¼ç»Ÿè®¡èšåˆï¼ˆstatsï¼‰</span>
                <span class="hljs-selector-tag">StatsAggregate</span> <span class="hljs-selector-tag">priceStats</span> = <span class="hljs-selector-tag">aggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"price_stats"</span>)<span class="hljs-selector-class">.stats</span>();
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å•†å“ä»·æ ¼ç»Ÿè®¡ï¼ˆ5000-10000å…ƒï¼‰ï¼š"</span>);
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¹³å‡ä»·æ ¼ï¼š"</span> + String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"%.2f"</span>, priceStats.<span class="hljs-built_in">avg</span>()));
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœ€é«˜ä»·æ ¼ï¼š"</span> + priceStats.<span class="hljs-built_in">max</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœ€ä½ä»·æ ¼ï¼š"</span> + priceStats.<span class="hljs-built_in">min</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ä»·æ ¼æ€»å’Œï¼š"</span> + priceStats.<span class="hljs-built_in">sum</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ç»Ÿè®¡å•†å“æ•°é‡ï¼š"</span> + priceStats.<span class="hljs-built_in">count</span>());

                <span class="hljs-comment">// 4.2 è§£æç±»åˆ«åˆ†ç»„èšåˆï¼ˆtermsï¼‰</span>
                <span class="hljs-selector-tag">StringTermsAggregate</span> <span class="hljs-selector-tag">categoryTerms</span> = <span class="hljs-selector-tag">aggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"category_terms"</span>)<span class="hljs-selector-class">.sterms</span>();
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"\nå•†å“ç±»åˆ«åˆ†ç»„ç»Ÿè®¡ï¼š"</span>);
                <span class="hljs-selector-tag">for</span> (StringTermsBucket <span class="hljs-attribute">bucket </span>: categoryTerms.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                    <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">category</span> = <span class="hljs-selector-tag">bucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// åˆ†ç»„åç§°ï¼ˆç±»åˆ«ï¼‰</span>
                    <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">count</span> = <span class="hljs-selector-tag">bucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ç±»åˆ«çš„å•†å“æ•°é‡</span>
                    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ç±»åˆ«ï¼š"</span> + category + <span class="hljs-string">"ï¼Œå•†å“æ•°é‡ï¼š"</span> + count);
                }
            }

            <span class="hljs-comment">// 5. è§£ææ–‡æ¡£ç»“æœï¼ˆå¯é€‰ï¼‰</span>
            <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.forEach</span>(hit -&gt; {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"\næ–‡æ¡£è¯¦æƒ…ï¼š"</span> + hit.<span class="hljs-built_in">source</span>());
            });

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
        }
    }
}
</code></pre>
<p><strong>2.6.2 å¤šçº§åµŒå¥—èšåˆï¼ˆterms+range+avg/sumï¼‰</strong></p>
<p>å¤šçº§åµŒå¥—èšåˆé€‚ç”¨äºå¤æ‚ç»Ÿè®¡åœºæ™¯ï¼ˆå¦‚â€œæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ â†’ æ¯ç»„å†…æŒ‰ä»·æ ¼åŒºé—´åˆ†ç»„ â†’ ç»Ÿè®¡æ¯ä¸ªä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†å’Œé”€å”®æ€»é‡â€ï¼‰ï¼Œä»¥ä¸‹ä¿®å¤åŸå§‹ä»£ç bugï¼Œæ¼”ç¤ºå®Œæ•´åµŒå¥—èšåˆã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.AvgAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.RangeAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.RangeBucket</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsBucket</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.TopHitsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.SearchHit</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.json</span><span class="hljs-selector-class">.JsonData</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.SortOrder</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;

<span class="hljs-comment">/**
 * å¤šçº§åµŒå¥—èšåˆï¼ˆtermsåˆ†ç»„ â†’ rangeåˆ†ç»„ â†’ avg/sumç»Ÿè®¡ï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsAggregationNested</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºåŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼ˆè°ƒæ•´ä»·æ ¼èŒƒå›´ï¼Œè¦†ç›–åç»­æ‰€æœ‰åŒºé—´ï¼Œé¿å…ç»Ÿè®¡ä¸åˆ°æ•°æ®ï¼‰</span>
            <span class="hljs-selector-tag">RangeQuery</span> <span class="hljs-selector-tag">rangeQuery</span> = <span class="hljs-selector-tag">RangeQuery</span><span class="hljs-selector-class">.of</span>(r -&gt; r
                    .<span class="hljs-built_in">number</span>(n -&gt; n
                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)
                            .<span class="hljs-built_in">gte</span>(<span class="hljs-number">0.0</span>)       <span class="hljs-comment">// è¦†ç›–ä½ä»·åŒºé—´</span>
                            .<span class="hljs-built_in">lte</span>(<span class="hljs-number">200.0</span>)     <span class="hljs-comment">// è¦†ç›–é«˜ä»·åŒºé—´</span>
                    )
            );

            <span class="hljs-comment">// 2. æ„å»ºå¤šçº§åµŒå¥—èšåˆæŸ¥è¯¢è¯·æ±‚</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q.<span class="hljs-built_in">range</span>(rangeQuery))  <span class="hljs-comment">// åŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼Œç­›é€‰æœ‰æ•ˆå•†å“</span>
                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">0</span>)                          <span class="hljs-comment">// ä¸è¿”å›å…·ä½“æ–‡æ¡£ï¼Œåªå…³æ³¨èšåˆç»“æœï¼ˆæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰</span>
                    <span class="hljs-comment">// ç¬¬ä¸€çº§èšåˆï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsï¼‰ï¼Œèšåˆåç§°ï¼šcategory_analysis</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"category_analysis"</span>, a -&gt; a
                            .<span class="hljs-built_in">terms</span>(t -&gt; t
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"category.keyword"</span>) <span class="hljs-comment">// æŒ‰ç±»åˆ«åˆ†ç»„ï¼ˆkeywordç±»å‹ï¼Œç¡®ä¿åˆ†ç»„ç²¾å‡†ï¼‰</span>
                                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)                  <span class="hljs-comment">// æ˜¾ç¤ºå‰10ä¸ªç±»åˆ«ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´</span>
                            )
                            <span class="hljs-comment">// ç¬¬äºŒçº§èšåˆ1ï¼šæŒ‰ä»·æ ¼åŒºé—´åˆ†ç»„ï¼ˆrangeï¼‰ï¼Œèšåˆåç§°ï¼šprice_ranges</span>
                            .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"price_ranges"</span>, a2 -&gt; a2
                                    .<span class="hljs-built_in">range</span>(r -&gt; r
                                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)  <span class="hljs-comment">// ä»·æ ¼åŒºé—´åˆ†ç»„å­—æ®µï¼ˆæ•°å€¼ç±»å‹ï¼‰</span>
                                            .<span class="hljs-built_in">ranges</span>(         <span class="hljs-comment">// å®šä¹‰3ä¸ªä»·æ ¼åŒºé—´ï¼Œæ¸…æ™°åŒºåˆ†ä½/ä¸­/é«˜ä»·</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"low"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">0.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">50.0</span>),      <span class="hljs-comment">// 0-50å…ƒï¼ˆä½ä»·ï¼‰</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"medium"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">50.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">100.0</span>),  <span class="hljs-comment">// 50-100å…ƒï¼ˆä¸­ä»·ï¼‰</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"high"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">100.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">200.0</span>)  <span class="hljs-comment">// 100-200å…ƒï¼ˆé«˜ä»·ï¼‰</span>
                                            )
                                    )
                                    <span class="hljs-comment">// ç¬¬ä¸‰çº§èšåˆ1ï¼šæ¯ä¸ªä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†ï¼ˆavgï¼‰</span>
                                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"avg_rating"</span>, a3 -&gt; a3
                                            .<span class="hljs-built_in">avg</span>(avg -&gt; avg.<span class="hljs-built_in">field</span>(<span class="hljs-string">"rating"</span>)) <span class="hljs-comment">// å‡è®¾å­˜åœ¨ratingï¼ˆå•†å“è¯„åˆ†ï¼‰å­—æ®µ</span>
                                    )
                                    <span class="hljs-comment">// ç¬¬ä¸‰çº§èšåˆ2ï¼šæ¯ä¸ªä»·æ ¼åŒºé—´çš„é”€å”®æ€»é‡ï¼ˆsumï¼‰</span>
                                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"total_sales"</span>, a3 -&gt; a3
                                            .<span class="hljs-built_in">sum</span>(sum -&gt; sum.<span class="hljs-built_in">field</span>(<span class="hljs-string">"sales"</span>)) <span class="hljs-comment">// å‡è®¾å­˜åœ¨salesï¼ˆå•†å“é”€é‡ï¼‰å­—æ®µ</span>
                                    )
                            )
                            <span class="hljs-comment">// ç¬¬äºŒçº§èšåˆ2ï¼šæ¯ä¸ªç±»åˆ«ä¸‹çš„çƒ­é—¨å•†å“ï¼ˆtopHitsï¼‰ï¼Œå–é”€é‡å‰3</span>
                            .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"top_products"</span>, a2 -&gt; a2
                                    .<span class="hljs-built_in">topHits</span>(th -&gt; th
                                            .<span class="hljs-built_in">size</span>(<span class="hljs-number">3</span>) <span class="hljs-comment">// æ¯ä¸ªç±»åˆ«æ˜¾ç¤ºå‰3ä¸ªçƒ­é—¨å•†å“</span>
                                            .<span class="hljs-built_in">sort</span>(so -&gt; so
                                                    .<span class="hljs-built_in">field</span>(f -&gt; f
                                                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"sales"</span>) <span class="hljs-comment">// æŒ‰é”€é‡é™åºæ’åºï¼Œç­›é€‰çƒ­é—¨</span>
                                                            .<span class="hljs-built_in">order</span>(SortOrder.Desc)
                                                    )
                                            )
                                    )
                            )
                    )
            );

            <span class="hljs-comment">// 3. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”ç»“æœ</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 4. è§£æå¤šçº§åµŒå¥—èšåˆç»“æœï¼ˆä¿®å¤åŸå§‹bugï¼Œå®Œå–„è·¯å¾„è·å–å’Œéç©ºæ ¡éªŒï¼‰</span>
            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">aggregations</span>() != null) {
                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">rootAggregations</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.aggregations</span>();

                <span class="hljs-comment">// 4.1 è·å–ç¬¬ä¸€çº§èšåˆï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsèšåˆï¼‰ï¼Œéç©ºæ ¡éªŒé¿å…ç©ºæŒ‡é’ˆ</span>
                <span class="hljs-selector-tag">if</span> (rootAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"category_analysis"</span>)) {
                    <span class="hljs-selector-tag">StringTermsAggregate</span> <span class="hljs-selector-tag">categoryAgg</span> = <span class="hljs-selector-tag">rootAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"category_analysis"</span>)<span class="hljs-selector-class">.sterms</span>();

                    <span class="hljs-comment">// 4.2 éå†æ¯ä¸ªç±»åˆ«æ¡¶ï¼ˆç¬¬ä¸€çº§èšåˆç»“æœï¼‰</span>
                    <span class="hljs-selector-tag">for</span> (StringTermsBucket <span class="hljs-attribute">categoryBucket </span>: categoryAgg.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">category</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// å•†å“ç±»åˆ«åç§°</span>
                        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">categoryDocCount</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ç±»åˆ«çš„å•†å“æ€»æ•°</span>
                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"=== å•†å“ç±»åˆ«ï¼š"</span> + category + <span class="hljs-string">"ï¼ˆå•†å“æ€»æ•°ï¼š"</span> + categoryDocCount + <span class="hljs-string">"ï¼‰==="</span>);

                        <span class="hljs-comment">// 4.3 è·å–ç¬¬äºŒçº§èšåˆï¼šè¯¥ç±»åˆ«ä¸‹çš„ä»·æ ¼åŒºé—´åˆ†ç»„ï¼ˆrangeèšåˆï¼‰</span>
                        <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">categoryAggregations</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.aggregations</span>();
                        <span class="hljs-selector-tag">if</span> (categoryAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"price_ranges"</span>)) {
                            <span class="hljs-selector-tag">RangeAggregate</span> <span class="hljs-selector-tag">priceRangeAgg</span> = <span class="hljs-selector-tag">categoryAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"price_ranges"</span>)<span class="hljs-selector-class">.range</span>();

                            <span class="hljs-comment">// 4.4 éå†æ¯ä¸ªä»·æ ¼åŒºé—´æ¡¶ï¼ˆç¬¬äºŒçº§èšåˆç»“æœï¼‰</span>
                            <span class="hljs-selector-tag">for</span> (RangeBucket <span class="hljs-attribute">priceBucket </span>: priceRangeAgg.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                                <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">priceRange</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// ä»·æ ¼åŒºé—´æ ‡è¯†ï¼ˆlow/medium/highï¼‰</span>
                                <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">priceDocCount</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ä»·æ ¼åŒºé—´çš„å•†å“æ•°é‡</span>
                                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  ä»·æ ¼åŒºé—´ï¼š"</span> + priceRange + <span class="hljs-string">"ï¼ˆå•†å“æ•°é‡ï¼š"</span> + priceDocCount + <span class="hljs-string">"ï¼‰"</span>);

                                <span class="hljs-comment">// 4.5 è·å–ç¬¬ä¸‰çº§èšåˆ1ï¼šè¯¥ä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†ï¼ˆavgèšåˆï¼‰</span>
                                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">priceAggregations</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.aggregations</span>();
                                <span class="hljs-selector-tag">if</span> (priceAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"avg_rating"</span>)) {
                                    <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">avgRatingAgg</span> = <span class="hljs-selector-tag">priceAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"avg_rating"</span>);
                                    <span class="hljs-selector-tag">if</span> (avgRatingAgg != null &amp;&amp; avgRatingAgg.<span class="hljs-built_in">isAvg</span>()) {
                                        <span class="hljs-selector-tag">AvgAggregate</span> <span class="hljs-selector-tag">avgRating</span> = <span class="hljs-selector-tag">avgRatingAgg</span><span class="hljs-selector-class">.avg</span>();
                                        <span class="hljs-comment">// å®‰å…¨æ ¡éªŒï¼Œé¿å…nullå€¼å¼‚å¸¸ï¼Œä¿ç•™2ä½å°æ•°ï¼Œæå‡å¯è¯»æ€§</span>
                                        <span class="hljs-selector-tag">double</span> <span class="hljs-selector-tag">avg</span> = <span class="hljs-selector-tag">avgRating</span><span class="hljs-selector-class">.value</span>() != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">avgRating</span><span class="hljs-selector-class">.value</span>() : <span class="hljs-number">0.0</span>;
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    å¹³å‡è¯„åˆ†ï¼š"</span> + String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"%.2f"</span>, avg));
                                    }
                                }

                                <span class="hljs-comment">// 4.6 è·å–ç¬¬ä¸‰çº§èšåˆ2ï¼šè¯¥ä»·æ ¼åŒºé—´çš„é”€å”®æ€»é‡ï¼ˆsumèšåˆï¼‰</span>
                                <span class="hljs-selector-tag">if</span> (priceAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"total_sales"</span>)) {
                                    <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">totalSalesAgg</span> = <span class="hljs-selector-tag">priceAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"total_sales"</span>);
                                    <span class="hljs-selector-tag">if</span> (totalSalesAgg != null &amp;&amp; totalSalesAgg.<span class="hljs-built_in">isSum</span>()) {
                                        <span class="hljs-comment">// è§£æsumèšåˆç»“æœï¼Œå…¼å®¹æ•°å€¼ç±»å‹</span>
                                        <span class="hljs-selector-tag">JsonData</span> <span class="hljs-selector-tag">salesData</span> = <span class="hljs-selector-tag">totalSalesAgg</span><span class="hljs-selector-class">.sum</span>()<span class="hljs-selector-class">.value</span>();
                                        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">totalSales</span> = <span class="hljs-selector-tag">salesData</span> != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">salesData</span><span class="hljs-selector-class">.toLong</span>() : <span class="hljs-number">0</span>;
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    é”€å”®æ€»é‡ï¼š"</span> + totalSales);
                                    }
                                }
                            }
                        }

                        <span class="hljs-comment">// 4.7 è·å–ç¬¬äºŒçº§èšåˆ2ï¼šè¯¥ç±»åˆ«ä¸‹çš„çƒ­é—¨å•†å“ï¼ˆtopHitsèšåˆï¼‰</span>
                        <span class="hljs-selector-tag">if</span> (categoryAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"top_products"</span>)) {
                            <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">topProductsAgg</span> = <span class="hljs-selector-tag">categoryAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"top_products"</span>);
                            <span class="hljs-selector-tag">if</span> (topProductsAgg != null &amp;&amp; topProductsAgg.<span class="hljs-built_in">isTopHits</span>()) {
                                <span class="hljs-selector-tag">TopHitsAggregate</span> <span class="hljs-selector-tag">topHits</span> = <span class="hljs-selector-tag">topProductsAgg</span><span class="hljs-selector-class">.topHits</span>();
                                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  è¯¥ç±»åˆ«çƒ­é—¨å•†å“ï¼ˆé”€é‡å‰3ï¼‰ï¼š"</span>);
                                <span class="hljs-comment">// éå†çƒ­é—¨å•†å“ï¼Œååºåˆ—åŒ–ä¸ºProductå®ä½“</span>
                                <span class="hljs-selector-tag">for</span> (SearchHit&lt;Product&gt; <span class="hljs-attribute">hit </span>: topHits.<span class="hljs-built_in">hits</span>().<span class="hljs-built_in">hits</span>()) {
                                    <span class="hljs-selector-tag">Product</span> <span class="hljs-selector-tag">product</span> = <span class="hljs-selector-tag">hit</span><span class="hljs-selector-class">.source</span>();
                                    <span class="hljs-selector-tag">if</span> (product != null) {
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    - å•†å“ï¼š"</span> + product.<span class="hljs-built_in">getName</span>() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.<span class="hljs-built_in">getPrice</span>() + <span class="hljs-string">"ï¼Œé”€é‡ï¼š"</span> + hit.<span class="hljs-built_in">fields</span>().<span class="hljs-built_in">get</span>(<span class="hljs-string">"sales"</span>).<span class="hljs-built_in">value</span>());
                                    }
                                }
                            }
                        }
                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(); <span class="hljs-comment">// æ¢è¡Œï¼ŒåŒºåˆ†ä¸åŒç±»åˆ«ï¼Œæå‡å¯è¯»æ€§</span>
                    }
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°å•†å“ç±»åˆ«èšåˆæ•°æ®ï¼Œè¯·æ£€æŸ¥categoryå­—æ®µæ˜¯å¦å­˜åœ¨ä¸”ä¸ºkeywordç±»å‹"</span>);
                }
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°ä»»ä½•èšåˆç»“æœï¼Œè¯·æ£€æŸ¥ç´¢å¼•æ•°æ®æˆ–æŸ¥è¯¢æ¡ä»¶"</span>);
            }

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
            <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¤šçº§åµŒå¥—èšåˆæŸ¥è¯¢å¤±è´¥ï¼š"</span> + e.<span class="hljs-built_in">getMessage</span>());
        } <span class="hljs-selector-tag">finally</span> {
            <span class="hljs-comment">// é¡¹ç›®åœæ­¢æ—¶å…³é—­å®¢æˆ·ç«¯ï¼ˆå®é™…å¼€å‘ä¸­å¯åœ¨Springé”€æ¯æ–¹æ³•ã€Tomcatå…³é—­é’©å­ä¸­è°ƒç”¨ï¼‰</span>
            <span class="hljs-comment">// EsClientUtil.closeClient();</span>
        }
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†]]></title>    <link>https://juejin.cn/post/7603263490341535753</link>    <guid>https://juejin.cn/post/7603263490341535753</guid>    <pubDate>2026-02-06T01:26:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490341535753" data-draft-id="7603216479836274739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-06T01:26:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:26:12.000Z" title="Fri Feb 06 2026 01:26:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>React çš„ç—›ï¼š</strong> åœ¨ React ä¸­ï¼Œä¸€ä¸ª State å˜äº†ï¼Œç»„ä»¶å°±ä¼šé‡æ–°æ‰§è¡Œï¼ˆRe-renderï¼‰ã€‚ä¸ºäº†æ€§èƒ½ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æå‡º Fiber æ¶æ„ï¼Œæå‡ºæ—¶é—´åˆ‡ç‰‡ï¼Œæå‡º <code>useMemo</code>ã€‚è¿™å°±å¥½æ¯”ï¼šä¸ºäº†èƒ½åœ¨å¹²è‰å †é‡Œæ‰¾åˆ°ä¸€æ ¹é’ˆï¼ŒReact å‘æ˜äº†ä¸€å°è¶…çº§é«˜ç§‘æŠ€çš„â€œå¹²è‰å †ç¿»æ‰¾æœºâ€ã€‚</p>
<p><strong>Signal çš„è§£ï¼š</strong> ç»†ç²’åº¦å“åº”å¼ï¼ˆSignalï¼‰çš„æ€è·¯æ˜¯ï¼šåœ¨æ‰”é’ˆè¿›å»çš„æ—¶å€™ï¼Œå°±ç»™é’ˆç³»ä¸Šä¸€æ ¹ç»³å­ã€‚è¦æ‰¾é’ˆçš„æ—¶å€™ï¼Œæ‹‰ç»³å­å°±è¡Œäº†ã€‚</p>
<p>æœ¬ç¯‡æˆ‘ä»¬å°†æ·±å…¥å†…æ ¸ï¼Œæ‰‹å†™ä¸€ä¸ªè¿·ä½  Signal ç³»ç»Ÿï¼Œçœ‹æ¸…å®ƒçš„æœ¬è´¨ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a64a10d9a9ee4d519310f44fbbe360f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770945971&amp;x-signature=4nRcz5vcrElDAbL%2FHZPBBvC7afs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ å®è§‚å¯¹å†³ï¼šVDOM vs. Fine-Grained (ç»†ç²’åº¦)</h2>
<p>è¦ç†è§£ Signalï¼Œé¦–å…ˆè¦ç†è§£å®ƒæƒ³é©è°çš„å‘½ã€‚</p>
<h3 data-id="heading-1">1.1 VDOM çš„â€œåœ°æ¯¯å¼æœç´¢â€</h3>
<p>React çš„æ›´æ–°æ¨¡å‹æ˜¯ <strong>Snapshotï¼ˆå¿«ç…§ï¼‰</strong> å¼çš„ã€‚</p>
<ul>
<li><strong>æµç¨‹ï¼š</strong> æ•°æ®å˜äº† -&gt; è¿è¡Œæ•´ä¸ªç»„ä»¶å‡½æ•° -&gt; ç”Ÿæˆæ–°çš„ VDOM æ ‘ -&gt; å¯¹æ¯”æ–°æ—§æ ‘ (Diff) -&gt; æ‰¾å‡ºå·®å¼‚ -&gt; æ›´æ–° DOMã€‚</li>
<li><strong>å¤æ‚åº¦ï¼š</strong> è·Ÿç»„ä»¶æ ‘çš„å¤§å°æˆæ­£æ¯”ã€‚</li>
<li><strong>é—®é¢˜ï¼š</strong> å“ªæ€•åªæ”¹äº†ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ•´ä¸ªç»„ä»¶ï¼ˆç”šè‡³å­ç»„ä»¶ï¼‰çš„é€»è¾‘éƒ½è¦é‡è·‘ä¸€éã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 Signal çš„â€œç‚¹å¯¹ç‚¹ç‹™å‡»â€</h3>
<p>SolidJS æˆ– Vue çš„æ›´æ–°æ¨¡å‹æ˜¯ <strong>Dependency Graphï¼ˆä¾èµ–å›¾ï¼‰</strong> å¼çš„ã€‚</p>
<ul>
<li><strong>æµç¨‹ï¼š</strong> æ•°æ®å˜äº† -&gt; <strong>ç›´æ¥å®šä½</strong>åˆ°ç»‘å®šäº†è¯¥æ•°æ®çš„ DOM èŠ‚ç‚¹ -&gt; æ›´æ–° DOMã€‚</li>
<li><strong>å¤æ‚åº¦ï¼š</strong> è·ŸåŠ¨æ€èŠ‚ç‚¹çš„æ•°é‡æˆæ­£æ¯”ï¼ˆé€šå¸¸æ˜¯ O(1)ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒï¼š</strong> ç»„ä»¶å‡½æ•°åªåœ¨åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ï¼ä¹‹åå†ä¹Ÿä¸ä¼šè¿è¡Œäº†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€ è§£å‰– Signalï¼šå‘å¸ƒè®¢é˜…çš„è¿›åŒ–ä½“</h2>
<p>Signal å¹¶ä¸ç¥ç§˜ï¼Œå®ƒæœ¬è´¨ä¸Šå°±æ˜¯ <strong>â€œä¿å­˜å€¼çš„å®¹å™¨â€ + â€œè‡ªåŠ¨ä¾èµ–è¿½è¸ªâ€</strong> ã€‚ å®ƒç”±ä¸¤ä¸ªæ ¸å¿ƒåŠ¨ä½œç»„æˆï¼š<strong>Track (è¿½è¸ª/è¯»)</strong> å’Œ <strong>Trigger (è§¦å‘/å†™)</strong> ã€‚</p>
<h3 data-id="heading-4">2.1 æ ¸å¿ƒ API æ¨¡æ‹Ÿ</h3>
<p>ä»¥ SolidJS/React é£æ ¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€ ä¸€ä¸ª Signalï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®°å½•â€œå½“å‰è°åœ¨æŸ¥æˆ‘ä¸ï¼Ÿâ€
let <span class="hljs-attr">activeEffect</span> = null<span class="hljs-comment">;</span>

function createSignal(initialValue) {
  let <span class="hljs-attr">value</span> = initialValue<span class="hljs-comment">;</span>
  const <span class="hljs-attr">subscribers</span> = new Set()<span class="hljs-comment">; // è®¢é˜…è€…åå•</span>

  // Getter (è¯»)
  const <span class="hljs-attr">read</span> = () =&gt; {
    if (activeEffect) {
      // 1. ä¾èµ–æ”¶é›† (Track)ï¼šå¦‚æœæœ‰äººåœ¨å…³æ³¨æˆ‘ï¼ŒæŠŠä»–è®°ä¸‹æ¥
      subscribers.add(activeEffect)<span class="hljs-comment">;</span>
    }
    return value<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  // Setter (å†™)
  const <span class="hljs-attr">write</span> = (newValue) =&gt; {
    <span class="hljs-attr">value</span> = newValue<span class="hljs-comment">;</span>
    // 2. æ´¾å‘æ›´æ–° (Trigger)ï¼šé€šçŸ¥åå•é‡Œæ‰€æœ‰äººå¹²æ´»
    subscribers.forEach(<span class="hljs-attr">fn</span> =&gt; fn())<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  return <span class="hljs-section">[read, write]</span><span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-5">2.2 é­”æ³•çš„ç²˜åˆå‰‚ï¼šEffect</h3>
<p>å…‰æœ‰ Signal æ²¡ç”¨ï¼Œå¾—æœ‰äººâ€œè¯»â€å®ƒï¼Œè®¢é˜…å…³ç³»æ‰èƒ½å»ºç«‹ã€‚è¿™å°±éœ€è¦ <code>createEffect</code>ï¼ˆåœ¨ Vue é‡Œå« <code>watchEffect</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createEffect</span>(<span class="hljs-params">fn</span>) </span>{
  <span class="hljs-comment">// æŠŠè‡ªå·±æ ‡è®°ä¸ºâ€œæ­£åœ¨æ‰§è¡Œçš„å‰¯ä½œç”¨â€</span>
  activeEffect = <span class="hljs-function"><span class="hljs-keyword">fn</span></span>;
  
  <span class="hljs-comment">// æ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚</span>
  <span class="hljs-comment">// æ³¨æ„ï¼šå‡½æ•°å†…éƒ¨ä¼šè¯»å– Signalï¼Œä»è€Œè§¦å‘ Signal çš„ Getterï¼Œ</span>
  <span class="hljs-comment">// è¿›è€ŒæŠŠè¿™ä¸ª fn æ·»åŠ åˆ° subscribers é‡Œã€‚</span>
  <span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>)</span>;
  
  <span class="hljs-comment">// æ‰§è¡Œå®Œå¤åŸ</span>
  activeEffect = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-6">2.3 è·‘èµ·æ¥çœ‹çœ‹</h3>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[count, setCount]</span> = <span class="hljs-built_in">createSignal</span>(<span class="hljs-number">0</span>);

<span class="hljs-built_in">createEffect</span>(() =&gt; {
  console<span class="hljs-selector-class">.log</span>("æ•°å­—å˜äº†ï¼š", count()); 
});
<span class="hljs-comment">// è¾“å‡º: æ•°å­—å˜äº†ï¼š0 (åˆå§‹åŒ–æ‰§è¡Œ)</span>

<span class="hljs-built_in">setCount</span>(<span class="hljs-number">1</span>);
<span class="hljs-comment">// è¾“å‡º: æ•°å­—å˜äº†ï¼š1 (è‡ªåŠ¨è§¦å‘ï¼)</span>
</code></pre>
<p>è¿™å°±æ˜¯<strong>ç»†ç²’åº¦å“åº”å¼</strong>çš„æœ€ç®€å†…æ ¸ã€‚æ²¡æœ‰ä»»ä½• VDOMï¼Œæ²¡æœ‰ Diffï¼Œåªæœ‰ç²¾å‡†çš„å‡½æ•°è°ƒç”¨é“¾ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€ è¿›é˜¶ï¼š computed ä¸ä¾èµ–å›¾çš„è‡ªåŠ¨æ„å»º</h2>
<p>Signal ç³»ç»Ÿæœ€å¼ºå¤§çš„åœ°æ–¹åœ¨äºå®ƒèƒ½<strong>è‡ªåŠ¨æ„å»ºä¾èµ–å›¾</strong>ã€‚ åœ¨æ¶æ„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ <code>computed</code> (æ´¾ç”ŸçŠ¶æ€)ã€‚</p>
<p><code>computed</code> æ—¢æ˜¯ <strong>æ¶ˆè´¹è€…</strong>ï¼ˆå®ƒä¾èµ–åˆ«çš„ Signalï¼‰ï¼Œåˆæ˜¯ <strong>ç”Ÿäº§è€…</strong>ï¼ˆåˆ«çš„ Effect ä¾èµ–å®ƒï¼‰ã€‚</p>
<h3 data-id="heading-8">3.1 æ‡’è®¡ç®—ä¸ç¼“å­˜ (Memoization)</h3>
<p>ç»†ç²’åº¦æ¡†æ¶ä¸­çš„ <code>computed</code> é€šå¸¸æ˜¯æƒ°æ€§çš„ï¼ˆLazyï¼‰ã€‚</p>
<ul>
<li>åªæœ‰å½“æœ‰äººè¯»å®ƒæ—¶ï¼Œå®ƒæ‰è®¡ç®—ã€‚</li>
<li>å¦‚æœå®ƒä¾èµ–çš„ Signal æ²¡å˜ï¼Œå®ƒç›´æ¥è¿”å›ç¼“å­˜ã€‚</li>
</ul>
<h3 data-id="heading-9">3.2 åŠ¨æ€ä¾èµ–æ”¶é›†</h3>
<p>è¿™æ˜¯ React <code>useMemo</code> æ°¸è¿œåšä¸åˆ°çš„ã€‚ React çš„ä¾èµ–æ•°ç»„ <code>[a, b]</code> æ˜¯æ‰‹åŠ¨å£°æ˜çš„ï¼ˆé™æ€ï¼‰ã€‚è€Œ Signal çš„ä¾èµ–æ˜¯<strong>è¿è¡Œæ—¶åŠ¨æ€æ”¶é›†</strong>çš„ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[show, setShow]</span> = <span class="hljs-built_in">createSignal</span>(true);
const <span class="hljs-selector-attr">[name, setName]</span> = <span class="hljs-built_in">createSignal</span>("Gemini");
const <span class="hljs-selector-attr">[age, setAge]</span> = <span class="hljs-built_in">createSignal</span>(<span class="hljs-number">18</span>);

<span class="hljs-built_in">createEffect</span>(() =&gt; {
  <span class="hljs-comment">// åŠ¨æ€ä¾èµ–ï¼</span>
  if (show()) {
    console<span class="hljs-selector-class">.log</span>(name()); <span class="hljs-comment">// æ­¤æ—¶ä¾èµ–æ˜¯ [show, name]</span>
  } else {
    console<span class="hljs-selector-class">.log</span>(age());  <span class="hljs-comment">// æ­¤æ—¶ä¾èµ–å˜æˆ [show, age]</span>
  }
});
</code></pre>
<p><strong>æ¶æ„æ„ä¹‰ï¼š</strong> è¿™ç§æœºåˆ¶ä¿è¯äº†<strong>æœ€å°åŒ–è®¡ç®—</strong>ã€‚å½“ <code>show</code> ä¸º false æ—¶ï¼Œæ”¹å˜ <code>name</code> æ ¹æœ¬ä¸ä¼šè§¦å‘è¿™ä¸ª Effectï¼Œå› ä¸ºç³»ç»ŸçŸ¥é“è¿™ä¸€åˆ» <code>name</code> ä¸é‡è¦ã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€ ä¸ºä»€ä¹ˆ React è¿˜åœ¨åšæŒï¼Ÿ</h2>
<p>æ—¢ç„¶ Signal è¿™ä¹ˆå¥½ï¼Œæ€§èƒ½è¿™ä¹ˆé«˜ï¼Œä¸ºä»€ä¹ˆ React ä¸æŠŠ <code>useState</code> æ¢æˆ Signalï¼Ÿ è¿™æ¶‰åŠåˆ°åº•å±‚å“²å­¦çš„å†²çªã€‚</p>
<h3 data-id="heading-11">4.1 UI = f(state) vs. UI = Bind(state)</h3>
<ul>
<li><strong>React å“²å­¦ï¼š</strong> UI æ˜¯æ•°æ®çš„<strong>æŠ•å½±ï¼ˆSnapshotï¼‰</strong> ã€‚æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯ä¸¢å¼ƒæ—§ä¸–ç•Œï¼Œé‡å»ºæ–°ä¸–ç•Œã€‚è¿™ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„ç›´è§‰ï¼Œå¿ƒæ™ºæ¨¡å‹æœ€ç®€å•ã€‚</li>
<li><strong>Signal å“²å­¦ï¼š</strong> UI æ˜¯æ•°æ®çš„<strong>ç»‘å®šï¼ˆBindingï¼‰</strong> ã€‚åˆå§‹æ¸²æŸ“åï¼Œç»„ä»¶å°±æ¶ˆå¤±äº†ï¼Œå‰©ä¸‹çš„åªæœ‰æ•°æ®å’Œ DOM ä¹‹é—´çš„è¿çº¿ã€‚</li>
</ul>
<h3 data-id="heading-12">4.2 ä»£æ•°æ•ˆåº” (Algebraic Effects)</h3>
<p>React å›¢é˜Ÿè®¤ä¸ºï¼Œæ‰‹åŠ¨å¤„ç† <code>.value</code> æˆ–è€… <code>[get, set]</code> æ˜¯å¯¹å¼€å‘è€…å¿ƒæ™ºçš„è´Ÿæ‹…ã€‚ä»–ä»¬è¿½æ±‚çš„æ˜¯ <strong>"It just works"</strong> ã€‚ React æ­£åœ¨æçš„ <strong>React Compiler (React Forget)</strong> ï¼Œå…¶å®æ˜¯ä¸€æ¡æ®Šé€”åŒå½’çš„è·¯ï¼š</p>
<ul>
<li><strong>Signal:</strong> åœ¨<strong>è¿è¡Œæ—¶</strong>é€šè¿‡ Proxy æ”¶é›†ä¾èµ–ï¼Œå®ç°ç»†ç²’åº¦æ›´æ–°ã€‚</li>
<li><strong>React Compiler:</strong> åœ¨<strong>ç¼–è¯‘æ—¶</strong>åˆ†æä»£ç ï¼Œè‡ªåŠ¨æ’å…¥ memoizationï¼Œæ¨¡æ‹Ÿç»†ç²’åº¦æ›´æ–°çš„æ•ˆæœã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">äº”ã€ æ€»ç»“ï¼šæ¶æ„å¸ˆçš„é€‰æ‹©</h2>
<p>ç†è§£äº†åŸç†ï¼Œæˆ‘ä»¬åœ¨æ¶æ„è®¾è®¡ä¸­å°±èƒ½æ˜ç™½ï¼š</p>
<ol>
<li>
<p><strong>Vue 3 / Solid:</strong> é€‚åˆ<strong>é«˜æ€§èƒ½ä»ªè¡¨ç›˜ã€å³æ—¶é€šè®¯ã€å³æ—¶ç¼–è¾‘</strong>ç±»åº”ç”¨ã€‚å› ä¸ºå®ƒä»¬å¯¹ CPU çš„åˆ©ç”¨ç‡æé«˜ï¼Œæ²¡æœ‰ VDOM çš„ Overheadã€‚</p>
</li>
<li>
<p><strong>React:</strong> é€‚åˆ<strong>å¤§å‹ä¸šåŠ¡ç³»ç»Ÿã€ç”Ÿæ€ä¾èµ–é‡</strong>çš„åº”ç”¨ã€‚è™½ç„¶æœ‰ä¸€äº›æ€§èƒ½æŸè€—ï¼Œä½†å…¶ç¼–ç¨‹æ¨¡å‹çš„ä¸€è‡´æ€§ï¼ˆPure Renderï¼‰èƒ½é™ä½é€»è¾‘å¤æ‚åº¦ã€‚</p>
</li>
<li>
<p><strong>è¶‹åŠ¿:</strong> è¶Šæ¥è¶Šå¤šçš„çŠ¶æ€ç®¡ç†åº“ï¼ˆMobX, Valtio, Preact Signalsï¼‰å…è®¸ä½ åœ¨ React ä¸­ä½¿ç”¨ Signalã€‚</p>
<ul>
<li><strong>æ¶æ„æ¨¡å¼ï¼š</strong> ä½¿ç”¨ Signal ç®¡ç†é¢‘ç¹å˜åŒ–çš„<strong>å±€éƒ¨çŠ¶æ€</strong>ï¼ˆé¿å… React é¡¶å±‚é‡æ¸²æŸ“ï¼‰ï¼Œä½¿ç”¨ React Context ç®¡ç†ä½é¢‘çš„<strong>å…¨å±€çŠ¶æ€</strong>ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>Next Step:</strong> æˆ‘ä»¬ææ‡‚äº†å‰ç«¯â€œæ€ä¹ˆå­˜æ•°æ®â€ï¼ˆRedux/Atomicï¼‰å’Œâ€œæ€ä¹ˆæ›´æ–°æ•°æ®â€ï¼ˆSignalï¼‰ã€‚ ä½†è¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„éº»çƒ¦æ²¡è§£å†³ï¼š<strong>API æ•°æ®</strong>ã€‚ æˆ‘ä»¬ä»¥å‰æ€»æ˜¯æŠŠåç«¯è¿”å›çš„ JSON ä¹Ÿå¡è¿› Redux é‡Œï¼Œå¯¼è‡´ Redux å˜å¾—è‡ƒè‚¿ä¸å ªã€‚è¿™çœŸçš„æ˜¯å¯¹çš„å—ï¼Ÿ ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†é€šè¿‡ <strong>React Query (TanStack Query)</strong> æ¥ä¸€åœºæ¶æ„å¤§æ‰«é™¤ã€‚ è¯·çœ‹**ã€Šç¬¬ä¸‰ç¯‡ï¼šåˆ†æ²»â€”â€”æŠŠ API èµ¶å‡º Reduxï¼šæœåŠ¡ç«¯çŠ¶æ€ (Server State) ä¸å®¢æˆ·ç«¯çŠ¶æ€çš„æ¶æ„åˆ†ç¦»ã€‹**ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7603221478474170410</link>    <guid>https://juejin.cn/post/7603221478474170410</guid>    <pubDate>2026-02-06T01:03:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603221478474170410" data-draft-id="7492846604564201487" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="Kafka,æ¶ˆæ¯é˜Ÿåˆ—,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-06T01:03:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:03:30.000Z" title="Fri Feb 06 2026 01:03:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€</h2>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±åƒä¸€åº§åº§æ¡¥æ¢ï¼Œè¿æ¥ç€æ•°æ®çš„ç”Ÿäº§ä¸æ¶ˆè´¹ã€‚è€ŒApache Kafkaï¼Œä½œä¸ºé«˜ååã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—çš„ç¿˜æ¥šï¼Œå…¶ç”Ÿäº§è€…ï¼ˆProducerï¼‰æ— ç–‘æ˜¯è¿™åº§æ¡¥æ¢çš„èµ·ç‚¹ã€‚æ— è®ºæ˜¯å®æ—¶æ—¥å¿—æ”¶é›†ã€è®¢å•æµå¤„ç†ï¼Œè¿˜æ˜¯è·¨ç³»ç»Ÿçš„æ•°æ®åŒæ­¥ï¼Œç”Ÿäº§è€…éƒ½æ‰®æ¼”ç€å°†ä¸šåŠ¡æ•°æ®å¯é ã€é«˜æ•ˆé€è¾¾Kafkaé›†ç¾¤çš„å…³é”®è§’è‰²ã€‚ç„¶è€Œï¼Œç”Ÿäº§è€…çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™æš—è—ç„æœºï¼šæ¶ˆæ¯ä¸¢å¤±ã€æ€§èƒ½ç“¶é¢ˆã€å‚æ•°é…ç½®çš„â€œè¿·é›¾â€ï¼Œå¸¸å¸¸è®©å¼€å‘è€…å¤´ç–¼ä¸å·²ã€‚</p>
<p><strong>è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡</strong>ï¼Œå°±æ˜¯å¸¦ä½ æ·±å…¥Kafkaç”Ÿäº§è€…çš„â€œå‘åŠ¨æœºèˆ±â€ï¼Œæ‹†è§£å®ƒçš„æ ¸å¿ƒæœºåˆ¶ï¼Œåˆ†äº«åŸºäºçœŸå®é¡¹ç›®ç»éªŒçš„ä¼˜åŒ–æŠ€å·§å’Œæœ€ä½³å®è·µã€‚æ— è®ºä½ æ˜¯å¸Œæœ›æå‡æ¶ˆæ¯å‘é€çš„å¯é æ€§ï¼Œè¿˜æ˜¯æƒ³çªç ´æ€§èƒ½ç“¶é¢ˆï¼Œè¿™é‡Œéƒ½æœ‰ä½ éœ€è¦çš„å¹²è´§ã€‚æˆ‘ä»¬å°†ä»ç”Ÿäº§è€…çš„åŸºæœ¬å·¥ä½œæµç¨‹å…¥æ‰‹ï¼Œé€æ­¥å‰–ææ¶ˆæ¯å‘é€æ¨¡å¼ã€å¯é æ€§ä¿éšœã€æ€§èƒ½è°ƒä¼˜ç­‰æ ¸å¿ƒå†…å®¹ï¼Œå¹¶ç»“åˆå®é™…æ¡ˆä¾‹ï¼Œè®©ä½ å¯¹ç”Ÿäº§è€…çš„é…ç½®å’Œä½¿ç”¨èƒ¸æœ‰æˆç«¹ã€‚</p>
<p><strong>å¸¸è§ç—›ç‚¹</strong>ï¼Œä½ æ˜¯å¦ä¹Ÿé‡åˆ°è¿‡ï¼Ÿæ¯”å¦‚ï¼Œæ¶ˆæ¯è«åä¸¢å¤±ï¼ŒæŸ¥æ—¥å¿—å´æ— ä»ä¸‹æ‰‹ï¼›æˆ–è€…å‘é€å»¶è¿Ÿè¿‡é«˜ï¼Œååé‡å´ä¸Šä¸å»ï¼›åˆæˆ–è€…é¢å¯¹ä¸€å †å‚æ•°ï¼ˆå¦‚<code>acks</code>ã€<code>linger.ms</code>ï¼‰ï¼Œå®Œå…¨ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ã€‚è¿™äº›é—®é¢˜ï¼Œå½’æ ¹ç»“åº•ï¼Œéƒ½ä¸å¯¹ç”Ÿäº§è€…æœºåˆ¶çš„ç†è§£æ·±åº¦æœ‰å…³ã€‚<strong>é€‚ç”¨åœºæ™¯</strong>ä¸Šï¼ŒKafkaç”Ÿäº§è€…å¹¿æ³›ç”¨äºéœ€è¦é«˜å¯é ã€é«˜æ€§èƒ½æ¶ˆæ¯å‘é€çš„ä¸šåŠ¡ï¼Œæ¯”å¦‚æ—¥å¿—æ”¶é›†ã€å®æ—¶æ•°æ®æµå¤„ç†ã€äº‹ä»¶é©±åŠ¨æ¶æ„ç­‰ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶å¼€å§‹ï¼Œé€æ­¥æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·è·³è¿›Kafkaçš„ä¸–ç•Œï¼</p>
<hr/>
<h2 data-id="heading-1">2. Kafkaç”Ÿäº§è€…æ ¸å¿ƒæœºåˆ¶è§£æ</h2>
<p>Kafkaç”Ÿäº§è€…æ˜¯æ¶ˆæ¯æµçš„èµ·ç‚¹ï¼Œä½†å®ƒçš„è¿ä½œè¿œä¸æ­¢â€œå‘é€æ¶ˆæ¯â€é‚£ä¹ˆç®€å•ã€‚å°±åƒä¸€ä½é«˜æ•ˆçš„å¿«é€’å‘˜ï¼Œç”Ÿäº§è€…éœ€è¦æ„é€ åŒ…è£¹ï¼ˆæ¶ˆæ¯ï¼‰ã€é€‰æ‹©æ´¾é€è·¯çº¿ï¼ˆåˆ†åŒºï¼‰ã€æ‰“åŒ…æ‰¹é‡å¯„å‡ºï¼ˆç¼“å†²åŒºç®¡ç†ï¼‰ï¼Œæœ€åç¡®ä¿åŒ…è£¹å®‰å…¨é€è¾¾ï¼ˆBrokeräº¤äº’ï¼‰ã€‚æœ¬èŠ‚å°†è¯¦ç»†æ‹†è§£ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ï¼ŒåŒ…æ‹¬å·¥ä½œæµç¨‹ã€å‘é€æ¨¡å¼ã€åˆ†åŒºåˆ†é…å’Œç¼“å†²åŒºç®¡ç†ï¼Œå¸¦ä½ çœ‹æ¸…å®ƒçš„æ¯ä¸€ä¸ªâ€œé½¿è½®â€ã€‚</p>
<h3 data-id="heading-2">2.1 ç”Ÿäº§è€…åŸºæœ¬å·¥ä½œæµç¨‹</h3>
<p>ç”Ÿäº§è€…çš„å·¥ä½œæµç¨‹å¯ä»¥æ¯”å–»ä¸ºä¸€æ¡æµæ°´çº¿ï¼šä»æ¶ˆæ¯çš„æ„é€ åˆ°æœ€ç»ˆé€è¾¾Brokerï¼Œæ¯ä¸ªæ­¥éª¤éƒ½ç¯ç¯ç›¸æ‰£ã€‚ä»¥ä¸‹æ˜¯ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„æ ¸å¿ƒæ­¥éª¤ï¼š</p>
<ol>
<li><strong>æ¶ˆæ¯æ„é€ </strong>ï¼šç”¨æˆ·é€šè¿‡APIåˆ›å»ºæ¶ˆæ¯ï¼ŒæŒ‡å®šTopicã€Keyï¼ˆå¯é€‰ï¼‰å’ŒValueã€‚</li>
<li><strong>åºåˆ—åŒ–</strong>ï¼šå°†æ¶ˆæ¯çš„Keyå’ŒValueåºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼Œæ–¹ä¾¿ç½‘ç»œä¼ è¾“ã€‚</li>
<li><strong>åˆ†åŒºåˆ†é…</strong>ï¼šæ ¹æ®Keyæˆ–è‡ªå®šä¹‰åˆ†åŒºå™¨ï¼Œå†³å®šæ¶ˆæ¯å‘å¾€å“ªä¸ªåˆ†åŒºã€‚</li>
<li><strong>ç¼“å†²åŒºç®¡ç†</strong>ï¼šæ¶ˆæ¯æš‚å­˜åˆ°å†…å­˜ç¼“å†²åŒºï¼Œç­‰å¾…æ‰¹é‡å‘é€ã€‚</li>
<li><strong>æ‰¹é‡å‘é€</strong>ï¼šç¼“å†²åŒºç§¯ç´¯åˆ°ä¸€å®šé‡æˆ–æ—¶é—´åï¼Œæ‰¹é‡å‘é€åˆ°Brokerã€‚</li>
<li><strong>Brokeräº¤äº’</strong>ï¼šä¸Brokeré€šä¿¡ï¼Œè·å–å‘é€ç»“æœï¼ˆå¦‚æˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚</li>
</ol>
<p><strong>å›¾ç¤ºï¼šç”Ÿäº§è€…å‘é€æµç¨‹</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ç”¨æˆ·æ¶ˆæ¯]</span> â†’ <span class="hljs-selector-attr">[åºåˆ—åŒ–]</span> â†’ <span class="hljs-selector-attr">[åˆ†åŒºå™¨]</span> â†’ <span class="hljs-selector-attr">[ç¼“å†²åŒº]</span> â†’ <span class="hljs-selector-attr">[æ‰¹é‡å‘é€]</span> â†’ <span class="hljs-selector-attr">[Broker]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥æµç¨‹å›¾ï¼Œå±•ç¤ºæ¶ˆæ¯ä»æ„é€ åˆ°é€è¾¾çš„å®Œæ•´è·¯å¾„ï¼ŒåŒ…å«åºåˆ—åŒ–ã€åˆ†åŒºå™¨ã€ç¼“å†²åŒºç­‰å…³é”®èŠ‚ç‚¹ï¼‰</em></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºç¡€çš„ç”Ÿäº§è€…ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é…ç½®å’Œå‘é€æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.KafkaProducer;
<span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;
<span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.ProducerConfig;
<span class="hljs-keyword">import</span> java.util.Properties;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é…ç½®ç”Ÿäº§è€…å±æ€§</span>
        <span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="hljs-string">"localhost:9092"</span>);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);

        <span class="hljs-comment">// åˆ›å»ºç”Ÿäº§è€…å®ä¾‹</span>
        <span class="hljs-keyword">try</span> (KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props)) {
            <span class="hljs-comment">// æ„é€ æ¶ˆæ¯</span>
            ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"my-topic"</span>, <span class="hljs-string">"key1"</span>, <span class="hljs-string">"Hello, Kafka!"</span>);
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
            producer.send(record);
            System.out.println(<span class="hljs-string">"Message sent successfully!"</span>);
        }
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>BOOTSTRAP_SERVERS_CONFIG</code>ï¼šæŒ‡å®šKafkaé›†ç¾¤çš„Brokeråœ°å€ã€‚</li>
<li><code>KEY_SERIALIZER_CLASS_CONFIG</code>å’Œ<code>VALUE_SERIALIZER_CLASS_CONFIG</code>ï¼šå®šä¹‰Keyå’ŒValueçš„åºåˆ—åŒ–æ–¹å¼ã€‚</li>
<li><code>ProducerRecord</code>ï¼šå°è£…Topicã€Keyå’ŒValueï¼Œæ„æˆä¸€æ¡æ¶ˆæ¯ã€‚</li>
<li><code>send()</code>ï¼šå¼‚æ­¥å‘é€æ¶ˆæ¯ï¼Œé»˜è®¤ä¸ç­‰å¾…Brokerå“åº”ã€‚</li>
</ul>
<p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†ç”Ÿäº§è€…çš„åŸºç¡€ç”¨æ³•ï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘å‘é€æ¨¡å¼ã€å¯é æ€§ç­‰å› ç´ ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”Ÿäº§è€…çš„ä¸åŒå‘é€æ¨¡å¼ã€‚</p>
<h3 data-id="heading-3">2.2 æ¶ˆæ¯å‘é€æ¨¡å¼</h3>
<p>Kafkaç”Ÿäº§è€…æ”¯æŒä¸‰ç§å‘é€æ¨¡å¼ï¼š<strong>åŒæ­¥å‘é€</strong>ã€<strong>å¼‚æ­¥å‘é€</strong>å’Œ<strong>ç«åŠ›å…¨å¼€æ¨¡å¼ï¼ˆfire-and-forgetï¼‰</strong>ã€‚æ¯ç§æ¨¡å¼éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œæƒè¡¡ã€‚</p>
<ul>
<li><strong>åŒæ­¥å‘é€</strong>ï¼šè°ƒç”¨<code>send()</code>åï¼Œé€šè¿‡<code>get()</code>æ–¹æ³•é˜»å¡ç­‰å¾…Brokerçš„å“åº”ã€‚é€‚åˆå¯¹å¯é æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä½†ä¼šå¢åŠ å»¶è¿Ÿã€‚</li>
<li><strong>å¼‚æ­¥å‘é€</strong>ï¼šè°ƒç”¨<code>send()</code>åç«‹å³è¿”å›ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å¤„ç†ç»“æœã€‚é€‚åˆé«˜åååœºæ™¯ï¼Œä½†éœ€è¦å¦¥å–„å¤„ç†å›è°ƒä¸­çš„å¼‚å¸¸ã€‚</li>
<li><strong>ç«åŠ›å…¨å¼€æ¨¡å¼</strong>ï¼šè°ƒç”¨<code>send()</code>åä¸å…³å¿ƒç»“æœï¼Œè¿½æ±‚æè‡´æ€§èƒ½ï¼Œä½†å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œé€‚åˆå¯¹å¯é æ€§è¦æ±‚ä½çš„åœºæ™¯ï¼ˆå¦‚éƒ¨åˆ†æ—¥å¿—æ”¶é›†ï¼‰ã€‚</li>
</ul>
<p><strong>å¯¹æ¯”è¡¨æ ¼ï¼šå‘é€æ¨¡å¼ä¼˜åŠ£</strong></p>

































<table><thead><tr><th>æ¨¡å¼</th><th>å¯é æ€§</th><th>å»¶è¿Ÿ</th><th>ååé‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åŒæ­¥å‘é€</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>é‡‘èäº¤æ˜“ã€è®¢å•å¤„ç†</td></tr><tr><td>å¼‚æ­¥å‘é€</td><td>ä¸­-é«˜</td><td>ä½</td><td>é«˜</td><td>å®æ—¶æ—¥å¿—ã€äº‹ä»¶æµ</td></tr><tr><td>ç«åŠ›å…¨å¼€æ¨¡å¼</td><td>ä½</td><td>æœ€ä½</td><td>æœ€é«˜</td><td>éå…³é”®æ—¥å¿—ã€ç›‘æ§æ•°æ®</td></tr></tbody></table>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¼‚æ­¥å‘é€çš„ç¤ºä¾‹ï¼Œå¸¦å›è°ƒå¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java">producer.send(record, (metadata, exception) -&gt; {
    <span class="hljs-keyword">if</span> (exception == <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// æˆåŠŸå‘é€</span>
        System.out.printf(<span class="hljs-string">"Sent to topic %s, partition %d, offset %d%n"</span>,
                metadata.topic(), metadata.partition(), metadata.offset());
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å‘é€å¤±è´¥ï¼Œè®°å½•å¼‚å¸¸</span>
        exception.printStackTrace();
    }
});
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å›è°ƒå‡½æ•°æ¥æ”¶<code>metadata</code>ï¼ˆåŒ…å«Topicã€åˆ†åŒºã€åç§»é‡ç­‰ä¿¡æ¯ï¼‰å’Œ<code>exception</code>ï¼ˆå¼‚å¸¸ä¿¡æ¯ï¼‰ã€‚</li>
<li>å¼‚æ­¥å‘é€ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯ï¼Œä½†éœ€è¦ç¡®ä¿å›è°ƒé€»è¾‘å¥å£®ã€‚</li>
</ul>
<p><strong>è¿‡æ¸¡</strong>ï¼šå‘é€æ¨¡å¼çš„é€‰æ‹©ä¸ºç”Ÿäº§è€…æä¾›äº†çµæ´»æ€§ï¼Œä½†æ¶ˆæ¯æœ€ç»ˆè½åœ¨å“ªä¸ªåˆ†åŒºï¼Œè¿˜å¾—é åˆ†åŒºæœºåˆ¶æ¥å†³å®šã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åˆ†åŒºä¸é”®åˆ†é…çš„å¥¥ç§˜ã€‚</p>
<h3 data-id="heading-4">2.3 åˆ†åŒºä¸é”®åˆ†é…æœºåˆ¶</h3>
<p>Kafkaçš„Topicç”±å¤šä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ç»„æˆï¼Œåˆ†åŒºå†³å®šäº†æ¶ˆæ¯çš„å­˜å‚¨ä½ç½®å’Œæ¶ˆè´¹é¡ºåºã€‚ç”Ÿäº§è€…é€šè¿‡åˆ†åŒºå™¨ï¼ˆPartitionerï¼‰å†³å®šæ¶ˆæ¯å‘å¾€å“ªä¸ªåˆ†åŒºï¼Œä¸»è¦æœ‰ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ul>
<li><strong>é»˜è®¤åˆ†åŒºç­–ç•¥</strong>ï¼š
<ul>
<li>å¦‚æœæŒ‡å®šäº†Keyï¼Œé€šè¿‡Keyçš„å“ˆå¸Œå€¼ï¼ˆ<code>murmur2</code>ç®—æ³•ï¼‰æ˜ å°„åˆ°åˆ†åŒºï¼Œç¡®ä¿ç›¸åŒKeyçš„æ¶ˆæ¯è½å…¥åŒä¸€åˆ†åŒºï¼Œé€‚åˆéœ€è¦é¡ºåºæ¶ˆè´¹çš„åœºæ™¯ã€‚</li>
<li>å¦‚æœæœªæŒ‡å®šKeyï¼Œé‡‡ç”¨è½®è¯¢ï¼ˆround-robinï¼‰æ–¹å¼åˆ†é…ï¼Œå‡åŒ€åˆ†å¸ƒæ¶ˆæ¯åˆ°å„åˆ†åŒºï¼Œé€‚åˆæœ€å¤§åŒ–ååé‡ã€‚</li>
</ul>
</li>
<li><strong>è‡ªå®šä¹‰åˆ†åŒºå™¨</strong>ï¼šå®ç°<code>Partitioner</code>æ¥å£ï¼Œæ ¹æ®ä¸šåŠ¡é€»è¾‘åˆ†é…åˆ†åŒºã€‚ä¾‹å¦‚ï¼ŒæŒ‰ç”¨æˆ·IDåˆ†åŒºï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·æ¶ˆæ¯é›†ä¸­å¤„ç†ã€‚</li>
</ul>
<p><strong>å›¾ç¤ºï¼šåˆ†åŒºåˆ†é…é€»è¾‘</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[æ¶ˆæ¯]</span> â†’ <span class="hljs-selector-attr">[æœ‰Key?]</span>
    â†“ æ˜¯        â†“ å¦
 <span class="hljs-selector-attr">[å“ˆå¸Œåˆ†åŒº]</span>   <span class="hljs-selector-attr">[è½®è¯¢åˆ†é…]</span>
    â†“            â†“
 <span class="hljs-selector-attr">[åˆ†åŒº0/1/2...]</span> <span class="hljs-selector-attr">[åˆ†åŒº0/1/2...]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥å›¾è¡¨ï¼Œå±•ç¤ºæ¶ˆæ¯é€šè¿‡Keyå“ˆå¸Œæˆ–è½®è¯¢åˆ†é…åˆ°åˆ†åŒºçš„é€»è¾‘ï¼Œæ ‡æ³¨åˆ†åŒºå™¨è§’è‰²ï¼‰</em></p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªç”µå•†ç³»ç»Ÿä¸­ï¼Œè®¢å•æ¶ˆæ¯éœ€è¦æŒ‰ç”¨æˆ·IDé¡ºåºå¤„ç†ã€‚æˆ‘ä»¬é€šè¿‡è®¾ç½®Keyä¸ºç”¨æˆ·IDï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·çš„æ‰€æœ‰è®¢å•æ¶ˆæ¯è½å…¥åŒä¸€åˆ†åŒºï¼Œä»è€Œä¿è¯æ¶ˆè´¹æ—¶çš„é¡ºåºæ€§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å®ç°ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"orders"</span>, userId, orderJson);
producer.send(record);
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>userId</code>ä½œä¸ºKeyï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·çš„è®¢å•æ¶ˆæ¯å§‹ç»ˆå‘å¾€åŒä¸€åˆ†åŒºã€‚</li>
<li>æ¶ˆè´¹ç«¯å¯é€šè¿‡å•ä¸€æ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†è¯¥åˆ†åŒºï¼Œä¿è¯æ¶ˆæ¯é¡ºåºã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæ›¾ç»åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæœªè®¾ç½®Keyå¯¼è‡´è®¢å•æ¶ˆæ¯ä¹±åºï¼Œæ¶ˆè´¹è€…å¤„ç†é€»è¾‘å‡ºç°æ··ä¹±ã€‚è§£å†³æ–¹æ³•æ˜¯æ˜ç¡®Keyç­–ç•¥ï¼Œå¹¶åœ¨æ¶ˆè´¹ç«¯éªŒè¯é¡ºåºæ€§ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šåˆ†åŒºåˆ†é…å†³å®šäº†æ¶ˆæ¯çš„â€œå½’å®¿â€ï¼Œä½†åœ¨é€å¾€Brokerä¹‹å‰ï¼Œæ¶ˆæ¯è¿˜ä¼šåœ¨ç¼“å†²åŒºâ€œä¼‘æ¯â€ç‰‡åˆ»ã€‚ç¼“å†²åŒºç®¡ç†ç›´æ¥å½±å“æ€§èƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ·±å…¥æ¢è®¨ã€‚</p>
<h3 data-id="heading-5">2.4 ç”Ÿäº§è€…ç¼“å†²åŒºä¸æ‰¹å¤„ç†</h3>
<p>ç”Ÿäº§è€…ä¸ä¼šç«‹å³å°†æ¶ˆæ¯å‘é€åˆ°Brokerï¼Œè€Œæ˜¯å…ˆå­˜å…¥å†…å­˜ç¼“å†²åŒºï¼ˆ<code>buffer.memory</code>ï¼Œé»˜è®¤32MBï¼‰ï¼Œç­‰å¾…æ‰¹é‡å‘é€ã€‚æ‰¹é‡å‘é€æ˜¯Kafkaé«˜ååçš„ç§˜å¯†æ­¦å™¨ï¼Œä½†ä¹Ÿéœ€è¦åˆç†é…ç½®ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li><strong><code>buffer.memory</code></strong>ï¼šç¼“å†²åŒºæ€»å¤§å°ï¼Œè¿‡å°å¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼ˆ<code>BufferExhaustedException</code>ï¼‰ã€‚</li>
<li><strong><code>batch.size</code></strong>ï¼šæ¯ä¸ªåˆ†åŒºçš„æ‰¹æ¬¡å¤§å°ï¼ˆé»˜è®¤16KBï¼‰ï¼Œå†³å®šä¸€æ¬¡å‘é€å¤šå°‘æ¶ˆæ¯ã€‚</li>
<li><strong><code>linger.ms</code></strong>ï¼šæ‰¹æ¬¡ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤0msï¼‰ï¼Œå³ä½¿æ‰¹æ¬¡æœªæ»¡ï¼Œç­‰å¾…æ—¶é—´åˆ°ä¹Ÿä¼šå‘é€ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šç¼“å†²åŒºå‚æ•°å½±å“</strong></p>





























<table><thead><tr><th>å‚æ•°</th><th>é»˜è®¤å€¼</th><th>ä½œç”¨</th><th>ä¼˜åŒ–å»ºè®®</th></tr></thead><tbody><tr><td>buffer.memory</td><td>32MB</td><td>ç¼“å†²åŒºæ€»å¤§å°</td><td>è§†å†…å­˜è°ƒæ•´ï¼Œå»ºè®®64-128MB</td></tr><tr><td>batch.size</td><td>16KB</td><td>å•æ‰¹æ¬¡å¤§å°</td><td>é«˜åååœºæ™¯å¯è°ƒè‡³128KB</td></tr><tr><td>linger.ms</td><td>0ms</td><td>æ‰¹æ¬¡ç­‰å¾…æ—¶é—´</td><td>ä½å»¶è¿Ÿåœºæ™¯è®¾0ï¼Œé«˜ååè®¾5-10ms</td></tr></tbody></table>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—æ”¶é›†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†<code>batch.size</code>ä»16KBè°ƒæ•´åˆ°128KBï¼Œå¹¶è®¾ç½®<code>linger.ms=5</code>ï¼Œååé‡æå‡äº†30%ï¼Œä½†å»¶è¿Ÿç•¥å¢ï¼Œé€‚åˆéå®æ—¶åœºæ™¯ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¼˜åŒ–ç¼“å†²åŒºçš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.BUFFER_MEMORY_CONFIG, <span class="hljs-number">67108864</span>); <span class="hljs-comment">// 64MB</span>
props.put(ProducerConfig.BATCH_SIZE_CONFIG, <span class="hljs-number">131072</span>); <span class="hljs-comment">// 128KB</span>
props.put(ProducerConfig.LINGER_MS_CONFIG, <span class="hljs-number">5</span>); <span class="hljs-comment">// 5ms</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å¢å¤§<code>batch.size</code>é€‚åˆé«˜åååœºæ™¯ï¼Œä½†ä¼šå¢åŠ å†…å­˜å ç”¨ã€‚</li>
<li>è®¾ç½®<code>linger.ms=5</code>è®©æ‰¹æ¬¡ç¨å¾®â€œç­‰ç­‰â€ï¼Œæå‡æ‰¹æ¬¡åˆ©ç”¨ç‡ã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› <code>buffer.memory</code>è¿‡å°ï¼Œé¢‘ç¹æŠ›å‡º<code>BufferExhaustedException</code>ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚è§£å†³æ–¹æ³•æ˜¯å¢åŠ å†…å­˜å¹¶ç›‘æ§ç¼“å†²åŒºä½¿ç”¨ç‡ï¼ˆé€šè¿‡JMXæŒ‡æ ‡<code>buffer-total-bytes</code>ï¼‰ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ä¸ºæˆ‘ä»¬æ‰“ä¸‹äº†åšå®åŸºç¡€ï¼Œä½†å¦‚ä½•ç¡®ä¿æ¶ˆæ¯ä¸ä¸¢ã€ä¸é‡ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¢è®¨å¯é æ€§å’Œä¸€è‡´æ€§ä¿éšœã€‚</p>
<hr/>
<h2 data-id="heading-6">3. ç”Ÿäº§è€…å¯é æ€§ä¸ä¸€è‡´æ€§ä¿éšœ</h2>
<p>Kafkaç”Ÿäº§è€…çš„çµæ´»æ€§ä¸ä»…ä½“ç°åœ¨æ€§èƒ½ä¸Šï¼Œæ›´ä½“ç°åœ¨å®ƒå¯¹æ¶ˆæ¯å¯é æ€§å’Œä¸€è‡´æ€§çš„ä¿éšœèƒ½åŠ›ã€‚æ— è®ºæ˜¯é‡‘èç³»ç»Ÿä¸­çš„æ”¯ä»˜æ¶ˆæ¯ï¼Œè¿˜æ˜¯æ—¥å¿—ç³»ç»Ÿä¸­çš„å…³é”®äº‹ä»¶ï¼Œç”Ÿäº§è€…éƒ½éœ€è¦ç¡®ä¿æ¶ˆæ¯â€œä¸ä¸¢ä¸é‡â€ã€‚æœ¬èŠ‚å°†èšç„¦æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ã€é‡è¯•ä¸å¹‚ç­‰æ€§ï¼Œä»¥åŠäº‹åŠ¡ç”Ÿäº§è€…ï¼Œå¸®ä½ æ„å»ºä¸€ä¸ªâ€œç¨³å¦‚ç£çŸ³â€çš„æ¶ˆæ¯å‘é€æµç¨‹ã€‚</p>
<h3 data-id="heading-7">3.1 æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ˆAcksï¼‰</h3>
<p>Kafkaç”Ÿäº§è€…é€šè¿‡<code>acks</code>å‚æ•°æ§åˆ¶Brokerå¯¹æ¶ˆæ¯çš„ç¡®è®¤æ–¹å¼ï¼Œç›´æ¥å½±å“å¯é æ€§å’Œæ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§é…ç½®çš„å¯¹æ¯”ï¼š</p>
<ul>
<li><strong><code>acks=0</code></strong>ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯åä¸ç­‰å¾…Brokerç¡®è®¤ï¼Œè¿½æ±‚æè‡´æ€§èƒ½ï¼Œä½†å¯èƒ½å› ç½‘ç»œé—®é¢˜å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
<li><strong><code>acks=1</code></strong>ï¼šç”Ÿäº§è€…ç­‰å¾…Leaderå‰¯æœ¬ç¡®è®¤å†™å…¥ï¼Œå¹³è¡¡æ€§èƒ½ä¸å¯é æ€§ï¼Œä½†è‹¥Leaderå®•æœºï¼Œå¯èƒ½ä¸¢å¤±æœªåŒæ­¥çš„æ¶ˆæ¯ã€‚</li>
<li><strong><code>acks=all</code></strong>ï¼šç”Ÿäº§è€…ç­‰å¾…æ‰€æœ‰ISRï¼ˆIn-Sync Replicasï¼‰å‰¯æœ¬ç¡®è®¤ï¼Œæœ€é«˜å¯é æ€§ï¼Œä½†å»¶è¿Ÿç¨é«˜ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šAcksé…ç½®å¯¹æ¯”</strong></p>

































<table><thead><tr><th>é…ç½®</th><th>å¯é æ€§</th><th>å»¶è¿Ÿ</th><th>ååé‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>acks=0</td><td>ä½</td><td>æœ€ä½</td><td>æœ€é«˜</td><td>éå…³é”®æ—¥å¿—ã€ç›‘æ§æ•°æ®</td></tr><tr><td>acks=1</td><td>ä¸­</td><td>ä¸­</td><td>é«˜</td><td>æ™®é€šä¸šåŠ¡æ¶ˆæ¯</td></tr><tr><td>acks=all</td><td>é«˜</td><td>é«˜</td><td>ä¸­</td><td>é‡‘èäº¤æ˜“ã€å…³é”®äº‹ä»¶</td></tr></tbody></table>
<p><strong>å…³é”®ç‚¹</strong>ï¼š<code>acks=all</code>ç»“åˆ<code>min.insync.replicas</code>ï¼ˆBrokerç«¯å‚æ•°ï¼Œå»ºè®®è®¾ä¸º2æˆ–3ï¼‰å¯ç¡®ä¿æ¶ˆæ¯è‡³å°‘å†™å…¥å¤šä¸ªå‰¯æœ¬ï¼Œè¿›ä¸€æ­¥æå‡å¯é æ€§ã€‚</p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªé‡‘èæ”¯ä»˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é…ç½®<code>acks=all</code>å¹¶è®¾ç½®<code>min.insync.replicas=2</code>ï¼Œç¡®ä¿æ”¯ä»˜æ¶ˆæ¯å³ä½¿åœ¨Leaderå®•æœºåä»èƒ½è¢«å…¶ä»–å‰¯æœ¬ä¿å­˜ï¼Œé¿å…äº†èµ„é‡‘è®°å½•ä¸¢å¤±çš„é£é™©ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ACKS_CONFIG, <span class="hljs-string">"all"</span>);
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®åˆæœŸä½¿ç”¨<code>acks=0</code>è¿½æ±‚æ€§èƒ½ï¼Œç»“æœå› ç½‘ç»œæŠ–åŠ¨ä¸¢å¤±éƒ¨åˆ†æ—¥å¿—æ•°æ®ã€‚ä¿®å¤æ–¹æ¡ˆæ˜¯æ”¹ä¸º<code>acks=1</code>ï¼Œå¹¶é€šè¿‡æ¶ˆè´¹è€…ç«¯éªŒè¯æ¶ˆæ¯å®Œæ•´æ€§ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šç¡®è®¤æœºåˆ¶ä¿è¯äº†æ¶ˆæ¯é€è¾¾ï¼Œä½†ç½‘ç»œæˆ–Brokerå¼‚å¸¸å¯èƒ½å¯¼è‡´å‘é€å¤±è´¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€šè¿‡é‡è¯•å’Œå¹‚ç­‰æ€§åº”å¯¹è¿™äº›é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">3.2 é‡è¯•æœºåˆ¶ä¸å¹‚ç­‰æ€§</h3>
<p>ç”Ÿäº§è€…æ”¯æŒè‡ªåŠ¨é‡è¯•ï¼Œå¤„ç†ä¸´æ—¶æ€§å¤±è´¥ï¼ˆå¦‚ç½‘ç»œæŠ–åŠ¨æˆ–Leaderåˆ‡æ¢ï¼‰ã€‚å…³é”®å‚æ•°åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong><code>retries</code></strong>ï¼šé‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤<code>Integer.MAX_VALUE</code>ï¼ˆKafka 2.0+ï¼‰ï¼Œä½†éœ€åˆç†è®¾ç½®ä»¥é¿å…æ— é™é‡è¯•ã€‚</li>
<li><strong><code>retry.backoff.ms</code></strong>ï¼šé‡è¯•é—´éš”ï¼Œé»˜è®¤100msï¼Œé˜²æ­¢é¢‘ç¹é‡è¯•å†²å‡»Brokerã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œé‡è¯•å¯èƒ½å¯¼è‡´æ¶ˆæ¯é‡å¤å‘é€ï¼Œå°¤å…¶åœ¨å¼‚æ­¥å‘é€ä¸­ã€‚<strong>å¹‚ç­‰ç”Ÿäº§è€…</strong>é€šè¿‡<code>enable.idempotence=true</code>è§£å†³æ­¤é—®é¢˜ï¼Œç¡®ä¿æ¶ˆæ¯â€œæœ€å¤šå‘é€ä¸€æ¬¡â€ï¼ˆat-least-onceå˜ä¸ºexactly-onceï¼‰ã€‚</p>
<p><strong>å›¾ç¤ºï¼šå¹‚ç­‰ç”Ÿäº§è€…å·¥ä½œåŸç†</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ç”Ÿäº§è€…]</span> â†’ <span class="hljs-selector-attr">[åˆ†é…PID+åºåˆ—å·]</span> â†’ <span class="hljs-selector-attr">[BrokeréªŒè¯åºåˆ—å·]</span> â†’ <span class="hljs-selector-attr">[å»é‡å†™å…¥]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥ç¤ºæ„å›¾ï¼Œå±•ç¤ºç”Ÿäº§è€…ä¸ºæ¶ˆæ¯åˆ†é…PIDå’Œåºåˆ—å·ï¼ŒBrokeréªŒè¯å»é‡çš„è¿‡ç¨‹ï¼‰</em></p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªåº“å­˜ç³»ç»Ÿä¸­ï¼Œé‡è¯•å¯¼è‡´é‡å¤æ‰£å‡åº“å­˜ã€‚æˆ‘ä»¬å¯ç”¨å¹‚ç­‰ç”Ÿäº§è€…ï¼Œé¿å…äº†é‡å¤æ¶ˆæ¯çš„å‰¯ä½œç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¹‚ç­‰ç”Ÿäº§è€…çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, <span class="hljs-literal">true</span>);
props.put(ProducerConfig.RETRIES_CONFIG, <span class="hljs-number">5</span>); <span class="hljs-comment">// åˆç†é™åˆ¶é‡è¯•æ¬¡æ•°</span>
props.put(ProducerConfig.ACKS_CONFIG, <span class="hljs-string">"all"</span>); <span class="hljs-comment">// å¹‚ç­‰æ€§è¦æ±‚acks=all</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>enable.idempotence=true</code>ä¸ºæ¯æ¡æ¶ˆæ¯åˆ†é…å”¯ä¸€æ ‡è¯†ï¼ˆPID+åºåˆ—å·ï¼‰ï¼ŒBrokeræ ¹æ®æ ‡è¯†å»é‡ã€‚</li>
<li>é™åˆ¶<code>retries</code>é¿å…æ— é™é‡è¯•ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› æœªè®¾ç½®<code>enable.idempotence</code>ï¼Œé‡è¯•å¯¼è‡´æ¶ˆæ¯é‡å¤ï¼Œæ¶ˆè´¹è€…ç«¯éœ€é¢å¤–å®ç°å»é‡é€»è¾‘ã€‚å¯ç”¨å¹‚ç­‰åï¼Œé—®é¢˜è¿åˆƒè€Œè§£ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šå¹‚ç­‰æ€§è§£å†³äº†å•Topicçš„é‡å¤é—®é¢˜ï¼Œä½†å¦‚æœæ¶‰åŠè·¨Topicæˆ–å¤–éƒ¨ç³»ç»Ÿä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¼ºå¤§çš„å·¥å…·â€”â€”äº‹åŠ¡ç”Ÿäº§è€…ã€‚</p>
<h3 data-id="heading-9">3.3 äº‹åŠ¡ç”Ÿäº§è€…</h3>
<p>äº‹åŠ¡ç”Ÿäº§è€…é€šè¿‡<code>transactional.id</code>å®ç°exactly-onceè¯­ä¹‰ï¼Œç¡®ä¿æ¶ˆæ¯å‘é€å’Œå¤–éƒ¨æ“ä½œï¼ˆå¦‚æ•°æ®åº“æ›´æ–°ï¼‰åŸå­æ€§ã€‚å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>è·¨Topicæ¶ˆæ¯ä¸€è‡´æ€§ï¼šå¤šä¸ªTopicçš„æ¶ˆæ¯è¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ã€‚</li>
<li>ä¸å¤–éƒ¨ç³»ç»ŸåŒæ­¥ï¼šå¦‚æ•°æ®åº“æ›´æ–°ä¸Kafkaæ¶ˆæ¯ä¿æŒä¸€è‡´ã€‚</li>
</ul>
<p><strong>å…³é”®ç‚¹</strong>ï¼šäº‹åŠ¡ç”Ÿäº§è€…éœ€åˆå§‹åŒ–äº‹åŠ¡å¹¶æ˜¾å¼æäº¤æˆ–å›æ»šï¼Œé…ç½®å¤æ‚ä½†å¯é æ€§æé«˜.</p>
<p>ä»¥ä¸‹æ˜¯äº‹åŠ¡ç”Ÿäº§è€…çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.TRANSACTIONAL_ID_CONFIG, <span class="hljs-string">"tx-producer-1"</span>);
KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props);

<span class="hljs-comment">// åˆå§‹åŒ–äº‹åŠ¡</span>
producer.initTransactions();

<span class="hljs-keyword">try</span> {
    producer.beginTransaction();
    <span class="hljs-comment">// å‘é€å¤šæ¡æ¶ˆæ¯</span>
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"topic1"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value1"</span>));
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"topic2"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value2"</span>));
    <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
    producer.commitTransaction();
} <span class="hljs-keyword">catch</span> (Exception e) {
    <span class="hljs-comment">// å›æ»šäº‹åŠ¡</span>
    producer.abortTransaction();
    e.printStackTrace();
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>transactional.id</code>ç¡®ä¿äº‹åŠ¡å”¯ä¸€æ€§ï¼ŒBrokeræ ¹æ®IDç®¡ç†äº‹åŠ¡çŠ¶æ€ã€‚</li>
<li><code>initTransactions()</code>åˆå§‹åŒ–äº‹åŠ¡ç¯å¢ƒï¼Œå¿…é¡»åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶è°ƒç”¨ã€‚</li>
<li>å¼‚å¸¸æ—¶è°ƒç”¨<code>abortTransaction()</code>å›æ»šï¼Œé¿å…éƒ¨åˆ†æäº¤ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨è®¢å•ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº‹åŠ¡ç”Ÿäº§è€…ç¡®ä¿è®¢å•æ¶ˆæ¯å’Œåº“å­˜æ‰£å‡æ¶ˆæ¯åŒæ—¶å†™å…¥ä¸¤ä¸ªTopicï¼Œé¿å…äº†æ•°æ®ä¸ä¸€è‡´ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡ç¡®è®¤æœºåˆ¶ã€å¹‚ç­‰æ€§å’Œäº‹åŠ¡ï¼Œç”Ÿäº§è€…çš„å¯é æ€§å·²å›ºè‹¥é‡‘æ±¤ã€‚ä½†åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ€§èƒ½ä¼˜åŒ–åŒæ ·é‡è¦ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¢è®¨å¦‚ä½•è®©ç”Ÿäº§è€…è·‘å¾—æ›´å¿«ã€‚</p>
<hr/>
<h2 data-id="heading-10">4. æ€§èƒ½ä¼˜åŒ–ä¸å‚æ•°è°ƒä¼˜</h2>
<p>Kafkaç”Ÿäº§è€…å°±åƒä¸€è¾†è·‘è½¦ï¼Œæ€§èƒ½æ½œåŠ›å·¨å¤§ï¼Œä½†éœ€è¦ç²¾å¿ƒè°ƒæ ¡æ‰èƒ½å‘æŒ¥æè‡´é€Ÿåº¦ã€‚æœ¬èŠ‚å°†èšç„¦å…³é”®å‚æ•°è°ƒä¼˜ã€æ‰¹é‡å‘é€ä¼˜åŒ–å’Œå¤šçº¿ç¨‹ç®¡ç†ï¼Œåˆ†äº«å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­æå‡ååé‡å¹¶æ§åˆ¶å»¶è¿Ÿã€‚</p>
<h3 data-id="heading-11">4.1 å…³é”®å‚æ•°è°ƒä¼˜</h3>
<p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå¯¹æ€§èƒ½å½±å“è¾ƒå¤§çš„å‚æ•°ï¼š</p>
<ul>
<li><strong><code>compression.type</code></strong>ï¼šæ”¯æŒ<code>gzip</code>ã€<code>snappy</code>ã€<code>lz4</code>å’Œ<code>zstd</code>ï¼Œå‹ç¼©å¯æ˜¾è‘—å‡å°‘ç½‘ç»œä¼ è¾“é‡ã€‚</li>
<li><strong><code>max.in.flight.requests.per.connection</code></strong>ï¼šæ§åˆ¶æ¯ä¸ªè¿æ¥çš„æœªå®Œæˆè¯·æ±‚æ•°ï¼Œé»˜è®¤5ï¼Œè°ƒé«˜å¯æå‡ååï¼Œä½†å¯èƒ½å¢åŠ ä¹±åºé£é™©ã€‚</li>
<li><strong><code>delivery.timeout.ms</code></strong>ï¼šæ¶ˆæ¯å‘é€çš„æ€»è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤120ç§’ï¼Œéœ€æ ¹æ®ä¸šåŠ¡å»¶è¿Ÿè¦æ±‚è°ƒæ•´ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šå‹ç¼©ç±»å‹å¯¹æ¯”</strong></p>








































<table><thead><tr><th>ç±»å‹</th><th>å‹ç¼©æ¯”</th><th>é€Ÿåº¦</th><th>CPUå ç”¨</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>gzip</td><td>é«˜</td><td>æ…¢</td><td>é«˜</td><td>å¸¦å®½å—é™ã€é«˜åå</td></tr><tr><td>snappy</td><td>ä¸­</td><td>å¿«</td><td>ä¸­</td><td>å¹³è¡¡æ€§èƒ½ä¸å‹ç¼©</td></tr><tr><td>lz4</td><td>ä¸­</td><td>å¾ˆå¿«</td><td>ä½</td><td>é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿ</td></tr><tr><td>zstd</td><td>å¾ˆé«˜</td><td>ä¸­</td><td>ä¸­</td><td>æ–°åœºæ™¯ï¼Œéœ€æµ‹è¯•å…¼å®¹æ€§</td></tr></tbody></table>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†<code>compression.type</code>ä»<code>none</code>æ”¹ä¸º<code>snappy</code>ï¼Œç½‘ç»œæµé‡å‡å°‘40%ï¼Œååé‡æå‡20%ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é«˜ååé…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.COMPRESSION_TYPE_CONFIG, <span class="hljs-string">"snappy"</span>);
props.put(ProducerConfig.MAX_IN_FLIGHT_REQUESTS_PER_CONNECTION, <span class="hljs-number">5</span>);
props.put(ProducerConfig.DELIVERY_TIMEOUT_MS_CONFIG, <span class="hljs-number">60000</span>); <span class="hljs-comment">// 60ç§’</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>snappy</code>å‹ç¼©é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå¹³è¡¡æ€§èƒ½å’Œå‹ç¼©æ¯”ã€‚</li>
<li>è°ƒé«˜<code>max.in.flight.requests</code>éœ€ç¡®ä¿å¹‚ç­‰æ€§å¼€å¯ï¼Œé¿å…ä¹±åºã€‚</li>
</ul>
<h3 data-id="heading-12">4.2 æ‰¹é‡å‘é€ä¼˜åŒ–</h3>
<p>æ‰¹é‡å‘é€æ˜¯Kafkaé«˜ååçš„æ ¸å¿ƒï¼Œä½†<code>batch.size</code>å’Œ<code>linger.ms</code>çš„é…ç½®éœ€æƒè¡¡ååé‡ä¸å»¶è¿Ÿï¼š</p>
<ul>
<li><strong><code>batch.size</code></strong>ï¼šè¿‡å°å¯¼è‡´æ‰¹æ¬¡é¢‘ç¹å‘é€ï¼Œé™ä½ååï¼›è¿‡å¤§å¢åŠ å†…å­˜å‹åŠ›ã€‚</li>
<li><strong><code>linger.ms</code></strong>ï¼šé€‚å½“å»¶è¿Ÿï¼ˆå¦‚5-10msï¼‰å¯ç§¯ç´¯æ›´å¤šæ¶ˆæ¯ï¼Œä½†å»¶è¿Ÿæ•æ„Ÿåœºæ™¯éœ€è®¾ä¸º0ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªå®æ—¶ç›‘æ§ç³»ç»Ÿä¸­ï¼Œåˆå§‹<code>linger.ms=50</code>å¯¼è‡´å»¶è¿Ÿè¿‡é«˜ã€‚æˆ‘ä»¬è°ƒæ•´ä¸º<code>linger.ms=2</code>ï¼Œå»¶è¿Ÿé™è‡³10msä»¥å†…ï¼Œååé‡ä»…ç•¥æœ‰ä¸‹é™ã€‚</p>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› <code>batch.size</code>è®¾ä¸º1MBï¼Œå†…å­˜å ç”¨æ¿€å¢ï¼Œè§¦å‘GCé—®é¢˜ã€‚ä¼˜åŒ–åè®¾ä¸º128KBï¼Œæ€§èƒ½ç¨³å®šã€‚</p>
<h3 data-id="heading-13">4.3 å¤šçº¿ç¨‹ä¸ç”Ÿäº§è€…å®ä¾‹ç®¡ç†</h3>
<p>Kafkaç”Ÿäº§è€…æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå•ä¸ªå®ä¾‹å¯ç”±å¤šçº¿ç¨‹å…±äº«ã€‚ä½†åœ¨è¶…é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šç”Ÿäº§è€…å®ä¾‹å¯èƒ½æ›´ä¼˜ã€‚</p>
<p><strong>å¯¹æ¯”ï¼šå•ç”Ÿäº§è€… vs å¤šç”Ÿäº§è€…</strong></p>




















<table><thead><tr><th>æ–¹å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>å•ç”Ÿäº§è€…</td><td>èµ„æºå ç”¨ä½ï¼Œç®¡ç†ç®€å•</td><td>å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ</td></tr><tr><td>å¤šç”Ÿäº§è€…</td><td>é«˜å¹¶å‘ä¸‹ååé‡æ›´é«˜</td><td>ç®¡ç†å¤æ‚ï¼Œå†…å­˜å ç”¨å¢åŠ </td></tr></tbody></table>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šä¸­å°å‹åº”ç”¨ä½¿ç”¨å•ç”Ÿäº§è€…+å¤šçº¿ç¨‹ï¼›è¶…é«˜åååœºæ™¯ï¼ˆå¦‚æ¯ç§’ç™¾ä¸‡æ¶ˆæ¯ï¼‰å¯åˆ›å»ºå¤šä¸ªç”Ÿäº§è€…å®ä¾‹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¤šçº¿ç¨‹ç”Ÿäº§è€…ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiThreadProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="hljs-string">"localhost:9092"</span>);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);

        KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props);

        <span class="hljs-comment">// å¯åŠ¨å¤šä¸ªçº¿ç¨‹å…±äº«ç”Ÿäº§è€…</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                    ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"my-topic"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value"</span>);
                    producer.send(record);
                }
            }).start();
        }
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å•ä¸ª<code>KafkaProducer</code>å®ä¾‹è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œå†…éƒ¨é˜Ÿåˆ—ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</li>
<li>é¿å…ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºç‹¬ç«‹ç”Ÿäº§è€…ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚</li>
</ul>
<p><strong>è¿‡æ¸¡</strong>ï¼šæ€§èƒ½ä¼˜åŒ–è®©ç”Ÿäº§è€…è·‘å¾—æ›´å¿«ï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œé…ç½®ä¸å½“æˆ–å¼‚å¸¸å¤„ç†ä¸åˆ°ä½å¯èƒ½å¯¼è‡´â€œç¿»è½¦â€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†äº«æœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒã€‚</p>
<hr/>
<h2 data-id="heading-14">5. æœ€ä½³å®è·µä¸è¸©å‘ç»éªŒ</h2>
<p>Kafkaç”Ÿäº§è€…çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„çµæ´»æ€§ï¼Œä½†çµæ´»æ€§ä¹Ÿå¸¦æ¥äº†å¤æ‚æ€§ã€‚åŸºäº10å¹´åˆ†å¸ƒå¼ç³»ç»Ÿç»éªŒï¼Œæœ¬èŠ‚æ€»ç»“äº†ç”Ÿäº§ç¯å¢ƒçš„æ¨èå®è·µï¼Œå¹¶åˆ†äº«å¸¸è§è¸©å‘åŠè§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<h3 data-id="heading-15">5.1 æœ€ä½³å®è·µ</h3>
<ul>
<li><strong>é…ç½®è§„èŒƒåŒ–</strong>ï¼šç”Ÿäº§ç¯å¢ƒæ¨èä»¥ä¸‹é…ç½®ï¼š
<ul>
<li><code>acks=all</code>ï¼Œç¡®ä¿é«˜å¯é æ€§ã€‚</li>
<li><code>enable.idempotence=true</code>ï¼Œé˜²æ­¢é‡å¤å‘é€ã€‚</li>
<li><code>compression.type=snappy</code>ï¼Œå¹³è¡¡æ€§èƒ½ä¸å‹ç¼©ã€‚</li>
<li><code>linger.ms=5</code>ï¼Œæå‡æ‰¹æ¬¡æ•ˆç‡ã€‚</li>
</ul>
</li>
<li><strong>ç›‘æ§ä¸å‘Šè­¦</strong>ï¼šé€šè¿‡JMXç›‘æ§å…³é”®æŒ‡æ ‡ï¼Œå¦‚<code>buffer-full</code>ï¼ˆç¼“å†²åŒºæº¢å‡ºï¼‰ã€<code>record-error-rate</code>ï¼ˆé”™è¯¯ç‡ï¼‰ã€‚å»ºè®®é›†æˆPrometheus+Grafanaï¼Œè®¾ç½®å‘Šè­¦é˜ˆå€¼ã€‚</li>
<li><strong>åˆ†åŒºè§„åˆ’</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆ†åŒºæ•°ï¼Œå»ºè®®åˆ†åŒºæ•°ä¸ºBrokeræ•°çš„2-3å€ï¼Œç¡®ä¿è´Ÿè½½å‡è¡¡ã€‚</li>
<li><strong>ä¼˜é›…å…³é—­</strong>ï¼šè°ƒç”¨<code>producer.close()</code>ç­‰å¾…ç¼“å†²åŒºæ¶ˆæ¯å‘é€å®Œæˆï¼Œé¿å…å…³é—­æ—¶ä¸¢å¤±æ¶ˆæ¯ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªç”µå•†åº“å­˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è§„åˆ’åˆ†åŒºæ•°ï¼ˆBrokeræ•°Ã—2ï¼‰å’Œç›‘æ§<code>record-queue-time-avg</code>æŒ‡æ ‡ï¼Œä¼˜åŒ–äº†åº“å­˜æ¶ˆæ¯çš„å¤„ç†æ•ˆç‡ï¼Œå»¶è¿Ÿä»50msé™è‡³20msã€‚</p>
<h3 data-id="heading-16">5.2 å¸¸è§è¸©å‘ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>æ¶ˆæ¯ä¸¢å¤±</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼š<code>acks=0</code>æˆ–ç¼“å†²åŒºæº¢å‡ºï¼ˆ<code>buffer.memory</code>ä¸è¶³ï¼‰ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè®¾<code>acks=all</code>ï¼Œå¢å¤§<code>buffer.memory</code>è‡³64MBï¼Œç›‘æ§<code>buffer-exhausted-rate</code>ã€‚</li>
<li><strong>æ¡ˆä¾‹</strong>ï¼šæŸæ—¥å¿—ç³»ç»Ÿå› <code>acks=0</code>ä¸¢å¤±å…³é”®äº‹ä»¶ï¼Œæ”¹ä¸º<code>acks=1</code>å¹¶éªŒè¯æ¶ˆè´¹è€…ç«¯å®Œæ•´æ€§ã€‚</li>
</ul>
</li>
<li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼š<code>linger.ms</code>è¿‡é«˜ï¼ˆå¦‚100msï¼‰å¯¼è‡´å»¶è¿Ÿå¢åŠ ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè°ƒä½è‡³5-10msï¼Œç»“åˆ<code>batch.size=128KB</code>ã€‚</li>
<li><strong>æ¡ˆä¾‹</strong>ï¼šä¿®å¤æŸé¡¹ç›®å› <code>linger.ms=200</code>å¯¼è‡´çš„å»¶è¿Ÿé—®é¢˜ï¼Œååé‡æå‡50%ã€‚</li>
</ul>
</li>
<li><strong>åºåˆ—izationé—®é¢˜</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼šè‡ªå®šä¹‰åºåˆ—åŒ–å™¨ä¸æ¶ˆè´¹è€…ä¸å…¼å®¹ï¼Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨æ ‡å‡†åºåˆ—åŒ–å™¨ï¼ˆå¦‚JSONã€Avroï¼‰ï¼Œå¹¶è®°å½•Schemaã€‚</li>
</ul>
</li>
<li><strong>Brokerå¼‚å¸¸</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼šLeaderåˆ‡æ¢æˆ–ç½‘ç»œæŠ–åŠ¨å¯¼è‡´å‘é€å¤±è´¥ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé…ç½®<code>retries=5</code>å’Œ<code>retry.backoff.ms=200</code>ï¼Œå¯ç”¨å¹‚ç­‰æ€§ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šæŸé¡¹ç›®å› é‡è¯•æ¬¡æ•°è®¾ä¸º0ï¼ŒBrokerçŸ­æš‚æŠ–åŠ¨å³å¯¼è‡´æ¶ˆæ¯å †ç§¯ã€‚æˆ‘ä»¬è°ƒæ•´<code>retries=5</code>å¹¶ç›‘æ§<code>request-latency-avg</code>ï¼Œé—®é¢˜è§£å†³ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡æœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒï¼Œæˆ‘ä»¬èƒ½æ›´å¥½åœ°é©¾é©­ç”Ÿäº§è€…ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ç”Ÿäº§è€…åœ¨çœŸå®é¡¹ç›®ä¸­çš„è¡¨ç°ã€‚</p>
<hr/>
<h2 data-id="heading-17">6. å®é™…é¡¹ç›®åº”ç”¨åœºæ™¯</h2>
<p>Kafkaç”Ÿäº§è€…çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„æ™®é€‚æ€§ï¼Œæ— è®ºæ˜¯æ—¥å¿—æ”¶é›†ã€è®¢å•å¤„ç†ï¼Œè¿˜æ˜¯æ•°æ®åŒæ­¥ï¼Œéƒ½èƒ½æ¸¸åˆƒæœ‰ä½™ã€‚æœ¬èŠ‚é€šè¿‡ä¸‰ä¸ªå…¸å‹åœºæ™¯ï¼Œå±•ç¤ºç”Ÿäº§è€…çš„é…ç½®ä¸å®ç°ã€‚</p>
<h3 data-id="heading-18">6.1 åœºæ™¯ä¸€ï¼šå®æ—¶æ—¥å¿—æ”¶é›†</h3>
<p><strong>éœ€æ±‚</strong>ï¼šæ”¶é›†æœåŠ¡æ—¥å¿—ï¼Œéœ€é«˜ååã€ä½å»¶è¿Ÿï¼Œæ”¯æŒç™¾ä¸‡çº§æ¶ˆæ¯/ç§’ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>é…ç½®é«˜ååå‚æ•°ï¼š<code>compression.type=snappy</code>ã€<code>batch.size=128KB</code>ã€<code>linger.ms=5</code>ã€‚</li>
<li>ä½¿ç”¨å¼‚æ­¥å‘é€ï¼Œå‡å°‘é˜»å¡ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼ˆSpring Kafkaï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> KafkaTemplate&lt;String, String&gt; kafkaTemplate;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendLog</span><span class="hljs-params">(String log)</span> {
    kafkaTemplate.send(<span class="hljs-string">"logs"</span>, log)
        .addCallback(
            result -&gt; System.out.println(<span class="hljs-string">"Log sent: "</span> + result.getRecordMetadata().offset()),
            ex -&gt; ex.printStackTrace()
        );
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šååé‡è¾¾50ä¸‡æ¡/ç§’ï¼Œå»¶è¿Ÿæ§åˆ¶åœ¨20msä»¥å†…ã€‚</p>
<h3 data-id="heading-19">6.2 åœºæ™¯äºŒï¼šè®¢å•æµå¤„ç†</h3>
<p><strong>éœ€æ±‚</strong>ï¼šç¡®ä¿è®¢å•æ¶ˆæ¯æŒ‰ç”¨æˆ·é¡ºåºå¤„ç†ï¼Œé«˜å¯é æ€§ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>è®¾ç½®Keyä¸ºç”¨æˆ·IDï¼Œä¿è¯åˆ†åŒºé¡ºåºã€‚</li>
<li>å¯ç”¨å¹‚ç­‰ç”Ÿäº§è€…ï¼Œé˜²æ­¢é‡å¤æ‰£å‡åº“å­˜ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, <span class="hljs-literal">true</span>);
ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"orders"</span>, userId, orderJson);
producer.send(record);
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè®¢å•æ¶ˆæ¯ä¸¥æ ¼é¡ºåºï¼Œåº“å­˜æ‰£å‡æ— é‡å¤ã€‚</p>
<h3 data-id="heading-20">6.3 åœºæ™¯ä¸‰ï¼šè·¨ç³»ç»Ÿæ•°æ®åŒæ­¥</h3>
<p><strong>éœ€æ±‚</strong>ï¼šMySQLæ•°æ®åº“å˜æ›´åŒæ­¥åˆ°Kafkaï¼Œä¿è¯ä¸€è‡´æ€§ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨äº‹åŠ¡ç”Ÿäº§è€…ï¼Œç¡®ä¿æ•°æ®åº“æ›´æ–°ä¸æ¶ˆæ¯å‘é€åŸå­æ€§ã€‚</li>
<li>ç»“åˆDebeziumæ•è·Binlogï¼Œå‘é€åˆ°Kafkaã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">producer.initTransactions();
<span class="hljs-keyword">try</span> {
    producer.beginTransaction();
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"db-changes"</span>, <span class="hljs-string">"key"</span>, binlogJson));
    <span class="hljs-comment">// æ•°æ®åº“æ›´æ–°</span>
    producer.commitTransaction();
} <span class="hljs-keyword">catch</span> (Exception e) {
    producer.abortTransaction();
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šæ•°æ®åº“ä¸Kafkaæ•°æ®é›¶ä¸ä¸€è‡´ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡è¿™äº›åœºæ™¯ï¼Œæˆ‘ä»¬çœ‹åˆ°ç”Ÿäº§è€…çš„çµæ´»æ€§ä¸å¼ºå¤§åŠŸèƒ½ã€‚æœ€åï¼Œè®©æˆ‘ä»¬æ€»ç»“ç»éªŒå¹¶å±•æœ›æœªæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-21">7. æ€»ç»“ä¸å±•æœ›</h2>
<p>Kafkaç”Ÿäº§è€…æ˜¯æ¶ˆæ¯æµçš„èµ·ç‚¹ï¼Œå…¶çµæ´»çš„å‘é€æ¨¡å¼ã€å¯é çš„ä¿éšœæœºåˆ¶å’Œå¼ºå¤§çš„æ€§èƒ½ä¼˜åŒ–èƒ½åŠ›ï¼Œè®©å®ƒæˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¾—åŠ›åŠ©æ‰‹ã€‚é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬æ·±å…¥å‰–æäº†ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä»åŸºæœ¬æµç¨‹åˆ°å¯é æ€§ä¿éšœï¼Œå†åˆ°æ€§èƒ½è°ƒä¼˜ï¼Œæ¯ä¸€æ­¥éƒ½é…ä»¥ä»£ç å’Œæ¡ˆä¾‹ï¼Œç¡®ä¿ä½ èƒ½å°†ç†è®ºè½¬åŒ–ä¸ºå®è·µã€‚</p>
<p><strong>å…³é”®æ”¶è·</strong>ï¼š</p>
<ul>
<li><strong>æœºåˆ¶ç†è§£</strong>ï¼šæ¶ˆæ¯å‘é€ã€åˆ†åŒºåˆ†é…ã€ç¼“å†²åŒºç®¡ç†çš„æ¯ä¸€æ­¥éƒ½å½±å“æ€§èƒ½ä¸å¯é æ€§ã€‚</li>
<li><strong>ä¼˜åŒ–æŠ€å·§</strong>ï¼šé€šè¿‡å‚æ•°è°ƒä¼˜ï¼ˆå¦‚<code>batch.size</code>ã€<code>compression.type</code>ï¼‰å’Œæ‰¹é‡å‘é€ï¼Œå¯å¤§å¹…æå‡ååé‡ã€‚</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šè§„èŒƒåŒ–é…ç½®ã€ç›‘æ§å‘Šè­¦å’Œä¼˜é›…å…³é—­æ˜¯ç”Ÿäº§ç¯å¢ƒå¿…å¤‡ã€‚</li>
</ul>
<p><strong>æœªæ¥å±•æœ›</strong>ï¼šéšç€Kafkaçš„æ¼”è¿›ï¼ˆå¦‚KRaftæ¨¡å¼å–ä»£ZooKeeperï¼‰ï¼Œç”Ÿäº§è€…å¯èƒ½è¿æ¥æ›´é«˜æ•ˆçš„å…ƒæ•°æ®ç®¡ç†å’Œæ›´ä½çš„å»¶è¿Ÿã€‚æ–°ç‰ˆæœ¬çš„å‹ç¼©ç®—æ³•ï¼ˆå¦‚zstdï¼‰å’ŒåŠ¨æ€é…ç½®æ”¯æŒï¼Œä¹Ÿå€¼å¾—å…³æ³¨ã€‚</p>
<p><strong>é¼“åŠ±è¡ŒåŠ¨</strong>ï¼šåˆ«è®©è¿™äº›çŸ¥è¯†åœç•™åœ¨çº¸é¢ï¼å»ºè®®ä½ ç»“åˆé¡¹ç›®å®è·µï¼Œå°è¯•è°ƒæ•´ç”Ÿäº§è€…é…ç½®ï¼ŒéªŒè¯ååé‡å’Œå»¶è¿Ÿçš„å˜åŒ–ï¼Œå¹¶åœ¨å›¢é˜Ÿä¸­åˆ†äº«ç»éªŒã€‚Kafkaçš„ä¸–ç•Œå¾ˆå¤§ï¼Œæ¢ç´¢æ°¸æ— æ­¢å¢ƒï¼</p>
<hr/>
<h2 data-id="heading-22">8. é™„å½•</h2>
<p>Kafkaç”Ÿäº§è€…çš„å­¦ä¹ å’Œå®è·µä¹‹æ—…ï¼Œå°±åƒæ”€ç™»ä¸€åº§æŠ€æœ¯é«˜å³°ï¼Œæ—¢éœ€è¦æ‰å®çš„ç†è®ºï¼Œä¹Ÿç¦»ä¸å¼€è¶æ‰‹çš„å·¥å…·å’Œç»éªŒåˆ†äº«ã€‚æœ¬èŠ‚ä¸ºä½ æ•´ç†äº†ä¸€äº›å®ç”¨èµ„æºå’Œå¸¸è§é—®é¢˜è§£ç­”ï¼ŒåŠ©ä½ æ›´é¡ºç•…åœ°é©¾é©­Kafkaç”Ÿäº§è€…ã€‚</p>
<h3 data-id="heading-23">8.1 å‚è€ƒèµ„æ–™</h3>
<ul>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼šApache Kafkaå®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fkafka.apache.org%2Fdocumentation%2F%25EF%25BC%2589%25E6%2598%25AF%25E7%2594%259F%25E4%25BA%25A7%25E8%2580%2585%25E9%2585%258D%25E7%25BD%25AE%25E5%2592%258C%25E6%259C%25BA%25E5%2588%25B6%25E7%259A%2584%25E6%259D%2583%25E5%25A8%2581%25E6%258C%2587%25E5%258D%2597%25EF%25BC%258C%25E5%25B0%25A4%25E5%2585%25B6%25E6%2598%25AFProducer" target="_blank" title="https://kafka.apache.org/documentation/%EF%BC%89%E6%98%AF%E7%94%9F%E4%BA%A7%E8%80%85%E9%85%8D%E7%BD%AE%E5%92%8C%E6%9C%BA%E5%88%B6%E7%9A%84%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%EF%BC%8C%E5%B0%A4%E5%85%B6%E6%98%AFProducer" ref="nofollow noopener noreferrer">kafka.apache.org/documentatiâ€¦</a> APIéƒ¨åˆ†ã€‚</li>
<li><strong>æ¨èä¹¦ç±</strong>ï¼šã€ŠKafka: The Definitive Guideã€‹ï¼ˆConfluentå›¢é˜Ÿè‘—ï¼‰ï¼Œæ·±å…¥å‰–æKafkaå†…éƒ¨åŸç†ï¼Œé€‚åˆè¿›é˜¶å­¦ä¹ ã€‚</li>
<li><strong>ç¤¾åŒºèµ„æº</strong>ï¼šConfluentåšå®¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.confluent.io%2Fblog%2F%25EF%25BC%2589%25E5%2592%258CStack" target="_blank" title="https://www.confluent.io/blog/%EF%BC%89%E5%92%8CStack" ref="nofollow noopener noreferrer">www.confluent.io/blog/ï¼‰å’ŒStacâ€¦</a> Overflowçš„Kafkaæ ‡ç­¾ï¼Œæä¾›äº†å¤§é‡å®æˆ˜æ¡ˆä¾‹å’Œé—®é¢˜è§£ç­”ã€‚</li>
</ul>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼šæˆ‘æ›¾é€šè¿‡åå¤æŸ¥é˜…å®˜æ–¹æ–‡æ¡£å’ŒConfluentåšå®¢ï¼Œè§£å†³äº†ä¸€ä¸ªå› <code>max.in.flight.requests</code>é…ç½®ä¸å½“å¯¼è‡´çš„ä¹±åºé—®é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¤šçœ‹æºç å’Œç¤¾åŒºè®¨è®ºã€‚</p>
<h3 data-id="heading-24">8.2 å·¥å…·æ¨è</h3>
<ul>
<li><strong>Kafka Manager</strong>ï¼šYahooå¼€æºçš„é›†ç¾¤ç®¡ç†å·¥å…·ï¼Œé€‚åˆç›‘æ§Topicã€åˆ†åŒºå’Œç”Ÿäº§è€…çŠ¶æ€ã€‚</li>
<li><strong>Confluent Control Center</strong>ï¼šå•†ä¸šåŒ–å·¥å…·ï¼Œæä¾›ç”Ÿäº§è€…æ€§èƒ½æŒ‡æ ‡çš„å¯è§†åŒ–åˆ†æï¼Œé€‚åˆå¤§å‹é¡¹ç›®ã€‚</li>
<li><strong>Kafka Tool</strong>ï¼šè½»é‡çº§GUIå·¥å…·ï¼Œä¾¿äºæŸ¥çœ‹æ¶ˆæ¯å†…å®¹å’Œè°ƒè¯•ç”Ÿäº§è€…ã€‚</li>
</ul>
<p><strong>å®è·µç»éªŒ</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Kafka Managerç›‘æ§<code>record-queue-time</code>ï¼Œå¿«é€Ÿå®šä½äº†ç¼“å†²åŒºç“¶é¢ˆï¼ŒèŠ‚çœäº†å¤§é‡æ’æŸ¥æ—¶é—´ã€‚</p>
<h3 data-id="heading-25">8.3 Q&amp;Aï¼šå¸¸è§é—®é¢˜è§£ç­”</h3>
<ul>
<li><strong>Qï¼šå¦‚ä½•é€‰æ‹©å‹ç¼©ç®—æ³•ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼š<code>snappy</code>é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå¹³è¡¡æ€§èƒ½ä¸å‹ç¼©æ¯”ï¼›<code>gzip</code>é€‚åˆå¸¦å®½å—é™ç¯å¢ƒï¼›<code>zstd</code>åœ¨é«˜åååœºæ™¯è¡¨ç°ä¼˜å¼‚ï¼Œä½†éœ€æµ‹è¯•å…¼å®¹æ€§ã€‚</li>
</ul>
</li>
<li><strong>Qï¼šç”Ÿäº§è€…å…³é—­æ—¶ä¼šä¸¢å¤±æ¶ˆæ¯å—ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼šè°ƒç”¨<code>producer.close(timeout)</code>ï¼Œç¡®ä¿ç¼“å†²åŒºæ¶ˆæ¯å‘é€å®Œæˆã€‚æ¨èè®¾ç½®åˆç†è¶…æ—¶ï¼ˆå¦‚10ç§’ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>Qï¼šå¦‚ä½•åˆ¤æ–­åˆ†åŒºæ•°æ˜¯å¦åˆç†ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼šåˆ†åŒºæ•°å»ºè®®ä¸ºBrokeræ•°çš„2-3å€ï¼Œç»“åˆä¸šåŠ¡å¹¶å‘éœ€æ±‚æµ‹è¯•ï¼Œè§‚å¯Ÿæ¶ˆè´¹è€…å»¶è¿Ÿå’ŒBrokerè´Ÿè½½ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç›¸å…³æŠ€æœ¯ç”Ÿæ€</strong>ï¼šKafkaç”Ÿäº§è€…å¸¸ä¸Spring Kafkaã€Confluent Schema Registryï¼ˆåºåˆ—åŒ–ç®¡ç†ï¼‰ã€Debeziumï¼ˆCDCåŒæ­¥ï¼‰ç­‰ç”Ÿæ€å·¥å…·é…åˆä½¿ç”¨ã€‚æŒæ¡è¿™äº›å·¥å…·ï¼Œèƒ½è®©ä½ çš„æ¶ˆæ¯æµæ›´é«˜æ•ˆã€‚</p>
<p><strong>æœªæ¥è¶‹åŠ¿</strong>ï¼šKafkaçš„KRaftæ¨¡å¼æ­£åœ¨å–ä»£ZooKeeperï¼Œæœªæ¥ç”Ÿäº§è€…å¯èƒ½å—ç›Šäºæ›´å¿«çš„å…ƒæ•°æ®åŒæ­¥å’Œæ›´ä½çš„å»¶è¿Ÿã€‚æ­¤å¤–ï¼Œç¤¾åŒºå¯¹exactly-onceè¯­ä¹‰çš„ä¼˜åŒ–ï¼ˆå¦‚äº‹åŠ¡æ€§èƒ½æå‡ï¼‰å€¼å¾—æœŸå¾…ã€‚</p>
<hr/>
<h2 data-id="heading-26">æ–‡ç« æ”¶å°¾</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å¯¹Kafkaç”Ÿäº§è€…çš„å…¨é¢å‰–æï¼Œä»æ ¸å¿ƒæœºåˆ¶åˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œå†åˆ°æœ€ä½³å®è·µå’ŒçœŸå®æ¡ˆä¾‹ï¼Œæ¯ä¸€æ­¥éƒ½åŠ›æ±‚è®©ä½ ä¸ä»…â€œçŸ¥å…¶ç„¶â€ï¼Œè¿˜èƒ½â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚å¸Œæœ›è¿™äº›å†…å®¹èƒ½æˆä¸ºä½ é¡¹ç›®ä¸­çš„â€œé”¦å›Šå¦™è®¡â€ï¼Œå¸®åŠ©ä½ åº”å¯¹æ¶ˆæ¯å‘é€çš„å„ç§æŒ‘æˆ˜ã€‚</p>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼šä½œä¸ºä¸€åä»ä¸š10å¹´çš„å·¥ç¨‹å¸ˆï¼Œæˆ‘å‘ç°Kafkaç”Ÿäº§è€…çš„é­…åŠ›åœ¨äºå®ƒçš„å¹³è¡¡æ€§â€”â€”æ—¢èƒ½æ»¡è¶³é«˜ååéœ€æ±‚ï¼Œåˆèƒ½ä¿éšœä¸¥æ ¼çš„å¯é æ€§ã€‚æ¯æ¬¡ä¼˜åŒ–ç”Ÿäº§è€…é…ç½®ï¼Œéƒ½åƒåœ¨è°ƒè¯•ä¸€è¾†èµ›è½¦ï¼Œæ‰¾åˆ°æ€§èƒ½ä¸ç¨³å®šçš„æœ€ä½³å¥‘åˆç‚¹ï¼Œæˆå°±æ„Ÿæ»¡æ»¡ã€‚</p>
<p><strong>è¡ŒåŠ¨å·å¬</strong>ï¼šç°åœ¨ï¼Œè½®åˆ°ä½ äº†ï¼ä¸å¦¨æ‰“å¼€ä½ çš„Kafkaé¡¹ç›®ï¼Œè¯•è¯•è°ƒæ•´<code>linger.ms</code>æˆ–å¯ç”¨å¹‚ç­‰æ€§ï¼Œçœ‹çœ‹ååé‡å’Œå»¶è¿Ÿæœ‰ä½•å˜åŒ–ã€‚å¦‚æœæœ‰æ–°çš„å‘ç°ï¼Œæ¬¢è¿åœ¨ç¤¾åŒºåˆ†äº«ï¼Œæˆ‘ä»¬ä¸€èµ·æˆé•¿ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹]]></title>    <link>https://juejin.cn/post/7603352117638856713</link>    <guid>https://juejin.cn/post/7603352117638856713</guid>    <pubDate>2026-02-06T07:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603352117638856713" data-draft-id="7603352117638791177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,JavaScript"/> <meta itemprop="datePublished" content="2026-02-06T07:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘å®‰ä¸œå°¼"/> <meta itemprop="url" content="https://juejin.cn/user/1521379823340792"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379823340792/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘å®‰ä¸œå°¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T07:34:19.000Z" title="Fri Feb 06 2026 07:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fsingle-flight-mutations-in-tanstack-start-part-2%2F" target="_blank" title="https://frontendmasters.com/blog/single-flight-mutations-in-tanstack-start-part-2/" ref="nofollow noopener noreferrer">Single Flight Mutations in TanStack Start: Part 2</a></p>
<p>ä½œè€…ï¼šAdam Rackis</p>
<p>æ—¥æœŸï¼š2026å¹´1æœˆ28æ—¥</p>
<p>ç¿»è¯‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTUARAN" target="_blank" title="https://github.com/TUARAN" ref="nofollow noopener noreferrer">TUARAN</a></p>
<p>æ¬¢è¿å…³æ³¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTUARAN%2Ffrontend-weekly-digest-cn" target="_blank" title="https://github.com/TUARAN/frontend-weekly-digest-cn" ref="nofollow noopener noreferrer">å‰ç«¯å‘¨åˆŠ</a>ï¼Œæ¯å‘¨æ›´æ–°å›½å¤–è®ºå›çš„å‰ç«¯çƒ­é—¨æ–‡ç« ï¼Œç´§è·Ÿæ—¶äº‹ï¼ŒæŒæ¡å‰ç«¯æŠ€æœ¯åŠ¨æ€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">TL;DR</h2>
<p>è¿™ç¯‡æ–‡ç« å»¶ç»­ Part 1 çš„æ€è·¯ï¼šæŠŠä¸€æ¬¡ mutation æ‰€éœ€çš„ UI æ›´æ–°æ•°æ®ï¼Œåœ¨åŒä¸€æ¬¡ç½‘ç»œå¾€è¿”é‡Œä¸€èµ·å¸¦å›æ¥ï¼ˆé¿å… mutation åå†é¢å¤–å‘è¯·æ±‚ refetchï¼‰ã€‚</p>
<p>Part 2 çš„é‡ç‚¹æ˜¯æŠŠâ€œè¦ refetch å“ªäº›æŸ¥è¯¢â€æŠ½æˆå¯å¤ç”¨çš„ middlewareï¼šè°ƒç”¨ server function æ—¶ä¼ å…¥ react-query çš„ <code>QueryKey[]</code>ï¼Œmiddleware ä¼šåœ¨å®¢æˆ·ç«¯ä» Query Cache æ‰¾åˆ°æ¯ä¸ª query å¯¹åº”çš„ <code>serverFn</code> å’Œå‚æ•°ï¼ŒæŠŠè¿™äº›ä¿¡æ¯é€šè¿‡ <code>sendContext</code> é€åˆ°æœåŠ¡ç«¯ç»Ÿä¸€æ‰§è¡Œï¼Œç„¶åæŠŠç»“æœå›ä¼ ç»™å®¢æˆ·ç«¯å¹¶ç”¨ <code>setQueryData</code> å†™å›ç¼“å­˜ã€‚</p>
<hr/>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fsingle-flight-mutations-in-tanstack-start-part-1%2F" target="_blank" title="https://frontendmasters.com/blog/single-flight-mutations-in-tanstack-start-part-1/" ref="nofollow noopener noreferrer">Part 1</a> é‡Œï¼Œæˆ‘ä»¬èŠè¿‡ single flight mutationsï¼šå®ƒè®©ä½ åœ¨æ›´æ–°æ•°æ®æ—¶ï¼ŒåŒæ—¶æŠŠ UI éœ€è¦çš„æ‰€æœ‰ç›¸å…³â€œå·²æ›´æ–°æ•°æ®â€é‡æ–°è·å–å›æ¥ï¼Œå¹¶ä¸”æ•´ä¸ªè¿‡ç¨‹åªéœ€è¦ä¸€æ¬¡è·¨ç½‘ç»œçš„å¾€è¿”ã€‚</p>
<p>æˆ‘ä»¬å½“æ—¶åšäº†ä¸ªå¾ˆæœ´ç´ çš„å®ç°ï¼šåœ¨â€œæ›´æ–°æ•°æ®â€çš„ server function é‡Œç›´æ¥æŠŠéœ€è¦çš„ä¸œè¥¿ refetch ä¸€éã€‚å®ƒç¡®å®èƒ½ç”¨ï¼Œä½†å¯æ‰©å±•æ€§å’Œçµæ´»æ€§éƒ½ä¸€èˆ¬ï¼ˆè€¦åˆä¹Ÿåé‡ï¼‰ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šå®ç°åŒæ ·çš„æ•ˆæœï¼Œä½†æ–¹å¼æ›´é€šç”¨ï¼šå®šä¹‰ä¸€ä¸ªâ€œrefetch middlewareâ€ï¼ŒæŠŠå®ƒæŒ‚åˆ°ä»»æ„ server function ä¸Šã€‚è¿™ä¸ª middleware å…è®¸æˆ‘ä»¬é€šè¿‡ react-query çš„ key æŒ‡å®šè¦ refetch çš„æ•°æ®ï¼Œå‰©ä¸‹çš„äº‹æƒ…å®ƒä¼šè‡ªåŠ¨å®Œæˆã€‚</p>
<p>æˆ‘ä»¬ä¼šå…ˆåšä¸€ä¸ªæœ€ç®€å•ç‰ˆæœ¬ï¼Œç„¶åä¸æ–­åŠ èƒ½åŠ›ã€åŠ çµæ´»æ€§ã€‚åˆ°æœ€åä¼šç¨å¾®å¤æ‚ä¸€äº›ï¼Œä½†è¯·åˆ«è¯¯ä¼šï¼šä½ ä¸éœ€è¦æŠŠæ–‡ä¸­è®²çš„å…¨éƒ¨éƒ½ç”¨ä¸Šã€‚äº‹å®ä¸Šï¼Œå¯¹ç»å¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œsingle flight mutations å¯èƒ½å®Œå…¨æ— å…³ç´§è¦ã€‚æ›´åˆ«è¢«â€œé«˜çº§åšæ³•â€è¿·æƒ‘äº†ï¼šå¯¹å¾ˆå¤šå°åº”ç”¨è€Œè¨€ï¼Œç›´æ¥åœ¨ server function é‡Œ refetch ä¸€ç‚¹æ•°æ®å¯èƒ½å°±è¶³å¤Ÿäº†ã€‚</p>
<p>ä¸è¿‡ï¼Œè·Ÿç€åšä¸€éï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€äº›å¾ˆé…·çš„ TanStackï¼ˆç”šè‡³ TypeScriptï¼‰ç‰¹æ€§ã€‚å³ä¾¿ä½ æ°¸è¿œä¸ç”¨ single flight mutationsï¼Œè¿™äº›å†…å®¹ä¹Ÿå¾ˆå¯èƒ½åœ¨åˆ«çš„åœºæ™¯æ´¾ä¸Šç”¨åœºã€‚</p>
<h2 data-id="heading-1">æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª Middleware</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftanstack.com%2Fquery%2Flatest" target="_blank" title="https://tanstack.com/query/latest" ref="nofollow noopener noreferrer">TanStack Query</a>ï¼ˆæˆ‘ä»¬æœ‰æ—¶ä¹Ÿä¼šç§°å®ƒä¸º react-queryï¼Œè¿™æ˜¯å®ƒçš„åŒ…åï¼‰å·²ç»æœ‰ä¸€å¥—éå¸¸å¥½ç”¨çš„å±‚çº§ key ç³»ç»Ÿã€‚å¦‚æœæˆ‘ä»¬çš„ middleware èƒ½ç›´æ¥æ¥æ”¶â€œè¦ refetch çš„ query keysâ€ï¼Œç„¶åå°±â€¦â€¦è‡ªåŠ¨æå®šï¼Œé‚£è¯¥å¤šå¥½ï¼Ÿ</p>
<p>é—®é¢˜åœ¨äºï¼šmiddleware è¦æ€ä¹ˆçŸ¥é“â€œæ€ä¹ˆ refetchâ€å‘¢ï¼Ÿç¬¬ä¸€çœ¼çœ‹ç¡®å®æœ‰ç‚¹éš¾ã€‚æˆ‘ä»¬çš„ queriesï¼ˆåˆ»æ„ä¿æŒç®€å•ï¼‰æœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹ server functions çš„è°ƒç”¨ã€‚ä½†æˆ‘ä»¬æ²¡æ³•æŠŠä¸€ä¸ªæ™®é€šå‡½æ•°å¼•ç”¨ä¼ åˆ°æœåŠ¡ç«¯ï¼›å‡½æ•°ä¸å¯åºåˆ—åŒ–ï¼Œè¿™å¾ˆåˆç†ã€‚ä½ èƒ½æŠŠå­—ç¬¦ä¸²/æ•°å­—/å¸ƒå°”å€¼åºåˆ—åŒ–æˆ JSON åœ¨çº¿ä¸Šä¼ è¾“ï¼Œä½†ä¸€ä¸ªå‡½æ•°å¯èƒ½å¸¦çŠ¶æ€ã€é—­åŒ…ã€ä¸Šä¸‹æ–‡â€¦â€¦ä¼ è¿‡å»æ ¹æœ¬è¯´ä¸æ¸…ã€‚</p>
<p>é™¤éâ€”â€”å®ƒæ˜¯ TanStack Start çš„ server functionã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®èƒŒåçš„å·¥ç¨‹å¸ˆä»¬ä¸ºåºåˆ—åŒ–å¼•æ“åšäº†å®šåˆ¶ï¼Œä½¿å…¶æ”¯æŒ server functionsã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šä½ å¯ä»¥ä»å®¢æˆ·ç«¯æŠŠä¸€ä¸ª server function â€œå‘åˆ°â€æœåŠ¡ç«¯ï¼Œå®ƒèƒ½æ­£å¸¸å·¥ä½œã€‚åº•å±‚åŸç†æ˜¯ï¼šserver functions æœ‰ä¸€ä¸ªå†…éƒ¨ IDã€‚TanStack ä¼šæ•æ‰åˆ°å®ƒã€å‘é€ IDï¼Œç„¶ååœ¨å¦ä¸€ç«¯æŠŠ ID ååºåˆ—åŒ–æˆå¯¹åº”çš„ server functionã€‚</p>
<p>ä¸ºäº†è®©äº‹æƒ…æ›´ç®€å•ï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠ server functionï¼ˆä»¥åŠå®ƒéœ€è¦çš„å‚æ•°ï¼‰ç›´æ¥æ”¾åˆ°æˆ‘ä»¬å·²ç»å®šä¹‰å¥½çš„ query options ä¸Šã€‚è¿™æ · middleware åªè¦æ‹¿åˆ° query keysï¼Œå°±èƒ½ä» TanStack Query çš„ cache é‡Œæ‰¾åˆ°å¯¹åº”çš„ query optionsï¼Œæ‹¿åˆ°â€œå¦‚ä½• refetchâ€çš„ä¿¡æ¯ï¼Œç„¶åæŠŠæ•´ä¸ªæµç¨‹ä¸²èµ·æ¥ã€‚</p>
<h2 data-id="heading-2">å¼€å§‹å§</h2>
<p>é¦–å…ˆå¼•å…¥ä¸€äº›å¥½ç”¨çš„ä¸œè¥¿ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { createMiddleware, getRouterInstance } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-start"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">QueryClient</span>, <span class="hljs-title class_">QueryKey</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;
</code></pre>
<p>æ¥ç€æ›´æ–°æˆ‘ä»¬çš„ epics åˆ—è¡¨æŸ¥è¯¢ï¼ˆä¸»è¦çš„ epics åˆ—è¡¨ï¼‰çš„ query optionsï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, page],
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEpicsList</span>({ <span class="hljs-attr">data</span>: page });
      <span class="hljs-keyword">return</span> result;
    },
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        <span class="hljs-attr">serverFn</span>: getEpicsList,
        <span class="hljs-attr">arg</span>: page,
      },
    },
  });
};
</code></pre>
<p>æ³¨æ„è¿™ä¸ªæ–°å¢çš„ <code>meta</code> åŒºå—ã€‚å®ƒå…è®¸æˆ‘ä»¬å¾€ query ä¸Šå¡ä»»ä½•æˆ‘ä»¬éœ€è¦çš„å…ƒæ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬æ”¾äº† <code>getEpicsList</code> è¿™ä¸ª server function çš„å¼•ç”¨ä»¥åŠå®ƒéœ€è¦çš„å‚æ•°ã€‚è¿™æ ·å†™ç¡®å®ä¼šæœ‰â€œé‡å¤â€ï¼ˆ<code>queryFn</code> å†™äº†ä¸€æ¬¡è°ƒç”¨æ–¹å¼ï¼Œ<code>meta</code> åˆå†™äº†ä¸€æ¬¡ï¼‰ï¼Œå¦‚æœä½ è§‰å¾—åˆ«æ‰­ï¼Œå…ˆåˆ«æ€¥ï¼Œåé¢ä¼šå¤„ç†ã€‚summary æŸ¥è¯¢ï¼ˆç”¨äºç»Ÿè®¡æ•°é‡ï¼‰æˆ‘ä»¬ä¹Ÿä¼šåŒæ ·æ›´æ–°ï¼Œä¸è¿‡è¿™é‡Œæ²¡è´´ä»£ç ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠ middleware ä¸€ç‚¹ç‚¹æ‹¼å‡ºæ¥ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// the server function and args are all `any`, for now, </span>
<span class="hljs-comment">// to keep things simple we'll see how to type them in a bit</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">RevalidationPayload</span> = {
  <span class="hljs-attr">refetch</span>: {
    <span class="hljs-attr">key</span>: <span class="hljs-title class_">QueryKey</span>;
    <span class="hljs-attr">fn</span>: <span class="hljs-built_in">any</span>;
    <span class="hljs-attr">arg</span>: <span class="hljs-built_in">any</span>;
  }[];
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">RefetchMiddlewareConfig</span> = {
  <span class="hljs-attr">refetch</span>: <span class="hljs-title class_">QueryKey</span>[];
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};
</code></pre>
<p>æˆ‘ä»¬ä¸º middleware å®šä¹‰äº†ä¸€ä¸ªè¾“å…¥ã€‚è¿™ä¸ªè¾“å…¥ä¼šè‡ªåŠ¨ä¸â€œæŒ‚è½½è¯¥ middleware çš„ server function çš„è¾“å…¥â€åˆå¹¶ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¾“å…¥å†™æˆå¯é€‰çš„ï¼ˆ<code>config?</code>ï¼‰ï¼Œå› ä¸ºå®Œå…¨å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µï¼šä½ åªæƒ³è°ƒç”¨ server functionï¼Œä½†å¹¶ä¸æƒ³ refetch ä»»ä½•ä¸œè¥¿ã€‚</p>
<p>ç„¶åå¼€å§‹å†™ <code>.client</code> å›è°ƒï¼ˆåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼‰ï¼šå…ˆæ‹¿åˆ°è¦ refetch çš„ keysï¼š</p>
<p><code>const { refetch = [] } = data ?? {};</code></p>
<p>æ¥ç€æˆ‘ä»¬æ‹¿åˆ° <code>queryClient</code> å’Œå®ƒçš„ cacheï¼Œå¹¶åˆ›å»ºä¸€ä¸ª payloadï¼Œä¹‹åä¼šé€šè¿‡ <code>sendContext</code> å‘åˆ° <code>.server</code> å›è°ƒï¼Œè®©å®ƒæ‰§è¡ŒçœŸæ­£çš„ refetchã€‚</p>
<p>å¦‚æœä½ å¯¹ TanStack middleware ä¸ç†Ÿï¼Œæˆ‘ä¹‹å‰å†™çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fintroducing-tanstack-start-middleware%2F" target="_blank" title="https://frontendmasters.com/blog/introducing-tanstack-start-middleware/" ref="nofollow noopener noreferrer">middleware æ–‡ç« </a> å¯èƒ½ä¼šæ›´é€‚åˆä½œä¸ºå…¥é—¨ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
<span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
<span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

<span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
  <span class="hljs-attr">refetch</span>: [],
};
</code></pre>
<p>æˆ‘ä»¬çš„ <code>queryClient</code> å·²ç»æŒ‚åœ¨ TanStack router çš„ context ä¸Šï¼Œæ‰€ä»¥åªè¦æ‹¿åˆ° router å†å–å‡ºæ¥å³å¯ã€‚</p>
<p>è¿˜è®°å¾—æˆ‘ä»¬æŠŠ <code>__revalidate</code> å¡åˆ° query options çš„ <code>meta</code> é‡Œå—ï¼Ÿç°åœ¨æˆ‘ä»¬é’ˆå¯¹æ¯ä¸ª key å» cache é‡Œæ‰¾å¯¹åº” queryï¼Œå¹¶æŠŠ <code>serverFn/arg</code> æŠ½å‡ºæ¥ç»„è£…æˆè¦å‘ç»™æœåŠ¡ç«¯çš„ payloadã€‚</p>
<pre><code class="hljs language-ts" lang="ts">refetch.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key: QueryKey</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span> });
  <span class="hljs-keyword">if</span> (!entry) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      key,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<p><code>if (!entry) return;</code> æ˜¯ä¸ºäº†é˜²æ­¢è¯·æ±‚é‡ŒåŒ…å«äº†â€œå½“å‰ç¼“å­˜é‡Œæ ¹æœ¬ä¸å­˜åœ¨â€çš„ queryï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯èƒ½ä»æœªåœ¨ UI é‡Œè¢«è¯·æ±‚è¿‡ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ‹¿ä¸åˆ° <code>serverFn</code>ï¼Œä¹Ÿå°±æ— æ³• refetchã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥æŠŠ middleware è¾“å…¥æ‰©å±•å¾—æ›´ä¸°å¯Œï¼šæ¯”å¦‚å¯¹é‚£äº›â€œæ— è®ºæ˜¯å¦åœ¨ç¼“å­˜é‡Œéƒ½å¿…é¡»æ‰§è¡Œâ€çš„ refetchï¼Œç›´æ¥æŠŠ <code>serverFn + arg</code> ä¸€èµ·ä¼ ä¸Šå»ã€‚æ¯”å¦‚ä½ æ‰“ç®— mutation å redirectï¼Œå¹¶å¸Œæœ›æ–°é¡µé¢çš„æ•°æ®èƒ½é¢„å–ã€‚æœ¬æ–‡ä¸å®ç°è¿™ä¸ªå˜ä½“ï¼Œä½†å®ƒåªæ˜¯åŒä¸€ä¸»é¢˜çš„å¦ä¸€ç§ç»„åˆã€‚</p>
<p>æ¥ç€æˆ‘ä»¬è°ƒç”¨ <code>next</code>ï¼Œè§¦å‘çœŸæ­£çš„ server functionï¼ˆä»¥åŠå…¶å®ƒ middlewareï¼‰ã€‚é€šè¿‡ <code>sendContext</code> æˆ‘ä»¬æŠŠ <code>revalidate</code> å‘åˆ°æœåŠ¡ç«¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
  <span class="hljs-attr">sendContext</span>: {
    revalidate,
  },
});
</code></pre>
<p><code>result</code> æ˜¯ server function è°ƒç”¨çš„è¿”å›å€¼ã€‚å®ƒçš„ <code>context</code> ä¸Šä¼šæœ‰ä¸€ä¸ª <code>payloads</code> æ•°ç»„ï¼ˆç”±ä¸‹æ–¹ <code>.server</code> å›è°ƒè¿”å›ï¼‰ï¼Œå…¶ä¸­æ¯ä¸€é¡¹éƒ½åŒ…å« <code>key</code>ï¼ˆquery keyï¼‰å’Œ <code>result</code>ï¼ˆå¯¹åº”æ•°æ®ï¼‰ã€‚æˆ‘ä»¬éå†å¹¶å†™å› query cacheã€‚</p>
<p>æˆ‘ä»¬ç¨åä¼šä¿®å¤è¿™é‡Œç”¨ <code>// @ts-expect-error</code> é®æ‰çš„ TS é”™è¯¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// @ts-expect-error</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
  queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
}

<span class="hljs-keyword">return</span> result;
</code></pre>
<h2 data-id="heading-3">æœåŠ¡ç«¯å›è°ƒ</h2>
<p>æœåŠ¡ç«¯å›è°ƒå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
    <span class="hljs-attr">sendContext</span>: {
      <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[]
    }
  });

  <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
      <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> })
    };
  });

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
    result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
      <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>
    });
  }

  <span class="hljs-keyword">return</span> result;
});
</code></pre>
<p>æˆ‘ä»¬ä¼šç«‹åˆ»è°ƒç”¨ <code>next()</code>ï¼Œå®ƒä¼šæ‰§è¡Œè¿™ä¸ª middleware æ‰€æŒ‚è½½çš„ server functionã€‚æˆ‘ä»¬åœ¨ <code>sendContext</code> é‡Œä¼ å…¥ä¸€ä¸ª <code>payloads</code> æ•°ç»„ï¼šè¿™ä¸ªæ•°ç»„å†³å®šäº†â€œæœåŠ¡ç«¯æœ€ç»ˆä¼šå‘å›ç»™å®¢æˆ·ç«¯å›è°ƒçš„æ•°æ®ç»“æ„â€ï¼ˆä¹Ÿå°±æ˜¯ <code>.client</code> é‡Œå¾ªç¯çš„é‚£ä»½ <code>payloads</code>ï¼‰ã€‚</p>
<p>ç„¶åæˆ‘ä»¬éå†å®¢æˆ·ç«¯é€šè¿‡ <code>sendContext</code> ä¼ ä¸Šæ¥çš„ <code>revalidate</code> payloadï¼Œå¹¶ä» <code>context</code> ä¸Šè¯»å‡ºæ¥ï¼ˆæ˜¯çš„ï¼š<em>send</em> contextï¼Œå‘ä¸Šæ¥å†ä» context è¯»å‡ºæ¥ï¼‰ã€‚æ¥ç€è°ƒç”¨æ‰€æœ‰ server functionsï¼Œå¹¶æŠŠç»“æœ push åˆ° <code>payloads</code> æ•°ç»„é‡Œã€‚</p>
<p>æŠŠå‰åæ‹¼èµ·æ¥ï¼Œè¿™å°±æ˜¯å®Œæ•´ middlewareï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
    <span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
      <span class="hljs-attr">refetch</span>: [],
    };

    refetch.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key: QueryKey</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span> });
      <span class="hljs-keyword">if</span> (!entry) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">if</span> (revalidatePayload) {
        revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
          key,
          <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
          <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
        });
      }
    });

    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });

    <span class="hljs-comment">// @ts-expect-error</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
    }

    <span class="hljs-keyword">return</span> result;
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> }),
      };
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
      result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>,
      });
    }

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<h2 data-id="heading-4">ä¿®å¤ TypeScript æŠ¥é”™</h2>
<p>ä¸ºä»€ä¹ˆä¸‹é¢è¿™ä¸€è¡Œæ˜¯æ— æ•ˆçš„ï¼Ÿ</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// @ts-expect-error</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
</code></pre>
<p>è¿™æ®µä»£ç è¿è¡Œåœ¨ <code>.client</code> å›è°ƒé‡Œï¼Œå¹¶ä¸”æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨ <code>next()</code> ä¹‹åè¿è¡Œçš„ã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æ˜¯åœ¨æœåŠ¡ç«¯è¯»å–â€œå‘é€å›å®¢æˆ·ç«¯çš„æ•°æ®â€ï¼ˆé€šè¿‡ <code>sendContext</code> ä¼ å›æ¥çš„ payloadï¼‰ã€‚è¿™æ®µä»£ç åœ¨è¿è¡Œæ—¶ç¡®å®èƒ½å·¥ä½œï¼Œé‚£ä¸ºä»€ä¹ˆç±»å‹å¯¹ä¸ä¸Šï¼Ÿ</p>
<p>æˆ‘åœ¨ä¸Šé¢æåˆ°çš„ middleware æ–‡ç« é‡Œè§£é‡Šè¿‡ï¼šæœåŠ¡ç«¯å›è°ƒèƒ½â€œçœ‹è§â€å®¢æˆ·ç«¯å‘ç»™å®ƒçš„å†…å®¹ï¼Œä½†åè¿‡æ¥ä¸æˆç«‹ã€‚è¿™ç§ä¿¡æ¯å¤©ç”Ÿå°±ä¸æ˜¯åŒå‘å¯è§çš„ï¼›ç±»å‹æ¨æ–­ä¹Ÿæ²¡æ³•å€’ç€è·‘ã€‚</p>
<p>è§£å†³æ–¹å¼å¾ˆç®€å•ï¼šæŠŠ middleware æ‹†æˆä¸¤æ®µï¼Œè®©åä¸€æ®µ middleware ä¾èµ–å‰ä¸€æ®µã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> prelimRefetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-comment">// same</span>
    <span class="hljs-comment">// as</span>
    <span class="hljs-comment">// before</span>

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });

    <span class="hljs-comment">// those last few lines are removed</span>
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-comment">// exactly the same as before</span>

    <span class="hljs-keyword">return</span> result;
  });

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">middleware</span>([prelimRefetchMiddleware]) <span class="hljs-comment">// &lt;-------- connect them!</span>
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-comment">// and here's those last few lines we removed from above</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
    }

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<p>æ•´ä½“é€»è¾‘ä¸å˜ï¼Œåªæ˜¯æŠŠ <code>.client</code> å›è°ƒé‡Œ <code>next()</code> ä¹‹åé‚£éƒ¨åˆ†ç§»åˆ°äº†å•ç‹¬çš„ middleware é‡Œã€‚å…¶ä½™éƒ¨åˆ†ç•™åœ¨å¦ä¸€ä¸ª middleware ä¸­ï¼Œå¹¶ä½œä¸ºè¾“å…¥ä¼ ç»™æ–°çš„è¿™ä¸ª middlewareã€‚è¿™æ ·å½“æˆ‘ä»¬åœ¨ <code>refetchMiddleware</code> é‡Œè°ƒç”¨ <code>next</code> æ—¶ï¼ŒTypeScript å°±èƒ½çœ‹åˆ°â€œä»æœåŠ¡ç«¯å‘ä¸‹æ¥çš„ context æ•°æ®â€ï¼Œå› ä¸ºè¿™äº›æ•°æ®æ˜¯åœ¨ <code>prelimRefetchMiddleware</code> é‡Œå‘é€çš„ï¼Œè€Œå®ƒåˆæ˜¯æœ¬ middleware çš„è¾“å…¥ï¼Œå› æ­¤ TS å¯ä»¥å®Œæ•´çœ‹æ¸…ç±»å‹æµåŠ¨ã€‚</p>
<h2 data-id="heading-5">æ¥èµ·æ¥</h2>
<p>ç°åœ¨æˆ‘ä»¬å›åˆ°â€œæ›´æ–° epicâ€çš„ server functionï¼šæŠŠä¹‹å‰çš„æ‰‹åŠ¨ refetch ç§»é™¤ï¼Œæ”¹ä¸ºä½¿ç”¨ refetch middlewareã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> updateEpic = <span class="hljs-title function_">createServerFn</span>({ <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span> })
  .<span class="hljs-title function_">middleware</span>([refetchMiddleware])
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">obj: { id: <span class="hljs-built_in">number</span>; name: <span class="hljs-built_in">string</span> }</span>) =&gt;</span> obj)
  .<span class="hljs-title function_">handler</span>(<span class="hljs-keyword">async</span> ({ data }) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()));
    <span class="hljs-keyword">await</span> db.<span class="hljs-title function_">update</span>(epicsTable).<span class="hljs-title function_">set</span>({ <span class="hljs-attr">name</span>: data.<span class="hljs-property">name</span> }).<span class="hljs-title function_">where</span>(<span class="hljs-title function_">eq</span>(epicsTable.<span class="hljs-property">id</span>, data.<span class="hljs-property">id</span>));
  });
</code></pre>
<p>åœ¨ React ç»„ä»¶ä¸­é€šè¿‡ <code>useServerFn</code> æ¥è°ƒç”¨å®ƒï¼›è¿™ä¸ª hook ä¼šè‡ªåŠ¨å¤„ç†é”™è¯¯ã€é‡å®šå‘ç­‰ã€‚</p>
<p><code>const runSave = useServerFn(updateEpic);</code></p>
<p>è¿˜è®°å¾—æˆ‘è¯´è¿‡ï¼šmiddleware çš„è¾“å…¥ä¼šè‡ªåŠ¨ä¸åº•å±‚ server function çš„è¾“å…¥åˆå¹¶å—ï¼Ÿå½“æˆ‘ä»¬è°ƒç”¨è¿™ä¸ª server function æ—¶å°±èƒ½çœ‹åˆ°ï¼š</p>
<p><img alt="å›¾ 1ï¼šä¸€ä¸ª handleSaveFinal å‡½æ•°çš„ä»£ç ç‰‡æ®µï¼Œä¿å­˜è¾“å…¥å€¼å¹¶è°ƒç”¨ runSaveï¼Œå‚æ•°å¯¹è±¡åŒ…å« id å’Œ nameã€‚è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<p>ï¼ˆ<code>unknown[]</code> å¯¹ react-query çš„ query key æ¥è¯´å°±æ˜¯æ­£ç¡®ç±»å‹ï¼‰</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™æ ·è°ƒç”¨å®ƒï¼Œå¹¶æŒ‡å®šè¦ refetch çš„æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">await</span> <span class="hljs-title function_">runSave</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">id</span>: epic.<span class="hljs-property">id</span>,
    <span class="hljs-attr">name</span>: newValue,
    <span class="hljs-attr">refetch</span>: [
      [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-number">1</span>],
      [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-string">"summary"</span>],
    ],
  },
});
</code></pre>
<p>è¿è¡Œåï¼Œä¸€åˆ‡æ­£å¸¸ï¼šepics åˆ—è¡¨å’Œ summary éƒ½ä¼šåœ¨æ²¡æœ‰ä»»ä½•æ–°ç½‘ç»œè¯·æ±‚çš„æƒ…å†µä¸‹æ›´æ–°ã€‚æµ‹è¯• single flight mutations æ—¶ï¼Œä½ å…¶å®ä¸æ˜¯åœ¨æ‰¾â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œè€Œæ˜¯åœ¨æ‰¾â€œä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿâ€â€”â€”ä¹Ÿå°±æ˜¯ Network é¢æ¿é‡Œç¼ºå°‘é‚£äº›æœ¬è¯¥å‡ºç°çš„é¢å¤–è¯·æ±‚ã€‚</p>
<h2 data-id="heading-6">å†æ”¹è¿›</h2>
<p>react-query çš„ query keys æ˜¯å±‚çº§ç»“æ„çš„ï¼Œä½ å¯èƒ½å¾ˆç†Ÿæ‚‰è¿™ç§å†™æ³•ï¼š</p>
<p><code>queryClient.invalidateQueries({ queryKey: ["epics", "list"] });</code></p>
<p>å®ƒä¼š refetch ä»»ä½• key ä»¥ <code>["epics", "list"]</code> å¼€å¤´çš„ queriesã€‚æˆ‘ä»¬çš„ middleware èƒ½ä¸èƒ½ä¹Ÿæ”¯æŒè¿™ç§â€œkey å‰ç¼€â€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯åªä¼ ä¸€ä¸ª key prefixï¼Œè®©å®ƒæ‰¾å‡ºæ‰€æœ‰åŒ¹é…é¡¹å¹¶ refetchã€‚</p>
<p>å¯ä»¥ï¼Œå¼€å¹²ã€‚</p>
<p>åŒ¹é… key ä¼šç¨å¤æ‚ä¸€ç‚¹ï¼šæ¯ä¸ªä¼ å…¥çš„ key å¯èƒ½æ˜¯ prefixï¼Œä¼šåŒ¹é…å¤šæ¡ cache entryï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ <code>flatMap</code> æ¥æ‰¾å‡ºæ‰€æœ‰åŒ¹é…é¡¹ï¼Œå†åˆ©ç”¨ <code>cache.findAll</code>ï¼ˆå¾ˆå¥½ç”¨ï¼‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(
  <span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: k, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span> })
);
</code></pre>
<p>ç„¶åå¾ªç¯å¹¶åšå’Œä¹‹å‰ä¸€æ ·çš„äº‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(
  <span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: k, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span> })
);

allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<p>è¿™å°±èƒ½ç”¨äº†ã€‚</p>
<h2 data-id="heading-7">æ›´è¿›ä¸€æ­¥</h2>
<p>ä¸è¿‡æˆ‘ä»¬çš„æ–¹æ¡ˆä»ç„¶ä¸ç†æƒ³ã€‚å‡è®¾ç”¨æˆ·åœ¨ epics é¡µé¢ç¿»é¡µï¼šåˆ°ç¬¬ 2 é¡µã€åˆ°ç¬¬ 3 é¡µã€å†å›åˆ°ç¬¬ 1 é¡µã€‚æˆ‘ä»¬çš„é€»è¾‘ä¼šæ‰¾åˆ°ç¬¬ 1 é¡µå’Œ summary queryï¼Œä½†ä¹Ÿä¼šæŠŠç¬¬ 2ã€3 é¡µä¸€å¹¶æ‰¾åˆ°ï¼ˆå› ä¸ºå®ƒä»¬ç°åœ¨ä¹Ÿåœ¨ cache é‡Œï¼‰ã€‚ç„¶è€Œç¬¬ 2ã€3 é¡µå¹¶ä¸æ´»è·ƒï¼Œä¹Ÿä¸åœ¨å±å¹•ä¸Šå±•ç¤ºï¼Œæˆ‘ä»¬ä¸åº”è¯¥ refetch å®ƒä»¬ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åª refetch active queriesï¼šåªè¦ç»™ <code>findAll</code> åŠ ä¸Š <code>type</code> å‚æ•°å³å¯ã€‚</p>
<p><code>cache.findAll({ queryKey: key, exact: false, type: "active" });</code></p>
<p>äºæ˜¯ä»£ç å°±å˜æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"active"</span> }));

allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<h2 data-id="heading-8">æ›´æ›´è¿›ä¸€æ­¥</h2>
<p>è¿™æ ·å°±èƒ½å·¥ä½œäº†ã€‚ä½†ä½ ä»”ç»†æƒ³æƒ³ï¼Œé‚£äº› inactive çš„ queries å…¶å®åº”è¯¥è¢« invalidatedã€‚æˆ‘ä»¬ä¸å¸Œæœ›ç«‹åˆ» refetch å®ƒä»¬ï¼ˆæµªè´¹èµ„æºï¼Œè€Œä¸”ç”¨æˆ·æ²¡åœ¨çœ‹ï¼‰ï¼Œä½†å¦‚æœç”¨æˆ·åˆç¿»å›é‚£äº›é¡µé¢ï¼Œæˆ‘ä»¬å¸Œæœ›è§¦å‘ä¸€æ¬¡é‡æ–°è·å–ã€‚TanStack Query é€šè¿‡ <code>invalidateQueries</code> å¾ˆå®¹æ˜“åšåˆ°ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™æ®µåŠ åˆ°â€œè¢«ä¾èµ–çš„é‚£ä¸ª middlewareâ€çš„ client å›è°ƒé‡Œï¼š</p>
<pre><code class="hljs language-ts" lang="ts">data?.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
  queryClient.<span class="hljs-title function_">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"inactive"</span>, <span class="hljs-attr">refetchType</span>: <span class="hljs-string">"none"</span> });
});
</code></pre>
<p>éå†ä¼ å…¥çš„ query keysï¼ŒæŠŠæ‰€æœ‰åŒ¹é…çš„ inactive queries æ ‡è®°ä¸ºæ— æ•ˆï¼Œä½†ä¸ç«‹åˆ» refetchï¼ˆ<code>refetchType: "none"</code>ï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯æ›´æ–°åçš„å®Œæ•´ middlewareï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> prelimRefetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
    <span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
      <span class="hljs-attr">refetch</span>: [],
    };

    <span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"active"</span> }));

    allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">if</span> (revalidatePayload) {
        revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
          <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
          <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
        });
      }
    });

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> }),
      };
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
      result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>,
      });
    }

    <span class="hljs-keyword">return</span> result;
  });

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">middleware</span>([prelimRefetchMiddleware])
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ data, next }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>, { <span class="hljs-attr">updatedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() });
    }

    data?.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
      queryClient.<span class="hljs-title function_">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"inactive"</span>, <span class="hljs-attr">refetchType</span>: <span class="hljs-string">"none"</span> });
    });

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<p>æˆ‘ä»¬å‘Šè¯‰ TanStack Queryï¼šæŠŠåŒ¹é… key çš„ inactive queries ç½®ä¸º invalidï¼ˆä½†ä¸ refetchï¼‰ã€‚</p>
<p>è¿™ä¸ªæ–¹æ¡ˆéå¸¸å¥½ç”¨ï¼šå¦‚æœä½ æµè§ˆåˆ°ç¬¬ 2ã€3 é¡µï¼Œç„¶åå›åˆ°ç¬¬ 1 é¡µï¼Œå†ç¼–è¾‘ä¸€ä¸ª todoï¼Œä½ ä¼šçœ‹åˆ°ç¬¬ 1 é¡µåˆ—è¡¨å’Œ summary ç«‹åˆ»æ›´æ–°ã€‚ä¹‹åå¦‚æœä½ å†ç¿»å›ç¬¬ 2ã€3 é¡µï¼Œä½ ä¼šçœ‹åˆ°ç½‘ç»œè¯·æ±‚è§¦å‘ï¼Œä»è€Œæ‹¿åˆ°æ–°æ•°æ®ã€‚</p>
<h2 data-id="heading-9">é”¦ä¸Šæ·»èŠ±</h2>
<p>è¿˜è®°å¾—æˆ‘ä»¬æŠŠ server function å’Œå‚æ•°å¡è¿› query options æ—¶çš„å†™æ³•å—ï¼Ÿ</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, page],
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEpicsList</span>({ <span class="hljs-attr">data</span>: page });
      <span class="hljs-keyword">return</span> result;
    },
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        <span class="hljs-attr">serverFn</span>: getEpicsList,
        <span class="hljs-attr">arg</span>: page,
      },
    },
  });
};
</code></pre>
<p>æˆ‘ä¹‹å‰æè¿‡ï¼šåœ¨ <code>meta</code> å’Œ <code>queryFn</code> é‡Œé‡å¤å†™ serverFn/arg æœ‰ç‚¹â€œè„â€ã€‚æˆ‘ä»¬æ¥ä¿®ä¸€ä¸‹ã€‚</p>
<p>å…ˆä»æœ€ç®€å•çš„ helper å¼€å§‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">refetchedQueryOptions</span>(<span class="hljs-params">queryKey: QueryKey, serverFn: <span class="hljs-built_in">any</span>, arg?: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>è¿™ä¸ª helper ä¼šæ¥æ”¶ query keyã€server function å’Œå‚æ•°ï¼Œç„¶åè¿”å› query optionsï¼š</p>
<ul>
<li>æ‹¼å¥½çš„ <code>queryKey</code>ï¼ˆå¿…è¦æ—¶æŠŠ arg è¿½åŠ è¿›å»ï¼‰</li>
<li><code>queryFn</code>ï¼ˆç›´æ¥è°ƒç”¨ server functionï¼‰</li>
<li><code>meta.__revalidate</code>ï¼ˆåŒæ ·è®°å½• server function å’Œå‚æ•°ï¼‰</li>
</ul>
<p>äºæ˜¯ epics åˆ—è¡¨ query å°±å¯ä»¥å†™æˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    ...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, page),
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
  });
};
</code></pre>
<p>å®ƒèƒ½å·¥ä½œï¼Œä½†ç±»å‹ä¸å¥½ï¼šåˆ°å¤„éƒ½æ˜¯ <code>any</code>ï¼Œæ„å‘³ç€ä¼ ç»™ server function çš„å‚æ•°ä¸åšç±»å‹æ£€æŸ¥ï¼›æ›´ç³Ÿçš„æ˜¯ï¼Œ<code>queryFn</code> çš„è¿”å›å€¼ä¹Ÿä¸ä¼šè¢«æ£€æŸ¥ï¼Œäºæ˜¯ä½ çš„ queryï¼ˆæ¯”å¦‚è¿™ä¸ª epics åˆ—è¡¨ï¼‰ä¼šå˜æˆè¿”å› <code>any</code>ã€‚</p>
<p>æˆ‘ä»¬æ¥åŠ ç‚¹ç±»å‹ã€‚</p>
<p>server functions æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼šæ¥æ”¶ä¸€ä¸ªå¯¹è±¡å‚æ•°ï¼›å¦‚æœ server function å®šä¹‰äº†è¾“å…¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šåŒ…å«ä¸€ä¸ª <code>data</code> å±æ€§ï¼Œé‡Œé¢å°±æ˜¯è¾“å…¥ã€‚è¯´ä¸€å †å¤§ç™½è¯ä¸å¦‚çœ‹è°ƒç”¨ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">runSaveSimple</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">id</span>: epic.<span class="hljs-property">id</span>,
    <span class="hljs-attr">name</span>: newValue,
  },
});
</code></pre>
<p>ç¬¬äºŒç‰ˆ helper å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;T <span class="hljs-keyword">extends</span> (<span class="hljs-attr">arg</span>: { <span class="hljs-attr">data</span>: <span class="hljs-built_in">any</span> }) =&gt; <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: T,
  <span class="hljs-attr">arg</span>: <span class="hljs-title class_">Parameters</span>&lt;T&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
) {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;T&gt;&gt;&gt; =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>æˆ‘ä»¬æŠŠ server function çº¦æŸä¸ºä¸€ä¸ª async å‡½æ•°ï¼Œä¸”å®ƒçš„å‚æ•°å¯¹è±¡ä¸Šæœ‰ <code>data</code>ï¼›ç„¶åç”¨å®ƒæ¥é™æ€æ¨æ–­ <code>arg</code> çš„ç±»å‹ã€‚è¿™å·²ç»ä¸é”™äº†ï¼Œä½†å½“ä½ æŠŠå®ƒç”¨åœ¨â€œæ²¡æœ‰å‚æ•°â€çš„ server function ä¸Šæ—¶ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-string">"summary"</span>], getEpicsSummary)
<span class="hljs-comment">// Expected 3 arguments, but got 2.</span>
</code></pre>
<p>ä½ ä¼  <code>undefined</code> å¯ä»¥è§£å†³ï¼ŒåŠŸèƒ½ä¹Ÿæ­£å¸¸ï¼š</p>
<p><code>...refetchedQueryOptions(["epics", "list", "summary"], getEpicsSummary, undefined),</code></p>
<p>å¦‚æœä½ æ˜¯ä¸ªæ­£å¸¸äººï¼Œä½ å¤§æ¦‚ä¼šè§‰å¾—è¿™å·²ç»å¾ˆå¥½äº†ï¼Œè€Œä¸”ç¡®å®å¦‚æ­¤ã€‚ä½†å¦‚æœä½ åƒæˆ‘ä¸€æ ·æœ‰ç‚¹â€œæ€ªâ€ï¼Œä½ å¯èƒ½ä¼šæƒ³èƒ½ä¸èƒ½åšåˆ°æ›´å®Œç¾ï¼š</p>
<ul>
<li>å½“ server function æœ‰å‚æ•°æ—¶ï¼šå¿…é¡»ä¼ å…¥ä¸”ç±»å‹è¦æ­£ç¡®</li>
<li>å½“ server function æ²¡å‚æ•°æ—¶ï¼šå…è®¸çœç•¥ arg</li>
</ul>
<p>TypeScript æœ‰ä¸€ä¸ªç‰¹æ€§æ­£å¥½é€‚åˆï¼š<strong>å‡½æ•°é‡è½½ï¼ˆoverloaded functionsï¼‰</strong>ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å·²ç»å¤Ÿé•¿äº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥è´´ä»£ç ï¼Œè§£è¯»ç•™ä½œè¯»è€…ç»ƒä¹ ï¼ˆä»¥åŠå¯èƒ½çš„æœªæ¥æ–‡ç« ï¼‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">QueryKey</span>, queryOptions } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">AnyAsyncFn</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>] <span class="hljs-keyword">extends</span> infer <span class="hljs-title class_">TRootArgs</span>
  ? <span class="hljs-title class_">TRootArgs</span> <span class="hljs-keyword">extends</span> { <span class="hljs-attr">data</span>: infer <span class="hljs-title class_">TResult</span> }
    ? <span class="hljs-title class_">TResult</span>
    : <span class="hljs-literal">undefined</span>
  : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> infer U ? (U <span class="hljs-keyword">extends</span> <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>) : <span class="hljs-literal">false</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-literal">true</span> ? <span class="hljs-title class_">TFn</span> : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-literal">false</span> ? <span class="hljs-title class_">TFn</span> : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">RefetchQueryOptions</span>&lt;T&gt; = {
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>;
  queryFn?: <span class="hljs-function">(<span class="hljs-params">_: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T&gt;;
  meta?: <span class="hljs-built_in">any</span>;
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ValidateServerFunction</span>&lt;<span class="hljs-title class_">Provided</span>, <span class="hljs-title class_">Expected</span>&gt; = <span class="hljs-title class_">Provided</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Expected</span> ? <span class="hljs-title class_">Provided</span> : <span class="hljs-string">"This server function requires an argument!"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;,
  <span class="hljs-attr">arg</span>: <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt;;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ValidateServerFunction</span>&lt;<span class="hljs-title class_">TFn</span>, <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;,
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt;;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; | <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;,
  arg?: <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt; {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>æœ‰äº†å®ƒä¹‹åï¼Œå½“ server function éœ€è¦å‚æ•°æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    ...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, page),
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
  });
};
</code></pre>
<p>å‚æ•°ç±»å‹ä¼šè¢«æ­£ç¡®æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, <span class="hljs-string">""</span>)
<span class="hljs-comment">// Argument of type 'string' is not assignable to parameter of type 'number'.</span>
</code></pre>
<p>å¦‚æœä½ å¿˜äº†ä¼ å‚æ•°ï¼Œå®ƒä¹Ÿä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList)
<span class="hljs-comment">// Argument of type 'RequiredFetcher&lt;undefined, (page: number) =&gt; number, Promise&lt;{ id: number; name: string; }[]&gt;&gt;' is not assignable to parameter of type '"This server function requires an argument!"'.</span>
</code></pre>
<p>æœ€åè¿™ä¸ªæŠ¥é”™ä¿¡æ¯ä¸ç®—ç‰¹åˆ«ç›´è§‚ï¼Œä½†å¦‚æœä½ æŠŠä»£ç è¯»åˆ°æœ€åï¼Œä¼šå‘ç°å®ƒå·²ç»åœ¨å°½åŠ›æç¤ºä½ å“ªé‡Œé”™äº†ï¼Œé çš„å°±æ˜¯è¿™ä¸ªå°å·¥å…·ç±»å‹ï¼š</p>
<p><code>type ValidateServerFunction&lt;Provided, Expected&gt; = Provided extends Expected ? Provided : "This server function requires an argument!";</code></p>
<p>è€Œå¯¹äºâ€œæ²¡æœ‰å‚æ•°â€çš„ server functionï¼Œå®ƒä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚å®Œæ•´è§£é‡Šç•™ç»™æœªæ¥æ–‡ç« ã€‚</p>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>single flight mutations æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„ä¼˜åŒ–å·¥å…·ï¼šå½“ä½ åšä¸€æ¬¡ mutation åï¼ŒUI éœ€è¦çš„æ›´æ–°æ•°æ®ä¸å¿…å†é¢å¤–å‘è¯·æ±‚è·å–ï¼Œè€Œæ˜¯å¯ä»¥åœ¨åŒä¸€æ¬¡å¾€è¿”é‡Œé¡ºä¾¿å¸¦å›æ¥ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« æŠŠå„ä¸ªæ‹¼å›¾éƒ½è®²æ¸…æ¥šäº†ï¼šå¦‚ä½•ç”¨ middleware æ”¶é›†è¦ refetch çš„æŸ¥è¯¢ã€å¦‚ä½•å€ŸåŠ© TanStack Start çš„ server function åºåˆ—åŒ–èƒ½åŠ›æŠŠâ€œè¦æ‰§è¡Œçš„ refetchâ€å‘é€åˆ°æœåŠ¡ç«¯ã€ä»¥åŠå¦‚ä½•åœ¨å®¢æˆ·ç«¯ç”¨ <code>setQueryData</code> æŠŠæ•°æ®å†™å›ç¼“å­˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Unsafeé­”æ³•ç±»æ·±åº¦è§£æï¼šJavaåº•å±‚æ“ä½œçš„ç»ˆææŒ‡å—]]></title>    <link>https://juejin.cn/post/7603294029530513459</link>    <guid>https://juejin.cn/post/7603294029530513459</guid>    <pubDate>2026-02-06T02:06:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603294029530513459" data-draft-id="7601041482892673074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Unsafeé­”æ³•ç±»æ·±åº¦è§£æï¼šJavaåº•å±‚æ“ä½œçš„ç»ˆææŒ‡å—"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-06T02:06:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Unsafeé­”æ³•ç±»æ·±åº¦è§£æï¼šJavaåº•å±‚æ“ä½œçš„ç»ˆææŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:06:53.000Z" title="Fri Feb 06 2026 02:06:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»‹ç»</h2>
<p>Unsafeæ˜¯ä½äºsun.miscåŒ…ä¸‹çš„ä¸€ä¸ªç±»ï¼Œä¸»è¦æä¾›ä¸€äº›ç”¨äºæ‰§è¡Œä½çº§åˆ«ã€ä¸å®‰å…¨æ“ä½œçš„æ–¹æ³•ï¼Œå¦‚ç›´æ¥è®¿é—®ç³»ç»Ÿå†…å­˜èµ„æºã€è‡ªä¸»ç®¡ç†å†…å­˜èµ„æºç­‰ï¼Œè¿™äº›æ–¹æ³•åœ¨æå‡Javaè¿è¡Œæ•ˆç‡ã€å¢å¼ºJavaè¯­è¨€åº•å±‚èµ„æºæ“ä½œèƒ½åŠ›æ–¹é¢èµ·åˆ°äº†å¾ˆå¤§çš„ä½œç”¨ã€‚ä½†ç”±äºUnsafeç±»ä½¿Javaè¯­è¨€æ‹¥æœ‰äº†ç±»ä¼¼Cè¯­è¨€æŒ‡é’ˆä¸€æ ·æ“ä½œå†…å­˜ç©ºé—´çš„èƒ½åŠ›ï¼Œè¿™æ— ç–‘ä¹Ÿå¢åŠ äº†ç¨‹åºå‘ç”Ÿç›¸å…³æŒ‡é’ˆé—®é¢˜çš„é£é™©ã€‚åœ¨ç¨‹åºä¸­è¿‡åº¦ã€ä¸æ­£ç¡®ä½¿ç”¨Unsafeç±»ä¼šä½¿å¾—ç¨‹åºå‡ºé”™çš„æ¦‚ç‡å˜å¤§ï¼Œä½¿å¾—Javaè¿™ç§å®‰å…¨çš„è¯­è¨€å˜å¾—ä¸å†â€œå®‰å…¨â€ï¼Œå› æ­¤å¯¹Unsafeçš„ä½¿ç”¨ä¸€å®šè¦æ…é‡ã€‚</p>
<p>è¿™ä¸ªç±»å°½ç®¡é‡Œé¢çš„æ–¹æ³•éƒ½æ˜¯ public çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åŠæ³•ä½¿ç”¨å®ƒä»¬ï¼ŒJDK API æ–‡æ¡£ä¹Ÿæ²¡æœ‰æä¾›ä»»ä½•å…³äºè¿™ä¸ªç±»çš„æ–¹æ³•çš„è§£é‡Šã€‚æ€»è€Œè¨€ä¹‹ï¼Œå¯¹äº Unsafe ç±»çš„ä½¿ç”¨éƒ½æ˜¯å—é™åˆ¶çš„ï¼Œåªæœ‰æˆä¿¡çš„ä»£ç æ‰èƒ½è·å¾—è¯¥ç±»çš„å®ä¾‹ï¼Œå½“ç„¶ JDK åº“é‡Œé¢çš„ç±»æ˜¯å¯ä»¥éšæ„ä½¿ç”¨çš„ã€‚</p>
<p>å…ˆæ¥çœ‹ä¸‹è¿™å¼ å›¾ï¼Œå¯¹UnSafeç±»æ€»ä½“åŠŸèƒ½ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9cee00e359cd4ecc958547013f651074~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=CUCJJ6%2B6aqchapatccvKdp6i0hs%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒUnsafeæä¾›çš„APIå¤§è‡´å¯åˆ†ä¸ºå†…å­˜æ“ä½œã€CASã€Classç›¸å…³ã€å¯¹è±¡æ“ä½œã€çº¿ç¨‹è°ƒåº¦ã€ç³»ç»Ÿä¿¡æ¯è·å–ã€å†…å­˜å±éšœã€æ•°ç»„æ“ä½œç­‰å‡ ç±»ï¼Œä¸‹é¢å°†å¯¹å…¶ç›¸å…³æ–¹æ³•å’Œåº”ç”¨åœºæ™¯è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p>
<h2 data-id="heading-1">å†…å­˜æ“ä½œ</h2>
<h3 data-id="heading-2">ä»‹ç»</h3>
<p>å¦‚æœä½ æ˜¯ä¸€ä¸ªå†™è¿‡ C æˆ–è€… C++ çš„ç¨‹åºå‘˜ï¼Œä¸€å®šå¯¹å†…å­˜æ“ä½œä¸ä¼šé™Œç”Ÿï¼Œè€Œåœ¨ Java ä¸­æ˜¯ä¸å…è®¸ç›´æ¥å¯¹å†…å­˜è¿›è¡Œæ“ä½œçš„ï¼Œå¯¹è±¡å†…å­˜çš„åˆ†é…å’Œå›æ”¶éƒ½æ˜¯ç”± JVM è‡ªå·±å®ç°çš„ã€‚ä½†æ˜¯åœ¨ <code>Unsafe</code> ä¸­ï¼Œæä¾›çš„ä¸‹åˆ—æ¥å£å¯ä»¥ç›´æ¥è¿›è¡Œå†…å­˜æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//åˆ†é…æ–°çš„æœ¬åœ°ç©ºé—´</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">allocateMemory</span><span class="hljs-params">(<span class="hljs-type">long</span> bytes)</span>;
<span class="hljs-comment">//é‡æ–°è°ƒæ•´å†…å­˜ç©ºé—´çš„å¤§å°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">reallocateMemory</span><span class="hljs-params">(<span class="hljs-type">long</span> address, <span class="hljs-type">long</span> bytes)</span>;
<span class="hljs-comment">//å°†å†…å­˜è®¾ç½®ä¸ºæŒ‡å®šå€¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMemory</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">long</span> bytes, <span class="hljs-type">byte</span> value)</span>;
<span class="hljs-comment">//å†…å­˜æ‹·è´</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyMemory</span><span class="hljs-params">(Object srcBase, <span class="hljs-type">long</span> srcOffset,Object destBase, <span class="hljs-type">long</span> destOffset,<span class="hljs-type">long</span> bytes)</span>;
<span class="hljs-comment">//æ¸…é™¤å†…å­˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">freeMemory</span><span class="hljs-params">(<span class="hljs-type">long</span> address)</span>;
</code></pre>
<p>ä½¿ç”¨ä¸‹é¢çš„ä»£ç è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">memoryTest</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;
    <span class="hljs-type">long</span> <span class="hljs-variable">addr</span> <span class="hljs-operator">=</span> unsafe.allocateMemory(size);
    <span class="hljs-type">long</span> <span class="hljs-variable">addr3</span> <span class="hljs-operator">=</span> unsafe.reallocateMemory(addr, size * <span class="hljs-number">2</span>);
    System.out.println(<span class="hljs-string">"addr: "</span>+addr);
    System.out.println(<span class="hljs-string">"addr3: "</span>+addr3);
    <span class="hljs-keyword">try</span> {
        unsafe.setMemory(<span class="hljs-literal">null</span>,addr ,size,(<span class="hljs-type">byte</span>)<span class="hljs-number">1</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) {
            unsafe.copyMemory(<span class="hljs-literal">null</span>,addr,<span class="hljs-literal">null</span>,addr3+size*i,<span class="hljs-number">4</span>);
        }
        System.out.println(unsafe.getInt(addr));
        System.out.println(unsafe.getLong(addr3));
    }<span class="hljs-keyword">finally</span> {
        unsafe.freeMemory(addr);
        unsafe.freeMemory(addr3);
    }
}
</code></pre>
<p>å…ˆçœ‹ç»“æœè¾“å‡ºï¼š</p>
<pre><code class="hljs language-plain" lang="plain">addr: 2433733895744
addr3: 2433733894944
16843009
72340172838076673
</code></pre>
<p>åˆ†æä¸€ä¸‹è¿è¡Œç»“æœï¼Œé¦–å…ˆä½¿ç”¨<code>allocateMemory</code>æ–¹æ³•ç”³è¯· 4 å­—èŠ‚é•¿åº¦çš„å†…å­˜ç©ºé—´ï¼Œè°ƒç”¨<code>setMemory</code>æ–¹æ³•å‘æ¯ä¸ªå­—èŠ‚å†™å…¥å†…å®¹ä¸º<code>byte</code>ç±»å‹çš„ 1ï¼Œå½“ä½¿ç”¨ Unsafe è°ƒç”¨<code>getInt</code>æ–¹æ³•æ—¶ï¼Œå› ä¸ºä¸€ä¸ª<code>int</code>å‹å˜é‡å  4 ä¸ªå­—èŠ‚ï¼Œä¼šä¸€æ¬¡æ€§è¯»å– 4 ä¸ªå­—èŠ‚ï¼Œç»„æˆä¸€ä¸ª<code>int</code>çš„å€¼ï¼Œå¯¹åº”çš„åè¿›åˆ¶ç»“æœä¸º 16843009ã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡ä¸‹å›¾ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99123c0d1a3540feb3ecd4c7fb4396f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=KMNKxTyLsmajwDAIs13iqDzKvZw%3D" alt="" loading="lazy"/></p>
<p>åœ¨ä»£ç ä¸­è°ƒç”¨<code>reallocateMemory</code>æ–¹æ³•é‡æ–°åˆ†é…äº†ä¸€å— 8 å­—èŠ‚é•¿åº¦çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡æ¯”è¾ƒ<code>addr</code>å’Œ<code>addr3</code>å¯ä»¥çœ‹åˆ°å’Œä¹‹å‰ç”³è¯·çš„å†…å­˜åœ°å€æ˜¯ä¸åŒçš„ã€‚åœ¨ä»£ç ä¸­çš„ç¬¬äºŒä¸ª for å¾ªç¯é‡Œï¼Œè°ƒç”¨<code>copyMemory</code>æ–¹æ³•è¿›è¡Œäº†ä¸¤æ¬¡å†…å­˜çš„æ‹·è´ï¼Œæ¯æ¬¡æ‹·è´å†…å­˜åœ°å€<code>addr</code>å¼€å§‹çš„ 4 ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«æ‹·è´åˆ°ä»¥<code>addr3</code>å’Œ<code>addr3+4</code>å¼€å§‹çš„å†…å­˜ç©ºé—´ä¸Šï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fe6cb86b50d4fa39249f8474c62c8db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=sfAWi42cCCc%2BCJVx2JmNLgstKTI%3D" alt="" loading="lazy"/></p>
<p>æ‹·è´å®Œæˆåï¼Œä½¿ç”¨<code>getLong</code>æ–¹æ³•ä¸€æ¬¡æ€§è¯»å– 8 ä¸ªå­—èŠ‚ï¼Œå¾—åˆ°<code>long</code>ç±»å‹çš„å€¼ä¸º 72340172838076673ã€‚</p>
<p>éœ€è¦æ³¨æ„ï¼Œé€šè¿‡è¿™ç§æ–¹å¼åˆ†é…çš„å†…å­˜å±äº å †å¤–å†…å­˜ ï¼Œæ˜¯æ— æ³•è¿›è¡Œåƒåœ¾å›æ”¶çš„ï¼Œéœ€è¦æˆ‘ä»¬æŠŠè¿™äº›å†…å­˜å½“åšä¸€ç§èµ„æºå»æ‰‹åŠ¨è°ƒç”¨<code>freeMemory</code>æ–¹æ³•è¿›è¡Œé‡Šæ”¾ï¼Œå¦åˆ™ä¼šäº§ç”Ÿå†…å­˜æ³„æ¼ã€‚é€šç”¨çš„æ“ä½œå†…å­˜æ–¹å¼æ˜¯åœ¨<code>try</code>ä¸­æ‰§è¡Œå¯¹å†…å­˜çš„æ“ä½œï¼Œæœ€ç»ˆåœ¨<code>finally</code>å—ä¸­è¿›è¡Œå†…å­˜çš„é‡Šæ”¾ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å †å¤–å†…å­˜ï¼Ÿ</strong></p>
<ul>
<li>å¯¹åƒåœ¾å›æ”¶åœé¡¿çš„æ”¹å–„ã€‚ç”±äºå †å¤–å†…å­˜æ˜¯ç›´æ¥å—æ“ä½œç³»ç»Ÿç®¡ç†è€Œä¸æ˜¯ JVMï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨å †å¤–å†…å­˜æ—¶ï¼Œå³å¯ä¿æŒè¾ƒå°çš„å †å†…å†…å­˜è§„æ¨¡ã€‚ä»è€Œåœ¨ GC æ—¶å‡å°‘å›æ”¶åœé¡¿å¯¹äºåº”ç”¨çš„å½±å“ã€‚</li>
<li>æå‡ç¨‹åº I/O æ“ä½œçš„æ€§èƒ½ã€‚é€šå¸¸åœ¨ I/O é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä¼šå­˜åœ¨å †å†…å†…å­˜åˆ°å †å¤–å†…å­˜çš„æ•°æ®æ‹·è´æ“ä½œï¼Œå¯¹äºéœ€è¦é¢‘ç¹è¿›è¡Œå†…å­˜é—´æ•°æ®æ‹·è´ä¸”ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„æš‚å­˜æ•°æ®ï¼Œéƒ½å»ºè®®å­˜å‚¨åˆ°å †å¤–å†…å­˜ã€‚</li>
</ul>
<h3 data-id="heading-3">å…¸å‹åº”ç”¨</h3>
<p><code>DirectByteBuffer</code> æ˜¯ Java ç”¨äºå®ç°å †å¤–å†…å­˜çš„ä¸€ä¸ªé‡è¦ç±»ï¼Œé€šå¸¸ç”¨åœ¨é€šä¿¡è¿‡ç¨‹ä¸­åšç¼“å†²æ± ï¼Œå¦‚åœ¨ Nettyã€MINA ç­‰ NIO æ¡†æ¶ä¸­åº”ç”¨å¹¿æ³›ã€‚<code>DirectByteBuffer</code> å¯¹äºå †å¤–å†…å­˜çš„åˆ›å»ºã€ä½¿ç”¨ã€é”€æ¯ç­‰é€»è¾‘å‡ç”± Unsafe æä¾›çš„å †å¤–å†…å­˜ API æ¥å®ç°ã€‚</p>
<p>ä¸‹å›¾ä¸º <code>DirectByteBuffer</code> æ„é€ å‡½æ•°ï¼Œåˆ›å»º <code>DirectByteBuffer</code> çš„æ—¶å€™ï¼Œé€šè¿‡ <code>Unsafe.allocateMemory</code> åˆ†é…å†…å­˜ã€<code>Unsafe.setMemory</code> è¿›è¡Œå†…å­˜åˆå§‹åŒ–ï¼Œè€Œåæ„å»º <code>Cleaner</code> å¯¹è±¡ç”¨äºè·Ÿè¸ª <code>DirectByteBuffer</code> å¯¹è±¡çš„åƒåœ¾å›æ”¶ï¼Œä»¥å®ç°å½“ <code>DirectByteBuffer</code> è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œåˆ†é…çš„å †å¤–å†…å­˜ä¸€èµ·è¢«é‡Šæ”¾ã€‚</p>
<pre><code class="hljs language-java" lang="java">DirectByteBuffer(<span class="hljs-type">int</span> cap) {                   <span class="hljs-comment">// package-private</span>

    <span class="hljs-built_in">super</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, cap, cap);
    <span class="hljs-type">boolean</span> <span class="hljs-variable">pa</span> <span class="hljs-operator">=</span> VM.isDirectMemoryPageAligned();
    <span class="hljs-type">int</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> Bits.pageSize();
    <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> Math.max(<span class="hljs-number">1L</span>, (<span class="hljs-type">long</span>)cap + (pa ? ps : <span class="hljs-number">0</span>));
    Bits.reserveMemory(size, cap);

    <span class="hljs-type">long</span> <span class="hljs-variable">base</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åˆ†é…å†…å­˜å¹¶è¿”å›åŸºåœ°å€</span>
        base = unsafe.allocateMemory(size);
    } <span class="hljs-keyword">catch</span> (OutOfMemoryError x) {
        Bits.unreserveMemory(size, cap);
        <span class="hljs-keyword">throw</span> x;
    }
    <span class="hljs-comment">// å†…å­˜åˆå§‹åŒ–</span>
    unsafe.setMemory(base, size, (<span class="hljs-type">byte</span>) <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (pa &amp;&amp; (base % ps != <span class="hljs-number">0</span>)) {
        <span class="hljs-comment">// Round up to page boundary</span>
        address = base + ps - (base &amp; (ps - <span class="hljs-number">1</span>));
    } <span class="hljs-keyword">else</span> {
        address = base;
    }
    <span class="hljs-comment">// è·Ÿè¸ª DirectByteBuffer å¯¹è±¡çš„åƒåœ¾å›æ”¶ï¼Œä»¥å®ç°å †å¤–å†…å­˜é‡Šæ”¾</span>
    cleaner = Cleaner.create(<span class="hljs-built_in">this</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Deallocator</span>(base, size, cap));
    att = <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 data-id="heading-4">å†…å­˜å±éšœ</h2>
<h3 data-id="heading-5">ä»‹ç»</h3>
<p>åœ¨ä»‹ç»å†…å­˜å±éšœå‰ï¼Œéœ€è¦çŸ¥é“ç¼–è¯‘å™¨å’Œ CPU ä¼šåœ¨ä¿è¯ç¨‹åºè¾“å‡ºç»“æœä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¹ä»£ç è¿›è¡Œé‡æ’åºï¼Œä»æŒ‡ä»¤ä¼˜åŒ–è§’åº¦æå‡æ€§èƒ½ã€‚è€ŒæŒ‡ä»¤é‡æ’åºå¯èƒ½ä¼šå¸¦æ¥ä¸€ä¸ªä¸å¥½çš„ç»“æœï¼Œå¯¼è‡´ CPU çš„é«˜é€Ÿç¼“å­˜å’Œå†…å­˜ä¸­æ•°æ®çš„ä¸ä¸€è‡´ï¼Œè€Œå†…å­˜å±éšœï¼ˆ<code>Memory Barrier</code>ï¼‰å°±æ˜¯é€šè¿‡é˜»æ­¢å±éšœä¸¤è¾¹çš„æŒ‡ä»¤é‡æ’åºä»è€Œé¿å…ç¼–è¯‘å™¨å’Œç¡¬ä»¶çš„ä¸æ­£ç¡®ä¼˜åŒ–æƒ…å†µã€‚</p>
<p>åœ¨ç¡¬ä»¶å±‚é¢ä¸Šï¼Œå†…å­˜å±éšœæ˜¯ CPU ä¸ºäº†é˜²æ­¢ä»£ç è¿›è¡Œé‡æ’åºè€Œæä¾›çš„æŒ‡ä»¤ï¼Œä¸åŒçš„ç¡¬ä»¶å¹³å°ä¸Šå®ç°å†…å­˜å±éšœçš„æ–¹æ³•å¯èƒ½å¹¶ä¸ç›¸åŒã€‚åœ¨ Java8 ä¸­ï¼Œå¼•å…¥äº† 3 ä¸ªå†…å­˜å±éšœçš„å‡½æ•°ï¼Œå®ƒå±è”½äº†æ“ä½œç³»ç»Ÿåº•å±‚çš„å·®å¼‚ï¼Œå…è®¸åœ¨ä»£ç ä¸­å®šä¹‰ã€å¹¶ç»Ÿä¸€ç”± JVM æ¥ç”Ÿæˆå†…å­˜å±éšœæŒ‡ä»¤ï¼Œæ¥å®ç°å†…å­˜å±éšœçš„åŠŸèƒ½ã€‚</p>
<p><code>Unsafe</code> ä¸­æä¾›äº†ä¸‹é¢ä¸‰ä¸ªå†…å­˜å±éšœç›¸å…³æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//å†…å­˜å±éšœï¼Œç¦æ­¢loadæ“ä½œé‡æ’åºã€‚å±éšœå‰çš„loadæ“ä½œä¸èƒ½è¢«é‡æ’åºåˆ°å±éšœåï¼Œå±éšœåçš„loadæ“ä½œä¸èƒ½è¢«é‡æ’åºåˆ°å±éšœå‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadFence</span><span class="hljs-params">()</span>;
<span class="hljs-comment">//å†…å­˜å±éšœï¼Œç¦æ­¢storeæ“ä½œé‡æ’åºã€‚å±éšœå‰çš„storeæ“ä½œä¸èƒ½è¢«é‡æ’åºåˆ°å±éšœåï¼Œå±éšœåçš„storeæ“ä½œä¸èƒ½è¢«é‡æ’åºåˆ°å±éšœå‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">storeFence</span><span class="hljs-params">()</span>;
<span class="hljs-comment">//å†…å­˜å±éšœï¼Œç¦æ­¢loadã€storeæ“ä½œé‡æ’åº</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fullFence</span><span class="hljs-params">()</span>;
</code></pre>
<p>å†…å­˜å±éšœå¯ä»¥çœ‹åšå¯¹å†…å­˜éšæœºè®¿é—®çš„æ“ä½œä¸­çš„ä¸€ä¸ªåŒæ­¥ç‚¹ï¼Œä½¿å¾—æ­¤ç‚¹ä¹‹å‰çš„æ‰€æœ‰è¯»å†™æ“ä½œéƒ½æ‰§è¡Œåæ‰å¯ä»¥å¼€å§‹æ‰§è¡Œæ­¤ç‚¹ä¹‹åçš„æ“ä½œã€‚ä»¥<code>loadFence</code>æ–¹æ³•ä¸ºä¾‹ï¼Œå®ƒä¼šç¦æ­¢è¯»æ“ä½œé‡æ’åºï¼Œä¿è¯åœ¨è¿™ä¸ªå±éšœä¹‹å‰çš„æ‰€æœ‰è¯»æ“ä½œéƒ½å·²ç»å®Œæˆï¼Œå¹¶ä¸”å°†ç¼“å­˜æ•°æ®è®¾ä¸ºæ— æ•ˆï¼Œé‡æ–°ä»ä¸»å­˜ä¸­è¿›è¡ŒåŠ è½½ã€‚</p>
<p>çœ‹åˆ°è¿™ä¼°è®¡å¾ˆå¤šå°ä¼™ä¼´ä»¬ä¼šæƒ³åˆ°<code>volatile</code>å…³é”®å­—äº†ï¼Œå¦‚æœåœ¨å­—æ®µä¸Šæ·»åŠ äº†<code>volatile</code>å…³é”®å­—ï¼Œå°±èƒ½å¤Ÿå®ç°å­—æ®µåœ¨å¤šçº¿ç¨‹ä¸‹çš„å¯è§æ€§ã€‚åŸºäºè¯»å†…å­˜å±éšœï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚ä¸‹é¢å®šä¹‰ä¸€ä¸ªçº¿ç¨‹æ–¹æ³•ï¼Œåœ¨çº¿ç¨‹ä¸­å»ä¿®æ”¹<code>flag</code>æ ‡å¿—ä½ï¼Œæ³¨æ„è¿™é‡Œçš„<code>flag</code>æ˜¯æ²¡æœ‰è¢«<code>volatile</code>ä¿®é¥°çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChangeThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span>{
    <span class="hljs-comment">/**volatile**/</span> <span class="hljs-type">boolean</span> flag=<span class="hljs-literal">false</span>;
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">3000</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(<span class="hljs-string">"subThread change flag to:"</span> + flag);
        flag = <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>åœ¨ä¸»çº¿ç¨‹çš„<code>while</code>å¾ªç¯ä¸­ï¼ŒåŠ å…¥å†…å­˜å±éšœï¼Œæµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ„ŸçŸ¥åˆ°<code>flag</code>çš„ä¿®æ”¹å˜åŒ–ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>{
    <span class="hljs-type">ChangeThread</span> <span class="hljs-variable">changeThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChangeThread</span>();
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(changeThread).start();
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> changeThread.isFlag();
        unsafe.loadFence(); <span class="hljs-comment">//åŠ å…¥è¯»å†…å­˜å±éšœ</span>
        <span class="hljs-keyword">if</span> (flag){
            System.out.println(<span class="hljs-string">"detected flag changed"</span>);
            <span class="hljs-keyword">break</span>;
        }
    }
    System.out.println(<span class="hljs-string">"main thread end"</span>);
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-plain" lang="plain">subThread change flag to:false
detected flag changed
main thread end
</code></pre>
<p>è€Œå¦‚æœåˆ æ‰ä¸Šé¢ä»£ç ä¸­çš„<code>loadFence</code>æ–¹æ³•ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹å°†æ— æ³•æ„ŸçŸ¥åˆ°<code>flag</code>å‘ç”Ÿçš„å˜åŒ–ï¼Œä¼šä¸€ç›´åœ¨<code>while</code>ä¸­å¾ªç¯ã€‚å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤ºä¸Šé¢çš„è¿‡ç¨‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9f567533c774ffca91e4bbeaf503984~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=0%2FVkFQDatyVPP2QiTs2haGVcKkk%3D" alt="" loading="lazy"/></p>
<p>äº†è§£ Java å†…å­˜æ¨¡å‹ï¼ˆ<code>JMM</code>ï¼‰çš„å°ä¼™ä¼´ä»¬åº”è¯¥æ¸…æ¥šï¼Œè¿è¡Œä¸­çš„çº¿ç¨‹ä¸æ˜¯ç›´æ¥è¯»å–ä¸»å†…å­˜ä¸­çš„å˜é‡çš„ï¼Œåªèƒ½æ“ä½œè‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œç„¶ååŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ï¼Œå¹¶ä¸”çº¿ç¨‹çš„å·¥ä½œå†…å­˜æ˜¯ä¸èƒ½å…±äº«çš„ã€‚ä¸Šé¢çš„å›¾ä¸­çš„æµç¨‹å°±æ˜¯å­çº¿ç¨‹å€ŸåŠ©äºä¸»å†…å­˜ï¼Œå°†ä¿®æ”¹åçš„ç»“æœåŒæ­¥ç»™äº†ä¸»çº¿ç¨‹ï¼Œè¿›è€Œä¿®æ”¹ä¸»çº¿ç¨‹ä¸­çš„å·¥ä½œç©ºé—´ï¼Œè·³å‡ºå¾ªç¯ã€‚</p>
<h3 data-id="heading-6">å…¸å‹åº”ç”¨</h3>
<p>åœ¨ Java 8 ä¸­å¼•å…¥äº†ä¸€ç§é”çš„æ–°æœºåˆ¶â€”â€”<code>StampedLock</code>ï¼Œå®ƒå¯ä»¥çœ‹æˆæ˜¯è¯»å†™é”çš„ä¸€ä¸ªæ”¹è¿›ç‰ˆæœ¬ã€‚<code>StampedLock</code> æä¾›äº†ä¸€ç§ä¹è§‚è¯»é”çš„å®ç°ï¼Œè¿™ç§ä¹è§‚è¯»é”ç±»ä¼¼äºæ— é”çš„æ“ä½œï¼Œå®Œå…¨ä¸ä¼šé˜»å¡å†™çº¿ç¨‹è·å–å†™é”ï¼Œä»è€Œç¼“è§£è¯»å¤šå†™å°‘æ—¶å†™çº¿ç¨‹â€œé¥¥é¥¿â€ç°è±¡ã€‚ç”±äº <code>StampedLock</code> æä¾›çš„ä¹è§‚è¯»é”ä¸é˜»å¡å†™çº¿ç¨‹è·å–è¯»é”ï¼Œå½“çº¿ç¨‹å…±äº«å˜é‡ä»ä¸»å†…å­˜ load åˆ°çº¿ç¨‹å·¥ä½œå†…å­˜æ—¶ï¼Œä¼šå­˜åœ¨æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<code>StampedLock</code> çš„ <code>validate</code> æ–¹æ³•ä¼šé€šè¿‡ <code>Unsafe</code> çš„ <code>loadFence</code> æ–¹æ³•åŠ å…¥ä¸€ä¸ª <code>load</code> å†…å­˜å±éšœã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(<span class="hljs-type">long</span> stamp)</span> {
   U.loadFence();
   <span class="hljs-keyword">return</span> (stamp &amp; SBITS) == (state &amp; SBITS);
}
</code></pre>
<h2 data-id="heading-7">å¯¹è±¡æ“ä½œ</h2>
<h3 data-id="heading-8">ä»‹ç»</h3>
<p><strong>ä¾‹å­</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> sun.misc.Unsafe;
<span class="hljs-keyword">import</span> java.lang.reflect.Field;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> value;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception{
        <span class="hljs-type">Unsafe</span> <span class="hljs-variable">unsafe</span> <span class="hljs-operator">=</span> reflectGetUnsafe();
        <span class="hljs-keyword">assert</span> unsafe != <span class="hljs-literal">null</span>;
        <span class="hljs-type">long</span> <span class="hljs-variable">offset</span> <span class="hljs-operator">=</span> unsafe.objectFieldOffset(Main.class.getDeclaredField(<span class="hljs-string">"value"</span>));
        <span class="hljs-type">Main</span> <span class="hljs-variable">main</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Main</span>();
        System.out.println(<span class="hljs-string">"value before putInt: "</span> + main.value);
        unsafe.putInt(main, offset, <span class="hljs-number">42</span>);
        System.out.println(<span class="hljs-string">"value after putInt: "</span> + main.value);
  System.out.println(<span class="hljs-string">"value after putInt: "</span> + unsafe.getInt(main, offset));
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Unsafe <span class="hljs-title function_">reflectGetUnsafe</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> Unsafe.class.getDeclaredField(<span class="hljs-string">"theUnsafe"</span>);
            field.setAccessible(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">return</span> (Unsafe) field.get(<span class="hljs-literal">null</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }

}
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-plain" lang="plain">value before putInt: 0
value after putInt: 42
value after putInt: 42
</code></pre>
<p><strong>å¯¹è±¡å±æ€§</strong></p>
<p>å¯¹è±¡æˆå‘˜å±æ€§çš„å†…å­˜åç§»é‡è·å–ï¼Œä»¥åŠå­—æ®µå±æ€§å€¼çš„ä¿®æ”¹ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡äº†ã€‚é™¤äº†å‰é¢çš„<code>putInt</code>ã€<code>getInt</code>æ–¹æ³•å¤–ï¼ŒUnsafe æä¾›äº†å…¨éƒ¨ 8 ç§åŸºç¡€æ•°æ®ç±»å‹ä»¥åŠ<code>Object</code>çš„<code>put</code>å’Œ<code>get</code>æ–¹æ³•ï¼Œå¹¶ä¸”æ‰€æœ‰çš„<code>put</code>æ–¹æ³•éƒ½å¯ä»¥è¶Šè¿‡è®¿é—®æƒé™ï¼Œç›´æ¥ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ã€‚é˜…è¯» openJDK æºç ä¸­çš„æ³¨é‡Šå‘ç°ï¼ŒåŸºç¡€æ•°æ®ç±»å‹å’Œ<code>Object</code>çš„è¯»å†™ç¨æœ‰ä¸åŒï¼ŒåŸºç¡€æ•°æ®ç±»å‹æ˜¯ç›´æ¥æ“ä½œçš„å±æ€§å€¼ï¼ˆ<code>value</code>ï¼‰ï¼Œè€Œ<code>Object</code>çš„æ“ä½œåˆ™æ˜¯åŸºäºå¼•ç”¨å€¼ï¼ˆ<code>reference value</code>ï¼‰ã€‚ä¸‹é¢æ˜¯<code>Object</code>çš„è¯»å†™æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//åœ¨å¯¹è±¡çš„æŒ‡å®šåç§»åœ°å€è·å–ä¸€ä¸ªå¯¹è±¡å¼•ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Object <span class="hljs-title function_">getObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset)</span>;
<span class="hljs-comment">//åœ¨å¯¹è±¡æŒ‡å®šåç§»åœ°å€å†™å…¥ä¸€ä¸ªå¯¹è±¡å¼•ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, Object x)</span>;
</code></pre>
<p>é™¤äº†å¯¹è±¡å±æ€§çš„æ™®é€šè¯»å†™å¤–ï¼Œ<code>Unsafe</code> è¿˜æä¾›äº† <strong>volatile è¯»å†™</strong>å’Œ<strong>æœ‰åºå†™å…¥</strong>æ–¹æ³•ã€‚<code>volatile</code>è¯»å†™æ–¹æ³•çš„è¦†ç›–èŒƒå›´ä¸æ™®é€šè¯»å†™ç›¸åŒï¼ŒåŒ…å«äº†å…¨éƒ¨åŸºç¡€æ•°æ®ç±»å‹å’Œ<code>Object</code>ç±»å‹ï¼Œä»¥<code>int</code>ç±»å‹ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//åœ¨å¯¹è±¡çš„æŒ‡å®šåç§»åœ°å€å¤„è¯»å–ä¸€ä¸ªintå€¼ï¼Œæ”¯æŒvolatile loadè¯­ä¹‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getIntVolatile</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset)</span>;
<span class="hljs-comment">//åœ¨å¯¹è±¡æŒ‡å®šåç§»åœ°å€å¤„å†™å…¥ä¸€ä¸ªintï¼Œæ”¯æŒvolatile storeè¯­ä¹‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putIntVolatile</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> x)</span>;
</code></pre>
<p>ç›¸å¯¹äºæ™®é€šè¯»å†™æ¥è¯´ï¼Œ<code>volatile</code>è¯»å†™å…·æœ‰æ›´é«˜çš„æˆæœ¬ï¼Œå› ä¸ºå®ƒéœ€è¦ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚åœ¨æ‰§è¡Œ<code>get</code>æ“ä½œæ—¶ï¼Œä¼šå¼ºåˆ¶ä»ä¸»å­˜ä¸­è·å–å±æ€§å€¼ï¼Œåœ¨ä½¿ç”¨<code>put</code>æ–¹æ³•è®¾ç½®å±æ€§å€¼æ—¶ï¼Œä¼šå¼ºåˆ¶å°†å€¼æ›´æ–°åˆ°ä¸»å­˜ä¸­ï¼Œä»è€Œä¿è¯è¿™äº›å˜æ›´å¯¹å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚</p>
<p>æœ‰åºå†™å…¥çš„æ–¹æ³•æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putOrderedObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, Object x)</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putOrderedInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> x)</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putOrderedLong</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">long</span> x)</span>;
</code></pre>
<p>æœ‰åºå†™å…¥çš„æˆæœ¬ç›¸å¯¹<code>volatile</code>è¾ƒä½ï¼Œå› ä¸ºå®ƒåªä¿è¯å†™å…¥æ—¶çš„æœ‰åºæ€§ï¼Œè€Œä¸ä¿è¯å¯è§æ€§ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å†™å…¥çš„å€¼ä¸èƒ½ä¿è¯å…¶ä»–çº¿ç¨‹ç«‹å³å¯è§ã€‚ä¸ºäº†è§£å†³è¿™é‡Œçš„å·®å¼‚æ€§ï¼Œéœ€è¦å¯¹å†…å­˜å±éšœçš„çŸ¥è¯†ç‚¹å†è¿›ä¸€æ­¥è¿›è¡Œè¡¥å……ï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸¤ä¸ªæŒ‡ä»¤çš„æ¦‚å¿µï¼š</p>
<ul>
<li><code>Load</code>ï¼šå°†ä¸»å†…å­˜ä¸­çš„æ•°æ®æ‹·è´åˆ°å¤„ç†å™¨çš„ç¼“å­˜ä¸­</li>
<li><code>Store</code>ï¼šå°†å¤„ç†å™¨ç¼“å­˜çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­</li>
</ul>
<p>é¡ºåºå†™å…¥ä¸<code>volatile</code>å†™å…¥çš„å·®åˆ«åœ¨äºï¼Œåœ¨é¡ºåºå†™æ—¶åŠ å…¥çš„å†…å­˜å±éšœç±»å‹ä¸º<code>StoreStore</code>ç±»å‹ï¼Œè€Œåœ¨<code>volatile</code>å†™å…¥æ—¶åŠ å…¥çš„å†…å­˜å±éšœæ˜¯<code>StoreLoad</code>ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6adc4016aef40afa8de186c1fbdbec7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=qUgHzzLUffIQHu0YrQ8cEI8EG%2FU%3D" alt="" loading="lazy"/></p>
<p>åœ¨æœ‰åºå†™å…¥æ–¹æ³•ä¸­ï¼Œä½¿ç”¨çš„æ˜¯<code>StoreStore</code>å±éšœï¼Œè¯¥å±éšœç¡®ä¿<code>Store1</code>ç«‹åˆ»åˆ·æ–°æ•°æ®åˆ°å†…å­˜ï¼Œè¿™ä¸€æ“ä½œå…ˆäº<code>Store2</code>ä»¥åŠåç»­çš„å­˜å‚¨æŒ‡ä»¤æ“ä½œã€‚è€Œåœ¨<code>volatile</code>å†™å…¥ä¸­ï¼Œä½¿ç”¨çš„æ˜¯<code>StoreLoad</code>å±éšœï¼Œè¯¥å±éšœç¡®ä¿<code>Store1</code>ç«‹åˆ»åˆ·æ–°æ•°æ®åˆ°å†…å­˜ï¼Œè¿™ä¸€æ“ä½œå…ˆäº<code>Load2</code>åŠåç»­çš„è£…è½½æŒ‡ä»¤ï¼Œå¹¶ä¸”ï¼Œ<code>StoreLoad</code>å±éšœä¼šä½¿è¯¥å±éšœä¹‹å‰çš„æ‰€æœ‰å†…å­˜è®¿é—®æŒ‡ä»¤ï¼ŒåŒ…æ‹¬å­˜å‚¨æŒ‡ä»¤å’Œè®¿é—®æŒ‡ä»¤å…¨éƒ¨å®Œæˆä¹‹åï¼Œæ‰æ‰§è¡Œè¯¥å±éšœä¹‹åçš„å†…å­˜è®¿é—®æŒ‡ä»¤ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨ä¸Šé¢çš„ä¸‰ç±»å†™å…¥æ–¹æ³•ä¸­ï¼Œåœ¨å†™å…¥æ•ˆç‡æ–¹é¢ï¼ŒæŒ‰ç…§<code>put</code>ã€<code>putOrder</code>ã€<code>putVolatile</code>çš„é¡ºåºæ•ˆç‡é€æ¸é™ä½ã€‚</p>
<p><strong>å¯¹è±¡å®ä¾‹åŒ–</strong></p>
<p>ä½¿ç”¨ <code>Unsafe</code> çš„ <code>allocateInstance</code> æ–¹æ³•ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨éå¸¸è§„çš„æ–¹å¼è¿›è¡Œå¯¹è±¡çš„å®ä¾‹åŒ–ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªå®ä½“ç±»ï¼Œå¹¶ä¸”åœ¨æ„é€ å‡½æ•°ä¸­å¯¹å…¶æˆå‘˜å˜é‡è¿›è¡Œèµ‹å€¼æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> b;
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">A</span><span class="hljs-params">()</span>{
        <span class="hljs-built_in">this</span>.b =<span class="hljs-number">1</span>;
    }
}
</code></pre>
<p>åˆ†åˆ«åŸºäºæ„é€ å‡½æ•°ã€åå°„ä»¥åŠ <code>Unsafe</code> æ–¹æ³•çš„ä¸åŒæ–¹å¼åˆ›å»ºå¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">objTest</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception{
    A a1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">A</span>();
    System.out.println(a1.getB());
    <span class="hljs-type">A</span> <span class="hljs-variable">a2</span> <span class="hljs-operator">=</span> A.class.newInstance();
    System.out.println(a2.getB());
    A a3= (A) unsafe.allocateInstance(A.class);
    System.out.println(a3.getB());
}
</code></pre>
<p>æ‰“å°ç»“æœåˆ†åˆ«ä¸º 1ã€1ã€0ï¼Œè¯´æ˜é€šè¿‡<code>allocateInstance</code>æ–¹æ³•åˆ›å»ºå¯¹è±¡è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåªç”¨åˆ°äº†<code>Class</code>å¯¹è±¡ï¼Œæ‰€ä»¥è¯´å¦‚æœæƒ³è¦è·³è¿‡å¯¹è±¡çš„åˆå§‹åŒ–é˜¶æ®µæˆ–è€…è·³è¿‡æ„é€ å™¨çš„å®‰å…¨æ£€æŸ¥ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœå°† A ç±»çš„æ„é€ å‡½æ•°æ”¹ä¸º<code>private</code>ç±»å‹ï¼Œå°†æ— æ³•é€šè¿‡æ„é€ å‡½æ•°å’Œåå°„åˆ›å»ºå¯¹è±¡ï¼ˆå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°å¯¹è±¡ setAccessible ååˆ›å»ºå¯¹è±¡ï¼‰ï¼Œä½†<code>allocateInstance</code>æ–¹æ³•ä»ç„¶æœ‰æ•ˆã€‚</p>
<h3 data-id="heading-9">å…¸å‹åº”ç”¨</h3>
<ul>
<li><strong>å¸¸è§„å¯¹è±¡å®ä¾‹åŒ–æ–¹å¼</strong>ï¼šæˆ‘ä»¬é€šå¸¸æ‰€ç”¨åˆ°çš„åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼Œä»æœ¬è´¨ä¸Šæ¥è®²ï¼Œéƒ½æ˜¯é€šè¿‡ new æœºåˆ¶æ¥å®ç°å¯¹è±¡çš„åˆ›å»ºã€‚ä½†æ˜¯ï¼Œnew æœºåˆ¶æœ‰ä¸ªç‰¹ç‚¹å°±æ˜¯å½“ç±»åªæä¾›æœ‰å‚çš„æ„é€ å‡½æ•°ä¸”æ— æ˜¾ç¤ºå£°æ˜æ— å‚æ„é€ å‡½æ•°æ—¶ï¼Œåˆ™å¿…é¡»ä½¿ç”¨æœ‰å‚æ„é€ å‡½æ•°è¿›è¡Œå¯¹è±¡æ„é€ ï¼Œè€Œä½¿ç”¨æœ‰å‚æ„é€ å‡½æ•°æ—¶ï¼Œå¿…é¡»ä¼ é€’ç›¸åº”ä¸ªæ•°çš„å‚æ•°æ‰èƒ½å®Œæˆå¯¹è±¡å®ä¾‹åŒ–ã€‚</li>
<li><strong>éå¸¸è§„çš„å®ä¾‹åŒ–æ–¹å¼</strong>ï¼šè€Œ Unsafe ä¸­æä¾› allocateInstance æ–¹æ³•ï¼Œä»…é€šè¿‡ Class å¯¹è±¡å°±å¯ä»¥åˆ›å»ºæ­¤ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè€Œä¸”ä¸éœ€è¦è°ƒç”¨å…¶æ„é€ å‡½æ•°ã€åˆå§‹åŒ–ä»£ç ã€JVM å®‰å…¨æ£€æŸ¥ç­‰ã€‚å®ƒæŠ‘åˆ¶ä¿®é¥°ç¬¦æ£€æµ‹ï¼Œä¹Ÿå°±æ˜¯å³ä½¿æ„é€ å™¨æ˜¯ private ä¿®é¥°çš„ä¹Ÿèƒ½é€šè¿‡æ­¤æ–¹æ³•å®ä¾‹åŒ–ï¼Œåªéœ€æç±»å¯¹è±¡å³å¯åˆ›å»ºç›¸åº”çš„å¯¹è±¡ã€‚ç”±äºè¿™ç§ç‰¹æ€§ï¼ŒallocateInstance åœ¨ java.lang.invokeã€Objenesisï¼ˆæä¾›ç»•è¿‡ç±»æ„é€ å™¨çš„å¯¹è±¡ç”Ÿæˆæ–¹å¼ï¼‰ã€Gsonï¼ˆååºåˆ—åŒ–æ—¶ç”¨åˆ°ï¼‰ä¸­éƒ½æœ‰ç›¸åº”çš„åº”ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-10">æ•°ç»„æ“ä½œ</h2>
<h3 data-id="heading-11">ä»‹ç»</h3>
<p><code>arrayBaseOffset</code> ä¸ <code>arrayIndexScale</code> è¿™ä¸¤ä¸ªæ–¹æ³•é…åˆèµ·æ¥ä½¿ç”¨ï¼Œå³å¯å®šä½æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//è¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åç§»åœ°å€</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">arrayBaseOffset</span><span class="hljs-params">(Class&lt;?&gt; arrayClass)</span>;
<span class="hljs-comment">//è¿”å›æ•°ç»„ä¸­ä¸€ä¸ªå…ƒç´ å ç”¨çš„å¤§å°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">arrayIndexScale</span><span class="hljs-params">(Class&lt;?&gt; arrayClass)</span>;
</code></pre>
<h3 data-id="heading-12">å…¸å‹åº”ç”¨</h3>
<p>è¿™ä¸¤ä¸ªä¸æ•°æ®æ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œåœ¨ <code>java.util.concurrent.atomic</code> åŒ…ä¸‹çš„ <code>AtomicIntegerArray</code>ï¼ˆå¯ä»¥å®ç°å¯¹ <code>Integer</code> æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„åŸå­æ€§æ“ä½œï¼‰ä¸­æœ‰å…¸å‹çš„åº”ç”¨ï¼Œå¦‚ä¸‹å›¾ <code>AtomicIntegerArray</code> æºç æ‰€ç¤ºï¼Œé€šè¿‡ <code>Unsafe</code> çš„ <code>arrayBaseOffset</code>ã€<code>arrayIndexScale</code> åˆ†åˆ«è·å–æ•°ç»„é¦–å…ƒç´ çš„åç§»åœ°å€ <code>base</code> åŠå•ä¸ªå…ƒç´ å¤§å°å› å­ <code>scale</code> ã€‚åç»­ç›¸å…³åŸå­æ€§æ“ä½œï¼Œå‡ä¾èµ–äºè¿™ä¸¤ä¸ªå€¼è¿›è¡Œæ•°ç»„ä¸­å…ƒç´ çš„å®šä½ï¼Œå¦‚ä¸‹å›¾äºŒæ‰€ç¤ºçš„ <code>getAndAdd</code> æ–¹æ³•å³é€šè¿‡ <code>checkedByteOffset</code> æ–¹æ³•è·å–æŸæ•°ç»„å…ƒç´ çš„åç§»åœ°å€ï¼Œè€Œåé€šè¿‡ CAS å®ç°åŸå­æ€§æ“ä½œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1793457faec4704ac0f30032e0edacb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=QjfluAo49eogA9vIgxU2x81X7D0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13">CAS æ“ä½œ</h2>
<h3 data-id="heading-14">ä»‹ç»</h3>
<p>è¿™éƒ¨åˆ†ä¸»è¦ä¸º CAS ç›¸å…³æ“ä½œçš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
  *  CAS
  * <span class="hljs-doctag">@param</span> o         åŒ…å«è¦ä¿®æ”¹fieldçš„å¯¹è±¡
  * <span class="hljs-doctag">@param</span> offset    å¯¹è±¡ä¸­æŸfieldçš„åç§»é‡
  * <span class="hljs-doctag">@param</span> expected  æœŸæœ›å€¼
  * <span class="hljs-doctag">@param</span> update    æ›´æ–°å€¼
  * <span class="hljs-doctag">@return</span>          true | false
  */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,  Object expected, Object update)</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> expected,<span class="hljs-type">int</span> update)</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapLong</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">long</span> expected, <span class="hljs-type">long</span> update)</span>;
</code></pre>
<p><strong>ä»€ä¹ˆæ˜¯ CAS?</strong> CAS å³æ¯”è¾ƒå¹¶æ›¿æ¢ï¼ˆCompare And Swap)ï¼Œæ˜¯å®ç°å¹¶å‘ç®—æ³•æ—¶å¸¸ç”¨åˆ°çš„ä¸€ç§æŠ€æœ¯ã€‚CAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜ä½ç½®ã€é¢„æœŸåŸå€¼åŠæ–°å€¼ã€‚æ‰§è¡Œ CAS æ“ä½œçš„æ—¶å€™ï¼Œå°†å†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼æ¯”è¾ƒï¼Œå¦‚æœç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®å€¼æ›´æ–°ä¸ºæ–°å€¼ï¼Œå¦åˆ™ï¼Œå¤„ç†å™¨ä¸åšä»»ä½•æ“ä½œã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒCAS æ˜¯ä¸€æ¡ CPU çš„åŸå­æŒ‡ä»¤ï¼ˆcmpxchg æŒ‡ä»¤ï¼‰ï¼Œä¸ä¼šé€ æˆæ‰€è°“çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œ<code>Unsafe</code> æä¾›çš„ CAS æ–¹æ³•ï¼ˆå¦‚ <code>compareAndSwapXXX</code>ï¼‰åº•å±‚å®ç°å³ä¸º CPU æŒ‡ä»¤ <code>cmpxchg</code> ã€‚</p>
<h3 data-id="heading-15">å…¸å‹åº”ç”¨</h3>
<p>åœ¨ JUC åŒ…çš„å¹¶å‘å·¥å…·ç±»ä¸­å¤§é‡åœ°ä½¿ç”¨äº† CAS æ“ä½œï¼Œåƒåœ¨å‰é¢ä»‹ç»<code>synchronized</code>å’Œ<code>AQS</code>çš„æ–‡ç« ä¸­ä¹Ÿå¤šæ¬¡æåˆ°äº† CASï¼Œå…¶ä½œä¸ºä¹è§‚é”åœ¨å¹¶å‘å·¥å…·ç±»ä¸­å¹¿æ³›å‘æŒ¥äº†ä½œç”¨ã€‚åœ¨ <code>Unsafe</code> ç±»ä¸­ï¼Œæä¾›äº†<code>compareAndSwapObject</code>ã€<code>compareAndSwapInt</code>ã€<code>compareAndSwapLong</code>æ–¹æ³•æ¥å®ç°çš„å¯¹<code>Object</code>ã€<code>int</code>ã€<code>long</code>ç±»å‹çš„ CAS æ“ä½œã€‚ä»¥<code>compareAndSwapInt</code>æ–¹æ³•ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset,<span class="hljs-type">int</span> expected,<span class="hljs-type">int</span> x)</span>;
</code></pre>
<p>å‚æ•°ä¸­<code>o</code>ä¸ºéœ€è¦æ›´æ–°çš„å¯¹è±¡ï¼Œ<code>offset</code>æ˜¯å¯¹è±¡<code>o</code>ä¸­æ•´å½¢å­—æ®µçš„åç§»é‡ï¼Œå¦‚æœè¿™ä¸ªå­—æ®µçš„å€¼ä¸<code>expected</code>ç›¸åŒï¼Œåˆ™å°†å­—æ®µçš„å€¼è®¾ä¸º<code>x</code>è¿™ä¸ªæ–°å€¼ï¼Œå¹¶ä¸”æ­¤æ›´æ–°æ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨<code>compareAndSwapInt</code>çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> a;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>{
    CasTest casTest=<span class="hljs-keyword">new</span> <span class="hljs-title class_">CasTest</span>();
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(()-&gt;{
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            casTest.increment(i);
            System.out.print(casTest.a+<span class="hljs-string">" "</span>);
        }
    }).start();
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(()-&gt;{
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span> ; i &lt;<span class="hljs-number">10</span> ; i++) {
            casTest.increment(i);
            System.out.print(casTest.a+<span class="hljs-string">" "</span>);
        }
    }).start();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>{
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>){
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">long</span> <span class="hljs-variable">fieldOffset</span> <span class="hljs-operator">=</span> unsafe.objectFieldOffset(CasTest.class.getDeclaredField(<span class="hljs-string">"a"</span>));
            <span class="hljs-keyword">if</span> (unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>,fieldOffset,x-<span class="hljs-number">1</span>,x))
                <span class="hljs-keyword">break</span>;
        } <span class="hljs-keyword">catch</span> (NoSuchFieldException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>è¿è¡Œä»£ç ä¼šä¾æ¬¡è¾“å‡ºï¼š</p>
<pre><code class="hljs language-plain" lang="plain">1 2 3 4 5 6 7 8 9
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹å»ä¿®æ”¹<code>int</code>å‹å±æ€§<code>a</code>çš„å€¼ï¼Œå¹¶ä¸”åªæœ‰åœ¨<code>a</code>çš„å€¼ç­‰äºä¼ å…¥çš„å‚æ•°<code>x</code>å‡ä¸€æ—¶ï¼Œæ‰ä¼šå°†<code>a</code>çš„å€¼å˜ä¸º<code>x</code>ï¼Œä¹Ÿå°±æ˜¯å®ç°å¯¹<code>a</code>çš„åŠ ä¸€çš„æ“ä½œã€‚æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4f40466bf77462bacf0931f567aa953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=4%2FozbBEguTcSirvDqde3tJgIYFQ%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è°ƒç”¨<code>compareAndSwapInt</code>æ–¹æ³•åï¼Œä¼šç›´æ¥è¿”å›<code>true</code>æˆ–<code>false</code>çš„ä¿®æ”¹ç»“æœï¼Œå› æ­¤éœ€è¦æˆ‘ä»¬åœ¨ä»£ç ä¸­æ‰‹åŠ¨æ·»åŠ è‡ªæ—‹çš„é€»è¾‘ã€‚åœ¨<code>AtomicInteger</code>ç±»çš„è®¾è®¡ä¸­ï¼Œä¹Ÿæ˜¯é‡‡ç”¨äº†å°†<code>compareAndSwapInt</code>çš„ç»“æœä½œä¸ºå¾ªç¯æ¡ä»¶ï¼Œç›´è‡³ä¿®æ”¹æˆåŠŸæ‰é€€å‡ºæ­»å¾ªç¯çš„æ–¹å¼æ¥å®ç°çš„åŸå­æ€§çš„è‡ªå¢æ“ä½œã€‚</p>
<h2 data-id="heading-16">çº¿ç¨‹è°ƒåº¦</h2>
<h3 data-id="heading-17">ä»‹ç»</h3>
<p><code>Unsafe</code> ç±»ä¸­æä¾›äº†<code>park</code>ã€<code>unpark</code>ã€<code>monitorEnter</code>ã€<code>monitorExit</code>ã€<code>tryMonitorEnter</code>æ–¹æ³•è¿›è¡Œçº¿ç¨‹è°ƒåº¦ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//å–æ¶ˆé˜»å¡çº¿ç¨‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unpark</span><span class="hljs-params">(Object thread)</span>;
<span class="hljs-comment">//é˜»å¡çº¿ç¨‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">park</span><span class="hljs-params">(<span class="hljs-type">boolean</span> isAbsolute, <span class="hljs-type">long</span> time)</span>;
<span class="hljs-comment">//è·å¾—å¯¹è±¡é”ï¼ˆå¯é‡å…¥é”ï¼‰</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorEnter</span><span class="hljs-params">(Object o)</span>;
<span class="hljs-comment">//é‡Šæ”¾å¯¹è±¡é”</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorExit</span><span class="hljs-params">(Object o)</span>;
<span class="hljs-comment">//å°è¯•è·å–å¯¹è±¡é”</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryMonitorEnter</span><span class="hljs-params">(Object o)</span>;
</code></pre>
<p>æ–¹æ³• <code>park</code>ã€<code>unpark</code> å³å¯å®ç°çº¿ç¨‹çš„æŒ‚èµ·ä¸æ¢å¤ï¼Œå°†ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒæŒ‚èµ·æ˜¯é€šè¿‡ <code>park</code> æ–¹æ³•å®ç°çš„ï¼Œè°ƒç”¨ <code>park</code> æ–¹æ³•åï¼Œçº¿ç¨‹å°†ä¸€ç›´é˜»å¡ç›´åˆ°è¶…æ—¶æˆ–è€…ä¸­æ–­ç­‰æ¡ä»¶å‡ºç°ï¼›<code>unpark</code> å¯ä»¥ç»ˆæ­¢ä¸€ä¸ªæŒ‚èµ·çš„çº¿ç¨‹ï¼Œä½¿å…¶æ¢å¤æ­£å¸¸ã€‚</p>
<p>æ­¤å¤–ï¼Œ<code>Unsafe</code> æºç ä¸­<code>monitor</code>ç›¸å…³çš„ä¸‰ä¸ªæ–¹æ³•å·²ç»è¢«æ ‡è®°ä¸º<code>deprecated</code>ï¼Œä¸å»ºè®®è¢«ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//è·å¾—å¯¹è±¡é”</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorEnter</span><span class="hljs-params">(Object var1)</span>;
<span class="hljs-comment">//é‡Šæ”¾å¯¹è±¡é”</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorExit</span><span class="hljs-params">(Object var1)</span>;
<span class="hljs-comment">//å°è¯•è·å¾—å¯¹è±¡é”</span>
<span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryMonitorEnter</span><span class="hljs-params">(Object var1)</span>;
</code></pre>
<p><code>monitorEnter</code>æ–¹æ³•ç”¨äºè·å¾—å¯¹è±¡é”ï¼Œ<code>monitorExit</code>ç”¨äºé‡Šæ”¾å¯¹è±¡é”ï¼Œå¦‚æœå¯¹ä¸€ä¸ªæ²¡æœ‰è¢«<code>monitorEnter</code>åŠ é”çš„å¯¹è±¡æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡º<code>IllegalMonitorStateException</code>å¼‚å¸¸ã€‚<code>tryMonitorEnter</code>æ–¹æ³•å°è¯•è·å–å¯¹è±¡é”ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›<code>true</code>ï¼Œåä¹‹è¿”å›<code>false</code>ã€‚</p>
<h3 data-id="heading-18">å…¸å‹åº”ç”¨</h3>
<p>Java é”å’ŒåŒæ­¥å™¨æ¡†æ¶çš„æ ¸å¿ƒç±» <code>AbstractQueuedSynchronizer</code> (AQS)ï¼Œå°±æ˜¯é€šè¿‡è°ƒç”¨<code>LockSupport.park()</code>å’Œ<code>LockSupport.unpark()</code>å®ç°çº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’çš„ï¼Œè€Œ <code>LockSupport</code> çš„ <code>park</code>ã€<code>unpark</code> æ–¹æ³•å®é™…æ˜¯è°ƒç”¨ <code>Unsafe</code> çš„ <code>park</code>ã€<code>unpark</code> æ–¹å¼å®ç°çš„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">park</span><span class="hljs-params">(Object blocker)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
    setBlocker(t, blocker);
    UNSAFE.park(<span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);
    setBlocker(t, <span class="hljs-literal">null</span>);
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unpark</span><span class="hljs-params">(Thread thread)</span> {
    <span class="hljs-keyword">if</span> (thread != <span class="hljs-literal">null</span>)
        UNSAFE.unpark(thread);
}
</code></pre>
<p><code>LockSupport</code> çš„<code>park</code>æ–¹æ³•è°ƒç”¨äº† <code>Unsafe</code> çš„<code>park</code>æ–¹æ³•æ¥é˜»å¡å½“å‰çº¿ç¨‹ï¼Œæ­¤æ–¹æ³•å°†çº¿ç¨‹é˜»å¡åå°±ä¸ä¼šç»§ç»­å¾€åæ‰§è¡Œï¼Œç›´åˆ°æœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨<code>unpark</code>æ–¹æ³•å”¤é†’å½“å‰çº¿ç¨‹ã€‚ä¸‹é¢çš„ä¾‹å­å¯¹ <code>Unsafe</code> çš„è¿™ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">mainThread</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(()-&gt;{
        <span class="hljs-keyword">try</span> {
            TimeUnit.SECONDS.sleep(<span class="hljs-number">5</span>);
            System.out.println(<span class="hljs-string">"subThread try to unpark mainThread"</span>);
            unsafe.unpark(mainThread);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }).start();

    System.out.println(<span class="hljs-string">"park main mainThread"</span>);
    unsafe.park(<span class="hljs-literal">false</span>,<span class="hljs-number">0L</span>);
    System.out.println(<span class="hljs-string">"unpark mainThread success"</span>);
}
</code></pre>
<p>ç¨‹åºè¾“å‡ºä¸ºï¼š</p>
<pre><code class="hljs language-plain" lang="plain">park main mainThread
subThread try to unpark mainThread
unpark mainThread success
</code></pre>
<p>ç¨‹åºè¿è¡Œçš„æµç¨‹ä¹Ÿæ¯”è¾ƒå®¹æ˜“çœ‹æ‡‚ï¼Œå­çº¿ç¨‹å¼€å§‹è¿è¡Œåå…ˆè¿›è¡Œç¡çœ ï¼Œç¡®ä¿ä¸»çº¿ç¨‹èƒ½å¤Ÿè°ƒç”¨<code>park</code>æ–¹æ³•é˜»å¡è‡ªå·±ï¼Œå­çº¿ç¨‹åœ¨ç¡çœ  5 ç§’åï¼Œè°ƒç”¨<code>unpark</code>æ–¹æ³•å”¤é†’ä¸»çº¿ç¨‹ï¼Œä½¿ä¸»çº¿ç¨‹èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚æ•´ä¸ªæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91f46b98971e4d75a0a2e6e7c8add968~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=YTi8X%2BilPj4bWVOzz8rktqVvNbA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-19">Class æ“ä½œ</h2>
<h3 data-id="heading-20">ä»‹ç»</h3>
<p><code>Unsafe</code> å¯¹<code>Class</code>çš„ç›¸å…³æ“ä½œä¸»è¦åŒ…æ‹¬ç±»åŠ è½½å’Œé™æ€å˜é‡çš„æ“ä½œæ–¹æ³•ã€‚</p>
<p><strong>é™æ€å±æ€§è¯»å–ç›¸å…³çš„æ–¹æ³•</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//è·å–é™æ€å±æ€§çš„åç§»é‡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">staticFieldOffset</span><span class="hljs-params">(Field f)</span>;
<span class="hljs-comment">//è·å–é™æ€å±æ€§çš„å¯¹è±¡æŒ‡é’ˆ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Object <span class="hljs-title function_">staticFieldBase</span><span class="hljs-params">(Field f)</span>;
<span class="hljs-comment">//åˆ¤æ–­ç±»æ˜¯å¦éœ€è¦åˆå§‹åŒ–ï¼ˆç”¨äºè·å–ç±»çš„é™æ€å±æ€§å‰è¿›è¡Œæ£€æµ‹ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldBeInitialized</span><span class="hljs-params">(Class&lt;?&gt; c)</span>;
</code></pre>
<p>åˆ›å»ºä¸€ä¸ªåŒ…å«é™æ€å±æ€§çš„ç±»ï¼Œè¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String name=<span class="hljs-string">"Hydra"</span>;
    <span class="hljs-type">int</span> age;
}
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticTest</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
    User user=<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
    <span class="hljs-comment">// ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥è§¦å‘ç±»åˆå§‹åŒ–</span>
    <span class="hljs-comment">// 1.</span>
    <span class="hljs-comment">// unsafe.ensureClassInitialized(User.class);</span>
    <span class="hljs-comment">// 2.</span>
    <span class="hljs-comment">// System.out.println(User.name);</span>
    System.out.println(unsafe.shouldBeInitialized(User.class));
    <span class="hljs-type">Field</span> <span class="hljs-variable">sexField</span> <span class="hljs-operator">=</span> User.class.getDeclaredField(<span class="hljs-string">"name"</span>);
    <span class="hljs-type">long</span> <span class="hljs-variable">fieldOffset</span> <span class="hljs-operator">=</span> unsafe.staticFieldOffset(sexField);
    <span class="hljs-type">Object</span> <span class="hljs-variable">fieldBase</span> <span class="hljs-operator">=</span> unsafe.staticFieldBase(sexField);
    <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> unsafe.getObject(fieldBase, fieldOffset);
    System.out.println(object);
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-plain" lang="plain">false
Hydra
</code></pre>
<p>åœ¨ <code>Unsafe</code> çš„å¯¹è±¡æ“ä½œä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†é€šè¿‡<code>objectFieldOffset</code>æ–¹æ³•è·å–å¯¹è±¡å±æ€§åç§»é‡å¹¶åŸºäºå®ƒå¯¹å˜é‡çš„å€¼è¿›è¡Œå­˜å–ï¼Œä½†æ˜¯å®ƒä¸é€‚ç”¨äºç±»ä¸­çš„é™æ€å±æ€§ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨<code>staticFieldOffset</code>æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåªæœ‰åœ¨è·å–<code>Field</code>å¯¹è±¡çš„è¿‡ç¨‹ä¸­ä¾èµ–åˆ°äº†<code>Class</code>ï¼Œè€Œè·å–é™æ€å˜é‡çš„å±æ€§æ—¶ä¸å†ä¾èµ–äº<code>Class</code>ã€‚</p>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­é¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>User</code>å¯¹è±¡ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœä¸€ä¸ªç±»æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œé‚£ä¹ˆå®ƒçš„é™æ€å±æ€§ä¹Ÿä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œæœ€åè·å–çš„å­—æ®µå±æ€§å°†æ˜¯<code>null</code>ã€‚æ‰€ä»¥åœ¨è·å–é™æ€å±æ€§å‰ï¼Œéœ€è¦è°ƒç”¨<code>shouldBeInitialized</code>æ–¹æ³•ï¼Œåˆ¤æ–­åœ¨è·å–å‰æ˜¯å¦éœ€è¦åˆå§‹åŒ–è¿™ä¸ªç±»ã€‚å¦‚æœåˆ é™¤åˆ›å»º User å¯¹è±¡çš„è¯­å¥ï¼Œè¿è¡Œç»“æœä¼šå˜ä¸ºï¼š</p>
<pre><code class="hljs language-plain" lang="plain">true
null
</code></pre>
<p><strong>ä½¿ç”¨<code>defineClass</code>æ–¹æ³•å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªç±»</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Class&lt;?&gt; defineClass(String name, <span class="hljs-type">byte</span>[] b, <span class="hljs-type">int</span> off, <span class="hljs-type">int</span> len, ClassLoader loader,ProtectionDomain protectionDomain);
</code></pre>
<p>åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥åªä¼ å…¥å­—èŠ‚æ•°ç»„ã€èµ·å§‹å­—èŠ‚çš„ä¸‹æ ‡ä»¥åŠè¯»å–çš„å­—èŠ‚é•¿åº¦ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç±»åŠ è½½å™¨ï¼ˆ<code>ClassLoader</code>ï¼‰å’Œä¿æŠ¤åŸŸï¼ˆ<code>ProtectionDomain</code>ï¼‰æ¥æºäºè°ƒç”¨æ­¤æ–¹æ³•çš„å®ä¾‹ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­å®ç°äº†åç¼–è¯‘ç”Ÿæˆåçš„ class æ–‡ä»¶çš„åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">defineTest</span><span class="hljs-params">()</span> {
    String fileName=<span class="hljs-string">"F:\\workspace\\unsafe-test\\target\\classes\\com\\cn\\model\\User.class"</span>;
    <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(fileName);
    <span class="hljs-keyword">try</span>(<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(file)) {
        <span class="hljs-type">byte</span>[] content=<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[(<span class="hljs-type">int</span>)file.length()];
        fis.read(content);
        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> unsafe.defineClass(<span class="hljs-literal">null</span>, content, <span class="hljs-number">0</span>, content.length, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> clazz.newInstance();
        <span class="hljs-type">Object</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">"getAge"</span>).invoke(o, <span class="hljs-literal">null</span>);
        System.out.println(age);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        e.printStackTrace();
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé¦–å…ˆè¯»å–äº†ä¸€ä¸ª<code>class</code>æ–‡ä»¶å¹¶é€šè¿‡æ–‡ä»¶æµå°†å®ƒè½¬åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä¹‹åä½¿ç”¨<code>defineClass</code>æ–¹æ³•åŠ¨æ€çš„åˆ›å»ºäº†ä¸€ä¸ªç±»ï¼Œå¹¶åœ¨åç»­å®Œæˆäº†å®ƒçš„å®ä¾‹åŒ–å·¥ä½œï¼Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¹¶ä¸”é€šè¿‡è¿™ç§æ–¹å¼åˆ›å»ºçš„ç±»ï¼Œä¼šè·³è¿‡ JVM çš„æ‰€æœ‰å®‰å…¨æ£€æŸ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2c62babdd304e11b387c33588de88a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948412&amp;x-signature=yDhBZaI7a4jDlS3Ly3W5O%2BUXFWM%3D" alt="" loading="lazy"/></p>
<p>é™¤äº†<code>defineClass</code>æ–¹æ³•å¤–ï¼ŒUnsafe è¿˜æä¾›äº†ä¸€ä¸ª<code>defineAnonymousClass</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> Class&lt;?&gt; defineAnonymousClass(Class&lt;?&gt; hostClass, <span class="hljs-type">byte</span>[] data, Object[] cpPatches);
</code></pre>
<p>ä½¿ç”¨è¯¥æ–¹æ³•å¯ä»¥ç”¨æ¥åŠ¨æ€çš„åˆ›å»ºä¸€ä¸ªåŒ¿åç±»ï¼Œåœ¨<code>Lambda</code>è¡¨è¾¾å¼ä¸­å°±æ˜¯ä½¿ç”¨ ASM åŠ¨æ€ç”Ÿæˆå­—èŠ‚ç ï¼Œç„¶ååˆ©ç”¨è¯¥æ–¹æ³•å®šä¹‰å®ç°ç›¸åº”çš„å‡½æ•°å¼æ¥å£çš„åŒ¿åç±»ã€‚åœ¨ JDK 15 å‘å¸ƒçš„æ–°ç‰¹æ€§ä¸­ï¼Œåœ¨éšè—ç±»ï¼ˆ<code>Hidden classes</code>ï¼‰ä¸€æ¡ä¸­ï¼ŒæŒ‡å‡ºå°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¼ƒç”¨ <code>Unsafe</code> çš„<code>defineAnonymousClass</code>æ–¹æ³•ã€‚</p>
<h3 data-id="heading-21">å…¸å‹åº”ç”¨</h3>
<p>Lambda è¡¨è¾¾å¼å®ç°éœ€è¦ä¾èµ– <code>Unsafe</code> çš„ <code>defineAnonymousClass</code> æ–¹æ³•å®šä¹‰å®ç°ç›¸åº”çš„å‡½æ•°å¼æ¥å£çš„åŒ¿åç±»ã€‚</p>
<h2 data-id="heading-22">ç³»ç»Ÿä¿¡æ¯</h2>
<h3 data-id="heading-23">ä»‹ç»</h3>
<p>è¿™éƒ¨åˆ†åŒ…å«ä¸¤ä¸ªè·å–ç³»ç»Ÿç›¸å…³ä¿¡æ¯çš„æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//è¿”å›ç³»ç»ŸæŒ‡é’ˆçš„å¤§å°ã€‚è¿”å›å€¼ä¸º4ï¼ˆ32ä½ç³»ç»Ÿï¼‰æˆ– 8ï¼ˆ64ä½ç³»ç»Ÿï¼‰ã€‚</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addressSize</span><span class="hljs-params">()</span>;
<span class="hljs-comment">//å†…å­˜é¡µçš„å¤§å°ï¼Œæ­¤å€¼ä¸º2çš„å¹‚æ¬¡æ–¹ã€‚</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">pageSize</span><span class="hljs-params">()</span>;
</code></pre>
<h3 data-id="heading-24">å…¸å‹åº”ç”¨</h3>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•çš„åº”ç”¨åœºæ™¯æ¯”è¾ƒå°‘ï¼Œåœ¨<code>java.nio.Bits</code>ç±»ä¸­ï¼Œåœ¨ä½¿ç”¨<code>pageCount</code>è®¡ç®—æ‰€éœ€çš„å†…å­˜é¡µçš„æ•°é‡æ—¶ï¼Œè°ƒç”¨äº†<code>pageSize</code>æ–¹æ³•è·å–å†…å­˜é¡µçš„å¤§å°ã€‚å¦å¤–ï¼Œåœ¨ä½¿ç”¨<code>copySwapMemory</code>æ–¹æ³•æ‹·è´å†…å­˜æ—¶ï¼Œè°ƒç”¨äº†<code>addressSize</code>æ–¹æ³•ï¼Œæ£€æµ‹ 32 ä½ç³»ç»Ÿçš„æƒ…å†µã€‚</p>
<h2 data-id="heading-25">Unsafeåº•å±‚</h2>
<p>å†çœ‹çœ‹Unsafeçš„compareAndSwap æ–¹æ³•æ¥å®ç°CASæ“ä½œï¼Œå®ƒæ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œå®ç°ä½äºunsafe.cppä¸­ã€‚</p>
<pre><code class="hljs language-java" lang="java">UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))
  UnsafeWrapper(<span class="hljs-string">"Unsafe_CompareAndSwapInt"</span>);
  <span class="hljs-type">oop</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> JNIHandles::resolve(obj);
  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);
  <span class="hljs-keyword">return</span> (jint)(Atomic::cmpxchg(x, addr, e)) == e;
UNSAFE_END
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å®ƒé€šè¿‡ Atomic::cmpxchg æ¥å®ç°æ¯”è¾ƒå’Œæ›¿æ¢æ“ä½œã€‚å…¶ä¸­å‚æ•°xæ˜¯å³å°†æ›´æ–°çš„å€¼ï¼Œå‚æ•°eæ˜¯åŸå†…å­˜çš„å€¼ã€‚</p>
<p>å¦‚æœæ˜¯Linuxçš„x86ï¼ŒAtomic::cmpxchgæ–¹æ³•çš„å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">inline jint Atomic::cmpxchg (jint exchange_value, <span class="hljs-keyword">volatile</span> jint* dest, jint compare_value) {
  <span class="hljs-type">int</span> <span class="hljs-variable">mp</span> <span class="hljs-operator">=</span> os::is_MP();
  __asm__ <span class="hljs-title function_">volatile</span> <span class="hljs-params">(LOCK_IF_MP(%<span class="hljs-number">4</span>)</span> <span class="hljs-string">"cmpxchgl %1,(%3)"</span>
                    : <span class="hljs-string">"=a"</span> (exchange_value)
                    : <span class="hljs-string">"r"</span> (exchange_value), <span class="hljs-string">"a"</span> (compare_value), <span class="hljs-string">"r"</span> (dest), <span class="hljs-string">"r"</span> (mp)
                    : <span class="hljs-string">"cc"</span>, <span class="hljs-string">"memory"</span>);
  <span class="hljs-keyword">return</span> exchange_value;
}
</code></pre>
<p>è€Œwindowsçš„x86çš„å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">inline jint Atomic::cmpxchg (jint exchange_value, <span class="hljs-keyword">volatile</span> jint* dest, jint compare_value) {
    <span class="hljs-type">int</span> <span class="hljs-variable">mp</span> <span class="hljs-operator">=</span> os::isMP(); <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æ˜¯å¤šå¤„ç†å™¨</span>
    _asm {
        mov edx, dest
        mov ecx, exchange_value
        mov eax, compare_value
        <span class="hljs-title function_">LOCK_IF_MP</span><span class="hljs-params">(mp)</span>
        cmpxchg dword ptr [edx], ecx
    }
}

<span class="hljs-comment">// Adding a lock prefix to an instruction on MP machine</span>
<span class="hljs-comment">// VC++ doesn't like the lock prefix to be on a single line</span>
<span class="hljs-comment">// so we can't insert a label after the lock prefix.</span>
<span class="hljs-comment">// By emitting a lock prefix, we can define a label after it.</span>
#define <span class="hljs-title function_">LOCK_IF_MP</span><span class="hljs-params">(mp)</span> __asm cmp mp, <span class="hljs-number">0</span>  \
                       __asm je L0      \
                       __asm _emit <span class="hljs-number">0xF0</span> \
                       __asm L0:
</code></pre>
<p>å¦‚æœæ˜¯å¤šå¤„ç†å™¨ï¼Œä¸ºcmpxchgæŒ‡ä»¤æ·»åŠ lockå‰ç¼€ã€‚åä¹‹ï¼Œå°±çœç•¥lockå‰ç¼€(å•å¤„ç†å™¨ä¼šä¸éœ€è¦lockå‰ç¼€æä¾›çš„å†…å­˜å±éšœæ•ˆæœ)ã€‚è¿™é‡Œçš„lockå‰ç¼€å°±æ˜¯ä½¿ç”¨äº†å¤„ç†å™¨çš„æ€»çº¿é”(æœ€æ–°çš„å¤„ç†å™¨éƒ½ä½¿ç”¨ç¼“å­˜é”ä»£æ›¿æ€»çº¿é”æ¥æé«˜æ€§èƒ½)ã€‚</p>
<blockquote>
<p>cmpxchg(void* ptr, int old, int new)ï¼Œå¦‚æœptrå’Œoldçš„å€¼ä¸€æ ·ï¼Œåˆ™æŠŠnewå†™åˆ°ptrå†…å­˜ï¼Œå¦åˆ™è¿”å›ptrçš„å€¼ï¼Œæ•´ä¸ªæ“ä½œæ˜¯åŸå­çš„ã€‚åœ¨Intelå¹³å°ä¸‹ï¼Œä¼šç”¨lock cmpxchgæ¥å®ç°ï¼Œä½¿ç”¨lockè§¦å‘ç¼“å­˜é”ï¼Œè¿™æ ·å¦ä¸€ä¸ªçº¿ç¨‹æƒ³è®¿é—®ptrçš„å†…å­˜ï¼Œå°±ä¼šè¢«blockä½ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºæ•ˆè·ƒè¿ï¼Œæ¶æ„æ— ç•Œï¼Œç¬¬ä¸‰å±Šè…¾è®¯äº‘æ¶æ„å¸ˆå³°ä¼šåœ†æ»¡è½å¹•ï¼]]></title>    <link>https://juejin.cn/post/7603673564907814947</link>    <guid>https://juejin.cn/post/7603673564907814947</guid>    <pubDate>2026-02-07T09:23:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564907814947" data-draft-id="7603575399256719400" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºæ•ˆè·ƒè¿ï¼Œæ¶æ„æ— ç•Œï¼Œç¬¬ä¸‰å±Šè…¾è®¯äº‘æ¶æ„å¸ˆå³°ä¼šåœ†æ»¡è½å¹•ï¼"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-02-07T09:23:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºæ•ˆè·ƒè¿ï¼Œæ¶æ„æ— ç•Œï¼Œç¬¬ä¸‰å±Šè…¾è®¯äº‘æ¶æ„å¸ˆå³°ä¼šåœ†æ»¡è½å¹•ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:23:07.000Z" title="Sat Feb 07 2026 09:23:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025 å¹´ 12 æœˆ 27 æ—¥ï¼Œç”±è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿä¸è…¾è®¯äº‘ TVP è”åˆä¸»åŠçš„ç¬¬ä¸‰å±Šè…¾è®¯äº‘æ¶æ„å¸ˆå³°ä¼šåœ¨åŒ—äº¬å¯ŒåŠ›ä¸‡ä¸½é…’åº—æˆåŠŸä¸¾è¡Œã€‚æœ¬æ¬¡å³°ä¼šä»¥â€œæ™ºæ•ˆè·ƒè¿ æ¶æ„æ— ç•Œâ€ä¸ºä¸»é¢˜ï¼Œæ±‡èšäº†ä¼—å¤šæŠ€æœ¯é¢†è¢–ä¸æ¶æ„å¸ˆï¼Œå…±åŒæ¢è®¨ AI æµªæ½®ä¸‹æ¶æ„å¸ˆç¾¤ä½“çš„ä»·å€¼é‡å¡‘ä¸æŠ€æœ¯å˜é©ã€‚ç°åœºæ€æƒ³ç¢°æ’æ¿€çƒˆï¼Œå®è·µåˆ†äº«æ·±å…¥ï¼Œå‹¾å‹’å‡ºä¸€å¹…æŠ€æœ¯äººåœ¨æ™ºèƒ½æµªæ½®ä¸­è¿›åŒ–ä¸èµ‹èƒ½çš„æ–°è“å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30ce6de4ef6a4a6a8a95157c16c520c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=%2F75QaQPqCev1JtGKUguqQ9LCRm0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>ä¸»æŒäººå¼€åœº</strong></h2>
<p>ä¸»è®ºå›åœ¨è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿä¸»å¸­ æ¯›å‰‘å’Œè…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿæ´»åŠ¨ç»„ç»‡ä¸»å¸­ ç‹æ™“æ³¢çš„å¼€åœºä¸»æŒä¸­æ‹‰å¼€åºå¹•ã€‚ä¸¤ä½ä¸»å¸­ä¸ç°åœºæ¶æ„å¸ˆåŒä»ä»¬å…±åŒå›é¡¾äº†åŒç›Ÿè‡ª 2024 å¹´ 12 æœˆ 28 æ—¥æˆç«‹ä¸€å¹´æ¥çš„æˆé•¿å†ç¨‹ã€‚æ¯›å‰‘æŒ‡å‡ºï¼Œå½“å‰æ­£å€¼ AI ä»æŠ€æœ¯æ¦‚å¿µèµ°å‘å…¨é¢æ™®åŠçš„å…³é”®èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯æ™ºèƒ½ä½“åº”ç”¨çš„å…ƒå¹´ã€‚æŠ€æœ¯æµªæ½®å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„æœºé‡ï¼ŒåŒæ—¶ä¹Ÿè®©æ¶æ„å¸ˆç¾¤ä½“é¢ä¸´ç€â€œæ—§ç»éªŒéš¾ä»¥è§£å†³æ–°ç³»ç»Ÿâ€çš„æŒ‘æˆ˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcddcc4231f346ad8328270be3dd2b23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=%2F5u8RilyQTV1hH3PfPmgx9Mb%2B9c%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿä¸»å¸­ æ¯›å‰‘</p>
<p>ä½œä¸ºå³°ä¼šçš„æ€»å‡ºå“äººåŠä¸»æŒäººï¼Œç‹æ™“æ³¢è¿›ä¸€æ­¥é˜é‡Šäº†å³°ä¼šè®®é¢˜è®¾ç½®çš„å†…æ¶µï¼šAI å¸¦æ¥çš„ä¸ä»…æ˜¯æ•ˆç‡çš„çº¿æ€§æå‡ï¼Œæ›´æ˜¯ç”Ÿäº§åŠ›å’Œå·¥ä½œæ–¹å¼çš„ç»“æ„æ€§å˜é©ï¼Œå½“ä»£ç ç”Ÿæˆã€ç³»ç»Ÿè¿ç»´ä¹ƒè‡³éƒ¨åˆ†ä¸šåŠ¡å†³ç­–é€æ¸è¢« AI æ¥ç®¡ï¼Œæ‰§è¡Œå±‚æ—¥ç›Šè‡ªåŠ¨åŒ–ï¼Œæ¶æ„å¸ˆçš„èŒè´£ä¸èƒ½åŠ›è¾¹ç•Œæ­£åœ¨è¢«æŠ€æœ¯é‡æ–°å®šä¹‰ã€‚æœŸå¾…é€šè¿‡å…¨å¤©å›´ç»•äº§ä¸šåˆ¤æ–­ã€ç³»ç»Ÿé‡æ„ä¸è§’è‰²æ¼”è¿›çš„å¹²è´§åˆ†äº«ï¼Œèƒ½ä¸ºä¸ä¼šè€…å¸¦æ¥å‰ç»è§†é‡ä¸æ¸…æ™°çš„å‘å±•åˆ¤æ–­ï¼Œå…±åŒæ¢å¯»åœ¨æ™ºèƒ½å‚ä¸å†³ç­–çš„æ–°æ—¶ä»£ï¼Œæ¶æ„å¸ˆä¸å¯æ›¿ä»£çš„ä»·å€¼æ‰€åœ¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f85f6cf8f034a52bf987c79afb490f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=Eg8TZE93Aymazr5gcTZr1hQZACk%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿæ´»åŠ¨ç»„ç»‡ä¸»å¸­ ç‹æ™“æ³¢</p>
<h2 data-id="heading-1"><strong>ä¸»è®ºå›ï¼šæ™ºæ•ˆè·ƒè¿ æ¶æ„æ— ç•Œ</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9f61ff1e5b64ff09222daf634d16960~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=ziA89sL6BqK4nIS5eHoK1uQNT6U%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘å‰¯æ€»è£ã€è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿå“ç‰Œå‘å±•ä¸»å¸­ å¾å‹‡å·</p>
<p>è…¾è®¯äº‘å‰¯æ€»è£ã€è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿå“ç‰Œå‘å±•ä¸»å¸­ å¾å‹‡å·å‘è¡¨è‡´è¾ã€‚ä»–è¡¨ç¤ºï¼šæˆ‘ä»¬æ­£è§è¯ä¸€åœºè´¯ç©¿ç®—åŠ›ã€æ¨¡å‹åˆ°åº”ç”¨èŒƒå¼çš„å…¨æ–¹ä½æŠ€æœ¯è¾ƒé‡ã€‚é¢å¯¹å¦‚æ­¤æ·±å±‚çš„èŒƒå¼è¿ç§»ï¼Œæ¶æ„å¸ˆç¾¤ä½“ç«™åœ¨äº†èƒ½åŠ›é‡å¡‘çš„åå­—è·¯å£ã€‚ä»–æŠ›å‡ºäº†ä¸‰ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ï¼Œç›´æŒ‡æ¯ä½æŠ€æœ¯äººçš„å†…å¿ƒï¼š</p>
<p>â— åœ¨ AI èƒ½ç”Ÿæˆæ›´å¤šä»£ç çš„èƒŒæ™¯ä¸‹ï¼Œå¦‚ä½•é‡æ–°å®šä½æˆ‘ä»¬çš„æ ¸å¿ƒåˆ›é€ åŠ›ï¼Ÿ</p>
<p>â— åœ¨æ–°æ—¶ä»£ä¸‹ï¼Œå¦‚ä½•å‡çº§è‡ªå·±çš„èƒ½åŠ›æ¨¡å‹ï¼Ÿ</p>
<p>â— å¦‚ä½•åœ¨å¤æ‚å¤šå˜çš„å¤šæ™ºèƒ½ä½“ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ„å»ºçœŸæ­£å¯åº¦é‡ã€å¯è§‚æµ‹ã€å¯æ¼”åŒ–çš„æ¶æ„ï¼Ÿ</p>
<p>ä»–å¼ºè°ƒï¼Œæ­¤æ¬¡å³°ä¼šçš„ç›®çš„ä¸ä»…æ˜¯çŸ¥è¯†åˆ†äº«ï¼Œæ›´æ˜¯ä¸ºäº†æ ¡å‡†èˆªå‘ã€‚ä¸æ­¤åŒæ—¶ï¼Œå¾å‹‡å·é‡ç”³äº†åŒç›Ÿåˆ›ç«‹çš„åˆå¿ƒï¼šæŠ€æœ¯çš„å‘å±•ä»æ¥ä¸æ˜¯å•æ‰“ç‹¬æ–—ï¼Œå”¯æœ‰äº¤æµæ‰èƒ½æé€Ÿï¼Œå”¯æœ‰å…±åˆ›æ‰èƒ½å…±èµ¢ã€‚è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿæ­£æ˜¯å¸Œæœ›åœ¨è¿™ä¸ªå˜é©å¹´ä»£ï¼Œæˆä¸ºæ¶æ„å¸ˆä»¬çš„åŒè¡Œè€…ï¼Œæ±‡èšç¾¤ä½“åŠ›é‡ã€‚</p>
<p>éšåï¼Œä»–å›é¡¾äº†åŒç›Ÿæˆç«‹ä¸€å‘¨å¹´æ¥çš„åšå®è¶³è¿¹ï¼šåœ¨ä¸ƒå¤§åŸå¸‚å»ºç«‹åœ°åŒºåŒç›Ÿï¼Œæ±‡èšäº†è¶…åƒåé¡¶çº§æ¶æ„å¸ˆï¼›ä¸¾åŠäº† 40 ä½™åœºåœ°åŒºäº¤æµæ´»åŠ¨ï¼›åœ¨ç¤¾åŒºä¸­äº§å‡ºäº† 5218 ç¯‡æ·±åº¦æŠ€æœ¯æ–‡ç« ï¼Œè§£ç­”äº† 934 ä¸ªæŠ€æœ¯éš¾é¢˜ï¼›é€šè¿‡ã€Šæ¶æ„ä¹‹é“ã€‹åˆŠç‰©ã€ç³»åˆ—ç›´æ’­å¯¹è¯ï¼ŒæŒç»­ç‚¹ç‡ƒç¾¤ä½“æ™ºæ…§ã€‚å±•æœ›æœªæ¥ï¼Œå¾å‹‡å·æœŸå¾…åŒç›Ÿèƒ½æŒç»­å‡çº§ï¼Œæ‹“å±•åœ°åŸŸï¼ŒçœŸæ­£æˆä¸ºå…¨å›½æ¯ä¸€ä½æ¶æ„å¸ˆçš„ç¤¾äº¤åœºã€å­¦ä¹ åœˆå’Œè¿›åŒ–é˜¶æ¢¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aeeb212e19464c6d8357a4fd5966e166~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=%2B1PJmGXpVuHcK0jOtb4daN2BLdw%3D" alt="" loading="lazy"/></p>
<p>é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰åç†å‰¯æ ¡é•¿ã€è®²åº§æ•™æˆï¼Œè…¾è®¯äº‘TVP ç†Šè¾‰</p>
<p>é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰åç†å‰¯æ ¡é•¿ã€è®²åº§æ•™æˆï¼Œè…¾è®¯äº‘ TVP ç†Šè¾‰çš„æ¼”è®²ã€Šè®¤çŸ¥å‡ç»´ï¼šäººå·¥æ™ºèƒ½å¥‡ç‚¹æœŸçš„äº§ä¸šæ–°åæ ‡ã€‹å¸¦æ¥äº†é«˜å±‹å»ºç“´çš„äº§ä¸šåˆ†æã€‚ä»–çŠ€åˆ©åœ°æŒ‡å‡ºï¼Œå½“å‰åˆ¶çº¦AIå‘å±•çš„æœ€åº•å±‚é€»è¾‘æ˜¯â€œç”µâ€ï¼Œè€Œéå•çº¯çš„ç®—åŠ›ã€‚ç†Šè¾‰æ•™æˆé¼“åŠ±æ¶æ„å¸ˆæˆä¸ºâ€œäººæœºæ··åˆæ–°å‹åŠ³åŠ¨åŠ›â€ï¼Œå¹¶ç»™å‡ºä¸ªäººå‘å±•çš„å…³é”®å»ºè®®ï¼šæŠ•èº«äºæ•°æ®åŸºç¡€å·®ã€é‡‡é›†éš¾çš„â€œæœé˜³è¡Œä¸šâ€ï¼Œå› ä¸ºåœ¨é‚£é‡Œäººçš„ç»éªŒä»·å€¼æ›´æ˜“ç§¯ç´¯ï¼›åŒæ—¶ï¼Œè¦å–„ç”¨ AI ä½œä¸ºâ€œå­¦ä¹ ä¼´ä¾£â€ï¼Œæå‡æ•ˆç‡ï¼Œå¹¶é‡ç‚¹åŸ¹å…»å¯æ„ä¼šä¸å¯è¨€ä¼ çš„â€œå·®å¼‚åŒ–èƒ½åŠ›â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbc59b39c7b54e2abbb163ae123eecf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=treCCGB%2BfaBl6I2YUMfspLazixo%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘å‰¯æ€»è£ã€è…¾è®¯æ™ºæ…§é›¶å”®æŠ€æœ¯æ¶æ„å’Œäº§ç ”è´Ÿè´£äºº ç¨‹ä¼Ÿ</p>
<p>è…¾è®¯äº‘å‰¯æ€»è£ã€è…¾è®¯æ™ºæ…§é›¶å”®æŠ€æœ¯æ¶æ„å’Œäº§ç ”è´Ÿè´£äºº ç¨‹ä¼Ÿåˆ†äº«äº†ã€Šä¼ä¸šæ™ºèƒ½ä½“çš„åˆ›æ–°ä»·å€¼ä¸è¡Œä¸šå®è·µã€‹ã€‚ä»–åŸºäºæœåŠ¡ä¸Šç™¾å®¶é›¶å”®ä¼ä¸šçš„è§‚å¯Ÿï¼ŒæŒ‡å‡ºä¼ä¸šæ™ºèƒ½ä½“è½åœ°å·²ä»å¯¹è¯ä¸ç®€å•å·¥ä½œæµï¼Œè¿ˆå‘ä¸ä¸šåŠ¡æ·±åº¦ç»“åˆçš„å¤æ‚åœºæ™¯ã€‚é’ˆå¯¹æ™ºèƒ½ä½“åœ¨ä¼ä¸šè½åœ°ï¼Œä»–æŒ‡å‡ºè¿˜éœ€æ‰“èµ¢æ¨¡å‹æ€§èƒ½ã€æ•°æ®æ²»ç†ã€ä¸šåŠ¡è€¦åˆã€å®‰å…¨é˜²æŠ¤ç­‰å…­åœºæ”»åšæˆ˜ï¼Œå¹¶ä»‹ç»äº†è…¾è®¯äº‘æ™ºèƒ½ä½“æˆ˜ç•¥ä»¥åŠâ€œæ™ºèƒ½ä½“åœºæ™¯ç½—ç›˜â€ç­‰å·¥å…·ï¼Œå¸®åŠ©ä¼ä¸šå˜æ¸…è‡ªèº«é˜¶æ®µï¼Œé€‰æ‹©å¯è½åœ°çš„åœºæ™¯ã€‚ç¨‹ä¼Ÿå¼ºè°ƒï¼Œä¼ä¸šè¦æˆåŠŸè®© AI ä»·å€¼å˜ç°ï¼Œå»ºè®®è‡ªä¸‹è€Œä¸Šè¯†åˆ«é«˜ä»·å€¼åœºæ™¯ï¼Œæ´å¯Ÿä¸€çº¿å‘˜å·¥å¦‚ä½•ä½¿ç”¨ AIï¼ŒæŠ•èµ„å¯ä»¥ä¸å·¥ä½œæµæ·±åº¦é›†æˆçš„åœºæ™¯ï¼ŒåŒæ—¶åšå¥½æ•°æ®è´¨é‡å’Œä¸Šä¸‹æ–‡å·¥ç¨‹å»ºè®¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc3ebc9d15e84553bb625f4b22bccc98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=nedfj58MBn7d2%2FJGCwFbiqTXMp8%3D" alt="" loading="lazy"/></p>
<p>ä¹…ç—•ç§‘æŠ€åˆ›å§‹äººå…¼ CEOã€åŸç½‘æ˜“é›†å›¢å‰¯æ€»è£ã€è…¾è®¯äº‘ TVP æ±ªæº</p>
<p>ä¹…ç—•ç§‘æŠ€åˆ›å§‹äººå…¼ CEOã€åŸç½‘æ˜“é›†å›¢å‰¯æ€»è£ã€è…¾è®¯äº‘ TVP æ±ªæºåœ¨ã€Šä¸ªäººæ•°å­—è®°å¿†ï¼šå®è·µã€æ€è€ƒä¸æŒ‘æˆ˜ã€‹ä¸­ï¼Œæå‡ºäº†ä¸€ä¸ªé¢å‘ä¸ªä½“çš„æœªæ¥æ„æƒ³ã€‚ä»–ä»‹ç»äº†å…¶äº§å“â€œremioâ€ï¼Œæ—¨åœ¨è‡ªåŠ¨æ•è·ã€å­˜å‚¨å¹¶ç´¢å¼•ä¸ªäººæ¥è§¦çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ„å»ºæœ¬åœ°åŒ–ã€é«˜éšç§çš„â€œä¸ªäººæ•°å­—è®°å¿†â€ç³»ç»Ÿã€‚ä»–è®¤ä¸ºï¼Œåœ¨ AI æ—¶ä»£ï¼Œä¸ªäººæ‹¥æœ‰çš„ä¸Šä¸‹æ–‡è´¨é‡å°†å†³å®šå…¶ç«äº‰åŠ›ã€‚æ±ªæºä¹ŸæŠ›å‡ºäº†ä¸€ä¸ªæ·±åˆ»çš„ä¼¦ç†é—®é¢˜ï¼šå½“å‘˜å·¥ç¦»èŒï¼Œå…¶åœ¨èŒæœŸé—´ç§¯ç´¯çš„â€œæ•°å­—è®°å¿†â€å½’å±å…¬å¸è¿˜æ˜¯ä¸ªäººï¼Ÿè¿™å°†æ˜¯æœªæ¥å¿…é¡»é¢å¯¹çš„ç¤¾ä¼šè®®é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/722f292a5d2149489bf3d6e65183ac1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=TBlVvKU%2FaAH3SDLh4bGbkcUP3bc%3D" alt="" loading="lazy"/></p>
<p>Rokid å…¨çƒå¼€æ”¾ç”Ÿæ€è´Ÿè´£äººï½œäº§å“ã€å·¥ç¨‹ä¸ç”Ÿæ€å…¨çƒé«˜çº§æ€»ç›‘ èµµç»´å¥‡</p>
<p>Rokid å…¨çƒå¼€æ”¾ç”Ÿæ€è´Ÿè´£äººï½œäº§å“ã€å·¥ç¨‹ä¸ç”Ÿæ€å…¨çƒé«˜çº§æ€»ç›‘ èµµç»´å¥‡çš„æ¼”è®²ã€ŠAI+AR èåˆçš„å…¨çƒå®è·µï¼šä»ç©ºé—´è®¡ç®—åˆ°ä¸ªäººæ™ºèƒ½ä½“ã€‹ï¼Œå°†è§†é‡å¼•å‘ç¡¬ä»¶ä¸äº¤äº’çš„æœªæ¥ã€‚ä»–é˜è¿°äº† AI ä¸ AR äº’ä¸ºæœ€ä½³è½½ä½“çš„å…³ç³»ï¼šAI è®© AR äº¤äº’æ›´è‡ªç„¶ï¼ŒAR åˆ™ä¸º AI æä¾›äº†æ„ŸçŸ¥ä¸è¿æ¥ç‰©ç†ä¸–ç•Œçš„ç•Œé¢ã€‚ä»–å±•ç¤ºäº† Rokid åœ¨æ²‰æµ¸ç©ºé—´ã€è½»é‡åŒ–æ•°æ®ç©ºé—´ç­‰åœºæ™¯çš„è½åœ°æ¡ˆä¾‹ï¼Œå¹¶å±•æœ›äº†â€œæ— ç•Œäº¤äº’â€çš„æœªæ¥â€”â€”èº«è¾¹çš„å±å¹•å°†è¶Šæ¥è¶Šå°‘ï¼Œå¯ç©¿æˆ´è®¾å¤‡è®©æ™ºèƒ½ä½“æ— å½¢åœ°èå…¥ç”Ÿæ´»ä¸å·¥ä½œã€‚ä»–æœ€åå‘¼åï¼Œç§‘æŠ€åº”æœåŠ¡äºäººï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½äº«å—ç§‘æŠ€å¸¦æ¥çš„å¹³ç­‰æœºä¼šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f507147a553c41239826f8a2baa045d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=Z88pLpafPQf%2BYwM80niW8HTCRko%3D" alt="" loading="lazy"/></p>
<p>å¹´åº¦å“è¶ŠåŒç›Ÿâ€”â€”è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿé¢å¥–å…¸ç¤¼</p>
<p>åœ¨ä¸»è®ºå›çš„å°¾å£°ï¼Œä¼šè®®ç‰¹åˆ«è®¾ç½®äº†å¹´åº¦è¡¨å½°ç¯èŠ‚ï¼Œä»¥å›é¡¾ä¸å˜‰å¥–è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿæˆç«‹ä¸€å¹´æ¥çš„ä¸°ç¡•æˆæœä¸æ°å‡ºè´¡çŒ®ã€‚åŒ—äº¬åŒç›Ÿå‡­å€Ÿæ·±åº¦çš„æŠ€æœ¯äº¤æµè£è· 2025 å¹´åº¦ã€Œå­¦ä¹ å…±åˆ›æœ€ä½³åŒç›Ÿã€ã€ã€Œæ€è¾¨åˆ›æ–°æœ€ä½³åŒç›Ÿã€ï¼Œåˆè‚¥åŒç›Ÿå› ä¸ºå…¶æ˜¾è‘—çš„æˆå‘˜å‡èšåŠ›è£è· 2025 å¹´åº¦ã€Œæ˜Ÿç«æ±‡èšæœ€ä½³åŒç›Ÿã€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f005b06f348d4965b74382161ecba803~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=khh91KU534OVYBHZhbFKxOuSVR0%3D" alt="" loading="lazy"/></p>
<p>ä¸Šæµ·åŒç›Ÿå…¥ä¼šæˆé•¿ç†äº‹ ä¸é›ªä¸°</p>
<p>ä¸Šæµ·åŒç›Ÿå› å…¶åœ¨ç»„ç»‡å»ºè®¾ã€æ´»åŠ¨åˆ›æ–°ã€çŸ¥è¯†æ²‰æ·€åŠç”Ÿæ€å½±å“ç­‰æ–¹é¢çš„ç»¼åˆå“è¶Šè¡¨ç°ï¼Œè£è· 2025 å¹´åº¦ã€Œåœ°åŒºå¼€æ‹“æœ€ä½³åŒç›Ÿã€ã€ã€Œå“ç‰Œå‘å±•æœ€ä½³åŒç›Ÿã€ï¼Œå¹¶è¢«ç‰¹åˆ«æˆäºˆã€Œ2025 å¹´åº¦å…¨å›½æœ€ä½³åŒç›Ÿã€è¡¨å½°ã€‚ä¸Šæµ·åŒç›Ÿå…¥ä¼šæˆé•¿ç†äº‹ ä¸é›ªä¸°åœ¨æ„Ÿè¨€ä¸­å¼ºè°ƒï¼Œè£èª‰å±äºæ‰€æœ‰æ¶æ„å¸ˆåŒä»ï¼Œäººæ‰æ˜¯æœ€é‡è¦çš„ï¼Œä¸€ä¸ªäººå¯ä»¥èµ°å¾—å¾ˆå¿«ï¼Œä½†ä¸€ç¾¤äººæ‰èƒ½èµ°å¾—æ›´è¿œã€‚ä¸Šæµ·åŒç›Ÿç†äº‹é•¿ é©¬ä¿Šåœ¨è·å¥–æ„Ÿè¨€ä¸­åˆ†äº«äº†å…¶æˆåŠŸâ€œå¯†ç â€ï¼šæµ·çº³ç™¾å·çš„ä»·å€¼è§‚ã€å›¢ç»“çš„ç†äº‹å›¢é˜Ÿï¼Œä»¥åŠè®©æ¯ä½æˆå‘˜éƒ½èƒ½ç«™åˆ° C ä½å‘å…‰å‘çƒ­çš„èˆå°ç†å¿µï¼Œæ‰è®©ä¸Šæµ·åŒç›ŸçœŸæ­£ä»¥å›¢ç»“å®ç°å…±èµ¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/351a8294b36747c0a2a551d93a910cb5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=rEh9FXmip%2FGPvGj2BhHXoklmT5U%3D" alt="" loading="lazy"/></p>
<p>ä¸Šæµ·åŒç›Ÿç†äº‹é•¿ é©¬ä¿Š</p>
<h2 data-id="heading-2"><strong>ä¸»é¢˜è®ºå›ï¼šAIé©±åŠ¨çš„æŠ€æœ¯é‡æ„ä¸ä¸šåŠ¡èµ‹èƒ½</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63ddef3e07064251819252473aa67fad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=35LFyLW5L7W1YfK5SukVANVcoso%3D" alt="" loading="lazy"/></p>
<p>æ–°åç¤¾å›½å®¶é‡ç‚¹å®éªŒå®¤æ€»æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ è”¡æ˜Œè‰³</p>
<p>æœ¬è®ºå›ç”±æ–°åç¤¾å›½å®¶é‡ç‚¹å®éªŒå®¤æ€»æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ è”¡æ˜Œè‰³å‡ºå“ï¼Œè”¡æ˜Œè‰³å¼€ç¯‡ç‚¹é¢˜ï¼ŒæŒ‡å‡º AI æ­£åœ¨é‡å¡‘ä¸šåŠ¡åº•å±‚é€»è¾‘ï¼ŒæŠ€æœ¯ä»æ”¯æ’‘ä¸šåŠ¡è½¬å‘å®šä¹‰ä¸šåŠ¡ï¼Œå› æ­¤æœ¬è®ºå›å°†é‡ç‚¹æ¢è®¨ AI åœ¨æŠ€æœ¯æ¶æ„ä¸ä¸šåŠ¡è½åœ°å±‚é¢çš„æ·±åº¦èåˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d36b84f1bd846f388a4f68bbccfc119~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=q7M4r5Gn7fdn9%2BocwmpVwQDO9Qo%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿç¤¾ç¾¤ç®¡ç†ä¸»å¸­ æ­å…‰å‘</p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿç¤¾ç¾¤ç®¡ç†ä¸»å¸­ æ­å…‰å‘åœ¨ã€ŠAI é¢†å¯¼åŠ› 2.0ï¼šä»è¶…çº§ä¸ªä½“åˆ°è¶…çº§å†›å›¢ã€‹ä¸­ï¼Œåˆ†äº«äº†è‡ªèº«ä»â€œAI åŸç”Ÿâ€ä½¿ç”¨è€…åˆ°ç®¡ç†è€…çš„å¿ƒè·¯å†ç¨‹ï¼Œå¹¶æå‡º AI é¢†å¯¼åŠ›çš„æ ¸å¿ƒæ˜¯å°† AI è§†ä¸ºå›¢é˜Ÿæˆå‘˜è€Œéå·¥å…·ã€‚ä»–åˆ†äº«äº†ä»â€œAI é¢†å¯¼åŠ› 1.0â€ï¼ˆå°†ä¸“ä¸šæŠ€èƒ½å¤–åŒ…ç»™ AIï¼‰åˆ°â€œ2.0â€ï¼ˆå°†ç®¡ç†èƒ½åŠ›ä¹Ÿå¤–åŒ…ï¼‰çš„å‡çº§è·¯å¾„ã€‚é¢å¯¹ AI æ•ˆç‡è¿‡é«˜å¯¼è‡´äººç±»â€œå¿ƒåŠ›å¸¦å®½â€ç“¶é¢ˆçš„é—®é¢˜ï¼Œä»–é˜è¿°äº†æ„å»ºâ€œç§˜ä¹¦ Agentâ€çš„ä¸‰å±‚æ¶æ„è®¾æƒ³ï¼šäººç±»ä½œä¸ºé¢†å¯¼è€…ï¼Œåªéœ€ä¸ä¸€ä¸ªâ€œç§˜ä¹¦ Agentâ€äº¤äº’ï¼Œç”±å®ƒæ¥ç®¡ç†ä¸‹å±‚ä¼—å¤šæ‰§è¡Œ Agentã€‚è¿™ç§â€œç”¨ AI ç®¡ç† AIâ€çš„æ¨¡å¼ï¼Œæ—¨åœ¨é€šè¿‡è§„èŒƒã€æŠ€èƒ½åŒ…å’Œå·¥ä½œæµå°è£…ï¼Œå®ç°é«˜å“è´¨äº§å‡ºï¼Œå¹¶é™ä½äººç±»çš„ç›´æ¥å¹²é¢„é¢‘ç‡ï¼Œæœ€ç»ˆè®©äººå›å½’åˆ°éœ€æ±‚æ¾„æ¸…ä¸æœ€ç»ˆéªŒæ”¶çš„æ ¸å¿ƒè§’è‰²ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a8d881ea51045fcba0247743340bf03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=yWkYIHKxVWGL%2BBDKs%2BSYAfuYEJ0%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘äº’è”ç½‘æŠ€æœ¯æ€»ç»ç† å¶è¾‰</p>
<p>è…¾è®¯äº‘äº’è”ç½‘æŠ€æœ¯æ€»ç»ç† å¶è¾‰æ¢è®¨äº†ã€Šä»äº‘åŸç”Ÿåˆ° AI åŸç”Ÿã€‹ã€‚ä»–ç±»æ¯”äº‘åŸç”Ÿæ—¶ä»£çš„â€œé›¶ä¿¡ä»»â€å®‰å…¨ç†å¿µï¼Œæå‡º AI åŸç”Ÿæ¶æ„åŒæ ·éœ€è¦æ–°çš„èŒƒå¼ã€‚å¹¶ä»¥æ™ºèƒ½å®¢æœåœºæ™¯ä¸ºä¾‹ï¼ŒæŒ‡å‡ºä¸šåŠ¡é€»è¾‘å·²ä»äººå·¥å†³ç­–é“¾æ¡å˜ä¸ºåŸºäºçŸ¥è¯†åº“ä¸è¯­ä¹‰ç†è§£çš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œè¿™å¯¼è‡´æŠ€æœ¯æŒ‘æˆ˜ä»ä¼ ç»Ÿçš„ QPSã€å»¶è¿Ÿè½¬å‘å¯¹ä¸Šä¸‹æ–‡ã€Token æ¶ˆè€—ã€å¹»è§‰ç®¡ç†çš„å…³æ³¨ã€‚ä»–å±•æœ›äº† AI åŸç”Ÿæ¶æ„çš„å‡ ä¸ªå…³é”®ç‰¹å¾ï¼šä»¥æ™ºèƒ½è®¡ç®—ä¸ºä¸­å¿ƒã€å…³æ³¨è¯­ä¹‰ç›¸å…³æ€§è€Œä¸ä»…æ˜¯å“åº”é€Ÿåº¦ã€ä»¥åŠé€šè¿‡ç»Ÿä¸€è¯­ä¹‰å±‚ï¼ˆå¦‚â€œæœ¬ä½“è®ºâ€ï¼‰æ¥æ‰“é€šä¸šåŠ¡ä¸æŠ€æœ¯çš„è®¤çŸ¥éš”é˜‚ã€‚ä»–åŒæ—¶æŒ‡å‡ºï¼Œå½“å‰ AI å·¥ç¨‹åŒ–é¢ä¸´ç¡®å®šæ€§ã€ç¼–æ’å¤æ‚æ€§ã€èµ„æºæˆæœ¬åŠæ•°æ®éšç§ç­‰æ ¸å¿ƒæŒ‘æˆ˜ã€‚AI åŸç”Ÿä¸ä»…æ˜¯æŠ€æœ¯çš„å‡çº§ï¼Œæ›´æ˜¯ä¸€ç§æ¶æ„æ€ç»´çš„è½¬å˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a3a56687e0541248c27b598327d74cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=7TIF5yGlCLUO%2FgHx%2BFN9rNGLBl4%3D" alt="" loading="lazy"/></p>
<p>æ±‡é‡ç§‘æŠ€å‰¯æ€»è£å…¼é¦–å¸­æ¶æ„å¸ˆã€è…¾è®¯äº‘ TVP è”¡è¶…</p>
<p>æ±‡é‡ç§‘æŠ€å‰¯æ€»è£å…¼é¦–å¸­æ¶æ„å¸ˆã€è…¾è®¯äº‘ TVP è”¡è¶…çš„åˆ†äº«ã€ŠåŸºäº Multi-Agent çš„é‡æ„ä¸æ€è€ƒã€‹æå…·æŠ€æœ¯æ·±åº¦ã€‚ä»–é¦–å…ˆè¾¨æäº†é™æ€å·¥ä½œæµä¸åŠ¨æ€å·¥ä½œæµçš„é€‚ç”¨åœºæ™¯ï¼šå‰è€…é€‚åˆå¸¸è§„ã€é¡ºåºæ€§ä»»åŠ¡ï¼Œæ˜“äºè°ƒè¯•å’Œæˆæœ¬å¯æ§ï¼›åè€…åˆ™èƒ½å¤„ç†éœ€è¦å¯å‘å¼æ¢ç´¢çš„å¤æ‚é—®é¢˜ï¼Œå…¶çœŸæ­£ä»·å€¼åœ¨äºæŒç»­çš„è¿­ä»£ä¸æ”¹è¿›ã€‚ä»–åˆ†äº«äº†åœ¨å¹¿å‘ŠæŠ•æ”¾ç³»ç»Ÿä¸­åº”ç”¨ Multi-Agentï¼ˆå¦‚ Campaign åˆ†æ Agentã€æŠ•æ”¾è¿è¥ Agentï¼‰çš„å®è·µã€‚æœ€åï¼Œä»–æå‡ºäº†ä¸€ä¸ªå‰ç»æ€§æ¶æ„è®¾æƒ³ï¼šå°†ç³»ç»Ÿçš„åŸå­æ“ä½œæš´éœ²ä¸º MCP åè®®ï¼Œè®© Agent æ¥ç¼–æ’ä¸Šå±‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œä»è€Œæ„å»ºä¸€ä¸ªå¯è‡ªè¿›åŒ–çš„å…¨æ–°ç³»ç»Ÿæ¶æ„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfcc41465a6e4b8b8e36da1e4edc0771~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=oT2keSZKcXFL99Fs2ruwO8HTfOI%3D" alt="" loading="lazy"/></p>
<p>è‡ªå¦‚æŠ€æœ¯å‰¯æ€»ç»ç†ã€è…¾è®¯äº‘æ¶æ„å¸ˆåäººå ‚ä¸“å®¶ åº”é˜”æµ©</p>
<p>è‡ªå¦‚æŠ€æœ¯å‰¯æ€»ç»ç†ã€è…¾è®¯äº‘æ¶æ„å¸ˆåäººå ‚ä¸“å®¶ åº”é˜”æµ©å¸¦æ¥äº†ã€Šè‡ªå¦‚ AI å®è·µåŠæ¶æ„æ€è€ƒã€‹ã€‚ä»–è¯¦ç»†ä»‹ç»äº† AI åœ¨è‡ªå¦‚ç§Ÿæˆ¿ä¸šåŠ¡ä¸­çš„å…·ä½“è½åœ°ï¼Œå¹¶æ€»ç»“äº† AI è½åœ°â€œä¸‰æ­¥èµ°â€ç­–ç•¥â€”â€”çŸ­æœŸå¿«é€Ÿä¸Šçº¿ã€ä¸­æœŸå»ºç«‹å¹³å°ã€é•¿æœŸæ„å»ºæ ¸å¿ƒç«äº‰åŠ›ã€‚åœ¨ä¸šåŠ¡å±‚é¢ï¼Œä»–é‡ç‚¹ä»‹ç»äº†å¦‚â€œAI æ‰¾æˆ¿åŠ©æ‰‹â€å¦‚ä½•é€šè¿‡æ„å›¾è¯†åˆ«ã€å‚æ•°æå–ä¸å¤šè½®å¯¹è¯ï¼Œç†è§£ç”¨æˆ·æ¨¡ç³Šéœ€æ±‚ã€‚åœ¨ç ”å‘å±‚é¢ï¼Œä»–åˆ†äº«äº†åœ¨ç‰¹å¾å·¥ç¨‹ã€å†…å®¹æ‘˜è¦ç”Ÿæˆã€èšç±»ä¸å®¡æ ¸ç­‰ç¯èŠ‚åº”ç”¨å¤§æ¨¡å‹æ›¿ä»£ä¼ ç»Ÿå°æ¨¡å‹çš„ç»éªŒï¼Œå®ç°äº†æ•ˆæœæå‡ä¸æˆæœ¬é™ä½ã€‚åœ¨æ¶æ„å±‚é¢ï¼Œä»–æç»˜äº†åŒ…å«çŸ¥è¯†åº“ã€å‚ç›´æ¨¡å‹ã€MCP ç½‘å…³åŠ Agent ç®¡ç†å¹³å°çš„ AI ä¸­å°è“å›¾ï¼Œä¸ºä¼ ç»Ÿä¸šåŠ¡æ™ºèƒ½åŒ–æä¾›äº†æ¸…æ™°è·¯çº¿å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12784c2119b04957921ebb9b9820a6e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=ZnlgPQw9ocMatlqk6mUbdymy%2BDo%3D" alt="" loading="lazy"/></p>
<p>Opera æŠ€æœ¯å‰¯æ€»ç›‘ã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿæˆå‘˜ å¼ å»ºç£Š</p>
<p>Opera æŠ€æœ¯å‰¯æ€»ç›‘ã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿæˆå‘˜ å¼ å»ºç£Šåˆ†äº«äº†ã€Šå¤§æ¨¡å‹æ—¶ä»£çš„æ¨èæ¶æ„è¿›åŒ–ã€‹ã€‚ä»–ä»‹ç»äº† Opera æµè§ˆå™¨å†…å®¹æ¨èç³»ç»Ÿçš„ä¼ ç»Ÿæ¶æ„ï¼Œä¼ ç»Ÿæ¨èä¾èµ–ç‰¹å¾å·¥ç¨‹ï¼Œä½†å­˜åœ¨è¯­ä¹‰ç†è§£æµ…ã€å†·å¯åŠ¨éš¾ã€æ¨¡å‹ç¢ç‰‡åŒ–ç­‰é—®é¢˜ã€‚éšåä»–é‡ç‚¹è®²è§£äº†å¤§æ¨¡å‹å¦‚ä½•é©æ–°ç‰¹å¾å·¥ç¨‹ã€å†…å®¹æ‘˜è¦ä¸èšç±»ç­‰ç¯èŠ‚ï¼Œå¹¶åˆ†äº«äº†åœ¨å†…å®¹ç”Ÿäº§ä¾§çš„åº”ç”¨ï¼šåˆ©ç”¨å¤§æ¨¡å‹è¾…åŠ©è‡ªåª’ä½“ä½œè€…é€‰é¢˜ä¸å†™ä½œï¼Œä»¥åŠå°†å•†å“ä¿¡æ¯è½¬åŒ–ä¸ºå¸å¼•äººçš„å†…å®¹æ–‡ç« è¿›è¡Œåˆ†å‘ã€‚ä»–ä¹Ÿå¦è¯šï¼Œç”±äºå»¶è¿Ÿå’Œæˆæœ¬è€ƒé‡ï¼Œå¤§æ¨¡å‹å°šæœªæ·±å…¥æ ¸å¿ƒçš„å¬å›ä¸æ’åºç¯èŠ‚ï¼Œä½†å…¶åœ¨å†…å®¹ç†è§£ä¸ç”Ÿæˆæ–¹é¢çš„èƒ½åŠ›å·²ä¸ºæ¨èç³»ç»Ÿæ‰“å¼€äº†æ–°çš„èµ‹èƒ½ç©ºé—´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/424c6b20aca044adbd48633707bca774~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=IMuyb6OtS8D56dI3LZb63yOPn6w%3D" alt="" loading="lazy"/></p>
<p>åœ†æ¡Œå¯¹è¯ã€ŠAI åŒè½®é©±åŠ¨ï¼šæŠ€æœ¯çªç ´ä¸å•†ä¸šä»·å€¼çš„é—­ç¯æ„å»ºã€‹</p>
<p>åœ†æ¡Œå¯¹è¯ç¯èŠ‚ï¼Œè…¾è®¯äº‘æ™ºèƒ½é¡¾é—®æ€»ç»ç†ã€è…¾è®¯äº‘æ¶æ„å¸ˆåäººå ‚ä¸“å®¶ è®¸å°å·ï¼Œä¸­ç§‘é™¢è®¡ç®—æ‰€å‰¯æ•™æˆã€è…¾è®¯äº‘æ¶æ„å¸ˆåäººå ‚ä¸“å®¶ ææ˜å®‡ä¸¤ä½å˜‰å®¾åŠ å…¥äº†åˆ†äº«ï¼Œä¸æ¼”è®²å˜‰å®¾å›´ç»•â€œAI æŠ€æœ¯çªç ´ä¸å•†ä¸šä»·å€¼çš„é—­ç¯æ„å»ºâ€å±•å¼€è®¨è®ºã€‚é’ˆå¯¹â€œå¦‚ä½•é¿å…è‡ªå—¨å¼ç ”å‘â€ï¼Œè®¸å°å·å¼ºè°ƒæŠ€æœ¯ä¸ä¸šåŠ¡å›¢é˜Ÿå¿…é¡»â€œä¸€èµ·å—¨â€ï¼Œåœ¨é€‰å‹åˆæœŸå°±è¾¾æˆå…±è¯†ï¼›ææ˜å®‡æŒ‡å‡ºåº”ä¼˜å…ˆé€‰æ‹©é‚£äº›èƒ½ä»ä¸åŠæ ¼æå‡åˆ° 70 åˆ†çš„åœºæ™¯ï¼Œè€Œéä» 90 åˆ†åˆ° 100 åˆ†çš„â€œé”¦ä¸Šæ·»èŠ±â€ï¼›æ­å…‰å‘åˆ™å»ºè®®â€œç­‰é£æ¥â€ä¸â€œæŒ–å¥½å‘â€ç»“åˆï¼Œæå‰åšå¥½å·¥ç¨‹åŒ–å‡†å¤‡ã€‚å…³äºæŠ€æœ¯åˆ°å•†ä¸šçš„è½¬åŒ–ï¼Œå¼ å»ºç£Šçš„åˆ†äº«åŠ¡å®è€Œèšç„¦ï¼šé€‰æ‹©â€œåº”è¯¥åšã€èƒ½åšã€ä¸”èƒ½åšå¥½â€çš„äº¤é›†ï¼Œåˆ©ç”¨ AI æ”¾å¤§ç°æœ‰ä¸šåŠ¡ä¼˜åŠ¿ï¼ˆå¦‚å†…å®¹ç”Ÿæˆï¼‰ç›´æ¥å¸¦æ¥æ”¶å…¥å¢é•¿ã€‚æœ€åï¼Œå¯¹äºâ€œå¹´è½»å¼€å‘è€…å¯èƒ½è¿‡åº¦ä¾èµ– VibeCoding ç¼ºä¹å®æˆ˜ç»éªŒâ€çš„æ‹…å¿§ï¼Œææ˜å®‡è®¤ä¸ºï¼ŒæŠ€æœ¯äººé€šè¿‡å®è·µåŸ¹å…»æ¶æ„èƒ½åŠ›çš„è¿‡ç¨‹ä¾ç„¶ä¸å¯æ›¿ä»£ï¼Œæ•™è‚²ä½“ç³»ä¸æŒç»­å­¦ä¹ å¿…é¡»è·Ÿä¸ŠæŠ€æœ¯å˜é©çš„æ­¥ä¼ã€‚</p>
<h2 data-id="heading-3"><strong>ä¸»é¢˜è®ºå›ï¼šAI èµ‹èƒ½è€…ï¼Œå¼€å‘è€…çš„è¿›åŒ–ä¹‹è·¯</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b4bb0dbf3d44795b5fd9f655198257b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=LdQE4l4NcP3v5WF96zW%2BrADGlYw%3D" alt="" loading="lazy"/></p>
<p>åŒç¨‹æ—…è¡Œèµ„æ·±æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿå­¦ä¹ äº¤æµä¸»å¸­ ææ™ºæ…§</p>
<p>æœ¬è®ºå›èšç„¦äº AI æ—¶ä»£å¼€å‘è€…ä¸æŠ€æœ¯äººçš„ä¸ªä½“è¿›åŒ–è·¯å¾„ï¼Œç”±åŒç¨‹æ—…è¡Œèµ„æ·±æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆæŠ€æœ¯åŒç›Ÿå­¦ä¹ äº¤æµä¸»å¸­ ææ™ºæ…§å‡ºå“ã€‚ææ™ºæ…§ä»¥ä¸‰åå¹´æŠ€æœ¯ç”Ÿæ¶¯çš„å›é¡¾å¼€åœºï¼ŒæŒ‡å‡ºæŠ€æœ¯èŒƒå¼çš„å˜è¿æ­£é‡æ–°å®šä¹‰ä»·å€¼äº§å‡ºã€‚ä»–æé†’å¼€å‘è€…ï¼Œåœ¨ AI å¸¦æ¥â€œè®¤çŸ¥å¤–åŒ…â€å’Œâ€œç»éªŒè´¬å€¼â€çš„åŒæ—¶ï¼Œç³»ç»Ÿæ€ç»´èƒ½åŠ›ã€ä»·å€¼åˆ¤æ–­åŠ›å’Œç»éªŒæŠ½è±¡èƒ½åŠ›æ­£å˜å¾—æ„ˆå‘ç¨€ç¼ºã€‚ä»–å»ºè®®æŠ€æœ¯äººä¿æŒè‡ªä¿¡ä¸å¥½å¥‡å¿ƒï¼Œèº¬èº«å…¥å±€ï¼ŒæŒæ¡æç¤ºå·¥ç¨‹ã€RAG ç­‰æ–°æŠ€èƒ½ï¼Œå¹¶è­¦æƒ•å¯¹å·¥å…·çš„è¿‡åº¦ä¾èµ–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4a5f4be8545475ca43bb020544ca8d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=30hSO7ql%2FF%2F8dvN5BPKHhi27pgw%3D" alt="" loading="lazy"/></p>
<p>è”æƒ³è¯ºè°›æ™ºèƒ½é¦–å¸­æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ æ›¹æ´ªä¼Ÿ</p>
<p>è”æƒ³è¯ºè°›æ™ºèƒ½é¦–å¸­æ¶æ„å¸ˆã€è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ æ›¹æ´ªä¼Ÿï¼Œä»¥å…¶è·¨è¶Šä¸‰åå¹´çš„æŠ€æœ¯ç”Ÿæ¶¯ä¸ºèƒŒæ™¯ï¼Œåˆ†äº«äº†ã€Šå¤§æ¨¡å‹æ—¶ä»£ä¸‹çš„æŠ€æœ¯äººæˆé•¿ã€‹ã€‚ä»–æŒ‡å‡ºï¼ŒAI å¸¦æ¥çš„ä¸ä»…æ˜¯å·¥å…·å‡çº§ï¼Œæ›´æ˜¯å¯¹è½¯ä»¶å·¥ç¨‹å…¨æµç¨‹çš„é‡å¡‘ï¼Œä»éœ€æ±‚ã€è®¾è®¡åˆ°ç¼–ç ã€æµ‹è¯•å‡è¢«æ·±åˆ»å½±å“ã€‚è¿‡å»æŠ€æœ¯äººé€šè¿‡æŒæ¡æ–°è¯­è¨€ã€æ–°æ¡†æ¶è·å¾—çš„â€œç»éªŒçº¢åˆ©â€æ­£åœ¨å¤§æ¨¡å‹æ—¶ä»£åŠ é€Ÿè´¬å€¼ï¼Œç”±æ­¤ä»–æå‡ºæŠ€æœ¯äººæ–°æ—¶ä»£çš„â€œæ ¸å¿ƒç«äº‰åŠ›ä¸‰è§’â€ï¼šæ‰¹åˆ¤æ€§æ€ç»´ä¸è¯„ä¼°èƒ½åŠ›ã€è½¯æŠ€èƒ½ä¸é¢†å¯¼åŠ›ã€å·¥ç¨‹æ•´åˆä¸é¢†åŸŸçŸ¥è¯†ã€‚æœ€åæ›¹æ´ªä¼Ÿå»ºè®®ï¼ŒæŠ€æœ¯äººåœ¨ AI æ—¶ä»£è¦ä¿æŒè‡ªä¿¡ä¸å¥½å¥‡å¿ƒï¼Œèº¬èº«å…¥å±€ï¼Œäº²è‡ªåŠ¨æ‰‹ï¼Œå–„ç”¨ AIï¼Œä½†è¦çè§†å¹¶æ·±åŒ–ä¼ ç»Ÿå·¥ç¨‹èƒ½åŠ›ï¼Œæ›´ä¸è¦ä¸§å¤±äº²æ‰‹è°ƒè¯•ä»£ç çš„èƒ½åŠ›ï¼Œé¿å…æ²¦ä¸ºå¯è¢«æ›¿ä»£çš„â€œç›‘å·¥â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9978a3f45c3c497d9f3806d6be244601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=X5Z9V77VoKjJde8OIetfGCr%2FRes%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ åˆ˜æ­§</p>
<p>è…¾è®¯äº‘æ¶æ„å¸ˆåŒ—äº¬åŒç›Ÿç†äº‹ åˆ˜æ­§åœ¨ã€ŠAI æ—¶ä»£ï¼Œæˆ‘çš„çŸ­æ¿ä¸çŸ­ã€‹ä¸­ï¼Œä»¥è‡ªèº«ä» FFmpeg ä¸“å®¶åˆ° AI åˆ›ä¸šè€…çš„è½¬å‹ä¸ºä¾‹ï¼Œåˆ†äº«äº†å¦‚ä½•ç”¨ AI è¡¥é½â€œçŸ­æ¿â€ã€‚ä»–å¦è¨€è‡ªå·±ä¸æ“…é•¿UIå¼€å‘ã€å•†ä¸šè®¡åˆ’ä¹¦æ’°å†™ç­‰ï¼Œä½†é€šè¿‡å°† AI è§†ä¸ºâ€œä¼´ä¾£â€ï¼Œåˆ©ç”¨å…¶å®Œæˆ PPT åˆ¶ä½œã€æŠ€æœ¯æ–¹æ¡ˆç¾åŒ–ã€è‚¡æƒåè®®æ’°å†™ç”šè‡³ç”¨æˆ·å¢é•¿åˆ†æï¼Œä»è€Œè§£æ”¾è‡ªå·±ï¼Œèšç„¦äºé•¿æ¿ã€‚ä»–çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼šAI æ›¿ä»£ä¸äº†äººï¼Œä½†èƒ½å¸®åŠ©äººæˆä¸ºâ€œè¶…çº§ä¸ªä½“â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbeb00d88a4640028491a59dffd4e017~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=WXNvatcINeWFdWcUxaXRIZ7t56g%3D" alt="" loading="lazy"/></p>
<p>ç§‘æŠ€åšä¸»ã€æå…¶æ™ºèƒ½åˆ›å§‹äººã€ç•…é”€ä¹¦ä½œè€… SuperWinnieï¼ˆæ¨æ–‡æ¸ï¼‰</p>
<p>ç§‘æŠ€åšä¸»ã€æå…¶æ™ºèƒ½åˆ›å§‹äººã€ç•…é”€ä¹¦ä½œè€… SuperWinnieï¼ˆæ¨æ–‡æ¸ï¼‰åˆ†äº«äº†ã€ŠAI æ—¶ä»£çš„æŠ€æœ¯äººï¼Œå¦‚ä½•æ‰“é€ å¯å¤åˆ©çš„ä¸ªäººå“ç‰Œï¼Ÿã€‹ã€‚å¥¹ç»“åˆè‡ªèº«è¿è¥ç§‘æŠ€åšä¸»çš„ç»éªŒï¼Œæå‡ºæŠ€æœ¯äººæ‰“é€ ä¸ªäººå“ç‰Œçš„â€œæ–° IKIGAI æ¨¡å‹â€ï¼šä¸–ç•Œéœ€è¦çš„ã€ä½ æ“…é•¿çš„æŠ€æœ¯ã€ä»¥åŠä½ å°†å¤æ‚å˜ç®€å•çš„è¡¨è¾¾èƒ½åŠ›ï¼Œä¸‰è€…äº¤é›†å³ä¸ºæ–¹å‘ã€‚å¥¹è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ AI è¿›è¡Œé€‰é¢˜æŒ–æ˜ã€å†…å®¹è¡¨è¾¾ä¼˜åŒ–ï¼Œå¹¶å¼ºè°ƒåœ¨ AI ç”Ÿæˆå†…å®¹æ³›æ»¥çš„æ—¶ä»£ï¼Œä¸ªäººçš„çœŸå®æ•…äº‹ã€è§‚ç‚¹ä¸ä»·å€¼è§‚ï¼Œæ‰æ˜¯è„±é¢–è€Œå‡ºçš„å…³é”®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b80162f2faac4f2dbb0610eda1ea3824~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=rAf%2BsmpH%2B%2B%2Fd%2Bp2%2FW3z6cjpt9ho%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘ CodeBuddy æŠ€æœ¯è´Ÿè´£äºº æ¨è‹åš</p>
<p>è…¾è®¯äº‘ CodeBuddy æŠ€æœ¯è´Ÿè´£äºº æ¨è‹åšåœ¨ã€ŠCodeBuddy Code æ˜¯å¦‚ä½•åšåˆ° 90% ä»£ç ç”± AI ç”Ÿæˆçš„ã€‹ä¸­ï¼Œæ­ç¤ºäº†é«˜ä»£ç ç”Ÿæˆç‡èƒŒåçš„æ–¹æ³•è®ºã€‚ä»–æå‡ºä¸‰å¤§å®è·µåŸåˆ™ï¼šæ‹ŸäººåŒ–å“²å­¦ï¼ˆå°† AI å½“ä½œåŒäº‹è€Œéå·¥å…·ï¼‰ã€ç¬¬ä¸€æ€§åŸç†ï¼ˆå›å½’å·¥ç¨‹æœ¬è´¨ï¼‰ä¸é¢å‘ä¸ç¡®å®šç¼–ç¨‹ï¼ˆè®¾è®¡å®¹é”™ä¸æ¥ç®¡æœºåˆ¶ï¼‰ã€‚ä»–åˆ†äº«çš„æ¡ˆä¾‹è¡¨æ˜ï¼Œå½“ AI æˆä¸ºå¼€å‘â€œä¸»è§’â€æ—¶ï¼Œäººçš„è§’è‰²åº”è½¬å‘æ¶æ„è®¾è®¡ã€æ–¹å‘æŠŠæ§ä¸æœ€ç»ˆéªŒæ”¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/205e0b1f92994f828ec59981375d683c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060987&amp;x-signature=gijHRh5oLXmEK%2BQtfWyxVml65b4%3D" alt="" loading="lazy"/></p>
<p>ç¤¾åŒºå¹´åº¦ä¹‹é—®ï¼šä¸€çº¿ç¥å¸–ï¼Œå¤§å’–æ¥è§£</p>
<p>åœ¨éšåçš„ã€Šç¤¾åŒºå¹´åº¦ä¹‹é—®ï¼šä¸€çº¿ç¥å¸–ï¼Œå¤§å’–æ¥è§£ã€‹ç¯èŠ‚ä¸­ï¼Œå‡ ä½å˜‰å®¾å°±å¼€å‘è€…å…³å¿ƒçš„å…·ä½“é—®é¢˜è¿›è¡Œäº†æ·±å…¥äº¤æµã€‚å…³äºâ€œå¦‚ä½•å°† AI èå…¥ç°æœ‰ä¸šåŠ¡â€ï¼Œæ›¹æ´ªä¼Ÿå»ºè®®é‡‡ç”¨â€œæ¢é’ˆâ€æ–¹å¼ï¼Œä»å±€éƒ¨ã€ä½é£é™©åœºæ™¯åˆ‡å…¥ï¼Œç”¨æ•ˆæœå¯¹æ¯”èµ¢å¾—ä¿¡ä»»ã€‚é’ˆå¯¹â€œè¿‡åº¦ä¾èµ– AI å¯¼è‡´çŸ¥è¯†æ¨¡ç³Šâ€çš„æ‹…å¿§ï¼Œæ¨è‹åšè®¤ä¸ºåº”åˆ†æ¸…â€œæ€è€ƒè€…â€ä¸â€œæ‰§è¡Œè€…â€çš„ç•Œé™ï¼Œäººå¿…é¡»æŒæ§æ ¸å¿ƒé€»è¾‘ä¸æœ€ç»ˆå†³ç­–ã€‚å¯¹äºâ€œä¸ªäººå“ç‰Œåˆ›ä½œâ€ï¼Œæ¨æ–‡æ¸åˆ†äº«äº†åˆ©ç”¨ AI æŠ“å–å…³é”®è¯é‡ç»„é€‰é¢˜ã€å¹¶ç”¨äººæ€§åŒ–è¡¨è¾¾â€œå‡ºåœˆâ€çš„æŠ€å·§ã€‚æœ€åï¼Œå…³äºâ€œæ¶æ„å¸ˆçš„éæŠ€æœ¯èƒ½åŠ›â€ï¼Œåˆ˜æ­§ä¸æ›¹æ´ªä¼Ÿå‡å¼ºè°ƒäº†æ²Ÿé€šä¸å…±èµ¢æ€ç»´çš„é‡è¦æ€§ï¼ŒæŒ‡å‡ºæŠ€æœ¯æ–¹æ¡ˆæ¨åŠ¨éœ€ä¸å„æ–¹åˆ©ç›Šå¯¹é½ã€‚</p>
<h2 data-id="heading-4"><strong>ç»“è¯­</strong></h2>
<p>ä¸€å¤©çš„å³°ä¼šï¼Œä»å®è§‚è¶‹åŠ¿åˆ°äº§ä¸šå®è·µï¼Œä»ä¸ªä½“è¿›åŒ–åˆ°ç³»ç»Ÿé‡æ„ï¼Œæç»˜å‡º AI æµªæ½®ä¸‹æŠ€æœ¯ç”Ÿæ€çš„ç”ŸåŠ¨å…¨æ™¯ã€‚å¯¹äºæ¶æ„å¸ˆå’Œå¼€å‘è€…è€Œè¨€ï¼ŒæŒ‘æˆ˜ä¸æœºé‡å¹¶å­˜ã€‚ä¸€æ–¹é¢ï¼Œæ—§æœ‰ç»éªŒåŠ é€Ÿè´¬å€¼ï¼Œå•çº¯å †ç ŒæŠ€æœ¯å·²ä¸è¶³ä»¥æ„å»ºæŠ¤åŸæ²³ï¼›å¦ä¸€æ–¹é¢ï¼Œç†è§£ä¸šåŠ¡æœ¬è´¨ã€æå‡ºç²¾å‡†é—®é¢˜ã€è¿›è¡Œä»·å€¼åˆ¤æ–­ã€æ„å»ºç³»ç»Ÿæ€ç»´çš„èƒ½åŠ›å˜å¾—ç©ºå‰é‡è¦ã€‚</p>
<p>ä¹Ÿå¦‚å¤šä½åˆ†äº«å˜‰å®¾æ‰€è¨€ï¼ŒæŠ€æœ¯çš„å‘å±•ä»æ¥ä¸æ˜¯å•æ‰“ç‹¬æ–—ã€‚åœ¨â€œæ™ºæ•ˆè·ƒè¿â€çš„å¾é€”ä¸Šï¼Œå”¯æœ‰äº¤æµæ‰èƒ½æé€Ÿï¼Œå”¯æœ‰å…±åˆ›æ‰èƒ½å…±èµ¢ã€‚å½“æ¶æ„çš„è¾¹ç•Œè¢« AI é‡æ–°å®šä¹‰ï¼Œä¸€ç¾¤äººçš„åŒè¡Œï¼Œæˆ–è®¸èƒ½è®©æˆ‘ä»¬èµ°å¾—æ›´è¿œï¼Œçœ‹å¾—æ›´æ¸…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç²¾é€š Rust å® â€” å®ç°å¯å˜å‚æ•°ä¸å®å±•å¼€]]></title>    <link>https://juejin.cn/post/7603267434501668879</link>    <guid>https://juejin.cn/post/7603267434501668879</guid>    <pubDate>2026-02-06T01:34:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603267434501668879" data-draft-id="7599708108622266419" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç²¾é€š Rust å® â€” å®ç°å¯å˜å‚æ•°ä¸å®å±•å¼€"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2026-02-06T01:34:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç²¾é€š Rust å® â€” å®ç°å¯å˜å‚æ•°ä¸å®å±•å¼€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:34:12.000Z" title="Fri Feb 06 2026 01:34:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body ::selection{color:#fff;background-color:#ed7373}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:.6em;margin-top:1.5em;padding-bottom:4px;color:#ed7373}.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5,.markdown-body h6{font-size:14px}.markdown-body p{line-height:inherit;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border-top:1px solid #dfe1e6;margin:33px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:rgba(239,198,221,.2666666667);color:#7b164f;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==") 10px 10px no-repeat;background-size:40px;background-color:#fdf8f8}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#fdf8f8}.markdown-body a{position:relative;text-decoration:underline;text-decoration-color:#ffd4d4;color:#ed7373;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAAD1lJREFUeF7tnV122zgShQHJG5gT9/OkV2J7JR3voI/U707eI5/eQeyVRFlJa56nc2YDFjkHEulWHP3g5xZYAK5eku6QYOFWfSwUAJLW8EcFqMBJBSy1oQJU4LQCBITRQQXOKEBAGB5UgIAwBqhAnALMIHG68axGFCAgjTia3YxTgIDE6cazGlGAgDTiaHYzTgECEqcbz2pEAQLSiKPZzTgFCEicbjyrEQUISCOOZjfjFCAgcbrxrEYUICCNOJrdjFOAgMTpxrMaUYCANOJodjNOAQISpxvPakQBAtKIo9nNOAUISJxuPKsRBQhII45GdfN/v//+/l9//rlBtae9HQKi3UOZ7ft7sfhgjfm3sfa9u3RvzHtrjPv77r8PfpvemB0o1v3Z95tuNvt29fKyqQkgApI5ADVebgeFtTfGmA8I+3pj1rbv17Ouey4dFgKCiIgC2/i+WDwYax0QbzMDtDcjLC67/PL58xraeIbGCEgGkTVd4vty+QWVKUL75WCZb7f3JWUVAhLq5UKPHzLGRyXmP822208lgEJAlESMlBlDfeGyhsafelAIiMawAdjkpmO38/kXa8wtoDnRJvq+v79+fHwSvUhk4wQkUjjNp/33jz9uZ33/VbONP9nW9x/fPT5+0mYzAdHmkUR7lNUaob1RN+QiIKEuVHz838vl1xKGVOck1DbTRUAUB7yvaSXVG5592sy22zsNs1wExNNjWg+rEI5XqWfb7a9TQ0JAtEa+h101wzF0f/JMQkA8AlHjIQ3AMco+KSQERGP0X7CpITj2Skw4BUxACgOkOThG/0wECQEpCJBm4Rh81Fl7l3tHMAEpBJCJ4Hjq+/7bvOt229THGSVny8vV1W6b/Kzrbnprb088VAVXN/fMFgGBuxDfYE443L4oB0TM9OqwxcVtjJR7xiTzUIuA4OMZ2mI2OICBN+wgfpACJWcWISDQcMY2lgMOt7XjerW6w1q+b03sqUUgzJf6TUAuKTTRv+eAI8f0qdSwK1cWISATAXDusjngyDkj5PrTzedu+z2uNsmURQiIMkBqg2OUVwKSHFmEgCgCpFY4xCDJkEUIiBJAaodjlBlZuEtOMIz2EhAFgLQCxxtIIG9YkR5mEZCJAWkNjldIlsu/EEW79AsfCMiEgLQKx8EaCSKLPL1bre6l3EhApJS90G7LcKCziOQwi4BMAAjh+GGlPTmLSK7pEJDMgBCOfwRHvb9Lsg4hIBkBIRw/i/0dUawLrocQkEyAEI7jQoPeNi9WqBOQDIAQjtMig16uTUAyxLHIJQjHeVkRdYjkijoziAgW+0YJx2VxEYAYYzbvVqtfL18t/AgCEq6Z1xmEw0um3U2km8/dqnrS791qJRLLIo0m9bSCkwmHvxNBgDCD+Es+7ZGEI0x/DrHC9Cr6aMIR7j7ELBaL9HDds59BOOIkB33wh9O8cfLnOYtwxOsM+egPV9LjHSB9JuFIU/j7ctmntSD7cmvOYiV6B3IHPGOD5E7VxK4nnw4q0A03Kya7QqYBwpGmK6j+MFJrIK53zCCRPgZtsjt59Zozh+s0aP3DNSW2BkJAIuFATE2eu3TtcLi+w24wggU6AYkABDVuPnXpFuAAZg8jrReHWAGQIB177LLSzg7oqtih4Dcsig6vmEECw0CyKG8BDic3VEPh4RUBCQAENePSaubY1R2LxYOxNvklDa8aEpCACBY+FLKgdcTGZjLHYvHBWuu+PoX6iQ+vmEE8XQW/8w3XJRyeDjhymOTi4OHlWKRf8JFUYU444uGQXvsgIAG+kcgesXAM6y83/fAhGtv36242+5b708i+8kmtF+XKHhxiTZA9YuDwCLSn2Xb7KebLtL7BHnqch82hTY7HZ6k9xotxiHXGTejsEQXHcvnVGnPrEU2b2XZ7pwESQTjEFwbf6kxAzgGCeOvf2H7ElGQMoDmHH8ekk4RD8snBU2FAQE4oAy7Og594S7p+BIweGeriIZJw5CzMWaRfdDV0UStqzByTPX7oVt9/nHXdc64hV41wsEjPMLyKqTucWZAtGZkyiTAc2esOZpBMs1cpY2bIW89dP4UhkYZj6pqKNcgRWFBb2lO+fAQDxBiTYse5e4k0HMaY4NrNY/QcdAgBOSJX8vjf3biNWV+vVndB3jg4GPZA0b5N+BSwNByp+sXqzmleD+UQgMTWHqN5AgEIg0TAtrdemTxzjAYxgxzLIMul23X6wYOlU4dEzVy9bQw5zNq1DahHpOGYuuZgBvGI+uQZJEAgOjOHWsjB+t7DbK9DUgIQkVnPGZmadb0ECDyIGeR4Bkl6mRnS0WhIYsf2LcLhQoOACACCfk8T+Dnu4BetJa3qe9yxkTcUj8sFHUJAjgPiPugSO6yB1B9vzUJCEppFBLPHprP2Xut2fWaQE/eSxOJYBJDR1ETbXnscUosk12THdVYPBwE5AUhiQIgCAswk3tO+As/ji2oUNIa6cDCHWOBp3tDhS4wzUZD4ZhEkIDn0idH01DkEBAyIaw5dpB9zHqgu8FqQgw3rEncXIAPft60qAXF32JRt3qnBJ7X36a1TUwPX926O2Pbiey3fwM11XBWADGsFv5n9o6m72SfnkJ2Iff98/fj4FCJo6mpxrmnLVJCdJj4wp+pRKhxVFOmeBXXwSw2S7s6glXQfqJPs3N0/+nufG0jCdbyGcT59neKYYjNIxKfPvGdtnCM8wTvpM587M8LhgOGPVwDHTAz4wofQQaqNIgGJgGOvX8CdPXVYEXKtFOcm2+k5zHI2hmx7yTXMTNHO59ziAEne9uAJCeChqaCM5eOsY8cA7PSqQw6vPWSt13rvjV1PnbXPmlfHQ7QuChBEMIQUjAnj7uCMFeI09GxW7N1+54+uuxkmRf4z77p1yuxhigZS5xYDCAKOUUTfdQrELFGOoVZqvRQLiFRQamq3CECQcPhObY5OSs4iATNFsYGRamMNxXSsdpfOUw8IGg4nSMgdE5JFhCEhIJfCPP7fVQOCmKE5Ik3wRrnUABxtkLpTJ9vnOXERH2blnqkWECE4ot42gsoiodnLN6wAmwm91kJ87anpOJWAABa/Tvso8m6ZfJf+xyLo9G/ytPduCqr/+O7x8VNNgY3qizpAROEwJnh4NQodskh20TnAgITUaEB7Lva9sANUAZI6XXlB++Q7N3KohdqKgrApZNKisPhONlcNIMJwBM1cnVMVEZDIWgShGwrW5GhU2IAKQBBOPqct+g4JqUcAwxpI/ZHpAS+Fse9l0qSARG869Ora/iA0HK7NmJ2tP5kMAASUzaLrsgA3FHvopICUljkOvZwKCQJcRCYL2ZtWbJQnGD4ZICXDMeo93MHdO3yD36Hlux/slG8hs1ec4r2IziSAgIYGJzuHuDtfVG44IGr6FzG8An1gNKdWvppqOi47ILA73wkVp3B4ICTJY37gDSbZFk3BLGFLVkBQsy6nhJgCjtEWn5oEMd6HagjIZBJBqanNbIBAHXtEwSnhODRn2EP2MPy/sTaBPWWHrN20aKYJiLe2ZANEcguJVkenvp/rrbOQcEz13XHNMByzLQsgktlDKxzoQADWHXvTOLzyclEWQMB3vteOtQKHxNZ/bi/x4kP+AzpS2YNw+Dn46FHMHt7iiWcQiexBOLz9e+xATu0GyCcKiMSaB+EI8O6xQ5k9ggQUBQSxV+iwN4QjyLfMHslyCX7EE157NHLnkyjIxziRemkEIA7VNiGWQcDTkk28VEAUjgI/XqOBGjFAgMV5E0WlJBxcFIxHTQQQ5PCqhbpDGo7ZdntX2ztz40M+7EwRQICzV9VnD2E4RJ6oDAuxso8WAQRVf9S+2isNB4vydDhlAFku+3TT4t9hBbi2eBPScBhjmpjYkHaUXkAqntaVhgPx3Il04JXSPhwQVIFe6/CKcJSCxt5OrYBUWZwTjrLgEAEEMYNV4xCBcJQHhwggoECoqsAEaXIywmq8oWjBCT7EgkzxVlSgEw4toR5nBwGJ083rLMLhJZPqg/CALJdfjDHubYPxvwoyCOGId7+mM+GAgAKj6BoEpAFrDgWkqASk5KKTcCiIaqAJcEBanuYlHMDIVNIUHJBWV9IJh5KIBpsBB8TZB/gssSlpJyrhAEelouakAPkr5psZb3QpolAnHIqiWcAUEUBQj9tq37BIOAQiUlmTMoAsFh+stW49JO2neD2EcKS5tpSzRQBBzGSNAmrMIoSjlPBOt1MEkKFQR9Qh6t5CTjjSg66kFiQBSd9yMiqpZKhFOEoKbYytYoAgh1muq1MPtQgHJuBKa0UMEOgwa6/qZqr3OxGO0sIaZ68sIIvFg7H2I87c/JBAnm85I0DJ+86AflXblCggAlkkayZBreec8j7hUMvFq2HygOCzyM54ya0obj/Zdj7/Yo25lXIh4ZBSFtuuOCBCWWQPiTHr+XZ7j3zvrHS9Mdp9vVrdYV3J1iQUyAOIUBY5EORptt1+SgFlAMN933z8trmE3juoCYeItCKNZgFEMoscquKCz/b9etZ1zz6wDFDcmP1QShQMZg6R+BVvNBsgw7qIWzwUD8RBtU1vzMb93Q5/DkH63u5tyGXH63CQmUM8nuEXyAbILovID7XgAiEa5LAKoeI0bWQFpEVICMc0gY26anZActUjKIFS2iEcKerpOHcSQIbn1r/mrgNySk44cqotd61JAHHdqRkSwiEXsLlbngwQ19EJZrbE9SUc4hJnvcCkgFQHiZLnVrJGUOUXmxyQUV/pjYHSfmzhc9XSGmpsXw0gBU8Bbzpr73/5/Hmt0cG0KU0BVYAcQOLeDp91pTtGRtYbMaqVdY46QMa6xPb9g+R282Q3sd5IlrCEBlQCMgqndJariDc+lhB8JdioGpDXAn7/IjrxregXHJa8pb6EgKCNPypQBCATg0IwGqamKEB+GHp13U1v7a3Q1vWnvu+/XT8+PjUcG+z6/lGJ8n+uVhmK+nHmK2QGzD0zsnZAzLtu7fOgVfmKsQe+ClQByLHOur1eL1dXO1Bs170C089mm6uXl92DVITBN0zaPa5aQNp1KXuOVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFTg//8JNVC78ovQAAAAAElFTkSuQmCC");background-size:100%}.markdown-body a:active,.markdown-body a:hover{opacity:.66}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #ed7373;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#ed7373}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#fdf2f2}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #ed7373;background-color:#fdf2f2}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ed7373}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]{appearance:none;-webkit-appearance:none;-moz-appearance:none;outline:none;width:16px;height:16px;border-radius:2px;background-color:transparent;box-shadow:inset 0 0 0 1px rgba(28,31,35,.3490196078);vertical-align:middle;margin:0;transform:translateY(-2px)}.markdown-body input[type=checkbox]:checked{background-color:#ed7373;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjFlbSIgaGVpZ2h0PSIxZW0iIGFyaWEtaGlkZGVuPSJ0cnVlIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjQxMSA3LjMwOGExLjUgMS41IDAgMDEuMjggMi4xMDNsLTYuNSA4LjVhMS41IDEuNSAwIDAxLTIuMzc1LjAxbC0zLjUtNC41YTEuNSAxLjUgMCAxMTIuMzY4LTEuODQybDIuMzA2IDIuOTY1IDUuMzE4LTYuOTU1YTEuNSAxLjUgMCAwMTIuMTAzLS4yOHoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=");box-shadow:inset 0 0 0 1px #ed7373}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><h2 data-id="heading-0">å¯å˜å‚æ•°</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2a620a66e024ef5abf63975de622a4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770946452&amp;x-signature=mvtf1%2FTpKDvz3r0S%2BtvTPS3g20k%3D" alt="0.png" loading="lazy"/></p>
<p>å½“æˆ‘ä»¬é‡åˆ°å‡½æ•°çš„èƒ½åŠ›ç“¶é¢ˆæ—¶è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>æ¯”å¦‚ï¼Œä¸ Java ä¸åŒï¼ŒRust å¹¶ä¸æ”¯æŒå‡½æ•°çš„å¯å˜å‚æ•°ã€‚</p>
<p>å¯èƒ½æ˜¯å› ä¸ºå¯å˜å‚æ•°ä¼šå¢åŠ ç¼–è¯‘å™¨çš„å®ç°éš¾åº¦ï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºå®ƒå¹¶éä¸€ä¸ªè¶³å¤Ÿé‡è¦çš„ç‰¹æ€§ã€‚</p>
<blockquote>
<p>å½“ç„¶ä»¥åæ€ä¹ˆè¯´è¿˜çŠ¹æœªå¯çŸ¥ï¼Œè‡³å°‘ç›®å‰ Rust æ˜¯ä¸æ”¯æŒå¯å˜å‚æ•°çš„ã€‚<br/>
å…³äºæ˜¯å¦è¦åœ¨ Rust ä¸­åŠ å…¥å¯å˜å‚æ•°çš„è®¨è®ºç”±æ¥å·²ä¹…ï¼Œè€Œä¸”äº‰è®®æå¤§ï¼ˆé»˜è®¤å‚æ•°ä¹Ÿæ˜¯å¦‚æ­¤ï¼ï¼‰</p>
</blockquote>
<p>é‚£ä¹ˆï¼Œå¦‚æœä½ ç¡®å®éœ€è¦å¯å˜å‚æ•°æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>å®æ€»æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¦‚æœçœ‹äº†ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬çš„ <code>my_vec</code> å®å°±å®ç°äº†è¿™ä¸€ç‚¹ï¼šä½ å¯ä»¥ä¼ å…¥ä»»æ„æ•°é‡çš„å‚æ•°ï¼ŒRust ä¼šç”Ÿæˆå¯¹åº”çš„å¤„ç†ä»£ç ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä»æ”¯æŒå‡½æ•°é‡è½½æˆ–é»˜è®¤å‚æ•°çš„è¯­è¨€è½¬åˆ° Rustï¼Œå®åŒæ ·èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ‰“æ‹›å‘¼çš„å‡½æ•°ï¼Œå¸Œæœ›å®ƒé»˜è®¤ä½¿ç”¨ â€œHelloâ€ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè‡ªå®šä¹‰é—®å€™è¯­ã€‚</p>
<p>æˆ‘ä»¬å½“ç„¶å¯ä»¥åˆ›å»ºä¸¤ä¸ªåå­—ç¨æœ‰ä¸åŒçš„å‡½æ•°æ¥å¤„ç†è¿™ä¸¤ç§æƒ…å†µï¼Œä½†åŠŸèƒ½ç›¸åŒå´è¦èµ·ä¸åŒçš„åå­—ï¼Œè¿™å¤šå°‘æœ‰ç‚¹éº»çƒ¦ï¼Œå†è€…è¯´ï¼Œå¦‚æœå‚æ•°å˜å¤šäº†ï¼Œä½ å²‚ä¸æ˜¯è¦å–å¥½å‡ ä¸ªè¿™æ ·çš„å‡½æ•°ï¼Ÿ</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ª<code>greeting</code>å®ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">base_greeting_fn</span>(name: &amp;<span class="hljs-type">str</span>, greeting: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}, {}!"</span>, greeting, name)
}

<span class="hljs-built_in">macro_rules!</span> greeting {
    ($name:literal) =&gt; {
        <span class="hljs-title function_ invoke__">base_greeting_fn</span>($name, <span class="hljs-string">"Hello"</span>)
    };
    ($name:literal, $greeting:literal) =&gt; {
        <span class="hljs-title function_ invoke__">base_greeting_fn</span>($name, $greeting)
    };
}
</code></pre>
<p>ç¨ç­‰ä¸€ä¸‹ï¼Œè¿™æ¬¡æˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹ä»£ç â€”â€”æŠŠå®ç°ä»£ç å’Œä¸»å‡½æ•°åˆ†å¼€å­˜æ”¾ã€‚</p>
<p>è¿™ä¸ªå®è¢«æ”¾åœ¨å•ç‹¬çš„<code>greeting.rs</code>æ–‡ä»¶ä¸­ã€‚</p>
<p>å¦‚æœè¦åœ¨å®šä¹‰å®çš„æ–‡ä»¶ä¹‹å¤–ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code>main</code>ä¸­æ·»åŠ çš„æ¨¡å—å£°æ˜ä¸Šæ–¹åŠ ä¸Š<code>#[macro_use]</code>ã€‚</p>
<p>åœ¨ <code>main.rs</code> ä¸­ä½¿ç”¨ <code>greeting</code> å®ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> crate::greeting::base_greeting_fn;    <span class="hljs-comment">// #1</span>

<span class="hljs-meta">#[macro_use]</span>
<span class="hljs-keyword">mod</span> greeting;    <span class="hljs-comment">// #2</span>

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">greet</span> = greeting!(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, greet);    <span class="hljs-comment">// #3</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">greet_with_default</span> = greeting!(<span class="hljs-string">"Sam"</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, greet_with_default);    <span class="hljs-comment">// #4</span>
}
</code></pre>
<p><strong>#1</strong> å¯¼å…¥åŸºç¡€å‡½æ•° <code>base_greeting_fn</code><br/>
<strong>#2</strong> å¯¼å…¥åŒ…å«å®çš„æ¨¡å—ã€‚é€šè¿‡<code>#[macro_use]</code>æ³¨è§£ï¼Œæˆ‘ä»¬å‘Šè¯‰ Rust å¸Œæœ›å¯¼å…¥è¯¥æ–‡ä»¶ä¸­å®šä¹‰çš„å®<br/>
<strong>#3</strong> è¾“å‡ºï¼š<code>Heya, Sam!</code><br/>
<strong>#4</strong> è¾“å‡ºï¼š<code>Hello, Sam!</code></p>
<p>åœ¨æ›´å¤æ‚çš„é¡¹ç›®ç»“æ„ä¸­ï¼ˆæ¯”å¦‚é€šè¿‡ <code>mod.rs</code> å¯¼å…¥å’Œé‡å¯¼å‡ºæ¨¡å—ï¼‰ï¼Œä½ éœ€è¦åœ¨â€œæ ¹æ–‡ä»¶â€ï¼ˆæ¯”å¦‚<code>main.rs</code>ï¼‰å’Œæ‰€æœ‰è´Ÿè´£é‡å¯¼å‡ºçš„<code>mod.rs</code>ä¸­éƒ½æ·»åŠ è¿™ä¸ªæ³¨è§£ã€‚</p>
<p>ä¸è¿‡åˆ«æ‹…å¿ƒï¼šRust ä¼šä¸€ç›´æç¤ºä½ â€œæ˜¯å¦åœ¨æ¨¡å—/å¯¼å…¥ä¸Šæ·»åŠ äº† <code>#[macro_use]</code>ï¼Ÿâ€ï¼Œç›´åˆ°ä½ æŠŠæ‰€æœ‰éœ€è¦çš„åœ°æ–¹éƒ½è¡¥å…¨ã€‚</p>
<p>è¿™æœ‰æ—¶å¯èƒ½æœ‰ç‚¹ç¹çï¼Œä½† Rust å°±æ˜¯è¿™æ ·â€”â€”é™¤éæ˜¾å¼å…¬å¼€å¦åˆ™é»˜è®¤ç§æœ‰ï¼Œè¿™ç§è®¾è®¡ç¡®å®ä¼šè®©ä½ æ›´æ³¨é‡ä¿¡æ¯éšè—çš„åˆç†æ€§ã€‚</p>
<p><em>ç›¸åï¼Œçœ‹çœ‹ Kotlin çš„é»˜è®¤å…¬å¼€ï¼Œä¹Ÿè¢«è¯Ÿç—…ä¸å°‘ï¼</em></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠ <code>base_greeting_fn</code> è®¾ä¸ºå…¬å…±å‡½æ•°ï¼ˆå¹¶å¯¼å…¥åˆ° <code>main.rs</code> ä¸­ï¼‰ã€‚</p>
<p>åŸå› å¾ˆç®€å•ï¼šå£°æ˜å¼å®æ˜¯åœ¨ <code>main</code> å‡½æ•°ä¸­å±•å¼€çš„ï¼Œå±•å¼€åä¼šå˜æˆè¿™ä¸ªå‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¹Ÿå¿…é¡»å¯¼å…¥åˆ° <code>main.rs</code> ä¸­ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨è„‘æµ·ä¸­æŠŠå®è°ƒç”¨æ›¿æ¢æˆå®å®šä¹‰é‡Œçš„ä»£ç ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>greeting!("Sam", "Heya")</code> ä¼šè¢«æ›¿æ¢ä¸º <code>base_greeting_fn("Sam", "Heya")</code>ã€‚</p>
<p>å¦‚æœ <code>base_greeting_fn</code> ä¸æ˜¯å…¬å…±çš„ï¼Œä½ å°±ä¼šè°ƒç”¨ä¸€ä¸ªæœªå®šä¹‰çš„å‡½æ•°ã€‚</p>
<p>ä½ å¯èƒ½ä¼šè§‰å¾—è¿™æ ·å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œä½†ï¼Œè¿™å°±æ˜¯ Rust ä¸­å®ä¸å¯è§æ€§è§„åˆ™å…±åŒä½œç”¨çš„å¿…ç„¶ç»“æœã€‚</p>
<h2 data-id="heading-1">å®å±•å¼€</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59b225641e56444ea5e7b4b5dbf796e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770946452&amp;x-signature=I4qtNsbwwAam0rR%2Bb1ocjIqPq%2Fw%3D" alt="1.png" loading="lazy"/></p>
<p>æ­¤åˆ»ï¼Œæˆ‘ä»¬å…ˆæš‚åœä¸€ä¸‹ï¼ŒèŠèŠâ€œå±•å¼€â€â€”â€”ä¹Ÿå°±æ˜¯â€œç”¨è½¬æ¢å™¨ä¸­çš„å†…å®¹æ›¿æ¢å®è°ƒç”¨â€çš„å®˜æ–¹æœ¯è¯­ã€‚</p>
<p>è™½ç„¶åœ¨æˆ‘ä»¬è‡ªå·±è„‘å­é‡Œæ¨¡æ‹Ÿæ›¿æ¢è¿‡ç¨‹å¾ˆæœ‰ç”¨ï¼Œä½†æœ‰æ—¶ä½ å¸Œæœ›çœ‹åˆ°å®é™…å‘ç”Ÿçš„ä»£ç è½¬æ¢ã€‚</p>
<h3 data-id="heading-2">trace_macros</h3>
<p>ä¸ºäº†æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼ŒRust æä¾›äº†ä¸€ä¸ªå¾ˆæ£’çš„åŠŸèƒ½ï¼š<code>trace_macros</code>ï¼ˆå®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå£°æ˜å¼å®ï¼Œå¯è°“æ˜¯â€œå¥—å¨ƒâ€åˆ°åº•äº†ï¼‰ã€‚</p>
<p>æˆ‘åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ŒRust çš„æœ€æ–°ç¨³å®šç‰ˆä¸º 1.90.0ï¼Œè¯¥ç‰ˆæœ¬ä¸­è¿™ä¸ªåŠŸèƒ½ä»å¤„äºä¸ç¨³å®šçŠ¶æ€ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯å¹¶ä½¿ç”¨ nightly ç‰ˆæœ¬è¿è¡Œä»£ç ã€‚</p>
<ol>
<li>å…ˆè¿è¡Œ <code>rustup install nightly</code>ã€‚</li>
<li>ç„¶åè¿è¡Œ <code>cargo +nightly run</code>ã€‚</li>
</ol>
<p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å¼€å¯å’Œå…³é—­<code>trace_macros</code>åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#![feature(trace_macros)]</span>    <span class="hljs-comment">// #1</span>

<span class="hljs-keyword">use</span> crate::greeting::base_greeting_fn;

<span class="hljs-meta">#[macro_use]</span>
<span class="hljs-keyword">mod</span> greeting;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    trace_macros!(<span class="hljs-literal">true</span>);    <span class="hljs-comment">// #2</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_greet</span> = greeting!(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_greet_with_default</span> = greeting!(<span class="hljs-string">"Sam"</span>);
    trace_macros!(<span class="hljs-literal">false</span>);    <span class="hljs-comment">// #3</span>
}
</code></pre>
<p><strong>#1</strong> å¯ç”¨ <code>trace_macros</code> åŠŸèƒ½<br/>
<strong>#2</strong> å¼€å¯å®è¿½è¸ª<br/>
<strong>#3</strong> å…³é—­å®è¿½è¸ª</p>
<p>è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰çš„ä»£ç ï¼Œåªæ˜¯å»æ‰äº† <code>println!</code> è¯­å¥å¹¶æ·»åŠ äº† <code>trace_macros!</code> è°ƒç”¨ã€‚</p>
<p>ä¼ å…¥ <code>true</code> æ—¶å¼€å¯è¿½è¸ªï¼Œä¼ å…¥ <code>false</code> æ—¶å…³é—­ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå…¶å®å…³é—­å¹¶éå¿…é¡»ï¼Œå› ä¸ºç¨‹åºè¿è¡Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ã€‚</p>
<p>è¿è¡Œè¿™æ®µä»£ç ä¼šè¾“å‡ºç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">note:</span> trace_macro
  --&gt; src\main.rs:<span class="hljs-number">10</span>:<span class="hljs-number">17</span>
   |
<span class="hljs-number">10</span> |     <span class="hljs-keyword">let</span> greet = greeting!(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span>);
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^
   |
   = note: expanding `greeting! { <span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span> }`
   = note: <span class="hljs-keyword">to</span> `base_greeting_fn(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span>)`

<span class="hljs-symbol">note:</span> trace_macro
  --&gt; src\main.rs:<span class="hljs-number">11</span>:<span class="hljs-number">30</span>
   |
<span class="hljs-number">11</span> |     <span class="hljs-keyword">let</span> greet_with_default = greeting!(<span class="hljs-string">"Sam"</span>);
   |                              ^^^^^^^^^^^^^^^^
   |
   = note: expanding `greeting! { <span class="hljs-string">"Sam"</span> }`
   = note: <span class="hljs-keyword">to</span> `base_greeting_fn(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Hello"</span>)`
</code></pre>
<p>æ—¥å¿—æ¸…æ™°å±•ç¤ºäº†é»˜è®¤å€¼çš„å·¥ä½œåŸç†ï¼š<code>greeting!("Sam")</code> è¢«è½¬æ¢æˆäº† <code>base_greeting_fn("Sam", "Hello")</code>ã€‚</p>
<p>æ˜¯ä¸æ˜¯å¾ˆå·§å¦™ï¼Ÿ<code>trace_macros</code> ç°åœ¨ç»™æˆ‘ä»¬å±•ç¤ºäº†å…¶å®çš„æ›¿æ¢å·¥ä½œï¼Œçœå»äº†ä¸å°‘æˆ‘ä»¬è‡ªå·±æ€è€ƒæ›¿æ¢è¿‡ç¨‹çš„è„‘åŠ›ã€‚</p>
<h3 data-id="heading-3">log_syntax</h3>
<p>å¦ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·æ˜¯ <code>log_syntax!</code> å®ï¼ˆåœ¨ 1.90.0 ä¸­åŒæ ·ä¸ç¨³å®šï¼‰ï¼Œå®ƒå…è®¸ä½ åœ¨ç¼–è¯‘æœŸè®°å½•æ—¥å¿—ã€‚</p>
<p>å¦‚æœä½ ä¹‹å‰æ²¡å†™è¿‡å®ï¼Œå¯èƒ½ä¸ä¼šæ„è¯†åˆ°è¿™æœ‰ä»€ä¹ˆé‡è¦æ€§ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>greeting</code> å®æ·»åŠ ç¬¬ä¸‰ä¸ªåˆ†æ”¯ã€‚</p>
<p>è¿™ä¸ªåˆ†æ”¯ä¼šç”¨ <code>log_syntax</code> è®°å½•æ”¶åˆ°çš„å‚æ•°ï¼Œç”¨ <code>println!</code> æç¤ºè¿”å›äº†é»˜è®¤é—®å€™è¯­ï¼Œç„¶åå†è°ƒç”¨ <code>base_greeting_fn</code>ã€‚</p>
<p>æ‰€æœ‰è¿™äº›ä»£ç éƒ½è¢«åŒ…è£¹åœ¨é¢å¤–çš„ä¸€å¯¹å¤§æ‹¬å·é‡Œï¼Œè¿™æ˜¯å› ä¸ºå®å¿…é¡»è¿”å›ä¸€ä¸ªå•ç‹¬çš„è¡¨è¾¾å¼ï¼Œæ‰èƒ½ç»‘å®šåˆ° <code>let</code> å˜é‡ä¸Šã€‚</p>
<p>é€šè¿‡æ·»åŠ è¿™å±‚æ‹¬å·ï¼Œæˆ‘ä»¬æŠŠä¸¤æ¡è¯­å¥å’Œä¸€ä¸ªè¡¨è¾¾å¼å°è£…æˆäº†ä¸€ä¸ªæ•´ä½“ã€‚</p>
<p>ä½¿ç”¨ <code>log_syntax</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-built_in">macro_rules!</span> greeting {
    ($name:literal) =&gt; {
        <span class="hljs-title function_ invoke__">base_greeting_fn</span>($name, <span class="hljs-string">"Hello"</span>)
    };
    ($name:literal, $greeting:literal) =&gt; {
        <span class="hljs-title function_ invoke__">base_greeting_fn</span>($name, $greeting)
    };
    (test $name:literal) =&gt; {{    <span class="hljs-comment">// #1</span>
        log_syntax!(<span class="hljs-string">"The name passed to test is: {}"</span>, $name);    <span class="hljs-comment">// #2</span>
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Returning default greeting"</span>);
        <span class="hljs-title function_ invoke__">base_greeting_fn</span>($name, <span class="hljs-string">"Hello"</span>)
    }};
}
</code></pre>
<p><strong>#1</strong> ä½¿ç”¨åŒå±‚å¤§æ‹¬å·ï¼Œè®©ç”Ÿæˆçš„ä»£ç è¢«<code>{}</code>åŒ…è£¹ï¼Œä»è€Œç¡®ä¿è¾“å‡ºæ˜¯ä¸€ä¸ªå•ç‹¬çš„è¡¨è¾¾å¼<br/>
<strong>#2</strong> ä½¿ç”¨<code>log_syntax!</code>è®°å½•è¾“å…¥å‚æ•°</p>
<p>åœ¨ä¸»æ–‡ä»¶ä¸­ï¼Œä»£ç å˜åŒ–ä¸å¤§ï¼Œåªæ˜¯å¤šå¯ç”¨äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œå¹¶æ·»åŠ äº†å¯¹å®ç¬¬ä¸‰ä¸ªåˆ†æ”¯çš„è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#![feature(trace_macros)]</span>
<span class="hljs-meta">#![feature(log_syntax)]</span>    <span class="hljs-comment">// #1</span>

<span class="hljs-keyword">use</span> crate::greeting::base_greeting_fn;

<span class="hljs-meta">#[macro_use]</span>
<span class="hljs-keyword">mod</span> greeting;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    trace_macros!(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_greet</span> = greeting!(<span class="hljs-string">"Sam"</span>, <span class="hljs-string">"Heya"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_greet_with_default</span> = greeting!(<span class="hljs-string">"Sam"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">_greet_with_default_test</span> = greeting!(test <span class="hljs-string">"Sam"</span>);    <span class="hljs-comment">// #2</span>
    trace_macros!(<span class="hljs-literal">false</span>);
}
</code></pre>
<p><strong>#1</strong> <code>log_syntax</code>æ˜¯ä¸ç¨³å®šåŠŸèƒ½ï¼Œéœ€è¦é€šè¿‡<code>feature</code>å¯ç”¨<br/>
<strong>#2</strong> è°ƒç”¨å®çš„æ–°åˆ†æ”¯</p>
<p>ç°åœ¨ï¼Œå¦‚æœä½ ç”¨ <code>cargo +nightly check</code> è¿è¡Œä»£ç ï¼Œä¼šçœ‹åˆ° <code>log_syntax!</code> çš„è¾“å‡º <code>The name passed to test is: Sam</code>ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨ç¼–è¯‘æœŸæ‰§è¡Œçš„ã€‚</p>
<p>åªæœ‰å½“ä½ ç”¨ <code>cargo +nightly run</code> è¿è¡Œæ—¶ï¼ˆæ³¨æ„è¿™é‡Œæ˜¯ <code>run</code>ï¼‰ï¼Œæ‰ä¼šåŒæ—¶çœ‹åˆ° <code>log_syntax</code> çš„è¾“å‡ºå’Œå®é‡Œ <code>println!</code> è¯­å¥çš„è¾“å‡ºã€‚</p>
<p>è¿™ç§åŒºåˆ«å¯¹äºè°ƒè¯•ç¼–è¯‘æœŸè¡Œä¸ºéå¸¸é‡è¦ã€‚</p>
<p>å€ŸåŠ©è¿™äº›å·¥å…·ï¼Œä½ å¯ä»¥è¿½è¸ªå®åˆ°å±•å¼€å Rust ä»£ç çš„å®Œæ•´è¿‡ç¨‹ã€‚å®ƒè™½ç„¶æ²¡æœ‰çœŸæ­£è°ƒè¯•å™¨é‚£ä¹ˆå¼ºå¤§ï¼Œä½†èŠèƒœäºæ— ã€‚å”¯ä¸€å¯æƒœçš„æ˜¯ï¼Œè¿™äº›åŠŸèƒ½ç›®å‰åªèƒ½åœ¨ nightly ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚</p>
<p>åé¢æˆ‘ä»¬ä¼šä»‹ç»ä¸€äº›èƒ½åœ¨ç¨³å®šç‰ˆ Rust ä¸­å·¥ä½œçš„è°ƒè¯•å·¥å…·ã€‚</p>
<h2 data-id="heading-4">æœªå®Œå¾…ç»­...</h2></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯éƒ½èƒ½çœ‹æ‡‚çš„rustå…¥é—¨æ•™ç¨‹ï¼ˆäºŒï¼‰â€”â€”åŸºæœ¬ç±»å‹(Primitive Type)]]></title>    <link>https://juejin.cn/post/7603261102795391002</link>    <guid>https://juejin.cn/post/7603261102795391002</guid>    <pubDate>2026-02-06T06:11:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603261102795391002" data-draft-id="7602850166732537865" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯éƒ½èƒ½çœ‹æ‡‚çš„rustå…¥é—¨æ•™ç¨‹ï¼ˆäºŒï¼‰â€”â€”åŸºæœ¬ç±»å‹(Primitive Type)"/> <meta itemprop="keywords" content="Rust,å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T06:11:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º"/> <meta itemprop="url" content="https://juejin.cn/user/976022056218471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯éƒ½èƒ½çœ‹æ‡‚çš„rustå…¥é—¨æ•™ç¨‹ï¼ˆäºŒï¼‰â€”â€”åŸºæœ¬ç±»å‹(Primitive Type)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022056218471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T06:11:50.000Z" title="Fri Feb 06 2026 06:11:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ¬æ–‡ä»‹ç»Rustä¸­çš„åŸºæœ¬ç±»å‹ï¼ˆPrimitive Typeï¼‰ã€‚</p>
<p><strong>ä¸åŒäºjsæˆ–javaçš„åŸºæœ¬ç±»å‹ï¼ˆprimitive valueï¼‰æˆ–å¼•ç”¨ç±»å‹çš„æ¦‚å¿µï¼Œ</strong>
Rust é‡Œçš„â€œ<strong>primitive types</strong>â€æ„æ€æ˜¯ï¼š</p>
<ul>
<li>è¿™äº›ç±»å‹ç”± Rust è¯­è¨€æœ¬èº«å†…å»ºï¼Œä¸æ˜¯ç”¨ trait æˆ–ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹å®ç°çš„ã€‚</li>
<li>æŸäº›â€œåŸºæœ¬ç±»å‹â€æ˜¯ç›´æ¥å¯ä»¥ç”¨çš„ï¼ˆæ¯”å¦‚ <code>i32</code>ï¼‰ï¼Œä½†æœ‰äº›ï¼ˆæ¯”å¦‚ <code>str</code>ï¼‰æœ¬èº«ä¸èƒ½è¢«ç›´æ¥æ‹¿æ¥ç”¨ï¼Œåªèƒ½é€šè¿‡å¼•ç”¨æˆ–æŒ‡é’ˆæ¥ç”¨ã€‚</li>
<li>Rust çš„ç±»å‹ç³»ç»Ÿå…è®¸åŸºæœ¬ç±»å‹æ˜¯<strong>dynamically sized type</strong>ï¼ˆDSTï¼‰ï¼Œä½†ä¸æ˜¯æ‰€æœ‰ primitive type éƒ½èƒ½åœ¨ä¸å¸¦å¼•ç”¨æƒ…å†µä¸‹ç‹¬ç«‹å‡ºç°ã€‚</li>
</ul>
<p>rustçš„åŸºæœ¬ç±»å‹éå¸¸å¤šï¼Œä½†å¥½åœ¨å¤§å¤šæ•°éƒ½å®¹æ˜“æŒæ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8cf26f13534442e943e0c0e11af3932~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770963109&amp;x-signature=18dBXFxlJJJCini5es2qjtFBK%2FM%3D" alt="image.png" loading="lazy"/></p>
<p>ä»¥ä¸Šæˆªå›¾æ¥è‡ªäº<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.rust-lang.org%2Fstd%2Findex.html" target="_blank" title="https://doc.rust-lang.org/std/index.html" ref="nofollow noopener noreferrer">rustæ ‡å‡†åº“æ–‡æ¡£</a>ï¼Œè¿™æ˜¯rustæœ€é‡è¦çš„ä¸€ä¸ªæ–‡æ¡£ã€‚</p>
<h2 data-id="heading-1">æ ‡é‡ç±»å‹å’Œå¤åˆç±»å‹</h2>
<p>Rust çš„ç±»å‹ç³»ç»Ÿæ›´å€¾å‘äºä½¿ç”¨<strong>æ ‡é‡ç±»å‹</strong>ï¼ˆscalar typesï¼‰å’Œ<strong>å¤åˆç±»å‹</strong>ï¼ˆcompound typesï¼‰æ¥åˆ†ç±»å…¶å†…ç½®çš„åŸå§‹ç±»å‹ï¼ˆprimitive typesï¼‰ï¼šæ ‡é‡ç±»å‹ä»£è¡¨å•ä¸€å€¼ï¼Œè€Œå¤åˆç±»å‹å…è®¸å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªå•å…ƒã€‚</p>
<h3 data-id="heading-2">1. <strong>æ ‡é‡ç±»å‹ï¼ˆScalar Typesï¼‰</strong></h3>
<ul>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å›ºå®šå¤§å°ï¼šåœ¨ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°ï¼Œä¾¿äºä¼˜åŒ–ã€‚</li>
<li>ä¸å¯åˆ†è§£ï¼šä¸èƒ½è¿›ä¸€æ­¥æ‹†åˆ†æˆæ›´å°çš„å­ç±»å‹ã€‚</li>
<li>ç”¨äºåŸºæœ¬è®¡ç®—å’Œé€»è¾‘æ“ä½œã€‚</li>
</ul>
</li>
<li>
<p><strong>Rust ä¸­çš„æ ‡é‡ç±»å‹ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li><strong>æ•´æ•°ç±»å‹ï¼ˆIntegersï¼‰</strong> ï¼šæœ‰ç¬¦å·ï¼ˆi8, i16, i32, i64, i128, isizeï¼‰å’Œæ— ç¬¦å·ï¼ˆu8, u16, u32, u64, u128, usizeï¼‰ã€‚ä¾‹å¦‚ï¼Œlet x: i32 = 42; è¡¨ç¤ºä¸€ä¸ªå•ä¸€çš„æ•´æ•°å€¼ã€‚</li>
<li><strong>æµ®ç‚¹ç±»å‹ï¼ˆFloating-pointï¼‰</strong> ï¼šf32 å’Œ f64ã€‚ä¾‹å¦‚ï¼Œlet y: f64 = 3.14; è¡¨ç¤ºä¸€ä¸ªå•ä¸€çš„æµ®ç‚¹æ•°å€¼ã€‚</li>
<li><strong>å¸ƒå°”ç±»å‹ï¼ˆBooleanï¼‰</strong> ï¼šboolï¼Œåªæœ‰ true æˆ– falseã€‚ä¾‹å¦‚ï¼Œlet z: bool = true;ã€‚</li>
<li><strong>å­—ç¬¦ç±»å‹ï¼ˆCharacterï¼‰</strong> ï¼šcharï¼Œè¡¨ç¤ºå•ä¸ª Unicode æ ‡é‡å€¼ï¼ˆScalar Valueï¼‰ï¼Œå ç”¨ 4 å­—èŠ‚ã€‚ä¾‹å¦‚ï¼Œlet c: char = 'A';ã€‚</li>
</ul>
</li>
</ul>
<p>æ ‡é‡ç±»å‹å¸¸ç”¨äºç®€å•å˜é‡å£°æ˜å’Œè¡¨è¾¾å¼è®¡ç®—ï¼Œæ˜¯ Rust æ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-3">2. <strong>å¤åˆç±»å‹ï¼ˆCompound Typesï¼‰</strong></h3>
<ul>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å¯ç»„åˆï¼šå¯ä»¥åµŒå¥—å…¶ä»–ç±»å‹ï¼Œå½¢æˆå±‚æ¬¡ç»“æ„ã€‚</li>
<li>å¤§å°é€šå¸¸å›ºå®šï¼ˆå¯¹äºæ•°ç»„å’Œå…ƒç»„ï¼‰ï¼Œä½†å¯ä»¥æ˜¯åŠ¨æ€çš„ï¼ˆå¦‚æœæ¶‰åŠåˆ‡ç‰‡ï¼‰ã€‚</li>
<li>ç”¨äºè¡¨ç¤ºå…³ç³»æˆ–é›†åˆçš„æ•°æ®ï¼Œæ”¯æŒæ¨¡å¼åŒ¹é…å’Œè§£æ„ã€‚</li>
</ul>
</li>
<li>
<p><strong>Rust ä¸­çš„å¤åˆç±»å‹ç¤ºä¾‹</strong>ï¼ˆèšç„¦äºåŸå§‹å¤åˆç±»å‹ï¼‰ï¼š</p>
<ul>
<li><strong>å…ƒç»„ç±»å‹ï¼ˆTuplesï¼‰</strong> ï¼šä¸€ä¸ªå›ºå®šé•¿åº¦çš„å¼‚æ„é›†åˆï¼ˆå…ƒç´ ç±»å‹å¯ä»¥ä¸åŒï¼‰ã€‚ä¾‹å¦‚ï¼Œlet tup: (i32, f64, char) = (42, 3.14, 'A');ã€‚ä½ å¯ä»¥è§£æ„å®ƒï¼šlet (a, b, c) = tup;ã€‚</li>
<li><strong>æ•°ç»„ç±»å‹ï¼ˆArraysï¼‰</strong> ï¼šä¸€ä¸ªå›ºå®šé•¿åº¦çš„åŒæ„é›†åˆï¼ˆæ‰€æœ‰å…ƒç´ ç±»å‹ç›¸åŒï¼‰ã€‚ä¾‹å¦‚ï¼Œlet arr: [i32; 3] = [1, 2, 3];ã€‚æ•°ç»„çš„å¤§å°åœ¨ç¼–è¯‘æ—¶å¿…é¡»å·²çŸ¥ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šRust çš„åŸå§‹å¤åˆç±»å‹ä¸»è¦é™äºå…ƒç»„å’Œæ•°ç»„ã€‚æ›´é«˜çº§çš„å¤åˆç±»å‹å¦‚ç»“æ„ä½“ï¼ˆstructsï¼‰å’Œæšä¸¾ï¼ˆenumsï¼‰æ˜¯ç”¨æˆ·å®šä¹‰çš„ç±»å‹ï¼ˆderived typesï¼‰ï¼Œä½†å®ƒä»¬åŸºäºè¿™äº›åŸºç¡€æ„å»ºã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-4">æ•°å­—</h2>
<p>å¯¹æ ‡jsä¸­çš„numberï¼Œrustä¸­åˆ†ä¸ºäº†8ï¼Œ16ï¼Œ32ï¼Œ64ï¼Œ128ä½æ•´æ•°/æ— ç¬¦å·æ•´å½¢ï¼ˆåªèƒ½æ­£æ•°ï¼‰/æµ®ç‚¹æ•°ï¼Œåˆ†åˆ«ä»¥i,u,få¼€å¤´ï¼Œæ¯”å¦‚i32,f64,u128ã€‚</p>
<p>é™¤äº†è¿™äº›ï¼Œè¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ç±»å‹ï¼Œisizeå’Œusizeã€‚é›†åˆç±»å‹ï¼ˆæ•°ç»„ï¼Œå‘é‡ï¼Œå­—ç¬¦ä¸²ç­‰ï¼‰çš„ä¸‹æ ‡ï¼Œé•¿åº¦åªèƒ½ç”¨unsizeï¼Œisizeå¯ç”¨äºæŒ‡é’ˆåç§»é‡ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">number_test</span>() {
    <span class="hljs-title function_ invoke__">int_test</span>();
    <span class="hljs-title function_ invoke__">float_test</span>();
    <span class="hljs-title function_ invoke__">spec_num_test</span>();
}
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">int_test</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">decimal</span> = <span class="hljs-number">98_222</span>; <span class="hljs-comment">// åè¿›åˆ¶ï¼š98,222</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">hex</span> = <span class="hljs-number">0xff</span>; <span class="hljs-comment">// åå…­è¿›åˆ¶ï¼š255</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">octal</span> = <span class="hljs-number">0o77</span>; <span class="hljs-comment">// å…«è¿›åˆ¶ï¼š63</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">binary</span> = <span class="hljs-number">0b1111_0000</span>; <span class="hljs-comment">// äºŒè¿›åˆ¶ï¼š240</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">byte</span> = <span class="hljs-string">b'A'</span>; <span class="hljs-comment">// å­—èŠ‚ï¼š65ï¼ˆä»…é™ u8ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">with_type</span> = <span class="hljs-number">42u32</span>; <span class="hljs-comment">// æŒ‡å®šç±»å‹ï¼š42 as u32</span>
    <span class="hljs-built_in">println!</span>(
        <span class="hljs-string">"{},{},{},{},{},{}"</span>,
        decimal, hex, octal, binary, byte, with_type
    )
}
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">float_test</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">2.0</span>; <span class="hljs-comment">// f64ï¼ˆé»˜è®¤ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span>: <span class="hljs-type">f32</span> = <span class="hljs-number">3.0</span>; <span class="hljs-comment">// f32</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">z</span> = <span class="hljs-number">1.0e10</span>; <span class="hljs-comment">// ç§‘å­¦è®¡æ•°æ³•ï¼š1.0 Ã— 10^10</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">inf</span> = <span class="hljs-type">f32</span>::INFINITY; <span class="hljs-comment">// æ­£æ— ç©·å¤§</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">neg_inf</span> = <span class="hljs-type">f32</span>::NEG_INFINITY; <span class="hljs-comment">// è´Ÿæ— ç©·å¤§</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nan</span> = <span class="hljs-type">f32</span>::NAN; <span class="hljs-comment">// éæ•°å­—</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{},{},{},{},{},{}"</span>, x, y, z, inf, neg_inf, nan);
}
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">spec_num_test</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">max</span> = <span class="hljs-type">f32</span>::MAX; <span class="hljs-comment">// æœ€å¤§æ­£å€¼ï¼š3.4028235e38</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">min</span> = <span class="hljs-type">f32</span>::MIN; <span class="hljs-comment">// æœ€å°è´Ÿå€¼ï¼š-3.4028235e38</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">epsilon</span> = <span class="hljs-type">f64</span>::EPSILON; <span class="hljs-comment">// 1.0 å’Œä¸‹ä¸€ä¸ªå¯è¡¨ç¤ºæ•°çš„å·®å€¼</span>

    <span class="hljs-comment">// æ£€æŸ¥ç‰¹æ®Šå€¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span>: <span class="hljs-type">f64</span> = <span class="hljs-number">0.0</span> / <span class="hljs-number">0.0</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{},{}"</span>, max, min);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, (<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>) - <span class="hljs-number">0.3</span> &lt; epsilon); <span class="hljs-comment">//true</span>

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"is NaN: {}"</span>, x.<span class="hljs-title function_ invoke__">is_nan</span>()); <span class="hljs-comment">// true</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"is infinite: {}"</span>, x.<span class="hljs-title function_ invoke__">is_infinite</span>()); <span class="hljs-comment">// false</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"is finite: {}"</span>, x.<span class="hljs-title function_ invoke__">is_finite</span>()); <span class="hljs-comment">// false</span>
}

</code></pre>
<h3 data-id="heading-5">æ•°å­—çš„å¸¸ç”¨æ–¹æ³•</h3>
<p>ä»¥ä¸Šä»£ç ä¸­ä½¿ç”¨äº†<code>is_nan,is_infinite</code>ç­‰æ–¹æ³•ï¼Œjsä¸­æ•°å­—å’Œæ•°å­¦ç›¸å…³çš„æ–¹æ³•åœ¨Numberå’ŒMathå¯¹è±¡ä¸Šï¼Œè€Œruståˆ™å¯ä»¥ç›´æ¥ä»æ•°å­—æœ¬èº«ä¸Šè°ƒç”¨ç›¸å…³æ–¹æ³•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9244e384f6234d3ba6540e941889ef25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770963109&amp;x-signature=TZ%2BciXj9bciS9l3xssJcmfNursg%3D" alt="image.png" loading="lazy"/>
æ‰€æœ‰çš„æ–¹æ³•éƒ½å¯ä»¥ä»æ ‡å‡†åº“æ–‡æ¡£ä¸­æŸ¥é˜…ã€‚</p>
<h4 data-id="heading-6">å’ŒåŒ…è£…ç±»çš„åŒºåˆ«</h4>
<p>è¿™ä¸ªè®¾è®¡æœ‰ç‚¹<strong>ç±»ä¼¼jsæˆ–javaä¸­çš„è‡ªåŠ¨åŒ…è£…ç±»ï¼Œä½†å®ƒæœ¬è´¨ä¸Šå®Œå…¨ä¸æ˜¯åŒ…è£…ç±»çš„å®ç°ã€‚</strong>
åœ¨Â <strong>Rust ä¸­ï¼Œæ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆå¦‚Â <code>i32</code>,Â <code>f64</code>ï¼‰éƒ½æ˜¯ç›´æ¥åœ¨æ ˆä¸Šçš„å€¼ï¼Œæ²¡æœ‰â€œåŒ…è£…ç±»â€çš„æ¦‚å¿µ</strong>ã€‚</p>
<p>ä½ èƒ½ç›´æ¥åœ¨å®ƒä»¬ä¸Šé¢è°ƒç”¨æ–¹æ³•ï¼Œä¸»è¦å½’åŠŸäºRustç¼–è¯‘å™¨å¼ºå¤§çš„Â <strong>è‡ªåŠ¨å¼•ç”¨/è§£å¼•ç”¨æœºåˆ¶</strong>Â å’ŒÂ <strong>ç‰¹è´¨ï¼ˆTraitï¼‰ç³»ç»Ÿ</strong>ã€‚</p>
<p>è¿™æ˜¯æœ¬ç³»åˆ—æ–‡ç« ç¬¬ä¸€æ¬¡è®²åˆ°<strong>å¼•ç”¨æœºåˆ¶</strong>ï¼Œå¦‚æœä¸èƒ½ç†è§£ä¸‹é¢çš„å†…å®¹ï¼Œå®Œå…¨æ²¡æœ‰å…³ç³»ï¼Œåªè¦çŸ¥é“è¿™é‡Œå¹¶ä¸æ˜¯è‡ªåŠ¨åŒ…è£…ç±»çš„å®ç°å³å¯ã€‚</p>
<h5 data-id="heading-7">ğŸ§  æ ¸å¿ƒæœºåˆ¶ï¼šç¼–è¯‘å™¨åœ¨å¹•ååšäº†ä»€ä¹ˆï¼Ÿ</h5>
<p>å½“ä½ å†™ä¸‹Â <code>5.to_string()</code>Â æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¸ºä½ è‡ªåŠ¨å¤„ç†ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>
<p><strong>è‡ªåŠ¨å€Ÿç”¨</strong>ï¼šç”±äºÂ <code>to_string</code>Â æ–¹æ³•é€šå¸¸ä»¥Â <code>&amp;self</code>Â ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆéœ€è¦ä¸€ä¸ªå¼•ç”¨ï¼‰ï¼Œæ‰€ä»¥Â <code>5</code>Â ä¼šè¢«<strong>è‡ªåŠ¨å€Ÿç”¨</strong>ï¼Œå˜ä¸ºÂ <code>&amp;5</code>ã€‚</p>
</li>
<li>
<p><strong>æ–¹æ³•æŸ¥æ‰¾ä¸åˆ†å‘</strong>ï¼šç¼–è¯‘å™¨çŸ¥é“Â <code>5</code>Â æ˜¯Â <code>i32</code>Â ç±»å‹ã€‚ç„¶åå®ƒä¼šå»æŸ¥æ‰¾Â <code>i32</code>Â ç±»å‹<strong>å®ç°çš„æ‰€æœ‰ç‰¹è´¨</strong>ã€‚å®ƒå‘ç°Â <code>i32</code>Â å®ç°äº†Â <code>ToString</code>Â ç‰¹è´¨ï¼Œè€ŒÂ <code>ToString</code>Â ç‰¹è´¨é‡Œå®šä¹‰äº†Â <code>to_string(&amp;self)</code>Â æ–¹æ³•ã€‚äºæ˜¯ï¼Œç¼–è¯‘å™¨å°†ä½ çš„è°ƒç”¨<strong>é™æ€åœ°</strong>è§£æä¸ºï¼š</p>
<pre><code class="hljs language-rust" lang="rust">&lt;<span class="hljs-type">i32</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">ToString</span>&gt;::<span class="hljs-title function_ invoke__">to_string</span>(&amp;<span class="hljs-number">5</span>)
</code></pre>
<p>è¿™ä¸ªè½¬æ¢åœ¨<strong>ç¼–è¯‘æ—¶</strong>å°±å·²å®Œæˆï¼Œæ²¡æœ‰ä»»ä½•è¿è¡Œæ—¶å¼€é”€ã€‚</p>
</li>
</ol>
<p><strong>ä¸€ä¸ªæ›´æ¸…æ™°çš„ä¾‹å­</strong>ï¼š<br/>
<code>(-1.01_f64).floor()</code>Â çš„å®Œæ•´è½¬æ¢è·¯å¾„æ˜¯ï¼š</p>
<ol>
<li><code>.</code>Â æ“ä½œè§¦å‘æ–¹æ³•è°ƒç”¨ã€‚</li>
<li>ç¼–è¯‘å™¨å‘ç°Â <code>-1.01_f64</code>Â æ˜¯Â <code>f64</code>Â ç±»å‹ã€‚</li>
<li>æŸ¥æ‰¾å‘ç°ï¼Œ<code>f64</code>Â å®ç°äº†Â <code>std::ops::Deref</code>ï¼ˆä½¿å…¶å¯ä»¥è·å¾—æ›´å¤šæ–¹æ³•ï¼‰ï¼Œå¹¶ä¸”ç›´æ¥å®šä¹‰äº†Â <code>floor</code>Â æ–¹æ³•ã€‚</li>
<li>æœ€ç»ˆè°ƒç”¨è¢«é™æ€è§£æï¼Œç­‰ä»·äºÂ <code>f64::floor(-1.01_f64)</code>ã€‚</li>
</ol>
<h2 data-id="heading-8">å¸ƒå°”</h2>
<p>rustä¸­çš„boolçš„ä½¿ç”¨å’ŒjsåŸºæœ¬ä¸€è‡´</p>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">t</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">f</span>: <span class="hljs-type">bool</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ˜¾å¼ç±»å‹æ³¨è§£</span>

    <span class="hljs-comment">// é€»è¾‘è¿ç®—</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">and</span> = <span class="hljs-literal">true</span> &amp;&amp; <span class="hljs-literal">false</span>; <span class="hljs-comment">// false</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">or</span> = <span class="hljs-literal">true</span> || <span class="hljs-literal">false</span>; <span class="hljs-comment">// true</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">not</span> = !<span class="hljs-literal">true</span>; <span class="hljs-comment">// false</span>

    <span class="hljs-comment">// æ¯”è¾ƒè¿ç®—ï¼ˆè¿”å›å¸ƒå°”å€¼ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">5</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = x &lt; y; <span class="hljs-comment">// true</span>
</code></pre>
<h2 data-id="heading-9">å­—ç¬¦</h2>
<p>å¦‚æœä½ è¿˜äº†è§£javaï¼Œé‚£å®Œå…¨å¯ä»¥å¯¹ç…§javaä¸­çš„charæ¥ç†è§£ã€‚</p>
<p>Rustä¸­çš„å­—ç¬¦ç±»å‹<code>char</code>è¡¨ç¤ºä¸€ä¸ªUnicodeæ ‡é‡å€¼ï¼Œå ç”¨4ä¸ªå­—èŠ‚ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥è¡¨ç¤ºæ¯”ASCIIæ›´å¹¿æ³›çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ã€emojiç­‰ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">c</span> = <span class="hljs-string">'z'</span>; <span class="hljs-comment">// å•å¼•å·ï¼Œå­—ç¬¦å­—é¢é‡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">z</span> = <span class="hljs-string">'â„¤'</span>; <span class="hljs-comment">// Unicode å­—ç¬¦</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">unicode</span> = '\u{<span class="hljs-number">2764</span>}'; <span class="hljs-comment">// Unicodeï¼š'â¤'</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">hanzi</span> = <span class="hljs-string">'å¸ƒ'</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">heart_eyed_cat</span>: <span class="hljs-type">char</span> = 'ğŸ˜»'; <span class="hljs-comment">// Emoji</span>

    <span class="hljs-comment">// è½¬ä¹‰å­—ç¬¦</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">newline</span> = <span class="hljs-string">'\n'</span>; <span class="hljs-comment">// æ¢è¡Œ</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">tab</span> = <span class="hljs-string">'\t'</span>; <span class="hljs-comment">// åˆ¶è¡¨ç¬¦</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">single_quote</span> = <span class="hljs-string">'\''</span>; <span class="hljs-comment">// å•å¼•å·</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">backslash</span> = <span class="hljs-string">'\\'</span>; <span class="hljs-comment">// åæ–œæ </span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">hex_char</span> = <span class="hljs-string">'\x41'</span>; <span class="hljs-comment">// åå…­è¿›åˆ¶ï¼š'A'</span>

    <span class="hljs-built_in">println!</span>(
        <span class="hljs-string">"{},{},{},{},{},{},{},{},{},{}"</span>,
        c, z, heart_eyed_cat, newline, tab, single_quote, backslash, hex_char, unicode, hanzi
    );

    <span class="hljs-comment">// å­—ç¬¦æ–¹æ³•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">c</span> = <span class="hljs-string">'A'</span>;

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"is alphabetic: {}"</span>, c.<span class="hljs-title function_ invoke__">is_alphabetic</span>()); <span class="hljs-comment">// æ˜¯å­—æ¯ï¼Œtrue</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"is digit: {}"</span>, c.<span class="hljs-title function_ invoke__">is_digit</span>(<span class="hljs-number">10</span>)); <span class="hljs-comment">// trueï¼ˆåè¿›åˆ¶ä¸­æ˜¯æ•°å­—ï¼‰</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"to lowercase: {}"</span>, c.<span class="hljs-title function_ invoke__">to_lowercase</span>()); <span class="hljs-comment">// 'a'</span>
</code></pre>
<p>å¦‚æœä½ æ›´ç†Ÿæ‚‰jsï¼Œé‚£ä¹ˆå¾ˆè‡ªç„¶åœ°å°†charå½“æˆä½¿ç”¨å•å¼•å·çš„å•ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œè™½ç„¶è¡¨ç°ä¸Šç›¸ä¼¼ï¼Œä½†ä¸ç®¡æ€æ ·ï¼Œä¸è¦å°†charçœ‹æˆå­—ç¬¦ä¸²ï¼Œè¿™æ˜¯ä¸¤ä¸ªç±»å‹ã€‚</p>
<h2 data-id="heading-10">str</h2>
<p>è¿™ä¸€èŠ‚ä»‹ç»strç±»å‹ï¼Œç»†å¿ƒçš„è¯»è€…ä¼šå‘ç°ï¼Œå‰é¢ç« èŠ‚æ ‡é¢˜éƒ½æ˜¯ä¸­æ–‡ï¼Œä½†æœ¬èŠ‚çš„æ ‡é¢˜æ˜¯strè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<p>ä»è¯­è¨€å±‚é¢ä¸Šæ¥è¯´ï¼Œstrå°±æ˜¯rustçš„å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†åœ¨rustå¼€å‘ä¸­è¯´åˆ°å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸€èˆ¬æ˜¯&amp;stræˆ–Stringã€‚&amp;strå’ŒStringæœ€ç›´æ¥çš„åŒºåˆ«æ˜¯ï¼Œ<strong>&amp;strä¸æ‹¥æœ‰æ•°æ®ï¼Œä¸å¯æ”¹å˜æ•°æ®</strong>ï¼Œ<strong>è€ŒStringæ˜¯æ‹¥æœ‰æ•°æ®ä¸”å¯æ”¹å˜æ•°æ®</strong>ã€‚</p>
<blockquote>
<p>TheÂ <code>str</code>Â type, also called a â€˜string sliceâ€™, is the most primitive string type. It is usually seen in its borrowed form,Â <code>&amp;str</code>. It is also the type of string literals,Â <code>&amp;'static str</code>.</p>
</blockquote>
<p><code>str</code>Â æ˜¯ Rust ä¸­çš„<strong>å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹</strong>ï¼ˆstring sliceï¼‰ï¼Œé€šå¸¸ä»¥å¼•ç”¨çš„å½¢å¼å‡ºç°ï¼š<code>&amp;str</code>ã€‚å®ƒæ˜¯<strong>ä¸å¯å˜çš„ UTF-8 ç¼–ç å­—èŠ‚åºåˆ—çš„è§†å›¾</strong>ã€‚â€”â€”<strong>ç›¸æ¯”<code>char</code>ï¼Œå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)</strong> ï¼Œè¿™æ ·æœ‰åŠ©äºå¤§å¹…é™ä½å­—ç¬¦ä¸²æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</p>
<p>è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªç¬¦å·<code>&amp;</code>,Rustä¸­çš„<code>&amp;</code>è¡¨ç¤ºÂ <strong>å¼•ç”¨</strong>ï¼ˆReferenceï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆ</strong>ï¼Œä½†ä¸æ˜¯æ‹¥æœ‰æ•°æ®çš„æ‰€æœ‰æƒï¼Œè€Œ<code>&amp;'static str</code>ä¸­çš„<code>static</code>åˆ™è¡¨ç¤ºäº†å®ƒçš„<strong>ç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</p>
<p>rustä¸­çš„stræ­å¼€äº†è¿™é—¨è¯­è¨€å¤æ‚æ€§ï¼Œç›¸å¯¹äºå‰é¢çš„å†…å®¹ï¼Œå­—ç¬¦ä¸²çš„æŒæ¡éš¾åº¦å°†é™¡ç„¶ä¸Šå‡ï¼Œä½†å®ƒä¹Ÿæ˜¯è¿›å…¥rustä¸–ç•Œçš„ä¸€ä¸ªéå¸¸å¥½çš„åˆ‡å…¥ç‚¹ã€‚</p>
<p>å¯ä»¥å…ˆä¸ç®¡å…¶ä»–çš„æ¦‚å¿µï¼Œå…ˆäº†è§£å¦‚ä½•åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<h3 data-id="heading-11">å­—ç¬¦ä¸²åˆ›å»º</h3>
<h4 data-id="heading-12">1. å­—é¢é‡åˆ›å»º</h4>
<pre><code class="hljs language-ini" lang="ini"> let s: <span class="hljs-attr">str</span> = <span class="hljs-string">"hello"</span><span class="hljs-comment">; //âŒ é”™è¯¯</span>
// str é€šå¸¸ä»¥ &amp;str çš„å½¢å¼ä½¿ç”¨ï¼ˆå¼•ç”¨ï¼‰
let s: &amp;<span class="hljs-attr">str</span> = <span class="hljs-string">"Hello, Rust!"</span><span class="hljs-comment">; // å­—ç¬¦ä¸²å­—é¢é‡å°±æ˜¯ &amp;str ç±»å‹</span>
let <span class="hljs-attr">multi_line</span> = r<span class="hljs-comment">#"è¿™æ˜¯ä¸€ä¸ª</span>
å¤šè¡Œ
åŸå§‹å­—ç¬¦ä¸²"<span class="hljs-comment">#;</span>
</code></pre>
<h4 data-id="heading-13">2. ä»Stringåˆ›å»º(å€Ÿç”¨)</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">owned</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Hello"</span>);

<span class="hljs-comment">// æ•´ä¸ªå­—ç¬¦ä¸²çš„åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice1</span>: &amp;<span class="hljs-type">str</span> = &amp;owned; <span class="hljs-comment">// éšå¼è½¬æ¢</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice2</span>: &amp;<span class="hljs-type">str</span> = owned.<span class="hljs-title function_ invoke__">as_str</span>(); <span class="hljs-comment">// æ˜¾å¼æ–¹æ³•</span>

<span class="hljs-comment">// éƒ¨åˆ†å­—ç¬¦ä¸²çš„åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice3</span> = &amp;owned[<span class="hljs-number">0</span>..<span class="hljs-number">5</span>]; <span class="hljs-comment">// "Hello"</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice4</span> = &amp;owned[..]; <span class="hljs-comment">// æ•´ä¸ªå­—ç¬¦ä¸²</span>
</code></pre>
<h4 data-id="heading-14">3. å…¶ä»–å½¢å¼åˆ›å»º</h4>
<pre><code class="hljs language-rust" lang="rust">    <span class="hljs-comment">// ä» æ•°ç»„åˆ›å»º</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">vec_bytes</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">72</span>, <span class="hljs-number">101</span>, <span class="hljs-number">108</span>, <span class="hljs-number">108</span>, <span class="hljs-number">111</span>]; <span class="hljs-comment">// "Hello" çš„ ASCII</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">str_from_vec</span> = std::<span class="hljs-type">str</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(&amp;vec_bytes).<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">words</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span>, <span class="hljs-string">"Rust"</span>];
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sentence</span> = words.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">" "</span>); <span class="hljs-comment">// ç”¨ç©ºæ ¼è¿æ¥</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fruits</span> = [<span class="hljs-string">"Apple"</span>, <span class="hljs-string">"Banana"</span>, <span class="hljs-string">"Orange"</span>];
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = fruits.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">", "</span>);
    <span class="hljs-comment">// ä» char åˆ›å»º</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ch</span> = <span class="hljs-string">'A'</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">str_from_char</span> = ch.<span class="hljs-title function_ invoke__">to_string</span>().<span class="hljs-title function_ invoke__">as_str</span>();  <span class="hljs-comment">// éœ€è¦å…ˆè½¬ String</span>
</code></pre>
<h3 data-id="heading-15">å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œ</h3>
<h4 data-id="heading-16">1. æ‹¼æ¥</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// æ‹¼æ¥å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span>: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"Hello"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span>: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">" World"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">combined</span>: <span class="hljs-type">String</span> = s1.<span class="hljs-title function_ invoke__">to_string</span>() + s2; <span class="hljs-comment">// è¿”å› String</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">combined_str</span> = combined.<span class="hljs-title function_ invoke__">as_str</span>(); <span class="hljs-comment">//String è½¬&amp;str</span>
</code></pre>
<p>&amp;stræ— æ³•ç›´æ¥æ‹¼æ¥ï¼Œéœ€è¦è½¬ä¸ºStringï¼Œæ‹¼æ¥åçš„å­—ç¬¦ä¸²ç±»å‹ä¹Ÿæ˜¯Stringã€‚</p>
<h4 data-id="heading-17">2. é•¿åº¦å’Œå®¹é‡ç›¸å…³</h4>
<pre><code class="hljs language-rust" lang="rust">    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-string">"Hello ğŸ¦€"</span>;
    
    <span class="hljs-comment">// å­—èŠ‚æ•°ï¼ˆUTF-8 ç¼–ç ï¼‰</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å­—èŠ‚æ•°: {}"</span>, s.<span class="hljs-title function_ invoke__">len</span>());           <span class="hljs-comment">// 10ï¼ˆHello=5, ğŸ¦€=4, ç©ºæ ¼=1ï¼‰</span>
    
    <span class="hljs-comment">// å­—ç¬¦æ•°ï¼ˆUnicode æ ‡é‡å€¼ï¼‰</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å­—ç¬¦æ•°: {}"</span>, s.<span class="hljs-title function_ invoke__">chars</span>().<span class="hljs-title function_ invoke__">count</span>()); <span class="hljs-comment">// 7</span>
    
    <span class="hljs-comment">// æ˜¯å¦ä¸ºç©º</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ˜¯å¦ä¸ºç©º: {}"</span>, s.<span class="hljs-title function_ invoke__">is_empty</span>());    <span class="hljs-comment">// false</span>
    
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä»¥å­—èŠ‚åºåˆ—å¼€å§‹/ç»“æŸ</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ˜¯å¦ä»¥'H'å¼€å§‹: {}"</span>, s.<span class="hljs-title function_ invoke__">starts_with</span>(<span class="hljs-string">'H'</span>));  <span class="hljs-comment">// true</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ˜¯å¦ä»¥'ğŸ¦€'ç»“æŸ: {}"</span>, s.<span class="hljs-title function_ invoke__">ends_with</span>('ğŸ¦€'));  <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-18">3. æœç´¢å’ŒæŸ¥æ‰¾</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-string">"Hello, Rust Programming!"</span>;

    <span class="hljs-comment">// æŸ¥æ‰¾å­—ç¬¦</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(pos) = s.<span class="hljs-title function_ invoke__">find</span>(<span class="hljs-string">'R'</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰¾åˆ° 'R' åœ¨ä½ç½®: {}"</span>, pos); <span class="hljs-comment">// 7</span>
    }

    <span class="hljs-comment">// æŸ¥æ‰¾å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(pos) = s.<span class="hljs-title function_ invoke__">find</span>(<span class="hljs-string">"Prog"</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰¾åˆ° 'Prog' åœ¨ä½ç½®: {}"</span>, pos); <span class="hljs-comment">// 12</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥åŒ…å«å…³ç³»</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åŒ…å« 'Rust'?: {}"</span>, s.<span class="hljs-title function_ invoke__">contains</span>(<span class="hljs-string">"Rust"</span>)); <span class="hljs-comment">// true</span>

    <span class="hljs-comment">// åŒ¹é…æ¨¡å¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">matches</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = s.<span class="hljs-title function_ invoke__">match_indices</span>(<span class="hljs-string">"o"</span>).<span class="hljs-title function_ invoke__">collect</span>();
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰€æœ‰ 'o' çš„ä½ç½®: {:?}"</span>, matches); <span class="hljs-comment">// [(4, "o"), (14, "o")]</span>
</code></pre>
<h4 data-id="heading-19">4. åˆ†å‰²</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-string">"apple,banana,orange,grape"</span>;

<span class="hljs-comment">// æŒ‰å­—ç¬¦åˆ†å‰²</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fruits</span>: <span class="hljs-type">Vec</span>&lt;&amp;<span class="hljs-type">str</span>&gt; = s.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_ invoke__">collect</span>();
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ°´æœ: {:?}"</span>, fruits); <span class="hljs-comment">// ["apple", "banana", "orange", "grape"]</span>

<span class="hljs-comment">// æŒ‰å­—ç¬¦ä¸²åˆ†å‰²</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span> = <span class="hljs-string">"apple::banana::orange"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fruits2</span>: <span class="hljs-type">Vec</span>&lt;&amp;<span class="hljs-type">str</span>&gt; = s2.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">"::"</span>).<span class="hljs-title function_ invoke__">collect</span>();
<span class="hljs-keyword">for</span> <span class="hljs-variable">f</span> <span class="hljs-keyword">in</span> fruits2 {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, f);
}
<span class="hljs-comment">// æŒ‰é—­åŒ…æ¡ä»¶åˆ†å‰²</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s3</span> = <span class="hljs-string">"apple1banana2orange3"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fruits3</span>: <span class="hljs-type">Vec</span>&lt;&amp;<span class="hljs-type">str</span>&gt; = s3.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-type">char</span>::is_numeric).<span class="hljs-title function_ invoke__">collect</span>();
<span class="hljs-keyword">for</span> <span class="hljs-variable">f</span> <span class="hljs-keyword">in</span> fruits3 {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, f);
}
<span class="hljs-comment">// ä¿ç•™åˆ†å‰²ç¬¦</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s4</span> = <span class="hljs-string">"apple,banana,orange"</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">parts</span>: <span class="hljs-type">Vec</span>&lt;&amp;<span class="hljs-type">str</span>&gt; = s4.<span class="hljs-title function_ invoke__">split_inclusive</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_ invoke__">collect</span>();
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"åŒ…å«åˆ†éš”ç¬¦: {:?}"</span>, parts); <span class="hljs-comment">// ["apple,", "banana,", "orange"]</span>

<span class="hljs-comment">// æŒ‰è¡Œåˆ†å‰²</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">text</span> = <span class="hljs-string">"Line 1\nLine 2\r\nLine 3"</span>;
<span class="hljs-keyword">for</span> <span class="hljs-variable">line</span> <span class="hljs-keyword">in</span> text.<span class="hljs-title function_ invoke__">lines</span>() {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è¡Œ: {}"</span>, line);
}
</code></pre>
<h4 data-id="heading-20">4. å¤§å°å†™è½¬æ¢</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-comment">// è½¬ä¸ºå¤§å†™</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">upper</span> = s.<span class="hljs-title function_ invoke__">to_uppercase</span>();  <span class="hljs-comment">// è¿”å› String</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¤§å†™: {}"</span>, upper);   <span class="hljs-comment">// "HELLO RUST!"</span>

<span class="hljs-comment">// è½¬ä¸ºå°å†™</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">lower</span> = s.<span class="hljs-title function_ invoke__">to_lowercase</span>();  <span class="hljs-comment">// è¿”å› String</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"å°å†™: {}"</span>, lower);   <span class="hljs-comment">// "hello rust!"</span>
</code></pre>
<h4 data-id="heading-21">5. trim</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-string">"   Hello, Rust!   "</span>;
    
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"åŸå§‹: '{}'"</span>, s);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¿®æ•´ä¸¤è¾¹ç©ºç™½: '{}'"</span>, s.<span class="hljs-title function_ invoke__">trim</span>());          <span class="hljs-comment">// "Hello, Rust!"</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¿®æ•´å·¦è¾¹ç©ºç™½: '{}'"</span>, s.<span class="hljs-title function_ invoke__">trim_start</span>());    <span class="hljs-comment">// "Hello, Rust!   "</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¿®æ•´å³è¾¹ç©ºç™½: '{}'"</span>, s.<span class="hljs-title function_ invoke__">trim_end</span>());      <span class="hljs-comment">// "   Hello, Rust!"</span>
</code></pre>
<h4 data-id="heading-22">6. æ›¿æ¢å’Œä¿®æ”¹</h4>
<p>æ›¿æ¢åè¿”å›çš„éƒ½æ˜¯Stringç±»å‹</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-string">"I like cats and cats are cute"</span>;

<span class="hljs-comment">// æ›¿æ¢æ‰€æœ‰åŒ¹é…</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">replaced</span> = s.<span class="hljs-title function_ invoke__">replace</span>(<span class="hljs-string">"cats"</span>, <span class="hljs-string">"dogs"</span>); <span class="hljs-comment">// è¿”å› String</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ›¿æ¢å: {}"</span>, replaced); <span class="hljs-comment">// "I like dogs and dogs are cute"</span>

<span class="hljs-comment">// åªæ›¿æ¢ç¬¬ä¸€ä¸ª</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">replaced_n</span> = s.<span class="hljs-title function_ invoke__">replacen</span>(<span class="hljs-string">"cats"</span>, <span class="hljs-string">"dogs"</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ›¿æ¢ç¬¬ä¸€ä¸ª: {}"</span>, replaced_n); <span class="hljs-comment">// "I like dogs and cats are cute"</span>

<span class="hljs-comment">// æ›¿æ¢èŒƒå›´</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">s_string</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(s);
s_string.<span class="hljs-title function_ invoke__">replace_range</span>(<span class="hljs-number">7</span>..<span class="hljs-number">11</span>, <span class="hljs-string">"dogs"</span>); <span class="hljs-comment">// ä¿®æ”¹ Stringï¼Œä¸æ˜¯ &amp;str</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ›¿æ¢èŒƒå›´: {}"</span>, s_string);
</code></pre>
<p>å…³äºå­—ç¬¦ä¸²è¿˜æœ‰å¾ˆå¤šå†…å®¹éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ï¼Œä½†å…¥é—¨çš„è¯åªè¦å¤§è‡´æŒæ¡ä»¥ä¸Šå†…å®¹å³å¯ã€‚ç­‰å­¦å®ŒRustçš„ä¸€äº›ç‰¹æ®Šè¯­æ³•å†å›å¤´æ¥çœ‹å­—ç¬¦ä¸²ï¼Œå°±ä¼šè§‰å¾—å®ƒéå¸¸ç®€å•äº†ã€‚</p>
<h2 data-id="heading-23">åˆ‡ç‰‡</h2>
<p><strong>åˆ‡ç‰‡ï¼ˆSliceï¼‰</strong> Â æ˜¯ Rust ä¸­å¯¹é›†åˆä¸­<strong>ä¸€æ®µè¿ç»­å…ƒç´ åºåˆ—çš„å¼•ç”¨</strong>ã€‚åˆ‡ç‰‡æ²¡æœ‰æ‰€æœ‰æƒï¼Œåªæ˜¯æ•°æ®çš„<strong>è§†å›¾</strong>ã€‚</p>
<p>åˆ‡ç‰‡æ˜¯ä¸€ä¸ªèƒ–æŒ‡é’ˆï¼ˆfat pointerï¼‰ï¼ŒåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šæŒ‡å‘æ•°æ®çš„æŒ‡é’ˆå’Œåˆ‡ç‰‡çš„é•¿åº¦ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰ã€‚åœ¨å†…å­˜ä¸­ï¼Œåˆ‡ç‰‡å¼•ç”¨ï¼ˆå¦‚<code>&amp;[T]</code>ï¼‰å ç”¨ä¸¤ä¸ªæœºå™¨å­—ï¼ˆåœ¨64ä½ç³»ç»Ÿä¸Šæ˜¯16å­—èŠ‚ï¼‰ã€‚</p>
<p><code>&amp;str</code>æ˜¯å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆ‡ç‰‡ï¼Œå®ƒä¿è¯æ˜¯æœ‰æ•ˆçš„UTF-8ã€‚å­—ç¬¦ä¸²åˆ‡ç‰‡ä¸æ™®é€šåˆ‡ç‰‡ç±»ä¼¼ï¼Œä½†é’ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>
<p>åˆ‡ç‰‡çš„ç±»å‹è¡¨ç¤ºä¸º<code>[T]</code>ï¼Œå…¶ä¸­<code>T</code>æ˜¯å…ƒç´ ç±»å‹ã€‚ç”±äºåˆ‡ç‰‡æ˜¯åŠ¨æ€å¤§å°ç±»å‹ï¼ˆDSTï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨å…¶å¼•ç”¨ï¼š<code>&amp;[T]</code>ï¼ˆä¸å¯å˜åˆ‡ç‰‡ï¼‰æˆ–<code>&amp;mut [T]</code>ï¼ˆå¯å˜åˆ‡ç‰‡ï¼‰ã€‚</p>
<h3 data-id="heading-24">åˆ‡ç‰‡çš„å¸¸ç”¨æ“ä½œ</h3>
<h4 data-id="heading-25">1. åˆ‡ç‰‡åˆ›å»ºå’Œä¿®æ”¹</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// å®Œæ•´åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">full_slice</span>: &amp;[<span class="hljs-type">i32</span>] = &amp;arr[..]; <span class="hljs-comment">// [1, 2, 3, 4, 5]</span>
<span class="hljs-comment">// éƒ¨åˆ†åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">middle</span> = &amp;arr[<span class="hljs-number">1</span>..<span class="hljs-number">4</span>]; <span class="hljs-comment">// [2, 3, 4]ï¼ˆåŒ…å«1ï¼Œä¸åŒ…å«4ï¼‰</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"å®Œæ•´: {:?}"</span>, full_slice);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¸­é—´: {:?}"</span>, middle);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">vec</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];
<span class="hljs-comment">// ä» Vec å€Ÿç”¨åˆ‡ç‰‡</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice1</span>: &amp;[<span class="hljs-type">i32</span>] = &amp;vec; <span class="hljs-comment">// è‡ªåŠ¨è§£å¼•ç”¨è½¬æ¢</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice2</span>: &amp;[<span class="hljs-type">i32</span>] = &amp;vec[..]; <span class="hljs-comment">// æ˜¾å¼åˆ‡ç‰‡,ç»“æœå’Œè‡ªåŠ¨è§£å¼•ç”¨ä¸€è‡´,ä½†è¿‡ç¨‹ä¸ä¸€æ ·</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"å‘é‡åˆ‡ç‰‡: {:?}"</span>, slice1);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ˜¾å¼åˆ‡ç‰‡: {:?}"</span>, slice2);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Hello, Rust!"</span>);

<span class="hljs-comment">// å­—ç¬¦ä¸²åˆ‡ç‰‡æ˜¯ &amp;strï¼Œå®ƒæ˜¯ &amp;[u8] çš„ç‰¹æ®Šå½¢å¼</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">str_slice</span>: &amp;<span class="hljs-type">str</span> = &amp;s[..]; <span class="hljs-comment">// æ•´ä¸ªå­—ç¬¦ä¸²</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, str_slice);
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¯å˜åˆ‡ç‰‡"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">data</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice</span>: &amp;<span class="hljs-keyword">mut</span> [<span class="hljs-type">i32</span>] = &amp;<span class="hljs-keyword">mut</span> data[<span class="hljs-number">1</span>..<span class="hljs-number">4</span>]; <span class="hljs-comment">// å¯å˜åˆ‡ç‰‡[2,3,4]</span>

<span class="hljs-comment">// å¯ä»¥ä¿®æ”¹å…ƒç´ </span>
slice[<span class="hljs-number">0</span>] = <span class="hljs-number">20</span>; <span class="hljs-comment">// ä¿®æ”¹ç¬¬ä¸€ä¸ªå…ƒç´  ,[20,3,4]</span>
slice.<span class="hljs-title function_ invoke__">swap</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// äº¤æ¢å…ƒç´  [4,3,20]</span>

slice.<span class="hljs-title function_ invoke__">reverse</span>(); <span class="hljs-comment">// åè½¬åˆ‡ç‰‡[20,3,4]</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¿®æ”¹åçš„æ•°æ®: {:?}"</span>, data); <span class="hljs-comment">// [1, 20, 3, 4, 5]</span>
</code></pre>
<h4 data-id="heading-26">2. åˆ‡ç‰‡æœç´¢</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">slice</span> = &amp;[<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];

<span class="hljs-comment">// çº¿æ€§æœç´¢</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(pos) = slice.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">position</span>(|&amp;x| x == <span class="hljs-number">20</span>) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç¬¬ä¸€ä¸ª20åœ¨ä½ç½®: {}"</span>, pos); <span class="hljs-comment">// 1</span>
}

<span class="hljs-comment">// ä»åå‘å‰æœç´¢</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(pos) = slice.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">rposition</span>(|&amp;x| x == <span class="hljs-number">20</span>) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æœ€åä¸€ä¸ª20åœ¨ä½ç½®: {}"</span>, pos); <span class="hljs-comment">// 3</span>
}

<span class="hljs-comment">// äºŒåˆ†æœç´¢ï¼ˆéœ€è¦æ’åºï¼‰</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sorted</span> = &amp;[<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];
<span class="hljs-keyword">match</span> sorted.<span class="hljs-title function_ invoke__">binary_search</span>(&amp;<span class="hljs-number">30</span>) {
    <span class="hljs-title function_ invoke__">Ok</span>(pos) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"30åœ¨ä½ç½®: {}"</span>, pos), <span class="hljs-comment">// 2</span>
    <span class="hljs-title function_ invoke__">Err</span>(pos) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"30åº”è¯¥åœ¨ä½ç½®: {}"</span>, pos),
}

<span class="hljs-comment">// æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„å…ƒç´ </span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(&amp;value) = slice.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">find</span>(|&amp;&amp;x| x &gt; <span class="hljs-number">25</span>) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç¬¬ä¸€ä¸ªå¤§äº25çš„æ•°: {}"</span>, value); <span class="hljs-comment">// 30</span>
}
</code></pre>
<h2 data-id="heading-27">æ•°ç»„</h2>
<p>æ•°ç»„æ˜¯Rustä¸­å›ºå®šå¤§å°çš„ã€ç›¸åŒç±»å‹çš„å…ƒç´ çš„é›†åˆï¼Œå­˜å‚¨åœ¨æ ˆä¸Šã€‚<br/>
æ•°ç»„çš„ç±»å‹è¡¨ç¤ºä¸º[T; N]ï¼Œå…¶ä¸­Tæ˜¯å…ƒç´ ç±»å‹ï¼ŒNæ˜¯æ•°ç»„é•¿åº¦ï¼Œä¸”Nåœ¨ç¼–è¯‘æ—¶å¿…é¡»å·²çŸ¥ã€‚</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å›ºå®šé•¿åº¦ï¼šä¸€æ—¦å£°æ˜ï¼Œé•¿åº¦ä¸èƒ½æ”¹å˜ã€‚</li>
<li>å…ƒç´ ç±»å‹ç›¸åŒã€‚</li>
<li>å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜åŒºåŸŸï¼ˆæ ˆä¸Šï¼‰ã€‚</li>
<li>é€šè¿‡ç´¢å¼•è®¿é—®ï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚</li>
</ol>
<p><strong>æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ«ï¼š</strong>  æ•°ç»„é•¿åº¦å›ºå®šï¼Œåˆ‡ç‰‡é•¿åº¦åŠ¨æ€ã€‚æ•°ç»„å­˜å‚¨åœ¨æ ˆä¸Šï¼ˆé™¤éè¢«ç§»åŠ¨ï¼‰ï¼Œåˆ‡ç‰‡æ˜¯å¼•ç”¨ï¼ŒæŒ‡å‘ä¸€æ®µè¿ç»­å†…å­˜ã€‚</p>
<h3 data-id="heading-28">æ•°ç»„çš„å¸¸ç”¨æ“ä½œ</h3>
<h4 data-id="heading-29">1. æ•°ç»„åˆ›å»ºå’Œå…ƒç´ è®¿é—®</h4>
<pre><code class="hljs language-rust" lang="rust">    <span class="hljs-comment">// å®Œæ•´åˆå§‹åŒ–</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arr1</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

    <span class="hljs-comment">// é‡å¤å€¼åˆå§‹åŒ–ï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">zeros</span> = [<span class="hljs-number">0</span>; <span class="hljs-number">10</span>]; <span class="hljs-comment">// [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å®Œæ•´: {:?}"</span>, arr1);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é›¶æ•°ç»„: {:?}"</span>, zeros);

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arr</span> = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];

    <span class="hljs-comment">// è¯»å–å…ƒç´ </span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">first</span> = arr[<span class="hljs-number">0</span>]; <span class="hljs-comment">// 10</span>

    <span class="hljs-comment">// å®‰å…¨è®¿é—®</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(value) = arr.<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-number">2</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å®‰å…¨è®¿é—®ç¬¬ä¸‰ä¸ªå…ƒç´ : {}"</span>, value); <span class="hljs-comment">// 30</span>
    }

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">point</span> = [<span class="hljs-number">10.0</span>, <span class="hljs-number">20.0</span>, <span class="hljs-number">30.0</span>];

    <span class="hljs-comment">// è§£æ„æ•°ç»„</span>
    <span class="hljs-keyword">let</span> [x, y, z] = point;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åæ ‡: x={}, y={}, z={}"</span>, x, y, z);

    <span class="hljs-comment">// éƒ¨åˆ†è§£æ„</span>
    <span class="hljs-keyword">let</span> [first, .., last] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç¬¬ä¸€ä¸ª: {}, æœ€åä¸€ä¸ª: {}"</span>, first, last);
</code></pre>
<h4 data-id="heading-30">2. æ•°ç»„éå†</h4>
<pre><code class="hljs language-rust" lang="rust"> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">arr</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

    <span class="hljs-comment">// 1. ä½¿ç”¨ for å¾ªç¯ï¼ˆå€Ÿç”¨ï¼‰</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"for å¾ªç¯ï¼ˆå€Ÿç”¨ï¼‰:"</span>);
    <span class="hljs-keyword">for</span> &amp;item <span class="hljs-keyword">in</span> &amp;arr {
        <span class="hljs-built_in">print!</span>(<span class="hljs-string">"{} "</span>, item); <span class="hljs-comment">// 1 2 3 4 5</span>
    }
    <span class="hljs-built_in">println!</span>();

    <span class="hljs-comment">// 2. ä½¿ç”¨ for å¾ªç¯ï¼ˆç›´æ¥è¿­ä»£ï¼‰</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"for å¾ªç¯ï¼ˆç›´æ¥ï¼‰:"</span>);
    <span class="hljs-keyword">for</span> <span class="hljs-variable">item</span> <span class="hljs-keyword">in</span> arr {
        <span class="hljs-built_in">print!</span>(<span class="hljs-string">"{} "</span>, item); <span class="hljs-comment">// 1 2 3 4 5</span>
    }
    <span class="hljs-built_in">println!</span>();

    <span class="hljs-comment">// 3. ä½¿ç”¨ iter() æ–¹æ³•</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"iter() æ–¹æ³•:"</span>);
    <span class="hljs-keyword">for</span> <span class="hljs-variable">item</span> <span class="hljs-keyword">in</span> arr.<span class="hljs-title function_ invoke__">iter</span>() {
        <span class="hljs-built_in">print!</span>(<span class="hljs-string">"{} "</span>, item); <span class="hljs-comment">// 1 2 3 4 5</span>
    }
    <span class="hljs-built_in">println!</span>();

    <span class="hljs-comment">// 4. ä½¿ç”¨è¿­ä»£å™¨æ–¹æ³•</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sum</span>: <span class="hljs-type">i32</span> = arr.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">sum</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">doubled</span>: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">i32</span>&gt; = arr.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">map</span>(|&amp;x| x * <span class="hljs-number">2</span>).<span class="hljs-title function_ invoke__">collect</span>();<span class="hljs-comment">//åæ–‡å°†æ›´è¯¦ç»†ä»‹ç»è¿­ä»£å™¨</span>

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ€»å’Œ: {}"</span>, sum); <span class="hljs-comment">// 15</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åŠ å€å: {:?}"</span>, doubled); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>
</code></pre>
<h2 data-id="heading-31">å…ƒç»„</h2>
<p><strong>å…ƒç»„ï¼ˆTupleï¼‰</strong> æ˜¯ä¸€ç§å¯ä»¥å­˜æ”¾<strong>å¤šä¸ªä¸åŒç±»å‹çš„å€¼</strong>çš„æ•°æ®ç±»å‹ï¼Œå®ƒå°†è¿™äº›å€¼ç»„åˆæˆä¸€ä¸ªæ•´ä½“ã€‚å…ƒç»„çš„å€¼æ˜¯æœ‰é¡ºåºçš„ï¼Œå¯ä»¥é€šè¿‡ä½ç½®ç´¢å¼•è®¿é—®ã€‚</p>
<ul>
<li>è¯­æ³•ï¼šåœ¨å°æ‹¬å·å†…ç”¨é€—å·åˆ†éš”å¤šä¸ªå…ƒç´ ã€‚ä¾‹å¦‚ï¼š<code>(i32, f64, char)</code></li>
<li>å…ƒç»„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œåˆ›å»ºæ—¶å°±ç¡®å®šä¸å¯å˜ã€‚</li>
<li>å…ƒç»„å¯ä»¥åŒ…å«ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹çš„å…ƒç´ ã€‚</li>
</ul>
<pre><code class="hljs language-rust" lang="rust">    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">tup</span> = (<span class="hljs-number">500</span>, <span class="hljs-number">6.4</span>, <span class="hljs-number">1</span>);
    <span class="hljs-keyword">let</span> (x, y, z) = tup; <span class="hljs-comment">// è§£æ„ï¼Œåˆ†åˆ«ç»‘å®šåˆ° x, y, z</span>

</code></pre>
<h2 data-id="heading-32">å•å…ƒ</h2>
<p>Rustä¸­çš„<code>()</code>å±…ç„¶ä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹ï¼Œè¿™ä¸ªç±»å‹å°±æ˜¯å•å…ƒ<code>()</code>ï¼Œè¿™ä¸ªç±»å‹åªæœ‰ä¸€ä¸ªå€¼,ä¹Ÿæ˜¯<code>()</code>ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°å®é™…ä¸Šè¿”å› ()</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">say_hello</span>(name: &amp;<span class="hljs-type">str</span>) {  <span class="hljs-comment">// ç­‰ä»·äº -&gt; ()</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Hello, {}!"</span>, name);
    <span class="hljs-comment">// éšå¼è¿”å› ()</span>
}
 <span class="hljs-comment">// è¡¨è¾¾å¼è¯­å¥çš„å€¼æ˜¯ ()</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = <span class="hljs-number">5</span>;
        y + <span class="hljs-number">1</span>  <span class="hljs-comment">// è¡¨è¾¾å¼ï¼Œè¿”å› 6</span>
    };  <span class="hljs-comment">// x = 6</span>
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">z</span> = {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = <span class="hljs-number">5</span>;
        y + <span class="hljs-number">1</span>;  <span class="hljs-comment">// è¯­å¥ï¼Œè¿”å› ()</span>
    };  <span class="hljs-comment">// z = ()</span>
</code></pre>
<h2 data-id="heading-33">never</h2>
<p><strong>Never ç±»å‹</strong>Â <code>!</code>Â æ˜¯ Rust ä¸­è¡¨ç¤º<strong>æ°¸ä¸è¿”å›</strong>çš„è®¡ç®—çš„ç±»å‹ã€‚å®ƒæ˜¯<strong>é›¶å¤§å°ç±»å‹</strong>ï¼Œè¡¨ç¤ºä¸€ä¸ªæ°¸è¿œä¸ä¼šäº§ç”Ÿå€¼çš„è®¡ç®—ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">infinite_loop</span>() <span class="hljs-punctuation">-&gt;</span> ! {
    <span class="hljs-keyword">loop</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ°¸è¿œå¾ªç¯..."</span>);
    }
}
</code></pre>
<p>neverç±»å‹çš„å…³é”®ç‰¹æ€§æ˜¯<strong>å¯ä»¥å¼ºåˆ¶è½¬æ¢ä¸ºä»»ä½•ç±»å‹</strong>ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">not_implemented_yet</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    todo!(<span class="hljs-string">"è¿˜æ²¡å®ç°è¿™ä¸ªåŠŸèƒ½"</span>); <span class="hljs-comment">// è¿”å› !ï¼Œä½†å‡½æ•°ç­¾åè¦æ±‚ String</span>
}

</code></pre>
<h2 data-id="heading-34">referenceå’Œpointer</h2>
<p>Rust ä¸­çš„ <strong>Pointer</strong>ï¼ˆæŒ‡é’ˆï¼‰å’Œ <strong>Reference</strong>ï¼ˆå¼•ç”¨ï¼‰æ˜¯å†…å­˜æ“ä½œä¸æ‰€æœ‰æƒæ¨¡å‹çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæœ¬èŠ‚ç®€å•ä»‹ç»è¿™ä¸¤è€…å«ä¹‰ï¼Œåç»­å°†è¯¦ç»†è§£æRustçš„æ‰€æœ‰æƒæ¨¡å‹ã€‚</p>
<h3 data-id="heading-35">1. Referenceï¼ˆå¼•ç”¨ï¼‰</h3>
<ul>
<li><strong>å¼•ç”¨</strong>æ˜¯å¯¹å·²æœ‰å€¼çš„â€œå€Ÿç”¨â€ï¼Œä¸ä¼šè·å¾—æ‰€æœ‰æƒï¼Œå› æ­¤ä¸ä¼šé”€æ¯å€¼ã€‚</li>
<li><strong>è¯­æ³•</strong>ï¼š<code>&amp;T</code>ï¼ˆä¸å¯å˜å¼•ç”¨ï¼‰ï¼Œ<code>&amp;mut T</code>ï¼ˆå¯å˜å¼•ç”¨ï¼‰</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">    let <span class="hljs-attr">x</span> = <span class="hljs-number">42</span><span class="hljs-comment">;</span>
    let r: &amp;<span class="hljs-attr">i32</span> = &amp;x<span class="hljs-comment">; // ä¸å¯å˜å¼•ç”¨</span>
    println!("r: {}", r)<span class="hljs-comment">;</span>

    let mut <span class="hljs-attr">y</span> = <span class="hljs-number">5</span><span class="hljs-comment">;</span>
    let m: &amp;mut <span class="hljs-attr">i32</span> = &amp;mut y<span class="hljs-comment">; // å¯å˜å¼•ç”¨</span>
    *m += 1<span class="hljs-comment">;</span>

    println!("y: {}", y)<span class="hljs-comment">; //6</span>
</code></pre>
<h3 data-id="heading-36">2. Pointerï¼ˆæŒ‡é’ˆï¼‰</h3>
<p>æŒ‡é’ˆæ˜¯æ›´åº•å±‚çš„å†…å­˜åœ°å€ã€‚Rust æœ‰å¤šç§æŒ‡é’ˆç±»å‹ï¼Œå„è‡ªæœ‰ä¸åŒçš„å®‰å…¨çº§åˆ«å’Œç”¨é€”ã€‚</p>
<h4 data-id="heading-37">è£¸æŒ‡é’ˆï¼ˆraw pointerï¼‰</h4>
<p><code>*const T</code> å’Œ <code>*mut T</code></p>
<ul>
<li><strong><code>*const T</code></strong>ï¼šä¸å¯å˜åŸç”ŸæŒ‡é’ˆï¼ˆè£¸æŒ‡é’ˆï¼‰</li>
<li><strong><code>*mut T</code></strong>ï¼šå¯å˜åŸç”ŸæŒ‡é’ˆï¼ˆè£¸æŒ‡é’ˆï¼‰</li>
<li>æ²¡æœ‰è‡ªåŠ¨ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥ã€ä¸ä¿è¯å®‰å…¨ï¼Œ<strong>éœ€è¦ <code>unsafe</code> ä»£ç ä½¿ç”¨</strong>ã€‚</li>
</ul>
<h4 data-id="heading-38">æ™ºèƒ½æŒ‡é’ˆï¼ˆsmart pointerï¼‰</h4>
<p><strong>æ™ºèƒ½æŒ‡é’ˆ</strong>æ˜¯æŒ‡é’ˆçš„å‡çº§ç‰ˆï¼Œä¹Ÿå®é™…æ‹¥æœ‰æˆ–ç®¡ç†å†…å­˜ï¼Œå¸¸è§æœ‰ï¼š</p>
<ul>
<li><strong>Box</strong> ï¼šå †åˆ†é…ï¼Œæ‰€æœ‰æƒæ˜ç¡®ï¼Œå•ä¸€æ‰€æœ‰è€…</li>
<li><strong>Rc</strong> ï¼ˆReference Countedï¼‰ï¼šå¼•ç”¨è®¡æ•°ï¼Œé€‚åˆå•çº¿ç¨‹å¤šæ‰€æœ‰è€…</li>
<li><strong>Arc</strong> ï¼ˆAtomic Reference Countedï¼‰ï¼šå¤šçº¿ç¨‹å®‰å…¨çš„å¼•ç”¨è®¡æ•°</li>
<li><strong>RefCell</strong> ã€<strong>Mutex</strong> ç­‰ï¼šè¿è¡Œæ—¶å¯å˜æ€§çš„æ™ºèƒ½æŒ‡é’ˆ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ ï¼šKotlinä¸­çš„JvmOverloadsæ³¨è§£]]></title>    <link>https://juejin.cn/post/7603376587651940402</link>    <guid>https://juejin.cn/post/7603376587651940402</guid>    <pubDate>2026-02-06T08:53:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603376587651940402" data-draft-id="7603347438013268003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ ï¼šKotlinä¸­çš„JvmOverloadsæ³¨è§£"/> <meta itemprop="keywords" content="Kotlin,Java"/> <meta itemprop="datePublished" content="2026-02-06T08:53:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="unravel2025"/> <meta itemprop="url" content="https://juejin.cn/user/1116759541421880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ ï¼šKotlinä¸­çš„JvmOverloadsæ³¨è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759541421880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    unravel2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T08:53:42.000Z" title="Fri Feb 06 2026 08:53:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    19
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>@JvmOverloads æ˜¯ Kotlin ä¸­ä¸€ä¸ªéå¸¸å®ç”¨ä¸”é‡è¦çš„æ³¨è§£ï¼Œå®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ä¸º Kotlin å‡½æ•°è‡ªåŠ¨ç”Ÿæˆ Java å‹å¥½çš„é‡è½½æ–¹æ³•ï¼Œä»è€Œç®€åŒ– Kotlin ä¸ Java ä¹‹é—´çš„äº’æ“ä½œã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒä½œç”¨ï¼šè§£å†³é»˜è®¤å‚æ•°çš„äº’æ“ä½œæ€§é—®é¢˜</h2>
<p>Kotlin æ”¯æŒå‡½æ•°çš„é»˜è®¤å‚æ•°ï¼Œè¿™æå¤§åœ°æé«˜äº†ä»£ç çš„ç®€æ´æ€§å’Œå¯è¯»æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ä»£ç </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dialog</span>(
    <span class="hljs-keyword">val</span> title: String,
    <span class="hljs-keyword">val</span> message: String = <span class="hljs-string">"Default Message"</span>, <span class="hljs-comment">// é»˜è®¤å‚æ•°</span>
    <span class="hljs-keyword">val</span> okButtonText: String = <span class="hljs-string">"OK"</span>          <span class="hljs-comment">// é»˜è®¤å‚æ•°</span>
) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span> { <span class="hljs-comment">/* ... */</span> }
}

</code></pre>
<p>åœ¨ Kotlin ä¸­è°ƒç”¨æ—¶ï¼Œä½ å¯ä»¥éå¸¸çµæ´»åœ°çœç•¥æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> dialog1 = Dialog(<span class="hljs-string">"Warning"</span>) <span class="hljs-comment">// message å’Œ okButtonText ä½¿ç”¨é»˜è®¤å€¼</span>
<span class="hljs-keyword">val</span> dialog2 = Dialog(<span class="hljs-string">"Warning"</span>, <span class="hljs-string">"Custom Message"</span>) <span class="hljs-comment">// åªçœç•¥æœ€åä¸€ä¸ªå‚æ•°</span>
<span class="hljs-keyword">val</span> dialog3 = Dialog(<span class="hljs-string">"Warning"</span>, <span class="hljs-string">"Custom Message"</span>, <span class="hljs-string">"Confirm"</span>)
</code></pre>
<p>ç„¶è€Œï¼ŒJava è¯­è¨€æœ¬èº«ä¸æ”¯æŒé»˜è®¤å‚æ•°ã€‚å¦‚æœä¸Šé¢çš„ Dialog ç±»è¢« Java ä»£ç è°ƒç”¨ï¼Œæƒ…å†µå°±å˜å¾—å¾ˆéº»çƒ¦ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Java ä»£ç  - æ²¡æœ‰ @JvmOverloads çš„æƒ…å†µ</span>
<span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dialog</span>(<span class="hljs-string">"Warning"</span>); <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼ç¼ºå°‘ message å’Œ okButtonText å‚æ•°</span>

<span class="hljs-comment">// ä½ å¿…é¡»æ˜¾å¼åœ°ä¼ å…¥æ‰€æœ‰å‚æ•°ï¼Œå³ä½¿ä½ æƒ³ç”¨é»˜è®¤å€¼</span>
<span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dialog</span>(<span class="hljs-string">"Warning"</span>, <span class="hljs-string">"Default Message"</span>, <span class="hljs-string">"OK"</span>);
</code></pre>
<p>ä¸ºäº†è®© Java ä¹Ÿèƒ½æ–¹ä¾¿åœ°è°ƒç”¨è¿™äº›å¸¦æœ‰é»˜è®¤å‚æ•°çš„ Kotlin å‡½æ•°ï¼Œ@JvmOverloads æ³¨è§£åº”è¿è€Œç”Ÿã€‚</p>
<h2 data-id="heading-2">@JvmOverloads çš„å·¥ä½œåŸç†</h2>
<p>å½“ä½ åœ¨ä¸€ä¸ª Kotlin æ„é€ å‡½æ•°æˆ–å‡½æ•°ä¸Šæ·»åŠ  @JvmOverloads æ³¨è§£åï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºè¯¥å‡½æ•°ç”Ÿæˆä¸€ç³»åˆ—é‡è½½ç‰ˆæœ¬ï¼Œæ¯ä¸ªé‡è½½ç‰ˆæœ¬ä¾æ¬¡çœç•¥å°¾éƒ¨æœ‰é»˜è®¤å€¼çš„å‚æ•°ã€‚</p>
<p>å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬åŠ ä¸Šæ³¨è§£ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dialog</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span>( <span class="hljs-comment">// æ³¨æ„æ³¨è§£åŠ åœ¨ constructor å…³é”®å­—å‰</span>
    <span class="hljs-keyword">val</span> title: String,
    <span class="hljs-keyword">val</span> message: String = <span class="hljs-string">"Default Message"</span>,
    <span class="hljs-keyword">val</span> okButtonText: String = <span class="hljs-string">"OK"</span>
) {
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>ç°åœ¨ï¼ŒKotlin ç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆä»¥ä¸‹ä¸‰ä¸ªæ„é€ å‡½æ•°çš„é‡è½½æ–¹æ³•ï¼ˆä¾› Java è°ƒç”¨ï¼‰ï¼š</p>
<ol>
<li>å…¨å‚æ•°ç‰ˆæœ¬ï¼šDialog(String title, String message, String okButtonText)</li>
<li>çœç•¥æœ€åä¸€ä¸ªé»˜è®¤å‚æ•°ï¼šDialog(String title, String message)</li>
<li>çœç•¥æœ€åä¸¤ä¸ªé»˜è®¤å‚æ•°ï¼šDialog(String title)</li>
</ol>
<p>è¿™æ ·ï¼ŒJava ä»£ç å°±å¯ä»¥åƒè°ƒç”¨æ™®é€š Java æ„é€ å‡½æ•°ä¸€æ ·æ–¹ä¾¿åœ°ä½¿ç”¨äº†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Java ä»£ç  - æœ‰ @JvmOverloads çš„æƒ…å†µ</span>
<span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dialog</span>(<span class="hljs-string">"Warning"</span>); <span class="hljs-comment">// å®Œç¾å·¥ä½œï¼</span>
<span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dialog</span>(<span class="hljs-string">"Warning"</span>, <span class="hljs-string">"Custom Message"</span>);
<span class="hljs-type">Dialog</span> <span class="hljs-variable">dialog3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dialog</span>(<span class="hljs-string">"Warning"</span>, <span class="hljs-string">"Custom Message"</span>, <span class="hljs-string">"Confirm"</span>);
</code></pre>
<p>å¯¹äºå‡½æ•°ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin å‡½æ•°</span>
<span class="hljs-meta">@JvmOverloads</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showToast</span><span class="hljs-params">(message: <span class="hljs-type">String</span>, length: <span class="hljs-type">Int</span> = Toast.LENGTH_SHORT, gravity: <span class="hljs-type">Int</span> = Gravity.CENTER)</span></span> {
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>ç¼–è¯‘å™¨ä¼šç”Ÿæˆï¼š</p>
<pre><code class="hljs language-java" lang="java">â€¢ showToast(String message)

â€¢ showToast(String message, <span class="hljs-type">int</span> length)

â€¢ showToast(String message, <span class="hljs-type">int</span> length, <span class="hljs-type">int</span> gravity)
</code></pre>
<h2 data-id="heading-3">è¯­æ³•è¦ç‚¹å’Œæ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p>æ ‡æ³¨ä½ç½®ï¼š
â—¦ å¯¹äºæ„é€ å‡½æ•°ï¼šæ³¨è§£è¦æ”¾åœ¨ constructor å…³é”®å­—ä¹‹å‰ã€‚</p>
<p><code>class MyClass @JvmOverloads constructor(...)</code></p>
<p>â—¦ å¯¹äºæˆå‘˜å‡½æ•°/é¡¶å±‚å‡½æ•°ï¼šç›´æ¥æ”¾åœ¨ fun å…³é”®å­—ä¹‹å‰ã€‚</p>
<p><code>@JvmOverloads fun myFunction(...)</code></p>
</li>
<li>
<p>é»˜è®¤å‚æ•°å¿…é¡»ä»å³å‘å·¦è¿ç»­è®¾ç½®ï¼š@JvmOverloads åªèƒ½ä¸ºå°¾éƒ¨çš„ã€è¿ç»­çš„é»˜è®¤å‚æ•°ç”Ÿæˆé‡è½½ã€‚å¦‚æœä¸­é—´æŸä¸ªå‚æ•°æœ‰é»˜è®¤å€¼ï¼Œè€Œå®ƒå³è¾¹çš„å‚æ•°æ²¡æœ‰é»˜è®¤å€¼ï¼Œåˆ™æ— æ³•ä¸ºä¸­é—´è¿™ä¸ªå‚æ•°ç”Ÿæˆé‡è½½ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä»å³å‘å·¦</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">example</span><span class="hljs-params">(a: <span class="hljs-type">Int</span>, b: <span class="hljs-type">String</span> = <span class="hljs-string">"B"</span>, c: <span class="hljs-type">Boolean</span> = <span class="hljs-literal">true</span>)</span></span>
<span class="hljs-comment">// ä¼šç”Ÿæˆ example(a), example(a, b), example(a, b, c)</span>

<span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šé»˜è®¤å€¼ä¸è¿ç»­</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">badExample</span><span class="hljs-params">(a: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span>, b: <span class="hljs-type">String</span>, c: <span class="hljs-type">Boolean</span> = <span class="hljs-literal">true</span>)</span></span>
<span class="hljs-comment">// åªèƒ½ç”Ÿæˆ badExample(a, b, c)ï¼Œå› ä¸º b æ²¡æœ‰é»˜è®¤å€¼ï¼Œæ‰“æ–­äº†è¿ç»­æ€§ã€‚</span>
</code></pre>
</li>
<li>
<p>ç”Ÿæˆçš„é‡è½½æ–¹æ³•ä¼šå¢åŠ æ–¹æ³•æ•°ï¼šè™½ç„¶å¸¦æ¥äº†ä¾¿åˆ©ï¼Œä½†å¦‚æœä½ è¿‡åº¦ä½¿ç”¨ï¼ˆå°¤å…¶æ˜¯åœ¨æœ‰å¾ˆå¤šé»˜è®¤å‚æ•°çš„ç±»ä¸­ï¼‰ï¼Œå¯èƒ½ä¼šæ˜¾è‘—å¢åŠ ç±»ä¸­çš„æ–¹æ³•æ•°é‡ï¼ˆå­—èŠ‚ç å±‚é¢ï¼‰ã€‚åœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯éœ€è¦ç•™æ„ã€‚</p>
</li>
<li>
<p>Kotlin è‡ªèº«è°ƒç”¨ä¸å—å½±å“ï¼š@JvmOverloads åªæ˜¯ä¸€ä¸ªç»™ç¼–è¯‘å™¨çš„æŒ‡ä»¤ï¼Œç”¨äºç”Ÿæˆ Java äº’æ“ä½œçš„é‡è½½æ–¹æ³•ã€‚åœ¨ Kotlin ä»£ç ä¸­ï¼Œä½ ä»ç„¶äº«å—é»˜è®¤å‚æ•°å¸¦æ¥çš„å…¨éƒ¨ä¾¿åˆ©ï¼Œä¸ä¼šç”Ÿæˆä»»ä½•é¢å¤–çš„ Kotlin æ–¹æ³•ã€‚</p>
</li>
</ol>
<h2 data-id="heading-4">æ€»ç»“</h2>
<h3 data-id="heading-5"><code>@JvmOverloads</code> ä½¿ç”¨å¯¹æ¯”</h3>

























<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ²¡æœ‰ <code>@JvmOverloads</code></th><th align="left">æœ‰ <code>@JvmOverloads</code></th></tr></thead><tbody><tr><td align="left"><strong>Kotlin è°ƒç”¨</strong></td><td align="left">å¯è‡ªç”±çœç•¥å°¾éƒ¨é»˜è®¤å‚æ•°</td><td align="left">å¯è‡ªç”±çœç•¥å°¾éƒ¨é»˜è®¤å‚æ•°ï¼ˆæ— å˜åŒ–ï¼‰</td></tr><tr><td align="left"><strong>Java è°ƒç”¨</strong></td><td align="left">å¿…é¡»ä¼ å…¥æ‰€æœ‰éé»˜è®¤å‚æ•°ï¼Œç¹ç</td><td align="left">å¯ä»¥åƒè°ƒç”¨æ™®é€š Java æ–¹æ³•ä¸€æ ·ï¼Œä¼˜é›…åœ°çœç•¥å°¾éƒ¨å‚æ•°</td></tr><tr><td align="left"><strong>å®ç°æ–¹å¼</strong></td><td align="left">-</td><td align="left">ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆä¸€ç³»åˆ—é‡è½½æ–¹æ³•</td></tr></tbody></table>
<p>æ€»è€Œè¨€ä¹‹ï¼Œ@JvmOverloads æ˜¯ä¸€ä¸ªä¸“ä¸ºæå‡ Kotlin ä¸ Java äº’æ“ä½œæ€§è€Œè®¾è®¡çš„è¯­æ³•ç³–ã€‚å®ƒé€šè¿‡è‡ªåŠ¨ç”Ÿæˆé‡è½½æ–¹æ³•ï¼Œè®© Java å¼€å‘è€…èƒ½å¤Ÿæ— ç¼åœ°ä½¿ç”¨ Kotlin ä¸­é‚£äº›å¸¦æœ‰é»˜è®¤å‚æ•°çš„å‡½æ•°å’Œæ„é€ å‡½æ•°ï¼Œæå¤§åœ°æ”¹å–„äº†æ··åˆå¼€å‘é¡¹ç›®çš„ä½“éªŒã€‚ åœ¨è®¾è®¡ä¾›å¤–éƒ¨ï¼ˆå°¤å…¶æ˜¯ Javaï¼‰è°ƒç”¨çš„ API æ—¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—ä½¿ç”¨çš„æ³¨è§£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸æ­¢æ˜¯å†™ä»£ç ï½œå¦‚ä½•ç”¨ TRAE è¿›è¡Œå¤æ‚æ•°æ®åˆ†æ]]></title>    <link>https://juejin.cn/post/7603389033042378806</link>    <guid>https://juejin.cn/post/7603389033042378806</guid>    <pubDate>2026-02-06T09:20:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603389033042378806" data-draft-id="7603314759758741523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸æ­¢æ˜¯å†™ä»£ç ï½œå¦‚ä½•ç”¨ TRAE è¿›è¡Œå¤æ‚æ•°æ®åˆ†æ"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2026-02-06T09:20:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="TRAE_ai"/> <meta itemprop="url" content="https://juejin.cn/user/3048259110571032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸æ­¢æ˜¯å†™ä»£ç ï½œå¦‚ä½•ç”¨ TRAE è¿›è¡Œå¤æ‚æ•°æ®åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3048259110571032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    TRAE_ai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T09:20:06.000Z" title="Fri Feb 06 2026 09:20:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2614d47a9d2d4cc596e4bc73b405dd31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=1WIZxUdEAAT4RmoPdkNdtDrC7Ro%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>æœ¬æ–‡ä½œè€…ï¼šæ¨è¾‰ï¼ŒTRAE æˆ˜ç•¥åˆ†æå¸ˆ</p>
</blockquote>
<p>æœ¬æ–‡æ¥è‡ª TRAE å›¢é˜Ÿçš„æˆ˜ç•¥åˆ†æåŒå­¦ï¼Œä»–å°†ä»â€œä»€ä¹ˆæ˜¯æ•°æ®åˆ†æâ€ä»¥åŠâ€œæ•°æ®åˆ†æçš„å¸¸è§ç—›ç‚¹â€è¿™ä¸¤ä¸ªåŸºæœ¬é—®é¢˜å‡ºå‘ï¼Œç»“åˆä¸¤ä¸ªçœŸå®æ•°æ®åˆ†æåœºæ™¯ï¼Œå¸¦å¤§å®¶å®é™…æ“ä½œå¦‚ä½•ä½¿ç”¨ IDE è¿›è¡Œæ•°æ®åˆ†æã€‚è®©æ›´å¤šçš„éå¼€å‘èƒŒæ™¯çš„åŒå­¦ä¹Ÿèƒ½è½»æ¾åº”å¯¹å¤æ‚çš„æ•°æ®åˆ†æä»»åŠ¡ã€‚</p>
<blockquote>
<p>æœ¬æ–‡å®è·µæ“ä½œç‰ˆæœ¬ï¼šTRAE ä¸­å›½ç‰ˆ</p>
<p>æ¨¡å‹é€‰æ‹©ï¼šAuto æ¨¡å¼</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ed0f9030e164d7a97380a8531e867db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=0oYW9QTgzcg8LFSYvyB%2BYpS8lZA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0"><strong>ä»€ä¹ˆæ˜¯æ•°æ®åˆ†æï¼Ÿ</strong></h2>
<p>æ•°æ®åˆ†ææ˜¯æŒ‡é€šè¿‡<strong>æ”¶é›†ã€æ¸…æ´—ã€æ•´ç†ã€åˆ†æå’Œè§£è¯»æ•°æ®ï¼Œæå–æœ‰ä»·å€¼ä¿¡æ¯ã€æŒ–æ˜æ•°æ®è§„å¾‹</strong>ï¼Œä»è€Œä¸ºå†³ç­–æä¾›ä¾æ®çš„è¿‡ç¨‹ã€‚å®ƒæ ¸å¿ƒä»·å€¼åœ¨äº<strong>å°†é›¶æ•£çš„æ•°æ®è½¬åŒ–ä¸ºå¯è½åœ°çš„æ´å¯Ÿ</strong>ï¼ŒåŠ©åŠ›ä¸åŒé¢†åŸŸè§£å†³é—®é¢˜ã€ä¼˜åŒ–æµç¨‹ã€æå‡æ•ˆç‡ã€‚</p>
<p>åœ¨ä¼—å¤šèŒä¸šï¼ˆä¾‹å¦‚å’¨è¯¢ã€é‡‘èã€äº’è”ç½‘ï¼‰åœºæ™¯ä¸­ï¼Œæ•°æ®åˆ†æéƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„æ ¸å¿ƒèƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a826e4c238644d50a8e62c3144dbd868~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=oAyyplziHav44VOQbFrQ5TQ7%2BGg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>æ•°æ®åˆ†æå¸¸è§ç—›ç‚¹</strong></h2>
<p>åœ¨æ•°æ®åˆ†æå·¥å…·å‘å±•çš„æ—©æœŸé˜¶æ®µï¼Œ<strong>Excel</strong> æ˜¯ç»å¤§å¤šæ•°ä»ä¸šè€…çš„é¦–é€‰å·¥å…·ã€‚å®ƒ<strong>æ“ä½œé—¨æ§›ä½ã€åŠŸèƒ½å…¨é¢</strong>ï¼Œæ—¢èƒ½å®Œæˆ<strong>æ•°æ®çš„å½•å…¥ã€æ¸…æ´—å’Œè®¡ç®—</strong>ï¼Œä¹Ÿèƒ½é€šè¿‡<strong>æ•°æ®é€è§†è¡¨å¿«é€Ÿæ±‡æ€»åˆ†ææ•°æ®</strong> <strong>ï¼Œè¿˜æ”¯æŒæŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€é¥¼å›¾ç­‰å¤šç§å›¾è¡¨åˆ¶ä½œ</strong>ï¼Œå°†å¤æ‚çš„æ•°æ®ç»“æœå¯è§†åŒ–å‘ˆç°ï¼Œæ»¡è¶³äº†æ—¥å¸¸å·¥ä½œä¸­åŸºç¡€çš„æ•°æ®åˆ†æéœ€æ±‚ã€‚</p>
<p>å¯¹äºç®€å•çš„æ•°æ®æ±‡æ€»ï¼ˆæ•°æ®é‡çº§ &lt; 1 ä¸‡è¡Œï¼‰ï¼ŒExcel é€šå¸¸è¾ƒä¸ºæµç•…ï¼Œæ“ä½œå“åº”ç§’çº§ï¼Œä½†æ˜¯å½“æ•°æ®é‡çº§è¶…è¿‡ 1 ä¸‡è¡Œç”šè‡³ 10 ä¸‡è¡Œæ—¶ï¼ŒExcel å¼€å§‹å˜æ…¢ï¼Œ<strong>ç­›é€‰ã€æ’åºã€æ•°æ®é€è§†è¡¨ç­‰æ“ä½œè€—æ—¶å»¶é•¿ï¼ˆç§’åˆ°åˆ†é’Ÿçº§ï¼‰</strong> ã€‚å½“è¡¨æ ¼é‡Œæœ‰å¤§é‡<em><strong>VLOOKUP</strong></em>ã€<em><strong>SUMIFS</strong></em>ã€æ•°ç»„å…¬å¼ï¼Œæˆ–æ˜¯è·¨è¡¨å¼•ç”¨ã€åµŒå¥—å‡½æ•°æ—¶ï¼Œç”šè‡³<strong>å‡ºç°æ–‡ä»¶å´©æºƒ</strong>çš„æƒ…å†µï¼Œé€šå¸¸éœ€è¦å…³é—­è‡ªåŠ¨è®¡ç®—ï¼ˆæ”¹ä¸ºæ‰‹åŠ¨è®¡ç®—ï¼‰ï¼Œå¹¶ä¸”é¢‘ç¹ä¿å­˜ï¼Œå¦åˆ™æ–‡ä»¶å´©æºƒä¼šå¯¼è‡´å‡ ä¸ªå°æ—¶çš„å·¥ä½œé‡ç™½è´¹ã€‚</p>
<p>æ•°æ®åˆ†ææœ¬æ˜¯ä¸€é¡¹å¯¹æŠ€æœ¯èƒ½åŠ›æœ‰è¾ƒé«˜è¦æ±‚çš„ä¸“ä¸šå·¥ä½œï¼Œä½†åœ¨ AI ç¼–ç¨‹æŠ€æœ¯çš„èµ‹èƒ½ä¸‹ï¼ŒéæŠ€æœ¯èƒŒæ™¯çš„ä»ä¸šè€…ä¹Ÿèƒ½å€ŸåŠ© <strong>AI IDE</strong> é«˜æ•ˆå®Œæˆä»æ•°æ®å¤„ç†ã€æ·±åº¦åˆ†æåˆ°å¯è§†åŒ–å‘ˆç°çš„å…¨æµç¨‹ï¼Œå½»åº•çªç ´ Excel åœ¨å¤æ‚åœºæ™¯ä¸‹çš„åº”ç”¨ç“¶é¢ˆã€‚</p>
<p>ä¾‹å¦‚ï¼Œç”¨æˆ·æ— éœ€å†è®°å¿†ç¹æ‚çš„å…¬å¼æˆ–ä»£ç è¯­æ³•ï¼Œåªéœ€ç”¨è‡ªç„¶è¯­è¨€æè¿°åˆ†æéœ€æ±‚ï¼ŒAI å°±èƒ½è‡ªåŠ¨æ‹†è§£ä»»åŠ¡ã€ç”Ÿæˆä»£ç å¹¶è¾“å‡ºç²¾å‡†ç»“æœã€‚æ— è®ºæ˜¯åŸºç¡€çš„æ•°æ®æ¸…æ´—ï¼ˆå¦‚è¯»å– CSV æ–‡ä»¶å¹¶å¤„ç†é‡å¤å€¼ï¼‰ã€ä¸šåŠ¡æŒ‡æ ‡è®¡ç®—ï¼ˆå¦‚æŒ‰åŒºåŸŸæ±‡æ€»é”€å”®é¢ï¼‰ï¼Œè¿˜æ˜¯æ›´å¤æ‚çš„å¯è§†åŒ–å‘ˆç°ï¼ˆå¦‚ç”¨æŠ˜çº¿å›¾å±•ç¤ºæœˆåº¦è¶‹åŠ¿ï¼‰ä¸è¿›é˜¶çš„é¢„æµ‹åˆ†æï¼ˆå¦‚é€šè¿‡æ—¶é—´åºåˆ—ç®—æ³•é¢„æµ‹æœªæ¥é”€é‡ï¼‰ï¼Œéƒ½èƒ½é€šè¿‡ç®€å•çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤å¿«é€Ÿå®ç°â€”â€”è€Œåœ¨è¿‡å»ï¼Œè¿™äº›èƒ½åŠ›å¯¹éæŠ€æœ¯äººå‘˜è€Œè¨€å‡ ä¹æ˜¯éš¾ä»¥ä¼åŠçš„ã€‚</p>
<blockquote>
<p>ä¸€è¨€ä»¥è”½ä¹‹ï¼ŒAI è®©æ•°æ®åˆ†æå‘Šåˆ« â€œä¸“ä¸šå£å’â€ï¼Œæˆä¸ºæ‰€æœ‰éä¸“ä¸šäººå‘˜éƒ½èƒ½é›¶é—¨æ§›ä¸Šæ‰‹çš„å®ç”¨å·¥å…·ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0bb89117ab74efbbd5e3ca1cd7bca46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=kUb1zA0MmbnXfNtq9xGii3iU81s%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>ä¸ºä»€ä¹ˆç”¨ TRAE åšæ•°æ®åˆ†æ</strong></h2>
<p>æˆ‘ä»¬æŠŠ Excelã€ChatGPTã€TRAE IDE åŸºäºæ•°æ®åˆ†æçš„åœºæ™¯è¿›è¡Œäº†å¤šç»´åº¦å¯¹æ¯”ï¼Œå¯ä»¥å‘ç° IDEÂ <strong>åœ¨æ•ˆç‡ã€é€‚é…æ€§ä¸æ™ºèƒ½åŒ–ä¸Šå…¨é¢è¶…è¶Š Excel ä¸ Chatbotï¼ˆä¾‹å¦‚ ChatGPTï¼‰ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97d87ed302aa446daaa4c2e7f7898def~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=tBPHeJ2LSFjdETLEuuuvwC3Cj9M%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3"><strong>å’Œ Excel ç›¸æ¯”</strong></h3>
<ul>
<li>
<p><strong>æ€§èƒ½æ— ä¸Šé™ï¼š</strong> è½»æ¾é©¾é©­ 10 ä¸‡è¡Œç”šè‡³ç™¾ä¸‡è¡Œæ•°æ®ï¼Œå½»åº•å‘Šåˆ« Excel å¤„ç†å¤§æ•°æ®æ—¶çš„å¡é¡¿ã€å‡æ­»ä¸å´©æºƒé£é™©ã€‚</p>
</li>
<li>
<p><strong>é›¶ä»£ç åˆ†æèŒƒå¼ï¼š</strong> å‘Šåˆ«å¤æ‚çš„ <em><strong>VLOOKUP</strong></em>ã€<em><strong>SUMIFS</strong></em> åµŒå¥—æˆ– VBA è„šæœ¬ã€‚é€šè¿‡è‡ªç„¶è¯­è¨€æŒ‡ä»¤å³å¯é©±åŠ¨åˆ†æï¼Œè®©éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½å®Œæˆé«˜é˜¶ç»Ÿè®¡ã€‚</p>
</li>
<li>
<p><strong>ç«¯åˆ°ç«¯æµç¨‹è‡ªåŠ¨åŒ–ï¼š</strong> å®ç°ä»<strong>åŸå§‹æ¸…æ´—ã€å¤šç»´åˆ†æåˆ°å¯è§†åŒ–å‘ˆç°</strong>çš„ä¸€é”®å¼ä¸²è”ï¼Œå°†åŸæœ¬ç¢ç‰‡åŒ–çš„æ“ä½œè½¬åŒ–ä¸ºè‡ªåŠ¨åŒ–çš„æ•°æ®æµæ°´çº¿ã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘æ²‰æ·€ï¼š</strong> åˆ†æè¿‡ç¨‹ä¸å†æ˜¯ä¸å¯é€†çš„æ‰‹åŠ¨ç‚¹å‡»ï¼Œè€Œæ˜¯è‡ªåŠ¨ç”Ÿæˆ<strong>å¯å¤ç”¨çš„åˆ†æè„šæœ¬</strong>ã€‚ä»Šå¹´çš„åˆ†ææ¨¡å‹ï¼Œæ˜å¹´æ–°æ•°æ®åªéœ€ä¸€é”®è¿è¡Œå³å¯å¤ç”¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4"><strong>å’Œ ChatBot ç±»å‹çš„äº§å“ç›¸æ¯”</strong></h3>
<ul>
<li>
<p><strong>æ“ä½œä¾¿æ·çµæ´»ï¼š</strong> åŸç”Ÿæ”¯æŒè¶…å¤§æ–‡ä»¶åŠå¤šä¸ªåˆ†æ•£æ–‡ä»¶çš„å…³è”å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨åˆ‡åˆ†æˆ–åå¤ä¸Šä¼ ï¼Œç›´æ¥åœ¨æœ¬åœ°å·¥ä½œåŒºèµ·æ­¥ã€‚</p>
</li>
<li>
<p><strong>é¡¹ç›®ç†è§£æ»¡åˆ†ï¼š</strong> å…·å¤‡é¡¹ç›®çº§ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›ï¼Œæ·±åº¦å…³è”å†å²åˆ†æé€»è¾‘ä¸ä¸šåŠ¡æ ‡ç­¾ï¼Œé¿å…äº† Chatbot å¸¸è§çš„é‡å¤æ²Ÿé€šä¸ä¸Šä¸‹æ–‡æ–­è£‚ã€‚</p>
</li>
<li>
<p><strong>ä¸­é—´é€»è¾‘å¯è¿½æº¯ã€å¯è¿½é—®ï¼š</strong> æ‹’ç»â€œç»“æœé»‘ç›’â€ï¼Œä½ å¯ä»¥é’ˆå¯¹åˆ†æè¿‡ç¨‹ä¸­çš„<strong>ä»»ä½•ä¸­é—´æ­¥éª¤è¿›è¡Œè¿½é—®å’Œæ ¡éªŒ</strong>ï¼ˆå¦‚ï¼šâ€œä¸ºä»€ä¹ˆè¿™ä¹ˆè¿‡æ»¤ï¼Ÿâ€ï¼‰ï¼Œç¡®ä¿é€»è¾‘ç™¾åˆ†ä¹‹ç™¾å‡†ç¡®ã€‚</p>
</li>
<li>
<p><strong>åˆ†æäº§å‡ºæŒä¹…åŒ–ï¼š</strong> æ”¯æŒå°†å›¾è¡¨ä¸åˆ†æç»“æœç›´æ¥è½¬åŒ–ä¸º<strong>å¤šæ ¼å¼æŒä¹…åŒ–æ–‡ä»¶</strong>ã€‚è¿™ç§â€œäº§å‡ºå³èµ„äº§â€çš„èƒ½åŠ›ï¼Œä¸ºæ·±åº¦åˆ†æä¸è·¨å·¥å…·åä½œæä¾›äº†åšå®çš„å·¥ç¨‹åŸºç¡€ã€‚</p>
</li>
<li>
<p><strong>å¤šå·¥å…·ååŒæ‰§è¡Œï¼š</strong> å‡­å€Ÿæ™ºèƒ½æ¨ç†ä¸å¤šå·¥å…·ååŒï¼Œä¸ä»…ç²¾å‡†è¯†åˆ«éœ€æ±‚ï¼Œæ›´èƒ½è‡ªåŠ¨é…ç½®ç¯å¢ƒå¹¶æ‰§è¡Œä»£ç ï¼Œå®ç°çœŸæ­£é—­ç¯çš„ AI åˆ†æä½“éªŒã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64c9db9b23be41e6b11e55dab085fe57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=6uFJV3CtxX79FJF1wW7ZIfwDxZk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5"><strong>å®æ“</strong></h2>
<p>Stack Overflow å¼€å‘è€…è°ƒç ”æ˜¯ä¸€ä»½é¢å‘å…¨çƒå¼€å‘è€…çš„é—®å·æŠ¥å‘Šï¼Œè°ƒç ”å½“å‰å¼€å‘é¢†åŸŸçš„æŠ€æœ¯è¶‹åŠ¿ä¸æ ¸å¿ƒç—›ç‚¹ç­‰ã€‚ä»–ä»¬æ¯å¹´ä¼šå°†æºæ•°æ®å‘å¸ƒåœ¨å…¶å®˜ç½‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fsurvey.stackoverflow.co%2F" target="_blank" title="https://survey.stackoverflow.co/" ref="nofollow noopener noreferrer">survey.stackoverflow.co/</a></p>
<p>æœ¬æ•™ç¨‹ä»¥ Stack Overflow 2025 å¹´å¼€å‘è€…è°ƒç ”æ•°æ®ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ç”¨ TRAE å®Œæˆå…¨æµç¨‹æ•°æ®åˆ†æã€‚</p>
<h3 data-id="heading-6"><strong>å·¥å…·å®‰è£…ä¸æ•°æ®å‡†å¤‡</strong></h3>
<ol>
<li>
<p><strong>ä¸‹è½½å®‰è£… TRAE ï¼š</strong> è®¿é—® TRAE å®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.trae.com.cn%25EF%25BC%2589%25EF%25BC%258C%25E4%25B8%258B%25E8%25BD%25BD%25E5%25AE%2589%25E8%25A3%2585%25E5%258C%2585%25EF%25BC%258C%25E6%258C%2589%25E5%25BC%2595%25E5%25AF%25BC%25E5%25AE%258C%25E6%2588%2590%25E5%25AE%2589%25E8%25A3%2585%25EF%25BC%258C%25E7%2594%25A8%25E6%2589%258B%25E6%259C%25BA%25E5%258F%25B7%25E8%25B4%25A6%25E5%258F%25B7%25E7%2599%25BB%25E5%25BD%2595%25E5%258D%25B3%25E5%258F%25AF%25E3%2580%2582" target="_blank" title="http://www.trae.com.cn%EF%BC%89%EF%BC%8C%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%8C%85%EF%BC%8C%E6%8C%89%E5%BC%95%E5%AF%BC%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85%EF%BC%8C%E7%94%A8%E6%89%8B%E6%9C%BA%E5%8F%B7%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95%E5%8D%B3%E5%8F%AF%E3%80%82" ref="nofollow noopener noreferrer">www.trae.com.cnï¼‰ï¼Œä¸‹è½½å®‰è£…åŒ…ï¼ŒæŒ‰å¼•å¯¼å®Œæˆå®‰è£…ï¼Œç”¨æ‰‹æœºå·è´¦å·ç™»å½•å³å¯ã€‚</a></p>
</li>
<li>
<p><strong>æ‰“å¼€ TRAE SOLO æ¨¡å¼ï¼š</strong> TRAE ç›®å‰æä¾› SOLO å’Œ IDE ä¸¤ç§æ¨¡å¼ï¼Œæœ¬æ¬¡æˆ‘å°†é€‰æ‹© TRAE SOLO æ¨¡å¼æ¥å®Œæˆéœ€æ±‚ã€‚</p>
</li>
</ol>
<h4 data-id="heading-7"><strong>SOLO å’Œ IDE æ¨¡å¼çš„åŒºåˆ«ï¼š</strong></h4>
<ul>
<li>
<p>SOLOï¼šAI ä¸»å¯¼å…¨æµç¨‹ï¼Œè‡ªåŠ¨æ‹†è§£ä»»åŠ¡ã€è°ƒåº¦å·¥å…·ï¼Œå¼€å‘è€…ä»…éœ€æéœ€æ±‚ã€å®¡æ ¸æˆæœ</p>
</li>
<li>
<p>IDEï¼šå¼€å‘è€…ä¸»å¯¼ï¼ŒAI æä¾›ä»£ç è¡¥å…¨ã€æ™ºèƒ½é—®ç­”ç­‰è¾…åŠ©ï¼Œä¿ç•™ä¼ ç»Ÿå¼€å‘æµç¨‹ï¼ŒæŒæ§æ„Ÿæ›´å¼º</p>
</li>
</ul>
<p>SOLO æœ‰ 2 ä¸ªé€‰é¡¹ï¼Œåˆ†åˆ«ä¸º SOLO Builder å’Œ SOLO Coderï¼Œæˆ‘ä»¬æœ¬æ¬¡é€‰æ‹© SOLO Coderï¼Œå…¶ä¸­çš„ Plan æ¨¡å¼ä¹Ÿä¸ºåˆ†ææ–¹æ¡ˆçš„è®¨è®ºæä¾›äº†å¾ˆå¤§ä¾¿åˆ©ã€‚</p>
<h4 data-id="heading-8"><strong>SOLO Builder å’Œ SOLO Coder çš„åŒºåˆ«ï¼š</strong></h4>
<ul>
<li>
<p>SOLO Coder: é€‚åˆå·²æœ‰å¤æ‚é¡¹ç›®çš„è¿­ä»£ã€é‡æ„ã€Bug ä¿®å¤ï¼Œå¯è‡ªä¸»è§„åˆ’ã€æ‰§è¡Œå¤šæ­¥ä»»åŠ¡</p>
</li>
<li>
<p>SOLO Builder: é€‚åˆä» 0 åˆ° 1 å®Œæ•´é¡¹ç›®çš„å¿«é€ŸåŸå‹éªŒè¯ï¼Œä»éœ€æ±‚åˆ†æåˆ°éƒ¨ç½²å…¨æµç¨‹è‡ªåŠ¨åŒ–</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24dfd87d59064ff6a7fd0ca6d406b997~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=6P7Z3e7GYhJQR9fT%2BzBTNeu6%2Ba0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9"><strong>å•æ–‡ä»¶æ•°æ®åˆ†æåœºæ™¯</strong></h3>
<h4 data-id="heading-10"><strong>æ•°æ®å‡†å¤‡</strong></h4>
<p>ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fsurvey.stackoverflow.co%2F" target="_blank" title="https://survey.stackoverflow.co/" ref="nofollow noopener noreferrer">survey.stackoverflow.co/</a> <strong>ä¸‹è½½ Stack Overflow 2025 è°ƒç ”æ•°æ®é›†</strong>ï¼ŒåŒ…å«ã€Œå—è®¿è€…åŸºæœ¬ä¿¡æ¯ã€æŠ€æœ¯ä½¿ç”¨ä¹ æƒ¯ã€AI å·¥å…·æ€åº¦ã€ç­‰ç»´åº¦ï¼Œå°†æ•°æ®é›†ä¿å­˜è‡³æœ¬åœ°æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚ â€œStackOverflow2025â€ ï¼‰ï¼Œæ–¹ä¾¿åç»­ TRAE è¿›è¡Œè¯»å–ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦å•ç‹¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå°†ä¸‹è½½ä¸‹æ¥çš„æ•°æ®é›†ä¿å­˜åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹å†…ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰“å¼€excelæ–‡ä»¶ã€‚</p>
<p>é€‰æ‹©ã€Œæ‰“å¼€é¡¹ç›®ã€ï¼Œæ‰¾åˆ°å¯¹åº”æ–‡ä»¶å¤¹æ‰“å¼€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95fe1e4f569e45ef994488a7e4f172bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=5BPj3KwWA8YYeygUXvMTB5z2irI%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a0fd50bbb434aa68eeddad286e133ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=01JqVfcvqb15t5GP1VrkOrPn2WM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-11"><strong>å¼€å§‹æ•°æ®åˆ†æ</strong></h4>
<p><strong>1.</strong> ç›´æ¥åœ¨å¯¹è¯æ¡†é‡Œè¾“å…¥æŒ‡ä»¤ï¼Œ<strong>æŒ‡ä»¤å¯ä»¥ç®€å•ï¼ˆä¾‹å¦‚â€œå¸®æˆ‘åˆ†æä¸€ä¸‹è¿™ä¸ªæ•°æ®é›†â€ï¼‰</strong> ï¼Œä¹Ÿå¯ä»¥æ›´ç»†èŠ‚å…·ä½“ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–¹ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸ºäº†è®© AI æ¸…æ™°è‡ªå·±çš„è§’è‰²å®šä½ã€‚</p>
<p>ã€Œæˆ‘æ˜¯æ•°æ®åˆ†æå¸ˆï¼Œéœ€è¦åˆ†æStack Overflow 2025å¼€å‘è€…è°ƒç ”æ•°æ®ã€‚Â </p>
<p>è¯·è¯»å–æœ¬åœ°æ–‡ä»¶å¤¹â€œStackOverflow2025â€ä¸­çš„CSVæ–‡ä»¶ï¼ŒæŸ¥çœ‹æ•°æ®çš„å‰10è¡Œã€å­—æ®µåˆ—è¡¨ã€æ•°æ®å½¢çŠ¶ï¼ˆè¡Œæ•°/åˆ—æ•°ï¼‰ï¼Œç»Ÿè®¡å„å­—æ®µçš„ç¼ºå¤±å€¼æ•°é‡ï¼Œç”ŸæˆåŸºç¡€ä¿¡æ¯æŠ¥å‘Šã€‚Â </p>
<p>æ³¨æ„å¤„ç†ä¸­æ–‡ç¼–ç é—®é¢˜ï¼Œé¿å…ä¹±ç ã€‚ã€</p>
<p><strong>2.</strong> ä»å®˜ç½‘ä¸‹è½½çš„æ•°æ®æ˜¯ zip æ–‡ä»¶ï¼Œ<strong>æ— éœ€äººå·¥æ‰‹åŠ¨è§£å‹ï¼Œ</strong> AI è‡ªå·±ä¼šè§£å‹å¹¶ä½¿ç”¨ Python æ¥è¯»å–å’Œåˆ†ææ•°æ®ï¼›å¤§æ¦‚ç»è¿‡ 2 åˆ†é’Ÿï¼ŒAI ä¼šæ˜¾ç¤ºåˆæ­¥åˆ†æç»“æœï¼Œä¾‹å¦‚ <strong>æ•°æ®åŸºæœ¬æƒ…å†µã€å¼€å‘è€…ç”»åƒã€AI å·¥å…·ä½¿ç”¨æƒ…å†µã€è–ªèµ„æƒ…å†µä»¥åŠæŠ€æœ¯ä½¿ç”¨æƒ…å†µ</strong>ç­‰å¤šä¸ªæ–¹é¢</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0f5327e42284714860c827a90d49500~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=yRIDdu2kLiN1HFAgHsTS8HAL%2BXk%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>ä»åˆæ­¥çš„åˆ†æè¿”å›ç»“æœæ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€äº›<strong>æœ‰è¶£çš„ä¸‹é’»åˆ†æçš„ç»´åº¦</strong>ï¼Œä¾‹å¦‚ï¼š</li>
</ol>
<p>Â  a. å¹´é¾„åˆ†å¸ƒå’Œè–ªèµ„æƒ…å†µæ˜¯å¦æœ‰å…³ç³»</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b33a5902e8b54fa7b9f252217b59415c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=iKxRLAasAF45lJU4BuGsadJLx10%3D" alt="" loading="lazy"/></p>
<p>Â  b. æœ€å¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€å’Œè–ªèµ„æƒ…å†µæ˜¯å¦æœ‰å…³ç³»</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f29edad37744030b09ccd8a95f44087~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=yxOnbMKxNhN5uVfOiWMYKYaKhQE%3D" alt="" loading="lazy"/></p>
<p>Â  c. å·¥ä½œæ»¡æ„åº¦å’Œè–ªèµ„æƒ…å†µæ˜¯å¦æœ‰å…³ç³»</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3d5b15528e443be925fd95a61dcfe15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=nM2jgBWFs4M%2FsLUUvVTeyw%2BRxbc%3D" alt="" loading="lazy"/></p>
<p><strong>4.</strong> åŸå§‹æ•°æ®é‡Œæœ‰ä¸ªå­—æ®µæ˜¯â€œå›½å®¶â€ï¼Œå› ä¸ºå­—æ®µè¾ƒå¤šï¼Œæ‰€ä»¥ AI åœ¨æœ€å¼€å§‹çš„æè¿°æ€§ç»Ÿè®¡æ—¶æ²¡æœ‰æåˆ°ï¼Œä½†å¦‚æœæœŸæœ›è¡¥å……æ›´å¤šä¸‹é’»åˆ†æçš„ç»´åº¦ï¼Œå¯ä»¥ç›´æ¥é—® AI</p>
<p>ã€Œåˆ†æä¸€ä¸‹ä¸åŒå›½å®¶çš„è–ªèµ„åˆ†å¸ƒï¼ˆçœ‹ä¸€ä¸‹å‰10å›½å®¶ï¼ŒæŒ‰è°ƒç ”ç”¨æˆ·æ•°é‡æ’åºï¼Œè–ªèµ„ä¸­ä½æ•°ï¼Œå‡å€¼å’Œ25/75åˆ†ä½æ•°ï¼Œå…¨éƒ¨æ¢ç®—ä¸ºç¾é‡‘ï¼‰ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bf573ad448d4ab4b6d19f80d602c298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=btRUaac%2FZW5A8QytdJsTvAj%2FmhE%3D" alt="" loading="lazy"/></p>
<p><strong>5.</strong> å¯ä»¥äº¤å‰â€œå›½å®¶â€å’Œâ€œå¼€å‘è€…èº«ä»½â€ï¼Œåˆ†æè–ªèµ„åˆ†å¸ƒæƒ…å†µ</p>
<p>ã€Œåˆ†æä¸€ä¸‹ä¸åŒå›½å®¶ã€ä¸åŒå¼€å‘è€…èº«ä»½çš„è–ªèµ„åˆ†å¸ƒï¼ˆçœ‹ä¸€ä¸‹å‰10å›½å®¶ï¼Œå‰ä¸€ä¸‹å‰10å¼€å‘è€…èº«ä»½ï¼ŒæŒ‰è°ƒç ”ç”¨æˆ·æ•°é‡æ’åºï¼Œè–ªèµ„ä¸­ä½æ•°ï¼Œå‡å€¼å’Œ25/75åˆ†ä½æ•°ï¼Œå…¨éƒ¨æ¢ç®—ä¸ºç¾é‡‘ï¼‰ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89b68c6fc42e4f36a14f92694e3514d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=xvXXVo3loZECV7al5ey5p6k5kmM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12"><strong>ç”Ÿæˆæ•°æ®åˆ†æå›¾è¡¨</strong></h4>
<blockquote>
<p>æ•°æ®åˆ†æå¸¸å¸¸éœ€è¦ç»“åˆå›¾è¡¨ï¼Œå¯ä»¥æ›´åŠ ç›´è§‚å±•ç¤ºæ•°æ®æƒ…å†µã€‚</p>
</blockquote>
<p>ç›´æ¥åœ¨å¯¹è¯æ¡†é‡Œè¾“å…¥æŒ‡ä»¤ï¼Œ<strong>æŒ‡ä»¤å¯ä»¥ç®€å•ï¼ˆä¾‹å¦‚â€œå¸®æˆ‘ç”»ä¸€ä¸ª XX å›¾â€ï¼‰</strong> ï¼Œä¹Ÿå¯ä»¥æ›´ç»†èŠ‚å…·ä½“ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–¹ã€‚</p>
<p>ã€Œå¸®æˆ‘ç”»ä¸€ä¸ªçƒ­åŠ›è¡¨ï¼Œæ¨ªè½´æ˜¯å›½å®¶ï¼ˆæŒ‰ä¸­æ–‡åç§°ï¼‰ï¼Œæ•°è½´æ˜¯å¼€å‘è€…ç±»å‹ï¼ˆç®€å†™ï¼‰ï¼Œæ•°å€¼æ˜¯è–ªèµ„å¹³å‡å€¼ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c3591dab4604119b89ba246834d7f6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=AqhOzHcwIK9A9Q3Vc9XX5Eta898%3D" alt="" loading="lazy"/></p>
<p>ã€Œå¸®æˆ‘ç”»ä¸€ä¸ªå›¾ï¼Œå±•ç¤ºæ¯ä¸ªå›½å®¶çš„25/75/ä¸­ä½æ•° è–ªèµ„ï¼Œåªéœ€è¦å±•ç¤ºå‰10å›½å®¶å³å¯ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0de4f0c2a28e4397aa57edd838845dbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=ZigVH5MVgWmS2cUhVe%2FMHbHQqjI%3D" alt="" loading="lazy"/></p>
<p>ã€Œå¸®æˆ‘ç”»ä¸€ä¸ªæ°”æ³¡å›¾ï¼Œæ¨ªè½´æ˜¯è–ªèµ„å‡å€¼ï¼ˆå•ä½æ˜¯ç¾é‡‘ï¼‰ï¼Œæ•°è½´æ˜¯æ¯æ—¥ä½¿ç”¨è¿‡AIçš„å æ¯”ï¼Œå¤§å°æ˜¯å¼€å‘è€…è°ƒç ”ç”¨æˆ·æ•°é‡ï¼Œå±•ç¤ºå‰10å›½å®¶ï¼Œæ°”æ³¡å¤§å°é€‚ä¸­ï¼Œæ³¨æ„ç¾è§‚ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fa4ce3e77184d5ab2057b0cfcfaf296~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=x2KaWXCGG05ooc6RtP8wfyBY5wQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13"><strong>æ•°æ®åˆ†æç»“æœå¯¼å‡º</strong></h4>
<p>é™¤äº†æ•°æ®åˆ†æå’Œç”»å›¾å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†åˆ†æç»“æœå‚¨å­˜ä¸º <strong>CSV ã€Excel ç­‰æ ¼å¼æ–¹ä¾¿åç»­é˜…è¯»å’Œå¤„ç†æ•°æ®ï¼Œæˆ–è€…è®©å…¶å°†å®Œæ•´æŠ¥å‘Šå­˜å‚¨ä¸º MDã€PDFã€ PPT ç­‰æ ¼å¼æ–¹ä¾¿é˜…è¯»æ–‡æ–‡å­—å†…å®¹</strong>ã€‚ä»¥ csv ä¸ºä¾‹ï¼Œ</p>
<p>ã€Œå¸®æˆ‘æŠŠæ¯ä¸ªå›½å®¶çš„è°ƒç ”äººæ•°ï¼Œè–ªèµ„ä¸­ä½æ•°ï¼Œ25/75åˆ†ä½æ•°å’Œå‡å€¼å¯¼å‡ºä¸ºcsv+ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5a61e53ad914a00801e56e2a729bfe9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=0i1V4FtyEKQPl2nRDRnKAIZyAtk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-14"><strong>æ€»ç»“</strong></h4>
<p>ä»¥ä¸Šåˆ†æåªæ˜¯è¿™ä¸ªæ•°æ®é›†çš„ä¸€éƒ¨åˆ†ï¼Œè¿˜æœ‰å…¶ä»–åˆ†æç»´åº¦ä¾‹å¦‚ AI å·¥å…·ä½¿ç”¨ç‡åˆ†æã€ç¼–ç¨‹è¯­è¨€åå¥½åˆ†æã€å·¥å…·åå¥½ä¸ AI ä½¿ç”¨å…³è”æ€§ç­‰ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œä¿®æ”¹æç¤ºè¯æ¢ç´¢ã€‚</p>
<h3 data-id="heading-15"><strong>è·¨æ–‡ä»¶åˆ†æåœºæ™¯</strong></h3>
<p>æœ‰æ—¶å€™æ•°æ®åˆ†æ•£åœ¨ä¸åŒçš„æ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬éœ€è¦å°†ä¸åŒæ–‡ä»¶ä¹‹é—´çš„æ•°æ®å¯¹æ¯”ç»“åˆèµ·æ¥åˆ†æï¼Œå› æ­¤ä¼šæœ‰è·¨æ–‡ä»¶åˆ†æçš„åœºæ™¯ã€‚</p>
<h4 data-id="heading-16"><strong>æ•°æ®å‡†å¤‡</strong></h4>
<p>ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2Fretailrocket%2Fecommerce-dataset%2Fdata" target="_blank" title="https://www.kaggle.com/datasets/retailrocket/ecommerce-dataset/data" ref="nofollow noopener noreferrer">www.kaggle.com/datasets/reâ€¦</a>Â  <strong>ä¸‹è½½ Retailrocket recommender system dataset æ•°æ®é›†</strong>ï¼›è¯¥æ•°æ®é›†åŒ…å«å››ä¸ªæ–‡ä»¶ï¼šä¸€ä¸ªå­˜å‚¨ç”¨æˆ·è¡Œä¸ºæ•°æ®çš„æ–‡ä»¶ï¼ˆevents.csvï¼‰ã€ä¸¤ä¸ªå­˜å‚¨å•†å“å±æ€§æ•°æ®çš„æ–‡ä»¶ï¼ˆitem_properties_part1.csv å’Œ item_properties_part2.csvï¼‰ï¼Œä»¥åŠä¸€ä¸ªæè¿°ç±»ç›®å±‚çº§ç»“æ„çš„æ–‡ä»¶ï¼ˆcategory_tree.csvï¼‰ï¼›<strong>æ— éœ€æ‰‹åŠ¨è§£å‹</strong>ï¼Œå¯ä»¥ç›´æ¥æŠŠæ•°æ®é›†ä¿å­˜è‡³æœ¬åœ°æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚ â€œç”µå•†æ¨èâ€ ï¼‰ï¼Œæ–¹ä¾¿åç»­ TRAE è¿›è¡Œè¯»å–ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c613c756eca4ac2823a4b4c0b8e14d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=CjJuP6qolYcuJrCay3vBMJsEzyE%3D" alt="" loading="lazy"/></p>
<p>é€‰æ‹©ã€Œæ‰“å¼€é¡¹ç›®ã€ï¼Œæ‰¾åˆ°å¯¹åº”æ–‡ä»¶å¤¹æ‰“å¼€ã€‚</p>
<h4 data-id="heading-17"><strong>å¼€å§‹æ•°æ®åˆ†æ</strong></h4>
<p><strong>1.</strong> ç›´æ¥åœ¨å¯¹è¯æ¡†é‡Œè¾“å…¥æŒ‡ä»¤ï¼Œ<strong>æŒ‡ä»¤å¯ä»¥ç®€å•ï¼ˆä¾‹å¦‚â€œå¸®æˆ‘åˆ†æå’Œæ€»ç»“ä¸€ä¸‹è¿™ä¸ªæ•°æ®é›†â€ï¼‰</strong> ï¼›å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–‡ä»¶é‡Œï¼Œategory_tree.csv æ˜¯å•†å“ç±»åˆ«æ ‘ç»“æ„ï¼ˆ1670 è¡Œï¼‰ï¼›events.csv æ˜¯æˆ·è¡Œä¸ºäº‹ä»¶ï¼ˆ276 ä¸‡è¡Œï¼‰ï¼Œä¸»è¦æ˜¯ä¸‰ç±»äº‹æƒ…ï¼šæµè§ˆã€åŠ å…¥è´­ç‰©è½¦å’Œäº¤æ˜“ï¼›item_properties æ˜¯å•†å“å±æ€§ï¼ˆ2000 ä¸‡è¡Œï¼‰ï¼ŒåŒ…å«å¤šç§å±æ€§ç±»å‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d98e200c3ab4144b816108b68405494~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=%2BisHqRg5qO%2F8N22CtFBMKmbKQ7c%3D" alt="" loading="lazy"/></p>
<p><strong>2.</strong> æˆ‘ä»¬å¯ä»¥å…ˆé’ˆå¯¹å•ä¸ªæ–‡ä»¶å¤¹åšä¸€äº›ä¸‹é’»åˆ†æï¼Œä¾‹å¦‚ï¼š</p>
<p>a. ä¸‹é’»åˆ†æå•†å“ç±»åˆ«æ ‘åˆ†å¸ƒï¼Œå¯ä»¥çœ‹åˆ°é¡¶çº§ç±»åˆ«æ•°é‡ä¸º 25 ä¸ªï¼Œæœ€æ·±å±‚çº§ä¸º 6 å±‚ï¼Œå±‚çº§ 3 å’Œå±‚çº§ 4 æ˜¯æœ€ä¸»è¦çš„å±‚çº§ï¼Œå…±å  81.90%ï¼Œå¹³å‡æ¯ä¸ªçˆ¶ç±»åˆ«æœ‰ 4.54 ä¸ªå­ç±»åˆ«ï¼Œä¸­ä½æ•°ä¸º 4ï¼Œè¡¨æ˜ç±»åˆ«ç»“æ„æ¯”è¾ƒå‡è¡¡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bee50b986e6426c9b0fd87cef285458~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=eBs2%2F84dtiYO1A9MVBgC1e52ypE%3D" alt="" loading="lazy"/></p>
<p>b. ä¸‹é’»åˆ†æç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°å…±è®¡ 141 ä¸‡ä¸ªç”¨æˆ·å’Œ 276 ä¸‡æ¡è®°å½•ï¼Œå¹³å‡ä¸€ä¸ªç”¨æˆ·æœ‰ 1.96 æ¡è®°å½•ï¼›71%çš„ç”¨æˆ·ä»… 1 æ¡è®°å½•ï¼Œ27%çš„ç”¨æˆ·æœ‰ 2-10 æ¡è®°å½•ï¼Œ1.4%ç”¨æˆ·æœ‰è¶…è¿‡ 10 æ¡è®°å½•ï¼›ä»äº‹ä»¶ç±»å‹çœ‹ï¼Œæµè§ˆå æ¯” 96.67%ï¼ŒåŠ å…¥è´­ç‰©è½¦ä¸º 2.52%ï¼Œè´­ä¹°ä¸º 0.81%ï¼›æµè§ˆä»åŠ å…¥è´­ç‰©è½¦è½¬åŒ–æ¯”ä¾‹ä¸º 2.60%ï¼ŒåŠ å…¥è´­ç‰©è½¦åˆ°äº¤æ˜“ä¸º 32%</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ce6989af935499aabc42328bfdeefc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=kMa7q2te4bSJT943Flpr5SQmSLA%3D" alt="" loading="lazy"/></p>
<p>c. ä¸‹é’»åˆ†æå•†å“å±æ€§æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°å…±è®¡ 2000 ä¸‡æ¡å±æ€§è®°å½•ï¼Œæ¶‰åŠ 40 ä¸‡å•†å“ï¼Œå¹³å‡ä¸€ä¸ªå•†å“ 3 ä¸ªå±æ€§ï¼›é™¤äº†åº“å­˜ï¼ˆavailableï¼‰å’Œç±»ç›®ï¼ˆcategoryidï¼‰è¿™ä¸¤ä¸ªå±æ€§å¤–ï¼Œå…¶ä»–å±æ€§éƒ½è¢«å“ˆå¸Œï¼›æœ€å¸¸ç”¨çš„å‰ 10 ä¸ªå±æ€§ä½¿ç”¨å æ¯”åŸºæœ¬éƒ½æ˜¯ 100%</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a5fc0b9a8ab41eab3c5acf38f68b985~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=ooZ3dXlxvBQxNpBUwGEWW33ub10%3D" alt="" loading="lazy"/></p>
<p><strong>3.</strong> é™¤äº†å•ä¸ªæ–‡ä»¶ä¸‹é’»åˆ†æå¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥äº¤å‰ä¸‰ä¸ªæ–‡ä»¶è¿›è¡Œåˆ†æï¼Œä¾‹å¦‚æŒ‰é¡¶çº§ç±»åˆ«çœ‹ä¸‹ä»æµè§ˆåˆ°åŠ å…¥è´­ç‰©è½¦åˆ°äº¤æ˜“çš„è½¬åŒ–æ¯”ä¾‹ï¼šå¯ä»¥çœ‹åˆ°å¹³å‡è½¬åŒ–ç‡ä¸º 0.91%ï¼Œ3 ä¸ªç±»åˆ«ï¼ˆ140ã€1224ã€859ï¼‰è½¬åŒ–ç‡é«˜äº 1%ï¼Œ11 ä¸ªç±»åˆ«è½¬åŒ–ç‡ä½äº 0.5%ï¼Œå…¶ä»–ä»‹äº 0.5-1%ï¼›7 ä¸ªç±»ç›®çš„æµè§ˆé‡ä½äº 1000ï¼Œå…¶ä¸­ 2 ä¸ªæµè§ˆé‡ä¸º 0</p>
<p>â€‹ã€ŒæŒ‰25ä¸ªé¡¶çº§ç±»åˆ«çœ‹ä¸‹ä»æµè§ˆåˆ°åŠ å…¥è´­ç‰©è½¦åˆ°äº¤æ˜“çš„è½¬åŒ–æ¯”ä¾‹ï¼ˆæµè§ˆäº‹ä»¶ç²’åº¦ï¼Œä¸æ˜¯å•†å“æˆ–è€…ç”¨æˆ·ç²’åº¦ï¼Œå¦‚æœä¸€ä¸ªå•†å“çš„ç±»åˆ«æœ‰è¿‡å˜åŒ–ï¼Œç”¨æœ€æ–°çš„ç±»åˆ«ï¼‰ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a28c2c512d524a939ffdef5290912e38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=IrK94tLElq0bj5XAScHzvBwvso0%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-18"><strong>ç”Ÿæˆæ•°æ®åˆ†æå›¾è¡¨</strong></h4>
<p>å¯ä»¥ç›´æ¥åœ¨å¯¹è¯æ¡†é‡Œè¾“å…¥æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<p>ã€Œå¸®æˆ‘ç”»ä¸€ä¸ªå›¾ï¼ŒæŒ‰top 10é¡¶çº§ç±»åˆ«æµè§ˆåˆ°åŠ å…¥è´­ç‰©è½¦ï¼ŒåŠ å…¥è´­ç‰©è½¦åˆ°äº¤æ˜“çš„æ¯”ä¾‹ï¼Œå¹¶åœ¨å›¾è¡¨çš„ä¸Šæ–¹ï¼ŒåŠ ä¸Šæ¯ä¸ªç±»ç›®çš„æµè§ˆã€åŠ è´­ã€äº¤æ˜“æ¬¡æ•°ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/529b91b1c68a474183265223414f8e7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=WKNaLeLQjtUWxNp2Qrz%2FX9Oot2k%3D" alt="" loading="lazy"/></p>
<p>ã€Œå¸®æˆ‘ç”»ä¸€ä¸ªæ°”æ³¡å›¾ï¼Œæ¨ªè½´æµè§ˆåˆ°åŠ è´­çš„è½¬åŒ–ï¼Œç«–è½´æ˜¯åŠ è´­åˆ°è´­ä¹°çš„è½¬åŒ–ï¼Œå¤§å°æ˜¯æµè§ˆé‡çº§ï¼Œåªéœ€è¦ç”»æŒ‰æµè§ˆé‡å‰10ä¸ªé¡¶çº§ç±»åˆ«ã€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a9af24af731436c80fb260f2c3a6ff4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=XWU%2Fv%2BUYOXGwUw%2FCcwF4ZZc6Ztk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-19"><strong>æ•°æ®åˆ†æç»“æœå¯¼å‡º</strong></h4>
<p>ã€ŒæŠŠä»¥ä¸Štop 10 é¡¶çº§ç±»åˆ«çš„æ°”æ³¡å›¾å¯¼å‡ºä¸ºpptã€</p>
<p>å¯ä»¥å‘ç°ï¼ŒTRAE ä¼šä½¿ç”¨ matplotlib ç»˜åˆ¶ç›¸å…³æ°”æ³¡å›¾ï¼Œæˆªå±ç„¶åæ’å…¥ppté‡Œé¢ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨PPTåŸç”Ÿç”»å›¾èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb6d7c960edc4b2dbbfae97a44325081~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=McIKZgVOTHnvrFUk4A7yEQlflhg%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡æç¤ºè¯ã€Œè¯·å¸®æˆ‘åœ¨ <strong>PPT</strong> é‡Œé¢ç›´æ¥ç”»å›¾ï¼Œè€Œä¸æ˜¯å¤åˆ¶å›¾ç‰‡ã€ï¼ŒTRAE ä¹Ÿèƒ½è°ƒç”¨ PPT ç›¸å…³èƒ½åŠ›è¿›è¡Œæ„å›¾ï¼Œä½†ç”»å‡ºæ¥çš„å›¾ç‰‡ç¾è§‚åº¦ç•¥æœ‰ä¸è¶³ï¼Œåªèƒ½è¾¾åˆ°åŸºæœ¬è¦æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88cfe1a4ecd94232816dd36b2c0cb8a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=RtCC0L%2FPUAzfyHOITQgPivc4TTM%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd85a44b7c6d4dbaa29f5bcc63a91ab7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=YnkLpAKMOuZ%2BksHWbo9kCHwmuf4%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸Šåˆ†æåªæ˜¯è¿™ä¸ªæ•°æ®é›†çš„ä¸€éƒ¨åˆ†ï¼Œè¿˜æœ‰å…¶ä»–åˆ†æç»´åº¦ä¾‹å¦‚å…¶ä»–å±æ€§å¯¹è´­ä¹°è½¬åŒ–æ¯”ä¾‹çš„å½±å“ç­‰ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œä¿®æ”¹æç¤ºè¯æ¢ç´¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55679dac25b046d48545f45e41ce5bd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVFJBRV9haQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770974409&amp;x-signature=xfkEDQvqBOVouH507g%2Fc7xbdpoY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-20"><strong>å†™åœ¨æœ€å</strong></h2>
<p>æ— è®ºæ˜¯å’¨è¯¢é¡¹ç›®ï¼ˆä¾‹å¦‚é“¶è¡Œå‹åŠ›æµ‹è¯•ã€æ¶ˆè´¹å“å¸‚åœºè¶‹åŠ¿åˆ†æç­‰ï¼‰ï¼Œè¿˜æ˜¯äº’è”ç½‘åœºæ™¯ä¸‹çš„æ•°æ®ä»»åŠ¡ï¼ˆä¾‹å¦‚åˆ†å›½å®¶ç”¨æˆ·ç•™å­˜åˆ†æã€ä»˜è´¹è½¬åŒ–æ¼æ–—æ­å»ºç­‰ï¼‰ï¼ŒåŸºæœ¬éƒ½èƒ½é€šè¿‡ AI IDE é«˜æ•ˆè½åœ°ã€‚<strong>AI IDE åœ¨æ•°æ®æŒ–æ˜ä¸æ·±åº¦åˆ†æç¯èŠ‚çš„è¡¨ç°å ªç§°å‡ºè‰²ï¼Œèƒ½ç²¾å‡†å®Œæˆæ ¸å¿ƒä»»åŠ¡</strong>ï¼›ä»…åœ¨æœ€ç»ˆæ•°æ®å¯è§†åŒ–å‘ˆç°çš„ç»†èŠ‚ä¼˜åŒ–ä¸Šï¼Œå¶å°”éœ€è¦å°‘é‡è¾…åŠ©è°ƒæ•´ï¼Œ<strong>ä½†å…¶æ•´ä½“äº¤ä»˜è´¨é‡å¤§å¤šè¶…å‡ºé¢„æœŸï¼Œå¤§å¹…æå‡äº†æ•°æ®åˆ†æçš„æ•ˆç‡ä¸ä¸“ä¸šæ€§ã€‚</strong></p>
<p>IDE ä»æ¥ä¸æ˜¯ä¸“ä¸šå¼€å‘è€…çš„ä¸“å±å·¥å…·ï¼Œå®ƒå¯ä»¥ç¦»æ¯ä¸ªäººçš„å·¥ä½œå’Œç”Ÿæ´»éƒ½æ›´è¿‘ä¸€äº›ã€‚å€ŸåŠ© AI çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸å¿…ç²¾é€šå¤æ‚çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¹Ÿèƒ½æŠŠä¸€ä¸ªä¸ªçµæ„Ÿå’Œæƒ³æ³•å˜æˆçœŸæ­£å¯è½åœ°çš„â€œæ•°å­—å°å¸®æ‰‹â€ï¼›ä¸ç®¡ä½ æ˜¯äº§å“ã€è¿è¥ã€æ•°æ®åˆ†æã€è®¾è®¡å¸ˆï¼Œè¿˜æ˜¯ä»»ä½•ä¸€ä¸€ä¸ªè§’è‰²ï¼Œéƒ½å¯ä»¥ç”¨ AI Coding å»æ­å»ºå±äºè‡ªå·±çš„æ™ºèƒ½å·¥ä½œå°ã€‚</p>
<p>æœŸå¾…å¤šæ ·åŒ–çš„ä½ å¸¦æ¥æ›´å¤šä¸ä¸€æ ·çš„ AI Coding å®ç°ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¸¯ç§‘å¤§ç†Šè¾‰ï½œAIæ—¶ä»£çš„èŒåœºæ–°åæ ‡â€”â€”ä¸ºä»€ä¹ˆä½ åº”è¯¥å»"æ•°æ®ç¨€ç–"çš„åœ°æ–¹?]]></title>    <link>https://juejin.cn/post/7603643385815646260</link>    <guid>https://juejin.cn/post/7603643385815646260</guid>    <pubDate>2026-02-07T09:28:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643385815646260" data-draft-id="7603643385815613492" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¸¯ç§‘å¤§ç†Šè¾‰ï½œAIæ—¶ä»£çš„èŒåœºæ–°åæ ‡â€”â€”ä¸ºä»€ä¹ˆä½ åº”è¯¥å»&quot;æ•°æ®ç¨€ç–&quot;çš„åœ°æ–¹?"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-07T09:28:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¸¯ç§‘å¤§ç†Šè¾‰ï½œAIæ—¶ä»£çš„èŒåœºæ–°åæ ‡â€”â€”ä¸ºä»€ä¹ˆä½ åº”è¯¥å»"æ•°æ®ç¨€ç–"çš„åœ°æ–¹?
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:28:31.000Z" title="Sat Feb 07 2026 09:28:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¯¼è¯­ï½œ</strong>åœ¨äººå·¥æ™ºèƒ½å‘å±•çš„å¥‡ç‚¹æ—¶åˆ»ï¼Œç®—åŠ›ã€æ•°æ®ä¸äººæ‰çš„åº•å±‚é€»è¾‘æ­£åœ¨å‘ç”Ÿæ·±åˆ»å˜é©ã€‚é¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰åç†å‰¯æ ¡é•¿ã€è…¾è®¯äº‘ TVP ç†Šè¾‰æ•™æˆä»ç‰©ç†å­¦ç¬¬ä¸€æ€§åŸç†å‡ºå‘ï¼Œæ·±åº¦å‰–æäº†ç”µåŠ›ä¸èµ„æºå¦‚ä½•æˆä¸º AI å‘å±•çš„ç»ˆæçº¦æŸï¼Œå¹¶æå‡ºäº†äººæœºåä½œæ–°å‹åŠ³åŠ¨ä½“çš„å¢ƒç•Œé‡æ„ã€‚é¢å¯¹ AI å¯¹ä¼ ç»Ÿæ•™è‚²çš„å†²å‡»ï¼Œä»–è®¤ä¸ºæœªæ¥çš„æ¶æ„å¸ˆåº”é€šè¿‡æé—®ä¸é‰´èµåŠ›ï¼Œå‘æ•°æ®ç¨€ç–çš„â€œæ— äººåŒºâ€è¿›å‘ï¼Œå®ç°ä»äººæ‰åˆ°äººç‰©çš„è·¨è¶Šã€‚</p>
<h2 data-id="heading-0"><strong>ä½œè€…ç®€ä»‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/158de73f590a4842896efa09f5254348~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061313&amp;x-signature=0W0ngX1lRsxpFw2Qs3lD9WKScks%3D" alt="" loading="lazy"/></p>
<p>ç†Šè¾‰ï¼Œé¦™æ¸¯ç§‘æŠ€å¤§å­¦ï¼ˆå¹¿å·ï¼‰åç†å‰¯æ ¡é•¿ã€è®²åº§æ•™æˆï¼Œè·å›½é™…äººå·¥æ™ºèƒ½ä¿ƒè¿›åä¼šä¼šå£«ï¼ˆAAAI Fellowï¼‰ã€ç¾å›½ç§‘å­¦ä¿ƒè¿›ä¼šä¼šå£«ï¼ˆAAAS Fellowï¼‰ã€ç”µæ°”ç”µå­å·¥ç¨‹å¸ˆå­¦ä¼šä¼šå£«ï¼ˆIEEE Fellowï¼‰ã€å›½é™…è®¡ç®—æœºå­¦ä¼šä¼šå£«ï¼ˆACM Fellowï¼‰ã€ä¸­å›½äººå·¥æ™ºèƒ½å­¦ä¼šä¼šå£«ã€ä¸­å›½è®¡ç®—æœºå­¦ä¼šä¼šå£«ã€å›½é™…è®¡ç®—æœºå­¦ä¼šï¼ˆACMï¼‰æ°å‡ºç§‘å­¦å®¶ã€å›½å®¶é‡å¤§äººæ‰å·¥ç¨‹å…¥é€‰ã€æ•™è‚²éƒ¨é•¿æ±Ÿè®²åº§æ•™æˆï¼Œæµ·å¤–æ°é’ã€å¹¿ä¸œçœåŠ³åŠ¨æ¨¡èŒƒç­‰è£èª‰ã€‚ä»–æ‹…ä»»å¹¿å·å¸‚äººæ°‘æ”¿åºœå‚äº‹ã€å¹¿å·æ¬§ç¾åŒå­¦ä¼šå‰¯ä¼šé•¿ã€ä¸­å›½è®¡ç®—æœºå­¦ä¼šå¤§æ•°æ®ä¸“å®¶å§”å‘˜ä¼šå‰¯ä¸»ä»»ã€Nature npj AI åˆ›åˆŠä¸»ç¼–ç­‰å¤šä¸ªé‡è¦æ”¿åºœã€ç¤¾ä¼šå’Œå­¦æœ¯èŒåŠ¡ã€‚æ­¤å‰ä»»ç¾å›½ç½—æ ¼æ–¯å¤§å­¦æ°å‡ºæ•™æˆã€ç™¾åº¦ç ”ç©¶é™¢å‰¯é™¢é•¿åŠé¦–å¸­ç§‘å­¦å®¶ï¼ˆT11ï¼‰ã€‚ä¸»è¦ä»äº‹äººå·¥æ™ºèƒ½ä¸æ•°æ®æŒ–æ˜ç ”ç©¶ï¼Œä¸»æŒæˆ–å‚ä¸å›½å®¶ç§‘æŠ€éƒ¨é‡ç‚¹ç ”å‘è®¡åˆ’ã€å›½å®¶è‡ªç„¶ç§‘å­¦åŸºé‡‘ï¼ˆå«é‡å¤§ç ”ç©¶è®¡åˆ’ï¼‰ã€‚ç†Šè¾‰æ•™æˆçš„ Google Scholar å¼•ç”¨è¶… 61000 æ¬¡ï¼Œh-index 101ï¼Œè· ACM SIGKDD æœåŠ¡å¥–ã€AAAI æœ€ä½³è®ºæ–‡å¥–ç­‰é¡¶çº§å¥–é¡¹ï¼Œå¹¶å¤šæ¬¡æ‹…ä»» KDDã€ICDM ç­‰è¡Œä¸šå¤§ä¼šä¸»å¸­ã€‚åœ¨äººæ‰åŸ¹å…»æ–¹é¢ï¼Œå·²æœ‰æ•°åä½å­¦ç”Ÿæˆä¸ºå›½é™…çŸ¥åå¤§å­¦æ•™æˆã€‚</p>
<h2 data-id="heading-1"><strong>ä¸€ã€ç©¿é€è¡¨è±¡ï¼Œæ¢æ±‚æ—¶ä»£æœ¬æºè§„å¾‹</strong></h2>
<p>æ€è€ƒäº‹ç‰©è¦è§¦è¾¾æœ¬è´¨ã€‚é©¬æ–¯å…‹æ¨å´‡çš„ç‰©ç†å­¦ç¬¬ä¸€æ€§åŸç†ï¼Œä¸ã€Šæ˜“ç»ã€‹â€œä¸æ˜“ã€å˜æ˜“ã€ç®€æ˜“â€ çš„å†…æ ¸ç›¸é€šï¼Œçš†æ˜¯å¯¹æœ¬æºçš„æ¢æ±‚ï¼Œéƒ½åœ¨å¯ç¤ºæˆ‘ä»¬ï¼šåœ¨å‰§å˜çš„æ—¶ä»£ï¼Œå”¯æœ‰ç©¿é€è¡¨è±¡ï¼Œæ‰èƒ½æ•æ‰åˆ°çœŸæ­£å†³å®šæœªæ¥çš„åº•å±‚é€»è¾‘ã€‚</p>
<p>å½“ä¸‹ AI çƒ­æ½®çš„åº•å±‚é€»è¾‘ï¼Œä¸åœ¨ç®—æ³•è¡¨å±‚ï¼Œè€Œåœ¨åŸºç¡€ç‰©ç†èµ„æºã€‚è¯„ä»·è‹±ä¼Ÿè¾¾çš„ä»·å€¼ï¼Œå¯ç®€åŒ–ä¸ºä¸€é“æ•°å­¦é¢˜ï¼šè®¡ç®—å…¶å…¨ç¾ GPU å¹´é”€é‡çš„æ€»è€—ç”µé‡ï¼Œå†å¯¹æ ‡ç¾å›½ç”µåŠ›æ€»å®¹é‡ã€‚æˆ‘è®¤ä¸ºï¼Œé™åˆ¶ AI å‘å±•çš„æœ¬è´¨ä¸æ˜¯ç®—åŠ›ï¼Œè€Œæ˜¯ç”µåŠ›æ°´å¹³ã€‚ç®—åŠ›éœ€æ±‚æŒ‡æ•°çº§å¢é•¿ï¼Œè‹¥ç”µåŠ›æ¶æ„è·Ÿä¸ä¸Šï¼Œä¼šå¼•å‘ç”µä»·é£æ¶¨ã€é€šèƒ€åŠ å‰§ï¼ŒæŒ¤å‹ä¼ ç»Ÿåˆ¶é€ ä¸šã€‚å› æ­¤ï¼Œæˆ‘åšæŠ€æœ¯æŠ•èµ„æœªå¿…ä¹°æŠ€æœ¯æœ¬èº«ï¼Œåè€Œä¼šå¸ƒå±€ â€œé“œâ€â€”â€” é“œä¸ç”µåŠ›æ‰æ˜¯è¿™ä¸ªæ—¶ä»£æ›´å…·ç¡®å®šæ€§çš„åº•å±‚é€»è¾‘ã€‚æ•°æ®ä½è¯ï¼šä¸­å›½ 2024 å¹´å‘ç”µé‡çº¦ç­‰äºç¾ã€æ¬§ã€æ—¥ã€ä¿„ã€å°æ€»å’Œï¼›ç¾å›½è‡ª ChatGPT å‘å¸ƒåç”µä»·ä¸Šæ¶¨ 40%ï¼Œç›´è§‚ä½“ç°äº† AI å¯¹åŸºç¡€èƒ½æºçš„å·¨å¤§éœ€æ±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/057c2a4873a343d1bcb885a2733f18a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061313&amp;x-signature=4XRJ6kddpJcsFOTJ31rYPc4iZpw%3D" alt="" loading="lazy"/></p>
<p>æ­£å¦‚ç‰©ç†èµ„æºçš„ä¸Šé™å†³å®šäº† AI çš„å‘å±•æœ¬è´¨ï¼Œäººç±»å¦‚ä½•åº”å¯¹è¿™ç§ç¡¬çº¦æŸï¼Œåˆ™å†³å®šäº†ç”Ÿäº§åŠ›çš„è¿›åŒ–æœ¬è´¨â€”â€”é‚£å°±æ˜¯æ„å»ºâ€œäººæœºåä½œçš„æ–°å‹åŠ³åŠ¨ä½“â€ã€‚</p>
<p>æˆ‘ä»¬æ­£å¤„äºäººå·¥æ™ºèƒ½æ–°ç»æµå‘å±•æ—¶ä»£ï¼Œè¿™è¦æ±‚æˆ‘ä»¬å¿…é¡»é‡æ–°å®šä¹‰æ¶æ„å¸ˆçš„è¾¹ç•Œã€‚å¯¹äºäººå·¥æ™ºèƒ½ä»ä¸šè€…è€Œè¨€ï¼Œæ¯ä¸ªäººéƒ½æœ‰æœºä¼šæˆä¸ºæŒæ§å…¨å±€çš„æ¶æ„å¸ˆï¼Œä½ çš„æ ¸å¿ƒç«äº‰åŠ›ä¸å†æ˜¯å•æ‰“ç‹¬æ–—ï¼Œè€Œæ˜¯é©¾é©­æœºå™¨çš„è§„æ¨¡ã€‚é¢è¯•æ—¶ï¼Œä½ ä¸å†æ˜¯ä¸€ä¸ªäººï¼Œè€Œæ˜¯å¸¦ç€â€œN å°æœºå™¨â€å…¥åœºï¼šèƒ½é©±åŠ¨ 10 å°æœºå™¨ï¼Œä½ å°±æœ‰åº•æ°”æ‹¿æ•°å€çš„è–ªæ°´ï¼›èƒ½é©¾é©­ 100 å°æœºå™¨ï¼Œä½ å°±èƒ½ä¸€ä¸ªäººé¡¶ä¸€ä¸ªå›¢é˜Ÿï¼Œå®šä¹‰ä¸€ä¸ªé¡¹ç›®ã€å®šä¹‰ä¸€ä¸ªæœªæ¥ã€‚è¿™ä¾¿æ˜¯äººæœºåä½œæ–°å‹åŠ³åŠ¨ä½“çš„åº•æ°”ï¼šå‡­å€Ÿç®¡ç†æœºå™¨çš„èƒ½åŠ›ï¼Œä¸ªäººå®Œå…¨å¯ä»¥çªç ´ä¼ ç»ŸäººåŠ›åŠ³åŠ¨çš„ä¸Šé™ï¼Œæˆä¸ºäººæœºæ··åˆæ—¶ä»£é‡Œå®šä¹‰æœªæ¥çš„é¡¶çº§æ¶æ„å¸ˆã€‚</p>
<h2 data-id="heading-2"><strong>äºŒã€AIæ—¶ä»£æ ¸å¿ƒèƒ½åŠ›ï¼šæé—®ä¸é‰´èµåŠ›</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcb4f1882df94c58ac427c9142664a88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061313&amp;x-signature=cuimxUye9WjoCxAOmuPP5kuZ%2BFA%3D" alt="" loading="lazy"/></p>
<p>ä¸ºä»€ä¹ˆç°åœ¨è¦åŸ¹è‚²äººæœºåä½œæ–°å‹åŠ³åŠ¨ä½“ï¼Ÿ</p>
<p>æˆ‘è®¤ä¸ºé€šè¿‡æ•™è‚²å¯ä»¥å®ç°çš„äººç±»æ™ºèƒ½åˆ†ä¸ºå››ä¸ªå¢ƒç•Œï¼š</p>
<ul>
<li>
<p>åšé—»å¼ºè¯†ï¼Œå³å­¦ç§‘çŸ¥è¯†çš„ç§¯ç´¯ï¼›</p>
</li>
<li>
<p>è§¦ç±»æ—é€šï¼Œå…·å¤‡è·¨è¡Œä¸šçš„è¿ç§»èƒ½åŠ›ï¼›</p>
</li>
<li>
<p>ä¸€å¶çŸ¥ç§‹ï¼Œèƒ½åœ¨è¡Œä¸šå†…è¿›è¡Œç²¾å‡†çš„é¢„æµ‹ä¸æ¨ç†ï¼›</p>
</li>
<li>
<p>æ— ä¸­ç”Ÿæœ‰ï¼Œå®ç°ä» 0 åˆ° 1 çš„åŸå§‹åˆ›æ–°ï¼Œå¦‚ç›¸å¯¹è®ºæˆ–ç‰›é¡¿ä¸‰å¤§åŠ›å­¦ã€‚</p>
</li>
</ul>
<p>åœ¨å¤§æ¨¡å‹æ—¶ä»£ï¼ŒAI ä¸€ä¸Šæ¥å°±é€šè¿‡æµ·é‡æ•°æ®â€œæ‰“æ‰â€äº†äººç±»çš„å‰ä¸¤ä¸ªå¢ƒç•Œï¼Œè€Œåœ¨â€œä¸€å¶çŸ¥ç§‹â€å±‚é¢çš„è¶…è¶Šä¹Ÿåªæ˜¯æ—¶é—´é—®é¢˜ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬è¿‡å»çš„æ•™è‚²ä¾ç„¶åªåŠªåŠ›åŸ¹å…»åšé—»å¼ºè¯†çš„å­¦ç”Ÿï¼Œé‚£åœ¨ AI é¢å‰å°†ä¸åä¸€æ–‡ã€‚ä½œä¸ºæ¶æ„å¸ˆï¼Œå¿…é¡»åˆ©ç”¨ AI å½¢æˆäººæœºæ··åˆçš„æˆ˜é˜Ÿï¼Œåœ¨æ›´é«˜ç»´åº¦çš„å¢ƒç•Œä¸­å¯»æ‰¾ç”Ÿå­˜ç©ºé—´ã€‚</p>
<p>è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæé—®ä¸é‰´èµåŠ›æˆäº†æ¶æ„å¸ˆçš„æ ¸å¿ƒæŠ€èƒ½ã€‚</p>
<p>æˆ‘å·²å¹´è¿‡äº”åï¼Œä½†è¿‡å»ä¸¤ä¸‰å¹´æˆ‘çš„å·¥ä½œå’Œå­¦ä¹ æ•ˆç‡æ˜¯æŒ‡æ•°çº§æé«˜çš„ï¼Œä¸€å¹´å®Œæˆçš„å·¥ä½œé‡ç”šè‡³è¶…è¿‡äº†è¿‡å»äº”å…­å¹´çš„æ€»å’Œã€‚è¿™ç§é£è·ƒæºäºæˆ‘å°† AI å˜æˆäº†æ·±åº¦å­¦ä¹ çš„ä¼´ä¾£ã€‚é¢å¯¹å¦‚ NeurIPS æ¯å¹´äº§å‡ºçš„äº”å…­åƒç¯‡æ–‡ç« ï¼Œä¼ ç»Ÿè¯»æ³•å·²ä¸å¯è¡Œã€‚æˆ‘åˆ©ç”¨ AI Agent è¿›è¡Œç­›é€‰ï¼Œå½»åº•æ”¹å˜äº†æˆ‘çš„ä¿¡æ¯è·å–æ–¹å¼ã€‚æˆ‘æ¸…æ¥šè‡ªèº«å…´è¶£æ–¹å‘ä¸çŸ¥è¯†åŸºç¡€ï¼Œå€ŸåŠ© AI Agent æŒ‰æ˜ç¡®æ¡ä»¶ï¼ˆå¦‚ä½œè€… h æŒ‡æ•°ä¸ä½äº 20ã€è´¡çŒ®è¶³å¤Ÿå¤§ï¼‰ç­›é€‰æ–‡çŒ®ï¼Œç•™å­˜ä¼˜è´¨å†…å®¹åé€šè¿‡æé—®è®¨è®ºï¼Œå¿«é€Ÿé”å®šæ ¸å¿ƒä»»åŠ¡ã€‚</p>
<p>æˆ‘çš„è¯»ä¹¦æ•ˆç‡ä¹Ÿå¤§å¹…æå‡ï¼Œä»ä¸€å¹´ 10 æœ¬å¢è‡³ 100 æœ¬ã€‚ç»å…¸å¤ç±å³ä¾¿ç»“åˆ AI è®¨è®ºï¼Œé˜…è¯»ä»æ…¢ï¼›ä½†ç§‘æŠ€ç±»æ–°ä¹¦å¯å€ŸåŠ© AI é«˜æ•ˆæ¢³ç†ï¼š20 åˆ†é’Ÿå†…è·å– 10 å¥æ ¸å¿ƒè§‚ç‚¹ï¼Œç­›é€‰æœ‰æ–°æ„çš„è¡¨è¿°å¹¶å»¶ä¼¸è§£è¯»ï¼Œæœ€ç»ˆé”å®šå…³é”®è§‚ç‚¹å¯¹åº”çš„ç« èŠ‚å¿«é€Ÿç¿»é˜…ï¼Œå³å¯å®Œæˆæ ¸å¿ƒè®¤çŸ¥ï¼Œå®ç°äº†å­¦ä¹ æ•ˆç‡è´¨çš„é£è·ƒã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘æ•™ç»™å­¦ç”Ÿä¸€ä¸ªåˆ¤æ–­åˆ›æ–°ä»·å€¼çš„â€œå¹»è§‰åŸåˆ™â€ï¼šåŒæ—¶ç”¨ä¸‰ä¸ªå¤§æ¨¡å‹æµ‹è¯•ï¼Œå¦‚æœ AI èŠå¾—å¤´å¤´æ˜¯é“ï¼Œè¯´æ˜æ•°æ®å·²ç»è¦†ç›–ï¼Œä¸å€¼å¾—åšï¼›å¦‚æœ AI å¼€å§‹äº§ç”Ÿå¹»è§‰æˆ–èƒ¡è¯´å…«é“ï¼Œè¯´æ˜ä½ è§¦ç¢°åˆ°äº†è®¤çŸ¥çš„ç›²åŒºã€‚æ­¤æ—¶å¿…é¡»è¿…é€Ÿåœ¨ä¸¤å‘¨å†…å®Œæˆçªç ´ï¼Œå› ä¸ºä½ å·²ç»é€šè¿‡æé—®æš´éœ²äº†æ–¹å‘ï¼Œå¿…é¡»åˆ©ç”¨é€Ÿåº¦è·‘èµ¢ AI çš„è¿›åŒ–ã€‚</p>
<h2 data-id="heading-3"><strong>ä¸‰ã€æ•°æ®è´¨é‡ï¼šAIæ—¶ä»£çš„ä»·å€¼åˆ†æ°´å²­</strong></h2>
<p>åœ¨æ™ºèƒ½é©å‘½æ—¶ä»£ï¼Œæ•°æ®å·²æˆä¸ºæ ¸å¿ƒç”Ÿäº§èµ„æ–™ï¼Œé©±åŠ¨ç€ä»æ•°æ®é£è½®åˆ°æŠ€æœ¯é£è½®ï¼Œå†åˆ°äº§ä¸šé£è½®çš„æ·±åº¦æ¼”è¿›ã€‚ä¸€ä¸ªå›½å®¶è‹¥ç¼ºä¹æ•°æ®åº”ç”¨åœºæ™¯ï¼Œå°±æ— æ³•å®ç°æŠ€æœ¯è¿­ä»£ä¸äº§ä¸šå‡çº§ï¼Œæ›´æ— æ³•åŸ¹å…»é¡¶å°–äººæ‰ã€‚ä¸­å›½æ‹¥æœ‰å‰æ‰€æœªæœ‰çš„åº”ç”¨åœºæ™¯æ²ƒåœŸï¼Œè¿™ä¸º IT ä¸ AI ä»ä¸šè€…æä¾›äº†ç»ä½³çš„å†å²æœºé‡ã€‚æ”¾çœ¼å…¨çƒï¼ŒçœŸæ­£æœ‰èƒ½åŠ›å…¨æ–¹ä½è¿›å…¥è¿™åœºé£è½®è§’é€çš„åªæœ‰ä¸­ç¾ä¸¤å›½ã€‚èº«ä¸ºå…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘ä»¬æ­£èº«å¤„ä¸€ä¸ªå‰æ‰€æœªæœ‰çš„å¹¿é˜”èˆå°ã€‚</p>
<p>äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œå†³å®šä¸ªäººã€ä¼ä¸šä¹ƒè‡³å›½å®¶é€‰æ‹©çš„æ ¸å¿ƒé€»è¾‘ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘è®¤ä¸ºç­”æ¡ˆå¾ˆç®€å•â€”â€”æ•°æ®è´¨é‡ã€‚</p>
<p>ä¸ªäººåˆå¦‚ä½•åˆ©ç”¨æ•°æ®è´¨é‡å¯»æ‰¾é€‚åˆæ·±è€•çš„äº§ä¸šé¢†åŸŸå‘¢ï¼Ÿåœ¨æ¢è®¨ AI å¦‚ä½•èµ‹èƒ½äº§ä¸šæ—¶ï¼Œå¿…é¡»åŒºåˆ†ä¸åŒçš„è§†è§’ã€‚å¯¹äºå›½å®¶å’Œå¤§å‹ä¼ä¸šè€Œè¨€ï¼Œé¦–è¦ä»»åŠ¡æ˜¯å¯»æ‰¾æ•°æ®è‚¥æ²ƒçš„é¢†åŸŸï¼Œé€šè¿‡é«˜è´¨é‡æ•°æ®å¿«é€Ÿå‚¬ç”Ÿå‡ºä¸šç»©å’Œæˆæœï¼›ä½†ç«™åœ¨ä¸ªäººèŒä¸šè§„åˆ’çš„è§’åº¦ï¼Œæˆ‘å´å»ºè®®å¤§å®¶åº”å½“åå…¶é“è€Œè¡Œä¹‹ã€‚æ•°æ®è´¨é‡å†³å®šäº† AI æ¸—é€çš„é€Ÿåº¦ï¼Œä»£ç æ•°æ®ä»£è¡¨æ€§å¥½ã€è¯„ä»·æœºåˆ¶æ˜ç¡®çš„é¢†åŸŸï¼Œç¨‹åºå‘˜é¦–å½“å…¶å†²è¢« AI èµ‹èƒ½ç”šè‡³æ›¿ä»£ï¼›è€Œé‚£äº›æ•°æ®ç¨€ç–ã€ç¯å¢ƒå¤æ‚ã€é‡‡é›†æˆæœ¬é«˜çš„è¡Œä¸šï¼Œåè€Œæ˜¯äººç±»ç»éªŒçš„ä¼˜åŠ¿é¢†åŸŸã€‚</p>
<p>è¿™ç§ç¯å¢ƒä¸‹ï¼Œé‚£äº›â€œå¯æ„ä¼šä¸å¯è¨€ä¼ â€çš„çŸ¥è¯†æ‰å…·é•¿æœŸä»·å€¼ã€‚æˆ‘ä»¬éœ€è¦å»å¾€äººç±»æœªæ›¾é‡‡é›†ã€æœªæ›¾æŠµè¾¾çš„åœ°æ–¹ï¼Œæ‰èƒ½åšåˆ°è®¤çŸ¥å±‚é¢çš„çœŸæ­£å‘ç°ã€‚</p>
<h2 data-id="heading-4"><strong>å››ã€äººæœºåä½œæ–°å‹åŠ³åŠ¨ä½“å››å¤§æ ¸å¿ƒæŠ€èƒ½</strong></h2>
<p>å…¨çƒå‘å±•è§„å¾‹å·²ååˆ†æ¸…æ™°ï¼šåœ¨ç¾å›½ï¼Œå­¦å†è¶Šé«˜ï¼Œä¸ AI æ‹‰å¼€å·®å¼‚åŒ–ç«äº‰çš„æœºä¼šè¶Šå¤§ï¼Œè–ªèµ„ä¹Ÿè¶Šé«˜ã€‚è¿™å¯¹æ¶æ„å¸ˆæ˜¯æœºé‡ï¼Œä½†æœºé‡æœ‰å‰æï¼šå¿…é¡»é©¾é©­äººå·¥æ™ºèƒ½ï¼Œæˆé•¿ä¸º AI æ—¶ä»£æ–°å‹æ¶æ„å¸ˆï¼Œå¦åˆ™ç»ˆå°†è¢«æ—¶ä»£æ·˜æ±°ã€‚å½“ä¸‹è¦ç€åŠ›åŸ¹å…»äººæœºååŒæ–°å‹åŠ³åŠ¨ä½“ï¼Œé”¤ç‚¼å››å¤§æ ¸å¿ƒæŠ€èƒ½ï¼Œä¸”æŒæ¡ AI æ˜¯æ‰€æœ‰è¡Œä¸šçš„å¿…ä¿®è¯¾ï¼Œè€Œéé€‰æ‹©é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f206863e387b4fcca0110156d7f4b608~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061313&amp;x-signature=JmxlwDrQJ3EedHuJj5dZSPvAay8%3D" alt="" loading="lazy"/></p>
<p><strong>1ã€é©¾é©­ AI ä»äº‹æœ¬è¡Œä¸šçš„èƒ½åŠ›</strong></p>
<p>é©¾é©­ AI å·²ä»è¡Œä¸šåŠ åˆ†é¡¹è½¬ä¸ºç”Ÿå­˜å¿…é€‰é¡¹ã€‚å³ä½¿æ˜¯éè®¡ç®—æœºç›¸å…³çš„è¡Œä¸šï¼Œå¦‚è‰ºæœ¯è¡Œä¸šï¼Œä¼ ç»Ÿçµæ„Ÿçš„æ¯ç«­ä¹Ÿèƒ½é€šè¿‡ AI è¾…åŠ©å¾—ä»¥ç ´è§£ï¼Œè·¨ç•Œäº¤å‰ä¸ä»…å‚¬ç”Ÿäº†åˆ›æ–°ï¼Œæ›´å®ç°äº†äº§å‡ºçš„æŒ‡æ•°çº§è·¨è¶Šã€‚è¿™æ­ç¤ºäº†ä¸€ä¸ªæœ¬è´¨ï¼šæ— è®ºèº«å¤„ä½•ä¸šï¼Œæ ¸å¿ƒç«äº‰åŠ›å·²ä¸å†æ˜¯æ­»å®ˆä¼ ç»ŸæŠ€èƒ½ï¼Œè€Œåœ¨äºé©¾é©­æœºå™¨çš„èƒ½åŠ›ã€‚</p>
<p><strong>2ã€åŸ¹å…»å’Œæœºå™¨å·®å¼‚åŒ–çš„èƒ½åŠ›</strong></p>
<p>AI æ“…é•¿ â€œä»ä¹¦æœ¬åˆ°ä¹¦æœ¬â€ çš„çŸ¥è¯†è½¬åŒ–ï¼Œæ­£å¦‚ç»´ç‰¹æ ¹æ–¯å¦æ‰€è¨€ï¼Œå‡¡æ˜¯èƒ½ç”¨è¯­è¨€æ¸…æ™°è¡¨è¿°çš„å†…å®¹ï¼ŒAI éƒ½èƒ½èƒœä»»ã€‚è€Œé‚£äº›åªå¯æ„ä¼šä¸å¯è¨€ä¼ çš„ç»éªŒä¸æ™ºæ…§ï¼Œæ‰æ˜¯äººç±»çš„ç‹¬ç‰¹æœºä¼šï¼Œæ›´æ˜¯æ¶æ„å¸ˆéœ€è¦æ·±è€•çš„èƒ½åŠ›ã€‚</p>
<p>æˆ‘å¸¸å¯¹å­¦ç”Ÿè¯´ï¼Œå­¦ä¹ æ¨¡å¼å¿…é¡»è½¬å‹ï¼šç”¨ 50% æ—¶é—´æ­å»ºçŸ¥è¯†æ¡†æ¶ï¼Œå‰©ä½™ç²¾åŠ›æ‹“å±•å¤šé¢†åŸŸçŸ¥è¯†å¹¶èº¬èº«å®è·µã€‚æ¶æ„å¸ˆäº¦æ˜¯å¦‚æ­¤ï¼Œå”¯æœ‰äº²æ‰‹æ”»å…‹å¤æ‚é—®é¢˜ï¼Œæ‰èƒ½æ²‰æ·€ä¹¦æœ¬ä¹‹å¤–çš„æ ¸å¿ƒèƒ½åŠ›ã€‚</p>
<p><strong>3ã€é”»é€ äººæœºæ··åˆåˆ›æ–°èƒ½åŠ›</strong></p>
<p>è¿™ç§èƒ½åŠ›éœ€åœ¨ç‚¹æ»´å®è·µä¸­ç§¯ç´¯ï¼Œæ›¾å›½è—©çš„ â€œä¸‰ä»¤äº”ç”³â€ åœ¨æ–°æ—¶ä»£åº”æœ‰æ–°è§£è¯»ï¼šä¸å†æ˜¯è­¦ç¤ºè¿‡é”™ï¼Œè€Œæ˜¯è‡ªæˆ‘è¿­ä»£çš„æ ‡å°º â€”â€” åšå®Œæ¯ä»¶äº‹ï¼ŒåŠ¡å¿…æ€è€ƒå¦‚ä½•åšå¾—æ›´å¥½ã€‚äº¤åŠä»»åŠ¡ä¸èƒ½åªæ»¡è¶³ â€œå®Œæˆâ€ï¼Œæ›´è¦è¿½æ±‚ â€œä¼˜åŒ–â€ã€‚èªæ˜äººåšäº‹ï¼Œç¬¬ä¸€æ¬¡æŠ•å…¥ 120% ç²¾åŠ›æ— å¦¨ï¼Œç¬¬äºŒæ¬¡å‹ç¼©è‡³ 80%ï¼Œç¬¬ä¸‰æ¬¡é™è‡³ 50%ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ€»ç»“åˆ›æ–°ï¼Œæå‡æ•ˆç‡ä¸è´¨é‡ï¼Œæ‰æ˜¯çœŸæ­£çš„æˆé•¿ï¼Œä¹Ÿæ˜¯äººæœºååŒæ—¶ä»£çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
<p><strong>4ã€åŸ¹å…»ä» 0 åˆ° 1 çš„åˆ›æ–°èƒ½åŠ›</strong></p>
<p>ç°ä»£ç¤¾ä¼šäºŸéœ€åŸ¹è‚²ä» 0 åˆ° 1 çš„æ•´ä½“åˆ›æ–°èƒ½åŠ›ï¼Œè€Œåˆ›æ–°å®¹é”™ç¯å¢ƒæ˜¯å…³é”®å‰æã€‚åˆ›æ–°æœ¬å°±æ˜¯ä¹æ­»ä¸€ç”Ÿï¼Œä¼ä¸šè‹¥æƒ³å­•è‚²åˆ›æ–°çš„çƒ­å¸¦é›¨æ—ï¼Œå¿…å…ˆæ„å»ºå®¹é”™çš„åœŸå£¤ã€‚çºµè§‚ç¾å›½ç¡…è°·ä¸ä¸­å›½å¤§æ¹¾åŒºçš„å‘å±•ï¼Œå…¶åº•å±‚é€»è¾‘å¯å½’ç»“ä¸º 12 å­—å†…æ ¸ï¼šæ‹“è’ä¹‹å‹‡ã€åŒ…å®¹ä¹‹é‡ã€åˆ›æ–°ä¹‹é­‚ã€‚</p>
<ul>
<li>
<p>å…¶ä¸€ï¼Œæ‹“è’ä¹‹å‹‡æ˜¯ç ´å±€æ ¹åŸºã€‚â€œå·â€æœ¬æ˜¯ä¸­æ€§è¯ï¼Œåœ¨å­˜é‡ç©ºé—´é‡Œå†…è€—æ˜¯æ— æ•ˆå†…å·ï¼Œä½†åœ¨å¢é‡æ— äººåŒºæ·±è€•ç»†ä½œï¼Œå°±æ˜¯å€¼å¾—æ¨å´‡çš„å·¥åŒ ç²¾ç¥ã€‚</p>
</li>
<li>
<p>å…¶äºŒï¼ŒåŒ…å®¹ä¹‹é‡æ˜¯æˆé•¿æ²ƒåœŸã€‚ä¸ºä»€ä¹ˆä¸­å›½è¿™ä¹ˆå¤šå¹´æ¥è¿˜æ²¡æœ‰å‡ºç°è¯ºè´å°”å¥–å¾—ä¸»ï¼Ÿæˆ‘è®¤ä¸ºæ— éœ€ç„¦è™‘ï¼Œç­‰åˆ° 95 åã€00 åçœŸæ­£æˆé•¿èµ·æ¥ï¼Œæœªæ¥å¿…ç„¶ä¼šæœ‰ã€‚å› ä¸ºè¯ºè´å°”å¥–çš„è¯ç”Ÿéœ€è¦åˆ›ä½œè€…æ‘†è„±åŠŸåˆ©ç›®çš„ï¼Œçº¯ç²¹ä¸ºå…´è¶£è€Œé’»ç ”ï¼Œè€Œè¿™ä¸€ä»£æ–°äººåº”å½“æ˜¯å…·æœ‰è´µæ—ç²¾ç¥çš„ç¾¤ä½“ï¼Œä»–ä»¬ä»æœªç»å†è¿‡ç‰©è´¨åŒ®ä¹çš„å›°å¢ƒï¼Œæ²¡æœ‰ç”Ÿå­˜çš„ææƒ§æ„Ÿï¼Œèƒ½å¤Ÿå…¨èº«å¿ƒæŠ•å…¥è‡ªå·±çƒ­çˆ±çš„ç ”ç©¶ã€‚åŒæ—¶ï¼Œè¿™ä¸€åˆ‡ä¹Ÿç¦»ä¸å¼€å›½å®¶ã€ç¤¾ä¼šã€ä¼ä¸šä¹ƒè‡³å®¶åº­å…±åŒè¥é€ çš„åŒ…å®¹ã€å®¹é”™çš„åˆ›æ–°ç¯å¢ƒï¼Œè¿™ç§ç¯å¢ƒæ˜¯åŸ¹å…» â€œä»é›¶åˆ°ä¸€â€ åˆ›æ–°äººæ‰çš„åœŸå£¤ï¼Œä¹Ÿæ˜¯è¯ºè´å°”å¥–å¾—ä»¥è¯ç”Ÿçš„å¿…è¦å‰æã€‚</p>
</li>
<li>
<p>å…¶ä¸‰ï¼Œåˆ›æ–°çš„æ ¸å¿ƒï¼Œåœ¨äºæ•¢äºçªç ´è®¤çŸ¥è¾¹ç•Œã€‚è¦ä»æ•°æ®ç›²åŒºåˆ‡å…¥ï¼Œé€æ­¥çªç ´æ„ŸçŸ¥ç›²åŒºã€è®¤çŸ¥ç›²åŒºï¼Œå»å¾€äººç±»æœªæ›¾æ¶‰è¶³ã€æœªæ›¾é‡‡é›†çš„é¢†åŸŸï¼Œæ‰èƒ½å®ç°çœŸæ­£çš„è®¤çŸ¥ä¸ç›²åŒºå‘ç°ã€‚</p>
</li>
<li>
<p>æœ€åï¼Œæˆ‘æ€»ç»“äº†ä¸€å¥—åˆ›æ–°å®è·µæ³•åˆ™ï¼šçŸ¥è¡Œåˆä¸€ã€è¯•é”™è¿­ä»£ã€å¤§åŠ›å‡ºå¥‡è¿¹ã€‚å½“ä¸‹èªæ˜äººæ¯”æ¯”çš†æ˜¯ï¼Œæœºä¼šå¾€å¾€é›†ä¸­åœ¨å¤´éƒ¨é¢†åŸŸï¼Œå”¯æœ‰å‘å¤´éƒ¨è¿ˆè¿›ï¼Œæ‰èƒ½æŠ¢å æ›´å¤šæœºé‡ã€‚</p>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3359176a4b08415e82b45894f4bc44f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061313&amp;x-signature=WMZbMMAitkzyVPqiTMpyYvVtPTs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5"><strong>äº”ã€æ¶æ„å¸ˆçš„æ—¶ä»£ä½¿å‘½</strong></h2>
<p>éšç€äººå·¥æ™ºèƒ½æå¤§åœ°æå‡ç ”å‘æ•ˆèƒ½ï¼Œä¼ä¸šçš„ç»„ç»‡å½¢å¼æ­£å‘ç”Ÿæ ¹æœ¬æ€§å˜é©ã€‚è¿‡å»ï¼Œæˆ‘ä»¬ä¾èµ–äººæµ·æˆ˜æœ¯çš„å¤§å…µå›¢ä½œæˆ˜ï¼›æœªæ¥ï¼Œç»„ç»‡å°†è½¬å‘ç±»ä¼¼ç°ä»£æˆ˜åœºçš„ç‰¹æˆ˜é˜Ÿæ¨¡å¼ã€‚è¿™æ„å‘³ç€ï¼Œä¼ä¸šä¸å†å•çº¯è¿½æ±‚åŸºç¡€å¼€å‘äººå‘˜æ„æˆçš„å·¥ç¨‹å¸ˆçº¢åˆ©ï¼Œè€Œæ˜¯æåº¦æ¸´æ±‚å…·å¤‡é¡¶å±‚è®¤çŸ¥çš„é¢†å†›äººç‰©ã€‚</p>
<p>ä»äººæ‰åˆ°äººç‰©ï¼Œæ˜¯è·¨è¶Šå¼çš„è¿›é˜¶ã€‚T å‹äººæ‰æ‹¥æœ‰æ·±åšçš„ä¸“ä¸šåº•è•´ä¸å¹¿åšçš„è§†é‡ï¼Œè€Œâ€œäººç‰©â€åˆ™æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šå®Œæˆäº†è®¤çŸ¥çš„è·ƒè¿ã€‚å¦‚æœè¯´äººæ‰æä¾›äº†è§£å†³é—®é¢˜çš„â€œé‡‘æ‰‹æŒ‡â€ï¼Œé‚£ä¹ˆäººç‰©åˆ™æä¾›äº†å®šä¹‰é—®é¢˜çš„â€œé‡‘è„‘è¢‹â€ã€‚</p>
<p>æˆ‘å¯¹æ ¸å¿ƒäººç‰©çš„ä»·å€¼è¡¡é‡è¿˜æœ‰ä¸€ä¸ªæ˜ç¡®æ ‡å‡†ï¼šåœ¨ç§‘å­¦æŠ€æœ¯åŒ–ã€æŠ€æœ¯äº§å“åŒ–ã€äº§å“äº§ä¸šåŒ–ã€äº§ä¸šèµ„æœ¬åŒ–ã€èµ„æœ¬ç§‘å­¦åŒ–çš„å…¨é“¾æ¡å¾ªç¯ä¸­ï¼Œèšç„¦å»ºå¹³å°ã€åšç³»ç»Ÿã€å®šæ ‡å‡†ã€åˆ›å“ç‰Œå››å¤§æ ¸å¿ƒåŠ¨ä½œ â€”â€” è¿™æ—¢æ˜¯æˆ‘ä»¬å¯¹æ ‡æ†äººç‰©çš„å®šä½ï¼Œä¹Ÿæ˜¯æ¶æ„å¸ˆçš„æ ¸å¿ƒèŒè´£ã€‚</p>
<p>æˆ‘ä»¬è¦è‡´åŠ›äºæˆä¸ºå¹³å°ã€ç³»ç»Ÿã€æ ‡å‡†çš„å»ºè®¾è€…ä¸å“ç‰Œçš„æ‰“é€ è€…ï¼Œæ›´è¦ä»¥æ­¤ä¸ºç›®æ ‡èµ‹èƒ½æ¯ä¸€ä½æ¶æ„å¸ˆã€‚åœ¨ AI æ–°æ—¶ä»£ï¼Œæ¶æ„å¸ˆéœ€è¦çªç ´è¾¹ç•Œã€å®šä¹‰è¾¹ç•Œï¼Œè€Œèƒ½å¤Ÿæ‰›èµ· â€œå»ºå¹³å°ã€åšç³»ç»Ÿã€å®šæ ‡å‡†ã€åˆ›å“ç‰Œâ€ çš„é‡ä»»ï¼Œæ­£æ˜¯è¿™ä¸ªæ—¶ä»£èµ‹äºˆæ¶æ„å¸ˆçš„æ ¸å¿ƒä½¿å‘½ä¸æ˜ç¡®è¦æ±‚ã€‚</p>
<p>æˆ‘ä»¬æ­£å¤„äºäººå·¥æ™ºèƒ½çš„å‰æ²¿ï¼Œè¿™æ—¢æ˜¯æŒ‘æˆ˜ä¹Ÿæ˜¯å¹¸è¿ã€‚æ­£å¦‚ç½—æ›¼Â·ç½—å…°æ‰€è¯´ï¼šä¸–ç•Œä¸Šåªæœ‰ä¸€ç§çœŸæ­£çš„è‹±é›„ä¸»ä¹‰ï¼Œé‚£å°±æ˜¯åœ¨è®¤æ¸…ç”Ÿæ´»çš„çœŸç›¸åä¾ç„¶çƒ­çˆ±ç”Ÿæ´»ã€‚<strong>æˆ‘å¸Œæœ›æˆ‘ä»¬ä¸ä»…èƒ½ç†Ÿç»ƒé©¾é©­å·¥å…·ï¼Œæ›´èƒ½åœ¨æ´å¯Ÿäº†ä¸–ç•Œçš„çœŸç›¸ã€çœ‹è§äº†ç§‘æŠ€å¸¦æ¥çš„ç§ç§å†²å‡»åï¼Œä¾ç„¶çƒ­çˆ±è¿™ä¸ªä¸–ç•Œã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 15 ServiceManagerä¸BinderæœåŠ¡æ³¨å†Œæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7603651011978477610</link>    <guid>https://juejin.cn/post/7603651011978477610</guid>    <pubDate>2026-02-07T09:57:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603651011978477610" data-draft-id="7603651011978444842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 15 ServiceManagerä¸BinderæœåŠ¡æ³¨å†Œæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Android,æºç ,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2026-02-07T09:57:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 15 ServiceManagerä¸BinderæœåŠ¡æ³¨å†Œæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:57:22.000Z" title="Sat Feb 07 2026 09:57:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­,æˆ‘ä»¬æ·±å…¥åˆ†æäº†Binderé©±åŠ¨çš„å†…æ ¸æœºåˆ¶ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜è¿˜æ²¡æœ‰å›ç­”:<strong>Clientå¦‚ä½•çŸ¥é“Serverçš„Binderå¥æŸ„?</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹,ä½ æƒ³æ‰“ç”µè¯ç»™æœ‹å‹,ä½†ä½ ä¸çŸ¥é“ä»–çš„ç”µè¯å·ç ã€‚è¿™æ—¶ä½ éœ€è¦æŸ¥ç”µè¯ç°¿(Yellow Pages)ã€‚åœ¨Androidç³»ç»Ÿä¸­,<strong>ServiceManagerå°±æ˜¯è¿™æœ¬"ç”µè¯ç°¿"</strong>â€”â€”å®ƒç»´æŠ¤äº†ç³»ç»Ÿä¸­æ‰€æœ‰æœåŠ¡çš„æ³¨å†Œè¡¨,æä¾›æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<p>æ²¡æœ‰ServiceManager,Binder IPCå°±æ— æ³•å·¥ä½œã€‚æ‰€æœ‰çš„ç³»ç»ŸæœåŠ¡(å¦‚ActivityManagerServiceã€WindowManagerService)éƒ½éœ€è¦å…ˆå‘ServiceManageræ³¨å†Œ,å®¢æˆ·ç«¯æ‰èƒ½é€šè¿‡ServiceManageræŸ¥è¯¢åˆ°å®ƒä»¬çš„Binderå¥æŸ„,è¿›è€Œè¿›è¡Œè·¨è¿›ç¨‹è°ƒç”¨ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥Android 15æºç ,å‰–æServiceManagerçš„å·¥ä½œæœºåˆ¶:</p>
<p><strong>ä½ å°†å­¦åˆ°:</strong></p>
<ul>
<li>ServiceManagerçš„å¯åŠ¨æµç¨‹ä¸ç‰¹æ®Šæ€§</li>
<li>æœåŠ¡æ³¨å†Œ(addService)çš„å®Œæ•´å®ç°</li>
<li>æœåŠ¡æŸ¥è¯¢(getService)çš„æŸ¥æ‰¾æœºåˆ¶</li>
<li>æ­»äº¡é€šçŸ¥(DeathRecipient)çš„å·¥ä½œåŸç†</li>
<li>VINTFå£°æ˜éªŒè¯ä¸å®‰å…¨æœºåˆ¶</li>
<li>Android 15çš„æ–°ç‰¹æ€§ä¸ä¼˜åŒ–</li>
</ul>
<h2 data-id="heading-1">ServiceManagerçš„ç‰¹æ®Šæ€§</h2>
<p>åœ¨æ·±å…¥ä»£ç å‰,æˆ‘ä»¬å…ˆç†è§£ServiceManagerçš„å‡ ä¸ªç‰¹æ®Šä¹‹å¤„ã€‚</p>
<h3 data-id="heading-2">1. Handle 0:ServiceManagerçš„å”¯ä¸€æ ‡è¯†</h3>
<p>åœ¨Binderç³»ç»Ÿä¸­,ServiceManageræœ‰ä¸€ä¸ª<strong>ç¡¬ç¼–ç çš„å¥æŸ„å€¼:0</strong>ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ProcessState.cpp</span>
<span class="hljs-keyword">enum</span> {
    CONTEXT_MGR_HANDLE = <span class="hljs-number">0</span>  <span class="hljs-comment">// ServiceManagerçš„å¥æŸ„å›ºå®šä¸º0</span>
};
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ª"å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹"çš„é—®é¢˜:</p>
<ul>
<li>æ‰€æœ‰æœåŠ¡éƒ½éœ€è¦å‘ServiceManageræ³¨å†Œ</li>
<li>ä½†å®¢æˆ·ç«¯å¦‚ä½•è·å–ServiceManagerçš„å¥æŸ„?</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:å°†ServiceManagerçš„å¥æŸ„<strong>ç¡¬ç¼–ç ä¸º0</strong>ã€‚è¿™æ ·,æ‰€æœ‰è¿›ç¨‹éƒ½çŸ¥é“,è¦ä¸ServiceManageré€šä¿¡,åªéœ€è¦ä½¿ç”¨handle=0ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>è®¾è®¡å·§æ€</strong>: Handle 0æ˜¯Binderåè®®çš„ç‰¹æ®Šçº¦å®š,åœ¨Binderé©±åŠ¨åˆå§‹åŒ–æ—¶å°±é¢„ç•™äº†è¿™ä¸ªä½ç½®ç»™ServiceManagerã€‚è¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„å¼•å¯¼æœºåˆ¶(Bootstrap)ã€‚</p>
</blockquote>
<h3 data-id="heading-3">2. Context Manager:æˆä¸ºBinderä¸Šä¸‹æ–‡ç®¡ç†è€…</h3>
<p>ServiceManagerä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ™®é€šæœåŠ¡,å®ƒè¿˜æ˜¯<strong>Binderä¸Šä¸‹æ–‡ç®¡ç†è€…(Context Manager)</strong>ã€‚</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// main.cpp (Android 15)</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv)</span> </span>{
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* driver = argc == <span class="hljs-number">2</span> ? argv[<span class="hljs-number">1</span>] : <span class="hljs-string">"/dev/binder"</span>;

    sp&lt;ProcessState&gt; ps = ProcessState::<span class="hljs-built_in">initWithDriver</span>(driver);

    sp&lt;ServiceManager&gt; manager = sp&lt;ServiceManager&gt;::<span class="hljs-built_in">make</span>(std::<span class="hljs-built_in">make_unique</span>&lt;Access&gt;());

    <span class="hljs-comment">// å…³é”®æ­¥éª¤1:å°†è‡ªå·±è®¾ç½®ä¸ºContext Object</span>
    IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">setTheContextObject</span>(manager);

    <span class="hljs-comment">// å…³é”®æ­¥éª¤2:å‘é©±åŠ¨æ³¨å†Œä¸ºContext Manager</span>
    <span class="hljs-keyword">if</span> (!ps-&gt;<span class="hljs-built_in">becomeContextManager</span>()) {
        <span class="hljs-built_in">LOG</span>(FATAL) &lt;&lt; <span class="hljs-string">"Could not become context manager"</span>;
    }

    <span class="hljs-comment">// è¿›å…¥æ¶ˆæ¯å¾ªç¯</span>
    sp&lt;Looper&gt; looper = Looper::<span class="hljs-built_in">prepare</span>(<span class="hljs-literal">false</span>);
    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {
        looper-&gt;<span class="hljs-built_in">pollAll</span>(<span class="hljs-number">-1</span>);
    }
}
</code></pre>
<p><strong>becomeContextManager</strong>åšäº†ä»€ä¹ˆ?</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ProcessState.cpp</span>
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">ProcessState::becomeContextManager</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// é€šè¿‡ioctlå‘Šè¯‰é©±åŠ¨:"æˆ‘æ˜¯ServiceManager"</span>
    flat_binder_object obj{
        .flags = FLAT_BINDER_FLAG_ACCEPTS_FDS,
    };

    binder_write_read bwr{};
    binder_transaction_data tr{};
    tr.target.handle = <span class="hljs-number">0</span>;
    tr.code = BINDER_SET_CONTEXT_MGR;

    <span class="hljs-comment">// é©±åŠ¨ä¼šå°†handle 0ç»‘å®šåˆ°å½“å‰è¿›ç¨‹</span>
    <span class="hljs-type">int</span> result = <span class="hljs-built_in">ioctl</span>(mDriverFD, BINDER_WRITE_READ, &amp;bwr);
    <span class="hljs-keyword">return</span> result == <span class="hljs-number">0</span>;
}
</code></pre>
<p>é©±åŠ¨æ”¶åˆ°<code>BINDER_SET_CONTEXT_MGR</code>å‘½ä»¤å,ä¼š:</p>
<ol>
<li>æ£€æŸ¥è°ƒç”¨è¿›ç¨‹æ˜¯å¦æœ‰æƒé™(éœ€è¦rootæˆ–systemæƒé™)</li>
<li>å°†handle 0æ°¸ä¹…ç»‘å®šåˆ°ServiceManagerè¿›ç¨‹</li>
<li>ç¡®ä¿åªæœ‰ä¸€ä¸ªè¿›ç¨‹èƒ½æˆä¸ºContext Manager</li>
</ol>
<h3 data-id="heading-4">3. å•ä¾‹ä¸”å”¯ä¸€</h3>
<p>æ•´ä¸ªAndroidç³»ç»Ÿä¸­,<strong>åªèƒ½æœ‰ä¸€ä¸ªServiceManagerå®ä¾‹</strong>ã€‚å®ƒç”±initè¿›ç¨‹åœ¨ç³»ç»Ÿå¯åŠ¨æ—©æœŸå¯åŠ¨,å¹¶ä¸€ç›´è¿è¡Œç›´åˆ°ç³»ç»Ÿå…³é—­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># init.rcä¸­çš„ServiceManagerå¯åŠ¨é…ç½®</span>
service servicemanager /system/bin/servicemanager
    class core animation
    user system
    group system readproc
    critical
    onrestart restart apexd
    onrestart restart audioserver
    <span class="hljs-comment"># ...é‡å¯æ—¶éœ€è¦é‡å¯ä¾èµ–çš„æœåŠ¡</span>
</code></pre>
<p><strong><code>critical</code>æ ‡å¿—</strong>:ServiceManagerè¢«æ ‡è®°ä¸ºå…³é”®æœåŠ¡,å¦‚æœå®ƒå´©æºƒ,ç³»ç»Ÿä¼šè‡ªåŠ¨é‡å¯è¿›å…¥æ¢å¤æ¨¡å¼ã€‚</p>
<h2 data-id="heading-5">ServiceManageræ¶æ„æ¦‚è§ˆ</h2>
<p>åœ¨æ·±å…¥å¯åŠ¨æµç¨‹å‰,å…ˆçœ‹çœ‹ServiceManagerçš„æ•´ä½“æ¶æ„:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61c100671a6c404ebae24592d749e719~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771063041&amp;x-signature=wqscx84XXaHxVpCYh14hKofO8MY%3D" alt="10-01-servicemanager-architecture.png" loading="lazy"/></p>
<p><em>å›¾1: ServiceManageræ¶æ„ - SystemServeræ³¨å†ŒæœåŠ¡,ClientæŸ¥è¯¢æœåŠ¡,ServiceManagerç»´æŠ¤æœåŠ¡æ³¨å†Œè¡¨</em></p>
<h2 data-id="heading-6">ServiceManagerå¯åŠ¨æµç¨‹</h2>
<p>è®©æˆ‘ä»¬è·Ÿè¸ªServiceManagerä»å¯åŠ¨åˆ°å°±ç»ªçš„å®Œæ•´æµç¨‹ã€‚</p>
<h3 data-id="heading-7">1. mainå‡½æ•°:åˆå§‹åŒ–ä¸å‡†å¤‡</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// main.cpp (Android 15)</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv)</span> </span>{
    <span class="hljs-comment">// 1. åˆå§‹åŒ–æ—¥å¿—</span>
    android::base::<span class="hljs-built_in">InitLogging</span>(argv, android::base::KernelLogger);

    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* driver = argc == <span class="hljs-number">2</span> ? argv[<span class="hljs-number">1</span>] : <span class="hljs-string">"/dev/binder"</span>;

    <span class="hljs-meta">#<span class="hljs-keyword">if</span> !defined(VENDORSERVICEMANAGER)</span>
    android::<span class="hljs-built_in">register_perfetto_te_categories</span>();  <span class="hljs-comment">// Perfettoè¿½è¸ª</span>
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

    <span class="hljs-built_in">LOG</span>(INFO) &lt;&lt; <span class="hljs-string">"Starting sm instance on "</span> &lt;&lt; driver;

    <span class="hljs-comment">// 2. åˆå§‹åŒ–ProcessState</span>
    sp&lt;ProcessState&gt; ps = ProcessState::<span class="hljs-built_in">initWithDriver</span>(driver);
    ps-&gt;<span class="hljs-built_in">setThreadPoolMaxThreadCount</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// ä¸ä½¿ç”¨çº¿ç¨‹æ± ,å•çº¿ç¨‹å¤„ç†</span>
    ps-&gt;<span class="hljs-built_in">setCallRestriction</span>(ProcessState::CallRestriction::FATAL_IF_NOT_ONEWAY);

    <span class="hljs-comment">// 3. ç¦ç”¨åå°è°ƒåº¦,ç¡®ä¿é«˜ä¼˜å…ˆçº§</span>
    IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">disableBackgroundScheduling</span>(<span class="hljs-literal">true</span>);

    <span class="hljs-comment">// 4. åˆ›å»ºServiceManagerå®ä¾‹</span>
    sp&lt;ServiceManager&gt; manager = sp&lt;ServiceManager&gt;::<span class="hljs-built_in">make</span>(std::<span class="hljs-built_in">make_unique</span>&lt;Access&gt;());

    <span class="hljs-comment">// 5. è‡ªå·±ä¹Ÿè¦æ³¨å†Œä¸ºæœåŠ¡(æœåŠ¡çš„æœåŠ¡)</span>
    <span class="hljs-keyword">if</span> (!manager-&gt;<span class="hljs-built_in">addService</span>(<span class="hljs-string">"manager"</span>, manager,
                            <span class="hljs-literal">false</span> <span class="hljs-comment">/*allowIsolated*/</span>,
                            IServiceManager::DUMP_FLAG_PRIORITY_DEFAULT).<span class="hljs-built_in">isOk</span>()) {
        <span class="hljs-built_in">LOG</span>(ERROR) &lt;&lt; <span class="hljs-string">"Could not self register servicemanager"</span>;
    }

    <span class="hljs-comment">// 6. æˆä¸ºContext Manager</span>
    IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">setTheContextObject</span>(manager);
    <span class="hljs-keyword">if</span> (!ps-&gt;<span class="hljs-built_in">becomeContextManager</span>()) {
        <span class="hljs-built_in">LOG</span>(FATAL) &lt;&lt; <span class="hljs-string">"Could not become context manager"</span>;
    }

    <span class="hljs-comment">// 7. è®¾ç½®äº‹ä»¶å¾ªç¯</span>
    sp&lt;Looper&gt; looper = Looper::<span class="hljs-built_in">prepare</span>(<span class="hljs-literal">false</span>);

    sp&lt;BinderCallback&gt; binderCallback = BinderCallback::<span class="hljs-built_in">setupTo</span>(looper);
    ClientCallbackCallback::<span class="hljs-built_in">setupTo</span>(looper, manager, binderCallback);

    <span class="hljs-comment">// 8. è®¾ç½®readyå±æ€§,é€šçŸ¥å…¶ä»–è¿›ç¨‹å¯ä»¥ä½¿ç”¨äº†</span>
    <span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> VENDORSERVICEMANAGER</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">SetProperty</span>(<span class="hljs-string">"servicemanager.ready"</span>, <span class="hljs-string">"true"</span>)) {
        <span class="hljs-built_in">LOG</span>(ERROR) &lt;&lt; <span class="hljs-string">"Failed to set servicemanager ready property"</span>;
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

    <span class="hljs-comment">// 9. è¿›å…¥æ¶ˆæ¯å¾ªç¯,æ°¸ä¸é€€å‡º</span>
    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {
        looper-&gt;<span class="hljs-built_in">pollAll</span>(<span class="hljs-number">-1</span>);  <span class="hljs-comment">// é˜»å¡ç­‰å¾…Binderäº‹åŠ¡</span>
    }

    <span class="hljs-keyword">return</span> EXIT_FAILURE;  <span class="hljs-comment">// ä¸åº”è¯¥åˆ°è¾¾è¿™é‡Œ</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹è§£æ</strong>:</p>
<ol>
<li><strong>å•çº¿ç¨‹æ¨¡å¼</strong>:<code>setThreadPoolMaxThreadCount(0)</code>è¡¨ç¤ºä¸ä½¿ç”¨Binderçº¿ç¨‹æ± ,åªç”¨ä¸»çº¿ç¨‹å¤„ç†,ç®€åŒ–å¹¶å‘æ§åˆ¶</li>
<li><strong>åªæ¥å—å•å‘è°ƒç”¨</strong>:<code>FATAL_IF_NOT_ONEWAY</code>ç¡®ä¿æ‰€æœ‰å¯¹ServiceManagerçš„è°ƒç”¨éƒ½æ˜¯å¼‚æ­¥çš„,é˜²æ­¢æ­»é”</li>
<li><strong>é«˜ä¼˜å…ˆçº§</strong>:<code>disableBackgroundScheduling(true)</code>ç¡®ä¿ServiceManagerä¸ä¼šè¢«é™ä¼˜å…ˆçº§</li>
<li><strong>è‡ªæˆ‘æ³¨å†Œ</strong>:ServiceManagerä¹Ÿå°†è‡ªå·±æ³¨å†Œä¸ºåä¸º"manager"çš„æœåŠ¡,ä¾›ç‰¹æ®Šæƒ…å†µä½¿ç”¨</li>
<li><strong>Readyå±æ€§</strong>:é€šè¿‡ç³»ç»Ÿå±æ€§é€šçŸ¥å…¶ä»–ç­‰å¾…çš„è¿›ç¨‹</li>
</ol>
<h3 data-id="heading-8">2. Looperäº‹ä»¶å¾ªç¯</h3>
<p>ServiceManagerä½¿ç”¨<strong>Looper</strong>è€Œä¸æ˜¯ä¼ ç»Ÿçš„Binderçº¿ç¨‹æ± :</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// BinderCallback:å¤„ç†Binderäº‹ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BinderCallback</span> : <span class="hljs-keyword">public</span> LooperCallback {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">static</span> sp&lt;BinderCallback&gt; <span class="hljs-title">setupTo</span><span class="hljs-params">(<span class="hljs-type">const</span> sp&lt;Looper&gt;&amp; looper)</span> </span>{
        sp&lt;BinderCallback&gt; cb = sp&lt;BinderCallback&gt;::<span class="hljs-built_in">make</span>();
        cb-&gt;mLooper = looper;

        <span class="hljs-comment">// å°†Binderé©±åŠ¨çš„æ–‡ä»¶æè¿°ç¬¦åŠ å…¥Looperç›‘å¬</span>
        IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">setupPolling</span>(&amp;cb-&gt;mBinderFd);

        <span class="hljs-type">int</span> ret = looper-&gt;<span class="hljs-built_in">addFd</span>(cb-&gt;mBinderFd,
                               Looper::POLL_CALLBACK,
                               Looper::EVENT_INPUT,
                               cb, <span class="hljs-literal">nullptr</span>);
        <span class="hljs-built_in">LOG_ALWAYS_FATAL_IF</span>(ret != <span class="hljs-number">1</span>, <span class="hljs-string">"Failed to add binder FD to Looper"</span>);

        <span class="hljs-keyword">return</span> cb;
    }

    <span class="hljs-comment">// å½“Binderé©±åŠ¨æœ‰æ•°æ®æ—¶,æ­¤å‡½æ•°è¢«è°ƒç”¨</span>
    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">handleEvent</span><span class="hljs-params">(<span class="hljs-type">int</span> fd, <span class="hljs-type">int</span> events, <span class="hljs-type">void</span>* data)</span> <span class="hljs-keyword">override</span> </span>{
        IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">handlePolledCommands</span>();
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  <span class="hljs-comment">// ç»§ç»­æ¥æ”¶å›è°ƒ</span>
    }

<span class="hljs-keyword">private</span>:
    sp&lt;Looper&gt; mLooper;
    <span class="hljs-type">int</span> mBinderFd = <span class="hljs-number">-1</span>;
};
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆç”¨Looperè€Œä¸æ˜¯çº¿ç¨‹æ± ?</strong></p>
<ul>
<li><strong>ç®€å•</strong>:å•çº¿ç¨‹æ¨¡å‹,æ— éœ€è€ƒè™‘å¹¶å‘åŒæ­¥</li>
<li><strong>å¯æ§</strong>:ServiceManageréœ€è¦ç²¾ç¡®æ§åˆ¶äº‹åŠ¡å¤„ç†é¡ºåº</li>
<li><strong>é«˜æ•ˆ</strong>:é¿å…çº¿ç¨‹åˆ‡æ¢å¼€é”€</li>
<li><strong>å¯æ‰©å±•</strong>:å¯ä»¥åŒæ—¶ç›‘å¬å…¶ä»–äº‹ä»¶(å¦‚å®šæ—¶å™¨)</li>
</ul>
<h2 data-id="heading-9">æœåŠ¡æ³¨å†Œ:addServiceè¯¦è§£</h2>
<p>å½“ç³»ç»ŸæœåŠ¡(å¦‚AMS)æƒ³è¦æ³¨å†Œæ—¶,ä¼šè°ƒç”¨<code>addService</code>ã€‚è®©æˆ‘ä»¬çœ‹å®Œæ•´æµç¨‹ã€‚</p>
<h3 data-id="heading-10">1. å®¢æˆ·ç«¯è°ƒç”¨</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// SystemServer.java (Javaå±‚)</span>
ServiceManager.<span class="hljs-built_in">addService</span>(Context.ACTIVITY_SERVICE, activityManager);

<span class="hljs-comment">// æœ€ç»ˆè°ƒç”¨åˆ°Nativeå±‚</span>
<span class="hljs-comment">// IServiceManager.aidl</span>
interface IServiceManager {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addService</span><span class="hljs-params">(String name, IBinder service,
                   boolean allowIsolated, <span class="hljs-type">int</span> dumpPriority)</span></span>;
}
</code></pre>
<h3 data-id="heading-11">2. ServiceManagerå®ç°</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ServiceManager.cpp (Android 15)</span>
<span class="hljs-function">Status <span class="hljs-title">ServiceManager::addService</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name,
                                  <span class="hljs-type">const</span> sp&lt;IBinder&gt;&amp; binder,
                                  <span class="hljs-type">bool</span> allowIsolated,
                                  <span class="hljs-type">int32_t</span> dumpPriority)</span> </span>{
    <span class="hljs-built_in">SM_PERFETTO_TRACE_FUNC</span>(<span class="hljs-built_in">PERFETTO_TE_PROTO_FIELDS</span>(
            <span class="hljs-built_in">PERFETTO_TE_PROTO_FIELD_CSTR</span>(kProtoServiceName, name.<span class="hljs-built_in">c_str</span>())));

    <span class="hljs-comment">// 1. è·å–è°ƒç”¨è€…ä¸Šä¸‹æ–‡(UID/PID/SID)</span>
    <span class="hljs-keyword">auto</span> ctx = mAccess-&gt;<span class="hljs-built_in">getCallingContext</span>();

    <span class="hljs-comment">// 2. æƒé™æ£€æŸ¥:App UIDä¸èƒ½æ³¨å†ŒæœåŠ¡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">multiuser_get_app_id</span>(ctx.uid) &gt;= AID_APP) {
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_SECURITY,
                                        <span class="hljs-string">"App UIDs cannot add services."</span>);
    }

    <span class="hljs-comment">// 3. æ£€æŸ¥æ˜¯å¦æœ‰æƒé™æ³¨å†Œæ­¤æœåŠ¡</span>
    std::optional&lt;std::string&gt; accessorName;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> status = <span class="hljs-built_in">canAddService</span>(ctx, name, &amp;accessorName); !status.<span class="hljs-built_in">isOk</span>()) {
        <span class="hljs-keyword">return</span> status;
    }

    <span class="hljs-comment">// 4. åŸºæœ¬å‚æ•°æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> (binder == <span class="hljs-literal">nullptr</span>) {
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_ARGUMENT, <span class="hljs-string">"Null binder."</span>);
    }

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isValidServiceName</span>(name)) {
        <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">"%s Invalid service name: %s"</span>, ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_ARGUMENT,
                                        <span class="hljs-string">"Invalid service name."</span>);
    }

    <span class="hljs-comment">// 5. VINTFå£°æ˜æ£€æŸ¥(Android 15é‡è¦æœºåˆ¶)</span>
    <span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> VENDORSERVICEMANAGER</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">meetsDeclarationRequirements</span>(ctx, binder, name)) {
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_ARGUMENT,
                                        <span class="hljs-string">"VINTF declaration error."</span>);
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

    <span class="hljs-comment">// 6. æ£€æŸ¥dumpä¼˜å…ˆçº§æ ‡å¿—</span>
    <span class="hljs-keyword">if</span> ((dumpPriority &amp; DUMP_FLAG_PRIORITY_ALL) == <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">ALOGW</span>(<span class="hljs-string">"%s Dump flag priority is not set when adding %s"</span>,
              ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
    }

    <span class="hljs-comment">// 7. æ³¨å†Œæ­»äº¡é€šçŸ¥(å…³é”®æœºåˆ¶!)</span>
    <span class="hljs-keyword">if</span> (binder-&gt;<span class="hljs-built_in">remoteBinder</span>() != <span class="hljs-literal">nullptr</span> &amp;&amp;
        binder-&gt;<span class="hljs-built_in">linkToDeath</span>(sp&lt;ServiceManager&gt;::<span class="hljs-built_in">fromExisting</span>(<span class="hljs-keyword">this</span>)) != OK) {
        <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">"%s Could not linkToDeath when adding %s"</span>,
              ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_STATE,
                                        <span class="hljs-string">"Couldn't linkToDeath."</span>);
    }

    <span class="hljs-comment">// 8. æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨åŒåæœåŠ¡</span>
    <span class="hljs-keyword">auto</span> it = mNameToService.<span class="hljs-built_in">find</span>(name);
    <span class="hljs-type">bool</span> prevClients = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (it != mNameToService.<span class="hljs-built_in">end</span>()) {
        <span class="hljs-type">const</span> Service&amp; existing = it-&gt;second;
        prevClients = existing.hasClients;

        <span class="hljs-comment">// è­¦å‘Š:ä¸åŒUID/SIDæ³¨å†Œç›¸åŒæœåŠ¡å</span>
        <span class="hljs-keyword">if</span> (existing.ctx.uid != ctx.uid) {
            <span class="hljs-built_in">ALOGW</span>(<span class="hljs-string">"Service '%s' originally registered from UID %u "</span>
                  <span class="hljs-string">"but now from UID %u. Multiple instances?"</span>,
                  name.<span class="hljs-built_in">c_str</span>(), existing.ctx.uid, ctx.uid);
        }

        <span class="hljs-keyword">if</span> (existing.ctx.sid != ctx.sid) {
            <span class="hljs-built_in">ALOGW</span>(<span class="hljs-string">"Service '%s' originally registered from SID %s "</span>
                  <span class="hljs-string">"but now from SID %s. Multiple instances?"</span>,
                  name.<span class="hljs-built_in">c_str</span>(), existing.ctx.sid.<span class="hljs-built_in">c_str</span>(), ctx.sid.<span class="hljs-built_in">c_str</span>());
        }
    }

    <span class="hljs-comment">// 9. æ·»åŠ /æ›´æ–°æœåŠ¡åˆ°æ³¨å†Œè¡¨</span>
    mNameToService[name] = Service{
        .binder = binder,
        .allowIsolated = allowIsolated,
        .dumpPriority = dumpPriority,
        .hasClients = prevClients,
        .guaranteeClient = <span class="hljs-literal">false</span>,
        .ctx = ctx,
    };

    <span class="hljs-comment">// 10. é€šçŸ¥ç­‰å¾…æ­¤æœåŠ¡çš„å®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> it = mNameToRegistrationCallback.<span class="hljs-built_in">find</span>(name);
        it != mNameToRegistrationCallback.<span class="hljs-built_in">end</span>()) {

        mNameToService[name].guaranteeClient = <span class="hljs-literal">true</span>;
        <span class="hljs-built_in">CHECK</span>(<span class="hljs-built_in">handleServiceClientCallback</span>(<span class="hljs-number">2</span>, name, <span class="hljs-literal">false</span>));

        <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> sp&lt;IServiceCallback&gt;&amp; cb : it-&gt;second) {
            cb-&gt;<span class="hljs-built_in">onRegistration</span>(name, binder);  <span class="hljs-comment">// å›è°ƒé€šçŸ¥</span>
        }
    }

    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">ok</span>();
}
</code></pre>
<p><strong>æ ¸å¿ƒæ•°æ®ç»“æ„</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ServiceManager.h</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Service</span> {
    sp&lt;IBinder&gt; binder;           <span class="hljs-comment">// æœåŠ¡çš„Binderå¯¹è±¡</span>
    <span class="hljs-type">bool</span> allowIsolated;           <span class="hljs-comment">// æ˜¯å¦å…è®¸éš”ç¦»è¿›ç¨‹è®¿é—®</span>
    <span class="hljs-type">int32_t</span> dumpPriority;         <span class="hljs-comment">// dumpä¼˜å…ˆçº§</span>
    <span class="hljs-type">bool</span> hasClients;              <span class="hljs-comment">// æ˜¯å¦æœ‰å®¢æˆ·ç«¯</span>
    <span class="hljs-type">bool</span> guaranteeClient;         <span class="hljs-comment">// ä¿è¯æœ‰å®¢æˆ·ç«¯</span>
    Access::CallingContext ctx;   <span class="hljs-comment">// æ³¨å†Œè€…çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</span>
};

<span class="hljs-comment">// æœåŠ¡æ³¨å†Œè¡¨:æœåŠ¡å -&gt; Service</span>
std::map&lt;std::string, Service&gt; mNameToService;

<span class="hljs-comment">// æ³¨å†Œå›è°ƒè¡¨:æœåŠ¡å -&gt; å›è°ƒåˆ—è¡¨</span>
std::map&lt;std::string, std::vector&lt;sp&lt;IServiceCallback&gt;&gt;&gt; mNameToRegistrationCallback;
</code></pre>
<h3 data-id="heading-12">3. VINTFå£°æ˜éªŒè¯(Android 15å®‰å…¨æœºåˆ¶)</h3>
<p>Android 15å¼ºåŒ–äº†VINTF(Vendor Interface)å£°æ˜éªŒè¯:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">meetsDeclarationRequirements</span><span class="hljs-params">(<span class="hljs-type">const</span> Access::CallingContext&amp; ctx,
                                        <span class="hljs-type">const</span> sp&lt;IBinder&gt;&amp; binder,
                                        <span class="hljs-type">const</span> std::string&amp; name)</span> </span>{
    <span class="hljs-comment">// æ£€æŸ¥Binderæ˜¯å¦è¦æ±‚VINTFå£°æ˜</span>
    <span class="hljs-keyword">if</span> (!Stability::<span class="hljs-built_in">requiresVintfDeclaration</span>(binder)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// ä¸éœ€è¦å£°æ˜,é€šè¿‡</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨VINTF manifestä¸­å£°æ˜</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">isVintfDeclared</span>(ctx, name);
}

<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">isVintfDeclared</span><span class="hljs-params">(<span class="hljs-type">const</span> Access::CallingContext&amp; ctx,
                           <span class="hljs-type">const</span> std::string&amp; name)</span> </span>{
    <span class="hljs-comment">// è§£ææœåŠ¡å(å¦‚ android.hardware.foo.IFoo/default)</span>
    AidlName aname;
    <span class="hljs-keyword">if</span> (!AidlName::<span class="hljs-built_in">fill</span>(name, &amp;aname, <span class="hljs-literal">true</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// éå†æ‰€æœ‰manifest(device/framework)</span>
    <span class="hljs-type">bool</span> found = forEachManifest([&amp;](<span class="hljs-type">const</span> ManifestWithDescription&amp; mwd) {
        <span class="hljs-keyword">if</span> (mwd.manifest-&gt;<span class="hljs-built_in">hasAidlInstance</span>(aname.package,
                                         aname.iface,
                                         aname.instance)) {
            <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"%s Found %s in %s VINTF manifest."</span>,
                  ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(),
                  name.<span class="hljs-built_in">c_str</span>(),
                  mwd.description);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    });

    <span class="hljs-keyword">if</span> (!found) {
        <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"%s Could not find %s in the VINTF manifest."</span>,
              ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
    }

    <span class="hljs-keyword">return</span> found;
}
</code></pre>
<p><strong>VINTFçš„ä½œç”¨</strong>:</p>
<ul>
<li>æ˜ç¡®å£°æ˜HALæœåŠ¡çš„æ¥å£ç‰ˆæœ¬</li>
<li>é˜²æ­¢æœªå£°æ˜çš„æœåŠ¡æ³¨å†Œ(æé«˜å®‰å…¨æ€§)</li>
<li>æ”¯æŒè·¨ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥</li>
<li>ä¾¿äºç³»ç»Ÿå‡çº§æ—¶çš„å…¼å®¹æ€§ç®¡ç†</li>
</ul>
<h2 data-id="heading-13">æœåŠ¡æŸ¥è¯¢:getServiceè¯¦è§£</h2>
<p>å®¢æˆ·ç«¯å¦‚ä½•æŸ¥è¯¢å·²æ³¨å†Œçš„æœåŠ¡?</p>
<h3 data-id="heading-14">1. å®¢æˆ·ç«¯è°ƒç”¨</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Javaå±‚</span>
IBinder binder = ServiceManager.<span class="hljs-built_in">getService</span>(Context.ACTIVITY_SERVICE);

<span class="hljs-comment">// Nativeå±‚</span>
sp&lt;IBinder&gt; binder = <span class="hljs-built_in">defaultServiceManager</span>()-&gt;<span class="hljs-built_in">getService</span>(<span class="hljs-built_in">String16</span>(<span class="hljs-string">"activity"</span>));
</code></pre>
<h3 data-id="heading-15">2. ServiceManagerå®ç°</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ServiceManager.cpp (Android 15)</span>
<span class="hljs-function">Status <span class="hljs-title">ServiceManager::getService</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name, sp&lt;IBinder&gt;* outBinder)</span> </span>{
    <span class="hljs-built_in">SM_PERFETTO_TRACE_FUNC</span>(<span class="hljs-built_in">PERFETTO_TE_PROTO_FIELDS</span>(
            <span class="hljs-built_in">PERFETTO_TE_PROTO_FIELD_CSTR</span>(kProtoServiceName, name.<span class="hljs-built_in">c_str</span>())));

    *outBinder = <span class="hljs-built_in">tryGetBinder</span>(name, <span class="hljs-literal">true</span>);
    <span class="hljs-comment">// ä¸ºäº†å‘åå…¼å®¹,æ€»æ˜¯è¿”å›OK(å³ä½¿æœåŠ¡ä¸å­˜åœ¨)</span>
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">ok</span>();
}

<span class="hljs-function">sp&lt;IBinder&gt; <span class="hljs-title">ServiceManager::tryGetBinder</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name,
                                         <span class="hljs-type">bool</span> startIfNotFound)</span> </span>{
    <span class="hljs-keyword">auto</span> ctx = mAccess-&gt;<span class="hljs-built_in">getCallingContext</span>();

    <span class="hljs-comment">// 1. æƒé™æ£€æŸ¥:è°ƒç”¨è€…æ˜¯å¦æœ‰æƒé™è®¿é—®æ­¤æœåŠ¡</span>
    <span class="hljs-keyword">if</span> (!mAccess-&gt;<span class="hljs-built_in">canFind</span>(ctx, name)) {
        <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">"%s Cannot find %s"</span>, ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }

    <span class="hljs-comment">// 2. æŸ¥è¯¢æœåŠ¡æ³¨å†Œè¡¨</span>
    <span class="hljs-keyword">auto</span> it = mNameToService.<span class="hljs-built_in">find</span>(name);
    <span class="hljs-keyword">if</span> (it == mNameToService.<span class="hljs-built_in">end</span>()) {
        <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"%s Service %s not found"</span>, ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }

    <span class="hljs-type">const</span> Service&amp; service = it-&gt;second;

    <span class="hljs-comment">// 3. æ£€æŸ¥éš”ç¦»è¿›ç¨‹è®¿é—®æƒé™</span>
    <span class="hljs-keyword">if</span> (!service.allowIsolated &amp;&amp; <span class="hljs-built_in">is_multiuser_uid_isolated</span>(ctx.uid)) {
        <span class="hljs-built_in">ALOGW</span>(<span class="hljs-string">"%s Isolated process cannot access %s"</span>,
              ctx.<span class="hljs-built_in">toDebugString</span>().<span class="hljs-built_in">c_str</span>(), name.<span class="hljs-built_in">c_str</span>());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
    }

    <span class="hljs-comment">// 4. è®°å½•å®¢æˆ·ç«¯ä¿¡æ¯</span>
    <span class="hljs-keyword">if</span> (!service.guaranteeClient) {
        mNameToService[name].guaranteeClient = <span class="hljs-literal">true</span>;
        mNameToService[name].hasClients = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-comment">// 5. è¿”å›æœåŠ¡çš„Binderå¯¹è±¡</span>
    <span class="hljs-keyword">return</span> service.binder;
}
</code></pre>
<p><strong>checkService vs getService</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// checkService:ä»…æ£€æŸ¥æœåŠ¡æ˜¯å¦å­˜åœ¨,ä¸å¯åŠ¨</span>
<span class="hljs-function">Status <span class="hljs-title">ServiceManager::checkService</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name,
                                   os::Service* outService)</span> </span>{
    *outService = <span class="hljs-built_in">tryGetService</span>(name, <span class="hljs-literal">false</span>);  <span class="hljs-comment">// startIfNotFound = false</span>
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">ok</span>();
}

<span class="hljs-comment">// getService:å¦‚æœæœåŠ¡æ”¯æŒæ‡’å¯åŠ¨,ä¼šå°è¯•å¯åŠ¨å®ƒ</span>
<span class="hljs-function">Status <span class="hljs-title">ServiceManager::getService</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name,
                                 sp&lt;IBinder&gt;* outBinder)</span> </span>{
    *outBinder = <span class="hljs-built_in">tryGetBinder</span>(name, <span class="hljs-literal">true</span>);  <span class="hljs-comment">// startIfNotFound = true</span>
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">ok</span>();
}
</code></pre>
<h3 data-id="heading-16">3. æƒé™æ§åˆ¶:Accessç±»</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Access.cpp</span>
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Access::canFind</span><span class="hljs-params">(<span class="hljs-type">const</span> CallingContext&amp; ctx, <span class="hljs-type">const</span> std::string&amp; name)</span> </span>{
    <span class="hljs-comment">// 1. æ£€æŸ¥SELinuxä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">checkSelinuxAccess</span>(ctx, name, <span class="hljs-string">"find"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// 2. æ£€æŸ¥ç‰¹æ®ŠæœåŠ¡çš„è®¿é—®æ§åˆ¶åˆ—è¡¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isRestrictedService</span>(name)) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">isAllowedUser</span>(ctx.uid, name);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Access::canAdd</span><span class="hljs-params">(<span class="hljs-type">const</span> CallingContext&amp; ctx, <span class="hljs-type">const</span> std::string&amp; name)</span> </span>{
    <span class="hljs-comment">// åªæœ‰system/rootç”¨æˆ·å¯ä»¥æ³¨å†ŒæœåŠ¡</span>
    <span class="hljs-keyword">if</span> (ctx.uid != AID_SYSTEM &amp;&amp; ctx.uid != AID_ROOT) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// æ£€æŸ¥SELinux</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">checkSelinuxAccess</span>(ctx, name, <span class="hljs-string">"add"</span>);
}
</code></pre>
<p><strong>CallingContextç»“æ„</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">CallingContext</span> {
    <span class="hljs-type">pid_t</span> pid;          <span class="hljs-comment">// è¿›ç¨‹ID</span>
    <span class="hljs-type">uid_t</span> uid;          <span class="hljs-comment">// ç”¨æˆ·ID</span>
    std::string sid;    <span class="hljs-comment">// SELinux SID</span>
    <span class="hljs-type">int</span> debugPid;       <span class="hljs-comment">// è°ƒè¯•ç”¨PID</span>

    <span class="hljs-comment">// ä»IPCThreadStateè·å–</span>
    <span class="hljs-function"><span class="hljs-type">static</span> CallingContext <span class="hljs-title">fromBinder</span><span class="hljs-params">()</span> </span>{
        IPCThreadState* ipc = IPCThreadState::<span class="hljs-built_in">self</span>();
        <span class="hljs-keyword">return</span> CallingContext{
            .pid = ipc-&gt;<span class="hljs-built_in">getCallingPid</span>(),
            .uid = ipc-&gt;<span class="hljs-built_in">getCallingUid</span>(),
            .sid = <span class="hljs-built_in">getSeContext</span>(ipc-&gt;<span class="hljs-built_in">getCallingPid</span>()),
            .debugPid = ipc-&gt;<span class="hljs-built_in">getCallingPid</span>(),
        };
    }
};
</code></pre>
<h2 data-id="heading-17">æ­»äº¡é€šçŸ¥:DeathRecipientæœºåˆ¶</h2>
<p>å½“æœåŠ¡è¿›ç¨‹å¼‚å¸¸é€€å‡ºæ—¶,ServiceManagerå¦‚ä½•æ„ŸçŸ¥å¹¶æ¸…ç†?</p>
<h3 data-id="heading-18">1. linkToDeath:æ³¨å†Œæ­»äº¡ç›‘å¬</h3>
<p>åœ¨<code>addService</code>æ—¶,ServiceManagerä¼šæ³¨å†Œæ­»äº¡é€šçŸ¥:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// addServiceä¸­</span>
<span class="hljs-keyword">if</span> (binder-&gt;<span class="hljs-built_in">linkToDeath</span>(sp&lt;ServiceManager&gt;::<span class="hljs-built_in">fromExisting</span>(<span class="hljs-keyword">this</span>)) != OK) {
    <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">"Could not linkToDeath when adding %s"</span>, name.<span class="hljs-built_in">c_str</span>());
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_STATE,
                                    <span class="hljs-string">"Couldn't linkToDeath."</span>);
}
</code></pre>
<h3 data-id="heading-19">2. binderDied:å¤„ç†æ­»äº¡é€šçŸ¥</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ServiceManager.cpp</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ServiceManager::binderDied</span><span class="hljs-params">(<span class="hljs-type">const</span> wp&lt;IBinder&gt;&amp; who)</span> </span>{
    <span class="hljs-comment">// éå†æ‰€æœ‰æœåŠ¡,æ‰¾åˆ°æ­»äº¡çš„é‚£ä¸ª</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = mNameToService.<span class="hljs-built_in">begin</span>(); it != mNameToService.<span class="hljs-built_in">end</span>(); ) {
        <span class="hljs-keyword">if</span> (it-&gt;second.binder == who.<span class="hljs-built_in">promote</span>()) {
            <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"Service '%s' died (binder %p)"</span>,
                  it-&gt;first.<span class="hljs-built_in">c_str</span>(), who.<span class="hljs-built_in">unsafe_get</span>());

            <span class="hljs-comment">// é€šçŸ¥ç­‰å¾…çš„å®¢æˆ·ç«¯</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> cbIt = mNameToRegistrationCallback.<span class="hljs-built_in">find</span>(it-&gt;first);
                cbIt != mNameToRegistrationCallback.<span class="hljs-built_in">end</span>()) {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> sp&lt;IServiceCallback&gt;&amp; cb : cbIt-&gt;second) {
                    <span class="hljs-comment">// é€šçŸ¥æœåŠ¡å·²æ­»äº¡</span>
                    cb-&gt;<span class="hljs-built_in">onRegistration</span>(it-&gt;first, <span class="hljs-literal">nullptr</span>);
                }
            }

            <span class="hljs-comment">// ä»æ³¨å†Œè¡¨ç§»é™¤</span>
            it = mNameToService.<span class="hljs-built_in">erase</span>(it);
        } <span class="hljs-keyword">else</span> {
            ++it;
        }
    }
}
</code></pre>
<p><strong>Binderé©±åŠ¨çš„æ­»äº¡é€šçŸ¥æœºåˆ¶</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdf34b85deac439293bfce53eaa8d3c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771063041&amp;x-signature=5wqCV05HMnP2VOXuqD3k%2FC6TlRM%3D" alt="10-02-binder-death-notification.png" loading="lazy"/></p>
<h3 data-id="heading-20">3. å®¢æˆ·ç«¯æ³¨å†Œå›è°ƒ</h3>
<p>å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ç›‘å¬æœåŠ¡çš„æ³¨å†Œ/æ­»äº¡:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IServiceManager.aidl</span>
interface IServiceManager {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">registerForNotifications</span><span class="hljs-params">(String name, IServiceCallback callback)</span></span>;
}

<span class="hljs-comment">// å®¢æˆ·ç«¯ä½¿ç”¨</span>
serviceManager-&gt;<span class="hljs-built_in">registerForNotifications</span>(<span class="hljs-string">"activity"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">ServiceCallback</span>() {
    @Override
    <span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-built_in">onRegistration</span>(String name, IBinder service) {
        <span class="hljs-keyword">if</span> (service == null) {
            <span class="hljs-comment">// æœåŠ¡æ­»äº¡</span>
            Log.<span class="hljs-built_in">w</span>(TAG, <span class="hljs-string">"Service "</span> + name + <span class="hljs-string">" died!"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æœåŠ¡æ³¨å†Œ/é‡å¯</span>
            Log.<span class="hljs-built_in">i</span>(TAG, <span class="hljs-string">"Service "</span> + name + <span class="hljs-string">" registered!"</span>);
        }
    }
});
</code></pre>
<h2 data-id="heading-21">æœåŠ¡åˆ—è¡¨ä¸dump</h2>
<p>ServiceManagerè¿˜æä¾›äº†æœåŠ¡åˆ—è¡¨å’ŒdumpåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-22">1. listServices:åˆ—å‡ºæ‰€æœ‰æœåŠ¡</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">Status <span class="hljs-title">ServiceManager::listServices</span><span class="hljs-params">(<span class="hljs-type">int32_t</span> dumpPriority,
                                   std::vector&lt;std::string&gt;* outList)</span> </span>{
    <span class="hljs-comment">// æƒé™æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> (!mAccess-&gt;<span class="hljs-built_in">canList</span>(mAccess-&gt;<span class="hljs-built_in">getCallingContext</span>())) {
        <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_SECURITY,
                                        <span class="hljs-string">"Cannot list services."</span>);
    }

    <span class="hljs-comment">// æŒ‰dumpä¼˜å…ˆçº§è¿‡æ»¤</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; [name, service] : mNameToService) {
        <span class="hljs-keyword">if</span> (dumpPriority == IServiceManager::DUMP_FLAG_PRIORITY_ALL ||
            (service.dumpPriority &amp; dumpPriority) != <span class="hljs-number">0</span>) {
            outList-&gt;<span class="hljs-built_in">push_back</span>(name);
        }
    }

    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">ok</span>();
}
</code></pre>
<h3 data-id="heading-23">2. dump:å¯¼å‡ºæœåŠ¡ä¿¡æ¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šè¿‡dumpsysæŸ¥çœ‹ServiceManagerçŠ¶æ€</span>
adb shell dumpsys servicemanager

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹</span>
Registered services:
  activity: [android.app.IActivityManager]
    UID: 1000 (system)
    PID: 1234
    Clients: 15
    DumpPriority: CRITICAL|HIGH|NORMAL

  window: [android.view.IWindowManager]
    UID: 1000 (system)
    PID: 1234
    Clients: 8
    DumpPriority: CRITICAL|HIGH

Total services: 87
Active clients: 156
</code></pre>
<h2 data-id="heading-24">Android 15çš„æ–°ç‰¹æ€§</h2>
<h3 data-id="heading-25">1. Perfettoè¿½è¸ªé›†æˆ</h3>
<p>Android 15æ·±åº¦é›†æˆäº†Perfettoè¿½è¸ª:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ¯ä¸ªå…³é”®å‡½æ•°éƒ½æœ‰è¿½è¸ªå®</span>
<span class="hljs-function">Status <span class="hljs-title">ServiceManager::addService</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name, ...)</span> </span>{
    <span class="hljs-built_in">SM_PERFETTO_TRACE_FUNC</span>(<span class="hljs-built_in">PERFETTO_TE_PROTO_FIELDS</span>(
            <span class="hljs-built_in">PERFETTO_TE_PROTO_FIELD_CSTR</span>(kProtoServiceName, name.<span class="hljs-built_in">c_str</span>())));

    <span class="hljs-comment">// ... å‡½æ•°å®ç°</span>
}
</code></pre>
<p>ä½¿ç”¨Perfettoå¯ä»¥ç²¾ç¡®è¿½è¸ªServiceManagerçš„æ€§èƒ½:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠ“å–ServiceManagerçš„trace</span>
perfetto -c trace_config.pb -o trace.pb

<span class="hljs-comment"># åœ¨UIä¸­æŸ¥çœ‹serviceæ³¨å†Œ/æŸ¥è¯¢çš„è€—æ—¶</span>
</code></pre>
<h3 data-id="heading-26">2. VINTFå¼ºåˆ¶éªŒè¯</h3>
<p>Android 15å¼ºåˆ¶HALæœåŠ¡å¿…é¡»åœ¨VINTF manifestä¸­å£°æ˜:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- device/vendor/manifest.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hal</span> <span class="hljs-attr">format</span>=<span class="hljs-string">"aidl"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>android.hardware.power<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">interface</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>IPower<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">instance</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-name">instance</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">interface</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">fqname</span>&gt;</span>@1.0::IPower/default<span class="hljs-tag">&lt;/<span class="hljs-name">fqname</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hal</span>&gt;</span>
</code></pre>
<p>æœªå£°æ˜çš„æœåŠ¡å°†æ— æ³•æ³¨å†Œ:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">if</span> (!<span class="hljs-built_in">meetsDeclarationRequirements</span>(ctx, binder, name)) {
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_ILLEGAL_ARGUMENT,
                                    <span class="hljs-string">"VINTF declaration error."</span>);
}
</code></pre>
<h3 data-id="heading-27">3. Updatable APEXæ”¯æŒ</h3>
<p>æ”¯æŒé€šè¿‡APEXæ›´æ–°HALæœåŠ¡:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">static</span> std::optional&lt;std::string&gt; <span class="hljs-title">getVintfUpdatableApex</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; name)</span> </span>{
    <span class="hljs-comment">// æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¯ä»¥é€šè¿‡APEXæ›´æ–°</span>
    forEachManifest([&amp;](<span class="hljs-type">const</span> ManifestWithDescription&amp; mwd) {
        <span class="hljs-comment">// æ£€æŸ¥manifestä¸­çš„updatableViaApexå­—æ®µ</span>
        <span class="hljs-keyword">if</span> (manifestInstance.<span class="hljs-built_in">updatableViaApex</span>().<span class="hljs-built_in">has_value</span>()) {
            <span class="hljs-keyword">return</span> manifestInstance.<span class="hljs-built_in">updatableViaApex</span>().<span class="hljs-built_in">value</span>();
        }
    });
}
</code></pre>
<h3 data-id="heading-28">4. å®¢æˆ·ç«¯å›è°ƒä¼˜åŒ–</h3>
<p>Android 15ä¼˜åŒ–äº†å®¢æˆ·ç«¯å›è°ƒæœºåˆ¶,ä½¿ç”¨å®šæ—¶å™¨å®šæœŸæ£€æŸ¥:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClientCallbackCallback</span> : <span class="hljs-keyword">public</span> LooperCallback {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">static</span> sp&lt;ClientCallbackCallback&gt; <span class="hljs-title">setupTo</span><span class="hljs-params">(...)</span> </span>{
        <span class="hljs-comment">// åˆ›å»ºå®šæ—¶å™¨,æ¯5ç§’è§¦å‘ä¸€æ¬¡</span>
        <span class="hljs-type">int</span> fdTimer = <span class="hljs-built_in">timerfd_create</span>(CLOCK_MONOTONIC, <span class="hljs-number">0</span>);

        itimerspec timespec {
            .it_interval = { .tv_sec = <span class="hljs-number">5</span>, .tv_nsec = <span class="hljs-number">0</span> },
            .it_value = { .tv_sec = <span class="hljs-number">5</span>, .tv_nsec = <span class="hljs-number">0</span> },
        };

        <span class="hljs-built_in">timerfd_settime</span>(fdTimer, <span class="hljs-number">0</span>, &amp;timespec, <span class="hljs-literal">nullptr</span>);
        looper-&gt;<span class="hljs-built_in">addFd</span>(fdTimer, Looper::POLL_CALLBACK, Looper::EVENT_INPUT, cb, <span class="hljs-literal">nullptr</span>);

        <span class="hljs-keyword">return</span> cb;
    }

    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">handleEvent</span><span class="hljs-params">(<span class="hljs-type">int</span> fd, <span class="hljs-type">int</span> events, <span class="hljs-type">void</span>* data)</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-comment">// å®šæœŸå¤„ç†å®¢æˆ·ç«¯å›è°ƒ</span>
        mManager-&gt;<span class="hljs-built_in">handleClientCallbacks</span>();
        mBinderCallback-&gt;<span class="hljs-built_in">repoll</span>();  <span class="hljs-comment">// b/316829336ä¿®å¤</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
};
</code></pre>
<h2 data-id="heading-29">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-30">Q1: ä¸ºä»€ä¹ˆServiceManagerçš„handleå¿…é¡»æ˜¯0?</h3>
<p><strong>A</strong>: è¿™æ˜¯ä¸€ä¸ªå¼•å¯¼é—®é¢˜(Bootstrap Problem)ã€‚è¦è·å–ä»»ä½•æœåŠ¡,éƒ½éœ€è¦å…ˆæŸ¥è¯¢ServiceManager,ä½†è¦æŸ¥è¯¢ServiceManager,åˆéœ€è¦çŸ¥é“å®ƒçš„handleã€‚é€šè¿‡ç¡¬ç¼–ç handle=0,æ‰€æœ‰è¿›ç¨‹éƒ½çŸ¥é“å¦‚ä½•æ‰¾åˆ°ServiceManager,ä»è€Œå¯åŠ¨æ•´ä¸ªæœåŠ¡å‘ç°é“¾æ¡ã€‚</p>
<h3 data-id="heading-31">Q2: å¦‚æœServiceManagerå´©æºƒä¼šæ€æ ·?</h3>
<p><strong>A</strong>: ServiceManagerè¢«æ ‡è®°ä¸º<code>critical</code>æœåŠ¡:</p>
<ul>
<li>initä¼šç«‹å³é‡å¯ServiceManager</li>
<li>æ‰€æœ‰ä¾èµ–çš„æœåŠ¡(å¦‚audioserverã€mediaserver)ä¹Ÿä¼šé‡å¯</li>
<li>å¦‚æœé‡å¯å¤±è´¥,ç³»ç»Ÿè¿›å…¥æ¢å¤æ¨¡å¼</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># init.rc</span>
service servicemanager /system/bin/servicemanager
    critical  <span class="hljs-comment"># å´©æºƒå¯¼è‡´ç³»ç»Ÿé‡å¯</span>
    onrestart restart audioserver
    onrestart restart mediaserver
    <span class="hljs-comment"># ...</span>
</code></pre>
<h3 data-id="heading-32">Q3: Appä¸ºä»€ä¹ˆä¸èƒ½æ³¨å†Œç³»ç»ŸæœåŠ¡?</h3>
<p><strong>A</strong>: å®‰å…¨è€ƒè™‘:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// App UIDæ£€æŸ¥</span>
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">multiuser_get_app_id</span>(ctx.uid) &gt;= AID_APP) {
    <span class="hljs-keyword">return</span> Status::<span class="hljs-built_in">fromExceptionCode</span>(Status::EX_SECURITY,
                                    <span class="hljs-string">"App UIDs cannot add services."</span>);
}
</code></pre>
<p>åªæœ‰system UID(1000)æˆ–root UID(0)æ‰èƒ½æ³¨å†ŒæœåŠ¡,é˜²æ­¢Appä¼ªé€ ç³»ç»ŸæœåŠ¡ã€‚</p>
<h3 data-id="heading-33">Q4: getServiceå’ŒcheckServiceæœ‰ä»€ä¹ˆåŒºåˆ«?</h3>
<p><strong>A</strong>:</p>
<ul>
<li><strong>getService</strong>: å¦‚æœæœåŠ¡ä¸å­˜åœ¨ä½†æ”¯æŒæ‡’å¯åŠ¨,ä¼šå°è¯•å¯åŠ¨æœåŠ¡,å¯èƒ½é˜»å¡</li>
<li><strong>checkService</strong>: ä»…æ£€æŸ¥æœåŠ¡æ˜¯å¦å·²æ³¨å†Œ,ä¸ä¼šå¯åŠ¨æœåŠ¡,ä¸é˜»å¡</li>
</ul>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// éœ€è¦ç¡®ä¿æœåŠ¡å­˜åœ¨æ—¶ä½¿ç”¨getService</span>
sp&lt;IBinder&gt; binder = sm-&gt;<span class="hljs-built_in">getService</span>(<span class="hljs-built_in">String16</span>(<span class="hljs-string">"activity"</span>));

<span class="hljs-comment">// ä»…æ£€æŸ¥çŠ¶æ€æ—¶ä½¿ç”¨checkService(ä¾‹å¦‚åšUIå±•ç¤º)</span>
sp&lt;IBinder&gt; binder = sm-&gt;<span class="hljs-built_in">checkService</span>(<span class="hljs-built_in">String16</span>(<span class="hljs-string">"activity"</span>));
<span class="hljs-keyword">if</span> (binder == <span class="hljs-literal">nullptr</span>) {
    <span class="hljs-built_in">showServiceUnavailable</span>();
}
</code></pre>
<h3 data-id="heading-34">Q5: æ­»äº¡é€šçŸ¥æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„?</h3>
<p><strong>A</strong>: <strong>å¼‚æ­¥</strong>ã€‚å½“æœåŠ¡è¿›ç¨‹æ­»äº¡æ—¶:</p>
<ol>
<li>Binderé©±åŠ¨æ£€æµ‹åˆ°è¿›ç¨‹é€€å‡º</li>
<li>é©±åŠ¨å‘ServiceManagerå‘é€<code>BR_DEAD_BINDER</code>å‘½ä»¤</li>
<li>ServiceManageråœ¨ä¸‹æ¬¡å¤„ç†Binderå‘½ä»¤æ—¶è°ƒç”¨<code>binderDied()</code></li>
<li>æ¸…ç†æ˜¯å¼‚æ­¥çš„,æœ‰ä¸€å®šå»¶è¿Ÿ</li>
</ol>
<h2 data-id="heading-35">å®æˆ˜:è¿½è¸ªæœåŠ¡æ³¨å†Œ</h2>
<h3 data-id="heading-36">1. æŸ¥çœ‹å·²æ³¨å†Œçš„æœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰æœåŠ¡</span>
adb shell service list

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹</span>
Found 87 services:
0    phone: [com.android.internal.telephony.ITelephony]
1    isms: [com.android.internal.telephony.ISms]
2    activity: [android.app.IActivityManager]
3    package: [android.content.pm.IPackageManager]
...
</code></pre>
<h3 data-id="heading-37">2. dumpsysæŸ¥çœ‹æœåŠ¡è¯¦æƒ…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ServiceManagerçŠ¶æ€</span>
adb shell dumpsys servicemanager

<span class="hljs-comment"># æŸ¥çœ‹ç‰¹å®šæœåŠ¡</span>
adb shell dumpsys activity

<span class="hljs-comment"># æŸ¥çœ‹æœåŠ¡çš„å®¢æˆ·ç«¯è¿æ¥</span>
adb shell lsof | grep binder
</code></pre>
<h3 data-id="heading-38">3. ä½¿ç”¨Systraceè¿½è¸ª</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠ“å–åŒ…å«ServiceManagerçš„trace</span>
systrace.py -t 10 binder sm -o trace.html

<span class="hljs-comment"># åœ¨Chromeä¸­æ‰“å¼€trace.html,æœç´¢:</span>
<span class="hljs-comment"># - "ServiceManager::addService"</span>
<span class="hljs-comment"># - "ServiceManager::getService"</span>
</code></pre>
<h3 data-id="heading-39">4. ç›‘æ§æœåŠ¡æ³¨å†Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®æ—¶ç›‘æ§æœåŠ¡æ³¨å†Œ</span>
adb logcat | grep <span class="hljs-string">"ServiceManager"</span>

<span class="hljs-comment"># è¿‡æ»¤ç‰¹å®šæœåŠ¡</span>
adb logcat | grep <span class="hljs-string">"addService.*activity"</span>
</code></pre>
<h2 data-id="heading-40">æ€»ç»“</h2>
<p>ServiceManageræ˜¯Android Binder IPCçš„æ ¸å¿ƒæ¢çº½,æ‰¿æ‹…ç€æœåŠ¡æ³¨å†Œè¡¨çš„è§’è‰²ã€‚</p>
<p><strong>æ ¸å¿ƒæœºåˆ¶</strong>:</p>
<ul>
<li>âœ… <strong>Handle 0</strong>:ç¡¬ç¼–ç çš„å”¯ä¸€æ ‡è¯†,è§£å†³å¼•å¯¼é—®é¢˜</li>
<li>âœ… <strong>Context Manager</strong>:å‘é©±åŠ¨æ³¨å†Œä¸ºBinderä¸Šä¸‹æ–‡ç®¡ç†è€…</li>
<li>âœ… <strong>å•ä¾‹æ¨¡å¼</strong>:å…¨ç³»ç»Ÿå”¯ä¸€å®ä¾‹,ç”±initå¯åŠ¨å¹¶æ ‡è®°ä¸ºcritical</li>
<li>âœ… <strong>æœåŠ¡æ³¨å†Œè¡¨</strong>:ç»´æŠ¤nameâ†’Serviceçš„æ˜ å°„</li>
<li>âœ… <strong>æƒé™æ§åˆ¶</strong>:UID/SELinuxå¤šé‡æ£€æŸ¥</li>
<li>âœ… <strong>æ­»äº¡é€šçŸ¥</strong>:è‡ªåŠ¨æ¸…ç†å·²æ­»äº¡çš„æœåŠ¡</li>
</ul>
<p><strong>å·¥ä½œæµç¨‹</strong>:</p>
<ol>
<li><strong>å¯åŠ¨</strong>: initâ†’mainâ†’becomeContextManagerâ†’Looper</li>
<li><strong>æ³¨å†Œ</strong>: addServiceâ†’æƒé™æ£€æŸ¥â†’VINTFéªŒè¯â†’linkToDeathâ†’æ·»åŠ åˆ°map</li>
<li><strong>æŸ¥è¯¢</strong>: getServiceâ†’æƒé™æ£€æŸ¥â†’æŸ¥mapâ†’è¿”å›Binder</li>
<li><strong>æ¸…ç†</strong>: binderDiedâ†’ç§»é™¤æœåŠ¡â†’é€šçŸ¥å®¢æˆ·ç«¯</li>
</ol>
<p><strong>Android 15å¢å¼º</strong>:</p>
<ul>
<li>Perfettoæ·±åº¦é›†æˆ,æ€§èƒ½è¿½è¸ªæ›´ç²¾ç¡®</li>
<li>VINTFå¼ºåˆ¶éªŒè¯,å®‰å…¨æ€§æå‡</li>
<li>APEX updatableæ”¯æŒ,HALå¯ç‹¬ç«‹æ›´æ–°</li>
<li>å®¢æˆ·ç«¯å›è°ƒä¼˜åŒ–,å‡å°‘èµ„æºå ç”¨</li>
</ul>
<p>ç†è§£ServiceManager,ä½ å°±ç†è§£äº†AndroidæœåŠ¡æ¶æ„çš„åŸºçŸ³ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­,æˆ‘ä»¬å°†æ·±å…¥AIDLå’ŒHIDL,çœ‹çœ‹å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨BinderæœåŠ¡æ¥å£ã€‚</p>
<h3 data-id="heading-41">ç³»åˆ—æ–‡ç« </h3>
<ul>
<li><a href="https://juejin.cn/post/7602082590733025316" target="_blank" title="https://juejin.cn/post/7602082590733025316">ä¸Šä¸€ç¯‡ï¼šAndroid 15 Binderé©±åŠ¨ä¸å†…æ ¸æœºåˆ¶æ·±åº¦è§£æ</a></li>
</ul>
<hr/>
<p><em>æ¬¢è¿æ¥æˆ‘ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>æ‰¾åˆ°æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†å’Œæœ‰è¶£çš„äº§å“</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«ç¹ç XMLï¼šç”¨ mybatis-dynamic å®ç°åŠ¨æ€æ•°æ®å»ºæ¨¡]]></title>    <link>https://juejin.cn/post/7603653885601759282</link>    <guid>https://juejin.cn/post/7603653885601759282</guid>    <pubDate>2026-02-07T08:01:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601759282" data-draft-id="7603649945977241619" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«ç¹ç XMLï¼šç”¨ mybatis-dynamic å®ç°åŠ¨æ€æ•°æ®å»ºæ¨¡&#10;&#10;"/> <meta itemprop="keywords" content="MyBatis"/> <meta itemprop="datePublished" content="2026-02-07T08:01:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·959240767618"/> <meta itemprop="url" content="https://juejin.cn/user/4373206256326539"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«ç¹ç XMLï¼šç”¨ mybatis-dynamic å®ç°åŠ¨æ€æ•°æ®å»ºæ¨¡


            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4373206256326539/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·959240767618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:01:16.000Z" title="Sat Feb 07 2026 08:01:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä½œä¸º Java å¼€å‘è€…ï¼Œä½ ä¸€å®šç»å†è¿‡è¿™æ ·çš„åœºæ™¯ï¼š</p>
<ul>
<li>äº§å“è¯´"åŠ ä¸ªå­—æ®µ"ï¼Œä½ è¦æ”¹å®ä½“ç±»ã€æ”¹ Mapper XMLã€å†™ migration è„šæœ¬ã€é‡æ–°éƒ¨ç½²...</li>
<li>æƒ³å¿«é€Ÿæ­ä¸ªåŸå‹éªŒè¯æƒ³æ³•ï¼Œå´è¢« ORM é…ç½®è€—å»åŠå¤©</li>
<li>åšä½ä»£ç å¹³å°ï¼Œç”¨æˆ·è¦åŠ¨æ€å»ºè¡¨ï¼Œä¼ ç»Ÿ ORM ç›´æ¥"æŠ•é™"</li>
</ul>
<p>MyBatis çµæ´»ï¼Œä½† XML é…ç½®ç¹çï¼›JPA è‡ªåŠ¨åŒ–ï¼Œä½†ä¸å¤Ÿçµæ´»ã€‚æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ¡ˆï¼Œæ—¢èƒ½äº«å—"ä»£ç å³æ¨¡å‹"çš„ä¾¿åˆ©ï¼Œåˆä¿ç•™ MyBatis çš„çµæ´»æ€§ï¼Ÿ</p>
<p><strong>mybatis-dynamic</strong> å°±æ˜¯è¿™æ ·ä¸€ä¸ªå°è¯•â€”â€”åŸºäº MyBatis æ„å»ºçš„åŠ¨æ€ ORM æ¡†æ¶ï¼Œè®©ä½ ç”¨ Java ä»£ç å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œæ¡†æ¶è‡ªåŠ¨å¤„ç†å»ºè¡¨ã€æ”¹è¡¨ã€æŸ¥è¯¢ï¼Œç”šè‡³ç›´æ¥æš´éœ² REST APIã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€mybatis-dynamic æ˜¯ä»€ä¹ˆ</h2>
<p>mybatis-dynamic çš„æ ¸å¿ƒç†å¿µæ˜¯ <strong>"æ¨¡å‹å³çœŸç›¸"ï¼ˆModel as Truthï¼‰</strong>ï¼š</p>
<ul>
<li>ä½ ç”¨ Java ç±»å®šä¹‰æ•°æ®æ¨¡å‹</li>
<li>æ¡†æ¶è‡ªåŠ¨ç”Ÿæˆå’Œç»´æŠ¤æ•°æ®åº“è¡¨ç»“æ„</li>
<li>è¿è¡Œæ—¶å¯ä»¥åŠ¨æ€ä¿®æ”¹æ¨¡å‹</li>
<li>å†…ç½® Fluent APIï¼Œå‘Šåˆ« XML å’Œå­—ç¬¦ä¸²æ‹¼æ¥</li>
</ul>
<p>å®ƒä¸æ˜¯è¦å–ä»£ MyBatisï¼Œè€Œæ˜¯åœ¨ MyBatis ä¹‹ä¸Šæä¾›ä¸€å±‚åŠ¨æ€èƒ½åŠ›ã€‚é€‚åˆå¿«é€ŸåŸå‹ã€åŠ¨æ€ä¸šåŠ¡ã€ä½ä»£ç å¹³å°ç­‰åœºæ™¯ã€‚</p>
<p><strong>é¡¹ç›®ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">mybatis-<span class="hljs-built_in">dynamic</span>
â”œâ”€â”€ core      <span class="hljs-meta"># æ ¸å¿ƒå¼•æ“ï¼Œå¯ç‹¬ç«‹ä½¿ç”¨</span>
â”œâ”€â”€ spring    <span class="hljs-meta"># Spring Boot Starter</span>
â”œâ”€â”€ draw      <span class="hljs-meta"># å¯è§†åŒ–æ¨¡å—</span>
â””â”€â”€ sample    <span class="hljs-meta"># ç¤ºä¾‹é¡¹ç›®</span>
</code></pre>
<hr/>
<h2 data-id="heading-2">äºŒã€5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-3">2.1 æ·»åŠ ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.github.myacelw<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-dynamic-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!-- æ•°æ®åº“é©±åŠ¨ï¼Œä»¥ H2 ä¸ºä¾‹ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.h2database<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>h2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">2.2 é…ç½®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">org.h2.Driver</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:h2:./test;MODE=MySQL</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">sa</span>
    <span class="hljs-attr">password:</span>

<span class="hljs-attr">mybatis-dynamic:</span>
  <span class="hljs-attr">update-model:</span> <span class="hljs-literal">true</span>   <span class="hljs-comment"># å¯åŠ¨æ—¶è‡ªåŠ¨åŒæ­¥è¡¨ç»“æ„</span>
  <span class="hljs-attr">table-prefix:</span> <span class="hljs-string">t_</span>     <span class="hljs-comment"># è¡¨åå‰ç¼€</span>
</code></pre>
<h3 data-id="heading-5">2.3 å®šä¹‰æ¨¡å‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@FieldNameConstants</span>
<span class="hljs-meta">@Model(comment = "ç”¨æˆ·è¡¨")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {

    <span class="hljs-meta">@IdField</span>
    <span class="hljs-keyword">private</span> Integer id;

    <span class="hljs-meta">@BasicField(ddlComment = "ç”¨æˆ·å", ddlNotNull = true)</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@BasicField(ddlComment = "å¹´é¾„")</span>
    <span class="hljs-keyword">private</span> Integer age;
}
</code></pre>
<h3 data-id="heading-6">2.4 å¯ç”¨æ‰«æ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-meta">@EnableModelScan(basePackages = "com.example.demo.model")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre>
<h3 data-id="heading-7">2.5 ç›´æ¥ä½¿ç”¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> BaseService&lt;Integer, User&gt; userService;

    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">create</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span> {
        <span class="hljs-keyword">return</span> userService.insert(user);
    }

    <span class="hljs-meta">@GetMapping</span>
    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">list</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> userService.query()
                .where(c -&gt; c.gt(User.Fields.age, <span class="hljs-number">18</span>))
                .exec();
    }
}
</code></pre>
<p><strong>æ³¨æ„åˆ°äº†å—ï¼Ÿ</strong></p>
<ul>
<li>æ²¡æœ‰ Mapper XML</li>
<li>æ²¡æœ‰æ‰‹å†™ DDL</li>
<li>æ²¡æœ‰ <code>@Repository</code></li>
<li><code>BaseService</code> è‡ªåŠ¨æ³¨å…¥</li>
</ul>
<p>å¯åŠ¨åº”ç”¨ï¼Œè¡¨è‡ªåŠ¨åˆ›å»ºï¼Œæ¥å£ç›´æ¥å¯ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒç‰¹æ€§è§£æ</h2>
<h3 data-id="heading-9">3.1 åŠ¨æ€ DDLï¼šæ¨¡å‹å˜äº†ï¼Œè¡¨è·Ÿç€å˜</h3>
<p>è¿™æ˜¯ mybatis-dynamic æœ€æ ¸å¿ƒçš„èƒ½åŠ›ã€‚è®¾ç½® <code>update-model: true</code> åï¼š</p>
<ul>
<li><strong>åŠ å­—æ®µ</strong>ï¼šåœ¨ Java ç±»é‡ŒåŠ ä¸ªå±æ€§ï¼Œé‡å¯ï¼Œæ•°æ®åº“è‡ªåŠ¨åŠ åˆ—</li>
<li><strong>åŠ ç´¢å¼•</strong>ï¼šæ³¨è§£é‡ŒåŠ  <code>ddlIndex = true</code>ï¼Œé‡å¯ï¼Œç´¢å¼•è‡ªåŠ¨åˆ›å»º</li>
<li><strong>æ”¹æ³¨é‡Š</strong>ï¼šä¿®æ”¹ <code>ddlComment</code>ï¼Œé‡å¯ï¼Œå­—æ®µæ³¨é‡ŠåŒæ­¥æ›´æ–°</li>
</ul>
<p>å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼ï¼š</p>

























<table><thead><tr><th>æ“ä½œ</th><th>ä¼ ç»Ÿæ–¹å¼</th><th>mybatis-dynamic</th></tr></thead><tbody><tr><td>åŠ å­—æ®µ</td><td>æ”¹å®ä½“ â†’ å†™ migration â†’ éƒ¨ç½²</td><td>æ”¹å®ä½“ â†’ é‡å¯</td></tr><tr><td>åŠ ç´¢å¼•</td><td>å†™ DDL è„šæœ¬ â†’ æ‰‹åŠ¨æ‰§è¡Œ</td><td>åŠ æ³¨è§£ â†’ é‡å¯</td></tr><tr><td>å¼€å‘ç¯å¢ƒåŒæ­¥</td><td>Flyway/Liquibase é…ç½®</td><td>å¼€ç®±å³ç”¨</td></tr></tbody></table>
<p>å½“ç„¶ï¼Œç”Ÿäº§ç¯å¢ƒä»å»ºè®®é…åˆæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†å·¥å…·ä½¿ç”¨ï¼Œä½†å¼€å‘é˜¶æ®µçš„æ•ˆç‡æå‡æ˜¯å®æ‰“å®çš„ã€‚</p>
<h3 data-id="heading-10">3.2 Fluent Query APIï¼šå†™æŸ¥è¯¢åƒå†™è‹±è¯­</h3>
<p>å‘Šåˆ«å­—ç¬¦ä¸²æ‹¼ SQL çš„å™©æ¢¦ï¼š</p>
<pre><code class="hljs language-java" lang="java">userService.query()
    .select(<span class="hljs-string">"id"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"department.name"</span>)  <span class="hljs-comment">// è‡ªåŠ¨ JOIN</span>
    .where(c -&gt; c.eq(<span class="hljs-string">"status"</span>, <span class="hljs-number">1</span>)
                 .and(sub -&gt; sub.gt(<span class="hljs-string">"age"</span>, <span class="hljs-number">18</span>)
                                .or()
                                .eq(<span class="hljs-string">"vip"</span>, <span class="hljs-literal">true</span>)))
    .orderByDesc(<span class="hljs-string">"createdAt"</span>)
    .limit(<span class="hljs-number">10</span>)
    .exec();
</code></pre>
<p><strong>äº®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>è‡ªåŠ¨å¤„ç†ä¼˜å…ˆçº§</strong>ï¼š<code>AND</code> ä¼˜å…ˆäº <code>OR</code>ï¼Œä¸ç”¨æ‰‹åŠ¨åŠ æ‹¬å·</li>
<li><strong>è‡ªåŠ¨ JOIN</strong>ï¼šé€‰æ‹©å…³è”å­—æ®µæ—¶è‡ªåŠ¨è§¦å‘ LEFT JOIN</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šé…åˆ Lombok çš„ <code>@FieldNameConstants</code>ï¼Œå‘Šåˆ«é­”æ³•å­—ç¬¦ä¸²</li>
<li><strong>Optional æ¡ä»¶</strong>ï¼š<code>eqOptional("name", name)</code> å½“ name ä¸ºç©ºæ—¶è‡ªåŠ¨å¿½ç•¥</li>
</ul>
<h3 data-id="heading-11">3.3 å…³ç³»æ˜ å°„ï¼š@ToOne / @ToMany</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Model</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> {
    <span class="hljs-meta">@IdField</span>
    <span class="hljs-keyword">private</span> Integer id;
    
    <span class="hljs-comment">// éœ€è¦æ˜¾å¼å®šä¹‰å¤–é”®å­—æ®µ</span>
    <span class="hljs-meta">@BasicField</span>
    <span class="hljs-keyword">private</span> Integer userId;

    <span class="hljs-meta">@ToOne</span>
    <span class="hljs-keyword">private</span> User user;  <span class="hljs-comment">// è‡ªåŠ¨è¯†åˆ« userId ä½œä¸ºå¤–é”®</span>
    
    <span class="hljs-meta">@ToMany</span>
    <span class="hljs-keyword">private</span> List&lt;OrderItem&gt; items;  <span class="hljs-comment">// è‡ªåŠ¨è¯†åˆ« orderId</span>
}
</code></pre>
<p>æŸ¥è¯¢æ—¶è‡ªåŠ¨å¤„ç†å…³è”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è‡ªåŠ¨å…³è”</span>
orderService.query()
    .select(<span class="hljs-string">"id"</span>, <span class="hljs-string">"user.name"</span>, <span class="hljs-string">"items.productName"</span>)
    .exec();

<span class="hljs-comment">// æ˜¾å¼å…³è” (v0.1.1+)</span>
orderService.query()
    .joins(
        Join.inner(<span class="hljs-string">"user"</span>)
            .on(c -&gt; c.eq(<span class="hljs-string">"active"</span>, <span class="hljs-literal">true</span>))
    )
    .exec();
</code></pre>
<p>è¿˜æ”¯æŒï¼š</p>
<ul>
<li>å¤šå¯¹å¤šï¼ˆé€šè¿‡ä¸­é—´è¡¨ï¼‰</li>
<li>é€’å½’å…³ç³»ï¼ˆæ ‘å½¢ç»“æ„ï¼‰</li>
<li>è‡ªå®šä¹‰ JOIN æ¡ä»¶</li>
</ul>
<h3 data-id="heading-12">3.4 é›¶ä»£ç  REST API</h3>
<p>å¯åŠ¨å³æ‹¥æœ‰å®Œæ•´ CRUD æ¥å£ï¼š</p>





























<table><thead><tr><th>ç«¯ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET /api/dynamic/{model}</code></td><td>åˆ†é¡µæŸ¥è¯¢ï¼Œæ”¯æŒ <code>?name=John&amp;page=1&amp;size=10</code></td></tr><tr><td><code>GET /api/dynamic/{model}/{id}</code></td><td>æŒ‰ ID æŸ¥è¯¢</td></tr><tr><td><code>POST /api/dynamic/{model}</code></td><td>æ–°å¢</td></tr><tr><td><code>PUT /api/dynamic/{model}</code></td><td>æ›´æ–°</td></tr><tr><td><code>DELETE /api/dynamic/{model}/{id}</code></td><td>åˆ é™¤</td></tr></tbody></table>
<p>é€‚åˆï¼š</p>
<ul>
<li>å¿«é€ŸåŸå‹éªŒè¯</li>
<li>ç®¡ç†åå°</li>
<li>ä½ä»£ç å¹³å°åç«¯</li>
</ul>
<p>ä¸éœ€è¦å¯ä»¥å…³é—­ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">mybatis-dynamic:</span>
  <span class="hljs-attr">rest:</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span>
</code></pre>
<h3 data-id="heading-13">3.5 è¿è¡Œæ—¶åŠ¨æ€æ‰©å±•å­—æ®µ</h3>
<p>è¿™æ˜¯æ€æ‰‹çº§ç‰¹æ€§ï¼Œè®©å®ä½“å®ç° <code>ExtBean</code> æ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Model</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ExtBean</span> {
    <span class="hljs-meta">@IdField</span>
    <span class="hljs-keyword">private</span> String id;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@IgnoreField</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; ext = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">getExt</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> ext;
    }
}
</code></pre>
<p>ç„¶åå¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ å­—æ®µï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. è·å–æ¨¡å‹å®šä¹‰</span>
<span class="hljs-type">Model</span> <span class="hljs-variable">userModel</span> <span class="hljs-operator">=</span> modelService.getModelForClass(User.class);

<span class="hljs-comment">// 2. æ·»åŠ æ–°å­—æ®µ</span>
userModel.getFields().add(Field.string(<span class="hljs-string">"phone"</span>, <span class="hljs-number">100</span>));
modelService.updateAndRegister(userModel);  <span class="hljs-comment">// è‡ªåŠ¨æ‰§è¡Œ ALTER TABLE å¹¶æ³¨å†Œ</span>

<span class="hljs-comment">// 3. ä½¿ç”¨æ–°å­—æ®µ</span>
<span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
user.getExt().put(<span class="hljs-string">"phone"</span>, <span class="hljs-string">"13800138000"</span>);
userService.insert(user);

<span class="hljs-comment">// 4. æŸ¥è¯¢ä¹Ÿæ²¡é—®é¢˜</span>
List&lt;User&gt; users = userService.query()
    .where(c -&gt; c.eq(<span class="hljs-string">"phone"</span>, <span class="hljs-string">"13800138000"</span>))
    .exec();
</code></pre>
<p>è¿™å¯¹ SaaS å¤šç§Ÿæˆ·ã€åŠ¨æ€è¡¨å•ç­‰åœºæ™¯æ˜¯æ•‘å‘½ç¨»è‰ã€‚</p>
<h3 data-id="heading-14">3.6 å¯è§†åŒ–æ¨¡å‹è®¾è®¡ (Draw)</h3>
<p>ä¸ä»…æ˜¯ä»£ç ï¼Œmybatis-dynamic è¿˜å†…ç½®äº† <strong>Draw</strong> æ¨¡å—ï¼Œèƒ½å®æ—¶å°†ä½ çš„ Java æ¨¡å‹ä»£ç æ¸²æŸ“ä¸ºäº¤äº’å¼ ER å›¾ã€‚</p>
<p><strong>ä¾èµ–å¼•å…¥ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.github.myacelw<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-dynamic-draw<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å¯åŠ¨åº”ç”¨åè®¿é—® <code>/draw/index.html</code>ï¼Œå³å¯çœ‹åˆ°å½“å‰ç³»ç»Ÿçš„å…¨é‡æ•°æ®æ¨¡å‹å…³ç³»å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb54e27ca1e047c3919cdf7837fac7eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3OTU5MjQwNzY3NjE4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771056077&amp;x-signature=jV%2F8eU7nNWyi00oFd0iyKKvdSZI%3D" alt="draw-preview.png" loading="lazy"/></p>
<p>è¿™å¯¹æ¢³ç†å¤æ‚ä¸šåŠ¡å…³ç³»ã€ç”Ÿæˆè®¾è®¡æ–‡æ¡£éå¸¸æœ‰å¸®åŠ©ï¼Œä¸”å®Œå…¨æ— éœ€é¢å¤–ç»´æŠ¤ï¼Œä»£ç å³å›¾è¡¨ã€‚</p>
<h3 data-id="heading-15">3.7 ä¼ä¸šçº§æƒé™æ§åˆ¶ (Row/Column Level Security)</h3>
<p>åœ¨ B ç«¯ç³»ç»Ÿä¸­ï¼Œæ•°æ®æƒé™å¾€å¾€æ¯”åŠŸèƒ½æƒé™æ›´å¤æ‚ã€‚mybatis-dynamic å†…ç½®äº†<strong>è¡Œçº§</strong>å’Œ<strong>åˆ—çº§</strong>æƒé™æ§åˆ¶æ¥å£ï¼Œä¸”å¯¹ä¸šåŠ¡ä»£ç å®Œå…¨é€æ˜ã€‚</p>
<p>åªéœ€å®ç° <code>PermissionGetter</code> æ¥å£å¹¶æ³¨å…¥ Spring å®¹å™¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPermissionGetter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PermissionGetter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Permission <span class="hljs-title function_">getPermission</span><span class="hljs-params">(Model model)</span> {
        <span class="hljs-comment">// 1. åˆ—æƒé™ï¼šåªå…è®¸æŸ¥çœ‹éƒ¨åˆ†å­—æ®µ (e.g. éšè—æ‰‹æœºå·ã€è–ªèµ„)</span>
        List&lt;String&gt; allowedFields = Arrays.asList(<span class="hljs-string">"id"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"department"</span>);
        
        <span class="hljs-comment">// 2. è¡Œæƒé™ï¼šåªèƒ½æŸ¥çœ‹è‡ªå·±éƒ¨é—¨çš„æ•°æ®</span>
        <span class="hljs-type">Condition</span> <span class="hljs-variable">dataScope</span> <span class="hljs-operator">=</span> Condition.builder()
                .eq(<span class="hljs-string">"department_id"</span>, CurrentUser.getDeptId())
                .build();
                
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Permission</span>(allowedFields, dataScope);
    }
}
</code></pre>
<p>é…ç½®ç”Ÿæ•ˆåï¼š</p>
<ul>
<li><strong>æŸ¥è¯¢æ—¶</strong>ï¼šè‡ªåŠ¨åœ¨ SQL ä¸­æ³¨å…¥ <code>AND department_id = ?</code> æ¡ä»¶ï¼Œä¸” <code>SELECT</code> å­å¥è‡ªåŠ¨è¿‡æ»¤æœªæˆæƒå­—æ®µã€‚</li>
<li><strong>æ›´æ–°æ—¶</strong>ï¼šåŒæ ·å—è¡Œçº§æƒé™çº¦æŸï¼Œé˜²æ­¢è¶Šæƒä¿®æ”¹ã€‚</li>
<li><strong>å‰ç«¯é€‚é…</strong>ï¼šAPI è¿”å›çš„æ•°æ®ç»“æ„ä¼šè‡ªåŠ¨å‰”é™¤æ— æƒé™å­—æ®µï¼Œå‰ç«¯æ— éœ€ç‰¹æ®Šå¤„ç†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-16">å››ã€é€‚ç”¨åœºæ™¯ä¸è¾¹ç•Œ</h2>
<h3 data-id="heading-17">âœ… æ¨èåœºæ™¯</h3>
<ol>
<li><strong>å¿«é€ŸåŸå‹å¼€å‘</strong>ï¼šå‡ åˆ†é’Ÿæ­å»ºä¸€ä¸ªå¯ç”¨çš„åç«¯</li>
<li><strong>å†…éƒ¨ç®¡ç†ç³»ç»Ÿ</strong>ï¼šä¸éœ€è¦æè‡´æ€§èƒ½ï¼Œéœ€è¦å¿«é€Ÿè¿­ä»£</li>
<li><strong>ä½ä»£ç /åŠ¨æ€è¡¨å•å¹³å°</strong>ï¼šè¿è¡Œæ—¶æ‰©å±•å­—æ®µèƒ½åŠ›æ˜¯åˆšéœ€</li>
<li><strong>å¤šç§Ÿæˆ· SaaS</strong>ï¼šæ¯ä¸ªç§Ÿæˆ·å¯ä»¥æœ‰è‡ªå®šä¹‰å­—æ®µ</li>
</ol>
<h3 data-id="heading-18">âš ï¸ éœ€è¦æƒè¡¡</h3>
<ol>
<li><strong>è¶…é«˜å¹¶å‘æ ¸å¿ƒç³»ç»Ÿ</strong>ï¼šåŠ¨æ€èƒ½åŠ›æœ‰è¿è¡Œæ—¶å¼€é”€ï¼Œå»ºè®®é…åˆç¼“å­˜</li>
<li><strong>å·²æœ‰æˆç†Ÿ MyBatis é¡¹ç›®</strong>ï¼šè¿ç§»éœ€è¦è¯„ä¼°æˆæœ¬</li>
<li><strong>éœ€è¦æè‡´ SQL æ§åˆ¶</strong>ï¼šå¤æ‚æŠ¥è¡¨æŸ¥è¯¢å¯èƒ½è¿˜æ˜¯æ‰‹å†™ SQL æ›´åˆé€‚</li>
</ol>
<h3 data-id="heading-19">ä¸ MyBatis-Plus çš„å®šä½å·®å¼‚</h3>








































<table><thead><tr><th>ç»´åº¦</th><th>MyBatis-Plus</th><th>mybatis-dynamic</th></tr></thead><tbody><tr><td>å®šä½</td><td>MyBatis å¢å¼ºå·¥å…·</td><td>åŠ¨æ€ ORM æ¡†æ¶</td></tr><tr><td>åŠ¨æ€å»ºæ¨¡</td><td>âŒ</td><td>âœ…</td></tr><tr><td>è¿è¡Œæ—¶æ”¹è¡¨</td><td>âŒ</td><td>âœ…</td></tr><tr><td>é›¶ä»£ç  REST</td><td>âŒ</td><td>âœ…</td></tr><tr><td>ä»£ç ç”Ÿæˆ</td><td>âœ…ï¼ˆéœ€è¦å…ˆå»ºè¡¨ï¼‰</td><td>âŒï¼ˆä¸éœ€è¦ï¼‰</td></tr><tr><td>ç”Ÿæ€æˆç†Ÿåº¦</td><td>â­â­â­â­â­</td><td>â­â­ï¼ˆæˆé•¿ä¸­ï¼‰</td></tr></tbody></table>
<p>ä¸¤è€…ä¸æ˜¯æ›¿ä»£å…³ç³»ï¼Œè€Œæ˜¯äº’è¡¥ã€‚mybatis-dynamic é€‚åˆ"ä»ä»£ç åˆ°è¡¨"çš„åœºæ™¯ï¼ŒMyBatis-Plus é€‚åˆ"è¡¨å·²å­˜åœ¨"çš„åœºæ™¯ã€‚</p>
<hr/>
<h2 data-id="heading-20">äº”ã€æœªæ¥è§„åˆ’</h2>
<p>é¡¹ç›®è¿˜åœ¨ç§¯æè¿­ä»£ï¼Œè®¡åˆ’ä¸­çš„ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li>ğŸ”„ æä¾› Agent SKILL</li>
<li>ğŸ—„ï¸ æ›´å¤šæ•°æ®åº“æ–¹è¨€ï¼ˆç›®å‰å·²æ”¯æŒ MySQLã€PostgreSQLã€Oracleã€OceanBaseã€H2ï¼‰</li>
<li>ğŸ¨ å¯è§†åŒ–æ¨¡å‹è®¾è®¡å™¨</li>
<li>ğŸ”Œ ä¸ä¸»æµä½ä»£ç å¹³å°é›†æˆ</li>
</ul>
<hr/>
<h2 data-id="heading-21">ç»“è¯­</h2>
<p>mybatis-dynamic ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒè§£å†³çš„æ˜¯ç‰¹å®šåœºæ™¯ä¸‹çš„ç‰¹å®šç—›ç‚¹ï¼š<strong>å½“ä½ éœ€è¦æ•°æ®æ¨¡å‹å…·å¤‡åŠ¨æ€èƒ½åŠ›æ—¶ï¼Œä¼ ç»Ÿ ORM çš„åƒµåŒ–å°±æˆäº†ç»Šè„šçŸ³</strong>ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨åšéœ€è¦åŠ¨æ€æ‰©å±•çš„ç³»ç»Ÿï¼Œæˆ–è€…åŒå€¦äº†æ¯æ¬¡åŠ å­—æ®µéƒ½è¦æ”¹ä¸€å †æ–‡ä»¶ï¼Œä¸å¦¨è¯•è¯•ã€‚é¡¹ç›®å¼€æºåœ¨ GitHubï¼Œæ¬¢è¿ Starã€Issue å’Œ PRï¼š</p>
<p>ğŸ‘‰ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmyacelw%2Fmybatis-dynamic" target="_blank" title="https://github.com/myacelw/mybatis-dynamic" ref="nofollow noopener noreferrer">github.com/myacelw/mybâ€¦</a></strong></p>
<hr/>
<p><em>ä½œè€…ç®€ä»‹ï¼šåˆ˜ä¼Ÿï¼Œèµ„æ·± Java å¼€å‘è€…ï¼Œä¸“æ³¨äºä¼ä¸šçº§åº”ç”¨æ¶æ„ã€‚mybatis-dynamic é¡¹ç›®ä½œè€…ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯æ¯›ç»ç’ƒç»„ä»¶çš„ä½ç½®/å°ºå¯¸åŠ¨æ€å˜åŒ–äº§ç”Ÿçš„é—ªçƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7603563360330465322</link>    <guid>https://juejin.cn/post/7603563360330465322</guid>    <pubDate>2026-02-07T07:52:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603563360330465322" data-draft-id="7603561363572441151" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯æ¯›ç»ç’ƒç»„ä»¶çš„ä½ç½®/å°ºå¯¸åŠ¨æ€å˜åŒ–äº§ç”Ÿçš„é—ªçƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T07:52:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘æ˜æœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2928754707930126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯æ¯›ç»ç’ƒç»„ä»¶çš„ä½ç½®/å°ºå¯¸åŠ¨æ€å˜åŒ–äº§ç”Ÿçš„é—ªçƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754707930126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘æ˜æœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T07:52:46.000Z" title="Sat Feb 07 2026 07:52:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å½“ CSS <code>backdrop-filter</code> é‡ä¸ŠåŠ¨æ€å°ºå¯¸å˜åŒ–ï¼Œä¸€ä¸ªè‚‰çœ¼çœ‹ä¸è§çš„ Bug å¦‚ä½•åœ¨å½•å±æ—¶æš´éœ²æ— é—ï¼Ÿ</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>CSS <code>backdrop-filter</code> æ˜¯å®ç°æ¯›ç»ç’ƒï¼ˆFrosted Glassï¼‰æ•ˆæœçš„æ ‡å‡†æ–¹æ¡ˆï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ¨¡æ€æ¡†ã€ä¾§è¾¹æ ã€å¡ç‰‡ç­‰ UI ç»„ä»¶ä¸­ã€‚å½“æ¯›ç»ç’ƒå…ƒç´ çš„å°ºå¯¸å›ºå®šæ—¶ï¼Œä¸€åˆ‡éƒ½å¾ˆç¾å¥½ã€‚ä½†å½“ä½ éœ€è¦è®©æ¯›ç»ç’ƒèƒŒæ™¯<strong>åŠ¨æ€å˜åŒ–å°ºå¯¸</strong>ï¼ˆæ¯”å¦‚éšç€å†…å®¹é«˜åº¦è‡ªåŠ¨å¢é•¿ï¼‰ï¼Œä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜å°±ä¼šå‡ºç°ï¼š</p>
<p><strong>æ­£å¸¸ä½¿ç”¨æ—¶çœ‹ç€è¿˜è¡Œï¼Œä½†ä¸€æ—¦ç”¨å½•å±è½¯ä»¶å½•åˆ¶GIFæˆ–è§†é¢‘ï¼Œå°±ä¼šå‡ºç°æ˜æ˜¾çš„é—ªçƒã€‚</strong></p>
<p>è¿™ç¯‡æ–‡ç« å°†æ·±å…¥åˆ†æè¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œä»¥åŠå¦‚ä½•ä¼˜é›…åœ°è§£å†³å®ƒã€‚</p>
<p><strong>ç›¸å…³é¡¹ç›®ï¼š</strong></p>
<ul>
<li>åœ¨çº¿åº”ç”¨æ¼”ç¤ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fai-island.boat2moon.com%2F" target="_blank" title="https://ai-island.boat2moon.com/" ref="nofollow noopener noreferrer">AI Island Demo</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.rumuai.top%2F" target="_blank" title="https://www.rumuai.top/" ref="nofollow noopener noreferrer">RumuAI</a></li>
<li>å¼€æºä»£ç ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fboat2moon%2FRobotPrinter" target="_blank" title="https://github.com/boat2moon/RobotPrinter" ref="nofollow noopener noreferrer">GitHub - RobotPrinter</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">é—®é¢˜æè¿°</h2>
<h3 data-id="heading-2">å…¸å‹åœºæ™¯</h3>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå¸¦æ¯›ç»ç’ƒæ•ˆæœçš„å®¹å™¨ï¼Œå®ƒçš„é«˜åº¦éœ€è¦æ ¹æ®å†…å®¹åŠ¨æ€å˜åŒ–ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.glass-container</span> {
  backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
  -webkit-backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
  <span class="hljs-attribute">height</span>: auto; <span class="hljs-comment">/* æˆ–è€…é€šè¿‡ JS åŠ¨æ€è®¾ç½® */</span>
  <span class="hljs-attribute">transition</span>: height <span class="hljs-number">0.1s</span>;
}
</code></pre>
<h3 data-id="heading-3">é—®é¢˜ç°è±¡</h3>
<p>æ­£å¸¸ä½¿ç”¨æ—¶çš„æ•ˆæœï¼Œå³ä½¿åŠ¨æ€æ”¹å˜è¯¥åŒºåŸŸçš„ä½ç½®å’Œå°ºå¯¸ï¼Œè‚‰çœ¼çœ‹èµ·æ¥ä¹Ÿæ¯”è¾ƒæµç•…ï¼Œæ¯›ç»ç’ƒèƒŒæ™¯éšå†…å®¹é«˜åº¦å˜åŒ–å¹³æ»‘è¿‡æ¸¡ã€‚ä½†å½“ä½¿ç”¨ ShareXã€OBSã€Loom æˆ–å…¶ä»–å½•å±è½¯ä»¶å½•åˆ¶æ—¶ï¼Œæ¯›ç»ç’ƒåŒºåŸŸåœ¨ä½ç½®æˆ–é«˜åº¦å˜åŒ–è¿‡ç¨‹ä¸­ä¼šå‡ºç°<strong>ä¸æ€ä¹ˆè§„å¾‹çš„é—ªçƒ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31390d24271b4338a55a7d026ee4b854~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCR5piO5pyI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771055565&amp;x-signature=pSXYBB5njiEM8x0Xrfn9WsKIZNk%3D" alt="GIF1.gif" loading="lazy"/></p>
<p><strong>å…³é”®ç‰¹å¾ï¼š</strong></p>





























<table><thead><tr><th>ç‰¹å¾</th><th>æè¿°</th></tr></thead><tbody><tr><td>é—ªçƒè§„å¾‹</td><td>ä¸è§„å¾‹ï¼Œéå›ºå®šé¢‘ç‡</td></tr><tr><td>è‚‰çœ¼å¯è§æ€§</td><td>å®Œå…¨çœ‹ä¸è§ï¼ˆåˆ·æ–°ç‡å¤ªå¿«ï¼‰</td></tr><tr><td>æµè§ˆå™¨</td><td>Chromeã€Edge å‡å—å½±å“ï¼ˆChromium å†…æ ¸ï¼‰</td></tr><tr><td>è§¦å‘æ¡ä»¶</td><td>å…ƒç´ å°ºå¯¸å˜åŒ–æ—¶</td></tr><tr><td>å¯¹ç…§å®éªŒ</td><td>ç§»é™¤ <code>backdrop-filter</code> åé—®é¢˜æ¶ˆå¤±</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">æ ¹æœ¬åŸå› åˆ†æ</h2>
<h3 data-id="heading-5">backdrop-filter çš„å·¥ä½œåŸç†</h3>
<p><code>backdrop-filter</code> ä¸æ™®é€šçš„ <code>filter</code> ä¸åŒï¼Œå®ƒä¸æ˜¯å¯¹å…ƒç´ æœ¬èº«åº”ç”¨æ»¤é•œï¼Œè€Œæ˜¯å¯¹<strong>å…ƒç´ èƒŒåçš„å†…å®¹</strong>å®æ—¶é‡‡æ ·å¹¶åº”ç”¨æ»¤é•œã€‚</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é¡µé¢èƒŒæ™¯å†…å®¹             â”‚
â”‚    (æ–‡å­—ã€å›¾ç‰‡ã€å…¶ä»–å…ƒç´ )         â”‚
â”‚                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚  backdrop-<span class="hljs-attribute">filter</span>    â”‚      â”‚
â”‚    â”‚  <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>)         â”‚ â†â”€â”€ å®æ—¶é‡‡æ ·è¿™ä¸ªåŒºåŸŸèƒŒåçš„åƒç´ å¹¶æ¨¡ç³Š
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-6">å°ºå¯¸å˜åŒ–æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ</h3>
<p>å½“å¸¦æœ‰ <code>backdrop-filter</code> çš„å…ƒç´ å°ºå¯¸æ”¹å˜æ—¶ï¼Œæµè§ˆå™¨éœ€è¦ï¼š</p>
<ol>
<li><strong>é‡æ–°è®¡ç®—é‡‡æ ·åŒºåŸŸ</strong> - å…ƒç´ å˜å¤§äº†ï¼Œéœ€è¦é‡‡æ ·æ›´å¤šåƒç´ </li>
<li><strong>é‡æ–°åº”ç”¨æ¨¡ç³Šæ»¤é•œ</strong> - å¯¹æ–°çš„é‡‡æ ·åŒºåŸŸé‡æ–°è®¡ç®—æ¨¡ç³Š</li>
<li><strong>åˆæˆæ¸²æŸ“ç»“æœ</strong> - å°†æ¨¡ç³Šåçš„ç»“æœä¸å…¶ä»–å›¾å±‚åˆæˆ</li>
</ol>
<p>è¿™ä¸ªè¿‡ç¨‹ä¼šäº§ç”Ÿ<strong>ä¸­é—´çŠ¶æ€</strong>â€”â€”å¯èƒ½æ˜¯è¿˜æ²¡æ¨¡ç³Šå®Œæˆçš„å¸§ï¼Œæˆ–è€…æ˜¯å°ºå¯¸è®¡ç®—è¿˜æ²¡åŒæ­¥çš„å¸§ã€‚</p>
<h3 data-id="heading-7">ä¸ºä»€ä¹ˆè‚‰çœ¼çœ‹ä¸è§ä½†å½•å±èƒ½æ•è·</h3>
<p>ç°ä»£æ˜¾ç¤ºå™¨åˆ·æ–°ç‡é€šå¸¸æ˜¯ 60Hz æˆ–æ›´é«˜ï¼Œäººçœ¼å¾ˆéš¾æ•æ‰åˆ°æŒç»­æ—¶é—´ä»…å‡ æ¯«ç§’çš„ä¸­é—´çŠ¶æ€ã€‚ä½†å½•å±è½¯ä»¶æ˜¯<strong>é€å¸§æ•è·</strong>çš„ï¼Œå®ƒä¼šå¿ å®åœ°è®°å½•æ¯ä¸€å¸§çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬é‚£äº›è½¬ç¬å³é€çš„å¼‚å¸¸å¸§ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼š</p>
<ul>
<li>âœ… è‚‰çœ¼çœ‹ï¼šå®Œç¾æµç•…</li>
<li>âŒ å½•å±çœ‹ï¼šæ˜æ˜¾é—ªçƒ</li>
</ul>
<hr/>
<h2 data-id="heading-8">å¤±è´¥çš„å°è¯•</h2>
<p>åœ¨æ‰¾åˆ°æ­£ç¡®æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘å°è¯•äº†å¤šç§å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ³•ï¼Œä½†éƒ½å¤±è´¥äº†ã€‚è®°å½•è¿™äº›å¤±è´¥çš„å°è¯•åŒæ ·é‡è¦ã€‚</p>
<h3 data-id="heading-9">å°è¯• 1ï¼šCSS ç¡¬ä»¶åŠ é€Ÿ</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.glass-container</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateZ</span>(<span class="hljs-number">0</span>);
  <span class="hljs-attribute">will-change</span>: width, height, opacity;
  <span class="hljs-attribute">backface-visibility</span>: hidden;
}
</code></pre>
<p><strong>ç»“æœï¼šâŒ å¤±è´¥</strong> â€” ç¡¬ä»¶åŠ é€Ÿåªä¼˜åŒ–äº†åˆæˆé˜¶æ®µï¼Œä½† <code>backdrop-filter</code> çš„é‡‡æ ·å’Œæ¨¡ç³Šè®¡ç®—ä»ç„¶éœ€è¦æ‰§è¡Œã€‚</p>
<h3 data-id="heading-10">å°è¯• 2ï¼šä½¿ç”¨ requestAnimationFrame åŒæ­¥æ›´æ–°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">updateHeight</span> = height =&gt; {
  <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
    element.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.round(height)}</span>px`</span>;
  });
};

<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function"><span class="hljs-params">entries</span> =&gt;</span> {
  <span class="hljs-title function_">updateHeight</span>(entries[<span class="hljs-number">0</span>].<span class="hljs-property">contentRect</span>.<span class="hljs-property">height</span>);
});
</code></pre>
<p><strong>ç»“æœï¼šâŒ å¤±è´¥</strong> â€” rAF ç¡®ä¿äº†æ›´æ–°åœ¨æ­£ç¡®çš„æ—¶æœºå‘ç”Ÿï¼Œä½†æ— æ³•é˜»æ­¢ <code>backdrop-filter</code> æœ¬èº«çš„é‡è®¡ç®—ã€‚</p>
<h3 data-id="heading-11">å°è¯• 3ï¼šç»•è¿‡ React æ¸²æŸ“å‘¨æœŸ</h3>
<p>å¦‚æœæ˜¯ React é¡¹ç›®ï¼Œä½ å¯èƒ½ä¼šå°è¯•ç”¨ ref ç›´æ¥æ“ä½œ DOM æ¥é¿å…é‡æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç›´æ¥æ“ä½œ CSS å˜é‡ï¼Œä¸è§¦å‘ React é‡æ¸²æŸ“</span>
backdropRef.<span class="hljs-property">current</span>.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">'--height'</span>, <span class="hljs-string">`<span class="hljs-subst">${height}</span>px`</span>);
</code></pre>
<p><strong>ç»“æœï¼šâŒ å¤±è´¥</strong> â€” é—®é¢˜ä¸åœ¨ Reactï¼Œè€Œåœ¨æµè§ˆå™¨çš„æ¸²æŸ“ç®¡çº¿ã€‚</p>
<hr/>
<h2 data-id="heading-12">è§£å†³æ–¹æ¡ˆï¼šåŒå±‚è£å‰ªç»“æ„</h2>
<h3 data-id="heading-13">æ ¸å¿ƒæ€æƒ³</h3>
<p>å”‰ï¼ŒæŠ˜è…¾åŠå¤©è¿˜å¾—æ˜¯æ›²çº¿æ•‘å›½â€”â€”æ—¢ç„¶é—®é¢˜æ˜¯ <code>backdrop-filter</code> å…ƒç´ <strong>å°ºå¯¸å˜åŒ–</strong>è§¦å‘äº†æ¨¡ç³Šé‡ç®—ï¼Œé‚£è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>è®©å¸¦æœ‰ <code>backdrop-filter</code> çš„å…ƒç´ æ°¸ä¸æ”¹å˜å°ºå¯¸ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-14">å®ç°æ–¹å¼</h3>
<p>ä½¿ç”¨"å¤–å±‚è£å‰ªå®¹å™¨ + å†…å±‚å›ºå®šå°ºå¯¸"çš„åŒå±‚ç»“æ„ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å¤–å±‚ï¼šè´Ÿè´£åŠ¨æ€å°ºå¯¸ï¼Œè®¾ç½® overflow: hidden è£å‰ª --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"glass-clipper"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å†…å±‚ï¼šå›ºå®šå¤§å°ºå¯¸ï¼Œåº”ç”¨ backdrop-filter --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"glass-inner"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-15">CSS å®ç°</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å¤–å±‚è£å‰ªå®¹å™¨ */</span>
<span class="hljs-selector-class">.glass-clipper</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">var</span>(--dynamic-height, <span class="hljs-number">200px</span>); <span class="hljs-comment">/* åŠ¨æ€å˜åŒ– */</span>
  <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-comment">/* å…³é”®ï¼šè£å‰ªè¶…å‡ºéƒ¨åˆ† */</span>
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>);

  <span class="hljs-comment">/* âš ï¸ é‡è¦ï¼šä¸è¦ä½¿ç”¨ä»¥ä¸‹å±æ€§ */</span>
  <span class="hljs-comment">/* transform: translateZ(0); */</span>
  <span class="hljs-comment">/* will-change: ...; */</span>
}

<span class="hljs-comment">/* å†…å±‚æ¯›ç»ç’ƒ */</span>
<span class="hljs-selector-class">.glass-inner</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">1000px</span>; <span class="hljs-comment">/* å›ºå®šå¤§å°ºå¯¸ï¼Œè¦†ç›–æ‰€æœ‰å¯èƒ½çš„æ˜¾ç¤ºåŒºåŸŸ */</span>
  <span class="hljs-attribute">height</span>: <span class="hljs-number">1000px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* æ ¹æ®ä½ çš„å¸ƒå±€è°ƒæ•´é”šç‚¹ */</span>

  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
  backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>) <span class="hljs-built_in">saturate</span>(<span class="hljs-number">180%</span>);
  -webkit-backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>) <span class="hljs-built_in">saturate</span>(<span class="hljs-number">180%</span>);
}
</code></pre>
<h3 data-id="heading-16">å·¥ä½œåŸç†å›¾è§£</h3>
<pre><code class="hljs language-python" lang="python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å¤–å±‚å®¹å™¨ (åŠ¨æ€é«˜åº¦)            â”‚
â”‚           overflow: hidden              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                 â”‚    â”‚
â”‚  â”‚         å¯è§åŒºåŸŸ                 â”‚    â”‚  â† ç”¨æˆ·çœ‹åˆ°çš„åŒºåŸŸ
â”‚  â”‚                                 â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚   â”‚                          â”‚  â”‚    â”‚
â”‚  â”‚   â”‚    å†…å±‚ (1000x1000)      â”‚  â”‚    â”‚
â”‚  â”‚   â”‚    backdrop-<span class="hljs-built_in">filter</span>       â”‚  â”‚    â”‚
â”‚  â”‚   â”‚                          â”‚  â”‚    â”‚
â”‚  â””â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”˜    â”‚
â”‚      â”‚                          â”‚       â”‚
â”‚      â”‚   (è¢«è£å‰ªéšè—çš„éƒ¨åˆ†)      â”‚       â”‚
â”‚      â”‚                          â”‚       â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å½“é«˜åº¦å¢åŠ æ—¶ï¼š
âœ… å¤–å±‚å®¹å™¨é«˜åº¦å¢åŠ 
âœ… æ›´å¤šå†…å±‚åŒºåŸŸå˜å¾—å¯è§
âŒ å†…å±‚å°ºå¯¸ä¸å˜ â†’ backdrop-<span class="hljs-built_in">filter</span> ä¸é‡ç®—
</code></pre>
<hr/>
<h2 data-id="heading-17">é‡è¦æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-18">1. è¾¹æ¡†å¿…é¡»æ”¾åœ¨å¤–å±‚</h3>
<p>å¦‚æœæŠŠè¾¹æ¡†æ”¾åœ¨å†…å±‚ï¼Œä¼šå‡ºç°è¾¹æ¡†ä¸å®Œæ•´çš„é—®é¢˜ï¼ˆéƒ¨åˆ†è¾¹æ¡†è¢«è£æ‰ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">IMAGE_PLACEHOLDER: border-issue.png</span>]
å¤‡æ³¨ï¼šå¦‚æœè¾¹æ¡†æ”¾åœ¨å†…å±‚ï¼Œä¼šå‡ºç°ä¸Šä¸‹å·¦å³è¾¹æ¡†ä¸ä¸€è‡´çš„é—®é¢˜ã€‚
</code></pre>
<h3 data-id="heading-19">2. å¤–å±‚ä¸èƒ½ä½¿ç”¨ transform/will-change</h3>
<p>è¿™æ˜¯<strong>æœ€å®¹æ˜“è¸©çš„å‘</strong>ã€‚ä»¥ä¸‹å±æ€§ä¼šåˆ›å»ºéš”ç¦»çš„å±‚å ä¸Šä¸‹æ–‡ (Stacking Context)ï¼š</p>
<ul>
<li><code>transform: translateZ(0)</code> / <code>transform: translate3d(...)</code></li>
<li><code>will-change: transform</code> / <code>will-change: opacity</code> ç­‰</li>
<li><code>filter: ...</code></li>
<li><code>isolation: isolate</code></li>
</ul>
<p>å½“å¤–å±‚åˆ›å»ºäº†éš”ç¦»çš„å±‚å ä¸Šä¸‹æ–‡ï¼Œå†…å±‚çš„ <code>backdrop-filter</code> å°±åªèƒ½"çœ‹åˆ°"å¤–å±‚å®¹å™¨çš„èƒŒæ™¯ï¼Œè€Œçœ‹ä¸åˆ°é¡µé¢ä¸ŠçœŸæ­£çš„èƒŒæ™¯å†…å®¹ï¼Œ<strong>æ¯›ç»ç’ƒæ•ˆæœä¼šå®Œå…¨å¤±æ•ˆ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58dd3f4a90134b29b33b16107c2d3a5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCR5piO5pyI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771055565&amp;x-signature=UG6YKyRjujL3pzOzGtlIZPHc%2FWg%3D" alt="chrome_RXSOrpd2Nl.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/255f8e7a46a8416594b3ae5b0219512f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCR5piO5pyI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771055565&amp;x-signature=C%2F19%2F%2FgW9dPETiNbUZf%2BJm4NMzk%3D" alt="chrome_R0yzXsL8ZM.png" loading="lazy"/></p>
<h3 data-id="heading-20">3. å†…å±‚å°ºå¯¸è¦è¶³å¤Ÿå¤§</h3>
<p>å†…å±‚çš„å›ºå®šå°ºå¯¸éœ€è¦è¦†ç›–å¤–å±‚å¯èƒ½è¾¾åˆ°çš„æœ€å¤§å°ºå¯¸ã€‚å¦‚æœå†…å±‚å¤ªå°ï¼Œå½“å¤–å±‚æ‰©å±•è¶…è¿‡å†…å±‚æ—¶ï¼Œä¼šå‡ºç°æ¯›ç»ç’ƒè¦†ç›–ä¸å…¨çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-21">4. é”šç‚¹ä½ç½®æ ¹æ®å¸ƒå±€è°ƒæ•´</h3>
<p>ç¤ºä¾‹ä¸­ä½¿ç”¨ <code>bottom: 0; right: 0;</code> å°†å†…å±‚é”šå®šåˆ°å³ä¸‹è§’ã€‚æ ¹æ®ä½ çš„å®é™…å¸ƒå±€ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ä¸ºï¼š</p>
<ul>
<li><code>top: 0; left: 0;</code> - é”šå®šå·¦ä¸Šè§’</li>
<li><code>top: 0; right: 0;</code> - é”šå®šå³ä¸Šè§’</li>
<li>ç­‰ç­‰</li>
</ul>
<hr/>
<h2 data-id="heading-22">æœ€ç»ˆæ•ˆæœ</h2>
<h2 data-id="heading-23"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d4f6c1059bd4eaea00352f5faa8ce8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCR5piO5pyI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771055565&amp;x-signature=hhe97n0jMHEixsv1n6lzjanHbZ8%3D" alt="GIF2.gif" loading="lazy"/></h2>
<h2 data-id="heading-24">æ€»ç»“</h2>
<h3 data-id="heading-25">é—®é¢˜æœ¬è´¨</h3>





















<table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ ¹æœ¬åŸå› </strong></td><td><code>backdrop-filter</code> åœ¨å…ƒç´ å°ºå¯¸å˜åŒ–æ—¶éœ€è¦é‡æ–°é‡‡æ ·å’Œè®¡ç®—æ¨¡ç³Š</td></tr><tr><td><strong>å¯è§æ€§</strong></td><td>ä¸­é—´çŠ¶æ€æŒç»­æ—¶é—´æçŸ­ï¼Œè‚‰çœ¼ä¸å¯è§ï¼Œä½†å½•å±å¯æ•è·</td></tr><tr><td><strong>å½±å“èŒƒå›´</strong></td><td>Chromium å†…æ ¸æµè§ˆå™¨ï¼ˆChromeã€Edgeã€Opera ç­‰ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-26">è§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[å¤–å±‚å®¹å™¨ - åŠ¨æ€å°ºå¯¸, overflow:hidden]</span>
  â””â”€â”€ <span class="hljs-selector-attr">[å†…å±‚ - å›ºå®šå¤§å°ºå¯¸, backdrop-filter]</span>
</code></pre>
<h3 data-id="heading-27">è°ƒè¯• Checklist</h3>
<p>å¦‚æœä½ é‡åˆ°äº†ç±»ä¼¼é—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> <strong>ç¡®è®¤è§¦å‘æ¡ä»¶</strong>ï¼šä¸´æ—¶ç§»é™¤ <code>backdrop-filter</code>ï¼Œé—ªçƒæ˜¯å¦æ¶ˆå¤±ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> <strong>æ£€æŸ¥å°ºå¯¸å˜åŒ–</strong>ï¼šå…ƒç´ å°ºå¯¸æ˜¯å¦åœ¨åŠ¨æ€å˜åŒ–ï¼Ÿå¦‚æœå›ºå®šï¼Œå¯èƒ½æ˜¯å…¶ä»–é—®é¢˜</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> <strong>æ£€æŸ¥å±‚å ä¸Šä¸‹æ–‡</strong>ï¼šå¤–å±‚æ˜¯å¦æœ‰ <code>transform</code>ã€<code>will-change</code>ã€<code>filter</code> ç­‰å±æ€§ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> <strong>å°è¯•åŒå±‚ç»“æ„</strong>ï¼šä½¿ç”¨æœ¬æ–‡çš„å¤–å±‚è£å‰ª + å†…å±‚å›ºå®šæ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-28">é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>âœ… é«˜åº¦/å®½åº¦åŠ¨æ€å˜åŒ–çš„æ¯›ç»ç’ƒå®¹å™¨</li>
<li>âœ… å†…å®¹é©±åŠ¨å°ºå¯¸çš„å¯¹è¯æ¡†ã€ä¾§è¾¹æ </li>
<li>âœ… å¸¦ <code>backdrop-filter</code> çš„å¯æŠ˜å /å±•å¼€ç»„ä»¶</li>
<li>âŒ å›ºå®šå°ºå¯¸å’Œä½ç½®çš„æ¯›ç»ç’ƒå…ƒç´ ï¼ˆä¸éœ€è¦æ­¤æ–¹æ¡ˆï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-29">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2Fbackdrop-filter" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter" ref="nofollow noopener noreferrer">MDN - backdrop-filter</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcsstriggers.com%2F" target="_blank" title="https://csstriggers.com/" ref="nofollow noopener noreferrer">CSS Triggers - å“ªäº› CSS å±æ€§ä¼šè§¦å‘ layout/paint/composite</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2FCSS_positioned_layout%2FUnderstanding_z-index%2FStacking_context" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_positioned_layout/Understanding_z-index/Stacking_context" ref="nofollow noopener noreferrer">Understanding CSS Stacking Context</a></li>
</ul>
<hr/>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿åˆ†äº«ç»™å…¶ä»–å¼€å‘è€…ï¼Œä¸€èµ·é¿å‘ï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»åˆ›æ„åˆ°è§†è§‰ï¼šåŸºäº302.aiæ‰“é€ æ™ºèƒ½Logoç”Ÿæˆå™¨]]></title>    <link>https://juejin.cn/post/7603653885601792050</link>    <guid>https://juejin.cn/post/7603653885601792050</guid>    <pubDate>2026-02-07T08:15:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601792050" data-draft-id="7603595309232750602" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" ä»åˆ›æ„åˆ°è§†è§‰ï¼šåŸºäº302.aiæ‰“é€ æ™ºèƒ½Logoç”Ÿæˆå™¨"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T08:15:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Leeå·"/> <meta itemprop="url" content="https://juejin.cn/user/2402874087453658"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             ä»åˆ›æ„åˆ°è§†è§‰ï¼šåŸºäº302.aiæ‰“é€ æ™ºèƒ½Logoç”Ÿæˆå™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2402874087453658/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Leeå·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:15:59.000Z" title="Sat Feb 07 2026 08:15:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»åˆ›æ„åˆ°è§†è§‰ï¼šåŸºäº302.aiæ‰“é€ æ™ºèƒ½Logoç”Ÿæˆå™¨</h2>
<p>åœ¨AIæµªæ½®å¸­å·è®¾è®¡é¢†åŸŸçš„ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ç­‰å¾…è®¾è®¡å¸ˆæ•°æ—¥çš„æ„æ€ä¸ä¿®æ”¹ã€‚å€ŸåŠ©å¤§è¯­è¨€æ¨¡å‹å’Œå›¾åƒç”ŸæˆæŠ€æœ¯ï¼Œä¸€ä¸ªç®€å•çš„è¡¨å•å°±èƒ½å°†æŠ½è±¡çš„æè¿°ç¬é—´è½¬åŒ–ä¸ºç²¾ç¾çš„è§†è§‰æ ‡è¯†ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æä¸€ä¸ªåŸºäº302.aiå›¾åƒç”ŸæˆAPIçš„æ™ºèƒ½Logoç”Ÿæˆå™¨é¡¹ç›®ï¼Œæ¢è®¨å…¶ä»å‰ç«¯äº¤äº’åˆ°AIè°ƒç”¨çš„å®Œæ•´æŠ€æœ¯é“¾æ¡ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®æ„æ€ï¼šå½“ç»å…¸è¡¨å•é‡è§AIé­”æ³•</h3>
<p>è¯¥é¡¹ç›®å·§å¦™åœ°å°†ä¼ ç»Ÿçš„Webè¡¨å•ä¸å‰æ²¿çš„AIGCæŠ€æœ¯ç›¸ç»“åˆã€‚æ ¸å¿ƒé€»è¾‘æä¸ºæ¸…æ™°ï¼šç”¨æˆ·åªéœ€è¾“å…¥åº”ç”¨åç§°å’Œæè¿°ï¼Œç³»ç»Ÿä¾¿è‡ªåŠ¨æ„é€ ä¸“ä¸šçš„å›¾åƒç”ŸæˆæŒ‡ä»¤ï¼Œè°ƒç”¨å¤§æ¨¡å‹APIï¼Œå¹¶å°†ç”Ÿæˆçš„é«˜è´¨é‡Logoå®æ—¶å‘ˆç°åœ¨é¡µé¢ä¸Šã€‚è¿™ç§â€œæè¿°å³æ‰€å¾—â€çš„äº¤äº’æ¨¡å¼ï¼Œæå¤§åœ°é™ä½äº†ä¸“ä¸šè®¾è®¡çš„é—¨æ§›ã€‚</p>
<h3 data-id="heading-2">äºŒã€å‰ç«¯æ¶æ„ï¼šBootstrapæ„å»ºçš„åšå›ºéª¨æ¶</h3>
<p>é¡¹ç›®é‡‡ç”¨äº†ç»å…¸çš„Bootstrap 3æ¡†æ¶æ„å»ºç”¨æˆ·ç•Œé¢ï¼Œç¡®ä¿äº†å“åº”å¼å¸ƒå±€å’Œç®€æ´çš„è§†è§‰é£æ ¼ã€‚<code>index.html</code>æ–‡ä»¶çš„ç»“æ„æ¸…æ™°åœ°ä½“ç°äº†è¿™ä¸€ç‚¹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-6"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- è¡¨å•åŒºåŸŸ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"logo"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å›¾ç‰‡åŠ¨æ€æ’å…¥åŒºåŸŸ --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œï¼Œ<code>.container</code>ç±»å®ç°äº†é¡µé¢å†…å®¹çš„å±…ä¸­å¸ƒå±€ï¼Œ<code>.row</code>å’Œ<code>.col-md-6</code>æ„å»ºäº†æ …æ ¼ç³»ç»Ÿï¼Œå°†è¡¨å•é™åˆ¶åœ¨é€‚ä¸­çš„å®½åº¦ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„æ˜¯é¢„ç•™çš„<code>&lt;div id="logo"&gt;</code>ï¼Œå®ƒä½œä¸ºå›¾ç‰‡çš„åŠ¨æ€â€œç”»å¸ƒâ€ï¼Œç­‰å¾…JavaScriptå°†AIçš„åˆ›ä½œæˆæœâ€œæŒ‚è½½â€äºæ­¤ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€è¡¨å•è‰ºæœ¯ï¼šHTML5çš„ä¼˜é›…å®è·µ</h3>
<p>è¡¨å•æ˜¯ç”¨æˆ·ä¸AIäº¤äº’çš„ç›´æ¥æ¡¥æ¢ï¼Œæœ¬é¡¹ç›®çš„è¡¨å•è®¾è®¡å……åˆ†è¿ç”¨äº†HTML5çš„ç‰¹æ€§æ¥æå‡ç”¨æˆ·ä½“éªŒä¸æ•°æ®å¯é æ€§ã€‚</p>
<p><strong>1. è¯­ä¹‰åŒ–ä¸å¯è®¿é—®æ€§</strong></p>
<p>é€šè¿‡<code>&lt;label&gt;</code>æ ‡ç­¾çš„<code>for</code>å±æ€§ä¸<code>&lt;input&gt;</code>çš„<code>id</code>ç²¾ç¡®å…³è”ï¼Œå®ç°äº†ç‚¹å‡»æ ‡ç­¾æ–‡å­—å³å¯èšç„¦è¾“å…¥æ¡†çš„åŠŸèƒ½ï¼Œè¿™ä¸ä»…æ˜¯è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒè®¾è®¡ï¼Œæ›´æ˜¯å¯¹å±å¹•é˜…è¯»å™¨ç­‰è¾…åŠ©æŠ€æœ¯çš„å‹å¥½æ”¯æŒã€‚</p>
<p><strong>2. å³æ—¶å¼•å¯¼ä¸æ•°æ®éªŒè¯</strong></p>
<p><code>placeholder</code>å±æ€§åœ¨è¾“å…¥æ¡†å†…æä¾›æ¸©å’Œçš„æç¤ºï¼Œå¼•å¯¼ç”¨æˆ·è¾“å…¥æ­£ç¡®æ ¼å¼çš„å†…å®¹ã€‚<code>required</code>å±æ€§åˆ™ä¸ºâ€œåº”ç”¨åç§°â€å­—æ®µåŠ ä¸Šäº†æµè§ˆå™¨åŸç”Ÿçš„éç©ºéªŒè¯ï¼Œåœ¨æ•°æ®æäº¤è‡³æœåŠ¡å™¨å‰å®Œæˆç¬¬ä¸€é“è´¨é‡å…³å¡ã€‚</p>
<p><strong>3. ç»“æ„åŒ–æ ·å¼</strong></p>
<p>Bootstrapçš„<code>.form-group</code>ç±»å°†æ¯ä¸ªæ ‡ç­¾å’Œå…¶å¯¹åº”çš„è¡¨å•æ§ä»¶åŒ…è£…æˆä¸€ä¸ªè§†è§‰å•å…ƒï¼Œå¹¶è‡ªåŠ¨æä¾›åˆé€‚çš„å‚ç›´é—´è·ï¼Œä½¿å¾—è¡¨å•ç»“æ„æ¸…æ™°ã€å±‚æ¬¡åˆ†æ˜ã€‚</p>
<h3 data-id="heading-4">å››ã€æ ¸å¿ƒé€»è¾‘ï¼šJavaScripté©±åŠ¨AIä¹‹ç¬”</h3>
<p>é¡¹ç›®çš„çµé­‚åœ¨äº<code>&lt;script&gt;</code>æ ‡ç­¾å†…çš„JavaScriptä»£ç ã€‚å®ƒå¦‚åŒä¸€ä½å†·é™çš„æŒ‡æŒ¥å®¶ï¼Œç²¾å‡†åœ°è°ƒåº¦ç€ç”¨æˆ·è¾“å…¥ã€AIæ¥å£å’Œé¡µé¢æ¸²æŸ“ã€‚</p>
<p><strong>1. é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œæ¥ç®¡æµç¨‹</strong></p>
<p>è¡¨å•çš„é»˜è®¤æäº¤è¡Œä¸ºä¼šå¯¼è‡´é¡µé¢è·³è½¬ï¼Œè¿™æ˜¾ç„¶ä¸é€‚åˆéœ€è¦åŸåœ°å±•ç¤ºå›¾ç‰‡çš„AIåº”ç”¨ã€‚å› æ­¤ï¼Œä»£ç åœ¨è¡¨å•çš„<code>submit</code>äº‹ä»¶ç›‘å¬å™¨ä¸­ï¼Œé¦–å½“å…¶å†²åœ°è°ƒç”¨äº†<code>event.preventDefault()</code>ï¼Œæœæ–­â€œåŠ«æŒâ€äº†è¡¨å•çš„åŸå§‹æäº¤æµç¨‹ï¼Œä¸ºåç»­çš„å¼‚æ­¥AIè°ƒç”¨é“ºå¹³é“è·¯ã€‚</p>
<p><strong>2. åŠ¨æ€æ„é€ â€œé­”æ³•æŒ‡ä»¤â€ï¼ˆPrompt Engineeringï¼‰</strong></p>
<p>AIç»˜ç”»çš„è´¨é‡æå¤§ç¨‹åº¦ä¸Šå–å†³äºæç¤ºè¯ï¼ˆPromptï¼‰çš„ä¼˜åŠ£ã€‚æœ¬é¡¹ç›®æ²¡æœ‰ä½¿ç”¨å›ºå®šæç¤ºè¯ï¼Œè€Œæ˜¯é‡‡ç”¨äº†å·§å¦™çš„<strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong>æŠ€æœ¯ï¼Œå°†ç”¨æˆ·è¾“å…¥åŠ¨æ€ç¼–ç»‡æˆä¸“ä¸šçš„æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> prompt = <span class="hljs-string">`
ä½ æ˜¯ä¸€ä¸ªäº’è”ç½‘å¤§å‚çš„è®¾è®¡å¸ˆï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªç§»åŠ¨åº”ç”¨çš„logoã€‚
åº”ç”¨åç§°ä¸º<span class="hljs-subst">${appName}</span>,
æè¿°ä¸º<span class="hljs-subst">${appDesc}</span>ã€‚
è®¾è®¡ä¸€ä¸ªé«˜ç«¯ã€å¤§æ°”ã€ä¸Šæ¡£æ¬¡çš„logoã€‚
è¯·ç¡®ä¿è®¾è®¡æ–¹æ¡ˆé€‚ç”¨äºç§»åŠ¨åº”ç”¨å›¾æ ‡ (App Icon)ã€‚
`</span>
</code></pre>
<p>è¿™æ®µä»£ç å ªç§°â€œç‚¹ç›ä¹‹ç¬”â€ã€‚å®ƒé€šè¿‡åå¼•å·ï¼ˆ<code>ï¼‰å®šä¹‰çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå°†å˜é‡</code>appName<code>å’Œ</code>appDesc`æ— ç¼åµŒå…¥åˆ°ä¸€æ®µé¢„è®¾çš„è§’è‰²æŒ‡ä»¤ä¸­ã€‚è¿™ä¸ä»…ä»…æ˜¯å°†å…³é”®è¯æ‰”ç»™AIï¼Œæ›´æ˜¯ä¸ºAIè®¾å®šäº†ä¸€ä¸ªæ˜ç¡®çš„èº«ä»½ï¼ˆäº’è”ç½‘å¤§å‚è®¾è®¡å¸ˆï¼‰å’Œå…·ä½“çš„ä»»åŠ¡ç›®æ ‡ï¼ˆè®¾è®¡é€‚ç”¨äºApp Iconçš„é«˜ç«¯Logoï¼‰ï¼Œæå¤§åœ°æå‡äº†è¾“å‡ºç»“æœçš„ä¸“ä¸šæ€§å’Œå¯ç”¨æ€§ã€‚</p>
<p><strong>3. ä¸AIæ¡æ‰‹ï¼šFetch APIçš„ç°ä»£åº”ç”¨</strong></p>
<p>ä¸302.aiæœåŠ¡çš„é€šä¿¡ï¼Œä½¿ç”¨äº†ç°ä»£ã€å¼ºå¤§çš„Fetch APIï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">fetch</span>(<span class="hljs-string">'https://api.302.ai/v1/images/generations'</span>, {
    method: <span class="hljs-string">'POST'</span>,
    headers: {
        <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer sk-...'</span>, <span class="hljs-comment">// APIå¯†é’¥</span>
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    body: JSON.<span class="hljs-built_in">stringify</span>({
        model: <span class="hljs-string">"dall-e-3"</span>, <span class="hljs-comment">// æŒ‡å®šä½¿ç”¨DALL-E 3æ¨¡å‹</span>
        prompt,           <span class="hljs-comment">// ä¼ å…¥æ„é€ å¥½çš„æç¤ºè¯</span>
        n: <span class="hljs-number">1</span>,             <span class="hljs-comment">// ç”Ÿæˆ1å¼ å›¾ç‰‡</span>
        size: <span class="hljs-string">"1024x1024"</span> <span class="hljs-comment">// å›¾ç‰‡åˆ†è¾¨ç‡</span>
    })
})
</code></pre>
<p>è¿™æ®µä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†ä¸AIGC APIäº¤äº’çš„æ ‡å‡†èŒƒå¼ï¼šæŒ‡å®šç«¯ç‚¹ã€ä½¿ç”¨POSTæ–¹æ³•ã€åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦èº«ä»½éªŒè¯çš„<code>Authorization</code>å­—æ®µå’Œå£°æ˜æ•°æ®æ ¼å¼çš„<code>Content-Type</code>ï¼Œæœ€åå°†åŒ…å«æ¨¡å‹å‚æ•°å’Œæ ¸å¿ƒæç¤ºè¯çš„é…ç½®åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²æ”¾å…¥è¯·æ±‚ä½“ã€‚</p>
<p><strong>4. å¼‚æ­¥äº¤å“ï¼šPromiseé“¾å¤„ç†å“åº”</strong></p>
<p>Fetch APIè¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œä»£ç é€šè¿‡<code>.then()</code>é“¾å¼è°ƒç”¨æ¥ä¼˜é›…åœ°å¤„ç†å¼‚æ­¥å“åº”ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">.then(<span class="hljs-attr">response</span> =&gt; response.json())
.then(<span class="hljs-attr">data</span> =&gt; {
    console.log(data)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">img</span> = document.createElement(<span class="hljs-string">'img'</span>)<span class="hljs-comment">;</span>
    <span class="hljs-attr">img.src</span> = data.data[<span class="hljs-number">0</span>].url<span class="hljs-comment">;</span>
    <span class="hljs-attr">img.onload</span> = function() {
      document.getElementById('logo').appendChild(img)<span class="hljs-comment">;</span>
    }
})
.catch((error) =&gt; {
    console.error('Error:', error)<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<p>ç¬¬ä¸€ä¸ª<code>.then(response =&gt; response.json())</code>è´Ÿè´£å°†åŸå§‹çš„HTTPå“åº”æµè§£æä¸ºJavaScriptå¯¹è±¡ã€‚ç¬¬äºŒä¸ª<code>.then()</code>åˆ™å¤„ç†è§£æåçš„æ•°æ®ï¼šé¦–å…ˆå°†å®Œæ•´çš„å“åº”æ•°æ®<code>console.log</code>è¾“å‡ºï¼Œè¿™å¯¹äºè°ƒè¯•è‡³å…³é‡è¦ï¼›ç„¶åï¼Œå®ƒä»å“åº”ç»“æ„<code>data.data[0].url</code>ä¸­æå–å‡ºå›¾ç‰‡çš„URLåœ°å€ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå…³é”®çš„æŠ€æœ¯ç»†èŠ‚ï¼šå®ƒåœ¨åˆ›å»º<code>&lt;img&gt;</code>å…ƒç´ å¹¶è®¾ç½®<code>src</code>å±æ€§åï¼Œ<strong>å¹¶æœªç«‹å³å°†å…¶æ’å…¥DOM</strong>ï¼Œè€Œæ˜¯<strong>ç­‰å¾…<code>onload</code>äº‹ä»¶è§¦å‘</strong>ã€‚è¿™ç¡®ä¿äº†åªåœ¨å›¾ç‰‡å®Œå…¨åŠ è½½æˆåŠŸåï¼Œæ‰æ‰§è¡Œ<code>appendChild</code>æ“ä½œï¼Œé¿å…äº†å› å›¾ç‰‡åŠ è½½ç¼“æ…¢æˆ–å¤±è´¥å¯¼è‡´çš„é¡µé¢å¸ƒå±€é—®é¢˜æˆ–æ˜¾ç¤ºä¸å…¨ï¼Œä½“ç°äº†å¥å£®çš„ç¼–ç¨‹æ€æƒ³ã€‚æœ€åçš„<code>.catch()</code>åˆ™ç»Ÿä¸€æ•è·å¹¶å¤„ç†æ•´ä¸ªæµç¨‹ä¸­å¯èƒ½å‡ºç°çš„ä»»ä½•ç½‘ç»œæˆ–é€»è¾‘é”™è¯¯ã€‚</p>
<h3 data-id="heading-5">äº”ã€æ€è€ƒä¸å‰ç»</h3>
<p>è¿™ä¸ªé¡¹ç›®è™½ç„¶ä½“é‡ä¸å¤§ï¼Œå´å®Œæ•´åœ°æ¼”ç¤ºäº†å°†AIGCèƒ½åŠ›äº§å“åŒ–çš„æ ¸å¿ƒè·¯å¾„ï¼š<strong>å‹å¥½çš„å‰ç«¯äº¤äº’ -&gt; ç²¾å¿ƒæ„é€ çš„æŒ‡ä»¤å·¥ç¨‹ -&gt; ç¨³å®šçš„APIè°ƒç”¨ -&gt; æµç•…çš„ç»“æœå‘ˆç°</strong>ã€‚å®ƒä¸ä»…æ˜¯è°ƒç”¨ä¸€ä¸ªAPIï¼Œæ›´æ˜¯ä¸€æ¬¡å®Œæ•´çš„äººæœºååŒåˆ›ä½œä½“éªŒã€‚</p>
<p>å±•æœ›æœªæ¥ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ æ›´å¤šå¢å¼ºåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šè®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„è®¾è®¡é£æ ¼ï¼ˆæç®€ã€å¡é€šã€3Dç­‰ï¼‰ã€æä¾›å¤šç§å®½é«˜æ¯”é€‰é¡¹ã€æ·»åŠ å†å²è®°å½•åŠŸèƒ½ï¼Œç”šè‡³é›†æˆæ›´å¤æ‚çš„å›¾åƒç¼–è¾‘èƒ½åŠ›ã€‚æœ¬é¡¹ç›®å·²ç»æˆåŠŸæ­å»ºäº†ä»æ–‡å­—æè¿°åˆ°è§†è§‰äº§å‡ºçš„â€œç¬¬ä¸€åº§æ¡¥æ¢â€ï¼Œä¸ºæ¢ç´¢AIåœ¨åˆ›æ„é¢†åŸŸçš„æ— é™å¯èƒ½æ‰“å¼€äº†ä¸€æ‰‡æ˜äº®çš„æŠ€æœ¯ä¹‹çª—ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[homebrew]brew services list(è¯¦è§£)]]></title>    <link>https://juejin.cn/post/7603591775392415771</link>    <guid>https://juejin.cn/post/7603591775392415771</guid>    <pubDate>2026-02-07T05:43:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603591775392415771" data-draft-id="7603567912593211419" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[homebrew]brew services list(è¯¦è§£)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T05:43:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="import_random"/> <meta itemprop="url" content="https://juejin.cn/user/2013961033882312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [homebrew]brew services list(è¯¦è§£)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961033882312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    import_random
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T05:43:29.000Z" title="Sat Feb 07 2026 05:43:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>brew services list</code> çš„ä½œç”¨å°±æ˜¯<strong>åˆ—å‡ºæ‰€æœ‰é€šè¿‡ Homebrew å®‰è£…, å¹¶ä¸”å¯ç”± Homebrew Services ç®¡ç†çš„æœåŠ¡çŠ¶æ€</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">è¯¦ç»†ä½œç”¨è¯´æ˜ï¼š</h2>
<ol>
<li>
<p><strong>åˆ—å‡ºæ‰€æœ‰ç›¸å…³æœåŠ¡</strong>ï¼š</p>
<ul>
<li>æ˜¾ç¤ºé€šè¿‡ <code>brew install</code> å®‰è£…çš„ã€æ”¯æŒæœåŠ¡ç®¡ç†çš„è½¯ä»¶åŒ…</li>
<li>åŒ…æ‹¬æ­£åœ¨è¿è¡Œçš„å’Œå·²åœæ­¢çš„æœåŠ¡</li>
</ul>
</li>
<li>
<p><strong>æ˜¾ç¤ºå…³é”®ä¿¡æ¯</strong>ï¼š</p>
<ul>
<li><strong>æœåŠ¡åç§°</strong>ï¼ˆNameï¼‰ï¼šè½¯ä»¶åŒ…åç§°ï¼Œå¦‚ nginxã€mysqlã€redis ç­‰</li>
<li><strong>è¿è¡ŒçŠ¶æ€</strong>ï¼ˆStatusï¼‰ï¼š
<ul>
<li><code>started</code> - æœåŠ¡æ­£åœ¨è¿è¡Œ</li>
<li><code>stopped</code> - æœåŠ¡å·²åœæ­¢</li>
<li><code>error</code> - æœåŠ¡å¯åŠ¨å‡ºé”™</li>
<li><code>none</code> - ä»æœªå¯åŠ¨è¿‡</li>
</ul>
</li>
<li><strong>å¯åŠ¨ç”¨æˆ·</strong>ï¼ˆUserï¼‰ï¼šæœåŠ¡ä»¥å“ªä¸ªç”¨æˆ·èº«ä»½è¿è¡Œ</li>
<li><strong>å¯åŠ¨é…ç½®æ–‡ä»¶</strong>ï¼ˆPlistï¼‰ï¼šæœåŠ¡çš„ launchctl plist æ–‡ä»¶è·¯å¾„</li>
</ul>
</li>
<li>
<p><strong>åŒºåˆ†å¯åŠ¨çº§åˆ«</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ plist æ–‡ä»¶è·¯å¾„å¯ä»¥åŒºåˆ†ï¼š
<ul>
<li><code>/Library/LaunchDaemons/</code> - ç³»ç»Ÿçº§å¯åŠ¨ï¼ˆå¼€æœºè‡ªå¯ï¼Œéœ€ç®¡ç†å‘˜æƒé™ï¼‰</li>
<li><code>~/Library/LaunchAgents/</code> - ç”¨æˆ·çº§å¯åŠ¨ï¼ˆç™»å½•åå¯åŠ¨ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 data-id="heading-1">ç¤ºä¾‹è¾“å‡ºï¼š</h2>
<pre><code class="hljs language-bash" lang="bash">$ brew services list
Name    Status  User   Plist
nginx   started root   /Library/LaunchDaemons/homebrew.mxcl.nginx.plist
mysql   stopped
redis   started alice  /Users/alice/Library/LaunchAgents/homebrew.mxcl.redis.plist
postgresql error
</code></pre>
<h2 data-id="heading-2">ç›¸å…³å¸¸ç”¨å‘½ä»¤ï¼š</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
brew services start &lt;æœåŠ¡å&gt;

<span class="hljs-comment"># åœæ­¢æœåŠ¡</span>
brew services stop &lt;æœåŠ¡å&gt;

<span class="hljs-comment"># é‡å¯æœåŠ¡</span>
brew services restart &lt;æœåŠ¡å&gt;

<span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰æœåŠ¡çš„çŠ¶æ€</span>
brew services list 

<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤å¸®åŠ©</span>
brew services --<span class="hljs-built_in">help</span>
</code></pre>
<h2 data-id="heading-3">æ³¨æ„äº‹é¡¹ï¼š</h2>
<ul>
<li>åªæœ‰é€šè¿‡ Homebrew å®‰è£…ä¸”æ”¯æŒæœåŠ¡ç®¡ç†çš„è½¯ä»¶æ‰ä¼šæ˜¾ç¤º</li>
<li>ç›´æ¥é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå¦‚æ‰‹åŠ¨å¯åŠ¨ï¼‰è¿è¡Œçš„æœåŠ¡ä¸ä¼šå‡ºç°åœ¨æ­¤åˆ—è¡¨ä¸­</li>
<li>è¿™æ˜¯ç®¡ç† macOS ä¸Š Homebrew æœåŠ¡çš„æ ‡å‡†æ–¹å¼ï¼Œåº•å±‚ä½¿ç”¨ macOS çš„ <code>launchctl</code> ç³»ç»Ÿ</li>
</ul>
<p>è¿™ä¸ªå‘½ä»¤ç‰¹åˆ«é€‚åˆç®¡ç†å¼€å‘ç¯å¢ƒä¸­å¸¸ç”¨çš„æ•°æ®åº“ã€Web æœåŠ¡å™¨ã€ç¼“å­˜ç­‰æœåŠ¡ï¼Œè®©ä½ ä¸€ç›®äº†ç„¶åœ°æŒæ¡æ‰€æœ‰æœåŠ¡çš„çŠ¶æ€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šjinja2 - å¼ºå¤§çµæ´»çš„Pythonæ¨¡æ¿å¼•æ“]]></title>    <link>https://juejin.cn/post/7603627478020358154</link>    <guid>https://juejin.cn/post/7603627478020358154</guid>    <pubDate>2026-02-07T06:19:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603627478020358154" data-draft-id="7603595309232488458" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šjinja2 - å¼ºå¤§çµæ´»çš„Pythonæ¨¡æ¿å¼•æ“"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-02-07T06:19:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2579909358396288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šjinja2 - å¼ºå¤§çµæ´»çš„Pythonæ¨¡æ¿å¼•æ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2579909358396288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T06:19:48.000Z" title="Sat Feb 07 2026 06:19:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">jinja2 - å¼ºå¤§çµæ´»çš„Pythonæ¨¡æ¿å¼•æ“</h2>
<h3 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯jinja2ï¼Ÿ</h3>
<p><strong>jinja2</strong> æ˜¯ä¸€ä¸ªç”¨äºç”ŸæˆåŠ¨æ€å†…å®¹çš„ Python åº“ã€‚
å®ƒå¯ä»¥å¸®åŠ©ä½ ï¼š</p>
<ul>
<li><strong>åˆ†ç¦»é€»è¾‘ä¸è§†å›¾</strong>: å°† Python ä»£ç å’Œ HTMLï¼ˆæˆ–å…¶ä»–æ–‡æœ¬ï¼‰ç»“æ„åˆ†ç¦»ï¼Œä½¿ä»£ç æ›´æ•´æ´ï¼Œè§†å›¾æ›´æ˜“ç»´æŠ¤ã€‚</li>
<li><strong>å¿«é€Ÿç”Ÿæˆå„ç§æ–‡æœ¬</strong>: ä¸ä»…é™äºHTMLï¼Œè¿˜å¯ä»¥ç”ŸæˆXMLã€CSSã€JavaScriptã€é…ç½®æ–‡ä»¶ç­‰ä»»ä½•åŸºäºæ–‡æœ¬çš„å†…å®¹ã€‚</li>
<li><strong>æ”¯æŒå¤æ‚çš„æ¨¡æ¿ç»“æ„</strong>: æä¾›å¾ªç¯ã€æ¡ä»¶è¯­å¥ã€å®ã€ç»§æ‰¿ç­‰é«˜çº§åŠŸèƒ½ï¼Œè®©æ¨¡æ¿ç¼–å†™æ›´çµæ´»é«˜æ•ˆã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€åº”ç”¨åœºæ™¯</h3>
<p><strong>jinja2</strong> å¹¿æ³›åº”ç”¨äºä»¥ä¸‹å®é™…åœºæ™¯ï¼š</p>
<ul>
<li><strong>Webå¼€å‘</strong>: ç»“åˆFlaskã€Sanicç­‰Python Webæ¡†æ¶ï¼Œæ¸²æŸ“HTMLé¡µé¢ï¼Œå±•ç¤ºåŠ¨æ€æ•°æ®ã€‚</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>: æ ¹æ®æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆé‡å¤æ€§é«˜çš„ä»£ç æ–‡ä»¶ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</li>
<li><strong>é…ç½®ç®¡ç†</strong>: åŸºäºå˜é‡å’Œæ¨¡æ¿ï¼Œç”Ÿæˆå¤æ‚çš„é…ç½®æ–‡ä»¶ï¼Œå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚</li>
<li><strong>ç”µå­é‚®ä»¶æ¨¡æ¿</strong>: æ‰¹é‡ç”Ÿæˆä¸ªæ€§åŒ–çš„HTMLæˆ–çº¯æ–‡æœ¬é‚®ä»¶å†…å®¹ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€å¦‚ä½•å®‰è£…</h3>
<ol>
<li>ä½¿ç”¨ pip å®‰è£…</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">pip install jinja2

<span class="hljs-comment"># å¦‚æœå®‰è£…æ…¢çš„è¯ï¼Œæ¨èä½¿ç”¨å›½å†…é•œåƒæº</span>
pip install jinja2 -i https://www.python64.cn/pypi/simple/
</code></pre>
<ol start="2">
<li>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F" target="_blank" title="https://www.min2k.com/tools/python-run/" ref="nofollow noopener noreferrer">PythonRun</a> åœ¨çº¿è¿è¡Œä»£ç ï¼ˆæ— éœ€æœ¬åœ°å®‰è£…ï¼‰</li>
</ol>
<h3 data-id="heading-4">å››ã€ç¤ºä¾‹ä»£ç </h3>
<p>æ ¹æ®ç”¨æˆ·è§’è‰²ç”Ÿæˆä¸ªæ€§åŒ–æ¬¢è¿ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template

<span class="hljs-comment"># å‡è®¾æœ‰ä¸€äº›ç”¨æˆ·æ•°æ®</span>
user_data = {
    <span class="hljs-string">'name'</span>: <span class="hljs-string">'Alice'</span>,
    <span class="hljs-string">'is_admin'</span>: <span class="hljs-literal">True</span>,
    <span class="hljs-string">'points'</span>: <span class="hljs-number">150</span>
}

<span class="hljs-comment"># å®šä¹‰ä¸€ä¸ª Jinja2 æ¨¡æ¿å­—ç¬¦ä¸²</span>
template_string = <span class="hljs-string">"""
{% if user.is_admin %}
Hello, Admin {{ user.name }}! You have special access.
{% elif user.points &gt; 100 %}
Welcome back, {{ user.name }}! You are a valued member.
{% else %}
Hello, {{ user.name }}. Please explore our features.
{% endif %}
Your current points: {{ user.points }}
"""</span>

<span class="hljs-comment"># åˆ›å»ºæ¨¡æ¿å¯¹è±¡</span>
template = Template(template_string)

<span class="hljs-comment"># æ¸²æŸ“æ¨¡æ¿ï¼Œä¼ å…¥ç”¨æˆ·æ•°æ®</span>
rendered_output = template.render(user=user_data)

<span class="hljs-comment"># æ‰“å°æ¸²æŸ“ç»“æœ</span>
<span class="hljs-built_in">print</span>(rendered_output)

<span class="hljs-comment"># å°è¯•ä¸€ä¸ªæ™®é€šç”¨æˆ·</span>
user_data_standard = {
    <span class="hljs-string">'name'</span>: <span class="hljs-string">'Bob'</span>,
    <span class="hljs-string">'is_admin'</span>: <span class="hljs-literal">False</span>,
    <span class="hljs-string">'points'</span>: <span class="hljs-number">75</span>
}
rendered_output_standard = template.render(user=user_data_standard)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- Standard User ---"</span>)
<span class="hljs-built_in">print</span>(rendered_output_standard)

<span class="hljs-comment"># å°è¯•ä¸€ä¸ªé«˜ç§¯åˆ†ç”¨æˆ·</span>
user_data_valued = {
    <span class="hljs-string">'name'</span>: <span class="hljs-string">'Charlie'</span>,
    <span class="hljs-string">'is_admin'</span>: <span class="hljs-literal">False</span>,
    <span class="hljs-string">'points'</span>: <span class="hljs-number">120</span>
}
rendered_output_valued = template.render(user=user_data_valued)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n--- Valued User ---"</span>)
<span class="hljs-built_in">print</span>(rendered_output_valued)
</code></pre>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F%3Fcode%3Dfrom%2520jinja2%2520import%2520Template%250A%250A%2523%2520%25E5%2581%2587%25E8%25AE%25BE%25E6%259C%2589%25E4%25B8%2580%25E4%25BA%259B%25E7%2594%25A8%25E6%2588%25B7%25E6%2595%25B0%25E6%258D%25AE%250Auser_data%2520%253D%2520%257B%250A%2520%2520%2520%2520'name'%253A%2520'Alice'%252C%250A%2520%2520%2520%2520'is_admin'%253A%2520True%252C%250A%2520%2520%2520%2520'points'%253A%2520150%250A%257D%250A%250A%2523%2520%25E5%25AE%259A%25E4%25B9%2589%25E4%25B8%2580%25E4%25B8%25AA%2520Jinja2%2520%25E6%25A8%25A1%25E6%259D%25BF%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%250Atemplate_string%2520%253D%2520%2522%2522%2522%250A%257B%2525%2520if%2520user.is_admin%2520%2525%257D%250AHello%252C%2520Admin%2520%257B%257B%2520user.name%2520%257D%257D!%2520You%2520have%2520special%2520access.%250A%257B%2525%2520elif%2520user.points%2520%253E%2520100%2520%2525%257D%250AWelcome%2520back%252C%2520%257B%257B%2520user.name%2520%257D%257D!%2520You%2520are%2520a%2520valued%2520member.%250A%257B%2525%2520else%2520%2525%257D%250AHello%252C%2520%257B%257B%2520user.name%2520%257D%257D.%2520Please%2520explore%2520our%2520features.%250A%257B%2525%2520endif%2520%2525%257D%250AYour%2520current%2520points%253A%2520%257B%257B%2520user.points%2520%257D%257D%250A%2522%2522%2522%250A%250A%2523%2520%25E5%2588%259B%25E5%25BB%25BA%25E6%25A8%25A1%25E6%259D%25BF%25E5%25AF%25B9%25E8%25B1%25A1%250Atemplate%2520%253D%2520Template%2528template_string%2529%250A%250A%2523%2520%25E6%25B8%25B2%25E6%259F%2593%25E6%25A8%25A1%25E6%259D%25BF%25EF%25BC%258C%25E4%25BC%25A0%25E5%2585%25A5%25E7%2594%25A8%25E6%2588%25B7%25E6%2595%25B0%25E6%258D%25AE%250Arendered_output%2520%253D%2520template.render%2528user%253Duser_data%2529%250A%250A%2523%2520%25E6%2589%2593%25E5%258D%25B0%25E6%25B8%25B2%25E6%259F%2593%25E7%25BB%2593%25E6%259E%259C%250Aprint%2528rendered_output%2529%250A%250A%2523%2520%25E5%25B0%259D%25E8%25AF%2595%25E4%25B8%2580%25E4%25B8%25AA%25E6%2599%25AE%25E9%2580%259A%25E7%2594%25A8%25E6%2588%25B7%250Auser_data_standard%2520%253D%2520%257B%250A%2520%2520%2520%2520'name'%253A%2520'Bob'%252C%250A%2520%2520%2520%2520'is_admin'%253A%2520False%252C%250A%2520%2520%2520%2520'points'%253A%252075%250A%257D%250Arendered_output_standard%2520%253D%2520template.render%2528user%253Duser_data_standard%2529%250Aprint%2528%2522%255Cn---%2520Standard%2520User%2520---%2522%2529%250Aprint%2528rendered_output_standard%2529%250A%250A%2523%2520%25E5%25B0%259D%25E8%25AF%2595%25E4%25B8%2580%25E4%25B8%25AA%25E9%25AB%2598%25E7%25A7%25AF%25E5%2588%2586%25E7%2594%25A8%25E6%2588%25B7%250Auser_data_valued%2520%253D%2520%257B%250A%2520%2520%2520%2520'name'%253A%2520'Charlie'%252C%250A%2520%2520%2520%2520'is_admin'%253A%2520False%252C%250A%2520%2520%2520%2520'points'%253A%2520120%250A%257D%250Arendered_output_valued%2520%253D%2520template.render%2528user%253Duser_data_valued%2529%250Aprint%2528%2522%255Cn---%2520Valued%2520User%2520---%2522%2529%250Aprint%2528rendered_output_valued%2529" target="_blank" title="https://www.min2k.com/tools/python-run/?code=from%20jinja2%20import%20Template%0A%0A%23%20%E5%81%87%E8%AE%BE%E6%9C%89%E4%B8%80%E4%BA%9B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%0Auser_data%20%3D%20%7B%0A%20%20%20%20'name'%3A%20'Alice'%2C%0A%20%20%20%20'is_admin'%3A%20True%2C%0A%20%20%20%20'points'%3A%20150%0A%7D%0A%0A%23%20%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%20Jinja2%20%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%0Atemplate_string%20%3D%20%22%22%22%0A%7B%25%20if%20user.is_admin%20%25%7D%0AHello%2C%20Admin%20%7B%7B%20user.name%20%7D%7D!%20You%20have%20special%20access.%0A%7B%25%20elif%20user.points%20%3E%20100%20%25%7D%0AWelcome%20back%2C%20%7B%7B%20user.name%20%7D%7D!%20You%20are%20a%20valued%20member.%0A%7B%25%20else%20%25%7D%0AHello%2C%20%7B%7B%20user.name%20%7D%7D.%20Please%20explore%20our%20features.%0A%7B%25%20endif%20%25%7D%0AYour%20current%20points%3A%20%7B%7B%20user.points%20%7D%7D%0A%22%22%22%0A%0A%23%20%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF%E5%AF%B9%E8%B1%A1%0Atemplate%20%3D%20Template%28template_string%29%0A%0A%23%20%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%EF%BC%8C%E4%BC%A0%E5%85%A5%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%0Arendered_output%20%3D%20template.render%28user%3Duser_data%29%0A%0A%23%20%E6%89%93%E5%8D%B0%E6%B8%B2%E6%9F%93%E7%BB%93%E6%9E%9C%0Aprint%28rendered_output%29%0A%0A%23%20%E5%B0%9D%E8%AF%95%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%0Auser_data_standard%20%3D%20%7B%0A%20%20%20%20'name'%3A%20'Bob'%2C%0A%20%20%20%20'is_admin'%3A%20False%2C%0A%20%20%20%20'points'%3A%2075%0A%7D%0Arendered_output_standard%20%3D%20template.render%28user%3Duser_data_standard%29%0Aprint%28%22%5Cn---%20Standard%20User%20---%22%29%0Aprint%28rendered_output_standard%29%0A%0A%23%20%E5%B0%9D%E8%AF%95%E4%B8%80%E4%B8%AA%E9%AB%98%E7%A7%AF%E5%88%86%E7%94%A8%E6%88%B7%0Auser_data_valued%20%3D%20%7B%0A%20%20%20%20'name'%3A%20'Charlie'%2C%0A%20%20%20%20'is_admin'%3A%20False%2C%0A%20%20%20%20'points'%3A%20120%0A%7D%0Arendered_output_valued%20%3D%20template.render%28user%3Duser_data_valued%29%0Aprint%28%22%5Cn---%20Valued%20User%20---%22%29%0Aprint%28rendered_output_valued%29" ref="nofollow noopener noreferrer">PythonRun</a> åœ¨çº¿è¿è¡Œè¿™æ®µä»£ç ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">Hello, Admin Alice! You have special access.

Your current points: 150

--- Standard User ---


Hello, Bob. Please explore our features.

Your current points: 75

--- Valued User ---


Welcome back, Charlie! You are a valued member.

Your current points: 120
</code></pre>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fmermaid%2F%3Fcode%3Dflowchart%2520TD%250A%2520%2520A%255B%25E5%25BC%2580%25E5%25A7%258B%255D%2520--%253E%2520B%257B%25E5%2588%259B%25E5%25BB%25BA%25E7%2594%25A8%25E6%2588%25B7%25E6%2595%25B0%25E6%258D%25AE%257D%253B%250A%2520%2520B%2520--%253E%2520C%257B%25E5%25AE%259A%25E4%25B9%2589Jinja2%25E6%25A8%25A1%25E6%259D%25BF%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%257D%253B%250A%2520%2520C%2520--%253E%2520D%255B%25E5%2588%259B%25E5%25BB%25BATemplate%25E5%25AF%25B9%25E8%25B1%25A1%255D%253B%250A%2520%2520D%2520--%253E%2520E%257B%25E4%25BC%25A0%25E5%2585%25A5%25E7%2594%25A8%25E6%2588%25B7%25E6%2595%25B0%25E6%258D%25AE%25E5%25B9%25B6%25E6%25B8%25B2%25E6%259F%2593%25E6%25A8%25A1%25E6%259D%25BF%257D%253B%250A%2520%2520E%2520--%253E%2520F%257B%25E6%2589%2593%25E5%258D%25B0%25E6%25B8%25B2%25E6%259F%2593%25E7%25BB%2593%25E6%259E%259C%257D%253B%250A%2520%2520F%2520--%253E%2520G%257B%25E5%2588%25A4%25E6%2596%25AD%25E7%2594%25A8%25E6%2588%25B7%25E6%2598%25AF%25E5%2590%25A6%25E4%25B8%25BA%25E7%25AE%25A1%25E7%2590%2586%25E5%2591%2598%253F%257D%253B%250A%2520%2520G%2520--%2520%25E6%2598%25AF%2520--%253E%2520H%255B%25E7%2594%259F%25E6%2588%2590%25E7%25AE%25A1%25E7%2590%2586%25E5%2591%2598%25E6%25AC%25A2%25E8%25BF%258E%25E8%25AF%25AD%255D%253B%250A%2520%2520G%2520--%2520%25E5%2590%25A6%2520--%253E%2520I%257B%25E7%2594%25A8%25E6%2588%25B7%25E7%25A7%25AF%25E5%2588%2586%25E6%2598%25AF%25E5%2590%25A6%25E5%25A4%25A7%25E4%25BA%258E100%253F%257D%253B%250A%2520%2520I%2520--%2520%25E6%2598%25AF%2520--%253E%2520J%255B%25E7%2594%259F%25E6%2588%2590%25E9%25AB%2598%25E7%25A7%25AF%25E5%2588%2586%25E4%25BC%259A%25E5%2591%2598%25E6%25AC%25A2%25E8%25BF%258E%25E8%25AF%25AD%255D%253B%250A%2520%2520I%2520--%2520%25E5%2590%25A6%2520--%253E%2520K%255B%25E7%2594%259F%25E6%2588%2590%25E6%2599%25AE%25E9%2580%259A%25E7%2594%25A8%25E6%2588%25B7%25E6%25AC%25A2%25E8%25BF%258E%25E8%25AF%25AD%255D%253B%250A%2520%2520H%2520--%253E%2520L%255B%25E8%25BE%2593%25E5%2587%25BA%25E7%25A7%25AF%25E5%2588%2586%255D%253B%250A%2520%2520J%2520--%253E%2520L%253B%250A%2520%2520K%2520--%253E%2520L%253B%250A%2520%2520L%2520--%253E%2520M%255B%25E7%25BB%2593%25E6%259D%259F%255D%253B" target="_blank" title="https://www.min2k.com/tools/mermaid/?code=flowchart%20TD%0A%20%20A%5B%E5%BC%80%E5%A7%8B%5D%20--%3E%20B%7B%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%7D%3B%0A%20%20B%20--%3E%20C%7B%E5%AE%9A%E4%B9%89Jinja2%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%7D%3B%0A%20%20C%20--%3E%20D%5B%E5%88%9B%E5%BB%BATemplate%E5%AF%B9%E8%B1%A1%5D%3B%0A%20%20D%20--%3E%20E%7B%E4%BC%A0%E5%85%A5%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%7D%3B%0A%20%20E%20--%3E%20F%7B%E6%89%93%E5%8D%B0%E6%B8%B2%E6%9F%93%E7%BB%93%E6%9E%9C%7D%3B%0A%20%20F%20--%3E%20G%7B%E5%88%A4%E6%96%AD%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E4%B8%BA%E7%AE%A1%E7%90%86%E5%91%98%3F%7D%3B%0A%20%20G%20--%20%E6%98%AF%20--%3E%20H%5B%E7%94%9F%E6%88%90%E7%AE%A1%E7%90%86%E5%91%98%E6%AC%A2%E8%BF%8E%E8%AF%AD%5D%3B%0A%20%20G%20--%20%E5%90%A6%20--%3E%20I%7B%E7%94%A8%E6%88%B7%E7%A7%AF%E5%88%86%E6%98%AF%E5%90%A6%E5%A4%A7%E4%BA%8E100%3F%7D%3B%0A%20%20I%20--%20%E6%98%AF%20--%3E%20J%5B%E7%94%9F%E6%88%90%E9%AB%98%E7%A7%AF%E5%88%86%E4%BC%9A%E5%91%98%E6%AC%A2%E8%BF%8E%E8%AF%AD%5D%3B%0A%20%20I%20--%20%E5%90%A6%20--%3E%20K%5B%E7%94%9F%E6%88%90%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E6%AC%A2%E8%BF%8E%E8%AF%AD%5D%3B%0A%20%20H%20--%3E%20L%5B%E8%BE%93%E5%87%BA%E7%A7%AF%E5%88%86%5D%3B%0A%20%20J%20--%3E%20L%3B%0A%20%20K%20--%3E%20L%3B%0A%20%20L%20--%3E%20M%5B%E7%BB%93%E6%9D%9F%5D%3B" ref="nofollow noopener noreferrer">MermaidGo</a> ç»˜åˆ¶ç¤ºä¾‹ä»£ç çš„æµç¨‹å›¾ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3066279c154949c4ab0e2a16958f1fe9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWP57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771049987&amp;x-signature=9nQie5DGhV005PydnMhQgWfEMiQ%3D" alt="MermerGoçš„jinja2æµç¨‹å›¾" loading="lazy"/></p>
<h3 data-id="heading-5">äº”ã€å­¦ä¹ èµ„æº</h3>
<ol>
<li>å¼€æºé¡¹ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja" target="_blank" title="https://github.com/pallets/jinja" ref="nofollow noopener noreferrer">jinja2</a></li>
<li>ä¸­æ–‡è‡ªè¿°ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python64.cn%2Freadme%2Fjinja2%2F" target="_blank" title="https://www.python64.cn/readme/jinja2/" ref="nofollow noopener noreferrer">REMDME</a></li>
<li>åœ¨çº¿è¿è¡Œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F" target="_blank" title="https://www.min2k.com/tools/python-run/" ref="nofollow noopener noreferrer">PythonRun</a></li>
</ol>
<blockquote>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï¼<br/>
å­¦ä¹ è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï½</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java åŸºäºxmlé…ç½®çš„å±æ€§æ˜ å°„å·¥å…·ï¼Œå¯ç”¨äºæŠ¥æ–‡è½¬æ¢é€‚é…ã€‚]]></title>    <link>https://juejin.cn/post/7603575763787431962</link>    <guid>https://juejin.cn/post/7603575763787431962</guid>    <pubDate>2026-02-07T06:57:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603575763787431962" data-draft-id="7603595309232537610" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java åŸºäºxmlé…ç½®çš„å±æ€§æ˜ å°„å·¥å…·ï¼Œå¯ç”¨äºæŠ¥æ–‡è½¬æ¢é€‚é…ã€‚"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T06:57:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·31827414958"/> <meta itemprop="url" content="https://juejin.cn/user/4325944384039072"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java åŸºäºxmlé…ç½®çš„å±æ€§æ˜ å°„å·¥å…·ï¼Œå¯ç”¨äºæŠ¥æ–‡è½¬æ¢é€‚é…ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4325944384039072/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·31827414958
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T06:57:13.000Z" title="Sat Feb 07 2026 06:57:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é¡¹ç›®ä»‹ç»</h2>
<h3 data-id="heading-1">1.1 é¡¹ç›®æ¦‚è¿°</h3>
<p>Bean Transfer æ˜¯ä¸€ä¸ªåŸºäº XML é…ç½®çš„å¯¹è±¡åˆ°å¯¹è±¡æ˜ å°„å·¥å…·ï¼Œä¸“ä¸ºå¤æ‚æŠ¥æ–‡è½¬æ¢åœºæ™¯è®¾è®¡ã€‚è¯¥æ¡†æ¶é€šè¿‡å£°æ˜å¼çš„ XML é…ç½®å®ç°å¯¹è±¡æ˜ å°„ï¼Œæ— éœ€ä¿®æ”¹å®ä½“ç±»å³å¯å®Œæˆå¤æ‚çš„è½¬æ¢é€»è¾‘ã€‚</p>
<p>é¡¹ç›®åœ°å€: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fjjjxxx%2Fbean-transfer" target="_blank" title="https://gitee.com/jjjxxx/bean-transfer" ref="nofollow noopener noreferrer">bean-transfer: åŸºäºé…ç½®æ–‡ä»¶å®ç°å±æ€§å¤åˆ¶ï¼ŒåŸºäºSPEL,æ”¯æŒå¤æ‚è¡¨è¾¾å¼ã€‚</a></p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>æŠ¥æ–‡è½¬æ¢ï¼ˆå¦‚ HTTP è¯·æ±‚/å“åº”è½¬æ¢ï¼‰</li>
<li>å¼‚æ„ç³»ç»Ÿä¹‹é—´çš„æ•°æ®å¯¹æ¥</li>
<li>éœ€è¦é¢‘ç¹å˜åŒ–çš„å­—æ®µæ˜ å°„å…³ç³»</li>
<li>è·¨å±‚çº§ã€åµŒå¥—å¯¹è±¡çš„å¤æ‚æ˜ å°„</li>
</ul>
<p><strong>ä¸é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç®€å•çš„ Bean å±æ€§å¤åˆ¶ï¼ˆæ¨èä½¿ç”¨ BeanUtilsã€MapStruct ç­‰å·¥å…·ï¼‰</li>
<li>æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ï¼ˆåå°„æœºåˆ¶æœ‰ä¸€å®šæ€§èƒ½å¼€é”€ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-2">äºŒã€æ ¸å¿ƒç‰¹æ€§</h2>
<h3 data-id="heading-3">2.1 ä¸»è¦åŠŸèƒ½</h3>
<p>âœ… <strong>XML é…ç½®é©±åŠ¨</strong>ï¼šé€šè¿‡ XML æ–‡ä»¶å®šä¹‰æ˜ å°„è§„åˆ™ï¼Œé›¶ä¾µå…¥å®ä½“ç±»
âœ… <strong>å¤æ‚çš„è·¯å¾„è§£æ</strong>ï¼šæ”¯æŒ SpEL è¡¨è¾¾å¼ã€å¤šå±‚åµŒå¥—è·¯å¾„è®¿é—®
âœ… <strong>ä¸Šä¸‹æ–‡å˜é‡</strong>ï¼šæ”¯æŒ <code>current</code> å’Œ <code>_</code> ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå®ç°è·¨å±‚çº§è®¿é—®
âœ… <strong>çµæ´»çš„å€¼å¤„ç†</strong>ï¼šæ”¯æŒå›ºå®šå€¼ã€å˜é‡å¼•ç”¨ã€SpEL è¡¨è¾¾å¼
âœ… <strong>è‡ªå®šä¹‰è½¬æ¢å™¨</strong>ï¼šæä¾›æ‰©å±•ç‚¹ï¼Œæ”¯æŒè‡ªå®šä¹‰è½¬æ¢é€»è¾‘
âœ… <strong>Spring é›†æˆ</strong>ï¼šæä¾› Spring Boot Starterï¼Œå¼€ç®±å³ç”¨
âœ… <strong>ç±»å‹å®‰å…¨</strong>ï¼šæ”¯æŒç±»å‹è½¬æ¢å’ŒéªŒè¯
âœ… <strong>é›†åˆæ˜ å°„</strong>ï¼šæ”¯æŒæ•°ç»„ã€Listã€Set ç­‰é›†åˆç±»å‹çš„æ˜ å°„</p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-5">3.1 Maven ä¾èµ–</h3>
<h4 data-id="heading-6">Spring Boot é¡¹ç›®ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hongri<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>bean-transfer-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">æ™®é€š Spring é¡¹ç›®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hongri<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>bean-transfer-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-8">ç‹¬ç«‹ä½¿ç”¨</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hongri<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>bean-transfer-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">3.2 é…ç½®æ–‡ä»¶ä½ç½®</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¡†æ¶ä¼šä» <code>classpath:mappingConfiguration/</code> ç›®å½•ä¸‹åŠ è½½ XML é…ç½®æ–‡ä»¶ã€‚</p>
<p>å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ä½ç½®ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomLoaderConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> MappingConfigurationLoader <span class="hljs-title function_">mappingConfigurationLoader</span><span class="hljs-params">(
            MappingConfigurationParser parser)</span> {
        <span class="hljs-comment">// è‡ªå®šä¹‰é…ç½®æ–‡ä»¶è·¯å¾„</span>
        List&lt;String&gt; basePackages = Arrays.asList(
            <span class="hljs-string">"mappingConfiguration"</span>,
            <span class="hljs-string">"customMappingConfig"</span>
        );
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlMappingConfigurationLoader</span>(parser, basePackages);
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> MappingConfigurationFactory <span class="hljs-title function_">mappingConfigurationFactory</span><span class="hljs-params">(
            MappingConfigurationLoader loader)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">DefaultMappingConfigurationFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMappingConfigurationFactory</span>(loader);
        factory.loadConfiguration(); <span class="hljs-comment">// åŠ è½½æ‰€æœ‰é…ç½®</span>
        <span class="hljs-keyword">return</span> factory;
    }
}
</code></pre>
<h3 data-id="heading-10">3.3 Hello World ç¤ºä¾‹</h3>
<h4 data-id="heading-11">æ­¥éª¤ 1ï¼šå®šä¹‰å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æºå¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDTO</span> {
    <span class="hljs-keyword">private</span> String userName;
    <span class="hljs-keyword">private</span> Integer userAge;
    <span class="hljs-keyword">private</span> String userAddress;

    <span class="hljs-comment">// getters and setters</span>
}

<span class="hljs-comment">// ç›®æ ‡å¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserVO</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Integer age;
    <span class="hljs-keyword">private</span> String address;

    <span class="hljs-comment">// getters and setters</span>
}
</code></pre>
<h4 data-id="heading-12">æ­¥éª¤ 2ï¼šåˆ›å»ºæ˜ å°„é…ç½®</h4>
<p>å°†ä»¥ä¸‹å†…å®¹ä¿å­˜åˆ° <code>src/main/resources/mappingConfiguration/user-mapping.xml</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span>
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.UserVO"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"user-mapping"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"userName"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"age"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"userAge"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"userAddress"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">æ­¥éª¤ 3ï¼šä½¿ç”¨è½¬æ¢å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;

<span class="hljs-keyword">public</span> UserVO <span class="hljs-title function_">convertUser</span><span class="hljs-params">(UserDTO dto)</span> {
    ObjectTransfer&lt;Object, Object&gt; transfer =
        transferBuilder.buildObjectTransfer(<span class="hljs-string">"user-mapping"</span>);
    <span class="hljs-keyword">return</span> (UserVO) transfer.transfer(dto);
}
</code></pre>
<hr/>
<h2 data-id="heading-14">å››ã€é…ç½®è¯´æ˜</h2>
<h3 data-id="heading-15">4.1 é…ç½®æ–‡ä»¶ç»“æ„</h3>
<h4 data-id="heading-16">å®Œæ•´é…ç½®ç¤ºä¾‹</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.TargetClass"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"unique-namespace"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"https://hongri.com.cn/mapping https://hongri.com.cn/path/to/mapping.xsd"</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å­—æ®µæ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"targetField"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"sourceField"</span> 
        <span class="hljs-attr">value</span>=<span class="hljs-string">"fixedValue"</span> 
        <span class="hljs-attr">escape-class</span>=<span class="hljs-string">"com.example.EscapeHandler"</span>
        <span class="hljs-attr">converter-class</span>=<span class="hljs-string">"com.example.Converter"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å¯¹è±¡æ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"targetObject"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"sourceObject"</span>
        <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.NestedClass"</span>
        <span class="hljs-attr">converter-class</span>=<span class="hljs-string">"com.example.Converter"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åµŒå¥—æ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ•°ç»„æ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"targetArray"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"sourceArray"</span> 
        <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.ItemClass"</span>
        <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.TargetArrayClass"</span>
        <span class="hljs-attr">converter-class</span>=<span class="hljs-string">"com.example.Converter"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°ç»„é¡¹æ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-17">4.2 é…ç½®æ ‡ç­¾è¯¦è§£</h3>
<h4 data-id="heading-18">mappingConfigurationï¼ˆæ ¹æ ‡ç­¾ï¼‰</h4>




















<table><thead><tr><th>å±æ€§</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>class</code></td><td>æ˜¯</td><td>ç›®æ ‡å®ä½“ç±»çš„å…¨é™å®šåæˆ–ç®€å†™ï¼ˆå¦‚ <code>map</code>ï¼‰</td></tr><tr><td><code>namespace</code></td><td>æ˜¯</td><td>å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåŠ è½½å’Œç®¡ç†é…ç½®</td></tr></tbody></table>
<h4 data-id="heading-19">field-mappingï¼ˆå­—æ®µæ˜ å°„ï¼‰</h4>















































<table><thead><tr><th>å±æ€§</th><th>å¿…å¡«</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>target</code></td><td>æ˜¯</td><td>ç›®æ ‡å­—æ®µè·¯å¾„ï¼Œæ”¯æŒ SpEL</td><td><code>userInfo.name</code></td></tr><tr><td><code>source</code></td><td>å¦</td><td>æºå­—æ®µè·¯å¾„ï¼Œæ”¯æŒ SpEL</td><td><code>data.user.name</code></td></tr><tr><td><code>value</code></td><td>å¦</td><td>å›ºå®šå€¼ï¼Œæ”¯æŒ <code>${}</code> å˜é‡</td><td><code>${requestId}</code></td></tr><tr><td><code>escape-class</code></td><td>å¦</td><td>å€¼è½¬ä¹‰å¤„ç†ç±»å…¨é™å®šå</td><td><code>com.example.EscapeHandler</code></td></tr><tr><td><code>target-class</code></td><td>å¦</td><td>ç›®æ ‡å­—æ®µç±»å‹ï¼Œé€šå¸¸ä¸éœ€è¦å¡«å†™</td><td><code>java.lang.String</code></td></tr><tr><td><code>converter-class</code></td><td>å¦</td><td>è‡ªå®šä¹‰è½¬æ¢å™¨ç±»</td><td><code>com.example.CustomConverter</code></td></tr></tbody></table>
<h4 data-id="heading-20">object-mappingï¼ˆå¯¹è±¡æ˜ å°„ï¼‰</h4>






























<table><thead><tr><th>å±æ€§</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>target</code></td><td>æ˜¯</td><td>ç›®æ ‡å¯¹è±¡å­—æ®µè·¯å¾„</td></tr><tr><td><code>source</code></td><td>æ˜¯</td><td>æºå¯¹è±¡å­—æ®µè·¯å¾„</td></tr><tr><td><code>target-class</code></td><td>å¦</td><td>ç›®æ ‡å¯¹è±¡ç±»å‹</td></tr><tr><td><code>converter-class</code></td><td>å¦</td><td>è‡ªå®šä¹‰è½¬æ¢å™¨ç±»</td></tr></tbody></table>
<h4 data-id="heading-21">array-mappingï¼ˆæ•°ç»„æ˜ å°„ï¼‰</h4>



































<table><thead><tr><th>å±æ€§</th><th>å¿…å¡«</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>target</code></td><td>æ˜¯</td><td>ç›®æ ‡é›†åˆå­—æ®µè·¯å¾„</td></tr><tr><td><code>source</code></td><td>æ˜¯</td><td>æºé›†åˆå­—æ®µè·¯å¾„</td></tr><tr><td><code>item-class</code></td><td>æ˜¯</td><td>é›†åˆå…ƒç´ ç±»å‹</td></tr><tr><td><code>target-class</code></td><td>å¦</td><td>ç›®æ ‡å¯¹è±¡ç±»å‹</td></tr><tr><td><code>converter-class</code></td><td>å¦</td><td>è‡ªå®šä¹‰è½¬æ¢å™¨ç±»</td></tr></tbody></table>
<h3 data-id="heading-22">4.3 å…³é”®æ¦‚å¿µè¯´æ˜</h3>
<h4 data-id="heading-23">ä¸Šä¸‹æ–‡å¯¹è±¡</h4>
<p>åœ¨æ˜ å°„è¿‡ç¨‹ä¸­ï¼Œæ¡†æ¶æä¾›äº†ä¸¤ä¸ªç‰¹æ®Šçš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼š</p>
<p><strong><code>current</code></strong>ï¼šå½“å‰æ­£åœ¨å¤„ç†çš„å¤–å±‚å¯¹è±¡</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç¤ºä¾‹ï¼šå°†æ•´ä¸ªä¸Šçº§å¯¹è±¡ä¼ é€’ç»™åµŒå¥—å¯¹è±¡ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelInfo"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current.name"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
</code></pre>
<p><strong><code>_</code></strong>ï¼šå½“å‰å¤„ç†å¯¹è±¡çš„ä¸Šçº§å¯¹è±¡</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç¤ºä¾‹ï¼šè·¨å±‚çº§è®¿é—®çˆ¶çº§å±æ€§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"data"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelInfo"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- è®¿é—®çˆ¶çº§ data å¯¹è±¡çš„ hotelId --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"_.hotelId"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
</code></pre>
<h4 data-id="heading-24">è·¯å¾„è§£æç¤ºä¾‹</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- è§£æçˆ¶çº§å¯¹è±¡çš„çˆ¶çº§å¯¹è±¡çš„ hotelId --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"data"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelInfo"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- _.hotelId = data.hotelIdï¼Œ_ å³ data --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"_.hotelId"</span>/&gt;</span>
        <span class="hljs-comment">&lt;!-- current.name = name = hotelInfo.nameï¼Œcurrent å³ hotelInfo --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current.name"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
</code></pre>
<h4 data-id="heading-25">åŠ¨æ€å€¼å¤„ç†</h4>
<p><strong>SpEL è¡¨è¾¾å¼ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ¡ä»¶åˆ¤æ–­ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"isAvailable"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"stock &gt; 0"</span>/&gt;</span>
<span class="hljs-comment">&lt;!-- å­—ç¬¦ä¸²æ‹¼æ¥ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"fullName"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"firstName + ' ' + lastName"</span>/&gt;</span>
<span class="hljs-comment">&lt;!-- ä¸‰å…ƒè¡¨è¾¾å¼ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statusText"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"status == 1 ? 'æ¿€æ´»' : 'æœªæ¿€æ´»'"</span>/&gt;</span>
</code></pre>
<p><strong>å›ºå®šå€¼ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"currency"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"CNY"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"version"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1.0"</span>/&gt;</span>
</code></pre>
<p><strong>å˜é‡å¼•ç”¨ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ä¸Šä¸‹æ–‡å˜é‡ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"requestId"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${requestId}"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"timestamp"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${currentTime}"</span>/&gt;</span>
</code></pre>
<p><strong>å¤æ‚é›†åˆå¤„ç†ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ flatMap å±•å¹³åµŒå¥—æ•°ç»„ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
    <span class="hljs-attr">target</span>=<span class="hljs-string">"amenities"</span> 
    <span class="hljs-attr">source</span>=<span class="hljs-string">"#flatMap(features?.![amenities])"</span>
    <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.Amenity"</span>/&gt;</span>
</code></pre>
<h4 data-id="heading-26">ç±»åç®€å†™</h4>
<p>ä¸ºç®€åŒ–é…ç½®ï¼Œæ”¯æŒä»¥ä¸‹ç±»åç®€å†™ï¼š</p>

























<table><thead><tr><th>ç®€å†™</th><th>å®é™…ç±»å</th></tr></thead><tbody><tr><td><code>map</code></td><td><code>java.util.LinkedHashMap</code></td></tr><tr><td><code>hmap</code></td><td><code>java.util.HashMap</code></td></tr><tr><td><code>list</code></td><td><code>java.util.ArrayList</code></td></tr><tr><td><code>set</code></td><td><code>java.util.HashSet</code></td></tr></tbody></table>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ç®€å†™ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"map"</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"example"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"response"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"map"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-27">äº”ã€ä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-28">5.1 Spring Boot é›†æˆ</h3>
<h4 data-id="heading-29">è‡ªåŠ¨é…ç½®</h4>
<p>å¼•å…¥ <code>bean-transfer-starter</code> åï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨é…ç½®ä»¥ä¸‹ Beanï¼š</p>
<ul>
<li><code>MappingConfigurationParser</code>ï¼šXML é…ç½®è§£æå™¨</li>
<li><code>MappingConfigurationLoader</code>ï¼šé…ç½®åŠ è½½å™¨</li>
<li><code>MappingConfigurationFactory</code>ï¼šé…ç½®å·¥å‚</li>
<li><code>BeanCopierConfiguration</code>ï¼šå…¨å±€é…ç½®</li>
<li><code>ConfigurationObjectTransferBuilder</code>ï¼šè½¬æ¢å™¨æ„å»ºå™¨</li>
</ul>
<h4 data-id="heading-30">é…ç½®æ–‡ä»¶ä½ç½®</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒXML é…ç½®æ–‡ä»¶åº”æ”¾ç½®åœ¨ <code>classpath:mappingConfiguration/</code> ç›®å½•ä¸‹ã€‚</p>
<h4 data-id="heading-31">è‡ªå®šä¹‰é…ç½®</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomCopierConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> CustomFunctionProvider <span class="hljs-title function_">customFunctionProvider</span><span class="hljs-params">()</span> {
        Map&lt;String, Object&gt; functions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        functions.put(<span class="hljs-string">"formatDate"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateFormatter</span>());
        <span class="hljs-keyword">return</span> () -&gt; functions;
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TypeConverter <span class="hljs-title function_">customTypeConverter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCustomConverter</span>();
    }
}
</code></pre>
<h3 data-id="heading-32">5.2 åŸºæœ¬ä½¿ç”¨</h3>
<h4 data-id="heading-33">æ„å»º ObjectTransfer</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;

<span class="hljs-comment">// æ–¹å¼ 1ï¼šä½¿ç”¨ namespace æ„å»º</span>
ObjectTransfer&lt;Object, Object&gt; transfer =
    transferBuilder.buildObjectTransfer(<span class="hljs-string">"namespace-name"</span>);

<span class="hljs-comment">// æ–¹å¼ 2ï¼šå¸¦ä¸Šä¸‹æ–‡æ„å»º</span>
Map&lt;String, Object&gt; context = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
context.put(<span class="hljs-string">"requestId"</span>, <span class="hljs-string">"123456"</span>);
ObjectTransfer&lt;Object, Object&gt; transfer =
    transferBuilder.buildObjectTransfer(<span class="hljs-string">"namespace-name"</span>, context);

<span class="hljs-comment">// æ–¹å¼ 3ï¼šä½¿ç”¨è‡ªå®šä¹‰ EvaluationContext</span>
<span class="hljs-type">EvaluationContext</span> <span class="hljs-variable">evaluationContext</span> <span class="hljs-operator">=</span> ...;
ObjectTransfer&lt;Object, Object&gt; transfer =
    transferBuilder.buildObjectTransfer(<span class="hljs-string">"namespace-name"</span>, context, evaluationContext);
</code></pre>
<h4 data-id="heading-34">æ‰§è¡Œè½¬æ¢</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç®€å•è½¬æ¢</span>
<span class="hljs-type">SourceObject</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SourceObject</span>();
<span class="hljs-type">TargetObject</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> (TargetObject) transfer.transfer(source);

<span class="hljs-comment">// å¸¦ Map ä¸Šä¸‹æ–‡çš„è½¬æ¢</span>
Map&lt;String, Object&gt; contextMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
contextMap.put(<span class="hljs-string">"userId"</span>, <span class="hljs-string">"user001"</span>);
contextMap.put(<span class="hljs-string">"requestId"</span>, UUID.randomUUID().toString());

<span class="hljs-type">SourceObject</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SourceObject</span>();
<span class="hljs-type">TargetObject</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> (TargetObject) transfer.transfer(source);
</code></pre>
<h3 data-id="heading-35">5.3 è‡ªå®šä¹‰è½¬æ¢å™¨</h3>
<h4 data-id="heading-36">å®ç° TypeConverter æ¥å£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TypeConverter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(Class&lt;?&gt; sourceType, Class&lt;?&gt; targetType)</span> {
        <span class="hljs-keyword">return</span> targetType == CustomType.class;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">convert</span><span class="hljs-params">(Object source, Class&lt;?&gt; targetType)</span> {
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-comment">// è‡ªå®šä¹‰è½¬æ¢é€»è¾‘</span>
        <span class="hljs-keyword">return</span> convertToCustomType(source);
    }
}
</code></pre>
<h4 data-id="heading-37">æ³¨å†Œè‡ªå®šä¹‰è½¬æ¢å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConverterConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TypeConverterFactory <span class="hljs-title function_">customTypeConverterFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-type">DefaultTypeConverterFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultTypeConverterFactory</span>();
        factory.registerConverter(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCustomConverter</span>());
        <span class="hljs-keyword">return</span> factory;
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> BeanCopierConfiguration <span class="hljs-title function_">beanCopierConfiguration</span><span class="hljs-params">(
            TypeConverterFactory factory)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanCopierConfiguration</span>.Builder()
            .typeConverterFactory(factory)
            .build();
    }
}
</code></pre>
<h3 data-id="heading-38">5.4 è‡ªå®šä¹‰å‡½æ•°</h3>
<h4 data-id="heading-39">å®šä¹‰è‡ªå®šä¹‰å‡½æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DateFormatter</span> {
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">format</span><span class="hljs-params">(Object date, String pattern)</span> {
        <span class="hljs-keyword">if</span> (date == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(pattern);
        <span class="hljs-keyword">return</span> sdf.format(date);
    }
}
</code></pre>
<h4 data-id="heading-40">æ³¨å†Œè‡ªå®šä¹‰å‡½æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
<span class="hljs-keyword">public</span> CustomFunctionProvider <span class="hljs-title function_">customFunctionProvider</span><span class="hljs-params">()</span> {
    Map&lt;String, Object&gt; functions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    functions.put(<span class="hljs-string">"formatDate"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateFormatter</span>());
    functions.put(<span class="hljs-string">"encrypt"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">EncryptFunction</span>());
    <span class="hljs-keyword">return</span> () -&gt; functions;
}
</code></pre>
<h4 data-id="heading-41">åœ¨ XML ä¸­ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•° --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
    <span class="hljs-attr">target</span>=<span class="hljs-string">"formattedDate"</span> 
    <span class="hljs-attr">source</span>=<span class="hljs-string">"#formatDate(birthday, 'yyyy-MM-dd')"</span>/&gt;</span>
</code></pre>
<h3 data-id="heading-42">5.5 è‡ªå®šä¹‰è½¬ä¹‰å¤„ç†å™¨</h3>
<h4 data-id="heading-43">å®ç° EscapeHandler</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XssEscapeHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EscapeHandler</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">escape</span><span class="hljs-params">(Object value)</span> {
        <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> String) {
            <span class="hljs-keyword">return</span> escapeHtml((String) value);
        }
        <span class="hljs-keyword">return</span> value;
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">escapeHtml</span><span class="hljs-params">(String html)</span> {
        <span class="hljs-comment">// HTML è½¬ä¹‰é€»è¾‘</span>
        <span class="hljs-keyword">return</span> html.replace(<span class="hljs-string">"&lt;"</span>, <span class="hljs-string">"&amp;lt;"</span>)
                  .replace(<span class="hljs-string">"&gt;"</span>, <span class="hljs-string">"&amp;gt;"</span>);
    }
}
</code></pre>
<h4 data-id="heading-44">åœ¨ XML ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
    <span class="hljs-attr">target</span>=<span class="hljs-string">"content"</span> 
    <span class="hljs-attr">source</span>=<span class="hljs-string">"rawContent"</span> 
    <span class="hljs-attr">escape-class</span>=<span class="hljs-string">"com.example.XssEscapeHandler"</span>/&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-45">å…­ã€å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-46">6.1 æ¡ˆä¾‹ 1ï¼šHTTP è¯·æ±‚å‚æ•°è½¬æ¢</h3>
<h4 data-id="heading-47">åœºæ™¯</h4>
<p>å°†å‰ç«¯ JSON è¯·æ±‚è½¬æ¢ä¸ºåç«¯ API è¯·æ±‚å¯¹è±¡ã€‚</p>
<h4 data-id="heading-48">æºå¯¹è±¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FrontendHotelRequest</span> {
    <span class="hljs-keyword">private</span> String hotelId;
    <span class="hljs-keyword">private</span> String startDate;
    <span class="hljs-keyword">private</span> String endDate;
    <span class="hljs-keyword">private</span> Integer guestCount;
    <span class="hljs-keyword">private</span> List&lt;String&gt; roomTypes;
    
    <span class="hljs-comment">// getters and setters</span>
}
</code></pre>
<h4 data-id="heading-49">ç›®æ ‡å¯¹è±¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BackendHotelRequest</span> {
    <span class="hljs-keyword">private</span> String hotelCode;
    <span class="hljs-keyword">private</span> Date checkInTime;
    <span class="hljs-keyword">private</span> Date checkOutTime;
    <span class="hljs-keyword">private</span> Integer numberOfGuests;
    <span class="hljs-keyword">private</span> List&lt;RoomTypeRequest&gt; rooms;
    
    <span class="hljs-comment">// getters and setters</span>
}
</code></pre>
<h4 data-id="heading-50">æ˜ å°„é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.BackendHotelRequest"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotel-request-mapping"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelCode"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelId"</span>/&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"checkInTime"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"#parseDate(startDate, 'yyyy-MM-dd')"</span>/&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"checkOutTime"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"#parseDate(endDate, 'yyyy-MM-dd')"</span>/&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"numberOfGuests"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"guestCount"</span>/&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"rooms"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"roomTypes"</span> 
        <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.RoomTypeRequest"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"roomType"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"quantity"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-51">ä½¿ç”¨ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;

    <span class="hljs-keyword">public</span> BackendHotelRequest <span class="hljs-title function_">convertRequest</span><span class="hljs-params">(FrontendHotelRequest frontendRequest)</span> {
        ObjectTransfer&lt;Object, Object&gt; transfer =
            transferBuilder.buildObjectTransfer(<span class="hljs-string">"hotel-request-mapping"</span>);
        <span class="hljs-keyword">return</span> (BackendHotelRequest) transfer.transfer(frontendRequest);
    }
}
</code></pre>
<h3 data-id="heading-52">6.2 æ¡ˆä¾‹ 2ï¼šå¤æ‚æŠ¥æ–‡å“åº”è½¬æ¢</h3>
<h4 data-id="heading-53">åœºæ™¯</h4>
<p>å°†ç¬¬ä¸‰æ–¹ API å“åº”è½¬æ¢ä¸ºå†…éƒ¨ç»Ÿä¸€çš„å“åº”æ ¼å¼ã€‚</p>
<h4 data-id="heading-54">ç¬¬ä¸‰æ–¹å“åº”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThirdPartyResponse</span> {
    <span class="hljs-keyword">private</span> Integer returnCode;
    <span class="hljs-keyword">private</span> String returnMsg;
    <span class="hljs-keyword">private</span> ResponseData response;
    
    <span class="hljs-comment">// getters and setters</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResponseData</span> {
        <span class="hljs-keyword">private</span> List&lt;HotelInfo&gt; hotels;
        <span class="hljs-keyword">private</span> Integer totalCount;
        <span class="hljs-keyword">private</span> PageInfo pagination;
        
        <span class="hljs-comment">// getters and setters</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelInfo</span> {
        <span class="hljs-keyword">private</span> String id;
        <span class="hljs-keyword">private</span> String name;
        <span class="hljs-keyword">private</span> Double lat;
        <span class="hljs-keyword">private</span> Double lng;
        <span class="hljs-keyword">private</span> Location location;
        <span class="hljs-keyword">private</span> Integer stock;
        <span class="hljs-keyword">private</span> BigDecimal price;
        
        <span class="hljs-comment">// getters and setters</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Location</span> {
        <span class="hljs-keyword">private</span> String city;
        <span class="hljs-keyword">private</span> String province;
        <span class="hljs-keyword">private</span> String country;
        
        <span class="hljs-comment">// getters and setters</span>
    }
}
</code></pre>
<h4 data-id="heading-55">å†…éƒ¨å“åº”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelDetailResponse</span> {
    <span class="hljs-keyword">private</span> Integer code;
    <span class="hljs-keyword">private</span> String message;
    <span class="hljs-keyword">private</span> HotelData data;
    
    <span class="hljs-comment">// getters and setters</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelData</span> {
        <span class="hljs-keyword">private</span> List&lt;HotelInfoDTO&gt; hotels;
        <span class="hljs-keyword">private</span> Integer total;
        <span class="hljs-keyword">private</span> PageInfoDTO page;
        
        <span class="hljs-comment">// getters and setters</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelInfoDTO</span> {
        <span class="hljs-keyword">private</span> String hotelId;
        <span class="hljs-keyword">private</span> String hotelName;
        <span class="hljs-keyword">private</span> Address address;
        <span class="hljs-keyword">private</span> Boolean isAvailable;
        <span class="hljs-keyword">private</span> String price;
        
        <span class="hljs-comment">// getters and setters</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> {
        <span class="hljs-keyword">private</span> String city;
        <span class="hljs-keyword">private</span> Coordinates coordinates;
        
        <span class="hljs-comment">// getters and setters</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Coordinates</span> {
        <span class="hljs-keyword">private</span> Double latitude;
        <span class="hljs-keyword">private</span> Double longitude;
        
        <span class="hljs-comment">// getters and setters</span>
    }
}
</code></pre>
<h4 data-id="heading-56">æ˜ å°„é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.HotelDetailResponse"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotel-response-mapping"</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- åŸºç¡€å­—æ®µæ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"returnCode"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"returnMsg"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- åµŒå¥—å¯¹è±¡æ˜ å°„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"response"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.HotelDetailResponse.HotelData"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"total"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"totalCount"</span>/&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æ•°ç»„æ˜ å°„ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
            <span class="hljs-attr">target</span>=<span class="hljs-string">"hotels"</span> 
            <span class="hljs-attr">source</span>=<span class="hljs-string">"hotels"</span> 
            <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.HotelDetailResponse.HotelInfoDTO"</span>&gt;</span>
            
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"id"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelName"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"name"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æ¡ä»¶åˆ¤æ–­ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"isAvailable"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"stock &gt; 0"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- ä»·æ ¼æ ¼å¼åŒ– --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"price"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"#formatPrice(price)"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- åµŒå¥—å¯¹è±¡æ˜ å°„ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.HotelDetailResponse.Address"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"city"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"location.city"</span>/&gt;</span>
                
                <span class="hljs-comment">&lt;!-- åæ ‡æ˜ å°„ --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"coordinates"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.HotelDetailResponse.Coordinates"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"latitude"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"lat"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"longitude"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"lng"</span>/&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-57">ä½¿ç”¨ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelIntegrationService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ThirdPartyApiClient apiClient;
    
    <span class="hljs-keyword">public</span> HotelDetailResponse <span class="hljs-title function_">getHotelDetails</span><span class="hljs-params">(String hotelId)</span> {
        <span class="hljs-comment">// è°ƒç”¨ç¬¬ä¸‰æ–¹ API</span>
        <span class="hljs-type">ThirdPartyResponse</span> <span class="hljs-variable">thirdPartyResponse</span> <span class="hljs-operator">=</span> apiClient.queryHotel(hotelId);

        <span class="hljs-comment">// è½¬æ¢å“åº”</span>
        ObjectTransfer&lt;Object, Object&gt; transfer =
            transferBuilder.buildObjectTransfer(<span class="hljs-string">"hotel-response-mapping"</span>);
        <span class="hljs-keyword">return</span> (HotelDetailResponse) transfer.transfer(thirdPartyResponse);
    }
}
</code></pre>
<h3 data-id="heading-58">6.3 æ¡ˆä¾‹ 3ï¼šè®¢å•æŠ¥æ–‡è½¬æ¢</h3>
<h4 data-id="heading-59">åœºæ™¯</h4>
<p>å°†ä¸šåŠ¡ç³»ç»Ÿè®¢å•å“åº”è½¬æ¢ä¸ºå‰ç«¯å±•ç¤ºçš„è®¢å•è¯¦æƒ…ã€‚</p>
<h4 data-id="heading-60">é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.order.detail.OrderDetailResponse"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"order-detail-mapping"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"bussinessResponse"</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> 
        <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.order.detail.OrderDetailResult"</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- åŸºç¡€ä¿¡æ¯ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"baseInfo"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"coOrderCode"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"orderId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"fcOrderCode"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"distributorOrderId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"totalAmount"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"totalPrice"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"orderStatus"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"orderStatus"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- é¢„çº¦ä¿¡æ¯ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> 
            <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> 
            <span class="hljs-attr">target</span>=<span class="hljs-string">"aptInfo"</span> 
            <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.order.detail.OrderAptInfo"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"coOrderCode"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"orderId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"checkInDate"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"checkinTime"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"checkOutDate"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"checkoutTime"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"arriveTime"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"arriveTime"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomName"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"roomName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomId"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"realRoomId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomNum"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"roomCount"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelName"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"linkMan"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"personNames"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"linkMan"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"contactName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"linkPhone"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"contactPhone"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æˆ¿æ™šä¿¡æ¯ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
            <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.order.detail.RoomNightInfo"</span> 
            <span class="hljs-attr">source</span>=<span class="hljs-string">"priceItems"</span> 
            <span class="hljs-attr">target</span>=<span class="hljs-string">"roomNights"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"saleDate"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"bizDate"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"salePrice"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"sellPrice"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-61">6.4 æ¡ˆä¾‹ 4ï¼šè¯·æ±‚æŠ¥æ–‡ç”Ÿæˆï¼ˆMap è½¬æ¢ï¼‰</h3>
<h4 data-id="heading-62">åœºæ™¯</h4>
<p>å°†å‰ç«¯è¯·æ±‚å¯¹è±¡è½¬æ¢ä¸ºåç«¯ API éœ€è¦çš„ Map æ ¼å¼ã€‚</p>
<h4 data-id="heading-63">é…ç½®æ–‡ä»¶</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"map"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotel-query-request"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"businessRequest"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"map"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelIds"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelIds"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
            <span class="hljs-attr">target</span>=<span class="hljs-string">"settings"</span> 
            <span class="hljs-attr">source</span>=<span class="hljs-string">"include?:{'hotelFacilityNew','hotelPolicysNew','breakfast','importantNotices','parking'}"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"header"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"map"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"partnerCode"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"P10000001"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"requestType"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"createOrder"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"signature"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${signature}"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"timestamp"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"${currentTime}"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"gzip"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-64">ä½¿ç”¨ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotelQueryService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;
    
    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">buildQueryRequest</span><span class="hljs-params">(HotelQueryDTO query)</span> {
        <span class="hljs-comment">// å‡†å¤‡ä¸Šä¸‹æ–‡å˜é‡</span>
        Map&lt;String, Object&gt; context = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        context.put(<span class="hljs-string">"signature"</span>, generateSignature(query));
        context.put(<span class="hljs-string">"currentTime"</span>, System.currentTimeMillis());

        <span class="hljs-comment">// æ‰§è¡Œè½¬æ¢</span>
        ObjectTransfer&lt;Object, Object&gt; transfer =
            transferBuilder.buildObjectTransfer(<span class="hljs-string">"hotel-query-request"</span>, context);
        <span class="hljs-keyword">return</span> (Map&lt;String, Object&gt;) transfer.transfer(query);
    }
    
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">generateSignature</span><span class="hljs-params">(HotelQueryDTO query)</span> {
        <span class="hljs-comment">// ç­¾åé€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"generated-signature"</span>;
    }
}
</code></pre>
<h3 data-id="heading-65">6.5 æ¡ˆä¾‹ 5ï¼šå¤æ‚åµŒå¥—å’Œæ•°ç»„å±•å¹³</h3>
<h4 data-id="heading-66">åœºæ™¯</h4>
<p>å°†å¤æ‚çš„ç¬¬ä¸‰æ–¹é…’åº—å“åº”è½¬æ¢ä¸ºå†…éƒ¨æ ¼å¼ï¼Œå±•ç¤ºæ·±å±‚åµŒå¥—å¯¹è±¡æ˜ å°„ã€æ•°ç»„ç´¢å¼•è®¿é—®ã€å¤æ‚ SpEL è¡¨è¾¾å¼ç­‰é«˜çº§ç”¨æ³•ã€‚</p>
<h4 data-id="heading-67">é…ç½®æ–‡ä»¶ï¼ˆåŸºäºå®é™…é¡¹ç›® qcc.xmlï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.hotel.detail.HotelDetailResponse"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotel-complex-mapping"</span>
    <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"https://hongri.com.cn/mapping https://hongri.com.cn/path/to/mapping.xsd"</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- é€šç”¨ä¿¡æ¯å“åº” --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"returnCode"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"returnMsg"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- é…’åº—ä¿¡æ¯æ•°ç»„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
        <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> 
        <span class="hljs-attr">source</span>=<span class="hljs-string">"bussinessResponse.hotelInfos"</span> 
        <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.hotel.detail.HotelDetailResult"</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- é…’åº—ID --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelId"</span>/&gt;</span>
        
        <span class="hljs-comment">&lt;!-- åŸºç¡€ä¿¡æ¯å¯¹è±¡ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"baseInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- é…’åº—åç§° --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelName"</span>/&gt;</span>
            <span class="hljs-comment">&lt;!-- é…’åº—è‹±æ–‡åç§° --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"nameEn"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelEngName"</span>/&gt;</span>
            <span class="hljs-comment">&lt;!-- é…’åº—ç”µè¯ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"phone"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"telephone"</span>/&gt;</span>
            <span class="hljs-comment">&lt;!-- æ˜¯å¦å¯é¢„å®š - ä½¿ç”¨å›ºå®šå€¼ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"bookable"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- åœ°å€ä¿¡æ¯ - å¤šå±‚åµŒå¥—å¯¹è±¡ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.country.code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"countryCode"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.city.code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"city"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.city.name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"cityName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.area.code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"city"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.area.name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"cityName"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- ä½¿ç”¨ current ä¼ é€’å½“å‰å¯¹è±¡ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.addressLine.name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"cityName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.addressLine.nameEn"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"cityName"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- å•†åœˆä¿¡æ¯ - ä½¿ç”¨æ•°ç»„ç´¢å¼• --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.businessDistricts[0].code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"business"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.businessDistricts[0].name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"businessName"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- åæ ‡ä¿¡æ¯ - æ•°ç»„ç´¢å¼• --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.coordinates[0].longitude"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"longitude"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.coordinates[0].latitude"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"latitude"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- è¯¦ç»†ä¿¡æ¯å¯¹è±¡ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"detailInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- å¼€ä¸šæ—¶é—´ - å›ºå®šå€¼ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"openDate"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2011/01"</span>/&gt;</span>
            <span class="hljs-comment">&lt;!-- è£…ä¿®æ—¶é—´ - å›ºå®šå€¼ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"decorationDate"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2020/05"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- é…’åº—ä»‹ç» --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"hotelIntroduce"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- ç»Ÿè®¡ä¿¡æ¯ - ä½¿ç”¨æ•°ç»„ç´¢å¼• --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[0].type"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"FLOOR_COUNT"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[0].value"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[1].type"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ROOM_COUNT"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[1].value"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[2].type"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"MEETING_ROOM_COUNT"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[2].value"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[3].type"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"RESTAURANT_COUNT"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"statistics[3].value"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"4"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- è¯„åˆ†ä¿¡æ¯ - ä½¿ç”¨æ•°ç»„ç´¢å¼• --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"ratings[0].type"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"AVG_SCORE"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"ratings[0].value"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"47"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- è¥ä¸šæ—¶é—´ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"openHours"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"1"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æˆ¿é—´ä¿¡æ¯æ•°ç»„ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
            <span class="hljs-attr">target</span>=<span class="hljs-string">"roomInfos"</span> 
            <span class="hljs-attr">source</span>=<span class="hljs-string">"current.roomInfos"</span> 
            <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.hotel.detail.RoomInfo"</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- ä½¿ç”¨ _ è®¿é—®çˆ¶çº§çš„çˆ¶çº§å¯¹è±¡çš„ hotelId --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"_._.hotelId"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æˆ¿é—´åŸºæœ¬ä¿¡æ¯ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"realRoomId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomId"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"nameEn"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomEngName"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"useAbleArea"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomAcreage"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"floor"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"roomFloor"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æ˜¯å¦å…è®¸åŠ åºŠ - ä½¿ç”¨ SpEL è¡¨è¾¾å¼ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"allowExtraBed"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"addBedflag &gt; 0"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- ç½‘ç»œç±»å‹ - å›ºå®šå€¼ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"internetAccess"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"3"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æˆ¿é—´å®¹çº³äººæ•° --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"occupancy"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"maxPerson"</span>/&gt;</span>
            
            <span class="hljs-comment">&lt;!-- 
                åºŠç»„ä¿¡æ¯ - å¤æ‚çš„ SpEL è¡¨è¾¾å¼
                ä½¿ç”¨ flatMap å¤šå±‚å±•å¹³åµŒå¥—æ•°ç»„
            --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
                <span class="hljs-attr">target</span>=<span class="hljs-string">"bedGroups"</span> 
                <span class="hljs-attr">source</span>=<span class="hljs-string">"#flatMap((#flatMap(#flatMap(roomBedTypeInfos.roomBeds.![bedGroups]))).![bedInfos])"</span> 
                <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.citicbank.btsphs.laas.api.tmc.dto.hotel.detail.BedGroup"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"type"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"bedName"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"bedWidth"</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"count"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"bedNum"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-68">å…³é”®æŠ€æœ¯ç‚¹è¯´æ˜</h4>
<p><strong>1. å¤šå±‚åµŒå¥—å¯¹è±¡æ˜ å°„</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.country.code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"countryCode"</span>/&gt;</span>
</code></pre>
<p>æ”¯æŒç›´æ¥ä½¿ç”¨ç‚¹å·åˆ†éš”çš„è·¯å¾„æ¥è®¿é—®å¤šå±‚åµŒå¥—å¯¹è±¡ã€‚</p>
<p><strong>2. æ•°ç»„ç´¢å¼•è®¿é—®</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"address.businessDistricts[0].code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"business"</span>/&gt;</span>
</code></pre>
<p>å¯ä»¥ç›´æ¥è®¿é—®æ•°ç»„æˆ– List çš„æŒ‡å®šç´¢å¼•å…ƒç´ ã€‚</p>
<p><strong>3. è·¨å±‚çº§è®¿é—®ï¼ˆä½¿ç”¨ <code>_</code>ï¼‰</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"_._.hotelId"</span>/&gt;</span>
</code></pre>
<p><code>_</code> è¡¨ç¤ºå½“å‰å¯¹è±¡çš„çˆ¶çº§å¯¹è±¡ï¼Œ<code>_._</code> è¡¨ç¤ºçˆ¶çº§çš„çˆ¶çº§å¯¹è±¡ã€‚</p>
<p><strong>4. å½“å‰å¯¹è±¡å¼•ç”¨ï¼ˆä½¿ç”¨ <code>current</code>ï¼‰</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"baseInfo"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"current"</span>&gt;</span>
</code></pre>
<p><code>current</code> è¡¨ç¤ºå½“å‰æ­£åœ¨å¤„ç†çš„å¤–å±‚å¯¹è±¡ã€‚</p>
<p><strong>5. å¤æ‚ SpEL è¡¨è¾¾å¼ - flatMap</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> 
    <span class="hljs-attr">target</span>=<span class="hljs-string">"bedGroups"</span> 
    <span class="hljs-attr">source</span>=<span class="hljs-string">"#flatMap((#flatMap(#flatMap(roomBedTypeInfos.roomBeds.![bedGroups]))).![bedInfos])"</span> 
    <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.BedGroup"</span>&gt;</span>
</code></pre>
<p>ä½¿ç”¨ SpEL çš„ <code>flatMap</code> å’ŒæŠ•å½±æ“ä½œç¬¦ <code>![...]</code> æ¥å±•å¹³å¤æ‚çš„åµŒå¥—æ•°ç»„ç»“æ„ã€‚</p>
<p><strong>6. æ¡ä»¶è¡¨è¾¾å¼</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"allowExtraBed"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"addBedflag &gt; 0"</span>/&gt;</span>
</code></pre>
<p>ä½¿ç”¨ SpEL è¡¨è¾¾å¼è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚</p>
<hr/>
<h2 data-id="heading-69">ä¸ƒã€æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-70">7.1 é…ç½®æ–‡ä»¶ç»„ç»‡</h3>
<h4 data-id="heading-71">æ¨èçš„ç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-bash" lang="bash">src/main/resources/
â””â”€â”€ mappingConfiguration/
    â”œâ”€â”€ hotel/                          <span class="hljs-comment"># é…’åº—ç›¸å…³é…ç½®</span>
    â”‚   â”œâ”€â”€ hotel-request-req.xml      <span class="hljs-comment"># é…’åº—æŸ¥è¯¢è¯·æ±‚</span>
    â”‚   â”œâ”€â”€ hotel-detail-res.xml       <span class="hljs-comment"># é…’åº—è¯¦æƒ…å“åº”</span>
    â”‚   â””â”€â”€ hotel-search-res.xml       <span class="hljs-comment"># é…’åº—æœç´¢å“åº”</span>
    â”œâ”€â”€ order/                          <span class="hljs-comment"># è®¢å•ç›¸å…³é…ç½®</span>
    â”‚   â”œâ”€â”€ order-create-req.xml
    â”‚   â”œâ”€â”€ order-detail-res.xml
    â”‚   â””â”€â”€ order-list-res.xml
    â””â”€â”€ common/                         <span class="hljs-comment"># é€šç”¨é…ç½®</span>
        â””â”€â”€ common-mapping.xml
</code></pre>
<h4 data-id="heading-72">å‘½åè§„èŒƒ</h4>
<ul>
<li><strong>è¯·æ±‚é…ç½®</strong>ï¼š<code>{service}-{method}-req.xml</code></li>
<li><strong>å“åº”é…ç½®</strong>ï¼š<code>{service}-{method}-res.xml</code></li>
<li><strong>Namespace</strong>ï¼š<code>{service}@{method}@{type}</code>ï¼ˆtype ä¸º req/resï¼‰</li>
</ul>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.HotelDetailResponse"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotelService@getDetail@res"</span>&gt;</span>
    ...
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-73">7.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<h4 data-id="heading-74">1. é¿å…æ·±å±‚åµŒå¥—</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä¸æ¨èï¼šè¿‡æ·±çš„åµŒå¥— --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"a"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"b"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"c"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"d"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"value"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"source"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ¨èï¼šä½¿ç”¨è·¯å¾„ç›´æ¥è®¿é—® --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"a.b.c.d.value"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"source"</span>/&gt;</span>
</code></pre>
<h4 data-id="heading-75">2. ç®€åŒ– SpEL è¡¨è¾¾å¼</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä¸æ¨èï¼šå¤æ‚çš„ SpEL --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> 
    <span class="hljs-attr">target</span>=<span class="hljs-string">"status"</span> 
    <span class="hljs-attr">source</span>=<span class="hljs-string">"(orderStatus == 1 and paymentStatus == 2 and stock &gt; 0) ? 'å¯é¢„è®¢' : 'ä¸å¯é¢„è®¢'"</span>/&gt;</span>

<span class="hljs-comment">&lt;!-- æ¨èï¼šæ‹†åˆ†ä¸ºå¤šä¸ªç®€å•è¡¨è¾¾å¼æˆ–ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•° --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"#determineBookingStatus(orderStatus, paymentStatus, stock)"</span>/&gt;</span>
</code></pre>
<h4 data-id="heading-76">3. ä½¿ç”¨ Map ä½œä¸ºä¸­é—´å¯¹è±¡</h4>
<p>å½“è¿”å›å¯¹è±¡éå¸¸å¤æ‚æ—¶ï¼Œå¯ä»¥å°†å“åº”è½¬æ¢ä¸º Map ä»¥æé«˜æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"map"</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"complex-response"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"field1"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"data.field1"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"field2"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"data.field2"</span>/&gt;</span>
    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<p>ç¨‹åºä¼šè‡ªåŠ¨å°† Map å¤åˆ¶åˆ°å¯¹åº”çš„å®ä½“ç±»ä¸Šã€‚</p>
<h4 data-id="heading-77">4. ç¼“å­˜ ObjectTransfer å®ä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ConfigurationObjectTransferBuilder transferBuilder;
    
    <span class="hljs-comment">// ç¼“å­˜ ObjectTransfer å®ä¾‹</span>
    <span class="hljs-keyword">private</span> ObjectTransfer&lt;Object, Object&gt; orderDetailTransfer;
    
    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        orderDetailTransfer = transferBuilder.buildObjectTransfer(<span class="hljs-string">"order-detail-mapping"</span>);
    }
    
    <span class="hljs-keyword">public</span> OrderDetailVO <span class="hljs-title function_">getOrderDetail</span><span class="hljs-params">(String orderId)</span> {
        <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„å®ä¾‹</span>
        <span class="hljs-keyword">return</span> (OrderDetailVO) orderDetailTransfer.transfer(...);
    }
}
</code></pre>
<h3 data-id="heading-78">7.3 é”™è¯¯å¤„ç†</h3>
<h4 data-id="heading-79">1. åœ¨è½¬æ¢å™¨ä¸­æ•è·å¼‚å¸¸</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeTypeConverter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TypeConverter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">convert</span><span class="hljs-params">(Object source, Class&lt;?&gt; targetType)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è½¬æ¢é€»è¾‘</span>
            <span class="hljs-keyword">return</span> doConvert(source, targetType);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"ç±»å‹è½¬æ¢å¤±è´¥: source={}, target={}"</span>, source, targetType, e);
            <span class="hljs-comment">// è¿”å›é»˜è®¤å€¼æˆ– null</span>
            <span class="hljs-keyword">return</span> getDefaultValue(targetType);
        }
    }
}
</code></pre>
<h2 data-id="heading-80">å…«ã€é«˜çº§åŠŸèƒ½</h2>
<h3 data-id="heading-81">8.1 ä½¿ç”¨é…ç½®ç”Ÿæˆå™¨</h3>
<p>æ¡†æ¶æä¾›äº†é…ç½®ç”Ÿæˆå™¨ï¼Œå¯ä»¥æ ¹æ®ç›®æ ‡ç±»è‡ªåŠ¨ç”Ÿæˆ XML é…ç½®æ¨¡æ¿ã€‚</p>
<h4 data-id="heading-82">ClassMappingConfigGenerator</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigGeneratorExample</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// ç”Ÿæˆé…ç½®</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> ClassMappingConfigGenerator.generateConfig(
            HotelDetailResponse.class, 
            <span class="hljs-string">"hotel-detail-auto"</span>
        );
        
        <span class="hljs-comment">// ä¿å­˜åˆ°æ–‡ä»¶</span>
        <span class="hljs-type">Path</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> Paths.get(<span class="hljs-string">"src/main/resources/mappingConfiguration/hotel-detail-auto.xml"</span>);
        Files.write(path, config.getBytes(StandardCharsets.UTF_8));
        
        System.out.println(<span class="hljs-string">"é…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: "</span> + path);
    }
}
</code></pre>
<p>ç”Ÿæˆçš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappingConfiguration</span> 
    <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"https://hongri.com.cn/mapping"</span>
    <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.HotelDetailResponse"</span>
    <span class="hljs-attr">namespace</span>=<span class="hljs-string">"hotel-detail-auto"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"code"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">object-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"data"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span> <span class="hljs-attr">target-class</span>=<span class="hljs-string">"com.example.HotelData"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotels"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span> <span class="hljs-attr">item-class</span>=<span class="hljs-string">"com.example.HotelInfo"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- è‡ªåŠ¨ç”Ÿæˆçš„å­—æ®µæ˜ å°„ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelId"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">field-mapping</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"hotelName"</span> <span class="hljs-attr">source</span>=<span class="hljs-string">""</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">object-mapping</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappingConfiguration</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-83">ä¹ã€å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-84">9.1 é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥</h3>
<p><strong>é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Caused by: com.hongri.copier.exception.MappingConfigurationException: 
Cannot find mapping configuration: <span class="hljs-keyword">namespace</span>-name
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¡®è®¤ XML æ–‡ä»¶åœ¨ <code>classpath:mappingConfiguration/</code> ç›®å½•ä¸‹</li>
<li>ç¡®è®¤ <code>namespace</code> å±æ€§å€¼ä¸ä»£ç ä¸­ä½¿ç”¨çš„ä¸€è‡´</li>
<li>æ£€æŸ¥ XML æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®</li>
</ol>
<h3 data-id="heading-85">9.2 ç±»å‹è½¬æ¢é”™è¯¯</h3>
<p><strong>é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">Caused by: com.hongri.copier.exception.BeanCopierException: 
Type conversion failed: <span class="hljs-attr">source</span>=xxx, target=yyy
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>å®ç°è‡ªå®šä¹‰ <code>TypeConverter</code> å¤„ç†ç‰¹æ®Šç±»å‹è½¬æ¢</li>
<li>åœ¨ XML ä¸­æŒ‡å®š <code>converter-class</code> å±æ€§</li>
<li>æ£€æŸ¥æºå€¼å’Œç›®æ ‡ç±»å‹æ˜¯å¦å…¼å®¹</li>
</ol>
<h3 data-id="heading-86">9.3 SpEL è¡¨è¾¾å¼è§£æå¤±è´¥</h3>
<p><strong>é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">org.springframework.expression.spel.SpelParseException: 
Expression cannot <span class="hljs-keyword">start</span> <span class="hljs-keyword">with</span> <span class="hljs-string">'#'</span> <span class="hljs-keyword">at</span> position <span class="hljs-number">0</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>SpEL è¡¨è¾¾å¼åº”è¯¥æ”¾åœ¨ <code>source</code> å±æ€§ä¸­ï¼Œè€Œé <code>value</code></li>
<li>ç¡®ä¿è¡¨è¾¾å¼è¯­æ³•æ­£ç¡®</li>
<li>ä½¿ç”¨ <code>#</code> å‰ç¼€æ ‡è¯† SpEL è¡¨è¾¾å¼</li>
</ol>
<h3 data-id="heading-87">9.4 åµŒå¥—å¯¹è±¡ä¸º null</h3>
<p><strong>é—®é¢˜ï¼š</strong>
è½¬æ¢è¿‡ç¨‹ä¸­ï¼ŒåµŒå¥—å¯¹è±¡çš„å­—æ®µæ²¡æœ‰è¢«èµ‹å€¼ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¡®è®¤æºå¯¹è±¡ä¸­åµŒå¥—å¯¹è±¡ä¸ä¸º null</li>
<li>ä½¿ç”¨ <code>?:</code> æ“ä½œç¬¦æä¾›é»˜è®¤å€¼ï¼š<code>source="data?.name"</code></li>
<li>åœ¨ XML é…ç½®ä¸­æ˜¾å¼åˆ›å»ºåµŒå¥—å¯¹è±¡</li>
</ol>
<h3 data-id="heading-88">9.5 æ€§èƒ½é—®é¢˜</h3>
<p><strong>é—®é¢˜ï¼š</strong>
å¯¹è±¡è½¬æ¢é€Ÿåº¦æ…¢ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¼“å­˜ <code>ObjectTransfer</code> å®ä¾‹ï¼Œé¿å…é‡å¤åˆ›å»º</li>
<li>å‡å°‘æ·±å±‚åµŒå¥—ï¼Œä½¿ç”¨è·¯å¾„ç›´æ¥è®¿é—®</li>
<li>ç®€åŒ– SpEL è¡¨è¾¾å¼</li>
<li>å¯¹äºå¤æ‚å¯¹è±¡ï¼Œè€ƒè™‘è½¬æ¢ä¸º Map ä¸­é—´æ ¼å¼</li>
<li>è°ƒæ•´ ReflectASM çš„ç¼“å­˜ç­–ç•¥</li>
</ol>
<h3 data-id="heading-89">9.6 é›†åˆæ˜ å°„é—®é¢˜</h3>
<p><strong>é—®é¢˜ï¼š</strong>
é›†åˆæ˜ å°„åå…ƒç´ ä¸¢å¤±æˆ–é¡ºåºé”™è¯¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¡®è®¤ <code>item-class</code> å±æ€§æ­£ç¡®</li>
<li>æ£€æŸ¥æºé›†åˆæ˜¯å¦ä¸º null</li>
<li>ä½¿ç”¨ <code>?:</code> æä¾›é»˜è®¤ç©ºé›†åˆï¼š<code>source="items?:#{}"</code></li>
<li>ç¡®è®¤ç›®æ ‡é›†åˆç±»å‹æ”¯æŒï¼ˆListã€Setã€æ•°ç»„ï¼‰</li>
</ol>
<h3 data-id="heading-90">9.7 Spring Boot é›†æˆé—®é¢˜</h3>
<p><strong>é—®é¢˜ï¼š</strong>
<code>ConfigurationObjectTransferBuilder</code> æ— æ³•è‡ªåŠ¨æ³¨å…¥ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¡®è®¤å¼•å…¥äº† <code>bean-transfer-starter</code> ä¾èµ–</li>
<li>æ£€æŸ¥ <code>@SpringBootApplication</code> çš„æ‰«æèŒƒå›´</li>
<li>ç¡®è®¤é…ç½®æ–‡ä»¶åœ¨ classpath ä¸­</li>
<li>æ‰‹åŠ¨åˆ›å»º Beanï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ManualConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ConfigurationObjectTransferBuilder <span class="hljs-title function_">transferBuilder</span><span class="hljs-params">(
            BeanCopierConfiguration config,
            MappingConfigurationFactory factory)</span> {
        <span class="hljs-type">ConfigurationObjectTransferBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationObjectTransferBuilder</span>();
        builder.setBeanCopierConfiguration(config);
        builder.setMappingConfigurationFactory(factory);
        <span class="hljs-keyword">return</span> builder;
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆChatGPTèƒ½"æ‰“å­—"ç»™ä½ çœ‹ï¼Ÿä»Bufferç†è§£AIæµå¼è¾“å‡º]]></title>    <link>https://juejin.cn/post/7603653885601808434</link>    <guid>https://juejin.cn/post/7603653885601808434</guid>    <pubDate>2026-02-07T08:18:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601808434" data-draft-id="7603575763787579418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆChatGPTèƒ½&quot;æ‰“å­—&quot;ç»™ä½ çœ‹ï¼Ÿä»Bufferç†è§£AIæµå¼è¾“å‡º"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T08:18:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆChatGPTèƒ½"æ‰“å­—"ç»™ä½ çœ‹ï¼Ÿä»Bufferç†è§£AIæµå¼è¾“å‡º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:18:58.000Z" title="Sat Feb 07 2026 08:18:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»€ä¹ˆæ˜¯Bufferï¼Ÿ</h2>
<p>Bufferï¼ˆç¼“å†²åŒºï¼‰æ˜¯è®¡ç®—æœºå†…å­˜ä¸­ç”¨äºä¸´æ—¶å­˜å‚¨æ•°æ®çš„ä¸€å—åŒºåŸŸã€‚æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨ç”¨æ¯å­æ¥æ°´é¾™å¤´çš„æ°´ï¼šæ°´é¾™å¤´ç›´æ¥æµåˆ°æ¯å­é‡Œï¼Œå¦‚æœæ°´æµå¤ªå¿«ï¼Œæ¯å­å¯èƒ½ä¼šæº¢å‡ºã€‚ä½†å¦‚æœä½ åœ¨ä¸­é—´æ”¾ä¸€ä¸ªæ°´å£¶ï¼ˆç¼“å†²åŒºï¼‰ï¼Œæ°´å…ˆæµåˆ°æ°´å£¶é‡Œï¼Œå†ä»æ°´å£¶å€’åˆ°æ¯å­é‡Œï¼Œæ•´ä¸ªè¿‡ç¨‹å°±æ›´åŠ å¯æ§äº†ã€‚</p>
<p>åœ¨JavaScriptä¸­ï¼ŒBufferå°±æ˜¯é‚£ä¸ª"æ°´å£¶"â€”â€”å®ƒå¸®åŠ©æˆ‘ä»¬åœ¨å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€ç½‘ç»œä¼ è¾“ç­‰ï¼‰æ—¶æ›´åŠ é«˜æ•ˆå’Œå¯æ§ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦Bufferï¼Ÿ</h2>
<h3 data-id="heading-2">1. æ–‡æœ¬ vs äºŒè¿›åˆ¶</h3>
<p>è®¡ç®—æœºä¸­ä¸€åˆ‡æ•°æ®æœ€ç»ˆéƒ½ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨ï¼Œä½†æˆ‘ä»¬åœ¨ç¼–ç¨‹æ—¶é€šå¸¸å¤„ç†çš„æ˜¯æ–‡æœ¬ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚å½“éœ€è¦å¤„ç†éæ–‡æœ¬æ•°æ®æ—¶ï¼Œå°±éœ€è¦Bufferã€‚</p>
<p><strong>ç”Ÿæ´»æ¯”å–»</strong>ï¼šå°±åƒå¿«é€’è¿è¾“ï¼Œæ–‡æœ¬æ•°æ®å°±åƒæ˜ä¿¡ç‰‡ï¼Œå†…å®¹ç›´æ¥å¯è§ï¼›äºŒè¿›åˆ¶æ•°æ®å°±åƒå¯†å°çš„åŒ…è£¹ï¼Œä½ éœ€è¦ä¸“é—¨çš„å·¥å…·ï¼ˆBufferï¼‰æ¥æŸ¥çœ‹å’Œå¤„ç†é‡Œé¢çš„å†…å®¹ã€‚</p>
<h3 data-id="heading-3">2. æ•ˆç‡é—®é¢˜</h3>
<p>ç›´æ¥æ“ä½œäºŒè¿›åˆ¶æ•°æ®æ¯”æ“ä½œå­—ç¬¦ä¸²æ›´é«˜æ•ˆï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚</p>
<h2 data-id="heading-4">HTML5ä¸­çš„Bufferæ“ä½œ</h2>
<h3 data-id="heading-5">1. TextEncoder å’Œ TextDecoder</h3>
<p>è¿™æ˜¯HTML5æä¾›çš„ç¼–ç /è§£ç å·¥å…·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¼–ç ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®</span>
<span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
<span class="hljs-keyword">const</span> myBuffer = encoder.<span class="hljs-title function_">encode</span>(<span class="hljs-string">'ä½ å¥½ HTML5'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myBuffer); <span class="hljs-comment">// Uint8Array(10) [228, 189, 160, 229, 165, 189, 32, 72, 84, 77, ...]</span>

<span class="hljs-comment">// è§£ç ï¼šå°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢å›å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
<span class="hljs-keyword">const</span> originalText = decoder.<span class="hljs-title function_">decode</span>(myBuffer);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(originalText); <span class="hljs-comment">// "ä½ å¥½ HTML5"</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šä¸­æ–‡å­—ç¬¦é€šå¸¸å ç”¨3ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡å­—ç¬¦å ç”¨1ä¸ªå­—èŠ‚ï¼Œç©ºæ ¼ä¹Ÿæ˜¯1ä¸ªå­—èŠ‚ã€‚</p>
<h3 data-id="heading-6">2. ArrayBuffer - åŸå§‹çš„äºŒè¿›åˆ¶ç¼“å†²åŒº</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª12å­—èŠ‚çš„ç¼“å†²åŒºï¼ˆå°±åƒç”³è¯·ä¸€å—12æ ¼çš„å†…å­˜ç©ºé—´ï¼‰</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">12</span>);

<span class="hljs-comment">// ä½†ArrayBufferæœ¬èº«ä¸èƒ½ç›´æ¥æ“ä½œï¼Œéœ€è¦è§†å›¾ï¼ˆViewï¼‰æ¥è¯»å†™</span>
</code></pre>
<h3 data-id="heading-7">3. è§†å›¾ï¼ˆTypedArrayï¼‰- æ“ä½œç¼“å†²åŒºçš„"çœ¼é•œ"</h3>
<p>ArrayBufferå°±åƒä¸€å—ç©ºç™½ç”»å¸ƒï¼Œè€ŒTypedArrayå°±æ˜¯ä¸åŒé¢œè‰²çš„ç”»ç¬”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">16</span>); <span class="hljs-comment">// 16å­—èŠ‚çš„ç¼“å†²åŒº</span>

<span class="hljs-comment">// ä¸åŒçš„è§†å›¾ç±»å‹ï¼Œç”¨ä¸åŒçš„æ–¹å¼"çœ‹å¾…"åŒä¸€å—å†…å­˜</span>
<span class="hljs-keyword">const</span> uint8View = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);   <span class="hljs-comment">// è§†ä¸º8ä½æ— ç¬¦å·æ•´æ•°ï¼ˆ0-255ï¼‰</span>
<span class="hljs-keyword">const</span> uint16View = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint16Array</span>(buffer); <span class="hljs-comment">// è§†ä¸º16ä½æ— ç¬¦å·æ•´æ•°</span>
<span class="hljs-keyword">const</span> int32View = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Int32Array</span>(buffer);   <span class="hljs-comment">// è§†ä¸º32ä½æœ‰ç¬¦å·æ•´æ•°</span>

<span class="hljs-comment">// ä½¿ç”¨Uint8Arrayè§†å›¾æ“ä½œæ•°æ®</span>
<span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
<span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
<span class="hljs-keyword">const</span> data = encoder.<span class="hljs-title function_">encode</span>(<span class="hljs-string">'Hello'</span>);

<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++) {
    view[i] = data[i]; <span class="hljs-comment">// å°†æ•°æ®å¤åˆ¶åˆ°ç¼“å†²åŒº</span>
}
</code></pre>
<h2 data-id="heading-8">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-9">1. æµå¼æ•°æ®å¤„ç†ï¼ˆAIå“åº”ç¤ºä¾‹ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹ŸAIæµå¼è¾“å‡º</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">simulateAIStreaming</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> responses = [<span class="hljs-string">"æ€è€ƒ"</span>, <span class="hljs-string">"ä¸­"</span>, <span class="hljs-string">"è¯·"</span>, <span class="hljs-string">"ç¨"</span>, <span class="hljs-string">"å€™"</span>];
    <span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">100</span>);
    <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
    
    <span class="hljs-keyword">let</span> position = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> word <span class="hljs-keyword">of</span> responses) {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">500</span>));
        
        <span class="hljs-comment">// å°†æ¯ä¸ªè¯ç¼–ç å¹¶æ·»åŠ åˆ°ç¼“å†²åŒº</span>
        <span class="hljs-keyword">const</span> encoded = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(word);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; encoded.<span class="hljs-property">length</span>; i++) {
            view[position++] = encoded[i];
        }
        
        <span class="hljs-comment">// å®æ—¶è§£ç å·²æ¥æ”¶çš„éƒ¨åˆ†</span>
        <span class="hljs-keyword">const</span> receivedSoFar = decoder.<span class="hljs-title function_">decode</span>(view.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, position));
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å·²æ¥æ”¶: <span class="hljs-subst">${receivedSoFar}</span>`</span>);
    }
}

<span class="hljs-comment">// è¿™å°±æ˜¯streaming:trueçš„æ•ˆæœâ€”â€”è¾¹ç”Ÿæˆè¾¹æ˜¾ç¤º</span>
</code></pre>
<h3 data-id="heading-10">2. æ–‡ä»¶å¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯»å–å›¾ç‰‡æ–‡ä»¶å¹¶è·å–å…¶äºŒè¿›åˆ¶æ•°æ®</span>
fileInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">async</span> (event) =&gt; {
    <span class="hljs-keyword">const</span> file = event.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">arrayBuffer</span>(); <span class="hljs-comment">// è·å–æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®</span>
    
    <span class="hljs-comment">// ç°åœ¨å¯ä»¥æ“ä½œè¿™ä¸ªbuffer</span>
    <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ–‡ä»¶å¤§å°: <span class="hljs-subst">${buffer.byteLength}</span> å­—èŠ‚`</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å‰10ä¸ªå­—èŠ‚: <span class="hljs-subst">${view.slice(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)}</span>`</span>);
});
</code></pre>
<h2 data-id="heading-11">å…³é”®æ¦‚å¿µå¯¹æ¯”</h2>



































<table><thead><tr><th>æ¦‚å¿µ</th><th>æ¯”å–»</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>ArrayBuffer</td><td>ç©ºç™½çš„å†…å­˜ç©ºé—´</td><td>åˆ†é…ä¸€å—åŸå§‹äºŒè¿›åˆ¶å†…å­˜</td></tr><tr><td>TypedArray</td><td>æœ‰åˆ»åº¦çš„é‡æ¯</td><td>ä»¥ç‰¹å®šæ ¼å¼ï¼ˆå¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ï¼‰è¯»å–/å†™å…¥æ•°æ®</td></tr><tr><td>DataView</td><td>å¤šåŠŸèƒ½æµ‹é‡å·¥å…·</td><td>æ›´çµæ´»åœ°è¯»å†™ä¸åŒæ ¼å¼çš„æ•°æ®</td></tr><tr><td>TextEncoder</td><td>æ‰“åŒ…æœº</td><td>å°†æ–‡æœ¬æ‰“åŒ…æˆäºŒè¿›åˆ¶</td></tr><tr><td>TextDecoder</td><td>æ‹†åŒ…æœº</td><td>å°†äºŒè¿›åˆ¶è§£åŒ…æˆæ–‡æœ¬</td></tr></tbody></table>
<h2 data-id="heading-12">å¸¸è§TypedArrayç±»å‹</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸åŒ"çœ¼é•œ"çœ‹åŒä¸€æ•°æ®çš„ä¸åŒæ•ˆæœ</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">16</span>);
<span class="hljs-keyword">const</span> data = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];

<span class="hljs-comment">// ä½¿ç”¨Uint8Arrayï¼šæ¯ä¸ªæ•°å­—å 1å­—èŠ‚</span>
<span class="hljs-keyword">const</span> uint8 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
uint8.<span class="hljs-title function_">set</span>(data);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uint8); <span class="hljs-comment">// [1, 2, 3, 4, 0, 0, ...]</span>

<span class="hljs-comment">// ä½¿ç”¨Uint16Arrayï¼šæ¯ä¸ªæ•°å­—å 2å­—èŠ‚</span>
<span class="hljs-keyword">const</span> uint16 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint16Array</span>(buffer);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uint16); <span class="hljs-comment">// [513, 1027, 0, 0, ...] </span>
<span class="hljs-comment">// ä¸ºä»€ä¹ˆæ˜¯513ï¼Ÿå› ä¸º1+2*256=513ï¼ˆå°ç«¯åºå­˜å‚¨ï¼‰</span>
</code></pre>
<h2 data-id="heading-13">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<ol>
<li><strong>å¤ç”¨Buffer</strong>ï¼šé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯Buffer</li>
<li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼šä½¿ç”¨<code>set()</code>æ–¹æ³•è€Œä¸æ˜¯å¾ªç¯èµ‹å€¼</li>
<li><strong>é€‚å½“å¤§å°</strong>ï¼šä¸è¦åˆ†é…è¿‡å¤§çš„Bufferï¼Œä¼šæµªè´¹å†…å­˜</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼˜åŒ–ç¤ºä¾‹ï¼šæ‰¹é‡æ“ä½œ</span>
<span class="hljs-keyword">const</span> source = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
<span class="hljs-keyword">const</span> targetBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">10</span>);
<span class="hljs-keyword">const</span> targetView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(targetBuffer);

<span class="hljs-comment">// å¥½ï¼šæ‰¹é‡å¤åˆ¶</span>
targetView.<span class="hljs-title function_">set</span>(source);

<span class="hljs-comment">// ä¸å¥½ï¼šé€ä¸ªå¤åˆ¶</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; source.<span class="hljs-property">length</span>; i++) {
    targetView[i] = source[i];
}
</code></pre>
<h2 data-id="heading-14">æ€»ç»“</h2>
<p>Bufferæ˜¯JavaScriptå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„æ ¸å¿ƒå·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨ï¼š</p>
<ul>
<li>ç½‘ç»œé€šä¿¡ï¼ˆæµå¼ä¼ è¾“ï¼‰</li>
<li>æ–‡ä»¶æ“ä½œï¼ˆå›¾ç‰‡ã€éŸ³é¢‘å¤„ç†ï¼‰</li>
<li>åŠ å¯†ç®—æ³•</li>
<li>ä¸WebGLã€Web Audioç­‰APIäº¤äº’</li>
</ul>
<p><strong>è®°ä½è¿™ä¸ªæµç¨‹</strong>ï¼š
æ–‡æœ¬ â†’ TextEncoder â†’ äºŒè¿›åˆ¶ â†’ ArrayBuffer â†’ TypedArrayæ“ä½œ â†’ TextDecoder â†’ æ–‡æœ¬</p>
<p>å°±åƒå¿«é€’ç³»ç»Ÿï¼šå•†å“ï¼ˆæ•°æ®ï¼‰è¢«åŒ…è£…ï¼ˆç¼–ç ï¼‰â†’ è¿è¾“ï¼ˆäºŒè¿›åˆ¶ä¼ è¾“ï¼‰â†’ æ‹†åŒ…ï¼ˆè§£ç ï¼‰â†’ ä½¿ç”¨ã€‚</p>
<p>æŒæ¡Bufferæ“ä½œï¼Œä½ å°±æ‰“å¼€äº†JavaScriptå¤„ç†äºŒè¿›åˆ¶ä¸–ç•Œçš„å¤§é—¨ï¼</p>
<hr/>
<p><strong>å»¶ä¼¸å­¦ä¹ </strong>ï¼š</p>
<ol>
<li><code>Blob</code>å¯¹è±¡ï¼šæ–‡ä»¶ç›¸å…³çš„äºŒè¿›åˆ¶æ“ä½œ</li>
<li><code>Streams API</code>ï¼šæ›´é«˜çº§çš„æµå¼æ•°æ®å¤„ç†</li>
<li><code>WebSocket.binaryType</code>ï¼šç½‘ç»œé€šä¿¡ä¸­çš„äºŒè¿›åˆ¶ä¼ è¾“</li>
<li><code>Canvas</code>å›¾åƒæ•°æ®å¤„ç†ï¼š<code>getImageData()</code>è¿”å›çš„å°±æ˜¯Uint8ClampedArray</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[mongodb]pythonæ“ä½œmongodb]]></title>    <link>https://juejin.cn/post/7603567912593489947</link>    <guid>https://juejin.cn/post/7603567912593489947</guid>    <pubDate>2026-02-07T07:53:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603567912593489947" data-draft-id="7603567912593473563" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[mongodb]pythonæ“ä½œmongodb"/> <meta itemprop="keywords" content="NoSQL"/> <meta itemprop="datePublished" content="2026-02-07T07:53:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="import_random"/> <meta itemprop="url" content="https://juejin.cn/user/2013961033882312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [mongodb]pythonæ“ä½œmongodb
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961033882312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    import_random
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T07:53:41.000Z" title="Sat Feb 07 2026 07:53:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘æ¥æä¾›ä¸€ä¸ªå®Œæ•´çš„Pythonè¿æ¥æœ¬åœ°MongoDBçš„ç¤ºä¾‹ä»£ç ï¼ŒåŒ…å«åŸºæœ¬çš„CRUDæ“ä½œã€‚</p>
<h2 data-id="heading-0">1. é¦–å…ˆå®‰è£…å¿…è¦çš„åº“</h2>
<pre><code class="hljs language-bash" lang="bash">pip install pymongo
</code></pre>
<h2 data-id="heading-1">2. å®Œæ•´ç¤ºä¾‹ä»£ç </h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pymongo
<span class="hljs-keyword">from</span> pymongo <span class="hljs-keyword">import</span> MongoClient
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> bson <span class="hljs-keyword">import</span> ObjectId
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Any</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MongoDBManager</span>:
    <span class="hljs-string">"""MongoDBç®¡ç†ç±»"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">27017</span>, username=<span class="hljs-literal">None</span>, password=<span class="hljs-literal">None</span>, database_name=<span class="hljs-string">'mydatabase'</span></span>):
        <span class="hljs-string">"""
        åˆå§‹åŒ–MongoDBè¿æ¥
        
        Args:
            host: MongoDBä¸»æœºåœ°å€ï¼Œé»˜è®¤ä¸ºlocalhost
            port: MongoDBç«¯å£ï¼Œé»˜è®¤ä¸º27017
            username: ç”¨æˆ·åï¼ˆå¦‚æœæœ‰è®¤è¯ï¼‰
            password: å¯†ç ï¼ˆå¦‚æœæœ‰è®¤è¯ï¼‰
            database_name: æ•°æ®åº“åç§°
        """</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># æ„å»ºè¿æ¥å­—ç¬¦ä¸²</span>
            <span class="hljs-keyword">if</span> username <span class="hljs-keyword">and</span> password:
                <span class="hljs-comment"># æœ‰è®¤è¯çš„è¿æ¥</span>
                connection_string = <span class="hljs-string">f"mongodb://<span class="hljs-subst">{username}</span>:<span class="hljs-subst">{password}</span>@<span class="hljs-subst">{host}</span>:<span class="hljs-subst">{port}</span>/"</span>
                self.client = MongoClient(connection_string)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># æ— è®¤è¯çš„è¿æ¥ï¼ˆæœ¬åœ°å¼€å‘å¸¸ç”¨ï¼‰</span>
                self.client = MongoClient(host, port)
            
            <span class="hljs-comment"># æµ‹è¯•è¿æ¥</span>
            self.client.admin.command(<span class="hljs-string">'ping'</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… MongoDBè¿æ¥æˆåŠŸï¼"</span>)
            
            <span class="hljs-comment"># é€‰æ‹©æ•°æ®åº“</span>
            self.db = self.client[database_name]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“ å·²é€‰æ‹©æ•°æ®åº“: <span class="hljs-subst">{database_name}</span>"</span>)
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ MongoDBè¿æ¥å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">raise</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_databases</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“"""</span>
        databases = self.client.list_database_names()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“š æ‰€æœ‰æ•°æ®åº“:"</span>)
        <span class="hljs-keyword">for</span> db <span class="hljs-keyword">in</span> databases:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  - <span class="hljs-subst">{db}</span>"</span>)
        <span class="hljs-keyword">return</span> databases
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_collections</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ—å‡ºå½“å‰æ•°æ®åº“çš„æ‰€æœ‰é›†åˆ"""</span>
        collections = self.db.list_collection_names()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“‹ æ•°æ®åº“ '<span class="hljs-subst">{self.db.name}</span>' ä¸­çš„é›†åˆ:"</span>)
        <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> collections:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  - <span class="hljs-subst">{col}</span>"</span>)
        <span class="hljs-keyword">return</span> collections
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">insert_one</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, document: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        æ’å…¥å•ä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            document: è¦æ’å…¥çš„æ–‡æ¡£
            
        Returns:
            æ’å…¥çš„æ–‡æ¡£ID
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            result = collection.insert_one(document)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æ–‡æ¡£æ’å…¥æˆåŠŸï¼ŒID: <span class="hljs-subst">{result.inserted_id}</span>"</span>)
            <span class="hljs-keyword">return</span> result.inserted_id
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æ’å…¥å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">insert_many</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, documents: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]]</span>):
        <span class="hljs-string">"""
        æ’å…¥å¤šä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            documents: è¦æ’å…¥çš„æ–‡æ¡£åˆ—è¡¨
            
        Returns:
            æ’å…¥çš„æ–‡æ¡£IDåˆ—è¡¨
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            result = collection.insert_many(documents)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æ‰¹é‡æ’å…¥æˆåŠŸï¼Œå…± <span class="hljs-subst">{<span class="hljs-built_in">len</span>(result.inserted_ids)}</span> ä¸ªæ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> result.inserted_ids
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æ‰¹é‡æ’å…¥å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_all</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""
        æŸ¥è¯¢é›†åˆä¸­çš„æ‰€æœ‰æ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            
        Returns:
            æ–‡æ¡£åˆ—è¡¨
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            documents = <span class="hljs-built_in">list</span>(collection.find())
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æŸ¥è¯¢åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(documents)}</span> ä¸ªæ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> documents
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æŸ¥è¯¢å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_with_filter</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶
            
        Returns:
            åŒ¹é…çš„æ–‡æ¡£åˆ—è¡¨
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            documents = <span class="hljs-built_in">list</span>(collection.find(filter_query))
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æŸ¥è¯¢åˆ° <span class="hljs-subst">{<span class="hljs-built_in">len</span>(documents)}</span> ä¸ªåŒ¹é…çš„æ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> documents
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æ¡ä»¶æŸ¥è¯¢å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find_one</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        æŸ¥è¯¢å•ä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶
            
        Returns:
            å•ä¸ªæ–‡æ¡£æˆ–None
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            document = collection.find_one(filter_query)
            <span class="hljs-keyword">if</span> document:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… æ‰¾åˆ°åŒ¹é…çš„æ–‡æ¡£"</span>)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸  æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> document
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æŸ¥è¯¢å•ä¸ªæ–‡æ¡£å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_one</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>], update_data: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        æ›´æ–°å•ä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶
            update_data: æ›´æ–°æ•°æ®
            
        Returns:
            æ›´æ–°ç»“æœ
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            <span class="hljs-comment"># ä½¿ç”¨ $set æ“ä½œç¬¦æ›´æ–°æŒ‡å®šå­—æ®µ</span>
            result = collection.update_one(filter_query, {<span class="hljs-string">"$set"</span>: update_data})
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æ›´æ–°æˆåŠŸï¼ŒåŒ¹é…åˆ° <span class="hljs-subst">{result.matched_count}</span> ä¸ªæ–‡æ¡£ï¼Œä¿®æ”¹äº† <span class="hljs-subst">{result.modified_count}</span> ä¸ªæ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> result
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æ›´æ–°å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_one</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        åˆ é™¤å•ä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶
            
        Returns:
            åˆ é™¤ç»“æœ
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            result = collection.delete_one(filter_query)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… åˆ é™¤æˆåŠŸï¼Œåˆ é™¤äº† <span class="hljs-subst">{result.deleted_count}</span> ä¸ªæ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> result
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ åˆ é™¤å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_many</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>):
        <span class="hljs-string">"""
        åˆ é™¤å¤šä¸ªæ–‡æ¡£
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶
            
        Returns:
            åˆ é™¤ç»“æœ
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            result = collection.delete_many(filter_query)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… æ‰¹é‡åˆ é™¤æˆåŠŸï¼Œåˆ é™¤äº† <span class="hljs-subst">{result.deleted_count}</span> ä¸ªæ–‡æ¡£"</span>)
            <span class="hljs-keyword">return</span> result
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ æ‰¹é‡åˆ é™¤å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_index</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, field: <span class="hljs-built_in">str</span>, unique=<span class="hljs-literal">False</span></span>):
        <span class="hljs-string">"""
        åˆ›å»ºç´¢å¼•
        
        Args:
            collection_name: é›†åˆåç§°
            field: ç´¢å¼•å­—æ®µ
            unique: æ˜¯å¦å”¯ä¸€ç´¢å¼•
            
        Returns:
            ç´¢å¼•åç§°
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            index_result = collection.create_index([(field, pymongo.ASCENDING)], unique=unique)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… ç´¢å¼•åˆ›å»ºæˆåŠŸ: <span class="hljs-subst">{index_result}</span>"</span>)
            <span class="hljs-keyword">return</span> index_result
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ åˆ›å»ºç´¢å¼•å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">count_documents</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span>, filter_query: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>] = <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""
        ç»Ÿè®¡æ–‡æ¡£æ•°é‡
        
        Args:
            collection_name: é›†åˆåç§°
            filter_query: æŸ¥è¯¢æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
            
        Returns:
            æ–‡æ¡£æ•°é‡
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            <span class="hljs-keyword">if</span> filter_query:
                count = collection.count_documents(filter_query)
            <span class="hljs-keyword">else</span>:
                count = collection.count_documents({})
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“Š æ–‡æ¡£æ•°é‡: <span class="hljs-subst">{count}</span>"</span>)
            <span class="hljs-keyword">return</span> count
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ ç»Ÿè®¡å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">drop_collection</span>(<span class="hljs-params">self, collection_name: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""
        åˆ é™¤é›†åˆ
        
        Args:
            collection_name: é›†åˆåç§°
            
        Returns:
            True if successful, False otherwise
        """</span>
        <span class="hljs-keyword">try</span>:
            collection = self.db[collection_name]
            collection.drop()
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ—‘ï¸  é›†åˆ '<span class="hljs-subst">{collection_name}</span>' å·²åˆ é™¤"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ åˆ é™¤é›†åˆå¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">close_connection</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å…³é—­æ•°æ®åº“è¿æ¥"""</span>
        self.client.close()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ”Œ MongoDBè¿æ¥å·²å…³é—­"</span>)
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pretty_print</span>(<span class="hljs-params">documents: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]]</span>):
        <span class="hljs-string">"""ç¾åŒ–æ‰“å°æ–‡æ¡£"""</span>
        <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(documents):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ“„ æ–‡æ¡£ <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>:"</span>)
            <span class="hljs-comment"># å¤„ç†ObjectIdä½¿å…¶å¯åºåˆ—åŒ–</span>
            doc_copy = doc.copy()
            <span class="hljs-keyword">if</span> <span class="hljs-string">'_id'</span> <span class="hljs-keyword">in</span> doc_copy:
                doc_copy[<span class="hljs-string">'_id'</span>] = <span class="hljs-built_in">str</span>(doc_copy[<span class="hljs-string">'_id'</span>])
            <span class="hljs-built_in">print</span>(json.dumps(doc_copy, indent=<span class="hljs-number">2</span>, ensure_ascii=<span class="hljs-literal">False</span>))


<span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-comment"># 1. åˆ›å»ºMongoDBç®¡ç†å™¨å®ä¾‹ï¼ˆè¿æ¥æœ¬åœ°MongoDBï¼‰</span>
    mongo = MongoDBManager(
        host=<span class="hljs-string">'localhost'</span>,
        port=<span class="hljs-number">27017</span>,
        database_name=<span class="hljs-string">'testdb'</span>  <span class="hljs-comment"># æ•°æ®åº“åç§°</span>
    )
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># 2. åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“å’Œé›†åˆ</span>
        mongo.list_databases()
        
        <span class="hljs-comment"># 3. ç¤ºä¾‹æ•°æ®ï¼šç”¨æˆ·ä¿¡æ¯</span>
        users_collection = <span class="hljs-string">'users'</span>
        
        <span class="hljs-comment"># 4. æ’å…¥å•ä¸ªæ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n1. æ’å…¥å•ä¸ªç”¨æˆ·:"</span>)
        user1 = {
            <span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
            <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>,
            <span class="hljs-string">"email"</span>: <span class="hljs-string">"zhangsan@example.com"</span>,
            <span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>,
            <span class="hljs-string">"hobbies"</span>: [<span class="hljs-string">"è¯»ä¹¦"</span>, <span class="hljs-string">"æ¸¸æ³³"</span>, <span class="hljs-string">"ç¼–ç¨‹"</span>],
            <span class="hljs-string">"created_at"</span>: datetime.now(),
            <span class="hljs-string">"is_active"</span>: <span class="hljs-literal">True</span>
        }
        user1_id = mongo.insert_one(users_collection, user1)
        
        <span class="hljs-comment"># 5. æ’å…¥å¤šä¸ªæ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n2. æ‰¹é‡æ’å…¥ç”¨æˆ·:"</span>)
        users = [
            {
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"æå››"</span>,
                <span class="hljs-string">"age"</span>: <span class="hljs-number">30</span>,
                <span class="hljs-string">"email"</span>: <span class="hljs-string">"lisi@example.com"</span>,
                <span class="hljs-string">"city"</span>: <span class="hljs-string">"ä¸Šæµ·"</span>,
                <span class="hljs-string">"hobbies"</span>: [<span class="hljs-string">"æ—…æ¸¸"</span>, <span class="hljs-string">"æ‘„å½±"</span>],
                <span class="hljs-string">"created_at"</span>: datetime.now(),
                <span class="hljs-string">"is_active"</span>: <span class="hljs-literal">True</span>
            },
            {
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç‹äº”"</span>,
                <span class="hljs-string">"age"</span>: <span class="hljs-number">28</span>,
                <span class="hljs-string">"email"</span>: <span class="hljs-string">"wangwu@example.com"</span>,
                <span class="hljs-string">"city"</span>: <span class="hljs-string">"å¹¿å·"</span>,
                <span class="hljs-string">"hobbies"</span>: [<span class="hljs-string">"ç¯®çƒ"</span>, <span class="hljs-string">"éŸ³ä¹"</span>],
                <span class="hljs-string">"created_at"</span>: datetime.now(),
                <span class="hljs-string">"is_active"</span>: <span class="hljs-literal">True</span>
            },
            {
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"èµµå…­"</span>,
                <span class="hljs-string">"age"</span>: <span class="hljs-number">35</span>,
                <span class="hljs-string">"email"</span>: <span class="hljs-string">"zhaoliu@example.com"</span>,
                <span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>,
                <span class="hljs-string">"hobbies"</span>: [<span class="hljs-string">"çƒ¹é¥ª"</span>, <span class="hljs-string">"ç”µå½±"</span>],
                <span class="hljs-string">"created_at"</span>: datetime.now(),
                <span class="hljs-string">"is_active"</span>: <span class="hljs-literal">False</span>
            }
        ]
        user_ids = mongo.insert_many(users_collection, users)
        
        <span class="hljs-comment"># 6. æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n3. æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·:"</span>)
        all_users = mongo.find_all(users_collection)
        mongo.pretty_print(all_users)
        
        <span class="hljs-comment"># 7. æ¡ä»¶æŸ¥è¯¢</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n4. æŸ¥è¯¢åŒ—äº¬çš„ç”¨æˆ·:"</span>)
        beijing_users = mongo.find_with_filter(users_collection, {<span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>})
        mongo.pretty_print(beijing_users)
        
        <span class="hljs-comment"># 8. æŸ¥è¯¢å•ä¸ªæ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n5. æŸ¥è¯¢å¹´é¾„å¤§äº30çš„ç”¨æˆ·:"</span>)
        older_user = mongo.find_one(users_collection, {<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$gt"</span>: <span class="hljs-number">30</span>}})
        <span class="hljs-keyword">if</span> older_user:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰¾åˆ°ç”¨æˆ·: <span class="hljs-subst">{older_user[<span class="hljs-string">'name'</span>]}</span>, å¹´é¾„: <span class="hljs-subst">{older_user[<span class="hljs-string">'age'</span>]}</span>"</span>)
        
        <span class="hljs-comment"># 9. æ›´æ–°æ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n6. æ›´æ–°ç”¨æˆ·ä¿¡æ¯:"</span>)
        mongo.update_one(
            users_collection,
            {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>},
            {<span class="hljs-string">"age"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"email"</span>: <span class="hljs-string">"zhangsan_new@example.com"</span>}
        )
        
        <span class="hljs-comment"># 10. éªŒè¯æ›´æ–°</span>
        updated_user = mongo.find_one(users_collection, {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>})
        <span class="hljs-keyword">if</span> updated_user:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ›´æ–°åçš„ç”¨æˆ·: <span class="hljs-subst">{updated_user[<span class="hljs-string">'name'</span>]}</span>, å¹´é¾„: <span class="hljs-subst">{updated_user[<span class="hljs-string">'age'</span>]}</span>, é‚®ç®±: <span class="hljs-subst">{updated_user[<span class="hljs-string">'email'</span>]}</span>"</span>)
        
        <span class="hljs-comment"># 11. ç»Ÿè®¡æ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n7. ç»Ÿè®¡æ´»è·ƒç”¨æˆ·:"</span>)
        active_count = mongo.count_documents(users_collection, {<span class="hljs-string">"is_active"</span>: <span class="hljs-literal">True</span>})
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ´»è·ƒç”¨æˆ·æ•°é‡: <span class="hljs-subst">{active_count}</span>"</span>)
        
        <span class="hljs-comment"># 12. åˆ é™¤æ–‡æ¡£</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n8. åˆ é™¤éæ´»è·ƒç”¨æˆ·:"</span>)
        mongo.delete_many(users_collection, {<span class="hljs-string">"is_active"</span>: <span class="hljs-literal">False</span>})
        
        <span class="hljs-comment"># 13. å†æ¬¡ç»Ÿè®¡</span>
        remaining_count = mongo.count_documents(users_collection)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‰©ä½™ç”¨æˆ·æ•°é‡: <span class="hljs-subst">{remaining_count}</span>"</span>)
        
        <span class="hljs-comment"># 14. åˆ›å»ºç´¢å¼•</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n9. åˆ›å»ºç´¢å¼•:"</span>)
        mongo.create_index(users_collection, <span class="hljs-string">"email"</span>, unique=<span class="hljs-literal">True</span>)
        
        <span class="hljs-comment"># 15. åˆ—å‡ºæ‰€æœ‰é›†åˆ</span>
        mongo.list_collections()
        
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¨‹åºæ‰§è¡Œå‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-comment"># 16. å…³é—­è¿æ¥</span>
        mongo.close_connection()


<span class="hljs-comment"># é«˜çº§ç”¨æ³•ç¤ºä¾‹ï¼šä½¿ç”¨èšåˆç®¡é“</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">advanced_example</span>():
    <span class="hljs-string">"""é«˜çº§æŸ¥è¯¢ç¤ºä¾‹ï¼šä½¿ç”¨èšåˆç®¡é“"""</span>
    mongo = MongoDBManager(database_name=<span class="hljs-string">'testdb'</span>)
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># åˆ›å»ºè®¢å•æ•°æ®</span>
        orders_collection = <span class="hljs-string">'orders'</span>
        
        <span class="hljs-comment"># æ’å…¥ä¸€äº›è®¢å•æ•°æ®</span>
        orders = [
            {<span class="hljs-string">"customer"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-number">150</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>, <span class="hljs-string">"date"</span>: datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span>)},
            {<span class="hljs-string">"customer"</span>: <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-number">200</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>, <span class="hljs-string">"date"</span>: datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">16</span>)},
            {<span class="hljs-string">"customer"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-number">300</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"pending"</span>, <span class="hljs-string">"date"</span>: datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">17</span>)},
            {<span class="hljs-string">"customer"</span>: <span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-number">100</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>, <span class="hljs-string">"date"</span>: datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">18</span>)},
            {<span class="hljs-string">"customer"</span>: <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"amount"</span>: <span class="hljs-number">250</span>, <span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>, <span class="hljs-string">"date"</span>: datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">19</span>)}
        ]
        
        mongo.insert_many(orders_collection, orders)
        
        <span class="hljs-comment"># ä½¿ç”¨èšåˆç®¡é“ï¼šæŒ‰å®¢æˆ·åˆ†ç»„ï¼Œè®¡ç®—æ€»é‡‘é¢</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nğŸ” èšåˆæŸ¥è¯¢ï¼šæ¯ä¸ªå®¢æˆ·çš„æ€»è®¢å•é‡‘é¢"</span>)
        pipeline = [
            {<span class="hljs-string">"$match"</span>: {<span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>}},  <span class="hljs-comment"># åªé€‰æ‹©å·²å®Œæˆçš„è®¢å•</span>
            {<span class="hljs-string">"$group"</span>: {
                <span class="hljs-string">"_id"</span>: <span class="hljs-string">"$customer"</span>,  <span class="hljs-comment"># æŒ‰å®¢æˆ·åˆ†ç»„</span>
                <span class="hljs-string">"total_amount"</span>: {<span class="hljs-string">"$sum"</span>: <span class="hljs-string">"$amount"</span>},  <span class="hljs-comment"># è®¡ç®—æ€»é‡‘é¢</span>
                <span class="hljs-string">"order_count"</span>: {<span class="hljs-string">"$sum"</span>: <span class="hljs-number">1</span>}  <span class="hljs-comment"># è®¡ç®—è®¢å•æ•°é‡</span>
            }},
            {<span class="hljs-string">"$sort"</span>: {<span class="hljs-string">"total_amount"</span>: -<span class="hljs-number">1</span>}}  <span class="hljs-comment"># æŒ‰æ€»é‡‘é¢é™åºæ’åº</span>
        ]
        
        collection = mongo.db[orders_collection]
        results = <span class="hljs-built_in">list</span>(collection.aggregate(pipeline))
        
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å®¢æˆ·æ¶ˆè´¹ç»Ÿè®¡:"</span>)
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å®¢æˆ·: <span class="hljs-subst">{result[<span class="hljs-string">'_id'</span>]}</span>, æ€»é‡‘é¢: Â¥<span class="hljs-subst">{result[<span class="hljs-string">'total_amount'</span>]}</span>, è®¢å•æ•°: <span class="hljs-subst">{result[<span class="hljs-string">'order_count'</span>]}</span>"</span>)
            
    <span class="hljs-keyword">finally</span>:
        mongo.close_connection()


<span class="hljs-comment"># ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆæ¨èæ–¹å¼ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">with_context_manager</span>():
    <span class="hljs-string">"""ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç®¡ç†è¿æ¥"""</span>
    <span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> contextmanager
    
<span class="hljs-meta">    @contextmanager</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_mongo_connection</span>():
        <span class="hljs-string">"""è·å–MongoDBè¿æ¥çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""</span>
        mongo = <span class="hljs-literal">None</span>
        <span class="hljs-keyword">try</span>:
            mongo = MongoDBManager(database_name=<span class="hljs-string">'testdb'</span>)
            <span class="hljs-keyword">yield</span> mongo
        <span class="hljs-keyword">finally</span>:
            <span class="hljs-keyword">if</span> mongo:
                mongo.close_connection()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nğŸ¯ ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹:"</span>)
    <span class="hljs-keyword">with</span> get_mongo_connection() <span class="hljs-keyword">as</span> mongo:
        <span class="hljs-comment"># åœ¨è¿™é‡Œæ‰§è¡Œæ•°æ®åº“æ“ä½œ</span>
        users = mongo.find_all(<span class="hljs-string">'users'</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰æœ‰ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(users)}</span> ä¸ªç”¨æˆ·"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"MongoDB CRUD æ“ä½œç¤ºä¾‹"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    
    <span class="hljs-comment"># è¿è¡ŒåŸºæœ¬ç¤ºä¾‹</span>
    main()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"é«˜çº§æŸ¥è¯¢ç¤ºä¾‹"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
    
    <span class="hljs-comment"># è¿è¡Œé«˜çº§ç¤ºä¾‹</span>
    advanced_example()
    
    <span class="hljs-comment"># è¿è¡Œä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹</span>
    with_context_manager()
</code></pre>
<h2 data-id="heading-2">3. ç®€åŒ–çš„å¿«é€Ÿä½¿ç”¨ç‰ˆæœ¬</h2>
<p>å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ›´ç®€æ´çš„ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pymongo <span class="hljs-keyword">import</span> MongoClient
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-comment"># 1. è¿æ¥MongoDB</span>
client = MongoClient(<span class="hljs-string">'localhost'</span>, <span class="hljs-number">27017</span>)  <span class="hljs-comment"># é»˜è®¤é…ç½®</span>

<span class="hljs-comment"># 2. é€‰æ‹©æ•°æ®åº“</span>
db = client[<span class="hljs-string">'mydatabase'</span>]

<span class="hljs-comment"># 3. é€‰æ‹©é›†åˆï¼ˆç±»ä¼¼äºSQLçš„è¡¨ï¼‰</span>
collection = db[<span class="hljs-string">'users'</span>]

<span class="hljs-comment"># 4. æ’å…¥æ•°æ®</span>
user_data = {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"zhangsan@example.com"</span>,
    <span class="hljs-string">"created_at"</span>: datetime.now()
}
result = collection.insert_one(user_data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ’å…¥æˆåŠŸï¼ŒID: <span class="hljs-subst">{result.inserted_id}</span>"</span>)

<span class="hljs-comment"># 5. æŸ¥è¯¢æ•°æ®</span>
<span class="hljs-comment"># æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£</span>
all_users = collection.find()
<span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> all_users:
    <span class="hljs-built_in">print</span>(user)

<span class="hljs-comment"># æ¡ä»¶æŸ¥è¯¢</span>
query = {<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$gt"</span>: <span class="hljs-number">20</span>}}  <span class="hljs-comment"># å¹´é¾„å¤§äº20</span>
users = collection.find(query)
<span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users:
    <span class="hljs-built_in">print</span>(user)

<span class="hljs-comment"># æŸ¥è¯¢å•ä¸ªæ–‡æ¡£</span>
user = collection.find_one({<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>})
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰¾åˆ°ç”¨æˆ·: <span class="hljs-subst">{user}</span>"</span>)

<span class="hljs-comment"># 6. æ›´æ–°æ•°æ®</span>
collection.update_one(
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>},
    {<span class="hljs-string">"$set"</span>: {<span class="hljs-string">"age"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"updated_at"</span>: datetime.now()}}
)

<span class="hljs-comment"># 7. åˆ é™¤æ•°æ®</span>
collection.delete_one({<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>})

<span class="hljs-comment"># 8. å…³é—­è¿æ¥</span>
client.close()
</code></pre>
<h2 data-id="heading-3">4. ç¯å¢ƒé…ç½®å»ºè®®</h2>
<p>åˆ›å»º <code>config.py</code> æ–‡ä»¶ç®¡ç†é…ç½®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># config.py</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MongoDBConfig</span>:
    HOST = <span class="hljs-string">'localhost'</span>
    PORT = <span class="hljs-number">27017</span>
    USERNAME = <span class="hljs-literal">None</span>
    PASSWORD = <span class="hljs-literal">None</span>
    DATABASE = <span class="hljs-string">'mydatabase'</span>
    
    <span class="hljs-comment"># è¿æ¥å­—ç¬¦ä¸²</span>
<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_connection_string</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-keyword">if</span> cls.USERNAME <span class="hljs-keyword">and</span> cls.PASSWORD:
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"mongodb://<span class="hljs-subst">{cls.USERNAME}</span>:<span class="hljs-subst">{cls.PASSWORD}</span>@<span class="hljs-subst">{cls.HOST}</span>:<span class="hljs-subst">{cls.PORT}</span>/"</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"mongodb://<span class="hljs-subst">{cls.HOST}</span>:<span class="hljs-subst">{cls.PORT}</span>/"</span>
</code></pre>
<h2 data-id="heading-4">5. å¸¸è§æŸ¥è¯¢æ“ä½œç¬¦</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦ç¤ºä¾‹</span>
query_examples = {
    <span class="hljs-comment"># ç­‰äº</span>
    <span class="hljs-string">"ç­‰äº"</span>: {<span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>},
    
    <span class="hljs-comment"># å¤§äº</span>
    <span class="hljs-string">"å¤§äº"</span>: {<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$gt"</span>: <span class="hljs-number">20</span>}},
    
    <span class="hljs-comment"># å°äº</span>
    <span class="hljs-string">"å°äº"</span>: {<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$lt"</span>: <span class="hljs-number">30</span>}},
    
    <span class="hljs-comment"># èŒƒå›´</span>
    <span class="hljs-string">"èŒƒå›´"</span>: {<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$gte"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"$lte"</span>: <span class="hljs-number">30</span>}},
    
    <span class="hljs-comment"># åŒ…å«åœ¨æ•°ç»„ä¸­</span>
    <span class="hljs-string">"åŒ…å«"</span>: {<span class="hljs-string">"hobbies"</span>: {<span class="hljs-string">"$in"</span>: [<span class="hljs-string">"è¯»ä¹¦"</span>, <span class="hljs-string">"æ¸¸æ³³"</span>]}},
    
    <span class="hljs-comment"># ä¸åŒ…å«</span>
    <span class="hljs-string">"ä¸åŒ…å«"</span>: {<span class="hljs-string">"hobbies"</span>: {<span class="hljs-string">"$nin"</span>: [<span class="hljs-string">"æ¸¸æˆ"</span>]}},
    
    <span class="hljs-comment"># å­˜åœ¨å­—æ®µ</span>
    <span class="hljs-string">"å­˜åœ¨å­—æ®µ"</span>: {<span class="hljs-string">"email"</span>: {<span class="hljs-string">"$exists"</span>: <span class="hljs-literal">True</span>}},
    
    <span class="hljs-comment"># æ­£åˆ™åŒ¹é…</span>
    <span class="hljs-string">"æ­£åˆ™"</span>: {<span class="hljs-string">"name"</span>: {<span class="hljs-string">"$regex"</span>: <span class="hljs-string">"^å¼ "</span>}},  <span class="hljs-comment"># å§“å¼ çš„</span>
    
    <span class="hljs-comment"># é€»è¾‘AND</span>
    <span class="hljs-string">"AND"</span>: {<span class="hljs-string">"$and"</span>: [{<span class="hljs-string">"age"</span>: {<span class="hljs-string">"$gt"</span>: <span class="hljs-number">20</span>}}, {<span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>}]},
    
    <span class="hljs-comment"># é€»è¾‘OR</span>
    <span class="hljs-string">"OR"</span>: {<span class="hljs-string">"$or"</span>: [{<span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>}, {<span class="hljs-string">"city"</span>: <span class="hljs-string">"ä¸Šæµ·"</span>}]},
}
</code></pre>
<h2 data-id="heading-5">6. å¯åŠ¨MongoDBæœåŠ¡</h2>
<p>åœ¨è¿è¡Œä»£ç å‰ï¼Œç¡®ä¿MongoDBæœåŠ¡å·²å¯åŠ¨ï¼š</p>
<p><strong>Windows:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨MongoDBæœåŠ¡</span>
net start MongoDB
</code></pre>
<p><strong>macOS:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨Homebrewå®‰è£…åå¯åŠ¨</span>
brew services start mongodb-community
</code></pre>
<p><strong>Linux:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Ubuntu/Debian</span>
sudo systemctl start mongod

<span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€</span>
sudo systemctl status mongod
</code></pre>
<p>è¿™ä¸ªå®Œæ•´ç¤ºä¾‹æ¶µç›–äº†MongoDBçš„åŸºæœ¬æ“ä½œï¼ŒåŒ…æ‹¬è¿æ¥ã€CRUDæ“ä½œã€èšåˆæŸ¥è¯¢ç­‰ã€‚ä½ å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å’Œæ‰©å±•è¿™äº›ä»£ç ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯´ç‚¹ä¸ä¸€æ ·çš„ã€‚GPT-5.3 ä¸ Claude Opus 4.6 åŒæ—¶ç‚¸åœºï¼Œå‰ç«¯å˜å¤©äº†ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603308967124762624</link>    <guid>https://juejin.cn/post/7603308967124762624</guid>    <pubDate>2026-02-06T04:21:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603308967124762624" data-draft-id="7603238967291789364" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯´ç‚¹ä¸ä¸€æ ·çš„ã€‚GPT-5.3 ä¸ Claude Opus 4.6 åŒæ—¶ç‚¸åœºï¼Œå‰ç«¯å˜å¤©äº†ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-06T04:21:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Sunday"/> <meta itemprop="url" content="https://juejin.cn/user/2963939078980712"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯´ç‚¹ä¸ä¸€æ ·çš„ã€‚GPT-5.3 ä¸ Claude Opus 4.6 åŒæ—¶ç‚¸åœºï¼Œå‰ç«¯å˜å¤©äº†ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939078980712/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Sunday
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T04:21:34.000Z" title="Fri Feb 06 2026 04:21:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.7;font-weight:400;font-size:16px;overflow-x:hidden;color:#2c3e50;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;font-weight:600;margin-top:35px;margin-bottom:8px;padding-bottom:5px}.markdown-body h1 :before,.markdown-body h2 :before,.markdown-body h3 :before,.markdown-body h4 :before,.markdown-body h5 :before,.markdown-body h6 :before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:8px;margin-top:50px;font-size:24px;border-bottom:1px solid #eaecef}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #eaecef;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;font-weight:400;background-color:rgba(27,31,35,.05);color:#476582;margin:0;font-size:.85em;border-radius:3px;font-size:.87em;padding:.165em .5em}.markdown-body code,.markdown-body pre{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.6;padding:20px 24px;background-color:#282c34;border-radius:6px}.markdown-body pre&gt;code{font-size:14px;padding:0;margin:0;word-break:normal;display:block;overflow-x:auto;color:#fff}.markdown-body a{text-decoration:none;color:#3eaf7c;font-weight:500}.markdown-body a:active,.markdown-body a:hover{color:#42b983;border-bottom:1px solid #42b983}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;margin:16px 0;border-collapse:collapse}.markdown-body thead{background:#f6f6f6;background:#3eaf7c;color:#000;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f6f8fa}.markdown-body td,.markdown-body th{border:1px solid #dfe2e5;padding:10px 16px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{font-size:14px;padding:6px 23px;margin:22px 0;border-left:6px solid #42b983;background-color:#f3f5f7;font-weight:400}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body p,.markdown-body ul{line-height:1.7}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="base16/tomorrow-night">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ Sundayã€‚</p>
<p>æ—©ä¸Šä¸€èµ·æ¥ï¼Œæ‰‹æœºå°±è¢«åˆ·å±äº†...å„å¤§å·ä¸»éƒ½åœ¨å†™ OpenAI å’Œ Anthropic åœ¨æ˜¨å¤©æ™šä¸Šå‘å¸ƒçš„æœ€æ–°æ¨¡å‹ <code>GPT-5.3-Codex</code> å’Œ <code>Claude Opus 4.6</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab23ff67b58240a0b3ce0860c416b475~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=QNwiTb%2BjMsZFVGXRbWfbI3SVNrM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4283959c7f514c6fb3c7a670e40f4b70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=yDA0dOKoMCYuV8XfbZv3jUZXwtA%3D" alt="" loading="lazy"/></p>
<p>æˆ‘çœ‹äº†ä¸€çœ¼å„å¤§å·ä¸»çš„æ–‡ç« ï¼Œå‘ç°å¤§å®¶éƒ½åœ¨ç‹‚æ¬¢ï¼ˆçœŸå‡ä¸é‡è¦ï¼Œè‡³å°‘æ–‡ç« ä¸­éƒ½åœ¨ç‹‚æ¬¢ï¼‰ï¼Œéƒ½åœ¨å‘è·‘åˆ†æˆªå›¾ã€‚æœ‰çš„è¯´ Claude çš„ <strong>ä¸€ç™¾ä¸‡ï¼ˆ1Mï¼‰ä¸Šä¸‹æ–‡æ— æ•Œ</strong> äº†ï¼Œæœ‰çš„è¯´ GPT-5.3 çš„ <code>OSWorld</code> åˆ†æ•°å¤ªå“äººã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dda35edd5b5141c78f79f6f932aa1138~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=smqLn3FjeqgqN5YVs4zQ0tZfw%2BA%3D" alt="Claude æä¾›ç™¾ä¸‡ä¸Šä¸‹æ–‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89807ffa3c95481ea04f8fe01f70aef0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=LfGRmrCsAFiIAY0HQB5QOrg5B3s%3D" alt="GPT-5.3 çš„ OSWorld è·‘åˆ†" loading="lazy"/></p>
<p>ä½†æ˜¯ï¼ŒSunday ä½œä¸ºä¸€ä¸ªå†™äº†åå‡ å¹´ä»£ç ã€ç°åœ¨å¤©å¤©ç¢ç£¨æ€ä¹ˆç”¨ AI ææ•ˆçš„â€œè€å‰ç«¯â€ã€‚çœ‹äº†è¿™ä¸¤ç¯‡é•¿è¾¾æ•°ä¸‡å­—çš„æŠ€æœ¯æ–‡æ¡£ä¹‹åï¼Œå´å¹¶æ²¡æœ‰å…¶ä»–åšä¸»ååº”çš„é‚£ä¹ˆå…´å¥‹ã€‚</p>
<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å› ä¸ºï¼ŒSunday å‘ç°åœ¨è¿™ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œé¡¶çº§ AI æ¨¡å‹ç›®å‰äº‰è®ºçš„ç„¦ç‚¹ï¼Œå·²ç»å®Œå…¨ä¸æ˜¯â€œè°å†™çš„ä»£ç  Bug å°‘â€è¿™ä¹ˆç®€å•äº†ï¼Œ<strong>ä»–ä»¬æ­£åœ¨é‡æ–°å®šä¹‰ä»€ä¹ˆæ˜¯â€œå†™ä»£ç â€ï¼Ÿ</strong></p>
<p>æ‰€ä»¥ï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼ŒSunday å°±æˆ‘ä¸å¸¦å¤§å®¶åƒçœ‹çƒ­é—¹ä¸€æ ·å»æ¯”é‚£äº›è™šæ— ç¼¥ç¼ˆçš„è·‘åˆ†ï¼ˆè™½ç„¶è·‘åˆ†éƒ½å¾ˆé«˜ï¼‰ï¼Œæˆ‘æƒ³å¸¦å¤§å®¶ä»å¦å¤–ä¸€ä¸ªè§’åº¦ï¼Œæ¥çœ‹çœ‹è¿™æ¬¡æ›´æ–°çš„æ ¸å¿ƒå†…å®¹ã€‚æˆ–è®¸å¤§å®¶çœ‹å®Œä¹‹åï¼Œèƒ½æœ‰ä¸ä¸€æ ·çš„æ”¶è·ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ Claude Opus 4.6</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2d7ddfd08204f67b67ab0df3169c04e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=O27f42zhiIbVfL3%2FxUGh0k4V7yA%3D" alt="" loading="lazy"/></p>
<p>å…ˆè¯´ Anthropic çš„ <code>Claude Opus 4.6</code>ã€‚</p>
<p>å¤§å®¶éƒ½åœ¨å¹ <strong>100 ä¸‡ Token ä¸Šä¸‹æ–‡ï¼ˆ1M Contextï¼‰</strong>ã€‚</p>
<p>å¾ˆå¤šäººå¯¹è¿™ä¸ªæ•°å­—æ²¡æ¦‚å¿µï¼Œè§‰å¾—ä¸å°±æ˜¯ï¼šâ€œå¯ä»¥æŠŠä¸€ä¸ªè¶…çº§å¤§çš„æ–‡æ¡£æ‰”ç»™ Claude è®©ä»–å¤„ç†äº†å—ï¼Ÿâ€</p>
<p>é”™ã€‚å¤§é”™ç‰¹é”™ã€‚</p>
<p>æƒ³è¦æ˜ç™½è¿™ä¸ªï¼Œæˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“ <strong>AI å†™ä»£ç åˆ°åº•æ˜¯æ€ä¹ˆå»å†™çš„ï¼</strong></p>
<p>åœ¨ Opus 4.6 ä¹‹å‰ï¼Œæˆ‘ä»¬ç”¨ AI å†™ä»£ç æ˜¯ <strong>â€œåˆ‡ç‰‡å¼â€</strong> çš„ã€‚</p>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚ï¼šä½ çš„é¡¹ç›®å¯èƒ½æœ‰ 500 ä¸ªæ–‡ä»¶ï¼Œä½†ä½ æ¯æ¬¡åªèƒ½å¤åˆ¶ç²˜è´´é‚£ 3 ä¸ªç›¸å…³çš„æ–‡ä»¶ç»™ AIã€‚ AI æ¯æ¬¡ä¹Ÿåªæ˜¯è¯»å–å…¶ä¸­çš„éƒ¨åˆ†æ–‡ä»¶çš„éƒ¨åˆ†ä»£ç ã€‚ç®€å•ç†è§£å°±æ˜¯ï¼š<strong>AI æ˜¯çœ‹ä¸è§çš„å…¨å±€æ¶æ„è®¾è®¡çš„</strong>ã€‚å®ƒçœ‹ä¸è§ä½ çš„éšè—ä¾èµ–ã€æ¶æ„è®¾è®¡æ–¹æ¡ˆã€æ›´ä¸äº†è§£ä½  CSS ä¸­å¯èƒ½ä¼šå­˜åœ¨çš„å…¨å±€æ±¡æŸ“é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥ï¼ŒAI ç»å¸¸ä¼šå†™å‡ºé‚£ç§ â€œ<strong>å±€éƒ¨å®Œç¾ï¼Œå…¨å±€å´©ç›˜</strong>â€ çš„ä»£ç ã€‚</p>
<p>ä¹‹å‰æˆ‘ä»¬çš„å¤„ç†æ–¹å¼éƒ½æ˜¯ï¼šå…ˆè®© AI è¿›è¡Œé€»è¾‘æ‹†è§£ï¼Œç„¶åæ ¹æ®å…·ä½“çš„æ­¥éª¤åœ¨ä¸€æ­¥æ­¥æ‰§è¡Œï¼Œè¿™æ ·ä¼šå¥½å¾ˆå¤šã€‚</p>
<p>ä½†æ˜¯ç°åœ¨ä¸ä¸€æ ·äº†ï¼Œ100 ä¸‡ Token ä¸Šä¸‹æ–‡å·²ç»è¶³å¤Ÿæˆ‘ä»¬å»ç†è§£éå¸¸å¤§çš„é¡¹ç›®ä»£ç ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼ŒClaude è¿˜æä¾›äº†ä¸€ä¸ªå«åš <code>Context Compactionï¼ˆä¸Šä¸‹æ–‡å‹ç¼©ï¼‰</code> çš„æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯ä¼šä¼šè‡ªåŠ¨æ€»ç»“å¹¶æ›¿æ¢æ—§çš„ä¸Šä¸‹æ–‡ï¼Œè®© Claude èƒ½å¤Ÿæ‰§è¡Œæ›´é•¿æ—¶é—´çš„ä»»åŠ¡è€Œä¸ä¼šè¾¾åˆ°é™åˆ¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f87d476db6c44a7e82fba9054c136463~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=4VSrEx8DX8NjIqKa5qpS6EqdVXk%3D" alt="" loading="lazy"/></p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ„å‘³ç€ï¼šä½ å¯ä»¥æŠŠ <strong>æ•´ä¸ª</strong> å‰ç«¯é¡¹ç›®ï¼ˆsrc ç›®å½• + é…ç½® + æ–‡æ¡£ï¼‰ä¸€æ¬¡æ€§æ‰”ç»™ Claudeï¼Œä»–ä»¬é€šè¿‡ä¸Šä¸‹æ–‡å‹ç¼©æ–¹æ¡ˆï¼Œæ¥é€æ­¥å¤„ç†ä½ çš„æ‰€æœ‰æºä»£ç ã€‚</p>
<p>é™¤äº†è¿™ä¸ªä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå«åš <code>Agent Teamsï¼ˆä»£ç†å›¢é˜Ÿï¼‰</code> çš„ä¸œè¥¿ã€‚è¿™ä¸ªå’Œ Sunday ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« æœ‰ç‚¹ç›¸ä¼¼ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqrTSRe_yfrqKI25ALZu3lg" target="_blank" title="https://mp.weixin.qq.com/s/qrTSRe_yfrqKI25ALZu3lg" ref="nofollow noopener noreferrer">æˆ‘åˆ›å»ºäº†ä¸€ä¸ªå…¨ AI å‘˜å·¥çš„ä¸€äººå…¬å¸</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc1456759ae743c5906e191ceb54580b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=nsmsVl0xQn%2F6r2Ht%2Ft8aPBn5w%2Fs%3D" alt="" loading="lazy"/></p>
<p>è¿™ç©æ„æ˜¯å•¥æ„æ€å‘¢ï¼Ÿ</p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š<strong>ä»¥å‰æˆ‘ä»¬ç”¨ Claude Codeï¼Œæ˜¯ä¸€å¯¹ä¸€ã€‚ç°åœ¨ï¼Œä»–å¯ä»¥ç›´æ¥åˆ›å»ºå‡ºä¸€ä¸ª Claude Code çš„å›¢é˜Ÿã€‚</strong> å›¢é˜Ÿä¸­æ¯ä¸ªäººï¼ˆAgentï¼‰å„å¸å…¶äº‹ï¼Œå„è‡ªç‹¬ç«‹ï¼Œå¹¶è¿˜å¯ä»¥ç›¸äº’å†™ä½œï¼Œç›¸äº’åµæ¶ã€‚</p>
<ul>
<li><strong>Agent Aï¼ˆæ¶æ„å¸ˆï¼‰</strong>ï¼šè´Ÿè´£æ‹†è§£éœ€æ±‚ï¼Œä¸å†™ä»£ç ã€‚</li>
<li><strong>Agent Bï¼ˆå¼€å‘ï¼‰</strong>ï¼šè´Ÿè´£å…·ä½“å®ç°ã€‚</li>
<li><strong>Agent Cï¼ˆæµ‹è¯•ï¼‰</strong>ï¼šè´Ÿè´£å†™å•å…ƒæµ‹è¯•ï¼Œå¹¶è¯•å›¾ä¸ºäº† Agent B çš„ä»£ç æ‰¾èŒ¬ã€‚</li>
</ul>
<p>å°±åƒ <code>claude</code> çš„æ›´æ–°å…¬å‘Šåœ¨ç»“å°¾æ‰€å±•ç¤ºçš„ä¸€æ ·ï¼š<strong>è¿™æ¬¡æ›´æ–°æ˜¯è§£é”äº†æ–°çš„é•¿æœŸä»»åŠ¡çš„å¼€å§‹</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73885d7c9ed1423daf1eeece27b25002~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=Fjt1chEoAdXwpdtsRIBK6%2BVJpMg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€ GPT-5.3 Codex</h2>
<p>å¦‚æœè¯´ Claude æ˜¯åœ¨æ¨ªå‘æ‰©å±•ï¼ˆå®¹é‡ï¼‰ï¼Œé‚£ OpenAI çš„ <strong>GPT-5.3 Codex</strong> å°±æ˜¯åœ¨çºµå‘é’»å­”ï¼ˆæ·±åº¦ï¼‰ã€‚</p>
<p>è¿™ç¯‡åšå®¢é‡Œæœ€è®©æˆ‘èµ·é¸¡çš®ç–™ç˜©çš„ä¸€å¥è¯æ˜¯ï¼š</p>
<blockquote>
<p><strong>"GPT-5.3 Codex is the first model to play a key role in its own development."</strong> ï¼ˆGPT-5.3 Codex æ˜¯ç¬¬ä¸€ä¸ªåœ¨è‡ªèº«å¼€å‘è¿‡ç¨‹ä¸­å‘æŒ¥å…³é”®ä½œç”¨çš„æ¨¡å‹ã€‚ï¼‰</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a93bb9d5c87d470d85c28b49fb961373~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=94fpO%2BaCK3Ur5Ioj4YYZOA%2BXUGQ%3D" alt="" loading="lazy"/></p>
<p>å…„å¼Ÿä»¬ï¼Œè¿™å‰§æœ¬æˆ‘çœ‹è¿‡ï¼Œè¿™å°±å«â€œå·¦è„šè¸©å³è„šä¸Šå¤©â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f91d3fab8444f9f9385122ac596e313~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=VFobsjGI3epG3YfmacSvz5xKO94%3D" alt="" loading="lazy"/></p>
<p>åœ¨ OpenAI çš„ç¨‹åºå‘˜ç°åœ¨å·²ç»å¼€å§‹ä½¿ç”¨ GPT æ¥å¼€å‘æ–°çš„ GPT äº†....</p>
<p>è¿™æ„å‘³ç€ï¼š ç›®å‰çš„  AI æ¨¡å‹å·²ç»å®Œå…¨å¯ä»¥åº”ç”¨åœ¨å¤æ‚çš„å•†ä¸šé¡¹ç›®ä¸­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/709f3bb17cfb46ebacbc373f9e0e05c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=tV4wgPp0ynw57I15dqG5A%2FHuzV4%3D" alt="" loading="lazy"/></p>
<p>è€Œåœ¨çœ‹å®Œæ•´ä¸ª GPT 5.3 çš„æ›´æ–°å…¬å‘Šä¹‹åï¼ŒSunday å‘ç°å…¶ä¸­æœ‰ä¸¤ä¸ªç‚¹æ˜¯æœ€é‡è¦çš„ï¼š</p>
<h3 data-id="heading-2">1. â€œäº¤äº’å¼â€çº åï¼ˆInteractive Collaborationï¼‰</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfcdac1f88454e1396256735301aba13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=36%2B6FPJf5M%2BnvTiLPN6OropeLAI%3D" alt="" loading="lazy"/></p>
<p>ä»¥å‰ç”¨ Agent å†™ä»£ç ï¼Œå¤§å®¶æœ€å®³æ€•çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æœ€æ€•çš„æ˜¯å®ƒ â€œä¸€æ¡é“èµ°åˆ°é»‘â€ï¼</p>
<p>ä½ ç»™ä¸ªéœ€æ±‚ï¼Œå®ƒè·‘äº†åŠå°æ—¶ï¼Œæœ€åç»™ä½ ä¸€å¨è·‘ä¸é€šçš„ä»£ç ï¼Œä½ è¿˜ä¸çŸ¥é“å®ƒæ˜¯å“ªä¸€æ­¥æ­ªçš„ã€‚</p>
<p>GPT-5.3 Codex å¼•å…¥äº† <strong>â€œäººæœºä»‹å…¥â€</strong> æœºåˆ¶ã€‚</p>
<p>å½“å®ƒåœ¨æ„å»ºä¸€ä¸ªå¤æ‚çš„ Web æ¸¸æˆï¼ˆæ¯”å¦‚åšå®¢é‡Œå±•ç¤ºçš„é‚£ä¸ªèµ›è½¦æ¸¸æˆï¼‰æ—¶</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e628d555a4242868111f64bdce0fac6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=AetUDIzR%2BRLX%2BcW%2BshRKvWCmfAU%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœå®ƒå¡ä½äº†ï¼Œæˆ–è€…æ–¹å‘åäº†ï¼Œä½ å¯ä»¥<strong>å®æ—¶</strong>æš‚åœå®ƒï¼Œç»™å®ƒå–‚ä¸€å¥åé¦ˆï¼Œå®ƒèƒ½æ— ç¼æ¥ä½ä½ çš„æ€è·¯ç»§ç»­å¹²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5c5c849f7174f92866acff1a5e85fd7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=6Nr7tGLn9kjjYDXZmEy6MEcOlzc%3D" alt="" loading="lazy"/></p>
<p>è¿™è§£å†³äº† Agent è½åœ°æœ€å¤§çš„ç—›ç‚¹ï¼š<strong>ä¸å¯æ§æ€§</strong>ã€‚</p>
<h3 data-id="heading-3">2. çœŸæ­£çš„ GUI æ“ä½œèƒ½åŠ›ï¼ˆOSWorld 64.7%ï¼‰</h3>
<p><code>OSWorld</code> æ˜¯ AI æ¨¡å‹ä¸­çš„ä¸€ä¸ªä¸“ä¸šå±äºï¼Œä»–è¡¨ç¤ºçš„æ˜¯ <code>å¯¹è§†è§‰ä»»åŠ¡çš„è¯†åˆ«ç¨‹åº¦</code>ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ™®é€šäººçš„ <code>OSWorld</code> å¤§çº¦æ˜¯åœ¨ <code>72%</code> å·¦å³ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ¬¡ GPT 5.3 çš„æ›´æ–° OSWorld åˆ†æ•°é£™åˆ°äº† <code>64.7%</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6ff7704d880422c8b1efdecda228ed9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYU3VuZGF5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770956519&amp;x-signature=Q1PGdD3pPiCsqIV85dqFVUABd7o%3D" alt="" loading="lazy"/></p>
<p>è¿™æ„å‘³ç€ï¼ŒGPT ç°åœ¨ä¸åªæ˜¯åªèƒ½åœ¨ç»ˆç«¯é‡Œé¢è·‘å‘½ä»¤è¡Œäº†ã€‚ä»–ç°åœ¨å¯ä»¥åƒäººä¸€æ ·ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œæ‰“å¼€ Chrome DevToolsï¼Œç‚¹å‡»é‚£ä¸ªæŠ¥é”™çš„æŒ‰é’®ï¼ŒæŸ¥çœ‹ Network é¢æ¿ï¼Œç„¶ååˆ‡å›ç¼–è¾‘å™¨æ”¹ä»£ç ã€‚</p>
<p>è¿™ä¸‹æ„Ÿè§‰ â€œæµ‹è¯•è¦å¤±ä¸šäº†...â€ã€‚ä¹‹å‰å’±ä»¬è¿˜å¾—å†™ä¸ªæµ‹è¯•ä»£ç å•¥çš„ï¼Œç°åœ¨éƒ½å·²ç»ä¸éœ€è¦äº†ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç›´æ¥å‘Šè¯‰ GPT-5.3ï¼šâ€œå»æŠŠé‚£ä¸ªä¸‹å•æµç¨‹æµ‹ä¸€éï¼Œå¦‚æœæ”¯ä»˜å¤±è´¥äº†ï¼Œæˆªä¸ªå›¾å‘æˆ‘ã€‚â€</p>
<p>å®ƒç°åœ¨å®Œå…¨å¯ä»¥åšåˆ°äº†ï¼</p>
<h2 data-id="heading-4">ä¸‰ã€ æ€è€ƒæ€»ç»“</h2>
<p>ä¸çŸ¥é“å¤§å®¶çœ‹å®Œè¿™äº›å‡çº§ä¹‹åæ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ</p>
<p>Sunday ä¸ªäººçš„æ„Ÿè§‰æ˜¯ï¼šâ€œå‰ç«¯åˆè¦å¤±ä¸šäº†â€ã€‚æ¯•ç«Ÿ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F9uQw97RJ1VzA_vp2RHwd3w" target="_blank" title="https://mp.weixin.qq.com/s/9uQw97RJ1VzA_vp2RHwd3w" ref="nofollow noopener noreferrer">2025 å¹´å‰ç«¯ä¸€å¹´å°±æ­»äº† 10 æ¬¡...</a></p>
<p>æ²¡é‚£ä¹ˆä¸¥é‡ï¼</p>
<p>ä¸è¿‡ï¼Œå¤§å®¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>å¦‚æœä½ è¿˜æ˜¯æŠŠè‡ªå·±å®šä¹‰ä¸º â€œåˆ‡å›¾ä»”â€ æˆ–è€… â€œAPI è°ƒåŒ…ä¾ â€ ï¼Œé‚£æ˜¯çœŸå®Œäº†</strong></p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä½ æŠŠè‡ªå·±å®šä¹‰ä¸º <strong>â€œäº§å“å·¥ç¨‹å¸ˆâ€</strong> ï¼é‚£ä¹ˆå±äºä½ çš„é»„é‡‘æ—¶ä»£æ‰åˆšåˆšå¼€å§‹ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿ</p>
<h3 data-id="heading-5">1. æŠ€æœ¯çš„â€œå¹³æƒâ€</h3>
<p>ä»¥å‰ï¼Œæˆ‘ä»¬è¦æƒ³åšä¸€ä¸ªå…¨æ ˆåº”ç”¨ï¼Œé—¨æ§›å¤ªé«˜äº†ã€‚ä½ è¦æ‡‚ Dockerï¼Œè¦æ‡‚ K8sï¼Œè¦æ‡‚æ•°æ®åº“è°ƒä¼˜ã€‚</p>
<p>ç°åœ¨ï¼ŒGPT-5.3 Codex è¿è‡ªå·±çš„è®­ç»ƒé›†ç¾¤éƒ½èƒ½ç®¡ç†ã€‚ä½ åªè¦æœ‰<strong>ç³»ç»Ÿè®¾è®¡</strong>çš„èƒ½åŠ›ï¼Œä½ ä¸€ä¸ªäººå°±æ˜¯ä¸€ä¸ªå›¢é˜Ÿï¼ˆAI è™½ç„¶ä¸ä¾¿å®œï¼Œä½†æ˜¯æ¯”è¯·äººå¯ä¾¿å®œå¤šäº†ï¼‰ã€‚</p>
<p>å‰ç«¯å¼€å‘è€…ï¼Œå‡­å€Ÿå¯¹ <strong>ç”¨æˆ·ä½“éªŒï¼ˆUXï¼‰</strong> çš„æ•æ„Ÿåº¦ï¼ŒåŠ ä¸Š AI å¼ºå¤§çš„åç«¯å¡«è¡¥èƒ½åŠ›ï¼Œå°†æˆä¸ºæœ€å®¹æ˜“è½¬å‹ä¸ºâ€œç‹¬ç«‹å¼€å‘è€…â€æˆ–â€œè¶…çº§ä¸ªä½“â€çš„äººç¾¤ã€‚</p>
<h3 data-id="heading-6">2. ä» â€œæ€ä¹ˆå®ç°â€ åˆ° â€œå¦‚ä½•è§£å†³é—®é¢˜â€</h3>
<p>åœ¨ä»¥å‰ï¼Œæˆ‘ä»¬è¿™äº›ç¨‹åºå‘˜ 80% çš„æ—¶é—´åœ¨ç ”ç©¶ "å¦‚ä½•å»å®ç°æŸä¸€ä¸ªåŠŸèƒ½"ï¼ˆè¿™ä¸ªæ•ˆæœæ€ä¹ˆç”¨ CSS å®ç°ï¼Ÿè¿™ä¸ªçŠ¶æ€æ€ä¹ˆç®¡ç†ï¼Ÿï¼‰ã€‚</p>
<p>ä½†æ˜¯ç°åœ¨ï¼Œä¸éœ€è¦äº†ã€‚</p>
<p>ç°åœ¨ï¼Œæ— è®ºæ˜¯ Claude è¿˜æ˜¯ GPT éƒ½å¯ä»¥å¸®åŠ©æˆ‘ä»¬å»è§£å†³å¦‚ä½•å®ç°åŠŸèƒ½çš„é—®é¢˜ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠé‡ç‚¹æ”¹ä¸ºï¼š<strong>æˆ‘ä»¬è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿç”¨æˆ·çš„ç—›ç‚¹åœ¨å“ªé‡Œï¼Ÿç³»ç»Ÿçš„æ•°æ®æµæ€ä¹ˆè®¾è®¡æ‰åˆç†ï¼Ÿ</strong></p>
<p>åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œ<strong>å¯¹ç”¨æˆ·å’Œéœ€æ±‚çš„æ„ŸçŸ¥åŠ›</strong> æ­£å˜çš„è¶Šæ¥è¶Šé‡è¦ã€‚</p>
<p><strong>æœ€åï¼Œæˆ‘æƒ³é—®å¤§å®¶ä¸€ä¸ªé—®é¢˜ï¼š</strong></p>
<blockquote>
<p>å¦‚æœæ˜å¤©ï¼Œä½ ä¸éœ€è¦å†å†™ä¸€è¡Œå…·ä½“çš„ä¸šåŠ¡ä»£ç ï¼Œåªéœ€è¦å®¡æ ¸ Agent æäº¤çš„ PRï¼Œä½ ä¼šæŠŠä½ çœä¸‹æ¥çš„è¿™ 8 ä¸ªå°æ—¶ï¼Œç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p><strong>æ˜¯å»å­¦æ–°çš„æŠ€æœ¯ï¼Ÿè¿˜æ˜¯å»æ·±å…¥ç†è§£ä¸šåŠ¡ï¼Ÿæˆ–è€…ï¼Œå»åˆ›é€ ä¸€ä¸ªå±äºä½ è‡ªå·±çš„äº§å“ï¼Ÿ</strong></p>
<p>è¿™æ‰æ˜¯ <strong>2026 æˆ‘ä»¬æ€è€ƒçš„äº‹æƒ…</strong></p>
<p>åˆ«å…‰çœ‹ç€è·‘åˆ†æ¿€åŠ¨äº†ã€‚è¡ŒåŠ¨èµ·æ¥ï¼Œå»ç”³è¯· APIï¼Œå»æŠŠä½ çš„ IDE æ¢æˆ Cursor æˆ–è€… Windsurfï¼Œå»æ„Ÿå—ä¸€ä¸‹è¿™ç§ <strong>â€œä¸ç¡…åŸºç”Ÿç‰©ç»“å¯¹ç¼–ç¨‹â€</strong> çš„æ„Ÿè§‰ã€‚</p>
<p>æˆ‘æ˜¯ Sundayã€‚å¦‚æœä½ åœ¨ç”¨è¿™ä¸¤ä¸ªæ¨¡å‹çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä»€ä¹ˆå‘ï¼Œæˆ–è€…å‘ç°äº†ä»€ä¹ˆæ–°ç©æ³•ï¼Œéšæ—¶åœ¨è¯„è®ºåŒºæˆ–è€…ç¾¤é‡Œå‘Šè¯‰æˆ‘ã€‚æˆ‘ä»¬ä¸€èµ·ç ”ç©¶ï¼Œç»ä¸æ‰é˜Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å¼€å§‹å­¦Flinkï¼šFlink SQL æç®€å…¥é—¨]]></title>    <link>https://juejin.cn/post/7603393977476497434</link>    <guid>https://juejin.cn/post/7603393977476497434</guid>    <pubDate>2026-02-06T06:59:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603393977476497434" data-draft-id="7603321550246510642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å¼€å§‹å­¦Flinkï¼šFlink SQL æç®€å…¥é—¨"/> <meta itemprop="keywords" content="Flink,å¤§æ•°æ®,SQL"/> <meta itemprop="datePublished" content="2026-02-06T06:59:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç åŒ å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/1697301684826952"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å¼€å§‹å­¦Flinkï¼šFlink SQL æç®€å…¥é—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1697301684826952/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç åŒ å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T06:59:43.000Z" title="Fri Feb 06 2026 06:59:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    25
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Flink SQL æ˜¯ Apache Flink çš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œå®ƒè®©å¼€å‘è€…å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ SQL è¯­æ³•æ¥ç¼–å†™æµå¤„ç†å’Œæ‰¹å¤„ç†ä½œä¸šã€‚å¯¹äºä¸æƒ³æ·±ç©¶ Java/Scala å¤æ‚ API çš„â€œå°ç™½â€æ¥è¯´ï¼ŒFlink SQL æ˜¯è¿›å…¥å®æ—¶è®¡ç®—é¢†åŸŸçš„æœ€ä½³æ•²é—¨ç –ã€‚</p>
<p>æœ¬æ–‡å°†åŸºäº <strong>Flink 1.20.1</strong> ç‰ˆæœ¬ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ åœ¨ WSL2 (Ubuntu) ç¯å¢ƒä¸‹æ­å»ºç¯å¢ƒï¼Œå¹¶è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ª Flink SQL ä»»åŠ¡ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© Flink SQLï¼Ÿ</h2>
<ol>
<li><strong>ä½é—¨æ§›</strong>ï¼šä¼šå†™ SQL å°±èƒ½å¼€å‘å®æ—¶ä»»åŠ¡ã€‚</li>
<li><strong>ç»Ÿä¸€æ€§</strong>ï¼šæ‰¹æµä¸€ä½“ï¼ŒåŒä¸€å¥— SQL æ—¢å¯ä»¥è·‘å†å²æ•°æ®ï¼ˆæ‰¹ï¼‰ï¼Œä¹Ÿå¯ä»¥è·‘å®æ—¶æ•°æ®ï¼ˆæµï¼‰ã€‚</li>
<li><strong>ç”Ÿæ€ä¸°å¯Œ</strong>ï¼šå†…ç½®äº†å¤§é‡çš„ Connectorï¼ˆè¿æ¥å™¨ï¼‰ï¼Œè½»æ¾è¿æ¥ Kafkaã€MySQLã€Hive ç­‰ä¸»æµç»„ä»¶ã€‚</li>
</ol>
<p><img src="https://pic-1258258471.cos.ap-nanjing.myqcloud.com/img/fKaLmuiLB.jpeg" alt="Flink SQL æ¶æ„å›¾" loading="lazy"/>
<em>(å›¾ï¼šFlink SQL æ¶æ„ç¤ºæ„å›¾ï¼Œå±•ç¤º SQL è§£æã€ä¼˜åŒ–åˆ°æ‰§è¡Œçš„è¿‡ç¨‹)</em></p>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒå‡†å¤‡ (WSL2 Ubuntu)</h2>
<p>æœ¬æ•™ç¨‹æ¼”ç¤ºç¯å¢ƒä¸º Windows ä¸‹çš„ WSL2 (Ubuntu 20.04/22.04)ï¼Œè¿™æ˜¯ç›®å‰ Windows ç”¨æˆ·ä½“éªŒ Linux å¼€å‘ç¯å¢ƒçš„æœ€ä½³å§¿åŠ¿ã€‚
å‚è€ƒä»¥å‰å†™çš„æ–‡ç« <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F2_d434kpSeKrSh-krRgvsQ" target="_blank" title="https://mp.weixin.qq.com/s/2_d434kpSeKrSh-krRgvsQ" ref="nofollow noopener noreferrer">ä»é›¶å¼€å§‹å­¦Flinkï¼šæ­å¼€å®æ—¶è®¡ç®—çš„ç¥ç§˜é¢çº±</a>ï¼Œæ­å»ºå¥½ Flink ç¯å¢ƒã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ä½“éªŒ Flink SQL Client</h2>
<p>Flink æä¾›äº†ä¸€ä¸ªäº¤äº’å¼çš„å‘½ä»¤è¡Œå·¥å…·ï¼š<strong>SQL Client</strong>ã€‚å®ƒå…è®¸ä½ ç›´æ¥åœ¨ç»ˆç«¯ç¼–å†™å’Œæäº¤ SQL ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-3">1. å¯åŠ¨ SQL Client</h3>
<p>å¦‚æœæ²¡æœ‰å¯åŠ¨Flinké›†ç¾¤,åˆ™å…ˆå¯åŠ¨flinké›†ç¾¤:</p>
<pre><code class="hljs language-bash" lang="bash">./bin/start-cluster.sh
</code></pre>
<p>,ç„¶ååœ¨ Flink ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./bin/sql-client.sh
</code></pre>
<p>ä½ å°†çœ‹åˆ°é‚£åªè‘—åçš„æ¾é¼  LOGOï¼š</p>
<p><img src="https://pic-1258258471.cos.ap-nanjing.myqcloud.com/img/20260206133223512.png" alt="SQLClientå¯åŠ¨ç•Œé¢" loading="lazy"/>
<em>(å›¾ï¼šSQL Client å¯åŠ¨æ¬¢è¿ç•Œé¢)</em></p>
<h3 data-id="heading-4">2. Hello Worldï¼šæ•°æ®ç”Ÿæˆä¸æ‰“å°</h3>
<p>æˆ‘ä»¬ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨ç»„ä»¶ï¼ˆå¦‚ Kafkaï¼‰ï¼Œç›´æ¥ä½¿ç”¨ Flink å†…ç½®çš„ <code>datagen</code> è¿æ¥å™¨ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼Œå¹¶ç”¨ <code>print</code> è¿æ¥å™¨æ‰“å°ç»“æœã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæºè¡¨ (Source Table)</strong></p>
<p>å¤åˆ¶ä»¥ä¸‹ SQL åˆ° SQL Client ä¸­æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> source_table (
    id <span class="hljs-type">INT</span>,
    name STRING,
    ts <span class="hljs-type">TIMESTAMP</span>(<span class="hljs-number">3</span>),
    WATERMARK <span class="hljs-keyword">FOR</span> ts <span class="hljs-keyword">AS</span> ts <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-string">'5'</span> <span class="hljs-keyword">SECOND</span>
) <span class="hljs-keyword">WITH</span> (
    <span class="hljs-string">'connector'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'datagen'</span>,       <span class="hljs-comment">-- ä½¿ç”¨æ•°æ®ç”Ÿæˆå™¨</span>
    <span class="hljs-string">'rows-per-second'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'1'</span>,       <span class="hljs-comment">-- æ¯ç§’ç”Ÿæˆ1æ¡æ•°æ®</span>
    <span class="hljs-string">'fields.id.kind'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'sequence'</span>, <span class="hljs-comment">-- id å­—æ®µä¸ºåºåˆ—</span>
    <span class="hljs-string">'fields.id.start'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'1'</span>,       <span class="hljs-comment">-- id ä»1å¼€å§‹</span>
    <span class="hljs-string">'fields.id.end'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'100'</span>        <span class="hljs-comment">-- id åˆ°100ç»“æŸ</span>
);
</code></pre>
<p>æ‰§è¡Œåæ˜¾ç¤º <code>[INFO] Execute statement succeed.</code>ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç»“æœè¡¨ (Sink Table)</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> print_table (
    id <span class="hljs-type">INT</span>,
    name STRING,
    ts <span class="hljs-type">TIMESTAMP</span>(<span class="hljs-number">3</span>)
) <span class="hljs-keyword">WITH</span> (
    <span class="hljs-string">'connector'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'print'</span>          <span class="hljs-comment">-- ä½¿ç”¨æ§åˆ¶å°æ‰“å°è¿æ¥å™¨</span>
);
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šæäº¤ä»»åŠ¡</strong></p>
<p>å°†æºè¡¨çš„æ•°æ®æ’å…¥åˆ°ç»“æœè¡¨ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> print_table <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> source_table;
</code></pre>
<p>æ­¤æ—¶ï¼ŒSQL Client ä¼šæäº¤ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡åˆ°é›†ç¾¤ã€‚ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ Job ID çš„è¾“å‡ºã€‚</p>
<h3 data-id="heading-5">3. æŸ¥çœ‹è¿è¡Œç»“æœ</h3>
<p>ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <code>print</code> è¿æ¥å™¨ï¼Œåœ¨ Standalone æ¨¡å¼ä¸‹ï¼Œè¾“å‡ºä¼šæ‰“å°åˆ° TaskManager çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p>
<p>æ‰“å¼€ä¸€ä¸ªæ–°çš„ WSL2 ç»ˆç«¯çª—å£ï¼Œè¿›å…¥ Flink ç›®å½•æŸ¥çœ‹æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥ log ç›®å½•</span>
<span class="hljs-built_in">cd</span> <span class="hljs-built_in">log</span>

<span class="hljs-comment"># æŸ¥çœ‹æœ€æ–°çš„ .out æ–‡ä»¶ (æ–‡ä»¶ååŒ…å« taskexecutor)</span>
<span class="hljs-built_in">tail</span> -f flink-*-taskexecutor-*.out
</code></pre>
<p>ä½ åº”è¯¥èƒ½çœ‹åˆ°å±å¹•ä¸Šä¸æ–­è·³åŠ¨çš„æ•°æ®æµï¼š</p>
<p><img src="https://pic-1258258471.cos.ap-nanjing.myqcloud.com/img/20260206134253149.png" alt="è¿è¡Œç»“æœæ—¥å¿—æˆªå›¾ä½ç½®" loading="lazy"/>
<em>(å›¾ï¼šç»ˆç«¯ tail -f å‘½ä»¤çœ‹åˆ°çš„å®æ—¶æ•°æ®è¾“å‡º)</em></p>
<h2 data-id="heading-6">å››ã€å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h2>
<p>åœ¨ SQL Client ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<ul>
<li><code>HELP</code>: æŸ¥çœ‹å¸®åŠ©ã€‚</li>
<li><code>SHOW TABLES</code>: æŸ¥çœ‹å½“å‰åˆ›å»ºçš„è¡¨ã€‚</li>
<li><code>SHOW JOBS</code>: æŸ¥çœ‹è¿è¡Œä¸­çš„ä½œä¸šã€‚</li>
<li><code>DESCRIBE table_name</code>: æŸ¥çœ‹è¡¨ç»“æ„ã€‚</li>
<li><code>QUIT</code>: é€€å‡º SQL Clientã€‚</li>
</ul>
<h2 data-id="heading-7">äº”ã€æ€»ç»“</h2>
<p>æ­å–œä½ ï¼ä½ å·²ç»æˆåŠŸè¿è¡Œäº†äººç”Ÿä¸­ç¬¬ä¸€ä¸ª Flink SQL ä»»åŠ¡ã€‚</p>
<p>é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å®Œæˆäº†ï¼š</p>
<ol>
<li>WSL2 ä¸‹ Java å’Œ Flink 1.20.1 çš„å®‰è£…ã€‚</li>
<li>å¯åŠ¨äº† Flink æœ¬åœ°é›†ç¾¤ã€‚</li>
<li>ä½¿ç”¨ SQL Client åˆ›å»ºäº† Source å’Œ Sink è¡¨ï¼Œå¹¶è·‘é€šäº†æ•°æ®æµã€‚</li>
</ol>
<p>ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥è®²è§£ Flink SQL ä¸­çš„**çª—å£ï¼ˆWindowï¼‰**æ“ä½œï¼Œçœ‹çœ‹å¦‚ä½•å¤„ç†â€œè¿‡å»5åˆ†é’Ÿçš„è®¢å•æ€»é¢â€è¿™ç±»ç»å…¸éœ€æ±‚ã€‚</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnightlies.apache.org%2Fflink%2Fflink-docs-release-1.20%2F" target="_blank" title="https://nightlies.apache.org/flink/flink-docs-release-1.20/" ref="nofollow noopener noreferrer">Flink å®˜æ–¹æ–‡æ¡£</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶åˆ°ä¸€ï¼šåŸºäº micro-app çš„ä¼ä¸šçº§å¾®å‰ç«¯æ¨¡æ¿å®Œæ•´å®ç°æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603567912593424411</link>    <guid>https://juejin.cn/post/7603567912593424411</guid>    <pubDate>2026-02-07T07:39:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603567912593424411" data-draft-id="7603567912593391643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶åˆ°ä¸€ï¼šåŸºäº micro-app çš„ä¼ä¸šçº§å¾®å‰ç«¯æ¨¡æ¿å®Œæ•´å®ç°æŒ‡å—"/> <meta itemprop="keywords" content="æ¶æ„,å‰ç«¯,å¾®æœåŠ¡"/> <meta itemprop="datePublished" content="2026-02-07T07:39:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RemHusband"/> <meta itemprop="url" content="https://juejin.cn/user/1425415102792237"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶åˆ°ä¸€ï¼šåŸºäº micro-app çš„ä¼ä¸šçº§å¾®å‰ç«¯æ¨¡æ¿å®Œæ•´å®ç°æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1425415102792237/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RemHusband
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T07:39:18.000Z" title="Sat Feb 07 2026 07:39:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>æœ¬æ–‡æ˜¯ä¸€ç¯‡å®Œæ•´çš„æŠ€æœ¯å®è·µæ–‡ç« ï¼Œè®°å½•äº†å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªä¼ä¸šçº§ micro-app å¾®å‰ç«¯æ¨¡æ¿é¡¹ç›®ã€‚æ–‡ç« åŒ…å«å®Œæ•´çš„æŠ€æœ¯é€‰å‹ã€æ¶æ„è®¾è®¡ã€æ ¸å¿ƒä»£ç å®ç°ã€è¸©å‘ç»éªŒä»¥åŠæœ€ä½³å®è·µï¼Œé€‚åˆæœ‰ä¸€å®šå‰ç«¯åŸºç¡€çš„å¼€å‘è€…æ·±å…¥å­¦ä¹ ã€‚</strong></p>
</blockquote>
<h2 data-id="heading-0">ğŸ“‹ æ–‡ç« æ‘˜è¦</h2>
<p>æœ¬æ–‡è¯¦ç»†è®°å½•äº†åŸºäº <strong>micro-app</strong> æ¡†æ¶æ„å»ºä¼ä¸šçº§å¾®å‰ç«¯æ¨¡æ¿çš„å®Œæ•´å®ç°è¿‡ç¨‹ã€‚é¡¹ç›®é‡‡ç”¨ <strong>Vue 3 + TypeScript + Vite</strong> æŠ€æœ¯æ ˆï¼Œå®ç°äº†å®Œæ•´çš„ä¸»å­åº”ç”¨é€šä¿¡ã€è·¯ç”±åŒæ­¥ã€ç‹¬ç«‹è¿è¡Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚æ–‡ç« ä¸ä»…åŒ…å«æŠ€æœ¯é€‰å‹åˆ†æã€æ¶æ„è®¾è®¡æ€è·¯ï¼Œè¿˜æä¾›äº†å¤§é‡å¯ç›´æ¥ä½¿ç”¨çš„ä»£ç ç¤ºä¾‹å’Œå®æˆ˜ç»éªŒï¼Œå¸®åŠ©è¯»è€…å¿«é€ŸæŒæ¡å¾®å‰ç«¯å¼€å‘çš„æ ¸å¿ƒæŠ€èƒ½ã€‚</p>
<h3 data-id="heading-1">ğŸ¯ ä½ å°†å­¦åˆ°ä»€ä¹ˆ</h3>
<ul>
<li>âœ… micro-app æ¡†æ¶çš„æ ¸å¿ƒç‰¹æ€§å’Œä½¿ç”¨æŠ€å·§</li>
<li>âœ… å¾®å‰ç«¯æ¶æ„è®¾è®¡æ€è·¯å’Œæœ€ä½³å®è·µ</li>
<li>âœ… ä¸»å­åº”ç”¨åŒå‘é€šä¿¡çš„å®Œæ•´å®ç°æ–¹æ¡ˆ</li>
<li>âœ… è·¯ç”±åŒæ­¥å’Œè·¨åº”ç”¨å¯¼èˆªçš„å®ç°ç»†èŠ‚</li>
<li>âœ… TypeScript ç±»å‹å®‰å…¨çš„å¾®å‰ç«¯å¼€å‘å®è·µ</li>
<li>âœ… äº‹ä»¶æ€»çº¿è§£è€¦å’Œä»£ç ç»„ç»‡æŠ€å·§</li>
<li>âœ… å¼€å‘/ç”Ÿäº§ç¯å¢ƒé…ç½®ç®¡ç†æ–¹æ¡ˆ</li>
<li>âœ… å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå’Œè¸©å‘ç»éªŒ</li>
</ul>
<h3 data-id="heading-2">ğŸ’ é¡¹ç›®äº®ç‚¹</h3>
<ul>
<li>ğŸš€ <strong>å¼€ç®±å³ç”¨</strong>ï¼šå®Œæ•´çš„é¡¹ç›®æ¨¡æ¿ï¼Œå¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒ</li>
<li>ğŸ”’ <strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œé›¶ <code>@ts-ignore</code>ï¼Œé›¶ <code>any</code></li>
<li>ğŸ¨ <strong>ä¼ä¸šçº§å®è·µ</strong>ï¼šå¯æ”¯æ’‘çœŸå®ä¼ä¸šé¡¹ç›®</li>
<li>ğŸ“¦ <strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼šå­åº”ç”¨æ”¯æŒç‹¬ç«‹å¼€å‘å’Œè°ƒè¯•</li>
<li>ğŸ”„ <strong>æ™ºèƒ½é€šä¿¡</strong>ï¼šç­–ç•¥æ¨¡å¼å¤„ç†ä¸åŒç±»å‹äº‹ä»¶ï¼Œä»£ç æ¸…æ™°æ˜“ç»´æŠ¤</li>
<li>ğŸ› ï¸ <strong>ä¸€é”®å¯åŠ¨</strong>ï¼šå¹¶è¡Œå¯åŠ¨æ‰€æœ‰åº”ç”¨ï¼Œæå‡å¼€å‘æ•ˆç‡</li>
</ul>
<h3 data-id="heading-3">ğŸ‰ å¼€æºåœ°å€</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fecho-52hz%2Fmicro-app-front-end" target="_blank" title="https://gitee.com/echo-52hz/micro-app-front-end" ref="nofollow noopener noreferrer">micro-app-front-end</a></p>
<hr/>
<h2 data-id="heading-4">ğŸ“‘ ç›®å½•</h2>
<ul>
<li><a href="#%E4%B8%80%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF%E4%B8%8E%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90" title="#%E4%B8%80%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF%E4%B8%8E%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸éœ€æ±‚åˆ†æ</a></li>
<li><a href="#%E4%BA%8C%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E4%B8%8E%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90" title="#%E4%BA%8C%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E4%B8%8E%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90">äºŒã€æŠ€æœ¯é€‰å‹ä¸å¯¹æ¯”åˆ†æ</a></li>
<li><a href="#%E4%B8%89%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3" title="#%E4%B8%89%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E8%AF%A6%E8%A7%A3">ä¸‰ã€æ¶æ„è®¾è®¡è¯¦è§£</a></li>
<li><a href="#%E5%9B%9B%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" title="#%E5%9B%9B%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0">å››ã€æ ¸å¿ƒåŠŸèƒ½å®ç°</a>
<ul>
<li><a href="#41-%E4%B8%BB%E5%BA%94%E7%94%A8%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9D%97" title="#41-%E4%B8%BB%E5%BA%94%E7%94%A8%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9D%97">4.1 ä¸»åº”ç”¨é€šä¿¡æ¨¡å—</a></li>
<li><a href="#42-%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF%E6%A8%A1%E5%9D%97" title="#42-%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF%E6%A8%A1%E5%9D%97">4.2 äº‹ä»¶æ€»çº¿æ¨¡å—</a></li>
<li><a href="#43-%E5%AD%90%E5%BA%94%E7%94%A8%E9%80%9A%E4%BF%A1%E6%9C%8D%E5%8A%A1" title="#43-%E5%AD%90%E5%BA%94%E7%94%A8%E9%80%9A%E4%BF%A1%E6%9C%8D%E5%8A%A1">4.3 å­åº”ç”¨é€šä¿¡æœåŠ¡</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94%E5%85%B3%E9%94%AE%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82" title="#%E4%BA%94%E5%85%B3%E9%94%AE%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82">äº”ã€å…³é”®å®ç°ç»†èŠ‚</a></li>
<li><a href="#%E5%85%AD%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E4%BC%98%E5%8C%96" title="#%E5%85%AD%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E4%BC%98%E5%8C%96">å…­ã€æœ€ä½³å®è·µä¸ä¼˜åŒ–</a></li>
<li><a href="#%E4%B8%83%E8%B8%A9%E5%9D%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93" title="#%E4%B8%83%E8%B8%A9%E5%9D%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93">ä¸ƒã€è¸©å‘ç»éªŒæ€»ç»“</a></li>
<li><a href="#%E5%85%AB%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B" title="#%E5%85%AB%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B">å…«ã€é¡¹ç›®æ€»ç»“ä¸å±•æœ›</a></li>
</ul>
<hr/>
<h2 data-id="heading-5">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸éœ€æ±‚åˆ†æ</h2>
<h3 data-id="heading-6">1.1 ä¸ºä»€ä¹ˆé€‰æ‹©å¾®å‰ç«¯ï¼Ÿ</h3>
<p>éšç€å‰ç«¯åº”ç”¨è§„æ¨¡çš„ä¸æ–­å¢é•¿ï¼Œä¼ ç»Ÿçš„å•ä½“åº”ç”¨æ¶æ„é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ï¼š</p>
<ul>
<li><strong>å›¢é˜Ÿåä½œå›°éš¾</strong>ï¼šå¤šä¸ªå›¢é˜Ÿç»´æŠ¤åŒä¸€ä¸ªä»£ç åº“ï¼Œå®¹æ˜“äº§ç”Ÿå†²çª</li>
<li><strong>æŠ€æœ¯æ ˆé™åˆ¶</strong>ï¼šéš¾ä»¥å¼•å…¥æ–°æŠ€æœ¯ï¼Œå‡çº§æˆæœ¬é«˜</li>
<li><strong>éƒ¨ç½²æ•ˆç‡ä½</strong>ï¼šä»»ä½•å°æ”¹åŠ¨éƒ½éœ€è¦æ•´ä½“å‘å¸ƒ</li>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šåº”ç”¨ä½“ç§¯è¿‡å¤§ï¼Œé¦–å±åŠ è½½æ…¢</li>
</ul>
<p>å¾®å‰ç«¯æ¶æ„é€šè¿‡å°†å¤§å‹åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„å°åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨å¯ä»¥ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ï¼Œæœ‰æ•ˆè§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚</p>
<h3 data-id="heading-7">1.2 é¡¹ç›®éœ€æ±‚</h3>
<p>åŸºäºä¼ä¸šçº§å¾®å‰ç«¯é¡¹ç›®å®è·µï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªå¼€ç®±å³ç”¨çš„ micro-app å¾®å‰ç«¯æ¨¡æ¿ï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li><strong>å®Œæ•´çš„é€šä¿¡æœºåˆ¶</strong>ï¼šä¸»å­åº”ç”¨ä¹‹é—´çš„åŒå‘æ•°æ®é€šä¿¡ï¼Œæ”¯æŒå¤šç§äº‹ä»¶ç±»å‹</li>
<li><strong>è·¯ç”±åŒæ­¥</strong>ï¼šè‡ªåŠ¨å¤„ç†è·¯ç”±åŒæ­¥ï¼Œæ”¯æŒæµè§ˆå™¨å‰è¿›åé€€ï¼Œç”¨æˆ·ä½“éªŒæµç•…</li>
<li><strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼šå­åº”ç”¨æ”¯æŒç‹¬ç«‹å¼€å‘å’Œè°ƒè¯•ï¼Œæå‡å¼€å‘æ•ˆç‡</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>ç¯å¢ƒé€‚é…</strong>ï¼šæ”¯æŒå¼€å‘/ç”Ÿäº§ç¯å¢ƒï¼ŒåŒåŸŸ/è·¨åŸŸéƒ¨ç½²</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§</li>
</ol>
<h3 data-id="heading-8">1.3 é¡¹ç›®ç›®æ ‡</h3>
<ul>
<li>âœ… æä¾›å¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒçš„å®Œæ•´æ¨¡æ¿</li>
<li>âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•</li>
<li>âœ… å®Œæ•´çš„æ–‡æ¡£å’Œæœ€ä½³å®è·µæŒ‡å—</li>
<li>âœ… è§£å†³å¸¸è§é—®é¢˜ï¼Œé¿å…é‡å¤è¸©å‘</li>
</ul>
<hr/>
<h2 data-id="heading-9">æŠ€æœ¯é€‰å‹</h2>
<h3 data-id="heading-10">å¾®å‰ç«¯æ¡†æ¶: micro-app</h3>
<p><strong>é€‰æ‹©ç†ç”±</strong>:</p>
<ol>
<li><strong>åŸºäº WebComponent</strong>: å¤©ç„¶å®ç°æ ·å¼éš”ç¦»</li>
<li><strong>åŸç”Ÿè·¯ç”±æ¨¡å¼</strong>: å­åº”ç”¨ä½¿ç”¨ <code>createWebHistory</code>ï¼Œæ¡†æ¶è‡ªåŠ¨åŠ«æŒè·¯ç”±</li>
<li><strong>å†…ç½®é€šä¿¡æœºåˆ¶</strong>: æ— éœ€é¢å¤–é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
<li><strong>è½»é‡çº§</strong>: ç›¸æ¯” qiankun æ›´è½»é‡ï¼Œæ€§èƒ½æ›´å¥½</li>
</ol>
<p><strong>ç‰ˆæœ¬</strong>: <code>@micro-zoe/micro-app@1.0.0-rc.28</code></p>
<h3 data-id="heading-11">å‰ç«¯æ¡†æ¶: Vue 3 + TypeScript</h3>
<p><strong>é€‰æ‹©ç†ç”±</strong>:</p>
<ol>
<li><strong>ç»„åˆå¼ API</strong>: æ›´å¥½çš„é€»è¾‘å¤ç”¨å’Œç±»å‹æ¨å¯¼</li>
<li><strong>TypeScript æ”¯æŒ</strong>: å®Œæ•´çš„ç±»å‹å®‰å…¨</li>
<li><strong>ç”Ÿæ€æˆç†Ÿ</strong>: ä¸°å¯Œçš„æ’ä»¶å’Œå·¥å…·é“¾</li>
</ol>
<h3 data-id="heading-12">æ„å»ºå·¥å…·: Vite</h3>
<p><strong>é€‰æ‹©ç†ç”±</strong>:</p>
<ol>
<li><strong>æé€Ÿå¼€å‘ä½“éªŒ</strong>: HMR é€Ÿåº¦å¿«</li>
<li><strong>åŸç”Ÿ ES æ¨¡å—</strong>: æ›´å¥½çš„å¼€å‘ä½“éªŒ</li>
<li><strong>é…ç½®ç®€å•</strong>: å¼€ç®±å³ç”¨</li>
</ol>
<p><strong>æ³¨æ„</strong>: Vite ä½œä¸ºå­åº”ç”¨æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ iframe æ²™ç®±æ¨¡å¼</p>
<hr/>
<h2 data-id="heading-13">ä¸‰ã€æ¶æ„è®¾è®¡è¯¦è§£</h2>
<h3 data-id="heading-14">3.1 é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-bash" lang="bash">micro-app/
â”œâ”€â”€ main-app/              <span class="hljs-comment"># ä¸»åº”ç”¨ï¼ˆåŸºåº§åº”ç”¨ï¼‰</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/    <span class="hljs-comment"># ç»„ä»¶ç›®å½•</span>
â”‚   â”‚   â”‚   â””â”€â”€ MicroAppContainer.vue  <span class="hljs-comment"># å­åº”ç”¨å®¹å™¨ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ config/        <span class="hljs-comment"># é…ç½®æ–‡ä»¶</span>
â”‚   â”‚   â”‚   â””â”€â”€ microApps.ts  <span class="hljs-comment"># å­åº”ç”¨é…ç½®ç®¡ç†</span>
â”‚   â”‚   â”œâ”€â”€ router/        <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
â”‚   â”‚   â”œâ”€â”€ types/         <span class="hljs-comment"># TypeScript ç±»å‹å®šä¹‰</span>
â”‚   â”‚   â”‚   â””â”€â”€ micro-app.ts  <span class="hljs-comment"># å¾®å‰ç«¯ç›¸å…³ç±»å‹</span>
â”‚   â”‚   â”œâ”€â”€ utils/         <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ microAppCommunication.ts  <span class="hljs-comment"># é€šä¿¡å·¥å…·</span>
â”‚   â”‚   â”‚   â””â”€â”€ microAppEventBus.ts  <span class="hljs-comment"># äº‹ä»¶æ€»çº¿</span>
â”‚   â”‚   â”œâ”€â”€ views/         <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ App.vue        <span class="hljs-comment"># æ ¹ç»„ä»¶</span>
â”‚   â”‚   â””â”€â”€ main.ts        <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ vite.config.ts     <span class="hljs-comment"># Vite é…ç½®</span>
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ sub-app-1/             <span class="hljs-comment"># å­åº”ç”¨ 1</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ plugins/       <span class="hljs-comment"># æ’ä»¶ç›®å½•</span>
â”‚   â”‚   â”‚   â””â”€â”€ micro-app.ts  <span class="hljs-comment"># MicroAppService é€šä¿¡æœåŠ¡</span>
â”‚   â”‚   â”œâ”€â”€ router/        <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
â”‚   â”‚   â”œâ”€â”€ utils/         <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”‚   â”‚   â”‚   â”œâ”€â”€ env.ts     <span class="hljs-comment"># ç¯å¢ƒæ£€æµ‹</span>
â”‚   â”‚   â”‚   â””â”€â”€ navigation.ts  <span class="hljs-comment"># å¯¼èˆªå·¥å…·</span>
â”‚   â”‚   â”œâ”€â”€ types/         <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”‚   â”‚   â”œâ”€â”€ views/         <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ App.vue        <span class="hljs-comment"># æ ¹ç»„ä»¶</span>
â”‚   â”‚   â””â”€â”€ main.ts        <span class="hljs-comment"># å…¥å£æ–‡ä»¶ï¼ˆæ”¯æŒç‹¬ç«‹è¿è¡Œï¼‰</span>
â”‚   â”œâ”€â”€ vite.config.ts     <span class="hljs-comment"># Vite é…ç½®</span>
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ sub-app-2/             <span class="hljs-comment"># å­åº”ç”¨ 2ï¼ˆç»“æ„åŒ sub-app-1ï¼‰</span>
â”œâ”€â”€ sub-app-3/             <span class="hljs-comment"># å­åº”ç”¨ 3ï¼ˆç»“æ„åŒ sub-app-1ï¼‰</span>
â”œâ”€â”€ docs/                  <span class="hljs-comment"># æ–‡æ¡£ç›®å½•</span>
â”‚   â”œâ”€â”€ TROUBLESHOOTING.md  <span class="hljs-comment"># è¸©å‘è®°å½•</span>
â”‚   â”œâ”€â”€ IMPLEMENTATION_LOG.md  <span class="hljs-comment"># å®ç°è¿‡ç¨‹è®°å½•</span>
â”‚   â””â”€â”€ FAQ.md             <span class="hljs-comment"># å¸¸è§é—®é¢˜</span>
â”œâ”€â”€ package.json           <span class="hljs-comment"># æ ¹ç›®å½•é…ç½®ï¼ˆä¸€é”®å¯åŠ¨è„šæœ¬ï¼‰</span>
â””â”€â”€ README.md              <span class="hljs-comment"># é¡¹ç›®è¯´æ˜æ–‡æ¡£</span>
</code></pre>
<h3 data-id="heading-15">3.2 æ ¸å¿ƒæ¨¡å—è®¾è®¡</h3>
<h4 data-id="heading-16">3.2.1 ä¸»åº”ç”¨é€šä¿¡æ¨¡å— (<code>microAppCommunication.ts</code>)</h4>
<p><strong>è®¾è®¡æ€è·¯</strong>ï¼š</p>
<p>ä¸»åº”ç”¨é€šä¿¡æ¨¡å—æ˜¯æ•´ä¸ªå¾®å‰ç«¯æ¶æ„çš„æ ¸å¿ƒï¼Œè´Ÿè´£ä¸»å­åº”ç”¨ä¹‹é—´çš„æ•°æ®é€šä¿¡ã€‚æˆ‘ä»¬é‡‡ç”¨<strong>ç­–ç•¥æ¨¡å¼</strong>å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œä½¿ä»£ç ç»“æ„æ¸…æ™°ã€æ˜“äºæ‰©å±•ã€‚</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‘å­åº”ç”¨å‘é€æ•°æ®</strong>ï¼š<code>microAppSetData()</code></p>
<ul>
<li>è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼Œç¡®ä¿æ•°æ®å˜åŒ–è¢«æ£€æµ‹</li>
<li>è‡ªåŠ¨æ·»åŠ æ¥æºæ ‡è¯†ï¼Œä¾¿äºè°ƒè¯•</li>
</ul>
</li>
<li>
<p><strong>è·¨åº”ç”¨è·¯ç”±è·³è½¬</strong>ï¼š<code>microAppTarget()</code></p>
<ul>
<li>æ™ºèƒ½åŒºåˆ†åŒåº”ç”¨å†…è·³è½¬å’Œè·¨åº”ç”¨è·³è½¬</li>
<li>åŒåº”ç”¨å†…ï¼šé€šè¿‡é€šä¿¡è®©å­åº”ç”¨è‡ªå·±è·³è½¬</li>
<li>è·¨åº”ç”¨ï¼šé€šè¿‡ä¸»åº”ç”¨è·¯ç”±è·³è½¬</li>
</ul>
</li>
<li>
<p><strong>ç»Ÿä¸€çš„æ•°æ®ç›‘å¬å¤„ç†å™¨</strong>ï¼š<code>microAppDataListener()</code></p>
<ul>
<li>ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶</li>
<li>æ”¯æŒæ‰©å±•æ–°çš„äº‹ä»¶ç±»å‹</li>
</ul>
</li>
</ol>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å‘æŒ‡å®šå­åº”ç”¨å‘é€æ•°æ®
 * è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼Œç¡®ä¿æ•°æ®å˜åŒ–è¢«æ£€æµ‹åˆ°
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> microAppSetData = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">MicroData</span>&gt;): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> targetName = name || <span class="hljs-title function_">getServiceName</span>();

  <span class="hljs-keyword">if</span> (!targetName) {
    <span class="hljs-title function_">devWarn</span>(<span class="hljs-string">"æ— æ³•å‘é€æ•°æ®ï¼šæœªæŒ‡å®šå­åº”ç”¨åç§°"</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼Œç¡®ä¿æ•°æ®å˜åŒ–</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">dataWithTimestamp</span>: <span class="hljs-title class_">MicroData</span> = {
    ...data,
    <span class="hljs-attr">t</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    <span class="hljs-attr">source</span>: <span class="hljs-title function_">getServiceName</span>(),
  };

  <span class="hljs-keyword">try</span> {
    microApp.<span class="hljs-title function_">setData</span>(targetName, dataWithTimestamp);
    <span class="hljs-title function_">devLog</span>(<span class="hljs-string">`å‘ <span class="hljs-subst">${targetName}</span> å‘é€æ•°æ®`</span>, dataWithTimestamp);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ä¸»åº”ç”¨é€šä¿¡] å‘é€æ•°æ®å¤±è´¥:`</span>, error);
  }
};
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å®Œæ•´ä»£ç </strong>ï¼šä»£ç ä»“åº“ä¸­åŒ…å«å®Œæ•´çš„é€šä¿¡æ¨¡å—å®ç°ï¼ŒåŒ…å«æ‰€æœ‰äº‹ä»¶ç±»å‹çš„å¤„ç†é€»è¾‘ã€‚</p>
</blockquote>
<h4 data-id="heading-17">3.2.2 äº‹ä»¶æ€»çº¿æ¨¡å— (<code>microAppEventBus.ts</code>)</h4>
<p><strong>è®¾è®¡æ€è·¯</strong>ï¼š</p>
<p>äº‹ä»¶æ€»çº¿æ¨¡å—ç”¨äºè§£è€¦ç”Ÿå‘½å‘¨æœŸé’©å­å’Œä¸šåŠ¡é€»è¾‘ã€‚å½“å­åº”ç”¨ç”Ÿå‘½å‘¨æœŸå‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šè¿‡äº‹ä»¶æ€»çº¿é€šçŸ¥ä¸šåŠ¡ä»£ç ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>âœ… æ”¯æŒä¸€æ¬¡æ€§ç›‘å¬ (<code>once</code>)</li>
<li>âœ… æ”¯æŒé™é»˜æ¨¡å¼ï¼ˆé¿å…æ— ç›‘å¬å™¨è­¦å‘Šï¼‰</li>
<li>âœ… å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰</li>
<li>âœ… æ”¯æŒç§»é™¤ç›‘å¬å™¨</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * äº‹ä»¶æ€»çº¿ç±»
 * ç”¨äºè§£è€¦ç”Ÿå‘½å‘¨æœŸé’©å­å’Œä¸šåŠ¡é€»è¾‘
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">EventListener</span>[]&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">silent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// é»˜è®¤é™é»˜æ¨¡å¼</span>

  <span class="hljs-comment">/**
   * ç›‘å¬äº‹ä»¶
   */</span>
  on&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">callback</span>: <span class="hljs-title class_">EventCallback</span>&lt;T&gt;, once = <span class="hljs-literal">false</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">set</span>(event, []);
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(event)!.<span class="hljs-title function_">push</span>({ callback, once });
  }

  <span class="hljs-comment">/**
   * è§¦å‘äº‹ä»¶
   */</span>
  emit&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: T): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> listeners = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">get</span>(event);

    <span class="hljs-keyword">if</span> (!listeners || listeners.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">silent</span>) {
        <span class="hljs-title function_">devWarn</span>(<span class="hljs-string">`äº‹ä»¶ <span class="hljs-subst">${event}</span> æ²¡æœ‰ç›‘å¬å™¨`</span>);
      }
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// æ‰§è¡Œç›‘å¬å™¨ï¼Œå¹¶ç§»é™¤ä¸€æ¬¡æ€§ç›‘å¬å™¨</span>
    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener, index</span>) =&gt;</span> {
      listener.<span class="hljs-title function_">callback</span>(data);
      <span class="hljs-keyword">if</span> (listener.<span class="hljs-property">once</span>) {
        listeners.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      }
    });
  }
}
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å®Œæ•´å®ç°</strong>ï¼šä»£ç ä»“åº“ä¸­åŒ…å«å®Œæ•´çš„äº‹ä»¶æ€»çº¿å®ç°ï¼ŒåŒ…å«æ‰€æœ‰æ–¹æ³•å’Œç±»å‹å®šä¹‰ã€‚</p>
</blockquote>
<h4 data-id="heading-18">3.2.3 å­åº”ç”¨é€šä¿¡æœåŠ¡ (<code>MicroAppService</code>)</h4>
<p><strong>è®¾è®¡æ€è·¯</strong>ï¼š</p>
<p>å­åº”ç”¨é€šä¿¡æœåŠ¡æ˜¯ä¸€ä¸ªç±»ï¼Œè´Ÿè´£åˆå§‹åŒ–æ•°æ®ç›‘å¬å™¨ã€å¤„ç†ä¸»åº”ç”¨å‘é€çš„æ•°æ®ã€å‘ä¸»åº”ç”¨å‘é€æ•°æ®ä»¥åŠæ¸…ç†èµ„æºã€‚é‡‡ç”¨<strong>ç­–ç•¥æ¨¡å¼</strong>å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œä½¿ä»£ç ç»“æ„æ¸…æ™°ã€‚</p>
<p><strong>æ ¸å¿ƒæ–¹æ³•</strong>ï¼š</p>
<ol>
<li><code>init()</code>: åˆå§‹åŒ–æ•°æ®ç›‘å¬å™¨</li>
<li><code>handleData()</code>: å¤„ç†ä¸»åº”ç”¨æ•°æ®ï¼ˆç­–ç•¥æ¨¡å¼ï¼‰</li>
<li><code>sendData()</code>: å‘ä¸»åº”ç”¨å‘é€æ•°æ®</li>
<li><code>destroy()</code>: æ¸…ç†ç›‘å¬å™¨</li>
</ol>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å­åº”ç”¨é€šä¿¡æœåŠ¡ç±»
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MicroAppService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">serviceName</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataListener</span>: (<span class="hljs-function">(<span class="hljs-params">data: MicroData</span>) =&gt;</span> <span class="hljs-built_in">void</span>) | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">serviceName</span> = <span class="hljs-title function_">getServiceName</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–æ•°æ®ç›‘å¬å™¨
   */</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">init</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isMicroAppEnvironment</span>()) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> microApp = (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">microApp</span>;
    <span class="hljs-keyword">if</span> (!microApp) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// åˆ›å»ºæ•°æ®ç›‘å¬å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataListener</span> = <span class="hljs-function">(<span class="hljs-params">data: MicroData</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleData</span>(data);
    };

    <span class="hljs-comment">// æ·»åŠ æ•°æ®ç›‘å¬å™¨</span>
    microApp.<span class="hljs-title function_">addDataListener</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataListener</span>);
  }

  <span class="hljs-comment">/**
   * å¤„ç†ä¸»åº”ç”¨å‘é€çš„æ•°æ®ï¼ˆç­–ç•¥æ¨¡å¼ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleData</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">MicroData</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">switch</span> (data.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"target"</span>:
        <span class="hljs-comment">// å¤„ç†è·¯ç”±è·³è½¬</span>
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"menuCollapse"</span>:
        <span class="hljs-comment">// å¤„ç†èœå•æŠ˜å </span>
        <span class="hljs-keyword">break</span>;
      <span class="hljs-comment">// ... å…¶ä»–äº‹ä»¶ç±»å‹</span>
    }
  }
}
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å®Œæ•´å®ç°</strong>ï¼šä»£ç ä»“åº“ä¸­åŒ…å«å®Œæ•´çš„ MicroAppService å®ç°ï¼ŒåŒ…å«æ‰€æœ‰äº‹ä»¶ç±»å‹çš„å¤„ç†é€»è¾‘ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-19">å››ã€æ ¸å¿ƒåŠŸèƒ½å®ç°</h2>
<h3 data-id="heading-20">4.1 ä¸»åº”ç”¨é€šä¿¡æ¨¡å—</h3>
<h4 data-id="heading-21">4.1.1 æ•°æ®å‘é€åŠŸèƒ½</h4>
<p>ä¸»åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®æ—¶ï¼Œéœ€è¦è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼Œç¡®ä¿ micro-app èƒ½æ£€æµ‹åˆ°æ•°æ®å˜åŒ–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å‘æŒ‡å®šå­åº”ç”¨å‘é€æ•°æ®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> microAppSetData = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">MicroData</span>&gt;): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">dataWithTimestamp</span>: <span class="hljs-title class_">MicroData</span> = {
    ...data,
    <span class="hljs-attr">t</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),  <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³</span>
    <span class="hljs-attr">source</span>: <span class="hljs-title function_">getServiceName</span>(),  <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ æ¥æº</span>
  };

  <span class="hljs-keyword">try</span> {
    microApp.<span class="hljs-title function_">setData</span>(name, dataWithTimestamp);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ä¸»åº”ç”¨é€šä¿¡] å‘é€æ•°æ®å¤±è´¥:`</span>, error);
  }
};
</code></pre>
<h4 data-id="heading-22">4.1.2 è·¨åº”ç”¨è·¯ç”±è·³è½¬</h4>
<p>æ™ºèƒ½åŒºåˆ†åŒåº”ç”¨å†…è·³è½¬å’Œè·¨åº”ç”¨è·³è½¬ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * è·¨åº”ç”¨è·¯ç”±è·³è½¬
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> microAppTarget = (
  <span class="hljs-attr">service</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>
): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> currentService = <span class="hljs-title function_">getServiceName</span>();

  <span class="hljs-comment">// åŒåº”ç”¨å†…ï¼šé€šè¿‡é€šä¿¡è®©å­åº”ç”¨è‡ªå·±è·³è½¬</span>
  <span class="hljs-keyword">if</span> (currentService === service) {
    <span class="hljs-title function_">microAppSetData</span>(service, { <span class="hljs-attr">type</span>: <span class="hljs-string">"target"</span>, <span class="hljs-attr">path</span>: url });
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// è·¨åº”ç”¨ï¼šé€šè¿‡ä¸»åº”ç”¨è·¯ç”±è·³è½¬</span>
  <span class="hljs-keyword">const</span> routeMapping = routeMappings.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">m</span>) =&gt;</span> m.<span class="hljs-property">appName</span> === service);
  <span class="hljs-keyword">if</span> (routeMapping) {
    <span class="hljs-keyword">const</span> fullPath = <span class="hljs-string">`<span class="hljs-subst">${routeMapping.basePath}</span><span class="hljs-subst">${url}</span>`</span>;
    router.<span class="hljs-title function_">push</span>(fullPath).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ä¸»åº”ç”¨é€šä¿¡] è·¯ç”±è·³è½¬å¤±è´¥:`</span>, error);
    });
  }
};
</code></pre>
<h4 data-id="heading-23">4.1.3 ç»Ÿä¸€çš„æ•°æ®ç›‘å¬å¤„ç†å™¨</h4>
<p>ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€æ˜“äºæ‰©å±•ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç»Ÿä¸€çš„æ•°æ®ç›‘å¬å¤„ç†å™¨ï¼ˆç­–ç•¥æ¨¡å¼ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> microAppDataListener = (<span class="hljs-attr">params</span>: <span class="hljs-title class_">DataListenerParams</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> { service, data } = params;

  <span class="hljs-keyword">if</span> (!data || !data.<span class="hljs-property">type</span>) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">eventHandlers</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">MicroAppEventType</span>, <span class="hljs-function">(<span class="hljs-params">data: MicroData</span>) =&gt;</span> <span class="hljs-built_in">void</span>&gt; = {
    <span class="hljs-attr">target</span>: <span class="hljs-function">(<span class="hljs-params">eventData</span>) =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†è·¯ç”±è·³è½¬</span>
      <span class="hljs-keyword">const</span> targetService = eventData.<span class="hljs-property">service</span> || eventData.<span class="hljs-property">data</span>?.<span class="hljs-property">service</span>;
      <span class="hljs-keyword">const</span> targetUrl = eventData.<span class="hljs-property">url</span> || eventData.<span class="hljs-property">path</span> || <span class="hljs-string">""</span>;
      <span class="hljs-keyword">if</span> (targetService &amp;&amp; targetUrl) {
        <span class="hljs-title function_">microAppTarget</span>(targetService, targetUrl);
      }
    },
    <span class="hljs-attr">navigate</span>: <span class="hljs-function">(<span class="hljs-params">eventData</span>) =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†è·¨åº”ç”¨å¯¼èˆª</span>
      <span class="hljs-comment">// ...</span>
    },
    <span class="hljs-attr">logout</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†é€€å‡ºç™»å½•</span>
      <span class="hljs-comment">// ...</span>
    },
    <span class="hljs-comment">// ... å…¶ä»–äº‹ä»¶ç±»å‹</span>
  };

  <span class="hljs-keyword">const</span> handler = eventHandlers[data.<span class="hljs-property">type</span>];
  <span class="hljs-keyword">if</span> (handler) {
    <span class="hljs-title function_">handler</span>(data);
  }
};
</code></pre>
<h3 data-id="heading-24">4.2 äº‹ä»¶æ€»çº¿æ¨¡å—</h3>
<p>äº‹ä»¶æ€»çº¿ç”¨äºè§£è€¦ç”Ÿå‘½å‘¨æœŸé’©å­å’Œä¸šåŠ¡é€»è¾‘ï¼Œä½¿ä»£ç æ›´æ˜“ç»´æŠ¤ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç›‘å¬ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> onLifecycle = (
  <span class="hljs-attr">event</span>: <span class="hljs-title class_">LifecycleEventType</span>,
  <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">data: LifecycleEventData</span>) =&gt;</span> <span class="hljs-built_in">void</span>,
  once = <span class="hljs-literal">false</span>
): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  eventBus.<span class="hljs-title function_">on</span>(event, callback, once);
};

<span class="hljs-comment">/**
 * è§¦å‘ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> emitLifecycle = (
  <span class="hljs-attr">event</span>: <span class="hljs-title class_">LifecycleEventType</span>,
  <span class="hljs-attr">data</span>: <span class="hljs-title class_">LifecycleEventData</span>
): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  eventBus.<span class="hljs-title function_">emit</span>(event, data);
};
</code></pre>
<h3 data-id="heading-25">4.3 å­åº”ç”¨é€šä¿¡æœåŠ¡</h3>
<p>å­åº”ç”¨é€šè¿‡ <code>MicroAppService</code> ç±»ç®¡ç†é€šä¿¡é€»è¾‘ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å­åº”ç”¨é€šä¿¡æœåŠ¡ç±»
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MicroAppService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">serviceName</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataListener</span>: (<span class="hljs-function">(<span class="hljs-params">data: MicroData</span>) =&gt;</span> <span class="hljs-built_in">void</span>) | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">serviceName</span> = <span class="hljs-title function_">getServiceName</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-comment">/**
   * å¤„ç†ä¸»åº”ç”¨å‘é€çš„æ•°æ®ï¼ˆç­–ç•¥æ¨¡å¼ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleData</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">MicroData</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">switch</span> (data.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"target"</span>: {
        <span class="hljs-comment">// è·¯ç”±è·³è½¬</span>
        <span class="hljs-keyword">const</span> path = data.<span class="hljs-property">path</span> || data.<span class="hljs-property">data</span>?.<span class="hljs-property">path</span> || <span class="hljs-string">""</span>;
        <span class="hljs-keyword">if</span> (path &amp;&amp; path !== router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">value</span>.<span class="hljs-property">path</span>) {
          router.<span class="hljs-title function_">push</span>(path);
        }
        <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-keyword">case</span> <span class="hljs-string">"menuCollapse"</span>: {
        <span class="hljs-comment">// èœå•æŠ˜å </span>
        <span class="hljs-keyword">const</span> collapse = data.<span class="hljs-property">data</span>?.<span class="hljs-property">collapse</span> ?? <span class="hljs-literal">false</span>;
        <span class="hljs-comment">// å¤„ç†èœå•æŠ˜å é€»è¾‘</span>
        <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-comment">// ... å…¶ä»–äº‹ä»¶ç±»å‹</span>
    }
  }

  <span class="hljs-comment">/**
   * å‘ä¸»åº”ç”¨å‘é€æ•°æ®
   */</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">sendData</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">MicroData</span>&gt;): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isMicroAppEnvironment</span>()) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> microApp = (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">microApp</span>;
    <span class="hljs-keyword">if</span> (!microApp || <span class="hljs-keyword">typeof</span> microApp.<span class="hljs-property">dispatch</span> !== <span class="hljs-string">"function"</span>) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> <span class="hljs-attr">dataWithTimestamp</span>: <span class="hljs-title class_">MicroData</span> = {
      ...data,
      <span class="hljs-attr">t</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">source</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">serviceName</span>,
    };

    microApp.<span class="hljs-title function_">dispatch</span>(dataWithTimestamp);
  }

  <span class="hljs-comment">/**
   * æ¸…ç†ç›‘å¬å™¨
   */</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">destroy</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataListener</span>) {
      <span class="hljs-keyword">const</span> microApp = (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">microApp</span>;
      <span class="hljs-keyword">if</span> (microApp &amp;&amp; <span class="hljs-keyword">typeof</span> microApp.<span class="hljs-property">removeDataListener</span> === <span class="hljs-string">"function"</span>) {
        microApp.<span class="hljs-title function_">removeDataListener</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataListener</span>);
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataListener</span> = <span class="hljs-literal">null</span>;
    }
  }
}
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å®Œæ•´ä»£ç </strong>ï¼šä»£ç ä»“åº“ä¸­åŒ…å«æ‰€æœ‰æ ¸å¿ƒæ¨¡å—çš„å®Œæ•´å®ç°ï¼ŒåŒ…å«è¯¦ç»†çš„æ³¨é‡Šå’Œç±»å‹å®šä¹‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-26">äº”ã€å…³é”®å®ç°ç»†èŠ‚</h2>
<h3 data-id="heading-27">5.1 ç±»å‹å®‰å…¨ä¼˜å…ˆ</h3>
<h4 data-id="heading-28">å†³ç­–èƒŒæ™¯</h4>
<p>åœ¨å¾®å‰ç«¯é¡¹ç›®ä¸­ï¼Œç±»å‹å®‰å…¨å°¤ä¸ºé‡è¦ã€‚ä¸»å­åº”ç”¨ä¹‹é—´çš„é€šä¿¡å¦‚æœæ²¡æœ‰ç±»å‹çº¦æŸï¼Œå¾ˆå®¹æ˜“å‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<h4 data-id="heading-29">å®ç°æ–¹æ¡ˆ</h4>
<p><strong>1. å…¨å±€ç±»å‹å£°æ˜</strong></p>
<p>ä¸º <code>window.microApp</code> æ·»åŠ å…¨å±€ç±»å‹å£°æ˜ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// types/micro-app.d.ts</span>
<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">global</span> {
  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Window</span> {
    microApp?: {
      <span class="hljs-attr">setData</span>: <span class="hljs-function">(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, data: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
      <span class="hljs-attr">getData</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">any</span>;
      <span class="hljs-attr">addDataListener</span>: <span class="hljs-function">(<span class="hljs-params">listener: (data: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">void</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
      <span class="hljs-attr">removeDataListener</span>: <span class="hljs-function">(<span class="hljs-params">listener: (data: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">void</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
      <span class="hljs-attr">dispatch</span>: <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
    };
    __MICRO_APP_ENVIRONMENT__?: <span class="hljs-built_in">boolean</span>;
    __MICRO_APP_BASE_ROUTE__?: <span class="hljs-built_in">string</span>;
    __MICRO_APP_NAME__?: <span class="hljs-built_in">string</span>;
  }
}
</code></pre>
<p><strong>2. å®Œæ•´çš„ç±»å‹å®šä¹‰</strong></p>
<p>å®šä¹‰æ‰€æœ‰é€šä¿¡æ•°æ®çš„ç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å¾®å‰ç«¯é€šä¿¡æ•°æ®ç±»å‹
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MicroData</span> {
  <span class="hljs-comment">/** äº‹ä»¶ç±»å‹ï¼ˆå¿…å¡«ï¼‰ */</span>
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">MicroAppEventType</span>;
  <span class="hljs-comment">/** äº‹ä»¶æ•°æ® */</span>
  data?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;;
  <span class="hljs-comment">/** æ—¶é—´æˆ³ï¼ˆç¡®ä¿æ•°æ®å˜åŒ–ï¼‰ */</span>
  t?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">/** æ¥æºåº”ç”¨ */</span>
  source?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** è·¯å¾„ï¼ˆç”¨äºè·¯ç”±è·³è½¬ï¼‰ */</span>
  path?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** ç›®æ ‡æœåŠ¡ï¼ˆç”¨äºè·¨åº”ç”¨è·³è½¬ï¼‰ */</span>
  service?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** ç›®æ ‡URLï¼ˆç”¨äºè·¨åº”ç”¨è·³è½¬ï¼‰ */</span>
  url?: <span class="hljs-built_in">string</span>;
}
</code></pre>
<p><strong>3. ç±»å‹å®ˆå«</strong></p>
<p>ä½¿ç”¨ç±»å‹å®ˆå«ç¡®ä¿ç±»å‹å®‰å…¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isMicroAppEnvironment</span>(<span class="hljs-params"/>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">return</span> !!<span class="hljs-variable language_">window</span>.<span class="hljs-property">__MICRO_APP_ENVIRONMENT__</span>;
}
</code></pre>
<h4 data-id="heading-30">æ”¶ç›Š</h4>
<ul>
<li>âœ… æ›´å¥½çš„ IDE æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨</li>
<li>âœ… ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯</li>
<li>âœ… ä»£ç å¯ç»´æŠ¤æ€§æ˜¾è‘—æå‡</li>
<li>âœ… é‡æ„æ›´å®‰å…¨ï¼Œç±»å‹ç³»ç»Ÿä¼šæç¤ºæ‰€æœ‰éœ€è¦ä¿®æ”¹çš„åœ°æ–¹</li>
</ul>
<h3 data-id="heading-31">5.2 äº‹ä»¶æ€»çº¿è§£è€¦</h3>
<h4 data-id="heading-32">å†³ç­–èƒŒæ™¯</h4>
<p>åœ¨å¾®å‰ç«¯é¡¹ç›®ä¸­ï¼Œå­åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­éœ€è¦è§¦å‘å„ç§ä¸šåŠ¡é€»è¾‘ã€‚å¦‚æœç›´æ¥åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œä¼šå¯¼è‡´ä»£ç è€¦åˆåº¦é«˜ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚</p>
<h4 data-id="heading-33">å®ç°æ–¹æ¡ˆ</h4>
<p><strong>1. äº‹ä»¶æ€»çº¿è®¾è®¡</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">EventListener</span>[]&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">silent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;

  on&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">callback</span>: <span class="hljs-title class_">EventCallback</span>&lt;T&gt;, once = <span class="hljs-literal">false</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// æ·»åŠ ç›‘å¬å™¨</span>
  }

  emit&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: T): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
  }

  <span class="hljs-title function_">off</span>(<span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>, callback?: <span class="hljs-title class_">EventCallback</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// ç§»é™¤ç›‘å¬å™¨</span>
  }
}
</code></pre>
<p><strong>2. ç”Ÿå‘½å‘¨æœŸé’©å­è§¦å‘äº‹ä»¶</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­è§¦å‘äº‹ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onMounted</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">emitLifecycle</span>(<span class="hljs-string">"mounted"</span>, { <span class="hljs-attr">name</span>: props.<span class="hljs-property">name</span> });
};
</code></pre>
<p><strong>3. ä¸šåŠ¡ä»£ç ç›‘å¬äº‹ä»¶</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¸šåŠ¡ä»£ç ä¸­ç›‘å¬äº‹ä»¶</span>
<span class="hljs-title function_">onLifecycle</span>(<span class="hljs-string">"mounted"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å­åº”ç”¨ <span class="hljs-subst">${data.name}</span> å·²æŒ‚è½½`</span>);
});
</code></pre>
<h4 data-id="heading-34">æ”¶ç›Š</h4>
<ul>
<li>âœ… ä»£ç è§£è€¦ï¼Œç”Ÿå‘½å‘¨æœŸé’©å­å’Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»</li>
<li>âœ… ä¸šåŠ¡é€»è¾‘å¯ä»¥ç‹¬ç«‹æµ‹è¯•</li>
<li>âœ… æ”¯æŒå¤šä¸ªç›‘å¬å™¨ï¼Œæ‰©å±•æ€§å¼º</li>
<li>âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤</li>
</ul>
<h3 data-id="heading-35">5.3 æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–</h3>
<h4 data-id="heading-36">å†³ç­–èƒŒæ™¯</h4>
<p>åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œè¯¦ç»†çš„æ—¥å¿—æœ‰åŠ©äºè°ƒè¯•ã€‚ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿‡å¤šçš„æ—¥å¿—ä¼šå½±å“æ€§èƒ½ï¼Œè¿˜å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚</p>
<h4 data-id="heading-37">å®ç°æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> isDev = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">DEV</span>;

<span class="hljs-comment">/**
 * å¼€å‘ç¯å¢ƒæ—¥å¿—è¾“å‡º
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">devLog</span> = (<span class="hljs-params">message: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">any</span>[]</span>) =&gt; {
  <span class="hljs-keyword">if</span> (isDev) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`%c[æ ‡ç­¾] <span class="hljs-subst">${message}</span>`</span>, <span class="hljs-string">"color: #1890ff"</span>, ...args);
  }
};

<span class="hljs-comment">/**
 * å¼€å‘ç¯å¢ƒè­¦å‘Šè¾“å‡º
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">devWarn</span> = (<span class="hljs-params">message: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">any</span>[]</span>) =&gt; {
  <span class="hljs-keyword">if</span> (isDev) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`%c[æ ‡ç­¾] <span class="hljs-subst">${message}</span>`</span>, <span class="hljs-string">"color: #faad14"</span>, ...args);
  }
};

<span class="hljs-comment">/**
 * é”™è¯¯æ—¥å¿—ï¼ˆå§‹ç»ˆè¾“å‡ºï¼‰
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">errorLog</span> = (<span class="hljs-params">message: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">any</span>[]</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[æ ‡ç­¾] <span class="hljs-subst">${message}</span>`</span>, ...args);
};
</code></pre>
<h4 data-id="heading-38">æ”¶ç›Š</h4>
<ul>
<li>âœ… ç”Ÿäº§ç¯å¢ƒæ€§èƒ½æ›´å¥½ï¼Œæ— æ—¥å¿—å¼€é”€</li>
<li>âœ… å¼€å‘ç¯å¢ƒè°ƒè¯•æ›´æ–¹ä¾¿ï¼Œå½©è‰²æ—¥å¿—æ˜“äºè¯†åˆ«</li>
<li>âœ… é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²</li>
<li>âœ… é”™è¯¯æ—¥å¿—å§‹ç»ˆè¾“å‡ºï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</li>
</ul>
<h3 data-id="heading-39">5.4 Vite å­åº”ç”¨ iframe æ²™ç®±</h3>
<h4 data-id="heading-40">å†³ç­–èƒŒæ™¯</h4>
<p>æ ¹æ® micro-app å®˜æ–¹æ–‡æ¡£ï¼Œ<strong>Vite ä½œä¸ºå­åº”ç”¨æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ iframe æ²™ç®±æ¨¡å¼</strong>ï¼Œå¦åˆ™ä¼šå‡ºç°è„šæœ¬æ‰§è¡Œé”™è¯¯ã€‚</p>
<h4 data-id="heading-41">å®ç°æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;micro-app
  :name="name"
  :url="url"
  router-mode="native"
  iframe  &lt;!-- å¿…é¡»æ·»åŠ æ­¤å±æ€§ --&gt;
/&gt;
</code></pre>
<h4 data-id="heading-42">æ”¶ç›Š</h4>
<ul>
<li>âœ… è§£å†³ Vite å¼€å‘è„šæœ¬æ‰§è¡Œé”™è¯¯</li>
<li>âœ… æ›´å¥½çš„éš”ç¦»æ€§ï¼Œæ ·å¼å’Œè„šæœ¬å®Œå…¨éš”ç¦»</li>
<li>âœ… ç¬¦åˆå®˜æ–¹æœ€ä½³å®è·µ</li>
</ul>
<hr/>
<h2 data-id="heading-43">å…­ã€æœ€ä½³å®è·µä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-44">6.1 ç»Ÿä¸€é…ç½®ç®¡ç†</h3>
<p>ä½¿ç”¨é…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å­åº”ç”¨åœ°å€ï¼Œæ”¯æŒç¯å¢ƒæ„ŸçŸ¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// config/microApps.ts</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">envConfigs</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">EnvConfig</span>&gt; = {
  <span class="hljs-string">"sub-app-1"</span>: {
    <span class="hljs-attr">dev</span>: <span class="hljs-string">"http://localhost:3000"</span>,
    <span class="hljs-attr">prod</span>: <span class="hljs-string">"//your-domain.com/sub-app-1"</span>,
    <span class="hljs-attr">envKey</span>: <span class="hljs-string">"VITE_SUB_APP_1_ENTRY"</span>,
  },
  <span class="hljs-comment">// ...</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getEntry</span>(<span class="hljs-params">appName: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> config = envConfigs[appName];

  <span class="hljs-comment">// ä¼˜å…ˆçº§ 1: ç¯å¢ƒå˜é‡è¦†ç›–</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>[config.<span class="hljs-property">envKey</span>]) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>[config.<span class="hljs-property">envKey</span>];
  }

  <span class="hljs-comment">// ä¼˜å…ˆçº§ 2: æ ¹æ®ç¯å¢ƒé€‰æ‹©é…ç½®</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">DEV</span>) {
    <span class="hljs-keyword">return</span> config.<span class="hljs-property">dev</span>;
  }

  <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒæ ¹æ®éƒ¨ç½²æ¨¡å¼é€‰æ‹©</span>
  <span class="hljs-keyword">const</span> deployMode = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_DEPLOY_MODE</span> || <span class="hljs-string">"same-origin"</span>;
  <span class="hljs-keyword">return</span> deployMode === <span class="hljs-string">"same-origin"</span>
    ? <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">window</span>.location.origin}</span>/<span class="hljs-subst">${appName}</span>`</span>
    : config.<span class="hljs-property">prod</span>;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… é…ç½®é›†ä¸­ç®¡ç†ï¼Œæ˜“äºç»´æŠ¤</li>
<li>âœ… è‡ªåŠ¨é€‚é…å¼€å‘/ç”Ÿäº§ç¯å¢ƒ</li>
<li>âœ… æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–</li>
<li>âœ… æ”¯æŒåŒåŸŸ/è·¨åŸŸéƒ¨ç½²</li>
</ul>
<h3 data-id="heading-45">6.2 è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³</h3>
<p>å‘é€æ•°æ®æ—¶è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼Œç¡®ä¿ micro-app èƒ½æ£€æµ‹åˆ°æ•°æ®å˜åŒ–ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">dataWithTimestamp</span>: <span class="hljs-title class_">MicroData</span> = {
  ...data,
  <span class="hljs-attr">t</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),  <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³</span>
  <span class="hljs-attr">source</span>: <span class="hljs-title function_">getServiceName</span>(),  <span class="hljs-comment">// è‡ªåŠ¨æ·»åŠ æ¥æº</span>
};
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… ç¡®ä¿ micro-app èƒ½æ£€æµ‹åˆ°æ•°æ®å˜åŒ–</li>
<li>âœ… é¿å…æ•°æ®æœªæ›´æ–°çš„é—®é¢˜</li>
<li>âœ… ä¾¿äºè°ƒè¯•ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®æ¥æº</li>
</ul>
<h3 data-id="heading-46">6.3 æ™ºèƒ½è·¯ç”±è·³è½¬</h3>
<p>åŒºåˆ†åŒåº”ç”¨å†…è·³è½¬å’Œè·¨åº”ç”¨è·³è½¬ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åŒåº”ç”¨å†…ï¼šé€šè¿‡é€šä¿¡è®©å­åº”ç”¨è‡ªå·±è·³è½¬</span>
<span class="hljs-comment">// è·¨åº”ç”¨ï¼šé€šè¿‡ä¸»åº”ç”¨è·¯ç”±è·³è½¬</span>
<span class="hljs-keyword">if</span> (currentService === service) {
  <span class="hljs-title function_">microAppSetData</span>(service, { <span class="hljs-attr">type</span>: <span class="hljs-string">"target"</span>, <span class="hljs-attr">path</span>: url });
} <span class="hljs-keyword">else</span> {
  router.<span class="hljs-title function_">push</span>(fullPath);
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… é¿å…è·¯ç”±è®°å½•æ··ä¹±</li>
<li>âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</li>
<li>âœ… æ”¯æŒæµè§ˆå™¨å‰è¿›åé€€</li>
</ul>
<h3 data-id="heading-47">6.4 å®Œå–„çš„é”™è¯¯å¤„ç†</h3>
<p>æ‰€æœ‰å…³é”®æ“ä½œéƒ½ä½¿ç”¨ try-catchï¼Œæä¾›é™çº§æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">try</span> {
  microApp.<span class="hljs-title function_">setData</span>(targetName, dataWithTimestamp);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ä¸»åº”ç”¨é€šä¿¡] å‘é€æ•°æ®å¤±è´¥:`</span>, error);
  <span class="hljs-comment">// é™çº§å¤„ç†</span>
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… æé«˜ç³»ç»Ÿç¨³å®šæ€§</li>
<li>âœ… æ›´å¥½çš„é”™è¯¯æç¤º</li>
<li>âœ… ä¾¿äºé—®é¢˜æ’æŸ¥</li>
</ul>
<h3 data-id="heading-48">6.5 å­åº”ç”¨ç‹¬ç«‹è¿è¡Œ</h3>
<p>å­åº”ç”¨æ”¯æŒç‹¬ç«‹è¿è¡Œï¼Œä¾¿äºå¼€å‘è°ƒè¯•ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main.ts</span>
<span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isMicroAppEnvironment</span>()) {
  <span class="hljs-comment">// ç‹¬ç«‹è¿è¡Œæ—¶ç›´æ¥æŒ‚è½½</span>
  <span class="hljs-title function_">render</span>();
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// å¾®å‰ç«¯ç¯å¢ƒå¯¼å‡ºç”Ÿå‘½å‘¨æœŸå‡½æ•°</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">mount</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">render</span>();
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">unmount</span> = <span class="hljs-function">() =&gt;</span> app.<span class="hljs-title function_">unmount</span>();
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… æå‡å¼€å‘æ•ˆç‡</li>
<li>âœ… ä¾¿äºç‹¬ç«‹è°ƒè¯•</li>
<li>âœ… æ”¯æŒç‹¬ç«‹éƒ¨ç½²</li>
</ul>
<hr/>
<h2 data-id="heading-49">ä¸ƒã€è¸©å‘ç»éªŒæ€»ç»“</h2>
<p>åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°äº†è®¸å¤šé—®é¢˜ï¼Œä»¥ä¸‹æ˜¯ä¸»è¦é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-50">7.1 Vue æ— æ³•è¯†åˆ« micro-app è‡ªå®šä¹‰å…ƒç´ </h3>
<p><strong>é—®é¢˜</strong>ï¼šVue 3 é»˜è®¤ä¼šå°†æ‰€æœ‰æ ‡ç­¾å½“ä½œ Vue ç»„ä»¶å¤„ç†ï¼Œä½† <code>micro-app</code> æ˜¯ WebComponent è‡ªå®šä¹‰å…ƒç´ ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ <code>vite.config.ts</code> ä¸­é…ç½® <code>isCustomElement</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">vue</span>({
  <span class="hljs-attr">template</span>: {
    <span class="hljs-attr">compilerOptions</span>: {
      <span class="hljs-attr">isCustomElement</span>: <span class="hljs-function">(<span class="hljs-params">tag</span>) =&gt;</span> tag === <span class="hljs-string">"micro-app"</span>,
    },
  },
})
</code></pre>
<h3 data-id="heading-51">7.2 Vite å­åº”ç”¨å¿…é¡»ä½¿ç”¨ iframe æ²™ç®±</h3>
<p><strong>é—®é¢˜</strong>ï¼šVite ä½œä¸ºå­åº”ç”¨æ—¶ï¼Œå¦‚æœä¸ä½¿ç”¨ iframe æ²™ç®±ï¼Œä¼šå‡ºç°è„šæœ¬æ‰§è¡Œé”™è¯¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ <code>MicroAppContainer</code> ç»„ä»¶ä¸­æ·»åŠ  <code>iframe</code> å±æ€§ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;micro-app
  :name="name"
  :url="url"
  router-mode="native"
  iframe  &lt;!-- å¿…é¡»æ·»åŠ  --&gt;
/&gt;
</code></pre>
<h3 data-id="heading-52">7.3 é€šä¿¡æ•°æ®æœªæ¥æ”¶</h3>
<p><strong>é—®é¢˜</strong>ï¼šå‘é€æ•°æ®åï¼Œå­åº”ç”¨æœªæ¥æ”¶åˆ°æ•°æ®ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ç¡®ä¿æ·»åŠ äº†æ—¶é—´æˆ³ï¼Œç¡®ä¿æ•°æ®å˜åŒ–è¢«æ£€æµ‹</li>
<li>ä½¿ç”¨ <code>forceDispatch</code> å¼ºåˆ¶å‘é€æ•°æ®</li>
<li>æ£€æŸ¥ç›‘å¬å™¨æ˜¯å¦æ­£ç¡®æ³¨å†Œ</li>
</ol>
<h3 data-id="heading-53">7.4 è·¯ç”±ä¸åŒæ­¥</h3>
<p><strong>é—®é¢˜</strong>ï¼šå­åº”ç”¨è·¯ç”±å˜åŒ–æ—¶ï¼Œæµè§ˆå™¨åœ°å€æ æœªæ›´æ–°ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ç¡®ä¿ä¸»åº”ç”¨ä½¿ç”¨ <code>router-mode="native"</code></li>
<li>ç¡®ä¿å­åº”ç”¨ä½¿ç”¨ <code>createWebHistory</code></li>
<li>æ£€æŸ¥åŸºç¡€è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®</li>
</ol>
<blockquote>
<p><strong>ğŸ’¡ æ›´å¤šè¸©å‘è®°å½•</strong>ï¼šä»£ç ä»“åº“ä¸­åŒ…å«å®Œæ•´çš„è¸©å‘è®°å½•æ–‡æ¡£ï¼ˆ<code>docs/TROUBLESHOOTING.md</code>ï¼‰ï¼ŒåŒ…å«æ‰€æœ‰é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-54">å…«ã€é¡¹ç›®æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-55">8.1 å·²å®ŒæˆåŠŸèƒ½</h3>
<p>âœ… <strong>å®Œæ•´çš„é€šä¿¡æœºåˆ¶</strong>ï¼šä¸»å­åº”ç”¨åŒå‘é€šä¿¡ï¼Œæ”¯æŒå¤šç§äº‹ä»¶ç±»å‹
âœ… <strong>è·¯ç”±åŒæ­¥</strong>ï¼šè‡ªåŠ¨å¤„ç†è·¯ç”±åŒæ­¥ï¼Œæ”¯æŒæµè§ˆå™¨å‰è¿›åé€€
âœ… <strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼šå­åº”ç”¨æ”¯æŒç‹¬ç«‹å¼€å‘å’Œè°ƒè¯•
âœ… <strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œé›¶ <code>@ts-ignore</code>ï¼Œé›¶ <code>any</code>
âœ… <strong>äº‹ä»¶æ€»çº¿</strong>ï¼šè§£è€¦ç”Ÿå‘½å‘¨æœŸå’Œä¸šåŠ¡é€»è¾‘
âœ… <strong>ä¸€é”®å¯åŠ¨</strong>ï¼šå¹¶è¡Œå¯åŠ¨æ‰€æœ‰åº”ç”¨ï¼Œæå‡å¼€å‘æ•ˆç‡
âœ… <strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆ
âœ… <strong>æ—¥å¿—ä¼˜åŒ–</strong>ï¼šå¼€å‘/ç”Ÿäº§ç¯å¢ƒåŒºåˆ†ï¼Œæ€§èƒ½ä¼˜åŒ–
âœ… <strong>ç¯å¢ƒé€‚é…</strong>ï¼šæ”¯æŒå¼€å‘/ç”Ÿäº§ç¯å¢ƒï¼ŒåŒåŸŸ/è·¨åŸŸéƒ¨ç½²</p>
<h3 data-id="heading-56">8.2 æŠ€æœ¯äº®ç‚¹</h3>
<ol>
<li><strong>ç±»å‹å®‰å…¨ä¼˜å…ˆ</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>ä¼ä¸šçº§å®è·µ</strong>ï¼šå‚è€ƒçœŸå®ä¼ä¸šé¡¹ç›®ï¼Œä½†æ”¹è¿›å…¶ä¸è¶³</li>
<li><strong>å¼€ç®±å³ç”¨</strong>ï¼šå®Œæ•´çš„é…ç½®å’Œæ–‡æ¡£ï¼Œå¿«é€Ÿä¸Šæ‰‹</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šéµå¾ª micro-app å®˜æ–¹æ¨èå®è·µ</li>
<li><strong>ä»£ç è´¨é‡</strong>ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œå®Œå–„çš„æ³¨é‡Š</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•</li>
</ol>
<h3 data-id="heading-57">8.3 é¡¹ç›®ä»·å€¼</h3>
<ul>
<li>ğŸ¯ <strong>å­¦ä¹ ä»·å€¼</strong>ï¼šå®Œæ•´çš„å¾®å‰ç«¯å®ç°ç¤ºä¾‹ï¼Œé€‚åˆæ·±å…¥å­¦ä¹ </li>
<li>ğŸš€ <strong>å®ç”¨ä»·å€¼</strong>ï¼šå¯ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒï¼ŒèŠ‚çœå¼€å‘æ—¶é—´</li>
<li>ğŸ“š <strong>å‚è€ƒä»·å€¼</strong>ï¼šæœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒï¼Œé¿å…é‡å¤è¸©å‘</li>
</ul>
<hr/>
<h2 data-id="heading-58">ğŸ“š å‚è€ƒèµ„æº</h2>
<h3 data-id="heading-59">å®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fjd-opensource.github.io%2Fmicro-app%2Fdocs.html%23%2F" target="_blank" title="https://jd-opensource.github.io/micro-app/docs.html#/" ref="nofollow noopener noreferrer">micro-app å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2F" target="_blank" title="https://cn.vuejs.org/" ref="nofollow noopener noreferrer">Vue 3 æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vitejs.dev%2F" target="_blank" title="https://cn.vitejs.dev/" ref="nofollow noopener noreferrer">Vite æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Frouter.vuejs.org%2Fzh%2F" target="_blank" title="https://router.vuejs.org/zh/" ref="nofollow noopener noreferrer">Vue Router æ–‡æ¡£</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Arthas å¸¸ç”¨å‘½ä»¤]]></title>    <link>https://juejin.cn/post/7603567912593326107</link>    <guid>https://juejin.cn/post/7603567912593326107</guid>    <pubDate>2026-02-07T06:52:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603567912593326107" data-draft-id="7603591775392595995" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Arthas å¸¸ç”¨å‘½ä»¤"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T06:52:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éª‘ç€bugçš„coder"/> <meta itemprop="url" content="https://juejin.cn/user/1922418579089566"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Arthas å¸¸ç”¨å‘½ä»¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1922418579089566/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éª‘ç€bugçš„coder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T06:52:24.000Z" title="Sat Feb 07 2026 06:52:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. å¯åŠ¨ä¸åŸºç¡€</h3>
<ul>
<li><strong>å¯åŠ¨ï¼š</strong> <code>java -jar arthas-boot.jar</code></li>
<li><strong>é€€å‡ºå®¢æˆ·ç«¯ï¼ˆä¸å…³æœåŠ¡ï¼‰ï¼š</strong> <code>quit</code> æˆ– <code>exit</code></li>
<li><strong>å½»åº•å…³é—­ Arthas æœåŠ¡ï¼š</strong> <code>stop</code> (ä¸€å®šè¦è®°å¾—å…³ï¼Œå¦åˆ™ä¸‹æ¬¡è¿å¯èƒ½æŠ¥é”™)</li>
</ul>
<h3 data-id="heading-1">2. å…¨å±€ç›‘æ§Â </h3>
<ul>
<li>
<p><strong><code>dashboard</code></strong></p>
<ul>
<li><strong>ä½œç”¨ï¼š</strong> çœ‹æ¿ã€‚ä¸€çœ¼çœ‹åˆ° çº¿ç¨‹ã€å†…å­˜ã€GCã€Runtime ä¿¡æ¯ã€‚</li>
<li><strong>åœºæ™¯ï¼š</strong> åˆšè¿ä¸ŠæœåŠ¡ï¼Œç¡®è®¤ç³»ç»Ÿæ•´ä½“æ°´ä½ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>thread</code></strong></p>
<ul>
<li><code>thread -n 3</code>ï¼šæŸ¥çœ‹æœ€å¿™çš„å‰ 3 ä¸ªçº¿ç¨‹ï¼ˆ<strong>æ’æŸ¥ CPU é£™é«˜ç¥å™¨</strong>ï¼‰ã€‚</li>
<li><code>thread -b</code>ï¼šæ‰¾å‡ºå½“å‰é˜»å¡å…¶ä»–çº¿ç¨‹çš„çº¿ç¨‹ï¼ˆ<strong>æ’æŸ¥æ­»é”</strong>ï¼‰ã€‚</li>
<li><code>thread &lt;id&gt;</code>ï¼šæŸ¥çœ‹æŒ‡å®šçº¿ç¨‹çš„å †æ ˆã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">3. ä»£ç ä¸ç±»æ£€æŸ¥ (æˆ‘å‘çš„åŒ…ç”Ÿæ•ˆäº†å—ï¼Ÿ)</h3>
<ul>
<li>
<p><strong><code>jad</code></strong> (åç¼–è¯‘)</p>
<ul>
<li><code>jad com.example.DemoController</code>ï¼šåç¼–è¯‘æ•´ä¸ªç±»ã€‚</li>
<li><code>jad com.example.DemoController testMethod</code>ï¼šåªåç¼–è¯‘æŸä¸ªæ–¹æ³•ï¼ˆæ¨èï¼Œçœå±ï¼‰ã€‚</li>
<li><strong>åœºæ™¯ï¼š</strong> æ€€ç–‘ä»£ç æ²¡å‘ä¸Šå»ï¼Œæˆ–è€…åˆ†æ”¯åˆé”™äº†ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>sc</code></strong> (Search Class)</p>
<ul>
<li><code>sc -d com.example.DemoController</code>ï¼šæ‰“å°ç±»çš„è¯¦ç»†ä¿¡æ¯ï¼ˆç±»åŠ è½½å™¨ã€Jar åŒ…æ¥æºï¼‰ã€‚</li>
<li><strong>åœºæ™¯ï¼š</strong> é‡åˆ° <code>ClassNotFoundException</code> æˆ– <code>NoClassDefFoundError</code> æ—¶æ£€æŸ¥ç±»åŠ è½½å™¨ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>sm</code></strong> (Search Method)</p>
<ul>
<li><code>sm -d com.example.DemoController testMethod</code>ï¼šæŸ¥çœ‹æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå…¥å‚ç±»å‹ã€ä¿®é¥°ç¬¦ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">4. æ–¹æ³•çº§ç›‘æ§ (æ ¸å¿ƒä¸­çš„æ ¸å¿ƒ)</h3>
<p><strong>æ³¨æ„ï¼š</strong> ä»¥ä¸‹å‘½ä»¤éƒ½æ”¯æŒ <code>-n</code> (æ‰§è¡Œæ¬¡æ•°) å’Œ <code>-x</code> (å¯¹è±¡éå†æ·±åº¦)ã€‚</p>
<ul>
<li>
<p><strong><code>watch</code></strong> (è§‚æµ‹å…¥å‚ã€è¿”å›å€¼ã€å¼‚å¸¸) â€”â€” <strong>æœ€å¼ºå‘½ä»¤</strong></p>
<ul>
<li>
<p><strong>çœ‹å…¥å‚å’Œè¿”å›å€¼ï¼š</strong></p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">watch com.example.DemoController testMethod <span class="hljs-string">"{params, returnObj}"</span> -x <span class="hljs-number">2</span>
</code></pre>
</li>
<li>
<p><strong>çœ‹å¼‚å¸¸ï¼ˆåªåœ¨æŠ›å¼‚å¸¸æ—¶æ‰“å°ï¼‰ï¼š</strong></p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">watch com.example.DemoController testMethod <span class="hljs-string">"{params, throwExp}"</span> -e -x <span class="hljs-number">2</span>
</code></pre>
</li>
<li>
<p><strong>æ¡ä»¶è¿‡æ»¤ï¼ˆåªçœ‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ "user1" çš„è¯·æ±‚ï¼‰ï¼š</strong></p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">watch com.example.DemoController testMethod <span class="hljs-string">"{params, returnObj}"</span> <span class="hljs-string">"params[0]=='user1'"</span> -x <span class="hljs-number">2</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong><code>trace</code></strong> (æ–¹æ³•å†…éƒ¨è°ƒç”¨è€—æ—¶) â€”â€” <strong>æ’æŸ¥æ…¢æ¥å£ç¥å™¨</strong></p>
<ul>
<li>
<p><strong>åŸºæœ¬ç”¨æ³•ï¼š</strong></p>
<p>Bash</p>
<pre><code class="hljs">trace com.example.DemoController testMethod
</code></pre>
</li>
<li>
<p><strong>å¸¦æ¡ä»¶ï¼ˆåªè¿½è¸ªè€—æ—¶ &gt; 100ms çš„è¯·æ±‚ï¼‰ï¼š</strong></p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">trace com.example.DemoController testMethod <span class="hljs-string">'#cost &gt; 100'</span>
</code></pre>
</li>
<li>
<p><strong>æ•ˆæœï¼š</strong> ä¼šæ‰“å°å‡ºæ–¹æ³•å†…éƒ¨æ¯ä¸€è¡Œä»£ç ï¼ˆæˆ–å…¶ä»–æ–¹æ³•è°ƒç”¨ï¼‰çš„è€—æ—¶ï¼Œçº¢è‰²çš„å°±æ˜¯ç“¶é¢ˆã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong><code>tt</code></strong> (Time Tunnel æ—¶å…‰éš§é“) â€”â€” <strong>é‡æ”¾è¯·æ±‚</strong></p>
<ul>
<li><strong>è®°å½•ä¸‹æ¥ä¸‹æ¥çš„è¯·æ±‚ï¼š</strong> <code>tt -t com.example.DemoController testMethod</code></li>
<li><strong>åˆ—å‡ºè®°å½•ï¼š</strong> <code>tt -l</code></li>
<li><strong>é‡æ”¾æŸä¸ªè¯·æ±‚ï¼ˆindex=1000ï¼‰ï¼š</strong> <code>tt -i 1000 -p</code></li>
<li><strong>åœºæ™¯ï¼š</strong> æµ‹è¯•ç¯å¢ƒå¤ç°éš¾ï¼ŒæŠ“åˆ°ä¸€ä¸ªç°åœºåï¼Œåå¤é‡æ”¾æ¥è°ƒè¯•ï¼Œä¸ç”¨æ±‚å‰ç«¯å†ç‚¹ä¸€æ¬¡ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">5. çƒ­æ›´æ–° (Hot Swap)</h3>
<p><strong>æ…ç”¨ï¼Œä»…é™ç´§æ€¥æ•‘ç«ã€‚</strong></p>
<ol>
<li>
<p><strong>åç¼–è¯‘ä»£ç åˆ°æœ¬åœ°ï¼š</strong></p>
<p><code>jad --source-only com.example.User &gt; /tmp/User.java</code></p>
</li>
<li>
<p><strong>æœ¬åœ°ä¿®æ”¹ <code>/tmp/User.java</code> (æ¯”å¦‚åŠ ä¸€è¡Œæ—¥å¿—)ã€‚</strong></p>
</li>
<li>
<p><strong>å†…å­˜ç¼–è¯‘ï¼š</strong></p>
<p><code>mc /tmp/User.java -d /tmp</code></p>
</li>
<li>
<p><strong>é‡æ–°åŠ è½½ç±»ï¼š</strong></p>
<p><code>retransform /tmp/com/example/User.class</code></p>
</li>
</ol>
<h3 data-id="heading-5">6. æ€§èƒ½åˆ†æ (ç«ç„°å›¾)</h3>
<ul>
<li><strong><code>profiler start</code></strong>ï¼šå¼€å§‹é‡‡æ · CPUï¼ˆç”Ÿæˆç«ç„°å›¾ï¼‰ã€‚</li>
<li><strong><code>profiler stop</code></strong>ï¼šåœæ­¢é‡‡æ ·å¹¶è¾“å‡º SVG è·¯å¾„ã€‚</li>
<li><strong>åœºæ™¯ï¼š</strong> ä¹Ÿå°±æ˜¯ä½ ä»¥å‰ç”¨ JProfiler åšçš„é‚£äº›äº‹ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ç”Ÿæˆ SVG å¯ä»¥åœ¨æµè§ˆå™¨çœ‹å“ªé‡Œåƒ CPUã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">é™„ï¼šå¿…é¡»è¦æ‡‚çš„å‚æ•° (OGNL è¡¨è¾¾å¼)</h3>
<p>åœ¨ <code>watch</code>ã€<code>trace</code> ç­‰å‘½ä»¤ä¸­ï¼ŒèŠ±æ‹¬å· <code>{}</code> é‡Œå’Œæ¡ä»¶è¡¨è¾¾å¼é‡Œç»å¸¸ç”¨åˆ°è¿™äº›å˜é‡ï¼š</p>



































<table><thead><tr><th><strong>å˜é‡å</strong></th><th><strong>å«ä¹‰</strong></th><th><strong>å¸¸ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td><strong><code>params</code></strong></td><td>æ–¹æ³•å…¥å‚</td><td><code>params[0]</code> (ç¬¬ä¸€ä¸ªå‚æ•°), <code>params.length</code></td></tr><tr><td><strong><code>returnObj</code></strong></td><td>è¿”å›å€¼</td><td>æŸ¥çœ‹æ¥å£è¿”å›äº†ä»€ä¹ˆ</td></tr><tr><td><strong><code>throwExp</code></strong></td><td>å¼‚å¸¸å¯¹è±¡</td><td>æŸ¥çœ‹æŠ›å‡ºäº†ä»€ä¹ˆé”™</td></tr><tr><td><strong><code>target</code></strong></td><td>å½“å‰å¯¹è±¡</td><td><code>target.field</code> (æŸ¥çœ‹å½“å‰ç±»çš„æˆå‘˜å˜é‡å€¼)</td></tr><tr><td><strong><code>#cost</code></strong></td><td>æ–¹æ³•è€—æ—¶(ms)</td><td>ç”¨äºè¿‡æ»¤æ…¢è¯·æ±‚ <code>'#cost &gt; 100'</code></td></tr></tbody></table>
<p><strong>é€šç”¨å‚æ•°ï¼š</strong></p>
<ul>
<li><strong><code>-n 5</code></strong>ï¼šé™åˆ¶æ•è· 5 æ¬¡ï¼ˆé˜²æ­¢åˆ·å±å¡æ­»ï¼‰ã€‚</li>
<li><strong><code>-x 3</code></strong>ï¼šå¯¹è±¡å±•å¼€æ·±åº¦ 3 å±‚ï¼ˆé»˜è®¤æ˜¯ 1ï¼Œåªèƒ½çœ‹åˆ°å¯¹è±¡åœ°å€ï¼Œçœ‹ä¸åˆ°é‡Œé¢å±æ€§ï¼Œå»ºè®®è®¾ä¸º 2 æˆ– 3ï¼‰ã€‚</li>
<li><strong><code>-e</code></strong>ï¼šåªæ•è·å¼‚å¸¸è¯·æ±‚ã€‚</li>
</ul>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>å¹³æ—¶ 90% çš„æƒ…å†µï¼Œåªéœ€è¦ï¼š<strong><code>dashboard</code> çœ‹çŠ¶æ€ -&gt; <code>thread -n 3</code> æŸ¥ CPU -&gt; <code>jad</code> æŸ¥ä»£ç  -&gt; <code>watch</code> æŸ¥å‚æ•°è¿”å›å€¼ -&gt; <code>trace</code> æŸ¥æ…¢æ¥å£ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>